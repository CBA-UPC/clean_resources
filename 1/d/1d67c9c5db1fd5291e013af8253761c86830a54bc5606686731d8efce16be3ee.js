(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[585],{DVuI:function(n,i,e){"use strict";e.d(i,"b",(function(){return t})),e.d(i,"a",(function(){return s}));var t,l=e("Dn7E"),o=e("Uqr9");e("ETPz"),t||(t={}));var s=function(){function n(n,i,e,t,l,o){this.urlLauncherService=n,this.shellService=i,this.locService=e,this.odspConfigService=t,this.instrumentationService=l,this.odspType=o,this.Started_Provisioning="Started_Querying",this.GiveUp_CheckOn_Provisioning="GiveUp_CheckOn_Provisioning",this.Successfully_Found_Provisioned="Successfully_Provisioned",this.retryIntervals=[],this.odspProvisioningStatus=null}return n.prototype.ngOnInit=function(){var n,i=this;this.initializeRetryIntervals(),this.odspProvisioningStatus="Started_Querying",this.pageInitTime=o.a.now(),this.odspType===t.OneDrive?this.appText=this.locService.BrandOneDrive:this.odspType===t.SharePoint&&(this.appText=this.locService.BrandSharePoint),this.setDisplayText(0),this.image=this.odspConfigService.config.odspProvisioningPendingImage,this.retryIntervals.forEach((function(e){var l=function(){return new Promise((function(n){setTimeout((function(){i.shellService.getOdspProvisioningStatus(2).then((function(e){e.SharepointUrl&&i.odspType===t.SharePoint?(i.odspProvisioningStatus="Successfully_Provisioned",i.logOdspTimes(),i.urlLauncherService.openUrl(e.SharepointUrl,"SharePointRedirect","_self")):e.OneDriveUrl&&i.odspType===t.OneDrive&&(i.odspProvisioningStatus="Successfully_Provisioned",i.logOdspTimes(),i.urlLauncherService.openUrl(e.OneDriveUrl,"OneDriveRedirect","_self")),n()})).catch(n)}),e)}))};n=n?n.then(l):l()})),n.then(()},n.prototype.initializeRetryIntervals=function(){var n=this;this.odspConfigService.config.odspProvisioningCheckIntervals.split(",").forEach((function(i){var e=parseInt(i);n.retryIntervals.push(1e3*e)}))},n.prototype.logOdspTimes=function(){var n=this,i=function(){return{Elapsed_Time:Math.floor(o.a.now()-n.pageInitTime).toString(),ODSP_Type:n.odspType}};switch(this.odspProvisioningStatus){case"Successfully_Provisioned":this.instrumentationService.logGenericEvent("ODSP_Provisioning_Finish",i()),Object(l.a)({featureName:"ODSP",eventName:"ODSP_Provisioning_Finish",params:i()});break;case"GiveUp_CheckOn_Provisioning":this.instrumentationService.logGenericEvent("ODSP_Provisioning_GiveUp",i()),Object(l.a)({featureName:"ODSP",eventName:"ODSP_Provisioning_GiveUp",params:i()})}},n.prototype.setDisplayText=function(n){var i=this,e=switch(n){case 0:e(this.locService.format(this.locService.ODSPProvisioningSetupInProgress,this.appText),this.locService.ODSPProvisioningSetupInProgressSubtitle);break;case 1:e(this.locService.format(this.locService.ODSPProvisioningTakingTooLong,this.appText),this.locService.ODSPProvisioningTakingTooLongSubtitle)}},n}()},MxpO:function(n,i,e){"use strict";e.r(i),e.d(i,"SharePointStartModuleNgFactory",();var t=e("keVe"),l=),o=e("fYis"),s=e("g/dT"),r=e("W3Zz"),u=e("hhzZ"),a=e("TOqr"),c=e("QjXU"),p=e("dQLD"),v=e("ExL+"),h=e("TIi1"),S=e("PBJH"),g=e("DVuI"),d=function(n){function i(i,e,t,l,o){return n.call(this,i,e,t,l,o,g.b.SharePoint)||this}return Object(c.__extends)(i,n),i}(g.a),P=t.Fb({encapsulation:2,styles:[],data:{}});function f(n){return t.jc(0,[(n()(),t.Hb(0,0,null,null,1,"div",[["class","spinner-container--odsp"]],null,null,null,null,null)),(n()(),t.Hb(1,0,null,null,0,"div",[["class","ms-Spinner-circle ms-Spinner-circle--odsp"]],null,null,null,null,null))],null,null)}function b(n){return t.jc(0,[(n()(),t.Hb(0,0,null,null,10,"div",[["ohpInstrumentPageView","ODSPStart_PageView"],["role","main"]],null,null,null,null,null)),t.Gb(1,81920,null,0,s.a,[r.c,u.a],{pageName:[0,"pageName"]},null),(n()(),t.Hb(2,0,null,null,6,"div",[["class","odsp-pending"]],null,null,null,null,null)),(n()(),t.Hb(3,0,null,null,0,"img",[["class","odsp-pending__image"]],[[8,"src",4]],null,null,null,null)),(n()(),t.Hb(4,0,null,null,4,"div",[["class","odsp-pending__text"]],null,null,null,null,null)),(n()(),t.Hb(5,0,null,null,1,"div",[["class","odsp-pending__title"]],null,null,null,null,null)),(n()(),t.gc(6,null,["",""])),(n()(),t.Hb(7,0,null,null,1,"div",[],null,null,null,null,null)),(n()(),t.gc(8,null,["",""])),(n()(),t.qb(16777216,null,null,1,null,f)),t.Gb(10,16384,null,0,a.k,[t.W,t.S],{ngIf:[0,"ngIf"]},null)],(function(n,i){var e=i.component;n(i,1,0,"ODSPStart_PageView"),n(i,10,0,e.odspProvisioningStatus===e.Started_Provisioning)}),()}var _=t.Db("ohp-sharepoint-start",d,(function(n){return t.jc(0,[(n()(),t.Hb(0,0,null,null,1,"ohp-sharepoint-start",[],null,null,null,b,P)),t.Gb(1,114688,null,0,d,[h.a,v.a,S.a,p.a,u.a],null,null)],(,null)}),{},{},[]),m=e("xIlw"),O=e("+a0u"),T=e("lQwO"),D=e("+P5Z"),y=e("CfLe"),U=e("ej7j"),I=e("X+PR"),w=e("VY7U"),k=t.Eb(l,[],(function(n){return t.Tb([t.Ub(512,t.k,t.hb,[[8,[o.a,_]],[3,t.k],t.D]),t.Ub(4608,a.m,a.l,[t.z]),t.Ub(1073742336,a.c,a.c,[]),t.Ub(1073742336,m.a,m.a,[]),t.Ub(1073742336,O.a,O.a,[]),t.Ub(1073742336,T.a,T.a,[]),t.Ub(1073742336,D.a,D.a,[]),t.Ub(1073742336,y.a,y.a,[]),t.Ub(1073742336,U.a,U.a,[]),t.Ub(1073742336,I.o,I.o,[[2,I.u],[2,I.n]]),t.Ub(1073742336,w.a,w.a,[]),t.Ub(1073742336,l,l,[]),t.Ub(1024,I.l,(,[])])}))}}]);
//# sourceMappingURL=odsp-start-sharepoint.7d0647afc3ce02c31d4c.chunk.v7.js.map