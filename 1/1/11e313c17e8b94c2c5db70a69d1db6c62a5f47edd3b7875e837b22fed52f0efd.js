!);var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"redpop@b474a6ad4354f4ba5fde672fa4e9c2c267684761"};"use strict";(self.webpackChunk_tumblr_redpop=self.webpackChunk_tumblr_redpop||[]).push([[937],{65370:22183:(e,t,o)=>{o.d(t,{Z:()=>s});var i=(0,o(36343).q)("edit");i.defaultProps={size:{width:24,height:24}};let s=i},33951:(e,t,o)=>{o.d(t,{Z:()=>s});var i=(0,o(36343).q)("tipping");i.defaultProps={size:{width:21,height:21}};let s=i},46200:(e,t,o)=>{o.d(t,{A:()=>h});var i=o(50213),s=o(23326),n=o(91327),a=o(43523),r=o(78667),l=o(43166),c=o(74446);let p={footer:"fYlcy",pivotText:"mw4qt"};var u=o(54382),d=o(22424),m=o(2629),h=e=>{var t=e.children,o=e.isOpen,h=e.toggleIsOpen,b=(0,l.b8)().post,g=b.id,v=b.blog.uuid,f=b.canMute,y=b.noteCount,C=b.muted,k=b.rebloggedFromId,x=(0,r.bp)(),w=x._c,S=x._t,P=x.apiFetch,L=(0,d.wL)().logEvent,Z=(0,c.i)().onRemoveTimelineObject,j=f&&!C&&y>=50&&!k?(0,m.jsxs)("div",{className:p.footer,children:[(0,m.jsx)("div",{className:p.pivotText,children:w("Text to encourage users to mute a post instead of deleting it.","Did you know that you can now mute notifications for this post if your activity is a bit too noisy?")}),(0,m.jsx)(n.t,{allowTemporaryMute:!1,onClick:()=>{L({eventName:a.J.MuteNotDelete}),h()},muteText:w("Button for user to mute notifications about a post.","Mute"),withBorder:!0})]}):null;return(0,m.jsxs)(m.Fragment,{children:[t,o&&(0,m.jsx)(i.Z,{onGlassClick:h,glassIsClickable:!1,children:(0,m.jsx)(s.O,{"data-testid":"delete-dialog",title:(0,m.jsx)(u.ZP,{comment:"Confirmation modal text for deleting a post. The non-breaking space entity replacing the last space in the sentence is intended to improve text wrapping in English by preventing the last word from being 'orphaned' (being put on its own line by itself). As a rough guideline for other languages: If the last two words of the translated sentence exceed 15 characters (counting all spaces as one character), please omit the entity and only use regular spaces.",children:"Are you sure you want to delete this post?"}),footer:j,buttons:[{text:S("Cancel"),onClick:h,buttonStyle:s.X.Neutral},{text:S("OK"),onClick:()=>{var e=null==Z?void 0:Z({id:g});return h(),P(`/v2/blog/${v}/post/delete`,{method:"POST",body:{id:g}}).catch)},buttonStyle:s.X.Confirm}]})})]})}},25447:(e,t,o)=>{o.d(t,{d:()=>eo,Z:()=>es});var i=o(54138),s=o.n(i),n=o(17276),a=o.n(n),r=o(50209),l=o.n(r),c=o(5754),p=o.n(c),u=o(95004),d=o(62773),m=o(44009),h=o(28431),b=o(20103),g=o(50213),v=o(6135),f=o(23326),y=o(26162),C=o(91327),k=o(10849),x=o(33970),w=o.n(x),S=o(81846),P=o(78667),L=o(91949),Z=o(63583),j=o.n(Z),N=o(65370),I=o(2629);function M(e){var t=e.categories,o=e.hasCommunityLabel,i=e.isYourOwnBlog,s=e.reportViolation,n=e.reportViolationStatus,a=(0,P.bp)(),r=a._c,l=a.features.postActionsMenuM1,c=a.isLoggedIn,d=(0,u.useMemo)(()=>{var e=r("Separator of list of content warnings",", "),o=Object.entries(t).filter(e=>{var t=w()(e,2)[1];return(0,L.CS)(t)}).map(e=>{var t=w()(e,1)[0];return(0,L.id)(t,r).label.toLocaleLowerCase()}).join(e);return(0,S.k)(o)},[r,t]),h=(0,I.jsx)(m.Z,{onClick:s,wrapperClassName:p()(N.Z.communityLabelButton),children:(0,I.jsx)("span",{className:N.Z.missingLabel,children:r("Menu item for suggesting a community label","Missing label?")})}),b=(0,I.jsx)("div",{className:N.Z.loader,children:(0,I.jsx)(v.Z,{small:!0,color:j().paletteGray65})}),g=(0,I.jsx)(m.Z,{disabled:!0,children:r("Menu item to alert that the community label was already suggested","Community Label suggested")}),f=(0,I.jsxs)(I.Fragment,{children:[(o||!l)&&(0,I.jsx)("div",{className:p()(N.Z.communityLabelHeader),children:o?r("Community Label in post menu for labelled post","Community Label: Mature"):r("Community Label in post menu for labelled post","Community Label: Everyone")}),(0,I.jsxs)("div",{className:p()(N.Z.communityLabelDetail),children:[0!==d.length&&d,!i&&"success"===n&&g]}),i||l||!c||"idle"!==n&&"failure"!==n?"pending"===n&&b:(0,I.jsx)("span",{children:h})]});return(0,I.jsx)("div",{className:p()(N.Z.communityLabel),children:f})}var T=o(99030),D=o(64560),A=o(46819),O=o(67023),E=o(50899),F=o(43523),_=o(43684),U=o(17901),B=o(5700),R=o(85795),H=o(59215),$=o(34056),V=o(87517),J=o(399),W=o(45051),G=o(24228),z=o(25200),Y=(e,t)=>{try{return new URL(e,t)}catch(e){return(0,z.Tb)(e),null}},X=o(68782),Q=o(39277),q=o(20775),K=o(46200),ee=o(85601),et=o(18145),eo({});class ei extends u.Component{constructor(){var e;super(...arguments),e=this,l()(this,"state",{isMenuOpen:!1,copyLinkStatus:eo.Unclicked,copyCustomLinkStatus:eo.Unclicked,showingPinPostConfirmationDialog:!1,isOpenDeleteDialog:!1,canSubscribe:!0,isSubscribed:!1,isSubscribeFetching:!1,reportViolationStatus:"idle",communityLabelVisibilitySetting:A.Gl,toggleCommunityLabelStatus:"idle"}),l()(this,"apiHelper",(0,R.ZP)(this.props.appContext.apiFetch)),l()(this,"containerRef",(0,u.createRef)()),l()(this,"hasUnfollowed",!1),l()(this,"renderItems",e=>{var t=this.props,o=t.blogUrl,i=t.blogName,s=t.followed,n=t.postUrl,a=t.dismissal,r=t.isPostPublishedOrPrivate,l=t.date,c=t.renderPin,u=t.postContext,g=u.post,f=g.askingName,x=g.blog,w=g.blogName,S=g.canPin,P=g.communityLabels,Z=g.id,N=g.isPinned,A=g.isSubmission,E=g.muted,_=g.parentPostUrl,U=g.placementId,B=g.postAuthor,R=u.presentationStyle,H=R.showsPreviewPostLink,$=R.usesInboxAttribution,J=R.hasCustomPostLink,W=t.appContext,G=W._c,z=W.apiFetch,X=W.isLoggedIn,Q=W._getRelativeDateString,q=W.wwwBaseUrl,ei=W.features,es=t.canDelete,en=t.canEdit,ea=t.canMute,er=t.editablePost,el=t.trail,ec=t.shouldOpenInLegacy,ep=void 0===ec||ec,eu=t.isReblogHeader,ed=t.showTip,em=t.isMember,eh=this.state,eb=eh.copyLinkStatus,eg=eh.copyCustomLinkStatus,ev=eh.showingPinPostConfirmationDialog,ef=eh.isOpenDeleteDialog,ey=eh.canSubscribe,eC=[],ek=_&&(null===(eM=Y(_))||void 0===eM?void 0:eM.pathname),ex=!!l&&(r||$),ew=P&&!$&&(!ei.postActionsMenuM1||P.hasCommunityLabel),eS=!!ei.postActionsMenuM1&&!!ek&&!eu,eP=X&&!e&&s&&!!o,eL=ey&&!eu&&!$,eZ=en&&!!er,ej=X&&!ei.postActionsMenuM1,eN=!!ei.postActionsMenuM1&&X&&!e&&!$,eI=X&&!e;if(ex&&eC.push((0,I.jsx)(h.Z,{linkTo:n,title:G("Hover text for timestamp that links to a blog permalink. %1$s is the blog's domain","View post on %1$s",[(0,d.T)(n)]),className:p()(et.Z.meatballItem,et.Z.thin,et.Z.timestamp,{[et.Z.hasDivider]:!ew}),role:"menuitem",tabIndex:-1,children:(0,I.jsx)("span",{className:et.Z.timestampDate,children:Q(l,O.q.Simple)})},"timestamp")),ew){var eM,eT,eD=(0,L.nT)(P).categories;eC.push((0,I.jsx)(h.Z,{className:p()(et.Z.meatballItem,et.Z.thin,et.Z.communityLabel,et.Z.hasDivider),isWrappingButton:!0,role:"menuitem",children:(0,I.jsx)(M,{categories:eD,isYourOwnBlog:e,hasCommunityLabel:null===(eT=this.props.postContext.post.communityLabels)||void 0===eT?void 0:eT.hasCommunityLabel,reportViolation:this.reportViolation,reportViolationStatus:this.state.reportViolationStatus})},"community-label"))}if(!r&&H&&eC.push((0,I.jsx)(h.Z,{linkTo:n,className:p()(et.Z.meatballItem,et.Z.thin),role:"menuitem",children:G("Link text for previewing an unpublished post","Preview post")},"preview-post")),void 0!==c&&c&&S&&eC.push((0,I.jsxs)(h.Z,{keepDropdownOpenAfterClick:!0,className:p()(et.Z.meatballItem,et.Z.thin),onClick:N?this.unpinPost:this.pinPostClick,role:"menuitem",children:[N?G("Link text for unpinning a post","Unpin"):G("Link text for pinning a post","Pin"),ev&&this.renderPinPostConfirmationDialog()]},"pin-post")),r){var eA={[eo.Success]:G("Success message after copying a link","Link copied!"),[eo.Failure]:G("Error message when trying to copy a link","Failed to copy link."),[eo.Unclicked]:G("Menu item to copy the link to a post to your clipboard","Copy link")},eO={[eo.Success]:et.Z.success,[eo.Failure]:et.Z.failure,[eo.Unclicked]:""};J&&eC.push((0,I.jsx)(h.Z,{onClick:this.copyCustomLink,keepDropdownOpenAfterClick:!0,className:p()(et.Z.meatballItem,eO[eg]),children:eA[eg]},"copyCustomLink"));var eE=eA[eb];eb===eo.Unclicked&&J&&(eE=G("Menu item to copy the link to a post to your clipboard","Copy link to post")),eC.push((0,I.jsx)(h.Z,{onClick:this.copyLink,keepDropdownOpenAfterClick:!0,className:p()(et.Z.meatballItem,eO[eb]),role:"menuitem",children:eE},"copyLink"))}if(eS&&eC.push((0,I.jsx)(h.Z,{className:et.Z.meatballItem,krakenEventName:F.J.PostMenuViewPreviousReblog,linkTo:ek,role:"menuitem",children:G("Menu item to show the post/reblog which this reblog was created from","View previous reblog")},"show-parent")),ed&&eC.push((0,I.jsx)(h.Z,{isWrappingButton:!0,className:p()(et.Z.meatballItem,et.Z.thin),role:"menuitem",tabIndex:-1,keepDropdownOpenAfterClick:!0,krakenEventName:F.J.TipPostTap,eventSource:this.getEventSource(),children:(0,I.jsx)(T.Z,{blog:x,postId:Z,isMember:em,isDropdownItem:!0})},"tip")),eP&&eC.push((0,I.jsx)(h.Z,{isWrappingButton:!0,keepDropdownOpenAfterClick:!0,role:"menuitem",children:(0,I.jsx)(b.Z,{following:!0,blogName:i,blogUrl:o,className:et.Z.meatballItem,extraFollowParams:{placementId:U},isPostHeader:!0,children:()=>ei.postActionsMenuM1?G("Menu item to unfollow a blog. %1$s is the blog name.","Unfollow @%1$s",[i]):G("Menu item to unfollow a blog","Unfollow")})},"unfollow")),a&&a.options.forEach(e=>{var t,o,i=p()(et.Z.meatballItem,{[et.Z.red]:e.destructive}),s=e.link,n=s.type,a=s.href;switch(n){case D.U.Action:t=(0,V.Z)(e.link,z,this.removePost,this.showGenericToastError);break;case D.U.Web:o=a;break;default:return}eC.push((0,I.jsx)(h.Z,{linkTo:o,onClick:t,className:i,role:"menuitem",children:e.text},`dismissal-${e.text}`))}),eL){var eF=this.state,e_=eF.isSubscribed,eU=eF.isSubscribeFetching,eB=ei.postActionsMenuM1?e_?G("Contextual action to unsubscribe from updates","Unfollow post"):G("Contextual action to subscribe to updates","Follow post"):e_?G("Contextual action to unsubscribe from updates","Unsubscribe from conversation"):G("Contextual action to subscribe to updates","Subscribe to conversation");eC.push((0,I.jsx)(h.Z,{keepDropdownOpenAfterClick:!0,isWrappingButton:!0,className:et.Z.meatballItem,role:"menuitem",children:eU?(0,I.jsx)("div",{className:et.Z.loader,children:(0,I.jsx)(v.Z,{small:!0,color:j().paletteGray65})}):(0,I.jsx)(m.Z,{onClick:()=>{e_?this.unsubscribePost():this.subscribePost()},children:eB})},"subscribe"))}if(ea&&eC.push((0,I.jsx)(h.Z,{isWrappingButton:!0,keepDropdownOpenAfterClick:!0,className:p()(et.Z.meatballItem),krakenEventName:E?F.J.Unmute:F.J.Mute,eventSource:this.getEventSource(),role:"menuitem",children:E?(0,I.jsx)(k.L,{}):(0,I.jsx)(C.t,{allowTemporaryMute:!0})},"mute")),eZ&&eC.push((0,I.jsx)(h.Z,{isWrappingButton:!0,keepDropdownOpenAfterClick:!0,className:p()(et.Z.meatballItem,{[et.Z.spaceRest]:!ep}),role:"menuitem",children:(0,I.jsx)(y.Z,{isTextButton:!0,className:p()(et.Z.meatballItemReset,et.Z.expand),editablePost:er,trail:el,shouldAlwaysOpenInLegacy:ep})},"edit")),es&&eC.push((0,I.jsx)(h.Z,{isWrappingButton:!0,keepDropdownOpenAfterClick:!0,krakenEventName:F.J.DeletePost,className:p()(et.Z.meatballItem,et.Z.red),onClick:this.toggleIsOpenDeleteDialog,role:"menuitem",eventSource:this.getEventSource(),children:(0,I.jsx)(K.A,{isOpen:ef,toggleIsOpen:this.toggleIsOpenDeleteDialog,children:G("Link text to open delete dialog","Delete")})},"delete")),ej&&eC.push((0,I.jsx)(h.Z,{linkTo:"/settings/account",className:et.Z.meatballItem,role:"menuitem",children:G("Menu item to redirect to content settings","Content settings")},"content-settings")),eN){var eR=this.state.reportViolationStatus,eH=["idle","failure"].includes(eR);eC.push((0,I.jsxs)(h.Z,{className:et.Z.meatballItem,isDisabled:!1===eH,keepDropdownOpenAfterClick:!0,onClick:this.reportViolation,role:"menuitem",children:[eH&&G("Menu item for suggesting a community label","Suggest Community Label"),"pending"===eR&&(0,I.jsx)("div",{className:et.Z.loader,children:(0,I.jsx)(v.Z,{small:!0,color:j().paletteBlack})}),"success"===eR&&G("Menu item to alert that the community label was already suggested","Community Label suggested")]},"suggest-label"))}if(eI){var e$=f||B,eV=$&&e$?(0,ee.I)(e$,n,q,{postId:Z,recipientName:w},"message"):(0,ee.I)(w,n,q,{postId:Z});eC.push((0,I.jsx)(h.Z,{alwaysExternalLink:!0,linkTo:eV,className:p()(et.Z.meatballItem,et.Z.red),role:"menuitem",krakenEventName:F.J.BlogReportClick,eventSource:this.getEventSource(),children:ei.postActionsMenuM1?$?A?G("Menu item to report a received submission","Report submission"):G("Menu item to report a received ask or private answer","Report message"):G("Menu item to report a post","Report post"):G("Menu item to report a post or blog","Report %1$s",[i])},"report"))}return eC}),l()(this,"renderPinPostConfirmationDialog",()=>{var e=this.props.appContext._t;return(0,I.jsx)(g.Z,{onGlassClick:this.pinPostCancel,glassIsClickable:!1,children:(0,I.jsx)(f.O,{title:e("Pin this post"),body:e("This will appear at the top of your blog and replace any previous pinned post. Are you sure?"),buttons:[{text:e("Nevermind"),buttonStyle:f.X.Neutral,onClick:this.pinPostCancel},{text:e("Yes"),buttonStyle:f.X.Confirm,onClick:this.pinPostConfirm}]})})}),l()(this,"onPopoverClose",()=>{this.setState({isMenuOpen:!1}),this.hasUnfollowed&&this.removePost(null,{wasBlogUnfollowed:!0})}),l()(this,"getBlogShareUrl",()=>{var e=this.props.postContext.post,t=e.blogName,o=e.id,i=e.slug,s=e.postUrl,n=e.state,a=e.community;return n===B.hA.Private||a?s:(0,G.b)(t,o,i)}),l()(this,"onPopoverOpen",function(){var t,o,i,s,n;return a()().async(function(a){for(;;)switch(a.prev=a.next){case 0:o=(t=e.props).blogUuid,s=(i=t.postContext).post.id,n=i.presentationStyle.usesInboxAttribution,e.setState({toggleCommunityLabelStatus:"idle"}),o&&!n&&(e.setState({isSubscribeFetching:!0}),e.apiHelper.getNotes(o,{id:s,mode:U.L.Conversation}).fetch().then(t=>{var o=t.response,i=o.canSubscribe,s=o.isSubscribed;e.setState({canSubscribe:!!i,isSubscribed:!!s})}).catch(W.Z).finally)),e.setState({isMenuOpen:!0});case 4:case"end":return a.stop()}},null,null,null,Promise)}),l()(this,"toggleIsOpenDeleteDialog"),l()(this,"getEventSource"),l()(this,"removePost",function(t){var o,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.props,a=n.postContext,r=n.isReblogHeader,l=n.parentPostId,c=n.timelineContext.onRemoveTimelineObject;if(r&&l){null==c||c(s()(s()({},i),{},{id:l}));return}null!=a&&null!==(o=a.post)&&void 0!==o&&o.id&&(null==c||c(s()(s()({},i),{},{id:a.post.id})))}),l()(this,"logMeatballsEvent",e=>{var t=this.getEventSource(),o=this.props;(0,o.appContext.logEvent)({eventName:e,eventDetails:{placement_id:o.placementId,source:t,type:"post",context:"meatballs"}})}),l()(this,"logMeatballMenuOpen",()=>{this.props.appContext.logEvent({eventName:F.J.PostMeatballsMenuOpened,eventDetails:{canDelete:!!this.props.canDelete,source:this.getEventSource()}})}),l()(this,"copyLink",()=>{var e=this.getBlogShareUrl();this.state.isMenuOpen&&(0,$.z)(e).then(()=>{this.setState({copyLinkStatus:eo.Success}),this.logMeatballsEvent(F.J.CopyPostLink),this.setLinkResetTimer()}).catch(()=>{this.setState({copyLinkStatus:eo.Failure}),this.setLinkResetTimer()})}),l()(this,"copyCustomLink",()=>{var e=this.props.location.pathname,t=`${E.Cw}${e}`;(0,$.z)(t).then(()=>{this.setState({copyCustomLinkStatus:eo.Success}),this.logMeatballsEvent(F.J.CopyPostLink),this.setLinkResetTimer()}).catch(()=>{this.setState({copyCustomLinkStatus:eo.Failure}),this.setLinkResetTimer()})}),l()(this,"pinPostClick",()=>{this.setState({showingPinPostConfirmationDialog:!0}),this.props.appContext.logEvent({eventName:F.J.PinPost})}),l()(this,"pinPostConfirm"),l()(this,"pinPostCancel",()=>{this.setState({showingPinPostConfirmationDialog:!1}),this.props.appContext.logEvent({eventName:F.J.PinPostCancel})}),l()(this,"pinPost",()=>{var e=this.props,t=e.appContext.logEvent,o=e.postContext.post,i=e.timelineContext.onPin;null==i||i(o.id,!0),t({eventName:F.J.PinPostConfirm}),this.apiHelper.pinPost(o.blogName,o.id).fetch().catch(()=>null==i?void 0:i(o.id,!1))}),l()(this,"unpinPost",()=>{var e=this.props,t=e.appContext.logEvent,o=e.postContext.post,i=e.timelineContext.onPin;null==i||i(o.id,!1),t({eventName:F.J.UnpinPost}),this.apiHelper.unpinPost(o.blogName,o.id).fetch().catch(()=>null==i?void 0:i(o.id,!0))}),l()(this,"setLinkResetTimer",()=>{var e=this.props.copyLinkStatusDelay;clearTimeout(this.copyLinkMessageTimer),this.copyLinkMessageTimer=setTimeout(()=>{this.setState({copyLinkStatus:eo.Unclicked}),this.setState({copyCustomLinkStatus:eo.Unclicked})},null!=e?e:3e3)}),l()(this,"subscribePost",()=>{var e=this.props,t=e.blogName,o=e.postContext.post.id;this.logMeatballsEvent(F.J.PostActivitySubscribe),this.setState({isSubscribed:!0,isSubscribeFetching:!0}),this.apiHelper.subscribeToPost(t,o).fetch().catch(()=>this.setState({isSubscribed:!1})).finally(()=>this.setState({isSubscribeFetching:!1}))}),l()(this,"unsubscribePost",()=>{var e=this.props,t=e.blogName,o=e.postContext.post.id;this.setState({isSubscribed:!1,isSubscribeFetching:!0}),this.apiHelper.unsubscribeToPost(t,o).fetch().catch(()=>this.setState({isSubscribed:!0})).finally)}),l()(this,"reportViolation",()=>{var e=this.props,t=e.blogUuid,o=e.postContext,i=o.post.id,s=o.setCommunityLabel,n=e.toastContext.toggleToast,a=e.appContext,r=a._c,l=a.apiFetch,c=String(t)||"",p=String(i)||"",u=this.state.communityLabelVisibilitySetting;return this.setState({reportViolationStatus:"pending"}),this.logMeatballsEvent(F.J.SuggestCommunityLabelClick),l("/v2/tos/report",{method:"POST",body:{post_id:p,tumblelog:c,violation:"community-label"}}).then(()=>{n(r("Feedback when the report violation is successful","Thanks for the suggestion! Way to look out for yourself and others on Tumblr."),"success"),this.setState({reportViolationStatus:"success"}),u==A.fj&&this.removePost(null),s&&s(!0)}).catch(()=>{this.showGenericToastError(),this.setState({reportViolationStatus:"failure"})})}),l()(this,"showGenericToastError",()=>{var e=this.props,t=e.appContext._t;(0,e.toastContext.toggleToast)((0,X.U)((0,J.Pk)(t)),"error")})}componentDidMount(){(0,this.props.appContext.getUserInfo)().then(e=>{e.communityLabelVisibilitySetting==A.fj&&this.setState({communityLabelVisibilitySetting:A.fj})})}componentDidUpdate(e){e.followed&&!this.props.followed&&(this.hasUnfollowed=!0)render(){return(0,I.jsx)(q.Z,s()(s()({},(0,q._)(this.props)),{},{forwardedRef:this.containerRef,renderItems:this.renderItems,onPopoverClose:this.onPopoverClose,onPopoverOpen:this.onPopoverOpen,onOpen:this.logMeatballMenuOpen,onBlock:this.removePost,popoverBoundary:_.gc.ScrollParent,showOverflowY:!0,postId:this.props.postContext.post.id,eventSource:this.getEventSource()}))}}let es=(0,Q.Z)((0,H.X9)(ei,{appContext:!0,postContext:!0,timelineContext:!0,toastContext:!0}))},26162:(e,t,o)=>{o.d(t,{Z:()=>I});var i=o(50209),s=o.n(i),n=o(44009),a=o(22183),r=o(25190),l=o(9953),c=o(54138),p=o.n(c),u=o(54589),d=o.n(u),m=o(70834),h=o(55673),b=o(2629),g=["action","children"],v=e=>{var t=e.action,o=e.children,i=d()(e,g),s=(0,m.I)(t);return(0,b.jsx)(h.rU,p()(p()(p()({},i),s),{},{children:o}))},f=o(90127),y=o(95004),C=o(43452),k=o(5700),x=o(19937),w=o(59215),S=o(92209),P=o(63583),L=o.n(P),Z=(e,t,o)=>{switch(e){case k.hA.Published:case k.hA.Private:if(t===C.$t.Published||t===C.$t.Private||t===C.$t.Now)return o;break;case k.hA.Draft:return t===C.$t.Draft||!t;case k.hA.Queued:return(t===C.$t.Queue||t===C.$t.Scheduled)&&o}return!1},j=(e,t,o)=>{if(Z(e,t,o)||!o||!t||!e)return!1;switch(e){case k.hA.Ask:case k.hA.Submission:return!0;case k.hA.Private:case k.hA.Published:break;case k.hA.Draft:return t!==C.$t.Draft;case k.hA.Queue:case k.hA.Queued:return t!==C.$t.Queue&&t!==C.$t.Scheduled}return!1};class N extends y.Component{constructor(){super(...arguments),s()(this,"setLegacyFormCloseHandler",()=>{var e=this.props.modalRouteContext.addOnCloseModalRouteHandler;this.removeOnModalCloseListener=e(this.onLegacyFormClose)}),s()(this,"setFormCloseHandler",()=>{var e=this.props.modalRouteContext.addOnCloseModalRouteHandler;this.removeOnModalCloseListener=e(this.onFormClose)}),s()(this,"refreshPostInTimeline",()=>{var e=this.props,t=e.timelineContext,o=e.editablePost,i=o.id,s=o.blog;return(0,x.J)(this.props.appContext.apiFetchWithSchema,{postId:i,blogIdentifier:s.name}).fetch().then(e=>{var o;null==t||null===(o=t.onEditTimelineObject)||void 0===o||o.call(t,e.response.posts[0])})}),s()(this,"onFormClose",e=>{var t,o,i=e.isModalSuccess,s=e.postStatus,n=this.props,a=n.timelineContext,r=n.editablePost,l=r.state,c=r.id;return(null===(t=this.removeOnModalCloseListener)||void 0===t||t.call(this),Z(l,s,!!i))?this.refreshPostInTimeline():(j(l,s,!!i)&&(null==a||null===(o=a.onRemoveTimelineObject)||void 0===o||o.call(a,{id:c})),Promise.resolve())}),s()(this,"onLegacyFormClose",e=>{var t,o,i=e.isModalSuccess,s=e.legacyPostFormState,n=this.props,a=n.timelineContext,r=n.editablePost,l=r.state,c=r.id;return(null===(t=this.removeOnModalCloseListener)||void 0===t||t.call(this),i&&s&&s===l)?this.refreshPostInTimeline():(i&&s&&s!==l&&(null==a||null===(o=a.onRemoveTimelineObject)||void 0===o||o.call(a,{id:c})),Promise.resolve())})render(){return(0,b.jsx)(r.ZP,{children:e=>{var t=e.isMobile;return this.getButton(t)}})}getButton(e){var t,o=this.props,i=o.editablePost,s=o.shouldAlwaysOpenInLegacy,n=o.appContext._t,a=o.className,r=o.disabled;return s?e?this.getLegacyAnchor():this.getLegacyIframeButton():r?(0,b.jsx)(b.Fragment,{children:this.getLinkDisplay()}):(0,b.jsx)(v,{action:"edit-button",onClick:this.setFormCloseHandler,to:(0,f.s3)({blogName:i.blog.name,postId:null===(t=i.id)||void 0===t?void 0:t.toString()},(0,S.Z)({editablePost:i})),"aria-label":n("Edit"),className:a,children:this.getLinkDisplay()})}getLinkDisplay(){var e=this.props,t=e.isTextButton,o=e.appContext._t;return t?o("Edit"):this.getIcon()}getIcon(){var e=this.props.disabled;return(0,b.jsx)(a.Z,{size:{width:21,height:21},colors:{primary:e?L().paletteGray40:L().paletteGray65}})}getLegacyIframeButton(){var e,t=this.props,o=t.editablePost,i=t.disabled,s=this.props.appContext._t;return i?(0,b.jsx)(l._,{action:"legacy-iframe-edit-button",label:s("Edit"),disabled:i,children:this.getLinkDisplay()}):(0,b.jsx)(v,{action:"legacy-iframe-edit-button",to:(0,f.s3)({blogName:o.blog.name,postId:null===(e=o.id)||void 0===e?void 0:e.toString()}),children:(0,b.jsx)(n.Z,{onClick:this.setLegacyFormCloseHandler,label:s("Edit"),children:this.getLinkDisplay()})})}getLegacyAnchor(){var e=this.props.appContext,t=e._t,o=e.wwwBaseUrl,i=this.props.disabled,s=encodeURIComponent(`${o}/dashboard?restore=1`);return i?(0,b.jsx)(l._,{action:"legacy-anchor-edit-button",label:t("Edit"),disabled:i,children:this.getLinkDisplay()}):(0,b.jsx)("a",{href:`${o}/edit/${this.props.editablePost.id}?redirect_to=${s}&avoid_redirect=1`,role:"button",tabIndex:-1,children:(0,b.jsx)(l._,{action:"legacy-anchor-edit-button",label:t("Edit"),children:this.getLinkDisplay()})})}}s()(N,"defaultProps",{shouldAlwaysOpenInLegacy:!0});let I=(0,w.X9)(N,{appContext:!0,timelineContext:!0,modalRouteContext:!0})},91327:(e,t,o)=>{o.d(t,{t:()=>L});var i=o(54138),s=o.n(i),n=o(33970),a=o.n(n),r=o(5754),l=o.n(r),c=o(44009),p=o(28431),u=o(50213),d=o(23326),m=o(53714),h=o(10381),b=o(94462),g=o(95004),v=o(43523),f=o(43684),y=o(78667),C=o(43166),k=o(74446),x=o(93613),w=o(96467),S=o.n(w),P=o(2629),L=e=>{var t=e.onClick,o=e.allowTemporaryMute,i=e.muteText,n=e.withBorder,r=(0,y.bp)(),w=r._c,L=r._t,Z=(0,k.i)().onEditTimelineObject,j=(0,C.b8)(),N=j.post,I=N.id,M=N.muted,T=N.blogName,D=j.post,A=(0,x.V)().toggleToast,O=(0,h.pG)().width>=S().phoneResponsiveMaxBreakpoint,E=w("Button for user to mute notifications about a post.","Mute notifications"),F=(0,g.useMemo)(()=>[{duration:28800,buttonLabel:w("Button label for muting a post for eight hours.","8 hours"),confirmationText:w("Description for confirmation dialog when user mutes a post for 8 hours.","You won't receive push and activity notifications for this post for 8 hours."),krakenEventName:v.J.MuteHours},{duration:86400,buttonLabel:w("Button label for muting a post for one day.","Til tomorrow"),confirmationText:w("Description for confirmation dialog when user mutes a post for a day.","You won't receive push and activity notifications for this post for one day."),krakenEventName:v.J.MuteDay},{duration:604800,buttonLabel:w("Button label for muting a post for one week.","Til next week"),confirmationText:w("Description for confirmation dialog when user mutes a post for a week.","You won't receive push and activity notifications for this post for one week."),krakenEventName:v.J.MuteWeek},{buttonLabel:w("Button label for muting a post forever.","Forever"),confirmationText:w("Description for confirmation dialog when user mutes a post forever.","You won't receive push and activity notifications for this post from now on."),krakenEventName:v.J.MuteForever}],[w]),_=(0,b.l)().mutateAsync,U=(0,g.useState)(!1),B=a()(U,2),R=B[0],H=B[1],$=(0,g.useState)(F[F.length-1]),V=a()($,2),J=V[0],W=V[1],G=(0,g.useState)(!1),z=a()(G,2),Y=z[0],X=z[1],Q=(0,g.useCallback),[Y]),q=(0,g.useCallback)(()=>{_({id:I,muted:!!M,blogName:T,muteLengthSeconds:J.duration}).then(()=>{A(w("Confirmation message shown when user mutes a post.","Disabled notifications for this post."),"success");var e=(null==J?void 0:J.duration)||0,o=0!==e?Math.round(Date.now()/1e3)+e:0;Z(s()(s()({},D),{},{muted:!M,muteEndTimestamp:o})),null==t||t()}).catch(()=>{A(L("Something went wrong. Please try again."),"error")})},[w,L,I,J,M,T,_,D,Z,A,t]),K=(0,g.useCallback)(()=>{var e;return(0,P.jsx)(P.Fragment,{children:F.map((t,o)=>(0,P.jsx)(p.Z,{isWrappingButton:!0,keepDropdownOpenAfterClick:!0,krakenEventName:t.krakenEventName,className:"F4hr9",children:(0,P.jsx)(c.Z,{onClick,children:t.buttonLabel})},o))})},[F,W,H]),ee=i||E,et=(0,P.jsxs)(c.Z,{label:ee,"aria-label":E,onClick:()=>H(!0),className:l()({oh58_:n}),children:[ee,R?(0,P.jsx)(u.Z,{onGlassClick:()=>H(!1),glassIsClickable:!0,children:(0,P.jsx)(d.O,{title:w("Title for confirmation dialog when user mutes a post.","Are you sure you want to mute notifications?"),body:J.confirmationText,buttons:[{text:L("Nevermind"),onClick:()=>H(!1),buttonStyle:d.X.Neutral},{text:w("Confirm button for muting a post","Mute"),onClick:q,buttonStyle:d.X.Cancel}]})}):null]});return o?(0,P.jsx)(m.ZP,{toggle:Q,isOpen:Y,position:O?f.I2.RightStart:f.I2.Auto,render:K,width:250,height:"auto",closeForAllExternalClicks:!0,children:et}):et}},40760:(e,t,o)=>{o.d(t,{Z:()=>d});var i=o(54138),s=o.n(i),n=o(5754),a=o.n(n),r=o(33951),l=o(9953),c=o(78667);let p={tippingButton:"PArFh",label:"HQqNA",dropdownItem:"kL4nC"};var u=o(2629);let d=function(e){var t=e.onClick,o=e.withLabel,i=e.size,n=e.isDropdownItem,d=e.blogName,m=e.wrapperClassName,h=(0,c.bp)()._c,b=d&&n?h("Tip is a verb labeling a button that start the process of giving a tip to a blog","Tip @%1$s",[d]):h("Tip is a verb labeling a button that start the process of giving a tip to a blog","Tip");return(0,u.jsxs)(l._,{action:"tipping-button",className:a()(p.tippingButton,{[p.dropdownItem]:n}),wrapperClassName:m,label:b,onClick:t,"data-testid":"tippingButton",children:[!n&&(0,u.jsx)(r.Z,s()({},i?{size:i}:{})),(void 0===o||o)&&(0,u.jsx)("span",{className:p.label,"data-testid":"tipLabel",children:b})]})}},10849:(e,t,o)=>{o.d(t,{L:()=>m});var i=o(54138),s=o.n(i),n=o(44009),a=o(94462),r=o(95004),l=o(78667),c=o(43166),p=o(74446),u=o(93613),d=o(2629),m=e=>{var t=e.onClick,o=(0,l.bp)(),i=o._c,m=o._t,h=(0,p.i)().onEditTimelineObject,b=(0,c.b8)(),g=b.post,v=g.id,f=g.muted,y=g.blogName,C=b.post,k=(0,u.V)().toggleToast,x=(0,a.l)().mutateAsync,w=i("Button for user to unmute notifications about a post.","Unmute notifications"),S=(0,r.useCallback)(()=>{x({id:v,muted:!!f,blogName:y}).then(()=>{k(i("Confirmation message shown when user unmutes a post.","Done! Push and activity notifications are back on for this post."),"success"),h(s()(s()({},C),{},{muted:!f})),null==t||t()}).catch(()=>{k(m("Something went wrong. Please try again."),"error")})},[i,m,v,f,y,x,C,h,k,t]);return(0,d.jsx)(n.Z,{label:w,onClick:S,children:w})}},99030:(e,t,o)=>{o.d(t,{Z:()=>g});var i=o(33970),s=o.n(i),n=o(53714),a=o(40760),r=o(75376),l=o(95004),c=o(43684),p=o(68087),u=o(78667),d=o(43166),m=o(93613),h=o(399),b=o(2629);let g=e=>{var t=e.isMember,o=e.blog,i=e.postId,g=e.isDropdownItem,v=(0,u.bp)()._c,f=(0,m.V)().toggleToast,y=(0,d.I_)(),C=(0,l.useState)(!1),k=s()(C,2),x=k[0],w=k[1],S=(0,l.useCallback)(()=>{if(t){f((0,h.iI)(v),"tumblrbot");return}w(!x)},[x,t,f,v]),P=g?c.I2.Auto:c.I2.AutoStart;return(0,b.jsx)(n.ZP,{width:p.OH,height:p.u5,closeForAllExternalClicks:!0,position:P,isOpen:x,toggle:S,usePortals:!0,component:(0,b.jsx)(r.Z,{onClose:S,blogname:o.name,postId:i,canDoReply:!!(null!=y&&y.post.canReply)}),children:(0,b.jsx)(a.Z,{onClick:S,size:{width:15,height:15},isDropdownItem:g,blogName:o.name})})}},75376:(e,t,o)=>{o.d(t,{Z:()=>f});var i=o(33970),s=o.n(i),n=o(95004),a=o(34438),r=o(43523),l=o(85795),c=o(78667),p=o(58849),u=o(22424);let d=(0,o(80293).Z),"AsyncTippingForm"),m=o.p+"src/assets/images/tipping/tip-jar-8d1544a0.gif",h=o.p+"src/assets/images/tipping/tip-jar@2x-56354e2e.gif";var b=o(54382),g=o(2629);let v=e=>{var t=e.onAcceptTerms,o=(0,c.bp)()._c;return(0,g.jsxs)("div",{className:"kuEoR",children:[(0,g.jsx)("img",{srcSet:`${h} 400w, ${m} 200w`,sizes:"(min-resolution: 1.3) 400w, 200w",src:m,alt:"",className:"mnMy1"}),(0,g.jsx)("h2",{className:"ZyCBz",children:o("Heading for tip jar feature description. Tip has two meanings here: a monetary reward and a peice of advice","Here's a tip")}),(0,g.jsx)("span",{className:"NG3pi",children:(0,g.jsx)(b.ZP,{components:{span:(0,g.jsx)("span",{role:"img","aria-label":o("label for heart emoji","love")})},children:"Now you can send tips to the blogs you [span]❤️[/span] on Tumblr."})}),(0,g.jsx)("span",{className:"VA2AA",children:(0,g.jsx)(b.ZP,{components:{termsLink:(0,g.jsx)("a",{href:"https://www.tumblr.com/policy/en/terms-of-service"}),privacyLink:(0,g.jsx)("a",{href:"https://www.tumblr.com/privacy"})},children:"By tapping “Start tipping now” below I agree to [termsLink]Tumblr’s Terms of Service[/termsLink], that I’m 18 years or older, and have read the [privacyLink]Privacy Policy[/privacyLink]."})}),(0,g.jsx)("button",{className:"GRXS0",onClick:t,children:o("Button text that initiates the process of sending a tip to user","Start tipping now")})]})},f=e=>{var t=e.blogname,o=e.canDoReply,i=e.onClose,m=e.postId,h=e.replyText,b=(0,c.bp)(),f=b.apiFetch,y=b.getUserInfo,C=b.isLoggedIn,k=(0,u.wL)().logEvent,x=(0,p.h)().openLoginWall,w=(0,n.useState)(!0),S=s()(w,2),P=S[0],L=S[1],Z=(0,n.useState)(void 0),j=s()(Z,2),N=j[0],I=j[1];(0,n.useEffect)(()=>{y().then(function(e){var t;L(e.acceptedTippingTos||!1),I(null===(t=e.blogs)||void 0===t?void 0:t[0].avatar)})},[y,L,f]);var M=(0,n.useCallback)(()=>(k({eventName:r.J.StartTippingTap}),C)?(0,l.ZP)(f).acceptTippingTerms().en(()=>L(!0)):x({redirect:(0,a.SS)({peeprBlogname:t,peeprPostId:null==m?void 0:m.toString()})}),[f,t,C,k,x,m]);return(0,g.jsx)("div",{children:P?(0,g.jsx)(d,{avatar:N,blogname:t,canDoReply:o,onClose:i,postId:m,replyText:void 0===h?"":h}):(0,g.jsx)(v,{onAcceptTerms:M})})}},54870:(e,t,o)=>{o.d(t,{v:()=>d,Z:()=>m});var i=o(54138),s=o.n(i),n=o(5754),a=o.n(n),r=o(9557),l=o(25190),c=o(43684);let p={tooltip:"EZHUS",green:"pmD2_",red:"pMONo"};var u=o(2629),d={BLACK:"black",GREEN:"green",RED:"red"};let m=e=>{var t=e.children,o=e.content,i=e.tooltipOffsetModifiers,n=e.position,m=void 0===n?c.I2.Right:n,h=e.color,b=void 0===h?d.BLACK:h,g=e.className,v=e.disable,f=e.popoverProps;return(0,l.v$)().isMobile||void 0!==v&&v?t:(0,u.jsx)(r.Z,s()(s()({hasArrow:!0,isChromeless:!0,arrowWrapperClassName:p[b],component:(0,u.jsx)("div",{className:a()("EZHUS",p[b],g),children:o}),position:m,positionBasedOffsetModifiers:void 0===i?{}:i,type:c.Oj.Hover},f),{},{children:t}))}},94462:(e,t,o)=>{o.d(t,{l:()=>n});var i=o(46244),s=o(78667),n=()=>{var e=(0,s.bp)().apiFetch;return(0,i.D)({mutationFn:t=>{var o=t.id,i=t.muted,s=t.blogName,n=t.muteLengthSeconds,a=`/v2/blog/${s}/posts/${o}/mute`;return i?e(a,{method:"DELETE"}):e(a,{method:"POST",body:n?{mute_length_seconds:n}:void 0}api",es=360,n=510},34056:(e,t,o)=>{o.d(t,{F:()=>a,z:()=>n});var i=o(17276),s=o.n(i);function n(e){return new Promise((t,o)=>{setTimeout(()=>s()().async(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,s()().awrap(navigator.clipboard.writeText(e));case 3:return i.abrupt("return",t());case 6:i.prev=6,i.t0=i.catch(0),o();case 9:case"end":return i.stop()}},null,null,[[0,6]],Promise))})}function a(e){e.focus(),e.select();var t=!1;try{t=document.execCommand("copy")}catch(e){}return e.blur(),t}},87517:(e,t,o)=>{o.d(t,{Z:()=>s});var i=o(88451);function s(e,t,o,s){var n=e.href,a=e.method,r=e.bodyParams;return()=>t(n,{method:a,body:(0,i.v)(r)}).then(o).catch(s)}},24228:(e,t,od(t,{b:()=>n});var i=o(34438),s=o(50899),n=function(e,t,o){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"share",a=(0,i.SS)({peeprBlogname:e,peeprPostId:null==t?void 0:t.toString(),peeprPostSlug:o});return`${s.Cw}${a}?source=${n}`}}}]);