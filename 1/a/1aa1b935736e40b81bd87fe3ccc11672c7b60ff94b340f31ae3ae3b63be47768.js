!);var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"redpop@b474a6ad4354f4ba5fde672fa4e9c2c267684761"};"use strict";(self.webpackChunk_tumblr_redpop=self.webpackChunk_tumblr_redpop||[]).push([[7604],{868:(e,t,s)=>{s.d(t,{Z:()=>I,z:()=>T});var i=s(54138),n=s.n(i),a=s(17276),r=s.n(a),o=s(44027),l=s.n(o),h=s(33970),d=s.n(h),p=s(50209),c=s.n(p),u=s(95004),g=s(29583),m=s(23670),v=s(67023),f=s(43523),k=s(63665),b=s(22979),P=s(78667),x=s(49116),S=s(32156),y=s(91264),L=s(64986),R=s(2629),T=e=>{var t=e.timelineName,s=x.K.getItem(t);return s&&JSON.parse(s)};class C extends u.Component{constructor(){var e;super(...arguments),e=this,c()(this,"setHasRestoredTimelineDuringThisSession",e=>{var t=e.timelineName,s=e.restored;return x.K.setItem(t,JSON.stringify(s))}),c()(this,"state",{isShowingRestoredState:!1,latestPostDate:null}),c()(this,"postRefs",[]),c()(this,"objects",[]),c()(this,"nextLinkMap",[]),c()(this,"restoreTimeline",e=>{var t=this.props,s=t.canonicalPath,i=t.didShowRestoredState,n=t.updateUrlFromObjects;window.history.replaceState("","",s);var a=this.getStoredTimeline();if(a){null==n||n(a.objects);var r,o=null===(r=a.objects)||void 0===r?void 0:r.find(b.xT),l=null==o?void 0:o.date,h=e&&i;this.setState({isShowingRestoredState:!0,latestPostDate:!h&&l?l:null},()=>{h&&(null==i||i()),x.E.removeItem(this.getTimelineStorageKey()),this.setHasRestoredTimelineDuringThisSession({timelineName:this.getTimelineStorageKey(),restored:!0})})}}),c()(this,"onUpdatePageLinkClick",()=>{this.props.appContext.logEvent({eventName:f.J.RestoreTimelineIndicatorRefreshTap}),this.hideLatestPostDate()}),c()(this,"hideLatestPostDate",,c()(this,"storeElements",()=>{if(this.nextLinkMap.length&&this.previousPaginatorRequestType!==k.vO.Initial){var e=this.getVisibleElementIndex(),t=this.getNextLinkAndEndingIndex(e),s=d()(t,2),i=s[0],n=s[1];this.setStoredTimeline({nextLink:i,objects:this.objects.slice(e,n)})}}),c()(this,"getVisibleElementIndex",()=>{var e,t=l()(this.postRefs.entries());try{for(t.s();!(e=t.n()).done;){var s=d()(e.value,2),i=s[0],n=s[1];if(null!=n&&n.ref){var a=n.ref.getBoundingClientRect(),r=a.top,o=a.height;if(r+o>g.j0)return i}}}catch(e){t.e(e)}finally{t.f()}return 0}),c()(this,"getNextLinkAndEndingIndex",e=>{var t,s=l()(this.nextLinkMap);try{for(s.s();!(t=s.n()).done;){var i=t.value;if(e>=i.start&&e<=i.end)return[i.nextLink,i.end]}}catch(e){s.e(e)}finally{s.f()}return[this.nextLinkMap[0].nextLink,this.nextLinkMap[0].end]}),c()(this,"onPagination",e=>{var t,s,i=e.objects,n=e.nextLink,a=e.requestType,r=e.response,o=this.props,l=o.onPagination,h=o.appContext.endlessScrollingDisabled;null==l||l({objects:i,nextLink:n,requestType:a,response:r});var d=this.props.getObjectsFromResponse(r);this.objects=i,this.nextLinkMap.push({nextLink:n,start:i.length-d.length-1,end:i.length}),this.previousPaginatorRequestType=a,a===k.vO.Refresh&&(null===(t=(s=this.props).didFinishShowingRestoredState)||void 0===t||t.call(s)),a===k.vO.Pagination&&h&&this.hideLatestPostDate()}),c()(this,"setRefreshCallback",t=>{var s=this.props,i=s.setRefreshCallback,n=s.didFinishShowingRestoredState;null==i||i(function(){return r()().async(function(s){for(;;)switch(s.prev=s.next){case 0:t(),e.hideLatestPostDate(),null==n||n();case 3:case"end":return s.stop()}},null,null,null,Promise)})}),c()(this,"getStoredTimeline",()=>{var e=x.E.getItem(this.getTimelineStorageKey());return e&&JSON.parse(e)}),c()(this,"setStoredTimeline",e=>{var t=e.objects,s=e.nextLink;try{x.E.setItem(this.getTimelineStorageKey(),JSON.stringify({objects:t,nextLink:s}))}catch(e){x.E.removeItem(this.getTimelineStorageKey())}}),c()(this,"getTimelineStorageKey",()=>`${this.props.canonicalPath}-${S.Ye}`)}componentDidMount(){var e=this.props,t=e.shouldRestoreIfPossible,s=e.letTimelineBeRestorable;history.scrollRestoration="manual",document.addEventListener("visibilitychange",this.storeElements),t()?this.restoreTimeline(!0):s&&this.getStoredTimeline()&&s(}ender(){var e=this.state,t=e.isShowingRestoredState,s=e.latestPostDate,i=this.props.appContext,a=i._getLocaleDateString,r=i._c,o=i.bestStuffFirstDisabled,l=s&&a(s,v.C.DateAndTime,!0),h=o&&l?r('Input is a translated date string, e.g., "July 20, 2020, 4:56 PM"',"%1$s - See new posts",[l]):r("Text that refreshes dashboard when clicked","See new posts");return(0,R.jsxs)(R.Fragment,{children:[s&&(0,R.jsx)(m.Z,{to:"/dashboard",className:L.Z.restoreTimelineText,onClick:this.onUpdatePageLinkClick,children:h}),(0,u.createElement)(y.ZP,n()(n()({},this.props),{},{key:`${t}`,getInitialPage:t?this.getStoredTimeline:this.props.getInitialPage,onPagination:this.onPagination,setRefreshCallback:this.setRefreshCallback,forwardedPostRefs:this.postRefs}))]})}}c()(C,"defaultProps",y.ZP.defaultProps);var w=(0,P.HJ)(C);class j extends u.Component{render(){return(0,R.jsx)(w,n()({},this.props))}}c()(j,"defaultProps",C.defaultProps);let I=j},35789:(e,t,s)=>{s.r(t),s.d(t,{default:);var i=s(54138),n=s.n(i),a=s(50209),r=s.n(a),o=s(36485),l=s(52980),h=s(29860),d=s(98724),p=s(30337),c=s(868),u=s(39191),g=s(43597),m=s(61822),v=s(32468),f=s(13883),k=s(71417),b=s(22979),P=s(85795),x=s(78667),S=s(26963),y=s(41708),L=s(48352),R=s(2629);class T extends k.lb{constructor(){super(...arguments),r()(this,"state",(()=>{var e=this.props.appContext,t=e.getBootstrap,s=e.getCookie;return t(y.Rn,{displayMode:s(f.zC.LIKES_DISPLAY_MODE)||b.mt.List})})()),r()(this,"apiHelper",(0,P.ZP)(this.props.appContext.apiFetch)),r()(this,"displayModesSupported",[b.mt.Grid,b.mt.List]),r()(this,"refreshLikesPage",,r()(this,"onPagination",e=>{var t=e.response;return this.setState({likedCount:t.response.likedCount})}),r()(this,"getBody",()=>{var e=this.state,t=e.likedCount,s=e.displayMode,i=this.props,n=i.appContext,a=n._n,r=n._t,o=i.location.pathname,l=(0,R.jsxs)("div",{className:"KyK5m",children:[(0,R.jsx)("div",{className:"aEwvT","data-testid":"like-count",children:!!t&&(t<0?r("Likes"):a("%1$s like","%1$s likes",t))}),(0,R.jsx)("div",{className:"gednn",children:(0,R.jsx)(u.Z,{viewsShown:this.displayModesSupported,onViewClick:this.switchView,currentView:s})})]});return(0,R.jsxs)("div",{className:"NLCTe",children:[l,(0,R.jsx)(c.Z,{id:"likes",shouldRestoreIfPossible:this.shouldRestoreState,canonicalPath:o,endpointApiRequest:this.getLikesApiRequest(),getObjectsFromResponse:this.getObjectsFromResponse,getInitialPage:this.getInitialTimeline,displayMode:s,getNextLink:this.getNextLink,getPrevLink:this.getPrevLink,setRefreshCallback:this.setRefreshCallback,onPagination:this.onPagination,updateUrlFromCurrentPageLink:this.updateQueryParamFromPagination,initialLoader:(0,R.jsx)(d.w,{})})]})}),r()(this,"switchView",e=>this.setState({displayMode:e},this.saveDisplayMode)),r()(this,"saveDisplayMode",()=>this.props.appContext.setCookie(f.zC.LIKES_DISPLAY_MODE,this.state.displayMode)),r()(this,"getLikesApiRequest",()=>{var e=(0,y.OL)(this.props.location.search),t=e.before,s=e.after;return this.apiHelper.getLikes({before:t,after:s})}),r()(this,"getInitialTimeline",()=>{var e=this.state,t=e.likedPosts,s=e.links;return{objects:t,nextLink:null==s?void 0:s.next,prevLink:null==s?void 0:s.prev}}),r()(this,"getObjectsFromResponse",,r()(this,"getNextLink",e=>{var t;return null===(t=e.response.links)||void 0===t?void 0:t.next}),r()(this,"getPrevLink",,r()(this,"updateQueryParamFromPagination",e=>{var t=this.props,s=t.location,i=s.pathname,a=s.search,r=t.navigate,l=(0,y.OL)(e),h=l.before,d=l.after;r((0,o.S)(i,n()(n()({},(0,S.b)(a)),{},{before:h,after:d})))}),r()(this,"shouldRestoreState",()=>!!(0,S.b)(this.props.location.search).restore),r()(this,"setRefreshCallback",}ender(){return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(L.Z,{page:y.HJ.analyticsPageName}),(0,R.jsxs)(m.M.Provider,{value:this.refreshLikesPage,children:[(0,R.jsx)(h.Z,{title:this.props.appContext._c("Title of the Likes page","Likes | Tumblr")}),(0,R.jsx)(l.Z,{activePage:v.vS.likes,children:(0,R.jsx)(g.Z,{sidebar:(0,R.jsx)(p.Z,{showRecommendedBlogs:!0,showRadar:!0}),children:this.getBody()})})]})]})}}let C=(0,x.VP)(T)}}]);