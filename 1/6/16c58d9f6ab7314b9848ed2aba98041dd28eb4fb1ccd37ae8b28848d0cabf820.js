!function(e){new Date;var W=!1;try{var q=Object.defineProperty({},"passive",{get:);window.addEventListener("testPassive",null,q),window.removeEventListener("testPassive",null,q)}catch(e){}var L,D,j=/(\b(https?|ftp):\/\/[-A-Z0-9\u0400-\u04FF+&@$#\/%\[\]?=~_|!:,.;]*[-A-Z0-9\u0400-\u04FF+&@$#\/%\[\]=~_|])/gim,H=/(([a-zA-Z0-9\u0400-\u04FF\-\_\.])+@[a-zA-Z\u0400-\u04FF\_]+?(\.[a-zA-Z\u0400-\u04FF]{2,6})+)/gim,v={mEmptyFragment:function(e){return e?v.m().fragment({key:e},[]):void 0},m:mRedraw:function(){window.chaport.getChatManager().redrawAll&&window.chaport.getChatManager().redrawAll(),v.m().redraw()},classMapToString:function(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&e[t]&&n.push(t);return n.join(" ")},isDeviceIOS:function(){return!window.MSStream&&(/iPad|iPhone|iPod/.test(navigator.userAgent)||-1!==["MacIntel","iPhone"].indexOf(navigator.platform)&&1<navigator.maxTouchPoints)},isDeviceAndroid:isWindowsOS:function(){return/Win/.test(navigator.userAgent)},isMacOS:escapeHtml:function(e,t){return null==e?"":(e=String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),t?e:e.replace(/>/g,"&gt;"))},unEscapeHtml:deepGet:function(e,t){if(t){if(0===t.length)return e;for(var n=e,o=0,i=t.length;o<i;o++){if(!n)return;n=n[t[o]]}return n}},deepSet:function(e,t,n){if(!e||"object"!=typeof e)throw new Error("deepSet requires an object");if(e&&t&&0!==t.length){for(var o,i=(t=t.concat([])).pop(),a=0,r=t.length;a<r;a++)void 0!==e[o=t[a]]&&null!==e[o]||(e[o]={}),e=e[o];return e[i]=n}},getTranslatedText:function(e){return e&&e.constructor===Array?window.i18n.translate.apply(null,e):String(e)},ensureProtocol:function(e){return e&&"string"==typeof e?0===e.indexOf("http")?e:"http://"+e:null},brToNl:function(e){return null==e?"":String(e).replace(/<br>/g,"\n")},nlToBr:nlNlToP:function(e){return null==e?"":("<p>"+String(e).replace(/\n\n/g,"</p><p>")+"</p>").replace(/<p><\/p>/g,"\n\n")},on:function(e,t,n,o){e.addEventListener?e.addEventListener(t,n,W&&o||!1):e.attachEvent("on"+t,n)},off:function(e,t,n,o){e.removeEventListener?e.removeEventListener(t,n,W&&o||!1):e.detachEvent&&e.detachEvent("on"+t,n)},once:function(t,n,o){v.on(t,n,function e(){v.off(t,n,e);o.apply(this,arguments)})},hasCssClass:function(e,t){return!!t&&-1!=v._getCssClassNames(e).indexOf(t)},addCssClass:function(e,t){v.hasCssClass(e,t)||(e.className+=(e.className.length?" ":"")+t)},removeCssClass:function(e,t){var n=v._getCssClassNames(e).filter(;v._setCssClassNames(e,n)},replaceCssClass:function(e,t,n,o){var i=v._getCssClassNames(e),t=i.indexOf(t),a=i.indexOf(n);-1!==t?(i[t]=n,v._setCssClassNames(e,i)):o&&-1===a&&(i.push(n),v._setCssClassNames(e,i))},toggleCssClass:function(e,t,n){var o="object"==typeof t?t:{};for(t in"object"!=typeof t&&(o[t]=n),o)o.hasOwnProperty(t)&&(void 0===(n="function"==typeof(n=o[t])?n():n)?v.hasCssClass(e,t)?v.removeCssClass(e,t):v.addCssClass(e,t):n?v.addCssClass(e,t):v.removeCssClass(e,t))},cssHide:function(e){v.hasCssClass(e,"chaport-show")?v.replaceCssClass(e,"chaport-show","chaport-hide"):v.addCssClass(e,"chaport-hide")},cssShow:function(e){v.hasCssClass(e,"chaport-hide")?v.replaceCssClass(e,"chaport-hide","chaport-show"):v.addCssClass(e,"chaport-show")},_getCssClassNames:function(e){return e.className&&e.className.split?e.className.split(" ").filter(:[]},_setCssClassNames:_getCssClassIndex:function(e,t){return(" "+e.className).indexOf(" "+t)},_isIframe:null,isIframe:function(){return null===this._isIframe&&(this._isIframe=window.parent!==window&&-1===window.location.href.indexOf("direct=1")),this._isIframe},postMessageTopIfIframe:function(e){v.isIframe()&&v.doWhenWindowReady(function(){window.parent.postMessage(e,"*")})},doWhenWindowReady:function(t){var n;loading"!==window.document.readyState?v.doNextTick(t):(n=!1,v.on(window,"DOMContentLoaded",e),v.on(window,"load",e))},doNextTick:function(e){setTimeout(e,0)},createEvent:function(e,t,n){var o;return"function"==typeof Event?o=new Event(e,{bubbles:t,cancelable:n}):(o=document.createEvent("Event")).initEvent(e,t,n),o},triggerResize:function(e){var t=v.createEvent("autosize:update",!0,!1);e.dispatchEvent(t)},setCursorToEnd:clear:function(e){if(v.isIE())for(;e.lastChild;)e.removeChild(e.lastChild);else e.innerHTML=""},sendXmlHttpRequest:function(e,t){var n,o=new XMLHttpRequest;if(o.open(t?"POST":"GET",e,!0),"object"==typeof t&&t.constructor!==Array){for(var i in n=[],t)t.hasOwnProperty(i)&&n.push(encodeURIComponent(i)+"="+encodeURIComponent(t[i]));t=n}t&&t.constructor===Array&&(t=t.join("&")),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.send("string"==typeof t?t:void 0)},registerError:function(e){var t,n,o,i,a;window.chaport&&(o=window.chaport.isWidget?"widget":window.chaport.__included?"insert":"app",e=(n="colno"in e?e:null)?n.error:e,i=n&&n.filename||e&&e.fileName||"",a=n&&n.lineno||e&&e.lineNumber||"",t=n&&n.colno||e&&e.columnNumber||"",n=n&&n.message||e&&e.message||"",e=e&&e.stack||"",i&&(0===i.indexOf("chrome://")||0===i.indexOf("moz-extension://")||0===i.indexOf("chrome-extension://"))||(o=["source="+o,"ua="+encodeURIComponent(navigator.userAgent.substring(0,250)),"url="+encodeURIComponent(i.substring(0,50)),"ln="+encodeURIComponent(String(a).substring(0,20)),"col="+encodeURIComponent(String(t).substring(0,20)),"message="+encodeURIComponent(String(n).substring(0,100)),"stack="+encodeURIComponent(String(e).substring(0,1e3))],window.chaport.isWidget&&((i=window.chaport.getChatManager().getLocation())&&i.href&&o.push("hurl="+encodeURIComponent(i.href.substring(0,50))),(a=window.chaport.getAuthManager().siteId)&&o.push("appid="+encodeURIComponent(String(a).substring(0,50))),v.isIframe()||o.push("direct=true"),0!==(i=document.location.href).indexOf("https://app.chaport.com"))&&o.push("location="+encodeURIComponent(i.substring(0,100))),v.sendXmlHttpRequest("https://app.chaport.com/error-report",o)))},isIE:function(){var e,t;return void 0===v._ie&&(v._ie=(e=window.navigator.userAgent,0<(t=e.indexOf("MSIE "))?parseInt(e.substring(t+5,e.indexOf(".",t)),10):0<e.indexOf("Trident/")?(t=e.indexOf("rv:"),parseInt(e.substring(t+3,e.indexOf(".",t)),10)):0<(t=e.indexOf("Edge/"))&&parseInt(e.substring(t+5,e.indexOf(".",t)),10))),v._ie},render:(D=[],F.flush=F),tRender:function(e,t){var n;return function(){n=n||v.render(e,o)};function o(){t.apply(this,arguments),n=void 0}},insertAtCursor:function(e,t){var n,o;document.selection?(e.focus(),document.selection.createRange().text=t):e.selectionStart||"0"==e.selectionStart?document.queryCommandSupported("insertText")?document.execCommand("insertText",!1,t):(n=e.selectionStart,o=e.selectionEnd,e.value=e.value.substring(0,n)+t+e.value.substring(o,e.value.length),e.selectionStart=n+t.length,e.selectionEnd=n+t.length):e.value+=t},getTextAfterInsert:function(e,t){e=void 0!==e.selectionStart?e.value.substring(0,e.selectionStart)+t+e.value.substring(e.selectionEnd,e.value.length):e.value+t;return e},onTransitionEnd:function(e,t,n){v.on(e,"transitionend",a),v.on(e,"webkitTransitionEnd",a),v.on(e,"msTransitionEnd",a),v.on(e,"oTransitionEnd",a),n&&(o=setTimeout(a,n));var o,i=!1;function a(){i||(i=!0,t(),r())}function r(){v.off(e,"transitionend",a),v.off(e,"webkitTransitionEnd",a),v.off(e,"msTransitionEnd",a),v.off(e,"oTransitionEnd",a),o&&clearTimeout(o)}return r},overlay:function(e){e=e||{};var t,n=document.getElementsByTagName("body")[0],o=document.createElement("div");o.className=e.className||"chaport-overlay",o.innerHTML='<div class="chaport-overlay-contents-wrapper"><div class="chaport-overlay-contents"></div></div><div class="chaport-close visible"></div>',e.contents&&(t=o.querySelector(".chaport-overlay-contents"),e.contents instanceof Node?t.appendChild(e.contents):t.innerHTML=e.contents),n.appendChild(o),v.once(o,"click",function(){v.render(null,function(){v.onTransitionEnd(o,1e3),v.removeCssClass(o,"show")})}),v.render(null,function(){v.addCssClass(o,"show")})},getCreds:function(e,t){var n,o="chaport-"+e,o=document.cookie.match(new RegExp("(?:^|; )"+o.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)")),o=o?decodeURIComponent(o[1]):void 0;return n=!(n=o&&2===(o=o.split("/")).length?{id:o[0],token:o[1]}:n)&&t?v.createNewCreds(e):n},createNewCreds:function(e,t,n){var e="chaport-"+e,o=(void 0===n&&(n=!0),(t=t||{}).id||(t.id=v.getId()),t.token||(t.token=v.getToken()),[t.id,t.token].join("/")),i=new Date((new Date).getTime()+31104e6);return document.cookie=e+"="+encodeURIComponent(o)+"; path=/"+(n?";expires="+i.toUTCString():""),t},clearCreds:getId:getToken:function(){for(var e=a(35,45),t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=n.length,i=0;i<e;++i)t+=n[a(0,o-1)];return t;,urlsToLinks:function(e){return null==e?"":String(e).replace(j,function(e){var t=e.length;return'<a href="'+e+'" title="'+e+'" target="_blank">'+(47<t?e.substring(0,35)+"..."+e.substring(t-10):e)+"</a>"}).replace(H,'<a href="mailto:$1" target="_blank">$1</a>')},isColorLight:function(e){var t=parseInt(e.slice(1,3),16),n=parseInt(e.slice(3,5),16),e=parseInt(e.slice(5,7),16);return 45300<t*t*.299+n*n*.587+e*e*.114},hexToRGBA:wrapWithSpan:getPostfixed:function(e,t,n){return t?e+(n||"_")+t:e},debounce:function(n,o){function e(){var e=this,t=arguments;return clearTimeout(i),i=setTimeout(function(){i=null,a=n.apply(e,t)},o),a}var i,a;return e.immediate=e},getTransferUrl:getFaviconUrl:function(e){return this.getUploadUrl(e,"/site-favicon")},getLogoUrl:function(e){return this.getUploadUrl(e,"/site-logo/x60")},getOperatorImageTmpUrl:function(e){return this.getUploadUrl(e,"/operator-images/tmp")},getOperatorImageUrl:getUploadUrl:function(e,t){return this.getBaseUploadUrl()+t+"/"+encodeURIComponent(e)},getBaseUploadUrl:;function F(e,t){return D.push({init:e,update:t}),L=L||Se(G)}function G(){L=void 0;var e=D;D=[];for(var t=e.length,n=[],o=0;o<t;o++)n.push(e[o].init?e[o].init():null);for(o=0;o<t;o++)e[o].update(n[o])}v.mRedrawAsync=v.tRender(null,v.mRedraw);var w=function(e){void 0===e.chaportConfig&&(e.chaportConfig=function(t){var n={};return["analytics","appearance","app_id","appId","assignment","closeButton","countries","devices","history","init","integration","lang","language","launcher","openIn","operators","responsive","session","server","socket","title","triggers","unreads","useHtmlLang","visitor","visitorIntegrityHash"].forEach(,n}(e.chaport||"undefined"!=typeof _pws&&_pws||{}));void 0===e.chaportConfig.appId&&void 0!==e.chaportConfig.app_id&&(e.chaportConfig.appId=e.chaportConfig.app_id);return e.chaportConfig}(e);if(void 0!==w.appId){q=e;var r=(e=w).__globalName?q[e.__globalName]:q.chaport;if(void 0!==r&&(e=r)&&!e.__included){r.__included=!0;var J,V,z=!1,o=null,c=null,X=v.isDeviceIOS(),$=v.isDeviceAndroid(),y=X||$,Z=!0,C={},Y=new Date,Q=null,K=!1,ee=!1,i=[],te=!1,ne=!1,oe={left:null,top:null};if(rn(w.devices,sn())){var ie=w;if(ie.devices&&ie.devices.configs)for(var ae,re=ie.devices.configs,se=sn(),ce=0,le=se.length;ce<le;++ce)(ae=re[se[ce]])&&!function e(t,n){for(var o in n)n.hasOwnProperty(o)&&(t[o]&&"object"==typeof n[o]&&"object"==typeof t[o]?e(t[o],n[o]):t[o]=n[o])}(ie,ae);Kt(w);var Z=function(){if(void 0!==w.responsive)return w.responsive;for(var e=document.getElementsByTagName("head")[0].getElementsByTagName("meta"),t=0,n=e.length;t<n;t++){var o=e[t];if("viewport"===o.getAttribute("name")){o=o.getAttribute("content");if(o&&/width\s*=\s*device-width/.test(o))return!0}}return!1}(),l={listeners:{},states:{},setState:function(e){e.constructor===Array?e.forEach(:void 0!==this.states[e]&&(this.states[e]=!0,this.emit(e))},is:expect:function(e,t){var n,o,i,e=(e=e.constructor!==Array?[e]:e).filter(;0===e.length?setTimeout(t,0):(n=t,o=[].concat(e),i=!1,o.forEach(function(t){l.once(t,function(){var e=o.indexOf(t);-1!==e&&o.splice(e,1),0!==o.length||i||(i=!0,n())})}))},resetGlobal:function(){this.states.storageReady=!1,this.states.apiInit=!1,this.states.globalInit=!1,this.states.dataReady=!1,this.states.domReady=!1,this.states.cssReady=!1,this.states.appearanceReady=!1},resetSession:function(){this.states.initialPageViewReady=!1,this.states.iframeReady=!1,this.states.iframeLoading=!1,this.states.connectionReady=!1,this.states.connecting=!1,this.states.visitorReady=!1,this.states.triggersReady=!1,this.states.widgetReady=!1,this.states.chatReady=!1,this.states.sessionInit=!1,this.states.chatStarted=!1}},s=(lo(l),l.resetGlobal(),l.resetSession(),{listeners:{},isTargetMessage:function(e){return!(!e||"string"!=typeof e.data||0!==(e=e.data).indexOf("::cp:")&&0!==e.indexOf("::wsc:"))},dispatchMessages:function(){v.on(window,"message",T(this.handleMessage,this))},handleMessage:function(e){try{if(this.isTargetMessage(e)&&function(t){"https://app.chaport.com"!==t.origin&&!function(e){throw new Error("iframe message is invalid: "+e+"; "+t.data)}('origin "'+t.origin+'" is not allowed');if(!g)return;t.source===g.contentWindow||g.src&&0===g.src.indexOf(t.origin)||v.registerError(new Error("message source does not match iframe, source="+t.origin+", iframe="+g.src));return 1}(e)){var t,n,o=e.data,i=0===o.indexOf("::cp:"),a=0===o.indexOf("::cp:request:"),r=null;if(a)return-1===(n=(o=o.replace("::cp:request:","")).indexOf(":"))?t=o:(t=o.substr(0,n),r=JSON.parse(o.slice(n+1))),A("response:"+t,this.emitAndWait(t,r));if(i)-1===(n=(o=o.slice(5)).indexOf(":"))?t=o:(t=o.substr(0,n),r=JSON.parse(o.slice(n+1)));else if(-1!==o.indexOf("::wsc:styles:"))t="styles",r=decodeURIComponent(o.replace("::wsc:styles:",""));else if(-1!==o.indexOf("::wsc:update:activity"))t="update-activity";else if(-1!==o.indexOf("::wsc:widget-ready"))t="widget-ready";else{if(-1!==o.indexOf("::wsc:unread:"))return;-1!==o.indexOf("::wsc:triggers:")?(t="triggers",r=decodeURIComponent(o.replace("::wsc:triggers:",""))):"::wsc:check:expanded"===o?t="check-expanded":-1!==o.indexOf("::wsc:session:")?(t="session",r=e.data.replace("::wsc:session:","")):-1!==o.indexOf("::wsc:visitor-id:")?(t="visitor-id",r=o.replace("::wsc:visitor-id:","")):"::wsc:widget:close"===o?t="widget-close":-1!==o.indexOf("::wsc:image-overlay:")?(t="image-overlay",r=o.replace("::wsc:image-overlay:","")):"::wsc:track:activity"===o?t="track-activity":-1!==o.indexOf("::wsc:message:")&&(t="message",r=JSON.parse(o.replace("::wsc:message:","")))}t&&this.fireEvent(t,r)}}catch(e){v.registerError(e)}}}),ue=(lo(s),!1),a={isSupported:!1,listener:!1,watch:{}},u={isSupported:!1,listener:!1,watch:{}},de={};try{sessionStorage.setItem("cp_test",1),sessionStorage.removeItem("cp_test"),a.isSupported=!0}catch(e){a.isSupported=!1}try{localStorage.setItem("cp_test","123"),"123"===localStorage.getItem("cp_test")?(localStorage.removeItem("cp_test"),u.isSupported=!0):u.isSupported=!1}catch(e){u.isSupported=!1}for(var pe,fe=["connected_once","active_trigger",v.getPostfixed("active_trigger",w.appId),"page_views","pages","utm","referrer"],he=(s.on("chat-started",function(e){e?(B(),ao(),O("utm"),O("pages"),l.setState("chatStarted")):null===Q&&l.expect(["triggersReady"],Jn),Q=e,l.setState("chatReady")}),setTimeout(5e3),{getUrl:function(e){return"https://m.me/"+e.id}}),ge={getUrl:function(e){return"https://t.me/"+e.id}},me={getUrl:function(e){return"viber://pa?chatURI="+e.id}},ve={getUrl:,we={onClick:,ye=!1,d={list:[],load:function(n){Zt(w.appId,"/channels","GET",function(e,t){d.list=(t&&t.constructor===Array?t:[]).filter(,n&&n()})},find:function(e){for(var t=0,n=d.list.length;t<n;t++)if(d.list[t].platform===e)return d.list[t]},use:function(e,t){e=wt(e);if(e&&e.onClick)return e.onClick(t)}},Ce=(s.on("chat-active",,pe="https://server.chaport.com",{getServerUrl:loadAccountEssentials:function(e,t,s){Zt(e,"/account-essentials?language="+encodeURIComponent(t||""),"GET",function(e,t){if(e)return v.registerError(e);if(t&&(!1!==t.chat&&(t.appId&&(w.appId=t.appId),t.features&&(e=t.features,x=e,w)&&(w.analytics&&!kt()&&delete w.analytics,w.visitor&&!Rt()&&(delete w.visitor,delete w.visitorIntegrityHash),w.triggers&&!St()&&delete w.triggers,w.appearance&&!Ot()&&delete w.appearance,w.countries&&!x.countryFilter&&delete w.countries,w.assignments&&!Tt()&&delete w.assignments,Et()||(delete w.assignments,delete w.operators,delete w.session,Kt(w),Nt())||(delete w.lang,delete w.language,delete w.useHtmlLang,delete w.openIn,delete w.launcher,delete w.devices)),At({resolve:w.assignments&&w.assignments.resolve,rules:w.assignments&&w.assignments.rules,defaultRules:w.assignments&&w.assignments.defaultRules||t.assignmentRules}),!w.countries||rn(w.countries,t.country)))){if(d.list=t.channels&&t.channels.constructor===Array?t.channels:[],t.texts){if(t.texts.inputLabel&&(e=t.texts.inputLabel,p.input=e,C)&&C.messageInput&&(C.messageInput.textContent=e),t.texts.chatLabel){e=t.texts.chatLabel;p.websiteChannel=e,C&&C.channelsList&&(n=U("chaport-channel-website",C.channelsList))&&(n.textContent=e)}if(t.texts.cancelLabel){var n=t.texts.cancelLabel;p.cancel=n,C&&C.channels&&(e=U("chaport-channels-cancel",C.channels))&&(e.textContent=n)}t.texts.unreadTitlePattern&&(e=t.texts.unreadTitlePattern,p.unreadTitlePattern=e)}t.settings&&!1===t.settings.autoInvitationSound&&(it=!1);var o,i,a,e=w.appearance&&w.appearance.windowColor||t.appearance&&t.appearance.windowColor,r=w.appearance&&w.appearance.position||t.appearance&&t.appearance.position,r=("#"===e[0]||-1!==["rgb","hsl"].indexOf(e.substring(0,3))?(a="chaport-window-custom",o=e,i=!0):(a="chaport-window-"+e,o=""),h={primaryColorClass:a,color:o,position:r,colorContrast:i&&v.isColorLight(e)?"#33383a":o},i&&"#"===e[0]&&v.isColorLight(e)&&v.addCssClass(document.body,"chaport-color-light"),l.expect(["domReady"],function(){var e,t;v.addCssClass(c,h.primaryColorClass),i&&(e=h.colorContrast||h.color,t=document.createElement("style"),document.head.appendChild(t),(t=t.sheet).insertRule(".chaport-window-custom .chaport-message-with-replies .reply-option:hover { background-color: "+e+" !important; color: #fff !important}",0),t.insertRule(".chaport-window-custom .chaport-message-with-replies .reply-option:active { background-color: "+e+" !important; color: #fff !important}",1))}),dn(h.position),l.setState("appearanceReady"),t.country&&uo("country",t.country),t.language&&uo("language",t.language),t.serverUrl&&(a=t.serverUrl,pe=a),t.visitorId&&t.visitorId,t.appId&&(w.appId=t.appId),t.integration&&(w.integration=t.integration),cn(t.cssUrl),t.audioPlayerUrl&&void 0!==S&&S.setPlayerAssetPath(t.audioPlayerUrl),w.appearance&&w.appearance.widgetSound||t.appearance&&t.appearance.widgetSound);r&&S.setDefaultSound(r,!1),t.triggers&&(zn(t.triggers),ho()),l.setState("dataReady"),s&&s()}})},loadVisitorEssentials:function(e,o,t,i){var n=["id="+encodeURIComponent(o.id),"token="+encodeURIComponent(o.token)];o.isCustom&&n.push("custom=1");t&&n.push("noCookie=1");Yt(e,"/visitor-essentials?"+n.join("&"),"GET",function(e,t){e&&v.registerError(e);var n=T(kn,null,[w,o,t&&t.exists]),e=!1;w.init&&(e=!0,w.init.event&&("load"===w.init.event&&"complete"===document.readyState?n():v.once(w.init.eventTarget||window,w.init.event,function(){n()})),"number"==typeof w.init.maxDelay)&&setTimeout(function(){n()},w.init.maxDelay),e||n(),l.setState("visitorReady"),i&&i(t)})}}),be=v.tRender(function(e){var t=118+pn();J=Math.min(e-t,667),b===P.expanded&&yt()}),xe=!1,_e=!1,Ie=v.debounce(function(){void 0!==w.closeButton?_e=w.closeButton:(_e=!1,ee?_e=!0:C.widgetWindow?0===parseInt(window.getComputedStyle(C.widgetWindow).borderRadius)&&(_e=!0):_e=y),xe||(xe=!0,An(function(){xe=!1,A("api:setClose",_e)}))},100),Se=(l.expect("cssReady",Ie),window.requestAnimationFrame),Te=window.cancelAnimationFrame,Oe=0,Re=["webkit","moz"],ke=0;ke<Re.length&&!Se;++ke)Se=window[Re[ke]+"RequestAnimationFrame"],Te=window[Re[ke]+"CancelAnimationFrame"]||window[Re[ke]+"CancelRequestAnimationFrame"];Se=Se||Te=Te||function(e){clearTimeout(e)};var p={websiteChannel:"Chat",cancel:"Cancel",input:"",unreadTitlePattern:"(__COUNT__)"};if(Mn(),(e=w).visitor&&r.q("setVisitorData",[e.visitor,e.visitorIntegrityHash]),e=function(e){var t,n,o,i,a,r;(t=e.search.match(/utm_source=([^&]+)/i))&&(n=decodeURIComponent(t[1].replace(/\+/g,"%20")));(t=e.search.match(/utm_medium=([^&]+)/i))&&(o=decodeURIComponent(t[1].replace(/\+/g,"%20")));(t=e.search.match(/utm_term=([^&]+)/i))&&(i=decodeURIComponent(t[1].replace(/\+/g,"%20")));(t=e.search.match(/utm_campaign=([^&]+)/i))&&(a=decodeURIComponent(t[1].replace(/\+/g,"%20")));(t=e.search.match(/utm_content=([^&]+)/i))&&(r=decodeURIComponent(t[1].replace(/\+/g,"%20")));return n||o||i||a||r?{source:n,medium:o,term:i,campaign:a,content:r}:void 0}(window.location))k("utm",JSON.stringify(e)),uo("utm",e),l.is("iframeReady")&&vn(e);var t=document.referrer,e=t.indexOf(window.location.host);if((t=-1<e&&e<10||0!==t.indexOf("http")?"":t)&&"undefined"!=typeof URL)try{new URL(t)}catch(e){t=""}l.expect(["storageReady"],function(){var e=Tn();e||""===t||(k("referrer",Me=t),uo("referrer",t)),(e||t)&&l.expect(["iframeReady"],On)}),!1!==w.history&&y&&(v.on(window,"popstate",function(e){e=Sn(e.state);e&&b===P.collapsed?r.q("open"):e||b!==P.expanded||r.q("close")}),Sn(window.history.state)&&r.q("open"),r.on("widget.stateChange",function(e){if(!e||!e.payload||e.payload.history)try{var t=Sn(window.history.state);t&&"collapsed"===e.toState&&"expanded"===e.fromState?window.history.go(-1):t||"expanded"!==e.toState||window.history.pushState(In(),"")}catch(e){v.registerError(e)}})),Ce.loadAccountEssentials(w.appId,hn(w),function(){v.doWhenWindowReady(function(){function e(){var e=window.getComputedStyle(document.getElementsByTagName("body")[0])||{};return{screenWidth:screen.width,layoutViewportWidth:document.documentElement.clientWidth,bodyMarginTop:-1!==["relative","absolute","fixed"].indexOf(e.position)?e.marginTop:"0",visualViewportWidth:window.innerWidth,visualViewportHeight:window.innerHeight,pageXOffset:window.pageXOffset,pageYOffset:window.pageYOffset}}It(),y&&!Z&&screen&&(o=v.tRender(e,function(e){e.screenWidth&&e.visualViewportWidth&&(t&&clearTimeout(t),t=setTimeout(n,50))}),n=v.tRender(e,function(e){e.screenWidth&&e.visualViewportWidth&&(t=1/(screen.width/e.visualViewportWidth),c.style.fontSize=14*t+"px",C.launcherRoot.style.fontSize=14*t+"px");var t;t=(t=parseInt(e.bodyMarginTop.replace("px","")))||0,function(e,t){oe.left=e,oe.top=t,ne&&bt(e,t)}(e.pageXOffset,e.pageYOffset+e.visualViewportHeight-t-1),c.style.setProperty("width",e.visualViewportWidth-1+"px","important")}),v.on(window,"scroll",o),v.on(window,"resize",o),g&&v.on(g.contentWindow,"resize",o),o()),s.dispatchMessages(),o=Et(),i=St(),r.disableTriggers=o&&i?B:N,r.enableTriggers=o&&i?Xn:N,r.isOnline=o?on:N,r.startSession=o?en:N,r.stopSession=o?tn:N,r.q=Bt,Lt(),l.expect(["sessionInit"],qt);var t,n,o,i=w.launcher,i=((i=i||{show:!0}).show||ln(),w),a=i.triggers;(a=!1!==(a=void 0===a?{}:a)&&!0!==a?a:{enabled:a}).keep=!1!==a.keep,a&&(!0===a.enabled||!1===a.disabled?Xn():!1===a.enabled||!0===a.disabled?B():a.enabled&&a.enabled.constructor===Array?(B(),Xn(a.enabled)):a.disabled&&a.disabled.constructor===Array&&B(a.disabled)),i.triggers=a,function(e){if(kt()){var t=e.analytics;if(t?t.gaTrackerName&&(t={google:{id:t.gaTrackerName}}):t={google:{}},t&&t.google&&!1!==t.google.enabled){if(!t.google.api){if(t.google.apiObject)return console.error("chaport: analytics.google.api is required if you pass analytics.google.apiObject");var n="function"==typeof gtag?"gtag":window.dataLayer&&"function"==typeof window.dataLayer.push?"gtm":window.GoogleAnalyticsObject&&"function"==typeof window[window.GoogleAnalyticsObject]||"function"==typeof ga?"ga":"undefined"!=typeof _gaq?"gaq":void 0;n&&(t.google.api=n)}if(!t.google.api)return t.google={enabled:!1,apiNotFound:!0};Pe=function(e){if(e){var n=e.id;switch(e.api){case"gtag":var t=e.apiObject||window.gtag;return t?{gtag:t,sendEvent:function(e){this.gtag("event",e,n?{send_to:n}:void 0)}}:void console.error("chaport: gtag is not found on page");case"gtm":var o=e.apiObject||window.dataLayer;return o?{gtag:sendEvent:function(e){this.gtag("event",e,n?{send_to:n}:void 0)}}:void console.error("chaport: gtm is not found on page");case"ga":var i=e.apiObject||(window.GoogleAnalyticsObject&&"function"==typeof window[window.GoogleAnalyticsObject]?window[window.GoogleAnalyticsObject]:window.ga);return i?(n||i(function(){var e=i.getAll();0<e.length&&(n=e[0].get("name"))}),{ga:i,sendEvent:function(e,t){this.ga(n?n+".send":"send","event",t,e)}}):void console.error("chaport: ga is not found on page");case"gaq":return{gaq:e.apiObject||window._gaq,sendEvent:;default:console.error("chaport: unknown analytics.google.api value is passed, should be one of",["gtag","gtm","ga","gaq"])}}}(t.google)}e.analytics=t}}(w),w.session&&w.session.autoStart&&en(w.session.user)})});ar f,Ne,Ae,Ue,h,Pe,Me,g,Be,We,qe,b,Le,De,je,He,Fe,Ge,Je,Ve,x={},_=(l.expect(["apiInit","initialPageViewReady"],Ut),s.on("applyAssignmentRules",function(e){if(e&&"object"==typeof e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&uo(t,e[t]);return Ut(!0)}),!1),I=(s.on("failedIdentity",function(e){var t;e&&e.isCustom?(console.error("it seems that the provided credentials are not valid"),t=f.id,tn(!1,):(_=null,v.clearCreds(w.appId),en({forceNew:!0}))}),s.on("visitor-id",function(e){null===e&&v.clearCreds(w.appId)}),{list:null,online:null,since:null}),ze=null,Xe=(s.on("styles",function(e){cn(e)}),!1),$e=(l.expect(["iframeReady","storageReady"],,l.expect(["iframeReady","storageReady"],function(){xn()}),l.expect(["storageReady"],function(){gt("pages",,l.expect(["iframeReady"],xn)}),l.expect(["connectionReady"],,{"chat.started":{category:"chaport_chats",event:"chat_start"},"chat.autoInvitation":{category:"chaport_chats",event:"auto_invitation_view"},"chat.botSent":{category:"chaport_chats",event:"chatbot_view"}}),Ze=[],Ye=(s.on("connected",function(){l.setState("connectionReady"),R("connected_once")||k("connected_once","1")}),s.on("ready",function(){l.setState("iframeReady")}),l.expect(["storageReady","visitorReady"],function(){R("connected_once")?En():gt("connected_once",}),!1),Qe=(s.on("update-activity",function(){Pn()}),s.on("track-activity",,s.on("update-activity",function(){Pn()}),0),Ke=!1,et=document.title,tt={handleEvent:function(e,t){$t(e,t),t=e,kt()&&Pe&&(t=$e[t])&&Pe.sendEvent(t.event,t.category)}},nt=(s.on("eventNotification",,P.classGroups={visibility:[["chaport-anim-hide","chaport-anim-show"],[100,0]],size:[["chaport-collapsed","chaport-collapsed-message","chaport-semi-expanded","chaport-expanded","chaport-show-channels"],[0,100,100,100,0,100,100,100,0,0,100,100,0,0,0,100,0,0,0,0]]},P.collapsed=new P({widgetWindow:!1,message:!1,launcherButton:!0,channels:!1,root:["size","chaport-collapsed"]},{afterIn:function(){Qn()}}),P.expanded=new P({widgetWindow:!0,message:!1,launcherButton:!0,channels:!1,root:["size","chaport-expanded"]},{beforeIn:function(e){var t=0;return void 0===e.animate&&(e.animate=K),y?(lastPageScrollPosition=window.pageYOffset,v.addCssClass(o,"chaport-mobile"),v.addCssClass(o,"chaport-mobile-maximized-hide"),t=0):(v.toggleCssClass(C.message,"chaport-window-anim",!1!==e.animate),v.toggleCssClass(C.widgetWindow,"chaport-window-anim",!1!==e.animate)),qe&&(clearTimeout(qe),qe=null),ho(),yt(),fn(),Nn("::wsc:before:expand"),t},afterIn:function(e){Dn(),y&&Z&&(window.scrollTo(0,0),v.addCssClass(o,"chaport-mobile-maximized"),v.render(null,),Qn(),Fn(),Nn("::wsc:expanded"+(!1!==e.autoFocus?":focus":""))},beforeOut:function(e){var t=0;return void 0===e.animate&&(e.animate=K),y&&(v.removeCssClass(o,"chaport-mobile-maximized"),v.addCssClass(o,"chaport-mobile-maximized-hide"),window.scrollTo(0,lastPageScrollPosition),lastPageScrollPosition=null,t=0),v.toggleCssClass(C.message,"chaport-window-anim",!1!==e.animate),v.toggleCssClass(C.widgetWindow,"chaport-window-anim",!1!==e.animate),t},afterOut:function(){Nn("::wsc:collapsed"),k("widget_last_closed",(new Date).getTime()),y&&(v.removeCssClass(o,"chaport-mobile-maximized-hide"),v.removeCssClass(o,"chaport-mobile")),qe&&clearTimeout(qe),qe=setTimeout(Ct,200)}}),P.unreadMessage=new P({widgetWindow:!1,message:!0,launcherButton:!0,channels:!1,root:["size","chaport-semi-expanded"]}),P.channels=new P({widgetWindow:!1,message:!1,launcherButton:!1,channels:!0,root:["size","chaport-show-channels"]}),P.hidden=new P({widgetWindow:!1,message:!1,launcherButton:!1,channels:!1}),!1),ot=[],it=(window.viewStateChangesQueued=ot,s.on("check-expanded",function(){b===P.expanded&&Nn("::wsc:expanded")}),s.on("widget-close",function(){Vt()}),s.on("image-overlay",,s.on("message",function(e){function t(){var e;Qe?(e="("+Qe+") "+et,n(!1===K&&We===e?p.unreadTitlePattern.replace("__COUNT__",Qe):e)):(clearInterval(Be),Be=void 0,n(et))}function n(e){We!==e&&(document.title=We=e)}Qe++,Mn(),w.title&&!1===w.title.messageNotification||Be||(Be=setInterval(t,1e3),t()),b!==P.expanded&&Hn(e)}),s.on("unread",function(e){var t,n;e&&e.count?(t=e.lastMessage)&&(n=t.author,Hn({text:t.text,operators:[{image:n&&n.image}],name:n&&n.name,type:null},e.count)):Dn()}),!0),n={isEnabled:!0,exceptions:[]},at=!1,rt=(l.expect(["storageReady","sessionInit"],,s.on("triggers",,[]),st=null,ct=(l.expect(["storageReady"],function(){eo()?co():gt(v.getPostfixed("active_trigger",w.appId),}),null),lt=null,ut=null,S=(Je=Ge=Fe=null,Ve=!1,{init:function(){window.chaport.isWidget&&v.isIframe()&&(Ve=!0)},play:function(t){if("none"!==t){if(Ve)return v.postMessageTopIfIframe("::cp:audio:"+JSON.stringify([t]));if(!Fe){if("function"==typeof window.chaport.getMobileManager){var e=window.chaport.getMobileManager();if(e.isMobileApp&&e.isPaused())return}Fe=setTimeout(1e3),fo(function(e){e.play(t||Je||"beep")})}}},load:po,getPlayer:fo,setPlayerAssetPath:setDefaultSound:function(e,t){Je=e||"beep",!1!==t&&po(Je)}}),dt=(s.on("audio",function(e){var t=e&&e.method?e.method:"play",e=e&&e.args;S[t].apply(S,e)}),!1),pt=(go.prototype.getShallowData=function(){var e=this.actionChain.actions[0];return{triggerId:this.id,isBot:this.isBot,interruptable:this.interruptable,message:e.params.message,replyOptions:e.params.replyOptions,operatorId:this.operatorId}},go.prototype.unwatch=go.prototype.watch=function(){var t=this,n=t.condition.getTimeoutDuration();t.timeout||t.interval||n[0]!==1/0&&(t.timeout=window.setTimeout(function(){var e;t.unwatch(),t.condition.check()?t.tryRunning():n[1]===1/0?t.interval=window.setInterval(function(){t.condition.check()&&(t.tryRunning(),t.unwatch())},1e4):1e5<=(e=Math.max(n[1]-n[0],1e4))?t.interval=window.setInterval(function(){t.condition.check()&&(t.tryRunning(),t.unwatch()),(e-=1e4)<=0&&t.unwatch()},1e4):t.timeout=window.setTimeout(function(){t.unwatch(),t.condition.check()&&t.tryRunning()},e)},Math.max(0,n[0])))},go.prototype.tryRunning=function(){var e;e=this,-1===rt.indexOf(e)&&rt.push(e),st=st||setTimeout(Kn,500)},go.prototype.applyActions=function(e,t){var n=this;t&&(this.parent=t),this.matcher=e.matcher||"equal","all"===this.matcher||"any"===this.matcher?(this.subConditions=[],e.subConditions.forEach():(this.parameter=e.parameter,this.value=e.value)}),ft=(pt.prototype.check=function(){if(~["time_on_page","time_on_site","online"].indexOf(this.parameter))return!0;var t=!1;switch(this.matcher){case"all":t=!0,this.subConditions.forEach(function(e){t&=e.check()});break;case"any":t=!1,this.subConditions.forEach(;break;default:t="page_url"===this.parameter?qn(e(Wn(this.parameter)),this.matcher,e(String(this.value))):qn(Wn(this.parameter),this.matcher,this.value)}return t;,pt.prototype.getTimeoutDuration=function(){var e,i,a=this;return"all"===this.matcher||"any"===this.matcher?(this.subConditions.forEach(function(e,t){var n,o,e=e.getTimeoutDuration();if(e)return i?(n="all"===a.matcher?Math.max:Math.min,o="all"===a.matcher?Math.min:Math.max,"all"===a.matcher&&i[0]>e[1]||i[1]<e[0]?i=[1/0,1/0]:(i[0]=n(i[0],e[0]),void(i[1]=o(i[1],e[1])))):i=e}),i=i||[0,1/0]):"time_on_page"!=this.parameter&&"time_on_site"!=this.parameter&&"time_after_close"!=this.parameter||(e=parseInt(this.value-Wn(this.parameter)/1e3),i="greater_than"==this.matcher?[1e3*(e+1),1/0]:"less_than"==this.matcher?[0,1e3*(e-1)]:[e,e]),i},pt.prototype.checkRequiredOnlineParameterValue=function(){var t=void 0;return~["all","any"].indexOf(this.matcher)?this.subConditions.forEach(function(e){e=e.checkRequiredOnlineParameterValue();void 0!==e&&(t=e)}):"online"===this.parameter&&(t=this.value),t},Ee.prototype.run=function(e,t){var n,o;"proactive"===this.name&&(n=(new Date).getTime(),this.trigger.isBot?Zt(w.appId,"/stats/bot-views","POST",function(e,t){},{botId:this.trigger.id}):Zt(w.appId,"/stats/trigger-views","POST",{triggerId:this.trigger.id}),(o=this.trigger.getShallowData()).timestamp=n,o.dismissed=!1,o.operators=e,to(o)&&it&&S.play(),t)&&t()},function(e,t){var n=this;n.actions=[],n.trigger=t,e.forEach(function(e){n.actions.push(e.constructor===Ee?e:new Ee(e,t))})});ft.prototype.run=function(n,o){var i=this;!function e(t){i.actions[t]?i.actions[t].run(n,T(e,null,[t+1])):o&&o()}(0)}}}}function T(t,n,o){return o?o.constructor!==Array&&(o=[o]):o=[],function ht(){var e=Un(),t=(new Date).getTime(),n=R("session_started_at");e?n&&(e=Math.max(n,e)):e=n;if(e&&216e5<t-e){for(var o=0,i=fe.length;o<i;o++)O(fe[o],!1,!0);k("session_started_at",Y.getTime())}else n||k("session_started_at",Y.getTime());if(!z){for(var a=[{map:de,isSession:!(z=!0)}],r=0,s=a.length;r<s;r++)!function(e,t){for(var n in e)e.hasOwnProperty(n)&&(null===e[n]?O(n,t):k(n,e[n],t))}(a[r].map,a[r].isSession);l.setState("storageReady")}}function O(e,t,n){if(!z&&!n&&-1!==fe.indexOf(e))return t?delayedSessionStorageChanges[e]=null:de[e]=null;e=vt(e),t&&a.isSupported||u.isSupported&&!t?(t?window.sessionStorage:window.localStorage).removeItem(e):document.cookie=e+"=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;"}function R(e,t,n){if(z||n||-1===fe.indexOf(e))return e=vt(e),t&&a.isSupported||u.isSupported&&!t?(t?window.sessionStorage:window.localStorage).getItem(e):(n=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)")))?decodeURIComponent(n[1]):void 0}function k(e,t,n,o){if(!z&&!o&&-1!==fe.indexOf(e))return n?delayedSessionStorageChanges[e]=t:de[e]=t;e=vt(e),n&&a.isSupported||u.isSupported&&!n?(n?window.sessionStorage:window.localStorage).setItem(e,t):(o=n?new Date:new Date((new Date).getTime()+2592e6),document.cookie=e+"="+t+"; path=/; expires="+o.toUTCString())}function gt(e,t,n){ue||(ue=!0,v.on(window,"storage",mt)),n&&a.isSupported?(a.watch[e]||(a.watch[e]=[]),a.watch[e].push(t)):!n&&u.isSupported&&(u.watch[e]||(u.watch[e]=[]),u.watch[e].push(t))}function mt(e){var t,n=e.storageArea===window.sessionStorage,o=n?a:u;o.isSupported&&(t=(e=e.key)&&0===e.indexOf("wsc_")?e.substring(4):null)&&o.watch[t]&&o.watch[t].forEach(}unction wt(e){switch(e){case"facebook":return he;case"telegram":return ge;case"viber":return me;case"vk":return ve;default:if(e&&"website"!==e)return null}return we}function yt(){J&&C.widgetWindow&&C.inner&&(C.widgetWindow.style.height=J+"px",C.inner.style.height=J+"px")}function Ct(){C.widgetWindow&&C.inner&&(C.widgetWindow.style.height="",C.inner.style.height="")}function bt(e,t){null==e?c.style.left="":c.style.setProperty("left",e+"px","important"),null==t?c.style.top="":c.style.setProperty("top",t+"px","important")}function xt(){ne=!1,C.launcherButton.style.opacity=0,setTimeout(function(){v.render(null,function(){ne||(bt(-1e4,-1e4),c.style.position="absolute",c.style.opacity=0,c.style.visibility="hidden")})},500)}function _t(){var e;ne=!0,bt(oe.left,oe.top),c.style.position="",c.style.opacity="",c.style.visibility="",C.launcherButton.style.opacity="",setTimeout(500),e=!0,v.toggleCssClass(C.widgetWindow,"chaport-window-anim",e),v.toggleCssClass(C.message,"chaport-window-anim",e),v.toggleCssClass(C.launcherButton,"chaport-launcher-anim",e),C.channels&&v.toggleCssClass(C.channels,"chaport-channels-anim",e)}function It(){var e=["chaport-container","chaport-container-positioned","chaport-collapsed"],t=y&&0<d.list.length;function n(e){Pn(),ro(!1),Jt(),Bn(),e.stopPropagation()}o=document.getElementsByTagName("body")[0],c=document.createElement("div"),X&&e.push("chaport-device-ios"),$&&e.push("chaport-device-android"),y&&(e.push("chaport-device-mobile"),Z||e.push("chaport-non-responsive-layout")),c.className=e.join(" "),c.innerHTML='<div class="chaport-launcher"><div class="chaport-launcher-button chaport-anim-hide no-photo"><div class="chaport-launcher-chat-icon"></div><div class="chaport-launcher-close-icon"></div><div class="chaport-launcher-operator-photo"></div><div class="chaport-launcher-badge chaport-badge-hide"></div></div></div><div class="chaport-window chaport-anim-hide"><div class="chaport-inner"></div><div class="chaport-loading-overlay chaport-anim-hide"><div class="chaport-loader chaport-center"></div></div></div>'+(t?'<div class="chaport-channels-wrapper chaport-anim-hide"><div class="chaport-channels-overlay"></div><div class="chaport-channels-blocks"><div class="chaport-channels-list chaport-channels-block"><a href="javascript: void(0);" data-channel="website" class="chaport-channel chaport-channel-website">'+p.websiteChannel+"</a>"+d.list.map(function(e){var t=e.platform,n=e.displayName||t[0].toUpperCase()+t.substr(1),o=wt(t),o=o&&o.getUrl&&o.getUrl(e);return'<a href="'+(o?encodeURI(o):"javascript: void(0);")+'" data-channel="'+t+'" class="chaport-channel chaport-channel-'+t+'">'+n+"</a>"}).join("")+'</div><div class="chaport-channels-block chaport-channels-actions"><a href="javascript: void(0);" class="chaport-channels-cancel">'+p.cancel+"</a></div></div></div>":"")+'<div class="chaport-message chaport-message-with-replies chaport-anim-hide"><div class="chaport-message-popup"><div class="chaport-message-popup-body"><div class="operator-face"><div class="photo"></div></div><div class="operator-name"></div><div class="message-text"></div><div class="chaport-close visible"></div></div></div><div class="chaport-message-replies"></div><div class="chaport-message-input">'+p.input+'</div></div><div class="chaport-big-shadow chaport-shadow-hide"></div>',C.root=c,C.bigFatShadow=U("chaport-big-shadow"),C.inner=U("chaport-inner"),C.loadingOverlay=U("chaport-loading-overlay"),C.message=U("chaport-message"),C.messageBody=U("chaport-message-popup"),C.messageReplies=U("chaport-message-replies"),C.messageInput=U("chaport-message-input"),C.messagePhoto=U("photo",C.messageBody),C.messageSenderName=U("operator-name",C.messageBody),C.messageText=U("message-text",C.messageBody),C.messageClose=U("chaport-close",C.messageBody),C.launcherRoot=U("chaport-launcher"),C.launcherButton=U("chaport-launcher-button",C.launcherRoot),C.launcherIcon=U("chaport-launcher-chat-icon"),C.launcherUnread=U("chaport-launcher-badge"),C.channels=U("chaport-channels-wrapper"),C.channelsList=U("chaport-channels-list",C.channels),C.widgetWindow=U("chaport-window"),v.on(C.messageClose,"click",function(e){Pn(),ro(!0),Dn(),Bn(),e.stopPropagation()}),v.on(C.messageInput,"click",n),v.on(C.messageBody,"click",n),t?(v.on(C.launcherButton,"click",function(e){b===P.expanded?Vt():ye?(ro(!1),Jt()):M(P.channels),e.stopPropagation()}),v.on(C.channels,"click",,v.on(C.channelsList,"click",,C.channelsList.querySelectorAll(".chaport-channel").forEach(function(e){v.on(e,"click",}),v.on(U("chaport-channels-cancel"),"click",):v.on(C.launcherButton,"click",function(e){e.stopPropagation(),Pn(),(b===P.expanded?Vt:Jt)()}),v.on(window,"pagehide",function(){b===P.expanded&&k("widget_last_closed",(new Date).getTime())}),xt(),o.appendChild(c),dn(h.position),fn(),v.on(window,"resize",,be(),l.setState("domReady")}function St(){return x.triggers}function Tt(){return x.assignmentRules}function Ot(){return x.allAppearance}function Rt(){return x.jsVisitor}nction Nt(){var e=x.jsApi;return!0===e||1<=e}function At(e){Tt()?(w.assignments||(w.assignments={}),e.resolve&&(w.assignments.resolve=e.resolve),e.rules&&(w.assignments.rules=Pt(e.rules)),e.defaultRules&&(w.assignments.defaultRules=Pt(e.defaultRules)),l.is("apiInit")&&l.is("initialPageViewReady")&&Ut()):w.assignments=void 0}function Ut(e){if(Tt()){var t,n=w.assignments;if(n&&"function"==typeof n.resolve)try{t=n.resolve(window.chaport)}catch(e){console.error("chaport: assignment.resolve failed due to an error"),console.error(e)}return"string"==typeof(t=void 0===(t=void 0===t&&n&&n.rules?Mt(n.rules):t)&&n&&n.defaultRules?Mt(n.defaultRules):t)?t=[t]:t&&t.constructor===Array&&0===t.length&&(t=null),w.operators=t||void 0,e||g&&A("setOperators",w.operators||null),w.operators}}function Pt(e){return e?(e=e.constructor!==Array?[e]:e).map(function(t){if("object"==typeof t){var n,o,i,e;if(t.action)return"assign"===t.action?(n=t.condition&&new pt(t.condition),function(){var e=t.actionParams&&t.actionParams.assigneeId||null;if(!n||n.check())return e}):void 0;for(e in t)if(Object.prototype.hasOwnProperty.call(t,e)){i=t[o=e];break}if(void 0!==i){if("null"===o&&(o=null),"boolean"==typeof i)return if("function"==typeof i)return function(e){try{if(i(e))return o}catch(e){console.error("chaport: failed to process an assignment rule due to an error"),console.error(e)}};if(i&&i.constructor===Array&&3===i.length)return function(e){if(e.compare(e.getParameterValue(i[0]),i[1],i[2]))return o};console.error("chaport: failed to process an assignment rule due to unknown format"),console.error(i)}}else if("function"==typeof t)return t}).filter(:[]}function Mt(e){var n;return e.some(function(e){try{var t=e(r);if(t||null===t)return n=t,!0}catch(e){console.error("chaport: failed to process an assignment rule due to an error"),console.error(e)}}),n}function Bt(e,t){if("function"==typeof r[e])return Wt(e,t);r._q.push(arguments)}function Wt(e,t){return"function"!=typeof r[e]?console.error(new Error("Chaport: method '"+e+"' is not defined")):void 0===t?r[e].call(r):(t&&t.constructor!==Array&&(t=[t]),r[e].apply(r,t))}function qt(){var e=Et(),t=St(),n=Nt(),o=Ot(),i=Rt(),a=(r.close=n?E(Vt):N,r.compare=e?E(qn):N,r.getActiveTrigger=e&&t?E(eo):N,r.getParameterValue=e?E(Wn):N,r.getTriggerById=e&&t?E(Dt):N,r.getWidgetState=n?E(Ht):N,r.hideLauncher=n?E(ln):N,r.newPageView=e?E(Gt):N,r.send=e?E(Xt):N,r.open=n?E(Jt):N,r.openIn=n?E(Ft):N,r.showLauncher=n?E(un):N,r.setActiveTrigger=e&&t?E(jt):N,r.setAssignmentRules=e?E(At):N,r.setVisitorData=i?E(gn):N,r.toggle=n?E(zt):N,r.updatePosition=e&&o?E(_n):N,r.q=Wt,Lt(),r.on);r.on=function(e,t){"chat.onlineChange"===e&&l.is("sessionInit")&&"5a8b2828cd1d5d31bc17f0ac"===w.appId&&En(),"ready"===e&&r.__ready?setTimeout(T(t,null,[{visitorId:f&&f.id}]),0):a.apply(r,arguments)},l.setState("apiInit")}function Lt(t){var n;(t=t||r._q)&&0<t.length&&(n=[],t.forEach(function(e,t){r[e[0]]&&(r.q.apply(r,e),n.unshift(t))}),n.forEach()}function Dt(e){e=function(e){for(var t=0,n=i.length;t<n;t++)if(i[t].id===e)return i[t]}(e);if(e)return e.getShallowData()}function jt(e){if(!l.is("chatStarted")&&!oo()){var t=e instanceof go?e.getShallowData():e;if(!t.message){if(!t.id)throw new Error("setActiveTrigger requires at least one of: message, id");e=Dt(t.id);if(!e)throw new Error("setActiveTrigger without message requires id to be that of an existing trigger");t.message=e.message}t.operators?n():an(t.operatorId,function(e){t.operators=e?[e]:null,n()})}function n(){t.date&&(t.timestamp=t.date.getTime(),delete t.date),t.timestamp||(t.timestamp=(new Date).getTime()),t.dismissed=!1,to(t)}}unction Ft(t){g||kn(w,f),l.expect(["iframeReady"],function(){{var e;t&&"object"==typeof t?t.selector&&(e=document.querySelector(t.selector))&&g.parentNode!==e&&function(e){if(!e)throw new Error("can't move iframe to an element that doesn't exist");g.loaded=!1,e.appendChild(g),setTimeout(3e3)}(e):"string"==typeof t&&(Xe&&En(),"_self"===t?window.location.href=g.src:window.open(g.src,t))}})}function Gt(e){Cn(e&&e.title||document.title,e&&e.url||location.href,!0)}function Jt(e){l.is("iframeLoading")||kn(w,f),ro(!1),M(P.expanded,{autoFocus:!y,history:!e})}function Vt(e){ro(!1),M(P.collapsed,{history:!e})}function zt(){(b===P.expanded?Vt:Jt)()}function E(e){return function(){if(f)return e.apply(this,arguments)}}function Xt(e,t){An(function(){Nn(["::wsc:through",e.toString(),JSON.stringify(t)].join(":"))})}function $t(e,t,n){var o=n&&n.cancellable,i=!0;return r._l&&r._l[e]&&r._l[e].forEach(function(e){o&&!1===i||(i=e(t))}),i}unction Zt(e,t,n,o,i){return Qt(e,"https://app.chaport.com/api/public/v1"+t,n,o,i)}function Yt(e,t,n,o,i){Qt(e,"__serverUrl__/__siteId__/__path__".replace("__serverUrl__",Ce.getServerUrl()).replace("__siteId__",e).replace("__path__","api/public/v1"+t),n,o,i)}function Qt(e,t,n,o,i){var a;v.isIE()<10&&!1!==v.isIE()?((a=new XDomainRequest).open(n||"GET",t+"&appId="+e),a.onload=function(){var e;if(!a.responseText)return o(new Error("api request failed: ie - "+t));try{e=JSON.parse(a.responseText)}catch(e){return o(new Error("received malformed response from the server: "+a.responseText))}o(null,e&&e.result)}):((a=new XMLHttpRequest).open(n||"GET",t,!0),a.onreadystatechange=function(){if(4===a.readyState){var e;if(!a.responseText||-1===[0,200].indexOf(a.status))return 404===a.status||0===a.status||400===a&&t&&-1!==t.indexOf("64910105e091021798e2f4e7")?o(null,null):o(new Error("api request failed: "+a.status+":"+t));try{e=JSON.parse(a.responseText)}catch(e){return o(new Error("received malformed response from the server: "+a.responseText))}o(null,e&&e.result)}},a.withCredentials=!0,a.setRequestHeader("CP-App-Id",e),i&&a.setRequestHeader("Content-Type","application/json")),a.send(i&&JSON.stringify(i))}function Kt(e){e.session||(e.session={});e=e.session;void 0!==e.autostart&&(e.autoStart=e.autostart),void 0===e.autoStart&&(e.autoStart=!0),void 0===e.allowMerge&&(e.allowMerge=!1),void 0===e.persist&&(e.persist=!0)}function en(e,t){var n=!1,o=!1;if(e?e.forceNew?(n=!0,_=e=v.createNewCreds(w.appId,null,w.session.persist)):o=!0:(e=_=!1===_?v.getCreds(w.appId):_)||(_=e=v.createNewCreds(w.appId,{id:R("wssid"),token:R("ctoken")},w.session.persist)),!e.id&&e.visitorId&&(e.id=e.visitorId),f)return tn(f.id!==e.id,T(en,null,[e,t]));f={id:e.id,token:e.token,isCustom:o,isForcedNew:n},Y=new Date,ht(),l.expect(["storageReady","appearanceReady","cssReady","dataReady"],function(){if(f){if(!f.id||!f.token)return console.error("unable to start a chat session without user id details"),tn(!0);setTimeout(function(){v.render(null,function(){if(f){if(!f.id||!f.token)return console.error("unable to start a chat session without user id details"),tn(!0);_t(),M(P.collapsed);var o=(new Date).getTime()+300;Ce.loadVisitorEssentials(w.appId,f,!w.session.persist,function(e){var t;function n(){e&&e.unread&&e.unread.lastMessage?(B(),ao()):w.triggers.keep?no(eo()):ro(!0),l.setState("triggersReady")}Cn(document.title,location.href,!1),l.setState("initialPageViewReady"),e&&e.completedTriggers&&(t=e.completedTriggers)&&0<t.length&&i.forEach(function(e){-1!==t.indexOf(e.id)&&e.once&&B([e.id])}),l.expect(["chatReady"],function(){var e=o-(new Date).getTime();setTimeout(n,Math.max(e,0))})}),l.setState("sessionInit"),l.expect(["apiInit"],function(){f&&(r.__ready=!0,$t("ready",{visitorId:f.id}))}),r._l&&r._l["chat.onlineChange"]&&0<r._l["chat.onlineChange"].length&&"5a8b2828cd1d5d31bc17f0ac"===w.appId&&En()}})},300)}}),t&&l.expect(["sessionInit"],t),bn(),c||It(),e=document.getElementsByTagName("body")[0],c.parentNode!==e&&e.appendChild(c)}function tn(e,t){var n,o;=f&&null,r.__ready=!1,e?(n=T(tn,null,[!1,t]),O("active_trigger"),O(v.getPostfixed("active_trigger",w.appId)),O("widget_last_closed"),O("session_started_at"),O("page_views"),O("pages"),O("utm"),O("connected_once"),O("referrer"),O("wssid"),O("ctoken"),O("last_activity_at"),_=null,v.clearCreds(w.appId),Yt(w.appId,"/clear","GET",function(e,t){g&&g.loaded&&g.contentWindow?(s.once("rClearStorage",i),A("clearStorage")):i()}),setTimeout(i,7e3),o=!1):(l.resetSession(),Vn(),M(P.collapsed),xt(),g&&(g.parentNode&&g.parentNode.removeChild(g),g.src="about:blank",g=null),jn(0),t&&t())}function nn(){var e=(new Date).getTime();return null===I.list||null===I.since||6e4<e-I.since}function on(t){var o=!1;function i(e){o||(o=!0,"function"==typeof t&&t(e))}function a(e){return!e.isBot&&"online"===e.realStatus}f&&!nn()&&setTimeout(function(){o||(s.once("isOnline",i),A("api:getIsOnline"))},0),setTimeout(function(){var n,e;o||(n=nn()?(e="/operators"+(w.operators?"?ids="+JSON.stringify(w.operators):""),Zt(w.appId,e,"GET",function(e,t){e||!t||t.constructor!==Array?I.list=[]:I.list=t,I.since=(new Date).getTime();e=I.list.some(;I.online!==e&&null!==I.online&&($t("chat.onlineChange",e),A("refreshOperatorsDataStorage")),I.online=e,n&&n(I.list)})):n&&n(I.list))},500),setTimeout(3e3)}function an(e,t){s.once("triggerOperator",t),A("getTriggerOperator",e)}function rn(e,t){for(var n=e&&e.exclude||e&&e.include||[],e=!e||!e.include||n!==e.include,o=!1,i=0,a=(t=t&&t.constructor===Array?t:[t]).length;i<a;++i)-1!==n.indexOf(t[i])&&(o=!0);return o&&!e||!o&&e}function sn(){return y?X?["mobile","ios"]:["mobile","android"]:["desktop"]}function cn(e){var t;e!==ze?(t=Ne,(Ne=document.createElement("link")).rel="stylesheet",Ne.href=e||"https://assets.chaport.com/stylesheets/widget.css",Ne.onload=function(){ze=e,t&&t.parentNode&&t.parentNode.removeChild(t),l.setState("cssReady")},document.getElementsByTagName("head")[0].appendChild(Ne)):l.setState("cssReady")}function ln(){v.addCssClass(C.root,"hide-launcher"),ee=!0,Ie()}function un(){v.removeCssClass(C.root,"hide-launcher"),ee=!1,Ie()}function dn(e){C.root&&(e=((Ae=e||["right"])[1]||0)+"px","right"===Ae[0]?(v.removeCssClass(C.root,"chaport-position-left"),C.root.style.left="0",C.root.style.right=e):(v.addCssClass(C.root,"chaport-position-left"),C.root.style.right="0",ne?C.root.style.left=e:oe.left=parseInt(e)),C.root.style.bottom=pn()+"px",be())}function pn(){return Ae&&Ae[2]||0}function fn(){C&&C.launcherButton&&h&&(C.launcherButton.style.backgroundColor=h.color)}function hn(e){if(e.language){if(e.language.use)return e.language.use;if("html"===e.language.source)return document.documentElement.getAttribute("lang")}return e.lang||(e.useHtmlLang?document.documentElement.getAttribute("lang"):void 0)}function gn(e,t){Xe=!0,An(function(){Nn(["::wsc:api:setVisitorData",t||"",JSON.stringify(e)].join(":"))})}function mn(){var e=R("utm");return e?JSON.parse(e):null}function vn(e){A("setUtm",e)}function wn(t,n){l.expect(["storageReady"],function(){var e=yn();e.push({title:t,url:n,timestamp:(new Date).getTime()}),k("pages",JSON.stringify(e)),l.is("iframeReady")&&xn()})}function yn(){var e=R("pages");return e=e?JSON.parse(e):[]}function Cn(e,t,n){n&&Vn(),l.is("connecting")||l.is("connectionReady")?Xt("new-page-view",{title:e,url:t}):wn(e,t);e=R("page_views");k("page_views",e?parseInt(e)+1:1),n&&(bn(),Jn()),n&&Ut()}unction xn(){A("setPageViews",yn()||[])}function _n(e,t){var n;e&&e.constructor===Array&&0<e.length&&(e=e.slice(0,3),h.position=e,n=b,M(P.hidden,null,)}function In(){return{chaport:{expanded:!0}}}function Sn(e){return!!e&&JSON.stringify(e)===JSON.stringify(In())}function Tn(){return Me||R("referrer")}function On(){var e=Tn();e&&A("referrer",{value:e.split("/").slice(0,3).join("/")})}function Rn(e,t,n){var o,i=hn(e),a=Un(),r=t&&t.id,s=t&&t.token,c=t&&t.isCustom,l=Array.isArray(w.operators)&&0<w.operators.length?w.operators:null;return void 0===(o=void 0!==e.closeButton?e.closeButton:o)&&ee&&(o=!0),"?appid="+encodeURIComponent(e.appId)+(e.integration?"&integration="+encodeURIComponent(e.integration):"")+(i?"&lang="+i:"")+(r?"&cid="+encodeURIComponent(r):"")+(s?"&ctoken="+encodeURIComponent(s):"")+(c?"&ccustom=1":"")+(e.server?"&server="+encodeURIComponent(e.server):"")+(a?"&lastActivity="+encodeURIComponent(a):"")+"&r="+Math.random()+(e.appearance?"&appearance="+encodeURIComponent(JSON.stringify(e.appearance)):"")+(e.session.persist?"":"&noPersist=1")+(void 0!==o?"&close="+Number(o):"")+(l?"&ops="+encodeURIComponent(JSON.stringify(l)):"")+(t&&t.isForcedNew?"&ignoreStored=1":"")+(n?"&connect=1":"")+"&ou="+encodeURIComponent(window.location.origin||window.location.protocol+"//"+window.location.host)}function kn(e,t,n){g||(t=Rn(e,t,n),(g=document.createElement("iframe")).className="chaport-inner-iframe",g.src="https://app.chaport.com/widget/show.html"+t,v.on(g,"load",function(){var e;e=Ze,Ze=[],e.forEach(,this.loaded=!0,setTimeout(250)}),l.setState("iframeLoading"),(n||e.socket&&e.socket.connect)&&En(),g.frameBorder=0,g.scrolling="no",C.inner.appendChild(g),C.loadingOverlay&&v.replaceCssClass(C.loadingOverlay,"chaport-anim-hide","chaport-anim-show"),l.expect(["iframeReady"],)}function En(){l.is("iframeLoading")?(l.is("connecting")||l.setState("connecting"),l.is("connectionReady")||A("connect")):kn(w,f,!0)}function A(t,n){An(function(){var e=["::cp",t];void 0!==n&&e.push(JSON.stringify(n)),g.contentWindow.postMessage(e.join(":"),"https://app.chaport.com")})}function Nn(e){An(}function An(e){v.doWhenWindowReady(function(){g&&g.loaded?e.call(g,g):Ze.push(e)})}unction Pn(){k("last_activity_at",(new Date).getTime())}function Mn(e){if(e&&void 0!==e.unreads&&(Qe=e.unreads),e&&e.cancel)return n();function t(){K=!0,(b===P.expanded||w&&w.unreads&&!0===w.unreads.resetOnUserActivity)&&Bn(),n()}function n(){Ke=!1,v.off(window.document,"mousemove",t),v.off(window.document,"touchstart",t),v.off(window.document,"keydown",t)}function o(e){var t={focus:!0,focusin:!0,pageshow:!0,blur:!1,focusout:!1,pagehide:!1};(e=e||window.event).type in t&&(K=t[e.type])}Ke||(Ke=!0,Ye||(v.on(window,"pageshow",o),v.on(window,"pagehide",o),v.on(window,"focus",o),v.on(window,"blur",o),Ye=!0),v.on(window.document,"mousemove",t),v.on(window.document,"touchstart",t),v.on(window.document,"keydown",t))}function Bn(){Qe=0,Nn("::wsc:user:active")}function U(e,t){var n=null;if((t=t||c).getElementsByClassName)0<(o=t.getElementsByClassName(e)).length&&(n=o[0]);else if(t.querySelector)n=t.querySelector("."+e);else for(var o=t.getElementsByTagName("*"),i=0;i<o.length;i++)if(-1<(" "+o[i].className+" ").indexOf(" "+e+" ")){n=o[i];break}return n}function Wn(e){var t=function(){null===ct&&(ct={country:lt,language:ut,referrer:Tn(),utm:mn()});return ct}();switch(e){case"time_on_page":o=Ue?(new Date).getTime()-Ue:0;break;case"time_on_site":var n=Number(R("session_started_at")),o=(new Date).getTime()-n;break;case"time_after_close":n=Number(R("widget_last_closed"));o=(new Date).getTime()-n;break;case"page_url":o=window.location.href;break;case"widget_state":o=Ln(b);break;case"page_views":o=parseInt(R("page_views"));break;case"message_text":o=t&&t.messageText;break;case"country":o=t&&t.country;break;case"language":o=t&&t.language;break;case"referrer_url":o=t&&t.referrer;break;case"utm_source":o=t&&t.utm&&t.utm.source;break;case"utm_medium":o=t&&t.utm&&t.utm.medium;break;case"utm_term":o=t&&t.utm&&t.utm.term;break;case"utm_campaign":o=t&&t.utm&&t.utm.campaign;break;case"utm_content":o=t&&t.utm&&t.utm.content;break;default:throw"unknown trigger parameter "+e}return o}function qn(e,t,n){var o=!1;switch(t){case"equal_to":case"equal":case"=":o=i(e)==i(n);break;case"not_equal_to":case"!equal":case"!=":case"<>":o=i(e)!=i(n);break;case"contains":o=-1!==i(String(e)).indexOf(i(String(n)));break;case"does_not_contain":case"!contains":o=-1===i(String(e)).indexOf(i(String(n)));break;case"greater_than":case"gt":case">":o=n<e;break;case"less_than":case"lt":case"<":o=e<n;break;case"lte":case"<=":o=e<=n;break;case"gte":case">=":o=n<=e;break;default:console.error("unknown matcher argument",t)}return o;unction Ln(e){if(e instanceof P)for(var t in P)if(P.hasOwnProperty(t)&&P[t]instanceof P&&e===P[t])return t}function M(e,t,n){if(nt)ot.push({state:e,payload:t,callback:n});else if(b===e)"function"==typeof n&&n(),p();else if(!1===$t("widget.beforeStateChange",{fromState:Ln(b),toState:Ln(e),payload:t},{cancellable:!0}))"function"==typeof n&&n(),p();else{if(nt=!0,$t("widget.stateChange",{fromState:Ln(b),toState:Ln(e),payload:t}),P.expanded===e&&(w.openIn||y&&!Z))return Dn(),window.chaport.openIn(w.openIn||"_self");t=t||{},Le=Le||function(){var e,t,n,o=[];for(e in P.classGroups)if(P.classGroups.hasOwnProperty(e))for(t=0,n=P.classGroups[e][1];t<n.length;t++)-1===o.indexOf(n[t])&&o.push(n[t]);return o.sort(,o}();var o,i,a,r,s,c,l,u=b,d=(b=e,[]);for((u&&u.hooks.beforeOut||e.hooks.beforeIn)&&(o=[],u&&u.hooks.beforeOut&&o.push(u.hooks.beforeOut),e.hooks.beforeIn&&o.push(e.hooks.beforeIn),d.push(T(h,void 0,[o,t]))),i=0;i<Le.length;i++){for(a in r=[],e.elementStates)C[a]&&(s=(c=f(e.elementStates[a]))[0],l=c[1],(c=!u||void 0===u.elementStates[a]||(c=f(u.elementStates[a]))[0]!==s?s[0][0]:c[1])!==l)&&function(e,t,n){t=e[0].indexOf(t),n=e[0].indexOf(n);return e[1][t*(e[0].length-1)+n-Number(t<n)]}(s,c,l)===Le[i]&&((c=s[0].slice(0)).splice(c.indexOf(l),1),r.push({0:C[a],1:c,2:l}));0<r.length&&d.push(T(g,void 0,[r]))}(u&&u.hooks.afterOut||e.hooks.afterIn)&&(o=[],u&&u.hooks.afterOut&&o.push(u.hooks.afterOut),e.hooks.afterIn&&o.push(e.hooks.afterIn),d.push(T(h,void 0,[o,t]))),!function e(t){if(!t[0])return"function"==typeof n&&n(),nt=!1,void p();t.shift()(function(){e(t)})}(d)}function p(){var e;0<ot.length&&M((e=ot.shift()).state,e.payload,e.callback)}function f(e){return"boolean"==typeof e?[P.classGroups.visibility,P.classGroups.visibility[0][Number(e)]]:[P.classGroups[e[0]],e[1]]}function h(n,o,i){v.render(null,function(){for(var e=0,t=0;t<n.length;t++)e=Math.max(e,n[t](o)||0);setTimeout(function(){i()},e)})}function g(s,c){v.render(null,function(){for(var e,t,n,o,i=!1,a=0,r=s.length;a<r;a++){for(t=s[a][0],n=s[a][1],o=s[a][2],e=0;e<n.length;e++)v.removeCssClass(t,n[e]);v.addCssClass(t,o),v.onTransitionEnd(t,250)}})}}function Dn(){b!==P.expanded&&M(P.collapsed),jn(0)}function jn(e){var t;t=He=e,v.render(null,function(){t?(C.launcherUnread.textContent=t,v.replaceCssClass(C.launcherUnread,"chaport-badge-hide","chaport-badge-show")):v.replaceCssClass(C.launcherUnread,"chaport-badge-show","chaport-badge-hide")})}function Hn(e,t){var n,c;!e.colorId&&e.operators&&e.operators[0]&&e.operators[0].colorId&&(e.colorId=e.operators[0].colorId),!e.name&&e.operators&&e.operators[0]&&e.operators[0].name&&(e.name=e.operators[0].name),n=e.operators&&e.operators[0],je={"no-photo":!n||!n.isBot&&!n.image||!1,"bot-photo":n&&n.isBot||!1,"with-photo":n&&!n.isBot&&n.image||!1},n&&n.isBot?De="/images/chatbot-icon.svg":n&&n.image?De="/uploads/operator-images/"+n.image:Fn(),jn(t||(He||0)+1),c=e,v.render(null,function(){var n,t,e,o=De,i=je,a=C.messagePhoto,r=C.messageText,s=C.messageSenderName;i["bot-photo"];a.className=a.className.replace(/user-color-\d+/g,""),!o&&c.colorId&&v.addCssClass(a,"user-color-"+c.colorId),a.style.display=o||c.colorId?"block":"none",o!==a.lastImageDisplayed&&(a.innerHTML=o?'<img alt="'+v.escapeHtml(c.name)+'" src="https://app.chaport.com'+o+'" />':""),a.lastImageDisplayed=o,v.toggleCssClass(a,i),s&&(s.textContent=c.name||"",s.style.display=c.name?"block":"none"),r.innerHTML=(o=c.text,v.nlToBr(v.nlNlToP(v.urlsToLinks(v.escapeHtml(v.brToNl(o)))))),null!==c.replyOptions&&(a=c.replyOptions,i=C.messageReplies,n=!1,0===(a=a||[]).length?i.innerHTML="":(s=h&&h.colorContrast||"",t=s?'style="color:'+s+"; border: 1px solid "+v.hexToRGBA(s,.8)+'"':"",s=a.map(function(e){return'<div class="reply-option" data-reply-id="'+e.id+'"'+t+'><span class="reply-option-text">'+v.escapeHtml(e.text)+"</span></div>"}),i.innerHTML='<div class="reply-options">'+s.join("")+"</div>",(e=Array.prototype.slice.call(i.querySelectorAll(".reply-option"))).forEach(function(e){40<e.offsetHeight&&(e.style.width=Gn(e)),v.on(e,"click",function(){var e,t;n||(n=!0,e=this.textContent,t=this.getAttribute("data-reply-id"),Jt(),An()})}),v.on(window,"resize",function(){e.forEach(function(e){40<e.offsetHeight&&(e.style.width="",e.style.width=Gn(e))})})),v.toggleCssClass(i,"chaport-hide",0===a.length),v.toggleCssClass(C.messageInput,"chaport-hide",0<a.length||y)),M(P.unreadMessage)})}function Fn(){null!==De&&(De=null),je={"no-photo":!0,"bot-photo":!1,"with-photo":!1}}function Gn(e){var t=e.getBoundingClientRect(),n=e.firstElementChild.getBoundingClientRect();return t.width-(t.width-n.width)+2*parseFloat(getComputedStyle(e).paddingLeft||"13.4")+2*parseFloat(getComputedStyle(e).borderWidth||"1")+"px"}function Jn(){i.forEach(,at=!0}function Vn(){i.forEach(,at=!1}function zn(e){if(e)try{if((e="string"==typeof e?JSON.parse(e):e).constructor!==Array)throw new Error("chaport: triggers has to be an Array");i=e.map(}catch(e){console.error(e)}}function B(e){e?n.isEnabled?n.exceptions=$n(n.exceptions,e):n.exceptions=Zn(n.exceptions,e):n={isEnabled:!1,exceptions:[]},at&&i.forEach(function(e){Yn(e.id)||e.unwatch()})}function Xn(e){e?n.isEnabled?n.exceptions=Zn(n.exceptions,e):n.exceptions=$n(n.exceptions,e):n={isEnabled:!0,exceptions:[]},at&&Jn()}function $n(t,e){return e&&(e=e.constructor!==Array?[e]:e).forEach(,t}function Zn(t,e){return e&&(e=e.constructor!==Array?[e]:e).forEach(,t}function Yn(e){return n.isEnabled&&-1===n.exceptions.indexOf(e)||!n.isEnabled&&-1!==n.exceptions.indexOf(e)}function Qn(){l.is("chatReady")&&l.is("triggersReady")&&i.forEach(function(e){e.condition.getTimeoutDuration()[0]<=0&&e.condition.check()&&e.tryRunning()})}function Kn(){var e,i;l.is("chatStarted")||oo()||(Vn(),e=rt,rt=[],(i=e.map(function(e){return{minWait:e.condition.getTimeoutDuration()[0],trigger:e}})).sort(function(e,t){e=e.minWait-t.minWait;return e<=-1e3?-1:e<=0?0:1}),I.since=null,function t(){var e=i.shift();{var n,o;e?(n=e.trigger,void 0!==(o=n.condition.checkRequiredOnlineParameterValue())?on(function(e){e===o?io(n):(B(n.id),t())}):io(n)):(st=null,Jn())}}())}function eo(){var e=R(v.getPostfixed("active_trigger",w.appId));if(e=e||R("active_trigger"))return JSON.parse(e)}function to(e){var t;return e?(t={id:e.triggerId,isBot:e.isBot,message:e.message,replyOptions:e.replyOptions,operators:e.operators,date:new Date(e.timestamp)},e.isBot&&tt.handleEvent("chat.botSent",t),tt.handleEvent("chat.autoInvitation",t),k(v.getPostfixed("active_trigger",w.appId),JSON.stringify(e)),l.expect(["iframeReady"],function(){so(e)}),no(e)):ao()}function no(e){return!(!e||e.dismissed||b&&b!==P.collapsed||(Hn({operators:e.operators,text:e.message,replyOptions:e.replyOptions,type:"flashy"}),0))}function oo(){return R(v.getPostfixed("active_trigger",w.appId))||R("active_trigger")}function io(t){t?an(t.operatorId,function(e){t.applyActions(e?[e]:null)}):ao()}function ao(){O(v.getPostfixed("active_trigger",w.appId)),O("active_trigger")}function ro(e){var t=eo();t&&(t.dismissed=!0,k(v.getPostfixed("active_trigger",w.appId),JSON.stringify(t))),e&&b!==P.expanded&&M(P.collapsed)}unction co(){var e=eo();e&&l.expect(["iframeReady"],function(){so(e)})}function lo(e){e.on=function(e,t){if("function"!=typeof t)throw new Error("listener must be a Function");this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},e.once=function(e,t){var n=this;n.on(e,function(){t.apply(this,arguments),n.off(e,arguments.callee)})},e.off=function(e,t){this.listeners[e]&&-1!==(t=this.listeners[e].indexOf(t))&&this.listeners[e].splice(t,1)},e.emitAndWait=function(e,t){var n,o=this.listeners[e];return o&&(1<this.listeners[e].length&&console.error("emitAndWait has more than 1 listener"),o.forEach(),n},e.fireEvent=e.emit=function(e,t){e=this.listeners[e];e&&e.forEach(}}function uo(e,t){switch(ct&&(ct[e]=t),e){case"country":lt=t;break;case"language":ut=t}}function po(t){if("none"!==t&&!Ve)return fo(function(e){e.load(t||Je||"beep")})}function fo(e){var t,n;function o(){return window.chaport.audio&&(e(window.chaport.audio),1)}Ve||o()||(t="https://assets.chaport.com"+(Ge||"/javascripts/audio-player.js"),(n=document.createElement("script")).onload=function(e){this.parentNode&&this.parentNode.removeChild(this),o()||setTimeout(100)},n.src=t,document.body.appendChild(n))}unction go(e,t,n,o,i,a,r){this.id=e,this.isBot=i,this.operatorId=o,this.once=n,this.interruptable=t,this.condition=a.constructor!=pt?new pt(a):a,this.actionChain=r.constructor!=ft?new ft(r,this):r,this.timeout=null,this.interval=null}}(window);