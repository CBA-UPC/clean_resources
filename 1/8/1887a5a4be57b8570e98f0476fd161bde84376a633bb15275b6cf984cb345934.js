<et="UTF-8" name="robots" content="noindex,nofollow" /><style>*{margin:0;padding:0;overflow:hidden;}body{background-color:transparent;img{border:none}</style><script type="text/javascript"> function clk(ref) {window.open(ref);}</script><script>parent.postMessage("rtg_uuid=", "*")</script><script>window.onload = function() {
var vid="1382531_142929_";parent.postMessage(window.name + "_vid_" + vid, "*");
}
window.addEventListener("message",function(e) {
setTimeout(
function(e) {
var img = document.getElementById("ad_img");
img.style.display = "block";
}, 250);
}, false);
</script></head><body><a href="https://pc-adroute.focas.jp/ads/adclk?mid=142929&uid=&ai=TzoxNzoiQWRyb3V0ZV9BZHZlcnRpc2UiOjE2OntzOjIyOiIAQWRyb3V0ZV9BZHZlcnRpc2UAX2lkIjtzOjc6IjEzODI1MzEiO3M6MjY6IgBBZHJvdXRlX0FkdmVydGlzZQBfc2l0ZUlkIjtzOjU6IjM4MDQ4IjtzOjI2OiIAQWRyb3V0ZV9BZHZlcnRpc2UAX2FkVHlwZSI7czoxOiIxIjtzOjI4OiIAQWRyb3V0ZV9BZHZlcnRpc2UAX3Jlc291cmNlIjtzOjkwOiJodHRwOi8vc3RhdGljLnBjLWFkcm91dGUuZm9jYXMuanAvdG1wL2Jhbm5hcnMvMzgwNDgvMjAyMy8xMi8xMi8yMS8zODA0OF8xNzAyMzg1Mzc3NDMxNi5qcGciO3M6MjU6IgBBZHJvdXRlX0FkdmVydGlzZQBfdGl0bGUiO3M6MDoiIjtzOjMxOiIAQWRyb3V0ZV9BZHZlcnRpc2UAX2Rlc2NyaXB0aW9uIjtzOjA6IiI7czoyNzoiAEFkcm91dGVfQWR2ZXJ0aXNlAF9pc05ld2VyIjtiOjA7czoyNToiAEFkcm91dGVfQWR2ZXJ0aXNlAF9zY29yZSI7ZDowO3M6MzA6IgBBZHJvdXRlX0FkdmVydGlzZQBfY3JlYXRlVGltZSI7aToxNzA1NjY4NjQ3O3M6Mjc6IgBBZHJvdXRlX0FkdmVydGlzZQBfb3duZXJJZCI7czozOiI1NDUiO3M6Mjg6IgBBZHJvdXRlX0FkdmVydGlzZQBfbW90aW9uSWQiO2k6MDtzOjMxOiIAQWRyb3V0ZV9BZHZlcnRpc2UAX2Jsb2NrVXJsRmxnIjtzOjE6IjEiO3M6MzY6IgBBZHJvdXRlX0FkdmVydGlzZQBfaXNDb3VudHJ5QmxvY2tlZCI7aTowO3M6MjU6IgBBZHJvdXRlX0FkdmVydGlzZQBfcHJpY2UiO2k6MDtzOjMzOiIAQWRyb3V0ZV9BZHZlcnRpc2UAX2J1ZGdldEdyb3VwSUQiO2k6MDtzOjMxOiIAQWRyb3V0ZV9BZHZlcnRpc2UAX21lYXN1cmVtZW50IjtOO30%21" target="_blank"><img id="ad_img" width="100%" height="100%" src="https://static.pc-adroute.focas.jp/tmp/bannars/38048/2023/12/12/21/38048_17023853774316.jpg" /></a><div class="adbk_border"></div></body></html>)throw r;i.push(r)}throw new TypeError(i.map((e=>e.message)).join(", "))}async post(e,t){const i={"X-Requested-With":"XMLHttpRequest"};return t?t.headers=Object.assign(t.headers||{},i):t={headers:i},window.fetch(e,function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(Object(i),!0).forEach((function(t){n(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({method:"POST"},t))}}},5224:(e,t,i)=>{i.d(t,{D:()=>o});i(6544);var r=i(8794);function n(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const s="history_action";class o{constructor(){n(this,"localStorage",void 0),this.localStorage=r.K}save(e){try{this.localStorage.setItem(s,JSON.stringify(e))}catch(t){}}load(){try{const e=this.localStorage.getItem(s);return null===e?null:JSON.parse(e)}catch(e){return null}}remove(){try{this.localStorage.removeItem(s)}catch(e){}}}},6695:(e,t,i)=>{i.d(t,{E:()=>l});i(3374),i(6544);var r=i(8794);function n(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class s{constructor(e,t){n(this,"series",void 0),n(this,"episode",void 0),n(this,"type",void 0),n(this,"createdAt",void 0),this.episode=e,this.series=t,this.createdAt=Date.now(),this.type="episode"}static createFromObject(e){const t=new s(e.episode,e.series);return t.createdAt=e.createdAt,t.type=e.type,t}}function o(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const a="history_manager";class l{constructor(){o(this,"localStorage",void 0),o(this,"historyData",void 0),this.localStorage=r.K,this.historyData=this.loadHistoryData()}get length(){return this.historyData.length}loadHistoryData(){let e=[];try{e=JSON.parse(this.localStorage.getItem(a)||"[]")}catch(t){}return e.map((e=>s.createFromObject(e))).filter((e=>{var t;return void 0!==(null===(t=e.series)||void 0===t?void 0:t.id)}))}getAll(e="ASC"){return"DESC"===e?this.historyData.slice().reverse():this.historyData}getFirst(){return this.getAll()[0]}getLast(){return this.getAll("DESC")[0]}get(e){const{begin:t,end:i}=e;return this.getAll("DESC").slice(t,i)}add(e,t){const i=this.historyData,r=new s(e,t),n=i.findIndex((e=>e.series.id===t.id));for(n>-1&&i.splice(n,1),i.push(r);i.length>50;)i.shift();try{this.localStorage.setItem(a,JSON.stringify(i))}catch(o){}}clear(){this.localStorage.removeItem(a),this.historyData=[]}}},1131:(e,t,i)=>{i.d(t,{F:()=>n});i(6544);function r(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class n{constructor(e,t,i){if(r(this,"id",void 0),r(this,"title",void 0),r(this,"thumbnailUrl",void 0),!(e&&t&&i))throw new Error("Arguments should be filled");this.id=e,this.title=t,this.thumbnailUrl=i}}},7979:(e,t,i)=>{i.d(t,{$:()=>c});i(752),i(6265),i(3964),i(9307),i(4043),i(5137),i(6544);var r=i(4789),n=i(2845),s=i(1131);function o(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function a(){return Math.floor(Math.random()*Math.floor(1e8)).toString()}async function l(e,t){return(await(0,r.W)(e,{freeOnly:!0}).catch((()=>[]))).filter((e=>e.createAt>t))}class c{constructor(e,t){o(this,"historyManager",void 0),o(this,"historyActionStorage",void 0),this.historyManager=e,this.historyActionStorage=t}async getNotifications(){const e=new URLSearchParams(location.search);if(e.has("debug-history-notification")){const o=e.get("debug-history-notification-size"),l=e.get("debug-history-notification-is-new"),c=e.get("debug-history-notification-has-new-episode");return t=null===o?15:+o,i=null===l||!!JSON.parse(l),r=null===c||!!JSON.parse(c),[...Array(t)].map((()=>{const e=a(),t=a(),o=r?a():t;return{series:new s.F(e,`ダミー作品 ${e}`,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAAAAADmVT4XAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAHdElNRQfjBhEBHBG25BFOAAAB40lEQVR42u3Uy3KbMBgF4Lz/GxyEoOaSji+TcZqQuonxTEwIBumhKiHGZOHEiEWbxdHCkgXn5wMJbvR/bjcEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEDANwVsY9erIg3DrFB23BWZNOPuSkXP6GXASboqXQ4kuUBuynQJRJYJJF8LfKMXAKraLeCqFIjftG5yPJg7w6rVul1h+/nVZ0QvAAqY5qokKG33jlTrFI0dN3bct1rIU99FrW/0a0C93++HKgKnvpfCVqnssBqrPGFtfn+6K/lFr+0BPVR5fXV1kWj9B4tD2x4W2J0feI6Dmd7MiE4FuNZkffLFPl8Ev8cDb0Fcy3EBfKI+gDLqb/KYIogDYKPGQ4+QHxbAKzoZcMwRWvlRyGeTL2M8jqeppN8Gc6ITAeo+ENt+Ny2x72cq/BhPO0VYdPOi0wBqiax2MwmGtQ7FeNoaOX7Ni04DPIzLth4W++PLXGLZxUE1JzoNoGR4fsAlpC3T3NpPm2ttFL6b+Uz5RycCjgiioZnPTgCZpQFuz9fbwG6xFQr/6ESAe337Zv7Vd2ko8925yHDvTShq3+h1wL9rBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAF/AZ5Es9mufb37AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE5LTA2LTE3VDEwOjI4OjE3KzA5OjAwkSBM8wAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOS0wNi0xN1QxMDoyODoxNyswOTowMOB99E8AAAAASUVORK5CYII="),episode:new n.I({createAt:0,id:t,permaLink:"#",title:"ダミーエピソード"}),type:"episode",isNew:i,newestEpisode:new n.I({createAt:0,id:o,permaLink:"#",title:"ダミーエピソード"})}}))}var t,i,r;const o=[],c=this.historyActionStorage.load(),d=c?c.visitedAt:0,h=this.historyManager.get({begin:0,end:20});for(const n of h){const e=await l(n.series.id,n.createdAt);if(0===e.length)continue;const t=e[e.length-1];o.push({series:n.series,episode:t,type:"episode",isNew:t.createAt>d,newestEpisode:e[0]})}return o.sort(((e,t)=>e.episode.createAt<t.episode.createAt?1:-1)),o}}},2845:(e,t,i)=>{i.d(t,{I:()=>n});var r=i(9065);class n extends r.x{constructor(e){super(e),this.type="episode"}}},9065:(e,t,i)=>{i.d(t,{x:()=>s});i(3964),i(752),i(6265),i(4043),i(6544);var r=i(3178);function n(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class s{constructor(e){n(this,"id",void 0),n(this,"permaLink",void 0),n(this,"title",void 0),n(this,"imageUrls",void 0),n(this,"imageUrisDigest",void 0),n(this,"createAt",void 0),n(this,"shouldUpdate",void 0),n(this,"type",void 0);const{id:t,title:i,permaLink:r,imageUrls:s,imageUrisDigest:o,createAt:a}=e;if("string"!=typeof t||"string"!=typeof i||"string"!=typeof r)throw new Error(`Arguments should be filled: id = ${t}, title = ${i}, permaLink = ${r}`);this.id=t,this.title=i,this.permaLink=r,this.imageUrls=Object.freeze(s),this.imageUrisDigest=o,this.type="unknown",this.shouldUpdate=!1,this.createAt=a||Date.now()}get path(){return`/${this.type}/${this.id}`}get readable(){return!!this.imageUrls&&this.imageUrls.length>0}get sinceFromDownload(){return Date.now()-this.createAt}async checkForUpdate(){return r.N.get(this.path+".json",{credentials:"include"}).then((async function(e){return e.json()})).then((e=>e.readableProduct.imageUrisDigest!==this.imageUrisDigest&&this))}cacheExistCheck(){if(!window.caches)return;if(!this.imageUrls)return;const e=[...this.imageUrls,this.path];return Promise.all(e.map((async function(e){return caches.match(e,{ignoreSearch:!0})}))).then((e=>e.filter((e=>!!e)))).then((t=>t.length===e.length))}removeFromCache(){this.imageUrls&&navigator.serviceWorker&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({action:"remove",urls:this.imageUrls.concat(this.path)})}}},1162:(e,t,i)=>{i.d(t,{R$:()=>a,WH:()=>r,Yu:()=>s,vs:()=>o,zZ:()=>n});const r=(e,t)=>{window.location.hash.substr(1)===t&&e.triggerShowModalEvents()},n=e=>{r(e,"purchase")},s=e=>{r(e,"rental")},o=e=>{r(e,"bulk-purchase")},a=e=>{r(e,"login")}},6103:(e,t,i)=>{i.d(t,{u:()=>a});i(6544);var r=i(2907),n=i(4592),s=i(320);function o(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class a{constructor(e){o(this,"container",void 0),o(this,"modal",void 0),o(this,"modalOpenButtons",void 0),o(this,"closeButton",void 0),o(this,"allContainers",void 0),o(this,"valuesBeforeModalOpen",void 0),o(this,"storeScrollPosition",void 0),o(this,"showModalContainer",(e=>{this.overrideInputTypes(),this.overrideValues(e.currentTarget),(0,s.Cp)(this.allContainers),(0,s.$Z)(this.container),r.X.ios&&document.body.classList.add("showing-modal"),e.preventDefault()})),o(this,"closeModalContainer",(e=>{document.body.classList.remove("showing-modal"),(0,s.Cp)(this.container),this.restoreOverrideValues(),e.preventDefault()})),this.setButton(e);const t=(0,n.o)(".js-"+e+"-modal-container");this.container=t,this.modal=(0,n.o)(".js-"+e+"-modal",t),this.closeButton=(0,n.o)(".js-"+e+"-modal-close-button",t),this.allContainers=Array.from(document.querySelectorAll(".js-modal-container")),this.storeScrollPosition=[],this.valuesBeforeModalOpen=[],this.registerEvents()}setButton(e){this.modalOpenButtons=Array.from(document.querySelectorAll(".js-"+e+"-button"))}registerEvents(){this.modalOpenButtons.forEach((e=>{e.addEventListener("click",this.showModalContainer)})),this.closeButton.addEventListener("click",this.closeModalContainer),this.container.addEventListener("click",this.closeModalContainer),this.modal.addEventListener("click",(e=>{e.stopPropagation()}))}triggerShowModalEvents(){const e=document.createEvent("UIEvent");e.initUIEvent("touchstart",!0,!0,window,0);const t=document.createEvent("MouseEvent");t.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.modalOpenButtons.forEach((i=>{i.dispatchEvent(e),i.dispatchEvent(t)}))}overrideInputTypes(){this.container.querySelectorAll("[data-override-type-on-modal-open]").forEach((e=>{const t=e.getAttribute("data-override-type-on-modal-open");t&&e.setAttribute("type",t)}))}overrideValues(e){this.valuesBeforeModalOpen=[];const t=e.getAttribute("data-override-value-selector");if(!t)return;const i=e.getAttribute("data-override-value");if(!i)return;Array.from(document.querySelectorAll(t)).forEach((e=>{this.valuesBeforeModalOpen.push({element:e,value:e.value}),e.value=i}))}restoreOverrideValues(){this.valuesBeforeModalOpen.forEach((e=>{e.element.value=e.value})),this.valuesBeforeModalOpen=[]}}},6696:(e,t,i)=>{i.d(t,{Z:()=>s,j:()=>o});i(6544);var r=i(454);function n(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class s{constructor(){n(this,"pointContainers",void 0),this.pointContainers=document.querySelectorAll(".js-point-container")}displayPointNeeded(e){this.pointContainers.forEach((t=>{const i=this.readableProductPrice(t),r=this.calculatePointNeeded(e,i);this._displayPointNeeded(t,r),this.fillInRawInsufficientPointElements(t,r)}))}_displayPointNeeded(e,t){t>0&&e.querySelectorAll(".js-point-needed").forEach((e=>e.textContent=`-${t}pt`))}calculatePointNeeded(e,t){return t?Math.max(0,t-e):0}readableProductPrice(e){const t=e.querySelector(".js-readable-product-point-container");if(!t)return;t.dataset.readableProductPrice&&t.dataset.readableProductRentalPrice&&(0,r.T)(new Error(".js-readable-product-point-container is in illegal state."));const i=t.dataset.readableProductPrice||t.dataset.readableProductRentalPrice;return i?+i:void 0}fillInRawInsufficientPointElements(e,t){e.querySelectorAll(".js-insufficient-point-raw").forEach((e=>{const i=Math.max(0,t)+"";"INPUT"===e.nodeName?e.value=i:e.textContent=i}))}}const o={paid:0,free:0,total:0,next_expires:0,next_expires_at:null,need_notice_next_expire:!1}},2538:(e,t,i)=>{i.d(t,{B:()=>s,_:()=>o});i(6544);var r=i(3178);function n(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class s{constructor(e,t){var i;n(this,"purchaseButton",void 0),n(this,"endpoint",void 0),n(this,"returnLocationPath",void 0),n(this,"enable",void 0),n(this,"purchase",(()=>{if(!this.enable)return;this.purchaseButton.setAttribute("disabled","disabled"),this.enable=!1;const e=new FormData;e.append("return_location_path",this.returnLocationPath),r.N.post(this.endpoint,{body:e}).then((e=>e.json())).then((e=>{if(e.return_location_path)window.location.href=e.return_location_path;else if(e.dataerror)throw e.dataerror.message})).catch((e=>{window.alert(e.message),this.enable=!0,this.purchaseButton.removeAttribute("disabled")}))})),this.purchaseButton=e,this.returnLocationPath=t,this.endpoint=null!==(i=this.purchaseButton.dataset.purchaseEndpoint)&&void 0!==i?i:"",this.enable=!0,this.registerEvents()}registerEvents(){this.purchaseButton.addEventListener("click",this.purchase)}}class o{constructor(e,t){n(this,"purchaseButton",void 0),n(this,"purchaseDiv",void 0),n(this,"progressDiv",void 0),n(this,"progressError",void 0),n(this,"progressTitle",void 0),n(this,"progressTitleDone",void 0),n(this,"closeButton",void 0),n(this,"endpoint",void 0),n(this,"returnLocationPath",void 0),n(this,"enable",void 0),this.purchaseButton=e.querySelector(".js-bulk-purchase-button"),this.purchaseDiv=e.querySelector(".js-bulk-purchase-div"),this.progressDiv=e.querySelector(".js-bulk-purchase-progress"),this.closeButton=e.querySelector(".js-bulk-purchase-modal-close-button"),this.progressError=e.querySelector(".js-progress-error"),this.progressTitle=e.querySelector(".js-progress-title"),this.progressTitleDone=e.querySelector(".js-progress-title-done"),this.returnLocationPath=t,this.endpoint=this.purchaseButton.dataset.purchaseEndpoint,this.enable=!0,this.registerEvents()}registerEvents(){this.purchaseButton.addEventListener("click",(()=>{this.bulkPurchase()}))}showProgressDiv(){this.progressError.classList.add("hidden"),this.purchaseDiv.classList.add("hidden"),this.closeButton.classList.add("hidden"),this.progressDiv.classList.remove("hidden")}showProgressError(){this.closeButton.classList.remove("hidden"),this.progressError.classList.remove("hidden")}afterPurchaseSuccess(e){this.progressTitle.classList.add("hidden"),this.progressTitleDone.classList.remove("hidden"),setTimeout((()=>{window.location.href=e.return_location_path}),200)}bulkPurchase(){if(!this.enable||!this.endpoint)return;this.purchaseButton.disabled=!0,this.enable=!1;const e=new FormData;e.append("return_location_path",this.returnLocationPath);const t=document.querySelectorAll("[name=readable_product_id]:checked");for(let i=0;i<t.length;i++){const r=t[i].getAttribute("name"),n=t[i].getAttribute("value");null!==r&&null!==n&&e.append(r,n)}this.showProgressDiv(),r.N.post(this.endpoint,{body:e}).then((e=>{if(!e.ok)throw new Error;return e.json()})).then((e=>{this.afterPurchaseSuccess(e)})).catch((()=>{this.showProgressError(),this.enable=!0}))}}},8928:(e,t,i)=>{i.d(t,{J:()=>n});var r=i(6103);const n=e=>{const t=e.price<=e.point.total?e.modalNameAvailable:e.modalNameUnavailable;return new r.u(t)}},8531:(e,t,i)=>{i.d(t,{A:()=>v});i(6544);var r=i(5795),n=i(7979),s=i(6695),o=i(81),a=i(5757),l=i(5224),c=i(9900);function d(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class h extends r.q{constructor(e){super(e),d(this,"updateNotificationManager",void 0),d(this,"enableMoreButton",void 0),d(this,"lastVisitedAt",void 0),this.updateNotificationManager=new n.$(new s.E,new l.D)}setup(){this.updateNotificationManager.getNotifications().then((e=>this.view.append(e)))}}class u extends r.G{constructor(e){super(e)}createPresenter(){return new h(this)}initMembers(e){this.$container=e}append(e){const t=e.map((e=>{const t=new Date(e.episode.createAt)<=new Date,i=new Date(e.newestEpisode.createAt)<=new Date;return(0,c.BX)("li",{children:[(0,c.BX)("div",{class:"thumb-container",children:[(0,c.tZ)("a",{href:e.episode.permaLink,children:(0,c.tZ)("img",{src:e.series.thumbnailUrl,alt:e.series.title})}),(0,c.tZ)("div",{class:"red-circle",style:{visibility:e.isNew?"visible":"hidden"}})]}),(0,c.BX)("div",{class:"link-container",children:[(0,c.tZ)("a",{class:"title-box",href:e.episode.permaLink,children:(0,c.BX)("div",{children:[t?(0,c.tZ)("p",{class:"episode-date",children:(0,a.tC)(e.episode.createAt)}):null,(0,c.tZ)("p",{class:"series-title",children:e.series.title}),(0,c.tZ)("p",{class:"episode-title",children:e.episode.title})]})}),e.episode.id!==e.newestEpisode.id?(0,c.BX)("div",{class:"newest-box",children:[(0,c.tZ)("a",{class:"newest-episode-link",href:e.newestEpisode.permaLink,children:"最新話へ"}),i?(0,c.BX)("p",{class:"newest-episode-date",children:[(0,a.tC)(e.newestEpisode.createAt),"更新"]}):null]}):null]})]})}));new o.bE({container:this.$container[0],items:t})}}var p=i(454),g=i(5311),m=i.n(g);const v=()=>{try{const e=document.querySelector(".js-update-notification-list-container");if(!e)return;new u(m()(e))}catch(e){(0,p.T)(e)}}},3296:(e,t,i)=>{i.d(t,{Z:()=>h});i(752),i(6265),i(6544);var r=i(6696);const n={wj:"normal",sq:"normal",uj:"normal"};var s=i(3178),o=i(454),a=i(4217),l=i.n(a);function c(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const d={logged_in:!1,rank:"normal",premium_via_external_app:!1,point:r.j,csrf_token:void 0,internal_error:!1,subscriptions:n,not_appear_text:void 0,point_gettable_episode_ids:void 0,hide_2023_12_campaign:!1,hide_upgrade_announce_banner:!1};const h=new class{constructor(){c(this,"promise",void 0),c(this,"eventEmitter",void 0),c(this,"loginEnabled",void 0),this.eventEmitter=new(l())}enableLogin(){this.loginEnabled=!0}retrieveUserPromise(){return this.enableLogin(),this.promise?this.promise:this.promise=s.N.get("/my.json").then((e=>e.json())).then((e=>{var t,i,s,o,a,l,c,d,h,u,p,g,m,v,f,y;const w={logged_in:null!==(t=e.logged_in)&&void 0!==t&&t,rank:null!==(i=e.rank)&&void 0!==i?i:"normal",premium_via_external_app:null!==(s=e.premium_via_external_app)&&void 0!==s&&s,point:null!==(o=e.point)&&void 0!==o?o:r.j,csrf_token:null!==(a=e.csrf_token)&&void 0!==a?a:void 0,internal_error:null!==(l=e.internal_error)&&void 0!==l?l:void 0,subscriptions:{wj:null!==(c=null===(d=e.subscriptions)||void 0===d?void 0:d.wj)&&void 0!==c?c:n.wj,sq:null!==(h=null===(u=e.subscriptions)||void 0===u?void 0:u.sq)&&void 0!==h?h:n.sq,uj:null!==(p=null===(g=e.subscriptions)||void 0===g?void 0:g.uj)&&void 0!==p?p:n.uj},not_appear_text:null!==(m=e.not_appear_text)&&void 0!==m?m:void 0,point_gettable_episode_ids:null!==(v=e.point_gettable_episode_ids)&&void 0!==v?v:void 0,hide_2023_12_campaign:null!==(f=e.hide_2023_12_campaign)&&void 0!==f&&f,hide_upgrade_announce_banner:null!==(y=e.hide_upgrade_announce_banner)&&void 0!==y&&y};return this.emit("update",w),w})).catch((e=>((0,o.T)(e),d)))}forceRetrieveUserPromise(){return this.promise=void 0,this.retrieveUserPromise()}on(e,t,i){this.eventEmitter.on(e,t,i)}emit(e,...t){this.eventEmitter.emit(e,...null!=t?t:[])}}},2706:(e,t,i)=>{i.d(t,{sO:()=>xr});var r=i(8531),n=i(5311),s=i.n(n),o=(i(3964),i(6544),i(5795)),a=i(6695),l=i(3115),c=i.n(l);const d=(e,...t)=>{let i=e[0];return t.forEach(((r,n)=>{i+=c()(t[n])+e[n+1]})),i};var h=i(4789),u=i(5757),p=i(454);let g,m=e=>e;function v(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class f extends o.q{constructor(e){super(e),v(this,"historyManager",void 0),v(this,"lastHistory",void 0),this.historyManager=new a.E,this.lastHistory=this.historyManager.getLast()}async setup(){if(this.lastHistory){this.view.mount(this.lastHistory);try{const e=await(0,h.W)(this.lastHistory.series.id);if(0===e.length)return;const t=(0,u.tC)(e[0].createAt);this.view.mount(this.lastHistory,t)}catch(e){(0,p.T)(e)}}}}class y extends o.G{constructor(e){super(e)}createPresenter(){return new f(this)}initMembers(e){this.$container=e}mount(e,t){var i;this.$container.removeClass("hidden"),null===(i=this.$item)||void 0===i||i.remove();const r=t?`最終更新日: ${t}`:"",n=s()(d(g||(g=m`<a href="${0}">
        <div class="thmb-container">
          <img src="${0}">
        </div>
        <div class="title-box">
          <p class="episode-title">${0}</p>
          <p class="series-title">${0}</p>
          <p class="episode-title">${0}</p>
        </div>
      </a>`),e.episode.permaLink,e.series.thumbnailUrl,r,e.series.title,e.episode.title));this.$container.append(n),this.$item=n}}let w,b=e=>e;function S(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class P extends o.q{constructor(e){super(e),S(this,"historyManager",void 0),S(this,"enableMoreButton",void 0),this.historyManager=new a.E,this.enableMoreButton=this.historyManager.length>10}setup(){0===this.historyManager.get({begin:0,end:10}).length&&this.view.showEmptyListMessage(),this.view.append(this.historyManager.get({begin:0,end:10})),this.enableMoreButton&&this.view.showMoreButton()}showMore(){const e=this.historyManager.get({begin:10,end:20});this.view.append(e)}}class E extends o.G{constructor(e){super(e)}createPresenter(){return new P(this)}initMembers(e){this.$container=e,this.$historyListContainer=this.$container.find(".history-list"),this.$emptyListMessage=this.$container.find(".empty-list-message"),this.$moreButtonContainer=this.$historyListContainer.find(".more-button-container"),this.$moreButton=this.$moreButtonContainer.find(".more-button")}showEmptyListMessage(){this.$historyListContainer.css("display","none"),this.$emptyListMessage.removeClass("hidden")}registerEvents(){this.$moreButton.on("click",(()=>this.onClickShowMore()))}onClickShowMore(){this.$moreButtonContainer.addClass("hidden"),this.presenter.showMore()}showMoreButton(){this.$moreButton.removeClass("hidden")}append(e){e.forEach((e=>{s()(d(w||(w=b`<li>
                <a href='${0}'>
                    <div class="thmb-container">
                      <img src="${0}" alt="${0}">
                    </div>
                    <div class="link-container">
                        <div class="title-box">
                          <p class="series-title">${0}</p>
                          <p class="episode-title">${0}</p>
                        </div>
                    </div>
                </a>
            </li>`),e.episode.permaLink,e.series.thumbnailUrl,e.series.title,e.series.title,e.episode.title)).insertBefore(this.$moreButtonContainer)}))}}function k(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class L extends o.q{constructor(e){super(e),k(this,"historyManager",void 0),k(this,"showButton",void 0),this.historyManager=new a.E,this.showButton=this.historyManager.length>0,this.showButton&&this.view.showButton()}clearHistory(){this.historyManager.clear()}}class j extends o.G{constructor(e){super(e)}createPresenter(){return new L(this)}initMembers(e){this.$clearButton=e}registerEvents(){this.$clearButton.on("click",(e=>this.clickClearButton(e)))}showButton(){s()(".clear-history-wrapper").removeClass("hidden")}clickClearButton(e){e.preventDefault(),confirm("履歴を消去すると元に戻せません。本当に消去しますか？")&&(this.presenter.clearHistory(),location.reload())}}var x=i(4002);const C=()=>{const e=s()(".js-last-reading-container"),t=s()(".js-history-list-container"),i=s()(".js-clear-history-button");e[0]&&new y(e),t[0]&&new E(t),i[0]&&new j(i)},T=new x.j,A=()=>{const e=document.querySelector(".js-download-list-container"),t=document.querySelector(".clear-download-wrapper");if(!e||!t)return;e.classList.remove("hidden"),t.classList.remove("hidden");const i=t.querySelector(".js-clear-download-button");if(!i)return;const r=()=>{confirm("本当に全てのキャッシュをクリアしますか？")&&(T.clearAllPageImageCache(),i.removeEventListener("click",r),A())};i.addEventListener("click",r);const n=e.querySelector(".download-list");n&&(n.innerHTML="",T.getAll().forEach((e=>{const t=document.createElement("li"),i=document.createElement("a"),r=document.createElement("button");i.textContent=e.title,i.href=e.path,r.textContent="キャッシュをクリア",r.addEventListener("click",(()=>{confirm("本当にキャッシュをクリアしますか？")&&(T.removeById(e.id),A())})),t.appendChild(i),t.appendChild(r),n.appendChild(t)})))};var O=i(5055),I=i(5224);function M(){(0,O.Q)(),(0,r.A)(),C(),A();(new I.D).save({visitedAt:Date.now()})}i(752),i(6265),i(6801);var B=i(6893);const N=e=>{let t=!1;return(...i)=>{if(!t)return t=!0,e(...i)}};i(4043),i(7267);const D=e=>e.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"_").length;var q=i(4217),F=i.n(q),_=i(3211),z=i(9453);i(5415);const R={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>e*(2-e),easeInOutQuad:e=>e<.5?2*e*e:(4-2*e)*e-1,easeInCubic:e=>e*e*e,easeOutCubic:e=>--e*e*e+1,easeInOutCubic:e=>e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},U=1e3/60,$=(e,t,i)=>{var r;const n=R[null!==(r=i.easing)&&void 0!==r?r:"linear"],{duration:s,step:o,complete:a}=i,l=U/s,c=Date.now(),d=Object.keys(t),h=Object.fromEntries(d.map((t=>[t,e[t]]))),u=Object.fromEntries(d.map((i=>[i,t[i]-e[i]])));let p=0;const g=window.setInterval((()=>{if(Date.now()-c>=s)return d.forEach((i=>{e[i]=t[i]})),a&&a(),clearInterval(g);p+=l,d.forEach((t=>{e[t]=h[t]+u[t]*n(p)})),o&&o()}),U);return()=>{clearInterval(g),d.forEach((i=>{e[i]=t[i]})),a&&a()}};var H=i(320);function V(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class Z extends o.q{constructor(e,t){super(e),V(this,"maxAgeMs",void 0),V(this,"isDisposed",void 0),V(this,"fadingFraction",void 0),V(this,"fadingDuration",void 0),V(this,"show",(()=>{this.view.show()})),V(this,"hide",(()=>{this.isDisposed||(this.isDisposed=!0,$(this,{fadingFraction:0},{duration:this.fadingDuration,step:()=>{this.view.updateFading()},complete:()=>{this.view.updateFading(),this.view.dispose()}}))})),this.maxAgeMs=1500,this.isDisposed=!1,this.fadingFraction=1,this.fadingDuration=250}setup(){this.show(),window.setTimeout(this.hide,this.maxAgeMs)}}class G extends o.G{constructor(e){super(e)}initMembers(e){this.guide=e,this.onClick=this.onClick.bind(this),this.onSlideStart=this.onSlideStart.bind(this)}registerEvents(){var e;null===(e=this.guide)||void 0===e||e.addEventListener("click",this.onClick),z.F.on("slidestart",this.onSlideStart),_.F.addOnLeaveListener((()=>{var e;null===(e=this.guide)||void 0===e||e.removeEventListener("click",this.onClick),z.F.off("slidestart")}))}createPresenter(){return new Z(this,{})}show(){this.guide&&(0,H.$Z)(this.guide)}updateFading(){this.guide&&(this.guide.style.opacity=this.presenter.fadingFraction.toString())}dispose(){this.guide&&(this.guide.remove(),this.guide=void 0)}onClick(e){this.presenter.hide(),e.preventDefault()}onSlideStart(){this.presenter.hide()}}var K=i(2223);const J=null!==K.Z&&void 0!==K.Z&&K.Z.isEnabled?K.Z:null;var W=i(2907);function X(){return W.X.windows||W.X.linux?Q({key:"F11"}):W.X.macOSOrIPadOS?Q({key:"f"}):null}function Q({ctrlKey:e,shiftKey:t,altKey:i,metaKey:r,key:n}){const s=[];return e&&s.push("Control"),t&&s.push("Shift"),i&&s.push("Alt"),r&&s.push("Meta"),s.push(n),s.join("+")}class Y extends o.q{}class ee extends o.G{constructor(e){super(e)}createPresenter(){return new Y(this)}initMembers(e){this.body=document.body,this.container=e.container,this.viewer=e.viewer,this.buttonExpand=this.container.querySelector(".js-viewer-btn-start-fullscreen"),this.buttonClose=this.container.querySelector(".js-viewer-btn-close-fullscreen");const t=document.querySelector(".js-viewer-controller");t&&(this.controllerContainer=t),this.onEnterFullScreen=e.onEnterFullScreen,this.isFullscreen=!!J&&J.isFullscreen,this.gigaSpyOnExpandClick=e.gigaSpyOnExpandClick,this.gigaSpyOnFullscreenChange=e.gigaSpyOnFullscreenChange,this.onFullscreenChange=this.onFullscreenChange.bind(this),this.onExpandClick=this.onExpandClick.bind(this),this.onCloseClick=this.onCloseClick.bind(this),this.onKeyDown=this.onKeyDown.bind(this)}registerEvents(){if(null!=J&&J.isEnabled){if(this.controllerContainer){let e;["mouseenter","touchstart"].forEach((t=>{this.controllerContainer&&_.F.addOnLeaveListenerHelper(this.controllerContainer,t,(t=>{e&&clearTimeout(e),this.isFullscreen&&this.controllerContainer&&(this.controllerContainer.classList.contains("show")||t.preventDefault(),this.controllerContainer.classList.add("show"))}))}));const t=()=>{e&&window.clearTimeout(e),this.isFullscreen&&this.controllerContainer&&this.controllerContainer.classList.remove("show")};if(this.viewer.addEventListener("click",t),_.F.addOnLeaveListener((()=>this.viewer.removeEventListener("click",t))),!this.controllerContainer)return;_.F.addOnLeaveListenerHelper(this.controllerContainer,"mouseleave",(()=>{var t;this.isFullscreen&&null!==(t=this.controllerContainer)&&void 0!==t&&t.classList.contains("show")&&(e&&clearTimeout(e),e=window.setTimeout((()=>{e=null,this.controllerContainer&&this.controllerContainer.classList.remove("show")}),800))}))}this.buttonExpand.addEventListener("click",this.onExpandClick),this.buttonClose.addEventListener("click",this.onCloseClick),_.F.addOnLeaveListener((()=>{this.buttonExpand.removeEventListener("click",this.onExpandClick),this.buttonClose.removeEventListener("click",this.onCloseClick)})),_.F.addOnLeaveListenerHelper(document,"keydown",this.onKeyDown),null!=J&&J.isEnabled&&(J.onchange(this.onFullscreenChange),_.F.addOnLeaveListener((()=>null==J?void 0:J.off("change",this.onFullscreenChange)))),_.F.addOnLeaveListenerHelper(window,"beforeunload",(()=>{J&&this.isFullscreen&&J.exit()}))}else{var e;null===(e=document.querySelector(".js-hidden-on-disabled-fullscreen"))||void 0===e||e.remove()}}onFullscreenChange(){var e;null===(e=this.gigaSpyOnFullscreenChange)||void 0===e||e.call(this),this.isFullscreen=!!J&&J.isFullscreen,this.body.classList.toggle("fullscreen",this.isFullscreen),this.isFullscreen&&window.scroll(0,0);const t=window.document.createEvent("UIEvents");t.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(t)}onExpandClick(){var e;return null===(e=this.gigaSpyOnExpandClick)||void 0===e||e.call(this),!(this.isFullscreen||null==J||!J.isEnabled)&&(!("object"==typeof navigator.userActivation&&!navigator.userActivation.isActive)&&(J.request(),this.onEnterFullScreen(),!1))}onCloseClick(){return!!this.isFullscreen&&(null!=J&&J.isEnabled&&J.exit(),this.onFullscreenChange(),!1)}onKeyDown(e){if(!function(e,t){return Q(e)===t}(e,X()))return;if(null==J||!J.isEnabled)return;e.target instanceof HTMLElement&&e.target.closest("a, input, textarea, select, button")||(this.isFullscreen?null!=J&&J.isEnabled&&J.exit():(null!=J&&J.isEnabled&&J.request(),this.onEnterFullScreen()),e.preventDefault())}}var te=i(3304);function ie(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class re extends te.R{constructor(e){super(0,0),ie(this,"element",void 0),ie(this,"resizeHandlers",void 0),ie(this,"updateSize",(()=>{const e=this.element,t=getComputedStyle(e,null),i=parseFloat(t.width.replace("px","")),r=parseFloat(t.height.replace("px",""));i===this.width&&r===this.height||(this.width=i,this.height=r,this.resizeHandlers.forEach((e=>e())))})),this.element=e,this.resizeHandlers=[],this.registerEvents(),this.updateSize()}registerEvents(){window.addEventListener("resize",this.updateSize),this.element.addEventListener("transitionend",this.updateSize),_.F.addOnLeaveListener((()=>{window.removeEventListener("resize",this.updateSize),this.element.removeEventListener("transitionend",this.updateSize)}))}onResize(e){this.resizeHandlers.push(e)}offResize(){this.resizeHandlers=[]}}function ne(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class se{constructor(e){ne(this,"element",void 0),ne(this,"currentTransition",void 0),this.element=e}fadeIn(e){this.rejectPreviousTransition();const t=`giga-fade-in-${e}`,i=this.element;return i.classList.add(t,"hide"),i.style.display=oe(i),new Promise(((e,r)=>{const n=()=>{i.classList.remove(t,"show"),this.clearPreviousTransition(),e()};i.addEventListener("transitionend",n),requestAnimationFrame((()=>{i.classList.add("show"),i.classList.remove("hide")})),this.currentTransition={reject:r,onTransitionEnd:n}}))}fadeOut(e){this.rejectPreviousTransition();const t=`giga-fade-out-${e}`,i=this.element;return i.style.display=oe(i),i.classList.add(t,"show"),new Promise(((e,r)=>{const n=()=>{i.style.display="none",i.classList.remove(t,"hide"),this.clearPreviousTransition(),e()};i.addEventListener("transitionend",n),requestAnimationFrame((()=>{i.classList.add("hide"),i.classList.remove("show")})),this.currentTransition={reject:r,onTransitionEnd:n}}))}rejectPreviousTransition(){this.currentTransition&&(this.currentTransition.reject(),this.removePreviousEventListener())}removePreviousEventListener(){this.currentTransition&&this.element.removeEventListener("transitionend",this.currentTransition.onTransitionEnd)}clearPreviousTransition(){this.removePreviousEventListener(),delete this.currentTransition}}const oe=e=>{const t=e.style.display;if(t&&"none"!==t)return t;e.style.display="";const i=getComputedStyle(e).display;if(e.style.display=t,"none"!==i)return i;const r=e.ownerDocument,n=r.body.appendChild(r.createElement(e.nodeName)),s=getComputedStyle(n).display;return n.remove(),s};function ae(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class le{constructor(e){if(ae(this,"header",void 0),ae(this,"fader",void 0),ae(this,"show",(()=>{var e;this.header&&(this.headerHasClass("active")||(null===(e=this.fader)||void 0===e||e.fadeIn("fast"),this.header.classList.remove("inactive"),this.header.classList.add("active")))})),ae(this,"hide",(()=>{var e;this.header&&(this.headerHasClass("inactive")||(null===(e=this.fader)||void 0===e||e.fadeOut("fast"),this.header.classList.remove("active"),this.header.classList.add("inactive")))})),this.header=e,!this.header)return;this.header.addEventListener("mouseenter",this.show),this.header.addEventListener("mouseleave",this.hide),this.header.addEventListener("click",this.show);const t=this.header.querySelector(".header-container.secret");t&&(this.fader=new se(t)),_.F.addOnTransition(this.hide)}headerHasClass(e){if(!this.header)return;return this.header.classList.contains(e)}}var ce=i(8794);function de(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class he{constructor(e){de(this,"localStorage",void 0),de(this,"isExpand",void 0),de(this,"view",void 0),this.view=e;let t="0";this.localStorage=ce.K,t=this.localStorage.getItem("isExpand"),null===t&&(t="0",this.view.isVerticalViewer&&(t="1")),this.isExpand="1"===t,null!=J&&J.isEnabled&&J.isFullscreen||this.changeViewerMode(this.localStorageValueToModeString(t)),this.setupFullscreen()}setupFullscreen(){null!=J&&J.isEnabled&&J.onchange((()=>{if(null!=J&&J.isFullscreen)this.changeViewerMode("fullscreen");else{let t="0";try{t=this.localStorage.getItem("isExpand")}catch(e){}null===t&&(t="0",this.view.isVerticalViewer&&(t="1")),this.changeViewerMode(this.localStorageValueToModeString(t))}}))}changeViewerMode(e){this.saveCurrentSetting(e),null!=J&&J.isEnabled&&J.isFullscreen&&"fullscreen"!==e&&J.exit(),this.view.changeViewerMode(e)}saveCurrentSetting(e){if("fullscreen"!==e)try{this.localStorage.setItem("isExpand","expand"===e?"1":"0")}catch(t){}}localStorageValueToModeString(e){return"1"===e?"expand":"reset"}}class ue{constructor(e,t){de(this,"buttonNormal",void 0),de(this,"buttonExpand",void 0),de(this,"presenter",void 0),de(this,"isVerticalViewer",void 0),this.buttonNormal=e.querySelector(".js-viewer-btn-normal"),this.buttonExpand=e.querySelector(".js-viewer-btn-expand"),this.isVerticalViewer=t,this.presenter=new he(this),this.buttonNormal.addEventListener("click",(()=>{this.presenter.changeViewerMode("reset")})),this.buttonExpand.addEventListener("click",(()=>{this.presenter.changeViewerMode("expand")}))}changeViewerMode(e){this.buttonNormal.classList.toggle("current","reset"===e),this.buttonExpand.classList.toggle("current","expand"===e),window.setTimeout((()=>{const e=window.document.createEvent("UIEvents");e.initUIEvent&&e.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(e)}),201),document.body.classList.toggle("expand","expand"===e)}}var pe=i(3976),ge=i(4513),me=i(4366),ve=(i(8730),i(9307),i(3178));function fe(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function ye(e,t,i){(0,p.T)(new Error(e+" Image URL is "+t),["{{ default }}",i])}class we{constructor(e){fe(this,"src",void 0),fe(this,"width",void 0),fe(this,"height",void 0),fe(this,"choJuGiga",void 0),fe(this,"isGif",void 0),fe(this,"_isLoaded",void 0),fe(this,"_retryCounter",void 0),fe(this,"imageElement",void 0),fe(this,"_firstFrame",void 0),this.src=e.src,this.width=e.width,this.height=e.height,this.choJuGiga=e.choJuGiga,this.isGif=e.isGif,this._isLoaded=!1,this._retryCounter=0}load(e){return new Promise(((t,i)=>{if(!e&&this.isLoaded)return i(!1);const r=this.src;r&&(ve.N.get(r).then((e=>e.blob())).then((e=>{const r=document.createElement("img");if(e.size<10)return ye(`Loaded image is too small(${e.size}). `,this.src,"page-image-too-small-error"),i(!1);const n=N((()=>{this.imageElement=r,t(r)}));r.addEventListener("load",n),r.classList.add("page-image","js-page-image"),r.src=URL.createObjectURL(e)})).catch((e=>{if(e.response&&404===e.response.status)return ye("Failed to load image (status code is 404).",this.src,this.src),i(!1);i(!0)})),this._isLoaded=!0)}))}detach(){var e;this._isLoaded=!1,null===(e=this.imageElement)||void 0===e||e.remove(),delete this.imageElement,delete this._firstFrame}get isLoaded(){return this._isLoaded}get willRetry(){return this._retryCounter++<6}get skipDrm(){return"baku"!==this.choJuGiga}get firstFrame(){if(!this.isGif)return;if(!this.imageElement)return;if(this._firstFrame)return this._firstFrame;const e=document.createElement("canvas");e.width=this.width,e.height=this.height;const t=e.getContext("2d");return t instanceof CanvasRenderingContext2D?(t.drawImage(this.imageElement,0,0),this._firstFrame=e.toDataURL(),this._firstFrame):void 0}}function be(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class Se{constructor(e){be(this,"capacity",void 0),be(this,"current",void 0),be(this,"queue",void 0),this.capacity=e,this.queue=[],this.current=0}take(e,t){const i=[];let r=!1;for(let n=0;n<e.length;n++)!r&&this.current<this.capacity?(this.current++,this.nextTick(e[n])):(i.push(e[n]),r=!0);t?this.queue.unshift(...i):this.queue.push(...i)}leave(e){if(0!==this.current)for(this.current--;0!==this.queue.length&&this.current+1<=this.capacity;){const e=this.queue.shift();this.current++,this.nextTick(e)}}nextTick(e){setTimeout(e,0)}}class Pe{constructor(e,t){if(be(this,"pageAreas",void 0),be(this,"semaphore",void 0),be(this,"loadCapacity",void 0),be(this,"pageImages",void 0),be(this,"loadedImageIndexes",void 0),!e)throw new Error("containerが空のところ(ビューワがないページ？)でPageImageLoaderを呼んでいそうです");this.pageAreas=Array.from(e.querySelectorAll(".js-page-area"));let i=0;this.pageImages=Object.freeze(this.pageAreas.map(((e,r)=>{if(e.classList.contains("hide")&&e.querySelector(".js-page-ad"))return i++,null;const n=t[r-i];return null!=n&&n.src?new we({src:n.src,width:n.dimension.width,height:n.dimension.height,choJuGiga:n.choJuGiga,isGif:Boolean(n.isGif)}):null}))),this.semaphore=new Se(2),this.loadedImageIndexes=new Set}controlPlayingGifAnimation(e,t){t.forEach(((t,i)=>{var r;const n=t.querySelector(".js-page-image"),s=null===(r=this.pageImages[i])||void 0===r?void 0:r.firstFrame;if(s){const t=e.indexOf(i)>-1;null==n||n.setAttribute("src",t?this.pageImages[i].src:s)}}))}loadPageImage(e,t){const i=this.pageImages[e];this.loadedImageIndexes.add(e),i?null==i||i.load(t).then((t=>{this.semaphore.leave(e),i.skipDrm?this.appendPageImage(e,t,t.src):requestIdleCallback((()=>{const i=(0,me.IK)(t);i&&(i.classList.add("page-image","js-page-image"),this.appendPageImage(e,i,t.src))}),{timeout:1e3})})).catch((t=>{this.semaphore.leave(e),t&&i.willRetry&&this.delay(1e3).then((()=>{this.semaphore.take([()=>this.loadPageImage(e,!0)])}))})):this.semaphore.leave(e)}appendPageImage(e,t,i){const r=this.pageAreas[e];r&&(this.unmountedPageImage(e),r.appendChild(t))}unmountedPageImage(e){const t=this.pageAreas[e];if(!t)return;const i=Array.from(t.querySelectorAll(".js-page-image"));for(const r of i)r.remove()}loadImagePageAt(e){const t=[];e.forEach((e=>{const i=this.pageImages[e];null!=i&&i.isLoaded||t.push((()=>this.loadPageImage(e,!1)))})),this.semaphore.take(t,!0),requestIdleCallback((()=>{const t=Math.min(...e),i=Math.max(...e);for(const e of this.loadedImageIndexes){if(Math.abs(e-t)>10&&Math.abs(e-i)>10){const t=this.pageImages[e];null!=t&&t.isLoaded&&(this.pageAreas[e]&&(t.detach(),this.unmountedPageImage(e)),this.loadedImageIndexes.delete(e))}}}),{timeout:1e3})}destroyImages(){let e=0;for(const t of this.pageImages)null==t||t.detach(),this.unmountedPageImage(e++)}delay(e){return new Promise(((t,i)=>{setTimeout(t,e)}))}}i(4564),i(385);function Ee(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class ke{constructor(e){Ee(this,"title",void 0),Ee(this,"startAt",void 0),this.title=e.title,this.startAt=e.startAt}}class Le{constructor(e,t){Ee(this,"contents",void 0),Ee(this,"currentMagazineUrl",void 0),Ee(this,"nextMagazineId",void 0),Ee(this,"prevMagazineId",void 0),Ee(this,"nextMagazineUrl",void 0),Ee(this,"prevMagazineUrl",void 0),Ee(this,"currentThumbnailUrl",void 0),Ee(this,"currentTitle",void 0);const i=e.items;i&&(this.contents=Object.freeze(i.map((e=>new ke({title:e.title,startAt:e.startAt}))))),this.currentMagazineUrl=t,this.nextMagazineId=e.next_id,this.nextMagazineUrl=e.next_url,this.prevMagazineId=e.prev_id,this.prevMagazineUrl=e.prev_url,this.currentThumbnailUrl=e.thumbnail_url,this.currentTitle=e.title}get enabledPaging(){return this.isMagazine}get enableSkipContent(){return this.isMagazine}get isMagazine(){if(!this.currentMagazineUrl)return!1;const e=new URL(this.currentMagazineUrl);return/\/magazine\/\d+$/.test(e.pathname)}get hasContents(){return!!this.contents&&this.contents.length>0}contentIndexContainsScreenAt(e){let t=-1;if(this.contents[0].startAt>e)return-1;for(let i=0;i<this.contents.length;i++){if(this.contents[i].startAt>e){t=i-1;break}t=i}return t}}var je=i(4883);function xe(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Ce="SHOWING_SLIDER",Te="modeChanged";const Ae=new class{constructor(){xe(this,"mode",void 0),xe(this,"eventEmitter",void 0),this.mode="default",this.eventEmitter=new(F()),this.restoreMode()}restoreMode(){const e=ce.K.getItem(Ce);if(!e)return;JSON.parse(e)&&this.setMode("slider")}getMode(){return this.mode}setMode(e){this.mode=e,this.eventEmitter.emit(Te),ce.K.setItem(Ce,JSON.stringify("slider"===e))}addModeChangedListener(e){this.eventEmitter.addListener(Te,e),_.F.addOnLeaveListener((()=>{this.eventEmitter.removeListener(Te,e)}))}};function Oe(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class Ie extends o.q{constructor(e,t){super(e),Oe(this,"enabled",void 0),Oe(this,"repository",void 0),Oe(this,"onClickedLinkToJumpPageAtHandlers",void 0),Oe(this,"controller",void 0),Oe(this,"activeContent",void 0),this.enabled=!1,this.controller=Ae,this.onClickedLinkToJumpPageAtHandlers=[],this.repository=t.tableOfContentsRepository,this.repository.eventEmitter.on("tocLoaded",(()=>{this.view.clearContent(),this.setup();const e=document.querySelector(".table-of-contents-skip-nav");new URL(this.repository.currentContentsListStructure.currentMagazineUrl).pathname===location.pathname?(e.classList.remove("hidden"),this.activeContent&&this.activeContent.pathname===location.pathname&&this.view.changeActiveContent(this.activeContent.contentIndex)):e.classList.add("hidden")})),this.view.eventEmitter.on("switchToNextToc",(()=>this.switchToNextToc())),this.view.eventEmitter.on("switchToPrevToc",(()=>this.switchToPrevToc())),this.view.eventEmitter.on("registeredClickLinkToJumpPageAt",(e=>this._registerClickLinkToJumpPageAt(e)))}setup(){this.enabled=this.repository.hasCurrent,this.enabled&&(this.view.nextTocButtonVisibility=this.repository.hasNext,this.view.prevTocButtonVisibility=this.repository.hasPrev,this.view.enable(),this.buildHtml());const e=document.querySelector(".table-of-contents-skip-nav");this.repository.currentContentsListStructure.enableSkipContent||null==e||e.classList.add("hidden")}buildHtml(){var e,t,i;if(!this.enabled)return;this.view.alterHeader(null!==(e=this.repository.currentContentsListStructure.currentThumbnailUrl)&&void 0!==e?e:"",null!==(t=this.repository.currentContentsListStructure.currentTitle)&&void 0!==t?t:"",null!==(i=this.repository.currentContentsListStructure.currentMagazineUrl)&&void 0!==i?i:"");const r=0!==this.repository.offsetFromInitialContents,n=r?this.repository.currentContentsListStructure.currentMagazineUrl:null;this.repository.currentContentsListStructure.contents.forEach((e=>{this.view.appendContent(e,n,r)}))}get isShowing(){return"tableOfContents"===this.controller.getMode()}set isShowing(e){this.controller.setMode(e?"tableOfContents":"default")}toggleTableOfContents(e){this.enabled&&(this.isShowing=e)}_registerClickLinkToJumpPageAt(e){this.onClickedLinkToJumpPageAtHandlers.push(e)}onClickedLink(e,t){this.onClickedLinkToJumpPageAtHandlers.forEach((i=>i(e,t)))}changeScreen(e){var t;if(!this.enabled)return;const i=Math.max(...e),r=this.repository.currentContentsListStructure.contentIndexContainsScreenAt(i),n=(null===(t=this.activeContent)||void 0===t?void 0:t.contentIndex)!==r;this.view.changeActiveContent(r),this.activeContent={pathname:location.pathname,contentIndex:r};const s=this.repository.currentContentsListStructure.contents[r],o=this.repository.currentContentsListStructure.contents[r+1],a=this.repository.currentContentsListStructure.contents[r-1];this.view.nextContentUrl=null==o?void 0:o.startAt,this.view.prevContentUrl=null==a?void 0:a.startAt,n&&s&&z.F.emit("tocActiveContentChange",s.title)}switchToNextToc(){this.repository.next()}switchToPrevToc(){this.repository.prev()}}class Me extends o.G{constructor(e){super(e)}createPresenter(){return new Ie(this,{tableOfContentsRepository:this.tableOfContentsRepository})}initMembers({tableOfContentsRepository:e,eventEmitter:t}){var i,r,n,s,o,a,l,c,d,h,u,p,g,m,v,f;this.container=document.querySelector(".js-table-of-contents-container"),this.mainContainer=null!==(i=null===(r=this.container)||void 0===r?void 0:r.querySelector(".js-table-of-contents"))&&void 0!==i?i:null,this.closeButtonContainer=document.querySelector(".js-viewer-table-of-contents-button-container"),this.closeButton=null!==(n=null===(s=this.closeButtonContainer)||void 0===s?void 0:s.querySelector(".js-viewer-table-of-contents-button-close"))&&void 0!==n?n:null,this.contentListItems=Array.from(null!==(o=null===(a=this.container)||void 0===a?void 0:a.querySelectorAll(".js-table-of-content-item"))&&void 0!==o?o:[]),this.tableOfContentsRepository=e,this.eventEmitter=t,this.nextTocButton=null!==(l=null===(c=this.container)||void 0===c?void 0:c.querySelector(".js-table-of-contents-next-button"))&&void 0!==l?l:null,this.prevTocButton=null!==(d=null===(h=this.container)||void 0===h?void 0:h.querySelector(".js-table-of-contents-prev-button"))&&void 0!==d?d:null,this.headerBox=null!==(u=null===(p=this.container)||void 0===p?void 0:p.querySelector(".js-table-of-contents-header-box"))&&void 0!==u?u:null,this.gotoNextContentElement=null!==(g=null===(m=this.container)||void 0===m?void 0:m.querySelector(".js-goto-next-content"))&&void 0!==g?g:null,this.gotoPrevContentElement=null!==(v=null===(f=this.container)||void 0===f?void 0:f.querySelector(".js-goto-prev-content"))&&void 0!==v?v:null,this.onClickContainer=this.onClickContainer.bind(this),this.show=this.show.bind(this),this.close=this.close.bind(this),this.loadNextToc=this.loadNextToc.bind(this),this.loadPrevToc=this.loadPrevToc.bind(this)}registerEvents(){var e,t,i,r;const n=document.querySelector(".js-viewer-btn-table-of-contents");null==n||n.addEventListener("click",this.show),null===(e=this.container)||void 0===e||e.addEventListener("click",this.onClickContainer),null===(t=this.closeButton)||void 0===t||t.addEventListener("click",this.close),null===(i=this.nextTocButton)||void 0===i||i.addEventListener("click",this.loadNextToc),null===(r=this.prevTocButton)||void 0===r||r.addEventListener("click",this.loadPrevToc),_.F.addOnLeaveListener((()=>{var e,t,i,r;null==n||n.removeEventListener("click",this.show),null===(e=this.container)||void 0===e||e.removeEventListener("click",this.onClickContainer),null===(t=this.closeButton)||void 0===t||t.removeEventListener("click",this.close),null===(i=this.nextTocButton)||void 0===i||i.removeEventListener("click",this.loadNextToc),null===(r=this.prevTocButton)||void 0===r||r.removeEventListener("click",this.loadPrevToc)})),[this.gotoNextContentElement,this.gotoPrevContentElement].filter((e=>e)).forEach((e=>{_.F.addOnLeaveListenerHelper(e,"click",(t=>{t.metaKey||t.shiftKey||t.ctrlKey||2!==t.button&&(t.preventDefault(),this.presenter.onClickedLink(t,Number(e.dataset.goto)))}))})),this.presenter.controller.addModeChangedListener((()=>{this.toggle(this.presenter.isShowing)}))}onClickContainer(e){const t=document.querySelector(".table-of-contents-skip-nav");if(!this.mainContainer||!t)return;this.includes(this.mainContainer,e.target)||this.includes(t,e.target)||this.close()}show(){this.toggleTableOfContents(!0)}close(){this.toggleTableOfContents(!1)}includes(e,t){return e===t||null!==t.parentElement&&this.includes(e,t.parentElement)}set nextContentUrl(e){this.gotoNextContentElement&&this.setUrlToMoveToContentElement(this.gotoNextContentElement,e)}set prevContentUrl(e){this.gotoPrevContentElement&&this.setUrlToMoveToContentElement(this.gotoPrevContentElement,e)}setUrlToMoveToContentElement(e,t){t?(e.classList.remove("hidden"),e.setAttribute("href",location.pathname+"#page-"+t),e.setAttribute("data-goto",t+"")):e.classList.add("hidden")}toggleTableOfContents(e){this.presenter.toggleTableOfContents(e)}activatedAt(e){this.presenter.changeScreen(e)}changeActiveContent(e){this.contentListItems.flatMap((e=>{var t,i;return Array.from(null!==(t=null===(i=e.parentNode)||void 0===i?void 0:i.childNodes)&&void 0!==t?t:[])})).filter((e=>e.classList.contains("active"))).forEach((e=>e.classList.remove("active"))),e>-1&&this.contentListItems[e].classList.add("active")}appendContent(e,t,i){if(!this.listContainer)return;const r=document.createElement("li");r.className="js-table-of-content-item table-of-content-item";const n=document.createElement("a");n.href=i?t+"#page-"+e.startAt:"#page-"+e.startAt,n.textContent=e.title,i?(0,je.xl)(n):_.F.addOnLeaveListenerHelper(n,"click",(t=>{t.metaKey||t.shiftKey||t.ctrlKey||2!==t.button&&(t.preventDefault(),this.presenter.onClickedLink(t,e.startAt))})),r.appendChild(n),this.listContainer.appendChild(r),this.update()}clearContent(){this.listContainer&&(this.listContainer.textContent="")}toggle(e){var t,i;null===(t=this.container)||void 0===t||t.classList.toggle("hidden",!e),null===(i=this.closeButtonContainer)||void 0===i||i.classList.toggle("hidden",!e)}enable(){var e;this.listContainer||(this.listContainer=document.createElement("ul"),null===(e=this.mainContainer)||void 0===e||e.appendChild(this.listContainer))}alterHeader(e="",t="",i=""){var r,n,s;const o=null===(r=this.headerBox)||void 0===r?void 0:r.querySelector(".js-table-of-content-header-magazine-thumbnail"),a=null===(n=this.headerBox)||void 0===n?void 0:n.querySelector(".js-table-of-content-header-magazine-title"),l=null===(s=this.headerBox)||void 0===s?void 0:s.querySelector(".js-table-of-content-header-magazine-link");null==o||o.setAttribute("src",e),null==o||o.setAttribute("alt",t+" のサムネイル"),a&&(a.textContent=t),null==l||l.setAttribute("href",i)}loadNextToc(){this.eventEmitter.emit("switchToNextToc")}loadPrevToc(){this.eventEmitter.emit("switchToPrevToc")}update(){var e,t;this.contentListItems=Array.from(null!==(e=null===(t=this.container)||void 0===t?void 0:t.querySelectorAll(".js-table-of-content-item"))&&void 0!==e?e:[]),this.contentListItems.forEach((e=>e.addEventListener("click",this.close)))}set nextTocButtonVisibility(e){var t,i;e?null===(t=this.nextTocButton)||void 0===t||t.classList.remove("hidden"):null===(i=this.nextTocButton)||void 0===i||i.classList.add("hidden")}get nextTocButtonVisibility(){var e;return!(null!==(e=this.nextTocButton)&&void 0!==e&&e.classList.contains("hidden"))}set prevTocButtonVisibility(e){var t,i;e?null===(t=this.prevTocButton)||void 0===t||t.classList.remove("hidden"):null===(i=this.prevTocButton)||void 0===i||i.classList.add("hidden")}get prevTocButtonVisibility(){var e;return!(null!==(e=this.prevTocButton)&&void 0!==e&&e.classList.contains("hidden"))}listenClickLinkToJumpPageAt(e){this.eventEmitter.emit("registeredClickLinkToJumpPageAt",e)}}class Be{constructor(e,t){Oe(this,"eventEmitter",void 0),Oe(this,"contentsListStructure",void 0),Oe(this,"offsetFromInitialContents",0),this.contentsListStructure=e,this.eventEmitter=t}getTocApiUrl(e){return"/api/viewer/magazine/"+e+"/toc"}get hasCurrent(){return this.contentsListStructure.hasContents}get hasPrev(){return this.contentsListStructure.enabledPaging&&null!==this.contentsListStructure.prevMagazineUrl}get hasNext(){return this.contentsListStructure.enabledPaging&&null!==this.contentsListStructure.nextMagazineUrl}get currentContentsListStructure(){return this.contentsListStructure}async prev(){if(!this.contentsListStructure.prevMagazineId)return;const e=await ve.N.get(this.getTocApiUrl(this.contentsListStructure.prevMagazineId)),t=await e.json();try{this.contentsListStructure=new Le(t,this.contentsListStructure.prevMagazineUrl),this.offsetFromInitialContents--,this.eventEmitter.emit("tocLoaded")}catch(i){}}async next(){if(!this.contentsListStructure.nextMagazineId)return;const e=await ve.N.get(this.getTocApiUrl(this.contentsListStructure.nextMagazineId)),t=await e.json();try{this.contentsListStructure=new Le(t,this.contentsListStructure.nextMagazineUrl),this.offsetFromInitialContents++,this.eventEmitter.emit("tocLoaded")}catch(i){}}}var Ne=i(5567),De=i(308),qe=i(2349),Fe=i(3296),_e=i(5758),ze=i(2397),Re=i(1955);const Ue=async()=>{const e=_e.x.data("pointGettableEpisodeWhenCompleteReading");if(!e)return;if(_e.x.data("id")!==e.databaseId)return;if(!(await Fe.Z.retrieveUserPromise()).logged_in){const i=Re.Z.get("reading_completed_episode_ids"),r=new Set;if(i)try{JSON.parse(i).forEach((e=>{r.add(e)}))}catch(t){(0,p.T)(t)}return r.add(e.id),void Re.Z.set("reading_completed_episode_ids",JSON.stringify([...r]),{path:"/",expires:30})}try{await ve.N.post("/graphql?opname=Viewer_CompleteReadingEpisode",{headers:{"Content-Type":"application/json"},body:JSON.stringify({query:"\n  mutation CompleteReadingEpisode($episodeId: ID!) {\n    completeReadingEpisode(input: { episodeId: $episodeId }) {\n      point\n    }\n  }\n",variables:{episodeId:e.id}})})}catch(t){(0,p.T)(t)}},$e=async()=>{const e=_e.x.data("pointGettableEpisodeWhenCompleteReading");if(!e)return;const t=await Fe.Z.retrieveUserPromise();if(!t.point_gettable_episode_ids||t.point_gettable_episode_ids.includes(e.id))return;const i=document.querySelectorAll(".js-reading-completion-element");for(const r of i)r.style.display="none"},He=async e=>{const t=_e.x.data("pointGettableEpisodeWhenCompleteReading");if(!t)return;const i=await Fe.Z.retrieveUserPromise();if(i.point_gettable_episode_ids&&!i.point_gettable_episode_ids.includes(t.id))return;const r=e.querySelector(`li[data-id="${t.databaseId}"]`),n=null==r?void 0:r.querySelector(".js-reading-completion-badge");n&&(n.classList.remove("hidden"),n.textContent=`完読で${t.gettablePoint}ptゲット`)};function Ve(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class Ze extends o.q{constructor(e,t){super(e),Ve(this,"view",void 0),Ve(this,"latestListEndpoint",void 0),Ve(this,"firstListEndpoint",void 0),this.view=e,this.latestListEndpoint=t.latestListEndpoint,this.firstListEndpoint=t.firstListEndpoint}async setup(){await this.fetchReadableProductList()}async fetchReadableProductList(){return await(0,qe.i)(this.view.getList("first")),this.view.shouldSetupLatestList()?Promise.all([this.setupList("first"),this.setupList("latest")]):Promise.all([this.setupList("first")])}async endpoint(e){return("first"===e?this.firstListEndpoint:this.latestListEndpoint)+await this.readableProductListParameter()}async readableProductListParameter(){if(!Fe.Z.loginEnabled)return"";return(await Fe.Z.retrieveUserPromise()).logged_in?"":"&is_guest=1"}async setupList(e){const t=await this.endpoint(e),i=await ve.N.get(t),r=await i.json(),n=Array.from((0,De.VN)(r.html));n.forEach((e=>{e.querySelectorAll("a").forEach(je.xl)}));const s=(0,ze.LM)();s&&n.forEach((e=>{e.querySelectorAll("a").forEach((e=>{(0,ze.ox)(s,e)}))})),this.view.appendListItems(e,n),this.view.hideLoadingText(e)}}class Ge extends o.G{constructor(e){super(e)}initMembers(e){if(this.container=e.container,this.latestList=e.container.querySelector(".js-latest-readable-product-list"),this.firstList=e.container.querySelector(".js-first-readable-product-list"),this.readMoreButton=e.container.querySelector(".js-read-more-button"),this.errorMessage=e.container.querySelector(".error-message"),this.readMoreButton&&this.latestList){new pe.d5({readMoreButton:this.readMoreButton,readContainer:this.latestList}).onItemLoaded.on("itemLoaded",(()=>{this.latestList&&(this.highlightCurrentReadableProduct(this.latestList),He(this.latestList))}))}}createPresenter(){return new Ze(this,this.container.dataset)}shouldSetupLatestList(){return!!this.latestList}hideLoadingText(e){const t=this.getList(e).querySelector(".loading-text");if(!t)throw this.setErrorMessage("エラーが発生しました. 時間を置いてページを再読込して下さい."),new Error("`loadingText` does not exist.");t.classList.add("hidden")}appendListItems(e,t){const i=this.getList(e);t.forEach((e=>i.appendChild(e)))}getList(e){const t="first"===e?this.firstList:this.latestList;if(!t)throw this.setErrorMessage("エラーが発生しました. 時間を置いてページを再読込して下さい."),new Error(`${e} list does not exist.`);return this.highlightCurrentReadableProduct(t),He(t),t}highlightCurrentReadableProduct(e){const t=_e.x.data("id"),i=e.querySelector(`li[data-id="${t}"]`);if(!i)return;i.classList.toggle("current-readable-product",!0);const r=i.querySelector("a");r&&(Array.from(r.children).forEach((e=>i.appendChild(e))),r.remove())}setErrorMessage(e){if(!this.errorMessage)throw new Error("`errorMessage` list does not exist.");this.errorMessage.classList.remove("hidden"),this.errorMessage.textContent=e}}const Ke=["　"],Je=[":","：","／"],We=e=>{const t=document.createDocumentFragment();return e.prefix&&t.appendChild(document.createTextNode(e.prefix)),e.separator&&t.appendChild(document.createTextNode(e.separator)),e.authorName&&t.appendChild((e=>{const t=document.createElement("a");return t.textContent=e,t.href=`/search?q=${encodeURIComponent(e)}`,t})(e.authorName)),e.suffix&&t.appendChild(document.createTextNode(e.suffix)),t},Xe=e=>{const t=(e=>e.split("/").map((e=>{const t=Je.find((t=>e.includes(t)));let i,r,n;if(t){const r=e.split(t);i=r[0],n=r[1]}else n=e;return Ke.some((e=>{var t;return null===(t=n)||void 0===t?void 0:t.includes(e)}))&&(r=n,n=void 0),{prefix:i,authorName:n,suffix:r,separator:t}})))(e.textContent),i=document.createDocumentFragment();return t.forEach(((e,r)=>{i.appendChild(We(e)),r<t.length-1&&i.appendChild(document.createTextNode("/"))})),i};var Qe=i(1352),Ye=i(5490);function et(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class tt{constructor(e,t,i,r,n){et(this,"controller",void 0),et(this,"controllerElement",void 0),et(this,"buttonElement",void 0),et(this,"closeButton",void 0),et(this,"mode",void 0),this.controller=e,this.controllerElement=t,this.buttonElement=i,this.closeButton=r,this.mode=n,this.registerEvents()}registerEvents(){this.controller.addModeChangedListener((()=>{this.toggleVisibility(this.controller.getMode()===this.mode)})),this.buttonElement&&_.F.addOnLeaveListenerHelper(this.buttonElement,"click",(()=>{this.controller.setMode(this.mode)})),this.closeButton&&_.F.addOnLeaveListenerHelper(this.closeButton,"click",(()=>{this.controller.setMode("default")}))}toggleVisibility(e){if(this.controllerElement){const t=!e;this.controllerElement.classList.toggle("hidden",t)}}}var it=i(79),rt=i(9900);const nt=()=>new Promise((e=>{"complete"===document.readyState?requestIdleCallback(e,{timeout:1e3}):window.addEventListener("load",(()=>{requestIdleCallback(e,{timeout:1e3})}))}));var st=i(2730),ot=i(2845),at=i(1131);const lt=()=>{try{if(!document.querySelector(".js-viewer"))return;if("episode"!==_e.x.data("typeName"))return;const e=_e.x.data("id"),t=_e.x.data("title"),i=_e.x.data("permalink");if(!(e&&t&&i))return;const r=new ot.I({id:e,title:t,permaLink:i}),n=_e.x.data("series");if(!n)return;const s=n.id,o=n.title,l=n.thumbnailUri;if(!(s&&o&&l))return;const c=new at.F(s,o,l);(new a.E).add(r,c)}catch(e){(0,p.T)(e)}},ct="series_comment_like_manager",dt=()=>{const e=ce.K.getItem(ct);return null!==e?JSON.parse(e):{}},ht=e=>{const t=dt();if(0===Object.keys(t).length)return!0;return void 0===t[e]};function ut(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class pt extends o.q{constructor(e,t){super(e),ut(this,"commentId",void 0),this.commentId=t.commentId}async postLike(){await ve.N.post(this.view.getLikeEndpoint()),(e=>{const t=dt();t[e]=!0,ce.K.setItem(ct,JSON.stringify(t))})(this.commentId)}async postUnlike(){await ve.N.post(this.view.getUnlikeEndpoint()),(e=>{const t=dt();delete t[e],ce.K.setItem(ct,JSON.stringify(t))})(this.commentId)}}class gt extends o.G{constructor(e){super(e)}initMembers(e){var t;this.likeButton=e.likeButton,this.commentId=e.likeButton.dataset.seriesCommentId,this.likeCountsSpan=this.likeButton.querySelector(".js-comment-like-counts"),ht(this.commentId)||(this.likeButton.classList.remove("comment-likes-button"),this.likeButton.classList.add("comment-likes-button-done"));0===Number(null!==(t=this.likeButton.dataset.likeCounts)&&void 0!==t?t:0)&&this.likeCountsSpan.classList.add("comment-like-counts-zero")}createPresenter(){return new pt(this,{commentId:this.commentId})}registerEvents(){_.F.addOnLeaveListenerHelper(this.likeButton,"click",(()=>this.onClick()))}onClick(){var e;const t=Number(null!==(e=this.likeButton.dataset.likeCounts)&&void 0!==e?e:0);ht(this.commentId)?this.presenter.postLike().then((()=>{this.likeCountsSpan.innerText=String(t+1),this.likeCountsSpan.classList.remove("comment-like-counts-zero"),this.likeButton.dataset.likeCounts=String(t+1),this.likeButton.classList.remove("comment-likes-button"),this.likeButton.classList.add("comment-likes-button-done")})):this.presenter.postUnlike().then((()=>{t>0&&(t-1==0&&this.likeCountsSpan.classList.add("comment-like-counts-zero"),this.likeCountsSpan.innerText=String(t-1),this.likeButton.dataset.likeCounts=String(t-1),this.likeButton.classList.remove("comment-likes-button-done"),this.likeButton.classList.add("comment-likes-button"))}))}getLikeEndpoint(){return this.likeButton.dataset.likeEndpoint}getUnlikeEndpoint(){return this.likeButton.dataset.unlikeEndpoint}hide(){(0,H.Cp)(this.likeButton)}}i(6409);const mt="episode_likes_via_viewer",vt=()=>{const e=ce.K.getItem(mt);return null!==e?JSON.parse(e):{}},ft=e=>{const t=vt();if(0===Object.keys(t).length)return!0;return void 0===t[e]};function yt(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class wt extends o.q{constructor(e,t){super(e),yt(this,"episodeId",void 0),this.episodeId=t.episodeId}async postLike(){await ve.N.post(this.view.likeEndpoint),(e=>{const t=vt();t[e]=!0,ce.K.setItem(mt,JSON.stringify(t))})(this.episodeId)}async postUnlike(){await ve.N.post(this.view.unlikeEndpoint),(e=>{const t=vt();delete t[e],ce.K.setItem(mt,JSON.stringify(t))})(this.episodeId)}}class bt extends o.G{constructor(e){super(e)}initMembers(e){this.likeButton=e.likeButton,this.episodeId=e.likeButton.dataset.episodeId,this.likeEndpoint=e.likeButton.dataset.likeEndpoint,this.unlikeEndpoint=e.likeButton.dataset.unlikeEndpoint,ft(this.episodeId)||this.likeButton.classList.add("active")}createPresenter(){return new wt(this,{episodeId:this.episodeId})}registerEvents(){_.F.addOnLeaveListenerHelper(this.likeButton,"click",(()=>this.onClick()))}onClick(){ft(this.episodeId)?(this.likeButton.disabled=!0,this.presenter.postLike().then((()=>{this.likeButton.classList.add("active")})).finally((()=>{this.likeButton.disabled=!1}))):(this.likeButton.disabled=!0,this.presenter.postUnlike().then((()=>{this.likeButton.classList.remove("active")})).finally((()=>{this.likeButton.disabled=!1})))}}const St="report_series_comment_manager",Pt=()=>{const e=ce.K.getItem(St);return null!==e?JSON.parse(e):{}},Et=e=>{const t=Pt();if(0===Object.keys(t).length)return!0;const i=t[e];return void 0===i||i};function kt(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Lt="automatic_bookmarker";class jt{constructor(e,t){kt(this,"localStorage",void 0),kt(this,"automaticBookmarker",void 0),kt(this,"key",void 0),this.localStorage=e,this.automaticBookmarker=this.loadAutomaticBookmarker(),this.key=t}loadAutomaticBookmarker(){let e={};try{e=JSON.parse(this.localStorage.getItem(Lt)||"{}")}catch(t){}return e}get(){return this.automaticBookmarker[this.key]}set(e){this.automaticBookmarker[this.key]=e;try{this.localStorage.setItem(Lt,JSON.stringify(this.automaticBookmarker))}catch(t){}}delete(){if(delete this.automaticBookmarker[this.key])try{this.localStorage.setItem(Lt,JSON.stringify(this.automaticBookmarker))}catch(e){}}}function xt(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Ct="hidden";class Tt{constructor(e,t){xt(this,"codeAppearButton",void 0),xt(this,"codeContainer",void 0),xt(this,"copyCodeButton",void 0),xt(this,"codeTextarea",void 0),xt(this,"copiedMessage",void 0),this.codeAppearButton=e,this.codeContainer=t,this.copyCodeButton=t.querySelector(".js-copy-url-button"),this.codeTextarea=t.querySelector(".js-share-url-textarea"),this.copiedMessage=t.querySelector(".js-copied-message"),this.registerEvents()}registerEvents(){_.F.addOnLeaveListenerHelper(this.codeAppearButton,"click",(e=>{e.preventDefault(),this.toggleCodeContainer(),this.focus()})),_.F.addOnLeaveListenerHelper(this.codeTextarea,"focus",(e=>{e.preventDefault(),this.focus()})),_.F.addOnLeaveListenerHelper(this.copyCodeButton,"click",(e=>{e.preventDefault(),this.copyCode()}))}toggleCodeContainer(){this.codeContainer.classList.toggle(Ct)}focus(){this.codeTextarea.focus(),this.codeTextarea.select()}copyCode(){this.codeTextarea.focus(),document.execCommand("copy"),this.copiedMessage.classList.remove(Ct),setTimeout((()=>{this.copiedMessage.classList.add(Ct)}),3e3)}}function At(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Ot="series_comment_manager",It="episode_comment_manager";class Mt{constructor(e,t){At(this,"localStorage",void 0),At(this,"seriesId",void 0),At(this,"episodeId",void 0),At(this,"seriesCommentManager",{}),this.localStorage=ce.K,this.seriesId=e,this.episodeId=t}getSeriesCommentManager(){let e=null;try{e=this.episodeId?this.localStorage.getItem(It):this.localStorage.getItem(Ot)}catch(t){}return null!==e&&(this.seriesCommentManager=JSON.parse(e)),this.seriesCommentManager}getCanComment(){var e;const t=this.getSeriesCommentManager();if(0===Object.keys(t).length)return!0;const i=t[null!==(e=this.episodeId)&&void 0!==e?e:this.seriesId];return void 0===i||new Date(i)<new Date}setNextCommentDate(){const e=this.seriesCommentManager;try{var t;const i=new Date;i.setDate(i.getDate()+1),e[null!==(t=this.episodeId)&&void 0!==t?t:this.seriesId]=i.getTime(),this.localStorage.setItem(this.episodeId?It:Ot,JSON.stringify(e))}catch(i){}}}function Bt(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Nt="series_likes";class Dt{constructor(e){Bt(this,"localStorage",void 0),Bt(this,"seriesId",void 0),this.localStorage=ce.K,this.seriesId=e}getAll(){let e={};try{e=JSON.parse(this.localStorage.getItem(Nt)||"{}")}catch(t){}return e}canSeriesLikes(){return void 0===this.getAll()[this.seriesId]}set(){const e=this.getAll();e[this.seriesId]={created_at:Date.now()};try{this.localStorage.setItem(Nt,JSON.stringify(e))}catch(t){}}}function qt(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class Ft{constructor(e,t){qt(this,"option",void 0),qt(this,"form",void 0),qt(this,"enable",void 0),this.form=e,this.option=t,this.enable=!0,this.registerEvents()}registerEvents(){_.F.addOnLeaveListenerHelper(this.form,"submit",(e=>{this.useDefault||e.preventDefault(),this.onSubmitBase(e)}))}onSubmit(e){}makeRetryable(){this.enable=!0,this.buttonStateToggle(!0)}buttonStateToggle(e){const t=this.form.querySelector('button[type="submit"],input[type="submit"]');t&&(e?t.removeAttribute("disabled"):t.setAttribute("disabled","disabled"))}get isOnce(){var e;return!(null===(e=this.option)||void 0===e||!e.once)}get useDefault(){var e;return!(null===(e=this.option)||void 0===e||!e.useDefault)}onSubmitBase(e){return!!this.enable&&(this.isOnce&&(this.enable=!1,this.buttonStateToggle(!1)),this.onSubmit(e),!0)}}class _t extends Ft{constructor(e,t){super(e,{once:!0}),qt(this,"errorDialog",void 0),this.errorDialog=t}onSubmit(){this.setErrorMessage(null),this.hideAllErrorElements();const e=this.form.getAttribute("action");if(!e)return;const t=new FormData(this.form);ve.N.post(e,{body:t}).then((e=>e.json())).then((e=>{e.return_location_path?window.location.href=e.return_location_path:e.error&&(e.error.error_element_class_name?this.showErrorElement(e.error.error_element_class_name):this.setErrorMessage(e.error.message),this.makeRetryable())}))}setErrorMessage(e){this.errorDialog.textContent=e}hideAllErrorElements(){(0,H.Cp)(document.querySelectorAll(".js-login-error-message-element"))}showErrorElement(e){const t=document.querySelector(`.js-login-error-message-element.js-${e}`);t&&(0,H.$Z)(t)}}class zt extends Ft{constructor(e,t,i,r,n){super(e,{once:!0}),qt(this,"element",void 0),qt(this,"errorElement",void 0),qt(this,"seriesCommentManager",void 0),this.element=t,this.errorElement=i,this.seriesCommentManager=new Mt(r,n),this.seriesCommentManager.getCanComment()?(0,H.$Z)(this.form):(0,H.$Z)(this.element)}onSubmit(){const e=this.form.getAttribute("action");if(!e)return;const t=new FormData(this.form);(0,H.Cp)(this.errorElement),ve.N.post(e,{body:t}).then((e=>{200===e.status?((0,H.Cp)(this.form),(0,H.$Z)(this.element),this.seriesCommentManager.setNextCommentDate()):400===e.status&&((0,H.$Z)(this.errorElement),this.makeRetryable())}))}}class Rt extends Ft{constructor(e,t,i,r){super(e,{once:!0}),qt(this,"element",void 0),qt(this,"hideElements",void 0),qt(this,"commentId",void 0),this.element=t,this.commentId=r,this.hideElements=i,Et(this.commentId)?(0,H.$Z)(this.form):(0,H.$Z)(this.element)}onSubmit(){var e=this;const t=this.form.getAttribute("action");if(!t)return;const i=new FormData(this.form);ve.N.post(t,{body:i}).then((async function(t){if(t.status>=400&&t.status<500){const i=await t.json();"string"==typeof i.error.message&&(e.element.textContent=i.error.message)}else(e=>{const t=Pt();t[e]=!1,ce.K.setItem(St,JSON.stringify(t))})(e.commentId);(0,H.Cp)(e.form),(0,H.$Z)(e.element),e.hideElements.forEach((e=>(0,H.Cp)(e)))}))}}class Ut extends Ft{constructor(e,t,i){super(t,{once:!0}),qt(this,"container",void 0),qt(this,"submitButton",void 0),qt(this,"acceptSeriesLikesPostContent",void 0),qt(this,"finishedSeriesLikesPostContent",void 0),qt(this,"seriesLikesManager",void 0),this.container=e,this.submitButton=t.querySelector('button[type="submit"]'),this.acceptSeriesLikesPostContent=t.querySelector(".js-show-could-series-likes-per-period"),this.finishedSeriesLikesPostContent=t.querySelector(".js-show-done-series-likes-per-period"),this.seriesLikesManager=new Dt(i),this.seriesLikesManager.canSeriesLikes()?this.acceptSeriesLikesStyle():this.setFinishSeriesLikesStyle()}onSubmit(){const e=this.form.getAttribute("action");e&&this.seriesLikesManager.canSeriesLikes()&&ve.N.post(e).then((()=>{this.seriesLikesManager.set(),this.setFinishSeriesLikesStyle()}))}acceptSeriesLikesStyle(){this.container.classList.add("could-series-likes-per-period"),this.acceptSeriesLikesPostContent.classList.remove("hidden"),this.submitButton.disabled=!1}setFinishSeriesLikesStyle(){this.container.classList.remove("could-series-likes-per-period"),this.container.classList.add("done-series-likes-per-period"),this.acceptSeriesLikesPostContent.classList.add("hidden"),this.finishedSeriesLikesPostContent.classList.remove("hidden"),this.submitButton.disabled=!0}}class $t extends Ft{constructor(e){super(e,{once:!0,useDefault:!0})}}const Ht=(e,t,i,r)=>{e.setAttribute("disabled","disabled");const n=()=>{const n=D(t.value)<i||r<D(t.value);e.toggleAttribute("disabled",n)};t.addEventListener("keyup",n),_.F.addOnLeaveListener((()=>t.removeEventListener("keyup",n)))};class Vt{get name(){return"spread"}get isSpread(){return!0}get pagePerScreen(){return 2}get preloadAdsUntil(){return 7}maxScreen(e){return e.spreadMaxScreen}selectPages(e){return e.spreadPages}convertScreenTo(e,t,i){return this.isSpread===e.isSpread?i:t.spreadScreenToSingleScreen(i)}screenToPageIndexes(e,t){return e.screenToPageIndexes(t,!0)}screenToMainPageIndexesOn(e,t){return this.screenToPageIndexesOn(e,t,"main")}screenToOtherPageIndexesOn(e,t){return this.screenToPageIndexesOn(e,t,"other")}screenToPageIndexesOn(e,t,i){return e.screenToPageIndexesOn(t,!0,i)}}class Zt{get name(){return"single"}get isSpread(){return!1}get pagePerScreen(){return 1}get preloadAdsUntil(){return 11}maxScreen(e){return e.singleMaxScreen}selectPages(e){return e.singlePages}convertScreenTo(e,t,i){return this.isSpread===e.isSpread?i:t.singleScreenToSpreadScreen(i)}screenToPageIndexes(e,t){return e.screenToPageIndexes(t,!1)}screenToPageIndexesOn(e,t,i){return e.screenToPageIndexesOn(t,!1,i)}screenToOtherPageIndexesOn(e,t){return this.screenToPageIndexesOn(e,t,"other")}screenToMainPageIndexesOn(e,t){return this.screenToPageIndexesOn(e,t,"main")}}let Gt;var Kt;function Jt(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}(Kt=Gt||(Gt={})).Spread=new Vt,Kt.Single=new Zt;class Wt{constructor(e){Jt(this,"page",void 0),Jt(this,"area",void 0),Jt(this,"layout",void 0),this.page=e.page,this.area=e.area,this.layout=e.layout}get verticalMargin(){return Math.floor((this.area.height-this.page.height)/2)}}class Xt{constructor(e,t){var i;Jt(this,"originalPageDimension",void 0),Jt(this,"minInterPageMargin",void 0),Jt(this,"shouldExpandPagesToFullViewport",void 0),Jt(this,"overrideLayout",void 0),this.originalPageDimension=e,this.minInterPageMargin=20,this.shouldExpandPagesToFullViewport=null!==(i=null==t?void 0:t.shouldExpandPagesToFullViewport)&&void 0!==i&&i}preferLayout(e){this.overrideLayout=e}getLayoutFromViewport(e){return this.overrideLayout?this.overrideLayout:e.isWide?Gt.Spread:Gt.Single}calculatePageSize(e){const t=this.getLayoutFromViewport(e);let i=0,r=0;if(this.originalPageDimension)if(this.shouldExpandPagesToFullViewport){const n=this.originalPageDimension.width*t.pagePerScreen,s=this.originalPageDimension.height;n/s>e.width/e.height?(i=Math.round(e.width/t.pagePerScreen),r=Math.floor(e.width/n*s)):(i=Math.round(e.height/s*this.originalPageDimension.width),r=e.height)}else e.width/e.height>this.originalPageDimension.width*t.pagePerScreen/this.originalPageDimension.height?(r=Math.floor(Math.min(e.height,this.originalPageDimension.height)),i=Math.round(r*this.originalPageDimension.width/this.originalPageDimension.height)):(i=Math.floor(Math.min(e.width/t.pagePerScreen,this.originalPageDimension.width)),r=Math.round(i*this.originalPageDimension.height/this.originalPageDimension.width));else r=e.height,i=Math.round(e.width/t.pagePerScreen);const n=i+Math.ceil(Math.max((e.width-i*t.pagePerScreen)/4,this.minInterPageMargin/2)),s=Math.floor(e.height),o=new te.R(i,r),a=new te.R(n,s);return new Wt({page:o,area:a,layout:t})}}const Qt=(e,t,i)=>{if("ttb"===i)return;const r="rtl"===i;t.forEach(((t,i)=>{var n;const s=null===(n=e[i])||void 0===n?void 0:n.align;"left"===s?(t.classList.toggle("align-left",r),t.classList.toggle("align-right",!r),t.classList.toggle("align-center",!1)):"right"===s?(t.classList.toggle("align-left",!r),t.classList.toggle("align-right",r),t.classList.toggle("align-center",!1)):"center"===s?(t.classList.toggle("align-left",!1),t.classList.toggle("align-right",!1),t.classList.toggle("align-center",!0)):(t.classList.toggle("align-left",!1),t.classList.toggle("align-right",!1),t.classList.toggle("align-center",!1))}))};function Yt(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function ei(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Yt(Object(i),!0).forEach((function(t){ti(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Yt(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function ti(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class ii extends o.q{get isRtl(){return this.readingDirection===Ye.aE.RTL}get isLtr(){return this.readingDirection===Ye.aE.LTR}get isHorizontal(){return this.readingDirection!==Ye.aE.TTB}getLayoutFromViewport(e){return this.isHorizontal?1===this.view.pageAreaCount()?Gt.Single:e.isWide?Gt.Spread:Gt.Single:Gt.Single}get isSpread(){return this.layout.isSpread}constructor(e,t){super(e),ti(this,"locator",void 0),ti(this,"pageSize",void 0),ti(this,"viewportDimension",void 0),ti(this,"offset",void 0),ti(this,"layout",void 0),ti(this,"readingDirection",void 0),ti(this,"currentPages",void 0),this.offset=0,this.viewportDimension=t.viewportDimension;const i=JSON.parse(t.coverStructureJson);this.readingDirection=i.readingDirection,this.currentPages=i.pages.map(((e,t)=>new Ye.T3(ei(ei({},e),{},{index:t,choJuGiga:"usagi",contentEnd:"",contentStart:"",isGif:!1})))),this.layout=this.getLayoutFromViewport(t.viewportDimension);const r=this.currentPages.filter((e=>e.isMain))[0].dimension;this.locator=new Xt(r)}setup(){this.view.initialRender(),this.setViewportSize(this.viewportDimension)}setViewportSize(e){this.viewportDimension=new te.R(e.width,e.height);const t=this.locator.calculatePageSize(this.viewportDimension);this.pageSize=t,this.layout=this.getLayoutFromViewport(this.viewportDimension),this.offset=this.calculateOffset(),this.view.render()}get displayingPageIndexes(){return this.currentPages.map((e=>e.index))}calculateOffset(){let e=this.pageSize.area.width*this.layout.pagePerScreen/2;return this.isLtr&&!this.isSpread&&2===this.view.pageAreaCount()&&(e+=this.pageSize.area.width),Math.floor(this.viewportDimension.width/2-e)}}class ri extends o.G{constructor(e){super(e)}initMembers(e){const t=e.container;this.container=t,this.content=t.querySelector(".js-thumbnail-image-container"),this.viewport=e.viewport,this.pageImageLoader=e.pageImageLoader,this.pageAreas=Array.from(t.querySelectorAll(".js-page-area")),this.style=document.createElement("style"),document.head.appendChild(this.style),this.onResize=this.onResize.bind(this)}registerEvents(){this.viewport.onResize(this.onResize)}onResize(){this.presenter.setViewportSize(new te.R(this.viewport.width,this.viewport.height))}createPresenter(){var e;const t=this.container;return new ii(this,{viewportDimension:this.viewport,coverStructureJson:null!==(e=t.getAttribute("data-cover-structure"))&&void 0!==e?e:""})}initialRender(){var e;null===(e=this.container.querySelector(".js-link-page"))||void 0===e||e.classList.remove("hidden");const t=this.presenter.displayingPageIndexes;this.pageImageLoader.loadImagePageAt(t);const i=this.presenter.currentPages;Qt(i,this.pageAreas,this.presenter.readingDirection),this.pageAreas.forEach((e=>{e.classList.remove("hide")}))}pageAreaCount(){return this.pageAreas.length}shouldAlignCenter(){return 1===this.pageAreaCount()}render(){const e=this.presenter;this.content.style.right=this.presenter.offset+"px",this.content.classList.toggle("is-spread",e.isSpread);const t=e.pageSize.area.width*this.pageAreaCount(),i=e.pageSize.page.width*this.pageAreaCount();let r=`\n                .js-thumbnail .js-page-area {\n                    width: ${e.pageSize.area.width}px;\n                    height: ${e.pageSize.area.height}px;\n                }\n                .js-thumbnail .js-page-area.align-center {\n                    width: ${t}px;\n                }\n                .js-thumbnail .js-page, .js-thumbnail .js-back-matter, .js-thumbnail .js-page-image {\n                    width: ${e.pageSize.page.width}px;\n                    height: ${e.pageSize.page.height}px;\n                    margin-top: ${e.pageSize.verticalMargin}px;\n                }\n                .js-thumbnail .align-center .js-page-image {\n                    width: ${i}px;\n                }\n            `;this.shouldAlignCenter()&&(r+="\n                    .js-thumbnail .js-page-area {\n                        text-align: center;\n                    }\n                "),this.style.innerHTML=r}}i(2795),i(3383);function ni(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class si{constructor(){ni(this,"ratio",void 0),this.ratio=1}setRatio(e){this.ratio=e}get isZoomed(){return this.ratio>1.05}}var oi=i(7603);const ai=()=>{const e=location.hash.substr(1).match(/^page-(\d+)$/);return e?Number(e[1]):0};function li(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class ci{constructor(e,t,i){li(this,"viewerContainer",void 0),li(this,"pageAreas",void 0),li(this,"pageStructure",void 0),li(this,"renderedPages",void 0),this.viewerContainer=e,this.pageAreas=t,this.pageStructure=i,this.renderedPages=[],this.tshirtEnabled&&this.registerEvents("tshirt"),this.kirinukiEnabled&&this.registerEvents("kirinuki")}get tshirtEnabled(){return this.pageStructure.hasButtonsOfType("tshirt")}get kirinukiEnabled(){return this.pageStructure.hasButtonsOfType("kirinuki")}registerEvents(e){Ae.addModeChangedListener((()=>{const t=Ae.getMode()===e;this.viewerContainer.classList.toggle(`controller-mode-${e}`,t)}));const t=this.viewerContainer.querySelector(".js-viewer-content");t&&_.F.addOnLeaveListenerHelper(t,"click",(i=>{if(!i.target)return;const r=i.target;let n=r;for(;n&&n!==t;){if(n.classList.contains(`${e}-modal`)){i.stopPropagation();break}n=n.parentNode}if(r.classList.contains(`${e}-link`)){const e=r.getAttribute("data-index")||"";oi.T.visitTshirtShop(e),Ae.setMode("default")}}))}createOverlay(e){for(const r of e)this.createOverlayForPage(r);const t=e[0];t&&(this.createOverlayForPage(t-1),this.createOverlayForPage(t-2));const i=e[e.length-1];i&&(this.createOverlayForPage(i+1),this.createOverlayForPage(i+2))}createOverlayForPage(e){if(!this.tshirtEnabled&&!this.kirinukiEnabled)return;if(this.renderedPages[e])return;this.renderedPages[e]=!0;const t=this.pageStructure.singlePages[e];if(!t)return;if(!["flyleaf","link","main"].includes(t.type))return;const i=this.pageAreas[e];i&&(this.tshirtEnabled&&this.createTshirtOverlayForPage(e,t,i),this.kirinukiEnabled&&this.createKirinukiOverlayForPage(e,t,i))}createTshirtOverlayForPage(e,t,i){const r=t.getButtonsOfType("tshirt")[0],n="main"===t.type&&r,s=(0,rt.tZ)("span",{className:"tshirt-overlay",children:(0,rt.tZ)("span",{className:"tshirt-modal",children:n?(0,rt.BX)(rt.HY,{children:[(0,rt.BX)("p",{className:"tshirt-make",children:["このページを",(0,rt.tZ)("br",{}),"Tシャツにする"]}),(0,rt.tZ)("a",{className:"tshirt-link",target:"_blank",rel:"noopener noreferrer",href:r.uri,"data-index":e.toString(),children:"購入に進む"})]}):(0,rt.BX)(rt.HY,{children:["このページは",(0,rt.tZ)("br",{}),"Tシャツ化の対象外です"]})})});i.insertBefore(s,i.firstChild)}createKirinukiOverlayForPage(e,t,i){const r=t.getButtonsOfType("kirinuki")[0],n="main"===t.type&&r,s=(0,rt.tZ)("span",{className:"kirinuki-overlay",children:(0,rt.tZ)("span",{className:"kirinuki-modal",children:n?(0,rt.BX)(rt.HY,{children:[(0,rt.BX)("p",{className:"kirinuki-make",children:["このページで",(0,rt.tZ)("br",{}),"切り抜きツイートする"]}),(0,rt.tZ)("a",{className:"kirinuki-link",target:"_blank",rel:"noopener noreferrer",href:r.uri,children:"切り抜きへ進む"})]}):(0,rt.BX)(rt.HY,{children:["このページは",(0,rt.tZ)("br",{}),"切り抜きツイート対象外です"]})})});i.insertBefore(s,i.firstChild)}}const di=(e,t)=>{var i,r;const n=e.ownerDocument;t||(t=e.getBoundingClientRect());const s=n.defaultView;return{left:(null!==(i=null==s?void 0:s.pageXOffset)&&void 0!==i?i:0)+t.left,top:(null!==(r=null==s?void 0:s.pageYOffset)&&void 0!==r?r:0)+t.top}},hi=e=>{const t=getComputedStyle(e),i=e.getBoundingClientRect();if("fixed"===t.position)return i;const r=e.ownerDocument,n=di(e,i);let s=e.offsetParent||r.documentElement;for(;s&&(s===r.body||s===r.documentElement)&&"static"===getComputedStyle(s).position;)s=s.parentElement;let o={top:0,left:0};if(s&&s!==e&&1===s.nodeType){const e=s.getBoundingClientRect(),t=getComputedStyle(s);o=di(s,e),o.top+=parseFloat(t.borderTopWidth.replace("px","")),o.left+=parseFloat(t.borderLeftWidth.replace("px",""))}return{top:n.top-o.top-parseFloat(t.marginTop.replace("px","")),left:n.left-o.left-parseFloat(t.marginLeft.replace("px",""))}};var ui=i(5275);function pi(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class gi{static shouldActivate(){return W.X.mobile}constructor(e){pi(this,"adStyleObserver",void 0),pi(this,"adElements",void 0),pi(this,"adZooms",void 0),pi(this,"callback",void 0),this.callback=e,this.adElements=[],this.adZooms={},this.adStyleObserver=this.generateMutationObserver()}pushAd(e){this.adStyleObserver.observe(e,{attributes:!0,attributeFilter:["style"]}),this.adElements.push(e)}generateWorkaroundStyle(e){let t="";for(const i of this.adElements){const r=i.getBoundingClientRect().width;e>0&&r>e&&(this.adZooms[i.id]=e/r),t+=`#${i.id} {\n                transform: scale(${this.adZooms[i.id]||1});\n                transform-origin: 0%;\n            }`}return t}generateMutationObserver(){const e=new MutationObserver((e=>{let t=!1;e.forEach((e=>{const i=e.target;""!==i.getAttribute("style")&&(i.setAttribute("style",""),t=!0)})),t&&this.callback()}));return _.F.addOnLeaveListener((()=>{e.disconnect()})),e}}let mi=function(e){return e[e.NONE=0]="NONE",e[e.GOING_TO_SWIPE=1]="GOING_TO_SWIPE",e[e.SWIPING=2]="SWIPING",e}({});class vi extends o.q{get isSpread(){return this.layout.isSpread}constructor(e,t){super(e),pi(this,"locator",void 0),pi(this,"pageSize",void 0),pi(this,"viewportDimension",void 0),pi(this,"pageImageLoader",void 0),pi(this,"automaticBookmarker",void 0),pi(this,"controller",void 0),pi(this,"offset",void 0),pi(this,"screen",void 0),pi(this,"layout",void 0),pi(this,"purchased",void 0),pi(this,"finishSliderAnimation",void 0),pi(this,"isRtl",void 0),pi(this,"slideDuration",void 0),pi(this,"isSliding",void 0),pi(this,"swipingState",void 0),pi(this,"startOffset",void 0),pi(this,"startX",void 0),pi(this,"startY",void 0),pi(this,"startTime",void 0),pi(this,"isSlideToTransitGuideShown",void 0),pi(this,"isKeyRepeating",void 0),pi(this,"whichKeyDown",void 0),pi(this,"zoom",void 0),pi(this,"pageStructure",void 0),this.viewportDimension=t.viewportDimension,this.pageImageLoader=t.pageImageLoader,this.automaticBookmarker=t.automaticBookmarker,this.purchased=t.purchased,this.pageStructure=new Ye.uX(t.pageStructureJson),this.locator=new Xt(this.pageStructure.imageSizeForLocator,t.locatorOptions),this.zoom=new si,this.offset=0,this.screen=1,this.layout=Gt.Single,this.isRtl=this.pageStructure.readingDirection===Ye.aE.RTL,this.slideDuration=170,this.isSliding=!1,this.swipingState=mi.NONE,this.startOffset=0,this.startX=0,this.startY=0,this.startTime=0,this.isSlideToTransitGuideShown=!1,this.isKeyRepeating=!1,this.whichKeyDown=null,this.controller=Ae}setup(){this.setViewportSize(this.viewportDimension),this.emitSliderStateChange(),this.view.removeHidden(),this.view.buildLinkOverlay(this.pageStructure),this.view.buildButtonsOverlay(this.pageStructure),this.preloadAdFrom(1),this.sendEventFrom(1);const e=this.jumpToPageViaHash();if(e>0)return void(1===e&&this.loadImageScreenAt(1));const t=this.automaticBookmarker.get()||1,i=Gt.Single.convertScreenTo(this.layout,this.pageStructure,t);i>1?this.jumpTo(i):this.loadImageScreenAt(1)}get pageHashToLink(){return`#page-${this.automaticBookmarker.get()||1}`}jumpToPageViaHash(){let e=ai();return e?(history.replaceState("",document.title,location.pathname+location.search),e=Gt.Single.convertScreenTo(this.layout,this.pageStructure,e),this.jumpTo(e),e):0}setViewportSize(e){this.finishSliding();const t=this.layout,i=this.locator.calculatePageSize(e);this.pageSize=i,this.layout=i.layout,t!==i.layout&&this.emitSliderStateChange(),this.viewportDimension=new te.R(e.width,e.height);const r=t.convertScreenTo(this.layout,this.pageStructure,this.screen);this.setPagePosition(r),this.preloadAdFrom(r),this.sendEventFrom(r),this.view.updateOffset(),this.view.updateSize(),this.view.updateSlidability(),this.view.updateSliderMaxValue(),this.view.updateSliderPosition()}emitSliderStateChange(){const e=this.pageStructure.screenToPages(this.layout.isSpread),t=Object.entries(e).filter((([e,t])=>!Number.isNaN(+e))).map((([e,t])=>({screen:+e,page:this.layout.convertScreenTo(Gt.Single,this.pageStructure,+e)})));z.F.emit("sliderStateChange",t)}getLayoutFromViewport(e){return e.isWide?Gt.Spread:Gt.Single}get currentMaxScreen(){return this.layout.maxScreen(this.pageStructure)}get currentPages(){return this.layout.selectPages(this.pageStructure)}setPagePosition(e){this.finishSliding();const t=this.calculatePagePosition(e);this.offset=t.offset,this.screen=t.screen,z.F.emit("changedScreen",this.screen)}calculatePagePosition(e){let t=e;t<1&&(t=1),t>this.currentMaxScreen&&(t=this.currentMaxScreen);return{offset:this.calculateOffset(t),screen:t}}calculateOffset(e){let t;t=this.isRtl?e:this.currentMaxScreen-e+1;let i=0;if(this.isSpread)if(this.isRtl)i=this.pageSize.area.width*(2*t-1);else{const e=this.pageStructure.maxPage%2!=0?1:0;i=this.pageSize.area.width*(2*t-1-e)}else{i=(this.pageStructure.isLatter(t)?this.pageSize.page.width/2:this.pageSize.area.width-this.pageSize.page.width/2)+this.pageSize.area.width*(t-1)}return Math.floor(this.viewportDimension.width/2-i)}jumpTo(e){this.calculatePagePosition(e).offset!==this.offset&&(this.loadImageScreenAt(e),this.preloadAdFrom(e),this.sendEventFrom(e),this.setAutomaticBookmarkerScreenAt(e),this.setPagePosition(e),this.view.updateSliderPosition(),this.view.updateOffset(),this.view.updateSlidability())}slideTo(e){this.finishSliding();const t=this.calculatePagePosition(e);t.offset!==this.offset&&(this.isSliding=!0,this.view.startSliding(),this.loadImageScreenAt(e),this.setAutomaticBookmarkerScreenAt(e),this.finishSliderAnimation=$(this,{offset:t.offset},{duration:this.slideDuration,easing:"easeOutCubic",step:()=>{this.view.updateOffset()},complete:()=>{this.isSliding=!1,this.setPagePosition(e),this.view.updateOffset(),this.view.updateSlidability(),this.view.endSliding(),this.preloadAdFrom(e),this.sendEventFrom(e)}}))}preloadAdFrom(e){const t=(0,B.w)(0,this.layout.preloadAdsUntil-1).concat([-1]).flatMap((t=>this.layout.screenToOtherPageIndexesOn(this.pageStructure,e+t)));this.view.displayAdsIfNeededOn(t)}sendEventFrom(e){this.view.sendEventIFNeededOn(this.layout.screenToPageIndexes(this.pageStructure,e)),this.view.onOpenScreen(e);const t=this.purchased&&this.layout.isSpread&&this.pageStructure.maxPage%2==0;this.layout.maxScreen(this.pageStructure)===e?t||this.view.showHeaderNavBar():this.view.hideHeaderNavBar()}finishSliding(){var e;this.isSliding&&(null===(e=this.finishSliderAnimation)||void 0===e||e.call(this))}get canSlideBackward(){return this.screen>1}get canSlideForward(){return this.currentMaxScreen>this.screen}slideBackward(){this.canSlideBackward?this.slideTo(this.screen-1):this.tryNavigateToPreviousReadableProduct()}slideForward(){this.isSlideToTransitGuideShown?this.setSlideToTransitGuideVisibility(!1):this.canSlideForward?this.slideTo(this.screen+1):this.tryNavigateToNextReadableProduct()}slideToSwipedPage(){const e=this.startOffset,t=this.offset-e;if(!t)return;const i=Date.now()-this.startTime,r=this.viewportDimension.width;let n=t/Math.min(1,i/1e3);n=Math.max(Math.min(n,r),-r);const s=n>r/4,o=n<-r/4;this.isRtl&&s||!this.isRtl&&o?this.canSlideBackward?this.slideTo(this.screen-1):(this.slideTo(this.screen),this.tryNavigateToPreviousReadableProduct()):this.isRtl&&o||!this.isRtl&&s?this.canSlideForward?this.slideTo(this.screen+1):(this.slideTo(this.screen),this.tryNavigateToNextReadableProduct()):this.slideTo(this.screen)}get isBaseTargetBlank(){const e=document.querySelector("base");return!!e&&"_blank"===e.target}tryNavigateToNextReadableProduct(){const e=_e.x.data("nextReadableProductUri");null!==e&&(this.isKeyRepeating||(this.isBaseTargetBlank?window.open(e):_.F.transition(e)))}tryNavigateToPreviousReadableProduct(){const e=_e.x.data("prevReadableProductUri");null!==e&&(this.isSlideToTransitGuideShown&&!this.isKeyRepeating?this.isBaseTargetBlank?window.open(e):_.F.transition(e):this.setSlideToTransitGuideVisibility(!0))}setSlideToTransitGuideVisibility(e){this.view.setSlideToTransitGuideVisibility(e),this.isSlideToTransitGuideShown=e}setZoomRatio(e){this.zoom.setRatio(e)}get isZoomed(){return this.zoom.isZoomed}loadImageScreenAt(e){const t=Array.prototype.concat.apply([],[0,1,2,-1].map((t=>this.layout.screenToMainPageIndexesOn(this.pageStructure,e+t))));this.pageImageLoader.loadImagePageAt(t)}setAutomaticBookmarkerScreenAt(e){const t=this.currentPages;let i;for(let r=0;r<t.length;r++){const n=t[r];if(!n)return;if(!i&&n.isMain&&(i=n,e<=n.screen)){this.automaticBookmarker.delete();break}if(i){if(!n.isMain){this.automaticBookmarker.delete();break}if(n.isMain&&e<n.screen){const t=this.layout.convertScreenTo(Gt.Single,this.pageStructure,e);this.automaticBookmarker.set(t);break}}}}handleKeyUp(){this.whichKeyDown=null,this.isKeyRepeating=!1}handleKeyDown(e){switch(e!==this.whichKeyDown?(this.whichKeyDown=e,this.isKeyRepeating=!1):this.isKeyRepeating=!0,e){case 39:this.isRtl?this.slideBackward():this.slideForward();break;case 37:this.isRtl?this.slideForward():this.slideBackward();break;default:return!1}return!0}handleTouchStart(e,t,i){return this.isZoomed||i>1?(this.swipingState===mi.SWIPING&&this.slideToSwipedPage(),this.swipingState=mi.NONE,!1):(this.finishSliding(),this.swipingState=mi.GOING_TO_SWIPE,this.startOffset=this.offset,this.startX=e,this.startY=t,this.startTime=Date.now(),!1)}handleTouchMove(e,t){return this.swipingState!==mi.NONE&&(this.swipingState=mi.SWIPING,this.offset=this.startOffset-(e-this.startX),this.view.updateOffset(),!0)}handleTouchEnd(){if(this.swipingState===mi.NONE)return!1;const e=this.swipingState===mi.SWIPING;return this.swipingState=mi.NONE,this.slideToSwipedPage(),e}handleSliderEvent(e){this.slideTo(e)}get isSliderEnabled(){return"slider"===this.controller.getMode()}enableSlider(e){const t=e?"slider":"default";this.controller.setMode(t)}}class fi extends o.G{constructor(e){super(e)}initMembers({container:e,controller:t,viewport:i,pageImageLoader:r,tableOfContents:n,headerView:s,automaticBookmarker:o,styleInjectionTo:a,locatorOptions:l}){this.container=e,this.content=e.querySelector(".js-viewer-content"),this.slideBackward=e.querySelector(".js-slide-backward"),this.slideForward=e.querySelector(".js-slide-forward"),this.pageAreas=Array.from(e.querySelectorAll(".js-page-area")),this.slideToTransitGuide=e.querySelector(".js-slide-to-transit-guide"),this.colophonEarnedPointsContainer=e.querySelector(".js-colophon-earned-points-container"),this.colophonEarnedPoints=e.querySelector(".js-colophon-earned-points"),this.slider=null==t?void 0:t.querySelector(".js-slider"),this.viewerSlider=null==t?void 0:t.querySelector(".js-viewer-slider"),this.sliderShowButton=null==t?void 0:t.querySelector(".js-viewer-btn-slider"),this.sliderMaxValue=null==t?void 0:t.querySelector(".js-viewer-slider-pagenum-last"),this.sliderCurrentValue=null==t?void 0:t.querySelector(".js-viewer-slider-pagenum-now"),this.viewport=i,this.pageImageLoader=r,this.tableOfContents=n,this.automaticBookmarker=o,this.headerView=s,_.F.addWillTransition((()=>{delete this.headerView})),this.adLoadedPageIndexKeys={},this.startEventSentIdKeys={},this.endEventSentIdKeys={},this.linkPageEventSentIndexKeys={},this.style=document.createElement("style"),(null!=a?a:document.head).appendChild(this.style),gi.shouldActivate()&&(this.adxWorkaround=new gi((()=>this.updateSize()))),this.locatorOptions=l,this.onSlideToTransitGuideClick=this.onSlideToTransitGuideClick.bind(this),this.onResize=this.onResize.bind(this),this.onHashchange=this.onHashchange.bind(this),this.onSlideBackwardClick=this.onSlideBackwardClick.bind(this),this.onSlideForwardClick=this.onSlideForwardClick.bind(this),this.onKeyUp=this.onKeyUp.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.displayAd=this.displayAd.bind(this),this.toggleSlider=this.toggleSlider.bind(this),this.onSliderChange=this.onSliderChange.bind(this),this.earnedPoints=this.earnedPoints.bind(this)}registerEvents(){var e,t,i,r,n,s,o,a;const l=e=>e.stopPropagation();null===(e=this.slideToTransitGuide)||void 0===e||e.addEventListener("click",this.onSlideToTransitGuideClick),null===(t=this.slideToTransitGuide)||void 0===t||t.addEventListener("touchstart",l),this.viewport.onResize(this.onResize),null===(i=this.slideBackward)||void 0===i||i.addEventListener("click",this.onSlideBackwardClick),null===(r=this.slideForward)||void 0===r||r.addEventListener("click",this.onSlideForwardClick),document.addEventListener("keyup",this.onKeyUp),document.addEventListener("keydown",this.onKeyDown),this.container.addEventListener("touchstart",this.onTouchStart),this.container.addEventListener("touchmove",this.onTouchMove),this.container.addEventListener("touchend",this.onTouchEnd),this.container.addEventListener("touchcancel",this.onTouchEnd);const c=()=>this.toggleSlider(!1);this.container.addEventListener("click",c);const d=e=>e.preventDefault();this.container.addEventListener("contextmenu",d),window.addEventListener("hashchange",this.onHashchange);const h=()=>this.toggleSlider(!0);null===(n=this.sliderShowButton)||void 0===n||n.addEventListener("click",h),null===(s=this.slider)||void 0===s||s.addEventListener("input",this.onSliderChange),null===(o=this.slider)||void 0===o||o.addEventListener("change",this.onSliderChange),null===(a=this.tableOfContents)||void 0===a||a.listenClickLinkToJumpPageAt(((e,t)=>{const i=Gt.Single.convertScreenTo(this.presenter.layout,this.presenter.pageStructure,t);this.presenter.jumpTo(i)})),this.presenter.controller.addModeChangedListener((()=>{this.updateSliderVisibility()})),z.F.on("updateScreen",(e=>{this.presenter.slideTo(e)})),this.updateSliderVisibility(),_.F.addOnLeaveListener((()=>{var e,t,i,r,n,s,o,a;null===(e=this.slideToTransitGuide)||void 0===e||e.removeEventListener("click",this.onSlideToTransitGuideClick),null===(t=this.slideToTransitGuide)||void 0===t||t.removeEventListener("touchstart",l),this.viewport.onResize(this.onResize),null===(i=this.slideBackward)||void 0===i||i.removeEventListener("click",this.onSlideBackwardClick),null===(r=this.slideForward)||void 0===r||r.removeEventListener("click",this.onSlideForwardClick),document.removeEventListener("keyup",this.onKeyUp),document.removeEventListener("keydown",this.onKeyDown),this.container.removeEventListener("touchstart",this.onTouchStart),this.container.removeEventListener("touchmove",this.onTouchMove),this.container.removeEventListener("touchend",this.onTouchEnd),this.container.removeEventListener("touchcancel",this.onTouchEnd),this.container.removeEventListener("click",c),this.container.removeEventListener("contextmenu",d),window.removeEventListener("hashchange",this.onHashchange),null===(n=this.sliderShowButton)||void 0===n||n.removeEventListener("click",h),null===(s=this.slider)||void 0===s||s.removeEventListener("input",this.onSliderChange),null===(o=this.slider)||void 0===o||o.removeEventListener("change",this.onSliderChange),null===(a=this.style)||void 0===a||a.remove(),this.pageImageLoader.destroyImages()})),z.F.on("earnedPoints",this.earnedPoints)}createPresenter(){const e=_e.x.data("pageStructure");return new vi(this,{viewportDimension:new te.R(this.viewport.width,this.viewport.height),pageImageLoader:this.pageImageLoader,automaticBookmarker:this.automaticBookmarker,pageStructureJson:e,purchased:!!_e.x.data("hasPurchased"),locatorOptions:this.locatorOptions})}buildLinkOverlay(e){e.singlePages.forEach(((e,t)=>{if(!e.link)return;const{viewBox:i,items:r}=e.link,n="http://www.w3.org/2000/svg",s=document.createElementNS(n,"svg");s.setAttribute("viewBox",i);const o=document.createDocumentFragment();r.forEach((e=>{const t=document.createElementNS(n,"a");t.setAttributeNS("http://www.w3.org/1999/xlink","href",e.linkTo);const i=document.createElementNS(n,"rect");i.setAttribute("x",""+e.x),i.setAttribute("y",""+e.y),i.setAttribute("width",""+e.width),i.setAttribute("height",""+e.height),i.setAttribute("fill-opacity","0.0"),t.appendChild(i),o.appendChild(t)})),s.appendChild(o),this.pageAreas[t].insertBefore(s,this.pageAreas[t].firstChild)}))}buildButtonsOverlay(e){this.buttonsOverlay=new ci(this.container,this.pageAreas,e)}updateSize(){const e=this.presenter;this.container.style.width=e.viewportDimension.width+"px",this.container.style.height=e.viewportDimension.height+"px",this.content.classList.toggle("is-spread",e.isSpread);const t=2*e.pageSize.area.width;let i="";i=e.isSpread?`\n                .js-viewer .js-page-area {\n                    width: ${e.pageSize.area.width}px;\n                    height: ${e.pageSize.area.height}px;\n                }\n                .js-viewer .js-page-area.align-center {\n                    width: ${t}px;\n                }\n                .js-viewer .js-page, .js-back-matter {\n                    width: ${e.pageSize.page.width}px;\n                    height: ${e.pageSize.page.height}px;\n                    margin-top: ${e.pageSize.verticalMargin}px;\n                }\n                .js-page-image {\n                    width: auto;\n                    height: ${e.pageSize.page.height}px;\n                    margin-top: ${e.pageSize.verticalMargin}px;\n                }\n            `:`\n                .js-viewer .js-page-area {\n                    width: ${e.pageSize.area.width}px;\n                    height: ${e.pageSize.area.height}px;\n                }\n                .js-viewer .js-page-image {\n                    width: auto;\n                    height: ${e.pageSize.page.height}px;\n                    margin-top: ${e.pageSize.verticalMargin}px;\n                }\n                .js-viewer .js-page-area.align-center {\n                    width: ${t}px;\n                }\n                .js-viewer .js-page, .js-viewer .js-back-matter {\n                    width: ${e.pageSize.area.width}px;\n                    height: ${e.pageSize.area.height-e.pageSize.verticalMargin}px;\n                    margin-top: ${e.pageSize.verticalMargin}px;\n                }\n                .js-viewer .js-page-area.raw-html-page-area .js-page.page-html-wrapper {\n                    width: ${e.pageSize.page.width}px;\n                    height: ${e.pageSize.page.height}px;\n                    margin-top: ${e.pageSize.verticalMargin}px;\n                }\n            `,i+=`.js-page-area svg {\n            width: ${e.pageSize.page.width}px;\n            height: ${e.pageSize.page.height}px;\n        }`,this.style.innerHTML=i,this.adxWorkaround&&(i+=this.adxWorkaround.generateWorkaroundStyle(e.pageSize.area.width),this.style.innerHTML=i);const r=e.currentPages;Qt(r,this.pageAreas,this.presenter.isRtl?"rtl":"ltr"),this.pageAreas.forEach(((e,t)=>{var i;null===(null===(i=r[t])||void 0===i?void 0:i.screen)?e.classList.add("hide"):e.classList.remove("hide")}))}updateOffset(){this.content&&(this.content.style.right=this.presenter.offset+"px")}updateSlidability(){if(!this.slideBackward||!this.slideForward)return;const e=this.presenter;(0,H.ZN)(this.slideBackward,(e.canSlideBackward||null!==_e.x.data("prevReadableProductUri"))&&e.isSpread),this.slideForward.classList.toggle("slideonly",!e.isSpread),(0,H.ZN)(this.slideForward,e.canSlideForward||null!==_e.x.data("nextReadableProductUri"))}passZoomRatio(){const e=document.documentElement.clientWidth/window.innerWidth;this.presenter.setZoomRatio(e)}startSliding(){z.F.emit("slidestart")}endSliding(){this.updateSliderPosition()}showHeaderNavBar(){var e;null===(e=this.headerView)||void 0===e||e.show()}hideHeaderNavBar(){var e;null===(e=this.headerView)||void 0===e||e.hide()}setSlideToTransitGuideVisibility(e){var t;null===(t=this.slideToTransitGuide)||void 0===t||t.classList.toggle("hide",!e)}onSlideToTransitGuideClick(){this.presenter.setSlideToTransitGuideVisibility(!1)}onResize(){this.presenter.setViewportSize(new te.R(this.viewport.width,this.viewport.height))}onHashchange(e){this.presenter.jumpToPageViaHash()&&e.preventDefault()}onSlideBackwardClick(e){this.presenter.slideBackward(),e.preventDefault()}onSlideForwardClick(e){this.presenter.slideForward(),e.preventDefault()}onKeyUp(){this.presenter.handleKeyUp()}onKeyDown(e){if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return;if(e.defaultPrevented)return;e.target instanceof HTMLElement&&e.target.closest("a, input, textarea, select, button")||(this.presenter.handleKeyDown(e.which),W.X.safari&&W.X.majorVersion<14&&null!=J&&J.isFullscreen&&e.preventDefault())}onTouchStart(e){this.passZoomRatio();const t=e.touches,i=t[0];this.presenter.handleTouchStart(i.screenX,i.screenY,t.length)&&e.preventDefault()}onTouchMove(e){const t=e.touches[0];this.presenter.handleTouchMove(t.screenX,t.screenY)&&e.preventDefault()}onTouchEnd(e){this.presenter.handleTouchEnd()&&e.preventDefault()}displayAdsIfNeededOn(e){const t=e.filter((e=>!this.adLoadedPageIndexKeys[e]&&this.pageAreas[e].querySelectorAll(".js-ad-container").length>0));t.map((e=>this.pageAreas[e])).forEach((e=>{Array.from(e.querySelectorAll(".js-ad-container")).filter((e=>!e.classList.contains("hide"))).forEach(this.displayAd)})),t.forEach((e=>this.adLoadedPageIndexKeys[e]=!0))}async displayAd(e){await(0,ui.d)();const t=e.id;window.valve&&window.valve.push((e=>{e.displayDFPSlot(t)})),this.adxWorkaround&&this.adxWorkaround.pushAd(e)}loadLinkAndBackMatterIfNeeded(e){if(null===e)return;(0,B.w)(-2,3).map((t=>t+e)).map((e=>{const t=[];return["backMatter","link"].forEach((i=>{t.push(...this.presenter.layout.screenToPageIndexesOn(this.presenter.pageStructure,e,i))})),t.length>0?t:null})).flat().forEach((e=>{if(null===e)return;const t=this.pageAreas[e];t&&t.querySelectorAll("img.js-load-image-after-init").forEach((e=>{e.src=e.dataset.src||"",e.classList.remove("js-load-image-after-init")}))}))}onOpenScreen(e){var t;let i=e;this.presenter.layout.isSpread||(i=this.presenter.pageStructure.singleScreenToSpreadScreen(e));const r=this.presenter.pageStructure.screenToPageIndexesOn(i,!0,"main"),n=this.pageAreas;this.pageImageLoader.controlPlayingGifAnimation(r,n),null===(t=this.tableOfContents)||void 0===t||t.activatedAt(this.presenter.layout.isSpread?r:[e]),this.loadLinkAndBackMatterIfNeeded(e);const s=this.presenter.layout.screenToPageIndexes(this.presenter.pageStructure,e);this.buttonsOverlay&&this.buttonsOverlay.createOverlay(s)}sendEventIFNeededOn(e){const t=_e.x.data("typeName");t&&e.forEach((e=>{const i=this.presenter.pageStructure.singlePages[e];if(!i)return;const r=i.contentStart;r&&!this.startEventSentIdKeys[r]&&(oi.T.sendFirstPage(t,r),this.startEventSentIdKeys[r]=!0);const n=i.contentEnd;n&&this.startEventSentIdKeys[n]&&!this.endEventSentIdKeys[n]&&(oi.T.sendLastPage(t,n),z.F.emit("finishReading"),this.endEventSentIdKeys[n]=!0);if("link"===i.type&&!this.linkPageEventSentIndexKeys[e]){const t=this.presenter.pageStructure.singlePages.filter((e=>"link"===e.type&&e.linkPosition===i.linkPosition)).map((e=>e.index)).indexOf(i.index)+1;this.linkPageEventSentIndexKeys[e]=!0,i.linkPosition&&oi.T.sendLinkPage(t,i.linkPosition)}}))}removeHidden(){this.container.querySelectorAll(".page-ad, .js-back-matter, .js-link-page, .js-show-after-load").forEach((e=>e.classList.remove("hidden")))}toggleSlider(e){this.presenter.enableSlider(e)}updateSliderVisibility(){var e,t,i;const r=this.presenter.isSliderEnabled;null===(e=this.viewerSlider)||void 0===e||e.classList.toggle("hidden",!r),null===(t=this.slideForward)||void 0===t||t.classList.toggle("hidden",r),null===(i=this.slideBackward)||void 0===i||i.classList.toggle("hidden",r),this.updateSliderPosition()}updateSliderMaxValue(){var e;const t=this.presenter.currentMaxScreen;null===(e=this.slider)||void 0===e||e.setAttribute("max",t+""),this.sliderMaxValue&&(this.sliderMaxValue.textContent=this.presenter.pageStructure.singleMaxScreen+"")}updateSliderPosition(){this.slider&&(this.slider.value=this.presenter.screen+"",this.updateCurrentScreenNumPosition())}onSliderChange(e){this.presenter.handleSliderEvent(+e.target.value),this.updateCurrentScreenNumPosition()}updateSliderScreenNum(){var e,t;const i=+(null!==(e=null===(t=this.slider)||void 0===t?void 0:t.value)&&void 0!==e?e:0);this.sliderCurrentValue&&(this.sliderCurrentValue.textContent=this.presenter.layout.convertScreenTo(Gt.Single,this.presenter.pageStructure,i)+"")}updateCurrentScreenNumPosition(){var e,t;const i=this.slider;if(!i)return;const r=+(null!==(e=i.getAttribute("min"))&&void 0!==e?e:0),n="rtl"===i.getAttribute("dir");let s,o=(+i.value-r)/(+(null!==(t=i.getAttribute("max"))&&void 0!==t?t:0)-r);if(o<0?o=0:o>1&&(o=1),s=n?1-o:o,this.updateSliderScreenNum(),!this.sliderCurrentValue)return;const a=parseFloat(getComputedStyle(this.sliderCurrentValue).width.replace("px",""))/2,l=22*s,c=parseFloat(getComputedStyle(i).width.replace("px","")),d=hi(i).left+Math.ceil(c*s-a-l);this.sliderCurrentValue.style.left=d+"px"}earnedPoints(e){this.colophonEarnedPointsContainer&&this.colophonEarnedPoints&&((0,H.$Z)(this.colophonEarnedPointsContainer),this.colophonEarnedPoints.textContent=`+${e}pt`)}}var yi=i(7530),wi=i.n(yi);function bi(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class Si{constructor(e){bi(this,"originalImage",void 0),bi(this,"page",void 0),this.originalImage=e.originalImage,this.page=e.page}}class Pi{constructor(e,t,i){var r;bi(this,"pageWidthUpperLimit",void 0),bi(this,"minimumPageWidth",void 0),bi(this,"shouldExpandPagesToViewportOrPageWidthUpperLimit",void 0),this.pageWidthUpperLimit=e,this.minimumPageWidth=t,this.shouldExpandPagesToViewportOrPageWidthUpperLimit=null!==(r=null==i?void 0:i.shouldExpandPagesToViewportOrPageWidthUpperLimit)&&void 0!==r&&r}detectPageWidth(e){return this.shouldExpandPagesToViewportOrPageWidthUpperLimit?Math.min(e.width,this.pageWidthUpperLimit):Math.floor(Math.min(e.width,this.pageWidthUpperLimit,this.minimumPageWidth))}calculatePageSize(e,t){const i=this.detectPageWidth(t),r=Math.round(i*e.originalImage.height/e.originalImage.width);return new Si({originalImage:e.originalImage,page:new te.R(i,r)})}}var Ei=i(8583);function ki(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class Li extends o.q{constructor(e,t){super(e),ki(this,"locator",void 0),ki(this,"viewportDimension",void 0),ki(this,"pageImageLoader",void 0),ki(this,"pageSizes",void 0),ki(this,"screen",void 0),ki(this,"screenOffsets",new Map),ki(this,"pageStructure",void 0),this.viewportDimension=t.viewportDimension,this.pageImageLoader=t.pageImageLoader,this.pageStructure=new Ye.uX(t.pageStructureJson);const i=this.pageStructure.minimumPageWidth;this.locator=new Pi(800,i,t.locatorOptions),this.initializePageSizes()}initializePageSizes(){this.pageSizes=this.generateInitialPageSizes(),this.screenOffsets=this.generateScreenOffsets(this.pageSizes)}generateInitialPageSizes(){const e=[];return this.pageStructure.mainPages.forEach((t=>{e.push(new Si({originalImage:t.dimension,page:new te.R(0,0)}))})),e}generateScreenOffsets(e){const t=new Map;let i=this.view.calculateMainPageOffset();return this.pageStructure.mainPages.forEach(((r,n)=>{r.screen&&t.set(r.screen,i);const s=e[n];i+=s.page.height>0?s.page.height:s.originalImage.height})),t}setup(){this.changePageSizes(),this.view.removeHidden(),this.view.buildButtonsOverlay(this.pageStructure),window.setTimeout((()=>{this.preloadAdFrom(1)}),0),this.sendEventFrom(1),this.pageImageLoader.loadImagePageAt((0,B.w)(0,this.pageStructure.maxPage-1)),"complete"===document.readyState?this.scrollToPageViaHash():document.addEventListener("readystatechange",(()=>{"complete"===document.readyState&&this.scrollToPageViaHash()})),W.X.mobile||W.X.tablet||this.view.disableScrollNavButton(),W.X.ios&&W.X.safari&&W.X.majorVersion>=13&&this.view.disableScrollNavButton()}scrollTopOfPage(e){var t;const i=(null===(t=this.pageStructure.mainPages[e-1])||void 0===t?void 0:t.screen)||0;return this.screenOffsets.get(i)||0}scrollToPageViaHash(){const e=ai();if(!e)return!1;history.replaceState("",document.title,location.pathname+location.search);const t=this.scrollTopOfPage(e);return this.view.scrollTo(t),!0}get pageHashToLink(){return`#page-${this.screen}`}changePageSizes(){this.pageSizes=this.pageSizes.map((e=>this.locator.calculatePageSize(e,this.viewportDimension))),this.screenOffsets=this.generateScreenOffsets(this.pageSizes),this.view.updateSize()}setViewportSize(e){const t=e.width!==this.viewportDimension.width;this.viewportDimension=e,t&&this.changePageSizes()}scrollHandler(e){this.setScreen(e),this.updateNavigatorVisibility()}setScreen(e){let t=1;for(const[i,r]of this.screenOffsets.entries()){if(e<r)break;t=i}this.screen=t,this.preloadAdFrom(this.screen),this.sendEventFrom(this.screen)}updateNavigatorVisibility(){const e=this.screen===this.pageStructure.singleMaxScreen;this.view.updateNavigatorVisibility({hiddenForwardNavigator:e})}preloadAdFrom(e){const t=[0,1,2,3,4,5,6,7,-1].flatMap((t=>this.pageStructure.screenToPageIndexesOn(e+t,!1,"other")));this.view.displayAdsIfNeededOn(t)}sendEventFrom(e){this.view.sendEventIFNeededOn(this.pageStructure.screenToPageIndexes(e,!1)),this.view.onOpenScreen(e)}scrollToForward(e){const t=e+this.viewportDimension.height,i=t-50,r=i+this.viewportDimension.height;for(let n=0;n<this.pageStructure.singleMaxScreen;n++){const e=this.pageStructure.singlePageAt(Math.min(this.pageStructure.singleMaxScreen,this.screen+n));if(!e)continue;const i=this.scrollTopOfPage(e.index+1);if(t<i&&r>i)return i-this.viewportDimension.height}return i}}class ji extends o.G{constructor(e){super(e)}initMembers({container:e,viewport:t,pageImageLoader:i,tableOfContents:r,locatorOptions:n}){this.container=e,this.pageAreas=Array.from(e.querySelectorAll(".js-page-area")),this.pages=Array.from(e.querySelectorAll(".js-page")),this.frontLinkPageImages=Array.from(document.querySelectorAll(".js-front-link-page img")),this.backMatter=e.querySelector(".js-back-matter"),this.viewerContent=document.querySelector("#content"),this.style=document.createElement("style"),document.head.appendChild(this.style),this.forward=e.querySelector(".page-navigation-forward"),this.colophonEarnedPointsContainer=e.querySelector(".js-colophon-earned-points-container"),this.colophonEarnedPoints=e.querySelector(".js-colophon-earned-points"),this.viewport=t,this.pageImageLoader=i,this.tableOfContents=r,this.disableScrollButton=!1,this.adLoadedPageIndexKeys={},this.startEventSentIdKeys={},this.endEventSentIdKeys={},this.linkPageEventSentIndexKeys={},this.controller=Ae,this.controllerElement=document.querySelector(".js-viewer-controller"),this.locatorOptions=n,Ae.setMode("default"),this.onSizeUpdateNeeded=this.onSizeUpdateNeeded.bind(this),this.scrollToForward=this.scrollToForward.bind(this),this.updateNavigatorVisibilityHidden=this.updateNavigatorVisibilityHidden.bind(this),this.updateNavigatorVisibilityShow=this.updateNavigatorVisibilityShow.bind(this),this.onHashchange=this.onHashchange.bind(this),this.onResize=this.onResize.bind(this),this.onScroll=this.onScroll.bind(this),this.earnedPoints=this.earnedPoints.bind(this)}calculateMainPageOffset(){var e;return(null===(e=document.querySelector(".js-viewer-content > p.js-page-area:first-of-type"))||void 0===e?void 0:e.offsetTop)||0}onSizeUpdateNeeded(){this.presenter.changePageSizes()}registerEvents(){var e,t,i,r;this.viewport.onResize(this.onResize);const n=wi()(this.onScroll,500,{trailing:!0,leading:!0});null===(e=this.viewerContent)||void 0===e||e.addEventListener("scroll",n),this.frontLinkPageImages.forEach((e=>{e.src&&e.complete||e.addEventListener("load",this.onSizeUpdateNeeded)})),window.addEventListener("load",this.onSizeUpdateNeeded);const s=()=>{this.controller.setMode("default")},o=e=>e.preventDefault();this.container.addEventListener("click",s),this.container.addEventListener("contextmenu",o),null===(t=this.forward)||void 0===t||t.addEventListener("click",this.scrollToForward),null===(i=this.forward)||void 0===i||i.addEventListener("touchstart",this.updateNavigatorVisibilityHidden),null===(r=this.forward)||void 0===r||r.addEventListener("touchend",this.updateNavigatorVisibilityShow),window.addEventListener("hashchange",this.onHashchange),_.F.addOnLeaveListener((()=>{var e,t,i,r;this.viewport.offResize(),null===(e=this.viewerContent)||void 0===e||e.removeEventListener("scroll",n),this.container.removeEventListener("click",s),this.container.removeEventListener("contextmenu",o),null===(t=this.forward)||void 0===t||t.removeEventListener("click",this.scrollToForward),null===(i=this.forward)||void 0===i||i.removeEventListener("touchstart",this.updateNavigatorVisibilityHidden),null===(r=this.forward)||void 0===r||r.removeEventListener("touchend",this.updateNavigatorVisibilityShow),window.removeEventListener("hashchange",this.onHashchange),window.removeEventListener("load",this.onSizeUpdateNeeded),this.style.remove()})),z.F.on("earnedPoints",this.earnedPoints)}disableScrollNavButton(){this.disableScrollButton=!0,this.updateNavigatorVisibility({hiddenForwardNavigator:!0})}scrollToForward(){if(!this.viewerContent)return;const e=this.viewerContent.scrollTop,t=this.presenter.scrollToForward(e);void 0!==t&&this.scrollTo(t,!0)}updateNavigatorVisibilityHidden(){this.updateNavigatorVisibility({hiddenForwardNavigator:!0})}updateNavigatorVisibilityShow(){this.updateNavigatorVisibility({hiddenForwardNavigator:!1})}updateNavigatorVisibility(e){var t;null===(t=this.forward)||void 0===t||t.classList.toggle("hidden",this.disableScrollButton||e.hiddenForwardNavigator)}createPresenter(){const e=_e.x.data("pageStructure");return new Li(this,{viewportDimension:new te.R(this.viewport.width,this.viewport.height),pageImageLoader:this.pageImageLoader,pageStructureJson:e,locatorOptions:this.locatorOptions})}updateSize(){const e=this.presenter.pageSizes;if(0===e.length)return;let t="";e.forEach(((e,i)=>{t+=`\n                .js-viewer-content p:nth-of-type(${i+1}) > .js-page-image {\n                    width: ${e.page.width}px;\n                    height: ${e.page.height}px;\n                }\n            `})),this.style.innerHTML=t;const i=e[0].page.width;this.backMatter&&(this.backMatter.style.width=i+"px"),this.pages.forEach((e=>{e.style.width=i+"px"}))}onHashchange(e){this.presenter.scrollToPageViaHash()&&e.preventDefault()}startSliding(){z.F.emit("slidestart")}endSliding(){}onResize(){(0,Ei.p)(this.container)&&(this.presenter.setViewportSize(new te.R(this.viewport.width,this.viewport.height)),this.onSizeUpdateNeeded())}onScroll(e){this.presenter.scrollHandler(e.target.scrollTop)}displayAdsIfNeededOn(e){const t=e.filter((e=>!this.adLoadedPageIndexKeys[e]&&this.pageAreas[e].querySelectorAll(".js-ad-container").length>0));t.map((e=>this.pageAreas[e])).forEach((e=>{e.querySelectorAll(".js-ad-container").forEach(this.displayAd)})),t.forEach((e=>this.adLoadedPageIndexKeys[e]=!0))}async displayAd(e){await(0,ui.d)();const t=e.id;window.valve&&window.valve.push((e=>{e.displayDFPSlot(t)}))}onOpenScreen(e){var t;null===(t=this.tableOfContents)||void 0===t||t.activatedAt([e]),this.buttonsOverlay.createOverlay([e])}sendEventIFNeededOn(e){const t=_e.x.data("typeName");t&&e.forEach((e=>{const i=this.presenter.pageStructure.singlePages[e];if(!i)return;const r=i.contentStart;r&&!this.startEventSentIdKeys[r]&&(oi.T.sendFirstPage(t,r),this.startEventSentIdKeys[r]=!0);const n=i.contentEnd;n&&this.startEventSentIdKeys[n]&&!this.endEventSentIdKeys[n]&&(oi.T.sendLastPage(t,n),z.F.emit("finishReading"),this.endEventSentIdKeys[n]=!0);if("link"===i.type&&!this.linkPageEventSentIndexKeys[e]){const t=this.presenter.pageStructure.singlePages.filter((e=>"link"===e.type&&e.linkPosition===i.linkPosition)).map((e=>e.index)).indexOf(i.index)+1;this.linkPageEventSentIndexKeys[e]=!0,i.linkPosition&&oi.T.sendLinkPage(t,i.linkPosition)}}))}removeHidden(){this.container.querySelectorAll(".page-ad,.js-back-matter,.js-link-page,.js-show-after-load").forEach((e=>e.classList.remove("hidden"))),document.querySelectorAll("img.js-load-image-after-init").forEach((e=>{e.src=e.dataset.src||"",e.classList.remove("js-load-image-after-init")}))}scrollTo(e,t){this.viewerContent&&(t?$(this.viewerContent,{scrollTop:e},{duration:170,easing:"easeOutCubic"}):this.viewerContent.scrollTop=e)}buildButtonsOverlay(e){this.buttonsOverlay=new ci(this.container,this.pageAreas,e)}earnedPoints(e){this.colophonEarnedPointsContainer&&this.colophonEarnedPoints&&((0,H.$Z)(this.colophonEarnedPointsContainer),this.colophonEarnedPoints.textContent=`+${e}pt`)}}let xi=function(e){return e.BackMatter="backMatter",e.HTML="html",e.Link="link",e.Main="main",e.Other="other",e}({});function Ci(e){return{arrayItems:e}}function Ti(...e){return{unionMembers:e}}function Ai(e,t){return{props:e,additional:t}}function Oi(e){return{ref:e}}Ai([{json:"choJuGiga",js:"choJuGiga",typ:Ti(void 0,Oi("ChoJuGiga"))},{json:"pages",js:"pages",typ:Ci(Oi("Page"))},{json:"readingDirection",js:"readingDirection",typ:Oi("ReadingDirection")},{json:"startPosition",js:"startPosition",typ:Ti(void 0,Oi("StartPosition"))}],!1),Ai([{json:"align",js:"align",typ:Ti(void 0,Oi("Align"))},{json:"buttons",js:"buttons",typ:Ti(void 0,Ci(Oi("Button")))},{json:"content",js:"content",typ:Ti(void 0,"")},{json:"contentEnd",js:"contentEnd",typ:Ti(void 0,"")},{json:"contentStart",js:"contentStart",typ:Ti(void 0,"")},{json:"height",js:"height",typ:Ti(void 0,0)},{json:"hide",js:"hide",typ:Ti(void 0,Oi("Hide"))},{json:"isGif",js:"isGif",typ:Ti(void 0,!0)},{json:"link",js:"link",typ:Ti(void 0,Oi("Link"))},{json:"linkPosition",js:"linkPosition",typ:Ti(void 0,Oi("LinkPosition"))},{json:"src",js:"src",typ:Ti(void 0,"")},{json:"tweetIds",js:"tweetIds",typ:Ti(void 0,Ci(""))},{json:"type",js:"type",typ:Oi("PageType")},{json:"width",js:"width",typ:Ti(void 0,0)}],"any"),Ai([{json:"type",js:"type",typ:Oi("ButtonType")},{json:"uri",js:"uri",typ:""}],!1),Ai([{json:"items",js:"items",typ:Ci(Oi("Item"))},{json:"viewBox",js:"viewBox",typ:""}],"any"),Ai([{json:"height",js:"height",typ:3.14},{json:"linkTo",js:"linkTo",typ:""},{json:"width",js:"width",typ:3.14},{json:"x",js:"x",typ:3.14},{json:"y",js:"y",typ:3.14}],"any");var Ii=i(5705);function Mi(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function Bi(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Mi(Object(i),!0).forEach((function(t){Ni(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Mi(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Ni(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class Di{constructor(e){Ni(this,"storage",void 0),Ni(this,"tweetPageElements",void 0),Ni(this,"tweetId",null),this.storage=new Fi,this.tweetPageElements=e}updatePageStructure(e){this.tweetId=this.determineTweetToShow(e);const t=this.tweetId?e.pages:e.pages.filter((e=>!(e.type===xi.Other&&e.tweetIds)));return this.tweetId||this.removeTrendingTweetPagesFromHTML(),Bi(Bi({},e),{},{pages:t})}determineTweetToShow(e){var t;const i=e.pages.find((e=>e.type===xi.Other&&e.tweetIds));if(!i)return null;const r=null!==(t=i.tweetIds)&&void 0!==t?t:[],n=this.storage.loadAlreadySeenTweetIds(),s=new Map(n.map((e=>[e,!0]))),o=r.filter((e=>!s.has(e)));return 0===o.length?null:(0,Ii.sD)(o)}async setupTrendingTweetPage(){this.tweetId&&await this.embedTweet()}async embedTweet(){if(0===this.tweetPageElements.length||null===this.tweetId)return;await(0,it.cP)();const e=this.tweetPageElements[0].querySelector(".tweet");if(e&&(window.twttr.widgets.createTweet(this.tweetId,e,{lang:"ja",conversation:"none"}),this.storage.addAlreadySeenTweetId(this.tweetId),window.ga)){window.ga("send",{hitType:"event",eventCategory:"trending_tweet",eventAction:"show",eventLabel:this.tweetId});const e=()=>{const e=document.activeElement;null!=e&&e.closest(".tweet")&&window.ga("send",{hitType:"event",eventCategory:"trending_tweet",eventAction:"click",eventLabel:this.tweetId})};window.addEventListener("blur",e),_.F.addOnLeaveListener((()=>{window.removeEventListener("blur",e)}))}}removeTrendingTweetPagesFromHTML(){for(const t of this.tweetPageElements){var e;null===(e=t.closest(".js-page-area"))||void 0===e||e.remove()}}}const qi="already_seen_trending_tweet_ids";class Fi{constructor(){Ni(this,"localStorage",void 0),this.localStorage=ce.K}addAlreadySeenTweetId(e){try{const t=[...this.loadAlreadySeenTweetIds(),e].slice(-100);this.localStorage.setItem(qi,JSON.stringify(t))}catch(t){}}loadAlreadySeenTweetIds(){try{const e=this.localStorage.getItem(qi);return null===e?[]:JSON.parse(e)}catch(e){return[]}}}var _i=i(3736);const zi=async()=>{const e=document.querySelector(".js-viewer-bottom-recommend");if(!e)return;const t=e.dataset.viewerBottomRecommendEndpoint;if(void 0===t)return;const i=await ve.N.get(t);if(!i.ok)return;const r=(await i.json()).html;e.innerHTML=r};function Ri(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function Ui(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Ri(Object(i),!0).forEach((function(t){$i(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Ri(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function $i(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Hi=e=>{var t;const i=document.getElementById("episode-json"),r=JSON.parse(null!==(t=null==i?void 0:i.dataset.value)&&void 0!==t?t:"{}");if(r.readableProduct)for(const[n,s]of Object.entries(r.readableProduct))_e.x.update(n,s)},Vi=e=>{const t=_e.x.data("pageStructure");if(!t)return void(0,p.T)(new Error("pageStructure is not found"));const i=new Ye.uX(t),r=i.isHorizontal,n=i.hasButtonsOfType("tshirt"),s=i.hasButtonsOfType("kirinuki");((e=document)=>{const t=_e.x.data("pageStructure");if(!t)return;const i=new Ye.uX(t),r=e.querySelector(".js-viewer-content");if(!r)return;const n=document.createElement("style");if(n.textContent="\n    .scroll-horizontal .page-area {\n        display: inline-block;\n        vertical-align: top;\n        position: relative;\n    }\n    .scroll-horizontal .align-left {\n        text-align: left;\n    }\n    .scroll-horizontal .align-right {\n        text-align: right;\n    }\n    .scroll-horizontal .align-center {\n        text-align: center;\n    }\n    .scroll-horizontal {\n        position: relative;\n        overflow: hidden;\n        contain: paint;\n    }\n    .content-inner.scroll-horizontal .image-container {\n        height: 100%;\n        white-space: nowrap;\n        position: absolute;\n        top: 0;\n        right: 0;\n    }\n\n    .scroll-vertical .page-area {\n            text-align: center;\n            line-height: 0;\n            position: relative;\n    }\n    .scroll-vertical .page-area img {\n        vertical-align: middle;\n    }\n    .content-vertical {\n        overflow-x: hidden;\n        overflow-y: scroll;\n    }\n\n    #content {\n        -webkit-overflow-scrolling: touch;\n    }\n\n    .viewer,\n    #content,\n    .content-inner.scroll-horizontal,\n    .image-container {\n        transition: height 200ms 0s ease-out, width 200ms 0s ease-out;\n    }\n\n    #content {\n        height: 100%;\n    }\n\n\n    .page-dummy {\n        display: inline-block;\n        background-color: #fff;\n    }\n    ",(e instanceof Document?e.head:e).appendChild(n),"flyleaf"===i.spreadPages[0].type){const e=(0,rt.tZ)("div",{className:"page-area js-page-area",dir:"ltr",children:(0,rt.tZ)("div",{class:"page-dummy js-page"})});r.prepend(e)}const s=i.mainPages,o=document.createDocumentFragment();let a=null;s.forEach((e=>{const t=document.createElement("p");t.classList.add("page-area","js-page-area"),t.dir="ltr","number"!=typeof a&&(a=e.index),o.appendChild(t)})),"number"==typeof a&&r.insertBefore(o,r.childNodes[a]),i.rawHtmlPages.forEach((e=>{const t=document.createElement("div");t.classList.add("page-area","js-page-area","raw-html-page-area"),t.dir="ltr";const i=document.createElement("div");i.classList.add("js-page","page-html-wrapper"),i.innerHTML=e.content,t.appendChild(i);const n=r.childNodes[e.screen];n?r.insertBefore(t,n):r.appendChild(t)}))})(),(e=>{const t=document.querySelector(".js-viewer-controller");t&&t.remove();const{isHorizontal:i,hasTshirts:r,hasKirinuki:n}=e,s=document.querySelector(".js-viewer");if(!s)return;const o=_e.x.data("toc");(0,ze.OJ)();const a=_e.x.data("nextReadableProductUri"),l=_e.x.data("prevReadableProductUri"),c=_e.x.data("pageStructure");if(!c)return;const d=new Ye.uX(c),h={episode:"話",volume:"巻",magazine:"号"}[_e.x.data("typeName")||"episode"],u=d.readingDirection,p=X(),g={normal:{text:"通常"},expand:{text:"拡大"},fullscreen:{text:"全画面",tooltip:p?`全画面 (${p})`:void 0},kirinuki:{text:"",tooltip:"切り抜きツイート"},tshirt:{text:"作る"},"table-of-contents":{text:"目次"},slider:{text:"移動"}},m=e=>{if("table-of-contents"===e&&!o)return null;const t="fullscreen"===e?"viewer-btn-fullscreen js-viewer-btn-start-fullscreen js-hidden-on-disabled-fullscreen":`viewer-btn-${e} js-viewer-btn-${e}`,i=g[e];return(0,rt.tZ)("li",{className:`viewer-btn-${e}-container js-viewer-btn-${e}-container`,children:(0,rt.tZ)("span",{className:t,title:i.tooltip,children:i.text})})},v=[n&&"kirinuki",r&&"tshirt","table-of-contents","slider"].filter(Boolean),f=(0,rt.BX)("div",{className:"viewer-controller js-viewer-controller controller-"+(i?"horizontal":"vertical"),children:[(0,rt.tZ)("ul",{className:"viewer-controller-container",children:["normal","expand","fullscreen"].map(m)}),(0,rt.tZ)("ul",{className:"viewer-controller-right-box",children:v.map(m)}),o&&(0,rt.tZ)("div",{className:"viewer-table-of-contents-button-container js-viewer-table-of-contents-button-container hidden",children:(0,rt.tZ)("span",{className:"viewer-table-of-contents-button-close js-viewer-table-of-contents-button-close",children:"目次を閉じる"})}),i&&(0,rt.tZ)("div",{className:"viewer-slider js-viewer-slider hidden",children:(0,rt.tZ)("div",{className:"viewer-slider-container",children:(0,rt.BX)("div",{className:"viewer-slider-inner",children:[(0,rt.tZ)("span",{className:`viewer-slider-next ${u}`,children:a?(0,rt.BX)("a",{href:a,children:["次の",h]}):`次の${h}`}),(0,rt.tZ)("span",{className:`viewer-slider-prev ${u}`,children:l?(0,rt.BX)("a",{href:l,children:["前の",h]}):`前の${h}`}),(0,rt.tZ)("span",{className:"viewer-slider-pagenum"}),(0,rt.tZ)("span",{className:`viewer-slider-pagenum-last ${u} js-viewer-slider-pagenum-last`}),(0,rt.tZ)("span",{className:"viewer-slider-pagenum-now js-viewer-slider-pagenum-now",children:"12"}),(0,rt.tZ)("input",{class:"slider js-slider",type:"range",name:"",value:"",max:"1",min:"1",step:"1",dir:u})]})})}),n&&(0,rt.tZ)("div",{className:"kirinuki-controller js-kirinuki-controller hidden",children:(0,rt.BX)("ul",{children:[(0,rt.tZ)("li",{children:(0,rt.tZ)("a",{className:"viewer-btn-kirinuki-about",href:"https://kirinuki.shonenjumpplus.com/howto/",target:"_blank",rel:"noopener noreferrer",children:"切り抜きツイートについて"})}),(0,rt.tZ)("li",{className:"kirinuki-close js-kirinuki-close",children:(0,rt.tZ)("span",{className:"viewer-btn-kirinuki-close",children:"キャンセル"})})]})}),r&&(0,rt.tZ)("div",{className:"tshirt-controller js-tshirt-controller hidden",children:(0,rt.BX)("ul",{children:[(0,rt.tZ)("li",{children:(0,rt.tZ)("a",{className:"viewer-btn-tshirt-about",href:"https://shonenjumpplus.com/article/t-shirt",target:"_blank",rel:"noopener noreferrer",children:"Tシャツについて"})}),(0,rt.tZ)("li",{className:"tshirt-close js-tshirt-close",children:(0,rt.tZ)("span",{className:"viewer-btn-tshirt-close",children:"キャンセル"})})]})})]});s.parentElement.insertBefore(f,s.nextSibling)})({isHorizontal:r,hasTshirts:n,hasKirinuki:s});const o=document.querySelector(".js-header"),a=new le(o);a.hide();const l=document.querySelector(".js-direction-guide");let c;l&&new G(l);const d=_e.x.data("toc");if(d){const e=new(F()),t=new Le(d,location.href);c=new Me({tableOfContentsRepository:new Be(t,e),eventEmitter:e})}const h=document.querySelector(".js-viewer-content");if(!h)return;const u=new Pe(h,i.spreadPages),g=new re(e),m=document.querySelector(".js-viewer-controller");if(r){const e=ce.K,t=new jt(e,location.pathname),i=document.querySelector(".js-horizontal-viewer");if(!i)return void(0,p.T)(new Error(".js-horizontal-viewer is not found"));new fi({container:i,controller:m,viewport:g,pageImageLoader:u,tableOfContents:c,headerView:a,automaticBookmarker:t})}else{const e=document.querySelector(".js-vertical-viewer");if(!e)return void(0,p.T)(new Error(".js-vertical-viewer is not found"));new ji({container:e,viewport:g,pageImageLoader:u,tableOfContents:c})}new ee({container:document.body,onEnterFullScreen:()=>{},viewer:e}),_.F.isEnabled&&Array.from(document.querySelectorAll("a")).filter((e=>e.pathname!==location.pathname&&"_blank"!==e.target)).forEach(je.xl),m&&new ue(m,!r);const v=document.querySelector(".js-viewer-controller");n&&v&&new tt(Ae,document.querySelector(".js-tshirt-controller"),document.querySelector(".js-viewer-btn-tshirt-container"),document.querySelector(".tshirt-close"),"tshirt"),s&&v&&new tt(Ae,document.querySelector(".js-kirinuki-controller"),document.querySelector(".js-viewer-btn-kirinuki-container"),document.querySelector(".kirinuki-close"),"kirinuki")};function Zi(){const e=document.querySelector("section.js-viewer");if(!e)return void(0,p.T)(new Error(".js-viewer is not found"));const t=Array.from(document.querySelectorAll(".page-tweet")),i=new Di(t);Hi(e);const r=_e.x.data("pageStructure");r&&_e.x.update("pageStructure",i.updatePageStructure(r)),e&&!e.classList.contains("private-viewer")&&Vi(e),new Qe.r,new st.G,nt().then((()=>{(0,it.Nu)(),new Ne.m(document.querySelectorAll(".js-readable-product-list-tab"),document.querySelector(".js-readable-product-list-tab.selected"),"selected"),$e(),zi();const e=document.querySelector(".js-readable-product-list");e&&new Ge({container:e});const t=document.querySelector(".js-episode-readable-product-list");t&&new Ge({container:t});const r=document.querySelector(".js-volume-readable-product-list");r&&new Ge({container:r});const n=document.querySelector(".js-series-comment-read-more-button"),s=document.querySelector(".js-series-comment-list");let o;if(n&&s){o=new pe.d5({readMoreButton:n,readContainer:s});(async()=>{s&&(await(0,qe.i)(s),o.presenter.requestMoreHtml())})()}const a=document.querySelector(".js-series-comment-count"),l=null==a?void 0:a.dataset.seriesCommentCountEndpoint;l&&ve.N.get(l).then((e=>e.json())).then((e=>{a.textContent=e.count.toString(),e.count||(0,H.$Z)(document.querySelectorAll(".js-series-comment-contents-none"))})),new ge.U(document,".scroll-position");const c=document.querySelector('form[name="comment"]'),d=document.querySelector(".js-series-comment-contents-done"),h=document.querySelector(".js-series-comment-contents-form-error-notes"),u=_e.x.data("series"),p=u?u.id:null;if(d&&c&&h&&p){var g;const e=_e.x.data("typeName"),t=document.querySelector("#episode-comment")&&"episode"===e,i=_e.x.data("id");new zt(c,d,h,p,i&&t?i:void 0),null===(g=o)||void 0===g||g.presenter.eventEmitter.on("commentLoaded",(()=>{Array.from(document.querySelectorAll(".js-series-report-comment-container")).slice(-6).map((e=>{const t=e.querySelector(".js-series-report-comment-form"),i=e.querySelector(".js-series-report-comment-contents-done"),r=e.querySelector(".js-comment-likes-button"),n=e.dataset.seriesCommentId;if(!(t&&i&&r&&n))return;const s=new gt({likeButton:r});Et(n)||s.hide();new Rt(t,i,[r],n)}))}))}const m=document.querySelector(".js-comment-button"),v=document.querySelector(".js-comment-textarea");m&&v&&Ht(m,v,1,500);const f=document.querySelector("button.js-embed-button"),y=document.querySelector(".js-embed-code");f&&y&&new Tt(f,y);const w=document.querySelector(".js-series-likes-per-period-container"),b=document.querySelector('form[name="series-likes-per-period"]');w&&b&&p&&new Ut(w,b,p);const S=document.querySelector(".js-episode-like-button");S&&new bt({likeButton:S}),i.setupTrendingTweetPage();const P=document.querySelector(".series-header-author"),E=(0,_i.U_)()||"";["comicdays"].includes(E)&&P&&P.childNodes.length>0&&P.replaceChild(Xe(P),P.childNodes[0]);const k=document.querySelector(".series-information");k&&(0,qe.i)(k).then((()=>{const e=Array.from(document.querySelectorAll(".x-giga-twitter-timeline"));e.forEach((e=>{e.classList.remove("x-giga-twitter-timeline"),e.classList.add("twitter-timeline")}));const t=window.setInterval((()=>{const i=window.twttr;if(null!=i&&i.widgets){window.clearInterval(t);for(const t of e)i.widgets.load(t)}}),500);if(document.body.dataset.bookmarkBlogpartsUri){const e="https://b.hatena.ne.jp/js/bookmark_blogparts.js",t=document.createElement("script");t.onload=()=>{const e=window.setInterval((()=>{window.HBBlogParts&&(window.clearInterval(e),window.HBBlogParts.commentInsertSelector=[".series-bookmark-comments-target"],window.HBBlogParts.permalinkSelector=["body"],window.HBBlogParts.permalinkAttribute="data-bookmark-blogparts-uri",window.HBBlogParts.permalinkPathRegexp=/\/episode\/\d+/,window.HBBlogParts.insertPosition="after",window.HBBlogParts.useUserCSS=!0)}),50)},t.src=e,document.body.appendChild(t)}})),lt(),Gi()}))}const Gi=()=>{const e=(0,ze.LM)();if(!e)return;document.querySelectorAll(".js-add-query-parameter-from-to-uri").forEach((t=>{(0,ze.ox)(e,t)}))};var Ki=i(81);function Ji(){(0,O.Q)(),(0,r.A)(),C(),new Ki.HU(s()(".js-show-past-magazines"),s()(".js-past-magazine"),void 0,!1);(new I.D).save({visitedAt:Date.now()})}function Wi(){C()}var Xi=i(2936),Qi=i(6696),Yi=i(2143);var er=i(6103),tr=i(1162),ir=i(8928);function rr(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class nr{constructor(e,t){rr(this,"rentButton",void 0),rr(this,"endpoint",void 0),rr(this,"returnLocationPath",void 0),rr(this,"enable",void 0),rr(this,"rent",(()=>{if(!this.enable)return;this.rentButton.setAttribute("disabled","disabled"),this.enable=!1;const e=new FormData;e.append("return_location_path",this.returnLocationPath),ve.N.post(this.endpoint,{body:e}).then((e=>e.json())).then((e=>{e.return_location_path&&(window.location.href=e.return_location_path)})).catch((e=>{window.alert(e.message),this.enable=!0}))})),this.rentButton=e,this.returnLocationPath=t,this.endpoint=this.rentButton.dataset.rentEndpoint,this.enable=!0,this.registerEvents()}registerEvents(){this.rentButton.addEventListener("click",this.rent)}}var sr=i(2538);function or(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class ar extends o.q{constructor(e){super(e),or(this,"currentReadableProductId",void 0),or(this,"currentNumber",void 0);if(!document.querySelector(".js-viewer"))return;const t=_e.x.data("id");if(null===t)throw new Error("currentReadableProductId is not defined");this.currentReadableProductId=t;const i=_e.x.data("number");if(null===i)throw new Error("number is not defined");this.currentNumber=i}async retrieveEpisodeList(){const e=new URLSearchParams({current_readable_product_id:this.currentReadableProductId+"",number_since:this.currentNumber+"",read_more_num:"10"}).toString(),t=await ve.N.get("/api/viewer/modal/episodes?"+e),i=await t.json();this.view.reloadEpisodeList(i)}async refreshEpisodeListWithUrl(e){const t=await ve.N.get(e);this.view.reloadEpisodeList(await t.json())}calculateCheckedItemsPoint(e){let t=0;Array.from(e).forEach((e=>{const i=e.parentElement;if(!i)return;const r=i.querySelector(".js-point-needed");if(!r)return;const n=Number(r.textContent);t+=n})),this.view.reloadPoints(e.length,t)}}class lr extends o.G{constructor(e){super(e)}createPresenter(){return new ar(this)}initMembers({purchaseButton:e,purchaseListDiv:t,currentPoint:i}){this.purchaseButton=e,this.purchaseListDiv=t,this.currentPoint=Object.assign({},i),this.presenter=this.createPresenter(),this.initViewOnAppear(),this.deselectAllButton=document.querySelector(".js-bulk-purchase-deselect-all"),this.selectAllButton=document.querySelector(".js-bulk-purchase-select-all"),this.bulkPurchaseButton=document.querySelector(".js-bulk-purchase-button"),this.purchasePointButton=document.querySelector(".js-purchase-point-button"),this.currentPointSpan=document.querySelector(".js-bulk-purchase-point"),this.totalPointSpan=document.querySelector(".js-total-point"),this.selectedEpisodeCountSpan=document.querySelector(".js-selected-episode-count"),this.shortageMessageDiv=document.querySelector(".js-bulk-purchase-shortage-message"),this.insufficientPointRawElements=document.querySelectorAll(".js-bulk-purchase-insufficient-point-raw"),this.purchaseNextButton=document.querySelector(".js-purchase-next-button"),this.purchasePreviousButton=document.querySelector(".js-purchase-previous-button"),this.currentPointSpan&&(this.currentPointSpan.textContent=i.total+"pt"),this.selectedEpisodeCountSpan&&(this.selectedEpisodeCountSpan.textContent="0"),this.totalPointSpan&&(this.totalPointSpan.textContent="0")}async initViewOnAppear(){await(0,qe.i)(this.purchaseListDiv),this.presenter.retrieveEpisodeList(),this.reloadPoints(0,0),this.registerEpisodeListEvents()}reloadCheckboxesAndRegisterEvents(){this.checkboxes=Array.from(document.querySelectorAll(".bulk-purchase-list input[type=checkbox]:enabled")),Array.from(this.checkboxes).forEach((e=>{e.addEventListener("change",(()=>{const e=Array.from(document.querySelectorAll(".bulk-purchase-list input[type=checkbox]:checked"));this.presenter.calculateCheckedItemsPoint(e)}))}))}registerEpisodeListEvents(){this.reloadCheckboxesAndRegisterEvents(),this.deselectAllButton&&this.deselectAllButton.addEventListener("click",(()=>{Array.from(this.checkboxes).forEach((e=>{e.checked=!1}));const e=Array.from(document.querySelectorAll(".bulk-purchase-list input[type=checkbox]:checked"));this.presenter.calculateCheckedItemsPoint(e)})),this.selectAllButton&&this.selectAllButton.addEventListener("click",(()=>this.allCheck())),this.purchaseNextButton&&this.purchaseNextButton.addEventListener("click",(()=>{if(Array.from(document.querySelectorAll(".bulk-purchase-list input[type=checkbox]:checked")).length>0)return void alert("チェック済みの話があります。次の10話を表示するにはチェックを外してください。");const e=this.purchaseNextButton.dataset.nextEpisodesListEndpoint;e&&this.presenter.refreshEpisodeListWithUrl(e)})),this.purchasePreviousButton&&this.purchasePreviousButton.addEventListener("click",(()=>{if(Array.from(document.querySelectorAll(".bulk-purchase-list input[type=checkbox]:checked")).length>0)return void alert("チェック済みの話があります。前の10話を表示するにはチェックを外してください。");const e=this.purchasePreviousButton.dataset.previousEpisodesListEndpoint;e&&this.presenter.refreshEpisodeListWithUrl(e)}))}reloadEpisodeList(e){this.purchaseListDiv.innerHTML=e.html,this.purchaseNextButton&&(e.nextUrl?(this.purchaseNextButton.disabled=!1,this.purchaseNextButton.dataset.nextEpisodesListEndpoint=e.nextUrl):(this.purchaseNextButton.disabled=!0,this.purchaseNextButton.dataset.nextEpisodesListEndpoint="")),this.purchasePreviousButton&&(e.previousUrl?(this.purchasePreviousButton.disabled=!1,this.purchasePreviousButton.dataset.previousEpisodesListEndpoint=e.previousUrl):(this.purchasePreviousButton.disabled=!0,this.purchasePreviousButton.dataset.previousEpisodesListEndpoint="")),this.reloadCheckboxesAndRegisterEvents(),e.allChecked&&this.allCheck()}allCheck(){Array.from(this.checkboxes).forEach((e=>{e.checked=!0}));const e=Array.from(document.querySelectorAll(".bulk-purchase-list input[type=checkbox]:checked"));this.presenter.calculateCheckedItemsPoint(e)}reloadPoints(e,t){if(!(this.selectedEpisodeCountSpan&&this.totalPointSpan&&this.currentPointSpan&&this.shortageMessageDiv&&this.bulkPurchaseButton&&this.purchasePointButton))return;this.selectedEpisodeCountSpan.textContent=String(e),this.totalPointSpan.textContent=String(t),this.bulkPurchaseButton.disabled=0===e;const i=t-this.currentPoint.total;i>0?(this.currentPointSpan.classList.add("shortage"),this.shortageMessageDiv.style.display="block",this.bulkPurchaseButton.style.display="none",this.purchasePointButton.style.display="block"):(this.currentPointSpan.classList.remove("shortage"),this.shortageMessageDiv.style.display="none",this.bulkPurchaseButton.style.display="block",this.purchasePointButton.style.display="none");const r=Math.max(0,i)+"";this.insufficientPointRawElements.forEach((e=>{"INPUT"===e.nodeName?e.value=r:e.textContent=r}))}}class cr extends er.u{constructor(e,t,i){super("bulk-purchase"),or(this,"view",void 0),or(this,"presenter",void 0),this.view=new lr({purchaseButton:e,purchaseListDiv:t,currentPoint:i}),this.presenter=this.view.presenter}setButton(){this.modalOpenButtons=Array.from(document.querySelectorAll(".js-bulk-purchase-modal-button"))}}function dr(){const e=new er.u("login");new er.u("signup"),function(){const e=document.querySelectorAll(".js-modal-return-location");Array.from(e).forEach((e=>{e.value=location.pathname+location.search}))}(),(0,tr.R$)(e)}var hr=i(7979);let ur,pr=e=>e;const gr=e=>e?Array.from(e.children).filter((e=>"li"===e.tagName.toLowerCase())):[],mr=async()=>{try{const e=new hr.$(new a.E,new I.D),t=await e.getNotifications();if(0===t.length)return;const i=document.querySelector(".viewer-colophon-recommend-list");if(!i)return;t.slice(void 0,3).forEach((e=>{const t=gr(i).find((t=>t.getAttribute("data-series-id")===e.series.id))||i.lastElementChild;t&&t.remove();const r=((e,t,i,r)=>{const n=d(ur||(ur=pr`<li data-series-id="${0}">
        <a href="${0}">
            <img src="${0}" alt="${0}" />
            <div class="not-read-label">未読アリ</div>
        </a>
    </li>`),e,i,r,t);return(0,De.Bv)(n)})(e.series.id,e.series.title,e.episode.permaLink,e.series.thumbnailUrl);r&&(gr(i).length>0?i.insertBefore(r,gr(i)[0]):i.appendChild(r))}))}catch(e){(0,p.T)(e)}},vr=JSON.parse('["UserAccount","Point","Purchase::ViaWeb","Rental::DeliverViaRental","Rental::RentViaWeb","DummyWIPFeature"]'),fr=e=>vr.includes(e),yr=e=>{if(!fr(e))throw new Error(`${e} is unknown`);let t=[];try{var i;t=JSON.parse(null!==(i=(0,_i.ft)())&&void 0!==i?i:"")}catch(r){(0,p.T)(r)}return t.filter((e=>fr(e))).includes(e)},wr=[],br=async()=>{const e=_e.x.data("finishReadingNotificationUri");if(!e)return;if(wr.includes(e))return;if(!(await Fe.Z.retrieveUserPromise()).logged_in)return;const t=await ve.N.post(e),{earning_points:i}=await t.json();i>0&&(Fe.Z.forceRetrieveUserPromise(),z.F.emit("earnedPoints",i)),wr.push(e)},Sr=()=>{_.F.enable(),_.F.addOnTransition((()=>{Zi(),requestIdleCallback((()=>{mr()})),yr("UserAccount")&&Fe.Z.enableLogin(),yr("Purchase::ViaWeb")&&(async()=>{const e=document.querySelector(".js-readable-product-point-container");if(!e)return;if(null==e.dataset.readableProductPrice)return;const t=await Fe.Z.retrieveUserPromise(),i=Number(e.dataset.readableProductPrice),r=(0,ir.J)({point:t.point,price:i,modalNameAvailable:"point-use",modalNameUnavailable:"point-purchase"});(0,tr.zZ)(r);const n=document.querySelector(".js-episode-signup-container");!t.logged_in&&i>0&&n&&(0,H.$Z)(n);const s=document.querySelector(".js-purchase-button");s&&new sr.B(s,window.location.pathname);const o=document.querySelector(".js-bulk-purchase-modal-button"),a=document.querySelector(".js-bulk-purchase-list-wrapper");if(o&&a)try{const e=new cr(o,a,t.point);(0,tr.vs)(e)}catch(d){(0,p.T)(d)}const l=window.location.pathname+window.location.search,c=document.querySelector(".js-bulk-purchase-modal-container");c&&new sr._(c,l)})(),yr("Rental::RentViaWeb")&&async function(){const e=document.querySelector(".js-readable-product-point-container");if(!e)return;if(null==e.dataset.readableProductRentalPrice)return;const t=Number(e.dataset.readableProductRentalPrice),i=await Fe.Z.retrieveUserPromise(),r=(0,ir.J)({point:i.point,price:t,modalNameAvailable:"point-use",modalNameUnavailable:"point-purchase"});(0,tr.Yu)(r);const n=document.querySelector(".js-episode-signup-container");!i.logged_in&&t>0&&n&&(0,H.$Z)(n);const s=document.querySelector(".js-rent-button");s&&new nr(s,window.location.pathname)}()})),_.F.fireTransitionListener(),_.F.addPopstateListener(),z.F.on("finishReading",br),z.F.on("finishReading",Ue)};var Pr=i(2381);i(9832);async function Er(e){const t=e.target,i=t.dataset.recaptchaAction,r=t.dataset.recaptchaSiteKey;if(i&&r){t.disabled=!0,e.preventDefault();try{await new Promise((e=>grecaptcha.enterprise.ready(e)));!function(e,t){const i=document.createElement("input");i.type="hidden",i.name="_recaptcha_token",i.value=t,e.appendChild(i)}(t,await grecaptcha.enterprise.execute(r,{action:i}))}catch(n){(0,p.T)(n)}t.submit()}}function kr(e=document.querySelectorAll("form[data-recaptcha-action][data-recaptcha-site-key]")){e.forEach((e=>{e.addEventListener("submit",Er)})),function(e){const t=new Map;if(!("IntersectionObserver"in window))return;const i=new IntersectionObserver((e=>{const i=document.querySelector(".grecaptcha-badge");if(!i)return;for(const n of e)t.set(n.target,n.isIntersecting);const r=[...t.values()].some((e=>e));i.classList.toggle("visible",r)}));e.forEach((e=>{t.set(e,!1),i.observe(e)}))}(e)}const Lr=e=>{e.connect("core:history",M),e.connect("core:viewer_embed",(()=>{!function(){const e=document.querySelector(".js-thumbnail");if(null==e||!e.dataset.coverStructure)return;const t=N((()=>{Zi()})),i=document.querySelector(".js-viewer-embed");if(!i)return;new ee({container:i,onEnterFullScreen:t,viewer:i});const r=JSON.parse(e.dataset.coverStructure),n=Object.freeze(r.pages.map(((e,t)=>new Ye.T3(Ui(Ui({},e),{},{index:t,choJuGiga:"usagi",contentEnd:"",contentStart:"",isGif:!1}))))),s=document.querySelector(".js-thumbnail .js-thumbnail-image-container");if(!s)return;const o=new Pe(s,n),a=new re(e);new ri({container:e,viewport:a,pageImageLoader:o})}()}))},jr=e=>{e.always((()=>{yr("UserAccount")&&(Fe.Z.on("update",(e=>{e.logged_in?(0,H.$Z)(document.querySelectorAll(".js-show-for-logged-in")):(0,H.$Z)(document.querySelectorAll(".js-show-for-guest"));const t=Yi.G.isStaff&&new URLSearchParams(location.search).get("rank");"premium.more"===(t||e.rank)?(0,H.$Z)(document.querySelectorAll(".js-show-for-premium-more")):"premium"===(t||e.rank)?(0,H.$Z)(document.querySelectorAll(".js-show-for-premium")):(0,H.$Z)(document.querySelectorAll(".js-recommend-premium"));const i=document.querySelector(".js-not-appear-container"),r=document.querySelector(".js-not-appear-text");var n;i&&r&&(e.logged_in&&(r.textContent=null!==(n=e.not_appear_text)&&void 0!==n?n:""),r.textContent&&(0,H.$Z)(i)),document.querySelectorAll(".js-current-point").forEach((t=>{t.textContent=e.point.total+"pt"})),(new Qi.Z).displayPointNeeded(e.point.total)})),Fe.Z.retrieveUserPromise(),dr(),(()=>{const e=document.querySelector('form[name="login"]'),t=document.querySelector(".js-login-error-message");e&&t&&new _t(e,t)})(),(()=>{const e=document.querySelectorAll('input[name="csrf_token"]');e.length&&Fe.Z.retrieveUserPromise().then((t=>{const i=t.csrf_token;i&&Array.from(e).forEach((e=>{e.value=i}))}))})(),(()=>{const e=Array.from(document.querySelectorAll("form.js-submit-once"));for(const t of e)new $t(t)})(),kr())}))},xr=e=>{e.connect("core:viewer",Sr),Lr(e),(e=>{e.connect("common:my",Ji),e.connect(/^media:[^:+]+:my$/,Ji),e.connect("common:my:history",Wi)})(e),jr(e),(e=>{e.always((()=>{(0,Xi.a)(),(0,Pr.Q)(),new Qe.r,nt().then((()=>(0,O.d)()))})),e.freeze()})(e)}},2397:(e,t,i)=>{i.d(t,{LM:()=>n,OJ:()=>o,ox:()=>s});i(752),i(6265),i(9307),i(4043),i(8730);var r=i(5758);const n=()=>new URLSearchParams(window.location.search).get("from"),s=(e,t)=>{const i=t.href;t.href=a(i,e)},o=()=>{const e=n();if(!e)return;const t=r.x.data("nextReadableProductUri");t&&r.x.update("nextReadableProductUri",a(t,e));const i=r.x.data("prevReadableProductUri");i&&r.x.update("prevReadableProductUri",a(i,e))},a=(e,t)=>{const i=new URL(e);return i.searchParams.set("from",t),i.toString()}},5758:(e,t,i)=>{i.d(t,{x:()=>o});i(752),i(6265),i(6801),i(6544);var r=i(454);function n(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const s=["id","title","typeName","publishedAt","imageUrisDigest","permalink","nextReadableProductUri","prevReadableProductUri","finishReadingNotificationUri"];const o=new class{constructor(){n(this,"dataMap",void 0),this.dataMap=new Map}update(e,t){this.dataMap.set(e,t)}data(e){if(!this.dataMap.has(e))return null;const t=this.dataMap.get(e);if(void 0===t)return(0,r.T)(new Error(`No data exits with "${e}"`)),null;if("string"==typeof t){if(s.includes(e))return t;try{const i=JSON.parse(t);return this.update(e,i),this.data(e)}catch(i){return(0,r.T)(i),null}}return t}}},4002:(e,t,i)=>{i.d(t,{j:()=>c});i(3374),i(6544);var r=i(4031),n=i.n(r),s=i(7534),o=i(8794);function a(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const l="download_manager";class c{constructor(e){a(this,"localStorage",void 0),a(this,"limitCount",void 0),a(this,"maxAge",void 0),a(this,"updateCheckQueue",void 0),this.localStorage=o.K,this.limitCount=Infinity,this.maxAge=Infinity,e&&(e.limitCount&&(this.limitCount=e.limitCount),e.maxAge&&(this.maxAge=e.maxAge)),this.updateCheckQueue=n()({concurrency:2}),window.addEventListener("unload",(()=>{this.updateCheckQueue.stop(),this.updateCheckQueue.slice(0,0)})),this.updateCheck()}get downloadedProducts(){return this.loadDownloadedProducts()}get length(){return this.downloadedProducts.length}loadDownloadedProducts(){let e=[];try{e=JSON.parse(this.localStorage.getItem(l)||"[]")}catch(t){}return e.map((e=>(0,s.Z)(e)))}updateCheck(){this.getAll().forEach((e=>{this.updateCheckQueue.push((t=>{e.checkForUpdate().then((i=>{i&&this.removeById(e.id),this.removeExpired(),null==t||t()}))}))})),this.updateCheckQueue.start()}getAll(e="ASC"){return"DESC"===e?this.downloadedProducts.slice().reverse():this.downloadedProducts}getFirst(){return this.getAll()[0]}getLast(){return this.getAll("DESC")[0]}get(e){const{begin:t,end:i}=e;return this.getAll("DESC").slice(t,i)}getById(e){return this.downloadedProducts.filter((t=>t.id===e))[0]}add(e){this.removeById(e.id,!0);const t=this.downloadedProducts;for(t.push(e);t.length>this.limitCount;)t.shift();this.updateLS(t),this.removeExpired()}clear(){this.localStorage.removeItem(l)}haveDownloaded(e){return!!this.getById(e)}removeById(e,t){const i=this.getAll().filter((i=>{const r=i.id===e;return r&&!t&&i.removeFromCache(),!r}));this.updateLS(i)}clearAllPageImageCache(){var e;this.updateLS([]),null===(e=navigator.serviceWorker)||void 0===e||null===(e=e.controller)||void 0===e||e.postMessage({action:"clearAllPageImageCache"})}removeExpired(){const e=this.getAll().filter((e=>!!(e.readable&&e.sinceFromDownload<this.maxAge)||(e.removeFromCache(),!1)));this.updateLS(e)}updateLS(e){try{this.localStorage.setItem(l,JSON.stringify(e))}catch(t){}}}},9453:(e,t,i)=>{i.d(t,{F:()=>s});i(752),i(6265);var r=i(4217);const n=new(i.n(r)());const s=new class{on(e,t,i){n.on(e,t,i)}off(e,t,...i){n.off(e,t,...i)}emit(e,...t){n.emit(e,...null!=t?t:[])}}},7603:(e,t,i)=>{i.d(t,{T:()=>r});class r{static pushEvent(e){window.dataLayer&&window.dataLayer.push(e)}static sendScrollPosition(e){r.pushEvent({event:"scrollPosition",giga:{scroll_position:e}})}static sendFirstPage(e,t){r.pushEvent({event:"firstPage",giga:{[e]:{content_id:t}}})}static sendLastPage(e,t){r.pushEvent({event:"lastPage",giga:{[e]:{content_id:t}}})}static sendLinkPage(e,t){"front"===t?r.pushEvent({event:"frontLinkPage",giga:{link_page_number:`${e}`}}):"back"===t&&r.pushEvent({event:"backLinkPage",giga:{link_page_number:`${e}`}})}static visitTshirtShop(e){r.pushEvent({event:"visitTshirtShop",giga:{pageNumber:e}})}static sendToCActiveContentChange(e){r.pushEvent({event:"tocActiveContentChange",giga:{magazine:{content_title:e},title:e}})}}},5055:(e,t,i)=>{i.d(t,{Q:()=>c,d:()=>l});var r=i(6695),n=i(7979),s=i(454),o=i(5224);function a(e){if(e.length)try{new n.$(new r.E,new o.D).getNotifications().then((t=>{const i=t.filter((e=>e.isNew)).length;i>0&&e.forEach((e=>{e.style.display="",e.textContent=i.toString()}))}))}catch(t){(0,s.T)(t)}}const l=()=>{a(document.querySelectorAll(".header-history-badge"))},c=()=>{a(document.querySelectorAll(".update-notification-history-badge"))}},5490:(e,t,i)=>{i.d(t,{T3:()=>h,uX:()=>u,aE:()=>c});i(752),i(6265),i(6544);const r=(e,t)=>{const i={};return e.forEach((e=>{const r=t(e)+"";i[r]||(i[r]=[]),i[r].push(e)})),i};var n=i(3304);function s(e){const t=Array.isArray(e)?Array.from(e):Object.assign({},e);return Object.keys(t).forEach((e=>{t.hasOwnProperty(e)&&"object"==typeof t[e]&&!Object.isFrozen(t[e])&&(t[e]=s(t[e]))})),Object.freeze(t)}function o(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function a(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?o(Object(i),!0).forEach((function(t){l(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function l(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let c;var d;(d=c||(c={})).RTL="rtl",d.LTR="ltr",d.TTB="ttb";class h{get isMain(){return"main"===this.type}getButtonsOfType(e){return this.buttons.filter((t=>t.type===e))}constructor(e){l(this,"hide",void 0),l(this,"screen",void 0),l(this,"type",void 0),l(this,"align",void 0),l(this,"index",void 0),l(this,"dimension",void 0),l(this,"link",void 0),l(this,"buttons",void 0),l(this,"choJuGiga",void 0),l(this,"contentEnd",void 0),l(this,"contentStart",void 0),l(this,"isGif",void 0),l(this,"src",void 0),l(this,"content",void 0),l(this,"tweetIds",void 0),l(this,"linkPosition",void 0),e.hide&&(this.hide=e.hide),this.screen=e.screen,this.type=e.type,this.align=e.align,this.index=e.index,this.link=e.link,this.choJuGiga=e.choJuGiga,this.contentEnd=e.contentEnd,this.contentStart=e.contentStart,this.isGif=e.isGif,this.src=e.src,this.content=e.content,this.tweetIds=e.tweetIds,this.linkPosition=e.linkPosition;const t=e.width||0,i=e.height||0;this.dimension=new n.R(t,i),this.buttons=e.buttons||[]}get isSpreadCenter(){return this.isMain&&"center"===this.align}get dimensionPerSinglePage(){return this.isSpreadCenter?new n.R(this.dimension.width/2,this.dimension.height):this.dimension}cloneWithNewScreenNumber(e){return new h(a(a({},this),{},{screen:e,width:this.dimension.width,height:this.dimension.height}))}}class u{constructor(e){l(this,"pages",void 0),l(this,"singleMaxScreen",void 0),l(this,"spreadMaxScreen",void 0),l(this,"readingDirection",void 0),l(this,"minimumPageWidth",void 0),l(this,"singleScreenToPages",void 0),l(this,"spreadScreenToPages",void 0),l(this,"mainPages",void 0),l(this,"rawHtmlPages",void 0),this.validate(e);const t=e;this.pages={spread:Object.freeze(this.pageArgsToSpreadPages(t.pages,t.choJuGiga,t.readingDirection,t.startPosition)),single:[]},this.pages.single=this.createSinglePages(),this.readingDirection=t.readingDirection,this.singleMaxScreen=this.singlePages[this.singlePages.length-1].screen,this.spreadMaxScreen=this.spreadPages[this.spreadPages.length-1].screen,this.singleScreenToPages=s(r(this.pages.single,(e=>e.screen))),this.spreadScreenToPages=s(r(this.pages.spread,(e=>e.screen))),this.mainPages=Object.freeze(this.pages.single.filter((e=>e.isMain))),this.rawHtmlPages=Object.freeze(this.pages.single.filter((e=>"html"===e.type))),this.minimumPageWidth=Math.min(...this.mainPages.map((e=>e.dimension.width)))}get isHorizontal(){return"rtl"===this.readingDirection||"ltr"===this.readingDirection}pageArgsToSpreadPages(e,t,i,r){const n=[];let s;"ttb"!==i&&r&&(s=this.flyleafIndex(e,r));let o=0;for(const l of e){n.length===s&&(o++,n.push(new h({type:"flyleaf",index:n.length,screen:Math.floor(o/2)+1,align:"left",choJuGiga:t})));let e,i=l.align;"center"!==i&&(i=o%2==0?"left":"right"),"spread"===l.hide?e=null:(e=Math.floor(o/2)+1,o+="center"===l.align?2:1),n.push(new h(a({index:n.length,screen:e,align:i,choJuGiga:t},l)))}return n}flyleafIndex(e,t){const i=e=>"spread"!==e.hide,r=e.filter(i);if(!r.length)return;const n=r.findIndex((e=>"main"===e.type)),s="latter"===t?1:0;return 1===Math.abs((s-n)%2)?e.findIndex(i):void 0}validate(e){if(!(e.pages&&Array.isArray(e.pages)&&e.readingDirection))throw new Error("invalid pageStructure")}createSinglePages(){let e=1;return Object.freeze(this.spreadPages.map((t=>{let i;return"flyleaf"===t.type?i=null:(i=e,e+=t.isSpreadCenter?2:1),t.cloneWithNewScreenNumber(i)})))}get singlePages(){return this.pages.single}get spreadPages(){return this.pages.spread}get maxPage(){return this.pages.single.length}get imageUrls(){return this.mainPages.map((e=>e.src)).filter(Boolean)}singleScreenToSpreadScreen(e){const t=this.singlePageAt(e);if(t){const e=this.spreadPages[t.index];if(e)return e.screen}const i=this.singlePageAt(e-1);if(i){const e=this.spreadPages[i.index];if(e)return e.screen}return 1}spreadScreenToSingleScreen(e){const t=this.spreadPages.findIndex((t=>t.screen===e&&"flyleaf"!==t.type));return this.singlePages[t].screen?this.singlePages[t].screen:1}singlePageAt(e){return this.singlePages.find((t=>t.screen===e))||null}spreadPageAt(e){return this.spreadPages.find((t=>t.screen===e))||null}screenToPageIndexes(e,t){const i=this.screenToPages(t)[e];return i?Object.freeze(i.map((e=>e.index))):[]}screenToPages(e){return e?this.spreadScreenToPages:this.singleScreenToPages}screenToPageIndexesOn(e,t,i){const r=(t?this.spreadScreenToPages:this.singleScreenToPages)[e];return r?Object.freeze(r.filter((e=>e.type===i)).map((e=>e.index))):[]}pageTypeIs(e,t,i){const r=(t?this.spreadScreenToPages:this.singleScreenToPages)[e];return!!r&&r.filter((e=>e.type===i)).length>0}isLatter(e){const t=this.singlePageAt(e);if(t&&"right"===t.align)return!0;const i=this.singlePageAt(e-1);return!(t||!i||"center"!==i.align)}get imageSizeForLocator(){if(0===this.mainPages.length)return;const e=this.mainPages.map((e=>e.dimensionPerSinglePage));return new n.R(Math.max(...e.map((e=>e.width))),Math.min(...e.map((e=>e.height))))}hasButtonsOfType(e){return!!this.pages.single.find((t=>t.getButtonsOfType(e).length>0))}}},308:(e,t,i)=>{function r(e){const t=(new DOMParser).parseFromString(e,"text/html");if(null!=t&&t.body)return t;const i=document.implementation.createHTMLDocument("");return i.body.innerHTML=e,i}function n(e){var t;const i=r(e);return null==i||null===(t=i.body)||void 0===t?void 0:t.children}function s(e){var t;const i=r(e);return null==i||null===(t=i.body)||void 0===t?void 0:t.firstElementChild}i.d(t,{Bv:()=>s,VN:()=>n,kH:()=>r})},7534:(e,t,i)=>{i.d(t,{Z:()=>a});var r=i(2845),n=i(9065);class s extends n.x{constructor(e){super(e),this.type="magazine"}}class o extends n.x{constructor(e){super(e),this.type="volume"}}const a=e=>{switch(e.type){case"magazine":return new s(e);case"volume":return new o(e);case"episode":return new r.I(e)}}},4366:(e,t,i)=>{i.d(t,{IK:()=>d});i(6544);var r=i(5795),n=i(454),s=i(3736);function o(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class a extends r.q{constructor(e,t){super(e),o(this,"DIVIDE_NUM",4),o(this,"MULTIPLE",8),o(this,"width",void 0),o(this,"height",void 0),o(this,"cell_width",void 0),o(this,"cell_height",void 0),this.width=t.width,this.height=t.height,this.cell_width=Math.floor(this.width/(this.DIVIDE_NUM*this.MULTIPLE))*this.MULTIPLE,this.cell_height=Math.floor(this.height/(this.DIVIDE_NUM*this.MULTIPLE))*this.MULTIPLE}solve(){this.view.drawImage(0,0,this.width,this.height,0,0);for(let e=0;e<this.DIVIDE_NUM*this.DIVIDE_NUM;e++){const t=Math.floor(e/this.DIVIDE_NUM)*this.cell_height,i=e%this.DIVIDE_NUM*this.cell_width,r=Math.floor(e/this.DIVIDE_NUM),n=e%this.DIVIDE_NUM*this.DIVIDE_NUM+r,s=n%this.DIVIDE_NUM*this.cell_width,o=Math.floor(n/this.DIVIDE_NUM)*this.cell_height;this.view.drawImage(i,t,this.cell_width,this.cell_height,s,o)}}}let l=!1;class c extends r.G{constructor(e){super(e)}initMembers(e){this.puzzledImage=e,this.width=e.naturalWidth,this.height=e.naturalHeight,this.solvedImage=document.createElement("canvas"),this.solvedImage.width=this.width,this.solvedImage.height=this.height}registerEvents(){}createPresenter(){return new a(this,{width:this.width,height:this.height})}drawImage(e,t,i,r,s,o){const a=this.solvedImage.getContext("2d");a?(a.imageSmoothingEnabled=!1,a.drawImage(this.puzzledImage,e,t,i,r,s,o,i,r)):l||((0,n.T)(new Error("Failed to getContext")),l=!0)}makeTainted(){const e=(0,s.PK)();if(!e)return;const t=new Image;t.onload=()=>{var e;null===(e=this.solvedImage)||void 0===e||null===(e=e.getContext("2d"))||void 0===e||e.drawImage(t,-1,-1,1,1)},t.src=`${e}/images/spacer.png`}}function d(e){try{const t=new c(e);return t.presenter.solve(),t.makeTainted(),t.solvedImage}catch(t){return void(0,n.T)(t)}}},3976:(e,t,i)=>{i.d(t,{d5:()=>g});i(6544);var r=i(4217),n=i.n(r),s=i(5795),o=i(308),a=i(4883),l=i(3211),c=i(3178),d=i(2397);function h(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let u=function(e){return e[e.WAITING=0]="WAITING",e[e.LOADING=1]="LOADING",e[e.DISABLED=2]="DISABLED",e}({});class p extends s.q{constructor(e,t){super(e),h(this,"eventEmitter",void 0),h(this,"maxReadMoreCount",void 0),h(this,"readMoreCount",0),h(this,"readMoreStatus",u.WAITING),h(this,"isLoading",!1),h(this,"apiUrl",void 0),this.apiUrl=t.apiUrl,this.maxReadMoreCount=t.maxReadMoreCount,this.eventEmitter=new(n())}get canReadMore(){return this.maxReadMoreCount?this.maxReadMoreCount>this.readMoreCount:null!==this.apiUrl}updateReadMoreStatus(){const e=this.readMoreStatus;this.isLoading?this.readMoreStatus=u.LOADING:this.canReadMore?this.readMoreStatus=u.WAITING:this.readMoreStatus=u.DISABLED,this.readMoreStatus!==e&&this.view.updateReadMoreButtonStatus()}requestMoreHtml(){return this.isLoading=!0,this.updateReadMoreStatus(),c.N.get(this.apiUrl).then((e=>e.json())).then((e=>{this.readMoreCount++,this.isLoading=!1,this.view.appendMoreHtml(e),this.apiUrl=e.nextUrl,this.updateReadMoreStatus(),this.eventEmitter.emit("commentLoaded")}))}}class g extends s.G{constructor(e){super(e)}initMembers({readMoreButton:e,readContainer:t}){this.readMoreButton=e,this.readContainer=t,this.onItemLoaded=new(n()),this.onClick=this.onClick.bind(this)}registerEvents(){this.readMoreButton.addEventListener("click",this.onClick),l.F.addOnLeaveListener((()=>{this.readMoreButton.removeEventListener("click",this.onClick)}))}onClick(e){e.preventDefault(),this.presenter.requestMoreHtml()}createPresenter(){return new p(this,{apiUrl:this.readMoreButton.dataset.readMoreEndpoint,maxReadMoreCount:Number(this.readMoreButton.dataset.maxReadMoreCount)})}appendMoreHtml(e){const t=(0,d.LM)(),i=(0,o.VN)(e.html);if(i){for(;i.length>0;){const e=Array.from(i.item(0).querySelectorAll("a"));e.forEach(a.xl),t&&e.forEach((e=>{(0,d.ox)(t,e)})),this.readContainer.appendChild(i.item(0))}this.onItemLoaded.emit("itemLoaded")}}updateReadMoreButtonStatus(){switch(this.presenter.readMoreStatus){case u.WAITING:this.toggleReadMoreButtonDisabled(!1);break;case u.LOADING:this.toggleReadMoreButtonDisabled(!0);break;case u.DISABLED:this.removeReadMoreButton()}}toggleReadMoreButtonDisabled(e){this.readMoreButton.toggleAttribute("disabled",e)}removeReadMoreButton(){this.readMoreButton.remove()}}},81:(e,t,i)=>{i.d(t,{CZ:()=>d,HU:()=>c,bE:()=>u});i(6544);var r=i(5311),n=i.n(r),s=i(3211),o=i(5795),a=i(320);function l(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class c{constructor(e,t,i,r){l(this,"$readMoreButton",void 0),l(this,"$moreContents",void 0),l(this,"readMoreNum",void 0),l(this,"shouldLeaveButtonShown",void 0),this.$readMoreButton=n()(e),this.$moreContents=n()(t),this.readMoreNum=i,this.shouldLeaveButtonShown=r,this.$readMoreButton.on("click",n().proxy(this.onReadMoreButtonClick,this))}onReadMoreButtonClick(e){e.preventDefault(),this.displayMoreContents(),this.shouldLeaveButtonShown||this.$moreContents.filter(":hidden").length||this.hideReadMoreButton()}displayMoreContents(){this.readMoreNum&&this.readMoreNum>0?this.$moreContents.filter(":hidden").slice(0,this.readMoreNum).show():this.$moreContents.show()}hideReadMoreButton(){this.$readMoreButton.hide()}}class d{constructor(e,t,i="revealed"){l(this,"onToggle",(e=>{e.preventDefault();const t=(0,a.xj)(this.bodyElements);(0,a.ZN)(this.bodyElements,t),this.toggleElement.classList.toggle(this.revealedClassName,t)})),this.toggleElement=e,this.bodyElements=t,this.revealedClassName=i,e.addEventListener("click",this.onToggle)}}class h extends o.q{constructor(e,t){super(e),l(this,"view",void 0),l(this,"items",void 0),this.view=e,this.items=t}setup(){0===this.items.length?this.view.showEmptyListMessage():this.view.appendReadMoreItems()}handleMoreButtonClicked(){this.view.expand()}}class u extends o.G{constructor(e){super(e)}initMembers(e){this.container=e.container,this.items=e.items,this.readMoreList=e.container.querySelector(".more-list"),this.readMoreButtonContainer=e.container.querySelector(".more-button-container"),this.readMoreButton=e.container.querySelector(".more-button")}registerEvents(){s.F.addOnLeaveListenerHelper(this.readMoreButton,"click",(()=>this.onMoreButtonClicked()))}createPresenter(){return new h(this,this.items)}appendReadMoreItems(){this.items.forEach((e=>this.readMoreList.insertBefore(e,this.readMoreButtonContainer)))}showEmptyListMessage(){this.container.classList.add("empty")}expand(){this.container.classList.add("expanded")}onMoreButtonClicked(){this.presenter.handleMoreButtonClicked()}}},4513:(e,t,i)=>{i.d(t,{U:()=>c});i(4043),i(7267),i(6544);var r=i(7530),n=i.n(r),s=i(7603),o=i(3211),a=i(8583);function l(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class c{constructor(e,t){l(this,"container",void 0),l(this,"elements",void 0),l(this,"containerHeight",void 0),l(this,"windowHeight",void 0),l(this,"elementsSentScrollPosition",void 0),l(this,"onScroll",(e=>{const t=e.target,i=t instanceof HTMLElement?t.scrollTop:t.documentElement.scrollTop;this.checkScrollPositionAndSendEvent(i)})),this.container=e,this.elements=e.querySelectorAll(t),this.elementsSentScrollPosition=[],this.registerEvents()}registerEvents(){const e=n()(this.onScroll,1e3,{trailing:!0,leading:!0});this.container.addEventListener("scroll",e,{passive:!0}),o.F.addOnLeaveListener((()=>{this.container.removeEventListener("scroll",e)}))}calculateWindowHeight(){return window.innerHeight?window.innerHeight:0}isScrolledElement(e,t){if(!(0,a.p)(e)||this.elementsSentScrollPosition.indexOf(e)>-1)return!1;if(t+this.windowHeight>=this.containerHeight)return!0;const i=e.getBoundingClientRect().top+document.body.scrollTop;return t+this.windowHeight/2>=i}checkScrollPositionAndSendEvent(e){this.windowHeight=this.calculateWindowHeight(),this.containerHeight=this.container instanceof HTMLElement?parseFloat(getComputedStyle(this.container,null).height.replace("px","")):Math.max(this.container.body.scrollHeight,document.documentElement.scrollHeight,this.container.body.offsetHeight,document.documentElement.offsetHeight,document.documentElement.clientHeight),this.elements.forEach(((t,i)=>{this.isScrolledElement(t,e)&&(this.elementsSentScrollPosition.push(t),s.T.sendScrollPosition(i+""))}))}}},2381:(e,t,i)=>{i.d(t,{Q:()=>s});i(4043);var r=i(2907),n=i(320);function s(){r.X.ios?(0,n.$Z)(document.querySelectorAll(".js-show-on-ios")):r.X.android?(0,n.$Z)(document.querySelectorAll(".js-show-on-android")):(0,n.$Z)(document.querySelectorAll(".js-show-on-pc")),navigator.userAgent.match(/ComicDays/)&&(0,n.Cp)(document.querySelectorAll(".js-hide-on-days-app"))}},2936:(e,t,i)=>{i.d(t,{a:()=>s,r:()=>n});var r=i(4802);const n=e=>{e.classList.remove("js-smooth-scrolling-link"),e.addEventListener("click",(t=>{const i=(e=>{if(location.pathname!==e.pathname)return null;const t=decodeURIComponent(e.hash);return t?document.querySelector(t):null})(e);i&&(t.preventDefault(),"start-or-above"===e.dataset.scrollPosition&&i.getBoundingClientRect().top>=0||i.scrollIntoView({block:"start",inline:"nearest",behavior:"smooth"}))}))},s=()=>{(0,r.polyfill)();const e=document.querySelectorAll(".js-smooth-scrolling-link");Array.prototype.slice.apply(e).forEach((e=>n(e)));const t=document.querySelector(".gtm-headline-banner-container");if(!t)return;new MutationObserver((e=>{e.forEach((e=>{for(let t=0;t<e.addedNodes.length;t++){const i=e.addedNodes[t];if(i.nodeType!==i.ELEMENT_NODE)return;if("A"!==i.nodeName)return;if(!i.classList.contains("js-smooth-scrolling-link"))return;n(i)}}))})).observe(t,{childList:!0})}},5757:(e,t,i)=>{i.d(t,{WG:()=>g,Xj:()=>p,lB:()=>u,mn:()=>h,tC:()=>c});i(8472);var r=i(3129),n=i.n(r),s=(i(8274),i(9130)),o=i.n(s),a=i(5714),l=i.n(a);function c(e){const t=new Date(e),i=t.getFullYear(),r=t.getMonth()+1,n=t.getDate();return`${i}/${r.toString().padStart(2,"0")}/${n.toString().padStart(2,"0")}`}n().locale("ja"),n().extend(l()),n().extend(o()),n().tz.setDefault("Asia/Tokyo");const d={separator:"/"};function h(e,t=d){const{separator:i}=t;return n()(e).tz().format(`MM${i}DD`)}function u(e,t=d){const{separator:i}=t;return n()(e).tz().format(`YYYY${i}MM${i}DD`)}function p(e){const t=n()(e).tz();return{month:t.format("M"),day:t.format("D")}}function g(e){return n()(e).tz().format("dd")}},8583:(e,t,i)=>{i.d(t,{p:()=>r});const r=e=>!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},320:(e,t,i)=>{function r(e){return e instanceof HTMLElement?[e]:Array.from(e)}i.d(t,{$Z:()=>n,Cp:()=>s,ZN:()=>a,xj:()=>o});const n=e=>{r(e).forEach((e=>{"none"===e.style.display&&(e.style.display=""),e.classList.remove("hidden")}))},s=e=>{r(e).forEach((e=>{"none"!==e.style.display&&(e.style.display=""),e.classList.add("hidden")}))},o=e=>r(e).map((e=>window.getComputedStyle(e))).every((e=>"none"===e.display)),a=(e,t)=>t?n(e):s(e)},2349:(e,t,i)=>{i.d(t,{i:()=>n});i(3964);var r=i(3211);const n=e=>new Promise((t=>{if(!("IntersectionObserver"in window))return t();const i=new IntersectionObserver(((e,i)=>{e.forEach((e=>{if(e.isIntersecting){const r=e.target;i.unobserve(r),t()}}))}));i.observe(e),r.F.isEnabled&&r.F.addOnLeaveListener((()=>{i.unobserve(e)}))}))},5275:(e,t,i)=>{i.d(t,{d:()=>o,w:()=>a});i(3964);let r,n;const s="https://cdn.pool.st-hatena.com/valve/valve.js";function o(){return r||(r=new Promise((e=>{const t=document.createElement("script");t.id="valve-js",t.async=!0,t.src=s,document.body.appendChild(t),window.valve||(window.valve=[]),window.valve.push((()=>{n=!0,e()}))})),r)}function a(){return n}},3304:(e,t,i)=>{i.d(t,{R:()=>n});i(6544);function r(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class n{constructor(e,t){r(this,"width",void 0),r(this,"height",void 0),this.width=e,this.height=t}equal(e){return this.width===e.width&&this.height===e.height}get isWide(){return this.width>this.height&&this.width>=450}}},79:(e,t,i)=>{i.d(t,{Nu:()=>a,cP:()=>c});i(3964);var r=i(2349);const n={src:"https://platform.twitter.com/widgets.js",id:"twitter-widget-js"},s={src:"https://connect.facebook.net/ja_JP/sdk.js#xfbml=1&version=v2.8",id:"facebook-jssdk"},o={src:"https://b.st-hatena.com/js/bookmark_button.js",id:"bookmark-button-js"},a=async()=>{const e=document.querySelector(".episode-header-share");e&&(await(0,r.i)(e),c(),h(),p())};let l=null;const c=async()=>{if(!l){const{src:e,id:t}=n;l=m(e,t).then((()=>new Promise((e=>{window.twttr.ready((()=>{e()}))}))))}return l};let d=null;const h=async()=>{if(!d){const{src:e,id:t}=s;d=m(e,t)}return d};let u=null;const p=async()=>{if(!u){const{src:e,id:t}=o;u=m(e,t)}return u};let g=null;const m=(e,t)=>new Promise((i=>{g||(g=document.createDocumentFragment());const r=document.createElement("script");r.dataset.id=t,r.onload=()=>i(),r.src=e,g.appendChild(r),document.body.appendChild(g)}))},4883:(e,t,i)=>{i.d(t,{Et:()=>s,ff:()=>n,xl:()=>o});i(4043);var r=i(3211);function n(e){return[/\/episode\/\d+$/,/\/volume\/\d+$/,/\/magazine\/\d+$/].some((t=>t.test(e)))}function s(e){return null!==e.body&&!e.body.classList.contains("private")}const o=e=>{r.F.addOnLeaveListenerHelper(e,"click",(t=>{t.metaKey||t.shiftKey||t.ctrlKey||1!==t.button&&2!==t.button&&(t.preventDefault(),r.F.transition(e.href))}))}}}]);nforcement","AUCTION_DEBUG":"auctionDebug","BID_VIEWABLE":"bidViewable","STALE_RENDER":"staleRender","BILLABLE_EVENT":"billableEvent"},"q_":{"PREVENT_WRITING_ON_MAIN_DOCUMENT":"preventWritingOnMainDocument","NO_AD":"noAd","EXCEPTION":"exception","CANNOT_FIND_AD":"cannotFindAd","MISSING_DOC_OR_ADID":"missingDocOrAdid"},"aI":{"bidWon":"adUnitCode"},"Ql":{"yE":"low","M2":"medium","lj":"high","B7":"auto","uN":"dense","qN":"custom"},"TD":{"BIDDER":"hb_bidder","AD_ID":"hb_adid","PRICE_BUCKET":"hb_pb","SIZE":"hb_size","DEAL":"hb_deal","SOURCE":"hb_source","FORMAT":"hb_format","UUID":"hb_uuid","CACHE_ID":"hb_cache_id","CACHE_HOST":"hb_cache_host","ADOMAIN":"hb_adomain","ACAT":"hb_acat","CRID":"hb_crid","DSP":"hb_dsp"},"kF":{"BIDDER":"hb_bidder","AD_ID":"hb_adid","PRICE_BUCKET":"hb_pb","SIZE":"hb_size","DEAL":"hb_deal","FORMAT":"hb_format","UUID":"hb_uuid","CACHE_HOST":"hb_cache_host"},"FY":{"title":"hb_native_title","body":"hb_native_body","body2":"hb_native_body2","privacyLink":"hb_native_privacy","privacyIcon":"hb_native_privicon","sponsoredBy":"hb_native_brand","image":"hb_native_image","icon":"hb_native_icon","clickUrl":"hb_native_linkurl","displayUrl":"hb_native_displayurl","cta":"hb_native_cta","rating":"hb_native_rating","address":"hb_native_address","downloads":"hb_native_downloads","likes":"hb_native_likes","phone":"hb_native_phone","price":"hb_native_price","salePrice":"hb_native_saleprice","rendererUrl":"hb_renderer_url","adTemplate":"hb_adTemplate"},"os":{"YZ":"s2s"},"UE":{"CK":"targetingSet","fe":"rendered","G9":"bidRejected"},"Gw":{"UI":"Bid has missing or invalid properties","Gp":"Invalid request ID","Dg":"Bidder code is not allowed by allowedAlternateBidderCodes / allowUnknownBidderCodes","pe":"Bid does not meet price floor","Xx":"Unable to convert currency"},"V1":{"body":"desc","body2":"desc2","sponsoredBy":"sponsored","cta":"ctatext","rating":"rating","address":"address","downloads":"downloads","likes":"likes","phone":"phone","price":"price","salePrice":"saleprice","displayUrl":"displayurl"},"s$":{"sponsored":1,"desc":2,"rating":3,"likes":4,"downloads":5,"price":6,"saleprice":7,"phone":8,"address":9,"desc2":10,"displayurl":11,"ctatext":12},"oF":{"ICON":1,"MAIN":3},"zA":["privacyIcon","clickUrl","sendTargetingKeys","adTemplate","rendererUrl","type"],"C_":{"Ot":"noData","Vs":"adUnit","cl":"setConfig","jR":"fetch","MR":"success"}}')}},t={};function r(e){var i=t[e];if(void 0!==i)return i.exports;var o=t[e]={exports:{}};return n[e].call(o.exports,o,o.exports,r),o.exports}r.m=n,e=[],r.O=function(n,t,i,o){if(!t){var a=1/0;for(d=0;d<e.length;d++){t=e[d][0],i=e[d][1],o=e[d][2];for(var u=!0,c=0;c<t.length;c++)(!1&o||a>=o)&&Object.keys(r.O).every((function(e){return r.O[e](t[c])}))?t.splice(c--,1):(u=!1,o<a&&(a=o));if(u){e.splice(d--,1);var s=i();void 0!==s&&(n=s)}}return n}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[t,i,o]},r.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(n,{a:n}),n},r.d=function(e,n){for(var t in n)r.o(n,t)&&!r.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},function(){var e={25602:0};r.O.j=function(n){return 0===e[n]};var n=function(n,t){var i,o,a=t[0],u=t[1],c=t[2],s=0;if(a.some((function(n){return 0!==e[n]}))){for(i in u)r.o(u,i)&&(r.m[i]=u[i]);if(c)var d=c(r)}for(n&&n(t);s<a.length;s++)o=a[s],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return r.O(d)},t=self.pbjsChunk=self.pbjsChunk||[];t.forEach(n.bind(null,0)),t.push=n.bind(null,t.push.bind(t))}();var i=r(23866);i=r.O(i)}();
(self.pbjsChunk=self.pbjsChunk||[]).push([[14861],{64563:function(e,n,t){t.d(n,{ZP:function(){return v}});var a=t(93324),r=t(71002),i=t(5644),l=t(48928),o=t(64358),s=t(52021),c={ajax:l.hj},u="endpoint",f="bundle",p=Object.values(i.FP).filter((function(e){return e!==i.FP.AUCTION_DEBUG})),d=100;function v(e){var n,t,l,v,g,y=e.url,b=e.analyticsType,h=e.global,T=e.handler,A=[],j=!1,E=(v=!1,g=function(){if(!v){v=!0;try{for(var e=0,n=0;A.length>0;){e++;var a=A.length;if(A.shift()(),A.length>=a?n++:n=0,n>=10)return(0,o.logError)("Detected probable infinite loop, discarding events",A),void(A.length=0)}(0,o.logMessage)("".concat(t," analytics: processed ").concat(e," events"))}finally{v=!1}}},function(){null!=l&&(clearTimeout(l),l=null),0===d?g():l=setTimeout(g,d)});return Object.defineProperties({track:function(e){var n=e.eventType,t=e.args;this.getAdapterType()===f&&window[h](T,n,t);this.getAdapterType()===u&&m.apply(void 0,arguments)},enqueue:O,enableAnalytics:k,disableAnalytics:function(){Object.entries(n||{}).forEach((function(e){var n=(0,a.Z)(e,2),t=n[0],r=n[1];s.off(t,r)})),this.enableAnalytics=this._oldEnable?this._oldEnable:k,j=!1},getAdapterType:function(){return b},getGlobal:function(){return h},getHandler:function(){return T},getUrl:function(){return y}},{enabled:{get:function(){return j}}});function m(e){var n=e.eventType,t=e.args,a=e.callback;c.ajax(y,a,JSON.stringify({eventType:n,args:t}))}function O(e){var n=this,t=e.eventType,a=e.args;A.push((function(){n.track({eventType:t,args:a})})),E()}function k(e){var a=this;t=null==e?void 0:e.provider;var l,c,u,f,d,v=this;if("object"!==(0,r.Z)(e)||"object"!==(0,r.Z)(e.options)||(void 0===e.options.sampling||Math.random()<parseFloat(e.options.sampling))){var g=(c=(l=e||{}).includeEvents,u=void 0===c?p:c,f=l.excludeEvents,d=void 0===f?[]:f,new Set(Object.values(i.FP).filter((function(e){return u.includes(e)})).filter((function(e){return!d.includes(e)}))));s.getEvents().forEach((function(e){if(e&&g.has(e.eventType)){var n=e.eventType,t=e.args;O.call(v,{eventType:n,args:t})}})),n=Object.fromEntries(Array.from(g).map((function(e){var n=function(n){return a.enqueue({eventType:e,args:n})};return s.on(e,n),[e,n]})))}else(0,o.logMessage)('Analytics adapter for "'.concat(h,'" disabled by sampling'));this._oldEnable=this.enableAnalytics,this.enableAnalytics=function(){return(0,o.logMessage)('Analytics adapter for "'.concat(h,'" already enabled, unnecessary call to `enableAnalytics`.'))},j=!0}}}}]);
(self.pbjsChunk=self.pbjsChunk||[]).push([[17968],{52712:function(n,t,r){r.d(t,{b6:function(){return p},kX:function(){return f},m1:function(){return s},sM:function(){return u}});var e=r(4942),a=r(93324),c=r(89062),o=r(68792);function i(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(n);t&&(e=e.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.push.apply(r,e)}return r}function l(n){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){(0,e.Z)(n,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(r,t))}))}return n}var u=0,f=1,s=2;function p(n){var t=n.apiName,r=n.apiVersion,i=n.apiArgs,p=void 0===i?["command","callback","parameter","version"]:i,v=n.callbackArgs,b=void 0===v?["returnValue","success"]:v,d=n.mode,O=void 0===d?u:d,y=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window,g={},m="".concat(t,"Call"),j="".concat(t,"Return");function k(n){var t,r="string"==typeof n.data&&n.data.includes(j)?JSON.parse(n.data):n.data;if(null!=r&&null!==(t=r[j])&&void 0!==t&&t.callId){var e=r[j];g.hasOwnProperty(e.callId)&&g[e.callId].apply(g,(0,c.Z)(b.map((function(n){return e[n]}))))}}function h(){for(var n,r=y,e=!1;null!=r;){try{if("function"==typeof r[t]){n=r,e=!0;break}}catch(n){}try{if(r.frames["".concat(t,"Locator")]){n=r;break}}catch(n){}if(r===y.top)break;r=r.parent}return[n,e]}var w,P=h(),Z=(0,a.Z)(P,2),D=Z[0],E=Z[1];if(D)return E?w=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new o.Z((function(r,e){var o=D[t].apply(D,(0,c.Z)(I(l(l({},n),{},{callback:n.callback||O===s?S(n.callback,r,e):void 0})).map((function(n){var t=(0,a.Z)(n,2);t[0];return t[1]}))));(O===f||null==n.callback&&O===u)&&r(o)}))}:(y.addEventListener("message",k,!1),w=function(n){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new o.Z((function(r,c){var o=Math.random().toString(),i=(0,e.Z)({},m,l(l({},Object.fromEntries(I(n).filter((function(n){return"callback"!==(0,a.Z)(n,1)[0]})))),{},{callId:o}));g[o]=S(null==n?void 0:n.callback,r,c,(t||null==(null==n?void 0:n.callback))&&function(){delete g[o]}),D.postMessage(i,"*"),O===f&&r()}))}),Object.assign(w,{isDirect:E,close:function(){!E&&y.removeEventListener("message",k)}});function I(n){return n=Object.assign({version:r},n),p.map((function(t){return[t,n[t]]}))}function S(n,t,r,e){var a="function"==typeof n;return function(c,o){if(e&&e(),O!==f){var i=null==o||o?t:r;i(a?void 0:c)}a&&n.apply(this,arguments)}}}}}]);
(self.pbjsChunk=self.pbjsChunk||[]).push([[21266],{55630:function(n,e,t){var o,r,i,a,c,s,u=t(71002),l=t(78640),f=t(64358),d=t(96475),p=t(3193),g=t(34516),m=t(34614),v=t(99128),b=t(26372),y=t(54078),C=t(52712),P=!1,M={iab:function(n){var e=n.onSuccess,t=n.onError,o=n.onEvent;var r=(0,C.b6)({apiName:"__tcfapi",apiVersion:2,apiArgs:["command","version","callback","parameter"]});if(!r)return t("TCF2 CMP not found.");r.isDirect?(0,f.logInfo)("Detected CMP API is directly accessible, calling it now..."):(0,f.logInfo)("Detected CMP is outside the current iframe where Prebid.js is located, calling it now...");r({command:"addEventListener",callback:function(n,r){(0,f.logInfo)("Received a response from CMP",n),r?(o(n),!1!==n.gdprApplies&&"tcloaded"!==n.eventStatus&&"useractioncomplete"!==n.eventStatus||A(n,{onSuccess:e,onError:t})):t("CMP unable to register callback function.  Please check CMP setup.")}})},static:function(n){var e=n.onSuccess,t=n.onError;A(a,{onSuccess:e,onError:t})}};function S(n){var e,t,i=!1,a=null,s=!1;function u(n){null!=a&&clearTimeout(a),i||null==n||(0===n?e():a=setTimeout(e,n))}function l(e,t,o){if(u(null),i=!0,g.rp.setConsentData(e),"function"==typeof n){for(var r=arguments.length,a=new Array(r>3?r-3:0),c=3;c<r;c++)a[c-3]=arguments[c];n.apply(void 0,[t,o].concat(a))}}if((0,m.q9)(Object.keys(M),o)){var f={onSuccess:function(n){return l(n,!1)},onError:function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),o=1;o<e;o++)t[o-1]=arguments[o];l.apply(void 0,[null,!0,n].concat(t))},onEvent:function(n){t=n,s||(s=!0,null!=c&&u(c))}};e=function(){var n=function(n){l(n,!1,"".concat(s?"Timeout waiting for user action on CMP":"CMP did not load",", continuing auction..."))};A(t,{onSuccess:n,onError:function(){return n(w(void 0))}})},M[o](f),null!=c&&s||u(r)}else l(null,!1,"CMP framework (".concat(o,") is not a supported framework.  Aborting consentManagement module and resuming auction."))}var h=(0,v.g3)("gdpr",(function(n,e){var t;t=function(t,o){if(o){var r=f.logWarn;t&&(r=f.logError,o="".concat(o," Canceling auction as per consentManagement config."));for(var i=arguments.length,a=new Array(i>2?i-2:0),c=2;c<i;c++)a[c-2]=arguments[c];r.apply(void 0,[o].concat(a))}t?(n.stopTiming(),"function"==typeof e.bidsBackHandler?e.bidsBackHandler():(0,f.logError)("Error executing bidsBackHandler")):n.call(this,e)},s?((0,f.logInfo)("User consent information already known.  Pulling internally stored information..."),t(!1)):S(t)}));function A(n,e){var t,o,r=e.onSuccess,a=e.onError;t=n&&"boolean"==typeof n.gdprApplies?n.gdprApplies:i,o=n&&n.tcString,"boolean"==typeof t&&(!0!==t||o&&(0,f.isStr)(o))?r(w(n)):a("CMP returned unexpected value during lookup process.",n)}function w(n){return s={consentString:n?n.tcString:void 0,vendorData:n||void 0,gdprApplies:n&&"boolean"==typeof n.gdprApplies?n.gdprApplies:i},n&&n.addtlConsent&&(0,f.isStr)(n.addtlConsent)&&(s.addtlConsent=n.addtlConsent),s.apiVersion=2,s}p.vc.getConfig("consentManagement",(function(n){return function(n){if((n=n&&(n.gdpr||n.usp||n.gpp?n.gdpr:n))&&"object"===(0,u.Z)(n)){var e;(0,f.isStr)(n.cmpApi)?o=n.cmpApi:(o="iab",(0,f.logInfo)("consentManagement config did not specify cmp.  Using system default setting (".concat("iab",")."))),(0,f.isNumber)(n.timeout)?r=n.timeout:(r=1e4,(0,f.logInfo)("consentManagement config did not specify timeout.  Using system default setting (".concat(1e4,")."))),c=(0,f.isNumber)(n.actionTimeout)?n.actionTimeout:null,i=!0===n.defaultGdprScope,(0,f.logInfo)("consentManagement module has been activated..."),"static"===o&&((0,f.isPlainObject)(n.consentData)?(null!=(null===(e=a=n.consentData)||void 0===e?void 0:e.getTCData)&&(a=a.getTCData),r=0):(0,f.logError)("consentManagement config with cmpApi: 'static' did not specify consentData. No consents will be available to adapters.")),P||(0,l.R)().requestBids.before(h,50),P=!0,g.rp.enable(),S()}else(0,f.logWarn)("consentManagement (gdpr) config not defined, exiting consent manager")}(n.consentManagement)})),y.S.before((function(n,e){return n(e.then((function(n){var e=g.rp.getConsentData();return e&&("boolean"==typeof e.gdprApplies&&(0,d.N)(n,"regs.ext.gdpr",e.gdprApplies?1:0),(0,d.N)(n,"user.ext.consent",e.consentString)),n})))})),(0,b.f8)({type:b.Z,name:"gdprAddtlConsent",fn:function(n,e){var t,o=null===(t=e.gdprConsent)||void 0===t?void 0:t.addtlConsent;o&&"string"==typeof o&&(0,d.N)(n,"user.ext.ConsentedProvidersSettings.consented_providers",o)}}),(0,l.z)("consentManagement")},26372:function(n,e,t){t.d(e,{DZ:function(){return a},Px:function(){return c},TP:function(){return u},YC:function(){return s},Z:function(){return i},f8:function(){return g},fP:function(){return m},gm:function(){return o},md:function(){return l}});var o=["request","imp","bidResponse","response"],r=["default","pbs"],i=o[0],a=o[1],c=o[2],s=o[3],u=r[0],l=r[1],f=new Set(o);var d,p=(d={},{registerOrtbProcessor:function(n){var e=n.type,t=n.name,r=n.fn,i=n.priority,a=void 0===i?0:i,c=n.dialects,s=void 0===c?[u]:c;if(!f.has(e))throw new Error("ORTB processor type must be one of: ".concat(o.join(", ")));s.forEach((function(n){d.hasOwnProperty(n)||(d[n]={}),d[n].hasOwnProperty(e)||(d[n][e]={}),d[n][e][t]={priority:a,fn:r}}))},getProcessors:function(n){return d[n]||{}}}),g=p.registerOrtbProcessor,m=p.getProcessors}},function(n){n.O(0,[17968],(function(){return e=55630,n(n.s=e);var e}));n.O()}]);
(self.pbjsChunk=self.pbjsChunk||[]).push([[69168],{30277:function(n,t,e){var r=e(71002),i=e(97326),o=e(60136),a=e(82963),c=e(61120);function u(n,t){for(;!Object.prototype.hasOwnProperty.call(n,t)&&null!==(n=(0,c.Z)(n)););return n}function s(){return s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(n,t,e){var r=u(n,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?n:e):i.value}},s.apply(this,arguments)}var l=e(93324),p=e(4942),f=e(18916),g=e(43144),d=e(15671),v=e(89062),h=e(78640),m=e(64358),y=e(96475),b=e(3193),P=e(34516),w=e(99128),S=e(54078),Z=e(52712),C=e(68792),O=e(16310);function k(n){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(n){return!1}}();return function(){var e,r=(0,c.Z)(n);if(t){var i=(0,c.Z)(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return(0,a.Z)(this,e)}}function M(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,r)}return e}function j(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?M(Object(e),!0).forEach((function(t){(0,p.Z)(n,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):M(Object(e)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}))}return n}function E(n,t,e){!function(n,t){if(t.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}(n,t),t.set(n,e)}function T(n,t){var e=function(n,t,e){if(!t.has(n))throw new TypeError("attempted to "+e+" private field on non-instance");return t.get(n)}(n,t,"set");return function(n,t){if(t.set)return"__destrObj"in t||(t.__destrObj={set value(e){t.set.call(n,e)}}),t.__destrObj;if(!t.writable)throw new TypeError("attempted to set read only private field");return t}(n,e)}var D,I,R,G,N=!1;function A(n,t){var e=t.onSuccess,r=t.onError;new C.Z((function(t){return t(n())})).then(e,(function(n){n instanceof _?r.apply(void 0,[n.message].concat((0,v.Z)(n.args))):r("GPP error:",n)}))}var W="1.0",_=(0,g.Z)((function n(t,e){(0,d.Z)(this,n),this.message=t,this.args=null==e?[]:[e]})),z=new WeakMap,L=new WeakMap,U=new WeakMap,V=function(){function n(t,e){var r=this;(0,d.Z)(this,n),E(this,z,{writable:!0,value:void 0}),E(this,L,{writable:!0,value:void 0}),E(this,U,{writable:!0,value:[]}),(0,p.Z)(this,"initialized",!1),this.apiVersion=this.constructor.apiVersion,this.cmpVersion=e,this.cmp=e;var i=[0,1].map((function(n){return function(t){for(;(0,f.Z)(r,U).length;)(0,f.Z)(r,U).pop()[n](t)}})),o=(0,l.Z)(i,2);T(this,z).value=o[0],T(this,L).value=o[1]}return(0,g.Z)(n,[{key:"init",value:function(n){var t=this,e=this.updateWhenReady(n);return this.initialized||(this.initialized=!0,this.cmp({command:"addEventListener",callback:function(n,e){var r;null==e||e?"error"===(null==n||null===(r=n.pingData)||void 0===r?void 0:r.cmpStatus)?(0,f.Z)(t,L).call(t,new _('CMP status is "error"; please check CMP setup',n)):t.isCMPReady((null==n?void 0:n.pingData)||{})&&t.events.includes(null==n?void 0:n.eventName)&&(0,f.Z)(t,z).call(t,t.updateConsent(n.pingData)):(0,f.Z)(t,L).call(t,new _("Received error response from CMP",n))}})),e}},{key:"refresh",value:function(){return this.cmp({command:"ping"}).then(this.updateWhenReady.bind(this))}},{key:"updateConsent",value:function(n){return this.getGPPData(n).then((function(n){if(null==n||(0,m.isEmpty)(n))throw new _("Received empty response from CMP",n);return X(n)})).then((function(n){return(0,m.logInfo)("Retrieved GPP consent from CMP:",n),n}))}},{key:"nextUpdate",value:function(){var n=this;return new C.Z((function(t,e){(0,f.Z)(n,U).push([t,e])}))}},{key:"updateWhenReady",value:function(n){return this.isCMPReady(n)?this.updateConsent(n):this.nextUpdate()}}],[{key:"register",value:function(n){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.apiVersion=n,this.CLIENTS[n]=this,t&&(this.CLIENTS.default=this)}},{key:"init",value:function(){var n=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z.b6;return null==this.INST&&(this.INST=this.ping(t).catch((function(t){throw n.INST=null,t}))),this.INST.then((function(n){var t=(0,l.Z)(n,2),e=t[0],r=t[1];return[e,e.initialized?e.refresh():e.init(r)]}))}},{key:"ping",value:function(){var n=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z.b6,e={apiName:"__gpp",apiArgs:["command","callback","parameter"]},r=t(j(j({},e),{},{mode:Z.kX}));return new C.Z((function(i,o){if(null!=r){var a=!1,c=function(r,c){if(!a)if(null==c||c){if(null!=r){a=!0;var u=null==r?void 0:r.gppVersion,s=n.getClient(u);u!==s.apiVersion?(0,m.logWarn)("Unrecognized GPP CMP version: ".concat(u,". Continuing using GPP API version ").concat(s,"...")):(0,m.logInfo)("Using GPP version ".concat(u));var l=s.apiVersion===W?Z.sM:Z.m1,p=new s(u,t(j(j({},e),{},{mode:l})));i([p,r])}}else o(r)};r({command:"ping",callback:c}).then((function(n){return c(n,!0)}),o)}else o(new _("GPP CMP not found"))})).finally((function(){r&&r.close()}))}},{key:"getClient",value:function(n){return this.CLIENTS.hasOwnProperty(n)?this.CLIENTS[n]:this.CLIENTS.default}}]),n}();(0,p.Z)(V,"CLIENTS",{}),(0,p.Z)(V,"INST",void 0);var x=function(n){(0,o.Z)(e,n);var t=k(e);function e(){var n;(0,d.Z)(this,e);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return n=t.call.apply(t,[this].concat(o)),(0,p.Z)((0,i.Z)(n),"events",["sectionChange","cmpStatus"]),n}return(0,g.Z)(e,[{key:"isCMPReady",value:function(n){return"loaded"===n.cmpStatus}},{key:"getGPPData",value:function(n){var t=this,e=C.Z.all((n.supportedAPIs||n.apiSupport||[]).map((function(n){return t.cmp({command:"getSection",parameter:n}).catch((function(t){(0,m.logWarn)("Could not retrieve GPP section '".concat(n,"'"),t)})).then((function(t){return[n,t]}))}))).then((function(n){return Object.fromEntries(n.filter((function(n){var t=(0,l.Z)(n,2);t[0];return null!=t[1]})).map((function(n){var t=(0,l.Z)(n,2),e=t[0],r=t[1],i=[Object.fromEntries(Object.entries(r).filter((function(n){return"Gpc"!==(0,l.Z)(n,1)[0]})))];return null!=r.Gpc&&i.push({SubsectionType:1,Gpc:r.Gpc}),[e,i]})))}));return C.Z.all([this.cmp({command:"getGPPData"}),e]).then((function(n){var t=(0,l.Z)(n,2),e=t[0],r=t[1];return Object.assign({},e,{parsedSections:r})}))}}]),e}(V);s((0,c.Z)(x),"register",x).call(x,W);var B=function(n){(0,o.Z)(e,n);var t=k(e);function e(){var n;(0,d.Z)(this,e);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return n=t.call.apply(t,[this].concat(o)),(0,p.Z)((0,i.Z)(n),"events",["sectionChange","signalStatus"]),n}return(0,g.Z)(e,[{key:"isCMPReady",value:function(n){return"ready"===n.signalStatus}},{key:"getGPPData",value:function(n){return C.Z.resolve(n)}}]),e}(V);s((0,c.Z)(B),"register",B).call(B,"1.1",!0);var J={iab:function(n){var t=n.onSuccess,e=n.onError,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Z.b6;A((function(){return V.init(r).then((function(n){var t=(0,l.Z)(n,2);t[0];return t[1]}))}),{onSuccess:t,onError:e})},static:function(n){return A((function(){return X(R)}),n)}};function H(n){var t=!1,e=null;function r(r,i,o){if(null!=e&&clearTimeout(e),t=!0,P.TJ.setConsentData(r),"function"==typeof n){for(var a=arguments.length,c=new Array(a>3?a-3:0),u=3;u<a;u++)c[u-3]=arguments[u];n.apply(void 0,[i,o].concat(c))}}if(J.hasOwnProperty(D)){var i={onSuccess:function(n){return r(n,!1)},onError:function(n){for(var t=arguments.length,e=new Array(t>1?t-1:0),i=1;i<t;i++)e[i-1]=arguments[i];r.apply(void 0,[null,!0,n].concat(e))}};if(J[D](i),!t){var o=function(){var n=function(n){r(n,!1,"GPP CMP did not load, continuing auction...")};A((function(){return X(G)}),{onSuccess:n,onError:function(){return n(F())}})};0===I?o():e=setTimeout(o,I)}}else r(null,!1,"GPP CMP framework (".concat(D,") is not a supported framework.  Aborting consentManagement module and resuming auction."))}var q=(0,w.g3)("gpp",(function(n,t){var e;e=function(e,r){if(r){var i=m.logWarn;e&&(i=m.logError,r="".concat(r," Canceling auction as per consentManagement config."));for(var o=arguments.length,a=new Array(o>2?o-2:0),c=2;c<o;c++)a[c-2]=arguments[c];i.apply(void 0,[r].concat(a))}e?(n.stopTiming(),"function"==typeof t.bidsBackHandler?t.bidsBackHandler():(0,m.logError)("Error executing bidsBackHandler")):n.call(this,t)},G?((0,m.logInfo)("User consent information already known.  Pulling internally stored information..."),e(!1)):H(e)}));function X(n){if(null!=(null==n?void 0:n.applicableSections)&&!Array.isArray(n.applicableSections)||null!=(null==n?void 0:n.gppString)&&!(0,m.isStr)(n.gppString)||null!=(null==n?void 0:n.parsedSections)&&!(0,m.isPlainObject)(n.parsedSections))throw new _("CMP returned unexpected value during lookup process.",n);return F(n)}function F(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return G={gppString:null==n?void 0:n.gppString,applicableSections:(null==n?void 0:n.applicableSections)||[],parsedSections:(null==n?void 0:n.parsedSections)||{},gppData:n},P.TJ.setConsentData(n),G}b.vc.getConfig("consentManagement",(function(n){return function(n){(n=n&&n.gpp)&&"object"===(0,r.Z)(n)?((0,m.isStr)(n.cmpApi)?D=n.cmpApi:(D="iab",(0,m.logInfo)("consentManagement.gpp config did not specify cmp.  Using system default setting (".concat("iab",")."))),(0,m.isNumber)(n.timeout)?I=n.timeout:(I=1e4,(0,m.logInfo)("consentManagement.gpp config did not specify timeout.  Using system default setting (".concat(1e4,")."))),"static"===D&&((0,m.isPlainObject)(n.consentData)?(R=n.consentData,I=0):(0,m.logError)("consentManagement.gpp config with cmpApi: 'static' did not specify consentData. No consents will be available to adapters.")),(0,m.logInfo)("consentManagement.gpp module has been activated..."),N||((0,h.R)().requestBids.before(q,50),O.Ww.before((function(n,t){return n(Object.assign({gppConsent:P.TJ.getConsentData()},t))}))),N=!0,P.TJ.enable(),H()):(0,m.logWarn)("consentManagement.gpp config not defined, exiting consent manager module")}(n.consentManagement)})),S.S.before((function(n,t){return n(t.then((function(n){var t=P.TJ.getConsentData();return t&&(Array.isArray(t.applicableSections)&&(0,y.N)(n,"regs.gpp_sid",t.applicableSections),(0,y.N)(n,"regs.gpp",t.gppString)),n})))})),(0,h.z)("consentManagementGpp")}},function(n){n.O(0,[17968],(function(){return t=30277,n(n.s=t);var t}));n.O()}]);
(self.pbjsChunk=self.pbjsChunk||[]).push([[5160],{9099:function(n,t,e){var o,a,c=e(71002),i=e(78640),r=e(64358),s=e(96475),u=e(3193),l=e(86104),g=e(34516),f=e(99128),p=e(92797),d=e(54078),m=e(52712),v="iab",P=v,b=50,S=!1,D={iab:function(n){var t=n.onSuccess,e=n.onError;var o=(c={},{consentDataCallback:function(n,o){o&&n.uspString&&(c.usPrivacy=n.uspString),c.usPrivacy?U(c,{onSuccess:t,onError:e}):e("Unable to get USP consent string.")}}),a=(0,m.b6)({apiName:"__uspapi",apiVersion:1,apiArgs:["command","version","callback"]});var c;if(!a)return e("USP CMP not found.");a.isDirect?(0,r.logInfo)("Detected USP CMP is directly accessible, calling it now..."):(0,r.logInfo)("Detected USP CMP is outside the current iframe where Prebid.js is located, calling it now...");a({command:"getUSPData",callback:o.consentDataCallback}),a({command:"registerDeletion",callback:function(n,t){return(null==t||t)&&l.ZP.callDataDeletionRequest(n)}}).catch((function(n){(0,r.logError)("Error invoking CMP `registerDeletion`:",n)}))},static:function(n){var t=n.onSuccess,e=n.onError;U(o,{onSuccess:t,onError:e})}};function y(n){var t=null,e=!1;function o(o,a){if(null!=t&&clearTimeout(t),e=!0,g.nX.setConsentData(o),null!=n){for(var c=arguments.length,i=new Array(c>2?c-2:0),r=2;r<c;r++)i[r-2]=arguments[r];n.apply(void 0,[a].concat(i))}}if(D[P]){var a={onSuccess:o,onError:function(n){for(var t=arguments.length,e=new Array(t>1?t-1:0),a=1;a<t;a++)e[a-1]=arguments[a];o.apply(void 0,[null,"".concat(n," Resuming auction without consent data as per consentManagement config.")].concat(e))}};D[P](a),e||(0===b?U(void 0,a):t=setTimeout(a.onError.bind(null,"USPAPI workflow exceeded timeout threshold."),b))}else o(null,"USP framework (".concat(P,") is not a supported framework. Aborting consentManagement module and resuming auction."))}var h=(0,f.g3)("usp",(function(n,t){var e=this;S||M(),y((function(o){if(null!=o){for(var a=arguments.length,c=new Array(a>1?a-1:0),i=1;i<a;i++)c[i-1]=arguments[i];r.logWarn.apply(void 0,[o].concat(c))}n.call(e,t)}))}));function U(n,t){var e=t.onSuccess,o=t.onError;!n||!n.usPrivacy?o("USPAPI returned unexpected value during lookup process.",n):(!function(n){n&&n.usPrivacy&&(a=n.usPrivacy)}(n),e(a))}function M(){var n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];S||((0,r.logInfo)("USPAPI consentManagement module has been activated".concat(n?"":" using default values (api: '".concat(P,"', timeout: ").concat(b,"ms)"))),S=!0,g.nX.enable()),y()}u.vc.getConfig("consentManagement",(function(n){return function(n){(n=n&&n.usp)&&"object"===(0,c.Z)(n)||(0,r.logWarn)("consentManagement.usp config not defined, using defaults"),n&&(0,r.isStr)(n.cmpApi)?P=n.cmpApi:(P=v,(0,r.logInfo)("consentManagement.usp config did not specify cmpApi. Using system default setting (".concat(v,")."))),n&&(0,r.isNumber)(n.timeout)?b=n.timeout:(b=50,(0,r.logInfo)("consentManagement.usp config did not specify timeout. Using system default setting (".concat(50,")."))),"static"===P&&((0,r.isPlainObject)(n.consentData)&&(0,r.isPlainObject)(n.consentData.getUSPData)?(n.consentData.getUSPData.uspString&&(o={usPrivacy:n.consentData.getUSPData.uspString}),b=0):(0,r.logError)("consentManagement config with cmpApi: 'static' did not specify consentData. No consents will be available to adapters.")),M(!0)}(n.consentManagement)})),(0,p.v5)("requestBids").before(h,50),d.S.before((function(n,t){return n(t.then((function(n){var t=g.nX.getConsentData();return t&&(0,s.N)(n,"regs.ext.us_privacy",t),n})))})),(0,i.z)("consentManagementUsp")}},function(n){n.O(0,[17968],(function(){return t=9099,n(n.s=t);var t}));n.O()}]);
(self.pbjsChunk=self.pbjsChunk||[]).push([[79073],{7713:function(e,o,n){var t=n(78640),r=n(64358),a=n(48928),i=n(25102),c=n(92797),l=n(15164),d=n(9633),u=n(34516),s="criteo",p=(0,l.df)({moduleType:d.y2,moduleName:s}),g="cto_bidid",v="cto_bundle",m="html5",f="cookie",b=new Date(0).toString(),y=new Date((0,r.timestamp)()+33696e6).toString();function I(e){var o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=(0,r.parseUrl)(e,{noDecodeWholeURL:!0});return o?"".concat(n.hostname):"".concat(n.protocol,"://").concat(n.hostname).concat(n.port?":"+n.port:"","/")}function h(e,o){var n,t;return(null==e||null===(n=e.storage)||void 0===n?void 0:n.type)===m?p.getDataFromLocalStorage(o):(null==e||null===(t=e.storage)||void 0===t?void 0:t.type)===f?p.getCookie(o):p.getCookie(o)||p.getDataFromLocalStorage(o)}function S(e,o,n,t){var r,a;o&&n&&((null==e||null===(r=e.storage)||void 0===r?void 0:r.type)===m?p.setDataInLocalStorage(o,n):((null==e||null===(a=e.storage)||void 0===a?void 0:a.type)===f||p.setDataInLocalStorage(o,n),C(o,n,y,t,!0)))}function C(e,o,n,t,r){for(var a=t.split("."),i=0;i<a.length;++i){var c=a.slice(a.length-i-1,a.length).join(".");try{if(p.setCookie(e,o,n,null,"."+c),r){var l=p.getCookie(e);if(l&&l===o)break}}catch(e){}}}function U(e,o,n){var t,c,l,d,s=(void 0===(null==e||null===(t=e.storage)||void 0===t?void 0:t.type)||(null==e||null===(c=e.storage)||void 0===c?void 0:c.type)===f)&&p.cookiesAreEnabled(),y=(void 0===(null==e||null===(l=e.storage)||void 0===l?void 0:l.type)||(null==e||null===(d=e.storage)||void 0===d?void 0:d.type)===m)&&p.localStorageIsEnabled(),h=I((0,i.nH)().page),U=I(document.location.href,!0),w="undefined"!=typeof criteo_pubtag,D=function(e,o,n,t,r,a,i){var c="https://gum.criteo.com/sid/json?origin=prebid"+"".concat(e?"&topUrl="+encodeURIComponent(e):"")+"".concat(o?"&domain="+encodeURIComponent(o):"")+"".concat(n?"&bundle="+encodeURIComponent(n):"")+"".concat(t?"&info="+encodeURIComponent(t):"")+"".concat(r?"&cw=1":"")+"".concat(i?"&pbt=1":"")+"".concat(a?"&lsw=1":""),l=u.nX.getConsentData();l&&(c+="&us_privacy=".concat(encodeURIComponent(l)));var d=u.rp.getConsentData();d&&(c+="".concat(d.consentString?"&gdprString="+encodeURIComponent(d.consentString):""),c+="&gdpr=".concat(!0===d.gdprApplies?1:0));var s=u.TJ.getConsentData();return s&&(c+="".concat(s.gppString?"&gpp="+encodeURIComponent(s.gppString):""),c+="".concat(s.applicableSections?"&gpp_sid="+encodeURIComponent(s.applicableSections):"")),c}(h,U,o.bundle,o.dnaBundle,s,y,w),k={success:function(o){var t,i=JSON.parse(o);(i.pixels&&i.pixels.forEach((function(o){return function(e,o,n){n.writeBundleInStorage&&n.bundlePropertyName&&n.storageKeyName?(0,a.hj)(n.pixelUrl,{success:function(t){if(t){var r=JSON.parse(t);r&&r[n.bundlePropertyName]&&S(e,n.storageKeyName,r[n.bundlePropertyName],o)}},error:function(e){(0,r.logError)("criteoIdSystem: unable to sync user id",e)}},void 0,{method:"GET",withCredentials:!0}):(0,r.triggerPixel)(n.pixelUrl)}(e,U,o)})),i.acwsUrl)?("string"==typeof i.acwsUrl?[i.acwsUrl]:i.acwsUrl).forEach((function(e){return(0,r.triggerPixel)(e)})):i.bundle&&S(e,v,i.bundle,U);if(i.bidId){S(e,g,i.bidId,U);var c={criteoId:i.bidId};n(c)}else C(t=g,"",b,U,!0),p.removeDataFromLocalStorage(t),n()},error:function(e){(0,r.logError)("criteoIdSystem: unable to sync user id",e),n()}};(0,a.hj)(D,k,void 0,{method:"GET",contentType:"application/json",withCredentials:!0})}var w={name:s,gvlid:91,decode:function(e){return e},getId:function(e){var o=function(e){return{bundle:h(e,v),dnaBundle:h(e,"cto_dna_bundle"),bidId:h(e,g)}}(e);return{id:o.bidId?{criteoId:o.bidId}:void 0,callback:function(n){return U(e,o,n)}}},eids:{criteoId:{source:"criteo.com",atype:1}}};(0,c.Bx)("userId",w),(0,t.z)("criteoIdSystem")}},function(e){var o;o=7713,e(e.s=o)}]);
(self.pbjsChunk=self.pbjsChunk||[]).push([[99226],{72663:function(r,e,n){var o,c=n(71002),t=n(78640),i=n(64358),s=n(5644),u=n(48928),a=n(3193),f=n(92797),l=n(68792),d=n(26372),v=n(99128),y="https://cdn.jsdelivr.net/gh/prebid/currency-file@1/latest.json?date=$$TODAY$$",g=[],p={},h=!1,C=!0,b="USD",R=!1,m={},w={},S=(0,l.P)();function D(r){o?((0,i.logWarn)(r),(0,i.logWarn)("Currency failed loading rates, falling back to currency.defaultRates")):(0,i.logError)(r)}function P(r){p={},R=!0,(0,i.logInfo)("Installing addBidResponse decorator for currency module",arguments),(0,t.R)().convertCurrency=function(r,e,n){return parseFloat(r)*k(e,n)},(0,f.v5)("addBidResponse").before(O,100),(0,f.v5)("responsesReady").before(I),C&&(C=!1,(0,u.hj)(r,{success:function(r){try{m=JSON.parse(r),(0,i.logInfo)("currencyRates set to "+JSON.stringify(m)),p={},h=!0,j()}catch(e){D("Failed to parse currencyRates response: "+r)}},error:function(){D.apply(void 0,arguments)}}))}function F(){(0,i.logInfo)("Uninstalling addBidResponse decorator for currency module",arguments),(0,f.v5)("addBidResponse").getHooks({hook:O}).remove(),(0,f.v5)("responsesReady").getHooks({hook:I}).remove(),delete(0,t.R)().convertCurrency,b="USD",p={},R=!1,h=!1,C=!0,m={},w={},S=(0,l.P)()}function I(r,e){r(e.then((function(){return S.promise})))}a.vc.getConfig("currency",(function(r){return function(r){var e=y;if("object"===(0,c.Z)(r.rates)&&(m.conversions=r.rates,h=!0,C=!1),"object"===(0,c.Z)(r.defaultRates)&&(o=r.defaultRates,m.conversions=o,h=!0),"string"==typeof r.adServerCurrency){(0,i.logInfo)("enabling currency support",arguments),b=r.adServerCurrency,r.conversionRateFile&&((0,i.logInfo)("currency using override conversionRateFile:",r.conversionRateFile),e=r.conversionRateFile);var n=e.indexOf("$$TODAY$$");if(-1!==n){var t=new Date,s="".concat(t.getMonth()+1),u="".concat(t.getDate());s.length<2&&(s="0".concat(s)),u.length<2&&(u="0".concat(u));var a="".concat(t.getFullYear()).concat(s).concat(u);e="".concat(e.substring(0,n)).concat(a).concat(e.substring(n+9,e.length))}P(e)}else(0,i.logInfo)("disabling currency support"),F();"object"===(0,c.Z)(r.bidderCurrencyDefault)&&(w=r.bidderCurrencyDefault)}(r.currency)}));var O=(0,v.A)("currency",(function(r,e,n,o){if(!n)return r.call(this,e,n,o);var c=n.bidderCode||n.bidder;if(w[c]){var t=w[c];n.currency&&t!==n.currency?(0,i.logWarn)("Currency default '".concat(c,": ").concat(t,"' ignored. adapter specified '").concat(n.currency,"'")):n.currency=t}if(n.currency||((0,i.logWarn)('Currency not specified on bid.  Defaulted to "USD"'),n.currency="USD"),n.getCpmInNewCurrency=function(r){return(parseFloat(this.cpm)*k(this.currency,r)).toFixed(3)},n.currency===b)return r.call(this,e,n,o);g.push(function(r,e,n){return function(){var o=n[1];if(void 0!==o&&"currency"in o&&"cpm"in o){var c=o.currency;try{var t=k(c);1!==t&&(o.cpm=(parseFloat(o.cpm)*t).toFixed(4),o.currency=b)}catch(r){return(0,i.logWarn)("getCurrencyConversion threw error: ",r),void n[2](s.Gw.Xx)}}return r.apply(e,n)}}(r,this,[e,n,o])),R&&!h||j()}));function j(){for(;g.length>0;)g.shift()();S.resolve()}function k(r){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b,o=null,c="".concat(r,"->").concat(n);if(c in p)o=p[c],(0,i.logMessage)("Using conversionCache value "+o+" for "+c);else if(!1===R){if("USD"!==r)throw new Error("Prebid currency support has not been enabled and fromCurrency is not USD");o=1}else if(r===n)o=1;else if(r in m.conversions){if(!(n in(e=m.conversions[r])))throw new Error("Specified adServerCurrency in config '"+n+"' not found in the currency rates file");o=e[n],(0,i.logInfo)("getCurrencyConversion using direct "+r+" to "+n+" conversionRate "+o)}else if(n in m.conversions){if(!(r in(e=m.conversions[n])))throw new Error("Specified fromCurrency '"+r+"' not found in the currency rates file");o=E(1/e[r],4),(0,i.logInfo)("getCurrencyConversion using reciprocal "+r+" to "+n+" conversionRate "+o)}else{var t=Object.keys(m.conversions)[0];if(!(r in m.conversions[t]))throw new Error("Specified fromCurrency '"+r+"' not found in the currency rates file");var s=1/m.conversions[t][r];if(!(n in m.conversions[t]))throw new Error("Specified adServerCurrency in config '"+n+"' not found in the currency rates file");var u=m.conversions[t][n];o=E(s*u,4),(0,i.logInfo)("getCurrencyConversion using intermediate "+r+" thru "+t+" to "+n+" conversionRate "+o)}return c in p||((0,i.logMessage)("Adding conversionCache value "+o+" for "+c),p[c]=o),o}function E(r,e){for(var n=1,o=0;o<e;o++)n+="0";return Math.round(r*n)/n}(0,d.f8)({type:d.Z,name:"currency",fn:function(r,e,n){R&&(r.cur=r.cur||[n.currency||b])}}),(0,t.z)("currency")},26372:function(r,e,n){n.d(e,{DZ:function(){return i},Px:function(){return s},TP:function(){return a},YC:function(){return u},Z:function(){return t},f8:function(){return y},fP:function(){return g},gm:function(){return o},md:function(){return f}});var o=["request","imp","bidResponse","response"],c=["default","pbs"],t=o[0],i=o[1],s=o[2],u=o[3],a=c[0],f=c[1],l=new Set(o);var d,v=(d={},{registerOrtbProcessor:function(r){var e=r.type,n=r.name,c=r.fn,t=r.priority,i=void 0===t?0:t,s=r.dialects,u=void 0===s?[a]:s;if(!l.has(e))throw new Error("ORTB processor type must be one of: ".concat(o.join(", ")));u.forEach((function(r){d.hasOwnProperty(r)||(d[r]={}),d[r].hasOwnProperty(e)||(d[r][e]={}),d[r][e][n]={priority:i,fn:c}}))},getProcessors:function(r){return d[r]||{}}}),y=v.registerOrtbProcessor,g=v.getProcessors}},function(r){var e;e=72663,r(r.s=e)}]);
(self.pbjsChunk=self.pbjsChunk||[]).push([[57748],{81694:function(n,o,t){function e(n,o){return function(){for(var t,e,i=document.domain.split("."),u="_gd".concat(Date.now(),"_").concat(o),c=0;c<i.length;c++){var r=i.slice(c).join(".");if(n.setCookie(u,"1",void 0,void 0,r),e=n.getCookie(u),n.setCookie(u,"","Thu, 01 Jan 1970 00:00:01 GMT",void 0,r),"1"!==e)return t;t=r}}}t.d(o,{U:function(){return e}})}}]);
(self.pbjsChunk=self.pbjsChunk||[]).push([[87083],{31498:function(n,e,r){var t=r(93324),o=r(78640),u=r(64358),i=r(20265),a=r(3193),c=r(86104),l=r(34516),s=r(52021),p=r(5644),f=r(9633),d=r(16310),v=r(50571),g=r(74947);function h(n,e){var r="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!r){if(Array.isArray(n)||(r=function(n,e){if(!n)return;if("string"==typeof n)return y(n,e);var r=Object.prototype.toString.call(n).slice(8,-1);"Object"===r&&n.constructor&&(r=n.constructor.name);if("Map"===r||"Set"===r)return Array.from(n);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return y(n,e)}(n))||e&&n&&"number"==typeof n.length){r&&(n=r);var t=0,o=function(){};return{s:o,n:function(){return t>=n.length?{done:!0}:{done:!1,value:n[t++]}},e:function(n){throw n},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u,i=!0,a=!1;return{s:function(){r=r.call(n)},n:function(){var n=r.next();return i=n.done,n},e:function(n){a=!0,u=n},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw u}}}}function y(n,e){(null==e||e>n.length)&&(e=n.length);for(var r=0,t=new Array(e);r<e;r++)t[r]=n[r];return t}var m={purpose:{},feature:{}},b={purpose:"purpose.consents",feature:"specialFeatureOptins"},E={storage:{type:"purpose",default:{purpose:"storage",enforcePurpose:!0,enforceVendor:!0,vendorExceptions:[]},id:1},basicAds:{type:"purpose",id:2,default:{purpose:"basicAds",enforcePurpose:!0,enforceVendor:!0,vendorExceptions:[]}},personalizedAds:{type:"purpose",id:4},measurement:{type:"purpose",id:7},transmitPreciseGeo:{type:"feature",id:1}},w=new Set,A=new Set,k=new Set,B=new Set,S=new Set,P=new Set,C=!1,D=!1,I=[f.UL,f.y2,f._U,f.XG],O="TCF2",j=[],x=[2];function F(n,e,r){if(e){var t=a.vc.getConfig("gvlMapping");if(t&&t[e])return t[e];if(n===f.wu)return l.$P;var o=l.qh.get(e),i=o.gvlid,c=o.modules;if(null==i&&Object.keys(c).length>0){var s,p=h(I);try{for(p.s();!(s=p.n()).done;){var d=s.value;if(c.hasOwnProperty(d)){i=c[d],d!==n&&(0,u.logWarn)("Multiple GVL IDs found for module '".concat(e,"'; using the ").concat(d," module's ID (").concat(i,") instead of the ").concat(n,"'s ID (").concat(c[n],")"));break}}}catch(n){p.e(n)}finally{p.f()}}return null==i&&r&&(i=r()),i||null}return null}function Z(n,e,r){return null==n&&l.rp.enabled?((0,u.logWarn)("Attempting operation that requires purpose ".concat(e," consent while consent data is not available").concat(r?" (module: ".concat(r,")"):"",". Assuming no consent was given.")),!0):n&&n.gdprApplies}function $(n,e,r,t){var o=!!(0,i.Z)(n,"vendorData.".concat(b[e],".").concat(r)),u=!!(0,i.Z)(n,"vendorData.vendor.consents.".concat(t));return"purpose"===e&&x.includes(r)&&(o||(o=!!(0,i.Z)(n,"vendorData.purpose.legitimateInterests.".concat(r))),u||(u=!!(0,i.Z)(n,"vendorData.vendor.legitimateInterests.".concat(t)))),{purpose:o,vendor:u}}function M(n,e,r,t){var o=E[n.purpose];if((n.vendorExceptions||[]).includes(r))return!0;var u=n.enforceVendor&&!(t===l.$P||(n.softVendorExceptions||[]).includes(r)),i=$(e,o.type,o.id,t),a=i.purpose,c=i.vendor;return(!n.enforcePurpose||a)&&(!u||c)}function T(n,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return null};return function(o){var u=l.rp.getConsentData(),i=o[d.bp];if(Z(u,n,i)){var a=F(o[d.$k],i,t(o)),c=!!e(u,i,a);if(!c)return r&&r.add(i),{allow:c}}}}function V(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return null};return T(n,(function(e,r,t){return!!M(m.purpose[n],e,r,t)}),e,r)}function U(n){return function(e){if(e[d.$k]!==f.wu)return n(e)}}var N,q,G,L=(N=V(1,w),function(n){if(n[d.$k]!==f.wu||D)return N(n)}),W=V(1,w),_=V(1,w),z=U(V(2,A)),K=V(7,k,(function(n){return e=n[d.bp],r=n[d.Hw],function(n){if("function"!=typeof n)return n;try{return n.call(o.adapter,r)}catch(n){(0,u.logError)("Error invoking ".concat(e," adapter.gvlid()"),n)}}(null==(o=c.ZP.getAnalyticsAdapter(e))||null===(t=o.adapter)||void 0===t?void 0:t.gvlid);var e,r,t,o})),R=V(4,B),H=U((q=T("2-10",(function(n,e,r){for(var t=2;t<=10;t++){var o,u,i,a;if(null!==(o=m.purpose[t])&&void 0!==o&&null!==(u=o.vendorExceptions)&&void 0!==u&&u.includes(e))return!0;var c=$(n,"purpose",t,r),l=c.purpose,s=c.vendor;if(l&&(s||null!==(i=m.purpose[t])&&void 0!==i&&null!==(a=i.softVendorExceptions)&&void 0!==a&&a.includes(e)))return!0}return!1}),S),G=V(4,S),function(){var n,e=null!==(n=m.purpose[4])&&void 0!==n&&n.eidsRequireP4Consent?G:q;return e.apply(this,arguments)})),X=T("Special Feature 1",(function(n,e,r){return M(m.feature[1],n,e,r)}),P);s.on(p.FP.AUCTION_END,(function(){var n=function(n){return Array.from(n.keys()).filter((function(n){return null!=n}))},e={storageBlocked:n(w),biddersBlocked:n(A),analyticsBlocked:n(k),ufpdBlocked:n(B),eidsBlocked:n(S),geoBlocked:n(P)};s.emit(p.FP.TCF2_ENFORCEMENT,e),[w,A,k,B,S,P].forEach((function(n){return n.clear()}))})),a.vc.getConfig("consentManagement",(function(n){return function(n){var e=(0,i.Z)(n,"gdpr.rules");e||(0,u.logWarn)("TCF2: enforcing P1 and P2 by default"),e=Object.fromEntries((e||[]).map((function(n){return[n.purpose,n]}))),D=!!(0,i.Z)(n,"strictStorageEnforcement"),Object.entries(E).forEach((function(n){var r,o=(0,t.Z)(n,2),u=o[0],i=o[1];m[i.type][i.id]=null!==(r=e[u])&&void 0!==r?r:i.default})),C||(null!=m.purpose[1]&&(C=!0,j.push((0,v.oB)(g.S1,O,L)),j.push((0,v.oB)(g.K$,O,W)),j.push((0,v.oB)(g.EL,O,_))),null!=m.purpose[2]&&j.push((0,v.oB)(g.UE,O,z)),null!=m.purpose[4]&&j.push((0,v.oB)(g.oK,O,R),(0,v.oB)(g.S5,O,R)),null!=m.purpose[7]&&j.push((0,v.oB)(g.x$,O,K)),null!=m.feature[1]&&j.push((0,v.oB)(g.g0,O,X)),j.push((0,v.oB)(g.e,O,H)))}(n.consentManagement)})),(0,o.z)("gdprEnforcement")}},function(n){var e;e=31498,n(n.s=e)}]);
(self.pbjsChunk=self.pbjsChunk||[]).push([[65296],{96787:function(t,o,e){var n=e(78640),a=e(64358),r=e(96475),d=e(20265),i=e(3193),u=e(92797),c=e(34614),s=void 0,f={},l=!1,p=function(t){var o=f.customGptSlotMatching;if((0,a.isGptPubadsDefined)()){var e=t.reduce((function(t,o){return t[o.code]=t[o.code]||[],t[o.code].push(o),t}),{});window.googletag.pubads().getSlots().forEach((function(t){var n=(0,c.sE)(Object.keys(e),o?o(t):(0,a.isAdUnitCodeMatchingSlot)(t));if(n){var d={name:"gam",adslot:b(t.getAdUnitPath())};e[n].forEach((function(t){var o,e,n;(0,r.N)(t,"ortb2Imp.ext.data.adserver",Object.assign({},null===(o=t.ortb2Imp)||void 0===o||null===(e=o.ext)||void 0===e||null===(n=e.data)||void 0===n?void 0:n.adserver,d))}))}}))}},b=function(t){return(i.vc.getConfig("gptPreAuction")||{}).mcmEnabled?t.replace(/(^\/\d*),\d*\//,"$1/"):t},g=function(t,o){var e=t.ortb2Imp.ext.data;if(e.pbadslot)return e.pbadslot;if((0,a.isGptPubadsDefined)()){var n=window.googletag.pubads().getSlots().filter((function(t){return t.getAdUnitPath()===o}));if(0!==n.length)return 1===n.length?o:"".concat(o,"#").concat(t.code)}},v=function(t){var o=t.ortb2Imp.ext.data,e=f.customPbAdSlot;if(!o.pbadslot)if(e)o.pbadslot=e(t.code,(0,d.Z)(o,"adserver.adslot"));else{try{var n=document.getElementById(t.code);if(n.dataset.adslotid)return void(o.pbadslot=n.dataset.adslotid)}catch(t){}if(!(0,d.Z)(o,"adserver.adslot"))return o.pbadslot=t.code,!0;o.pbadslot=o.adserver.adslot}},m=function(t,o){p(o);var e=f,n=e.useDefaultPreAuction,a=e.customPreAuction;o.forEach((function(t){t.ortb2Imp=t.ortb2Imp||{},t.ortb2Imp.ext=t.ortb2Imp.ext||{},t.ortb2Imp.ext.data=t.ortb2Imp.ext.data||{};var o=t.ortb2Imp.ext;if(a||n){var e,r=(0,d.Z)(o,"data.adserver.adslot");a?e=a(t,r):n&&(e=g(t,r)),e&&(o.gpid=o.data.pbadslot=e)}else{var i=v(t);o.gpid||i||(o.gpid=o.data.pbadslot)}}));for(var r=arguments.length,i=new Array(r>2?r-2:0),u=2;u<r;u++)i[u-2]=arguments[u];return t.call.apply(t,[s,o].concat(i))},h=function(t){(f=(0,a.pick)(t,["enabled",function(t){return!1!==t},"customGptSlotMatching",function(t){return"function"==typeof t&&t},"customPbAdSlot",function(t){return"function"==typeof t&&t},"customPreAuction",function(t){return"function"==typeof t&&t},"useDefaultPreAuction",function(t){return!0===t}])).enabled?l||((0,u.v5)("makeBidRequests").before(m),l=!0):((0,a.logInfo)("".concat("GPT Pre-Auction",": Turning off module")),f={},(0,u.v5)("makeBidRequests").getHooks({hook:m}).remove(),l=!1)};i.vc.getConfig("gptPreAuction",(function(t){return h(t.gptPreAuction)})),h({}),(0,n.z)("gptPreAuction")}},function(t){var o;o=96787,t(t.s=o)}]);
(self.pbjsChunk=self.pbjsChunk||[]).push([[93157],{20676:function(n,r,t){t.d(r,{c:function(){return f}});var e=t(89062),u=t(83790),c=t(20265),o=["user.keywords"].concat(u.Iq.flatMap((function(n){return["keywords","content.keywords"].map((function(r){return"".concat(n,".").concat(r)}))})));function a(){for(var n=new Set,r=arguments.length,t=new Array(r),e=0;e<r;e++)t[e]=arguments[e];return t.filter((function(n){return n})).flatMap((function(n){return Array.isArray(n)?n:n.split(",")})).map((function(n){return n.replace(/^\s*/,"").replace(/\s*$/,"")})).filter((function(n){return n})).forEach((function(r){return n.add(r)})),Array.from(n.keys())}function f(n){for(var r=arguments.length,t=new Array(r>1?r-1:0),u=1;u<r;u++)t[u-1]=arguments[u];return a.apply(void 0,(0,e.Z)(o.map((function(r){return(0,c.Z)(n,r)}))).concat(t))}}}]);
(self.pbjsChunk=self.pbjsChunk||[]).push([[2903],{43238:function(e,t,n){var r=n(71002),o=n(89062),i=n(93324),a=n(4942),c=n(78640),s=n(64358),d=n(20265),u=n(96475),l=n(64563),f=n(86104),p=n(5644),g=n(48928),v=n(3193),b=n(15164),I=n(9633);function m(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var D,U,O,w,k,A,j,S=(0,b.df)({moduleType:I._U,moduleName:"magnite"}),T="mgniSession",Z="Magnite Analytics",C=["rubicon"],B={1:"timeout-error",2:"input-error",3:"connect-error",4:"request-error",999:"generic-error"},N=0,R=(0,c.R)(),M=p.FP,L=M.AUCTION_INIT,P=M.AUCTION_END,q=M.BID_REQUESTED,_=M.BID_RESPONSE,W=M.BIDDER_DONE,x=M.BID_TIMEOUT,V=M.BID_WON,z=M.BILLABLE_EVENT,H=M.SEAT_NON_BID,F=M.BID_REJECTED,J=function(){A={auctions:{},auctionOrder:[],timeouts:{},billing:{},pendingEvents:{},eventPending:!1,elementIdMap:{},sessionData:{}},k={pvid:(0,s.generateUUID)().slice(0,8),analyticsEventDelay:500,analyticsBatchTimeout:5e3,analyticsProcessDelay:1,dmBilling:{enabled:!1,vendors:[],waitForAuction:!0},pbaBrowserLocation:"client.browser"}};J(),v.vc.getConfig("rubicon",(function(e){(0,s.mergeDeep)(k,e.rubicon),!0===(0,d.Z)(e,"rubicon.updatePageView")&&(k.pvid=(0,s.generateUUID)().slice(0,8))})),v.vc.getConfig("s2sConfig",(function(e){var t=e.s2sConfig;j=t}));var G=function(){A.pendingEvents.trigger="batched-".concat(Object.keys(A.pendingEvents).sort().join("-")),$(A.pendingEvents),A.pendingEvents={},A.eventPending=!1},Q=function(e,t,n){A.auctions[t]&&!A.auctions[t].sent?A.auctions[t].pendingEvents=(0,s.mergeDeep)(A.auctions[t].pendingEvents,e):k.analyticsEventDelay>0?(A.pendingEvents=(0,s.mergeDeep)(A.pendingEvents,e),A.eventPending||(setTimeout(G,k.analyticsEventDelay),A.eventPending=!0)):(e.trigger="solo-".concat(n),$(e))},$=function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=k.analyticsEndpoint||w;if(o){var i=E(E({},ee()),e);if(r)navigator.sendBeacon(o,JSON.stringify(i));else{if(null!==(t=window.pbjs)&&void 0!==t&&null!==(n=t.rp)&&void 0!==n&&n.eventDispatcher){var a=new CustomEvent("beforeSendingMagniteAnalytics",{detail:i});window.pbjs.rp.eventDispatcher.dispatchEvent(a)}(0,g.hj)(o,null,JSON.stringify(i),{contentType:"application/json"})}}else(0,s.logWarn)("".concat(Z,": Endpoint not initialized, skipping sending event"),e)},K=function(e,t){var n=A.auctions[e],r=X(n.auction);n.sent=!0,$(E(E({auctions:[r]},n.pendingEvents||{}),{},{trigger:t}))},X=function(e){var t,n,r=(0,s.deepClone)(e);return r.dmWebVitals=null==R||null===(t=R.rp)||void 0===t||null===(n=t.getDmWebVitals)||void 0===n?void 0:n.call(t,r.auctionId,!0),r.samplingFactor=1,r.adUnits=Object.entries(r.adUnits).map((function(e){var t=(0,i.Z)(e,2),n=(t[0],t[1]);return n.bids=Object.entries(n.bids).map((function(e){var t=(0,i.Z)(e,2),r=(t[0],t[1]),o=["error","no-bid","success"];return o.indexOf(r.status)>o.indexOf(n.status)&&(n.status=r.status),r.pbsBidId&&(r.oldBidId=r.bidId,r.bidId=r.pbsBidId,delete r.pbsBidId),r})),n})),r},Y=function(e,t){var n=function(e){var t,n;if("number"==typeof(0,d.Z)(e,"floorData.cpmAfterAdjustments"))t=e.floorData.cpmAfterAdjustments,n=e.floorData.floorCurrency;else{if("string"==typeof e.currency&&"USD"===e.currency.toUpperCase())return Number(e.cpm);t=e.cpm,n=e.currency}if("USD"===n)return Number(t);try{return Number(R.convertCurrency(t,n,"USD"))}catch(r){return(0,s.logWarn)("".concat(Z,": Could not determine the bidPriceUSD of the bid "),e),e.conversionError=!0,e.ogCurrency=n,e.ogPrice=t,0}}(e);return t&&t.bidPriceUSD>n?t:(0,s.pick)(e,["bidPriceUSD",function(){return n},"dealId",function(e){return e||void 0},"mediaType","dimensions",function(){var t=e.width||e.playerWidth,n=e.height||e.playerHeight;return t&&n?{width:t,height:n}:void 0},"floorValue",function(){return(0,d.Z)(e,"floorData.floorValue")},"floorRuleValue",function(){return(0,d.Z)(e,"floorData.floorRuleValue")},"floorRule",function(){return(0,s.debugTurnedOn)()?(0,d.Z)(e,"floorData.floorRule"):void 0},"adomains",function(){var t=(0,d.Z)(e,"meta.advertiserDomains"),n=Array.isArray(t)&&t.filter((function(e){return"string"==typeof e}));return n&&n.length>0?n.slice(0,10):void 0},"networkId",function(){var t=(0,d.Z)(e,"meta.networkId");return t&&t.toString()||void 0},"conversionError",function(e){return!0===e||void 0},"ogCurrency","ogPrice","rejectionReason"])},ee=function(){var e={channel:"web",integration:k.int_type||"pbjs",referrerUri:U,version:"8.23.0",referrerHostname:se.referrerHostname||te(U),timestamps:{timeSincePageLoad:performance.now(),eventTime:Date.now(),prebidLoaded:se.MODULE_INITIALIZED_TIME}};return D&&(0,u.N)(e,k.pbaBrowserLocation||"client.browser",D),k.wrapperName&&(e.wrapper={name:k.wrapperName,family:k.wrapperFamily,rule:k.rule_name,modelNames:k.wrapperModels}),A.sessionData&&(e.session=(0,s.pick)(A.sessionData,["id","pvid","start","expires"]),(0,s.isEmpty)(A.sessionData.fpkvs)||(e.fpkvs=Object.keys(A.sessionData.fpkvs).map((function(e){return{key:e,value:A.sessionData.fpkvs[e]}})))),e},te=function(e){try{se.referrerHostname=(0,s.parseUrl)(e,{noDecodeWholeURL:!0}).hostname}catch(t){(0,s.logError)("".concat(Z,": Unable to parse hostname from supplied url: "),e,t),se.referrerHostname=""}return se.referrerHostname},ne=function(){var e=Date.now(),t=function(){var e=S.getDataFromLocalStorage(T);if(e)try{return JSON.parse(window.atob(e))}catch(e){(0,s.logError)("".concat(Z,": Unable to decode ").concat(T," value: "),e)}return{}}();return(!Object.keys(t).length||e-t.lastSeen>18e5||t.expires<e)&&(t={id:(0,s.generateUUID)(),start:e,expires:e+216e5}),Object.keys(t).length&&(t.lastSeen=e,t.fpkvs=E(E({},t.fpkvs),re()),t.pvid=k.pvid,function(e){try{S.setDataInLocalStorage(T,window.btoa(JSON.stringify(e)))}catch(e){(0,s.logError)("".concat(Z,": Unable to encode ").concat(T," value: "),e)}}(t)),t},re=function(){return k.fpkvs=Object.assign(k.fpkvs||{},function(){var e;try{e=(0,s.parseQS)((0,s.getWindowLocation)().search)}catch(t){e={}}return Object.keys(e).reduce((function(t,n){return n.match(/utm_/)&&(t[n.replace(/utm_/,"")]=e[n]),t}),{})}()),Object.keys(k.fpkvs).forEach((function(e){k.fpkvs[e]=k.fpkvs[e]+""})),k.fpkvs},oe=function(e){return{width:e.w||e[0],height:e.h||e[1]}},ie=function(e,t){var n,r={},o=m(A.auctionOrder);try{for(o.s();!(n=o.n()).done;){var i=n.value,a=A.auctions[i].auction;for(var c in a.adUnits){var d=a.adUnits[c],u=void 0;try{u=e(d,a)}catch(e){(0,s.logWarn)("".concat(Z,": Error running matches function: ").concat(t),e),u=!1}if(u&&(r={adUnit:d,auction:a},t))return r}}}catch(e){o.e(e)}finally{o.f()}return r},ae=function(e){var t=function(e){if(!v.vc.getConfig("useBidCache"))return{renderTransactionId:e.transactionId,renderAuctionId:e.auctionId};var t=ie((function(t,n){var r=(0,d.Z)(A,"auctions.".concat(n.auctionId,".gamRenders.").concat(t.transactionId));return t.adUnitCode===e.adUnitCode&&r}),!1),n=t.adUnit,r=t.auction;return{renderTransactionId:n&&n.transactionId||e.transactionId,renderAuctionId:r&&r.auctionId||e.auctionId}}(e),n=t.renderTransactionId,r=t.renderAuctionId,o=n!==e.transactionId;(0,s.logInfo)("".concat(Z,": Bid Won : "),{isCachedBid:o,renderAuctionId:r,renderTransactionId:n,sourceAuctionId:e.auctionId,sourceTransactionId:e.transactionId});var i=(0,d.Z)(A,"auctions.".concat(e.auctionId,".auction.adUnits.").concat(e.transactionId,".bids.").concat(e.requestId)),a=(0,d.Z)(A,"auctions.".concat(e.auctionId,".auction.adUnits.").concat(e.transactionId)),c=E(E({},i),{},{sourceAuctionId:e.auctionId,renderAuctionId:r,transactionId:e.transactionId,sourceTransactionId:e.transactionId,bidId:i.pbsBidId||e.bidId||e.requestId,renderTransactionId:n,accountId:O,siteId:a.siteId,zoneId:a.zoneId,mediaTypes:a.mediaTypes,adUnitCode:a.adUnitCode,isCachedBid:o||void 0});return delete c.pbsBidId,c},ce=function(){window.googletag.pubads().addEventListener("slotRenderEnded",(function(e){var t=(0,s.isAdUnitCodeMatchingSlot)(e.slot),n=ie((function(e,n){var r=(A.elementIdMap[e.adUnitCode]||[e.adUnitCode]).some(t),o=(0,d.Z)(A,"auctions.".concat(n.auctionId,".gamRenders.").concat(e.transactionId));return r&&!o}),!0),r=n.adUnit,o=n.auction,i="".concat(e.slot.getAdUnitPath()," - ").concat(e.slot.getSlotElementId());if(r&&o){var a=o.auctionId;(0,s.logInfo)("".concat(Z,": Gam Render: "),{slotName:i,transactionId:r.transactionId,auctionId:a,adUnit:r});var c=function(e,t,n){var r=(0,s.pick)(e,["advertiserId",function(e){return(0,s.isNumber)(e)?e:void 0},"creativeId",function(t){return(0,s.isNumber)(e.sourceAgnosticCreativeId)?e.sourceAgnosticCreativeId:(0,s.isNumber)(t)?t:void 0},"lineItemId",function(t){return(0,s.isNumber)(e.sourceAgnosticLineItemId)?e.sourceAgnosticLineItemId:(0,s.isNumber)(t)?t:void 0},"adSlot",function(){return e.slot.getAdUnitPath()},"isSlotEmpty",function(){return e.isEmpty||void 0}]);return r.auctionId=n.auctionId,r.transactionId=t.transactionId,r}(e,r,o);(0,u.N)(A,"auctions.".concat(a,".gamRenders.").concat(r.transactionId),!0),Q({gamRenders:[c]},a,"gam"),!A.auctions[a].sent&&Object.keys(A.auctions[a].gamRenders).every((function(e){return A.auctions[a].gamRenders[e]}))&&(clearTimeout(A.timeouts[a]),delete A.timeouts[a],k.analyticsEventDelay>0?setTimeout((function(){K(a,"gam-delayed")}),k.analyticsEventDelay):K(a,"gam"))}else(0,s.logInfo)("".concat(Z,": Could not find matching adUnit for Gam Render: "),{slotName:i})}))},se=(0,l.ZP)({analyticsType:"endpoint"});function de(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!1;(w=(0,d.Z)(e,"options.endpoint"))||((0,s.logError)("".concat(Z,": required endpoint missing")),t=!0),(O=Number((0,d.Z)(e,"options.accountId")))||((0,s.logError)("".concat(Z,": required accountId missing")),t=!0),t||se.originEnableAnalytics(e),(0,s.isGptPubadsDefined)()?ce():(window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[],window.googletag.cmd.push((function(){return ce()})))}se.originEnableAnalytics=se.enableAnalytics;var ue=function(e){var t=ae(e);Q({bidsWon:[t]},t.renderAuctionId,"bidWon")},le=function(e,t){Object.keys(t).forEach((function(n){Array.isArray(t[n])&&t[n].length&&(e[n]=t[n].length)}))};window.addEventListener("beforeunload",(function(){var e,t;(0,s.logInfo)("".concat(Z,": Before Unload"));var n={};Object.keys(A.auctions).forEach((function(e){A.auctions[e].sent||(n.auctions=n.auctions||0,n.auctions+=1,A.auctions[e].pendingEvents&&Object.keys(A.auctions[e].pendingEvents).length&&le(n,A.auctions[e].pendingEvents),(0,s.logInfo)("".concat(Z,": Auction ").concat(e," not sent!")))})),le(n,A.pendingEvents);var o=A.auctionOrder[A.auctionOrder.length-1],i=null==R||null===(e=R.rp)||void 0===e||null===(t=e.getDmWebVitals)||void 0===t?void 0:t.call(e,o,!0);"object"===(0,r.Z)(i)&&Object.keys(i).length&&(n.dmWebVitals=i),Object.keys(n).length&&(n.accountId=O,$({missedEvents:n,trigger:"unload"},!0))})),se.enableAnalytics=de,se.originDisableAnalytics=se.disableAnalytics,se.disableAnalytics=function(){se._oldEnable=de,w=void 0,O=void 0,N=0,J(),se.originDisableAnalytics()},se.onDataDeletionRequest=function(){if(!S.localStorageIsEnabled())throw Error("Unable to access local storage, no data deleted");S.removeDataFromLocalStorage(T)},se.MODULE_INITIALIZED_TIME=Date.now(),se.referrerHostname="";var fe=function(e,t){var n=(0,d.Z)(A,"auctions.".concat(e.auctionId,".auction")),r=(0,d.Z)(n,"adUnits.".concat(e.transactionId)),o=r.bids[e.requestId];if(!o&&e.originalRequestId){var i=r.bids[e.originalRequestId];r.bids[e.requestId]=E(E({},i),{},{bidId:e.requestId,bidderDetail:e.targetingBidder}),o=r.bids[e.requestId]}if("boolean"!=typeof(0,d.Z)(n,"floors.enforcement")&&(0,d.Z)(e,"floorData.enforcements")&&((0,u.N)(n,"floors.enforcement",e.floorData.enforcements.enforceJS),(0,u.N)(n,"floors.dealsEnforced",e.floorData.enforcements.floorDeals)),!o&&e.seatBidId&&(o=r.bids[e.seatBidId]={bidder:e.bidderCode,source:"server",bidId:e.seatBidId,unknownBid:!0}),o){o.status=t;var a=pe(e,n.auctionStart);o.clientLatencyMillis=a.total,o.httpLatencyMillis=a.net,o.bidResponse=Y(e,o.bidResponse);var c=(0==e.pbsBidId?(0,s.generateUUID)():e.pbsBidId)||(0==e.seatBidId?(0,s.generateUUID)():e.seatBidId);c&&(o.pbsBidId=c)}else(0,s.logError)("".concat(Z,": Could not find associated bid request for bid response with requestId: "),e.requestId)},pe=function(e,t){try{var n=e.metrics.getMetrics(),r=e.src||e.source;return{total:parseInt(n["adapter.".concat(r,".total")]),net:parseInt(Array.isArray(n["adapter.".concat(r,".net")])?n["adapter.".concat(r,".net")][n["adapter.".concat(r,".net")].length-1]:n["adapter.".concat(r,".net")])}}catch(e){var o=Date.now()-t;return{total:o,net:o}}};se.track=function(e){var t,n,r,i,a,c=e.eventType,l=e.args;switch(c){case L:N+=1,A.sessionData=S.localStorageIsEnabled()&&ne(),i=f.ZP.aliasRegistry,a=Object.keys(i).filter((function(e){return"rubicon"===i[e]})),C.push.apply(C,(0,o.Z)(a)),U=(0,d.Z)(l,"bidderRequests.0.refererInfo.page");var g=(0,s.pick)(l,["auctionId","timestamp as auctionStart","timeout as clientTimeoutMillis"]);if(g.accountId=O,g.auctionCount=N,!D){var v=(0,d.Z)(l,"bidderRequests.0.ortb2.device.ua",navigator.userAgent)||"";D=function(e){var t=e.toLowerCase();return t.includes("edg")?"Edge":/opr|opera|opt/i.test(t)?"Opera":/chrome|crios/i.test(t)?"Chrome":/fxios|firefox/i.test(t)?"Firefox":t.includes("safari")&&!/chromium|ucbrowser/i.test(t)?"Safari":"OTHER"}(v)}g.bidderOrder=l.bidderRequests.map((function(e){return e.bidderCode}));var b=(0,d.Z)(l,"bidderRequests.0.bids.0.floorData");b&&(g.floors=function(e){return"noData"===e.location?(0,s.pick)(e,["location","fetchStatus","floorProvider as provider"]):(0,s.pick)(e,["location","modelVersion as modelName","modelWeight","modelTimestamp","skipped","enforcement",function(){return(0,d.Z)(e,"enforcements.enforceJS")},"dealsEnforced",function(){return(0,d.Z)(e,"enforcements.floorDeals")},"skipRate","fetchStatus","floorMin","floorProvider as provider"])}(b));var I=(0,d.Z)(l,"bidderRequests.0.gdprConsent");I&&(g.gdpr=(0,s.pick)(I,["gdprApplies as applies","consentString","apiVersion as version"]));var m=Object.keys((0,d.Z)(l,"bidderRequests.0.bids.0.userId",{})).map((function(e){return{provider:e,hasId:!0}}));m.length&&(g.user={ids:m}),j&&(g.serverTimeoutMillis=j.timeout);var y={};g.adUnits=l.adUnits.reduce((function(e,t){var n=(0,s.pick)(t,["code as adUnitCode","transactionId","mediaTypes",function(e){return Object.keys(e)},"sizes as dimensions",function(e){return(e||[[1,1]]).map(oe)}]);n.pbAdSlot=(0,d.Z)(t,"ortb2Imp.ext.data.pbadslot"),n.pattern=(0,d.Z)(t,"ortb2Imp.ext.data.aupname"),n.gpid=(0,d.Z)(t,"ortb2Imp.ext.gpid"),n.bids={},e[t.transactionId]=n,y[t.transactionId]=!1;var r=(0,d.Z)(t,"ortb2Imp.ext.data.elementid");r&&(A.elementIdMap[t.code]=A.elementIdMap[t.code]||[],("string"==typeof r?[r]:r).forEach((function(e){A.elementIdMap[t.code].includes(e)||A.elementIdMap[t.code].push(e)})));return e}),{}),A.auctions[l.auctionId]={auction:g,gamRenders:y,pendingEvents:{}};break;case q:l.bids.forEach((function(e){var t=(0,d.Z)(A,"auctions.".concat(l.auctionId,".auction.adUnits.").concat(e.transactionId));t.bids[e.bidId]=(0,s.pick)(e,["bidder","bidId","source",function(){return"s2s"===e.src?"server":"client"},"status",function(){return"no-bid"}]),t.siteId&&t.zoneId||-1===C.indexOf(e.bidder)||(0,d.Z)(e,"params.accountId")==O&&(t.accountId=parseInt(O),t.siteId=parseInt((0,d.Z)(e,"params.siteId")),t.zoneId=parseInt((0,d.Z)(e,"params.zoneId")))}));break;case _:fe(l,"success");break;case F:var h=l.rejectionReason===p.Gw.pe?"rejected-ipf":"rejected";fe(l,h);break;case H:ge(l);break;case W:var E=(0,d.Z)(l,"serverErrors.0"),w=l.serverResponseTimeMs;l.bids.forEach((function(e){var t=(0,d.Z)(A,"auctions.".concat(e.auctionId,".auction.adUnits.").concat(e.transactionId,".bids.").concat(e.bidId));if(void 0!==e.serverResponseTimeMs?t.serverLatencyMillis=e.serverResponseTimeMs:w&&"s2s"===e.source&&(t.serverLatencyMillis=w),!E||t.status&&-1===["no-bid","error"].indexOf(t.status)||(t.status="error",t.error={code:B[E.code]||B[999],description:E.message}),!t.clientLatencyMillis||!t.httpLatencyMillis){var n=pe(e,(0,d.Z)(A,"auctions.".concat(l.auctionId,".auction.auctionStart")));t.clientLatencyMillis=t.clientLatencyMillis||n.total,t.httpLatencyMillis=t.httpLatencyMillis||n.net}}));break;case V:k.analyticsProcessDelay>0?setTimeout((function(){ue(l)}),k.analyticsProcessDelay):ue(l);break;case P:var T=A.auctions[l.auctionId];if(!T)break;T.auction.auctionEnd=l.auctionEnd,A.auctionOrder.push(l.auctionId),l.adUnits&&l.adUnits.every((function(e){return function(e){return e.mediaTypes&&1===Object.keys(e.mediaTypes).length&&"instream"===(0,d.Z)(e,"mediaTypes.video.context")}(e)}))||0===k.analyticsBatchTimeout?K(l.auctionId,"solo-auction"):A.timeouts[l.auctionId]=setTimeout((function(){K(l.auctionId,"auctionEnd")}),k.analyticsBatchTimeout);break;case x:l.forEach((function(e){var t=(0,d.Z)(A,"auctions.".concat(e.auctionId,".auction.adUnits.").concat(e.transactionId,".bids.").concat(e.bidId),{});"error"!==t.status&&(t.status="error",t.error={code:"timeout-error",description:"prebid.js timeout"})}));break;case z:if(k.dmBilling.enabled&&(t=l,n=k.dmBilling.vendors.includes(t.vendor),r="boolean"!=typeof(0,d.Z)(A.billing,"".concat(t.vendor,".").concat(t.billingId)),"string"==typeof t.billingId&&n&&r)){(0,u.N)(A.billing,"".concat(l.vendor,".").concat(l.billingId),!1);var R=function(e){var t=(0,s.deepClone)(e);return t.type="string"==typeof e.type&&e.type||"general",t.accountId=O,(0,u.N)(A.billing,"".concat(e.vendor,".").concat(e.billingId),!0),t}(l);Q({billableEvents:[R]},l.auctionId,"billing")}else(0,s.logInfo)("".concat(Z,": Billing event ignored"),l)}};var ge=function(e){var t=e.seatnonbid,n=e.auctionId,r=(0,d.Z)(A,"auctions.".concat(n,".auction"));if(r){var o=r.adUnits;t.forEach((function(e){var t=e.seat;e.nonbid.forEach((function(e){try{var n=e.status,i=e.impid,a=Object.keys(o).find((function(e){return o[e].adUnitCode===i})),c=o[a],d=ve[n]||{status:"no-bid"};c.bids[(0,s.generateUUID)()]=E({bidder:t,source:"server",isSeatNonBid:!0,clientLatencyMillis:Date.now()-r.auctionStart},d)}catch(e){(0,s.logWarn)("Unable to match nonbid to adUnit")}}))}))}else(0,s.logWarn)("Unable to match nonbid to auction")},ve={0:{status:"no-bid"},100:{status:"error",error:{code:"request-error",description:"general error"}},101:{status:"error",error:{code:"timeout-error",description:"prebid server timeout"}},200:{status:"rejected"},202:{status:"rejected"},301:{status:"rejected-ipf"}};f.ZP.registerAnalyticsAdapter({adapter:se,code:"magnite",gvlid:52});(0,c.z)("magniteAnalyticsAdapter")}},function(e){e.O(0,[14861],(function(){return t=43238,e(e.s=t);var t}));e.O()}]);
(self.pbjsChunk=self.pbjsChunk||[]).push([[85279],{24980:function(e,r,t){t.d(r,{T:function(){return O},x:function(){return g}});var n=t(93324),i=new WeakMap;function o(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!i.has(e)){var t=Object.entries(e);t.sort((function(e,r){return(e=e[1].priority||0)===(r=r[1].priority||0)?0:e>r?-1:1})),i.set(e,t.map((function(e){var r=(0,n.Z)(e,2);return[r[0],r[1].fn]})))}var o=i.get(e).filter((function(e){var t=(0,n.Z)(e,1)[0];return!r.hasOwnProperty(t)||r[t]})).map((function(e){var t=(0,n.Z)(e,2),i=t[0],o=t[1];return r.hasOwnProperty(i)?r[i].bind(this,o):o}));return function(){var e=this,r=Array.from(arguments);o.forEach((function(t){t.apply(e,r)}))}}var a=t(64358),s=t(4942),d=t(20265),p=t(24679);function u(e){return(e=(0,a.parseSizesInput)(e)).map((function(e){var r=e.split("x"),t=(0,n.Z)(r,2),i=t[0],o=t[1];return{w:parseInt(i,10),h:parseInt(o,10)}}))}var f=new Set(["pos","placement","plcmt","api","mimes","protocols","playbackmethod","minduration","maxduration","w","h","startdelay","placement","linearity","skip","skipmin","skipafter","minbitrate","maxbitrate","delivery","playbackend"]),c={instream:1};var m=t(15840);var l,v=t(26372),b=t(83790),y=(l={},(0,s.Z)(l,v.Z,{fpd:{priority:99,fn:function(e,r){(0,a.mergeDeep)(e,r.ortb2)}},onlyOneClient:{priority:-99,fn:(0,b.A_)("ORTB request")},props:{fn:function(e,r){Object.assign(e,{id:e.id||(0,a.generateUUID)(),test:e.test||0});var t=parseInt(r.timeout,10);isNaN(t)||(e.tmax=t)}}}),(0,s.Z)(l,v.DZ,{fpd:{priority:99,fn:function(e,r){(0,a.mergeDeep)(e,r.ortb2Imp)}},id:{fn:function(e,r){e.id=r.bidId}},banner:{fn:function(e,r,t){if(!t.mediaType||t.mediaType===p.Mk){var n=(0,d.Z)(r,"mediaTypes.banner");if(n){var i={topframe:!0===(0,a.inIframe)()?0:1};n.sizes&&(i.format=u(n.sizes)),n.hasOwnProperty("pos")&&(i.pos=n.pos),e.banner=(0,a.mergeDeep)(i,e.banner)}}}},pbadslot:{fn:function(e){var r,t,n,i,o=null===(r=e.ext)||void 0===r||null===(t=r.data)||void 0===t?void 0:t.pbadslot;o&&"string"==typeof o||(null===(n=e.ext)||void 0===n||(null===(i=n.data)||void 0===i||delete i.pbadslot))}}}),(0,s.Z)(l,v.Px,{mediaType:{priority:99,fn:m.R},banner:{fn:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.createPixel,t=void 0===r?function(e){return(0,a.createTrackPixelHtml)(decodeURIComponent(e))}:r;return function(e,r){e.mediaType===p.Mk&&(r.adm&&r.nurl?(e.ad=r.adm,e.ad+=t(r.nurl)):r.adm?e.ad=r.adm:r.nurl&&(e.adUrl=r.nurl))}}()},props:{fn:function(e,r,t){var i;Object.entries({requestId:null===(i=t.bidRequest)||void 0===i?void 0:i.bidId,seatBidId:r.id,cpm:r.price,currency:t.ortbResponse.cur||t.currency,width:r.w,height:r.h,dealId:r.dealid,creative_id:r.crid,creativeId:r.crid,burl:r.burl,ttl:r.exp||t.ttl,netRevenue:t.netRevenue}).filter((function(e){var r=(0,n.Z)(e,2);r[0];return void 0!==r[1]})).forEach((function(r){var t=(0,n.Z)(r,2),i=t[0],o=t[1];return e[i]=o})),e.meta||(e.meta={}),r.adomain&&(e.meta.advertiserDomains=r.adomain)}}}),l);y[v.DZ].native={fn:function(e,r,t){if(!t.mediaType||t.mediaType===p.B5){var n,i=r.nativeOrtbRequest;i&&(null!==(n=(i=Object.assign({},t.nativeRequest,i)).assets)&&void 0!==n&&n.length?e.native=(0,a.mergeDeep)({},{request:JSON.stringify(i),ver:i.ver},e.native):(0,a.logWarn)("mediaTypes.native is set, but no assets were specified. Native request skipped.",r))}}},y[v.Px].native={fn:function(e,r){if(e.mediaType===p.B5){var t;if(t="string"==typeof r.adm?JSON.parse(r.adm):r.adm,!(0,a.isPlainObject)(t)||!Array.isArray(t.assets))throw new Error("ORTB native response contained no assets");e.native={ortb:t}}}},y[v.DZ].video={fn:function(e,r,t){if(!t.mediaType||t.mediaType===p.pX){var i=(0,d.Z)(r,"mediaTypes.video");if(!(0,a.isEmpty)(i)){var o=Object.fromEntries(Object.entries(i).filter((function(e){var r=(0,n.Z)(e,1)[0];return f.has(r)})));if(i.playerSize){var s=u(i.playerSize);s.length>1&&(0,a.logWarn)("video request specifies more than one playerSize; all but the first will be ignored"),Object.assign(o,s[0])}var m=c[i.context];null!=m&&(o.placement=m),e.video=(0,a.mergeDeep)(o,e.video)}}}},y[v.Px].video={fn:function(e,r,t){if(e.mediaType===p.pX){if((0,d.Z)(t.imp,"video.w")&&(0,d.Z)(t.imp,"video.h")){var n=[t.imp.video.w,t.imp.video.h];e.playerWidth=n[0],e.playerHeight=n[1]}r.adm&&(e.vastXml=r.adm),r.nurl&&(e.vastUrl=r.nurl)}}};var h=t(61283);function g(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.context,t=void 0===r?{}:r,n=e.processors,i=void 0===n?O:n,s=e.overrides,d=void 0===s?{}:s,p=e.imp,u=e.request,f=e.bidResponse,c=e.response,m=new WeakMap;function l(e,r,t,n){var a;return function(){return null==a&&(a=function(){var a=t.bind(this,o(i()[e]||{},d[e]||{}));return r&&(a=r.bind(this,a)),function(){try{return a.apply(this,arguments)}catch(e){n.call.apply(n,[this,e].concat(Array.prototype.slice.call(arguments)))}}}()),a.apply(this,arguments)}}var b=l(v.DZ,p,(function(e,r,t){var n={};return e(n,r,t),n}),(function(e,r,t){(0,a.logError)("Error while converting bidRequest to ORTB imp; request skipped.",{error:e,bidRequest:r,context:t})})),y=l(v.Z,u,(function(e,r,t,n){var i={imp:r};return e(i,t,n),i}),(function(e,r,t,n){throw(0,a.logError)("Error while converting to ORTB request",{error:e,imps:r,bidderRequest:t,context:n}),e})),h=l(v.Px,f,(function(e,r,t){var n={};return e(n,r,t),n}),(function(e,r,t){(0,a.logError)("Error while converting ORTB seatbid.bid to bidResponse; bid skipped.",{error:e,bid:r,context:t})})),g=l(v.YC,c,(function(e,r,t,n){var i={bids:r};return e(i,t,n),i}),(function(e,r,t,n){throw(0,a.logError)("Error while converting from ORTB response",{error:e,bidResponses:r,ortbResponse:t,context:n}),e}));return{toORTB:function(e){var r=e.bidderRequest,n=e.bidRequests,i=e.context,o=void 0===i?{}:i;n=n||r.bids;var s={req:Object.assign({bidRequests:n},t,o),imp:{}};s.req.impContext=s.imp;var d=n.map((function(e){var n=Object.assign({bidderRequest:r,reqContext:s.req},t,o),i=b(e,n);if(null!=i){if(i.hasOwnProperty("id"))return Object.assign(n,{bidRequest:e,imp:i}),s.imp[i.id]=n,i;(0,a.logError)("Converted ORTB imp does not specify an id, ignoring bid request",e,i)}})).filter(Boolean),p=y(d,r,s.req);return s.req.bidderRequest=r,null!=p&&m.set(p,s),p},fromORTB:function(e){var r=e.request,t=e.response,n=m.get(r);if(null==n)throw new Error("ortbRequest passed to `fromORTB` must be the same object returned by `toORTB`");function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.assign(e,{ortbRequest:r},t,e)}var o=Object.fromEntries((r.imp||[]).map((function(e){return[e.id,e]}))),s=(t.seatbid||[]).flatMap((function(e){return(e.bid||[]).map((function(r){if(o.hasOwnProperty(r.impid)&&n.imp.hasOwnProperty(r.impid))return h(r,i(n.imp[r.impid],{imp:o[r.impid],seatbid:e,ortbResponse:t}));(0,a.logError)("ORTB response seatbid[].bid[].impid does not match any imp in request; ignoring bid",r)}))})).filter(Boolean);return g(s,t,i(n.req))}}}var O=(0,a.memoize)((function(){return(0,h.F)(y,(0,v.fP)(v.TP))}))},61283:function(e,r,t){t.d(r,{F:function(){return i}});var n=t(26372);function i(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];var o=r.shift(),a=r.length>1?i.apply(void 0,r):r[0];return Object.fromEntries(n.gm.map((function(e){return[e,Object.assign({},o[e],a[e])]})))}},15840:function(e,r,t){t.d(r,{R:function(){return o},e:function(){return i}});var n=t(24679),i={1:n.Mk,2:n.pX,4:n.B5};function o(e,r,t){if(!e.mediaType){var n=t.mediaType;if(!n&&!i.hasOwnProperty(r.mtype))throw new Error("Cannot determine mediaType for response");e.mediaType=n||i[r.mtype]}}}}]);
(self.pbjsChunk=self.pbjsChunk||[]).push([[70951],{99933:function(e,i,r){r.d(i,{X:function(){return x}});var t=r(61283),d=r(4942),n=r(93324),a=r(26372),o=r(20265),s=r(64358),c=r(11021),b=r(86104),u=r(96475);var p=r(39702);var v=r(3193),f=r(78640);var l,g=r(24679);var m=(l={},(0,d.Z)(l,a.Z,{extPrebid:{fn:function(e,i){var r;(0,u.N)(e,"ext.prebid",(0,s.mergeDeep)({auctiontimestamp:i.auctionStart,targeting:{includewinners:!0,includebidderkeys:!1}},null===(r=e.ext)||void 0===r?void 0:r.prebid)),v.vc.getConfig("debug")&&(e.ext.prebid.debug=!0)}},extPrebidChannel:{fn:function(e){var i,r;(0,u.N)(e,"ext.prebid.channel",Object.assign({name:"pbjs",version:(0,f.R)().version},null===(i=e.ext)||void 0===i||null===(r=i.prebid)||void 0===r?void 0:r.channel))}},extPrebidAliases:{fn:function(e,i,r){var t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},d=t.am,n=void 0===d?b.ZP:d;if(n.aliasRegistry[i.bidderCode]){var a=n.bidderRegistry[i.bidderCode];a&&a.getSpec().skipPbsAliasing||(0,u.N)(e,"ext.prebid.aliases.".concat(i.bidderCode),n.aliasRegistry[i.bidderCode])}}}}),(0,d.Z)(l,a.DZ,{params:{fn:p.j},adUnitCode:{fn:function(e,i){var r=i.adUnitCode;r&&(0,u.N)(e,"ext.prebid.adunitcode",r)}}}),(0,d.Z)(l,a.Px,{mediaType:{fn:c.P,priority:99},videoCache:{fn:function(e,i){if(e.mediaType===g.pX){var r=(0,o.Z)(i,"ext.prebid.cache.vastXml")||{},t=r.cacheId,d=r.url;if(!t||!d){var n=(0,o.Z)(i,"ext.prebid.targeting")||{},a=n.hb_uuid,s=n.hb_cache_host,c=n.hb_cache_path;a&&s&&c&&(t=a,d="https://".concat(s).concat(c,"?uuid=").concat(a))}t&&d&&Object.assign(e,{videoCacheKey:t,vastUrl:d})}},priority:-10},bidderCode:{fn:function(e,i,r){var t;e.bidderCode=r.seatbid.seat,e.adapterCode=(0,o.Z)(i,"ext.prebid.meta.adaptercode")||(null===(t=r.bidRequest)||void 0===t?void 0:t.bidder)||e.bidderCode}},pbsBidId:{fn:function(e,i){var r=(0,o.Z)(i,"ext.prebid.bidid");(0,s.isStr)(r)&&(e.pbsBidId=r)}},adserverTargeting:{fn:function(e,i){var r=(0,o.Z)(i,"ext.prebid.targeting");(0,s.isPlainObject)(r)&&(e.adserverTargeting=r)}},extPrebidMeta:{fn:function(e,i){e.meta=(0,s.mergeDeep)({},(0,o.Z)(i,"ext.prebid.meta"),e.meta)}},pbsWurl:{fn:function(e,i){var r=(0,o.Z)(i,"ext.prebid.events.win");(0,s.isStr)(r)&&(e.pbsWurl=r)}}}),(0,d.Z)(l,a.YC,{serverSideStats:{fn:function(e,i,r){Object.entries({errors:"serverErrors",responsetimemillis:"serverResponseTimeMs"}).forEach((function(e){var t=(0,n.Z)(e,2),d=t[0],a=t[1],s=(0,o.Z)(i,"ext.".concat(d,".").concat(r.bidderRequest.bidderCode));s&&(r.bidderRequest[a]=s,r.bidRequests.forEach((function(e){return e[a]=s})))}))}}}),l),h=r(24980),x=(0,s.memoize)((function(){return(0,t.F)((0,h.T)(),m,(0,a.fP)(a.md))}))},11021:function(e,i,r){r.d(i,{E:function(){return o},P:function(){return s}});var t,d=r(4942),n=r(24679),a=r(15840),o=(t={},(0,d.Z)(t,n.Mk,"banner"),(0,d.Z)(t,n.B5,"native"),(0,d.Z)(t,n.pX,"video"),t);function s(e,i,r){var t,d,s=r.mediaType;s||(s=a.e.hasOwnProperty(i.mtype)?a.e[i.mtype]:null===(t=i.ext)||void 0===t||null===(d=t.prebid)||void 0===d?void 0:d.type,o.hasOwnProperty(s)||(s=n.Mk));e.mediaType=s}},39702:function(e,i,r){r.d(i,{j:function(){return a}});var t=r(78653),d=r(86104),n=r(96475);function a(e,i,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=a.adUnit,s=a.bidderRequests,c=a.index,b=void 0===c?t.K.index:c,u=a.bidderRegistry,p=void 0===u?d.ZP.bidderRegistry:u,v=i.params,f=p[i.bidder];f&&f.getSpec().transformBidParams&&(o=o||b.getAdUnit(i),s=s||[r.bidderRequest],v=f.getSpec().transformBidParams(v,!0,o,s)),v&&(0,n.N)(e,"ext.prebid.bidder.".concat(i.bidder),v)}}}]);
(self.pbjsChunk=self.pbjsChunk||[]).push([[56187],{40060:function(e,r,t){var n=t(89062),i=t(4942),o=t(93324),a=t(71002),s=t(78640),d=t(24980),c=t(99933),u=t(14699),p=t(3193),l=t(24679),f=t(34614),m=t(35706),v=t(64358),g=t(96475),b=t(20265),x=t(20676),y=t(85370);function h(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function _(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?h(Object(t),!0).forEach((function(r){(0,i.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):h(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var j="https://video-outstream.rubiconproject.com/apex-2.2.1.js",k=p.vc.getConfig("rubicon")||{};p.vc.getConfig("rubicon",(function(e){(0,v.mergeDeep)(k,e.rubicon)}));var O={1:"468x60",2:"728x90",5:"120x90",7:"125x125",8:"120x600",9:"160x600",10:"300x600",13:"200x200",14:"250x250",15:"300x250",16:"336x280",17:"240x400",19:"300x100",31:"980x120",32:"250x360",33:"180x500",35:"980x150",37:"468x400",38:"930x180",39:"750x100",40:"750x200",41:"750x300",42:"2x4",43:"320x50",44:"300x50",48:"300x300",53:"1024x768",54:"300x1050",55:"970x90",57:"970x250",58:"1000x90",59:"320x80",60:"320x150",61:"1000x1000",64:"580x500",65:"640x480",66:"930x600",67:"320x480",68:"1800x1000",72:"320x320",73:"320x160",78:"980x240",79:"980x300",80:"980x400",83:"480x300",85:"300x120",90:"548x150",94:"970x310",95:"970x100",96:"970x210",101:"480x320",102:"768x1024",103:"480x280",105:"250x800",108:"320x240",113:"1000x300",117:"320x100",125:"800x250",126:"200x600",144:"980x600",145:"980x150",152:"1000x250",156:"640x320",159:"320x250",179:"250x600",195:"600x300",198:"640x360",199:"640x200",213:"1030x590",214:"980x360",221:"1x1",229:"320x180",230:"2000x1400",232:"580x400",234:"6x6",251:"2x2",256:"480x820",257:"400x600",258:"500x200",259:"998x200",261:"480x480",264:"970x1000",265:"1920x1080",274:"1800x200",278:"320x500",282:"320x400",288:"640x380",484:"720x1280",524:"1x2",548:"500x1000",550:"980x480",552:"300x200",558:"640x640",562:"300x431",564:"320x431",566:"320x300",568:"300x150",570:"300x125",572:"250x350",574:"620x891",576:"610x877",578:"980x552",580:"505x656",622:"192x160",632:"1200x450",634:"340x450"};(0,v._each)(O,(function(e,r){return O[e]=r}));var S=(0,d.x)({request:function(e,r,t,i){var o,d,c,u=i.bidRequests,l=e(r,t,i);l.cur=["USD"],l.test=p.vc.getConfig("debug")?1:0,(0,g.N)(l,"ext.prebid.cache",{vastxml:{returnCreative:!0===k.returnVast}}),(0,g.N)(l,"ext.prebid.bidders",{rubicon:{integration:k.int_type||"pbjs"}}),(0,g.N)(l,"ext.prebid.targeting.pricegranularity",{ranges:{low:[{max:5,increment:.5}],medium:[{max:20,increment:.1}],high:[{max:20,increment:.01}],auto:[{max:5,increment:.05},{min:5,max:10,increment:.1},{min:10,max:20,increment:.5}],dense:[{max:3,increment:.01},{min:3,max:8,increment:.05},{min:8,max:20,increment:.5}],custom:(c=p.vc).getConfig("customPriceBucket")&&c.getConfig("customPriceBucket").buckets}[c.getConfig("priceGranularity")]});var f=(0,s.R)().installedModules;return!f||f.length&&-1===f.indexOf("rubiconAnalyticsAdapter")||(0,g.N)(l,"ext.prebid.analytics",{rubicon:{"client-analytics":!0}}),function(e,r,t){var i,o,a={},s=x.c.apply(void 0,[t].concat((0,n.Z)(r.map((function(e){return e.params.keywords})))));r.forEach((function(r){var t,n,i,o,s,d={user:{ext:{data:_({},r.params.visitor)}},site:{ext:{data:_({},r.params.inventory)}}},c=e.imp.find((function(e){var r,t,n,i,o;return null===(r=e.ext)||void 0===r||null===(t=r.prebid)||void 0===t||null===(n=t.bidder)||void 0===n||null===(i=n.rubicon)||void 0===i||null===(o=i.video)||void 0===o?void 0:o.language}));c&&(d.site.content={language:null===(t=c.ext)||void 0===t||null===(n=t.prebid)||void 0===n||null===(i=n.bidder)||void 0===i||null===(o=i.rubicon)||void 0===o||null===(s=o.video)||void 0===s?void 0:s.language});a=(0,v.mergeDeep)(a,r.ortb2||{},d);var u=p.vc.getConfig("user.id");a.user.id=a.user.id||u})),(0,v.mergeDeep)(e,a),s&&s.length&&(0,g.N)(e,"site.keywords",s.join(","));null==e||(null===(i=e.ext)||void 0===i||(null===(o=i.prebid)||void 0===o||delete o.storedrequest))}(l,u,t.ortb2),null==l||(null===(o=l.ext)||void 0===o||(null===(d=o.prebid)||void 0===d||delete d.storedrequest)),!0===k.disableFloors&&delete l.ext.prebid.floors,u.filter((function(e){return"object"===(0,a.Z)(e.floorData)})).length>0&&(l.ext.prebid.floors={enabled:!1}),l},imp:function(e,r,t){var n,i,o=Z(r);if(!o.includes(l.Mk)||1!=o.length){var a=e(r,t);return a.id=r.adUnitCode,delete a.banner,p.vc.getConfig("s2sConfig.defaultTtl")&&(a.exp=p.vc.getConfig("s2sConfig.defaultTtl")),"atf"===r.params.position&&a.video&&(a.video.pos=1),"btf"===r.params.position&&a.video&&(a.video.pos=3),null===(n=a.ext)||void 0===n||(null===(i=n.prebid)||void 0===i||delete i.storedrequest),!0===r.params.bidonmultiformat&&o.length>1&&(0,g.N)(a,"ext.prebid.bidder.rubicon.formats",o),function(e,r){"USD"!=r.bidfloorcur&&(delete r.bidfloor,delete r.bidfloorcur);if(!r.bidfloor){var t=parseFloat((0,b.Z)(e,"params.floor"));isNaN(t)||(r.bidfloor=t,r.bidfloorcur="USD")}}(r,a),a}},bidResponse:function(e,r,t){var n,i=e(r,t);i.meta.mediaType=(0,b.Z)(r,"ext.prebid.type");var a=t.bidRequest,s="outstream"===(null===(n=a.mediaTypes.video)||void 0===n?void 0:n.context)?A(a,l.pX):[void 0,void 0],d=(0,o.Z)(s,2),c=d[0],u=d[1];return i.width=r.w||c||i.playerWidth,i.height=r.h||u||i.playerHeight,i.mediaType===l.pX&&"outstream"===a.mediaTypes.video.context&&(i.renderer=function(e){var r=m.Th.install({id:e.adId,url:k.rendererUrl||j,config:k.rendererConfig||{},loaded:!1,adUnitCode:e.adUnitCode});try{r.setRender(C)}catch(e){(0,v.logWarn)("Prebid Error calling setRender on renderer",e)}return r}(i)),(0,b.Z)(r,"ext.bidder.rp.advid")&&(0,g.N)(i,"meta.advertiserId",r.ext.bidder.rp.advid),i},context:{netRevenue:!1!==k.netRevenue,ttl:300},processors:c.X}),w={code:"rubicon",gvlid:52,supportedMediaTypes:[l.Mk,l.pX,l.B5],isBidRequestValid:function(e){var r=!0;if("object"!==(0,a.Z)(e.params))return!1;for(var t=0,n=["accountId","siteId","zoneId"];t<n.length;t++)if(e.params[n[t]]=parseInt(e.params[n[t]]),isNaN(e.params[n[t]]))return(0,v.logError)("Rubicon: wrong format of accountId or siteId or zoneId."),!1;var i=Z(e,!0);if(!i.length)return!1;i.includes(l.pX)&&(r=function(e){var r=!0,t=Object.prototype.toString.call([]),n=Object.prototype.toString.call(0),i={mimes:t,protocols:t,linearity:n,api:t};return Object.keys(i).forEach((function(t){Object.prototype.toString.call((0,b.Z)(e,"mediaTypes.video."+t))!==i[t]&&(r=!1,(0,v.logError)("Rubicon: mediaTypes.video."+t+" is required and must be of type: "+i[t]))})),r}(e));var o=[l.Mk,l.B5].filter((function(e){return i.includes(e)})).length>0;return o?r&&o:r},buildRequests:function(e,r){var t,n=[],i=[];if((t=e.filter((function(e){var r=Z(e)||[],t=r.length,n=e.params||{},i=n.bidonmultiformat,o=n.video;return 1===t&&(r.includes(l.pX)||r.includes(l.B5))||2===t&&!r.includes(l.Mk)||o&&r.includes(l.pX)||i&&(r.includes(l.pX)||r.includes(l.B5))})))&&t.length){var o=S.toORTB({bidRequests:t,bidderRequest:r});i.push({method:"POST",url:"https://".concat(k.videoHost||"prebid-server",".rubiconproject.com/openrtb2/auction"),data:o,bidRequest:t})}var a=e.filter((function(e){var r=Z(e)||[],t=e.params||{},n=t.bidonmultiformat,i=t.video;return r.includes(l.Mk)&&(1===r.length||n||!n&&!i||!n&&i&&!r.includes(l.pX))}));if(!0!==k.singleRequest)n=i.concat(a.map((function(e){var t=w.createSlotParams(e,r);return{method:"GET",url:"https://".concat(k.bannerHost||"fastlane",".rubiconproject.com/a/api/fastlane.json"),data:w.getOrderedParams(t).reduce((function(e,r){var n=t[r];return(0,v.isStr)(n)&&""!==n||(0,v.isNumber)(n)?"".concat(e).concat(P(r,n),"&"):e}),"")+"slots=1&rand=".concat(Math.random()),bidRequest:e}})));else{var s=a.reduce((function(e,r){return(e[r.params.siteId]=e[r.params.siteId]||[]).push(r),e}),{});n=i.concat(Object.keys(s).reduce((function(e,t){var n,i;return(n=s[t],i=10,n.map((function(e,r){return r%i==0?n.slice(r,r+i):null})).filter((function(e){return e}))).forEach((function(t){var n=w.combineSlotUrlParams(t.map((function(e){return w.createSlotParams(e,r)})));e.push({method:"GET",url:"https://".concat(k.bannerHost||"fastlane",".rubiconproject.com/a/api/fastlane.json"),data:w.getOrderedParams(n).reduce((function(e,r){var t=n[r];return(0,v.isStr)(t)&&""!==t||(0,v.isNumber)(t)?"".concat(e).concat(P(r,t),"&"):e}),"")+"slots=".concat(t.length,"&rand=").concat(Math.random()),bidRequest:t})})),e}),[]))}return n},getOrderedParams:function(e){var r=/^tg_v/,t=/^tg_i/,n=/^eid_|^tpid_/,i=["account_id","site_id","zone_id","size_id","alt_size_ids","p_pos","gdpr","gdpr_consent","us_privacy","gpp","gpp_sid","rp_schain"].concat(Object.keys(e).filter((function(e){return n.test(e)}))).concat(["x_liverampidl","ppuid","rf","p_geo.latitude","p_geo.longitude","kw"]).concat(Object.keys(e).filter((function(e){return r.test(e)}))).concat(Object.keys(e).filter((function(e){return t.test(e)}))).concat(["tk_flint","x_source.tid","l_pb_bid_id","p_screen_res","o_ae","o_cdep","rp_floor","rp_secure","tk_user_key"]);return i.concat(Object.keys(e).filter((function(e){return-1===i.indexOf(e)})))},combineSlotUrlParams:function(e){if(1===e.length)return e[0];var r=e.reduce((function(r,t,n){return Object.keys(t).forEach((function(i){r.hasOwnProperty(i)||(r[i]=new Array(e.length)),r[i].splice(n,1,t[i])})),r}),{}),t=new RegExp("^([^;]*)(;\\1)+$");return Object.keys(r).forEach((function(e){var n=r[e].join(";"),i=n.match(t);r[e]=i?i[1]:n})),r},createSlotParams:function(e,r){var t,n,i,s,d,c,u,m,g,x;e.startTime=(new Date).getTime();var y=e.params,h=A(e,"banner"),j=y.latLong||[],O=(0,o.Z)(j,2),S=O[0],C=O[1],R={account_id:y.accountId,site_id:y.siteId,zone_id:y.zoneId,size_id:h[0],alt_size_ids:h.slice(1).join(",")||void 0,rp_floor:(y.floor=parseFloat(y.floor))>=.01?y.floor:void 0,rp_secure:"1",tk_flint:"".concat(k.int_type||"pbjs_lite","_v8.23.0"),"x_source.tid":null===(t=r.ortb2)||void 0===t||null===(n=t.source)||void 0===n?void 0:n.tid,"x_imp.ext.tid":null===(i=e.ortb2Imp)||void 0===i||null===(s=i.ext)||void 0===s?void 0:s.tid,l_pb_bid_id:e.bidId,o_cdep:null===(d=e.ortb2)||void 0===d||null===(c=d.device)||void 0===c||null===(u=c.ext)||void 0===u?void 0:u.cdep,p_screen_res:[window.screen.width,window.screen.height].join("x"),tk_user_key:y.userId,"p_geo.latitude":isNaN(parseFloat(S))?void 0:parseFloat(S).toFixed(4),"p_geo.longitude":isNaN(parseFloat(C))?void 0:parseFloat(C).toFixed(4),"tg_fl.eid":e.code,rf:I(e,r)};if("function"==typeof e.getFloor&&!k.disableFloors){var T;try{T=e.getFloor({currency:"USD",mediaType:"banner",size:"*"})}catch(e){(0,v.logError)("Rubicon: getFloor threw an error: ",e)}R.rp_hard_floor="object"!==(0,a.Z)(T)||"USD"!==T.currency||isNaN(parseInt(T.floor))?void 0:T.floor}!0===y.bidonmultiformat&&(0,b.Z)(e,"mediaTypes")&&Object.keys(e.mediaTypes).length>1&&(R.p_formats=Object.keys(e.mediaTypes).join(","));var Z={1:"atf",3:"btf"}[(0,b.Z)(e,"mediaTypes.banner.pos")]||"";R.p_pos="atf"===y.position||"btf"===y.position?y.position:Z;var P,E,U=p.vc.getConfig("user.id");(U&&(R.ppuid=U),null!=e&&null!==(m=e.ortb2Imp)&&void 0!==m&&null!==(g=m.ext)&&void 0!==g&&g.ae&&(R.o_ae=1),e.userIdAsEids&&e.userIdAsEids.forEach((function(e){try{if("adserver.org"===e.source)R.tpid_tdid=e.uids[0].id,R["eid_adserver.org"]=e.uids[0].id;else if("liveintent.com"===e.source)R["tpid_liveintent.com"]=e.uids[0].id,R["eid_liveintent.com"]=e.uids[0].id,e.ext&&Array.isArray(e.ext.segments)&&e.ext.segments.length&&(R["tg_v.LIseg"]=e.ext.segments.join(","));else if("liveramp.com"===e.source)R.x_liverampidl=e.uids[0].id;else if("id5-sync.com"===e.source)R["eid_id5-sync.com"]="".concat(e.uids[0].id,"^").concat(e.uids[0].atype,"^").concat(e.uids[0].ext&&e.uids[0].ext.linkType||"");else{var r="rubiconproject.com"===e.source?e.uids[0].id:"".concat(e.uids[0].id,"^").concat(e.uids[0].atype||"");R["eid_".concat(e.source)]=r}if(!R.ppuid){var t=(0,f.sE)(e.uids,(function(e){return e.ext&&"ppuid"===e.ext.stype}));t&&t.id&&(R.ppuid=t.id)}}catch(r){(0,v.logWarn)("Rubicon: error reading eid:",e,r)}})),r.gdprConsent&&("boolean"==typeof r.gdprConsent.gdprApplies&&(R.gdpr=Number(r.gdprConsent.gdprApplies)),R.gdpr_consent=r.gdprConsent.consentString),r.uspConsent&&(R.us_privacy=encodeURIComponent(r.uspConsent)),null!==(x=r.gppConsent)&&void 0!==x&&x.gppString)&&(R.gpp=r.gppConsent.gppString,R.gpp_sid=null===(P=r.gppConsent)||void 0===P||null===(E=P.applicableSections)||void 0===E?void 0:E.toString());return R.rp_maxbids=r.bidLimit||1,function(e,r,t){var n={user:{ext:{data:_({},e.params.visitor)}},site:{ext:{data:_({},e.params.inventory)}}};e.params.keywords&&(n.site.keywords=(0,v.isArray)(e.params.keywords)?e.params.keywords.join(","):e.params.keywords);var i=(0,v.mergeDeep)({},e.ortb2||{},n),o=(0,b.Z)(e.ortb2Imp,"ext")||{},s=(0,b.Z)(e.ortb2Imp,"ext.data")||{},d=(0,b.Z)(e,"ortb2Imp.ext.gpid"),c={user:[4],site:[1,2,5,6]},u={user:"tg_v.",site:"tg_i.",adserver:"tg_i.dfp_ad_unit_code",pbadslot:"tg_i.pbadslot",keywords:"kw"},p=function(e,r,t){return"data"===r&&Array.isArray(e)?e.filter((function(e){return e.segment&&(0,b.Z)(e,"ext.segtax")&&c[t]&&-1!==c[t].indexOf((0,b.Z)(e,"ext.segtax"))})).map((function(e){var r=e.segment.filter((function(e){return e.id})).reduce((function(e,r){return e.push(r.id),e}),[]);if(r.length>0)return r.toString()})).toString():("object"!==(0,a.Z)(e)||Array.isArray(e))&&void 0!==e?Array.isArray(e)?e.filter((function(e){if("object"!==(0,a.Z)(e)&&void 0!==e)return e.toString();(0,v.logWarn)("Rubicon: Filtered value: ",e,"for key",r,": Expected value to be string, integer, or an array of strings/ints")})).toString():e.toString():void 0},f=function(e,r,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=p(e,n,r),a=u[n]&&i?"".concat(u[n]):"data"===n?"".concat(u[r],"iab"):"".concat(u[r]).concat(n);t[a]=t[a]?t[a].concat(",",o):o};r===l.Mk?(["site","user"].forEach((function(e){Object.keys(i[e]).forEach((function(r){"site"===e&&"content"===r&&i[e][r].data?f(i[e][r].data,e,"data"):"ext"!==r?f(i[e][r],e,r):i[e][r].data&&Object.keys(i[e].ext.data).forEach((function(r){f(i[e].ext.data[r],e,r,!1)}))}))})),Object.keys(s).forEach((function(e){"adserver"!==e?f(s[e],"site",e):"gam"===s[e].name&&f(s[e].adslot,name,e)})),d&&(t.p_gpid=d),t["tg_i.pbadslot"]&&delete t["tg_i.dfp_ad_unit_code"]):(Object.keys(o).length&&(0,v.mergeDeep)(t.imp[0].ext,o),d&&(t.imp[0].ext.gpid=d),(0,v.mergeDeep)(t,i))}(e,l.Mk,R),!0===p.vc.getConfig("coppa")&&(R.coppa=1),e.schain&&z(e.schain)&&(R.rp_schain=w.serializeSupplyChain(e.schain)),R},serializeSupplyChain:function(e){if(!z(e))return"";var r=e.ver,t=e.complete,n=e.nodes;return"".concat(r,",").concat(t,"!").concat(w.serializeSupplyChainNodes(n))},serializeSupplyChainNodes:function(e){var r=["asi","sid","hp","rid","name","domain"];return e.map((function(e){return r.map((function(r){return encodeURIComponent(e[r]||"")})).join(",")})).join("!")},interpretResponse:function(e,r){var t;e=e.body;var n=r.data;if(!e||"object"!==(0,a.Z)(e))return[];if(e.seatbid){var i=(0,b.Z)(e,"ext.errors.rubicon");return Array.isArray(i)&&i.length>0&&(0,v.logWarn)("Rubicon: Error in video response"),S.fromORTB({request:n,response:e}).bids}var s,d=e.ads,c=0,u=r.bidRequest;if("object"===(0,a.Z)(u)&&!Array.isArray(u)&&Z(u).includes(l.pX)&&"object"===(0,a.Z)(d)&&(d=d[u.adUnitCode]),!Array.isArray(d)||d.length<1)return[];var p=d.reduce((function(r,t,n){if(t.impression_id&&s===t.impression_id?c++:s=t.impression_id,"ok"!==t.status)return r;var i,d,p=Array.isArray(u)?u[n-c]:u;if(p&&"object"===(0,a.Z)(p)){var f={requestId:p.bidId,currency:"USD",creativeId:t.creative_id||"".concat(t.network||"","-").concat(t.advertiser||""),cpm:t.cpm||0,dealId:t.deal,ttl:300,netRevenue:!1!==k.netRevenue,rubicon:{advertiserId:t.advertiser,networkId:t.network},meta:{advertiserId:t.advertiser,networkId:t.network,mediaType:l.Mk}};if(t.creative_type&&(f.mediaType=t.creative_type),t.adomain&&(f.meta.advertiserDomains=Array.isArray(t.adomain)?t.adomain:[t.adomain]),t.creative_type===l.pX)f.width=p.params.video.playerWidth,f.height=p.params.video.playerHeight,f.vastUrl=t.creative_depot_url,f.impression_id=t.impression_id,f.videoCacheKey=t.impression_id;else{f.ad=(i=t.script,d=t.impression_id,"<html>\n<head><script type='text/javascript'>inDapIF=true;<\/script></head>\n<body style='margin : 0; padding: 0;'>\n\x3c!-- Rubicon Project Ad Tag --\x3e\n<div data-rp-impression-id='".concat(d,"'>\n<script type='text/javascript'>").concat(i,"<\/script>\n</div>\n</body>\n</html>"));var m=O[t.size_id].split("x").map((function(e){return Number(e)})),g=(0,o.Z)(m,2);f.width=g[0],f.height=g[1]}f.rubiconTargeting=(Array.isArray(t.targeting)?t.targeting:[]).reduce((function(e,r){return e[r.key]=r.values[0],e}),{rpfl_elemid:p.adUnitCode}),r.push(f)}else(0,v.logError)("Rubicon: bidRequest undefined at index position:".concat(n),u,e);return r}),[]).sort((function(e,r){return(r.cpm||0)-(e.cpm||0)})),f=null===(t=e.component_auction_config)||void 0===t?void 0:t.map((function(e){return{config:e,bidId:e.bidId}}));return f?{bids:p,fledgeAuctionConfigs:f}:p},getUserSyncs:function(e,r,t,n,i){if(!E&&e.iframeEnabled){var o,a={};if(t&&("boolean"==typeof t.gdprApplies&&(a.gdpr=Number(t.gdprApplies)),"string"==typeof t.consentString&&(a.gdpr_consent=t.consentString)),n&&(a.us_privacy=encodeURIComponent(n)),null!=i&&i.gppString)a.gpp=i.gppString,a.gpp_sid=null===(o=i.applicableSections)||void 0===o?void 0:o.toString();return a=Object.keys(a).length?"?".concat((0,v.formatQS)(a)):"",E=!0,{type:"iframe",url:"https://".concat(k.syncHost||"eus",".rubiconproject.com/usync.html")+a}}},transformBidParams:function(e,r){return(0,y.u)({accountId:"number",siteId:"number",zoneId:"number"},e)}};function I(e,r){var t;return t=e.params.referrer?e.params.referrer:r.refererInfo.page,e.params.secure?t.replace(/^http:/i,"https:"):t}function C(e){var r,t=document.getElementById(e.adUnitCode);(r=t.querySelector("div[id^='google_ads']"))&&r.style.setProperty("display","none"),function(e){var r=e.querySelector("script[id^='sas_script']"),t=r&&r.nextSibling;t&&"iframe"===t.localName&&t.style.setProperty("display","none")}(t);var n=e.renderer.getConfig();e.renderer.push((function(){window.MagniteApex.renderAd({width:e.width,height:e.height,vastUrl:e.vastUrl,placement:{attachTo:t,align:n.align||"center",position:n.position||"append"},closeButton:n.closeButton||!1,label:n.label||void 0,collapse:n.collapse||!0})}))}function A(e,r){var t=e.params;if(r===l.pX){var n=[];return t.video&&t.video.playerWidth&&t.video.playerHeight?n=[t.video.playerWidth,t.video.playerHeight]:Array.isArray((0,b.Z)(e,"mediaTypes.video.playerSize"))&&1===e.mediaTypes.video.playerSize.length?n=e.mediaTypes.video.playerSize[0]:Array.isArray(e.sizes)&&e.sizes.length>0&&Array.isArray(e.sizes[0])&&e.sizes[0].length>1&&(n=e.sizes[0]),n}var i=[];return Array.isArray(t.sizes)?i=t.sizes:void 0!==(0,b.Z)(e,"mediaTypes.banner.sizes")?i=R(e.mediaTypes.banner.sizes):Array.isArray(e.sizes)&&e.sizes.length>0?i=R(e.sizes):(0,v.logWarn)("Rubicon: no sizes are setup or found"),function(e){var r=[15,2,9];return e.sort((function(e,t){var n=r.indexOf(e),i=r.indexOf(t);return n>-1||i>-1?-1===n?1:-1===i?-1:n-i:e-t}))}(i)}function R(e){return(0,v.parseSizesInput)(e).reduce((function(e,r){var t=parseInt(O[r],10);return t&&e.push(t),e}),[])}function T(e){var r=void 0!==(0,b.Z)(e,"mediaTypes.".concat(l.pX)),t=void 0!==(0,b.Z)(e,"mediaTypes.".concat(l.Mk)),n=void 0!==(0,b.Z)(e,"params.bidonmultiformat"),i="object"!==(0,a.Z)((0,b.Z)(e,"params.video"));return!(!r||!n)||(t&&i&&(r=!1),r&&i&&(0,g.N)(e,"params.video",{}),r)}function Z(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=[];if(T(e)){if(-1===["outstream","instream"].indexOf((0,b.Z)(e,"mediaTypes.".concat(l.pX,".context"))))return r&&(0,v.logError)("Rubicon: mediaTypes.video.context must be outstream or instream"),t;if(A(e,l.pX).length<2)return r&&(0,v.logError)("Rubicon: could not determine the playerSize of the video"),t;r&&(0,v.logMessage)("Rubicon: making video request for adUnit",e.adUnitCode),t.push(l.pX)}if(void 0!==(0,b.Z)(e,"mediaTypes.".concat(l.B5))&&t.push(l.B5),void 0!==(0,b.Z)(e,"mediaTypes.".concat(l.Mk))){if(0===A(e,l.Mk).length)return r&&(0,v.logError)("Rubicon: could not determine the sizes for banner request"),t;r&&(0,v.logMessage)("Rubicon: making banner request for adUnit",e.adUnitCode),t.push(l.Mk)}return t}function z(e){var r=!1,t=["asi","sid","hp"];return e.nodes?((r=e.nodes.reduce((function(e,r){return e?t.every((function(e){return r.hasOwnProperty(e)})):e}),!0))||(0,v.logError)("Rubicon: required schain params missing"),r):r}function P(e,r){return"rp_schain"===e?"rp_schain=".concat(r):"".concat(e,"=").concat(encodeURIComponent(r))}var E=!1;(0,u.dX)(w),(0,s.z)("rubiconBidAdapter")},26372:function(e,r,t){t.d(r,{DZ:function(){return a},Px:function(){return s},TP:function(){return c},YC:function(){return d},Z:function(){return o},f8:function(){return m},fP:function(){return v},gm:function(){return n},md:function(){return u}});var n=["request","imp","bidResponse","response"],i=["default","pbs"],o=n[0],a=n[1],s=n[2],d=n[3],c=i[0],u=i[1],p=new Set(n);var l,f=(l={},{registerOrtbProcessor:function(e){var r=e.type,t=e.name,i=e.fn,o=e.priority,a=void 0===o?0:o,s=e.dialects,d=void 0===s?[c]:s;if(!p.has(r))throw new Error("ORTB processor type must be one of: ".concat(n.join(", ")));d.forEach((function(e){l.hasOwnProperty(e)||(l[e]={}),l[e].hasOwnProperty(r)||(l[e][r]={}),l[e][r][t]={priority:a,fn:i}}))},getProcessors:function(e){return l[e]||{}}}),m=f.registerOrtbProcessor,v=f.getProcessors}},function(e){e.O(0,[85279,33402,93157,70951],(function(){return r=40060,e(e.s=r);var r}));e.O()}]);
(self.pbjsChunk=self.pbjsChunk||[]).push([[92972],{54834:function(o,e,n){var t=n(71002),r=n(78640),i=n(64358),d=n(92797),a=n(34516),u=n(15164),c=n(9633),l=n(81694),f=(0,u.df)({moduleType:c.y2,moduleName:"sharedId"}),s="cookie",m="html5",g="_pubcid_optout",p="PublisherCommonId";function v(o,e){if(e===s)return f.getCookie(o);if(e===m&&f.hasLocalStorage()){var n=f.getDataFromLocalStorage("".concat(o,"_exp"));if(!n)return f.getDataFromLocalStorage(o);if(new Date(n).getTime()-Date.now()>0)return f.getDataFromLocalStorage(o)}}function I(o,e){return function(n,t){e?b(e,o,(function(){n(t()||o)}))():n(o)}}function b(o){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0;if(o){var t=(0,i.parseUrl)(o);t.search.id=encodeURIComponent("pubcid:"+e);var r=(0,i.buildUrl)(t);return function(){(0,i.triggerPixel)(r,n)}}}function h(){return!!(f.cookiesAreEnabled()&&v(g,s)||f.hasLocalStorage()&&v(g,m))}var C={name:"sharedId",aliasName:"pubCommonId",gvlid:a.$P,decode:function(o,e){if(!h())return(0,i.logInfo)(" Decoded value PubCommonId "+o),{pubcid:o};(0,i.logInfo)("PubCommonId decode: Has opted-out")},getId:function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>2?arguments[2]:void 0;if(h())(0,i.logInfo)("PubCommonId: Has opted-out");else{var n=a.VP.getCoppa();if(!n){var r=o.params,d=(r=void 0===r?{}:r).create,u=void 0===d||d,c=r.pixelUrl,l=e;if(!l){try{"object"===(0,t.Z)(window[p])&&(l=window[p].getId())}catch(o){}l||(l=u&&(0,i.hasDeviceAccess)()?(0,i.generateUUID)():void 0)}return{id:l,callback:I(l,c)}}(0,i.logInfo)("PubCommonId: IDs not provided for coppa requests, exiting PubCommonId")}},extendId:function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>2?arguments[2]:void 0;if(h())return(0,i.logInfo)("PubCommonId: Has opted-out"),{id:void 0};var n=a.VP.getCoppa();if(n)(0,i.logInfo)("PubCommonId: IDs not provided for coppa requests, exiting PubCommonId");else{var t=o.params,r=(t=void 0===t?{}:t).extend,d=void 0!==r&&r,u=t.pixelUrl;if(d){if(u){var c=b(u,e);return{callback:c}}return{id:e}}}},domainOverride:(0,l.U)(f,"sharedId"),eids:{pubcid:{source:"pubcid.org",atype:1}}};(0,d.Bx)("userId",C),(0,r.z)("sharedIdSystem")}},function(o){o.O(0,[57748],(function(){return e=54834,o(o.s=e);var e}));o.O()}]);
(self.pbjsChunk=self.pbjsChunk||[]).push([[33402],{85370:function(n,e,u){u.d(e,{u:function(){return t}});var r=u(64358);function t(n,e){return Object.keys(n).forEach((function(u){var t,s;e[u]&&((0,r.isFn)(n[u])?e[u]=n[u](e[u]):e[u]=(t=n[u],s=e[u],"string"===t?s&&s.toString():"number"===t?Number(s):s),isNaN(e[u])&&delete e.key)})),e}}}]);
(self.pbjsChunk=self.pbjsChunk||[]).push([[9215],{82547:function(e,n,r){var t=r(89062),o=r(71002),i=r(93324),a=r(4942),u=r(78640),c=r(34614),s=r(3193),f=r(52021),l=r(34516),d=r(86104),g=r(5644),m=r(92797),v=r(64358),b=r(20265),h=new Map;function p(e){var n={};function r(e){var r,o,i=JSON.stringify([null===(r=e.source)||void 0===r?void 0:r.toLowerCase(),e.ext]);n.hasOwnProperty(i)?(o=n[i].uids).push.apply(o,(0,t.Z)(e.uids)):n[i]=e}return Object.entries(e).forEach((function(e){var n=(0,i.Z)(e,2),t=n[0],o=n[1];o=Array.isArray(o)?o:[o],("pubProvidedId"===t?o:o.map((function(e){return function(e,n){var r=h.get(n);if(r&&e){var t={};t.source=(0,v.isFn)(r.getSource)?r.getSource(e):r.source;var o=(0,v.isFn)(r.getValue)?r.getValue(e):e;if((0,v.isStr)(o)){var i={id:o,atype:r.atype};if((0,v.isFn)(r.getUidExt)){var a=r.getUidExt(e);a&&(i.ext=a)}if(t.uids=[i],(0,v.isFn)(r.getEidExt)){var u=r.getEidExt(e);u&&(t.ext=u)}return t}}return null}(e,t)}))).filter((function(e){return null!=e})).forEach(r)})),Object.values(n)}var y,I,w,E,S,D,O=r(15164),j=r(96475),P=r(7563),k=r(68792),A=r(26372),C=r(99128),N=r(38196),Z=r(9633),T=r(50571),x=r(74947),U=r(10286),F="User ID",R=O.c$,L=O.Dp,_="_pbjs_id_optout",q=(0,O.eA)("userId"),G={isAllowed:T.xD},M=!1,B=[],W=[],J={},z=[],V=function(){return null==D&&(D=(0,C.V6)()),D};function Y(e){return V().fork().renameWith((function(n){return["userId.mod.".concat(n),"userId.mods.".concat(e,".").concat(n)]}))}function $(e,n){n=n||e.storageMgr;var r="function"==typeof e.submodule.domainOverride?e.submodule.domainOverride():null,t=e.config.storage.name;return function(e,o,i){n.setCookie(t+(e||""),o,i,"Lax",r)}}function H(e,n){var r=e.config.storage,t=e.storageMgr;try{var o=new Date(Date.now()+864e5*r.expires).toUTCString(),i=(0,v.isPlainObject)(n)?JSON.stringify(n):n;if(r.type===R){var a=$(e);a(null,i,o),a("_cst",pe(),o),"number"==typeof r.refreshInSeconds&&a("_last",(new Date).toUTCString(),o)}else r.type===L&&(t.setDataInLocalStorage("".concat(r.name,"_exp"),o),t.setDataInLocalStorage("".concat(r.name,"_cst"),pe()),t.setDataInLocalStorage(r.name,encodeURIComponent(i)),"number"==typeof r.refreshInSeconds&&t.setDataInLocalStorage("".concat(r.name,"_last"),(new Date).toUTCString()))}catch(e){(0,v.logError)(e)}}function K(e){var n,r,t,o;switch(null===(n=e.config)||void 0===n||null===(r=n.storage)||void 0===r?void 0:r.type){case R:var i=$(e,q),a=new Date(Date.now()-864e5).toUTCString();t=function(e){return i(e,"",a)},o=["","_last","_cst"];break;case L:t=function(n){return q.removeDataFromLocalStorage(e.config.storage.name+n)},o=["","_last","_exp","_cst"]}t&&o.forEach((function(e){try{t(e)}catch(e){(0,v.logError)(e)}}))}function Q(e){var n=(0,v.getPrebidInternal)().setEidPermissions;"function"==typeof n&&(0,v.isArray)(e)&&n(function(e){var n=[];return e.filter((function(e){return(0,v.isPlainObject)(e.idObj)&&Object.keys(e.idObj).length})).forEach((function(e){Object.keys(e.idObj).forEach((function(r){var t=h.get(r)||{};(0,b.Z)(e,"config.bidders")&&Array.isArray(e.config.bidders)&&t.source&&n.push({source:t.source,bidders:e.config.bidders})}))})),n}(e))}function X(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,t=e.storageMgr,o=e.config.storage,i=r?"".concat(o.name,"_").concat(r):o.name;try{if(o.type===R)n=t.getCookie(i);else if(o.type===L){var a=t.getDataFromLocalStorage("".concat(o.name,"_exp"));""===a?n=t.getDataFromLocalStorage(i):a&&new Date(a).getTime()-Date.now()>0&&(n=decodeURIComponent(t.getDataFromLocalStorage(i)))}"string"==typeof n&&"{"===n.trim().charAt(0)&&(n=JSON.parse(n))}catch(e){(0,v.logError)(e)}return n}function ee(e,n,r){n=V().fork().startTiming("userId.callbacks.total").stopBefore(n);var t=(0,v.delayExecution)((function(){clearTimeout(undefined),n()}),e.length);e.forEach((function(e){var n=Y(e.submodule.name).startTiming("callback").stopBefore(t);try{e.callback((function(t){t?(e.config.storage&&H(e,t),e.idObj=e.submodule.decode(t,e.config),Ie(ne(r))):(0,v.logInfo)("".concat(F,": ").concat(e.submodule.name," - request id responded with an empty value")),n()}),X.bind(null,e))}catch(r){(0,v.logError)("Error in userID module '".concat(e.submodule.name,"':"),r),n()}e.callback=void 0}))}function ne(e){return Array.isArray(e)&&e.length?te(e):{}}function re(e,n,r){return Object.fromEntries(Object.entries(e.reduce((function(e,t){var o=n(t);return o&&Object.keys(o).forEach((function(n){var i,a=null===(i=J[n])||void 0===i?void 0:i.indexOf(r(t)),u={priority:(0,v.isNumber)(a)?a:-1,value:o[n]};if(e[n]){var c=u.priority>e[n].priority?u:e[n];e[n]=c}else e[n]=u})),e}),{})).map((function(e){var n=(0,i.Z)(e,2);return[n[0],n[1].value]})))}function te(e){return re(e.filter((function(e){return(0,v.isPlainObject)(e.idObj)&&Object.keys(e.idObj).length})),(function(e){return e.idObj}),(function(e){return e.submodule.name}))}function oe(e,n){[e].some((function(e){return!Array.isArray(e)||!e.length}))||e.forEach((function(e){e.bids&&(0,v.isArray)(e.bids)&&e.bids.forEach((function(e){var r=function(e,n){return Array.isArray(e)&&e.length&&n?te(e.filter((function(e){return!e.config.bidders||!(0,v.isArray)(e.config.bidders)||(0,c.q9)(e.config.bidders,n)}))):{}}(n,e.bidder);Object.keys(r).length&&(e.userId=r,e.userIdAsEids=p(r))}))}))}var ie,ae={};function ue(){var e,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=r.delay,o=void 0===t?k.Z.timeout:t,i=(0,k.P)(),a=(0,k.P)(),u=!1;function c(r){return n=V().fork(),null!=e&&e.reject(ae),e=(0,k.P)(),k.Z.race([r,e.promise]).finally(n.startTiming("userId.total"))}var s=y,d=B;function b(e){return function(){if(s===y&&d===B)return e.apply(void 0,arguments)}}function h(){return l.NO.promise.finally(n.startTiming("userId.init.consent"))}var p=c(k.Z.all([m.Cd,i.promise]).then(h).then(b((function(){we(s,d)}))).then((function(){return a.promise.finally(n.startTiming("userId.callbacks.pending"))})).then(b((function(){var e=s.filter((function(e){return(0,v.isFn)(e.callback)}));if(e.length)return new k.Z((function(n){return ee(e,n,s)}))}))));return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.refresh,r=void 0!==n&&n,t=e.submoduleNames,l=void 0===t?null:t,m=e.ready,v=void 0!==m&&m;return v&&!u&&(u=!0,i.resolve(),w>0?a.resolve():f.on(g.FP.AUCTION_END,(function e(){f.off(g.FP.AUCTION_END,e),o(I).then(a.resolve)}))),r&&u&&(p=c(p.catch((function(){return null})).then(h).then(b((function(){var e=we(s,d.filter((function(e){return null==l||l.includes(e.submodule.name)})),!0).filter((function(e){return null!=e.callback}));if(e.length)return new k.Z((function(n){return ee(e,n,s)}))}))))),p}}function ce(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:le()||[],n=E&&e.find((function(e){return e.source===E}));if(n&&"string"==typeof(0,b.Z)(n,"uids.0.id")){var r=n.uids[0].id.replace(/[\W_]/g,"");if(r.length>=32&&r.length<=150)return r;(0,v.logWarn)("User ID - Googletag Publisher Provided ID for ".concat(E," is not between 32 and 150 characters - ").concat(r))}}var se=(0,C.g3)("userId",(function(e,n){var r=this,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=t.delay,i=void 0===o?k.Z.timeout:o,a=t.getIds,c=void 0===a?he:a;k.Z.race([c().catch((function(){return null})),i(w)]).then((function(){oe(n.adUnits||(0,u.R)().adUnits,y),V().join((0,C.Bf)(n.metrics),{propagate:!1,includeGroups:!0}),e.call(r,n)}))}));function fe(){return ne(y)}function le(){return p(fe())}function de(e){return p(function(e,n){if(!Array.isArray(e)||!e.length)return{};var r=te(e),t=Object.keys(r).find((function(e){var r=h.get(e);return(null==r?void 0:r.source)===n||(0,v.isFn)(null==r?void 0:r.getSource)&&r.getSource()===n}));return t?(0,a.Z)({},t,r[t]):[]}(y,e))[0]}function ge(e,n,r){return ie().then((function(){var t={};if((0,v.isFn)(r)){(0,v.logInfo)("".concat(F," - Getting encrypted signal from custom function : ").concat(r.name," & source : ").concat(e," "));var o=r(e);t[e]=o?me(o):null}else{var i=de(e);(0,v.logInfo)("".concat(F," - Getting encrypted signal for eids :").concat(JSON.stringify(i))),(0,v.isEmpty)(i)||(t[i.source]=!0===n?me(i):i.uids[0].id)}return(0,v.logInfo)("".concat(F," - Fetching encrypted eids: ").concat(t[e])),t[e]}))}function me(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r="";if(1===n)r="object"===(0,o.Z)(e)?window.btoa(JSON.stringify(e)):window.btoa(e);return"".concat(n,"||").concat(r)}function ve(){if((0,v.isGptPubadsDefined)()){window.googletag.secureSignalProviders=window.googletag.secureSignalProviders||[];var e=s.vc.getConfig("userSync.encryptedSignalSources");if(e){var n=e.registerDelay||0;setTimeout((function(){e.sources&&e.sources.forEach((function(e){var n=e.source,r=e.encrypt,t=e.customFunc;n.forEach((function(e){window.googletag.secureSignalProviders.push({id:e,collectorFunction:function(){return ge(e,r,t)}})}))}))}),n)}else(0,v.logWarn)("".concat(F," - ESP : encryptedSignalSources config not defined under userSync Object"))}}function be(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.submoduleNames,r=arguments.length>1?arguments[1]:void 0;return ie({refresh:!0,submoduleNames:n}).then((function(){return r&&(0,v.isFn)(r)&&r(),fe()}))}function he(){return ie().then((function(){return fe()}),(function(e){return e===ae?Promise.resolve().then(he):((0,v.logError)("Error initializing userId",e),k.Z.reject(e))}))}function pe(){for(var e=Number(l.NO.hash),n=[];e>0;)n.push(String.fromCharCode(255&e)),e>>>=8;return btoa(n.join())}function ye(e,n,r){var t=l.rp.getConsentData();if(e.config.storage){var o,i=X(e),a=!1;if("number"==typeof e.config.storage.refreshInSeconds){var u=new Date(X(e,"last"));a=u&&Date.now()-u.getTime()>1e3*e.config.storage.refreshInSeconds}!i||a||n||function(e){var n=X(e,"cst");return!n||n!==pe()}(e)?o=e.submodule.getId(e.config,t,i):"function"==typeof e.submodule.extendId&&(o=e.submodule.extendId(e.config,t,i)),(0,v.isPlainObject)(o)&&(o.id&&(H(e,o.id),i=o.id),"function"==typeof o.callback&&(e.callback=o.callback)),i&&(e.idObj=e.submodule.decode(i,e.config))}else if(e.config.value)e.idObj=e.config.value;else{var c=e.submodule.getId(e.config,t,void 0);(0,v.isPlainObject)(c)&&("function"==typeof c.callback&&(e.callback=c.callback),c.id&&(e.idObj=e.submodule.decode(c.id,e.config)))}Ie(ne(r))}function Ie(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fe();if(e&&E){var n=ce(p(e));n&&((0,v.isGptPubadsDefined)()?window.googletag.pubads().setPublisherProvidedId(n):(window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[],window.googletag.cmd.push((function(){window.googletag.pubads().setPublisherProvidedId(n)}))))}}function we(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return V().fork().measureTime("userId.init.modules",(function(){if(!n.length)return[];if(!(n=n.filter((function(e){return(!e.config.storage||De(e))&&G.isAllowed(x.EL,(0,U.T)(Z.y2,e.config.name))}))).length)return(0,v.logWarn)("".concat(F," - no ID module configured")),[];var t=n.reduce((function(e,t){return Y(t.submodule.name).measureTime("init",(function(){try{ye(t,r,n),e.push(t)}catch(e){(0,v.logError)("Error in userID module '".concat(t.submodule.name,"':"),e)}return e}))}),[]);return t.length&&Q(t),t.forEach(Ee.bind(null,e)),t}))}function Ee(e,n){for(var r=!1,t=0;t<e.length;t++)if(n.config.name.toLowerCase()===e[t].config.name.toLowerCase()){r=!0,e[t]=n;break}r||e.push(n)}var Se=new Set([L,R]);function De(e){var n,r;switch(null===(n=e.config)||void 0===n||null===(r=n.storage)||void 0===r?void 0:r.type){case L:if(e.storageMgr.localStorageIsEnabled())return!q.getDataFromLocalStorage(_)||((0,v.logInfo)("".concat(F," - opt-out localStorage found, storage disabled")),!1);break;case R:if(e.storageMgr.cookiesAreEnabled())return!q.getCookie(_)||((0,v.logInfo)("".concat(F," - opt-out cookie found, storage disabled")),!1)}return!1}function Oe(e){h.clear(),Object.entries(re(e,(function(e){return e.eids}),(function(e){return e.name}))).forEach((function(e){var n=(0,i.Z)(e,2),r=n[0],t=n[1];return h.set(r,t)}))}function je(){Oe(z);var e=function(e,n){return Array.isArray(e)?e.reduce((function(e,n){return!n||(0,v.isEmptyStr)(n.name)||(n.storage&&!(0,v.isEmptyStr)(n.storage.type)&&!(0,v.isEmptyStr)(n.storage.name)&&Se.has(n.storage.type)||(0,v.isPlainObject)(n.value)?e.push(n):n.storage||n.value||e.push(n)),e}),[]):[]}(W);if(e.length){var n=z.filter((function(e){return!(0,c.sE)(B,(function(n){return n.name===e.name}))}));B.splice(0,B.length),n.map((function(n){var r=(0,c.sE)(e,(function(e){return e.name&&(e.name.toLowerCase()===n.name.toLowerCase()||n.aliasName&&e.name.toLowerCase()===n.aliasName.toLowerCase())}));return r&&n.name!==r.name&&(r.name=n.name),n.findRootDomain=N.W,r?{submodule:n,config:r,callback:void 0,idObj:void 0,storageMgr:(0,O.df)({moduleType:Z.y2,moduleName:r.name})}:null})).filter((function(e){return null!==e})).forEach((function(e){return B.push(e)})),!M&&B.length&&((0,u.R)().requestBids.before(se,40),d.ZP.callDataDeletionRequest.before(ke),P.G.after((function(e){return e(ce())})),(0,v.logInfo)("".concat(F," - usersync config updated for ").concat(B.length," submodules: "),B.map((function(e){return e.submodule.name}))),M=!0)}}function Pe(e,n){if(e){var r={},o=new Map(n.map((function(e){return e.submodule.aliasName?[e.submodule.aliasName,e.submodule.name]:[]})));Object.keys(e).forEach((function(n){var i=(0,v.isArray)(e[n])?(0,t.Z)(e[n]).reverse():[];r[n]=i.map((function(e){return o.has(e)?o.get(e):e}))})),J=r}else J={}}function ke(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),t=1;t<n;t++)r[t-1]=arguments[t];(0,v.logInfo)("UserID: received data deletion request; deleting all stored IDs..."),B.forEach((function(e){if("function"==typeof e.submodule.onDataDeletionRequest)try{var n;(n=e.submodule).onDataDeletionRequest.apply(n,[e.config,e.idObj].concat(r))}catch(n){(0,v.logError)("Error calling onDataDeletionRequest for ID submodule ".concat(e.submodule.name),n)}K(e)})),e.apply(this,r)}function Ae(e){return function(){return Promise.resolve(e.apply(this,arguments))}}!function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.delay,t=void 0===r?k.Z.timeout:r;E=void 0,B=[],W=[],M=!1,y=[],ie=ue({delay:t}),null!=S&&S(),z=[],S=e.getConfig("userSync",(function(e){var n=e.userSync;n&&(E=n.ppid,n.userIds&&(W=n.userIds,I=(0,v.isNumber)(n.syncDelay)?n.syncDelay:500,w=(0,v.isNumber)(n.auctionDelay)?n.auctionDelay:0,je(),Pe(n.idPriority,B),ie({ready:!0})))})),(0,u.R)().getUserIds=fe,(0,u.R)().getUserIdsAsEids=le,(0,u.R)().getEncryptedEidsForSource=Ae(ge),(0,u.R)().registerSignalSources=ve,(0,u.R)().refreshUserIds=Ae(be),(0,u.R)().getUserIdsAsync=Ae(he),(0,u.R)().getUserIdsAsEidBySource=de}(s.vc),(0,m.bA)("userId",(function(e){(0,c.sE)(z,(function(n){return n.name===e.name}))||(z.push(e),l.qh.register(Z.y2,e.name,e.gvlid),je(),ie({refresh:!0,submoduleNames:[e.name]}))})),(0,A.f8)({type:A.Z,name:"userExtEids",fn:function(e,n,r){var t=(0,b.Z)(r,"bidRequests.0.userIdAsEids");t&&Object.keys(t).length>0&&(0,j.N)(e,"user.ext.eids",t)}}),(0,u.z)("userId")},7563:function(e,n,r){r.d(n,{G:function(){return t}});var t=(0,r(92797).z3)("sync",(function(){}))},26372:function(e,n,r){r.d(n,{DZ:function(){return a},Px:function(){return u},TP:function(){return s},YC:function(){return c},Z:function(){return i},f8:function(){return m},fP:function(){return v},gm:function(){return t},md:function(){return f}});var t=["request","imp","bidResponse","response"],o=["default","pbs"],i=t[0],a=t[1],u=t[2],c=t[3],s=o[0],f=o[1],l=new Set(t);var d,g=(d={},{registerOrtbProcessor:function(e){var n=e.type,r=e.name,o=e.fn,i=e.priority,a=void 0===i?0:i,u=e.dialects,c=void 0===u?[s]:u;if(!l.has(n))throw new Error("ORTB processor type must be one of: ".concat(t.join(", ")));c.forEach((function(e){d.hasOwnProperty(e)||(d[e]={}),d[e].hasOwnProperty(n)||(d[e][n]={}),d[e][n][r]={priority:a,fn:o}}))},getProcessors:function(e){return d[e]||{}}}),m=g.registerOrtbProcessor,v=g.getProcessors}},function(e){var n;n=82547,e(e.s=n)}]);
window.pbjs = window.pbjs || {};
pbjs.cmd=pbjs.cmd || [];
pbjs.cmd.push(function() {
   var rubiConf = pbjs.getConfig('rubicon') || {};
   rubiConf.rule_name = 'Catch All Rule';
   let rubiFloors = pbjs.rp && pbjs.rp.floors || {};
   pbjs.setConfig({
      rubicon: rubiConf,
  });
});
pbjs.processQueue();
//EOF