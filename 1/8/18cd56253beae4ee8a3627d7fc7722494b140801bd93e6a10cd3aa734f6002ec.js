(window.webpackJsonp=window.webpackJsonp||[]).push([[82],{1265:function(t,e,i){"use strict";i.r(e);var s=i(5),a=i(1102),n=i(93),r=i(509),l=i(820),o=i(871),c=i(810),u=i(507),d=i(17),h=i(155),p=i(87),m=i(589),k=i(564),f=i(889),b=i(844),g=i(963),L=i(845),v=i(1116),_={components:{BaseButton:u.a,ControlLoader:o.a,FormRow:r.o,ThreadDuplicates:l.a,ControlLinkErrors:c.a,CheckLinkDuplicates:f.a,CheckBlockedLinks:b.a,GetLinkSuggestion:g.a,GetLinkMerchantSuggestion:L.a,EventTrigger:v.a,FormInputLabeled:r.i,FormInputIcon:r.h,FormInputButton:r.g},mixins:[m.b],props:{},data:()=>Object.assign({},Object(p.d)({thread:{namespace:"threadForm",path:"thread",deep:!0}}),{submitLink:"",hasDuplicates:!1,hasErrors:!1}),computed:{canSubmitdealType:()=>d.a,duplicatesFilter:,validations:()=>({link:[Object(k.n)(!0)]}),watch:{"thread.link"(){this.resetLinkData()}},methods:Object.assign({},Object(n.b)("threadForm",["removeAllGalleryImages"]),{resetLink(){this.thread.link="",this.hasDuplicates=!1,this.hasErrors=!1,this.resetLinkData()},resetLinkData(){this.submitLink="",this.$v.clear("link"),this.removeAllGalleryImages()},async validateLink(){await this.$v.validate("link",this.thread.link)},async submit(){await this.validateLink(),!this.$v.error.link&&this.thread.link&&(this.submitLink=this.thread.link)},showFullForm(){Object(h.b)({type:"submit",target:this.$el}),this.$emit("show-full-form")},continueWithLinksubmitWithoutLinksetDuplicates(t){let{hasDuplicates:e}=t;this.hasDuplicates=e},setLinkErrors)},w=i(45),D=Object(w.a)(_,(function(){var t=this,e=t._self._c;return e("section",{directives:[{name:"track",rawName:"v-track:linkForm.view",value:{type:t.dealType},expression:"{ type: dealType }",arg:"linkForm",modifiers:{view:!0}}],staticClass:"flex flex--dir-col flex--grow-1 space--fromW2-h-4 space--h-3 space--t-3 space--b-2"},[e("div",{staticClass:"flex--grow-1 space--mb-3"},[e("h1",{staticClass:"size--all-xxxl size--fromW2-xxl text--b text--color-charcoalTint space--t-3"},[t._v(" "+t._s("Partagez un bon plan avec des millions de personnes")+" ")]),e("p",{staticClass:"size--all-l text--color-greyShade space--mt-3 space--fromW2-mt-1 space--mb-3"},[t._v(" "+t._s("Entrez le lien de la page où il est possible de profiter du deal / d'obtenir davantage d'informations.")+" ")]),e("form",{staticClass:"width--all-12",on:{submit}},[e("div",{staticClass:"flex boxAlign-ai--all-c"},[e("div",{staticClass:"flex--grow-1"},[e("ol",[e("FormRow",[e("FormInputLabeled",{attrs:{id:"link",inputmode:"url",name:"link",placeholder:"https://www.example.com/superdeal"},on:{change:t.validateLink},scopedSlots:t._u([{key:"prependIcon",fn,proxy:!0},{key:"appendButton",fn:function(){return[t.thread.link?e("FormInputButton",{on:{click:t.resetLink}}):t._e()]},proxy:!0}]),model:{value:t.thread.link,callback,expression:"thread.link"}})],1)],1)]),t.canSubmit?e("div",{staticClass:"hide--toW2 space--ml-2"},[e("BaseButton",{directives:[{name:"track",rawName:"v-track:submitWithLink.click",arg:"submitWithLink",modifiers:{click:!0}}],staticClass:"width--all-12",attrs:{variant:"primary",mode:"brand",type:"submit",disabled:!t.thread.link}},[t._v(" "+t._s("Continuer")+" ")])],1):t._e()]),t.submitLink?e("CheckBlockedLinks",{attrs:{link:t.submitLink},on:{request:t.setLinkErrors},scopedSlots:t._u([{key:"default",fn:function({isLoading:i,hasErrors:s,errors:a}){return[s?e("ControlLinkErrors",{attrs:{"error-messages":a},on:{cancel:t.resetLink}}):e("CheckLinkDuplicates",{attrs:{link:t.submitLink,filter:t.duplicatesFilter},on:{request:t.setDuplicates},scopedSlots:t._u([{key:"default",fn:function({isLoading:a,hasDuplicates:n,duplicates:r,isSoftDuplicates:l}){return[e("div",[e("GetLinkSuggestion",{attrs:{link:t.submitLink,"keep-alive":!i}}),e("GetLinkMerchantSuggestion",{attrs:{link:t.submitLink,"keep-alive":!i}}),i||a?e("ControlLoader",[t._v(t._s("Vérification des doublons"))]):n?e("ThreadDuplicates",{attrs:{type:t.dealType,threads:r,"is-soft-duplicates":l},on:{cancel:t.resetLink,continue:t.continueWithLink}}):t._e(),e("EventTrigger",{attrs:{"is-loading":i||a,"has-errors":s||n},on:{trigger:t.showFullForm}})],1)]}}],null,!0)})]}}],null,!1,996990790)}):t._e(),e("ControlLinkErrors",{attrs:{"error-messages":t.$v.messages.link},on:{cancel:t.resetLink}}),t.canSubmit?e("div",{staticClass:"hide--fromW2 space--mt-3"},[e("BaseButton",{directives:[{name:"track",rawName:"v-track:submitWithLink.click",arg:"submitWithLink",modifiers:{click:!0}}],staticClass:"width--all-12 space--mb-3",attrs:{variant:"primary",mode:"brand",type:"submit",disabled:!t.thread.link}},[t._v(" "+t._s("Continuer")+" ")])],1):t._e()],1)]),t.canSubmit?e("div",{staticClass:"hAlign--all-c"},[e("BaseButton",{directives:[{name:"track",rawName:"v-track:submitWithoutLink.click",arg:"submitWithoutLink",modifiers:{click:!0}}],attrs:{variant:"tertiary",mode:"default"},on:{click:t.submitWithoutLink}},[t._v(" "+t._s("Je n'ai pas de lien")+" ")])],1):t._e()])}),[],!1,null,null,null),y=D.exports,S=Object(s.defineComponent)({__name:"deal-submission-wizard",setup:t=>({__sfc:!0,ThreadSubmissionWizardContent:a.a,DealSubmissionLinkForm:y,DEAL_TYPE:d.a})}),F=Object(w.a)(S,(function(){var t=this,e=t._self._c,i=t._self._setupProxy;return e(i.ThreadSubmissionWizardContent,{attrs:{"thread-type":i.DEAL_TYPE}},[e(i.DealSubmissionLinkForm,{staticClass:"flex--grow-1",on:{"show-full-form}}})],1)}),[],!1,null,null,null);e.default=F.exports},889:function(t,e,i){"use strict";var s=i(5),a=i(544),n=i(616),r=i(715);const l=()=>{let t=null;const e=Object(s.ref)([]),i=Object(s.ref)(!1),{isLoading:l,setLoader:o}=Object(a.a)(),c=()=>{e.value=[],i.value=!1,l.value&&Object(r.a)(t)};return{duplicates:e,checkDuplicates:(s,a)=>{s&&(c(),((s,a)=>{t=Object(n.a)(s,a),t.request.then((t=>{t&&(e.value=t.threads,i.value=t.isSoftDuplicates)})).finally(o())})(s,a))},resetDuplicates:c,isLoading:l,isSoftDuplicates:i}};var o=Object(s.defineComponent)({__name:"check-link-duplicates",props:{link:null,filter:null},setup(t){const e=t,{duplicates:i,isLoading:a,isSoftDuplicates:n,checkDuplicates:r,resetDuplicates:o}=l(),c=Object(s.computed)h));return Object(s.watch)k)}),{immediate:!0}),Object(s.onBeforeUnmount)})),{__sfc:!0,props:e,duplicates:i,isLoading:a,isSoftDuplicates:n,checkDuplicates:r,resetDuplicates:o,hasDuplicates:c}}}),c=i(45),u=Object(c.a)(o,(function(){var t=this,e=t._self._c,i=t._self._setupProxy;return e("div",[t._t("default",null,{isLoading:i.isLoading,duplicates:i.duplicates,isSoftDuplicates:i.isSoftDuplicates,hasDuplicates:i.hasDuplicates,reset:i.resetDuplicates})],2)}),[],!1,null,null,null);e.a=u.exports},963:function(t,e,i){"use strict";var s=i(93),a=i(654),n=i(715),r=i(611);let l=null,o=null;var c={props:{link:{type:String,default:""},keepAlive:{type:Boolean,default:!1}},watch:{link:{handler:"linkChange",immediate:!0}},beforeDestr},methods:Object.assign({},Object(s.b)("threadForm",["getFormSuggestionsFromLink","getProductSpecificationFromLink","clearFormSuggestionsFromLink"]),{linkChange(t,e){t!==e&&(this.reset(),this.link&&(this.request(),this.requestProductSpecification()))},async request(){l=await this.getFormSuggestionsFromLink({url:this.link}),l&&l.request.then(r.a).catch((()=>{})).finally(Object(a.a)(this,"isLoading"))},async requestProductSpecification(){o=await this.getProductSpecificationFromLink({url:this.link}),o&&o.request.catch}))},cancelRequest(){this.isLoading&&(Object(n.a)(l),Object(n.a)(o))},res}}),render(){return this.$scopedSlots.default?this.$scopedSlots.default({isLoading:this.isLoading}):null}},u=i(45),d=Object(u.a)(c,undefined,undefined,!1,null,null,null);e.a=d.exports}}]);