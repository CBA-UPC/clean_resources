;
(self.AMP=self.AMP||[]).push({m:0,v:"2312191621000",n:"amp-user-notification",ev:"0.1",l:!0,f:function(t,n){!function(){r r;ar o=c=Array.isArray,h=Object.prototype;sOwnProperty,h.toString,self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var m=self.__AMP_LOG;tificationUIManager",G=),M=function(){function t(t){this.G=t,this.K=0,this.Y=0,this.rr=Object.create(null)}var n=t.prototype;return n.has=n.get=n.put=n.nr=t}();function B(t){return"https:"==(t=function(t){return"string"==typeof t?function(t,n){return T||(T=self.document.createElement("a"),F=self.__AMP_URL_CACHE||(self.__AMP_URL_CACHE=new M(100))),T,t,F)}(t):t}(t)).protocol||"localhost"==t.hostname||"127.0.0.1"==t.hostname||(i=".localhost",(r=(n=t.hostname).length-i.length)>=0&&n.indexOf(i,r)==r);var n,i,r}ar L="amp-user-notification",q="userNotificationManager",z=function(t){!h,t);var n,i,r=(n=h,i=),;function h(t){var n;(n=r.call(this,t)).qct=null,n.$ct=null;var i=new o;return n.Jct=i.promise,n.Kct=i.resolve,n.Qct=null,n.Wct=!1,n.Zct=null,n.tvt=null,n.nvt=null,n.ivt=null,n.mV="",n.pV=null,n.wj=null,n}var l=h.prototype;return l.isAlwaysFixed=l.buildCallback=function(){var t,n,i,r=this,e=this.getAmpDoc();this.wj=(t=this.element,n="url-replace",A(i=R(P(t)),n)?x(i,n):null),this.pV=S(this.element,"storage"),this.$ct=O(this.element.id,"amp-user-notification should have an id."),this.mV="amp-user-notification:"+this.$ct,this.Zct=this.element.getAttribute("data-show-if-geo"),this.tvt=this.element.getAttribute("data-show-if-not-geo"),this.ivt=this.element.getAttribute("data-show-if-href"),this.ivt&&D(this.ivt,this.element),O(!!this.ivt+!!this.Zct+!!this.tvt<=1,'Only one "data-show-if-*" attribute allowed'),this.Zct&&(this.nvt=this.rvt(this.Zct,!0)),this.tvt&&(this.nvt=this.rvt(this.tvt,!1)),this.Qct=this.element.getAttribute("data-dismiss-href"),this.Qct&&D(this.Qct,this.element),this.element.getAttribute("role")||this.element.setAttribute("role","alert");var o=this.element.getAttribute("data-persist-dismissal");this.Wct="false"!=o&&"no"!=o,this.registerDefaultAction((function(){return r.dismiss(!1)}),"dismiss"),this.registerAction("optoutOfCid",(function(){return r.evt()})),S(e,q).then(()},l.rvt=function(t,n){return(i=this.element,i,"geo","amp-geo")).then((function(i){O(i,"requires <amp-geo> to use promptIfUnknownForGeoGroup");var r=t.split(/,\s*/).filter(();return!!(n?r.length:!r.length)}));var i},l.ovt=function(t){var n=this,i=this.ivt;return this.wj.expandUrlAsync(i).then((function(i){return i,{"elementId":n.$ct,"ampUserId":t}))}))},l.uvt=function(t){var n=this;return this.qct=t,this.ovt(t).then((function(t){return N(n.win).fetchJson(t,{credentials:"include"}).then((function(t){return t.json()}))}))},l.svt=function(){var t=this.element.getAttribute("enctype")||"application/json;charset=utf-8";return N(this.win).fetchJson(this.Qct,this.fvt(t,this.$ct,this.qct))},l.fvt=function(t,n,i){return{method:"POST",credentials:"include",body:{"elementId":n,"ampUserId":i},headers:{"Content-Type":t}}},l.avt=function(t){return O("boolean"==typeof t.showNotification,'`showNotification` should be a boolean. Got "%s" which is of type %s.',t.showNotification,u(t.showNotification)),t.showNotification||this.Kct(),Promise.resolve(t.showNotification)},l.evt=function(){var t=this;return this.cvt().then(().then((,(function(n){j().error(L,"Failed to opt out of Cid",n),t.dismiss(!0)}))},l.hvt=function(){var t=this;return this.cvt().then((function(n){return n.get({scope:L,createCookieIfNotPresent:!0},e(),t.Jct)}))},l.cvt=l.shouldShow=function(){var t=this;return this.isDismissed().then((function(n){return!n&&(t.ivt?t.lvt():!t.nvt||t.nvt)}))},l.lvt=l.show=function(){var t,n;return t=this.element,void 0===(n=!0)&&(n=t.hasAttribute("hidden")),n?t.removeAttribute("hidden"):t.setAttribute("hidden",""),this.element.classList.add("amp-active"),this.getViewport().addToFixedLayer(this.element),this.Jct},l.isDismissed=function(){var t=this;return this.Wct?this.pV.then(().then((,(function(t){return j().error(L,"Failed to read storage",t),!1})):Promise.resolve(!1)},l.dismiss=function(t){var n=this;this.element.classList.remove("amp-active"),this.element.classList.add("amp-hidden"),this.Kct(),this.getViewport().removeFromFixedLayer(this.element),this.Wct&&!t&&this.pV.then((),this.Qct&&this.svt()},h}(t.BaseElement),$=function(){function t(t){this.ampdoc=t,this.Mt=Object.create(null),this.vvt=Object.create(null),this.dvt=this.ampdoc.whenReady(),this.pvt=Promise.all([this.ampdoc.whenFirstVisible(),this.dvt]),this.mvt=S(this.ampdoc,k)}var n=t.prototype;return n.get=function(t){var n=this;return this.pvt.then((function(){null==n.ampdoc.getElementById(t)&&y().warn(L,"Did not find amp-user-notification element ".concat(t,"."))})),this.bvt(t).promise},n.getNotification=function(t){var n=this;return this.dvt.then(()},n.registerUserNotification=function(t,n){var i=this;this.Mt[t]=n;var r=this.bvt(t);return this.pvt.then(().then((function(t){if(t)return i.mvt.then(()})).then(r.resolve.bind(this,n)).catch(p.bind(null,"Notification service failed amp-user-notification",t))},n.bvt=function(t){if(this.vvt[t])return this.vvt[t];var n=new o,i=n.promise,r=n.resolve;return this.vvt[t]={promise:i,resolve:r}},t}();t.registerServiceForDoc(q,$),t.registerServiceForDoc(k,G),t.registerElement(L,z,"amp-user-notification{position:fixed!important;bottom:0;left:0;overflow:hidden!important;visibility:hidden;background:hsla(0,0%,100%,0.7);z-index:1000;width:100%}amp-user-notification.amp-active{visibility:visible}amp-user-notification.amp-hidden{visibility:hidden}\n/*# sourceURL=/extensions/amp-user-notification/0.1/amp-user-notification.css*/")}();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-user-notification-0.1.js.map