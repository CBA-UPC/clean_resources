(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[677],{"/Fzb":function(e,t,n){"use strict";n.r(t),n.d(t,"WebVitalsModuleNgFactory",(function(){return $}));var i=n("keVe"),r=n("4/We"),a=n("QjXU"),o=n("hhzZ"),c=n("casz"),u=n("BMb5"),s=function(){eturn e.prototype.getMemoryProfile=function(){var e=this;"measureUserAgentSpecificMemory"in this.currentWindow.performance&&this.scheduler.scheduleWork((function(){e.currentWindow.performance.measureUserAgentSpecificMemory().then((function(t){var n,i=t.bytes,r=e.cleanMemoryBreakdown(t.breakdown),a=((n={}).MemoryProfileBreakdown=JSON.stringify(r),n.TotalSize=i,n);e.instrumentationService.logGenericEvent("Memory_Usage",a)})).catch((function(){}))}),4)},e.prototype.cleanMemoryBreakdown=function(e){var t,n,i,r;try{for(var o=Object(a.__values)(e),c=o.next();!c.done;c=o.next()){var u=c.value.attribution;try{for(var s=(i=void 0,Object(a.__values)(u)),f=s.next();!f.done;f=s.next()){var l=f.value,d=new URL(l.url);l.url=d.hostname+d.pathname}}catch(e){i={error:e}}finally{try{f&&!f.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return e},e.ɵprov=i.kc({factory:function(){return new e(i.lc(o.a),i.lc(c.a),i.lc(u.b))},token:e,providedIn:"root"}),e}(),f=n("Cin9"),l=n("pM41"),d=n("MJsD"),v={OfficeHome:["Shell","AppBar","QuickAccess","MRU","Recommended","CreateOnHome"],Pwa:["Shell","AppBar","QuickAccess","MRU","Recommended","CreateOnHome"],Start:["Shell","AppBar","Templates","Recommended","EdgeworthFirst"],Create:["Shell","AppBar","CreateCenter"]};function m(){var e,t;return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,i,r,o;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return[4,Object(d.a)()];case 1:return n=a.sent(),i=null===(e=null==n?void 0:n.router)||void 0===e?void 0:e.getCurrentRoute(),o=(r=null==i?void 0:i.route)&&null!==(t=v[r])&&void 0!==t?t:[],[2,new Set(o)]}}))}))unction y(e){var t=e.name,n=e.startTime;if(t.startsWith("Paint_")){var i=t.split("_");if(i.length>=2)return{feature:i[1],latency:Math.round(n)}}else if("shell_plus_end"===t)return{feature:"Shell",latency:Math.round(n)}}function b(){var e=p().TTVR;e&&Object(f.a)({eventName:"TTVR",latency:e})}function g(e,t){var n;return Object(a.__awaiter)(this,void 0,void 0,(function(){var i,r,o,c,u,s,l,d;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return i=p(),[4,m()];case 1:if(!(r=a.sent()).size)return null==t||t.disconnect(),[2];for(o=null!==(n=i.TTVR)&&void 0!==n?n:0,c=0;c<e.length;c++)(u=y(e[c]))&&(l=u.latency,r.has(s=u.feature)&&(d=h(s),i[d]||(Object(f.a)({eventName:d,latency:l}),i[d]=l,o=Math.max(o,l))));return o>0&&(i.TTVR=o),[2]}}))}))}function w(e){void 0===e&&(e=!1);var t=function(){try{var e=new PerformanceObserver((function(e,t){g(e.getEntriesByType("mark"),t)}));return e.observe({type:"mark",buffered:!0})}catch(e){return function(){try{g(performance.getEntriesByType("mark")),b()}catch(e){}}}}();if(!e)return t;!function(e){var t=!1,n,i=function(e){"pagehide"!==e.type&&"hidden"!==document.visibilityState||(n(),window.removeEventListener(e.type,i))};window.addEventListener("visibilitychange",i,!0),window.addEventListener("pagehide",i,!0);var r=["keydown","click"],a=function(){n(),r.forEach())};r.forEach())}(t)}var S,T,_,C,E,F,k,L,P="function"==typeof WeakSet?new WeakSet:new Set,M,O=-1,j,I,B,R,D={passive:!0,capture:!0},A=new Date,V,U,W,z,N=function(e,t){var n,i=B(),r=E("FID"),a,o=F("first-input",a);n=M(e,r,t),o&&k(),!0),o&&L())},x,J=n("W3Zz"),Q=function()return e.prototype.getVitalsAndTTVR=function(){var e=this,t=this.deviceDetector.deviceInfo.browser.browserType;this.scheduler.scheduleWork(t===J.a.Chrome||t===J.a.Edge||t===J.a.Opera?function(){try{var t=w();((function(t){return e.assignMetric(t)})),R((function(t){return e.assignMetric(t)})),N((function(t){return e.assignMetric(t)})),x((function(t){return e.assignMetric(t)}))())}catch(e){}}:t===J.a.Firefox||t===J.a.Safari?function(){try{w(!0),R((function(t){return e.assignMetric(t)})),N((function(t){return e.assignMetric(t)})),x((function(t){return e.assignMetric(t)}))}catch(e){}}:t===J.a.IE?function(){try{w(!0),x())}catch(e){}},4),this._FCI=this.scheduler.FCI,this.instrumentationService.logPerformanceEvent("FCI",this._FCI),Object(f.a)({eventName:"FCI",latency:this._FCI})},e.prototype.assignMetric=function(e){switch(e.name){case"CLS":this._CLS=e;break;case"FCP":this._FCP=e;break;case"FID":this._FID=e;break;case"LCP":this._LCP=e;break;case"TTFB":this._TTFB=e}this.logMetric(e)},e.prototype.logMetric=function(e){var t,n=e.name,i=e.value;if("CLS"!==n)this.instrumentationService.logPerformanceEvent(n,i),Object(f.a)({eventName:n,latency:i});else{var r=((t={}).TotalSize=String(i),t);this.instrumentationService.logPerformanceEvent(n,i,r),Object(l.a)({eventName:n,latency:i,instrumentationParams:r})}},Object.defineProperty(e.prototype,"CLS",{get:function(){return void 0!==this._CLS?this._CLS:-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FCI",{get:function(){return void 0!==this._FCI?this._FCI:-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FCP",{get:function(){return void 0!==this._FCP?this._FCP:-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FID",{get:function(){return void 0!==this._FID?this._FID:-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"LCP",{get:function(){return void 0!==this._LCP?this._LCP:-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TTFB",{get:function(){return void 0!==this._TTFB?this._TTFB:-1},enumerable:!0,configurable:!0}),e.ɵprov=i.kc({factor},token:e,providedIn:"root"}),e}(),Z=function(}return e.prototype.ngOnInit=function(){var e=this;this.ngZone.runOutsideAngular((function(){e.capabilitiesService.capabilities.webVitalsEnabled&&e.webVitalsService.getVitalsAndTTVR(),e.capabilitiesService.capabilities.memoryProfilingEnabled&&e.memoryService.getMemoryProfile()}))},e}(),q=Z,}(),G=i.Fb({encapsulation:2,styles:[],data:{}}}var K=i.Db("ohp-web-vitals",Z,(function(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-web-vitals",[],null,null,null,X,G)),i.Gb(1,114688,null,0,Z,[r.a,s,i.F,Q],null,null)]}),null)}),{},{},[]),Y=n("CCRL"),$=i.Eb(H,[],(function(e){return i.Tb([i.Ub(512,i.k,i.hb,[[8,[K]],[3,i.k],i.D]),i.Ub(4608,Q,Q,[o.a,c.a,J.c]),i.Ub(1073742336,H,H,[]),i.Ub(256,Y.a,q,[])])}))},MJsD:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("QjXU"),r=n("B5kz"),a=n("zPZ9");function o(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){return[2,r.a.fetchQuery(["OfficeComponentContext"]}),{cacheTime:1/0,staleTime:1/0})]}))}))}}}]);
//# sourceMappingURL=web-vitals.84d482456d5a78a19048.chunk.v7.js.map