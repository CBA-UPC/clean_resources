(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[658],{"+I+c":"7L9N":E02R:NS33:O2oa:function(e,t,o){"use strict";o.r(t);var n=o("QjXU"),r=o("NZpx"),a=o("NrNW"),i=o("ynVX"),c=o("MgoT");function u(e,t,o,r){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(n){return e&&t&&o&&r?[2,{jwtAuthEnabled:e.jwtAuthEnabled,getAccessToken:e.getAccessToken,officeHomeApiRoot:e.officeHomeApiRoot,officeCorrelationId:e.correlationId,inMockMode:e.inMockMode,graphApiRoot:t.graphApiRoot,userId:o.puid,loginHint:o.loginHint,loginHintEnabled:r.outgoingLoginHintEnabled}]:[2,Promise.resolve(void 0)]}))}))}var l=o("B5kz"),s=o("CaQ9"),d=o("mXGw"),f=o.n(d),p=o("P1B7"),_=o("m32Q"),b=o("lkvL"),g=o("a3FV"),h=o("CMIS"),O=o("Wa5Y"),v=o("zPk6"),m=o("gI4v"),j=o("fNDz"),N="graph-get-onenote-notebooks-api";function x(e,t){var o=this;if(e)return Object(p.a)((function(){return function(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){var e,o,r,a;return Object(n.__generator)(this,(function(n){return t?(e="".concat(m.b,"?orderby=lastModifiedTime%20desc"),o=t.inMockMode?t.officeHomeApiRoot:t.graphApiRoot,r=Object(j.a)(o,e,!1),a={headers:{},responseType:"json"},[2,Object(O.a)(g.a.OneNoteGraphGetNotebooksRequest,"OneNote_Graph_Get_NoteBooks",r,a,t.jwtAuthEnabled,t.getAccessToken,t.officeHomeApiRoot,t.officeCorrelationId,"Graph",{populateRequestEvent:function(e,t){t.RequestId=Object(v.a)(e)||""}},"network-first").then((function(e){return e&&e.data?Promise.resolve({value:e.data.value,fromCache:!1}):Promise.reject({clientError:"Invalid response returned for Graph OneNote Notebook request"})})).catch((function(e){return Object(h.a)({eventName:"OneNote_Graph_Get_NoteBooks_Error",errorType:"OneNote_Get_Graph_Error",message:e.httpResponse.statusText}),Promise.reject({clientError:"fetchNotebooks Error: ".concat(e.httpResponse.statusText)})}))]):[2,Promise.reject({clientError:"Invalid createNewNotebookOptions"})]}))}))}(0,e)}),(function(){return Object(_.a)({userId:e.userId,collectionName:N,collectionVersion:1,key:e.userId})}),(function(t){return Object(n.__awaiter)(o,void 0,void 0,(function(){return Object(n.__generator)(this,(function(o){return[2,Object(b.a)({userId:e.userId,collectionName:N,collectionVersion:1,key:e.userId,data:t})]}))}))}),()}var k=o("h8qh"),y=o("GuUx"),E=o("5nT3"),w=o("wt0k"),R=o("MMEL"),C=o("x3xY"),D=o("hoB/"),T=o("LWen"),I=o("X7Ji"),A=o("XxaS"),M=o("AcOL"),S=o("5DIn"),B=o("p/uK"),L=o("DU/N"),H=o("sLnE"),P=Object(B.a)({onenoteDialog_surface:Object(n.__assign)({width:"80%",minWidth:"240px",maxWidth:"448px",boxShadow:L.a.shadow16},H.a.padding("28px"," 32px"," 28px","32px")),onenoteDialog_title:{color:L.a.colorNeutralForeground4,fontSize:"22px",lineHeight:L.a.lineHeightBase500,fontWeight:L.a.fontWeightMedium,fontFamily:L.a.fontFamilyBase},onenoteDialog_button:Object(n.__assign)({marginLeft:"auto",display:"block"},H.a.borderRadius("2px")),onenoteDialog_input:{width:"auto",height:"28px",paddingLeft:"10px",paddingRight:"10px",top:"12px",fontSize:"12px",marginTop:"4px"},invalid_input_error:Object(n.__assign)(Object(n.__assign)({width:"auto",height:"28px"},H.a.borderColor(L.a.colorPaletteRedBorderActive)),{paddingLeft:"10px",paddingRight:"10px",top:"12px",fontSize:"12px",marginTop:"4px"}),onenoteDialog_input_error_message:{color:L.a.colorPaletteRedBorderActive,marginBottom:"5px",marginTop:"15px",minHeight:"36px",fontSize:"12px"},dialog_dismiss:Object(n.__assign)(Object(n.__assign)({marginLeft:"auto",position:"absolute",top:"0",right:"0"},H.a.padding("14px")),{marginRight:"5px",":hover":{color:L.a.colorNeutralForeground2}}),onenoteDialog_body:{display:"flex",flexDirection:"column"},onenoteDialog_input_section:{display:"flex",flexDirection:"column"},onenoteDialog_dialog_actions:{display:"flex",flexDirection:"column"}}),W=function(e){var t=e.inputDialog,o=e.createOneNoteNotebookResources,r=e.handleCreateNotebookClick,a=e.handleInput,i=e.handleDialogComponentClose,c=P(),u=Object(n.__read)(Object(d.useState)(!0),2),l=u[0],s=u[1],p=Object(n.__read)(Object(d.useState)(!0),2),_=p[0],b=p[1],g=Object(n.__read)(Object(d.useState)(""),2),h=g[0],O=g[1],v=Object(n.__read)(Object(d.useState)(!1),2),m=v[0],j=v[1],N=Object(n.__read)(Object(d.useState)(""),2),x=N[0],k=N[1],B=Object(d.useCallback)((function(e){var t,o=e.target.value;if(o){var n=a(o);n&&n.isValid?(s(!1),m&&j(!1),k(o)):(j(!0),O(null!==(t=null==n?void 0:n.errorMessage)&&void 0!==t?t:""),l||s(!0))}else s(!0),m&&j(!1)}),[l,m,a]),L=Object(d.useCallback)((,[i]),H=Object(d.useCallback)((,[r,x]),W=Object(d.useCallback)((function(e){var t=Object(M.a)(e);if(t===S.a.Enter)switch(e.preventDefault(),t){case S.a.Enter:H()}}),[H]);return f.a.createElement(y.a,{modalType:"modal",open:_&&null!=t},f.a.createElement(E.a,{className:c.onenoteDialog_surface,id:"dialog-surface"},f.a.createElement(w.a,{className:c.onenoteDialog_body},f.a.createElement(R.a,{action:"close"},f.a.createElement(C.a,{appearance:"transparent","aria-label":"close",icon:f.a.createElement(A.y,null),onClick:L,className:c.dialog_dismiss})),f.a.createElement(D.a,{className:c.onenoteDialog_title},null==o?void 0:o.createNewBlankText),f.a.createElement(T.a,{className:c.onenoteDialog_dialog_actions},f.a.createElement("div",{id:"input-dialog-section",className:c.onenoteDialog_input_section},f.a.createElement(I.a,{placeholder:null==o?void 0:o.createNewNoteBookInputPlaceholder,id:"onenote-notebook-dialog-input-field",className:m?c.invalid_input_error:c.onenoteDialog_input,onKeyDown:W,onChange:B}),f.a.createElement("div",{id:"input-error",className:c.onenoteDialog_input_error_message},m&&h)),f.a.createElement(C.a,{className:c.onenoteDialog_button,appearance:l?void 0:"primary",onClick:H,disabled:!!l},null==o?void 0:o.createFileDialogButtonText)))))};t.default=function(e){var t,o=e.inputDialog,p=Object(a.a)().data,_=Object(i.a)().data,b=Object(s.a)().data,g=Object(r.a)().data,h=Object(k.a)().data,O=null==h?void 0:h.createOneNoteNotebookResources,v=Object(d.useCallback)((function(){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){return Object(n.__generator)(this,(function(e){switch(e.label){case 0:return p&&_&&b&&g?[3,1]:[2];case 1:return[4,u(p,_,b,g)];case 2:return[2,e.sent()]}}))}))}),[g,p,b,_]),m=function(){var e=this,t=Object(a.a)().data,o=Object(i.a)().data,c=Object(s.a)().data,u=Object(r.a)().data,f=Object(d.useMemo)((function(){return t&&o&&c&&u?{jwtAuthEnabled:t.jwtAuthEnabled,getAccessToken:t.getAccessToken,officeHomeApiRoot:t.officeHomeApiRoot,officeCorrelationId:t.correlationId,inMockMode:t.inMockMode,graphApiRoot:o.graphApiRoot,userId:c.puid,loginHint:c.loginHint,loginHintEnabled:u.outgoingLoginHintEnabled}:void 0}),[u,c,t,o]),p=Object(d.useMemo)((,[]),_=Object(d.useCallback)((function(){return Object(n.__awaiter)(e,void 0,void 0,(function(){return Object(n.__generator)(this,()}))}),[f,p]);return Object(l.c)(p,_,{staleTime:1/0,cacheTime:1/0,enabled:t&&o&&c&&u})}().data,j=function(e,t){if(e&&e.length){var o=[].concat([function(e){return e)?void 0:{isValid:!1,errorMessage:""}},function(e){return function(e,t){var o,r;try{for(var a=Object(n.__values)(["?","*","\\","/",":","<",">","|","'"]),i=a.next();!i.done;i=a.next())if(-1!==e.indexOf(i.value))return!1}catch(e){o={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return!0}(e)?void 0:{isValid:!1,errorMessage:null==t?void 0:t.createNewNoteBookNameInvalidChars}},function(e){return function(e){return!e||e&&" "!==e[0]}(e)?void 0:{isValid:!1,errorMessage:null==t?void 0:t.createNewNoteBookNameCannotStartWithSpace}},function(e){return function(e,t){return e.length<=128}(e)?void 0:{isValid:!1,errorMessage:null==t?void 0:t.createNewNoteBookNameExceeds128Chars}}]);return o.push((function(o){return function(e,t,o){return void 0===o&&(o=!1),o?function(e,t){var o,r;try{for(var a=Object(n.__values)(t),i=a.next();!i.done;i=a.next()){var c=i.value;if(e.trim().toLowerCase()===c.trim().toLowerCase())return!1}}catch(e){o={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return!0}(e,t):-1===t.indexOf(e)}(o,e.map((),!0)?null:{isValid:!1,errorMessage:null==t?void 0:t.createNewNoteBookNameAlreadyExist}})),o}}(null===(t=null==m?void 0:m.result)||void 0===t?void 0:t.value,O);if(!o)return null;var N={inputDialog:o,createOneNoteNotebookResources:O,handleCreateNotebookClick:function(e){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,v()];case 1:return t=n.sent(),o.onResult(e,t),Object(c.a)(),[2]}}))}))},handleInput:function(e){return function(e,t){var o,r;if(t)try{for(var a=Object(n.__values)(t),i=a.next();!i.done;i=a.next()){var c=(0,i.value)(e);if(c)return c}}catch(e){o={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return{isValid:!0,errorMessage:""}}(e,j)},handleDialogComponentClose:;return f.a.createElement(W,Object(n.__assign)({},N))}},W0B4:WZgq:function(e,t,o){"use strict";o.d(t,"a",();var n=o("mXGw"),r=a=new WeakSet;function i(e,t){const o=r();n.useEffect((()=>a.has(o)?e():(a.add(o),void e())),t)}var c=new WeakSet;function u(e,t){return n.useMemo((()=>{const t=r();return c.has(t)?e():(c.add(t),null)}),t)}function l(e,t){var o;const r=(()&&!1,a=r?u:n.useMemo,c=r?i:n.useEffect,[l,s]=null!=(o=a((,t))?o:[null,;return c((,t),l}}}]);
//# sourceMappingURL=vendors~onenote-ip-dialog.6d3420a7266305257ea1.chunk.v7.js.map