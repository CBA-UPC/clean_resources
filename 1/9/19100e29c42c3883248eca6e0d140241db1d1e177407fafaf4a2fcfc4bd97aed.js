(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{Lv3o:function(t,e,n){"use strict";var i,a=n("eVuF"),O=n.n(a),a=n("TRZx"),C=n.n(a),a=n("Bhuq"),j=n.n(a),a=n("SqZg"),N=n.n(a),a=n("Z7t5"),V=n.n(a),a=n("hfKm"),R=n.n(a),a=n("pbKT"),o=n.n(a),a=n("9Jkg"),s=n.n(a),c=n("O40h"),a=n("pLtp"),l=n.n(a),h=n("0iUn"),u=n("sLSF"),d=n("MI3g"),p=n("a7VT"),f=n("AT/M"),y=n("Tit0"),a=n("q1tI"),v=n.n(a),m=n("H8jH"),g=n("FdMb"),w=(n("nOHt"),n("rOcY"),n("Kvkj"),n("7Qib")),k=n("Nlzp"),r=n("okNM"),b=n("3Dls");function T(){T=function(){return o};var c,o={},t=Object.prototype,l=t.hasOwnProperty,h=R.a||function(t,e,n){t[e]=n.value},e="function"==typeof V.a?V.a:{},a=e.iterator||"@@iterator",n=e.asyncIterator||"@@asyncIterator",r=e.toStringTag||"@@toStringTag";function i(t,e,n){return R()(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{i({},"")}catch(c){i=function(t,e,n){return t[e]=n}}function s(t,e,n,a){var r,i,o,s,e=e&&e.prototype instanceof m?e:m,e=N()(e.prototype),a=new L(a||[]);return h(e,"_invoke",{value:(r=t,i=n,o=a,s=d,function(t,e){if(s===f)throw new Error("Generator is already running");if(s===y){if("throw"===t)throw e;return{value:c,done:!0}}for(o.method=t,o.arg=e;;){var n=o.delegate;if(n){n=function t(e,n){var a=n.method,r=e.iterator[a];if(r===c)return n.delegate=null,"throw"===a&&e.iterator.return&&(n.method="return",n.arg=c,t(e,n),"throw"===n.method)||"return"!==a&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+a+"' method")),v;a=u(r,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,v;r=a.arg;return r?r.done?(n[e.resultName]=r.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=c),n.delegate=null,v):r:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}(n,o);if(n){if(n===v)continue;return n}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if(s===d)throw s=y,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);s=f;n=u(r,i,o);if("normal"===n.type){if(s=o.done?y:p,n.arg===v)continue;return{value:n.arg,done:o.done}}"throw"===n.type&&(s=y,o.method="throw",o.arg=n.arg)}})}),e}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}o.wrap=s;var d="suspendedStart",p="suspendedYield",f="executing",y="completed",v={};function m(){}function g(){}function w(){}var e={},k=(i(e,a,function(){return this}),j.a),k=k&&k(k(x([]))),b=(k&&k!==t&&l.call(k,a)&&(e=k),w.prototype=m.prototype=N()(e));function _(t){["next","throw","return"].forEach(function(e){i(t,e,function(t){return this._invoke(e,t)})})}function S(o,s){var e;h(this,"_invoke",{value:function(n,a){function t(){return new s(function(t,e){!function e(t,n,a,r){var i,t=u(o[t],o,n);if("throw"!==t.type)return(n=(i=t.arg).value)&&"object"==typeof n&&l.call(n,"__await")?s.resolve(n.__await).then(function(t){e("next",t,a,r)},function(t){e("throw",t,a,r)}):s.resolve(n).then(function(t){i.value=t,a(i)},function(t){return e("throw",t,a,r)});r(t.arg)}(n,a,t,e)})}return e=e?e.then(t,t):t()}})}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function x(e){if(e||""===e){var n,t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return n=-1,(t=function t(){for(;++n<e.length;)if(l.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=c,t.done=!0,t}).next=t}throw new TypeError(typeof e+" is not iterable")}return h(b,"constructor",{value:g.prototype=w,configurable:!0}),h(w,"constructor",{value:g,configurable:!0}),g.displayName=i(w,r,"GeneratorFunction"),o.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},o.mark=function(t){return C.a?C()(t,w):(t.__proto__=w,i(t,r,"GeneratorFunction")),t.prototype=N()(b),t},o.awrap=function(t){return{__await:t}},_(S.prototype),i(S.prototype,n,function(){return this}),o.AsyncIterator=S,o.async=function(t,e,n,a,r){void 0===r&&(r=O.a);var i=new S(s(t,e,n,a),r);return o.isGeneratorFunction(e)?i:i.next().then(function(t){return t.done?t.value:i.next()})},_(b),i(b,r,"Generator"),i(b,a,function(){return this}),i(b,"toString",function(){return"[object Generator]"}),o.keys=function(t){var e,n=Object(t),a=[];for(e in n)a.push(e);return a.reverse(),function t(){for(;a.length;){var e=a.pop();if(e in n)return t.value=e,t.done=!1,t}return t.done=!0,t}},o.values=x,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=c,this.done=!1,this.delegate=null,this.method="next",this.arg=c,this.tryEntries.forEach(I),!t)for(var e in this)"t"===e.charAt(0)&&l.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=c)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var a=this;function t(t,e){return i.type="throw",i.arg=n,a.next=t,e&&(a.method="next",a.arg=c),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var r=this.tryEntries[e],i=r.completion;if("root"===r.tryLoc)return t("end");if(r.tryLoc<=this.prev){var o=l.call(r,"catchLoc"),s=l.call(r,"finallyLoc");if(o&&s){if(this.prev<r.catchLoc)return t(r.catchLoc,!0);if(this.prev<r.finallyLoc)return t(r.finallyLoc)}else if(o){if(this.prev<r.catchLoc)return t(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return t(r.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;0<=n;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&l.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}var i=(r=r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc?null:r)?r.completion:{};return i.type=t,i.arg=e,r?(this.method="next",this.next=r.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),I(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n,a,r=this.tryEntries[e];if(r.tryLoc===t)return"throw"===(n=r.completion).type&&(a=n.arg,I(r)),a}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:x(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=c),v}},o}function _(){try{var t=!Boolean.prototype.valueOf.call(o()(Boolean,[],function(){}))}catch(t){}return(_=function(){return!!t})()}a=Object(r.b)("store")(r=Object(r.c)((n=function(t){function r(t){Object(h.a)(this,r),n=this,e=r,t=[t],e=Object(p.a)(e),e=Object(d.a)(n,_()?o()(e,t||[],Object(p.a)(n).constructor):e.apply(n,t)),i.call(Object(f.a)(e));var e,n=e.props.store.locale,t=(void 0===n?"":n).replace("_","-");try{var a=t.split("-");a[1]=a[1].toUpperCase(),t=a.join("-")}catch(t){}n=e.props,a=n.popularType,n=n.districtid||0;return e.state={searchHover:!1,recentlyView:[],theValue:"",popularType:isNaN(n)?"destinations":a,districtid:isNaN(n)?0:n,recentlyShow:!1,autoMatchItem:[],focusItem:{},focusIndex:-1,isShowRecently:!1,visible:!1,isLoading:!1,popularItem:[],timestamp:"",locale:t,theSearchRule:"",forbid:!1,keywordEn:"",keywordId:null},e.handleDebounce=e.handleDebounce.bind(Object(f.a)(e)),e.handleDebounce=Object(g.a)(200,e.handleDebounce),e}var e,n;return Object(y.a)(r,t),Object(u.a)(r,[{key:"handleClick",value:function(t,e){var n=this,a=2<arguments.length&&void 0!==arguments[2]&&arguments[2],r=3<arguments.length&&void 0!==arguments[3]&&arguments[3];t&&l()(t).length&&(r||this.handleHoverBackg(e,!0),a?this.setState({focusItem:t,focusIndex:e}):(a=t.name||t.title,r?this.setState({isShowRecently:!1,focusItem:t,focusIndex:e,theValue:a}):this.setState({focusItem:t,focusIndex:e,theValue:a},function(){n.handleSearch()})))}},{key:"handleFocus",value:function(){var t=this,e=(Object(w.z)({pagekey:"tgs_search_click_request",params:{districtid:null==(e=this.state)?void 0:e.districtid}}),this.state),n=e.theValue,a=e.recentlyShow,r=e.isLoading,i=e.recentlyView,e=e.locale;a||document.addEventListener("click",this.handleClickOutside,!1),r||(i&&i.length||(i=Object(w.l)(e)||[]),this.setState({recentlyShow:!0,recentlyView:i},function(){n||t.handleFocusItem(-1)}))}},{key:"handleBlur",value:function(t){var e=this,n=this.state,a=n.focusIndex,r=n.focusItem,n=n.isShowRecently;0<=a&&(!this.state.theValue||n?r={}:this.state.autoMatchItem[0]),setTimeout(function(){e.setState({recentlyShow:!1,isShowRecently:!0,focusIndex:-1,focusItem:r}),document.removeEventListener("click",e.handleClickOutside,!1)},300)}},{key:"handleChange",value:function(t){var e=this,n=Object(w.r)(t.target.value),t=this.state.focusItem;Object(w.z)({pagekey:"tgs_search_click_req",params:{inputkeyword:n}}),this.setState({isLoading:!0,theValue:n,focusItem:n?t:{},isShowRecently:!1},function(){e.handleDebounce(n)})}},{key:"handleDebounce",value:function(t){(t=t||"")&&!t.match(/^\s*$/)?this.methodAutoMatch(t):this.setState({isLoading:!1}),this.handleFocus()}},{key:"methodAutoMatch",value:(n=Object(c.a)(T().mark(function t(e){var n,a,r=this;return T().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=this.props.store,a=void 0===a?{}:a,t.next=3,Object(k.b)({serviceCode:20400,serviceName:"getGsMainSuggestForTripOnline",type:"post",store:a,params:{keyword:e,lang:null==a?void 0:a.language,locale:null==a?void 0:a.locale,currency:null==a?void 0:a.currency,viewDistrictId:this.state.districtid}});case 3:null!=(a=t.sent)&&(null!=(n=a.data)&&n.length)?this.setState({isLoading:!1,autoMatchItem:null==a?void 0:a.data,timestamp:null!=a&&a.responseStatus?null==a?void 0:a.responseStatus.timestamp:"",theSearchRule:null==a?void 0:a.queryRule},function(){r.handleFocusItem(-1)}):this.setState({isLoading:!1,autoMatchItem:[],focusItem:{},theSearchRule:null==a?void 0:a.queryRule});case 5:case"end":return t.stop()}},t,this)})),function(t){return n.apply(this,arguments)})},{key:"handleClickClear",value:function(){var t=this.state,e=t.locale,t=t.theValue;Object(w.z)({pagekey:"tgs_search_click_clear",params:{inputkeyword:t}}),this.setState({recentlyView:[],recentlyShow:!1}),Object(w.x)(e,[])}},{key:"handleRouter",value:function(e,t){var n=this.state.recentlyView||[],a=this.state;a.autoMatchItem,a.timestamp,a.locale,a.districtid;if(e&&null!=(null==e?void 0:e.id)&&1!=(2<arguments.length&&void 0!==arguments[2]?arguments[2]:0)){try{var r=!!n&&n.findIndex(function(t){return(null==t?void 0:t.word)==(null==e?void 0:e.word)&&(null==t?void 0:t.id)==(null==e?void 0:e.id)});0<=r&&n.splice(r,1),this.handleSetStorage(n,e)}catch(t){}window.location.href=Object(b.a)(null==e?void 0:e.url)}else{var i=t||(null==e?void 0:e.value);try{var o,s,c=!!n&&n.findIndex(function(t){return(null==t?void 0:t.value)&&(null==t?void 0:t.value)==i&&!(null!=t&&t.id)}),l=(0<=c&&n.splice(c,1),Object(w.t)(null==(o=this.props)||null==(s=o.store)?void 0:s.i18n["key.search_result_about_XXX"],i));this.handleSetStorage(n,{word:l,iconName:"search",value:i})}catch(t){}window.location.href=Object(b.a)("/global-gssearch/searchlist/search?keyword=".concat(i))}}},{key:"handleSearch",value:function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,a=this.state,r=a.focusItem,i=a.theValue,r=(a.autoMatchItem,e||r);(i&&!i.match(/^\s*$/)||r&&l()(r).length)&&(this.setState({recentlyShow:!1,visible:!0}),this.handleRouter(r,i,n))}},{key:"handleHoverBackg",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(this.refs.searchListRefs){var n=this.refs.searchListRefs.getElementsByClassName("gl-cpt-search_list-content-li"),a=n.length;if(!e)try{var r=this.refs.searchListRefs.clientHeight||600,i=this.refs.searchListRefs.firstChild?this.refs.searchListRefs.firstChild.clientHeight:656;r<i&&(this.refs.searchListRefs.scrollTop=i<41*t?i:41*t)}catch(t){}for(var o=0;o<a;o++)n[o].className=o==t?"gl-cpt-search_list-content-li gl-cpt-search_list-content-li-focus":"gl-cpt-search_list-content-li"}}},{key:"handleFocusItem",value:function(t){var e,n=this,a={};a=!this.state.theValue||this.state.isShowRecently?(e=this.state.recentlyView.length||0,t<e?this.state.recentlyView[t]:this.state.popularItem[t-e]):this.state.autoMatchItem[t],this.setState({focusIndex:t,focusItem:a},function(){n.handleHoverBackg(t)})}},{key:"handleKeyDown",value:function(t){t=t||event;var e=this.state,n=e.focusIndex;e.focusItem,e.autoMatchItem,e.theValue;if(this.refs.searchListRefs&&this.refs.searchListRefs.getElementsByClassName("gl-cpt-search_list-content-li")&&this.refs.searchListRefs.getElementsByClassName("gl-cpt-search_list-content-li").length||13==t.keyCode){var a=0;switch(13!=t.keyCode&&(a=this.refs.searchListRefs.getElementsByClassName("gl-cpt-search_list-content-li").length),t.keyCode){case 13:this.handleSearch();break;case 38:n=n<=0?a-1:n-1;break;case 40:n=n+1===a?0:n+1}38!=t.keyCode&&40!=t.keyCode||this.handleFocusItem(n)}}},{key:"initHttp",value:(e=Object(c.a)(T().mark(function t(){var e,n,a;return T().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=null==(n=this.props)?void 0:n.store,a=n.language,e=n.locale,n=n.currency,t.next=3,Object(k.b)({serviceCode:20400,serviceName:"getGsHotSearchForTripOnline",type:"post",store:this.props.store,params:{lang:a,locale:e,currency:n,viewDistrictId:this.state.districtid,dataType:this.state.popularType||"destinations"}});case 3:a=t.sent,this.setState({popularItem:(null==a?void 0:a.data)||[]});case 5:case"end":return t.stop()}},t,this)})),function(){return e.apply(this,arguments)})},{key:"handleCrossStorage",value:function(){var t=this.state.locale,t=Object(w.l)(t);this.setState({recentlyView:t})}},{key:"componentDidMount",value:function(){localStorage.setItem("ibu_gccpoi_online_recentsearch",s()("")),this.initHttp(),this.handleCrossStorage()}},{key:"render",value:function(){var r=this,t=this.state,e=(t.visible,t.isLoading),n=(t.recentlyView,t.popularType),i=t.theValue,t=this.props,a=t.type,o=t.style,o=void 0===o?{}:o,t=t.store.i18n,t=void 0===t?{}:t,s=t["key.popular_attractions_search"]||"Popular Attractions",n=("destinations"===n?s=t["key.popular_destinations_search"]||"Popular Destinations":"restaurants"===n&&(s=t["key.popular_restaurants"]||"Popular Restaurants"),v.a.createElement("div",null,this.state.recentlyView.length?v.a.createElement("div",{className:"gl-cpt-search_list-title"},v.a.createElement("span",null,t["key.recent_searches"]||"recently searches"),v.a.createElement("span",{className:"gl-cpt-search_list-title-clear",onClick:this.handleClickClear.bind(this)},t["key.clear"]||"clear")):null,v.a.createElement(m.a,{i18n:t,handleClick:function(t,e,n){r.handleClick(t,e,n)},handleSearch:function(t,e){Object(w.z)({pagekey:"tgs_search_click_history",params:{keyword:(null==e?void 0:e.value)||(null==e?void 0:e.word)}}),r.handleSearch(t,e)},items:this.state.recentlyView}),this.state.popularItem&&0<this.state.popularItem.length&&v.a.createElement("div",{className:"gl-cpt-search_list-title"},v.a.createElement("span",null,s)),v.a.createElement(m.a,{i18n:t,isPopular:this.state.recentlyView.length,handleClick:function(t,e,n){r.handleClick(t,e,n)},handleSearch:function(t,e){Object(w.z)({pagekey:"tgs_search_click_destination",params:{id:null==e?void 0:e.id,word:null==e?void 0:e.word,type:null==e?void 0:e.type,districtName:null==e?void 0:e.districtName}}),r.handleSearch(t,e)},items:this.state.popularItem}))),s=v.a.createElement("div",{className:"gl-cpt-search_list",ref:"searchListRefs"},!this.state.theValue||this.state.isShowRecently?n:v.a.createElement(m.a,{i18n:t,handleClick:function(t,e,n){return r.handleClick(t,e,n)},handleSearch:function(t,e,n,a){Object(w.z)({pagekey:"tgs_search_click_ac",params:{inputkeyword:i,content:null==e?void 0:e.word,type:null==e?void 0:e.type,id:null==e?void 0:e.id,index:a}}),r.handleSearch(t,e,n)},items:this.state.autoMatchItem,theValue:this.state.theValue,isMatchItem:!0})),n=v.a.createElement(v.a.Fragment,null,v.a.createElement("div",{className:"gl-cpt-search_input"},v.a.createElement("input",{style:{textOverflow:"ellipsis"},onFocus:this.handleFocus.bind(this,1),onChange:this.handleChange.bind(this),onBlur:this.handleBlur.bind(this),onKeyDown:this.handleKeyDown.bind(this),value:this.state.theValue,placeholder:t["key.search_destinations_and_attractions_hotel"]||"City, attraction, hotel and more"}),!e&&this.state.recentlyShow?s:null),v.a.createElement("div",{onClick:this.handleSearch.bind(this,{},{},1),className:"gl-cpt-search_button"},v.a.createElement("div",{className:"gl-cpt-search_button-icon",onClick:function(){return r.MouseEnter()}})));return["https://fr.uat.tripqate.com","https://fr.trip.com","https://ru.uat.tripqate.com","https://ru.trip.com"].includes(this.props.store.host)?v.a.createElement("div",{className:"gl-cpt-search-big-contain",style:{opacity:0}}):"small"==a?v.a.createElement("div",{style:o||{},className:"gl-cpt-search gl-cpt-search-small ".concat(this.state.searchHover?"gl-cpt-search-small-active":""),ref:function(t){r.node=t}},n):v.a.createElement("div",{className:"gl-cpt-search-big-contain"},v.a.createElement("div",{style:o||{},className:"gl-cpt-search gl-cpt-search-big ".concat((this.state.searchHover,"")),ref:function(t){r.node=t}},n))}}]),r}(a.Component),i=function(){var n=this;this.handleClickOutside=function(t){n.node&&n.node.contains(t.target)||n.handleBlur(t)},this.handleSetStorage=function(t,e){t.unshift(e),t.length=5<=t.length?5:t.length;e=n.state.locale;Object(w.x)(e,t),n.setState({recentlyView:t})},this.MouseEnter=function(){n.setState({searchHover:!n.state.searchHover,recentlyShow:!1})}},r=n))||r)||r;a.defaultProps={popularType:"destinations",districtid:0},e.a=a}}]);rchCard; var DisplayDivSearchCard = function (key) { if (ifirst) { sso_card_allData = ""; sso_card_allData = Alliances.split("@").slice(); searchCardHtml = "<div id='address_suggestionContainer_ms__id49'>"; searchCardHtml += "<div class='city_suggestion_pop'>"; searchCardHtml += "<p class='title'><a class='close' href='javascript:;' id='sso_searchcardDivClose' >×</a><span id='needToResplace'>,</span>若需缩小范围，请输入更多条件。</p>"; searchCardHtml += "<div class='sug_item' id='searchNameList'>"; searchCardHtml += "</div>	"; searchCardHtml += "</div>"; searchCardHtml += "</div>"; divSearchCard = sso_c("div"); divSearchCard.className = "cooperation-searchcard"; divSearchCard.style.display = consts.display.none; divSearchCard.style.position = "absolute"; divSearchCard.id = "searchCardName"; divSearchCard.innerHTML = searchCardHtml; __.body.appendChild(divSearchCard); ifirst = false; var sso_divs = document.getElementsByTagName("div"); for (var i = 0, sso_max_zindex = 0; i < sso_divs.length; i++) { if (!isNaN(sso_divs[i].style.zIndex)) { sso_max_zindex = Math.max(sso_max_zindex, sso_divs[i].style.zIndex || 0) } } sso_max_zindex = Math.min(sso_max_zindex, 2000000000); divSearchCard.style.zIndex = Math.max(parseInt(sso_max_zindex) + 1, 1005); var txtloca = sso_gPos(sso_cardName); var txtClientH = sso_cardName.offsetHeight; divSearchCard.style.left = txtloca[0] + "px"; divSearchCard.style.top = txtloca[1] + txtClientH + "px"; document.getElementById("sso_searchcardDivClose").onclick = function () { if (sso_searchcardFirseSelect) { sso_cardName.value = sso_searchcardFirseSelect.split("||")[0]; if (sourceID) { sso_singalDor(sourceID).value = sso_searchcardFirseSelect.split("||")[1].split("|")[0] } } divSearchCard.style.display = consts.display.none }; divSearchCard.onmousedown = function () { _.mdFlag = true; return false } } $ss.hidden(); divSearchCard.style.display = consts.display.block; document.getElementById("needToResplace").innerHTML = (key.length > 9 ? key.substring(0, 8) + ".." : key) + ","; var addresses = new Array(); sso_searchcardFirseSelect = ""; for (var i = 0; i < sso_card_allData.length; i++) { if (sso_card_allData[i].indexOf("||") !== -1) { if (sso_card_allData[i].split("||")[0].indexOf(key) >= 0 || sso_card_allData[i].split("||")[1].indexOf(key) >= 0) { addresses.push(sso_card_allData[i]) } } } var nameList = sso_singalDor("searchNameList"); clearChildren(nameList); if (addresses[0]) { sso_searchcardFirseSelect = addresses[0] } for (var i = 0; i < (addresses.length >= 6 ? 6 : addresses.length) ; i++) { var a = sso_c("a"); a.href = "javascript:;"; var span = sso_c("span"); span.innerHTML = addresses[i].split("||")[0].replace(eval("/" + key + "/"), "<b>" + key + "</b>"); span.setAttribute("dataValue", addresses[i].split("||")[0] + "||" + addresses[i].split("||")[1].split("|")[0]); span.onclick = function () { sso_cardName.value = sso_singalDor(this).attributes.dataValue.value.split("||")[0]; if (sourceID) { sso_singalDor(sourceID).value = sso_singalDor(this).attributes.dataValue.value.split("||")[1]; divSearchCard.style.display = consts.display.none } }; a.appendChild(span); nameList.appendChild(a) } }; var bindKeyBoardEvent = function (obj) { if (sso_isExists(binedobj, obj)) { return } sso_singalDor(obj).onkeydown = function (e) { var nameList = getChildNodes(sso_singalDor("nameList")); e = e || window.event; if (divfra.style.display === consts.display.block || (divSearchCard && divSearchCard.style.display === consts.display.block)) { if (e.keyCode === 38 || e.keyCode === 40) { if (currentSelected === -1) { if (e.keyCode === 38) { getChildNodes(nameList[nameList.length - 1])[0].className = "cardNameHover"; currentSelected = nameList.length - 1 } else { getChildNodes(nameList[0])[0].className = "cardNameHover"; currentSelected = 0 } } else { if (e.keyCode === 38) { getChildNodes(nameList[currentSelected])[0].className = ""; if (currentSelected - 1 < 0) { currentSelected = nameList.length } getChildNodes(nameList[currentSelected - 1])[0].className = "cardNameHover"; currentSelected -= 1 } else { getChildNodes(nameList[currentSelected])[0].className = ""; if (currentSelected + 1 === nameList.length) { currentSelected = -1 } getChildNodes(nameList[currentSelected + 1])[0].className = "cardNameHover"; currentSelected += 1 } } } if (e.keyCode === 13) { if (nameList[currentSelected]) { tagobj.value = getChildNodes(nameList[currentSelected])[0].attributes.dataValue.value.split("||")[0]; if (sourceID) { sso_singalDor(sourceID).value = sso_singalDor(obj).attributes.dataValue.value.split("||")[1] } tagobj.blur() } } if (e.keyCode === 37) { if (currentPage !== 1) { searchCard(currentPage - 1) } } if (e.keyCode === 39) { if (currentPage !== pagination.pageCount) { searchCard(currentPage + 1) } } } if (sso_browser.IE) { sso_singalDor(obj).onpropertychange = function () { currentCardName = obj.value; if (preCardName != currentCardName && currentCardName != "中文/拼音") { if (obj.value != "") { $ss.hidden(); if (sso_browser.IE9 && currentCardName.length < preCardName.length && currentCardName.length >= 1) { DisplayDivSearchCard(currentCardName.substring(0, currentCardName.length - 1)) } else { DisplayDivSearchCard(obj.value) } } else { $ss.show(this); if (divSearchCard) { divSearchCard.style.display = consts.display.none } } } preCardName = currentCardName } } else { sso_singalDor(obj).oninput = function () { if (obj.value != "") { $ss.hidden(); DisplayDivSearchCard(obj.value) } else { $ss.show(this); if (divSearchCard) { divSearchCard.style.display = consts.display.none } } } } binedobj.push(obj) } }; _.$ss.bind = function (obj, sid) { bindKeyBoardEvent(obj); _.sourceID = sid; sso_singalDor(obj).onclick = function () { if (!globalAfterClickedCardName) { if (obj.value == "" || obj.value == "中文/拼音") { obj.value = ""; $ss.show(this); if (divSearchCard) { divSearchCard.style.display = consts.display.none } } else { $ss.hidden(); preCardName = obj.value; DisplayDivSearchCard(obj.value) } } else { globalAfterClickedCardName = false } }; sso_singalDor(obj).onblur = function () { if (obj.value == "" || obj.value == "中文/拼音") { obj.value = "中文/拼音"; obj.style.color = "gray" } else { obj.style.color = "black"; if (divSearchCard && divSearchCard.style.display == consts.display.block && sso_searchcardFirseSelect) { sso_cardName.value = sso_searchcardFirseSelect.split("||")[0]; if (sourceID) { sso_singalDor(sourceID).value = sso_searchcardFirseSelect.split("||")[1].split("|")[0] } } } $ss.hidden(); if (divSearchCard && divSearchCard.style.display == consts.display.block) { divSearchCard.style.display = consts.display.none } }; sso_singalDor(obj).onbeforedeactivate = function () { if (_.mdFlag) { _.mdFlag = false; return false } } } })(); function sso_gPos(obj) { if (obj.sso_getPos) { return obj.sso_getPos() } else { var p = $getPosition(); return [p.x, p.y] } } function logn(sourceid) { var charset = (((win.doc.charset ? win.doc.charset : win.doc.characterSet) || "").match(/^(gb2312|big5|utf-8)$/gi) || "gb2312").toString().toLowerCase(); if (sourceid.substring(0, 1) == "A" || sourceid.substring(0, 1) == "F") { window.location.href = "showfail.aspx?c=redlogin"; return false } else { if (sourceid == 75) { window.open("cardregist.aspx?src=75"); return true } else { if (sourceid == 6000) { if (charset.toLowerCase() == "big5") { window.open("http://big5.ctrip.com/Member/cbcard/SignUpcc.asp?sourceid=6000") } else { window.open("https://m.ctrip.com/webapp/cardh5/6000") } return true } else { if (sourceid == 6001) { if (charset.toLowerCase() == "big5") { window.open("http://big5.ctrip.com/Member/cbcard/SignUpZH.asp?sourceid=6001") } else { window.open("https://m.ctrip.com/webapp/cardh5/6001") } return true } else { if (sourceid == 6002) { if (charset.toLowerCase() == "big5") { window.open("http://big5.ctrip.com/Member/cbcard/SignUpNH_CardNum.asp?sourceid=6002") } else { window.open("https://m.ctrip.com/webapp/cardh5/6002") } return true } else { if (sourceid == 6003) { if (charset.toLowerCase() == "big5") { window.open("http://big5.ctrip.com/Member/cbcard/SignUpPN.asp?sourceid=6003") } else { window.open("https://m.ctrip.com/webapp/cardh5/6003") } return true } else { if (sourceid == 6004) { if (charset.toLowerCase() == "big5") { window.open("http://big5.ctrip.com/Member/cbcard/SignUpNH_CardNum.asp?sourceid=6004") } else { window.open("https://m.ctrip.com/webapp/cardh5/6004") } return true } else { if (sourceid == 6005) { if (charset.toLowerCase() == "big5") { window.open("http://big5.ctrip.com/Member/cbcard/SignUpNewCC.asp?sourceid=6005") } else { window.open("https://m.ctrip.com/webapp/cardh5/6005") } return true } else { if (sourceid == 6006) { if (charset.toLowerCase() == "big5") { window.open("http://big5.ctrip.com/Member/cbcard/SignUpNewCC.asp?sourceid=6006") } else { window.open("https://m.ctrip.com/webapp/cardh5/6006") } return true } else { if (sourceid == 6007) { if (charset.toLowerCase() == "big5") { window.open("http://big5.ctrip.com/Member/cbcard/SignUpNewCC.asp?sourceid=6007") } else { window.open("https://m.ctrip.com/webapp/cardh5/6007") } return true } else { if (sourceid == 6008) { if (charset.toLowerCase() == "big5") { window.open("http://big5.ctrip.com/Member/cbcard/SignUpNewCC.asp?sourceid=6008") } else { window.open("https://m.ctrip.com/webapp/cardh5/6008") } return true } else { if (sourceid == 6009) { if (charset.toLowerCase() == "big5") { window.open("http://big5.ctrip.com/Member/cbcard/SignUpNewCC.asp?sourceid=6009") } else { window.open("https://m.ctrip.com/webapp/cardh5/6009") } return true } else { if (sourceid == 88880001) { window.open("https://www.wanlitong.com/eloyalty_chs/start.swe?SWECmd=InvokeMethod&SWEMethod=GotoView&SWEService=GotoView&gURL=http://corporatetravel.ctrip.com/crpTravel/pinan_loginCheck.asp?"); return true } else { if (sourceid == "B01") { window.open("cardregist.aspx?src=754"); return true } else { if (sourceid.length > 0) { window.open("https://accounts.ctrip.com/member/cardregist.aspx?src=" + sourceid) } return true } } } } } } } } } } } } } } } var f_ClearCountDown = false; function countDown(num, _fn, tag, str) { var oTag; if (f_ClearCountDown) { return } if (num == 0) { if (tag != void 0) { if (tag.value) { oTag = tag.value = num + (str != void 0 ? str : "") } else { oTag = tag.innerHTML = num + (str != void 0 ? str : "") } } _fn(); return } if (tag != void 0) { if (tag.value) { oTag = tag.value = num + (str != void 0 ? str : "") } else { oTag = tag.innerHTML = num + (str != void 0 ? str : "") } } var _self = function () { countDown(--num, _fn, tag, str) }; window.setTimeout(_self, 1000) } sso_doubleDoalor.string = { "zh-cn": { display: "@\u25b2|\u25bc@\u663e\u793a|\u9690\u85cf@" }, "zh-tw": { display: "@\u25b2|\u25bc@\u986f\u793a|\u96b1\u85cf@" }, en: { display: "@Show|Hidden@" } }[sso_status.version]; sso_doubleDoalor.string.address = { "zh-cn": { b: "\u8f93\u5165\u4e2d\u6587/\u62fc\u97f3\u6216\u2191\u2193\u9009\u62e9.", i: "\u8f93\u5165", j: "\u6216\u2191\u2193\u9009\u62e9.", k: "\u4e2d\u6587/\u62fc\u97f3", e: "\u8bf7\u8f93\u5165\u81f3\u5c11\u4e24\u4e2a\u5b57\u6bcd\u6216\u4e00\u4e2a\u6c49\u5b57.", h: "", o: "\u6309\u62fc\u97f3\u6392\u5e8f", s: "\u5bf9\u4e0d\u8d77, \u627e\u4e0d\u5230: ", l: "\u7ed3\u679c\u5171", p: "\u9879,\u2190\u2192\u7ffb\u9875", a: ",\u5171" }, "zh-tw": { b: "\u8f38\u5165\u4e2d\u6587/\u62fc\u97f3\u6216\u2191\u2193\u9078\u64c7.", i: "\u8f38\u5165", j: "\u6216\u2191\u2193\u9078\u64c7.", k: "\u4e2d\u6587/\u62fc\u97f3", e: "\u8acb\u8f38\u5165\u81f3\u5c11\u5169\u500b\u5b57\u6bcd\u6216\u4e00\u500b\u6f22\u5b57.", h: "", o: "\u6309\u62fc\u97f3\u6392\u5e8f", s: "\u5c0d\u4e0d\u8d77, \u627e\u4e0d\u5230: ", l: "\u7d50\u679c\u5171", p: "\u9805,\u2190\u2192\u7ffb\u9801", a: ",\u5171" }, en: { b: "Type or scroll to select.", i: "Input ", j: " or use up or down to select.", k: "English", e: "Please Input at least two character.", h: "", o: "sort by spelling", s: "No match", l: "Results ", p: ",left or right to turn page", a: ",All" } }[sso_status.version]; sso_doubleDoalor.module.address.sourceMap = { hotel: ["http://scriptres.ctrip.com/hoteladdress/HotelCityAddress{$charset}.aspx", "utf-8"], hotelAll: ["http://scriptres.ctrip.com/hoteladdress/HotelCityAddress{$charset}.aspx", "utf-8"] };