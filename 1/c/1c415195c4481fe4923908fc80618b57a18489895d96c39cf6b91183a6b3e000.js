(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[636,167],{"3b/l":function(e,t,n){"use strict";function o(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours()+t,e.getMinutes(),e.getSeconds(),e.getMilliseconds())}n.d(t,"a",(function(){return o}))},"7qt8":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var o=n("QjXU"),a=n("MJsD"),r=n("B5kz"),i=n("W7wX"),c=n("CDFH");function s(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(a.a)()];case 1:return e=n.sent(),[4,Object(i.a)()];case 2:return t=n.sent(),[2,r.a.fetchQuery(["WorkloadPublicDataConfig"],(function(){return Object(c.a)(e,t)}),{staleTime:1/0,cacheTime:1/0})]}}))}))}},"9pXf":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var o=n("QjXU"),a=n("3b/l"),r=n("Wa5Y"),i=n("zPk6"),c=n("V1Qu"),s=new Map;function u(e,t,n,u,l,d,f,p,m,v){var b=s.get(f);if(b&&(!b.expiryTime||b.expiryTime>new Date))return b.promise;s.delete(f);var g=function(a){return function(e,t,n,a,c,s,u,l,d,f,p,m,v){return Object(o.__awaiter)(this,void 0,void 0,(function(){var b;return Object(o.__generator)(this,(function(o){return b={headers:{accept:"application/json"}},[2,Object(r.a)(d,f,e,b,t,n,a,c,u,{resourceUrl:l,mockParam:"mockvroom",populateRequestEvent:function(e,t){t.RequestId=Object(i.a)(e)||e)||""},silent:p,capDialogData:m,isRetriableError:v},s).then((function(e){return e&&e.data?e.data:Promise.reject({httpResponse:e,clientError:"Invalid response"})}))]}))}))}(t,!!e.jwtAuthEnabled,e.getAccessToken,e.officeHomeApiRoot,e.correlationId,a,n,u,l,d,p,m,v)},j=(null==b?void 0:b.promise)||g("cache-only"),h=g("network-first"),O=Object(c.a)(j,h,!!b).catch(();return s.set(f,{promise:O,expiryTime:Object(a.a)(new Date,24)}),O}},"DM/p":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var o=n("QjXU"),a=n("MJsD"),r=n("QLkI"),i=n("W7wX");function c(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(o.__generator)(this,(function(c){switch(c.label){case 0:return[4,Object(a.a)()];case 1:return e=c.sent(),[4,Promise.all([Object(r.a)(),Object(i.a)()])];case 2:return t=o.__read.apply(void 0,[c.sent(),2]),[2,{correlationId:e.correlationId,getAccessToken:e.getAccessToken,inMockMode:e.inMockMode,isConsumer:t[1].isMsa,jwtAuthEnabled:e.jwtAuthEnabled,officeHomeApiRoot:e.officeHomeApiRoot,oneDriveResourceId:null==(n=t[0])?void 0:n.oneDriveResourceId,sharePointResourceId:null==n?void 0:n.sharePointResourceId}]}}))}))}},PoVA:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n("a3FV"),a=n("V1Qu"),r=n("9pXf");function i(e){if(!e.oneDriveResourceId)return Promise.reject("Missing oneDrive resource");var t=Object(a.e)(e.oneDriveResourceId,e,!1,!0),n="".concat(t,"/drive?select=wacBootstrapInfo");return Object(r.a)(e,n,"OneDrive",e.oneDriveResourceId,o.a.WacBootstrapInfoRequest,"Wac_Bootstrap_Info","wacBootstrapInfo",!1,{category:"TemplatesPage",fileType:"Visio"},().then((function(e){return e.wacBootstrapInfo?e.wacBootstrapInfo.wacComplianceRegion:Promise.reject({clientError:"Invalid response for wacBootStrapInfo"})}))}},WJ2C:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var o=n("QjXU"),a=n("MJsD"),r=n("B5kz"),i=n("W7wX"),c=n("/5so");function s(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(a.a)()];case 1:return e=n.sent(),[4,Object(i.a)()];case 2:return t=n.sent(),[2,r.a.fetchQuery(["ConsumerInstallInfoConfig"],(,{staleTime:1/0,cacheTime:1/0})]}}))}))}},h66i:function(e,t,n){"use strict";n.r(t),n.d(t,"getCustomTemplatesDataProvider",(function(){return E})),n.d(t,"getDataManager",(function(){return E}));var o=n("QjXU"),a=n("6ib3"),r=n("QLkI"),i=n("j7b/"),c=n("mJgL"),s=n("P1B7"),u=n("lwUs"),l=n("m32Q"),d=n("lkvL"),f=n("DCX/"),p=n("8wW2"),m=n("5ANk"),v=n("a3FV"),b=n("qyk8"),g=n("CMIS"),j=n("DM/p"),h=n("PoVA"),O=n("Wa5Y"),w="v/templatesDataHandler.ashx",I=n("k+5q"),_="visio-templates-api";function T(e){return[Object(u.a)(e)]}function C(e){var t,n,u,C,k,A,E,P,D=e.app,y=e.identity,M=e.officeComponentContext,V=e.templatesConfig,R=e.handleRevalidation;return Object(o.__awaiter)(this,void 0,void 0,(function(){var e,N,S,q,W,H=this;return Object(o.__generator)(this,(function(x){switch(x.label){case 0:return[4,Object(r.a)()];case 1:return e=x.sent(),N=1*i.a,S=1,[4,Object(c.a)()];case 2:return q=x.sent(),(null===(n=null===(t=null==q?void 0:q.result)||void 0===t?void 0:t.visioTemplatesConfig)||void 0===n?void 0:n.cacheKeyVersion)&&(S=parseInt(null===(C=null===(u=null==q?void 0:q.result)||void 0===u?void 0:u.visioTemplatesConfig)||void 0===C?void 0:C.cacheKeyVersion)),(null===(A=null===(k=null==q?void 0:q.result)||void 0===k?void 0:k.visioTemplatesConfig)||void 0===A?void 0:A.cacheTime)&&(N=parseInt(null===(P=null===(E=null==q?void 0:q.result)||void 0===E?void 0:E.visioTemplatesConfig)||void 0===P?void 0:P.cacheTime)),W={correlationId:M.correlationId,getAccessToken:M.getAccessToken,getIdentity:inMockMode:M.inMockMode,jwtAuthEnabled:M.jwtAuthEnabled,workload:M.workload,officeHomeApiRoot:M.officeHomeApiRoot,templatesApiEndpoint:V.templatesApiEndpoint,officeMarket:M.preferredCulture,app:D,sharedContext:e},[2,Object(s.a)((function(){return function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i,c,s,u;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return[4,Object(f.a)()];case 1:return t=o.sent(),e.inMockMode?(n=e.officeHomeApiRoot+"/api/templatePage/templates",[3,5]):[3,2];case 2:return[4,Object(j.a)()];case 3:return r=o.sent(),[4,Object(h.a)(r)];case 4:i=o.sent(),n=function(e,t,n){var o;if(void 0===t&&(t=""),void 0===n&&(n=""),e.app===a.a.Visio){var r="lcid="+(null===(o=e.sharedContext)||void 0===o?void 0:o.officeMarketLcid)+"&cID="+e.correlationId+"&scenarioid="+n+"&culture="+e.officeMarket;return t&&t.trim()?"".concat(Object(b.a)("https://{0}-visio.officeapps.live.com",t),"/").concat(w,"?").concat(r):"".concat("https://visio.officeapps.live.com","/").concat(w,"?").concat(r)}return""}(e,i,null==t?void 0:t.scenarioId),o.label=5;case 5:return c=function(e){var t;return{headers:((t={})["client-request-id"]=e,t)}},s=Object(m.a)(),u=c(s),[2,Object(O.a)(v.a.VisioTemplatesRequest,"Visio_Templates",n,u,e.jwtAuthEnabled,e.getAccessToken,e.officeHomeApiRoot,e.correlationId,"VisioService",{silent:!1,capDialogData:{category:"TemplatesPage",fileType:"Visio"}}).then((function(e){return e.data&&e.data.Templates?Promise.resolve(e.data.Templates):Promise.reject({clientError:"Invalid response"})})).catch((function(e){return Object(p.a)().handleError(e,void 0),Object(g.a)({eventName:v.a.VisioTemplatesRequest,debugInfo:e.toString(),area:"TemplatesPage"}),Promise.reject({clientError:"Invalid response"})}))]}}))}))}(W)}),(function(){var e=T(N),t=Object(o.__spreadArray)([],Object(o.__read)(e),!1).reverse();return Object(l.a)({userId:y.puid,collectionName:_,collectionVersion:S,key:Object(I.a)(D,W.officeMarket),plugins:t})}),(function(e){return Object(o.__awaiter)(H,void 0,void 0,(function(){var t;return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return t=T(N),[4,Object(d.a)({userId:y.puid,collectionName:_,collectionVersion:S,key:Object(I.a)(D,W.officeMarket),data:e,plugins:t})];case 1:return n.sent(),[2]}}))}))}),R)]}}))}))}var k=n("vS1s"),A=function(e,t){var n=null==e?void 0:e.result;if(!(null==n?void 0:n.TagList))return e;var o=n.TagList;return n.TagList.forEach((function(e,n){var a=o.at(n);a&&(a.DisplayName=t.templatePageResources[e.Id.toLowerCase()+"TemplatesTagNameVisio"])})),n.TagList=o,e};function E(e){return e.app===a.a.Visio?function(e){var t=this,n=e.identity,a=e.officeComponentContext,r=e.templatesConfig;return{getCustomTemplatesData:void 0,getEnterpriseTemplateLibraries:void 0,getTemplatesData:function(e,t){return Promise.resolve({result:{fromCache:!0,Template:[]},fromPersistence:!0})},getTemplatesPageData:function(i,c){return Object(o.__awaiter)(t,void 0,void 0,(function(){var t;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return[4,C({app:i,identity:n,officeComponentContext:a,templatesConfig:r,handleRevalidation:)];case 1:return t=o.sent(),[2,A(t,e.locStrings)]}}))}))}}}(e):Object(k.getDataManager)(e)}},"k+5q":function(e,t,n){"use strict";.d(t,"a",(function(){return o}))},tDEE:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n("j7b/"),a=n("lwUs");function r(){return[Object(a.a)(7*o.a)]}},vS1s:function(e,t,n){"use strict";n.r(t),n.d(t,"getDataManager",(function(){return C}));var o=n("QjXU"),a=n("Zmq1"),r=n("lbnC"),i=n("6ib3"),c=n("P1B7"),s=n("m32Q"),u=n("lkvL"),l=n("WJ2C"),d=n("7qt8"),f=n("vz6o");function p(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(l.a)()];case 1:return e=n.sent(),[4,Object(d.a)()];case 2:return t=n.sent(),[2,Object(f.a)({consumerInstallConfig:e,workloadPublicDataConfig:t})]}}))}))}var m=n("s1V1"),v=n("wYzw"),b=n("8wW2"),g=n("a3FV"),j=n("0TX8"),h=n("Wa5Y"),O=n("wiq1"),w=n("k+5q"),I=n("tDEE"),_="templates-api-react";function T(e){var t,n=e.app,l=e.identity,d=e.officeComponentContext,f=e.TemplatesConfig,T=e.handleRevalidation;return Object(o.__awaiter)(this,void 0,void 0,(function(){var e,C,k,A,E,P,D=this;return Object(o.__generator)(this,(function(y){switch(y.label){case 0:return[4,Object(m.a)()];case 1:return e=y.sent().result,[4,p()];case 2:return C=y.sent(),k=Object(a.a)(),A=n===i.a.Visio?f.numVisioTemplates:f.numTemplates,E=function(e,t,n){var o,a,r;if(t)switch(e){case i.a.Excel:return null===(o=n.startPagesConsumerTemplatesCollectionIds)||void 0===o?void 0:o.excel;case i.a.PowerPoint:return null===(a=n.startPagesConsumerTemplatesCollectionIds)||void 0===a?void 0:a.powerpoint;case i.a.Word:return null===(r=n.startPagesConsumerTemplatesCollectionIds)||void 0===r?void 0:r.word;default:return}}(n,l.isMsa,f),P={correlationId:d.correlationId,getAccessToken:d.getAccessToken,getIdentity:function(){return Promise.resolve(l)},inMockMode:d.inMockMode,jwtAuthEnabled:d.jwtAuthEnabled,workload:d.workload,officeHomeApiRoot:d.officeHomeApiRoot,app:n,templatesApiEndpoint:f.templatesApiEndpoint,officeMarket:d.preferredCulture,show:A-1,browserName:k.browser.browserType,flights:(null===(t=d.flights)||void 0===t?void 0:t.replace(/,\s*$/,""))||"",isPremium:l.isMsa&&C,isIw:(null==e?void 0:e.IsIw)||!1,isAdmin:(null==e?void 0:e.IsAdmin)||!1,isSmb:(null==e?void 0:e.IsSmb)||!1,isEdu:(null==e?void 0:e.IsEdu)||!1,isEduFaculty:(null==e?void 0:e.IsEduFaculty)||!1,isEduStudent:(null==e?void 0:e.IsEduStudent)||!1,authId:l.isMsa?1:2,firstVisitAgeInWeeks:Math.floor(Object(v.a)()/7),page:"StartPage",deploymentEnvironment:d.deploymentEnvironment||"",osName:k.platform.platformType,osVersion:Object(r.a)(k.platformVersion),templateCollectionId:E},[2,Object(c.a)((function(){return function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return t=function(e){var t="&".concat("browserName=").concat(e.browserName,"&").concat("flights=").concat(e.flights,"&").concat("isIw=").concat(e.isIw,"&").concat("isAdmin=").concat(e.isAdmin,"&").concat("isSmb=").concat(e.isSmb,"&").concat("isEduFaculty=").concat(e.isEduFaculty,"&").concat("isEduStudent=").concat(e.isEduStudent,"&").concat("authId=").concat(e.authId,"&").concat("firstVisitAgeInWeeks=").concat(e.firstVisitAgeInWeeks,"&").concat("page=").concat(e.page,"&").concat("deploymentEnvironment=").concat(e.deploymentEnvironment,"&").concat("osName=").concat(e.osName,"&").concat("osVersion=").concat(e.osVersion),n="".concat(e.officeHomeApiRoot,"/").concat(e.templatesApiEndpoint,"?").concat("culture=").concat(e.officeMarket,"&").concat("app=").concat(e.app,"&").concat("isEdu=").concat(e.isEdu,"&").concat("show=").concat(e.show).concat(e.isPremium?"&isPremium=1":"").concat(t);return void 0!==e.templateCollectionId&&""!==e.templateCollectionId&&(n+="&collectionId=".concat(e.templateCollectionId)),n}(e),[4,Object(j.a)({},e.inMockMode,e.workload,e.getIdentity)];case 1:return n=o.sent(),[2,Object(h.a)(g.a.TemplatesRequest,"Templates",t,n,e.jwtAuthEnabled,e.getAccessToken,e.officeHomeApiRoot,e.correlationId,"OfficeHome",{}).then((function(t){if(!t.data||!t.data.Templates||!t.data.Templates.Value||0===t.data.Templates.Value.length)return Promise.reject({clientError:"Invalid response"});var n={Template:Object(O.a)(t.data.Templates.Value,e.app),fromCache:!1};return n&&n.Template&&0!==n.Template.length?Promise.resolve(n):Promise.reject({clientError:"Null templates response"})})).catch((function(e){return Object(b.a)().handleError(e,"D5zZb"),Promise.reject({clientError:"Invalid response"})}))]}}))}))}(P)}),(function(){var e=Object(I.a)(),t=Object(o.__spreadArray)([],Object(o.__read)(e),!1).reverse();return Object(s.a)({userId:l.puid,collectionName:_,collectionVersion:1,key:Object(w.a)(n,P.officeMarket),plugins:t})}),(function(e){return Object(o.__awaiter)(D,void 0,void 0,(function(){var t;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return t=Object(I.a)(),[4,Object(u.a)({userId:l.puid,collectionName:_,collectionVersion:1,key:Object(w.a)(n,P.officeMarket),data:e,plugins:t})];case 1:return o.sent(),[2]}}))}))}),T)]}}))}))}function C(e){var t=this,n=e.identity,a=e.officeComponentContext,r=e.templatesConfig;return{getTemplatesData:function(e,i){return Object(o.__awaiter)(t,void 0,void 0,(function(){var t;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,T({app:e,identity:n,officeComponentContext:a,TemplatesConfig:r,handleRevalidation:i})];case 1:return[2,o.sent()];case 2:return t=o.sent(),[2,Promise.reject(t)];case 3:return[2]}}))}))},getTemplatesPageData:function(r,i){return Object(o.__awaiter)(t,void 0,void 0,(function(){var t,c,s,u;return Object(o.__generator)(this,(function(l){switch(l.label){case 0:t=function(t){var n,a,r=e.locStrings.authPageResources.m365_authPageHeader,i={Id:"Default",LocalizedTitle:r,DisplayName:r},c={LicenceInfo:"",TemplatesData:{},TemplateCategories:{},TemplateCollections:(n={},n[i.Id]={Id:i.Id,Name:i.DisplayName,TemplateCategories:[i.Id]},n)},s=[];return t.Template.forEach((function(e){e.Categories&&0!==e.Categories.length||(e.Categories=[i]),c.TemplatesData[e.AssetId]=e,s.push(e.AssetId)})),c.TemplateCategories=((a={})[i.Id]=Object(o.__assign)(Object(o.__assign)({},i),{BlankTemplateAssetID:"",SamplesAssetID:s,Name:i.DisplayName}),a),c},c=l.label=1;case 1:return l.trys.push([1,3,,4]),[4,T({app:r,identity:n,officeComponentContext:a,TemplatesConfig:e.templatesConfig,handleRevalidation:)];case 2:return s=l.sent(),[2,c(s)];case 3:return u=l.sent(),[2,Promise.reject(u)];case 4:return[2]}}))}))}}}},wiq1:function(e,t,n){"use strict";n.d(t,"a",();var o=n("Tqea");function a(e,t){return e.reduce((function(e,n){return void 0!==n.AssetId&&(n.IsBlank=!1,t&&(n.Application=Object(o.a)(t)),e.push(n)),e}),[])}}}]);
//# sourceMappingURL=vendors~custom-tdp.79f2da6acf5f3d866d5b.chunk.v7.js.map