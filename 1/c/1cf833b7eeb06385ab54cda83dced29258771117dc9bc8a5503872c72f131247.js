/*@license For license information please refer to eg-maps.licenses.txt*/
(self.webpackChunkblossom_flex_ui=self.webpackChunkblossom_flex_ui||[]).push([[87687],{90439:function(e){window,e.exports=function(){var e={736:function(e,t,n){e.exports=function(){var e={712:function(e,t){var n=t.O={};n.read=n._readField=function(e,t,r){1===e?t.dictionary=n.Dictionary.read(r,r.readVarint()+r.pos):2===e&&(t.content=n.Content.read(r,r.readVarint()+r.pos))},n.Dictionary={},n.Dictionary.read=function(e,t){return e.readFields(n.Dictionary._readField,{constants:[]},t)},n.Dictionary._readField=function(e,t,n){1===e&&t.constants.push(n.readString())},n.Feature={},n.Feature.read=function(e,t){return e.readFields(n.Feature._readField,{type:0,id:"",latitude:0,longitude:0,name:"",classifiers:[]},t)},n.Feature._readField=function(e,t,n){1===e?t.type=n.readVarint():2===e?t.id=n.readString():3===e?t.latitude=n.readVarint(!0):4===e?t.longitude=n.readVarint(!0):5===e?t.name=n.readString():6===e&&n.readPackedVarint(t.classifiers,!0)},n.Feature.Type={UNKNOWN:{value:0,options:{}},PLACE:{value:1,options:{}},PROPERTY:{value:2,options:{}}},n.Content={},n.Content.read=function(e,t){return e.readFields(n.Content._readField,{features:[]},t)},n.Content._readField=function(e,t,r){1===e&&t.features.push(n.Feature.read(r,r.readVarint()+r.pos))}}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,r),o.exports}r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return function(){r.r(i),r.d(i,{EGTSCodec:function(){return l}});var e=n(997),t=r.n(e),o=r(712);function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}ar l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var n,r,i;return n=e,(r=[{key:"decode",value:function(e){var n=this;return new Promise((function(r){var i,s=new(t())(e),u=o.O.read(s),l=[],c=a(u.content.features);try{for(c.s();!(i=c.n()).done;){var f=i.value;l.push({id:f.id,type:n._getType(f.type),lat:f.latitude/1e6-90,lng:f.longitude/1e6-180,name:f.name,qualifiers:f.classifiers.map(()})}}catch(e){c.e(e)}finally{c.f()}r(l)}))}},{key:"_getType",value:function(e){for(var t in o.O.Feature.Type)if(o.O.Feature.Type[t].value===e)return t.toLowerCase()}}])&&u(n.prototype,r),i&&u(n,i),e}()}(),i}()},501:function(){},744:164:997:function(e,t,n){e.exports=i;var r=n(164);.Varint=0,i.Fixed64=1,i.Bytes=2,i.Fixed32=5;var o=4294967296,a=1/o,s="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");ction f(e,t){for(var n=0;n<e.length;n++)t.writeVarint(e[n])}function d(e,t){for(var n=0;n<e.length;n++)t.writeSVarint(e[n])}function h(e,t){for(var n=0;n<e.length;n++)t.writeFloat(e[n])}function p(e,t){for(var n=0;n<e.length;n++)t.writeDouble(e[n])}function y(e,t){for(var n=0;n<e.length;n++)t.writeBoolean(e[n])}function v(e,t){for(var n=0;n<e.length;n++)t.writeFixed32(e[n])}function g(e,t){for(var n=0;n<e.length;n++)t.writeSFixed32(e[n])}function m(e,t){for(var n=0;n<e.length;n++)t.writeFixed64(e[n])}ototype={destroy:readFields:readMessage:readFixed32:function(){var e=k(this.buf,this.pos);return this.pos+=4,e},readSFixed32:readFixed64:function(){var e=k(this.buf,this.pos)+k(this.buf,this.pos+4)*o;return this.pos+=8,e},readSFixed64:readFloat:function(){var e=r.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:readVarint:readVarint64:readSVarint:readBoolean:readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&s?this.buf,t,e):this.buf,t,e)},readBytes:readPackedVarint:readPackedSVarint:function(e){if(this.type!==i.Bytes)return e.push(this.readSVarint());var t=u(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==i.Bytes)return e.push(this.readBoolean());var t=u(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==i.Bytes)return e.push(this.readFloat());var t=u(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==i.Bytes)return e.push(this.readDouble());var t=u(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==i.Bytes)return e.push(this.readFixed32());var t=u(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==i.Bytes)return e.push(this.readSFixed32());var t=u(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==i.Bytes)return e.push(this.readFixed64());var t=u(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:skip:writeTag:realloc:finish:writeFixed32:function(e){this.realloc(4),w(this.buf,e,this.pos),this.pos+=4},writeSFixed32:writeFixed64:function(e){this.realloc(8),w(this.buf,-1&e,this.pos),w(this.buf,Math.floor(e*a),this.pos+4),this.pos+=8},writeSFixed64:writeVarint:writeSVarint:writeBoolean:writeString:writeFloat:function(e){this.realloc(4),r.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:writeBytes:writeRawMessage:writeMessage:writePackedVarint:function(e,t){t.length&&this.writeMessage(e,f,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,d,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,y,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,h,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,p,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,v,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,g,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,m,t)},writePackedSFixed64:writeBytesField:function(e,t){this.writeTag(e,i.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,i.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,i.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,i.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,i.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,i.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,i.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,i.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,i.Fixed32),this.writeFloat(t)},writeDoubleField:writeBooleanField:},597:function(e){!function(){var t=function(e){return(e="number"==typeof e?{precision:e}:e||{}).precision=e.precision||5,e.factor=e.factor||Math.pow(10,e.precision),e.dimension=e.dimension||2,e},n={encode:function(e,n){n=t(n);for(var r=[],i=0,o=e.length;i<o;++i){var a=e[i];if(2===n.dimension)r.push(a.lat||a[0]),r.push(a.lng||a[1]);else for(var s=0;s<n.dimension;++s)r.push(a[s])}return this.encodeDeltas(r,n)},decode:function(e,n){n=t(n);for(var r=this.decodeDeltas(e,n),i=[],o=0,a=r.length;o+(n.dimension-1)<a;){for(var s=[],u=0;u<n.dimension;++u)s.push(r[o++]);i.push(s)}return i},encodeDeltas:function(e,n){n=t(n);for(var r=[],i=0,o=e.length;i<o;)for(var a=0;a<n.dimension;++a,++i){var s=e[i].toFixed(n.precision),u=s-(r[a]||0);r[a]=s,e[i]=u}return this.encodeFloats(e,n)},decodeDeltas:function(e,n){n=t(n);for(var r=[],i=this.decodeFloats(e,n),o=0,a=i.length;o<a;)for(var s=0;s<n.dimension;++s,++o)i[o]=Math.round((r[s]=i[o]+(r[s]||0))*n.factor)/n.factor;return i},encodeFloats:function(e,n){n=t(n);for(var r=0,i=e.length;r<i;++r)e[r]=Math.round(e[r]*n.factor);return this.encodeSignedIntegers(e)},decodeFloats:function(e,n){n=t(n);for(var r=this.decodeSignedIntegers(e),i=0,o=r.length;i<o;++i)r[i]/=n.factor;return r},encodeSignedIntegers:function(e){for(var t=0,n=e.length;t<n;++t){var r=e[t];e[t]=r<0?~(r<<1):r<<1}return this.encodeUnsignedIntegers(e)},decodeSignedIntegers:function(e){for(var t=this.decodeUnsignedIntegers(e),n=0,r=t.length;n<r;++n){var i=t[n];t[n]=1&i?~(i>>1):i>>1}return t},encodeUnsignedIntegers:decodeUnsignedIntegers:encodeSignedInteger:function(e){return e=e<0?~(e<<1):e<<1,this.encodeUnsignedInteger(e)},encodeUnsignedInteger:function(e){for(var t,n="";e>=32;)t=63+(32|31&e),n+=String.fromCharCode(t),e>>=5;return t=e+63,n+String.fromCharCode(t)}};if("object"==typeof e.exports&&(e.exports=n),"object"==typeof L){L.Polyline.prototype.fromEncoded||(L.Polyline.fromEncoded=function(e,t){return L.polyline(n.decode(e),t)}),L.Polygon.prototype.fromEncoded||(L.Polygon.fromEncoded=;var r={encodePath:;L.Polyline.prototype.encodePath||L.Polyline.include(r),L.Polygon.prototype.encodePath||L.Polygon.include(r),L.PolylineUtil=n}}()}},t={};.n=n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};return function(){n.r(r),n.d(r,{Animation:function(){return o},BaseMap:function(){return Bs},BrowserUtils:function(){return i},Cache:function(){return mr},ConfigHelper:function(){return eu},ConfigLoader:function(){return nr},ConsoleLogger:function(){return jn},EGMap:function(){return Uu},EventTypes:function(){return oi},EventsManager:function(){return ai},Geo:function(){return a},HtmlUtils:function(){return e},I18n:function(){return ar},IconUtils:function(){return s},KeyboardFeatures:function(){return so},KeyboardListeners:function(){return mo},Labels:function(){return l},Level:function(){return Tn},Logger:function(){return Bn},MarkerUtils:function(){return u},TilesLoader:function(){return ju},Utils:function(){return t},debugOptions:function(){return Qn},defaultConfig:function(){return au},defaultIcons:function(){return ou},i18nKeys:function(){return Oi},icons:function(){return ou},identifyUpdates:function(){return tu},newLogger:function(){return Dn},newMapData:function(){return Ds},ttlCache:function(){return wr}});var e={};n.r(e),n.d(e,{addClass:function(){return rt},addClasses:function(){return it},addNewCssStyle:function(){return Pt},anyChildrenMatching:function(){return le},anyChildrenWithClasses:function(){return se},areRectPointsAndCircleIntersecting:function(){return Ye},areRectsIntersecting:function(){return $e},changeImgSrc:function(){return Ke},changeSpanTextContent:function(){return ne},changeStyles:function(){return Re},changeTextNodeContent:function(){return re},childNodesAsArray:function(){return ae},childrenAsArray:function(){return oe},clearAriaLabel:function(){return qe},clearStyle:function(){return ut},createButton:function(){return we},createCheckbox:function(){return xe},createDiv:function(){return ge},createH1:function(){return Ce},createH2:function(){return Le},createHtml:function(){return ee},createImg:function(){return Me},createInput:function(){return ve},createLabel:function(){return ke},createLi:function(){return be},createSpan:function(){return Pe},createTextNode:function(){return te},createUl:function(){return me},detachElement:function(){return pe},documentIsDefined:function(){return ie},eltAsString:function(){return J},findChildIndex:function(){return ue},getClasses:function(){return nt},getDistanceBetweenPoints:function(){return pt},getDistanceToMoveRect:function(){return lt},getFirstChildWithClasses:function(){return ce},getIntersection:function(){return vt},getMaxRect:function(){return ft},getMovedRect:function(){return dt},getRect:function(){return ct},getRectCenter:function(){return ht},getRectIntersectionCandidates:function(){return yt},hasAriaLabel:function(){return Fe},hasClass:function(){return Qe},insertChild:function(){return gt},intersectionBottomSide:function(){return wt},intersectionLeftSide:function(){return kt},intersectionRightSide:function(){return mt},intersectionTopSide:function(){return bt},inverseClass:function(){return Xe},isAnHtmlElement:function(){return Y},isDisplayed:function(){return ze},isPointIntersectingCircle:function(){return Je},reattachElement:function(){return ye},removeAllChildren:function(){return fe},removeAriaLabel:function(){return Oe},removeAriaLive:function(){return Ae},removeChildById:function(){return he},removeClass:function(){return ot},removeClasses:function(){return at},removeElementById:function(){return de},replaceClasses:function(){return st},setAriaHidden:function(){return Ee},setAriaLabel:function(){return _e},setAriaLabelledBy:function(){return Se},setAriaLivePolite:function(){return Ie},setButtonRole:function(){return Be},setDisplay:function(){return Ne},setDisplayNone:function(){return Ve},setPosition:function(){return We},setPositionAttributes:function(){return Ge},setPresentationRole:function(){return De},setRole:function(){return Te},setWidthAndHeight:function(){return Ze},setZIndex:function(){return He},setZeroTabIndex:function(){return je},switchClass:function(){return et},switchClasses:function(){return tt},unsetDisplayNone:function(){return Ue}});var t={};n.r(t),n.d(t,{arrayEquals:function(){return qt},camelCaseToKebabCase:function(){return nn},camelCaseToSnakeCase:function(){return on},capitalizeString:function(){return It},chunkArray:function(){return jt},cleanCoordinatesArray:function(){return Vt},compareBounds:function(){return Ht},convertToCurrency:function(){return gn},countDecimals:function(){return Zt},fastHash:function(){return en},firstDefinedKey:function(){return Ot},firstDefinedValue:function(){return Ft},firstDefinedValueAndKey:function(){return St},getBalancedRate:function(){return hn},getMinPrice:function(){return Gt},getMultiLineLabelText:function(){return pn},getPaddedZoomAndCenter:function(){return fn},getPaddingPixels:function(){return ln},hashCode:function(){return vn},identifyDecimalSeparatorForPrice:function(){return Wt},intToHexString:function(){return Yt},isArray:function(){return Tt},isObject:function(){return At},kebabCaseToCamelCase:function(){return tn},listHashKeysSorted:function(){return Qt},opacityDecimalToHex:function(){return Xt},parseClientPadding:function(){return cn},randomAlphaNumeric:function(){return Jt},removeDuplicates:function(){return Rt},round:function(){return zt},roundLatLng:function(){return Kt},roundLatOrLng:function(){return Ut},roundZoom:function(){return Nt},snakeCaseToCamelCase:function(){return rn},sortDeeplyObjectAndArray:function(){return Bt},sortHashKeys:function(){return un},splitLabelTextIntoLines:function(){return dn},stringify:function(){return Dt},transformHistoricalBboxOutput:function(){return an},undefNullEmpty:function(){return Et},verifyKeyIsLegal:function(){return yn}});var i={};n.r(i),n.d(i,{getCookieValue:function(){return qn},promiseAllSettled:function(){return Hn},timeoutFetch:function(){return Zn}});var o={};n.r(o),n.d(o,{bounce:function(){return rr}});var a={};n.r(a),n.d(a,{addMeterToLat:function(){return Nr},areBoundsCrossingDateLine:function(){return Tr},areCoordinatesCrossingDateLine:function(){return Ar},areLongitudesCrossingDateLine:function(){return Ir},computeTileDistance:function(){return Rr},computeTilesIds:function(){return Or},computeZoomFromBBox:function(){return _r},convertGeoJsonPolygonToPath:function(){return Vr},directionFromOrigin:function(){return Br},furthestLatOrLong:function(){return Dr}});var s={};n.r(s),n.d(s,{areIconsDifferent:function(){return Qr},ensureImageIsLoaded:function(){return Gr},events:function(){return Kr},extractImgSourcesFromIcons:function(){return Hr},flatIcons:function(){return Wr},flatSuppIcons:function(){return qr},preloadIcons:function(){return Zr}});var u={};n.r(u),n.d(u,{bounceMarker:function(){return Ya},createBasicTextMarker:function(){return Ka},createCornerIcons:function(){return es},createDoubleClickEventCanceller:function(){return us},createImageIcon:function(){return za},createInnerIcons:function(){return ts},haveCornerIconsChanged:function(){return rs},haveInnerIconsChanged:function(){return is},identifyCornerIcons:function(){return as},identifyInnerIcons:function(){return ss},identifyMarkerLabelsProperties:function(){return Za},identifyMarkerProperties:function(){return qa},refreshLabel:function(){return Qa},setAccessibilityFields:function(){return Ga},setMarkerIcons:function(){return $a},setMarkerZIndex:function(){return Xa},switchAriaLabel:function(){return Wa}});var l={};n.r(l),n.d(l,{collisionCssClass:function(){return lu},createLabels:function(){return fu},getRectOfMarkerLabel:function(){return pu}}),n(501);var c=6371008.8,f={centimeters:637100880,centimetres:637100880,degrees:57.22891354143274,feet:20902260.511392,inches:39.37*c,kilometers:6371.0088,kilometres:6371.0088,meters:c,metres:c,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:c/1852,radians:1,yards:6967335.223679999};function d(e,t,n){void 0===n&&(n={});var r={type:"Feature"};return(0===n.id||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=t||{},r.geometry=e,r}function h(e,t,n){if(void 0===n&&(n={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!m(e[0])||!m(e[1]))throw new Error("coordinates must contain numbers");return d({type:"Point",coordinates:e},t,n)}unction y(e,t){void 0===t&&(t="kilometers");var n=f[t];if(!n)throw new Error(t+" units is invalid");return e/n}function v(e){return e%(2*Math.PI)*180/Math.PI}function g(e){return e%360*Math.PI/180}function m(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}function b(e,t,n,r){void 0===r&&(r={});var i=e),o=g(i[0]),a=g(i[1]),s=g(n),u=y(t,r.units),l=Math.asin(Math.sin(a)*Math.cos(u)+Math.cos(a)*Math.sin(u)*Math.cos(s));return h([v(o+Math.atan2(Math.sin(s)*Math.sin(u)*Math.cos(a),Math.cos(u)-Math.sin(a)*Math.sin(l))),v(l)],r.properties)}var k=function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==w(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==w(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r.key,"string"),"symbol"===w(i)?i:String(i)),r)}var i}var C=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"getClustersAndFeatures",value:])&&P(t.prototype,n),r&&P(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(); O=e=>e[0],S=onst I={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:,A=Math.fround||(T=new Float32Array(1),;var T;H(e){return e.x}ar q=n(744),W=n.n(q);function G(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||$(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Q(e){return function(e){if(Array.isArray(e))return X(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||$(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $(e,t){if(e){if("string"==typeof e)return X(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?X(e,t):void 0}}function X(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}nction ee(e,t,n,r,i,o,a){var s=document.createElement(t);return e&&(s.id=e),i&&(s.style.cssText=i),r&&(s.className=r),a&&rt(s,a),n&&n.appendChild(s),o&&o.length>0&&te(s,o),s}function te(e,t){var n=document.createTextNode(t);return e&&e.appendChild(n),n}function ne(e,t){var n=ae(e).filter(();return 1===n.length&&(re(n[0],t),!0)}nction oe(e){var t=[];if(null!=e&&e.children)for(var n=0;n<e.children.length;n++)t.push(e.children[n]);return t}function ae(e){var t=[];if(null!=e&&e.childNodes)for(var n=0;n<e.childNodes.length;n++)t.push(e.childNodes[n]);return t}function se(e,t){return le(e,t?function(e){if("string"==typeof e.className){var n,r=(null===(n=e.className)||void 0===n?void 0:n.split(" "))||[];return t.every((function(e){return r.includes(e)}))}return!1}:function(){return!0},arguments.length>2&&void 0!==arguments[2]&&arguments[2],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[])}function ue(e){if(e){var t=e.parentNode;return Array.prototype.indexOf.call(t.children,e)}return-1}function le(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(e&&e.children)for(var i=0;i<e.children.length;i++){var o=e.children[i];o&&(t(o)&&r.push({element:o,parent:e,index:i}),n&&le(o,t,n,r))}return r}function ce(e,t){var n;return null===(n=se(e,t,arguments.length>2&&void 0!==arguments[2]&&arguments[2],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[]))||void 0===n||null===(n=n[0])||void 0===n?void 0:n.element}nction he(e,t){if(e){var n=document.getElementById(t);n&&n.parentNode&&n.parentNode===e&&e.removeChild(n)}}function pe(e){var t;e&&(null===(t=e.parentNode)||void 0===t||t.removeChild(e))}function ye(e,t){var n;e&&(null===(n=e.parentNode)||void 0===n||n.removeChild(e),null==t||t.appendChild(e))}function ve(e,t,n,r,i,o,a,s){var u=ee(e,"input",n,r,i,void 0,s);return u.type=t,o&&(u.value=o),_e(u,a),u}function ge(e,t,n,r,i){return ee(e,"div",t,n,r,void 0,i)}function me(e,t,n,r,i){return ee(e,"ul",t,n,r,void 0,i)}function be(e,t,n,r,i,o){return ee(e,"li",t,n,r,i,o)}function ke(e,t,n,r,i,o){return ee(e,"label",t,n,r,i,o)}function we(e,t,n,r,i,o){return ee(e,"button",t,n,r,i,o)}function Pe(e,t,n,r,i,o){return ee(e,"span",t,n,r,i,o)}function Ce(e,t,n,r,i,o){return ee(e,"h1",t,n,r,i,o)}function Le(e,t,n,r,i,o){return ee(e,"h2",t,n,r,i,o)}function xe(e,t,n,r,i,o,a,s){var u=ve(e,"checkbox",t,n,r,i,a,s);return o&&(u.checked=!0),u}function Me(e,t,n,r,i,o,a){var s=ee(e,"img",t,n,r,void 0,a);return i&&(s.src=i),_e(s,o),s}function _e(e,t){e&&t&&e.setAttribute("aria-label",t)}function Fe(e){if(e){var t=e.getAttribute("aria-label");return((null==t?void 0:t.length)||0)>0}return!1}function Oe(e){e&&e.removeAttribute("aria-label")}function Se(e,t){e&&e.setAttribute("aria-labelledby",t)}function Ee(e){e&&e.setAttribute("aria-hidden","true")}function Ie(e){e&&e.setAttribute("aria-live","polite")}function Ae(e){e&&e.removeAttribute("aria-live")}function Te(e,t){e&&("presentation"===t&&e.setAttribute("aria-hidden","true"),e.setAttribute("role",t))}function De(e){Te(e,"presentation")}function Be(e){Te(e,"button")}unction Re(e,t){var n,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=$(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(t);try{for(r.s();!(n=r.n()).done;){var i=n.value,o=i.indexOf(":"),a=i.slice(0,o).trim(),s=i.slice(o+1).trim();e.style[a]=s}}catch(e){r.e(e)}finally{r.f()}}unction Ve(e){Ne(e,"none")}unction ze(e){if(e)return!e.style.display||"none"!==e.style.display}unction He(e,t){e&&(e.style.zIndex="".concat(t))}function Ze(e,t,n){e&&(void 0!==t&&(e.style.width="number"==typeof t?"".concat(t,"px"):t),void 0!==n&&(e.style.height="number"==typeof n?"".concat(n,"px"):n))}function qe(e){e&&e.removeAttribute("aria-label")}function We(e,t,n,r,i,o){if(e){var a=void 0!==i?2*i:e.offsetWidth,s=Math.floor(a/2),u=void 0!==o?2*o:e.offsetHeight,l=Math.floor(u/2),c=0,f=0;if(r)switch(r){case"top":c=-s,f=0;break;case"middle":c=-s,f=-l;break;case"bottom":c=-s,f=-u;break;case"left":c=0,f=-l;break;case"right":c=-a,f=-l;break;case"top-left":c=0,f=0;break;case"top-right":c=-a,f=0;break;case"bottom-left":c=0,f=-u;break;case"bottom-right":c=-a,f=-u}Ge(e,{left:"".concat(Math.round(t+c),"px"),top:"".concat(Math.round(n+f),"px")})}}function Ge(e,t){var n=t.bottom,r=t.left,i=t.right,o=t.top;e&&(n||r||i||o)&&(e.style.top=null!=o?o:"",e.style.bottom=null!=n?n:"",e.style.left=null!=r?r:"",e.style.right=null!=i?i:"")}function Qe(e,t){var n;return!!e&&((null===(n=e.className)||void 0===n?void 0:n.split(" "))||[]).includes(t)}function $e(e,t){return e.left<t.left+t.width&&e.left+e.width>t.left&&e.top<t.top+t.height&&e.top+e.height>t.top}function Xe(e,t,n){e&&(Qe(e,t)?et(e,t,n):Qe(e,n)&&et(e,n,t))}function Ye(e,t){return Je(e.right,e.top,t)||Je(e.left,e.top,t)||Je(e.left,e.bottom,t)||Je(e.right,e.bottom,t)||Je(e.center.x,e.center.y,t)}function Je(e,t,n){return Math.sqrt((e-n.center.x)*(e-n.center.x)+(t-n.center.y)*(t-n.center.y))<n.radius}function et(e,t,n){tt(e,[t],[n])}function tt(e,t,n){if(e){var r,i=(null===(r=e.className)||void 0===r?void 0:r.split(" "))||[];t&&t.forEach((function(e){i.indexOf(e)>=0&&i.splice(i.indexOf(e),1)})),n&&n.forEach((function(e){i.includes(e)||i.push(e)})),e.className=i.filter((function(e){return e.length>0})).join(" ")}}function nt(e){var t;return(null==e||null===(t=e.className)||void 0===t?void 0:t.split(" "))||[]}function rt(e,t){if(e){var n,r=(null===(n=e.className)||void 0===n?void 0:n.split(" "))||[];r.includes(t)||r.push(t),e.className=r.filter((function(e){return e.length>0})).join(" ")}}function it(e,t){if(e){var n,r=null===(n=e.className)||void 0===n?void 0:n.split(" ");t.forEach((),e.className=r.filter((function(e){return e.length>0})).join(" ")}}function ot(e,t){if(e){var n,r=(null===(n=e.className)||void 0===n?void 0:n.split(" "))||[];r.indexOf(t)>=0&&r.splice(r.indexOf(t),1),e.className=r.filter((function(e){return e.length>0})).join(" ")}}function at(e,t){if(e){var n,r=null===(n=e.className)||void 0===n?void 0:n.split(" ");t.forEach((function(e){r.indexOf(e)>=0&&r.splice(r.indexOf(e),1)})),e.className=r.filter(().join(" ")}}nction lt(e,t,n){var r=(t.center.y-e.center.y)/(t.center.x-e.center.x),i=pt(e.center,t.center),o=r!==-1/0?t.center.y-r*t.center.x:void 0,a={from:vt(t,r,o,-i.x,-i.y),to:vt(e,r,o,i.x,i.y)};return pt(a.from||t.center,a.to||e.center,n)}function ct(e,t,n){return{center:e,width:t,height:n,left:e.x-t/2,top:e.y-n/2,right:e.x+t/2,bottom:e.y+n/2}}function ft(e){var t={bottom:Math.max.apply(Math,Q(e.map((function(e){return e.bottom})))),left:Math.min.apply(Math,Q(e.map((function(e){return e.left})))),right:Math.max.apply(Math,Q(e.map((function(e){return e.right})))),top:Math.min.apply(Math,Q(e.map((function(e){return e.top}))))};return t.center=ht(t),t.width=t.right-t.left,t.height=t.bottom-t.top,t}function dt(e,t){var n={bottom:e.bottom+t.y,left:e.left+t.x,right:e.right+t.x,top:e.top+t.y,height:e.height,width:e.width};return n.center=ht(n),n}function ht(e){return{x:(e.right-e.left)/2+e.left,y:(e.bottom-e.top)/2+e.top}}function pt(e,t,n){var r=t.x-e.x,i=t.y-e.y;return{x:r+(n?n*Math.sign(r):0),y:i+(n?n*Math.sign(i):0)}}function yt(e,t){return e>0&&0===t?"right":0===e&&t<0?"top":e<0&&0===t?"left":0===e&&t>0?"bottom":e>0&&t<0?"topOrRight":e<0&&t<0?"topOrLeft":e<0&&t>0?"bottomOrLeft":e>0&&t>0?"bottomOrRight":void 0}function vt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;switch(yt(arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0)){case"right":return mt(e,t,n);case"top":return bt(e,t,n);case"left":return kt(e,t,n);case"bottom":return wt(e,t,n);case"topOrRight":return bt(e,t,n)?bt(e,t,n):mt(e,t,n);case"topOrLeft":return kt(e,t,n)?kt(e,t,n):bt(e,t,n);case"bottomOrLeft":return wt(e,t,n)?wt(e,t,n):kt(e,t,n);case"bottomOrRight":return mt(e,t,n)?mt(e,t,n):wt(e,t,n)}}function gt(e,t,n){if(e&&t)if(n>=t.children.length)t.appendChild(e);else{var r=oe(t)[n];t.insertBefore(e,r)}}function mt(e,t,n){var r=t*e.right+n;if(r>=e.top&&r<=e.bottom)return{x:e.right,y:r}}function bt(e,t,n){var r=t!==-1/0?(e.top-n)/t:e.center.x;if(r>=e.left&&r<=e.right)return{x:r,y:e.top}}function kt(e,t,n){var r=t*e.left+n;if(r>=e.top&&r<=e.bottom)return{x:e.left,y:r}}function wt(e,t,n){var r=t!==-1/0?(e.bottom-n)/t:e.center.x;if(r>=e.left&&r<=e.right)return{x:r,y:e.bottom}}function Pt(e,t,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n.g.document;if(o){var a=G(o.getElementsByTagName("head"),1)[0];if(a){var s=o.createElement("style");s.id=e,s.setAttribute("data-meta",t),a.appendChild(s);var u,l=s.sheet;if(l)if(void 0!==l.insertRule)u=function(e,t,n){return e.insertRule(t+"{"+n+"}",e.cssRules.length)};else{if(void 0===l.addRule)throw new Error("no insertRule or addRule in sheet");u=var c=[];Object.keys(i).forEach((function(e){var t=i[e],n=".egmaps.".concat(r," ").concat(e),o=Object.keys(t).map((function(e){return"".concat(nn(e),":").concat(t[e]||"''")})).join(";");u(l,n,o),c.push("".concat(n," {\n  ").concat(o.split(";").join(";\n  "),";\n}"))}));var f=o.createTextNode(c.join("\n\n"));s.appendChild(f)}}}function Ct(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||Mt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lt(e){return function(e){if(Array.isArray(e))return _t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Mt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xt(e){return xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xt(e)}function Mt(e,t){if(e){if("string"==typeof e)return _t(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_t(e,t):void 0}}function _t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ft(e,t){return(St(e,t)||{}).value}function Ot(e,t){return(St(e,t)||{}).key}function St(e,t){if(t){var n,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Mt(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i){var o=null==e?void 0:e[i];if(void 0!==o)return{key:i,value:o}}}}catch(e){r.e(e)}finally{r.f()}}}nction At(e){return null!==e&&"object"===xt(e)&&!Y(e)&&"[object Array]"!==Object.prototype.toString.call(e)}unction Dt(e){return JSON.stringify(e,(t=new WeakSet,);var t}function Bt(e){if(e){if(Tt(e))return e.sort();if(At(e)){var t;if("Object"===(null===(t=e.constructor)||void 0===t?void 0:t.name)){var n={};return Object.keys(e).sort().forEach((),n}return e}return e}return e}function jt(e,t){if(t<=0)throw new Error("chunk size should be greater than 0");var n=0,r=e.length,i=[];for(n=0;n<r;n+=t){var o=e.slice(n,n+t);i.push(o)}return i}function Rt(e){return e&&0!==e.length?Lt(new Set(e)):[]}unction Vt(e){return e.filter((function(e){if(void 0!==e){var t=e.lat,n=e.lng;if(!t&&void 0!==e.length){var r=Ct(e,2);t=r[0],n=r[1]}if(void 0!==t&&void 0!==n)return e}})).filter((function(e){return void 0!==e}))}function Ut(e){var t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=zt(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:5);if(t){if(n<-180)return n+360;if(n>180)return n-360}return n}function zt(e,t){var n=Math.pow(10,t),r=e*n;return(r=Math.round(r))/n}function Kt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=e.lat,i=e.lng;if(!r&&void 0!==e.length){var o=Ct(e,2);r=o[0],i=o[1]}return[Ut(r,t,!1),Ut(i,t,n)]}function Ht(e,t){if(!e)return!t;if(!t)return!1;var n=e.sw,r=e.ne,i=e.center,o=t.sw,a=t.ne,s=t.center;return n[0]===o[0]&&n[1]===o[1]&&r[0]===a[0]&&r[1]===a[1]&&i[0]===s[0]&&i[1]===s[1]}function Zt(e){var t=Number(e);return Math.floor(t.valueOf())===t.valueOf()?0:t.toString().split(".")[1].length||0}function qt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:if(e.length!==t.length)return!1;var i=t.slice();return e.every((function(e,t){var o=i.findIndex(();return o>=0&&(!n||t===o)}))}function Wt(e){var t=e.indexOf("."),n=e.indexOf(",");if(-1!==t||-1!==n){var r=n>t?",":".",i=n>t?n:t;if(e.length<=i+3)return r;for(var o=i+1;o<=i+3;o++){var a=e.charAt(o);if(isNaN(a)||" "===a)return r}if(e.length>=i+4){var s=e[i+4];if(!isNaN(s)&&" "!==s)return r}}}function Gt(e){for(var t,n,r=0;r<e.length;r++){var i=e[r];if(!t&&"string"==typeof i){var o=Wt(i);o&&(n=(t=o)&&","===t?".":",")}}var a=void 0,s=void 0;if(e.forEach((function(e){var r=t?W()(e,{decimal:t,separator:n}).value:W()(e).value;(!a||a>r)&&(a=r,s=e)})),a&&isFinite(a))return s}function Qt(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=n?n.sort():[],o=[],a=function(e){for(var t=e.depth;t>=0;t--)for(var n=e[t],r=n.maxQualifiers;r>=0;r--)n[r]&&(o=o.concat(n[r]))};if(t){var s={depth:1,0:["hl"]};$t("hl#",i.slice(),e,s,1,0),a(s),e&&o.push(["hl",e].sort().join("#")),o.push("hl")}var u={depth:-1};return $t("",i.slice(),e,u,0,0),a(u),e&&o.push(e),r&&o.push("default"),o}function $t(e,t,n,r,i,o){var a=r[i];for(a||(a={maxQualifiers:o},r[i]=a,r.depth=i);t.length>0;){var s=t.splice(0,1),u=o+1;if(a[u]||(a[u]=[]),a.maxQualifiers<u&&(a.maxQualifiers=u),a[u].push("".concat(e).concat(s).split("#").sort().join("#")),n){var l=r[i+1];l||(l={maxQualifiers:u},r[i+1]=l,r.depth=i+1),l[u]||(l[u]=[]),l[u].push("".concat(e).concat(s,"#").concat(n).split("#").sort().join("#"))}t.length>0&&$t("".concat(e).concat(s,"#"),t.slice(),n,r,i+1,o+1)}}unction Yt(e){var t=parseInt(e);t<0&&(t=4294967295+t);var n=t.toString(16).toUpperCase();return 1==n.length?n+"0":n.slice(-2)}function Jt(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=0;r<e;r++)t+=n.charAt(Math.floor(62*Math.random()));return t}function en(e){return e.split("").reduce((function(e,t){var n=(e<<5)-e+t.charCodeAt(0);return n&n}),0)}function tn(e){return e.split("-").map((function(e,t){return 0===t?e.charAt(0).toLowerCase()+e.slice(1):e.charAt(0).toUpperCase()+e.slice(1)})).join("")}function nn(e){var t=[];return e.split("").forEach((function(e,n){var r=e.toUpperCase();e===r&&e.toLowerCase()!==r?n>0?t.push("-",e.toLowerCase()):t.push(e.toLowerCase()):t.push(e)})),t.join("")}function rn(e){return e.split("_").map((function(e,t){return 0===t?e.charAt(0).toLowerCase()+e.slice(1):e.charAt(0).toUpperCase()+e.slice(1)})).join("")}function on(e){var t=[];return e.split("").forEach((function(e,n){var r=e.toUpperCase();e===r&&e.toLowerCase()!==r?n>0?t.push("_",e.toLowerCase()):t.push(e.toLowerCase()):t.push(e)})),t.join("")}function an(e){return e.substring(e.indexOf("((")+2,e.lastIndexOf("))")).split(", ").map((function(e){return e.split(" ")})).map((function(e){return{lng:Number(parseFloat(e[0]).toFixed(8)),lat:Number(parseFloat(e[1]).toFixed(8))}}))}var sn=function(e,t,n){t.has(n)&&(e.push(n),t.delete(n))},un=function(e){var t=["available","filtered","sold_out","unknown"],n=new Set,r=new Set;e.forEach((function(e){(function(e){return["available","filtered","sold_out","unknown"].some(()})(e)||-1!==e.indexOf("hl")||-1!==e.indexOf("default")||e.split("#").forEach((function(e){return r.add(e)})),n.add(e)}));var i=[];sn(i,n,"default"),t.forEach(();var o=Array.from(r).sort(),a=function(e,t){for(var n=function e(t,n,r,i){if(0!=t)for(var o=0;o<n.length;o++)e(t-1,n.slice(o+1),r.concat([n[o]]),i);else r.length>0&&(i[i.length]=r)},r=[],i=1;i<e.length;i++)n(i,e,[],r);return r.push(e),r}(o).map((function(e){return e.join("#")}));if(o.length>0){for(var s=function(e){for(var r=o.length-1;r>=0;r--)sn(i,n,a[e+r]);for(var s=function(r){t.forEach((function(t){for(var s=o.length;s>=0;s--)sn(i,n,"".concat(t,"#").concat(a[e+r]))}))},u=o.length-1;u>=0;u--)s(u)},u=0;u<a.length-1;u+=o.length)s(u);sn(i,n,a[a.length-1]),t.forEach((function(e){return sn(i,n,"".concat(e,"#").concat(a[a.length-1]))}))}if(sn(i,n,"hl"),t.forEach((function(e){return sn(i,n,"".concat(e,"#hl"))})),o.length>0){for(var l=function(e){for(var r=o.length-1;r>=0;r--)sn(i,n,"hl#".concat(a[e+r]));for(var s=function(r){t.forEach((function(t){for(var s=o.length;s>=0;s--)sn(i,n,"".concat(t,"#hl#").concat(a[e+r]))}))},u=o.length-1;u>=0;u--)s(u)},c=0;c<a.length-1;c+=o.length)l(c);sn(i,n,"hl#".concat(a[a.length-1])),t.forEach((function(e){return sn(i,n,"".concat(e,"#hl#").concat(a[a.length-1]))}))}return i.reverse()};function ln(e,t,n){var r;return r="%"===t?parseFloat(e)*n/100:parseFloat(e),Number.isFinite(r)?r:void 0}function cn(e,t){var n,r;if(void 0!==e){if("string"!=typeof e)throw new Error("Client padding has to be of type string");var i=t||{},o=i.clientHeight,a=i.clientWidth;if(!Number.isFinite(o)||!Number.isFinite(a))throw new Error("Dimensions of map element have to be of type number: {height: ".concat(o,", width: ").concat(a,"}"));var s=e.match(/^(((\d+)(\.\d+)?)(px|%|))( ((\d+)(\.\d+)?)(px|%|))?( ((\d+)(\.\d+)?)(px|%|))?( ((\d+)(\.\d+)?)(px|%|))?$/);if(!s)throw new Error("Client padding has to follow CSS syntax and only use 'px' and '%' units");var u=Ct(s,21),l=u[2],c=u[5],f=u[7],d=u[10],h=u[12],p=u[15],y=u[17],v=u[20];return{paddingTop:ln(l,c,o),paddingRight:ln(null!=f?f:l,null!=d?d:c,a),paddingBottom:ln(null!=h?h:l,null!=p?p:c,o),paddingLeft:ln(null!==(n=null!=y?y:f)&&void 0!==n?n:l,null!==(r=null!=v?v:d)&&void 0!==r?r:c,a)}}}function fn(e,t,n){var r=Kt(t);if(n){var i=n.paddingTop,o=void 0===i?0:i,a=n.paddingRight,s=void 0===a?0:a,u=n.paddingBottom,l=void 0===u?0:u,c=n.paddingLeft,f=void 0===c?0:c,d=Math.pow(2,Nt(e+1)),h=[(o-l)/d,(s-f)/d];r=Kt(r.map(())}return{zoom:Nt(e),center:r}}function dn(e,t,n){var r=parseInt(t),i=parseInt(n),o=String(e);if(o&&r&&i&&r>0&&i>0&&o.length>r){for(var a=o.replace(/[\u0000-\u001F\u007F-\u009F]/g," ").trim().split(/\s+/g).map((),s=[],u=[],l=0;a.length>0&&u.length<=i;){var c=Ct(a,1)[0];((l+=c.length)<=r||l>r&&0===s.length)&&(s.push(c.join("")),a.shift()),(l>=r||l<r&&0===a.length)&&(u.push(s.join(" ")),s=[],l=0)}return u.length>i&&(u.pop(),u.push(u.pop()+"...")),u.join("\n")}return o}function hn(e){var t=e.split("\n").map(();if(1===t.length)return 0;var n=Math.max.apply(Math,Lt(t));return Math.min.apply(Math,Lt(t))/n}function pn(e,t,n){for(var r=String(e),i=0,o=Math.min(Math.floor(r.length/n),t),a=t;a>=o;){var s=dn(e,a,n),u=hn(s);if(!u||0===u||u>=.5)return s;u>i&&(r=s,i=u),a--}return r}nction gn(e,t,n,r){if(!e||isNaN(e))return e;var i=t||Zt(e),o={style:"currency",currency:n,minimumFractionDigits:i,maximumFractionDigits:i};return new Intl.NumberFormat(r,o).format(e)}function mn(e){return mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mn(e)}function bn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||kn(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kn(e,t){if(e){if("string"==typeof e)return wn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wn(e,t):void 0}}function wn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Pn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==mn(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==mn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r.key,"string"),"symbol"===mn(i)?i:String(i)),r)}var i}function Cn(e,t){return Cn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Cn(e,t)}function Ln(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=xn(e);if(t){var i=xn(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===mn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function xn(e){return xn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},xn(e)}var Mn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Cn(e,t)}(o,e);var t,n,r,i=Ln(o);function o(e,t,n,r){var a,s,u,l,c,f,d;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(d=i.call(this)).logger=e("SuperCluster"),d._config=t,d._defaultConfig=n,d.labelKey=null!==(a=d._config.labelKey)&&void 0!==a?a:n.labelKey||"unknown",d._radius=null!==(s=null!==(u=null===(l=d._config.superclusterSettings)||void 0===l?void 0:l.radius)&&void 0!==u?u:null===(c=n.superclusterSettings)||void 0===c?void 0:c.radius)&&void 0!==s?s:0,d._previousMapSize=void 0,d._mapSize=void 0,d._tileDim=void 0,d._supercluster=void 0,d.qualifier=r,d.excludedQualifiers=null!==(f=d._config.excludedQualifiers)&&void 0!==f?f:n.excludedQualifiers,d}return t=o,n=[{key:"radius",get:function(){if(!this._tileDim||!this._mapSize)return 0;var e=this._tileDim,t=e.width,n=e.height,r=this._mapSize,i=75*r.clientWidth/t,o=75*r.clientHeight/n;return Math.min(this._radius,i,o)}},{key:"supercluster",get:function(){var e,t,n,r=this._previousMapSize||{},i=r.clientWidth,o=r.clientHeight,a=this._mapSize||{},s=a.clientWidth,u=a.clientHeight;return this._supercluster&&i===s&&o===u||(this._supercluster=new D({minPoints:null!==(e=this._config.minPoints)&&void 0!==e?e:this._defaultConfig.minPoints,minZoom:null!==(t=this._config.minZoom)&&void 0!==t?t:this._defaultConfig.minZoom,maxZoom:null!==(n=this._config.maxZoom)&&void 0!==n?n:this._defaultConfig.maxZoom,radius:this.radius})),this._supercluster}},{key:"getClustersAndFeatures",value:function(e,t,n,r,i,o,a){this._previousMapSize=this._mapSize,this._mapSize=o,this._tileDim=a;var s=e.remainingFeatures,u=e.clusters,l=this._getExcludedFeatures(s,n),c=l.map((function(e){return e.id})),f=s.filter((),d=this._loadFeaturesForClustering(f);return this._clusterFeatures(d,u,t,l,r,i)}},{key:"_loadFeaturesForClustering",value:function(e){var t=this,n=e.map(();return this.supercluster.load(n)}},{key:"_clusterFeatures",value:function(e,t,n,r,i,o){var a=this._convertBoundsToBbox(i),s=e.getClusters(a,Math.floor(o));return this._getAllFeaturesAndClusters(e,t,n,r,s)}},{key:"_convertBoundsToBbox",value:function(e){return[e.sw[1],e.sw[0],e.ne[1],e.ne[0]]}},{key:"_makeGeoJsonFeature",value:function(e){var t=[e.latLng[1],e.latLng[0]];return{id:e.id,type:"Feature",geometry:{type:"Point",coordinates:t},properties:e}}},{key:"_getAllFeaturesAndClusters",value:function(e,t,n,r,i){var o,a={clusters:t,remainingFeatures:r},s=i);try{for(s.s();!(o=s.n()).done;){var u=o.value;if(u.properties.cluster){var l=u.properties.cluster_id,c=e.getLeaves(l,1/0),f=Gt(c.map(())||0,d=bn(u.geometry.coordinates,2),h=d[0],p={id:l,children:c,minPrice:f,lat:d[1],lng:h,type:"cluster",radius:this.radius};a.clusters.push({cluster:p,labelKey:this.labelKey,featureType:n,qualifier:this.qualifier})}else a.remainingFeatures.push(u.properties)}}catch(e){s.e(e)}finally{s.f()}return a}},{key:"_getExcludedFeatures",value:function(e,t){var n=this;return e.filter((function(e){var r;return(e.qualifiers||[]).some(()||!(null!==(r=e.hashKeys)&&void 0!==r&&r.includes(t))}))}}],n&&Pn(t.prototype,n),r&&Pn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(C);function _n(e,t){return _n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_n(e,t)}function Fn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=On(e);if(t){var i=On(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===Sn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function On(e){return On=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},On(e)}function Sn(e){return Sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sn(e)}function En(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function In(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==Sn(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Sn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r.key,"string"),"symbol"===Sn(i)?i:String(i)),r)}var i}function An(e,t,n){return t&&In(e.prototype,t),n&&In(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Tn={OFF:"OFF",DEBUG:"DEBUG",INFO:"INFO",WARN:"WARN",ERROR:"ERROR"};function Dn(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=n?new jn:null!=t?t:new jn;return{debug:function(t,i){return r.debug({loggerName:e,message:t,stack:i,debugMode:n})},info:function(t,i){return r.info({loggerName:e,message:t,stack:i,debugMode:n})},warn:function(t,i){return r.warn({loggerName:e,message:t,stack:i,debugMode:n})},error:debugEnabled:function(){return r.debugEnabled()},infoEnabled:function(){return r.infoEnabled()},warnEnabled:function(){return r.warnEnabled()},errorEnabled:function(){return r.errorEnabled()}}}var Bn=function(){eturn An(e,[{key:"log",value:,{key:"enabled",value:,{key:"debug",value:function(e){var t=e.loggerName,n=e.message,r=e.stack,i=e.debugMode;return this.log(t,Tn.DEBUG,n,r,i)}},{key:"info",value:function(e){var t=e.loggerName,n=e.message,r=e.stack,i=e.debugMode;return this.log(t,Tn.INFO,n,r,i)}},{key:"warn",value:function(e){var t=e.loggerName,n=e.message,r=e.stack,i=e.debugMode;return this.log(t,Tn.WARN,n,r,i)}},{key:"error",value:function(e){var t=e.loggerName,n=e.message,r=e.stack,i=e.debugMode;return this.log(t,Tn.ERROR,n,r,i)}},{key:"debugEnabled",value:function(){return this.enabled(Tn.DEBUG)}},{key:"infoEnabled",value:function(){return this.enabled(Tn.INFO)}},{key:"warnEnabled",value:function(){return this.enabled(Tn.WARN)}},{key:"errorEnabled",value:]),e}(),jn=function(e){!n,e);var t=Fn(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Tn.WARN,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e,t,n){return"".concat((new Date).toISOString()," EGMAPS-").concat("6.3.6"," ").concat(e||"undefined"," ").concat(t," ").concat(n)};return En(this,n),(e=t.call(this)).formatter=i,e.level=r,e}return An(n,[{key:"enabled",value:function(e){if(this.level!==Tn.OFF)switch(e){case Tn.DEBUG:return this.level===Tn.DEBUG;case Tn.INFO:return this.level===Tn.DEBUG||this.level===Tn.INFO;case Tn.WARN:return this.level===Tn.DEBUG||this.level===Tn.INFO||this.level===Tn.WARN;case Tn.ERROR:return this.level===Tn.DEBUG||this.level===Tn.INFO||this.level===Tn.WARN||this.level===Tn.ERROR;default:throw new Error("level not implemented: ".concat(e))}return!1}},{key:"log",value:function(e,t,n,r,i){var o,a,s,u;if(this.enabled(t||Tn.INFO)||i){var l=[this.formatter(e,t||Tn.INFO,n)];switch(r&&l.push(r),t){case Tn.DEBUG:(o=console).debug.apply(o,l);break;case Tn.INFO:default:(a=console).info.apply(a,l);break;case Tn.WARN:(s=console).warn.apply(s,l);break;case Tn.ERROR:(u=console).error.apply(u,l)}return!0}}}]),n}(Bn);function Rn(e){return Rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rn(e)}function Nn(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Vn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Vn(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:n:e:f:}function Vn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}ction Hn(e){return Promise.allSettled?Promise.allSettled(e):Promise.all(e.map(())}function Zn(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("undefined"!=typeof AbortController){var i=new AbortController;return setTimeout((function(){return i.abort()}),t),fetch(e,zn(zn({},r),{},{signal:i.signal})).catch((function(r){if(null!=r&&r.toString().includes("The user aborted a request"))return{clone:function(){return n},redirected:!1,type:"basic",url:e,ok:!1,success:!1,status:504,headers:[],statusText:"timeout occurs after ".concat(t,"ms when fetching ").concat(e),arrayBuffer:function(){return Promise.reject(new Error("timeout occurs"))},body:null,bodyUsed:!1,blob:function(){return Promise.reject(new Error("timeout occurs"))},formData:function(){return Promise.reject(new Error("timeout occurs"))},json:function(){return Promise.reject(new Error("timeout occurs"))},text:;throw r}))}return fetch(e,r)}function qn(e){var t,n,r=Nn(null===(t=document.cookie)||void 0===t?void 0:t.split(";"));try{for(r.s();!(n=r.n()).done;){var i=n.value;if((null==i?void 0:i.substring(0,i.indexOf("=")).trim())===e){if(i.indexOf("=")+1>i.length)return;return i.substring(i.indexOf("=")+1)}}}catch(e){r.e(e)}finally{r.f()}}function Wn(e){return Wn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wn(e)}function Gn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==Wn(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Wn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r.key,"string"),"symbol"===Wn(i)?i:String(i)),r)}var i}var Qn=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"_loadOptionsFromCookie",value:function(){var e=qn("EGMAPS_DEBUG_OPTIONS");this._debugOptions=new Set(null==e?void 0:e.split(","))}},{key:"_getOptionEnabled",value:function(e){var t;return this._debugOptions||this._loadOptionsFromCookie(),!(null===(t=this._debugOptions)||void 0===t||!t.has(e))}},{key:"getDebugLoggingEnabled",value:function(){return this._getOptionEnabled("logging")}},{key:"getDebugTilesIdEnabled",value:function(){return this._getOptionEnabled("tilesId")}},{key:"getDebugMarkersPositionEnabled",value:function(){return this._getOptionEnabled("markersPosition")}},{key:"getDebugConfigEnabled",value:])&&Gn(t.prototype,n),r&&Gn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}());function $n(e){return $n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$n(e)}function Xn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||Jn(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yn(e){return function(e){if(Array.isArray(e))return er(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Jn(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jn(e,t){if(e){if("string"==typeof e)return er(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?er(e,t):void 0}}function er(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function tr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==$n(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==$n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r.key,"string"),"symbol"===$n(i)?i:String(i)),r)}var i}var nr=function(){function e(t,n,r){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.defaultConfig=t,this.config=n,this.overwriteConfig={},this.configurations=[n,t].filter(Boolean),this.externalConfig=void 0,this.cache=new Map,this.configLoaderLogger=this.logger("config-loader"),this.externalConfigLoaded=r?new Promise((function(e){i.externalConfig=r,i.configurations=[r].concat(Yn(i.configurations)),e(void 0)})):this._loadExternalConfig(null==n?void 0:n.externalConfigEndpoint,5e3).then((function(e){i.configLoaderLogger.debug("Loaded external config from ".concat(null==n?void 0:n.externalConfigEndpoint)),e&&(i.externalConfig=e,i.configurations=[e].concat(Yn(i.configurations)))}))}var t,n,r;return t=e,n=[{key:"ready",value:function(){var e=this;return this.externalConfigLoaded.then(()}},{key:"getConfigurations",value:,{key:"_loadExternalConfig",value:function(e,t){var n=this;return e?(arguments.length>2&&void 0!==arguments[2]?arguments[2]:Zn)(e,t).then((function(e){return e.ok?e.json().then(():(e.text().then((),null)})).catch((function(t){return n.configLoaderLogger.error("failed to load external config from ".concat(e),t),null})):Promise.resolve(null)}},{key:"logger",value:function(e){return Dn(e,this.readParam("logging,logger"),Qn.getDebugLoggingEnabled())}},{key:"clearCache",value:,{key:"writeParam",value:function(e,t){this._writeParamAux(e.split(","),t,this.overwriteConfig),this.cache.set(e,t)}},{key:"removeParam",value:,{key:"_writeParamAux",value:function(e,t,n){var r=Xn(e,1)[0];if(yn(r))if(1===e.length)n[r]=t;else{n[r]||(n[r]={});var i=n[r];e.shift(),this._writeParamAux(e,t,i)}}},{key:"readParam",value:function(e){if(this.cache.has(e)){var t=this.cache.get(e);return null===t?void 0:t}var n=e.split(","),r=this._readParamAux(n,this.overwriteConfig,this.configurations);return this.cache.set(e,r),r}},{key:"_readParamAux",value:function(e,t,n){var r=Xn(e,1)[0],i=t?t[r]:void 0;if(null!==i){for(var o=n.map(().filter((function(e){return void 0!==e})),a=0;a<o.length;a++)if(null===o[a]){o=o.splice(0,a);break}return 1===e.length?Bt(i||(o.length>0?o[0]:void 0)):(e.shift(),this._readParamAux(e,i,o))}}},{key:"listStringKeys",value:function(e){var t=this,n=[],r=[];return[this.overwriteConfig].concat(Yn(this.configurations)).forEach((function(i){return t._listKeysAux(n,r,(null==e?void 0:e.split(","))||[],[],i)})),n}},{key:"listKeys",value:function(e){return Yn(this.listStringKeys(e).map((function(e){return e.split(",")})))}},{key:"listKeysShallow",value:function(e){return this.listStringKeys(e).map((function(t){return t.split(",").slice(0,e.split(",").length+1).join(",")})).filter(().map(()}},{key:"subConfig",value:function(e){var t=this,n={};return(e?[e]:Object.keys(this.defaultConfig)).map((function(e){var r={};return t.listStringKeys(e).map((function(n){var i=t.readParam(n);void 0!==i&&t._writeParamAux(n.substring(e.length+1).split(","),i,r)})),n[e]=r,r})),e?n[e]:n}},{key:"_listKeysAux",value:function(e,t,n,r,i){var o=[],a=i;if(n.length>0){var s=Xn(n,1)[0];a=i[s],o.push.apply(o,Yn(r).concat([s]))}void 0!==a&&(n.length<=1?this._listKeysAuxDeep(e,t,o,a):(n.shift(),this._listKeysAux(e,t,n,o,a)))}},{key:"_listKeysAuxDeep",value:function(e,t,n,r){if(At(r)&&!Y(r))for(var i in r){var o=[];o.push.apply(o,Yn(n).concat([i])),t.includes(o.join(","))||this._listKeysAuxDeep(e,t,o,r[i])}else n&&(t.includes(n.join(","))||(null===r?t.push(n.join(",")):this._checkIfParentPathAlreadyPresent(e,n)||e.push(n.join(","))))}},{key:"_checkIfParentPathAlreadyPresent",value:function(e,t){var n=[];t.forEach((function(t){if(n.push(t),e.includes(n.join(",")))return!0}));var r=t.join(",")+",";return e.some((function(e){return e===t.join(",")||e.startsWith(r)}))}},{key:"_fillObjectWithLeafName",value:function(e,t){var n=this;this.listKeysShallow(e).map((function(e){var r=e[e.length-1];t(r,n.readParam(e.join(",")))}))}},{key:"propertyValues",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return e},o={};return n.map((function(n){o[n]={};var a=[e,n,t].filter(().join(",");r._fillObjectWithLeafName(a,(function(e,t){var r=e.split("#").sort().join("#");yn(n)&&yn(r)&&(o[n][r]=i(t))}))})),o}}],n&&tr(t.prototype,n),r&&tr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function rr(e){var t=["animate__animated","animate__bounce"];e.addEventListener("animationend",(function n(r){at(e,t),e.removeEventListener("animationend",n)})),it(e,t)}function ir(e){return ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ir(e)}function or(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==ir(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==ir(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r.key,"string"),"symbol"===ir(i)?i:String(i)),r)}var i}var ar=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var i=r.readParam,o=r.writeParam;this.locale=n,this.messages=t||{},this.readParam=i,this.writeParam=o,this.variants=[],this.locale&&(this.variants.push(this.locale),n.length>2&&this.variants.push(this.locale.slice(0,2))),this.variants.push("default"),this._registerMessages(),this.hookForFormat=this.readParam("i18n,formatFunction")}var t,n,r;return t=e,n=[{key:"_registerMessages",value:function(){var e=this,t=this;this.variants.forEach((function(n){var r=e.messages[n];if(r)for(var i in r){var o="i18n,messages,".concat(i);void 0===t.readParam(o)&&t.writeParam(o,r[i])}}))}},{key:"format",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return(t=this._externalFormat.apply(this,[e].concat(r)))||(t=this._internalFormat.apply(this,[e].concat(r))),t}},{key:"_externalFormat",value:function(e){if(this.hookForFormat){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this.hookForFormat(e,n)}}},{key:"_internalFormat",value:function(e){var t=this.readParam("i18n,messages,".concat(e));if(t){for(var n=t,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];if(i)for(var a=0;a<i.length;a++){var s=i[a];n=n.replace("{".concat(a,"}"),void 0!==s?s:"")}return n}return"".concat(e," ").concat(this.locale?this.locale:"default"," NOT FOUND")}}],n&&or(t.prototype,n),r&&or(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();ion dr(e){return function(e){if(Array.isArray(e))return hr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return hr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?hr(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function pr(e){return pr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pr(e)}unction vr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==pr(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==pr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r.key,"string"),"symbol"===pr(i)?i:String(i)),r)}var i}ar mr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:yr(this,e),this.isLeaf=t,this.hasExpired=n,this.cache=Object.create(null),this.listeners=new Set}return gr(e,[{key:"get",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=this.cache[n[0]],o=1;o<n.length&&i;o++)i=i[n[o]];return i&&this.hasExpired(i,n)?(this.listeners.forEach((),void this.set.apply(this,[void 0].concat(n))):i}},{key:"keys",value:function(){for(var e=this.cache,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0;i<(null==n?void 0:n.length)&&e;i++)e=e[n[i]];return e?this._keysAux(n,e):[]}},{key:"_keysAux",value:function(e,t){var n=this;return this.isLeaf(t,e)?this.hasExpired(t,e)?[]:[e]:Object.keys(t).flatMap((function(r){return n._keysAux([].concat(dr(e),[r]),t[r])}))}},{key:"set",value:function(e){for(var t=[],n=this.cache,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];for(var a=0;a<i.length-1;a++){if(!n[i[a]]){if(!e)return;n[i[a]]={}}t.push(n),n=n[i[a]]}if(e)n[i[i.length-1]]=e;else{delete n[i[i.length-1]];for(var s=t.length-1;s>=0&&0===Object.keys(t[s][i[s]]).length;s--)delete t[s][i[s]]}}},{key:"addListener",value:function(e){this.listeners.add(e)}},{key:"removeListener",value:]),e}();mr.EVENTS={EXPIRE:"expire"};var br=function(e){ur(n,e);var t=cr(n);function n(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:return yr(this,n),t.call(this,r,(function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return i(t.time+e<Date.now(),t.content,r)}))}return gr(n,[{key:"set",value:function(e){for(var t,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(t=sr(fr(n.prototype),"set",this)).call.apply(t,[this,{leaf:!0,time:Date.now(),content:e}].concat(i))}},{key:"get",value:function(){for(var e,t,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return null===(e=(t=sr(fr(n.prototype),"get",this)).call.apply(t,[this].concat(i)))||void 0===e?void 0:e.content}},{key:"keys",value:function(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return(e=sr(fr(n.prototype),"keys",this)).call.apply(e,[this].concat(r))}}]),n}(mr),kr=function(e){ur(n,e);var t=cr(n);eturn gr(n,[{key:"set",value:function(){}},{key:"get",value:function(){}}]),n}(mr);function wr(e,t,n){return!e||e<=0?new kr:new br(e,t,n)}ction xr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Mr=6378137;function _r(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},a=o.zoomMax,s=void 0===a?21:a,u=o.padding,l=void 0===u?0:u,c=o.worldDimensions,f=void 0===c?{height:256,width:256}:c,d=o.parsedClientPadding,h=(Sr(r)-Sr(t))/Math.PI,p=i-n,y=(p<0?p+360:p)/360,v=e.offsetWidth,g=e.offsetHeight,m=d||{},b=m.paddingTop,k=void 0===b?0:b,w=m.paddingRight,P=void 0===w?0:w,C=m.paddingBottom,L=void 0===C?0:C,x=m.paddingLeft,M=void 0===x?0:x,_=Er(g-2*l-k-L,f.height,h),F=Er(v-2*l-P-M,f.width,y);return isFinite(_)?isFinite(F)?Math.min(_,F,s):_:F}function Fr(e,t,n,r,i){var o=Math.sin(e*Math.PI/180);o=Math.min(Math.max(o,-.9999),.9999);var a=1<<n;return[Math.floor(r*(.5+t/360)*a/r),Math.floor(i*(.5-Math.log((1+o)/(1-o))/(4*Math.PI))*a/i)]}function Or(e,t,n,r,i,o,a){for(var s=Cr(Fr(n,t,i,o,a),2),u=s[0],l=s[1],c=Cr(Fr(e,r,i,o,a),2),f=c[0],d=c[1],h=[],p=0;p<=f-u;p++)for(var y=0;y<=d-l;y++)h.push({x:u+p,y:l+y});return h}unction Er(e,t,n){return Math.floor(Math.log(e/t/n)/Math.LN2*1e3)/1e3}function Ir(e){var t=Cr(e,1)[0],n=Cr(e,1)[0];return e.forEach((function(e){t>e?t=e:n<e&&(n=e)})),e.length>1&&n-t>t+360-n}function Ar(e){return Ir(e.map((function(e){var t;return null!==(t=e.lng)&&void 0!==t?t:e[1]})))}function Tr(e,t){var n,r;return(null!==(n=t.lng)&&void 0!==n?n:t[1])<(null!==(r=e.lng)&&void 0!==r?r:e[1])}function Dr(e,t,n){var r=Ir(t)&&n,i=r?jr(e):e,o=r?t.map(jr):t,a=i;return o.forEach((function(e){var t=Math.abs(i-a);Math.abs(i-e)>t&&(a=e)})),Ut(a,void 0,n)}function Br(e,t){var n,r,i,o,a=Ar([e,t]),s=null!==(n=e.lat)&&void 0!==n?n:e[0],u=null!==(r=e.lng)&&void 0!==r?r:e[1],l=a?jr(u):u,c=null!==(i=t.lat)&&void 0!==i?i:t[0],f=null!==(o=t.lng)&&void 0!==o?o:t[1],d=a?jr(f):f;return c>s?d<l?"nw":"ne":d>l?"se":"sw"}function jr(e){return e<0?e+360:e}function Rr(e,t,n,r,i,o){var a;if(n===o)a=Math.pow(r-e,2)+Math.pow(i-t,2);else if(n>o){var s=1<<n-o;a=Math.pow(r-e/s,2)+Math.pow(i-t/s,2)}else{var u=1<<o-n;a=Math.pow(r/u-e,2)+Math.pow(i/u-t,2)}return Math.sqrt(a)}function Nr(e,t){var n=e+t/Mr*(180/Math.PI);return n<-180?n+360:n>180?n-360:n}function Vr(e){var t=null==e?void 0:e.type;if(["Polygon","MultiPolygon"].includes(t)){var n=[];"Polygon"===t?n.push(e.coordinates):n.push.apply(n,Pr(e.coordinates));var r=[];return n.forEach((function(e){var t=[];e.forEach((function(e){var n=[];e.forEach((),t.push(n)})),r.push(t)})),r}throw new Error("Geometry ".concat(t," not supported"))}r Kr={imageLoaded:{type:"load",dom:!0},imageLoadingError:{type:"error",dom:!0}};function Hr(e){var t=new RegExp(/(.*?)[\w,\s-]+\.(gif|jpe?g|tiff?|png|webp|bmp|svg)$/),n=new Set;return e.forEach((function(e){Y(e)?le(e,(,!0).forEach((function(e){var r=e.element.src;r&&t.test(r)&&n.add(r)})):t.test(e)&&n.add(e)})),Ur(n)}function Zr(e,t,n){var r=[];return e.forEach((function(e){var i=new Image;i.src=e,r.push(Gr(i,t,n))})),Hn(r).then(()}function qr(e){var t=new Set;return Object.keys(e).forEach((function(n){var r=e[n];Object.keys(r).forEach((function(e){var n=r[e];Object.keys(n).forEach((function(e){var r=n[e];r&&"none"!==r&&t.add(r)}))}))})),Ur(t)}function Wr(e){var t=new Set;return Object.keys(e).forEach((function(n){var r=e[n];Object.keys(r).forEach((function(e){var n=r[e];n&&"none"!==n&&t.add(n)}))})),Ur(t)}function Gr(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return new Promise((function(i,o){t(e,Kr.imageLoaded,i),t(e,Kr.imageLoadingError,(function(t){r?(n.debug("failed to load image ".concat(e.src),null==t?void 0:t.stack),i()):o(new Error("failed to load image ".concat(e.src,". ").concat(t)))}))}))}function Qr(e,t,n){return Y(t)&&(!Y(e)||J(t)!==J(e))||!Y(t)&&(Y(e)||n&&t!==e)}function $r(e){return $r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$r(e)}ar Yr=function(){ar t,n,r;return t=e,(n=[{key:"_buildClusterService",value:function(e,t,n,r){var i=t.type;if(i)switch(i){case"supercluster":return new Mn(e,t,n,r);case"none":return;default:throw new Error("Unknown cluster type ".concat(i))}}},{key:"createClusterers",value:function(e,t,n){var r=this,i={};return Object.keys(n).forEach((function(o){i[o]=[];var a=t[o],s=n[o];un(Object.keys(a)).forEach((function(t){var n=a[t],u=r._buildClusterService(e,n,s,t);u&&i[o].push({qualifier:t,labelKey:a[t].labelKey,clusterer:u})}))})),i}}])&&Xr(t.prototype,n),r&&Xr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Jr=n(597),ei=n.n(Jr);nction ri(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ii(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==ti(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==ti(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r.key,"string"),"symbol"===ti(i)?i:String(i)),r)}var i}var oi={boundsChanged:"boundsChanged",markersChanged:"markersChanged",selectionChanged:"selectionChanged",filterChanged:"filterChanged",hoverChanged:"hoverChanged",featureContentLoaded:"featureContentLoaded",idle:"idle",routeChanged:"routeChanged",tilesLoaded:"tilesLoaded",tilesContentLoaded:"tilesContentLoaded",mapTypeChanged:"mapTypeChanged"},ai=function(){ar t,n,r;return t=e,(n=[{key:"pushEvent",value:function(e,t){this.logger.debug("pushing event: ".concat(e));var n,r=ni(this.registeredListeners);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.eventType===e&&i.callback(t)}}catch(e){r.e(e)}finally{r.f()}}},{key:"_registerInternalListener",value:function(e,t,n){var r,i;if(t&&(n?(null!==(i=r=this._findInternalListener(e,void 0,n))&&void 0!==i&&i.id&&this._unregisterInternalListener(e,void 0,n),r=void 0):r=this._findInternalListener(e,t,void 0),!r)){var o={id:n,eventType:e,callback:t};return this.registeredListeners.push(o),o}}},{key:"_identifyListener",value:function(e,t,n,r){return!(e.eventType!==t||r&&e.id!==r||n&&e.callback!==n)}},{key:"_findInternalListener",value:function(e,t,n){var r=this;if(!n&&!t)throw new Error("Can't find a listener with no id and no callback provided");return this.registeredListeners.find(()}},{key:"_unregisterInternalListener",value:function(e,t,n){var r=this,i=this._findInternalListener(e,t,n);return i&&(this.registeredListeners=this.registeredListeners.filter((function(i){return!r._identifyListener(i,e,t,n)}))),i}},{key:"addBoundChangeListener",value:function(e,t){return!!this._registerInternalListener(oi.boundsChanged,e,t)}},{key:"removeBoundChangeListener",value:function(e){return!!this._unregisterInternalListener(oi.boundsChanged,e)}},{key:"deregisterBoundChangeListener",value:function(e){return!!this._unregisterInternalListener(oi.boundsChanged,void 0,e)}},{key:"addMarkerChangeListener",value:function(e,t){return!!this._registerInternalListener(oi.markersChanged,e,t)}},{key:"removeMarkerChangeListener",value:function(e){return!!this._unregisterInternalListener(oi.markersChanged,e)}},{key:"deregisterMarkerChangeListener",value:function(e){return!!this._unregisterInternalListener(oi.markersChanged,void 0,e)}},{key:"addSelectionChangeListener",value:function(e,t){return!!this._registerInternalListener(oi.selectionChanged,e,t)}},{key:"removeSelectionChangeListener",value:function(e,t){return!!this._unregisterInternalListener(oi.selectionChanged,e,t)}},{key:"deregisterSelectionChangeListener",value:function(e){return!!this._unregisterInternalListener(oi.selectionChanged,void 0,e)}},{key:"addFilterChangeListener",value:function(e,t){return!!this._registerInternalListener(oi.filterChanged,e,t)}},{key:"removeFilterChangeListener",value:function(e){return!!this._unregisterInternalListener(oi.filterChanged,e)}},{key:"deregisterFilterChangeListener",value:function(e){return!!this._unregisterInternalListener(oi.filterChanged,void 0,e)}},{key:"addHoverChangeListener",value:function(e,t){return!!this._registerInternalListener(oi.hoverChanged,e,t)}},{key:"removeHoverChangeListener",value:function(e){return!!this._unregisterInternalListener(oi.hoverChanged,e)}},{key:"deregisterHoverChangeListener",value:function(e){return!!this._unregisterInternalListener(oi.hoverChanged,void 0,e)}},{key:"addFeatureContentLoadedListener",value:function(e,t){return!!this._registerInternalListener(oi.featureContentLoaded,e,t)}},{key:"removeFeatureContentLoadedListener",value:function(e){return!!this._unregisterInternalListener(oi.featureContentLoaded,e)}},{key:"deregisterFeatureContentLoadedListener",value:function(e){return!!this._unregisterInternalListener(oi.featureContentLoaded,void 0,e)}},{key:"addIdleListener",value:function(e,t){return!!this._registerInternalListener(oi.idle,e,t)}},{key:"removeIdleListener",value:function(e){return!!this._unregisterInternalListener(oi.idle,e)}},{key:"deregisterIdleListener",value:function(e){return!!this._unregisterInternalListener(oi.idle,void 0,e)}},{key:"addRouteChangeListener",value:function(e,t){return!!this._registerInternalListener(oi.routeChanged,e,t)}},{key:"removeRouteChangeListener",value:function(e){return!!this._unregisterInternalListener(oi.routeChanged,e)}},{key:"deregisterRouteChangeListener",value:function(e){return!!this._unregisterInternalListener(oi.routeChanged,void 0,e)}},{key:"addTilesLoadedListener",value:function(e,t){return!!this._registerInternalListener(oi.tilesLoaded,e,t)}},{key:"removeTilesLoadedListener",value:function(e){return!!this._unregisterInternalListener(oi.tilesLoaded,e)}},{key:"deregisterTilesLoadedListener",value:function(e){return!!this._unregisterInternalListener(oi.tilesLoaded,void 0,e)}},{key:"addTilesContentLoadedListener",value:function(e,t){return!!this._registerInternalListener(oi.tilesContentLoaded,e,t)}},{key:"removeTilesContentLoadedListener",value:function(e){return!!this._unregisterInternalListener(oi.tilesContentLoaded,e)}},{key:"deregisterTilesContentLoadedListener",value:function(e){return!!this._unregisterInternalListener(oi.tilesContentLoaded,void 0,e)}},{key:"addMapTypeChangedListener",value:function(e,t){return!!this._registerInternalListener(oi.mapTypeChanged,e,t)}},{key:"deregisterMapTypeChangedListener",value:function(e){return!!this._unregisterInternalListener(oi.mapTypeChanged,void 0,e)}}])&&ii(t.prototype,n),r&&ii(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function si(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||li(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ui(e){return function(e){if(Array.isArray(e))return ci(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||li(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function li(e,t){if(e){if("string"==typeof e)return ci(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ci(e,t):void 0}}function ci(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function fi(e){return fi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fi(e)}function di(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==fi(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==fi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r.key,"string"),"symbol"===fi(i)?i:String(i)),r)}var i}function pi(e,t,n){return t&&hi(e.prototype,t),n&&hi(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var yi=function(){function e(t,n,r){di(this,e),this.id=Jt(),this.origin=t,this.destination=n,this.mode=r,this.distance=void 0}return pi(e,[{key:"toString",value:function(){var e;return"Route: {origin:'".concat(this.origin.id,"',destination:").concat(null===(e=this.destination)||void 0===e?void 0:e.id,",mode:").concat(this.mode,"}")}},{key:"originLatLng",value:,{key:"destinationLatLng",value:function(){return this.destination?{lat:this.destination.latLng[0],lng:this.destination.latLng[1]}:void 0}}]),e}(),vi=function(){function e(t,n,r){var i=t.logger,o=t.egDistances,a=t.routeLineStyleByDistanceMode,s=t.routeCacheInMs,u=t.findFeature,l=t.eventsManager,c=t.addRouteOnMap,f=t.removeRouteOnMap,d=t.asKey;di(this,e),this.routes=n,this.routeDestinations=r,this.logger=i,this.egDistances=o,this.routeLineStyleByDistanceMode=a,this.findFeature=u,this.eventsManager=l,this.addRouteOnMap=c,this.removeRouteOnMap=f,this.asKey=d,this.routeCache=wr(s,void 0,(function(e,t,n){return"polyline"!==n[0]&&e}))}return pi(e,[{key:"_asRoute",value:function(e,t){var n,r,i={origin:(null===(n=this.findFeature(e.origin.id,e.origin.type))||void 0===n?void 0:n.toData())||{id:e.origin.id,type:e.origin.type},destination:e.destination?(null===(r=this.findFeature(e.destination.id,e.destination.type))||void 0===r?void 0:r.toData())||{id:e.destination.id,type:e.destination.type}:void 0,transportMode:e.mode};return t&&(i.distance=e.distance),i}},{key:"_asRouteDestinationFeature",value:function(e){var t=e.idAndType,n=t.id,r=t.type;return{destination:n&&r?this.findFeature(n,r):void 0,transportMode:e.transportMode}}},{key:"_asRouteDestination",value:,{key:"_routeDestinationAsKey",value:function(e){var t=e.idAndType,n=t.id,r=t.type,i=e.transportMode;return"".concat(n,"|").concat(r,"|").concat(i)}},{key:"_buildCacheKeys",value:function(e,t,n,r){var i=[];return i.push(e),t&&i.push("".concat(t.id,"|").concat(t.type)),n&&i.push("".concat(n.id,"|").concat(n.type)),r&&i.push(r),i}},{key:"_sameRoute",value:function(e,t){var n,r,i,o;return e.origin.id===t.origin.id&&e.origin.type===t.origin.type&&(null===(n=e.destination)||void 0===n?void 0:n.id)===(null===(r=t.destination)||void 0===r?void 0:r.id)&&(null===(i=e.destination)||void 0===i?void 0:i.type)===(null===(o=t.destination)||void 0===o?void 0:o.type)&&e.mode===t.mode}},{key:"_sameFeature",value:,{key:"_sameRouteDestination",value:function(e,t){return e.idAndType.id===t.idAndType.id&&e.idAndType.type===t.idAndType.type&&e.transportMode===t.transportMode}},{key:"showRoutes",value:function(e,t){var n=this,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this._asRouteDestinationFeature.bind(this);return Hn((t&&t.length>0?t.map(i):[].concat(ui(this.listRegisteredRoutes(e).map(()),ui(this.routeDestinations))).map(().filter((function(e){return!n.routes.some((function(t){return n._sameRoute(t,e)}))&&!n._sameFeature(e.origin,e.destination)})).map((function(t){return new Promise((function(r,i){var o,a,s=t.destination,u=t.mode,l="none"===n.routeLineStyleByDistanceMode[t.mode].lineStyle,c=l?void 0:(o=n.routeCache).get.apply(o,ui(n._buildCacheKeys("polyline",e,s,u)));if(c)a=Promise.resolve(c);else{var f,d=n._buildCacheKeys(l?"distance":"route",e,s,u),h=(f=n.routeCache).get.apply(f,ui(d));if(h)a=Promise.resolve(h);else{if(!n.egDistances)return Promise.reject("EGDistances is not enabled: routes or distances can't be computed on demand");a=l?n.fetchDistance(t,d):n.fetchRoute(t,d)}}a.then((function(e){var t=e.route,i=e.egDistanceRoute,o=e.routeResult;t&&(n.routes.push(t),i?n.addRouteOnMap(t,i).then((function(e){return r(t)})):o?n.addRouteOnMap(t,o).then((function(e){return r(t)})):r(t))})).catch(()}))}))).then((function(e){var t=e.filter((function(e){return"fulfilled"===e.status})).map((function(e){return e.value})).filter((function(e){return void 0!==e}));e.filter((function(e){return"rejected"===e.status})).forEach(n._handleReject.bind(n));var i=t.map((function(e){return n._asRoute(e,!0)}));return r&&i.length>0&&n._handleRouteChanged(!0,i),i}))}},{key:"fetchDistance",value:function(e,t){var n=this;return this.egDistances.getDistances(e.originLatLng(),e.destinationLatLng(),e.mode).then((function(r){if("SUCCESS"===r.status){var i;e.distance=r.matrix[0][0].modes[e.mode];var o={route:e};return(i=n.routeCache).set.apply(i,[o].concat(ui(t))),o}throw new Error(r.errors.join(", "))}))}},{key:"handleFlight",value:function(e){var t=e.originLatLng(),n=e.destinationLatLng(),r=e;return r.copyrights="",r.warnings="",r.status="SUCCESS",r.route={path:[t,n],mode:r.mode},Promise.resolve(r)}},{key:"fetchRoute",value:function(e,t){var n=this;return("flying"==e.mode?this.handleFlight(e):this.egDistances.getRoute(e.originLatLng(),e.destinationLatLng(),e.mode)).then((function(r){if("SUCCESS"===r.status){var i;e.distance=r.route.distance;var o={route:e,egDistanceRoute:r};return(i=n.routeCache).set.apply(i,[o].concat(ui(t))),o}throw new Error(r.error)}))}},{key:"registerRoute",value:function(e,t,n){var r=t.idAndType,i=t.transportMode,o=this._buildCacheKeys("polyline",e,r,i);if(!this._sameFeature(e,r)){var a=this.findFeature(e.id,e.type),s=this.findFeature(r.id,r.type);if(a&&s){var u,l=new yi(a,s,i),c={route:{path:ei().decode(n).map(()}};return(u=this.routeCache).set.apply(u,[{route:l,routeResult:c}].concat(ui(o))),!0}}return!1}},{key:"updateRoutesOnViewport",value:function(){var e=this,t=ui(this.routes);return this.hideRoutes().then((function(){return Promise.all(t.map((function(t){return e.showRoutes(t.origin,[e._asRouteDestination(t)],!1)})))})).then((function(){}))}},{key:"listRegisteredRoutes",value:function(e){var t,n=this,r=this._buildCacheKeys("polyline",e);return(t=this.routeCache).keys.apply(t,ui(r)).flatMap((function(e){var t,r=(t=n.routeCache).get.apply(t,ui(e));if(r){var i=r.route,o=r.routeResult;return[{origin:{id:i.origin.id,type:i.origin.type},destination:{idAndType:{id:i.destination.id,type:i.destination.type},transportMode:i.mode},polyline:ei().encode(o.route.path)}]}return[]}))}},{key:"deregisterRoute",value:function(e,t){var n=this,r=this.listRegisteredRoutes(e).filter((function(e){var r=e.destination;return!t||n._sameRouteDestination(r,t)})).map((function(e){var t,r=e.origin,i=e.destination,o=n._buildCacheKeys("polyline",r,i.idAndType,i.transportMode);return(t=n.routeCache).set.apply(t,[void 0].concat(ui(o))),e}));if(r){var i=this.findFeature(e.id,e.type);this.hideRoutes(i,r.map((function(e){return e.destination})))}return r}},{key:"_handleReject",value:function(e){var t=e.reason,n=t.message,r=t.stack,i=t.error,o=t.route;i?/OVER_QUERY_LIMIT/.test(null==i?void 0:i.message)?this.logger.info("Error when showing route ".concat(o,": ").concat(i.message),i.stack):this.logger.warn("Error when showing route ".concat(o,": ").concat(i.message),i.stack):n&&this.logger.error("Error when showing route ".concat(n),r)}},{key:"hideRoutes",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this._asRoute.bind(this),o=this.asKey,a=n.length>0?n.map((function(e){return"".concat(t.asKey(e.idAndType),"-").concat(e.transportMode)})):void 0;return Promise.all(this.routes.filter((function(t){return(!e||t.origin.id===e.id&&t.origin.type===e.type)&&(!a||a.includes("".concat(o(t.destination),"-").concat(t.mode)))})).map((function(e){return t.removeRouteOnMap(e).then((function(){return t.routes.splice(t.routes.findIndex((function(t){return e===t})),1),e}))}))).then((function(e){return r&&e.length>0&&t._handleRouteChanged(!1,e),e.map((function(e){return i(e)}))}))}},{key:"listRoutesDisplayed",value:function(){var e=this;return this.routes.map(()}},{key:"_handleRouteChanged",value:function(e,t){var n={routes:t,action:e?"show":"hide"};this.eventsManager.pushEvent(oi.routeChanged,n)}},{key:"registerRouteDestination",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach((function(t){var n;if(null===(n=e.listRegisteredRouteDestinations())||void 0===n||!n.map(e._routeDestinationAsKey).includes(e._routeDestinationAsKey(t))){var r=t.idAndType,i=r.id,o=r.type,a=t.transportMode,s=e.findFeature(i,o);s&&e.routeDestinations.push({destination:s,transportMode:a})}}))}},{key:"listRegisteredRouteDestinations",value:function(){return this.routeDestinations.flatMap((function(e){var t=e.destination,n=e.transportMode;return t?[{idAndType:{id:t.id,type:t.type},transportMode:n}]:[]}))}},{key:"deregisterRouteDestination",value:function(){for(var e=this,t=[],n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return r.forEach((function(n){var r=n.idAndType,i=r.id,o=r.type,a=n.transportMode,s=e.routeDestinations.findIndex((function(e){return e.destination&&e.destination.id===i&&e.destination.type===o&&e.transportMode===a}));s>=0&&(e.routeDestinations.splice(s,1),t.push(n))})),this.hideRoutes(void 0,t),t}}]),e}();function gi(e){return gi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gi(e)}function mi(e){return function(e){if(Array.isArray(e))return bi(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return bi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bi(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ki(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==gi(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==gi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r.key,"string"),"symbol"===gi(i)?i:String(i)),r)}var i}var wi=Ft,Pi=Rt,Ci=function(){function e(t){var n=t.logger,r=t.findFeature,i=t.addPolygonsOnMap,o=t.removePolygonsOnMap,a=t.asKey,s=t.polygons,u=t.polygonStyles;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.logger=n,this.findFeature=r,this.addPolygonsOnMap=i,this.removePolygonsOnMap=o,this.asKey=a,this.polygons=s,this.polygonStyles=u,this.polygons.length>0&&this.showPolygons.apply(this,mi(this.polygons))}var t,n,r;return t=e,n=[{key:"_isPolygonDisplayed",value:function(e){var t=this;return this.polygons.some(()}},{key:"_isPolygonNotDisplayed",value:,{key:"showPolygons",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=Pi(n.filter(this._isPolygonNotDisplayed.bind(this))),o=this._findPolygonToDisplay(i);return this.addPolygonsOnMap(o).then((function(t){var n;return(n=e.polygons).push.apply(n,mi(t)),t}))}},{key:"hidePolygons",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n.length>0?n.filter(this._isPolygonDisplayed.bind(this)):mi(this.polygons);return this.removePolygonsOnMap(i).then((function(t){return t.forEach((),t}))}},{key:"_findPolygonToDisplay",value:function(e){var t=this;return e.map((function(e){var n=e.id,r=e.type,i=t.findFeature(n,r);if(i&&i.polygon){var o=wi(t.polygonStyles[r],i.hashKeys);return{polygonDisplayed:{id:n,type:r,polygon:i.polygon},style:o}}})).filter((function(e){return void 0!==e}))}},{key:"listPolygonsDisplayed",value:function(){return this._findPolygonToDisplay(this.polygons).map((function(e){return e.polygonDisplayed}))}},{key:"updatePolygonsOnViewport",value:function(){var e=this,t=mi(this.polygons);return this.hidePolygons().then(().then((function(){}))}}],n&&ki(t.prototype,n),r&&ki(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Li(e,t){return!!t&&e.from===t.from&&e.to===t.to&&qt(e.roomOccupancies,t.roomOccupancies,!1,(function(e,t){return function(e,t){return(e.nbAdults||0)===(t.nbAdults||0)&&qt(e.childrenAges||[],t.childrenAges||[])}(e,t)}))}function xi(e){return xi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xi(e)}function Mi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==xi(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==xi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r.key,"string"),"symbol"===xi(i)?i:String(i)),r)}var i}var _i,Fi=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.availabilityProvider=n,this.logger=t("AvailabilityCheck"),this.availabilityProvider=void 0,this.featureComputationInProgress=new Map,this.stay=void 0}var t,n,r;return t=e,n=[{key:"saveStay",value:function(e){return!(!e||this.stay&&Li(e,this.stay)||(this.stay=e,this.featureComputationInProgress.clear(),0))}},{key:"isAvailabilityCheckActive",value:,{key:"updateAvailability",value:function(e){var t=this;if(!this.isAvailabilityCheckActive())return Promise.resolve([]);for(var n=this.stay,r=[],i=Date.now(),o=e.length,a=new Map,s=0;s<o;s++){var u=e[s],l=u.id;!this.featureComputationInProgress.has(l)&&u.hasTileData()&&"unknown"===u.toTileData().status&&(r.push(l),a.set(l,s),this.featureComputationInProgress.set(l,i))}if(0===r.length)return Promise.resolve([]);for(var c=[],f=jt(r,300),d=f.length,h=0;h<d;h++)c.push(this.availabilityProvider.checkAvailability(n,f[h]));return Hn(c).then((function(r){return r.filter((function(e){return"rejected"===e.status})).forEach((),r.filter(().map((function(r){return r.value.map((function(r){var i=a.get(r.id);if(i>=0&&t.stay===n){var o=e[i];return o.mergeTileData(r),o}})).filter((function(e){return void 0!==e}))})).flat()})).finally(()}}],n&&Mi(t.prototype,n),r&&Mi(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Oi={variant:"var",defaultClusterProductLabel:"prodClusterLbl",defaultClusterPropertyLabel:"propClusterLbl",defaultClusterPlaceLabel:"placeClusterLbl",keyboardFeaturesNoData:"keybFeatNoData",keyboardFeaturesPreviousPage:"keybFeatPrev",keyboardFeaturesNextPage:"keybFeatNext",filterBoxLegend:"fboxLegend",ariaFilterBoxToggleLegend:"ariaFboxTglLegend",ariaFilterBoxImgProductAvailable:"ariaFboxImgProdAvailable",ariaFilterBoxImgProductFiltered:"ariaFboxImgProdFiltered",ariaFilterBoxImgProductSoldOut:"ariaFboxImgProdSoldOut",ariaFilterBoxImgProductUnknown:"ariaFboxImgProdUnknown",ariaFilterBoxImgPropertyAvailable:"ariaFboxImgPropAvailable",ariaFilterBoxImgPropertyFiltered:"ariaFboxImgPropFiltered",ariaFilterBoxImgPropertySoldOut:"ariaFboxImgPropSoldOut",ariaFilterBoxImgPropertyUnknown:"ariaFboxImgPropUnknown",ariaFilterBoxCheckBoxProductAvailable:"ariaFboxCbProdAvailable",ariaFilterBoxCheckBoxProductFiltered:"ariaFboxCbProdFiltered",ariaFilterBoxCheckBoxProductSoldOut:"ariaFboxCbProdSoldOut",ariaFilterBoxCheckBoxProductUnknown:"ariaFboxCbProdUnknown",ariaFilterBoxCheckBoxPropertyAvailable:"ariaFboxCbPropAvailable",ariaFilterBoxCheckBoxPropertyFiltered:"ariaFboxCbPropFiltered",ariaFilterBoxCheckBoxPropertySoldOut:"ariaFboxCbPropSoldOut",ariaFilterBoxCheckBoxPropertyUnknown:"ariaFboxCbPropUnknown",filterBoxProductAvailable:"fboxProductAvailable",filterBoxProductFiltered:"fboxProductFiltered",filterBoxProductSoldOut:"fboxProductSoldOut",filterBoxProductUnknown:"fboxProductUnknown",filterBoxPropertyAvailable:"fboxPropertyAvailable",filterBoxPropertyFiltered:"fboxPropertyFiltered",filterBoxPropertySoldOut:"fboxPropertySoldOut",filterBoxPropertyUnknown:"fboxPropertyUnknown",filterBoxPlaceUnknown:"fboxPlaceUnknown",ariaFilterBoxImgPlaceUnknown:"ariaFboxImgPlaceUnknown",ariaFilterBoxCheckBoxPlaceUnknown:"ariaFboxCbPlaceUnknown"};function Si(e){return Si="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Si(e)}function Ei(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Si(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Si(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Si(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ii=(Ei(_i={},Oi.variant,"default"),Ei(_i,Oi.defaultClusterProductLabel,"{0} products"),Ei(_i,Oi.defaultClusterPropertyLabel,"{0} properties"),Ei(_i,Oi.defaultClusterPlaceLabel,"{0} places"),Ei(_i,Oi.keyboardFeaturesNoData,"no data"),Ei(_i,Oi.keyboardFeaturesPreviousPage,"Show previous..."),Ei(_i,Oi.keyboardFeaturesNextPage,"Show next..."),Ei(_i,Oi.filterBoxLegend,"Legend"),Ei(_i,Oi.ariaFilterBoxToggleLegend,"Toggle legend"),Ei(_i,Oi.ariaFilterBoxImgProductAvailable,"icon used for products matching dates and criteria"),Ei(_i,Oi.ariaFilterBoxImgProductFiltered,"icon used for products matching dates but not your criteria"),Ei(_i,Oi.ariaFilterBoxImgProductSoldOut,"icon used for products not available for these dates"),Ei(_i,Oi.ariaFilterBoxImgProductUnknown,"icon used for products with no availability information for these dates"),Ei(_i,Oi.ariaFilterBoxImgPropertyAvailable,"icon used for properties matching dates and criteria"),Ei(_i,Oi.ariaFilterBoxImgPropertyFiltered,"icon used for properties matching dates but not your criteria"),Ei(_i,Oi.ariaFilterBoxImgPropertySoldOut,"icon used for properties not available for these dates"),Ei(_i,Oi.ariaFilterBoxImgPropertyUnknown,"icon used for properties with no availability information for these dates"),Ei(_i,Oi.ariaFilterBoxCheckBoxProductAvailable,"filter products matching dates and criteria"),Ei(_i,Oi.ariaFilterBoxCheckBoxProductFiltered,"filter products matching dates but not your criteria"),Ei(_i,Oi.ariaFilterBoxCheckBoxProductSoldOut,"filter products sold out for these dates"),Ei(_i,Oi.ariaFilterBoxCheckBoxProductUnknown,"filter products with no availability information for these dates"),Ei(_i,Oi.ariaFilterBoxCheckBoxPropertyAvailable,"filter properties matching dates and criteria"),Ei(_i,Oi.ariaFilterBoxCheckBoxPropertyFiltered,"filter properties matching dates but not your criteria"),Ei(_i,Oi.ariaFilterBoxCheckBoxPropertySoldOut,"filter properties sold out for these dates"),Ei(_i,Oi.ariaFilterBoxCheckBoxPropertyUnknown,"filter properties with no availability information for these dates"),Ei(_i,Oi.filterBoxProductAvailable,"Matches dates and criteria"),Ei(_i,Oi.filterBoxProductFiltered,"Doesnt match your criteria"),Ei(_i,Oi.filterBoxProductSoldOut,"Sold out for these dates"),Ei(_i,Oi.filterBoxProductUnknown,"Availability unknown"),Ei(_i,Oi.filterBoxPropertyAvailable,"Matches dates and criteria"),Ei(_i,Oi.filterBoxPropertyFiltered,"Doesnt match your criteria"),Ei(_i,Oi.filterBoxPropertySoldOut,"Sold out for these dates"),Ei(_i,Oi.filterBoxPropertyUnknown,"Availability unknown"),Ei(_i,Oi.filterBoxPlaceUnknown,"Places"),Ei(_i,Oi.ariaFilterBoxImgPlaceUnknown,"icon used for places"),Ei(_i,Oi.ariaFilterBoxCheckBoxPlaceUnknown,"filter places"),_i);function Ai(e){return Ai="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ai(e)}var Ti,Di,Bi,ji=(Ti={},Bi="en-US",(Di=function(e){var t=function(e,t){if("object"!==Ai(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Ai(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Ai(t)?t:String(t)}(Di=Oi.variant))in Ti?Object.defineProperty(Ti,Di,{value:Bi,enumerable:!0,configurable:!0,writable:!0}):Ti[Di]=Bi,Ti);function Ri(e){return Ri="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ri(e)}var Ni,e}({},Oi.variant,"en");function Ui(e){return Ui="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ui(e)}function zi(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Ui(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Ui(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Ui(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ki={default:Ii,"en-US":ji,en:Vi,fr:(zi(Ni={},Oi.variant,"fr"),zi(Ni,Oi.defaultClusterProductLabel,"{0} tablissements"),zi(Ni,Oi.defaultClusterPropertyLabel,"{0} tablissements"),zi(Ni,Oi.defaultClusterPlaceLabel,"{0} points d'intrt"),zi(Ni,Oi.keyboardFeaturesNoData,"Pas de donnes"),zi(Ni,Oi.keyboardFeaturesPreviousPage,"Afficher les prcdents..."),zi(Ni,Oi.keyboardFeaturesNextPage,"Afficher les suivants..."),zi(Ni,Oi.filterBoxLegend,"Lgende"),zi(Ni,Oi.ariaFilterBoxToggleLegend,"Afficher la lgende"),zi(Ni,Oi.ariaFilterBoxImgProductAvailable,"icne pour les tablissements disponibles et vrifiant les critres"),zi(Ni,Oi.ariaFilterBoxImgProductFiltered,"icne pour les tablissements disponibles mais ne vrifiant pas les critres"),zi(Ni,Oi.ariaFilterBoxImgProductSoldOut,"icne pour les tablissements non disponibles pour les dates"),zi(Ni,Oi.ariaFilterBoxImgProductUnknown,"icne pour les tablissements sans information de disponibilit"),zi(Ni,Oi.ariaFilterBoxImgPropertyAvailable,"icne pour les tablissements disponibles et vrifiant les critres"),zi(Ni,Oi.ariaFilterBoxImgPropertyFiltered,"icne pour les tablissements disponibles mais ne vrifiant pas les critres"),zi(Ni,Oi.ariaFilterBoxImgPropertySoldOut,"icne pour les tablissements non disponibles pour les dates"),zi(Ni,Oi.ariaFilterBoxImgPropertyUnknown,"icne pour les tablissements sans information de disponibilit"),zi(Ni,Oi.ariaFilterBoxCheckBoxProductAvailable,"filtre pour les tablissements disponibles et vrifiant les critres"),zi(Ni,Oi.ariaFilterBoxCheckBoxProductFiltered,"filtre pour les tablissements disponibles mais ne vrifiant pas les critres"),zi(Ni,Oi.ariaFilterBoxCheckBoxProductSoldOut,"filtre pour les tablissements non disponibles pour les dates"),zi(Ni,Oi.ariaFilterBoxCheckBoxProductUnknown,"filtre pour les tablissements sans information de disponibilit"),zi(Ni,Oi.ariaFilterBoxCheckBoxPropertyAvailable,"filtre pour les tablissements disponibles et vrifiant les critres"),zi(Ni,Oi.ariaFilterBoxCheckBoxPropertyFiltered,"filtre pour les tablissements disponibles mais ne vrifiant pas les critres"),zi(Ni,Oi.ariaFilterBoxCheckBoxPropertySoldOut,"filtre pour les tablissements non disponibles pour les dates"),zi(Ni,Oi.ariaFilterBoxCheckBoxPropertyUnknown,"filtre pour les tablissements sans information de disponibilit"),zi(Ni,Oi.filterBoxProductAvailable,"Disponibles"),zi(Ni,Oi.filterBoxProductFiltered,"Disponibles mais filtrs"),zi(Ni,Oi.filterBoxProductSoldOut,"Indisponible"),zi(Ni,Oi.filterBoxProductUnknown,"Disponibilit inconnue"),zi(Ni,Oi.filterBoxPropertyAvailable,"Disponibles"),zi(Ni,Oi.filterBoxPropertyFiltered,"Disponibles mais filtrs"),zi(Ni,Oi.filterBoxPropertySoldOut,"Indisponible"),zi(Ni,Oi.filterBoxPropertyUnknown,"Disponibilit inconnue"),zi(Ni,Oi.filterBoxPlaceUnknown,"Points d'intrt"),zi(Ni,Oi.ariaFilterBoxImgPlaceUnknown,"icne pour les point d'intrts"),zi(Ni,Oi.ariaFilterBoxCheckBoxPlaceUnknown,"filtre pour les point d'intrts"),Ni)};function Hi(e){return Hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hi(e)}function Zi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return qi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qi(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Wi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Gi(r.key),r)}}function Gi(e){var t=function(e,t){if("object"!==Hi(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Hi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Hi(t)?t:String(t)}var Qi=["1","2","3","4","5","6","7","8","9"],$i={cluster:{available:9,filtered:7,sold_out:3,unknown:1},product:{available:10,filtered:8,sold_out:4,unknown:2},property:{available:10,filtered:8,sold_out:4,unknown:2},place:{unknown:5}},Xi="no-data",Yi="keyboard-features-enabled",Ji="keyboard-features-list",eo="keyboard-features-list-element",to="keyboard-features-list-element-info",no="keyboard-features-list-element-number",ro="keyboard-features-list-element-div",io="keyboard-features-list-nav",oo="keyboard-features-not-in-list-marker",ao="kbc-button",so=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keyboardFeaturesIcon=t,this.getI18N=n,this.keyboardNavigationMode=!1,this.keyPressZero=48,this.keyDownBackspace=8,this.pageIndex=0,this.pageCount=0,this.uiElementIds=[]}var t,n,r;return t=e,n=[{key:"init",value:function(e){var t=e.node,n=e.uniqId,r=e.containerBounds,i=e.listFeatures,o=e.cloneMarker,a=e.zIndexes,s=e.maxZIndex,u=e.getMapNavFocusElement,l=e.registerListenerOnMapFocusElement,c=e.handleMarkerClick,f=e.isFeatureSelected,d=e.clearSelectedFeature;this.node=t,this.containerBounds=r,this.listFeatures=i,this.cloneMarker=o,this.zIndexes=a,this.maxZIndex=s,this.getMapNavFocusElement=u,this.registerListenerOnMapFocusElement=l,this.handleMarkerClick=c,this.isFeatureSelected=f,this.clearSelectedFeature=d;var h=n("keyboard-features");this._createKeyboardFeaturesIcon(h),this._createKeyboardFeaturesSquare(h),this._createKeyboardFeaturesList(h),this._initializeListeners()}},{key:"removeAl e=this;this.uiElementIds.forEach((function(t){return he(e.node,t)}))}},{key:"_createKeyboardFeaturesIcon",value:function(e){var t="".concat(e,"-icon");this.keyboardIcon=ge(t,this.node,"keyboard-features-icon",void 0),this.uiElementIds.push(t),this.keyboardNavigationMode||Ve(this.keyboardIcon);var n=this.keyboardFeaturesIcon;De(Me("".concat(e,"-img"),this.keyboardIcon,"keyboard-features-icon-img",void 0,n,"icon to show that keyboard features is enabled")),He(this.keyboardIcon,this.maxZIndex+1)}},{key:"_createKeyboardFeaturesSquare",value:function(e){var t="".concat(e,"-focus");this.focusArea=ge(t,this.node,"".concat("keyboard-features-focus-area"),void 0),this.uiElementIds.push(t),this.keyboardNavigationMode||Ve(this.focusArea),He(this.focusArea,this.maxZIndex+1)}},{key:"_createKeyboardFeaturesList",value:function(e){var t="".concat(e,"-features");this.keybNavFeatures=ge(t,this.node,"keyboard-features-dialog",void 0),this.uiElementIds.push(t),this.keybNavFeaturesList=me("".concat(e,"-list"),this.keybNavFeatures,"".concat(Ji," ").concat(Xi),void 0),this.keybNavFeaturesElements=[];for(var n=0;n<7;n++){var r=be("".concat(e,"-elt-").concat(n+1),this.keybNavFeaturesList,"".concat(eo," ").concat(Xi),void 0);Pe("".concat(r.id,"-info"),r,to,void 0,"-"),this.keybNavFeaturesElements.push(r)}var i=this.getI18N(Oi.keyboardFeaturesNoData);this.keybNavNoFeatures=Pe("".concat(e,"-nodata"),this.keybNavFeatures,"".concat(Ji,"-no-feature-message"),void 0,i),this.keyboardNavigationMode||Ve(this.keybNavFeatures),He(this.keybNavFeatures,this.maxZIndex+1);var o="".concat(eo," ").concat(io," ").concat(io,"-previous ").concat(Xi),a=be("".concat(e,"-elt-prev"),this.keybNavFeaturesList,o,void 0),s=this.getI18N(Oi.keyboardFeaturesPreviousPage),u=ge("".concat(a.id,"-container"),a,ro,void 0);Pe("".concat(a.id,"-number"),u,"".concat(no," ").concat(ao),void 0,Qi[7]),Pe("".concat(a.id,"-info"),u,to,void 0,s),this.keybNavFeaturesElements.push(a);var l="".concat(eo," ").concat(io," ").concat(io,"-next ").concat(Xi),c=be("".concat(e,"-elt-next"),this.keybNavFeaturesList,l,void 0),f=this.getI18N(Oi.keyboardFeaturesNextPage),d=ge("".concat(c.id,"-container"),c,ro,void 0);Pe("".concat(c.id,"-number"),d,"".concat(no," ").concat(ao),void 0,Qi[8]),Pe("".concat(c.id,"-info"),d,to,void 0,f),this.keybNavFeaturesElements.push(c)}},{key:"_clickFeatureAtIndex",value:function(e){var t=this.features[7*this.pageIndex+e];if(t)return this.isFeatureSelected(t)?this.clearSelectedFeature():(this.handleMarkerClick(t,t.markerType,"dialog-keyboard-pressed"),"cluster"!==t.type&&Ya(t.marker)),!0}},{key:"_paginateFeaturePage",value:function(e){return e&&this.pageIndex<this.pageCount-1?(this.pageIndex+=1,!0):!e&&this.pageItedFeature",value:function(){return this.clearSelectedFeature(),!0}},{key:"_initializeListeners",value:function(){var e=this;this.registerListenerOnMapFocusElement({type:"keypress",dom:!0},(function(t){var n=(t.which||t.keyCode||t.key)-e.keyPressZero,r=!1;n>=0&&n<=9&&(t.preventDefault(),0===n?e._clearSelectedFeature():n<=7?e._clickFeatureAtIndex(n-1):r=8===n?e._paginateFeaturePage(!1):e._paginateFeaturePage(!0),r&&e._updateKeyboardFeaturesDialog())})),this.registerListenerOnMapFocusElement({type:"keydown",dom:!0},(function(t){Number(t.which||t.keyCode||t.key)===e.keyDownBackspace&&(t.preventDefault(),e.clearSelectedFeature(),e._updateKeyboardFeaturesDialog())}))}},{key:"refreshKeyboardNavIconVisibility",value:function(e){(void 0!==e?e:this.keyboardNavigationMode)?Ue(this.keyboardIcon):Ve(this.keyboardIcon)}},{key:"_resetFeatures",value:function(e){var t=this._resetMarker.bind(this);e&&e.forEach(t)}},{key:"_resetMarker",value:function(e){e&&e.marker&&Qe(e.marker.cssElement,oo)&&(ot(e.marker.cssElement,oo),Xa(e.marker,Ft(this.zIndexes[e.type],e.hashKeys)))}},{key:"_updateFeatureMarkersAsNotInList",value:function(e){e&&e.forEach((function(e),{key:"_clear",value:function(){this._resetFeatures(this.features)}},{key:"turnKeyboardFeaturesMode",value:function(e){if(!this.node)throw new Error("You need to have the map initialized to turn on the keyboard navigation");this.keyboardNavigationMode=e,e?rt(this.node,Yi):ot(this.node,Yi),this.keyboardNavigationMode&&document.activeElement===this.getMapNavFocusElement()?Ue(this.keyboardIcon):Ve(this.keyboardIcon),this.keyboardNavigationMode?(Ue(this.focusArea),Ue(this.keybNavFeatures)):(Ve(this.focusArea),Ve(this.keybNavFeatures)),this.keyboardNavigationMode||this._clear()}},{key:"isKeyboardFeaturesModeEnabled",value:function(){return this.keyboardNavigationMode}},{key:"_computeScore",value:function(e){return $i[e.type][e.status||("cluster"===e.type?"available":"unknown")]+(e.score||0)*(e.score<1?1:Math.pow(10,-(""+e.score).split(".")[0].length))+Math.pow(10,-5)*(e.children||[]).length}},{key:"_prioritizeFeaturesForKeyboardNav",value:function(e,t){var n=this._computeScore(e),r=this._computeScore(t);return n===r?(""+e.name).localeCompare(t.name):r-n}},{key:"updateKeyboardFeatures",value:function(){if(this.keyboardNavigationMode){var e=this.containerBounds(this.focusArea);e&&(this._resetFeatures(this.features),this.features=this.listFeatures((function(e){return e.visible}),e).sort(this._prioritizeFeaturesForKeyboardNav.bind(this)),this.pageCount=0===this.features.length?0:Math.floor((this.features.length-1)/7+1),this.pageIndex>=this.pageCount&&(this.pageIndex=0),this._updateKeyboardFeaturesDialog())}}},{key:"_updateKeyboardFeaturesDialog",value:function(){0===this.pageCount?rt(this.keybNavFeaturesList,Xi):ot(this.keybNavFeaturesList,Xi);for(var e=[],t=0;t<7;t++){var n,r=null===(n=this.keybNavFeaturesElements)||void 0===n?void 0:n[t];if(r){fe(r);var i=this.features[7*this.pageIndex+t];if(i){ot(r,Xi);var o=ge("".concat(r.id,"-container"),r,ro,void 0);if(Pe("".concat(r.id,"-number"),o,"".concat(no," ").concat(ao),void 0,Qi[t]),i.marker){this._resetMarker(i);var a,s=this.cloneMarker(i.marker);if(s&&(s.style=null==s||null===(a=s.dataset)||void 0===a?void 0:a.cloneStyles,se(s,void 0,!0).map((function(e){return e.element})).forEach((function(e){return ut(e)}))),rt(s,"keyboard-features-list-element-icon"),"cluster"===i.type){var u=Zi(se(s,["cluster-label-content"],!0).map((function(e){return e.element})),1)[0];rt(u,"no-text-overflow"),u.innerHTML=u.innerHTML.replace(/\s/g," ")}o.appendChild(s)}e.push(i),"cluster"!==i.type&&Pe("".concat(r.id,"-info-").concat(i.id),o,to,void 0,i.name||"".concat(i.type," ").concat(i.id))}else rt(r,Xi)s.features||[]).filter((function(t){return!e.includes(t)&&t.marker})));var l=Zi(this.keybNavFeaturesElements||[],9),c=l[7],f=l[8];this._updateNavButton(c,this.pageCount<=1,0===this.pageIndex),this._updateNavButton(f,this.pageCount<=1,this.pageIndex===this.pageCount-1)}},{key:"_updateNavButton",value:function(e,t,n){var r="disabled";t?(rt(e,Xi),ot(e,r)):(ot(e,Xi),n?rt(e,r):ot(e,r))}}],n&&Wi(t.prototype,n),r&&Wi(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function uo(e){return uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uo(e)}function lo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,co(r.key),r)}}function co(e){var t=function(e,t){if("object"!==uo(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==uo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===uo(t)?t:String(t)}var fo="ArrowUp",ho="ArrowDown",po="ArrowRight",yo="ArrowLeft",vo="+",go="-",mo=function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.panBy=t,this.zoomIn=n,this.zoomOut=r,this.events=i,this.deltaX=5,this.deltaY=5,this.keyDownListenerCallback=this._keyDownListenerCallback.bind(this),this.keyUpListenerCallback=this._keyUpListenerCallback.bind(this),this.keyPressListenerCallback=this._keyPressListenerCallback.bind(this)}var t,n,r;return t=e,n=[{key:"_panUntil",value:function(e,t,n){var r=this;this.panBy(e),setTimeout((function(){if(t()){var e=n();r._panUntil(e,t,n)}}),40)}},{key:"_keyDownListenerCallback",value:function(e){var t=this,n=e.key;if([fo,ho,yo,po].includes(n))switch(e.preventDefault(),n){case fo:this.keyUpPressed||(this.keyUpPressed=!0,this._panUntil([0,-this.deltaY],(function(){return t.keyUpPressed}),(function(){return t.deltaY<100&&(t.deltaY+=7),[0,-t.deltaY]})));break;case ho:this.keyDownPressed||(this.keyDownPressed=!0,this._panUntil([0,this.deltaY],(function(){return t.keyDownPressed}),(function(){return t.deltaY<100&&(t.deltaY+=7),[0,t.deltaY]})));break;case yo:this.keyLeftPressed||(this.keyLeftPressed=!0,this._panUntil([-this.deltaX,0],(function(){return t.keyLeftPressed}),(function(){return t.deltaX<100&&(t.deltaX+=7),[-t.deltaX,0]})));break;case po:this.keyRightPressed||(this.keyRightPressed=!0,this._panUntil([this.deltaX,0],(function(){return t.keyRightPressed}),(function(){return t.deltaX<100&&(t.deltaX+=7),[t.deltaX,0]})))}}},{key:"_keyUpListenerCallback",value:function(e){var t=e.key;if([fo,ho,yo,po].includes(t)){switch(e.preventDefault(),t){case fo:this.keyUpPressed=!1,this.deltaY=5;break;case ho:this.keyDownPressed=!1,this.deltaY=5;break;case yo:this.keyLeftPressed=!1,this.deltaX=5;break;case po:this.keyRightPressed=!1,this.deltaX=5}this.events.splice(0,0,"moveKeyboard")}}},{key:"_keyPressListenerCallback",value:function(e){var t=e.key;if([vo,go].includes(t))switch(e.preventDefault(),t){case vo:this.events.splice(0,0,"zoomInKeyboard"),this.zoomIn();break;case go:this.events.splice(0,0,"zoomOutKeyboard"),this.zoomOut()}}}],n&&lo(t.prototype,n),r&&lo(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function bo(e){return bo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bo(e)}function ko(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,wo(r.key),r)}}function wo(e){var t=function(e,t){if("object"!==bo(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==bo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===bo(t)?t:String(t)}var Po=function(){function e(t,n,r,i){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.featureTypeProviders={},n.forEach((function(e){var n={};r[e].forEach((function(e){var r=i[e],o=i[r.type];if(!o)throw new Error("Content provider ".concat(r.type," not supported"));if(!o.checkPackageIsLoaded())throw new Error("You need to load the package supporting the content provider service ".concat(r.type));n[e]=o.newInstance(t,r)})),o.featureTypeProviders[e]=n}))}var t,n,r;return t=e,(n=[{key:"getFeatureProviders",value:function(){return this.featureTypeProviders}}])&&ko(t.prototype,n),r&&ko(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Co(e){return function(e){if(Array.isArray(e))return Lo(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Lo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Lo(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function xo(e){return xo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xo(e)}function Mo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_o(r.key),r)}}function _o(e){var t=function(e,t){if("object"!==xo(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==xo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===xo(t)?t:String(t)}var Fo=function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),[t,n,r,i].some((function(e){return"object"===xo(e)&&e.lng&&e.lat}))?(this.x1=r.lng,this.x2=n.lng,this.y1=t.lat,this.y2=n.lat):(this.x1=t,this.x2=r,this.y1=n,this.y2=i),this.coordinates=[{lng:this.x2,lat:this.y1},{lng:this.x2,lat:this.y2},{lng:this.x1,lat:this.y2},{lng:this.x1,lat:this.y1},{lng:this.x2,lat:this.y1}]}var t,n,r;return t=e,(n=[{key:"getCoordinates",valuinPoints",value:function(){runction(e,t){return this.x1<=e&&e<=this.x2&&this.y1<=t&&t<=this.y2}},{key:"containsBoundingBox",value:function(e){var t=e.getOriginPoints();return this.containsPoint(t[0],t[1])&&this.containsPoint(t[2],t[3])}}])&&Mo(t.prototype,n),r&&Mo(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Oo(e,t,n,r){return[{lng:n,lat:t},{lng:n,lat:r},{lng:e,lat:r},{lng:e,lat:t},{lng:n,lat:t}]}function So(e,t){var n,r,i,o,a=e.lowerQuantile,s=void 0===a?.1:a,u=e.upperQuantile,l=void 0===u?.9:u,c=e.marginMultiplier,f=void 0===c?.2:c,d=e.minMargin,h=vn(e){return e.lat||e[0]})),y=t.map((function(e){return e.lng||e[1]}));if(y.length>10)n=Eo(y,s),r=Eo(y,l),i=Eo(p,s),o=Eo(p,l);else{var v=function(e,t){return{lowerLongitude:Math.min.apply(Math,Co(e)),upperLongitude:Math.max.apply(Math,Co(e)),lowerLatitude:Math.min.apply(Math,Co(t)),upperLatitude:Math.max.apply(Math,Co(t))}}(y,p);n=v.lowerLongitude,r=v.upperLongitude,i=v.lowerLatitude,o=v.upperLatitude}var g=Math.max(f*(r-n),h),m=Math.max(f*(o-m,r+g,o+m)}function Eo(e,t){var n=e.sort((function(e,t){return e-t})),r=(n.length-1)*t,i=Math.floor(r),o=r-i;return void 0!==n[i+1]?n[i]+o*(n[i+1]-n[i]):n[i]}function Io(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||Bo(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterapply(e,r));return n&&To(i,n.prototype),i},Ao.apply(null,arguments)}function To(e,t){return To=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},To(e,t)}function Do(e){return function(e){if(Array.isArray(e))return jo(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Bo(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Bo(e,t){if(e){if("string"==typeof e)return jo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jo(e,t):void 0}}function jo(e,t){(null==t||t>e.length)&le, non-array objects must have a [Symbol.iterator]() method.")}()}function No(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Vo(e,t){var n=Ro(e.getOriginPoints(),4),r=n[0],i=n[1],o=n[2],a=n[3],s=o-r,u=a-i,l=(i+a)/2,c=1/Math.cos(l*Math.PI/180),f=c*(u/s);if(f>t){var d=(c*u/t-s)/2;return Oo(r-d,i,o+d,a)}if(f<t){var h=(s*t/c-u)/2;return Oo(r,i-h,o,a+h)}return e.getCoordinates()}function Uo(e){return Uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Uo(e)}function zo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ko(r.key),r)}}function Ko(e){var t=function(e,t){if("object"!==Uo(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Uo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Uo(t)?t:String(t)}var Ho=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"computeBoundingBox",value:function(e,t,n,r,i){if(!e||0===e.length)throw new Error("Cannot calculate bounds. No valid coordinate values given.");if(!t)return e[0].lat?e:e.map((function(e){return{lat:e[0],lng:e[1]}}));var o=null!=n?n:{},a=function(e,t,n,r){var i=e.minimumPins,o=void 0===i?50:i,a=e.interpolationRatio,s=void 0===a?.75:a;if(n<=o){if(r){var u=Ao(Fo,Do(r));if(u.containsBoundingBox(t)){var l=Io(u.getOriginPoints(),4),c=l[0],f=l[1],d=l[2],h=l[3],p=Io(t.getOriginPoints(),4),y=p[0],v=p[1],g=p[2],m=p[3];return new Fo(y+(c-y)*s,v+(f-v)*s,g+(d-g)*s,m+(h-m)*s)}return t}return t}return t}(o,So(o,e),e.length,r);return Vo(a,i)}},{key:"computeCenteredBoundingBox",value:function(e,t,n){if(!e||0===e.length)throw new Error("Cannot calculate bounds. No valid coordinate values given.");return Vo(function(e,t){var n,r,i=null!==(n=e.lat)&&void 0!==n?n:e[0],o=null!==(r=e.lng)&&void 0!==r?r:e[1],a=Dr(i,t.map((function(e){var t;return null!==(t=e.lat)&&void 0!==t?t:e[0]})),!1),s=Dr(o,t.map((function(e){var t;return null!==(t=e.lng)&&void 0!==t?t:e[1]})),!0),u=o-s,l=Ut(i+(i-a),void 0,!1),c=Ut(o+u,void 0,!0);switch(Br([i,o],[a,s])){case"sw":return new Fo(s,a,c,l);case"ne":return new Fo(c,l,s,a);case"se":return new Fo(c,a,s,l);default:return new Fo(s,l,c,a)}}(t.centeredOn,e),n)}}])&&zo(t.prototype,n),r&&zo(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Zo(){return Zo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Yo(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},Zo.apply(this,arguments)}function qo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||Wo(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wo(e,t){if(e){if("string"==typeof e)return Go(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Go(e,t):void 0}}function Go(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Qo(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$o(e,t)}function $o(e,t){return $o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},$o(e,t)}function Xo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Yo(e);if(t){var i=Yo(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===Jo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function Yo(e){return Yo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Yo(e)}function Jo(e){return Jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jo(e)}function ea(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ta(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ra(r.key),r)}}function na(e,t,n){return t&&ta(e.prototype,t),n&&ta(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ra(e){var t=function(e,t){if("object"!==Jo(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Jo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Jo(t)?t:String(t)}var ia=Kt,oa=Qt,aa=qt,sa=Et,ua="qualifiers",la={default:void 0,onSelect:void 0},ca="product",fa="property",da="place",ha="cluster",pa=[ca,fa],ya=[ca,fa,da],va="unknown",ga=["available","filtered","sold_out",va],ma=ga,ba=[].concat(ya,[ha]),ka=function(){function e(t,n,r){ea(this,e),this.id=t,this.type=n,this.configHelper=r,this.data=[void 0,void 0],this.visible=!1,this._intersectingFeatureIds=[],this._clean()}return na(e,[{key:"_clean",value:function(){this.marker=void 0,this.markerType=void 0,this.popupContent=void 0,this.visible=!1,this._highlighted=!1,this.clearHashkeys(}},{key:"updateConfigHelper"er=e}},{key:"clearHashkeys",value:function(){this._hashKeys=void 0}},{key:"_importData",value:function(e,t){e&&(void 0===this.data[t]&&:"_removeData",value:function(e){delete this.data[e],this._clean()}},{key:"hashKeys",get:function(){return void 0===this._hashKeys&&(this._hashKeys=oa(void 0,this._highlighted,[])),this._hashKeys}},{key:"importUserData",value:function(e){this._importData(e,0)}},{key:"importTileData",value:function(e){this._importData(e,1)}},{key:"removeTileData"ta(1)}},{key:"removeUserData",value:function(){this._removeData(0)}},{key:"mergeUserData",value:function(e){this._mergeData(e,0)}},{key:"mergeTileData",value:function(e){this._mergeData(e,1)}},{key:"_mergeData",value:function(e,t){e&&Object.assign(this.data[t],e),this._hashKeys=void 0}},{key:"_toData",value:function(e){if(this.data[e])return{id:this.id,type:this.type}}},{key:"toUserData",value:function(){return this._toData(0)}},{key:"toTileject.assign(Object.assign({},this.toTileData()),this.toUserData())}},{key:"hasUserData",value:function(){return this._hasData(0)}},{key:"hasTileData",value:function(){return this._hasData(1)}},{key:"_hasData",value:function(e){var t=this.data[e];return void 0!==t&&Object.keys(t).length>0}},{key:"defined",get:function(){return!!this.data.find((function(e){return e}))}},{key:"userData",get:function(){returnhis.get:function(){return this.data[1]},set:function(e){this.data[1]=e}},{key:"latLng",get:function(){return this._getLatLngFromData(this._getFirstDefined.bind(this))}},{key:"userLatLng",get:function(){return this._getLatLngFromData(this._getUserProp.bind(this))}},{key:"_getLatLngFrom)}},lighted},set:function(e){this._highlighted=e,this._hashKeys=void 0ue:function(e){return(this.data.find((function(t){return(t||{})[e]}))||{})[e]}},{key:"_getUserProp",value:function(e){return(this.data[0]||{})[e]}},{key:"intersectingeIds},set:function(e){void 0!==e&&(this._invar t=Xo(n);function n(e,r,i){return ea(this,n),t.call(this,e,r,i)}return na(n,[{key:"hashKeys",get:function(){if(void 0===this._hashKeys){var e=this.qualifiers&&this.configHelper?this.configHelper.filterQualifiersUsed(this.type,this.qualifiers):this.qualifiers,t=oa(this.status,this._highlighted||!1,e);this._hashKeys=this.configHelper?this.configHelper.filterHashkeysUsed(this.type,t):t}return this._hashKeys}},{key:"addQualifier",value:function(){for(var e=!1,t=this._getFirstDefined(ua),n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return r.forEach((function(n){t.includes(n)||(t.push(n),e=!0)})),e&&(this._hashKeys=void 0),e}},{key:"removeQualifier",value:function(){for(var e=!1,t=this._getFirstDefined(ua),n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return r.forEach((function(n){var r=t.indexOf(n);-1!==r&&(t.splice(r,1),e=!0)})),e&&(this._hashKeys=void 0),e}},{key:"_assign",value:function(e,t,n){void 0!==n?e[t]=n:void 0!==e[t]&&delete e[t]}},{key:"_importData",value:function(e,t){e&&(void 0===this.data[t]&&(this.data[t]={}),this._assign(this.data[t],"status",e.status),this._assign(this.data[t],"name",e.name),this._assign(this.data[t],ua,e.qualifiers||[]),this._assign(this.data[t],"textLabel",e.textLabel),this._assign(this.data[t],"price",e.price),this._assign(this.data[t],"polygon",e.polygon),this._assign(this.data[t],"text",e.text),this._assign(this.data[t],"latLng",void 0!==e.lat&&void 0!==e.lng?ia([e.lat,e.lng]):void 0),this._assign(this.data[t],"score",e.score),this._assign(this.data[t],"thumbnail",e.thumbnail),this._assign(this.data[t],"description",e.description),this._assign(this.data[t],"tile",e.tile),this._assign(this.data[t],"ariaLabels",e.ariaLabels),this._hashKeys=void 0)}},{key:"_toData",value:function(e){var t=this.data[e];if(t)return{id:this.id,type:this.type,status:t.status||va,qualifiers:t.qualifiers||[],name:t.name,price:t.price,polygon:t.polygon,text:t.text,lat:t.latLng?t.latLng[0]:void 0,lng:t.latLng?t.latLng[1]:void 0,score:t.score,thumbnail:t.thumbnail,description:t.description,ariaLabels:t.ariaLabels}}},{key:"hasLatLngChanged",value:function(e,t,n){if(void 0===e&&void 0!==t&&void 0!==n)return!0;if(void 0===e||void 0!==t&&void 0!==n){var r=qo(ia([t,n]),2),i=r[0],o=r[1];return Math.abs(e[0]-i)>1e-5||Math.abs(e[1]-o)>1e-5}return!0}},{key:"isUserDataChanged",value:function(e){return!!e&&(!this._same(this.userStatus||va,e.status||va)||!this._same(this.userPrice,e.price)||!this._same(this.userPolygon,e.polygon)||!this._same(this.userText,e.text)||!this._same(this.userName,e.name)||!this._same(this.userDescription,e.description)||!aa(this.userQualifiers,e.qualifiers,!1)||this.ng))}},{key:"_same",value:function(e,t){return e===t||sa(e)&&sa(t)}},{key:"status",get:function(){return this._getStatusFromData(this._getFirstDefined.bind(this))}},{key:"userStatus",get:function(){return this._getStatusFromData(this._getUserProp.bind(this))}},{key:"_getStatusFromData",value:function(e){return e("status")||va}},{key:"qualifiers",get:function(){return this._getQualifiersFromData(this._getFirstDefined.bind(this))}},{key:"userQualifiers",get:function(){return this._getQualifiersFromData(this._getUserProp.bind(this))}},{key:"_getQualifiersFromData",value:function(e){return e("qualifiers")}},{key:"name",get:function(){return this._getFirstDefined("name")}},{key:"userName",get:function(){return this._getNameFromData(this._getUserProp.bind(this))}},{key:"_getNameFromData",value:function(e){return e("name")}},{key:"description",get:function(){return this._getFirstDefined("description")}},{key:"userDescription",get:function(){return this._getDescriptionFromData(this._getUserProp.bind(this))}},{key:"_getDescriptionFromData",value:function(e){return e("description")}},{key:"price",get:function(){return this._getPricels",get:function(){return this._getFirstDefined("ariaLabels")||la}},{key:"userPrice",get:function(){return this._getPriceFromData(this._getUserProp.bind(this))}},{key:"_getPriceFromData",value:function(e){return e("price")}},{key:"polygon",get:function(){return this._getPolygonFromData(this._getFirstDefined.bind(this))}},{key:"userPolygon",get:function(){return this._getPolygonFromData(this._getUserProp.bind(this))}},{key:"_getPolygonFromData",value:function(e){return e("polygon")}},{key:"text",get:fuction(){return this._getTextFrohis))}},{key:"_getTextFromData",value:function(e){return e("text")}},{key:"score",get:function(){return this._getFirstDefined("score")}}]),n}(ka),Pa=function(e){Qo(n,e);var t=Xo(n);function n(e){var r;return ea(this,n),(r=t.calion(){Zo(Yo(n.prototype),"_clean",this).call(this),this.visible=!0}},{key:"_importData",value:function(e,t){e&&(this.data[t]={children:e.children,radius:e.radius,minPrice:e.minPrice,originalLatLng:ia([e.lat,e.lng])},this._hashKeys=void 0)}},{key:"_toData",value:function(e){var t=this.data[e];if(t)return{id:this.id,type:this.type,radius:t.radius,children:t.children,minPrice:t.minPrice,lat:t.ori},{key:"computedLatLng",get:function(){return this._computedLatLng},set:function(e){e&&e.length>0?this._computedLatLng=ia([e[0],e[1]]):this._computedLatLng=[]}},{key:"latLng",get:function(){return this._getFirstDefined("originalLatLng")}},{key:"children",get:function(){return this._getFirstDefined("children")}},{key:"minPrice",get:function(){return this._getFirstDefined("minPrice")}}]),n}(ka),Ca=function(){function e(t,n){ea(this,e),this.type=t,this.newInstance=n,this.index=new Map,this._data=[nction(){return this._dataefined}))}},{key:"contains",value:function(e){return!!this.find(e)}},{key:"find",value:function(e){var t,n,r=null!==(t=this.index.get(e))&&void 0!==t?t:-1;if(r>-1)return this._data[r]&&null!==(n=this._data[r])&&void 0!==n&&n.defined?this._data[r]:void 0}},{key:"save",value:function(e){if(e.type===this.type){var t,n=null!==(t=this.index.get(e.id))&&void 0!==t?t:-1;n>-1?this._data[n]=e:(this.index.set(e.id,this._data.length),this._data.push(e))}}},{key:"delete",value:function(e){if(e.type===this.type){var t,n=null!==(t=this.index.get(e.id))&&vo,{key:"clearAll",value:function(){this._data=[],this.index=new Map}}]),e}(),La=function(){function e(){ea(this,e),this._repositories={product:new Ca(ca,(function(e,t){return new wa(e.id,ca,t)})),property:ned,fa,t)})),place:new e.id,da,t)})),cluster:new Ca(ha,(function(e,t){return new Pa(e.id)}))}}return na(e,[{key:"allProducts",value:function(){return this.all((function(e){return e===ca}))}},{key:"allProductsWithCoordinates",value:function(){return this.allProducts().filter((function(e){return void 0!==e.latLng}))}},{key:"allProperties",value:function(){return this.all((function(e){return e===fa}))}},{key:"allPropertiesWithCoordinates",value:function(){return this.allProperties().filter((function(e){return void 0!==e.latLng}))}},{key:"allPlaces",value:function(){return this.all((function(e){return e===da}))}},{key:"allPlacturn this.allPlaces().filter((function(e){return void 0!==e.latsters",value:function(){return this.all((function(e){retusters",value:function(,{key:"find",value:function(e,t){return this.repository(t).find(e)}},{key:"delete",value:function(e,t)},{key:"repository",value:function(e){return this._repositories[e]}},{key:"all",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return!0},n=[];return Object.keys(this._repositories).filter((function(e){return t(e)})).forEach((function(t){n=n.concat(e._repositories[t].data)})),n}},{key:"upsertUserData",value:function(e,t){retuata",value:function(e,t){return this._upsert(e,"importTileData",t)}},{key:"insertTileData",value:function(e,t){if(!this.repository(e.type).find(e.id))return this._upsert(e,"importTileData",t)}},{key:"insertTileDataWithLowestZoom",value:function(e,t){var n=this.repository(e.type).find(e.id);if(!n)return this._upsert(e,"importTileData",t);var r=n.tileData&&n.tileData.tile,i=e.tile&&e.tile[2],o=r&&r[2];return void 0!==i&&(void 0===o||i<o)?this._upsert(e,"importTileData",t):void 0}},{key:"_upsert",value:function(e,t,n){var r=this.repository(e.type).find(e.id);return r||(r=this.repository(e.type).newInstance(e,n)),r[t]ileData",value:function(e){return this._delete(e,"removeTileData")}},{key:"_delete",value:function(e,t){var n=this.repository(e.type).find(e.id);return n&&(n[t](e),n.defined||this.repository(e.type).delete(e)),n}}]),e}();function xa(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[{score:"DESC"},{id:"ASC"}];return e.sort((function(e,n){var r,i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Wo(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(t);try{for(i.s();!(r=i.n()).done;)for(var o=r.value,a=0,s=Object.keys(o);a<s.length;a++){var u=s[a],l=e[u],c=n[u],f=0;if(void 0===l&&void 0!==c?f=-1:void 0!==l&&void 0===c?f=1:void 0!==l&&void 0!==c&&(l<c&&(f=-1),l>c&&(f=1)),"DESC"===o[u]&&(f*=-1),0!==f)return f}}catch(e){i.e(e)}finally{i.f()}return 0}))}function Ma(e){return Ma="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ma(e)}function _a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||Oa(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fa(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Oa(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Oa(e,t){if(e){if("string"==typeof e)return Sa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Sa(e,t):void 0}}function Sa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ea(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ia(r.key),r)}}function Ia(e){var t=function(e,t){if("object"!==Ma(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Ma(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Ma(t)?t:String(t)}var Aa=Ft,Ta=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,n=[{key:"init",value:function(e){var t=e.asKey,n=e.getMarkerComponent,r=e.getRectOfMarker,i=e.moveMarkerPosition,o=e.makeMarkerVisible,a=e.settings;this.asKey=t,this.getMarkerComponent=n,this.getRectOfMarker=r,this.moveMarkerPosition=i,this.makeMarkerVisible=o,this.settings=a;var s=a.collision;this.textLabelVisibility=s.labelVisibility,this.textLabelDynamicPlacement=s.dynamicPlacement,this.collisionBufferVariation=s.collisionBufferVariation,this.collisionBuffers=s.collisionBuffers,this.tagCollidingMarkersConfig=s.tagCollidingMarkers,this.clusterMarkerCollisionBuffer=s.clusterMarkerCollisionBufferInPixels,this.shouldMoveCollidingClusterMarkers=s.shouldMoveCollidingClusterMarkers}},{key:"_isMarkerCollidingOtherMarkerOrLabel",value:function(e,t){var n,r=e.markerBBox,i=Fa(t);try{for(i.s();!(n=i.n()).done;){var o=n.value,a=o.textLabelBBox,s=o.markerBBox,u=o.labelVisibility;if(r&&(s&&$e(r,s)||u&&a&&$e(r,a)))return!0}}catch(e){i.e(e)}finally{i.f()}return!1}},{key:"_isLabelCollidingOtherMarkerOrLabel",value:function(e,t){var n,r=e.textLabelBBox,i=e.labelVisibility,o=Fa(t);try{for(o.s();!(n=o.n()).done;){var a=n.value,s=a.textLabelBBox,u=a.markerBBox,l=a.labelVisibility;if(i&&r&&(l&&s&&$e(r,s)||u&&$e(r,u)))return!0}}catch(e){o.e(e)}finally{o.f()}return!1}},{key:"_sortCandidateBBoxes",value:function(e){return e.sort((function(e,t){return e.popularity===t.popularity?e.feature.id<t.feature.id?-1:1:e.popularity>t.popularity?-1:1}))}},{key:"_splitFeaturesBoundingBoxes",value:function(e){var t=[],n=[];return e.forEach((function(e){"always"===e.labelVisibility||!1===e.isDynamicLabel?t.push(e):n.push(e)})),{safeFeaturesBBoxes:t,candidateBBoxes:n}}},{key:"_updateMarkerLabelPosition",value:function(e){var t=this._splitFeaturesBoundingBoxes(e),n=t.safeFeaturesBBoxes,r=t.candidateBBoxes;for(this._sortCandidateBBoxes(r);r.length>0;){var i=_a(r,1)[0],o=i.feature,a=i.labelVisibility,s=i.availableLabelPositions,u=i.currentLabelPosition,l=o.marker;if(this._isMarkerCollidingOtherMarkerOrLabel(i,n))rt(this.getMarkerComponent(o),lu),r.shift();else{var c=a&&this._isLabelCollidingOtherMarkerOrLabel(i,n);if(c){s[u]=!1;for(var f=!1,d=0,h=Object.entries(s);d<h.length;d++){var p=_a(h[d],2),y=p[0];if(p[1]){f=!0,u=y;break}}f&&o.name?(l.labels.updateTextLabelPosition(u),i.textLabelBBox=pu(o,this.getMarkerComponent(o),this.settings,u,this.getRectOfMarker),i.currentLabelPosition=u):(l.labels.toggleTextLabel(c),i.labelVisibility=!1,n.push(i),r.shift())}else n.push(i),r.shift()}}}},{key:"getPopularity",value:function(e){var t,n=null!==(t=null==e?void 0:e.score)&&void 0!==t?t:0;return"number"!=typeof n?0:n}},{key:"_calculateFeaturesBoundingBoxes",value:function(e,t,n){var r=this,i=e.map((function(e){var i=r.asKey(e),o=t[i],a=e.marker.textLabelPosition;return{labelVisibility:o,availableLabelPositions:{right:!0,left:!0,above:!0,below:!0},currentLabelPosition:a,isDynamicLabel:n[i],markerBBox:r.getRectOfMarker(e),textLabelBBox:o&&e.name?pu(e,r.getMarkerComponent(e),r.settings,a,r.getRectOfMarker):void 0,popularity:r.getPopularity(e),feature:e}}));return i}},{key:"_resetMarkersAndLabels",value:function(e,t){var n=this;e.forEach((function(e){var r;ot(n.getMarkerComponent(e),lu),t[n.asKey(e)]&&(null===(r=e.marker)||void 0===r||r.labels.resetTextLabel())}))}},{key:"_getLabelVisibilityConfigByFeatureKey",value:function(e){var t=this,n={};return e.forEach((function(e){var r=Aa(t.textLabelVisibility[e.type],e.hashKeys),i=t.asKey(e);n[i]=r})),n}},{key:"_getLabelDynamicPlacementConfigByFeatureKey",value:function(e){var t=this,n={};return e.forEach((function(e){var r=Aa(t.textLabelDynamicPlacement[e.type],e.hashKeys),i=t.asKey(e);n[i]=r})),n}},{key:"handleMarkerLabelCollision",value:function(e){var t=this,n=e.filter((function(e){return t.getMarkerComponent(e)})),r=this._getLabelDynamicPlacementConfigByFeatureKey(n);if(Object.values(r).includes(!0)){var i=this._getLabelVisibilityConfigByFeatureKey(n);this._resetMarkersAndLabels(n,i);var o=this._calculateFeaturesBoundingBoxes(n,i,r);this._updateMarkerLabelPosition(o)}}},{key:"moveCollidingClusterMarkers",value:function(e){var t=this;e.filter((function(e){return"cluster"===e.feature.type&&t.getMarkerComponent(e.feature)})).forEach((function(n){var r,i=null===(r=n.feature.toData())||void 0===r?void 0:r.radius;if(ot(t.getMarkerComponent(n.feature),"cluster-marker-moved"),ot(t.getMarkerComponent(n.feature),"cluster-marker-failed-toe){return n.feature._intersectingFeatureIds.includes(e.feature.id)})),a=t.getMaxRectOfMarkers(o),s=n.markerRect,u=lt(a,s,t.clusterMarkerCollisionBuffer),l=dt(s,u),c=ct(l.center,l.width+2*n.markerCollisionBuffer,l.height+2*n.markerCollisionBuffer),f=e.filter((function(e){return e.feature.id!==n.feature.id&&t.getMarkerComponent(e.feature)}));t.withinClusterRadius(s.center,l,i)&&t.noNewClusterCollision(c,f)?(t.moveMarkerPosition(n.feature,u),rt(t.getMarkerComponent(n.feature),"cluster-marker-moved"),t.updateIntersectingFeatureIdsAfterMovingClusterMarkerPosition(n.feature,l,f),n.markerRect=l,n.markerRectWithBuffer=c):rt(t.getMarkerComponent(n.feature),"cluster-marker-failed-to-move")}}),this)}},{key:"updateIntersectingFeatureIdsAfterMovingClusterMarkerPosition",value:function(e,t,n){var r=e.id;e._intersectingFeatureIds=[],n.forEach((function(e){var n=e.feature._intersectingFeatureIds.indexOf(r);$e(e.markerRectWithBuffer,t)?n<0&&e.feature._intersectingFeatureIds.push(r):n>-1&&e.feature._intersectingFeatureIds.splice(n,1)}))}},{key:"withinClusterRadius",value:function(e,t,n){return Ye(t,this.getClusterCircle(e,n)function(e,t){return!t.some((function(t){return $e(e,t.markerRect)}))}},{key:"getClusterCircle",value:function(e,t){reture:function(e){return ft(e.map((function(e){return e.markerRect})))}},{key:"hideCollidingMarkers",value:function(e,t){var n=this,r=e.filter((function(e){return n.getMarkerComponent(e)})),i=[],o=[];r.forEach((function(e){"none"===t[n.asKey(e)]?i.push(e):o.push(e)}));for(var a=xa(o,[{type:"ASC"},{score:"DESC"},{id:"ASC"}]);a.length>0;){var s,u=a.shift(),l=!1,c=Fa(i);try{for(c.s();!(s=c.n()).done;){var f=s.value;if(u&&f&&u.type===f.type&&u._intersectingFeatureIds.includes(f.id)){this.makeMarkerVisible(u,!1),this.updateIntersectingFeatureIdsAfterHidingMarker(r,u.id),l=!0;break}}}catch(e){c.e(e)}finally{c.f()}l||i.push(u)}}},{key:"updateIntegFeatureIds.indexOf(t);n>-1&&e._intersectingFeatureIds.splice(n,1)}))}},{key:"tagCollidingMarkers",value:function(e,t){var n=this,rorEach((function(e){ot(n.getMarkerComponent(e),"marker-collision")})),r.filter((function(e){return e._intersectingFeatureIds.length>0&&t[n.asKey(e)]})).forEach((function(e){var t,i=Fa(r);try{for(i.s();!(t=i.n()).done;){var o=t.value.id;if(e.id!==o&&e._intersectingFeatureIds.includes(o)){rt(n.getMarkerComponent(e),"marker-collision");break}}}catch(e){i.e(e)}finally{i.f()}}))}},{key:"updateMarkerPosition",value:function(e){var t=this,n=e.filter((function(e){return t.getMarkerComponent(e)})),r=this.getCollisionBufferVariationByFeatureKey(n),i=this.getFeaturesWithMarkerRects(n,r);this.updateIntersectingFeatureIds(i),this.shouldMoveCollidingClusterMarkers&&this.moveCollidingClusterMarkers(i),Object.values(r).some((function(e){return"none"!==e}))&&this.hideCollidingMarkers(n,r);var o=this.getTagCollidingMarkersConfigByFeatureKey(n);Object.values(o).includes(!0)&&this.tagCollidingMarkers(n,o)}},{key:"getTagCollidingMarkersConfigByFeatureKey",value:function(e){var t=this,n={};return e.forEach((function(e){var r=Aa(t.tagCollidingMarkersConfig[e.type],e.hashKeys),i=t.asKey(e);n[i]=r})),n}},{key:"getCollisionBufferVariationByFeatureKey",value:function(e){var t=this,n={};return e.forEach((function(e){var r=Aa(t.collisionBufferVariation[e.type],e.hashKeys),i=t.asKey(e);n[i]=r})),n}},{key:"updateIntersectingFeatureIds",value:function(e){e.forEach((function(t){var n;(null===(n=t.feature._intersectingFeatureIds)||void 0===n?void 0:n.length)>0&&(t.feature._intersectingFeatureIds=[]),"cluster"===t.feature.type&&(t.feature.computedLatLng=[]),e.forEach((function(e){t.feature.id!==e.feature.id&&$e(t.markerRectWithBuffer,e.markerRect)&&t.feature._intersectingFeatureIds.push(e.feature.id)}))}))}},{key:"getFeaturesWithMarkerRects",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.filter((function(e){return t.getMarkerComponent(e)})).map((function(e){var r=n[t.asKey(e)],i=t.collisionBuffers[r]||0;return{feature:e,markerRectWithBuffer:t.getRectOfMarker(e,i),markerRect:t.getRectOfMarker(e),markerCollisionBuffer:i}}))}}],n&&Ea(t.prototype,n),r&&Ea(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Da(e){return Da="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Da(e)}function Ba(e){return function(e){if(Array.isArray(e))return ja(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return ja(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ja(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ja(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ra(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Na(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Da(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Da(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Da(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Va=Ft,Ua={doubleClick:{type:"dblclick",dom:!0}};function za(e,t){var n,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"none",o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4?arguments[4]:void 0;if(Y(e)){n=e.cloneNode(!0);var s=["component-icon"];a&&s.push(a),o&&(r=vn(J(e)||"")),it(n,s)}else n=Me(void 0,void 0,a,void 0,e);if("none"!==i){var u=Ha(void 0,t,n,"frame").main;return r&&(u.hashCode=r),{iconImg:n,main:u}}return ye(n,t),r&&(n.hashCode=r),{iconImg:n,main:n}}function Ka(e,t,n,r,i,o){var a=Pe(void 0,void 0,"".concat(n,"-content"),void 0,i);Ee(a);var s=Ha(e,t,a,"".concat(n,"-label"),"".concat(n,"-text ").concat(r),o);return{main:s.main,text:s.text,span:a}}function Ha(e,t,n,r,i,o){var a=ge(e,t,i,o),s=ge(void 0,a,r);return s.appendChild(n),{main:a,text:s}}function Za(e,t){var n=e.hashKeys,r=t.textLabelVisibility,i=t.textSubLabelVisibility,o={};if(Va(r[e.type],n)){var a=e.name;a&&(o.label=a)}if(Va(i[e.type],n)){var s=e.description;s&&(o.subLabel=s)}return o}function qa(e,t){var n,r,i=t.markerTypes,o=t.frameIcons,a=t.icons,s=t.zIndexes,u=t.cornerIcons,l=t.innerIcons,c=t.iso4217CurrencyCode,f=tfineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({markerType:g,zIndex:0,cssClasses:{toAdd:[e.type,p.status,p.highlighted?"hl":"not-hl"],toRemove:[p.highlighted?"not-hl":"hl"]},frameIcon:Va(o[h],d),icons:{}},Za(p,t));switch(g){case"price":case"priceObfuscate":y?m.textContent=gn(y,void 0,c,f):m.markerType="price"===g?"pin":"pinObfuscate";break;case"text":v?m.textContent=v:m.markerType="pin"}switch(null!=e&&null!==(n=e.marker)&&void 0!==n&&n.cssClasses&&(r=m.cssClasses.toRemove).push.apply(r,Ba(e.marker.cssClasses)),m.markerType){case"pin":m.cssClasses.toAdd.push("pin-marker"),m.icons.pin=Va(a[e.type],d);break;case"price":m.cssClasses.toAdd.push("price-marker");break;case"text":m.cssClasses.toAdd.push("text-marker");break;case"obfuscate":m.cssClasses.toAdd.push("obfuscate-marker");break;case"pinObfuscate":m.cssClasses.toAdd.push("pin-obfuscate-marker"),m.icons.pin=Va(a[e.type],d);break;case"priceObfuscate":m.cssClasses.toAdd.push("price-obfuscate-marker");break;default:throw new Error("Unknown marker type: ".concat(m.markerType))}var b,k=p.qualifiers||[];k.length>0&&(b=m.cssClasses.toAdd).push.apply(b,Ba(k)),m.zIndex=Va(s[p.type],d);var w=as(p,u);u&&(m.icons.cornerIcons=w);var P=ss(p,l);return l&&(m.icons.innerIcons=P),m}function Wa(e,t,n){e&&n.onSelect?_e(t,n.onSelect):n.default?_e(t,n.default):Oe(t)}function Ga(e,t,n){Wa(e,t,n),Be(t),je(t)}function Qa(e,t){var n,r=e.marker,i=Za(e,t),o=i.label,a=i.subLabel;null===(n=r.labels)||void 0===n||n.updateTextLabel(o,a)}function $a(e,t,n,r){var i,o=null==e||null===(i=e.marker)||void 0===i?void 0:i.iconElements;if(o){var a=[];for(var s in t)if("cornerIcons"!==s&&"innerIcons"!==s){var u=o[s];Ke(o[s],t[s]),a.push(Gr(u,n,r))}return Hn(a).then((function(){return!0}))}return Promise.resolve(!1)}function Xa(e,t){e&&e.zIndexElement&&(Tt(e.zIndexElement)?e.zIndexElement.forEach((function(e){return He(e,t)})):He(e.zIndexElement,t))}function Ya(e){e&&e.bounceElement&&rr(e.bounceElement)}function Ja(e,t){return"none"!==e[t]}function es(e,t){t&&Object.keys(t).forEach((function(n){if(Ja(t,n)){var r=ge(void 0,e,"corner-icon ".concat(n));za(t[n],r)}}))}function ts(e,t){if(t){var n=e.parentElement||void 0;Object.keys(t).forEach((function(r){if(Ja(t,r)){var i;switch(r){case"left":var o=ue(e);o>=0&&gt(i=ge(void 0,void 0,"inner-icon ".concat(r)),n,o);break;case"right":i=ge(void 0,n,"inner-icon ".concat(r))}i&&za(t[r],i)}}))}}function ns(e,t){var n=Object.keys(e);return!(qt(n,Object.keys(t),!1)&&n.every((function(n){return t[n]&&!Qr(e[n],t[n],!0)})))}function rs(e,t){return ns(e,t)}function is(e,t){return ns(e,t)}function os(e,t){var n;return Object.keys(t).forEach((function(r){var i=Va(t[r][e.type],e.hashKeys);i&&,n}function as(e,t){return os(e,t)}functionus(e,t){return t(e,Ua.doubleClick,(function(e){e.stopPropagation()}))}function ls(e){return ls="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ls(e)}function cs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,fs(r.key),r)}}function fs(e){var t=function(e,t){if("object"!==ls(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==ls(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===ls(t)?t:String(t)}var ds=function(){function e(t){var n=t.getFeatureStatus,r=t.getI18N,i=t.filter,o=t.markerTypes,a=t.icons,s=t.addEventListener,u=t.uniqId,l=t.eventClick,c=t.readParam,f=t.writeParam,d=t.eventsManager;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.checkboxes={},this.getFeatureStatus=n,this.getI18N=r,this.filter=i,this.markerTypes=o,this.icons=a,this.addEventListener=s,this.uniqId=u,this.eltId=this.uniqId("fbox"),this.eventClick=l,this.readParam=c,this.writeParam=f,this.eventsManager=d}var t,n,r;return t=e,n=[{key:"init",value:function(e){var t=e.node,n=e.updateViewport;this.node=t,this._createFiey:"removeAllUIElements",value:function(){he(this.node,this.eltId)}},{key:"syncFilterChecked",value:function(e){var t=this;Object.keys(this.checkboxes).forEach((function(n){return Object.keys(t.checkboxes[n]).forEach((function(r){var i=t.checkboxes[n][r].checked,o="markers,".concat(n,",show,").concat(r);e.writeParam(o,i)}))}))}},{key:"_createFiltersBox",value:function(){var e=this;this.checkboxes={},this.fBox=ge(this.eltId,this.node,"map-legend closed");var t=ge(void 0,this.fBox,"map-legend-header",void 0);_e(we(void 0,t,"toggle",void 0,void 0),this.getI18N(Oi.ariaFilterBoxToggleLegend)),this.addEventListener(this.fBox,this.eventClick,(function(t){"checkbox"!==t.target.type&&Xe(e.fBox,"open","closed")})),Le(void 0,t,"fbox-title",void 0,this.getI18N(Oi.filterBoxLegend));var n=this.filter.visibilityByStatus;Object.keys(this.filter.showFilter).forEach((functFilter[r]&&Object.values(n[r]).some((function(e){return"never"!==e}))){var i=me(void 0,e.fBox,"fbox-list ".concat(r)),o=n[t];e.getFeatureStatus(r).forEach((function(t){var n=e.turnFeaturesVisible.bind(e,r);"never"!==o[t]&&e._createTypeBox(i,r,t,n,o[t])}))}}))}},{key:"turnFeaturesVisible",value:function(e,t,n,r,i){var o="markers,".concat(e,",show,").concat(t),a=this.readParam(o);if("always"===a||"never"===a)throw new Error("Cannot change config value ".concat(e," + ").concat(t,". The value is set to ").concat(a));if(a!==n&&(this.writeParam(o,n),i&&this.checkboxes&&this.checkboxes[e]&&this.checkboxes[e][t]&&(this.checkboxes[e][t].checked=n),this.updateViewport(),r)){var s={type:e,status:t,isVisible:n};this.eventsManager.pushEvent(oi.filterChanged,s)}}},{key:"_createTypeBox",value:function(e,t,n,r,i){var o="always"!==i,a=this._filterBoxLabel(t,n),s=this._ariaFilterBoxLabel(t,"CheckBox",n),u=this._ariaFilterBoxLabel(t,"Img",n),l=this.filter.visibilityBooleanByStatus[t][n],c=be(void 0,e,n);switch(this.markerTypes[t][n]||this.markerTypes[t].default){case"pin":case"pinObfuscate":De(Me(void 0,c,"status-image",void 0,this.icons[t].legend||this.icons[t][n],u));break;case"price":case"priceObfuscate":it(Ka(void 0,c,"price",n,"$",void 0).main,["price-marker","price-marker-legend","not-hl"]);break;case"text":it(Ka(void 0,c,"text",n,"H",void 0).main,["text-marker","text-marker-legend","not-hl"]);break;default:throw new Error("marker type not supported: ".concat(this.markerTypes[t][n]))}var f=Pe(void 0,ke(void 0,c),"text",void 0,a);if(o){var d=xe(void 0,c,"check",void 0,n,l,s);Se(d,f.id),this.checkboxes||(this.checkboxes={}),this.checkboxes[t]||(this.checkboxes[t]={ntListener(d,this.eventClick,(function(e){r(n,e.target.checked,!0)}))}}},{key:"_ariaFilterBoxLabel",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"unknown",r=It(rn(e)),i=It(rn(n));return this.getI18N(Oi["ariaFilterBox".concat(t).concat(r).concat(i)])}},{key:"_filterBoxLabel",value:function(e,t){var n=It(rn(e)),r=It(rn(t));return this.getI18N(Oi["filterBox".concat(n).concat(r)])}}],n&&cs(t.prototype,n),r&&cs(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function hs(e){return hs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hs(e)}function ps(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ys(r.key),r)}}function ys(e){var t=function(e,t){if("object"!==hs(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==hs(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===hs(t)?t:String(t)}function vs(e){return vs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vs(e)}var gs=["id","type"];function ms(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bs(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ms(Object(n),!0).forEach((function(t){ks(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ms(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ks(e,t,n){return(t=Fs(t))in e?Object.definePropertction(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Cs(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||xs(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ls(e){return function(e){if(Array.isArray(e))return Ms(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||xs(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xs(e,t){if(e){if("string"==typeof e)return Ms(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ms(e,t):void 0}}function Ms(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Fs(r.key),r)}}function Fs(e){var t=function(e,t){if("object"!==vs(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==vs(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===vs(t)?t:String(t)}function Os(e,t){return Os=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Os(e,t)}function Ss(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Es(e);if(t){var i=Es(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===vs(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function Es(e){return Es=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Es(e)}var Is=Ft,As=Qt,Ts={click:{type:"click",dom:!0}};function Ds(){return{highlightedFeatures:[],selectedFeature:void 0,featuresOver:new Map,inBounds:{product:[],property:[],place:[]},routes:[],routeDestinations:[],polygons:[]}}var Bs=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Os(e,t)}(o,e);var t,n,r,i=Ss(o);function o(e,t,n,r){var a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(a=i.call(this)).eventsManager=t,a.features=n,a.mapData=r,a.boundsComputation=new Ho,a.listenersToDeregister=[],a.copyrightsDiv=a.createCopyrightsDiv(),a.copyrights=new Map,a.popup=void 0,a.ignoreMapClickEvent=!1,a.configHelper=e,a.settings=a.configHelper.loadMapSettings(),a.logger=a.configHelper.logger("BaseMap"),a.logger.debug("BaseMap constructor"),a.featureTypes=a.settings.featureTypes,a.clusterFactory=new Yr;var s=!1;return a._newFilterManager(s),a._newKeyboardFeatures(s),a._newRouteManager(),a._newClusterers(),a._newAvailabilityCheck(),a._newContentProviders(),a._newCollisionManagement(s),a.tilesLoader=void 0,a}return t=o,n=[{key:"_newKeyboardFeatures",value:function(e){this.keyboardFeatures&&this.keyboardFeatures.removeAllUIElements(),this.settings.isKeyboardFeaturesDefined?(this.keyboardFeatures=new so(this.settings.keyboardFeaturesIcon,this.settings.getI18N),e&&this._initializeKeyboardFeatures(this.keyboardFeatures)):this.keyboardFeatures=void 0}},{key:"_initializeKeyboardFeatures",value:function(e){var t=this;e.init({node:this.node,uniqId:this.uniqId.bind(this),containerBounds:this.containerBounds.bind(this),listFeatures:this._listFeatures.bind(this),cloneMarker:this.cloneMarker.bind(this),zIndexes:this.settinIndex,getMapNavFocusElement:function(){return t.mapNavFocusElement},registerListenerOnMapFocusElement:this.registerListenerOnMapFocusElement.bind(this),handleMarkerClick:this.handleMarkerClick.bind(this),isFeatureSelected:this.isFeatureSelected.bind(this),clearSelectedFeature:this.clearSelectedFeature.bind(this)}),this.settings.isKeyboardFeaturesEnabled&&(this.turnKeyboardFeaturesMode(!0),e.updateKeyboardFeatures())}},{key:"_updateMarkerPosition",value:function(){var e;null===(e=this.collisionManagement)||void 0===e||e.updateMarkerPosition(this.features.all())}},{key:"_newAvailabilityCheck",value:function(){this.availabilityCheck=new Fi(this.settings.loggerFactory,this.settings.availabilityProvider)}},{key:"_newContentProviders",value:function(){this.settings.isAnyContentProviderExists?this.contentProvider=new Po(this.settings.loggerFactory,this.featureTypes,this.settings.contentProvidersByFeatureType,this.settings.contentProvidersConfigs):this.contentProvider=void 0}},{key:"_newRouteManager",value:function(){this.routes=new vi({logger:this.settings.loggerFactory("RoutesRepository"),egDistances:this.configHelper.egDistances(),routeLineStyleByDistanceMode:this.settings.routeLineStyleByDistanceMode,routeCacheInMs:this.settings.routeCacheInMs,findFeature:this._findFeature.bind(this),eventsManager:this.eventsManager,addRouteOnMap:this.addRouteOnMap.bind(this),removeRouteOnMap:this.removeRouteOnMap.bind(this),asKey:this.asKey},this.mapData.routes,this.mapData.routeDestinations)}},{key:"_newPolygonManager",value:function(){this.polygonsManager=new Ci({logger:this.settings.loggerFactory("PolygonRepository"),findFeature:this._findFeature.bind(this),addPolygonsOnMap:this.addPolygonsOnMap.bind(this),removePolygonsOnMap:this.removePolygonsOnMap.bind(this),asKey:this.asKey,polygons:this.mapData.polygons,polygonStyles:this.settings.polygonStyles})}},{key:"_updateTilesConfig",value:function(){var e,t=this;this.features.allExceptClusters().forEach((function(e){e.hasUserData()?e.hasTileData()&&e.removeTileData():t.features.delete(e.id,e.type)}));var n=this.getBounds(),r=n.sw,i=n.ne,o=this.getTileDim(),a=o.width,s=o.height,u=this.getZoom(),l=Or(r[0],r[1],i[0],i[1],u,a,s);null===(e=this.tilesLoader)||void 0===e||e.instantiateTilesProvider(this.settings),l.forEach((function(e){var n=e.x,r=e.y;return setTimeout((function(){var e;return null===(e=t.tilesLoader)||void 0===e?void 0:e.loadTile(n,r,Math.floor(u))}),10)}))}},{key:"_newFilterManager",value:function(e){this.filterManager&&this.filterManager.removeAllUIElements(),this.settings.filter.isOneFilterAvailable?(this.filterManager=new ds({getFeatureStatus:this.settings.getFeatureStatus,filter:this.settings.filter,markerTypes:this.settings.markerTypes,icons:this.settings.icons,getI18N:this.settings.getI18N,addEventListener:this.addEventListener.bind(this),uniqId:this.uniqId.bind(this),eventClick:Ts.click,readParam:this.configHelper.readParam.bind(this.configHelper),writeParam:this.configHelper.writeParam.bind(this.configHelper),eventsManager:this.eventsManager}),e&&this._initializeFilterManager(this.filterManager)):this.filterManager=void 0}},{key:"_initializeFilterManager",value:function(e){e.init({node:this.node,updateViewport:this._updateViewport.bind(this)})}},{key:"_newCollisionManagement",value:function(e){this.collisionManagement=new Ta,e&&this._initializeCollisionManagement(this.collisionManagement)}},{key:"_initializeCollisionManagement",value:function(e){e.init({asKey:this.asKey.bind(this),getMarkerComponent:this.getMarkerComponent.bind(this),getRectOfMarker:this.getRectOfMarker.bind(this),moveMarkerPosition:this.moveMarkerPosition.bind(this),makeMarkerVisible:this._makeMarkerVisible.bind(this),settings:this.settings})}},{key:"_newClusterers",value:function(){this.clusterers=this.clusterFactory.createClusterers(this.settings.loggerFactory,this.settings.clusterConfigurationByType,this.settings.;null===(t=this.filterManager)||void 0===t||t.syncFilterChecked(e)}},{key:"updateConfiguration",value:function(e,t,n){this.configHelper=e,this.settings=t;var r=n.clearHashkeys,i=n.updateMarkers,o=n.updateViewport,a=n.updateMapProviderConfig,s=n.updateFiltersUI,u=n.updateKeyboardA11yUI,l=n.updateStyling,c=n.updateTiles,f=n.resetAvailabilityCheck,d=n.resetClusterers,h=n.resetCollisionManagement,p=n.resetContentProviders,y=n.resetRouteManagement,v=n.resetPolygonManagement,g=!0;if(a&&this.updateMapProviderConfig(),c&&this._updateTilesConfig(),r&&this.clearHashkeys(),f&&this._newAvailabilityCheck(),d&&this._newClusterers(),y){var m,b=null===(m=this.routes)||void 0===m?void 0:m.listRegisteredRoutes();this.resetRouteStyle(),this._newRouteManager(),this.syncRegisteredRoutes(b),this.updateRoutesOnViewport()}return v&&(this.resetRouteStyle(),this._newPolygonManager(),this.updateRoutesOnViewport()),p&&this._newContentProviders(),h&&this._newCollisionManagement(g),s&&(this.syncFilterChecked(this.configHelper),this._newFilterManager(g)),u&&this._newKeyboardFeatures(g),l&&this._addCssStyleFromConfig(this.settings.styling),Qn.getDebugConfigEnabled()&&console.debug("Configurations updated",this.configHelper.getEGMapConfigurations()),i&&this.clearMarkers(),o?this._updatr e;null===(e=this.routes)||void 0===e||e.updateRoutesOnViewport()}},{key:"syncRegisteredRoutes",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t&&t.forEach((function(t){var n;return null===(n=e.routes)||void 0===n?void 0:n.registerRoute(t.origin,t.destination,t.polyline)}))}},{key:"initMap",value:function(e,t,n,r){var i=this;this.logger.debug("map is initializing");var o=Date.now();this.node=e,this.cssClassId=t,this.idPrefix="".concat(this.node.id,"_"),this._addCssStyleFromConfig(this.settings.styling),this.collisionManagement&&this._initializeCollisionManagement(this.collisionManagement);var a=null==n?void 0:n.options,s=null==a?void 0:a.gaiaId;return Qn.getDebugConfigEnabled()&&console.debug("Configurations used",this.configHelper._loadHistoricalBoundingBox(s).then((function(){return i.init(n,r)})).then((function(){return i._lateInit()})).then((function(){i.logger.debug("map initialized in ".concat(Date.now()-o,"ms"))}))}},{key:"_lateInit",value:function(){var e=this,t=new Set([].concat(Ls(Wr(this.settings.icons)),Ls(qr(this.settings.cornerIcons)),Ls(qr(this.settings.innerIcons)))),n=Hr(Ls(t));return this._newPolygoures),e.filterManager&&e._initializeFilterManager(e.filterManager)}))}},{key:"createCopyrightsDiv",value:function(){var e=ge(this.uniqId("copyrights-div"),this.node,htsDiv),e}},{key:"uniqId",value:function(e){return this.idPrefix+e}},{key:"cloneObfuscatedPolygon",value:function(e,t){var n,r,i,o,a,s=Is(this.settings.obfuscateStyle[e.type],e.hashKeys),u=Xt(null==s||null===(n=s.line)||void 0===n?void 0:n.opacity),l=Xt(null==s||null===(r=s.fill)||void 0===r?void 0:r.opacity),c=t.cloneNode(!0);rt(c,"markerClone");var f="".concat(null==s||null===(i=s.fill)||void 0===i?void 0:i.color).concat(l),d="".concat(null==s||null===(o=s.line)||void 0===o?void 0:o.weight,"px"),h="".concat(null==s||null===(a=s.line)||void 0===a?void 0:a.color).concat(u);return c.dataset.cloneStyles="--fillcolor:".concat(f,"; --linewidth:").concat(d,"; --linecolor:").concat(h,";"),c}},{key:"_loadHistoricalBoundingBox",value:function(e){var t=this;return e?Zn(this.settings.historicalBoundingBoxDataEndpoint,5e3).then((function(n){return n.ok?n.json().then((function(n){if(n.errors)return t.logger.error("Failed to fetch historical bounding box data for gaia Id: esolve();var r=n.find((function(t){return t.gaia_id===e.toString()}));return null!=r&&r.historical_polygon_wkt&&(t.historicalBoundingBox=an(r.historical_polygon_wkt)),Promise.resolve()})):Promise.resolve()})):Promise.resolve()}},{key:"_computeNativeBounds",value:function(e,t,n){var r,i=this.node&&0!==(null===(r=this.node)||void 0===r?void 0:r.clientWidth)?this.node.clientHeight/this.node.clientWidth:1,o=(null==n?void 0:n.centeredOn)?this.boundsComputation.computeCenteredBoundingBox(e,n,i):this.boundsComputation.computeBoundingBox(e,t,n,this.historicalBoundingBox,i);return this.computeNativeBoundsFromLatLongs(o)}},{key:"_parseClientPadding",value:function(e){try{if(this.node)return cn(e,this.node)}catch(e){this.logger.error(e.message,e.stack)}}},{key:"boundsContaining",value:function(e,t,n){var r=this,i=null==n?void 0.then((function(){return r.asBounds(r._computeNativeBounds(o,t,n))})):Promise.resolve(this.asBounds(this._computeNativeBounds(o,t,n)))}},{key:"boundsContainingPolygon",value:function(e){var t=Vt(Vr(e).flat(2));return this.asBounds(t{return this.asBounds(this.computeNativeBoundsFromLatLongs(Vt(e)))}},{key:"handleBoundsChanged",value:function(e){var t=this;if(this.logger.debug("bounds changed"),this.boundChangedDisabled)this.boundChangedDisabled=!1;else{var n=this.getBounds();if(n)return this._updateViewport().then((function(){var r={bounds:n,zoom:t.getZoom(),originalEvent:e};t.eventsManager.pushEvent(oi.boundsChanged,r)}))}return Promise.resolve()}},{key:"getCirclePolygonData",value:function(e){var t=Is(this.settings.obfuscatePrecision[e.type],e.hashKeys),n=Is(this.settings.obfuscateRadiusInMeters[e.type],e.hashKeys);return k([e.latLng[1],e.latLng[0geometry.coordinates[0].map((function(e){return{lat:e[1],lng:e[0]}}))}},{key:"setStay",value:function(e){var t;if(!function(e){return void 0!==e.from&&void 0!==e.to&&e.roomOccupancies.length>0&&e.roomOccupancies.every((function(e){return function(e){return e.nbAdults>0}(e)}))}(e))throw new Error("stay is not valid");null!==(t=this.availabilityCheck)&&void 0!==t&&t.saveStay(e)&&(this.cleanAvailabilityTileData(this.features.allProperties()),this._updateViewport())}},{key:"_addCssStyleFromConfig",value:function(e){this.currentStyleId&&de(this.currentStyleId),e&&Object.keys(e).length>0&&this.cssClassId?(this.currentStyleId=this.uniqId("style"),Pt(this.currentStyleId,"EgMapsStyling",this.cssClassId,e)):this.currentStyleId=void 0}},{key:"cleanAvailabilityTileData",value:function(e){e.forEach((function(e){e.hasTileData()&&(e.tileData.))}},{key:"refresh",value:function(){return this._updateViewport()}},{key:"updateProductsAvailability",value:function(e){var t,n=this;return null===(t=this.availabilityCheck)||void 0===t?void 0:t.updateAvailability(e).then((function(e){return e.forEach((function(e){return n._fixMarkerToUse(e)}))}))}},{key:"updatePropertiesAvailability",value:function(e){var t,n=this;return null===(t=this.on(e){return e.forEach((funvalue:function(){var e=this.nativeBounds();return this.asBounds(e)}},{key:"_actionOnPreviousMarker",value:function(e){return function(t){return{hideRoute:Is(e[t.type],t.hashKeys).some((function(e){return"showRoutes"===e})),dehighlight:Is(e[t.type],t.hashKeys).some((function(e){retIs(e[t.type],t.hashKeys).some((function(e){return"addAriaLive"===e}))}}}},{key:"handleMapClick",value:function(){var e=this;this.logger.debug("map click"),!0!==this.ignoreMapClickEvent?(this.settings.actionsOnMapClick.includes("removeAriaLive")&&this._updateAriaLiveOnFeature(this._getFeatureSelected(),!1),this.settings.actionsOnMapClick.forEach((function(t){var n;switch(t){case"clearHighlight":e._dehighlightFeatures();break;case"clearSelection":e.setSelectedFeature(void 0,e._actionOnPreviousMarker(e.settings.actionsOnMarkerClick),!0);break;case"closePopup":e._closePopup();break;case"hideRoutes":null===(n=e.routes)||void 0===n||n.hideRoutes()}}))):this.ignoreMapClickEvent=!1}},{key:"_updateAriaLiveOnFeature",value:function(e,t){var n;e&&(t?(e.marker||this._makeMarkerVisible(e,!0),Fe(e.marker.ariaElement)&&Ie(e.marker.ariaElement)):Ae(null===(n=e.marker)||void 0===n?void 0:n.ariaElement))}},{key:"handleMarkerClick",value:function(e,t,n){var r,i=this;this.logger.debug("marker click");var o,a=e;if(a||"popup"!==t||(a=null===(o=this.popup)||void 0===o?void 0:o.feature),null!==(r=a)&&void 0!==r&&r.visible){var s=this.isFeatureSelected(a),u=this._isFeatureHighlighted(a),l=Is(this.settings.actionsOnMarkerClick[a.type],a.hashKeys);if(l.forEach((function(e){var t;switch(e){case"highlight":u||i._setHighlightedFeature(a);break;case"select":i.setSelectedFeature(a,i._actionOnPreviousMarker(i.settings.actionsOnMarkerClick),!0);break;case"toggleSelect":i.setSelectedFeature(s?void 0:a,i._actionOnPreviousMarker(i.settings.actionsOnMarkerClick),!0);break;case"openPopup":i._openPopup(a);break;case"closePopup":i._closePopup();break;case"zoomToExtent":var n=a;i._zoomToExtent(n.children);break;case"showRoutes":null===(t=i.routes)||void 0===t||t.showRoutes(a);break;case"loadFeatureContent":s||i.loadFeatureContent(a.id,a.type)}})),l.includes("addAriaLive")){var c=a;s?l.includes("toggleSelect")&&this._updateAriaLiveOnFeature(c,!1):this._updateAriaLiveOnFeae:function(e){var t=e.id,n=e.type;return"".concat(n,"-").concat(t)}},{key:"_setPopupVisible",value:function(e){var t,n;e?Ue(null===(t=this.popup)||void 0===t?void 0:t.visibleElement):Ve(null===(n=this.popu:"_findFeature",value:function(e,t){return this.features.find(e,t)}},{key:"setPopupContent",value:function(e,t,n){var r=this._findFeature(e,t);r&&(r.popupContent=n)}},{key:"_openPopup",value:function(e){if(this.popup){var t;if(e&&void 0===e.popupContent&&e.name){var n=ge(this.uniqId("popup-div"),void 0,"default-popup-content");Pe(this.uniqId("popup-span"),n,void 0,void 0,e.name),e.popupContent=n}if(void 0!==this.popup.feature&&this.popup.feature===e||(this.popup.feature=e),null!==(t=this.popup.feature)&&void 0!==t&&t.popupContent){this._fillPopupContent(this.popup.feature),this._setPopupVisible(!0),this.updatePopupPositionOnLayer();var r=this.configHelper.popupVisibilities()[this.popup.feature.type];Is(r,this.popup.feature.hashKeys)&&this.ensurePopupVisibility()}else this._fillPopupContent(),this._setPopupVisible(!1)}}},{key:"_calculatePopupVisibilityOffsetValues",value:function(e,t,n,r,i,o,a,s){var u=0,l=0;return e.x<-0+t?u=e.x+0-t:e.x+o+0+t>r&&(u=e.x+o+0+t-r),s?e.y<-2+n+a?l=e.y+2-n-a:e.y+2+n>i&&(l=e.y+2+n-i):e.y<-2+n?l=e.y+2-n:e.y+a+2+n>i&&(l=e.y+a+2+n-i),[u,l]}},{key:"_closePopup",value:function(){this.popup&&(delete this.popup.feature,this._fillPopupContent(),this._setPopupVisible(!1))}},{key:"_fillPopupContent",value:function(e){if(this.popup)if(fe(this.popup.content),e&&e.popupContent){this.popup.content.appendChild(e.popupContent);var t=this.popup.backupStyleClass,n=Is(this.settings.popupPositions[e.type],e.hashKeys),r=[e.type,e.status,n];e.qualifiers&&r.push.apply(r,Ls(e.qualifiers)),this.popup.backupStyleClass=r,tt(this.popup.cssElement,t,this.popup.backupStyleClass)}else{var i=this.popup.backupStyleClass;this.popup.backupStyleClass=void 0,tt(this.popup.cssElementxternally",value:function(e,t){e.popupContent=t,this._openPopup(e)}},{key:"isFeatureSelected",value:function(e){var t,n;return void 0!==e&&(null===(t=this.mapData.selectedFeature)||void 0===t?void 0:t.id)===(null==e?void 0:e.id)&&(null===(n=this.mapData.selectedFeature)||void 0===n?void 0:ull===(e=this._getFeatureSelected())||void 0===e?void 0:e.toData()}},{key:"_getFeatureSelected",value:function(){if(this.mapData.selectedFeature){var e=this.mapData.selectedFeature,t=e.id,n=e.type;return this._findFeature(t,n)}}},{key:"setSelectedFeature",value:function(e,t,n){if(!this.isFeatureSelected(e)){var r=this._getFeatureSelected();if(e){var i=e.id,o=e.type;this.mapData.selectedFeature={id:i,type:o}}else this.mapData.selectedFeature=void 0;if(null!=r&&r.marker){var a=r.status,s=r.qualifiers,u=As(a,!1,s),l=Is(this.settings.zIndexes[r.type],u);Xa(r.marker,l)}if(e&&e.marker){var c=e.status,f=e.qualifiers,d=As(c,!0,f),h=Is(this.settings.zIndexes[e.type],d);Xa(e.marker,h)}if(r){var p,y=t(r),v=y.hideRoute,g=void 0!==v&&v,m=y.dehighlight,b=void 0!==m&&m,k=y.removeAriaLive,w=void 0!==k&&k;g&&(null===(p=this.routes)||void 0===p||p.hideRoutes(r)),b&&this._dehighlightFeature(r),w&&this._updateAriaLiveOnFeature(r,!1)}if((e||r)&&n){var P,C=this.fillPopupExternally.bind(this,e);if(e?P={action:"select",feature:e.toData(),setPopupContent:C,previousSelectedFeature:null==r?void 0:r.toData()}:r&&(P={action:"clearSelection",feature:r.toData(),setPopupContent:C}),this.keyboardFeatures){var L=this.keyboardFeatures;setTimeout((function(){return L.updateKeyboardFeatures()}),50)}P&&this.eventsManager.pushEvent(oi.selectionChanged,P)}}}},{key:"_zoomToExtent",value:function(e){var t=this;if(e&&e.length>0){var n=e.map((function(e){return e.properties.latLng}));this.boundsContai!1).then((function(){return t.handleBoundsChanged("clusterExtent")}))}))}}},{key:"handleMarkerMouseOver",value:function(e,t,n){var r=this,i=e;if(!i&&"popup"===t&&this.popup&&(i=this.popup.feature),i&&i.visible&&i.type){var o=this.asKey(i),a=this.mapData.featuresOver.has(o);this.mapData.featuresOver.set(o,t),a||Is(this.settings.actionsOnMarkerMouseOver[i.type],i.hashKeys).forEach((function(e){switch(e){case"highlight":r._setHighlightedFeature(i);break;case"openPopup":r._openPopup(i);break;case"sendEvent":var t={action:"mouseEnter",feature:i.toData(),setPopupContent:r.fillPopupExternally.bind(r,i)};r.eventsManager.pushEvent(oi.hoverChanged,t)}}))}}},{key:"handleMarkerMouseOut",value:function(e,t,n){var r=this,i=e;if(!i&&"popup"===t&&this.popup&&(i=this.popup.feature),i&&i.visible){var o=this.asKey(i);this.mapData.featuresOver.get(o)===t&&(this.mapData.featuresOver.delete(o),Is(this.settings.actionsOnMarkerMouseOut[i.type],i.hashKeys).forEach((function(e){switch(e){case"dehighlight":r._dehighlightFeature(i);break;case"dehighlightIfNotSelected":r.isFeatureSelected(i)||r._dehighlightFeature(i);break;case"sendEvent":var t={action:"mouseLeave",feature:i.toData(),setPopupContent:r.fillPopupExternally.bind(r,i)};r.eventsManager.pushEvent(oi.hoverChanged,t);break;case"closePopup":r._closePopup()}})))}}},{key:"handleDragStart",value:function(){var e=this;this.settings.actionsOnMapDrag.includes("removeAriaLive")&&this._updateAriaLiveOnFeature(this._getFeatureSelected(),!1),this.settings.actionsOnMapDrag.forEach((function(t){var n;switch(t){case"clearHighlight":e._dehighlightFeatures();break;case"clearSelection":e.setSelectedFeature(void 0,e._actionOnPreviousMarker(e.settings.actionsOnMarkerClick),!0);break;case"closePopup":e._closePopup();break;case"hideRoutes":null===(n=e.routes)||void 0===n||n.hideRoutes()}}))}},{key:"selectFeature",value:function(e,t,n){var r=this,i=this._findFeature(e,t);if(i&&!this.isFeatureSelected(i)){var o=Is(this.settings.actionsOnFeatureSelect[i.type],i.hashKeys);this.setSelectedFeature(i,this._actionOnPreviousMarker(this.settings.actionsOnFeatureSelect),!1),n&&this.setPopupContent(i.id,i.type,n),o.includes("addAriaLive")&&this._updateAriaLiveOnFeature(i,!0),o.forEach((function(e){var t;switch(e){case"highlight":r._setHighlightedFeature(i);break;case"openPopup":r._openPopup(i);break;case"closePopup":r._closePopup();break;case"showRoutes":null===(t=r.routes)||void 0===t||t.showRoutes(i);break;case"showLinkedFeatures":r.loadFeatureContent(i.id,i.type)}})),o.includes("bounce")&&Ya(i.marker)}}},{key:"registerRouteDestination",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return null===(e=this.routes)||void 0===e?void 0:e.registerRouteDestination.apply(e,n)}},{key:"registerRoute",value:function(e,t,n){var r;return!0===(null===(r=this.routes)||void 0===r?void 0:r.registerRoute(e,t,n))}},{key:"listRegisteredRouteDestinations",value:function(){var e;return(null===(e=this.routes)||void 0===e?void 0:e.listRegisteredRouteDestinations())||[]}},{key:"listRegisteredRoutes",value:function(e){var t;return(null===(t=this.routes)||void 0===t?void 0:t.listRegisteredRoutes(e))||[]}},{key:"deregisterRouteDestination",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(null===(e=this.routes)||void 0===e?void 0:e.deregisterRouteDestination.apply(e,n))||[]}},{key:"deregisterRoute",value:function(e,t){var n;return(null===(n=this.routes)||void 0===n?void 0:n.deregisterRoute(e,t))||[]}},{key:"showRoutes",value:function(e,t){if(!this.routes)return Promise.reject(new Error("map is not initialized"));var n=this._findFeature(e,t);if(n){for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];return this.routes.showRoutes(n,i,!1)}return Promise.reject(new Error("feature ".concat(t,"-").concat(e," is not found")))}},{key:"showPolygons",value:function(){var e;return(e=this.polygonsMr e;return(e=this.polygonsManager).hidePolygons.apply(e,arguments)}},{key:"listPolygonsDisplayed",value:function(){return this.polygonsManager.listPolygonsDisplayed()}},{key:"addQualifierToFeature",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return this._updateQualifierFromFeatures.apply(this,[[{id:e,type:t}],function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.addQualifier.apply(e,n)}].concat(r))}},{key:"addQualifierToFeatures",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this._updateQualifierFromFeatures.apply(this,[e,function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.addQualifier.apply(e,n)}].concat(n))}},{key:"removeQualifierFromFeature",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return this._updateQualifierFromFeatures.apply(this,[[{id:e,type:t}],function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.removeQualifier.apply(e,n)}].concat(r))}},{key:"removeQualifierFromFeatures",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]==1;r<t;r++)n[r-1]=arguments[r];return e.removeQualifier.apply(e,n)}].concat(n))}},{key:"_updateQualifierFromFeatures",value:function(e,t){for(var n=this,r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];var a=!1;return e.forEach((function(e){var r=e.id,o=e.type,s=n._findFeature(r,o);s&&t.apply(void 0,[s].concat(i))&&(n._fixMarkerToUse(s),a=!0)})),a?this._updateViewport().then((function(){return!0})):Promise.resolve(!1)}},{key:"loadFeatureContent",value:function(e,t){var n,r=this,i=null===(n=this.contentProvider)||void 0===n?void 0:n.getFeatureProviders()[t];if(i){var o=[];return Object.keys(i).forEach((function(n){var a=new Promise((function(o,a){i[n].loadFeatureContent(e,t).then((function(n){var i=n.linkedFeatures,a=r.features.allExceptClusters().filter((functionme((function(e){return-1!==e.toSlter((function(e){return!a.find((function(t){return e.id===t.id}))}));null==s||s.forEach((functionlter((function(e){return a.find((function(t){return t.id===e.id}))}));null==u||u.forEach((function(n){n.qualifiers.includes("linked-features-".concat(e,"-").concat(t))||n.qualifiers.pushch((function(e){return r.fegHelper)})),r.features.all().filter((functiram("markers,place,show,linked-features-".concat(e,"-").concat(t))})),r.configHelper.writeParam("markers,place,show,linked-features-".concat(e,"-").concat(t),!0),r._updateViewport().then((function(){var i={success:!0,id:e,type:t,content:n};r.eventsManager.pushEvent(oi.featureContentLoaded,i),o(void 0)}))})).catch((function(e){var t={success:!1,error:e};r.eventsManager.pushEvent(oi.featureContentLoaded,t),a(e)}))}));o.push(a)})),Hn(o)}return Promise.reject(new Error("content provider is not enabled"))}},{key:"hideRoutes",value:function(e,t){if(!this.routes)return Promise.reject(new Error("map is not initialized"));var n=this._findFeature(e,t);if(n){for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];return this.routes.hideRoutes(n,i,!1)}return Promise.reject(new Error("feature ".concat(t,===(e=this.routes)||void 0===e?void 0:e.listRoutesDisplayed())||[]}},{key:"handleTilesLoaded",value:function(e,t,n){this.logger.debug("".concat(e," tiles loaded - ").concat(t," - ").concat(n));var r={origin:e,contentType:t,tileIds:n};this.eventsManager.:function(e){this.eventsManager.pushEvent(oi.tilesContentLoaded,e)}},{key:"addCopyright",value:function(e,t){var n=ze(this.copyrightsDiv),r=Ls(this.copyrights.entries()).filter((function(e){var n=Cs(e,2);return n[0],n[1].content===t}));if(r.length>0)r[0][1].ownerIds.push(e);else{var i=Jt(),o=this.uniqId("copyright-div-".concat(i));this.copyrights.set(o,{content:t,ownerIds:[e]}),Pe(void 0,ge(o,this.copyrightsDiv,"copyright"),"copyright-text",void 0,t),n||Ue(this.copyrightsDiv)}}},{key:"removeCopyrightForOwner",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach((function(t){Ls(e.copyrights.entries()).forEach((function(n){var r=Cs(n,2),i=r[0],o=r[1].ownerIds,a=o.findIndex((function(e){return e===t}));a>=0&&(o.splice(a,1),0==o.length&&(he(e.copyrightsDiv,i),e.copyrights.delete(i)))}))}))}},{key:"clearSelectedFeature",value:function(){var e=this,t=this._getFeatureSelected();if(t){this.setSelectedFeature(void 0,this._actionOnPreviousMarker(this.settings.actionsOnFeatureSelect),!1);var n=Is(this.settings.actionsOnFeatureDeselect[t.type],t.hashKeys);if(n.includes("removeAriaLive")&&this._updateAriaLiveOnFeature(t,!1),n.forEach((function(n){var r;switch(n){case"dehighlight":e._dehighlightFeature(t);break;case"closePopup":e._closePopup();break;case"hideRoutes":null===(r=e.routes)||void 0===r||r.hideRoutes(t)}})),this.keyboardFeatures){var r=this.keyboardFeatures;setTimeout((function(){return r.updateKeyboardFeatures()}),50)}}}},{key:"markFeatureOver",value:function(e,t){var n=this,r=this._findFeature(e,t);r&&Is(this.settings.actionsOnFeatureOver[r.type],r.hashKeys).forEach((function(e){switch(e){case"highlight":n._setHighlightedFeature(r);break;case"openPopup":n._openPopup(r)}}))}},{key:"markFeatureOut",value:function(e,t){var n=this,r=this._findFeature(e,t);r&&Is(this.settings.actionsOnFeatureOut[r.type],r.hashKeys).forEach((function(e){switch(e){case"dehighlight":n._dehighlightFeature(r);break;case"dehighlightIfNotSelected":n.isFeatureSelected(r)||n._dehighlightFeature(r);break;case"closePopup":n._closePopup()}}))}},{key:"highlightMarker",value:function(e,t){e.highlighted=t,this._fixMarkerToUse(e)}},{key:"_setHighlightedFeature",value:function(e){if(!this._isFeatureHighlighted(e)){var t=e.id,n=e.type;this.mapData.highlightedFeatures.push({id:t,type:n}),this.highlightMarker(e,!0)}}},{key:"_dehighlightFeature",value:function(e){var t=this._getFeatureHighlightIndex(e);t>=0&&(this.mapData.highlightedFeatures.splice(t,1),this.highlightMarker(e,!1))}},{key:"_getFeatureHighlightIndex",value:function(e){varres.findIndex((function(e){var r=e.id,ited",value:function(e){return this._getFeatureHighlightIndex(e)>=0}},{key:"_dehighlightFeatures",value:function(){var e=this;this.mapData.highlightedFeatures.forEach((function(t){var n=t.id,r=t.type,i=e._findFeature(n,r);i&&e.highlightMarker(i,!1)})),this.mapData.highlightedFeatures=[]}},{key:"turnFeaturesVisible",value:function(e,t,n,r,i){var o;null===(o=this.filterManager)||void 0===o||o.turnFeaturesVisible(e,t,n,r,i)}},{key:"_createGenericPopup",value:function(e){var t=this,n=ge(this.uniqId("popup"),e,"popup","visibility:false"),r=ge(void 0,n,"popup-close-button close-button");ge(void 0,r,"leftright"),ge(void 0,r,"rightleft"),ge(void 0,r,"close");var i=this._closePopup.bind(this);n.content=ge(void 0,n,"popup-content");var o=this.updatePopupPositionOnLayer.bind(this);return new ResizeObserver(o).observe(n.content),n.clean=[this.addEventListener(r,Ts.click,(function(e){var n;e.stopPropagation(),null!==(n=t.popup)&&void 0!==n&&n.feature&&t.mapData.featuresOver.delete(t.asKey(t.popup.feature)),i()}))],n.visibleElement=void 0,n.cssElement=void 0,n}},{key:"_createHtmlClusterMarker",value:function(e,t,n,r,i,o){var a=ge(this.uniqId("marker-".concat(r,"-cluster-").concat(t.id)),e,"cluster-marker cluster-".concat(r,"-marker ").concat(null==i?void 0:i.split("#").join(" ")),"position:absolute;visibility:false;".concat(o||"")),s=Pe(void 0,a,"cluster-label");return Pe(void 0,s,"cluster-label-content",void 0,this._createClusterLabel(t,n)),a.cssElement=a,{main:a,span:s}}},{key:"_createClusterLabel",value:function(e,t){if(void 0!==e.minPrice&&-1!==this.configHelper.getI18N(t,e.children.length).indexOf("{1}")){var n=this.settings,r=n.iso4217CurrencyCode,i=n.locale,o=gn(e.minPrice,void 0,r,i);return this.configHelper.getI18N(t,e.children.length,o)}return this.configHelper.getI18N(t,e.children.length)}},{key:"_createClusterMarker",value:function(e,t,n,r,i,o){var a=this._createHtmlClusterMarker(e,t,n,r,i,o),s=a.main,u=a.span;return s.bounceElement=u,s.cssElement=s,s}},{key:"_clearClusters",value:function(e){var t=this;this.features.allClusters().filter((function(t){var n;return null===(n=t.marker)||void 0===n?void 0:n.cssElement.classList.contains("cluster-".concat(e,"-marker"))})).forEach((function(e){t._deleteFeatureMarker(e),t.features.delete(e.id,e.type)}))}},{key:"_pushClusterData",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=Ps(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;n?this.features.upsertUserData(i,this.configHelper):this.features.upsertTileData(i,this.configHelper)}}catch(e){r.e(e)}finally{r.f()}}},{key:"_updateViewport",value:function(e){var t,n=this.configHelper.visibilityBooleanByStatus(),r=e;return r||(r=this.nativeBounds()),null!==(t=this.availabilityCheck)&&void 0!==t&&t.isAvailabilityCheckActive()?this._updateViewportWithAvailabilityCheck(n,r):this._updateViewportAux(n,r)}},{key:"_updateViewportAux",value:function(e,t){var n=this;this.boundsToRefresh=this.asBounds(t);var r=[];return r.push(new Promise((function(r){n.changeProductMarkersVisible(t,e.product),r(void 0)}))),r.push(new Promise((function(r){n.changePropertyMarkersVisible(t,e.property),r(void 0)}))),r.push(new Promise((function(r){n.changePlaceMarkersVisible(t,e.place),r(void 0)}))),Promise.all(r).then((function(){var e=n.getBounds();return e&&n.boundsT=n.keyboardFeatures)||void 0===e?void 0:e.updateKeyboardFeatures()}),100),n.collisionManagement&&n.collisionManagement.handleMarkerLabelCollision(n.features.all())),t}))}},{key:"_updateViewportWithAvailabilityCheck",value:function(e,t){var n=this;this.boundsToRefresh=this.asBounds(t);var r=[];r.push(this._updateViewportAux(e,t));var i=this.features.allProducts().filter((function(e){return n.isFeatureInRealBound(t,e)}));r.push(this.updateProductsAvailability(i).then((function(){var r=n.getBounds();if(r&&n.boundsToRefresh&&Ht(r,n.boundsToRefresh))return n.changeProductMarkersVisible(t,e.product),Promise.resolve()})).catch((function(e){n.logger.error("Failed to update availabilities: ".concat(e.message),e.stack)})));var o=this.features.allProperties().filter((function(e){return n.isFeatureInRealBound(t,e)}));return r.push(this.updatePropertiesAvailability(o).then((function(){var r=n.getBounds();if(r&&n.boundsToRefresh&&Ht(r,n.boundsToRefresh))return n.changePropertyMarkersVisible(t,e.property),Promise.resolve()})).catch((function(e){n.logger.error("Failed to update availabilities: ".concat(e.message),e.stack)}))),Promise.all(r).then((function(){var e=n.getBounds();return n.keyboardFeatures&&e&&n.boundsToRefresh&&Ht(e,n.boundsToRefresh)&&n.keyboardFeatures.updateKeyboardFeatures(),t}))}},{key:"_changeClusterMarkerVisibility",value:function(e,t,n,r){var i=this,o=this.getBounds(),a={clusters:[],remainingFeatures:t};this._clearClusters(e),this.clusterers&&this.clusterers[e].forEach((function(t){var r=t.clusterer,s=t.qualifier;if(r){try{var u,l,c,f,d={clientWidth:null!==(u=null===(l=i.node)||void 0===l?void 0:l.clientWidth)&&void 0!==u?u:0,clientHeight:null!==(c=null===(f=i.node)||void 0===f?void 0:f.clientHeight)&&void 0!==c?c:0};a=r.getClustersAndFeatures(a,e,s,o,n,d,i.getTileDim())}catch(e){i.logger.warn("Failed to compute cluster: ".concat(e.message),e.stack)}i._pushClusterData(a.clusters.map((function(e){return e.cluster})),!1)}})),aeatures.allClusters().find((function(t){return t.id===e.cluster.id}));t&&!t.marker&&(t.marker=i.createClusterMarkerWithClickListener(t,e.labelKey,e.featureType,e.qualifier))}));var s,u=a.remainingFeatures.map((function(e){return e.id})),l=Ps(t);try{for(l.s();!(s=l.n()).done;){var c=s.value;u.includes(c.id)&&(r.push(c.id),c.marker?c.visible=!0:this._makeMarkerVisible(c,!0))}}catch(e){l.e(e)}finally{l.f()}}},{key:"_haveSomeClustersByFeatureType",value:function(e){return void 0!==this.clusterers&&void 0!==this.clusterers[e]&&this.clusterers[e].length>0}},{key:"_changeMarkersVisibility",value:function(e,t,n){var r,i=this,o=this.getZoom();switch(n){case ca:r=this._updateProductsInBounds(e,t,o);break;case fa:r=this._updatePropertiesInBounds(e,t,o);break;case da:r=this._updatePlacesInBounds(e,t,o);break;default:r={oldInBounds:[],inBounds:[]}}var a=r,s=a.oldInBounds,u=a.inBounds,l=[];this._haveSomeClustersByFeatureType(n)?this._changeClusterMarkerVisibility(n,u,o,l):u.forEach((function(e){l.push(e.id),e.marker?e.visible=!0:i._makeMarkerVisible(e,!0)})),s.filter((function(e){return!l.includes(e.id)})).forEach((function(e){return i._makeMarkerVisible(e,!1)}))}},{key:"changeProductMarkersVisible",value:function(e,t){this._changeMarkersVisibility(e,t,ca)}},{key:"changePropertyMarkersVisible",value:function(e,t){this._changVisible",value:function(e,t){this._changeMarkersVisibility(e,t,da)}},{key:"_shouldFeatureBeDisplayed",value:function(e,t,n,r){var i,o=null===(i=e.tileData)||void 0===i?void 0:i.tile,a=o&&o.length>=3?o[2]:void 0;return(void 0===a||e.hasUserData()||a<=r)&&this.isFeatureInRealBound(t,e)&&Is(this.settings.minZoomForDisplay[e.type],e.hashKeys)<=r&&!1!==Is(n,[e.status])&&Is(n,e.hashKeys)}},{key:"_retrieveCandidates",value:function(e,t,n,r,i){for(var o=e.length,a=0;a<o;){var s=e[a];a++,this._shouldFeatureBeDisplayed(s,t,n,r)&&i(s)}}},{key:"_updateProductsInBounds",value:function(e,t,n){var r=Ls(this.mapData.inBounds.product),i=[],o=[],a=[],s=[],u={available:i,filtered:o,sold_out:a,unknown:s};this._retrieveCandidates(this.features.allProductsWithCoordinates(),e,t,n,(function(e){return u[e.status].push(e)}));var l=this.settings.threshold.product.default;return n>=this.settings.maxZoomForCount.product.default||i.length+o.length+a.length+s.length<=l?this.mapData.inBounds.product=i.concat(o.concat(a.concat(s))):i.length+o.length+a.length<=l?this.mapData.inBounds.product=i.concat(o.concat(a)):i.length+o.length<=l?this.mapData.inBounds.product=i.concat(o):i.length<=l?this.mapData.inBounds.product=i:this.mapData.inBounds.product=[],{oldInBounds:r,inBounds:this.mapData.inBounds.product}}},{key:"_updatePropertiesInBounds",value:function(e,t,n){var r=Ls(this.mapData.inBounds.property),i=[],o=[],a=[],s=[],u={available:i,filtered:o,sold_out:a,unknown:s};this._retiesWithCoordinates(),e,t,n,(function(e){return u[e.status].push(e)}));var l=this.settings.threshold.property.default;return n>=this.settings.maxZoomForCount.property.default||i.length+o.length+a.length+s.length<=l?this.mapData.inBounds.property=i.concat(o.concat(a.concat(s))):i.length+o.length+a.length<=l?this.mapData.inBounds.property=i.concat(o.concat(a)):i.length+o.length<=l?this.mapData.inBounds.property=i.concat(o):i.length<=l?this.mapData.inBounds.property=i:this.mapData.inBounds.property=[],{oldInBounds:r,inBounds:this.mapData.inBounds.property}}},{key:"_updatePlacesInBounds",value:function(e,t,n){var r=Ls(this.mapData.inBounds.place),i={selected:{threshold:1,maxZoomForCount:1,data:[]}};for(var o in this.settings.threshold.place){var a=Is(this.settings.maxZoomForCount.place,[o]);i[o]={threshold:this.settings.threshold.place[o],maxZoomForCount:a,data:[]}}this._retrieveCandidates(this.features.allPlacesWithCoordinates(),e,t,n,(function(e){return Is(i,e.hashKeys).data.push(e)}));var s=[];for(var u in i){var l=i[u],c=l.threshold,f=l.maxZoomForCount,d=l.data;d.length>0&&(n>=f||d.length<=c)&&(s=s.concat(d))}return this.mapData.inBounds.place=s,{oldInBounds:r,inBounds:this.mapData.inBounds.place}}},{key:"updateCon){this.features.all().forEach((on(){this.features.all().forEach((function(e){e.clearHashkeys()}))}},{key:"cleion(t){t.marker&&(e.removeMarkerFromMap(t.marker),delete t.marker)}))}},{key:"listFeatures",value:function(e,t){return this._listFeatures(e,t).map((function(e){return e.toData()}))}},{key:"_listFeatures",value:function(e,t){var n=this,r=this.features.all();if(t){var i=this.asNativeBounds(t.sw,t.ne);r=r.filter((function(e){return void 0!==e})).filter((function(e){return n.isFeatureInRealBound(i,e)}))}return e&&(r=r.filter(e)),r}},{key:"pushFeatureData",value:function(e,t,n){var r=this;this.logger.debug("push feature data");var i=[],o=[],a=[],s=[];this._pushFeatureDataModifyFeatures(e,i,a,o);var u=o.concat(i);switch(t){case"merge":if(a.length===e.length)return;break;case"replace":ExceptClusters().filter((function(e){return!l.includes(r.asKey(e))}));s=this._removePushedFeatureDataAux(c,!1);break;default:throw new Error("action ".concat(t," not supported"))}if(n&&this._pushFeatureDataHandleEvents(u,s),this.mapData.selectedFeature&&s.map(this.asKey).includes(this.asKey(this.mapData.selectedFeature))&&this.clearSelectedFeature(),u.length>0||s.length>0)return this._updateViewport(),this._computeStrictBounds(u.concat(a).filter((function(e){return void 0!==e.latLng})).map((function(e){return e.latLng})))}},{key:"_pushFeatureDataModifyFeatures",value:function(e,t,n,r){var i,o=Ps(e);try{for(o.s();!(i=o.n()).done;){var a=i.value,s=this.features.repository(a.type).find(a.id);if(s)if(s.isUserDataChanged(a)){var u=this.features.upsertUserData(a,this.configHelper);this._fixMarkerToUse(u),t.push(u)}else n.push(s);else{var l=this.features.upsertUserData(a,this.configHelper);this._fixMarkerToUse(l),r.push(l)}}}catch(e){o.e(e)}finally{o.f()}}},{key:"updatePartiallyFeature",value:function(e){var t=this,n=[],r=e.flatMap((function(e){e.id,e.type;var r=ws(e,gs),i=t.features.repository(e.type).find(e.id);return i?bs(bs({},i.toData()),r):(n.push(e),[])}));return this.pushFeatureData(r,"merge",!1),n}},{key:"_pushFeatureDataHandleEvents",value:function(e,t){var n=[];if(e.length>0){var r=this._computeStrictBounds(e.filter((function(e){return void 0!==e.latLng})).map((function(e){return e.latLng})));n.push({type:"addedOrUpdated",features:e.map((function(e){return e.toData()})),Bounds( 0!==e.lat&&void 0!==e.lng})).map((function(e){return[e.lat,e.lng]})));n.push({type:"removed",features:t,bounds:i})}if(n.length>0){var o={changes:n};this.eventsManager.pushEvent(oi.markersChanged,o)}}},{key:"removePushedFeatureData",value:function(e){var t,n,r=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.logger.debug("removing pushed feature data"),this.logger.debug(e),void 0!==e){var o=e.map((function(e){var t=e.id,n=e.type;return r.features.repository(n).find(t)})).filter((function(e){return void 0!==e}));n=this._removePushedFeatureDataAux(o,i)}else{var a=this.features.allExceptClusters();n=this._removePushedFeatureDataAux(a,i)}return(null===(t=n)||void 0===t?void 0:t.lengpdateViewport(),n}},{key:"onMarkerIconsChanged",value:function(e){}},{key:"_fixMarkerToUse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u,n=t.identifyMarkerProperties(e,this.settings),r=n.icons,i=n.zIndex,o=n.cssClasses,a=e.marker,s=e.ariaLabels,l=null==r?void 0:r.pin,c=this.onMarkerIconsChanged.bind(this),f=this.addEventListener.bind(this);this._shouldRecreateMarker(e,n)?this.switchMarktMarkerIcons(e,r,f,this.logger).then((function(t){return t&&c(e),t})),tt(a.cssElement,o.toRemove,o.toAdd),t.switchAriaLabel(e.highlighted,a.ariaElement,s),a.cssClasses=o.toAdd,Xa(a,i),Qa(e,this.settings))}},{key:"_shouldRecreateMarker",value:function(e,t){var n,r,i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u,a=e.markerType,s=e.marker,l=t.icons,c=void 0===l?{}:l,f=t.markerType,d=t.label,h=t.frameIcon,p=c.pin,y=c.cornerIcons,v=void 0===y?{}:y,g=c.innerIcons,m=void 0===g?{}:g,b=null==s||null===(n=s.iconElements)||void 0===n||null===(n=n.pin)||void 0===n?void 0:n.hashCode;return f!==a||o.haveCornerIconsChanged((null==s||null===(r=s.iconElements)||void 0===r?void 0:r.cornerIcons)||{},v)||o.haveInnerIconsChanged((null==s||null===(i=s.iconElements)||void 0===i?void 0:i.innerIcons)||{},m)||("price"===f||"text"===f||"priceObfuscate"===f)&&d!==(null==s?void 0:s.label)||("pin"===f||"pinObfuscate"===f)&&h!==(null==s?void 0:s.frameIcon)||b&&(!Y(p)||b!==vn(J(p)||""))||void 0===b&&Y(p)||this._hasObfuscateMarker(e)&&this.hasObfuscateAreaStyleChanged(e)}},{key:"_hasObfuscateMarker",value:function(e){var t=null==e?void 0:e.markerType;if(t)return"obfuscate"===t||"pinObfuscate"===t||"priceObfuscate"===t}},{key:"_removePushedFeatureDataAux",value:function(e,t){var n,r=[],i=Ps(e.filter((function(e){return e.hasUserData()})));try{for(i.s();!(n=i.n()).done;){var o=n.value;this.popup&&this.popup.feature&&this.popup.feature.id===o.id&&this._closePopup(),o.marker&&this.removeMarkerFromMap(o.marker),this.isFeatureSelected(o)&&this.clearSelectedFeature(),r.push(o.toData()),o.removeUserData()}}catch(e){i.e(e)}finally{i.f()}if(r.length>0&&t){var a=this._computeStrictBounds(r.filter((function(e){return void 0!==e.latLng})).map((function(e){return e.latLng}))),s={changes:[{type:"removed",features:r,bounds:a}]};this.eventsManager.pushErn this.features.insertTileDataWithLowestZoom(e,this.configHelper)}},{key:"removeTileFeature",value:function(e){return this.features.deleteTileData(e)}},{key:"_makeMarkerVisible",value:function(e,t){e.visible=t,t?this._createMarker(e):e.marker&&this._deleteFeatureMarker(e)}},{key:"_createMarker",value:function(e,t){var n=t;n||(n=qa(e,this.settings));var r,i=n,o=i.markerType,a=i.icons,s=i.frameIcon,u=i.cssClasses,l=i.zIndex,c=i.textContent,f=void 0===c?"?":c,d=i.label,h=i.subLabel,p=a||{},y=p.pin,v=p.cornerIcons,g=p.innerIcons,m=e.ariaLabels;this.clearObfuscateArea(e);var b={feature:e,cssClasses:u.toAdd,zIndex:l,label:d,subLabel:h,ariaLabels:m},k=bs(bs({},b),{},{cornerIcons:v,innerIcons:g});switch(o){case"price":r=this.createTextMarkerWithClickListener(k,f,"price");break;case"text":r=this.createTextMarkerWithClickListener(k,f,"text");break;case"pin":"none"===s&&(k.innerIcons=void 0),r=this.createPinMarkerWithClickListener(k,y,s);break;case"obfuscate":r=this.createObfuscateMarkerWithClickListener(b);break;case"pinObfuscate":"none"===s&&(k.innerIcons=void 0),r=this.createPinObfuscateMarkerWithClickListener(k,y,s);break;case"priceObfuscate":r=this.createPriceObfuscateMarkerWithClickListener(k,f);break;default:throw new Error("marker type not supported: ".concat(o))}e.markerType=o,e.marker=r,e.marker.cssClasses=u.toAdd}},{key:"_deleteFeatureMarker",value:function(e){this.clearObfuscateArea(e),this.removeMarkerFromMap(e.marker),delete e.marker}},{key:"switchMarkerType",value:function(e,t){return e.marker&&this._deleteFeatureMarker(e),e.markerType=t.markerType,!!e.visible&&(this._createMarker(e,t),!0)}},{key:"turnKeyboardFeaturesMode",value:function(e){if(!this.keyboardFeatures)throw new Error("You need to enable keyboard features from config in order to use it.");this.keyboardFeatures.turnKeyboardFeaturesMode(e)}},{key:"isKeyboardFeaturesModeEnabled",value:function(){var e;return!!this.keyboardFeatures&&(null===(e=this.keyboardFeatures)||void 0===e?void 0:e.isKeyboardFeaturesModeEnabled())}},{key:"_zIndexAdjustment",value:function(e){return e}}],n&&_s(t.prototype,n),r&&_s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"init",value:function(e,t){return Promise.reject(new Error("method init not implemented"))}},{key:"clearObfuscateArea",value:function(e){throw new Error("method clearObfuscateArea not implemented")}},{key:"createPinMarkerWithClickListener",value:function(e,t,n){throw new Error("method createPinMarkerWithClickListener not implemented")}},{key:"createTextMarkerWithClickListener",value:function(e,t,n){throw new Error("method createTextMarkerWithClickListener not implemented")}},{key:"createObfuscateMarkerWithClickListener",value:function(e){throw new Error("method createObfuscateMarkerWithClickListener not implemented")}},{key:"createPriceObfuscateMarkerWithClickListener",value:function(e,t){throw new Error("method createPriceObfuscateMarkerWithClickListener not implemented")}},{key:"createPinObfuscateMarkerWithClickListener",value:function(e,t,n){throw new Error("method createPinObfuscateMarkerWithClickListener not implemented")}},{key:"hasObfuscateAreaStyleChanged",value:function(e){throw new Error("method _hasObfuscateAreaStyleChanged noror("method createClusterMarkerWithClickListener not implemented")}},{key:"removeMarkerFromMap",value:function(e){throw new Error("method removeMarkerFromMap not implemented")}},{key:"cloneMarker",value:function(e){throw new Error("method cloneMarker not implemented")}},{key:"updatePopupPositionOnLayer",value:function(){throw new Error("method updatePopupPositionOnLayer not implemented")}},{key:"ensurePopupVisibility",value:function(){throw new Error("method ensurePopupVisibility not implemented")}},{key:"getMarkerComponent",value:function(e){throw new Error("method getMarkerComponent not implemented")}},{key:"moveMarkerPosition",value:function(e,t){throw new Error("method moveMarkerPosition not implemented")}},{key:"getRectOfMarker",value:function(e){throw new Errorion(e,t){return Promise.reject("method fitBounds not implemented")}},{key:"nativeBounds",value:function(){throw new Error("method nativeBounds not implemented")}},{key:"asNativeBounds",value:function(e,t){throw new Error("method asNativeBounds not implemented")}},{key:"computeNativeBoundsFromLatLongs",value:function(e){throw new Error("method computeNativeBoundsFromLatLongs not implemented")}},{key:"asBounds",value:function(e){throw new Error("method asBounds not implemented")}},{key:"containerBounds",value:function(e){throw new Error("method containerBounds not implemented")}},{key:"fitLatLongs",value:function(e){return Promise.reject("method fitLatLongs not implemented")}},{key:"getZoom",value:function(){throw new Error("method getZoom not implemented")}},{key:"getCenter",value:function(){throw new Error("method getCenter not implemented")}},{key:"isFeatureInRealBound",value:function(e,t){throw new Error("method isFeatureInRealBound not implemented")}},{key:"centerAndZoomMap",value:function(e,t,n){throw new Error("method(e,t,n){throw new Error("met Promise.reject(new Error("method addRouteOnMap not implemented"))}},{key:"removeRouteOnMap",value:function(e){return Promise.reject(new Error("method removeRouteOnMap not implemented"))}},{key:"addPolygonsOnMap",value:function(e){return Promise.reject(new Error("method addse.reject(new Error("method removePolygonsOnMap  Error("method registerListenerOnMapFocusElement not implemented")}},{key:"unbindAll",value:function(){throw new Error("method unbindAll not implemented")}},{key:"getTileDim",value:function(){throw new Error("method getTileDim not implemented")}},{key:"resetRouteStyle",value:function(){throw new Error("method resetRouteStyle not implemented")}},{key:"updateMapProviderConfig",value:function(){throw new Error("method updateMapProviderConfig not implemented")}}])&&ps(t.prototype,n),r&&ps(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}());function js(e){return js="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},js(e)}function Rs(e){return function(e){if(Array.isArray(e))return Us(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Vs(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ns(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||Vs(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vs(e,t){if(e){if("string"==typeof e)return Us(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Us(e,t):void 0}}function Us(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function zs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ks(r.key),r)}}function Ks(e){var t=function(e,t){if("object"!==js(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==js(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===js(t)?t:String(t)}function Hs(){return Hs="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Gs(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},Hs.apply(this,arguments)}function Zs(e,t){return Zs=Object.setPrototypeOf?Object.s hasn't been initialised - super() hasn't been called");return e}function Gs(e){return Gs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Gs(e)}var Qs=At,$s=Dt,Xs="markers",Ys="default",Js="undefined"!=typeof google?google.maps.Marker.MAX_ZINDEX:0,eu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Zs(e,t)}(o,e);var t,n,r,i=qs(o);function o(e,t,n,r){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(a=i.call(this,e,t,r))._loadLocale(e),a.i18n=new ar(n,a.locale,{readParam:a.readParam.bind(Ws(a)),writeParam:a.writeParam.bind(Ws(a))}),a.qualifiersAndHashkeysUsed={},a}return t=o,n=[{key:"ready",value:function(){(this).then((function(){return e.loadQualifiersAndHashkeysUsed(),e}))}},{key:"getEGMapConfigurations",value:function(){var e=this.getConfigurations();return{default:e.default,external:e.external,overwrite:e.overwrite,parameter:e.parameter,final:this.subConfig()}}},{key:"loadHashkeysUsed[t]=e._identifyQualifiersAndHashKeysUsedInHashkeys(t)}))}},{key:"_loadLocale",value:function(e){this.locale=null==e?void 0:e.locale;var t=this.readParam("locale");if(t){var n=Ns(/^([a-z]{2})((-|_)([A-Z]{2}))?$/.exec(t)||[],5),r=n[1],i=n[4];r&&(this.locale=i?"".concat(r,"-").concat(i):r)}}},{key:"mapProvider",value:function(){return this.readParam("mapProvider")}},{key:"ge-1]=arguments[i];return(t=this.i18n).format.apply(t,[e].concat(r))}},{key:"filterQualifiersUsed",value:function(e,t){var n=this.qualifiersAndHashkeysUsed[e].qualifiers;return t.filter((function(e){return n.includes(e)}))}},{key:"filterHashkeysUsed",value:function(e,t){var n=this.qualifiersAndHashkeysUsed[e].hashkeys;return t.filter((function(e){return n.includes(e)}))}},{key:"_identifyQualifiersAndHashKeysUsedInHashkeys",value:function(e){var t=this,n=new Set,r=new Set;return r.add("default"),this._identifyAllHashkeys(e).forEach((function(i){r.add(i),i.split("#").forEach((function(r){t.getFeatureStatus(e).includesshkeys:Rs(r).map((function(e){return e.split("#").sort().join("#")}))}}},{key:"_identifyAllHashkeys",value:function(e){var t=this.listStringKeys("markers,".concat(e)),n=new Set,r=new Set;t.forEach((function(e){if(e.endsWith(Ys))r.add(e.substring(0,e.length-7-1));else{var t=e.indexOf(",".concat(Ys,","));t>0?r.add(e.substring(0,t)):n.add(e)}}));var i=new Set;return n.forEach((function(e){r.forEach((function(t){e.startsWith(t)&&i.add(e.substring(t.length+1).split(",")[0])}))})),Rs(i)}},{key:"mapboxAccessToken",value:function(){return this.readParam("mapbox,accessToken")}},{key:"getFeatureTypes",value:function(){return ya}},{key:"getFeatureStatus",value:function(e){switch(e){case ca:return ga;case fa:return ma;case da:case ha:return[va];default:throw new Error("Type unknown: ".concat(e))}}},{key:"iso4217CurrencyCode",value:function(){return this.readParam("iso4217CurrencyCode")}},{key:"icons",value:function(){return this.propertyValues(Xs,"icons",ya)}},{key:"frameIcons",value:function(){return this.propertyValues(Xs,"frameIcons",ya)}},{key:"cornerIcons",value:function(){return{"top-left":this.propertyValues(Xs,"cornerIcons,topLeft",ya),"top-right":this.propertyValues(Xs,"cornerIcons,topRight",ya),"bottom-left":this.propertyValues(Xs,"cornerIcons,bottomLeft",ya),"bottom-right":this.propertyValues(Xs,"cornerIcons,bottomRight",ya)}}},{key:"innerIcons",value:function(){return{left:this.propertyValues(Xs,"innerIcons,left",ya),right:this.propertyValues(Xs,"innerIcons,right",ya)}}},{key:"obfuscateRadiusInMeters",value:function(){return this.propertyValues(Xs,"obfuscateMarkers,radiusInM",pa)}},{key:"obfuscatePrecision",value:function(){return this.propertyValues(Xs,"obfuscateMarkers,precision",pa)}},{key:"obfuscateStyle",value:function(){return this.propertyvalue:function(){return this.propertyValues("polygons","style",ya)}},{key:"zIndexes",value:function(){var e=this.propertyValues(Xs,"zIndex",ba);if("google-maps"===this.mapProvider())for(var t in e)for(var n in e[t])e[t][n]=e[t][n]+Js;return e}},{key:"maxZIndex",value:function(){var e=this.zIndexes(),t=0;return Objunction(e){return Object.values(e).forEach((function(e){e>t&&(t=e)}))})),t}},{key:"textLabelDynamicPlacement",value:function(){return this.propertyValues(Xs,"textLabel,dynamicPlacement",ya)}},{key:"textLabelMaxLineLength",value:function(){return this.propertyValues(Xs,"textLabel,maxLineLength",ya)}},{key:"textLabelMaxLines",value:function(){return this.propertyValues(Xs,"textLabel,maxLines",ya)}},{key:"textSubLabelMaxLineLength",value:function(){return this.propertyValues(Xs,"textLabel,subLabel,maxLineLength",ya)}},{key:"textSubLabelMaxLines",value:function(){return this.propertyValues(Xs,"textLabel,subLabel,maxLines",ya)}},{key:"textLabelVisibility",value:function(){return this.propertyValues(Xs,"textLabel,show",ba)}},{key:"textSubLabelVisibility",value:function(){return this.propertyValues(Xs,"textLabel,subLabel,show",ba)}},{key:"textLabelZIndex",value:function(){return this.propertyValues(Xs,"textLabel,zIndex",ba)}},{key:"textLabelPosition",value:function(){return this.propertyValues(Xs,"textLabel,position",ba,(function(e){var t=e;switch(e){case"bottom":t="below";break;case"top":t="above"}return t}))}},{key:"popupPositions",value:function(){return this.propertyValues(Xs,"popup,position",ya,(function(e){var t=e;switch(e){case"bottom":t="below";break;case"top":t="above"}return t}))}},{key:"popupVisibilities",value:function(){return this.propertyValues(Xs,"popup,ensureVisibility",ya)}},{key:"popupVisibilityPaddings",value:function(){return this.propertyValues(Xs,"popup,visibilityPadding",ya)}},{key:"markerTypes",value:function(){return this.propertyValues(Xs,"markerType",ya)}},{key:"isAtLeastOneProductStatusUsingObfuscateMarker",value:function(){return Object.values(this.markerTypes().product||{}).some((function(e){return"obfuscate"===e||"pinObfuscate"===e||"priceObfuscate"===e}))}},{key:"isAtLeastOnePropertyStatusUsingObfuscateMarker",value:fune){return"obfuscate"===e||"pinObfuscate"===e||"priceObfuscate"===e}))}},{key:"visibilityByStatus",value:function(){return this.propertyValues(Xs,"show",ya)}},{key:"actionsOnFeatureSelect",value:function(){return this.propertyValues(Xs,"actionOnFeatureSelect",ya)}},{key:"actionsOnFeatureDeselect",value:function(){return this.propertyValues(Xs,"actionOnFeatureDeselect",ya)}},{key:"actionsOnFeatureOver",value:function(){return this.propertyValues(Xs,"actionOnFeatureOver",ya)}},{key:"actionsOnFeatureOut",value:function(){return this.propertyValues(Xs,"actionOnFeatureOut",ya)}},{key:"actionsOnMarkerClick",value:function(){return this.propertyValues(Xs,"actionOnClick",ba)}},{key:"actionsOnMarkerMouseOver",value:function(){return this.propertyValues(Xs,"actionOnMouseOver",ba)}},{key:"actionsOnMarkerMouseOut",value:function(){return this.propertyValues(Xs,"actionOnMouseOut",ba)}},{key:"actionsOnMapDrag",value:function(){return this.readParam("map,onMapDrag")}},{key:"actionsOnMapClick",value:function(){return this.readParam("map,onMapClick")}},{key:"singlePropertiesValues",value:function(e,t){var n=this,r={};return t.map((function(t){r[t]=n.readParam("".concat(Xs,",").concat(t,",").concat(e))})),r}},{key:"threshold",value:function(){var e=this.propertyValues(Xs,"threshold",ya),t=this.singlePropertiesValues("threshold,".concat(Ys),ya);return ya.forEach((function(n){return e[n].default=t[n]})),e}},{key:"style",value:function(){return this.readParam("style")}},{key:"maxZoomForCount",value:function(){var e=this.propertyValues(Xs,"maxZoomForCount",ya),t=this.singlePropertiesValues("maxZoomForCount,".concat(Ys),ya);return ya.forEach((function(n){retue",value:function(){return this.propertyValues(Xs,"clustering",ya)}},{key:"clusterDefaultConfigurationByType",value:function(){var e=this,t={};return ya.forEach((function(n){t[n]=e.subConfig("markers,".concat(n,",(){return void 0!==this.readParam("a11y,ction(){return!0===this.readParam("a11y,keyboardFeatures,enabled")}},{key:"isAnyContentProviderExists",value:function(){var e=this;return ya.some((function(t){var n,r;return null!==(n=null===(r=e.readParam("contentProvider,".concat(t,",default")))||void 0===r?void 0:r.length)&&void 0!==n&&n}))}},{key:"minZoomForDisplay",value:function(){var e=this.propertyValues(Xs,"minZoomForDisplay",ya),t=this.singlePropertiesValues("minZoomForDisplay,".concat(Ys),ya);return ya.forEach((function(n){return e[n].default=t[n]})),e}},{key:"minZoomForTileRequest",value:function(){return this.readParam("tiles,minZoomForTileRequest")}},{key:"historicalBoundingBoxDataEndpoint",value:function(){return this.readParam("historicalBoundingBoxDataEndpoint")}},{key:"tagCollidingMarkers",value:function(){var e=this.propertyValues(Xs,"tagCollidingMarkers",ba),t=this.singlePropertiesValues("tagCollidingMarkers,".concat(Ys),ba);return ba.forEach((function(n){return e[n].default=t[n]})),e}},{key:"collisionBufferVariation",value:function(){var e=this.propertyValues(Xs,"collisionBufferVariation",ba),t=this.singlePropertiesVat(Ys),ba);return ba.forEach((function(n){return e[n].default=t[n]})),e}},{key:"collisionBuffers",value:function(){return this.readParam("markers,common,collisionBuffers")}},{key:"clusterMarkerCollisionBufferInPixels",value:function(){return this.readParam("markers,cluster,clusterMarkerCollisionAvoidance,clusterMarkerCollisionBufferInPixels,default")}},{key:"shouldMoveCollidingClusterMarkers",value:function(){return this.readParam("markers,cluster,clusterMarkerCollisionAvoidance,moveCollidingClusterMarkers,default")}},{key:"visibilityBooleanByStatus",value:function(){var e=this.visibilityByStatus();for(var t in e)for(var n in e[t])e[t][n]=!0===e[t][n]||"true"===e[t][n]||"always"===e[t][n];return e}},{key:"routeLineStyleByDistanceMode",value:function(){return this.propertyValues("routes,style",void 0,["driving","cycling","walking","flying"])}},{key:"googleMaps",value:function(){return this.subConfig("googleMaps")}},{key:"mapbox",value:function(){return this.subConfig("mapbox")}},{key:"isOneFilterAvailable",value:function(){var e=this.subConfig("filters"),t=this.visibilityByStatus();return ya.some((function(n){return(null==e?void 0:e[n])&&Object.values(t[n]).some((function(e){return"never"!==e}))}))}},{key:"tilesReaderConfig",value:function(){return this.subConfig("tiles,enabled")}},{key:"tilesProvidersConfig",value:function(){return this.subConfig("tiles,providers")}},{key:"tilesCacheConfig",value:function(){return this.subConfig("tiles,cache")}},{key:"routeCacheInMs",value:function(){return this.readParam("routes,cacheInMs")}},{key:"egDistances",value:function(){return this.readParam("routes,egDistances")}},{key:"keyboardFeaturesIcon",value:function(){return this.readParam("a11y,keyboardFeatures,keyboardFeaturesIcon")}},{key:"contentProvidersByFeatureType",value:function(){var e=this,t={};return ya.forEach((function(n){return t[n]=e.readParam("contentProvider,".concat(n,",default"))})),t}},{key:"contentProvidersConfigs",value:function(){return this.subConfig("contentProvider,providers")}},{key:"availabilityProvider",value:function(){return this.readParam("availability,availabilityProvider")}},{key:"gmapsAddConfig",value:function(){return this.subConfig("googleMaps,gmapsAddConfig")}},{key:"loadMapSettings",value:function(){return{mapProvider:this.mapProvider(),loggerFactory:this.logger.bind(this),featureTypes:ya,getFeatureStatus:this.getFeatureStatus.bind(this),getI18N:this.getI18N.bind(this),actionsOnFeatureSelect:this.actionsOnFeatureSelect(),actionsOnFeatureDeselect:this.actionsOnFeatureDeselect(),actionsOnFeatureOver:this.actionsOnFeatureOver(),actionsOnFeatureOut:this.actionsOnFeatureOut(),actionsOnMarkerClick:this.actionsOnMarkerClick(),actionsOnMarkerMouseOver:this.actionsOnMarkerMouseOver(),actionsOnMarkerMouseOut:this.actionsOnMarkerMouseOut(),popupPositions:this.popupPositions(),actionsOnMapDrag:this.actionsOnMapDrag(),actionsOnMapClick:this.actionsOnMapClick(),routeCacheInMs:this.routeCacheInMs(),contentProvidersByFeatureType:this.contentProvidersByFeatureType(),contentProvidersConfigs:this.contentProvidersConfigs(),availabilityProvider:this.availabilityProvider(),filter:{showFilter:this.subConfig("filters"),isOneFilterAvailable:this.isOneFilterAvailable(),visibilityByStatus:this.visibilityByStatus(),visibilityBooleanByStatus:this.visibilityBooleanByStatus()},locale:this.getLocale(),isKeyboardFeaturesDefined:this.isKeyboardFeaturesDefined(),isKeyboardFeaturesEnabled:this.isKeyboardFeaturesEnabled(),keyboardFeaturesIcon:this.keyboardFeaturesIcon(),tiles:{tilesReaderConfig:this.tilesReaderConfig(),tilesProvidersConfig:this.tilesProvidersConfig(),tilesCacheConfig:this.tilesCacheConfig(),minZoomForTileRequest:this.minZoomForTileRequest(),debugTileId:Qn.getDebugTilesIdEnabled()},styling:this.style(),threshold:this.threshold(),maxZoomForCount:this.maxZoomForCount(),minZoomForDisplay:this.minZoomForDisplay(),clusterConfigurationByType:this.clusterConfigurationByType(),clusterDefaultConfigurationByType:this.clusterDefaultConfigurationByType(),isAnyContentProviderExists:this.isAnyContentProviderExists(),historicalBoundingBoxDataEndpoint:this.historicalBoundingBoxDataEndpoint(),markerTypes:this.markerTypes(),isAtLeastOneProductStatusUsingObfuscateMarker:this.isAtLeastOneProductStatusUsingObfuscateMarker(),isAtLeastOnePropertyStatusUsingObfuscateMarker:this.isAtLeastOnePropertyStatusUsingObfuscateMarker(),obfuscateRadiusInMeters:this.obfuscateRadiusInMeters(),obfuscatePrecision:this.obfuscatePrecision(),obfuscateStyle:this.obfuscateStyle(),icons:this.icons(),frameIcons:this.frameIcons(),cornerIcons:this.cornerIcons(),innerIcons:this.innerIcons(),textLabelVisibility:this.textLabelVisibility(),textSubLabelVisibility:this.textSubLabelVisibility(),zIndexes:this.zIndexes(),maxZIndex:this.maxZIndex(),textLabelZIndex:this.textLabelZIndex(),textLabelPosition:this.textLabelPosition(),textLabelMaxLineLength:this.textLabelMaxLineLength(),textLabelMaxLines:this.textLabelMaxLines(),textSubLabelMaxLineLength:this.textSubLabelMaxLineLength(),textSubLabelMaxLines:this.textSubLabelMaxLines(),polygonStyles:this.polygonStyles(),iso4217CurrencyCode:this.iso4217CurrencyCode(),debugMarkersPosition:Qn.getDebugMarkersPositionEnabled(),collision:{labelVisibility:this.textLabelVisibility(),dynamicPlacement:this.textLabelDynamicPlacement(),collisionBufferVariation:this.collisionBufferVariation(),collisionBuffers:this.collisionBuffers(),tagCollidingMarkers:this.tagCollidingMarkers(),clusterMarkerCollisionBufferInPixels:this.clusterMarkerCollisionBufferInPixels(),shouldMoveCollidingClusterMarkers:this.shouldMoveCollidingClusterMarkers()},routeLineStyleByDistanceMode:this.routeLineStyleByDistanceMode(),googleMaps:this.googleMaps(),mapbox:this.mapbox()}}},{key:"getActiveTilesets",value:function(){var e=this.readParam("tiles,enabled,product"),t=this.readParam("tiles,enabled,property"),n=this.readParam("tiles,enabled,place"),rion(e){var t;return null===(t=i[e])||void 0===t?void 0:t.tilesetId}))}}],n&&zs(t.prototype,n),r&&zs(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(nr);function tu(e,t){var n,r,i=e.mapProvider!==t.mapProvider||"mapbox"===t.mapProvider&&nu(e.mapbox,t.mapbox)||"google-maps"===t.mapProvider&&((null===(n=e.googleMaps)||void 0===n||null===(n=n.gmapsAddConfig)||void 0===n?void 0:n.mapId)||"")!==((null===(r=t.googleMaps)||void 0===r||null===(r=r.gmapsAddConfig)||void 0===r?void 0:r.mapId)||"");if(i)return{reinstantiate:i};var o="google-maps"===t.mapProvider&&nu(e.googleMaps.gmapsAddConfig||{},t.googleMaps.gmapsAddConfig||{}),a=ru(e.icons,t.icons),s=nu(e.frameIcons,t.frameIcons),u=ru(e.cornerIcons,t.cornerIcons),l=ru(e.innerIcons,t.innerIcons),c=nu(e.contentProvidersByFeatureType,t.contentProvidersByFeatureType),f=nu(e.threshold,t.threshold),d=nu(e.maxZoomForCount,t.maxZoomForCount),h=nu(e.minZoomForDisplay,t.minZoomForDisplay),p=nu(e.clusterConfigurationByType,t.clusterConfigurationByType),y=nu(e.markerTypes,t.markerTypes),v=nu(e.obfuscateRadiusInMeters,t.obfuscateRadiusInMeters),g=nu(e.obfuscatePrecision,t.obfuscatePrecision),m=nu(e.obfuscateStyle,t.obfuscateStyle),b=nu(e.textLabelVisibility,t.textLabelVisibility),k=nu(e.textSubLabelVisibility,t.textSubLabelVisibility),w=nu(e.zIndexes,t.zIndexes),P=nu(e.textLabelZIndex,t.textLabelZIndex),C=nu(e.textLabelPosition,t.textLabelPosition),L=nu(e.textLabelMaxLineLength,t.textLabelMaxLineLength),x=nu(e.textLabelMaxLines,t.textLabelMaxLines),M=nu(e.textSubLabelMaxLineLength,t.textSubLabelMaxLineLength),_=nu(e.textSubLabelMaxLines,t.textSubLabelMaxLines),F=nu(e.polygonStyles,t.polygonStyles),O=nu(e.collision,t.collision),S=nu(e.routeLineStyleByDistanceMode,t.routeLineStyleByDistanceMode),E=nu(e.contentProvidersConfigs,t.contentProvidersConfigs),I=nu(e.availabilityProvider,t.availabilityProvider),A=nu(e.filter,t.filter),T=nu(e.clusterDefaultConfigurationByType,t.clusterDefaultConfigurationByType),D=nu(e.tiles,t.tiles),B=nu(e.actionsOnFeatureSelect,t.actionsOnFeatureSelect)||nu(e.actionsOnFeatureDeselect,t.actionsOnFeatureDeselect)||nu(e.actionsOnFeatureOver,t.actionsOnFeatureOver)||nu(e.actionsOnFeatureOut,t.actionsOnFeatureOut)||nu(e.actionsOnMarkerClick,t.actionsOnMarkerClick)||nu(e.actionsOnMarkerMouseOver,t.actionsOnMarkerMouseOver)||nu(e.actionsOnMarkerMouseOut,t.actionsOnMarkerMouseOut)||nu(e.popupPositions,t.popupPositions)||c||f||d||h||e.isAnyContentProviderExists!==t.isAnyContentProviderExists||p||y||v||g||m||a||s||u||l||b||k||w||P||C||L||x||M||_||O,j=D,R={updateMapProviderConfig:o,updateViewport:S||e.routeCacheInMs!==t.routeCacheInMs||c||E||I||A||e.isKeyboardFeaturesDefined!==t.isKeyboardFeaturesDefined||e.isKeyboardFeaturesEnabled!==t.isKeyboardFeaturesEnabled||f||d||h||p||T||e.isAnyContentProviderExists!==t.isAnyContentProviderExists||y||e.isAtLeastOneProductStatusUsingObfuscateMarker!==t.isAtLeastOneProductStatusUsingObfuscateMarker||e.isAtLeastOnePropertyStatusUsingObfuscateMarker!==t.isAtLeastOnePropertyStatusUsingObfuscateMarker||v||g||m||a||s||u||l||b||k||w||P||C||L||x||M||_||e.debugMarkersPosition!==t.debugMarkersPosition||O||D,updateMarkers:y||e.isAtLeastOneProductStatusUsingObfuscateMarker!==t.isAtLeastOneProductStatusUsingObfuscateMarker||e.isAtLeastOnePropertyStatusUsingObfuscateMarker!==t.isAtLeastOnePropertyStatusUsingObfuscateMarker||v||g||m||a||s||u||l||b||k||w||P||C||L||x||M||_||e.debugMarkersPosition!==t.debugMarkersPosition,updateKeyboardA11yUI:e.isKeyboardFeaturesDefined!==t.isKeyboardFeaturesDefined||e.isKeyboardFeaturesEnabled!==t.isKeyboardFeaturesEnabled||nu(e.keyboardFeaturesIcon,t.keyboardFeaturesIcon),updateFiltersUI:A,updateStyling:nu(e.styling,t.styling),resetRouteManagement:S||e.routeCacheInMs!==t.routeCacheInMs,resetPolygonManagement:F,resetClusterers:p||T,resetContentProviders:c||E,resetCollisionManagement:O,resetAvailabilityCTiles:j};retion(e){return!1===R[e]})).forEach((function(e){return delete R[e]})),R}function nu(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return $s(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),iu(e))}function iu(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new WeakSet;return Object.keys(e).forEach((function(r){var i=e[r];Y(i)?t[r]=J(i):Qs(i)?n.has(i)||(t[r]={},iu(e[r],t[r],n)):t[r]=i})),t}var ou={marker:"data:image/svg+xml,%3c!-- file: marker.svg --%3e %3csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3e%3cpath fill='%23026dc5' d='M16 2.667A9.326 9.326 0 006.667 12C6.667 19 16 29.333 16 29.333S25.333 19 25.333 12A9.326 9.326 0 0016 2.667zm0 12.666a3.334 3.334 0 010-6.666 3.334 3.334 0 010 6.666z'/%3e%3c/svg%3e",markerHighlighted:"data:image/svg+xml,%3c!-- file: marker-hl.svg --%3e %3csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3e%3cpath fill='%2354a0dd' d='M16 2.667A9.326 9.326 0 006.667 12C6.667 19 16 29.333 16 29.333S25.333 19 25.333 12A9.326 9.326 0 0016 2.667zm0 12.666a3.334 3.334 0 010-6.666 3.334 3.334 0 010 6.666z'/%3e%3c/svg%3e",keyboardNavigationIcon:"data:image/svg+xml,%3c!-- file: keyboard.svg --%3e %3csvg xmlns='http://www.w3.org/2000/svg' height='24' width='24'%3e%3cpath d='M20 5H4c-1.1 0-1.99.9-1.99 2L2 17c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-9 3h2v2h-2V8zm0 3h2v2h-2v-2zM8 8h2v2H8V8zm0 3h2v2H8v-2zm-1 2H5v-2h2v2zm0-3H5V8h2v2zm9 7H8v-2h8v2zm0-4h-2v-2h2v2zm0-3h-2V8h2v2zm3 3h-2v-2h2v2zm0-3h-2V8h2v2z'/%3e%3c/svg%3e",leftArrowIcon:"data:image/svg+xml,%3c!-- file: left-arrow.svg --%3e %3csvg xmlns='http://www.w3.org/2000/svg' height='24' width='14'%3e%3cpath d='M9.87.613Q9.55.96 8.08 2.523 6.612 4.085 4.983 5.82q-1.628 1.736-2.95 3.125L.735 10.335q-.343.322-.54.756-.195.434-.195.88 0 .447.196.881t.539.756l1.298 1.39q1.322 1.388 2.95 3.124l3.098 3.299q1.47 1.562 1.788 1.91.686.669 1.64.669.956 0 1.617-.67t.723-1.537q.06-.868-.723-1.761l-7.518-8.06 7.665-8.06q.784-.794.723-1.712-.062-.917-.723-1.587-.784-.67-1.75-.608-.968.062-1.654.608z'/%3e%3c/svg%3e",rightArrowIcon:"data:image/svg+xml,%3c!-- file: right-arrow.svg --%3e %3csvg xmlns='http://www.w3.org/2000/svg' height='24' width='14'%3e%3cpath d='M4.13 23.387q.32-.347 1.789-1.91 1.469-1.562 3.098-3.298 1.628-1.736 2.95-3.125l1.298-1.389q.343-.322.54-.756.195-.434.195-.88 0-.447-.196-.881t-.539-.756l-1.298-1.39q-1.322-1.388-2.95-3.124L5.919 2.579Q4.449 1.017 4.13.67 3.445 0 2.49 0 1.534 0 .873.67T.15 2.207q-.06.868.723 1.761l7.518 8.06-7.665 8.06q-.784.794-.723 1.712.062.917.723 1.587.784.67 1.75.608.968-.062 1.654-.608z'/%3e%3c/svg%3e"},au=function(){var e=new jn;return{mapProvider:"google-maps",map:{onMapDrag:["clearHighlight","clearSelection","closePopup","removeAriaLive"],onMapClick:["clearHighlight","clearSelection","closePopup","removeAriaLive"],mapInitWaitForTiles:!0},googleMaps:{padding:32,gmapsAddConfig:{zoom:2,minZoom:2,mapId:"57df04e09ffe3110",center:{lat:0,lng:0},gestureHandling:"greedy",clickableIcons:!1,disableDefaultUI:!1,zoomControl:!0,mapTypeControl:!1,scaleControl:!1,streetViewControl:!1,rotateControl:!1,fullscreenControl:!1,isFractionalZoomEnabled:!0},urls:{api:"https://maps.googleapis.com/maps/api/js?libraries=places,geometry"}},mapbox:{accessToken:void 0,rtlTextPlugin:"https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js",padding:32,scaleControl:{ctrlEnabled:!1,ctrlOptions:{unit:"metric"},ctrlPosition:void 0},navControl:{ctrlEnabled:!0,ctrlOptions:{},ctrlPosition:void 0},geoLocateControl:{ctrlEnabled:!1,ctrlOptions:{},ctrlPosition:void 0},fullscreenControl:{ctrlEnabled:!1,ctrlOptions:{},ctrlPosition:void 0},mapboxAddConf:{center:[0,0],zoom:1,fadeDuration:100,style:"mapbox://styles/expedia-geo/ckfgvpedb2neq19pe9u3zg69x"},urls:{api:"https://api.mapbox.com/mapbox-gl-js/v2.9.2/mapbox-gl.js",css:"https://api.mapbox.com/mapbox-gl-js/v2.9.2/mapbox-gl.css",pluginUrls:["https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-language/v1.0.0/mapbox-gl-language.js"]}},markers:{common:{collisionBuffers:{low:16,medium:128,high:192}},product:{threshold:{default:200},maxZoomForCount:{default:15},minZoomForDisplay:{default:9},actionOnFeatureSelect:{default:["bounce","highlight","showRoutes","addAriaLive"]},actionOnFeatureDeselect:{default:["dehighlight","hideRoutes","removeAriaLive"]},actionOnFeatureOver:{default:[]},actionOnFeatureOut:{default:[]},actionOnClick:{default:["select","highlight","showRoutes","addAriaLive"]},actionOnMouseOver:{default:["sendEvent"]},actionOnMouseOut:{default:["sendEvent"]},tagCollidingMarkers:{default:!1},collisionBufferVariation:{default:"none"},show:{default:"never",available:"always",filtered:"never",sold_out:"never",unknown:"never","linked-features":!1},clustering:{default:{type:"none",minPoints:2,minZoom:0,maxZoom:15,labelKey:Oi.defaultClusterProductLabel,superclusterSettings:{radius:105},excludedQualifiers:[]}},zIndex:{default:1,hl:6,available:5,filtered:4,sold_out:3},markerType:{default:"pin",available:"price",filtered:"pin"},icons:{default:ou.marker,hl:ou.markerHighlighted},cornerIcons:{topLeft:{default:"none"},topRight:{default:"none"},bottomLeft:{default:"none"},bottomRight:{default:"none"}},frameIcons:{default:"none"},innerIcons:{left:{default:"none"},right:{default:"none"}},popup:{position:{default:"above"},ensureVisibility:{default:!1},visibilityPadding:{default:{x:20,y:20}}},obfuscateMarkers:{precision:{default:100},style:{default:{line:{weight:1,color:"#616161",opacity:1},fill:{color:"#E6E6E6",opacity:.3}},hl:{line:{weight:1,color:"#1C598C",opacity:1},fill:{color:"#0E77CD",opacity:.5}}},radiusInM:{default:500}},textLabel:{show:{default:!1},zIndex:{default:"sameAsMarker"},position:{default:"right"},maxLineLength:{default:-1},maxLines:{default:-1},dynamicPlacement:{default:!1}}},property:{threshold:{default:200},maxZoomForCount:{default:15},minZoomForDisplay:{default:9},actionOnFeatureSelect:{default:["bounce","highlight","showRoutes","addAriaLive"]},actionOnFeatureDeselect:{default:["dehighlight","hideRoutes","removeAriaLive"]},actionOnFeatureOver:{default:[]},actionOnFeatureOut:{default:[]},actionOnClick:{default:["select","highlight","showRoutes","addAriaLive"]},actionOnMouseOver:{default:["sendEvent"]},actionOnMouseOut:{default:["sendEvent"]},tagCollidingMarkers:{default:!1},collisionBufferVariation:{default:"none"},show:{default:"never",available:"always",filtered:"never",sold_out:"never",unknown:"never","linked-features":!1},clustering:{default:{type:"none",minPoints:2,minZoom:0,maxZoom:15,labelKey:Oi.defaultClusterPropertyLabel,superclusterSettings:{radius:105},excludedQualifiers:[]}},zIndex:{default:1,hl:6,available:5,filtered:4,sold_out:3},markerType:{default:"pin",available:"price",filtered:"pin"},icons:{default:ou.marker,hl:ou.markerHighlighted},cornerIcons:{topLeft:{default:"none"},topRight:{default:"none"},bottomLeft:{default:"none"},bottomRight:{default:"none"}},frameIcons:{default:"none"},innerIcons:{left:{default:"none"},right:{default:"none"}},popup:{position:{default:"above"},ensureVisibility:{default:!1},visibilityPadding:{default:{x:20,y:20}}},obfuscateMarkers:{precision:{default:100},style:{default:{line:{weight:1,color:"#616161",opacity:1},fill:{color:"#E6E6E6",opacity:.3}},hl:{line:{weight:1,color:"#1C598C",opacity:1},fill:{color:"#0E77CD",opacity:.5}}},radiusInM:{default:500}},textLabel:{show:{default:!1},subLabel:{show:{default:!1},maxLineLength:{default:-1},maxLines:{default:-1}},zIndex:{default:"sameAsMarker"},position:{default:"right"},maxLineLength:{default:-1},maxLines:{default:-1},dynamicPlacement:{default:!1}}},place:{threshold:{default:100},maxZoomForCount:{default:10},minZoomForDisplay:{default:11},actionOnFeatureSelect:{default:["bounce","highlight","addAriaLive"]},actionOnFeatureDeselect:{default:["dehighlight","removeAriaLive"]},actionOnFeatureOver:{default:[]},actionOnFeatureOut:{default:[]},actionOnClick:{default:["select","highlight","addAriaLive"]},actionOnMouseOver:{default:["sendEvent"]},actionOnMouseOut:{default:["sendEvent"]},tagCollidingMarkers:{default:!1},collisionBufferVariation:{default:"none"},show:{default:!1},clustering:{default:{type:"none",minPoints:2,minZoom:0,maxZoom:15,labelKey:Oi.defaultClusterPlaceLabel,superclusterSettings:{radius:105},excludedQualifiers:[]}},zIndex:{default:1,hl:6},markerType:{default:"pin"},icons:{default:ou.marker,hl:ou.markerHighlighted},cornerIcons:{topLeft:{default:"none"},topRight:{default:"none"},bottomLeft:{default:"none"},bottomRight:{default:"none"}},frameIcons:{default:"none"},innerIcons:{left:{default:"none"},right:{default:"none"}},popup:{position:{default:"above"},ensureVisibility:{default:!1},visibilityPadding:{default:{x:20,y:20}}},textLabel:{show:{default:!1},subLabel:{show:{default:!1},maxLineLength:{default:-1},maxLines:{default:-1}},zIndex:{default:"sameAsMarker"},position:{default:"right"},maxLineLength:{default:20},maxLines:{default:3},dynamicPlacement:{default:!1}}},cluster:{actionOnClick:{default:["select","zoomToExtent"]},actionOnMouseOver:{default:["sendEvent"]},actionOnMouseOut:{default:["sendEvent"]},tagCollidingMarkers:{default:!1},collisionBufferVariation:{default:"none"},clusterMarkerCollisionAvoidance:{moveCollidingClusterMarkers:{default:!1},clusterMarkerCollisionBufferInPixels:{default:5}},zIndex:{default:1,hl:6,unknown:2},textLabel:{show:{default:!1},zIndex:{default:"sameAsMarker"},position:{default:"right"}}}},polygons:{product:{style:{default:{fill:{color:"#AA3333",opacity:.15},line:{weight:1,color:"#000000",opacity:1}}}},property:{style:{default:{fill:{color:"#AA3333",opacity:.15},line:{weight:1,color:"#000000",opacity:1}}}},place:{style:{default:{fill:{color:"#AA3333",opacity:.15},line:{weight:1,color:"#000000",opacity:1}}}}},filters:{product:!1,property:!1,place:!1},tiles:{enabled:{product:[],property:[],place:[]},providers:{egPois:{type:"eg",tilesetId:"pois",url:"https://www.expedia.com/eg-tile-server",query:"",timeout:2e3}},minZoomForTileRequest:8,cache:{maxSize:-1,maxDistance:30}},contentProvider:{cacheInMs:18e5,product:{default:[]},property:{default:[]},place:{default:[]},providers:{}},historicalBoundingBoxDataEndpoint:"https://a.travel-assets.com/travel-assets-manager/df4af43c-2db9-4868-8665-96b7042a2c98/historical_bbox_data-min.json",availability:{availabilityProvider:"none",availabilityProviders:{}},locale:"en-US",iso4217CurrencyCode:"USD",routes:{egDistances:void 0,cacheInMs:18e5,style:{driving:{lineStyle:"normal",color:"#000000",width:1.5,opacity:.8},cycling:{lineStyle:"dash",color:"#000000",width:1.54,opacity:.8},walking:{lineStyle:"dot",color:"#000000",width:1.5,opacity:.8},flying:{lineStyle:"dash",color:"#000000",width:1.5,opacity:.8}}},a11y:{keyboardFeatures:{keyboardFeaturesIcon:ou.keyboardNavigationIcon}},logging:{logger:e},style:{}}},su=Ft,uu=pn,lu="on-collision";function cu(e,t,n,r,i){e.labels.aligner&&(pe(e.labels.aligner),e.labels.label=void 0,e.labels.subLabel=void 0),e.labels.textLabelPosition=n,e.labels.aligner=ge(void 0,e.labels.textLblCont,"marker-labels-aligner ".concat(n)),e.labels.container=ge(void 0,e.labels.aligner,"marker-labels-container");var o=su(r.textLabelZIndex[t.type],t.hashKeys);"sameAsMarker"!=o&&He(e.labels.aligner,i(o))}function fu(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:function(e){return e},a=su(i.textLabelPosition[t.type],t.hashKeys);n&&(cu(e,t,a,i,o),hu(e,t,n,r,i)),e.labels.updateTextLabel=function(n,r){n&&!e.labels.aligner&&cu(e,t,a,i,o),hu(e,t,n,r,i)},e.labels.updateTextLabelPosition=function(){var s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;s!==e.labels.textLabelPosition&&(cu(e,t,s,i,o),hu(e,t,n,r,i))},e.labels.toggleTextLabel=function(t){var n=e.labels.aligner;n&&(t?rt(n,lu):ot(n,lu))},e.labels.resetTextLabel=function(){e.labels.toggleTextLabel(!1),e.labels.updateTextLabelPosition(a)}}function du(e,t,n,r,i,o,a){var s=su(n[e.type],e.hashKeys),u=su(r[e.type],e.hashKeys),l=uu(i,s,u);return a?(ne(a,l),a):Pe(void 0,t,"marker-".concat(o,"-text"),void 0,l)}function hu(e,t,n,r,i){var o=e.labels,a=o.container,s=o.label,u=o.subLabel;if(n){var l=i.textLabelMaxLineLength,c=i.textLabelMaxLines;if(e.labels.label=du(t,a,l,c,n,"label",s),r){var f=i.textSubLabelMaxLineLength,d=i.textSubLabelMaxLines;e.labels.subLabel=du(t,a,f,d,r,"sublabel",u)}else pe(u),e.labels.subLabel=void 0}else e.labels&&(pe(e.labels.aligner),e.labels.aligner=void 0,e.labels.container=void 0,e.labels.label=void 0,e.labels.subLabel=void 0,e.labels.textLabelPosition=void 0)}function pu(e,t,n,r,i){var o=ce(t,["marker-labels-container"],!0),a=i(e),s=a.width,u=a.height,l=a.center,c=r||su(n.textLabelPosition[e.type],e.hashKeys),f=o.scrollWidth,d=o.scrollHeight;switch(l.x-=s/2,l.y-=u/2,c){case"right":l.y+=u/2,l.x+=s+f/2;break;case"left":l.y+=u/2,l.x-=f/2;break;case"above":l.y-=d/2,l.x+=s/2;break;default:l.y+=u+d/2,l.x+=s/2}return ct(l,f,d)}function yu(e){return yu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yu(e)}function vu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,gu(r.key),r)}}function gu(e){var t=function(e,t){if("object"!==yu(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==yu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===yu(t)?t:String(t)}var mu=yn,bu=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.maxSize=t,this.maxDistance=n,this.cache={},this.listeners=new Set,this.size=0}var t,n,r;return t=e,(n=[{key:"getTile",value:function(e,t,n){return this.cache[n]&&this.cache[n][e]?this.cache[n][e][t]:void 0}},{key:"setTile",value:function(e,t,n,r){var i=this.cache;i[n]||(i[n]={}),!i[n][e]&&mu(n)&&mu(e)&&(i[n][e]={}),!i[n][e][t]&&r?this.size=this.size+1:i[n][e][t]&&!r&&(this.size=this.size-1),mu(n)&&mu(e)&&mu(t)&&(i[n][e][t]=r),this.maxSize>0&&this.size>this.maxSize&&this._expire(e,t,n)}},{key:"addTilesListener",value:function(e){this.listeners.add(e)}},{key:"removeTilesListener",value:function(e){this.listeners.delete(e)}},{key:"_expire",value:function(t,n,r){var i=this,o=function(o){var a=function(a){var s=function(s){Rr(t,n,r,a,s,o)>i.maxDistance&&(i.listeners.forEach((function(t){return t(e.EVENTS.EXPIRE,Number(a),Number(s),Number(o),i.cache[o][a][s])})),delete i.cache[o][a][s],i.size=i.size-1)};for(var u in i.cache[o][a])s(u)};for(var s in i.cache[o])a(s)};for(var a in this.cache)o(a)}}])&&vu(t.prototype,n),r&&vu(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ku(e){return ku="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ku(e)}function wu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Pu(r.key),r)}}function Pu(e){var t=function(e,t){if("object"!==ku(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==ku(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===ku(t)?t:String(t)}bu.EVENTS={EXPIRE:"expire"};var Cu=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"loadTile",value:function(e,t,n,r,i){return Promise.reject("not implemented")}}])&&wu(t.prototype,n),r&&wu(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Lu=n(736);function xu(e){return xu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xu(e)}function Mu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_u(r.key),r)}}function _u(e){var t=function(e,t){if("object"!==xu(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==xu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===xu(t)?t:String(t)}function Fu(e,t){return Fu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Fu(e,t)}function Ou(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Su(e);if(t){var i=Su(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===xu(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function Su(e){return Su=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Su(e)}var Eu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Fu(e,t)}(o,e);var t,n,r,i=Ou(o);function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=i.call(this)).codec=new Lu.EGTSCodec,n.logger=t("EgTilesReader"),n.tilesUrlPrefix=e.url,n.query=e.query,n.tilesetId=e.tilesetId,n.queryByZoom=e.queryByZoom,n.timeout=e.timeout||500,n}return t=o,(n=[{key:"loadTile",value:function(e,t,n,r,i){var o=this,a=this.buildUrl(t,n,r,i);return this.fetchTile(a,e,t,n,r).then((function(e){return e.success?e.data.map((function(e){return o.removeColonFromQualifiers(e)})):(o.logger.error("Failed to load tile from ".concat(e.url,": ").concat(e.error.message),e.error.stack),[])}))}},{key:"removeColonFromQualifiers",value:function(e){var t;re)||void 0===t?void 0:t.map((function(e){return e.replace(":","__")})),e}},{key:"buildUrl",value:function(e,t,n,r){var i="/v1/tilesets/".concat(this.tilesetId,"/").concat(n,"/").concat(e,"/").concat(t,"/egmaps.pbf?locale=").concat(r),o=i;return this.queryByZoom&&this.queryByZoom[n]?o="".concat(i,"&").concat(this.queryByZoom[n]):this.query&&(o="".concat(i,"&").concat(this.query)),o}},{key:"fetchTile",value:function(e,t,n,r,i){var o=this;return Zn("".concat(this.tilesUrlPrefix).concat(e),this.timeout,{referrerPolicy:"no-referrer",credentials:"omit"}).then((function(t){return t.ok?t.arrayBuffer():404===t.status?void 0:Promise.reject(new Error("Server returns error code ".concat(t.status," ")+"when calling ".concat(e," for tile {x: ").concat(n,", y: ").concat(r,", zoom: ").concat(i,"}: \n              ").concat(t.statusText)))})).then((function(t){return o.handleRespons,data:t}}))})).catch((function(t){return{url:e,success:!1,error:t}}))}},{key:"handleResponse",value:function(e){return e?this.codec.decode(e):Promise.resolve([])}}])&&Mu(t.prototype,n),r&&Mu(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(Cu);function Iu(e){return Iu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Iu(e)}function Au(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Tu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Tu(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Tu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Du(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Bu(r.key),r)}}function Bu(e){var t=function(e,t){if("object"!==Iu(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Iu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Iu(t)?t:String(t)}var ju=function(){function e(t,n,r,i,o,a,s){var u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},l=u.delayBeforeRefresh,c=void 0===l?100:l,f=u.delayForceRefresh,d=void 0===f?2e3:f;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.logger=t.loggerFactory("TilesLoader"),this.delayBeforeRefresh=c,this.delayForceRefresh=d,this.refreshRequested=Date.now(),this.lastRefresh=this.refreshRequested,this.createFeature=n,this.deleteFeature=r,this.updateViewport=i,this.handleTilesLoaded=o,this.handleTilesContentLoaded=a,this.depth=s,this.tilesInFlight=new Set,this.instantiateTilesProvider(t)}var t,n,r;return t=e,(n=[{key:"instantiateTilesProvider",value:function(e){var t=this,n=e.tiles,r=n.tilesReaderConfig,i=n.tilesProvidersConfig,o=n.tilesCacheConfig,a=n.minZoomForTileRequest,s=e.locale;this.locale=s,this.tilesProvidersConfig={},Object.keys(r).forEach((function(n){r[n].forEach((function(r){if(!t.tilesProvidersConfig[r]){t.tilesProvidersConfig[r]={featureTypes:[]};var o=i[r];switch(o&&o.type||r){case"eg":t.tilesProvidersConfig[r].service=new Eu(o,e.loggerFactory);break;case"noop":t.tilesProvidersConfig[r].service=new Cu;break;default:throw new Error("Tiles provider ".concat(r," not supported"))}}t.tilesProvidersConfig[r].featureTypes.push(n)}))})),this.minZoomForTileRequest=a,this.tilesCache=new bu(o.maxSize,o.maxDistance),this.tilesCache.addTilesListener(this.handleCacheEvent.bind(this))}},{key:"getNormalizedCoord",value:function(e,t,n){var r=1<<n,i=e;return t<0||t>=r?null:((i<0||i>=r)&&(i=(i%r+r)%r),{x:i,y:t})}},{key:"registerRefreshViewport",value:function(){var e=this,t=Date.now();this.refreshRequested=t,setTimeout((function(){var n=Date.now();(e.refreshRequested===t||e.lastRefresh+e.delayForceRefresh<n)&&(e.refreshRequested=n,e.lastRefresh=n,e.updateViewpo,n,r){return"".concat(e,",").concat(t,",").concat(n,",").concat(r)}},{key:"_registerTileInFlight",value:function(e,t,n,r){this.tilesInFlight.add(this._getTileInFlightKey(e,t,n,r))}},{key:"_removeTileInFlight",value:function(e,t,n,r){this.tilesInFlight.delete(thisightTilesDone",value:function(){return 0===this.tilesInFlight.size}},{key:"_loadData",value:function(e,t,n,r,i,o,a){for(var s=Math.pow(2,a),u=i+a,l=n*s,c=r*s,f=[],d=0;d<s;d++)for(var h=0;h<s;h++)f.push(e.loadTile(t,l+d,c+h,u,o));return Promise.all(f).then((function(e){return e.flat()}))}},{key:"loadTile",value:function(e,t,n){var r=this;if(this.tilesProvidersConfig&&Object.keys(this.tilesProvidersConfig).length>0&&!isNaN(e)&&!isNaN(t)&&!isNaN(n)){var i=this.getNormalizedCoord(e,t,n);if(null!==i&&n>=this.minZoomForTileRequest&&!this.tilesCache.getTile(i.x,i.y,n)){this.tilesCache.setTile(i.x,i.y,n,[]);var o=[],a=function(e){var t=r.tilesProvidersConfig[e],a=t.service,s=t.featureTypes;r._registerTileInFlight(e,i.x,i.y,n);var u,l=Au(s);try{var c=function(){varth).then((function(n){return{data:n,tilesProvider:e,featureType:t}})))};for(l.s();!(u=l.n()).done;)c()}catch(e){l.e(e)}finally{l.f()}};for(var s in this.tilesProvidersConfig)a(s);return Promise.all(o).then((function(o){var a=[],s={};for(var u in o.forEach((function(i){var o=i.data,u=i.tilesProvider,l=i.featureType;return o.forEach((function(i){i.tile=[e,t,n],a.push(r.createFeature(i)),s[u]?s[u].includes(l)||s[u].push(l):s[u]=[l]}))})),r.tilesCache.setTile(i.x,i.y,n,a),r.tilesProvidersConfig)r._removeTileInFlight(u,i.x,i.y,n);r._areInFlightTilesDone()&&r.handleTilesContentLoaded(Object.keys(r.tilesProvidersConfig)),a.length>0&&(r.registerRefreshViewport(),Object.keys(s).forEach((function(e){return r.handleTilesLoaded(e,s[e].join(","),["(".concat(i.x,", ").concat(i.y,", ").concat(n,")")])})))})).catch((function(){return r.tilesCache.setTile(i.x,i.y,n,null)}))}}return Promise.resolve()}},{key:"handleCacheEvent",value:function(e,t,n,r,i){var o=this;e===bu.EVENTS.EXPIRE&&(this.logger.infoEnabled()&&this.logger.info("Cache expires. Deleting ".concat(i.length," features")),i.forEach((function(e){return o.deleteFeature(e)})))}}])&&Du(t.prototype,n),r&&Du(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ru(e){return Ru="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ru(e)}function Nu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Vu(r.key),r)}}function Vu(e){var t=function(e,t){if("object"!==Ru(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Ru(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Ru(t)?t:String(t)}var Uu=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.configHelper=new eu(au(),t,Ki),this.eventsManager=new ai(this.configHelper.logger("EventsManager")),this.dataRepositories=new La,this.mapData=Ds(),this.uniqId=Jt()}var t,n,r;return t=e,n=[{key:"_initializeProperties",value:function(){this.logger=this.configHelper.logger("EGMap"),this.logger.debug("initializing EGMaps"),"mapbox"===this.configHelper.mapProvider()?this.mapImpl=this._createMapBox():this.mapImpl=this._createGMaps()}},{key:"_createMapBox",value:function(){if(this.logger.debug("creating MapBox"),"undefined"!=typeof egmapsMapbox)return new egmapsMapbox.MapBox(this.configHelper,this.eventsManager,this.dataRepositories,this.mapData);throw new Error("You need to load '@eg-maps/mapbox' to use this map provider")}},{key:"_createGMaps",value:function(){if(this.logger.debug("creating GMaps"),"undefined"!=typeof egmapsGoogleMaps)return new egmapsGoogleMaps.GMaps(this.configHelper,this.eventsManager,this.dataRepositories,this.mapData);throw new Error("You need to load '@eg-maps/google-maps' to use this map provider")}},{key:"initMap",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0,i=arguments.s.configHelper.ready().then((function(){return t._initMap(e,n,r,i)})).then((function(){}))}},{key:"_cleanPreviousMapContainer",value:function(e,t){var n=se(e,["egmaps"]);return n.length>0?(t||this.logger.warn("This container contains some other instance of eg-maps.In order to avner will be cleaned."),n.forEach((function(e){return pe(e.element)})),n[0].index):-1}},{key:"_createMapContainer",value:function(e,t,n){var r=this.uniqId;null!=e&&e.id&&(r="".concat(e.id,"-").concat(r));var i=ge(r,void 0,"egmaps",void 0,n);t>=0?gt(i,e,t):e.appendChild(i);var o=this.configHelper.readParam("additionalCssClass");return o&&rt(i,o),rt(i,this.configHelper.mapProvider()),i}},{key:"updateConfiguration",value:function(e){var t,n=this,r=this.configHelper,i=r.getConfigurations(),o=null===(t=i.parameter)||void 0===t?void 0:t.externalConfigEndpoint,a=e.externalConfigEndpoint&&e.externalConfigEndpoint===o?i.external:void 0,s=new eu(au(),e,Ki,a);return s.ready().then((function(){var e=r.loadMapSettings(),t=s.loadMapSettings(),i=tu(e,t);if(Object.keys(i).filter((function(e){return i[e]})).length>0){if(n.configHelper=s,n.mapImpl.updateConfigHelperOnFeatures(n.configHelper),i.reinstantiate){var o=n.mapImpl.getBounds();n.mapImpl.syncFilterChecked(n.configHelper);var a=n.mapImpl.listRegisteredRoutes();return n.mapImpl.clearHashkeys(),n.p(n.origmapImpl.syncRegisteredRoutes(a),n.mapImpl.updateRoutesOnViewport()})).then((function(){return i}))}return n.mapImpl.updateConfiguration(n.configHelper,t,i).then((function(){return i}))}return{}}))}},{key:"_initMap",value:function(e,t,n,r){var i=this;this._initializeProperties();var o=this._cleanPreviousMapContainer(e,t),a="style-".concat(this.uniqId);return this.originalNode=e,this.node=this._createMapContainer(e,o,a),this.clientPadding=r,this.mapImpl.initMap(this.node,a,n,this.clientPadding).then((function(){return i.mapImpl}))}},{key:"centerAndZoomMap",value:function(e,t,n){var r;return!0===(null===(r=this.mapImpl)||void 0===r?void 0:r.centerAndZoomMap(e,t,n))}},{key:"getCenter",value:function(){if(this.mapImpl)return this.mapImpl.getCenter();throw new Error("map is not initialized")}},{key:"getZoom",value:function(){if(this.mapImpl)return this.mapImpl.getZoom();throw new Error("map is not initialized")}},{key:"getBounds",value:function(){if(this.mapImpl)return this.mapImpl.getBounds()ue:function(){this.mapImpl&&this.mapImpl.unbindAll(),pe(this.node)}},{key:"fitLatLongs",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;return this.mapImpl?this.mapImpl.fitLatLongs(e,!1,t,n):Promise.reject(new Error("map is not initialized"))}},{key:"fitBounds",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3?arguments[3]:void 0;return this.mapImpl?this.mapImpl.fitBounds(e,t,!1,n,r):Promise.reject(new Error("map is not initialized"))}},{key:"boundsContaining",value:function(e,t,n){return this.mapImpl?this.mapImpl.boundsContaining(e,t,n):Promise.reject(new Error("map is not initialized"))}},{key:"boundsContainingPolygon",value:function(e){return this.mapImpl?this.mapImpl.boundsContainingPolygon(e):Promise.reject(new Error("map is not initialized"))}},{key:"pushFeatureData",value:function(e,t){if(this.mapImpl)return this.mapImpl.pushFeatureData(e,t,!1);throw new Error("map is not initialized")}},{key:"removePushedFeatureData",value:function(e){if(this.mapImpl)return this.mapImpl.removePushedFeatureData(e,!1);throw new Error("map is not initialized")}},{key:"registerRoute",value:function(e,t,n){if(this.mapImpl)return this.mapImpl.registerRoute(e,t,n);throw new Error("map is not initialized")}},{key:"registerRouteDestination",value:function(){var e;if(this.mapImpl)return(e=this.mapImpl).registerRouteDestination.apply(e,arguments);throw new Error("map is not initialized")}},{key:"listRegisteredRouteDestinations",value:function(){if(this.mapImpl)return this.mapImpl.listRegisteredRouteDestinations();throw new Error("map is not initialized")}},{key:"listRegisteredRoutes",value:function(e){if(this.mapImpl)return this.mapImpl.listRegisteredRoutes(e);throw new Error("map is not initialized")}},{key:"deregisterRouteDestination",value:function(){var e;if(this.mapImpl)return(e=this.mapImpl).deregisterRouteDestination.apply(e,arguments);throw new Error("map is not initialized")}},{key:"deregisterRoute",value:function(e,t){if(this.mapImpl)return this.mapImpl.deregisterRoute(e,t);throw new Error("map is not initialized")}},{key:"showRoutes",value:function(e,t){if(this.mapImpl){for(var n,r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];return(n=this.mapImpl).showRoutes.apply(n,[e,t].concat(i))}return Promise.reject(new Error("map is not initialized"))}},{key:"hideRoutes",value:function(e,t){if(this.mapImpl){for(var n,r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];return(n=this.mapImpl).hideRoutes.apply(n,[e,t].concat(i))}return Promise.reject(new Error("map is not initialized"))}},{key:"listRoutesDisplayed",value:function(){if(this.mapImpl)return this.mapImpl.listRoutesDisplayed();throw new Error("map is not initialized")}},{key:"showPolygons",value:function(){var e;return this.mapImpl?(e=this.mapImpl).showPolygons.apply(e,arguments):Promise.reject(new Error("map is not initialized"))}},{key:"hidePolygons",value:function(){var e;return this.mapImpl?(e=this.mapImpl).hidePolygons.apply(e,arguments):Promise.reject(new Error("map is not initialized"))}},{key:"listPolygonsDisplayed",value:function(){if(this.mapImpl)return this.mapImpl.listPolygonsDisplayed();thapImpl.listFeatures(e,t);throw new Error("map is not initialized")}},{key:"selectFeature",value:function(e,t,n){if(!this.mapImpl)throw new Error("map is not initialized");thrror("map is not initialized");this.mapImpl.clearSelectedFeature()}},{key:"markFeatureOver",value:function(e,t){if(!this.mapImpl)throw new Error("map is not initializew Error("map is not initialized");this.mapImpl.markFeatureOut(e,t)}},{key:"getFeatureSelected",value:function(){if(this.mapImpl)return this.mapImpl.getFeatureSelected();throw new Error("map is not initialized")}},{key:"setPopupContent",value:function(e,t,n){if(!this.mapImpl)throw new Error("map is not initialized");this.mapImpl.setPopupContent(e,t,n)}},{key:"turnProductsVisible",value:function(e,t){if(!this.mapImpl)throw new Error("map is not initialized");this.mapImpl.turnFeaturesVisible("product",e,t,!1,!0)}},{key:"turnPropertiesVisible",value:function(e,t){if(!this.mapImpl)throw new Error("map is not initialized");this.mapImpl.turnFeaturesVisible("property",e,t,!1,!0)}},{key:"turnPlacesVisible",value:function(e,t){if(!this.mapImpl)throw new Error("map is not initialized");this.mapImpl.turnFeaturesVisible("place",e,t,!1,!0)}},{key:"addBoundChangeListener",value:function(e,t){return this.eventsManager.addBoundChangeListener(e,t)}},{key:"removeBoundChangeListener",value:function(e){return this.eventsManager.removeBoundChangeListener(e)}},{key:"deregisterBoundChangeListener",value:function(e){return this.eventsManager.deregisterBoundChangeListener(e)}},{key:"addMarkerChangeListener",value:function(e,t){return this.eventsManager.addMarkerChangeListener(e,t)}},{key:"removeMarkerChangeListener",value:function(e){return this.eventsManager.removeMarkerChangeListener(e)}},{key:"deregisterMarkerChangeListener",value:function(e){return this.eventsManager.deregisterMarkerChangeListener(e)}},{key:"addSelectionChangeListener",value:function(e,t){return this.eventsManager.addSelectionChangeListener(e,t)}},{key:"removeSelectionChangeListener",value:function(e){return this.eventsManager.removeSelectionChangeListener(e)}},{key:"deregisterSelectionChangeListener",value:function(e){return this.eventsManager.deregisterSelectionChangeListener(e)}},{key:"addFilterChangeListener",value:function(e,t){return this.eventsManager.addFilterChangeListener(e,t)}},{key:"removeFilterChangeListener",value:function(e){return this.eventsManager.removeFilterChangeListener(e)}},{key:"deregisterFilterChangeListener",value:function(e){return this.eventsManager.deregisterFilterChangeListener(e)}},{key:"addHoverChangeListener",value:function(e,t){return this.eventsManager.addHoverChangeListener(e,t)}},{key:"removeHoverChangeListener",value:function(e){return this.eventsManager.removeHoverChangeListener(e)}},{key:"deregisterHoverChangeListener",value:function(e){return this.eventsManager.deregisterHoverChangeListener(e)}},{key:"addFeatureContentLoadedListener",value:function(e,t){return this.eventsManager.addFeatureContentLoadedListener(e,t)}},{key:"removeFeatureContentLoadedListener",value:function(e){return this.eventsManager.removeFeatureContentLoadedListener(e)}},{key:"deregisterFeatureContentLoadedListener",value:function(e){return this.eventsManager.deregisterFeatureContentLoadedListener(e)}},{key:"addIdleListener",value:function(e,t){return this.eventsManager.addIdleListener(e,t)}},{key:"removeIdleListener",value:function(e){return this.eventsManager.removeIdleListener(e)}},{key:"deregisterIdleListener",value:function(e){return this.eventsManager.deregisterIdleListener(e)}},{key:"addRouteChangeListener",value:function(e,t){return this.eventsManager.addRouteChangeListener(e,t)}},{key:"removeRouteChangeListener",value:function(e){return this.eventsManager.removeRouteChangeListener(e)}},{key:"deregisterRouteChangeListener",value:function(e){return this.eventsManager.deregisterRouteChangeListener(e)}},{key:"addTilesLoadedListener",value:function(e,t){return this.eventsManager.addTilesLoadedListener(e,t)}},{key:"removeTilesLoadedListener",value:function(e){return this.eventsManager.removeTilesLoadedListener(e)}},{key:"deregisterTilesLoadedListener",value:function(e){return this.eventsManager.deregisterTilesLoadedListener(e)}},{key:"addTilesContentLoadedListener",value:function(e,t){return this.eventsManager.addTilesContentLoadedListener(e,t)}},{key:"removeTilesContentLoadedListener",value:function(e){return this.eventsManager.removeTilesContentLoadedListener(e)}},{key:"deregisterTilesContentLoadedListener",value:function(e){return this.eventsManager.deregisterTilesContentLoadedListener(e)}},{key:"addMapTypeChangedListener",value:function(e,t){return this.eventsManager.addMapTypeChangedListener(e,t)}},{key:"deregisterMapTypeChangedListener",value:function(e){return this.eventsManager.deregisterMapTypeChangedListener(e)}},{key:"setStay",value:function(e){if(this.mapImpl)return this.mapImpl.setStay(ion(){return this.mapImpl?this.mapImpl."map is not initialized");this.mapImpl.turnKeyboardFeaturesMode(e)}},{key:"isKeyboardFeaturesModeEnabled",value:function(){if(this.mapImpl)return this.mapImpl.isKeyboardFeaturesModeEnabled();throw nlper.getActiveTilesets();throw new Error("map is not initialized")}},{key:"readConfigParam",value:function(eSubConfig",value:function(e){retvalue:function(){return this.configHelper.getEGMapConfigurations()}},{key:"updatePartiallyFeature",value:function(e){if(this.mapImpl)return this.mapImpl.updatePartiallyFeature(e);throw new Error("map is not initialized")}},{key:"addQualifierToFeature",value:function(e,t){if(this.mapImpl){for(var n,r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];return(n=this.mapImpl).addQualifierToFeature.apply(n,[e,t].concat(i))}throw new Error("map is not initialized")}},{key:"addQualifierToFeatures",value:function(e){if(this.mapImpl){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return(t=this.mapImpl).addQualifierToFeatures.apply(t,[e].concat(r))}throw new Error("map is not initialized")}},{key:"removeQualifierFromFeature",value:function(e,t){if(this.mapImpl){for(var n,r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];return(n=this.mapImpl).removeQualifierFromFeature.apply(n,[e,t].concat(i))}throw new Error("map is not initialized")}},{key:"removeQualifierFromFeatures",value:function(e){if(this.mapImpl){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return(t=this.mapImpl).removeQualifierFromFeatures.apply(t,[e].concat(r))}throw new Error("map is not initialized")}}],n&&Nu(t.prototype,n),r&&Nu(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()}(),r}()},22676:function(e,t,n){var r;window,e.exports=(r=n(90439),function(){var e={621:function(e){e.exports=r}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(r){return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return function(){n.r(i);var e={};n.r(e),n.d(e,{GMaps:function(){return ne}});var t=n(621);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(){return l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=v(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},l.apply(this,arguments)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(o=void 0,o=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i.key,"string"),"symbol"===r(o)?o:String(o)),i)}var o}function d(e,t,n){return t&&f(e.prototype,t),n&&f(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}function p(e,t){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},p(e,t)}function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=v(e);if(t){var o=v(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}var g=t.Utils.firstDefinedValue,m=t.Utils.firstDefinedValueAndKey,b=t.Utils.firstDefinedKey,k=t.Utils.removeDuplicates,w=t.Utils.roundLatOrLng,P=t.Utils.roundLatLng,C=t.Utils.isArray,L=t.Utils.getPaddedZoomAndCenter,x=t.Utils.roundZoom,M=t.Geo.computeZoomFromBBox,_=t.Geo.addMeterToLat,F=t.Geo.convertGeoJsonPolygonToPath,O=t.MarkerUtils.setAccessibilityFields,S=t.MarkerUtils.createCornerIcons,E=t.MarkerUtils.createInnerIcons,I=t.MarkerUtils.createDoubleClickEventCanceller,A=t.MarkerUtils.createImageIcon,T=t.MarkerUtils.createBasicTextMarker,D=t.Labels.createLabels,B=256,j=256,R=function(e){h(n,e);var t=y(n);function n(e,r,i,o,a,s){var u;return c(this,n),(u=t.call(this,e,r,i,o,a,s,0)).tileSize=new google.maps.Size(B,j),u.debugTileId=e.tiles.debugTileId,u}return {var r=this;if(setTimeout((function(){return r.loadTile(e.x,e.y,t)}),10),this.debugTileId){var i=n.createElement("div");return i.innerHTML=String(e),i.style.width=this.tileSize.width+"px",i.style.height=this.tileSize.height+"px",i.style.fontSize="10",i.style.borderStyle="solid",i.style.borderWi:function(){this.getPanes().overlayMouseTarget.removeAllChildren()}}]),n}(t.TilesLoader),N={type:"click",dom:!0},V={type:"dragstart",dom:!1},U={type:"click",dom:!0},z={type:"center_changed",dom:!1},K={type:"bounds_changed",dom:!1},H={type:"zoom_changed",dom:!1},Z={type:"mouseenter",dom:!0},q={type:"mouseleave",dom:!0},W={type:"tilesloaded",dom:!1},G={type:"idle",dom:!1},Q={type:"focus",dom:!0},$={type:"focusout",dom:!0},X={type:"keydown",dom:!0},Y={type:"keyup",dom:!0},J={type:"keypress",dom:!0},ee={type:"maptypeid_changed",dom:!1},te="marker-icon",ne=function(e){h(r,e);var n=y(r);function r(e,t,i,o){var a;return c(this,r),(a=n.call(this,e,t,i,o)).logger=e.logger("GMaps"),a.logger.debug("GMaps constructor"),a.mapFocusListenersToRegister=[],a.visiblePolygonsByKey=new Map,a}return d(r,[{key:"_buildMapProviderOptions",value:function(e,t){var n,r={keyboardShortcuts:!1};return null!==(n=this.settings.googleMaps)&&void 0!==n&&n.gmapsAddConfig&&Object.assign(r,this.settings.googleMaps.gmapsAddConfig),e&&t&&(r.zoom=e,r.center={lat:t[0],lng:t[1]}),r}},{key:"updateMapProviderConfig",value:function(){var e=this._buildMapProviderOptions(this.realmap.getZoom(),this.getCenter());this.realmap.setOptions(e)}},{key:"removeMarkerFromMap",value:function(e){t.HtmlUtils.detachElement(e),e.debug&&e.debug.setMap(null),e.clean.forEach((function(e){return e()}))}},{key:"cloneMarker",value:function(e){return null==e?void 0:e.clone()}},{key:"_callbackWhenElementReattached",value:function(){var e=this;return new Promise((function(t){setTimeout((function(){var n=e.temporaryDiv;e.temporaryDiv=void 0,e._reattachElementFromTemporaryDiv(n,e.customMarkerOverlay.getPanes().overlayMouseTarget),e._updateViewport(),t()}),20)}))}},{key:"init",value:function(e,n){var r=this,i=this.addEventListener.bind(this),o=this._zoomAndCenterFromViewport(e,n)||{},a=o.zoom,s=o.center,u=this._buildMapProviderOptions(a,s);return this.node&&(this.realmap=new google.maps.Map(this.node,u)),this._registerListenersMap(),this._initializeTilesOverlayMapType(),t.HtmlUtils.documentIsDefined()&&(this.temporaryDiv=t.HtmlUtils.createDiv(this.uniqId("temporaryDiv"))),this._initializeCustomMarkerOverlay(this.temporaryDiv,this._callbackWhenElementReattached.bind(this)).then((function(){r.mapNavFocusElement=r._findMapFocusElement(),r.mapNavFocusElement&&r.mapFocusListenersToRegister.forEach((function(e){var t=e.eventDef,n=e.cb;r.listenersToDeregister.push(i(r.mapNavFocusElement,t,n))})),r.popup=r._createPopup(),r._registerKeyboardListeners(),r._registerMapFocusListeners(),r._registerTilesLoadedListener(),r._updateViewport()})),this.configHelper.readParam("map,mapInitWaitForTiles")?new Promise((function(e){return i(r.realmap,W,e,!0)})):Promise.resolve()}},{key:"_findMapFocusElement",value:function(){var e;if(this.node)return null===(e=t.HtmlUtils.childrenAsArray(this.node).map((function(e){var n;return null===(n=t.HtmlUtils.anyChildrenWithClasses(e,["gm-style"],!1)[0])||void 0===n?void 0:n.element})).filter((function(e){return void 0!==e}))[0])||void 0===e?void 0:e.children[0]}},{key:"registerListenerOnMapFocusElement",value:function(e,t){this.mapNavFocusElement?this.listenersToDeregister.push(this.addEventListener(this.mapNavFocusElement,e,t)):this.mapFocusListenersToRegister.push({eventDef:e,cb:t})}},{key:"_registerMapFocusListeners",value:function(){var e=this;this.keyboardFeatures&&this.mapNavFocusElement&&(this.listenersToDeregister.push(this.addEventListener(this.mapNavFocusElement,Q,(function(){return e.keyboardFeatures.refreshKeyboardNavIconVisibility()}))),this.listenersToDeregister.push(this.addEventListener(this.mapNavFocusElement,$,(function(){return e.keyboardFeatures.refreshKeyboardNavIconVisibility(!1)}))))}},{key:"_registerTilesLoadedListener",value:function(){var e=this;thlmap,W,(function(){return e.handleTilesLoaded("mapProvider","map")})))}},{key:"_initializeTilesOverlayMapType",value:function(){var e;this.tilesLoader=new R(this.settings,this.createTileFeature.bind(this),this.removeTileFeature.bind(this),this._updateViewport.bind(this),this.handleTilesLoaded.bind(this),this.handleTilesContentLoaded.bind(this)),null===(e=this.realmap)||void 0===e||null===(e=e.overlayMapTypes)||void 0===e||e.insertAt(0,this.tilesLoader)}},{key:"_reattachElementFromTemporaryDiv",value:function(e,n){if(e)for(var r=e.children,i=0;i<((null==r?void 0:r.length)||-1);i++)t.HtmlUtils.reattachElement(r[i],n)}},{key:"_initializeCustomMarkerOverlay",value:function(e,n){var r=this,i=this._updateMarkerPosition.bind(this),o=this.features.all.bind(this),a=function(r,i,o,a,u){this.updateTextMarkerPosition=i,this.listAllFeatures=o,this.onAdd=function(){var r=this.getPanes().overlayMouseTarget;a(e),t.HtmlUtils.setZIndex(r,google.maps.Marker.MAX_ZINDEX+1),n(),u()},thisFeatures().forEach((function(e){t.HtmlUtils.detachElement(e.popup)}));var e,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=s(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}(this.clusters);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.HtmlUtilsnally{n.f()}},this.draw=function(){this.updateTextMarkerPosition()}};return a.prototype=new google.maps.OverlayView,new Promise((function(e){r.customMarkerOverlay=new a(r.realmap,i,o,r._reattachElementFromTemporaryDiv.bind(r),e)}))}},{key:"getMarkerComponent",value:function(e){return e.marker}},{key:"moveMarkerPosition",value:function(e,t){var n=this.customMarkerOverlay.getProjection(),r=n.fromLatLngToDivPixel(new google.maps.LatLng(e.latLng[0],e.latLng[1])),i={x:r.x+t.x,y:r.y+t.y},o=n.fromDivPixelToLatLng(i);e.latLng[0]=o.lat(),e.latLng[1]=o.lng(),e.computedLatLng=[o.lat(),o.lng()],this.getMarkerComponent(e).position=o,this._updateMarkerPositionOnLayer(e,n)}},{key:"_updateViewport",value:function(e){var t,n=this;return null!==(t=this.customMarkerOverlay)&&void 0!==t&&null!==(t=t.getPanes())&&void 0!==t&&t.overlayMouseTarget?l(v(r.prototype),"_updateViewport",this).call(this,e).then((function(e){return n._updateMarkerPosition(),e})):Promise.resolve(e)}},{key:"getRectOfMarker",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.customMarkerOverlay.getProjection(),i=e.computedLatLng&&e.computedLatLng[0]?e.computedLatLng[0]:e.latLng[0],o=e.computedLatLng&&e.computedLatLng[1]?e.computedLatLng[1]:e.latLng[1],a=r.fromLatLngToDivPixel(new google.maps.LatLng(i,o)),s=this.getMarkerComponent(e),u=s.clientWidth,l=s.clientHeight;return t.HtmlUtils.getRect(a,u+2*n,l+2*n)}},{key:"_updateMarkerPosition",value:function(e){var t=this;if(this.customMarkerOverlay){var n=this.customMarkerOverlay.getProjection();if(n){var i=e?e.filter((function(e){return t.getMarkerComponent(e)})):this.features.all().filter((function(e){return t.getMarkerComponent(e)})).concat(this.clusters||[]);if(this.settings.isAtLeastOnePropertyStatusUsingObfuscateMarker||this.settings.isAtLeastOneProductStatusUsingObfuscateMarker){var o=this.getCenter();Object.values(this.settings.obfuscateRadiusInMeters).forEach((function(e){var r=[w(_(o[0],2*e.radius)),o[1]];e.width=Math.round(t._fromLatLngToDivPixel.apply(t,[n].concat(a(o))}i.forEach((function(e){return t._updateMarkerPositionOnLayer(e,n)})),l(v(r.prototype),"_updateMarkerPosition",this).call(this,i),this.updatePopupPositionOnLayer()}}}},{key:"_updateMarkerPositionOnLayer",value:function(e,n){if(e&&this.getMarkerComponent(e)&&n){var r=n.fromLatLngToDivPixel(this.getMarkerComponent(e).position);if(r){var i="middle";switch(e.markerType){case"pin":case"price":case"text":i="bottom"}t.HtmlUtils.setPosition(this.getMarkerComponent(e),r.x+0,r.y+0,i)}}}},{key:"_fromLatLngToDivPixel",value:function(e,t,n){return null==e?void 0:e.fromLatLngToDivPixel(new google.maps.LatLng(t,n))}},{key:"_fromDivPixelToLatLng",value:function(e,t,n){return null==e?void 0:e.fromDivPixelToLatLng(new google.maps.Point(t,n))}},{key:"updatePopupPositionOnLayer",value:function(){var e,n=(this.popup||{}).feature;if(null!==(e=this.customMarkerOverlay)&&void 0!==e&&e.getProjection()&&n&&n.defined){var r,i,o,s=this._fromLatLngToDivPixel.apply(this,[this.customMarkerOverlay.getProjection()].concat(a(n.latLng)));switch(g(this.settings.popupPositions[n.type],n.hashKeys)){case"above":default:r=0,i=-2,o="bottom";break;case"below":r=0,i=2,o="top"}s&&t.HtmlUtils.setPosition(this.popup,s.x+r,s.y+i,o)}}},{key:"ensurePopupVisibility",value:function(){var e=this.popup,t=e.feature,n=e.offsetWidth,r=e.offsetHeight,i=this.node,s=i.offsetWidth,u=i.offsetHeight,l=g(this.configHelper.popupVisibilityPaddings()[t.type],t.hashKeys),c=null==l?void 0:l.x,f=null==l?void 0:l.y,d="below"===g(this.settings.popupPositions[t.type],t.hashKeys),h=d?1:-1,p=this.getRectOfMarker(t).height,y=this._fromLatLngToDivPixel.apply(this,[this.customMarkerOverlay.getProjection()].concat(a(t.latLng))),v={x:y.x+s/2-n/2,y:y.y+p*h+u/2+r*h},m=o(this._calculatePopupVisibilityOffsetValues(v,c,f,s,u,n,r,d),2),b=m[0],k=m[1];0===b&&0===k||this.realmap.panBy(b,k)}},{key:"_registerListenersMap",value:function(){var e=this;this._registerListenerForIdle(),this._registerCenterChangedEventLogic(),this._registerZoomListener(),this.listenersToDeregister.push(this.addEventListener(this.realmap,V,this.handleDragStart.bind(this))),this.listenersToDeregister.push(this.addEventListener(this.node,U,this.handleMapClick.bind(this))),this.listenersToDeregister.push(this.addEventListener(this.realmap,ee,function(){e.eventsManager.pushEvent(t.EventTypes.mapTypeChanged,{mapTypeId:e.realmap.getMapTypeId()})}.bind(this)))}},{key:"_registerListenerForIdle",value:function(){this.idle=!0;var e=this;th(function(){e.idle=!0,e.eventsManager.pushEvent(t.EventTypes.idle)}))),th(this.addEventListener(this.realmap,K,(function(){return e.idle=!1})))}},{key:"_registerKeyboardListeners",value:function(){var e=this,n=this.getZoom.bind(this);return this.registeredEvents={ksteners((function(t){var n;return(n=e.realmap).panBy.apply(n,a(t))}),(function(){return e.realmap.setZoom(n()+1)}),(function(){return e.realmap.setZoom(n()-1)}),this.registeredEvents.keyboardFeatures),[this.addEventListener(this.mapNavFocusElement,X,this.keyboardListeners.keyDownListenerCallback),this.addEventListener(this.mapNavFocusElement,Y,this.keyboardListeners.keyUpListenerCallback),this.addEventListener(this.mapNavFocusElement,J,this.keyboardListeners.keyPressListenerCallback)]}},{key:"_registerCenterChangedEventLogic",value:function(){var e=this;this.listenersToDeregister.push(this.addEventListener(this.realmap,z,(function(){void 0===e.mapViewportInfoBeforeIdle&&(e.mapViewportInfoBeforeIdle={center:e.getCenter(),zoom:e.getZoom()})}))),this.listenersToDeregister.push(this.addEventListener(this.realmap,G,(function(){if(void 0!==e.mapViewportInfoBeforeIdle){var t=e.getCenter(),n=e.handleBoundsChanged.bind(e);setTimeout((function(){var r=e.getCenter();if(r[0]===t[0]&&r[1]===t[1]){var i,o,a,s,u=null!==(i=e.getZoom()-(null===(o=e.mapViewportInfoBeforeIdle)||void 0===o?void 0:o.zoom))&&void 0!==i?i:0,l=null===(a=e.mapViewportInfoBeforeIdle)||void 0===a?void 0:a.center;e.mapViewportInfoBeforeIdle=void 0;var c=((null===(s=e.registeredEvents)||void 0===s?void 0:s.keyboardFeatures)||[]).splice(0);0!==u||!l||r[0]===l[0]&&r[1]===l[1]||(c.length>0?k(c).forEach(n):n("drag"))}}),50)}})))}},{key:"_registerZoomListener",value:function(){var e=this;this.lastZoomValueChecked=[this.getZoom()],this.listenersToDeregister.push(this.addEventListener(this.realmap,H,(function(){e.boundChangedDisabled?e.lastZoomValueChecked=[e.getZoom()]:e.lastZoomValueChecked.push(e.getZoom())}))),this.listenersToDeregister.push(this.addEventListener(this.realmap,G,(function(){if(e.lastZoomValueChecked.length>1){var t=e.getZoom(),n=e.handleBoundsChanged.bind(e);setTimeout((function(){var r=e.getZoom();if(r===t){var i,a=r>o(e.lastZoomValueChecked.splice(0,e.lastZoomValueChecked.length-1),1)[0],s=((null===(i=e.registeredEvents)||void 0===i?void 0:i.keyboardFeatures)||[]).splice(0);s.length>0?k(s).forEach(n):a?e.handleBoundsChanged("zoomIn"):e.handleBoundsChanged("zoomOut")}}),100)}})))}},{key:"_createCallbackForBoundsChanged"=this.handleBoundsChanged.bind(this);return function(){return t(e)}}},{key:"centerAndZoomMap",value:function(e,t,n){var r=o(e?P(e):[],2),i=r[0],a=r[1],s=t?x(t):void 0;if(void 0!==i&&void 0!==a&&void 0!==s&&void 0!==n){var u=this._parseClientPadding(n),l=this._getPaddedZoomAndCenterForCenterAndZoom(e,s,u)||{},c=l.zoom,f=l.center;if(void 0!==c&&void 0!==f){var d=o(f,2);i=d[0],a=d[1],s=c}}var h=this.realmap.getCenter(),p=o(P([h.lat(),h.lng()])||[],2),y=p[0],v=p[1],g=void 0!==i&&void 0!==a&&(y!==i||v!==a)||void 0!==s&&this.getZoom()!==s;return g&&this._fitViewport(s,[i,a],!1).then(this._updateViewport.bind(this)),g}},{key:"isFeatureInRealBound",value:function(e,t){return null==e?void 0:e.contains({lat:t.latLng[0],lng:t.latLng[1]})}},{key:"asNativeBounds",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return new google.maps.LatLngBounds(new google.maps.LatLng(w(e[0]),w(e[1],void 0,n)),new google.maps.LatLng(w(t[0]),w(t[1],void 0,n)))}},{key:"getCenter",value:function(){var e=this.realmap.getCenter();return[w(e.lat()),w(e.lng())]}},{key:"getZoom",value:function(){return x(this.realmap.getZoom())}},{key:"unbindAll",value:function(){this.listenersToDeregister.forEach((function(e){return e()})),this.customMarkerOverlay&&this.customMarkerOverlay.unbindAll(),this.realmap.unbindAll()}},{key:"asBounds",value:function(e){if(e){var t=e.getSouthWest(),n=e.getNorthEast(),r=this.getCenter();return{sw:[w(t.lat()),w(t.lng())],ne:[w(n.lat()),w(n.lng())],center:r}}}},{key:"containerBounds",value:function(e){if(this.customMarkerOverlay){var t=this.customMarkerOverlay.getProjection();if(t){var n=t.fromContainerPixelToLatLng(new google.maps.Point(e.offsetLeft-e.offsetWidth/2,e.offsetTop+e.offsetHeight/2)),r=t.fromContainerPixelToLatLng(new google.maps.Point(e.offsetLeft+e.offsetWidth/2,e.offsetTop-e.offsetHeight/2));return{sw:[w(n.lat()),w(n.lng())],ne:[w(r.lat()),w(r.lng())],center:[w(n.lat()+(n.lat()-r.lat())/2),w(r.lnvalue:function(e){return e.getNorthEast().equals(e.getSouthWest())}},{key:"_extendsOneCoordinateBounds",value:function(e){var t=new google.maps.LatLng(e.getNorthEast().lat()+.01,e.getNorthEast().lng()+.01),n=new google.maps.LatLng(e.getNorthEast().lat()-.01,e.getNorthEast().lng()-.01);e.extend(t),e.extend(n)}},{key:"computeNativeBoundsFromLatLongs",value:function(e){if(e.length>0){var t=new google.maps.LatLngBounds;return e.forEach((function(e){var n=o(P(e),2),r=n[0],i=n[1];t.extend(new google.maps.LatLng(r,i))})),t}}},{key:"fitLatLongs",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3?arguments[3]:void 0;if(this.realmap){var i=this._parseClientPadding(r),o=this._getPaddedZoomAndCenterFromLatLongs(e,n,i)||{},a=o.zoom,s=o.center;if(void 0!==a&&void 0!==s){var u=this._updateViewport.bind(this),l=this.asBounds.bind(this);return this._fitViewport(a,s,t).then(u).then(l)}return Promise.resolve(this.getBounds())}return Promise.reject("map is not ready")}},{key:"nativeBounds",value:function(){var e,t;return(null===(e=this.customMarkerOverlay)||void 0===e||null===(e=e.getProjection())||void 0===e||null===(e=e.getVisibleRegion())||void 0===e?void 0:e.latLngBounds)||(null===(t=this.realmap)||void 0===t?void 0:t.getBounds())}},{key:"switchMarkerType",value:function(e,t){l(v(r.prototype),"switchMarkerType",this).call(this,e,t)&&this.customMarkerOverlay&&this._updateMarkerPositionOnLayer(e,this.custoeMarkerPositionOnLayer(e,this.customMarkerOverlay.getProjection())}},{key:"_fitViewport",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(void 0!==e||t){var i=this.nativeBounds.bind(this),o=this,a=this.realmap,s=this.addEventListener.bind(this),u=function(){return new Promise((functingedDisabled=!r,s(a,G,(function(){o.boundChangedDisabled=!1,u(i())}),!0),a.setZoom(e)):u(i())};t?(o.boundChangedDisabled=!r,n.addEventListener(a,G,l,!0),a.setCenter(new google.maps.LatLng(t[0],t[1]))):w Promise((function(e){return s(a,G,(function(){return u().then(e)}),!0)}))}return Promise.resolve()}},{key:"_zoomAndCenterFromViewport",value:function(e,t){if(e){var n=e.center,r=e.zoom,i=e.sw,o=e.ne,a=e.coordinates,s=e.useBoundsComputation,u=e.options,l=this._parseClientPadding(t);if(n&&r)return this._getPaddedZoomAndCenterForCenterAndZoom(n,r,l);if(i&&o){var c=P(i),f=P(o);return this._getPaddedZoomAndCenterForBounds(c,f,!1,l)}if(a&&s){var d=this._computeNativeBounds(a,s,u),h=this._computeZoomAndCenterFromGmapsBounds(d,!1,l)||{},p=h.zoom,y=h.center;if(p&&y)return L(p,y,l)}else if(C(e)&&e.length>0)return this._getPaddedZoomAndCenterFromLatLoomAndCenterForCenterAndZoom",value:function(e,t,n){return L(t,e,n)}},{key:"_getPaddedZoomAndCenterForBounds",value:function(e,t,n,r){var i=new google.maps.LatLngBounds(new google.maps.LatLng(e[0],e[1]),new google.maps.LatLng(t[0],t[1])),o=this._computeZoomAndCenterFromGmapsBounds(i,n,r)||{},a=o.zoom,s=o.center;if(a&&s)return L(a,s,r)}},{key:"_getPaddedZoomAndCenterFromLatLongs",value:function(e,t,n){var r=this._computeZoomAndCenterFromGmapsBounds(this.computeNativeBoundsFromLatLongs(this.boundsComputation.computeBoundingBox(e)),t,n)||{},i=r.zoom,o=r.center;if(i&&o)return L(i,o,n)}},{key:"_computeZoomAndCenterFromGmapsBounds",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=e;this._boundsForOneCoordinate(r)&&(r=new google.maps.LatLngBounds(r.getSouthWest(),r.getNorthEast()),this._extendsOneCoordinateBounds(r));var i=M(this.node,r.getSouthWest().lat(),r.getSouthWest().lng(),r.getNorthEast().lat(),r.getNorthEast().lng(),{zoomMax:21,padding:t?this.settings.googleMaps.padding:0,parsedClientPadding:n});if(isFinite(i))return{zoom:i,center:P([r)])}}},{key:"getTileDim",value:function(){return{width:B,height:j}}},{key:"fitBounds",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4?arguments[4]:void 0;if(this.realmap){var a=this._parseClientPadding(i),s=P(e),u=P(t),l=this._getPaddedZoomAndCenterForBounds(s,u,r,a)||{},c=l.zoom,f=l.center;if(void 0!==c&&void 0!==f){var d=this.getZoom(),h=o(this.getCenter(),2),p=h[0],y=h[1];if(p!==f[0]||y!==f[1]||d!==c){var v=this._updateViewport.bind(this),g=this.asBounds.bind(this);return this._fitViewport(c,f,n).then(v).then(g)}}return Promise.resolve(this.getBounds())}return Promise.reject("map is not ready")}},{key:"addEventListener",value:function(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return!t.dom||e instanceof google.maps.Polygon?(r=i?google.maps.event.ad(e,t.type,n),function(){return google.maps.event.removeListener(r)}):(i?e.addEventListenerOnce(t.type,n):e.addEventListener(t.type,n),function(){return e.removeEventListener(t.type,n)})}},{key:"_createPopup",value:function(){var e=this._createGenericPopup(this._getMainParent());return t.HtmlUtils.setZIndex(e,this.settings.maxZIndex+1),t.HtmlUtils.setDisplayNone(e),e.visibleElement=e,e.cssElement=e,e.clean=[].concat(a(this.registerCompListeners(e,"popup")),[I(e,this.addEventListener.bind(this))]),e}},{key:"registerCompListeners",value:function(e,n,r){var i=this,o=this.handleMarkerClick.bind(this),a=this.handleMarkerMouseOver.bind(this),s=this.handleMarkerMouseOut.bind(this),u=function(e,n){t.HtmlUtils.isAnHtmlElement(e)&&n.stopPropagation(),n.stop&&(n.stop(),i.ignoreMapClickEvent=!0)};return[this.addEventListener(e,N,(function(t){u(e,t),o(r,n,t.type)})),this.addEventListener(e,Z,(function(t){u(e,t),a(r,n,t.type)})),this.addEventListener(e,q,(function(t){u(e,t),s(r,n,t.type)})),I(e,this.addEventListener.bind(this))]}},{key:"_createDebugMarker",value:function(e){return this.settings.debugMarkersPosition?{debug:new google.maps.Marker({position:new google.maps.LatLng(e.latLng[0],e.latLng[1]),map:this.realmap}),style:"opacity: 0.5"}:{}}},{key:"clearObfuscateArea",value:function(e){var t,n,r;null!=e&&null!==(t=e.marker)&&void 0!==t&&null!==(t=t.obfuscateArea)&&void 0!==t&&t.setMap&&(null==e||null===(r=e.marker)||void 0===r||null===(r=r.obfuscateArea)||void 0===r||r.setMap(null)),null==e||null===(n=e.marker)||void 0===n||delete n.obfuscateArea}},{key:"_createObfuscatedPolygon",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.getCirclePolygonData(e);return new google.maps.Polygon({paths:n,map:this.realmap.data.getMap(),clickable:t})}},{key:"_updateObfuscateAreaStyle",value:function(e,t){var n,r,i,o,a,s=m(this.settings.obfuscateStyle[e.type],e.hashKeys),u=s.key,l=s.value;t.setOptions({fillColor:null==l||null===(n=l.fill)||void 0===n?void 0:n.color,fillOpacity:null==l||null===(r=l.fill)||void 0===r?void 0:r.opacity,strokeColor:null==l||null===(i=l.line)||void 0===i?void 0:i.color,strokeOpacity:null==l||null===(o=l.line)||void 0===o?void 0:o.opacity,strokeWeight:null==l||null===(a=l.line)||void 0===a?void 0:a.weight}),t.styleKey=u}},{key:"hasObfuscateAreaStyleChanged",value:function(e){var t,n;return(null===(t=this.getMarkerComponent(e))||void 0===t?void 0:t.obfuscateArea)&&(null===(n=this.getMarkerComponent(e))||void 0===n||null===(n=n.obfuscateArea)||void 0===n?void 0:n.styleKey)!==b(this.settings.obfuscateStyle[e.type],e.hashKeys)}},{key:"_getMainParent",value:function(){var e;return(null===(e=this.customMarkerOverlay)||void 0===e||null===(e=e.getPanes())||void 0===e?void 0:e.overlayMouseTarget)||this.temporaryDiv}},{key:"createPinMarkerWithClickListener",value:function(e,n,r){var i=e.feature,o=e.cornerIcons,a=e.innerIcons,s=e.cssClasses,u=e.zIndex,l=e.label,c=e.subLabel,f=e.ariaLabels,d=this._createDebugMarker(i),h=d.debug,p=d.style,y=this.uniqId("marker-".concat(this.asKey(i))),v="".concat(s.join(" ")).concat("none"!==r?" frame-".concat(r):""),g=t.HtmlUtils.createDiv(y,this._getMainParent(),v,p),m=A(n,g,r,!0,te),b=m.iconImg,k=m.main;return g.frameIcon=r,t.HtmlUtils.setAriaHidden(k),g.iconElements={cornerIcons:o,innerIcons:a},S(g,o),E(b,a),t.HtmlUtils.setZIndex(g,u),g.ariaElement=g,O(i.highlighted,g.ariaElement,f),g.zIndexElement=g,g.iconElements.pin=k,g.clone=function(){return g.cloneNode(!0)},g.bounceElement=k,g.cssElement=g,g.labels={textLblCont:g},D(g,i,l,c,this.settings,this._zIndexAdjustment),g.clean=this.registerCompListeners(g,"pin",i),g.position=new google.maps.LatLng(i.latLng[0],i.latLng[1]),g.debug=h,g}},{key:"createTextMarkerWithClickListener",value:function(e,n,r){var i=e.feature,o=e.cornerIcons,a=e.innerIcons,s=e.cssClasses,u=e.zIndex,l=e.label,c=e.subLabel,f=e.ariaLabels,d=this._createDebugMarker(i),h=d.debug,p=d.style,y=this.uniqId("marker-".concat(this.asKey(i))),v=T(y,this._getMainParent(),r,null==s?void 0:s.join(" "),n,p),g=v.main,m=v.text,b=v.span;return g.iconElements={cornerIcons:o,innerIcons:a},S(m,o),E(b,a),t.HtmlUtils.setZIndex(g,u),g.ariaElement=m,O(i.highlighted,g.ariaElement,f),g.zIndexElement=g,g.clone=function(){return g.cloneNode(!0)},g.bounceElement=m,g.cssElement=g,g.labels={textLblCont:g},g.label=n,D(g,i,l,c,this.settings,this._zIndexAdjustment.bind(this)),g.clean=this.registerCompListeners(g,r,i),g.position=new google.maps.LatLng(i.latLng[0],i.latLng[1]),g.debug=h,g}},{key:"createClusterMarkerWithClickListener",value:function(e,n,r,i){var o=this._createDebugMarker(e),a=o.debug,s=o.style,utMainParent(),e,n,r,i,s);u.clone=function(){return u.cloneNode(!0)};var l=g(this.settings.zIndexes[e.type],e.hashKeys);return t.HtmlUtils.setZIndex(u,l),u.zIndexElement=u,u.clean=this.registerCompListeners(u,"clusterMarker",e),u.position=new google.maps.LatLng(e.latLng[0],e.latLng[1]),u.debug=a,u}},{key:"createObfuscateMarkerWithClickListener",value:function(e){var n=this,r=e.feature,i=e.cssClasses,o=e.zIndex,a=e.label,s=e.subLabel,u=e.ariaLabels,l=this._createDebugMarker(r),c=l.debug,f=l.style,d=this.uniqId("marker-".concat(this.asKey(r))),h=t.HtmlUtils.createDiv(d,this._getMainParent(),i.join(" "),f),p=this._createObfuscatedPolygon(r,!0);return this._updateObfuscateAreaStyle(r,p),t.HtmlUtils.setZIndex(h,o),h.ariaElement=h,O(r.highlighted,h.ariaElement,u),h.zIndexElement=h,h.cssElement=h,h.labels={textLblCont:h},D(h,r,a,s,this.settings,this._zIndexAdjustment),h.clean=this.registerCompListeners(p,"obfuscate",r),h.position=new google.maps.LatLng(r.latLng[0],r.latLng[1]),h.clone=function(){return n.cloneObfuscatedPolygon(r,h)},h.obfuscateArea=p,h.debug=c,h}},{key:"createPinObfuscateMarkerWithClickListener",value:function(e,n,r){var i=this,o=e.feature,a=e.cornerIcons,s=e.innerIcons,u=e.cssClasses,l=e.zIndex,c=e.label,f=e.subLabel,d=e.ariaLabels,h=this._createDebugMarker(o),p=h.debug,y=h.style,v=this.uniqId("marker-".concat(this.asKey(o))),g="".concat(u.join(" ")).concat("none"!==r?" frame-".concat(r):""),m=t.HtmlUtils.createDiv(v,this._getMainParent(),g,y),b=t.HtmlUtils.createDiv(void 0,m,"pin-marker"),k=t.HtmlUtils.createDiv(void 0,b,"marker-icon-inter");t.HtmlUtils.setAriaHidden(k);var w=A(n,k,r,!0,te),P=w.iconImg,C=w.main;m.frameIcon=r,m.iconElements={cornerIcons:a,innerIcons:s},S(k,a),E(P,s);var L=this._createObfuscatedPolygon(o);return this._updateObfuscateAreaStyle(o,L),t.HtmlUtils.setZIndex(b,l),m.ariaElement=b,O(o.highlighted,m.ariaElement,d),m.zIndexElement=b,m.bounceElement=C,m.cssElement=m,m.labels={textLblCont:t.HtmlUtils.isAnHtmlElement(n)?C:k},m.iconElements.pin=C,m.obfuscateArea=L,m.clone=function(){return i.cloneObfuscatedPolygon(o,m)},D(m,o,c,f,this.settings,this._zIndexAdjustment),m.clean=this.registerCompListeners(b,"pinObfuscate",o),m.position=new google.maps.LatLng(o.latLng[0],o.latLng[1]),m.debug=p,m}},{key:"createPriceObfuscateMarkerWithClickListener",value:function(e,n){var r=this,i=e.feature,o=e.cornerIcons,a=e.innerIcons,s=e.cssClasses,u=e.zIndex,l=e.label,c=e.subLabel,f=e.ariaLabels,d=this._createDebugMarker(i),h=d.debug,p=d.style,y=this.uniqId("marker-".concat(this.asKey(i))),v=t.HtmlUtils.createDiv(y,this._getMainParent(),s.join(" "),p),g=T(y,v,"price","price-marker",n),m=g.main,b=g.text,k=g.span;v.iconElements={cornerIcons:o,innerIcons:a},S(b,o),E(k,a);var w=this._createObfuscatedPolygon(i);return this._updateObfuscateAreaStyle(i,w),t.HtmlUtils.setZIndex(m,u),v.ariaElement=b,O(i.highlighted,v.ariaElement,f),v.zIndexElement=m,v.bounceElement=b,v.cssElement=v,v.labels={textLblCont:m},v.clean=this.registerCompListeners(m,"priceObfuscate",i),v.position=new google.maps.LatLng(i.latLng[0],i.latLng[1]),v.obfuscateArea=w,v.clone=function(){return r.cloneObfuscatedPolygon(i,v)},v.label=n,D(v,i,l,c,this.settings,this._zIndexAdjustment),v.debug=h,v}},{key:"resetRouteStyle",value:function(){}},{key:"_createPolyline",value:function(e,t,n){var r={path:e,geodesic:null!=n&&n};switch(t.lineStyle){case"none":break;case"dash":r.icons=[{icon:{path:"M 0,-1 0,1",fillColor:t.color,fillOpacity:t.opacity,strokeColor:t.color,strokeOpacity:t.opacity,scale:t.width},offset:"0",repeat:"".concat(4*t.width,"px")}],r.strokeOpacity=0;break;case"dot":r.icons=[{icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:t.color,fillOpacity:t.opacity,strokeColor:t.color,strokeOpacity:t.opacity,scale:t.width/2},offset:"0",repeat:"".concat(2*t.width,"px")}],r.strokeOpacity=0;break;default:r.strokeColor=t.color,r.strokeWeight=t.width,r.strokeOpacity=t.opacity}return new google.maps.Polyline(r)}},{key:"addRouteOnMap",value:function(e,t){var n=this;return new Promise((function(r){var i;null===(i=t.route)||void 0===i||delete i.copyrights;var o="flying"==e.mode;e.polyline=n._createPolyline(t.route.path,n.settings.routeLineStyleByDistanceMode[e.mode],o),e.polyline.setMap(n.realmap),r(e)}))}},{key:"removeRouteOnMap",value:function(e){return new Promise((function(t){var n;null===(n=e.polyline)||void 0===n||n.setMap(null),t()}))}},{key:"addPolygonsOnMap",value:function(e){var t=this,n=e.map((function(e){var n=e.polygonDisplayed,r=e.seatePolygon(a,r);s.forEach((function(e){return e.setMap(t.realmap)}));var u={id:i,type:o},l=t.asKey(u);return t.visiblePolygonsByKey.set(l,s),u}));return Promise.resolve(n)}},{key:"removePolygonsOnMap",value:function(e){var t=this,n=e.map((function(e){var n=t.asKey(e),r=t.visiblePolygonsByKey.get(n);if(r)return r.forEach((function(e){return e.setMap(null)})),t.visiblePolygonsByKey.delete(n),e})).filter((function(e){return void 0!==e}));return Promise.resolve(n)}},{key:"_createPolygon",value:function(e,t){return F(e).map((function(e){var n={clickable:!1,paths:1===e.length?e[0]:e,strokeColor:t.line.color,strokeOpacity:t.line.opacity,strokeWeight:t.line.weight,fillColor:t.fill.color,fillOpacity:t.fill.opacity};rejustment",value:function(e){return google.maps.Marker.MAX_ZINDEX+e}}]),r}(t.BaseMap);window.egmapsGoogleMaps=e}(),i}())},11921:funct.exporporr)&&returnn.o={value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return function(){n.r(i);var e={};n.r(e),n.d(e,{MapBox:function(){return Pe}});var t=n(621),r=6371008.8,o={centimeters:637100880,centimetres:637100880,degrees:57.22891354143274,feet:20902260.511392,inches:39.37*r,kilometers:6371.0088,kilometres:6371.0088,meters:r,metres:r,miles:3958.761333810546,millimeters:6371008800,millimetresrror("coord must be GeoJSON Point or an Array of numbers")}function y(e,t,n){if(void 0===n&&(n={}),!0===n.final)return function(e,t){var n=y(t,e);return(n+180)%360}(e,t);var r=p(e),i=p(t),o=d(r[0]),a=d(i[0]),s=d(r[1]),u=d(i[1]),l=Math.sin(a-o)*Math.cos(u),c=Math.cos(s)*Math.sinh.coscos(u);return l(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),n.units)};function m(e,t,n){void 0===n&&(n={});for(var r,i=("Feature"===(r=e).type?r.geometry:r).coordinates,o=0,a=0;a<i.length&&!(t>=o&&a===i.length-1);a++){if(o>=t){var u=t-o;if(u){var l=y(i[a],i[a-1])-180;return v(i[anates[l];if(!1===t(a({type:s,coordinates:c},r),n,l))re],e.pr(e,(function(e,o,a,s,u){r=!1===i&&void 0===n?e:t(r,e,o,a,s,u),i=!0})),r}function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function M(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||F(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e){return function(e){if(Array.isArray(e))return O(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||F(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(e,t){if(e){if("string"==typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?O(e,t):void 0}}function O(e,t){(null==t||t>e.length)&String:Number)(e)}(e,"string");return"symbol"===C(t)?t:String(t)}function A(){return A="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=B(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},A.apply(this,arguments)}function T(e,t){return T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},T(e,t)}function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=B(e);if(t){var i=B(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===C(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function B(e){return B=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},B(e)}var j=t.Utils.firstDefinedValue,R=t.Utils.firstDefinedValueAndKey,N=t.Utils.firstDefinedKey,V=t.Utils.removeDuplicates,U=t.Utils.roundLatOrLng,z=t.Utils.roundLatLng,K=t.Utils.isArray,H=t.Utils.getPaddedZoomAndCenter,Z=t.Utils.roundZoom,q=t.MarkerUtils.setAccessibilityFields,W=t.MarkerUtils.createCornerIcons,G=t.MarkerUtils.createInnerIcons,Q=t.MarkerUtils.createDoubleClickEventCanceller,$=t.MarkerUtils.createImageIcon,X=t.MarkerUtils.createBasicTextMarker,Y=t.Labels.createLabels,J=t.Geo.computeZoomFromBBox,ee=t.Geo.areBoundsCrossingDateLine,te=t.Geo.areCoordinatesCrossingDateLine,ne="flying",re={height:512,width:512},ie=200,oe="fill-color",ae="fill-opacity",se="line-color",ue="line-width",le="line-opacity",ce="visiblePolygons",fe="obfuscatedPolygons",de={type:"click",dom:!0},he={type:"mouseenter",dom:!0},pe={type:"mouseleave",dom:!0},ye={type:"focus",dom:!0},ve={type:"focusout",dom:!0},ge={type:"keydown",dom:!0},me={type:"keyup",dom:!0},be={type:"keypress",dom:!0},ke={scaleControl:function(e){return new mapboxgl.ScaleControl(e)},navControl:function(e){return new mapboxgl.NavigationControl(e)},geoLocateControl:funscreenControl:function(e){return new mapboxgl.FullscreenControl(e)}},we="marker-icon",Pe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T(e,t)}(a,e);var n,r,i,o=D(a);function a(e,n,r,i){var s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(s=o.call(this,e,n,r,i)).TilesLoader=t.TilesLoader,s.logger=e.logger("MapBox"),s.logger.debug("MapBox constructor"),s.mapConfig={keyboard:!1},s.additionalConfig=s.settings.mapbox.mapboxAddConf,s.rtlTextPlugin=s.settings.mapbox.rtlTextPlugin,s.additionalConfig&&Object.assign(s.mapConfig,s.additionalConfig),s}return n=a,r=[{key:"removeMarkerFromMap",value:function(e){e.remove(),e.debug&&e.debug.remove(),e.ey:"cloneMarker",value:function(e){return null==e?void 0:e.clone()}},{key:"init",value:function(e,t){var n=this;this.mapConfig.container=this.node;var r=this.configHelper.mapboxAccessToken();if(r)mapboxgl.accessToken=r;else if(!mapboxgl.accessToken)throw new Error("No mapbox access token set ! Mapbox cannot work properly !");var i=this._zoomAndCenterFromViewport(e,t)||{},o=i.zoom,a=i.center;o&&a&&(this.mapConfig.zoom=o-1,this.mapConfig.center=[a[1],a[0]]),thiObject.keys(ke).forEach((function(e){return n._addControl(e,ke[e])})),this.mapNavFocusElement=this.realmap.getCanvas(),this._handleMapFocus(),this._registerMapListeners(),this.visiblePolygons=[],this.obfuscatedPolygons=[];var s=[];s.push(this._initializeTilesLoader());var u=this._initializeRoutesSourcesAndLayers.bind(this),l=this._initializePolygonsSourcesAndLayers.bind(this,ce,this.visiblePolygons),c=this._initializePolygonsSourcesAndLayers.bind(this,fe,this.omise((function(e){n.realmap.on("load",(function(){u(),l(),c(),e()}))}));return this.configHelper.readParam("map,mapInitWaitForTiles")&&s.push(f),this.popup=this._createPopup(),Promise.all(s)}},{key:"_addControl",value:function(e,t){var n=this.configHelper.readParam("mapbox,".concat(e));if(n.ctrlEnabled){var r=t(n.ctrlOptions),i=n.ctrlPosition;this.realmap.addControl(r,i)}}},{key:"registerListenerOnMapFocusElement",value:function(e,t){this.listenersToDeregister.push(this.addEventListener(this.mapNavFocusElement,e,t))}},{key:"_handleMapFocus",value:function(){var e=this;this.keyboardFeatures&&this.mapNavFocusElement&&(this.listenersion(){return e.keyboardFeatures.refreshKeyboardNavIconVisibility()}))),this.listenersn(){return e.keyboardFeatures.refreshKeyboardNavIconVisibility(!1)}))))}},{key:"_initializeTilesLoader",value:function(){var e=this;return new Promise((function(t){e.tilesLoader=new e.TilesLoader(e.settings,e.createTileFeature.bind(e),e.removeTileFeature.bind(e),e._updateViewport.bind(e),e.handleTilesLoaded.bind(e),e.handleTilesContentLoaded.bind(e),1),e.realmap.on("data",(function(t){if(t&&t.coord&&"source"===t.dataType&&t.coord.canonical){var n=t.coord.canonical;e.tilesLoader.loadTile(n.x,n.y,n.z,1)}})),t()}))}},{key:"resetRouteStyle",value:function(){var e=this;Object.keys(this.routesSources).forEach((function(t){e.realmap.removeLayer(e.routesSources[t].id),e.realmap.addLayer(e._createRouteLayer(t))}))}},{key:"_createRouteLayer",value:function(e){var t=this.settings.routeLineStyleByDistanceMode[e],n={id:"layer-".concat(e),type:"line",source:e,data:{type:"FeatureCollection",features:[]},paint:{"line-color":t.color,"line-opacity":t.opacity,"line-width":t.width}};switch(t.lineStyle){case"dash":n.paint["line-dasharray"]=[2,2];break;case"dot":n.paint["line-dasharray"]=[1,1]}return this.routesSources[e]=n,n}},{key:"_initializePolygonsSourcesAndLayers",value:function(e,t){var n,r;this.realmap.addSource(e,{type:"geojson",data:{type:"FeatureCollection",features:t}}),this.realmap.addLayer({id:"".concat(e,"Fill"),type:"fill",source:e,layout:{},paint:(n={},S(n,oe,["get",oe]),S(n,ae,["get",ae]),n)}),this.realmap.addLayer({id:"".concat(e,"Stroke"),type:"line",source:e,layout:{},paint:(r={},S(r,se,["get",se]),S(r,ue,["get",ue]),S(r,le,["get",le]),r)})}},{key:"_initializeRoutesSourcesAndLayers",value:function(){var e=this;this.routesSources={},["cycling","driving","walking",ne].forEach((function(t){e.realmap.addSource(t,{type:"geojson",data:{type:"FeatureCollection",features:[]}}),e.realmap.addLayer(e._createRouteLayer(t))}))}},{key:"_registerMapListeners",value:function(){var e,t,n,r,i;this._registerZoomListener(),this.registeredEvents={},this.listenersToDeregister.push(this._registerIdleListener()),(e=this.listenersToDeregister).push.apply(e,_(this._registerListenerForBoundsChanged("dragend","drag"))),(t=this.listenersToDeregister).push.apply(t,_(this._registerListenerForBoundsChanged("pitchend","pitch"))),(n=this.listenersToDeregister).push.apply(n,_(this._registerListenerForBoundsChanged("rotatend","rotate"))),(r=this.listenersToDeregister).push.apply(r,_(this._registerListenerForBoundsChanged("touchend","touch"))),this.listenersToDeregister.push(this._registerMapListener("dragstart",this.handleDragStart.bind(this))),this.listenersToDeregister.push(this._registerMapListener("style.load",this.setLocale.bind(this))),this.listenersToDeregister.push(this._registerMapListener("click",this.handleMapClick.bind(this))),(i=this.listenersToDeregister).push.apply(i,_(this._registerKeyboardListener())),this.listenersToDeregister.push(this._registerTilesLoadedListener())}},{key:"_registerTilesLoadedListener",value:function(){var e=this.handleTiMapListener("sourcedata",(function(){return e("mapProvider","map")}))}},{key:"_registerKeyboardListener",value:function(){var e=this,n={duration:ie},r=this.realmap.zoomIn.bind(this.realmap),i=this.realmap.zoomOut.bind(this.realmap);this.registeredEvents.s=new t.KeyboardListeners((function(t){return e.realmap.panBy(t,n)}),r,i,this.registeredEvents.keyboardFeatures);var o=this.handleBoundsChanged.bind(this);return[this.addEventListener(this.mapNavFocusElement,ge,this.keyboardListeners.keyDownListenerCallback),this.addEventListener(this.mapNavFocusElement,me,this.keyboardListeners.keyUpListenerCallback),this.addEventListener(this.mapNavFocusElement,be,this.keyboardListeners.keyPressListenerCallback),this._registerMapListener("idle",(function(){V((e.registeredEvents.keyboardFeatures||[]).splice(0)).forEach(o)}))]}},{key:"_registerZoomListener",value:function(){var e=this;this.lastZoomValueChecked=this.getZoom();var t=this.handleBoundsChanged.bind(this),n=this.getZoom.bind(this);this.listenersToDeregister.push(this._registerMapListener("zoomend",(function(){var r=n(),i=r>e.lastZoomValueChecked;e.lastZoomValueChecked=r,t(i?"zoomIn":"zoomOut")})))}},{key:"_registerMapListenern n?(this.realmap.on(e,,n,t)}):(this.realmap.on(e,t),function(){return r.realmap.off(e,t)})}},{key:"_registerListenerForBoundsChanged",value:function(e,t){var n=this,r=this.handleBoundsChanged.bind(thiener(e,(function(r){r.originalEvent&&n.registeredEvents[e].push(t)})),this._registerMapListener("idle",(function(){return V(n.registeredEvents[e].splice(0)).forEach(r)}))]}},{key:"_registerIdleListener",ve",(function(){return e.eventsManager.pushEvent(t.EventTypes.idle)}))}},{kction(){this.listenersToDeregister.forEach((function(e){return e()})),this.realmap&&this.realmap.remove()}},{key:"addEventListener",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return t.dom||this.logger.warn("Not able to register an event which is not a dom event: ".concat(t," on comp ").concat(stener(t.type,n),function(){return e.removeEventListener(t.type,n)}}},{key:"centerAndZoomMap",value:function(e,t,n){var r=this,i=M(e?z(e):[],2),o=i[0],a=i[1],s=t,u={};if(void 0!==o&&void 0!==a&&void 0!==s&&void 0!==n){var l=this._parseClientPadding(n),c=this._getPaddedZoomAndCenterForCenterAndZoom(e,t,l)||{},f=c.zoom,d=c.center;if(void 0!==f&&void 0!==d){var h=M(d,2);o=h[0],a=h[1],s=f-1}}if(void 0!==o&&void 0!==a){var p=this.realmap.getCenter(),y=M(z([p.lat,p.lng]),2),v=y[0],g=y[1];v===o&&g===a||(u.center=new mapboxgl.LngLat(a,o))}return s&&this.getZoom()!==s&&(u.zoom=s),!(!u.center&&led=!0,this.realmap.once("moveend",(function(){r._updateViewport()})),this.realmap.easeTo(x({duration:ie},u)),0))}},{key:"asNativeBounds",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return new mapboxgl.LngLatBounds(new mapboxgl.LngLat(U(e[1],void 0,n),U(e[0],void 0,!1)),new mapboxgl.LngLat(U(t[1],void 0,n),U(t[0],void 0,!1)))}},{key:"isFeatureInRealBound",value:function(e,t){var n=e.contains([t.latLng[1],t.latLng[0]]);if(!n){if(e.getNorthEast().lng>180)return e.contains([t.latLng[1]+360,t.latLng[0]]);if(e.getSouthWest().lng<-180)return e.contaialue:function(){var e=this.realmap.getCenter();return[e.lat,e.lng]}},{key:"getRectOfMarker",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.getMarkerComponent(e),i=r.clientWidth,o=r.clientHeight,a=this.realmap.project(e.marker.getLngLat(},{key:"getZoom",value:function(){return Z(this.realmap.getZoom())}},{key:"asBounds",value:function(e){if(e){var t=e.getSouthWest(),n=e.getNorthEast(),r=this.getCenter();return{sw:[U(t.lat),U(t.lng)],ne:[U(n.lat),U(n.lng)],center:r}}}},{key:"containerBounds",value:function(e){if(this.realmap){var t=this.realmap.unproject([e.offsetLeft-e.offsetWidth/2,e.offsetTop+e.offsetHeight/2]),n=this.realmap.unproject([e.offsetLeft+e.offsetWidth/2,e.offsetTop-e.offsetHeight/2]);return{sw:[U(t.lat),U(t.lng)],ne:[U(n.lat),U(n.lng)],center:[U(t.lat+(t.lat-n.lat)/2),U(n.lng+(n.lng-t.lng)/2)]}}}},{key:"computeNativeBoundsFromLatLongs",value:function(e){if((null==e?void 0:e.length)>0){var t=this._computeNativeBoundsFromLatLongsAux(e);if(te(e)){var n=this._computeNativeBoundsFromLatLongsAux(e.filter((function(e){var t;return(null!==(t=e.lng)&&void 0!==t?t:e[1])<0}))),r=this._computeNativeBoundsFromLatLongsAux(e.filter((function(e){var t;return(null!==(t=e.lng)&&void 0!==t?t:e[1])>=0})));return this.asNativeBounds(z([t.getSouthWest().lat,r.getSouthWest().lng]),z([n.getNorthEast().lat,n.getNorthEast().lng]))}return t}}},{key:"_computeNativeBoundsFromLatLongsAux",value:function(e){var t=new mapboxgl.LngLatBounds;return e.forEach((function(e){var n=M(z(e),2),r=n[0],i=n[1];t=t.extend(new mapboxgl.LngLat(i,r))})),t}},{key:"_zoomAndCenterFromViewport",value:function(e,t){if(e){var n=e.center,r=e.zoom,i=e.sw,o=e.ne,a=e.coordinates,s=e.useBoundsComputation,u=e.options,l=this._parseClientPadding(t);if(n&&r)return this._getPaddedZoomAndCenterForCenterAndZoom(n,r,l);if(i&&o){var c=z(i),f=z(o);return this._getPaddedZoomAndCenterForBounds(c,f,!1,l)}if(a&&s){var d=this._computeNativeBounds(a,s,u),h=this._computeZoomAndCenterFromMapboxBounds(d,!1,l)||{},p=h.zoom,y=h.center;if(void 0!==p&&void 0!==y)return H(p+1,y,l)}else if(K(e)&&e.length>0)return this._getPaddedZoomAndCenterFromLatLongs(e,!0,l)}}},{key:"_getPaddedZoomAndCenterForCenterAndZoom",value:function(e,t,n){return H(t+1,e,n)}},{key:"_getPaddedZoomAndCenterForBounds",value:function(e,t,n,r){var i=new mapboxgl.LngLatBounds(new mapboxgl.LngLat(e[1],e[0]),new mapboxgl.LngLat(t[1],t[0])),o=this._computeZoomAndCenterFromMapboxBounds(i,n,r)||{},a=o.zoom,s=o.center;if(void 0!==a&&void 0!==s)return H(a+1,s,r)}},{key:"_getPaddedZoomAndCenterFromLatLongs",value:function(e,t,n){var r=this._computeZoomAndCenterFromMapboxBounds(this.computeNativeBoundsFromLatLongs(this.boundsComputation.computeBoundingBox(e)),t,n)||{},i=r.zoom,o=r.center;if(void 0!==i&&void 0!==o)return H(i+1,o,n)}},{key:"_computeZoomAndCenterFromMapboxBounds",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=e;this._boundsForOneCoordinate(r)&&(r=new mapboxgl.LngLatBounds(r.getSouthWest(),r.getNorthEast()),r=this._extendsOneCoordinateBounds(r)),r=this._fixDatelineBoundsForMapboxInternalMethods(r);var i=J(this.node,r.getSouthWest().lat,r.getSouthWest().lng,r.getNorthEast().lat,r.getNorthEast().lng,{zoomMax:22,padding:t?this.configHelper.readParam("mapbox,padding"):0,worldDimensions:re,parsedClientPadding:n});if(isFinite(i))return{zoom:i,center:z([r.getCenter().lat,r.getCenter().lng])}}},{key:"_extendsOneCoordinateBounds",value:function(e){var t=new mapboxgl.LngLat(e.getNorthEast().lng+.01,e.getNorthEast().lat+.01),n=new mapboxgl.LngLat(e.getNorthEast().lng-.01,e.getNorthEast().lat-.01);=e.getSouthWest().lat&&e.getNorthEast().lng===e.getSouthWest().lng}},{key:"_fixDatelineBoundsForMapboxInternalMethods",value:function(e){var t=e.getSouthWest(),n=e.getNorthEast();return ee(t,n)?this.asNativeBounds([t.lat,t.lng],[n.lat,n.lng+360],!1):e}},{key:"fitLatLongs",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3?arguments[3]:void 0;if(this.realmap){this.boundChangedDisabled=!n;var o=this._parseClientPadding(i),a=this._getPaddedZoomAndCenterFromLatLongs(e,r,o)||{},s=a.zoom,u=a.center;if(void 0!==s&&void 0!==u){var l={center:new mapboxgl.LngLat(u[1],u[0]),zoom:s-1};return new Promise((function(e){t.realmap.once("moveend",(function(){t._updateViewport().then((function(n){return e(t.asBounds(n))}))})),t.realmap.easeTo(x({duration:ie},l))}))}return Promise.resolve(this.getBounds({this.realmap.resize(),A(B(",value:function(){if(thitTileDim",value:function(){return{width:re.width,height:re.height}}},{key:"fitBounds",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4?arguments[4]:void 0;if(this.realmap){this.boundChangedDisabled=!r;var a=this._parseClientPadding(o),s=z(e),u=z(t),l=this._getPaddedZoomAndCenterForBounds(s,u,i,a)||{},c=l.zoom,f=l.center;if(void 0!==c&&void 0!==f){var d=this.getZoom(),h=M(this.getCenter(),2),p=h[0],y=h[1];if(p!==f[0]||y!==f[1]||d!==c-1){var v={center:new mapboxgl.LngLat(f[1],f[0]),zoom:c-1};return new Promise((functioon(){n._updateViewport().then((function(t){return e(n.asBounds(t))}))})),n.realmap.easeTo(x({duration:ie},v))}))}this.boundChangedDisabled=!1}return Promise.resolve(this.getBounds())}return Pvar t;return null===(t=e.marker)||void 0===t?void 0:t.getElement()}},{key:"moveMarkerPosition",value:function(e,t){var n=this.realmap.project(e.marker.getLngLat());n.x+=t.x,n.y+=t.y;var r=this.realmap.unproject(n);e.marker.setLngLat(r)}},{key:"updatePopupPositionOnLayer",value:function(){var e=(this.popup||{}).feature;if(e&&e.defined){var t,n;switch(j(this.settings.popupPositions[e.type],e.hashKeys)){case"above":default:t=0,n=-24;break;case"below":t=0,n=5+this.popup.getElement().offsetHeight}this.popup.setOffset([t,n]),this.popup.setLngLat([this.popup.feature.latLng[1],this.popup.feature.latLng[0]])}}},{key:"_updateViewport",value:function(e){var t=this;return this..call(this,e).then((function(e){return t._updateMarkerPosition(),e})):Promise.resolve(e)}},{key:"ensurePopupVisibility",value:function(){var e=this.popup,t=e.feature,n=e.visibleElement,r=n.offsetWidth,i=n.offsetHeight,o=this.node,a=o.offsetWidth,s=o.offsetHeight,u=j(this.configHelper.popupVisibilityPaddings()[t.type],t.hashKeys),l=null==u?void 0:u.x,c=null==u?void 0:u.y,f="below"===j(this.settings.popupPositions[t.type],t.hashKeys),d=f?1:-1,h=this.getRectOfMarker(t).height,p=this.realmap.project(t.marker.getLngLat()),y={x:p.x-r/2,y:p.y+h*d+i*d},v=M(this._calculatePopupVisibilityOffsetValues(y,l,c,a,s,r,i,f),2),g=v[0],m=v[1];if(0!==g||0!==m){var b=this.realmap.project(this.realmap.getCenter()),k=this.realmap.unproject([b.x+g,b.y+m]);this.realmap.easeTo(k,{duration:ie})}}},{key:"_createPopup",value:function(){var e=this._createGenericPopup(void 0),n=new mapboxgl.Marker({element:e,anchor:"bottom"}).setLngLat([0,0]).addTo(this.realmap);return t.HtmlUtils.setZIndex(e,this.settings.maxZIndex+1),t.HtmlUtils.setDisplayNone(e),n.content=e.content,n.cssElement=e,n.visibleElement=e,n.clean=[].concat(_(this.registerCompListeners(e,"popup")),[Q(e,this.addEventListener.bind(this))]),n}},{key:"registerCompListeners",value:function(e,t,n){var r=this.handleMarkerClick.bind(this),i=this.handleMarkerMouseOver.bind(this),o=this.handleMarkerMouseOut.bind(this);return[this.addEventListener(e,de,(function(e){e.stopPropagation(),r(n,t,e.type)})),this.addEventListener(e,he,(function(dEventListener(e,pe,(function(e){e.stopPropagation(),o(n,t,e.type)})),Q(e,this.addEventListener.bind(this))]}},{key:"clearObfuscateArs.obfuscatedPolygons.findIndex((function(e){return e.feature_idhis.obfuscatedPolygons.filter((function(e){return e.feature_id!==t})),thierToUse",this).call(this,e),this._updateObfuscatedPolygonsSource()}},{key:"_updateObfuscatedPolygonsSource",value:function(){this._updatePolygonsSource(fe,tlue:function(){this._updatePolygonsSource(ce,this.visiblePolygons)}},{key:"_updatePolygonsSource",value:function(e,t){var n;if("function"==typeof(null===(n=this.realmap)||void 0===n?void 0:n.getSource)){var r,i=null===(r=this.realmap)||void 0===r?void 0:r.getSource(e);null==i||i.setData({type:"FeatureCollection",features:t})}}},{key:"changeProductMarkersVisible",value:function(e,t){A(B(a.prototype),"changeProductMarkersVisible",this).call(this,e,t),this._updateObfsible",this).call(this,e,t),this._updateObfuscatedPolygonsSource()}},{key:"hasObfuscateAreaStyleChangededPolygons.findIndex((function(n){return n.feature_id===t.asKey(e)}));if(n>=0){var r=N(this.settings.obfuscateStyle[e.type],e.hashKeys);return this.obfuscatedPolygons[n].properties.styleKey!==r}return!1}},{key:"_getPolygonStyle",value:function(e){var t;return S(t={},oe,e.fill.color),S(t,ae,e.fill.opacity),S(t,se,e.line.color),S(t,ue,e.line.weight),S(t,le,e.line.opacity),t}},{key:"_createObfuscatedPolygon",value:function(e){var t=this.asKey(e),n=this.getCirclePolygonData(e),r=R(this.settings.obfuscateStyle[e.type],e.hashKeys),i=r.key,o=r.value,a=this.obfuscatedPolygons.findIndex((function(e){return e.feature_id==t}));if(a<0){var s={feature_id:t,type:"Feature",properties:x({styleKey:i},this._getPolygonStyle(o)),geometry:{type:"Polygon",coordinates:[n.map((function(e){return[e.lng,e.lat]}))]}};this.obfuscatedPolygons.push(s)}else this.obfuscatedPolygons[a].properties=this._getPolygonStyle(o),this._updateObfuscatedPolygonsSource()}},{key:"_createDebugMarker",value:function(e){return this.settings.debugMarkersPosition?{debug:(new mapboxgl.Marker).setLngLat([e.latLng[1],e.latLng[0]]).addTo(this.realmap),style:"opacity: 0.5"}:{}}},{key:"createPinMarkerWithClickListener",value:function(e,n,r){var i=e.feature,o=e.cornerIcons,a=e.innerIcons,s=e.cssClasses,u=e.zIndex,l=e.label,c=e.subLabel,f=e.ariaLabels,d=this._createDebugMarker(i),h=d.debug,p=d.style,y=this.uniqId("marker-".concat(this.asKey(i))),v="".concat(s.join(" ")).concat("none"!==r?" frame-".concat(r):""),g=t.HtmlUtils.createDiv(y,void 0,v,p),m=new mapboxgl.Marker({element:g,anchor:"bottom"}).setLngLat([i.latLng[1],i.latLng[0]]).addTo(this.realmap),b=$(n,g,r,!0,we),k=b.iconImg,w=b.main;return m.frameIcon=r,t.HtmlUtils.setAriaHidden(w),m.iconElements={cornerIcons:o,innerIcons:a},W(g,o),G(k,a),m.debug=h,t.HtmlUtils.setZIndex(g,u),t.HtmlUtils.clearAriaLabel(g),m.ariaElement=g,q(i.highlighted,m.ariaElement,f),m.zIndexElement=g,m.iconElements.pin=w,m.cssElement=g,m.labels={textLblCont:g},m.bounceElement=w,m.clone=function(){return g.cloneNode(!0)},Y(m,i,l,c,this.settings,this._zIndexAdjustment),m.clean=this.registerCompListeners(g,"pin",i),m}},{key:"createTextMarkerWithClickListener",value:function(e,n,r){var i=e.feature,o=e.cornerIcons,a=e.innerIcons,s=e.cssClasses,u=e.zIndex,l=e.label,c=e.subLabel,f=e.ariaLabels,d=this._createDebugMarker(i),h=d.debug,p=d.style,y=this.uniqId("marker-".concat(this.asKey(i))),v=X(y,void 0,r,null==s?void 0:s.join(" "),n,p),g=v.main,m=v.text,b=v.span,k=new mapboxgl.Marker({element:g,anchor:"bottom"}).setLngLat([i.latLng[1],i.latLng[0]]).addTo(this.realmap);return k.iconElements={cornerIcons:o,innerIcons:a},W(m,o),G(b,a),k.debug=h,t.HtmlUtils.setZIndex(g,u),t.HtmlUtils.clearAriaLabel(g),k.ariaElement=m,q(i.highlighted,k.ariaElement,f),k.zIndexElement=g,k.bounceElement=m,k.cssElement=g,k.labels={textLblCont:g},k.clone=function(){return g.cloneNode(!0)},k.label=n,Y(k,i,l,c,this.settings,this._zIndexAdjustment),k.clean=this.registerCompListeners(g,r,i),k}},{key:"createClusterMarkerWithClickListener",value:function(e,n,r,i){var o=this._createDebugMarker(e),a=o.debug,s=o.style,u=this._createClusterMarker(void 0,e,n,r,i,s),l=new mapboxgl.Marker({element:u}).setLngLat([e.latLng[1],e.latLng[0]]).addTo(this.realmap);l.debug=a;var c=j(this.settings.zIndexes[e.type],e.hashKeys);return t.HtmlUtils.setZIndex(u,c),l.zIndexElement=u,l.cssElement=u.cssElement,l.clone=function(){return u.cloneNode(!0)},l.clean=this.registerCompListeners(u,"clusterMarker",e),l}},{key:"createObfuscateMarkerWithClickListener",value:function(e){var n=this,r=e.feature,i=e.cssClasses,o=e.zIndex,a=e.label,s=e.subLabel,u=e.ariaLabels,l=this._createDebugMarker(r),c=l.debug,f=l.style,d=this.uniqId("marker-".concat(this.asKey(r))),h=t.HtmlUtils.createDiv(d,void 0,i.join(" "),f),p=new mapboxgl.Marker({element:h}).setLngLat([r.latLng[1],r.latLng[0]]).addTo(this.realmap);return p.debug=c,t.HtmlUtils.setZIndex(h,o),t.HtmlUtils.clearAriaLabel(h),p.ariaElement=h,q(r.highlighted,p.ariaElement,u),p.zIndexElement=h,p.cssElement=h,p.labels={textLblCont:h},p.obfuscateArea=p,p.featureId=r.id,p.clone=function(){return n.cloneObfuscatedPolygon(r,h)},this._createObfuscatedPolygon(r),Y(p,r,a,s,this.settings,this._zIndexAdjustment),p.clean=this.registerCompListeners(h,"obfuscate",r),p}},{key:"createPinObfuscateMarkerWithClickListener",value:function(e,n,r){var i=this,o=e.feature,a=e.cornerIcons,s=e.innerIcons,u=e.cssClasses,l=e.zIndex,c=e.label,f=e.subLabel,d=e.ariaLabels,h=this._createDebugMarker(o),p=h.debug,y=h.style,v=this.uniqId("marker-".concat(this.asKey(o))),g="".concat(u.join(" ")).concat("none"!==r?" frame-".concat(r):""),m=t.HtmlUtils.createDiv(v,void 0,g,y),b=new mapboxgl.Marker({element:m}).setLngLat([o.latLng[1],o.latLng[0]]).addTo(this.realmap),k=t.HtmlUtils.createDiv(void 0,m,"pin-marker"),w=t.HtmlUtils.createDiv(void 0,k,"marker-icon-inter");t.HtmlUtils.setAriaHidden(w);var P=$(n,w,r,!0,we),C=P.iconImg,L=P.main;return b.frameIcon=r,b.iconElements={cornerIcons:a,innerIcons:s},W(w,a),G(C,s),b.debug=p,t.HtmlUtils.setZIndex(k,l),t.HtmlUtils.clearAriaLabel(m),b.ariaElement=k,q(o.highlighted,b.ariaElement,d),b.zIndexElement=k,b.bounceElement=L,b.cssElement=m,b.labels={textLblCont:t.HtmlUtils.isAnHtmlElement(n)?L:w},b.featureId=o.id,b.clone=function(){return i.cloneObfuscatedPolygon(o,m)},b.obfuscateArea=b,this._createObfuscatedPolygon(o),Y(b,o,c,f,this.settings,this._zIndexAdjustment),b.iconElements.pin=L,b.clean=this.registerCompListeners(k,"pinObfuscate",o),b}},{key:"createPriceObfuscateMarkerWithClickListener",value:function(e,n){var r=this,i=e.feature,o=e.cornerIcons,a=e.innerIcons,s=e.cssClasses,u=e.zIndex,l=e.label,c=e.subLabel,f=e.ariaLabels,d=this._createDebugMarker(i),h=d.debug,p=d.style,y=this.uniqId("marker-".concat(this.asKey(i))),v=t.HtmlUtils.createDiv(y,void 0,s.join(" "),p),g=X(y,v,"price","price-marker",n),m=g.main,b=g.text,k=g.span,w=new mapboxgl.Marker({element:v}).setLngLat([i.latLng[1],i.latLng[0]]).addTo(this.realmap);return w.iconElements={cornerIcons:o,innerIcons:a},W(b,o),G(k,a),w.debug=h,t.HtmlUtils.setZIndex(m,u),t.HtmlUtils.clearAriaLabel(v),w.ariaElement=b,q(i.highlighted,w.ariaElement,f),w.zIndexElement=m,w.bounceElement=b,w.cssElement=v,w.labels={textLblCont:m},w.featureId=i.id,w.clone=function(){return r.cloneObfuscatedPolygon(i,v)},w.obfuscateArea=w,this._createObfuscatedPolygon(i),w.clean=this.registerCompListeners(m,"priceObfuscate",i),w.label=n,Y(w,i,l,c,this.settings,this._zIndexAdjustment),w}},{key:"setLocale",value:function(){if(this.settings.locale){var e=this.settings.locale.substring(0,2);"unavailable"===mapboxgl.getRTLTextPluginStatus()&&mapboxgl.setRTLTextPlugin(this.rtlTextPlugin,null,!0);var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=F(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.returap.getStyle().layers.filter((function(e){return/-label/.test(e.id)})));try{for(n.s();!(t=n.n()).done;){var r=t.value;this.realmap.setLayoutProperty(r.id,"text-field",["coalesce",["get","name_"+e],["get","name"]])}}catch(e){n.e(e)}finally{n.f()}}}},{key:"_genGeodesicRoute",value:function(e,t){try{for(var n={type:"Feature",geometrfunction(e,t){var n=t.geometry.coordinates;return e+g(n[0],n[1],s)}),0)),i=[],o=0;o<r;o+=r/500){var a=m(n,o);i.push(a.geometry.coordinates)}return i.length>1&&i[0][0]<0&&i[1][0]>0&&(i[0][0]+=360),i}catch(e){this.logger.error("failed to generate geodesic line. use straight line",e)}var s}},{key:"addRouteOnMap",value:function(e,t){var n=this;return new Promise((funci){var o=t.route.path.map((function(e){var t=e.lat;return[e.lng,t]}));e.mode===ne&&2==o.length&&(o=n._genGeodesicRoute(o[0],o[1])||o),i.data.features.push({id:e.id,type:"Feature",geometry:{type:"LineString",coordinates:o}}),n.realmap.getSource(e.mode).setData(i.data)}r(e)}))}},{key:"removeRouteOnMap",value:function(e){var t=this;return new Promise((function(n,r){var i=t.routesSources[e.mode];if(i){var o=i.data.features.findIndex((function(t){return t.id===e.id}));o>=0&&(i.data.features.splice(o,1),t.realmap.getSource(e.mode).setData(i.data)),n()}else r(new Error("can't find source for ".concat(e.mode)))}))}},{key:"updateMapProviderConfig",value:function(){}},{key:"addPolygonsOnMap",value:function(e){var t=this,n=e.map((function(e){var n=e.polygonDisplayed,r=e.style,i=n.id,o=n.type,a=n.polygon,s={feature_id:t.asKey({id:i,type:o}),type:"Feature",properties:t._getPolygonStyle(r),geometry:a};return t.visiblePolygons.push(s),{id:i,type:o}}));return this._updateVisiblePolygonsSource(),Promise.resolve(n)}},{key:"removePolygonsOnMap",value:function(e){var t=this,n=e.map((function(e){var n=t.asKey(e),r=t.visiblePolygons.findIndex((function(e){return e.feature_id==n}));if(r>=0)return t.visiblePolygons.splice(r,1),e})).filter((function(e){return void 0!==e}));return e.length>0&&this._updateVisiblePolygonsSource(),Promise.resolve(n)}}],r&&E(n.prototype,r),i&&E(n,i),Object.defineProperty(n,"prototype",{writable:!1}),a}(t.BaseMap);window.egmapsMapbox=e}(),i}())}}]);
//# sourceMappingURL=eg-maps.7b12455b9c4a400bc045.js.map