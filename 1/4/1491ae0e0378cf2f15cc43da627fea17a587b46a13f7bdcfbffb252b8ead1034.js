import{aQ as D,a6 as O,u as c,az as V,r,C as q,aR as w,as as A}from"./_boot.d47e607d.js";import{u as F}from"./index.esm.9e5f749c.js";import{c as Q}from"./capitalize.7402caab.js";import{r as f}from"./review.67c2876f.js";const j=D.injectEndpoints({endpoints:e=>({getQuickComments:e.query({query:transformResponse:)})}),B=e=>e.shipmentReviews.read_only,G=e=>e.shipmentReviews.config,L=e=>e.shipmentReviews.show_modal,H=W=()=>{const e=O(),o=c(B),d=c(H),t=c(G),g=c(V),h=c(L),{reset:R,control:x,watch:y,setValue:I,formState:M,handleSubmit:z}=F({mode:"onChange"});r.exports.useEffect([d]);const m=y("rating"),i=r.exports.useRef(),s=j.useGetQuickCommentsQuery({organizationId:g.id});r.exports.useEffect(()=>(t!=null&&t.isPreview&&(i.current&&clearInterval(i.current),i.current=setInterval(3e3)),,[t==null?void 0:t.isPreview]),r.exports.useEffect([h]);const b=r.exports.useMemo(()=>{var l,a,v;return((v=(a=(l=s==null?void 0:s.data)==null?void 0:l.find()==null?void 0:a.quick_comments)==null?void 0:v.map(u=>({value:u,label:e.formatMessage({id:u})})))||[]},[m,s==null?void 0:s.data]),n=q(),[C,{isLoading:S}]=f.useCreateReviewMutation(),k=r.exports.useCallback(l=>{C(l).unwrap().then(a=>{n(f.util.updateQueryData("getReviewById",{trackingId:a.tracking.id,orgId:a.organization.id},),n(w({active:!0,duration:3e3,content:e.formatMessage({id:"form.success1"})})),n(A())}).catch(a=>{n(w({active:!0,duration:3e3,content:a.data.meta.message}))})},[n,e]),P=t.tag.enabled,_=t.text.enabled,E=r.exports.useMemo([t.text.placeholder]);let p=t.title||"Rate your delivery experience";p==="Rate your delivery experience"&&(p=Q(e.formatMessage({id:"module.title.review"})));const T=t==null?void 0:t.isPreview;return{readOnly:o,showMessage:_,showTags:P,isLoading:S,isPreview:T,textPlaceholder:E,formState:M,title:p,defaultValue:d,onSubmit:z(k),control:x,rating:m,setValue:I,quickComments:b}};export{W as u};
