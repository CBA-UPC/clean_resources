(window.webpackJsonp_name_chunkhash_=window.webpackJsonp_name_chunkhash_||[]).push([[7],{"../node_modules/mini-css-extract-plugin/dist/loader.js?!../node_modules/css-loader/index.js?!../node_modules/sass-loader/dist/cjs.js?!../node_modules/postcss-loader/lib/index.js?!./components/common/css/NewsLetterCard.scss":"./components/common/Newsletter.js":function(e,t,s){"use strict";s.r(t);var n=s("../node_modules/react/index.js"),a=s.n(n),o=s("../node_modules/react-redux/es/index.js"),c=s("../node_modules/fetch-jsonp/build/fetch-jsonp.js"),i=s.n(c),r=s("./utils/util.js"),l=s("./components/common/TimesPoints/timespoints.util.js"),u=(s("./components/common/css/NewsLetterCard.scss"),s("./components/lib/analytics/index.js")),d=s("./components/common/SvgIcon.js"),m=);var f=Object(r.h)(),p=f.sso,y=function(e){function t(e){!this,t);var s=this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.handleNewsLetter=function(){s.onSubmissionTrigger();var e="home"==s.config.pagetype?"HP_Newsletter":"articleshow"==s.config.pagetype?"HP_AS":"";u.a.event({category:"Newsletter",action:"Click",label:e})},s.state={email:""},s.config={value:"",emailRegex:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,param:{EM:"",LS:"2254",APK:"d5025f0d-9117-4179-937f-3107468c3270",ticketid:!1},pagetype:"",articleid:""},s}return t,e),m(t,[{key:"componentDidMount",value:,{key:"handleValue",value:,{key:"autofillEmail",value:function(){var e=document.querySelectorAll('[data-type="txtSubsEmail"]');Object(r.g)("ssoid")&&null!=window._user&&(e.forEach((),this.config.param.EM=_user.EMAIL,this.checkStatus("stscheck","loggedin"))}},{key:"onSubmissionTrigger",value:function(){var e=void 0,t=void 0,s=void 0;(e=document.querySelector('[data-newsletter="articleNewsletter-'+this.config.articleid+'"]'))?(t=e.querySelector('[data-type="txtSubsEmail"]'),s=e.querySelector('[data-type="errorsummary"]')):(t=document.querySelector('[data-type="txtSubsEmail"]'),s=document.querySelector('[data-type="errorsummary"]')),""!=t.value&&this.config.emailRegex.test(t.value)?window._user?this.getticket("subscribe","loggedin"):(this.config.param.ticketid=!1,this.checkStatus("subscribe","loggedout","false")):""==t.value?(s.innerHTML=f.locale.newsLetter.blankemail,t.classList.contains("error")||(t.classList+="error")):(s.innerHTML=f.locale.newsLetter.validemail,t.classList.contains("error")||(t.classList+="error"))}},{key:"unSubscribTrigger",value:,{key:"init",value:,{key:"getticket",value:function(e,t){var s=this;i()(p.SSO_URL_NewsTicket,{method:"GET",mode:"cors",credentials:"include"}).then((function(e){return e.json()})).then((function(e){s.config.param.ticketid=!(!e.ticketId||""==e.ticketId),s.checkStatus("subscribe","loggedin",e.ticketId)})).catch(()}},{key:"checkStatus",value:function(e,t,s){var n=void 0,a=this,o=void 0,c=void 0,i=void 0;(o=document.querySelector('[data-newsletter="articleNewsletter-'+this.config.articleid+'"]'))?(c=o.querySelector('[data-type="txtSubsEmail"]'),i=o.querySelector('[data-type="errorsummary"]')):(c=document.querySelector('[data-type="txtSubsEmail"]'),i=document.querySelector('[data-type="errorsummary"]'));n="loggedin"===t?{LS:f.locale.newsLetter.LS,APK:this.config.param.APK,TCK:s,EM:c.value}:{LS:f.locale.newsLetter.LS,APK:this.config.param.APK,EM:c.value},fetch(f.sso.SSO_URL_SubStatus,{dataType:"json",headers:n}).then((function(e){return e.json()})).then((function(n){if("stscheck"!==e||36!==n.code&&42!==n.code&&43!==n.code&&44!==n.code||"VERIFIED_USER"!==n.status&&"VERIFIED_SSO_USER"!==n.status)if(34===n.code&&"subscribe"==e&&"NEW_USER"===n.status)a.initiateSubscribe(s,t,n.code);else if(35===n.code&&"subscribe"==e&&"NON_VERIFIED_USER"===n.status)a.success("Earlier we sent email to you, please check your mailbox and verify");else if(36!==n.code&&42!==n.code&&43!==n.code&&44!==n.code||"subscribe"!=e||"VERIFIED_USER"!==n.status&&"VERIFIED_SSO_USER"!==n.status&&"VERIFIED_NON_SUBSCRIBE_USER"!==n.status&&"VERIFIED_NON_SUBSCRIBE_SSOUSER"!==n.status)44===n.code&&"subscribe"==e&&"VERIFIED_SSO_USER"===n.status&&("loggedin"!=t?(i.innerHTML=f.locale.newsLetter.login,c.classList.contains("error")||(c.classList+="error")):a.initiateSubscribe(s,t,n.code));else{n.nlids.length>=1&&(36===n.code||42===n.code||44===n.code)?a.success(f.locale.newsLetter.already):43===n.code?a.success(f.locale.newsLetter.login):a.initiateSubscribe(s,t,n.code)}else{var o=document.querySelectorAll(".wdt_newsLetter");o&&o.forEach(()}}))}},{key:"initiateSubscribe",value:function(e,t,s){var n=void 0,a=void 0,o=this,c=void 0;c=(a=document.querySelector('[data-newsletter="articleNewsletter-'+this.config.articleid+'"]'))?a.querySelector('[data-type="txtSubsEmail"]'):document.querySelector('[data-type="txtSubsEmail"]'),n="loggedin"===t?{LS:f.locale.newsLetter.LS,APK:this.config.param.APK,TCK:e,EM:c.value}:{LS:f.locale.newsLetter.LS,APK:this.config.param.APK,EM:c.value},fetch(f.sso.SSO_URL_subscribe,{type:"OPTIONS",dataType:"json",headers:n}).then(().then((function(t){"SUCCESS"===t.status&&28===t.code&&"false"==e&&34===s?o.success(f.locale.newsLetter.verification):"SUCCESS"!==t.status||28!==t.code||44!==s&&34!==s&&43!==s||(o.success(f.locale.newsLetter.Subscribed),o.timesPointsActivity())}))}},{key:"unsubscribe",value:function(e,t){var s={LS:mod_newsletter.config.param.LS,APK:mod_newsletter.config.param.APK,EM:e,HC:t},n="";$(".chkboxList [type='checkbox']:checked").each((function(){$(this).prop("checked")&&(n+=this.value+"|")})),n=n.slice(0,-1),$.ajax({dataType:"json",url:newsletterfeeds.unsubscribe+"&nlid="+n,headers:s,success:function(e){28===e.code&&"Already Unsubscribed"===e.message?mod_newsletter.success(mod_newsletter.config.msg.alreadyunsubscribed):28===e.code&&"SUCCESS"==e.status?mod_newsletter.success(mod_newsletter.config.msg.unsubscribed):"ERROR"==e.status&&mod_newsletter.success(mod_newsletter.config.msg.error)}})}},{key:"success",value:function(e){var t=void 0,s=void 0,n=void 0;(t=document.querySelector('[data-newsletter="articleNewsletter-'+this.config.articleid+'"]'))?(s=t.querySelector(".pnlsuccess"),n=t.querySelector('[data-type="successmsg"]'),t.querySelector('[data-type="subscriptionform"]').style.display="none"):(s=document.querySelector(".pnlsuccess"),n=document.querySelector('[data-type="successmsg"]'),document.querySelector('[data-type="subscriptionform"]').style.display="none"),n.innerHTML=e,s.style.display="block"}},{key:"verify",value:function(e,t){var s=this,n={LS:mod_newsletter.config.param.LS,APK:mod_newsletter.config.param.APK,EM:e,HC:t};$.ajax({dataType:"json",url:newsletterfeeds.confirm,headers:n,success:function(e){39===e.code&&"Thanks for verification"===e.message?(mod_newsletter.success(mod_newsletter.config.msg.Subscribed),s.timesPointsActivity(),u.a.event({category:"newsletter",action:"subscribed",label:"newsletter"})):38===e.code&&"User Already Verified"===e.message&&mod_newsletter.success(mod_newsletter.config.msg.verified)}})}},{key:"getUrlParameter",value:function(e){var t=decodeURIComponent(window.location.search.substring(1)).split("&"),s=void 0,n=void 0;for(n=0;n<t.length;n++)if((s=t[n].split("="))[0]===e)return void 0===s[1]||s[1]}},{key:"timesPointsActivity",value:function(){"function"==typeof l.fireActivity&&Object(l.fireActivity)("SUB_NL","newsletter")}},{key:"render",value:function(){var e,t,s,n=this,o=this.props.authentication;e=f.locale.newsLetter&&f.locale.newsLetter.headerText?f.locale.newsLetter.headerText:"",t=f.locale.newsLetter&&f.locale.newsLetter.joinIn?f.locale.newsLetter.joinIn:"",f.locale.newsLetter&&f.locale.newsLetter.footerText&&f.locale.newsLetter.footerText,s=f.locale.newsLetter&&f.locale.newsLetter.thankyou?f.locale.newsLetter.thankyou:"";var c=this.props,i=c.pagetype,r=c.articleid;this.config.pagetype=i,this.config.articleid=r;o&&o.userData&&o.userData.EMAIL;return a.a.createElement("div",{className:"wdt_newsLetter","data-exclude":"amp","data-newsletter":"articleNewsletter-"+this.config.articleid},a.a.createElement("div",{"data-type":"subscriptionform",className:"subscriptionform"},a.a.createElement("div",{className:"head"},a.a.createElement(d.a,{name:"email",className:"mail_icon"}),a.a.createElement("h3",null,e)),a.a.createElement("div",{className:"formElements"},a.a.createElement("div",{className:"input_txt"},a.a.createElement("input",{type:"text",name:"email",size:"35","data-type":"txtSubsEmail",onChange:placeholder:"example@domain.com",value:this.state.email}),a.a.createElement("input",{type:"submit",value:t,onClick:this.handleNewsLetter})),a.a.createElement("span",{"data-type":"errorsummary",className:"error_msg"}))),a.a.createElement("div",{className:"pnlsuccess"},a.a.createElement(d.a,{name:"email",className:"mail_icon"}),a.a.createElement("h4",null,s),a.a.createElement("span",{"data-type":"successmsg",className:"message_txt"})))}}],[{key:"getDerivedStateFromProps",value:function(e){return e.authentication&&e.authentication.userData&&""!==e.authentication.userData.EMAIL?{email:e.authentication.userData.EMAIL}:null}}]),t}(n.Component);t.default=Object(o.b)(()(y)},"./components/common/css/NewsLetterCard.scss":function(e,t,s){"use strict";var n=s("../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),a=s.n(n),o=s("../node_modules/mini-css-extract-plugin/dist/loader.js?!../node_modules/css-loader/index.js?!../node_modules/sass-loader/dist/cjs.js?!../node_modules/postcss-loader/lib/index.js?!./components/common/css/NewsLetterCard.scss"),c=s.n(o),i={insert:"head",singleton:!1};a()(c.a,i),c.a.locals}}]);