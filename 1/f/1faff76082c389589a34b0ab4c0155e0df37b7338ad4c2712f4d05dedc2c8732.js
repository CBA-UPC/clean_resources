(function(a,n,c,j,ia,fa,b,z,ja,ha,l,T,va,o,H,ka,S,pa,E,L,J,x,q,A,r,B,k,m,i,s,t,w,y,u,v,p,Y,Da,f){
a(n,[c,j],function(S,J){function T(){}function U(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function V(a,b){return(b=b||n)&&b.getElementById&&b.getElementById(a)}function E(a,b){var c=b?"string"==typeof a?V(a):a:n;return c?c.getElementsByTagName(b||a):[]}function F(a,b){return~(" "+a.className+" ").indexOf(" "+b+" ")}function W(a,b){F(a,b)&&(a.className=(" "+a.className+" ").replace(" "+b+" "," ").slice(1,-1),W(a,b))}function fa(a,b){var c,d=a.ownerDocument.defaultView;
d&&(d=d.getComputedStyle(a,null))&&(c=d.getPropertyValue(b.replace(ha,"-$1").toLowerCase()));return c||a.style[b]}function ia(a,b){var c,d=a.style,f=a.currentStyle&&a.currentStyle[b];if(!ja.test(f)&&ka.test(f)){var g=d.left;if(c=a.runtimeStyle&&a.runtimeStyle.left)a.runtimeStyle.left=a.currentStyle.left;d.left="fontSize"===b?"1em":f||0;f=d.pixelLeft+"px";d.left=g;c&&(a.runtimeStyle.left=c)}return""===f?"auto":"curStyle"}function K(a){var b=a.offsetTop,c=a.offsetLeft,d,f=e.curCSS,g="static"!=f(a,"position");
b||(b=(parseFloat(f(a,"marginTop"))||0)+(g?parseFloat(f(a,"top"))||0:0));c||(c=(parseFloat(f(a,"marginLeft"))||0)+(g?parseFloat(f(a,"left"))||0:0));g&&a.getBoundingClientRect&&(d=e.offset(a,!0));!b&&d&&(b=d.top);!c&&d&&(c=d.left);return{top:b,left:c}}function la(a,b){var c=a&&a.ownerDocument;if(!c)return null;if(!b&&a===c.body)return K(a);try{var d=a.getBoundingClientRect()}catch(g){}if(!d)return{top:0,left:0};var f=c.body;c=c.documentElement;return{top:d.top+(c.scrollTop||f.scrollTop)-(c.clientTop||
f.clientTop||0),left:d.left+(c.scrollLeft||f.scrollLeft)-(c.clientLeft||f.clientLeft||0)}}function ma(a){var b;var c=a&&a.ownerDocument;if(!c)return null;if(a===c.body)return K(a);var d=a.offsetParent;var f=c.documentElement;var g=c.body;var k=(c=c.defaultView)?c.getComputedStyle(a,null):a.currentStyle;var l=a.offsetTop;var m=a.offsetLeft;for(b=X();(a=a.parentNode)&&a!==g&&a!==f&&(!b.sfp||"fixed"!==k.position);)k=c?c.getComputedStyle(a,null):a.currentStyle,l-=a.scrollTop,m-=a.scrollLeft,a===d&&(l+=
a.offsetTop,m+=a.offsetLeft,!b.dnab||b.dabftac&&na.test(a.nodeName)||(l+=parseFloat(k.borderTopWidth)||0,m+=parseFloat(k.borderLeftWidth)||0),d=a.offsetParent),b.sbfonv&&"visible"!==k.overflow&&(l+=parseFloat(k.borderTopWidth)||0,m+=parseFloat(k.borderLeftWidth)||0);if("relative"===k.position||"static"===k.position)l+=g.offsetTop,m+=g.offsetLeft;b.sfp&&"fixed"===k.position&&(l+=Math.max(f.scrollTop,g.scrollTop),m+=Math.max(f.scrollLeft,g.scrollLeft));return{top:l,left:m}}function oa(a){return"[object Array]"==
Object.prototype.toString.call(a)}function Y(a){var b={relativeX:a[y[0]],relativeY:a[y[1]]};if(null==a.pageX&&null!=a.clientX){var c=n.documentElement;var d=n.body;b.pageX=a.clientX+(c&&c.scrollLeft||d.scrollLeft||0);b.pageY=a.clientY+(c&&c.scrollTop||d.scrollTop||0)}else b.pageX=a.pageX,b.pageY=a.pageY;return b}function pa(a,b){var c,d=e.curCSS;a=a.parentNode;if(!a)return!1;if(p.$sf)return!0;var f=a.ownerDocument;var g=f.body;if(z&&(8>f.documentMode||"BackCompat"==f.compatMode))return!1;for(b&&(b+=
1);a&&a!=g;){if("hidden"==d(a,"overflow"))return!1;if("fixed"==d(a,"position"))break;else if(b&&(c=parseInt(d(a,"z-index"),10))&&c<b)return!1;a=a.parentNode}return!0}function qa(){for(var a=0,b=[];a<v.length;a++)"complete"!=v[a].document.readyState&&b.push(v[a]);if(!(v=b).length||3E4<(new Date).getTime()-Z){A=ra(A);for(a=0;a<G.length;a++)G[a]();G=[];v=[]}}function aa(a,b){var c=Math.max(a.x,b.x),d=Math.max(a.y,b.y),f=Math.min(a.x+a.width,b.x+b.width)-c,g=Math.min(a.y+a.height,b.y+b.height)-d;return 0<
f&&0<g?{x:c,y:d,width:f,height:g}:{x:0,y:0,width:0,height:0}}function ba(a,b,c,d){var f=b.src||b.href;S.log("legacy_loadFile",f);var g=function(r){d&&d.apply(r,arguments)},k=E(c,"head");k=k&&k[0];if(!k)try{throw Error("Can't find head tag.");}catch(r){g(r)}var l=f.replace(/[^\da-z_-]/gi,"_"),m=c.adformId||e.gid("doc_"),L=m+"|"+l,w=M[L];l=e.byTag(c,a);var t=0,N=l.length;c.adformId=c.adformId||m;if(w)w.loaded?g():w.callbacks.push(g);else{for(;t<N;++t)if(l[t].src==f||l[t].href==f){g();return}M[L]=w=
{doc:c,src:f,callbacks:[g]};var q=c.createElement(a);U(q,b);if(d){var O=function(r){q.onload=q.onreadystatechange=q.onerror=null;r?M[L]=null:w.loaded=1;var ca=w.callbacks;t=0;for(N=ca.length;t<N;++t)ca[t](r)};q.onload=function(){O()};q.onreadystatechange=function(){"complete"==q.readyState&&O()};q.onerror=function(){try{throw Error("Failed to load script: "+f);}catch(r){O(r)}}}P(function(){k.insertBefore(q,k.firstChild)},400)}}var A,Z,x,p=S.window,n=p.document,sa=p.setInterval,P=p.setTimeout,ta=p.clearTimeout,
ra=p.clearInterval,H=p.navigator,ua=Array.prototype.slice,v=[],G=[],M={},y=[["offsetX","offsetY"],["layerX","layerY"]],ha=/([A-Z])/g,ja=/^-?\d+(?:px)?$/i,ka=/^-?\d/,na=/^t(?:able|d|h)$/i,da=n.defaultView,va=n.createElement("div"),X=function(){function a(){return a}var b=n.body,c=n.createElement("div");var d=["position:absolute;top:0;left:0;margin:0;padding:0;border:0;width:1px;height:1px;"].pop();c.innerHTML='<div style="'+d+'visibility:hidden"><div style="'+d+'border:5px solid #000"><div style="margin:0"></div></div><div style="'+
d+'"><div style="'+d+'position:fixed;top:20px;"></div></div><div style="'+d+'position:relative;border:5px solid #000;overflow:hidden"><div style="margin:0"></div></div><table style="'+d+'border:5px solid #000" cellpadding="0" cellspacing="0"><tr><td></td></tr></table></div>';b.insertBefore(c=c.firstChild,b.firstChild);d=c.childNodes;a.dnab=5!==d[0].firstChild.offsetTop;a.sfp=20===d[1].firstChild.offsetTop;a.sbfonv=-5===d[2].firstChild.offsetTop;a.dabftac=5===E(c,"td").offsetTop;b.removeChild(c);b=
c=d=null;return X=a},B=H.vendor;var h=H.userAgent;var u=J.RMB,e=u.lib||(u.lib={}),C=/Apple Computer/i.test(B);u=/Google/i.test(B);var D=e.isIPad=/iPad/i.test(h),I=e.isIPhone=/iPhone/i.test(h);D=e.isIOS=D||I;var Q=e.isTouch="ontouchstart"in n.documentElement||"ontouchstart"in p,wa=e.isOrientation="orientation"in p;I=e.isAndroid=!D&&/Android/i.test(h);var R=e.isMobile=/Mobile|Mobi|Tablet|Nokia/i.test(h)||Q,z=e.isIE=/msie|Trident/i.test(h);Q=e.isFF=/Firefox[\/.]+[^\s]/i.test(h);R=e.isWinPhone=z&&R&&
/Phone/gi.test(h);var xa=e.isOpera=/Opera/i.test(h),ya=e.isOperaMobile=/Opera\s(?!Mini)/i.test(h),za=e.isOperaMini=/Opera\sMini/i.test(h);B=e.isOperaWebKit=/OPR/i.test(h)&&/Opera Software/i.test(B);var ea=e.isChrome=/(Chrome|CriOS)+\/[\d\.]+\s/i.test(h)&&(D?C:u);C=e.isSafari=!/Chrome|CriOS|Skyfire/i.test(h)&&/Safari+\/[\.\d]+$/i.test(h)&&C;u=e.isInternet=I&&!ea&&wa&&/Safari\/[\.\d]+$/i.test(h)&&u;var Aa=z?"msie":Q?"firefox":ya?"operaMobile":za?"operaMini":xa?"opera":B?"operaWebKit":ea?"chrome":C?
"safari":u?"internet":!1;e.isAndroidApp=I&&!/^(?:Opera|Mozilla)/i.test(h);e.isIOSF=D&&(x=/\sos\s(\d+)_\d+/i.exec(h))&&(x=4<x[1]>>0);e.isMACOS=/Mac OS X/i.test(h);R&&(x=/Windows Phone (OS )?(\d+[\.\d]*)/i.exec(h))&&x[2]&&(e.winPhoneVer=parseFloat(x[2]));e.isEdge=/Edge\/[\.\d]+$/i.test(h);e.isAfmaSDK=/afma-sdk/i.test(h);e.browser=function(){return Aa};if(z&&("Microsoft Internet Explorer"==H.appName&&/MSIE (\d+[\.\d]*)/i.exec(h)||/rv:(\d+[\.\d]*)/i.exec(h)))var Ba=e.ieVersion=parseFloat(RegExp.$1);C&&
(h=/Version.([\d.]+)/.exec(h),e.safariVersion=parseFloat(h&&h[1]));e.inherit=function(a,b){a.super_=b;T.prototype=b.prototype;a.prototype=new T;a.prototype.constructor=a};e.gid=function(a){var b=+new Date;return(a||"")+(b+b*~~(1E4*Math.random())).toString(36)};e.byId=V;e.byTag=E;e.bind=function(a,b){return function(){return b.apply(a,arguments)}};e.extend=U;e.isMouseLeave=function(a,b){var c,d,f=b.length;if(a&&"mouseout"==a.type)for(c=a.relatedTarget||a.toElement;c;){for(d=0;d<f;d++)if(b[d]==c)return!1;
c=c.parentNode}return!0};e.singleCall=function(a){function b(){g=!1;var k=d,l=c,m=f;c=d=f=null;k.apply(l,m)}var c,d,f,g;return function(k,l){c=k;d=l;f=ua.call(arguments,2);l&&!g?g=P(b,a):!l&&g&&(ta(g),g=!1)}};e.onload=function(a,b){try{do{if(a.__adform_onload)break;a.__adform_onload=!0;"complete"!=a.document.readyState&&(v.push(a),A||(Z=(new Date).getTime(),A=sa(qa,200)))}while(a!=a.parent&&(a=a.parent))}catch(c){}A?G.push(b):P(b,0)};e.overlap=aa;e.overlapElem=function(a,b){var c=e.offset(a),d=e.offset(b);
return aa({x:c.left,y:c.top,width:a.offsetWidth,height:a.offsetHeight},{x:d.left,y:d.top,width:b.offsetWidth,height:b.offsetHeight})};e.hasClass=F;e.addClass=function(a,b){F(a,b)||(a.className+=" "+b)};e.removeClass=W;e.loadScript=function(a,b,c){ba("script",{src:b,type:"text/javascript"},a,c)};e.loadCSS=function(a,b){ba("link",{href:b,type:"text/css",rel:"stylesheet"},a)};e.navigator=H;e.isTMX=function(a){var b,c,d=!1;try{d=(c=(b=a.document)&&b.body)&&F(c,"tmx")}catch(f){}return d};e.isolate=function(a,
b){var c=a.__adform_isolate;if(!c){var d=a.document;c=E(d,"head")[0];d=d.createElement("script");d.type="text/javascript";d.text='function __adform_isolate(f){new Function("window","("+f+")(window)")(window)}';c.insertBefore(d,c.firstChild);c.removeChild(d);c=a.__adform_isolate}c?c(b):(new Function("window","("+b+")(window)"))(a)};e.addEvent=function(a,b,c){return a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent?a.attachEvent("on"+b,c):!1};e.removeEvent=function(a,b,c){return a.removeEventListener?
a.removeEventListener(b,c,!1):a.detachEvent?a.detachEvent("on"+b,c):!1};e.curCSS=da&&da.getComputedStyle&&fa||n.documentElement.currentStyle&&ia;e.offsetFromWindow=function(a){var b=a&&a.ownerDocument;if(!b)return null;var c=b.documentElement;if("getBoundingClientRect"in c){try{var d=a.getBoundingClientRect();var f=c.getBoundingClientRect()}catch(g){}if(!d)return{top:0,left:0};if(0<f.left||0<f.top)d.top-=f.top,d.left-=f.left;return{top:d.top,left:d.left}}d=b.defaultView||b.parentWindow;f=b.body;if(a===
b.body)return K(a);a=e.offset(a);b=d&&d.pageYOffset||c.scrollTop||f.scrollTop;c=d&&d.pageXOffset||c.scrollLeft||f.scrollLeft;a.top-=b;a.left-=c;return a};e.offset="getBoundingClientRect"in n.documentElement?la:ma;e.client=function(a){a=a.ownerDocument||a;var b=a.defaultView||a.parentWindow;var c=a.documentElement;var d=a.body;if(b.innerWidth){a=b.innerWidth;var f=b.innerHeight}else c?(a=c.clientWidth,f=c.clientHeight,a&&d.clientHeight==d.offsetHeight||(a=Math.min(a||123456789,d.clientWidth||123456789),
f=Math.min(f||123456789,d.clientHeight||123456789))):(a=d.clientWidth,f=d.clientHeight);return{left:b&&b.pageXOffset||c&&c.scrollLeft||d&&d.scrollLeft||0,top:b&&b.pageYOffset||c&&c.scrollTop||d&&d.scrollTop||0,width:a,height:f}};e.isArray=Array.isArray||oa;e.getMousePos=function(a){for(var b;b=y.shift();)if("undefined"!=typeof a[b[0]]){y=b;break}b||(y=["x","y"]);e.getMousePos=Y;return Y(a)};e.html=function(a,b){var c=!b&&va||b.createElement("div");c.innerHTML=a;return c.firstChild&&c.removeChild(c.firstChild)};
e.testPlace=z&&8>Ba?function(){return!1}:pa;J.lib||(J.lib=e);return e});
a(ia,[j],function(f){function k(a){this._delay=a||0;this._diff=this._start=this._count=this._partial=0;this.active=!1;this.count=this.time=0;this._list=[]}var g=Date.now||function(){return(new Date).getTime()};f.ET.Timer=k;k.calculateEngagement=function(){var a,b;var c=arguments;var d=[],h=g(),l=0;for(a=0;a<c.length;a++){var e=c[a]._list;for(b=0;b<e.length;b+=2)d.push([e[b],e[b+1]||h])}d.sort(function(m,n){return m[0]-n[0]});if(d.length){c=[[d[0][0],d[0][1]]];a=1;b=0;for(e=d.length;a<e;a++)c[b][1]<
d[a][0]?c[++b]=[d[a][0],d[a][1]]:c[b][1]<d[a][1]&&(c[b][1]=d[a][1]);a=0;for(e=c.length;a<e;a++)l+=c[a][1]-c[a][0]}return l};f=k.prototype;f.update=function(){this.active=!1;this._diff=0;var a=this._list,b=this._start,c=this._paused,d=a.length%2;if(b){var h=(c||g())-b;h>=this._delay&&(this.active=!c,this.count=this._count+1,this.time=this._partial+h,this._diff=h,d||c||a.push(b))}!d||b&&!c||a.push(g());return this};f.start=function(){this._start||(this._start=g(),this.update());return this};f.stop=
function(){this._start&&(this.update(),this._count=this.count,this._partial=this.time,this._start=0,this.update());return this};f.paused=function(a){a&&!this._paused?(this._paused=g(),this.update()):!a&&this._paused&&(this.update(),this._paused=0,this._partial=this.time,this._start&&(this._start=g()),this.update());return this};return k});
a(fa,[c,b,j,n,z],function(L,A,t,B,M){t=t.ET;var C=L.window,l=Date.now||function(){return(new Date).getTime()},k=new M;t.ActiveTab=k;k.init=function(f){function D(){var b=B.removeEvent;E=!0;g.clear();if(c){var a=f.top.document;b(f.top,"scroll",c);b(a,"mousemove",c);b(a,"keydown",c);b(a,"mousedown",c);b(a,"mouseup",c);b(f.top,"focus",F);b(f.top,"blur",G);b(a,"visibilitychange",H);b(f.top,"resize",c);c=null}}function u(){var b=n&&v&&h,a=l(),d=a-w;p?
n=!I[p]:J?(w=a,d>N&&g.emit(g.IDLE,d)):q&&(n=d<O);m&&(v=a-m<P);h=h||f.top.document.hasFocus();a=n&&v&&h;b!=a&&g.emit(g.VISIBLE,a);g.wasActive||(g.wasActive=a);return a}function K(){E||(w=l(),q(K))}function F(){h=!0}function G(b){var a=C.top;b=b||a.event;h=a.document.hasFocus();r&&b&&!h&&(h=500>b.timeStamp-r);r=!1}function H(){h=!I[p]}var g=k;g.isActive=u;g.update=u;g.destroy=D;D();var E=!1,q=f[A.reqAni],I=f.document,p=A.hidden,J=!1,n=!0,v=!0,h=f.top.document.hasFocus(),r=!1,w=l(),m,c,N=1E3,O=250,P=
3E4;p||J||!q||q(K);(function(b){m=l();c=function(e){e=e||b.event;var x=!(e&&"mousemove"==e.type),Q=y,R=z;x||(y=e.screenX,z=e.screenY,x=y!=Q||z!=R);x&&(h=!0,m=l());e&&"resize"==e.type&&(r=m)};var a=b.document,d=B.addEvent,y,z;setTimeout(function(){var e=b.top;d(e,"scroll",c);d(a,"mousemove",c);d(a,"keydown",c);d(a,"mousedown",c);d(a,"mouseup",c);d(e,"focus",F);d(e,"blur",G);d(a,"visibilitychange",H);d(e,"resize",c)},100)})(f.top);u()};k.IDLE="idle";k.VISIBLE="visible";k.init(C);return k});
a(ja,[j,ia,n],function(c,a,e){function b(){this.exposure=this._exp=this._exposure=this._mod=0;b.super_.apply(this,arguments)}c=c.ET;e.inherit(b,a);a=b.prototype;a._update=a.update;a.update=function(){this._update();this._exp=this._exposure+this._mod*this._diff;this.exposure=Math.round(this._exp);return this};a._stop=a.stop;a.stop=function(){this._start&&(this.update(),this._exposure=this._exp);return this._stop()};a.modifier=function(d){d!=this._mod&&this.active&&
(this.stop(),this._mod=d,this.start());this._mod=d};return c.ExposureTimer=b});
a(ha,[j,ia,fa,ja],function(f,e,k,n){function h(b,a){this.minPercent=b;this.minTime=a;var d=this.visibility=new e;this.mouse=(new e(1E3)).paused(!0);this.delaylessMouse=new e;this.video=new e;this.expand=new e;var c=this.exposure=new n;this.viewableVideo=(new e).paused(!0);k.on(k.IDLE,function(g){0<d._start&&(d._start+=g);0<c._start&&(c._start+=g)})}function l(b){var a=this.exposure,d=this.mouse,c=this.visibility,g=c.active,p=c.update().time,
m=this.viewableVideo;!b&&p<this.minTime&&(c._start=null,c.time=0);this.impression=c.time>this.minTime;b&&!g?(a.start(),c.start(),d.paused(!1),m.paused(!1)):!b&&g&&(a.stop(),c.stop(),d.paused(!0),m.paused(!0))}f.ET.Counter=h;f=h.prototype;f.update=function(b,a,d){b=this.visiblePercent=Math.round(100*a/b)||0;this.exposure.modifier(a/d||0);l.call(this,b>=this.minPercent)};f.visiblePercent=0;f.action=function(b){var a=this,d={start:function(){a.mouse.start();a.delaylessMouse.start()},stop:function(){a.mouse.stop();
a.delaylessMouse.stop()}},c={start:function(){a.video.start();a.viewableVideo.start()},stop:function(){a.video.stop();a.viewableVideo.stop()}};if("stop"===b)return l.call(a,!1);if((b={over:1,out:2,expand:3,collapse:4,videoPlay:5,videoStop:6}[b])&&b--)[d,a.expand,c][b>>1][b%2?"stop":"start"]()};return h});
a(l,[j,n],function(u,k){function q(){function d(b){h.push(this);this._doc=b;this._events={};this.dispatchHover=k.bind(this,r)}function r(){var b,a;var c=d._hoverTarget;for(var e=[],g=[],f=d._hoverChain,l=RegExp("adform-domevents-hover-\\S+","g");c&&"undefined"!=(b=typeof c.className);)"string"==b&&0<=c.className.indexOf("adform-domevents-hover-")&&e.unshift(c),c=c.parentNode;for(a=Math.max(e.length,f.length)-1;0<=a&&f[a]!=e[a];a--){if(f[a])for(b=p(f[a].className,"adform-domevents-hover-",
l),c=0;c<b.length;c++)b[c].call(f[a],"hoverout",f[a]);if(e[a])for(b=p(e[a].className,"adform-domevents-hover-",l),c=0;c<b.length;c++)g.push([b[c],e[a]])}if(g.length)for(a=0;a<g.length;a++)g[a][0].call(g[a][1],"hoverin",g[a][1]);d._hoverChain=e}function p(b,a,c){b=b.match(c);c=[];if(b)for(b=("x|"+b.join("|")).split("|"+a).slice(1),a=0;a<b.length;a++)m[b[a]]&&c.push(m[b[a]]);return c}function t(b){var a;for(a=0;a<h.length;a++)if(h[a]._doc==b)return h[a]}var h=[],m={},n=d.prototype;d.create=q;d.destroy=
function(b){var a;if(b)(a=t(b))&&a.destroy();else for(;h.length;)h[0].destroy()};d.on=function(b,a,c){var e=b.ownerDocument;(d.find(e)||new d(e)).on(b,a,c);return this};d.off=function(b,a,c){var e=d.find(b.ownerDocument);e&&e.off(b,a,c);return this};d.find=t;d.dispatchHover=r;d.dispatchClick=function(b,a){for(var c,e,g,f=[],l=RegExp("adform-domevents-click-\\S+","g");b&&"undefined"!=(c=typeof b.className);)"string"==c&&0<=b.className.indexOf("adform-domevents-click-")&&f.unshift(b),b=b.parentNode;
for(c=f.length-1;0<=c;c--)for(e=p(f[c].className,"adform-domevents-click-",l),g=0;g<e.length;g++)e[g].call(f[c],"click",f[c],a)};d._hoverChain=[];d._hoverTarget=null;n.on=function(b,a,c){var e=c._adform_dom_key;e||(e=c._adform_dom_key=k.gid());e in m||(m[e]=c);c="adform-domevents-"+a+"-"+e;0>b.className.indexOf(c)&&(b.className+=" "+c,this.setup(a))};n.off=function(b,a,c){if(c=c._adform_dom_key)b.className=b.className.replace("adform-domevents-"+a+"-"+c,"")};n.destroy=function(){var b,a,c=this._events,
e=this._doc,g=d._hoverChain;for(b in c){var f=c[b];for(a in f)k.removeEvent(e,a,f[a])}for(b=h.length;0<b--;)if(h[b]==this){h.splice(b,1);break}g[0]&&g[0].ownerDocument==e&&(d._hoverChain=[],d._hoverTarget=null);this._doc=this._events=null};n.setup=function(b){var a=this._doc,c=a.defaultView||a.parentWindow;if(!this._events[b])if(this._events[b]={},"hover"==b){if(a.addEventListener){var e=function(f){d._hoverTarget!=f.target&&(d._hoverTarget=f.target,d.dispatchHover())};var g=function(f){d._hoverTarget!=
f.relatedTarget&&(d._hoverTarget=f.relatedTarget,d.dispatchHover())}}else e=function(){c=a.defaultView||a.parentWindow;d._hoverTarget!=c.event.srcElement&&(d._hoverTarget=c.event.srcElement,d.dispatchHover())},g=function(){c=a.defaultView||a.parentWindow;d._hoverTarget!=c.event.toElement&&(d._hoverTarget=c.event.toElement,d.dispatchHover())};k.addEvent(a,"mouseover",this._events[b].mouseover=e);k.addEvent(a,"mouseout",this._events[b].mouseout=g);k.addEvent(a,"mousemove",this._events[b].mousemove=
e);d._hoverChain=[]}else"click"==b&&(e=a.addEventListener?function(f){d.dispatchClick(f.target,f)}:function(f){c=a.defaultView||a.parentWindow;f=c.event;d.dispatchClick(f.srcElement,f)},k.addEvent(a,"mousedown",this._events[b].mousedown=e))};return d}var v=q();return u.RMB.DOMEvents=v});
a(T,[l],function(a){return a.create()});
a(va,function(){return function(f){for(var g=f.length,a=f[g-1],b=0,c=0,d=a.width,e=a.height,h=0,k=0;0<g--;)a=f[g],b=Math.max(0,b),c=Math.max(0,c),d=Math.min(a.width,d),e=Math.min(a.height,e),b+=a.x,c+=a.y,d+=a.x,e+=a.y,h+=a.x,k+=a.y;return b<d&&c<e&&{elemx:h,elemy:k,x:b,y:c,width:d-b,height:e-c}||{x:0,y:0,width:0,height:0}}});
a(o,[c,b,j],function(g,k,l){function p(b,c,f,d){Math.random()<(f||.03)&&a.queue.push({category:b,message:c,level:d});return{send:m}}function m(){for(var b=a.queue,c=b.length,f=c,d=new q,h;c--;)h=b.pop(),d.append("key"+(c+1),h.category),d.append("msg"+(c+1),h.message),d.append("level"+(c+1),h.level||"error");f&&(b=r((l&&l.host||"//track.adform.net")+"/serving/jslog/"))&&(b.onload=k.nop,b.onerror=k.nop,b.send(d))}function r(b){var c=null;return c={send:function(f){t.sendBeacon(b,
f)}}}var n=g.window,t=n.navigator,e=k.topAcc,u=e.setInterval;e=e.Adform=e.Adform||{};var q=n.FormData;g=g.log;var a=l.Log=e.Log=e.Log||{};a.queue=a.queue||[];a.sendMessage=a.sendMessage||g;a.pushMessage=a.pushMessage||p;a.notify=a.notify||u(m,1E3);return a});
a(H,[c,b,j,n,va,o],function(w,I,J,z,x,K){function E(){var b,d;if((b=q.$sf)&&(b=b.ext)&&b.geom&&(b=b.geom())){var a=b.self;if(d=b.par){b=+a.t;var k=+a.r,e=+a.b;a=+a.l;var c=+d.t,l=+d.r,g=+d.b;d=+d.l;d=Math.max(a,d);c=Math.max(b,c);k=Math.min(k,l);e=Math.min(e,g);b={x:d-a,y:c-b,width:k-d,height:e-c}}else b={x:0,y:0,width:a.w*a.xiv,height:a.h*a.yiv};return b}}function F(b){var d=b.screen,
a=d.availLeft||d.left||0,k=d.availTop||d.top||0,e=d.availWidth;d=d.availHeight;n=Math.min(n,a);r=Math.max(r,a+e);p=Math.min(p,k);t=Math.max(t,k+d);var c=[b.mozInnerScreenX,b.mozInnerScreenY];var l=b.screenX;a=b.screenY;k=l+b.outerWidth;b=a+b.outerHeight;n>=k-8&&(n=Math.floor(l/e)*e);r<=l+8&&(r=Math.ceil(k/e)*e);p>=b-8&&(p=Math.floor(a/d)*d);t<=a+8&&(t=Math.ceil(b/d)*d);return c}var q=w.window;w=q.screen;var y,A=[],G=!0,n=0,r=w.availWidth,p=0,t=w.availHeight;return J.ET.ViewUtil={inView:function(b,
d){var a=[],k=b,e=I.access,c,l=e.length,g=q,H=k.ownerDocument,B=[];if(!y)for(y=[],A=[],c=0;c<l;c++){y[c]=e[c]?g:null;if(e[c+1]){var L=A,M=c+1;if(e[c])var u=g.frameElement;else a:{u=g;for(var C=g.parent.document.getElementsByTagName("iframe"),D=C.length;D--;)if(C[D].contentWindow==u){u=C[D];break a}u=void 0}L[M]=u}g=g.parent}g=H.defaultView||H.parentWindow;for(c=0;c<l;c++)if(y[c]==g){B=A.slice(c);break}B[0]=k;e=B;c=0;l=e.length;for(k="PageGeometry";c<l;c++)if(b=e[c]){var m=z.client(b),f=z.offset(b);
f={x:f.left,y:f.top,width:b.offsetWidth,height:b.offsetHeight};if(!h){var h=f;h.area=h.width*h.height;h.visible=!0}if(!f.height||"hidden"==z.curCSS(b,"visibility"))return h.visible=!1,h;a.unshift({x:f.x-m.left,y:f.y-m.top,width:f.width,height:f.height});a.unshift({x:0,y:0,width:m.width,height:m.height});f=b.ownerDocument;f=f.defaultView||f.parentWindow}e={x:0,y:0,width:0,height:0};l=F(f);c={x:0,y:0,width:r-n,height:t-p};g={x:f.screenX-n,y:f.screenY-p,width:f.outerWidth,height:f.outerHeight};if(l)h.optimize=
!0,a.unshift(m={x:l[0]-n,y:l[1]-p,width:m.width,height:m.height}),f===f.top?m=x([c,m]):g?(a[0].x-=g.x,a[0].y-=g.y,a.unshift(g),m=x([c,g])):m=c,a.unshift(c);else{if(c=E()){G&&(K.pushMessage("safeframe",q.document.referrer||q.location.href),G=!1);k="SafeFrame";var v=c}v?(h.voidSend=!1,h.optimize=!0,a[0].x=-v.x,a[0].y=-v.y,e={x:0,y:0,width:v.width,height:v.height}):(h.optimize=!0,h.voidSend=!0);a.unshift(e);g&&(m=g)}h.visible&&(a=x(a),a.area=a.width*a.height,h.overlap=a,h.client=m);h.element=b;h.source=
k;return h},getOverlap:x,safeFrame:E,getScreenXY:F}});
a(ka,[j,ha,ia,fa,T,H,n,z,S,o],function(p,F,t,A,v,H,k,I,J,K){function w(a){var b,c;this.isAppView=J();this.isFirst=1;this.settings=a;this.viewabilitySource=0;var d=a.visibilityArea||50,e=a.visibilityTime||1,f=a.publisherVisibilityTime||1,g=a.publisherVisibilityArea||
50;"object"!=typeof d&&(d=[d]);"object"!=typeof e&&(e=[e]);this.visibilityArea=d;this.publisherVisibilityArea=g;var h=this.counters=[];for(b=0;b<d.length;b++)50>d[b]&&(this.fullSearch=!0),h.push(new F(d[b],1E3*e[b]));this.viewImpr=new F(g,1E3*f);b=h[0];this.visibility=b.visibility;this.mouse=b.mouse;this.delaylessMouse=b.delaylessMouse;this.video=b.video;this.expand=b.expand;this.exposure=b.exposure;this.viewableVideo=b.viewableVideo;this.clicks={length:0};this.flashClicksCount=this.jsClicksCount=
0;this.hmClicks=[];this.jsClicks=[];this.flashClicks=[];this.children=[];this.dimensions=[{width:a.width,height:a.height}];this.bannerProperties={};this.status="NOT VISIBLE";for(b=0;b<B.length;b++)(c=a[B[b]])&&"undefined"!=c&&(this[B[b]]=c);this.objectId||(this.objectId="FlashID"+this.id);this.data={visibilityT:0,mouseO:0,activeT:0,exposure:0,visibilityArea:d[0],visibilityTime:e[0],maxVisibility:0,currentVisibleArea:0};this.hoverDelay=k.singleCall(0);this.hover=k.bind(this,L);this.click=k.bind(this,
M);this.hmClick=k.bind(this,N);this._attributes={_videoPlay:!0};1<(a.compoundSeqNo||0)&&(this.unloadID=0)}function M(){this.jsClicksCount++;this.updateData()}function N(a,b,c){(a="object"==b.nodeName.toLowerCase()&&k.byTag(b,"embed")[0])&&20<a.offsetHeight&&(b=a);a=k.offset(b);var d=k.getMousePos(c);c=Math.floor(d.pageX-a.left);a=Math.floor(d.pageY-a.top);0<c&&0<a?this.hmClicks.push({x:c,y:a}):K.pushMessage("outside_heatmap",this.bn+" "+b.nodeName,.01)}function L(a){this.hoverDelay(this,O,"hoverin"==
a)}function O(a){x(this,a?"over":"out");this.updateData()}function x(a,b,c,d,e){var f=a.counters,g=f.length,h=!a.isMobile&&242500<=c;a.isLarge=h?1:a.isLarge;c&&(a.data.visibilityArea=f[0].minPercent=h?30:a.visibilityArea[0]);for(a.viewImpr&&(c&&(a.viewImpr.minPercent=h?30:a.publisherVisibilityArea),f=[a.viewImpr].concat(f),g+=1);g--;)c&&f[g].update(c,d,e),b&&f[g].action(b)}function G(a){for(var b=y.EngagementTracker().windows,c=0,d=b.length,e,f;c<d;c++)if((f=b[c].document)&&(e=k.byId(a,f)))return e}
function C(a,b){return a>=b?a:0}var P={PageGeometry:0,IntersectionObserver:1,mozInnerScreen:2,DOMEvents:3,elementFromPoint:4,requestAnimationFrame:5,SafeFrame:6,MRAID:7,wisp:8,AMP:9,OMID:10},y=p.ET;k.inherit(w,I);var B="bn unloadID cookieID id width height sendUnloadData isMobile".split(" ");y.EngagementItem=w;p=w.prototype;p.attr=function(a,b){var c=this._attributes,d=arguments.length;return 1<d?c[a]=b:d?c[a]:c};p.update=function(){var a,b=(this._elements||this.elements()).slice(),c=this.fullyLoaded=
this.attr("loaded"),d,e=[],f=this.children;if(f.length)for(a=0;a<f.length;a++)b.push.apply(b,f[a]._elements||f[a].elements(this));if(!this.optimizeLoop||A.isActive())for(a=0;a<b.length;a++)if(f=b[a]){var g="object"==f.nodeName.toLowerCase()&&k.byTag(f,"embed")[0];g&&20<g.offsetHeight&&(f=g);try{var h=H.inView(f,this.fullSearch);this.viewabilitySource=P[h.source]||0}catch(n){setTimeout(function(){throw n;},0);return}"voidSend"in h&&(this.doNotSendData=h.voidSend);h.optimize&&(this.optimizeLoop=!0);
d||(d=h);h.visible&&e.push(h)}if(c&&A.isActive()&&this.attr("_videoPlay")&&e.length){d=e[0];g=f=c=b=0;var r=d.client.width*d.client.height;a=0;for(h=e.length;a<h;a++){b+=e[a].overlap.area;f+=e[a].area;for(var l=a+1,q;l<h;l++)q=k.overlap(e[a].overlap,e[l].overlap),c+=q.width*q.height,q=k.overlap(e[a],e[l]),g+=q.width*q.height}x(this,null,f-g,b-c,r||0);a=this.data.currentVisibleArea=this.counters[0].visiblePercent;this.data.maxVisibility=Math.max(this.data.maxVisibility,a)}else x(this,"stop");d&&(this.data.x=
Math.floor(d.x),this.data.y=Math.floor(d.y));this.updateData()};p.elements=function(a){var b,c,d=this,e=a||d,f=d.settings;a=[];var g=f.trackElements,h=k.singleCall(500);if(g){var r=!0;for(c=0;c<g.length;c++)(b=G(g[c]))?a.push(b):r=!1;if(c=f.trackHeatMap)if(b=G(c))v.on(b,"click",d.hmClick);else r=!1;r&&(d._elements=a)}d.object=d.object||a[0];d.onclick=d.onclick||function(){d.emit.apply(d,arguments);e.click.apply(this,arguments)};d.ontouch=d.ontouch||function(){h(e,e.hover)};c=0;for(b;c<a.length;c++)if(b=
a[c])if(v.on(b,"hover",e.hover),v.on(b,"click",d.onclick),b.addEventListener&&b.addEventListener("touchstart",d.ontouch),!g)v.on(b,"click",d.hmClick);return a};p.flashClick=function(a,b){this.flashClicksCount++;this.flashClicks.push({x:parseInt(a,10),y:parseInt(b,10)});this.updateData()};p.engage=function(a){x(this,a)};p.updateData=function(){var a=this.data,b=this.visibility.update();this.status=b.active?"VISIBLE":"NOT VISIBLE";a.visibilityT=b.time;b=this.mouse.update();a.activeT=b.time;a.mouseO=
b.count;a.exposure=this.exposure.update().exposure;this.clicks.length=Math.max(this.jsClicksCount,this.flashClicksCount)};p.toUnloadString=function(a){var b;if(!this.doNotSendData&&this.unloadID&&this.bn&&this.object&&this.sendUnloadData){var c=this.data,d=this.visibility.update(),e=this.mouse.update(),f=this.delaylessMouse.update(),g=this.video.update(),h=this.expand.update(),r=this.exposure.update(),l=this.viewableVideo.update(),q=this.settings,n=this.hmClicks.length?this.hmClicks:this.flashClicks,
u=[],m=0;for(b=n.length;m<b;m++){var D=n[m].x,E=n[m].y;D&&0<D&&E&&0<E&&u.push(D+":"+E)}b=t.calculateEngagement;g=[g];h=[h];l=[l];n=this.children;for(m=0;m<n.length;m++)g.push(n[m].video.update()),h.push(n[m].expand.update()),l.push(n[m].viewableVideo.update());m=b.apply(t,g);l=b.apply(t,l);l=l<=m?l:m;n=b.apply(t,h);b=b.apply(t,[e].concat(g,h));g=this.counters;c=[c.maxVisibility,C(d.time,g[0].minTime),e.count,c.x||0,c.y||0,e.time,m,b,n,u.join(";"),r.exposure,y.EngagementTracker().friendly?0:1,"","",
g[1]?C(g[1].visibility.update().time,g[1].minTime):"",g[2]?C(g[2].visibility.update().time,g[2].minTime):"",A.wasActive?1:0,f.count,f.time,q.uData||"",q.adxvars||"",this.isLarge||"",this.isFirst+""+this.viewabilitySource,this.isAppView,l,0,""];d=this.bn+","+this.unloadID+",";e=d+c.join("|");a=y.EngagementTracker().queryLimit-(a||100);if(e.length>a){e=0;f=u.length;for(var z;e<f;)c[9]=u.slice(0,z=e+f>>1).join(";"),(d+c.join("|")).length>a?f=z:e=z+1;c[9]=u.slice(0,z).join(";");e=d+c.join("|")}this.isFirst=
0;return e}};p.addChild=function(a){this.dimensions.push({width:a.width,height:a.height});this.children.push(a);a._attributes=this._attributes;a.unloadID&&(this.unloadID=a.unloadID)};p.destroy=function(){var a=this._elements,b=this.mouseCallbacks;if(a)var c=a[0];b&&c&&(k.removeEvent(c,"mouseenter",b.enter),k.removeEvent(c,"mouseleave",b.leave));this._elements=this.object=null};return w});
a(pa,[c],function(l){function g(d){function h(){var a,b,e=+new Date;for(b=0;b<f.length;b++)(a=f[b])&&e>a.startTime+a.delay&&(a.fn(),f.splice(b,1));for(b=0;b<k.length;b++)a=k[b],e>a.startTime+a.delay&&(a.fn(),a.startTime=e);m(h)}var c=d||l.window,m=c.requestAnimationFrame;d=c.setInterval;var n=c.setTimeout,p=c.clearInterval;c=c.clearTimeout;var f=[],k=[];h();return{create:g,setInterval:d,setTimeout:n,clearInterval:p,clearTimeout:c}}return g()});
a(E,[c,j,ka,T,fa,b,n,z,L,J,x,pa],function(u,n,L,A,v,B,m,g,r,C,w,p){function k(){var a=this;if(k._instance)return k._instance;if(!(a instanceof k))return new k;k._instance=n.ADFEventsInstance=a;a.maxTime=6E5;a.items=a.events={};a.version=15;a.windows=[];a.byBN={};a._items={};a.startTime=t();a.friendly=!1;try{D.document.getElementById,
a.friendly=!0}catch(c){}a.queryLimit=2E3;a.update=m.bind(a,M);a.optimized=m.bind(a,N);m.addEvent(l,"beforeunload",B.nop);m.addEvent(l,"unload",function(){a.send(!0);a.destroy()});var b=m.bind(a,E);x(b,5E3);v.on("visible",function(){b()});x(b,54E4);a.setupWindow(l);try{y!=O&&y.document.getElementById&&a.setupWindow(y)}catch(c){}try{l.MESSENGER_POPUP&&a.setupWindow(P)}catch(c){}a.registerAll();a.registerInEvents()}function F(){var a=G();if(a)for(var b in a)this.register(a[b])}function H(a){var b=G();
b&&(a=this.register(b[a]))&&a.update()}function E(a){a?this.sendQuery(this.query()):(q=p.create(D),Q(this,this.query()))}function Q(a,b){var c=q?q.setTimeout:x,d=q?q.clearTimeout:R;if(b){var e=C().getRotSeed();e.unloads=e.unloads||[];e.unloads.push(b);e.sendTimeout&&(d(e.sendTimeout),e.sendTimeout=null);e.unloads.length&&(e.sendTimeout=c(function(){a.sendQuery(e.unloads.join("@@"));e.unloads=[]},50))}}function G(){var a=C();return a&&a.banners}function M(){var a,b=[],c=this.items;v.update();for(a in c){var d=
c[a],e=d.settings,h=e.publisherUnloadData,f=e.rtbdata;e=e.rtbwp;d.update&&(d.update(),d.counters&&I(d.counters)&&b.push(d),d.viewImpr&&I([d.viewImpr])&&(h&&this.sendQuery(this.query([d],!0),"&pud="+h),f&&e&&t()-this.startTime<=this.maxTime&&r.sendEvent(d.id,178,0,"Viewable impressions"),d.viewImpr=null))}b.length&&this.sendQuery(this.query(b));this.emit("update")}function I(a){for(var b=!1,c=a.length;c--;)b=!a[c].imprest&&(a[c].imprest=a[c].impression)||b;return b}function S(a,b){var c=this._items[a];
if(c){b=","+b+",";var d=J,e;for(e in d)d[e]&&~d[e].indexOf(b)&&c.engage(e)}}function N(){var a=t();100<a-K&&(K=a,this.update())}var l=u.window,T=p.setInterval,x=p.setTimeout,R=p.clearTimeout,U=p.clearInterval,O=l,P=l.MESSENGER_POPUP,D=l.top,y=l.parent,z=B.topAcc,q;u=n.ET;var t=Date.now||function(){return+new Date};m.inherit(k,g);u.EngagementTracker=k.getInstance=n.ADFEvents=k;var K=0,J={expand:[21,22],collapse:[143],videoPlay:[30],videoStop:[31,32,29,21,22,23,143]};g=k.prototype;g.subscribe=function(a){this.on("update",
a)};g.unsubscribe=function(a){this.off("update",a)};g.getItem=function(a){var b=this._items;if(b&&(b=b[a]))return this.byBN[b.bn]||b};g.registerAll=F;g.registerAllBanners=F;g.register=function(a){var b=this._items,c=this.items,d=this.byBN,e=a.id,h=a.bn,f=b[e];f||1!=a.registered||(f=b[e]=new L(a),a.compoundSeqNo?d[h]?d[h].addChild(f):(c[e]=d[h]=f,f.update()):(c[e]=f,f.update()),this.cookieID||(this.cookieID=f.cookieID));return f};g.addObjectEvents=H;g.addStandardEvent=H;g.checkVisibility=function(a){a&&
a.update&&a.update()};g.registerBannerProperties=function(){};g.addClick=function(a,b,c){(a=this.items[a])&&a.flashClick&&a.flashClick(b,c)};g.registerInEvents=function(){if(r&&r.registerCallback){var a=J,b;for(b in a)a[b].join&&(a[b]=","+a[b].join(",")+",");r.registerCallback(S,this)}};g.query=function(a,b){var c=[],d,e;a=a||this.items;for(var h in a)if((d=a[h])&&d.toUnloadString){var f=d.sendUnloadData;b&&(d.sendUnloadData=1);(e=d.toUnloadString())&&c.push(e);d.sendUnloadData=f}if(0<c.length)return c.join("@@")};
g.send=E;g.sendQuery=function(a,b){if(t()-this.startTime<=this.maxTime&&a){a=n.host+"/serving/unload/?version="+this.version+(b||"")+"&unload="+this.cookieID+"@@"+a;var c=this.queryLimit;if(a.length>c){for(var d=a.split("@@"),e=d.shift(),h=e+"@@"+d[0],f=1;f<d.length;f++)(h+"@@"+d[f]).length>c&&(w(h,z),h=e),h+="@@"+d[f];w(h,z)}else w(a,z)}};g.addElement=function(a,b,c){if(a=this._items[a]){c&&this.setupWindow(c);c=a.settings.trackElements;var d=c.length;c.push.apply(c,b);a._elements=null;a.elements();
c.length=d;a._elements=null}};g.removeElement=function(a,b,c){this._items&&(a=this._items[a])&&c&&(this.removeWindow(c),a._elements=null)};g.setupWindow=function(a){for(var b=this.windows,c=0;c<b.length;c++)if(b[c]==a)return;try{var d=a.document;b.push(a);var e=this.update,h=this.optimized,f=m.addEvent;f(a,"resize",e);f(a,"load",e);f(a,"scroll",h);f(d,"mousemove",h);f(d,"mousedown",h);f(d,"mouseup",h);this._winInterval||(this._winInterval=T(h,100))}catch(W){}};g.removeWindow=function(a){try{var b=
a.document,c=this.update,d=this.optimized,e=m.removeEvent;e(a,"resize",c);e(a,"load",c);e(a,"scroll",d);e(b,"mousemove",d);e(b,"mousedown",d);e(b,"mouseup",d);A.destroy(b)}catch(h){}b=this.windows;for(c=b.length;c--;)if(b[c]==a){b.splice(c,1);break}};g.destroy=function(){this.emit("destroy");for(var a=this.windows,b=a.length;b--;)this.removeWindow(a[b]);this.windows=[];U(this._winInterval);a=l;do try{a.__flash_visibility&&a.__flash_visibility.destroy()}catch(c){break}while(a!=a.top&&(a=a.parent));
a=this._items;for(b in a)a[b]&&a[b].destroy&&a[b].destroy();v.destroy();A.destroy();this._items=this.items=this.events=this.byBN=null};n._etCallback?n._etCallback(k()):k();return k});
a(q,[j,z,n,E],function(t,e,u,v){function n(){k||(k=v(),k.on("destroy",w),k.subscribe(r),r());return k}function f(b){var a=n();return a&&a.getItem(b)}function l(b){if(this instanceof l)throw Error('This function cannot be used with operator "new".');var a=f(b);a&&a.id&&(b=a.id);return h[b]||(h[b]=new p(b))}function r(){for(var b in h)h[b].refresh()}function w(){for(var b in h)h[b].emit("destroy")}function p(b){var a=this;a.xId=b;
a._queue=[];a._attributes={};a.set("visible",!1);a.set("loaded",!1);a.set("percent",0);a.set("clicksCount",0);a.on("change:loaded",function d(){var c=f(a.xId);if(c){var m=c.elements().slice();if(c.children)for(var q=0;q<c.children.length;q++)m.push.apply(m,c.children[q].elements())}else m=void 0;m.length&&(a.off("change:loaded",d),a._settings.events.emit("trackingElements",m,{creativeId:c.settings.ban,tagId:c.settings.bn,impressionId:c.settings.unloadID}))});a.refresh();a._changes=null;if(!n())a.once("newListener",
x)}function x(){n(!0)}var k,h={};u.inherit(p,e);e=p.prototype;e.set=function(b,a){var g=f(this.xId),d=this.get(b),c=this._changes;g?g.attr(b,a):(this._attributes[b]=a,this._queue.push([b,a]));d!==a&&(c||(c=this._changes={}),c[b]=a,this.emit("change:"+b,a,d));return this};e.get=function(b){if(this["get_"+b])return this["get_"+b]();var a=f(this.xId);return a?a.attr(b):this._attributes[b]};e.get_visibleTime=function(){var b=f(this.xId);return b&&b.visibility.time};e.refresh=function(){var b=this._queue;
var a=0,g=b.length,d=f(this.xId);if(d){if(g){for(this.emit("registered");a<g;a++)d.attr(b[a][0],b[a][1]);b.length=0}this.set("visible",d.visibility.active);this.set("percent",d.data.currentVisibleArea);this.set("clicksCount",d.clicks.length);if(b=this._changes)this._changes=null,this.emit("change",b)}return this};e.engage=function(b){var a=f(this.xId);a&&a.engage(b);return this};l.version=function(){};l.load=function(b,a){if(a){var g=l(a.options.xId);g._settings=a}n(!0)};return t.RMB.EngagementAPI=
l});
a(A,[c,j,z],function(n,u,v){function p(a){var g=k.length,l=d&&w||b&&x||k;if(l)for(;g--;)l[g]&&a.hasOwnProperty(k[g])&&(e[l[g]]=a[k[g]]);if(!q){q=!0;try{d?d.init(e):b?b.register(e.width,e.height,m):f&&y(z,100)}catch(A){n.rethrow(A,"frame-api")}}}function z(){f.enableExpansion({width:e.width+e.left+e.right,height:e.height+e.top+e.bottom,expansionMode:0,collapseCallback:r,expansionCallback:t})}function t(){m("expanded")}function r(){m("collapsed")}function m(a){c.emit(a)}
var y=n.window.setTimeout,d,b,f,q,c=new v,e={},k="width height top right bottom left pushdown".split(" "),w="width height offsetTop offsetRight offsetBottom offsetLeft".split(" "),x="width height t r b l push".split(" "),h={over:!1,pushdown:!1};c.support=h;c.init=function(a){var g=a.inDapMgrIf||a.inDapIF||a.inFIF;b=(b=a.$sf)&&(b=b.ext)&&b.supports&&b;f=a.IN_ADSENSE_IFRAME&&a.CreativeToolset&&new a.CreativeToolset;if(!b&&!f&&g)try{d=a.$WLXRmAd||a.parent.$WLXRmAd}catch(l){}c.msAPI=d;c.sfAPI=b;c.ctAPI=
f;c.hasAPI=!!(d||b||f);d||f?(h.over=!0,h.pushdown=!1):b&&(a=b.supports(),h.over=!0===a["exp-ovr"]||"1"===a["exp-ovr"],h.pushdown=!0===a["exp-push"]||"1"===a["exp-push"])};c.register=p;c.update=p;c.expand=function(a){if(a)c.once("expanded",a);f?f.expandWindow():d?(d.expand(),t()):b&&b.expand(e)};c.collapse=function(a){if(a)c.once("collapsed",a);f?f.collapseWindow():d?(d.collapse(),r()):b&&b.collapse()};return u.IframeApiWrapper=c});
a(r,[c,b,j,A,z,n,B],function(q,ya,K,B,za,m,lb){function Aa(b,d){var k={BR:"TL",TR:"BL",BL:"TR",TL:"BR"};switch(b.type){case W:case da:d.closeButtonAlign=k[b.expPosition]||d.closeButtonAlign;"TR"==d.closeButtonAlign&&d.adNotice&&(d.closeButtonAlign="TL");break;case X:d.closeButtonAlign="TL"==b.position?"BR":"BL";break;case L:d.closeButtonAlign=d.adNotice?"TL":"TR"}}function Ba(){var b=K.ADFBannerUtils;if(b&&b.getInstance)return b.getInstance()}
function Ca(){return{title:"Adform.com",linkText:"Read more",text:"Would you like to know more about why you are seeing this ad?",link:"http://site.adform.com/privacy/adchoices/"}}function ea(b,d){return b&&~b.indexOf("ADFassetID=")&&b.match(mb)[1]||d&&d.ADFassetID||0}function Da(b){var d,k={};if("string"!=typeof b)k=b||{};else{b=b.split("&");var r=0;for(d=b.length;r<d;r++){var C=b[r].split("=");k[C.shift()]=fa(C.join("="))}}return k}function fa(b){if(b){try{b=decodeURIComponent(b)}catch(d){}0<=b.indexOf("&")||
!b.indexOf("http")?b=encodeURIComponent(b):0<=b.indexOf(";CREFURL=")&&(b=b.split(";CREFURL="),b=b.concat(b.pop().split(";C=")),b=b[0]+";CREFURL="+encodeURIComponent(b[1])+(b[2]?";C="+b[2]:""))}return b}var l=q.window,nb=l.parent,Y=l.document,ob=Y.location;q={};var W=q.EXPANDING="expanding",X=q.TEARBACK="tearback",L=q.FLOATING="floating",pb=q.STANDARD="standard",da=q.SINGLE_EXPANDING="singleExpanding",Ea=q.INTERSTITIAL="interstitial",qb=q.SLIDER="slider",mb=/ADFassetID=(\d*)/,rb=/;obaId=([^;]+)/,Fa=
/\.js(\?|$)/i,Ga=/\.swf(\?|$)/i,sb={ADFInitFlash:"src",ADFFlash:"src",ADFTearFlash:"esrc",tearWidth:"ewidth",tearHeight:"eheight",fVer:"version",ADFVer:"version",clicktags:"flashvars",ADFBuckup:"bsrc",bclickUrl:"link",backupClickURL:"link",ADFBuckupClickURL:"link",videoSources:"sources",bannerAlign:"position",expandsTo:"expPosition",adfxid:"xId",ADFid:"xId",expandDelay:"showDelay",expandTime:"showTime",collapseTime:"hideTime",autoShowAfter:"autoShow",showTimeout:"autoShow",autoCloseAfter:"autoHide",
closeTimeout:"autoHide",showOnRollOut:"showType",closeOnRollOut:"hideType",keepCollapsed:"keepCollapsed",politeTimeout:"loadDelay",expandedX:"expX",expandedY:"expY","":""},Ha={src:"",width:0,height:0,version:7,play:!0,menu:!1,loop:!0,quality:"autohigh",wmode:"opaque",bgcolor:null,allowScriptAccess:"always",allowFullScreen:!0,flashvars:{}},Ia={src:"",width:0,height:0,link:""},tb={width:0,height:0,poster:"",css:null,closeButtonAlign:null,loop:"false",muted:"true",autoplay:"false",link:null,assetId:0},
Ja={src:"",width:0,height:0,flashvars:{}},ub={position:"L",colPosition:"C",expPosition:"TL",x:0,y:0,expX:0,expY:0,xId:"1x",zIndex:1E5,fixed:0,restartAnimation:0,clickEvent:"",showDelay:0,showType:0,hideType:0,autoShow:0,autoHide:0,behavior:"default",frameRate:0,showTime:0,hideTime:0,loadDelay:0,type:"none",keepCollapsed:0,sideKickAnim:1,landingPageTarget:"_blank",showFloat:1},vb={gdpr:!0};q.getData=function(b){var d,k,r,C,Ka,e,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,ha,Ta,Ua,Va,Wa,wb={0:"default",1:"pushdown",2:"sidekick",
3:"floating",takeOver:"takeover",4:"slider"},xb=[0,"MC","TC","TL","TR","BL","BR","ML","MR","BC"],y=m.extend({},Ha),F=m.extend({},Ha),M=m.extend({},Ia),Z=m.extend({},Ia),h=m.extend({},tb),u=m.extend({},Ja),z=m.extend({},Ja),N={},a=m.extend({},ub),ia=!b.flashvars,v=b.clicktags=Da(b.clicktags),D=v.backupClickUrl||v.clickTAG,yb=a.bn=v.bn||b.ADFban,E=Ba(),ja={},ka=[],zb=ya.flashVersion,g={},n={};B.init(l);a.messenger=!1;a.iframeAPI=B;a.iab=(!B.hasAPI||B.msAPI)&&(l.inDapMgrIf||l.inDapIF||l.inFIF)&&!0;a.backCompat=
!ia;for(d in b){var f=sb[d]||d,c=b[d];switch(f){case "bsrc":!h.poster&&(h.poster=c);case "src":var O=ea(c,v),P=c.match(Ga)?y:c.match(Fa)?u:M;P.src=c;P.assetId=O;!h.assetId&&(h.assetId=O);break;case "besrc":h.poster=c;case "esrc":O=ea(c,v);P=c.match(Ga)?F:c.match(Fa)?z:Z;P.src=c;(P.assetId=O)&&(h.assetId=O);break;case "width":case "height":y[f]=M[f]=N[f]=u[f]=c>>0;!h[f]&&(h[f]=c>>0);break;case "ewidth":case "eheight":f=f.slice(1);F[f]=Z[f]=h[f]=z[f]=c>>0;break;case "wmode":case "version":case "quality":case "defaultClickTAG":y[f]=
F[f]=u[f]=z[f]=c;break;case "flashvars":var p=y[f]=F[f]=u[f]=z[f]=c;break;case "link":D=ia?fa(encodeURIComponent(c)):c;break;case "css":var Xa=c.split("/assets/css/");a.scriptsBase=K.scriptBase||Xa[0]+"/";c=a.scriptsBase+"assets/css/"+Xa[1];case "sources":a[f]=h[f]=c;break;case "ADFPoliteSrc":N.src=c;N.assetId=ea(c,v);break;case "showType":a[f]=0==c?1:2==c?2:0;break;case "hideType":a[f]=1==c?0:1;break;case "floatPosition":a[f]=xb[c];break;case "behavior":a[f]=wb[c];break;case "zIndex":var Ya=parseInt(c,
10);a[f]=isNaN(Ya)?a.zIndex:Ya;break;default:a[f]=c}}var Ab=a.userParams=a.userParams||{};if(e=E&&E.banners&&E.banners[a.xId]){if(Va=e.csImpressionUrl)a.csImpressionUrl=Va;e.disableFlash&&(ya._noFlash=!0);if(Wa=e.dynamicAdContent)p.dynamicAdContent=Wa;for(var Bb=p,la,ma,Za=["gdpr","gdpr_consent","gpp","gpp_sid","us_privacy"],na=0;na<=Za.length;na++)la=Za[na],ma=e[la],void 0!==ma&&(Bb[la]=ma);if(La=e.compoundSeqNo)a.seqNo=p.seqNo=La;e.cookieID&&(p.icid=e.cookieID);if(Ma=E.getPropByBn&&E.getPropByBn("animURL",
yb))Ab.animURL=Ma;if(Na=E.getRotSeed&&E.getRotSeed().id)p.hash=Na;if(Oa=e.rotseqno)p.rotseqno=Oa;if(Pa=e.smid)p.smid=Pa;if(Qa=e.timeDiff)p.timeDiff=Qa;if(Ta=e.dcoEngineId)p.dcoEngineId=Ta;e.isCcpaOptOut&&(p.ccpa="1");if(Ua=e.trackingSetupId)p.trackingSetupId=Ua;a.bannerId=e.ban;if(!B.ctAPI&&e.isDSPTag&&l!=l.parent)try{l.parent.document.getElementById,l.inFIF=a.iab=!0}catch(oa){K.ADFIframe=1}if(Ra=e.unloadScriptVersion)a.unloadVersion="v"+Ra;if(e.sendUnloadData||e.publisherUnloadData)a.sendUnload=
!0;a.bv=e.bannerVersion}a.forceBackup=!(a.iab||B.hasAPI);"takeover"==a.behavior&&(a.autoShow=.01,a.autoHide=8);B.msAPI&&!a.showType&&(a.showType=1);p.expandsTo=a.expPosition;p.wmode=y.wmode;if(Sa=l.ADFDomainCDN)p.hvfdomain=Sa;var A=a.type;A==W&&"slider"==a.behavior&&(A=a.type=qb);if(A==L||A==Ea)D=v.clickTAG;if(D){if(ia)for(k=3;k--&&(2>(C=D.indexOf("://"))||8<C);)try{D=decodeURIComponent(D)}catch(oa){k=0}u.link=z.link=M.link=Z.link=h.link=N.link=D}A==X&&(a.behavior=X);for(var aa=Ca(),x,ba,G,Cb=new RegExp("[?;]bn="+
a.bn+"\\b"),pa=a.seqNo&&new RegExp("[?;]compoundSeqNo="+a.seqNo+"\\b|[?;]singleTag=1\\b"),$a=m.byTag(Y,"script"),qa=$a.length,H=Y.body,ab="compound-"+(pa?a.seqNo:"");qa--;)if(G=x=$a[qa],(ba=x.src)&&0<ba.indexOf("adfscript")&&ba.match(Cb))if(!pa){if(!x.getAttribute("adfscript-parsed")){x.setAttribute("adfscript-parsed",!0);break}}else if(ba.match(pa)&&!x.getAttribute(ab)){x.setAttribute(ab,!0);break}for(;0<=qa&&G&&H&&G!=H;)G=G.parentNode;a.$tag=a.placement||(G!=H?H&&(H.firstChild||H.appendChild(Y.createTextNode(" "))):
x);var ra=x&&x.src;K.ADFIframe&&(ra=ob.search);(ha=ra&&ra.match(rb))&&ha[1]&&(a.obaId=ha[1],a.adNotice=1,aa.link="http://site.adform.com/privacy/adchoices/");if(e&&e.adNotice||a.adNotice)e&&e.OBAUrl&&(aa.link=e.OBAUrl),u.adNotice=y.adNotice=M.adNotice=aa,A!=W&&(h.adNotice=aa),a.adNotice=1;if(A==L&&(a.restartAnimation=1,e)){e.floatFrom&&(a.position=e.floatPosition>>0,a.floatFrom=e.floatFrom);var bb=parseInt(e.showFloat,10);a.showFloat=isNaN(bb)||1<=bb?1:0}A==da&&(F.src=y.src,z.src=u.src,"sidekick"!=
a.behavior&&(a.sideKickAnim=1),!a.sideKickAnim&&(p.useAsMask=!1));var I=u.flashvars,cb=l.ADFDynamicDomain;I.staticDomain=I.domain;l.ADFDomain&&cb&&(I.domain=encodeURIComponent(cb));for(d in I){c=I[d];if("object"!==typeof c&&!vb[d])try{c=decodeURIComponent(c)}catch(oa){}ja[d]=c}var Q=b.videoSources,db=I.staticDomain,Db=db&&decodeURIComponent(db),eb,R;for(eb in Q)(R=Q[eb])&&R.file&&!~R.file.indexOf("://")&&(R.file=Db+R.file);if(Q){k=0;for(r=Q.length;k<r;k++)(Ka=Q[k])&&ka.push(Ka);ka.length&&(ja.videoSources=
h.sources=ka)}u.flashvars=z.flashvars=ja;var S,T=a.AdformBgImage&&a,fb=Ba(),gb=fb&&fb.banners,hb={Color:"",Repeat:"",Scroll:"",HorizontalPosition:"center",VerticalPosition:"top"};for(S in gb){var sa=gb[S];if(sa.bn==a.bn&&sa.AdformBgImage){T=sa;break}}if(T){var ib='url("'+T.AdformBgImage+'")';for(S in hb)ib+=" "+(T["AdformBg"+S]||hb[S]);a.wallpaper={link:T.AdformBgLink,background:ib}}var J=a.position,ta=a.expPosition,ua=a.floatFrom,Eb={1:"M",2:"T",3:"T",4:"T",5:"B",6:"B",7:"M",8:"M",9:"B"},Fb={1:"C",
2:"C",3:"L",4:"R",5:"L",6:"R",7:"L",8:"R",9:"C"},Gb={1:"M",2:"Y",3:"Y",4:"Y",5:"N",6:"N",7:"M",8:"M",9:"N"},Hb={1:"C",2:"C",3:"K",4:"E",5:"K",6:"E",7:"K",8:"E",9:"C"},Ib=ua?Gb:Eb,Jb=ua?Hb:Fb,Kb={custom:"TL","left-up":"BR",takeOver:"BR",left:"TR","left-down":"TR",up:"BL","right-up":"BL",down:"TL",right:"TL","right-down":"TL"},jb=a.$tag&&a.$tag.parentNode,Lb="inline"==(jb&&m.curCSS(jb,"display"));switch(a.type){case pb:var va={left:"L",center:"C",right:"R"};a.position=va[J]||(a.backCompat&&!Lb?"I":
"C");break;case Ea:a.fixed=1;var wa=(a.y?"T":"M")+(a.x?"L":"C");a.position=wa;a.x>>=0;a.y>>=0;break;case L:a.x>>=0;a.y>>=0;ua||(0>a.x&&(a.x=0),0>a.y&&(a.y=0));wa=(a.y?"T":Ib[J]||"M")+(a.x?"L":Jb[J]||"C");a.position=wa;break;case W:case da:va={left:"L",center:"C",right:"R"};a.position=a.colPosition=va[J]||J;a.expPosition=Kb[ta]||ta;"custom"!=ta&&(a.expX=a.expY=0);break;case X:a.position=a.colPosition=a.expPosition="2"==""+J?"TR":"TL"}a.disturber=new za;g.flash=g.colFlash=y;g.expFlash=F;g.image=g.colImage=
M;g.expImage=Z;g.video=h;g.html=g.colHtml=u;g.expHtml=z;g.polite=N;g.options=a;g.events=new za;var kb,t=g.options,U={zIndex:t.zIndex-1},Mb=t.iab?nb:l;try{var V=Mb.ADFORM_OVERLAY||l.ADFORM_OVERLAY}catch(oa){V=l.ADFORM_OVERLAY}var xa={bn:t.bn,closeOnClick:t.overlayCloseOnClick||1,style:U};t.overlayOpacity&&(U.opacity=(t.overlayOpacity>>0)/100);t.overlayColor&&(U.background=t.overlayColor);if(t.type==L&&V){var ca=0;for(kb=V.length;ca<kb;ca++)if(t.bn==V[ca].bn){var w=V[ca];break}w&&("undefined"!=typeof w.callFrom&&
(xa.callFrom=w.callFrom),"undefined"!=typeof w.closeOnClick&&(xa.closeOnClick=w.closeOnClick),w.color&&(U.background=w.color),w.opacity&&(U.opacity=w.opacity))}if(w||t.overlayOpacity)g.overlay=xa;for(d in g)if(g[d].src||g[d].sources)n[d]=g[d];n.options=a;n.events=g.events;g.overlay&&(n.overlay=g.overlay);h.sources&&(h.loop="true"==""+v.loopVideo,h.muted="true"!=""+v.soundOn,h.autoplay="true"==""+v.autoPlay,Aa(a,h));n.image&&m.isIE&&10>m.ieVersion&&(delete n.video,delete n.html,delete n.expHtml,delete n.colHtml);
var Nb="standard"==a.type&&"flash"==a.subtype;(n.image||n.html)&&(21>zb&&!m.isIE||m.isSafari&&6.1<=m.safariVersion&&Nb)&&(delete n.flash,delete n.colFlash,delete n.expFlash);return n};q.parseFlashvars=Da;q.fixFlashvarsValue=fa;q.applyHooks=function(b,d){var k,r;lb(b,d);var C=(b.html||b.flash||b.image||b.video||{}).adNotice||Ca();if(k=b.options._adNotice){for(r in k)k.hasOwnProperty(r)&&(C[r]=k[r]);delete b.options._adNotice}b.video&&Aa(b.options,b.video);return b};return K.RMB.DataParser=q});
a(k,[j,n,z],function(l,g,m){function k(){k.super_.call(this);this._previous={};this._attributes={};this._sets=[]}g.inherit(k,m);g=k.prototype;g.set=function(b,a){var d,c=this._sets,e=this._attributes;if("object"==typeof b)for(d in b)b.hasOwnProperty(d)&&(e[d]=b[d],c.push(d));else e[b]=a,c.push(b);return this.commit()};g.get=function(b){var a=this._attributes;return b?a[b]:a};g.commit=function(){var b,a,d=this._sets,c=this._attributes,e=this._previous,f=this._changes,
h=!1;if(!this._commit&&d.length){this._commit=!0;f||(f=this._changes={});for(b=0;a=d[b];b++)c[a]!==e[a]&&c[a]!==f[a]&&(f[a]=c[a],h=!0,this.emit("change:"+a,c[a],e[a],a));if(h){f={};h=!1;for(a in c)c[a]!==e[a]&&(f[a]=c[a],h=!0);h&&this.emit("change",f)}this._commit=!1;d.splice(0,b);if(d.length)this.commit();else for(a in this._changes=null,c)c.hasOwnProperty(a)&&(e[a]=c[a])}return this};g.onchange=function(b,a){return a?this.on("change:"+b,a):this.on("change",b)};return l.RMB.StateEmitter=k});
a(m,[c,j,n],function(e,u,n){function l(a,b){"string"!=typeof a&&(b=a,a="default");if(this instanceof l)this._id="adfrom-styleSheet-"+a,this._doc=b||v;else return new l(a,b)}var k,p,q;e=e.window;var v=e.document,w=e.setTimeout;e=l.prototype;e.node=function(){var a=this._doc;var b=this._id,c=n.byId(b,a);c||(c=a.createElement("style"),c.type="text/css",c.id=b,c._rules={},n.byTag(a,"head")[0].appendChild(c));!k&&(p=c.sheet?"sheet":"styleSheet",a=c[p])&&(q=a.insertRule?function(d,
f,g,h){d.insertRule(f+" {"+g+"}",h)}:function(d,f,g,h){d.addRule(f,g,h)},k=a.cssRules?"cssRules":"rules");return c};e.set=function(a,b){var c=this.node(),d=c[p];try{var f=c._rules;var g=f[a]}catch(t){}var h=a.split(/\s*,\s*/),m;try{if(1<h.length)for(m=h.length-1;0<=m;--m)this.set(h[m],b);else if(g)g.style.cssText+=";"+b;else if(!d||!d[k])c.appendChild(this._doc.createTextNode(a+"{"+b+"}"));else if(b){var r=d[k].length;try{q(d,a,b,r)}catch(t){w(function(){q(d,a,b,r)},0)}f&&(f[a]=d[k][r])}}catch(t){}return this};
e.destroy=function(){var a=n.byId(this._id,this._doc);a&&a.parentNode.removeChild(a);this._doc=null};return u.RMB.StyleSheet=l});
a(i,[c,j,k,l,m,n,o],function(z,aa,ba,W,O,f,ca){function q(){var b=f.bind;q.super_.call(this);this.cssQueue=[];this.id=f.gid("adform-adbox-");this.set({showing:!1,visible:!0}).onchange("visible",X).onchange("element",X).onchange("zIndex",da).onchange(ea);this._contents={};this._pos={};this.findElement=b(this,fa);this.repositionPage=b(this,P);this.repositionFloated=b(this,L);this.repositionSticky=b(this,Q)}function ha(b){var a;
(a=this._hub)&&a.emit("element",this,this._hubName,b)}function da(b){this.style({zIndex:b})}function fa(){var b=f.byId(this.id,this._doc),a=this.get("frame");this._findCalls||(this._findCalls=(new Date).getTime()+q.fTimeout);if(b)this.handleHover=f.bind(this,ia),this.handleClick=f.bind(this,ja),W.on(a||b,"hover",this.handleHover),f.addEvent(b,"mousedown",this.handleClick),b.innerHTML="",this.set("element",b).css("").style();else if(this._findCalls>(new Date).getTime())E(this.findElement,0);else throw ca.pushMessage("adbox",
"AdBox element not found"),Error("AdBox element not found");}function ia(b){var a=this.hovered="hoverin"==b;this.emit("hover",a,this);this.emit(b,a,this)}function ja(b){this.emit("click",b||this._win.event)}function Y(b){var a=this._doc,d=b.from;a=b.type||(d?d.window==d?"fixed":d===a?"page":"floated":"static");var c=b.position||"",e=R.exec(c);c=S.exec(c);var h=this.get(),k=this.get(),g=k.postype;if(k=k.element)k.className=k.className.replace(new RegExp("\\s*adform-adbox-"+g+"(-\\w+)?\\s*","g")," ");
e=e?e[0]:"L";c=c?c[0]:"T";h.vpos=c;h.hpos=e;h.postype=a;h.frompos=d;this.resetPosition&&this.resetPosition();ka.call(this,a,h,b)}function ka(b,a,d){var c=this,e=c._win,h=c._doc,k=a.element,g=!1,l=!1,p=!1,t=a.vpos,n=a.hpos;k&&(f.addClass(k,"adform-adbox-"+b+"-"+a.vpos),f.addClass(k,"adform-adbox-"+b+"-"+a.hpos),f.addClass(k,"adform-adbox-"+b));c.positionType=b;if("static"==b)c.onchange("x",G).onchange("y",G).onchange("showing",G),c.resetPosition=function(){c.off("change:x",G).off("change:y",G).off("change:showing",
G);c.resetPosition=null};else if("fixed"==b){var v=h.documentElement;var B=h.body;var C=function(m){if(a.showing&&!1!==a.fixedBounding){var x=v.clientWidth||B.clientWidth;var y=v.clientHeight||B.clientHeight;var w=a.element;var D=w.offsetWidth-a.x;w=w.offsetHeight-a.y;m&&m.showing&&(g=l=null);c._hp||l==x<D||(m=(l=x<D)?0:"",c.style({left:m,marginLeft:m,marginRight:m}));c._vp||g==y<w||(m=(g=y<w)?0:"",c.style({top:m,marginTop:m,marginBottom:m}))}};var F=function(m){!1===m?(l=g=!1,m="",c.style({left:m,
marginLeft:m,marginRight:m,top:m,marginTop:m,marginBottom:m})):C()};la&&(c.iOSFixed=function(){var m={},x=v.scrollLeft||B.scrollLeft,y=v.scrollTop||B.scrollTop,w=v.clientWidth||B.clientWidth,D=v.clientHeight||B.clientHeight;"L"==n&&(m.left=x+"px");"C"==n&&(m.left=x+Math.round(w/2)+"px");"R"==n&&(m.right=-x+"px");"T"==t&&(m.top=y+"px");"M"==t&&(m.top=y+Math.round(D/2)+"px");"B"==t&&(m.bottom=-y+"px");c.style(m)},f.addEvent(e,"scroll",this.iOSFixed));f.addEvent(e,"resize",C);c.onchange(T).onchange(C).onchange("fixedBounding",
F);T.call(this);C();c.resetPosition=function(){c.off("change:fixedBounding",F).off("change",C).off("change",T);C&&f.removeEvent(e,"resize",C);c.iOSFixed&&f.removeEvent(e,"scroll",c.iOSFixed);c.css("margin:0");F(!1);c.resetPosition=null}}else if("sticky"==b)c.onchange(Q),c.handleResize=f.bind(c,ma),f.addEvent(e,"resize",c.handleResize),f.addEvent(e,"scroll",c.handleResize),f.addEvent(e,"load",c.handleResize),c.handleResize(),E(c.handleResize,50),c.resetPosition=function(){c.off("change",Q);c.handleResize&&
(f.removeEvent(e,"resize",c.handleResize),f.removeEvent(e,"scroll",c.handleResize),f.removeEvent(e,"load",c.handleResize),c.handleResize=null);c.resetPosition=null};else if("page"==b){c.onchange(P);c.resizeDelay=f.singleCall(100);c.handleResize=f.bind(c,na);f.addEvent(e,"resize",c.handleResize);f.addEvent(e,"scroll",c.handleResize);f.addEvent(e,"load",c.handleResize);c.handleResize();var A=U(c.handleResize,100);E(function(){M(A)},3E3);c.resetPosition=function(){c.off("change",P);c.handleResize&&(f.removeEvent(e,
"resize",c.handleResize),f.removeEvent(e,"scroll",c.handleResize),f.removeEvent(e,"load",c.handleResize),c.handleResize=null);M(A);c.resetPosition=null}}else if("floated"==b)c.onchange(L),d.container!=d.from?(c.resizeDelay=f.singleCall(10),c.handleResize=f.bind(c,oa),f.addEvent(e,"resize",c.handleResize),c._fromInt=U(c.handleResize,500),f.onload(H,c.handleResize),E(c.handleResize,50),c.handleResize()):E(function(){L.call(c)},0),c.resetPosition=function(){c._lastFromPos=null;c.off("change",L);c.handleResize&&
(f.removeEvent(e,"resize",c.handleResize),c.handleResize=null);M(c._fromInt);c.resetPosition=null};else if("mobile"==b){var r=e.innerWidth>=e.innerHeight;b=function(){c.pos.width=c.pos.height=0};var u=function(){var m,x,y=a.width,w=a.height;var D=c._hp;var pa=c._vp,Z=c.pos||{};if(a.showing&&!p){var I=k.getBoundingClientRect();var J=e.innerWidth;var K=e.innerHeight;r&&J<K||!r&&J>=K?(p=!0,E(function(){p=!1},500)):(y=D?J*parseFloat(y)/100:y,w=pa?K*parseFloat(w)/100:w,D=(parseFloat(Z.left)||0)-I.left,
I=(parseFloat(Z.top)||0)-I.top,"C"==n?m=Math.round(D+(J-y)/2):"L"==n?m=Math.floor(D):"R"==n&&(m=Math.ceil(D+(J-y))),"M"==t?x=Math.round(I+(K-w)/2):"T"==t?x=Math.floor(I):"B"==t&&(x=Math.ceil(I+(K-w))),c.setPosition(x,m,0,0,0,0,y,w));r=J>=K}};var N=U(u,100);f.addEvent(e,"resize",u);f.addEvent(e,"scroll",u);c.onchange("showing",u).onchange("width",b).onchange("height",b);u();c.resetPosition=function(){f.removeEvent(e,"resize",u);f.removeEvent(e,"scroll",u);c.resetPosition=null;M(N)}}}function na(){this.repositionPage({showing:1})}
function ma(){this.repositionSticky({showing:1})}function qa(b){var a=b.defaultView||b.parentWindow,d=b.documentElement||b.body;a.self||(a=H);this._doc=b;this._win=a;this.sheet=O("adbox",b);if(!a.__adform_adbox_init){var c=O("adbox-static",b);c.set(".adform-adbox-hidden","visibility:hidden").set(".adform-adbox-mobile","position:absolute").set(".adform-adbox-static","position:relative").set(".adform-adbox-static-L","margin:0 auto 0 0").set(".adform-adbox-static-C","margin:0 auto").set(".adform-adbox-static-R",
"margin:0 0 0 auto").set(".adform-adbox-static-I","display:inline-block;*display:inline;zoom:1").set(".adform-adbox-floated","position:absolute;display:block!important").set(".adform-adbox-page,.adform-adbox-fixed,.adform-adbox-sticky","position:fixed;display:block!important").set(".adform-adbox-page-L,.adform-adbox-fixed-L","left:0").set(".adform-adbox-page-C,.adform-adbox-fixed-C","left:50%").set(".adform-adbox-page-R,.adform-adbox-fixed-R","right:0").set(".adform-adbox-page-T,.adform-adbox-fixed-T",
"top:0").set(".adform-adbox-page-M,.adform-adbox-fixed-M","top:50%").set(".adform-adbox-page-B,.adform-adbox-fixed-B","bottom:0").set(".adform-adbox-overlay","position:fixed;right:0;bottom:0;width:300%;height:300%").set(".adform-adbox-overlay iframe","display:none;position:absolute;top:0;right:0;width:100%;height:100%").set("* html .adform-adbox-page,* html .adform-adbox-fixed","position:absolute").set("* html .adform-adbox-fixed-L","left:expression(eval(__adform_adbox_fixedLeft(this)))").set("* html .adform-adbox-fixed-C",
"left:expression(eval(__adform_adbox_fixedCenter(this)))").set("* html .adform-adbox-fixed-R","left:expression(eval(__adform_adbox_fixedRight(this)))").set("* html .adform-adbox-fixed-T","top:expression(eval(__adform_adbox_fixedTop(this)))").set("* html .adform-adbox-fixed-M","top:expression(eval(__adform_adbox_fixedMiddle(this)))").set("* html .adform-adbox-fixed-B","top:expression(eval(__adform_adbox_fixedBottom(this)))").set("* html .adform-adbox-overlay","position:absolute;top:expression(eval(__adform_adbox_fixedTop(this)));left:expression(eval(__adform_adbox_fixedLeft(this)));width:100%;height:100%");
V&&"BackCompat"==b.compatMode&&c.set(".adform-adbox-page","position:absolute");a.__adform_adbox_fixedLeft=function(){return d.scrollLeft};a.__adform_adbox_fixedCenter=function(){return d.scrollLeft+Math.round(d.clientWidth/2)};a.__adform_adbox_fixedRight=function(e){return d.scrollLeft+d.clientWidth-e.offsetWidth};a.__adform_adbox_fixedTop=function(){return d.scrollTop};a.__adform_adbox_fixedMiddle=function(){return d.scrollTop+Math.round(d.clientHeight/2)};a.__adform_adbox_fixedBottom=function(e){return d.scrollTop+
d.clientHeight-e.offsetHeight};a.__adform_adbox_init=0}a.__adform_adbox_init++}function G(){var b=this.get();b.showing&&this.style({left:b.x+"px",top:b.y+"px"})}function T(b){var a=this.get(),d=a.vpos,c=a.hpos,e=a.width,h=a.height,k=a.y,g=a.x,l=("C"==c||"M"==d)&&{};a.showing&&(!b||"x"in b||"y"in b||"width"in b||"height"in b||"showing"in b)&&("C"==c&&(this._hp?l.left=50-parseFloat(e)/2+"%":(g-=e/2,l.left="")),"M"==d&&(this._vp?l.top=50-parseFloat(h)/2+"%":(k-=h/2,l.top="")),this.css("margin:"+k+"px "+
-g+"px "+-k+"px "+g+"px"),l&&this.style(l))}function Q(b){var a=this.get();var d=this._win;var c=this._doc;var e=a.element;var h=a.stickyOffset||0;if(a.showing&&(!b||"x"in b||"y"in b||"width"in b||"height"in b||"showing"in b||"stickyOffset"in b)){var k=this.from();var g=f.offsetFromWindow(k);!0===h&&(g.top=f.offset(k).top,h=g.top);var l=this._hp;var p=this._vp;b=a.x;var t=a.y;var n=l?e.offsetWidth:a.width||0;var v=p?e.offsetHeight:a.height||0;e=g.left;var B=g.top;g=k.offsetWidth;k=k.offsetHeight;
var C=d.innerWidth||c.body.clientWidth;var F=d.innerHeight||c.body.clientHeight;var A=a.vpos;var r=a.hpos;d="K"==r;c="C"==r;var u="R"==r;r="E"==r;var N="Y"==A;var m="M"==A;var x="B"==A;A="N"==A;l&&(n=C*parseFloat(a.width)/100,this.style({width:n+"px"}));p&&(v=F*parseFloat(a.height)/100,this.style({height:v+"px"}));a=t+B+(N?-v:m?(k-v)/2:x?k-v:A?k:0);this.setPosition(a>h?a:h,b+e+(d?-n:c?(g-n)/2:u?g-n:r?g:0),0,0)}}function P(b){var a=this.get();var d=this._win;var c=this._doc;var e=a.vpos;var h=a.hpos;
var k=a.x;var g=a.y;var l=a.element;var p=this._hp;var t=this._vp;var n=this._absolute;if(a.showing&&(!b||"x"in b||"y"in b||"width"in b||"height"in b||"showing"in b)){b=p?l.offsetWidth:a.width;l=t?l.offsetHeight:a.height;var v="K"==h;var B="C"==h;t="R"==h;var C="E"==h;var F="Y"==e;var A="M"==e;h="B"==e;e="N"==e;if(null==n){if(n="absolute"==f.curCSS(a.element,"position"))f.removeEvent(d,"resize",this.handleResize),f.removeEvent(d,"scroll",this.handleResize);this._absolute=n}if(n)g=Math.round(A?-(l/
2):0)+g,b=Math.round(B?-(b/2):0)+k,this.setPosition(null,null,h?0:g,t?0:b,h?-g:0,t?-b:0);else{n=c.documentElement;var r=c.body;c=n&&n.clientHeight||r&&r.clientHeight;var u=Math.max(n&&n.scrollWidth||0,r&&r.scrollWidth||0);var N=Math.max(n&&n.scrollLeft||0,r&&r.scrollLeft||0);d=Math.max(n&&n.scrollTop||0,r&&r.scrollTop||0);p&&(p=Math.max(n&&n.clientWidth||0,r&&r.clientWidth||0),b=Math.round(u*parseFloat(a.width)/100),this.style({width:f.isFF&&p>=u?a.width:b+"px"}));k=-N+(v?-b:B?(u-b)/2:t?u-b:C?u:0)+
k;g=-d+(F?-l:A?(c-l)/2:h?c-l:e?c:0)+g;a=this._pp||(this._pp={t:0,l:0});(a.t>-l&&a.l>-b||g>-l&&k>-b)&&this.setPosition(g,k,0,0);a.t=g;a.l=k}}}function oa(){var b=this.get();var a=this._lastFromPos;if(b.showing&&(b=this.from())){var d=f.offset(b);d.w=b.offsetWidth;d.h=b.offsetHeight;a&&a.left==d.left&&a.top==d.top&&a.w==d.w&&a.h==d.h||(this._lastFromPos=d,L.call(this))}}function L(b){var a;var d=this.get();var c=d.element;var e={};if(!b||"x"in b||"y"in b||"width"in b||"height"in b||"showing"in b)if(d.showing){if(a=
this.from()){b=d.vpos;var h=d.hpos;var k=this._hp;var g=this._vp;k&&(e.width=Math.round(a.offsetWidth*parseFloat(d.width)/100)+"px");g&&(e.height=Math.round(a.offsetHeight*parseFloat(d.height)/100)+"px");(k||g)&&this.style(e);e=d.x;var l=d.y;k=k?c.offsetWidth:d.width;d=g?c.offsetHeight:d.height;g=f.offset(a);c=c.parentNode;"static"!=f.curCSS(c,"position")&&(c=f.offset(c),g.top-=c.top,g.left-=c.left);c=g.left;g=g.top;var p=a.offsetWidth;a=a.offsetHeight;l=Math.round("M"==b?-(d/2):0)+l;e=Math.round("C"==
h?-(k/2):0)+e;this.setPosition(g+("Y"==b?-d:"M"==b?a/2:"B"==b?a-d:"N"==b?a:0),c+("K"==h?-k:"C"==h?p/2:"R"==h?p-k:"E"==h?p:0),l,e)}}else this.setPosition(-3E3,-3E3,0,0)}function ea(b){var a=this.get(),d=a.width;a=a.height;if("mobile"!=this.positionType&&("width"in b||"height"in b)){b=this._hp="string"==typeof d&&0<d.indexOf("%");var c=this._vp="string"==typeof a&&0<a.indexOf("%");this.style({width:"auto"===d?d:b?d:d+"px",height:"auto"===a?a:c?a:a+"px"})}}function X(){var b=this,a=b.get(),d=a.visible,
c=a.element;a=b._visibilityTimer;if(c){a&&(a=ra(a));var e=function(){var h=c.className,k=~h.indexOf(" adform-adbox-hidden");b._visibilityTimer=!1;k&&d?c.className=h.replace(" adform-adbox-hidden",""):k||d||(c.className=h+" adform-adbox-hidden")};c.addEventListener&&!V?a=E(e,d?10:100):e();b._visibilityTimer=a}b.set("showing",d&&!!c)}function sa(b){this.emit("content:"+(b?"show":"hide"),this.get("element"),this);this.emit(b?"show":"hide")}var H=z.window,M=H.clearInterval,ra=H.clearTimeout,E=H.setTimeout,
U=H.setInterval,V=f.isIOS,la=V&&!f.isIOSF,S=/Y|T|M|B|N/,R=/K|L|C|R|E|I/;q.LEFT_OUT="K";q.LEFT="L";q.CENTER="C";q.RIGHT="R";q.RIGHT_OUT="E";q.TOP_OUT="Y";q.TOP="T";q.MIDDLE="M";q.BOTTOM="B";q.BOTTOM_OUT="N";q.INLINE="I";q.CLASS="adform-adbox";q.PREFIX="adform-adbox-";q.hPosRegExp=R;q.vPosRegExp=S;q.fTimeout=1E4;q.toCustom=function(b,a,d){var c=R.exec(d);d=S.exec(d);var e=a.x,h=a.y,k=a.width;a=a.height;var g=b.width;b=b.height;c=c?c[0]:"L";d=d?d[0]:"T";return{x:("K"==c?-k:"C"==c?(g-k)/2:"R"==c?g-k:
"E"==c?g:0)+e,y:("Y"==d?-a:"M"==d?(b-a)/2:"B"==d?b-a:"N"==d?b:0)+h}};f.inherit(q,ba);z=q.prototype;z.css=function(b,a){var d,c=this.sheet,e=this.cssQueue;if(c){if(e){this.cssQueue=null;var h=0;for(d=e.length;h<d;h+=2)this.css(e[h],e[h+1])}c.set("#"+this.id+(a?" "+b:""),a||b)}else e.push(b,a);return this};z.content=function(b,a,d){var c=this._contents;if(c)return d||"string"!=typeof a||(d=a,a=!1),d=d||"main",b&&(c[d]=b,b.bind(this),a&&(b=b.data,this.set({width:b.width,height:b.height}))),c[d]};z.setPosition=
function(b,a,d,c,e,h,k,g){var l,p,t=this.get("element"),n=this.pos||{};b={top:b,left:a,marginTop:d,marginRight:h,marginBottom:e,marginLeft:c,width:k,height:g};if(t){for(l in b)b[l]!=n[l]&&(p||(p={}),p[l]=b[l]+"px");p&&(this.pos=b,this.style(p))}};z.from=function(){var b,a=this.get("frompos");"string"==typeof a&&(a=f.byId(a,this._doc))&&("OBJECT"==a.nodeName&&30>a.offsetHeight&&(b=f.byTag(a,"embed")[0])&&20<b.offsetHeight&&(a=b),this.set("frompos",a));if(a&&(!a._contents||(a=a.get("element"))))return a};
z.style=function(b){var a=this.get("element"),d=this._styles;a?(d&&(f.extend(a.style,d),d=null),b&&f.extend(a.style,b)):d=f.extend(d||{},b);this._styles=d;return this};z.reset=Y;z.destroy=function(){var b,a,d=this.get("element"),c=this.get("frame"),e=this._win,h=this._doc;d&&(this.emit("content:destroy",d,this),this.clear(),this._contents=null,W.off(c||d,"hover",this.handleHover),f.removeEvent(d,"mousedown",this.handleClick),this.resetPosition&&this.resetPosition(),(b=this.handleResize)&&f.removeEvent(e,
"resize",b),(a=this._fromInt)&&M(a),--e.__adform_adbox_init||(O("adbox-static",h).destroy(),this.sheet.destroy(),e.__adform_adbox_fixedLeft=e.__adform_adbox_fixedCenter=e.__adform_adbox_fixedRight=e.__adform_adbox_fixedTop=e.__adform_adbox_fixedMiddle=e.__adform_adbox_fixedBottom=null),this.sheet=null,this._changes={},this._previous={},this._attributes={},d.parentNode&&d.parentNode.removeChild(d))};z.draw=function(b,a){var d;a=a||{};(d=this._hub)&&d.emit("draw",this,this._hubName,a);this.set("frame",
a.frame);d=a.container;var c=a.before;var e=a.from;b=d&&d.ownerDocument||c&&c.ownerDocument||e&&(e.ownerDocument||e._doc||(e.defaultView||e.parentWindow||e).document)||b;qa.call(this,b);Y.call(this,a);d=a;c=d.from;e=d.container;var h=d.before,k=this.get();var g=k.postype;var l=this._doc,p='<div id="'+this.id+'" class="adform-adbox '+(k.visible?"":"adform-adbox-hidden ")+"adform-adbox-"+g+" adform-adbox-"+g+"-"+k.vpos+" adform-adbox-"+g+"-"+k.hpos+'">AdBox</div>';if(c||h||e){try{l.body||l.write("<html><body></body></html>")}catch(t){}if(l.body.insertAdjacentHTML&&
f.isIE){g="afterBegin";c?(e||(e=l.body),"end"==h&&(g="beforeEnd")):h&&(g="beforeBegin",e=h);try{e.insertAdjacentHTML(g,p)}catch(t){l.write(p)}}else c?(e||(e=l.body),h=null):h&&(e=h.parentNode),e.insertBefore(f.html(p,l),h||e.firstChild)}else l.write(p);this.set({x:d.x||k.x||0,y:d.y||k.y||0});this.onchange("showing",sa);this.findElement();return this};z.pull=function(b,a){var d=this.get();if(b in d)a.call(this,d[b]);else this.once("change:"+b,a);return this};z.publish=function(b,a){this._hubName=b;
this._hub=a;this.pull("element",ha);return this};return aa.RMB.AdBox=q});
a(s,[c,j,r,i,n],function(T,H,U,I,w){function J(a,b,c){var d={};a=a.replace(/[\r\n]+/g,b).split(b);var e=a.length;for(b=0;b<e;b++){var g=a[b].split(c);var m=g.shift();g=g.join(c);d[m]=g?"true"===g||"false"===g?"true"===g:1*g==g?1*g:g:null}return d}function B(a){var b=a.options,c=a.panel.from;if({standard:1,expanding:1,singleExpanding:1}[b.type]&&"floating"!=b.behavior)if("number"==typeof c)var d=V(a);else"string"==typeof c?(b=w.byId(a.panel.from,(a.options.iab?
t.parent:t).document))?(C(a,{container:b},!0),d=void 0):d=!0:(C(a,{before:a.options.iab?t.frameElement:a.options.$tag},!0),d=void 0);else K.AdConstructor.initialize(a);d?(z.push(a),D||(D=L(W,100))):z.length&&B(z.shift())}function V(a){var b=E[a.options.bn+"#"+a.panel.from];if(!b||!b.box)return!0;var c=a.panel,d=F(c.position,!0),e=b.settings,g=e.image||e.html||e.video||e.flash;e=(e=e.panel)&&e.space;var m;e&&g&&"C"!=d&&(m=e.width>>0)&&(m=.5*(m-g.width),c.x=(c.x||0)+("L"==d?-1:1)*m);b.box.pull("element",
function(){C(a,{from:b.box})})}function W(){D=0;z.length&&B(z.shift())}function C(a,b,c){function d(n){var u=l?"stickyBox":"box";r=A[u]=(new I).publish("panel-"+u,a.events);M&&r.set("zIndex",h.zIndex=M);r.set({width:N,height:p?O:"auto",x:!l&&f.x||0,y:!l&&f.y||0,visible:!f.hidden}).set(v?{stickyOffset:f.sticky}:{}).pull("element",e).draw(x,{type:v&&"sticky",position:l?"":F(f.position,c),container:G,before:P,from:n||b.from})}function e(n){var u={item:A,settings:a,content:q};n.innerHTML="<span></span>";
h.iab=!1;h.window=y;h.$tag=n.firstChild;n=u.exports={set:w.bind(u,Q),get:w.bind(u,X)};h.panel=n;u.constructor=k=K.AdConstructor.initialize(a);k._panel_show=k.show;k._panel_hide=k.hide;k.show=g;k.hide=m}function g(){var n=b.from;n&&n.pull&&!n.get("visible")?L(g,100):(l&&l.set("visible",!0),r.set("visible",!0),k._panel_show())}function m(){k._panel_hide();r.set("visible",!1);l&&l.set("visible",!1)}var r,l,k,q=a.image||a.html||a.flash,h=a.options,f=a.panel,y=h.iab?t.parent:t,x=y.document,A=E[h.bn+"#"+
h.seqNo],p=!!b.from,v="sticky"in f&&!1!==f.sticky,G=b.container,P=b.before,M="z"in f?f.z:v||p?1E4:null,N=q.width,O=q.height;h.hidden?f.hidden=h.hidden:f.hidden&&(h.hidden=f.hidden);v&&!p?(G=P=null,(l=A.box=new I).publish("panel-box",a.events).set({width:N,height:O,visible:!f.hidden,x:f.x||0,y:f.y||0}).pull("element",d).draw(x,{position:F(f.position,c),before:b.before,container:b.container})):d()}function Q(a,b){var c=this.item,d=c.box;c=c.stickyBox;a=R[a]||a;if("string"!==typeof a)for(b in a)Q.call(this,
b,a[b]);else"zIndex"==a?((c||d).set(a,b),this.constructor.setZIndex&&this.constructor.setZIndex(b)):c&&"stickyOffset"==a?c.set(a,b):d.set(a,b);c&&c.repositionSticky()}function X(a){var b=this.item,c=b.box;a=R[a]||a;if("width"==a||"height"==a)a=this.content[a];else{if("zIndex"==a||"stickyOffset"==a)c=b.stickyBox||c;a=c.get(a)}return a}function F(a,b){var c;a=(a||"").toLowerCase();var d={r:"E",ri:"R",l:"K",li:"L"}[(c=a.match(/[rl]i?/))&&c[0]]||"C",e={t:"Y",ti:"T",b:"N",bi:"B"}[(c=a.match(/[tb]i?/))&&
c[0]]||"M";return b?{E:"R",K:"L"}[d]||d:d+e}var t=T.window,L=t.setTimeout,K=H.RMB,z=[],D,E={},S={},R={z:"zIndex",sticky:"stickyOffset"};return function(a){var b=H.ADFUtilInstance,c=a.options,d=c.bn;if(b&&b.getPropByBn){var e=a.panel,g=a.events,m=c.seqNo,r=1==m;var l=S[d];if(!l)for(var k=w.byTag("script"),q=k.length,h,f;0<q--;)if(h=k[q],(f=h.getAttribute("data-panels"))&&h.src&&~h.src.indexOf("?bn="+d)){k=void 0;var y=J(f,";","="),x={length:0},A={w:"width",h:"height",pos:"position",p:"position",f:"from",
s:"sticky"};for(k in y)if(k){h=y[k]?J(y[k],",",":"):{};q={};for(var p in h)p&&(f=A[p]||p,q[f]="hidden"==f||null===h[p]||h[p]);x["#"+k]=q;x.length++}f=x;f.length&&(l=S[d]=f);break}try{var v=t.frameElement}catch(G){}l&&(r&&!b.getPropByBn("syncMembersCount",d)&&b.addBannerAttribute(c.xId,"syncMembersCount",l.length),l=l["#"+m])&&(e=a.panel=w.extend(e||{},l));e&&(c.iab&&v&&(v.style.display="none"),E[d+"#"+m]={settings:a},r&&(e.id=e.id||"top"),e.id&&(g.clear("setup"),b=e.id,c=a.options,d=a.panel,e={options:{iab:c.iab},
events:a.events},U.applyHooks(e,["#"+b,c.bn+"#"+b]),e.panel&&(d?w.extend(d,e.panel):a.panel=e.panel),g.emit("setup",a)),a.preventInitialization=!0,B(a))}}});
a(t,function(){return function(b){if(b.videoSources&&b.streamingVideo&&0<b.clicktags.indexOf("&detectBW=true")){for(var e=b.videoSources,k=e[0].file.replace(/^[^:]+:\/\/[^\/]+|[^\/]+$/g,""),c={},a,f=0,l=e.length,h,d,g;f<l;f++)if(e[f]&&(h=e[f].file)&&0<=h.indexOf(k)&&(d=h.match(/([^\/]+?)(\d+)\.f[l4]v$/))){g=c[d[1]]||[];g.push(d[2]);if(!a||c[a].length<=g.length)a=d[1];c[d[1]]=g}a&&(c[a].sort(function(m,n){return m-n}),b.clicktags+="&streamBaseName="+encodeURIComponent(a)+"&streamBitrates="+c[a].join(","))}}});
a(w,[c,b,j,n,q],function(y,C,D,r,E){var t=y.window,z=t.setTimeout,F=t.clearTimeout,G=Array.prototype.slice;D.PAGE_LOAD_COMPLETE="pageLoadComplete";return{polite:function(a){function c(){d||(d=!0,this!=a&&a.emit("pageLoadComplete"))}function k(){d?(e=!1,a.callSwfMethod("pageLoadComplete")):e||(e=!0,a.once("pageLoadComplete",k))}var d,e,g=a.options.loadDelay;if(g)z(c,1E3*g);else r.onload(t,c);a.on("pageLoadComplete",c);a.on("politeReady",k)},
inscreen:function(a,c){function k(l){var n=new Date,f=n-e;l=r.extend(b||{},l);f>=c?(e=n,b={},a.callSwfMethod("updateInScreen",l),g&&(g=F(g))):g||(g=z(function(){k(l)},c-f))}var d,e,g,b;c=c||0;a.on("initInScreen",function(){e=0;d||(d=E(a.options.xId),d.on("change",k));k({visible:d.get("visible"),percent:d.get("percent"),loaded:d.get("loaded")})})},setCallbacks:function(a,c){function k(f,h,m,p,u){b(f,{x:parseInt(h,10)+g.x,y:parseInt(m,10)+g.y,width:parseInt(p,10),height:parseInt(u,10)})}function d(f){b(f);
t.IABcloseAD&&t.IABcloseAD()}for(var e=a.win,g={x:0,y:0},b=r.bind(a,a.emit),l=[["initPoliteMode",b,"politeReady"],["initVideoMode","video",!0],["initCube3D","cube3D",!0],["initExtender",b,"extender"],["initInScreen",b,"initInScreen"],["startDrag",b,"startDrag"],["endDrag",k,"endDrag"],["updateBox",k,"updateBox"],["expandComplete",b,"expandComplete"],["collapseComplete",b,"collapseComplete"],["close",d,"hide"],["superClose",d,"close"],["expand",b,"show"],["rollOutAd",b,"rollOut"],["videoPlayStartHandler",
b,"video:start"],["videoCompleteHandler",b,"video:end"]],n=l.length;0<n--;)(function(f,h,m){function p(){var v=G.call(arguments);"undefined"!==typeof m&&v.unshift(m);h.apply(a,v)}function u(){a[h]=m}c[f]="function"==typeof h?p:u}).apply(a,l[n]);c.initScroll=function(){var f=a.options.iab?e.parent:e;r.addEvent(f,"scroll",function(){r.removeEvent(f,"scroll",arguments.callee);a.callSwfMethod("scroll")})};c.initSingleExpanding=function(f,h){b("expandSettings",g={x:-parseInt(f,10),y:-parseInt(h,10)})};
c.toggleFullScreen=function(f){b("fullScreen","true"==""+f)}},factory:function(a,c,k){var d=[],e=[],g=c.flash,b=c.html,l=c.video,n=c.image,f=c.polite,h=c.options,m="Standard"==a,p=g&&g.version<=C.flashVersion;a=m&&b&&!p;var u=m&&l&&!p&&!b,v=m&&(n&&!p&&!b||f);m&&p&&(e[0]=d.push("contents/FlashTag"));a&&(e[1]=d.push("contents/HTML"));u&&(e[2]=d.push("contents/VideoTag"));v&&(e[3]=d.push("contents/ImageTag"));y.require(d,function(){var A,q=arguments,H=q[e[0]-1],I=q[e[1]-1],B=q[e[2]-1];q=q[e[3]-1];if(m){if(p){var w=
new H(h,g);var x=!0}else b?(w=new I(h,b),x=!g):l&&B.supported(l.sources)?w=new B(h,l):n&&(w=new q(h,n),x=!g&&!b);f&&(A=new q(h,f))}c.$c={h:!!x,c:w,ec:void 0,pc:A};k(c)});k}}});
a(y,[j,z,q,n,w],function(d,m,n,e,p){function g(a,b){var c;a.xId&&(c=n(a.xId));g.super_.call(this);this.created=0;this.options=a;this.data=b;this.container=e.bind(this,this.container);this.show=e.bind(this,this.show);this.hide=e.bind(this,this.hide);this.clear=e.bind(this,this.clear);this.reload=e.bind(this,this.reload);if(c)this.on("loaded",function(){c.set("loaded",!0)}).on("video:end",function(){c.engage("videoStop")});
b.adNotice&&"window"!=b.wmode&&this.setupExtra(this.adNotice=new h.AdNotice(a,b));p.polite(this)}function k(){}var h=d.RMB.Content;d.RMB.AdContent=g;e.inherit(g,m);d=g.prototype;d.container=function(a){var b=this.doc=a.ownerDocument;this.win=b.defaultView||b.parentWindow;this._element=a};d.show=k;d.hide=k;d.reload=function(){this instanceof h.AdNotice||(this.destroy(),this._adbox.get("showing")&&this.show())};d.destroy=k;d.element=function(a,b){var c=this._elem,f=!(this instanceof h.AdNotice)&&this.options.wrapper;
f&&(f=e.html(f,b&&b.ownerDocument));!1!==b?(c||(c=e.html('<div style="position:relative;width:100%;height:100%;overflow:hidden">',b&&b.ownerDocument)),c&&(b&&(f&&(f.appendChild(c),this.wrapper=f),b.appendChild(f||c)),"string"==typeof a&&(c.innerHTML=a))):c&&(c.parentNode&&c.parentNode.removeChild(c),c=null);return this._elem=c};d.bind=function(a){var b;this._adbox||(this._adbox=a,a.on("change:element",this.container),a.on("content:show",this.show),a.on("content:hide",this.hide),a.on("content:destroy",
this.clear),a.on("content:reload",this.reload),(b=a.get("element"))&&this.container(b),a.get("showing")&&this.show())};d._clear=d.clear;d.clear=function(){var a=this._adbox;a&&(a.off("change:element",this.container),a.off("content:show",this.show),a.off("content:hide",this.hide),a.off("content:destroy",this.clear),a.off("content:reload",this.reload),this.destroy(),this._clear(),this._adbox=this.doc=this.win=this._element=null)};d.style=function(a){var b=this.element();b&&e.extend(b.style,a);return this};
d.setupExtra=function(a){var b=this,c=b.bind,f=b.clear;b.bind=function(l){var q=c.call(b,l);a.bind(l);return q};b.clear=function(){a.clear(b._adbox);return f.call(b)}};return g});
a(u,[c,j,y,m,n,l],function(n,e,r,t,m,u){function h(a,c){h.super_.call(this,a,c.adNotice);var b=this.data;b.width=c.width;b.height=c.height;this.id=m.gid("adform-adnotice-button-");this.base=a.scriptsBase+"assets/images/OBA/"}n=n.window.navigator;var q={},v=n.userLanguage||n.language||"";e.RMB.Content.AdNotice=h;m.inherit(h,r);h.supported=function(){return!0};h.READY="ready";e=h.prototype;e.show=function(){this._element&&!this.created&&
this.write()};e.write=function(){var a=this,c=a._element,b=a.doc,f=a.win,g=a.statics=t("adbox-static",b),d=a.options,k=d.obaId,l=d.scriptsBase+"adplayer/css/adplayer.min.css",w=d.scriptsBase+"adplayer/js/adplayer.min.js";a.created=(new Date).getTime();g.adNoticeStyles||(g.adNoticeStyles=!0,g.set(".adform-adnotice","z-index:1;position:absolute!important;top:0!important;right:0!important;left:auto!important;padding:0!important;margin:0!important"));a._elem=m.html('<div class="adform-adnotice" id="'+
a.id+'">',b);k?f.$ADP?a.setupAdPlayer(k,c):(m.loadCSS(b,l),m.loadScript(b,w,function(p){p||!f.$ADP?a.setupDefault(c):a.setupAdPlayer(k,c)})):a.setupDefault(c);u.on(a._elem,"hover",function(p){d.disturber.emit("hover","hoverin"==p)})};e.destroy=function(){this.element("",!1);this.created=0};e.getOBAImage=function(a){a=a.toLowerCase().match(/^(bg|cs|da|de-at|de-ch|de|el|es|fi|fr-be|fr-ch|fr|ga|hu|it-ch|it|nl-be|nl|no|pl|ro|sk|sv|uk|en)/);a=(a&&a[0]||"en")+".png";return this.base+a};e.setupAdPlayer=
function(a,c){var b=this.win,f=b.$ADP.Registry,g=this.id,d=this.data,k=this.options,l=[{title:d.title,text:d.text,url:d.link,linkText:d.linkText,usePopup:!!(b.Adform&&b.Adform.ADFIframe||k.iab)}];this.element("",c);if(!q[a]){b.ADFCall(k.xId,function(){this.emit("setupADP",l)});if(l)for(b=0,d=l.length;b<d;++b)f.register(a,l[b]);q[a]=!0}f.createPlayer(a,{domId:g});this.emit("ready")};e.setupDefault=function(a){var c=this.data,b=this.id,f=this.statics,g=105<=c.width&&.1>1575/(c.width*c.height);f.set(".adform-adnotice a",
"display:block;width:19px;height:15px;margin:0!important;padding:0!important;position:static!important;background:url("+this.base+"oba.png) no-repeat;").set(".adform-adnotice img","display:none;border:none;margin:0!important;padding:0!important;position:static!important");g&&f.set("#"+b+" a:hover","width:auto;position:absolute;top:0;right:0;background-position:0 -100px").set("#"+b+" a:hover img","display:block;");this.element('<a href="'+c.link+'" target="_blank">'+(g?'<img src="'+this.getOBAImage(v)+
'" alt="">':"")+"</a>",a);this.emit("ready")};return h});
a(v,[n,y],function(g,h){function e(){return{create:e,register:function(b){for(var a in b)b[a]&&"function"==typeof b[a].content&&f(b[a]);b.on("draw",function(d){f(d)})}}}function f(b){var a=b.content(),d=b.content(null,"click");a&&!d&&(a=a.data.link||a.flashvars&&a.flashvars.clickTAG)&&(0>a.indexOf("://")&&(a=decodeURIComponent(a)),a=~a.indexOf(";CREFURL")?a.split(";CREFURL").join(";fc=1;CREFURL"):a.replace(/bn=\d+/,"$&;fc=1"),b.content(new c({},{link:a}),!1,"click"))}function c(b,
a){c.super_.call(this,b,a)}g.inherit(c,h);c.prototype.show=function(){var b=this._element;!this.created&&b&&(this.created=new Date,this.element('<a href="'+this.data.link+'" style="width:1px;height:1px;display:block;border:0;"></a>',b),this.style({top:0,left:0,position:"absolute",zIndex:-1}))};return e()});
a(p,[c,j,q,r,s,l,m,t,n,u,v,w,x],function(p,m,C,x,D,E,F,G,g,H,I,J,K){function q(a){var b=this.options=a.options,c=n,d=a.events,e=this.adDestroy=g.bind(this,y);this.settings=a;b.BANNER_TYPE=this.BANNER_TYPE;b.iab?(c=L,b.iframe=n.frameElement):b.window&&(c=b.window);this.win=c;a=c.Function;a("a","a=a.Adform=a.Adform||{};a.adRegister=a.adRegister||{}")(c);
m.adRegister=c.Adform.adRegister;z.call(this);(this._wallpaper=b.wallpaper&&b.wallpaper.background&&!g.isTMX(c))&&this.setupWallpaper();this.on=function(){d.on.apply(d,arguments);return this};this.off=function(){d.off.apply(d,arguments);return this};this.once=function(){d.once.apply(d,arguments);return this};this.emit=function(){var f=this._events;this._events=d._events;d.emit.apply(this,arguments);this._events=f;return this};this._clearEvents=function(f){d.clear(f)};a("a",'function b(b,c){var h=[].slice,g=a.Adform.adRegister;if(g[b]){var f=[g[b]];if(!/x|#/.test(b))for(var l in g)f[0]==g[l]||l.indexOf(b)||f.push(g[l]);g=arguments;g=2<g.length?h.call(g,2):!1;for(h=0;h<f.length;h++){l=f[h];var r="string"==typeof c?l[c]:c;"function"==typeof r&&(g?r.apply(l,g):r.call(l))}}}var c=a.setTimeout;a.ADFReload=function(a){c(function(){b(a||"1x","reload")},0)};a.ADFcall=a.ADFCall=b')(c);
n.ADFReload=c.ADFReload;n.ADFcall=n.ADFCall=c.ADFCall;g.addEvent(n,"unload",e);c!=n&&(a("a",'var b=a.Adform;b.Events=b.Events||{sendEvent:function(c,b,e,f,g){a.ADFCall(c,"sendEvent",b,e,f,g)}}')(c),g.isOpera||9>g.ieVersion)&&(c.Adform&&c.Adform.trackIframe||a("a","function c(){for(var a=e.length;a--;)e[a][0].parentNode||(e[a][1](),e.splice(a,1));e.length||(b=g(b))}var b,d=a.Adform=a.Adform||{},e=[],f=a.setInterval,g=a.clearInterval;d.trackIframe=function(a,d){e.push([a,d]);b||(b=f(c,200))}")(c),c.Adform.trackIframe(b.iframe,
e));try{I.register(this)}catch(f){p.log("fctest",f,1)}}function y(){var a=this.options.xId,b=this.getUtils();g.removeEvent(n,"unload",arguments.callee);this.emit("destroy");this.destroy&&this.destroy();E.destroy();z.call(this,!0);this._clearEvents();this._wallpaper&&(this.toggleWallpaper(),delete this._wallpaper);b&&b.wipeOutBanner&&b.wipeOutBanner(a);this.settings=this.options=null}function z(a){var b=this.options,c=b.bn,d=b.xId;b=b.seqNo;b=c+(b?"#"+b:"");var e=m.adRegister,f=this.win.Adform.adRegister;
a?(delete e[b],delete e[c],delete e[d],delete f[b],delete f[c],delete f[d]):e[b]=e[c]=e[d]=f[b]=f[c]=f[d]=this}function A(a){function b(){}var c=a.options,d=v[c.type],e=u.Type[d];g.inherit(b,e);var f=new b;J.factory(d,a,function(){var h=c.csImpressionUrl;try{e.call(f,a),f.emit("init",a)}catch(r){p.rethrow(r,"init")}h&&K(h)});return f}function w(a){function b(){a._beforeScript=!1;w(a)}var c=a._beforeScript,d=v[a.options.type];if(u.Type[d])if(c)M(b,0);else{x.applyHooks(a);try{a.events.emit("setup",
a),D(a)}catch(e){p.rethrow(e,"setup")}a.preventInitialization||A(a)}else p.require(["types/"+d],b)}function N(a,b){if(this._hovered!=a&&(this._hovered=a,this.interacted=!0,a?this._eventDelay(this,this.sendEvent,"141",b.content().assetId,"Mouse Over on Banner"):this._eventDelay(),this.onEngage))this.onEngage()}var n=p.window,L=n.parent,M=n.setTimeout,u=m.RMB,v={expanding:"Expanding",tearback:"Expanding",floating:"Floating",standard:"Standard",singleExpanding:"SingleExpanding",interstitial:"Interstitial",
slider:"Slider"},k=q.prototype;H.supported();q.build=u.AdConstructor.build;q.cbuild=function(a){G(a);var b=x.getData(a),c=b&&b.options;c&&(C.load(c.unloadVersion,b),b._beforeScript=a._beforeScript,w(b))};q.ibuild=w;q.initialize=A;k.BANNER_TYPE="";k.setupUtils=function(a,b){var c=this.getUtils(),d=this.options.xId;c&&("string"==typeof a&&(a=[a]),c.addBannerAttribute(d,"relativeTargetSWFID",a[0]),c.addBannerAttribute(d,"trackElements",a),b&&c.addBannerAttribute(d,"trackHeatMap",b))};k.setupEngagement=
function(a){var b=this,c=g.singleCall(0),d=0;b._eventDelay=g.singleCall(1E3);b._hovered=!1;for(a.length||(a=[a]);d<a.length;d++)a[d].on("hover",function(e,f){c(b,N,e,f)})};k.sendEvent=function(a,b,c,d){return m.Events&&m.Events.sendEvent?(m.Events.sendEvent(this.options.xId,a,b,c,d||"",this.BANNER_TYPE),!0):!1};k.getUtils=function(){var a=m.ADFBannerUtils;if(a&&a.getInstance)return a.getInstance()};k.setupWallpaper=function(){var a=this.options,b=a.wallpaper,c=this.win.document,d=b.cssClass="adform-wallpaper-"+
a.bn,e=b.element||"";e="html"==e?"":e.indexOf("#")?c.documentElement?" body":"":" "+e;b.target=a.landingPageTarget;F("adform-wallpaper",c).set("."+d+e,"background: "+b.background);("undefined"==typeof b.autoShow||b.autoShow)&&this.toggleWallpaper(!0)};k.toggleWallpaper=function(a){function b(l){var B=(l=l||e.event,l.target||l.srcElement);return t?B.id==t:/^(html|body)$/i.test(B.nodeName)}function c(l){r.style.cursor=b(l)?"pointer":""}var d,e=this.win,f=this.options.wallpaper;if(this._wallpaper){"string"==
typeof a&&(a="true"==a);try{var h=e.document,r=h.documentElement||h.body;(d=e.__adform_wallpaper)&&(a||d.cssClass==f.cssClass)&&(e.__adform_wallpaper=null,r.style.cursor="",g.removeClass(r,d.cssClass),d.link&&(g.removeEvent(h,"mousemove",d._move),g.removeEvent(h,"mouseover",d._cursor),g.removeEvent(h,"click",d._click)));if(a&&(e.__adform_wallpaper=f,g.addClass(r,f.cssClass),f.link)){var t=(t=f.element)&&!t.indexOf("#")?t.slice(1):"";g.addEvent(h,"mousemove",f._move=function(l){g.removeEvent(h,"mousemove",
arguments.callee);c(l)});g.addEvent(h,"mouseover",f._cursor=c);g.addEvent(h,"click",f._click=function(l){b(l)&&e.open(f.link,f.target)})}}catch(l){}}};k.setupGateway=function(a,b){var c=this,d=c.options,e=c.getUtils();if(a.get("element"))m.Wallpaper&&m.Wallpaper.setup&&!a.get("frompos")&&(p.log("legacy_wallpaper",d.bn),m.Wallpaper.setup({bn:d.bn,utils:e&&e.banners&&e.banners[d.xId],element:a.get("element"),width:a.get("width"),height:a.get("height"),callback:b}));else a.onchange("element",function(){a.off("change:element",
arguments.callee);c.setupGateway(a,b)})};k.adDestroy=y;k.reload=function(){this.adBox&&this.adBox.emit("content:reload")};k.setZIndex=function(a){var b=this.options,c=v[b.type],d="adBox collapsed expanded wallpaper container overlay".split(" "),e=d.length;a=parseInt(a,10);if(!isNaN(a))for(this.zIndex=a;e--;){var f=d[e],h=this[f];!h||"container"==f&&"floating"!=b.behavior||"collapsed"==f&&"SingleExpanding"==c||h.set("zIndex","expanded"==f&&"Expanding"==c?a+1:"overlay"==f?a-1:a)}};return u.AdConstructor=
q});
a(Y,[j,y,n],function(m,d,e){function c(a,b){c.super_.call(this,a,b);this.created=!1;this.data=b;this.adId=e.gid("Adform");this.data.id=this.id="ad"+this.adId;this.assetId=b.assetId||0}var g=e.addEvent,h=e.byTag;e.inherit(c,d);c.supported=function(){return!0};c.READY="ready";c.LOADED="loaded";c.HIDE="hide";d=c.prototype;d.show=function(){this._element&&!this.created&&this.write()};d.write=function(){var a=this;var b=a.data;var n=a._element,k=a.options,l=b.useClose,f=
'<img src="'+b.src+'" border="0" id="'+b.id+'" class="'+(a.className||"")+'" width="'+b.width+'" height="'+b.height+'" alt="" style="cursor:pointer" />';b.link&&(f='<a href="'+b.link+'" target="'+k.landingPageTarget+'" style="width:100%;height:100%;display:block" attributionsrc>'+f+"</a>");l&&(f+='<img src="'+k.scriptsBase+'assets/images/close-sprite.png" style="width:50px!important;height:50px!important;position:absolute!important;top:0!important;right:0!important;padding:0!important;margin:0!important;cursor:pointer;">');
a.element(f,n);b=h(a._elem,"img");g(b[0],"load",function(){a.emit("loaded")});l&&g(b[1],"click",function(){a.emit("hide",!0)});a.created=!0;a.emit("ready")};d.destroy=function(){var a;this._elem&&(a=h(this._elem,"img")[0])&&(a.src=a.src,this.className=a.className);this.element("",!1);this.created=!1};return m.RMB.Content.ImageTag=c});
a(Da,[c,j,i,p,n],function(e,q,r,t,n){function m(a){var b=this,c=a.options,h=a.$c,f=h.c,g=h.pc;h=h.h;var k=c.iab&&p.frameElement;m.super_.call(b,a);if(f){var d=b.adBox=(new r).publish("adBox",b);c.hidden&&b.hide();g?(g.style({position:"absolute",top:0,left:0,zIndex:1}),d.content(g,!0),g.once("pageLoadComplete",function(){d.content(f);f.once("loaded",n.bind(g,g.clear))})):d.content(f,!0);b.onEngage=function(){b.onEngage=null;d.content().emit("pageLoadComplete")};
b.setupEngagement(d);a=f.data;if(k&&!1!==c.iabResize){var l=k.style;l.width=a.width+"px";l.height=a.height+"px"}l=c.iframeAPI;l.hasAPI&&l.register(a);a={position:c.position};c.$tag&&(a.before=c.$tag);k&&c.responsive&&(a.before=k,k.style.display="none");d.draw(u,a);b.setupUtils(d.id,h?f.id:null);b.setupGateway(d)}}var p=e.window,u=p.document;n.inherit(m,t);e=m.prototype;e.BANNER_TYPE="Standard Banner";e.destroy=function(){this.adBox&&this.adBox.destroy();this.adBox=null};e.show=function(){this._hidden&&
(this._hidden=!1,this.adBox.set("visible",!0))};e.hide=function(){this._hidden||(this._hidden=!0,this.adBox.set("visible",!1),this.reload())};return q.RMB.Type.Standard=m});
a(f,function(){return"vfC---ZF8Eo3BA"});
})(_adfq.define,"common/lib","$boot","Adform","engagement/Timer","engagement/ActiveTab","$env","common/EventEmitter","engagement/ExposureTimer","engagement/Counter","common/DOMEvents","common/DOMEventsET","engagement/overlap","common/Log","engagement/ViewUtil","engagement/EngagementItem","bootstrap/isAppView","h/timers","engagement/EngagementTracker","bootstrap/Events","bootstrap/Utils","h/beacon","engagement/EngagementAPI","iframe/IframeApiWrapper","DataParser","api/ARMA","common/StateEmitter","common/StyleSheet","AdBox","extra/Panels","common/BWDetect","api/content","AdContent","contents/AdNotice","adqa/FCTest","AdConstructor","contents/ImageTag","types/Standard","$ignore");.each(r.stars,function(){e(this).data("rating.input").val()==t&&e(this).rating("select",undefined,n)})}else r.current=this[0].tagName=="INPUT"?this.data("rating.star"):this.is(".bv-submission-rater-"+r.serial)?this:null;this.data("rating",r),this.rating("draw");var i=e(r.current?r.current.data("rating.input"):null);(n||n==undefined)&&r.callback&&r.callback.apply(i[0],[i.val(),e("a",r.current)[0]])},readOnly:function(t,n){var r=this.data("rating");if(!r)return this;r.readOnly=t||t==undefined?!0:!1,n?e(r.inputs).attr("disabled","disabled"):e(r.inputs).removeAttr("disabled"),this.data("rating",r),this.rating("draw")},disable:function(){this.rating("readOnly",!0,!0)},enable:function(){this.rating("readOnly",!1,!1)}}),e.fn.rating.options={cancel:"Cancel Rating",cancelValue:"",split:0,starWidth:16},e(function(){e("input[type=radio].bv-submission-star").rating()})}(e),e}),BV.define("vendor/jquery/placeholder",["jquery"],function(e){return function(e,t,n,r,i,s,o){var u=function(){var e=n(this);return e.find("["+i+"],"+"["+o+"]")},a=function(){var e=n(this);return e.attr(i)||e.attr(o)},f=function(){var e=n(this);if(typeof this.selectionStart=="number")this.selectionStart=0,this.selectionEnd=0;else if(typeof this.createTextRange!="undefined"){var t=this.createTextRange();t.collapse(!0),t.moveStart("character",0),t.moveEnd("character",0),t.select()}},l=function(){var e=n(this);if(e.hasClass(r))return;e[s]()||(e.addClass(r),e.attr("type")==="password"&&(e.attr("type","text"),e.data(r+"-pwd",!0)),e[s](a.call(this)),e.on("mouseup",f).on("selectstart",!1),e.is(":focus")&&f.call(this))},c=function(){var e=n(this);e.removeClass(r),e.data(r+"-pwd")&&e.attr("type","password"),e[s]()===a.call(this)&&e[s](""),e.off("mouseup",f).off("selectstart",!1)};n.fn.clearPlaceholdersInForm=function(){u.call(this).each(function(){n(this).data(r)&&c.call(this)})},n.fn.placeholdr=function(e){e||(e={});var s=e.overrideNative||!1;if(i in t.createElement("input")&&!s){e.isSafari&&n(this).find("textarea").each(function(){var e=n(this);e.on("input",function(t){e[0].value===""&&e.trigger("blur").trigger("focus")})});return}n(this).find("["+i+"]").each(function(){var t=n(this);if(t.data(r))return;t.data(r,!0),s&&(t.attr(o,t.attr(i)),t.attr(i,"")),l.call(this);var u=function(e){var t=this;setTimeout(function(){l.call(t,e)},25)},a=c;e&&e.preserveOnFocus?t.on("keypress keydown paste",a).on("blur change mouseup keyup",u):(t.on("focus",a),t.on("blur",u))})},n.fn.getPlaceholderText=function(){return a.call(this)},n.fn[s]=n.fn.val,n.fn.val=function(e){var t=n(this);return typeof e=="undefined"&&t.data(r)&&t[s]()===a.call(this)?"":(typeof e=="string"&&c.call(this),n.fn[s].apply(this,arguments))}}(window,document,e,"placeholdr","placeholder","placeholdrVal","placeholdr","clearPlaceholdersInForm"),e}),BV.define("bv/util/jquery/radiosilence",["ENV","lds","jquery","util/specialKeys"],function(e,t,n,r){var i=function(e,r){var i=this.$element=n(e),s;this.options=t.assignIn({},n.fn.bvradiosilence.defaults,r),this.options.wrapper="<"+this.options.wrapperType+"></"+this.options.wrapperType+">",this.$inputs=i.find("input").before(this.options.wrapper),this.$wrappers=i.find(this.options.wrapperType),this.$containers=i.find("."+this.options.containerClass),this.options.value&&this.$inputs.filter('[value="'+this.options.value+'"]').prop("checked",!0),this.options.inputClass&&this.$inputs.addClass(this.options.inputClass),this.options.wrapperClass&&this.$wrappers.addClass(this.options.wrapperClass),s=this,this.$wrappers.each(function(e,r){var i,o=n(this),u=o.next("input"),a=u.attr("id"),f;o.attr("for",a),o.attr("id",a+"-label"),s.options.displayAttr?i=u.attr(s.options.displayAttr):i=u.val(),s.options.labelInnerHtml?o.html(s.options.labelInnerHtml||i):o.text(i),f=u.attr("aria-label"),f||u.attr("aria-label",i),o.hasClass("bv-focusable")&&(o.attr("aria-label",i),u.removeClass("bv-focusable"),u.attr("role","presentation")),t.isObject(s.options.wrapperAttrs)&&o.attr(s.options.wrapperAttrs),t.isObject(s.options.inputAttrs)&&u.attr(s.options.inputAttrs)}),this.inputFocusHandler=this.options.inputFocusHandler||this.inputFocusHandler,this.inputKeydownHandler=this.options.inputKeydownHandler||this.inputKeydownHandler,this.inputClickHandler=this.options.inputClickHandler||this.inputClickHandler,this.wrapperClickHandler=this.options.wrapperClickHandler||this.wrapperClickHandler,this.blur=this.options.blur||n.noop,this.render=this.options.render||this.render,this.render(),this.listen()};return i.prototype={constructor:i,render:function(e){var t=e||this.$element.find("input:checked");this.$containers.removeClass(this.options.activeClass),t.closest("."+this.options.containerClass).addClass(this.options.activeClass),this.$wrappers.removeClass(this.options.focusedClass),t.prev(this.options.wrapperType).addClass(this.options.focusedClass),this.$element.trigger("rendered")},listen:function(){this.$inputs.off("keydown",this.inputKeydownHandler).on("keydown",this,this.inputKeydownHandler),this.$inputs.off("click",this.inputClickHandler).on("click",this,this.inputClickHandler).on("focus",this,this.inputFocusHandler).on("focus",this.addFocusClass).on("blur",this.removeFocusClass).on("blur",this,this.invokeBlurCallback),this.$wrappers.off("click",this.wrapperClickHandler).on("click",this,this.wrapperClickHandler)},wrapperClickHandler:function(){n(this).next("input").trigger("click").trigger("focus")},addFocusClass:function(e){n(this).prev("label").addClass("bv-radio-wrapper-label-focused")},invokeBlurCallback:function(e){var t=e.data;t.blur.call(t.$element)},removeFocusClass:function(e){n(this).prev("label").removeClass("bv-radio-wrapper-label-focused")},inputClickHandler:function(e){var t=e.data;t.render(n(this)),n(this).attr("aria-checked","true"),n(this).parent().siblings().each(function(){n(this).children().attr("aria-checked","false")})},inputFocusHandler:n.noop,inputKeydownHandler:function(t){var i;if(e.get("keyboardMode")&&t.keyCode===r.ENTER||e.get("keyboardMode")&&t.keyCode===r.RIGHT){i=n(this).parents(".bv-radio-container-li").is(":first-child")&&!n(this).is(":checked");if(t.keyCode===r.ENTER||t.keyCode===r.RIGHT&&i)return n(this).trigger("click"),!1}}},n.fn.bvradiosilence=function(e){return this.each(function(){var r=n(this),s=r.data("bvradiosilence");e=e||{},s||r.data("bvradiosilence",s=new i(this,e)),t.isString(e)&&s[e]()})},n.fn.bvradiosilence.defaults={wrapperType:"label",wrapperClass:"bv-radio-wrapper-label",focusedClass:"bv-radio-wrapper-label-focused",containerClass:"bv-radio-container-li",activeClass:"bv-radio-container-li-active",inputClass:"bv-radio-input"},n}),BV.define("bv/util/jquery/nps",["ENV","lds","bv/util/focusManager","util/specialKeys","bv/util/jquery/radiosilence"],function(e,t,n,r,i){var s=function(e,t){this.$element=i(e),this.options=i.extend({},i.fn.nps.defaults,t),this.options.$npsComment=this.options.$npsComment||this.$element.closest(".bv-fieldset").find(".bv-netpromotercomment-wrapper"),this.options.wrapperClickHandler=this.wrapperClickHandler,this.options.inputFocusHandler=this.inputFocusHandler,this.options.inputKeydownHandler=this.inputKeydownHandler,this.options.renderComments=this.renderComments,this.$element.bvradiosilence(this.options),this.renderComments(this)};return s.prototype={constructor:s,renderComments:function(e,r){var i=e.$element.find("input:checked"),s;e.options.$npsComment.toggleClass("bv-hidden",!e.options.expanded&&t.isUndefined(i.val())),r&&(s=e.options.$npsComment.find("textarea"),n.moveFocus(s))},wrapperClickHandler:function(e){var t=e.data;t.$element.off("rendered").on("rendered",function(){i(this).next("input").trigger("click"),t.options.renderComments(t,!0)})},inputFocusHandler:function(e){var t=e.data;t.$element.off("rendered").on("rendered",function(){t.options.renderComments(t)})},inputKeydownHandler:function(t){var n=t.data,s;if(e.get("keyboardMode")&&t.keyCode===r.ENTER||e.get("keyboardMode")&&t.keyCode===r.RIGHT){s=i(this).parents(".bv-radio-container-li").is(":first-child")&&!i(this).is(":checked");if(t.keyCode===r.ENTER||t.keyCode===r.RIGHT&&s)return i(this).trigger("click"),n.options.renderComments(n),!1}}},i.fn.nps=function(e){return this.each(function(){var n=i(this),r=n.data("bvnps");e=e||{},r||n.data("bvnps",r=new s(this,e)),t.isString(e)&&r[e]()})},i}),BV.define("vendor/jquery/autosize",["jquery","body"],function(e,t){var n={className:"autosizejs",append:"",callback:!1},r="hidden",i="border-box",s="lineHeight",o=e('<textarea tabindex="-1" title="none"/>').css({position:"absolute",top:"-9999px",left:0,right:"auto",bottom:"auto",border:0,padding:0,"-moz-box-sizing":"content-box","-webkit-box-sizing":"content-box",boxSizing:"content-box",wordWrap:"break-word",overflow:"hidden",transition:"none","-webkit-transition":"none","-moz-transition":"none"}),u=["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent"],a="oninput",f="onpropertychange",l=e(o)[0];return e(l).css(s,"99px"),e(l).css(s)==="99px"&&u.push(s),e.fn.autosize=function(s){return s=e.extend({},n,s||{}),this.each(function(){function b(){var e,t,i;d||(d=!0,c.value=n.value+s.append,c.style.overflowY=n.style.overflowY,i=parseInt(n.style.height,10),c.style.width=l.css("width"),c.scrollTop=0,c.scrollTop=9e4,e=c.scrollTop,t=r,e>p?(e=p,t="scroll"):e<h&&(e=h),e+=m,l.css("overflowY",t),i!==e&&(l.css("height",e+"px"),y&&s.callback.call(n)),setTimeout(function(){d=!1},1))}var n=this,l=e(n),c,h=l.height(),p=parseInt(l.css("maxHeight"),10),d,v=u.length,m=0,g=n.value,y=typeof s.callback=="function";if(l.css("box-sizing")===i||l.css("-moz-box-sizing")===i||l.css("-webkit-box-sizing")===i)m=l.outerHeight()-l.height();if(l.data("mirror")||l.data("ismirror"))return;c=e(o).data("ismirror",!0).addClass(s.className)[0],l.data("mirror",e(c)).css({overflow:r,overflowY:r,wordWrap:"break-word"}),p=p&&p>0?p:9e4;while(v--)c.style[u[v]]=l.css(u[v]);e(t()).append(c),f in n?a in n?n[a]=n.onkeyup=b:n[f]=b:(n[a]=b,n.value="",n.value=g),e(window).on("resize",b),l.on("autosize",b),b()})},e}),BV.define("bv/c2013/view/submission",["ENV","window","framework/bview","bv/ui-core/focusableview","bv/util/focusManager","framework/bmodel","framework/clientEvents","hbs!submissionBase","hbs!reviewPhotoCounts","hbs!slider","bv/util/submissionSubviews","lds","util/specialKeys","bv/util/user","bv/util/contentType","bv/util/janrain","bv/util/withRPC","bv/util/session","bv/util/productInfo","bv/strings","util/isodate","bv/ui-core/modestbox","vendor/toolegit","util/emailValidationRule","util/emojiValidationRule","bv/util/formMemory","bv/util/loadingOverlay","bv/util/ariaStatus","mf!bv/c2013/messages/submission","mf!bv/c2013/messages/common","framework/util/bvreporter","framework/util/bvtracker","framework/util/ie","jquery","bv/c2013/model/upload","bv/c2013/view/submission/errorMessages","framework/video/youtubeVideo","bv/c2013/view/submission/tagHelpers","client!util/cookie","util/md5","bv/util/domainPolice","vendor/jquery/rating","vendor/jquery/placeholder","bv/util/jquery/nps","vendor/jquery/autosize"],function(t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R){function X(e){return P(e).closest(".bv-fieldset")}var U=t.get("config"),z=r.extend(i),W="-server";return z.extend({name:"submission",rpcReady:P.Deferred(),events:{"click .bv-submit":"onSubmit","click .bv-cancel":"cancelForm","click .bv-btn-add-video":"videoUpload","click .bv-btn-add-photo":"photoUploadChoice","focus .bv-fieldset-agreements a":"onFocusAgreementsLink","blur .bv-fieldset-agreements a":"onBlurAgreementsLink","click .bv-fieldset-agreements a":"goToAgreements","click .bv-fieldsets input, .bv-fieldsets textarea":"focusEvent","click .bv-fieldset-netpromoterscore .bv-radio-container-li input":"clickEventNP","focus .bv-fieldsets input, .bv-fieldsets textarea, .bv-fieldsets select":"focusEvent","focus .bv-fieldsets .bv-radio-input, .bv-fieldsets .bv-content-btn":"focusEvent","change .bv-fieldset-tags .bv-radio-container-li input":"tagChange","focus .bv-fieldset-tags .bv-radio-container-li":"focusTag","blur .bv-fieldset-tags .bv-radio-container-li":"blurTag","keydown .bv-fieldset-tags .bv-radio-container-li":"keydownTag","keydown .bv-thumbnail-close":"keydownRemoveButton","change .bv-fieldset select":"selectChange","keypress input[maxlength].bv-text":"checkMaxlength"},template:a,msgpacks:[A,O],init:function(t){var n,r=[],i=[],s=U.submission.rating.range,o=h.last(s),a=h.head(s);this.inline=t.inline,this.isGenericSubmission=t.isGenericSubmission,this.closeAllPostSubmission=t.closeAllPostSubmission,this.ModestBoxId=t.inline?this.model.get("componentId"):"lightbox",this.reviewPhotoCountsTemplate=f,this.thumbnailViews={},this.on("viewready",this.setupUIElements,this),this.on("addmedia",this.addMedia,this),this.on("removemedia",this.removeMedia,this),this.on("showupload",this.showUploadView,this),this.on("updateupload",this.updateButtons,this),this.on("updateupload",this.setRemainingPhotoCount,this),U.vendorConfig.janrain&&m.withAPI(),a=a===o?0:a;while(a<=o)n=a++,r.push("bv-fieldset-r"+n),i.push("bv-fieldset-h"+n);this.ratingClasses=r.join(" "),this.ratingHoverClasses=i.join(" "),this.once("viewshown",function(){var t=this.getForm();!t.closest(".bv-mbox-search").length&&!this.model.get("formErrors")&&this.moveInitialFocus(),this._setupERRErrors()}),this.on("viewshown",function(){u.trigger("submissionLoad",this.model.get("clientAPIConfig"),{contentType:this.model.get("contentType")}),P(".bv-control-bar-count").attr("aria-hidden",!0)}),this.on("viewclosed",function(){u.trigger("submissionClose",this.model.get("clientAPIConfig"),{contentType:this.model.get("contentType")}),P(".bv-control-bar-count").removeAttr("aria-hidden")}),this.on("viewready",this._registerFocusables,this)},_registerFocusables:function(){this.$(".bv-focusable").each(function(t,n){n.tabIndex=0})},render:function(){this.model.get("pageview")&&this.triggerPageView(),r.prototype.render.apply(this,arguments)},attach:function(t){var n;r.prototype.attach.call(this,t),n=this.$viewEl.find(".bv-fieldset-radio-wrapper, .bv-fieldset-reviewtext"),n.length>0&&(n.data("receiveFocusManagerEvents",!0),n.on("focusManagerFocus",function(t){if(t.keyEvent.keyCode!==p.TAB)return;s[t.keyEvent.shiftKey?"focusPrev":"focusNext"]()})),_.feature({type:"Shown",name:"Submission",bvProduct:b.getType(this),source:"firebird",notificationId:this.model.get("bvNotificationId"),contentId:this.model.get("bvQuestionId"),productId:b.getId(this),clientName:U.clientname.toLowerCase(),deploymentZone:U.siteId,dc:U.displaycode,messageType:this.model.get("bvMessageType"),recipientDomain:this.model.get("bvRecipientDomain"),userLocale:U.locale,campaignId:this.model.get("campaignId")})},ieCompat:function(){var t=D();t&&(this.$el.find(".bv-compat").addClass("bvie bvie"+t),t<8&&this.$el.find(".bv-compat").addClass("bvie-lt8"))},photoUploadChoice:function(t){var n=this;if(!this.hasFeature("addSocialPhoto"))return this.photoUpload(t);this.photouploadPopup||(this.photouploadPopup=new c.PhotoUploadPopupView({parent:{$targetEl:n.$(".bv-popup-target"),options:{positionPopupRelativeToLink:!0},photoUpload:P.proxy(n.photoUpload,n),facebookPhotoUpload:P.proxy(n.facebookPhotoUpload,n)},aboveModestBox:!0,model:new o(n.model.attributes)}),S.get(this.ModestBoxId).once("beforeClose",function(){n.photouploadPopup.rendered&&n.photouploadPopup.detach(),delete n.photouploadPopup})),this.photouploadPopup.rendered?this.photouploadPopup.detach():this.photouploadPopup.render();return},photoUpload:function(t){var n=this.model.get("photos"),r=this.$viewEl.find(".bv-btn-add-photo");if(n&&n.length>=this.maxMedia.photo)return;this.showUploadView("photo",null,null,null,r)},facebookPhotoUpload:function(t){var n=this.model.get("photos"),r=this.$viewEl.find(".bv-btn-add-photo"),i=this;if(n&&n.length>=this.maxMedia.photo)return;m.withAPI(function(){k.show(),m.login("facebook").done(function(t){var n=t&&t.accessCredentials&&t.accessCredentials.accessToken;n&&i.showUploadView("photo",undefined,"facebook",{token:n},r)}).fail(k.hide)})},videoUpload:function(t){var n=P(t.target);this.showUploadView("video",null,null,null,n)},showUploadView:function(t,n,r,i,o){var u=r||"",a=this.model.toJSON(),f={photo:c.PhotoUploadView,video:c.VideoUploadView,facebookphoto:c.FacebookPhotoUploadView},l=H({source:u,mediaType:t,contentType:a.contentType,msgpack:A,parent:this.model,formFields:a.formFields,clientName:a.clientName,componentId:this.model.get("componentId"),apiConfig:a.apiConfig}),p=h.assignIn({parent:this,contentType:v.noun(a.contentType),media:n,msgpack:A,mediaType:t,componentId:this.model.get("componentId"),model:l},i),d=new f[u+t](p),m=d.getFeatureView("dropdownable"),g,y=S.get(this.ModestBoxId),b=y.$viewEl.find(".bv-mbox-wrapper"),w=this.getForm();y.push({title:A["add_"+u+t](),view:d,beforeShow:function(){d.setupView()},afterShow:function(){g=L.add(A["add_"+t+"_dialog"]()),m&&h.delay(function(){m.popIn()},300),b.addClass("bv-mbox-media-upload"),w.attr("aria-hidden",!0)},beforeHide:function(){g.remove(),m&&m.popOut(),b.removeClass("bv-mbox-media-upload"),w.attr("aria-hidden",!1)},afterHide:function(){typeof o=="string"&&(o=P(o).find("a"))},afterDetach:function(){s.rescanFocusLayer(),s.moveFocus(o||P(document.activeElement))}})},addMedia:function(t,n){var r,i;this._addMedia(t,n),n.url&&y.set(escape(n.url),n,P.noop),S.get(this.ModestBoxId).pop(),r=D(),r&&r<9&&this.$form.find("textarea").trigger("resize"),i=L.add(A["submission_"+t+"_added"]()),setTimeout(function(){i.remove()},1e3),this.$form.trigger("formMemory")},_addMedia:function(t,n){this.model.addMedia(t,n),this._updateThumbnails(t)},removeMedia:function(t,n){this.model.removeMedia(t,n),this._updateThumbnails(n)},_updateThumbnails:function(t){var n=this.thumbnailViews[t];n||(n=new c.ThumbnailView({parent:this,mediaType:t,componentId:this.model.get("componentId")}),this.thumbnailViews[t]=n),n.render()},updateButtons:function(t,n){var r=this.$el.find(".bv-btn-add-"+t);n<=0?r.prop("disabled",!0):r.prop("disabled",!1)},setRemainingPhotoCount:function(t,n){var r,i,s;if(t==="video")return;r={maxPhotos:this.model.getMaxNumByMediaType(t)},h.isNumber(n)&&n!==this.maxMedia.photo&&(r.remainingPhotos=String(n)),i=this.$el.find(".bv-review-photo-actions-label"),this.maxMedia.photo===1?s="":s=this.reviewPhotoCountsTemplate(r),i.html(s)},cancelForm:function(t){S.get(this.ModestBoxId).close()},scrollForm:function(t){this.trigger("scroll")},focusEvent:function(t){var n=P(t.currentTarget);document.activeElement!==t.target&&t.target.type!=="checkbox"&&(P(t.target).trigger("focus"),P(t.target).trigger("click")),this.updateActiveElementCSS(n)},clickEventNP:function(t){var n=P(t.currentTarget);n&&n.attr("name")&&n.attr("name")==="netpromoterscore"&&n.prop("checked")&&this.validator.check(n)},addRejectionClass:function(t){var n=t.closest("fieldset");t.prop("name")==="rating"&&n.addClass("bv-fieldset-rejected")},updateActiveElementCSS:function(t){var n,r,i;this.fieldsets&&(n=this.fieldsets.filter(".bv-fieldset-active"),r=t.closest(".bv-fieldset"),this.doneFocusing&&n.is(".bv-radio-field")&&!n.is(r)&&this.validator.check(n.find("input:first")),this.fieldsets.removeClass("bv-fieldset-active").removeClass("bv-hidden"),r.is(".bv-fieldset-netpromotercomment")&&(i=this.fieldsets.filter(".bv-fieldset-netpromoterscore"),i.addClass("bv-fieldset-active")),r.addClass("bv-fieldset-active"))},focusTag:function(t){var n=P(t.currentTarget);n.find(".bv-radio-wrapper-label").addClass("bv-radio-wrapper-label-focused")},blurTag:function(t){var n=P(t.currentTarget);n.find(".bv-radio-wrapper-label").removeClass("bv-radio-wrapper-label-focused")},keydownTag:function(t){t.keyCode===p.ENTER&&(t.preventDefault(),P(t.currentTarget).find("input").trigger("click"))},keydownRemoveButton:function(t){var n;if(t.keyCode===p.ENTER||t.keyCode===p.SPACE)t.preventDefault(),n=P(t.currentTarget),h.defer(function(){n.trigger("click")})},checkMaxlength:function(t){function u(){if(!n._$ariaAlert)return;n._$ariaAlert.remove(),n._$ariaAlert=null}var n=this,r,i,s=P(t.currentTarget),o=Number(s.attr("maxlength"));if(o===0)return;r=s.val(),r.length>=o?(i=A.max_length_reached_message({maxlength:o}),u(),this._$ariaAlert=this.showAriaAlert(i)):u()},tagChange:function(t){var n=P(t.currentTarget),r=n.closest(".bv-radio-container-li"),i=r.find(".bv-radio-container-icon"),s=n.is(":checked");r.toggleClass("bv-radio-container-li-active",s),r.attr("aria-checked",s),i.length===1&&(s?i.html("✔"):i.html("+"))},selectChange:function(t){var n=P(t.currentTarget),r;n.is('[name="contextdatavalue_Age"]')&&(r=n.val()==="17orUnder",r?_.optOut():this.optedOut&&_.optIn(),this.optedOut=r)},onSubmit:function(t){var n,r,i,s=this,o=s.getAgreementsType(),u=this.model.attributes.agreements[o],a=!1,f,l="agreements_";t.preventDefault(),n=this.model.get("formFields").emailField,n&&(r=this.$("#bv-email-field-"+n.schema.Id).val(),d.save({email:r.trim().toLowerCase()})),i=this.getForm(),h.some(u,function(e,t){var n;f=l+o+"_"+t,n=P("[name='"+f+"']")[0];if(!n.checked)return a=!1,!0;a=!0}),a&&(P("[name='agreedtotermsandconditions']")[0].value=!0),this.model.get("fingerprint").preSubmitAction(i,function(t){t?s.trigger("showcannotsubmitpage",{view:s,message:A.error_FAILED_TO_LOAD_FINGERPRINT_AFTER(),isRecoverable:!0}):(i.find("[placeholdr]").length>0&&i.clearPlaceholdersInForm(),i.trigger("submit"))})},setupRPC:function(){var t=this;t.rpc=g(t.rpcReady,function(n){k.hide(),n.SubmissionId?t.postSubmission(n):t.formErrorsPage(n)}),t.model.set("channelId",t.rpc.channel)},starHelper:function(t){return X(t).find(".bv-rating-helper")},ratingFieldHasError:function(t){return t.hasClass("bv-error")},ratingFieldHadError:function(t){return t.hasClass("bv-had-error")},ratingSetLabel:function(t,n){t.html(n)},ratingDisplayError:function(t){t.addClass("bv-error"),t.removeClass("bv-had-error")},ratingRemoveError:function(t){t.removeClass("bv-error"),t.addClass("bv-had-error")},ratingFocus:function(){var t,n,r,i=this;return function(s,o){n=n||i.starHelper(this),r=r||X(n),t=i.$(".bv-submission-rejection-errors"),i.ratingFieldHasError(r)&&t.length===0&&i.ratingRemoveError(r),n.data("helper",n.data("helper")||n.html()),i.ratingSetLabel(n,this.title),r.removeClass(i.ratingHoverClasses).addClass("bv-fieldset-h"+s)}},ratingBlur:function(){var t,n,r=this;return function(i,s){t=t||r.starHelper(this),n=n||X(t),t.data("helper")===A.helper_rating_1()&&r.ratingFieldHadError(n)&&r.ratingDisplayError(n),r.ratingSetLabel(t,t.data("helper")||""),n.removeClass(r.ratingHoverClasses)}},getForm:function(t){var n=t||this.model.toJSON(),r=[n.contentType,n.subject.Type,n.subject.SanitizedId,n.modelCid],i="#bv-submit"+r.join("-"),s=P(i);return s},formSetup:function(t){function b(e,t){var r=this.title;n.starHelper(this).data("helper",r).html(r),X(this).removeClass(n.ratingClasses+" "+n.ratingHoverClasses+" "+"bv-had-error"),X(this).addClass("bv-fieldset-r"+e),n.validator.check(P(this))}function w(e){var t,n,s,o;t=e.selector.match(i);if(!t)return;n=t[1],s=Number(t[2])-1,o=r[n],o[s]=e.val}function E(e){var t=P.Deferred();return y.get(escape(e),function(n){t.resolve(n)}),t}function S(){var e,t,i,s;e=h.keys(r),t=h.flatten(h.values(r));if(t.length===0)return;i=h.map(t,E),s={},P.when.apply(P,i).done(function(){h.forEach(arguments,function(t){if(!t)return;s[t.url]=t}),h.forEach(e,function(t){h.forEach(r[t],function(r){var i=s[r];if(!i)return;n._addMedia(t,i)})})})}function T(e){var t=P(e[0])&&P(e[0]).attr("name");return s[t]}function N(){var e=P(this);n.validator.check(e.find("input"))}function L(e,t){var r,i,o,u=s[e+"url_"+t];if(!u||!u.schema.Value)return;r=u.schema.Value,i=s[e+"caption_"+t],e==="video"?o=(new j(r)).getVideoData():o=P.Deferred().resolve(),o.done(function(s){var o;e==="video"?o=s&&s.thumbUrl:o=r.replace("photo.jpg","photoThumb.jpg"),n._addMedia(e,{id:u.schema.Id,caption:i&&i.schema.Value,url:r,thumbUrl:o})})}var n=this,r,i,s,o,u,a,f,c=this.model.toJSON(),p=this.getForm(c),d=t||{},v=navigator.userAgent.match(/(?:\b(MS)?IE\s+|\bTrident\/7\.0;.*\s)(\d+)/i),m=navigator.userAgent.match(/(iPhone|iPod)/),g=navigator.userAgent.match(/Version\/[\d\.]+.*Safari/i);return n.$form=p,n.fieldsets=p.find(".bv-input-fieldsets .bv-fieldset"),n.serverErrors=[],n.publish("formSetup",{}),n.ieCompat(),n.maxMedia={photo:this.model.getMaxNumByMediaType("photo"),video:this.model.getMaxNumByMediaType("video")},n.validator=x(p,{ruleSelectors:c.validationRules.rules,ignore:[".bv-form-ignore"],onError:function(t,r){var i=t.prop("name")+W;r!==i&&n.validator.removeSelectorRules(t,[i])},preSubmit:function(){n.validator.removeRule(n.serverErrors)},submit:h.debounce(function(t){n.scrollForm(),k.show(),p.find(".bv-submit").prop("disabled",!0),n.rpcReady.done(function(){p.trigger("submit.placeholder")}).fail(function(){n.trigger("showcannotsubmitpage",{view:n,isRecoverable:!0}),n.triggerPageView({value:"UnknownError"})})},500,!0)}),r={photo:[],video:[]},i=/name="(photo|video)url_(\d+)"/,g&&(d.isSafari=!0,m&&p.find("button.bv-form-actions-submit.bv-submit").attr("style","margin-bottom: 60px !important")),v&&(d.overrideNative=!0,d.preserveOnFocus=!0),p.placeholdr(d),setTimeout(function(){p.find("textarea").autosize()},0),s=n.model.getFields(),C.remember(p,function(t){var r=P(t);r.is(".bv-rating-input")?b.call(r[0],r.val(),r):r.is('[name="contextdatavalue_Age"]')&&(n.optedOut=r.val()==="17orUnder"),n.validator.count(r)},{noElementCallback:function(t){s.PreviousSubmissionId||w(t)}}),S(),n.$("fieldset").not(".bv-fieldset-tags, .bv-fieldset-netpromoterscore, .bv-fieldset-netpromotercomment, .bv-form-actions, .bv-fieldset-agreements").each(function(){var t=P(this),n=t.find(".bv-text, .bv-select, .bv-radio-input"),r=T(n);!h.isUndefined(r)&&r.validation.required&&(r.type==="select"?n.attr("required","true"):r.type!=="radio"&&n.attr("aria-required","true"))}),n.$(".bv-fieldset-tags-group").each(function(){function o(e){var t=F.parse(e.schema.Id),r=n.find('input[name="tagid_'+t.id+"/"+t.childId+'"]'),i=e.schema.Value==="true";F.updateElEnabled(r,i)}var t,n=P(this),r=n.find("input:first").attr("name"),i=F.parse(r);i&&(t=s["tag_"+i.id],t&&t.tags&&h.each(t.tags,o))}),n.$(".bv-fieldset-rating, .bv-fieldset-secondary-rating").each(function(){function s(){n.validator.check(r)}var t=P(this),r=t.find(".bv-radio-input"),i=T(r);r.rating({callback:b,focus:n.ratingFocus(),blur:n.ratingBlur(),focusout:s,withHeatMap:n.hasFeature("starHoverHeatMap")}),i&&i.schema.Value&&(r.rating("select",i&&i.schema.Value),n.validator.reporter.handlers.reset(r.first()))}),d.shortForm&&(n.fieldsets.addClass("bv-hidden"),n.fieldsets.first().removeClass("bv-hidden")),o=s.isrecommended,n.$(".bv-fieldset-isrecommended-group").bvradiosilence({displayAttr:"data-label",value:o&&o.schema.Value,inputAttrs:{role:"radio"},blur:N}),n.$(".bv-fieldset-slider-group").each(function(){var t=P(this),n=t.find("input"),r=T(n);t.bvradiosilence({labelInnerHtml:l,value:r&&r.schema.Value,inputAttrs:{role:"radio"},blur:N})}),u=s.netpromoterscore,a=s.netpromoterexpanded,n.$(".bv-fieldset-netpromoterscore-group").nps({value:u&&u.schema.Value,expanded:a&&a.schema.Value,inputAttrs:{role:"radio"},blur:N}),f=h.range(1,h.size(s)),h.forEach(f,function(t){L("photo",t),L("video",t)}),this._setupEmailValidation(),this._setupEmojiValidation(),this},_setupEmailValidation:function(){var t=this.$form.find(".bv-email-field"),n=t.find("input"),r=t.find(".bv-helper-label");n.attr("aria-describedby","bv-invalid-email-for-aria-describedby"),r.attr("id","bv-invalid-email-for-aria-describedby"),this.validator.addRule("emailValidation",T),this.validator.addSelectorRules(n,{emailValidation:!0})},_setupEmojiValidation:function(){var t=this.validator,n=this.$form.find("input#bv-text-field-usernickname, input#bv-text-field-userlocation, input#bv-email-field-hostedauthentication_authenticationemail");this.validator.addRule("emojiValidation",N),n.each(function(n,r){t.addSelectorRules(P(r),{emojiValidation:!0})})},_setupERRErrors:function(){var t,r=this.model.get("formErrors");r&&(this.formErrorsPage({FormErrors:r}),t=P(".bv-error").first(),t.length>0?this.updateActiveElementCSS(t):(t=P(".bv-submission-rejection-errors"),n.setTimeout(function(){s.moveFocus(t)},0)))},_openTermsAndConditionsURL:function(t){var r=n.open(t);P(r).trigger("focus")},getAgreementsType:function(){var t=this.model.get("contentType");return t==="answer"&&(t="question"),t=v.nouns(t),t},isUrlValid:function(t){var n=t.match(/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/g);return n===null?!1:!0},onFocusAgreementsLink:function(t){var n=O.offscreen_writeReviewModalNotice();P(t.currentTarget).attr("aria-label",n)},onBlurAgreementsLink:function(t){P(t.currentTarget).attr("aria-label","")},goToAgreements:function(n){var r=this,i,o,u,a,f,l=r.getAgreementsType(),h,p=P(n.currentTarget).closest("fieldset").find("input:first").attr("name"),d="agreements_"+l+"_",v;p=p.replace(d,""),h=this.model.attributes.agreements[l][p],n.preventDefault();if(h.displayType==="REMOTE_URL"){v=P(n.target).attr("href");if(this.isUrlValid(v)&&h.remoteUrl!==v){this._openTermsAndConditionsURL(v);return}this._openTermsAndConditionsURL(h.remoteUrl);return}i=new c.TermsConditionsView({parent:this,componentId:this.model.get("componentId"),fields:h}),o={title:h.agreementTitle,view:i,inline:!1,ariaDialog:!0,ariaDescribedby:"bv-terms-conditions",overlay:!0};if(this.inline){o.wrapClass="bv-core-container-"+t.get("config").version,S.get("lightbox").open(o);return}u=S.get(this.modestBoxId),u.ignoreKeys=!0,u.skipResizing=!0,a=S.get("terms-and-conditions"),a.once("afterOpen",function(){var t;if(u.inline||u.over)return;f=u.$layerList.height(),t=a.$layerList.height(),u.$layerList.height(t)}),a.open(o),a.once("afterClose",function(){u.$layerList.height(f),u.ignoreKeys=!1,u.skipResizing=!1,s.rescanFocusLayer(),s.moveFocus(P("#bv-checkbox-reviews-termsAndConditions")||P(document.activeElement))})},setupUIElements:function(){function i(){try{t._setFocusOnForm()}catch(e){}}var t=this,n=this.model.get("clientAPIConfig"),r=this.inline?(n||{}).doShowContent||P.noop:P.noop;r(null,null,null,null,i,null)!==!1&&i()},_setFocusOnForm:function(){},_sendCollectOnSubmitEvent:function(){var t,n;if(!this.hasFeature("collectOnSubmit"))return;t=this.model.get("clientAPIConfig")||{},n=t.catalogData||{},_.feature({type:"Used",name:"Submission",detail1:"CollectOnSubmit",bvProduct:b.getType(this),locale:n.locale||null,catalogProducts:n.catalogProducts||null,catalogBrands:n.catalogBrands||null,catalogCategories:n.catalogCategories||null,deploymentZone:U.siteId})},_sendGRSEvent:function(){if(!this.isGenericSubmission)return;_.feature({type:"Used",name:"Submission",detail1:"GenericReviewSubmission",bvProduct:b.RATINGSANDREVIEWS,productId:b.getId(this),categoryId:b.getCategoryId(this)})},_sendNotificationsSubmissionEvent:function(){_.feature({type:"Used",name:"Submission",detail1:"submissionFormSubmit",source:"firebird",notificationId:this.model.get("bvNotificationId"),messageType:this.model.get("bvMessageType"),recipientDomain:this.model.get("bvRecipientDomain"),contentId:this.model.get("bvQuestionId"),clientName:U.clientname.toLowerCase(),bvProduct:b.getType(this),productId:b.getId(this),campaignId:this.model.get("campaignId"),userLocale:U.locale,dc:U.displaycode,deploymentZone:U.siteId})},postSubmission:function(t){var n=this,r=this.saveSubmission(t),i={view:this,response:r},s=i.response.SubmissionId;this._sendCollectOnSubmitEvent(),this._sendGRSEvent(),this._sendNotificationsSubmissionEvent(),u.trigger("submissionSubmitted",this.model.get("clientAPIConfig"),{contentType:this.model.get("contentType")}),this.model.get("fingerprint").postSubmitAction(s,function(){n.model.publish("contentSubmitted",i);if(!n.hasFeature("thankYouPage"))return n.previewSubmission(r);n.off("ModestBox:beforeClose"),n.trigger("showthankyoupage",i),n.triggerPageView({label:"Lightbox",value:"ThankYou",submissionId:s})})},saveSubmission:function(t){var n,r,i=this.model.getSubject(),s=t[v.Noun(i.contentType)];return s.RatingRange=U.submission.rating.range,s._contentType=i.contentType,s.SubmissionTime=E(),s.SubmissionId=t.SubmissionId,v.noun(this.model.get("contentType"))==="review"&&this.model.set("submissionResponse",s),t.AuthorSubmissionToken&&d.save({token:t.AuthorSubmissionToken}),n="hasSubmitted-"+i.id+"-"+i.contentType,r={},r[n]=!0,d.save(r),s},previewSubmission:function(t){var n;M.assert(h.isObject(t),"preview submission requires a response object"),t.Author=t.Author||{},t.Author.ModerationStatus="APPROVED",this.model&&this.model.hasFeature("submissionPreview")&&(n=S.get(this.ModestBoxId),n.opened&&n.close(!0),this.model.get("contentType")==="comment"?this.model.trigger("previewsecondarycontent",this.model.get("subjectId"),t):this.model.trigger("previewcontent",t))},formErrorsPage:function(n){var r=this,i,s,o,u,a,f=!0,l,c=r.$el.find("form"),p=[],d=[],v=[],m=n.FormErrors.FieldErrors;m&&!h.isEmpty(m)&&(h.forEach(n.FormErrors.FieldErrors,function(t){var n,i,s,o,u="[name="+t.Field+"]";v.push(u),n=c.find(u),i=t.Field+W,s={},o=t.Field.indexOf("photo")>=0||t.Field.indexOf("video")>=0;if(o)return;if(n.attr("type")==="hidden"){d.push(t);return}s[i]=!0,r.serverErrors.push(i),r.validator.addRule(i,function(){var n=!0;return function(r,i,s){var o;return n&&r.val().trim().length===0&&(n=!1),n?(o=B.defaultMessage(t),{type:"server",code:t.Code,message:o}):!1}}()),r.validator.addSelectorRules(n,s),r.addRejectionClass(n),r.validator.check(n)}),d.length===0&&(i=c.find(v.join(", ")),i.length>0&&r.validator.showInvalid(i))),n.Errors&&n.Errors.length&&(this.model.trigger("queryError",n.Errors),p.push(n.Errors[0])),d.length?r.trigger("showcannotsubmitpage",{view:r}):p.length&&(s=p[0].Code,o=A["error_"+s],u=h.isFunction(o)?o():null,s==="ERROR_PARAM_INVALID_ATTRIBUTE"&&(a="bvcoppa_"+q(t.get("config").clientname+t.get("config").deploymentId),l=q(a+P.now()),I.create(a,l,365,R.allowedDomain()),f=!1),r.trigger("showcannotsubmitpage",{view:r,message:u,isRecoverable:f})),r._reportErrors(d,!0),r._reportErrors(p),c.find(".bv-submit").prop("disabled",!1)},cleanup:function(){var t;t=this.getFeatureView("dropdownable"),t&&t.popOut()},triggerPageView:function(t){var n=this.model.get("pageview");if(!n)return;_.pageview(h.defaults(t||{},{type:"Product",label:"Lightbox",context:"Write",bvProduct:n.bvProduct,productId:b.getId(this)}),this.model)},_reportErrors:function(t,n){var r;if(!t.length)return;r=h.map(t,function(t){return{name:n?w.errors.FORM:w.errors.API,detail1:t.Code,detail2:t.Message}}),_.error(r)},moveInitialFocus:function(){var t=this.getForm(),n=["input.bv-focusable:visible","textarea.bv-focusable:visible"],r=n.join(", "),s=t.find(r).eq(0);if(this.contentType==="answer"||this.contentType==="question"||this.contentType==="review")s=S.get(this.ModestBoxId).$viewEl.find(".bv-focusable.bv-mbox-close");s.length&&h.delay(function(){i.moveFocus(s)},0)}})}),BV.define("hbs!thankYou",["hbs","vendor/handlebars/runtime","template/helpers/view","template/helpers/renderIcon","template/helpers/mountView"],function(e,t){var n=t.template(function(e,t,n,r,i){function p(e,t){var r="",i,s,o;r+=' <hgroup class="bv-submission-message"> <h1 aria-hidden="true">',o={hash:{classList:"bv-submission-icon",ariaHidden:"true"},inverse:c.noop,fn:c.program(2,d,t)},s=(i=n.renderIcon,i?i.call(e,"bv-sprite-thank-you",o):h.call(e,"renderIcon","bv-sprite-thank-you",o));if(s||s===0)r+=s;r+='</h1> <h2 id="bv-mbox-label-text" class="bv-submission-text"> ',(s=n.message)?s=s.call(e,{hash:{}}):(s=e.message,s=typeof s===f?s.apply(e):s),r+=l(s)+" ",s=n["if"].call(e,e.offScreenText,{hash:{},inverse:c.noop,fn:c.program(4,v,t)});if(s||s===0)r+=s;return r+=" </h2> </hgroup> ",o={hash:{}},r+=l((i=n.mountView,i?i.call(e,"socialConnect",e,o):h.call(e,"mountView","socialConnect",e,o)))+" ",o={hash:{}},r+=l((i=n.mountView,i?i.call(e,"searchContentList",e,o):h.call(e,"mountView","searchContentList",e,o)))+" ",r}function d(e,t){var r;return(r=n.icon)?r=r.call(e,{hash:{}}):(r=e.icon,r=typeof r===f?r.apply(e):r),r||r===0?r:""}function v(e,t){var r="",i;r+=" ",i=n.unless.call(e,e.isMobile,{hash:{},inverse:c.noop,fn:c.program(5,m,t)});if(i||i===0)r+=i;return r+=" ",r}function m(e,t){var r="",i;return r+=' <span class="bv-off-screen">',(i=n.offScreenText)?i=i.call(e,{hash:{}}):(i=e.offScreenText,i=typeof i===f?i.apply(e):i),r+=l(i)+"</span> ",r}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers;var s="",o,u,a,f="function",l=this.escapeExpression,c=this,h=n.helperMissing;a={hash:{tag:"div",classList:"submission submission-thankyou submission-message-container focusable",tabindex:"-1"},inverse:c.noop,fn:c.program(1,p,i)},u=(o=n.view,o?o.call(t,t,a):h.call(t,"view",t,a));if(u||u===0)s+=u;return s+=" ",s});return t.registerPartial("thankYou",n),n.deps=[],n.tplMountedViews=["socialConnect","searchContentList"],n}),BV.define("bv/c2013/view/thankYouPage",["framework/bview","hbs!thankYou"],function(e,t){return e.extend({name:"thankYouPage",classList:["thankyou"],template:t})}),BV.define("hbs!textDropdown",["hbs","vendor/handlebars/runtime","template/helpers/renderIcon"],function(e,t){var n=t.template(function(e,t,n,r,i){function c(e,t){var r,i,s;return s={hash:{classList:"bv-close-btn",ariaHidden:"true"},inverse:u.noop,fn:u.program(2,h,t)},i=(r=n.renderIcon,r?r.call(e,"bv-sprite-close",s):a.call(e,"renderIcon","bv-sprite-close",s)),i||i===0?i:""}function h(e,t){return" &#x2718; "}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers;var s="",o,u=this,a=n.helperMissing,f="function",l=this.escapeExpression;s+=' <div class="bv-cleanslate bv-cv2-cleanslate bv-absolute-top-container" role="region" aria-label="Guidelines"> <div class="bv-core-container-',(o=n.version)?o=o.call(t,{hash:{}}):(o=t.version,o=typeof o===f?o.apply(t):o),s+=l(o)+'"> <div class="bv-shared bv-popup-container"> <!--[if lt IE 7]> <div class="bv-compat bvie6 bvie-lt8 bvie"> <![endif]--> <!--[if IE 7]> <div class="bv-compat bvie7 bvie-lt8 bvie"> <![endif]--> <!--[if IE 8]> <div class="bv-compat bvie8 bvie"> <![endif]--> <!--[if IE 9]> <div class="bv-compat bvie9 bvie"> <![endif]--> <!--[if gt IE 9]> <!--><div class="bv-compat"> <!--<![endif]--> <div id="',(o=n.dropdownId)?o=o.call(t,{hash:{}}):(o=t.dropdownId,o=typeof o===f?o.apply(t):o),s+=l(o)+'" class="bv-popup bv-textdropdown"> ',(o=n.text)?o=o.call(t,{hash:{}}):(o=t.text,o=typeof o===f?o.apply(t):o);if(o||o===0)s+=o;s+=" ",o=n["if"].call(t,t.autoOpen,{hash:{},inverse:u.noop,fn:u.program(1,c,i)});if(o||o===0)s+=o;return s+=" </div> </div> </div> </div> </div> ",s});return t.registerPartial("textDropdown",n),n.deps=[],n.tplMountedViews=[],n}),BV.define("bv/ui-core/textDropdown",["ENV","window","body","backbone","lds","jquery","hbs!textDropdown","framework/util/bvreporter","util/specialKeys"],function(e,t,n,r,i,s,o,u,a){return r.View.extend({options:{alwaysShow:!0,stylize:!0,attachDelay:50,detachDelay:500,popinClass:"bv-popup-in",popoutClass:"bv-popup-out",dimensionStyle:"containerOverflow",inModestBox:!1,inModestBoxClass:"bv-dropdown-inmbox",popInEvent:"mouseenter",popOutEvent:"mouseleave",popInOpened:!1},initialize:function(e){var t=this;u.assert(e,"options are provided to textDropdown initialize method"),this.text=e.text,i.assignIn(this.options,e),this.id="bv-textdropdown-"+Math.floor(Math.random()*1e10),this.options.dimensionStyle=this.options.dimensionStyle||"containerOverflow",this.escKeyEventName="keyup."+this.id,this.options.dimensionStyle==="sliderTextOverflow"&&(this.options.popInEvent="mouseenter focusin",this.options.popOutEvent="mouseleave focusout"),this.options.dimensionStyle==="helperTextOverflow"&&(this.options.popInEvent="focus",this.options.popOutEvent="blur"),this.isElFocusable=this.$el.hasClass("bv-focusable")||this.$el.find(".bv-focusable").length>0,u.assert(this.isElFocusable||this.options.inModestBox&&s("#bv-mbox-lightbox-list").length>0,"textDropdowns need a focusable element or a modestbox to target"),this.isElFocusable?this.$target=this.$el:this.$target=s("#bv-mbox-lightbox-list"),this.options.autoOpen?this.popIn():this.attach(),this.options.inModestBox&&(this.options.attachDelay=0)},attach:function(){var e=this;if(this.options.disableEvents)return;this.$el.on(this.options.popInEvent,function(){e.options.popInOpened||e.popIn()}),this.$el.on(this.options.popOutEvent,function(){e.popOut()})},stylize:function(e){return s(".bv-dropdown-style-sliderTextOverflow").each(function(){s(this).remove()}),'<div class="bv-dropdown-style-'+this.options.dimensionStyle+'-inner" >'+e+"</div>"},setDropdownEvents:function(){var e=this;this.$dropdownContainer.find(".bv-close-btn").on("click",function(){e.popOut()})},dimensionFilters:{containerOverflow:function(e,t){var n={position:"absolute",opacity:0},r=s(e),i=s(t),o=r.offset(),u=i.offset(),a,f;return n.width=i.outerWidth()+20,n.left=u.left-10,n.top=o.top+r.outerHeight(!0)+30,a={width:n.width-22},f={left:o.left-n.left+r.outerWidth(!0)/2},{outer:n,inner:a,arrow:f}},helperTextOverflow:function(e,t){var n={position:"absolute",opacity:0},r=s(e),i=s(t),o=r.offset(),u=i.offset(),a,f,l=i.outerWidth()/3-20;n.width=l;if(r[0].name!=="reviewtext")n.left=u.left-l;else{var c=document.getElementsByClassName("bv-sidebar-disabled");c.length>0?n.left="-206px":n.left="20px"}return r[0].name!=="reviewtext"?(n.top=o.top-30,n.maxHeight=s("#bv-mbox-lightbox-list")[0].clientHeight-75):(n.top=335,n.maxHeight=s("#bv-mbox-lightbox-list")[0].clientHeight-n.top-50),this.$innerContainer.outerHeight()>n.maxHeight&&(n.overflowY="scroll"),a={width:l-21},f={left:l-10,top:10},navigator.maxTouchPoints>=2&&navigator.platform==="MacIntel"&&(n.left="5px",a.width>170&&(a.width="170px",f.left=180)),{outer:n,inner:a,arrow:f}},sliderTextOverflow:function(e,t){var n={position:"absolute",opacity:0},r=s(e),i=s(t),o=r.offset(),u,a;return n.width=i.outerWidth()/4,n.left=o.left+r.outerWidth(!0)/2-n.width/2+10,n.top=o.top-10-r.outerHeight(!0),u={width:n.width-22},a={left:o.left-n.left+r.outerWidth(!0)/2-2},{outer:n,inner:u,arrow:a}}},adjustFilters:{sliderTextOverflow:function(){var e=parseInt(this.$innerContainer.css("lineHeight").replace("px",""),10)+25,t=this.$innerContainer.outerHeight(),n;t>e&&(n=parseInt(this.$dropdownContainer.css("top").replace("px",""),10)+e-t,this.$dropdownContainer.css("top",n+"px !important;")),this.injectedArrayDimension&&(this.injectedArrayDimension.top=t-2)}},injectArrowStyles:function(e){var t=document.createElement("div");t.classList.add("bv-fieldset-arrow-icon"),t.style.setProperty("left",e.left+"px","important"),e.top&&t.style.setProperty("top",e.top+"px","important"),s("#"+this.id+" div").before(t),this.injectedArrayDimension=e},addStyles:function(){var e=this.dimensionFilters[this.options.dimensionStyle].call(this,this.options.positionTarget,this.options.outerContainer);this.$dropdownContainer.css(e.outer),this.$innerContainer.css(e.inner),this.injectArrowStyles(e.arrow)},popIn:function(){var e=this,r=this.options.attachDelay,o=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);s(function(){var u,f;e.render(),e.$target[0].name==="reviewtext"?s("#bv-mbox-lightbox-list").append(e.$dropdownContainer):s(n()).append(e.$dropdownContainer),e.$target[0].name==="videourl"&&s("#bv-video-guidelines-label").append(e.text).find("ul").attr("id","bv-media-guidelines-ul"),e.$target[0].name==="photo"&&s("#bv-photo-guidelines-label").append(e.text).find("ul").attr("id","bv-media-guidelines-ul"),e.$target[0].name==="reviewtext"&&s("#bv-review-guidelines-label").append(e.text).find("ul").attr("id","bv-media-guidelines-ul"),o&&(e.$target[0].name==="reviewtext"?e.$target[0].setAttribute("aria-describedby","bv-review-guidelines-label bv-media-guidelines-ul"):e.$target[0].setAttribute("aria-describedby","bv-media-guidelines-ul")),u=function(){e.addStyles()},u(),s(t).on("resize."+e.id,i.debounce(u,200)),e.$compatContainer.outerHeight()<=0&&e.$compatContainer.css("height",e.$innerContainer.outerHeight()),e.$target.off(e.escKeyEventName).on(e.escKeyEventName,function(t){t.keyCode===a.ESCAPE&&(t.preventDefault(),t.stopImmediatePropagation(),e.popOut())});if(!e.options.alwaysShow){f=e.$dropdownContainer.offset();if(f.top<0||f.left<0)return}e.options.popInOpened=!0,setTimeout(function(){var t;e.$dropdownContainer.addClass(e.options.popinClass),e.$dropdownContainer.addClass(e.options.popinClass+"-"+e.options.dimensionStyle),t=e.adjustFilters[e.options.dimensionStyle],t&&t.apply(e)},r)})},popOut:function(){var e=this,n=this.options.detachDelay,r,i=this.$target.attr("id")?this.$target.attr("id"):[];this.$dropdownContainer&&this.$dropdownContainer.addClass(this.options.popoutClass),i.indexOf("bv-textarea-field-reviewtext")<-1&&this.$target.attr({"aria-describedby":null}).off(this.escKeyEventName),s(t).off("resize."+e.id),r=this.$dropdownContainer,e.options.popInOpened=!1,setTimeout(function(){r&&r.remove(),e.injectedArrayDimension=null},n)},render:function(){var t=o({text:this.options.stylize?this.stylize(this.text):this.text,version:e.get("config").version,dropdownId:this.id,autoOpen:this.options.autoOpen});this.$dropdownContainer=s(t),this.$innerContainer=this.$dropdownContainer.find(".bv-popup"),this.$compatContainer=this.$dropdownContainer.find(".bv-compat"),this.$innerContainer.addClass("bv-dropdown-style-"+this.options.dimensionStyle),this.addStyles(),this.setDropdownEvents(),this.options.inModestBox&&this.$dropdownContainer.addClass(this.options.inModestBoxClass)},close:function(){this.$dropdownContainer&&this.popOut()}})}),BV.define("bv/c2013/view/dropdownable",["framework/bview","jquery","lds","bv/ui-core/textDropdown"],function(e,t,n,r){return e.extend({name:"dropdownable",options:{inModestBox:"data-bv-dropdown-inmbox",autoOpen:"data-bv-dropdown-autoopen",positionTarget:"data-bv-dropdown-position-target",disableEvents:"data-bv-dropdown-disable-events",alwaysShow:"data-bv-dropdown-always-show",style:"data-bv-dropdown-style",text:"data-bv-dropdown-text"},dataAttributes:"inModestBox autoOpen positionTarget disableEvents alwaysShow style text".split(" "),template:function(){return""},render:function(){},dropdowns:{},getHashId:function(){var e=this.parent;return[e.name,e.uniq,this.name,this.uniq].join("_")},_createDropdown:function(e,t){var n=new r({autoOpen:t.autoOpen,el:e,text:t.text,outerContainer:this.parent.$el[0],inModestBox:t.inModestBox,dimensionStyle:t.style,positionTarget:t.positionTarget,disableEvents:t.disableEvents,alwaysShow:t.alwaysShow});return this.dropdowns[this.getHashId()]=n,n},_deleteDropdown:function(){delete this.dropdowns[this.getHashId()]},attach:function(r){var i=this;return this.$base=this.parent.$el,this.targetEls=this.$base.find("["+this.options.text+"]"),this.targetEls.each(function(){var e=t(this),r={};n.each(i.dataAttributes,function(t){var n=e.attr(i.options[t]);r[t]=n===""||n==="true"||n,r[t]==="false"&&(r[t]=!1)}),r.alwaysShow!==!1&&(r.alwaysShow=!0),r.positionTarget?r.positionTarget="#"+r.positionTarget:r.positionTarget=this,i._createDropdown.call(i,this,r)}),e.prototype.attach.apply(this,arguments)},_getDropdown:function(){return this.dropdowns[this.getHashId()]},popIn:function(){var e=this._getDropdown();e&&e.popIn()},popOut:function(){var e=this._getDropdown();e&&e.popOut(),this._deleteDropdown()}})}),BV.define("mappings!submission/views",["bv/c2013/view/submission","bv/c2013/view/thankYouPage","bv/c2013/view/dropdownable"],function(e,t,n){var r={submission:{name:"submission",view:e},thankYouPage:{name:"thankYouPage",view:t},dropdownable:{name:"dropdownable",view:n},starHoverHeatMap:{name:"starHoverHeatMap",has:{name:"starHoverHeatMap"}},submissionPreview:{name:"submissionPreview",has:{name:"submissionPreview"}},reviewHelperText:{name:"reviewHelperText",has:{name:"reviewHelperText"}},mbox:{name:"mbox",has:{name:"mbox"}}};return r}),BV.define("bv/util/xdmPost",["ENV","lds","jquery","bv/util/withRPC","bv/api","util/url","body","bv/strings"],function(e,t,n,r,i,s,o,u){function a(e,t){var i=n.Deferred(),s=n.Deferred(),o;t.callback=u.rpc.postCallback;var a=r(s,function(e){var t;c(a,o);if(e&&e.HasErrors===!1)i.resolve(e);else{if(e&&e.HasErrors){t=e.Errors[0].Code,i.reject(t,e);return}i.reject("APIERROR",e)}});return s.then(function(){o=l(e,t,a.channel),o[0].submit()},function(){c(a,o),i.reject("RPCERROR")}),i.promise()}function f(n,r){var s=i._config,o="https:"+s.baseUrl+n,u=e.get("config").locale,f={passkey:s.passkey,apiversion:s.apiversion,displaycode:s.displaycode||"",ve:s.virtualEnvironment||""};return u&&(f.locale=u),a(o,t.assignIn(f,r))}function l(e,r,i){var u=n('<form action="'+s.caboose(e)+'" target="bv-submission-target-'+t.escape(i)+'" method="POST"/>');return t.forEach(r,function(e,n){u.append('<input type="hidden" name="'+t.escape(n)+'" value="'+t.escape(e)+'"/>')}),u.appendTo(o()),u}function c(e,t){try{e.destroy(),t.remove()}catch(n){}}return{raw:a,api:f}}),BV.define("bv/ugc/feedback",["ENV","lds","bv/util/session","bv/util/loadingOverlay","bv/api","bv/util/xdmPost","window","util/url","jquery"],function(e,t,n,r,i,s,o,u,a){function l(e){var t=a.Deferred(),r=t.promise(),i=e.contentType+"-"+e.feedbackType.charAt(0)+"-"+e.contentId;return n.get("feedbacks",function(s){s=s||{},r.done(function(){s[i]=e.feedbackType==="inappropriate"?!0:{c:e.newCount,v:e.vote.charAt(0)},n.set("feedbacks",s)});var o=s[i];o?t.resolve("DUPLICATE",o):c(t,e)}),r}function c(e,n){var r=t.clone(n);delete r.newCount,s.api("submitfeedback.json",r).then(function(t){e.resolve(!1,t)},function(t,n){e.reject(t,n)})}var f=e.get("config");return{positive:function(e,t,n){return l({contentType:e,contentId:t,feedbackType:"helpfulness",vote:"positive",newCount:n})},negative:function(e,t,n){return l({contentType:e,contentId:t,feedbackType:"helpfulness",vote:"negative",newCount:n})},inappropriate:function(e,t){return l({contentType:e,contentId:t,feedbackType:"inappropriate"})}}}),BV.define("mf!bv/c2013/messages/postSubmission",["vendor/messageformat","framework/util/bvtrackerqueue"],function(e,t){return{contentSubmitted_review:function(e){try{return function(e){var t="";return t+="Votre avis a bien été soumis !",t}(e||{})}catch(n){return t.push(["error",new Error("MF error on `contentSubmitted_review`: "+n.toString())]),""}},contentSubmitted_comment:function(e){try{return function(e){var t="";return t+="Votre commentaire a été soumis !",t}(e||{})}catch(n){return t.push(["error",new Error("MF error on `contentSubmitted_comment`: "+n.toString())]),""}},contentSubmitted_question:function(e){try{return function(e){var t="";return t+="Votre question a été soumise !",t}(e||{})}catch(n){return t.push(["error",new Error("MF error on `contentSubmitted_question`: "+n.toString())]),""}},contentSubmitted_answer:function(e){try{return function(e){var t="";return t+="Votre réponse a été soumise !",t}(e||{})}catch(n){return t.push(["error",new Error("MF error on `contentSubmitted_answer`: "+n.toString())]),""}},postSubmission_unknownError:function(e){try{return function(e){var t="";return t+="Une erreur s'est produite. Veuillez réessayer plus tard.",t}(e||{})}catch(n){return t.push(["error",new Error("MF error on `postSubmission_unknownError`: "+n.toString())]),""}},postSubmission_errorOffScreenText:function(e){try{return function(e){var t="";return t+="Appuyez sur Échap pour revenir au formulaire.",t}(e||{})}catch(n){return t.push(["error",new Error("MF error on `postSubmission_errorOffScreenText`: "+n.toString())]),""}},postSubmission_unrecoverableErrorOffScreenText:function(e){try{return function(e){var t="";return t+="Appuyez sur Échap pour fermer ce message",t}(e||{})}catch(n){return t.push(["error",new Error("MF error on `postSubmission_unrecoverableErrorOffScreenText`: "+n.toString())]),""}},duplicateContent:function(e){try{return function(e){var t="";if(!e)throw new Error("MessageFormat: No data passed to function.");var n="Gender",r=e[n],i=0,s={other:function(e){var t="";return t+="Vous avez déjà soumis un avis sur ce produit. Merci !",t}};return t+=(s[r]||s.other)(e),t}(e||{})}catch(n){return t.push(["error",new Error("MF error on `duplicateContent`: "+n.toString())]),""}},unavailableSubmission:function(e){try{return function(e){var t="";return t+="La fonction de soumission n'est actuellement pas disponible.",t}(e||{})}catch(n){return t.push(["error",new Error("MF error on `unavailableSubmission`: "+n.toString())]),""}},mprs_error_token_expired:function(e){try{return function(e){var t="";return t+="L'avis a expiré.",t}(e||{})}catch(n){return t.push(["error",new Error("MF error on `mprs_error_token_expired`: "+n.toString())]),""}},userVerified:function(e){try{return function(e){var t="";if(!e)throw new Error("MessageFormat: No data passed to function.");var n="Gender",r=e[n],i=0,s={other:function(e){var t="";return t+="Merci ! Votre contenu a bien été authentifié.",t}};return t+=(s[r]||s.other)(e),t}(e||{})}catch(n){return t.push(["error",new Error("MF error on `userVerified`: "+n.toString())]),""}},userAlreadyVerified:function(e){try{return function(e){var t="";return t+="Cette adresse email a déjà été vérifiée.",t}(e||{})}catch(n){return t.push(["error",new Error("MF error on `userAlreadyVerified`: "+n.toString())]),""}},ariaTitle_answer:function(e){try{return function(e){var t="";return t+="Répondre à cette question",t}(e||{})}catch(n){return t.push(["error",new Error("MF error on `ariaTitle_answer`: "+n.toString())]),""}}}}),BV.define("bv/ugc/submission",["ENV","mappings!submission/views","bv/util/submissionSubviews","lds","bv/api/fetch","bv/util/user","bv/util/contentType","bv/util/session","bv/ui-core/modestbox","bv/ui-core/focusableview","bv/ugc/feedback","bv/util/formMemory","bv/util/loadingOverlay","bv/util/productInfo","mf!bv/c2013/messages/postSubmission","mf!bv/c2013/messages/submission","jquery","framework/util/bvtracker","bv/c2013/view/contentItem","bv/c2013/model/contentItem","BV","client!util/cookie","util/md5"],function(t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){function k(e){var t=this,n=e.view,r=e.response,s,a,c,p,d;if(!n)return;s=n.getFeatureView("thankYouPage"),a=v["contentSubmitted_"+u.noun(n.model.get("contentType"))](),s.model.set("message",a),s.model.set("offScreenText",v.postSubmission_unrecoverableErrorOffScreenText()),g(".bv-submission-section").attr("aria-hidden",!0),s.afterClose=function(){r.Author=o.getAuthor(),n.previewSubmission(r)},s.afterHide=function(){var e;t.isGenericSubmission&&!t.closeAllPostSubmission&&(e=n.getFeatureView("submission"),_(e),_(s)),l.deregisterFocusableLayer(),g(".bv-submission-section").removeAttr("aria-hidden")},d=!0,n&&"closeAllPostSubmission"in n&&(d=n.closeAllPostSubmission),s&&(c=f.get("lightbox"),c.once("afterClose",s.afterClose),p=i.assignIn({},N,{view:s,breadcrumbs:this.breadcrumbs,titleIcon:s.model.get("icon"),closeAll:d,autoFocus:!1,afterShow:function(){var e=this;setTimeout(function(){var t="#"+e.box.injectionId,n=[t+" .bv-mbox-close.bv-focusable",t+" .bv-mbox-current .bv-focusable"].join(", ");l.registerFocusableLayer(g(document),n),D()},300)},afterHide:function(){s.afterHide()}}),c.replaceOrOpen(p)),h.forget()}function L(e){var t=e.view,n=e.message||v.postSubmission_unknownError(),s=!!e.isRecoverable,o=f.get(t.ModestBoxId),u=v[s?"postSubmission_errorOffScreenText":"postSubmission_unrecoverableErrorOffScreenText"],a=new r.SubmissionMessageView({componentId:t.componentId,message:n,offScreenText:u(),classList:["unknown-error"],icon:"&#x2718;",isMobile:t.model.get("isMobile")}),c=i.assignIn({},N,{view:a,autoFocus:!1,afterShow:D(),afterHide:function(e){var t=e.box.layers,n=i.last(t),r;t.length>0&&(n===e&&t.length>1&&(n=t[t.length-2]),r=n.$target.find(".bv-focusable"),setTimeout(function(){l.moveFocus(r)},500))}});o[s?"pushOrOpen":"replaceOrOpen"](c)}function A(e,t){var n=t==="duplicate",s=n?v.duplicateContent():v.mprs_error_token_expired(),o=f.get("lightbox"),u=new r.SubmissionMessageView({componentId:e.get("componentId"),message:s,offScreenText:v.postSubmission_unrecoverableErrorOffScreenText(),classList:["duplicate"],icon:"&#x2718;",isMobile:e.get("isMobile")}),a=i.assignIn({},N,{view:u,autoFocus:!1,closeUrl:e.closeUrl||null,duplicatePage:n,afterShow:D()});o.pushOrOpen(a),n&&y.pageview({type:"Product",label:"Lightbox",value:"AlreadySubmitted",context:"Write",productId:d.getId(this)})}function O(e,t){var n,s,o;if(t==="duplicate"||t==="expired")return A(e,t);n=new r.SubmissionMessageView({componentId:e.get("componentId"),message:v.unavailableSubmission(),offScreenText:v.postSubmission_errorOffScreenText(),classList:["unavailable"],icon:"&#x2718;",isMobile:e.get("isMobile")}),i.isFunction(e.get("clientAPIConfig").onShow)?e.get("clientAPIConfig").onShow(n):(s=f.get("lightbox"),o=i.assignIn({},N,{view:n,autoFocus:!1,closeUrl:e.closeUrl||null,submissionUnavailablePage:!0,afterShow:D()}),s.pushOrOpen(o)),y.pageview({type:"Product",label:"Lightbox",value:"Unavailable",context:"Write",productId:d.getId(this)})}function M(e,n){var r=t.get("componentManager").find(e),s=u.noun(r.contentType),o=new w(i.assignIn({component:r,name:"dummy"},n)),a=new b({model:o,config:o,classList:["content-top-"+s],tag:"div",views:[]});return a}function _(e){e&&(e.undelegateEvents(),e.$el.remove(),e.remove())}function D(){setTimeout(function(){var e=g(".bv-submission-message-container");e.length&&l.moveFocus(e)},1e3),setTimeout(function(){l.moveFocus(g("#bv-mbox-lightbox-list .bv-mbox-close"))},12500)}function P(e,s){var o=e.toJSON().subject||{},a=t.get("componentManager").find(e.get("componentId")),l,c,h,p,v,b,w,T,C,A,O,_,D,P,H,B,j,F="bvcoppa_"+x(t.get("config").clientname+t.get("config").deploymentId),I,q;if(!a)return;l="closeAllPostSubmission"in s?s.closeAllPostSubmission:!0,c=new n.submission.view({model:e,contentType:a.contentType,componentId:a.componentId,parent:{name:a.type,containerId:s&&s.containerId?s.containerId:a.container},inline:s&&s.inline||a.inline&&g("#"+a.container).length,classList:[o.ImageUrl?"submission-image":"submission-noimage"],isGenericSubmission:!!s.isGenericSubmission,closeAllPostSubmission:l});if(t.get("config").restrictSubmissionByAge&&S.read(F)){I={view:c,message:m.error_ERROR_PARAM_INVALID_ATTRIBUTE(),isRecoverable:!1},L(I);return}c.on("showthankyoupage",k,s),c.on("showcannotsubmitpage",L),c.rpc||c.setupRPC(),a.contentType==="Answers"&&(h=M("questionContentList1",e.get("subjectData")),o.Url=e.closeUrl||""),a.contentType==="Comments"&&c.ModestBoxId==="lightbox"&&(q=t.get("componentManager").hasOwnProperty("reviewSummary1")?"reviewSummary1":a.componentId,p=M(q,e.get("subjectData"))),v=!0,b=e.get("clientAPIConfig").onShow,i.isFunction(b)&&(v=b(c)),v&&(w=f.get(c.ModestBoxId),T=u.noun(e.get("contentType")),m["aria_header_"+T]&&o.Name&&(C=m["aria_header_"+T]({productName:o.Name})),A=E._internal.container&&!t.get("config").siteAuth[T],O=window.history.length-1,w.once("afterClose",function(e){if(T==="answer"){e.goBackUponClose=A;return}if(A&&O>1)try{window.history.go(O-window.history.length)}catch(t){window.location.href=s.returnUrl||"about:blank"}else!e.opened&&s.returnUrl&&(window.location.href=s.returnUrl)}),_=null,o.ImageUrl&&!c.inline&&(_=new r.SidebarView({model:e})),D=null,c.parent.containerId&&(D=g("#"+c.parent.containerId)),P=i.bind(i.once(c.formSetup),c),H=[c],h&&H.unshift(h),p&&H.unshift(p),B=o.Name||"",j=i.assignIn({},N,{title:m["header_"+T]({productNameAvailable:!!B,productName:B}),ariaTitle:C,submissionPage:!0,ariaLabeledBy:"bv-mbox-breadcrumb-item",classList:["content-submission-"+T],views:H,sidebar:_,inline:c.inline,autoFocus:!1,container:D,closeUrl:E._internal.container?o.Url||t.get("config").homePageUrl:null,ariaDialog:!0,showCloseButton:s&&typeof s.closable!="undefined"?s.closable:!0,breadcrumbs:s.breadcrumbs,beforeShow:function(){P(),c.trigger("viewready")},afterShow:function(){c.trigger("viewshown")},afterHide:function(){c.cleanup(),y.feature({type:"Used",name:"Close",detail1:"Submission",detail2:"Lightbox",bvProduct:d.getTypeByContentType(T),productId:s.productId,categoryId:d.getCategoryId({model:e})})}}),w.once("beforeClose",function(){c.trigger("viewclosed")}),s.push?w.pushOrOpen(j):w.replaceOrOpen(j))}var T,N,C=t.get("mappings");return t.set("mappings",g.extend(!0,{},C,n)),N={},T=i.debounce(function(e,t){a.setup();if(e.attributes.clientAPIConfig.hasExpired){O(e,"expired");return}e.off("loadsucceeded").on("loadsucceeded",function(e){var n=s.get("products",e.attributes.clientAPIConfig.productId).limitTo(1);n.fetch("subject").done(function(r){e.closeUrl=r.data.Results[0].Url,P(e,t)})}),e.off("loadfailed").on("loadfailed",function(e,t){var n=s.get("products",e.attributes.subjectId).limitTo(1);n.fetch("subject").done(function(r){e.closeUrl=r.data.Results[0].Url,O(e,t)})}),e.trigger("load")},300,!0),{createContentItemView:M,feedback:c,thankYouPage:k,lightbox:function(e,t){t&&!t.silentMode&&p.show(),g(function(){T(e,t)})}}}),BV.define("bv/ugc/hostedAuthLink",["ENV","lds","jquery","BV","$BV","bv/ui-core/modestbox","mf!bv/c2013/messages/postSubmission","bv/c2013/view/submissionMessage","bv/util/user","util/url","window","framework/util/bvtracker","bv/util/domainPolice"],function(t,n,r,i,s,o,u,a,f,l,c,h,p){function v(e){return e==="DUPLICATE"?u.userAlreadyVerified:u.postSubmission_unknownError}function m(){var e=t.get("config"),n=l.getParam(c.location.href,"bvnotificationId")||l.getBvParam(c.location.href,"notificationId"),r=l.getParam(c.location.href,"bvmessageType")||l.getBvParam(c.location.href,"messageType"),i=l.getParam(c.location.href,"bvrecipientDomain")||l.getBvParam(c.location.href,"recipientDomain"),s=t.get("appRouter").clientAPIConfig.campaignId||"";h.feature({type:"Shown",name:"Confirmation",bvProduct:"RatingsAndReviews",notificationId:n,messageType:r,recipientDomain:i,userLocale:e.locale,campaignId:s})}var d;return d={lightbox:function(n,s,h){var p=t.get("componentManager"),d=p.find(function(t){return t.type==="submission"}),g=n?"&#x2714;":"&#x2718;",y=n?u.userVerified:v(s),b=n?["thankyou"]:["unknown-error"];r(function(){var t,r;n&&h&&(f.clear({silent:!0}),f.save({token:h})),t=new a({componentId:d.componentId,message:y(),classList:b,icon:g}),r=o.get("lightbox"),r.once("afterClose",function(){i._internal.container||(c.location=l.splice(c.location.href,"bv_authtoken"))}),r.open({view:t}),m()})}},d}),BV.define("bv/ugc/authUser",["bv/util/xdmPost","bv/ugc/hostedAuthLink","bv/util/loadingOverlay"],function(e,t,n){function r(r){function s(e){var n=e.Authentication.User;t.lightbox(!0,null,n)}function o(e){var n={ERROR_BAD_REQUEST:"DUPLICATE"},r=n[e]||e;t.lightbox(!1,r)}var i=r.authToken;n.show(),e.api("authenticateuser.json",{authtoken:i}).then(s,o)}return r}),BV.define("bv/util/unsubscribePost",["ENV","BV","lds","jquery","bv/util/withRPC","bv/api","util/url","bv/strings","framework/util/bvtracker"],function(t,n,r,i,s,o,u,a,f){function l(e,r){var i,s,f=t.get("config"),l=n._options.notifications.passkey,c=f.clientname,h=f.unsubscribeAllMessageTypes,p;return h?p="ALL":p=r||"PIE",i=o._config.notificationsUrl,s={passkey:l,userToken:e,emailType:p,callback:a.rpc.postCallback},u.join("https:"+i,c,"subscriptions/unsubscribe?"+u.stringifyObject(s))}function c(){var e=t.get("config"),n=u.getParam(window.location.href,"bvnotificationId")||u.getBvParam(window.location.href,"notificationId"),r=u.getParam(window.location.href,"bvmessageType")||u.getBvParam(window.location.href,"messageType"),i=u.getParam(window.location.href,"bvrecipientDomain")||u.getBvParam(window.location.href,"recipientDomain"),s=t.get("appRouter").clientAPIConfig.campaignId||"";f.feature({type:"Shown",name:"Unsubscribe",bvProduct:"RatingsAndReviews",notificationId:n,messageType:r,recipientDomain:i,userLocale:e.locale,campaignId:s})}function h(e,t){var n=i('<form action="'+u.caboose(e)+'" target="bv-submission-target-'+r.escape(t)+'" method="POST" />');return n.appendTo("body"),n}function p(e,t){try{e.destroy(),t.remove()}catch(n){}}function d(e,t){var n,r,o=i.Deferred(),u=i.Deferred(),a;return c(),n=l(e,t),r=s(u,function(t){p(r,a),t?o.resolve(t):o.reject("APIERROR")}),u.then(function(){a=h(n,r.channel),a.trigger("submit")},function(){p(r,a),o.reject("RPCERROR")}),o.promise()}return d}),BV.define("mf!bv/c2013/messages/unsubscribe",["vendor/messageformat","framework/util/bvtrackerqueue"],function(e,t){return{userUnsubscribed:function(e){try{return function(e){var t="";return t+="Vous ne serez plus sollicité(e) à cette adresse email pour les études et sondages Orange.",t}(e||{})}catch(n){return t.push(["error",new Error("MF error on `userUnsubscribed`: "+n.toString())]),""}},unsubscribe_unknownError:function(e){try{return function(e){var t="";return t+="Une erreur s'est produite. Veuillez réessayer plus tard.",t}(e||{})}catch(n){return t.push(["error",new Error("MF error on `unsubscribe_unknownError`: "+n.toString())]),""}}}}),BV.define("hbs!unsubscribeMessage",["hbs","vendor/handlebars/runtime","template/helpers/view"],function(e,t){var n=t.template(function(e,t,n,r,i){function p(e,t){var r="",i;r+=' <hgroup class="bv-submission-message"> <h1 class="bv-submission-icon" aria-hidden="true">',(i=n.icon)?i=i.call(e,{hash:{}}):(i=e.icon,i=typeof i===f?i.apply(e):i);if(i||i===0)r+=i;return r+='</h1> <h2 id="bv-mbox-label-text" class="bv-submission-text">',(i=n.message)?i=i.call(e,{hash:{}}):(i=e.message,i=typeof i===f?i.apply(e):i),r+=l(i)+"</h2> </hgroup> ",r}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers;var s="",o,u,a,f="function",l=this.escapeExpression,c=this,h=n.helperMissing;a={hash:{tag:"div",classList:"submission submission-message-container focusable",tabindex:"-1"},inverse:c.noop,fn:c.program(1,p,i)},u=(o=n.view,o?o.call(t,t,a):h.call(t,"view",t,a));if(u||u===0)s+=u;return s+=" ",s});return t.registerPartial("unsubscribeMessage",n),n.deps=[],n.tplMountedViews=[],n}),BV.define("bv/c2013/view/unsubscribeMessage",["ENV","framework/bmodel","framework/bview","hbs!unsubscribeMessage"],function(e,t,n,r){return n.extend({name:"UnsubscribeMessage",template:r,init:function(e){var n=this.getComponent();this.model=new t({name:"UnsubscribeMessage",message:e.message,icon:e.icon,componentId:this.componentId,component:n,contentType:n.contentType})}})}),BV.define("bv/ugc/unsubscribeView",["ENV","lds","jquery","bv/ui-core/modestbox","mf!bv/c2013/messages/unsubscribe","bv/c2013/view/unsubscribeMessage","bv/util/user","util/url","window","bv/ui-core/focusableview"],function(e,t,n,r,i,s,o,u,a,f){function c(e,t){return e?i.userUnsubscribed:i.unsubscribe_unknownError}function h(t,i){function p(){var e;t,e=new s({icon:a,message:l(),classList:h,componentId:u.componentId}),r.get("lightbox").open({view:e,autoFocus:!1,showCloseButton:!1,afterShow:function(){setTimeout(function(){var e=n(".bv-submission-message-container");e.length&&f.moveFocus(e)},100)}})}var o=e.get("componentManager"),u=o.find(function(e){return e.type==="submission"}),a=t?"&#x2714;":"&#x2718;",l=c(t,i),h=t?["thankyou"]:["unknown-error"];n(p)}var l;return l={success:function(){h(!0)},failure:function(e){h(!1,e)}},l}),BV.define("bv/ugc/unsubscribeUser",["ENV","BV","jquery","lds","util/url","bv/api","bv/util/unsubscribePost","bv/ugc/unsubscribeView","bv/util/loadingOverlay","bv/strings","framework/util/bvtracker"],function(e,t,n,r,i,s,o,u,a,f,l){function c(e){var t=e.unsubscribeToken,n=e.emailType;a.show(),p(t,n).then(function(e){u.success()},function(e){u.failure(e)})}function h(e,t){function n(){e.state()!=="resolved"&&(l.error({name:f.errors.TIMEOUT,detail1:"Unsubscribe",detail2:"Token: "+t}),e.reject("timeout"))}return r.delay(n,1e4)}function p(e,t){var r=n.Deferred(),i=h(r,e);return o(e,t).then(function(e){clearTimeout(i),r.resolve(e)},function(e){r.reject(e)}),r.promise()}return c}),BV.define("bv/ugc/submit/urlForClientContainer",["util/url"],function(e){function t(t,n,r){var i=e.hash(t),s=e.withoutHash(t);i&&(i=i.replace(/(?:\?|&)$/,""));var o=/(?:\?|&)$/.exec(s);o||(s+=s.indexOf("?")>-1?"&":"?");var u=s+n.substr(1);return u+=i.length>0?i:r,u}return t}),BV.define("bv/ugc/container",["ENV","jquery","lds","util/url","window","body","framework/util/bvtracker","BV","bv/api","bv/util/urlstate","bv/util/domainPolice","bv/util/session","bv/util/normalizeParams","bv/util/loadingOverlay","bv/ui-core/modestbox","bv/ugc/submit/urlForClientContainer","bv/strings","bv/util/userToken","vendor/moment"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){function T(e){return e.replace(/.*\//,"")}function N(){var e=b.match("(/bvstaging)?/[^/]+/([^/]+)/[^/]+.htm"),t=e?decodeURIComponent(e[2]):undefined;return{config:{productId:t},action:"rr_submit_review"}}function C(e,n){var r=new Error(n);o.error({name:m.errors[e],detail1:n}),t(s()).addClass("bv-container-error"),i.console&&console.error&&console.error("BV: Error: ",n)}function k(){function r(r){var s=r.closeUrl||e.get("config").homePageUrl;n.delay(function(){if(document.referrer!==""&&r.goBackUponClose&&t>1)try{i.history.go(t-i.history.length)}catch(e){i.location.href=s||"about:blank"}else!r.opened&&s&&(i.location.href=s)},500)}var t=i.history.length-1;d.get("lightbox").on("afterClose",r).on("changeTitle",function(e,t,n){document.title=t})}function L(){var e=b.match("(/bvstaging)?/answers/[^/]+/([^/]+)/([^/]+)/askquestion.htm"),t=e?decodeURIComponent(e[2]):undefined,n=e?decodeURIComponent(e[3]):undefined,r={config:{subjectType:t},action:"qa_submit_question"};return r.config[t+"Id"]=n,r}function A(e){var t=S[w]();t.config.campaignId=f.get("campaignid")||"",$BV.ui("",t.action,n.assignIn({},e,t.config))}function O(t){var s=f.bvParams("bv"),o=s.action||t.action,u=n.assignIn({},t,h(s)),a=r.caboose(u.containerPageUrl),c;delete u.action;if(!a||!l.allowedDomain(a))a=e.get("config").container.url;x[o]&&(u.containerId="BVQAContainer");if(u.hosted&&a){c=v(a,i.location.search,i.location.hash),i.location.replace(c);return}o?$BV.ui("",o,u):C("IMPLEMENTATION","The 'bvaction' parameter is not present in the URL, so we can't determine which action to take. Please ensure that URL parameters exist and were not stripped by an HTTP redirect.")}function M(t){var n=e.get("config").container,s=n.url,o=r.origin+i.location.pathname;if(s&&l.allowedDomain(s)&&s.indexOf(o)===-1&&i.location.href.indexOf("bvnotificationId")===-1){i.location.replace(s+i.location.search.substr(1)+i.location.hash);return}$BV.ui("global","auth_user",{authToken:t})}function _(e,t){$BV.ui("global","unsubscribe_user",{unsubscribeToken:e,emailType:t})}function D(e){var t=e.match(/maxage=\d{1,}/),n=t?t[0].replace("maxage=",""):1,r=e.match(/date=\d{4}-?\d{2}-?\d{2}/),i,s,o;return r?(i=r[0].replace("date=",""),s=y().valueOf(),o=y(i,"YYYYMMDD").add("d",n).valueOf(),s>o):!0}var b=i.location.pathname.toLowerCase(),w=T(b),E,S={"askquestion.htm":L,"submission.htm":N,"writereview.htm":N},x={qa_submit_question:!0,qa_submit_answer:!0};return E={init:function(o){var a=o.containerId,l=f.get("bv_authtoken"),h=f.get("bv_unsubtoken"),d=o.userToken||f.get("userToken","bv"),v=g.getData(d),m=e.get("config").siteAuth.review&&D(v),y=e.get("config").locale.substring(0,2);o.containerId="BVContainer",t("html").attr("lang",y);if(f.get("mobile","bv")||navigator.userAgent.match(/(iPhone|iPod|Android|BlackBerry)/))u._internal.mobile=!0,t("head").append('<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">');t(function(){var v,g;t(s()).html('<div id="BVContainer" role="main"><div class="bv-inline-form-container bv-cleanslate bv-cv2-cleanslate"/></div>').addClass("bv-standalone-container"),p.show(),k(),v=f.get("eventid","bv"),v&&!d&&c.get(v,function(e){var t;if(e){t=e.returnUrl,c.remove(v),i.location.replace(t);return}});if(l){M(l);return}if(h){g=f.get("emailtype"),_(h,g);return}if(d){o.containerId=a,e.get("config").siteAuth.review&&(o.hasExpired=m);if(v){c.get(v,function(e){var t,s,a;if(e){t=n.assignIn({},o,e),c.remove(v);var f=!0;e.action&&e.action==="swat_submit_review"&&(f=!1),u._internal.mobile&&f?O(t):(s={action:t.action,campaignId:t.campaignId,userToken:d},n.forEach(t,function(e,n){n.match(/Id$/)&&t[n]&&(s[n]=t[n])}),e.isContainer?a=e.returnUrl+"&bvuserToken="+d:a=r.caboose(e.returnUrl)+"bvdata="+encodeURIComponent(r.stringifyObject(s))+r.hash(e.returnUrl),i.location.replace(a))}});return}}o.hosted&&S[w]?A(o):O(o)})}},E}),BV.define("hbs!deeplink",["hbs","vendor/handlebars/runtime"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers;var s="",o,u="function",a=this.escapeExpression;return s+='<div class="bv-deeplink"> <span id="bv-mbox-label-text" class="bv-off-screen">',(o=n.offscreenText)?o=o.call(t,{hash:{}}):(o=t.offscreenText,o=typeof o===u?o.apply(t):o),s+=a(o)+'</span> <div class="bv-compat"> <div id="bv-deeplink-ContentWrapper"></div> <div></div> </div> </div> ',s});return t.registerPartial("deeplink",n),n.deps=[],n.tplMountedViews=[],n}),BV.define("bv/ugc/deeplink",["ENV","framework/bview","lds","bv/ui-core/modestbox","jquery","mf!bv/c2013/messages/common","hbs!deeplink","util/url","framework/util/bvtracker"],function(t,n,r,i,s,o,u,a,f){function c(){var e=t.get("config"),n=a.getParam(window.location.href,"bvnotificationId")||a.getBvParam(window.location.href,"notificationId"),r=a.getParam(window.location.href,"bvmessageType")||a.getBvParam(window.location.href,"messageType"),i=a.getParam(window.location.href,"bvrecipientDomain")||a.getBvParam(window.location.href,"recipientDomain"),s=t.get("appRouter").clientAPIConfig.campaignId||"";f.feature({type:"Shown",name:"DeepLink",bvProduct:"RatingsAndReviews",notificationId:n,messageType:r,recipientDomain:i,userLocale:e.locale,campaignId:s})}var l;return l={lightbox:function(t){s(function(){var n=i.get("lightbox");n.opened&&n.close(),n.open({view:t,beforeShow:function(t){var n=t.box.$layerList,i=o.deeplinkModalTitle(),a=s(u({offscreenText:i}));n.append(a),t.$target.appendTo(a.find("div#bv-deeplink-ContentWrapper")),r.invokeMap(this.views,"formSetup")},afterShow:function(){c()}})})}},l}),BV.define("bv/c2013/_extensions/collection/contentItemCollectionExt",["lds","bv/api/fetch","ENV"],function(e,t,n){var r=50;return{searchContentExt:function(i,s,o,u,a){e.isObject(i)&&(i=this._normalizeSubmissionResponse(i).Title||"");var f=this,l=n.get("config").page.size,c=n.get("config").page.size2n;f.subjectId=u.Id;var h=e.map(a,function(n){var s=t.get(t.nouns(n)).include(["Authors","Products"]).withStatsOn(f.getStatsTypes()).limit(r).searchFor(i);return t.Nouns(n)==="Questions"&&(s=s.include(["Answers"])),!e.isUndefined(u)&&!e.isUndefined(u.Id)&&(t.nouns(u.Type)===t.nouns(n)?s=s.filterBy("id",u.Id):s=s.forProduct(u.Id)),s}),p={Results:[],TotalResults:0},d=t.get("batch",null,h);try{d.fetch("search").done(function(n){var r=[],s=0;e.forEach(a,function(i){var o=e.find(n,function(e){return e.contentType===t.nouns(i)}),u=o.data.Results;r=Array.prototype.concat(r,u),s+=o.data.TotalResults}),r=e.sortBy(r,function(e){return-1*new Date(e.SubmissionTime)}),p={Results:r,TotalResults:s},f.trigger("newresulttotal",p.TotalResults),f.getTopModel().trigger("searchresponse",p,i)})}catch(v){f.trigger("newresulttotal",p.TotalResults),f.getTopModel().trigger("searchresponse",p,i)}},requestRelatedExt:function(n,i,s,o){var u=this;u.subjectId=o.Id;var a=t.get("relatedquestions").include(["Products"]).limit(r).withUser(n._user).withContentType(n._contentType).withSubject(t.Noun(o.Type)+"id",o.Id),f={Results:[],TotalResults:0};try{a.fetch("relatedquestions").done(function(t){var n=e.map(t.Results,function(e){return e.contentType="Questions",e.secondaryContentType="Answers",e.subjectType="Products",e.isRelatedQuestion=!0,e});f={Results:n,TotalResults:t.TotalResults},u.trigger("newresulttotal",f.TotalResults),u.getTopModel().trigger("requestresponse",f,null)})}catch(l){u.trigger("newresulttotal",f.TotalResults),u.getTopModel().trigger("requestresponse",f,null)}},fakeSubmissionSchemaExt:function(e){var n=e.get("secondaryContentType");if(!n)return;var r={Answers:{answertext:{enabled:!0,schema:{Id:"answertext",Label:null,Default:null,MaxLength:1e4,MinLength:0,Options:[],Required:!0,Type:"TextAreaInput",Value:null}}}};e.set({formFields:r[n],shortForm:!0}),e.set(t.noun(n),!0)},fetchPageFromAuthorExt:function(r,i,s){var o=this,u=t.nouns(o.contentType),a={Reviews:"Comments",Questions:"Answers",Answers:"Questions"},f=n.get("config"),l=f.page.details[t.noun(u)]||f.page,c=l.size,h=l.size2n,p=r>1?h:c,d=r>1?c+h*(r-2):0,v=t.get(u).include(["Products","Authors"]).limit(p).offset(d).filterBy("AuthorId",s.Id),m=a[t.Nouns(u)];if(!e.isEmpty(m)){var g=f.page.details[t.noun(m)]||f.page,y=g.size;v=v.include([m]).limitIncluded(m).to(y)}var b={Results:[],TotalResults:0};try{var w=this._getChecksum();v.fetch("author"+u,w).done(function(e){var t=e.data.Results;b={Results:t,TotalResults:e.data.TotalResults},o.reset(b.Results)})}catch(E){o.reset(b.Results)}}}}),BV.define("bv/c2013/_extensions/view/contentItemExt",["ENV","jquery","lds","bv/ui-core/modestbox","bv/util/contentType","bv/util/loadingOverlay","bv/util/productInfo","mf!bv/c2013/messages/submission","mf!bv/c2013/messages/postSubmission","framework/util/bvtracker","bv/util/focusManager"],function(t,n,r,i,s,o,u,a,f,l,c){return{showSecondaryContentExt:function(t,n){var r,i,o,a=this.getTopModel(),f=this.model.get("isRelatedQuestion")||!1;if(this.hasSubmissionView&&f)return;l.feature({type:"Used",name:"Click",detail1:"SecondaryContentLink",detail2:this.model.get("AuthorId"),contentType:this.model.get("Type"),contentId:this.model.get("Id"),bvProduct:u.getType(this),productId:u.getId(this),categoryId:u.getCategoryId(this)}),this.model.set("isSearchResult",!1),r=this.model.clone(),r.set("lazyLoad",!1),i=new t({model:r,tag:"div"});if(this._shouldShowMbWithoutSubmission(n)){this._showModestBox([i]);return}this.model.set("hasSubmission",!0),o=this._getSecondarySubmissionConfig(i),a.trigger("show"+s.noun(this.secondaryContentType)+"submission",o)},onShow:function(t,n){var r=this,i=[t],s=this.model.get("isRelatedQuestion")||!1;return n&&(n.inline&&(i=[]),n.classList.push("fake-inline"),this.contentType==="Answers"&&(n.classList.push("content-item-avatar-offset"),n.classList.push(t.hasFeature("socialAvatar")?"content-item-avatar-offset-on":"content-item-avatar-offset-off"))),i.push(n),r.hasSubmissionView=!0,s?r._showAnswerRequestModule(n):r._showModestBox(i),!1},_getSecondarySubmissionConfig:function(t){var n=this,i=!!BV._internal.mobile||!!navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry)/),o=i?"BV_MOBILE_"+s.Noun(this.model.get("contentType")).toUpperCase()+"_DISPLAY":"BV_"+s.Noun(this.model.get("contentType")).toUpperCase()+"_DISPLAY",u=this.model.get("clientAPIConfig"),a=r.assignIn({},u,{campaignId:o||u.campaignId||""});return a[s.noun(this.model.get("contentType"))+"Id"]=this.model.get("Id"),a.contentType=a.secondaryContentType||this.model.get("secondaryContentType"),delete a.secondaryContentType,a.onShow=r.bind(n.onShow,n,t),a},_showModestBox:function(h){var p=this,d,v,m,g,y,b,w,E,S,x=!1,T="lightbox",N=!1,C=r.last(h);C.name==="submission"&&(x=!0,T=C.ModestBoxId||T,N=C.inline||N),d=t.get("config").siteAuth[s.noun(this.secondaryContentType)]&&!x,v=i.get(T),m=s.noun(this.model.get("secondaryContentType")),v.opened&&v.inline&&v.close(),g="ariaTitle_"+m,y=a["submit_"+m],b=x?y():"",w=f[g]?f[g]():b,E=["secondary-content","content-submission-"+m],d&&E.push("need-user"),S={title:b,views:h,overElement:this.$viewEl,container:this.$viewEl,classList:E,contentType:m,inline:N,autoFocus:!1,showCloseButton:!0,ariaTitle:w,showBreadcrumb:x,submissionPage:x,beforeShow:function(){r.forEach(this.views,function(n){var r=n.$viewEl.find(".bv-content-item-avatar-offset"),i=r.find(".bv-content-btn.bv-content-secondary-btn.bv-focusable");n.formSetup({shortForm:!0});if(x)return;if(n.contentType!=="Questions")return;n.hasFeature("secondarySubmission")||i.addClass("bv-mbox-hide-answer-question-button"),n.model.get("TotalSecondaryContentCount")>=t.get("config").submission.maxAnswers&&!n.$viewEl.find(".bv-question-closed").length&&(n.$viewEl.append('<div class="bv-question-closed">'+p.msgpacks[0].questionCloseForAnswers()+"</div>"),i.addClass("bv-mbox-hide-answer-question-button"))}),r.invokeMap(this.views,"trigger","viewready")},afterShow:function(){r.invokeMap(this.views,"trigger","viewshown"),setTimeout(function(){c.rescanFocusLayer(),c.moveFocus(n(".bv-mbox-close.bv-focusable"))},500)},afterHide:function(){p.getTopModel().set("restoreFocusOnElementId",p.model.attributes.Id),r.each(this.views,function(t){t.cleanup&&t.cleanup()}),l.feature({type:"Used",name:"Close",detail1:"SecondaryContent",detail2:"Lightbox",bvProduct:u.getType(p),productId:u.getId(p),categoryId:u.getCategoryId(p)})}},x&&v.once("beforeClose",function(){C.trigger("viewclosed")}),v.pushOrOpen(S),o.hide()},_showAnswerRequestModule:function(t){var n=this,i,s;t.model.subscribe("contentSubmitted",function(t){n._remove({view:n,message:f.contentSubmitted_answer()})},n),o.hide(),i=n.$viewEl.find(".bv-secondary-submission textarea").val(),t.setElement(n.$viewEl.find(".bv-secondary-submission").empty()),t.render(),s=[n,t],r.forEach(s,function(t){t.formSetup()}),t.$viewEl.find(".bv-fieldset-inner textarea").trigger("focus").val(i)},_shouldShowMbWithoutSubmission:function(n){var i=this.getTopModel();if(this.model.get("IsSyndicated"))return!0;if(this.contentType==="Questions"){if(!this.hasFeature("secondarySubmission"))return!0;if(this.model.get("Answers")&&this.model.get("Answers").TotalResults>=t.get("config").submission.maxAnswers)return!0}return!this.model.get("clientAPIConfig").userToken&&t.get("config").siteAuth[s.noun(this.secondaryContentType)]&&n?!0:this.getComponent().componentId!=="contentSearch1"||!r.isEmpty(i.get("submissionContentTypes"))&&r.indexOf(i.get("submissionContentTypes"),this.secondaryContentType)!==-1?this.getComponent().componentId!=="contentSearch2"||!r.isEmpty(i.get("submissionContentTypes"))&&r.indexOf(i.get("submissionContentTypes"),this.secondaryContentType)!==-1?!1:!0:!0}}}),BV.define("bv/c2013/_extensions/model/searchContentListExt",["ENV","lds","bv/util/pageInfo","bv/util/contentType","jquery"],function(e,t,n,r,i){return{getRequestFn:function(e){var t={Products:this.getContent().searchContent,Reviews:this.getContent().requestRelated,Questions:this.getContent().searchContent,Answers:this.getContent().requestRelated};return t[r.Nouns(e)]},getProcessFn:function(e){var t={Products:this.processContentSearch,Reviews:this.processRelatedQuestions,Questions:this.processContentSearch,Answers:this.processRelatedQuestions};return t[r.Nouns(e)]},fetchPageExt:function(e){var t=this.get("requestModule"),n=this.get("keyword");if(!n&&t!=="answerRequestModule")return;this.componentSet("currentPage",e);var r=this.get("fetchResults"),i={Results:r,TotalResults:r.length};this.getProcessFn(this.get("contentType")).apply(this,[i,n])},_processContent:function(n,r){var i=this.get("requestModule"),s=i==="answerRequestModule"?e.get("config").submission.questionsPageSize:e.get("config").page.size,o=this.componentGet("currentPage")||1,u=s,a=o>1?s*(o-1):0,f=Array.prototype.slice.apply(n.Results,[a,a+u]),l=this._createSearchDisplay(f,r),c=this.updatePageInfo(f);this.set("_noResults",t.isEmpty(l)),this.getContent().reset(l,r),this.trigger("pageinfo",c),this.dataReady(n)},_createSearchDisplay:function(e,n){var i=this;return t.map(e,function(e){e.contentType=r.Nouns(e.Type),e.secondaryContentType=r.Nouns(e.SecondaryType),e.subjectType=i.get("subjectType")||r.Nouns(e.Reference.Type),e.isSearchResult=!0;if(e.Text){var t=e.Text,s=Math.max(t.indexOf(n),0),o=t.length,u=!0,a=!0;s>20?(s-=20,u=!1):s=0,o>s+100&&(o=s+100,a=!1);var f=t.substring(s,o),l=u?0:Math.max(f.indexOf(" "),0),c=a?f.length:Math.min(f.lastIndexOf(" "),f.length);f=f.substring(l,c).trim(),u=l===0,e.trimmed=!1,u||(f="..."+f,e.trimmed=!0),a||(f+="...",e.trimmed=!0),e.shortText=f}return e})},updatePageInfo:function(t){var r=e.get("config").submission.questionsPageSize,i=this.componentGet("currentPage")||1,s=this.get("requestModule")==="answerRequestModule"?n(undefined,i,t.length,this.get("TotalResults"),r):n(undefined,i,t.length,this.get("TotalResults"));return this.set({TotalResults:this.get("TotalResults"),numPages:s.numPages,startResult:s.start},{silent:!0}),s},fetchContent:function(e,t,n){var i=this.getContent(),s=this.get("clientAPIConfig"),o={Type:this.get("subjectType"),Id:s[r.noun(this.get("subjectType"))+"Id"]},u=this.get("coverageContentTypes"),a=[n,t,s,o,u];this.componentSet("currentPage",t),this.unsubscribe("pageto",this.fetchPage),this.subscribe("pageto",this.fetchPage),this.getRequestFn(e).apply(i,a)},appendRelatedQuestion:function(t,n,r){var i=this.get("fetchResults"),s=this.componentGet("currentPage")||1,o=e.get("config").submission.questionsPageSize,u=(s-1)*o+r.index,a=this.getContent(),f=s*o-1;i.splice(u,1),f<i.length&&a.add(i[f],r),this.set("TotalResults",i.length);var l=this.updatePageInfo(a.models);this.trigger("pageinfo",l)}}}),BV.define("bv/c2013/_extensions/view/searchContentListExt",["ENV","jquery","lds","bv/ui-core/modestbox","bv/util/loadingOverlay","bv/util/productInfo","framework/util/bvtracker","bv/util/focusManager"],function(t,n,r,i,s,o,u,a){return{_focusSearchResultsBox:function(t){var r=this,i,s=r.getTopModel().get("restoreFocusOnElementId"),o;setTimeout(function(){t?i=r.$viewEl.find(".bv-content-data-summary .bv-focusable, .bv-secondary-content-link.bv-focusable").eq(0):!s||(o=".bv-focusable[data-contentid="+s+"]:visible",i=r.$viewEl.find(o),r.getTopModel().set("restoreFocusOnElementId",null)),i||(i=n(r.mb.$mboxClose[0])),i&&(a.rescanFocusLayer(),a.moveFocus(i))},2e3)},showContentSearchExt:function(f,l){function w(e){e.views?(y=e.$target.find(".bv-search-text").val(),e.views.includeSubmission||e.$target.find(".bv-content-secondary-btn").addClass("bv-mbox-hide-answer-question-button"),y&&(h=y.split(" ")),r.invokeMap(e.views,"formSetup",{searchFor:h,shortForm:!0})):r.invokeMap(e,"formSetup",{searchFor:h,shortForm:!0})}function E(e){r.each(e.views,function(e){e.isSearchRender&&(e.isSearchRender=!1,e.$el.detach())}),a.moveFocus(n(".bv-search-text")),r.each(p,function(e){var t=d[e];if(!t)return;u.feature({type:"Used",name:"Close",detail1:"Search",detail2:"Lightbox",bvProduct:t,productId:o.getId(c),categoryId:o.getCategoryId(c)})})}var c=this,h=l?l.split(" "):"",p=c.model.get("coverageContentTypes"),d={Reviews:o.RATINGSANDREVIEWS,Questions:o.ASKANDANSWER},v,m,g,y,b;this.$viewEl=this.viewEl=null,this.isSearchRender=!0,v={ariaDialog:!0,keyboardEnabled:!1,classList:["narrow","search"],container:null,inline:!1,autoFocus:!1,targetClass:"bv-mbox-search-content",beforeShow:w,afterShow:r.bind(c._focusSearchResultsBox,c,!1)},c.mb=i.get(this.ModestBoxId),b=c.mb.$mboxClose,b.attr("aria-labelledby","bv-mbox-close-label"),f||r.indexOf(c.classList,"no-submission")===-1&&c.classList.push("no-submission");if(c.mb.opened){c.detach(),c.render(),c._focusSearchResultsBox(!0),w([c]),s.hide();return}f&&(this.clientAPIConfig.userToken||!t.get("config").siteAuth.question)?(g=r.assignIn({},this.clientAPIConfig,{campaignId:"BV_PRODUCT_DISPLAY"}),g.onShow=function(t){return t&&(t.classList.push("fake-inline"),c.mb.once("afterClose",E),m=r.assignIn({},v,{views:[c,t],beforeShow:w}),c.mb.replaceOrOpen(m)),!1},this.model.publish("submission",g)):(t.get("config").siteAuth.question&&v.classList.push("need-user"),c.mb.once("afterClose",E),m=r.assignIn({},v,{views:[c]}),c.mb.replaceOrOpen(m))}}}),BV.define("hbs!activeContentFilters",["hbs","vendor/handlebars/runtime","template/helpers/view","template/helpers/extmsg","template/helpers/renderIcon"],function(e,t){var n=t.template(function(e,t,n,r,i){function p(e,t){var r="",i,s,o;r+=' <h4 class="bv-active-filters-list-title">',o={hash:{prefix:"content_filter_"}},r+=l((i=n.extmsg,i?i.call(e,"list_title",e.msgpack,e,o):c.call(e,"extmsg","list_title",e.msgpack,e,o)))+'</h4> <ul class="bv-active-filters-list"> ',s=n.each.call(e,e.filters,{hash:{},inverse:h.noop,fn:h.programWithDepth(d,t,e)});if(s||s===0)r+=s;r+=' <li class="bv-active-filters-list-item"> <button type="button" class="bv-active-filter-button-clear bv-focusable"> <span aria-hidden="true">',o={hash:{prefix:"content_filter_"}},r+=l((i=n.extmsg,i?i.call(e,"button_clear",e.msgpack,e,o):c.call(e,"extmsg","button_clear",e.msgpack,e,o)))+"</span> ",o={hash:{classList:"bv-close-icon",ariaHidden:"true"},inverse:h.noop,fn:h.program(4,m,t)},s=(i=n.renderIcon,i?i.call(e,"bv-sprite-close",o):c.call(e,"renderIcon","bv-sprite-close",o));if(s||s===0)r+=s;return r+=' <span class="bv-off-screen">',o={hash:{prefix:"offscreen_"}},r+=l((i=n.extmsg,i?i.call(e,"clear_all_filters",e.msgpack,e,o):c.call(e,"extmsg","clear_all_filters",e.msgpack,e,o)))+"</span> </button> </li> </ul> ",r}function d(e,t,r){var i="",s;i+=" ",s=n.each.call(e,e.options,{hash:{},inverse:h.noop,fn:h.programWithDepth(v,t,e,r)});if(s||s===0)i+=s;return i+=" ",i}function v(e,t,r,i){var s="",o,u,a;s+=' <li data-bv-filter-headerid="'+l((o=r.id,typeof o===f?o.apply(e):o))+'" class="bv-active-filters-list-item" > <button type="button" data-bv-filter-option="',(u=n.id)?u=u.call(e,{hash:{}}):(u=e.id,u=typeof u===f?u.apply(e):u),s+=l(u)+'" class="bv-active-filter-button bv-focusable" title="'+l((o=r.label,typeof o===f?o.apply(e):o))+"\"> <span class='bv-off-screen' id='bv-aria-filter-announce-",(u=n.id)?u=u.call(e,{hash:{}}):(u=e.id,u=typeof u===f?u.apply(e):u),s+=l(u)+"'>",a={hash:{prefix:"content_filter_"}},s+=l((o=n.extmsg,o?o.call(e,"list_title",e.msgpack,e,a):c.call(e,"extmsg","list_title",e.msgpack,e,a)))+" ",(u=n.label)?u=u.call(e,{hash:{}}):(u=e.label,u=typeof u===f?u.apply(e):u),s+=l(u)+'</span> <span class="bv-off-screen">',a={hash:{prefix:"offscreen_"}},s+=l((o=n.extmsg,o?o.call(e,"remove_filter",i.msgpack,i,a):c.call(e,"extmsg","remove_filter",i.msgpack,i,a)))+"&nbsp;</span> ",(u=n.label)?u=u.call(e,{hash:{}}):(u=e.label,u=typeof u===f?u.apply(e):u),s+=l(u)+" ",a={hash:{classList:"bv-close-icon",ariaHidden:"true"},inverse:h.noop,fn:h.program(4,m,t)},u=(o=n.renderIcon,o?o.call(e,"bv-sprite-close",a):c.call(e,"renderIcon","bv-sprite-close",a));if(u||u===0)s+=u;return s+=" </button> </li> ",s}function m(e,t){return" &#x2718; "}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers;var s="",o,u,a,f="function",l=this.escapeExpression,c=n.helperMissing,h=this;a={hash:{tag:"div",classList:"active-filters hidden"},inverse:h.noop,fn:h.program(1,p,i)},u=(o=n.view,o?o.call(t,t,a):c.call(t,"view",t,a));if(u||u===0)s+=u;return s+=" ",s});return t.registerPartial("activeContentFilters",n),n.deps=[],n.tplMountedViews=[],n}),BV.define("bv/c2013/view/contentFilterActiveFilters",["framework/bview","framework/util/bvtracker","bv/util/focusManager","bv/util/productInfo","jquery","lds","hbs!activeContentFilters","mf!bv/c2013/messages/contentFilter"],function(e,t,n,r,i,s,o,u){var a=BV._internal.mobile||navigator.userAgent.match(/(iPhone|iPod|Android|BlackBerry)/),f=e.extend({name:"ActiveFilters",template:o,events:{"click button[data-bv-filter-option]":"clearOption","click button.bv-active-filter-button-clear":"clearAllFilters"},msgpacks:[u],init:function(){s.each(this.model.filters,s.bind(function(e){this.listenTo(e,{filterOptionChanged:this.filterOptionChanged})},this)),this.listenTo(this.model,{filterEnabledChanged:this.filterOptionChanged,allFiltersCleared:this._checkVisibility})},filterOptionChanged:function(){this._checkVisibility()},attach:function(){e.prototype.attach.apply(this,arguments),this._checkVisibility()},clearOption:function(e){var s=i(e.target).closest("[data-bv-filter-option]"),o=s.data("bv-filter-option"),u=parseInt(o,10)>1?o+"Stars":o+"Star",f=s.closest("[data-bv-filter-headerid]"),l=f.data("bv-filter-headerid"),c=this.model.getFilter(l),h=c.getOption(o);h.set("enabled",!1),a||(this.$viewEl.hasClass("bv-hidden")?n.focusPrev():n.focusNext()),t.feature({type:"Used",name:"Filter",detail1:"Clear"+u,bvProduct:r.getType(this),productId:r.getId(this),categoryId:r.getCategoryId(this)}),i("#bv-inline-histogram-ratings-star-label-"+o).attr("aria-pressed",!1).attr("aria-disabled",!1)},clearAllFilters:function(){this.model.clearAllFilters(),a||n.focusPrev(),t.feature({type:"Used",name:"Filter",detail1:"ClearAll",bvProduct:r.getType(this),productId:r.getId(this),categoryId:r.getCategoryId(this)}),i(".bv-flex-container").find("button").attr("aria-pressed",!1).attr("aria-disabled",!1)},_checkVisibility:function(){var e;if(this.isBeforeAttach())return;return e=this.model.activeFilters.length===0,e||this._checkFilterVisibility(),this.$viewEl.toggleClass("bv-hidden",e),!e},_checkFilterVisibility:function(){s.each(this.model.filters,s.bind(function(e){var t=this._getViewForFilter(e);s.each(e.options,s.bind(function(e){var n=this._getViewForOption(e,t),r=e.get("enabled");setTimeout(function(){r&&(document.getElementById(n[0].children[0].id).setAttribute("role","alert"),document.getElementById(n[0].children[0].id).setAttribute("aria-live","assertive"))},7e3),n.parent().toggleClass("bv-hidden",!r)},this))},this))},_getViewForFilter:function(e){return this.$('[data-bv-filter-headerid="'+e.id+'"]')},_getViewForOption:function(e,t){return t.find('[data-bv-filter-option="'+e.id+'"]')},isBeforeAttach:function(){return!this.$viewEl||!this.$viewEl.length}});return f}),BV.define("hbs!contentFilterDropdown",["hbs","vendor/handlebars/runtime","template/helpers/view","template/helpers/equals"],function(e,t){var n=t.template(function(e,t,n,r,i){function p(e,t){var r="",i;r+=' <!--[if lt IE 7]> <div class="bv-compat bvie6 bvie-lt8 bvie"> <![endif]--> <!--[if IE 7]> <div class="bv-compat bvie7 bvie-lt8 bvie"> <![endif]--> <!--[if IE 8]> <div class="bv-compat bvie8 bvie"> <![endif]--> <!--[if IE 9]> <div class="bv-compat bvie9 bvie"> <![endif]--> <!--[if gt IE 9]> <!--><div class="bv-compat"> <!--<![endif]--> <div class="bv-dropdown bv-filter-dropdown"> <ul id="bv-content-filter-dropdown-',(i=n.id)?i=i.call(e,{hash:{}}):(i=e.id,i=typeof i===f?i.apply(e):i),r+=l(i)+'" role="listbox"> ',i=n.each.call(e,e.options,{hash:{},inverse:c.noop,fn:c.program(2,d,t)});if(i||i===0)r+=i;return r+=" </ul> </div> </div> ",r}function d(e,t){var r="",i,s,o;r+=' <li aria-label="',(i=n.label)?i=i.call(e,{hash:{}}):(i=e.label,i=typeof i===f?i.apply(e):i),r+=l(i)+'" aria-checked=',i=n["if"].call(e,e.enabled,{hash:{},inverse:c.program(5,m,t),fn:c.program(3,v,t)});if(i||i===0)r+=i;r+=" ",o={hash:{},inverse:c.noop,fn:c.program(7,g,t)},s=(i=n.equals,i?i.call(e,e.id,"1",o):h.call(e,"equals",e.id,"1",o));if(s||s===0)r+=s;r+=' class="bv-dropdown-item bv-focusable ',s=n["if"].call(e,e.enabled,{hash:{},inverse:c.noop,fn:c.program(9,y,t)});if(s||s===0)r+=s;return r+='" data-bv-dropdown-value="',(s=n.id)?s=s.call(e,{hash:{}}):(s=e.id,s=typeof s===f?s.apply(e):s),r+=l(s)+'" tabindex="0" role="option"> <span aria-hidden="true">',(s=n.label)?s=s.call(e,{hash:{}}):(s=e.label,s=typeof s===f?s.apply(e):s),r+=l(s)+"</span> </li> ",r}function v(e,t){return'"true"'}function m(e,t){return'"false"'}function g(e,t){return' aria-live="assertive" '}function y(e,t){return'bv-dropdown-item-selected" aria-checked="true"'}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers;var s="",o,u,a,f="function",l=this.escapeExpression,c=this,h=n.helperMissing;s+='<div class="bv-core-container-',(o=n.version)?o=o.call(t,{hash:{}}):(o=t.version,o=typeof o===f?o.apply(t):o),s+=l(o)+'"> ',a={hash:{tag:"div",classList:"select-dropdown"},inverse:c.noop,fn:c.program(1,p,i)},u=(o=n.view,o?o.call(t,t,a):h.call(t,"view",t,a));if(u||u===0)s+=u;return s+=" </div> ",s});return t.registerPartial("contentFilterDropdown",n),n.deps=[],n.tplMountedViews=[],n}),BV.define("bv/c2013/view/contentFilterDropdown",["lds","jquery","bv/ui-core/bselectdropdownview","bv/util/focusManager","hbs!contentFilterDropdown"],function(e,t,n,r,i){return n.extend({name:"FilterDropdown",template:i,options:e.assignIn(n.prototype.options,{allowToggle:!0}),moveNextFocusable:!1,init:function(){},topPositionModifier:function(e){return e-5},rightPositionModifier:function(e){return e+parseInt(this.parent.$viewEl.find(".bv-dropdown-target").css("paddingRight"),10)},select:function(e){n.prototype.select.apply(this,arguments);var r=t(e.target).closest(".bv-dropdown-item");r.toggleClass("bv-dropdown-item-selected")},setupKeyboardNavigation:function(){n.prototype.setupKeyboardNavigation.apply(this,arguments);var e=this,t={9:!0,38:!0,40:!0};e.$el.off("keydown.FilterSelectView").on("keydown.FilterSelectView",function(n){var i=n.keyCode;if(!t[i])return;var s=!1;switch(i){case 9:s=!0,e.leave(n);var o=n.shiftKey?"focusPrev":"focusNext";r[o]();break;case 38:document.activeElement===e.$first[0]&&(s=!0,r.moveFocus(e.$last));break;case 40:document.activeElement===e.$last[0]&&(s=!0,r.moveFocus(e.$first))}s&&(n.preventDefault(),n.stopPropagation())})}})}),BV.define("hbs!contentFilterSelect",["hbs","vendor/handlebars/runtime","template/helpers/view","template/helpers/extmsg","template/helpers/renderIcon"],function(e,t){var n=t.template(function(e,t,n,r,i){function p(e,t){var r="",i;r+=" ",i=n["if"].call(e,e.isMobile,{hash:{},inverse:h.program(5,m,t),fn:h.program(2,d,t)});if(i||i===0)r+=i;return r+=" ",r}function d(e,t){var r="",i,s,o;r+='  <label for="bv-dropdown-select-'+l((i=(i=e._bview,i==null||i===!1?i:i.viewId),typeof i===f?i.apply(e):i))+'" class="bv-off-screen" aria-hidden="true"> ',o={hash:{}},r+=l((i=n.extmsg,i?i.call(e,"offscreen_filter_label",e.msgpack,e,o):c.call(e,"extmsg","offscreen_filter_label",e.msgpack,e,o)))+" ",(s=n.label)?s=s.call(e,{hash:{}}):(s=e.label,s=typeof s===f?s.apply(e):s),r+=l(s)+' </label> <select id="bv-dropdown-select-'+l((i=(i=e._bview,i==null||i===!1?i:i.viewId),typeof i===f?i.apply(e):i))+'" class="bv-content-filter-select-element bv-focusable bv-dropdown" data-bv-filter-for="',(s=n.label)?s=s.call(e,{hash:{}}):(s=e.label,s=typeof s===f?s.apply(e):s),r+=l(s)+'"> '+' <option value="">',(s=n.label)?s=s.call(e,{hash:{}}):(s=e.label,s=typeof s===f?s.apply(e):s),r+=l(s)+"</option> ",s=n.each.call(e,e.options,{hash:{},inverse:h.noop,fn:h.program(3,v,t)});if(s||s===0)r+=s;return r+=" </select> ",r}function v(e,t){var r="",i;return r+=' <option value="',(i=n.id)?i=i.call(e,{hash:{}}):(i=e.id,i=typeof i===f?i.apply(e):i),r+=l(i)+'">',(i=n.label)?i=i.call(e,{hash:{}}):(i=e.label,i=typeof i===f?i.apply(e):i),r+=l(i)+"</option> ",r}function m(e,t){var r="",i,s,o;r+=' <div class="bv-dropdown" data-bv-filter-for="',(i=n.label)?i=i.call(e,{hash:{}}):(i=e.label,i=typeof i===f?i.apply(e):i),r+=l(i)+'"> <div class="bv-dropdown-target"> '+' <button type="button" id="bv-content-filter-',(i=n.id)?i=i.call(e,{hash:{}}):(i=e.id,i=typeof i===f?i.apply(e):i),r+=l(i)+'-dropdown" class="bv-focusable" aria-haspopup="true" aria-expanded="false" aria-controls="bv-content-filter-dropdown-',(i=n.id)?i=i.call(e,{hash:{}}):(i=e.id,i=typeof i===f?i.apply(e):i),r+=l(i)+'" aria-label="',o={hash:{}},r+=l((i=n.extmsg,i?i.call(e,"offscreen_sort_arrow",e.msgpack,e,o):c.call(e,"extmsg","offscreen_sort_arrow",e.msgpack,e,o)))+" ",o={hash:{}},r+=l((i=n.extmsg,i?i.call(e,"offscreen_filter_label",e.msgpack,e,o):c.call(e,"extmsg","offscreen_filter_label",e.msgpack,e,o)))+" ",(s=n.label)?s=s.call(e,{hash:{}}):(s=e.label,s=typeof s===f?s.apply(e):s),r+=l(s)+'"> ',o={hash:{classList:"bv-dropdown-arrow",ariaHidden:"true",role:"presentation"},inverse:h.noop,fn:h.program(6,g,t)},s=(i=n.renderIcon,i?i.call(e,"bv-sprite-down-arrow-dark",o):c.call(e,"renderIcon","bv-sprite-down-arrow-dark",o));if(s||s===0)r+=s;r+=' <span class="bv-dropdown-title" aria-hidden="true">',(s=n.label)?s=s.call(e,{hash:{}}):(s=e.label,s=typeof s===f?s.apply(e):s),r+=l(s)+'</span> <span class="bv-off-screen">',o={hash:{}},r+=l((i=n.extmsg,i?i.call(e,"offscreen_filter_label",e.msgpack,e,o):c.call(e,"extmsg","offscreen_filter_label",e.msgpack,e,o)))+" ",(s=n.label)?s=s.call(e,{hash:{}}):(s=e.label,s=typeof s===f?s.apply(e):s),r+=l(s)+'</span> </button> </div> <label for="bv-dropdown-select-'+l((i=(i=e._bview,i==null||i===!1?i:i.viewId),typeof i===f?i.apply(e):i))+'" class="bv-off-screen" aria-hidden="true"> ',o={hash:{}},r+=l((i=n.extmsg,i?i.call(e,"offscreen_filter_label",e.msgpack,e,o):c.call(e,"extmsg","offscreen_filter_label",e.msgpack,e,o)))+" ",(s=n.label)?s=s.call(e,{hash:{}}):(s=e.label,s=typeof s===f?s.apply(e):s),r+=l(s)+' </label> <select id="bv-dropdown-select-'+l((i=(i=e._bview,i==null||i===!1?i:i.viewId),typeof i===f?i.apply(e):i))+'" class="bv-select-cleanslate bv-dropdown-select"> ',s=n.each.call(e,e.options,{hash:{},inverse:h.noop,fn:h.program(8,y,t)});if(s||s===0)r+=s;return r+=" </select> </div> ",r}function g(e,t){return" &#x25BC; "}function y(e,t){var r="",i;return r+=' <option value="',(i=n.id)?i=i.call(e,{hash:{}}):(i=e.id,i=typeof i===f?i.apply(e):i),r+=l(i)+'"> ',(i=n.label)?i=i.call(e,{hash:{}}):(i=e.label,i=typeof i===f?i.apply(e):i),r+=l(i)+" </option> ",r}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers;var s="",o,u,a,f="function",l=this.escapeExpression,c=n.helperMissing,h=this;s+=" ",a={hash:{tag:"div",classList:"content-filter-select"},inverse:h.noop,fn:h.program(1,p,i)},u=(o=n.view,o?o.call(t,t,a):c.call(t,"view",t,a));if(u||u===0)s+=u;return s+=" ",s});return t.registerPartial("contentFilterSelect",n),n.deps=[],n.tplMountedViews=[],n}),BV.define("bv/c2013/view/contentFilterSelect",["jquery","lds","bv/ui-core/bselectview","bv/c2013/view/contentFilterDropdown","bv/util/focusManager","hbs!contentFilterSelect"],function(e,t,n,r,i,s){return n.extend({name:"FilterSelect",events:{"change select":"change","click button.bv-focusable":"enter"},TargetView:r,template:s,change:function(t){var n=e(t.target),r=n.val(),s,o;if(r==="")return;s=this.model.getOption(r),s.toggleEnabled(),n.val(""),o=n.parent().find(".bv-dropdown-target button.bv-focusable").eq(0),o.length&&setTimeout(function(){i.moveFocus(o)},0)},leave:function(){var e=this.$targetEl.find("button");return e&&(e.removeAttr("aria-owns"),e.removeAttr("role")),n.prototype.leave.apply(this,arguments)},enter:function(){var e=this.$targetEl.find("button"),t=this.$targetEl.find(".bv-dropdown").attr("data-bv-filter-for");e&&(e.attr("aria-owns","bv-content-filter-dropdown-"+t),e.attr("role","application"));if(this.model.get("isMobile"))return;return n.prototype.enter.apply(this,arguments)},setupKeyboardNavigation:function(n){var r=this,s={9:!0,13:!0,27:!0,32:!0,38:!0,40:!0};n=n||this.$targetEl,n.off("keydown.FilterSelectView").on("keydown.FilterSelectView",function(n){function h(e){r.targetViewOptions=t.assignIn({},r.targetViewOptions,{startDelay:0}),r.enter(e),u=r.targetView}function p(e){r.leave(e),r.deregisterFocusableLayer()}var o=n.keyCode,u,a,f=!1,l,c;if(!s[o])return;u=r.targetView,a=u?u.rendered:!1;switch(o){case 9:f=!0,a&&p(n),l=n.shiftKey?"focusPrev":"focusNext",i[l]();break;case 13:case 32:f=!0,a?p(n):h(n);break;case 27:f=!0,p(n);break;case 40:f=!0,a||h(n),c=setInterval(function(){e.contains(document,u.$first[0])&&(r.moveFocus(u.$first),clearInterval(c))},20)}f&&(n.preventDefault(),n.stopPropagation())})},setText:e.noop})}),BV.define("hbs!contentFilterControls",["hbs","vendor/handlebars/runtime","template/helpers/view","template/helpers/subviews"],function(e,t){var n=t.template(function(e,t,n,r,i){function h(e,t){var r="",i,s;r+=' <div class="bv-filters ',i=n.unless.call(e,e.expanded,{hash:{},inverse:f.noop,fn:f.program(2,p,t)});if(i||i===0)r+=i;return r+='"> ',s={hash:{}},r+=c((i=n.subviews,i?i.call(e,e,s):l.call(e,"subviews",e,s)))+" </div> ",r}function p(e,t){return"bv-hidden"}this.compilerInfo=[2,">= 1.0.0-rc.3"],n=n||e.helpers;var s="",o,u,a,f=this,l=n.helperMissing,c=this.escapeExpression;a={hash:{tag:"div",classList:"filter-controls",role:"status",ariaLive:"polite"},inverse:f.noop,fn:f.program(1,h,i)},u=(o=n.view,o?o.call(t,t,a):l.call(t,"view",t,a));if(u||u===0)s+=u;return s+=" ",s});return t.registerPartial("contentFilterControls",n),n.deps=[],n.tplMountedViews=[],n}),BV.define("bv/c2013/view/contentFilterControls",["framework/bview","bv/ui-core/focusableview","bv/c2013/view/contentFilterSelect","lds","hbs!contentFilterControls","mf!bv/c2013/messages/contentFilter"],function(e,t,n,r,i,s){var o=e.extend({name:"FilterControls",events:{},template:i,msgpacks:[s],init:function(){this.listenTo(this.model,{"change:expanded":this.toggleExpandFilter})},createFilterViews:function(){var e=this,t=e.model.filters;return e.views||(e.views=[]),r.each(t,function(t){var r=new n({parent:e,model:t});e.views.push(r)},e),e.views},toggleExpandFilter:function(e,t){function r(e){var t=n.find(".bv-filters"),r=n.find(".bv-filters > .bv-content-filter-select"),i;e?r.css("max-width","none"):(r.css("width",1),i=t.width(),r.css("width","auto").css("max-width",i))}var n=this.$viewEl;if(!n||!n.length)return;n.toggleClass("bv-hidden",!t),n.toggleClass("bv-focusable",t),t?(r(),n.attr("tabindex",-1),this.rescanFocusLayer()):(r(!0),n.removeAttr("tabindex"),this.removeFocusables(n))}});return o=o.extend(t),o}),BV.define("secondary",["bv/ugc/submission","bv/ugc/authUser","bv/ugc/unsubscribeUser","bv/ugc/container","bv/ugc/deeplink","bv/ui-core/modestbox","bv/c2013/_extensions/collection/contentItemCollectionExt","bv/c2013/_extensions/view/contentItemExt","bv/c2013/_extensions/model/searchContentListExt","bv/c2013/_extensions/view/searchContentListExt","bv/c2013/view/contentFilterActiveFilters","bv/c2013/view/contentFilterControls"],function(e,t,n,r,i,s,o,u,a,f,l,c){return{Submission:e,AuthUser:t,UnsubscribeUser:n,Container:r,Deeplink:i,ModestBox:s,ContentItemCollectionExt:{collection:o},ContentItemExt:{view:u},SearchContentListExt:{model:a,view:f},ActiveFiltersView:l,FilterControlsView:c}});