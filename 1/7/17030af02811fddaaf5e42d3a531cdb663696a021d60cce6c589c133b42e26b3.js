/**
 * @file postscribe
 * @description Asynchronously write javascript, even with document.write.
 * @version v2.0.8
 * @see {@link https://krux.github.io/postscribe}
 * @license MIT
 * @author Derek Brans
 * @copyright 2016 Krux Digital, Inc
 */
!this,;
((this,function(){"use strict";function defineProperty(obj,property,value,isOverrideDefaultValue,isWritable,isConfigurable,isEnumerable){if(!isOverrideDefaultValue&&property in obj){return}if(!Object.defineProperty||!)){obj[property]=value;return obj}isWritable=isWritable===true;isConfigurable=isConfigurable===true;isEnumerable=isEnumerable===true;return Object.defineProperty(obj,property,{value:value,writable:isWritable,configurable:isConfigurable,enumerable:isEnumerable})}var codePointAt=String.prototype.codePointAt;if(!codePointAt){codePointAt=function codePointAt(position){if(this===null){throw new TypeError(" ")}var string=String(this);var size=string.length;var index=position?Number(position):0;if(window.isNan(index)){index=0}if(index<0||index>=size){return undefined}var first=string.charCodeAt(index);var second=void 0;if(first>=55296&&first<=56319&&size>index+1){second=string.charCodeAt(index+1);if(second>=56320&&second<=57343){return(first-55296)*1024+second-56320+65536}}return first}}var fromCodePoint=String.fromCodePoint;if(!fromCodePoint){var stringFromCharCode=String.fromCharCode;var floor=Math.floor;fromCodePoint=function fromCodePoint(){var MAX_SIZE=16384;var codeUnits=[];for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}var length=args.length;var highSurrogate=void 0;var lowSurrogate=void 0;var index=-1;if(!length){return""}var result="";while(++index<length){var codePoint=Number(args[index]);if(!isFinite(codePoint)||codePoint<0||codePoint>1114111||floor(codePoint)!==codePoint){throw new RangeError("Invalid code point: "+codePoint)}if(codePoint<=65535){codeUnits.push(codePoint)}else{codePoint-=65536;highSurrogate=(codePoint>>10)+55296;lowSurrogate=codePoint%1024+56320;codeUnits.push(highSurrogate,lowSurrogate)}if(index+1===length||codeUnits.length>MAX_SIZE){result+=stringFromCharCode.apply(undefined,codeUnits);codeUnits.length=0}}return result}}var ZTMZSEC$1=window&&window.ZTMZSEC?window.ZTMZSEC:{version:"5.2.0"};if(!ZTMZSEC$1.defineProperty){ZTMZSEC$1.defineProperty=defineProperty}if(!ZTMZSEC$1["5.2.0"]){ZTMZSEC$1["5.2.0"]={version:"5.2.0",defineProperty:defineProperty}}function indexOfPolyfill(searchElement){if(this===undefined||this===null){throw new TypeError(" ")}var t={};var len=t.length>>>0;if(len===0){return-1}var n=0;if((arguments.length<=1?0:arguments.length-1)>0){n=Number(arguments.length<=2?undefined:arguments[2]);if(isNaN(n)){n=0}else if(n!==0&&n!==1/0&&n!==-(1/0)){n=(n>0||-1)*Math.floor(Math.abs(n))}}if(n>=len){return-1}var k=n>=0?n:Math.max(len-Math.abs(n),0);for(;k<len;k++){if(k in t&&t.charAt(k)===searchElement){return k}}return-1}var arrayIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:indexOfPolyfill;var Encoder={};function toCharCodeArr(charArr){var charCodeArr=[];for(var i=0;i<charArr.length;i++){charCodeArr.push(charArr[i].charCodeAt(0))}return charCodeArr}var IMMUNE={HTML:toCharCodeArr([",",".","-","_"," "]),HTMLATTR:toCharCodeArr([",",".","-","_"]),CSS:toCharCodeArr([]),JAVASCRIPT:toCharCodeArr([",",".","_"])};var characterToEntityMap={};var characterToEntityArray="34=&quot|38=&amp|60=&lt|62=&gt|160=&nbsp|161=&iexcl|162=&cent|163=&pound|164=&curren|165=&yen|166=&brvbar|167=&sect|168=&uml|169=&copy|170=&ordf|171=&laquo|172=&not|173=&shy|174=&reg|175=&macr|176=&deg|177=&plusmn|178=&sup2|179=&sup3|180=&acute|181=&micro|182=&para|183=&middot|184=&cedil|185=&sup1|186=&ordm|187=&raquo|188=&frac14|189=&frac12|190=&frac34|191=&iquest|192=&Agrave|193=&Aacute|194=&Acirc|195=&Atilde|196=&Auml|197=&Aring|198=&AElig|199=&Ccedil|200=&Egrave|201=&Eacute|202=&Ecirc|203=&Euml|204=&Igrave|205=&Iacute|206=&Icirc|207=&Iuml|208=&ETH|209=&Ntilde|210=&Ograve|211=&Oacute|212=&Ocirc|213=&Otilde|214=&Ouml|215=&times|216=&Oslash|217=&Ugrave|218=&Uacute|219=&Ucirc|220=&Uuml|221=&Yacute|222=&THORN|223=&szlig|224=&agrave|225=&aacute|226=&acirc|227=&atilde|228=&auml|229=&aring|230=&aelig|231=&ccedil|232=&egrave|233=&eacute|234=&ecirc|235=&euml|236=&igrave|237=&iacute|238=&icirc|239=&iuml|240=&eth|241=&ntilde|242=&ograve|243=&oacute|244=&ocirc|245=&otilde|246=&ouml|247=&divide|248=&oslash|249=&ugrave|250=&uacute|251=&ucirc|252=&uuml|253=&yacute|254=&thorn|255=&yuml|338=&OElig|339=&oelig|352=&Scaron|353=&scaron|376=&Yuml|402=&fnof|710=&circ|732=&tilde|913=&Alpha|914=&Beta|915=&Gamma|916=&Delta|917=&Epsilon|918=&Zeta|919=&Eta|920=&Theta|921=&Iota|922=&Kappa|923=&Lambda|924=&Mu|925=&Nu|926=&Xi|927=&Omicron|928=&Pi|929=&Rho|931=&Sigma|932=&Tau|933=&Upsilon|934=&Phi|935=&Chi|936=&Psi|937=&Omega|945=&alpha|946=&beta|947=&gamma|948=&delta|949=&epsilon|950=&zeta|951=&eta|952=&theta|953=&iota|954=&kappa|955=&lambda|956=&mu|957=&nu|958=&xi|959=&omicron|960=&pi|961=&rho|962=&sigmaf|963=&sigma|964=&tau|965=&upsilon|966=&phi|967=&chi|968=&psi|969=&omega|977=&thetasym|978=&upsih|982=&piv|8194=&ensp|8195=&emsp|8201=&thinsp|8204=&zwnj|8205=&zwj|8206=&lrm|8207=&rlm|8211=&ndash|8212=&mdash|8216=&lsquo|8217=&rsquo|8218=&sbquo|8220=&ldquo|8221=&rdquo|8222=&bdquo|8224=&dagger|8225=&Dagger|8226=&bull|8230=&hellip|8240=&permil|8242=&prime|8243=&Prime|8249=&lsaquo|8250=&rsaquo|8254=&oline|8260=&frasl|8364=&euro|8465=&image|8472=&weierp|8476=&real|8482=&trade|8501=&alefsym|8592=&larr|8593=&uarr|8594=&rarr|8595=&darr|8596=&harr|8629=&crarr|8656=&lArr|8657=&uArr|8658=&rArr|8659=&dArr|8660=&hArr|8704=&forall|8706=&part|8707=&exist|8709=&empty|8711=&nabla|8712=&isin|8713=&notin|8715=&ni|8719=&prod|8721=&sum|8722=&minus|8727=&lowast|8730=&radic|8733=&prop|8734=&infin|8736=&ang|8743=&and|8744=&or|8745=&cap|8746=&cup|8747=&int|8756=&there4|8764=&sim|8773=&cong|8776=&asymp|8800=&ne|8801=&equiv|8804=&le|8805=&ge|8834=&sub|8835=&sup|8836=&nsub|8838=&sube|8839=&supe|8853=&oplus|8855=&otimes|8869=&perp|8901=&sdot|8968=&lceil|8969=&rceil|8970=&lfloor|8971=&rfloor|10216=&lang|10217=&rang|9674=&loz|9824=&spades|9827=&clubs|9829=&hearts|9830=&diams";characterToEntityArray=characterToEntityArray.split("|");for(var i=0;i<characterToEntityArray.length;i++){var eachEntry=characterToEntityArray[i].split("=");characterToEntityMap[eachEntry[0]]=eachEntry[1]}var hex=[];for(var c=0;c<255;c++){if(c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122){hex[c]=null}else{hex[c]=c.toString(16)}}function getHexForNonAlphanumeric(c){if(c<256){return hex[c]}return c.toString(16)}function encodeHTMLCharacter(immuneCharList,c){if(arrayIndexOf.call(immuneCharList,c)!==-1){return fromCodePoint(c)}var hex=getHexForNonAlphanumeric(c);if(hex===null){return fromCodePoint(c)}if(c<=31&&c!=9&&c!=10&&c!=13||c>=127&&c<=159||c===32){return"&#x20;"}var entityName=characterToEntityMap[c];if(entityName!==undefined){return entityName+";"}return"&#x"+hex+";"}function encodeJSCharacter(immuneCharList,c){if(arrayIndexOf.call(immuneCharList,c)!==-1){return String.fromCharCode(c)}var hex=getHexForNonAlphanumeric(c);if(hex===null){return String.fromCharCode(c)}var tmp=c.toString(16);var pad=void 0;if(c<256){pad="00".substr(tmp.length);return"\\x"+pad+tmp.toUpperCase()}pad="0000".substr(tmp.length);return"\\u"+pad+tmp.toUpperCase()}function encodeCSSCharacter(immuneCharList,c){if(arrayIndexOf.call(immuneCharList,c)!==-1){return fromCodePoint(c)}var hex=getHexForNonAlphanumeric(c);if(hex===null){return fromCodePoint(c)}return"\\"+hex+" "}function encode(immuneCharList,sInput,characterEncoder,isHandleUnicodeChar){if(sInput===null||sInput===undefined||typeof sInput!=="string"){return sInput}var out="";for(var _i=0;_i<sInput.length;_i++){if(isHandleUnicodeChar){var _c=codePointAt.call(sInput,_i);out+=characterEncoder(immuneCharList,_c,isHandleUnicodeChar);if(_c>65535){_i++}}else{out+=characterEncoder(immuneCharList,sInput.charCodeAt(_i))}}return out}Encoder.encodeForHTML=function(input){return encode(IMMUNE.HTML,input,encodeHTMLCharacter,true)};Encoder.encodeForHTMLAttribute=function(input){return encode(IMMUNE.HTMLATTR,input,encodeHTMLCharacter,true)};Encoder.encodeForJavaScript=function(input){return encode(IMMUNE.JAVASCRIPT,input,encodeJSCharacter,false)};Encoder.encodeForCSS=function(input){return encode(IMMUNE.CSS,input,encodeCSSCharacter,true)};if(Object.freeze){Object.freeze(Encoder)}if(ZTMZSEC$1.version==="5.2.0"&&!ZTMZSEC$1.Encoder){ZTMZSEC$1.defineProperty(ZTMZSEC$1,"Encoder",Encoder,true,false,false,true)}if(!ZTMZSEC$1["5.2.0"].Encoder){ZTMZSEC$1.defineProperty(ZTMZSEC$1["5.2.0"],"Encoder",Encoder,true,false,false,true)}return ZTMZSEC$1});var config="";(function(w){var DATA_VARIABLE_NAME="ZTMData";var JS_CUSTOM_EVENT_NAME="ztm.customevent";var data={"variables":{"selfRef":{"type":3},"Page URL":{"subType":1,"type":1},"directTraffic":{"type":3},"zmarkCook":{"cookieKey":"ZohoMarkSrc","type":6},"Page Hostname":{"subType":3,"type":1},"Page Path":{"subType":5,"type":1},"prevProduct":{"type":3},"zglobal_Acookie_optOut":{"type":3},"gclid":{"subType":6,"paramName":"gclid","type":1},"myProduct":{"type":3},"ireft":{"subType":6,"paramName":"ireft","type":1},"Referrer":{"subType":1,"type":2},"marketingReferral":{"cookieKey":"ZohoMarkRef","type":6},"utm_source":{"subType":6,"paramName":"utm_source","type":1},"NoMarkRef":{"type":3}},"triggers":{"PV - To identify Internal Navigation - ireft":{"filters":[{"value":"undefined","key":"ireft","operator":1}],"type":1,"tags":["cookie - Marketing Referral URL - Zoho"]},"PV - Traffic Source - Adwords GCLID":{"filters":[{"value":"undefined","key":"gclid","operator":1}],"type":1,"tags":["cookie - Marketing Referral URL - Zoho"]},"All Pages":{"filters":[],"type":1,"tags":["PS - Heatmap - All Webpages","SIQ - All Website - Visitor Tracking"]},"PV - No Marketing Referral URL":{"filters":[{"value":"true","key":"NoMarkRef","operator":0}],"type":1,"tags":["cookie - Marketing Referral URL - Zoho"]},"PV - Traffic Source - Direct":{"filters":[{"value":"undefined","key":"directTraffic","operator":1}],"type":1,"tags":["cookie - Marketing Referral URL - Zoho"]},"CE - Global Cookie OptOut - True":{"custom_event_name":".*","custom_event_use_regex":true,"filters":[{"value":"2|3|true|-1","key":"zglobal_Acookie_optOut","operator":8}],"type":4,"tags":["PS - Heatmap - All Webpages","cookie - Marketing Referral URL - Zoho"]},"PV - To identify landing page - Zoho":{"filters":[{"value":"^$","key":"Referrer","operator":9},{"value":"zoho.com|zoho.eu|zoho.in","key":"Referrer","operator":9}],"type":1,"tags":["cookie - Marketing Referral URL - Zoho"]},"PV - Traffic Source - Fetch from utm_source":{"filters":[{"value":"undefined","key":"utm_source","operator":1}],"type":1,"tags":["cookie - Marketing Referral URL - Zoho"]}},"is_click_link_present":false,"click_listener_required":false,"tags":{"SIQ - All Website - Visitor Tracking":{"before_fire":"","after_fire":"","html":"<script type=\"text/javascript\">\nif (\"{{zglobal_Acookie_optOut}}\" == '-2' || \"{{zglobal_Acookie_optOut}}\" == '0' || \"{{zglobal_Acookie_optOut}}\" == '1' || \"{{zglobal_Acookie_optOut}}\" == '2' || \"{{zglobal_Acookie_optOut}}\" == '' || \"{{zglobal_Acookie_optOut}}\" == 'undefined' || \"{{zglobal_Acookie_optOut}}\" == 'null') {\n(function(w,s){e=document.createElement(\"script\");e.type=\"text/javascript\";e.id=\"siquts\";e.async=true;e.src=\"https://widgets.zohosalesiq.com/app.js?widgetcode=90643b459b1adf9d5c8ba650d8418fb905f989e389e690323db70e8258ee79a1b38c0fc203bea6c01c22393458f46948\";var x=document.getElementsByTagName(\"script\")[0];x.parentNode.insertBefore(e,x);})(window,\"script\");\n  var isMobileChatWidgetEnabled = false;\n  var $zoho = $zoho || {};\n  $zoho.salesiq = $zoho.salesiq || {};\n  if ($zoho.hasOwnProperty('salesiq')) {\n    $zoho.livedesk = $zoho.salesiq;\n  }\n  $zoho.salesiq.ready = function(embedinfo) {\n    $zoho.salesiq.visitor.info({\"Zoho Service Name\" : \"{{myProduct}}\"});\n    $zoho.salesiq.tracking.domain(\"zoho.com\");\n    $zoho.salesiq.floatbutton.visible(\"hide\");\n    if (\"{{zglobal_Acookie_optOut}}\" == '2') { $zoho.salesiq.tracking.off(); }\n  }\n}\nelse { console.log(\"SalesIQ code snippet skipped\"); }\n<\/script>","type":1,"exceptions":[]},"PS - Heatmap - All Webpages":{"before_fire":"","after_fire":"","html":"<script src=\"https://cdn.pagesense.io/js/fzloyco9/a63a3daff87f4d33b6cffbe7a949ff5f.js\"><\/script>","type":1,"exceptions":["CE - Global Cookie OptOut - True"]},"cookie - Marketing Referral URL - Zoho":{"before_fire":"","after_fire":"","html":"<script> \nfunction createCookie(name,value,days) {\n\tif (days) {\n\t\tvar date = new Date();\n\t\tdate.setTime(date.getTime()+(days*24*60*60*1000));\n\t\tvar expires = \"; expires=\"+date.toGMTString();\n\t}\n\telse var expires = \"\";\n\tdocument.cookie = name+\"=\"+value+expires+\";SameSite=None; Secure; domain=.zoho.com; path=/\";\n}\nvar p_URL = \"{{Page URL}}\".substring(0,300); \ncreateCookie(\"ZohoMarkRef\",'\"'+ p_URL +'\"')\n<\/script>","type":1,"exceptions":["CE - Global Cookie OptOut - True"]}}};var config={
"myProduct" : function(){
var product, result = config.genericMthd('Page URL');
result = result.split('/');
if(result[2].indexOf('marketplace.zoho.') > -1 ) {
    product = result[2].split('.');
    product = product[0];
    return product;
} },
"prevProduct" : function(){

  var str = config.genericMthd('Referrer');
  if (str.indexOf('.zoho.') > -1) {
    result = str.split('/');
    if(str == 'https://www.zoho.com' || str == 'https://www.zoho.eu' ||
      str == 'https://www.zoho.com/' || str.indexOf('https://www.zoho.com/?') > -1 ||
      str == 'https://www.zoho.eu/' || str.indexOf('https://www.zoho.eu/?') > -1 ||
      str == 'https://blog.zoho.com/' || str.indexOf('https://blog.zoho.com/?') > -1 ||
      str == 'https://www.zoho.com/blog' || str.indexOf('https://www.zoho.com/blog/?') > -1 ||
      str.indexOf('https://www.zoho.com?') > -1 || str.indexOf('https://www.zoho.eu?') > -1 ||
      str.indexOf('https://www.zoho.com/general/blog') > -1 || (str.indexOf('https://www.zoho.') > -1 &&
      result[3].indexOf(".") > 0) || str.indexOf('https://www.zoho.com/service-updates/blog') > -1 ||
      str.indexOf('https://www.zoho.com/announcements/blog/') > -1) { product = "zoho";
    } else if(result[3] == 'news' || result[3] == 'lp' || result[3] == 'arts' || result[3] == 'pinned' ||
        result[3] == 'accounts' || result[3] == 'zoholics' || result[3] == 'partnerstore' || 
        result[3] == 'security' || result[3] == 'platform' || result[3] == 'phonebridge' || 
        result[3] == 'gadgets' || result[3] == 'referrals' || result[3] == 'hosting' || result[3] == 'deluge') {
          product = "zoho";
    } else if(result[2] == 'blog.zoho.com' && (result[3] == 'service-updates' ||
    result[3] == 'author' || result[3] == 'general' || result[3] == 'announcements' ||
    result[3] == 'tag' || result[3] == 'page' || result[3].indexOf('.html') > -1)) {
          product = "zoho";
    } else if(str.indexOf('https://www.zoho.com/blog/') > -1 && result[4].indexOf('.') > -1) { product = "zoho";
    } else if(result[2] == 'blog.zoho.com' && result[3].indexOf('.html') === -1) { product = result[3];
    } else if(result[3].length == 2 || (result[3].length == 5 && result[3].indexOf('-') == 2)) {
      if(result[4] == 'crm' && result[5] == 'crmplus') { product = "crmplus"; }
      else if(result[4] == 'creator' && str.indexOf('announcements') > -1) { product = "creann"; }
      else { product = result[4]; }
    } else if(str.indexOf('https://www.zoho.com/blog/') > -1 && result[4].indexOf('.') === -1) { product = result[4];
    } else if(result[3] == 'workplace'){ product = "mail";
    } else if(result[2].indexOf('.zoho.') > -1 && result[2].indexOf('www.zoho') === -1){
        product = result[2].split('.');
        if (product[0] == 'workplace' || product[0] == 'mail') { product = "mail"; }
      	else if (product[0] == 'accounts' || product[0] == 'docs' || product[0] == 'sheet' || product[0] == 'show' || product[0] == 'writer') { product = product[0]; }
        else { product = "p_"+product[0]; }
    } else if(result[3] == 'crm' && result[4] == 'crmplus'){ product = "crmplus";
    } else if(result[3] == 'creator' && str.indexOf('announcements') > -1){ product = "creann";
    } else { product = result[3]; }
    if (product.indexOf('?') > -1) { product = product.split('?'); product = product[0]; }
    return product;
  }},
"directTraffic" : function(){
if(config.genericMthd('gclid') == undefined && config.genericMthd('utm_source') == undefined && config['selfRef']() == undefined && config.genericMthd('Referrer') == ''){ 
	return 'direct';
}},
"zglobal_Acookie_optOut" : 
"selfRef" : function(){
ref = config.genericMthd('Referrer');
if (ref.indexOf('.zoho.com') > -1) {
	var reff = config['prevProduct']();
	var curr = config['myProduct']();
	if (curr == "creator" && reff != curr) return reff;
}},
"NoMarkRef" : function(){
if(config.genericMthd('marketingReferral') == undefined || config.genericMthd('marketingReferral') == ''){ 
	return 'true';
}}};config.genericMthd=function(configparam){var variable=varvalidation.getVariableFromId(configparam);var variableValue=varvalidation.getVariableValue(variable);return variableValue};var LOGGER={isLoggerEnabled:function(){var url=new URL(window.location.href);return url.searchParams.get("ztm")!=null&&url.searchParams.get("ztm")==="test"},log:function(){if(LOGGER.isLoggerEnabled()){console.log.apply(null,arguments)}},error:function(){if(LOGGER.isLoggerEnabled()){console.error.apply(null,arguments)}},debug:function(){if(LOGGER.isLoggerEnabled()){console.debug.apply(null,arguments)}}};var ZTMDataHandler={currentZTMDataSnapShot:{},customEventQueue:[],processDataObjectPush:function(dataObject,pushEventToQueue){if(typeof dataObject==="object"){var internalQueue=[];for(var key in dataObject){var value=dataObject[key];if(key==="event"){if(pushEventToQueue){ZTMDataHandler.customEventQueue.push(value)}else{internalQueue.push(value)}}else{ZTMDataHandler.currentZTMDataSnapShot[key]=value}}for(var i=0;i<internalQueue.length;i++){var eventName=internalQueue[i];if(eventName!==EventHandler.CONSTANTS.LINK_CLICK_EVENT){EventHandler.transmitCustomEvent(eventName)}}}},getValue:function(variableName){if(ZTMDataHandler.currentZTMDataSnapShot.hasOwnProperty(variableName)){return ZTMDataHandler.currentZTMDataSnapShot[variableName]}return""},processQueue:function(){window[DATA_VARIABLE_NAME]=window[DATA_VARIABLE_NAME]?window[DATA_VARIABLE_NAME]:[];var queue=window[DATA_VARIABLE_NAME];for(var i=0;i<queue.length;i++){var dataObject=queue[i];ZTMDataHandler.processDataObjectPush(dataObject,true)}window[DATA_VARIABLE_NAME].push=function(){ZTMDataHandler.processDataObjectPush(arguments[0]);return Array.prototype.push.apply(this,arguments)}},dispatchEventQueue:function(){var length=ZTMDataHandler.customEventQueue.length;for(var i=0;i<length;i++){var event=ZTMDataHandler.customEventQueue[i];EventHandler.transmitCustomEvent(event)}}};var ztm={exists:function(value){if(value===undefined||value===null||value===""){return false}if(typeof value=="object"&&Object.keys(value).length==0){return false}if(value.constructor==Object&&Object.keys(value).length==0){return false}return true},parseURL:isHostMatch:function(host1,host2,exlwww){exlwww=!!exlwww;if(!exlwww&&host1===host2){return true}else if(exlwww&&host1.replace(/^www./,"")===host2.replace(/^www./,"")){return true}else{return false}}};var varvalidation={contains:function(str,val){if(str.indexOf(val)>-1){return true}else{return false}},startsWith:function(str,val){if(str.startsWith(val)){return true}else{return false}},endsWith:function(str,val){if(str.endsWith(val)){return true}else{return false}},matchRegex:function(str,regex){if(!(regex instanceof RegExp)){regex=new RegExp(regex,"g")}if(regex.test(str)){return true}else{return false}},notMatchRegex:getCurrentURLComponent:function(ctype,paramName){return this.getURLComponent(document.URL,ctype,paramName)},getReferrerURLComponent:getURLComponent:function(url,ctype,paramName){if(!ztm.exists(url)){return""}var parsedURL=ztm.parseURL(url);switch(ctype){case 1:return parsedURL.toString();case 2:return parsedURL.protocol||undefined;case 3:return parsedURL.host||undefined;case 4:return parsedURL.port||undefined;case 5:return parsedURL.pathname||undefined;case 6:return parsedURL.searchParams.get(paramName)||undefined;break;default:break}},getCustomJSValue:function(funcName){try{var func=config[funcName];return func()}catch(e){LOGGER.error("Error occured while executing custom JS:",funcName,", Error:",e)}},getFirstPartyCookieValue:function(cookieKey){try{var cookieKeyRegex=new RegExp(cookieKey+"=([^;]*)");var matches=document.cookie.match(cookieKeyRegex);if(ztm.exists(matches)){return matches[1]}}catch(e){LOGGER.error("Error occured while getting FP cookie:",cookieKey,", Error:",e)}},validate:function(operator,value1,value2){if(!ztm.exists(operator)||!ztm.exists(value1)||!ztm.exists(value2)){return false}switch(operator){case 0:return value1===value2;break;case 1:return value1!==value2;break;case 2:return this.contains(value1,value2);break;case 3:return!this.contains(value1,value2);break;case 4:return this.startsWith(value1,value2);break;case 5:return!this.startsWith(value1,value2);break;case 6:return this.endsWith(value1,value2);break;case 7:return!this.endsWith(value1,value2);break;case 8:return this.matchRegex(value1,value2);break;case 9:return!this.matchRegex(value1,value2);break;case 10:return value1<value2;break;case 11:return value1<=value2;break;case 12:return value1>value2;break;case 13:return value1>=value2;break;default:return false;break}},getVariableValue:function(variable,key){try{if(!ztm.exists(variable)){return}switch(variable.type){case 1:return this.getCurrentURLComponent(variable.subType,variable.paramName);case 2:return this.getReferrerURLComponent(variable.subType,variable.paramName);case 3:case 4:case 7:return this.getCustomJSValue(key);case 5:return ZTMDataHandler.getValue(variable.dataLayerName);case 6:return this.getFirstPartyCookieValue(variable.cookieKey);default:break}}catch(error){LOGGER.error("Error occured while processing variable:",variable,", Error:",error)}},getVariableFromId:function(vid){if(!ztm.exists(vid)){return null}return data.variables[vid]},isFiltersSatistied:function(filters){for(var i=0;i<filters.length;i++){var filter=filters[i];var key=filter.key;var variable=this.getVariableFromId(filter.key);var variable_value=this.getVariableValue(variable,key);var flag=this.validate(filter.operator,variable_value,filter.value);if(!flag){return false}}return true}};function processTag(tag){try{if(tag.type==1){var html=tag.html;var exp=new RegExp("{{(.*?)}}","g");var match=exp.exec(html);var variableValueMap={};while(match){var variableName=match[1];if(!variableValueMap.hasOwnProperty(variableName)){var variable=varvalidation.getVariableFromId(variableName);var value=varvalidation.getVariableValue(variable,variableName);variableValueMap[variableName]=value}match=exp.exec(html)}for(var key in variableValueMap){var value=ZTMZSEC.Encoder.encodeForJavaScript(variableValueMap[key]);html=html.replace(new RegExp("{{"+key+"}}","g"),value)}LOGGER.log("After replacing variables:",html);window.postscribe(document.getElementsByTagName("body")[0],html);LOGGER.debug("Tag applied successfully:",tag,", Result html:",html)}}catch(ex){LOGGER.error("Exception occured while executing tag",ex,"::Tag content::",tag)}}function sortTags(tags){try{if(tags&&tags.length>0){var getBeforeRefs=function(value){var beforeRefs=[];for(var i=0;i<tags.length;i++){var ele=tags[i];if(ele.before_fire===value){beforeRefs.push(ele)}}return beforeRefs};var incrementScore=function(value,additionalScore){for(var i=0;i<tags.length;i++){if(tags[i].name===value){tags[i].score=tags[i].score+1;if(additionalScore){tags[i].score=tags[i].score+additionalScore}}}};var findElement=function(value){for(var i=0;i<tags.length;i++){var ele=tags[i];if(ele.name===value){return ele}}};var traverseAndSetScore=function(elem,list,parent){if(elem.after_fire){var bef=findElement(elem.after_fire);if(bef){if(list.indexOf(bef.name)===-1){incrementScore(parent);list.push(bef.name);traverseAndSetScore(bef,list,parent)}}}else{var beforeRefs=getBeforeRefs(elem.name);for(var i=0;i<beforeRefs.length;i++){if(list.indexOf(beforeRefs[i].name)===-1){incrementScore(parent);list.push(beforeRefs[i].name);traverseAndSetScore(beforeRefs[i],list,parent)}}}};for(var i=0;i<tags.length;i++){traverseAndSetScore(tags[i],[tags[i].name],tags[i].name)}tags.sort(}}catch(error){LOGGER.error("Exception occured while sorting tags:",error)}return tags}var EventHandler={CONSTANTS:{JS_CUSTOM_EVENT_NAME:"ztm.customevent",WINDOW_LOAD_EVENT:"ztm_event.windowload",DOM_READY_EVENT:"ztm_event.domready",PAGE_LOAD_EVENT:"ztm_event.pageload",CLICK_EVENT:"ztm_event.click",LINK_CLICK_EVENT:"ztm_event.linkclick",EVENT_TRIGGER_MAP:{"ztm_event.windowload":3,"ztm_event.domready":2,"ztm_event.pageload":1,"ztm_event.click":5,"ztm_event.linkclick":6},ELEMENT_ATTRIUTES:{ELEMENT:"ztm.element",ELEMENT_ID:"ztm.elementId",ELEMENT_ATTRIUTE:"ztm.elementAttribute",ELEMENT_CLASS:"ztm.elementClasses",ELEMENT_TARGET:"ztm.elementTarget",ELEMENT_TEXT:"ztm.elementText",ELEMENT_URL:"ztm.elementUrl",ELEMENT_TYPE:"ztm.elementType"}},transmitCustomEvent:onPageLoad:function(){var eventobj={};eventobj.event=EventHandler.CONSTANTS.PAGE_LOAD_EVENT;window[DATA_VARIABLE_NAME].push(eventobj)},onClick:function(event){try{var eventobj={};var element=event.target;if(data.is_click_link_present&&element.nodeName==="A"&&ztm.exists(element.href)){eventobj.event=EventHandler.CONSTANTS.LINK_CLICK_EVENT}else{eventobj.event=EventHandler.CONSTANTS.CLICK_EVENT}eventobj[EventHandler.CONSTANTS.ELEMENT_ATTRIUTES.ELEMENT]=element;eventobj[EventHandler.CONSTANTS.ELEMENT_ATTRIUTES.ELEMENT_ID]=element.id;eventobj[EventHandler.CONSTANTS.ELEMENT_ATTRIUTES.ELEMENT_CLASS]=element.classList.value;eventobj[EventHandler.CONSTANTS.ELEMENT_ATTRIUTES.ELEMENT_TARGET]=element.target;eventobj[EventHandler.CONSTANTS.ELEMENT_ATTRIUTES.ELEMENT_TEXT]=element.innerText;eventobj[EventHandler.CONSTANTS.ELEMENT_ATTRIUTES.ELEMENT_URL]=element.href;eventobj[EventHandler.CONSTANTS.ELEMENT_ATTRIUTES.ELEMENT_TYPE]=element.nodeType;window[DATA_VARIABLE_NAME].push(eventobj);LOGGER.debug("Event triggered",eventobj,event);if(eventobj.event===EventHandler.CONSTANTS.LINK_CLICK_EVENT){EventHandler.onCustomEvent(event)}}catch(error){LOGGER.error("Error occured in click trigger",error)}},onDOMReady:function(){EventHandler.onPageLoad();if(data.click_listener_required){document.body.addEventListener("click",EventHandler.onClick)}var eventobj={};eventobj.event=EventHandler.CONSTANTS.DOM_READY_EVENT;window[DATA_VARIABLE_NAME].push(eventobj)},onWindowLoadEvent:function(){var eventobj={};eventobj.event=EventHandler.CONSTANTS.WINDOW_LOAD_EVENT;window[DATA_VARIABLE_NAME].push(eventobj)},reTriggerClick:function(event){document.body.removeEventListener("click",EventHandler.onClick);event.target.click();document.body.addEventListener("click",EventHandler.onClick)},handleLinkClickDelay:function(linkClickTriggers,event){var waitTime=0;for(var key in linkClickTriggers){var trigger=linkClickTriggers[key];if(trigger.wait_for_tag){waitTime=waitTime<trigger.wait_time?trigger.wait_time:waitTime}}if(waitTime>0){event.preventDefault();return setTimeout(function(){EventHandler.reTriggerClick(event)},waitTime)}},onCustomEvent:function(event){var isLinkClickEvent=event instanceof MouseEvent;var eventName=isLinkClickEvent?EventHandler.CONSTANTS.LINK_CLICK_EVENT:event.detail;var validTriggers={};var timeout=null;try{if(EventHandler.CONSTANTS.EVENT_TRIGGER_MAP.hasOwnProperty(eventName)){var triggerType=EventHandler.CONSTANTS.EVENT_TRIGGER_MAP[eventName];var triggers=TriggerHandler.getValidTriggersByType(triggerType);if(isLinkClickEvent){timeout=EventHandler.handleLinkClickDelay(triggers,event)}validTriggers=triggers}var customEventTriggers=TriggerHandler.getValidTriggersByType(TriggerHandler.triggerTypes.CUSTOM_EVENT,eventName);validTriggers=Object.assign(validTriggers,customEventTriggers);var tagList=[];var sortingRequired=false;for(var key in validTriggers){var trigger=validTriggers[key];var tags=trigger.tags;LOGGER.log("Triggered:",key,", tags to be applied:",tags);for(var j=0;j<tags.length;j++){var tagid=tags[j];var tag=data.tags[tagid];tag.name=tagid;tag.score=0;tagList.push(tag);if(!sortingRequired&&(tag.before_fire&&tag.before_fire.length>0||tag.after_fire&&tag.after_fire.length>0)){sortingRequired=true}}}if(sortingRequired){tagList=sortTags(tagList);LOGGER.debug("Tags sorted: execution order: ",tagList)}for(var j=0;j<tagList.length;j++){var tag=tagList[j];if(ztm.exists(tag.exceptions)){var exceptionAvailable=false;for(var i=0;i<tag.exceptions.length;i++){var exceptionTrigger=tag.exceptions[i];if(validTriggers.hasOwnProperty(exceptionTrigger)){exceptionAvailable=true;LOGGER.debug("Skipping the tag as it is having an exception with trigger",tag,"exceptionTrigger:",exceptionTrigger);break}}if(exceptionAvailable){continue}}processTag(tag);LOGGER.debug("Tag applied:",tag.name,", Tag content:",tag)}}catch(error){LOGGER.error("Exception occured",error)}if(timeout!=null){clearTimeout(timeout);EventHandler.reTriggerClick(event)}},registerListeners:function(){try{if(window.addEventListener){window.addEventListener(JS_CUSTOM_EVENT_NAME,EventHandler.onCustomEvent,false)}else{window.attachEvent(JS_CUSTOM_EVENT_NAME,EventHandler.onCustomEvent)}}catch(error){LOGGER.error("Exception occured while registering Custom event",error)}try{if(document.readyState=="loading"){document.addEventListener("DOMContentLoaded",EventHandler.onDOMReady,false)}else{EventHandler.onDOMReady()}}catch(error){LOGGER.error("Exception occured while registering DOM load event",error)}try{if(window.addEventListener){if(["complete"].indexOf(document.readyState)!==-1){EventHandler.onWindowLoadEvent()}else{window.addEventListener("load",EventHandler.onWindowLoadEvent,false)}}else{if(["complete"].indexOf(document.readyState)!==-1){EventHandler.onWindowLoadEvent()}else{window.attachEvent("onload",EventHandler.onWindowLoadEvent)}}}catch(error){LOGGER.error("Exception occured while registering Custom event",error)}}};var TriggerHandler={triggerTypes:{PAGE_VIEW:1,DOM_READY:2,WINDOW_READY:3,CUSTOM_EVENT:4},triggersByType:{},processTriggers:function(){var triggers=data.triggers;if(!ztm.exists(triggers)){return}for(var triggerid in triggers){if(triggers.hasOwnProperty(triggerid)){var trigger=triggers[triggerid];if(!TriggerHandler.triggersByType.hasOwnProperty(trigger.type)){TriggerHandler.triggersByType[trigger.type]={}}TriggerHandler.triggersByType[trigger.type][triggerid]=trigger}}},getTriggersByType:function(triggerType){if(TriggerHandler.triggersByType.hasOwnProperty(triggerType)){return TriggerHandler.triggersByType[triggerType]}return{}},isTriggerFiltersSatisfied:function(trigger){if(!ztm.exists(trigger.filters)){return true}return varvalidation.isFiltersSatistied(trigger.filters)},getValidTriggersByType:function(triggerType,customEventName){var triggers=TriggerHandler.getTriggersByType(triggerType);var validTriggers={};for(var key in triggers){var trigger=triggers[key];if(customEventName){var triggerMatches=trigger.custom_event_use_regex?varvalidation.matchRegex(trigger,trigger.custom_event_name):trigger.custom_event_name===event.detail;if(!triggerMatches){continue}}if(TriggerHandler.isTriggerFiltersSatisfied(trigger)){validTriggers[key]=trigger}}return validTriggers}};function start(){try{ZTMDataHandler.processQueue();TriggerHandler.processTriggers();EventHandler.registerListeners();ZTMDataHandler.dispatchEventQueue()}catch(e){LOGGER.log("Exception occured on start of script",error)}}start()})(window);
