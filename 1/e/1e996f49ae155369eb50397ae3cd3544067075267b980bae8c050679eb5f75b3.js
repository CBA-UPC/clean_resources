import{_ as S}from"./preload-helper.0HuHagjb.js";import{s as C,f as I,h as A,j as M,d as E,k as f,l as w,i as R,m as v,n as L,r as k,b as H,o as O,p as j,q,t as z}from"./scheduler.6hyDou9G.js";import{S as B,i as F,r as W}from"./index.hQc_5nPF.js";import{h as G}from"./hasInteractedStore.i-gyaskG.js";import{l as J}from"./logger.rxQQzaAn.js";function K(i){let e,o,m,c,r,u=!1,n,_=!0,h,d;function s(){cancelAnimationFrame(n),e.paused||(n=W(s),u=!0),i[12].call(e)}return{c(){e=I("video"),this.h()},l(l){e=A(l,"VIDEO",{class:!0,"data-test-id":!0,id:!0,preload:!0,src:!0}),M(e).forEach(E),this.h()},h(){e.autoplay=o=!i[2],e.muted=i[0],f(e,"class",m=`h-full w-full object-cover ${i[3]}`),e.controls=!1,f(e,"data-test-id","video-nowPlaying"),f(e,"id",c=i[2]?"video-nowPlaying":"video-gating"),e.playsInline=!0,f(e,"preload","metadata"),w(e.src,r=i[1])||f(e,"src",r)},m(l,a){R(l,e,a),i[11](e),isNaN(i[7])||(e.volume=i[7]),h||(d=[v(e,"timeupdate",s),v(e,"play",i[13]),v(e,"pause",i[13]),v(e,"volumechange",i[14]),v(e,"ended",i[8])],h=!0)},p(l,[a]){a&4&&o!==(o=!l[2])&&(e.autoplay=o),a&1&&(e.muted=l[0]),a&8&&m!==(m=`h-full w-full object-cover ${l[3]}`)&&f(e,"class",m),a&4&&c!==(c=l[2]?"video-nowPlaying":"video-gating")&&f(e,"id",c),a&2&&!w(e.src,r=l[1])&&f(e,"src",r),!u&&a&16&&!isNaN(l[4])&&(e.currentTime=l[4]),u=!1,a&64&&_!==(_=l[6])&&e[_?"pause":"play"](),a&128&&!isNaN(l[7])&&(e.volume=l[7])},i:L,o:L,d(l){l&&E(e),i[11](null),h=!1,k(d)}}}function Q(i,e,o){let m;H(i,G,t=>o(16,m=t));let{muted:c=!0}=e,{src:r}=e,{shouldPlay:u=!1}=e,{isNowPlaying:n=!1}=e,{replayVideo:_=!1}=e,{optionalClass:h=""}=e,d=0,s,l=!0,a,y=1;const p=O(),T=()=>{n||(o(4,d=0),a.play())};j(async()=>{await g(),n&&(a&&a.addEventListener("loadedmetadata",()=>{setTimeout(()=>{p("videoLoaded")},500)}),setTimeout(()=>{m||p("videoLoaded")},2e3))}),q(()=>{a&&n&&a.removeEventListener("loadedmetadata",()=>{setTimeout(()=>{p("videoLoaded")},2e3)}),a&&(a.pause(),o(5,a.currentTime=0,a)),s==null||s.destroy()});const g=async()=>{if(!a||a.src.endsWith("mp4")||a.canPlayType("application/vnd.apple.mpegurl"))return;const t=(await S(()=>import("./hls.wCK1N_nH.js"),__vite__mapDeps([]),import.meta.url)).default;if(!t.isSupported()){J.error("HLS not supported.");return}s=new t({autoStartLoad:!0,backBufferLength:0,capLevelOnFPSDrop:!0,capLevelToPlayerSize:!0,fragLoadingMaxRetry:3,maxMaxBufferLength:10,startLevel:-1}),s.attachMedia(a),s.subtitleDisplay=!1,s.on(t.Events.ERROR,(U,P)=>{P.fatal&&P.type}),s.on(t.Events.MEDIA_ATTACHED,()=>{s.loadSource(r)})};function b(t){z[t?"unshift":"push"](()=>{a=t,o(5,a)})}function N(){d=this.currentTime,o(4,d)}function V(){l=this.paused,o(6,l)}function D(){y=this.volume,o(7,y)}return i.$$set=t=>{"muted"in t&&o(0,c=t.muted),"src"in t&&o(1,r=t.src),"shouldPlay"in t&&o(9,u=t.shouldPlay),"isNowPlaying"in t&&o(2,n=t.isNowPlaying),"replayVideo"in t&&o(10,_=t.replayVideo),"optionalClass"in t&&o(3,h=t.optionalClass)},i.$$.update=()=>{i.$$.dirty&548&&(u&&a&&n?a.play():!u&&a&&n&&a.pause()),i.$$.dirty&20&&d>60&&n&&p("videoPreviewEnd"),i.$$.dirty&1026&&(async()=>await g())()},[c,r,n,h,d,a,l,y,T,u,_,b,N,V,D]}class ee extends B{constructor(e){super(),F(this,e,Q,K,C,{muted:0,src:1,shouldPlay:9,isNowPlaying:2,replayVideo:10,optionalClass:3})}}export{ee as V};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
