{"playlistData":[[{"S_sysDate":"2023-12-25 07:59:00","S_headLine":"Inside Gwyneth Paltrow's Tranquil Family Home","S_shortSummary":"Today Architectural Digest is welcomed to Montecito, California by Gwyneth Paltrow for a tour of her peacefully luxurious family home. Paltrow first fell under the spell of Montee dream of building her first e assignment, Paltrow tapped her longtime collaborators Robin Standefer and Stephen Alesch of Roman and Williams, the AD100 firm that had previously designed th","S_tags":"Gwyneth Paltrow,Gwyneth Paltrow 2022,New Gwyneth Paltrow,Architectural Digest Gwyneth Paltrow,AD Gwyneth Paltrow,Open Door Gwyneth Paltrow,Gwyneth Paltrow Open Door,Gwyneth Paltrow Home,gwyneth paltrow home tour,gwyneth paltrow house tour,gwyneth paltrow house,gwyneth paltrow new house,gwyneth paltrow goop,gwyneth paltrow mansion,Gwyneth Paltrow Arch Digest,Arch Digest Gwyneth Paltrow,Gwyneth Paltrow Mansion Tour,AD Home Tour,gwyneth paltrow interview,Season: Season 1,Series:","C_ID":9683,"SM_ID":1769445,"SM_mediaStatusCD":"ACTIVE","SM_mediatypeCD":"Video","C_companyLogoFilename":null,"STL_leagueNameShort":"Conde Nast","thumbnailUrl":"//d29xw9s9x32j3w.cloudfront.net/videos\/video_thumb\/XL\/3ygy0z5n43nht97271yrdkh7xnh3mein.jpg","smThumbnailUrl":"//d29xw9s9x32j3w.cloudfront.net/videos\/video_thumb\/SM\/3ygy0z5n43nht97271yrdkh7xnh3mein.jpg","SM_M_FILENAME":"9O3RPj2lP0fd06b25f_6f26_4121_8c29_06ea6585e305high.mp4","SM_length":"768.725","SM_M_LENGTH":"768.725","level1":"General","level2":"News","level3":"NA","S_category":"--","CGL_name":null,"STL_ID":189,"videoConversions":{"CC_EN":"videos\/cc_text\/462p2944q5p1nspqn518pop74n1qqs42base.en.vtt","M3U8list":"videos\/m3u8\/videos\/m3u8\/s13o99219n0r613o940n1rp7n24spqs7playlist.m3u8","MP4300k":"videos\/video_mp4\/300k\/videos\/video_mp4\/300k\/s13o99219n0r613o940n1rp7n24spqs7.mp4"},"configuration":{"sources":{"src":"\/\/d29xw9s9x32j3w.cloudfront.net\/videos\/m3u8\/s13o99219n0r613o940n1rp7n24spqs7playlist.m3u8","type":"application\/x-mpegURL"},"poster":"//d29xw9s9x32j3w.cloudfront.net/videos\/video_thumb\/XL\/3ygy0z5n43nht97271yrdkh7xnh3mein.jpg","title":"Inside Gwyneth Paltrow's Tranquil Family Home","mediaid":1769445,"duration":"768.725","adschedule":{"Premium":{"tag":"https:\/\/pubads.g.doubleclick.net\/gampad\/ads?sz=480x270&iu=\/92056281,22960152043\/54098246&impl=s&gdfp_req=1&env=vp&output=vast&unviewed_position_start=1&url=__referrer__&description_url=https%3A%2F%2Fwww.sun-sentinel.com%2F2024%2F02%2F07%2Fask-amy-family-friends-poach-vacation-rental%2F&correlator=1707490105&cust_params=content%3D9683%26embed%3D2vl0veNa%26placementType%3DPremium%26domain%3Dsun-sentinel.com%26player_width%3D__player-width__%26player_height%3D__player-height__%26rand%3D11%26player_size%3D__player-size__%26play_code%3D__play-code__%26player_status%3D__player-status__%26player_type%3D__player-type__%26version%3D7.30.6-A%26schain%3Dstnvideo.com%2CSTN_0002637&cmsid=2460952&vid=1769445&ciu_szs=300x60"}}},"IAB_uniqueID":["87"]},{"S_sysDate":"2024-02-05 13:29:11","S_headLine":"Friends, family mourn long-time Derby coach William Boland","S_shortSummary":"Friends and family members mourned the loss of a beloved long-time coach in Derby.","S_tags":"Local","C_ID":9678,"SM_ID":3370000,"SM_mediaStatusCD":"ACTIVE","SM_mediatypeCD":"Video","C_companyLogoFilename":null,"STL_leagueNameShort":"News 12","thumbnailUrl":"//d29xw9s9x32j3w.cloudfront.net/videos\/video_thumb\/XL\/g0b2npy1s7a6pvwujl86nx5tygwn3gbq.jpg","smThumbnailUrl":"//d29xw9s9x32j3w.cloudfront.net/videos\/video_thumb\/SM\/g0b2npy1s7a6pvwujl86nx5tygwn3gbq.jpg","SM_M_FILENAME":"ybjemUdtwV4e6a9f81_16d6_466f_871b_f9e54b9ef511.mp4","SM_length":"14.18","SM_M_LENGTH":"14.18","level1":"General","level2":"News","level3":"NA","S_category":"--","CGL_name":null,"STL_ID":187,"videoConversions":{"CC_EN":"videos\/cc_text\/4onor4p20sn883oqn0o94o3r8o48483qbase.en.vtt","M3U8list":"videos\/m3u8\/videos\/m3u8\/8741ps0876os14p2nsp9642605r1o459playlist.m3u8","MP4300k":"videos\/video_mp4\/300k\/videos\/video_mp4\/300k\/8741ps0876os14p2nsp9642605r1o459.mp4"},"configuration":{"sources":{"src":"\/\/d29xw9s9x32j3w.cloudfront.net\/videos\/m3u8\/8741ps0876os14p2nsp9642605r1o459playlist.m3u8","type":"application\/x-mpegURL"},"poster":"//d29xw9s9x32j3w.cloudfront.net/videos\/video_thumb\/XL\/g0b2npy1s7a6pvwujl86nx5tygwn3gbq.jpg","title":"Friends, family mourn long-time Derby coach William Boland","mediaid":3370000,"duration":"14.18","adschedule":{"Premium":{"tag":"https:\/\/pubads.g.doubleclick.net\/gampad\/ads?sz=480x270&iu=\/92056281,22960152043\/54098246&impl=s&gdfp_req=1&env=vp&output=vast&unviewed_position_start=1&url=__referrer__&description_url=https%3A%2F%2Fwww.sun-sentinel.com%2F2024%2F02%2F07%2Fask-amy-family-friends-poach-vacation-rental%2F&correlator=1707490105&cust_params=content%3D9678%26embed%3D2vl0veNa%26placementType%3DPremium%26domain%3Dsun-sentinel.com%26player_width%3D__player-width__%26player_height%3D__player-height__%26rand%3D5%26player_size%3D__player-size__%26play_code%3D__play-code__%26player_status%3D__player-status__%26player_type%3D__player-type__%26version%3D7.30.6-A%26schain%3Dstnvideo.com%2CSTN_0002637&cmsid=2460952&vid=3370000&ciu_szs=300x60"}}},"IAB_uniqueID":["386"]},{"S_sysDate":"2023-10-31 16:37:08","S_headLine":"Healthy friends help you eat right","S_shortSummary":"Do you find yourself ordering a side of fries when your friends do too? In this video, Robin Miller, MD, explains how people are easily influenced by friends including when eating out. Pay attention to what people order and go for that salad.","S_tags":"demo:female,outcomes:diet-l1,robinmiller,diet,nutrition,rebrand,friends,social,social influence,3play_processed,sharecare-journey:master-journey,wide","C_ID":10362,"SM_ID":3138203,"SM_mediaStatusCD":"ACTIVE","SM_mediatypeCD":"Video","C_companyLogoFilename":null,"STL_leagueNameShort":"Sharecare","thumbnailUrl":"//d29xw9s9x32j3w.cloudfront.net/videos\/video_thumb\/XL\/uqwjtjlprq5ms4sin4b161ahp28uxb1a.jpg","smThumbnailUrl":"//d29xw9s9x32j3w.cloudfront.net/videos\/video_thumb\/SM\/uqwjtjlprq5ms4sin4b161ahp28uxb1a.jpg","SM_M_FILENAME":"69FXU0vfRCyVVJiL2JIH_3998347675001.mp4","SM_length":"90.207","SM_M_LENGTH":"90.228","level1":"General","level2":"News","level3":"NA","S_category":"--","CGL_name":null,"STL_ID":215,"videoConversions":{"CC_EN":"videos\/cc_text\/3070387107196412365412c067fd6c2.37481345base.en.vtt","M3U8list":"videos\/m3u8\/videos\/m3u8\/3070387107196412365412c067fd6c2.37481345playlist.m3u8","MP4300k":"videos\/video_mp4\/300k\/videos\/video_mp4\/300k\/3070387107196412365412c067fd6c2.37481345.mp4"},"configuration":{"sources":{"src":"\/\/d29xw9s9x32j3w.cloudfront.net\/videos\/m3u8\/3070387107196412365412c067fd6c2.37481345playlist.m3u8","type":"application\/x-mpegURL"},"poster":"//d29xw9s9x32j3w.cloudfront.net/videos\/video_thumb\/XL\/uqwjtjlprq5ms4sin4b161ahp28uxb1a.jpg","title":"Healthy friends help you eat right","mediaid":3138203,"duration":"90.207","adschedule":{"Premium":{"tag":"https:\/\/pubads.g.doubleclick.net\/gampad\/ads?sz=480x270&iu=\/92056281,22960152043\/54098246&impl=s&gdfp_req=1&env=vp&output=vast&unviewed_position_start=1&url=__referrer__&description_url=https%3A%2F%2Fwww.sun-sentinel.com%2F2024%2F02%2F07%2Fask-amy-family-friends-poach-vacation-rental%2F&correlator=1707490105&cust_params=content%3D10362%26embed%3D2vl0veNa%26placementType%3DPremium%26domain%3Dsun-sentinel.com%26player_width%3D__player-width__%26player_height%3D__player-height__%26rand%3D17%26player_size%3D__player-size__%26play_code%3D__play-code__%26player_status%3D__player-status__%26player_type%3D__player-type__%26version%3D7.30.6-A%26schain%3Dstnvideo.com%2CSTN_0002637&cmsid=2460952&vid=3138203&ciu_szs=300x60"}}},"IAB_uniqueID":["223"]},{"S_sysDate":"2023-10-16 20:35:08","S_headLine":"How friends influence your health","S_shortSummary":"Having a good social network of family and friends can motivate people to live healthier, happier lives. In this video, HealthMaker James Fowler, PhD, professor of medical genetics and political science at UCSD, explains why.","S_tags":"big data,facebook,healthcare,diabetes,health care,healthmakers,heart attack,main,outcomes:no-tag,patient data,personalized medicine,social network,transcription10,weight gain,physical,rebrand,jamesfowler,3play_processed","C_ID":10362,"SM_ID":3075686,"SM_mediaStatusCD":"ACTIVE","SM_mediatypeCD":"Video","C_companyLogoFilename":null,"STL_leagueNameShort":"Sharecare","thumbnailUrl":"//d29xw9s9x32j3w.cloudfront.net/videos\/video_thumb\/XL\/jwfm0tsdf0v4tmtik8s5hrbb3m3kksdl.jpg","smThumbnailUrl":"//d29xw9s9x32j3w.cloudfront.net/videos\/video_thumb\/SM\/jwfm0tsdf0v4tmtik8s5hrbb3m3kksdl.jpg","SM_M_FILENAME":"rQLTRXqPekvQgv4ipsKP_2573624614001.mp4","SM_length":"127.818","SM_M_LENGTH":"127.839","level1":"General","level2":"News","level3":"NA","S_category":"--","CGL_name":null,"STL_ID":215,"videoConversions":{"CC_EN":"videos\/cc_text\/3007863314916474652d9d4fd37b85.35642073base.en.vtt","M3U8list":"videos\/m3u8\/videos\/m3u8\/3007863314916474652d9d4fd37b85.35642073playlist.m3u8","MP4300k":"videos\/video_mp4\/300k\/videos\/video_mp4\/300k\/3007863314916474652d9d4fd37b85.35642073.mp4"},"configuration":{"sources":{"src":"\/\/d29xw9s9x32j3w.cloudfront.net\/videos\/m3u8\/3007863314916474652d9d4fd37b85.35642073playlist.m3u8","type":"application\/x-mpegURL"},"poster":"//d29xw9s9x32j3w.cloudfront.net/videos\/video_thumb\/XL\/jwfm0tsdf0v4tmtik8s5hrbb3m3kksdl.jpg","title":"How friends influence your health","mediaid":3075686,"duration":"127.818","adschedule":{"Premium":{"tag":"https:\/\/pubads.g.doubleclick.net\/gampad\/ads?sz=480x270&iu=\/92056281,22960152043\/54098246&impl=s&gdfp_req=1&env=vp&output=vast&unviewed_position_start=1&url=__referrer__&description_url=https%3A%2F%2Fwww.sun-sentinel.com%2F2024%2F02%2F07%2Fask-amy-family-friends-poach-vacation-rental%2F&correlator=1707490105&cust_params=content%3D10362%26embed%3D2vl0veNa%26placementType%3DPremium%26domain%3Dsun-sentinel.com%26player_width%3D__player-width__%26player_height%3D__player-height__%26rand%3D19%26player_size%3D__player-size__%26play_code%3D__play-code__%26player_status%3D__player-status__%26player_type%3D__player-type__%26version%3D7.30.6-A%26schain%3Dstnvideo.com%2CSTN_0002637&cmsid=2460952&vid=3075686&ciu_szs=300x60"}}},"IAB_uniqueID":["223"]},{"S_sysDate":"2024-01-15 20:03:00","S_headLine":"Inside Jesse Tyler Ferguson & Justin Mikita\u2019s Delightful L.A. Home","S_shortSummary":"Today AD is welcomed by Jesse Tyler Ferguson and Justin Mikita to tour their delightful home in Los Angeles. The Modern Family star and his husband decided to move to the leafy Encino hills of LA in a bid to create the perfect home for their evolving family life and aesthetic. Their vision was for a calm and cozy interior with plenty of space for the family to hang out. With the help of AD100\u2019s Mandy Cheng, they turned a blank new build into a warm, inviting space full of soft colors and snug re","S_tags":"Architectural digest,Arch Digest,Jesse Tyler Ferguson,Modern Family,Justin Mikita,Jesse Tyler Ferguson Husband,jesse tyler ferguson open door,Jesse Tyler Ferguson architectural digest,Jesse Tyler Ferguson house tour,celebrity house tour,open door,architectural digest open door,Mitchel Pritchett modern family,jesse tyler ferguson open door 2023,jesse tyler ferguson interview,celebrity interview,architectural digest celebrity house tour,inside celebrity homes,Season: Season 1,Se","C_ID":9683,"SM_ID":3249137,"SM_mediaStatusCD":"ACTIVE","SM_mediatypeCD":"Video","C_companyLogoFilename":null,"STL_leagueNameShort":"Conde Nast","thumbnailUrl":"//d29xw9s9x32j3w.cloudfront.net/videos\/video_thumb\/XL\/wpzzp665zkmrp9b1ocj9tnllhmk4s5y0.jpg","smThumbnailUrl":"//d29xw9s9x32j3w.cloudfront.net/videos\/video_thumb\/SM\/wpzzp665zkmrp9b1ocj9tnllhmk4s5y0.jpg","SM_M_FILENAME":"RvYeTJhEHt03822bad_d2a4_4310_a6da_f557037caca6high.mp4","SM_length":"928.394","SM_M_LENGTH":"928.394","level1":"General","level2":"News","level3":"NA","S_category":"--","CGL_name":null,"STL_ID":189,"videoConversions":{"CC_EN":"videos\/cc_text\/r23s281q13p83rsrrsqps2501p9s95p6base.en.vtt","M3U8list":"videos\/m3u8\/videos\/m3u8\/00352n03847r8qs68p2668p8152n127pplaschedule":{"Premium":{"tag":"https:\/\/pubads.g.doubleclick.net\/gampad\/ads?sz=480x270&iu=\/92056281,22960152043\/54098246&impl=s&gdfp_req=1&env=vp&output=vast&unviewed_position_start=1&url=__referrer__&description_url=https%3A%2F%2Fwww.sun-sentinel.com%2F2024%2F02%2F02%2Fthe-calendar-for-february-2024-and-beyond%2F&correlator=1707490105&cust_params=content%3D11842%26embed%3DgbDoqmaV%26placementType%3DPremium%26domain%3Dsun-sentinel.com%26player_width%3D__player-width__%26player_height%3D__player-height__%26rand%3D6%26player_size%3D__player-size__%26play_code%3D__play-code__%26player_status%3D__player-status__%26player_type%3D__player-type__%26version%3D7.30.2%26schain%3Dstnvideo.com%2CSTN_0002637&cmsid=2460952&vid=3360702&ciu_szs=300x60"}}},"videoConversions":{"M3U8list":"videos\/m3u8\/videos\/m3u8\/329304458177686165bd3cde4773e8.24246553playlist.m3u8"},"IAB_uniqueID":["483"]},{"S_ID":3316360,"SM_ID":3384011,"C_ID":10593,"S_sysDate":"2024-02-09 14:31:26","S_headLine":"7 Day Weather Forecast for LOS ANGELES, CA for February 09, 2024","S_shortSummary":null,"S_fullStory":null,"S_tags":"Local Weather Forecast, 7 Day Forecast, Weather Conditions, Precipitation, Dew Point, Humidity, Temperature, Temperature Hi\/Lo, Los Angeles, Ca","SM_mediaStatusCD":"ACTIVE","SM_mediatypeCD":"Video","SM_cutline":"","SM_orgFileName":"Guu5eOStFhFZeytQ31C76e72713a7bb85461690953d6c5240584.mp4","thumbnailUrl":"\/\/d29xw9s9x32j3w.cloudfront.net\/videos\/video_thumb\/XL\/k5bx3l3s5m1gc45wop6nrmvy2vvxxs8w.png","smThumbnailUrl":"\/\/d29xw9s9x32j3w.cloudfront.net\/videos\/video_thumb\/SM\/k5bx3l3s5m1gc45wop6nrmvy2vvxxs8w.png","SM_M_FILENAME":"Guu5eOStFhFZeytQ31C76e72713a7bb85461690953d6c5240584.mp4","SM_length":"36.001","SRD_limtedtoUserType":null,"SRD_limtedtoUserSubType":null,"SRD_limitedtoPlatform":null,"SSR_restrictionStart":null,"SSR_restrictionEnd":null,"CAU_statusCD":"ALLOW","S_embedAvailableUntilCA":"2099-01-03 00:00:00","S_embedAvailableUntilUSA":"2099-01-03 00:00:00","S_embedAvailableUntilWRLD":"2099-01-03 00:00:00","S_rankDate":"2024-02-09 14:31:26","level1":"General","level2":"Weather","level3":"NA","S_category":"Science","STL_ID":230,"configuration":{"poster":"\/\/d29xw9s9x32j3w.cloudfront.net\/videos\/video_thumb\/XL\/k5bx3l3s5m1gc45wop6nrmvy2vvxxs8w.png","title":"7 Day Weather Forecast for LOS ANGELES, CA for February 09, 2024","mediaid":3384011,"duration":"36.001","adschedule":{"Premium":{"tag":"https:\/\/pubads.g.doubleclick.net\/gampad\/ads?sz=480x270&iu=\/92056281,22960152043\/54098246&impl=s&gdfp_req=1&env=vp&output=vast&unviewed_position_start=1&url=__referrer__&description_url=https%3A%2F%2Fwww.sun-sentinel.com%2F2024%2F02%2F02%2Fthe-calendar-for-february-2024-and-beyond%2F&correlator=1707490105&cust_params=content%3D10593%26embed%3DgbDoqmaV%26placementType%3DPremium%26domain%3Dsun-sentinel.com%26player_width%3D__player-width__%26player_height%3D__player-height__%26rand%3D17%26player_size%3D__player-size__%26play_code%3D__play-code__%26player_status%3D__player-status__%26player_type%3D__player-type__%26version%3D7.30.2%26schain%3Dstnvideo.com%2CSTN_0002637&cmsid=2460952&vid=3384011&ciu_szs=300x60"}},"sources":{"src":"\/\/d29xw9s9x32j3w.cloudfront.net\/videos\/m3u8\/qonq24rrn26r9p671648294nq17qqn48playlist.m3u8","type":"application\/x-mpegURL"}},"videoConversions":{"M3U8list":"videos\/m3u8\/videos\/m3u8\/qonq24rrn26r9p671648294nq17qqn48playlist.m3u8"},"IAB_uniqueID":["390"]},{"S_ID":3316362,"SM_ID":3384013,"C_ID":10597,"S_sysDate":"2024-02-09 14:31:24","S_headLine":"7 Day Weather Forecast for SAN DIEGO, CA for February 09, 2024","S_shortSummary":null,"S_fullStory":null,"S_tags":"Local Weather Forecast, 7 Day Forecast, Weather Conditions, Precipitation, Dew Point, Humidity, Temperature, Temperature Hi\/Lo, San Diego, Ca","SM_mediaStatusCD":"ACTIVE","SM_mediatypeCD":"Video","SM_cutline":"","SM_orgFileName":"yUIDFFXmawdFelCGI6Hr97f8c87694b4a2d3019f7fe5543afd97.mp4","thumbnailUrl":"\/\/d29xw9s9x32j3w.cloudfront.net\/videos\/video_thumb\/XL\/6z68k2b9bxq5n4f1k2v8q1h93h5vasql.png","smThumbnailUrl":"\/\/d29xw9s9x32j3w.cloudfront.net\/videos\/video_thumb\/SM\/6z68k2b9bxq5n4f1k2v8q1h93h5vasql.png","SM_M_FILENAME":"yUIDFFXmawdFelCGI6Hr97f8c87694b4a2d3019f7fe5543afd97.mp4","SM_length":"36.001","SRD_limtedtoUserType":null,"SRD_limtedtoUserSubType":null,"SRD_limitedtoPlatform":null,"SSR_restrictionStart":null,"SSR_restrictionEnd":null,"CAU_statusCD":"ALLOW","S_embedAvailableUntilCA":"2099-01-03 00:00:00","S_embedAvailableUntilUSA":"2099-01-03 00:00:00","S_embedAvailableUntilWRLD":"2099-01-03 00:00:00","S_rankDate":"2024-02-09 14:31:24","level1":"General","level2":"Weather","level3":"NA","S_category":"Science","STL_ID":230,"configuration":{"poster":"\/\/d29xw9s9x32j3w.cloudfront.net\/videos\/video_thumb\/XL\/6z68k2b9bxq5n4f1k2v8q1h93h5vasql.png","title":"7 Day Weather Forecast for SAN DIEGO, CA for February 09, 2024","mediaid":3384013,"duration":"36.001","adschedule":{"Premium":{"tag":"https:\/\/pubads.g.doubleclick.net\/gampad\/ads?sz=480x270&iu=\/92056281,22960152043\/54098246&impl=s&gdfp_req=1&env=vp&output=vast&unviewed_position_start=1&url=__referrer__&description_url=https%3A%2F%2Fwww.sun-sentinel.com%2F2024%2F02%2F02%2Fthe-calendar-for-february-2024-and-beyond%2F&correlator=1707490105&cust_params=content%3D10597%26embed%3DgbDoqmaV%26placementType%3DPremium%26domain%3Dsun-sentinel.com%26player_width%3D__player-width__%26player_height%3D__player-height__%26rand%3D6%26player_size%3D__player-size__%26play_code%3D__play-code__%26player_status%3D__player-status__%26player_type%3D__player-type__%26version%3D7.30.2%26schain%3Dstnvideo.com%2CSTN_0002637&cmsid=2460952&vid=3384013&ciu_szs=300x60"}},"sources":{"src":"\/\/d29xw9s9x32j3w.cloudfront.net\/videos\/m3u8\/6760r731qo234s3378pqro95p08snsr5playlist.m3u8","type":"application\/x-mpegURL"}},"videoConversions":{"M3U8list":"videos\/m3u8\/videos\/m3u8\/6760r731qo234s3378pqro95p08snsr5playlist.m3u8"},"IAB_uniqueID":["390"]},{"S_ID":3316364,"SM_ID":3384015,"C_ID":10608,"S_sysDate":"2024-02-09 14:31:22","S_headLine":"7 Day Weather Forecast for SACRAMENTO, CA for February 09, 2024","S_shortSummary":null,"S_fullStory":null,"S_tags":"Local Weather Forecast, 7 Day Forecast, Weather Conditions, Precipitation, Dew Point, Humidity, Temperature, Temperature Hi\/Lo, Sacramento, Ca","SM_mediaStatusCD":"ACTIVE","SM_mediatypeCD":"Video","SM_cutline":"","SM_orgFileName":"ctTN8oSQf5HjmgAu1ibX7230ce55792f165213a4a59f8a63a217.mp4","thumbnailUrl":"\/\/d29xw9s9x32j3w.cloudfront.net\/videos\/video_thumb\/XL\/gsyr04kghjhs0ntqch1wfa32wm6i93g5.png","smThumbnailUrl":"\/\/d29xw9s9x32j3w.cloudfront.net\/videos\/video_thumb\/SM\/gsyr04kghjhs0ntqch1wfa32wm6i93g5.png","SM_M_FILENAME":"ctTN8oSQf5HjmgAu1ibX7230ce55792f165213a4a59f8a63a217.mp4","SM_length":"36.001","SRD_limtedtoUserType":null,"SRD_limtedtoUserSubType":null,"SRD_limitedtoPlatform":null,"SSR_restrictionStart":null,"SSR_restrictionEnd":null,"CAU_statusCD":"ALLOW","S_embedAvailableUntilCA":"2099-01-03 00:00:00","S_embedAvailableUntilUSA":"2099-01-03 00:00:00","S_embedAvailableUntilWRLD":"2099-01-03 00:00:00","S_rankDate":"2024-02-09 14:31:22","level1":"General","level2":"Weather","level3":"NA","S_category":"Science","STL_ID":230,"configuration":{"poster":"\/\/d29xw9s9x32j3w.cloudfront.net\/videos\/video_thumb\/XL\/gsyr04kghjhs0ntqch1wfa32wm6i93g5.png","title":"7 Day Weather Forecast for SACRAMENTO, CA for February 09, 2024","mediaid":3384015,"duration":"36.001","adschedule":{"Premium":{"tag":"https:\/\/pubads.g.doubleclick.net\/gampad\/ads?sz=480x270&iu=\/92056281,22960152043\/54098246&impl=s&gdfp_req=1&env=vp&output=vast&unviewed_position_start=1&url=__referrer__&description_url=https%3A%2F%2Fwww.sun-sentinel.com%2F2024%2F02%2F02%2Fthe-calendar-for-february-2024-and-beyond%2F&correlator=1707490105&cust_params=content%3D10608%26embed%3DgbDoqmaV%26placementType%3DPremium%26domain%3Dsun-sentinel.com%26player_width%3D__player-width__%26player_height%3D__player-height__%26rand%3D17%26player_size%3D__player-size__%26play_code%3D__play-code__%26player_status%3D__player-status__%26player_type%3D__player-type__%26version%3D7.30.2%26schain%3Dstnvideo.com%2CSTN_0002637&cmsid=2460952&vid=3384015&ciu_szs=300x60"}},"sources":{"src":"\/\/d29xw9s9x32j3w.cloudfront.net\/videos\/m3u8\/s8s45262on94p15qonr0q253o6ps2rp2playlist.m3u8","type":"application\/x-mpegURL"}},"videoConversions":{"M3U8list":"videos\/m3u8\/videos\/m3u8\/s8s45262on94p15qonr0q253o6ps2rp2playlist.m3u8"},"IAB_uniqueID":["390"]},{"S_ID":3316369,"SM_ID":3384020,"C_ID":10611,"S_sysDate":"2024-02-09 14:31:17","S_headLine":"7 Day Weather Forecast for PORTLAND, OR for February 09, 2024","S_shortSummary":null,"S_fullStory":null,"S_tags":"Local Weather Forecast, 7 Day Forecast, Weather Conditions, Precipitation, Dew Point, Humidity, Temperature, Temperature Hi\/Lo, Portland, Or","SM_mediaStatusCD":"ACTIVE","SM_mediatypeCD":"Video","SM_cutline":"","SM_orgFileName":"agWJTFIGSzOoX4rIF47Fd75a08a666bb51680925323b7f123304.mp4","thumbnailUrl":"\/\/d29xw9s9x32j3w.cloudfront.net\/videos\/video_thumb\/XL\/0a3ba4qovbw5gn1ubijwiolbh75ooqyv.png","smThumbnailUrl":"\/\/d29xw9s9x32j3w.cloudfront.net\/videos\/video_thumb\/SM\/0a3ba4qovbw5gn1ubijwiolbh75ooqyv.png","SM_M_FILENAME":"agWJTFIGSzOoX4rIF47Fd75a08a666bb51680925323b7f123304.mp4","SM_length":"36.001","SRD_limtedtoUserType":null,"SRD_limtedtoUserSubType":null,"SRD_limitedtoPlatform":null,"SSR_restrictionStart":null,"SSR_restrictionEnd":null,"CAU_statusCD":"ALLOW","S_embedAvailableUntilCA":"2099-01-03 00:00:00","S_embedAvailableUntilUSA":"2099-01-03 00:00:00","S_embedAvailableUntilWRLD":"2099-01-03 00:00:00","S_rankDate":"2024-02-09 14:31:17","level1":"General","level2":"Weather","level3":"NA","S_category":"Science","STL_ID":230,"configuration":{"poster":"\/\/d29xw9s9x32j3w.cloudfront.net\/videos\/video_thumb\/XL\/0a3ba4qovbw5gn1ubijwiolbh75ooqyv.png","title":"7 Day Weather Forecast for PORTLAND, OR for February 09, 2024","mediaid":3384020,"duration":"36.001","adschedule":{"Premium":{"tag":"https:\/\/pubads.g.doubleclick.net\/gampad\/ads?sz=480x270&iu=\/92056281,22960152043\/54098246&impl=s&gdfp_req=1&env=vp&output=vast&unviewed_position_start=1&url=__referrer__&description_url=https%3A%2F%2Fwww.sun-sentinel.com%2F2024%2F02%2F02%2Fthe-calendar-for-february-2024-and-beyond%2F&correlator=1707490105&cust_params=content%3D10611%26embed%3DgbDoqmaV%26placementType%3DPremium%26domain%3Dsun-sentinel.com%26player_width%3D__player-width__%26player_height%3D__player-height__%26rand%3D5%26player_size%3D__player-size__%26play_code%3D__play-code__%26player_status%3D__player-status__%26player_type%3D__player-type__%26version%3D7.30.2%26schain%3Dstnvideo.com%2CSTN_0002637&cmsid=2460952&vid=3384020&ciu_szs=300x60"}},"sources":{"src":"\/\/d29xw9s9x32j3w.cloudfront.net\/videos\/m3u8\/670o5p1s50016396q7np15ps05op2qppplaylist.m3u8","type":"application\/x-mpegURL"}},"videoConversions":{"M3U8list":"videos\/m3u8\/videos\/m3u8\/670o5p1s50016396q7np15ps05op2qppplaylist.m3u8"},"IAB_uniqueID":["390"]},{"S_ID":3316371,"SM_ID":3384022,"C_ID":11314,"S_sysDate":"2024-02-09 14:31:15","S_headLine":"7 Day Weather Forecast for LAS VEGAS, NV for February 09, 2024","S_shortSummary":null,"S_fullStory":null,"S_tags":"Local Weather Forecast, 7 Day Forecast, Weather Conditions, Precipitation, Dew Point, Humidity, Temperature, Temperature Hi\/Lo, Las Vegas, Nv","SM_mediaStatusCD":"ACTIVE","SM_mediatypeCD":"Video","SM_cutline":"","SM_orgFileName":"KKlsSPJKcLbTTxK7iobk4f6217df2cba142fa150c802a66b5cd9.mp4","thumbnailUrl":"\/\/d29xw9s9x32j3w.cloudfront.net\/videos\/video_thumb\/XL\/2e1ohruak8z47uim94f62osp0g3zklvc.png","smThumbnailUrl":"\/\/d29xw9s9x32j3w.cloudfront.net\/videos\/video_thumb\/SM\/2e1ohruak8z47uim94f62osp0g3zklvc.png","SM_M_FILENAME":"KKlsSPJKcLbTTxK7iobk4f6217df2cba142fa150c802a66b5cd9.mp4","SM_length":"36.001","SRD_limtedtoUserType":null,"SRD_limtedtoUserSubType":null,"SRD_limitedtoPlatform":null,"SSR_restrictionStart":null,"SSR_restrictionEnd":null,"CAU_statusCD":"ALLOW","S_embedAvailableUntilCA":"2099-01-03 00:00:00","S_embedAvailableUntilUSA":"2099-01-03 00:00:00","S_embedAvailableUntilWRLD":"2099-01-03 00:00:00","S_rankDate":"2024-02-09 14:31:15","level1":"General","level2":"Weather","level3":"NA","S_category":"Science","STL_ID":230,"configuration":{"poster":"\/\/d29xw9s9x32j3w.cloudfront.net\/videos\/video_thumb\/XL\/2e1ohruak8z47uim94f62osp0g3zklvc.png","title":"7 Day Weather Forecast for LAS VEGAS, NV for February 09, 2024","mediaid":3384022,"duration":"36.001","adschedule":{"Premium":{"tag":"https:\/\/pubads.g.doubleclick.net\/gampad\/ads?sz=480x270&iu=\/92056281,22960152043\/54098246&impl=s&gdfp_req=1&env=vp&output=vast&unviewed_position_start=1&url=__referrer__&description_url=https%3A%2F%2Fwww.sun-sentinel.com%2F2024%2F02%2F02%2Fthe-calendar-for-february-2024-and-beyond%2F&correlator=1707490105&cust_params=content%3D11314%26embed%3DgbDoqmaV%26placementType%3DPremium%26domain%3Dsun-sentinel.com%26player_width%3D__player-width__%26player_height%3D__player-height__%26rand%3D20%26player_size%3D__player-size__%26play_code%3D__play-code__%26player_status%3D__player-status__%26player_type%3D__player-type__%26version%3D7.30.2%26schain%3Dstnvideo.com%2CSTN_0002637&cmsid=2460952&vid=3384022&ciu_szs=300x60"}},"sources":{"src":"\/\/d29xw9s9x32j3w.cloudfront.net\/videos\/m3u8\/1nnp3q5q07n9o8oqo08r1r63po01s021playlist.m3u8","type":"application\/x-mpegURL"}},"videoConversions":{"M3U8list":"videos\/m3u8\/videos\/m3u8\/1nnp3q5q07n9o8oqo08r1r63po01s021playlist.m3u8"},"IAB_uniqueID":["390"]}],"DEFAULT"],"feed":{"ttl":85500,"refreshTime":"2024-02-09 14:53:25","data":{"MP_ID":null,"MP_listType":"none","PS_adRecovery":"NONE","PS_aiMetaCapture":"0","PS_altAgent":"STNsmartMatch","PS_altPlaylistKey":null,"PS_ampFloat":"disabled","PS_api":"0","PS_catapultX":"0","PS_contentGroup":null,"PS_contentKey":null,"PS_contentType":"smart","PS_customPrebidSelector":[],"PS_delayPlayStart":"disabled","PS_disablePageGesture":"0","PS_dvLogging":false,"PS_endemic":null,"PS_engagementLogging":null,"PS_engagmentLogging":null,"PS_float":"view","PS_floatCloseBehaviour":["continue"],"PS_floatMode":"always","PS_floatOffsetX":0,"PS_floatOffsetY":112,"PS_floatPositionX":"right","PS_floatPositionY":"bottom","PS_floatTriggerScroll":1,"PS_floatWidth":400,"PS_floatWidthLandscape":null,"PS_frameBreak":0,"PS_fullscreenFallback":"none","PS_headerBidding":["spotx"],"PS_headerBiddingProvider":null,"PS_headerBiddingRatio":null,"PS_headerBiddingSources":null,"PS_hiddenBehaviour":"pause","PS_inhibitFloatOnClose":"NO","PS_initialQuality":"LOW","PS_lambdaTest":"0","PS_logAssertiveYield":"0","PS_maxContentAge":"1 MONTH","PS_maxHiddenVideoPlays":"0","PS_maxVideoLength":null,"PS_miniFloatControlsLocation":"top","PS_miniFloatOffsetX":"0","PS_miniFloatOffsetY":"0","PS_miniTheme":"black","PS_mutationObs":"enabled","PS_muteIcon":1,"PS_openvv":"disabled","PS_optimera":"disabled","PS_optionalLogEvents":null,"PS_parser":"watson","PS_playbackMode":"playOnView","PS_playButtonIcon":"stnLogo","PS_playlistBackFill":"KEYWORD","PS_playlistContentKey":null,"PS_playlistEndpoint":"ENABLED","PS_playlistEndpointURL":"","PS_playlistMode":"list","PS_preventImaRefreshOfGpt":"0","PS_pubUrlBehaviour":"disableFloat","PS_pubUrlOverrides":"0","PS_randomizePlaylistStart":"0","PS_rankingTimeframe":48,"PS_resonate":1,"PS_secondaryFloatBehaviour":"none","PS_secureIframe":"0","PS_selfServeContentKey":"0","PS_selfServeKey":"0","PS_selfServeSettingsKey":"0","PS_skin":"standard","PS_skinSize":265,"PS_smartContentAdjustments":"ENTITIES","PS_smartContentAdjustmentsAmt":0.3,"PS_smartPlaylistContent":"USEPLAYLIST","PS_smartPlaylistOrder":"RANK","PS_smartRelevancyAdjustmentAmt":10,"PS_smartWhereClause":"TX_ENT","PS_socialSharing":"disabled","PS_sort":1,"PS_stnBranding":"disabled","PS_stripQueryString":1,"PS_theme":"standard","PS_titleBar":"onHover","PS_titleText":"Top Videos","PS_ui":"newUI","PS_useCustomPrebid":"disabled","PS_useSafeAreaInsets":false,"PS_visibleToPlayAmount":0.1,"PS_wrapper":"disabled","PS_wrapperBanner":null,"PS_wrapperCSS":"","PS_wrapperText":"","LR_placementType":"Premium","LR_vastOverrideTag":"https:\/\/pubads.g.doubleclick.net\/gampad\/ads?sz=480x270&iu=\/92056281,22960152043\/54098246&impl=s&gdfp_req=1&env=vp&output=vast&unviewed_position_start=1&url=__referrer__&description_url=__descriptionUrl__&correlator=__timestamp__&cust_params=","LR_altAdTag":"https:\/\/pubads.g.doubleclick.net\/gampad\/ads?sz=480x270&iu=\/92056281,22960152043\/54791126&impl=s&gdfp_req=1&env=vp&output=vast&unviewed_position_start=1&url=[referrer_url]&description_url=[description_url]&correlator=[timestamp]","C_ID":4641,"psSettings":true,"ES_GROUP_ID":31938,"ESG_key":"gbDoqmaV","ES_ID":49625,"ES_key":"gbDoqmaV","C_accountStageCD":"STN","C_scCodeTypeCD":"UseGroupSetting","DS":"found"},"source":"primary"},"pageMetaData":{"UMS_ID":98794220,"UMS_date":"2024-02-02 18:39:00","UMS_urlHash":"2224352749","UMSE_urlHash":"724edd514db5964916a43fb3c16e4c0e","UMPD_titleHash":null,"UMPD_statusCD":null,"UMS_statusCD":"OK","ES_ID":49625,"recache":0,"c_id":4641,"UMS_taxonomy":["\/art and entertainment\/shows and events","\/news","\/real estate\/buying and selling homes"],"UMS_entities":["12760a93492b05a63616a9bd593ec516","Seminole Hard Rock Hotel & Casino Hollywood","5:30 p.m.","$1,250"],"brandSafe":{"keywchk":["ok"]}}}2em}.full-view>header>*{margin-bottom:1em}.full-view>header>:last-child{margin-bottom:0}@media (min-width:80em){.full-view>header{width:100%}}@media (min-width:65em)and (max-width:79.9375em){.full-view>header{width:100%}}@media (min-width:50em)and (max-width:64.9375em){.full-view>header{width:100%}}@media (min-width:40em)and (max-width:49.9375em){.full-view>header{width:100%}}@media (min-width:20em)and (max-width:39.9375em){.full-view>header{width:100%}}.full-view>header h1{margin-bottom:.4444444444em}.full-view>header .header-title-area h1{width:100%;margin-bottom:.2666666667em;clear:both}.full-view .header-title-area>*{margin-bottom:1em}.full-view .header-title-area>:last-child{margin-bottom:0}@media (min-width:80em){.full-view .header-features{width:calc(75% - 5px);width:calc(75% - .32rem)}}@media (min-width:65em)and (max-width:79.9375em){.full-view .header-features{width:calc(69.23077% - 7px);width:calc(69.23077% - .39rem)}}@media (min-width:50em)and (max-width:64.9375em){.full-view .header-features{width:100%}}@media (min-width:40em)and (max-width:49.9375em){.full-view .header-features{width:100%}}@media (min-width:20em)and (max-width:39.9375em){.full-view .header-features{width:100%}}.full-view .article-sidebar{float:right;position:relative}@media (min-width:80em){.full-view .article-sidebar{width:calc(25% - 15px);width:calc(25% - .94rem)}}@media (min-width:65em)and (max-width:79.9375em){.full-view .article-sidebar{width:calc(30.76923% - 14px);width:calc(30.76923% - .87rem)}}@media (min-width:50em)and (max-width:64.9375em){.full-view .article-sidebar{width:100%}}@media (min-width:40em)and (max-width:49.9375em){.full-view .article-sidebar{width:100%}}@media (min-width:20em)and (max-width:39.9375em){.full-view .article-sidebar{width:100%}}body{background-color:#fbfbfb}.full-view .article-sidebar .dfm-sidebar-most-popular-flex-container,.full-view .article-sidebar .dfm-sidebar-top-flex-container{font:normal 700 1.0625em/1.1176470588 Lato,Helvetica,sans-serif;display:-webkit-box;display:-ms-flexbox;display:flex;letter-spacing:.035em;margin-bottom:1em;padding-bottom:.5em;text-transform:uppercase}.full-view .article-sidebar .dfm-sidebar-most-popular-flex-container a{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start}.newsletter-simple a{font:normal 600 .8125em/1.1538461538 Lato,Helvetica,sans-serif;background-color:var(--primary);border:1px solid var(--primary-dark);border-radius:4px;color:#fff;padding:.8125em 1.0625em;text-shadow:0 0 1px var(--primary-darker);text-transform:uppercase}@media (max-width:64.9375em){.logo.custom-logo a img{-webkit-filter:unset!important;filter:unset!important}}h1.entry-title{display:inline-block}.body-copy a{border-bottom:1px dotted var(--primary);color:var(--primary)}.header-features figcaption{padding:1.0714285714em 0 .7142857143em;position:relative;color:#75726a;border-bottom:3px solid #c8c4c0;margin-bottom:1.0625em;font-size:.8125em;line-height:1.3}.article-header{border-bottom:3px solid rgba(0,0,0,0);display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;float:none;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;margin:2em 0 -2.25em;padding:0;position:relative}.header-title-area{position:relative;z-index:1}.header-title-area>*{margin-bottom:.5em}.header-title-area>:last-child{margin-bottom:0}.header-title-area h1{font-size:1.9375em;line-height:1.1;font-weight:700;letter-spacing:-.03em}@media (min-width:40em){.header-title-area h1{font-size:2rem;line-height:1.15}}@media (min-width:65em){.header-title-area h1{font-size:2.25rem}}.header-title-area h2{font-size:1.4375em;line-height:1.3;font-weight:500;color:#484642;letter-spacing:-.023em}@media (max-width:39.9375em){.header-title-area h2{font:normal 500 1.25em/1.25 Lato,Helvetica,sans-serif;letter-spacing:-.01em}}.headline-area{display:inline-block;margin:0;width:100%}@media (max-width:39.9375em){.headline-area{display:block}}.breadcrumbs{padding-top:1em}.meta{border-bottom:3px solid #c8c4c0;padding-bottom:1em;margin-bottom:1em;float:none;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-align:center;-ms-flex-align:center;align-items:center}@media (max-width:39.9375em){.meta{display:-webkit-box;display:-ms-flexbox;display:flex}}.meta .byline{font-size:.9375em}.meta .byline .author-name{color:var(--primary)}.meta .time{font-size:.8125rem}.meta img{width:56px;height:56px;border-radius:50%;margin-right:10px;-ms-flex-item-align:baseline;align-self:baseline;-o-object-fit:cover;object-fit:cover}.colophon ul{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;margin:0 auto;padding:1.25em .625em;width:100%}.site-footer .footer-menus>.menu-item .expander,.site-footer .menu-item-has-children .expander{position:static;width:50%}.site-footer .footer-menus>.menu-item .expander a,.site-footer .menu-item-has-children .expander a{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;height:100%;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;padding-right:5%}.site-footer .footer-menus>.menu-item .expander a:before,.site-footer .menu-item-has-children .expander a:before{display:none}.site-footer .footer-menus>.menu-item .expander a:after,.site-footer .menu-item-has-children .expander a:after{content:"";border-color:#c8c4c0 rgba(0,0,0,0) rgba(0,0,0,0);border-style:solid;border-width:7px 5px;margin:.3em 0 0 .25em}.header-placeholder{display:none}@media (max-width:64.9375em){.header-placeholder{height:4rem}}@media (min-width:65em){.header-placeholder{height:14rem}}.site-header{background-color:rgba(0,0,0,0)}.hidden-logo{-webkit-box-ordinal-group:3;-ms-flex-order:2;order:2;width:33%;-ms-flex-item-align:center;align-self:center}@media (max-width:49.9375em){.hidden-logo{width:53%}}.logo{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}@media (max-width:64.9375em){.logo{width:100%}}@media (max-width:64.9375em){.logo a{display:grid;place-items:center}}.section-header{font:normal 700 2.5em/.5 Lora,Helvetica,sans-serif;color:var(--primary);text-align:center;white-space:nowrap}@media (max-width:64.9375em){.nav-primary{overflow:visible}}.nav-primary .menu{padding:0}@media (max-width:64.9375em){.nav-primary .menu{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}}.nav-primary .menu>li{margin:0}@media (max-width:64.9375em){.nav-primary .menu>li{border:0}}.nav-primary .menu>li>a{font:normal 600 .9375em/1.7333333333 Lato,Helvetica,sans-serif;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex}@media (max-width:64.9375em){.nav-primary .menu>li>a{padding-left:.625em}}@media (max-width:79.9375em){.nav-primary .menu>li>a{font-size:.9375em}}@media (min-width:65em)and (max-width:79.9375em){.nav-primary .menu>li>a{padding:0 1.28vw}}@media (min-width:80em){.nav-primary .menu>li>a{padding:0 .8823529412em}}.nav-primary .menu>li:last-child>a{border-right:0}@media (min-width:65em)and (max-width:79.9375em){.nav-primary .menu>li:first-child>a{padding-left:.7142857143em}}@media (min-width:80em){.nav-primary .menu>li:first-child>a{padding-left:.5555555556em}}.pushnav li>a{font:normal 600 .9375em/1.0666666667 Lato,Helvetica,sans-serif;background:#fbfbfb}.pushnav .menu-item{height:2.5em;background:#fbfbfb}.pushnav .menu-item>a{height:2.8888888889em}.pushnav .menu-item>ul a{font:normal 600 .9375em/1.0666666667 Lato,Helvetica,sans-serif;margin-left:1rem}.trending-bar{width:100vw}@media (min-width:65em)and (max-width:79.9375em){.trending-bar{width:calc(100vw - 1.25em);left:.625em}}.trending-bar nav{float:none;padding:.5em 0}@media (min-width:65em){.trending-bar ul{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;height:1.125em;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;overflow:hidden}}.trending-bar li{line-height:1.15;padding-right:1.5625em;position:relative}.trending-bar a{color:#484642;font-family:Lato,Helvetica,sans-serif}.trending-bar .trending-bar-wrapper p,.trending-bar a{font-size:.9375em}.trending-bar .trending-bar-wrapper{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;padding:0 .3125em}@media (min-width:80em){.trending-bar .trending-bar-wrapper{max-width:80em}}.trending-bar .trending-bar-wrapper>p{color:var(--primary-dark);display:block;font-size:.875em;padding-right:1.5625em;position:static;text-transform:uppercase;min-width:130px;white-space:nowrap}.newsletter-simple a{display:inline-block}.newsletter-simple .newsletter-item{border-bottom:1px solid #fff;padding-bottom:1em}@media (max-width:64.9375em){.newsletter-simple .newsletter-item{padding:1em 0}}.prompt{font:normal 700 .9375em/1.0666666667 Lora,Helvetica,sans-serif;color:#1f1e1c;margin-bottom:.75rem;position:relative;width:100%}.related li a{border:0;font-weight:600}.search-form.header-search{margin-top:0}.search-form.header-search input[type=text]{border:none;background-color:#fbfbfb;font-size:.9375em;padding:.75em}.sharedaddy{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}@media (max-width:39.9375em){.sharedaddy{float:none;margin-top:.625em}}.sharedaddy ul{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex}.sharedaddy li{margin:0 .3125em 0 0}.sharedaddy li:last-child{margin:0}.article-share{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.full-view .article-share .sd-content>ul li{border-radius:50%;font-size:1.3125em;height:2.0476190476em;width:2.0476190476em}.site-header .article-share .sd-content>ul li{border-radius:50%;font-size:1.1875em;height:2em;width:2em}.full-view .article-share .sd-social-icon .sd-content>ul li,.site-header .article-share .sd-social-icon .sd-content>ul li{border-radius:50%;font-size:1.25em;height:2em;width:2em;background-color:rgba(0,0,0,0);border:1px solid var(--primary-dark);color:var(--primary);display:-webkit-box;display:-ms-flexbox;display:flex;position:static;text-shadow:0 0 1px var(--primary-darker);padding-left:0}.site-header .article-share .sd-social-icon .sd-content>ul li span:before{color:var(--primary)!important;font-size:.9375em}@media (min-width:20em)and (max-width:79.9375em){.site-header .article-share .sd-social-icon .sd-content>ul li a.sd-button{margin-right:0}}.site-header .article-share .sd-social-icon .sd-content>ul li.share-facebook{border-radius:50%;font-size:1.25em;height:2em;width:2em;background-color:rgba(0,0,0,0);border:1px solid var(--primary-dark);color:var(--primary);display:-webkit-box;display:-ms-flexbox;display:flex;position:static;text-shadow:0 0 1px var(--primary-darker);padding-left:0}.site-header .article-share .sd-social-icon .sd-content>ul li.share-facebook span:before{color:var(--primary)!important;font-size:.9375em}.site-header .article-share .sd-social-icon .sd-content>ul li.share-twitter{border-radius:50%;font-size:1.25em;height:2em;width:2em;background-color:rgba(0,0,0,0);border:1px solid var(--primary-dark);color:var(--primary);display:-webkit-box;display:-ms-flexbox;display:flex;position:static;text-shadow:0 0 1px var(--primary-darker);padding-left:0}.site-header .article-share .sd-social-icon .sd-content>ul li.share-twitter span:before{color:var(--primary)!important;font-size:.9375em}.site-header .article-share .sd-social-icon .sd-content>ul li.share-reddit{border-radius:50%;font-size:1.25em;height:2em;width:2em;background-color:rgba(0,0,0,0);border:1px solid var(--primary-dark);color:var(--primary);display:-webkit-box;display:-ms-flexbox;display:flex;position:static;text-shadow:0 0 1px var(--primary-darker);padding-left:0}.site-header .article-share .sd-social-icon .sd-content>ul li.share-reddit span:before{color:var(--primary)!important;font-size:.9375em}.full-view .article-share .sd-social-icon .sd-content>ul li.share-end,.site-header .article-share .sd-social-icon .sd-content>ul li.share-end{display:none}@media (max-width:64.9375em){.full-view .article-share li:last-of-type,.site-header .article-share li:last-of-type{display:block}}.full-view .article-content{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}@media (min-width:80em){.full-view .article-content-wrapper{width:calc(75% - 5px);width:calc(75% - .32rem)}}@media (min-width:65em)and (max-width:79.9375em){.full-view .article-content-wrapper{width:calc(69.23077% - 7px);width:calc(69.23077% - .39rem)}}@media (min-width:50em)and (max-width:64.9375em){.full-view .article-content-wrapper{width:100%}}@media (min-width:40em)and (max-width:49.9375em){.full-view .article-content-wrapper{width:100%}}@media (min-width:20em)and (max-width:39.9375em){.full-view .article-content-wrapper{width:100%}}.full-view .header-features{padding:3em 0 2em;width:100%}@media (min-width:65em){.full-view .article-sidebar{margin-top:3em}}.full-view .article-sidebar .sidebar-content>*{margin-bottom:2.5em}.full-view .article-sidebar .dfm-sidebar-most-popular-flex-container,.full-view .article-sidebar .dfm-sidebar-top-flex-container{counter-reset:section;background-color:rgba(0,0,0,0);color:var(--primary);padding:0;border-bottom:none;display:block}@media (max-width:64.9375em){.full-view .article-sidebar .dfm-sidebar-most-popular-flex-container,.full-view .article-sidebar .dfm-sidebar-top-flex-container{float:left}}@media (min-width:50em)and (min-width:50em)and (max-width:64.9375em){.full-view .article-sidebar .dfm-sidebar-most-popular-flex-container,.full-view .article-sidebar .dfm-sidebar-top-flex-container{width:calc(60% - 8px);width:calc(60% - .5rem)}}.full-view .article-sidebar .dfm-sidebar-most-popular-flex-container ul{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;padding:.625em 0;text-transform:none;font-size:medium}@media (min-width:40em){.full-view .article-sidebar .dfm-sidebar-most-popular-flex-container ul{display:block}}@media (max-width:64.9375em){.full-view .article-sidebar .dfm-sidebar-most-popular-flex-container ul{font:normal 600 .9375em/1.0666666667 Lora,Helvetica,sans-serif;width:100%;letter-spacing:0}}@media (min-width:65em){.full-view .article-sidebar .dfm-sidebar-most-popular-flex-container ul{font:normal 600 1.0625em/1.0588235294 Lora,Helvetica,sans-serif;letter-spacing:-.015em}}.full-view .article-sidebar .dfm-sidebar-most-popular-flex-container li{font-size:medium}.full-view .article-sidebar .dfm-sidebar-most-popular-flex-container li a{counter-increment:section;display:-ms-flexbox;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;padding-top:1em;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;max-width:100%;width:100%;color:#000;border-bottom:none;font-size:medium}.full-view .article-sidebar .dfm-sidebar-most-popular-flex-container li a:before{font:normal 600 1.3125em/1 Lato,Helvetica,sans-serif;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:var(--primary);border-radius:50%;color:#fff;content:counter(section);display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex:0 0 auto;-webkit-box-flex:0;flex:0 0 2rem;font-family:Lora,Helvetica,sans-serif;height:2rem;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;line-height:2rem;margin-right:.625rem;max-width:100%;width:2rem}@media (min-width:50em)and (max-width:64.9375em){.full-view .article-sidebar .dfp-ad{width:calc(40% - 12px);width:calc(40% - .75rem)}}@media (min-width:40em)and (max-width:49.9375em){.full-view .article-sidebar .dfp-ad{width:100%}}@media (min-width:40em)and (max-width:64.9375em){.full-view .article-sidebar .dfp-ad{float:right}}</style>
		<script type="text/javascript">
			!function(a){"use strict";a.loadCSS=function(b,c,d){var g,e=a.document,f=e.createElement("link");if(c)g=c;else{var h=(e.body||e.getElementsByTagName("head")[0]).childNodes;g=h[h.length-1]}var i=e.styleSheets;f.rel="stylesheet",f.href=b,f.media="only x",g.parentNode.insertBefore(f,c?g:g.nextSibling);var j=function(a){for(var b=f.href,c=i.length;c--;)if(i[c].href===b)return a();setTimeout(function(){j(a)})};return f.onloadcssdefined=j,j(function(){f.media=d||"all"}),f},"undefined"!=typeof module&&(module.exports=a.loadCSS)}(this);
			loadCSS('https://www.sun-sentinel.com/wp-content/themes/assets/static/css/measuredvibrant.css?ver=1707424421');
		</script>
	<link rel='dns-prefetch' href='//cmp.osano.com' />
<link rel='dns-prefetch' href='//htlbid.com' />
<link rel='dns-prefetch' href='//cdn.parsely.com' />
<link rel='dns-prefetch' href='//ajax.googleapis.com' />
<link rel='dns-prefetch' href='//t133.sun-sentinel.com' />
<link rel='dns-prefetch' href='//embed.sendtonews.com' />
<link rel='dns-prefetch' href='//stats.wp.com' />
<link rel='dns-prefetch' href='//cdn.jsdelivr.net' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Sun Sentinel &raquo; Feed" href="https://www.sun-sentinel.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sun Sentinel &raquo; Comments Feed" href="https://www.sun-sentinel.com/comments/feed/" />
<meta name='description' content='There was a robust “Heather Moraitis for Broward County School Board Because Experience Matters” website, but there&#039;s a catch: The former Fort Lauderdale city commissioner hasn&#039;t hasn&#039;t filed any paperwork indicating a candidacy and said she hasn&#039;t made a decision on running.' /><!-- WP SEO -->
<script>
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.sun-sentinel.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.4.3"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83e\udef1\ud83c\udffb\u200d\ud83e\udef2\ud83c\udfff","\ud83e\udef1\ud83c\udffb\u200b\ud83e\udef2\ud83c\udfff")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
</script>
<link rel='stylesheet' id='all-css-0' href='https://www.sun-sentinel.com/_static/??-eJyNjEEKgDAMwD7k7ESmeBDfoqVIYatj7fD77upB8BgSAnd2eImRGORYTxYFZSP3Aq3itCUsFEFtN0ZAbRILkfSJpW/Ywa+ZFT6q0PdnS+swLX70IczhAYCTO7E=' type='text/css' media='all' />
<link rel='stylesheet' id='__htl_style-css' href='https://htlbid.com/v3/sun-sentinel.com/htlbid.css?ver=6.4.3' media='' />
<link rel='stylesheet' id='all-css-2' href='https://www.sun-sentinel.com/wp-content/client-mu-plugins/src/Sitemap/includes/style.css?m=1686055652g' type='text/css' media='all' />
<style id='wp-emoji-styles-inline-css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<style id='wp-block-library-inline-css'>
:root{--wp-admin-theme-color:#007cba;--wp-admin-theme-color--rgb:0,124,186;--wp-admin-theme-color-darker-10:#006ba1;--wp-admin-theme-color-darker-10--rgb:0,107,161;--wp-admin-theme-color-darker-20:#005a87;--wp-admin-theme-color-darker-20--rgb:0,90,135;--wp-admin-border-width-focus:2px;--wp-block-synced-color:#7a00df;--wp-block-synced-color--rgb:122,0,223}@media (min-resolution:192dpi){:root{--wp-admin-border-width-focus:1.5px}}.wp-element-button{cursor:pointer}:root{--wp--preset--font-size--normal:16px;--wp--preset--font-size--huge:42px}:root .has-very-light-gray-background-color{background-color:#eee}:root .has-very-dark-gray-background-color{background-color:#313131}:root .has-very-light-gray-color{color:#eee}:root .has-very-dark-gray-color{color:#313131}:root .has-vivid-green-cyan-to-vivid-cyan-blue-gradient-background{background:linear-gradient(135deg,#00d084,#0693e3)}:root .has-purple-crush-gradient-background{background:linear-gradient(135deg,#34e2e4,#4721fb 50%,#ab1dfe)}:root .has-hazy-dawn-gradient-background{background:linear-gradient(135deg,#faaca8,#dad0ec)}:root .has-subdued-olive-gradient-background{background:linear-gradient(135deg,#fafae1,#67a671)}:root .has-atomic-cream-gradient-background{background:linear-gradient(135deg,#fdd79a,#004a59)}:root .has-nightshade-gradient-background{background:linear-gradient(135deg,#330968,#31cdcf)}:root .has-midnight-gradient-background{background:linear-gradient(135deg,#020381,#2874fc)}.has-regular-font-size{font-size:1em}.has-larger-font-size{font-size:2.625em}.has-normal-font-size{font-size:var(--wp--preset--font-size--normal)}.has-huge-font-size{font-size:var(--wp--preset--font-size--huge)}.has-text-align-center{text-align:center}.has-text-align-left{text-align:left}.has-text-align-right{text-align:right}#end-resizable-editor-section{display:none}.aligncenter{clear:both}.items-justified-left{justify-content:flex-start}.items-justified-center{justify-content:center}.items-justified-right{justify-content:flex-end}.items-justified-space-between{justify-content:space-between}.screen-reader-text{clip:rect(1px,1px,1px,1px);word-wrap:normal!important;border:0;-webkit-clip-path:inset(50%);clip-path:inset(50%);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.screen-reader-text:focus{clip:auto!important;background-color:#ddd;-webkit-clip-path:none;clip-path:none;color:#444;display:block;font-size:1em;height:auto;left:5px;line-height:normal;padding:15px 23px 14px;text-decoration:none;top:5px;width:auto;z-index:100000}html :where(.has-border-color){border-style:solid}html :where([style*=border-top-color]){border-top-style:solid}html :where([style*=border-right-color]){border-right-style:solid}html :where([style*=border-bottom-color]){border-bottom-style:solid}html :where([style*=border-left-color]){border-left-style:solid}html :where([style*=border-width]){border-style:solid}html :where([style*=border-top-width]){border-top-style:solid}html :where([style*=border-right-width]){border-right-style:solid}html :where([style*=border-bottom-width]){border-bottom-style:solid}html :where([style*=border-left-width]){border-left-style:solid}html :where(img[class*=wp-image-]){height:auto;max-width:100%}:where(figure){margin:0 0 1em}html :where(.is-position-sticky){--wp-admin--admin-bar--position-offset:var(--wp-admin--admin-bar--height,0px)}@media screen and (max-width:600px){html :where(.is-position-sticky){--wp-admin--admin-bar--position-offset:0px}}
.has-text-align-justify{text-align:justify;}
</style>
<link rel='stylesheet' id='general_css-css' href='https://www.sun-sentinel.com/wp-content/plugins/mng-digisubs/static/mng-digisubs.styles.css?ver=6.4.3' media='all' />
<link rel='stylesheet' id='all-css-8' href='https://www.sun-sentinel.com/wp-content/client-mu-plugins/src/Ads/assets/css/mobile-adhesion-style.css?m=1686055652g' type='text/css' media='all' />
<link rel='stylesheet' id='dfm-twc-bootstrap-icons-css' href='//cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.min.css?ver=5.2.0' media='screen' />
<link rel='stylesheet' id='mason-fonts-css' href='https://fonts.googleapis.com/css?family=Lato%3A400%2C400i%2C700%2C700i%7CLora%3A400%2C400i%2C700%2C700i&#038;ver=6.4.3' media='all' />
<link rel='stylesheet' id='all-css-12' href='https://www.sun-sentinel.com/_static/??-eJyVj90KwjAMhV/ILJs/mzfio4ySxlFtm2JShm/vBgp6p3c5B76PE5wLkGTjbFhinUJW9JcEzkMSr6jmLBCSLifdmXOTQm6WuMEPMlV4w1e24ugG3a5pcVHUyIpz8BObokmBImqr9xH5Z88YMqEKBRchyiT6Ff6atH7yKlbmnE7d0A7b/aE/9k9uoGEY' type='text/css' media='all' />
<script src="https://cmp.osano.com/16A1AnRt2Fn8i1unj/f15ebf08-7008-40fe-9af3-db96dc3e8266/osano.js" id="osano-js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js?ver=3.5.1" id="jquery-js"></script>
<script async src="https://htlbid.com/v3/sun-sentinel.com/htlbid.js?ver=6.4.3" id="__htl_script-js"></script>
<script id="__htl_script-js-after">
	window.htlbid = window.htlbid || {};
	htlbid.cmd = htlbid.cmd || [];
	htlbid.cmd.push(function() {
		htlbid.layout('universal');
		htlbid.setTargeting("is_testing","no");
		htlbid.setTargeting("kv", ["politics","news","anthony-man","broward-county","florida","fort-lauderdale"]);
		htlbid.setTargeting("page", "article");
		htlbid.setTargeting("content", []);
		htlbid.setTargeting("RPN", "28799121113");
		htlbid.setTargeting("rurl", "");
		htlbid.setTargeting("articleid", 10532429);
	});
</script>
<script type="text/javascript" src="https://www.sun-sentinel.com/wp-content/client-mu-plugins/src/SSO/assets/js/sso-tools.min.js?m=1686055652g" ></script><script id="mg2_loader_loader-js-extra">
var MG2 = {"settings":{"environment":"prod","version":"dfm","xCode":"","randomURLChoosing":false,"plugins":[{"name":"FP","required":false,"initOptions":{"version":"dfm","environment":"prod"}},{"name":"DL","required":false,"initOptions":{"version":"dfm","environment":"prod","tagManager":"GTM","containerId":"GTM-NFD2QGD","collectors":["connext"]}},{"name":"NXT","required":false,"initOptions":{"environment":"prod","siteCode":"Tribune","configCode":"400ConfigTrib","clientCode":"dfm","debug":false,"silentmode":false,"attr":"4SunSent","settingsKey":"4SunSent","userAuthenticationTime":365,"authSettings":{"domain":"mng-prod.auth0.com","client_id":"UcJ4eT25OXUuzFDMr2dnzTj6R9bUMd1K","redirect_uri":"https:\/\/www.sun-sentinel.com\/login"}}}],"CONFIG_URL":"https:\/\/loader-config.sun-sentinel.com\/prod\/dfm\/loader-config.json","appInsightsKey":"8241cbc2-50a5-47c4-b91f-462506490fad"}};
</script>
<script src="https://www.sun-sentinel.com/wp-content/plugins/loader-wp/static/loader.min.js?ver=1.6.1" id="mg2_loader_loader-js"></script>
<script id="mg2_loader_loader-js-after">
(function( MG2, MG2Loader ) {
	if ( 'undefined' !== typeof MG2 && 'undefined' !== typeof MG2Loader) {
		MG2Loader.init( MG2.settings );
	}
})( MG2, MG2Loader );
</script>
<script type="text/javascript" src="https://www.sun-sentinel.com/wp-content/plugins/loader-wp/static/engageLibrary.min.js?m=1707424421g" ></script><script src="https://cdn.auth0.com/js/auth0-spa-js/1.13/auth0-spa-js.production.js?ver=6.4.3" id="auth0_sdk-js"></script>
<script src="https://accounts.google.com/gsi/client?ver=6.4.3" id="google_one_tap-js"></script>
<script id="authentication_main-js-extra">
var authentication_config = {"debug":"1","entitlementsEnabled":"1","oneTapEnabled":"1","useTribMainGoogle":"1","gotAGroupEnabled":"","gotAModalPosition":"top-right","gotBGroupEnabled":"","gotBModalPosition":"top-right","gotCGroupEnabled":"","gotCModalPosition":"top-right","gotDGroupEnabled":"","gotDModalPosition":"top-right","gotAGroupDelayEnabled":"","gotAGroupDepth":"0","gotAGroupDelayPosition":"top-right","gotBGroupDelayEnabled":"","gotBGroupDepth":"0","gotBGroupDelayPosition":"top-right","gotCGroupDelayEnabled":"","gotCGroupDepth":"0","gotCGroupDelayPosition":"top-right","gotDGroupDelayEnabled":"","gotDGroupDepth":"0","gotDGroupDelayPosition":"top-right","gotEGroupDelayEnabled":"","gotEGroupDepth":"0","gotEGroupDelayPosition":"top-right","gotAGroupTimeDelayEnabled":"","gotAGroupTime":"","gotBGroupTimeDelayEnabled":"","gotBGroupTime":"","gotCGroupTimeDelayEnabled":"","gotCGroupTime":"","gotDGroupTimeDelayEnabled":"","gotDGroupTime":"","dropdownEnabled":"1","auth0Domain":"mng-prod.auth0.com","auth0ClientId":"UcJ4eT25OXUuzFDMr2dnzTj6R9bUMd1K","auth0RegwallUserEmail":"","sessionManagementEnabled":"1","sessionServer":"https:\/\/session.sun-sentinel.com","newsletterId":"281","newslettersEnabled":"","myAccountLink":"https:\/\/membership.sun-sentinel.com\/","entitlementsEndpoint":"https:\/\/user.mng-digisubs-prod.com\/","entitlementsAPIKey":"DHL8Vs1UNo9u0WO52dVBzSuLi4kw2so25cXK1fy7","linaCheckOnArticles":"1","serverEntitlements":"","bcLowaSegements":"","blueconicEnabled":"1","sophiEndpoint":"","isAdfreeArticle":"","googleClientId":"965743605721-5r8bub4cbes0sjghrumosln7mujohhou.apps.googleusercontent.com"};
</script>
<script type="text/javascript" src="https://www.sun-sentinel.com/_static/??-eJylzMEKgCAQBNAfKrdE6BRd+w0zkQ3dol2pz89O0bVOA8PMg2Or3UriSWCLOSAxJAr1jAE5TwwsVtC9OpUskpoyzdGrhSv4YpQD+VP+MmWMEn0qyX+tjKO9gf2BhtS3XdMZbYxulwu/OHEQ" ></script><script src="https://t133.sun-sentinel.com/script.js" id="t133-js"></script>
<script id="hhsl-check-js-extra">
var DFM_AD_MODS_LEVEL = ["24"];
</script>
<script id="article_sharing-js-extra">
var article_config = {"article_sharing_faq":""};
</script>
<script type="text/javascript" src="https://www.sun-sentinel.com/_static/??/wp-content/plugins/dfm-ad-mods/static/js/hhsl-check.min.js,/wp-content/plugins/mng-digisubs/static/mng-digisubs.articleShare.bundle.js?m=1706748009j" ></script><link rel="https://api.w.org/" href="https://www.sun-sentinel.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.sun-sentinel.com/wp-json/wp/v2/posts/10532429" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.sun-sentinel.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.4.3" />
<link rel='shortlink' href='https://www.sun-sentinel.com/?p=10532429' />
<link rel="alternate" type="application/json+oembed" href="https://www.sun-sentinel.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.sun-sentinel.com%2F2024%2F02%2F02%2Fwebsite-detailed-heather-moraitis-campaign-for-school-board-she-says-she-hasnt-decided-if-shes-running%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://www.sun-sentinel.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.sun-sentinel.com%2F2024%2F02%2F02%2Fwebsite-detailed-heather-moraitis-campaign-for-school-board-she-says-she-hasnt-decided-if-shes-running%2F&#038;format=xml" />
<script id="cnx-init-script">!function(n){if(!window.cnx){window.cnx={},window.cnx.cmd=[];var t=n.createElement('iframe');t.display='none',t.onload=function(){var n=t.contentWindow.document,c=n.createElement('script');c.src='//cd.connatix.com/connatix.player.js',c.setAttribute('async','1'),c.setAttribute('type','text/javascript'),n.body.appendChild(c)},n.head.appendChild(t)}}(document);</script>        <style>
        .getty.aligncenter {
            text-align: center;
        }
        .getty.alignleft {
            float: none;
            margin-right: 0;
        }
        .getty.alignleft > div {
            float: left;
            margin-right: 5px;
        }
        .getty.alignright {
            float: none;
            margin-left: 0;
        }
        .getty.alignright > div {
            float: right;
            margin-left: 5px;
        }
        </style>
        	<style id='htl-mobile-adhesion-override'>
		@media screen and (max-width:1000px) {
			#mobile-adhesion {
				display: block !important;
			}
		}
	</style>	<style>img#wpstats{display:none}</style>
		<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"NewsArticle","headline":"Website detailed Heather Moraitis campaign for School Board. She says she hasn\u2019t decided if she\u2019s running.","url":"http:\/\/www.sun-sentinel.com\/2024\/02\/02\/website-detailed-heather-moraitis-campaign-for-school-board-she-says-she-hasnt-decided-if-shes-running\/","mainEntityOfPage":{"@type":"WebPage","@id":"http:\/\/www.sun-sentinel.com\/2024\/02\/02\/website-detailed-heather-moraitis-campaign-for-school-board-she-says-she-hasnt-decided-if-shes-running\/"},"thumbnailUrl":"https:\/\/www.sun-sentinel.com\/wp-content\/uploads\/2024\/02\/TFL-TFL-L-heather-moraitis-FL0123004255.jpg?w=150","image":{"@type":"ImageObject","url":"https:\/\/www.sun-sentinel.com\/wp-content\/uploads\/2024\/02\/TFL-TFL-L-heather-moraitis-FL0123004255.jpg?w=1024"},"articleSection":"Politics","author":[{"@type":"Person","name":"Anthony Man"}],"creator":["Anthony Man"],"publisher":{"@type":"Organization","name":"Sun Sentinel","logo":"https:\/\/www.sun-sentinel.com\/wp-content\/uploads\/2023\/03\/SS-WordPress-Fallback-Image.png?w=600"},"keywords":[],"dateCreated":"2024-02-02T12:00:53Z","datePublished":"2024-02-02T12:00:53Z","dateModified":"2024-02-02T17:44:01Z","isBasedOn":"https:\/\/www.sun-sentinel.com\/2024\/02\/02\/website-detailed-heather-moraitis-campaign-for-school-board-she-says-she-hasnt-decided-if-shes-running\/"}</script><link rel="canonical" href="https://www.sun-sentinel.com/2024/02/02/website-detailed-heather-moraitis-campaign-for-school-board-she-says-she-hasnt-decided-if-shes-running/" />
		<script>
		( function (document, window) {

			let isDataSet = false;

			let jsTimer = null;

			//this can be adjusted.
			const timerLength = 400;

			const tbHelper = {

				initialize: () => {
					tbHelper.engage();
				},
				engage: () => {

					//register Engage event listeners.
					document.addEventListener('onFinish', function (event) {
					tbHelper.handleOnFinishEvent(event.detail.MeterLevel);

					});

					document.addEventListener('onPaywallShown', function (event) {
						tbHelper.handlePaywallShown();
					});

				},
				handleOnFinishEvent: (meterLevel) => {
					//takes passed in meterlevel from onFinish event and determines if we should even check on paywall.

					if (meterLevel === 'Free') {
						//if content is free no need to check timer or if paywall will be shown.
						tbHelper.setData(false);
					} else {
						jsTimer = setTimeout(() => {
							tbHelper.handleOnFinishTimeout();
						}, timerLength);
					}
				},
				handlePaywallShown: () => {

					//clear timeout
					clearTimeout(jsTimer);
					tbHelper.setData(true);
				},
				handleOnFinishTimeout: () => {
					//this is fired when the handleOnFinishTimeout has finished. if this is fired then no paywall was shown (since onPaywallShown will cancel timer and fire handlePaywallShown method)

					tbHelper.setData(false);

				},
				setData: (isPaywallShown) => {
					//this is what sets the window object as well as fire the event.
					if (isDataSet) {
						//if we already fired then just return
						return;
					}
					isDataSet = true;

					const res = { isPaywallShown: isPaywallShown };
					//set data object.
					window.mngIsPaywallShown = isPaywallShown;
					const setDataEvent = new CustomEvent('mngPaywallShown', { detail: res });
					document.dispatchEvent(setDataEvent);

				}

			};

			tbHelper.initialize();

		})(document, window);

		</script>

		<script type="text/javascript">document.addEventListener('mngPaywallShown', function(event) {
					if ( ! event.detail.isPaywallShown ) { window._taboola = window._taboola || [];
			      _taboola.push({article:'auto'});
			  !function (e, f, u, i) {
				if (!document.getElementById(i)){
				  e.async = 1;
				  e.src = u;
				  e.id = i;
				  f.parentNode.insertBefore(e, f);
				}
			  }(document.createElement('script'),
			  document.getElementsByTagName('script')[0],
			  '//cdn.taboola.com/libtrc/tribunedigital-network/loader.js',
			  'tb_loader_script');
			  if(window.performance && typeof window.performance.mark == 'function')
				{window.performance.mark('tbl_ic');} } });</script><script>
    var PushlySDK = window.PushlySDK || [];
    function pushly() { PushlySDK.push(arguments) }
    pushly('load', {
        domainKey: decodeURIComponent("nZFVv1X9GYFO7N0hAvXMB7QXuFQP9RXSifvL"),
        sw: "/wp-content/plugins/pushly/assets/js/pushly-sdk-worker.js.php",
        swScope: "/wp-content/plugins/pushly/"    });
</script>
<style id="customizer-styles">			div#page {
			--primary: #136383;
			}
						div#page {
			--primary-light: #2a728f;
			}
						div#page {
			--primary-dark: #115975;
			}
						div#page {
			--primary-darker: #0f4f68;
			}
						div#page {
			--subsite-custom: #000000;
			}
			</style><script>window.addEventListener('message',
		function s2nEventCallback(a){if('s2nEvent'===a.data.type)
			{let t={event:'SendToNews load',sendtonews_player_key:
				a.data.playerKey};window.dataLayer.push(t),
				window.removeEventListener('message',s2nEventCallback)}});</script><!-- Google Tag Manager Data Layer -->
<script type='text/javascript'>
   analyticsEvent    = function() {};
   analyticsSocial   = function() {};
   analyticsVPV      = function() {};
   analyticsClearVPV = function() {};
   analyticsForm     = function() {};
   window.dataLayer  = window.dataLayer || [];
   dataLayer.push({
      'ga_ua' : 'UA-40841508-28',
      'quantcast' : '',
      'quantcast label' : '',
      'comscore' : '',
      'Publisher Domain' : 'sun-sentinel.com',
      'Publisher Product' : 'sun-sentinel.com',
      'kv' : 'Politics',
      'Platform' : 'WP',
      'Release Version' : '6.4.3',
      'Digital Publisher' : '',
      'Section' : 'Politics',
      'Taxonomy1' : 'Politics',
      'Taxonomy2' : 'News',
      'Taxonomy3' : '',
      'Taxonomy4' : '',
      'Taxonomy5' : '',
      'Publisher State' : '',
      'Page Type' : 'article',
      'User ID' : '',
      'Behind Paywall' : '',
      'SiteName' : 'Sun Sentinel',
      'Mobile Presentation' : 'no',
      'Content ID' : '10532429',
      'Publish Hour of Day' : '2024-02-02T07:00:53-05:00',
      'Create Hour of Day' : '2024-02-02T07:00:53-05:00',
      'Update Hour of Day' : '2024-02-02T17:44:01-05:00',
      'Content Source' : '',
      'Canonical URL' : 'https://www.sun-sentinel.com/2024/02/02/website-detailed-heather-moraitis-campaign-for-school-board-she-says-she-hasnt-decided-if-shes-running/',
      'Slug' : 'website-detailed-heather-moraitis-campaign-for-school-board-she-says-she-hasnt-decided-if-shes-running',
      'Byline' : 'Anthony Man',
      'Byline_Email' : 'aman@sunsentinel.com',
      'Affiliation' : 'South Florida Sun Sentinel',
      'Content Title' : 'Website detailed Heather Moraitis campaign for School Board. She says she hasn’t decided if she’s running.',
      'URL' : 'https://www.sun-sentinel.com/2024/02/02/website-detailed-heather-moraitis-campaign-for-school-board-she-says-she-hasnt-decided-if-shes-running/',
      'Page Title' : 'Website detailed Heather Moraitis campaign for School Board. She says she hasn’t decided if she’s running.',
      'Article Characters' : '5591',
      'Article Words' : '879',
      'Print Export' : 'true',
      'Paywall_Level' : 'premium',
      'Dateline' : '',
      'Paragraph Count' : '27',
      'Hierarchy' : 'Politics,News'
   });
</script>
<!-- End Google Tag Manager Data Layer -->
<!-- Google Tag Manager -->
<script>
(function(w,d,s,l,i) {
   w[l]=w[l]||[];
   w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});
   var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';
   j.async=true;
   j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})
(window,document,'script','dataLayer','GTM-TLFP4R');
</script><!-- End Google Tag Manager -->

<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Website detailed Heather Moraitis campaign for School Board. She says she hasn’t decided if she’s running." />
<meta property="og:url" content="https://www.sun-sentinel.com/2024/02/02/website-detailed-heather-moraitis-campaign-for-school-board-she-says-she-hasnt-decided-if-shes-running/" />
<meta property="og:description" content="There was a robust “Heather Moraitis for Broward County School Board Because Experience Matters” website, but there&#8217;s a catch: The former Fort Lauderdale city commissioner hasn&#8217;t hasn&amp;#…" />
<meta property="article:published_time" content="2024-02-02T12:00:53+00:00" />
<meta property="article:modified_time" content="2024-02-02T22:44:01+00:00" />
<meta property="og:site_name" content="Sun Sentinel" />
<meta property="og:image" content="https://www.sun-sentinel.com/wp-content/uploads/2024/02/TFL-TFL-L-heather-moraitis-FL0123004255.jpg?w=640&#038;h=800" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="800" />
<meta property="og:image:alt" content="Heather Moraitis, a former Fort Lauderdale city commissioner, said she hasn&#039;t made a decision about a 2024 candidacy for Broward School Board. A website touting her candidacy was online." />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="Website detailed Heather Moraitis campaign for School Board. She says she hasn’t decided if she’s running." />
<meta name="twitter:image" content="https://www.sun-sentinel.com/wp-content/uploads/2024/02/TFL-TFL-L-heather-moraitis-FL0123004255.jpg?w=640" />
<meta name="twitter:image:alt" content="Heather Moraitis, a former Fort Lauderdale city commissioner, said she hasn&#039;t made a decision about a 2024 candidacy for Broward School Board. A website touting her candidacy was online." />
<meta name="twitter:card" content="summary_large_image" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://www.sun-sentinel.com/wp-content/uploads/2023/03/Sfav.jpg?w=32" sizes="32x32" />
<link rel="icon" href="https://www.sun-sentinel.com/wp-content/uploads/2023/03/Sfav.jpg?w=48" sizes="192x192" />
<link rel="apple-touch-icon" href="https://www.sun-sentinel.com/wp-content/uploads/2023/03/Sfav.jpg?w=48" />
<meta name="msapplication-TileImage" content="https://www.sun-sentinel.com/wp-content/uploads/2023/03/Sfav.jpg?w=48" />
			</head>

			<body class="post-template-default single single-post postid-10532429 single-format-standard wp-custom-logo">

			<!-- Google Tag Manager (noscript) -->
<noscript><iframe src='https://www.googletagmanager.com/ns.html?id=GTM-TLFP4R' height='0' width='0' style='display:none;visibility:hidden'></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
			<a href="#content" class="sr-only">Skip to content</a>
			
			<div id="page" class="hfeed site">

			<div class="header-placeholder"></div><header class="site-header default headroom--top">
			<div class="nav-wrapper-primary">

				<div class="nav-wrapper-secondary">

					<div class="screen-wrapper">

						<div class="nav-primary-top">

										<div class="pushnav-flex-wrapper">
				<nav class="pushnav" role="navigation" aria-label="Main Menu" id="pushnav-container"><div id="menu-toggle" class="menu-toggle" role="button" aria-expanded="false" tabindex="0" aria-label="Open menu of all sections"><span class="icon-hamburger"></span><span class="menu-label">All Sections</span></div>
					<div class="wrapper-nav pushnav">
						<div class="border-container">
							<div class="top-pushnav-container">
															<a href="https://mktops.sun-sentinel.com/subscriptions/land-flash-sale-lightning-bolt-23/indexD.html?market=ss&#038;source=index&#038;g2i_source=SB&#038;g2i_medium=sub-nav&#038;g2i_campaign=FD22" id="mega-subscribe-button" class="subscribe-button" type="subscribe">
									<span>Subscribe Now</span>								</a>
												<div class="accuweather-wrap">
					<div class="weather-date">
					
	<div class='dfm_accuweather_current_conditions'>
		<a target="_blank" href="/weather" title="Current Weather Conditions" aria-label="Current temperature is 73&deg;F, view full weather conditions in a new window">
			<span>73&deg;F</span>
			<i class="bi-cloud-sun" role="img" aria-label="weather icon cloud-sun"></i>
		</a>
	</div>						<div class="date">
							Friday, February 9th 2024									<a class="tribune-e-edition" title="Link to first E-Edition opens in a new window" target="_blank" href="https://enewspaper.sun-sentinel.com">
									<p class="e-edition">Daily e-Edition</p>									</a>
									<a class="tribune-e-edition" title="Link to second E-Edition opens in a new window" target="_blank" href="https://enewspaper.sun-sentinel.com/eveningedition">
									<p class="e-edition">Evening e-Edition</p>									</a>
														</div>
					</div>
				</div>
											<a href="https://www.sun-sentinel.com" class="home-link icon-home3" title="Link to Home Page">
									<span>Home Page</span>
								</a>
							</div>
							<button class="sr-only pushnav-close">Close Menu</button><ul id="pushnav" class="menu"><li id="menu-item-330" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-330 menu-large"><a href="https://enewspaper.sun-sentinel.com/">Daily e-Edition</a></li>
<li id="menu-item-331" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-331 menu-large"><a href="https://enewspaper.sun-sentinel.com/eveningedition/">Evening e-Edition</a></li>
<li id="menu-item-6346910" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6346910 menu-large"><a href="https://membership.sun-sentinel.com/newsletters#nt=primarynavbar">Sign Up for Newsletters</a></li>
<li id="menu-item-334" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-334 menu-large"><a href="https://www.sun-sentinel.com/local-news/" aria-expanded="false" aria-haspopup="true">Local News</a>
<ul class="sub-menu">
	<li id="menu-item-387" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-387 menu-large"><a href="https://www.sun-sentinel.com/local-news/">Local News</a></li>
	<li id="menu-item-388" class="menu-item menu-item-type-taxonomy menu-item-object-location menu-item-388 menu-large"><a href="https://www.sun-sentinel.com/location/florida/broward-county/">Broward County</a></li>
	<li id="menu-item-390" class="menu-item menu-item-type-taxonomy menu-item-object-location menu-item-390 menu-large"><a href="https://www.sun-sentinel.com/location/florida/palm-beach-county/">Palm Beach County</a></li>
	<li id="menu-item-389" class="menu-item menu-item-type-taxonomy menu-item-object-location menu-item-389 menu-large"><a href="https://www.sun-sentinel.com/location/florida/miami-dade-county/">Miami-Dade County</a></li>
	<li id="menu-item-9756112" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-9756112 menu-large"><a href="https://www.sun-sentinel.com/tag/delray-sun/">Delray Sun</a></li>
	<li id="menu-item-9756113" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-9756113 menu-large"><a href="https://www.sun-sentinel.com/tag/boca-times/">Boca Times</a></li>
	<li id="menu-item-9756116" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-9756116 menu-large"><a href="https://www.sun-sentinel.com/tag/west-boca-times/">West Boca Times</a></li>
	<li id="menu-item-9756121" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-9756121 menu-large"><a href="https://www.sun-sentinel.com/tag/gateway-gazette/">Gateway Gazette</a></li>
	<li id="menu-item-9860710" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-9860710 menu-large"><a href="https://enewspaper.sun-sentinel.com/html5/desktop/production/default.aspx?edid=00b9da6d-54da-4ed8-b65b-8f966791a040">Palm Beach County community e-editions</a></li>
</ul>
</li>
<li id="menu-item-382" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-382 menu-large"><a href="https://www.sun-sentinel.com/news/weather/" aria-expanded="false" aria-haspopup="true">Weather News</a>
<ul class="sub-menu">
	<li id="menu-item-9733549" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9733549 menu-large"><a href="https://www.sun-sentinel.com/news/weather/">Weather News</a></li>
	<li id="menu-item-9733547" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-9733547 menu-large"><a href="https://www.sun-sentinel.com/weather/">Forecasts and Conditions</a></li>
	<li id="menu-item-9738273" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-9738273 menu-large"><a href="https://www.sun-sentinel.com/tag/hurricane-tracks/">Hurricane Tracks</a></li>
	<li id="menu-item-383" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-383 menu-large"><a href="https://www.sun-sentinel.com/news/weather/hurricanes/">Storms &amp; Hurricanes</a></li>
</ul>
</li>
<li id="menu-item-10558080" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-10558080 menu-large"><a href="https://www.sun-sentinel.com/news/politics/" aria-expanded="false" aria-haspopup="true">Politics</a>
<ul class="sub-menu">
	<li id="menu-item-10558084" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-10558084 menu-large"><a href="https://www.sun-sentinel.com/news/politics/">Politics</a></li>
	<li id="menu-item-10558083" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-10558083 menu-large"><a href="https://www.sun-sentinel.com/news/politics/election/">Election</a></li>
</ul>
</li>
<li id="menu-item-9964736" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-9964736 menu-large"><a href="https://www.sun-sentinel.com/news/health/" aria-expanded="false" aria-haspopup="true">Health</a>
<ul class="sub-menu">
	<li id="menu-item-9964738" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-9964738 menu-large"><a href="https://www.sun-sentinel.com/tag/medicare/">Medicare</a></li>
</ul>
</li>
<li id="menu-item-6346912" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-6346912 menu-large"><a href="https://www.sun-sentinel.com/things-to-do/" aria-expanded="false" aria-haspopup="true">Things To Do</a>
<ul class="sub-menu">
	<li id="menu-item-9733544" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9733544 menu-large"><a href="https://www.sun-sentinel.com/things-to-do/">Things To Do</a></li>
	<li id="menu-item-6346915" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6346915 menu-large"><a href="https://www.sun-sentinel.com/things-to-do/restaurants-food-and-drink/">Restaurants</a></li>
	<li id="menu-item-405" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-405 menu-large"><a href="https://www.sun-sentinel.com/things-to-do/horoscopes/">Horoscopes</a></li>
	<li id="menu-item-9733541" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-9733541 menu-large"><a href="https://www.sun-sentinel.com/events/">Events</a></li>
	<li id="menu-item-9756127" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9756127 menu-large"><a href="https://www.sun-sentinel.com/things-to-do/arts/">Arts</a></li>
	<li id="menu-item-9756128" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9756128 menu-large"><a href="https://www.sun-sentinel.com/things-to-do/theater/">Theater</a></li>
</ul>
</li>
<li id="menu-item-335" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-335 menu-large"><a href="https://www.sun-sentinel.com/sports/" aria-expanded="false" aria-haspopup="true">Sports</a>
<ul class="sub-menu">
	<li id="menu-item-336" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-336 menu-large"><a href="https://www.sun-sentinel.com/sports/">Sports</a></li>
	<li id="menu-item-392" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-392 menu-large"><a href="https://www.sun-sentinel.com/sports/nfl/miami-dolphins/">Miami Dolphins</a></li>
	<li id="menu-item-393" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-393 menu-large"><a href="https://www.sun-sentinel.com/sports/nba/miami-heat/">Miami Heat</a></li>
	<li id="menu-item-395" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-395 menu-large"><a href="https://www.sun-sentinel.com/sports/nhl/florida-panthers/">Florida Panthers</a></li>
	<li id="menu-item-394" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-394 menu-large"><a href="https://www.sun-sentinel.com/sports/mlb/miami-marlins/">Miami Marlins</a></li>
	<li id="menu-item-9852512" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9852512 menu-large"><a href="https://www.sun-sentinel.com/sports/soccer/inter-miami/">Inter Miami</a></li>
	<li id="menu-item-6346913" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6346913 menu-large"><a href="https://www.sun-sentinel.com/tag/miami-hurricanes/">UM Hurricanes</a></li>
	<li id="menu-item-6346914" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6346914 menu-large"><a href="https://www.sun-sentinel.com/tag/fau-owls/">FAU Owls</a></li>
	<li id="menu-item-391" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-391 menu-large"><a href="https://www.sun-sentinel.com/sports/high-school-sports/">High School Sports</a></li>
</ul>
</li>
<li id="menu-item-337" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-337 menu-large"><a href="https://www.sun-sentinel.com/business/" aria-expanded="false" aria-haspopup="true">Business</a>
<ul class="sub-menu">
	<li id="menu-item-9943366" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9943366 menu-large"><a href="https://www.sun-sentinel.com/business/">Business</a></li>
	<li id="menu-item-9802325" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-9802325 menu-large"><a href="https://www.sun-sentinel.com/best-reviews/">Consumer Reviews</a></li>
	<li id="menu-item-9943365" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-9943365 menu-large"><a href="https://www.sun-sentinel.com/business/retail/">Retail</a></li>
</ul>
</li>
<li id="menu-item-398" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-398 menu-large"><a href="https://www.sun-sentinel.com/business/real-estate/" aria-expanded="false" aria-haspopup="true">Real Estate</a>
<ul class="sub-menu">
	<li id="menu-item-10049824" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-10049824 menu-large"><a href="https://www.sun-sentinel.com/business/real-estate/">Real Estate</a></li>
	<li id="menu-item-10049749" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-10049749 menu-large"><a href="https://homes.sun-sentinel.com/">Featured Homes</a></li>
	<li id="menu-item-10049751" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-10049751 menu-large"><a href="https://homes.sun-sentinel.com/agents">Agents</a></li>
	<li id="menu-item-10049752" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-10049752 menu-large"><a href="https://homes.sun-sentinel.com/brokers">Brokers</a></li>
	<li id="menu-item-10049753" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-10049753 menu-large"><a href="https://homes.sun-sentinel.com/openhouses">Open Houses</a></li>
</ul>
</li>
<li id="menu-item-339" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-339 menu-large"><a href="https://www.sun-sentinel.com/opinion/" aria-expanded="false" aria-haspopup="true">Opinion</a>
<ul class="sub-menu">
	<li id="menu-item-340" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-340 menu-large"><a href="https://www.sun-sentinel.com/opinion/">Opinion</a></li>
	<li id="menu-item-400" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-400 menu-large"><a href="https://www.sun-sentinel.com/opinion/editorials/">Editorials</a></li>
	<li id="menu-item-6346918" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6346918 menu-large"><a href="https://www.sun-sentinel.com/opinion/letters-to-the-editor/">Letters to the Editor</a></li>
	<li id="menu-item-401" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-401 menu-large"><a href="https://www.sun-sentinel.com/opinion/commentary/">Commentary</a></li>
</ul>
</li>
<li id="menu-item-6346919" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6346919 menu-large"><a href="https://www.sun-sentinel.com/news/education/">Education</a></li>
<li id="menu-item-6346920" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-6346920 menu-large"><a href="https://www.sun-sentinel.com/things-to-do/travel/" aria-expanded="false" aria-haspopup="true">Travel</a>
<ul class="sub-menu">
	<li id="menu-item-8851717" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-8851717 menu-large"><a href="https://www.sun-sentinel.com/things-to-do/travel/">Travel</a></li>
	<li id="menu-item-6724273" class="menu-item menu-item-type-taxonomy menu-item-object-post_tag menu-item-6724273 menu-large"><a href="https://www.sun-sentinel.com/tag/florida-cruise-guide/">Florida Cruise Guide</a></li>
	<li id="menu-item-9756126" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-9756126 menu-large"><a href="https://www.sun-sentinel.com/tag/explore-florida/">Explore Florida</a></li>
</ul>
</li>
<li id="menu-item-9732950" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-9732950 menu-large"><a href="https://www.sun-sentinel.com/florida-jewish-journal/" aria-expanded="false" aria-haspopup="true">Florida Jewish Journal</a>
<ul class="sub-menu">
	<li id="menu-item-9732952" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9732952 menu-large"><a href="https://www.sun-sentinel.com/florida-jewish-journal/">Florida Jewish Journal</a></li>
	<li id="menu-item-9732953" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9732953 menu-large"><a href="https://www.sun-sentinel.com/florida-jewish-journal/jewish-journal-opinion/">Jewish Journal Opinion</a></li>
	<li id="menu-item-9732951" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9732951 menu-large"><a href="https://www.sun-sentinel.com/florida-jewish-journal/broward-jewish-news/">Broward Jewish News</a></li>
	<li id="menu-item-9732954" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9732954 menu-large"><a href="https://www.sun-sentinel.com/florida-jewish-journal/miami-dade-jewish-news/">Miami-Dade Jewish News</a></li>
	<li id="menu-item-9732955" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9732955 menu-large"><a href="https://www.sun-sentinel.com/florida-jewish-journal/palm-beach-jewish-news/">Palm Beach Jewish News</a></li>
	<li id="menu-item-9756125" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-9756125 menu-large"><a href="https://enewspaper.sun-sentinel.com/html5/desktop/production/default.aspx?pubid=5f636c60-aa3f-4d21-b671-3b2baea058ea">E-Newspaper</a></li>
</ul>
</li>
<li id="menu-item-9734293" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9734293 menu-large"><a href="https://www.sun-sentinel.com/city-and-shore/">City &amp; Shore Magazine</a></li>
<li id="menu-item-10530279" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-10530279 menu-large"><a href="https://www.sun-sentinel.com/obituaries/" aria-expanded="false" aria-haspopup="true">Obituaries</a>
<ul class="sub-menu">
	<li id="menu-item-10530280" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-10530280 menu-large"><a href="https://www.sun-sentinel.com/obituaries/">Obituaries</a></li>
	<li id="menu-item-10530320" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-10530320 menu-large"><a href="https://www.sun-sentinel.com/news/news-obituaries/">News Obituaries</a></li>
	<li id="menu-item-10530283" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-10530283 menu-large"><a href="https://placeanad.sun-sentinel.com/ad-options/?cat=obituary-in-memoriam">Place an Obituary</a></li>
</ul>
</li>
<li id="menu-item-8866473" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-8866473 menu-large"><a href="https://www.sun-sentinel.com/sponsored-content/" aria-expanded="false" aria-haspopup="true">Branded Content</a>
<ul class="sub-menu">
	<li id="menu-item-8866474" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-8866474 menu-large"><a href="https://www.sun-sentinel.com/sponsor-content-hub/?ntv_adpz=1633">Paid Partner Content</a></li>
	<li id="menu-item-8866479" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-8866479 menu-large"><a href="https://www.sun-sentinel.com/sponsor-content-hub-idx/?ntv_adpz=3663">Advertising by Ascend</a></li>
	<li id="menu-item-8866478" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-8866478 menu-large"><a href="https://www.sun-sentinel.com/sponsor-content-hub/?ntv_adpz=3232">Paid Content by Brandpoint</a></li>
</ul>
</li>
<li id="menu-item-6346917" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6346917 menu-large"><a href="https://classifieds.sunsentinel.com/#nt=secondarynavbar">Classified</a></li>
<li id="menu-item-6346909" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6346909 menu-large"><a href="http://placeanad.sun-sentinel.com/" aria-expanded="false" aria-haspopup="true">Advertise</a>
<ul class="sub-menu">
	<li id="menu-item-9733545" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-9733545 menu-large"><a href="http://placeanad.sun-sentinel.com/">Advertise</a></li>
	<li id="menu-item-6346916" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6346916 menu-large"><a href="https://www.sun-sentinel.com/about-our-ads/">About our Ads</a></li>
</ul>
</li>
</ul><button class="sr-only pushnav-close">Close Menu</button>						</div>
						<div class="newsletter-nav">
								<div class="newsletter-simple">
		<div class="newsletter-item">
			<p class="prompt">Sign up for email newsletters</p>
			<a class="sign-up-button" href="https://membership.sun-sentinel.com/newsletters#nt=primarynavbar"
			   aria-label="Click here to go to the newsletter sign up page">
				Sign Up</a>
		</div>
	</div>
						</div>
					</div>
				</nav>
			</div>
							<div class="hidden-logo">
					<div class="custom-logo logo"><a href="https://www.sun-sentinel.com" aria-label="Sun Sentinel"><img src="https://www.sun-sentinel.com/wp-content/uploads/2023/03/sunsent-removebg-preview.png" alt="Sun Sentinel"></a></div>				</div>
				
	<h2 class="entry-title">

<div class="entry-section"><a href="https://www.sun-sentinel.com/news/politics/">Politics | </a></div>			<a class="article-title" href="https://www.sun-sentinel.com/2024/02/02/website-detailed-heather-moraitis-campaign-for-school-board-she-says-she-hasnt-decided-if-shes-running/" title="Website detailed Heather Moraitis campaign for School Board. She says she hasn’t decided if she’s running.">
	
				<span class="dfm-title premium">
			Website detailed Heather Moraitis campaign for&#8230;		</span>

			</a>
	
	</h2>

				<div class="article-share">
					<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-10532429" class="share-facebook sd-button share-icon no-text" href="https://www.sun-sentinel.com/2024/02/02/website-detailed-heather-moraitis-campaign-for-school-board-she-says-she-hasnt-decided-if-shes-running/?share=facebook" target="_blank" title="Click to share on Facebook" ><span></span><span class="sharing-screen-reader-text">Click to share on Facebook (Opens in new window)</span></a></li><li class="share-x"><a rel="nofollow noopener noreferrer" data-shared="sharing-x-10532429" class="share-x sd-button share-icon no-text" href="https://www.sun-sentinel.com/2024/02/02/website-detailed-heather-moraitis-campaign-for-school-board-she-says-she-hasnt-decided-if-shes-running/?share=x" target="_blank" title="Click to share on X" ><span></span><span class="sharing-screen-reader-text">Click to share on X (Opens in new window)</span></a></li><li class="share-end"></li></ul></div></div></div>					<span class="share-alt">
					<a href="#" class="icon-share-alt">
						<span></span>
					</a>
				</span>
				</div>
								<div class="digisubs-wrapper">
									<nav class="digisubs-pushmenu" role="navigation" aria-label="Account Menu" id="digisubs-push-container">
						<div id="digisubs-toggle" class="digisubs-toggle pushnav" role="button" aria-expanded="false" tabindex="0" aria-label="Open menu">
							<div id="mng-icon-image">
								<img id="pushnav-icon">
								<div id="blank-icon-user">
									<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="20" height="20" viewBox="0 0 32 32">
										<path fill="#000000" d="M18 22.082v-1.649c2.203-1.241 4-4.337 4-7.432 0-4.971 0-9-6-9s-6 4.029-6 9c0 3.096 1.797 6.191 4 7.432v1.649c-6.784 0.555-12 3.888-12 7.918h28c0-4.030-5.216-7.364-12-7.918z"></path>
									</svg>
								</div>
								<span class="icon-arrow-down"></span>
							</div>
						</div>
						<div class="wrapper-nav-subs pushnav">
							<div class="border-container">
								<ul id="dfm-digisubs-push-menu" class="menu"><li id="menu-item-9916433" class="subscribe-visibility subscribe-special custom-button menu-item menu-item-type-custom menu-item-object-custom menu-item-9916433"><a href="https://mktops.sun-sentinel.com/subscriptions/land-flash-sale-lightning-bolt-23/indexD.html?market=ss&#038;source=index&#038;g2i_source=SB&#038;g2i_medium=nav2&#038;g2i_campaign=FD22">Subscribe</a></li>
<li id="menu-item-9916444" class="log-in-button subscribe-special custom-button menu-item menu-item-type-custom menu-item-object-custom menu-item-9916444"><a href="https://www.sun-sentinel.com/login">Log in</a></li>
</ul>								<div id="push-account-content">
									<a class="show-digisubs-push account-link" id="push-email-link"></a>
									<p class="show-digisubs-push logged-in-source" id="push-auth-source"></p>
									<a class="show-digisubs-push account-link" id="push-account-link">Account Settings</a>
									<a class="show-digisubs-push" id="push-contact-us" href="/contact-us">Contact Us</a>
									<a class="show-digisubs-push" id="push-log-out" href="/logout">Log Out</a>
									<div class="show-digisubs-push marketing-slot" id="push-marketing-slot"></div>
									<label class="user-spoof">Spoof a user</label>
									<input id="push-user-spoof-control" class="user-spoof" type="checkbox">
									<ul id="newsLetterItem-push" class="newsLetterContent"></ul>
								</div>
							</div>
							<div class="newsletter-nav">
									<div class="newsletter-simple">
		<div class="newsletter-item">
			<p class="prompt">Sign up for email newsletters</p>
			<a class="sign-up-button" href="https://membership.sun-sentinel.com/newsletters#nt=primarynavbar"
			   aria-label="Click here to go to the newsletter sign up page">
				Sign Up</a>
		</div>
	</div>
							</div>
						</div>
					</nav>
					<div class="digisubs-wrapper-large" id="digisubs-wrapper-large">
						<ul id="dfm-digisubs-menu" class="menu"><li id="menu-item-5630193" class="subscribe-visibility subscribe-special custom-button menu-item menu-item-type-custom menu-item-object-custom menu-item-5630193"><a href="https://mktops.sun-sentinel.com/subscriptions/land-flash-sale-lightning-bolt-23/indexD.html?market=ss&#038;source=index&#038;g2i_source=SB&#038;g2i_medium=nav2&#038;g2i_campaign=FD22">Subscribe</a></li>
<li id="menu-item-5630272" class="log-in-button subscribe-special custom-button menu-item menu-item-type-custom menu-item-object-custom menu-item-5630272"><a href="https://www.sun-sentinel.com/login">Log in</a></li>
</ul>					</div>
									</div>
			<div class="search-icon-wrapper"><span class="icon-search" aria-label="Click here or hit enter to open a Search box" id="dfm-search-icon" role="button" tabindex=0 aria-expanded="false"></span></div><form class="search-form header-search" method="GET" id="search-bar" action="https://www.sun-sentinel.com/">

		<div class="input-wrapper">
			<span class="icon-search" aria-hidden="true"></span>
		<input id="mng-search-focus" type="text" placeholder="Type your search" name="s"  aria-label="Type your search">
		<input name="orderby" type="hidden" value="date"/>
		<input name="order" type="hidden" value="desc"/>
		<div class="search-button-container">
			<button class="search-button" type="search">
				<span>Search</span>
			</button>
		</div>
	</div>
	
</form>


						</div>

					</div>

					<div class="nav-primary-middle">

										<div class="accuweather-wrap">
					<div class="weather-date">
					
	<div class='dfm_accuweather_current_conditions'>
		<a target="_blank" href="/weather" title="Current Weather Conditions" aria-label="Current temperature is 73&deg;F, view full weather conditions in a new window">
			<span>73&deg;F</span>
			<i class="bi-cloud-sun" role="img" aria-label="weather icon cloud-sun"></i>
		</a>
	</div>						<div class="date">
							Friday, February 9th 2024									<a class="tribune-e-edition" title="Link to first E-Edition opens in a new window" target="_blank" href="https://enewspaper.sun-sentinel.com">
									<p class="e-edition">Daily e-Edition</p>									</a>
									<a class="tribune-e-edition" title="Link to second E-Edition opens in a new window" target="_blank" href="https://enewspaper.sun-sentinel.com/eveningedition">
									<p class="e-edition">Evening e-Edition</p>									</a>
														</div>
					</div>
				</div>
						<div class="hidden-logo">
			<div class="section-header"><a href="https://www.sun-sentinel.com/news/politics/">Politics</a></div>			</div>
						<div class="sponsorship-ad-wrapper">
								<div class="dfp-ad dfp-sponsorship_1" id="div-gpt-ad-sponsorship_1" style="visibility:hidden">
					<div class="htlad-sponsorship_1" data-unit='sun-sentinel.com/news/politics/sponsorship_1' data-targeting=''></div>
				</div>			</div>
			
					</div>

					<div class="nav-primary-bottom">

									<div class="nav-primary">
						</div>
			
					</div>

				</div>

				
<div class="widget widget-trending-stories"><div class="trending-bar trending">
	<div class="trending-bar-wrapper">
		<p class="label">
			Trending:		</p>
		<nav>
			<ul>
				
	<li class="entry-title">

<div class="entry-section"><a href="https://www.sun-sentinel.com/news/politics/">Politics | </a></div>			<a class="article-title" href="https://www.sun-sentinel.com/2024/01/31/black-history-month-2024-this-years-theme-is-the-arts-and-south-florida-is-ready-with-music-film-dance-other-events/" title="Black History Month 2024: This year&#8217;s theme is the arts — and South Florida is ready with music, film, dance &amp; other events">
	
				<span class="dfm-title premium">
			Black History Month		</span>

			</a>
	
	</li>

	<li class="entry-title">

<div class="entry-section"><a href="https://www.sun-sentinel.com/news/politics/">Politics | </a></div>			<a class="article-title" href="https://www.sun-sentinel.com/2024/02/01/who-has-the-best-bagels-in-south-florida-nominate-your-favorite-spot/" title="Who has the best bagels in South Florida? Nominate your favorite spot">
	
				<span class="dfm-title metered">
			Nominate: Best Bagels		</span>

			</a>
	
	</li>
			</ul>
		</nav>
	</div>
</div>

</div>
			</div>
			</header><div id="content" class="site-content">
						<div class="header-banners">
								<div class="dfp-ad dfp-interstitial" id="div-gpt-ad-interstitial" style="visibility:hidden">
					<div class="htlad-interstitial" data-unit='sun-sentinel.com/news/politics/interstitial' data-targeting=''></div>
				</div>				<div class="dfp-ad dfp-top_leaderboard" id="div-gpt-ad-top_leaderboard" style="visibility:hidden">
					<div class="htlad-top_leaderboard" data-unit='sun-sentinel.com/news/politics/top_leaderboard' data-targeting=''></div>
				</div>			</div>
			
			<div id="primary" class="content-area"><main id="main" class="site-main" role="main">		<article id="post-10532429" class="full-view post-10532429 post type-post status-publish format-standard has-post-thumbnail hentry category-education category-election category-florida-news category-latest-headlines category-local-news category-news category-politics location-broward-county location-florida location-fort-lauderdale type-of-work-news">
			<header class="entry-header article-header">
<div class="header-title-area"><div class="breadcrumbs">
	<h2><a href="https://www.sun-sentinel.com/news/" class="category-news">News</a></h2><span class="icon-arrow-right"></span><h2><a href="https://www.sun-sentinel.com/news/politics/" class="category-politics">Politics</a></h2></div>
<div class="headline-area"><div class="headlines"><h3 class="subscriber-only-tag">SUBSCRIBER ONLY</h3>
	<h1 class="entry-title">

<div class="entry-section"><a href="https://www.sun-sentinel.com/news/politics/">Politics | </a></div>	
				<span class="dfm-title premium">
			Website detailed Heather Moraitis campaign for School Board. She says she hasn’t decided if she’s running.		</span>

	
	</h1>
</div></div></div></header><div class="article-content"><div class="article-content-wrapper"><div class="header-features default">
<figure>
	<div class="image-wrapper"><img alt="Heather Moraitis, a former Fort Lauderdale city commissioner, said she hasn&#039;t made a decision about a 2024 candidacy for Broward School Board. A website touting her candidacy was online." title="Heather Moraitis, a former Fort Lauderdale city commissioner, said she hasn&#039;t made a decision about a 2024 candidacy for Broward School Board. A website touting her candidacy was online." subtitle="" class="lazyload  size-article_feature" data-sizes="auto" data-src="https://www.sun-sentinel.com/wp-content/uploads/2024/02/TFL-TFL-L-heather-moraitis-FL0123004255.jpg?w=280" data-srcset="https://www.sun-sentinel.com/wp-content/uploads/2024/02/TFL-TFL-L-heather-moraitis-FL0123004255.jpg?w=280 620w,https://www.sun-sentinel.com/wp-content/uploads/2024/02/TFL-TFL-L-heather-moraitis-FL0123004255.jpg?w=352 780w,https://www.sun-sentinel.com/wp-content/uploads/2024/02/TFL-TFL-L-heather-moraitis-FL0123004255.jpg?w=460 1020w,https://www.sun-sentinel.com/wp-content/uploads/2024/02/TFL-TFL-L-heather-moraitis-FL0123004255.jpg?w=576 1280w,https://www.sun-sentinel.com/wp-content/uploads/2024/02/TFL-TFL-L-heather-moraitis-FL0123004255.jpg?w=640 1860w" ></div>			<figcaption>
						Heather Moraitis, a former Fort Lauderdale city commissioner, said she hasn&#8217;t made a decision about a 2024 candidacy for Broward School Board. A website touting her candidacy was online.		</figcaption>
	</figure>
<div class="meta"><img class="avatar avatar-85 photo coauthor-avatar lazyload  size-85x85" data-sizes="auto" data-src="https://www.sun-sentinel.com/wp-content/uploads/2023/05/TFL-L-staff-mug-Anthony-Man-102623.jpeg?w=85" data-srcset="https://www.sun-sentinel.com/wp-content/uploads/2023/05/TFL-L-staff-mug-Anthony-Man-102623.jpeg?w=85 85w" alt="Sun Sentinel political reporter Anthony Man is photographed in the Deerfield Beach office on Monday, Oct. 26, 2023. (Amy Beth Bennett / South Florida Sun Sentinel)"><div class="coauthor-avatar-container"><div class="byline">By <a href="https://www.sun-sentinel.com/author/anthony-man/" title="Posts by Anthony Man" class=" author-name" rel="author">Anthony Man</a> | <a href="mailto:aman@sunsentinel.com">aman@sunsentinel.com</a> | South Florida Sun Sentinel</pre></div><div class="time">PUBLISHED: <time datetime="2024-02-02 07:00:53">February 2, 2024 at 7:00 a.m.</time> | UPDATED: <time class="updated" datetime="2024-02-02 17:44:01">February 2, 2024 at 5:44 p.m.</time></div></div></div></div><div class="article-body"><div class="body-copy mng-subscriber-content"><div class="wp-remixd-voice-wrapper"><script type="text/javascript" id="remixd-audio-player-script" src="https://tags.remixd.com/player/v5/index.js?cb=%%CACHEBUSTER%%" charset="utf-8" async></script></div><p>Heather Moraitis, a Republican who served four-plus years on the Fort Lauderdale City Commission, may be running for Broward School Board. Or maybe not.</p>
<p>Moraitis said Thursday she hasn’t made a decision. And she hasn’t filed any paperwork indicating a candidacy, something that’s required for someone to raise and spend money as a candidate in Florida.</p>
<p>Yet a robust “Heather Moraitis for Broward County School Board Because Experience Matters” was online.</p>
<p>“Stand with Heather and give our children the best education!” the website said. “Heather Moraitis for Broward County School Board A Vision for Children&#8217;s Dreams.”</p>
<div class="s2nPlayer k-gbDoqmaV" data-type="float"></div>
<p>Along with the disclaimer at the bottom of the page — “Paid by Heather Moraitis for Broward County School Board” — it featured a dozen photos, a biographical section, a pitch for contributions, a place to subscribe for campaign updates and a list of priorities.</p>
<p>By Thursday evening, a few hours after a reporter asked Moraitis about the website, it had been taken down, with people getting a 404 error message.</p>				<div class="dfp-ad dfp-outstream_video" id="div-gpt-ad-outstream_video" style="visibility:hidden">
					<div class="htlad-outstream_video" data-unit='sun-sentinel.com/news/politics/outstream_video' data-targeting=''></div>
				</div>
<h4>No decision</h4>
<p>Moraitis said Thursday she doesn’t have a campaign committee, didn’t authorize the website, and hasn’t decided if she’s going to run.</p>
<p>She said she has spoken to people about possibly running.</p>				<div class="dfp-ad dfp-cube_article" id="div-gpt-ad-cube_article" style="visibility:hidden">
					<div class="htlad-cube_article" data-unit='sun-sentinel.com/news/politics/cube_article' data-targeting=''></div>
				</div>
<p>“I have thought about running for School Board. I have not made any decisions,” she said.</p>
<p>She said the pictures and biographical material were all taken from an old, no-longer-operating website, adding she doesn&#8217;t know who created the new one. “I didn’t approve it. I didn’t put it up. It’s not my website.”</p>
<p>School Board candidates have until June 14 to qualify for the August ballot.</p>
<p>“I know when the qualifying date is and I know what I’d have to do,” she said. “Would I consider it? I’m considering all options.”</p>
<p>Another possibility: a 2026 campaign for state House of Representatives, when state Rep. Chip LaMarca, the only elected Republican in a partisan office in Broward, won’t be able to seek another term because of term limits.</p>
<p>Before LaMarca, Moraitis’s husband, George, served in the state House until term limits prevented him from running for reelection.</p>
<p>“George and I will definitely be in politics again one day. Either one of us. I just don’t know exactly what it looks like. I love education. I have a long history in education, supporting education initiatives in the city of Fort Lauderdale. I don&#8217;t know if it’s on the School Board or if it’s in the state House or if it’s another position.”</p>
<aside class="related left"><h2 class="widget-title" data-curated-ids="10472325,10509808,10466485,10450639,10369478" data-relation-type="curated">Related Articles</h2><ul><li>

<div class="entry-section"><a href="https://www.sun-sentinel.com/news/politics/">Politics | </a></div>			<a class="article-title" href="https://www.sun-sentinel.com/2024/01/28/whos-showing-financial-muscle-in-high-stakes-contest-for-broward-state-senate-seat/" title="Who’s showing financial muscle in high-stakes contest for Broward state Senate seat?">
	
				<span class="dfm-title metered">
			Who’s showing financial muscle in high-stakes contest for Broward state Senate seat?		</span>

			</a>
	
</li><li>

<div class="entry-section"><a href="https://www.sun-sentinel.com/news/politics/">Politics | </a></div>			<a class="article-title" href="https://www.sun-sentinel.com/2024/01/30/president-joe-biden-is-in-south-florida-to-boost-his-reelection-effort/" title="President Joe Biden takes on Trump&#8217;s &#8216;lies&#8217; and touts Democrats&#8217; prospects at fundraisers in South Florida">
	
				<span class="dfm-title premium">
			President Joe Biden takes on Trump&#8217;s &#8216;lies&#8217; and touts Democrats&#8217; prospects at fundraisers in South Florida		</span>

			</a>
	
</li><li>

<div class="entry-section"><a href="https://www.sun-sentinel.com/news/politics/">Politics | </a></div>			<a class="article-title" href="https://www.sun-sentinel.com/2024/01/24/young-democrats-form-new-pac-to-mobilize-young-voters-in-florida/" title="Young Democrats form new PAC to mobilize young voters in Florida">
	
				<span class="dfm-title premium">
			Young Democrats form new PAC to mobilize young voters in Florida		</span>

			</a>
	
</li><li>

<div class="entry-section"><a href="https://www.sun-sentinel.com/news/politics/">Politics | </a></div>			<a class="article-title" href="https://www.sun-sentinel.com/2024/01/21/leading-desantis-supporters-in-florida-quickly-shift-to-trump-as-governor-ends-presidential-bid/" title="Leading DeSantis supporters in Florida quickly shift to Trump as governor ends presidential bid">
	
				<span class="dfm-title premium">
			Leading DeSantis supporters in Florida quickly shift to Trump as governor ends presidential bid		</span>

			</a>
	
</li><li>

<div class="entry-section"><a href="https://www.sun-sentinel.com/news/politics/">Politics | </a></div>			<a class="article-title" href="https://www.sun-sentinel.com/2024/01/14/what-happened-to-286935-voters-registrations-suddenly-drop-in-broward-palm-beach-counties/" title="What happened to thousands of voters? Registrations suddenly drop in Broward, Palm Beach counties">
	
				<span class="dfm-title premium">
			What happened to thousands of voters? Registrations suddenly drop in Broward, Palm Beach counties		</span>

			</a>
	
</li></ul></aside>
<h4>Familiar territory</h4>
<p>If she runs, Moraitis said it would be in District 3, which is currently represented by School Board member Sarah Leonardi.</p>
<p>Leonardi is the only District 3 candidate who has filed paperwork with the Supervisor of Elections Office. Her latest campaign finance report shows she had a balance of $36,000 in her campaign account as of Dec. 31.</p>
<p>Leonardi, who was a teacher in Broward public high schools, was elected in 2020, narrowly defeating incumbent Heather Brinkworth, 52% to 48%.</p>
<h4>Politics</h4>
<p>Officially, School Board races are nonpartisan. But Leonardi is a well-known Democrat, just as Moraitis is a well-known Republican.</p>
<p>School Board races in Broward, as well as elsewhere in Florida and nationwide, have become much more contentious and far more political in recent years as boards have become battlegrounds over a range of issues, ranging from making policies during the COVID-19 pandemic, what books are appropriate for school libraries, and how to handle discussions of racial differences and LGBTQ issues.</p>
<p>Moraitis has extensive political experience in the district. The Fort Lauderdale commission district she represented from 2018 through 2022 lies in School Board District 3.</p>
<p>District 3 includes all or parts of Dania Beach, Davie, Fort Lauderdale, Hollywood, Lauderdale-by-the-Sea, Lazy Lake, North Lauderdale, Oakland Park, Plantation, Pompano Beach, Sea Ranch Lakes, Tamarac and Wilton Manors.</p>
<p>George Moraitis’ state House district also included much of the same East Broward territory. Heather Moraitis was heavily involved in her husband’s campaigns.</p>
<h4>Departing</h4>
<p>Heather Moraitis left the City Commission early, her resignation in April 2022 and leaving office in November 2022.</p>
<p>She said at the time she planned to spend more time with her family and return to her work in education.</p>
<p>At the time, people in the political world wondered if she’d run for School Board, something she disclaimed any interest in doing. “I am definitely not running for school board,” she said in April 2022. “My passion lies with charter schools. I don’t know what I’m going to do, believe it or not. I am open to exploring opportunities.”</p>
<p>Since leaving the commission, Moraitis said, she has taught advanced placement government and politics at Westminster Academy in Fort Lauderdale, which is affiliated with Coral Ridge Presbyterian Church. She is a past director of development at Westminster Academy.</p>
<p>Her LinkedIn profile also shows she is a senior fellow at the Institute for Faith &amp; Culture, which has the same address as Coral Ridge Presbyterian on Federal Highway in northeast Fort Lauderdale.</p>
<p>When she left the commission, she “wasn’t running for anything.”</p>
<p>“Right now, I’m supporting family members through some challenging health issues. And I’m going to make a decision soon,” she said.</p>
<p><em>Anthony Man can be reached at aman@sunsentinel.com and can be found @browardpolitics on Bluesky, Threads, Facebook and Post.news</em>.</p>
</p></p></div></div><div class="article-bottom-share"><div class="article-share" ><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-10532429" class="share-facebook sd-button share-icon no-text" href="https://www.sun-sentinel.com/2024/02/02/website-detailed-heather-moraitis-campaign-for-school-board-she-says-she-hasnt-decided-if-shes-running/?share=facebook" target="_blank" title="Click to share on Facebook" ><span></span><span class="sharing-screen-reader-text">Click to share on Facebook (Opens in new window)</span></a></li><li class="share-x"><a rel="nofollow noopener noreferrer" data-shared="sharing-x-10532429" class="share-x sd-button share-icon no-text" href="https://www.sun-sentinel.com/2024/02/02/website-detailed-heather-moraitis-campaign-for-school-board-she-says-she-hasnt-decided-if-shes-running/?share=x" target="_blank" title="Click to share on X" ><span></span><span class="sharing-screen-reader-text">Click to share on X (Opens in new window)</span></a></li><li class="share-end"></li></ul></div></div></div></div></div><div class="swappable taboola-swap" data-swap-location=".recirc" data-swap-method="prepend" data-swap-max="l"><div id="taboola-below-article-thumbnails"></div><script type="text/javascript">
		   window._taboola = window._taboola || [];
			  _taboola.push({
				mode: 'thumbnails-a',
				container: 'taboola-below-article-thumbnails',
				placement: 'Below Article Thumbnails',
				target_type: 'mix'
			  });
		</script></div></div><aside class="article-sidebar swappable" data-swap-location=".recirc" data-swap-method="after" data-swap-max="l"><div class="sidebar-content">				<div class="dfp-ad dfp-cube1_rrail_atf" id="div-gpt-ad-cube1_rrail_atf" style="visibility:hidden">
					<div class="htlad-cube1_rrail_atf" data-unit='sun-sentinel.com/news/politics/cube1_rrail_atf' data-targeting=''></div>
				</div><div id="Native_Cube"></div>				<div class="dfp-ad dfp-cube2_rrail_mid" id="div-gpt-ad-cube2_rrail_mid" style="visibility:hidden">
					<div class="htlad-cube2_rrail_mid" data-unit='sun-sentinel.com/news/politics/cube2_rrail_mid' data-targeting=''></div>
				</div><div style="display:block;"><div id="taboola-right-rail-thumbnails"></div><script type="text/javascript">
 			window._taboola = window._taboola || [];
  			_taboola.push({
    			mode: 'thumbnails-rr2',
    			container: 'taboola-right-rail-thumbnails',
    			placement: 'Right Rail Thumbnails',
    			target_type: 'mix'
  			});
		</script></div><div class="swappable swap-ad swap-ad-lower" data-swap-location=".feature-video" data-swap-method="after" data-swap-max="m">				<div class="dfp-ad dfp-cube3_rrail_lower" id="div-gpt-ad-cube3_rrail_lower" style="visibility:hidden">
					<div class="htlad-cube3_rrail_lower" data-unit='sun-sentinel.com/news/politics/cube3_rrail_lower' data-targeting=''></div>
				</div></div><div class="sidebar-bottom-flex-single"><div class="dfm-sidebar-bottom-flex-container">
<div class="dfm-sidebar-most-popular-flex-container">
<h2>Trending Nationally</h2>
<ul><li><a target="_blank" href="https://www.mercurynews.com/2024/02/08/gov-gavin-newsom-sending-doj-national-guard-attorneys-to-alameda-county-to-beef-up-prosecutions/?itm_source=parsely-api">California gov. sending DOJ, National Guard attorneys to Alameda County to beef up prosecutions</a></li><li><a target="_blank" href="https://www.denverpost.com/2024/02/08/wolves-impact-habitat-study-yellowstone-national-park-colorado-reintroduction/?itm_source=parsely-api">Do wolves actually fix habitats and change rivers? Here’s what new research from Colorado says</a></li><li><a target="_blank" href="http://www.nydailynews.com/2024/02/08/sliwa-assumed-man-attacked-by-guardian-angels-in-times-square-was-migrant-because-he-spoke-spanish/?itm_source=parsely-api">Video contradicts Curtis Sliwa account of Guardian Angels “migrant” beating: NYPD source</a></li><li><a target="_blank" href="http://www.mcall.com/2024/02/07/major-incident-unfolds-in-east-lansdowne-2-officers-shot-and-a-standoff/?itm_source=parsely-api">6 to 8 family members missing, feared dead, in Delaware County house fire after 2 officers shot [Video]</a></li><li><a target="_blank" href="http://www.courant.com/2024/02/07/thousands-of-dollars-of-marijuana-products-seized-from-ct-smoke-shops-during-inspections/?itm_source=parsely-api">Thousands of dollars of marijuana products seized from Connecticut smoke shops during inspections</a></li>
</ul>
</div><div id="stick-trigger"></div></div></div></div></aside></div><footer class="article-footer"><div class="footer-meta"><div class="footer-meta-content"><div id="Native_Bottom"></div></div></div><div class="recirc"></div>				<div class="dfp-ad dfp-bottom_leaderboard" id="div-gpt-ad-bottom_leaderboard" style="visibility:hidden">
					<div class="htlad-bottom_leaderboard" data-unit='sun-sentinel.com/news/politics/bottom_leaderboard' data-targeting=''></div>
				</div></footer></article></div></main>
		<div class="more-news">

			<h2 class="widget-title">More in Politics</h2>

			<ul>

				
					<li>
						


	<article class=" more-posts-view archive-view has-image post-10558360 post type-post status-publish format-standard has-post-thumbnail hentry category-national-politics category-news category-politics tag-network" data-id="10558360" data-timestamp="1707422174">

		
<figure>
			<a href="https://www.sun-sentinel.com/2024/02/08/donald-trump-clinches-win-at-us-virgin-islands-caucus-which-defied-republican-party-rules/" title="Donald Trump clinches win at US Virgin Islands caucus, which defied Republican Party rules" class=""></a>
	
	<a href="https://www.sun-sentinel.com/2024/02/08/donald-trump-clinches-win-at-us-virgin-islands-caucus-which-defied-republican-party-rules/" title="Donald Trump clinches win at US Virgin Islands caucus, which defied Republican Party rules">
		<div class="image-wrapper"><img alt="The caucus is the third Republican contest held this election season with delegates at stake, with Trump receiving 73.98% of the votes and Nikki Haley 26.02%." title="The caucus is the third Republican contest held this election season with delegates at stake, with Trump receiving 73.98% of the votes and Nikki Haley 26.02%." subtitle="" class="lazyload  size-more_news" data-sizes="auto" data-src="https://www.sun-sentinel.com/wp-content/uploads/2024/02/Election_2024_Trump_77054.jpg?w=525" data-srcset="https://www.sun-sentinel.com/wp-content/uploads/2024/02/Election_2024_Trump_77054.jpg?w=525 620w,https://www.sun-sentinel.com/wp-content/uploads/2024/02/Election_2024_Trump_77054.jpg?w=323 380w,https://www.sun-sentinel.com/wp-content/uploads/2024/02/Election_2024_Trump_77054.jpg?w=420 500w,https://www.sun-sentinel.com/wp-content/uploads/2024/02/Election_2024_Trump_77054.jpg?w=458 540w" ></div>	</a>
</figure>

<div class="article-info">
		<header>

		
		
		
	<h3 class="entry-title">

<div class="entry-section"><a href="https://www.sun-sentinel.com/news/politics/national-politics/">National Politics | </a></div>			<a class="article-title" href="https://www.sun-sentinel.com/2024/02/08/donald-trump-clinches-win-at-us-virgin-islands-caucus-which-defied-republican-party-rules/" title="Donald Trump clinches win at US Virgin Islands caucus, which defied Republican Party rules">
	
				<span class="dfm-title metered">
			Donald Trump clinches win at US Virgin Islands caucus, which defied Republican Party rules		</span>

			</a>
	
	</h3>
<!--		-->
		
		
		
		
		
	</header>

	
		</div><!-- .article-info -->

		

		
	</article>


					</li>

				
					<li>
						


	<article class=" more-posts-view archive-view has-image post-10558197 post type-post status-publish format-standard has-post-thumbnail hentry category-latest-headlines category-national-news category-national-politics category-news category-politics" data-id="10558197" data-timestamp="1707415768">

		
<figure>
			<a href="https://www.sun-sentinel.com/2024/02/08/takeaways-from-the-special-counsels-report-on-bidens-handling-of-classified-documents/" title="Takeaways from the special counsel’s report on Biden’s handling of classified documents" class=""></a>
	
	<a href="https://www.sun-sentinel.com/2024/02/08/takeaways-from-the-special-counsels-report-on-bidens-handling-of-classified-documents/" title="Takeaways from the special counsel’s report on Biden’s handling of classified documents">
		<div class="image-wrapper"><img alt="Special Counsel Robert Hur on Thursday released his long-awaited report on President Joe Biden&#8217;s handling of classified documents, concluding that Biden had &#8220;willfully&#8221; retained and disclosed highly classified materials when he was a private citizen. The report also highlighted Biden&#8217;s confusion and &#8220;significantly limited&#8221; [&hellip;]" title="Special Counsel Robert Hur on Thursday released his long-awaited report on President Joe Biden&#8217;s handling of classified documents, concluding that Biden had &#8220;willfully&#8221; retained and disclosed highly classified materials when he was a private citizen. The report also highlighted Biden&#8217;s confusion and &#8220;significantly limited&#8221; [&hellip;]" subtitle="" class="lazyload  size-more_news" data-sizes="auto" data-src="https://www.sun-sentinel.com/wp-content/uploads/2024/02/Biden_Classified_Documents_98750-6.jpg?w=525" data-srcset="https://www.sun-sentinel.com/wp-content/uploads/2024/02/Biden_Classified_Documents_98750-6.jpg?w=525 620w,https://www.sun-sentinel.com/wp-content/uploads/2024/02/Biden_Classified_Documents_98750-6.jpg?w=322 380w,https://www.sun-sentinel.com/wp-content/uploads/2024/02/Biden_Classified_Documents_98750-6.jpg?w=420 500w,https://www.sun-sentinel.com/wp-content/uploads/2024/02/Biden_Classified_Documents_98750-6.jpg?w=457 540w" ></div>	</a>
</figure>

<div class="article-info">
		<header>

		
		
		
	<h3 class="entry-title">

<div class="entry-section"><a href="https://www.sun-sentinel.com/news/politics/national-politics/">National Politics | </a></div>			<a class="article-title" href="https://www.sun-sentinel.com/2024/02/08/takeaways-from-the-special-counsels-report-on-bidens-handling-of-classified-documents/" title="Takeaways from the special counsel’s report on Biden’s handling of classified documents">
	
				<span class="dfm-title metered">
			Takeaways from the special counsel’s report on Biden’s handling of classified documents		</span>

			</a>
	
	</h3>
<!--		-->
		
		
		
		
		
	</header>

	
		</div><!-- .article-info -->

		

		
	</article>


					</li>

				
					<li>
						


	<article class=" more-posts-view archive-view has-image post-10557808 post type-post status-publish format-standard has-post-thumbnail hentry category-national-politics category-news category-politics tag-network" data-id="10557808" data-timestamp="1707406920">

		
<figure>
			<a href="https://www.sun-sentinel.com/2024/02/08/takeaways-from-the-supreme-court-arguments-over-whether-trump-is-ineligible-to-be-president-again/" title="Takeaways from the Supreme Court arguments over whether Trump is ineligible to be president again" class=""></a>
	
	<a href="https://www.sun-sentinel.com/2024/02/08/takeaways-from-the-supreme-court-arguments-over-whether-trump-is-ineligible-to-be-president-again/" title="Takeaways from the Supreme Court arguments over whether Trump is ineligible to be president again">
		<div class="image-wrapper"><img alt="The justices sounded highly skeptical of the effort. It&#039;s the first time that voters have tried to block a candidate from the presidency." title="The justices sounded highly skeptical of the effort. It&#039;s the first time that voters have tried to block a candidate from the presidency." subtitle="" class="lazyload  size-more_news" data-sizes="auto" data-src="https://www.sun-sentinel.com/wp-content/uploads/2024/02/AP24039706379623-2.jpg?w=525" data-srcset="https://www.sun-sentinel.com/wp-content/uploads/2024/02/AP24039706379623-2.jpg?w=525 620w,https://www.sun-sentinel.com/wp-content/uploads/2024/02/AP24039706379623-2.jpg?w=323 380w,https://www.sun-sentinel.com/wp-content/uploads/2024/02/AP24039706379623-2.jpg?w=420 500w,https://www.sun-sentinel.com/wp-content/uploads/2024/02/AP24039706379623-2.jpg?w=458 540w" ></div>	</a>
</figure>

<div class="article-info">
				<h3 class="subscriber-only-tag">SUBSCRIBER ONLY</h3>
				<header>

		
		
		
	<h3 class="entry-title">

<div class="entry-section"><a href="https://www.sun-sentinel.com/news/politics/national-politics/">National Politics | </a></div>			<a class="article-title" href="https://www.sun-sentinel.com/2024/02/08/takeaways-from-the-supreme-court-arguments-over-whether-trump-is-ineligible-to-be-president-again/" title="Takeaways from the Supreme Court arguments over whether Trump is ineligible to be president again">
	
				<span class="dfm-title premium">
			Takeaways from the Supreme Court arguments over whether Trump is ineligible to be president again		</span>

			</a>
	
	</h3>
<!--		-->
		
		
		
		
		
	</header>

	
		</div><!-- .article-info -->

		

		
	</article>


					</li>

				
					<li>
						


	<article class=" more-posts-view archive-view has-image post-10558010 post type-post status-publish format-standard has-post-thumbnail hentry category-florida-news category-news category-politics location-florida" data-id="10558010" data-timestamp="1707404427">

		
<figure>
			<a href="https://www.sun-sentinel.com/2024/02/08/ziegler-wants-marsys-law-to-protect-him-but-cops-say-hes-not-a-victim/" title="Ziegler wants Marsy’s Law to protect him, but cops say he’s not a victim" class=""></a>
	
	<a href="https://www.sun-sentinel.com/2024/02/08/ziegler-wants-marsys-law-to-protect-him-but-cops-say-hes-not-a-victim/" title="Ziegler wants Marsy’s Law to protect him, but cops say he’s not a victim">
		<div class="image-wrapper"><img alt="Christian Ziegler, the former chairman of the Republican Party of Florida who is under criminal investigation, is citing a law that protects victims in a bid to stop the release of more information from his cell phone. But police say Ziegler is not the victim of a crime." title="Christian Ziegler, the former chairman of the Republican Party of Florida who is under criminal investigation, is citing a law that protects victims in a bid to stop the release of more information from his cell phone. But police say Ziegler is not the victim of a crime." subtitle="" class="lazyload  size-more_news" data-sizes="auto" data-src="https://www.sun-sentinel.com/wp-content/uploads/2024/02/Christian-and-Bridget-Ziegler.jpg?w=467" data-srcset="https://www.sun-sentinel.com/wp-content/uploads/2024/02/Christian-and-Bridget-Ziegler.jpg?w=467 620w,https://www.sun-sentinel.com/wp-content/uploads/2024/02/Christian-and-Bridget-Ziegler.jpg?w=287 380w,https://www.sun-sentinel.com/wp-content/uploads/2024/02/Christian-and-Bridget-Ziegler.jpg?w=373 500w,https://www.sun-sentinel.com/wp-content/uploads/2024/02/Christian-and-Bridget-Ziegler.jpg?w=407 540w" ></div>	</a>
</figure>

<div class="article-info">
		<header>

		
		
		
	<h3 class="entry-title">

			<a class="article-title" href="https://www.sun-sentinel.com/2024/02/08/ziegler-wants-marsys-law-to-protect-him-but-cops-say-hes-not-a-victim/" title="Ziegler wants Marsy’s Law to protect him, but cops say he’s not a victim">
	
				<span class="dfm-title metered">
			Ziegler wants Marsy’s Law to protect him, but cops say he’s not a victim		</span>

			</a>
	
	</h3>
<!--		-->
		
		
		
		
		
	</header>

	
		</div><!-- .article-info -->

		

		
	</article>


					</li>

				
			</ul>
		</div>

	<div class="dfm-page-bottom-flex-container"></div>				<div class="dfp-ad dfp-sponsorship_2" id="div-gpt-ad-sponsorship_2" style="visibility:hidden">
					<div class="htlad-sponsorship_2" data-unit='sun-sentinel.com/news/politics/sponsorship_2' data-targeting=''></div>
				</div>  <div class="sm-breadcrumb">
    <ul class="sitemap-parent">
      <li class="sitemap-list"><a href="https://www.sun-sentinel.com/sitemap/2024/">2024</a><span class="sitemap-span icon-arrow-right"></span></li>
      <li class="sitemap-list"><a href="https://www.sun-sentinel.com/sitemap/2024/02/">February</a><span class="sitemap-span icon-arrow-right"></span></li>
      <li class="sitemap-list"><a href="https://www.sun-sentinel.com/sitemap/2024/02/2/">2</a></li>
    </ul>
  </div>
			
			</div><!-- #content -->

						<footer class="site-footer">

				<div class="main-footer-wrapper">

						<div class="footer-logo">

							<div class="custom-logo logo"><a href="https://www.sun-sentinel.com" aria-label="Sun Sentinel"><img src="https://www.sun-sentinel.com/wp-content/uploads/2023/03/sunsent-removebg-preview.png" alt="Sun Sentinel"></a></div>
						</div>

					<ul id="footer-menu" class="footer-menus"><li id="menu-item-348" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-348"><a href="https://www.tribpub.com/">Tribune Publishing</a><span class="expander"><a href="#" class="icon-plus" aria-label="Click here to expand the menu"></a></span>

<ul class="footer-menu">
	<li id="menu-item-349" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-349"><a href="https://www.chicagotribune.com/">Chicago Tribune</a></li>
	<li id="menu-item-351" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-351"><a href="https://www.mcall.com/">The Morning Call of Pa.</a></li>
	<li id="menu-item-352" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-352"><a href="https://www.dailypress.com/">Daily Press of Va.</a></li>
	<li id="menu-item-354" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-354"><a href="https://www.nydailynews.com/">New York Daily News</a></li>
	<li id="menu-item-355" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-355"><a href="https://www.orlandosentinel.com/">Orlando Sentinel</a></li>
	<li id="menu-item-356" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-356"><a href="https://www.courant.com/">Hartford Courant</a></li>
	<li id="menu-item-357" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-357"><a href="https://www.pilotonline.com/">The Virginian-Pilot</a></li>
	<li id="menu-item-358" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-358"><a href="https://www.studio1847.io/">Studio 1847</a></li>
</ul>
</li>
<li id="menu-item-359" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-359"><a href="https://www.tribpub.com/#who-we-are">Company Info</a><span class="expander"><a href="#" class="icon-plus" aria-label="Click here to expand the menu"></a></span>

<ul class="footer-menu">
	<li id="menu-item-8865351" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-8865351"><a href="https://www.sun-sentinel.com/about-us/">About us</a></li>
	<li id="menu-item-361" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-361"><a href="https://careers.tribpub.com/">Careers</a></li>
	<li id="menu-item-362" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-362"><a href="https://www.tkqlhce.com/click-8479699-11570746?url=https://sun-sentinel.newspapers.com/?xid=2308&#038;utm_campaign=evergreen&#038;utm_medium=referral&#038;utm_source=navigation&#038;utm_content=&#038;utm_term=Sun-Sentinel">Archives</a></li>
	<li id="menu-item-363" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-363"><a href="https://store.sun-sentinel.com/store/?utm_campaign=evergreen&#038;utm_medium=referral&#038;utm_source=navigation&#038;utm_content=&#038;utm_term=">Sun Sentinel Store</a></li>
</ul>
</li>
<li id="menu-item-364" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-364"><a href="https://www.sun-sentinel.com/contact-us/">Contact Us</a><span class="expander"><a href="#" class="icon-plus" aria-label="Click here to expand the menu"></a></span>

<ul class="footer-menu">
	<li id="menu-item-365" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-365"><a href="https://www.sun-sentinel.com/photo-requests/">Photo Requests</a></li>
	<li id="menu-item-366" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-366"><a>Submit a News Tip</a></li>
	<li id="menu-item-367" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-367"><a href="https://sun-sentinel.newspapers.com/?xid=2308">Newspaper Archives</a></li>
</ul>
</li>
<li id="menu-item-368" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-368"><a href="https://myaccount.sun-sentinel.com/">Manage Subscription</a><span class="expander"><a href="#" class="icon-plus" aria-label="Click here to expand the menu"></a></span>

<ul class="footer-menu">
	<li id="menu-item-369" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-369"><a href="http://enewspaper.sun-sentinel.com/html5/desktop/production/default.aspx?pubid=09c7c801-e32b-4036-b4e3-001ebe0a7176">e-Edition</a></li>
	<li id="menu-item-370" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-370"><a href="https://membership.sun-sentinel.com/newsletters/">Sign up for Newsletters</a></li>
	<li id="menu-item-8851716" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-8851716"><a href="https://www.sun-sentinel.com/help-center/">Help Center</a></li>
	<li id="menu-item-9737283" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-9737283"><a href="https://www.sun-sentinel.com/sitemap/">Site Map</a></li>
</ul>
</li>
<li id="menu-item-373" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-373"><a href="http://placeanad.sun-sentinel.com/">Advertise with Us</a><span class="expander"><a href="#" class="icon-plus" aria-label="Click here to expand the menu"></a></span>

<ul class="footer-menu">
	<li id="menu-item-374" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-374"><a href="https://placeanad.sun-sentinel.com/">Place an ad</a></li>
	<li id="menu-item-375" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-375"><a href="http://www.trbas.com/media/media/acrobat/2016-06/23509644072840-30092341.pdf#nt=primarynavbar">Ad Policy</a></li>
	<li id="menu-item-376" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-376"><a href="https://homes.sun-sentinel.com/">Homes for Sale</a></li>
	<li id="menu-item-377" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-377"><a href="https://placeanad.sun-sentinel.com/ad-options/?cat=transportation">Place an Auto Ad</a></li>
</ul>
</li>
<li id="menu-item-378" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-378"><a href="https://classifieds.sunsentinel.com/#nt=secondarynavbar">Classified</a><span class="expander"><a href="#" class="icon-plus" aria-label="Click here to expand the menu"></a></span>

<ul class="footer-menu">
	<li id="menu-item-379" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-379"><a href="https://jobs.sun-sentinel.com/">Find a Job</a></li>
	<li id="menu-item-380" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-380"><a href="https://classifieds.sunsentinel.com/fl/notices/">Legal Notices</a></li>
</ul>
</li>
<div class="mng-follow"><li class="footer-follow"></li>
							<a href="https://mktops.sun-sentinel.com/subscriptions/land-flash-sale-lightning-bolt-23/indexD.html?market=ss&#038;source=index&#038;g2i_source=SB&#038;g2i_medium=sub-nav&#038;g2i_campaign=FD22" class="subscribe-button" type="subscribe">
					<span>Subscribe Now</span>				</a>

				</div></ul>
				</div>

				<div class="dfm-site-info">

								<div class="colophon">

					<div class="footer-flex-menu-wrap"><ul id="footer-bottom-menu" class="menu"><li id="menu-item-8866436" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-8866436"><a href="https://www.tribpub.com/subscriber-terms-and-conditions/">Subscriber Terms and Conditions</a></li>
<li id="menu-item-8866439" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-8866439"><a href="https://www.tribpub.com/central-terms-of-service/">Terms of Service</a></li>
<li id="menu-item-8866442" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-8866442"><a href="https://www.tribpub.com/privacy-policy/">Privacy Policy</a></li>
<li id="menu-item-9850257" class="cookie-policy-click menu-item menu-item-type-custom menu-item-object-custom menu-item-9850257"><a href="#">Cookie Preferences</a></li>
<li id="menu-item-8866448" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-8866448"><a href="https://www.tribpub.com/cookie-policy/">Cookie Policy</a></li>
<li id="menu-item-8866454" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-8866454"><a href="https://www.tribpub.com/privacy-policy/#California_Notice_at_Collection">CA Notice at Collection</a></li>
<li id="menu-item-8866459" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-8866459"><a href="https://www.tribpub.com/privacy-policy/#Notice_of_Financial_Incentive">CA Notice of Financial Incentive</a></li>
<li id="menu-item-8866466" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-8866466"><a href="https://my.datasubject.com/16A1AnRt2Fn8i1unj/23233">Do Not Sell/Share My Personal Information</a></li>
</ul>	<div class="footer-copyright-notice">
		<p>Copyright &copy; 2024 Sun Sentinel</p>
	</div>	</div>
			</div>
			
				</div>

			</footer><!-- .site-footer -->
			
			</div><!-- #page -->

			<div id="mobile-adhesion" class="closed"><button class="close-mobile-adhesion" onclick="closeMobileAdhesionAd()" onkeydown="keyboardHandler(event)">Close</button>
			<script>
				function closeMobileAdhesionAd() {
				    document.getElementById("mobile-adhesion").classList.add("closed");
				}

				function keyboardHandler(e) {
				    var keycode = ( e.keyCode ? e.keyCode : e.which );
				    if (keycode == "13") {
						closeMobileAdhesionAd();
					}
				}
			</script>
							<div class="dfp-ad dfp-mobile_adhesion" id="div-gpt-ad-mobile_adhesion" style="visibility:hidden">
					<div class="htlad-mobile_adhesion" data-unit='sun-sentinel.com/news/politics/mobile_adhesion' data-targeting=''></div>
				</div></div><script type='text/javascript'>
/* <![CDATA[ */
if ( 'undefined' !== typeof _snaq ) {
_snaq.push(['setAuthor', 'Anthony Man']);
_snaq.push(['setArticlePublishTime','2024-02-02T07:00:53-05:00']);
_snaq.push(['setSection', 'Politics']);
}
/* ]]> */
</script>
<script type="text/javascript">
			  		window._taboola = window._taboola || [];
			  		_taboola.push({flush: true});
					</script><style id='global-styles-inline-css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}body { margin: 0; }.wp-site-blocks > .alignleft { float: left; margin-right: 2em; }.wp-site-blocks > .alignright { float: right; margin-left: 2em; }.wp-site-blocks > .aligncenter { justify-content: center; margin-left: auto; margin-right: auto; }:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}body .is-layout-grid{display: grid;}body .is-layout-grid > *{margin: 0;}body{padding-top: 0px;padding-right: 0px;padding-bottom: 0px;padding-left: 0px;}a:where(:not(.wp-element-button)){text-decoration: underline;}.wp-element-button, .wp-block-button__link{background-color: #32373c;border-width: 0;color: #fff;font-family: inherit;font-size: inherit;line-height: inherit;padding: calc(0.667em + 2px) calc(1.333em + 2px);text-decoration: none;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
</style>
<script type="text/javascript" src="https://www.sun-sentinel.com/_static/??-eJyVj8EOgkAMRH/IpRKJnozfglChuNtutl0NfL1g9EBijB47ndeZwj26RtiQDaLPHbGCkqFbDZbonBlBrTZqYFjLRSAuBt3Ah1uBO9ebh1oVTaEltbfmgrT6jY29mPCFvIcbcisJIjWWEy7Sf6Cvp1FpwlUeceNzi7r88yz2Ms+rKH5c+NmDyX6BEnY4e2uT5FJmo4B/Zn219yLXd/lTOJaH7X5f7cpqOzwAEVOpAw==" ></script><script src="https://www.sun-sentinel.com/wp-includes/js/dist/i18n.min.js?ver=7701b0c3857f914212ef" id="wp-i18n-js"></script>
<script id="wp-i18n-js-after">
wp.i18n.setLocaleData( { 'text direction\u0004ltr': [ 'ltr' ] } );
wp.i18n.setLocaleData( { 'text direction\u0004ltr': [ 'ltr' ] } );
</script>
<script id="wp-parsely-loader-js-before">
window.wpParselySiteId = 'sun-sentinel.com';
</script>
<script src="https://www.sun-sentinel.com/wp-content/mu-plugins/wp-parsely-3.13/build/loader.js?ver=f5c2d06f6755fda3f6d4" id="wp-parsely-loader-js"></script>
<script data-parsely-site="sun-sentinel.com" src="https://cdn.parsely.com/keys/sun-sentinel.com/p.js?ver=3.13.3" id="parsely-cfg"></script>
<script src="https://www.sun-sentinel.com/wp-content/themes/wp-mason/static/js/ads.js?ver=1.0" id="can-run-ads-js"></script>
<script type="text/javascript" src="https://www.sun-sentinel.com/_static/??-eJydzkEKwjAQQNELmU4VsboQzxKTtE3NzITOpOLtLehCQcS6/fDgwzUbx6SBFLQPGASsSFABUavRwSDgGJGpcn2hS4WRqkFW8IPLnG5tTEmWIAxWyhj8FM+jJf1C54JWmF5w4o5NxM5Y1fETzal0kQR8i8Z6g+zljc/tcbQcy4am6AP/ITPrfP2EJzyum3rXbPd1fRju1YaaJw==" ></script><script src="//embed.sendtonews.com/player3/embedcode.js?fk=gbDoqmaV&amp;cid=4641&amp;offsetx=0&amp;offsety=112&amp;floatwidth=400&amp;floatposition=bottom-right&amp;ver=1.0.0" id="dfm_stn_player_script-js"></script>
<script defer src="https://stats.wp.com/e-202406.js" id="jetpack-stats-js"></script>
<script id="jetpack-stats-js-after">
_stq = window._stq || [];
_stq.push([ "view", JSON.parse("{\"v\":\"ext\",\"blog\":\"208786665\",\"post\":\"10532429\",\"tz\":\"-5\",\"srv\":\"www.sun-sentinel.com\",\"hp\":\"vip\",\"j\":\"1:13.0\"}") ]);
_stq.push([ "clickTrackerInit", "208786665", "10532429" ]);
</script>
<script async src="https://cdn.p-n.io/pushly-sdk.min.js?domain_key=nZFVv1X9GYFO7N0hAvXMB7QXuFQP9RXSifvL&amp;ver=6.4.3" id="pushly-sdk-js"></script>
<script id="sharing-js-js-extra">
var sharing_js_options = {"lang":"en","counts":"","is_stats_active":"1"};
</script>
<script src="https://www.sun-sentinel.com/wp-content/mu-plugins/jetpack-13.0/_inc/build/sharedaddy/sharing.min.js?ver=13.0" id="sharing-js-js"></script>
<script id="sharing-js-js-after">
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-x' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-x' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomx', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
</script>

			</body>
            </html>
			                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               e.SUBTITLE_TRACK:l=n?F.SUBTITLE_TRACK_LOAD_TIMEOUT:F.SUBTITLE_LOAD_ERROR,c=!1;break}u&&this.resetInternalLoader(e.type);let d={type:J.NETWORK_ERROR,details:l,fatal:c,url:e.url,loader:u,context:e,error:o,networkDetails:t,stats:s};if(i){let h=(t==null?void 0:t.url)||e.url;d.response=ze({url:h,data:void 0},i)}this.hls.trigger(v.ERROR,d)}handlePlaylistLoaded(e,t,n,i,s,a){let o=this.hls,{type:l,level:c,id:u,groupId:d,deliveryDirectives:h}=i,f=ga(t,i),m=Gu(i),p=typeof i.level=="number"&&m===Z.MAIN?c:void 0;if(!e.fragments.length){let T=new Error("No Segments found in Playlist");o.trigger(v.ERROR,{type:J.NETWORK_ERROR,details:F.LEVEL_EMPTY_ERROR,fatal:!1,url:f,error:T,reason:T.message,response:t,context:i,level:p,parent:m,networkDetails:s,stats:n});return}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));let g=e.playlistParsingError;if(g){o.trigger(v.ERROR,{type:J.NETWORK_ERROR,details:F.LEVEL_PARSING_ERROR,fatal:!1,url:f,error:g,reason:g.message,response:t,context:i,level:p,parent:m,networkDetails:s,stats:n});return}switch(e.live&&a&&(a.getCacheAge&&(e.ageHeader=a.getCacheAge()||0),(!a.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),l){case pe.MANIFEST:case pe.LEVEL:o.trigger(v.LEVEL_LOADED,{details:e,level:p||0,id:u||0,stats:n,networkDetails:s,deliveryDirectives:h});break;case pe.AUDIO_TRACK:o.trigger(v.AUDIO_TRACK_LOADED,{details:e,id:u||0,groupId:d||"",stats:n,networkDetails:s,deliveryDirectives:h});break;case pe.SUBTITLE_TRACK:o.trigger(v.SUBTITLE_TRACK_LOADED,{details:e,id:u||0,groupId:d||"",stats:n,networkDetails:s,deliveryDirectives:h});break}}};function ju(r,e){let t;try{t=new Event("addtrack")}catch(n){t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=r,e.dispatchEvent(t)}function Hu(r,e){let t=r.mode;if(t==="disabled"&&(r.mode="hidden"),r.cues&&!r.cues.getCueById(e.id))try{if(r.addCue(e),!r.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(n){R.debug(`[texttrack-utils]: ${n}`);let i=new self.TextTrackCue(e.startTime,e.endTime,e.text);i.id=e.id,r.addCue(i)}t==="disabled"&&(r.mode=t)}function ei(r){let e=r.mode;if(e==="disabled"&&(r.mode="hidden"),r.cues)for(let t=r.cues.length;t--;)r.removeCue(r.cues[t]);e==="disabled"&&(r.mode=e)}function va(r,e,t,n){let i=r.mode;if(i==="disabled"&&(r.mode="hidden"),r.cues&&r.cues.length>0){let s=gv(r.cues,e,t);for(let a=0;a<s.length;a++)(!n||n(s[a]))&&r.removeCue(s[a])}i==="disabled"&&(r.mode=i)}function vv(r,e){if(e<r[0].startTime)return 0;let t=r.length-1;if(e>r[t].endTime)return-1;let n=0,i=t;for(;n<=i;){let s=Math.floor((i+n)/2);if(e<r[s].startTime)i=s-1;else if(e>r[s].startTime&&n<t)n=s+1;else return s}return r[n].startTime-e<e-r[i].startTime?n:i}function gv(r,e,t){let n=[],i=vv(r,e);if(i>-1)for(let s=i,a=r.length;s<a;s++){let o=r[s];if(o.startTime>=e&&o.endTime<=t)n.push(o);else if(o.startTime>t)return n}return n}var Pt={audioId3:"org.id3",dateRange:"com.apple.quicktime.HLS",emsg:"https://aomedia.org/emsg/ID3"},yv=.25;function ya(){if(typeof self!="undefined")return self.WebKitDataCue||self.VTTCue||self.TextTrackCue}var qr=(()=>{let r=ya();try{new r(0,Number.POSITIVE_INFINITY,"")}catch(e){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function ba(r,e){return r.getTime()/1e3-e}function bv(r){return Uint8Array.from(r.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}var Wu=class{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){let{hls:e}=this;e.on(v.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(v.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(v.MANIFEST_LOADING,this.onManifestLoading,this),e.on(v.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(v.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(v.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){let{hls:e}=this;e.off(v.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(v.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(v.MANIFEST_LOADING,this.onManifestLoading,this),e.off(v.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(v.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(v.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(e,t){this.media=t.media}onMediaDetaching(){!this.id3Track||(ei(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){let t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(!!this.media){for(let t=0;t<e.length;t++){let n=e[t];if(n.kind==="metadata"&&n.label==="id3")return ju(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;let{hls:{config:{enableEmsgMetadataCues:n,enableID3MetadataCues:i}}}=this;if(!n&&!i)return;let{samples:s}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));let a=ya();for(let o=0;o<s.length;o++){let l=s[o].type;if(l===Pt.emsg&&!n||!i)continue;let c=Tu(s[o].data);if(c){let u=s[o].pts,d=u+s[o].duration;d>qr&&(d=qr),d-u<=0&&(d=u+yv);for(let f=0;f<c.length;f++){let m=c[f];if(!bu(m)){this.updateId3CueEnds(u);let p=new a(u,d,"");p.value=m,l&&(p.type=l),this.id3Track.addCue(p)}}}}}updateId3CueEnds(e){var t;let n=(t=this.id3Track)==null?void 0:t.cues;if(n)for(let i=n.length;i--;){let s=n[i];s.startTime<e&&s.endTime===qr&&(s.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:n,type:i}){let{id3Track:s,hls:a}=this;if(!a)return;let{config:{enableEmsgMetadataCues:o,enableID3MetadataCues:l}}=a;if(s&&(o||l)){let c;i==="audio"?c=u=>u.type===Pt.audioId3&&l:i==="video"?c=u=>u.type===Pt.emsg&&o:c=u=>u.type===Pt.audioId3&&l||u.type===Pt.emsg&&o,va(s,t,n,c)}}onLevelUpdated(e,{details:t}){if(!this.media||!t.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;let{dateRangeCuesAppended:n,id3Track:i}=this,{dateRanges:s}=t,a=Object.keys(s);if(i){let u=Object.keys(n).filter(d=>!a.includes(d));for(let d=u.length;d--;){let h=u[d];Object.keys(n[h].cues).forEach(f=>{i.removeCue(n[h].cues[f])}),delete n[h]}}let o=t.fragments[t.fragments.length-1];if(a.length===0||!X(o==null?void 0:o.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));let l=o.programDateTime/1e3-o.start,c=ya();for(let u=0;u<a.length;u++){let d=a[u],h=s[d],f=n[d],m=(f==null?void 0:f.cues)||{},p=(f==null?void 0:f.durationKnown)||!1,g=ba(h.startDate,l),T=qr,_=h.endDate;if(_)T=ba(_,l),p=!0;else if(h.endOnNext&&!p){let b=a.reduce((E,C)=>{let w=s[C];return w.class===h.class&&w.id!==C&&w.startDate>h.startDate&&E.push(w),E},[]).sort((E,C)=>E.startDate.getTime()-C.startDate.getTime())[0];b&&(T=ba(b.startDate,l),p=!0)}let y=Object.keys(h.attr);for(let b=0;b<y.length;b++){let E=y[b];if(!Pg(E))continue;let C=m[E];if(C)p&&!f.durationKnown&&(C.endTime=T);else{let w=h.attr[E];C=new c(g,T,""),kg(E)&&(w=bv(w)),C.value={key:E,data:w},C.type=Pt.dateRange,C.id=d,this.id3Track.addCue(C),m[E]=C}}n[d]={cues:m,dateRange:h,durationKnown:p}}}},Ku=class{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=e,this.config=e.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){let{config:e,levelDetails:t}=this;return e.liveMaxLatencyDuration!==void 0?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){let{levelDetails:e}=this;if(e===null)return null;let{holdBack:t,partHoldBack:n,targetduration:i}=e,{liveSyncDuration:s,liveSyncDurationCount:a,lowLatencyMode:o}=this.config,l=this.hls.userConfig,c=o&&n||t;(l.liveSyncDuration||l.liveSyncDurationCount||c===0)&&(c=s!==void 0?s:a*i);let u=i,d=1;return c+Math.min(this.stallCount*d,u)}get liveSyncPosition(){let e=this.estimateLiveEdge(),t=this.targetLatency,n=this.levelDetails;if(e===null||t===null||n===null)return null;let i=n.edge,s=e-t-this.edgeStalled,a=i-n.totalduration,o=i-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(a,s),o)}get drift(){let{levelDetails:e}=this;return e===null?1:e.drift}get edgeStalled(){let{levelDetails:e}=this;if(e===null)return 0;let t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){let{media:e,levelDetails:t}=this;if(!e||!t)return 0;let n=e.buffered.length;return(n?e.buffered.end(n-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(v.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(v.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(v.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(v.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(v.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(v.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(v.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(v.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(v.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(v.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){this.levelDetails=t,t.advanced&&this.timeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(e,t){var n;t.details===F.BUFFER_STALLED_ERROR&&(this.stallCount++,(n=this.levelDetails)!=null&&n.live&&R.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){let{media:e,levelDetails:t}=this;if(!e||!t)return;this.currentTime=e.currentTime;let n=this.computeLatency();if(n===null)return;this._latency=n;let{lowLatencyMode:i,maxLiveSyncPlaybackRate:s}=this.config;if(!i||s===1)return;let a=this.targetLatency;if(a===null)return;let o=n-a,l=Math.min(this.maxLatency,a+t.targetduration),c=o<l;if(t.live&&c&&o>.05&&this.forwardBufferLength>1){let u=Math.min(2,Math.max(1,s)),d=Math.round(2/(1+Math.exp(-.75*o-this.edgeStalled))*20)/20;e.playbackRate=Math.min(u,Math.max(1,d))}else e.playbackRate!==1&&e.playbackRate!==0&&(e.playbackRate=1)}estimateLiveEdge(){let{levelDetails:e}=this;return e===null?null:e.edge+e.age}computeLatency(){let e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}},Ta=["NONE","TYPE-0","TYPE-1",null],Bi={No:"",Yes:"YES",v2:"v2"};function Tv(r,e){let{canSkipUntil:t,canSkipDateRanges:n,endSN:i}=r,s=e!==void 0?e-i:0;return t&&s<t?n?Bi.v2:Bi.Yes:Bi.No}var Ea=class{constructor(e,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=n}addDirectives(e){let t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}},ti=class{constructor(e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.unknownCodecs=e.unknownCodecs,this.codecSet=[e.videoCodec,e.audioCodec].filter(t=>t).join(",").replace(/\.[^.,]+/g,"")}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get attrs(){return this._attrs[this._urlId]}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get uri(){return this.url[this._urlId]||""}get urlId(){return this._urlId}set urlId(e){let t=e%this.url.length;this._urlId!==t&&(this.fragmentError=0,this.loadError=0,this.details=void 0,this._urlId=t)}get audioGroupId(){var e;return(e=this.audioGroupIds)==null?void 0:e[this.urlId]}get textGroupId(){var e;return(e=this.textGroupIds)==null?void 0:e[this.urlId]}addFallback(e){this.url.push(e.url),this._attrs.push(e.attrs)}};function Sa(r,e){let t=e.startPTS;if(X(t)){let n=0,i;e.sn>r.sn?(n=t-r.start,i=r):(n=r.start-t,i=e),i.duration!==n&&(i.duration=n)}else e.sn>r.sn?r.cc===e.cc&&r.minEndPTS?e.start=r.start+(r.minEndPTS-r.start):e.start=r.start+r.duration:e.start=Math.max(r.start-e.duration,0)}function qu(r,e,t,n,i,s){n-t<=0&&(R.warn("Fragment should have a positive duration",e),n=t+e.duration,s=i+e.duration);let o=t,l=n,c=e.startPTS,u=e.endPTS;if(X(c)){let g=Math.abs(c-t);X(e.deltaPTS)?e.deltaPTS=Math.max(g,e.deltaPTS):e.deltaPTS=g,o=Math.max(t,c),t=Math.min(t,c),i=Math.min(i,e.startDTS),l=Math.min(n,u),n=Math.max(n,u),s=Math.max(s,e.endDTS)}let d=t-e.start;e.start!==0&&(e.start=t),e.duration=n-e.start,e.startPTS=t,e.maxStartPTS=o,e.startDTS=i,e.endPTS=n,e.minEndPTS=l,e.endDTS=s;let h=e.sn;if(!r||h<r.startSN||h>r.endSN)return 0;let f,m=h-r.startSN,p=r.fragments;for(p[m]=e,f=m;f>0;f--)Sa(p[f],p[f-1]);for(f=m;f<p.length-1;f++)Sa(p[f],p[f+1]);return r.fragmentHint&&Sa(p[p.length-1],r.fragmentHint),r.PTSKnown=r.alignedSliding=!0,d}function Av(r,e){let t=null,n=r.fragments;for(let l=n.length-1;l>=0;l--){let c=n[l].initSegment;if(c){t=c;break}}r.fragmentHint&&delete r.fragmentHint.endPTS;let i=0,s;if(_v(r,e,(l,c)=>{l.relurl&&(i=l.cc-c.cc),X(l.startPTS)&&X(l.endPTS)&&(c.start=c.startPTS=l.startPTS,c.startDTS=l.startDTS,c.maxStartPTS=l.maxStartPTS,c.endPTS=l.endPTS,c.endDTS=l.endDTS,c.minEndPTS=l.minEndPTS,c.duration=l.endPTS-l.startPTS,c.duration&&(s=c),e.PTSKnown=e.alignedSliding=!0),c.elementaryStreams=l.elementaryStreams,c.loader=l.loader,c.stats=l.stats,c.urlId=l.urlId,l.initSegment&&(c.initSegment=l.initSegment,t=l.initSegment)}),t&&(e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments).forEach(c=>{var u;(!c.initSegment||c.initSegment.relurl===((u=t)==null?void 0:u.relurl))&&(c.initSegment=t)}),e.skippedSegments)if(e.deltaUpdateFailed=e.fragments.some(l=>!l),e.deltaUpdateFailed){R.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let l=e.skippedSegments;l--;)e.fragments.shift();e.startSN=e.fragments[0].sn,e.startCC=e.fragments[0].cc}else e.canSkipDateRanges&&(e.dateRanges=Ev(r.dateRanges,e.dateRanges,e.recentlyRemovedDateranges));let a=e.fragments;if(i){R.warn("discontinuity sliding from playlist, take drift into account");for(let l=0;l<a.length;l++)a[l].cc+=i}e.skippedSegments&&(e.startCC=e.fragments[0].cc),Sv(r.partList,e.partList,(l,c)=>{c.elementaryStreams=l.elementaryStreams,c.stats=l.stats}),s?qu(e,s,s.startPTS,s.endPTS,s.startDTS,s.endDTS):zu(r,e),a.length&&(e.totalduration=e.edge-a[0].start),e.driftStartTime=r.driftStartTime,e.driftStart=r.driftStart;let o=e.advancedDateTime;if(e.advanced&&o){let l=e.edge;e.driftStart||(e.driftStartTime=o,e.driftStart=l),e.driftEndTime=o,e.driftEnd=l}else e.driftEndTime=r.driftEndTime,e.driftEnd=r.driftEnd,e.advancedDateTime=r.advancedDateTime}function Ev(r,e,t){let n=Oe({},r);return t&&t.forEach(i=>{delete n[i]}),Object.keys(e).forEach(i=>{let s=new oa(e[i].attr,n[i]);s.isValid?n[i]=s:R.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(e[i].attr)}"`)}),n}function Sv(r,e,t){if(r&&e){let n=0;for(let i=0,s=r.length;i<=s;i++){let a=r[i],o=e[i+n];a&&o&&a.index===o.index&&a.fragment.sn===o.fragment.sn?t(a,o):n--}}}function _v(r,e,t){let n=e.skippedSegments,i=Math.max(r.startSN,e.startSN)-e.startSN,s=(r.fragmentHint?1:0)+(n?e.endSN:Math.min(r.endSN,e.endSN))-e.startSN,a=e.startSN-r.startSN,o=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,l=r.fragmentHint?r.fragments.concat(r.fragmentHint):r.fragments;for(let c=i;c<=s;c++){let u=l[a+c],d=o[c];n&&!d&&c<n&&(d=e.fragments[c]=u),u&&d&&t(u,d)}}function zu(r,e){let t=e.startSN+e.skippedSegments-r.startSN,n=r.fragments;t<0||t>=n.length||_a(e,n[t].start)}function _a(r,e){if(e){let t=r.fragments;for(let n=r.skippedSegments;n<t.length;n++)t[n].start+=e;r.fragmentHint&&(r.fragmentHint.start+=e)}}function wv(r,e=Infinity){let t=1e3*r.targetduration;if(r.updated){let n=r.fragments,i=4;if(n.length&&t*i>e){let s=n[n.length-1].duration*1e3;s<t&&(t=s)}}else t/=2;return Math.round(t)}function Lv(r,e,t){if(!(r!=null&&r.details))return null;let n=r.details,i=n.fragments[e-n.startSN];return i||(i=n.fragmentHint,i&&i.sn===e)?i:e<n.startSN&&t&&t.sn===e?t:null}function Xu(r,e,t){var n;return r!=null&&r.details?Yu((n=r.details)==null?void 0:n.partList,e,t):null}function Yu(r,e,t){if(r)for(let n=r.length;n--;){let i=r[n];if(i.index===t&&i.fragment.sn===e)return i}return null}function zr(r){switch(r.details){case F.FRAG_LOAD_TIMEOUT:case F.KEY_LOAD_TIMEOUT:case F.LEVEL_LOAD_TIMEOUT:case F.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function Qu(r,e){let t=zr(e);return r.default[`${t?"timeout":"error"}Retry`]}function Aa(r,e){let t=r.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*r.retryDelayMs,r.maxRetryDelayMs)}function Ju(r){return ze(ze({},r),{errorRetry:null,timeoutRetry:null})}function Yr(r,e,t,n){return!!r&&e<r.maxNumRetry&&(Iv(n)||!!t)}function Iv(r){return r===0&&navigator.onLine===!1||!!r&&(r<400||r>499)}var Zu={search:function(r,e){let t=0,n=r.length-1,i=null,s=null;for(;t<=n;){i=(t+n)/2|0,s=r[i];let a=e(s);if(a>0)t=i+1;else if(a<0)n=i-1;else return s}return null}};function Rv(r,e,t){if(e===null||!Array.isArray(r)||!r.length||!X(e))return null;let n=r[0].programDateTime;if(e<(n||0))return null;let i=r[r.length-1].endProgramDateTime;if(e>=(i||0))return null;t=t||0;for(let s=0;s<r.length;++s){let a=r[s];if(Cv(e,t,a))return a}return null}function Ui(r,e,t=0,n=0){let i=null;if(r?i=e[r.sn-e[0].sn+1]||null:t===0&&e[0].start===0&&(i=e[0]),i&&wa(t,n,i)===0)return i;let s=Zu.search(e,wa.bind(null,t,n));return s&&(s!==r||!i)?s:i}function wa(r=0,e=0,t){if(t.start<=r&&t.start+t.duration>r)return 0;let n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-n<=r?1:t.start-n>r&&t.start?-1:0}function Cv(r,e,t){let n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-n>r}function Pv(r,e){return Zu.search(r,t=>t.cc<e?1:t.cc>e?-1:0)}var kv=3e5,Qe={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},gt={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,SwitchToSDR:4},ed=class{constructor(e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=e,this.log=R.log.bind(R,"[info]:"),this.warn=R.warn.bind(R,"[warning]:"),this.error=R.error.bind(R,"[error]:"),this.registerListeners()}registerListeners(){let e=this.hls;e.on(v.ERROR,this.onError,this),e.on(v.MANIFEST_LOADING,this.onManifestLoading,this)}unregisterListeners(){let e=this.hls;!e||(e.off(v.ERROR,this.onError,this),e.off(v.ERROR,this.onErrorOut,this),e.off(v.MANIFEST_LOADING,this.onManifestLoading,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){this.playlistError=0}stopLoad(){}getVariantLevelIndex(e){return(e==null?void 0:e.type)===Z.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onError(e,t){var n;if(t.fatal)return;let i=this.hls,s=t.context;switch(t.details){case F.FRAG_LOAD_ERROR:case F.FRAG_LOAD_TIMEOUT:case F.KEY_LOAD_ERROR:case F.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case F.FRAG_GAP:case F.FRAG_PARSING_ERROR:case F.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=Qe.SendAlternateToPenaltyBox;return}case F.LEVEL_EMPTY_ERROR:case F.LEVEL_PARSING_ERROR:{var a,o;let l=t.parent===Z.MAIN?t.level:i.loadLevel;t.details===F.LEVEL_EMPTY_ERROR&&!!((a=t.context)!=null&&(o=a.levelDetails)!=null&&o.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,l):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,l))}return;case F.LEVEL_LOAD_ERROR:case F.LEVEL_LOAD_TIMEOUT:typeof(s==null?void 0:s.level)=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,s.level));return;case F.AUDIO_TRACK_LOAD_ERROR:case F.AUDIO_TRACK_LOAD_TIMEOUT:case F.SUBTITLE_LOAD_ERROR:case F.SUBTITLE_TRACK_LOAD_TIMEOUT:if(s){let l=i.levels[i.loadLevel];if(l&&(s.type===pe.AUDIO_TRACK&&s.groupId===l.audioGroupId||s.type===pe.SUBTITLE_TRACK&&s.groupId===l.textGroupId)){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,i.loadLevel),t.errorAction.action=Qe.SendAlternateToPenaltyBox,t.errorAction.flags=gt.MoveAllAlternatesMatchingHost;return}}return;case F.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{let l=i.levels[i.loadLevel],c=l==null?void 0:l.attrs["HDCP-LEVEL"];c&&(t.errorAction={action:Qe.SendAlternateToPenaltyBox,flags:gt.MoveAllAlternatesMatchingHDCP,hdcpLevel:c})}return;case F.BUFFER_ADD_CODEC_ERROR:case F.REMUX_ALLOC_ERROR:t.errorAction=this.getLevelSwitchAction(t,(n=t.level)!=null?n:i.loadLevel);return;case F.INTERNAL_EXCEPTION:case F.BUFFER_APPENDING_ERROR:case F.BUFFER_APPEND_ERROR:case F.BUFFER_FULL_ERROR:case F.LEVEL_SWITCH_ERROR:case F.BUFFER_STALLED_ERROR:case F.BUFFER_SEEK_OVER_HOLE:case F.BUFFER_NUDGE_ON_STALL:t.errorAction={action:Qe.DoNothing,flags:gt.None};return}if(t.type===J.KEY_SYSTEM_ERROR){let l=this.getVariantLevelIndex(t.frag);t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,l);return}}getPlaylistRetryOrSwitchAction(e,t){var n,i;let s=this.hls,a=Qu(s.config.playlistLoadPolicy,e),o=this.playlistError++,l=(n=e.response)==null?void 0:n.code;return Yr(a,o,zr(e),l)?{action:Qe.RetryRequest,flags:gt.None,retryConfig:a,retryCount:o}:(i=e.context)!=null&&i.deliveryDirectives?{action:Qe.DoNothing,flags:gt.None,retryConfig:a||{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},retryCount:o}:this.getLevelSwitchAction(e,t)}getFragRetryOrSwitchAction(e){let t=this.hls,n=this.getVariantLevelIndex(e.frag),i=t.levels[n],{fragLoadPolicy:s,keyLoadPolicy:a}=t.config,o=Qu(e.details.startsWith("key")?a:s,e),l=t.levels.reduce((d,h)=>d+h.fragmentError,0);if(i){var c;e.details!==F.FRAG_GAP&&i.fragmentError++;let d=(c=e.response)==null?void 0:c.code;if(Yr(o,l,zr(e),d))return{action:Qe.RetryRequest,flags:gt.None,retryConfig:o,retryCount:l}}let u=this.getLevelSwitchAction(e,n);return o&&(u.retryConfig=o,u.retryCount=l),u}getLevelSwitchAction(e,t){let n=this.hls;t==null&&(t=n.loadLevel);let i=this.hls.levels[t];if(i&&(i.loadError++,n.autoLevelEnabled)){var s,a;let o=-1,l=n.levels,c=(s=e.frag)==null?void 0:s.type,{type:u,groupId:d}=(a=e.context)!=null?a:{};for(let h=l.length;h--;){let f=(h+n.loadLevel)%l.length;if(f!==n.loadLevel&&l[f].loadError===0){let m=l[f];if(e.details===F.FRAG_GAP&&e.frag){let p=l[f].details;if(p){let g=Ui(e.frag,p.fragments,e.frag.start);if(g!=null&&g.gap)continue}}else{if(u===pe.AUDIO_TRACK&&d===m.audioGroupId||u===pe.SUBTITLE_TRACK&&d===m.textGroupId)continue;if(c===Z.AUDIO&&i.audioGroupId===m.audioGroupId||c===Z.SUBTITLE&&i.textGroupId===m.textGroupId)continue}o=f;break}}if(o>-1&&n.loadLevel!==o)return e.levelRetry=!0,{action:Qe.SendAlternateToPenaltyBox,flags:gt.None,nextAutoLevel:o}}return{action:Qe.SendAlternateToPenaltyBox,flags:gt.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var n;switch((n=t.errorAction)==null?void 0:n.action){case Qe.DoNothing:break;case Qe.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==F.FRAG_GAP&&(t.fatal=!0);break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){let t=this.hls,n=e.errorAction;if(!n)return;let{flags:i,hdcpLevel:s,nextAutoLevel:a}=n;switch(i){case gt.None:this.switchLevel(e,a);break;case gt.MoveAllAlternatesMatchingHost:n.resolved||(n.resolved=this.redundantFailover(e));break;case gt.MoveAllAlternatesMatchingHDCP:s&&(t.maxHdcpLevel=Ta[Ta.indexOf(s)-1],n.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}n.resolved||this.switchLevel(e,a)}switchLevel(e,t){t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}redundantFailover(e){let{hls:t,penalizedRenditions:n}=this,i=e.parent===Z.MAIN?e.level:t.loadLevel,s=t.levels[i],a=s.url.length,o=e.frag?e.frag.urlId:s.urlId;s.urlId===o&&(!e.frag||s.details)&&this.penalizeRendition(s,e);for(let l=1;l<a;l++){let c=(o+l)%a,u=n[c];if(!u||Dv(u,e,n[o]))return this.warn(`Switching to Redundant Stream ${c+1}/${a}: "${s.url[c]}" after ${e.details}`),this.playlistError=0,t.levels.forEach(d=>{d.urlId=c}),t.nextLoadLevel=i,!0}return!1}penalizeRendition(e,t){let{penalizedRenditions:n}=this,i=n[e.urlId]||{lastErrorPerfMs:0,errors:[],details:void 0};i.lastErrorPerfMs=performance.now(),i.errors.push(t),i.details=e.details,n[e.urlId]=i}};function Dv(r,e,t){if(performance.now()-r.lastErrorPerfMs>kv)return!0;let n=r.details;if(e.details===F.FRAG_GAP&&n&&e.frag){let i=e.frag.start,s=Ui(null,n.fragments,i);if(s&&!s.gap)return!0}if(t&&r.errors.length<t.errors.length){let i=r.errors[r.errors.length-1];if(n&&i.frag&&e.frag&&Math.abs(i.frag.start-e.frag.start)>n.targetduration*3)return!0}return!1}var Xr=class{constructor(e,t){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=R.log.bind(R,`${t}:`),this.warn=R.warn.bind(R,`${t}:`),this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){clearTimeout(this.timer),this.timer=-1}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t){let n=t==null?void 0:t.renditionReports;if(n){let i=-1;for(let s=0;s<n.length;s++){let a=n[s],o;try{o=new self.URL(a.URI,t.url).href}catch(l){R.warn(`Could not construct new URL for Rendition Report: ${l}`),o=a.URI||""}if(o===e){i=s;break}else o===e.substring(0,o.length)&&(i=s)}if(i!==-1){let s=n[i],a=parseInt(s["LAST-MSN"])||(t==null?void 0:t.lastPartSn),o=parseInt(s["LAST-PART"])||(t==null?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){let l=Math.min(t.age-t.partTarget,t.targetduration);o>=0&&l>t.partTarget&&(o+=1)}return new Ea(a,o>=0?o:void 0,Bi.No)}}}loadPlaylist(e){this.requestScheduled===-1&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}shouldReloadPlaylist(e){return this.timer===-1&&this.requestScheduled===-1&&this.shouldLoadPlaylist(e)}playlistLoaded(e,t,n){let{details:i,stats:s}=t,a=self.performance.now(),o=s.loading.first?Math.max(0,a-s.loading.first):0;if(i.advancedDateTime=Date.now()-o,i.live||n!=null&&n.live){if(i.reloaded(n),n&&this.log(`live playlist ${e} ${i.advanced?"REFRESHED "+i.lastPartSn+"-"+i.lastPartIndex:"MISSED"}`),n&&i.fragments.length>0&&Av(n,i),!this.canLoad||!i.live)return;let l,c,u;if(i.canBlockReload&&i.endSN&&i.advanced){let g=this.hls.config.lowLatencyMode,T=i.lastPartSn,_=i.endSN,y=i.lastPartIndex,b=y!==-1,E=T===_,C=g?0:y;b?(c=E?_+1:T,u=E?C:y+1):c=_+1;let w=i.age,O=w+i.ageHeader,S=Math.min(O-i.partTarget,i.targetduration*1.5);if(S>0){if(n&&S>n.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${n.tuneInGoal} to: ${S} with playlist age: ${i.age}`),S=0;else{let I=Math.floor(S/i.targetduration);c+=I,u!==void 0&&(u+=Math.round(S%i.targetduration/i.partTarget)),this.log(`CDN Tune-in age: ${i.ageHeader}s last advanced ${w.toFixed(2)}s goal: ${S} skip sn ${I} to part ${u}`)}i.tuneInGoal=S}if(l=this.getDeliveryDirectives(i,t.deliveryDirectives,c,u),g||!E){this.loadPlaylist(l);return}}else i.canBlockReload&&(l=this.getDeliveryDirectives(i,t.deliveryDirectives,c,u));let d=this.hls.mainForwardBufferInfo,h=d?d.end-d.len:0,f=(i.edge-h)*1e3,m=wv(i,f);i.updated&&a>this.requestScheduled+m&&(this.requestScheduled=s.loading.start),c!==void 0&&i.canBlockReload?this.requestScheduled=s.loading.first+m-(i.partTarget*1e3||1e3):this.requestScheduled===-1||this.requestScheduled+m<a?this.requestScheduled=a:this.requestScheduled-a<=0&&(this.requestScheduled+=m);let p=this.requestScheduled-a;p=Math.max(0,p),this.log(`reload live playlist ${e} in ${Math.round(p)} ms`),this.timer=self.setTimeout(()=>this.loadPlaylist(l),p)}else this.clearTimer()}getDeliveryDirectives(e,t,n,i){let s=Tv(e,n);return t!=null&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,i=t.part,s=Bi.No),new Ea(n,i,s)}checkRetry(e){let t=e.details,n=zr(e),i=e.errorAction,{action:s,retryCount:a=0,retryConfig:o}=i||{},l=s===Qe.RetryRequest&&!!i&&!!o;if(l){var c;if(this.requestScheduled=-1,n&&(c=e.context)!=null&&c.deliveryDirectives)this.warn(`Retrying playlist loading ${a+1}/${o.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{let u=Aa(o,a);this.timer=self.setTimeout(()=>this.loadPlaylist(),u),this.warn(`Retrying playlist loading ${a+1}/${o.maxNumRetry} after "${t}" in ${u}ms`)}e.levelRetry=!0,i.resolved=!0}return l}},La,td=class extends Xr{constructor(e,t){super(e,"[level-controller]");this._levels=[],this._firstLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){let{hls:e}=this;e.on(v.MANIFEST_LOADING,this.onManifestLoading,this),e.on(v.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(v.LEVEL_LOADED,this.onLevelLoaded,this),e.on(v.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(v.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(v.FRAG_LOADED,this.onFragLoaded,this),e.on(v.ERROR,this.onError,this)}_unregisterListeners(){let{hls:e}=this;e.off(v.MANIFEST_LOADING,this.onManifestLoading,this),e.off(v.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(v.LEVEL_LOADED,this.onLevelLoaded,this),e.off(v.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(v.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(v.FRAG_LOADED,this.onFragLoaded,this),e.off(v.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}startLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.startLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[]}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){let n=[],i={},s;t.levels.forEach(a=>{var o;let l=a.attrs;((o=a.audioCodec)==null?void 0:o.indexOf("mp4a.40.34"))!==-1&&(La||(La=/chrome|firefox/i.test(navigator.userAgent)),La&&(a.audioCodec=void 0));let{AUDIO:c,CODECS:u,"FRAME-RATE":d,"PATHWAY-ID":h,RESOLUTION:f,SUBTITLES:m}=l,g=`${`${h||"."}-`}${a.bitrate}-${f}-${d}-${u}`;s=i[g],s?s.addFallback(a):(s=new ti(a),i[g]=s,n.push(s)),Qr(s,"audio",c),Qr(s,"text",m)}),this.filterAndSortMediaOptions(n,t)}filterAndSortMediaOptions(e,t){let n=[],i=[],s=!1,a=!1,o=!1,l=e.filter(({audioCodec:f,videoCodec:m,width:p,height:g,unknownCodecs:T})=>(s||(s=!!(p&&g)),a||(a=!!m),o||(o=!!f),!(T!=null&&T.length)&&(!f||pa(f,"audio"))&&(!m||pa(m,"video"))));if((s||a)&&o&&(l=l.filter(({videoCodec:f,width:m,height:p})=>!!f||!!(m&&p))),l.length===0){Promise.resolve().then(()=>{if(this.hls){let f=new Error("no level with compatible codecs found in manifest");this.hls.trigger(v.ERROR,{type:J.MEDIA_ERROR,details:F.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:f,reason:f.message})}});return}t.audioTracks&&(n=t.audioTracks.filter(f=>!f.audioCodec||pa(f.audioCodec,"audio")),nd(n)),t.subtitles&&(i=t.subtitles,nd(i));let c=l.slice(0);l.sort((f,m)=>f.attrs["HDCP-LEVEL"]!==m.attrs["HDCP-LEVEL"]?(f.attrs["HDCP-LEVEL"]||"")>(m.attrs["HDCP-LEVEL"]||"")?1:-1:f.bitrate!==m.bitrate?f.bitrate-m.bitrate:f.attrs["FRAME-RATE"]!==m.attrs["FRAME-RATE"]?f.attrs.decimalFloatingPoint("FRAME-RATE")-m.attrs.decimalFloatingPoint("FRAME-RATE"):f.attrs.SCORE!==m.attrs.SCORE?f.attrs.decimalFloatingPoint("SCORE")-m.attrs.decimalFloatingPoint("SCORE"):s&&f.height!==m.height?f.height-m.height:0);let u=c[0];if(this.steering&&(l=this.steering.filterParsedLevels(l),l.length!==c.length)){for(let f=0;f<c.length;f++)if(c[f].pathwayId===l[0].pathwayId){u=c[f];break}}this._levels=l;for(let f=0;f<l.length;f++)if(l[f]===u){this._firstLevel=f,this.log(`manifest loaded, ${l.length} level(s) found, first bitrate: ${u.bitrate}`);break}let d=o&&!a,h={levels:l,audioTracks:n,subtitleTracks:i,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:o,video:a,altAudio:!d&&n.some(f=>!!f.url)};this.hls.trigger(v.MANIFEST_PARSED,h),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return this._levels.length===0?null:this._levels}get level(){return this.currentLevelIndex}set level(e){let t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){let u=new Error("invalid level idx"),d=e<0;if(this.hls.trigger(v.ERROR,{type:J.OTHER_ERROR,details:F.LEVEL_SWITCH_ERROR,level:e,fatal:d,error:u,reason:u.message}),d)return;e=Math.min(e,t.length-1)}let n=this.currentLevelIndex,i=this.currentLevel,s=i?i.attrs["PATHWAY-ID"]:void 0,a=t[e],o=a.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=a,n===e&&a.details&&i&&s===o)return;this.log(`Switching to level ${e}${o?" with Pathway "+o:""} from level ${n}${s?" with Pathway "+s:""}`);let l=Oe({},a,{level:e,maxBitrate:a.maxBitrate,attrs:a.attrs,uri:a.uri,urlId:a.urlId});delete l._attrs,delete l._urlId,this.hls.trigger(v.LEVEL_SWITCHING,l);let c=a.details;if(!c||c.live){let u=this.switchParams(a.uri,i==null?void 0:i.details);this.loadPlaylist(u)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){let e=this.hls.config.startLevel;return e!==void 0?e:this._firstLevel}else return this._startLevel}set startLevel(e){this._startLevel=e}onError(e,t){t.fatal||!t.context||t.context.type===pe.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragLoaded(e,{frag:t}){if(t!==void 0&&t.type===Z.MAIN){let n=this._levels[t.level];n!==void 0&&(n.loadError=0)}}onLevelLoaded(e,t){var n;let{level:i,details:s}=t,a=this._levels[i];if(!a){var o;this.warn(`Invalid level index ${i}`),(o=t.deliveryDirectives)!=null&&o.skip&&(s.deltaUpdateFailed=!0);return}i===this.currentLevelIndex?(a.fragmentError===0&&(a.loadError=0),this.playlistLoaded(i,t,a.details)):(n=t.deliveryDirectives)!=null&&n.skip&&(s.deltaUpdateFailed=!0)}onAudioTrackSwitched(e,t){let n=this.currentLevel;if(!n)return;let i=this.hls.audioTracks[t.id].groupId;if(n.audioGroupIds&&n.audioGroupId!==i){let s=-1;for(let a=0;a<n.audioGroupIds.length;a++)if(n.audioGroupIds[a]===i){s=a;break}s!==-1&&s!==n.urlId&&(n.urlId=s,this.canLoad&&this.startLoad())}}loadPlaylist(e){super.loadPlaylist();let t=this.currentLevelIndex,n=this.currentLevel;if(n&&this.shouldLoadPlaylist(n)){let i=n.urlId,s=n.uri;if(e)try{s=e.addDirectives(s)}catch(o){this.warn(`Could not construct new URL with HLS Delivery Directives: ${o}`)}let a=n.attrs["PATHWAY-ID"];this.log(`Loading level index ${t}${(e==null?void 0:e.msn)!==void 0?" at sn "+e.msn+" part "+e.part:""} with${a?" Pathway "+a:""} URI ${i+1}/${n.url.length} ${s}`),this.clearTimer(),this.hls.trigger(v.LEVEL_LOADING,{url:s,level:t,id:i,deliveryDirectives:e||null})}}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e,t){let n=(s,a)=>a!==t,i=this._levels.filter((s,a)=>a!==e?!0:s.url.length>1&&t!==void 0?(s.url=s.url.filter(n),s.audioGroupIds&&(s.audioGroupIds=s.audioGroupIds.filter(n)),s.textGroupIds&&(s.textGroupIds=s.textGroupIds.filter(n)),s.urlId=0,!0):(this.steering&&this.steering.removeLevel(s),!1));this.hls.trigger(v.LEVELS_UPDATED,{levels:i})}onLevelsUpdated(e,{levels:t}){t.forEach((n,i)=>{let{details:s}=n;s!=null&&s.fragments&&s.fragments.forEach(a=>{a.level=i})}),this._levels=t}};function Qr(r,e,t){!t||(e==="audio"?(r.audioGroupIds||(r.audioGroupIds=[]),r.audioGroupIds[r.url.length-1]=t):e==="text"&&(r.textGroupIds||(r.textGroupIds=[]),r.textGroupIds[r.url.length-1]=t))}function nd(r){let e={};r.forEach(t=>{let n=t.groupId||"";t.id=e[n]=e[n]||0,e[n]++})}var Ve={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"},id=class{constructor(e){this.mainFragEntity=null,this.activeParts=null,this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){let{hls:e}=this;e.on(v.BUFFER_APPENDED,this.onBufferAppended,this),e.on(v.FRAG_BUFFERED,this.onFragBuffered,this),e.on(v.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){let{hls:e}=this;e.off(v.BUFFER_APPENDED,this.onBufferAppended,this),e.off(v.FRAG_BUFFERED,this.onFragBuffered,this),e.off(v.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.endListFragments=this.timeRanges=this.mainFragEntity=this.activeParts=null}getAppendedFrag(e,t){if(t===Z.MAIN){let{mainFragEntity:n,activeParts:i}=this;if(n){if(n&&i)for(let s=i.length;s--;){let a=i[s],o=a?a.end:n.appendedPTS;if(a.start<=e&&o!==null&&e<=o)return s>9&&(this.activeParts=i.slice(s-9)),a}else if(n.body.start<=e&&n.appendedPTS!==null&&e<=n.appendedPTS)return n.body}}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){let{fragments:n}=this,i=Object.keys(n);for(let s=i.length;s--;){let a=n[i[s]];if((a==null?void 0:a.body.type)===t&&a.buffered){let o=a.body;if(o.start<=e&&e<=o.end)return o}}return null}detectEvictedFragments(e,t,n){this.timeRanges&&(this.timeRanges[e]=t),Object.keys(this.fragments).forEach(i=>{let s=this.fragments[i];if(!s)return;if(!s.buffered&&!s.loaded){s.body.type===n&&this.removeFragment(s.body);return}let a=s.range[e];!a||a.time.some(o=>{let l=!this.isTimeBuffered(o.startPTS,o.endPTS,t);return l&&this.removeFragment(s.body),l})})}detectPartialFragments(e){let t=this.timeRanges,{frag:n,part:i}=e;if(!t||n.sn==="initSegment")return;let s=yn(n),a=this.fragments[s];!a||(Object.keys(t).forEach(o=>{let l=n.elementaryStreams[o];if(!l)return;let c=t[o],u=i!==null||l.partial===!0;a.range[o]=this.getBufferedTimes(n,i,u,c)}),a.loaded=null,Object.keys(a.range).length?(a.buffered=!0,a.body.endList&&(this.endListFragments[a.body.type]=a)):this.removeFragment(a.body))}fragBuffered(e,t){let n=yn(e),i=this.fragments[n];!i&&t&&(i=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),i&&(i.loaded=null,i.buffered=!0)}getBufferedTimes(e,t,n,i){let s={time:[],partial:n},a=t?t.start:e.start,o=t?t.end:e.end,l=e.minEndPTS||o,c=e.maxStartPTS||a;for(let u=0;u<i.length;u++){let d=i.start(u)-this.bufferPadding,h=i.end(u)+this.bufferPadding;if(c>=d&&l<=h){s.time.push({startPTS:Math.max(a,i.start(u)),endPTS:Math.min(o,i.end(u))});break}else if(a<h&&o>d)s.partial=!0,s.time.push({startPTS:Math.max(a,i.start(u)),endPTS:Math.min(o,i.end(u))});else if(o<=d)break}return s}getPartialFragment(e){let t=null,n,i,s,a=0,{bufferPadding:o,fragments:l}=this;return Object.keys(l).forEach(c=>{let u=l[c];!u||Ia(u)&&(i=u.body.start-o,s=u.body.end+o,e>=i&&e<=s&&(n=Math.min(e-i,s-e),a<=n&&(t=u.body,a=n)))}),t}isEndListAppended(e){let t=this.endListFragments[e];return t!==void 0&&(t.buffered||Ia(t))}getState(e){let t=yn(e),n=this.fragments[t];return n?n.buffered?Ia(n)?Ve.PARTIAL:Ve.OK:Ve.APPENDING:Ve.NOT_LOADED}isTimeBuffered(e,t,n){let i,s;for(let a=0;a<n.length;a++){if(i=n.start(a)-this.bufferPadding,s=n.end(a)+this.bufferPadding,e>=i&&t<=s)return!0;if(t<=i)return!1}return!1}onFragLoaded(e,t){let{frag:n,part:i}=t;if(n.sn==="initSegment"||n.bitrateTest||i)return;let s=yn(n);this.fragments[s]={body:n,appendedPTS:null,loaded:t,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){let{frag:n,part:i,timeRanges:s}=t,a=this.mainFragEntity;if(n.type===Z.MAIN){let o=a?a.body:null;if(o!==n){a&&o&&o.sn!==n.sn&&(a.buffered=!0,this.fragments[yn(o)]=a);let l=yn(n);a=this.mainFragEntity=this.fragments[l]||{body:n,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)}}if(i){let l=this.activeParts;l||(this.activeParts=l=[]),l.push(i)}else this.activeParts=null}this.timeRanges=s,Object.keys(s).forEach(o=>{let l=s[o];if(this.detectEvictedFragments(o,l),!i&&a){let c=n.elementaryStreams[o];if(!c)return;for(let u=0;u<l.length;u++){let d=l.end(u);d<=c.endPTS&&d>c.startPTS?a.appendedPTS=Math.max(d,a.appendedPTS||0):a.appendedPTS=c.endPTS}}})}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){let t=yn(e);return!!this.fragments[t]}removeFragmentsInRange(e,t,n,i,s){i&&!this.hasGaps||Object.keys(this.fragments).forEach(a=>{let o=this.fragments[a];if(!o)return;let l=o.body;l.type!==n||i&&!l.gap||l.start<t&&l.end>e&&(o.buffered||s)&&this.removeFragment(l)})}removeFragment(e){let t=yn(e);e.stats.loaded=0,e.clearElementaryStreamInfo(),this.mainFragEntity===this.fragments[t]&&(this.mainFragEntity=null),delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.mainFragEntity=null,this.activeParts=null,this.hasGaps=!1}};function Ia(r){var e,t;return r.buffered&&(r.body.gap||((e=r.range.video)==null?void 0:e.partial)||((t=r.range.audio)==null?void 0:t.partial))}function yn(r){return`${r.type}_${r.level}_${r.urlId}_${r.sn}`}var rd=Math.pow(2,17),sd=class{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){let n=e.url;if(!n)return Promise.reject(new Ut({type:J.NETWORK_ERROR,details:F.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${n?"part list":"url"}`),networkDetails:null}));this.abort();let i=this.config,s=i.fLoader,a=i.loader;return new Promise((o,l)=>{if(this.loader&&this.loader.destroy(),e.gap){l(od(e));return}let c=this.loader=e.loader=s?new s(i):new a(i),u=ad(e),d=Ju(i.fragLoadPolicy.default),h={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?Infinity:rd};e.stats=c.stats,c.load(u,h,{onSuccess:(f,m,p,g)=>{this.resetLoader(e,c);let T=f.data;p.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(T.slice(0,16)),T=T.slice(16)),o({frag:e,part:null,payload:T,networkDetails:g})},onError:(f,m,p,g)=>{this.resetLoader(e,c),l(new Ut({type:J.NETWORK_ERROR,details:F.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:ze({url:n,data:void 0},f),error:new Error(`HTTP Error ${f.code} ${f.text}`),networkDetails:p,stats:g}))},onAbort:(f,m,p)=>{this.resetLoader(e,c),l(new Ut({type:J.NETWORK_ERROR,details:F.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:p,stats:f}))},onTimeout:(f,m,p)=>{this.resetLoader(e,c),l(new Ut({type:J.NETWORK_ERROR,details:F.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${h.timeout}ms`),networkDetails:p,stats:f}))},onProgress:(f,m,p,g)=>{t&&t({frag:e,part:null,payload:p,networkDetails:g})}})})}loadPart(e,t,n){this.abort();let i=this.config,s=i.fLoader,a=i.loader;return new Promise((o,l)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){l(od(e,t));return}let c=this.loader=e.loader=s?new s(i):new a(i),u=ad(e,t),d=Ju(i.fragLoadPolicy.default),h={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:rd};t.stats=c.stats,c.load(u,h,{onSuccess:(f,m,p,g)=>{this.resetLoader(e,c),this.updateStatsFromPart(e,t);let T={frag:e,part:t,payload:f.data,networkDetails:g};n(T),o(T)},onError:(f,m,p,g)=>{this.resetLoader(e,c),l(new Ut({type:J.NETWORK_ERROR,details:F.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:ze({url:u.url,data:void 0},f),error:new Error(`HTTP Error ${f.code} ${f.text}`),networkDetails:p,stats:g}))},onAbort:(f,m,p)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,c),l(new Ut({type:J.NETWORK_ERROR,details:F.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:p,stats:f}))},onTimeout:(f,m,p)=>{this.resetLoader(e,c),l(new Ut({type:J.NETWORK_ERROR,details:F.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${h.timeout}ms`),networkDetails:p,stats:f}))}})})}updateStatsFromPart(e,t){let n=e.stats,i=t.stats,s=i.total;if(n.loaded+=i.loaded,s){let l=Math.round(e.duration/t.duration),c=Math.min(Math.round(n.loaded/s),l),d=(l-c)*Math.round(n.loaded/c);n.total=n.loaded+d}else n.total=Math.max(n.loaded,n.total);let a=n.loading,o=i.loading;a.start?a.first+=o.first-o.start:(a.start=o.start,a.first=o.first),a.end=o.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}};function ad(r,e=null){let t=e||r,n={frag:r,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},i=t.byteRangeStartOffset,s=t.byteRangeEndOffset;if(X(i)&&X(s)){var a;let o=i,l=s;if(r.sn==="initSegment"&&((a=r.decryptdata)==null?void 0:a.method)==="AES-128"){let c=s-i;c%16&&(l=s+(16-c%16)),i!==0&&(n.resetIV=!0,o=i-16)}n.rangeStart=o,n.rangeEnd=l}return n}function od(r,e){let t=new Error(`GAP ${r.gap?"tag":"attribute"} found`),n={type:J.MEDIA_ERROR,details:F.FRAG_GAP,fatal:!1,frag:r,error:t,networkDetails:null};return e&&(n.part=e),(e||r).stats.aborted=!0,new Ut(n)}var Ut=class extends Error{constructor(e){super(e.error.message);this.data=void 0,this.data=e}},ld=class{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(){for(let e in this.keyUriToKeyInfo){let t=this.keyUriToKeyInfo[e].loader;t&&t.abort()}}detach(){for(let e in this.keyUriToKeyInfo){let t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(let e in this.keyUriToKeyInfo){let t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=F.KEY_LOAD_ERROR,n,i,s){return new Ut({type:J.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:s,error:n,networkDetails:i})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){let{sn:n,cc:i}=e;for(let s=0;s<t.length;s++){let a=t[s];if(i<=a.cc&&(n==="initSegment"||a.sn==="initSegment"||n<a.sn)){this.emeController.selectKeySystemFormat(a).then(o=>{a.setKeyFormat(o)});break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var n,i;t&&e.setKeyFormat(t);let s=e.decryptdata;if(!s){let c=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,F.KEY_LOAD_ERROR,c))}let a=s.uri;if(!a)return Promise.reject(this.createKeyLoadError(e,F.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${a}"`)));let o=this.keyUriToKeyInfo[a];if((n=o)!=null&&n.decryptdata.key)return s.key=o.decryptdata.key,Promise.resolve({frag:e,keyInfo:o});if((i=o)!=null&&i.keyLoadPromise){var l;switch((l=o.mediaKeySessionContext)==null?void 0:l.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return o.keyLoadPromise.then(c=>(s.key=c.keyInfo.decryptdata.key,{frag:e,keyInfo:o}))}}switch(o=this.keyUriToKeyInfo[a]={decryptdata:s,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},s.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return s.keyFormat==="identity"?this.loadKeyHTTP(o,e):this.loadKeyEME(o,e);case"AES-128":return this.loadKeyHTTP(o,e);default:return Promise.reject(this.createKeyLoadError(e,F.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${s.method}"`)))}}loadKeyEME(e,t){let n={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){let i=this.emeController.loadKey(n);if(i)return(e.keyLoadPromise=i.then(s=>(e.mediaKeySessionContext=s,n))).catch(s=>{throw e.keyLoadPromise=null,s})}return Promise.resolve(n)}loadKeyHTTP(e,t){let n=this.config,i=n.loader,s=new i(n);return t.keyLoader=e.loader=s,e.keyLoadPromise=new Promise((a,o)=>{let l={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},c=n.keyLoadPolicy.default,u={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:(h,f,m,p)=>{let{frag:g,keyInfo:T,url:_}=m;if(!g.decryptdata||T!==this.keyUriToKeyInfo[_])return o(this.createKeyLoadError(g,F.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),p));T.decryptdata.key=g.decryptdata.key=new Uint8Array(h.data),g.keyLoader=null,T.loader=null,a({frag:g,keyInfo:T})},onError:(h,f,m,p)=>{this.resetLoader(f),o(this.createKeyLoadError(t,F.KEY_LOAD_ERROR,new Error(`HTTP Error ${h.code} loading key ${h.text}`),m,ze({url:l.url,data:void 0},h)))},onTimeout:(h,f,m)=>{this.resetLoader(f),o(this.createKeyLoadError(t,F.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),m))},onAbort:(h,f,m)=>{this.resetLoader(f),o(this.createKeyLoadError(t,F.INTERNAL_ABORTED,new Error("key loading aborted"),m))}};s.load(l,u,d)})}resetLoader(e){let{frag:t,keyInfo:n,url:i}=e,s=n.loader;t.keyLoader===s&&(t.keyLoader=null,n.loader=null),delete this.keyUriToKeyInfo[i],s&&s.destroy()}},cd=class{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}},xv={length:0,start:()=>0,end:()=>0},_e=class{static isBuffered(e,t){try{if(e){let n=_e.getBuffered(e);for(let i=0;i<n.length;i++)if(t>=n.start(i)&&t<=n.end(i))return!0}}catch(n){}return!1}static bufferInfo(e,t,n){try{if(e){let i=_e.getBuffered(e),s=[],a;for(a=0;a<i.length;a++)s.push({start:i.start(a),end:i.end(a)});return this.bufferedInfo(s,t,n)}}catch(i){}return{len:0,start:t,end:t,nextStart:void 0}}static bufferedInfo(e,t,n){t=Math.max(0,t),e.sort(function(c,u){let d=c.start-u.start;return d||u.end-c.end});let i=[];if(n)for(let c=0;c<e.length;c++){let u=i.length;if(u){let d=i[u-1].end;e[c].start-d<n?e[c].end>d&&(i[u-1].end=e[c].end):i.push(e[c])}else i.push(e[c])}else i=e;let s=0,a,o=t,l=t;for(let c=0;c<i.length;c++){let u=i[c].start,d=i[c].end;if(t+n>=u&&t<d)o=u,l=d,s=l-t;else if(t+n<u){a=u;break}}return{len:s,start:o||0,end:l||0,nextStart:a}}static getBuffered(e){try{return e.buffered}catch(t){return R.log("failed to get media.buffered",t),xv}}},Jr=class{constructor(e,t,n,i=0,s=-1,a=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=Zr(),this.buffering={audio:Zr(),video:Zr(),audiovideo:Zr()},this.level=e,this.sn=t,this.id=n,this.size=i,this.part=s,this.partial=a}};function Zr(){return{start:0,executeStart:0,executeEnd:0,end:0}}function ud(r,e){let t=null;for(let n=0,i=r.length;n<i;n++){let s=r[n];if(s&&s.cc===e){t=s;break}}return t}function Ov(r,e,t){return!!(e.details&&(t.endCC>t.startCC||r&&r.cc<t.startCC))}function Mv(r,e,t=0){let n=r.fragments,i=e.fragments;if(!i.length||!n.length){R.log("No fragments to align");return}let s=ud(n,i[0].cc);if(!s||s&&!s.startPTS){R.log("No frag in previous level to align on");return}return s}function dd(r,e){if(r){let t=r.start+e;r.start=r.startPTS=t,r.endPTS=t+r.duration}}function Ca(r,e){let t=e.fragments;for(let n=0,i=t.length;n<i;n++)dd(t[n],r);e.fragmentHint&&dd(e.fragmentHint,r),e.alignedSliding=!0}function Bv(r,e,t){!e||(Fv(r,t,e),!t.alignedSliding&&e.details&&Nv(t,e.details),!t.alignedSliding&&e.details&&!t.skippedSegments&&zu(e.details,t))}function Fv(r,e,t){if(Ov(r,t,e)){let n=Mv(t.details,e);n&&X(n.start)&&(R.log(`Adjusting PTS using last level due to CC increase within current level ${e.url}`),Ca(n.start,e))}}function Nv(r,e){if(!e.fragments.length||!r.hasProgramDateTime||!e.hasProgramDateTime)return;let t=e.fragments[0].programDateTime,n=r.fragments[0].programDateTime,i=(n-t)/1e3+e.fragments[0].start;i&&X(i)&&(R.log(`Adjusting PTS using programDateTime delta ${n-t}ms, sliding:${i.toFixed(3)} ${r.url} `),Ca(i,r))}function hd(r,e){if(!r.hasProgramDateTime||!e.hasProgramDateTime)return;let t=r.fragments,n=e.fragments;if(!t.length||!n.length)return;let i=Math.round(n.length/2)-1,s=n[i],a=ud(t,s.cc)||t[Math.round(t.length/2)-1],o=s.programDateTime,l=a.programDateTime;if(o===null||l===null)return;let c=(l-o)/1e3-(a.start-s.start);Ca(c,r)}var fd=class{constructor(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}decrypt(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}},md=class{constructor(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}};function Uv(r){let e=r.byteLength,t=e&&new DataView(r.buffer).getUint8(e-1);return t?kn(r,0,e-t):r}var pd=class{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){let t=new DataView(e),n=new Uint32Array(4);for(let i=0;i<4;i++)n[i]=t.getUint32(i*4);return n}initTable(){let e=this.sBox,t=this.invSBox,n=this.subMix,i=n[0],s=n[1],a=n[2],o=n[3],l=this.invSubMix,c=l[0],u=l[1],d=l[2],h=l[3],f=new Uint32Array(256),m=0,p=0,g=0;for(g=0;g<256;g++)g<128?f[g]=g<<1:f[g]=g<<1^283;for(g=0;g<256;g++){let T=p^p<<1^p<<2^p<<3^p<<4;T=T>>>8^T&255^99,e[m]=T,t[T]=m;let _=f[m],y=f[_],b=f[y],E=f[T]*257^T*16843008;i[m]=E<<24|E>>>8,s[m]=E<<16|E>>>16,a[m]=E<<8|E>>>24,o[m]=E,E=b*16843009^y*65537^_*257^m*16843008,c[T]=E<<24|E>>>8,u[T]=E<<16|E>>>16,d[T]=E<<8|E>>>24,h[T]=E,m?(m=_^f[f[f[b^_]]],p^=f[f[p]]):m=p=1}}expandKey(e){let t=this.uint8ArrayToUint32Array_(e),n=!0,i=0;for(;i<t.length&&n;)n=t[i]===this.key[i],i++;if(n)return;this.key=t;let s=this.keySize=t.length;if(s!==4&&s!==6&&s!==8)throw new Error("Invalid aes key size="+s);let a=this.ksRows=(s+6+1)*4,o,l,c=this.keySchedule=new Uint32Array(a),u=this.invKeySchedule=new Uint32Array(a),d=this.sBox,h=this.rcon,f=this.invSubMix,m=f[0],p=f[1],g=f[2],T=f[3],_,y;for(o=0;o<a;o++){if(o<s){_=c[o]=t[o];continue}y=_,o%s==0?(y=y<<8|y>>>24,y=d[y>>>24]<<24|d[y>>>16&255]<<16|d[y>>>8&255]<<8|d[y&255],y^=h[o/s|0]<<24):s>6&&o%s==4&&(y=d[y>>>24]<<24|d[y>>>16&255]<<16|d[y>>>8&255]<<8|d[y&255]),c[o]=_=(c[o-s]^y)>>>0}for(l=0;l<a;l++)o=a-l,l&3?y=c[o]:y=c[o-4],l<4||o<=4?u[l]=y:u[l]=m[d[y>>>24]]^p[d[y>>>16&255]]^g[d[y>>>8&255]]^T[d[y&255]],u[l]=u[l]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,n){let i=this.keySize+6,s=this.invKeySchedule,a=this.invSBox,o=this.invSubMix,l=o[0],c=o[1],u=o[2],d=o[3],h=this.uint8ArrayToUint32Array_(n),f=h[0],m=h[1],p=h[2],g=h[3],T=new Int32Array(e),_=new Int32Array(T.length),y,b,E,C,w,O,S,I,N,B,A,M,G,q,Y=this.networkToHostOrderSwap;for(;t<T.length;){for(N=Y(T[t]),B=Y(T[t+1]),A=Y(T[t+2]),M=Y(T[t+3]),w=N^s[0],O=M^s[1],S=A^s[2],I=B^s[3],G=4,q=1;q<i;q++)y=l[w>>>24]^c[O>>16&255]^u[S>>8&255]^d[I&255]^s[G],b=l[O>>>24]^c[S>>16&255]^u[I>>8&255]^d[w&255]^s[G+1],E=l[S>>>24]^c[I>>16&255]^u[w>>8&255]^d[O&255]^s[G+2],C=l[I>>>24]^c[w>>16&255]^u[O>>8&255]^d[S&255]^s[G+3],w=y,O=b,S=E,I=C,G=G+4;y=a[w>>>24]<<24^a[O>>16&255]<<16^a[S>>8&255]<<8^a[I&255]^s[G],b=a[O>>>24]<<24^a[S>>16&255]<<16^a[I>>8&255]<<8^a[w&255]^s[G+1],E=a[S>>>24]<<24^a[I>>16&255]<<16^a[w>>8&255]<<8^a[O&255]^s[G+2],C=a[I>>>24]<<24^a[w>>16&255]<<16^a[O>>8&255]<<8^a[S&255]^s[G+3],_[t]=Y(y^f),_[t+1]=Y(C^m),_[t+2]=Y(E^p),_[t+3]=Y(b^g),f=N,m=B,p=A,g=M,t=t+4}return _.buffer}},$v=16,es=class{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{let n=self.crypto;n&&(this.subtle=n.subtle||n.webkitSubtle)}catch(n){}this.subtle===null&&(this.useSoftware=!0)}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){let{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;let n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?Uv(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,n){return this.useSoftware?new Promise((i,s)=>{this.softwareDecrypt(new Uint8Array(e),t,n);let a=this.flush();a?i(a.buffer):s(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,n)}softwareDecrypt(e,t,n){let{currentIV:i,currentResult:s,remainderData:a}=this;this.logOnce("JS AES decrypt"),a&&(e=Dn(a,e),this.remainderData=null);let o=this.getValidChunk(e);if(!o.length)return null;i&&(n=i);let l=this.softwareDecrypter;l||(l=this.softwareDecrypter=new pd),l.expandKey(t);let c=s;return this.currentResult=l.decrypt(o.buffer,0,n),this.currentIV=kn(o,-16).buffer,c||null}webCryptoDecrypt(e,t,n){let i=this.subtle;return(this.key!==t||!this.fastAesKey)&&(this.key=t,this.fastAesKey=new md(i,t)),this.fastAesKey.expandKey().then(s=>i?(this.logOnce("WebCrypto AES decrypt"),new fd(i,new Uint8Array(n)).decrypt(e.buffer,s)):Promise.reject(new Error("web crypto not initialized"))).catch(s=>(R.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${s.name}: ${s.message}`),this.onWebCryptoError(e,t,n)))}onWebCryptoError(e,t,n){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,n);let i=this.flush();if(i)return i.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(e){let t=e,n=e.length-e.length%$v;return n!==e.length&&(t=kn(e,0,n),this.remainderData=kn(e,n)),t}logOnce(e){!this.logEnabled||(R.log(`[decrypter]: ${e}`),this.logEnabled=!1)}},Gv={toString:function(r){let e="",t=r.length;for(let n=0;n<t;n++)e+=`[${r.start(n).toFixed(3)}-${r.end(n).toFixed(3)}]`;return e}},$={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},ts=class extends cd{constructor(e,t,n,i,s){super();this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=$.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=s,this.logPrefix=i,this.log=R.log.bind(R,`${i}:`),this.warn=R.warn.bind(R,`${i}:`),this.hls=e,this.fragmentLoader=new sd(e.config),this.keyLoader=n,this.fragmentTracker=t,this.config=e.config,this.decrypter=new es(e.config),e.on(v.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort();let e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=$.STOPPED}_streamEnded(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;let n=t.partList;if(n!=null&&n.length){let s=n[n.length-1];return _e.isBuffered(this.media,s.start+s.duration/2)}let i=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(i)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var e;return(e=this.levels[this.levelLastLoaded])==null?void 0:e.details}}onMediaAttached(e,t){let n=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),n.addEventListener("seeking",this.onvseeking),n.addEventListener("ended",this.onvended);let i=this.config;this.levels&&i.autoStartLoad&&this.state===$.STOPPED&&this.startLoad(i.startPosition)}onMediaDetaching(){let e=this.media;e!=null&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){let{config:e,fragCurrent:t,media:n,mediaBuffer:i,state:s}=this,a=n?n.currentTime:0,o=_e.bufferInfo(i||n,a,e.maxBufferHole);if(this.log(`media seeking to ${X(a)?a.toFixed(3):a}, state: ${s}`),this.state===$.ENDED)this.resetLoadingState();else if(t){let l=e.maxFragLookUpTolerance,c=t.start-l,u=t.start+t.duration+l;if(!o.len||u<o.start||c>o.end){let d=a>u;(a<c||d)&&(d&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests()),this.resetLoadingState())}}n&&(this.fragmentTracker.removeFragmentsInRange(a,Infinity,this.playlistType,!0),this.lastCurrentTime=a),!this.loadedmetadata&&!o.len&&(this.nextLoadPosition=this.startPosition=a),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.stopLoad(),super.onHandlerDestroying()}onHandlerDestroyed(){this.state=$.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,n){this._loadFragForPlayback(e,t,n)}_loadFragForPlayback(e,t,n){let i=s=>{if(this.fragContextChanged(e)){this.warn(`Fragment ${e.sn}${s.part?" p: "+s.part.index:""} of level ${e.level} was dropped during download.`),this.fragmentTracker.removeFragment(e);return}e.stats.chunkCount++,this._handleFragmentLoadProgress(s)};this._doFragLoad(e,t,n,i).then(s=>{if(!s)return;let a=this.state;if(this.fragContextChanged(e)){(a===$.FRAG_LOADING||!this.fragCurrent&&a===$.PARSING)&&(this.fragmentTracker.removeFragment(e),this.state=$.IDLE);return}"payload"in s&&(this.log(`Loaded fragment ${e.sn} of level ${e.level}`),this.hls.trigger(v.FRAG_LOADED,s)),this._handleFragmentLoadComplete(s)}).catch(s=>{this.state===$.STOPPED||this.state===$.ERROR||(this.warn(s),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;if(this.fragmentTracker.getState(e)===Ve.APPENDING){let i=e.type,s=this.getFwdBufferInfo(this.mediaBuffer,i),a=Math.max(e.duration,s?s.len:this.config.maxBufferLength);this.reduceMaxBufferLength(a)&&this.fragmentTracker.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0&&this.fragmentTracker.removeAllFragments()}flushMainBuffer(e,t,n=null){if(!(e-t))return;let i={startOffset:e,endOffset:t,type:n};this.hls.trigger(v.BUFFER_FLUSHING,i)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(n=>{if(!n||this.fragContextChanged(e)||!this.levels)throw new Error("init load aborted");return n}).then(n=>{let{hls:i}=this,{payload:s}=n,a=e.decryptdata;if(s&&s.byteLength>0&&a&&a.key&&a.iv&&a.method==="AES-128"){let o=self.performance.now();return this.decrypter.decrypt(new Uint8Array(s),a.key.buffer,a.iv.buffer).catch(l=>{throw i.trigger(v.ERROR,{type:J.MEDIA_ERROR,details:F.FRAG_DECRYPT_ERROR,fatal:!1,error:l,reason:l.message,frag:e}),l}).then(l=>{let c=self.performance.now();return i.trigger(v.FRAG_DECRYPTED,{frag:e,payload:l,stats:{tstart:o,tdecrypt:c}}),n.payload=l,n})}return n}).then(n=>{let{fragCurrent:i,hls:s,levels:a}=this;if(!a)throw new Error("init load aborted, missing levels");let o=e.stats;this.state=$.IDLE,t.fragmentError=0,e.data=new Uint8Array(n.payload),o.parsing.start=o.buffering.start=self.performance.now(),o.parsing.end=o.buffering.end=self.performance.now(),n.frag===i&&s.trigger(v.FRAG_BUFFERED,{stats:o,frag:i,part:null,id:e.type}),this.tick()}).catch(n=>{this.state===$.STOPPED||this.state===$.ERROR||(this.warn(n),this.resetFragmentLoading(e))})}fragContextChanged(e){let{fragCurrent:t}=this;return!e||!t||e.level!==t.level||e.sn!==t.sn||e.urlId!==t.urlId}fragBufferedComplete(e,t){var n,i,s,a;let o=this.mediaBuffer?this.mediaBuffer:this.media;this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.logPrefix==="[stream-controller]"?"level":"track"} ${e.level} (frag:[${((n=e.startPTS)!=null?n:NaN).toFixed(3)}-${((i=e.endPTS)!=null?i:NaN).toFixed(3)}] > buffer:${o?Gv.toString(_e.getBuffered(o)):"(detached)"})`),this.state=$.IDLE,!!o&&(!this.loadedmetadata&&e.type==Z.MAIN&&o.buffered.length&&((s=this.fragCurrent)==null?void 0:s.sn)===((a=this.fragPrevious)==null?void 0:a.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(e){let{transmuxer:t}=this;if(!t)return;let{frag:n,part:i,partsLoaded:s}=e,a=!s||s.length===0||s.some(l=>!l),o=new Jr(n.level,n.sn,n.stats.chunkCount+1,0,i?i.index:-1,!a);t.flush(o)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,n=null,i){var s;let a=t==null?void 0:t.details;if(!this.levels||!a)throw new Error(`frag load aborted, missing level${a?"":" detail"}s`);let o=null;if(e.encrypted&&!((s=e.decryptdata)!=null&&s.key)?(this.log(`Loading key for ${e.sn} of [${a.startSN}-${a.endSN}], ${this.logPrefix==="[stream-controller]"?"level":"track"} ${e.level}`),this.state=$.KEY_LOADING,this.fragCurrent=e,o=this.keyLoader.load(e).then(u=>{if(!this.fragContextChanged(u.frag))return this.hls.trigger(v.KEY_LOADED,u),this.state===$.KEY_LOADING&&(this.state=$.IDLE),u}),this.hls.trigger(v.KEY_LOADING,{frag:e}),this.fragCurrent===null&&(o=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):!e.encrypted&&a.encryptedFragments.length&&this.keyLoader.loadClear(e,a.encryptedFragments),n=Math.max(e.start,n||0),this.config.lowLatencyMode){let u=a.partList;if(u&&i){n>e.end&&a.fragmentHint&&(e=a.fragmentHint);let d=this.getNextPart(u,e,n);if(d>-1){let h=u[d];this.log(`Loading part sn: ${e.sn} p: ${h.index} cc: ${e.cc} of playlist [${a.startSN}-${a.endSN}] parts [0-${d}-${u.length-1}] ${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),this.nextLoadPosition=h.start+h.duration,this.state=$.FRAG_LOADING;let f;return o?f=o.then(m=>!m||this.fragContextChanged(m.frag)?null:this.doFragPartsLoad(e,h,t,i)).catch(m=>this.handleFragLoadError(m)):f=this.doFragPartsLoad(e,h,t,i).catch(m=>this.handleFragLoadError(m)),this.hls.trigger(v.FRAG_LOADING,{frag:e,part:h,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):f}else if(!e.url||this.loadedEndOfParts(u,n))return Promise.resolve(null)}}this.log(`Loading fragment ${e.sn} cc: ${e.cc} ${a?"of ["+a.startSN+"-"+a.endSN+"] ":""}${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),X(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=$.FRAG_LOADING;let l=this.config.progressive,c;return l&&o?c=o.then(u=>!u||this.fragContextChanged(u==null?void 0:u.frag)?null:this.fragmentLoader.load(e,i)).catch(u=>this.handleFragLoadError(u)):c=Promise.all([this.fragmentLoader.load(e,l?i:void 0),o]).then(([u])=>(!l&&u&&i&&i(u),u)).catch(u=>this.handleFragLoadError(u)),this.hls.trigger(v.FRAG_LOADING,{frag:e,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):c}doFragPartsLoad(e,t,n,i){return new Promise((s,a)=>{var o;let l=[],c=(o=n.details)==null?void 0:o.partList,u=d=>{this.fragmentLoader.loadPart(e,d,i).then(h=>{l[d.index]=h;let f=h.part;this.hls.trigger(v.FRAG_LOADED,h);let m=Xu(n,e.sn,d.index+1)||Yu(c,e.sn,d.index+1);if(m)u(m);else return s({frag:e,part:f,partsLoaded:l})}).catch(a)};u(t)})}handleFragLoadError(e){if("data"in e){let t=e.data;e.data&&t.details===F.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(v.ERROR,t)}else this.hls.trigger(v.ERROR,{type:J.OTHER_ERROR,details:F.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){let t=this.getCurrentContext(e);if(!t||this.state!==$.PARSING){!this.fragCurrent&&this.state!==$.STOPPED&&this.state!==$.ERROR&&(this.state=$.IDLE);return}let{frag:n,part:i,level:s}=t,a=self.performance.now();n.stats.parsing.end=a,i&&(i.stats.parsing.end=a),this.updateLevelTiming(n,i,s,e.partial)}getCurrentContext(e){let{levels:t,fragCurrent:n}=this,{level:i,sn:s,part:a}=e;if(!(t!=null&&t[i]))return this.warn(`Levels object was unset while buffering fragment ${s} of level ${i}. The current chunk will not be buffered.`),null;let o=t[i],l=a>-1?Xu(o,s,a):null,c=l?l.fragment:Lv(o,s,n);return c?(n&&n!==c&&(c.stats=n.stats),{frag:c,part:l,level:o}):null}bufferFragmentData(e,t,n,i){var s;if(!e||this.state!==$.PARSING)return;let{data1:a,data2:o}=e,l=a;if(a&&o&&(l=Dn(a,o)),!((s=l)!=null&&s.length))return;let c={type:e.type,frag:t,part:n,chunkMeta:i,parent:t.type,data:l};this.hls.trigger(v.BUFFER_APPENDING,c),e.dropped&&e.independent&&!n&&this.flushBufferGap(t)}flushBufferGap(e){let t=this.media;if(!t)return;if(!_e.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}let n=t.currentTime,i=_e.bufferInfo(t,n,0),s=e.duration,a=Math.min(this.config.maxFragLookUpTolerance*2,s*.25),o=Math.max(Math.min(e.start-a,i.end-a),n+a);e.start-o>a&&this.flushMainBuffer(o,e.start)}getFwdBufferInfo(e,t){let n=this.getLoadPosition();return X(n)?this.getFwdBufferInfoAtPos(e,n,t):null}getFwdBufferInfoAtPos(e,t,n){let{config:{maxBufferHole:i}}=this,s=_e.bufferInfo(e,t,i);if(s.len===0&&s.nextStart!==void 0){let a=this.fragmentTracker.getBufferedFrag(t,n);if(a&&s.nextStart<a.end)return _e.bufferInfo(e,t,Math.max(s.nextStart,i))}return s}getMaxBufferLength(e){let{config:t}=this,n;return e?n=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):n=t.maxBufferLength,Math.min(n,t.maxMaxBufferLength)}reduceMaxBufferLength(e){let t=this.config,n=e||t.maxBufferLength;return t.maxMaxBufferLength>=n?(t.maxMaxBufferLength/=2,this.warn(`Reduce max buffer length to ${t.maxMaxBufferLength}s`),!0):!1}getNextFragment(e,t){let n=t.fragments,i=n.length;if(!i)return null;let{config:s}=this,a=n[0].start,o;if(t.live){let l=s.initialLiveManifestSize;if(i<l)return this.warn(`Not enough fragments to start playback (have: ${i}, need: ${l})`),null;!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1&&(o=this.getInitialLiveFragment(t,n),this.startPosition=o?this.hls.liveSyncPosition||o.start:e)}else e<=a&&(o=n[0]);if(!o){let l=s.lowLatencyMode?t.partEnd:t.fragmentEnd;o=this.getFragmentAtPosition(e,l,t)}return this.mapToInitFragWhenRequired(o)}isLoopLoading(e,t){let n=this.fragmentTracker.getState(e);return(n===Ve.OK||n===Ve.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,n,i,s){let a=e.gap,o=this.getNextFragment(this.nextLoadPosition,t);if(o===null)return o;if(e=o,a&&e&&!e.gap&&n.nextStart){let l=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,i);if(l!==null&&n.len+l.len>=s)return this.log(`buffer full after gaps in "${i}" playlist starting at sn: ${e.sn}`),null}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!(e!=null&&e.initSegment.data)&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,n){let i=-1,s=!1,a=!0;for(let o=0,l=e.length;o<l;o++){let c=e[o];if(a=a&&!c.independent,i>-1&&n<c.start)break;let u=c.loaded;u?i=-1:(s||c.independent||a)&&c.fragment===t&&(i=o),s=u}return i}loadedEndOfParts(e,t){let n=e[e.length-1];return n&&t>n.start&&n.loaded}getInitialLiveFragment(e,t){let n=this.fragPrevious,i=null;if(n){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${n.programDateTime}`),i=Rv(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!i){let s=n.sn+1;if(s>=e.startSN&&s<=e.endSN){let a=t[s-e.startSN];n.cc===a.cc&&(i=a,this.log(`Live playlist, switching playlist, load frag with next SN: ${i.sn}`))}i||(i=Pv(t,n.cc),i&&this.log(`Live playlist, switching playlist, load frag with same CC: ${i.sn}`))}}else{let s=this.hls.liveSyncPosition;s!==null&&(i=this.getFragmentAtPosition(s,this.bitrateTest?e.fragmentEnd:e.edge,e))}return i}getFragmentAtPosition(e,t,n){let{config:i}=this,{fragPrevious:s}=this,{fragments:a,endSN:o}=n,{fragmentHint:l}=n,c=i.maxFragLookUpTolerance,u=!!(i.lowLatencyMode&&n.partList&&l);u&&l&&!this.bitrateTest&&(a=a.concat(l),o=l.sn);let d;if(e<t){let h=e>t-c?0:c;d=Ui(s,a,e,h)}else d=a[a.length-1];if(d){let h=d.sn-n.startSN,f=this.fragmentTracker.getState(d);if((f===Ve.OK||f===Ve.PARTIAL&&d.gap)&&(s=d),s&&d.sn===s.sn&&!u&&s&&d.level===s.level){let p=a[h+1];d.sn<o&&this.fragmentTracker.getState(p)!==Ve.OK?d=p:d=null}}return d}synchronizeToLiveEdge(e){let{config:t,media:n}=this;if(!n)return;let i=this.hls.liveSyncPosition,s=n.currentTime,a=e.fragments[0].start,o=e.edge,l=s>=a-t.maxFragLookUpTolerance&&s<=o;if(i!==null&&n.duration>i&&(s<i||!l)){let c=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!l&&n.readyState<4||s<o-c)&&(this.loadedmetadata||(this.nextLoadPosition=i),n.readyState&&(this.warn(`Playback: ${s.toFixed(3)} is located too far from the end of live sliding playlist: ${o}, reset currentTime to : ${i.toFixed(3)}`),n.currentTime=i))}}alignPlaylists(e,t){let{levels:n,levelLastLoaded:i,fragPrevious:s}=this,a=i!==null?n[i]:null,o=e.fragments.length;if(!o)return this.warn("No fragments in live playlist"),0;let l=e.fragments[0].start,c=!t,u=e.alignedSliding&&X(l);if(c||!u&&!l){Bv(s,a,e);let d=e.fragments[0].start;return this.log(`Live playlist sliding: ${d.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} prev-sn: ${s?s.sn:"na"} fragments: ${o}`),d}return l}waitForCdnTuneIn(e){let t=3;return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*t)}setStartPosition(e,t){let n=this.startPosition;if(n<t&&(n=-1),n===-1||this.lastCurrentTime===-1){let i=this.startTimeOffset!==null,s=i?this.startTimeOffset:e.startTimeOffset;s!==null&&X(s)?(n=t+s,s<0&&(n+=e.totalduration),n=Math.min(Math.max(t,n),t+e.totalduration),this.log(`Start time offset ${s} found in ${i?"multivariant":"media"} playlist, adjust startPosition to ${n}`),this.startPosition=n):e.live?n=this.hls.liveSyncPosition||t:this.startPosition=n=0,this.lastCurrentTime=n}this.nextLoadPosition=n}getLoadPosition(){let{media:e}=this,t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t}handleFragLoadAborted(e,t){this.transmuxer&&e.sn!=="initSegment"&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part"+t.index:""} of level ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==$.FRAG_LOADING_WAITING_RETRY)&&(this.state=$.IDLE)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){let u=this.getCurrentContext(t.chunkMeta);u&&(t.frag=u.frag)}let n=t.frag;if(!n||n.type!==e||!this.levels)return;if(this.fragContextChanged(n)){var i;this.warn(`Frag load error must match current frag to retry ${n.url} > ${(i=this.fragCurrent)==null?void 0:i.url}`);return}let s=t.details===F.FRAG_GAP;s&&this.fragmentTracker.fragBuffered(n,!0);let a=t.errorAction,{action:o,retryCount:l=0,retryConfig:c}=a||{};if(a&&o===Qe.RetryRequest&&c){this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition);let u=Aa(c,l);this.warn(`Fragment ${n.sn} of ${e} ${n.level} errored with ${t.details}, retrying loading ${l+1}/${c.maxNumRetry} in ${u}ms`),a.resolved=!0,this.retryDate=self.performance.now()+u,this.state=$.FRAG_LOADING_WAITING_RETRY}else c&&a?(this.resetFragmentErrors(e),l<c.maxNumRetry?s||(a.resolved=!0):R.warn(`${t.details} reached or exceeded max retry (${l})`)):this.state=$.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===$.PARSING||this.state===$.PARSED){let t=e.parent,n=this.getFwdBufferInfo(this.mediaBuffer,t),i=n&&n.len>.5;i&&this.reduceMaxBufferLength(n.len);let s=!i;return s&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${t} buffer`),e.frag&&(this.fragmentTracker.removeFragment(e.frag),this.nextLoadPosition=e.frag.start),this.resetLoadingState(),s}return!1}resetFragmentErrors(e){e===Z.AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==$.STOPPED&&(this.state=$.IDLE)}afterBufferFlushed(e,t,n){if(!e)return;let i=_e.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,i,n),this.state===$.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=$.IDLE}resetStartWhenNotLoaded(e){if(!this.loadedmetadata){this.startFragRequested=!1;let t=this.levels?this.levels[e].details:null;t!=null&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of level ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(e.level),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,Infinity,this.playlistType,!1,!0)}updateLevelTiming(e,t,n,i){var s;let a=n.details;if(!a){this.warn("level.details undefined");return}if(Object.keys(e.elementaryStreams).reduce((l,c)=>{let u=e.elementaryStreams[c];if(u){let d=u.endPTS-u.startPTS;if(d<=0)return this.warn(`Could not parse fragment ${e.sn} ${c} duration reliably (${d})`),l||!1;let h=i?0:qu(a,e,u.startPTS,u.endPTS,u.startDTS,u.endDTS);return this.hls.trigger(v.LEVEL_PTS_UPDATED,{details:a,level:n,drift:h,type:c,frag:e,start:u.startPTS,end:u.endPTS}),!0}return l},!1))n.fragmentError=0;else if(((s=this.transmuxer)==null?void 0:s.error)===null){let l=new Error(`Found no media in fragment ${e.sn} of level ${n.id} resetting transmuxer to fallback to playlist timing`);if(this.warn(l.message),this.hls.trigger(v.ERROR,{type:J.MEDIA_ERROR,details:F.FRAG_PARSING_ERROR,fatal:!1,error:l,frag:e,reason:`Found no media in msn ${e.sn} of level "${n.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=$.PARSED,this.hls.trigger(v.FRAG_PARSED,{frag:e,part:t})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.resetTransmuxer(),this.resetLoadingState())}set state(e){let t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}};function Ra(){if(typeof self!="undefined")return self.MediaSource||self.WebKitMediaSource}function gd(){return self.SourceBuffer||self.WebKitSourceBuffer}function Vv(){let r=Ra();if(!r)return!1;let e=gd(),t=r&&typeof r.isTypeSupported=="function"&&r.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),n=!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function";return!!t&&!!n}function jv(){var r;let e=gd();return typeof(e==null||(r=e.prototype)==null?void 0:r.changeType)=="function"}function Hv(){return typeof __HLS_WORKER_BUNDLE__=="function"}function Wv(){let r=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),e=self.URL.createObjectURL(r);return{worker:new self.Worker(e),objectURL:e}}function Kv(r){let e=new self.URL(r,self.location.href).href;return{worker:new self.Worker(e),scriptURL:e}}function $t(r="",e=9e4){return{type:r,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}var Pa=class{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,n,i){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,n){}demux(e,t){this.cachedData&&(e=Dn(this.cachedData,e),this.cachedData=null);let n=Hr(e,0),i=n?n.length:0,s,a=this._audioTrack,o=this._id3Track,l=n?Gg(n):void 0,c=e.length;for((this.basePTS===null||this.frameIndex===0&&X(l))&&(this.basePTS=qv(l,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),n&&n.length>0&&o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:Pt.audioId3,duration:Number.POSITIVE_INFINITY});i<c;){if(this.canParse(e,i)){let u=this.appendFrame(a,e,i);u?(this.frameIndex++,this.lastPTS=u.sample.pts,i+=u.length,s=i):i=c}else Ug(e,i)?(n=Hr(e,i),o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:Pt.audioId3,duration:Number.POSITIVE_INFINITY}),i+=n.length,s=i):i++;if(i===c&&s!==c){let u=kn(e,s);this.cachedData?this.cachedData=Dn(this.cachedData,u):this.cachedData=u}}return{audioTrack:a,videoTrack:$t(),id3Track:o,textTrack:$t()}}demuxSampleAes(e,t,n){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){let t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:$t(),id3Track:this._id3Track,textTrack:$t()}}destroy(){}},qv=(r,e,t)=>{if(X(r))return r*90;let n=t?t.baseTime*9e4/t.timescale:0;return e*9e4+n};function zv(r,e,t,n){let i,s,a,o,l=navigator.userAgent.toLowerCase(),c=n,u=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];i=((e[t+2]&192)>>>6)+1;let d=(e[t+2]&60)>>>2;if(d>u.length-1){r.trigger(v.ERROR,{type:J.MEDIA_ERROR,details:F.FRAG_PARSING_ERROR,fatal:!0,reason:`invalid ADTS sampling index:${d}`});return}return a=(e[t+2]&1)<<2,a|=(e[t+3]&192)>>>6,R.log(`manifest codec:${n}, ADTS type:${i}, samplingIndex:${d}`),/firefox/i.test(l)?d>=6?(i=5,o=new Array(4),s=d-3):(i=2,o=new Array(2),s=d):l.indexOf("android")!==-1?(i=2,o=new Array(2),s=d):(i=5,o=new Array(4),n&&(n.indexOf("mp4a.40.29")!==-1||n.indexOf("mp4a.40.5")!==-1)||!n&&d>=6?s=d-3:((n&&n.indexOf("mp4a.40.2")!==-1&&(d>=6&&a===1||/vivaldi/i.test(l))||!n&&a===1)&&(i=2,o=new Array(2)),s=d)),o[0]=i<<3,o[0]|=(d&14)>>1,o[1]|=(d&1)<<7,o[1]|=a<<3,i===5&&(o[1]|=(s&14)>>1,o[2]=(s&1)<<7,o[2]|=2<<2,o[3]=0),{config:o,samplerate:u[d],channelCount:a,codec:"mp4a.40."+i,manifestCodec:c}}function vd(r,e){return r[e]===255&&(r[e+1]&246)==240}function yd(r,e){return r[e+1]&1?7:9}function ka(r,e){return(r[e+3]&3)<<11|r[e+4]<<3|(r[e+5]&224)>>>5}function Yv(r,e){return e+5<r.length}function ns(r,e){return e+1<r.length&&vd(r,e)}function Xv(r,e){return Yv(r,e)&&vd(r,e)&&ka(r,e)<=r.length-e}function Qv(r,e){if(ns(r,e)){let t=yd(r,e);if(e+t>=r.length)return!1;let n=ka(r,e);if(n<=t)return!1;let i=e+n;return i===r.length||ns(r,i)}return!1}function bd(r,e,t,n,i){if(!r.samplerate){let s=zv(e,t,n,i);if(!s)return;r.config=s.config,r.samplerate=s.samplerate,r.channelCount=s.channelCount,r.codec=s.codec,r.manifestCodec=s.manifestCodec,R.log(`parsed codec:${r.codec}, rate:${s.samplerate}, channels:${s.channelCount}`)}}function Td(r){return 1024*9e4/r}function Jv(r,e){let t=yd(r,e);if(e+t<=r.length){let n=ka(r,e)-t;if(n>0)return{headerLength:t,frameLength:n}}}function Ed(r,e,t,n,i){let s=Td(r.samplerate),a=n+i*s,o=Jv(e,t),l;if(o){let{frameLength:d,headerLength:h}=o,f=h+d,m=Math.max(0,t+f-e.length);m?(l=new Uint8Array(f-h),l.set(e.subarray(t+h,e.length),0)):l=e.subarray(t+h,t+f);let p={unit:l,pts:a};return m||r.samples.push(p),{sample:p,length:f,missing:m}}let c=e.length-t;return l=new Uint8Array(c),l.set(e.subarray(t,e.length),0),{sample:{unit:l,pts:a},length:c,missing:-1}}var Sd=class extends Pa{constructor(e,t){super();this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;let n=(Hr(e,0)||[]).length;for(let i=e.length;n<i;n++)if(Qv(e,n))return R.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return Xv(e,t)}appendFrame(e,t,n){bd(e,this.observer,t,n,e.manifestCodec);let i=Ed(e,t,n,this.basePTS,this.frameIndex);if(i&&i.missing===0)return i}},Zv=/\/emsg[-/]ID3/i,_d=class{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,n,i){let s=this.videoTrack=$t("video",1),a=this.audioTrack=$t("audio",1),o=this.txtTrack=$t("text",1);if(this.id3Track=$t("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;let l=Au(e);if(l.video){let{id:c,timescale:u,codec:d}=l.video;s.id=c,s.timescale=o.timescale=u,s.codec=d}if(l.audio){let{id:c,timescale:u,codec:d}=l.audio;a.id=c,a.timescale=u,a.codec=d}o.id=Eu.text,s.sampleDuration=0,s.duration=a.duration=i}resetContiguity(){}static probe(e){return e=e.length>16384?e.subarray(0,16384):e,he(e,["moof"]).length>0}demux(e,t){this.timeOffset=t;let n=e,i=this.videoTrack,s=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=Dn(this.remainderData,e));let o=tv(n);this.remainderData=o.remainder,i.samples=o.valid||new Uint8Array}else i.samples=n;let a=this.extractID3Track(i,t);return s.samples=Iu(t,i),{videoTrack:i,audioTrack:this.audioTrack,id3Track:a,textTrack:this.txtTrack}}flush(){let e=this.timeOffset,t=this.videoTrack,n=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;let i=this.extractID3Track(t,this.timeOffset);return n.samples=Iu(e,t),{videoTrack:t,audioTrack:$t(),id3Track:i,textTrack:$t()}}extractID3Track(e,t){let n=this.id3Track;if(e.samples.length){let i=he(e.samples,["emsg"]);i&&i.forEach(s=>{let a=rv(s);if(Zv.test(a.schemeIdUri)){let o=X(a.presentationTime)?a.presentationTime/a.timeScale:t+a.presentationTimeDelta/a.timeScale,l=a.eventDuration===4294967295?Number.POSITIVE_INFINITY:a.eventDuration/a.timeScale;l<=.001&&(l=Number.POSITIVE_INFINITY);let c=a.payload;n.samples.push({data:c,len:c.byteLength,dts:o,pts:o,type:Pt.emsg,duration:l})}})}return n}demuxSampleAes(e,t,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}},is=null,ey=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],ty=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],ny=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],iy=[0,1,1,4];function wd(r,e,t,n,i){if(t+24>e.length)return;let s=Ad(e,t);if(s&&t+s.frameLength<=e.length){let a=s.samplesPerFrame*9e4/s.sampleRate,o=n+i*a,l={unit:e.subarray(t,t+s.frameLength),pts:o,dts:o};return r.config=[],r.channelCount=s.channelCount,r.samplerate=s.sampleRate,r.samples.push(l),{sample:l,length:s.frameLength,missing:0}}}function Ad(r,e){let t=r[e+1]>>3&3,n=r[e+1]>>1&3,i=r[e+2]>>4&15,s=r[e+2]>>2&3;if(t!==1&&i!==0&&i!==15&&s!==3){let a=r[e+2]>>1&1,o=r[e+3]>>6,l=t===3?3-n:n===3?3:4,c=ey[l*14+i-1]*1e3,d=ty[(t===3?0:t===2?1:2)*3+s],h=o===3?1:2,f=ny[t][n],m=iy[n],p=f*8*m,g=Math.floor(f*c/d+a)*m;if(is===null){let y=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);is=y?parseInt(y[1]):0}return!!is&&is<=87&&n===2&&c>=224e3&&o===0&&(r[e+3]=r[e+3]|128),{sampleRate:d,channelCount:h,frameLength:g,samplesPerFrame:p}}}function Da(r,e){return r[e]===255&&(r[e+1]&224)==224&&(r[e+1]&6)!=0}function Ld(r,e){return e+1<r.length&&Da(r,e)}function ry(r,e){let t=4;return Da(r,e)&&t<=r.length-e}function sy(r,e){if(e+1<r.length&&Da(r,e)){let t=4,n=Ad(r,e),i=t;n!=null&&n.frameLength&&(i=n.frameLength);let s=e+i;return s===r.length||Ld(r,s)}return!1}var xa=class{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){let e=this.data,t=this.bytesAvailable,n=e.byteLength-t,i=new Uint8Array(4),s=Math.min(4,t);if(s===0)throw new Error("no bytes available");i.set(e.subarray(n,n+s)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=s*8,this.bytesAvailable-=s}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e),n=this.word>>>32-t;if(e>32&&R.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if((this.word&2147483648>>>e)!=0)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){let e=this.skipLZ();return this.readBits(e+1)-1}readEG(){let e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(e){let t=8,n=8,i;for(let s=0;s<e;s++)n!==0&&(i=this.readEG(),n=(t+i+256)%256),t=n===0?t:n}readSPS(){let e=0,t=0,n=0,i=0,s,a,o,l=this.readUByte.bind(this),c=this.readBits.bind(this),u=this.readUEG.bind(this),d=this.readBoolean.bind(this),h=this.skipBits.bind(this),f=this.skipEG.bind(this),m=this.skipUEG.bind(this),p=this.skipScalingList.bind(this);l();let g=l();if(c(5),h(3),l(),m(),g===100||g===110||g===122||g===244||g===44||g===83||g===86||g===118||g===128){let C=u();if(C===3&&h(1),m(),m(),h(1),d())for(a=C!==3?8:12,o=0;o<a;o++)d()&&(o<6?p(16):p(64))}m();let T=u();if(T===0)u();else if(T===1)for(h(1),f(),f(),s=u(),o=0;o<s;o++)f();m(),h(1);let _=u(),y=u(),b=c(1);b===0&&h(1),h(1),d()&&(e=u(),t=u(),n=u(),i=u());let E=[1,1];if(d()&&d())switch(l()){case 1:E=[1,1];break;case 2:E=[12,11];break;case 3:E=[10,11];break;case 4:E=[16,11];break;case 5:E=[40,33];break;case 6:E=[24,11];break;case 7:E=[20,11];break;case 8:E=[32,11];break;case 9:E=[80,33];break;case 10:E=[18,11];break;case 11:E=[15,11];break;case 12:E=[64,33];break;case 13:E=[160,99];break;case 14:E=[4,3];break;case 15:E=[3,2];break;case 16:E=[2,1];break;case 255:{E=[l()<<8|l(),l()<<8|l()];break}}return{width:Math.ceil((_+1)*16-e*2-t*2),height:(2-b)*(y+1)*16-(b?2:4)*(n+i),pixelRatio:E}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}},Id=class{constructor(e,t,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new es(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(e,t,n){let i=e[t].unit;if(i.length<=16)return;let s=i.subarray(16,i.length-i.length%16),a=s.buffer.slice(s.byteOffset,s.byteOffset+s.length);this.decryptBuffer(a).then(o=>{let l=new Uint8Array(o);i.set(l,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,n)})}decryptAacSamples(e,t,n){for(;;t++){if(t>=e.length){n();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,n),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){let t=Math.floor((e.length-48)/160)*16+16,n=new Int8Array(t),i=0;for(let s=32;s<e.length-16;s+=160,i+=16)n.set(e.subarray(s,s+16),i);return n}getAvcDecryptedUnit(e,t){let n=new Uint8Array(t),i=0;for(let s=32;s<e.length-16;s+=160,i+=16)e.set(n.subarray(i,i+16),s);return e}decryptAvcSample(e,t,n,i,s){let a=Cu(s.data),o=this.getAvcEncryptedData(a);this.decryptBuffer(o.buffer).then(l=>{s.data=this.getAvcDecryptedUnit(a,l),this.decrypter.isSync()||this.decryptAvcSamples(e,t,n+1,i)})}decryptAvcSamples(e,t,n,i){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,n=0){if(t>=e.length){i();return}let s=e[t].units;for(;!(n>=s.length);n++){let a=s[n];if(!(a.data.length<=48||a.type!==1&&a.type!==5)&&(this.decryptAvcSample(e,t,n,i,a),!this.decrypter.isSync()))return}}}},Je=188,tn=class{constructor(e,t,n){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=e,this.config=t,this.typeSupported=n}static probe(e){let t=tn.syncOffset(e);return t>0&&R.warn(`MPEG2-TS detected but first sync word found @ offset ${t}`),t!==-1}static syncOffset(e){let t=e.length,n=Math.min(Je*5,e.length-Je)+1,i=0;for(;i<n;){let s=!1;for(let a=i;a<t&&e[a]===71;a+=Je)if(!s&&Oa(e,a)===0&&(s=!0),s&&a+Je>n)return i;i++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:Eu[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,n,i){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=tn.createTrack("video"),this._audioTrack=tn.createTrack("audio",i),this._id3Track=tn.createTrack("id3"),this._txtTrack=tn.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=n,this._duration=i}resetTimeStamp(){}resetContiguity(){let{_audioTrack:e,_avcTrack:t,_id3Track:n}=this;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.avcSample=null,this.remainderData=null}demux(e,t,n=!1,i=!1){n||(this.sampleAes=null);let s,a=this._avcTrack,o=this._audioTrack,l=this._id3Track,c=this._txtTrack,u=a.pid,d=a.pesData,h=o.pid,f=l.pid,m=o.pesData,p=l.pesData,g=null,T=this.pmtParsed,_=this._pmtId,y=e.length;if(this.remainderData&&(e=Dn(this.remainderData,e),y=e.length,this.remainderData=null),y<Je&&!i)return this.remainderData=e,{audioTrack:o,videoTrack:a,id3Track:l,textTrack:c};let b=Math.max(0,tn.syncOffset(e));y-=(y-b)%Je,y<e.byteLength&&!i&&(this.remainderData=new Uint8Array(e.buffer,y,e.buffer.byteLength-y));let E=0;for(let w=b;w<y;w+=Je)if(e[w]===71){let O=!!(e[w+1]&64),S=Oa(e,w),I=(e[w+3]&48)>>4,N;if(I>1){if(N=w+5+e[w+4],N===w+Je)continue}else N=w+4;switch(S){case u:O&&(d&&(s=ni(d))&&this.parseAVCPES(a,c,s,!1),d={data:[],size:0}),d&&(d.data.push(e.subarray(N,w+Je)),d.size+=w+Je-N);break;case h:if(O){if(m&&(s=ni(m)))switch(o.segmentCodec){case"aac":this.parseAACPES(o,s);break;case"mp3":this.parseMPEGPES(o,s);break}m={data:[],size:0}}m&&(m.data.push(e.subarray(N,w+Je)),m.size+=w+Je-N);break;case f:O&&(p&&(s=ni(p))&&this.parseID3PES(l,s),p={data:[],size:0}),p&&(p.data.push(e.subarray(N,w+Je)),p.size+=w+Je-N);break;case 0:O&&(N+=e[N]+1),_=this._pmtId=ay(e,N);break;case _:{O&&(N+=e[N]+1);let B=oy(e,N,this.typeSupported,n);u=B.avc,u>0&&(a.pid=u),h=B.audio,h>0&&(o.pid=h,o.segmentCodec=B.segmentCodec),f=B.id3,f>0&&(l.pid=f),g!==null&&!T&&(R.warn(`MPEG-TS PMT found at ${w} after unknown PID '${g}'. Backtracking to sync byte @${b} to parse all TS packets.`),g=null,w=b-188),T=this.pmtParsed=!0;break}case 17:case 8191:break;default:g=S;break}}else E++;if(E>0){let w=new Error(`Found ${E} TS packet/s that do not start with 0x47`);this.observer.emit(v.ERROR,v.ERROR,{type:J.MEDIA_ERROR,details:F.FRAG_PARSING_ERROR,fatal:!1,error:w,reason:w.message})}a.pesData=d,o.pesData=m,l.pesData=p;let C={audioTrack:o,videoTrack:a,id3Track:l,textTrack:c};return i&&this.extractRemainingSamples(C),C}flush(){let{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){let{audioTrack:t,videoTrack:n,id3Track:i,textTrack:s}=e,a=n.pesData,o=t.pesData,l=i.pesData,c;if(a&&(c=ni(a))?(this.parseAVCPES(n,s,c,!0),n.pesData=null):n.pesData=a,o&&(c=ni(o))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,c);break;case"mp3":this.parseMPEGPES(t,c);break}t.pesData=null}else o!=null&&o.size&&R.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=o;l&&(c=ni(l))?(this.parseID3PES(i,c),i.pesData=null):i.pesData=l}demuxSampleAes(e,t,n){let i=this.demux(e,n,!0,!this.config.progressive),s=this.sampleAes=new Id(this.observer,this.config,t);return this.decrypt(i,s)}decrypt(e,t){return new Promise(n=>{let{audioTrack:i,videoTrack:s}=e;i.samples&&i.segmentCodec==="aac"?t.decryptAacSamples(i.samples,0,()=>{s.samples?t.decryptAvcSamples(s.samples,0,0,()=>{n(e)}):n(e)}):s.samples&&t.decryptAvcSamples(s.samples,0,0,()=>{n(e)})})}destroy(){this._duration=0}parseAVCPES(e,t,n,i){let s=this.parseAVCNALu(e,n.data),a=this.avcSample,o,l=!1;n.data=null,a&&s.length&&!e.audFound&&(Ma(a,e),a=this.avcSample=rs(!1,n.pts,n.dts,"")),s.forEach(c=>{switch(c.type){case 1:{o=!0,a||(a=this.avcSample=rs(!0,n.pts,n.dts,"")),a.frame=!0;let u=c.data;if(l&&u.length>4){let d=new xa(u).readSliceType();(d===2||d===4||d===7||d===9)&&(a.key=!0)}break}case 5:o=!0,a||(a=this.avcSample=rs(!0,n.pts,n.dts,"")),a.key=!0,a.frame=!0;break;case 6:{o=!0,Lu(c.data,1,n.pts,t.samples);break}case 7:if(o=!0,l=!0,!e.sps){let u=c.data,h=new xa(u).readSPS();e.width=h.width,e.height=h.height,e.pixelRatio=h.pixelRatio,e.sps=[u],e.duration=this._duration;let f=u.subarray(1,4),m="avc1.";for(let p=0;p<3;p++){let g=f[p].toString(16);g.length<2&&(g="0"+g),m+=g}e.codec=m}break;case 8:o=!0,e.pps||(e.pps=[c.data]);break;case 9:o=!1,e.audFound=!0,a&&Ma(a,e),a=this.avcSample=rs(!1,n.pts,n.dts,"");break;case 12:o=!0;break;default:o=!1,a&&(a.debug+="unknown NAL "+c.type+" ");break}a&&o&&a.units.push(c)}),i&&a&&(Ma(a,e),this.avcSample=null)}getLastNalUnit(e){var t;let n=this.avcSample,i;if((!n||n.units.length===0)&&(n=e[e.length-1]),(t=n)!=null&&t.units){let s=n.units;i=s[s.length-1]}return i}parseAVCNALu(e,t){let n=t.byteLength,i=e.naluState||0,s=i,a=[],o=0,l,c,u,d=-1,h=0;for(i===-1&&(d=0,h=t[0]&31,i=0,o=1);o<n;){if(l=t[o++],!i){i=l?0:1;continue}if(i===1){i=l?0:2;continue}if(!l)i=3;else if(l===1){if(d>=0){let f={data:t.subarray(d,o-i-1),type:h};a.push(f)}else{let f=this.getLastNalUnit(e.samples);if(f&&(s&&o<=4-s&&f.state&&(f.data=f.data.subarray(0,f.data.byteLength-s)),c=o-i-1,c>0)){let m=new Uint8Array(f.data.byteLength+c);m.set(f.data,0),m.set(t.subarray(0,c),f.data.byteLength),f.data=m,f.state=0}}o<n?(u=t[o]&31,d=o,h=u,i=0):i=-1}else i=0}if(d>=0&&i>=0){let f={data:t.subarray(d,n),type:h,state:i};a.push(f)}if(a.length===0){let f=this.getLastNalUnit(e.samples);if(f){let m=new Uint8Array(f.data.byteLength+t.byteLength);m.set(f.data,0),m.set(t,f.data.byteLength),f.data=m}}return e.naluState=i,a}parseAACPES(e,t){let n=0,i=this.aacOverFlow,s=t.data;if(i){this.aacOverFlow=null;let d=i.missing,h=i.sample.unit.byteLength;if(d===-1){let f=new Uint8Array(h+s.byteLength);f.set(i.sample.unit,0),f.set(s,h),s=f}else{let f=h-d;i.sample.unit.set(s.subarray(0,d),f),e.samples.push(i.sample),n=i.missing}}let a,o;for(a=n,o=s.length;a<o-1&&!ns(s,a);a++);if(a!==n){let d,h=a<o-1;h?d=`AAC PES did not start with ADTS header,offset:${a}`:d="No ADTS header found in AAC PES";let f=new Error(d);if(R.warn(`parsing error: ${d}`),this.observer.emit(v.ERROR,v.ERROR,{type:J.MEDIA_ERROR,details:F.FRAG_PARSING_ERROR,fatal:!1,levelRetry:h,error:f,reason:d}),!h)return}bd(e,this.observer,s,a,this.audioCodec);let l;if(t.pts!==void 0)l=t.pts;else if(i){let d=Td(e.samplerate);l=i.sample.pts+d}else{R.warn("[tsdemuxer]: AAC PES unknown PTS");return}let c=0,u;for(;a<o;)if(u=Ed(e,s,a,l,c),a+=u.length,u.missing){this.aacOverFlow=u;break}else for(c++;a<o-1&&!ns(s,a);a++);}parseMPEGPES(e,t){let n=t.data,i=n.length,s=0,a=0,o=t.pts;if(o===void 0){R.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;a<i;)if(Ld(n,a)){let l=wd(e,n,a,o,s);if(l)a+=l.length,s++;else break}else a++}parseID3PES(e,t){if(t.pts===void 0){R.warn("[tsdemuxer]: ID3 PES unknown PTS");return}let n=Oe({},t,{type:this._avcTrack?Pt.emsg:Pt.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(n)}};function rs(r,e,t,n){return{key:r,frame:!1,pts:e,dts:t,units:[],debug:n,length:0}}function Oa(r,e){return((r[e+1]&31)<<8)+r[e+2]}function ay(r,e){return(r[e+10]&31)<<8|r[e+11]}function oy(r,e,t,n){let i={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"},s=(r[e+1]&15)<<8|r[e+2],a=e+3+s-4,o=(r[e+10]&15)<<8|r[e+11];for(e+=12+o;e<a;){let l=Oa(r,e);switch(r[e]){case 207:if(!n){R.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:i.audio===-1&&(i.audio=l);break;case 21:i.id3===-1&&(i.id3=l);break;case 219:if(!n){R.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:i.avc===-1&&(i.avc=l);break;case 3:case 4:t.mpeg!==!0&&t.mp3!==!0?R.log("MPEG audio found, not supported in this browser"):i.audio===-1&&(i.audio=l,i.segmentCodec="mp3");break;case 36:R.warn("Unsupported HEVC stream type found");break}e+=((r[e+3]&15)<<8|r[e+4])+5}return i}function ni(r){let e=0,t,n,i,s,a,o=r.data;if(!r||r.size===0)return null;for(;o[0].length<19&&o.length>1;){let c=new Uint8Array(o[0].length+o[1].length);c.set(o[0]),c.set(o[1],o[0].length),o[0]=c,o.splice(1,1)}if(t=o[0],(t[0]<<16)+(t[1]<<8)+t[2]===1){if(n=(t[4]<<8)+t[5],n&&n>r.size-6)return null;let c=t[7];c&192&&(s=(t[9]&14)*536870912+(t[10]&255)*4194304+(t[11]&254)*16384+(t[12]&255)*128+(t[13]&254)/2,c&64?(a=(t[14]&14)*536870912+(t[15]&255)*4194304+(t[16]&254)*16384+(t[17]&255)*128+(t[18]&254)/2,s-a>60*9e4&&(R.warn(`${Math.round((s-a)/9e4)}s delta between PTS and DTS, align them`),s=a)):a=s),i=t[8];let u=i+9;if(r.size<=u)return null;r.size-=u;let d=new Uint8Array(r.size);for(let h=0,f=o.length;h<f;h++){t=o[h];let m=t.byteLength;if(u)if(u>m){u-=m;continue}else t=t.subarray(u),m-=u,u=0;d.set(t,e),e+=m}return n&&(n-=i+3),{data:d,pts:s,dts:a,len:n}}return null}function Ma(r,e){if(r.units.length&&r.frame){if(r.pts===void 0){let t=e.samples,n=t.length;if(n){let i=t[n-1];r.pts=i.pts,r.dts=i.dts}else{e.dropped++;return}}e.samples.push(r)}r.debug.length&&R.log(r.pts+"/"+r.dts+":"+r.debug)}var Cd=class extends Pa{resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;let n=(Hr(e,0)||[]).length;for(let i=e.length;n<i;n++)if(sy(e,n))return R.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return ry(e,t)}appendFrame(e,t,n){if(this.basePTS!==null)return wd(e,t,n,this.basePTS,this.frameIndex)}},Fa=class{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}},bn=Math.pow(2,32)-1,D=class{static init(){D.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in D.types)D.types.hasOwnProperty(e)&&(D.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);let t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);D.HDLR_TYPES={video:t,audio:n};let i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),s=new Uint8Array([0,0,0,0,0,0,0,0]);D.STTS=D.STSC=D.STCO=s,D.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),D.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),D.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),D.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);let a=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);D.FTYP=D.box(D.types.ftyp,a,l,a,o),D.DINF=D.box(D.types.dinf,D.box(D.types.dref,i))}static box(e,...t){let n=8,i=t.length,s=i;for(;i--;)n+=t[i].byteLength;let a=new Uint8Array(n);for(a[0]=n>>24&255,a[1]=n>>16&255,a[2]=n>>8&255,a[3]=n&255,a.set(e,4),i=0,n=8;i<s;i++)a.set(t[i],n),n+=t[i].byteLength;return a}static hdlr(e){return D.box(D.types.hdlr,D.HDLR_TYPES[e])}static mdat(e){return D.box(D.types.mdat,e)}static mdhd(e,t){t*=e;let n=Math.floor(t/(bn+1)),i=Math.floor(t%(bn+1));return D.box(D.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,i>>24,i>>16&255,i>>8&255,i&255,85,196,0,0]))}static mdia(e){return D.box(D.types.mdia,D.mdhd(e.timescale,e.duration),D.hdlr(e.type),D.minf(e))}static mfhd(e){return D.box(D.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?D.box(D.types.minf,D.box(D.types.smhd,D.SMHD),D.DINF,D.stbl(e)):D.box(D.types.minf,D.box(D.types.vmhd,D.VMHD),D.DINF,D.stbl(e))}static moof(e,t,n){return D.box(D.types.moof,D.mfhd(e),D.traf(n,t))}static moov(e){let t=e.length,n=[];for(;t--;)n[t]=D.trak(e[t]);return D.box.apply(null,[D.types.moov,D.mvhd(e[0].timescale,e[0].duration)].concat(n).concat(D.mvex(e)))}static mvex(e){let t=e.length,n=[];for(;t--;)n[t]=D.trex(e[t]);return D.box.apply(null,[D.types.mvex,...n])}static mvhd(e,t){t*=e;let n=Math.floor(t/(bn+1)),i=Math.floor(t%(bn+1)),s=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,i>>24,i>>16&255,i>>8&255,i&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return D.box(D.types.mvhd,s)}static sdtp(e){let t=e.samples||[],n=new Uint8Array(4+t.length),i,s;for(i=0;i<t.length;i++)s=t[i].flags,n[i+4]=s.dependsOn<<4|s.isDependedOn<<2|s.hasRedundancy;return D.box(D.types.sdtp,n)}static stbl(e){return D.box(D.types.stbl,D.stsd(e),D.box(D.types.stts,D.STTS),D.box(D.types.stsc,D.STSC),D.box(D.types.stsz,D.STSZ),D.box(D.types.stco,D.STCO))}static avc1(e){let t=[],n=[],i,s,a;for(i=0;i<e.sps.length;i++)s=e.sps[i],a=s.byteLength,t.push(a>>>8&255),t.push(a&255),t=t.concat(Array.prototype.slice.call(s));for(i=0;i<e.pps.length;i++)s=e.pps[i],a=s.byteLength,n.push(a>>>8&255),n.push(a&255),n=n.concat(Array.prototype.slice.call(s));let o=D.box(D.types.avcC,new Uint8Array([1,t[3],t[4],t[5],252|3,224|e.sps.length].concat(t).concat([e.pps.length]).concat(n))),l=e.width,c=e.height,u=e.pixelRatio[0],d=e.pixelRatio[1];return D.box(D.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,l&255,c>>8&255,c&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,D.box(D.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),D.box(D.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,u&255,d>>24,d>>16&255,d>>8&255,d&255])))}static esds(e){let t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}static mp4a(e){let t=e.samplerate;return D.box(D.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,t&255,0,0]),D.box(D.types.esds,D.esds(e)))}static mp3(e){let t=e.samplerate;return D.box(D.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,t&255,0,0]))}static stsd(e){return e.type==="audio"?e.segmentCodec==="mp3"&&e.codec==="mp3"?D.box(D.types.stsd,D.STSD,D.mp3(e)):D.box(D.types.stsd,D.STSD,D.mp4a(e)):D.box(D.types.stsd,D.STSD,D.avc1(e))}static tkhd(e){let t=e.id,n=e.duration*e.timescale,i=e.width,s=e.height,a=Math.floor(n/(bn+1)),o=Math.floor(n%(bn+1));return D.box(D.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,a>>24,a>>16&255,a>>8&255,a&255,o>>24,o>>16&255,o>>8&255,o&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,i&255,0,0,s>>8&255,s&255,0,0]))}static traf(e,t){let n=D.sdtp(e),i=e.id,s=Math.floor(t/(bn+1)),a=Math.floor(t%(bn+1));return D.box(D.types.traf,D.box(D.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,i&255])),D.box(D.types.tfdt,new Uint8Array([1,0,0,0,s>>24,s>>16&255,s>>8&255,s&255,a>>24,a>>16&255,a>>8&255,a&255])),D.trun(e,n.length+16+20+8+16+8+8),n)}static trak(e){return e.duration=e.duration||4294967295,D.box(D.types.trak,D.tkhd(e),D.mdia(e))}static trex(e){let t=e.id;return D.box(D.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){let n=e.samples||[],i=n.length,s=12+16*i,a=new Uint8Array(s),o,l,c,u,d,h;for(t+=8+s,a.set([e.type==="video"?1:0,0,15,1,i>>>24&255,i>>>16&255,i>>>8&255,i&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),o=0;o<i;o++)l=n[o],c=l.duration,u=l.size,d=l.flags,h=l.cts,a.set([c>>>24&255,c>>>16&255,c>>>8&255,c&255,u>>>24&255,u>>>16&255,u>>>8&255,u&255,d.isLeading<<2|d.dependsOn,d.isDependedOn<<6|d.hasRedundancy<<4|d.paddingValue<<1|d.isNonSync,d.degradPrio&240<<8,d.degradPrio&15,h>>>24&255,h>>>16&255,h>>>8&255,h&255],12+16*o);return D.box(D.types.trun,a)}static initSegment(e){D.types||D.init();let t=D.moov(e),n=new Uint8Array(D.FTYP.byteLength+t.byteLength);return n.set(D.FTYP),n.set(t,D.FTYP.byteLength),n}};D.types=void 0;D.HDLR_TYPES=void 0;D.STTS=void 0;D.STSC=void 0;D.STCO=void 0;D.STSZ=void 0;D.VMHD=void 0;D.SMHD=void 0;D.STSD=void 0;D.FTYP=void 0;D.DINF=void 0;var Rd=9e4;function Na(r,e,t=1,n=!1){let i=r*e*t;return n?Math.round(i):i}function ly(r,e,t=1,n=!1){return Na(r,e,1/t,n)}function $i(r,e=!1){return Na(r,1e3,1/Rd,e)}function cy(r,e=1){return Na(r,Rd,1/e)}var uy=10*1e3,Pd=1024,dy=1152,ss=null,Ba=null,as=class{constructor(e,t,n,i=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=e,this.config=t,this.typeSupported=n,this.ISGenerated=!1,ss===null){let a=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);ss=a?parseInt(a[1]):0}if(Ba===null){let s=navigator.userAgent.match(/Safari\/(\d+)/i);Ba=s?parseInt(s[1]):0}}destroy(){}resetTimeStamp(e){R.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){R.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){R.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1}getVideoStartPts(e){let t=!1,n=e.reduce((i,s)=>{let a=s.pts-i;return a<-4294967296?(t=!0,vt(i,s.pts)):a>0?i:s.pts},e[0].pts);return t&&R.debug("PTS rollover detected"),n}remux(e,t,n,i,s,a,o,l){let c,u,d,h,f,m,p=s,g=s,T=e.pid>-1,_=t.pid>-1,y=t.samples.length,b=e.samples.length>0,E=o&&y>0||y>1;if((!T||b)&&(!_||E)||this.ISGenerated||o){this.ISGenerated||(d=this.generateIS(e,t,s,a));let w=this.isVideoContiguous,O=-1,S;if(E&&(O=hy(t.samples),!w&&this.config.forceKeyFrameOnDiscontinuity))if(m=!0,O>0){R.warn(`[mp4-remuxer]: Dropped ${O} out of ${y} video samples due to a missing keyframe`);let I=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(O),t.dropped+=O,g+=(t.samples[0].pts-I)/t.inputTimeScale,S=g}else O===-1&&(R.warn(`[mp4-remuxer]: No keyframe found out of ${y} video samples`),m=!1);if(this.ISGenerated){if(b&&E){let I=this.getVideoStartPts(t.samples),B=(vt(e.samples[0].pts,I)-I)/t.inputTimeScale;p+=Math.max(0,B),g+=Math.max(0,-B)}if(b){if(e.samplerate||(R.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),d=this.generateIS(e,t,s,a)),u=this.remuxAudio(e,p,this.isAudioContiguous,a,_||E||l===Z.AUDIO?g:void 0),E){let I=u?u.endPTS-u.startPTS:0;t.inputTimeScale||(R.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),d=this.generateIS(e,t,s,a)),c=this.remuxVideo(t,g,w,I)}}else E&&(c=this.remuxVideo(t,g,w,0));c&&(c.firstKeyFrame=O,c.independent=O!==-1,c.firstKeyFramePTS=S)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(f=kd(n,s,this._initPTS,this._initDTS)),i.samples.length&&(h=Dd(i,s,this._initPTS))),{audio:u,video:c,initSegment:d,independent:m,text:h,id3:f}}generateIS(e,t,n,i){let s=e.samples,a=t.samples,o=this.typeSupported,l={},c=this._initPTS,u=!c||i,d="audio/mp4",h,f,m;if(u&&(h=f=Infinity),e.config&&s.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":o.mpeg?(d="audio/mpeg",e.codec=""):o.mp3&&(e.codec="mp3");break}l.audio={id:"audio",container:d,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&o.mpeg?new Uint8Array(0):D.initSegment([e]),metadata:{channelCount:e.channelCount}},u&&(m=e.inputTimeScale,!c||m!==c.timescale?h=f=s[0].pts-Math.round(m*n):u=!1)}if(t.sps&&t.pps&&a.length&&(t.timescale=t.inputTimeScale,l.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:D.initSegment([t]),metadata:{width:t.width,height:t.height}},u))if(m=t.inputTimeScale,!c||m!==c.timescale){let p=this.getVideoStartPts(a),g=Math.round(m*n);f=Math.min(f,vt(a[0].dts,p)-g),h=Math.min(h,p-g)}else u=!1;if(Object.keys(l).length)return this.ISGenerated=!0,u?(this._initPTS={baseTime:h,timescale:m},this._initDTS={baseTime:f,timescale:m}):h=m=void 0,{tracks:l,initPTS:h,timescale:m}}remuxVideo(e,t,n,i){let s=e.inputTimeScale,a=e.samples,o=[],l=a.length,c=this._initPTS,u=this.nextAvcDts,d=8,h=this.videoSampleDuration,f,m,p=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,T=!1;if(!n||u===null){let W=t*s,K=a[0].pts-vt(a[0].dts,a[0].pts);u=W-K}let _=c.baseTime*s/c.timescale;for(let W=0;W<l;W++){let K=a[W];K.pts=vt(K.pts-_,u),K.dts=vt(K.dts-_,u),K.dts<a[W>0?W-1:W].dts&&(T=!0)}T&&a.sort(function(W,K){let ue=W.dts-K.dts,fe=W.pts-K.pts;return ue||fe}),f=a[0].dts,m=a[a.length-1].dts;let y=m-f,b=y?Math.round(y/(l-1)):h||e.inputTimeScale/30;if(n){let W=f-u,K=W>b,ue=W<-1;if((K||ue)&&(K?R.warn(`AVC: ${$i(W,!0)} ms (${W}dts) hole between fragments detected, filling it`):R.warn(`AVC: ${$i(-W,!0)} ms (${W}dts) overlapping between fragments detected`),!ue||u>a[0].pts)){f=u;let fe=a[0].pts-W;a[0].dts=f,a[0].pts=fe,R.log(`Video: First PTS/DTS adjusted: ${$i(fe,!0)}/${$i(f,!0)}, delta: ${$i(W,!0)} ms`)}}f=Math.max(0,f);let E=0,C=0;for(let W=0;W<l;W++){let K=a[W],ue=K.units,fe=ue.length,de=0;for(let Se=0;Se<fe;Se++)de+=ue[Se].data.length;C+=de,E+=fe,K.length=de,K.dts=Math.max(K.dts,f),p=Math.min(K.pts,p),g=Math.max(K.pts,g)}m=a[l-1].dts;let w=C+4*E+8,O;try{O=new Uint8Array(w)}catch(W){this.observer.emit(v.ERROR,v.ERROR,{type:J.MUX_ERROR,details:F.REMUX_ALLOC_ERROR,fatal:!1,error:W,bytes:w,reason:`fail allocating video mdat ${w}`});return}let S=new DataView(O.buffer);S.setUint32(0,w),O.set(D.types.mdat,4);let I=!1,N=Number.POSITIVE_INFINITY,B=Number.POSITIVE_INFINITY,A=Number.NEGATIVE_INFINITY,M=Number.NEGATIVE_INFINITY;for(let W=0;W<l;W++){let K=a[W],ue=K.units,fe=0;for(let De=0,Me=ue.length;De<Me;De++){let je=ue[De],at=je.data,ui=je.data.byteLength;S.setUint32(d,ui),d+=4,O.set(at,d),d+=ui,fe+=4+ui}let de;if(W<l-1)h=a[W+1].dts-K.dts,de=a[W+1].pts-K.pts;else{let De=this.config,Me=W>0?K.dts-a[W-1].dts:b;if(de=W>0?K.pts-a[W-1].pts:b,De.stretchShortVideoTrack&&this.nextAudioPts!==null){let je=Math.floor(De.maxBufferHole*s),at=(i?p+i*s:this.nextAudioPts)-K.pts;at>je?(h=at-Me,h<0?h=Me:I=!0,R.log(`[mp4-remuxer]: It is approximately ${at/90} ms to the next segment; using duration ${h/90} ms for the last video frame.`)):h=Me}else h=Me}let Se=Math.round(K.pts-K.dts);N=Math.min(N,h),A=Math.max(A,h),B=Math.min(B,de),M=Math.max(M,de),o.push(new Ua(K.key,h,fe,Se))}if(o.length){if(ss){if(ss<70){let W=o[0].flags;W.dependsOn=2,W.isNonSync=0}}else if(Ba&&M-B<A-N&&b/A<.025&&o[0].cts===0){R.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let W=f;for(let K=0,ue=o.length;K<ue;K++){let fe=W+o[K].duration,de=W+o[K].cts;if(K<ue-1){let Se=fe+o[K+1].cts;o[K].duration=Se-de}else o[K].duration=K?o[K-1].duration:b;o[K].cts=0,W=fe}}}h=I||!h?b:h,this.nextAvcDts=u=m+h,this.videoSampleDuration=h,this.isVideoContiguous=!0;let G=D.moof(e.sequenceNumber++,f,Oe({},e,{samples:o})),q="video",Y={data1:G,data2:O,startPTS:p/s,endPTS:(g+h)/s,startDTS:f/s,endDTS:u/s,type:q,hasAudio:!1,hasVideo:!0,nb:o.length,dropped:e.dropped};return e.samples=[],e.dropped=0,Y}remuxAudio(e,t,n,i,s){let a=e.inputTimeScale,o=e.samplerate?e.samplerate:a,l=a/o,c=e.segmentCodec==="aac"?Pd:dy,u=c*l,d=this._initPTS,h=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,f=[],m=s!==void 0,p=e.samples,g=h?0:8,T=this.nextAudioPts||-1,_=t*a,y=d.baseTime*a/d.timescale;if(this.isAudioContiguous=n=n||p.length&&T>0&&(i&&Math.abs(_-T)<9e3||Math.abs(vt(p[0].pts-y,_)-T)<20*u),p.forEach(function(q){q.pts=vt(q.pts-y,_)}),!n||T<0){if(p=p.filter(q=>q.pts>=0),!p.length)return;s===0?T=0:i&&!m?T=Math.max(0,_):T=p[0].pts}if(e.segmentCodec==="aac"){let q=this.config.maxAudioFramesDrift;for(let Y=0,W=T;Y<p.length;Y++){let K=p[Y],ue=K.pts,fe=ue-W,de=Math.abs(1e3*fe/a);if(fe<=-q*u&&m)Y===0&&(R.warn(`Audio frame @ ${(ue/a).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*fe/a)} ms.`),this.nextAudioPts=T=W=ue);else if(fe>=q*u&&de<uy&&m){let Se=Math.round(fe/u);W=ue-Se*u,W<0&&(Se--,W+=u),Y===0&&(this.nextAudioPts=T=W),R.warn(`[mp4-remuxer]: Injecting ${Se} audio frame @ ${(W/a).toFixed(3)}s due to ${Math.round(1e3*fe/a)} ms gap.`);for(let De=0;De<Se;De++){let Me=Math.max(W,0),je=Fa.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);je||(R.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),je=K.unit.subarray()),p.splice(Y,0,{unit:je,pts:Me}),W+=u,Y++}}K.pts=W,W+=u}}let b=null,E=null,C,w=0,O=p.length;for(;O--;)w+=p[O].unit.byteLength;for(let q=0,Y=p.length;q<Y;q++){let W=p[q],K=W.unit,ue=W.pts;if(E!==null){let de=f[q-1];de.duration=Math.round((ue-E)/l)}else if(n&&e.segmentCodec==="aac"&&(ue=T),b=ue,w>0){w+=g;try{C=new Uint8Array(w)}catch(de){this.observer.emit(v.ERROR,v.ERROR,{type:J.MUX_ERROR,details:F.REMUX_ALLOC_ERROR,fatal:!1,error:de,bytes:w,reason:`fail allocating audio mdat ${w}`});return}h||(new DataView(C.buffer).setUint32(0,w),C.set(D.types.mdat,4))}else return;C.set(K,g);let fe=K.byteLength;g+=fe,f.push(new Ua(!0,c,fe,0)),E=ue}let S=f.length;if(!S)return;let I=f[f.length-1];this.nextAudioPts=T=E+l*I.duration;let N=h?new Uint8Array(0):D.moof(e.sequenceNumber++,b/l,Oe({},e,{samples:f}));e.samples=[];let B=b/a,A=T/a,G={data1:N,data2:C,startPTS:B,endPTS:A,startDTS:B,endDTS:A,type:"audio",hasAudio:!0,hasVideo:!1,nb:S};return this.isAudioContiguous=!0,G}remuxEmptyAudio(e,t,n,i){let s=e.inputTimeScale,a=e.samplerate?e.samplerate:s,o=s/a,l=this.nextAudioPts,c=this._initDTS,u=c.baseTime*9e4/c.timescale,d=(l!==null?l:i.startDTS*s)+u,h=i.endDTS*s+u,f=o*Pd,m=Math.ceil((h-d)/f),p=Fa.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(R.warn("[mp4-remuxer]: remux empty Audio"),!p){R.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}let g=[];for(let T=0;T<m;T++){let _=d+T*f;g.push({unit:p,pts:_,dts:_})}return e.samples=g,this.remuxAudio(e,t,n,!1)}};function vt(r,e){let t;if(e===null)return r;for(e<r?t=-8589934592:t=8589934592;Math.abs(r-e)>4294967296;)r+=t;return r}function hy(r){for(let e=0;e<r.length;e++)if(r[e].key)return e;return-1}function kd(r,e,t,n){let i=r.samples.length;if(!i)return;let s=r.inputTimeScale;for(let o=0;o<i;o++){let l=r.samples[o];l.pts=vt(l.pts-t.baseTime*9e4/t.timescale,e*s)/s,l.dts=vt(l.dts-n.baseTime*9e4/n.timescale,e*s)/s}let a=r.samples;return r.samples=[],{samples:a}}function Dd(r,e,t){let n=r.samples.length;if(!n)return;let i=r.inputTimeScale;for(let a=0;a<n;a++){let o=r.samples[a];o.pts=vt(o.pts-t.baseTime*9e4/t.timescale,e*i)/i}r.samples.sort((a,o)=>a.pts-o.pts);let s=r.samples;return r.samples=[],{samples:s}}var Ua=class{constructor(e,t,n,i){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=n,this.cts=i,this.flags=new xd(e)}},xd=class{constructor(e){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=e?2:1,this.isNonSync=e?0:1}},Od=class{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,n,i){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment(Xg(e,i)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:n}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}let i=this.initData=Au(e);t||(t=Md(i.audio,be.AUDIO)),n||(n=Md(i.video,be.VIDEO));let s={};i.audio&&i.video?s.audiovideo={container:"video/mp4",codec:t+","+n,initSegment:e,id:"main"}:i.audio?s.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:i.video?s.video={container:"video/mp4",codec:n,initSegment:e,id:"main"}:R.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=s}remux(e,t,n,i,s,a){var o,l;let{initPTS:c,lastEndTime:u}=this,d={audio:void 0,video:void 0,text:i,id3:n,initSegment:void 0};X(u)||(u=this.lastEndTime=s||0);let h=t.samples;if(!(h!=null&&h.length))return d;let f={initPTS:void 0,timescale:1},m=this.initData;if((o=m)!=null&&o.length||(this.generateInitSegment(h),m=this.initData),!((l=m)!=null&&l.length))return R.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),d;this.emitInitSegment&&(f.tracks=this.initTracks,this.emitInitSegment=!1);let p=Qg(m,h),g=p===null?s:p;(fy(c,g,s)||f.timescale!==c.timescale&&a)&&(f.initPTS=g-s,this.initPTS=c={baseTime:f.initPTS,timescale:1});let T=Zg(h,m),_=e?g-c.baseTime/c.timescale:u,y=_+T;ev(m,h,c.baseTime/c.timescale),T>0?this.lastEndTime=y:(R.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());let b=!!m.audio,E=!!m.video,C="";b&&(C+="audio"),E&&(C+="video");let w={data1:h,startPTS:_,startDTS:_,endPTS:y,endDTS:y,type:C,hasAudio:b,hasVideo:E,nb:1,dropped:0};return d.audio=w.type==="audio"?w:void 0,d.video=w.type!=="audio"?w:void 0,d.initSegment=f,d.id3=kd(n,s,c,c),i.samples.length&&(d.text=Dd(i,s,c)),d}};function fy(r,e,t){if(r===null)return!0;let n=e-r.baseTime/r.timescale;return n<0&&Math.abs(n-t)>1}function Md(r,e){let t=r==null?void 0:r.codec;return t&&t.length>4?t:t==="hvc1"||t==="hev1"?"hvc1.1.c.L120.90":t==="av01"?"av01.0.04M.08":t==="avc1"||e===be.VIDEO?"avc1.42e01e":"mp4a.40.5"}var nn;try{nn=self.performance.now.bind(self.performance)}catch(r){R.debug("Unable to use Performance API on this environment"),nn=typeof self!="undefined"&&self.Date.now}var $a=[{demux:_d,remux:Od},{demux:tn,remux:as},{demux:Sd,remux:as},{demux:Cd,remux:as}],Ga=class{constructor(e,t,n,i,s){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=n,this.vendor=i,this.id=s}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,n,i){let s=n.transmuxing;s.executeStart=nn();let a=new Uint8Array(e),{currentTransmuxState:o,transmuxConfig:l}=this;i&&(this.currentTransmuxState=i);let{contiguous:c,discontinuity:u,trackSwitch:d,accurateTimeOffset:h,timeOffset:f,initSegmentChange:m}=i||o,{audioCodec:p,videoCodec:g,defaultInitPts:T,duration:_,initSegmentData:y}=l,b=my(a,t);if(b&&b.method==="AES-128"){let O=this.getDecrypter();if(O.isSync()){let S=O.softwareDecrypt(a,b.key.buffer,b.iv.buffer);if(n.part>-1&&(S=O.flush()),!S)return s.executeEnd=nn(),Va(n);a=new Uint8Array(S)}else return this.decryptionPromise=O.webCryptoDecrypt(a,b.key.buffer,b.iv.buffer).then(S=>{let I=this.push(S,null,n);return this.decryptionPromise=null,I}),this.decryptionPromise}let E=this.needsProbing(u,d);if(E){let O=this.configureTransmuxer(a);if(O)return R.warn(`[transmuxer] ${O.message}`),this.observer.emit(v.ERROR,v.ERROR,{type:J.MEDIA_ERROR,details:F.FRAG_PARSING_ERROR,fatal:!1,error:O,reason:O.message}),s.executeEnd=nn(),Va(n)}(u||d||m||E)&&this.resetInitSegment(y,p,g,_,t),(u||m||E)&&this.resetInitialTimestamp(T),c||this.resetContiguity();let C=this.transmux(a,b,f,h,n),w=this.currentTransmuxState;return w.contiguous=!0,w.discontinuity=!1,w.trackSwitch=!1,s.executeEnd=nn(),C}flush(e){let t=e.transmuxing;t.executeStart=nn();let{decrypter:n,currentTransmuxState:i,decryptionPromise:s}=this;if(s)return s.then(()=>this.flush(e));let a=[],{timeOffset:o}=i;if(n){let d=n.flush();d&&a.push(this.push(d,null,e))}let{demuxer:l,remuxer:c}=this;if(!l||!c)return t.executeEnd=nn(),[Va(e)];let u=l.flush(o);return os(u)?u.then(d=>(this.flushRemux(a,d,e),a)):(this.flushRemux(a,u,e),a)}flushRemux(e,t,n){let{audioTrack:i,videoTrack:s,id3Track:a,textTrack:o}=t,{accurateTimeOffset:l,timeOffset:c}=this.currentTransmuxState;R.log(`[transmuxer.ts]: Flushed fragment ${n.sn}${n.part>-1?" p: "+n.part:""} of level ${n.level}`);let u=this.remuxer.remux(i,s,a,o,c,l,!0,this.id);e.push({remuxResult:u,chunkMeta:n}),n.transmuxing.executeEnd=nn()}resetInitialTimestamp(e){let{demuxer:t,remuxer:n}=this;!t||!n||(t.resetTimeStamp(e),n.resetTimeStamp(e))}resetContiguity(){let{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,n,i,s){let{demuxer:a,remuxer:o}=this;!a||!o||(a.resetInitSegment(e,t,n,i),o.resetInitSegment(e,t,n,s))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,n,i,s){let a;return t&&t.method==="SAMPLE-AES"?a=this.transmuxSampleAes(e,t,n,i,s):a=this.transmuxUnencrypted(e,n,i,s),a}transmuxUnencrypted(e,t,n,i){let{audioTrack:s,videoTrack:a,id3Track:o,textTrack:l}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(s,a,o,l,t,n,!1,this.id),chunkMeta:i}}transmuxSampleAes(e,t,n,i,s){return this.demuxer.demuxSampleAes(e,t,n).then(a=>({remuxResult:this.remuxer.remux(a.audioTrack,a.videoTrack,a.id3Track,a.textTrack,n,i,!1,this.id),chunkMeta:s}))}configureTransmuxer(e){let{config:t,observer:n,typeSupported:i,vendor:s}=this,a;for(let d=0,h=$a.length;d<h;d++)if($a[d].demux.probe(e)){a=$a[d];break}if(!a)return new Error("Failed to find demuxer by probing fragment data");let o=this.demuxer,l=this.remuxer,c=a.remux,u=a.demux;(!l||!(l instanceof c))&&(this.remuxer=new c(n,t,i,s)),(!o||!(o instanceof u))&&(this.demuxer=new u(n,t,i),this.probe=u.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new es(this.config)),e}};function my(r,e){let t=null;return r.byteLength>0&&e!=null&&e.key!=null&&e.iv!==null&&e.method!=null&&(t=e),t}var Va=r=>({remuxResult:{},chunkMeta:r});function os(r){return"then"in r&&r.then instanceof Function}var Fd=class{constructor(e,t,n,i,s){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=n,this.duration=i,this.defaultInitPts=s||null}},Nd=class{constructor(e,t,n,i,s,a){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=n,this.trackSwitch=i,this.timeOffset=s,this.initSegmentChange=a}},Gi={},py={get exports(){return Gi},set exports(r){Gi=r}};(function(r){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function i(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function s(l,c,u,d,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new i(u,d||l,h),m=t?t+c:c;return l._events[m]?l._events[m].fn?l._events[m]=[l._events[m],f]:l._events[m].push(f):(l._events[m]=f,l._eventsCount++),l}function a(l,c){--l._eventsCount==0?l._events=new n:delete l._events[c]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var c=[],u,d;if(this._eventsCount===0)return c;for(d in u=this._events)e.call(u,d)&&c.push(t?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},o.prototype.listeners=function(c){var u=t?t+c:c,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,f=d.length,m=new Array(f);h<f;h++)m[h]=d[h].fn;return m},o.prototype.listenerCount=function(c){var u=t?t+c:c,d=this._events[u];return d?d.fn?1:d.length:0},o.prototype.emit=function(c,u,d,h,f,m){var p=t?t+c:c;if(!this._events[p])return!1;var g=this._events[p],T=arguments.length,_,y;if(g.fn){switch(g.once&&this.removeListener(c,g.fn,void 0,!0),T){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,u),!0;case 3:return g.fn.call(g.context,u,d),!0;case 4:return g.fn.call(g.context,u,d,h),!0;case 5:return g.fn.call(g.context,u,d,h,f),!0;case 6:return g.fn.call(g.context,u,d,h,f,m),!0}for(y=1,_=new Array(T-1);y<T;y++)_[y-1]=arguments[y];g.fn.apply(g.context,_)}else{var b=g.length,E;for(y=0;y<b;y++)switch(g[y].once&&this.removeListener(c,g[y].fn,void 0,!0),T){case 1:g[y].fn.call(g[y].context);break;case 2:g[y].fn.call(g[y].context,u);break;case 3:g[y].fn.call(g[y].context,u,d);break;case 4:g[y].fn.call(g[y].context,u,d,h);break;default:if(!_)for(E=1,_=new Array(T-1);E<T;E++)_[E-1]=arguments[E];g[y].fn.apply(g[y].context,_)}}return!0},o.prototype.on=function(c,u,d){return s(this,c,u,d,!1)},o.prototype.once=function(c,u,d){return s(this,c,u,d,!0)},o.prototype.removeListener=function(c,u,d,h){var f=t?t+c:c;if(!this._events[f])return this;if(!u)return a(this,f),this;var m=this._events[f];if(m.fn)m.fn===u&&(!h||m.once)&&(!d||m.context===d)&&a(this,f);else{for(var p=0,g=[],T=m.length;p<T;p++)(m[p].fn!==u||h&&!m[p].once||d&&m[p].context!==d)&&g.push(m[p]);g.length?this._events[f]=g.length===1?g[0]:g:a(this,f)}return this},o.prototype.removeAllListeners=function(c){var u;return c?(u=t?t+c:c,this._events[u]&&a(this,u)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=t,o.EventEmitter=o,r.exports=o})(py);var ja=Ra()||{isTypeSupported:()=>!1},Ha=class{constructor(e,t,n,i){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;let s=e.config;this.hls=e,this.id=t,this.useWorker=!!s.enableWorker,this.onTransmuxComplete=n,this.onFlush=i;let a=(c,u)=>{u=u||{},u.frag=this.frag,u.id=this.id,c===v.ERROR&&(this.error=u.error),this.hls.trigger(c,u)};this.observer=new Gi,this.observer.on(v.FRAG_DECRYPTED,a),this.observer.on(v.ERROR,a);let o={mp4:ja.isTypeSupported("video/mp4"),mpeg:ja.isTypeSupported("audio/mpeg"),mp3:ja.isTypeSupported('audio/mp4; codecs="mp3"')},l=navigator.vendor;if(this.useWorker&&typeof Worker!="undefined"&&(s.workerPath||Hv())){try{s.workerPath?(R.log(`loading Web Worker ${s.workerPath} for "${t}"`),this.workerContext=Kv(s.workerPath)):(R.log(`injecting Web Worker for "${t}"`),this.workerContext=Wv()),this.onwmsg=d=>this.onWorkerMessage(d);let{worker:u}=this.workerContext;u.addEventListener("message",this.onwmsg),u.onerror=d=>{let h=new Error(`${d.message}  (${d.filename}:${d.lineno})`);s.enableWorker=!1,R.warn(`Error in "${t}" Web Worker, fallback to inline`),this.hls.trigger(v.ERROR,{type:J.OTHER_ERROR,details:F.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:h})},u.postMessage({cmd:"init",typeSupported:o,vendor:l,id:t,config:JSON.stringify(s)})}catch(u){R.warn(`Error setting up "${t}" Web Worker, fallback to inline`,u),this.resetWorker(),this.error=null,this.transmuxer=new Ga(this.observer,o,s,l,t)}return}this.transmuxer=new Ga(this.observer,o,s,l,t)}resetWorker(){if(this.workerContext){let{worker:e,objectURL:t}=this.workerContext;t&&self.URL.revokeObjectURL(t),e.removeEventListener("message",this.onwmsg),e.onerror=null,e.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{let t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}let e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(e,t,n,i,s,a,o,l,c,u){var d,h;c.transmuxing.start=self.performance.now();let{transmuxer:f}=this,m=a?a.start:s.start,p=s.decryptdata,g=this.frag,T=!(g&&s.cc===g.cc),_=!(g&&c.level===g.level),y=g?c.sn-g.sn:-1,b=this.part?c.part-this.part.index:-1,E=y===0&&c.id>1&&c.id===(g==null?void 0:g.stats.chunkCount),C=!_&&(y===1||y===0&&(b===1||E&&b<=0)),w=self.performance.now();(_||y||s.stats.parsing.start===0)&&(s.stats.parsing.start=w),a&&(b||!C)&&(a.stats.parsing.start=w);let O=!(g&&((d=s.initSegment)==null?void 0:d.url)===((h=g.initSegment)==null?void 0:h.url)),S=new Nd(T,C,l,_,m,O);if(!C||T||O){R.log(`[transmuxer-interface, ${s.type}]: Starting new transmux session for sn: ${c.sn} p: ${c.part} level: ${c.level} id: ${c.id}
        discontinuity: ${T}
        trackSwitch: ${_}
        contiguous: ${C}
        accurateTimeOffset: ${l}
        timeOffset: ${m}
        initSegmentChange: ${O}`);let I=new Fd(n,i,t,o,u);this.configureTransmuxer(I)}if(this.frag=s,this.part=a,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:p,chunkMeta:c,state:S},e instanceof ArrayBuffer?[e]:[]);else if(f){let I=f.push(e,p,c,S);os(I)?(f.async=!0,I.then(N=>{this.handleTransmuxComplete(N)}).catch(N=>{this.transmuxerError(N,c,"transmuxer-interface push error")})):(f.async=!1,this.handleTransmuxComplete(I))}}flush(e){e.transmuxing.start=self.performance.now();let{transmuxer:t}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(t){let n=t.flush(e);os(n)||t.async?(os(n)||(n=Promise.resolve(n)),n.then(s=>{this.handleFlushResult(s,e)}).catch(s=>{this.transmuxerError(s,e,"transmuxer-interface flush error")})):this.handleFlushResult(n,e)}}transmuxerError(e,t,n){!this.hls||(this.error=e,this.hls.trigger(v.ERROR,{type:J.MEDIA_ERROR,details:F.FRAG_PARSING_ERROR,chunkMeta:t,fatal:!1,error:e,err:e,reason:n}))}handleFlushResult(e,t){e.forEach(n=>{this.handleTransmuxComplete(n)}),this.onFlush(t)}onWorkerMessage(e){let t=e.data,n=this.hls;switch(t.event){case"init":{var i;let s=(i=this.workerContext)==null?void 0:i.objectURL;s&&self.URL.revokeObjectURL(s);break}case"transmuxComplete":{this.handleTransmuxComplete(t.data);break}case"flush":{this.onFlush(t.data);break}case"workerLog":R[t.data.logType]&&R[t.data.logType](t.data.message);break;default:{t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,n.trigger(t.event,t.data);break}}}configureTransmuxer(e){let{transmuxer:t}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):t&&t.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}},gy=250,Wa=2,vy=.1,yy=.05,Bd=class{constructor(e,t,n,i){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=n,this.hls=i}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(e,t){let{config:n,media:i,stalled:s}=this;if(i===null)return;let{currentTime:a,seeking:o}=i,l=this.seeking&&!o,c=!this.seeking&&o;if(this.seeking=o,a!==e){if(this.moved=!0,s!==null){if(this.stallReported){let T=self.performance.now()-s;R.warn(`playback not stuck anymore @${a}, after ${Math.round(T)}ms`),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if(c||l){this.stalled=null;return}if(i.paused&&!o||i.ended||i.playbackRate===0||!_e.getBuffered(i).length)return;let u=_e.bufferInfo(i,a,0),d=u.len>0,h=u.nextStart||0;if(!d&&!h)return;if(o){let T=u.len>Wa,_=!h||t&&t.start<=a||h-a>Wa&&!this.fragmentTracker.getPartialFragment(a);if(T||_)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var f;let T=Math.max(h,u.start||0)-a,_=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,b=(_==null||(f=_.details)==null?void 0:f.live)?_.details.targetduration*2:Wa,E=this.fragmentTracker.getPartialFragment(a);if(T>0&&(T<=b||E)){this._trySkipBufferHole(E);return}}let m=self.performance.now();if(s===null){this.stalled=m;return}let p=m-s;if(!o&&p>=gy&&(this._reportStall(u),!this.media))return;let g=_e.bufferInfo(i,a,n.maxBufferHole);this._tryFixBufferStall(g,p)}_tryFixBufferStall(e,t){let{config:n,fragmentTracker:i,media:s}=this;if(s===null)return;let a=s.currentTime,o=i.getPartialFragment(a);o&&(this._trySkipBufferHole(o)||!this.media)||(e.len>n.maxBufferHole||e.nextStart&&e.nextStart-a<n.maxBufferHole)&&t>n.highBufferWatchdogPeriod*1e3&&(R.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(e){let{hls:t,media:n,stallReported:i}=this;if(!i&&n){this.stallReported=!0;let s=new Error(`Playback stalling at @${n.currentTime} due to low buffer (${JSON.stringify(e)})`);R.warn(s.message),t.trigger(v.ERROR,{type:J.MEDIA_ERROR,details:F.BUFFER_STALLED_ERROR,fatal:!1,error:s,buffer:e.len})}}_trySkipBufferHole(e){let{config:t,hls:n,media:i}=this;if(i===null)return 0;let s=i.currentTime,a=_e.bufferInfo(i,s,0),o=s<a.start?a.start:a.nextStart;if(o){let l=a.len<=t.maxBufferHole,c=a.len>0&&a.len<1&&i.readyState<3,u=o-s;if(u>0&&(l||c)){if(u>t.maxBufferHole){let{fragmentTracker:h}=this,f=!1;if(s===0){let m=h.getAppendedFrag(0,Z.MAIN);m&&o<m.end&&(f=!0)}if(!f){let m=e||h.getAppendedFrag(s,Z.MAIN);if(m){let p=!1,g=m.end;for(;g<o;){let T=h.getPartialFragment(g);if(T)g+=T.duration;else{p=!0;break}}if(p)return 0}}}let d=Math.max(o+yy,s+vy);if(R.warn(`skipping hole, adjusting currentTime from ${s} to ${d}`),this.moved=!0,this.stalled=null,i.currentTime=d,e&&!e.gap){let h=new Error(`fragment loaded with buffer holes, seeking from ${s} to ${d}`);n.trigger(v.ERROR,{type:J.MEDIA_ERROR,details:F.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:h,reason:h.message,frag:e})}return d}}return 0}_tryNudgeBuffer(){let{config:e,hls:t,media:n,nudgeRetry:i}=this;if(n===null)return;let s=n.currentTime;if(this.nudgeRetry++,i<e.nudgeMaxRetry){let a=s+(i+1)*e.nudgeOffset,o=new Error(`Nudging 'currentTime' from ${s} to ${a}`);R.warn(o.message),n.currentTime=a,t.trigger(v.ERROR,{type:J.MEDIA_ERROR,details:F.BUFFER_NUDGE_ON_STALL,error:o,fatal:!1})}else{let a=new Error(`Playhead still not moving while enough data buffered @${s} after ${e.nudgeMaxRetry} nudges`);R.error(a.message),t.trigger(v.ERROR,{type:J.MEDIA_ERROR,details:F.BUFFER_STALLED_ERROR,error:a,fatal:!0})}}},by=100,Ud=class extends ts{constructor(e,t,n){super(e,t,n,"[stream-controller]",Z.MAIN);this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){let{hls:e}=this;e.on(v.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(v.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(v.MANIFEST_LOADING,this.onManifestLoading,this),e.on(v.MANIFEST_PARSED,this.onManifestParsed,this),e.on(v.LEVEL_LOADING,this.onLevelLoading,this),e.on(v.LEVEL_LOADED,this.onLevelLoaded,this),e.on(v.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(v.ERROR,this.onError,this),e.on(v.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(v.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(v.BUFFER_CREATED,this.onBufferCreated,this),e.on(v.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(v.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(v.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){let{hls:e}=this;e.off(v.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(v.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(v.MANIFEST_LOADING,this.onManifestLoading,this),e.off(v.MANIFEST_PARSED,this.onManifestParsed,this),e.off(v.LEVEL_LOADED,this.onLevelLoaded,this),e.off(v.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(v.ERROR,this.onError,this),e.off(v.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(v.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(v.BUFFER_CREATED,this.onBufferCreated,this),e.off(v.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(v.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(v.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),this.onMediaDetaching()}startLoad(e){if(this.levels){let{lastCurrentTime:t,hls:n}=this;if(this.stopLoad(),this.setInterval(by),this.level=-1,!this.startFragRequested){let i=n.startLevel;i===-1&&(n.config.testBandwidth&&this.levels.length>1?(i=0,this.bitrateTest=!0):i=n.nextAutoLevel),this.level=n.nextLoadLevel=i,this.loadedmetadata=!1}t>0&&e===-1&&(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t),this.state=$.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=$.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case $.WAITING_LEVEL:{var e;let{levels:n,level:i}=this,s=n==null||(e=n[i])==null?void 0:e.details;if(s&&(!s.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(s))break;this.state=$.IDLE;break}break}case $.FRAG_LOADING_WAITING_RETRY:{var t;let n=self.performance.now(),i=this.retryDate;(!i||n>=i||(t=this.media)!=null&&t.seeking)&&(this.resetStartWhenNotLoaded(this.level),this.state=$.IDLE)}break}this.state===$.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){let{hls:e,levelLastLoaded:t,levels:n,media:i}=this,{config:s,nextLoadLevel:a}=e;if(t===null||!i&&(this.startFragRequested||!s.startFragPrefetch)||this.altAudio&&this.audioOnly||!(n!=null&&n[a]))return;let o=n[a],l=this.getMainFwdBufferInfo();if(l===null)return;let c=this.getLevelDetails();if(c&&this._streamEnded(l,c)){let g={};this.altAudio&&(g.type="video"),this.hls.trigger(v.BUFFER_EOS,g),this.state=$.ENDED;return}e.loadLevel!==a&&e.manualLevel===-1&&this.log(`Adapting to level ${a} from level ${this.level}`),this.level=e.nextLoadLevel=a;let u=o.details;if(!u||this.state===$.WAITING_LEVEL||u.live&&this.levelLastLoaded!==a){this.level=a,this.state=$.WAITING_LEVEL;return}let d=l.len,h=this.getMaxBufferLength(o.maxBitrate);if(d>=h)return;this.backtrackFragment&&this.backtrackFragment.start>l.end&&(this.backtrackFragment=null);let f=this.backtrackFragment?this.backtrackFragment.start:l.end,m=this.getNextFragment(f,u);if(this.couldBacktrack&&!this.fragPrevious&&m&&m.sn!=="initSegment"&&this.fragmentTracker.getState(m)!==Ve.OK){var p;let T=((p=this.backtrackFragment)!=null?p:m).sn-u.startSN,_=u.fragments[T-1];_&&m.cc===_.cc&&(m=_,this.fragmentTracker.removeFragment(_))}else this.backtrackFragment&&l.len&&(this.backtrackFragment=null);if(m&&this.isLoopLoading(m,f)){if(!m.gap){let T=this.audioOnly&&!this.altAudio?be.AUDIO:be.VIDEO,_=(T===be.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;_&&this.afterBufferFlushed(_,T,Z.MAIN)}m=this.getNextFragmentLoopLoading(m,u,l,Z.MAIN,h)}!m||(m.initSegment&&!m.initSegment.data&&!this.bitrateTest&&(m=m.initSegment),this.loadFragment(m,o,f))}loadFragment(e,t,n){let i=this.fragmentTracker.getState(e);this.fragCurrent=e,i===Ve.NOT_LOADED?e.sn==="initSegment"?this._loadInitSegment(e,t):this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):(this.startFragRequested=!0,super.loadFragment(e,t,n)):this.clearTrackerIfNeeded(e)}getAppendedFrag(e){let t=this.fragmentTracker.getAppendedFrag(e,Z.MAIN);return t&&"fragment"in t?t.fragment:t}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,Z.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){let{levels:e,media:t}=this;if(t!=null&&t.readyState){let n,i=this.getAppendedFrag(t.currentTime);if(i&&i.start>1&&this.flushMainBuffer(0,i.start-1),!t.paused&&e){let a=this.hls.nextLoadLevel,o=e[a],l=this.fragLastKbps;l&&this.fragCurrent?n=this.fragCurrent.duration*o.maxBitrate/(1e3*l)+1:n=0}else n=0;let s=this.getBufferedFrag(t.currentTime+n);if(s){let a=this.followingBufferedFrag(s);if(a){this.abortCurrentFrag();let o=a.maxStartPTS?a.maxStartPTS:a.start,l=a.duration,c=Math.max(s.end,o+Math.min(Math.max(l-this.config.maxFragLookUpTolerance,l*.5),l*.75));this.flushMainBuffer(c,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){let e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case $.KEY_LOADING:case $.FRAG_LOADING:case $.FRAG_LOADING_WAITING_RETRY:case $.PARSING:case $.PARSED:this.state=$.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);let n=t.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),n.addEventListener("playing",this.onvplaying),n.addEventListener("seeked",this.onvseeked),this.gapController=new Bd(this.config,n,this.fragmentTracker,this.hls)}onMediaDetaching(){let{media:e}=this;e&&this.onvplaying&&this.onvseeked&&(e.removeEventListener("playing",this.onvplaying),e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){let e=this.media,t=e?e.currentTime:null;X(t)&&this.log(`Media seeked to ${t.toFixed(3)}`);let n=this.getMainFwdBufferInfo();if(n===null||n.len===0){this.warn(`Main forward buffer length on "seeked" event ${n?n.len:"empty"})`);return}this.tick()}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(v.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null,this.backtrackFragment=null}onManifestParsed(e,t){let n=!1,i=!1,s;t.levels.forEach(a=>{s=a.audioCodec,s&&(s.indexOf("mp4a.40.2")!==-1&&(n=!0),s.indexOf("mp4a.40.5")!==-1&&(i=!0))}),this.audioCodecSwitch=n&&i&&!jv(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){let{levels:n}=this;if(!n||this.state!==$.IDLE)return;let i=n[t.level];(!i.details||i.details.live&&this.levelLastLoaded!==t.level||this.waitForCdnTuneIn(i.details))&&(this.state=$.WAITING_LEVEL)}onLevelLoaded(e,t){var n;let{levels:i}=this,s=t.level,a=t.details,o=a.totalduration;if(!i){this.warn(`Levels were reset while loading level ${s}`);return}this.log(`Level ${s} loaded [${a.startSN},${a.endSN}], cc [${a.startCC}, ${a.endCC}] duration:${o}`);let l=i[s],c=this.fragCurrent;c&&(this.state===$.FRAG_LOADING||this.state===$.FRAG_LOADING_WAITING_RETRY)&&(c.level!==t.level||c.urlId!==l.urlId)&&c.loader&&this.abortCurrentFrag();let u=0;if(a.live||(n=l.details)!=null&&n.live){if(a.fragments[0]||(a.deltaUpdateFailed=!0),a.deltaUpdateFailed)return;u=this.alignPlaylists(a,l.details)}if(l.details=a,this.levelLastLoaded=s,this.hls.trigger(v.LEVEL_UPDATED,{details:a,level:s}),this.state===$.WAITING_LEVEL){if(this.waitForCdnTuneIn(a))return;this.state=$.IDLE}this.startFragRequested?a.live&&this.synchronizeToLiveEdge(a):this.setStartPosition(a,u),this.tick()}_handleFragmentLoadProgress(e){var t;let{frag:n,part:i,payload:s}=e,{levels:a}=this;if(!a){this.warn(`Levels were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}let o=a[n.level],l=o.details;if(!l){this.warn(`Dropping fragment ${n.sn} of level ${n.level} after level details were reset`),this.fragmentTracker.removeFragment(n);return}let c=o.videoCodec,u=l.PTSKnown||!l.live,d=(t=n.initSegment)==null?void 0:t.data,h=this._getAudioCodec(o),f=this.transmuxer=this.transmuxer||new Ha(this.hls,Z.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),m=i?i.index:-1,p=m!==-1,g=new Jr(n.level,n.sn,n.stats.chunkCount,s.byteLength,m,p),T=this.initPTS[n.cc];f.push(s,d,h,c,n,i,l.totalduration,u,g,T)}onAudioTrackSwitching(e,t){let n=this.altAudio;if(!!!t.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;let a=this.fragCurrent;a&&(this.log("Switching to main audio track, cancel main fragment load"),a.abortRequests(),this.fragmentTracker.removeFragment(a)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();let s=this.hls;n&&(s.trigger(v.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),s.trigger(v.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){let n=t.id,i=!!this.hls.audioTracks[n].url;if(i){let s=this.videoBuffer;s&&this.mediaBuffer!==s&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=s)}this.altAudio=i,this.tick()}onBufferCreated(e,t){let n=t.tracks,i,s,a=!1;for(let o in n){let l=n[o];if(l.id==="main"){if(s=o,i=l,o==="video"){let c=n[o];c&&(this.videoBuffer=c.buffer)}}else a=!0}a&&i?(this.log(`Alternate track found, use ${s}.buffered to schedule main fragment loading`),this.mediaBuffer=i.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){let{frag:n,part:i}=t;if(n&&n.type!==Z.MAIN)return;if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}`),this.state===$.PARSED&&(this.state=$.IDLE);return}let s=i?i.stats:n.stats;this.fragLastKbps=Math.round(8*s.total/(s.buffering.end-s.loading.first)),n.sn!=="initSegment"&&(this.fragPrevious=n),this.fragBufferedComplete(n,i)}onError(e,t){var n;if(t.fatal){this.state=$.ERROR;return}switch(t.details){case F.FRAG_GAP:case F.FRAG_PARSING_ERROR:case F.FRAG_DECRYPT_ERROR:case F.FRAG_LOAD_ERROR:case F.FRAG_LOAD_TIMEOUT:case F.KEY_LOAD_ERROR:case F.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Z.MAIN,t);break;case F.LEVEL_LOAD_ERROR:case F.LEVEL_LOAD_TIMEOUT:case F.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===$.WAITING_LEVEL&&((n=t.context)==null?void 0:n.type)===pe.LEVEL&&(this.state=$.IDLE);break;case F.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case F.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}checkBuffer(){let{media:e,gapController:t}=this;if(!(!e||!t||!e.readyState)){if(this.loadedmetadata||!_e.getBuffered(e).length){let n=this.state!==$.IDLE?this.fragCurrent:null;t.poll(this.lastCurrentTime,n)}this.lastCurrentTime=e.currentTime}}onFragLoadEmergencyAborted(){this.state=$.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==be.AUDIO||this.audioOnly&&!this.altAudio){let n=(t===be.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(n,t,Z.MAIN)}}onLevelsUpdated(e,t){this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){let{media:e}=this;if(!e)return;let t=e.currentTime,n=this.startPosition;if(n>=0&&t<n){if(e.seeking){this.log(`could not seek to ${n}, already seeking at ${t}`);return}let i=_e.getBuffered(e),a=(i.length?i.start(0):0)-n;a>0&&(a<this.config.maxBufferHole||a<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${a} to match buffer start`),n+=a,this.startPosition=n),this.log(`seek to target start position ${n} from current time ${t}`),e.currentTime=n}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(n=>{let{hls:i}=this;if(!n||this.fragContextChanged(e))return;t.fragmentError=0,this.state=$.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;let s=e.stats;s.parsing.start=s.parsing.end=s.buffering.start=s.buffering.end=self.performance.now(),i.trigger(v.FRAG_LOADED,n),e.bitrateTest=!1})}_handleTransmuxComplete(e){var t;let n="main",{hls:i}=this,{remuxResult:s,chunkMeta:a}=e,o=this.getCurrentContext(a);if(!o){this.resetWhenMissingContext(a);return}let{frag:l,part:c,level:u}=o,{video:d,text:h,id3:f,initSegment:m}=s,{details:p}=u,g=this.altAudio?void 0:s.audio;if(this.fragContextChanged(l)){this.fragmentTracker.removeFragment(l);return}if(this.state=$.PARSING,m){m.tracks&&(this._bufferInitSegment(u,m.tracks,l,a),i.trigger(v.FRAG_PARSING_INIT_SEGMENT,{frag:l,id:n,tracks:m.tracks}));let T=m.initPTS,_=m.timescale;X(T)&&(this.initPTS[l.cc]={baseTime:T,timescale:_},i.trigger(v.INIT_PTS_FOUND,{frag:l,id:n,initPTS:T,timescale:_}))}if(d&&s.independent!==!1){if(p){let{startPTS:T,endPTS:_,startDTS:y,endDTS:b}=d;if(c)c.elementaryStreams[d.type]={startPTS:T,endPTS:_,startDTS:y,endDTS:b};else if(d.firstKeyFrame&&d.independent&&a.id===1&&(this.couldBacktrack=!0),d.dropped&&d.independent){let E=this.getMainFwdBufferInfo(),C=(E?E.end:this.getLoadPosition())+this.config.maxBufferHole,w=d.firstKeyFramePTS?d.firstKeyFramePTS:T;if(C<w-this.config.maxBufferHole){this.backtrack(l);return}l.setElementaryStreamInfo(d.type,l.start,_,l.start,b,!0)}l.setElementaryStreamInfo(d.type,T,_,y,b),this.backtrackFragment&&(this.backtrackFragment=l),this.bufferFragmentData(d,l,c,a)}}else if(s.independent===!1){this.backtrack(l);return}if(g){let{startPTS:T,endPTS:_,startDTS:y,endDTS:b}=g;c&&(c.elementaryStreams[be.AUDIO]={startPTS:T,endPTS:_,startDTS:y,endDTS:b}),l.setElementaryStreamInfo(be.AUDIO,T,_,y,b),this.bufferFragmentData(g,l,c,a)}if(p&&f!=null&&(t=f.samples)!=null&&t.length){let T={id:n,frag:l,details:p,samples:f.samples};i.trigger(v.FRAG_PARSING_METADATA,T)}if(p&&h){let T={id:n,frag:l,details:p,samples:h.samples};i.trigger(v.FRAG_PARSING_USERDATA,T)}}_bufferInitSegment(e,t,n,i){if(this.state!==$.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;let{audio:s,video:a,audiovideo:o}=t;if(s){let l=e.audioCodec,c=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(l&&(l.indexOf("mp4a.40.5")!==-1?l="mp4a.40.2":l="mp4a.40.5"),s.metadata.channelCount!==1&&c.indexOf("firefox")===-1&&(l="mp4a.40.5")),c.indexOf("android")!==-1&&s.container!=="audio/mpeg"&&(l="mp4a.40.2",this.log(`Android: force audio codec to ${l}`)),e.audioCodec&&e.audioCodec!==l&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${l}"`),s.levelCodec=l,s.id="main",this.log(`Init audio buffer, container:${s.container}, codecs[selected/level/parsed]=[${l||""}/${e.audioCodec||""}/${s.codec}]`)}a&&(a.levelCodec=e.videoCodec,a.id="main",this.log(`Init video buffer, container:${a.container}, codecs[level/parsed]=[${e.videoCodec||""}/${a.codec}]`)),o&&this.log(`Init audiovideo buffer, container:${o.container}, codecs[level/parsed]=[${e.attrs.CODECS||""}/${o.codec}]`),this.hls.trigger(v.BUFFER_CODECS,t),Object.keys(t).forEach(l=>{let u=t[l].initSegment;u!=null&&u.byteLength&&this.hls.trigger(v.BUFFER_APPENDING,{type:l,data:u,frag:n,part:null,chunkMeta:i,parent:n.type})}),this.tick()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,Z.MAIN)}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=$.IDLE}checkFragmentChanged(){let e=this.media,t=null;if(e&&e.readyState>1&&e.seeking===!1){let n=e.currentTime;if(_e.isBuffered(e,n)?t=this.getAppendedFrag(n):_e.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){this.backtrackFragment=null;let i=this.fragPlaying,s=t.level;(!i||t.sn!==i.sn||i.level!==s||t.urlId!==i.urlId)&&(this.fragPlaying=t,this.hls.trigger(v.FRAG_CHANGED,{frag:t}),(!i||i.level!==s)&&this.hls.trigger(v.LEVEL_SWITCHED,{level:s}))}}}get nextLevel(){let e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){let e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}get currentProgramDateTime(){let e=this.media;if(e){let t=e.currentTime,n=this.currentFrag;if(n&&X(t)&&X(n.programDateTime)){let i=n.programDateTime+(t-n.start)*1e3;return new Date(i)}}return null}get currentLevel(){let e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){let e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}},xn=class{constructor(e,t=0,n=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=n}sample(e,t){let n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){let e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}},$d=class{constructor(e,t,n,i=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new xn(e),this.fast_=new xn(t),this.defaultTTFB_=i,this.ttfb_=new xn(e)}update(e,t){let{slow_:n,fast_:i,ttfb_:s}=this;n.halfLife!==e&&(this.slow_=new xn(e,n.getEstimate(),n.getTotalWeight())),i.halfLife!==t&&(this.fast_=new xn(t,i.getEstimate(),i.getTotalWeight())),s.halfLife!==e&&(this.ttfb_=new xn(e,s.getEstimate(),s.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);let n=8*t,i=e/1e3,s=n/i;this.fast_.sample(i,s),this.slow_.sample(i,s)}sampleTTFB(e){let t=e/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(n,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}},Gd=class{constructor(e){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=-1,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=e;let t=e.config;this.bwEstimator=new $d(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate),this.registerListeners()}registerListeners(){let{hls:e}=this;e.on(v.FRAG_LOADING,this.onFragLoading,this),e.on(v.FRAG_LOADED,this.onFragLoaded,this),e.on(v.FRAG_BUFFERED,this.onFragBuffered,this),e.on(v.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(v.LEVEL_LOADED,this.onLevelLoaded,this)}unregisterListeners(){let{hls:e}=this;e.off(v.FRAG_LOADING,this.onFragLoading,this),e.off(v.FRAG_LOADED,this.onFragLoaded,this),e.off(v.FRAG_BUFFERED,this.onFragBuffered,this),e.off(v.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(v.LEVEL_LOADED,this.onLevelLoaded,this)}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null}onFragLoading(e,t){var n;let i=t.frag;this.ignoreFragment(i)||(this.fragCurrent=i,this.partCurrent=(n=t.part)!=null?n:null,this.clearTimer(),this.timer=self.setInterval(this.onCheck,100))}onLevelSwitching(e,t){this.clearTimer()}getTimeToLoadFrag(e,t,n,i){let s=e+n/t,a=i?this.lastLevelLoadSec:0;return s+a}onLevelLoaded(e,t){let n=this.hls.config,{total:i,bwEstimate:s}=t.stats;X(i)&&X(s)&&(this.lastLevelLoadSec=8*i/s),t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD)}_abandonRulesCheck(){let{fragCurrent:e,partCurrent:t,hls:n}=this,{autoLevelEnabled:i,media:s}=n;if(!e||!s)return;let a=performance.now(),o=t?t.stats:e.stats,l=t?t.duration:e.duration,c=a-o.loading.start;if(o.aborted||o.loaded&&o.loaded===o.total||e.level===0){this.clearTimer(),this._nextAutoLevel=-1;return}if(!i||s.paused||!s.playbackRate||!s.readyState)return;let u=n.mainForwardBufferInfo;if(u===null)return;let d=this.bwEstimator.getEstimateTTFB(),h=Math.abs(s.playbackRate);if(c<=Math.max(d,1e3*(l/(h*2))))return;let f=u.len/h;if(f>=2*l/h)return;let m=o.loading.first?o.loading.first-o.loading.start:-1,p=o.loaded&&m>-1,g=this.bwEstimator.getEstimate(),{levels:T,minAutoLevel:_}=n,y=T[e.level],b=o.total||Math.max(o.loaded,Math.round(l*y.maxBitrate/8)),E=c-m;E<1&&p&&(E=Math.min(c,o.loaded*8/g));let C=p?o.loaded*1e3/E:0,w=C?(b-o.loaded)/C:b*8/g+d/1e3;if(w<=f)return;let O=C?C*8:g,S=Number.POSITIVE_INFINITY,I;for(I=e.level-1;I>_;I--){let N=T[I].maxBitrate;if(S=this.getTimeToLoadFrag(d/1e3,O,l*N,!T[I].details),S<f)break}S>=w||S>l*10||(n.nextLoadLevel=I,p?this.bwEstimator.sample(c-Math.min(d,m),o.loaded):this.bwEstimator.sampleTTFB(c),this.clearTimer(),R.warn(`[abr] Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} is loading too slowly;
      Time to underbuffer: ${f.toFixed(3)} s
      Estimated load time for current fragment: ${w.toFixed(3)} s
      Estimated load time for down switch fragment: ${S.toFixed(3)} s
      TTFB estimate: ${m}
      Current BW estimate: ${X(g)?(g/1024).toFixed(3):"Unknown"} Kb/s
      New BW estimate: ${(this.bwEstimator.getEstimate()/1024).toFixed(3)} Kb/s
      Aborting and switching to level ${I}`),e.loader&&(this.fragCurrent=this.partCurrent=null,e.abortRequests()),n.trigger(v.FRAG_LOAD_EMERGENCY_ABORTED,{frag:e,part:t,stats:o}))}onFragLoaded(e,{frag:t,part:n}){let i=n?n.stats:t.stats;if(t.type===Z.MAIN&&this.bwEstimator.sampleTTFB(i.loading.first-i.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){let s=n?n.duration:t.duration,a=this.hls.levels[t.level],o=(a.loaded?a.loaded.bytes:0)+i.loaded,l=(a.loaded?a.loaded.duration:0)+s;a.loaded={bytes:o,duration:l},a.realBitrate=Math.round(8*o/l)}if(t.bitrateTest){let s={stats:i,frag:t,part:n,id:t.type};this.onFragBuffered(v.FRAG_BUFFERED,s),t.bitrateTest=!1}}}onFragBuffered(e,t){let{frag:n,part:i}=t,s=i!=null&&i.stats.loaded?i.stats:n.stats;if(s.aborted||this.ignoreFragment(n))return;let a=s.parsing.end-s.loading.start-Math.min(s.loading.first-s.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(a,s.loaded),s.bwEstimate=this.bwEstimator.getEstimate(),n.bitrateTest?this.bitrateTestDelay=a/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==Z.MAIN||e.sn==="initSegment"}clearTimer(){self.clearInterval(this.timer)}get nextAutoLevel(){let e=this._nextAutoLevel,t=this.bwEstimator;if(e!==-1&&!t.canEstimate())return e;let n=this.getNextABRAutoLevel();if(e!==-1){let i=this.hls.levels;if(i.length>Math.max(e,n)&&i[e].loadError<=i[n].loadError)return e}return e!==-1&&(n=Math.min(e,n)),n}getNextABRAutoLevel(){let{fragCurrent:e,partCurrent:t,hls:n}=this,{maxAutoLevel:i,config:s,minAutoLevel:a,media:o}=n,l=t?t.duration:e?e.duration:0,c=o&&o.playbackRate!==0?Math.abs(o.playbackRate):1,u=this.bwEstimator?this.bwEstimator.getEstimate():s.abrEwmaDefaultEstimate,d=n.mainForwardBufferInfo,h=(d?d.len:0)/c,f=this.findBestLevel(u,a,i,h,s.abrBandWidthFactor,s.abrBandWidthUpFactor);if(f>=0)return f;R.trace(`[abr] ${h?"rebuffering expected":"buffer is empty"}, finding optimal quality level`);let m=l?Math.min(l,s.maxStarvationDelay):s.maxStarvationDelay,p=s.abrBandWidthFactor,g=s.abrBandWidthUpFactor;if(!h){let T=this.bitrateTestDelay;T&&(m=(l?Math.min(l,s.maxLoadingDelay):s.maxLoadingDelay)-T,R.trace(`[abr] bitrate test took ${Math.round(1e3*T)}ms, set first fragment max fetchDuration to ${Math.round(1e3*m)} ms`),p=g=1)}return f=this.findBestLevel(u,a,i,h+m,p,g),Math.max(f,0)}findBestLevel(e,t,n,i,s,a){var o;let{fragCurrent:l,partCurrent:c,lastLoadedFragLevel:u}=this,{levels:d}=this.hls,h=d[u],f=!!(h!=null&&(o=h.details)!=null&&o.live),m=h==null?void 0:h.codecSet,p=c?c.duration:l?l.duration:0,g=this.bwEstimator.getEstimateTTFB()/1e3,T=t,_=-1;for(let y=n;y>=t;y--){let b=d[y];if(!b||m&&b.codecSet!==m){b&&(T=Math.min(y,T),_=Math.max(y,_));continue}_!==-1&&R.trace(`[abr] Skipped level(s) ${T}-${_} with CODECS:"${d[_].attrs.CODECS}"; not compatible with "${h.attrs.CODECS}"`);let E=b.details,C=(c?E==null?void 0:E.partTarget:E==null?void 0:E.averagetargetduration)||p,w;y<=u?w=s*e:w=a*e;let O=d[y].maxBitrate,S=this.getTimeToLoadFrag(g,w,O*C,E===void 0);if(R.trace(`[abr] level:${y} adjustedbw-bitrate:${Math.round(w-O)} avgDuration:${C.toFixed(1)} maxFetchDuration:${i.toFixed(1)} fetchDuration:${S.toFixed(1)}`),w>O&&(S===0||!X(S)||f&&!this.bitrateTestDelay||S<i))return y}return-1}set nextAutoLevel(e){this._nextAutoLevel=e}},Ka=class{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){let{chunks:e,dataLength:t}=this,n;if(e.length)e.length===1?n=e[0]:n=Ty(e,t);else return new Uint8Array(0);return this.reset(),n}reset(){this.chunks.length=0,this.dataLength=0}};function Ty(r,e){let t=new Uint8Array(e),n=0;for(let i=0;i<r.length;i++){let s=r[i];t.set(s,n),n+=s.length}return t}var Vd=100,jd=class extends ts{constructor(e,t,n){super(e,t,n,"[audio-stream-controller]",Z.AUDIO);this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){let{hls:e}=this;e.on(v.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(v.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(v.MANIFEST_LOADING,this.onManifestLoading,this),e.on(v.LEVEL_LOADED,this.onLevelLoaded,this),e.on(v.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(v.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(v.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(v.ERROR,this.onError,this),e.on(v.BUFFER_RESET,this.onBufferReset,this),e.on(v.BUFFER_CREATED,this.onBufferCreated,this),e.on(v.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(v.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(v.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){let{hls:e}=this;e.off(v.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(v.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(v.MANIFEST_LOADING,this.onManifestLoading,this),e.off(v.LEVEL_LOADED,this.onLevelLoaded,this),e.off(v.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(v.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(v.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(v.ERROR,this.onError,this),e.off(v.BUFFER_RESET,this.onBufferReset,this),e.off(v.BUFFER_CREATED,this.onBufferCreated,this),e.off(v.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(v.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(v.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(e,{frag:t,id:n,initPTS:i,timescale:s}){if(n==="main"){let a=t.cc;this.initPTS[t.cc]={baseTime:i,timescale:s},this.log(`InitPTS for cc: ${a} found from main: ${i}`),this.videoTrackCC=a,this.state===$.WAITING_INIT_PTS&&this.tick()}}startLoad(e){if(!this.levels){this.startPosition=e,this.state=$.STOPPED;return}let t=this.lastCurrentTime;this.stopLoad(),this.setInterval(Vd),t>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t,this.state=$.IDLE):(this.loadedmetadata=!1,this.state=$.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}doTick(){switch(this.state){case $.IDLE:this.doTickIdle();break;case $.WAITING_TRACK:{var e;let{levels:n,trackId:i}=this,s=n==null||(e=n[i])==null?void 0:e.details;if(s){if(this.waitForCdnTuneIn(s))break;this.state=$.WAITING_INIT_PTS}break}case $.FRAG_LOADING_WAITING_RETRY:{var t;let n=performance.now(),i=this.retryDate;(!i||n>=i||(t=this.media)!=null&&t.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state=$.IDLE);break}case $.WAITING_INIT_PTS:{let n=this.waitingData;if(n){let{frag:i,part:s,cache:a,complete:o}=n;if(this.initPTS[i.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=$.FRAG_LOADING;let l=a.flush(),c={frag:i,part:s,payload:l,networkDetails:null};this._handleFragmentLoadProgress(c),o&&super._handleFragmentLoadComplete(c)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${i.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{let l=this.getLoadPosition(),c=_e.bufferInfo(this.mediaBuffer,l,this.config.maxBufferHole);wa(c.end,this.config.maxFragLookUpTolerance,i)<0&&(this.log(`Waiting fragment cc (${i.cc}) @ ${i.start} cancelled because another fragment at ${c.end} is needed`),this.clearWaitingFragment())}}else this.state=$.IDLE}}this.onTickEnd()}clearWaitingFragment(){let e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=$.IDLE)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){let{media:e}=this;!(e!=null&&e.readyState)||(this.lastCurrentTime=e.currentTime)}doTickIdle(){let{hls:e,levels:t,media:n,trackId:i}=this,s=e.config;if(!(t!=null&&t[i])||!n&&(this.startFragRequested||!s.startFragPrefetch))return;let a=t[i],o=a.details;if(!o||o.live&&this.levelLastLoaded!==i||this.waitForCdnTuneIn(o)){this.state=$.WAITING_TRACK;return}let l=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&l&&(this.bufferFlushed=!1,this.afterBufferFlushed(l,be.AUDIO,Z.AUDIO));let c=this.getFwdBufferInfo(l,Z.AUDIO);if(c===null)return;let{bufferedTrack:u,switchingTrack:d}=this;if(!d&&this._streamEnded(c,o)){e.trigger(v.BUFFER_EOS,{type:"audio"}),this.state=$.ENDED;return}let h=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,Z.MAIN),f=c.len,m=this.getMaxBufferLength(h==null?void 0:h.len);if(f>=m&&!d)return;let g=o.fragments[0].start,T=c.end;if(d&&n){let E=this.getLoadPosition();u&&d.attrs!==u.attrs&&(T=E),o.PTSKnown&&E<g&&(c.end>g||c.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),n.currentTime=g+.05)}let _=this.getNextFragment(T,o),y=!1;if(_&&this.isLoopLoading(_,T)&&(y=!!_.gap,_=this.getNextFragmentLoopLoading(_,o,c,Z.MAIN,m)),!_){this.bufferFlushed=!0;return}let b=h&&_.start>h.end+o.targetduration;if(b||!(h!=null&&h.len)&&c.len){let E=this.fragmentTracker.getBufferedFrag(_.start,Z.MAIN);if(E===null||(y||(y=!!E.gap||!!b&&h.len===0),b&&!y||y&&c.nextStart&&c.nextStart<E.end))return}this.loadFragment(_,a,T)}getMaxBufferLength(e){let t=super.getMaxBufferLength();return e?Math.min(Math.max(t,e),this.config.maxMaxBufferLength):t}onMediaDetaching(){this.videoBuffer=null,super.onMediaDetaching()}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(n=>new ti(n))}onAudioTrackSwitching(e,t){let n=!!t.url;this.trackId=t.id;let{fragCurrent:i}=this;i&&(i.abortRequests(),this.removeUnbufferedFrags(i.start)),this.resetLoadingState(),n?this.setInterval(Vd):this.resetTransmuxer(),n?(this.switchingTrack=t,this.state=$.IDLE):(this.switchingTrack=null,this.bufferedTrack=t,this.state=$.STOPPED),this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1,this.bufferedTrack=null,this.switchingTrack=null}onLevelLoaded(e,t){this.mainDetails=t.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(v.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(e,t){var n;if(this.mainDetails==null){this.cachedTrackLoadedData=t;return}let{levels:i}=this,{details:s,id:a}=t;if(!i){this.warn(`Audio tracks were reset while loading level ${a}`);return}this.log(`Track ${a} loaded [${s.startSN},${s.endSN}],duration:${s.totalduration}`);let o=i[a],l=0;if(s.live||(n=o.details)!=null&&n.live){let c=this.mainDetails;if(s.fragments[0]||(s.deltaUpdateFailed=!0),s.deltaUpdateFailed||!c)return;!o.details&&s.hasProgramDateTime&&c.hasProgramDateTime?(hd(s,c),l=s.fragments[0].start):l=this.alignPlaylists(s,o.details)}o.details=s,this.levelLastLoaded=a,!this.startFragRequested&&(this.mainDetails||!s.live)&&this.setStartPosition(o.details,l),this.state===$.WAITING_TRACK&&!this.waitForCdnTuneIn(s)&&(this.state=$.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;let{frag:n,part:i,payload:s}=e,{config:a,trackId:o,levels:l}=this;if(!l){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}let c=l[o];if(!c){this.warn("Audio track is undefined on fragment load progress");return}let u=c.details;if(!u){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(n.start);return}let d=a.defaultAudioCodec||c.audioCodec||"mp4a.40.2",h=this.transmuxer;h||(h=this.transmuxer=new Ha(this.hls,Z.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));let f=this.initPTS[n.cc],m=(t=n.initSegment)==null?void 0:t.data;if(f!==void 0){let p=!1,g=i?i.index:-1,T=g!==-1,_=new Jr(n.level,n.sn,n.stats.chunkCount,s.byteLength,g,T);h.push(s,m,d,"",n,i,u.totalduration,p,_,f)}else{this.log(`Unknown video PTS for cc ${n.cc}, waiting for video PTS before demuxing audio frag ${n.sn} of [${u.startSN} ,${u.endSN}],track ${o}`);let{cache:p}=this.waitingData=this.waitingData||{frag:n,part:i,cache:new Ka,complete:!1};p.push(new Uint8Array(s)),this.waitingVideoCC=this.videoTrackCC,this.state=$.WAITING_INIT_PTS}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(e,t){let n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)}onFragBuffered(e,t){let{frag:n,part:i}=t;if(n.type!==Z.AUDIO){if(!this.loadedmetadata&&n.type===Z.MAIN){var s;(s=this.videoBuffer||this.media)!=null&&s.buffered.length&&(this.loadedmetadata=!0)}return}if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(n.sn!=="initSegment"){this.fragPrevious=n;let a=this.switchingTrack;a&&(this.bufferedTrack=a,this.switchingTrack=null,this.hls.trigger(v.AUDIO_TRACK_SWITCHED,ze({},a)))}this.fragBufferedComplete(n,i)}onError(e,t){var n;if(t.fatal){this.state=$.ERROR;return}switch(t.details){case F.FRAG_GAP:case F.FRAG_PARSING_ERROR:case F.FRAG_DECRYPT_ERROR:case F.FRAG_LOAD_ERROR:case F.FRAG_LOAD_TIMEOUT:case F.KEY_LOAD_ERROR:case F.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Z.AUDIO,t);break;case F.AUDIO_TRACK_LOAD_ERROR:case F.AUDIO_TRACK_LOAD_TIMEOUT:case F.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===$.WAITING_TRACK&&((n=t.context)==null?void 0:n.type)===pe.AUDIO_TRACK&&(this.state=$.IDLE);break;case F.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case F.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushed(e,{type:t}){t===be.AUDIO&&(this.bufferFlushed=!0,this.state===$.ENDED&&(this.state=$.IDLE))}_handleTransmuxComplete(e){var t;let n="audio",{hls:i}=this,{remuxResult:s,chunkMeta:a}=e,o=this.getCurrentContext(a);if(!o){this.resetWhenMissingContext(a);return}let{frag:l,part:c,level:u}=o,{details:d}=u,{audio:h,text:f,id3:m,initSegment:p}=s;if(this.fragContextChanged(l)||!d){this.fragmentTracker.removeFragment(l);return}if(this.state=$.PARSING,this.switchingTrack&&h&&this.completeAudioSwitch(this.switchingTrack),p!=null&&p.tracks&&(this._bufferInitSegment(p.tracks,l,a),i.trigger(v.FRAG_PARSING_INIT_SEGMENT,{frag:l,id:n,tracks:p.tracks})),h){let{startPTS:g,endPTS:T,startDTS:_,endDTS:y}=h;c&&(c.elementaryStreams[be.AUDIO]={startPTS:g,endPTS:T,startDTS:_,endDTS:y}),l.setElementaryStreamInfo(be.AUDIO,g,T,_,y),this.bufferFragmentData(h,l,c,a)}if(m!=null&&(t=m.samples)!=null&&t.length){let g=Oe({id:n,frag:l,details:d},m);i.trigger(v.FRAG_PARSING_METADATA,g)}if(f){let g=Oe({id:n,frag:l,details:d},f);i.trigger(v.FRAG_PARSING_USERDATA,g)}}_bufferInitSegment(e,t,n){if(this.state!==$.PARSING)return;e.video&&delete e.video;let i=e.audio;if(!i)return;i.levelCodec=i.codec,i.id="audio",this.log(`Init audio buffer, container:${i.container}, codecs[parsed]=[${i.codec}]`),this.hls.trigger(v.BUFFER_CODECS,e);let s=i.initSegment;if(s!=null&&s.byteLength){let a={type:"audio",frag:t,part:null,chunkMeta:n,parent:t.type,data:s};this.hls.trigger(v.BUFFER_APPENDING,a)}this.tick()}loadFragment(e,t,n){let i=this.fragmentTracker.getState(e);if(this.fragCurrent=e,this.switchingTrack||i===Ve.NOT_LOADED||i===Ve.PARTIAL){var s;e.sn==="initSegment"?this._loadInitSegment(e,t):(s=t.details)!=null&&s.live&&!this.initPTS[e.cc]?(this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=$.WAITING_INIT_PTS):(this.startFragRequested=!0,super.loadFragment(e,t,n))}else this.clearTrackerIfNeeded(e)}completeAudioSwitch(e){let{hls:t,media:n,bufferedTrack:i}=this,s=i==null?void 0:i.attrs,a=e.attrs;n&&s&&(s.CHANNELS!==a.CHANNELS||s.NAME!==a.NAME||s.LANGUAGE!==a.LANGUAGE)&&(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio")),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(v.AUDIO_TRACK_SWITCHED,ze({},e))}},Hd=class extends Xr{constructor(e){super(e,"[audio-track-controller]");this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){let{hls:e}=this;e.on(v.MANIFEST_LOADING,this.onManifestLoading,this),e.on(v.MANIFEST_PARSED,this.onManifestParsed,this),e.on(v.LEVEL_LOADING,this.onLevelLoading,this),e.on(v.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(v.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(v.ERROR,this.onError,this)}unregisterListeners(){let{hls:e}=this;e.off(v.MANIFEST_LOADING,this.onManifestLoading,this),e.off(v.MANIFEST_PARSED,this.onManifestParsed,this),e.off(v.LEVEL_LOADING,this.onLevelLoading,this),e.off(v.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(v.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(v.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){let{id:n,groupId:i,details:s}=t,a=this.tracksInGroup[n];if(!a||a.groupId!==i){this.warn(`Track with id:${n} and group:${i} not found in active group ${a.groupId}`);return}let o=a.details;a.details=t.details,this.log(`audio-track ${n} "${a.name}" lang:${a.lang} group:${i} loaded [${s.startSN}-${s.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,o)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){let t=this.hls.levels[e];if(!(t!=null&&t.audioGroupIds))return;let n=t.audioGroupIds[t.urlId];if(this.groupId!==n){this.groupId=n||null;let i=this.tracks.filter(a=>!n||a.groupId===n);this.selectDefaultTrack&&!i.some(a=>a.default)&&(this.selectDefaultTrack=!1),this.tracksInGroup=i;let s={audioTracks:i};this.log(`Updating audio tracks, ${i.length} track(s) found in group:${n}`),this.hls.trigger(v.AUDIO_TRACKS_UPDATED,s),this.selectInitialTrack()}else this.shouldReloadPlaylist(this.currentTrack)&&this.setAudioTrack(this.trackId)}onError(e,t){t.fatal||!t.context||t.context.type===pe.AUDIO_TRACK&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&(this.requestScheduled=-1,this.checkRetry(t))}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioTrack(e){let t=this.tracksInGroup;if(e<0||e>=t.length){this.warn("Invalid id passed to audio-track controller");return}this.clearTimer();let n=this.currentTrack;t[this.trackId];let i=t[e],{groupId:s,name:a}=i;if(this.log(`Switching to audio-track ${e} "${a}" lang:${i.lang} group:${s}`),this.trackId=e,this.currentTrack=i,this.selectDefaultTrack=!1,this.hls.trigger(v.AUDIO_TRACK_SWITCHING,ze({},i)),i.details&&!i.details.live)return;let o=this.switchParams(i.url,n==null?void 0:n.details);this.loadPlaylist(o)}selectInitialTrack(){let e=this.tracksInGroup,t=this.findTrackId(this.currentTrack)|this.findTrackId(null);if(t!==-1)this.setAudioTrack(t);else{let n=new Error(`No track found for running audio group-ID: ${this.groupId} track count: ${e.length}`);this.warn(n.message),this.hls.trigger(v.ERROR,{type:J.MEDIA_ERROR,details:F.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:n})}}findTrackId(e){let t=this.tracksInGroup;for(let n=0;n<t.length;n++){let i=t[n];if((!this.selectDefaultTrack||i.default)&&(!e||e.attrs["STABLE-RENDITION-ID"]===i.attrs["STABLE-RENDITION-ID"]||e.name===i.name&&e.lang===i.lang))return i.id}return-1}loadPlaylist(e){super.loadPlaylist();let t=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(t)){let n=t.id,i=t.groupId,s=t.url;if(e)try{s=e.addDirectives(s)}catch(a){this.warn(`Could not construct new URL with HLS Delivery Directives: ${a}`)}this.log(`loading audio-track playlist ${n} "${t.name}" lang:${t.lang} group:${i}`),this.clearTimer(),this.hls.trigger(v.AUDIO_TRACK_LOADING,{url:s,id:n,groupId:i,deliveryDirectives:e||null})}}};function Wd(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(!Ey(r[t].attrs,e[t].attrs))return!1;return!0}function Ey(r,e){let t=r["STABLE-RENDITION-ID"];return t?t===e["STABLE-RENDITION-ID"]:!["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED"].some(n=>r[n]!==e[n])}var Kd=500,qd=class extends ts{constructor(e,t,n){super(e,t,n,"[subtitle-stream-controller]",Z.SUBTITLE);this.levels=[],this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null}_registerListeners(){let{hls:e}=this;e.on(v.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(v.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(v.MANIFEST_LOADING,this.onManifestLoading,this),e.on(v.LEVEL_LOADED,this.onLevelLoaded,this),e.on(v.ERROR,this.onError,this),e.on(v.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(v.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(v.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(v.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(v.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(v.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){let{hls:e}=this;e.off(v.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(v.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(v.MANIFEST_LOADING,this.onManifestLoading,this),e.off(v.LEVEL_LOADED,this.onLevelLoaded,this),e.off(v.ERROR,this.onError,this),e.off(v.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(v.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(v.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(v.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(v.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(v.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(e){this.stopLoad(),this.state=$.IDLE,this.setInterval(Kd),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){let{frag:n,success:i}=t;if(this.fragPrevious=n,this.state=$.IDLE,!i)return;let s=this.tracksBuffered[this.currentTrackId];if(!s)return;let a,o=n.start;for(let c=0;c<s.length;c++)if(o>=s[c].start&&o<=s[c].end){a=s[c];break}let l=n.start+n.duration;a?a.end=l:(a={start:o,end:l},s.push(a)),this.fragmentTracker.fragBuffered(n)}onBufferFlushing(e,t){let{startOffset:n,endOffset:i}=t;if(n===0&&i!==Number.POSITIVE_INFINITY){let{currentTrackId:s,levels:a}=this;if(!a.length||!a[s]||!a[s].details)return;let l=a[s].details.targetduration,c=i-l;if(c<=0)return;t.endOffsetSubtitles=Math.max(0,c),this.tracksBuffered.forEach(u=>{for(let d=0;d<u.length;){if(u[d].end<=c){u.shift();continue}else if(u[d].start<c)u[d].start=c;else break;d++}}),this.fragmentTracker.removeFragmentsInRange(n,c,Z.SUBTITLE)}}onFragBuffered(e,t){if(!this.loadedmetadata&&t.frag.type===Z.MAIN){var n;(n=this.media)!=null&&n.buffered.length&&(this.loadedmetadata=!0)}}onError(e,t){let n=t.frag;(n==null?void 0:n.type)===Z.SUBTITLE&&(this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==$.STOPPED&&(this.state=$.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(Wd(this.levels,t)){this.levels=t.map(n=>new ti(n));return}this.tracksBuffered=[],this.levels=t.map(n=>{let i=new ti(n);return this.tracksBuffered[i.id]=[],i}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,Z.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){if(this.currentTrackId=t.id,!this.levels.length||this.currentTrackId===-1){this.clearInterval();return}let n=this.levels[this.currentTrackId];n!=null&&n.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,n&&this.setInterval(Kd)}onSubtitleTrackLoaded(e,t){var n;let{details:i,id:s}=t,{currentTrackId:a,levels:o}=this;if(!o.length)return;let l=o[a];if(s>=o.length||s!==a||!l)return;this.mediaBuffer=this.mediaBufferTimeRanges;let c=0;if(i.live||(n=l.details)!=null&&n.live){let u=this.mainDetails;if(i.deltaUpdateFailed||!u)return;let d=u.fragments[0];l.details?(c=this.alignPlaylists(i,l.details),c===0&&d&&(c=d.start,_a(i,c))):i.hasProgramDateTime&&u.hasProgramDateTime?(hd(i,u),c=i.fragments[0].start):d&&(c=d.start,_a(i,c))}l.details=i,this.levelLastLoaded=s,!this.startFragRequested&&(this.mainDetails||!i.live)&&this.setStartPosition(l.details,c),this.tick(),i.live&&!this.fragCurrent&&this.media&&this.state===$.IDLE&&(Ui(null,i.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),l.details=void 0))}_handleFragmentLoadComplete(e){let{frag:t,payload:n}=e,i=t.decryptdata,s=this.hls;if(!this.fragContextChanged(t)&&n&&n.byteLength>0&&i&&i.key&&i.iv&&i.method==="AES-128"){let a=performance.now();this.decrypter.decrypt(new Uint8Array(n),i.key.buffer,i.iv.buffer).catch(o=>{throw s.trigger(v.ERROR,{type:J.MEDIA_ERROR,details:F.FRAG_DECRYPT_ERROR,fatal:!1,error:o,reason:o.message,frag:t}),o}).then(o=>{let l=performance.now();s.trigger(v.FRAG_DECRYPTED,{frag:t,payload:o,stats:{tstart:a,tdecrypt:l}})}).catch(o=>{this.warn(`${o.name}: ${o.message}`),this.state=$.IDLE})}}doTick(){if(!this.media){this.state=$.IDLE;return}if(this.state===$.IDLE){let{currentTrackId:e,levels:t}=this,n=t[e];if(!t.length||!n||!n.details)return;let i=n.details,s=i.targetduration,{config:a}=this,o=this.getLoadPosition(),l=_e.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],o-s,a.maxBufferHole),{end:c,len:u}=l,d=this.getFwdBufferInfo(this.media,Z.MAIN),h=this.getMaxBufferLength(d==null?void 0:d.len)+s;if(u>h)return;let f=i.fragments,m=f.length,p=i.edge,g=null,T=this.fragPrevious;if(c<p){let{maxFragLookUpTolerance:_}=a;g=Ui(T,f,Math.max(f[0].start,c),_),!g&&T&&T.start<f[0].start&&(g=f[0])}else g=f[m-1];if(!g)return;g=this.mapToInitFragWhenRequired(g),this.fragmentTracker.getState(g)===Ve.NOT_LOADED&&this.loadFragment(g,n,c)}}getMaxBufferLength(e){let t=super.getMaxBufferLength();return e?Math.max(t,e):t}loadFragment(e,t,n){this.fragCurrent=e,e.sn==="initSegment"?this._loadInitSegment(e,t):(this.startFragRequested=!0,super.loadFragment(e,t,n))}get mediaBufferTimeRanges(){return new zd(this.tracksBuffered[this.currentTrackId]||[])}},zd=class{constructor(e){this.buffered=void 0;let t=(n,i,s)=>{if(i=i>>>0,i>s-1)throw new DOMException(`Failed to execute '${n}' on 'TimeRanges': The index provided (${i}) is greater than the maximum bound (${s})`);return e[i][n]};this.buffered={get length(){return e.length},end(n){return t("end",n,e.length)},start(n){return t("start",n,e.length)}}}},Yd=class extends Xr{constructor(e){super(e,"[subtitle-track-controller]");this.media=null,this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.trackChangeListener=()=>this.onTextTracksChanged(),this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes(this.trackId)}registerListeners(){let{hls:e}=this;e.on(v.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(v.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(v.MANIFEST_LOADING,this.onManifestLoading,this),e.on(v.MANIFEST_PARSED,this.onManifestParsed,this),e.on(v.LEVEL_LOADING,this.onLevelLoading,this),e.on(v.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(v.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(v.ERROR,this.onError,this)}unregisterListeners(){let{hls:e}=this;e.off(v.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(v.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(v.MANIFEST_LOADING,this.onManifestLoading,this),e.off(v.MANIFEST_PARSED,this.onManifestParsed,this),e.off(v.LEVEL_LOADING,this.onLevelLoading,this),e.off(v.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(v.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(v.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,!!this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,e)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),qa(this.media.textTracks).forEach(t=>{ei(t)}),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){let{id:n,details:i}=t,{trackId:s}=this,a=this.tracksInGroup[s];if(!a){this.warn(`Invalid subtitle track id ${n}`);return}let o=a.details;a.details=t.details,this.log(`subtitle track ${n} loaded [${i.startSN}-${i.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,o)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){let t=this.hls.levels[e];if(!(t!=null&&t.textGroupIds))return;let n=t.textGroupIds[t.urlId],i=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;if(this.groupId!==n){let s=this.tracks.filter(l=>!n||l.groupId===n);this.tracksInGroup=s;let a=this.findTrackId(i==null?void 0:i.name)||this.findTrackId();this.groupId=n||null;let o={subtitleTracks:s};this.log(`Updating subtitle tracks, ${s.length} track(s) found in "${n}" group-id`),this.hls.trigger(v.SUBTITLE_TRACKS_UPDATED,o),a!==-1&&this.setSubtitleTrack(a,i)}else this.shouldReloadPlaylist(i)&&this.setSubtitleTrack(this.trackId,i)}findTrackId(e){let t=this.tracksInGroup;for(let n=0;n<t.length;n++){let i=t[n];if((!this.selectDefaultTrack||i.default)&&(!e||e===i.name))return i.id}return-1}onError(e,t){t.fatal||!t.context||t.context.type===pe.SUBTITLE_TRACK&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&this.checkRetry(t)}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1;let t=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(e,t)}loadPlaylist(e){super.loadPlaylist();let t=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(t)){let n=t.id,i=t.groupId,s=t.url;if(e)try{s=e.addDirectives(s)}catch(a){this.warn(`Could not construct new URL with HLS Delivery Directives: ${a}`)}this.log(`Loading subtitle playlist for id ${n}`),this.hls.trigger(v.SUBTITLE_TRACK_LOADING,{url:s,id:n,groupId:i,deliveryDirectives:e||null})}}toggleTrackModes(e){let{media:t,trackId:n}=this;if(!t)return;let i=qa(t.textTracks),s=i.filter(o=>o.groupId===this.groupId);if(e===-1)[].slice.call(i).forEach(o=>{o.mode="disabled"});else{let o=s[n];o&&(o.mode="disabled")}let a=s[e];a&&(a.mode=this.subtitleDisplay?"showing":"hidden")}setSubtitleTrack(e,t){var n;let i=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(this.trackId!==e&&this.toggleTrackModes(e),this.trackId===e&&(e===-1||(n=i[e])!=null&&n.details)||e<-1||e>=i.length)return;this.clearTimer();let s=i[e];if(this.log(`Switching to subtitle-track ${e}`+(s?` "${s.name}" lang:${s.lang} group:${s.groupId}`:"")),this.trackId=e,s){let{id:a,groupId:o="",name:l,type:c,url:u}=s;this.hls.trigger(v.SUBTITLE_TRACK_SWITCH,{id:a,groupId:o,name:l,type:c,url:u});let d=this.switchParams(s.url,t==null?void 0:t.details);this.loadPlaylist(d)}else this.hls.trigger(v.SUBTITLE_TRACK_SWITCH,{id:e})}onTextTracksChanged(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let e=-1,t=qa(this.media.textTracks);for(let n=0;n<t.length;n++)if(t[n].mode==="hidden")e=n;else if(t[n].mode==="showing"){e=n;break}this.subtitleTrack!==e&&(this.subtitleTrack=e)}};function qa(r){let e=[];for(let t=0;t<r.length;t++){let n=r[t];(n.kind==="subtitles"||n.kind==="captions")&&n.label&&e.push(r[t])}return e}var Xd=class{constructor(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}append(e,t){let n=this.queues[t];n.push(e),n.length===1&&this.buffers[t]&&this.executeNext(t)}insertAbort(e,t){this.queues[t].unshift(e),this.executeNext(t)}appendBlocker(e){let t,n=new Promise(s=>{t=s}),i={execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(i,e),n}executeNext(e){let{buffers:t,queues:n}=this,i=t[e],s=n[e];if(s.length){let a=s[0];try{a.execute()}catch(o){R.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),a.onError(o),i!=null&&i.updating||(s.shift(),this.executeNext(e))}}}shiftAndExecuteNext(e){this.queues[e].shift(),this.executeNext(e)}current(e){return this.queues[e][0]}},Qd=Ra(),Jd=/([ha]vc.)(?:\.[^.,]+)+/,Zd=class{constructor(e){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=()=>{let{media:t,mediaSource:n}=this;R.log("[buffer-controller]: Media source opened"),t&&(t.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(v.MEDIA_ATTACHED,{media:t})),n&&n.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{R.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=()=>{R.log("[buffer-controller]: Media source ended")},this._onMediaEmptied=()=>{let{media:t,_objectUrl:n}=this;t&&t.src!==n&&R.error(`Media element src was set while attaching MediaSource (${n} > ${t.src})`)},this.hls=e,this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null}registerListeners(){let{hls:e}=this;e.on(v.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(v.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(v.MANIFEST_PARSED,this.onManifestParsed,this),e.on(v.BUFFER_RESET,this.onBufferReset,this),e.on(v.BUFFER_APPENDING,this.onBufferAppending,this),e.on(v.BUFFER_CODECS,this.onBufferCodecs,this),e.on(v.BUFFER_EOS,this.onBufferEos,this),e.on(v.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(v.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(v.FRAG_PARSED,this.onFragParsed,this),e.on(v.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){let{hls:e}=this;e.off(v.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(v.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(v.MANIFEST_PARSED,this.onManifestParsed,this),e.off(v.BUFFER_RESET,this.onBufferReset,this),e.off(v.BUFFER_APPENDING,this.onBufferAppending,this),e.off(v.BUFFER_CODECS,this.onBufferCodecs,this),e.off(v.BUFFER_EOS,this.onBufferEos,this),e.off(v.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(v.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(v.FRAG_PARSED,this.onFragParsed,this),e.off(v.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new Xd(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.lastMpegAudioChunk=null}onManifestParsed(e,t){let n=2;(t.audio&&!t.video||!t.altAudio)&&(n=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=n,this.details=null,R.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(e,t){let n=this.media=t.media;if(n&&Qd){let i=this.mediaSource=new Qd;i.addEventListener("sourceopen",this._onMediaSourceOpen),i.addEventListener("sourceended",this._onMediaSourceEnded),i.addEventListener("sourceclose",this._onMediaSourceClose),n.src=self.URL.createObjectURL(i),this._objectUrl=n.src,n.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){let{media:e,mediaSource:t,_objectUrl:n}=this;if(t){if(R.log("[buffer-controller]: media source detaching"),t.readyState==="open")try{t.endOfStream()}catch(i){R.warn(`[buffer-controller]: onMediaDetaching: ${i.message} while calling endOfStream`)}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),e&&(e.removeEventListener("emptied",this._onMediaEmptied),n&&self.URL.revokeObjectURL(n),e.src===n?(e.removeAttribute("src"),e.load()):R.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(v.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach(e=>{let t=this.sourceBuffer[e];try{t&&(this.removeBufferListeners(e),this.mediaSource&&this.mediaSource.removeSourceBuffer(t),this.sourceBuffer[e]=void 0)}catch(n){R.warn(`[buffer-controller]: Failed to reset the ${e} buffer`,n)}}),this._initSourceBuffer()}onBufferCodecs(e,t){let n=this.getSourceBufferTypes().length;Object.keys(t).forEach(i=>{if(n){let s=this.tracks[i];if(s&&typeof s.buffer.changeType=="function"){let{id:a,codec:o,levelCodec:l,container:c,metadata:u}=t[i],d=(s.levelCodec||s.codec).replace(Jd,"$1"),h=(l||o).replace(Jd,"$1");if(d!==h){let f=`${c};codecs=${l||o}`;this.appendChangeType(i,f),R.log(`[buffer-controller]: switching codec ${d} to ${h}`),this.tracks[i]={buffer:s.buffer,codec:o,container:c,levelCodec:l,metadata:u,id:a}}}}else this.pendingTracks[i]=t[i]}),!n&&(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())}appendChangeType(e,t){let{operationQueue:n}=this,i={execute:()=>{let s=this.sourceBuffer[e];s&&(R.log(`[buffer-controller]: changing ${e} sourceBuffer type to ${t}`),s.changeType(t)),n.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:s=>{R.warn(`[buffer-controller]: Failed to change ${e} SourceBuffer type`,s)}};n.append(i,e)}onBufferAppending(e,t){let{hls:n,operationQueue:i,tracks:s}=this,{data:a,type:o,frag:l,part:c,chunkMeta:u}=t,d=u.buffering[o],h=self.performance.now();d.start=h;let f=l.stats.buffering,m=c?c.stats.buffering:null;f.start===0&&(f.start=h),m&&m.start===0&&(m.start=h);let p=s.audio,g=!1;o==="audio"&&(p==null?void 0:p.container)==="audio/mpeg"&&(g=!this.lastMpegAudioChunk||u.id===1||this.lastMpegAudioChunk.sn!==u.sn,this.lastMpegAudioChunk=u);let T=l.start,_={execute:()=>{if(d.executeStart=self.performance.now(),g){let y=this.sourceBuffer[o];if(y){let b=T-y.timestampOffset;Math.abs(b)>=.1&&(R.log(`[buffer-controller]: Updating audio SourceBuffer timestampOffset to ${T} (delta: ${b}) sn: ${l.sn})`),y.timestampOffset=T)}}this.appendExecutor(a,o)},onStart:()=>{},onComplete:()=>{let y=self.performance.now();d.executeEnd=d.end=y,f.first===0&&(f.first=y),m&&m.first===0&&(m.first=y);let{sourceBuffer:b}=this,E={};for(let C in b)E[C]=_e.getBuffered(b[C]);this.appendError=0,this.hls.trigger(v.BUFFER_APPENDED,{type:o,frag:l,part:c,chunkMeta:u,parent:l.type,timeRanges:E})},onError:y=>{R.error(`[buffer-controller]: Error encountered while trying to append to the ${o} SourceBuffer`,y);let b={type:J.MEDIA_ERROR,parent:l.type,details:F.BUFFER_APPEND_ERROR,frag:l,part:c,chunkMeta:u,error:y,err:y,fatal:!1};y.code===DOMException.QUOTA_EXCEEDED_ERR?b.details=F.BUFFER_FULL_ERROR:(this.appendError++,b.details=F.BUFFER_APPEND_ERROR,this.appendError>n.config.appendErrorMaxRetry&&(R.error(`[buffer-controller]: Failed ${n.config.appendErrorMaxRetry} times to append segment in sourceBuffer`),b.fatal=!0)),n.trigger(v.ERROR,b)}};i.append(_,o)}onBufferFlushing(e,t){let{operationQueue:n}=this,i=s=>({execute:this.removeExecutor.bind(this,s,t.startOffset,t.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(v.BUFFER_FLUSHED,{type:s})},onError:a=>{R.warn(`[buffer-controller]: Failed to remove from ${s} SourceBuffer`,a)}});t.type?n.append(i(t.type),t.type):this.getSourceBufferTypes().forEach(s=>{n.append(i(s),s)})}onFragParsed(e,t){let{frag:n,part:i}=t,s=[],a=i?i.elementaryStreams:n.elementaryStreams;a[be.AUDIOVIDEO]?s.push("audiovideo"):(a[be.AUDIO]&&s.push("audio"),a[be.VIDEO]&&s.push("video"));let o=()=>{let l=self.performance.now();n.stats.buffering.end=l,i&&(i.stats.buffering.end=l);let c=i?i.stats:n.stats;this.hls.trigger(v.FRAG_BUFFERED,{frag:n,part:i,stats:c,id:n.type})};s.length===0&&R.warn(`Fragments must have at least one ElementaryStreamType set. type: ${n.type} level: ${n.level} sn: ${n.sn}`),this.blockBuffers(o,s)}onFragChanged(e,t){this.flushBackBuffer()}onBufferEos(e,t){this.getSourceBufferTypes().reduce((i,s)=>{let a=this.sourceBuffer[s];return a&&(!t.type||t.type===s)&&(a.ending=!0,a.ended||(a.ended=!0,R.log(`[buffer-controller]: ${s} sourceBuffer now EOS`))),i&&!!(!a||a.ended)},!0)&&(R.log("[buffer-controller]: Queueing mediaSource.endOfStream()"),this.blockBuffers(()=>{this.getSourceBufferTypes().forEach(s=>{let a=this.sourceBuffer[s];a&&(a.ending=!1)});let{mediaSource:i}=this;if(!i||i.readyState!=="open"){i&&R.info(`[buffer-controller]: Could not call mediaSource.endOfStream(). mediaSource.readyState: ${i.readyState}`);return}R.log("[buffer-controller]: Calling mediaSource.endOfStream()"),i.endOfStream()}))}onLevelUpdated(e,{details:t}){!t.fragments.length||(this.details=t,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}flushBackBuffer(){let{hls:e,details:t,media:n,sourceBuffer:i}=this;if(!n||t===null)return;let s=this.getSourceBufferTypes();if(!s.length)return;let a=t.live&&e.config.liveBackBufferLength!==null?e.config.liveBackBufferLength:e.config.backBufferLength;if(!X(a)||a<0)return;let o=n.currentTime,l=t.levelTargetDuration,c=Math.max(a,l),u=Math.floor(o/l)*l-c;s.forEach(d=>{let h=i[d];if(h){let f=_e.getBuffered(h);if(f.length>0&&u>f.start(0)){if(e.trigger(v.BACK_BUFFER_REACHED,{bufferEnd:u}),t.live)e.trigger(v.LIVE_BACK_BUFFER_REACHED,{bufferEnd:u});else if(h.ended&&f.end(f.length-1)-o<l*2){R.info(`[buffer-controller]: Cannot flush ${d} back buffer while SourceBuffer is in ended state`);return}e.trigger(v.BUFFER_FLUSHING,{startOffset:0,endOffset:u,type:d})}}})}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")return;let{details:e,hls:t,media:n,mediaSource:i}=this,s=e.fragments[0].start+e.totalduration,a=n.duration,o=X(i.duration)?i.duration:0;e.live&&t.config.liveDurationInfinity?(R.log("[buffer-controller]: Media Source duration is set to Infinity"),i.duration=Infinity,this.updateSeekableRange(e)):(s>o&&s>a||!X(a))&&(R.log(`[buffer-controller]: Updating Media Source duration to ${s.toFixed(3)}`),i.duration=s)}updateSeekableRange(e){let t=this.mediaSource,n=e.fragments;if(n.length&&e.live&&t!=null&&t.setLiveSeekableRange){let s=Math.max(0,n[0].start),a=Math.max(s,s+e.totalduration);t.setLiveSeekableRange(s,a)}}checkPendingTracks(){let{bufferCodecEventsExpected:e,operationQueue:t,pendingTracks:n}=this,i=Object.keys(n).length;if(i&&!e||i===2){this.createSourceBuffers(n),this.pendingTracks={};let s=this.getSourceBufferTypes();if(s.length)this.hls.trigger(v.BUFFER_CREATED,{tracks:this.tracks}),s.forEach(a=>{t.executeNext(a)});else{let a=new Error("could not create source buffer for media codec(s)");this.hls.trigger(v.ERROR,{type:J.MEDIA_ERROR,details:F.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:a,reason:a.message})}}}createSourceBuffers(e){let{sourceBuffer:t,mediaSource:n}=this;if(!n)throw Error("createSourceBuffers called when mediaSource was null");for(let i in e)if(!t[i]){let s=e[i];if(!s)throw Error(`source buffer exists for track ${i}, however track does not`);let a=s.levelCodec||s.codec,o=`${s.container};codecs=${a}`;R.log(`[buffer-controller]: creating sourceBuffer(${o})`);try{let l=t[i]=n.addSourceBuffer(o),c=i;this.addBufferListener(c,"updatestart",this._onSBUpdateStart),this.addBufferListener(c,"updateend",this._onSBUpdateEnd),this.addBufferListener(c,"error",this._onSBUpdateError),this.tracks[i]={buffer:l,codec:a,container:s.container,levelCodec:s.levelCodec,metadata:s.metadata,id:s.id}}catch(l){R.error(`[buffer-controller]: error while trying to add sourceBuffer: ${l.message}`),this.hls.trigger(v.ERROR,{type:J.MEDIA_ERROR,details:F.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:l,mimeType:o})}}}_onSBUpdateStart(e){let{operationQueue:t}=this;t.current(e).onStart()}_onSBUpdateEnd(e){let{operationQueue:t}=this;t.current(e).onComplete(),t.shiftAndExecuteNext(e)}_onSBUpdateError(e,t){let n=new Error(`${e} SourceBuffer error`);R.error(`[buffer-controller]: ${n}`,t),this.hls.trigger(v.ERROR,{type:J.MEDIA_ERROR,details:F.BUFFER_APPENDING_ERROR,error:n,fatal:!1});let i=this.operationQueue.current(e);i&&i.onError(t)}removeExecutor(e,t,n){let{media:i,mediaSource:s,operationQueue:a,sourceBuffer:o}=this,l=o[e];if(!i||!s||!l){R.warn(`[buffer-controller]: Attempting to remove from the ${e} SourceBuffer, but it does not exist`),a.shiftAndExecuteNext(e);return}let c=X(i.duration)?i.duration:Infinity,u=X(s.duration)?s.duration:Infinity,d=Math.max(0,t),h=Math.min(n,c,u);h>d&&!l.ending?(l.ended=!1,R.log(`[buffer-controller]: Removing [${d},${h}] from the ${e} SourceBuffer`),l.remove(d,h)):a.shiftAndExecuteNext(e)}appendExecutor(e,t){let{operationQueue:n,sourceBuffer:i}=this,s=i[t];if(!s){R.warn(`[buffer-controller]: Attempting to append to the ${t} SourceBuffer, but it does not exist`),n.shiftAndExecuteNext(t);return}s.ended=!1,s.appendBuffer(e)}blockBuffers(e,t=this.getSourceBufferTypes()){if(!t.length){R.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);return}let{operationQueue:n}=this,i=t.map(s=>n.appendBlocker(s));Promise.all(i).then(()=>{e(),t.forEach(s=>{let a=this.sourceBuffer[s];a!=null&&a.updating||n.shiftAndExecuteNext(s)})})}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(e,t,n){let i=this.sourceBuffer[e];if(!i)return;let s=n.bind(this,e);this.listeners[e].push({event:t,listener:s}),i.addEventListener(t,s)}removeBufferListeners(e){let t=this.sourceBuffer[e];!t||this.listeners[e].forEach(n=>{t.removeEventListener(n.event,n.listener)})}},eh={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},th=function(e){let t=e;return eh.hasOwnProperty(e)&&(t=eh[e]),String.fromCharCode(t)},kt=15,rn=100,Sy={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},_y={17:2,18:4,21:6,22:8,23:10,19:13,20:15},Ay={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},wy={25:2,26:4,29:6,30:8,31:10,27:13,28:15},Ly=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],nh=class{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){let n=typeof t=="function"?t():t;R.log(`${this.time} [${e}] ${n}`)}}},On=function(e){let t=[];for(let n=0;n<e.length;n++)t.push(e[n].toString(16));return t},za=class{constructor(e,t,n,i,s){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=e||"white",this.underline=t||!1,this.italics=n||!1,this.background=i||"black",this.flash=s||!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){let t=["foreground","underline","italics","background","flash"];for(let n=0;n<t.length;n++){let i=t[n];e.hasOwnProperty(i)&&(this[i]=e[i])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}},ih=class{constructor(e,t,n,i,s,a){this.uchar=void 0,this.penState=void 0,this.uchar=e||" ",this.penState=new za(t,n,i,s,a)}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}},rh=class{constructor(e){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(let t=0;t<rn;t++)this.chars.push(new ih);this.logger=e,this.pos=0,this.currPenState=new za}equals(e){let t=!0;for(let n=0;n<rn;n++)if(!this.chars[n].equals(e.chars[n])){t=!1;break}return t}copy(e){for(let t=0;t<rn;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<rn;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>rn&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=rn)}moveCursor(e){let t=this.pos+e;if(e>1)for(let n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();let t=th(e);if(this.pos>=rn){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<rn;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){let e=[],t=!0;for(let n=0;n<rn;n++){let i=this.chars[n].uchar;i!==" "&&(t=!1),e.push(i)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}},ls=class{constructor(e){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(let t=0;t<kt;t++)this.rows.push(new rh(e));this.logger=e,this.currRow=kt-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}reset(){for(let e=0;e<kt;e++)this.rows[e].clear();this.currRow=kt-1}equals(e){let t=!0;for(let n=0;n<kt;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}copy(e){for(let t=0;t<kt;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<kt;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+JSON.stringify(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let o=0;o<kt;o++)this.rows[o].clear();let s=this.currRow+1-this.nrRollUpRows,a=this.lastOutputScreen;if(a){let o=a.rows[s].cueStartTime,l=this.logger.time;if(o&&l!==null&&o<l)for(let c=0;c<this.nrRollUpRows;c++)this.rows[t-this.nrRollUpRows+c+1].copy(a.rows[s+c])}}this.currRow=t;let n=this.rows[this.currRow];if(e.indent!==null){let s=e.indent,a=Math.max(s-1,0);n.setCursor(e.indent),e.color=n.chars[a].penState.foreground}let i={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(i)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());let e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;let t=[],n="",i=-1;for(let s=0;s<kt;s++){let a=this.rows[s].getTextString();a&&(i=s+1,e?t.push("Row "+i+": '"+a+"'"):t.push(a.trim()))}return t.length>0&&(e?n="["+t.join(" | ")+"]":n=t.join(`
`)),n}getTextAndFormat(){return this.rows}},Ya=class{constructor(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new ls(n),this.nonDisplayedMemory=new ls(n),this.lastOutputScreen=new ls(n),this.currRollUpRow=this.displayedMemory.rows[kt-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[kt-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let n=0;n<e.length;n++)this.writeScreen.insertChar(e[n]);let t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){let e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){let t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{let n=Math.floor(e/2)-16,i=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=i[n]}this.logger.log(2,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){let t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}},Xa=class{constructor(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;let i=new nh;this.channels=[null,new Ya(e,t,i),new Ya(e+1,n,i)],this.cmdHistory=ah(),this.logger=i}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){let n,i,s,a=!1;this.logger.time=e;for(let o=0;o<t.length;o+=2)if(i=t[o]&127,s=t[o+1]&127,!(i===0&&s===0)){if(this.logger.log(3,"["+On([t[o],t[o+1]])+"] -> ("+On([i,s])+")"),n=this.parseCmd(i,s),n||(n=this.parseMidrow(i,s)),n||(n=this.parsePAC(i,s)),n||(n=this.parseBackgroundAttributes(i,s)),!n&&(a=this.parseChars(i,s),a)){let l=this.currentChannel;l&&l>0?this.channels[l].insertChars(a):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!n&&!a&&this.logger.log(2,"Couldn't parse cleaned data "+On([i,s])+" orig: "+On([t[o],t[o+1]]))}}parseCmd(e,t){let{cmdHistory:n}=this,i=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,s=(e===23||e===31)&&t>=33&&t<=35;if(!(i||s))return!1;if(sh(e,t,n))return ii(null,null,n),this.logger.log(3,"Repeated command ("+On([e,t])+") is dropped"),!0;let a=e===20||e===21||e===23?1:2,o=this.channels[a];return e===20||e===21||e===28||e===29?t===32?o.ccRCL():t===33?o.ccBS():t===34?o.ccAOF():t===35?o.ccAON():t===36?o.ccDER():t===37?o.ccRU(2):t===38?o.ccRU(3):t===39?o.ccRU(4):t===40?o.ccFON():t===41?o.ccRDC():t===42?o.ccTR():t===43?o.ccRTD():t===44?o.ccEDM():t===45?o.ccCR():t===46?o.ccENM():t===47&&o.ccEOC():o.ccTO(t-32),ii(e,t,n),this.currentChannel=a,!0}parseMidrow(e,t){let n=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?n=1:n=2,n!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;let i=this.channels[n];return i?(i.ccMIDROW(t),this.logger.log(3,"MIDROW ("+On([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let n,i=this.cmdHistory,s=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,a=(e===16||e===24)&&t>=64&&t<=95;if(!(s||a))return!1;if(sh(e,t,i))return ii(null,null,i),!0;let o=e<=23?1:2;t>=64&&t<=95?n=o===1?Sy[e]:Ay[e]:n=o===1?_y[e]:wy[e];let l=this.channels[o];return l?(l.setPAC(this.interpretPAC(n,t)),ii(e,t,i),this.currentChannel=o,!0):!1}interpretPAC(e,t){let n,i={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?n=t-96:n=t-64,i.underline=(n&1)==1,n<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(i.italics=!0,i.color="white"):i.indent=Math.floor((n-16)/2)*4,i}parseChars(e,t){let n,i=null,s=null;if(e>=25?(n=2,s=e-8):(n=1,s=e),s>=17&&s<=19){let a;s===17?a=t+80:s===18?a=t+112:a=t+144,this.logger.log(2,"Special char '"+th(a)+"' in channel "+n),i=[a]}else e>=32&&e<=127&&(i=t===0?[e]:[e,t]);if(i){let a=On(i);this.logger.log(3,"Char codes =  "+a.join(",")),ii(e,t,this.cmdHistory)}return i}parseBackgroundAttributes(e,t){let n=(e===16||e===24)&&t>=32&&t<=47,i=(e===23||e===31)&&t>=45&&t<=47;if(!(n||i))return!1;let s,a={};e===16||e===24?(s=Math.floor((t-32)/2),a.background=Ly[s],t%2==1&&(a.background=a.background+"_semi")):t===45?a.background="transparent":(a.foreground="black",t===47&&(a.underline=!0));let o=e<=23?1:2;return this.channels[o].setBkgData(a),ii(e,t,this.cmdHistory),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){let t=this.channels[e];t&&t.reset()}this.cmdHistory=ah()}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){let n=this.channels[t];n&&n.cueSplitAtTime(e)}}};function ii(r,e,t){t.a=r,t.b=e}function sh(r,e,t){return t.a===r&&t.b===e}function ah(){return{a:null,b:null}}var Vi=class{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,n){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}},Qa=function(){if(typeof self!="undefined"&&self.VTTCue)return self.VTTCue;let r=["","lr","rl"],e=["start","middle","end","left","right"];function t(o,l){if(typeof l!="string"||!Array.isArray(o))return!1;let c=l.toLowerCase();return~o.indexOf(c)?c:!1}function n(o){return t(r,o)}function i(o){return t(e,o)}function s(o,...l){let c=1;for(;c<arguments.length;c++){let u=arguments[c];for(let d in u)o[d]=u[d]}return o}function a(o,l,c){let u=this,d={enumerable:!0};u.hasBeenReset=!1;let h="",f=!1,m=o,p=l,g=c,T=null,_="",y=!0,b="auto",E="start",C=50,w="middle",O=50,S="middle";Object.defineProperty(u,"id",s({},d,{get:function(){return h},set:function(I){h=""+I}})),Object.defineProperty(u,"pauseOnExit",s({},d,{get:function(){return f},set:function(I){f=!!I}})),Object.defineProperty(u,"startTime",s({},d,{get:function(){return m},set:function(I){if(typeof I!="number")throw new TypeError("Start time must be set to a number.");m=I,this.hasBeenReset=!0}})),Object.defineProperty(u,"endTime",s({},d,{get:function(){return p},set:function(I){if(typeof I!="number")throw new TypeError("End time must be set to a number.");p=I,this.hasBeenReset=!0}})),Object.defineProperty(u,"text",s({},d,{get:function(){return g},set:function(I){g=""+I,this.hasBeenReset=!0}})),Object.defineProperty(u,"region",s({},d,{get:function(){return T},set:function(I){T=I,this.hasBeenReset=!0}})),Object.defineProperty(u,"vertical",s({},d,{get:function(){return _},set:function(I){let N=n(I);if(N===!1)throw new SyntaxError("An invalid or illegal string was specified.");_=N,this.hasBeenReset=!0}})),Object.defineProperty(u,"snapToLines",s({},d,{get:function(){return y},set:function(I){y=!!I,this.hasBeenReset=!0}})),Object.defineProperty(u,"line",s({},d,{get:function(){return b},set:function(I){if(typeof I!="number"&&I!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");b=I,this.hasBeenReset=!0}})),Object.defineProperty(u,"lineAlign",s({},d,{get:function(){return E},set:function(I){let N=i(I);if(!N)throw new SyntaxError("An invalid or illegal string was specified.");E=N,this.hasBeenReset=!0}})),Object.defineProperty(u,"position",s({},d,{get:function(){return C},set:function(I){if(I<0||I>100)throw new Error("Position must be between 0 and 100.");C=I,this.hasBeenReset=!0}})),Object.defineProperty(u,"positionAlign",s({},d,{get:function(){return w},set:function(I){let N=i(I);if(!N)throw new SyntaxError("An invalid or illegal string was specified.");w=N,this.hasBeenReset=!0}})),Object.defineProperty(u,"size",s({},d,{get:function(){return O},set:function(I){if(I<0||I>100)throw new Error("Size must be between 0 and 100.");O=I,this.hasBeenReset=!0}})),Object.defineProperty(u,"align",s({},d,{get:function(){return S},set:function(I){let N=i(I);if(!N)throw new SyntaxError("An invalid or illegal string was specified.");S=N,this.hasBeenReset=!0}})),u.displayState=void 0}return a.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},a}(),oh=class{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}};function lh(r){function e(n,i,s,a){return(n|0)*3600+(i|0)*60+(s|0)+parseFloat(a||0)}let t=r.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}var ch=class{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,n){for(let i=0;i<n.length;++i)if(t===n[i]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){let n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}};function uh(r,e,t,n){let i=n?r.split(n):[r];for(let s in i){if(typeof i[s]!="string")continue;let a=i[s].split(t);if(a.length!==2)continue;let o=a[0],l=a[1];e(o,l)}}var Ja=new Qa(0,0,""),cs=Ja.align==="middle"?"middle":"center";function Iy(r,e,t){let n=r;function i(){let o=lh(r);if(o===null)throw new Error("Malformed timestamp: "+n);return r=r.replace(/^[^\sa-zA-Z-]+/,""),o}function s(o,l){let c=new ch;uh(o,function(h,f){let m;switch(h){case"region":for(let p=t.length-1;p>=0;p--)if(t[p].id===f){c.set(h,t[p].region);break}break;case"vertical":c.alt(h,f,["rl","lr"]);break;case"line":m=f.split(","),c.integer(h,m[0]),c.percent(h,m[0])&&c.set("snapToLines",!1),c.alt(h,m[0],["auto"]),m.length===2&&c.alt("lineAlign",m[1],["start",cs,"end"]);break;case"position":m=f.split(","),c.percent(h,m[0]),m.length===2&&c.alt("positionAlign",m[1],["start",cs,"end","line-left","line-right","auto"]);break;case"size":c.percent(h,f);break;case"align":c.alt(h,f,["start",cs,"end","left","right"]);break}},/:/,/\s/),l.region=c.get("region",null),l.vertical=c.get("vertical","");let u=c.get("line","auto");u==="auto"&&Ja.line===-1&&(u=-1),l.line=u,l.lineAlign=c.get("lineAlign","start"),l.snapToLines=c.get("snapToLines",!0),l.size=c.get("size",100),l.align=c.get("align",cs);let d=c.get("position","auto");d==="auto"&&Ja.position===50&&(d=l.align==="start"||l.align==="left"?0:l.align==="end"||l.align==="right"?100:50),l.position=d}function a(){r=r.replace(/^\s+/,"")}if(a(),e.startTime=i(),a(),r.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+n);r=r.slice(3),a(),e.endTime=i(),a(),s(r,e)}function dh(r){return r.replace(/<br(?: \/)?>/gi,`
`)}var hh=class{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new oh,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){let t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function n(){let s=t.buffer,a=0;for(s=dh(s);a<s.length&&s[a]!=="\r"&&s[a]!==`
`;)++a;let o=s.slice(0,a);return s[a]==="\r"&&++a,s[a]===`
`&&++a,t.buffer=s.slice(a),o}function i(s){uh(s,function(a,o){},/:/)}try{let s="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;s=n();let o=s.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!(o!=null&&o[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let a=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(a?a=!1:s=n(),t.state){case"HEADER":/:/.test(s)?i(s):s||(t.state="ID");continue;case"NOTE":s||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(s)){t.state="NOTE";break}if(!s)continue;if(t.cue=new Qa(0,0,""),t.state="CUE",s.indexOf("-->")===-1){t.cue.id=s;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{Iy(s,t.cue,t.regionList)}catch(o){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{let o=s.indexOf("-->")!==-1;if(!s||o&&(a=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=s}continue;case"BADCUE":s||(t.state="ID")}}}catch(s){t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){let e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}},Cy=/\r\n|\n\r|\n|\r/g,Za=function(e,t,n=0){return e.slice(n,n+t.length)===t},Ry=function(e){let t=parseInt(e.slice(-3)),n=parseInt(e.slice(-6,-4)),i=parseInt(e.slice(-9,-7)),s=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!X(t)||!X(n)||!X(i)||!X(s))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*n,t+=60*1e3*i,t+=60*60*1e3*s,t},eo=function(e){let t=5381,n=e.length;for(;n;)t=t*33^e.charCodeAt(--n);return(t>>>0).toString()};function to(r,e,t){return eo(r.toString())+eo(e.toString())+eo(t)}var Py=function(e,t,n){let i=e[t],s=e[i.prevCC];if(!s||!s.new&&i.new){e.ccOffset=e.presentationOffset=i.start,i.new=!1;return}for(;(a=s)!=null&&a.new;){var a;e.ccOffset+=i.start-s.start,i.new=!1,i=s,s=e[i.prevCC]}e.presentationOffset=n};function ky(r,e,t,n,i,s,a){let o=new hh,l=Nt(new Uint8Array(r)).trim().replace(Cy,`
`).split(`
`),c=[],u=cy(e.baseTime,e.timescale),d="00:00.000",h=0,f=0,m,p=!0;o.oncue=function(g){let T=t[n],_=t.ccOffset,y=(h-u)/9e4;T!=null&&T.new&&(f!==void 0?_=t.ccOffset=T.start:Py(t,n,y)),y&&(_=y-t.presentationOffset);let b=g.endTime-g.startTime,E=vt((g.startTime+_-f)*9e4,i*9e4)/9e4;g.startTime=Math.max(E,0),g.endTime=Math.max(E+b,0);let C=g.text.trim();g.text=decodeURIComponent(encodeURIComponent(C)),g.id||(g.id=to(g.startTime,g.endTime,C)),g.endTime>0&&c.push(g)},o.onparsingerror=function(g){m=g},o.onflush=function(){if(m){a(m);return}s(c)},l.forEach(g=>{if(p)if(Za(g,"X-TIMESTAMP-MAP=")){p=!1,g.slice(16).split(",").forEach(T=>{Za(T,"LOCAL:")?d=T.slice(6):Za(T,"MPEGTS:")&&(h=parseInt(T.slice(7)))});try{f=Ry(d)/1e3}catch(T){m=T}return}else g===""&&(p=!1);o.parse(g+`
`)}),o.flush()}var no="stpp.ttml.im1t",fh=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,mh=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,Dy={left:"start",center:"center",right:"end",start:"start",end:"end"};function ph(r,e,t,n){let i=he(new Uint8Array(r),["mdat"]);if(i.length===0){n(new Error("Could not parse IMSC1 mdat"));return}let s=i.map(o=>Nt(o)),a=ly(e.baseTime,1,e.timescale);try{s.forEach(o=>t(xy(o,a)))}catch(o){n(o)}}function xy(r,e){let i=new DOMParser().parseFromString(r,"text/xml").getElementsByTagName("tt")[0];if(!i)throw new Error("Invalid ttml");let s={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},a=Object.keys(s).reduce((d,h)=>(d[h]=i.getAttribute(`ttp:${h}`)||s[h],d),{}),o=i.getAttribute("xml:space")!=="preserve",l=gh(io(i,"styling","style")),c=gh(io(i,"layout","region")),u=io(i,"body","[begin]");return[].map.call(u,d=>{let h=vh(d,o);if(!h||!d.hasAttribute("begin"))return null;let f=ro(d.getAttribute("begin"),a),m=ro(d.getAttribute("dur"),a),p=ro(d.getAttribute("end"),a);if(f===null)throw yh(d);if(p===null){if(m===null)throw yh(d);p=f+m}let g=new Qa(f-e,p-e,h);g.id=to(g.startTime,g.endTime,g.text);let T=c[d.getAttribute("region")],_=l[d.getAttribute("style")],y=Oy(T,_,l),{textAlign:b}=y;if(b){let E=Dy[b];E&&(g.lineAlign=E),g.align=b}return Oe(g,y),g}).filter(d=>d!==null)}function io(r,e,t){let n=r.getElementsByTagName(e)[0];return n?[].slice.call(n.querySelectorAll(t)):[]}function gh(r){return r.reduce((e,t)=>{let n=t.getAttribute("xml:id");return n&&(e[n]=t),e},{})}function vh(r,e){return[].slice.call(r.childNodes).reduce((t,n,i)=>{var s;return n.nodeName==="br"&&i?t+`
`:(s=n.childNodes)!=null&&s.length?vh(n,e):e?t+n.textContent.trim().replace(/\s+/g," "):t+n.textContent},"")}function Oy(r,e,t){let n="http://www.w3.org/ns/ttml#styling",i=null,s=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],a=r!=null&&r.hasAttribute("style")?r.getAttribute("style"):null;return a&&t.hasOwnProperty(a)&&(i=t[a]),s.reduce((o,l)=>{let c=so(e,n,l)||so(r,n,l)||so(i,n,l);return c&&(o[l]=c),o},{})}function so(r,e,t){return r&&r.hasAttributeNS(e,t)?r.getAttributeNS(e,t):null}function yh(r){return new Error(`Could not parse ttml timestamp ${r}`)}function ro(r,e){if(!r)return null;let t=lh(r);return t===null&&(fh.test(r)?t=My(r,e):mh.test(r)&&(t=Fy(r,e))),t}function My(r,e){let t=fh.exec(r),n=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+n/e.frameRate}function Fy(r,e){let t=mh.exec(r),n=Number(t[1]);switch(t[2]){case"h":return n*3600;case"m":return n*60;case"ms":return n*1e3;case"f":return n/e.frameRate;case"t":return n/e.tickRate}return n}var bh=class{constructor(e){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Th(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){let t=new Vi(this,"textTrack1"),n=new Vi(this,"textTrack2"),i=new Vi(this,"textTrack3"),s=new Vi(this,"textTrack4");this.cea608Parser1=new Xa(1,t,n),this.cea608Parser2=new Xa(3,i,s)}e.on(v.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(v.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(v.MANIFEST_LOADING,this.onManifestLoading,this),e.on(v.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(v.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(v.FRAG_LOADING,this.onFragLoading,this),e.on(v.FRAG_LOADED,this.onFragLoaded,this),e.on(v.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(v.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(v.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(v.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(v.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){let{hls:e}=this;e.off(v.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(v.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(v.MANIFEST_LOADING,this.onManifestLoading,this),e.off(v.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(v.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(v.FRAG_LOADING,this.onFragLoading,this),e.off(v.FRAG_LOADED,this.onFragLoaded,this),e.off(v.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(v.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(v.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(v.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(v.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null}addCues(e,t,n,i,s){let a=!1;for(let o=s.length;o--;){let l=s[o],c=By(l[0],l[1],t,n);if(c>=0&&(l[0]=Math.min(l[0],t),l[1]=Math.max(l[1],n),a=!0,c/(n-t)>.5))return}if(a||s.push([t,n]),this.config.renderTextTracksNatively){let o=this.captionsTracks[e];this.Cues.newCue(o,t,n,i)}else{let o=this.Cues.newCue(null,t,n,i);this.hls.trigger(v.CUES_PARSED,{type:"captions",cues:o,track:e})}}onInitPtsFound(e,{frag:t,id:n,initPTS:i,timescale:s}){let{unparsedVttFrags:a}=this;n==="main"&&(this.initPTS[t.cc]={baseTime:i,timescale:s}),a.length&&(this.unparsedVttFrags=[],a.forEach(o=>{this.onFragLoaded(v.FRAG_LOADED,o)}))}getExistingTrack(e){let{media:t}=this;if(t)for(let n=0;n<t.textTracks.length;n++){let i=t.textTracks[n];if(i[e])return i}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;let{captionsProperties:t,captionsTracks:n,media:i}=this,{label:s,languageCode:a}=t[e],o=this.getExistingTrack(e);if(o)n[e]=o,ei(n[e]),ju(n[e],i);else{let l=this.createTextTrack("captions",s,a);l&&(l[e]=!0,n[e]=l)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;let t=this.captionsProperties[e];if(!t)return;let n=t.label,i={_id:e,label:n,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=i,this.hls.trigger(v.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[i]})}createTextTrack(e,t,n){let i=this.media;if(!!i)return i.addTextTrack(e,t,n)}onMediaAttaching(e,t){this.media=t.media,this._cleanTracks()}onMediaDetaching(){let{captionsTracks:e}=this;Object.keys(e).forEach(t=>{ei(e[t]),delete e[t]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Th(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){let{media:e}=this;if(!e)return;let t=e.textTracks;if(t)for(let n=0;n<t.length;n++)ei(t[n])}onSubtitleTracksUpdated(e,t){let n=t.subtitleTracks||[],i=n.some(s=>s.textCodec===no);if(this.config.enableWebVTT||i&&this.config.enableIMSC1){if(Wd(this.tracks,n)){this.tracks=n;return}if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){let a=this.media?this.media.textTracks:null;this.tracks.forEach((o,l)=>{let c;if(a&&l<a.length){let u=null;for(let d=0;d<a.length;d++)if(Ny(a[d],o)){u=a[d];break}u&&(c=u)}if(c)ei(c);else{let u=this._captionsOrSubtitlesFromCharacteristics(o);c=this.createTextTrack(u,o.name,o.lang),c&&(c.mode="disabled")}c&&(c.groupId=o.groupId,this.textTracks.push(c))})}else if(this.tracks.length){let a=this.tracks.map(o=>({label:o.name,kind:o.type.toLowerCase(),default:o.default,subtitleTrack:o}));this.hls.trigger(v.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:a})}}}_captionsOrSubtitlesFromCharacteristics(e){if(e.attrs.CHARACTERISTICS){let t=/transcribes-spoken-dialog/gi.test(e.attrs.CHARACTERISTICS),n=/describes-music-and-sound/gi.test(e.attrs.CHARACTERISTICS);if(t&&n)return"captions"}return"subtitles"}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(n=>{let i=/(?:CC|SERVICE)([1-4])/.exec(n.instreamId);if(!i)return;let s=`textTrack${i[1]}`,a=this.captionsProperties[s];!a||(a.label=n.name,n.lang&&(a.languageCode=n.lang),a.media=n)})}closedCaptionsForLevel(e){let t=this.hls.levels[e.level];return t==null?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){let{cea608Parser1:n,cea608Parser2:i,lastSn:s,lastPartIndex:a}=this;if(!(!this.enabled||!(n&&i))&&t.frag.type===Z.MAIN){var o,l;let c=t.frag.sn,u=(o=t==null||(l=t.part)==null?void 0:l.index)!=null?o:-1;c===s+1||c===s&&u===a+1||(n.reset(),i.reset()),this.lastSn=c,this.lastPartIndex=u}}onFragLoaded(e,t){let{frag:n,payload:i}=t,{initPTS:s,unparsedVttFrags:a}=this;if(n.type===Z.SUBTITLE)if(i.byteLength){if(!s[n.cc]){a.push(t),s.length&&this.hls.trigger(v.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Missing initial subtitle PTS")});return}let o=n.decryptdata,l="stats"in t;if(o==null||!o.encrypted||l){let c=this.tracks[n.level],u=this.vttCCs;u[n.cc]||(u[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),c&&c.textCodec===no?this._parseIMSC1(n,i):this._parseVTTs(n,i,u)}}else this.hls.trigger(v.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){let n=this.hls;ph(t,this.initPTS[e.cc],i=>{this._appendCues(i,e.level),n.trigger(v.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},i=>{R.log(`Failed to parse IMSC1: ${i}`),n.trigger(v.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:i})})}_parseVTTs(e,t,n){var i;let s=this.hls,a=(i=e.initSegment)!=null&&i.data?Dn(e.initSegment.data,new Uint8Array(t)):t;ky(a,this.initPTS[e.cc],n,e.cc,e.start,o=>{this._appendCues(o,e.level),s.trigger(v.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},o=>{this._fallbackToIMSC1(e,t),R.log(`Failed to parse VTT cue: ${o}`),s.trigger(v.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:o})})}_fallbackToIMSC1(e,t){let n=this.tracks[e.level];n.textCodec||ph(t,this.initPTS[e.cc],()=>{n.textCodec=no,this._parseIMSC1(e,t)},()=>{n.textCodec="wvtt"})}_appendCues(e,t){let n=this.hls;if(this.config.renderTextTracksNatively){let i=this.textTracks[t];if(!i||i.mode==="disabled")return;e.forEach(s=>Hu(i,s))}else{let i=this.tracks[t];if(!i)return;let s=i.default?"default":"subtitles"+t;n.trigger(v.CUES_PARSED,{type:"subtitles",cues:e,track:s})}}onFragDecrypted(e,t){let{frag:n}=t;if(n.type===Z.SUBTITLE){if(!this.initPTS[n.cc]){this.unparsedVttFrags.push(t);return}this.onFragLoaded(v.FRAG_LOADED,t)}}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){let{cea608Parser1:n,cea608Parser2:i}=this;if(!this.enabled||!(n&&i))return;let{frag:s,samples:a}=t;if(!(s.type===Z.MAIN&&this.closedCaptionsForLevel(s)==="NONE"))for(let o=0;o<a.length;o++){let l=a[o].bytes;if(l){let c=this.extractCea608Data(l);n.addData(a[o].pts,c[0]),i.addData(a[o].pts,c[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:n,endOffsetSubtitles:i,type:s}){let{media:a}=this;if(!(!a||a.currentTime<n)){if(!s||s==="video"){let{captionsTracks:o}=this;Object.keys(o).forEach(l=>va(o[l],t,n))}if(this.config.renderTextTracksNatively&&t===0&&i!==void 0){let{textTracks:o}=this;Object.keys(o).forEach(l=>va(o[l],t,i))}}}extractCea608Data(e){let t=[[],[]],n=e[0]&31,i=2;for(let s=0;s<n;s++){let a=e[i++],o=127&e[i++],l=127&e[i++];if(o===0&&l===0)continue;if((4&a)!=0){let u=3&a;(u===0||u===1)&&(t[u].push(o),t[u].push(l))}}return t}};function Ny(r,e){return!!r&&r.label===e.name&&!(r.textTrack1||r.textTrack2)}function By(r,e,t,n){return Math.min(e,n)-Math.max(r,t)}function Th(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}var us=class{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){let{hls:e}=this;e.on(v.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(v.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(v.MANIFEST_PARSED,this.onManifestParsed,this),e.on(v.BUFFER_CODECS,this.onBufferCodecs,this),e.on(v.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){let{hls:e}=this;e.off(v.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(v.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(v.MANIFEST_PARSED,this.onManifestParsed,this),e.off(v.BUFFER_CODECS,this.onBufferCodecs,this),e.off(v.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){let n=this.hls.levels[t.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null}onManifestParsed(e,t){let n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){let e=this.hls.levels;if(e.length){let t=this.hls;t.autoLevelCapping=this.getMaxLevel(e.length-1),t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){let t=this.hls.levels;if(!t.length)return-1;let n=t.filter((i,s)=>this.isLevelAllowed(i)&&s<=e);return this.clientRect=null,us.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;let e=this.media,t={width:0,height:0};if(e){let n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,!t.width&&!t.height&&(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch(t){}return e}isLevelAllowed(e){return!this.restrictedLevels.some(n=>e.bitrate===n.bitrate&&e.width===n.width&&e.height===n.height)}static getMaxLevelByMediaSize(e,t,n){if(!(e!=null&&e.length))return-1;let i=(a,o)=>o?a.width!==o.width||a.height!==o.height:!0,s=e.length-1;for(let a=0;a<e.length;a+=1){let o=e[a];if((o.width>=t||o.height>=n)&&i(o,e[a+1])){s=a;break}}return s}},Eh=class{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(v.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(v.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){let n=this.hls.config;if(n.capLevelOnFPSDrop){let i=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=i,i&&typeof i.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}checkFPS(e,t,n){let i=performance.now();if(t){if(this.lastTime){let s=i-this.lastTime,a=n-this.lastDroppedFrames,o=t-this.lastDecodedFrames,l=1e3*a/s,c=this.hls;if(c.trigger(v.FPS_DROP,{currentDropped:a,currentDecoded:o,totalDroppedFrames:n}),l>0&&a>c.config.fpsDroppedMonitoringThreshold*o){let u=c.currentLevel;R.warn("drop FPS ratio greater than max allowed value for currentLevel: "+u),u>0&&(c.autoLevelCapping===-1||c.autoLevelCapping>=u)&&(u=u-1,c.trigger(v.FPS_DROP_LEVEL_CAPPING,{level:u,droppedLevel:c.currentLevel}),c.autoLevelCapping=u,this.streamController.nextLevelSwitch())}}this.lastTime=i,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}checkFPSInterval(){let e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){let t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}},ds="[eme]",Mn=class{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=Mn.CDMCleanupPromise?[Mn.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=R.debug.bind(R,ds),this.log=R.log.bind(R,ds),this.warn=R.warn.bind(R,ds),this.error=R.error.bind(R,ds),this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();let e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null}registerListeners(){this.hls.on(v.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(v.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(v.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(v.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(v.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(v.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(e){let{drmSystems:t,widevineLicenseUrl:n}=this.config,i=t[e];if(i)return i.licenseUrl;if(e===Ce.WIDEVINE&&n)return n;throw new Error(`no license server URL configured for key-system "${e}"`)}getServerCertificateUrl(e){let{drmSystems:t}=this.config,n=t[e];if(n)return n.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){let t=this.hls.levels,n=(a,o,l)=>!!a&&l.indexOf(a)===o,i=t.map(a=>a.audioCodec).filter(n),s=t.map(a=>a.videoCodec).filter(n);return i.length+s.length===0&&s.push("avc1.42e01e"),new Promise((a,o)=>{let l=c=>{let u=c.shift();this.getMediaKeysPromise(u,i,s).then(d=>a({keySystem:u,mediaKeys:d})).catch(d=>{c.length?l(c):d instanceof st?o(d):o(new st({type:J.KEY_SYSTEM_ERROR,details:F.KEY_SYSTEM_NO_ACCESS,error:d,fatal:!0},d.message))})};l(e)})}requestMediaKeySystemAccess(e,t){let{requestMediaKeySystemAccessFunc:n}=this.config;if(typeof n!="function"){let i=`Configured requestMediaKeySystemAccess is not a function ${n}`;return vu===null&&self.location.protocol==="http:"&&(i=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(i))}return n(e,t)}getMediaKeysPromise(e,t,n){let i=Bg(e,t,n,this.config.drmSystemOptions),s=this.keySystemAccessPromises[e],a=s==null?void 0:s.keySystemAccess;if(!a){this.log(`Requesting encrypted media "${e}" key-system access with config: ${JSON.stringify(i)}`),a=this.requestMediaKeySystemAccess(e,i);let o=this.keySystemAccessPromises[e]={keySystemAccess:a};return a.catch(l=>{this.log(`Failed to obtain access to key-system "${e}": ${l}`)}),a.then(l=>{this.log(`Access for key-system "${l.keySystem}" obtained`);let c=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),o.mediaKeys=l.createMediaKeys().then(u=>(this.log(`Media-keys created for "${e}"`),c.then(d=>d?this.setMediaKeysServerCertificate(u,e,d):u))),o.mediaKeys.catch(u=>{this.error(`Failed to create media-keys for "${e}"}: ${u}`)}),o.mediaKeys})}return a.then(()=>s.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:n}){this.log(`Creating key-system session "${t}" keyId: ${Bt.hexDump(e.keyId||[])}`);let i=n.createSession(),s={decryptdata:e,keySystem:t,mediaKeys:n,mediaKeysSession:i,keyStatus:"status-pending"};return this.mediaKeySessions.push(s),s}renewKeySession(e){let t=e.decryptdata;if(t.pssh){let n=this.createMediaKeySessionContext(e),i=this.getKeyIdString(t),s="cenc";this.keyIdToKeySessionPromise[i]=this.generateRequestWithPreferredKeySession(n,s,t.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(e.keyId===null)throw new Error("keyId is null");return Bt.hexDump(e.keyId)}updateKeySession(e,t){var n;let i=e.mediaKeysSession;return this.log(`Updating key-session "${i.sessionId}" for keyID ${Bt.hexDump(((n=e.decryptdata)==null?void 0:n.keyId)||[])}
      } (data length: ${t&&t.byteLength})`),i.update(t)}selectKeySystemFormat(e){let t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){return new Promise((t,n)=>{let i=ua(this.config),s=e.map(mu).filter(a=>!!a&&i.indexOf(a)!==-1);return this.getKeySystemSelectionPromise(s).then(({keySystem:a})=>{let o=gu(a);o?t(o):n(new Error(`Unable to find format for key-system "${a}"`))}).catch(n)})}loadKey(e){let t=e.keyInfo.decryptdata,n=this.getKeyIdString(t),i=`(keyId: ${n} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${i}`);let s=this.keyIdToKeySessionPromise[n];return s||(s=this.keyIdToKeySessionPromise[n]=this.getKeySystemForKeyPromise(t).then(({keySystem:a,mediaKeys:o})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${i}`),this.attemptSetMediaKeys(a,o).then(()=>{this.throwIfDestroyed();let l=this.createMediaKeySessionContext({keySystem:a,mediaKeys:o,decryptdata:t}),c="cenc";return this.generateRequestWithPreferredKeySession(l,c,t.pssh,"playlist-key")}))),s.catch(a=>this.handleError(a))),s}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){!this.hls||(this.error(e.message),e instanceof st?this.hls.trigger(v.ERROR,e.data):this.hls.trigger(v.ERROR,{type:J.KEY_SYSTEM_ERROR,details:F.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){let t=this.getKeyIdString(e),n=this.keyIdToKeySessionPromise[t];if(!n){let i=mu(e.keyFormat),s=i?[i]:ua(this.config);return this.attemptKeySystemAccess(s)}return n}getKeySystemSelectionPromise(e){if(e.length||(e=ua(this.config)),e.length===0)throw new st({type:J.KEY_SYSTEM_ERROR,details:F.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}_onMediaEncrypted(e){let{initDataType:t,initData:n}=e;if(this.debug(`"${e.type}" event: init data type: "${t}"`),n===null)return;let i,s;if(t==="sinf"&&this.config.drmSystems[Ce.FAIRPLAY]){let u=Be(new Uint8Array(n));try{let d=ca(JSON.parse(u).sinf),h=wu(new Uint8Array(d));if(!h)return;i=h.subarray(8,24),s=Ce.FAIRPLAY}catch(d){this.warn('Failed to parse sinf "encrypted" event message initData');return}}else{let u=ov(n);if(u===null)return;u.version===0&&u.systemId===pu.WIDEVINE&&u.data&&(i=u.data.subarray(8,24)),s=Fg(u.systemId)}if(!s||!i)return;let a=Bt.hexDump(i),{keyIdToKeySessionPromise:o,mediaKeySessions:l}=this,c=o[a];for(let u=0;u<l.length;u++){let d=l[u],h=d.decryptdata;if(h.pssh||!h.keyId)continue;let f=Bt.hexDump(h.keyId);if(a===f||h.uri.replace(/-/g,"").indexOf(a)!==-1){c=o[f],delete o[f],h.pssh=new Uint8Array(n),h.keyId=i,c=o[a]=c.then(()=>this.generateRequestWithPreferredKeySession(d,t,n,"encrypted-event-key-match"));break}}c||(c=o[a]=this.getKeySystemSelectionPromise([s]).then(({keySystem:u,mediaKeys:d})=>{var h;this.throwIfDestroyed();let f=new Zn("ISO-23001-7",a,(h=gu(u))!=null?h:"");return f.pssh=new Uint8Array(n),f.keyId=i,this.attemptSetMediaKeys(u,d).then(()=>{this.throwIfDestroyed();let m=this.createMediaKeySessionContext({decryptdata:f,keySystem:u,mediaKeys:d});return this.generateRequestWithPreferredKeySession(m,t,n,"encrypted-event-no-match")})})),c.catch(u=>this.handleError(u))}_onWaitingForKey(e){this.log(`"${e.type}" event`)}attemptSetMediaKeys(e,t){let n=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);let i=Promise.all(n).then(()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.setMediaKeysQueue.push(i),i.then(()=>{this.log(`Media-keys set for "${e}"`),n.push(i),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(s=>n.indexOf(s)===-1)})}generateRequestWithPreferredKeySession(e,t,n,i){var s,a;let o=(s=this.config.drmSystems)==null||(a=s[e.keySystem])==null?void 0:a.generateRequest;if(o)try{let h=o.call(this.hls,t,n,e);if(!h)throw new Error("Invalid response from configured generateRequest filter");t=h.initDataType,n=e.decryptdata.pssh=h.initData?new Uint8Array(h.initData):null}catch(h){var l;if(this.warn(h.message),(l=this.hls)!=null&&l.config.debug)throw h}if(n===null)return this.log(`Skipping key-session request for "${i}" (no initData)`),Promise.resolve(e);let c=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${i}": ${c} (init data type: ${t} length: ${n?n.byteLength:null})`);let u=new Gi;e.mediaKeysSession.onmessage=h=>{let f=e.mediaKeysSession;if(!f){u.emit("error",new Error("invalid state"));return}let{messageType:m,message:p}=h;this.log(`"${m}" message event for session "${f.sessionId}" message size: ${p.byteLength}`),m==="license-request"||m==="license-renewal"?this.renewLicense(e,p).catch(g=>{this.handleError(g),u.emit("error",g)}):m==="license-release"?e.keySystem===Ce.FAIRPLAY&&(this.updateKeySession(e,fu("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${m}"`)},e.mediaKeysSession.onkeystatuseschange=h=>{if(!e.mediaKeysSession){u.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(e);let m=e.keyStatus;u.emit("keyStatus",m),m==="expired"&&(this.warn(`${e.keySystem} expired for key ${c}`),this.renewKeySession(e))};let d=new Promise((h,f)=>{u.on("error",f),u.on("keyStatus",m=>{m.startsWith("usable")?h():m==="output-restricted"?f(new st({type:J.KEY_SYSTEM_ERROR,details:F.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):m==="internal-error"?f(new st({type:J.KEY_SYSTEM_ERROR,details:F.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${m}"`)):m==="expired"?f(new Error("key expired while generating request")):this.warn(`unhandled key status change "${m}"`)})});return e.mediaKeysSession.generateRequest(t,n).then(()=>{var h;this.log(`Request generated for key-session "${(h=e.mediaKeysSession)==null?void 0:h.sessionId}" keyId: ${c}`)}).catch(h=>{throw new st({type:J.KEY_SYSTEM_ERROR,details:F.KEY_SYSTEM_NO_SESSION,error:h,fatal:!1},`Error generating key-session request: ${h}`)}).then(()=>d).catch(h=>{throw u.removeAllListeners(),this.removeSession(e),h}).then(()=>(u.removeAllListeners(),e))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((t,n)=>{this.log(`key status change "${t}" for keyStatuses keyId: ${Bt.hexDump("buffer"in n?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n))} session keyId: ${Bt.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t})}fetchServerCertificate(e){let t=this.config,n=t.loader,i=new n(t),s=this.getServerCertificateUrl(e);return s?(this.log(`Fetching serverCertificate for "${e}"`),new Promise((a,o)=>{let l={responseType:"arraybuffer",url:s},c=t.certLoadPolicy.default,u={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:(h,f,m,p)=>{a(h.data)},onError:(h,f,m,p)=>{o(new st({type:J.KEY_SYSTEM_ERROR,details:F.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:m,response:ze({url:l.url,data:void 0},h)},`"${e}" certificate request failed (${s}). Status: ${h.code} (${h.text})`))},onTimeout:(h,f,m)=>{o(new st({type:J.KEY_SYSTEM_ERROR,details:F.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:m,response:{url:l.url,data:void 0}},`"${e}" certificate request timed out (${s})`))},onAbort:(h,f,m)=>{o(new Error("aborted"))}};i.load(l,u,d)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,n){return new Promise((i,s)=>{e.setServerCertificate(n).then(a=>{this.log(`setServerCertificate ${a?"success":"not supported by CDM"} (${n==null?void 0:n.byteLength}) on "${t}"`),i(e)}).catch(a=>{s(new st({type:J.KEY_SYSTEM_ERROR,details:F.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:a,fatal:!0},a.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(n=>this.updateKeySession(e,new Uint8Array(n)).catch(i=>{throw new st({type:J.KEY_SYSTEM_ERROR,details:F.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:i,fatal:!0},i.message)}))}setupLicenseXHR(e,t,n,i){let s=this.config.licenseXhrSetup;return s?Promise.resolve().then(()=>{if(!n.decryptdata)throw new Error("Key removed");return s.call(this.hls,e,t,n,i)}).catch(a=>{if(!n.decryptdata)throw a;return e.open("POST",t,!0),s.call(this.hls,e,t,n,i)}).then(a=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:a||i})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:i}))}requestLicense(e,t){let n=this.config.keyLoadPolicy.default;return new Promise((i,s)=>{let a=this.getLicenseServerUrl(e.keySystem);this.log(`Sending license request to URL: ${a}`);let o=new XMLHttpRequest;o.responseType="arraybuffer",o.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return s(new Error("invalid state"));if(o.readyState===4)if(o.status===200){this._requestLicenseFailureCount=0;let l=o.response;this.log(`License received ${l instanceof ArrayBuffer?l.byteLength:l}`);let c=this.config.licenseResponseCallback;if(c)try{l=c.call(this.hls,o,a,e)}catch(u){this.error(u)}i(l)}else{let l=n.errorRetry,c=l?l.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>c||o.status>=400&&o.status<500)s(new st({type:J.KEY_SYSTEM_ERROR,details:F.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:o,response:{url:a,data:void 0,code:o.status,text:o.statusText}},`License Request XHR failed (${a}). Status: ${o.status} (${o.statusText})`));else{let u=c-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${u} attempts left`),this.requestLicense(e,t).then(i,s)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=o,this.setupLicenseXHR(o,a,e,t).then(({xhr:l,licenseChallenge:c})=>{l.send(c)})})}onMediaAttached(e,t){if(!this.config.emeEnabled)return;let n=t.media;this.media=n,n.addEventListener("encrypted",this.onMediaEncrypted),n.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){let e=this.media,t=this.mediaKeySessions;e&&(e.removeEventListener("encrypted",this.onMediaEncrypted),e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},Zn.clearKeyUriToKeyIdMap();let n=t.length;Mn.CDMCleanupPromise=Promise.all(t.map(i=>this.removeSession(i)).concat(e==null?void 0:e.setMediaKeys(null).catch(i=>{this.log(`Could not clear media keys: ${i}. media.src: ${e==null?void 0:e.src}`)}))).then(()=>{n&&(this.log("finished closing key sessions and clearing media keys"),t.length=0)}).catch(i=>{this.log(`Could not close sessions and clear media keys: ${i}. media.src: ${e==null?void 0:e.src}`)})}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){let n=t.reduce((i,s)=>(i.indexOf(s.keyFormat)===-1&&i.push(s.keyFormat),i),[]);this.log(`Selecting key-system from session-keys ${n.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(n)}}removeSession(e){let{mediaKeysSession:t,licenseXhr:n}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),t.onmessage=null,t.onkeystatuseschange=null,n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;let i=this.mediaKeySessions.indexOf(e);return i>-1&&this.mediaKeySessions.splice(i,1),t.remove().catch(s=>{this.log(`Could not remove session: ${s}`)}).then(()=>t.close()).catch(s=>{this.log(`Could not close session: ${s}`)})}}};Mn.CDMCleanupPromise=void 0;var st=class extends Error{constructor(e,t){super(t);this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}},Uy=1,Ze={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},$y="h",sn=class{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=i=>{try{this.apply(i,{ot:Ze.MANIFEST,su:!this.initialized})}catch(s){R.warn("Could not generate manifest CMCD data.",s)}},this.applyFragmentData=i=>{try{let s=i.frag,a=this.hls.levels[s.level],o=this.getObjectType(s),l={d:s.duration*1e3,ot:o};(o===Ze.VIDEO||o===Ze.AUDIO||o==Ze.MUXED)&&(l.br=a.bitrate/1e3,l.tb=this.getTopBandwidth(o)/1e3,l.bl=this.getBufferLength(o)),this.apply(i,l)}catch(s){R.warn("Could not generate segment CMCD data.",s)}},this.hls=e;let t=this.config=e.config,{cmcd:n}=t;n!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||sn.uuid(),this.cid=n.contentId,this.useHeaders=n.useHeaders===!0,this.registerListeners())}registerListeners(){let e=this.hls;e.on(v.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(v.MEDIA_DETACHED,this.onMediaDetached,this),e.on(v.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){let e=this.hls;e.off(v.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(v.MEDIA_DETACHED,this.onMediaDetached,this),e.off(v.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){!this.media||(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var n,i;this.audioBuffer=(n=t.tracks.audio)==null?void 0:n.buffer,this.videoBuffer=(i=t.tracks.video)==null?void 0:i.buffer}createData(){var e;return{v:Uy,sf:$y,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){Oe(t,this.createData());let n=t.ot===Ze.INIT||t.ot===Ze.VIDEO||t.ot===Ze.MUXED;if(this.starved&&n&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering),this.useHeaders){let i=sn.toHeaders(t);if(!Object.keys(i).length)return;e.headers||(e.headers={}),Oe(e.headers,i)}else{let i=sn.toQuery(t);if(!i)return;e.url=sn.appendQueryToUri(e.url,i)}}getObjectType(e){let{type:t}=e;if(t==="subtitle")return Ze.TIMED_TEXT;if(e.sn==="initSegment")return Ze.INIT;if(t==="audio")return Ze.AUDIO;if(t==="main")return this.hls.audioTracks.length?Ze.VIDEO:Ze.MUXED}getTopBandwidth(e){let t=0,n,i=this.hls;if(e===Ze.AUDIO)n=i.audioTracks;else{let s=i.maxAutoLevel,a=s>-1?s+1:i.levels.length;n=i.levels.slice(0,a)}for(let s of n)s.bitrate>t&&(t=s.bitrate);return t>0?t:NaN}getBufferLength(e){let t=this.hls.media,n=e===Ze.AUDIO?this.audioBuffer:this.videoBuffer;return!n||!t?NaN:_e.bufferInfo(n,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){let{pLoader:e}=this.config,t=this.applyPlaylistData,n=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new n(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,a,o){t(s),this.loader.load(s,a,o)}}}createFragmentLoader(){let{fLoader:e}=this.config,t=this.applyFragmentData,n=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new n(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,a,o){t(s),this.loader.load(s,a,o)}}}static uuid(){let e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}static serialize(e){let t=[],n=c=>!Number.isNaN(c)&&c!=null&&c!==""&&c!==!1,i=c=>Math.round(c),s=c=>i(c/100)*100,o={br:i,d:i,bl:s,dl:s,mtp:s,nor:c=>encodeURIComponent(c),rtp:s,tb:i},l=Object.keys(e||{}).sort();for(let c of l){let u=e[c];if(!n(u)||c==="v"&&u===1||c=="pr"&&u===1)continue;let d=o[c];d&&(u=d(u));let h=typeof u,f;c==="ot"||c==="sf"||c==="st"?f=`${c}=${u}`:h==="boolean"?f=c:h==="number"?f=`${c}=${u}`:f=`${c}=${JSON.stringify(u)}`,t.push(f)}return t.join(",")}static toHeaders(e){let t=Object.keys(e),n={},i=["Object","Request","Session","Status"],s=[{},{},{},{}],a={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3};for(let o of t){let l=a[o]!=null?a[o]:1;s[l][o]=e[o]}for(let o=0;o<s.length;o++){let l=sn.serialize(s[o]);l&&(n[`CMCD-${i[o]}`]=l)}return n}static toQuery(e){return`CMCD=${encodeURIComponent(sn.serialize(e))}`}static appendQueryToUri(e,t){if(!t)return e;let n=e.includes("?")?"&":"?";return`${e}${n}${t}`}},Gy=3e5,Sh=class{constructor(e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.log=R.log.bind(R,"[content-steering]:"),this.registerListeners()}registerListeners(){let e=this.hls;e.on(v.MANIFEST_LOADING,this.onManifestLoading,this),e.on(v.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(v.MANIFEST_PARSED,this.onManifestParsed,this),e.on(v.ERROR,this.onError,this)}unregisterListeners(){let e=this.hls;!e||(e.off(v.MANIFEST_LOADING,this.onManifestLoading,this),e.off(v.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(v.MANIFEST_PARSED,this.onManifestParsed,this),e.off(v.ERROR,this.onError,this))}startLoad(){if(this.started=!0,self.clearTimeout(this.reloadTimer),this.enabled&&this.uri)if(this.updated){let e=Math.max(this.timeToLoad*1e3-(performance.now()-this.updated),0);this.scheduleRefresh(this.uri,e)}else this.loadSteeringManifest(this.uri)}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),self.clearTimeout(this.reloadTimer)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){let t=this.levels;t&&(this.levels=t.filter(n=>n!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){let{contentSteering:n}=t;n!==null&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){let{errorAction:n}=t;if((n==null?void 0:n.action)===Qe.SendAlternateToPenaltyBox&&n.flags===gt.MoveAllAlternatesMatchingHost){let i=this.pathwayPriority,s=this.pathwayId;this.penalizedPathways[s]||(this.penalizedPathways[s]=performance.now()),!i&&this.levels&&(i=this.levels.reduce((a,o)=>(a.indexOf(o.pathwayId)===-1&&a.push(o.pathwayId),a),[])),i&&i.length>1&&(this.updatePathwayPriority(i),n.resolved=this.pathwayId!==s)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){let n=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${n}"`),t=this.getLevelsForPathway(n),this.pathwayId=n}return t.length!==e.length?(this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t):e}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this.pathwayPriority=e;let t,n=this.penalizedPathways,i=performance.now();Object.keys(n).forEach(s=>{i-n[s]>Gy&&delete n[s]});for(let s=0;s<e.length;s++){let a=e[s];if(n[a])continue;if(a===this.pathwayId)return;let o=this.hls.nextLoadLevel,l=this.hls.levels[o];if(t=this.getLevelsForPathway(a),t.length>0){this.log(`Setting Pathway to "${a}"`),this.pathwayId=a,this.hls.trigger(v.LEVELS_UPDATED,{levels:t});let c=this.hls.levels[o];l&&c&&this.levels&&(c.attrs["STABLE-VARIANT-ID"]!==l.attrs["STABLE-VARIANT-ID"]&&c.bitrate!==l.bitrate&&this.log(`Unstable Pathways change from bitrate ${l.bitrate} to ${c.bitrate}`),this.hls.nextLoadLevel=o);break}}}clonePathways(e){let t=this.levels;if(!t)return;let n={},i={};e.forEach(s=>{let{ID:a,"BASE-ID":o,"URI-REPLACEMENT":l}=s;if(t.some(u=>u.pathwayId===a))return;let c=this.getLevelsForPathway(o).map(u=>{let d=Oe({},u);d.details=void 0,d.url=Ah(u.uri,u.attrs["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",l);let h=new we(u.attrs);h["PATHWAY-ID"]=a;let f=h.AUDIO&&`${h.AUDIO}_clone_${a}`,m=h.SUBTITLES&&`${h.SUBTITLES}_clone_${a}`;f&&(n[h.AUDIO]=f,h.AUDIO=f),m&&(i[h.SUBTITLES]=m,h.SUBTITLES=m),d.attrs=h;let p=new ti(d);return Qr(p,"audio",f),Qr(p,"text",m),p});t.push(...c),_h(this.audioTracks,n,l,a),_h(this.subtitleTracks,i,l,a)})}loadSteeringManifest(e){let t=this.hls.config,n=t.loader;this.loader&&this.loader.destroy(),this.loader=new n(t);let i;try{i=new self.URL(e)}catch(u){this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(i.protocol!=="data:"){let u=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;i.searchParams.set("_HLS_pathway",this.pathwayId),i.searchParams.set("_HLS_throughput",""+u)}let s={responseType:"json",url:i.href},a=t.steeringManifestLoadPolicy.default,o=a.errorRetry||a.timeoutRetry||{},l={loadPolicy:a,timeout:a.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},c={onSuccess:(u,d,h,f)=>{this.log(`Loaded steering manifest: "${i}"`);let m=u.data;if(m.VERSION!==1){this.log(`Steering VERSION ${m.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=m.TTL;let{"RELOAD-URI":p,"PATHWAY-CLONES":g,"PATHWAY-PRIORITY":T}=m;if(p)try{this.uri=new self.URL(p,i).href}catch(_){this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${p}`);return}this.scheduleRefresh(this.uri||h.url),g&&this.clonePathways(g),T&&this.updatePathwayPriority(T)},onError:(u,d,h,f)=>{if(this.log(`Error loading steering manifest: ${u.code} ${u.text} (${d.url})`),this.stopLoad(),u.code===410){this.enabled=!1,this.log(`Steering manifest ${d.url} no longer available`);return}let m=this.timeToLoad*1e3;if(u.code===429){let p=this.loader;if(typeof(p==null?void 0:p.getResponseHeader)=="function"){let g=p.getResponseHeader("Retry-After");g&&(m=parseFloat(g)*1e3)}this.log(`Steering manifest ${d.url} rate limited`);return}this.scheduleRefresh(this.uri||d.url,m)},onTimeout:(u,d,h)=>{this.log(`Timeout loading steering manifest (${d.url})`),this.scheduleRefresh(this.uri||d.url)}};this.log(`Requesting steering manifest: ${i}`),this.loader.load(s,l,c)}scheduleRefresh(e,t=this.timeToLoad*1e3){self.clearTimeout(this.reloadTimer),this.reloadTimer=self.setTimeout(()=>{this.loadSteeringManifest(e)},t)}};function _h(r,e,t,n){!r||Object.keys(e).forEach(i=>{let s=r.filter(a=>a.groupId===i).map(a=>{let o=Oe({},a);return o.details=void 0,o.attrs=new we(o.attrs),o.url=o.attrs.URI=Ah(a.url,a.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),o.groupId=o.attrs["GROUP-ID"]=e[i],o.attrs["PATHWAY-ID"]=n,o});r.push(...s)})}function Ah(r,e,t,n){let{HOST:i,PARAMS:s,[t]:a}=n,o;e&&(o=a==null?void 0:a[e],o&&(r=o));let l=new self.URL(r);return i&&!o&&(l.host=i),s&&Object.keys(s).sort().forEach(c=>{c&&l.searchParams.set(c,s[c])}),l.href}var Vy=/^age:\s*[\d.]+\s*$/im,ao=class{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new Ni,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null}abortInternal(){let e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.loadInternal()}loadInternal(){let{config:e,context:t}=this;if(!e)return;let n=this.loader=new self.XMLHttpRequest,i=this.stats;i.loading.first=0,i.loaded=0;let s=this.xhrSetup;s?Promise.resolve().then(()=>{if(!this.stats.aborted)return s(n,t.url)}).catch(a=>(n.open("GET",t.url,!0),s(n,t.url))).then(()=>{this.stats.aborted||this.openAndSendXhr(n,t,e)}).catch(a=>{this.callbacks.onError({code:n.status,text:a.message},t,n,i)}):this.openAndSendXhr(n,t,e)}openAndSendXhr(e,t,n){e.readyState||e.open("GET",t.url,!0);let i=this.context.headers,{maxTimeToFirstByteMs:s,maxLoadTimeMs:a}=n.loadPolicy;if(i)for(let o in i)e.setRequestHeader(o,i[o]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),n.timeout=s&&X(s)?s:a,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}readystatechange(){let{context:e,loader:t,stats:n}=this;if(!e||!t)return;let i=t.readyState,s=this.config;if(!n.aborted&&i>=2&&(n.loading.first===0&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),s.timeout!==s.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),s.timeout=s.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),s.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),i===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;let a=t.status,o=t.responseType!=="text";if(a>=200&&a<300&&(o&&t.response||t.responseText!==null)){n.loading.end=Math.max(self.performance.now(),n.loading.first);let l=o?t.response:t.responseText,c=t.responseType==="arraybuffer"?l.byteLength:l.length;if(n.loaded=n.total=c,n.bwEstimate=n.total*8e3/(n.loading.end-n.loading.first),!this.callbacks)return;let u=this.callbacks.onProgress;if(u&&u(n,e,l,t),!this.callbacks)return;let d={url:t.responseURL,data:l,code:a};this.callbacks.onSuccess(d,n,e,t)}else{let l=s.loadPolicy.errorRetry,c=n.retry;Yr(l,c,!1,a)?this.retry(l):(R.error(`${a} while loading ${e.url}`),this.callbacks.onError({code:a,text:t.statusText},e,t,n))}}}loadtimeout(){var e;let t=(e=this.config)==null?void 0:e.loadPolicy.timeoutRetry,n=this.stats.retry;if(Yr(t,n,!0))this.retry(t);else{R.warn(`timeout while loading ${this.context.url}`);let i=this.callbacks;i&&(this.abortInternal(),i.onTimeout(this.stats,this.context,this.loader))}}retry(e){let{context:t,stats:n}=this;this.retryDelay=Aa(e,n.retry),n.retry++,R.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t.url}, retrying ${n.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){let t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&Vy.test(this.loader.getAllResponseHeaders())){let t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}};function jy(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(r){}return!1}var Hy=/(\d+)-(\d+)\/(\d+)/,oo=class{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||qy,this.controller=new self.AbortController,this.stats=new Ni}destroy(){this.loader=this.callbacks=null,this.abortInternal()}abortInternal(){let e=this.response;e!=null&&e.ok||(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,n){let i=this.stats;if(i.loading.start)throw new Error("Loader can only be used once.");i.loading.start=self.performance.now();let s=Wy(e,this.controller.signal),a=n.onProgress,o=e.responseType==="arraybuffer",l=o?"byteLength":"length",{maxTimeToFirstByteMs:c,maxLoadTimeMs:u}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=n,this.request=this.fetchSetup(e,s),self.clearTimeout(this.requestTimeout),t.timeout=c&&X(c)?c:u,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),n.onTimeout(i,e,this.response)},t.timeout),self.fetch(this.request).then(d=>{this.response=this.loader=d;let h=Math.max(self.performance.now(),i.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=u,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),n.onTimeout(i,e,this.response)},u-(h-i.loading.start)),!d.ok){let{status:f,statusText:m}=d;throw new wh(m||"fetch, bad network response",f,d)}return i.loading.first=h,i.total=Ky(d.headers)||i.total,a&&X(t.highWaterMark)?this.loadProgressively(d,i,e,t.highWaterMark,a):o?d.arrayBuffer():e.responseType==="json"?d.json():d.text()}).then(d=>{let{response:h}=this;self.clearTimeout(this.requestTimeout),i.loading.end=Math.max(self.performance.now(),i.loading.first);let f=d[l];f&&(i.loaded=i.total=f);let m={url:h.url,data:d,code:h.status};a&&!X(t.highWaterMark)&&a(i,e,d,h),n.onSuccess(m,i,e,h)}).catch(d=>{if(self.clearTimeout(this.requestTimeout),i.aborted)return;let h=d&&d.code||0,f=d?d.message:null;n.onError({code:h,text:f},e,d?d.details:null,i)})}getCacheAge(){let e=null;if(this.response){let t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,n,i=0,s){let a=new Ka,o=e.body.getReader(),l=()=>o.read().then(c=>{if(c.done)return a.dataLength&&s(t,n,a.flush(),e),Promise.resolve(new ArrayBuffer(0));let u=c.value,d=u.length;return t.loaded+=d,d<i||a.dataLength?(a.push(u),a.dataLength>=i&&s(t,n,a.flush(),e)):s(t,n,u,e),l()}).catch(()=>Promise.reject());return l()}};function Wy(r,e){let t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(Oe({},r.headers))};return r.rangeEnd&&t.headers.set("Range","bytes="+r.rangeStart+"-"+String(r.rangeEnd-1)),t}function zy(r){let e=Hy.exec(r);if(e)return parseInt(e[2])-parseInt(e[1])+1}function Ky(r){let e=r.get("Content-Range");if(e){let n=zy(e);if(X(n))return n}let t=r.get("Content-Length");if(t)return parseInt(t)}function qy(r,e){return new self.Request(r.url,e)}var wh=class extends Error{constructor(e,t,n){super(e);this.code=void 0,this.details=void 0,this.code=t,this.details=n}},Yy=/\s/,Xy={newCue(r,e,t,n){let i=[],s,a,o,l,c,u=self.VTTCue||self.TextTrackCue;for(let h=0;h<n.rows.length;h++)if(s=n.rows[h],o=!0,l=0,c="",!s.isEmpty()){var d;for(let p=0;p<s.chars.length;p++)Yy.test(s.chars[p].uchar)&&o?l++:(c+=s.chars[p].uchar,o=!1);s.cueStartTime=e,e===t&&(t+=1e-4),l>=16?l--:l++;let f=dh(c.trim()),m=to(e,t,f);r!=null&&(d=r.cues)!=null&&d.getCueById(m)||(a=new u(e,t,f),a.id=m,a.line=h+1,a.align="left",a.position=10+Math.min(80,Math.floor(l*8/32)*10),i.push(a))}return r&&i.length&&(i.sort((h,f)=>h.line==="auto"||f.line==="auto"?0:h.line>8&&f.line>8?f.line-h.line:h.line-f.line),i.forEach(h=>Hu(r,h))),i}},Qy={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},Zy=ze(ze({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:Infinity,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:Infinity,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:ao,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:Gd,bufferController:Zd,capLevelController:us,errorController:ed,fpsController:Eh,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:vu,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,certLoadPolicy:{default:Qy},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:Infinity,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},Jy()),{},{subtitleStreamController:qd,subtitleTrackController:Yd,timelineController:bh,audioStreamController:jd,audioTrackController:Hd,emeController:Mn,cmcdController:sn,contentSteeringController:Sh});function Jy(){return{cueHandler:Xy,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function eb(r,e){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');let t=lo(r),n=["manifest","level","frag"],i=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return n.forEach(s=>{let a=`${s==="level"?"playlist":s}LoadPolicy`,o=e[a]===void 0,l=[];i.forEach(c=>{let u=`${s}Loading${c}`,d=e[u];if(d!==void 0&&o){l.push(u);let h=t[a].default;switch(e[a]={default:h},c){case"TimeOut":h.maxLoadTimeMs=d,h.maxTimeToFirstByteMs=d;break;case"MaxRetry":h.errorRetry.maxNumRetry=d,h.timeoutRetry.maxNumRetry=d;break;case"RetryDelay":h.errorRetry.retryDelayMs=d,h.timeoutRetry.retryDelayMs=d;break;case"MaxRetryTimeout":h.errorRetry.maxRetryDelayMs=d,h.timeoutRetry.maxRetryDelayMs=d;break}}}),l.length&&R.warn(`hls.js config: "${l.join('", "')}" setting(s) are deprecated, use "${a}": ${JSON.stringify(e[a])}`)}),ze(ze({},t),e)}function lo(r){return r&&typeof r=="object"?Array.isArray(r)?r.map(lo):Object.keys(r).reduce((e,t)=>(e[t]=lo(r[t]),e),{}):r}function tb(r){let e=r.loader;e!==oo&&e!==ao?(R.log("[config]: Custom loader detected, cannot enable progressive streaming"),r.progressive=!1):jy()&&(r.loader=oo,r.progressive=!0,r.enableSoftwareAES=!0,R.log("[config]: Progressive streaming enabled, using FetchLoader"))}var Tn=class{static get version(){return"1.4.0"}static isSupported(){return Vv()}static get Events(){return v}static get ErrorTypes(){return J}static get ErrorDetails(){return F}static get DefaultConfig(){return Tn.defaultConfig?Tn.defaultConfig:Zy}static set DefaultConfig(e){Tn.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new Gi,this._autoLevelCapping=void 0,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,Cg(e.debug||!1,"Hls instance");let t=this.config=eb(Tn.DefaultConfig,e);this.userConfig=e,this._autoLevelCapping=-1,t.progressive&&tb(t);let{abrController:n,bufferController:i,capLevelController:s,errorController:a,fpsController:o}=t,l=new a(this),c=this.abrController=new n(this),u=this.bufferController=new i(this),d=this.capLevelController=new s(this),h=new o(this),f=new Vu(this),m=new Wu(this),p=t.contentSteeringController,g=p?new p(this):null,T=this.levelController=new td(this,g),_=new id(this),y=new ld(this.config),b=this.streamController=new Ud(this,_,y);d.setStreamController(b),h.setStreamController(b);let E=[f,T,b];g&&E.splice(1,0,g),this.networkControllers=E;let C=[c,u,d,h,m,_];this.audioTrackController=this.createController(t.audioTrackController,E);let w=t.audioStreamController;w&&E.push(new w(this,_,y)),this.subtitleTrackController=this.createController(t.subtitleTrackController,E);let O=t.subtitleStreamController;O&&E.push(new O(this,_,y)),this.createController(t.timelineController,C),y.emeController=this.emeController=this.createController(t.emeController,C),this.cmcdController=this.createController(t.cmcdController,C),this.latencyController=this.createController(Ku,C),this.coreComponents=C,E.push(l);let S=l.onErrorOut;typeof S=="function"&&this.on(v.ERROR,S,l)}createController(e,t){if(e){let n=new e(this);return t&&t.push(n),n}return null}on(e,t,n=this){this._emitter.on(e,t,n)}once(e,t,n=this){this._emitter.once(e,t,n)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,n=this,i){this._emitter.off(e,t,n,i)}listeners(e){return this._emitter.listeners(e)}emit(e,t,n){return this._emitter.emit(e,t,n)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(n){R.error("An internal error happened while handling event "+e+'. Error message: "'+n.message+'". Here is a stacktrace:',n),this.trigger(v.ERROR,{type:J.OTHER_ERROR,details:F.INTERNAL_EXCEPTION,fatal:!1,event:e,error:n})}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){R.log("destroy"),this.trigger(v.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;let e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){R.log("attachMedia"),this._media=e,this.trigger(v.MEDIA_ATTACHING,{media:e})}detachMedia(){R.log("detachMedia"),this.trigger(v.MEDIA_DETACHING,void 0),this._media=null}loadSource(e){this.stopLoad();let t=this.media,n=this.url,i=this.url=Mi.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});R.log(`loadSource:${i}`),t&&n&&n!==i&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(t)),this.trigger(v.MANIFEST_LOADING,{url:e})}startLoad(e=-1){R.log(`startLoad(${e})`),this.networkControllers.forEach(t=>{t.startLoad(e)})}stopLoad(){R.log("stopLoad"),this.networkControllers.forEach(e=>{e.stopLoad()})}swapAudioCodec(){R.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){R.log("recoverMediaError");let e=this._media;this.detachMedia(),e&&this.attachMedia(e)}removeLevel(e,t=0){this.levelController.removeLevel(e,t)}get levels(){let e=this.levelController.levels;return e||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){R.log(`set currentLevel:${e}`),this.loadLevel=e,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){R.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){R.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){R.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){return this.levelController.startLevel}set startLevel(e){R.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){let t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){let{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}get ttfbEstimate(){let{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(R.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e)}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){Ta.indexOf(e)>-1&&(this._maxHdcpLevel=e)}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){let{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;let n=e.length;for(let i=0;i<n;i++)if(e[i].maxBitrate>=t)return i;return 0}get maxAutoLevel(){let{levels:e,autoLevelCapping:t,maxHdcpLevel:n}=this,i;if(t===-1&&e&&e.length?i=e.length-1:i=t,n)for(let s=i;s--;){let a=e[s].attrs["HDCP-LEVEL"];if(a&&a<=n)return s}return i}get nextAutoLevel(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)}set nextAutoLevel(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get audioTracks(){let e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){let e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){let t=this.audioTrackController;t&&(t.audioTrack=e)}get subtitleTracks(){let e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){let e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){let t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){let e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){let t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}};Tn.defaultConfig=void 0;var Lh=Tn;var nb=navigator.userAgent.toLowerCase(),Ih=new URL(location.href),ib=Ih.hostname,rb=Ih.searchParams.has("wtr-session-id"),Ch=ib==="localhost"&&rb,Rh=nb.includes("firefox");var Ph=document.createElement("template");Ph.innerHTML=`<style>
${tu}</style>
`;var sb=Promise.resolve(Lh),ri,ab="stn-video-hlsjs",kh=class extends Jn{constructor(){super();let{shadow:e,video:t,model:n}=ri(this);e.appendChild(Ph.content.cloneNode(!0)),n.hlsContainer=null,gr(n,{hlsContainer:Le});let i=j((s,a)=>{let o=n.hlsContainer[0](),l=a.type,c=a.details,u=a.fatal;n.error=a;let d=l===o.ErrorTypes.NETWORK_ERROR&&c===o.ErrorDetails.LEVEL_LOAD_ERROR,h=l===o.ErrorTypes.MEDIA_ERROR&&c===o.ErrorDetails.BUFFER_STALLED_ERROR,f=n.hlsContainer[1];if(u)switch(l){case o.ErrorTypes.NETWORK_ERROR:console.log("fatal network error encountered, try to recover",a),f.startLoad(),n.badContent=!0;break;case o.ErrorTypes.MEDIA_ERROR:console.log("fatal media error encountered, try to recover",a),f.recoverMediaError();break;default:console.error("stn-video-hlsjs cannot recover fatal error",a),f.destroy(),delete n.hlsContainer[1];break}else if(d){console.log("non fatal level load network error encountered, try to recover",a);let m=f.loadLevel;f.removeLevel(m),f.currentLevel=-1,f.startLoad(),n.qualityLevelRemoved=m}else Rh&&Ch&&h||console.error("stn-video-hlsjs experienced a non-fatal",a)});x(()=>[n.hlsContainer,n.src],([s,a])=>{if(a=a.content,n.badContent=!1,s===null)return;let o=new URL(a,location.href);if(o.pathname.endsWith(".m3u8"))if(a=o.href,s){if(s.length===2){let d=s[1];d.detachMedia(t),d.destroy()}let c=s[0](),u=s[1]=new c({maxMaxBufferLength:5});u.on(c.Events.MANIFEST_PARSED,j((d,h)=>{switch(n.qualityLevels=h.levels.map(f=>f.height),n.initialQuality){case"LOW":u.startLevel=0;break;case"HIGH":u.startLevel=n.qualityLevels.length-1;break;case"AUTO":default:u.startLevel=-1;break}})),u.on(c.Events.LEVELS_UPDATED,j((d,h)=>{n.qualityLevels=h.levels.map(f=>f.height)})),u.on(c.Events.LEVEL_SWITCHED,j((d,h)=>{n.activeQualityLevel=u.levels[u.currentLevel].height})),u.on(c.Events.ERROR,i),u.attachMedia(t),u.loadSource(a)}else console.warn("Attempting native browser m3u8 playback."),t.src=a;else a?.startsWith("blob:")||(s?.length===2&&(s[1].detachMedia(t),s[1].destroy(t),delete s[1]),t.src=a)}),sb.then(j(s=>{if(!s.isSupported()){console.warn("Hls.js is not supported in this browser."),n.hlsContainer=!1;return}n.hlsContainer=[()=>s]})),x(()=>n.closestQuality,s=>{let a=n.hlsContainer[1];if(s==="auto"){a.currentLevel=-1;return}if(!s){a.currentLevel=0;return}a.currentLevel=n.qualityLevels.indexOf(s)})}get src(){return ri(this).model.src}set src(e){L(()=>{let{model:t}=ri(this);t.src=e})}get ready(){let e=ri(this).model.hlsContainer;return e===!1?!0:e?!!e[0]:!1}shadowSelector(...e){return ri(this).shadow.querySelector(...e)}};ri=le(Jn);customElements.define(ab,kh);var Dh=`<div class='controlbarContainer \${active} \${mode}'>
    <div title='\${playStateTitle}' class='playState \${playStateClass} material-icons hoverable'>%{playStateIcon}</div>
    <div title='\${volumeIconTitle}' class='muteState material-icons hoverable'>\${volumeIcon}</div>
    <div class='volumeState \${volumeExpand}'>
        <stn-input type="range" min="0" max="100" value="\${volume}"></stn-input>
    </div>
    <div class='spacer'></div>
    <div class='progressBar'>
        <stn-input type="range" min="0" max="\${duration}" value="\${currentTime}" step='0.01' stn-disabled='\${progressDisabled:true}'></stn-input>
    </div>
    <div title='\${timeDisplayTitle}' class='timeDisplay hoverable'>\${timeDisplay}</div>
    <div title='Quality Selector' class='qualities hoverable material-icons \${qualityBtnHidden:hide} \${qualityMenuBtnClicked:clicked}'>\${qualityIcon}</div>
    <div title='Share' class='share hoverable material-icons \${shareBtnHidden:hide} \${shareBtnClicked:clicked}'>share</div>
    <div title='Subtitles' class='subtitles hoverable material-icons \${subtitlesActive:active} \${subtitlesBtnHidden:hide} \${subtitleMenuBtnClicked:clicked}'>closed_caption</div>
    <div title='\${fullscreenTitle}' class='fullscreen material-icons hoverable \${fullscreenBtnHidden:hide}'>\${fullscreenIcon}</div>
    <div title='stnvideo.com' class='stnLink \${hideSTNLink:hide}'>
        <stn-link></stn-link>
    </div>
</div>
<div class='qualitiesContainer \${qualitiesMenuHidden:hide}'>
    <div class='qualitiesWrapper'>
        <div class='qualitiesMenu' foreach="quality,i of qualities">
            <div class="\${quality.active:active}" data-idx='\${i}'>\${quality.label}</div>
        </div>
    </div>
</div>
<div class='subtitlesContainer \${subtitlesMenuHidden:hide}'>
    <div class='subtitlesWrapper'>
        <div class='subtitlesMenu' foreach="subtitle,i of subtitles">
            <div class="\${subtitle.active:active}" data-idx='\${i}'>\${subtitle.label}</div>
        </div>
    </div>
</div>
`;var xh=`:host
{
    --rangeTrackHeight: 9px;
    --rangeThumbHeight: 15px;
    --rangeThumbWidth: 15px;
    --rangeThumbMargin: -4px 0 0 0;
    --rangeThumbBorderRadius: 100px;

    --newUIRangeTrackHeight: 3px;
    --newUIRangeTrackHeightExpand: 3px;
    --newUIRangeThumbHeight: 12px;
    --newUIRangeThumbWidth: 12px;
    --newUIRangeThumbMargin: -5px 0 0 0;
    --newUIRangeThumbBorderRadius: 100px;

    --subtitleMenuWidth: 20%;
    --subtitleMenuMinWidth: 180px;

    width: 100%;
    height: 100%;
    left: 0;
    bottom: 0;
    position: absolute;
    overflow: hidden;

    /* stn-control is a container that takes up the whole player size, in order to */
    /* allow menus to be within it. Because of this, the stn-control element blocks */
    /* clicks to it's siblings like contentplayer. */
    /* Make clicks of stn-control pass through, and we will add back pointer events */
    /* for its children that actually need clicks */
    pointer-events: none;
}

:host > *
{
    /* Pointer events brought back for immediate children */
    pointer-events: all;
}

.controlbarContainer
{
    display: flex;

    /* Don't wrap the control bar info */
    flex-wrap: nowrap;

    /* Space out the contents of the control bar evenly by default */
    justify-content: space-between;

    background: rgba(0, 0, 0, 0.3);
    color: white;
    position: absolute;
    width: 100%;
    height: var(--controlbarHeight);
    transition: bottom 300ms;
    padding-left: 0.5em;
    padding-right: 0.5em;
    box-sizing: border-box;
}

:host(.newUI) .controlbarContainer
{
    gap: 2%;
}

.progressBar
{
    /* Any extra space in the control bar is given to the progress bar */
    flex-grow: 1;
}

input[type=range]
{
    width: 100%;
}

.volumeState.expand
{
    width: 15%;
}
:host(.newUI) .controlbarContainer .volumeState
{
    width: 20%;
    font-size: unset;
}

:host(.newUI) .volumeState input
{
    position: relative;
    /*
        bottom is set for webkit, and top is set for others because
        idk... ¯\\(°_o)/¯
        Without them, both are misaligned in 2 different directions
     */
}

:host(:not(.newUI)) .volumeState:not(.expand)
{
    width: 0;
    visibility: hidden;
}

.volumeState
{
    overflow: hidden;
    transition: width 300ms ease-in-out, visibility 200ms;
}

.controlbarContainer.active
{
    bottom: 0;
}

.controlbarContainer:not(.active)
{
    bottom: calc(-1 * var(--controlbarHeight));
}

.controlbarContainer *
{
    /* Don't allow user to select text / icons in the control bar */
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
}

.controlbarContainer > div
{
    border: 1px solid transparent;
    box-sizing: border-box;
    display: inline-block;
    width: fit-content;
    height: 100%;
    vertical-align: top;
    padding: 2px;
}

:host(.newUI) .controlbarContainer > div
{
    padding: 3px;
    font-size: 22px;
}

.controlbarContainer > div.active
{
    color: var(--controlbarActiveButtonsColour);
}

.controlbarContainer > .material-icons
{
    width: var(--controlbarHeight);
}

.controlbarContainer > div.hoverable:hover
{
    background: rgba(0, 0, 0, 0.6);
    cursor: pointer;
    border: 1px solid #3e3d3d;
}

.controlbarContainer > div.hoverable.clicked
{
    background: rgba(0, 0, 0, 0.9);
}

.playState svg
{
    width: auto;
    height: 100%;
    padding: 2px 4px;
    box-sizing: border-box;
}

.playState svg path
{
    fill: var(--bigPlayButtonColor);
}

input[type=range] {
    -webkit-appearance: none;
    cursor: pointer;
    background: transparent;
}

input[type=range]:focus {
    outline: none;
}

:host .controlbarContainer.ad .progressBar input
{
    cursor: not-allowed;
}

input[type=range]::-webkit-slider-runnable-track {
    width: 100%;
    height: var(--rangeTrackHeight);
    border: 1px solid #010101;
}
input[type=range]::-moz-range-progress {
    width: 100%;
    height: var(--rangeTrackHeight);
    border: 1px solid #010101;
}
input[type=range]::-moz-range-track {
    width: 100%;
    height: var(--rangeTrackHeight);
    border: 1px solid #010101;
}
input[type=range]::-ms-track {
    width: 100%;
    height: var(--rangeTrackHeight);
    background: transparent;
    border-color: transparent;
    border-width: 16px 0;
    color: transparent;
}
input[type=range]::-ms-fill-lower,
input[type=range]::-ms-fill-upper {
    border: 1px solid #010101;
    border-radius: 3px;
}

.progressBar input[type=range]::-moz-range-progress {
    background: var(--progressBarTrackColor);
}
.progressBar input[type=range]::-moz-range-track {
    background: var(--progressBarTrackTimeLeftColor);
}
.progressBar input[type=range]::-ms-fill-lower {
    background: var(--progressBarTrackColor);
}
.progressBar input[type=range]::-ms-fill-upper {
    background: var(--progressBarTrackTimeLeftColor);
}

.controlbarContainer.ad .progressBar input[type=range]::-moz-range-progress {
    background: var(--adProgressBarTrackColor);
}
.controlbarContainer.ad .progressBar input[type=range]::-moz-range-track {
    background: var(--adProgressBarTrackTimeLeftColor);
}
.controlbarContainer.ad .progressBar input[type=range]::-ms-fill-lower {
    background: var(--adProgressBarTrackColor);
}
.controlbarContainer.ad .progressBar input[type=range]::-ms-fill-upper {
    background: var(--adProgressBarTrackTimeLeftColor);
}

.volumeState input[type=range]::-moz-range-progress {
    background: var(--volumeBarTrackColor);
}
.volumeState input[type=range]::-moz-range-track {
    background: var(--volumeBarTrackUnusedColor);
}
.volumeState input[type=range]::-ms-fill-lower {
    background: var(--volumeBarTrackColor);
}
.volumeState input[type=range]::-ms-fill-upper {
    background: var(--volumeBarTrackUnusedColor);
}

.controlbarContainer.ad .volumeState input[type=range]::-moz-range-progress {
    background: var(--adVolumeBarTrackColor);
}
.controlbarContainer.ad .volumeState input[type=range]::-moz-range-track {
    background: var(--adVolumeBarTrackUnusedColor);
}
.controlbarContainer.ad .volumeState input[type=range]::-ms-fill-lower {
    background: var(--adVolumeBarTrackColor);
}
.controlbarContainer.ad .volumeState input[type=range]::-ms-fill-upper {
    background: var(--adVolumeBarTrackUnusedColor);
}

input[type=range]::-webkit-slider-thumb {
    border: 1px solid #000000;
    height: var(--rangeThumbHeight);
    width: var(--rangeThumbWidth);
    border-radius: var(--rangeThumbBorderRadius);
    -webkit-appearance: none;
    margin: var(--rangeThumbMargin)
}
input[type=range]::-moz-range-thumb {
    border: 1px solid #000000;
    height: var(--rangeThumbHeight);
    width: var(--rangeThumbWidth);
    border-radius: var(--rangeThumbBorderRadius);
}
input[type=range]::-ms-thumb {
    border: 1px solid #000000;
    height: var(--rangeThumbHeight);
    width: var(--rangeThumbWidth);
    border-radius: var(--rangeThumbBorderRadius);
}

:host(.newUI) input[type=range]::-webkit-slider-thumb {
    border: none;
    height: var(--newUIRangeThumbHeight);
    width: var(--newUIRangeThumbWidth);
    border-radius: var(--newUIRangeThumbBorderRadius);
    -webkit-appearance: none;
    margin: var(--newUIRangeThumbMargin)
}
:host(.newUI) input[type=range]::-moz-range-thumb {
    border: none;
    height: calc(var(--newUIRangeThumbHeight) * 0.75);
    width: calc(var(--newUIRangeThumbWidth) * 0.75);
    border-radius: var(--newUIRangeThumbBorderRadius);
}
:host(.newUI) input[type=range]::-ms-thumb {
    border: none;
    height: var(--newUIRangeThumbHeight);
    width: var(--newUIRangeThumbWidth);
    border-radius: var(--newUIRangeThumbBorderRadius);
}


.progressBar input[type=range]::-webkit-slider-thumb {
    background: var(--progressBarThumbColor);
}
.progressBar input[type=range]::-moz-range-thumb {
    background: var(--progressBarThumbColor);
}
.progressBar input[type=range]::-ms-thumb {
    background: var(--progressBarThumbColor);
}

.controlbarContainer.ad .progressBar input[type=range]::-webkit-slider-thumb {
    background: var(--adProgressBarThumbColor);
}
.controlbarContainer.ad .progressBar input[type=range]::-moz-range-thumb {
    background: var(--adProgressBarThumbColor);
}
.controlbarContainer.ad .progressBar input[type=range]::-ms-thumb {
    background: var(--adProgressBarThumbColor);
}

:host(.newUI) .progressBar:not(:hover) input[type=range]::-webkit-slider-thumb,
:host(.newUI) .ad .progressBar input[type=range]::-webkit-slider-thumb {
    display: none;
}
:host(.newUI) .progressBar:not(:hover) input[type=range]::-moz-range-thumb,
:host(.newUI) .ad .progressBar input[type=range]::-moz-range-thumb {
    width: 0;
    height: 0;
    border: none;
    background: transparent;
}
:host(.newUI) .progressBar:not(:hover) input[type=range]::-ms-thumb,
:host(.newUI) .ad .progressBar input[type=range]::-ms-thumb {
    display: none;
}


.volumeState input[type=range]::-webkit-slider-thumb {
    background: var(--volumeBarThumbColor);
}
.volumeState input[type=range]::-moz-range-thumb {
    background: var(--volumeBarThumbColor);
}
.volumeState input[type=range]::-ms-thumb {
    background: var(--volumeBarThumbColor);
}

.controlbarContainer.ad .volumeState input[type=range]::-webkit-slider-thumb {
    background: var(--adVolumeBarThumbColor);
}
.controlbarContainer.ad .volumeState input[type=range]::-moz-range-thumb {
    background: var(--adVolumeBarThumbColor);
}
.controlbarContainer.ad .volumeState input[type=range]::-ms-thumb {
    background: var(--adVolumeBarThumbColor);
}

.controlbarContainer > .hide
{
    display: none;
}

.subtitlesContainer,
.qualitiesContainer
{
    position: absolute;
    width: var(--subtitleMenuWidth);
    height: calc(100% - (2 * var(--controlbarHeight)));
    right: 10px;
    bottom: calc(var(--controlbarHeight) + 5px);
    overflow: hidden;

    min-width: var(--subtitleMenuMinWidth);
    text-align: center;
    transition: right 300ms;
    display: flex;

    /* The containers shouldn't get in the way of pointer events, such as hover */
    /* for controlling whether or not the control bar etc should show */
    pointer-events: none;
}

.subtitlesContainer > *,
.qualitiesContainer > *
{
    /* Override for children so that the actual menu items can be used */
    pointer-events: auto;
}

.subtitlesWrapper,
.qualitiesWrapper
{
    max-height: 100%;
    width: 100%;
    align-self: flex-end;
}

.subtitlesMenu,
.qualitiesMenu
{
    background: rgba(0, 0, 0, 0.5);
    color: white;
    cursor: pointer;
    width: 100%;
    min-height: 100%;
}

.subtitlesContainer.hide,
.qualitiesContainer.hide
{
    right: calc(-1 * max(var(--subtitleMenuMinWidth), var(--subtitleMenuWidth)));
}

.subtitlesMenu > .active,
.qualitiesMenu > .active
{
    border: 1px solid white;
    background: rgba(0, 0, 0, 0.8);
}

.subtitlesMenu > *,
.qualitiesMenu > *
{
    border: 1px solid transparent;
    padding: 0.5em 0.5ch;
}

/* Override the scrollbar z-index so that it doesn't show through the playlist */
/* overlay when paused */
:host .os-scrollbar
{
    z-index: 0 !important;
}

/* Used to hide the track for the scrollbar */
:host .os-scrollbar:before
{
    border: none !important;
    background: transparent !important;
}

/* Used to hide the track for the scrollbar */
:host .os-scrollbar .os-scrollbar-track {
    background: transparent !important;
}

:host .os-scrollbar .os-scrollbar-handle {
    background-color: rgba(0, 0, 0, 0.8) !important;
}

.subtitlesMenu,
.qualitiesMenu
{
    /* It looks like detection of scrollbar width doesn't work inside a shadow dom */
    /* because I keep getting a 30px border on the content wrapper. This will be */
    /* used to counteract that. */
    width: calc(100% - (19px - var(--nativeScrollbarWidth)));
}

:host .os-host-scrollbar-vertical-hidden .subtitlesMenu,
:host .os-host-scrollbar-vertical-hidden .qualitiesMenu
{
    width: 100%;
}

/* Safari likes to give disabled inputs a 0.4 opacity. I don't */
input:disabled
{
    opacity: 1;
}

:host(.newUI) .progressBar
{
    width: 100%;
    position: absolute;
    top: calc(-1 * var(--newUIRangeTrackHeight));
    left: 0;
    padding: 0;
    border: none;
    height: fit-content;

    transition: top 50ms;
}
:host(.newUI) :not(.ad) .progressBar:hover
{
    top: calc(-1 * var(--newUIRangeTrackHeight) - var(--newUIRangeTrackHeightExpand));
}

:host(.newUI) .progressBar input
{
    position: absolute;
    top: 0;
    left: 0;
    margin: 0;
    height: var(--newUIRangeTrackHeight);

    transition: height 50ms;
}
:host(.newUI) :not(.ad) .progressBar:hover input
{
    height: calc(var(--newUIRangeTrackHeight) + var(--newUIRangeTrackHeightExpand));
}

:host(.newUI) input[type=range] {
    -webkit-appearance: none;
    cursor: pointer;
    background: transparent;
}

:host(.newUI) input[type=range]::-webkit-slider-runnable-track {
    width: 100%;
    height: var(--newUIRangeTrackHeight);
    border: none;
}
:host(.newUI) input[type=range]::-moz-range-progress {
    width: 100%;
    height: var(--newUIRangeTrackHeight);
    border: none;
}
:host(.newUI) input[type=range]::-moz-range-track {
    width: 100%;
    height: var(--newUIRangeTrackHeight);
    border: none;
}
:host(.newUI) input[type=range]::-ms-track {
    width: 100%;
    height: var(--newUIRangeTrackHeight);
    background: transparent;
    border: none;
    color: transparent;
}
:host(.newUI) input[type=range]::-ms-fill-lower,
:host(.newUI) input[type=range]::-ms-fill-upper {
    border: 1px solid #010101;
    border-radius: 3px;
}

:host(.newUI) .volumeState input[type=range]::-webkit-slider-thumb {
    background: var(--volumeBarThumbColor);
}
:host(.newUI) .volumeState input[type=range]::-moz-range-thumb {
    background: var(--volumeBarThumbColor);
}
:host(.newUI) .volumeState input[type=range]::-ms-thumb {
    background: var(--volumeBarThumbColor);
}

:host(.newUI) .controlbarContainer.ad .volumeState input[type=range]::-webkit-slider-thumb {
    background: var(--adVolumeBarThumbColor);
}
:host(.newUI) .controlbarContainer.ad .volumeState input[type=range]::-moz-range-thumb {
    background: var(--adVolumeBarThumbColor);
}
:host(.newUI) .controlbarContainer.ad .volumeState input[type=range]::-ms-thumb {
    background: var(--adVolumeBarThumbColor);
}

:host(:not(.newUI)) .spacer
{
    display: none;
}
:host(.newUI) .spacer
{
    flex-grow: 1;
}

:host(.newUI) .controlbarContainer .timeDisplay
{
    font-size: 15px;
}

:host(.newUI) .controlbarContainer .timeDisplay
{
    font-size: 15px;
}

.controlbarContainer .stnLink
{
    width: 74px;
}
`;var Oh=le(Symbol("StnInput")),ob="stn-input",Mh=class extends ke{static get observedAttributes(){return["max","min","step","stn-disabled","type","value"]}constructor(){super();let e=document.createElement("input");this.appendChild(e),Oh(this,{input:e})}attributeChangedCallback(e,t,n){let i=Oh(this);switch(e){case"stn-disabled":i.input.disabled=n==="true";break;default:i.input[e]=n,i.input.setAttribute(e,n);break}}};customElements.define(ob,Mh);function ji(r){(isNaN(r)||r<0)&&(r=0);let e=Math.floor(r/60),t=Math.floor(r-e*60);return`${e}:${t.toString().padStart(2,"0")}`}var Hi=CSS.supports("transition","d 1s")&&CSS.supports("d",'path("")'),hs=lb();function lb(){if(!Hi)return"";let r=300,e=r/(13/4),t=.83705,n=r/Math.sqrt(1+Math.pow(t,2)),i=t*n,s=-1.194765,a=e/Math.sqrt(1+Math.pow(s,2)),o=s*a,l=-.539384,c=r/Math.sqrt(1+Math.pow(l,2)),u=l*c,d=1.853967,h=e/Math.sqrt(1+Math.pow(d,2)),f=d*h,m=90-Math.abs(Math.atan(t)*180/Math.PI),p=90-Math.abs(Math.atan(l)*180/Math.PI);return`
		.pause svg #topPiece {
			d: path("m 165.9 197.8 l 0 0 l 0 0 l 0 0 c 0 0 0 0 0 0 l ${-1*n} ${-1*i} c 0 0 0 0 ${a} ${o} c 0 0 0 0 0 0 l ${n} ${i} c 0 0 0 0 0 0 l 0 0 l ${-1*a} ${-1*o} Z");
			transform: translate(-5px, 141px) rotate(${m}deg);
		}

		.pause #rightPiece {
			d: path("m 100.6 250.5 l ${c} ${u} l 0 0 c 0 0 0 0 0 0 l 0 0 l 0 0 l 0 0 c 0 0 0 0 0 0 c 0 0 0 0 0 0 c 0 0 0 0 0 0 c 0 0 0 0 0 0 c 0 0 0 0 0 0 l 0 0 c 0 0 0 0 ${h} ${f} c 0 0 0 0 0 0 c 0 0 0 0 0 0 c 0 0 0 0 0 0 c 0 0 0 0 0 0 c 0 0 0 0 0 0 c 0 0 0 0 0 0 c 0 0 0 0 0 0 c 0 0 0 0 0 0 c 0 0 0 0 0 0 c 0 0 0 0 0 0 c 0 0 0 0 0 0 c 0 0 0 0 0 0 c 0 0 0 0 0 0 l 0 0 c 0 0 0 0 0 0 c 0 0 0 0 0 0 c 0 0 0 0 0 0 c 0 0 0 0 0 0 c 0 0 0 0 0 0 c 0 0 0 0 0 0 c 0 0 0 0 0 0 l 0 0 c 0 0 0 0 0 0 c 0 0 0 0 0 0 c 0 0 0 0 0 0 c 0 0 0 0 0 0 c 0 0 0 0 0 0 l 0 0 l 0 0 l 0 0 c 0 0 0 0 0 0 c 0 0 0 0 0 0 c 0 0 0 0 ${-1*c} ${-1*u} l 0 0 c 0 0 0 0 0 0 l 0 0 l 0 0 l ${-1*h} ${-1*f} Z");
			transform: translate(5px, -12.6px) rotate(${-1*p}deg);
		}

		#rightPiece, #topPiece, #bottomPiece {
			transition: 500ms;
			transform-origin: center;
			transform-box: fill-box;
		}

		.pause #bottomPiece {
			transform: translateY(209px);
		}
	`}var ge=le(Symbol("StnControl")),Fh=document.createElement("template");Fh.innerHTML=`<style>
${xh}
${hs}</style>${Dh}
`;var cb="stn-control",Nh=class extends ke{constructor(){super();let e=new class{constructor(){k(this,"active",!1);k(this,"adCurrentTime",0);k(this,"adDuration",0);k(this,"btnActive",null);k(this,"contentCurrentTime",0);k(this,"contentDuration",0);k(this,"fullscreenAllowed",!0);k(this,"hideSTNLink",!0);k(this,"isFullscreen",!1);k(this,"mode","content");k(this,"muted",!0);k(this,"paused",!0);k(this,"playStateUserInitiated",!1);k(this,"rawQualities",[]);k(this,"rawSelectedSubtitle",null);k(this,"rawSubtitles",[]);k(this,"rawVolume",1);k(this,"rawVolumeExpand",!1);k(this,"seekedTo",0);k(this,"showTimeLeft",!0);k(this,"socialSharingTrigger",!1);k(this,"useLogoForPlay",!0);k(this,"selectedQuality","auto");k(this,"activeQuality",null)}get qualityIcon(){let o=this.activeQuality;return o<700?"sd":o<2e3?"hd":o<1e4?`${Math.floor(o/1e3)}k`:"9k_plus"}get subtitleMenuBtnClicked(){return this.btnActive==="subtitle"}get subtitlesActive(){return!!this.selectedSubtitle}get qualityMenuBtnClicked(){return this.btnActive==="quality"}get shareBtnClicked(){return this.btnActive==="share"}get qualities(){let o=this.activeQuality,c=this.selectedQuality==="auto",u=this.rawQualities.map(j((h,f)=>({active:!c&&o===h,label:`${h}p`,value:h}))),d="Auto";return c&&(d=`Auto (${o}p)`),[{label:d,active:c,value:"auto"},...u]}get hasQualities(){return this.rawQualities.length>0}get qualitiesMenuHidden(){let o=this.hasQualities,l=this.qualityMenuBtnClicked,c=this.mode==="ad";return!this.active||c||!l||!o}get selectedSubtitle(){let o=this.rawSelectedSubtitle,l=o?.language??null,c=this.rawSubtitles;if(!c.length||l===null||o===null)return null;let u=c.filter(p=>p===o);if(u.length===1)return u[0];let d=c.filter(p=>p.language===l);if(d.length)return d[0];let[h,f]=l.split("-");if(!!h&&!!f){let p=c.filter(g=>g.language===h);if(p.length)return p[0]}return null}get hasSubtitles(){return this.rawSubtitles.length>0}get subtitlesMenuHidden(){let o=this.hasSubtitles,l=this.subtitleMenuBtnClicked,c=this.mode==="ad";return!this.active||c||!l||!o}get subtitles(){let o=this.selectedSubtitle,l=this.rawSubtitles;return l.forEach(j((c,u)=>{c.active=o===c})),[{label:"Subtitles Off",active:o===null,language:null},...l]}get progressDisabled(){let o=this.mode;return this.mode==="ad"}get shareBtnHidden(){let o=this.mode,l=this.socialSharingTrigger;return o==="ad"?!0:l!=="controlBarClick"}get qualityBtnHidden(){let o=this.mode,l=this.hasQualities;return this.mode==="ad"||!l}get subtitlesBtnHidden(){let o=this.mode,l=this.hasSubtitles;return this.mode==="ad"||!l}get fullscreenBtnHidden(){return!this.fullscreenAllowed}get volumeExpand(){return this.rawVolumeExpand?"expand":""}get currentTime(){let o=this.adCurrentTime,l=this.contentCurrentTime;return this.mode==="ad"?o:l}get duration(){let o=this.adDuration,l=this.contentDuration,c=this.mode==="ad"?o:l;return isNaN(c)?0:c}get volume(){return parseInt(this.rawVolume*100,10)}set volume(o){this.rawVolume=o/100}get fullscreenIcon(){return this.isFullscreen?"fullscreen_exit":"fullscreen"}get fullscreenTitle(){return this.isFullscreen?"Exit Fullscreen":"Enter Fullscreen"}get timeDisplay(){return this.showTimeLeft?this.timeLeft:this.timeElapsed}get timeDisplayTitle(){return this.showTimeLeft?"Time Left":"Time Elapsed"}get timeElapsed(){return ji(this.currentTime)}get timeLeft(){return`-${ji(this.duration-this.currentTime)}`}get playStateClass(){return this.paused?"play":"pause"}get playStateIcon(){let o=this.paused,l=this.useLogoForPlay,c=l?Qt:"play_arrow";return l&&Hi||o?c:"pause"}get playStateTitle(){return this.paused?"Play":"Pause"}get volumeIcon(){let o=!!this.muted,l=parseInt(this.volume,10);return o?"volume_off":l===0?"volume_mute":l<50?"volume_down":"volume_up"}get volumeIconTitle(){return this.muted?"Unmute":"Mute"}};ye(e),Object.freeze(e);let t=this.attachShadow({mode:Re?"open":"closed"}),n=$e(Fh.content.cloneNode(!0),e);t.append(...St(),n);let i=t.querySelector(".controlbarContainer");ge(this,{shadow:t,model:e,container:i,subtitleDelay:null}),Object.freeze(this),x(()=>e.active,o=>{o||(e.btnActive=null)}),t.querySelector(".playState").addEventListener("click",j(()=>{e.playStateUserInitiated=!0,e.paused=!e.paused})),t.querySelector(".muteState").addEventListener("click",j(()=>{let l=e.muted=!e.muted,c=e.volume;!l&&c<5&&(e.volume=5)}));{let o=t.querySelector(".muteState"),l=t.querySelector(".volumeState"),c=l.querySelector("input");window.getComputedStyle(c,"::-webkit-slider-runnable-track").length>0?(P(()=>{let d=e.volume,h=e.mode==="ad",f=h?"adVolumeBarTrackColor":"volumeBarTrackColor",m=h?"adVolumeBarTrackUnusedColor":"volumeBarTrackUnusedColor";c.style.background=`linear-gradient(to right, var(--${f}) 0%, var(--${f}) ${d}%, var(--${m}) ${d}%, var(--${m}) 100%)`}),c.style.bottom="3px"):c.style.top="2px",c.addEventListener("input",j(d=>{let h=c.value;e.volume=h,h&&(e.muted=!1)})),mn([o,l],null,250,j(d=>{e.rawVolumeExpand=d}))}{let o=t.querySelector(".progressBar input");window.getComputedStyle(o,"::-webkit-slider-runnable-track").length>0&&P(()=>{let c=e.currentTime,u=e.duration,d=e.mode==="ad",h=!c||!u?0:100*(c/u),f=d?"adProgressBarTrackColor":"progressBarTrackColor",m=d?"adProgressBarTrackTimeLeftColor":"progressBarTrackTimeLeftColor";o.style.background=`linear-gradient(to right, var(--${f}) 0%, var(--${f}) ${h}%, var(--${m}) ${h}%, var(--${m}) 100%)`}),o.addEventListener("input",j(c=>{e.seekedTo=o.value}))}t.querySelector(".timeDisplay").addEventListener("click",j(()=>{e.showTimeLeft=!e.showTimeLeft}));{t.querySelector(".qualities").addEventListener("click",j(u=>{e.btnActive=e.qualityMenuBtnClicked?null:"quality"}));let l=t.querySelector(".qualitiesMenu"),c=t.querySelector(".qualitiesWrapper");ki(c),l.addEventListener("click",j(u=>{let d=u.target;if(!d){ie&&console.log("Couldn't get clicked quality");return}let h=d.dataset.idx;if(!h){ie&&console.log("Couldn't get clicked quality's index");return}let f=e.qualities[h].value;f!=="auto"&&(e.activeQuality=e.qualities[h].value),e.selectedQuality=f}))}t.querySelector(".share").addEventListener("click",j(()=>{e.btnActive=e.shareBtnClicked?null:"share"}));{t.querySelector(".subtitles").addEventListener("click",j(u=>{e.btnActive=e.subtitleMenuBtnClicked?null:"subtitle"}));let l=t.querySelector(".subtitlesMenu"),c=t.querySelector(".subtitlesWrapper");ki(c),l.addEventListener("click",j(u=>{let d=u.target;if(!d){ie&&console.log("Couldn't get clicked subtitle");return}let h=d.dataset.idx;if(!h){ie&&console.log("Couldn't get clicked subtitle's index");return}e.rawSelectedSubtitle=e.subtitles[h]}))}t.querySelector(".fullscreen").addEventListener("click",j(()=>{e.isFullscreen=!e.isFullscreen}))}get paused(){return ge(this).model.paused}get playStateUserInitiated(){return ge(this).model.playStateUserInitiated}set playStateUserInitiated(e){L(()=>{ge(this).model.playStateUserInitiated=e})}set paused(e){L(()=>{ge(this).model.paused=e})}get muted(){return ge(this).model.muted}set muted(e){L(()=>{ge(this).model.muted=e})}get volume(){return ge(this).model.rawVolume}set volume(e){L(()=>{ge(this).model.rawVolume=e})}get contentCurrentTime(){return ge(this).model.contentCurrentTime}set contentCurrentTime(e){L(()=>{ge(this).model.contentCurrentTime=e})}set adCurrentTime(e){L(()=>{ge(this).model.adCurrentTime=e})}get seekedTo(){return ge(this).model.seekedTo}get contentDuration(){return ge(this).model.contentDuration}set contentDuration(e){L(()=>{ge(this).model.contentDuration=e})}set adDuration(e){L(()=>{ge(this).model.adDuration=e})}get isFullscreen(){return ge(this).model.isFullscreen}set isFullscreen(e){L(()=>{ge(this).model.isFullscreen=!!e})}get shareBtnClicked(){return ge(this).model.shareBtnClicked}set shareBtnClicked(e){L(()=>{ge(this).model.btnActive=e?"share":null})}get isMenuOpen(){return!!ge(this).model.btnActive}set active(e){L(()=>{ge(this).model.active=!!e})}set mode(e){L(()=>{ge(this).model.mode=e})}set socialSharingTrigger(e){L(()=>{ge(this).model.socialSharingTrigger=e})}set subtitles(e){let t=ge(this);clearTimeout(t.subtitleDelay);let n=e.length===0?200:0;t.subtitleDelay=setTimeout(j(()=>{t.model.rawSubtitles=e}),n)}get selectedSubtitle(){return ge(this).model.selectedSubtitle}set availableQualities(e){ge(this).model.rawQualities=e}get selectedQuality(){return ge(this).model.selectedQuality}set activeQuality(e){ge(this).model.activeQuality=e}set fullscreenAllowed(e){ge(this).model.fullscreenAllowed=!!e}set hideSTNLink(e){let{model:t}=ge(this);L(()=>{t.hideSTNLink=!!e})}set useLogoForPlay(e){ge(this).model.useLogoForPlay=e}};customElements.define(cb,Nh);var Bh=`<div class='shareContainer \${mode}'>
    <a data-share='reddit' target='_blank' href='https://www.reddit.com/submit?url=\${location}'>
        <img src='https://d29xw9s9x32j3w.cloudfront.net/images/social/reddit.png'>
    </a>
    <a data-share='facebook' target='_blank' href='https://www.facebook.com/sharer/?u=\${location}'>
        <img src='https://d29xw9s9x32j3w.cloudfront.net/images/social/facebook.png'>
    </a>
    <a data-share='twitter' target='_blank' href='https://twitter.com/intent/tweet?url=\${location}'>
        <img src='https://d29xw9s9x32j3w.cloudfront.net/images/social/twitter.png'>
    </a>
    <a data-share='email' target='_blank' href='mailto:?body=\${location}'>
        <img src='https://d29xw9s9x32j3w.cloudfront.net/images/social/email.png'>
    </a>
</div>
`;var Uh=`:host
{
    --hostRightPadding: 10px;
    --linkBorderWidth: 1px;

    position: absolute;
    right: 0;
    top: 50%;
    transform: translate(100%, -50%);
    padding-right: var(--hostRightPadding);

    transition: transform 300ms;

    /* To make social share show on top of the pause overlay */
    z-index: 1;
}

:host(.active)
{
    transform: translate(0, -50%);
}

[data-share]
{
    display: block;
}

[data-share="reddit"]
{
    background: #ff4500;
}

[data-share="twitter"]
{
    background: #1da1f2;
}

[data-share="facebook"]
{
    background: #3b5998;
}

[data-share="email"]
{
    background: #a6b1b7;
}

[data-share]:hover
{
    box-shadow: RGBA(0,0,0,0.2) 0 0 100px inset;
}

a
{
    display: block;
    border: var(--linkBorderWidth) solid white;
    height: var(--shareLinkSize);
    width: var(--shareLinkSize);
    justify-content: center;
    position: relative;
    box-sizing: border-box;
}

img
{
    display: block;
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    max-width: 60%;
    max-height: 60%;
}
`;var an=le(Symbol("StnControl")),$h=document.createElement("template");$h.innerHTML=`<style>
${Uh}</style>${Bh}
`;var ub="stn-social-share",Gh=class extends ke{constructor(){super();let e=new class{constructor(){k(this,"controlbarClicked",!1);k(this,"mediaHovered",!1);k(this,"lastSharedUrl",!1);k(this,"location",location.href);k(this,"mode","content");k(this,"trigger",!1)}get active(){let o=this.controlbarClicked,l=this.mediaHovered,c=this.mode,u=this.trigger;if(c==="ad")return!1;switch(u){case"hover":return l;case"controlBarClick":return o;default:console.warn(`Unknown Social Sharing trigger [${u}]`);case!1:return!1}}get iconClicked(){return this.active||L(()=>this.lastSharedUrl=!1),!!this.lastSharedUrl}};ye(e),Object.freeze(e);let t=this.attachShadow({mode:Re?"open":"closed"}),n=$e($h.content.cloneNode(!0),e);t.append(n);let i="",s=t.querySelectorAll("a[data-share]");an(this,{shadow:t,model:e,lastUrlShared:i,shareIcons:s}),Object.freeze(this),s.forEach(o=>{o.addEventListener("click",()=>{e.lastSharedUrl=o.dataset.share})}),P(()=>this.classList.toggle("active",e.active))}set controlbarClicked(e){L(()=>{an(this).model.controlbarClicked=!!e})}set mediaHovered(e){L(()=>{an(this).model.mediaHovered=!!e})}set mode(e){L(()=>{an(this).model.mode=e})}set socialSharingTrigger(e){L(()=>{an(this).model.trigger=e})}set shareURL(e){L(()=>{an(this).model.location=e})}get iconClicked(){return an(this).model.iconClicked}get lastSharedUrl(){return an(this).model.lastSharedUrl}get shareIconCount(){return an(this).shareIcons.length}};customElements.define(ub,Gh);var Vh=`:host
{
	--fontSize: 24px;
	--padding: 5px;
	--width: calc(var(--fontSize) + (2 * var(--padding)));

	width: fit-content;
	height: fit-content;
	position: absolute;
	padding: 1.5em 10% 10% 1em;
	top: 0;
	left: 0;

	opacity: 1;
	transition: opacity 300ms 200ms;

	/* Bring the unmute forward so that it is on top of the recirc overlay */
	z-index: 1;
}

:host(.hide)
{
	opacity: 0;
	pointer-events: none;
}

:host(.pushDown)
{
	padding-top: calc(1.5em + 25px);
}

:host, :host *
{
	cursor: pointer;
}

:host button
{
	border: 0;
	border-radius: 100vw;
	padding: var(--padding);
	background: var(--unmuteBackgroundColor);
	color: var(--unmuteColor);

	width: var(--width);
	height: var(--width);
	white-space: nowrap;
	overflow: hidden;
}

:host button span
{
	font-size: var(--fontSize);
}

:host button :first-child
{
	transition: margin-left 300ms;
}

:host button :first-child
{
	margin-left: -0.25px;
}

:host button.unmuted :first-child
{
	margin-left: calc(-1 * (var(--fontSize) + var(--padding) - 1px) );
}
`;var jh=`<button class='\${iconClass}'>
    <span class='material-icons'>volume_off</span>
    <span class='material-icons'>volume_up</span>
</button>
`;var co=le(Symbol("StnMuteButton")),Hh=document.createElement("template");Hh.innerHTML=`<style>
${Vh}</style>${jh}
`;var db="stn-mute-button",Wh=class extends ke{constructor(){super();let e=new class{constructor(){k(this,"muted",!0)}get iconClass(){return this.muted?"muted":"unmuted"}};ye(e),Object.freeze(e);let t=this.attachShadow({mode:Re?"open":"closed"}),n=$e(Hh.content.cloneNode(!0),e);t.append(...St(),n),co(this,{shadow:t,model:e}),this.addEventListener("click",j(()=>{e.muted=!e.muted}))}get muted(){return co(this).model.muted}set muted(e){L(()=>{co(this).model.muted=e})}};customElements.define(db,Wh);var Kh=`:host
{
    display: block;
}`;var uo="start",ho="stop",fs="change",Wi="complete",si="unmeasureable",fo="inview",mo="outview",hb=Object.freeze({__proto__:null,START:uo,STOP:ho,CHANGE:fs,COMPLETE:Wi,UNMEASUREABLE:si,INVIEW:fo,OUTVIEW:mo}),po=class{constructor(e){this.duration=e,this.listeners=[],this.completed=!1}timerComplete(){this.completed=!0,this.listeners.forEach(e=>e())}elapsed(e){typeof e=="function"&&this.listeners.push(e)}start(){this.endTimer(),this.timer=setTimeout(this.timerComplete.bind(this),this.duration)}stop(){this.endTimer()}endTimer(){this.timer&&(clearTimeout(this.timer),this.listeners.length=0)}dispose(){this.endTimer()}},Ki=class{constructor(){this.listeners={inView:[],outView:[],changeView:[]},this.percentViewable=0}onInView(e){return this.addCallback(e,"inView")}onChangeView(e){return this.addCallback(e,"changeView")}onOutView(e){return this.addCallback(e,"outView")}addCallback(e,t){if(typeof e=="function"&&this.listeners[t])this.listeners[t].push(e);else if(typeof e!="function")throw"callback must be function";return this}start(){}dispose(){}get unmeasureable(){return!1}get viewable(){return!1}get techniqueName(){return"BaseTechnique"}},fb=r=>typeof r=="function"&&Object.getOwnPropertyNames(Ki).reduce((t,n)=>n&&typeof r[t]==typeof Ki[t],!0),mb=r=>r&&r.toString().indexOf("Element")>-1,pb=({inViewThreshold:r,timeInView:e})=>{let t=!1,n=[];return(typeof r!="number"||r>1)&&(t=!0,n.push("inViewThreshold must be a number equal to or less than 1")),(typeof e!="number"||e<0)&&(t=!0,n.push("timeInView must be a number greater to or equal 0")),{invalid:t,reasons:n.join(" | ")}},qh=({autostart:r,techniques:e,criteria:t})=>{let n=!1,i=[];typeof r!="boolean"&&(n=!0,i.push("autostart must be boolean")),(!Array.isArray(e)||e.length===0)&&(n=!0,i.push("techniques must be an array containing atleast on measurement techniques"));let s=pb(t);return s.invalid&&(n=!0,i.push(s.reasons)),{invalid:n,reasons:i.join(" | ")}},ms=class extends Ki{constructor(e,t=ai.criteria){super(e,t);if(t!==void 0&&e)this.element=e,this.criteria=t,this.inView=!1,this.started=!1,this.notificationLevels=[0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1],this.notificationLevels.indexOf(this.criteria.inViewThreshold)===-1&&this.notificationLevels.push(this.criteria.inViewThreshold);else if(!e)throw"element not provided"}start(){this.observer=new window.IntersectionObserver(this.viewableChange.bind(this),{threshold:this.notificationLevels}),this.observer.observe(this.element)}dispose(){this.observer&&(this.observer.unobserve(element),this.observer.disconnect(element))}get unmeasureable(){return!window.IntersectionObserver||this.usesPolyfill||!mb(this.element)}get viewable(){return this.inView}get techniqueName(){return"IntersectionObserver"}get usesPolyfill(){return typeof window.IntersectionObserver.prototype.THROTTLE_TIMEOUT=="number"}viewableChange(e){e&&e.length&&e[0].intersectionRatio!==void 0&&(this.percentViewable=e[0].intersectionRatio,e[0].intersectionRatio<this.criteria.inViewThreshold&&this.started&&this.inView&&(this.inView=!1,this.listeners.outView.forEach(t=>t())),e[0].intersectionRatio>=this.criteria.inViewThreshold&&!this.inView&&(this.started=!0,this.inView=!0,this.listeners.inView.forEach(t=>t())),this.listeners.changeView.forEach(t=>t()))}};(function(){if(typeof window!="object")return;if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype){"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});return}function r(y){try{return y.defaultView&&y.defaultView.frameElement||null}catch(b){return null}}var e=function(y){for(var b=y,E=r(b);E;)b=E.ownerDocument,E=r(b);return b}(window.document),t=[],n=null,i=null;function s(y){this.time=y.time,this.target=y.target,this.rootBounds=m(y.rootBounds),this.boundingClientRect=m(y.boundingClientRect),this.intersectionRect=m(y.intersectionRect||f()),this.isIntersecting=!!y.intersectionRect;var b=this.boundingClientRect,E=b.width*b.height,C=this.intersectionRect,w=C.width*C.height;E?this.intersectionRatio=Number((w/E).toFixed(4)):this.intersectionRatio=this.isIntersecting?1:0}function a(y,b){var E=b||{};if(typeof y!="function")throw new Error("callback must be a function");if(E.root&&E.root.nodeType!=1&&E.root.nodeType!=9)throw new Error("root must be a Document or Element");this._checkForIntersections=l(this._checkForIntersections.bind(this),this.THROTTLE_TIMEOUT),this._callback=y,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(E.rootMargin),this.thresholds=this._initThresholds(E.threshold),this.root=E.root||null,this.rootMargin=this._rootMarginValues.map(function(C){return C.value+C.unit}).join(" "),this._monitoringDocuments=[],this._monitoringUnsubscribes=[]}a.prototype.THROTTLE_TIMEOUT=100,a.prototype.POLL_INTERVAL=null,a.prototype.USE_MUTATION_OBSERVER=!0,a._setupCrossOriginUpdater=function(){return n||(n=function(y,b){!y||!b?i=f():i=p(y,b),t.forEach(function(E){E._checkForIntersections()})}),n},a._resetCrossOriginUpdater=function(){n=null,i=null},a.prototype.observe=function(y){var b=this._observationTargets.some(function(E){return E.element==y});if(!b){if(!(y&&y.nodeType==1))throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:y,entry:null}),this._monitorIntersections(y.ownerDocument),this._checkForIntersections()}},a.prototype.unobserve=function(y){this._observationTargets=this._observationTargets.filter(function(b){return b.element!=y}),this._unmonitorIntersections(y.ownerDocument),this._observationTargets.length==0&&this._unregisterInstance()},a.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorAllIntersections(),this._unregisterInstance()},a.prototype.takeRecords=function(){var y=this._queuedEntries.slice();return this._queuedEntries=[],y},a.prototype._initThresholds=function(y){var b=y||[0];return Array.isArray(b)||(b=[b]),b.sort().filter(function(E,C,w){if(typeof E!="number"||isNaN(E)||E<0||E>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return E!==w[C-1]})},a.prototype._parseRootMargin=function(y){var b=y||"0px",E=b.split(/\s+/).map(function(C){var w=/^(-?\d*\.?\d+)(px|%)$/.exec(C);if(!w)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(w[1]),unit:w[2]}});return E[1]=E[1]||E[0],E[2]=E[2]||E[0],E[3]=E[3]||E[1],E},a.prototype._monitorIntersections=function(y){var b=y.defaultView;if(!!b&&this._monitoringDocuments.indexOf(y)==-1){var E=this._checkForIntersections,C=null,w=null;this.POLL_INTERVAL?C=b.setInterval(E,this.POLL_INTERVAL):(c(b,"resize",E,!0),c(y,"scroll",E,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in b&&(w=new b.MutationObserver(E),w.observe(y,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))),this._monitoringDocuments.push(y),this._monitoringUnsubscribes.push(function(){var I=y.defaultView;I&&(C&&I.clearInterval(C),u(I,"resize",E,!0)),u(y,"scroll",E,!0),w&&w.disconnect()});var O=this.root&&(this.root.ownerDocument||this.root)||e;if(y!=O){var S=r(y);S&&this._monitorIntersections(S.ownerDocument)}}},a.prototype._unmonitorIntersections=function(y){var b=this._monitoringDocuments.indexOf(y);if(b!=-1){var E=this.root&&(this.root.ownerDocument||this.root)||e,C=this._observationTargets.some(function(S){var I=S.element.ownerDocument;if(I==y)return!0;for(;I&&I!=E;){var N=r(I);if(I=N&&N.ownerDocument,I==y)return!0}return!1});if(!C){var w=this._monitoringUnsubscribes[b];if(this._monitoringDocuments.splice(b,1),this._monitoringUnsubscribes.splice(b,1),w(),y!=E){var O=r(y);O&&this._unmonitorIntersections(O.ownerDocument)}}}},a.prototype._unmonitorAllIntersections=function(){var y=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0,this._monitoringUnsubscribes.length=0;for(var b=0;b<y.length;b++)y[b]()},a.prototype._checkForIntersections=function(){if(!(!this.root&&n&&!i)){var y=this._rootIsInDom(),b=y?this._getRootRect():f();this._observationTargets.forEach(function(E){var C=E.element,w=h(C),O=this._rootContainsTarget(C),S=E.entry,I=y&&O&&this._computeTargetAndRootIntersection(C,w,b),N=null;this._rootContainsTarget(C)?(!n||this.root)&&(N=b):N=f();var B=E.entry=new s({time:o(),target:C,boundingClientRect:w,rootBounds:N,intersectionRect:I});S?y&&O?this._hasCrossedThreshold(S,B)&&this._queuedEntries.push(B):S&&S.isIntersecting&&this._queuedEntries.push(B):this._queuedEntries.push(B)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)}},a.prototype._computeTargetAndRootIntersection=function(y,b,E){if(window.getComputedStyle(y).display!="none"){for(var C=b,w=T(y),O=!1;!O&&w;){var S=null,I=w.nodeType==1?window.getComputedStyle(w):{};if(I.display=="none")return null;if(w==this.root||w.nodeType==9)if(O=!0,w==this.root||w==e)n&&!this.root?!i||i.width==0&&i.height==0?(w=null,S=null,C=null):S=i:S=E;else{var N=T(w),B=N&&h(N),A=N&&this._computeTargetAndRootIntersection(N,B,E);B&&A?(w=N,S=p(B,A)):(w=null,C=null)}else{var M=w.ownerDocument;w!=M.body&&w!=M.documentElement&&I.overflow!="visible"&&(S=h(w))}if(S&&(C=d(S,C)),!C)break;w=w&&T(w)}return C}},a.prototype._getRootRect=function(){var y;if(this.root&&!_(this.root))y=h(this.root);else{var b=_(this.root)?this.root:e,E=b.documentElement,C=b.body;y={top:0,left:0,right:E.clientWidth||C.clientWidth,width:E.clientWidth||C.clientWidth,bottom:E.clientHeight||C.clientHeight,height:E.clientHeight||C.clientHeight}}return this._expandRectByRootMargin(y)},a.prototype._expandRectByRootMargin=function(y){var b=this._rootMarginValues.map(function(C,w){return C.unit=="px"?C.value:C.value*(w%2?y.width:y.height)/100}),E={top:y.top-b[0],right:y.right+b[1],bottom:y.bottom+b[2],left:y.left-b[3]};return E.width=E.right-E.left,E.height=E.bottom-E.top,E},a.prototype._hasCrossedThreshold=function(y,b){var E=y&&y.isIntersecting?y.intersectionRatio||0:-1,C=b.isIntersecting?b.intersectionRatio||0:-1;if(E!==C)for(var w=0;w<this.thresholds.length;w++){var O=this.thresholds[w];if(O==E||O==C||O<E!=O<C)return!0}},a.prototype._rootIsInDom=function(){return!this.root||g(e,this.root)},a.prototype._rootContainsTarget=function(y){var b=this.root&&(this.root.ownerDocument||this.root)||e;return g(b,y)&&(!this.root||b==y.ownerDocument)},a.prototype._registerInstance=function(){t.indexOf(this)<0&&t.push(this)},a.prototype._unregisterInstance=function(){var y=t.indexOf(this);y!=-1&&t.splice(y,1)};function o(){return window.performance&&performance.now&&performance.now()}function l(y,b){var E=null;return function(){E||(E=setTimeout(function(){y(),E=null},b))}}function c(y,b,E,C){typeof y.addEventListener=="function"?y.addEventListener(b,E,C||!1):typeof y.attachEvent=="function"&&y.attachEvent("on"+b,E)}function u(y,b,E,C){typeof y.removeEventListener=="function"?y.removeEventListener(b,E,C||!1):typeof y.detachEvent=="function"&&y.detachEvent("on"+b,E)}function d(y,b){var E=Math.max(y.top,b.top),C=Math.min(y.bottom,b.bottom),w=Math.max(y.left,b.left),O=Math.min(y.right,b.right),S=O-w,I=C-E;return S>=0&&I>=0&&{top:E,bottom:C,left:w,right:O,width:S,height:I}||null}function h(y){var b;try{b=y.getBoundingClientRect()}catch(E){}return b?(b.width&&b.height||(b={top:b.top,right:b.right,bottom:b.bottom,left:b.left,width:b.right-b.left,height:b.bottom-b.top}),b):f()}function f(){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}function m(y){return!y||"x"in y?y:{top:y.top,y:y.top,bottom:y.bottom,left:y.left,x:y.left,right:y.right,width:y.width,height:y.height}}function p(y,b){var E=b.top-y.top,C=b.left-y.left;return{top:E,left:C,height:b.height,width:b.width,bottom:E+b.height,right:C+b.width}}function g(y,b){for(var E=b;E;){if(E==y)return!0;E=T(E)}return!1}function T(y){var b=y.parentNode;return y.nodeType==9&&y!=e?r(y):(b&&b.assignedSlot&&(b=b.assignedSlot.parentNode),b&&b.nodeType==11&&b.host?b.host:b)}function _(y){return y&&y.nodeType===9}window.IntersectionObserver=a,window.IntersectionObserverEntry=s})();var zh=(r={})=>({viewportWidth:Math.max(document.body.clientWidth,window.innerWidth)||-1,viewportHeight:Math.max(document.body.clientHeight,window.innerHeight)||-1,elementWidth:r.clientWidth||-1,elementHeight:r.clientHeight||-1,iframeContext:go(),focus:gb()}),gb=()=>document.hidden!=="undefined"&&document.hidden===!0?!1:go()===oi.CROSS_DOMAIN_IFRAME?!0:window.document.hasFocus?window.top.document.hasFocus():!0,go=()=>{try{if(window.top===window)return oi.ON_PAGE;let r=window,e=0;for(;r.parent!==r&&e<1e3;){if(r.parent.document.domain!==r.document.domain)return oi.CROSS_DOMAIN_IFRAME;r=r.parent}oi.SAME_DOMAIN_IFRAME}catch(r){return oi.CROSS_DOMAIN_IFRAME}},oi={ON_PAGE:"on page",SAME_DOMAIN_IFRAME:"same domain iframe",CROSS_DOMAIN_IFRAME:"cross domain iframe"},vo=class extends ms{get unmeasureable(){return go()===oi.CROSS_DOMAIN_IFRAME}get techniqueName(){return"IntersectionObserverPolyFill"}},vb=Object.freeze({__proto__:null,IntersectionObserver:ms,IntersectionObserverPolyfill:vo,BaseTechnique:Ki}),Yh={inViewThreshold:.5,timeInView:2e3},yb={inViewThreshold:.5,timeInView:1e3},bb=(r=.5,e=2e3)=>({inViewThreshold:r,timeInView:e}),Tb=Object.freeze({__proto__:null,MRC_VIDEO:Yh,MRC_DISPLAY:yb,customCriteria:bb}),ai={autostart:!0,techniques:[ms,vo],criteria:Yh},Eb=(r=ai.autostart,e=ai.techniques,t=ai.criteria)=>{let n={autostart:r,techniques:e,criteria:t},i=qh(n);if(i.invalid)throw i.reasons;return n},Sb=Object.freeze({__proto__:null,DEFAULT_STRATEGY:ai,StrategyFactory:Eb}),yo=class{constructor(e,t={}){this._listeners={start:[],stop:[],change:[],complete:[],unmeasureable:[]},this._element=e,this._strategy=Object.assign({},ai,t),this._criteriaMet=!1;let n=qh(this._strategy);if(n.invalid)throw n.reasons;this._technique=this._selectTechnique(this._strategy.techniques),this._technique&&this._addSubscriptions(this._technique),this.unmeasureable?setTimeout(()=>this._publish(si,zh(this._element)),0):this._strategy.autostart&&this._technique.start()}start(){this._technique.start()}dispose(){this._technique&&this._technique.dispose(),this.timer&&this.timer.dispose()}onViewableStart(e){return this._addCallback(e,uo)}onViewableStop(e){return this._addCallback(e,ho)}onViewableChange(e){return this._addCallback(e,fs)}onViewableComplete(e){return this._addCallback(e,Wi),this.criteriaMet&&this._techniqueChange(Wi,this._technique),this}onUnmeasureable(e){return this._addCallback(e,si),this.unmeasureable&&this._techniqueChange(si),this}get unmeasureable(){return!this._technique||this._technique.unmeasureable}_selectTechnique(e){return e.filter(fb).map(this._instantiateTechnique.bind(this)).find(t=>!t.unmeasureable)}_instantiateTechnique(e){return new e(this._element,this._strategy.criteria)}_addSubscriptions(e){e&&(e.onInView(this._techniqueChange.bind(this,fo,e)),e.onChangeView(this._techniqueChange.bind(this,fs,e)),e.onOutView(this._techniqueChange.bind(this,mo,e)))}_techniqueChange(e,t={}){let n,i=this._appendEnvironment(t);switch(e){case fo:this._criteriaMet||(this.timer=new po(this._strategy.criteria.timeInView),this.timer.elapsed(this._timerElapsed.bind(this,t)),this.timer.start(),n=uo);break;case fs:n=e;break;case Wi:this._criteriaMet||(this._criteriaMet=!0,n=e);break;case mo:this._criteriaMet||(this.timer&&(this.timer.stop(),delete this.timer),n=ho);break;case si:n=si}n&&this._publish(n,i)}_publish(e,t){Array.isArray(this._listeners[e])&&this._listeners[e].forEach(n=>n(t))}_timerElapsed(e){this._techniqueChange(Wi,e)}_addCallback(e,t){if(this._listeners[t]&&typeof e=="function")this._listeners[t].push(e);else if(typeof e!="function")throw"Callback must be a function";return this}_appendEnvironment(e){return Object.assign({},{percentViewable:typeof e.percentViewable=="undefined"?-1:e.percentViewable,technique:e.techniqueName||-1,viewable:typeof e.viewable=="undefined"?-1:e.viewable},zh(this._element))}},En=class{constructor(){this.executors=[]}measureElement(e,t){let n=new yo(e,t);return this.executors.push(n),n}dispose(){this.executors.forEach(e=>e.dispose())}};En.ViewabilityCriteria=Tb;En.MeasurementExecutor=yo;En.MeasurementTechniques=vb;En.InViewTimer=po;En.Strategies=Sb;En.Events=hb;var qi=En;var Xh=document.createElement("template");Xh.innerHTML=`<slot></slot><style>
${Kh}</style>
`;var ee,_b="stn-ima",bo=class extends ke{connectedCallback(){console.log("Connected"),L(()=>ee(this).model.isConnected=!0)}disconnectedCallback(){console.log("Disconnected"),L(()=>ee(this).model.isConnected=!1)}constructor(){super();let e=this.attachShadow({mode:Re?"open":"closed"});e.appendChild(Xh.content.cloneNode(!0));let t=new class{constructor(){k(this,"isConnected",!1);k(this,"adDisplayContainer",null);k(this,"adsLoader",null);k(this,"adIndex",null);k(this,"insecureVpaid",!0);k(this,"adsRequest",null);k(this,"adsManager",null);k(this,"browserPause",!0);k(this,"dv",null);k(this,"openvv");k(this,"playerModelOpenvv",!1);k(this,"dvLogging",!1);k(this,"volume",1);k(this,"muted",!0);k(this,"hasEverBeenUnmuted",!1);k(this,"ready",!1);k(this,"width",null);k(this,"height",null);k(this,"src","");k(this,"paused",!0);k(this,"waiting",!1);k(this,"adsRequested",!1);k(this,"allAdsCompleted",!1);k(this,"contentCompleteCalled",!1);k(this,"contentCurrentTime",0);k(this,"contentEnded",!1);k(this,"error",null);k(this,"waitForClientBid",!1);k(this,"contentPauseRequested",!0);k(this,"isLinear",null);k(this,"companionAd",{});k(this,"started",!1);k(this,"adQuartile",null);k(this,"adCurrentTime",null);k(this,"adPosition",null);k(this,"totalAds",null);k(this,"adLength",null);k(this,"adCuePoints",[]);k(this,"pageGestureTarget",null);k(this,"lineItem",0);k(this,"adX",!1);k(this,"iframe",null);k(this,"impression",{});k(this,"removeMidrolls",!1);k(this,"rawPaused",!0);k(this,"hasEverStarted",!1);k(this,"preventImaRefreshOfGpt",!1)}get contentShouldPause(){let{waitForClientBid:i,ended:s,contentPauseRequested:a,isLinear:o}=this;return i||!(s||!a||o===!1)}get ended(){let{waitForClientBid:i,allAdsCompleted:s,error:a}=this;return!!(!i&&s||a)}};ye(t),Object.freeze(t),x(()=>!t.muted,i=>t.hasEverBeenUnmuted|=i);let n={shadow:e,model:t,started:!1};ee(this,n),new ResizeObserver(j(i=>{let{length:s}=i,{width:a,height:o}=i[s-1].contentRect;t.height=o,t.width=a})).observe(this),Di.then(i=>Q(()=>t.isConnected).then(()=>i)).then(j(i=>{x(()=>{let{waitForClientBid:f,allAdsCompleted:m,error:p}=t;return!!(m||p)&&f},f=>{if(!f)return;this.src.prebidBid?.resolve(null);let m=Xn.requestBid(!1);if(!m){t.waitForClientBid=!1;return}t.adsLoader.contentComplete();let g=new i.AdsRequest;g.isClientAdRequest=!0,g.clientInfo={provider:Object.keys(m.cpm)[0]==="amazon"?"amazon":m.params.hb_bidder,cpm:Object.values(m.cpm)[0]},h(g,Object.values(m.vastURL)[0])});let s=i.AdEvent.Type,a={};for(let f of Object.keys(s).sort())!s.hasOwnProperty(f)||!f.match(/^[A-Z_]+$/)||(a[f]=s[f]);ie&&console.table(a),n.ima=i,Qh(i,t);let o=e.querySelector("slot").assignedElements({flatten:!0})[0];t.adDisplayContainer=new i.AdDisplayContainer(o),t.adDisplayContainer.initialize(),t.adsLoader=new i.AdsLoader(t.adDisplayContainer),t.iframe=o.querySelector("iframe");let l=[...o.childNodes].flatMap(f=>[...f.querySelectorAll?.('video, [playsinline], [title="Advertisement"]:not(iframe)')??[]]);l.filter(f=>f.tagName==="LIMA-VIDEO").map(f=>f.shadowRoot.firstElementChild).filter(f=>f.tagName==="VIDEO").forEach(f=>{try{let m=Object.getOwnPropertyDescriptor(HTMLMediaElement.prototype,"src");Object.defineProperty(f,"src",{get:()=>m.get.call(f),set:p=>m.set.call(f,p??"")&&!p&&f.removeAttribute("src")})}catch(m){}}),Q(()=>t.pageGestureTarget,()=>{let f=l.map(m=>new Oi(m,t.pageGestureTarget));P(()=>f.forEach(m=>m.muted=t.muted)),P(()=>f.forEach(m=>m.volume=t.volume))});let c,u=()=>{c&&c.executors.forEach(f=>f._listeners={})};x(()=>t.playerModelOpenvv&&t.openvv!==void 0&&this.adPlaying,f=>{if(!f)return;u(),c=new qi;let m=!0,p=[qi.MeasurementTechniques.IntersectionObserver,qi.MeasurementTechniques.IntersectionObserverPolyfill],g={inViewThreshold:.5,timeInView:2e3},T=qi.Strategies.StrategyFactory(m,p,g),_=this.adIndex;l.forEach(y=>{c.measureElement(y,T).onViewableStart(b=>{L(()=>t.openvv={...b,type:"start",adIndex:_})}).onViewableStop(b=>{L(()=>t.openvv={...b,type:"stop",adIndex:_})}).onViewableChange(b=>{L(()=>t.openvv={...b,type:"change",adIndex:_})}).onViewableComplete(b=>{L(()=>t.openvv={...b,type:"complete",adIndex:_}),u()}).onUnmeasureable(()=>{L(()=>t.openvv={...args,type:"unmeasureable",adIndex:_}),u()})})},{fireImmediately:!0});let d={};P(()=>d.currentTime=t.contentCurrentTime);let h=(f,m)=>{f.adTagUrl=m,t.adsRequested=!1,t.error=null,t.paused=!1,t.started=!1,t.adsRequest=f};x(()=>[t.contentCurrentTime,t.adCuePoints],(f,m)=>{let p=f[0],g=p===0?-Infinity:m[0],T=f[1],_=Object.keys(T).map(Number).sort().filter(y=>y>=g&&y<=p);try{let y=_[0],E=T[y][0].querySelector("AdTagURI").textContent,C=new i.AdsRequest;Wt(function*(){let O=y===Infinity,S=y===-Infinity;if(!O&&!S){yield Q(()=>t.removeMidrolls!==null);let N=L(()=>t.removeMidrolls);if(Ci(`Should${N?" ":" NOT "}Remove Midrolls`),N){h(C,null);return}}O?t.adIndex=0:S?t.adIndex=-1:t.adIndex===null?t.adIndex=1:t.adIndex++,h(C,yield this.getAdTagUrl(E))}).call(this)}catch(y){}}),t.adsLoader.addEventListener(i.AdErrorEvent.Type.AD_ERROR,j(f=>{t.error=f.getError().getMessage(),t.allAdsCompleted=!0})),t.adsLoader.addEventListener(i.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,f=>{try{L(()=>t.preventImaRefreshOfGpt)&&ce.googletag.companionAds().notifyUnfilledSlots(!1)}catch(y){}let m=f.getUserRequestContext();if(!m)throw new Error("IMA SDK failed to provide a request context");L(()=>{if(t.adsRequest!==m)throw new Error("AdsRequest returned but does not match current AdsRequest")});let{isClientAdRequest:p,clientInfo:g}=m,T=new i.AdsRenderingSettings;T.restoreCustomPlaybackStateOnAdBreakComplete=!1,T.uiElements=null,T.useStyledNonLinearAds=!0;let _=f.getAdsManager(d,T);if(ie){let y=function({type:b}){console.log("IMA Event %o",b)};Object.values(a).forEach(b=>_.addEventListener(b,y))}Q(()=>t.dvLogging,()=>{let y=b=>{Array.from(b.querySelectorAll('iframe[src="about:blank"]')).forEach(C=>{try{C.contentWindow.navigator.sendBeacon=(...w)=>{let O=new URL(w[0]),S=O.hostname,I=O.pathname;if(S.endsWith("doubleverify.com")&&I==="/event.png"){let N=Object.fromEntries(O.searchParams);L(()=>t.dv=N)}navigator.sendBeacon(...w)},y(C.contentDocument)}catch(w){}})};_.addEventListener(i.AdEvent.Type.AD_CAN_PLAY,b=>{L(()=>t.dv=null),y(o)})}),_.addEventListener(i.AdEvent.Type.IMPRESSION,j(y=>{t.waitForClientBid=!1,t.adQuartile=0;let b,E,C,w,O,S=null,I,N=t.adIndex,B;try{let G=y.getAd(),q=G.getWrapperAdIds().slice();q.length===0&&q.push(G.getAdId());let Y=G.getWrapperAdSystems().slice();Y.length===0&&Y.push(G.getAdSystem());let W=Y.map(K=>K.toLowerCase());O=W.map((K,ue)=>K==="gdfp"?q[ue]:null).filter(K=>K!==null),I=W.includes("adx")||W.includes("adsense/adx"),ie&&console.log({adSystems:Y,lineItems:q,lineItemsGDFP:O,adX:I}),b=q.slice(-1)[0],E=Y.slice(-1)[0],C=q[0],w=Y[0],B=G.getAdvertiserName()}catch(G){S=G.message,console.error(y.getAd(),G)}let{prebidBid:A}=this.src;A?.resolve(b);let M={adX:I,lineItem:b,adSystem:E,firstLineItem:C,firstAdSystem:w,lineItemsGDFP:O,error:S,adIndex:N,advertiser:B,isClientAdRequest:p,bidProvider:g?.provider,bidvl:g?.cpm};try{M.bidIndex=this.src.bidTracker?.bidIndex}catch(G){}t.impression=M})),_.addEventListener(i.AdEvent.Type.FIRST_QUARTILE,j(()=>t.adQuartile=1)),_.addEventListener(i.AdEvent.Type.MIDPOINT,j(()=>t.adQuartile=2)),_.addEventListener(i.AdEvent.Type.THIRD_QUARTILE,j(()=>t.adQuartile=3)),_.addEventListener(i.AdEvent.Type.COMPLETE,j(()=>t.adQuartile=4)),_.addEventListener(i.AdEvent.Type.AD_CAN_PLAY,j(()=>{_[t.paused?"pause":"resume"](),t.openvv=null})),_.addEventListener(i.AdEvent.Type.RESUMED,j(()=>t.rawPaused=!1)),_.addEventListener(i.AdEvent.Type.PAUSED,j(()=>t.rawPaused=!0)),_.addEventListener(i.AdEvent.Type.ALL_ADS_COMPLETED,j(()=>{t.allAdsCompleted=!0})),_.addEventListener(i.AdEvent.Type.AD_PROGRESS,j(y=>{let b=y.getAdData();b.hasOwnProperty("currentTime")?t.adCurrentTime=b.currentTime:t.adCurrentTime=b.duration-y.target.getRemainingTime()})),_.addEventListener(i.AdEvent.Type.LOG,j(y=>{let b=[],E=y.getAdData().adError,C=E;for(;C;){let w={code:C.getErrorCode&&C.getErrorCode()||null,message:C.getMessage&&C.getMessage()||C.message||null,type:C.getType&&C.getType()||null,vastCode:C.getVastErrorCode&&C.getVastErrorCode()||null};b.push(w),C=C.getInnerError&&C.getInnerError()||null}console.warn(`IMA Error (LOG Event):
${b.map(()=>`%o
`)}%s`,...b,E.stack)})),_.addEventListener(i.AdEvent.Type.VOLUME_CHANGED,()=>{let y=_.getVolume(),b;L(()=>b=t.muted?0:t.volume),(b===0&&y!==0||Math.abs(y-b)>.1)&&_.setVolume(b)}),_.addEventListener(i.AdEvent.Type.CONTENT_PAUSE_REQUESTED,j(()=>t.contentPauseRequested=!0)),_.addEventListener(i.AdEvent.Type.CONTENT_RESUME_REQUESTED,j(()=>t.contentPauseRequested=!1)),_.addEventListener(i.AdEvent.Type.COMPLETE,j(()=>t.isLinear=null)),_.addEventListener(i.AdEvent.Type.SKIPPED,j(()=>t.isLinear=null)),_.addEventListener(i.AdEvent.Type.STARTED,j(y=>{_.setVolume(_.getVolume()),t.rawPaused=!1,t.waiting=!1;let b=y.getAd();t.isLinear=b.isLinear();let E=i.CompanionAdSelectionSettings,C=new E;C.resourceType=E.ResourceType.STATIC,C.creativeType=E.CreativeType.IMAGE,C.sizeCriteria=E.SizeCriteria.SELECT_NEAR_MATCH,C.nearMatchPercent=80;let w=b.getCompanionAds(320,60,C),O=w[0]?.getContent()??"";if(O){let S=w[0].getWidth(),I=w[0].getHeight();t.companionAd={content:O,width:S,height:I}}try{t.adPosition=b.getAdPodInfo().getAdPosition()}catch(S){t.adPosition=null}try{t.totalAds=b.getAdPodInfo().getTotalAds()}catch(S){t.totalAds=null}try{t.adLength=b.getDuration()}catch(S){t.adLength=null}t.adCurrentTime=0})),L(()=>{_.init(t.width,t.height,i.ViewMode.NORMAL),t.adsManager=_})}),x(()=>[t.adsManager,t.paused,t.rawPaused],([f,m,p],g)=>{let[,,T]=g||[],_=m!==p,y=p!==T;f&&!_&&!t.paused&&(t.hasEverStarted=!0),!(!f||!_)&&(t.browserPause=y?p:null,!y&&(t.paused?f.pause():f.resume()))},{fireImmediately:!0}),x(()=>t.contentEnded,f=>{ie&&console.log("Content Ended %o",f),t.contentEnded&&(t.contentCompleteCalled=!0,t.companionAd={},t.adIndex=null)}),x(()=>t.contentCompleteCalled,f=>{ie&&console.log("Content Complete %o",f),f&&t.adsLoader.contentComplete()}),x(()=>[t.adsRequest,t.height],([f,m])=>{!f||!m||(ie&&console.log("AdsRequest Height Set %o",m),Object.assign(f,{linearAdSlotHeight:m,nonLinearAdSlotHeight:m}))}),x(()=>[t.adsRequest,t.width],([f,m])=>{!f||!m||(ie&&console.log("AdsRequest Width Set %o",m),Object.assign(f,{linearAdSlotWidth:m,nonLinearAdSlotWidth:m}))}),x(()=>[t.adsRequest,!t.paused&&!t.adsRequested],Wt(function*([m,p]){if(!m||!p)return;ie&&console.log("AdsRequest Request Ads");try{if(m.adTagUrl&&new URL(m.adTagUrl).searchParams.get("ad_rule")==="1"){let E=function(w){let O;return w==="start"?-Infinity:w==="end"?Infinity:(O=w.match(/^([0-9]{2}):([0-9]{2}):([0-9]{2})/),O?O[1]*60*60+O[2]*60+O[3]*1:null)},T=yield fetch(m.adTagUrl);m.adTagUrl="";let _=yield T.text(),C=[...new DOMParser().parseFromString(_,"text/xml").querySelectorAll("AdBreak")];if(!C.length){t.allAdsCompleted=!0;return}t.adCuePoints=C.reduce((w,O)=>{let S=E(O.getAttribute("timeOffset"));return S!==null&&(w[S]=(w[S]||[]).concat(O)),w},{});return}}catch(T){console.error(T),m.adTagUrl="",m.adsResponse=""}m.forceNonLinearFullSlot=!1,m.setContinuousPlayback(!0);let g=L(()=>t.hasEverBeenUnmuted);ie&&console.log("AdsRequest AutoPlay %o",!g),m.setAdWillAutoPlay(!g),t.adsRequested=!0,t.waiting=!0,t.waitForClientBid=!0,t.allAdsCompleted=!1,Qh(i,t),t.adsLoader.requestAds(m,m)}.bind(this))),x(()=>[t.adsManager,t.muted?0:t.volume],([f,m])=>{!f||(ie&&console.log("AdsManager SetVolume %o",m),f.setVolume(m))}),x(()=>[t.adsManager,t.width,t.height],([f,m,p])=>{!f||(ie&&console.log("AdsManager Resize %ox%o",m,p),f.resize(t.width,t.height,i.ViewMode.NORMAL))}),x(()=>[t.adsManager,t.paused,t.isLinear],([f,m,p])=>{if(!f)return;let g=m?"pause":t.started?"resume":"start";!p&&g!=="start"||(ie&&console.log("AdsManager Start/Pause/Resume %o",g),m||(t.started=!0),f[g]())}),x(()=>{let{ready:f,src:m}=t;return f&&m},f=>{if(t.adsRequested=!1,t.contentCompleteCalled=!1,t.allAdsCompleted=!1,t.error=null,t.contentPauseRequested=!0,t.isLinear=null,t.companionAd={},t.adsManager&&(t.adsManager.destroy(),t.adsManager=null),t.adsLoader.contentComplete(),t.adsRequest=null,t.started=!1,t.adCuePoints=[],!t.src){t.src===!1&&(t.error="Ad not configured");return}Wt(function*(){let p=new i.AdsRequest;p.adTagUrl=yield this.getAdTagUrl(),t.adsRequest=p}.bind(this))()},{equals:()=>!1,fireImmediately:!0}),t.ready=!0}),j(i=>{t.error=i,t.allAdsCompleted=!0}))}set preventImaRefreshOfGpt(e){L(()=>ee(this).model.preventImaRefreshOfGpt=!!e)}get muted(){return ee(this).model.muted}set muted(e){L(()=>ee(this).model.muted=!!e)}get volume(){return ee(this).model.volume}set volume(e){if(e=parseFloat(e),isNaN(e))throw new Error("Volume is not a number");if(e<0)throw new Error("Volume is less than 0");if(e>1)throw new Error("Volume is more than 1");L(()=>ee(this).model.volume=e)}get height(){return ee(this).model.height}get width(){return ee(this).model.width}set src(e){L(()=>{ee(this).model.src="",ee(this).model.src=e})}get src(){return ee(this).model.src}get ended(){return ee(this).model.ended}get paused(){return ee(this).model.paused}get waiting(){let e=ee(this).model.waiting;return this.contentShouldPause&&e}get isLinear(){return ee(this).model.isLinear}get browserPause(){return ee(this).model.browserPause}set contentCurrentTime(e){L(()=>ee(this).model.contentCurrentTime=e)}set contentEnded(e){L(()=>ee(this).model.contentEnded=e)}get contentShouldPause(){return ee(this).model.contentShouldPause}get companionAd(){return ee(this).model.companionAd}get adQuartile(){return ee(this).model.adQuartile}get adCompleted(){return this.isLinear===null}get adPlaying(){return this.isLinear===!0}get adCurrentTime(){return ee(this).model.adCurrentTime}get adPosition(){return ee(this).model.adPosition}get totalAds(){return ee(this).model.totalAds}get adLength(){return ee(this).model.adLength}get adCuePoints(){return Object.keys(ee(this).model.adCuePoints)}get started(){return ee(this).model.started}get impression(){return ee(this).model.impression}async getAdTagUrl(e){let{src:t}=ee(this).model,n=this.adIndex,i,s,a=[];if(e){t.newParams();let d=t.getPrebid(),h=t.getOptimeraParams();({result:i,finalizers:a}=await d);try{let f=L(()=>this.src.bidTracker);f?.incrementBidIndex(),oe.call(this.getRootNode().host.getRootNode().host,"BIDS",{...f?.params,adIndex:n})}catch(f){}s=await h}let{adServerUrlPath:o,param:l}=t;e&&(l.ad_rule=0,l.output="vast");let c=Object.assign({},l.cust_params,i,s);a.forEach(d=>d(c)),c=wt(c);let u=new URL(e??`${o}?${wt(l)}`);return u.searchParams.set("cust_params",c),u.searchParams.set("plcmt",l.plcmt),u.href}play(){L(()=>{ee(this).model.paused=!1})}pause(){L(()=>{ee(this).model.paused=!0})}set pageGestureTarget(e){L(()=>ee(this).model.pageGestureTarget=e)}get insecureVpaid(){L(()=>ee(this).model.insecureVpaid)}set insecureVpaid(e){L(()=>ee(this).model.insecureVpaid=e)}stop(){ee(this).model.adsManager?.stop(),ee(this).model.adsManager?.destroy(),ee(this).model.allAdsCompleted=!0}get frame(){return ee(this).model.iframe}get hasEverStarted(){return ee(this).model.hasEverStarted}get openvv(){return ee(this).model.openvv}set playerModelOpenvv(e){L(()=>ee(this).model.playerModelOpenvv=e)}get dv(){return ee(this).model.dv}set dvLogging(e){L(()=>ee(this).model.dvLogging=e)}get adIndex(){return ee(this).model.adIndex}get allAdsCompleted(){return ee(this).model.allAdsCompleted}set removeMidrolls(e){L(()=>ee(this).model.removeMidrolls=e)}};function Qh(r,e){let t=r.ImaSdkSettings,n=r.settings;n.setAutoPlayAdBreaks(!0),n.setCompanionBackfill(t.CompanionBackfillMode.ALWAYS),n.setCookiesEnabled(!0),n.setDisableCustomPlaybackForIOS10Plus(!0),n.setFeatureFlags({}),n.setLocale("en"),n.setNumRedirects(4),n.setPlayerType("stnvideo/player"),n.setPlayerVersion(""),n.setPpid(),n.setVpaidAllowed(!0),e.insecureVpaid?n.setVpaidMode(t.VpaidMode.INSECURE):n.setVpaidMode(t.VpaidMode.ENABLED)}ee=le(bo);customElements.define(_b,bo);var Jh=`:host
{
    display: block;
    position: relative;
    --translate: -50%;
    overflow: hidden;
}

stn-ima
{
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
}

:host(.manualFullscreen)
{
    position: fixed !important;
    max-width: none !important;
    top: 0 !important;
    left: 0 !important;
    z-index: var(--floatZIndex) !important;
    height: var(--innerHeight) !important;
    width: 100vw !important;
    background: black !important;
}

:host .spinner
{
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
}

/* STN Play Button Logo Spinner */
/* :host .spinner-active */
/* { */
/*     opacity: 0.4; */
/* } */

/* :host .spinner svg */
/* { */
/*     height: 35%; */
/*     width: 35%; */
/* } */

/* :host .spinner svg path */
/* { */
/*     fill: var(--spinnerColor1) */
/* } */

/* :host .spinner svg { */
/*     animation: 2s spin ease infinite; */
/* } */

/* @keyframes spin { */
/*     0% { */
/*         transform: translate(var(--translate), var(--translate)) rotate(0); */
/*     } */
/*     20% { */
/*         transform: translate(var(--translate), var(--translate)) rotate(-45deg); */
/*     } */
/*     60% { */
/*         transform: translate(var(--translate), var(--translate)) rotate(740deg); */
/*     } */
/*     70% { */
/*         transform: translate(var(--translate), var(--translate)) rotate(705deg); */
/*     } */
/*     80% { */
/*         transform: translate(var(--translate), var(--translate)) rotate(725deg); */
/*     } */
/*     90% { */
/*         transform: translate(var(--translate), var(--translate)) rotate(719deg); */
/*     } */
/*     100% { */
/*         transform: translate(var(--translate), var(--translate)) rotate(720deg); */
/*     } */
/* } */

.spinner
{
    width: 65px;
    height: 65px;
    --spinner-duration: 1.4s;
    animation: rotate var(--spinner-duration) linear infinite;
    transform: translate(-50%, -50%);
    color: #95E5E5;
}

.spinner svg
{
    animation: colors calc(var(--spinner-duration) * 4) infinite;
}

.spinner svg circle
{
    stroke: currentColor;
    animation: dash var(--spinner-duration) ease-in-out infinite;
    stroke-dasharray: 80px, 200px;
    stroke-dashoffset: 0;
}

@keyframes rotate
{
    0%
    {
        transform-origin: 50% 50%;
    }
    100%
    {
        transform: translate(-50%, -50%) rotate(360deg);
    }
}

@keyframes dash
{
    0%
    {
        stroke-dasharray: 1px, 200px;
        stroke-dashoffset: 0;
    }

    50%
    {
        stroke-dasharray: 100px, 200px;
        stroke-dashoffset: -15px;
    }

    100%
    {
        stroke-dasharray: 100px, 200px;
        stroke-dashoffset: -125px;
    }
}

@keyframes colors
{
    0%
    {
        color: var(--spinnerColor1);
    }
    25%
    {
        color: var(--spinnerColor2);
    }
    50%
    {
        color: var(--spinnerColor1);
    }
    75%
    {
        color: var(--spinnerColor2);
    }
}

.adInfo
{
    position: absolute;
    left: 1em;
    top: 0.5em;
    color: #FF0;
    font-size: 50%;
    text-shadow: #FFF 0 0 1px, #000 0 0 2px, #000 0 0 2px
}

.pausePlayOverlay
{
    opacity: 0;
    display: flex;
    justify-content: space-evenly;
    align-items: center;
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    color: white;
    background: rgba(0, 0, 0, 0.5);

    /* Pointer events pass through when not active */
    pointer-events: none;

    transition: opacity 300ms;

    /* To be on top of recirc, when we allow this overlay to appear on recirc */
    z-index: 1;
}

stn-control
{
    /* control bar to be on top of the pause overlay */
    z-index: 1;
    border-radius: var(--contentBorderRadius);
}


.pausePlayOverlay div
{
    --min: 32px;
    --idealRatio: 0.16;
    --max: 150px;

    font-size: clamp(var(--min), calc(var(--mediaWidth) * var(--idealRatio)), var(--max));
    width: calc(var(--idealRatio) * 100%);
    aspect-ratio: 1;

    min-width: var(--min);
    min-height: var(--min);
    max-width: var(--max);
    max-height: var(--max);
    text-align: center;
}

.pausePlayOverlay svg
{
    width: 100%;
    height: 100%;
}

.pausePlayOverlay.active
{
    opacity: 1;

    /* When active, enable pointer-events, but only at the end of a delay, */
    /* otherwise the click on the pause overlay to initiate a pause is immediately */
    /* executed */
    animation: pausePlayOverlayDisablePointer 300ms;
    pointer-events: all;
}

@keyframes pausePlayOverlayDisablePointer
{
    0%, 99%
    {
        pointer-events: none;
    }
}

stn-play-button
{
    opacity: 1;
    transition: opacity 300ms;
}

stn-play-button.hide
{
    opacity: 0;
}

.hide
{
    display: none;
}

.companionAd
{
    position: absolute;
    bottom: var(--controlbarHeight);
    transform: translate(-50%, 0);
    left: 50%;
}

.companionAd .close
{
    position: absolute;
    right: 0;
    top: 0;
    transform: translate(35%, -35%);
    background: black;
    color: white;
    border-radius: 100vw;
    font-size: 18px;
    cursor: pointer;
}

.companionAd iframe
{
    border: none;
}

.contextMenu:not(.active)
{
    display: none;
}

.contextMenu
{
    position: absolute;
    top: 0;
    left: 0;
    padding: 1em;
    z-index: 1;
    background: rgba(0, 0, 0, 0.6);
    color: white;
    font-size: xx-small;
    font-family: monospace;
    max-width: 60%;
    white-space: nowrap;
}

.contextMenu div
{
    text-overflow: ellipsis;
    overflow: hidden;
}

.stnEngage
{
    position: absolute;
    color: white;
    z-index: 2;
}

.stnEngage.right
{
    --y: 50%;
    --x: 10px;

    top: var(--y);
    right: var(--x);
    transform: translate(0, calc(-1 * var(--y)));
}

.stnEngage.left
{
    --y: 50%;
    --x: 10px;

    top: var(--y);
    left: var(--x);
    transform: translate(0, calc(-1 * var(--y)));
}

.stnEngage.controlbarActive.bottom
{
    --y: calc(var(--controlbarHeight) + 5px);
}

.stnEngage.bottom
{
    --y: 5px;
    --x: 50%;

    bottom: var(--y);
    left: var(--x);
    transform: translate(calc(-1 * var(--x)), 0);
    transition: bottom 300ms;
}

.stnEngage.top
{
    --y: 40px;
    --x: 50%;

    top: var(--y);
    left: var(--x);
    transform: translate(calc(-1 * var(--x)), 0);
}

.stnEngage > .next:not(.hide) + .stay:not(.hide)
{
    margin-top: 10px;
}

.stnEngage > div
{
    z-index: 1;
    position: relative;
    overflow: hidden;
}

.stnEngage > div,
.stay:before,
.next:before
{
    --verticalPadding: 0.25em;

    background: var(--stnEngageTimeLeftColor);
    opacity: 0.8;
    height: 1.5em;
    width: 100px;
    text-align: center;
    padding: var(--verticalPadding) 0px var(--verticalPadding) 0px;
    border-radius: var(--borderRadius);

    /* offset-x offset-y blur-radius color */
    box-shadow: 0px 0px 2px 0px white;

    cursor: pointer;
}

.stnEngage.hideStnEngage,
.next.hideStnEngage,
.stay.hideStnEngage
{
    opacity: 0;
    pointer-events: none;
}

.next:before,
.stay:before
{
    background: var(--stnEngageProgressColor);
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    z-index: -1;
    width: 0%;
}

.next.progress:before,
.stay.progress:before
{
    width: 100%;
    transition: width var(--stnEngageCountdownTime) linear;
}
`;var Zh=`<svg viewBox="22 22 44 44">
    <circle cx="44" cy="44" r="20.2" fill="none" stroke-width="3.6"></circle>
</svg>
`;var ef=`<stn-video-hlsjs></stn-video-hlsjs>
<stn-play-button class='\${hidePlayButton:hide} \${ui}'></stn-play-button>
<div class='companionAd \${hideCompanion:hide}' style="height: \${companionAdHeight}px; width: \${companionAdWidth}px">
    <div class='close material-icons'>close</div>
    <iframe width="\${companionAdWidth}" height="\${companionAdHeight}" srcdoc="\${companionAdSrc}" scrolling='no'></iframe>
</div>
<stn-ima class='\${hideStnIma:hide}'><slot></slot></stn-ima>
<div class='adInfo'>\${adInfo}</div>
<stn-mute-button class='\${hideMuteButton:hide} \${pushDown} \${ui}'></stn-mute-button>
<div class='pausePlayOverlay \${playState} \${pausePlayOverlayActive:active}'>
    <div class='fullscreen material-icons \${limitOverlayControls:hide}'>\${fullscreenOverlay}</div>
    <div class='playPause material-icons'>%{pausePlayOverlay}</div>
    <div class='mute material-icons \${limitOverlayControls:hide}'>\${muteOverlay}</div>
</div>
<div class='stnEngage \${hideStnEngage:hideStnEngage} \${controlbarActive} \${stnEngageLocation}'>
    <div class='next \${hideNextButton:hideStnEngage}'>Next</div>
    <div class='stay \${hideStayButton:hideStnEngage}'>Stay</div>
</div>
<stn-social-share class='\${disableSocialShare:hide}'></stn-social-share>
<div class='contextMenu \${contextMenuActive:active}'>%{contextMenuHTML}</div>
<stn-control class='\${disableControlBar:hide} \${ui}'></stn-control>
<div class="spinner"></div>
`;var tf=`/* #stn1 stn2 and stn3 are used solely to increase the specificity of the rules */
body.stnFullscreen:not(#stn1):not(#stn2):not(#stn3)
{
    overflow: hidden !important;
    margin: 0 !important;
}
`;var nf=["fullscreenEnabled","fullscreenElement","requestFullscreen","exitFullscreen","fullscreenchange","fullscreenerror"],Ab=["webkitFullscreenEnabled","webkitFullscreenElement","webkitRequestFullscreen","webkitExitFullscreen","webkitfullscreenchange","webkitfullscreenerror"],wb=["mozFullScreenEnabled","mozFullScreenElement","mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozfullscreenerror"],Lb=["msFullscreenEnabled","msFullscreenElement","msRequestFullscreen","msExitFullscreen","MSFullscreenChange","MSFullscreenError"],Ib=[nf,Ab,wb,Lb].filter(r=>r[0]in document)[0]||[],on=Object.fromEntries(nf.map((r,e)=>[r,Ib[e]])),rf=!1,To=class{constructor(e){this.element=e}async requestFullscreen(){if(this.isFullscreen)return null;if(this.fullscreenEnabled){let e=this.element[on.requestFullscreen]();try{let t=await e;return!0}catch(t){return console.error("Error entering STN Player fullscreen",t),!1}}else return this.fallback==="fullWidth"?(Cb(this.element),this.element.dispatchEvent(new CustomEvent(this.fullscreenchange,{bubbles:!0})),!0):!1}async exitFullscreen(){if(!this.isFullscreen)return null;if(this.fullscreenEnabled)try{return await this.document[on.exitFullscreen](),!1}catch(e){return console.error("Error exiting STN Player fullscreen",e),!0}else return this.fallback==="fullWidth"?(Rb(this.element),this.element.dispatchEvent(new CustomEvent(this.fullscreenchange,{bubbles:!0})),!1):!0}addEventListener(e,t,n){return this.document.addEventListener(on[e],t,n)}removeEventListener(e,t,n){return this.document.removeEventListener(on[e],t,n)}get fullscreenEnabled(){return Boolean(this.document[on.fullscreenEnabled])}get fullscreenchange(){return this.fullscreenEnabled?on.fullscreenchange:"fullscreenchangefallback"}get fullscreenerror(){return this.fullscreenEnabled?on.fullscreenerror:"fullscreenerrorfallback"}get fullscreenElement(){return this.fullscreenEnabled?this.document[on.fullscreenElement]:this.isFullscreen?this.element:null}get isFullscreen(){return this.fullscreenEnabled?this.document[on.fullscreenElement]!==null:this.fallback==="fullWidth"?this.element.classList.contains("manualFullscreen"):!1}get isManualMode(){return this.fallback==="fullWidth"&&!this.fullscreenEnabled}set fallback(e){this.rawFallback=e}get fallback(){return this.rawFallback}get document(){return this.element.ownerDocument}};function Cb(r){rf||Pb(),kb(r),document.body.classList.add("stnFullscreen")}function Rb(r){Db(r),document.body.classList.remove("stnFullscreen")}function Pb(){let r=document.createElement("style");r.innerHTML=tf,document.head.appendChild(r),rf=!0}var sf=r=>r.preventDefault();function kb(r){r.addEventListener("touchmove",sf,!1)}function Db(r){r.removeEventListener("touchmove",sf,!1)}var z=le(Symbol("StnMedia")),af=document.createElement("template");af.innerHTML=`<style>
${Jh}
${hs}</style>${ef}
`;var xb="stn-media",of=class extends ke{constructor(){super();let e=new class{constructor(){k(this,"adCompleted",null);k(this,"adPlaying",null);k(this,"cid",null);k(this,"companionAd",{});k(this,"contextMenuActive",!1);k(this,"contextMenuData",{});k(this,"controlbarActive",!1);k(this,"fullscreenFallback",!1);k(this,"hasEverStarted",!1);k(this,"hasStarted",!1);k(this,"hideControls",!1);k(this,"isFullscreen",!1);k(this,"isManualModeFullscreen",!1);k(this,"isMobile",!1);k(this,"liveStreamEnded",!1);k(this,"muteButtonEnabled",!1);k(this,"muted",!0);k(this,"next",{buttonClicked:!1});k(this,"pausePlayOverlayActiveCondition",!1);k(this,"pausePlayOverlayDisabled",!1);k(this,"paused",!0);k(this,"playStateUserInitiated",!1);k(this,"playerClicked",{value:!1});k(this,"pushDown",!1);k(this,"recircActive",!1);k(this,"socialSharingTrigger",!1);k(this,"stay",{buttonClicked:!1});k(this,"stnEngage",null);k(this,"touch",{start:{x:null,y:null},end:{x:null,y:null}});k(this,"ui",!1);k(this,"useLogoForPlay",!0);k(this,"volume",1);k(this,"width",null)}get pausePlayOverlayActive(){return!this.pausePlayOverlayDisabled&&!!this.pausePlayOverlayActiveCondition}get limitOverlayControls(){return!this.hideControls}get disableSocialShare(){return this.hideControls}get disableControlBar(){return this.hideControls}get playState(){return this.paused?"play":"pause"}get pausePlayOverlay(){let S=this.paused;return Hi?Qt:this.paused?Qt:"pause"}get muteOverlay(){return this.muted?"volume_off":"volume_up"}get fullscreenOverlay(){return this.isFullscreen?"fullscreen_exit":"fullscreen"}get hidePlayButton(){let S=this.paused,I=this.hasEverStarted;return!S||I}get hideStnIma(){let S=this.hasEverStarted,I;try{I=s.contentShouldPause}catch(N){return!0}return!S||!I}get isManualFullscreen(){let S=this.isFullscreen,I=this.isManualModeFullscreen;return S&&I}get ended(){let S=!!this.liveStreamEnded,I=!!i.badContent,N=!!i.ended,B=!!s.ended;return I||S||N&&B}get contentPaused(){let{paused:S}=e,{contentShouldPause:I}=s;return S||I}get adInfo(){if(!this.adPlaying)return"";let S=s.adPosition,I=s.totalAds,N=s.adLength-s.adCurrentTime;return`Ad ${S} of ${I} (${ji(N)})`}get hideMuteButton(){return this.hideControls||!this.muteButtonEnabled&&!this.recircActive}get hideCompanion(){return this.recircActive||(this.companionAd.content??"").length===0||this.companionAd.width>=this.width-32}get companionAdSrc(){return`
					<style>
						body
						{
							margin: 0;
						}
					</style>
					${this.companionAd.content??""}
				`}get companionAdWidth(){return this.companionAd.width??0}get companionAdHeight(){return this.companionAd.height??0}get contextMenuHTML(){return Object.keys(this.contextMenuData).reduce((S,I)=>{let N=this.contextMenuData[I];return`${S}<div><strong>${I}:</strong> ${N}</div>`},"")}get swipe(){let S=this.touch,I=20;if(S.end.x===null||S.end.y===null)return null;let N=S.end.x-S.start.x,B=S.end.y-S.start.y,A=null,M=null,G=0;return N<-1*I?A="left":N>I&&(A="right"),B<-1*I?M="up":B>I&&(M="down"),G=Math.sqrt(N*N+B*B),A===null&&M===null?null:{xDirection:A,yDirection:M,distance:G}}get hideStnEngage(){let S=this.stnEngage,{buttonClicked:I}=this.stay,{value:N}=this.playerClicked;if(!S?.enabled||I||N)return!0;let{currentTime:B,duration:A}=i,M=A<S.minVideoLength,G=B<=0,q=B<S.buttonShowDelay,Y=B>S.buttonShowDelay+S.countdown;return!S?.enabled||G||M||q||Y}get stnEngageLocation(){return this.stnEngage?.location??""}get hideStayButton(){return!(this.stnEngage?.hasStayButton??!1)}get hideNextButton(){return!(this.stnEngage?.hasNextButton??!1)}};ye(e),Object.freeze(e);let t=this.attachShadow({mode:Re?"open":"closed"}),n=$e(af.content.cloneNode(!0),e);t.append(...St(),n);let i=t.querySelector("stn-video-hlsjs"),s=t.querySelector("stn-ima"),a=t.querySelector("stn-control"),o=t.querySelector("stn-mute-button"),l=t.querySelector("stn-social-share"),c=t.querySelector("stn-play-button"),u=t.querySelector(".pausePlayOverlay"),d=t.querySelector(".companionAd .close"),h=t.querySelector(".stnEngage .next"),f=t.querySelector(".stnEngage .stay"),m=t.querySelector(".spinner");m.innerHTML=Zh,z(this,{contentPlayer:i,controlBar:a,model:e,muteButton:o,revenuePlayer:s,shadow:t,socialShare:l}),Object.freeze(this),t.addEventListener("contextmenu",j(S=>{S.target.closest(".contextMenu")||(S.preventDefault(),this.contextMenuActive=!this.contextMenuActive)})),this.addEventListener("touchstart",j(S=>{e.touch={start:{x:S.changedTouches[0].screenX,y:S.changedTouches[0].screenY},end:{x:null,y:null}}})),this.addEventListener("touchend",j(S=>{e.touch.end.x=S.changedTouches[0].screenX,e.touch.end.y=S.changedTouches[0].screenY})),x(()=>e.swipe,S=>{S&&this.isFullscreen&&S.yDirection==="down"&&(a.isFullscreen=!1)}),i.addEventListener("pointerdown",S=>{let I;L(()=>I=this.paused);let N=S.pointerType==="mouse",B=S.button===0;N&&!B||(I?this.userInitiatedPlay():N&&this.userInitiatedPause())}),t.querySelector(".pausePlayOverlay .playPause").addEventListener("click",S=>{L(()=>e.paused?this.userInitiatedPlay():this.userInitiatedPause())}),t.querySelector(".pausePlayOverlay .fullscreen").addEventListener("click",S=>{a.isFullscreen=!a.isFullscreen}),t.querySelector(".pausePlayOverlay .mute").addEventListener("click",S=>{L(()=>this.muted=!e.muted)}),o.addEventListener("click",()=>{oe.call(this,"UNMUTE_ICON")}),d.addEventListener("click",j(()=>{e.companionAd.content=""}));let y;function b(){y&&(clearTimeout(y),y=null)}h.addEventListener("click",j(()=>{b(),e.next={buttonClicked:!0},oe.call(this,"NEXT")})),f.addEventListener("click",j(()=>{b(),e.stay={buttonClicked:!0},oe.call(this,"STAY")})),P(()=>{i.browserPause!==null&&(i.browserPause?this.userInitiatedPause():this.userInitiatedPlay())}),P(()=>{s.browserPause!==null&&(s.browserPause?this.userInitiatedPause():this.userInitiatedPlay())}),P(()=>{s.started&&oe.call(this,"INV")}),x(()=>e.playerClicked,S=>{S.value&&b()}),x(()=>s.companionAd,S=>{e.companionAd=S}),x(()=>i.src,()=>{e.hasStarted=!1,e.companionAd.content=""}),x(()=>i.hasStarted||s.started,S=>{S&&(e.hasEverStarted=!0,e.hasStarted=!0,e.stay={buttonClicked:!1},e.playerClicked={value:!1})}),x(()=>i.hasStarted,S=>{S?ht.call(this,"contentStart"):ht.call(this,"contentEnded")}),x(()=>e.paused,S=>{ie&&console.log("Media Value: %o = %o","mediaPause",S),S?(s.pause(),ht.call(this,"pause")):(oe.call(this,"RTP"),ht.call(this,"RTP"),oe.call(this,"VIEWABLE_PLAYER_LOAD",{stnMedia:this,durationMeasured:2e3}),s.play(),ht.call(this,"play"))});{let S=!1;mn(a,null,null,(M,G)=>{S=!!G});let I,N=(M,G)=>{clearTimeout(I),L(()=>M=M&&(!e.recircActive||e.hideControls));let q;L(()=>q=e.isMobile);let Y;L(()=>Y=a.isMenuOpen),!(!q&&S)&&(I=setTimeout(j(()=>{a.active=!!M,l.mediaHovered=!!M,i.controlbarActive=!!M,e.controlbarActive=!!M,e.pausePlayOverlayActiveCondition=!!M&&!!q})(!M&&!G&&Y)?2e3:0))};u.addEventListener("click",M=>{L(()=>e.pausePlayOverlayActiveCondition=!1)});let B=null;x(()=>s.frame,()=>{B?.(),B=mn(s.frame,2e3,250,N)}),mn(this,2e3,250,N),x(()=>e.paused,M=>{a.playStateUserInitiated=e.playStateUserInitiated,a.paused=M},{fireImmediately:!0}),x(()=>a.paused,M=>{e.paused=M}),x(()=>a.playStateUserInitiated,M=>{e.playStateUserInitiated=M}),x(()=>e.muted,M=>{a.muted=M,o.muted=M,e.muteButtonEnabled&&!M&&(e.muteButtonEnabled=!1)},{fireImmediately:!0}),x(()=>a.muted,M=>{e.muted=M}),x(()=>o.muted,M=>{e.muted=M}),x(()=>e.volume,M=>{a.volume=M},{fireImmediately:!0}),x(()=>a.volume,M=>{e.volume=M}),x(()=>[s.adCurrentTime,s.adLength],([M,G])=>{a.adCurrentTime=M,a.adDuration=G},{fireImmediately:!0}),x(()=>[i.currentTime,i.duration],([M,G])=>{a.contentCurrentTime=M,a.contentDuration=G},{fireImmediately:!0}),x(()=>a.seekedTo,M=>{i.currentTime=M});let A=new To(this);P(()=>{let M=e.fullscreenFallback;A.fallback=M;let G;switch(M){case"fullWidth":G=!0;break;default:G=A.fullscreenEnabled;break}L(()=>a.fullscreenAllowed=!!G)}),P(()=>{e.isManualFullscreen?this.classList.add("manualFullscreen"):this.classList.remove("manualFullscreen")}),this.addEventListener(A.fullscreenchange,j(()=>{e.isFullscreen=A.isFullscreen,e.isManualModeFullscreen=A.isManualMode})),x(()=>e.isFullscreen,M=>{M!==null&&(a.isFullscreen=M,i.mediaIsFullscreen=M)},{fireImmediately:!0}),x(()=>a.isFullscreen,async M=>{L(()=>e.isFullscreen=null);let q=await(M?A.requestFullscreen():A.exitFullscreen());L(()=>e.isFullscreen=!!q)}),x(()=>e.socialSharingTrigger,M=>{a.socialSharingTrigger=M,l.socialSharingTrigger=M},{fireImmediately:!0}),x(()=>a.shareBtnClicked,M=>{l.controlbarClicked=!!M}),x(()=>a.selectedQuality,M=>{i.selectedQualityLevel=M},{fireImmediately:!0}),x(()=>i.qualityLevels,M=>{a.availableQualities=M},{fireImmediately:!0}),x(()=>i.activeQualityLevel,M=>{a.activeQuality=M},{fireImmediately:!0}),x(()=>a.selectedSubtitle,M=>{i.activeSubtitle=M},{fireImmediately:!0}),x(()=>i.subtitles,M=>{a.subtitles=M},{fireImmediately:!0}),x(()=>l.iconClicked,M=>{M&&(a.shareBtnClicked=!1)})}x(()=>l.lastSharedUrl,S=>{S&&oe.call(this,"SHARE",{share:S})}),x(()=>s.adCompleted,S=>{e.adCompleted=S}),x(()=>s.paused||!s.adPlaying,S=>{S?ht.call(this,"adPause"):ht.call(this,"adPlay")}),x(()=>s.adPlaying,S=>{e.adPlaying=S,S?(a.mode="ad",l.mode="ad",ht.call(this,"adStart",{adPosition:qe(s.adPosition),adLength:qe(s.adLength),adCuePoints:qe(s.adCuePoints)})):(a.mode="content",l.mode="content",ht.call(this,"adEnded"))}),x(()=>e.contentPaused,S=>{ie&&console.log("Media Value: %o = %o","contentPaused",S),S?i.pause():i.play()}),x(()=>i.playPromise,async S=>{try{await S,oe.call(this,"PLAY")}catch(I){}}),x(()=>i.qualityLevelRemoved,S=>oe.call(this,"LEVEL_LOAD_ERROR",{removedLevel:S})),x(()=>i.currentTime,S=>s.contentCurrentTime=S);let E=()=>{m.style.display="block",i.classList.add("spinner-active"),s.classList.add("spinner-active")},C=()=>{m.style.display="none",i.classList.remove("spinner-active"),s.classList.remove("spinner-active")},w;x(()=>i.waiting||s.waiting,S=>{S?w=setTimeout(E,500):(clearTimeout(w),C())},{fireImmediately:!0}),x(()=>i.ended,S=>{S&&this.pause(),s.contentEnded=S}),x(()=>s.impression,S=>{oe.call(this,"AD_IMPRESSION",Object.assign(qe(S),{cid:e.cid}))}),x(()=>s.adQuartile,S=>{if(S!==0){let I=s.adIndex;oe.call(this,"AD_QUARTILE",{quartile:S,adIndex:I})}}),x(()=>i.quartile,S=>{S&&oe.call(this,"QUARTILE",{quartile:S})}),x(()=>s.dv,S=>{S?oe.call(this,"DV",qe(S)):oe.call(this,"resetDV")}),x(()=>s.openvv,S=>{S?oe.call(this,"OPENVV",qe(S)):oe.call(this,"resetOpenVV")});let O=L(()=>s.impression);x(()=>[s.allAdsCompleted,s.impression],([S,I])=>{let N=s.adIndex,B=s.adCuePoints.length>0,{isClientAdRequest:A}=O;B&&!(O!==I)&&S&&oe.call(this,"NO_AD_IMPRESSION",{adIndex:N,isClientAdRequest:A}),S&&(O=I)}),x(()=>e.muted,S=>{i.muted=!!S,s.muted=!!S}),x(()=>e.volume,S=>{i.volume=S,s.volume=S}),x(()=>[e.volume,e.muted],([S,I])=>{ht.call(this,"volumeChange",{volume:S,muted:I})}),x(()=>[e.stnEngage,i.duration,e.stay],([S,I,N])=>{if(!S?.enabled){s.removeMidrolls=!1;return}let B=N.buttonClicked,{minVideoLength:A,stayClickMidrollBehaviour:M}=S,G=S?.enabled,q=isNaN(I),Y=G&&(!B||M==="remove")&&I>=A;s.removeMidrolls=q?null:Y}),x(()=>e.hideStnEngage,S=>{let{countdown:I,hasNextButton:N,hasStayButton:B}=e.stnEngage;S||(y=setTimeout(j(()=>{e.next={buttonClicked:!1}}),I*1e3)),f.classList.toggle("progress",!S&&!N&&B),h.classList.toggle("progress",!S&&N)}),x(()=>e.useLogoForPlay,S=>{a.useLogoForPlay=c.useLogoForPlay=S},{fireImmediately:!0})}get hasEverStarted(){return z(this).model.hasEverStarted}set cid(e){L(()=>z(this).model.cid=e)}get muted(){return z(this).model.muted}set muted(e){L(()=>z(this).model.muted=!!e)}get volume(){return z(this).model.volume}set volume(e){if(e=parseFloat(e),isNaN(e))throw new Error("Volume is not a number");if(e<0)throw new Error("Volume is less than 0");if(e>1)throw new Error("Volume is more than 1");L(()=>z(this).model.volume=e)}set content(e){let t=z(this);t.contentPlayer.src=e,oe.call(this,"resetPlay"),ht.call(this,"resetAdStart"),this.liveStreamEnded=!1}get content(){return z(this).contentPlayer.src}get contentPlayer(){return z(this).contentPlayer}get revenuePlayer(){return z(this).revenuePlayer}set ad(e){z(this).revenuePlayer.src=e}get ad(){return z(this).revenuePlayer.src}get ended(){return z(this).model.ended}get paused(){return z(this).model.paused}get playStateUserInitiated(){return z(this).model.playStateUserInitiated}play(){L(()=>{z(this).model.playStateUserInitiated=!1,z(this).model.paused=!1})}pause(){L(()=>{z(this).model.playStateUserInitiated=!1,z(this).model.paused=!0})}userInitiatedPlay(){L(()=>{z(this).model.playStateUserInitiated=!0,z(this).model.paused=!1})}userInitiatedPause(){L(()=>{z(this).model.playStateUserInitiated=!0,z(this).model.paused=!0})}get poster(){return z(this).contentPlayer.poster}set poster(e){z(this).contentPlayer.poster=e}get contentPaused(){return this.contentPlayer.paused}get contentCurrentTime(){return z(this).contentPlayer.currentTime}set contentCurrentTime(e){z(this).contentPlayer.currentTime=e}get adCompleted(){return z(this).model.adCompleted}get adPlaying(){return z(this).model.adPlaying}get companionAdShowing(){return!!z(this).model.companionAd.content}get adCurrentTime(){return z(this).revenuePlayer.adCurrentTime}get adPosition(){return z(this).revenuePlayer.adPosition}get adLength(){return z(this).revenuePlayer.adLength}get adCuePoints(){return z(this).revenuePlayer.adCuePoints}set liveStreamEnded(e){L(()=>z(this).model.liveStreamEnded=!!e)}get played(){return z(this).contentPlayer.played}set pageGestureTarget(e){z(this).contentPlayer.pageGestureTarget=e,z(this).revenuePlayer.pageGestureTarget=e}get hasStarted(){return z(this).model.hasStarted}set socialSharingTrigger(e){L(()=>{z(this).model.socialSharingTrigger=e})}get socialShare(){return z(this).socialShare}set fullscreenFallback(e){L(()=>{z(this).model.fullscreenFallback=e})}set isMobile(e){L(()=>{z(this).model.isMobile=e})}end(){L(()=>{let{revenuePlayer:e,contentPlayer:t}=z(this);e.stop(),t.endClip()})}set muteButtonEnabled(e){L(()=>{z(this).model.muteButtonEnabled=!!e})}set recircActive(e){L(()=>{z(this).model.recircActive=!!e})}get isFullscreen(){return z(this).model.isFullscreen}get currentTime(){let e=this.revenuePlayer.adPlaying,t=this.adCurrentTime,n=this.contentCurrentTime;return e?t:n}get duration(){let e=this.revenuePlayer.adPlaying,t=this.revenuePlayer.adLength,n=this.contentPlayer.duration;return e?t:n}set controlsOverlay(e){let{model:t}=z(this);t.pausePlayOverlayDisabled=!e}set controls(e){let{contentPlayer:t,model:n}=z(this);n.hideControls=!e,t.subtitlesDisabled=!e}set width(e){let{model:t}=z(this);t.width=e}set ui(e){let{model:t}=z(this);L(()=>{t.ui=e})}set pushDown(e){let{model:t}=z(this);L(()=>{t.pushDown=e})}set contextMenuData(e){let{model:t}=z(this);L(()=>{t.contextMenuData=e})}set contextMenuActive(e){let{model:t}=z(this);L(()=>{t.contextMenuActive=!!e})}get contextMenuActive(){let{model:e}=z(this);return e.contextMenuActive}get controlBar(){let{controlBar:e}=z(this);return e}set stnEngage(e){let{model:t}=z(this);L(()=>{t.stnEngage=e})}get next(){let{model:e}=z(this);return e.next}set playerClicked(e){let{model:t}=z(this);L(()=>{t.playerClicked=e})}get stayClickChange(){let{model:e}=z(this);return e.stay}set useLogoForPlay(e){z(this).model.useLogoForPlay=e}};customElements.define(xb,of);for(let r of["pointerdown","touchstart","touchend","pointerup","click"])document.addEventListener(r,e=>{if(e.target.tagName==="STN-PLAYER")for(let t of["preventDefault","stopPropagation","stopImmediatePropagation"])e[t]=()=>console.log("Cancelled call to %o on event %o bound for STN-PLAYER",t+"()",r)},{capture:!0});var ve,_f=document.createElement("template");_f.innerHTML=`<style>
${zc}</style>
${Yc}`;var Af=!1,li;_l({enforceActions:"always",computedRequiresReaction:!0,reactionRequiresObservable:!0,observableRequiresReaction:!0,isolateGlobalState:!0});var wf=document.createElement("script");wf.src="//js-sec.indexww.com/ht/p/187621-164323601241456.js";document.head.appendChild(wf);var gf=`#recircContent
{
    position: absolute;
    top: 0;
    height: 100%;
    width: 100%;
    text-decoration: none;
    cursor: pointer;
}

#recircContent #pillOverlay
{
    background: #F8B024;
    border-radius: 30px;
    color: #FFF;
    font-weight: bold;
    padding: 0.1em 1.5ch;
    position: absolute;

    /* Bottom centre */
    bottom: calc(0.25em + 5px);
    left: 50%;
    transform: translateX(-50%);
}

#recircContent #graphicOverlay
{
    height: 1.7em;
    position: absolute;

    /* Bottom Centre */
    bottom: 0.15em;
    left: 50%;
    transform: translateX(-50%);
}

.player.floating.miniActive #recircContent
{
    top: 0;
    right: calc(100% - var(--mediaWidth));
    color: white;
    padding: 1.5em 1.5em 10% 10%;
    width: auto;
    height: auto;
}
`;var vf=`<a id='recircContent' target='_blank'>
    <div style='display: none;' id='externalLink' class='material-icons'>launch</div>
    <div style='display: none;' id='pillOverlay'>READ MORE</div>
    <img style='display: none;' id='graphicOverlay'>
</a>
`;var ci=class extends ke{constructor(){let e=ci.config,t={backendHost:"https://embed.sendtonews.com/",backendPath:"/player4/data_read.php",backendParam:{}},n=[],i=window;for(;i;)n.push(...i.document.querySelectorAll('script[type="application/s2n+json"]')),i!==i.parent&&Object.getOwnPropertyNames(i.parent).includes("document")?i=i.parent:i=null;if(n.length){n.length>1&&console.warn("Multiple configuration objects for S2N Player. Only one will be used.");try{Object.assign(t,JSON.parse(n[0]?.textContent||"{}"))}catch(A){console.error("S2N Player configuration object error: %o",A.message)}}Object.setPrototypeOf(t,e);let s=Object.getPrototypeOf(e);window.addEventListener("unload",()=>{s.model=null}),s.model||(s.model={lastVisible:[],onLoadPushed:!1,onScrollPushed:!1,isFullscreen:[],viewportWidth:null,viewportHeight:null},ye(s.model),ie&&Object.keys(s.model).forEach(A=>{P(()=>{let M=Array.from(s.model[A]||[]).map(G=>G.playerKey);console.log("Video Value: %o = %o",`global.${A}`,M)})})),super(),typeof WeakRef=="undefined"?s.allPlayers.push(this):s.allPlayers.push(new WeakRef(this));let a={},o=new ra(this),l=null,c=null,u=null,d=null,h={},f=null,m=null,p;do p=Yt(16);while(!p.match(/^[A-Za-z]/));ve(this,{config:t,classId:p,features:a,model:o,embedScriptTag:l,usrID:c,liveInterval:u,apiEnabled:d,api:h,divTag:f,mediagroup:m});let g=this.attachShadow({mode:Re?"open":"closed"}),T=$e(_f.content.cloneNode(!0),o);P(()=>ve(this).usrID=o.usrID),P(()=>{ve(this).pageMeta=Object.fromEntries(Object.getOwnPropertyNames(o.pageMeta).map(A=>[A,o.pageMeta[A]]))}),P(()=>ve(this).embedScriptTag=o.embedScriptTag),P(()=>ve(this).apiEnabled=o.apiEnabled),P(()=>ve(this).divTag=o.divTag),ve(this).originConfig=s,Q(()=>o.optimera,()=>{Qs()});let _;P(()=>{let A=o.divTag;clearInterval(_),A&&o.removeTagAttributes&&(_=setInterval(()=>{getComputedStyle(A).display==="none"&&(clearInterval(_),A.className=A.className.replace(/\bs2nPlayer-?\w*(?: k-\w+)?/g,"").replace("  "," "),delete A.dataset.stnPlayer)},2e3))});let y=new wr(o),b=new Cr(o);js.call(this,y),js.call(g,y),Hs.call(this,b),Hs.call(g,b),fc.call(this),x(()=>o.api?.floatApi?.float,A=>{y.API(Jt({api:"float",float:{float:JSON.stringify(A)}}))});let E=new na(o),C=()=>!Er(o.feed)&&o.playlistData;Q(C,()=>{o.playerStatus=new Rr(o)}),g.append(Jl(o,"stn-player"),...St(),T),document.addEventListener("visibilitychange",j(()=>{o.pageHidden=document.hidden})),Q(()=>o.frameBreak&&this.divTag,()=>{let A=this.divTag.ownerDocument.defaultView.frameElement,M=!!(Re&&A?.classList.contains("aut-iframe"));!A||M||(A.style.setProperty("visibility","hidden","important"),A.style.setProperty("position","fixed","important"),A.style.setProperty("border","0","important"),A.style.setProperty("top","0","important"),A.style.setProperty("left","-100vw","important"),A.style.setProperty("width","1px","important"),A.style.setProperty("height","1px","important"),A.insertAdjacentElement("beforebegin",this.divTag))}),Q(()=>o.hasSpotXPrebid,()=>Promise.resolve().then(()=>Ys())),Q(()=>o.resonateEnabled,async()=>{let M=await(await Promise.resolve().then(()=>lf())).resonateAnalytics;await Q(()=>o.rawCurrentItem);let G={};L(()=>{G={"Publisher Site":this.divTag.ownerDocument.location.host,Level1:o.rawCurrentItem.level1,Level2:o.rawCurrentItem.level2,Level3:o.rawCurrentItem.level3}}),M.track("Video Play",G)}),Q(()=>o.hasAmazonPrebid,async()=>{let M=await(await Promise.resolve().then(()=>Zs())).apstag;Q(()=>o.schain.asi&&o.schain.sid,()=>{Af||(Af=!0,M.init({pubID:"6c3f03cd-6fa8-4477-ac05-2c0f4f8da092",videoAdServer:"DFP",isSelfServePub:!0,deals:!0,schain:{ver:"1.0",complete:1,nodes:[{asi:o.schain?.asi,sid:o.schain?.sid,hp:1}]}}))})}),(async()=>{let A;try{A=(await Di).VERSION}catch(M){A=null}L(()=>o.imaVersion=A)})(),x(()=>[o.playerKey,o.altPlaylistKey,o.configurableDataReadEndpoint],([A,M,G])=>{let q=o.primaryDataread,Y=o.altDataread,W=o.configurablePrimaryDataread,K=o.configurableAltDataread,ue=!!G,fe=o.ignoreConfigurableDataReadEndpoint;if(A&&!q&&vs.call(this,A),M&&!Y&&vs.call(this,M,!0),ue&&A&&!W)if(fe){o.configurablePrimaryDataread=!0;let{fetchURL:de}=_o.call(this,A,G);(async()=>{try{let De=await(await fetch(de)).json(),Me=Lf.call(this,A,De,G);Me&&fetch(Me.fetchURL).catch(()=>{})}catch(Se){}})()}else vs.call(this,A,!1,G);if(ue&&M&&!K)if(fe){o.configurableAltDataread=!0;let{fetchURL:de}=_o.call(this,M,G);fetch(de).catch(()=>{})}else vs.call(this,M,!0,G)}),P(()=>{let A=o.embedMutationObserver,M=o.mutationObserverControl;if(!!A)switch(M){case"disabled":A.disconnect(),L(()=>o.embedMutationObserver=null);break;case"enabled":default:break}});let w=A=>{if(this.querySelector(`div[slot="${A}"]`))return;let G=document.createElement("div");G.slot=A,G.textContent=o.wrapperText;let q=document.createElement("style");q.textContent=`
				stn-player.${p} div[slot="${A}"]
				{
					${o.wrapperCSS}
				}
			`,this.appendChild(q),this.appendChild(G)};Q(()=>o.floatWrapperEnabled,()=>{w("floatHeader"),N()}),Q(()=>o.fixedWrapperEnabled,()=>{w("header"),S()}),x(()=>[o.aiMetaCapture,o.feedCID,o.playerKey],([A,M,G])=>{A&&!isNaN(M)&&G&&Hc(M,G)}),this.addEventListener("click",()=>o.userEngagedPlayer());{let A=g.querySelector(".player"),M=g.querySelector(".stnError");window.ResizeObserver&&new ResizeObserver(q=>{let{contentRect:Y}=q.pop();Xt(j(()=>o.measuredPlayerWidth=Y.left+Y.right))}).observe(A);let G=g.querySelector(".playlistWrapper");x(()=>[o.isNewUI,o.isBarker,o.scrollbar],async([q,Y,W])=>{if((!q||Y)&&!W){let K=await ki(G);L(()=>o.scrollbar=K)}else q&&!Y&&W&&(o.scrollbar.destroy(),L(()=>o.scrollbar=null))})}{let A=g.querySelector(".player > .titleBar"),M=A.getBoundingClientRect(),G=j(()=>{let q=A.classList.contains("onHover");o.isTitleBarVisible=!q&&M.width>0&&M.height>0});window.ResizeObserver&&new ResizeObserver(q=>{M=q.pop().contentRect,Xt(G)}).observe(A),G()}{let A=g.querySelector(".floatContainer .titleBar"),M=j(()=>{let G=A.getBoundingClientRect();o.isFloatTitleBarVisible=G.width>0&&G.height>0});window.ResizeObserver&&new ResizeObserver(G=>{let{contentRect:q}=G.pop();Xt(M)}).observe(A),M()}let O=!1,S=()=>{if(O)return;let A=this.querySelector('div[slot="header"]');window.ResizeObserver&&A?(new ResizeObserver(M=>{let{contentRect:G}=M.pop();Xt(j(()=>o.isHeaderVisible=G.width>0&&G.height>0))}).observe(A),O=!0):L(()=>o.isHeaderVisible=!1)};S();let I=!1,N=()=>{if(I)return;let A=this.querySelector('div[slot="floatHeader"]');window.ResizeObserver&&A?(new ResizeObserver(M=>{let{contentRect:G}=M.pop();Xt(j(()=>o.isFloatHeaderVisible=G.width>0&&G.height>0))}).observe(A),I=!0):L(()=>o.isFloatHeaderVisible=!1)};N();{let A=this.querySelector('div[slot="footer"]');window.ResizeObserver&&A?new ResizeObserver(M=>{let{contentRect:G}=M.pop();Xt(j(()=>o.isFooterVisible=G.width>0&&G.height>0))}).observe(A):L(()=>o.isFooterVisible=!1)}{let A=g.querySelector(".mediaGroupContainer"),M=new IntersectionObserver(j(G=>{o.mediaGroupContainerVisibilityRatio=G.pop().intersectionRatio}),{threshold:[...Array(21)].map((G,q,Y)=>q/(Y.length-1))});Q(()=>o.playerShow,()=>{let G=A.getBoundingClientRect();o.mediagroupContainerPxFromTopOfPage=G.top+ce.scrollY}),window.ResizeObserver&&new ResizeObserver(G=>{let{contentRect:q}=G.pop();Xt(j(()=>{let Y=q.left+q.right;o.mediagroupContainerWidth=Y,o.mediagroupContainerHeight=Y*9/16}))}).observe(A),Q(C,async()=>{try{await qb.call(this)}finally{M.observe(A),Q(()=>!Er(o.currentItem),()=>{o.adTag=new Nr(o,A)})}})}customElements.whenDefined("stn-media").then(()=>{let A=ve(this).mediagroup=g.querySelector("stn-media");if(L(()=>o.mediagroupSet=!0),Xb()){let U=0;g.addEventListener("touchend",j(te=>{te.preventDefault();let ae=new Date().getTime();ae-U<300&&(A.contextMenuActive=!A.contextMenuActive),U=ae}))}else g.addEventListener("contextmenu",j(U=>{U.target!==A&&(U.preventDefault(),A.contextMenuActive=!A.contextMenuActive)}));P(()=>A.cid=o.feedCID),P(()=>A.revenuePlayer.insecureVpaid=o.insecureVpaid),P(()=>A.revenuePlayer.dvLogging=o.dvLogging),P(()=>A.revenuePlayer.playerModelOpenvv=o.openvv),P(()=>A.revenuePlayer.preventImaRefreshOfGpt=o.preventImaRefreshOfGpt);let M=g.querySelector("stn-play-button");x(()=>o.useLogoForPlay,U=>A.useLogoForPlay=M.useLogoForPlay=U,{fireImmediately:!0});let G=g.querySelector(".floatContainer"),q=g.querySelector(".floatClose"),Y=g.querySelector(".floatMaximize"),W=g.querySelector(".menuButton");Q(()=>A.hasEverStarted,()=>o.hasEverStarted=!0),q.addEventListener("click",U=>{U.stopPropagation(),o.userClosedFloat()}),Y.addEventListener("click",U=>{U.stopPropagation(),o.userMaximizedFloat()}),W.addEventListener("click",j(U=>{A.paused?A.userInitiatedPlay():A.userInitiatedPause()})),new ResizeObserver(U=>{let{contentRect:te}=U.pop();Xt(j(()=>{let ae=te.left+te.right;o.playerMediaWidth=ae,A.width=ae}))}).observe(A);let K,ue,fe,de=()=>{K&&K(),ue&&ue(),fe&&fe(),E.load(),K=x(()=>A.contentPaused,U=>{U?E.contentPause({ended:A.ended}):E.contentPlay({content_id:o.currentItem.C_ID,currentTime:A.contentCurrentTime})}),ue=x(()=>A.adCompleted,U=>{U?E.adFinish({currentTime:A.contentCurrentTime}):E.adStart({adPosition:A.adPosition,adLength:A.adLength,adCuePoints:A.adCuePoints})}),fe=x(()=>A.adPlaying,U=>{U?E.adPlay({currentTime:A.adCurrentTime}):E.adPause()})};x(()=>o.playlist,U=>{if(U.length===0){o.error="Unable to load the playlist, please click to retry.";let ae=g.querySelector(".stnError"),Ae=j(()=>{ae.removeEventListener("click",Ae),o.error=null,o.resetLoadFail(),o.selectedPlaylistItem={idx:0}});ae.addEventListener("click",Ae)}}),x(()=>o.currentItem,async U=>{await Q(()=>o.adTag),await Q(()=>E.model.lib!==void 0),de();let te=ve(this);if(clearInterval(te.liveInterval),A.poster=U.poster,U.liveFeed){let _n=Kb.call(this,U,A);if(_n){U.content=_n,A.content=U,A.ad=!1,L(()=>o.allowSubtitles=!1);return}}if(!U.content){L(()=>o.allowSubtitles=!1);return}let ae;L(()=>ae=o.adTag);let Ae=ae.newParams();if(!Ae){A.content=U,A.ad=!1,L(()=>o.allowSubtitles=!0),oe.call(this,"IMA",{hasAdParams:Ae});return}let Fe=!1,et=!1,Dt=U.content;try{await Di,A.ad=ae}catch(_n){let Yi=U.content;Fe=!0,A.ad=!1,Dt=Wb(o,Yi),et=Yi!==Dt}finally{U.content=Dt,A.content=U,oe.call(this,"IMA",{hasAdParams:Ae,adBlocked:Fe,areAdsRecovered:et}),L(()=>o.allowSubtitles=!et)}}),P(()=>{let U=o.allowSubtitles,te=o.dataReadSubtitles;A.contentPlayer.subtitles=U?te:[]}),x(()=>A.contentPlayer.badContent,U=>{if(o.badContent=U,U){let{S_ID:te}=o.currentItem;oe.call(this,"BAD_CONTENT_ERROR",{S_ID:te})}}),x(()=>A.next,U=>{let{buttonClicked:te}=U;o.nextSelectedPlaylistItem({force:!0,userInitiated:te})}),P(()=>{A.playerClicked=o.playerClicked});let Se=0;x(()=>A.ended,U=>{U&&(Se++,A.pause(),o.nextSelectedPlaylistItem())}),P(()=>{o.pageHidden||(Se=0)}),Q(()=>A.hasEverStarted,()=>{x(()=>[o.isMediaGroupFloating,o.isPlayOnView,o.isMediaGroupContainerVisible,o.pageHidden,o.videosToPlayWhilePageHidden,A.ended,A.hasStarted,o.isFullscreen],([te,ae,Ae,Fe,et,Dt,_n,Yi])=>{let Cf=!A.paused,Lo=te||Ae||Yi;if(et>=0&&Fe){if(ae&&!Lo&&!Cf||Se>et)return}else if(ae&&!Lo)return;_n||setTimeout(()=>A.play())});let U=!1;x(()=>[o.pageHidden,o.pauseWhenPageHiddenSkipNext,o.pauseWhenPageHiddenStatic],([te,ae,Ae])=>{let Fe=!A.paused;!Ae&&!ae||(te?Fe&&(U=!0,A.pause()):U&&(ae&&A.end(),U=!1,A.play()))})});let De=!1;x(()=>A.paused,U=>{U||(De=!1)}),x(()=>[o.isMediaGroupContainerVisible,o.floatClosed,o.floatCloseBehaviour],([U,te,ae],[Ae,Fe])=>{let et=te&&te!==Fe,Dt=U&&U!==Ae;switch(ae){case"resume":et&&(A.pause(),De=!0),Dt&&De&&A.play();break;case"pause":et&&(A.pause(),De=!0);break;case"continue":default:break}}),x(()=>A.adPlaying,U=>{o.adActive=U});let Me={AD_ACTIVE:"AD",CONTENT_PLAYING:"PL",CONTENT_PAUSED:"PA"};x(()=>o.floatClosed,U=>{if(!U)return;let te;A.adPlaying?te=Me.AD_ACTIVE:A.contentPaused?te=Me.CONTENT_PAUSED:te=Me.CONTENT_PLAYING,oe.call(this,"CLOSE",{reason:te})}),x(()=>A.hasStarted,U=>{o.hasStarted=U}),x(()=>[A.paused,A.playStateUserInitiated],([U,te])=>{(te||!U)&&(o.paused=U)},{fireImmediately:!0}),x(()=>A.muted,U=>{o.muted=!!U},{fireImmediately:!0}),x(()=>A.volume,U=>{o.volume=U},{fireImmediately:!0}),x(()=>A.isFullscreen,U=>{o.isFullscreen=U}),x(()=>[A.currentTime,A.duration,o.isMediaGroupFloating&&o.isMiniFloatActive],([U,te,ae])=>{if(ae){let Ae=!U||!te?0:100*(U/te);G.style.borderImage=`linear-gradient(to right, var(--timeElapsedColorMini) ${Ae}%, var(--timeRemainingColorMini) ${Ae}%) 2`}else G.style.borderImage=""}),x(()=>o.isMiniFloatActive,U=>{A.controls=!U}),P(()=>{A.fullscreenFallback=o.fullscreenFallback}),P(()=>{A.socialSharingTrigger=o.socialSharingTrigger}),P(()=>{A.muteButtonEnabled=o.muteIcon}),P(()=>{A.isMobile=o.isMobile}),P(()=>{A.contentPlayer.initialQuality=o.initialQuality}),P(()=>{A.ui=o.ui}),P(()=>{A.pushDown=o.titleBarDisplayMode==="onHover"}),P(()=>{let U=o.usrID,te=_t.key,ae={"Player Version":At(),"Player Key":o.playerKey,"Configured as Smart Player":o.configuredAsSmartPlayer,"Playlist Type":o.playlistType,"Float Mode":o.float,Sess:`${U}~${te}`};A.contextMenuData=ae}),P(()=>{A.controlBar.hideSTNLink=o.hideSTNLink});let je=g.querySelector(".player > .titleBar");mn(this,2e3,null,(U,te)=>{je.classList.toggle("hovered",U)}),P(()=>{A.socialShare.shareURL=o.pageMeta.smartMatchLocation}),Q(()=>o.isAmp,async()=>{let U=window.ampApi;if(!U)return;let te=await Promise.resolve().then(()=>uf());this.features.amp=new te.Amp(U,o,A)}),Q(()=>o.isLoopingPlaylist,async()=>{let U=await Promise.resolve().then(()=>hf());this.features.loopPlaylist=new U.LoopPlaylist(o,A)}),Q(()=>o.hasEngagementLogging,async()=>{let U=await Promise.resolve().then(()=>ff());this.features.engagementLogger=new U.EngagementLogger(o,A)}),Q(()=>!o.isClickToPlay,async()=>{let U;switch(L(()=>U=o.delayPlayStart),U){case"onScroll":await Q(()=>o.hasScrolled);break;case"disabled":default:break}let te=await Promise.resolve().then(()=>pf());this.features.playbackMode=new te.PlaybackMode(o,A)}),P(()=>A.muted=o.muted),x(()=>A.muted,U=>{o.muted=U}),P(()=>A.volume=o.volume),x(()=>A.volume,U=>{o.volume=U}),P(()=>A.stnEngage=o.stnEngage),x(()=>A.stayClickChange,U=>{let te=U.buttonClicked,ae=o.isMiniFloatActive;if(te&&ae){let et=this.getBoundingClientRect().top+ce.scrollY-(this.divTag.ownerDocument.documentElement.clientHeight-this.offsetHeight)/2;ce.scrollTo({top:et,behavior:"smooth"})}}),Q(()=>o.hasEverStarted&&o.isCurrentContentRecirc,async()=>{let U=await Promise.resolve().then(()=>Tf());this.features.recircContent=new U.RecircContent(o,A)}),Q(()=>o.disablePageGesture!==void 0,()=>A.pageGestureTarget=o.disablePageGesture?new EventTarget:ci.config.pageGestureTarget);let at=g.querySelector(".playlist");at.addEventListener("click",U=>{let te=U.target.closest(".item");if(!te)return;let ae=parseInt(te.dataset.item,10),Ae;L(()=>Ae=o.selectedPlaylistItem.idx);let Fe=ae===Ae;Fe||(o.userSelectedPlaylistItem={idx:ae}),A.pause(),Q(()=>!A.hasStarted||Fe,()=>{setTimeout(()=>A.userInitiatedPlay())})});let ui=g.querySelector(".playlistChevron.left"),If=g.querySelector(".playlistChevron.right"),wo=()=>{let U=at.querySelector(".item"),te=parseFloat(getComputedStyle(U).marginRight),ae=parseFloat(getComputedStyle(U).marginLeft);return(U.offsetWidth+te+ae)*2};ui.addEventListener("click",()=>{at.scrollBy({left:-1*wo(),behavior:"smooth"})}),If.addEventListener("click",()=>{at.scrollBy({left:wo(),behavior:"smooth"})}),g.querySelector(".overlay").addEventListener("click",U=>{A.userInitiatedPlay()}),L(()=>o.shareIconCount=A.socialShare.shareIconCount),Q(()=>o.enableCatapultX,()=>{if(!li){let U=()=>A.contentPlayer.shadowSelector("cx-overlay")?.setAttribute("cx-wait","false"),te=()=>A.contentPlayer.shadowSelector("cx-overlay")?.setAttribute("cx-wait","true");x(()=>A.adPlaying||A.companionAdShowing,ae=>{ae?te():U()},{fireImmediately:!0}),li=[],ft.then(ae=>{let Ae=ae.document,Fe=Ae.createElement("script");Fe.src="https://tags.qortex.ai/bootstrapper",Ae.head.append(Fe),Fe.addEventListener("load",()=>{Object.defineProperty(ae,"CXBootstrapper",{set:et=>{delete ae.CXBootstrapper,ae.CXBootstrapper=et,li.push=Dt=>Dt(ae.CXBootstrapper),li.splice(0).forEach(Dt=>{try{li.push(Dt)}catch(_n){console.error(_n)}})},configurable:!0})},{once:!0})})}li.push(U=>{Q(()=>o.feedCID,()=>{let te=`stn-${o.feedCID}`;new U(te).initCX({videoDescriptors:[{videoElement:A.contentPlayer.videoElement}]})})})})});let B=Object.keys(this);for(let A of["divTag","playerKey","embedScriptTag","embedMutationObserver"])if(B.includes(A)){let M=this[A];delete this[A],this[A]=M}zb.call(this)}disconnectedCallback(){let e=ve(this),t=e.model;L(()=>{e.originConfig.model.lastVisible=e.originConfig.model.lastVisible.filter(n=>n!==t)})}connectedCallback(){let e=ve(this),t=e.model;if(this.classList.add(e.classId),this.isConnected){this.append(...St()),Q(()=>!Er(t.feed)&&t.playlistData||t.error,()=>{this.style.display="",t.playerShow=!0});let i=document.createElement("div");i.setAttribute("slot","imaHost");let s=document.createElement("div");i.append(s),this.append(i)}}get features(){return ve(this).features}get playerKey(){return ve(this).model.playerKey}set playerKey(e){let t=ve(this).model;L(()=>t.playerKey=e)}get divTag(){return ve(this).model.divTag}set divTag(e){let t=ve(this).model;e.id||(e.id=Yb()),L(()=>t.divTag=e)}get embedScriptTag(){return ve(this).embedScriptTag}set embedScriptTag(e){let t=ve(this).model;L(()=>t.embedScriptTag=e)}set embedMutationObserver(e){let t=ve(this).model;L(()=>t.embedMutationObserver=e)}get usrID(){return ve(this).usrID}get playerStatus(){return ve(this).model.playerStatus}get api(){let e=ve(this);return e.apiEnabled?e.api:null}};function vs(r,e=!1,t=null){let n=ve(this).model;Qb.call(this,r,e,t).then(()=>L(()=>n.error=null)).catch(i=>{e||L(()=>n.error=i),oe.call(this,"GETERR",{reason:"uncaught",isAltPlaylist:e,useConfigurablePlaylist:!!t}),console.error(i)})}async function Qb(r,e=!1,t=null){if(!r)return;let n=ve(this),i=!!t;await Q(()=>n.model.embedScriptTag);let{datareadURL:s,fetchURL:a}=_o.call(this,r,t);oe.call(this,"PRE_INIT");let o=await fetch(a).catch(d=>{throw oe.call(this,"GETERR",{reason:"adblock",isAltPlaylist:e,useConfigurablePlaylist:i}),`An ad blocker has likely prevented this video content from loading.
Please disable your ad blocker to view the video content.`}),l;try{l=await o.json()}catch(d){throw oe.call(this,"GETERR",{reason:"invalid json",isAltPlaylist:e,useConfigurablePlaylist:i}),"Could not load player data. Please try again later."}function c(d){for(let[h,f]of Object.entries(d))if(!!f)switch(typeof f){case"string":{d[h]=f.replace(/^(http:)?\/\//,"https://");break}case"object":{c(f);break}}}c(l);let u=Jb.call(this,l,e,i);if(u)throw u;if(e)i?L(()=>n.model.configurableAltDataread=Ao(l)):L(()=>n.model.altDataread=l);else{let d=Lf.call(this,r,l,t);d&&fetch(d.fetchURL).catch(()=>{}),i?L(()=>n.model.configurablePrimaryDataread=Ao(l)):(L(()=>n.model.primaryDataread=l),oe.call(this,"GET"))}}function Wb(r,e){let t;switch(L(()=>t=r.adRecovery),t){default:case"SSAI":return Zb(r,e);case"NONE":return e}}function Zb(r,e){let t,n;if(L(()=>t=r.adTag),!t||!e.endsWith(".m3u8"))return e;let i="https://165e347693a540c184a4827b405dba07.mediatailor.us-east-1.amazonaws.com/v1/master/08ac7296b74aba263f61ed5f9103ae30c77400e9/dai_m3u8/",s="https://d29xw9s9x32j3w.cloudfront.net/videos/m3u8/";L(()=>n=t.paramsEncoded);let a=ie?"aws.logMode=DEBUG&":"";return e=e.replace(s,i)+`?${a}ads.query=${n}`,e}function Kb({liveFeed:r,SM_ID:e},t){let n=ve(this);if(n.liveInterval)return;let i=new Date,s,a;L(()=>s=r.startTime),L(()=>a=r.endTime);let o=Tr(s),l=Tr(a),c=(o-i)/1e3,u=(l-i)/1e3,d=60/5,h=-1,f=async()=>{let g=new Date;if(u=(l-g)/1e3,u<=0){clearInterval(n.liveInterval),t.liveStreamEnded=!0;return}if(h=++h%d,h===0)try{let _=await(await fetch(`https://player.sendtonews.com/player4/update.php?q=liveFeed&sm_id=${e}`)).json();l=Tr(_.endDate||null)}catch(T){console.error(T)}},m=c<=0,p=u<=0;if(m&&!p){n.liveInterval=setInterval(f,5e3),t.liveStreamEnded=!1,f();let g;return L(()=>g=r.sources.src),g}return null}function Jb(r,e,t){let n=ve(this),i=t,s=!n.model.useConfigurablePlaylistCustomSource(r),a=!1,o=!1;if(i||s){let c=r?.playlistData?.[0]?.error||r?.playlistData?.[0]?.[0]?.error;a=c?{msg:c,details:"Error message came from the backend"}:r.playlistData?r.playlistData?.length!==2?{msg:"Playlist is Unavailable",details:"playlistData doesn't have 2 indices"}:r.playlistData[0][0]?!1:{msg:"Playlist is Empty",details:"Playlist is empty"}:{msg:"Playlist is Unavailable",details:"playlistData object is missing"}}return i||(o=r.feed.error),o?oe.call(this,"GETERR",{reason:"feed",isAltPlaylist:e,msg:o,useConfigurablePlaylist:t}):a&&oe.call(this,"GETERR",{reason:"playlist",isAltPlaylist:e,msg:a.msg,details:a.details,useConfigurablePlaylist:t}),[{type:"Feed Error",msg:o},{type:"Playlist Error",msg:a.msg}].filter(c=>!!c.msg).map(c=>`${c.type}: ${c.msg}`).join(`

`)}function Ef(r,e){let t=null,n=new Promise((i,s)=>{t=setTimeout(()=>s("stnPromiseTimedOut"),r)});return Promise.race([n,e.then(i=>(clearTimeout(t),i))])}var yt,gs=class{constructor(e){yt(this,{model:e,modelApi:null});let i=yt(this);this.reset(),P(()=>i.modelApi=e.api.floatApi),Object.freeze(this),P(()=>i.float=i.modelApi.float),P(()=>i.verticalTranslate=i.modelApi.verticalTranslate),P(()=>i.horizontalTranslate=i.modelApi.horizontalTranslate),P(()=>i.position=i.modelApi.position)}get float(){return yt(this).float}set float(e){let t=yt(this);L(()=>t.modelApi.float=e)}get verticalTranslate(){return yt(this).verticalTranslate}set verticalTranslate(e){let t=yt(this);if(typeof e!="number"){console.error("Invalid value set for float API");return}L(()=>t.modelApi.verticalTranslate=e)}get horizontalTranslate(){return yt(this).horizontalTranslate}set horizontalTranslate(e){let t=yt(this);if(typeof e!="number"){console.error("Invalid value set for float API");return}L(()=>t.modelApi.horizontalTranslate=e)}get position(){return yt(this).position}set position(e){let t=yt(this);!jb(e)||L(()=>t.modelApi.position=e)}reset(){let e=yt(this);L(()=>e.model.api.floatApi={})}};function jb(r){if(typeof r!="string")return console.error("Invalid value set for float API"),!1;let[e,t]=r.split(" ");switch(e){case"top":case"bottom":case"middle":break;default:return console.error("Invalid value set for float API"),!1}switch(t){case"left":case"right":case"middle":break;default:return console.error("Invalid value set for float API"),!1}return!0}yt=le(gs);async function qb(){let r=ve(this);if(!r.apiEnabled)return;let e=await Promise.resolve().then(()=>Sf());r.api=new e.Api(r.model);let t=r.divTag.getAttribute("data-stn-api")??r.divTag.getAttribute("data-s2n-api");if(!t){this.api.lockConfigurationDelay();return}let n=e0(t);if(!n){console.warn(`API callback ${t} not found.`),this.api.lockConfigurationDelay();return}return n(i=>r.divTag!==i?null:this.api),this.api.lockConfigurationDelay(),await this.api.configurationDelay}function e0(r){let e=window;for(;e;){let t=e[r];if(typeof t=="function")return t;if(e===e.parent)return null;e=e.parent}}async function zb(){if(!ie)return;let r=ve(this);await Q(()=>r.model.mediagroupSet);let e;L(()=>e=this.playerKey),ce.stnPlayersOnPage||(ce.stnPlayersOnPage={mobx:{action:j,autorun:P,getUnObserved:Sr,reaction:x,runInAction:L,toJS:qe,when:Q},players:{}}),ce.stnPlayersOnPage.players[e]||(ce.stnPlayersOnPage.players[e]=[]),ce.stnPlayersOnPage.players[e].push({key:e,media:r.mediagroup,player:this,playerModel:r.model})}function Yb(){let r,e,t;do r=Yt(16),e=r.match(/^[A-Za-z]/),t=document.getElementById(r);while(!e||t);return r}function _o(r,e=null){let t=ve(this),n=!!e,i=new URL(t.config.backendPath,this.embedScriptTag?.host||t.config.backendHost).href,s=n?e:i,a=r.split("-"),o=a.length===3?r:null,l={cmd:"loadInitial",session:_t.key,instance:t.usrID,version:At(),age:Ri(),ESG_key:a.length<=2?a[0]:null,PL_key:a.length===2?a[1]:null,SC:o,type:o?"SINGLE":"FULL",EXTREF:t.pageMeta.smartMatchLocation,REF:t.pageMeta.href,ogSet:t.pageMeta.ogSet?"1":"0",recache:t.divTag.getAttribute("data-recache")};Object.assign(l,t.config.backendParam);let c=`${s}?${wt(l)}`;return{datareadURL:s,dataReadParams:l,fetchURL:c}}function Lf(r,e,t=null){let n=ve(this),i=!!t,s=new URL(n.config.backendPath,this.embedScriptTag?.host||n.config.backendHost).href,a=i?t:s;if("UMSE_urlHash"in(e.pageMetaData??{})&&!("UMPD_titleHash"in(e.pageMetaData??{}))){let o={cmd:"readPageMeta",ESG_key:r,session:_t.key,instance:n.usrID,version:At(),age:Ri(),EXTREF:n.pageMeta.smartMatchLocation,REF:n.pageMeta.href,UMSE_urlHash:e.pageMetaData?.UMSE_urlHash,UMPD_title:n.pageMeta.title,UMPD_keywords:n.pageMeta.keywords,UMPD_description:n.pageMeta.description,UMPD_revised:n.pageMeta.revised,UMPD_published:n.pageMeta.published,smVersion:i?2:null},l=`${a}?${wt(o)}`;return{datareadURL:a,smartMatchPassBackParam:o,fetchURL:l}}return!1}function Ao(r){let e;try{e=JSON.parse(r)}catch(t){e=r}if(typeof e=="object"&&e!==null)for(let t in e)e[t]=Ao(e[t]);return e}function Xb(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}ve=le(ci);export{ci as StnPlayer};
