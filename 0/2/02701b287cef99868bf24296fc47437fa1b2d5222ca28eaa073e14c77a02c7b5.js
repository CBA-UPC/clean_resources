window.DRTStoryAutoplay_enable=true;window.DRTStoryAutoplay_debug=window.DRTOptimize_config["debug"];window.DRTStoryAutoplay_offset=250;window.DRTVideoSidebar_enable=false;window.DRTVideoSidebar_inifito=false;window.DRTVideoSidebar_maxvideos=5;window.DRTVideoSidebar_maxvideos_mobile=2;window.DRTVideoSidebar_enableMobile=false;window.DRTStoryAutoplay_mobile={"enable":true,"inifito":false,"body":false};window.DRTStoryAutoplay_desktop={"enable":true,"inifito":false,"body":false};var DRTStoryAutoplay=DRTStoryAutoplay||{};DRTStoryAutoplay=(function(){var initiated=false;var players={};var jwpSidebar={};var videosProcessed={};function load(){(function(c){var l={},b,m,e=document,j=window,i=e.documentElement,k=c.expando,a;c.event.special.inview={add:function(d){l[d.guid+"-"+this[k]]={data:d,$element:c(this)};if(!a&&!c.isEmptyObject(l)){a=setInterval(g,250);}},remove:function(d){try{delete l[d.guid+"-"+this[k]];}catch(n){}if(c.isEmptyObject(l)){clearInterval(a);a=null;}}};nction g(){var s=c(),r,q=0;c.each(l,;r=s.length;if(r){b=b||h();m=m||f();for(;q<r;q++){if(!c.contains(i,s[q])){continue;}var x=c(s[q]),y={height:x.height(),width:x.width()},d=x.offset(),t=x.data("inview"),p=0,o=0,n=0,v,u,w;if(p=x.data("offset")){o=p;n=p;}else{if(p=x.data("offset-left")){o=p;}else{if(p=x.data("offset-top")){n=p;}}}if(!m||!b){return;}if(d.top+y.height>m.top-n&&d.top<m.top+b.height+n&&d.left+y.width>m.left-o&&d.left<m.left+b.width+o){v=(m.left>d.left?"right":(m.left+b.width)<(d.left+y.width)?"left":"both");u=(m.top>d.top?"bottom":(m.top+b.height)<(d.top+y.height)?"top":"both");w=v+"-"+u;if(!t||t!==w){x.data("inview",w).trigger("inview",[true,v,u]);}}else{if(t){x.data("inview",false).trigger("inview",[false]);}}}}}c(j).bind("scroll resize",;if(!i.addEventListener&&i.attachEvent){i.attachEvent("onfocusin",;}})(jQuery);}function getVersion(){var date=new Date();return date.getFullYear()+"-"+date.getMonth()+"-"+date.getDate()+"-"+date.getHours();}function __DEBUG(){if(window.DRTStoryAutoplay_debug){var objects=[];for(var i=0;i<arguments.length;i++){objects.push(arguments[i]);}console.log("DRTStoryAutoplay",objects);}}function getWidth(){var xWidth=null;if(window.screen!==null){xWidth=window.screen.availWidth;}if(window.innerWidth!==null){xWidth=window.innerWidth;}if(document.body!==null){xWidth=document.body.clientWidth;}return xWidth;}function getHeight(){return Math.max(document.documentElement.clientHeight||0,window.innerHeight||0);}function isPhone(){if(getWidth()<768){return true;}return false;}function getRandomSubarray(arr,size){var shuffled=arr.slice(0),i=arr.length,temp,index;while(i--){index=Math.floor((i+1)*Math.random());temp=shuffled[index];shuffled[index]=shuffled[i];shuffled[i]=temp;}return shuffled.slice(0,size);}function start($parent){var selector=false;if(isPhone()){selector=".main-video .video-player";if(window.DRTStoryAutoplay_mobile.body){selector=".video-player";}}else{selector=".main-video .video-player";if(window.DRTStoryAutoplay_desktop.body){selector=".video-player";}}if(isPhone()){setTimeout(1000);}else{parseParent($parent,selector);}}function parseParent($parent,selector){$parent.find(selector).each(function(){var $this=$(this);var control=false;var $video=$this.find("video[data-source='jwplatform']");if($video.length>0){control=true;}var $jwplayer=$this.find(".jwplayer");if($jwplayer.length>0){control=true;}if(control){if(!$this.hasClass("composite-image")){$this.append("<figcaption style='background: #f5f5f5; padding: 10px 15px; font-family: sans-serif; font-size: 14px; line-height: 16px; letter-spacing: -.1px; color: #666;'>Vídeo - LA VANGUARDIA</figcaption>");}$this.css({"display":"block"});$this.attr("data-offset",window.DRTStoryAutoplay_offset);$this.bind("inview",function(e,visible){var el=$(this);var player=el.find(".jwplayer");var jwplayerId=false;if(player.length>0){jwplayerId=player.attr("id");players[jwplayerId]=jwplayerId;}if(visible){el.data("myvisible",true);__DEBUG("SI INVIEW",jwplayerId);if(jwplayerId){mute(jwplayerId,1);play(jwplayerId);}else{el.click();__DEBUG("click",el[0]);setTimeout(function(){var $video=el.find("video[data-source='jwplatform']");jwplayerId="player_"+$video.attr("video-id");setTimeout(function(){mute(jwplayerId,1);play(jwplayerId);},200);setTimeout,1000);},0);}}else{el.data("myvisible",false);__DEBUG("NO INVIEW",jwplayerId);if(jwplayerId){mute(jwplayerId,1);jwplayer(jwplayerId).on("complete",function(){var myvisible=el.data("myvisible");if(!myvisible){pause(jwplayerId);__DEBUG("complete","complete");}});}}});}});}function play(id){var state=false;try{state=jwplayer(id).getState();}catch(e){state=false;}__DEBUG("state",id,state);if(true){__DEBUG("play",id);try{jwplayer(id).play();}catch(e){__DEBUG("error play",id,e);}}}function mute(id,value){__DEBUG("mute",id,value);try{jwplayer(id).setMute(value);}catch(e){__DEBUG("error mute",id,value,e);}}function pause(id){try{__DEBUG("related-close",id);jwplayer(id).getPlugin("related").close();}catch(e){__DEBUG("error related-close",id,e);}try{__DEBUG("pause",id);jwplayer(id).pause();}catch(e){__DEBUG("error pause",id,e);}try{__DEBUG("pauseAd",id);jwplayer(id).pauseAd(1);}catch(e){__DEBUG("error pauseAd",id,e);}}function pauseAll(exceptVideo){__DEBUG("pauseAll exceptVideo",exceptVideo);$.each(players,function(index,val){if(val!=exceptVideo){mute(val,1);pause(val);}});}function buildHtmlSidebar(videos,maxVideos){var html="";var count=0;for(var i=0;i<videos.length;i++){var video=videos[i];if(video){var videoId=video.video.replaceAll("https://cdn.jwplayer.com/videos/","");if(videosProcessed[videoId]){continue;}if(count>=maxVideos){break;}var label=count+1;html+='<li class="result-news">';if(count==0){videosProcessed[videoId]=true;html+='<div class="duroty-video-sidebar" data-video="'+videoId+'" data-offset="'+window.DRTStoryAutoplay_offset+'" style="padding-bottom:8px">';html+='<div id="player-sidebar-'+videoId+'"></div>';html+="</div>";}html+='<a class="page-link" href="'+video.url+'" data-gtm-element="container-child-link" gtm-element-label="'+label+'">'+video.headline+"</a>";html+="</li>";count++;}}return html;}function buildJWPSidebarMobile($parent,videos){var $section=$parent.find(".article-sidebar").first();if($parent.find(".duroty-videos").length==0){var html="";html+='<div class="listing-article-sidebar duroty-videos" style="display: block; margin-top: -10px;">';html+='<div class="listing contentNews-listing latest-listing view-list">';html+='<div class="box-title board-title-container">';html+='<div class="board-title" data-container-number="2">';html+='<div class="board-title-left">LOS MEJORES VÍDEOS</div>';html+="</div>";html+="</div>";html+='<ul class="section-list">';html+=buildHtmlSidebar(videos,window.DRTVideoSidebar_maxvideos_mobile);html+="</ul>";html+="</div>";html+="</div>";$section.prepend(html);setInview($parent);}}function buildJWPSidebarDesktop($parent,videos){var $list=$parent.find(".listing-article-sidebar").first();var html="";var $section=null;if($list.length==0){if($parent.find(".sidebar-dynamic").find(".duroty-videos").length==0){$section=$parent.find(".sidebar-dynamic").find(".sticky-box").first();}html+='<div class="listing-article-sidebar" style="display: block;">';html+='<div class="listing contentNews-listing latest-listing view-list">';html+='<div class="box-title board-title-container">';html+='<div class="board-title" data-container-number="2">';html+='<div class="board-title-left">Los mejores vídeos</div>';html+="</div>";html+="</div>";html+='<ul class="section-list">';html+=buildHtmlSidebar(videos,window.DRTVideoSidebar_maxvideos);html+="</ul>";html+="</div>";html+="</div>";if($section){$section.after(html);}}else{$list.find(".board-title-left").text("Los mejores vídeos");if($parent.find(".sidebar-dynamic").find(".duroty-videos").length==0){$section=$list.find(".section-list");$section.find("li").remove();$list.addClass("duroty-videos");}html+=buildHtmlSidebar(videos,window.DRTVideoSidebar_maxvideos);if($section){$section.html(html);}}setInview($parent);}function buildJWPSidebar($parent,videos){if(isPhone()){if(window.DRTVideoSidebar_enableMobile){buildJWPSidebarMobile($parent,videos);}}else{if(window.DRTVideoSidebar_enable){buildJWPSidebarDesktop($parent,videos);}}}function setInview($parent){setTimeout(function(){$parent.find(".duroty-video-sidebar").each(function(){var $el=$(this);$el.bind("inview",function(e,visible){if(visible){var $this=$(this);try{var $this=$(this);var video=$this.attr("data-video");if(!jwpSidebar[top.location.url]){jwpSidebar[top.location.url]={};}var myplayer=jwpSidebar[top.location.url][video];if(!myplayer){createVideo(video);}}catch(e){console.log(e);}}});});},10);}function jwplayerAds(){var getNonPurposeAllowed=function getNonPurposeAllowed(){var npa;if(Didomi&&Didomi.isConsentRequired()){npa=Didomi.getUserConsentStatusForVendor("c:jw-player")?"0":"1";}else{npa=0;}return npa;};var getAdvertis};};return{getAdvertising:getAdvertising};}function createVideo(video){jwpSidebar[top.location.url][video]=true;var playerOptions={width:"100%",aspectratio:"16:9",preload:"none",displaytitle:false,autostart:true,mute:true,nextUpDisplay:true,autoplay:false,playlist:"https://cdn.jwplayer.com/v2/media/"+video,related:false,logo:false,repeat:true,"autoPause":{"viewability":true,"pauseAds":false}};playerOptions["advertising"]=jwplayerAds().getAdvertising();var playerInstance=jwplayer("player-sidebar-"+video).setup(playerOptions);playerInstance.setPlaylistItemCallback(function(item,index){return new Promise(function(resolve,reject){setTime);},3000);godo.ads.push(function(x){x.requestVideoAdUrl({slotName:"pre-roll",callb);},customParams:{player:"jwplayer"}});});}).then(function(tag){return Object.assign({},item,{adschedule:[{tag:tag,offset:"pre"}]});})["catcm;});});}function startSidebar(){$.ajax({url:"https://stories.lavanguardia.com/especial/feeds/LaVanguardia/videos/los-mejores-videos.jsonp",dataType:"jsonp",data:{"version":getVersion()},jsonpCallback:"callbackLosmejoresvideos",cache:true}).done(function(json){try{var videos=json.data;if(videos&&videos.length>0){if(typeof jwplayer=="undefined"){(function(){var tag=document.createElement("script");tag.type="application/javascript";tag.src="https://cdn.jwplayer.com/libraries/hTFJ4MdY.js";tag.addEventListener("load",function(){buildJWPSidebar($("body"),videos);if(window.DRTVideoSidebar_inifito){document.addEventListener("infiniteScrollChangeUrl",function(event){buildJWPSidebar($(event.articleContainer),videos);});}});var firstScriptTag=document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag);})();}else{buildJWPSidebar($("body"),videos);if(window.DRTVideoSidebar_inifito){document.addEventListener("infiniteScrollChangeUrl",function(event){buildJWPSidebar($(event.articleContainer),videos);});}}}}catch(e){}});}function init(){if(typeof jQuery!="undefined"){if(!initiated){initiated=true;load();$(document).ready(function(){if(isPhone()){if(window.DRTStoryAutoplay_mobile.enable){start($("body").find(".article-default").first());if(window.DRTStoryAutoplay_mobile.inifito){document.addEventListener("infiniteScrollChangeUrl",function(event){start($(event.articleContainer));});}}if(window.DRTVideoSidebar_enableMobile){startSidebar();}}else{if(window.DRTStoryAutoplay_desktop.enable){start($("body").find(".article-default").first());if(window.DRTStoryAutoplay_desktop.inifito){document.addEventListener("infiniteScrollChangeU);});}}if(window.DRTVideoSidebar_enable){startSidebar();}}});}}else{window.setTimeout(init,50);}}return{init:init};}());if(window.DRTStoryAutoplay_enable){DRTStoryAutoplay.init();}