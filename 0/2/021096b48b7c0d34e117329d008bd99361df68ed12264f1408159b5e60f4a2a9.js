/**/ typeof CQuotient._callback0 === 'function' && CQuotient._callback0({"plp-category-to-project-recommendation":{"displayMessage":"plp-category-to-project-recommendation","recs":[{"id":"262027328P95","product_name":"No-Needles Knit Blanket","image_url":"https://cdn-us-cf2.yottaa.net/551561a7312e580499000a44/www.joann.com/v~22.53/on/demandware.static/-/Sites-joann-project-catalog/default/dw3db73e2b/images/hi-res/project/jpg/262027328P95.jpg","product_url":"https://www.joann.com/s/JoAnn/no-needles-knit-blanket/262027328P95.html"},{"id":"26913744P75","product_name":"Bernat Alize Blanket EZ Afghan","image_url":"https://cdn-us-cf2.yottaa.net/551561a7312e580499000a44/www.joann.com/v~22.53/on/demandware.static/-/Sites-joann-project-catalog/default/dw9a4a34f9/images/hi-res/project/jpg/26913744P75.jpg","product_url":"https://www.joann.com/s/JoAnn/bernat-alize-blanket-ez-afghan/26913744P75.html"},{"id":"4221156703P111","product_name":"Renewal Yarn- Reusable Crochet Shopping Totes","image_url":"https://cdn-us-cf2.yottaa.net/551561a7312e580499000a44/www.joann.com/v~22.53/on/demandware.static/-/Sites-joann-project-catalog/default/dw0aa5fc58/images/hi-res/project/jpg/4221156703P111.jpg","product_url":"https://www.joann.com/s/JoAnn/renewal-yarn--reusable-crochet-shopping-totes/4221156703P111.html"},{"id":"26913744P77","product_name":"Bernat Alize Blanket EZ Baby Blanket","image_url":"https://cdn-us-cf2.yottaa.net/551561a7312e580499000a44/www.joann.com/v~22.53/on/demandware.static/-/Sites-joann-project-catalog/default/dw6899ea52/images/hi-res/project/jpg/26913744P77.jpg","product_url":"https://www.joann.com/s/JoAnn/bernat-alize-blanket-ez-baby-blanket/26913744P77.html"},{"id":"26913744P93","product_name":"Bernat Alize Blanket EZ Textures Blanket","image_url":"https://cdn-us-cf2.yottaa.net/551561a7312e580499000a44/www.joann.com/v~22.53/on/demandware.static/-/Sites-joann-project-catalog/default/dwf7111fa6/images/hi-res/project/jpg/26913744P93.jpg","product_url":"https://www.joann.com/s/JoAnn/bernat-alize-blanket-ez-textures-blanket/26913744P93.html"},{"id":"26913744P83","product_name":"Bernat Alize Blanket EZ Criss-Cross Cowl","image_url":"https://cdn-us-cf2.yottaa.net/551561a7312e580499000a44/www.joann.com/v~22.53/on/demandware.static/-/Sites-joann-project-catalog/default/dw8b9e392a/images/hi-res/project/jpg/26913744P83.jpg","product_url":"https://www.joann.com/s/JoAnn/bernat-alize-blanket-ez-criss-cross-cowl/26913744P83.html"},{"id":"26913744P84","product_name":"Bernat Alize Blanket EZ Criss-Cross Pillow","image_url":"https://cdn-us-cf2.yottaa.net/551561a7312e580499000a44/www.joann.com/v~22.53/on/demandware.static/-/Sites-joann-project-catalog/default/dwb2eef42e/images/hi-res/project/jpg/26913744P84.jpg","product_url":"https://www.joann.com/s/JoAnn/bernat-alize-blanket-ez-criss-cross-pillow/26913744P84.html"},{"id":"26913744P96","product_name":"Big Twist Loopity Loops Twisted Stitch Nursery Blanket","image_url":"https://cdn-us-cf2.yottaa.net/551561a7312e580499000a44/www.joann.com/v~22.53/on/demandware.static/-/Sites-joann-project-catalog/default/dwda2f3b7b/images/hi-res/project/jpg/26913744P96.jpg","product_url":"https://www.joann.com/s/JoAnn/big-twist-loopity-loops-twisted-stitch-nursery-blanket/26913744P96.html"},{"id":"40810887P122","product_name":"Yarn Wrapped Holiday Ornaments","image_url":"https://cdn-us-cf2.yottaa.net/551561a7312e580499000a44/www.joann.com/v~22.53/on/demandware.static/-/Sites-joann-project-catalog/default/dw93a6f992/images/hi-res/project/jpg/40810887P122.jpg","product_url":"https://www.joann.com/s/JoAnn/yarn-wrapped-holiday-ornaments/40810887P122.html"},{"id":"042188731P31","product_name":"Loop Yarn Rug","image_url":"https://cdn-us-cf2.yottaa.net/551561a7312e580499000a44/www.joann.com/v~22.53/on/demandware.static/-/Sites-joann-project-catalog/default/dw47270359/images/hi-res/project/jpg/042188731P31.jpg","product_url":"https://www.joann.com/s/JoAnn/loop-yarn-rug/042188731P31.html"},{"id":"26913744P79","product_name":"Bernat Alize Blanket EZ Checked Blanket","image_url":"https://cdn-us-cf2.yottaa.net/551561a7312e580499000a44/www.joann.com/v~22.53/on/demandware.static/-/Sites-joann-project-catalog/default/dw020d08ac/images/hi-res/project/jpg/26913744P79.jpg","product_url":"https://www.joann.com/s/JoAnn/bernat-alize-blanket-ez-checked-blanket/26913744P79.html"},{"id":"26913744P91","product_name":"Bernat Alize Blanket EZ Scarf","image_url":"https://cdn-us-cf2.yottaa.net/551561a7312e580499000a44/www.joann.com/v~22.53/on/demandware.static/-/Sites-joann-project-catalog/default/dwf47c33c6/images/hi-res/project/jpg/26913744P91.jpg","product_url":"https://www.joann.com/s/JoAnn/bernat-alize-blanket-ez-scarf/26913744P91.html"},{"id":"26913744P76","product_name":"Bernat Alize Blanket EZ Baby Bear Hat","image_url":"https://cdn-us-cf2.yottaa.net/551561a7312e580499000a44/www.joann.com/v~22.53/on/demandware.static/-/Sites-joann-project-catalog/default/dwd3340721/images/hi-res/project/jpg/26913744P76.jpg","product_url":"https://www.joann.com/s/JoAnn/bernat-alize-blanket-ez-baby-bear-hat/26913744P76.html"},{"id":"392115075P300","product_name":"Crochet Cat Sweater","image_url":"https://cdn-us-cf2.yottaa.net/551561a7312e580499000a44/www.joann.com/v~22.53/on/demandware.static/-/Sites-joann-project-catalog/default/dw1f4ede01/images/hi-res/project/jpg/392115075P300.jpg","product_url":"https://www.joann.com/s/JoAnn/crochet-cat-sweater/392115075P300.html"},{"id":"26913744P82","product_name":"Bernat Alize Blanket EZ Criss-Cross Baby Blanket","image_url":"https://cdn-us-cf2.yottaa.net/551561a7312e580499000a44/www.joann.com/v~22.53/on/demandware.static/-/Sites-joann-project-catalog/default/dwb5d02d1c/images/hi-res/project/jpg/26913744P82.jpg","product_url":"https://www.joann.com/s/JoAnn/bernat-alize-blanket-ez-criss-cross-baby-blanket/26913744P82.html"}],"recoUUID":"066bd573-7396-414e-ab92-cd2892e1915e"}});ow.msCrypto?new Uint32Array(1):new Date,n=window.crypto||window.msCrypto||{getRandomValues:function(e){return[parseInt(e.getTime()/(window.innerWidth/window.innerHeight)*e.getMilliseconds())]}};r.length<e;)r+=n.getRandomValues(i)[0];return r=r.slice(0,e),"int"==t?r:"0."+r}catch(e){}},EBG.Semi.Infra.getRandomText=function(e){e=e||32;for(var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",r=[],i=0,n="";i<e;){var o=t.split(""),a=EBG.Semi.Infra.getRandomNumber();(a=parseInt(a.slice(-2)))<t.length&&n!=o[a]&&(n=r[i]=o[a],i++)}return r.join("")},EBG.Semi.Infra.getAddInEyeDomain=function(e,t){var r="",i="",n=0,o=(e||window).document,a=o.referrer?o.referrer:o.location.href;try{(a=a.toLowerCase()).length>=7&&"http://"==a.slice(0,7)?(i=a.slice(7),a.slice(0,7)):a.length>=8&&"https://"==a.slice(0,8)?(i=a.slice(8),a.slice(0,8)):i=a,(n=i.indexOf("/"))>0&&(i=i.slice(0,n)),r=i}catch(e){r=""}return r},EBG.Semi.Infra.createFriendlyIframe=function(e,t,r,i){var n=(e=e||document).createElement("iframe");return t&&n.setAttribute("id",t),n.style.display=r?"":"none",n.style.width=r?r+"px":"0px",n.style.height=i?i+"px":"0px",document.documentMode&&document.documentMode<8?(n.frameBorder=0,n.margin=0,n.marginWidth=0,n.marginHeight=0,n.scrolling="no",n.ariaHidden="true"):(n.setAttribute("scrolling","no"),n.setAttribute("marginwidth","0"),n.setAttribute("marginheight","0"),n.setAttribute("frameborder","0"),n.setAttribute("aria-hidden","true")),n},EBG.Semi.Infra.isIframeScriptable=function(e){try{this.ifrmDocument=e.contentWindow.document}catch(e){return!1}return!0},EBG.Semi.Infra.enableIframeScriptable=function(e){if(e){e.setAttribute("data-isready","false");var t="javascript:document.write('";t+="<scr'+'ipt>\r",t+='try{parent.document.domain;}catch(e){document.domain="'+document.domain+'";}\r',t+="parent.EBG.Semi.Infra.friendlyIframeIsReadyCallback(window);\r",t+="</scr'+'ipt>\r');",e.src=t}},EBG.Semi.Infra.friendlyIframeIsReadyCallback=function(e){for(var t=document.getElementsByTagName("iframe"),r=0;r<t.length;r++)try{if((t[r].contentWindow||t[r].contentDocument.window||t[r].window)==e){t[r].setAttribute("data-isready","true");break}}catch(e){}},EBG.Semi.Infra.writeToFriendlyIframe=function(e,t,r){if(document.documentMode&&7<document.documentMode&&"false"==e.getAttribute("data-isready"))setTimeout((function(){EBG.Semi.Infra.writeToFriendlyIframe(e,t,r)}),100);else{var i;r=!!this.isDefined(r)&&r,i=e.contentWindow?e.contentWindow.document:e.contentDocument&&e.contentDocument.document?e.contentDocument.document:e.contentDocument;try{i.write(t)}catch(e){}r&&setTimeout((function(){i.close()}),1e3)}},EBG.Semi.Infra.createUnfriendlyIframe=function(e,t,r){if(t&&!EBG.Semi.Infra.isPageLoaded())this.logger&&this.logger.info("Adding unfriendly iframe in sync mode, url: "+e),document.write('<iframe src="'+e+'" aria-hidden="true" style="display:none;width:0px;height:0px"></iframe>');else{this.logger&&this.logger.info("Adding unfriendly iframe in async mode, url: "+e);var i=document.createElement("iframe");i.setAttribute("src",e),i.setAttribute("aria-hidden",!0),i.style.display="none",i.onload=r,EBG.Semi.Infra.addChildToPage(i)}},EBG.Semi.Infra.isPageRefresh=function(){try{return!(!window.performance.navigation||1!==window.performance.navigation.type)||"reload"==window.performance.getEntriesByType("navigation")[0].type}catch(e){return!1}},EBG.Semi.Infra.getTopLevelReferrer=function(e){var t=null;try{if(!(e.top&&e.top.document&&e.top.document.referrer))throw new Error("Unfriendly iframe");t=e.top.document.referrer.toString()}catch(r){this.isDefined(e)&&e.document&&e.document.referrer&&(t=e.document.referrer.toString())}return t},EBG.Semi.Infra.getTokenValueFromURL=function(e,t){var r=t.indexOf("?")?t.split("?")[1]:"";if(r)for(var i=r.split("&"),n=0;n<i.length;n++){var o=i[n].split("=");if(o[0]==e)return o[o.length-1]}return null},EBG.Semi.Infra.urlAvailableLength=function(e){var t=8e3;return EBG.Semi.Infra.isOldIE()&&(t=2048),t-e.length},EBG.Semi.Infra.isOldIE=function(e){var t,r,i,n,o=navigator.userAgent;return-1!=(t=o.indexOf("MSIE"))&&(-1!=(n=(r=o.substring(t+5)).indexOf(";"))&&(r=r.substring(0,n)),-1!=(n=r.indexOf(" "))&&(r=r.substring(0,n)),i=parseInt(""+r,10),isNaN(i)&&(r=""+parseFloat(navigator.appVersion),i=parseInt(navigator.appVersion,10)),i<9)},EBG.Semi.Infra.typeOf=function(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array||!(e instanceof Object)&&"[object Array]"==Object.prototype.toString.call(e)||"number"==typeof e.length&&void 0!==e.splice&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if(!(e instanceof Object||"[object Function]"!=Object.prototype.toString.call(e)&&(void 0===e.call||void 0===e.propertyIsEnumerable||e.propertyIsEnumerable("call"))))return"function"}else if("function"==t&&void 0===e.call)return"object";return t},EBG.Semi.declareNamespace=EBG.Semi.Infra.declareNamespace,EBG.Semi.EventName={ALL_USER_ID_FOUND:"allUserIdFound"},EBG.Semi.ServingState={script:"SCRIPT",friendlyIframe:"FRIENDLY_IFRAME",unfriendlyIframe:"IFRAME"},EBG.Semi.Events=EBG.Semi.Events||{},EBG.Semi.Events.EventManager=function(){},EBG.Semi.Events.EventManager.prototype={_subscriptions:{},subscribeToEvent:function(e,t,r,i){this._subscriptions[e]||(this._subscriptions[e]={}),this._subscriptions[e][i]||(this._subscriptions[e][i]=[]),i&&this._subscriptions[e][i].push({callback:t,bindingCallback:r})},dispatchEvent:function(e,t,r){if(r)for(var i=this._subscriptions[e][r],n=0;n<i.length;++n){(a=this._subscriptions[e][r][n]).callback.apply(a.bindingCallback,[t])}else{var o=this._subscriptions[e];for(var r in o)if(o[r])for(i=o[r],n=0;n<i.length;++n){var a;(a=o[r][n]).callback.apply(a.bindingCallback,[t])}}}},EBG.Semi.Events.eventMgr=EBG.Semi.Events.eventMgr||new EBG.Semi.Events.EventManager,EBG.Semi.WindowUtil=function(){},EBG.Semi.WindowUtil.getTopWindow=function(){var e=window,t=e.location.origin||e.location.protocol+"//"+e.location.host;e.EBservingMode=EBG.Semi.ServingState.script;try{if(window.location.ancestorOrigins&&window.URL)for(var r=0;r<location.ancestorOrigins.length;r++){if(0==r&&"null"==t&&(t=location.ancestorOrigins[0]),location.ancestorOrigins[r]!==t){e.EBservingMode=EBG.Semi.ServingState.unfriendlyIframe;break}(e=e.parent).EBservingMode=EBG.Semi.ServingState.friendlyIframe}else for(;e!==e.parent;){var i=null,n=e.location.origin||e.location.protocol+"//"+e.location.host;try{i=e.parent.location.origin||e.parent.location.protocol+"//"+e.parent.location.host}catch(e){}if(i!==n){e.EBservingMode=EBG.Semi.ServingState.unfriendlyIframe;break}(e=e.parent).EBservingMode=EBG.Semi.ServingState.friendlyIframe}}catch(e){}return e},EBG.Semi.ServerCommunicator=function(e){this._imgArr=[],this._requestCounter=0,this._throttlingHandler=null,this._throttlingTimeout=1e3,this._throttlingMax=10,e=e||{},this._timeout=EBGVT.Light.Infra.isDefined(e.timeout)?e.timeout:0,this._retries=EBGVT.Light.Infra.isDefined(e.retries)?e.retries:-1,this._retryDelay=EBGVT.Light.Infra.isDefined(e.retryDelay)?e.retryDelay:-1;for(var t=0;t<10;t++)this._imgArr.push(new Image)},EBG.Semi.ServerCommunicator.prototype={getRequest:function(e,t,r,i){this._sendRequest(e,{},!1,t,r,i)},sendDataRequest:function(e,t,r,i,n){this._sendRequest(e,i||{},!0,t,r,n)},_sendRequest:function(e,t,r,i,n,o){var a=this,s=t.retry||-1,d=function(e,r,a){r&&r.status>=200&&r.status<400?i&&i.apply(o||this,[e,r]):(n&&n.apply(o||this,[s,a,r]),s>0&&(s--,setTimeout(c,t.retryDelay||1e3)))},c=function(){a._throttlingHandler||(a._throttlingHandler=setTimeout((function(){clearTimeout(a._throttlingHandler),a._throttlingHandler=null,a._requestCounter=0}),a._throttlingTimeout)),a._requestCounter>a._throttlingMax?setTimeout((function(){c()}),a._throttlingTimeout/2):(a._requestCounter++,r?EBG.Semi.Infra.loadFileByScriptElem(document,e,d,!1,this):EBG.Semi.Infra.ajax.get(e,{},d,!0,{timeout:t.timeout}))};c()},reportUrlsList:function(e,t,r){for(var i=0;i<this._imgArr.length;i++)this.reportUrl(e,this._imgArr[i],t,r)},reportUrl:function(e,t,r,i){if(e.length>0){var n=this;o=e.shift(),t.onload=function(){r&&i&&setTimeout((function(){r.apply(i,[null,o])}),1),n.reportUrl(e,t,r,i)},t.onerror=function(){r&&i&&setTimeout((function(){r.apply(i,["failed loading url",o])}),1),n.reportUrl(e,t,r,i)},t.src=o}var o}},EBG.Semi.declareNamespace("Logging"),EBG.Semi.Logging.Logger=function(e){this._level=e,this.startNestingGroupNames=[],this.endNestingGroupNames=[]},EBG.Semi.Logging.Logger.DebugMode="mmdebug",EBG.Semi.Logging.Logger.LoggerLevels={NONE:0,ERROR:1,INFO:2,WARN:3,DEBUG:4},EBG.Semi.Logging.Logger.prototype={setLevel:function(e){this._level=e},timestamp:!1,debug:function(e){this._reportToLog(EBG.Semi.Logging.Logger.LoggerLevels.DEBUG,arguments)},info:function(e){this._reportToLog(EBG.Semi.Logging.Logger.LoggerLevels.INFO,arguments)},warn:function(e){this._reportToLog(EBG.Semi.Logging.Logger.LoggerLevels.WARN,arguments)},error:function(e){this._reportToLog(EBG.Semi.Logging.Logger.LoggerLevels.ERROR,arguments)},exception:function(e,t){var r="string"!==t?this._format("Exception in {0}. message: {1}",e,t.message):this._format("Exception in: {0}. message: {1}",e,t);t.stack&&(r+=this._format(" stack: {0}",t.stack)),this._reportToLog(EBG.Semi.Logging.Logger.LoggerLevels.ERROR,[r])},startGroup:function(e){this._supportNesting()&&this.startNestingGroupNames.push(e)},endGroup:function(){this._supportNesting()&&this.endNestingGroupNames.length>0&&window.console.groupEnd(this.endNestingGroupNames.pop())},_consoleAvailable:function(){try{return void 0!==window&&void 0!==window.console}catch(e){return!1}},_supportNesting:function(){return!!this._consoleAvailable()&&void 0!==window.console.group},_supportErrorMessage:function(){return void 0!==window.console.error},_supportInfoMessage:function(){return void 0!==window.console.info||void 0!==window.opera},_supportWarnMessage:function(){return void 0!==window.console.warn||void 0!==window.opera},_supportObjectView:function(){return void 0!==window.console.dir||void 0!==window.opera},_callConsoleFunction:function(e,t){var r=!1;switch(e){case EBG.Semi.Logging.Logger.LoggerLevels.INFO:this._supportInfoMessage()&&(window.console.info(t),r=!0);break;case EBG.Semi.Logging.Logger.LoggerLevels.WARN:this._supportWarnMessage()&&(window.console.warn(t),r=!0);break;case EBG.Semi.Logging.Logger.LoggerLevels.ERROR:this._supportErrorMessage()&&(consoleFunction=window.console.error(t),r=!0)}r||window.console.log(t)},_format:function(e){for(var t=1;t<arguments.length;t++)e=e.replace(new RegExp("\\{"+(t-1)+"\\}","gi"),""+arguments[t]);return e},_getTimestamp:function(){if(this.timestamp)return EBG.Semi.Infra.getTimestamp()},_reportToLog:function(e,t){if(this._level>=e&&this._consoleAvailable()){var r=t[0];if("[object String]"!==Object.prototype.toString.call(r)?this._supportObjectView()||(r=r.toString()):r=this._format.apply(null,t),this.timestamp&&"[object String]"===Object.prototype.toString.call(r)&&(r=this._getTimestamp()+": "+r),void 0===window.opera){for(;this.startNestingGroupNames.length;)window.console.group(this.startNestingGroupNames[0]),this.endNestingGroupNames.push(this.startNestingGroupNames.shift());this._callConsoleFunction(e,r)}else opera.postError(r)}}},EBGUIP="undefined"!=typeof EBGUIP?EBGUIP:{},EBGUIP.Events=EBGUIP.Events||{},EBGUIP.Events.EventName={USER_ID_FOUND:"userIdFound",DOC_LOADED:"documentLoaded",EBUID_LOADED:"ebuidLoaded"},EBGUIP.Events.eventMgr=EBGUIP.Events.eventMgr||new EBG.Semi.Events.EventManager,EBGUIP="undefined"!=typeof EBGUIP?EBGUIP:{},EBGUIP.UserIdProvider=function(){"undefined"!=typeof gEBMainWindow&&gEBMainWindow.providersData?this._providersData=gEBMainWindow.providersData:"undefined"!=typeof gEBMainWindow&&(this._providersData={EBUidCache:{data:null,providerCalled:!1}},gEBMainWindow.providersData=this._providersData)},EBGUIP.ProvidersReversed={e2:"EBUidCache"},EBGUIP.UserIdProvider.prototype={_filter:null,_currTagData:null,_arrProvidersNamesUsed:null,_providers:{EBUidCache:{isUsed:!1,shouldSendData:!0}},_providersData:null,getUserIds:function(e){this._filter=e.filter,this._init(),this._currTagData=e,this._currTagData.currDoc||(this._currTagData.currDoc=document),this._arrProvidersNamesUsed=this._getValidProviderNames(e.uip);for(var t=0;t<this._arrProvidersNamesUsed.length;t++)this._providers[this._arrProvidersNamesUsed[t]].isUsed=!0;this._loadProviders()},_init:function(){for(var e in this._providers)this._providers[e].isUsed=!1},_loadProviders:function(){if(this._arrProvidersNamesUsed.length>0){var e=this._arrProvidersNamesUsed[0];if(this._providersData[e].providerCalled){var t={providerName:e};this._getUserIdentification(t)}else{EBGUIP.Events.eventMgr.subscribeToEvent(EBGUIP.Events.EventName.USER_ID_FOUND,this._getUserIdentification,this,this._filter);var r=this._buildProviderURL(e);this._currTagData.isSync?(EBGUIP.Events.eventMgr.subscribeToEvent(EBGUIP.Events.EventName.DOC_LOADED,this._providerLoaded,this,this._filter),EBG.Semi.Infra.loadFileByScriptElem(this._currTagData.currDoc,r,null,!0)):EBG.Semi.Infra.loadFileByScriptElem(this._currTagData.currDoc,r,this._providerLoaded,!1,this,{providerName:e})}}},_buildProviderURL:function(e){var t=this._currTagData.scriptsPath+"UserProviders"+this._currTagData.uipv+"/"+e+".js";return-1==this._currTagData.scriptsPath.indexOf("http")&&(t=this._getRequestProtocol(this._currTagData.ebPtcl)+t),t},_getRequestProtocol:function(e){if(e)return e;var t="https://secure-",r=location.protocol;if("javascript:"==r)try{r=parent.location.protocol}catch(e){}return"http:"==r&&(t=r+"//"),t},_providerLoaded:function(e){var t=e.providerName;-1!=EBG.Semi.Infra.indexOfArray(this._arrProvidersNamesUsed,t)&&(new window.EBGUIP[t]).init(this._currTagData)},_getUserIdentification:function(e){var t=EBG.Semi.Infra.indexOfArray(this._arrProvidersNamesUsed,e.providerName);if(-1!=t)if(e.tokenName&&e.id&&this._providers[e.providerName].shouldSendData&&!this._providersData[e.providerName].data&&(this._providersData[e.providerName].data="&"+e.tokenName+"="+e.id),this._providersData[e.providerName].providerCalled=!0,this._arrProvidersNamesUsed.splice(t,1),0==this._arrProvidersNamesUsed.length){var r={userIdStr:this._getProvidersData()};EBG.Semi.Events.eventMgr.dispatchEvent(EBG.Semi.EventName.ALL_USER_ID_FOUND,r,this._filter)}else this._loadProviders()},_getProvidersData:function(){var e="";for(var t in this._providersData)this._providers[t].isUsed&&this._providers[t].shouldSendData&&(e+=this._providersData[t].data);return e},_getValidProviderNames:function(e){for(var t=this._cleanUIPList(e),r=[],i=0;i<t.length;i++){var n=EBGUIP.ProvidersReversed["e"+t[i]];n&&(r[r.length]=n)}return r},_cleanUIPList:function(e){var t=[];if(e)for(var r=0;r<e.length;++r)EBGUIP.ProvidersReversed["e"+e[r]]&&t.push(e[r]);return t}},EBG.Semi.AttributionEnum=function(){},EBG.Semi.AttributionEnum.UrlParamNames={ID:"onetagid",DISP_TYPE:"dispType",SYNC:"sync",ONETAG_URL:"ebOneTagURL",PAGE_URL:"pageurl",DEBUG_MODE:"debugmode",NO_SCRIPT:"ns",MOBILE:"mb",ACTIVITY_PARAMS:"activityValues",RETARGET_PARAMS:"retargetingValues",DYNAMIC_RETARGET_PARAMS:"dynamicRetargetingValues",CONDITIONAL_PARAMS:"acp",RANDOM:"rnd",SEC_CALL:"secCall",SESSION_ID:"sessionid",ORIG_URL_LENGTH:"origLength",SERVING_PIPE:"/Serving",PREV_SERVING_PIPE:"/BurstingPipe",BROWSER_EVENT:"tp_be",ADV_DEVICE_ID:"ebaddid",DI_APP_ID:"diappid",USER_COOKIE:"usercookie",POST_CLICK:"pstclk",UIN:"uinadv",OPTOUT:"optout"},EBG.Semi.AttributionEnum.DisplayTypes={IFRAME:"iframe",JAVASCRIPT:"js"},EBG.Semi.AttributionEnum.HttpProtocol={HTTP:"http",HTTPS:"https"},EBG.Semi.Attribution=function(){this.logNeeded=EBG.Semi.Infra.getUrlParameter(EBG.Semi.Logging.Logger.DebugMode)?1:0,this.AttributionLogger=new EBG.Semi.Logging.Logger(EBG.Semi.Infra.getUrlParameter(EBG.Semi.Logging.Logger.DebugMode)),this.uidProviders=new EBGUIP.UserIdProvider,this.AttributionLogger.timestamp=!0,this.serverCommunicator=this.serverCommunicator||new EBG.Semi.ServerCommunicator},EBG.Semi.Attribution.prototype={_userIdProvidersCalled:!1,_providers:null,_currResponse:null,generateRequest:function(e){this.AttributionLogger.info("Attribution Started");var t=e.partialRequest;this.AttributionLogger.info("Server URL: "+t),this._userIdProvidersCalled&&(t=this._addProviderUserId(t)),EBG.Semi.Infra.loadFileByScriptElem(document,t,(function(){this._handleResponse(e.tagType+e.tagId+"-"+e.filter)}),!1,this)},_handleResponse:function(e){var t=window.bsResponseObj[e];this.AttributionLogger.info("Server response: "+t),t&&!this._currResponse?(this._currResponse={},this._currResponse.filter=t.sessionId,this._currResponse.urls=t.urls||[],this._currResponse.scripts=t.scripts||[],this._currResponse.tagType=t.tagType,this._currResponse.tagId=t.tagId):t&&this._currResponse&&(this._currResponse.urls=t.urls||[],this._currResponse.scripts=t.scripts||[]),t&&t.uip&&t.uip.length>0?(this._currResponse.uip=t.uip,this._currResponse.uipv=t.uipv,this._currResponse.scriptsPath=t.scriptsPath,this._currResponse.partialRequest=t.partialRequest,this._currResponse.isSync=!1,this._currResponse.bs=t.bs,this._currResponse.ebPtcl=t.ebPtcl,EBG.Semi.Events.eventMgr.subscribeToEvent(EBG.Semi.EventName.ALL_USER_ID_FOUND,this._getUserIdProviders,this,this._currResponse.filter),this.uidProviders.getUserIds(this._currResponse),t.uip=null):this._currResponse&&(this._handleScriptTags(this._currResponse.scripts),this._handleUrlTags(this._currResponse.urls,this._currResponse.redirectUrl))},_handleUrlTags:function(e,t){e&&e.length>0&&this.serverCommunicator.reportUrlsList(e),this._windowRedirect(t)},_handleScriptTags:function(e){if(e&&e.length>0)for(var t=0;t<e.length;t++)e[t]&&EBG.Semi.Infra.injectScript(unescape(e[t]))},_windowRedirect:function(e){e&&gEBMainWindow&&gEBMainWindow.document&&gEBMainWindow.document.location&&gEBMainWindow.document.location.replace(e)},_getUserIdProviders:function(e){this._userIdProvidersCalled||(this._userIdProvidersCalled=!0,e&&(this._currResponse.targetUrl=e.userIdStr),this.generateRequest(this._currResponse))},_addProviderUserId:function(e){if(EBG.Semi.Infra.urlAvailableLength(e)-48>this._currResponse.targetUrl.length)e+=this._currResponse.targetUrl;else{var t=e.length+this._currResponse.targetUrl.length+2;e+="&"+EBG.Semi.AttributionEnum.UrlParamNames.ORIG_URL_LENGTH+"="+t}return e}},gEBMainWindow=window.gEBMainWindow||EBG.Semi.WindowUtil.getTopWindow();for(var ebAttribution=window.ebAttribution||{};window.ebAttrConf&&window.ebAttrConf.length;)ebAttribution[ebAttrConf[0]]=new EBG.Semi.Attribution,ebAttribution[ebAttrConf[0]]._handleResponse(ebAttrConf[0]),ebAttrConf.splice(0,1);