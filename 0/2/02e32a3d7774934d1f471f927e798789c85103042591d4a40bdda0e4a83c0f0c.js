/*! For license information please see render.Entry-v7.10.0.js.LICENSE.txt */
(self.webpackChunkweb_chat_client=self.webpackChunkweb_chat_client||[]).push([[9070],{85247:function(e,t,n){"use strict";n.r(t),n.d(t,{defaul}});var r=n(35466),a=n(46116),o=n(51038),s=n(90986),i=n.n(s),l=(n(90610),n(17425)),c=n(31309),u=r.createContext(null),d=r.createContext(null);function m(){return(0,r.useContext)(d)}var p,f=n(23833),h=n.n(f),g=n(11225),v=n.n(g),_=n(32149),C=n.n(_),E=n(10480),A=n.n(E),S=n(30037),y=function(){return y=i()||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},y.apply(this,arguments)},b=r.forwardRef((function(e,t){return r.createElement("div",y({ref:t},e,{className:"WACVisuallyHidden ".concat(e.className||"")}),e.children)})),N=(p=function(e,t){return p=h()||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},p(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}p(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),W=new(v())(["button","date","datetime-local","email","file","month","number","range","reset","search","submit","tel","text","time","url","week"]),T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ref1=r.createRef(),t.ref2=r.createRef(),t.useRef1=!0,t.doAnnouncements=function(){var e=[];t.pendingValues.forEach((function(t){"string"==typeof t?e.push(t):w(t,e)}));var n=t.useRef1?t.ref1.current:t.ref2.current;n&&(n.innerText=e.join(" "),(t.useRef1?t.ref2.current:t.ref1.current).innerHTML=""),t.useRef1=!t.useRef1,t.pendingValues=null},t}return N(t,e),t.prototype.announceValue=function(e){if(e)if(this.pendingValues||(this.pendingValues=[],setTimeout(this.doAnnouncements,250)),"string"==typeof e}(e))this.pendingValues.push(e);else if(e.messageID){var t=this.props.intl.formatMessage({id:e.messageID},e.messageValues);this.pendingValues.push(t)}else this.pendingValues.push(e.messageText)},t.prototype.render=function(){return r.createElement(b,{className:"WACAriaAnnouncer"},r.createElement("div",{ref:this.ref1,"aria-live":"polite"}),r.createElement("div",{ref:this.ref2,"aria-live":"polite"}))},t}(r.PureComponent);function w(e,t){(0,S.kK)(e)?"none"!==window.getComputedStyle(e).display&&"true"!==e.getAttribute("aria-hidden")&&(I(e.getAttribute("aria-label"),t),(0,S.HB)(e)&&W.has(e.type.toLowerCase())?""===e.value?I(e.placeholder,t):I(e.value,t):(0,S.KC)(e)?""===e.value&&I(e.placeholder,t):(0,S.$Q)(e)&&I(e.alt,t),e.childNodes.forEach}))):(0,S.BM)(e)&&I(e.data,t)}function I(e,t){e&&(e=C()(e).call(e))&&t.push(A()(e).call(e,"\n"," "))}function R(e){var t=(0,c.Z)(),n=m().store,a=(0,r.useRef)(),o=(0,r.useCallback)((function(e){a.current?a.current.announceValue(e):setTimeout}))}),[]),s=(0,r.useRef)();return(0,r.useEffect)((function(){return n.subscribe((function(){var e=n.getState().announceMessage;e!==s.current&&(o(e),s.current=e)}))}),[n,o]),r.createElement(u.Provider,{value:o},e.children,r.createElement(T,{intl:t,ref:a}))}var M=n(58442),O=n(42897),k=n(23986),P=n(82803),B=r.createContext(null);function D(){return(0,r.useContext)(B)}var }var F=n(49415),H=n(53213),U=n(39396),V=n(26921),Z=n(92703),q=n.n(Z);function z(e,t,n){return n?t?e.launcher_isTourOpen:e.launcher_isTourClosed:t?e.launcher_isOpen:e.launcher_isClosed}function G(e,t){var n=e.onToggleOpen,a=e.languagePack,s=e.unreadAgentCount,i=e.intl,l=e.serviceManager,c=e.showUnreadIndicator,u=e.className,d=e.tabIndex,m=e.launcherHidden,p=e.activeTour,f=(0,o.v9)((function(e){return e.launcherAvatarURL})),h=r.createRef();(0,r.useImperativeHandle)(t,(function(){return{requestFocus:function(){(0,S.OP)(h)}}}));var g=z(a,m,p);0!==s&&(g+=". ".concat(i.formatMessage({id:"icon_ariaUnreadMessages"},{count:s})));var v=r.createElement(U.yvE,{className:"WACLauncher__svg"});return f&&(v=r.createElement("img",{className:"WACLauncher__Avatar",src:f,"aria-hidden":!0})),r.createElement("div",{className:q()("WACLauncher__ButtonContainer","WACLauncher__ButtonContainer--round",u,{"WACLauncher__ButtonContainer--hidden":m})},r.createElement("button",{"aria-label":g,className:q()("WACLauncher__Button","WAC__button--base","WAC__button--primary",{"WACLauncher__TourButton WAC__button--ghost":p}),id:"WACLauncher__Button".concat(l.namespace.suffix),type:"button",onClick:n,ref:h,tabIndex:d},p?r.createElement(V.Te2,{className:"WACLauncher__svg"}):v,(0!==s||c)&&r.createElement("div",{className:"WAC__countIndicator"},0!==s?s:"")))}var j=(0,r.forwardRef)(G),K=n(74477),Y=n(27885);function $(e){var t=e.serviceManager,n=e.languagePack,a=e.intl,o=e.launcherConfig,s=e.launcherComplexRef,i=e.launcherRef,l=e.onOpen,c=e.onMinimize,u=e.unreadAgentCount,d=e.showUnreadIndicator,m=e.desktopLauncherIsExpanded,p=e.isToolingPreview,f=e.launcherHidden,h=e.activeTour,g=e.className,v=(n.launcher_isOpen,n.launcher_isClosed,n.launcher_desktopGreeting),_=n.launcher_closeButton,C=n.launcher_ariaIsExpanded,E=p?-1:void 0;return r.createElement("div",{className:q()("WACLauncher__ButtonContainer","WACLauncherComplex__Container",g,{"WACLauncher__ButtonContainer--hidden":f,"WACLauncherComplex__Container--toolingPreview WACLauncher__ButtonContainer--toolingPreview":p}),ref:s,"aria-hidden":p},r.createElement("button",{className:"WACLauncherComplex__ContentButton",type:"button",onClick:l,disabled:!m,tabIndex:E},r.createElement("div",{className:q()("WACWidget__textEllipsis",{WACLauncherComplex__Text:!f})},o.desktop.title?o.desktop.title:v)),r.createElement(j,{serviceManager:t,languagePack:n,intl:a,ref:i,onToggleOpen:l,className:"WACLauncherComplex__SmallLauncherContainer",unreadAgentCount:u,showUnreadIndicator:d,tabIndex:E,launcherHidden:f,activeTour:h}),r.createElement(Y.Z,{className:"WACLauncher__CloseButton","aria-label":C,onClick:c,disabled:!m,tabIndex:E},r.createElement("div",{className:"WACLauncher__CloseButtonInnerWrapper"},r.createElement(K.PcV,{className:"WACLauncher__CloseButtonIcon"}),_)))}var X=function(e){var t=e.launcherRef,n=e.onDoToggle,a=e.requestFocus,s=e.launcherHidden,i=e.activeTour,l=m(),u=D(),d=(0,c.Z)(),p=(0,o.v9)((function(e){return e.persistedToBrowserStorage.launcherState})),f=p.desktopLauncherWasMinimized,h=p.desktopLauncherIsExpanded,g=p.bounceTurn,v=p.showUnreadIndicator,_=p.viewState,C=(0,o.v9)((function(e){return e.launcher})).config,E=C.desktop,A=E.time_to_expand,S=E.new_expand_time,y=(0,o.v9)((function(e){return e.agentState.numUnreadMessages})),b=(0,o.v9)((function(e){return e.config.public})).__ibm__.launcherToolingPreview===k.Dp.DESKTOP,N=(0,r.useState)(""),W=N[0],T=N[1],w=(0,r.useState)(""),I=w[0],R=w[1],M=(0,r.useRef)(),O=(0,r.useRef)();O.current=s;var P=(0,r.useRef)(!1),B=(0,r.useRef)();B.current=g;var U=(0,r.useRef)(),V=(0,r.useRef)(),Z=(0,r.useRef)(),q=(0,r.useRef)(),z=(0,r.useRef)(),G=(0,r.useRef)(),K=(0,r.useCallback)((function(){var e,t,n,r="".concat(null===(e=M.current)||void 0===e?void 0:e.offsetHeight,"px");(null===(n=null===(t=M.current)||void 0===t?void 0:t.style)||void 0===n?void 0:n.setProperty)&&M.current.style.setProperty("--WatsonAssistantChat-LAUNCHER-desktop-expanded-height",r)}),[]),Y=(0,r.useCallback)((function(){O.current||(l.store.dispatch(F.ZP.setLauncherProperty("desktopLauncherIsExpanded",!0)),K(),R("WACLauncherComplex__Container--introAnimation"))}),[K,l.store]),X=(0,r.useCallback)((function(){O.current||l.trackService.track({eventName:"Launcher interaction",eventDescription:"Desktop animation finished."})}),[l.trackService]),J=(0,r.useCallback)((function(){U.current=setTimeout((function(){Y()}),A),V.current=setTimeout((function(){X()}),A+700)}),[X,A,Y]),Q=(0,r.useCallback)}),[]),ee=(0,r.useCallback)}),[]),te=(0,r.useCallback)((function(){O.current||(l.trackService.track({eventName:"Launcher interaction",eventDescription:"Desktop launcher finished bounce animation ".concat(B.current,".")}),T("WACLauncher__ButtonContainer--noAnimation"),B.current++,l.store.dispatch(F.ZP.setLauncherProperty("bounceTurn",B.current)))}),[l.store,l.trackService]),ne=(0,r.useCallback)((function(){1===B.current?(Z.current=setTimeout((function(){ee()}),H.V3[0]),q.current=setTimeout((function(){te()}),H.V3[0]+500),z.current=setTimeout((function(){ee()}),H.V3[0]+H.V3[1]),G.current=setTimeout((function(){te()}),H.V3[0]+H.V3[1]+500)):2===B.current&&(z.current=setTimeout((function(){ee()}),H.V3[1]),G.current=setTimeout((function(){te()}),H.V3[1]+500))}),[te,ee]),re=(0,r.useCallback)}),[]),ae=(0,r.useCallback)((function(){Q(),l.store.dispatch(F.ZP.setLauncherMinimized()),re(),l.store.dispatch(F.ZP.setLauncherProperty("bounceTurn",3)),P.current=!1,T("WACLauncher__ButtonContainer--noAnimation")}),[re,Q,l.store]);L((function(){if(b)setTimeout((function(){l.store.dispatch(F.ZP.setLauncherProperty("desktopLauncherIsExpanded",!0)),K()}));else if(h)P.current=!0;else{if(!f)return J(),function(){Q()};if(f&&3!==g)return ne(),function(){re()}}return null})),(0,r.useEffect)((function(){_.launcher&&P.current&&(K(),R("WACLauncherComplex__Container--simpleAnimation"),P.current=!1)}),[K,_.launcher]),(0,r.useEffect)((function(){(_.mainWindow||_.tour)&&ae()}),[_,ae]),(0,r.useEffect)((function(){S&&(re(),Q(),J(),l.store.dispatch(F.ZP.setLauncherConfigProperty("new_expand_time",!1,k.i7.DESKTOP)))}),[V,U,S,J,Q,re,l.store]);var oe=x(C.desktop.title);(0,r.useEffect)((function(){oe!==C.desktop.title&&(C.desktop.title||oe)&&K()}),[K,C,oe]);var se=(0,r.useCallback)((function(){b||(R("WACLauncherComplex__Container--closeAnimation"),setTimeout((function(){l.trackService.track({eventName:"Launcher interaction",eventDescription:"Desktop launcher minimized."}),T("WACLauncher__ButtonContainer--noAnimation"),l.store.dispatch(F.ZP.setLauncherMinimized()),setTimeout(a)}),400))}),[b,a,l.store,l.trackService]),ie=(0,r.useCallback)((function(){b||(l.trackService.track({eventName:"Widget Opened",eventDescription:"User has opened the widget.",launcherType:k.i7.DESKTOP}),ae(),n())}),[b,n,l.trackService,ae]);return h?r.createElement($,{serviceManager:l,languagePack:u,intl:d,launcherComplexRef:M,launcherRef:t,launcherConfig:C,onOpen:ie,onMinimize:se,unreadAgentCount:y,showUnreadIndicator:v,desktopLauncherIsExpanded:h,isToolingPreview:b,launcherHidden:s,activeTour:i,className:I}):r.createElement(j,{serviceManager:l,languagePack:u,intl:d,ref:t,onToggleOpen:ie,unreadAgentCount:y,showUnreadIndicator:v,className:W,launcherHidden:s,activeTour:i})};function J(e,t,n,r){if(e)if(e.classList.add(t),"number"==typeof n)setTimeout}),n);else{var a=function a(o){n&&o.animationName!==n||(e.removeEventListener("animationend",a),e.removeEventListener("animationcancel",a),e.classList.remove(t),r&&r())};e.addEventListener("animationend",a),e.addEventListener("animationcancel",a)}}function Q(){return(0,r.useContext)(u)}function ee(e,t){var n=e.unreadAgentCount,a=e.showUnreadIndicator,s=e.serviceManager,i=e.launcherConfig,l=e.disableReduce,u=e.isExtended,d=e.playExtendAnimation,m=e.isToolingPreview,p=e.onToggleOpen,f=e.onSwipeRight,h=e.onReduceEnd,g=e.className,v=e.launcherHidden,_=e.activeTour,C=Q(),E=D(),A=(0,c.Z)(),y=(0,o.v9)((function(e){return e.launcherAvatarURL})),b=(0,r.useState)(d),N=b[0],W=b[1],T=(0,r.useState)(!1),w=T[0],I=T[1],R=x(u),M=(0,r.useRef)(),O=(0,r.useRef)(),k=(0,r.useRef)(),B=(0,r.useRef)(),L=(0,r.useRef)({touchStartX:null,touchStartY:null}),F=!u&&R,H=u&&N,Z=u&&!N,G=i.mobile.title||E.launcher_mobileGreeting,j=z(E,v,_);0!==n&&(j+=". ".concat(A.formatMessage({id:"icon_ariaUnreadMessages"},{count:n})));var K=r.createElement(U.yvE,{className:"WACLauncher__svg"});return y&&(K=r.createElement("img",{className:"WACLauncher__Avatar",src:y,"aria-hidden":!0})),(0,r.useImperativeHandle)(t,(function(){return{requestFocu},launcherContainerElement:function(){return O.current}}})),(0,r.useEffect)((function(){!function(e,t,n){var r=function(){var e=P.q$?32:64,t=window.screen,n=t.width,r=t.height,a=Math.min(r,n)-e;return Math.min(a,400)}()-68+12;e.style.setProperty("width","".concat(r,"px")),t.style.setProperty("width","".concat(r-12,"px")),t.style.setProperty("display","flex");var a=t.querySelector(".WACLauncherExtended__GreetingText").clientWidth+68+1;a>400&&(a=400),t.removeAttribute("style"),e.removeAttribute("style"),n.style.setProperty("--WatsonAssistantChat--LAUNCHER-EXTENDED-width","".concat(a,"px"))}(B.current,k.current,O.current)}),[C,Z,G]),(0,r.useEffect)((function(){if(u){if(N?te({fadeInElement:k.current,fadeInTime:300},(function(){W(!1)})):I(!0),!l){var e=M.current,t=function(e){!function(e,t,n){var r=t.touchStartX,a=t.touchStartY;if(null!==r&&null!==a){var o=e.clientX-r,s=e.clientY-a;Math.abs(o)>Math.abs(s)&&o>0&&n(),t.touchStartX=null,t.touchStartY=null}}(e.touches[0],L.current,f)},n=function(e){var n=e.touches[0],r=n.clientX,a=n.clientY,o=L.current;o.touchStartX=r,o.touchStartY=a,M.current.addEventListener("touchmove",t)};return e.addEventListener("touchstart",n),function(){e.removeEventListener("touchmove",t),e.removeEventListener("touchstart",n)}}}else F&&(O.current.addEventListener("animationend",(function e(){h(),W(!0),O.current.removeEventListener("animationend",e)})),te({fadeOutElement:k.current}));return null}),[N,C,l,u,G,h,f,F]),r.createElement("div",{className:q()("WACLauncher__ButtonContainer WACLauncher__ButtonContainer--round WACLauncherExtended__Container",g,{"WACLauncher__ButtonContainer--hidden":v,"WACLauncherExtended__Button--extended":Z,"WACLauncherExtended__Button--extendedAnimation":H,"WACLauncherExtended__Button--reducedAnimation":F,"WACLauncher__ButtonContainer--toolingPreview":m}),ref:O,"aria-hidden":m},r.createElement("button",{"aria-label":j,className:q()("WACLauncher__Button","WAC__button--primary","WACLauncherExtended__Button",{"WACLauncher__TourButton WAC__button--ghost":_}),type:"button",ref:M,onClick:p,tabIndex:m?-1:void 0},r.createElement("div",{className:"WACLauncherExtended__WrapperContainer"},r.createElement("div",{className:"WACLauncherExtended__Wrapper"},r.createElement("div",{className:"WACLauncherExtended__TextHolder",ref:B},r.createElement("div",{className:q()("WACLauncherExtended__Greeting",{"WACLauncherExtended__Element--hidden":!w}),ref:k},r.createElement("div",{className:"WACLauncherExtended__GreetingText","aria-hidden":!u},G))),r.createElement("div",{className:"WACLauncher__IconHolder",id:"WACLauncher__Button".concat(s.namespace.suffix)},_?r.createElement(V.Te2,{className:"WACLauncher__svg"}):K))),(0!==n||a)&&r.createElement("div",{className:"WAC__countIndicator"},0!==n?n:"")))}function te(e,t){var n=e.fadeOutElement,r=e.fadeInElement,a=e.fadeInTime,o=void 0===a?600:a;n&&(n.classList.remove("WACLauncherExtended__Element--hidden"),J(n,"WACLauncherExtended__Element--FadeOut",500,(function(){n.classList.add("WACLauncherExtended__Element--hidden"),n.classList.remove("WACLauncherExtended__Element--FadeOut"),!r&&t&&t()}))),r&&setTimeout((function(){r.classList.remove("WACLauncherExtended__Element--hidden"),J(r,"WACLauncherExtended__Element--FadeIn",600}))}),o)}var ne=r.memo((0,r.forwardRef)(ee));function re(e){var t=e.launcherRef,n=e.onToggleOpen,a=e.launcherHidden,s=e.activeTour,i=m(),l=(0,o.v9)((function(e){return e.launcher})).config,c=(0,o.v9)((function(e){return e.agentState.numUnreadMessages})),u=(0,o.v9)((function(e){return e.persistedToBrowserStorage.launcherState})),d=u.mobileLauncherIsExtended,p=u.mobileLauncherWasReduced,f=u.mobileLauncherDisableBounce,h=u.bounceTurn,g=u.showUnreadIndicator,v=u.viewState,_=(0,o.v9)})),C=(0,r.useState)(!1),E=C[0],A=C[1],S=x(d),y=x(p),b=(0,r.useRef)(h).current,N=(0,r.useRef)(p).current,W=(0,r.useRef)(null),T=(0,r.useRef)(null),w=(0,r.useRef)(null),I=(0,r.useRef)(N&&!f),R=l.mobile,M=R.time_to_expand,O=R.new_expand_time,P=R.time_to_reduce,B=_===k.Dp.MOBILE,D=!B&&void 0===S&&!d,U=void 0!==S&&!S&&d,V=B||U||void 0!==y&&!y&&p||E,Z=(0,r.useCallback)((function(){p||i.store.dispatch(F.ZP.setLauncherProperty("mobileLauncherWasReduced",!0))}),[p,i]),z=(0,r.useCallback)((function(e){var t,n;t=W.current,(n=T.current)&&(clearTimeout(n),T.current=null),t&&(clearTimeout(t),W.current=null),d&&(document.removeEventListener("scroll",z),"scroll"===(null==e?void 0:e.type)&&i.trackService.track({eventName:"Launcher interaction",eventDescription:"Mobile launcher closed from scrolling."}),i.store.dispatch(F.ZP.setLauncherProperty("mobileLauncherIsExtended",!1)))}),[d,i]),G=(0,r.useCallback)((function(){W.current=setTimeout((function(){d||U||(i.store.dispatch(F.ZP.setLauncherProperty("mobileLauncherWasReduced",!1)),i.store.dispatch(F.ZP.setLauncherProperty("mobileLauncherIsExtended",!0)),i.trackService.track({eventName:"Launcher interaction",eventDescription:"Mobile launcher opened from animation."}))}),M)}),[d,U,i.store,i.trackService,M]),j=(0,r.useCallback)((function(){var e=w.current;e&&(e(),w.current=null),i.store.dispatch(F.ZP.setLauncherProperty("mobileLauncherDisableBounce",!0)),z(),Z()}),[z,i.store,Z]);L((function(){var e;if(!p&&D)G();else if(I.current){var n=null===(e=null==t?void 0:t.current)||void 0===e?void 0:e.launcherContainerElement();n&&n.addEventListener("animationend",(function e(){if(I.current){var t=b;n.removeEventListener("animationend",e),A(!0),w.current=function(e,t,n,r){var a=r.beforeAll,o=r.afterAll,s=r.beforeEach,i=r.afterEach,l=r.startingIndex||0,c=!1,u=null;function d(){a&&0===l&&a();var e=l===n.length;e||c?e&&o&&o():u=setTimeout(p,n[l])}function m(){i&&i(),l++,e.removeEventListener("animationend",m),e.classList.remove(t),d()}function p(){s&&s(),e.addEventListener("animationend",m),e.classList.add(t)}return d(),function(){c=!0,clearTimeout(u),e.classList.remove(t),e.removeEventListener("animationend",m)}}(n,"WACLauncher__ButtonContainer--bounceAnimation",H.V3,{startingIndex:b-1,afterEach:function(){i.trackService.track({eventName:"Launcher interaction",eventDescription:"Mobile launcher finished bounce animation ".concat(t,".")}),t++,i.store.dispatch(F.ZP.setLauncherProperty("bounceTurn",t))},afterAll:function(){i.store.dispatch(F.ZP.setLauncherProperty("mobileLauncherDisableBounce",!0))}})}}))}})),(0,r.useEffect)((function(){(v.mainWindow||v.tour)&&j()}),[v,j]),(0,r.useEffect)((function(){if(O){I.current&&(I.current=!1);var e=w.current;e&&(e(),w.current=null),W.current&&clearTimeout(W.current),G(),i.store.dispatch(F.ZP.setLauncherConfigProperty("new_expand_time",!1,k.i7.MOBILE))}}),[G,O,i.store,I]);var K=(0,r.useCallback)((function(){B||(j(),i.actions.track({eventName:"Widget Opened",eventDescription:"User has opened the widget.",launcherType:k.i7.MOBILE}),n())}),[B,n,i.actions,j]),Y=(0,r.useCallback)((function(){B||(i.trackService.track({eventName:"Launcher interaction",eventDescription:"Mobile launcher closed from swiping."}),z())}),[B,z,i]);return(0,r.useEffect)((function(){d&&(T.current=setTimeout}),P),document.addEventListener("scroll",z))}),[d,z,P,i]),r.createElement(ne,{className:q()({"WACLauncher__ButtonContainer--noAnimation":V}),ref:t,serviceManager:i,launcherConfig:l,showUnreadIndicator:g,unreadAgentCount:c,disableReduce:B,isExtended:d||B,playExtendAnimation:D,onToggleOpen:K,onSwipeRight:Y,onReduceEnd:Z,isToolingPreview:B,launcherHidden:a,activeTour:s})}function ae(){var e,t,n,a,s=m(),i=(0,r.useRef)(),l=(0,o.v9)((function(e){return e.config.public})),c=(0,o.v9)((function(e){return e.config.public.__ibm__.renderExtendedLauncher})),u=(0,o.v9)((function(e){return e.persistedToBrowserStorage.launcherState.viewState})),d=(0,o.v9)((function(e){return e.initialViewChangeComplete})),p=!u.launcher,f=(0,o.v9)((function(e){return e.persistedToBrowserStorage.launcherState.activeTour})),h=(0,r.useCallback)}),[i]),g=(0,r.useCallback)((function(){return f?(s.trackService.track({eventName:"Tour interaction",eventDescription:"Tour continued.",type:"From launcher."}),s.actions.changeView(M.bW.TOUR,{viewChangeReason:O.LO.LAUNCHER_CLICKED})):s.actions.changeView(M.bW.MAIN_WINDOW,{mainWindowOpenReason:O.lJ.DEFAULT_LAUNCHER})}),[f,s.actions,s.trackService]);return t=function(){var e;u.launcher&&!u.mainWindow&&!u.tour&&d&&(null===(e=i.current)||void 0===e||e.requestFocus())},n=[u],a=(0,r.useRef)(!1),(0,r.useEffect)((function(){if(a.current)return t();a.current=!0}),n),P.vy||c||(null===(e=l.__ibm__)||void 0===e?void 0:e.launcherToolingPreview)===k.Dp.MOBILE?r.createElement(re,{launcherRef:i,onToggleOpen:g,launcherHidden:p,activeTour:f}):r.createElement(X,{launcherRef:i,onDoToggle:g,requestFocus:h,launcherHidden:p,activeTour:f})}var oe=n(67819),se=n.n(oe),ie=n(13249),le=n.n(ie),ce=n(97841),ue=n.n(ce),de=n(4539),me=n.n(de),pe=n(40124),fe=n(22750),he=n(11520),ge=n(44674),ve=n(44455),_e=function(){return _e=i()||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},_e.apply(this,arguments)};function Ce(e){return r.forwardRef((function(t,n){var a=(0,r.useContext)(u);return r.createElement(e,_e({},t,{ref:n,ariaAnnouncer:a}))}))}var Ee=function(){var e=function(t,n){return e=h()||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ae=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isMounted:!1},t.onceAnnounced=!1,t}return Ee(t,e),t.prototype.componentDidMount=function(){var e=this;this.setState({isMounted:!0}),this.onceAnnounced||(this.props.announceOnce&&setTimeout})),this.onceAnnounced=!0)},t.prototype.render=function(){return r.createElement("div",{"aria-live":"polite"},this.state.isMounted&&this.props.children)},t}(r.PureComponent),Se=Ce(Ae),ye=n(92070),be=n.n(ye),Ne=n(92546),We=n.n(Ne),Te=r.createContext(!1),we=function(){return we=i()||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},we.apply(this,arguments)};function Ie(e){var t=e.hidden,n=e.children,a=e.className,o=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&be()(t).call(t,r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof We()){var a=0;for(r=We()(e);a<r.length;a++)be()(t).call(t,r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}(e,["hidden","children","className"]);return r.createElement(Te.Provider,{value:t},r.createElement("div",we({className:q()(a,{WAC__hidden:t})},o),n))}var Re=function(){var e=function(t,n){return e=h()||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Me=function(e}return Re(t,e),t.prototype.componentDidMoun},t.prototype.componentWillUnmoun},t.prototype.rende},t.defaultProps={delay:500},t}(r.PureComponent),Oe=n(63761);function ke(e){var t=e.hideMinimizeButton,n=e.onMinimizeClick,a=e.onCloseClick,o=D(),s=o.tour_ariaMinimizeButton,i=o.tour_ariaCloseButton;return r.createElement("div",{className:"WACTour__CloseMinimizeWrapper"},!t&&r.createElement(r.Fragment,null,r.createElement(ge.Z,{className:"WACTour__CloseMinimizeButton WACTour__MinimizeButton",kind:"ghost",hasIconOnly:!0,renderIcon:Oe.eOF,iconDescription:s,onClick:n,"aria-label":s}),r.createElement("div",{className:"WACTour__CloseMinimizeDivider"})),r.createElement(ge.Z,{className:"WACTour__CloseMinimizeButton WACTour__CloseButton",kind:"ghost",hasIconOnly:!0,renderIcon:K.PcV,iconDescription:i,onClick:a,"aria-label":i}))}function Pe(e,t){var n=e.reservePreviousButtonSpace,a=e.hidePreviousButton,o=e.renderDoneButton,s=e.disableNextButton,i=e.hideButtons,l=e.hideChatButton,c=e.onOpenMainWindowClick,u=e.onNextClick,d=e.onPreviousClick,m=e.onDoneClick,p=D(),f=p.tour_ariaChatButton,h=p.tour_ariaNextButton,g=p.tour_ariaPreviousButton,v=p.tour_doneButton,_=(0,r.useRef)(),C=(0,r.useRef)();return(0,r.useImperativeHandle)(t,(function(){return{requestFocus:function(){setTimeout((function(){C.current?(0,S.OP)(C):(0,S.OP)(_)}))}}})),r.createElement("div",{className:q()("WACTour__Controls",{"WACTour__Controls--empty":i})},!l&&r.createElement(ge.Z,{className:"WACTour__ControlsButton WACTour__MainWindowButton",kind:"ghost",size:"md",hasIconOnly:!0,renderIcon:U.Ufg,iconDescription:f,onClick:c,"aria-label":f}),n&&r.createElement(ge.Z,{className:q()("WACTour__ControlsButton WACTour__PreviousButton",{"WACTour__ControlsButton--hidden":a}),kind:"ghost",size:"md",hasIconOnly:!0,renderIcon:V.fwy,iconDescription:g,onClick:d,"aria-label":g}),o&&r.createElement(ge.Z,{ref:C,className:"WACTour__ControlsButton WACTour__DoneButton",size:"md",onClick:m},v),!o&&r.createElement(ge.Z,{ref:_,className:"WACTour__ControlsButton WACTour__NextButton",size:"md",hasIconOnly:!0,renderIcon:V.usA,iconDescription:h,onClick:u,disabled:s,"aria-label":h}))}var Be=r.forwardRef(Pe),De=n(16435),Le=n(25345);function xe(e){return r.createElement(pe.ycZ,{className:q()("WACErrorIcon",e.className)})}function Fe(e){var t=e.text;return r.createElement("div",{className:"WAC__inlineError"},r.createElement("div",{className:"WAC__inlineError--iconHolder"},r.createElement(xe,{className:"WAC__inlineError--icon"})),r.createElement("div",{className:"WAC__inlineError--text"},t))}var He=Fe,Ue=n(30390),Ve=n(10673),Ze=n(68877);function qe(e){var t=e.title,n=e.description,a=e.iconURL,o=e.defaultIcon,s=e.displayURL,i=e.urlHostName,l=e.contentLaunchIcon,c=e.hideIconAndTitle;return r.createElement(Ze.n9,{className:"WACTextHolderTile"},!c&&r.createElement("div",{className:"WACTextHolderTile__Icon"},a?r.createElement("img",{src:a,alt:"","aria-hidden":!0}):o),r.createElement("div",{className:"WACTextHolderTile__Wrapper WACWidget__textEllipsis"},!c&&t&&r.createElement("div",{className:"WACTextHolderTile__Title"},t),r.createElement("div",{className:"WACTextHolderTile__DescriptionWrapper"},n&&r.createElement("div",{className:q()("WACTextHolderTile__Description",{WACTextHolderTile__DescriptionMargin:t&&n})},n),l&&r.createElement("div",{className:"WACTextHolderTile__LaunchIcon"},l)),s&&r.createElement(r.Fragment,null,r.createElement(b,null,i),r.createElement("div",{className:q()("WACTextHolderTile__Url","WACWidget__textEllipsis",{WACTextHolderTile__UrlMargin:t||n}),"aria-hidden":!0},s))))}function ze(e){var t=e.imageError,n=e.source,a=e.title,o=e.description,s=e.altText,i=e.displayURL,l=e.hideIconAndTitle,c=e.needsAnnouncement,u=e.renderIcon,d=Q(),m=(0,r.useState)(!1),p=m[0],f=m[1],h=(0,r.useState)(!1),g=h[0],v=h[1],_=(0,r.useRef)(),C=(0,r.useRef)(c),E=Boolean(a||o),A=s||a||o||"";return(0,r.useEffect)((function(){p&&C.current&&d(_.current)}),[d,p]),g?r.createElement(He,{text:t}):r.createElement("div",{ref:_,className:"WACImage"},!p&&r.createElement(r.Fragment,null,r.createElement("div",{className:"WACImage__ImageHolder"},r.createElement(Ve.Z,{className:"WACImage__Skeleton"})),E&&r.createElement(qe,{title:a,description:o,defaultIcon:r.createElement(Ue.e1T,null),hideIconAndTitle:l})),!g&&r.createElement(r.Fragment,null,r.createElement("div",{className:"WACImage__ImageWrapper"},r.createElement("img",{className:q()("WACImage__Image",{"WACImage__Image--loaded":p}),src:n,alt:A,onLoad:function(){return f(!0)},onError:function(){return v(!0)},style:{display:p?"block":"none"}})),E&&p&&r.createElement(qe,{title:a,description:o,defaultIcon:u||r.createElement(Ue.e1T,null),displayURL:i,urlHostName:i&&(0,P.Cs)(i),hideIconAndTitle:l})))}var Ge=n(56678),je=n(30830),Ke=n(66225),Ye=n(89908),$e=n(17408),Xe=r.lazy}));function Je(e){var t=e.type,n=e.source,a=e.title,o=e.description,s=e.iconURL,i=e.ariaLabel,l=e.isMixcloud,c=e.baseHeight,u=e.doAutoScroll,d=e.playing,m=e.onPlay,p=e.onPause,f=e.hideIconAndTitle,h=e.needsAnnouncement,g=(0,r.useState)(!1),v=g[0],_=g[1],C=(0,r.useState)(!1),E=C[0],A=C[1],S=D(),y=S.errors_audioSource,b=S.errors_videoSource,N=Q(),W=(0,r.useRef)(),T=l?"120px":(0,Le.wo)(c),w=t===De.Ty.AUDIO,I=w?y:b,R=x(n),M=(0,r.useRef)(h),O=(0,r.useCallback)((function(){A(!0),_(!0)}),[]);(0,r.useEffect)}),[R,v,n]),(0,r.useEffect)((function(){var e=null;return v||(e=setTimeout(O,$e.Fx)),function(){clearTimeout(e)}}),[v,O]),(0,r.useEffect)}),[N,v]);var k=(0,r.useCallback)((function(){v||(_(!0),null==u||u())}),[u,v]),P=w?r.createElement(je.aqq,null):r.createElement(Ke.SyL,null);return r.createElement(r.Fragment,null,!v&&r.createElement("div",{className:"WACMediaPlayer__Skeleton"},r.createElement("div",{className:"WACMediaPlayer__SkeletonContainer",style:{paddingTop:T}},r.createElement(Ve.Z,{className:"WACMediaPlayer__SkeletonPlayer"})),(a||o)&&r.createElement(Ze.n9,null,r.createElement(Ye.Z,null),r.createElement(Ye.Z,null))),r.createElement("div",{className:"WACMediaPlayer__Root",ref:W},E&&r.createElement(He,{text:I}),!E&&r.createElement("div",{className:q()("WACMediaPlayer",{WAC__hidden:!v})},r.createElement("div",{className:"WACMediaPlayer__Wrapper",style:{paddingTop:T}},r.createElement("div",{className:q()("WACMediaPlayer__Background",{"WACMediaPlayer__Background--audio":w})},w&&r.createElement(je.Seo,{className:"WACMediaPlayer__MusicIcon"})),r.createElement(r.Suspense,{fallback:r.createElement(r.Fragment,null)},r.createElement(Xe,{className:"WACMediaPlayer__Player",url:n,controls:!0,width:"100%",height:"100%",config:{file:{forceVideo:!0,attributes:{controlsList:"nodownload","aria-label":i||o||a}}},playsinline:!0,playing:d,onPlay:m,onPause:p,onReady:k,onError:O,pip:!0}))),(a||o)&&r.createElement(qe,{title:a,description:o,iconURL:s,defaultIcon:P,hideIconAndTitle:f}))))}var Qe=r.memo(Je),et=function(){return et=i()||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},et.apply(this,arguments)};function tt(e){var t=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&be()(t).call(t,r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof We()){var a=0;for(r=We()(e);a<r.length;a++)be()(t).call(t,r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}(e,[]);return r.createElement(Qe,et({type:De.Ty.VIDEO},t))}var nt=r.memo(tt);function rt(e){var t=e.stepGenericItem,n=e.isCurrentStep,a=m(),o=Q(),s=(0,r.useRef)();return(0,r.useEffect)((function(){n&&(a.trackService.track({eventName:"Tour interaction",eventDescription:"Tour step shown.",type:t.response_type}),setTimeout})))}),[n,a.trackService,t.response_type,o]),r.createElement("div",{className:"WACTourStep__Wrapper",ref:s},r.createElement("div",{className:q()("WACTourStep","WAC__message",{"WACTourStep--hidden":!n,WACTourStep__BottomBorder:function(){switch(t.response_type){case De.Ty.TEXT:return!0;case De.Ty.IMAGE:case De.Ty.VIDEO:return null==t?void 0:t.description;default:return!0}}()})},function(){switch(t.response_type){case De.Ty.TEXT:return r.createElement(at,{messageItem:t});case De.Ty.IMAGE:return r.createElement(ot,{messageItem:t});case De.Ty.VIDEO:return r.createElement(st,{messageItem:t,isCurrentStep:n});default:return r.createElement(it,{messageItem:t,isCurrentStep:n})}}()))}function at(e){var t=e.messageItem.text;return r.createElement("div",{className:"WACTourStep__Text"},r.createElement(Ge.H,{text:t}))}function ot(e){var t=e.messageItem,n=t.source,a=t.description,o=t.alt_text,s=D();return r.createElement(ze,{imageError:s.errors_imageSource,source:n,description:a,altText:o,hideIconAndTitle:!0})}function st(e){var t,n,a=e.messageItem,s=e.isCurrentStep,i=a.source,l=a.description,c=a.alt_text,u=a.channel_options,d=(0,o.v9)((function(e){return e.persistedToBrowserStorage.launcherState})).viewState,m=(0,r.useState)(!1),p=m[0],f=m[1];return(0,r.useEffect)((function(){s&&d.tour||f(!1)}),[s,d.tour]),r.createElement(nt,{source:i,description:l,baseHeight:null===(n=null===(t=null==u?void 0:u.chat)||void 0===t?void 0:t.dimensions)||void 0===n?void 0:n.base_height,ariaLabel:c,playing:p,onPlay:function(){return f(!0)},onPause:function(){return f(!1)},hideIconAndTitle:!0})}function it(e){var t=e.messageItem,n=e.isCurrentStep,a=D();return(0,r.useEffect)((function(){n&&(0,Le.N6)('The response type you tried to use "'.concat(t.response_type,'" is not valid within a tour step. The supported response types in tour steps are text, video, and image.'))}),[n,t.response_type]),r.createElement("div",{className:"WACTourStep__UnsupportedResponse"},r.createElement(He,{text:a.errors_generalContent}))}var lt=r.memo(rt);function ct(){return r.createElement("div",{className:"WACTourStep WACTourStep__Skeleton"},r.createElement(Ve.Z,{className:"WACTourStep__SkeletonPlaceholder"}))}var ut=function(e,t,n,r){return new(n||(n=se()))((function(a,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function i(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,i)}l((r=r.apply(e,t||[])).next())}))},dt=function(e,t){var n,r,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof le()&&(o[ue()]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((a=(a=s.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1],a=o;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(o);break}a[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}};function mt(e,t){var n=D(),a=m(),s=Q(),i=(0,c.Z)(),l=(0,o.v9)((function(e){return e.config.public.tourConfig})),u=(0,o.v9)((function(e){return e})).isHydrated,d=(0,o.v9)((function(e){return e.persistedToBrowserStorage.launcherState})).viewState,p=(0,o.v9)((function(e){return e.persistedToBrowserStorage.chatState.persistedTourState})).activeTourCurrentStepIndex,f=(0,o.v9)((function(e){return e.tourState})).activeTourStepItems,h=(0,r.useState)(!1),g=h[0],v=(h[1],(0,r.useState)(!1)),_=v[0],C=v[1],E=(0,r.useState)(!1),A=E[0],S=(E[1],(0,r.useRef)()),y=(0,r.useRef)(),b=a.namespace.originalName,N=b?"window_ariaTourRegionNamespace":"window_ariaTourRegion",W=(0,ve.wv)(i,N,{namespace:b}),T=!d.tour,w=!0,I=!1,R=!1,k=[];return u&&f?(w=f.length>1,I=p<=0,R=p>=f.length-1,k=me()(f).call(f,(function(e,t){return r.createElement(lt,{key:t,stepGenericItem:e,isCurrentStep:t===p})}))):u||(k=[r.createElement(ct,{key:0})]),(0,r.useImperativeHandle)(t,(function(){return y.current})),(0,r.useEffect)((function(){if(u&&!T&&!A){var e=i.formatMessage({id:"tour_instructions"},{chatButtonText:n.tour_ariaChatButton});s(e)}}),[T,s,n,i,u,A]),(0,r.useEffect)((function(){var e;!u&&T||null===(e=y.current)||void 0===e||e.requestFocus()}),[T,u]),r.createElement(Ie,{hidden:T},r.createElement("div",{ref:S,className:"WACTour",role:"region","aria-label":W},r.createElement(ke,{hideMinimizeButton:null==l?void 0:l.hideMinimizeButton,onCloseClick:function(){return ut(this,void 0,void 0,(function(){return dt(this,(function(e){switch(e.label){case 0:return[4,a.actions.endTour({viewChangeReason:O.LO.TOUR_CLOSED})];case 1:return e.sent(),a.trackService.track({eventName:"Tour interaction",eventDescription:"Tour closed."}),[2]}}))}))},onMinimizeClick:function(){return ut(this,void 0,void 0,(function(){return dt(this,(function(e){switch(e.label){case 0:return[4,a.actions.changeView(M.bW.LAUNCHER,{viewChangeReason:O.LO.TOUR_MINIMIZED})];case 1:return e.sent(),a.trackService.track({eventName:"Tour interaction",eventDescription:"Tour minimized."}),[2]}}))}))}}),A&&r.createElement(Se,null,r.createElement("div",{className:"WACTour__ErrorScreen"},r.createElement("div",{className:"WACTour__ErrorHeader"},r.createElement(pe.Y4s,{className:"WACTour__ErrorIcon"}),n.tour_errorTitle),r.createElement("div",{className:"WACTour__ErrorBody"},r.createElement("div",{className:"WACTour__ErrorText"},n.tour_errorBody),r.createElement(ge.Z,{className:"WACTour__ErrorButton",size:"sm",kind:"tertiary",renderIcon:fe.uzE},n.buttons_retry)))),!A&&r.createElement(r.Fragment,null,k,r.createElement("div",{className:"WACTour__StatusContainer"},_&&r.createElement(Se,null,r.createElement(he.K0,{kind:"error",title:n.tour_errorFetchingStep,lowContrast:!0,hideCloseButton:!0,onClick:function(){return C(!1)}})),g&&r.createElement(Me,{delay:500},r.createElement("div",{className:"WACLoadingBar__ConnectingAnimation"}))),r.createElement(Be,{ref:y,hideChatButton:null==l?void 0:l.hideChatButton,reservePreviousButtonSpace:w,hidePreviousButton:I,disableNextButton:g,hideButtons:!u,renderDoneButton:R,onNextClick:function(){var e;a.actions.changeStepInTour({nextStep:!0}),p+1===f.length-1&&(null===(e=y.current)||void 0===e||e.requestFocus())},onPreviousClick:function(){var e;a.actions.changeStepInTour({previousStep:!0}),p-1==0&&(null===(e=y.current)||void 0===e||e.requestFocus())},onOpenMainWindowClick:function(){return ut(this,void 0,void 0,(function(){return dt(this,(function(e){switch(e.label){case 0:return[4,a.actions.changeView(M.bW.MAIN_WINDOW,{mainWindowOpenReason:O.lJ.TOUR_OPENED_OTHER_VIEW})];case 1:return e.sent(),a.trackService.track({eventName:"Tour interaction",eventDescription:"Tour opened main window."}),[2]}}))}))},onDoneClick:function(){return ut(this,void 0,void 0,(function(){return dt(this,(function(e){switch(e.label){case 0:return[4,a.eventBus.fire({type:O.re.TOUR_END,reason:O.e_.DONE_CLICKED},a.instance)];case 1:return e.sent(),[4,a.actions.endTour({viewChangeReason:O.LO.TOUR_DONE})];case 2:return e.sent(),a.trackService.track({eventName:"Tour interaction",eventDescription:"Tour completed."}),[2]}}))}))}}))))}var pt=r.memo(r.forwardRef(mt)),ft=r.createContext(null),ht=n(34e3),gt=n.n(ht),vt=n(38256),_t=n.n(vt),Ct=n(32915),Et=n.n(Ct),At=n(36323),St=n(18229);function yt(){var e=m(),t=D(),n=t.branding_headline,a=t.branding_ariaInformationButton;return r.createElement("div",{className:"WACBrandingBanner"},r.createElement("div",{className:"WACBrandingBanner__text"},r.createElement(St.p,{html:n}),r.createElement("button",{className:"WAC__button--base WAC__button--ghost",type:"button",onClick:function(){e.store.dispatch(F.ZP.setBrandingBannerShown(!1)),e.store.dispatch(F.ZP.setBrandingOverlayIsOpen(!0)),e.actions.track({eventName:"Branding overlay opened"})},"aria-label":a},r.createElement(Ue.RdX,{className:"WACBrandingBanner__icon"}))))}var bt=r.memo(yt);function Nt(e){var t=e.className;return r.createElement("svg",{className:q()("WACWatsonLogo",t),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32","aria-label":"IBM Watson",role:"img"},r.createElement("path",{d:"M21.74,9.49h0A11.41,11.41,0,0,0,16,8h0a.76.76,0,1,0,0,1.51,10.15,10.15,0,0,1,1.91.21c-2.26,1.08-4.76,3.58-6.73,7a22.48,22.48,0,0,0-2,4.44A9.58,9.58,0,0,1,7,17.22a3.43,3.43,0,0,1,.28-2.66v0h0c.79-1.37,2.44-2.15,4.63-2.2a.76.76,0,0,0,.74-.78.75.75,0,0,0-.78-.74C9.19,10.88,7.1,11.92,6,13.74H6v0s0,0,0,0a4.84,4.84,0,0,0-.44,3.79,12,12,0,0,0,3.2,5.22A11.36,11.36,0,0,0,8.52,26a10,10,0,0,1-2-3.48A.75.75,0,0,0,5.57,22a.76.76,0,0,0-.49,1,11.45,11.45,0,0,0,5.18,6.38h0A11.42,11.42,0,0,0,16,30.92a11.74,11.74,0,0,0,3-.39,11.48,11.48,0,0,0,2.77-21ZM18.58,29.06a9.9,9.9,0,0,1-7.56-1h0c-.86-.49-1.21-2-.94-4a18.85,18.85,0,0,0,2.48,1.72,13.92,13.92,0,0,0,6.93,2,11,11,0,0,0,2.42-.28A9.78,9.78,0,0,1,18.58,29.06Zm6.06-4.66c-2,2-6.66,2.74-11.32.05a17.36,17.36,0,0,1-2.89-2.12,21.08,21.08,0,0,1,2.08-4.91c2.94-5.08,6.83-7.57,8.47-6.62h0A10,10,0,0,1,24.64,24.4Z"}),r.createElement("path",{d:"M4.16,11.72,1.14,10a.76.76,0,1,0-.76,1.31L3.4,13a.86.86,0,0,0,.38.1.77.77,0,0,0,.66-.38A.76.76,0,0,0,4.16,11.72Z"}),r.createElement("path",{d:"M8.29,7.59A.74.74,0,0,0,8.94,8a.75.75,0,0,0,.38-.1.76.76,0,0,0,.28-1l-1.74-3a.76.76,0,0,0-1-.27.75.75,0,0,0-.28,1Z"}),r.createElement("path",{d:"M16,6.08a.76.76,0,0,0,.76-.76V1.83a.76.76,0,0,0-1.52,0V5.32A.76.76,0,0,0,16,6.08Z"}),r.createElement("path",{d:"M22.68,7.87a.75.75,0,0,0,1-.28l1.75-3a.75.75,0,0,0-.28-1,.76.76,0,0,0-1,.27l-1.74,3A.76.76,0,0,0,22.68,7.87Z"}),r.createElement("path",{d:"M31.9,10.25a.76.76,0,0,0-1-.27l-3,1.74a.76.76,0,0,0-.28,1,.77.77,0,0,0,.66.38.86.86,0,0,0,.38-.1l3-1.75A.76.76,0,0,0,31.9,10.25Z"}),r.createElement("rect",null))}function Wt(e){var t=e.brandingCloseButtonRef,n=D(),a=n.branding_headline,s=n.branding_description,i=n.branding_sign_up,l=n.general_ariaAnnounceClosedInformationOverlay,c=n.general_ariaAnnounceEscapeOverlay,d=m(),p=(0,o.v9)((function(e){return e.brandingState})),f=(0,r.useContext)(u),h=(0,r.useRef)(),g=(0,r.useRef)(),v=p.isOpen,_="https://www.ibm.com/cloud/watson-assistant/?utm_medium=webchat&utm_source=".concat(window.location.hostname),};return(0,r.useEffect)((function(){v&&(f(g.current),f(c))}),[f,c,v]),r.createElement("div",{className:"WACBrandingOverlay",ref:h,onKeyDow}},r.createElement("div",{className:"WACBrandingOverlay__header"},v&&r.createElement("button",{className:"WAC__button--base WAC__button--ghost",onClick:C,type:"button","aria-label":l,ref:t},r.createElement(K.PcV,null))),r.createElement("div",{className:"WACBrandingOverlay__body"},r.createElement("div",{className:"WACBrandingOverlay__main-content"},r.createElement("div",{className:"WACBrandingOverlay__logoContainer"},r.createElement(Nt,null)),r.createElement("div",{className:"WACBrandingOverlay__textHolder",ref:g},r.createElement(St.p,{html:a}),r.createElement("div",{className:"WACBrandingOverlay__headline"}),r.createElement("div",{className:"WACBrandingOverlay__text"},s," ",r.createElement("a",{href:_,rel:"noreferrer noopener",target:"_blank"},i))))))}var Tt=r.memo(Wt),wt=n(72177),It=n.n(wt),Rt=n(65473);function Mt(e){var t=e.element,n=e.id,a=e.className,o=(0,r.useRef)();return(0,r.useEffect)((function(){var e=o.current;return t&&e.appendChild(t),function(){e&&t&&e.contains(t)&&e.removeChild(t)}}),[t]),t&&r.createElement("div",{ref:o,className:a,id:n})}var Ot=r.memo(Mt),kt=n(26264),Pt=n(58684),Bt=n(4030),Dt=n(42713),Lt=n(14158),xt=r.createContext(null),Ft=function(){var e=function(t,n){return e=h()||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ht=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={attachedToHost:null},t.modalElement=document.createElement("div"),t}return Ft(t,e),t.prototype.componentDidMount=function(){this.attachIfNeeded()},t.prototype.componentDidUpdat},t.prototype.componentWillUnmoun},t.prototype.attachIfNeeded=function(){var e=this.context;e&&!this.state.attachedToHost&&(this.setState({attachedToHost:e}),e.appendChild(this.modalElement))},t.prototype.render=function(){return this.state.attachedToHost?a.createPortal(this.props.children,this.modalElement):null},t.contextType=xt,t}(r.Component);function Ut(e){var t=(0,r.useContext)(u);return(0,r.useEffect)((function(){t(e.message)}),[t,e.message]),r.createElement("div",null)}var Vt=r.memo(Ut),Zt=function(){var e=function(t,n){return e=h()||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),qt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onYesClick=function(){t.props.onConfirm()},t.onNoClick=function(){t.props.onCancel()},t.onKeyDow},t}return Zt(t,e),t.prototype.render=function(){var e=this.props,t=e.title,n=e.message,a=e.cancelButtonLabel,o=e.confirmButtonLabel,s=e.modalAnnounceMessage,i=e.serviceManager;return r.createElement(Ht,null,r.createElement(Et(),null,r.createElement("div",{className:"WACConfirmModal",role:"dialog","aria-labelledby":"WACConfirmModal__title","aria-describedby":"WACConfirmModal__message"},r.createElement("div",{className:"WACConfirmModal__container"},r.createElement(Vt,{message:s}),r.createElement("div",{className:"WACConfirmModal__title",id:"WACConfirmModal__title".concat(i.namespace.suffix)},t),r.createElement("div",{className:"WACConfirmModal__message",id:"WACConfirmModal__message".concat(i.namespace.suffix)},n),r.createElement("div",{className:"WACConfirmModal__buttonContainer"},r.createElement(ge.Z,{className:"WACConfirmModal__NoButton",kind:"secondary",onClick:this.onNoClick,onKeyDown:this.onKeyDown,size:"md"},a),r.createElement(ge.Z,{className:"WACConfirmModal__YesButton",onClick:this.onYesClick,onKeyDown:this.onKeyDown,size:"md"},o))))))},t}(r.Component),zt="WACAutoFontSize--";function Gt(e,t){var n=e.text,a=e.sizeBreakpoint,o=(0,r.useRef)(),s=(0,r.useState)("".concat(zt,"0")),i=s[0],l=s[1],c=(0,r.useContext)(Te),u=(0,r.useCallback)((function(){o.current.classList.remove(i),o.current.classList.add("".concat(zt,"0"));var e,t=o.current.offsetHeight;o.current.classList.remove("".concat(zt,"0")),o.current.classList.add(i),e="".concat(zt,t>a?"1":"0"),i!==e&&l(e)}),[i,a]);return(0,r.useImperativeHandle)(t})),(0,r.useLayoutEffect)}),[u,c,n]),r.createElement("div",{ref:o,className:i},n)}var jt=r.memo((0,r.forwardRef)(Gt));function Kt(e,t){var n=e.displayName,a=e.backContent,s=e.showRestartButton,i=e.showBackButton,l=e.renderAvatar,c=e.labelBackButton,u=e.onClickClose,d=e.onClickRestart,p=e.onCloseAndRestart,f=e.onClickBack,h=e.overflowItems,g=e.overflowClicked,v=e.backButtonType,_=e.showCenter,C=e.hideCloseButton,E=e.hideCloseAndRestartButton,A=(0,r.useRef)(),y=(0,r.useRef)(),b=(0,r.useRef)(),N=(0,r.useRef)(),W=(0,r.useRef)(),T=(0,r.useRef)(),w=m(),I=D(),R=(0,o.v9)((function(e){return e.config.public})),M=(0,r.useState)(!1),O=M[0],k=M[1],P=(0,r.useState)(!1),B=P[0],x=P[1],H=(0,r.useCallback)((function(){x(!1)}),[]),U=R.showCloseAndRestartButton&&!E&&p,V=R.__ibm__.useCloseIcon,Z=R.hideCloseButton||C;if(U&&s)throw new Error("You cannot enable both the restart button and the close-and-restart buttons.");var z=(0,r.useCallback)}),[p]);L((function(){var e=W.current;if(e){var t=new Lt.Z((function(){T.current.calculateSize()}));return t.observe(e),function(){t.unobserve(e)}}return null})),(0,r.useImperativeHandle)(t,(function(){return{requestFocus:function(){return N.current?((0,S.OP)(N,!1,!0),!0):A.current?((0,S.OP)(A,!1,!0),!0):!!y.current&&((0,S.OP)(y,!1,!0),!0)}}}));var G,j=!C&&(s||U);return Boolean(null==h?void 0:h.length)?G=r.createElement(Bt.Z,{renderIcon:O?K.QN4:kt.DIo,ariaLabel:I.components_overflow_ariaLabel,size:"lg",flipped:"rtl"===R.direction,onOpen:function(){setTimeout((function(){k(!0)})),w.store.dispatch(F.ZP.changeState({showNonHeaderBackgroundCover:!0}))},onClose:function(){w.store.dispatch(F.ZP.changeState({showNonHeaderBackgroundCover:!1})),k(!1)},className:O?void 0:"WACHeader__Button WAC__button--base WAC__button--ghost"},me()(h).call(h,(function(e,t){return r.createElement(Dt.Z,{key:e,itemText:e,onClick:function(){return g(t)}})}))):i&&(G=r.createElement(Yt,{className:"WACHeader__BackButton",label:c,onClick:f,buttonRef:A,buttonType:v||"ghost"},a||r.createElement(Pt.UZ_,{className:"WACIcon__Logout--reverse"}))),r.createElement("div",{className:q()("WACHeader",{"WACHeader--hasTwoButtons":j}),"data-floating-menu-container":!0},r.createElement("div",{className:"WACHeader__Buttons WACHeader__LeftButtons"},G),_&&r.createElement("div",{ref:W,className:"WACHeader__CenterContainer"},r.createElement("div",{className:"WACHeader__AvatarImageContainer"},l&&l()),r.createElement("div",{className:"WACHeader__Name"},r.createElement(jt,{ref:T,text:n,sizeBreakpoint:28}))),r.createElement("div",{className:"WACHeader__Buttons WACHeader__RightButtons"},s&&r.createElement(Yt,{className:"WACHeader__RestartButton",label:I.buttons_restart,onClick:d,buttonRef:y,buttonType:"ghost"},r.createElement(fe.J3,null)),!Z&&r.createElement(Yt,{className:"WACHeader__CloseButton",label:I.launcher_isOpen,onClick:u,buttonRef:N,buttonType:"ghost"},V?r.createElement(K.QN4,{className:"WACIcon__Close"}):r.createElement(Oe.mli,{className:"WACIcon__Subtract"})),U&&r.createElement(Yt,{className:"WACHeader__CloseAndRestartButton",label:I.header_ariaCloseRestart,onClick:function(){return x(!0)},buttonRef:b,buttonType:"ghost"},r.createElement(K.QN4,null))),B&&r.createElement(qt,{title:I.closeAndRestartModal_title,message:I.closeAndRestartModal_message,onConfirm:z,onCancel:H,cancelButtonLabel:I.closeAndRestartModal_cancel,confirmButtonLabel:I.closeAndRestartModal_confirm,modalAnnounceMessage:I.closeAndRestartModal_message,serviceManager:w}))}function Yt(e){var t,n=e.onClick,a=e.buttonRef,o=e.label,s=e.className,i=e.children,l=e.buttonType;return r.createElement("button",{ref:a,className:_t()(t="WACHeader__Button WAC__button--base WAC__button--".concat(l," ")).call(t,s),"aria-label":o,onClick:n,type:"button"},i)}var $t=r.memo((0,r.forwardRef)(Kt));function Xt(e,t){var n=e.onClose,a=e.onCloseAndRestart,s=e.onRestart,i=e.onToggleHomeScreen,l=e.botName,u=e.includeWriteableElement,d=e.requestInputFocus,p=m(),f=D(),h=(0,o.v9)((function(e){return e.botAvatarURL})),g=(0,o.v9)((function(e){return e.homeScreenConfig.is_on})),v=(0,o.v9)((function(e){return e.customMenuOptions})),_=(0,o.v9)((function(e){return e.agentState})).isConnecting,C=(0,o.v9)((function(e){return e.persistedToBrowserStorage.chatState.agentState})).isConnected,E=(0,o.v9)((function(e){return e.config.public.showRestartButton})),A=(0,c.Z)(),S=(0,r.useRef)(),y=g&&!C&&!_,b=(0,r.useCallback)((function(e){0===e&&y?null==i||i():((0,v[y?e-1:e].handler)(),setTimeout})))}),[v,d,i,y]),N=null==v?void 0:me()(v).call(v,(function(e){return e.text}));N&&y&&It()(N).call(N,0,0,f.homeScreen_overflowMenuHomeScreen),(0,r.useImperativeHandle)(t,(function(){return S.current}));var W=(0,r.useCallback)}),[h,l,A]);return r.createElement("div",{className:"WACHeader__Container"},r.createElement($t,{ref:S,showCenter:!0,displayName:l,renderAvatar:W,showBackButton:Boolean(y&&i),showRestartButton:E,backContent:r.createElement(Rt.VaN,null),labelBackButton:f.homeScreen_returnToHome,onClickRestart:s,onClickClose:n,onCloseAndRestart:a,onClickBack:i,overflowItems:N,overflowClicked:b}),u&&r.createElement(Ot,{id:"headerBottomElement".concat(p.namespace.suffix),className:"ibm-web-chat--reset-styles",element:p.writeableElements[$e.Y6.HEADER_BOTTOM_ELEMENT]}))}function Jt(e){var t=e.avatarURL,n=e.intl,a=e.botName,o=(0,r.useState)(!1),s=o[0],i=o[1];return s||!t?null:r.createElement("img",{className:"WACHeader__Avatar WACHeader__BotAvatar",src:t,onError:function(){i(!0)},alt:n.formatMessage({id:"header_ariaBotAvatar"},{botName:a})})}var Qt=r.memo((0,r.forwardRef)(Xt));function en(e){var t,n=e.serviceManager,a=e.onClose,o=e.languagePack,s=e.onRestart,i=e.showHeader,l=e.botName,u=e.catastrophicErrorType,d=(0,c.Z)();switch(u){case M.Th.AGENT_APP_EXPIRED_SESSION:t="errors_agentAppSessionExpired";break;case M.Th.THROTTLED:t="errors_busy";break;default:t="errors_communicating"}var m=d.formatMessage({id:t},{botName:l});return r.createElement(r.Fragment,null,i&&r.createElement(Qt,{onClose:a,botName:l,onToggleHomeScreen:null,includeWriteableElement:!1}),r.createElement("div",{className:q()("WAC__catastrophicError",{"WAC__catastrophicError--withHeader":i})},r.createElement(He,{text:m}),u!==M.Th.AGENT_APP_EXPIRED_SESSION&&s&&r.createElement("button",{className:"WAC__button--base WAC__button--ghost WAC__button--restart",id:"WAC__error-reset".concat(n.namespace.suffix),"aria-label":o.buttons_restart,onClick:s,type:"button"},r.createElement(fe.uzE,{className:"WAC__button--resetSVG"}))))}var tn=n(6218);function nn(){return(0,tn.default)((function(e,t){return me()(e).call(e,(function(e){return t[e]}))}),rn)}function rn(e,t){var n=e[0],r=e[1],a=t[0],o=t[1];if(n===a&&r===o)return!0;if(n.length!==a.length)return!1;for(var s=0;s<=n.length;s++){var i=n[s],l=a[s];if(i!==l)return!1;if(r[i]!==o[l])return!1}return!0}function an(){var e=(0,o.v9)((function(e){return e.alternateSuggestionsState.panelState})),t=m();return e===M.Em.CLOSED?null:r.createElement("div",{className:"WACBackgroundCover",onClick:function(){return t.store.dispatch(F.ZP.setAlternateSuggestionsPanelState(M.Em.CLOSED,"Event"))}})}var on=r.memo(an),sn=n(15742),ln=n(24276),cn=n(97263);function un(e){return r.createElement("svg",{className:e.className,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 12.75 20.64"},r.createElement("circle",{cx:"6.07",cy:"18.82",r:"1.82"}),r.createElement("path",{d:"M7.28,0H5.46A5.45,5.45,0,0,0,0,5.44v.63H2.43V5.46a3,3,0,0,1,3-3H7.28a3,3,0,1,1,0,6.07H4.86V14H7.28v-3A5.47,5.47,0,1,0,7.28,0Z"}))}var dn=n(49558),mn=n(9166),pn=n(62204),fn=n.n(pn),hn=n(86129),gn=n.n(hn}var _n=n(4277),Cn=n(37609),En=n.n(Cn),An=n(35135),Sn=n.n(An),yn=n(10892),bn=n(38608}var Wn=n(61515),Tn=n.n(Wn),wn=n(61540),In=n.n(wn),Rn=n(58395),Mn=n(10665),On=function(){return On=i()||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},On.apply(this,arguments)},kn=function(e){var t=e.className?"WAC__LoadingSpinner ".concat(e.className):"WAC__LoadingSpinner";return r.createElement("div",On({},e,{className:t}),r.createElement("svg",{viewBox:"-18 -18 36 36",focusable:"false","aria-hidden":"true"},r.createElement("circle",{strokeWidth:"4",cx:"0",cy:"0",r:"16"})))},Pn=n(48471),Bn=n(66328),Dn=n(30647),Ln=n(80882),xn=n(23475),Fn=n(52132);function Hn(e){var t=e.disabled,n=e.onSearchAgain,a=e.onChange,o=e.initialSearch,s=e.totalMatches,i=e.currentMatch,l=e.buttonClass,c=(0,r.useState)(o),u=c[0],d=c[1],m=(0,r.useState)(!1),p=m[0],f=m[1],h=(0,r.useRef)(),g=D();return p&&t&&f(!1),(0,r.useEffect)((function(){d(o)}),[o]),r.createElement("div",{className:q()("WACSearchBox",{"WACSearchBox--inputHasFocus":p})},r.createElement(Fn.UBs,{className:"WACSearchBox__Icon"}),r.createElement("input",{ref:h,className:"WACSearchBox__Input",type:"text","aria-label":g.documentViewer_search,placeholder:g.documentViewer_search,value:u,disabled:t,onChang},onFocus:function(){return f(!0)},onBlur:function(){return f(!1)},onKeyDown:function(e){(0,S.r$)(e)&&s&&n(!1)}}),Boolean(u)&&!t&&r.createElement(r.Fragment,null,r.createElement("div",{className:"WACSearchBox__Matches"},r.createElement("span",null,i),r.createElement("span",null," / "),r.createElement("span",null,s)),r.createElement("div",{className:"WACPDFViewerHeader__Divider"}),r.createElement(ge.Z,{className:"WACDirectionHasReversibleSVG ".concat(l),kind:"ghost",size:"md",hasIconOnly:!0,iconDescription:g.documentViewer_previousMatch,onClick:function(){return n(!0)},disabled:0===s},r.createElement(K.cDj,null)),r.createElement(ge.Z,{className:"WACDirectionHasReversibleSVG ".concat(l),kind:"ghost",size:"md",hasIconOnly:!0,iconDescription:g.documentViewer_nextMatch,onClick:function(){return n(!1)},disabled:0===s},r.createElement(K.F3j,null)),r.createElement(ge.Z,{className:l,kind:"ghost",size:"md",hasIconOnly:!0,iconDescription:g.documentViewer_clearSearch,onClic}},r.createElement(K.PcV,null))))}function Un(e){var t,n=e.url,a=e.title,o=e.initialSearch,s=e.currentPage,i=e.currentScale,l=e.totalPages,c=e.disabled,u=e.searchMatchesCount,d=e.direction,p=e.onClose,f=e.onSearch,h=e.onSearchAgain,g=e.onChangePage,v=e.onChangeScale,_=(0,r.useRef)(),C=m(),E=_t()(t="WACPDFViewer-".concat((0,xn.C)())).call(t,C.namespace.suffix),A=(0,r.useRef)(),y=D(),b=(0,r.useState)(""),N=b[0],W=b[1],T=(0,r.useRef)(),w=Nn().width<700;return(0,r.useEffect)((function(){W(String(s))}),[s]),r.createElement("div",{className:q()("WACPDFViewerHeader",{"WACPDFViewerHeader--disabled":c}),ref:_,"data-floating-menu-container":!0},r.createElement("div",{className:"WACPDFViewerHeader__TopRow"},r.createElement("div",{className:"WACPDFViewerHeader__TitleRow"},r.createElement("div",{className:"WACPDFViewerHeader__TitleLabel"},y.documentViewer_title),a&&r.createElement("div",{className:"WACPDFViewerHeader__Title WACWidget__textEllipsis"},a)),r.createElement(ge.Z,{ref:A,className:"WACPDFViewerHeader__HeaderButton WACPDFViewerHeader__CloseButton",kind:"ghost",size:"md",hasIconOnly:!0,iconDescription:y.documentViewer_close,onClick:p},r.createElement(K.PcV,null))),r.createElement("div",{className:"WACPDFViewerHeader__ButtonsRow"},r.createElement(r.Fragment,null,r.createElement(ge.Z,{className:"WACPDFViewerHeader__HeaderButton",kind:"ghost",size:"md",hasIconOnly:!0,iconDescription:y.documentViewer_previousPage,onClick:function(){Vn(s-1)&&(0,S.OP)(A),g(s-1)},disabled:c||Vn(s)},r.createElement(K.MR9,null)),r.createElement(ge.Z,{className:"WACPDFViewerHeader__HeaderButton",kind:"ghost",size:"md",hasIconOnly:!0,iconDescription:y.documentViewer_nextPage,onClick:function(){Zn(s+1,l)&&(0,S.OP)(A),g(s+1)},disabled:c||Zn(s,l)},r.createElement(K.cRw,null)),r.createElement("div",{className:"WACPDFViewerHeader__PageInputWrapper"},r.createElement(Dn.Z,{className:"WACPDFViewerHeader__PageInput",id:"".concat(E,"-page"),"aria-label":y.documentViewer_currentPage,labelText:"",ref:T,value:N,size:"sm",onChange:function(e){var t=e.target.value.replace(/[^0-9]/g,"");W(t);var n=Number(t);!Number.isNaN(n)&&n>0&&n<=l&&g(n)},onBlu},disabled:c})),r.createElement("div",{className:"WACPDFViewerHeader__PageTotal"},"/ ",r.createElement(Ln.Z,{id:"documentViewer_pagesLabel",values:{count:l}}))),r.createElement("div",{className:"WACPDFViewerHeader__Divider"}),r.createElement(r.Fragment,null,r.createElement(Hn,{initialSearch:c?"":o,disabled:c,onChange:f,onSearchAgain:h,buttonClass:"WACPDFViewerHeader__HeaderButton",currentMatch:(null==u?void 0:u.current)||0,totalMatches:(null==u?void 0:u.total)||0})),r.createElement("div",{className:"WACPDFViewerHeader__Divider"}),!w&&r.createElement(r.Fragment,null,r.createElement(r.Fragment,null,r.createElement(ge.Z,{className:"WACPDFViewerHeader__HeaderButton",kind:"ghost",size:"md",hasIconOnly:!0,iconDescription:y.documentViewer_zoomIn,onClick:function(){zn(i+.1)&&(0,S.OP)(A),v(i+.1)},disabled:c||zn(i)},r.createElement(Pn.wAB,null)),r.createElement(ge.Z,{className:"WACPDFViewerHeader__HeaderButton",kind:"ghost",size:"md",hasIconOnly:!0,iconDescription:y.documentViewer_zoomOut,onClick:function(){qn(i-.1)&&(0,S.OP)(A),v(i-.1)},disabled:c||qn(i)},r.createElement(Pn.dsI,null)),r.createElement(ge.Z,{className:"WACPDFViewerHeader__HeaderButton",kind:"ghost",size:"md",hasIconOnly:!0,iconDescription:y.documentViewer_zoomReset,onClick:function(){return v(1)},disabled:c},r.createElement(Bn.Fx,null))),r.createElement("div",{className:"WACPDFViewerHeader__Divider"}),r.createElement(ge.Z,{className:"WACPDFViewerHeader__HeaderButton WACPDFViewerHeader__Download",kind:"ghost",size:"md",hasIconOnly:!0,as:"a",href:n,target:"_blank",iconDescription:y.documentViewer_download},r.createElement(ln.vzB,null))),w&&r.createElement(r.Fragment,null,r.createElement(Bt.Z,{ariaLabel:y.components_overflow_ariaLabel,size:"lg",flipped:"rtl"!==d,className:"WACPDFViewerHeader__Overflow WAC__button--base WAC__button--ghost"},r.createElement(Dt.Z,{itemText:y.documentViewer_zoomIn,onClic},disabled:zn(i)}),r.createElement(Dt.Z,{itemText:y.documentViewer_zoomOut,onClic},disabled:qn(i)}),r.createElement(Dt.Z,{itemText:y.documentViewer_zoomReset,onClic}}),r.createElement(Dt.Z,{itemText:y.documentViewer_download,href:n,target:"_blank"}))))r Gn,jn=!1;function Kn(e){var t=e.url,a=e.onClose,s=e.title,i=(0,r.useRef)(),l=(0,r.useRef)(),c=D(),u=(0,r.useState)(),d=u[0],m=u[1],p=(0,r.useState)(1),f=p[0],h=p[1],g=(0,r.useState)(""),v=g[0],_=g[1],C=(0,r.useState)(),E=C[0],A=C[1],S=(0,r.useState)(0),y=S[0],b=S[1],N=(0,r.useState)(0),W=N[0],T=N[1],w=(0,r.useState)(""),I=w[0],R=w[1],M=(0,r.useState)(Gn.LOADING),O=M[0],k=M[1],P=(0,o.v9)((function(e){return e.config.public.direction})),B=O!==Gn.LOADED;return jn||(Rn.GlobalWorkerOptions.workerSrc="".concat(n.p,"pdf.worker-3.10.111.js"),jn=!0),(0,r.useEffect)((function(){if(d){var e=(0,_n.jr)(t);R(e),_(e),function(e,t,n,r,a,o,s,i,l,c){var u,d,m,p;u=this,d=void 0,p=function(){var u,d,m,p,f,h;return function(e,t){var n,r,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof le()&&(o[ue()]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((a=(a=s.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1],a=o;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(o);break}a[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}}(this,(function(g){switch(g.label){case 0:return g.trys.push([0,2,,3]),s(Gn.LOADING),[4,Rn.getDocument(e).promise];case 1:return u=g.sent(),d=new Mn.EventBus,i.current=d,d.on("updatefindcontrolstate",(function(e){r(null==e?void 0:e.matchesCount)})),d.on("updatefindmatchescount"})),d.on("pagechanging"})),m=new Mn.PDFLinkService({eventBus:d}),p=new Mn.PDFFindController({eventBus:d,linkService:m}),f=new Mn.PDFViewer({container:n,eventBus:d,linkService:m,findController:p}),l.current=f,m.setViewer(f),d.on("pagesinit",(function(){s(Gn.LOADED),f.currentScale=1,o(f.pagesCount),t&&d.dispatch("find",{type:"",query:t})})),f.setDocument(u),m.setDocument(u),[3,3];case 2:return h=g.sent(),(0,Le.Kd)('Web chat was unable to open the PDF "'.concat(e,'" using its internal viewer. Web chat will attempt to open the PDF in a new browser window.'),h),window.open(e),c(),s(Gn.ERROR),[3,3];case 3:return[2]}}))},new((m=void 0)||(m=se()))((function(e,t){function n(e){try{a(p.next(e))}catch(e){t(e)}}function r(e){try{a(p.throw(e))}catch(e){t(e)}}function a(t){var a;t.done?e(t.value):(a=t.value,a instanceof m?a:new m((function(e){e(a)}))).then(n,r)}a((p=p.apply(u,d||[])).next())}))}(t,e,d,A,b,T,k,i,l,a)}}),[d,t,a]),r.createElement(Ht,null,r.createElement(Et(),null,r.createElement("div",{className:"WACPDFViewer",role:"dialog","aria-label":c.documentViewer_ariaRoleLabel},r.createElement("div",{className:"WACBackgroundCover"}),r.createElement("div",{className:"WACPDFViewer__Inner"},r.createElement(Un,{title:s,url:t,currentScale:f,searchMatchesCount:E,initialSearch:I,currentPage:y,totalPages:W,direction:P,onClose:a,onSearch:function(e){var t;_(e),null===(t=i.current)||void 0===t||t.dispatch("find",{type:"",query:e,highlightAll:!0})},onSearchAgain:function(e){var t;null===(t=i.current)||void 0===t||t.dispatch("find",{type:"again",query:v,highlightAll:!0,findPrevious:e})},onChangePage:function(e){l.current.currentPageNumber=e},onChangeScale:function(e){h(e),l.current.currentScaleValue=String(e)},disabled:B}),r.createElement("div",{className:"WACPDFViewer__Document"},O!==Gn.ERROR&&r.createElement("div",{className:"WACPDFViewer__Container WACScrollFocus",ref:m,tabIndex:B?void 0:0},r.createElement("div",{className:"WACPDFViewer__Viewer pdfViewer"})),O===Gn.LOADING&&r.createElement(Me,null,r.createElement("div",{className:"WACPDFViewer__Loading"},r.createElement(kn,null))),O===Gn.ERROR&&r.createElement("div",{className:"WACPDFViewer__ErrorContainer"},r.createElement("div",{className:"WACPDFViewer__Error"},r.createElement("div",{className:"WACPDFViewer__ErrorTitle"},c.documentViewer_loadErrorTitle),r.createElement("div",{className:"WACPDFViewer__ErrorMessage"},c.documentViewer_loadError),r.createElement(ge.Z,{className:"WACPDFViewer__ErrorRetry",size:"md",onClic}},c.documentViewer_loadErrorRetry))))))))}function Yn(e){var t=e.buttonLabel,n=e.documentTitle,a=e.url,s=e.tooltipText,i=(0,o.v9)((function(e){return e.config.public.direction})),l=(0,r.useState)(!1),c=l[0],u=l[1],d=(0,r.useCallback)((function(){return u(!1)}),[]);return r.createElement("div",{className:"WACOpenPDFButton"},r.createElement(ge.Z,{className:"WACOpenPDFButton__Button",kind:"tertiary",iconDescription:s||t,hasIconOnly:!0,size:"sm",tooltipPosition:"rtl"===i?"left":"right","aria-label":t,onClick:function(){return u(!0)}},r.createElement(ln.xpK,null)),r.createElement("div",{className:"WACOpenPDFButton__Text WACWidget__textEllipsis"},t),c&&r.createElement(Kn,{key:a,url:a,title:n,onClose:d}))}function $n(e,t,n){var r;if(!e||n)return!1;var a=Xn(e);return!P.q$&&t>550&&(null===(r=null==a?void 0:a.toLowerCase())||void 0===r?void 0:Sn()(r).call(r,".pdf"))}function Xn(e){try{var t=new(Tn())(e),n=null==t?void 0:t.pathname;if(n){var r=In()(n).call(n,"/");if(-1!==r){var a=n.substring(r+1);if(be()(a).call(a,".")>0)return decodeURI(a)}}}catch(e){}return null}(Gn||(Gn={}));var Jn=function(){return Jn=i()||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},Jn.apply(this,arguments)},Qn={eventName:"Assistant Message Received from User",type:"search"},er={eventName:"Suggestion Selected",eventDescription:"User clicks on search suggestions bookmark",type:"Search"};function tr(e){var t=e.answer,n=e.title,a=e.titleIsURL,s=e.body,i=e.shouldTruncateBody,l=e.url,u=e.innerRef,d=e.showBookmarkButton,p=e.urlIsValid,f=e.disablePDFViewer,h=D(),g=m(),v=(0,c.Z)(),_=Nn().width,C=(0,o.v9)((function(e){return e.config.public.direction})),E=(0,r.useState)(e.isBookmark),A=E[0],S=E[1];function y(t){g.actions.track(Qn),e.url||t.preventDefault()}var b,N,W,T=(0,mn.Ct)(At.QW.SEARCH),w=s&&r.createElement("div",{className:q()({WAC__searchResponseBody:i,"WACSearchMessage__Result--full":A})},s);return d?b=r.createElement(ge.Z,Jn({renderIcon:bn.gBx,iconDescription:h.suggestions_searchBookmarkButtonDescription,hasIconOnly:!0,tooltipPosition:"rtl"===C?"right":"left",onClic},kind:"ghost",size:"small"},T)):s&&i&&(b=r.createElement(ge.Z,Jn({renderIcon:i&&!A?K.cRw:K.MR9,iconDescription:i&&!A?h.messages_searchResultsExpand:h.messages_searchResultsCollapse,hasIconOnly:!0,tooltipPosition:"rtl"===C?"right":"left",onClic},kind:"ghost",size:"small"},T))),n||l?(W=function(e){if(p){var t=function(e,t,n){var r;return e&&n?r=Xn(e):!e&&t&&(r=Xn(t)),r||e||t}(n,l,a);if($n(l,_,f)){var o=v.formatMessage({id:"messages_searchResultsOpenDocumentWithLabel"},{documentName:t});return r.createElement(Yn,{buttonLabel:o,documentTitle:t,url:l,tooltipText:h.messages_searchResultsOpenDocument})}return r.createElement("a",Jn({onClick:y,className:"WAC__button--link",href:l||"#",target:"_blank",rel:"noopener noreferrer"},e),r.createElement("div",{className:"WACSearchMessage__TitleUrl WACWidget__textEllipsis"},t))}return r.createElement("div",{className:"WACSearchMessage__TitleUrl WACWidget__textEllipsis"},n||l)}(T),N=w):s&&(N=w),r.createElement(r.Fragment,null,r.createElement("div",{className:q()("WAC__searchResult",{"WACSearchMessage--hasAnswer":t,"WACSearchMessage--hasContent":N}),ref:u},N&&r.createElement("div",{className:"WACSearchMessage__ResultContent"},N),r.createElement("div",{className:"WACSearchMessage__ResultBottom-wrapper"},W&&r.createElement("div",{className:"WACSearchMessage__ResultBottom"},W),b&&r.createElement("div",{className:"WACSearchMessage__ResultIcon"},b))))}function nr(e){if("string"==typeof e&&En()(e).call(e,'["')&&Sn()(e).call(e,'"]'))try{e=JSON.parse(e)[0]}catch(e){}return }function ar(e){var t,n,a,s,i,l,c=e.searchResult,d=e.announceOnMount,m=e.onBookmarkClick,p=e.showBookmarkButton,f=e.isBookmark,h=(0,o.v9)((function(e){return e.config.public.disablePDFViewer})),g=e.charactersForEllipsis||200,v=c.url,_=(v=v?nr(v):void 0)&&(0,yn.K2)(v),C=(0,r.useRef)(),E=(0,r.useContext)(u);(0,r.useEffect)}),[d,E]);var A,S,y,b=(0,r.useCallback)}),[m,c]),N=(null===(n=null===(t=c.highlight)||void 0===t?void 0:t.title)||void 0===n?void 0:n[0])?(A=rr(c.highlight.title[0]))?A.replace(new RegExp("<em>|</em>","g"),""):null:nr(rr(c.title)),W=null;(null===(a=c.answers)||void 0===a?void 0:a.length)>0&&(y=null===(s=c.answers)||void 0===s?void 0:s[0].text),(null===(l=null===(i=c.highlight)||void 0===i?void 0:i.body)||void 0===l?void 0:l[0])?(W=function(e){var t=e.split(new RegExp("<em>|</em>","g"));return t.length%2!=1?[t.join("")]:me()(t).call(t,(function(e,t){var n,a=_t()(n="formatHighlightFields-".concat(e,"-")).call(n,t);return t%2!=1?e:r.createElement("em",{key:a},e)}))}(rr(c.highlight.body[0])),S=c.highlight.body[0].length>g):c.body&&(W=nr(rr(c.body)),S=c.body.length>g);var T=!1;return!N&&_&&(N=v,T=!0),(N||W)&&r.createElement(tr,{answer:y,title:N,titleIsURL:T,body:W,shouldTruncateBody:S,urlIsValid:_,url:v,innerRef:C,onBookmarkClick:b,showBookmarkButton:p,isBookmark:f,disablePDFViewer:h})}var or=function(){var e=function(t,n){return e=h()||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),sr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={showMoreResults:!1},t.sortedResults=(0,tn.default)})),t.toggleShowMor},t}return or(t,e),t.prototype.getSearchResultComponents=function(e,t,n){for(var a=this.props,o=a.charactersForEllipsis,s=a.onBookmarkClick,i=a.showBookmarkButton,l=a.isBookmark,c=[],u=0;u<t;u++){var d=e[u],m=r.createElement(ar,{searchResult:d,announceOnMount:n,charactersForEllipsis:o,onBookmarkClick:s,showBookmarkButton:i,isBookmark:l});c.push(r.createElement("li",{key:u},r.createElement("div",null,r.createElement("div",{className:"WACSearchMessage__ResultDivider"}),m)))}return c},t.prototype.renderSearchResults=function(){var e,t,n=this.props.searchResultItem,r=n.primary_results,a=void 0===r?[]:r,o=n.results,s=void 0===o?[]:o;return a.length>0?t=(e=this.sortedResults(a)).length:(e=this.sortedResults(s),t=Math.min(e.length,3)),this.getSearchResultComponents(e,t,!1)},t.prototype.renderAdditionalResults=function(){var e=this.sortedResults(this.props.searchResultItem.additional_results||[]);return this.getSearchResultComponents(e,e.length,!0)},t.prototype.render=function(){var e,t=this.props,n=t.searchResultItem,a=t.languagePack,o=t.hideHeader,s=this.state.showMoreResults,i=n.header,l=n.title,c=this.renderSearchResults();return r.createElement("div",{className:"WACSearchMessage"},!o&&r.createElement("div",{className:"WAC__searchMessage--metablock"},i||l||a.messages_searchResults),c.length>0&&r.createElement(Ze.n9,{className:"WACSearchMessage__ResultsTile"},r.createElement("ul",{className:"WACSearchMessage__Results"},c,s&&this.renderAdditionalResults())),!s&&Boolean(null===(e=n.additional_results)||void 0===e?void 0:e.length)&&r.createElement("button",{onClick:this.toggleShowMore,className:"WACSearchMessage__ToggleShowMore WAC__button--link",type:"button"},r.createElement("span",null,a.showMoreResults),r.createElement(K.cRw,null)))},t}(r.PureComponent);function ir(e){if(!e)return[];var t=fn()(e).call(e,cr);return gn()(t).call(t,lr)}function lr(e,t){return-vn(e&&e.result_metadata?e.result_metadata.confidence:0,t&&t.result_metadata?t.result_metadata.confidence:0)}function cr(e){var t,n,r,a,o,s;return!(!e||(0,_n.ke)(e.body)&&(0,_n.ke)(e.url)&&(0,_n.ke)(e.title)&&(0,_n.ke)(null===(n=null===(t=e.answers)||void 0===t?void 0:t[0])||void 0===n?void 0:n.text)&&(0,_n.ke)(null===(a=null===(r=e.highlight)||void 0===r?void 0:r.title)||void 0===a?void 0:a[0])&&(0,_n.ke)(null===(s=null===(o=e.highlight)||void 0===o?void 0:o.body)||void 0===s?void 0:s[0]))}var ur=r.memo(sr);function dr(){return r.createElement(Ze.n9,{className:"WACSearchTileSkeleton"},r.createElement("div",{className:"WACSearchTileSkeleton__Title"},r.createElement(Ye.Z,null)),r.createElement("div",{className:"WACSearchTileSkeleton__Text"},r.createElement(Ye.Z,null)),r.createElement("div",{className:"WACSearchTileSkeleton__Text"},r.createElement(Ye.Z,null)),r.createElement("div",{className:"WACSearchTileSkeleton__ResultDivider"}))}var mr=M.Em.CLOSED,pr=M.Em.OPEN_FULL,fr=M.Em.OPEN_STRIKE,hr=M.xJ.CONTACT_OPTIONS,gr=M.xJ.ALTERNATE_RESPONSES,vr=M.xJ.STARTERS;function _r(e){var t,n=e.requestInputFocus,a=e.alternateSuggestionsState,o=e.showSearchSkeleton,s=e.languagePack,i=(0,r.useRef)(),l=m(),c=a.panelState,u=a.suggestionListItems,d=a.sourceResponse,p=a.starters,f=a.contactItem,h=a.searchResults,g=a.allowCollapse,v=a.showSearchSection,_=s.suggestions_sectionTitleAlternateResponses,C=s.suggestions_sectionTitleSearch,E=s.suggestions_sectionTitleContact,A=s.suggestions_sectionTitleStarters,y=s.suggestions_ariaPanelButtonToggle,b=s.suggestions_ariaButtonToClose,N=s.suggestions_title,W=(0,r.useCallback)((function(){l.store.dispatch(F.ZP.setAlternateSuggestionsPanelState(mr,"User"))}),[l]),T=(0,r.useCallback)((function(){var e=c===pr?fr:pr;l.store.dispatch(F.ZP.setAlternateSuggestionsPanelState(e,"User"))}),[l,c]),w=(0,r.useCallback)((function(e){!function(e,t){var n=t.store.getState().languagePack,r=n.suggestions_searchBookmarkHeader,a=n.suggestions_searchBookmarkFooter,o={id:null,thread_id:cn.XF,output:{generic:[(0,Le.p_)({response_type:De.Ty.SEARCH,primary_results:[e],header:r}),(0,mn.X)(a)]},history:{is_bookmark:!0}};t.actions.insertLocalMessageResponse(o,!0),t.store.dispatch(F.ZP.setAlternateSuggestionsPanelState(M.Em.CLOSED,"Search"))}(e,l)}),[l]),I=function(e,t,r){l.actions.sendSuggestionChoice(e,d,t,r),setTimeout(n)};return(0,r.useLayoutEffect)}),[]),r.createElement("div",{className:q()("WACAlternateSuggestionsOptionsPanel",{"WACAlternateSuggestionsOptionsPanel--Full":c===pr,"WACAlternateSuggestionsOptionsPanel--Strike":c===fr})},r.createElement("div",{className:"WACAlternateSuggestionsOptionsPanel__Header"},r.createElement("div",{className:"WACAlternateSuggestionsOptionsPanel__Icon"},r.createElement(un,null)),r.createElement("div",{className:"WACAlternateSuggestionsOptionsPanel__Title"},N),g&&r.createElement("button",{type:"button",className:"WACAlternateSuggestionsOptionsPanel__HeaderButton WAC__button--base WAC__button--ghost",onClick:T,"aria-label":y,"data-test-id":"Toggle"},c===fr&&r.createElement(sn.tbV,null),c===pr&&r.createElement(ln.xCE,null)),r.createElement("button",{type:"button",className:"WACAlternateSuggestionsOptionsPanel__HeaderButton WAC__button--base WAC__button--ghost",onClick:W,"aria-label":b,ref:i,"data-test-id":"Close"},r.createElement(K.dOq,null))),r.createElement("div",{className:"WACAlternateSuggestionsOptionsPanel__ScrollPanel"},Boolean(null==u?void 0:u.length)&&r.createElement(Cr,{items:u,label:_,onButtonClick:I,section:gr,testId:"AlternateResponses"}),c===pr&&(v?(t=o?r.createElement("div",{className:"WACAlternateSuggestionsOptionsPanel__SearchSkeleton"},r.createElement(dr,null),r.createElement(dr,null),r.createElement(dr,null)):h?r.createElement(ur,{serviceManager:l,searchResultItem:h,languagePack:s,charactersForEllipsis:100,onBookmarkClick:w,showBookmarkButton:!0,hideHeader:!0}):r.createElement("div",{className:"WACAlternateSuggestionsOptionsPanel__NoSearchResults"},r.createElement(fe.ctA,null),r.createElement("div",null,s.suggestions_noSearchResults)),r.createElement(Er,{label:C,testId:"Search"},t)):null),f&&r.createElement(Ar,{item:f,label:E,onButtonClick:I}),Boolean(null==p?void 0:p.length)&&r.createElement(Cr,{items:p,label:A,onButtonClick:I,section:vr,testId:"Starters"})))}function Cr(e){var t=e.items,n=e.label,a=e.onButtonClick,o=e.section,s=e.testId;return r.createElement(Er,{label:n,testId:s},r.createElement("ul",{className:"WAC__button-holder"},t&&me()(t).call(t,(function(e,t){var n,s=o;return(0,dn.Qe)(e)?(n=e.option.label,e.isContactSuggestion&&(s=M.xJ.CONTACT_OPTIONS)):n=e.label,r.createElement("li",{key:t},r.createElement("button",{type:"button",className:"WAC__button--base WAC__button--round ".concat(e.isSelected?"WAC__button--selected":""),disabled:e.isSelected,onClic}},n))}))))}function Er(e){return r.createElement("div",{className:"WACAlternateSuggestionsOptionsPanel__Section","data-test-id":e.testId},r.createElement("div",{className:"WACAlternateSuggestionsOptionsPanel__SectionTitle"},r.createElement("div",{className:"WACAlternateSuggestionsOptionsPanel__SectionTitleLabel"},e.label),r.createElement("div",{className:"WACAlternateSuggestionsOptionsPanel__SectionTitleDivider"})),e.children)}function Ar(e){var t=e.item,n=e.label,a=e.onButtonClick;return r.createElement(Er,{label:n,testId:"Contact"},r.createElement("div",{className:"WACAlternateSuggestionsOptionsPanel__ContactOption"},r.createElement("button",{type:"button",className:"WAC__button--base WAC__button--ghost ".concat(t.isSelected?"WAC__button--selected":""),disabled:t.isSelected,onClic}},r.createElement("div",{className:"WACAlternateSuggestionsOptionsPanel__ContactOptionInner"},r.createElement("div",{className:"WACAlternateSuggestionsOptionsPanel__ContactOptionInnerColor"}),r.createElement("div",{className:"WACAlternateSuggestionsOptionsPanel__ContactOptionInnerText"},t.option.label),r.createElement("div",{className:"WACAlternateSuggestionsOptionsPanel__ContactOptionInnerIcon"},r.createElement(Rt.kKs,null))))))}var Sr=M.Em.CLOSED,yr=M.Em.OPEN_FULL,br=M.Em.OPEN_STRIKE;function Nr(e){var t,n,a=e.requestInputFocus,s=(0,o.v9)((function(e){return e.alternateSuggestionsState})),i=(0,o.v9)((function(e){return e.languagePack})),l=(0,o.v9)})),c=(0,r.useContext)(Te),u=s.panelState,d=s.searchResultsLoading,p=m(),f=(0,r.useRef)(),h=(0,r.useRef)(0),g=(0,r.useRef)(s),v=(0,r.useCallback)((function(){p.store.dispatch(F.ZP.setAlternateSuggestionsPanelState(Sr,"User"))}),[p]),}(u);return t=function(){var e,t,n=g.current.panelState;if(u!==n)if(u!==Sr){var r="".concat(h.current,"px"),a="".concat(f.current.offsetHeight,"px");(null===(t=null===(e=f.current)||void 0===e?void 0:e.style)||void 0===t?void 0:t.setProperty)&&(f.current.style.setProperty("--WatsonAssistantChat-Animate-Start-Height",r),f.current.style.setProperty("--WatsonAssistantChat-Animate-End-Height",a),J(f.current,"WACAlternateSuggestionsContainer--animate",333,(function(){f.current&&(f.current.style.height=null,h.current=f.current.offsetHeight)})))}else h.current=0;g.current=s},n=(0,r.useRef)(!1),(0,r.useLayoutEffect)}),undefined),u!==Sr&&r.createElement("div",{className:"WACAlternateSuggestionsContainer ".concat(_),ref:f},r.createElement(Et(),{active:l&&!c&&!0,focusTrapOptions:{clickOutsideDeactivates:!0,onDeactivate:v,returnFocusOnDeactivate:!P.q$}},r.createElement("div",{className:"WACAlternateSuggestionsContainer__FocusTrap"},r.createElement(_r,{alternateSuggestionsState:s,requestInputFocus:a,panelState:u,showSearchSkeleton:d&&u===yr,languagePack:i}))))}var Wr=r.memo(Nr),Tr=n(35836),wr=n.n(Tr),Ir=n(50517),Rr=n(24857),Mr=n(93678),Or=function(e,t,n){if(n||2===arguments.length)for(var r,a=0,o=t.length;a<o;a++)!r&&a in t||(r||(r=gt()(Array.prototype).call(t,0,a)),r[a]=t[a]);return _t()(e).call(e,r||gt()(Array.prototype).call(t))},kr=function(}return e.prototype.addListener=function(e){this.listeners=Or(Or([],this.listeners,!0),[e],!1)},e.prototype.removeListene},e.prototype.fireListeners=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.listeners.length&&this.listeners.forEach}))},e}(),Pr=function(){var e=function(t,n){return e=h()||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Br=function(e}return Pr(t,e),t.prototype.getHTMLElemen},t.prototype.takeFocus=function(){(0,S.OP)(this.textAreaRef,!1,!0)},t.prototype.doBlu},t.prototype.render=function(){var e=this.props,t=e.isRequired,n=e.name,a=e.id,o=e.onFocus,s=e.onBlur,i=e.onClick,l=e.onChange,c=e.onKeyDown,u=e.rows,d=e.value,m=e.autoSize,p=e.maxLength,f=e.disabled,h=e.placeholder,g=e.ariaLabel,v=e.testId;return r.createElement("div",{className:q()("WAC__TextArea",{"WAC__TextArea--autoSize":m,"WAC__TextArea--disabled":f})},r.createElement("textarea",{ref:this.textAreaRef,"aria-label":g,"aria-required":t,className:"WAC__TextArea-textarea",disabled:f,id:a,maxLength:p,name:n,onFocus:o,onBlur:s,onClick:i,onChange:l,onKeyDown:c,placeholder:h,rows:u,value:d||"","data-enable-grammarly":!1,"data-test-id":v}),m&&r.createElement("div",{className:"WAC__TextArea-sizer"},d||h||" "))},t.defaultProps={isRequired:!1,maxLength:1e4},t}(r.PureComponent),Dr=Br,Lr=function(){var e=function(t,n){return e=h()||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xr=0,Fr=function(e){function t(){var t,n=null!==e&&e.apply(this,arguments)||this;return n.state={textAreaHasFocus:!1,inputValue:"",enableFadeOut:!1,applySafariHack:!1},n.inputID=_t()(t="".concat(n.props.serviceManager.namespace.suffix,"-")).call(t,++xr),n.enterKeyEnabled=!0,n.isTypingTimeout=null,n.textAreaRef=r.createRef(),n.fileInputRef=r.createRef(),n.changeListeners=new kr,n.lastValue="",n.instanceInputElement=n.createInstanceInputElement(),n.doTypingStopped=function(){n.isTypingTimeout&&(clearTimeout(n.isTypingTimeout),n.isTypingTimeout=null,n.props.onUserTyping&&n.props.onUserTyping(!1))},n.onKeyDown=function(e){(0,S.r$)(e)&&(n.props.disableSend||!n.enterKeyEnabled?e.preventDefault():n.send(e))},n.onChange=function(e){n.props.onUserTyping&&(n.isTypingTimeout?clearTimeout(n.isTypingTimeout):n.props.onUserTyping(!0),n.isTypingTimeout=setTimeout(n.doTypingStopped,5e3)),n.setState({inputValue:e.target.value}),n.setState({enableFadeOut:n.hasValidInput()})},n.send=function(e){if(n.hasValidInput()){var t=n.state.inputValue;e.preventDefault(),n.doTypingStopped();var r=C()(t).call(t);n.props.onSendInput(r),n.setState({inputValue:""}),n.props.blurOnSend?n.textAreaRef.current.doBlur():n.textAreaRef.current.takeFocus()}},n.onInputFocus=function(){n.setState({textAreaHasFocus:!0}),P.h6&&n.setState({applySafariHack:!0})},n.onInputBlur=function(){n.setState({textAreaHasFocus:!1}),P.h6&&setTimeout((function(){n.setState({applySafariHack:!1})}))},n.onRemoveFile=function(e){n.props.serviceManager.store.dispatch(F.ZP.removeFileUpload(e)),n.textAreaRef.current.takeFocus()},n.onFileChange=function(e){for(var t,r,a=n.props.serviceManager.store.dispatch,o=e.target.files,s=[],i=0;i<o.length;i++){var l={id:(0,Rr.Vj)(Mr.d.FILE),status:$e.r.EDIT,file:o[i]};s.push(l),a(F.ZP.addInputFile(l))}null===(r=(t=n.props).onFilesSelectedForUpload)||void 0===r||r.call(t,s),n.fileInputRef.current.value=null},n}return Lr(t,e),t.prototype.componentDidUpdate=function(e,t,n){this.state.textAreaHasFocus&&this.props.disableInput&&this.setState({textAreaHasFocus:!1})},t.prototype.getMessageInpu},t.prototype.takeFocus=function(){!P.q$&&this.props.isInputVisible&&this.textAreaRef.current.takeFocus()},t.prototype.createInstanceInputElement=function(){var e=this;return{getHTMLElemen},setValu},setEnableEnterKe},addChangeListener:function(t){return e.changeListeners.addListener(t)},removeChangeListene}}},t.prototype.getElementId=function(e,t){var n,r,a=this.props,o=a.inputType,s=a.serviceManager,i=e,l=o?"--".concat(o):"",c=t?"":s.namespace.suffix;return _t()(n=_t()(r="".concat(i)).call(r,l)).call(n,c)},t.prototype.hasValidInput=function(){var e=this.state.inputValue,t=this.props.pendingUploads,n=Boolean(null==t?void 0:t.length);return(!n||!wr()(t).call(t})))&&(Boolean(C()(e).call(e))||n)},t.prototype.render=function(){var e=this,t=this.props,n=t.disableInput,a=t.disableSend,o=t.languagePack,s=t.isInputVisible,i=t.placeholder,l=t.showUploadButton,c=t.disableUploadButton,u=t.pendingUploads,d=t.allowedFileUploadTypes,m=t.allowMultipleFileUploads,p=o.input_buttonLabel,f=o.input_placeholder,h=o.input_ariaLabel,g=o.input_uploadButtonLabel,v=this.state,_=v.inputValue,C=v.enableFadeOut,E=v.applySafariHack,A=v.textAreaHasFocus,S=n?"":_,y=this.hasValidInput(),b=!y||n||a,N=c||n,W="WACInputContainer__UploadInput-".concat(this.inputID),T=i||(n?void 0:f);return this.lastValue!==this.state.inputValue&&(this.lastValue=this.state.inputValue,this.changeListeners.fireListeners(this.state.inputValue)),s&&r.createElement("div",{className:q()("WACInputContainer",{"WACInputContainer--safariHack":E,"WACInputContainer--hasFocus":A,"WACInputContainer--showUploadButton":l})},r.createElement("div",{className:"WACInputContainer__LeftContainer"},r.createElement("div",{className:"WACInputContainer__TextAndUpload"},l&&r.createElement("div",{className:"WACInputContainer__UploadButtonContainer"},r.createElement("input",{ref:this.fileInputRef,accept:d,id:W,className:"WACVisuallyHidden WACInputContainer__UploadInput",type:"file","aria-label":g,onChange:this.onFileChange,multiple:m,disabled:N}),r.createElement("label",{className:q()("WACInputContainer__UploadButton WAC__button--base WAC__button--ghost",{"WACInputContainer__UploadButton--disabled":N}),htmlFor:W},r.createElement(V.YnP,null))),r.createElement(Dr,{autoSize:!0,ariaLabel:h,disabled:n,maxLength:2048,onChange:this.onChange,onKeyDown:this.onKeyDown,placeholder:T,value:S,ref:this.textAreaRef,onFocus:this.onInputFocus,onBlur:this.onInputBlur,id:this.getElementId("WACInputContainer-TextArea"),testId:this.getElementId("WACInputContainer-TextArea",!0)})),Boolean(null==u?void 0:u.length)&&r.createElement("div",{className:"WACInputContainer__FilesContainer"},me()(u).call(u,(function(t,n){return r.createElement(Ir.Py,{key:n,iconDescription:o.fileSharing_removeButtonTitle,name:t.file.name,status:$e.r.EDIT,errorSubject:t.errorMessage,invalid:t.isError,size:"sm",onDelet}})})))),r.createElement("button",{className:q()("WACInputContainer__SendButton WAC__button--base WAC__button--primary",{disabled:!y,"fade-out":C&&!y}),id:this.getElementId("WACInputContainer__SendButton"),type:"button",onClick:this.send,"aria-label":p,disabled:b},r.createElement(Fn.dAq,{className:"WACInputContainer__SendButton-icon"})))},t}(r.Component),Hr=r.memo(Fr);function Ur(e){var t=e.onConfirm,n=e.onCancel,a=D(),s=m(),i=(0,o.v9)((function(e){return e.persistedToBrowserStorage.chatState.agentState})).isConnected,l=i?a.agent_endChat:a.agent_confirmCancelRequestTitle,c=i?a.agent_confirmEndChat:a.agent_confirmCancelRequestMessage,u=a.agent_confirmEndChatNo,d=i?a.agent_confirmEndChatYes:a.agent_confirmCancelRequestYes;return r.createElement(qt,{title:l,message:c,onConfirm:t,onCancel:n,cancelButtonLabel:u,confirmButtonLabel:d,modalAnnounceMessage:c,serviceManager:s})}var Vr=n(9494);function Zr(){var e=m(),t=D(),n=t.agent_sharingRequestTitle,a=t.agent_sharingRequestMessage,o=t.agent_sharingDeclineButton,s=t.agent_sharingAcceptButton;return r.createElement(qt,{title:n,message:a,onConfirm:function(){var t;null===(t=e.humanAgentService)||void 0===t||t.screenShareUpdateRequestState(Vr.$.ACCEPTED)},onCancel:function(){var t;null===(t=e.humanAgentService)||void 0===t||t.screenShareUpdateRequestState(Vr.$.DECLINED)},cancelButtonLabel:o,confirmButtonLabel:s,modalAnnounceMessage:a,serviceManager:e})}var qr=function(){return qr=i()||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},qr.apply(this,arguments)},zr=n(85079),Gr=n(90875),jr=n(97115),Kr=n(75407);function Yr(e){var t,n=e.agentProfile,a=e.languagePack,o=e.width,s=e.height,i=null==n?void 0:n.nickname,l={width:o,height:s},c=null==n?void 0:n.profile_picture_url,u=(0,r.useState)(!1),d=u[0],m=u[1];return(0,r.useEffect)}),[c]),t=!d&&c?r.createElement("img",{src:c,alt:a.agent_ariaAgentAvatar,onError:function(){return m(!0)}}):(null==i?void 0:i.match(/^[\x20-\xFE]+$/))?r.createElement("div",{"aria-label":a.agent_ariaAgentAvatar,className:"WACAgentAvatar__Circle",style:l},r.createElement("div",{className:"WACAgentAvatar__Letter"},i.charAt(0))):r.createElement(sn.zIK,{width:o?Number(o.replace("px","")):void 0,height:s?Number(s.replace("px","")):void 0,"aria-label":a.agent_ariaAgentAvatar}),r.createElement("div",{className:"WACAgentAvatar"},t)}function $r(e,t){var n,a,s,i,l,c=e.onButtonClick,u=D(),d=m(),p=(0,o.v9)((function(e){return e.persistedToBrowserStorage.chatState.agentState})),f=(0,o.v9)((function(e){return e.agentState})),h=f.isConnecting,g=f.availability,v=f.isScreenSharing,_=p.agentProfile,C=(0,r.useRef)();return h?(l=r.createElement("div",{className:"WACLoadingBar__ConnectingAnimation"}),n=u.agent_connecting,a=r.createElement(Se,{announceOnce:u.agent_connecting},(0,Kr.E6)(g,u.agent_connectWaiting)),i=u.agent_connectButtonCancel):(n=(null==_?void 0:_.nickname)||u.agent_noName,i=u.agent_connectedButtonEndChat,s=r.createElement(Yr,{agentProfile:_,languagePack:u,width:"32px",height:"32px"})),(0,r.useImperativeHandle)(t,(function(){return{requestFocus:function(){return!!C.current&&((0,S.OP)(C),!0)}}})),r.createElement("div",{className:q()("WACAgentBanner",{"WACAgentBanner--connected":!h})},r.createElement("div",{className:"WACAgentBanner__Body"},s,r.createElement("div",{className:"WACAgentBanner__AgentInfo"},r.createElement("div",{className:"WACAgentBanner__AgentLine1"},n),a&&r.createElement("div",{className:"WACAgentBanner__AgentLine2"},a)),r.createElement(ge.Z,{ref:C,className:"WACAgentBanner__Button WACAgentBanner__CancelButton",onClick:c,size:"sm"},i)),v&&r.createElement(ge.Z,{className:"WACAgentBanner__Button WACAgentBanner__StopSharingButton",kind:"danger",size:"sm",renderIcon:Fn.CvH,onClic}},u.agent_sharingStopSharingButton),l)}var Xr=r.memo((0,r.forwardRef)($r));function Jr(){var e=m(),t=(0,o.v9)((function(e){return e.alternateSuggestionsState})),n=(0,o.v9)((function(e){return e.inputState.isReadonly})),a=(0,o.v9)((function(e){return e.languagePack})),s=t.showButton,i=(0,r.useRef)(),l=a.suggestions_ariaButtonToOpen;return s?r.createElement("div",{className:"WACAlternateSuggestionsButton"},r.createElement("div",{className:"WACAlternateSuggestionsButton__ButtonContainer"},r.createElement("button",{type:"button",className:"WACAlternateSuggestionsButton__button WAC__button--base WAC__button--primary",ref:i,onClick:function(){e.store.dispatch(F.ZP.setAlternateSuggestionsPanelState(M.Em.OPEN_FULL,"User"))},"aria-label":l,disabled:n},r.createElement(un,null)))):null}var Qr=r.memo(Jr);function ea(e){var t=e.welcomeNodeBeforeElement,n=e.children,a=(0,r.useRef)(),o=m().namespace;return(0,r.useEffect)}),[t]),r.createElement(r.Fragment,null,r.createElement("div",{ref:a,className:"ibm-web-chat--reset-styles",id:"welcomeNodeBeforeElement".concat(o.suffix)}),n)}var ta=r.memo(ea);function na(){return r.createElement("div",{className:"WAC__LoadingIcon","aria-hidden":"true"},r.createElement("span",{className:"WAC__loading-ball"}),r.createElement("span",{className:"WAC__loading-ball"}),r.createElement("span",{className:"WAC__loading-ball"}))}var ra=n(28745),aa=n(26221),oa=function(){return oa=i()||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},oa.apply(this,arguments)};function sa(e){var t=e.event,n=(0,r.useRef)(),a=m();return L((function(){a.eventBus.fireSync(oa(oa({},t),{element:n.current}),a.instance)})),r.createElement("div",{ref:n})}function ia(e){var t,n,a=(0,c.Z)(),o=e.message.item.response_type;return o===Gr.hN.SESSION_EXPIRED?(t="sessionHistory_expired",n=a.formatMessage({id:t})):o===Gr.hN.CHANNEL_TRANSFER_FAILED&&(t="channelTransfer_failed",n=a.formatMessage({id:t})),r.createElement(r.Fragment,null,n)}var la=n(23166),ca=function(){return ca=i()||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},ca.apply(this,arguments)};function ua(e){var t,n,a,o,s,i,l,c=e.languagePack,u=e.localMessage,d=e.originalMessage,m=e.disableUserInputs,p=e.serviceManager,f=e.agentState,h=e.requestFocus,g=f.activeLocalMessageID,v=f.availability,_=f.isConnecting,C=(0,r.useCallback)}),[u,d,p,h]);if(d.history.agent_availability===la.s.OFFLINE){var E=(null===(t=u.item.agent_unavailable)||void 0===t?void 0:t.message)||c.default_agent_unavailableMessage;return r.createElement("div",null,E)}switch(null===(a=null===(n=u.item.transfer_info)||void 0===n?void 0:n.reason)||void 0===a?void 0:a.type){case cn.ZJ.GENERAL_ERROR:case cn.ZJ.TRANSFER_FAILURE:s=c.agent_reason_error;break;default:s=(null===(o=u.item.agent_available)||void 0===o?void 0:o.message)||c.default_agent_availableMessage}var A=m,S=s;u.ui_state.id===g?(A=!0,_?(i=K.NlZ,l=c.agent_cardButtonChatRequested,S=(0,Kr.E6)(v,c.agent_connectWaiting)):(i=Rt._JA,l=c.agent_cardButtonConnected,S=c.agent_cardMessageConnected)):m?u.ui_state.wasAgentChatEnded?(i=Pt.GpU,l=c.agent_cardButtonChatEnded,S=c.agent_cardMessageChatEnded):(i=Rt._JA,l=c.agent_startChat):(i=Rt.bL,l=c.agent_startChat);var y=A?null:(0,mn.Ct)(At.QW.CONNECT_TO_AGENT);return r.createElement(Ze.n9,{className:"WACConnectToAgent"},r.createElement("div",{className:"WACConnectToAgent__Title"},r.createElement("span",null,c.agent_chatTitle)),r.createElement("div",{className:"WACConnectToAgent__Text"},S),r.createElement(ge.Z,ca({className:"WACConnectToAgent__RequestButton",size:"md",disabled:A,onClick:C,renderIcon:i},y),l))}function da(e){var t=e.languagePack,n=e.localMessage,a=e.originalMessage,o=e.config,s=e.serviceManager,i=e.disableUserInputs,l=e.agentState,c=e.requestFocus,u=o.public.__ibm__,d=u.connectToAgentBehavior,m=u.isReadonly,p=t.agent_sdMissingWarning,f=(null==a?void 0:a.history).agent_no_service_desk&&d===k.uO.WARN_MISSING,h=d===k.uO.PREVIEW&&!(0,mn.vh)(o),g=i||m||f||h||!(0,mn.vh)(o);return r.createElement("div",null,f&&r.createElement(he.K0,{className:"WACConnectToAgent__Warning",kind:"error",hideCloseButton:!0,title:r.createElement(St.p,{html:p})}),r.createElement(ua,{localMessage:n,originalMessage:a,languagePack:t,serviceManager:s,disableUserInputs:g,agentState:l,requestFocus:c}))}var ma=function(){return ma=i()||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},ma.apply(this,arguments)};function pa(e){var t=e.source,n=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&be()(t).call(t,r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof We()){var a=0;for(r=We()(e);a<r.length;a++)be()(t).call(t,r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}(e,["source"]),a=null==t?void 0:En()(t).call(t,"https://www.mixcloud.com");return r.createElement(Qe,ma({type:De.Ty.AUDIO,source:t,isMixcloud:a},n))}var fa=r.memo(pa),ha=n(14469);function ga(e){var t=e.className,n=e.label,a=e.kind,o=e.url,s=e.target,i=void 0===s?"_blank":s,l=e.disabled,c=e.renderIcon,u=e.imageURL,d=e.altText,m=e.onClick,p=n||o,f=o?i:void 0;return u?r.createElement(va,{url:o,imageURL:u,altText:d,label:n,target:i,disabled:l,renderIcon:c,onClick:m}):r.createElement(ge.Z,{className:q()("WACButtonItem",t),as:o?"a":void 0,kind:_a(a),href:o,target:f,rel:o?"noopener noreferrer":void 0,disabled:l,renderIcon:c,onClick:m},p)}function va(e){var t=e.url,n=e.imageURL,a=e.altText,o=e.target,s=e.label,i=e.disabled,l=e.onClick,c=e.renderIcon,u=D().errors_imageSource,d=c,m=r.createElement(r.Fragment,null,!s&&!t&&r.createElement("div",{className:"WACButtonItemImage__IconHolder"},r.createElement(d,null)),r.createElement(ze,{imageError:u,source:n,title:s,displayURL:t,altText:a,renderIcon:r.createElement(d,null)}));return t?r.createElement("a",{className:"WACButtonItemImage",href:t,rel:"noopener noreferrer",target:o,onClick:l},m):r.createElement("button",{type:"button",className:"WACButtonItemImage",onClick:l,disabled:i},m)}function _a(e){switch(e){case Gr._$.LINK:case Gr._$.TERTIARY:return"ghost";case Gr._$.DEFAULT:return"primary";default:return e}}function Ca(e){var t=this,n=e.localMessageItem,a=e.fullMessage,o=m(),s=n.item,i=n.ui_state,l=s.image_url,c=s.alt_text,u=s.label,d=s.kind,p=s.value,f=Boolean(p&&i.optionSelected),h=(0,r.useCallback)((function(){return e=t,n=void 0,i=function(){return function(e,t){var n,r,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof le()&&(o[ue()]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((a=(a=s.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1],a=o;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(o);break}a[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}}(this,(function(e){switch(e.label){case 0:return[4,o.fire({type:O.re.MESSAGE_ITEM_CUSTOM,customEventType:O.nQ.BUTTON_ITEM_CLICKED,messageItem:s,fullMessage:a})];case 1:return e.sent(),[2]}}))},new((r=void 0)||(r=se()))((function(t,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(e){e(n)}))).then(o,s)}l((i=i.apply(e,n||[])).next())}));var e,n,r,i}),[s,o,a]);return r.createElement(ga,{imageURL:l,altText:c,label:u,kind:d,disabled:f,renderIcon:l&&ha.Iak||void 0,onClick:h})}function Ea(e){var t=e.localMessageItem,n=e.requestFocus,a=e.isMostRecentMessage,o=m(),s=t.item,i=t.ui_state,l=t.fullMessageID,c=s.image_url,u=s.alt_text,d=s.label,p=s.kind,f=!a||Boolean(i.optionSelected),h=(0,r.useCallback)((function(){var e,t;if(Boolean((null===(t=null===(e=s.value)||void 0===e?void 0:e.input)||void 0===t?void 0:t.text)||d)){var r=(0,mn.lM)(s,l);n(),o.store.dispatch(F.ZP.messageSetOptionSelected(i.id,r)),o.actions.sendWithCatch(r,{trackEventProps:{eventName:"Assistant Message Received from User",type:"post_back"}})}else{var a;(0,Le.N6)(_t()(a="".concat($e.DQ,' post_back button with label "')).call(a,s.label,'" has no input message to send.'))}}),[s,l,o,i,n]);return r.createElement(ga,{imageURL:c,altText:u,label:d,kind:p,onClick:h,renderIcon:c&&Fn.JPq||void 0,disabled:f})}function Aa(e){var t=this,n=e.localMessageItem,a=e.isMostRecentMessage,o=m(),s=n.item,i=s.image_url,l=s.alt_text,c=s.label,u=s.kind,d=(0,r.useCallback)((function(){return e=t,r=void 0,i=function(){return function(e,t){var n,r,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof le()&&(o[ue()]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((a=(a=s.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1],a=o;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(o);break}a[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}}(this,(function(e){return o.store.dispatch(F.ZP.setResponsePanelIsOpen(!0)),o.store.dispatch(F.ZP.setResponsePanelContent(n,a)),[2]}))},new((s=void 0)||(s=se()))((function(t,n){function a(e){try{l(i.next(e))}catch(e){n(e)}}function o(e){try{l(i.throw(e))}catch(e){n(e)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof s?n:new s((function(e){e(n)}))).then(a,o)}l((i=i.apply(e,r||[])).next())}));var e,r,s,i}),[n,a,o]);return r.createElement(ga,{className:"WACButtonItemComponent__ShowPanel",imageURL:i,altText:l,label:c,kind:u,renderIcon:i&&Pt.GpU||void 0,onClick:d})}var Sa=n(70180),ya=n(97963);function ba(e){var t=e.localMessageItem.item,n=t.image_url,a=t.alt_text,o=t.url,s=t.target,i=t.label,l=t.kind,c=i||o;return n||l!==Gr._$.LINK?r.createElement(ga,{imageURL:n,altText:a,label:c,kind:l,url:o,target:s,renderIcon:Sa.V8Q}):r.createElement("div",{className:"WAC__received--textContent WACButtonItem"},r.createElement(ya.Z,{className:"WACWidget__breakWord",href:o,target:s,rel:"noopener noreferrer",renderIcon:Sa.V8Q},c))}function Na(e){switch(e.localMessageItem.item.button_type){case Gr.hI.URL:return r.createElement(ba,{localMessageItem:e.localMessageItem});case Gr.hI.SHOW_PANEL:return r.createElement(Aa,{localMessageItem:e.localMessageItem,isMostRecentMessage:e.isMostRecentMessage});case Gr.hI.CUSTOM_EVENT:return r.createElement(Ca,{localMessageItem:e.localMessageItem,fullMessage:e.fullMessage});default:return r.createElement(Ea,{localMessageItem:e.localMessageItem,requestFocus:e.requestFocus,isMostRecentMessage:e.isMostRecentMessage})}}var Wa=function(){return Wa=i()||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},Wa.apply(this,arguments)};function Ta(e){var t=e.message.ui_state.bodyLocalMessageItemIDs,n=(0,o.v9)((function(e){return e.allMessageItemsByID})),a=null==t?void 0:me()(t).call(t,(function(a,o){var s=n[a],i=wa(s.item.response_type),l=t[o+1],c=n[l],u=wa(null==c?void 0:c.item.response_type),d=!(o===t.length-1||i||u);return r.createElement("div",{key:a,className:q()("WACBodyMessageComponents__MessageWrapper",{"WACBodyMessageComponents__MessageWrapper--fullWidth":i,"WACBodyMessageComponents__MessageWrapper--shortBottomPadding":d})},r.createElement(Oo,Wa({},e,{message:s,isNestedMessageItem:!0})))}));return(null==a?void 0:a.length)?r.createElement("div",{className:"WACBodyMessageComponents"},a):null}function wa(e){switch(e){case De.Ty.IMAGE:case De.Ty.IFRAME:case De.Ty.VIDEO:case De.Ty.AUDIO:case De.Ty.USER_DEFINED:return!0;default:return!1}}var Ia=r.memo(Ta),Ra=function(){return Ra=i()||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},Ra.apply(this,arguments)};function Ma(e){var t,n,a=(0,o.v9)((function(e){return e.allMessageItemsByID})),s=null===(t=e.message.ui_state.footerLocalMessageItemIDs)||void 0===t?void 0:me()(t).call(t,(function(t){var n=a[t];return r.createElement(Oo,Ra({key:t},e,{message:n,isNestedMessageItem:!0}))})),i=null!==(n=null==s?void 0:s.length)&&void 0!==n?n:0,l=i>2;return r.createElement(r.Fragment,null,Boolean(i)&&r.createElement("div",{className:q()("WACFooterButtonComponents",{"WACFooterButtonComponents--column":l})},s))}function Oa(e){var t=e.localMessageItem,n=e.fullMessage,a=e.isMostRecentMessage,s=e.requestFocus,i=m(),l=D(),c=(0,o.v9)((function(e){return e.config})),u=(0,o.v9)((function(e){return e.agentState})),d=(0,o.v9)((function(e){return e.persistedToBrowserStorage.chatState.agentState})),p=(0,o.v9)((function(e){return e.inputState}));return r.createElement(r.Fragment,null,r.createElement(Ia,{message:t,originalMessage:n,languagePack:l,toolingType:c.public.__ibm__.toolingType,requestInputFocus:s,agentState:u,persistedAgentState:d,disableUserInputs:p.isReadonly,config:c,isMostRecentMessage:a,scrollElementIntoView:$e.VG,serviceManager:i}),r.createElement(Ma,{message:t,originalMessage:n,languagePack:l,toolingType:c.public.__ibm__.toolingType,requestInputFocus:s,agentState:u,persistedAgentState:d,disableUserInputs:p.isReadonly,config:c,isMostRecentMessage:a,scrollElementIntoView:$e.VG,serviceManager:i}))}var ka=function(){return ka=i()||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},ka.apply(this,arguments)};function Pa(e){return r.createElement(Ze.n9,{className:"WACCardMessageComponent"},r.createElement(Oa,ka({},e)))}var Ba=r.memo(Pa),Da=n(77930),La=n(46650),xa=[Da.s5,Da.W_];function Fa(e){var t,n=e.children,a=e.swiperRef,o=e.initialSlide,s=e.onSlideChange,i=(0,c.Z)(),l=D(),u=l.carousel_prevNavButton,d=l.carousel_nextNavButton,m=(0,r.useState)(),p=m[0],f=m[1],h=(0,r.useState)(),g=h[0],v=h[1],_=(0,r.useState)(1),C=_[0],E=_[1],A=r.Children.count(n),S=i.formatMessage({id:"components_swiper_currentLabel"},{currentSlideNumber:C,totalSlideCount:A});return A<=1?r.createElement("div",{className:"WACCarouselContainer WACCarouselContainer--oneSlide"},n):r.createElement("div",{className:"WACCarouselContainer"},p&&r.createElement(La.tq,{ref:a,initialSlide:o,modules:xa,navigation:{prevEl:g,nextEl:p},slidesPerView:"auto",spaceBetween:16,onSlideChange:function(e){var t=e.activeIndex;E(t+1),null==s||s(t)},slidesOffsetBefore:24,slidesOffsetAfter:16,rewind:!0},me()(t=r.Children).call(t,n}))),r.createElement("div",{className:"WACCarouselContainer__Controls"},r.createElement("div",{className:"WACCarouselContainer__CurrentLabel"},S),r.createElement("div",{className:"WACCarouselContainer__Navigation"},r.createElement(ge.Z,{ref:v,className:"WACCarouselContainer__NavigationButton WACDirectionHasReversibleSVG",kind:"ghost","aria-label":u},r.createElement(K.cDj,null)),r.createElement(ge.Z,{ref:f,className:"WACCarouselContainer__NavigationButton WACDirectionHasReversibleSVG",kind:"ghost","aria-label":d},r.createElement(K.F3j,null)))))}function Ha(e){var t=e.localMessageItem,n=e.fullMessage,a=e.isMostRecentMessage,s=e.requestFocus,i=(0,o.v9)((function(e){return e.allMessageItemsByID})),l=t.ui_state.itemsLocalMessageItemIDs;return r.createElement(Fa,null,me()(l).call(l})))}var Ua=n(50569),Va=n.n(Ua);function Za(e){var t=e.citation,n=e.isSelected,a=e.onSelectCitation,s=t.text,i=t.description,l=t.url,c=t.title,u=null!=s?s:i,d=D(),m=d.conversationalSearch_viewPDF,p=d.conversationalSearch_viewSourceDocument,f=$n(l,Nn().width,(0,o.v9)((function(e){return e.config.public.disablePDFViewer}))),h=f?m:p;return r.createElement("div",{className:q()("WACConversationalSearchCitationTile",{"WACConversationalSearchCitationTile--selected":n})},r.createElement("div",{className:"WACConversationalSearchCitationTile__Upper",onClick:a},c&&r.createElement("div",{className:"WACConversationalSearchCitationTile_Title WACWidget__textEllipsis"},c),u&&r.createElement("div",{className:"WACConversationalSearchCitationTile_Text WACWidget--lineClamp"},u)),r.createElement("div",{className:"WACConversationalSearchCitationTile__Lower"},l&&r.createElement("div",{className:"WACConversationalSearchCitationTile_Link"},f&&r.createElement(Yn,{buttonLabel:h,documentTitle:h,url:l}),!f&&r.createElement(ya.Z,{className:"WACWidget__breakWord",href:l,target:"_blank",rel:"noopener noreferrer",renderIcon:Sa.Dqp},h))))}var qa=function(){return qa=i()||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},qa.apply(this,arguments)};function za(e){var t,n,a=e.citations,o=e.selectedCitationIndex,s=e.onCitationClicked,i=e.onToggleCitations,l=e.citationsOpen,c=e.localMessageItem,u=D(),d=m(),p=c.ui_state.streamingState,f=_t()(t="WACConversationalSearchText-".concat((0,xn.C)())).call(t,d.namespace.suffix),h=c.item.text,g=(0,r.useMemo)((function(){return function(e,t){var n=[];null==t||t.forEach((function(e,t){void 0!==e.range_start&&n.push(qa(qa({},e),{originalIndex:t}))}));var r=[],a=0;return n.forEach((function(t){t.range_start>a&&r.push({text:e.substring(a,t.range_start)}),r.push({text:e.substring(t.range_start,t.range_end),citation:t}),a=t.range_end})),a<e.length&&r.push({text:e.substring(a)}),r}(h,a)}),[h,a]);return p&&!p.isDone?r.createElement("div",{className:"WACConversationalSearchText"},me()(n=p.chunks).call(n,(function(e,t){return r.createElement("span",{key:t,className:"WACConversationalSearchText__Segment WACConversationalSearchText__Segment--streaming"},e.text)}))):r.createElement("div",{className:"WACConversationalSearchText"},me()(g).call(g,(function(e,t){if(e.citation){var n=e.citation.originalIndex===o;return r.createElement("span",{key:t,role:"button",tabIndex:0,className:q()("WACConversationalSearchText__Segment WACConversationalSearchText--hasCitation",{"WACConversationalSearchText--selected":n&&l}),onKeyPress:function(t){return function(e,t){((0,S.r$)(e)||" "===e.key)&&s(t.originalIndex)}(t,e.citation)},onClic}},e.text)}return r.createElement("span",{key:t,className:"WACConversationalSearchText__Segment"},e.text)})),Boolean(null==a?void 0:a.length)&&r.createElement(r.Fragment,null,r.createElement("span",{className:"WACConversationalSearchText__CitationsToggle"},r.createElement(Y.Z,{id:f,type:l?"high-contrast":"gray",onClick:i,"aria-expanded":l,"aria-label":u.conversationalSearch_toggleCitations},l?r.createElement(K.MR9,null):r.createElement(K.cRw,null))),r.createElement("span",null," ")))}function Ga(e){var t,n=e.localMessageItem,a=e.scrollElementIntoView,o=e.isStreamingError,s=e.doAutoScroll,i=(0,r.useState)(0),l=i[0],c=i[1],u=(0,r.useState)(!1),d=u[0],m=u[1],p=(0,r.useRef)(),f=(0,r.useRef)(),h=D(),g=n.item,v=g.disclaimer,_=(0,r.useMemo)((function(){return Va()(s,100,{maxWait:100,leading:!0})}),[s]),C=(0,r.useMemo)((function(){var e,t;return null===(t=g.citations)||void 0===t?void 0:gn()(e=gt()(t).call(t)).call(e,ja)}),[g.citations]);function E(){setTimeou)}))}var A=null===(t=n.ui_state.streamingState)||void 0===t?void 0:t.chunks;function S(e){m(!0),c(e),setTimeout((function(){var t;return null===(t=f.current)||void 0===t?void 0:t.swiper.slideTo(e)})),E()}return x(A)!==A&&setTimeout(_),r.createElement("div",{className:"WACConversationalSearch"},r.createElement("div",{className:"ibm-web-chat--default-styles"},r.createElement(za,{localMessageItem:n,citations:C,selectedCitationIndex:l,onCitationClicked:S,onToggleCitatio)},citationsOpen:d}),o&&r.createElement(He,{text:h.conversationalSearch_streamingIncomplete})),r.createElement("div",{ref:p},d&&r.createElement("div",{className:"WACConversationalSearch_Citations"},r.createElement(Fa,{swiperRef:f,initialSlide:l,onSlideChange:c},me()(C).call(C,(function(e,t){return r.createElement(Za,{key:t,citation:e,isSelected:t===l,onSelectCitation:function(){return S(t)}})})))),v&&r.createElement("div",{className:"WACConversationalSearch_Disclaimer"},r.createElement("span",{className:"WACConversationalSearch_DisclaimerAI"},"AI"),r.createElement("span",{className:"WACConversationalSearch_DisclaimerText"},v))))}function ja(e,t){return void 0===e.range_start||void 0===t.range_start?void 0===e.range_start&&void 0===t.range_start?0:void 0===e.range_start?1:-1:vn(e.range_start,t.range_start)}function Ka(e){var t=e.serviceManager.customElementRegistry.get(e.localMessageID),n=(0,r.useRef)();return(0,r.useLayoutEffect)((function(){var e=n.current;if(t)return e.appendChild()}})),r.createElement("div",{ref:n,className:"ibm-web-chat--reset-styles WAC__message-customResponse","data-floating-menu-container":!0})}var Ya=r.memo(Ka),$a=n(43488),Xa=n.n($a),Ja=n(81382),Qa=n(97076),eo=n.n(Qa),to=n(54032),no=n.n(to),ro=new RegExp("[ ".concat($e.a4,"]|\\.$"),"g"),ao=r.laz)}));function oo(e){var t=e.localMessage,n=e.disabled,a=e.scrollElementIntoView,s=m(),i=(0,c.Z)(),l=(0,o.v9)((function(e){return e.locale})),u=(0,o.v9]})),d=(0,r.useRef)((0,Rr.Vj)(Mr.d.MISCELLANEOUS)),p=(0,r.useState)(!1),f=p[0],h=p[1],g=(0,r.useState)(),v=g[0],_=g[1],E=(0,r.useState)(),A=E[0],S=E[1],y=(0,r.useState)(),b=y[0],N=y[1],W=(0,r.useState)(),T=W[0],w=W[1],I=(0,r.useState)(),R=I[0],M=I[1],O=(0,r.useState)(),k=O[0],P=O[1],B=(0,r.useRef)(),D=i.formatMessage({id:"datePicker_chooseDate"},{format:b}),x=i.formatMessage({id:"datePicker_confirmDate"}),F=Boolean(A&&b&&T&&R);function H(e){var t,n,r,a,o,s,i=(a=(null===(r=null===(n=null===(t=eo().Ls[e])||void 0===t?void 0:t.formats)||void 0===n?void 0:n.L)||void 0===r?void 0:r.toLocaleLowerCase())||$e.wy,o=a.replace(ro,""),Xa()(o).call(o,"mm")||(o=o.replace("m","mm")),Xa()(o).call(o,"dd")||(o=o.replace("d","dd")),o);M(e),w("zh-tw"===(s=e)?"zh_tw":Xa()(s).call(s,"-")?s.split("-")[0]:s),N(i),S(function(e){var t,n=C()(t=e.toLocaleLowerCase()).call(t)[0];if("m"===n)return"n/j/Y";if("d"===n)return"j/n/Y";if("y"===n)return"Y/n/j";throw Error("The provided format ".concat(e," is invalid."))}(i))}var U=(0,r.useCallback)((function(){var e=t.ui_state,n=t.fullMessageID,r=e.id,a=(0,mn.z6)(B.current,v,n);s.actions.sendWithCatch(a,{trackEventProps:{eventName:"Assistant Message Received from User",type:"datepicker"},setValueSelectedForMessageID:r})}),[t,s,v]);return L((function(){var e,n,r,a=(null===(r=null===(n=null===(e=u.context)||void 0===e?void 0:e.global)||void 0===n?void 0:n.system)||void 0===r?void 0:r.locale)||l,o=t.ui_state.originalUserText;u.history.from_history&&o&&_(o);try{eo().Ls[a]?H(a):(0,ve.d7)(a).then((function(e){H(e)}))}catch(e){(0,Le.N6)("Locale ".concat(R," is not recognized by web chat. Defaulting to English(US).")),H("en")}})),r.createElement("div",{className:"WACDatePicker"},F&&k&&r.createElement(r.Suspense,{fallback:r.createElement(r.Fragment,null)},r.createElement(ao,{className:"WACDatePicker__Calendar",datePickerType:"single",allowInput:!1,locale:T,appendTo:k,onChange:function(e){if(e.length){var t=e[0];B.current=function(e){var t,n,r,a,o=no()(t=String(e.getDate())).call(t,2,"0"),s=no()(n=String(e.getMonth()+1)).call(n,2,"0"),i=String(e.getFullYear());return _t()(r=_t()(a="".concat(i,"-")).call(a,s,"-")).call(r,o)}(t),_(function(e,t){var n=String(e.getDate()),r=String(e.getMonth()+1),a=String(e.getFullYear());return t.replace("dd",n).replace("mm",r).replace("yyyy",a)}(t,b))}},dateFormat:A,onOp)},onClo)}},r.createElement(Ja.Z,{id:d.current,labelText:D,placeholder:b,disabled:n,value:v,title:""}))),r.createElement("div",{className:"WACDatePicker__CalendarContainer",ref:P}),!n&&!f&&v&&r.createElement(ge.Z,{className:"WACDatePicker__ConfirmButton",onClick:U,renderIcon:K.jbk},x))}var so=r.memo(oo),io=/^[0-9]*(px)?$/;function lo(e){var t,n=e.localMessageItem,a=e.originalMessage,s=m(),i=D(),l=(0,o.v9)((function(e){return e.config})),c=(0,o.v9)((function(e){return e.agentState})),u=(0,o.v9)((function(e){return e.persistedToBrowserStorage.chatState.agentState})),d=(0,o.v9)((function(e){return e.inputState})),p=(0,o.v9)((function(e){return e.allMessageItemsByID})),f=n.item,h=f.columns,g=f.horizontal_alignment,v=f.vertical_alignment,_=(null==h?void 0:me()(h).call(h,(function(e){return e.width})).join(" "))||"1";return r.createElement("div",{className:"WACGrid",style:{gridTemplateColumns:_}},me()(t=n.ui_state.gridLocalMessageItemIDs).call(t,(function(e,t){return r.createElement("div",{key:"row-".concat(t),className:"WACGrid__Row"},me()(e).call(e,(function(e,o){var m,f,_,C,E=null===(f=n.item.rows[t])||void 0===f?void 0:f.cells[o],A=(null===(_=null==h?void 0:h[o])||void 0===_?void 0:_.width)||"1";return A.match(io)?C=Sn()(A).call(A,"px"):(A="1",C=!1),r.createElement("div",{className:"WACGrid__Cell",style:{width:C?A:void 0,flex:C?void 0:Number(A),alignItems:co((null==E?void 0:E.horizontal_alignment)||g),justifyContent:co((null==E?void 0:E.vertical_alignment)||v)},key:_t()(m="cell-".concat(t,"-")).call(m,o)},me()(e).call(e,(function(e,n){var m,f,h=p[e];return r.createElement(Oo,{key:_t()(m=_t()(f="item-".concat(t,"-")).call(f,o,"-")).call(m,n),message:h,originalMessage:a,languagePack:i,toolingType:l.public.__ibm__.toolingType,requestInputFocus:$e.VG,agentState:c,persistedAgentState:u,disableUserInputs:d.isReadonly,config:l,isMostRecentMessage:!1,scrollElementIntoView:$e.VG,serviceManager:s,isNestedMessageItem:!0})})))})))})}}var uo=r.memo(lo),mo=n(66240);function po(e){var t=e.messageItem,n=e.doAutoScroll,a=t.source,o=t.image_url,s=t.title,i=t.description,l=(0,P.Cs)(a),u=m().store,d=D().iframe_ariaImageAltText,p=(0,c.Z)().formatMessage({id:"iframe_ariaClickPreviewCard"},{source:l}),f=(0,r.useState)(Boolean(o)),h=f[0],g=f[1],v=(0,r.useState)(!1),_=v[0],C=v[1];return r.createElement("div",null,r.createElement("button",{className:"WACIFramePreviewCard",onClick:function(){a&&u.dispatch(F.ZP.setIFrameContent(t))},type:"button"},o&&!_&&r.createElement("div",{className:"WACIFramePreviewCard__ImageContainer"},h&&r.createElement(Ve.Z,{className:"WAC__image--loading"}),r.createElement("img",{className:q()({WAC__hidden:h}),src:o,onLo)},onErr)},alt:d})),r.createElement(qe,{title:s,description:i,defaultIcon:r.createElement(mo.xds,null),displayURL:a,urlHostName:l}),r.createElement(b,null,p)))}var fo=r.memo(po);function ho(e){var t,n=e.title,a=e.source,o=e.onTimeoutOverride,s=e.onLoad,i=D(),l=i.errors_iframeSource,c=i.iframe_ariaSourceLoaded,u=Q(),d=(0,r.useState)(!0),m=d[0],p=d[1],f=(0,r.useState)(!1),h=f[0],g=f[1],v=(0,r.useCallback)}),[u,l]),_=(0,r.useCallback)((function(){p(!1),u(c),null==s||s()}),[u,c,s]);return(0,r.useEffect)((function(){var e=null;return m&&(e=setTimeout(o||v,$e.Fx)}}),[m,v,o]),r.createElement("div",{className:"WACIFrameComponent__Wrapper"},h&&(t=l,r.createElement("div",{className:"WACIFrameComponent__StatusContainer"},r.createElement(He,{text:t}))),!h&&r.createElement("iframe",{className:"WACIFrameComponent__IFrame",title:n,src:a,sandbox:"allow-scripts allow-downloads allow-forms allow-same-origin allow-popups",referrerPolicy:"origin",onLoad:_}),m&&r.createElement(Me,null,r.createElement("div",{className:"WACIFrameComponent__StatusContainer"},r.createElement(kn,null))))}function go(e){var t,n,a=e.messageItem,o=e.doAutoScroll,s=Q(),i=D().errors_iframeSource,l=(0,r.useState)(!1),c=l[0],u=l[1],d=a.source,m=a.title,p=a.channel_options,f=null===(n=null===(t=null==p?void 0:p.chat)||void 0===t?void 0:t.dimensions)||void 0===n?void 0:n.base_height,h=(0,Le.wo)(f),g=m||d,v=(0,r.useCallback)}),[s,i]);return c?r.createElement(He,{text:i}):r.createElement("div",{className:"WACInlineIFrame",style:{paddingTop:h}},r.createElement(ho,{source:d,title:g,onTimeoutOverride:v,onLo)}}))}function vo(e){var t,n=e.doAutoScroll,a=e.localMessage,o=e.displayOverride,s=a.item,i=null===(t=s.channel_options)||void 0===t?void 0:t.chat;return(null==i?void 0:i.display)===De.EI.INLINE||o===De.EI.INLINE?r.createElement(go,{key:s.source,doAutoScroll:n,messageItem:s}):r.createElement(fo,{doAutoScroll:n,messageItem:s})}var _o=n(11172),Co=n(2103),Eo=n(41587),Ao=function(){var e=function(t,n){return e=h()||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),So=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onSelect=function(e,n){var r=t.props,a=r.localMessage,o=r.serviceManager,s=r.originalMessage,i=!(0,mn.rN)(s);o.actions.sendDisambiguationOption(n.item,a,s,n.index,i),t.props.requestInputFocus()},t}return Ao(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.localMessage,a=t.originalMessage,o=t.disableUserInputs,s=t.serviceManager,i=t.shouldRemoveHTMLBeforeMarkdownConversion,l=n.item,c=l.suggestions,u=l.title,d=(s.store.getState().config.public,n.ui_state.optionSelected),m=!(0,mn.rN)(a);return r.createElement(r.Fragment,null,r.createElement(Eo.Z,{description:u,shouldRemoveHTMLBeforeMarkdownConversion:i}),r.createElement("div",{className:"WAC__button-holder"},r.createElement("ul",null,me()(c).call(c,(function(t,n){return r.createElement("li",{key:t.label},r.createElement(Co.Z,{className:"WAC__button--base WAC__button--round WAC__disambigButton-".concat(n),boundParameter:{index:n,item:t},disabled:o,selected:!m&&d&&t.value.input.suggestion_id===d.input.suggestion_id,onClick:e.onSelect},t.label))})))))},t}(r.Component),yo=So,bo=function(e,t,n,r){return new(n||(n=se()))((function(a,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function i(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,i)}l((r=r.apply(e,t||[])).next())}))},No=function(e,t){var n,r,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof le()&&(o[ue()]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((a=(a=s.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1],a=o;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(o);break}a[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}};function Wo(e){var t,n,a=e.message,s=e.serviceManager,i=D(),l=i.tour_resumeButton,c=i.tour_restartButton,u=i.tour_startButton,d=(0,o.v9)((function(e){return e.persistedToBrowserStorage.chatState.persistedTourState})).activeTourID,m=a.fullMessageID===d,p=(null===(t=a.item.user_defined)||void 0===t?void 0:t.card_title)||"Guided journey",f=(null===(n=a.item.user_defined)||void 0===n?void 0:n.card_description)||"Follow along as the assistant guides you to where you want to be.";return r.createElement(Ze.n9,{className:"WACTourCard"},r.createElement("div",{className:"WACTourCard__Title"},p),r.createElement("div",{className:"WACTourCard__Description"},f),m&&r.createElement("div",null,r.createElement(ge.Z,{className:"WACTourCard__ResumeButton",renderIcon:V.i9_,onClick:function(){return bo(this,void 0,void 0,(function(){return No(this,(function(e){switch(e.label){case 0:return[4,s.actions.changeView(M.bW.TOUR,{mainWindowCloseReason:O.yi.TOUR_CARD_RESUMED_TOUR})];case 1:return e.sent(),s.trackService.track({eventName:"Tour interaction",eventDescription:"Tour continued.",type:"From resume button."}),[2]}}))}))}},l),r.createElement(ge.Z,{className:"WACTourCard__RestartButton",kind:"ghost",renderIcon:fe.J3,onClick:function(){return bo(this,void 0,void 0,(function(){return No(this,(function(e){switch(e.label){case 0:return[4,s.actions.changeView(M.bW.TOUR,{mainWindowCloseReason:O.yi.TOUR_CARD_RESTARTED_TOUR})];case 1:return e.sent().tour&&s.actions.changeStepInTour({newStepIndex:0}),s.trackService.track({eventName:"Tour interaction",eventDescription:"Tour continued.",type:"From restart button."}),[2]}}))}))}},c)),!m&&r.createElement(ge.Z,{className:"WACTourCard__StartButton",renderIcon:V.i9_,onClick:function(){return s.actions.startTour(a,O.M.START_TOUR_CLICKED,{mainWindowCloseReason:O.yi.TOUR_CARD_STARTED_TOUR})}},u))}var To=r.memo(Wo);function wo(e){var t=e.text;return r.createElement("div",null,t)}function Io(e){var t=e.message,n=t.message_to_user,a=t.transfer_info,o=(null==a?void 0:a.target).chat;return r.createElement("div",{className:"WACChannelTransfer"},r.createElement(wo,{text:n}),(null==o?void 0:o.url)&&r.createElement("div",{className:"WACChannelTransfer__url"},"".concat(new(Tn())(o.url).origin,"/[...]")))}var Ro=r.memo(Io),Mo=function(){var e=function(t,n){return e=h()||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Oo=function(s}return Mo(t,e),t.prototype.renderSpecificMessage=function(e,t){if((0,mn.cx)(e))return this.renderTour(e);if((0,mn.s9)(e))return this.renderCustomResponse(e);var n=e.item.response_type,r=Boolean(e.item.agent_message_type);switch(n){case De.Ty.TEXT:return this.renderText(e,t,r);case De.Ty.IMAGE:return this.renderImage(e);case De.Ty.OPTION:return this.renderOption(e,t);case De.Ty.CONNECT_TO_AGENT:return this.renderConnectToAgent(e,t);case De.Ty.SUGGESTION:return this.renderSuggestion(e,t);case De.Ty.SEARCH:return this.renderSearch(e,t);case De.Ty.CHANNEL_TRANSFER:return this.renderChannelTransfer(e);case Gr.hN.INLINE_ERROR:return this.renderInlineError(e);case Gr.hN.STREAM_LOADING:return this.renderStreamLoading();case Gr.hN.CHANNEL_TRANSFER_FAILED:case Gr.hN.SESSION_EXPIRED:return this.renderChatStatusMessage(e);case De.Ty.IFRAME:return this.renderIFrameMessage(e);case De.Ty.VIDEO:return this.renderVideoMessage(e);case De.Ty.AUDIO:return this.renderAudioMessage(e);case De.Ty.DATE:return this.renderDateMessage(e);case De.Ty.CONVERSATIONAL_SEARCH:return this.renderConversationalSearchMessage(e,t);case Gr.hN.CARD:return this.renderCard(e,t);case Gr.hN.CAROUSEL:return this.renderCarouselMessage(e,t);case Gr.hN.BUTTON:return this.renderButtonItem(e,t);case Gr.hN.GRID:return this.renderGrid(e,t);default:return this.renderCustomResponse(e)}},t.prototype.renderText=function(e,t,n){var a,o=(null===(a=t.history)||void 0===a?void 0:a.label)||e.item.text;if((0,mn.gJ)(t)){var s=e.ui_state.originalUserText||o;return r.createElement("div",{className:"WAC__sent--text"},t.input.message_type===Gr.PN.FILE&&r.createElement(V.YnP,{className:"WAC__sent-fileIcon","aria-label":this.props.languagePack.fileSharing_fileIcon}),r.createElement("span",null,s))}return this.props.isNestedMessageItem?this.renderRichText(o,n):r.createElement("div",{className:"WAC__received--textContent"},this.renderRichText(o,n))},t.prototype.renderRichTe)},t.prototype.renderOption=function(e,t){var n=this.props,a=n.languagePack,o=n.requestInputFocus,s=n.serviceManager,i=n.disableUserInputs,l=n.isMostRecentMessage,c=Boolean(e.item.agent_message_type);return r.createElement(_o.x,{localMessage:e,originalMessage:t,languagePack:a,disableUserInputs:i||!l,requestInputFocus:o,serviceManager:s,shouldRemoveHTMLBeforeMarkdownConversion:c})},t.prototype.renderSuggestion=function(e,t){var n=this.props,a=n.requestInputFocus,o=n.serviceManager,s=n.disableUserInputs,i=n.isMostRecentMessage,l=n.agentState,c=n.persistedAgentState,u=Boolean(e.item.agent_message_type),d=!(0,mn.rN)(t),m=s||!d&&!i||l.isConnecting||c.isConnected;return r.createElement(yo,{localMessage:e,originalMessage:t,serviceManager:o,disableUserInputs:m,requestInputFocus:a,shouldRemoveHTMLBeforeMarkdownConversion:u})},t.prototype.renderImage=function(e){var t=this.props.languagePack;return r.createElement(ze,{imageError:t.errors_imageSource,source:e.item.source,title:e.item.title,description:e.item.description,altText:e.item.alt_text,needsAnnouncement:e.ui_state.needsAnnouncement})},t.prototype.renderSearch=function(e,t){var n=this.props,a=n.serviceManager,o=n.languagePack;return r.createElement(ur,{serviceManager:a,searchResultItem:e.item,languagePack:o,showBookmarkButton:!1,isBookmark:t.history.is_bookmark})},t.prototype.renderInlineErr)},t.prototype.renderStreamLoadi)},t.prototype.renderChatStatusMessa)},t.prototype.renderIFrameMessage=function(e){var t=this.props,n=t.doAutoScroll,a=t.isNestedMessageItem?De.EI.INLINE:void 0;return r.createElement(vo,{localMessage:e,doAutoScroll:n,displayOverride:a})},t.prototype.renderVideoMessage=function(e){var t,n,a=this.props.doAutoScroll,o=e.item,s=o.source,i=o.title,l=o.description,c=o.alt_text,u=o.channel_options;return r.createElement(nt,{source:s,title:i,description:l,baseHeight:null===(n=null===(t=null==u?void 0:u.chat)||void 0===t?void 0:t.dimensions)||void 0===n?void 0:n.base_height,ariaLabel:c,doAutoScroll:a,needsAnnouncement:e.ui_state.needsAnnouncement})},t.prototype.renderAudioMessage=function(e){var t=this.props.doAutoScroll,n=e.item,a=n.source,o=n.title,s=n.description,i=n.alt_text;return r.createElement(fa,{source:a,title:o,description:s,ariaLabel:i,doAutoScroll:t,needsAnnouncement:e.ui_state.needsAnnouncement})},t.prototype.renderDateMessage=function(e){return r.createElement(so,{localMessage:e,disabled:!this.props.isMostRecentMessage,scrollElementIntoView:this.props.scrollElementIntoView})},t.prototype.renderCustomResponse=function(e){var t=this.props.serviceManager;return r.createElement(Ya,{localMessageID:e.ui_state.id,serviceManager:t})},t.prototype.renderTour=function(e){var t=this.props.serviceManager;return r.createElement(To,{message:e,serviceManager:t})},t.prototype.renderConnectToAgent=function(e,t){var n=this.props,a=n.languagePack,o=n.config,s=n.serviceManager,i=n.agentState,l=n.disableUserInputs,c=n.isMostRecentMessage;return r.createElement(da,{localMessage:e,originalMessage:t,languagePack:a,config:o,serviceManager:s,agentState:i,disableUserInputs:l||!c,requestFocus:this.props.requestInputFocus})},t.prototype.renderChannelTransf)},t.prototype.renderCard=function(e,t){var n=this.props,a=n.isMostRecentMessage,o=n.requestInputFocus;return r.createElement(Ba,{localMessageItem:e,fullMessage:t,isMostRecentMessage:a,requestFocus:o})},t.prototype.renderConversationalSearchMessage=function(e,t){var n,a=this.props,o=a.scrollElementIntoView,s=a.doAutoScroll;return r.createElement(Ga,{localMessageItem:e,scrollElementIntoView:o,isStreamingError:null===(n=t.history)||void 0===n?void 0:n.is_streaming_error,doAutoScroll:s})},t.prototype.renderButtonItem=function(e,t){var n=this.props,a=n.isMostRecentMessage,o=n.requestInputFocus;return r.createElement(Na,{localMessageItem:e,fullMessage:t,isMostRecentMessage:a,requestFocus:o})},t.prototype.renderCarouselMessage=function(e,t){var n=this.props,a=n.isMostRecentMessage,o=n.requestInputFocus;return r.createElement(Ha,{localMessageItem:e,fullMessage:t,isMostRecentMessage:a,requestFocus:o})},t.prototype.renderGr)},t.prototype.rend)},t}(r.Component);function ko(e){return r.createElement("div",{className:"WAC__bot-bar WAC__message-vertical-padding"},!e.invisible&&r.createElement("div",{className:"WAC__bot-bar-color"}))}var Po,Bo=function(){var e=function(t,n){return e=h()||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Do=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={didRenderErrorOccur:!1,focusHandleHasFocus:!1},t.ref=r.createRef(),t.messageRef=r.createRef(),t.focusHandleRef=r.createRef(),t.getLocalMessae},t.onHandleFocus=function(){t.setState({focusHandleHasFocus:!0})},t.onHandleBlur=function(){t.setState({focusHandleHasFocus:!1})},t.setZInd)},t.onHandleKeyDown=function(e){var n;e.altKey||e.metaKey||e.ctrlKey||e.shiftKey||("ArrowUp"===e.key?n=Po.PREVIOUS:"ArrowDown"===e.key?n=Po.NEXT:"Home"===e.key?n=Po.FIRST:"End"===e.key?n=Po.LAST:"Escape"===e.key&&(n=Po.INPUT),n&&(e.preventDefault(),t.props.requestMoveFocus(n,t.props.messagesIndex)))},t}return Bo(t,e),t.prototype.getWidgetSaidMessage=function(){var e,t=this.props,n=t.intl,r=t.botName,a=t.localMessage;return a.item.agent_message_type?a.item.response_type===De.Ty.TEXT&&(e="messages_agentSaid"):e="messages_botSaid",e?n.formatMessage({id:e},{botName:r}):null},t.prototype.componentDidCatch=function(e,t){this.props.serviceManager.actions.errorOccurred((0,Le.gV)("Message",e,t)),this.setState({didRenderErrorOccur:!0})},t.prototype.componentDidMount=function(){var e=this.props.localMessage.ui_state;e.needsAnnouncement&&(this.props.ariaAnnouncer(this.ref.current),this.props.serviceManager.store.dispatch(F.ZP.setMessageWasAnnounced(e.id)))},t.prototype.componentDidUpdate=function(){var e=this.props.localMessage.ui_state;e.needsAnnouncement&&(this.props.ariaAnnouncer(this.ref.current),this.props.serviceManager.store.dispatch(F.ZP.setMessageWasAnnounced(e.id)))},t.prototype.shouldRenderFailedMessage=function(){var e;if(this.state.didRenderErrorOccur)return!0;var t=this.props,n=t.localMessage,r=t.originalMessage,a=t.config.public.__ibm__.connectToAgentBehavior;return(0,mn.d9)(n.item)&&(null===(e=r.history)||void 0===e?void 0:e.agent_no_service_desk)&&a===k.uO.ERROR_MISSING},t.prototype.requestHandleFocus=function(){var e=this.props,t=e.languagePack,n=e.intl,r=e.originalMessage,a=e.botName,o=[(0,mn.gJ)(r)?t.messages_youSaid:n.formatMessage({id:"messages_botSaid"},{botName:a})];w(this.messageRef.current,o),this.focusHandleRef.current.setAttribute("aria-label",o.join(" ")),(0,S.OP)(this.focusHandleRef,!0)},t.prototype.renderFailedRenderMessage=function(){var e,t=this.props.messagesIndex;return r.createElement("div",{className:_t()(e="WAC__message WAC__message--inlineError WAC__message-".concat(t," ")).call(e,this.props.className||""),ref:this.ref},r.createElement("div",{className:"WAC__message--padding"},r.createElement("div",{className:"WAC__bot-message"},r.createElement(b,null,this.getWidgetSaidMessage()),r.createElement(ko,null),r.createElement("div",{className:"WAC__received WAC__message-vertical-padding WAC__received--text"},r.createElement(Fe,{text:this.props.languagePack.errors_singleMessage})))))},t.prototype.renderCustomLeft=function(e){if(this.props.serviceManager.enableUICustomEvents.has(e)){var t=this.props,n=t.originalMessage,a={element:null,type:e,messageItem:t.localMessage.item,message:n,setItemZIndex:this.setZIndex};return r.createElement(sa,{event:a})}return null},t.prototype.renderAvatar=function(e,t,n){var a,o=this.props,s=o.languagePack,i=o.uiCustomizationConfig,l=o.isFirstMessageItem,c=e.item.agent_message_type,u=e.item.response_type;if(e.ui_state.fullWidth||!i.displayBotBar||function(e){switch(e){case null:case void 0:case Gr.K$.FROM_USER:case Gr.K$.RELOAD_WARNING:case Gr.K$.DISCONNECTED:case Gr.K$.FROM_AGENT:case Gr.K$.INLINE_ERROR:return!1;default:return!0}}(c)||u===Gr.hN.CAROUSEL&&!(0,mn.W0)(e.item))return null;if(c===Gr.K$.FROM_AGENT){if(l){var d=t.agent_profile;return r.createElement("div",{className:"WAC__agentMessageAvatar WAC__message-vertical-padding"},r.createElement(Yr,{agentProfile:d,languagePack:s,width:"32px",height:"32px"}))}return r.createElement("div",{className:"WAC__agentMessageAvatar WAC__agentMessageAvatar--empty WAC__message-vertical-padding"})}switch(u){case Gr.hN.INLINE_ERROR:case Gr.hN.STREAM_LOADING:case Gr.hN.SESSION_EXPIRED:a=!0;break;default:a=Boolean(!n||c)}return r.createElement(ko,{invisible:a})},t.prototype.renderMessageState=function(e){var t,n,a,o,s=this.props.languagePack,i=null===(t=e.history)||void 0===t?void 0:t.error_state,l=null===(n=e.history)||void 0===n?void 0:n.file_upload_status;return i===zr.H.FAILED?(a=r.createElement(xe,null),o="WAC__message-error-failed"):i===zr.H.RETRYING?(a=r.createElement(Ke.Gu6,{"aria-label":s.errors_ariaMessageRetrying}),o="WAC__message-error-retrying"):l===$e.r.UPLOADING?(a=r.createElement(ra.Z,{withOverlay:!1,small:!0,"aria-label":s.fileSharing_statusUploading}),o="WAC__message-status-file-uploading"):"success"===l&&(a=r.createElement(K.Y3p,{"aria-label":s.fileSharing_statusUploading}),o="WAC__message-status-file-success"),a&&r.createElement("div",{className:"WAC__message-status ".concat(o)},a)},t.prototype.renderFocusHandle=function(){return r.createElement("div",{className:"WACMessage--focusHandle",ref:this.focusHandleRef,tabIndex:-1,onFocus:this.onHandleFocus,onBlur:this.onHandleBlur,onKeyDown:this.onHandleKeyDown,role:"listitem"})},t.prototype.render=function(){var e;if(this.shouldRenderFailedMessage())return this.renderFailedRenderMessage();var t,n=this.props,a=n.serviceManager,o=n.config,s=n.localMessage,i=n.originalMessage,l=n.languagePack,c=n.requestInputFocus,u=n.toolingType,d=n.messagesIndex,m=n.agentState,p=n.persistedAgentState,f=n.isLatestWelcomeNodesActive,h=n.disableUserInputs,g=n.showBotMarker,v=n.showTimestamp,_=n.className,C=n.doAutoScroll,E=n.isMostRecentMessage,A=n.scrollElementIntoView,S=s.item.response_type,y=s.item.agent_message_type,N=s.ui_state,W=N.partOfMessageID,T=N.id,w=i.history.from_history,I=W===T,R=r.createElement(Oo,{serviceManager:a,toolingType:u,languagePack:l,requestInputFocus:c,message:s,originalMessage:i,agentState:m,persistedAgentState:p,disableUserInputs:h,isMostRecentMessage:E,config:o,doAutoScroll:C,scrollElementIntoView:A}),M=(0,mn.s9)(s),k=(0,mn.E6)(s);null!==this.state.zIndex&&void 0!==this.state.zIndex&&(t={zIndex:this.state.zIndex});var P=s.ui_state.isLatestWelcomeNode&&!f||s.ui_state.disableFadeAnimation,B=function(e,t,n){if(n)return"WAC__received--agentCustom";if(!t||t!==De.Ty.TEXT&&t!==Gr.hN.BUTTON)return"";switch(e){case null:case void 0:case Gr.K$.FROM_USER:return null;case Gr.K$.RELOAD_WARNING:case Gr.K$.DISCONNECTED:return"WAC__received--chatStatusMessage";case Gr.K$.FROM_AGENT:return"WAC__received--fromAgent";default:return"WAC__received--agentStatusMessage"}}(y,S,M);return r.createElement("div",{id:_t()(e="WAC__message-".concat(d)).call(e,a.namespace.suffix),className:q()("WAC__message WAC__message-".concat(d),_,{"WAC__message--no-animation":P,"WAC__message--custom":M,"WAC__message--disabled-inputs":h,"WAC__message--has-focus":this.state.focusHandleHasFocus}),ref:this.ref,style:t},this.renderFocusHandle(),r.createElement("div",{className:"WAC__message--padding"},(0,mn.Ew)(i)&&r.createElement("div",{className:"WAC__bot-message"},I&&r.createElement(b,null,this.getWidgetSaidMessage()),this.renderCustomLeft(O.re.CUSTOMIZATION_RESPONSE_LEFT),this.renderAvatar(s,i.history,g),r.createElement("div",{className:q()("WAC__received","WAC__message-vertical-padding",B,{"WAC__received--text":S===De.Ty.TEXT,"WAC__received--image":S===De.Ty.IMAGE,"WAC__received--options":S===De.Ty.OPTION,"WAC__received--search":S===De.Ty.SEARCH,"WAC__received--suggestion":S===De.Ty.SUGGESTION,"WAC__received--welcome":"welcome"===S,"WAC__received--inlineError":S===Gr.hN.INLINE_ERROR,"WAC__received--streamLoading":S===Gr.hN.STREAM_LOADING,"WAC__received--channelTransfer":S===De.Ty.CHANNEL_TRANSFER,"WAC__received--iframePreviewCard":S===De.Ty.IFRAME,"WAC__received--video":S===De.Ty.VIDEO,"WAC__received--audio":S===De.Ty.AUDIO,"WAC__received--date":S===De.Ty.DATE,"WAC__received--card":S===Gr.hN.CARD,"WAC__received--carousel":S===Gr.hN.CAROUSEL,"WAC__received--carouselSingle":(0,mn.W0)(s.item),"WAC__received--button":S===Gr.hN.BUTTON,"WAC__received--grid":S===Gr.hN.GRID,"WAC__received--chatStatusMessage":k,"WAC__received--fullWidth":s.ui_state.fullWidth,"WAC__message--historical":w}),ref:this.messageRef},v&&Boolean(i.history.timestamp)&&r.createElement("div",{className:"WAC__message-timestamp"},(0,aa.p6)(i.history.timestamp)),r.createElement("div",{className:"WAC__received--inner"},R))),(0,mn.gJ)(i)&&r.createElement("div",{className:"WAC__sentAndError-container"},this.renderCustomLeft(O.re.CUSTOMIZATION_REQUEST_LEFT),this.renderMessageState(i),r.createElement("div",{className:"WAC__sent-padding WAC__message-vertical-padding"},r.createElement("div",{className:"WAC__sent"},r.createElement(b,null,l.messages_youSaid),v&&Boolean(i.history.timestamp)&&r.createElement("div",{className:"WAC__message-timestamp"},(0,aa.p6)(i.history.timestamp)),r.createElement("div",{className:"WAC__sent--bubble"},r.createElement("div",{ref:this.messageRef},R)))))))},t}(r.PureComponent),Lo=Ce((0,l.ZP)(Do,{forwardRef:!0})),xo=function(){var e=function(t,n){return e=h()||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}("}(Po||(Po={}));var Fo,Ho=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={scrollHandleHasFocus:!1},t.messageRefs=[],t.messagesContainerWithScrollingRef=r.createRef(),t.scrollHandleRef=r.createRef(),t.agentBannerRef=r.createRef(),t.onResize=function(){if(t.props.messageState.isScrollAnchored){var e=t.messagesContainerWithScrollingRef.current;e&&(e.scrollTop=e.scrollHeight)}},t.doAutoScroll=function(e){var n,r,a,o;try{var s=t.props,i=s.localItems,l=s.messageState,c=s.allMessagesByID,u=l.isTypingCounter,d=t.messagesContainerWithScrollingRef.current;if(e)return void(0,S.FA)(d,0,0,!1);var m=!0,p=void 0,f=i.length-1,h=i.length?i[f]:null,g=c[null==h?void 0:h.fullMessageID],v=h&&h.ui_state.isLatestWelcomeNode?t.findFirstWelcomeNodeIndex(i):-1;if(h)if(u>0)p=d.scrollHeight;else if(-1!==v){m=!1;var _=t.messageRefs[v];p=null!==(r=null===(n=null==_?void 0:_.ref.current)||void 0===n?void 0:n.offsetTop)&&void 0!==r?r:-1}else{for(var C=i.length-1,E=t.messageRefs[C];C>=1;){var A=i[C],y=c[null==A?void 0:A.fullMessageID];if((0,mn.gJ)(y)){E=t.messageRefs[C];break}C--}p=E?null===(a=E.ref.current)||void 0===a?void 0:a.offsetTop:-1}else m=!1,p=0;-1!==p&&p>=d.scrollTop&&((null===(o=null==g?void 0:g.history)||void 0===o?void 0:o.from_history)&&(m=!1),(0,S.FA)(d,p,0,m),t.checkScrollAnchor(!0,p))}catch(e){(0,Le.N6)("An error occurred while attempting to scroll.",e)}},t.scrollElementIntoView=function(e,n,r){void 0===n&&(n=8),void 0===r&&(r=8);var a=t.messagesContainerWithScrollingRef.current,o=a.getBoundingClientRect(),s=e.getBoundingClientRect(),i=s.top-o.top+a.scrollTop-n,l=s.bottom-o.top+a.scrollTop+r,c=e.offsetHeight+n+r;i<a.scrollTop||c>a.offsetHeight?(0,S.FA)(a,i,0):l>a.scrollTop+a.offsetHeight&&(0,S.FA)(a,l-a.offsetHeight,0)},t.requestMoveFocus=function(e,n){if(e===Po.INPUT)t.props.requestInputFocus();else{var r=void 0;switch(e){case Po.LAST:r=t.messageRefs.length-1;break;case Po.NEXT:(r=n+1)>=t.messageRefs.length&&(r=0);break;case Po.PREVIOUS:(r=n-1)<0&&(r=t.messageRefs.length-1);break;default:r=0}var a=t.messageRefs[r];a&&a.requestHandleFocus()}},t}return xo(t,e),t.prototype.componentDidMount=function(){this.scrollPanelObserver=new Lt.Z(this.onResize),this.scrollPanelObserver.observe(this.messagesContainerWithScrollingRef.current),this.previousScrollOffsetHeight=this.messagesContainerWithScrollingRef.current.offsetHeight},t.prototype.componentDidUpdate=function(e){e.localItems.length===this.props.localItems.length&&e.messageState.isTypingCounter===this.props.messageState.isTypingCounter||this.doAutoScroll()},t.prototype.componentWillUnmou)},t.prototype.checkScrollAnchor=function(e,t){var n=this.messagesContainerWithScrollingRef.current;if(e||this.previousScrollOffsetHeight===n.offsetHeight&&!this.props.suspendScrollDetection){var r=(void 0!==t?t:n.scrollTop)>=n.scrollHeight-n.offsetHeight;r!==this.props.messageState.isScrollAnchored&&this.props.serviceManager.store.dispatch(F.ZP.setChatMessagesStateProperty("isScrollAnchored",r))}this.previousScrollOffsetHeight=n.offsetHeight},t.prototype.requestAgentBannerFoc)},t.prototype.doScrollToMessage=function(e,t){void 0===t&&(t=!0);try{for(var n=this.props.localItems,r=void 0,a=0;a<=this.messageRefs.length;a++)if(n[a].fullMessageID===e){r=this.messageRefs[a];break}if(r){var o=this.messagesContainerWithScrollingRef.current,s=r.ref.current.offsetTop;(0,S.FA)(o,s,0,t),this.checkScrollAnchor(!0,s)}}catch(e){(0,Le.N6)("An error occurred while attempting to scroll.",e)}},t.prototype.findFirstWelcomeNodeIndex=function(e){for(var t=e.length-1;t>=0;){if(0===t&&e[t].ui_state.isLatestWelcomeNode)return t;if(t>0&&!e[t-1].ui_state.isLatestWelcomeNode)return t;t--}return e.length-1},t.prototype.getLastOutputMessageElements=function(){var e,t=this.props,n=t.localItems,r=t.allMessagesByID,a=(0,jr.MF)(n),o=r[null==a?void 0:a.fullMessageID];if((0,mn.Ew)(o)){for(var s=null==a?void 0:a.ui_state.partOfMessageID,i=[],l=!1,c=this.messageRefs.length-1;c>=0;c--)if((0,this.messageRefs[c].getLocalMessage)().ui_state.partOfMessageID===s){l=!0;var u=null===(e=this.messageRefs[c].ref)||void 0===e?void 0:e.current;if(!u)break;i.push(u)}else if(l)break;return i.reverse()}return[]},t.prototype.shouldShowBotMarker=function(e,t){return e.ui_state.id===t&&e.item.response_type!==Gr.hN.INLINE_ERROR&&!(0,mn.E6)(e)},t.prototype.renderTypingIndicator=function(e){return r.createElement("div",{className:"WAC__message WAC__message--lastMessage"},r.createElement("div",{className:"WAC__message--padding"},e&&r.createElement(Vt,{message:e}),r.createElement("div",{className:"WAC__bot-message"},r.createElement(ko,{invisible:!0}),r.createElement("div",{className:"WAC__received--loading WAC__message-vertical-padding"},r.createElement(na,null)))))},t.prototype.renderMessage=function(e,t,n,a,o,s,i,l,c,u){var d,m=this,p=this.props,f=p.agentState,h=p.serviceManager,g=p.config,v=p.languagePack,_=p.requestInputFocus,C=p.toolingType,E=p.persistedToBrowserStorage,A=p.botName,S=p.featureSet,y=p.messageState,b=p.uiCustomizationConfig,N=p.alternateSuggestionsState,W=p.locale,T=y.isTypingCounter,w=E.chatState.disclaimersAccepted;if((null===(d=g.public.disclaimer)||void 0===d?void 0:d.isOn)&&!w[window.location.hostname])return null;var I=this.props.localItems.length+(T>0?1:0),R=n===I-1,M=q()({"WAC__message--firstMessage":0===n,"WAC__message--lastMessage":R,"WAC__message--suggestionsPadding":R&&N.config.is_on&&!E.chatState.agentState.isConnected}),O=r.createElement(r.Fragment,null,r.createElement(Lo,{re},className:M,isLatestWelcomeNodesActive:a,config:g,localMessage:e,originalMessage:t,languagePack:v,requestInputFocus:_,serviceManager:h,toolingType:C,messagesIndex:n,agentState:f,persistedAgentState:E.chatState.agentState,botName:A,disableUserInputs:o,isMostRecentMessage:c,showBotMarker:s,showTimestamp:i,featureSet:S,requestMoveFocus:this.requestMoveFocus,uiCustomizationConfig:b,doAutoScroll:this.doAutoScroll,scrollElementIntoView:this.scrollElementIntoView,isFirstMessageItem:u,locale:W}));return l?r.createElement(ta,{welcomeNodeBeforeElement:h.writeableElements[$e.Y6.WELCOME_NODE_BEFORE_ELEMENT],key:n},O):r.createElement(r.Fragment,{key:n},O)},t.prototype.renderAgentBanner=function(){var e=this.props,t=e.agentState,n=e.onEndAgentChat,a=e.persistedToBrowserStorage;return t.isConnecting||a.chatState.agentState.isConnected?r.createElement(Xr,{ref:this.agentBannerRef,onButtonClick:n}):null},t.prototype.renderScrollHandle=function(e){var t,n=this,a=this.props.languagePack;t=P.q$?e?"messages_scrollHandle":"messages_scrollHandleEnd":e?"messages_scrollHandleDetailed":"messages_scrollHandleEndDetailed";var o=P.q$?void 0:function(){return n.requestMoveFocus(e?Po.FIRST:Po.LAST,0)};return r.createElement("button",{type:"button",className:"WACMessages--scrollHandle",ref:this.scrollHandleRef,tabIndex:0,"aria-label":a[t]||a.messages_scrollHandle,onClick:o,onFocus:function(){return n.setState({scrollHandleHasFocus:!0})},onBl)}})},t.prototype.isMostRecentWelcomeNodeFirstMessage=function(e){var t=this.props.localItems[e];return t.ui_state.isLatestWelcomeNode&&t.ui_state.partOfMessageID===t.ui_state.id},t.prototype.getLastGroupMessageIDSafeForUserInput=function(){for(var e,t=this.props,n=t.localItems,r=t.allMessagesByID,a=n.length-1;a>=0;a--){var o=n[a],s=r[o.fullMessageID];if((0,mn.gJ)(s)&&(null===(e=null==s?void 0:s.history)||void 0===e?void 0:e.error_state)!==zr.H.FAILED)return null;if((0,mn.Ew)(s))return o.ui_state.partOfMessageID}return null},t.prototype.renderMessages=function(e,t,n,r,a){for(var o=this.props,s=o.localItems,i=o.allMessagesByID,l=o.inputState,c=o.config.public.enableMessageTimestamps,u=[],d=null,m=e;m<s.length;m++){var p=s[m-1],f=s[m],h=i[f.fullMessageID];if(t&&f.ui_state.isLatestWelcomeNode)break;var g=r===f.ui_state.partOfMessageID,v=this.shouldShowBotMarker(f,a),_=this.isMostRecentWelcomeNodeFirstMessage(m),C=d!==f.ui_state.partOfMessageID,E=c&&(null==p?void 0:p.fullMessageID)!==f.fullMessageID;d=f.ui_state.partOfMessageID,u.push(this.renderMessage(f,h,m,n,l.isReadonly,v,E,_,g,C))}return u},t.prototype.render=function(){var e=this,t=this.props,n=t.localItems,a=t.messageState,o=t.intl,s=t.botName,i=t.serviceManager,l=t.allMessagesByID,c=t.persistedToBrowserStorage.chatState.agentState.isConnected,u=a.isTypingCounter,d=this.state.scrollHandleHasFocus,m=n[n.length-1];this.messageRefs.length=n.length;var p,f=(0,jr.dF)(n,(function(e){return!(0,mn.gJ)(l[e.fullMessageID])})),h=null==f?void 0:f.ui_state.partOfMessageID,g=this.getLastGroupMessageIDSafeForUserInput(),v=!(0,mn.E6)(n[0])&&(null==m?void 0:m.ui_state.isLatestWelcomeNode),_=this.renderMessages(0,v,!1,g,h),C=null;if(_.length!==n.length&&(C=this.renderMessages(_.length,!1,!0,g,h)),u){var E=c?"messages_agentIsTyping":"messages_botIsTyping";p=o.formatMessage({id:E},{botName:s})}return r.createElement("div",{id:"WACMessages--holder".concat(i.namespace.suffix),className:"WACMessages--holder"},this.renderAgentBanner(),r.createElement("div",{className:q()("WACMessages__Wrapper",{"WACMessages__Wrapper--scrollHandleHasFocus":d})},r.createElement("div",{id:"WAC__messages".concat(i.namespace.suffix),className:"WAC__messages",ref:this.messagesContainerWithScrollingRef,onScro)},role:"list"},this.renderScrollHandle(!0),_,C&&C.length>0&&r.createElement("div",{className:q()("WACMessage--welcome",{"WACMessage--welcome--typing":u})},C,u>0&&this.renderTypingIndicator(p)),u>0&&!C&&this.renderTypingIndicator(p),this.renderScrollHandle(!1))),!c&&r.createElement(Qr,null))},t}(r.PureComponent),Uo=(Fo=(0,o.$j)((function(e){return e}),null,null,{forwardRef:!0})(Ho),r.forwardRef((function(e,t){var n=(0,r.useContext)(d);return r.createElement(Fo,qr({},e,{ref:t,serviceManager:n}))})));function Vo(e){var t=e.progress,n=void 0===t?0:t,a=(x(n)||0)<=n;return r.createElement("div",{className:"WAC__SentMessageProgress"},a&&r.createElement("div",{className:"WAC__SentMessageProgress_Bar",style:{width:"".concat(n,"%")}}))}var Zo=function(){var e=function(t,n){return e=h()||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),qo=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={showEndChatConfirmation:!1,hasCaughtError:!1},t.inputRef=r.createRef(),t.headerRef=r.createRef(),t.messagesRef=r.createRef(),t.messagesToArray=nn(),t.hideConfirmEndChat=function(){t.setState({showEndChatConfirmation:!1}),setTimeout((function(){t.requestInputFocus()}))},t.showConfirmEndCh)},t.confirmAgentEndChat=function(){t.hideConfirmEndChat(),t.props.serviceManager.humanAgentService.endChat(!0)},t.requestDefaultFocus=function(){var e,n,r;(null===(n=null===(e=t.headerRef)||void 0===e?void 0:e.current)||void 0===n?void 0:n.requestFocus())||(0,S.OP)(null===(r=t.messagesRef.current)||void 0===r?void 0:r.scrollHandleRef)},t.requestInputFocus=function(){if(!t.props.agentState.isConnecting&&!t.props.agentState.isReconnecting||!t.messagesRef.current.requestAgentBannerFocus())if(t.inputRef.current)if(t.props.inputState.fieldVisible&&!t.shouldDisableInput())t.inputRef.current.takeFocus();else{var e=t.messagesRef.current.getLastOutputMessageElements();(0,S.rG)(e)||t.requestDefaultFocus()}else t.requestDefaultFocus()},t.doAutoScro)},t.onFilesSelectedForUpload=function(e){var n=t.props.agentState.serviceDeskCapabilities;t.props.persistedAgentState.isConnected&&(t.props.serviceManager.humanAgentService.filesSelectedForUpload(e),n.allowMultipleFileUploads||t.requestInputFocus())},t}return Zo(t,e),t.prototype.componentDidUpdate=function(e){var t=this.props,n=t.isHydrationAnimationComplete,r=t.agentState;n&&!e.isHydrationAnimationComplete&&this.doAutoScroll(this.props.config.public.__ibm__.disableInitialScroll);var a=r.isConnecting!==e.agentState.isConnecting;this.state.showEndChatConfirmation&&a&&this.hideConfirmEndChat()},t.prototype.componentDidCatch=function(e,t){this.props.serviceManager.actions.errorOccurred((0,Le.gV)("Chat",e,t)),this.setState({hasCaughtError:!0})},t.prototype.doScrollToMessage=function(e,t){var n;void 0===t&&(t=!0),null===(n=this.messagesRef.current)||void 0===n||n.doScrollToMessage(e,t)},t.prototype.getMessageInput=function(){var e;return null===(e=this.inputRef.current)||void 0===e?void 0:e.getMessageInput()},t.prototype.shouldDisableInpg},t.prototype.shouldDisableSend=function(){var e=this.props.isHydrated;return this.shouldDisableInput()||!e},t.prototype.renderMessagesAndInput=function(){var e,t,n=this.props,a=n.languagePack,o=n.toolingType,s=n.messageState,i=n.intl,l=n.allMessageItemsByID,c=n.isHydrated,u=n.sentMessagePercentage,d=n.serviceManager,m=n.inputState,p=n.onUserTyping,f=n.agentState,h=n.botName,g=n.onSendInput,v=n.persistedAgentState,_=n.locale,C=m.fieldVisible,E=m.files,A=f.isConnecting,S=f.isReconnecting,y=f.serviceDeskCapabilities,b=f.fileUploadInProgress,N=v.isConnected,W=y.allowFileUploads,T=y.allowedFileUploadTypes,w=y.allowMultipleFileUploads;A?t=a.agent_inputPlaceholderConnecting:S&&(t=a.agent_inputPlaceholderReconnecting);var I=N&&W,R=((null!==(e=null==E?void 0:E.length)&&void 0!==e?e:0)>0||b)&&!w;return r.createElement(r.Fragment,null,c&&r.createElement("div",{className:"WACMessagesContainer__NonInputContainer"},r.createElement(Uo,{ref:this.messagesRef,messageState:s,localItems:this.messagesToArray(s.localMessageIDs,l),requestInputFocus:this.requestInputFocus,toolingType:o,botName:h,intl:i,onEndAgentChat:this.showConfirmEndChat,locale:_}),r.createElement(Vo,{progress:u})),r.createElement(Ot,{id:"beforeInputElement".concat(d.namespace.suffix),className:"ibm-web-chat--reset-styles",element:d.writeableElements[$e.Y6.BEFORE_INPUT_ELEMENT]}),r.createElement(Hr,{ref:this.inputRef,languagePack:a,serviceManager:d,disableInput:this.shouldDisableInput(),disableSend:this.shouldDisableSend(),isInputVisible:C||N,onSendInput:g,onUserTyping:p,showUploadButton:I,disableUploadButton:R,allowedFileUploadTypes:T,allowMultipleFileUploads:w,pendingUploads:E,onFilesSelectedForUpload:this.onFilesSelectedForUpload,placeholder:t}),this.state.showEndChatConfirmation&&r.createElement(Ur,{onConfirm:this.confirmAgentEndChat,onCancel:this.hideConfirmEndChat}),this.props.agentState.showScreenShareRequest&&r.createElement(Zr,null))},t.prototype.render=function(){var e=this.props,t=e.serviceManager,n=e.languagePack,a=e.onClose,o=e.onCloseAndRestart,s=e.onRestart,i=e.config,l=e.onToggleHomeScreen,c=e.botName,u=this.state.hasCaughtError,d="WAC ".concat(i.public.agentAppConfig.is_on?"WACAgentApp":"");return r.createElement("div",{className:d},r.createElement(Qt,{ref:this.headerRef,requestInputFocus:this.requestInputFocus,onClose:a,onCloseAndRestart:o,onRestart:s,botName:c,onToggleHomeScreen:l,includeWriteableElement:!0}),r.createElement("div",{className:"WAC__ChatNonHeaderContainer"},u&&r.createElement("div",{className:"WAC__MessagesErrorHandler"},r.createElement(en,{serviceManager:t,languagePack:n,onRestart:s,showHeader:!1,botName:c,catastrophicErrorType:M.Th.FAILED})),!u&&r.createElement("div",{className:"WAC__messagesAndInputContainer"},this.renderMessagesAndInput()),r.createElement(Wr,{requestInputFocus:this.requestInputFocus}),r.createElement(zo,null)),r.createElement(on,null))},t}(r.Component);function zo(){return(0,o.v9)((function(e){return e.showNonHeaderBackgroundCover}))?r.createElement("div",{className:"WACBackgroundCover"}):null}var Go=(0,l.ZP)(qo,{forwardRef:!0});function jo(e,t){var n=e.onClose,a=(0,r.useRef)();return(0,r.useImperativeHandle)(t,(function(){return a.current})),r.createElement($t,{ref:a,onClickClose:n})}var Ko,Yo,$o=r.memo((0,r.forwardRef)(jo)),Xo=function(e){var t=e.languagePack,n=e.onAcceptDisclaimer,a=e.onClose,o=e.disclaimerHTML,s=e.disclaimerAcceptButtonRef;return e.publicConfig,r.createElement("div",{className:"WACDisclaimerContainer"},r.createElement("div",{className:"WAC__disclaimer"},r.createElement($o,{onClose:a}),r.createElement("div",{className:"WAC__disclaimer-content"},r.createElement("h1",{className:"WAC__disclaimer-title"},t.disclaimer_title),r.createElement(St.p,{className:"WAC__disclaimer-description",html:o})),r.createElement("div",{className:"WAC__disclaimer-buttons"},r.createElement("button",{type:"button",ref:s,onClick:n,className:"WAC__button--base WAC__button--round"},t.disclaimer_accept),r.createElement("button",{type:"button",onClick:a,className:"WAC__button--base WAC__button--round"},t.disclaimer_decline))))};!function(e){e.NONE="none",e.FADE_IN="fadeIn",e.SLIDE_IN_FROM_LEFT="slideInFromLeft",e.SLIDE_IN_FROM_RIGHT="slideInFromRight",e.SLIDE_IN_FROM_BOTTOM="slideInFromBottom",e.BRANDING_SLIDE_IN_FROM_BOTTOM="brandingSlideInFromBottom"}(Ko||(Ko={}"}(Yo||(Yo={}));var Jo,Qo,es=function(){var e=function(t,n){return e=h()||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}("}(Qo||(Qo={}));var ts=((Jo={})[Qo.BRANDING]=105,Jo[Qo.DISCLAIMER]=99,Jo[Qo.CUSTOM]=95,Jo[Qo.PANEL_RESPONSE]=94,Jo[Qo.SHOW_PANEL]=93,Jo[Qo.HYDRATING]=90,Jo[Qo.CATASTROPHIC]=80,Jo[Qo.HOME_SCREEN]=30,Jo[Qo.AGENT]=20,Jo[Qo.IFRAME]=5,Jo),ns=450,rs=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isClosing:!1,isOpening:!1},t.openPanelTimeout=null,t.closePanelTimeout=null,t.openPanel=function(){var e=t.props,n=e.onOpenEnd,r=e.onOpenStart,a=e.animationOnOpen,o=e.animationDurationOpen;null==r||r(),t.setState({isClosing:!1,isOpening:!0});var s=a===Ko.NONE?0:o||ns;t.openPanelTimeout=(0,P.Ac)((function(){t.setState({isClosing:!1,isOpening:!1}),null==n||n()}),s)},t.closePanel=function(){var e=t.props,n=e.onCloseEnd,r=e.onCloseStart,a=e.animationOnClose,o=e.animationDurationClose;null==r||r(),t.setState({isClosing:!0,isOpening:!1});var s=a===Yo.NONE?0:o||ns;t.closePanelTimeout=(0,P.Ac)((function(){t.setState({isClosing:!1,isOpening:!1}),null==n||n()}),s)},t}return es(t,e),t.prototype.componentDidMou)},t.prototype.componentDidUpdate=function(e){var t=this.props.shouldOpen;t!==e.shouldOpen&&(t?this.openPanel():this.closePanel())},t.prototype.getStyleObject=function(){var e=this.props,t=e.overlayPanelName,n=e.shouldHide,r={zIndex:ts[t]};return n&&(r.display="none"),r},t.prototype.componentWillUnmount=function(){this.openPanelTimeout&&clearTimeout(this.openPanelTimeout),this.closePanelTimeout&&clearTimeout(this.closePanelTimeout),this.props.shouldOpen&&(this.props.onCloseStart&&this.props.onCloseStart(),this.props.onCloseEnd&&this.props.onCloseEnd())},t.prototype.render=function(){var e,t=this.props,n=t.children,a=t.className,o=t.shouldOpen,s=t.animationOnClose,i=t.animationOnOpen,l=this.state,c=l.isClosing,u=l.isOpening,d=this.getStyleObject();return r.createElement(Ie,{hidden:!c&&!o,className:q()("WAC__overlay-panel".concat(a?" ".concat(a):""),(e={},e["WAC__overlay-panel--closing--".concat(s)]=c,e["WAC__overlay-panel--closed"]=!c&&!o,e["WAC__overlay-panel--opening--".concat(i)]=u,e["WAC__overlay-panel--open"]=!u&&o,e)),style:d},n)},t}(r.PureComponent);function as(e,t){var n=e.onClose,a=e.onRestart,s=e.onToggleHomeScreen,i=e.onCloseAndRestart,l=D(),c=(0,o.v9)((function(e){return e.config.public.showRestartButton})),u=(0,o.v9)((function(e){return e.persistedToBrowserStorage.chatState.homeScreenState})),d=(0,r.useRef)();(0,r.useImperativeHandle)(t,(function(){return d.current}));var m=r.createElement("div",null,l.homeScreen_returnToAssistant),p=Boolean(u.showBackToBot),f=!p;return r.createElement("div",{className:"WACHomeScreenHeader"},r.createElement($t,{ref:d,showBackButton:p,showRestartButton:c,hideCloseAndRestartButton:f,backContent:m,onClickRestart:a,onClickClose:n,onClickBack:s,onCloseAndRestart:i,backButtonType:"secondary"}))}var os=r.memo((0,r.forwardRef)(as));function ss(e){var t,n,a=e.botName,o=e.botAvatarURL,s=e.homeScreenConfig,i=e.homeScreenMessageInputRef,l=e.onStarterClick,u=e.onSendInput,d=e.isHydrated,p=e.isVisible,f=e.onClose,h=e.onCloseAndRestart,g=e.onRestart,v=e.onToggleHomeScreen,_=(0,c.Z)(),C=D(),E=m(),A=(0,r.useState)(!1),S=A[0],y=A[1],b=E.writeableElements[$e.Y6.HOME_SCREEN_AFTER_STARTERS_ELEMENT].hasChildNodes(),N=(0,r.useState)(b),W=N[0],T=N[1],w=(0,r.useRef)(null),I=(0,r.useRef)(null),R=s.greeting,M=s.starters,O=s.bot_avatar_url,k=(null==M?void 0:M.is_on)&&Boolean(null===(n=M.buttons)||void 0===n?void 0:n.length),P=E.namespace.suffix,B=P?"--".concat(P):"",L=O||o,x=_.formatMessage({id:"header_ariaBotAvatar"},{botName:a});return(0,r.useEffect)((function(){if(W&&p){var e=I.current,t=w.current,n="".concat(e.clientHeight,"px");t.style.setProperty("--WatsonAssistantChat-HOME_SCREEN_MODERN-input-wrapper-height",n),T(!1)}}),[W,p]),r.createElement("div",{className:q()("WACHomeScreenModern",{"WACHomeScreenModern--hydrationComplete":d}),ref:w},r.createElement(os,{onRestart:g,onClose:f,onToggleHomeScreen:v,onCloseAndRestart:h}),r.createElement(Ot,{id:"homeScreenHeaderBottomElement".concat(E.namespace.suffix),element:E.writeableElements[$e.Y6.HOME_SCREEN_HEADER_BOTTOM_ELEMENT]}),r.createElement("div",{className:"WACHomeScreenModern__content"},r.createElement("div",{className:q()("WACHomeScreenModern__bodyWrapper",{"WACHomeScreenModern__bodyWrapper--padding":!b})},r.createElement("div",{className:q()("WACHomeScreenModern__body",{"WACHomeScreenModern__body--fill":!b})},L&&!S&&r.createElement("div",{className:"WACHomeScreenModern__avatarHolder"},r.createElement("img",{className:"WACHomeScreenModern__botAvatar",src:L,alt:x,onErr)}})),r.createElement("div",{className:q()("WACHomeScreenModern__initialContent",{"WACHomeScreenModern__initialContent--withContent":b})},r.createElement("div",{className:"WACHomeScreenModern__greeting"},R),k&&r.createElement("div",{className:"WACHomeScreenModern__starters"},me()(t=M.buttons).call(t,(function(e,t){var n;return r.createElement(Y.Z,{key:t,id:_t()(n="WACHomeScreenModern__starter-".concat(t)).call(n,B),className:"WACHomeScreenModern__starter",onCli)}},e.label)}))))),r.createElement("div",{className:q()("WACHomeScreenModern__customContent",{"WACHomeScreenModern__customContent--animation":b})},r.createElement(Ot,{id:"homeScreenAfterStartersElement".concat(E.namespace.suffix),element:E.writeableElements[$e.Y6.HOME_SCREEN_AFTER_STARTERS_ELEMENT]}))),r.createElement("div",{className:q()("WACHomeScreenModern__inputContainerWrapper",{"WACHomeScreenModern__inputContainerWrapper--background":!b,"WACHomeScreenModern__inputContainerWrapper--floating":b}),ref:I},r.createElement(Ot,{id:"homeScreenBeforeInputElement".concat(E.namespace.suffix),element:E.writeableElements[$e.Y6.HOME_SCREEN_BEFORE_INPUT_ELEMENT]}),r.createElement("div",{className:"WACHomeScreenModern__inputContainerPadding"},r.createElement("div",{className:"WACHomeScreenModern__inputContainer"},r.createElement(Hr,{ref:i,onSendInput:u,disableInput:!1,isInputVisible:!0,disableSend:!1,inputType:"homeScreenModern",languagePack:C,serviceManager:E}))))))}var is=r.memo(ss);function ls(e){var t=e.onClose,n=e.onCloseAndRestart,a=e.onPanelCloseStart,s=e.onPanelOpenStart,i=e.onSendBotInput,l=e.onSendButtonInput,c=e.onRestart,u=e.showHomeScreen,d=e.isHydrationAnimationComplete,p=e.homeScreenInputRef,f=e.onToggleHomeScreen,h=m(),g=(0,o.v9)((function(e){return e.homeScreenConfig})),v=(0,o.v9)((function(e){return e.botAvatarURL})),_=(0,o.v9)((function(e){return e.botName})),C=(0,o.v9)((function(e){return e.brandingState.isOpen})),E=(0,o.v9)((function(e){return e.customPanelState.isOpen})),A=C||E,S=(0,r.useCallback)((function(e){h.trackService.track({eventName:"Home screen input message sent",eventDescription:"The user sent a query by using the input field on the home screen"}),i(e,{additionalInputOptions:{restart:!0}})}),[i,h]),y=(0,r.useCallback)((function(e){h.trackService.track({eventName:"Home screen starter button sent",eventDescription:"The user sent a query by using one of the conversation starters on the home screen"}),l({label:e.label,value:{input:{text:e.label}}},cn.XF)}),[l,h]);return r.createElement(rs,{onOpenStart:s,onCloseStart:a,animationOnOpen:Ko.NONE,animationOnClose:Yo.FADE_OUT,shouldOpen:u,shouldHide:A,serviceManager:h,overlayPanelName:Qo.HOME_SCREEN},r.createElement(is,{isVisible:u,botName:_,botAvatarURL:v,isHydrated:d,homeScreenMessageInputRef:p,homeScreenConfig:g,onSendInput:S,onStarterClick:y,onClose:t,onCloseAndRestart:n,onRestart:c,onToggleHomeScreen:f}))}function cs(e){var t,n=e.onClose,a=e.languagePack,o=e.isHydrated,s=e.botName,i=e.useHomeScreenVersion,l=(0,r.useContext)(Te);return t=i?r.createElement(os,{onClose:n}):r.createElement(Qt,{onClose:n,botName:s,onToggleHomeScreen:null,includeWriteableElement:!1}),r.createElement(r.Fragment,null,t,r.createElement("div",{className:q()("WAC__hydrating",{"WAC__hydrating--homeScreen":i})},!l&&r.createElement(Me,{delay:1500},!o&&r.createElement(Se,{announceOnce:a.window_ariaWindowLoading}),r.createElement(kn,{"aria-label":a.window_ariaWindowLoading}))))}var us=function(){return us=i()||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},us.apply(this,arguments)};function ds(e,t){var n=e.className,a=e.children,s=e.isOpen,i=e.hidePanelHeader,l=e.labelBackButton,c=e.title,u=e.hideBackButton,d=e.eventName,p=e.eventDescription,f=e.onClickCloseAndRestartn}(e,["className","children","isOpen","hidePanelHeader","labelBackButton","title","hideBackButton","eventName","eventDescription","onClickCloseAndRestart"]),g=m(),v=(0,o.v9)((function(e){return e.config.public.showRestartButton})),_=(0,r.useRef)();return(0,r.useImperativeHandle)(t})),(0,r.useEffect)((function(){s&&d&&g.trackService.track({eventName:d,eventDescription:p})}),[p,d,s,g]),r.createElement(Et(),{active:s,focusTrapOptions:{clickOutsideDeactivates:!0,returnFocusOnDeactivate:!P.q$,preventScroll:!0}},r.createElement("div",{className:q()(n)},!i&&r.createElement($t,us({},h,{ref:_,showRestartButton:v,onCloseAndRestart:f,showBackButton:!u,labelBackButton:l,displayName:c,showCenter:!0})),a))}var ms=r.memo(r.forwardRef(ds));function ps(e){var t,n=e.isOpen,a=e.isMostRecentMessage,s=e.localMessageItem,i=e.eventName,l=e.eventDescription,c=e.overlayPanelName,u=e.className,d=e.title,p=e.requestFocus,f=e.onClickBack,h=e.onClose,g=e.onCloseAndRestart,v=e.onPanelOpenEnd,_=e.onPanelCloseEnd,C=e.onPanelOpenStart,E=e.onPanelCloseStart,A=m(),S=(0,o.v9)((function(e){return e.allMessagesByID[null==s?void 0:s.fullMessageID]})),y=!(null===(t=e.showAnimations)||void 0===t||t),b=y?Ko.NONE:Ko.SLIDE_IN_FROM_RIGHT,N=y?Yo.NONE:Yo.SLIDE_OUT_TO_RIGHT;return r.createElement(rs,{onOpenStart:C,onOpenEnd:v,onCloseStart:E,onCloseEnd:_,animationOnOpen:b,animationOnClose:N,shouldOpen:n,serviceManager:A,overlayPanelName:c},r.createElement(ms,{className:u,eventName:i,eventDescription:l,isOpen:n,title:d,disableAnimation:y,onClickBack:f,onClickClose:h,onClickCloseAndRestart:g},S&&r.createElement(Oa,{localMessageItem:s,fullMessage:S,isMostRecentMessage:a,requestFocus:p})))}var fs=n(15636);function hs(e){var t=e.onPanelOpenEnd,n=e.onPanelCloseEnd,a=e.onPanelOpenStart,s=e.onPanelCloseStart,i=e.onClose,l=e.onCloseAndRestart,c=D(),u=(0,o.v9)((function(e){return e.customPanelState})),d=u.isOpen,p=u.options,f=p.title,h=p.hidePanelHeader,g=p.disableDefaultCloseAction,v=p.disableAnimation,_=p.onClickBack,C=p.onClickClose,E=p.onClickCloseAndRestart,A=m(),S=Q(),y=x(d),b=A.customPanelManager.getPanel().hostElement,N=v?Ko.NONE:Ko.SLIDE_IN_FROM_RIGHT,W=v?Yo.NONE:Yo.SLIDE_OUT_TO_RIGHT;(0,r.useEffect)((function(){y!==d&&d&&!h&&f&&S(f)}),[S,h,d,y,f]);var T=(0,r.useCallback)((function(){A.store.dispatch(F.ZP.setCustomPanelOpen(!1)),null==_||_()}),[A,_]),w=(0,r.useCallback)((function(){g||(gs(A.store.getState().viewChanging),i()),null==C||C()}),[g,C,i,A]),I=(0,r.useCallback)((function(){g||(gs(A.store.getState().viewChanging),l()),null==E||E()}),[g,E,l,A]);return r.createElement(rs,{onOpenStart:function(){A.eventBus.fire({type:O.re.CUSTOM_PANEL_PRE_OPEN},A.instance),a()},onOpenEnd:function(){A.eventBus.fire({type:O.re.CUSTOM_PANEL_OPEN},A.instance),t()},onCloseStart:function(){A.eventBus.fire({type:O.re.CUSTOM_PANEL_PRE_CLOSE},A.instance),s()},onCloseEnd:function(){A.eventBus.fire({type:O.re.CUSTOM_PANEL_CLOSE},A.instance),n(),A.store.dispatch(F.ZP.setCustomPanelConfigOptions(fs.iV))},animationOnOpen:N,animationOnClose:W,shouldOpen:d,serviceManager:A,overlayPanelName:Qo.CUSTOM,className:"WACCustomPanelOverlay"},r.createElement(ms,{className:"WACCustomPanel",eventName:"Custom panel opened",eventDescription:"A user opened a custom panel.",labelBackButton:c.general_ariaAnnounceEscapeOverlay,isOpen:d,title:f,onClickBack:T,onClickClose:w,onClickCloseAndRestart:I,hidePanelHeader:h,hideBackButton:p.hideBackButton,hideCloseButton:p.hideCloseButton,hideCloseAndRestartButton:p.hideCloseAndRestartButton},r.createElement(Ot,{className:"ibm-web-chat--reset-styles WACCustomPanel__ContentContainer",element:b})))}function gs(e){if(e){var t="You are attempting to close web chat from a custom panel while web chat is currently running a view change event which is not permitted. Please use the disableDefaultCloseAction option to disable this behavior for the custom panel and then use onClickClose to resolve your Promise that is handling the event; that Promise will allow you to close web chat.";throw(0,Le.N6)(t),new Error(t)}}var vs=r.memo(hs),_s=function(){return _s=i()||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},_s.apply(this,arguments)};function Cs(e,t){var n=D(),a=m().store,s=(0,o.v9)((function(e){return e.iFramePanelState})),i=s.isOpen,l=s.messageItem,c=(null==l?void 0:l.title)||(null==l?void 0:l.source);return r.createElement(ms,_s({},e,{ref:t,className:"WACIFramePanel",isOpen:i,onClickBa)},title:c,labelBackButton:n.iframe_ariaClosePanel,eventName:"IFrame panel opened",eventDescription:"A user has opened the IFrame panel"}),r.createElement("div",{className:"WACIFramePanel__Content"},r.createElement(ho,{key:null==l?void 0:l.source,source:null==l?void 0:l.source,title:c})))}var Es=r.memo((0,r.forwardRef)(Cs)),As=n(33590),Ss=function(e,t,n){if(n||2===arguments.length)for(var r,a=0,o=t.length;a<o;a++)!r&&a in t||(r||(r=gt()(Array.prototype).call(t,0,a)),r[a]=t[a]);return _t()(e).call(e,r||gt()(Array.prototype).call(t))},ys=function(){var)};retu)}}(),bs=function(){return bs=i()||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},bs.apply(this,arguments)},)},}},Ts=function(e,t,n){if(n||2===arguments.length)for(var r,a=0,o=t.length;a<o;a++)!r&&a in t||(r||(r=gt()(Array.prototype).call(t,0,a)),r[a]=t[a]);return _t()(e).call(e,r||gt()(Array.prototype).call(t))},ws=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={closing:!1,open:t.props.persistedToBrowserStorage.launcherState.viewState.mainWindow,modalPortalHostElement:null,numPanelsOpen:0,numPanelsAnimating:0,isHydrationAnimationComplete:t.props.isHydrated,shouldAutoFocus:t.props.config.public.shouldTakeFocusIfOpensAutomatically,extraClassNames:[]},t.mainWindowRef=r.createRef(),t.containerRef=r.createRef(),t.botChatRef=r.createRef(),t.processChatRef=r.createRef(),t.homeScreenInputRef=r.createRef(),t.disclaimerRef=r.createRef(),t.brandingRef=r.createRef(),t.animationContainerRef=r.createRef(),t.iframePanelRef=r.createRef(),t.previousBodyStyle=void 0,t.onVisualViewportResize=function(){t.updateFromVisualViewport()},t.updateFromVisualViewport=function(){var e=t.props.wacContainerElement,n=window.visualViewport;if(n)e.style.setProperty("--WatsonAssistantChat-viewport-height","".concat(n.height,"px")),e.style.setProperty("--WatsonAssistantChat-viewport-width","".concat(n.width,"px")),e.style.setProperty("--WatsonAssistantChat-viewport-offsetTop","".concat(n.offsetTop,"px")),e.style.setProperty("--WatsonAssistantChat-viewport-offsetLeft","".concat(n.offsetLeft,"px"));else{var r="100vh";if(P.cj){var a=(0,P.uY)();r="calc(100vh - ".concat(a,"px)")}e.style.setProperty("--WatsonAssistantChat-viewport-height",r),e.style.setProperty("--WatsonAssistantChat-viewport-width","100vw"),e.style.setProperty("--WatsonAssistantChat-viewport-offsetTop","0"),e.style.setProperty("--WatsonAssistantChat-viewport-offsetLeft","0")}},t.setModalPortalHostEleme)},t.onSendInput=function(e,n){return Ns(t,void 0,void 0,(function(){var t,r,a,o,s,i,l;return Ws(this,(function(c){return t=this.props.serviceManager,r=t.store.getState(),a=r.inputState,o=r.persistedToBrowserStorage,s=a.files,o.chatState.agentState.isConnected?t.humanAgentService.sendMessageToAgent(e,s):(i=(0,mn.yj)(e),l={eventName:"Assistant Message Received from User",type:"text"},t.actions.sendWithCatch(i,bs(bs({},n),{trackEventProps:l}))),s.length&&t.store.dispatch(F.ZP.clearInputFiles()),[2]}))}))},t.onSendHomeButtonInput=function(e){var n=(0,mn.aV)(e);t.props.serviceManager.actions.sendWithCatch(n,{trackEventProps:{eventName:"Assistant Message Received from User",type:"text"},additionalInputOptions:{restart:!0}})},t.removeChatFromDom=function(){t.containerRef.current.removeEventListener("animationend",t.removeChatFromDom),t.setState({open:!1,closing:!1})},t.onRestart=function(){return Ns(t,void 0,void 0,(function(){return Ws(this,(function(e){switch(e.label){case 0:return[4,this.props.serviceManager.actions.restartConversation()];case 1:return e.sent(),this.requestFocus(),[2]}}))}))},t.onClose=function(){return Ns(t,void 0,void 0,(function(){return Ws(this,(function(e){return[2,this.doClose(!1)]}))}))},t.onCloseAndRestart=function(){return Ns(t,void 0,void 0,(function(){return Ws(this,(function(e){return[2,this.doClose(!0)]}))}))},t.onToggleHomeScreen=function(){var e={eventName:"Home Screen Toggled",eventDescription:t.props.serviceManager.store.getState().persistedToBrowserStorage.chatState.homeScreenState.isHomeScreenOpen?"User went to the bot.":"User went to the home screen."};t.props.serviceManager.actions.track(e),t.props.serviceManager.store.dispatch(F.ZP.toggleHomeScreen())},t.onClick=function(e){if(t.props.serviceManager.store.getState().featureSet[As.e.MEANINGFUL_CONVERSATION_EVENTS]){var n=t.getMeaningfulConversationEvent(e);if(n){var r=(0,mn.ZY)({name:At.LI,triggered_by:n});t.props.serviceManager.messageService.send(r)}}},t.requestFocus=function(){t.state.shouldAutoFocus&&!P.q$&&(t.getShowBranding()?t.brandingRef.current&&t.brandingRef.current.focus():t.getShowDisclaimer()?t.disclaimerRef.current&&(0,S.OP)(t.disclaimerRef):t.getShowHomeScreen()?t.homeScreenInputRef.current&&t.homeScreenInputRef.current.takeFocus():t.props.iFramePanelState.isOpen?t.iframePanelRef.current&&t.iframePanelRef.current.requestFocus():t.botChatRef.current&&t.botChatRef.current.requestInputFocus())},t.onUserTyping=function(e){t.props.serviceManager.store.getState().persistedToBrowserStorage.chatState.agentState.isConnected&&t.props.serviceManager.humanAgentService.userTyping(e)},t.onAcceptDisclaimer=function(){t.props.serviceManager.store.dispatch(F.ZP.acceptDisclaimer())},t.onPanelOpenStart=function(){t.setStat}}),t.requestFocus)},t.onPanelOpenE)},t.onPanelCloseStart=function(){t.setStat}}),t.requestFocus)},t.onPanelCloseEnd=function(){t.setState((function(e){return{numPanelsOpen:e.numPanelsOpen-1,numPanelsAnimating:e.numPanelsAnimating-1}}))},t.onHydrationPanelClo)},t}return ys(t,e),t.prototype.componentDidMount=function(){var e=this.props.config.public;if(this.props.serviceManager.mainWindow=this,this.props.mainWindowRef.current=this,P.q$&&!e.disableCustomElementMobileEnhancements){var t=window.visualViewport;t&&(t.addEventListener("resize",this.onVisualViewportResize),t.addEventListener("scroll",this.updateFromVisualViewport)),this.updateFromVisualViewport(),this.updateBody(!1)}this.containerRef.current.style.setProperty("--WatsonAssistantChat-scrollbar-width","".concat((0,S.nn)(),"px"))},t.prototype.destroy=function(){if(P.q$&&!this.props.config.public.disableCustomElementMobileEnhancements){var e=window.visualViewport;e&&(e.removeEventListener("resize",this.onVisualViewportResize),e.removeEventListener("scroll",this.updateFromVisualViewport))}this.updateBody(!0)},t.prototype.componentDidUpdate=function(e,t){var n=this,r=this.props,a=r.persistedToBrowserStorage,o=r.useCustomHostElement,s=r.isDestroyed,i=a.launcherState.viewState,l=this.state.open,c=e.persistedToBrowserStorage.launcherState.viewState;i.mainWindow!==c.mainWindow&&(this.updateBody(!1),this.updateFromVisualViewport()),s&&!e.isDestroyed&&this.destroy(),!i.mainWindow||c.mainWindow&&l?!i.mainWindow&&c.mainWindow&&t.open&&l&&(this.setState({closing:!0}),o?this.removeChatFromDom():(this.containerRef.current.addEventListener("animationend",this.removeChatFromDom),this.requestFocus())):this.setState({open:!0,isHydrationAnimationComplete:this.props.isHydrated)})),this.props.config.public.shouldTakeFocusIfOpensAutomatically&&(e.persistedToBrowserStorage.chatState.hasSentNonWelcomeMessage||!this.props.persistedToBrowserStorage.chatState.hasSentNonWelcomeMessage||this.state.shouldAutoFocus?e.botMessageState.localMessageIDs.length>this.props.botMessageState.localMessageIDs.length&&this.state.shouldAutoFocus?this.setState({shouldAutoFocus:!1}):e.botMessageState.localMessageIDs.length<this.props.botMessageState.localMessageIDs.length&&!this.state.shouldAutoFocus&&this.setState({shouldAutoFocus:!0}):this.setState({shouldAutoFocus:!0})),this.props.botMessageState.localMessageIDs.length>e.botMessageState.localMessageIDs.length&&this.requestFocus()},t.prototype.componentDidCatch=function(e,t){this.props.serviceManager.actions.errorOccurred((0,Le.gV)("MainWindow",e,t,!0))},t.prototype.updateBody=function(e){var t;P.cj&&!this.props.config.public.disableCustomElementMobileEnhancements&&((window.screen.width<=500||window.screen.height<=500)&&this.props.persistedToBrowserStorage.launcherState.viewState.mainWindow&&!e?(this.previousBodyStyle=null!==(t=document.body.getAttribute("style"))&&void 0!==t?t:null,document.body.style.setProperty("visibility","hidden","important"),document.body.style.setProperty("position","fixed","important")):void 0!==this.previousBodyStyle&&(null===this.previousBodyStyle?document.body.removeAttribute("style"):document.body.setAttribute("style",this.previousBodyStyle),this.previousBodyStyle=void 0))},t.prototype.doClose=function(e){return Ns(this,void 0,void 0,(function(){var t,n,r;return Ws(this,(function(a){switch(a.label){case 0:return t=this.props.serviceManager,n=t.store.getState().persistedToBrowserStorage.launcherState.activeTour,r={eventName:"Widget Closed",eventDescription:"User has closed the widget.",closeType:e?"Close":"Close and restart"},t.actions.track(r),n&&t.trackService.track({eventName:"Tour interaction",eventDescription:"Tour continued.",type:"From main window minimize button."}),e?[4,t.actions.changeView(M.bW.LAUNCHER,{mainWindowCloseReason:O.yi.MAIN_WINDOW_CLOSED_AND_RESTARTED})]:[3,4];case 1:return a.sent().mainWindow?[3,3]:[4,t.actions.restartConversation()];case 2:a.sent(),a.label=3;case 3:return[3,6];case 4:return[4,t.actions.changeView(n?M.bW.TOUR:M.bW.LAUNCHER,{mainWindowCloseReason:O.yi.DEFAULT_MINIMIZE})];case 5:a.sent(),a.label=6;case 6:return[2]}}))}))},t.prototype.getMeaningfulConversationEvent=function(e){var t=e.target;if(!t.closest)return null;var n=t.closest("a, [".concat($e.oF,"]"));return n?n.hasAttribute($e.oF)?n.getAttribute($e.oF):At.QW.LINK:null},t.prototype.getShowHomeScreen=function(){return this.props.homeScreenConfig.is_on&&this.props.persistedToBrowserStorage.chatState.homeScreenState.isHomeScreenOpen&&!this.getShowDisclaimer()&&!this.getShowBranding()},t.prototype.getShowDisclaimer=function(){var e;return(null===(e=this.props.config.public.disclaimer)||void 0===e?void 0:e.isOn)&&!this.props.persistedToBrowserStorage.chatState.disclaimersAccepted[window.location.hostname]&&!this.getShowBranding()},t.prototype.getShowBranding=function(){return this.props.brandingState.config.is_on&&this.props.brandingState.isOpen},t.prototype.doAutoScroll=function(){var e;(e=this.processChatRef.current?this.processChatRef.current:this.botChatRef.current)&&e.doAutoScroll()},t.prototype.doScrollToMessage=function(e,t){var n;void 0===t&&(t=!0),null===(n=this.botChatRef.current)||void 0===n||n.doScrollToMessage(e,t)},t.prototype.getMessageInput=function(){var e;return null===(e=this.botChatRef.current)||void 0===e?void 0:e.getMessageInput()},t.prototype.getHomeScreenInp)},t.prototype.addClassName=function(e){this.setState(function(e){return function(t){var n;return-1===be()(n=t.extraClassNames).call(n,e)?{extraClassNames:Ss(Ss([],t.extraClassNames,!0),[e],!1)}:null}}(e))},t.prototype.removeClassName=function(e){this.setState(function(e){return function(t){var n;return{extraClassNames:fn()(n=t.extraClassNames).call(e}))}}}(e))},t.prototype.renderChat=function(){var e=this.props.isHydrated;return r.createElement(r.Fragment,null,this.renderCustomPanel(),this.renderHydrationPanel(),e&&r.createElement(r.Fragment,null,this.renderDisclaimerPanel(),this.renderResponsePanel(),this.renderHomeScreenPanel(),this.renderIFramePanel(),this.renderBrandingPanel(),this.renderBotChat()))},t.prototype.renderBotChat=function(){var e,t=this.props,n=t.botName,a=t.languagePack,o=t.config,s=t.serviceManager,i=t.botMessageState,l=t.agentState,c=t.allMessageItemsByID,u=t.sentMessagePercentage,d=t.isHydrated,m=t.inputState,p=t.persistedToBrowserStorage,f=t.locale,h=this.state,g=h.numPanelsAnimating,v=h.numPanelsOpen,_=h.isHydrationAnimationComplete,C=this.getShowDisclaimer();return _?g>0?e=!1:v>0&&(e=!0):e=!0,r.createElement(Ie,{className:"WACBotContainer",hidden:e},r.createElement(Go,{botName:n,ref:this.botChatRef,languagePack:a,config:o,serviceManager:s,toolingType:o.public.__ibm__.toolingType,onClose:this.onClose,onCloseAndRestart:this.onCloseAndRestart,messageState:i,onSendInput:this.onSendInput,agentState:l,persistedAgentState:p.chatState.agentState,allMessageItemsByID:c,sentMessagePercentage:u,onRestart:this.onRestart,isHydrated:d,isHydrationAnimationComplete:_&&!C,inputState:m,onToggleHomeScreen:this.onToggleHomeScreen,onUserTyping:this.onUserTyping,locale:f}))},t.prototype.renderHydrationPanel=function(){var e=this,t=this.props,n=t.isHydrated,a=t.serviceManager,o=t.languagePack,s=t.catastrophicErrorType,i=t.botName,l=t.persistedToBrowserStorage,c=t.homeScreenConfig,u=l.launcherState.viewState,d=c.is_on&&!l.launcherState.hasSentNonWelcomeMessage;return r.createElement(rs,{onOpenStart:this.onPanelOpenStart,onCloseStart:this.onPanelCloseStart,onOpenEnd:this.onPanelOpenEnd,onCloseE)},animationOnOpen:Ko.NONE,animationOnClose:Yo.NONE,shouldOpen:!n&&!s&&u.mainWindow,shouldHide:!1,serviceManager:a,overlayPanelName:Qo.HYDRATING,className:"WACHydrationPanelOverlay"},r.createElement(cs,{botName:i,isHydrated:n,serviceManager:a,onClose:this.onClose,languagePack:o,useHomeScreenVersion:d}))},t.prototype.renderCatastrophicPanel=function(){var e=this.props,t=e.serviceManager,n=e.botName,a=e.languagePack,o=e.catastrophicErrorType;return r.createElement(rs,{animationOnOpen:Ko.NONE,animationOnClose:Yo.NONE,shouldOpen:!0,serviceManager:t,overlayPanelName:Qo.CATASTROPHIC,className:"WACCatastrophicPanelOverlay"},r.createElement(en,{onClose:this.onClose,serviceManager:t,languagePack:a,onRestart:this.onRestart,showHeader:!0,botName:n,catastrophicErrorType:o}))},t.prototype.renderDisclaimerPanel=function(){var e,t,n=this.props,a=n.serviceManager,o=n.languagePack,s=n.config,i=this.getShowDisclaimer();return(null===(e=s.public.disclaimer)||void 0===e?void 0:e.isOn)&&r.createElement(rs,{onOpenStart:this.onPanelOpenStart,onCloseStart:this.onPanelCloseStart,onOpenEnd:this.onPanelOpenEnd,onCloseEnd:this.onPanelCloseEnd,animationOnOpen:Ko.FADE_IN,animationOnClose:Yo.FADE_OUT,shouldOpen:i,serviceManager:a,overlayPanelName:Qo.DISCLAIMER,className:"WACDisclaimerPanelOverlay"},r.createElement(Xo,{onAcceptDisclaimer:this.onAcceptDisclaimer,onClose:this.onClose,languagePack:o,disclaimerHTML:null===(t=s.public.disclaimer)||void 0===t?void 0:t.disclaimerHTML,serviceManager:a,publicConfig:s.public,disclaimerAcceptButtonRef:this.disclaimerRef}))},t.prototype.renderHomeScreenPanel=function(){var e=this.state.isHydrationAnimationComplete,t=this.getShowHomeScreen();return r.createElement(ls,{onPanelOpenStart:this.onPanelOpenStart,onPanelCloseStart:this.onPanelCloseStart,onClose:this.onClose,onCloseAndRestart:this.onCloseAndRestart,onSendBotInput:this.onSendInput,onSendButtonInput:this.onSendHomeButtonInput,onRestart:this.onRestart,showHomeScreen:t,isHydrationAnimationComplete:e,homeScreenInputRef:this.homeScreenInputRef,onToggleHomeScreen:this.onToggleHomeScreen})},t.prototype.renderBrandingPanel=function(){var e=this,t=this.props,n=t.serviceManager,a=t.brandingState,o=a.config,s=a.isOpen;return!o.is_on&&s&&n.store.dispatch(F.ZP.setBrandingOverlayIsOpen(!1)),r.createElement(rs,{onOpenStart:this.onPanelOpenStart,onCloseStart:this.onPanelCloseStart,onOpenEnd:this.onPanelOpenEnd,onCloseEnd:function(){n.store.dispatch(F.ZP.setBrandingBannerShown(!0)),e.onPanelCloseEnd()},animationOnOpen:Ko.BRANDING_SLIDE_IN_FROM_BOTTOM,animationOnClose:Yo.SLIDE_OUT_TO_BOTTOM,shouldOpen:s,serviceManager:n,overlayPanelName:Qo.BRANDING,className:"WACBrandingPanelOverlay"},r.createElement(Tt,{brandingCloseButtonRef:this.brandingRef}))},t.prototype.renderIFramePanel=function(){var e=this.props,t=e.serviceManager,n=e.iFramePanelState;return r.createElement(rs,{onOpenStart:this.onPanelOpenStart,onCloseStart:this.onPanelCloseStart,onOpenEnd:this.onPanelOpenEnd,onCloseEnd:this.onPanelCloseEnd,animationOnOpen:Ko.SLIDE_IN_FROM_RIGHT,animationOnClose:Yo.SLIDE_OUT_TO_RIGHT,shouldOpen:n.isOpen,serviceManager:t,overlayPanelName:Qo.IFRAME,className:"WACIframePanelOverlay"},r.createElement(Es,{ref:this.iframePanelRef,onClickClose:this.onClose,onClickCloseAndRestart:this.onCloseAndRestart}))},t.prototype.renderCustomPanel=function(){return r.createElement(vs,{onClose:this.onClose,onCloseAndRestart:this.onCloseAndRestart,onPanelOpenStart:this.onPanelOpenStart,onPanelOpenEnd:this.onPanelOpenEnd,onPanelCloseStart:this.onPanelCloseStart,onPanelCloseEnd:this.onPanelCloseEnd})},t.prototype.renderResponsePanel=function(){var e=this;if(!this.props.responsePanelState.localMessageItem)return null;var t,n,a,o,s=this.props.responsePanelState,i=s.isOpen,l=s.localMessageItem,c=s.isMostRecentMessage,u=null==l?void 0:l.item,d=(0,mn.pb)(u);return d?(t=null==l?void 0:l.item,n='"panel" response panel opened',a='Panel opened through "show_panel" button type',o=Qo.SHOW_PANEL):(t=(null==l?void 0:l.item).panel,n='"Show panel" opened',a="Panel opened through panel response type",o=Qo.PANEL_RESPONSE),r.createElement(ps,{className:"WACShowPanel",eventName:n,eventDescription:a,overlayPanelName:o,isOpen:i,isMostRecentMessage:c,localMessageItem:l,title:null==t?void 0:t.title,showAnimations:null==t?void 0:t.show_animations,requestFocus:this.requestFocus,onClose:this.onClose,onCloseAndRestart:this.onCloseAndRestart,onClickBack:function(){return e.props.serviceManager.store.dispatch(F.ZP.setResponsePanelIsOpen(!1))},onPanelOpenStart:this.onPanelOpenStart,onPanelOpenEnd:this.onPanelOpenEnd,onPanelCloseStart:this.onPanelCloseStart,onPanelCloseEnd:function(){if(e.onPanelCloseEnd(),e.props.serviceManager.store.dispatch(F.ZP.setResponsePanelContent(null,!1)),d)try{e.props.serviceManager.actions.sendUpdateHistoryEvent(l.fullMessageID,{history:{is_panel_closed:!0}})}catch(e){(0,Le.Pr)("Failed to send event message")}}})},t.prototype.renderWidget=function(){var e=this,t=this.props,n=t.serviceManager,a=t.useCustomHostElement,o=t.locale,s=t.catastrophicErrorType,i=t.brandingState,l=t.config,c=t.isHydrated,u=this.state,d=u.closing,m=u.open,p=u.extraClassNames,f="WACLocale-".concat(o||"en"),h=i.config,g=i.showBanner,v=l.public.__ibm__.disableRoundCorners,_=l.public.enableFocusTrap&&m&&!l.public.hideCloseButton,C=Boolean(_&&c),E=h.is_on&&g;return r.createElement(Et(),{active:C},r.createElement("div",{className:q().apply(void 0,Ts(["WACMainWindow","WACWidget__FocusTrapContainer"],p,!1)),ref:this.mainWindowRef},_&&r.createElement("div",{className:"WACWidget__FocusTrapGlass"}),r.createElement("div",{id:"WACWidget".concat(n.namespace.suffix),className:q()("WACWidget ".concat(f),{"WACWidget--rounded":!v&&!P.vy,"WACWidget--defaultElement":!a,"WACWidget--launched":!d,"WACWidget--closing":d,"WACWidget--closed":!m}),ref:this.containerRef,onClick:this.onClick},s&&this.renderCatastrophicPanel(),!s&&r.createElement(r.Fragment,null,r.createElement("div",{ref:this.animationContainerRef,className:q()("WACWidget__animationContainer",{"WACWidget__animationContainer--withBrandingBanner":E}),onScro)}},this.renderChat()),E&&r.createElement(bt,null)),r.createElement("div",{className:"WACMainWindowModalHost",ref:this.setModalPortalHostElement}))))},t.prototype.rend)},t}(r.Component),Is=(0,o.$je}),null,null,{forwardRef:!0})(ws),)};function Ms(e){var t=e.serviceManager,n=(0,o.v9k})),a=(0,o.I0)(),s=(0,r.useState)({width:window.innerWidth,height:window.innerHeight}),i=s[0],c=s[1];return L((function(){var)};window.addEventListener("resize",e);var t=function(){a(F.ZP.setIsBrowserPageVisible("visible"===document.visibilityState))};return document.addEventListener("visibilitychange",)}})),r.createElement(ft.Provider,{value:i},r.createElement(d.Provider,{value:t},r.createElement(l.zt,{value:t.intl},r.createElement(B.Provider,{value:n},r.createElement(R,null,r.createElement(Os,Rs({},e)))))))}function Os(e){var t=e.useCustomHostElement,n=e.wacContainerElement,a=e.serviceManager,s=(0,o.v9r})),i=(0,o.v9e})).viewState,l=(0,r.useRef)(),u=(0,r.useRef)(),d=i.tour,m=(0,r.useRef)(d);m.current=d||m.current;var p=(0,c.Z)(),f=a.namespace.originalName,h=f?"window_ariaChatRegionNamespace":"window_ariaChatRegion",g=p.formatMessage({id:h},{namespace:f});return L((function(){a.appWindow={requestFocus:function(){var e,t,n=a.store.getState().persistedToBrowserStorage.launcherState.viewState;n.tour?null===(e=l.current)||void 0===e||e.requestFocus():n.mainWindow&&(null===(t=u.current)||void 0===t||t.requestFocus())}}})),r.createElement("div",{className:"WACWidget__regionContainer",role:"region","aria-label":g},r.createElement(Is,{mainWindowRef:u,useCustomHostElement:t,wacContainerElement:n,serviceManager:a}),m.current&&r.createElement(pt,{ref:l}),s&&r.createElement(ae,null))}var ks=r.createContext(null),Ps=n(61431);function Bs(e,t,n,s){var i=e.store,l=i.getState(),c=l.userID,u=l.config;u.public.debug&&(0,Le.j5)("[render] Called render");var d=u.remote.initConfig.service_instance_id||u.public.serviceInstanceID||Ps.iZ,m=e.trackService.getTrackUserID(d,c);a.render(r.createElement(o.zt,{store:i},r.createElement(ks.Provider,{value:{trackUserID:m}},r.createElement(Ms,{useCustomHostElement:t,serviceManager:e,wacContainerElement:s}))),n)}(0,Le.p_)(Bs);var Ds=Bs},93414:function(){},70172:function(){},2001:function(){},33779:function(){},66558:function(){},822{}}]);