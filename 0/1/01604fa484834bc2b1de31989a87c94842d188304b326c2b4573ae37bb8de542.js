//# sourceMappingURL=https://ton.local.twitter.com/responsive-web-internal/sourcemaps/client-web-legacy/bundle.TweetCoinDetails.412cfeda.js.mapn          font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;\n          font-size: 14px;\n          font-weight:500;\n          white-space: nowrap;\n          visibility: hidden;\n          position: absolute;\n          bottom: 0px;\n        ',r.parentNode.appendChild(u);var f=document.createElement("style");f.innerHTML="#fc_frame.fc-launcher-text{width: ".concat(u.offsetWidth+60,"px}"),r.parentNode.appendChild(f),r.parentNode.removeChild(u),r.classList.add("fc-launcher-text")}r.style.bottom="".concat(d||15,"px"),s?(r.classList.add("fc-widget-left"),r.style.left="".concat(c||15,"px")):r.style.right="".concat(c||15,"px")},setWidgetDisplayStyle:function(){var t=document.body,n=document.getElementById(e.frameDivId),i=v.getElementStyle(t,"display");i&&-1!==["flex"].indexOf(i)&&n.style.setProperty("display",i)}}}.bind(void 0)();var b=function(){!function(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}(this,undefined);var e=[],t=!1;return{enque:function(n){t||(void 0===e&&(e=[]),e.push(n))},deque:function(){if(e&&e.length)return e.shift()},toggleLock:function(e){t=e},isLocked:function(){return t},isEmpty:function(){return!e||!e.length}}}.bind(void 0)();var y=function(){!function(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}(this,undefined);var e={};return{subscribe:function(n,i,o){t.isLoaded()||w.isLoaded()&&-1!==w.loadingActions().indexOf("get_user_uuid")?(e[n+"_ack"]=o,w.postMessage({action:n,payload:i})):b.enque({action:n,payload:i,handler:o})},publish:function(t,n){w.dispatch(e[t],{success:n.success,status:n.status,data:n.data})}}}.bind(void 0)(),C=function(e,t){return new Promise((function(n,i){y.subscribe(e,t,(function(e){var t=e&&e.status,o=e&&e.success;200===t||o?n(e):i(e)}))}))},_=function(e,t,n){t&&"function"==typeof t&&(n=t,t=null),y.subscribe(e,t,n)},k=function(e){return!(!e||"function"!=typeof e)};var x=function(){!function(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}(this,undefined);var e={},t=["widget:opened","widget:closed","widget:loaded","dialog:opened","dialog:closed","widget:destroyed","frame:statechange","user:statechange","user:created","user:cleared","user:authenticated","message:sent","message:received","conversation:resolved","unreadCount:notify","push:subscribed","readReceipts:update","csat:received","csat:updated","csat:show","anchorLink:clicked","faq:clicked","download:file","rts:connected","rts:disconnected"];return{clear:function(){e={}},valid:function(e){return!(!e||!t)&&-1!==t.indexOf(e)},subscribe:function(t,n){this.valid(t)&&(void 0===e[t]&&(e[t]=[]),e[t].push(n))},unsubscribe:function(t,n){if(this.valid(t)){var i,o=e&&e[t];if(o)for(var a=0,r=o.length;a<r;a++)if(i=o[a],k(i)&&(!n||i.name===n.name)){e[t].splice(a,1);break}}},publish:function(t,n,i){if(this.valid(t)){var o=e&&e[t];if(o)for(var a=function(e){return function(){n?e(n):e()}},r=0,s=o.length;r<s;r++){var d=a(o[r]);i?setTimeout(d,0):d()}if("function"==typeof window.CustomEvent){var c=new CustomEvent("fwcrm_event_consume",{detail:{name:t,origin:window.origin,args:n}});window.dispatchEvent(c)}}}}}.bind(void 0)();var E=function(){!function(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}(this,undefined);var t=null,n=null,i=null,o=!1,a=null,r=null,s=null;return{isLoaded:function(){return o},loaded:function(e){o=e},getSource:function(){return s},setSource:function(e){s=e},getHost:function(){return t},getHostOrigin:function(){return n},getLogoPath:function(){return i},init:function(e){t=e.host,n=e.hostOrigin,i=e.appLogoPath,a=e.locale,r=e.sales360App,this.load()},reset:function(){t=null,n=null,i=null,a=null,r=null,o=!1,s=null},postMessage:function(e){e.openWindow?window.open(t+"&action="+btoa(e.action)+"&appLogoPath="+btoa(i)+"&locale="+btoa(a)+"&sales360App="+btoa(r),"_blank","toolbar=yes,scrollbars=yes,resizable=yes,top=500,left=500,width=400,height=400"):o&&this.post({action:e.action,payload:e.payload})},post:function(e){s.postMessage(e,n)},add:function(){var n=document,i=n.body,o=n.getElementById(e.pushFrameDivId),a=n.createElement("IFRAME");o&&"DIV"===o.tagName||(o=n.createElement("DIV"),i.appendChild(o)),o.setAttribute("id",e.pushFrameDivId),v.setAttr(a,{id:e.pushFrameId,src:t,title:"Chat",frameborder:"0"}),o.appendChild(a)},load:function(){v.isPushSupportedByBrowser()&&this.add()},unload:function(){v.remove(e.pushFrameDivId),this.reset()}}}.bind(void 0)();var I=function(){!function(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}(this,undefined);var t=function(e){27===e.keyCode&&this.destroy()};return{create:function(n){var i=document,o=i.body,a=i.createElement("DIV"),r=i.createElement("IMG"),s=i.createElement("DIV"),d=i.createElement("DIV");a.setAttribute("id",e.modalDivId),a.onclick=this.destroy,r.setAttribute("src",n),r.onclick=this.destory,d.appendChild(r),d.className="image-cell",s.appendChild(d),s.className="image-wrapper",a.appendChild(s),o.appendChild(a),window.addEventListener?window.addEventListener("keydown",t.bind(this),!1):window.attachEvent("keydown",t.bind(this),!1)},destroy:function(){var n=document,i=n.body,o=n.getElementById(e.modalDivId);o&&(v.purge(o),i.removeChild(o)),window.removeEventListener?window.removeEventListener("keydown",t.bind(this)):window.detachEvent("keydown",t.bind(this))}}}.bind(void 0)();var L=function(){!function(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}(this,undefined);var e={},t="_fc_observer";return{attach:function(n,i,o){var a="".concat(i).concat(t);n[i]&&o&&(void 0===n[a]||n[a]!==o)&&(n[a]=o,function(n,i){e[i]=n[i],n[i]=function(){var o=e[i].apply(n,arguments),a=n["".concat(i).concat(t)];return"function"==typeof a&&a(),o}}(n,i))},detach:function(n,i){var o="".concat(i).concat(t);n[i]&&n[o]&&(n[o]=void 0,function(t,n){e[n]&&(delete t[n],t[n]=e[n],delete e[n])}(n,i))}}}.bind(void 0)();var T=function(){!function(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}(this,undefined);var e,t,n,i=function(i){e=i.oldValue,t=i.newValue,n=i.title,w.postMessage({action:"track_location",payload:{pageUrl:i}})},o=function(){var o=window.location.href;t!==o&&(e=t,t=o,n=document.title,i({oldValue:e,newValue:t,title:n}))};return{start:function(){t=window.location.href,i({newValue:t,title:document.title}),L.attach(window.history,"pushState",o),L.attach(window.history,"replaceState",o),window.addEventListener?(window.addEventListener("hashchange",o,!1),window.addEventListener("popstate",o,!1)):(window.attachEvent("hashchange",o,!1),window.attachEvent("popstate",o,!1))},stop:function(){e=t=void 0,L.detach(window.history,"pushState"),L.detach(window.history,"replaceState"),window.removeEventListener?(window.removeEventListener("hashchange",o),window.removeEventListener("popstate",o)):(window.detachEvent("hashchange",o),window.detachEvent("popstate",o))},track:i}}.bind(void 0)();function P(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}var O=function(){var e=this;P(this,undefined);var t=null,n=null,i=null,o=function(){P(this,e),w.postMessage({action:"track_activity",payload:{seen:n}})}.bind(this),a=function(){P(this,e),n=(new Date).getTime()}.bind(this),r=function(t){P(this,e),v.unbindEvent("keypress",a),v.unbindEvent("mousemove",a),v.unbindEvent("click",a),t&&(v.bindEvent("keypress",a),v.bindEvent("mousemove",a),v.bindEvent("click",a))}.bind(this),s=function(){P(this,e);var a=(new Date).getTime();null===i||null===n||t&&(a<t||n<t||a-t<59e3||n>t&&n<a&&o()),t=a}.bind(this),d=function(){P(this,e),i&&clearInterval(i),i=null,n=null,t=null}.bind(this),c=function(){P(this,e),d(),r(!0),t=(new Date).getTime(),i=setInterval(s,6e4)}.bind(this),l=function(){P(this,e),n=(new Date).getTime(),o(),d(),r(!1)}.bind(this),u=function(){P(this,e),"hidden"===document.visibilityState&&l()}.bind(this);return{start:function(){c(),v.bindEvent("focus",c),v.bindEvent("blur",l),v.bindEvent("beforeunload",l),v.bindEvent("visibilitychange",u)},stop:function(){l(),v.unbindEvent("focus",c),v.unbindEvent("blur",l),v.unbindEvent("beforeunload",l),v.unbindEvent("visibilitychange",u)}}}.bind(void 0)(),S=function(){T.start(),O.start()},B=function(){T.stop(),O.stop()};function M(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}var D={start:function(){b.isEmpty()||b.isLocked()||(b.toggleLock(!0),this.run())},run:function(){var e=b.deque();e?this.process(e):b.toggleLock(!1)},process:function(e){var t=this;e.handler?y.subscribe(e.action,e.payload,function(n){M(this,t),"function"==typeof e.handler&&e.handler(n),this.run()}.bind(this)):(y.subscribe(e.action,e.payload),setTimeout(function(){M(this,t),this.run()}.bind(this),0))}};var F=function(){return function(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}(this,undefined),{init:function(e){var t=document.createElement("script"),n=e.host;t.type="text/javascript",t.src=n+"/widget/js/co-browsing.js",(document.body?document.body:document.getElementsByTagName("head")[0]).appendChild(t),window.fc_cobrowse={host:e.host,locale:e.locale}}}}.bind(void 0)(),N={getHighestLevelDomain:function(){for(var e=0,t=document.domain,n=t.split("."),i="_zg"+(new Date).getTime();e<n.length-1&&-1==document.cookie.indexOf(i+"="+i);)t=n.slice(-1-++e).join("."),document.cookie=i+"="+i+";domain="+t+";";return document.cookie=i+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;domain="+t+";",t},setCookie:function(e,t,n){var i=n||31536e6,o=new Date(+new Date+i),a=this.getHighestLevelDomain()||location.hostname,r=t||"_fw_crm_v";return document.cookie=r+"="+e+";domain=."+a+";path=/;expires="+o.toUTCString()+";SameSite=Lax;",e},removeCookie:function(e){var t=e||"_fw_crm_v",n=this.getHighestLevelDomain()||location.hostname;document.cookie=t+"=;domain=."+n+";path=/;expires=Thu, 01 Jan 1970 00:00:01 GMT;SameSite=Lax;"},getCookie:function(){if(document.cookie){for(var e,t,n,i="freshworks-s360-vid",o={},a=document.cookie.split(";"),r=0,s=a.length;r<s;r++)(e=a[r]&&a[r].split("="))&&e.length&&(o[e[0].trim()]=e[1]);return o[i]?(n=o[i],this.removeCookie(i)):n=o._fw_crm_v,t=n||this.generateUUID(),this.setCookie(t)}},generateUUID:function(){var e=(new Date).getTime(),t=performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(n){var i=16*Math.random();return e>0?(i=(e+i)%16|0,e=Math.floor(e/16)):(i=(t+i)%16|0,t=Math.floor(t/16)),("x"==n?i:7&i|8).toString(16)}))}};function W(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var R={onMessageCB:function(){var e;return function(){return e||(e=this.onMessage.bind(this))}}(),onCustomEventCB:function(){var e;return function(){return e||(e=this.onCustomMessage.bind(this))}}(),onVisibilityChangeCB:function(){var e;return function(){return e||(e=this.onVisibilityChange.bind(this))}}(),subscribe:function(){window.addEventListener?(window.addEventListener("message",this.onMessageCB(),!1),window.addEventListener("focus",this.onVisibilityChangeCB(),!1),window.addEventListener("blur",this.onVisibilityChangeCB(),!1)):(window.attachEvent("onmessage",this.onMessageCB()),window.attachEvent("focus",this.onVisibilityChangeCB()),window.attachEvent("blur",this.onVisibilityChangeCB())),this.subscribeSales360Event()},unsubscribe:function(){window.removeEventListener?(window.removeEventListener("message",this.onMessageCB(),!1),window.removeEventListener("focus",this.onVisibilityChangeCB(),!1),window.removeEventListener("blur",this.onVisibilityChangeCB(),!1)):(window.detachEvent("onmessage",this.onMessageCB()),window.detachEvent("focus",this.onVisibilityChangeCB()),window.detachEvent("blur",this.onVisibilityChangeCB())),this.unsubscribeSales360Event()},subscribeSales360Event:function(){window.addEventListener?window.addEventListener("fwcrm_event",this.onCustomEventCB(),!1):window.attachEvent("fwcrm_event",this.onCustomEventCB())},unsubscribeSales360Event:function(){window.removeEventListener?window.removeEventListener("fwcrm_event",this.onCustomEventCB(),!1):window.detachEvent("fwcrm_event",this.onCustomEventCB())},onVisibilityChange:function(e){switch(e.type){case"focus":w.postMessage({action:"widget_focus"});break;case"blur":w.postMessage({action:"widget_blur",payload:{title:document.title,location:window.location.href}}),E.postMessage({action:"widget_location",openWindow:!1,payload:window.location.href})}},onUserCreate:function(e){x.publish("user:created",e)},loadWidget:function(){if(!1===t.isInitialized()){t.initialized(!0);var e=w.getJSON(),n=o.getProperties(),i=o.getConfig(),a=t.getTags(),r=t.getFaqTags(),s=p.getProperties(),d=p.getConversationPropertiesMeta();if(e.integrations=o.getIntegrations(),e.campaignRuleIds=o.getcampaignRuleIds(),e.externalId=o.getExternalId(),e.restoreId=o.getRestoreId(),e.flowId=o.getFlowId(),e.flowVersionId=o.getFlowVersionId(),e.previewMode=o.getPreviewMode(),e.isTemplateBot=o.getIsTemplateBot(),e.identifyByReferenceId=o.getIdentifyByReferenceId(),n&&(e.properties=n),s&&(e.botsMeta=s),d&&(e.conversationPropertiesMeta=d),i&&(e.config=i),a&&(e.tags=a),r&&(e.faqTags=r),e.userAgent=v.getAgent,v.storageAvailable){var c=e.token,l=localStorage.getItem(c),u=e.siteId?"".concat(e.token,"_").concat(e.siteId):null,f=u?localStorage.getItem(u):null;if((l||u&&f)&&(e.storage={},e.storage[c]=l||JSON.stringify({}),u&&(e.storage[u]=f||JSON.stringify({}))),i&&i.overrideDS){var h="lsds_".concat(u||c),g=localStorage.getItem(h);g?e.lsds=A({},h,g):(e.lsds=A({},h,JSON.stringify({})),e.migrateLFDS=!0)}}w.setFrameSize(),w.setFramePosition(),w.setWidgetDisplayStyle(),w.postMessage({action:"load_widget",payload:e})}},unloadWidget:function(){E.isLoaded()&&E.unload(),t.reset(),o.reset(),p.reset(),B(),w.reset(),w.remove(e.frameDivId),this.unsubscribe(),x.publish("widget:destroyed",null,!0),x.clear()},updateFrameSettings:function(e){if(null!==w.getSettings()||void 0===e)return!1;w.setSettings(e)},onCustomMessage:function(e){},onMessage:function(n){var i=this,a=n.origin||n.originalEvent.origin,r=o.getConfig(),s=r&&r.cssNames;if(a===w.getHost()||a===E.getHostOrigin()){var d=n.data,c=d&&d.action;if(this.updateFrameSettings(d.settingsPayload),c){var l,u,f=document.getElementById(e.frameDivId),h=s&&s.expanded||"expanded",p=w.getSettings(),g=null==p||null===(l=p.appearanceConfig)||void 0===l?void 0:l.widgetRightOffsetPx,m="BOTTOM_LEFT"===(null==p||null===(u=p.appearanceConfig)||void 0===u?void 0:u.widgetPosition);switch(c){case"push_subscribe_destroy_response":this.unloadWidget();break;case"TRIGGER_JS_FUNCTION":var b,C=null===(b=d.data.functionName)||void 0===b?void 0:b.replace("options.",""),_=w.getJsFunctions()[C],k=_&&_.call(this,JSON.parse(d.data.params));d.data.value="string"==typeof k?k:JSON.stringify(k),w.postMessage(d);break;case"OPEN_URL":window.open(d.data.url,d.data.target);break;case"push_user_meta":x.publish("push:subscribed",d.data),w.postMessage(d);break;case"toggle_dialog":d.data?x.publish("dialog:opened"):x.publish("dialog:closed");break;case"reset_user_cookie":N.removeCookie(),w.postMessage({action:"update_cookie",payload:{omniCookie:N.getCookie()}});break;case"restore_user_cookie":N.removeCookie(),N.setCookie(d.alias),w.postMessage({action:"restore_cookie",payload:{alias:d.alias}});break;case"notify_frame":var L=d.data,T=document.getElementById(e.frameDivId),P=s&&s.open||"fc-open";"expand"===L?(T.style.removeProperty("max-height"),T.style.removeProperty("height"),T.classList.add("h-open-notify"),T.classList.add(P),T.classList.add(L)):"close"===L?(T.style.removeProperty("max-height"),T.style.removeProperty("height"),T.classList.remove("h-open-notify"),T.classList.remove(P),T.classList.remove("expand")):"mobile-view"===L?T.classList.add("fc-mobile-view"):(T.classList.add("h-open-notify"),T.classList.add(P));break;case"resize_frame":var O=document.getElementsByTagName("BODY")[0],B=s&&s.open||"fc-open";t.opened(d.isOpen),t.isOpened()?(f.classList.add("h-open-container"),f.classList.add(B),f.classList.add("widget-open-animate"),x.publish("widget:opened"),setTimeout(function(){W(this,i),f.classList.remove("widget-open-animate")}.bind(this),1e3),O&&O.classList.add("fc-widget-open")):(f.style.removeProperty("max-height"),f.style.removeProperty("height"),f.classList.remove("h-open-container"),f.classList.remove(B),x.publish("widget:closed"),O&&O.classList.remove("fc-widget-open"));break;case"toggle_frame":d.show?f.classList.remove("hide"):-1===f.className.trim().indexOf("hide")&&f.classList.add("hide");break;case"push_frame_loaded":E.loaded(!0),E.setSource(n&&n.source),E.postMessage({action:"widget_location",openWindow:!1,payload:window.location.href}),w.postMessage({action:"widget_location",payload:{title:document.title,location:window.location.href}});break;case"frame_state_change":var M=document.getElementById(e.frameDivId),A=d&&d.data,R=A&&A.frameState,j=w.getSettings()&&w.getSettings().enabledFeatures,U=o.getConfig();x.publish("frame:statechange",d),"initialized"===R&&(w.isJWTEnabled()&&w.isJWTStrictMode()&&M.classList.add("fc_dn"),null!=U&&U.eagerLoad&&M.style.setProperty("display","none"),this.loadWidget(),j&&-1!==j.indexOf("COBROWSING")&&F.init({host:w.getHost(),locale:o.getProperties().locale})),"loaded"===R&&w.loaded(!0),"authenticated"!==R&&"not_authenticated"!==R||w.isJWTEnabled()&&w.isJWTStrictMode()&&(d.success?M.classList.remove("fc_dn"):304!==d.status&&this.unloadWidget());break;case"widget_loaded":t.loaded(!0),x.publish("widget:loaded");var V=o.getConfig(),q=document.getElementById(e.frameDivId);null!=V&&V.eagerLoad&&q.style.removeProperty("display"),E.isLoaded()||E.init({host:d.pushDomain+"?ref="+btoa(window.location.origin),hostOrigin:v.url_domain(d.pushDomain),appLogoPath:d.appLogoPath,locale:d.locale,sales360App:d.sales360App}),t.doOpen()&&w.postMessage({action:"open_chat"}),w.postMessage({action:"widget_location",payload:{title:document.title,location:window.location.href}});break;case"datastore_loaded":w.postMessage({action:"load_rules"});break;case"rules_loaded":S(),D.start();break;case"enlarge_image":I.create(d.picUrl);break;case"expand_all":document.getElementById(e.frameDivId).classList.add("expanded-modal"),document.getElementById(e.frameDivId).classList.add(h);break;case"expand_article_view":window.innerWidth<e.FAQ_EXPAND_WIDTH+g&&(f.classList.add(m?"expand-article-left":"expand-article-right"),f.style.setProperty(m?"left":"right","15px")),f.classList.remove("collapsed-article_view","collapse-article-left","collapse-article-right"),f.classList.add("expanded-article_view");break;case"collapse_article_view":f.classList.add(m?"collapse-article-left":"collapse-article-right"),f.style.setProperty(m?"left":"right","".concat(g,"px")),f.classList.remove("expanded-article_view"),f.classList.add("collapsed-article_view");break;case"collapse_all_article_view":f.classList.remove("expanded-article_view","collapsed-article_view"),f.style.setProperty(m?"left":"right","".concat(g,"px")),f.classList.remove("expand-article-left","expand-article-right","collapse-article-left","collapse-article-right");break;case"set_bubble_height":document.getElementById(e.frameDivId).style.height=d.height+"px";break;case"collapse_all":document.getElementById(e.frameDivId).classList.remove("expanded-modal"),document.getElementById(e.frameDivId).classList.remove(h),document.getElementById(e.frameDivId).classList.add("avoid-jitter"),setTimeout(function(){W(this,i),document.getElementById(e.frameDivId).classList.remove("avoid-jitter")}.bind(this),300);break;case"user_state_change":x.publish("user:statechange",d);break;case"user_authenticated":x.publish("user:authenticated",d);break;case"user_created":var J=d.data;if(t.isLoaded())J&&o.setRestoreId(J.restoreId),this.onUserCreate(d);else if(d.success){var H=J&&J.externalId,z=J&&J.restoreId,G=o.getExternalId();G?G===H&&(o.setRestoreId(z),this.onUserCreate(d)):this.onUserCreate(d)}else this.onUserCreate(d);break;case"user_cleared":x.publish("user:cleared"),E.postMessage({action:"clear:subscription",openWindow:!1}),o.reset();break;case"message_sent":x.publish("message:sent",d);break;case"message_received":x.publish("message:received",d);break;case"read_receipts_update":x.publish("readReceipts:update",d);break;case"csat_updated":x.publish("csat:updated",d);break;case"csat_received":x.publish("csat:received",d);break;case"anchor_link_clicked":x.publish("anchorLink:clicked",d);break;case"faq_clicked":x.publish("faq:clicked",d);break;case"download_file":x.publish("download:file",d);break;case"ask_permission":E.postMessage({action:"ask:permission",openWindow:!0});break;case"smart_polling":for(var X=function(e){var t=d.unreadMessages[e];setTimeout((function(){var e,n=this,i=new Notification("Conversation with ".concat(null==t?void 0:t.userFirstName),{body:"".concat(null==t?void 0:t.userFirstName,": ").concat(null===(e=t.messageFragments[0])||void 0===e?void 0:e.content),icon:d.icon});if(i.onclick=function(){parent.focus(),window.focus(),window.fcWidget.open(null==t?void 0:t.channelId),this.close()},"granted"===Notification.permission)return i;Notification.requestPermission().then(function(e){if(W(this,n),"granted"===e)return i}.bind(this))}),500*e)},Q=0;Q<d.unreadMessages.length;Q++)X(Q);break;case"clear_subscription":E.postMessage({action:"clear:subscription",openWindow:!1});break;case"unread_count_notify":x.publish("unreadCount:notify",d.data);break;case"message_from_agent":x.publish("message:received",d.data);break;case"message_from_user":x.publish("message:sent",d.data);break;case"conversation_resolved":x.publish("conversation:resolved",d.data);break;case"set_storage_item":if(v.storageAvailable){var K=d.data;K&&K.key&&K.value&&localStorage.setItem(K.key,JSON.stringify(K.value))}break;case"remove_storage_item":if(v.storageAvailable){var Y=d.data;Y&&Y.key&&localStorage.removeItem(Y.key)}break;case"startScreenShare":window.fc_cobrowse&&window.fc_cobrowse.allowScreenShare(n);break;case"set_lsds_item":if(v.storageAvailable){var Z=d.data,$=Z&&Z.key;if($){var ee=Z&&Z.value;localStorage.setItem($,v.stringifyJSON(ee))}}break;case"get_lsds_item":if(v.storageAvailable){var te=d.data,ne=te&&te.key;ne&&localStorage.getItem(ne)}break;case"remove_lsds_item":if(v.storageAvailable){var ie=d.data,oe=ie&&ie.key;oe&&localStorage.removeItem(oe)}break;case"requestForAudioCall":window.fc_cobrowse&&window.fc_cobrowse.requestForAudioCall(n);break;case"rts_connected":x.publish("rts:connected",d.data);break;case"rts_disconnected":x.publish("rts:disconnected",d.data);break;case"stack_max_height":var ae=screen.height<=568?screen.height:screen.height-250;document.getElementById(e.frameDivId).style.maxHeight=ae+"px",w.postMessage({action:"stacked_max_height",payload:{height:ae}});break;case"hide_widget":document.getElementById(e.frameDivId).style.setProperty("display","none");break;default:y.publish(c,d)}}}},syncResponse:function(e,t){var n=e&&e.status;n?w.dispatch(t,{success:200===n,status:n}):w.dispatch(t,{success:!1,status:400})}},j={track:function(e,t){y.subscribe("track_event",{eventName:e,data:t})}};function U(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function V(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var q=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),V(this,"listenToConfigDataCB",void 0),V(this,"payload",void 0),V(this,"resolve",void 0),V(this,"iframeWindow",void 0),this.payload=t}var t,n,i;return t=e,n=[{key:"fetch",value:function(){var e=this;return new Promise(function(t){var n;!function(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}(this,e);var i=document.createElement("iframe"),o=null!==(n=this.payload)&&void 0!==n&&n.widgetUuid?"&widgetUuid=".concat(this.payload.widgetUuid):"",a="".concat(this.payload.host,"/widget/config_iframe.html?host=").concat(this.payload.host,"&token=").concat(this.payload.token,"&origin=").concat(window.location.origin).concat(o);i.id="config-load-iframe",i.style.display="none",i.src=a,document.body.append(i),this.iframeWindow=i.contentWindow,this.resolve=t,this.listenToConfigDataCB=this.listenToConfigData.bind(this),window.addEventListener("message",this.listenToConfigDataCB)}.bind(this))}},{key:"cleanUp",value:function(){var e;this.iframeWindow=null,null===(e=document.querySelector("#config-load-iframe"))||void 0===e||e.remove(),window.removeEventListener("message",this.listenToConfigDataCB)}},{key:"listenToConfigData",value:function(e){e.source===this.iframeWindow&&(this.cleanUp(),this.resolve(JSON.parse(e.data)))}}],n&&U(t.prototype,n),i&&U(t,i),e}(),J=q;function H(e){return H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},H(e)}function z(e,t){if(t&&("object"===H(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return G(e)}function G(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function X(e){var t="function"==typeof Map?new Map:void 0;return X=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return Q(e,arguments,Z(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),Y(i,e)},X(e)}function Q(e,t,n){return Q=K()?Reflect.construct:function(e,t,n){var i=[null];i.push.apply(i,t);var o=new(Function.bind.apply(e,i));return n&&Y(o,n.prototype),o},Q.apply(null,arguments)}function K(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Y(e,t){return Y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Y(e,t)}function Z(e){return Z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Z(e)}function $(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ee(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function te(e,t,n){return t&&ee(e.prototype,t),n&&ee(e,n),e}function ne(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ie=function(){function t(e){$(this,t),ne(this,"impostorConfig",void 0),this.impostorConfig=e}return te(t,[{key:"create",value:function(){var t,n,i,o,a,r,s,d,c,l,u,f,h,p=this,g=(t=this.impostorConfig,i=t.background,o=t.foreground,a=t.isCustomText,r=t.widgetLauncherValue,s=t.isLeftPositionedWidget,d=t.helpIcon,c=t.host,l=t.offsetBottomWidth,u=t.offsetRightWidth,f=d.includes("http")?d:"".concat(c,"/").concat(d),h='<div id="fc-widget-chat-text">\n        <img class="fc-widget-help-icon" src="'.concat(f,'" alt="help-icon" />\n        <span>').concat(r||"Help","</span>\n      </div>"),n=r&&!a?'<img class="fc_widget_custom-icon" src='.concat(r,' alt="Freshchat Logo" />'):'<div id="fc-widget-chat-icon" />',{content:'\n            <div class="freshdesk_messaging">\n                <div id="static-bubble" class="d-hotline '.concat(a&&"d-hotline-text",'">\n                    <div id="bubble-content">\n                        ').concat(a?h:n,'\n                    </div>                    \n\n                    <div id="loading" class="fc-widget-align-center">\n                        <div class="flexbox">\n                            <div class="dot-loader"></div>\n                            <div class="dot-loader"></div>\n                            <div class="dot-loader"></div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        '),styles:"\n        :host {\n            --background: ".concat(i,";\n            --foreground: ").concat(o,";\n        }\n\n        .d-hotline-text {\n            border-radius: 24px 4px 16px 24px !important;\n            height: 32px !important;\n            padding: 0 10px;\n            width: unset !important;\n        }\n\n        #fc-widget-chat-text {\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Segoe UI Emoji', 'Roboto', 'Oxygen', 'Ubuntu', 'Fira Sans', 'Droid Sans', 'Cantarell', 'Helvetica Neue', sans-serif;\n            -webkit-font-smoothing: antialiased;\n            display: flex;\n            font-size: 14px;\n            font-weight: 500;\n            line-height: 20px;\n            white-space: nowrap;\n            margin: 5px 0px;\n        }\n\n        .fc-widget-help-icon {\n            margin: 2px 5px 0 0;\n        }\n\n        .fc-widget-align-center {\n            top: 50% !important;\n            left: 50% !important;\n            transform: translate(-50%, -50%);\n        }\n\n        .fc_widget_custom-icon {\n            width: 38%;\n            height: 17px;\n            border-radius: 6px 6px 6px 2px;\n            position: absolute;\n            top: 37%;\n            left: 32%;\n        }\n\n        .freshdesk_messaging .d-hotline {\n                display: none;\n                border-radius: 34px 8px 34px 34px;\n                position: fixed !important;\n                bottom: ").concat(l,"px;\n                box-shadow: 0 5px 4px 0 rgba(0, 0, 0, 0.26) !important;\n                color: #fff;\n                cursor: pointer;\n                display: table;\n                position: absolute;\n                right: ").concat(s?"auto":u+"px",";\n                left: ").concat(s?u+"px":"auto",';\n                z-index: 3147483602 !important;\n                height: 60px;\n                width: 60px;\n                background-color: var(--background) !important;\n                color: #ffffff !important;\n                border-color: var(--background) !important;\n                -webkit-animation: 0.5s zoomIn;\n                animation: 0.5s zoomIn;\n            }\n            .freshdesk_messaging.fullscreen #static-bubble {\n                bottom: 6px !important;\n            }\n            .freshdesk_messaging.fullscreen #loading {\n                bottom: 62px;\n            }\n            .freshdesk_messaging.l2r #static-bubble {\n                left: 20px;\n            }\n            .freshdesk_messaging.l2r #loading {\n                left: 85px;\n            }\n            .freshdesk_messaging.l2r.fullscreen #static-bubble {\n                left: 5px !important;\n            }\n            .freshdesk_messaging.r2l.fullscreen #static-bubble {\n                right: 5px !important;\n            }\n            .freshdesk_messaging.r2l.fullscreen #loading {\n                right: 64px;\n            }\n            .freshdesk_messaging.l2r.fullscreen #loading {\n                left: 72px;\n            }\n            .freshdesk_messaging #fc-widget-chat-icon {\n                width: 38%;\n                height: 17px;\n                border-radius: 6px 6px 6px 2px;\n                position: absolute;\n                background: var(--foreground) !important;\n                top: 37%;\n                left: 32%;\n            }\n            .freshdesk_messaging #fc-widget-chat-icon:before {\n                border-radius: 2px 2px 2px 2px;\n                height: 2px;\n                content: "";\n                border-top: 5px;\n                background: var(--background) !important;\n                width: 65%;\n                position: absolute;\n                top: 5px;\n                left: 4px;\n            }\n            .freshdesk_messaging #fc-widget-chat-icon:after {\n                border-radius: 2px 2px 2px 2px;\n                height: 2px;\n                content: "";\n                border-top: 5px;\n                background: var(--background) !important;\n                width: 44%;\n                position: absolute;\n                top: 10px;\n                left: 4px;\n            }\n            .freshdesk_messaging #loading {\n                visibility: hidden;\n                position: absolute;\n                bottom: ').concat(a?"auto":"25px",";\n                min-width: 55px !important;\n                left: ").concat(a?"auto":"6px",";\n            }\n            .freshdesk_messaging .flexbox {\n                opacity: 0.7;\n                display: -webkit-box;\n                display: -ms-flexbox;\n                display: flex;\n                -ms-flex-wrap: wrap;\n                flex-wrap: wrap;\n            }\n            .freshdesk_messaging .dot-loader {\n                height: 8px;\n                width: 8px;\n                border-radius: 50%;\n                background-color: var(--foreground) !important;\n                position: relative;\n                -webkit-animation: 1.2s scaleDown ease-in-out infinite;\n                animation: 1.2s scaleDown ease-in-out infinite;\n            }\n            .freshdesk_messaging .dot-loader:nth-child(2) {\n                margin: 0 10px;\n                -webkit-animation: 1.2s scaleDown ease-in-out infinite 0.15555s;\n                animation: 1.2s scaleDown ease-in-out infinite 0.15555s;\n            }\n            .freshdesk_messaging .dot-loader:nth-child(3) {\n                -webkit-animation: 1.2s scaleDown ease-in-out infinite 0.3s;\n                animation: 1.2s scaleDown ease-in-out infinite 0.3s;\n            }\n            @-webkit-keyframes scaleDown {\n                0%,\n                80%,\n                100% {\n                    -webkit-transform: scale(0);\n                    transform: scale(0);\n                }\n                40% {\n                    -webkit-transform: scale(1);\n                    transform: scale(1);\n                }\n            }\n            @keyframes scaleDown {\n                0%,\n                80%,\n                100% {\n                    -webkit-transform: scale(0);\n                    transform: scale(0);\n                }\n                40% {\n                    -webkit-transform: scale(1);\n                    transform: scale(1);\n                }\n            }\n            @-webkit-keyframes zoomIn {\n            0% {\n                -webkit-transform: scale(0);\n                transform: scale(0);\n            }\n\n            100% {\n                -webkit-transform: scale(1);\n                transform: scale(1);\n            }\n            }\n\n            @keyframes zoomIn {\n            0% {\n                -webkit-transform: scale(0);\n                transform: scale(0);\n            }\n\n            100% {\n                -webkit-transform: scale(1);\n                transform: scale(1);\n            }\n            }\n\n            @media only screen and (min-device-width: 320px) and (max-device-width: 480px) {\n              .mobile .d-hotline {\n                  box-shadow: 0 2px 4px 0 rgba(0, 0, 0, .2) !important;\n\n                  width: 50px;\n                  height: 50px;\n            }\n\n            .mobile #fc-widget-chat-icon {\n                width: 43% !important;\n                top: 32% !important;\n            }\n        ")});return function(t){var n=t.onDemandWidgetCB,i=t.fullscreen,o=t.l2r,a=t.isMobile;!function(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}(this,p);var r=e.impostor.tagName,s=function(){var e=document.createElement("template");return e.innerHTML='\n              <style id="widget-style">'.concat(g.styles.toString(),"</style>\n              ").concat(g.content,"\n            "),e}(),d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Y(e,t)}(l,e);var t,d,c=(t=l,d=K(),function(){var e,n=Z(t);if(d){var i=Z(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return z(this,e)});function l(){var e,t;$(this,l),ne(G(t=c.call(this)),"onDemandCB",void 0),t.attachShadow({mode:"open"}).appendChild(s.content.cloneNode(!0)),t.onDemandCB=t.onDemand.bind(G(t)),null===(e=t.shadowRoot)||void 0===e||e.querySelector("#static-bubble").addEventListener("mousedown",t.onDemandCB);var n,r,d=[];(i&&d.push("fullscreen"),o?d.push("l2r"):d.push("r2l"),a&&d.push("mobile"),d.length)&&(null===(n=t.shadowRoot)||void 0===n||(r=n.querySelector(".freshdesk_messaging").classList).add.apply(r,d));return t}return te(l,[{key:"onDemand",value:function(){this.removeMouseDownHandler(),this.showLoading(),n()}},{key:"removeMouseDownHandler",value:function(){var e,t=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("#static-bubble");t&&t.removeEventListener("mousedown",this.onDemandCB)}},{key:"removeBubble",value:function(){this.shadowRoot.querySelector("#static-bubble").style.display="none",this.removeMouseDownHandler()}},{key:"removeImpostor",value:function(){this.removeLoading(),this.shadowRoot.querySelector(".freshdesk_messaging").style.display="none",document.querySelector(r).remove()}},{key:"removeLoading",value:function(){var e,t,n=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector(".freshdesk_messaging #loading"),i=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector("#bubble-content");n.style.visibility="hidden",i.style.visibility="visible"}},{key:"showLoading",value:function(){var e,t,n=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector(".freshdesk_messaging #loading"),i=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector("#bubble-content");n.style.visibility="visible",i.style.visibility="hidden"}}]),l}(X(HTMLElement));customElements.get(r)||customElements.define(r,d);var c=document.createElement(r,{is:r});return document.body.appendChild(c),c}.bind(this)(this.impostorConfig)}}]),t}(),oe=ie;function ae(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}var re=n.p+"help_icon.407f0467c911236190038c9631c321f8.svg",se=n.p+"help_icon_black.5668a2cc609a7b782f2ea0dab26bae20.svg";function de(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?de(Object(n),!0).forEach((function(t){fe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):de(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function le(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}function ue(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function fe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var he=function(){function t(e){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),fe(this,"payload",void 0),fe(this,"eagerLoad",void 0),fe(this,"onWidgetLoadedCB",void 0),fe(this,"onWidgetOpenedCB",void 0),fe(this,"listenToConfigDataCB",void 0),fe(this,"sendConfigsToFreshChatCB",void 0),fe(this,"appConfig",void 0),fe(this,"appConfigService",void 0),fe(this,"impostorConfig",void 0),fe(this,"impostor",void 0),fe(this,"openWidgetOnLoad",void 0),fe(this,"isWidgetBeingLoaded",void 0),fe(this,"loadFreshChatCB",void 0),fe(this,"unbindBrowserEventsCB",void 0),fe(this,"rejectLoadingFreshchat",void 0),fe(this,"activityEvents",void 0),fe(this,"dontLoadWithImpostor",!0),fe(this,"eventUnbindTimer",void 0),this.payload=e,this.eagerLoad=null==e||null===(n=e.config)||void 0===n?void 0:n.eagerLoad}var n,i,o;return n=t,i=[{key:"init",value:function(){var e=this;return new Promise(function(t,n){var i;le(this,e),this.loadFreshChatCB=t,this.rejectLoadingFreshchat=n,null!==(i=this.payload)&&void 0!==i&&i.open||!1===this.eagerLoad?this.loadFreshChat(!1):this.processImpostor()}.bind(this))}},{key:"onDemand",value:function(){this.isWidgetBeingLoaded?this.openWidgetOnLoad=!0:(this.payload.open=!0,this.loadFreshChat())}},{key:"handleForceLoadFreshChat",value:function(e){this.appConfigService.cleanUp(),this.loadFreshChat(e)}},{key:"processImpostor",value:function(){var t=this;this.appConfigService=new J(this.payload),function(e,t){var n=this,i=new Promise(function(e,i){var o=this;ae(this,n),setTimeout(function(){ae(this,o),i(new Error("Timeout triggered"))}.bind(this),t)}.bind(this));return Promise.race([e,i])}(this.appConfigService.fetch(),e.impostor.timeoutForFetchingConfigInMillis).then(function(n){var i;le(this,t);var o,a=null==n?void 0:n.betaFeatures;this.appConfig=n,this.impostorConfig=this.getImpostorConfig(),this.eagerLoad||!a||-1!==a.indexOf(e.eagerLoadBetaFeature)?null!==(i=this.impostorConfig)&&void 0!==i&&i.hideMessenger||null==n||!n.appId?this.rejectLoadingFreshchat():(this.listenToWidgetAndBrowserEvents(),null!==(o=this.impostorConfig)&&void 0!==o&&o.show&&(this.impostor=new oe(this.impostorConfig).create())):this.handleForceLoadFreshChat(!0)}.bind(this),function(){le(this,t),this.handleForceLoadFreshChat(!1)}.bind(this))}},{key:"getImpostorConfig",value:function(){var t,n,i,o,a,r,s,d,c,l,u,f,h,p,g,v,m,w,b,y,C,_,k,x,E,I,L,T,P,O,S,B,M,D,F,N=(null===(t=this.payload)||void 0===t||null===(n=t.config)||void 0===n||null===(i=n.headerProperty)||void 0===i?void 0:i.hideChatButton)||!1;return{hideChatButton:N,hideMessenger:(null===(o=this.appConfig)||void 0===o?void 0:o.hideMessenger)||!1,background:(null===(a=this.payload)||void 0===a||null===(r=a.config)||void 0===r||null===(s=r.headerProperty)||void 0===s?void 0:s.backgroundColor)||(null===(d=this.appConfig)||void 0===d||null===(c=d.appearanceConfig)||void 0===c||null===(l=c.widgetLauncherColor)||void 0===l?void 0:l.backgroundColor),foreground:(null===(u=this.payload)||void 0===u||null===(f=u.config)||void 0===f||null===(h=f.headerProperty)||void 0===h?void 0:h.foregroundColor)||(null===(p=this.appConfig)||void 0===p||null===(g=p.appearanceConfig)||void 0===g||null===(v=g.widgetLauncherColor)||void 0===v?void 0:v.foregroundColor)||"white",offsetBottomWidth:(null===(m=this.appConfig)||void 0===m||null===(w=m.appearanceConfig)||void 0===w?void 0:w.widgetBottomOffsetPx)+6||20,offsetRightWidth:(null===(b=this.appConfig)||void 0===b||null===(y=b.appearanceConfig)||void 0===y?void 0:y.widgetRightOffsetPx)+5||21,show:!N,fullscreen:(null===(C=this.payload)||void 0===C||null===(_=C.config)||void 0===_?void 0:_.fullscreen)||!1,l2r:"ltr"===(null===(k=this.payload)||void 0===k||null===(x=k.config)||void 0===x||null===(E=x.headerProperty)||void 0===E?void 0:E.direction),onDemandWidgetCB:this.onDemand.bind(this),isMobile:/Android|iPhone|iPad|iPod/i.test(navigator.userAgent),isCustomText:"TEXT"===(null===(I=this.appConfig)||void 0===I||null===(L=I.appearanceConfig)||void 0===L?void 0:L.widgetLauncherStyle)||!1,widgetLauncherValue:(null===(T=this.appConfig)||void 0===T||null===(P=T.appearanceConfig)||void 0===P?void 0:P.widgetLauncherValue)||!1,isLeftPositionedWidget:"BOTTOM_LEFT"===(null===(O=this.appConfig)||void 0===O||null===(S=O.appearanceConfig)||void 0===S?void 0:S.widgetPosition)||!1,helpIcon:(null===(B=this.appConfig)||void 0===B||null===(M=B.appearanceConfig)||void 0===M||null===(D=M.widgetLauncherColor)||void 0===D?void 0:D.foregroundColor)===e.LauncherTextColor?se:re,host:null===(F=this.payload)||void 0===F?void 0:F.host}}},{key:"loadFreshChat",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isWidgetBeingLoaded=!0,this.loadFreshChatCB(e),e&&(this.sendConfigsToFreshChatCB=this.sendConfigsToFreshChat.bind(this),window.addEventListener("message",this.sendConfigsToFreshChatCB))}},{key:"sendConfigsToFreshChat",value:function(t){t.data.action===e.impostor.getFreshChatConfigs&&(w.postMessage({action:"config_data",payload:ce({},this.appConfig)}),window.removeEventListener("message",this.sendConfigsToFreshChatCB))}},{key:"listenToWidgetAndBrowserEvents",value:function(){this.onWidgetOpenedCB=this.onWidgetOpened.bind(this),this.onWidgetLoadedCB=this.onWidgetLoaded.bind(this),window.fcWidget.on("widget:loaded",this.onWidgetLoadedCB),window.fcWidget.on("widget:opened",this.onWidgetOpenedCB),this.activityEvents=e.impostor.activityEvents,this.unbindBrowserEventsCB=this.unbindBrowserEvents.bind(this,!1),this.bindBrowserEvents.bind(this)()}},{key:"unbindBrowserEvents",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.activityEvents.forEach(function(t){le(this,e),document.removeEventListener(t,this.unbindBrowserEventsCB,!0)}.bind(this)),t||this.loadFreshChat()}},{key:"bindBrowserEvents",value:function(){var e=this;this.activityEvents.forEach(function(t){le(this,e),document.addEventListener(t,this.unbindBrowserEventsCB,!0)}.bind(this))}},{key:"onWidgetOpened",value:function(){this.cleanUp()}},{key:"onWidgetLoaded",value:function(){this.openWidgetOnLoad?window.fcWidget.open():this.cleanUp()}},{key:"unbindFCEvents",value:function(){window.fcWidget.off("widget:opened",this.onWidgetOpenedCB),window.fcWidget.off("widget:loaded",this.onWidgetLoadedCB)}},{key:"cleanUp",value:function(){var e,t,n=this;this.appConfig=null,window.removeEventListener("message",this.sendConfigsToFreshChatCB),null===(e=this.impostor)||void 0===e||e.removeBubble(),this.isWidgetBeingLoaded=!1,this.unbindBrowserEvents(!0),null===(t=this.impostor)||void 0===t||t.removeImpostor(),this.eventUnbindTimer&&clearTimeout(this.eventUnbindTimer),this.eventUnbindTimer=setTimeout(function(){le(this,n),this.unbindFCEvents()}.bind(this))}}],i&&ue(n.prototype,i),o&&ue(n,o),t}(),pe=he;function ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ge(Object(n),!0).forEach((function(t){me(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function me(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function we(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}var be=function(){we(this,undefined);var n;return{init:function(i){window.fcWidgetMessengerConfig&&(i=Object.assign(i,window.fcWidgetMessengerConfig));var a=function(n){var a,r,s;i.config=ve(ve({},i.config),{},{eagerLoad:n});var d,c,l,u,f,h,g=-1!==["Chrome","Firefox","Safari","Edge","Trident","WebView"].indexOf(v.getAgent.name),m=-1!==["Station"].indexOf(v.getAgent.appName),b=null===(a=i)||void 0===a||null===(r=a.config)||void 0===r||null===(s=r.headerProperty)||void 0===s?void 0:s.customUserAgent,y=b&&"string"==typeof b&&"CNA"===b.toUpperCase();if(g&&!m&&!this.isInitialized()||y){var C=i&&i.token;C&&C.toUpperCase()!==e.SAMPLE_TOKEN&&(window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")),i.referrer=btoa(window.location.origin),void 0===i.open&&(i.open=!1),u=i,t.reset(),o.reset(),p.reset(),B(),R.unsubscribe(),w.init({host:u.host.trim(),token:u.token.trim(),widgetUuid:null===(f=u.widgetUuid)||void 0===f?void 0:f.trim(),referrer:u.referrer,siteId:u.siteId,flowId:u.flowId,flowVersionId:u.flowVersionId,campaignRuleIds:u.campaignRuleIds,previewMode:u.previewMode,isTemplateBot:u.isTemplateBot,jwtAuthToken:u.jwtAuthToken,cspNonce:u.cspNonce,omniCookie:N.getCookie()||u.omniCookie,eagerLoad:(null==u||null===(h=u.config)||void 0===h?void 0:h.eagerLoad)||null,jsFunctions:u.jsFunctions,conversationReferenceId:u.conversationReferenceId}),t.openOnLoad(u.open),u.identifyByReferenceId&&o.setIdentifyByReferenceId(!0),u.flowId&&o.setFlowId(u.flowId),u.integrations&&o.setIntegrations(u.integrations),u.campaignRuleIds&&o.setcampaignRuleIds(u.campaignRuleIds),u.flowVersionId&&o.setFlowVersionId(u.flowVersionId),u.previewMode&&o.setPreviewMode(u.previewMode),o.setIsTemplateBot(u.isTemplateBot),u.externalId&&(o.setExternalId(u.externalId),o.setRestoreId(u.restoreId)),u.tags&&u.tags.length&&t.setTags(u.tags),u.faqTags&&t.setFaqTags(u.faqTags),u.botsMeta&&p.setProperties(u.botsMeta),u.conversationPropertiesMeta&&p.setConversationPropertiesMeta(u.conversationPropertiesMeta),o.setProperties({firstName:u.firstName,lastName:u.lastName,email:u.email,phone:u.phone,phoneCountry:u.phoneCountryCode,locale:u.locale,meta:u.meta}),o.setConfig(u.config),u.onLoad&&x.subscribe("widget:loaded",u.onLoad),w.add(),R.subscribe(),d=document,c=d.createElement("link"),l=w.getHost(),c.href=l+"/widget/css/widget.css?t="+(new Date).getTime(),c.rel="stylesheet",d.getElementsByTagName("head")[0].appendChild(c))}}.bind(this);window.Promise&&!n?(n=new pe(i)).init(i).then(a,(function(){})):a()},destroy:function(){E.unload(),w.unload()},isOpen:function(){return t.isOpened()},isInitialized:function(){return!!w.getToken()},isLoaded:function(){return t.isLoaded()},on:function(e,t){x.subscribe(e,t)},off:function(e,t){x.unsubscribe(e,t)},open:function(e){e?y.subscribe("open_channel",e):y.subscribe("open_chat")},close:function(){y.subscribe("close_chat")},show:function(){y.subscribe("show_chat")},hide:function(){y.subscribe("hide_chat")},setTags:function(e){t.isLoaded()&&(e&&e.length?t.setTags(e):t.setTags([]),y.subscribe("set_tags",{tags:t.getTags(),force:!0}))},setFaqTags:function(e){t.isLoaded()&&(e?t.setFaqTags(e):t.setFaqTags({}),y.subscribe("set_faq_tags",{faqTags:t.getFaqTags(),force:!0}))},setExternalId:function(e,t){var n={};if(e){if("string"==typeof e?n.externalId=e:n=e,!(void 0===window.Promise||t&&"function"==typeof t))return C("set_external_id",n);_("set_external_id",n,t)}},setConfig:function(t){var n=document.getElementById(e.frameDivId);n&&t&&(void 0!==t.fullscreen&&(n.classList.remove(e.classes.fullscreenClass),!0===t.fullscreen&&n.classList.add(e.classes.fullscreenClass)),t.headerProperty&&(void 0!==t.headerProperty.direction&&(n.classList.remove("fc_l2r"),"ltr"===t.headerProperty.direction&&n.classList.add("fc_l2r")),void 0!==t.headerProperty.hideChatButton&&(n.classList.remove("fc_dn"),t.headerProperty.hideChatButton&&n.classList.add("fc_dn")))),y.subscribe("set_custom_config",t)},setBotConfig:function(e){o.getPreviewMode()&&y.subscribe("set_bot_config",e)},conversation:{setProperties:function(e){p.setProperties(e),y.subscribe("set_bots_properties",p.getProperties())},setBotVariables:function(e){this.setProperties(e)},setConversationProperties:function(e){p.setConversationPropertiesMeta(e),y.subscribe("set_conversation_properties",p.getConversationPropertiesMeta())}},user:{get:function(e){if(!(void 0===window.Promise||e&&"function"==typeof e))return C("get_user");_("get_user",e)},isExists:function(e){if(!(void 0===window.Promise||e&&"function"==typeof e))return C("user_exists");_("user_exists",e)},update:function(e,t){if(e.jwtAuthToken?w.setJWTAuthToken(e.jwtAuthToken):(e.firstName&&o.setFirstName(e.firstName),e.lastName&&o.setLastName(e.lastName),e.email&&o.setEmail(e.email),e.phone&&o.setPhone(e.phone),e.phoneCountry&&o.setPhoneCountry(e.phoneCountry),e.meta&&o.setUserMeta(e.meta)),!(void 0===window.Promise||t&&"function"==typeof t))return C("update_user",e);_("update_user",e,t)},setProperties:function(e,t){var n={};if(e.jwtAuthToken?(w.setJWTAuthToken(e.jwtAuthToken),n=e):(e.firstName&&(n.firstName=e.firstName,delete e.firstName),e.lastName&&(n.lastName=e.lastName,delete e.lastName),e.email&&(n.email=e.email,delete e.email),e.phone&&(n.phone=e.phone,delete e.phone),e.phoneCountryCode&&(n.phoneCountry=e.phoneCountryCode,delete e.phoneCountryCode),e.locale&&(n.locale=e.locale,delete e.locale),n.meta=e,o.setProperties(n)),!(void 0===window.Promise||t&&"function"==typeof t))return C("set_user_properties",n);_("set_user_properties",n,t)},setFirstName:function(e,t){var n={};if(e){if("string"==typeof e?n.firstName=e:n=e,!t)return this.setProperties(n);this.setProperties(n,t)}},setLastName:function(e,t){var n={};if(e){if("string"==typeof e?n.lastName=e:n=e,!t)return this.setProperties(n);this.setProperties(n,t)}},setEmail:function(e,t){var n={};if(e){if("string"==typeof e?n.email=e:n=e,!t)return this.setProperties(n);this.setProperties(n,t)}},setPhone:function(e,t){var n={};if(e){if("string"==typeof e?n.phone=e:n=e,!t)return this.setProperties(n);this.setProperties(n,t)}},setPhoneCountryCode:function(e,t){var n={};if(e){if("string"==typeof e?n.phoneCountryCode=e:n=e,!t)return this.setProperties(n);this.setProperties(n,t)}},setMeta:function(e,t){if(!t)return this.setProperties(e);this.setProperties(e,t)},setLocale:function(e,t){var n={};if(e){if("string"==typeof e?n.locale=e:n=e,!t)return this.setProperties(n);this.setProperties(n,t)}},clear:function(e){if(!(void 0===window.Promise||e&&"function"==typeof e))return C("reset_user");_("reset_user",e)},create:function(e,t){if("function"==typeof e&&(t=e,e=null),!(void 0===window.Promise||t&&"function"==typeof t))return C("create_user",e);_("create_user",e,t)},clone:function(e,t){if("function"==typeof e&&(t=e,e=null),!(void 0===window.Promise||t&&"function"==typeof t))return C("clone_user",e);_("clone_user",e,t)},getUUID:function(e){if(!(void 0===window.Promise||e&&"function"==typeof e))return C("get_user_uuid");_("get_user_uuid",e)},generateUUID:function(e){if(!(void 0===window.Promise||e&&"function"==typeof e))return C("generate_user_uuid");_("generate_user_uuid",e)}},track:j.track,trackPage:function(e,t){T.track({newValue:e,title:t,force:!0})},authenticate:function(e){var t=this;if(w.isJWTEnabled()){var n=function(){we(this,t),w.setJWTAuthToken(e),w.postMessage({action:"authenticate_user",payload:e})}.bind(this),i=function(i){we(this,t),i&&200===i.status?this.user.update({jwtAuthToken:e}):n()}.bind(this);this.isLoaded()?void 0===window.Promise?this.user.get(i):this.user.get().then(i,i):n()}}}}.bind(void 0)();if(window.fcWidget||(window.fcWidget=be),window.fcSettings)if("complete"===document.readyState){var ye=window.fcSettings.onInit;ye&&"function"==typeof ye&&ye(),be.init(window.fcSettings)}else document.onreadystatechange=function(e){return function(){if("complete"===document.readyState){var t=window.fcSettings.onInit;t&&"function"==typeof t&&t(),e.init(window.fcSettings)}}}(be)}()}();