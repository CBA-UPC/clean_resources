"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[2342],{78344:(e,i,a)=>{a.d(i,{g:()=>s});var n=a(23280),l=a(48603),t=a(11527);const s=e=>{let{children:i}=e;return(0,t.jsx)(n.x,{variant:"bodySmall",className:l.Z.pretitle,children:i})}},81542:(e,i,a)=>{a.d(i,{x:()=>u});var n=a(50959),l=a(77020),t=a(10732),s=a(19554),r=a(74893),o=a(84161),d=a(94142),c=a(11527);const u=e=>{let{children:i,action:a,uri:u}=e;const m=(0,t.g)(),g=(0,r.j)();let h;const b=()=>{const e={triggerId:d.K,triggerAction:{type:a}};o.y.set((i=>({...i,...e}))),g.storeAction(s.wH,{operation:l.pT.ADD,uris:[u]})};try{h=n.Children.only(i)}catch(v){return(0,c.jsx)(c.Fragment,{children:i})}return m?n.cloneElement(h,{onClick:b}):(0,c.jsx)(c.Fragment,{children:i})}},62374:(e,i,a)=>{a.r(i),a.d(i,{default:()=>Je});a(82693),a(61325),a(6882),a(36433),a(38910),a(9064);var n=a(50959),l=a(82187),t=a.n(l),s=a(75390),r=a(29132),o=a(28150),d=a(23280),c=a(29693),u=a(97098),m=a(12737),g=a(94523),h=a(10992),b=a(57144),v=a(90150),k=a(39189),p=a(34790),x=a(44930),y=a(52759),j=a(30760),f=a(88724),N=a(27642);const S={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"queryAlbumMerch"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"uri"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"albumUnion"},arguments:[{kind:"Argument",name:{kind:"Name",value:"uri"},value:{kind:"Variable",name:{kind:"Name",value:"uri"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Album"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"merch"},arguments:[{kind:"Argument",name:{kind:"Name",value:"offset"},value:{kind:"IntValue",value:"0"}},{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"IntValue",value:"20"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalCount"}},{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"albumMerchItem"}}]}}]}}]}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"albumMerchItem"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Merch"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"image"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"price"}},{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]};var I=a(48451);const w="iEG0moJ3mt1_j9Lho7MA";var C=a(11527);const A=e=>{var i;let{albumName:a,albumURI:n}=e;const{data:l}=(t={uri:n},s={cacheTime:5*N.y},(0,N.a)(S,t,s));var t,s;const r=null!=l&&l.albumUnion&&"merch"in l.albumUnion?null==l||null===(i=l.albumUnion)||void 0===i||null===(i=i.merch)||void 0===i?void 0:i.items:[];return r&&(null==r?void 0:r.length)>0?(0,C.jsx)("div",{className:"contentSpacing",children:(0,C.jsx)("div",{className:w,children:(0,C.jsx)(I.s,{id:a,uri:n,merchItems:r,merchVariant:"Album page merch items"})})}):null};var L=a(71707),F=a(79519),U=a(90818),P=a(69918),M=a(2213),T=a(67415),R=a(79287),E=a(22516),B=a(81085),V=a(92718),O=a(31695),D=a(11665),z=a(17207),_=a(44250),q=a(82869),Q=a(9705),Y=a(85509),Z=a(93709),H=a(66562),W=a(81542),K=a(71932),X=a(48439),$=a(73745),J=a(86343),G=a(74181),ee=a(19686),ie=a(3532);const ae="n8Bz0c0v17whD3KfMdOk",ne="zddjxV2lX9ukNM5QXloA",le="lVqlPjQLuQhK2flsxB78",te="O_EguRjsZ4uI1hHamkOA",se="jcaQQxoVnuuhtVwDJU1R",re="fLS8v3_EfBadEerbGVoR",oe="in4OjUTflcsoj9RUpf05",de="xaPiqLlyzjAbzAaXfU1y",ce="vveb4Rn0dK_r8YUM7L_n",ue=n.memo((function(e){var i;let{uri:a,togglePlay:l,isPlaying:t,isActive:s,spec:r,logger:o,backgroundColor:d,name:c,artists:u,isPlayable:m,sharingInfo:g}=e;const b=(0,X.o)(),k=(0,$.k)(),p=(0,_.y)(),x=(0,n.useMemo)((()=>r.actionBarFactory()),[r]),[y,j]=(0,_.Z)(a),N=(0,n.useCallback)((()=>{const e=(0,J.aK)({isPlaying:t,isActive:s,spec:x.playButtonFactory(),logger:o,uri:a});l({loggingParams:e})}),[t,s,l,x,o,a]),S=(0,n.useCallback)((async()=>{let e;const i=x.saveButtonFactory();e=y?i.hitDislike({itemToBeDisliked:a}):i.hitLike({itemToBeLiked:a}),o.logInteraction(e),b({targetUri:a,intent:y?"unsave":"save",type:"click"});try{await j(!y)}catch{}}),[b,a,y,j,x,o]),I=(0,ie.Q)(),w=(0,K.j)();return(0,C.jsx)(Q.o,{backgroundColor:d,children:(0,C.jsxs)(Q.F,{children:[(0,C.jsx)(f.$,{onClick:N,disabled:!m,isPlaying:t,size:w,uri:a}),I&&(0,C.jsx)(B.Nh,{spec:x,children:(0,C.jsx)(ee.K,{entityName:c,contextUri:a,activationPlacement:"bottomEnd",size:w})}),(0,C.jsx)(W.x,{uri:a,action:G.sr.SAVE_ALBUM,children:(0,C.jsx)(Y.H,{isAdded:!!y,onClick:S,disabled:!(k||null!=p&&p.getCapabilities().canModifyOffline),size:w})}),(0,C.jsx)(Z.o,{uri:a,isFollowing:!!y,onClick:(e,i)=>(0,J.l7)(i,x.downloadButtonFactory(),o,a),onFollow:S,size:w}),(0,C.jsx)(P.yj,{onShow:()=>(0,J.qq)(x,o),menu:(0,C.jsx)(v.Y,{uri:a,artistUri:null==u||null===(i=u[0])||void 0===i?void 0:i.uri,sharingInfo:g}),children:(0,C.jsx)(H.z,{label:h.ag.get("more.label.context",c),size:w})}),(0,C.jsx)("div",{className:ce,children:(0,C.jsx)(D.F,{property:q.FM,renderNewExperience:()=>(0,C.jsx)(z.A,{options:[],onSelect:()=>{},selected:null,enableViewModeMenu:!0})})})]})})}));var me=a(36767);const ge=864e5,he=365.25*ge;var be=a(78344),ve=a(58082),ke=a(30485),pe=a(64518),xe=a(3839),ye=a(37959),je=a(73196);var fe=a(72162),Ne=a(81037),Se=a(55147),Ie=a(47200),we=a(10732),Ce=a(27816),Ae=a(38914),Le=a(82298),Fe=a(53885);var Ue=a(79709),Pe=a(11435),Me=a(58994),Te=a(98119),Re=a(20704);const Ee="TCmZzqInstJMZjkHgnw3",Be="PeNI572tTpqsN23o3QhJ",Ve="oUsSfFiifMPXqW0kHjR6",Oe="XKvEMQZlPfPncTqiitM5",De="GdbPVlmUCW0Q6ZZ0z0wh",ze="Hu7O5y7x5c7wUYFbnIoS",_e=n.memo((function(e){const{images:i,title:a,isOpen:l,onClose:t}=e,s=(0,n.useMemo)((()=>(0,Re.X)(i,{desiredSize:1e4})),[i]);return s?(0,C.jsx)(Me.Z,{className:Ee,isOpen:l,onRequestClose:t,animation:{modal:{base:Oe,afterOpen:De,beforeClose:ze}},animated:!0,children:(0,C.jsxs)("div",{style:{"--image-width":`${s.width}px`,"--image-height":`${s.height}px`},className:Be,children:[(0,C.jsx)(Te.E,{loading:"eager",alt:a,src:s.url,className:Ve}),(0,C.jsx)(Pe.o,{onClick:t,semanticColor:"textBase",children:h.ag.get("web-player.cover-art-modal.close")})]})}):null}));var qe=a(94467),Qe=a(19315);const Ye=e=>{let{releases:i}=e;return(0,C.jsx)(qe.v,{children:i.map((e=>(0,C.jsx)(Qe.s,{role:"menuitem",to:(0,Se.EC)(e.uri).toURLPath(!0),children:e.name},e.uri)))})};var Ze=a(35691),He=a(80414),We=a(3635);const Ke=n.lazy((()=>a.e(2214).then(a.bind(a,92214))));function Xe(e){switch(e){case He.V.Single:return h.ag.get("single");case He.V.Ep:return h.ag.get("ep");case He.V.Compilation:return h.ag.get("compilation");case He.V.Audiobook:return h.ag.get("card.tag.audiobook");case He.V.Album:default:return h.ag.get("album")}}const $e=e=>{var i,a,l,j,N,S,I,w,T,D;let{uri:z,album:_}=e;const q=(0,o.TH)(),{spec:Q,logger:Y,UBIFragment:Z}=(0,B.fU)(g.w,{data:{uri:z}}),H=(0,n.useMemo)((()=>Q.trackListFactory()),[Q]),W=(0,n.useMemo)((()=>Q.moreByArtistShelfFactory()),[Q]),K=_.moreAlbumsByArtist,X=parseInt(new URLSearchParams((0,o.TH)().search).get("index")||"0",10),$=(0,F.Y)(z),{usePlayContextItem:J,togglePlay:G,isPlaying:ee,isActive:ie}=(0,R.n)({uri:$},{featureIdentifier:"album"}),ce=(0,n.useCallback)(((e,i)=>{if(Q){const e=Q.headerFactory().artistNameFactory().hitUiNavigate({destination:i.creator.uri});Y.logInteraction(e)}}),[Y,Q]),{isOpen:Pe,openModal:Me,closeModal:Te}=(()=>{const[e,i]=(0,n.useState)(!1);return{isOpen:e,openModal:(0,n.useCallback)((()=>i(!0)),[]),closeModal:(0,n.useCallback)((()=>i(!1)),[])}})(),Re=(0,m.W6)(je.DUY,{loadingValue:!1})?{onClick:Me,ariaLabel:h.ag.get("web-player.album.open_coverart_modal")}:{},Ee=(0,n.useCallback)((()=>new URLSearchParams(q.search.slice(1)).get("highlight")||""),[q.search]),Be=_.uri,Ve=_.name,Oe=_.albumType,De=null===(i=_.release)||void 0===i?void 0:i.date,ze=null===(a=_.release)||void 0===a?void 0:a.precision,qe=_.nrTracks,Qe=_.images,Ze=null===(l=_.extractedColors)||void 0===l?void 0:l.colorRaw.hex,He=_.artists,$e=_.isPlayable,Je=_.isCatalogueRestricted,Ge=_.copyright.items,ei=_.courtesyLine,ii=_.duration.durationMs,ai=_.duration.isEstimate,ni=Ee(),li=(null===(j=(0,r.v9)(Fe.Gg).overrides)||void 0===j?void 0:j.locale)??h.ag.getLocaleForTranslation(),ti=(0,Ue.k)({uri:z,type:"locale"}),si=(0,E.OT)({albumName:Ve,albumType:Oe,albumArtists:He.map((e=>e.name)).join(h.ag.getSeparator()),shouldLocalize:ti,i18n:h.ag});(0,U.Y5)(Ze||null);const{albumILRAboveEnabled:ri,albumILRBelowEnabled:oi}=(()=>{const e=(0,ye.E)(),i=(0,o.TH)(),a=(0,m.W6)(je.t2x),n=(0,pe.vI)(xe.k.ILRAlbumAbove,i),l=(0,pe.vI)(xe.k.ILRAlbumBelow,i);return e?{albumILRAboveEnabled:!l&&(n||a===je.wPk.ABOVE),albumILRBelowEnabled:!n&&(l||a===je.wPk.BELOW)}:{albumILRAboveEnabled:!1,albumILRBelowEnabled:!1}})(),di=function(e){return(0,n.useMemo)((()=>{if(null==e||!e.date)return null;if("day"===e.precision){const i=new Date(e.date),a=(new Date).getTime()-i.getTime(),n=a%he;return n<3.5*ge||n>312552e5?Math.round(a/he):null}return null}),[e])}(_.release),{isCompactMode:ci}=(0,L.mJ)(),ui=(e=>{const i=(0,we.g)(),a=(0,Ce.s4)(),l=(0,m.W6)(je.t2x),t=(0,r.v9)(Fe.n5),s=(0,r.v9)(Le.rZ);return(0,n.useCallback)((async()=>{if(!(0,Se.YF)(e))return;const n={category:"album_ilr_component_visible",action:"viewed",variant:l,label:"dwp",os:(0,Ae.y)(),context:e,country:t?s:"",sp_t:(0,Ie.vQ)("sp_t")};i?a.send((0,Ne.k)(n)):a.send((0,fe.x)(n))}),[e,s,a,i,t,l])})(z),{ref:mi,inView:gi}=(0,s.YD)({threshold:0});return(0,n.useEffect)((()=>{gi&&ui()}),[gi,ui]),(0,C.jsxs)("section",{className:ae,"data-testid":"album-page",children:[(0,C.jsx)(k.$,{children:si}),null!==di?(0,C.jsx)(n.Suspense,{fallback:null,children:(0,C.jsx)(Ke,{colorLight:null==_||null===(N=_.extractedColors)||void 0===N?void 0:N.colorLight.hex,colorDark:null==_||null===(S=_.extractedColors)||void 0===S?void 0:S.colorDark.hex,name:Ve,years:di})}):null,(0,C.jsxs)(p.gF,{backgroundColor:Ze,children:[(0,C.jsxs)(x.W,{children:[(0,C.jsx)(f.$,{size:"medium",onClick:()=>G(),disabled:!$e,isPlaying:ee,uri:z}),(0,C.jsx)(y.i,{text:Ve,dragUri:z,dragLabel:Ve})]}),(0,C.jsx)(P._P,{menu:(0,C.jsx)(v.Y,{uri:_.uri,artistUri:null==He||null===(I=He[0])||void 0===I?void 0:I.uri,sharingInfo:_.sharingInfo}),children:(0,C.jsx)(p.Oz,{dragUri:Be,images:Qe,name:Ve,placeholderType:"album",...Re})}),(0,C.jsxs)(p.sP,{children:[(0,C.jsx)(be.g,{children:Xe(Oe)}),(0,C.jsx)(P._P,{menu:(0,C.jsx)(v.Y,{uri:_.uri,artistUri:null==He||null===(w=He[0])||void 0===w?void 0:w.uri,sharingInfo:_.sharingInfo}),children:(0,C.jsx)(p.xd,{dragUri:_.uri,dragLabel:_.name,scaleAtMinWidth:p.vz,children:Ve})}),(0,C.jsx)(p.QS,{creators:He,onCreatorClick:ce,releaseDate:De,releaseDatePrecision:ze,totalItems:qe,durationMilliseconds:ii,isEstimatedDuration:ai,hasTracks:!0})]})]}),(0,C.jsx)(ue,{backgroundColor:Ze,uri:z,togglePlay:G,isPlaying:ee,isActive:ie,spec:Q,logger:Y,sharingInfo:_.sharingInfo,name:_.name,artists:_.artists,isPlayable:_.isPlayable}),Je?(0,C.jsxs)("div",{className:ne,children:[(0,C.jsx)(d.x,{as:"h2",variant:"bodyMediumBold",className:le,children:h.ag.get("windowed.product-album-header")}),(0,C.jsx)("div",{className:te,children:h.ag.get("windowed.product-album-description")})]}):null,(0,C.jsxs)("div",{className:"contentSpacing",children:[(0,C.jsx)(Z,{spec:H,children:(0,C.jsx)(me.L,{ariaLabel:Ve,nrTracks:(0,We.y)(_.discs)?_.discs.totalCount+qe:qe,discs:_.discs,albumUri:Be,highlightUri:ni,scrollToIndex:X,usePlayContextItem:J,initalTracks:_.items,isCompactMode:ci})}),(0,C.jsxs)("div",{className:oe,children:[(0,C.jsxs)("div",{children:[De&&(0,C.jsx)(d.x,{as:"p",variant:"bodySmall",children:(0,O.BI)((0,O.RX)(De),li,{year:"numeric",month:"long",day:"numeric"},ze)}),(0,C.jsx)(M.k,{copyrights:Ge,courtesyLine:ei})]}),_.releases.items.length>0&&(0,C.jsx)(P.xV,{menu:(0,C.jsx)(Ye,{releases:_.releases.items}),children:(e,i,a)=>(0,C.jsxs)("button",{ref:a,className:re,type:"button",onClick:i,children:[(0,C.jsx)(d.x,{variant:"bodySmall",children:h.ag.get("album-page.more-releases",_.releases.items.length)}),e?(0,C.jsx)(c.U,{size:"small"}):(0,C.jsx)(u.i,{size:"small"})]})})]})]}),ri&&(0,C.jsx)("div",{className:t()("contentSpacing",de),"data-testid":"placeholder-album-ilr-above",children:(0,C.jsx)(ve.y,{subtitle:h.ag.get("internal-link-recommender.based-on-this-album"),uri:_.uri,inViewRef:mi,entityType:V.p.ALBUM})}),(0,C.jsx)(A,{albumName:Ve,albumURI:Be}),(0,C.jsxs)(C.Fragment,{children:[(null==K?void 0:K.length)>0&&(0,C.jsx)("div",{className:"contentSpacing",children:(0,C.jsx)(Z,{spec:W,children:(0,C.jsx)(ke.q,{index:0,id:"more-albums",className:se,title:h.ag.get("album-page.more-by-artist",null==He||null===(T=He[0])||void 0===T?void 0:T.name),total:K.length,seeAllUri:`${null==He||null===(D=He[0])||void 0===D?void 0:D.uri.replace("artist","app:artist")}:discography`,seeAllLabel:h.ag.get("artist-page.show-discography"),alwaysShowSeeAll:!0,children:K.map(((e,i)=>(0,C.jsx)(b.i,{index:i,artists:He,images:e.images||[],name:e.name,uri:e.uri,year:e.year,type:e.albumType,sharingInfo:e.sharingInfo},e.uri)))})})}),oi&&(0,C.jsx)("div",{className:t()("contentSpacing",de),"data-testid":"placeholder-album-ilr-below",children:(0,C.jsx)(ve.y,{subtitle:h.ag.get("internal-link-recommender.based-on-this-album"),uri:_.uri,inViewRef:mi,entityType:V.p.ALBUM})})]}),(0,C.jsx)(_e,{title:si,isOpen:Pe,onClose:Te,images:Qe})]})},Je=n.memo((function(){const{albumId:e}=(0,o.UO)(),i=`spotify:album:${e}`,{loading:a,error:n,data:l,canLoadOffline:t}=(0,Ze.j)(i);return a||!l?(0,C.jsx)(j.h,{hasError:null!==n,loadOffline:t,errorMessage:h.ag.get("error.not_found.title.album")}):(0,C.jsx)(T.fd,{surface:T.Tg.ALBUM,uris:[i],children:(0,C.jsx)($e,{uri:i,album:l})})}))},64518:(e,i,a)=>{a.d(i,{vI:()=>n});a(82693),a(61325),a(6882),a(36433),a(38910);const n=(e,i)=>{const a=i?new URLSearchParams(i.search):void 0;return"1"===(null==a?void 0:a.get(e))}},3839:(e,i,a)=>{a.d(i,{k:()=>n});let n=function(e){return e.I18nSEO="i18nSEO",e.RTPTrackCredits="rtpv2p2",e.I18nAdditionalPages="i18nap",e.RichPlaylistPages="rpp",e.LFC="lfc",e.ILRAlbum="ilra",e.ILRAlbumAbove="ilraa",e.ILRAlbumBelow="ilrab",e}({})}}]);
//# sourceMappingURL=xpui-routes-album.88bff8f6.js.map