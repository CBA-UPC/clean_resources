import{ai as B,aA as P,aB as U,as as D,ax as z,Q as Z,b4 as ee,aC as E,aK as te,ds as se,dt as ne,bJ as ie,du as ae,dv as oe,aD as O,dw as le,cb as re,l as A,ay as G,aa as S,bR as ce}from"./itinerary-entities.5f897bcd.js";import{l as H,r as C,G as o,H as T,I as r,z as t,P as p,F as N,$ as J,a7 as v,a6 as a,Y as s,x as $,al as de,c as b,q as ue,Q as g,R as me,X as fe,an as V,ao as x,w as ve,a as ye,N as ke,O as he}from"./graphql.5cf3693b.js";import{_ as be}from"./notFound.914cc6f2.js";import{R as _e}from"./ReserveDetails.11d9e8c9.js";import{bQ as F}from"./service-client.4862e840.js";import{M as pe}from"./MrAccordion.d68da565.js";import{T as Ie}from"./TabBar.b3960988.js";import{d as j,M as Q}from"./mixins.c083cc34.js";import{M as Te}from"./entry.a7cea746.js";import{_ as ge}from"./MrInfiniteScroll.vue.044c5ead.js";const $e={key:0,class:"lang-btn-container"},Me={key:1,class:"ticket-view"},we={class:"ticket-image-container"},Re=["src"],Se={class:"ticket-btn-container"},Pe=H({__name:"ViewTicketDialog",props:{ticketFiles:{default:},emits:["close"],setup(e,{emit:y}){const i=C(null);unction k(){i.value&&window.open(i.value.Url||"","_blank")}const u=B();return(h,l)=>(o(),T(U,{title:t(u).t("ViewTicket.downloadTicket"),onClose:l[1]||(l[1]=m=>y("close"))},{default:r(()=>{var m;return[t(i)?(o(),p("div",Me,[s("div",we,[s("img",{class:"ticket-image",alt:"Ticket",src:((m=t(i))==null?void 0:m.Preview)||void 0},null,8,Re)]),s("div",Se,[$(P,{"full-width":"",type:"bordered",onClick:l[0]||(l[0]=},{default:r(()=>[v(a(t(u).t("ViewTicket.close")),1)]),_:1}),$(P,{"full-width":"",type:"filled",onClick:k},{default:r(()=>[v(a(t(u).t("ViewTicket.downloadTicket")),1)]),_:1})])])):(o(),p("div",$e,[(o(!0),p(N,null,J(h.ticketFiles||[],(f,M)=>(o(),T(P,{key:f.LanguageCode||"","full-width":"",type:M===0?"filled":"transparent",onClick:,{default:r(,_:2},1032,["type","onClick"]))),128))]))]}),_:1},8,["title"]))}});const Ce=D(Pe,[["__scopeId","data-v-659f0c86"]]),Be=e=>(V("data-v-4585a931"),e=e(),x(),e),De={class:"ticket-box-container"},He={class:"ticket-box-info"},Fe={class:"reserve-icon-container"},Ye={class:"ticket-date"},ze={class:"trip-info"},Ae={class:"route"},Ne={class:"ticket-status-container"},Ve={class:"date-time"},xe={class:"buttons"},Le=Be(()=>s("div",{class:"divider"},null,-1)),Oe={class:"container"},je=H({__name:"Ticket",props:{reserve:{},itinerary:{},unpaid:{type:Boolean},bill:{}},emits:["open-details"],setup(e,{emit:y}){var L;z();const{day:i}=A(),n=B(),k=de(),u=Z(),{isMobileSize:h}=ee(),{open:l}=E({component:Ce,attrs:{ticketFiles:((L=e.reserve)==null?void 0:L.TicketFiles)||[]}}),m=C(!1),f=C(!1),M=b(()=>{var d;return e.itinerary?e.itinerary.Origin||"":(d=e.reserve.Itineraries)!=null&&d.length?e.reserve.Itineraries[0].Origin||"":n.t("Ticket.none")}),w=b(()=>{var d;return e.itinerary?e.reserve.ReserveType==="Hotel"?`${n.t("Ticket.hotel")} ${e.itinerary.HotelName}`:e.itinerary.Destination||"":(d=e.reserve.Itineraries)!=null&&d.length?e.reserve.ReserveType==="Hotel"?`${n.t("Ticket.hotel")} ${e.reserve.Itineraries[e.reserve.Itineraries.length-1].HotelName}`:e.reserve.IsRoundTrip?e.reserve.Itineraries[0].Destination||"":e.reserve.Itineraries[e.reserve.Itineraries.length-1].Destination||e.reserve.ReserveTitle||"":n.t("Ticket.none")}),Y=b(()=>{var d;return e.itinerary?e.reserve.ReserveType==="Hotel"?`${n.t("Ticket.checkin")}: ${R(e.itinerary.CheckIn||"")} ${n.t("Ticket.checkout")}: ${R(e.itinerary.Checkout||"")}`:R(e.itinerary.DepartureTime||""):(d=e.reserve.Itineraries)!=null&&d.length?e.reserve.ReserveType==="Hotel"?`${n.t("Ticket.checkin")}: ${R(e.reserve.Itineraries[0].CheckIn||"")} ${n.t("Ticket.checkout")}: ${R(e.reserve.Itineraries[0].Checkout||"")}`:R(e.reserve.Itineraries[0].DepartureTime||""):n.t("Ticket.none")}),_={[F.Canceled]:{text:n.t("Ticket.canceled"),class:"cancel"},[F.Finalized]:{text:n.t("Ticket.issued"),class:"issued"},[F.InProgress]:{text:n.t("Ticket.issuing"),class:"issuing"},[F.None]:{text:n.t("Ticket.none"),class:"none"},unpaid:{text:"پرداخت نشده",class:"unpaid"}},I=b(()=>e.unpaid?_.unpaid:e.reserve.ReserveStatus?_[e.reserve.ReserveStatus]:k.default),q=b(()=>{switch(e.reserve.ReserveType){case"Bus":return oe;case"Train":return ae;case"Flight":return ie;case"Hotel":return ne;case"SuggestedService":return se;default:return te}}),K=b(()=>["Canceled","Finalized"].includes(e.reserve.ReserveStatus||"")),R=d=>i.js(d).format(`D MMMM YYYY ${n.t("Bill.hour")} rve&&l()},W=()=>{K.value&&(c.value&&(m.value=!m.value),y("open-details"))};return ue(()=>{f.value=!!(u!=null&&u.isFeatureEnabled("flight-info-links-enabled"))&&e.reserve.ReserveType==="Flight"}),(d,yt)=>(o(),p("div",De,[s("div",{class:"ticket-box",onClick:W},[s("div",He,[s("div",Fe,[$(O,{icon:t(q),color:"var(--blue-400)"},null,8,["icon"])]),s("div",Ye,[s("div",ze,[s("div",Ae,[d.reserve.ReserveType!=="Hotel"&&t(M)?(o(),p(N,{key:0},[v(a(t(M))+" ",1),$(O,{class:"arrow-icon",icon:d.reserve.IsRoundTrip?t(le):t(re),color:"var(--gray-600)"},null,8,["icon"])],64)):g("",!0),v(" "+a(t(w)),1)]),s("div",Ne,[t(I)?(o(),p("span",{key:0,class:me(["ticket-status",t(I).class])},a(t(I).text),3)):g("",!0)])]),s("div",Ve,a(t(Y)),1)])]),s("div",xe,[t(f)?(o(),T(P,{key:0,type:"bordered",size:"medium",class:"details-button",link:"nuxt",href:"/flight-info"},{default:r(()=>[v(" اطلاعات پرواز ")]),_:1})):g("",!0),d.reserve.ReserveStatus==="Finalized"?(o(),T(P,{key:1,type:"filled",class:"file-btn",onClick:X,size دانلود فایل بلیط ")]),_:1})):g("",!0)])]),Le,s("div",Oe,[$(pe,{size:"small",title:"جزئیات بلیط و کنسلی",isSelected:!0,"header-full-width":!1,"header-position":t(h)?"center":"end"},{default:r(()=>[$(_e,{currentReserve:d.reserve,currentBill:d.bill},null,8,["currentReserve","currentBill"])]),_:1},8,["header-position"])]),t(m)?fe(d.$slots,"default",{key:0},void 0,!0):g("",!0)]))}});const Qe=D(je,[["__scopeId","data-v-4585a931"]]),Ue={class:"content"},Ee={class:"title"},Ge={class:"price"},Je={class:"title"},qe={class:"price"},Ke=H({__name:"PaymentInfo",props:{bill:{}},setup(e){const{day:y}=A(),i=B(),n=C(0),k=C(!1),u=z(),{refunds:h}=G(u),l=[{title:i.t("PaymentInfo.paymentInfo")},{title:i.t("PaymentInfo.refundInfo")}],m=j([{key:"Status",title:i.t("PaymentInfo.status")},{key:"CreationTime",title:i.t("PaymentInfo.creationTime")},{key:"Amount",title:i.t("PaymentInfo.amount")},{key:"Gateway",title:i.t("PaymentInfo.paymentMethod")},{key:"OrderId",title:i.t("PaymentInfo.orderNum")},{key:"FinalizationTime",title:i.t("PaymentInfo.completionTime")},{key:"Reference",title:i.t("PaymentInfo.pnrNum")}]),f=j([{key:"Status",title:"وضعیت"},{key:"Description",title:i.t("PaymentInfo.description")},{key:"Amount",title:i.t("PaymentInfo.amount")},{key:"Reference",title:"رفرنس"},{key:"Time",title:i.t("PaymentInfo.creationTime")},{key:"CardHolder",title:"به نام"},{key:"CardNumber",title:"شماره کارت"}]),M=b(()=>{var _;return S(((_=e.bill.Payments)==nul=>I+(c.Amount||0),0))||0)}),w=b(()=>S(h.value.reduce((_,I)=>_+(I.Amount||0),0)));ve(n,_=>{_===1&&Y()});async function Y(){k.value=!0,await u.getRefunds({billCode:e.bill.BillCode||"",billId:e.bill.Id}),k.value=!1}return(_,I)=>(o(),T(U,n,{modelValue:t(n),"onUpdate:modelValue":I[0]||(I[0]=c=>ye(n)?n.value=c:null),class:"payment-tab-bar",tabs:l,"sticky-top":0},null,8,["modelValue"]),s("div",Ue,[t(n)===0?(o(),T(Q,{key:0,headers:t(m),items:_.bill.Payments||[],"desktop-style":"vertical"},{"item.Status":r(({value:c})=>[v(a(c?t(i).t("PaymentInfo.successful"):t(i).t("PaymentInfo.unsuccessful")),1)]),"item.CreationTime":r(({value:c})=>[v(a(t(y).js(c).format("D MMMM YYYY - HH:mm")),1)]),"item.Amount":r(({value:c})=>[v(a(t(S)(c)),1)]),"item.FinalizationTime":r(({value:c})=>[v(a(t(y).js(c).format("D MMMM YYYY - HH:mm")),1)]),"header.append.Amount":r(()=>[s("span",Ee,a(t(i).t("PaymentInfo.totalPayment")),1)]),"item.append.Amount":r(()=>[s("span",Ge,a(t(M)),1)]),_:1},8,["headers","items"])):(o(),T(Q,{key:1,headers:t(f),items:t(h),loading:t(k),"desktop-style":"vertical"},{"item.Amount":r(({value:c})=>[v(a(t(S)(c)),1)]),"item.Time":r(({value:c})=>[v(a(t(y).js(c).format("D MMMM YY HH:mm")),1)]),"header.append.Amount":r(()=>[s("span",Je,a(t(i).t("PaymentInfo.totalRefund")),1)]),"item.append.Amount":r(()=>[s("span",qe,a(t(w)),1)]),_:1},8,["headers","items","loading"]))])]),_:1}))}});const Xe=D(Ke,[["__scopeId","data-v-c900a0ae"]]),We=e=>(V("data-v-ab84a217"),e=e(),x(),e),Ze={class:"bill-container"},et={class:"bill-info"},tt={class:"bill-number"},st={class:"bill-detail"},nt={key:0,class:"replace"},it={co"},ot={class:"bill-amount"},lt=We(()=>s("div",{class:"delimiter"},null,-1)),rt=H({__name:"Bill",props:{bill:{}},setup(e){const{day:y}=A(),{open:i}=E({component:Xe,attrs:{bill:e.bill}}),n=B(),k=b(()orm YYYY ${n.t("Bill.hour")} HH:mm`)),u=b(()=>S(e.bill.BillPrice)),h=()=>{i()};return(l,m)=>(o(),p("div",Ze,[l.bill.Status!==3?(o(),T(Te,{key:0,type:"warning",items:[{message:"پرداخت این صورت‌حساب تأیید نشده است. در صورتی که مبلغی از حساب شما کسر شده حداکثر تا ۷۲ ساعت دیگر به حسابتان برگشت می‌شود."}]},null,8,["items"])):g("",!0),s("div",et,[s("div",tt,[s("div",st,[s("p",null,a(t(n).t("Bill.billCode"))+" "+a(l.bill.BillCode),1),l.bill.ReplacedForBillCode?(o(),p("p",nt," جایگزین: "+a(l.bill.ReplacedForBillCode),1)):g("",!0),s("p",it,a(t(k)),1)])]),s("div",at,[s("div",ot,a(t(u)),1),l.bill.Payments&&l.bill.Payments.length?(o(),p("div",{key:0,class:"btn-white-noborder",onClick:h},a(t(n).t("Bill.paymentInfo")),1)):g("",!0)])]),(o(!0),p(N,null,J(l.bill.Res,unpaid:l.bill.Status!==3,bill:l.bill},null,8,["reserve","unpaid","bill"]))),128)),lt]))}});const ct=D(rt,[["__scopeId","data-v-ab84a217"]]),dt=e=>(V("data-v-2a1758b4"),e=e(),x(),e),ut={class:"root"},mt={class:"not-found"},ft=dt(()=>s("img",{alt:"Not found",src:be}mbers:{type:Boolean},loadMoreOnScroll:{type:Boolean}},emits:["loadMore"],setup(e,{emit:y}){const i=z(),{bills:n,loadingStatus:k}=G(i);function u(){e.loadMoreOnScroll&&y("loadMore")}const h=b(()=>n.value.length===0&&k.value==="success"),l=B();return(m,f)=>(o(),p("div",ut,[$(ge,{items:t(n),"has-next":m.loadMoreOnScroll,onLoad:u},{item:r(({item:M,index:w})=>[$(ct,{bill:M,number:m.showNumbers?w+1:void 0},null,8,["bill","number"])]),_:1},8,["items","has-next"]),ke(s("div",mt,[ft,s("p",null,a(t(l).t("Reserves.notFound")),1)],512),[[he,t(h)]]),t(k)!=="success"?(o(),T(ce,{key:0})):g("",!0)]))}});const wt=D(vt,[["__scopeId","data-v-2a1758b4"]]);export{wt as R};
