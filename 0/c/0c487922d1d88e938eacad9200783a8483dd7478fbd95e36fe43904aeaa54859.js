(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[640,166],{"6LLJ":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("a3FV"),o=n("V1Qu"),a=n("ovfp");function i(e){if(!e||!e.sharePointResourceId)return Promise.reject("no sharePointResourceId");var t=Object(o.j)(["id","name","organizationAssets"],!1,!1,"organizationAssets/officeTemplateLibrary%20ne%20null"),n=e.inMockMode&&!e.isConsumer?"".concat(e.officeHomeApiRoot,"/_api/v2.1/drives/enterpriselibraries"):"".concat(Object(o.e)(e.sharePointResourceId,e,!1,!0),"/drives").concat(t?"?"+t:"");return Object(a.a)(r.a.TemplateLibrariesRequest,"Template_Libraries",n,"network-first",e,"SharePoint",e.sharePointResourceId,"BrowseOrgTemplates","AUO")}},"7qt8":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("QjXU"),o=n("MJsD"),a=n("B5kz"),i=n("W7wX"),c=n("CDFH");function s(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(o.a)()];case 1:return e=n.sent(),[4,Object(i.a)()];case 2:return t=n.sent(),[2,a.a.fetchQuery(["WorkloadPublicDataConfig"],(function(){return Object(c.a)(e,t)}),{staleTime:1/0,cacheTime:1/0})]}}))}))}},EVfI:function(e,t,n){"use strict";n.r(t),n.d(t,"getDataManager",(function(){return d}));var r=n("QjXU"),o=n("P1B7"),a=n("m32Q"),i=n("lkvL"),c=n("6LLJ"),s=n("tDEE"),u="enterprise-templates-api-react",l=n("vS1s");function d(e){var t=e.identity,n=e.officeComponentContext,d=e.userEntitlements,f=Object(l.getDataManager)(e);return t.isMsa?f:Object(r.__assign)(Object(r.__assign)({},f),{getEnterpriseTemplateLibraries:function(e){return function(e){var t=e.SharePointResourceId,n=e.OneDriveResourceId,l=e.correlationId,d=e.getAccessToken,f=e.handleRevalidation,m=e.jwtAuthEnabled,p=e.inMockMode,b=e.isConsumer,v=e.userId,h=e.officeHomeApiRoot;return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,j,g=this;return Object(r.__generator)(this,(function(I){return e={correlationId:l,getAccessToken:d,inMockMode:p,isConsumer:b,jwtAuthEnabled:m,officeHomeApiRoot:h,sharePointResourceId:t,oneDriveResourceId:n},j=),[2,Object(o.a)((function(){return function(e){return Object(c.a)(e).then((function(e){var t=[];return e&&(t=e.value.map(()),t}))}(e)}),(function(){var e=Object(s.a)(),t=Object(r.__spreadArray)([],Object(r.__read)(e),!1).reverse();return Object(a.a)({userId:v,collectionName:u,collectionVersion:1,key:j,plugins:t})}),(function(e){return Object(r.__awaiter)(g,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return t=Object(s.a)(),[4,Object(i.a)({userId:v,collectionName:u,collectionVersion:1,key:j,data:e,plugins:t})];case 1:return n.sent(),[2]}}))}))}),f)]}))}))}({SharePointResourceId:d.SharePointResourceId,OneDriveResourceId:d.OneDriveResourceId,correlationId:n.correlationId,getAccessToken:n.getAccessToken,jwtAuthEnabled:n.jwtAuthEnabled,inMockMode:n.inMockMode,isConsumer:t.isMsa,userId:t.puid,officeHomeApiRoot:n.officeHomeApiRoot,handleRevalidation:e})}})}},WJ2C:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("QjXU"),o=n("MJsD"),a=n("B5kz"),i=n("W7wX"),c=n("/5so");function s(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(o.a)()];case 1:return e=n.sent(),[4,Object(i.a)()];case 2:return t=n.sent(),[2,a.a.fetchQuery(["ConsumerInstallInfoConfig"],(,{staleTime:1/0,cacheTime:1/0})]}}))}))}},"k+5q":function(e,t,n){"use strict";.d(t,"a",(function(){return r}))},ovfp:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("8wW2"),o=n("Wa5Y"),a=new Map;function i(e,t,n,i,c,s,u,l,d){void 0===s&&(s="None");var f="".concat(n,"/").concat(i),m=function(e){if(a.has(e)){var t=a.get(e);if(t&&t.promise&&(!t.expiryTime||t.expiryTime>new Date))return t.promise;a.delete(e)}return null}(f);if(m)return m;var p={headers:{accept:"application/json",Prefer:"allow-zerobyte",application:"officehome"}},b=new Promise((function(a,f){l&&p.headers&&(p.headers.scenario=l),d&&p.headers&&(p.headers.scenarioType=d),Object(o.a)(e,t,n,p,c.jwtAuthEnabled||!1,c.getAccessToken,c.officeHomeApiRoot,c.correlationId,s,{resourceUrl:u},i).then((function(e){e&&e.data?a(e.data):f({clientError:"No data returned"})})).catch((function(e){Object(r.a)().handleError(e,"QYFpr")}))}));return a.set(f,{promise:b}),b}},tDEE:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("j7b/"),o=n("lwUs");function a(){return[Object(o.a)(7*r.a)]}},vS1s:function(e,t,n){"use strict";n.r(t),n.d(t,"getDataManager",(function(){return A}));var r=n("QjXU"),o=n("Zmq1"),a=n("lbnC"),i=n("6ib3"),c=n("P1B7"),s=n("m32Q"),u=n("lkvL"),l=n("WJ2C"),d=n("7qt8"),f=n("vz6o");function m(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(l.a)()];case 1:return e=n.sent(),[4,Object(d.a)()];case 2:return t=n.sent(),[2,Object(f.a)({consumerInstallConfig:e,workloadPublicDataConfig:t})]}}))}))}var p=n("s1V1"),b=n("wYzw"),v=n("8wW2"),h=n("a3FV"),j=n("0TX8"),g=n("Wa5Y"),I=n("wiq1"),O=n("k+5q"),w=n("tDEE"),_="templates-api-react";function T(e){var t,n=e.app,l=e.identity,d=e.officeComponentContext,f=e.TemplatesConfig,T=e.handleRevalidation;return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,A,C,E,k,P,y=this;return Object(r.__generator)(this,(function(M){switch(M.label){case 0:return[4,Object(p.a)()];case 1:return e=M.sent().result,[4,m()];case 2:return A=M.sent(),C=Object(o.a)(),E=n===i.a.Visio?f.numVisioTemplates:f.numTemplates,k=function(e,t,n){var r,o,a;if(t)switch(e){case i.a.Excel:return null===(r=n.startPagesConsumerTemplatesCollectionIds)||void 0===r?void 0:r.excel;case i.a.PowerPoint:return null===(o=n.startPagesConsumerTemplatesCollectionIds)||void 0===o?void 0:o.powerpoint;case i.a.Word:return null===(a=n.startPagesConsumerTemplatesCollectionIds)||void 0===a?void 0:a.word;default:return}}(n,l.isMsa,f),P={correlationId:d.correlationId,getAccessToken:d.getAccessToken,getIdentity:inMockMode:d.inMockMode,jwtAuthEnabled:d.jwtAuthEnabled,workload:d.workload,officeHomeApiRoot:d.officeHomeApiRoot,app:n,templatesApiEndpoint:f.templatesApiEndpoint,officeMarket:d.preferredCulture,show:E-1,browserName:C.browser.browserType,flights:(null===(t=d.flights)||void 0===t?void 0:t.replace(/,\s*$/,""))||"",isPremium:l.isMsa&&A,isIw:(null==e?void 0:e.IsIw)||!1,isAdmin:(null==e?void 0:e.IsAdmin)||!1,isSmb:(null==e?void 0:e.IsSmb)||!1,isEdu:(null==e?void 0:e.IsEdu)||!1,isEduFaculty:(null==e?void 0:e.IsEduFaculty)||!1,isEduStudent:(null==e?void 0:e.IsEduStudent)||!1,authId:l.isMsa?1:2,firstVisitAgeInWeeks:Math.floor(Object(b.a)()/7),page:"StartPage",deploymentEnvironment:d.deploymentEnvironment||"",osName:C.platform.platformType,osVersion:Object(a.a)(C.platformVersion),templateCollectionId:k},[2,Object(c.a)((function(){return function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=function(e){var t="&".concat("browserName=").concat(e.browserName,"&").concat("flights=").concat(e.flights,"&").concat("isIw=").concat(e.isIw,"&").concat("isAdmin=").concat(e.isAdmin,"&").concat("isSmb=").concat(e.isSmb,"&").concat("isEduFaculty=").concat(e.isEduFaculty,"&").concat("isEduStudent=").concat(e.isEduStudent,"&").concat("authId=").concat(e.authId,"&").concat("firstVisitAgeInWeeks=").concat(e.firstVisitAgeInWeeks,"&").concat("page=").concat(e.page,"&").concat("deploymentEnvironment=").concat(e.deploymentEnvironment,"&").concat("osName=").concat(e.osName,"&").concat("osVersion=").concat(e.osVersion),n="".concat(e.officeHomeApiRoot,"/").concat(e.templatesApiEndpoint,"?").concat("culture=").concat(e.officeMarket,"&").concat("app=").concat(e.app,"&").concat("isEdu=").concat(e.isEdu,"&").concat("show=").concat(e.show).concat(e.isPremium?"&isPremium=1":"").concat(t);return void 0!==e.templateCollectionId&&""!==e.templateCollectionId&&(n+="&collectionId=".concat(e.templateCollectionId)),n}(e),[4,Object(j.a)({},e.inMockMode,e.workload,e.getIdentity)];case 1:return n=r.sent(),[2,Object(g.a)(h.a.TemplatesRequest,"Templates",t,n,e.jwtAuthEnabled,e.getAccessToken,e.officeHomeApiRoot,e.correlationId,"OfficeHome",{}).then((function(t){if(!t.data||!t.data.Templates||!t.data.Templates.Value||0===t.data.Templates.Value.length)return Promise.reject({clientError:"Invalid response"});var n={Template:Object(I.a)(t.data.Templates.Value,e.app),fromCache:!1};return n&&n.Template&&0!==n.Template.length?Promise.resolve(n):Promise.reject({clientError:"Null templates response"})})).catch((function(e){return Object(v.a)().handleError(e,"D5zZb"),Promise.reject({clientError:"Invalid response"})}))]}}))}))}(P)}),(function(){var e=Object(w.a)(),t=Object(r.__spreadArray)([],Object(r.__read)(e),!1).reverse();return Object(s.a)({userId:l.puid,collectionName:_,collectionVersion:1,key:Object(O.a)(n,P.officeMarket),plugins:t})}),(function(e){return Object(r.__awaiter)(y,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(w.a)(),[4,Object(u.a)({userId:l.puid,collectionName:_,collectionVersion:1,key:Object(O.a)(n,P.officeMarket),data:e,plugins:t})];case 1:return r.sent(),[2]}}))}))}),T)]}}))}))}function A(e){var t=this,n=e.identity,o=e.officeComponentContext,a=e.templatesConfig;return{getTemplatesData:function(e,i){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,T({app:e,identity:n,officeComponentContext:o,TemplatesConfig:a,handleRevalidation:i})];case 1:return[2,r.sent()];case 2:return t=r.sent(),[2,Promise.reject(t)];case 3:return[2]}}))}))},getTemplatesPageData:function(a,i){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t,c,s,u;return Object(r.__generator)(this,(function(l){switch(l.label){case 0:t=function(t){var n,o,a=e.locStrings.authPageResources.m365_authPageHeader,i={Id:"Default",LocalizedTitle:a,DisplayName:a},c={LicenceInfo:"",TemplatesData:{},TemplateCategories:{},TemplateCollections:(n={},n[i.Id]={Id:i.Id,Name:i.DisplayName,TemplateCategories:[i.Id]},n)},s=[];return t.Template.forEach((function(e){e.Categories&&0!==e.Categories.length||(e.Categories=[i]),c.TemplatesData[e.AssetId]=e,s.push(e.AssetId)})),c.TemplateCategories=((o={})[i.Id]=Object(r.__assign)(Object(r.__assign)({},i),{BlankTemplateAssetID:"",SamplesAssetID:s,Name:i.DisplayName}),o),c},c=l.label=1;case 1:return l.trys.push([1,3,,4]),[4,T({app:a,identity:n,officeComponentContext:o,TemplatesConfig:e.templatesConfig,handleRevalidation:)];case 2:return s=l.sent(),[2,c(s)];case 3:return u=l.sent(),[2,Promise.reject(u)];case 4:return[2]}}))}))}}}},wiq1:function(e,t,n){"use strict";n.d(t,"a",();var r=n("Tqea");function o(e,t){return e.reduce((function(e,n){return void 0!==n.AssetId&&(n.IsBlank=!1,t&&(n.Application=Object(r.a)(t)),e.push(n)),e}),[])}}}]);
//# sourceMappingURL=vendors~enterprise-tdp.55e0ffa0d3e45b60a483.chunk.v7.js.map