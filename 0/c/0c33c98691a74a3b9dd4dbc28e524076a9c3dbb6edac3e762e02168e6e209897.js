import{a as _}from"./vuex.esm-bundler_aa359dca_r24-02-0_b0_t240129-161140.js";import{H as p,P as C,L as y,A as d,B as u,I as r,O as m,J as l,Z as f,G as g,$ as x,a0 as M,X as $,V as S,W as w,D as L}from"./vendor_6ed58054_r24-02-0_b0_t240129-161140.js";import{t as A}from"./trapFocus_6aa864f5_r24-02-0_b0_t240129-161140.js";import{c as v,u as B}from"./index_31ad23dc_r24-02-0_b0_t240129-161140.js";import{u as k}from"./csrGlobalStoreAppState_f9ff4bfa_r24-02-0_b0_t240129-161140.js";import{B as b}from"./lsanalytics-loyalty_c6fb8ea0_r24-02-0_b0_t240129-161140.js";import{S as O}from"./SvgIcon_e55bd28a_r24-02-0_b0_t240129-161140.js";import{u as D}from"./csrViewStoreCart_eff1e54c_r24-02-0_b0_t240129-161140.js";import{_ as P}from"./_plugin-vue_export-helper_c27b6911_r24-02-0_b0_t240129-161140.js";import{a as N}from"./csrViewStoreCheckout_89574990_r24-02-0_b0_t240129-161140.js";import"./i18n_4b81f106_r24-02-0_b0_t240129-161140.js";import"./formatCurrency_d08cd85e_r24-02-0_b0_t240129-161140.js";import"./ssrGlobalStoreRoute_1f7c671b_r24-02-0_b0_t240129-161140.js";import"./csrGlobalStoreCart_c99ec818_r24-02-0_b0_t240129-161140.js";import"./csrGlobalStoreInternationalCarts_2b023aac_r24-02-0_b0_t240129-161140.js";import"./csrViewStoreInventory_328e6f57_r24-02-0_b0_t240129-161140.js";import"./productUtils_e3499a9f_r24-02-0_b0_t240129-161140.js";import"./ssrViewStoreProduct_cb84dadb_r24-02-0_b0_t240129-161140.js";import"./imageUtils_fcbf42ca_r24-02-0_b0_t240129-161140.js";import"./ssrGlobalStoreHeadMeta_ca820fb3_r24-02-0_b0_t240129-161140.js";import"./csrViewStorePickupInStore_9251cc88_r24-02-0_b0_t240129-161140.js";import"./csrViewStoreFavorite_1d3eb3f3_r24-02-0_b0_t240129-161140.js";import"./apiTimeout_7a14cc4a_r24-02-0_b0_t240129-161140.js";import"./lsanalytics-cart_5cb2710b_r24-02-0_b0_t240129-161140.js";import"./csrViewStorePaymentInfo_4f7a2838_r24-02-0_b0_t240129-161140.js";const R={inject:["mq"],components:{SvgIcon:O},data(){return{totalPoints:0,progressBarStep:80,progressBarStart:7,transactions:[],currentCoinStep:{},progressBarCheckPoints:[0,500,1e3,2e3,2500]}},computed:{...p(v,["paths","defaultCurrency","currencies","countryHasLoyaltyInLSE"]),...p(B,["locale","country"]),...C(k,["showPassportSlider"]),...p(D,["loyaltyData"]),..._("auth",["loggedIn"]),..._("userProfileState",["customerId","loyaltyId"]),loggedInAndUpdateRecord(){return`${this.customerId}-${this.loyaltyId}`},currencyName(){var t;return((t=this.defaultCurrency)==null?void 0:t.name)||""},coupons(){var t;return((t=this.loyaltyData)==null?void 0:t.loyaltyCoupons)??[]},points(){var t;return((t=this.loyaltyData)==null?void 0:t.totalPoints)??0},lowestValueCoupon(){return this.coupons[0]},currencyIsoCode(){var t,s,i;return this.lowestValueCoupon?((s=(t=this.currencies)==null?void 0:t.find(n=>(n==null?void 0:n.symbol)===this.lowestValueCoupon.currency))==null?void 0:s.isocode)??null:(i=this.defaultCurrency)==null?void 0:i.isocode},infoText(){var i;const t=this.locale.replace("_","-"),s=new Intl.NumberFormat(t,{style:"currency",currency:this.currencyIsoCode,minimumFractionDigits:0,maximumFractionDigits:0}).format(((i=this.currentCoinStep)==null?void 0:i.value)||0);return this.$t("i18n.needMoreCoinsInfo",{_pointsRequired_:this.progressBarCheckPoints[this.progressBarCheckPoints.length-1]-this.totalPoints,_voucherValue_:s})},getProgressWidth(){let t=0,s=0,i="",n=0,o=0;this.totalPoints>2500?(t=this.progressBarStep*4,o=0):this.totalPoints>=2e3?(t=this.progressBarStep*3,s=2e3,o=500):this.totalPoints>=1e3?(t=this.progressBarStep*2,s=1e3,o=1e3):this.totalPoints>=500?(t=this.progressBarStep,s=500,o=500):this.totalPoints>=0&&(t=this.progressBarStart,s=0,o=500);const e=(this.totalPoints-s)/o;return n=e<1?e*this.progressBarStep:0,i=`${t+n}px`,i}},methods:{navigateToRTMB(){b({action_detail:"member benefits"}),this.$router.push({path:this.paths.loyaltyCustomer}),this.showPassportSlider=!1},fetchLoyaltyData(){return this.$store.dispatch("userProfileState/fetchLoyaltyData")},fetchData(){Promise.all([this.fetchLoyaltyData()]).then(t=>{const{totalPoints:s=0,loyaltyCoupons:i=[]}=t[0]||{};this.totalPoints=s;const n=i==null?void 0:i.filter(o=>o.enabled===!0);return this.currentCoinStep=n[n.length-1],t})},reachedMileStone(t){return this.totalPoints>=t}},created(){this.loggedIn&&this.fetchData()},watch:{loggedInAndUpdateRecord(){this.$nextTick(()=>{this.loggedIn&&this.customerId&&this.loyaltyId&&this.fetchData()})}}},E=t=>(x("data-v-3b0f9836"),t=t(),M(),t),K={key:0,class:"coins-section"},V={class:"progress-bar"},H={class:"stepper"},F={class:"coin-progress-container"},j={xmlns:"http://www.w3.org/2000/svg",class:"coin-progress-mask",width:"340",height:"22",viewBox:"0 0 337 12",fill:"none"},q=E(()=>r("rect",{y:"3",width:"337",height:"8",rx:"4",fill:"#C9C9C9"},null,-1)),G=["width"],W=["fill","stroke"],U=["cx","fill","stroke"],z=["cx","fill","stroke"],J=["cx","fill","stroke"],X=["cx","fill","stroke"];function Z(t,s,i,n,o,e){const c=y("SvgIcon");return this.totalPoints?(d(),u("div",K,[r("h4",null,[m(c,{name:"coins-flat",class:"coin-stack-icon",title:"coin stack"}),r("b",null,l(t.$t("i18n.loyaltyCustomerCoinBalance")),1)]),r("h2",null,l(o.totalPoints)+" "+l(t.$t("i18n.loyaltycustomerCoinsAmount")),1),r("p",null,[r("span",null,l(t.$t("i18n.earningCoinsMeterTitle",{_currency_:e.currencyName})),1)]),r("div",V,[r("p",null,l(e.infoText),1),r("div",H,[r("div",F,[(d(),u("svg",j,[q,r("rect",{class:"coin-progress-indicator",y:"3",width:e.getProgressWidth,height:"8",rx:"4",fill:"#C41230"},null,8,G),r("circle",{cx:"7",cy:"7",r:"5.5",fill:e.reachedMileStone(0)?"#C41230":"#C9C9C9",stroke:e.reachedMileStone(0)?"#C41230":"#C9C9C9","stroke-width":"3"},null,8,W),r("circle",{cx:o.progressBarStep,cy:"7",r:"5.5",fill:e.reachedMileStone(500)?"#C41230":"#C9C9C9",stroke:e.reachedMileStone(500)?"#C41230":"#C9C9C9","stroke-width":"3"},null,8,U),r("circle",{cx:o.progressBarStep*2,cy:"7",r:"5.5",fill:e.reachedMileStone(1e3)?"#C41230":"#C9C9C9",stroke:e.reachedMileStone(1e3)?"#C41230":"#C9C9C9","stroke-width":"3"},null,8,z),r("circle",{cx:o.progressBarStep*3,cy:"7",r:"5.5",fill:e.reachedMileStone(2e3)?"#C41230":"#C9C9C9",stroke:e.reachedMileStone(2e3)?"#C41230":"#C9C9C9","stroke-width":"3"},null,8,J),r("circle",{cx:o.progressBarStep*4,cy:"7",r:"5.5",fill:e.reachedMileStone(2500)?"#C41230":"#C9C9C9",stroke:e.reachedMileStone(2500)?"#C41230":"#C9C9C9","stroke-width":"3"},null,8,X)])),m(c,{name:`coin-progress-indicator_${t.defaultCurrency.isocode}`,class:"coin-milestones",title:"coin milestones"},null,8,["name"])])]),r("a",{onClick:s[0]||(s[0]=(...h)=>e.navigateToRTMB&&e.navigateToRTMB(...h)),onKeyup:s[1]||(s[1]=f((...h)=>e.navigateToRTMB&&e.navigateToRTMB(...h),["enter"])),role:"link",tabindex:"0",class:"link"},l(t.$t("i18n.seeAllMemberBenefits")),33)])])):g("",!0)}const Q=P(R,[["render",Z],["__scopeId","data-v-3b0f9836"]]);const Y={inject:["mq"],data(){return{orderCode:"",orderStatusText:{},onlineOrders:null,orderStatus:""}},mounted(){this.loggedIn&&this.getDurationBasedStatus()},watch:{loggedIn(){this.loggedIn?this.getDurationBasedStatus():this.onlineOrders=null},orderConfirmation(){this.loggedIn?this.getDurationBasedStatus():this.onlineOrders=null}},computed:{...p(v,["paths","countryHasLoyaltyInLSA"]),...C(k,["showPassportSlider"]),..._("auth",["loggedIn"]),...p(N,["orderConfirmation"])},methods:{navigateMyOrders(){b({action_detail:"order history"}),this.$router.push({path:this.paths.myOrders}),this.showPassportSlider=!1},getDurationBasedStatus(){this.$store.dispatch("userProfileState/getDurationBasedStatusAndOrders",{durationInDaysFromCurrent:45,numberOfLatestOrders:1}).then(({orderStatuses:t,onlineOrders:s})=>{this.onlineOrders=s,t&&(this.setOrderStatus(t),this.formStatusText(t))})},setOrderStatus(t=[]){const s=(t==null?void 0:t.map(({returnInProgress:i,hasBeenReturned:n,onHold:o,exchangeOrder:e})=>({returnInProgress:i,hasBeenReturned:n,onHold:o,exchangeOrder:e}))[0])||{};Object.keys(s).filter(i=>s[i]===!0).forEach(i=>{this.orderStatus=this.$t(`i18n.passportSliderOrderStatus.${i}`)})},formStatusText(t){const{code:s,statuses:i={}}=(t==null?void 0:t[0])||{},n={};if(this.orderCode=s,Object.keys(i).filter(o=>i[o]).forEach((o,e)=>{const c=i[o],h=`i18n.passportSliderOrderStatus.${c>1?`${o}_items`:`${o}`}`;n[o]=`${e>0?",":""} ${c} ${this.$t(h)}`}),Object.keys(n).length===1&&this.orderStatus===""){const e=`i18n.passportSliderOrderStatus.${Object.keys(n)[0]}`;n[Object.keys(n)[0]]=`${this.$t(e)}`}this.orderStatus!==""&&Object.keys(n).length===1||(this.orderStatusText=n)}}},tt={key:0,class:"order-section"},et={class:"order-status-txt"},st={key:0},rt=["innerHTML"],ot={key:1};function it(t,s,i,n,o,e){return o.onlineOrders!==null?(d(),u("div",tt,[r("h2",et,l(t.$t("i18n.orderStatus")),1),o.onlineOrders.length>0?(d(),u("p",st,[$(l(t.$t("i18n.orderTextAndCode",{_orderCode_:o.orderCode}))+" "+l(o.orderStatus)+" ",1),(d(!0),u(S,null,w(o.orderStatusText,c=>(d(),u("span",{key:`${c}`,innerHTML:`${c}`},null,8,rt))),128))])):(d(),u("p",ot,l(t.$t("i18n.noActiveOrdersRightNow")),1)),r("a",{onClick:s[0]||(s[0]=(...c)=>e.navigateMyOrders&&e.navigateMyOrders(...c)),onKeyup:s[1]||(s[1]=f((...c)=>e.navigateMyOrders&&e.navigateMyOrders(...c),["enter"])),role:"link",tabindex:"0",class:"order-history-link"},l(t.$t("i18n.viewMyOrderHistory")),33)])):g("",!0)}const nt=P(Y,[["render",it],["__scopeId","data-v-dd0c0613"]]);const at={inject:["mq"],components:{SvgIcon:O,PassportSliderCoinsSection:Q,PassportSliderMyOrderSection:nt},data(){return{orderHistory:{},orderStatusText:{Allocated:"is being processed",processing:"",Completed:""}}},computed:{...p(v,["paths","countryHasLoyaltyInLSA","countryHasLoyaltyInLSE"]),...p(B,["locale","country"]),...C(k,["showPassportSlider"]),..._("userProfileState",["firstName"]),helloText(){return`${this.$t("i18n.heyText")} ${this.firstName}!`},memberBenefits(){return`${this.$t("i18n.memberBenefits")}`},programBenefits(){return[{icon:"free-shipping-new",title:this.$t("i18n.freeShippingEasyReturnsNew")},{icon:"exclusive-access-new",title:this.$t("i18n.exclusiveAccessNew")},{icon:"birthday-new",title:this.$t("i18n.birthdayRewardNew")}]}},watch:{showPassportSlider(t){if(t){const s=[...Array.from(this.$el.parentNode.querySelectorAll(".item__menu-x-button, .logout-link, .profile-btn"))];if(this.trapFocus=A.bind(null,s,null),window.addEventListener("keydown",this.trapFocus),s.length&&this.firstFocusOn!==""){const i=s.find(n=>n.type===this.firstFocusOn);i==null||i.focus()}else s[0].focus()}else window.removeEventListener("keydown",this.trapFocus)}},methods:{trackSliderAccountNavigation(t=""){b({action_detail:t})},closePassportSlider(){this.showPassportSlider=!1},closePassportSliderOnKeyEvent(){document.querySelector(".account-utility-bar__link").focus(),this.closePassportSlider()},logOut(){this.trackSliderAccountNavigation("log out"),this.$store.dispatch("login/signOutUser").then(()=>{this.$router.push({path:this.paths.root}).catch(t=>{console.debug("router push failed",t)})}),this.showPassportSlider=!1},navigateToProfile(){this.trackSliderAccountNavigation("view profile"),this.$router.push({path:this.paths.myProfile}),this.showPassportSlider=!1},navigateToRTMB(){this.trackSliderAccountNavigation("member benefits"),this.$router.push({path:this.paths.loyaltyCustomer}),this.showPassportSlider=!1}}},lt={class:"passport-slider__header",ref:"passportItem"},ct={class:"passport-slider__userInfo"},dt={class:"user-name"},ut=["aria-label"],ht={class:"passport-slider-body"},pt={key:1,class:"benefits-section"},mt={class:"passport-slider__lsaBenefits"},ft={class:"member-benefits"},yt={class:"icon-wrapper"},gt={class:"member-benefits-title"},_t={class:"passport-slider__rtmb"},St=["aria-label"],Ct={class:"passport-slider__footer"},vt=["aria-label"];function kt(t,s,i,n,o,e){const c=y("SvgIcon"),h=y("PassportSliderMyOrderSection"),I=y("PassportSliderCoinsSection"),T=y("svg-icon");return d(),u(S,null,[r("div",lt,[m(c,{name:"red-tab-logo-horizontal",title:"red-tab-logo",class:"text-checkmark-icon"}),e.mq.current!=="mobile"?(d(),u("button",{key:0,ref:"crossIcon",class:"item__menu-x-button",onClick:s[0]||(s[0]=(...a)=>e.closePassportSlider&&e.closePassportSlider(...a)),onKeyup:s[1]||(s[1]=f((...a)=>e.closePassportSliderOnKeyEvent&&e.closePassportSliderOnKeyEvent(...a),["enter"])),"aria-label":"close slider",tabindex:"0"},[m(c,{name:"close",title:"Close",class:"item__menu-x"})],544)):g("",!0)],512),r("div",ct,[r("span",dt,l(e.helloText),1),r("a",{onClick:s[2]||(s[2]=(...a)=>e.logOut&&e.logOut(...a)),onKeyup:s[3]||(s[3]=f((...a)=>e.logOut&&e.logOut(...a),["enter"])),role:"link",tabindex:"0","aria-label":t.$t("i18n.logOut"),"data-index":"6",class:"logout-link"},l(t.$t("i18n.logOut")),41,ut)]),r("div",ht,[m(h),t.countryHasLoyaltyInLSE?(d(),L(I,{key:0})):g("",!0),t.countryHasLoyaltyInLSA?(d(),u("div",pt,[r("div",mt,[r("span",ft,l(e.memberBenefits),1)]),(d(!0),u(S,null,w(e.programBenefits,a=>(d(),u("div",{key:a.icon,class:"passport-slider__lsaBenefits"},[r("div",yt,[m(T,{name:a.icon,"set-aria-hidden":"",width:"14",height:"10.73"},null,8,["name"])]),r("span",gt,l(a.title),1)]))),128)),r("div",_t,[r("a",{onClick:s[4]||(s[4]=(...a)=>e.navigateToRTMB&&e.navigateToRTMB(...a)),onKeyup:s[5]||(s[5]=f((...a)=>e.navigateToRTMB&&e.navigateToRTMB(...a),["enter"])),role:"link",tabindex:"0","aria-label":t.$t("i18n.seeAllMemberBenefits"),"data-index":"6",class:"rtmb-link"},l(t.$t("i18n.seeAllMemberBenefits")),41,St)])])):g("",!0),r("div",Ct,[r("button",{class:"profile-btn","aria-label":t.$t("i18n.viewEditProfileText"),onClick:s[6]||(s[6]=(...a)=>e.navigateToProfile&&e.navigateToProfile(...a)),onKeyup:s[7]||(s[7]=f((...a)=>e.navigateToProfile&&e.navigateToProfile(...a),["enter"]))},l(t.$t("i18n.viewEditProfileText")),41,vt)])])],64)}const zt=P(at,[["render",kt],["__scopeId","data-v-8e81de7d"]]);export{zt as default};
