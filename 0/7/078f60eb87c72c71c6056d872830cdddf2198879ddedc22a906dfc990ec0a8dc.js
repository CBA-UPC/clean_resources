"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[2499],{55420:(e,a,t)=>{t.d(a,{T:()=>c});var i=t(17053),r=t(88384),o=t(85039),l=t(71285),s=t(62182);const n="Ws8Ec3GREpT5PAUesr9b",d="kHu_FTRgoBLSLeAJtyKY";var u=t(11527);const c=function(e){let{onClick:a,name:t,images:c,canEdit:m,placeholderType:g,shape:p=s.Kc.SQUARE,dragUri:v=""}=e;const[h,f]=(0,r.R)(c),x=(0,o.VO)(h,f)===o.KO.loaded,b=(0,i.O)({itemUris:[v],dragLabelText:t});return(0,u.jsxs)("div",{className:n,"data-testid":`${g}-image`,draggable:!!v,onDragStart:b,children:[(0,u.jsx)(s.Oe,{loading:"eager",name:t,images:c,placeholderType:g,shape:p}),m&&(0,u.jsx)("div",{className:d,children:(0,u.jsx)(l.F,{overlay:x,onClick:a,rounded:p===s.Kc.CIRCLE})})]})}},1502:(e,a,t)=>{t.d(a,{k:()=>s});var i=t(82187),r=t.n(i),o=t(63068),l=t(11527);const s=e=>{let{children:a}=e;return(0,l.jsx)("div",{className:r()(o.Z.imageContainer,o.Z.imageContainerNew),children:a})}},36637:(e,a,t)=>{t.d(a,{g:()=>l});var i=t(69736),r=t(63068),o=t(11527);const l=e=>{let{children:a}=e;return(0,o.jsx)(i.x,{variant:"bodySmall",className:r.Z.pretitle,children:a})}},84108:(e,a,t)=>{t.r(a),t.d(a,{default:()=>Ya});var i=t(50959),r=t(75802),o=t(75095),l=t(11317),s=(t(86277),t(82187)),n=t.n(s),d=t(85648),u=t(15103),c=t(91643),m=t(70930),g=t(51292),p=t(24676);const v="umiKMm5NVr5UeBJCHS6U",h="jzhwZKbfx4vrC_MYd_7c",f="MWWPQQjbjRfoGdPD8D68",x="kWCnF32FrVtGHmTy8QeV",b="uJxNEI2k7x8UCDdMKELt",k="wDIZ2yYKjfGI68I4cZ98";var y=t(11527);const I=e=>{const{uri:a}=e,{data:t,loading:i,error:r}=(0,p.J)(g.ET,[a]),o=null==t?void 0:t.profiles;return i?(0,y.jsx)(c.h,{hasError:null!==r,errorMessage:d.ag.get("error.not_found.title.page")}):(0,y.jsx)(m.P,{className:n()("contentSpacing",f),title:d.ag.get("followers"),total:null==o?void 0:o.length,showAll:!0,children:null==o?void 0:o.map(((e,a)=>(0,y.jsx)(u.P,{index:a,uri:e.uri,name:e.name,images:[{url:e.image_url}]},e.uri)))})},j=e=>{const{uri:a}=e,{data:t,loading:i,error:r}=(0,p.J)(g.nX,[a]),o=null==t?void 0:t.profiles;return i?(0,y.jsx)(c.h,{hasError:null!==r,errorMessage:d.ag.get("error.not_found.title.page")}):(0,y.jsx)(m.P,{className:n()("contentSpacing",f),title:d.ag.get("following"),total:null==o?void 0:o.length,showAll:!0,children:null==o?void 0:o.map(((e,a)=>(0,y.jsx)(u.P,{index:a,uri:e.uri,name:e.name,images:[{url:e.image_url}]},e.uri)))})};t(46758),t(39301);var _=t(59047),N=t(29132),T=t(23055),w=t(10226),P=t(15894),C=t(25959),S=t(87964),A=t(82579),R=t(41736),O=t(41038),E=t(55420),U=t(62182),D=t(81639),L=t(16118),M=t(69736),W=t(7863),F=t(27563),H=t(43286),K=t(27926),J=t(88384),B=t(85039);const Q="F8_EX1AeKxXNSeh1qiHq",V="valcBm4lLe9qFBcg0sFY",G="tAIzXn8C9KriGwGuBfWg",Z="PsrXxenHUFXYM1ub1xWw",z="U_VWfeeLWnDPhUTxCmrQ",q=function(e){let{onClickEdit:a,onClickRemove:t,name:i,images:r,canEdit:o}=e;const[l,s]=(0,J.R)(r),u=(0,B.VO)(l,s)===B.KO.loaded;return(0,y.jsxs)("div",{className:Q,children:[(0,y.jsx)(U.Oe,{loading:"eager",name:i,images:r,placeholderType:"user",shape:U.Kc.CIRCLE}),o&&(0,y.jsxs)("div",{className:n()(V,{[Z]:u}),children:[(0,y.jsx)("button",{className:G,"aria-haspopup":"true",onClick:a,type:"button",children:(0,y.jsx)(M.x,{variant:"bodyMedium",children:d.ag.get("user.edit-details.choose-photo")})}),(0,y.jsx)("div",{className:n()(z,"icon"),children:(0,y.jsx)(K.y,{size:"xlarge","aria-hidden":!0})}),(0,y.jsx)("button",{className:G,onClick:t,type:"button",children:(0,y.jsx)(M.x,{variant:"bodyMedium",children:d.ag.get("user.edit-details.remove-photo")})})]})]})};t(70054);var X=t(85332),Y=t(17532),$=(t(51016),t(80066),t(94557),t(57023),t(19139),t(65025),t(71969),t(6521),t(66690),t(86523),t(62924),t(66070),t(9590));const ee={paths:""},ae={encode(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$.Writer.create();for(const t of e.paths)a.uint32(10).string(t);return a},decode(e,a){const t=e instanceof Uint8Array?new $.Reader(e):e;let i=void 0===a?t.len:t.pos+a;const r={...ee};for(r.paths=[];t.pos<i;){const e=t.uint32();if(e>>>3==1)r.paths.push(t.string());else t.skipType(7&e)}return r},fromJSON(e){const a={...ee};if(a.paths=[],void 0!==e.paths&&null!==e.paths)for(const t of e.paths)a.paths.push(String(t));return a},fromPartial(e){const a={...ee};if(a.paths=[],void 0!==e.paths&&null!==e.paths)for(const t of e.paths)a.paths.push(t);return a},toJSON(e){const a={};return e.paths?a.paths=e.paths.map((e=>e)):a.paths=[],a}};t(31546);var te=t(3959),ie=t(55872).lW;const re={value:0},oe={value:!1},le={value:""};const se={encode(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$.Writer.create();return a.uint32(8).int32(e.value),a},decode(e,a){const t=e instanceof Uint8Array?new $.Reader(e):e;let i=void 0===a?t.len:t.pos+a;const r={...re};for(;t.pos<i;){const e=t.uint32();if(e>>>3==1)r.value=t.int32();else t.skipType(7&e)}return r},fromJSON(e){const a={...re};return void 0!==e.value&&null!==e.value?a.value=Number(e.value):a.value=0,a},fromPartial(e){const a={...re};return void 0!==e.value&&null!==e.value?a.value=e.value:a.value=0,a},toJSON(e){const a={};return void 0!==e.value&&(a.value=e.value),a}},ne={encode(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$.Writer.create();return a.uint32(8).bool(e.value),a},decode(e,a){const t=e instanceof Uint8Array?new $.Reader(e):e;let i=void 0===a?t.len:t.pos+a;const r={...oe};for(;t.pos<i;){const e=t.uint32();if(e>>>3==1)r.value=t.bool();else t.skipType(7&e)}return r},fromJSON(e){const a={...oe};return void 0!==e.value&&null!==e.value?a.value=Boolean(e.value):a.value=!1,a},fromPartial(e){const a={...oe};return void 0!==e.value&&null!==e.value?a.value=e.value:a.value=!1,a},toJSON(e){const a={};return void 0!==e.value&&(a.value=e.value),a}},de={encode(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$.Writer.create();return a.uint32(10).string(e.value),a},decode(e,a){const t=e instanceof Uint8Array?new $.Reader(e):e;let i=void 0===a?t.len:t.pos+a;const r={...le};for(;t.pos<i;){const e=t.uint32();if(e>>>3==1)r.value=t.string();else t.skipType(7&e)}return r},fromJSON(e){const a={...le};return void 0!==e.value&&null!==e.value?a.value=String(e.value):a.value="",a},fromPartial(e){const a={...le};return void 0!==e.value&&null!==e.value?a.value=e.value:a.value="",a},toJSON(e){const a={};return void 0!==e.value&&(a.value=e.value),a}};$.util.Long!==te.Z&&($.util.Long=te.Z,(0,$.configure)());const ue=globalThis;ue.atob,ue.btoa;const ce={maxWidth:0,maxHeight:0,url:""},me={},ge={},pe={encode(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$.Writer.create();return a.uint32(8).int32(e.maxWidth),a.uint32(16).int32(e.maxHeight),a.uint32(26).string(e.url),a},decode(e,a){const t=e instanceof Uint8Array?new $.Reader(e):e;let i=void 0===a?t.len:t.pos+a;const r={...ce};for(;t.pos<i;){const e=t.uint32();switch(e>>>3){case 1:r.maxWidth=t.int32();break;case 2:r.maxHeight=t.int32();break;case 3:r.url=t.string();break;default:t.skipType(7&e)}}return r},fromJSON(e){const a={...ce};return void 0!==e.maxWidth&&null!==e.maxWidth?a.maxWidth=Number(e.maxWidth):a.maxWidth=0,void 0!==e.maxHeight&&null!==e.maxHeight?a.maxHeight=Number(e.maxHeight):a.maxHeight=0,void 0!==e.url&&null!==e.url?a.url=String(e.url):a.url="",a},fromPartial(e){const a={...ce};return void 0!==e.maxWidth&&null!==e.maxWidth?a.maxWidth=e.maxWidth:a.maxWidth=0,void 0!==e.maxHeight&&null!==e.maxHeight?a.maxHeight=e.maxHeight:a.maxHeight=0,void 0!==e.url&&null!==e.url?a.url=e.url:a.url="",a},toJSON(e){const a={};return void 0!==e.maxWidth&&(a.maxWidth=e.maxWidth),void 0!==e.maxHeight&&(a.maxHeight=e.maxHeight),void 0!==e.url&&(a.url=e.url),a}},ve={encode(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$.Writer.create();void 0!==e.username&&void 0!==e.username&&de.encode({value:e.username},a.uint32(10).fork()).ldelim(),void 0!==e.name&&void 0!==e.name&&de.encode({value:e.name},a.uint32(18).fork()).ldelim();for(const t of e.images)pe.encode(t,a.uint32(26).fork()).ldelim();return void 0!==e.verified&&void 0!==e.verified&&ne.encode({value:e.verified},a.uint32(34).fork()).ldelim(),void 0!==e.editProfileDisabled&&void 0!==e.editProfileDisabled&&ne.encode({value:e.editProfileDisabled},a.uint32(42).fork()).ldelim(),void 0!==e.reportAbuseDisabled&&void 0!==e.reportAbuseDisabled&&ne.encode({value:e.reportAbuseDisabled},a.uint32(50).fork()).ldelim(),void 0!==e.abuseReportedName&&void 0!==e.abuseReportedName&&ne.encode({value:e.abuseReportedName},a.uint32(58).fork()).ldelim(),void 0!==e.abuseReportedImage&&void 0!==e.abuseReportedImage&&ne.encode({value:e.abuseReportedImage},a.uint32(66).fork()).ldelim(),void 0!==e.hasSpotifyName&&void 0!==e.hasSpotifyName&&ne.encode({value:e.hasSpotifyName},a.uint32(74).fork()).ldelim(),void 0!==e.hasSpotifyImage&&void 0!==e.hasSpotifyImage&&ne.encode({value:e.hasSpotifyImage},a.uint32(82).fork()).ldelim(),void 0!==e.color&&void 0!==e.color&&se.encode({value:e.color},a.uint32(90).fork()).ldelim(),a},decode(e,a){const t=e instanceof Uint8Array?new $.Reader(e):e;let i=void 0===a?t.len:t.pos+a;const r={...me};for(r.images=[];t.pos<i;){const e=t.uint32();switch(e>>>3){case 1:r.username=de.decode(t,t.uint32()).value;break;case 2:r.name=de.decode(t,t.uint32()).value;break;case 3:r.images.push(pe.decode(t,t.uint32()));break;case 4:r.verified=ne.decode(t,t.uint32()).value;break;case 5:r.editProfileDisabled=ne.decode(t,t.uint32()).value;break;case 6:r.reportAbuseDisabled=ne.decode(t,t.uint32()).value;break;case 7:r.abuseReportedName=ne.decode(t,t.uint32()).value;break;case 8:r.abuseReportedImage=ne.decode(t,t.uint32()).value;break;case 9:r.hasSpotifyName=ne.decode(t,t.uint32()).value;break;case 10:r.hasSpotifyImage=ne.decode(t,t.uint32()).value;break;case 11:r.color=se.decode(t,t.uint32()).value;break;default:t.skipType(7&e)}}return r},fromJSON(e){const a={...me};if(a.images=[],void 0!==e.username&&null!==e.username?a.username=String(e.username):a.username=void 0,void 0!==e.name&&null!==e.name?a.name=String(e.name):a.name=void 0,void 0!==e.images&&null!==e.images)for(const t of e.images)a.images.push(pe.fromJSON(t));return void 0!==e.verified&&null!==e.verified?a.verified=Boolean(e.verified):a.verified=void 0,void 0!==e.editProfileDisabled&&null!==e.editProfileDisabled?a.editProfileDisabled=Boolean(e.editProfileDisabled):a.editProfileDisabled=void 0,void 0!==e.reportAbuseDisabled&&null!==e.reportAbuseDisabled?a.reportAbuseDisabled=Boolean(e.reportAbuseDisabled):a.reportAbuseDisabled=void 0,void 0!==e.abuseReportedName&&null!==e.abuseReportedName?a.abuseReportedName=Boolean(e.abuseReportedName):a.abuseReportedName=void 0,void 0!==e.abuseReportedImage&&null!==e.abuseReportedImage?a.abuseReportedImage=Boolean(e.abuseReportedImage):a.abuseReportedImage=void 0,void 0!==e.hasSpotifyName&&null!==e.hasSpotifyName?a.hasSpotifyName=Boolean(e.hasSpotifyName):a.hasSpotifyName=void 0,void 0!==e.hasSpotifyImage&&null!==e.hasSpotifyImage?a.hasSpotifyImage=Boolean(e.hasSpotifyImage):a.hasSpotifyImage=void 0,void 0!==e.color&&null!==e.color?a.color=Number(e.color):a.color=void 0,a},fromPartial(e){const a={...me};if(a.images=[],void 0!==e.username&&null!==e.username?a.username=e.username:a.username=void 0,void 0!==e.name&&null!==e.name?a.name=e.name:a.name=void 0,void 0!==e.images&&null!==e.images)for(const t of e.images)a.images.push(pe.fromPartial(t));return void 0!==e.verified&&null!==e.verified?a.verified=e.verified:a.verified=void 0,void 0!==e.editProfileDisabled&&null!==e.editProfileDisabled?a.editProfileDisabled=e.editProfileDisabled:a.editProfileDisabled=void 0,void 0!==e.reportAbuseDisabled&&null!==e.reportAbuseDisabled?a.reportAbuseDisabled=e.reportAbuseDisabled:a.reportAbuseDisabled=void 0,void 0!==e.abuseReportedName&&null!==e.abuseReportedName?a.abuseReportedName=e.abuseReportedName:a.abuseReportedName=void 0,void 0!==e.abuseReportedImage&&null!==e.abuseReportedImage?a.abuseReportedImage=e.abuseReportedImage:a.abuseReportedImage=void 0,void 0!==e.hasSpotifyName&&null!==e.hasSpotifyName?a.hasSpotifyName=e.hasSpotifyName:a.hasSpotifyName=void 0,void 0!==e.hasSpotifyImage&&null!==e.hasSpotifyImage?a.hasSpotifyImage=e.hasSpotifyImage:a.hasSpotifyImage=void 0,void 0!==e.color&&null!==e.color?a.color=e.color:a.color=void 0,a},toJSON(e){const a={};return void 0!==e.username&&(a.username=e.username),void 0!==e.name&&(a.name=e.name),e.images?a.images=e.images.map((e=>e?pe.toJSON(e):void 0)):a.images=[],void 0!==e.verified&&(a.verified=e.verified),void 0!==e.editProfileDisabled&&(a.editProfileDisabled=e.editProfileDisabled),void 0!==e.reportAbuseDisabled&&(a.reportAbuseDisabled=e.reportAbuseDisabled),void 0!==e.abuseReportedName&&(a.abuseReportedName=e.abuseReportedName),void 0!==e.abuseReportedImage&&(a.abuseReportedImage=e.abuseReportedImage),void 0!==e.hasSpotifyName&&(a.hasSpotifyName=e.hasSpotifyName),void 0!==e.hasSpotifyImage&&(a.hasSpotifyImage=e.hasSpotifyImage),void 0!==e.color&&(a.color=e.color),a}},he={encode(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$.Writer.create();return void 0!==e.mask&&void 0!==e.mask&&ae.encode(e.mask,a.uint32(10).fork()).ldelim(),void 0!==e.userProfile&&void 0!==e.userProfile&&ve.encode(e.userProfile,a.uint32(18).fork()).ldelim(),a},decode(e,a){const t=e instanceof Uint8Array?new $.Reader(e):e;let i=void 0===a?t.len:t.pos+a;const r={...ge};for(;t.pos<i;){const e=t.uint32();switch(e>>>3){case 1:r.mask=ae.decode(t,t.uint32());break;case 2:r.userProfile=ve.decode(t,t.uint32());break;default:t.skipType(7&e)}}return r},fromJSON(e){const a={...ge};return void 0!==e.mask&&null!==e.mask?a.mask=ae.fromJSON(e.mask):a.mask=void 0,void 0!==e.userProfile&&null!==e.userProfile?a.userProfile=ve.fromJSON(e.userProfile):a.userProfile=void 0,a},fromPartial(e){const a={...ge};return void 0!==e.mask&&null!==e.mask?a.mask=ae.fromPartial(e.mask):a.mask=void 0,void 0!==e.userProfile&&null!==e.userProfile?a.userProfile=ve.fromPartial(e.userProfile):a.userProfile=void 0,a},toJSON(e){const a={};return void 0!==e.mask&&(a.mask=e.mask?ae.toJSON(e.mask):void 0),void 0!==e.userProfile&&(a.userProfile=e.userProfile?ve.toJSON(e.userProfile):void 0),a}},fe=`${X.XA}/identity`;async function xe(e,a,t){let{name:i,imageUploadToken:r}=t;void 0!==i&&await async function(e,a,t){const i=he.encode(he.fromPartial({mask:{paths:["name"]},userProfile:null!==t?{name:t}:{}}));await e.build().withHost(fe).withMethod("POST").withPath(`/v3/user/username/${encodeURIComponent((0,Y.C)(a))}`).withEndpointIdentifier("/v3/user/username/{username}").withBody(i.finish()).withoutMarket().send()}(e,a,i),void 0!==r&&(null!==r?await async function(e,a,t){await e.build().withHost(fe).withMethod("POST").withPath(`/v3/profile-image/${encodeURIComponent((0,Y.C)(a))}/${t}`).withEndpointIdentifier("/v3/profile-image/{username}/{uploadToken}").withoutMarket().send()}(e,a,r):await async function(e,a){await e.build().withHost(fe).withMethod("DELETE").withPath(`/v3/profile-image/${encodeURIComponent((0,Y.C)(a))}`).withEndpointIdentifier("/v3/profile-image/{username}").withoutMarket().send()}(e,a))}var be=t(13188);const ke={type:"error",get message(){return d.ag.get("user.edit-details.error.file-size-exceeded",10)}},ye={type:"error",get message(){return d.ag.get("user.edit-details.error.too-small",300,300)}},Ie={type:"error",get message(){return d.ag.get("user.edit-details.error.missing-name")}},je={type:"error",get message(){return d.ag.get("user.edit-details.error.failed-to-save")}},_e={type:"error",get message(){return d.ag.get("user.edit-details.error.file-upload-failed")}};function Ne(e){return{type:"setLoading",loading:e}}function Te(e){return{type:"setMessage",message:e}}function we(e,a){switch(a.type){case"setName":return{...e,name:a.name};case"setMessage":return{...e,message:a.message,loading:!1};case"setLoading":return{...e,loading:a.loading,message:null};case"setImageData":return{...e,imageData:a.data,removeImage:!1};case"setImageToken":return{...e,imageToken:a.token,removeImage:!1};case"removeImage":return{...e,imageToken:void 0,imageData:void 0,image:void 0,removeImage:!0};default:return e}}var Pe=t(40537),Ce=t(37931),Se=t(57201);const Ae="XwNfIrI6_hCa_9_T2cQB",Re="so0bdX3oZH6YW5_nGxIR",Oe="aM3plU4zzDqjWlvUHGYb",Ee="zHeo4VUxytwm6Ptr0QyA",Ue="vAeyAmeLkDEDKdL9Hou0",De="dnmzO6yYKkxUV8jl7O1Z",Le="oN9QVvJKEtdTH3HGfCu1",Me="uj7hczcCH1dZpse8Kfmi",We="wvLAEV5wF5C5ej6rvimT",Fe="gAQfzAUp1FuSXODeZJfP",He="dMhJaxli87_22jb_3d9x",Ke="MDb7QhAtHeyM4gKj8j8t",Je="zGbjZMZ1DTx4futEbN9l",Be=i.memo((function(e){let{uri:a,name:t,image:r,onClose:o,shouldOpenImagePicker:l,userCapabilities:s}=e;const[u,c]=(0,Ce.Hs)(),[m,g]=function(e){let{name:a,image:t}=e;return(0,i.useReducer)(we,{loading:!1,message:null,name:a,image:t})}({name:t,image:r}),p=(0,i.useMemo)((()=>{const e=m.imageData||m.image;return e?[{url:e,width:300,height:300}]:[]}),[m.image,m.imageData]);(0,i.useEffect)((()=>{l&&c()}),[c,l]);const v=(0,i.useCallback)((e=>{e===Ce.Hy.FILE_TOO_BIG?g(Te(ke)):e===Ce.Hy.IMAGE_TOO_SMALL&&g(Te(ye))}),[g]),h=(0,i.useCallback)((()=>{g({type:"removeImage"})}),[g]),f=(0,i.useCallback)((async e=>{e.preventDefault();if(0!==m.name.trim().length){g(Ne(!0));try{const e=m.removeImage?null:m.imageToken;await async function(e,a){let{name:t,imageUploadToken:i}=a;await xe(be.b.getInstance(),e,{name:t,imageUploadToken:i})}(a,{name:m.name,imageUploadToken:e}),o({name:m.name,image:m.imageData||m.image})}catch(t){g(Te(je))}}else g(Te(Ie))}),[g,o,m.image,m.imageData,m.imageToken,m.name,m.removeImage,a]);return(0,y.jsx)(Pe.Z,{isOpen:!0,contentLabel:d.ag.get("user.edit-details.title"),onRequestClose:()=>o(),children:(0,y.jsxs)("div",{className:Ae,children:[(0,y.jsxs)("div",{className:Oe,children:[(0,y.jsx)(M.x,{as:"h1",variant:"titleSmall",children:d.ag.get("user.edit-details.title")}),(0,y.jsx)("button",{className:Ee,onClick:()=>o(),"aria-label":d.ag.get("close"),children:(0,y.jsx)(W.k,{size:"small"})})]}),m.message&&(0,y.jsx)(Se.X,{isErrorMessage:"error"===m.message.type,message:m.message.message}),(0,y.jsxs)("form",{className:Re,onSubmit:f,children:[s.edit_image&&(0,y.jsx)(Ce.uL,{isOpen:u,minImageWidth:300,minImageHeight:300,maxFileSizeMB:10,onChange:async function(e){if(!e)return;const{imageFile:a,imageDataUrl:t}=e;if(g(Te(null)),g({type:"setImageData",data:t}),a)try{g(Ne(!0));const e=await async function(e){const a=await be.b.getInstance().build().withEndpointIdentifier("image-upload/v4/user-profile").withHost("https://image-upload.spotify.com/v4").withMethod("POST").withPath("/user-profile").withBody(e).withoutGlobalHeaders().withHeaders([{key:"Content-Type",value:"image/jpeg"}]).withoutMarket().send();if(!a.body)throw new Error("No upload token recieved");return a.body.uploadToken}(a);g({type:"setImageToken",token:e}),g(Ne(!1))}catch{g(Te(_e))}},onError:v}),(0,y.jsxs)("div",{className:Ue,children:[(0,y.jsx)(q,{name:t,images:p,onClickEdit:c,onClickRemove:h,canEdit:s.edit_image}),m.loading&&(0,y.jsx)("div",{className:De,children:(0,y.jsx)(F.T,{})})]}),(0,y.jsxs)("div",{className:Me,children:[(0,y.jsx)("label",{htmlFor:"user-edit-name",className:We,children:(0,y.jsx)(M.x,{variant:"marginalBold",className:Fe,children:d.ag.get("user.edit-details.name-label")})}),(0,y.jsx)("input",{"data-testid":"user-edit-name-input",id:"user-edit-name",type:"text",dir:"auto",className:n()(Le,He),onChange:e=>{g(function(e){return{type:"setName",name:e}}(e.target.value))},placeholder:d.ag.get("user.edit-details.name-placeholder"),maxLength:32,value:m.name,disabled:!s.edit_name})]}),(0,y.jsx)("div",{className:Ke,children:(0,y.jsx)(H.D,{colorSet:"invertedLight",onClick:f,disabled:m.loading,children:d.ag.get("save")})}),(0,y.jsx)(M.x,{as:"p",variant:"marginalBold",className:Je,children:d.ag.get("image-upload.legal-disclaimer")})]})]})})}));var Qe=t(50540),Ve=t(71318),Ge=t(87350),Ze=t(82813),ze=t(76950),qe=t(90284),Xe=t(80626),Ye=t(58912),$e=t(55649),ea=t(97013),aa=t(40235),ta=t(6395),ia=t(67208),ra=t(13734),oa=t(9443),la=t(33608),sa=t(15842),na=t(66205),da=t(66819);const ua=i.memo((function(e){let{openModal:a,spec:t,logger:r,name:o,backgroundColor:l,isCurrentUser:s,uri:n}=e;const[u,c]=(0,la.H)(n),m=(0,ra.o)(),g=!(0,oa.k)(),p=(0,i.useCallback)((()=>{m({targetUri:n,intent:u?"unfollow":"follow",type:"click"});const e=t.actionBarFactory().followButtonFactory();u?(c(!1),r.logInteraction(e.hitUnfollow({itemToBeUnfollowed:n}))):(c(!0),r.logInteraction(e.hitFollow({itemToBeFollowed:n})))}),[u,r,m,c,t,n]),v=(0,i.useCallback)((()=>{const e=t.actionBarFactory().contextMenuButtonFactory().hitUiReveal();r.logInteraction(e)}),[r,t]),h=(0,da.j)();return(0,y.jsx)(sa.o,{backgroundColor:l,children:(0,y.jsxs)(na.F,{children:[!s&&(0,y.jsx)(ta.r,{children:(0,y.jsx)(ia.e,{isFollowing:Boolean(u),onClick:p,disabled:g})}),(0,y.jsx)(aa.y,{menu:(0,y.jsx)(R.I,{uri:n,onEditProfileCallback:a}),children:(0,y.jsx)(ea.z,{label:d.ag.get("more.label.context",o),onClick:v,size:h})})]})})}));var ca=t(53502),ma=t(36199),ga=t(90824),pa=t(42550),va=t(17162),ha=t(45438),fa=t(22527),xa=t(73928),ba=t(82857);const ka=i.memo((function(e){let{tracks:a,hasHeaderRow:t=!1,nrTracksVisible:r,uri:o}=e;const s=(0,Y.C)(o),n=(0,l.qC)(s,"tracks").toURI(),u=(0,i.useMemo)((()=>r?a.slice(0,r):a),[r,a]),{usePlayContextItem:c}=(0,fa.n)({uri:n,pages:[{items:a.map((e=>({type:ba.p.TRACK,uri:e.uri,uid:null,provider:null})))}]},{featureIdentifier:"profile",referrerIdentifier:"user_profile"}),m=(0,i.useCallback)(((e,a)=>{var t,i,r;const o=(0,Ye.X)(null==e||null===(t=e.albumOfTrack)||void 0===t||null===(t=t.coverArt)||void 0===t?void 0:t.sources,{desiredSize:40});return(0,y.jsx)(ga.SS,{index:a,uri:(0,va.$)(e),duration_ms:e.duration.totalMilliseconds,name:e.name,artists:e.artists.items.map((e=>{let{uri:a,profile:{name:t}}=e;return{uri:a,name:t}})),album:e.albumOfTrack,isPlayable:!0,isExplicit:(null===(i=e.contentRating)||void 0===i?void 0:i.label)===xa.KS.Explicit,isMOGEFRestricted:(null===(r=e.contentRating)||void 0===r?void 0:r.label)===xa.KS.NineteenPlus,imgUrl:(null==o?void 0:o.url)||"",contextUri:n,usePlayContextItem:c},a+e.uri)}),[n,c]),g=(0,i.useMemo)((()=>[ma.QD.INDEX,ma.QD.TITLE_AND_ARTIST,ma.QD.ALBUM,ma.QD.DURATION]),[]),p=(0,i.useCallback)((e=>({uri:e.uri})),[]),v=(0,pa.o)()?0:void 0;return(0,y.jsx)(ha.JL,{value:"user-top-tracks-tracklist",children:(0,y.jsx)(ma.Pv,{ariaLabel:d.ag.get("top_tracks_this_month"),renderRow:m,nrTracks:u.length,tracks:u,resolveItem:p,headerTop:v,hasHeaderRow:t,columns:g,columnPersistenceKey:"user-top-tracks-tracklist"})})}),((e,a)=>e.tracks===a.tracks)),ya=i.memo((function(e){let{tracks:a,title:t,tagline:r,seeAllUri:o,className:l,uri:s,spec:n}=e;const d=(0,Xe.$P)(),u=(0,i.useCallback)((()=>{const e=n.titleLinkFactory().hitUiNavigate({destination:o});d.logInteraction(e)}),[d,o,n]),c=(0,i.useCallback)((()=>{const e=n.titleLinkFactory().hitUiNavigate({destination:o});d.logInteraction(e)}),[d,o,n]);if(!a||0===a.totalCount||0===a.items.length)return null;const m=a.totalCount>4;return(0,y.jsxs)("section",{className:l,children:[(0,y.jsx)(ca.r,{title:t,tagline:r,seeAllUri:o,hasMoreElements:m,onClickTitle:u,onClickSeeAll:c}),(0,y.jsx)(Xe.Nh,{spec:n,children:(0,y.jsx)(ka,{tracks:a.items,uri:s,nrTracksVisible:4})})]})}),((e,a)=>e.tracks===a.tracks));function Ia(e,a){switch(a.type){case"OPEN_MODAL":return{isModalOpen:!0,modalVariant:"editProfile",shouldOpenImagePicker:!1};case"OPEN_MODAL_WITH_IMAGEPICKER":return{isModalOpen:!0,modalVariant:"editProfile",shouldOpenImagePicker:!0};case"CLOSE_MODAL":return{isModalOpen:!1,modalVariant:null,shouldOpenImagePicker:!1};default:return e}}var ja=t(1502),_a=t(36637),Na=t(17866),Ta=t(36255),wa=t(61408),Pa=t(60637),Ca=t(17676),Sa=(t(53321),t(23120)),Aa=t(20069);const Ra=new Sa.o("userTopContent","query","feb6d55177e2cbce2ac59214f9493f1ef2e4368eec01b3d4c3468fa1b97336e2",null);function Oa(e){return"Artist"===e.__typename}function Ea(e){var a;if("ArtistPageV2"!==(null==e||null===(a=e.topArtists)||void 0===a?void 0:a.__typename))return null;const t=e.topArtists.items.map((e=>e.data)).filter(Oa);return 0===t.length?null:{totalCount:e.topArtists.totalCount,items:t}}function Ua(e){return"Track"===e.__typename}function Da(e){var a;if("TrackPageV2"!==(null==e||null===(a=e.topTracks)||void 0===a?void 0:a.__typename))return null;const t=e.topTracks.items.map((e=>e.data)).filter(Ua).filter((e=>null!==e.albumOfTrack));return 0===t.length?null:{totalCount:e.topTracks.totalCount,items:t}}const La=xa.K1.Affinity,Ma=xa.eB.ShortTerm;function Wa(e){var a,t;let{includeTopArtists:i,includeTopTracks:r,topArtistsLimit:o,topTracksLimit:l}=e;const{data:s,loading:n,error:d}=(u={includeTopArtists:i,topArtistsInput:{offset:0,limit:o,sortBy:La,timeRange:Ma},includeTopTracks:r,topTracksInput:{offset:0,limit:l,sortBy:La,timeRange:Ma}},c={enabled:i||r,gcTime:18e5,staleTime:3e5},(0,Aa.a)(Ra,u,c));var u,c;return null!==d?{topTracks:null,topArtists:null,loading:n,error:new Error("Failed loading user top content!")}:{topTracks:Da((null==s||null===(a=s.me)||void 0===a?void 0:a.profile)??null),topArtists:Ea((null==s||null===(t=s.me)||void 0===t?void 0:t.profile)??null),loading:n,error:null}}const Fa=18e5,Ha=3e5,Ka=(0,T.P1)(Ge.dy,(e=>(null==e?void 0:e.images)||[])),Ja=e=>{var a;let{uri:t,isCurrentUser:r}=e;const o=null===(a=(0,N.v9)(Ge.dy))||void 0===a?void 0:a.uri,s=(0,N.v9)(Ge.Gf),m=(0,N.v9)(Ka),f=(0,N.I0)(),x=(0,_.NL)(),b=(0,w.W6)(Ca.J4M,{loadingValue:!0}),k=(0,i.useMemo)((()=>(0,Ye.X)(m)),[m]),[{isModalOpen:I,modalVariant:j,shouldOpenImagePicker:T},M]=function(){const[e,a]=(0,i.useReducer)(Ia,{isModalOpen:!1,modalVariant:null,shouldOpenImagePicker:!1});return[e,a]}(),{data:W,loading:F,queryKey:H}=(0,p.J)(g.Ai,[{uri:t,playlists:10,artists:10,episodes:10}],{gcTime:Fa,staleTime:Ha}),K=(0,Qe.g)();(0,Pa.d)(wa.rA.OPERATION_COMPLETE,(()=>{x.invalidateQueries({queryKey:H})})),(0,qe.b)(ze.EW.OPERATION_COMPLETE,(()=>{x.invalidateQueries({queryKey:H})}));const J=null==W?void 0:W.public_playlists,B=null==W?void 0:W.is_verified,Q=null==W?void 0:W.recently_played_artists,V=r?(null==k?void 0:k.url)||"":(null==W?void 0:W.image_url)||"",G=(0,Y.C)(t),Z=(r?s:null==W?void 0:W.name)||"",z=(0,Ve.Z)((null==W?void 0:W.image_url)||null),{spec:q,logger:X}=(0,Xe.fU)(P.L,{data:{uri:t}}),$=(0,i.useMemo)((()=>q.sectionTopTracksFactory()),[q]),ee=!K&&(!1!==(null==W?void 0:W.show_follows)||r),ae=r&&b,{data:te,loading:ie}=(0,p.J)(g.nX,[t],{enabled:ee,gcTime:Fa,staleTime:Ha}),re=null==te?void 0:te.profiles,{data:oe,loading:le}=(0,p.J)(g.ET,[t],{enabled:ee,gcTime:Fa,staleTime:Ha}),se=null==oe?void 0:oe.profiles,ne=null==re?void 0:re.some((e=>e.uri===o)),{topArtists:de,topTracks:ue,loading:ce}=Wa({includeTopArtists:ae,includeTopTracks:ae,topArtistsLimit:10,topTracksLimit:4}),me=(0,i.useCallback)((e=>{M({type:"CLOSE_MODAL"}),e&&(f((0,Ze.dL)(e.name)),f((0,Ze.GR)(e.image?[{url:e.image,height:null,width:null}]:[])))}),[M,f]),ge=(0,i.useCallback)((()=>{M({type:"OPEN_MODAL"});const e=q.headerFactory().usernameFactory().hitUiReveal();X.logInteraction(e)}),[X,M,q]),pe=(0,i.useCallback)((()=>{M({type:"OPEN_MODAL_WITH_IMAGEPICKER"});const e=q.headerFactory().profileImageFactory().hitUiReveal();X.logInteraction(e)}),[X,M,q]),ve=(0,i.useMemo)((()=>[{url:V}]),[V]),he=(0,i.useCallback)((()=>{const e=q.headerFactory().usernameFactory().hitUiReveal();X.logInteraction(e)}),[X,q]),fe=(0,i.useCallback)(((e,a)=>{if(!a)return;const t=q.headerFactory().followersLinkFactory().hitUiNavigate({destination:a});X.logInteraction(t)}),[X,q]),xe=(0,i.useCallback)(((e,a)=>{if(!a)return;const t=q.headerFactory().followersLinkFactory().hitUiNavigate({destination:a});X.logInteraction(t)}),[X,q]);if(!W||F||ie||le||ce)return(0,y.jsx)(c.h,{hasError:!1,errorMessage:d.ag.get("error.not_found.title.page")});const be=n()("contentSpacing",h),ke=ee&&!(null==se||!se.length),ye=ee&&!(null==re||!re.length);return(0,y.jsxs)("div",{className:v,children:[(0,y.jsx)(O.$,{children:Z}),(0,y.jsxs)(U.gF,{backgroundColor:z,children:[(0,y.jsx)(D.W,{children:(0,y.jsx)(L.i,{text:Z})}),(0,y.jsx)(A._,{menu:(0,y.jsx)(R.I,{uri:W.uri}),children:(0,y.jsx)(ja.k,{children:(0,y.jsx)(E.T,{canEdit:r&&!W.edit_image_disabled,name:Z,images:ve,onClick:pe,placeholderType:"user",shape:U.Kc.CIRCLE})})}),(0,y.jsxs)(U.sP,{children:[(0,y.jsx)(_a.g,{children:B?(0,y.jsx)(Na.S,{text:d.ag.get("card.tag.profile")}):d.ag.get("card.tag.profile")}),(0,y.jsx)(A._,{menu:(0,y.jsx)(R.I,{uri:W.uri}),children:(0,y.jsx)(U.xd,{canEdit:r&&!W.edit_name_disabled,editTitle:d.ag.get("playlist.edit-details.title"),onClick:ge,children:Z})}),(0,y.jsx)(U.QS,{totalFollowers:W.followers_count,totalFollowing:W.following_count,publicPlaylists:W.total_public_playlists_count,userUri:t,onCreatorClick:he,onTotalFollowersClick:fe,onTotalFollowingClick:xe,theyFollowUs:ne})]})]}),(0,y.jsx)(ua,{openModal:ge,spec:q,logger:X,name:Z,backgroundColor:z,isCurrentUser:r,uri:t}),(0,y.jsxs)(Xe.Nh,{spec:q,children:[r&&(0,y.jsxs)(y.Fragment,{children:[null!==de&&(0,y.jsx)(Ta.q,{className:be,total:de.totalCount,title:d.ag.get("top_artists_this_month"),tagline:d.ag.get("only_visible_to_you"),seeAllUri:(0,l.QK)(G,["top","artists"]).toURI(),id:"top-artists",index:0,children:de.items.map(((e,a)=>{var t;return(0,y.jsx)(C.I,{index:a,uri:e.uri,name:e.profile.name,images:(null===(t=e.visuals.avatarImage)||void 0===t?void 0:t.sources)??[]},e.uri)}))}),(0,y.jsx)(ya,{className:be,title:d.ag.get("top_tracks_this_month"),tagline:d.ag.get("only_visible_to_you"),seeAllUri:(0,l.QK)(G,["top","tracks"]).toURI(),uri:t,tracks:ue,spec:$})]}),(0,y.jsx)(Ta.q,{className:be,total:W.total_public_playlists_count,title:d.ag.get("public_playlists"),seeAllUri:(0,l.QK)(G,["playlists"]).toURI(),id:"playlists",index:1,children:null==J?void 0:J.map(((e,a)=>(0,y.jsx)(S.Z,{index:a,uri:e.uri,name:e.name,images:[{url:(0,$e.p)({imageUriOrUrl:e.image_url}),width:300,height:300}],authorName:e.owner_name,description:e.followers_count?d.ag.get("user.followers",e.followers_count):""},e.uri)))}),null!=Q&&Q.length?(0,y.jsx)(Ta.q,{className:be,total:null==Q?void 0:Q.length,title:d.ag.get("recently_played_artists"),seeAllUri:(0,l.QK)(G,["recently-played-artists"]).toURI(),id:"recently-played-artists",index:2,children:null==Q?void 0:Q.map(((e,a)=>(0,y.jsx)(C.I,{index:a,uri:e.uri,name:e.name,images:[{url:e.image_url}]},e.uri)))}):null,ke?(0,y.jsx)(Ta.q,{className:be,title:d.ag.get("followers"),total:null==se?void 0:se.length,seeAllUri:(0,l.QK)(G,["followers"]).toURI(),id:"followers",index:3,children:null==se?void 0:se.map(((e,a)=>(0,y.jsx)(u.P,{index:a,uri:e.uri,name:e.name,images:[{url:e.image_url}]},e.uri)))}):null,ye?(0,y.jsx)(Ta.q,{className:be,title:d.ag.get("following"),total:null==re?void 0:re.length,seeAllUri:(0,l.QK)(G,["following"]).toURI(),id:"following",index:4,children:null==re?void 0:re.map(((e,a)=>(0,y.jsx)(u.P,{index:a,uri:e.uri,name:e.name,images:[{url:e.image_url}]},e.uri)))}):null,r&&I&&("editProfile"===j?(0,y.jsx)(Be,{uri:t,name:Z,image:V,onClose:me,shouldOpenImagePicker:T,userCapabilities:{edit_image:!(null!=W&&W.edit_image_disabled),edit_name:!(null!=W&&W.edit_name_disabled)}}):null)]})]})},Ba=e=>{const{uri:a}=e,{data:t,loading:i,error:r}=(0,p.J)(g.$F,[{uri:a}]),{public_playlists:o,total_public_playlists_count:l=0}=t||{};return i?(0,y.jsx)(c.h,{hasError:null!==r,errorMessage:d.ag.get("error.not_found.title.page")}):(0,y.jsx)(m.P,{className:n()("contentSpacing",f),total:l,title:d.ag.get("public_playlists"),showAll:!0,children:null==o?void 0:o.map(((e,a)=>(0,y.jsx)(S.Z,{index:a,uri:e.uri,name:e.name,authorName:e.owner_name,description:e.followers_count?d.ag.get("user.followers",e.followers_count):"",images:[{url:(0,$e.p)({imageUriOrUrl:e.image_url}),width:300,height:300}]},e.uri)))})},Qa=e=>{const{uri:a}=e,{data:t,loading:i,error:r}=(0,p.J)(g.wn,[{uri:a,limit:50}]),o=null==t?void 0:t.artists;return i?(0,y.jsx)(c.h,{hasError:null!==r,errorMessage:d.ag.get("error.not_found.title.page")}):(0,y.jsx)(m.P,{className:n()("contentSpacing",f),total:null==o?void 0:o.length,title:d.ag.get("recently_played_artists"),showAll:!0,children:null==o?void 0:o.map(((e,a)=>(0,y.jsx)(C.I,{index:a,name:e.name,uri:e.uri,images:[{url:e.image_url}]},e.uri)))})},Va=()=>{const{topArtists:e,loading:a,error:t}=Wa({includeTopArtists:!0,includeTopTracks:!1,topArtistsLimit:100,topTracksLimit:0});return a?(0,y.jsx)(c.h,{hasError:null!==t,errorMessage:d.ag.get("error.not_found.title.page")}):null===e?null:(0,y.jsx)(m.P,{className:n()("contentSpacing",f),total:e.items.length,title:d.ag.get("top_artists_this_month"),tagline:d.ag.get("only_visible_to_you"),showAll:!0,children:e.items.map(((e,a)=>{var t;return(0,y.jsx)(C.I,{index:a,uri:e.uri,name:e.profile.name,images:(null===(t=e.visuals.avatarImage)||void 0===t?void 0:t.sources)??[]},e.uri)}))})},Ga=e=>{let{isCurrentUser:a}=e;return a?(0,y.jsx)(Va,{}):(0,y.jsx)(c.h,{hasError:!0,errorMessage:d.ag.get("error.not_found.title.page")})},Za=e=>{let{uri:a}=e;const{topTracks:t,loading:i,error:r}=Wa({includeTopArtists:!1,includeTopTracks:!0,topArtistsLimit:0,topTracksLimit:100});return i?(0,y.jsx)(c.h,{hasError:null!==r,errorMessage:d.ag.get("error.not_found.title.page")}):null===t?null:(0,y.jsxs)("div",{className:n()("contentSpacing",f,x),children:[(0,y.jsxs)("div",{className:b,children:[(0,y.jsx)(M.x,{as:"h1",variant:"titleSmall",className:k,children:d.ag.get("top_tracks_this_month")}),(0,y.jsx)(M.x,{as:"p",variant:"bodySmall",children:d.ag.get("only_visible_to_you")})]}),(0,y.jsx)(ka,{tracks:t.items,uri:a,hasHeaderRow:!0})]})},za=e=>{let{uri:a,isCurrentUser:t}=e;return t?(0,y.jsx)(Za,{uri:a}):(0,y.jsx)(c.h,{hasError:!0,errorMessage:d.ag.get("error.not_found.title.page")})};var qa=t(85803);var Xa=t(963);const Ya=(0,i.memo)((function(){const{userId:e=""}=(0,r.UO)(),a=decodeURIComponent(e),t=(0,l.QK)(a).toURI(),i=(e=>{var a;const t=(0,Qe.g)(),i=null===(a=(0,qa.r)())||void 0===a?void 0:a.username;return!t&&i===e})(a);return(0,y.jsx)("section",{children:(0,y.jsxs)(r.Z5,{children:[(0,y.jsx)(r.AW,{path:"playlists",element:(0,y.jsx)(Xa.K,{pageId:o.Wg.PROFILE_PLAYLISTS,children:(0,y.jsx)(Ba,{uri:t})})}),(0,y.jsx)(r.AW,{path:"top/tracks",element:(0,y.jsx)(Xa.K,{pageId:o.Wg.PROFILE_TOP_TRACKS,children:(0,y.jsx)(za,{uri:t,isCurrentUser:i})})}),(0,y.jsx)(r.AW,{path:"top/artists",element:(0,y.jsx)(Xa.K,{pageId:o.Wg.PROFILE_TOP_ARTISTS,children:(0,y.jsx)(Ga,{isCurrentUser:i})})}),(0,y.jsx)(r.AW,{path:"recently-played-artists",element:(0,y.jsx)(Xa.K,{pageId:o.Wg.PROFILE_RECENTLY_PLAYED_ARTISTS,children:(0,y.jsx)(Qa,{uri:t})})}),(0,y.jsx)(r.AW,{path:"following",element:(0,y.jsx)(Xa.K,{pageId:o.Wg.PROFILE_FOLLOWING,children:(0,y.jsx)(j,{uri:t})})}),(0,y.jsx)(r.AW,{path:"followers",element:(0,y.jsx)(Xa.K,{pageId:o.Wg.PROFILE_FOLLOWERS,children:(0,y.jsx)(I,{uri:t})})}),(0,y.jsx)(r.AW,{path:"/",element:(0,y.jsx)(Xa.K,{pageId:o.Wg.PROFILE,children:(0,y.jsx)(Ja,{uri:t,isCurrentUser:i})})})]})})}))},85803:(e,a,t)=>{t.d(a,{r:()=>o});t(86277);var i=t(29132),r=t(82857);const o=()=>{const e=(0,i.v9)((e=>{var a;return null===(a=e.session)||void 0===a?void 0:a.user}));return e?{type:r.p.USER,uri:e.uri,username:e.id,displayName:e.display_name??null,images:e.images.map((e=>{let{url:a,width:t,height:i}=e;return{url:a,width:t||void 0,height:i||void 0}}))}:null}}}]);
//# sourceMappingURL=xpui-routes-profile.1ca37711.js.map