"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[509],{82164:(e,t,i)=>{i.d(t,{Puffin:()=>fi,PuffinButton:()=>Bi});i(70054),i(80378),i(86277);var n=i(50959),a=i(82187),r=i.n(a),s=i(69736),l=(i(75383),i(46758),i(53321),i(91686)),o=i(65019),c=i(95812),d=i(81912);let u=function(e){return e.bitrateLevel="bitrateLevel",e.targetBitrateLevel="targetBitrateLevel",e.targetBitrateAvailable="targetBitrateAvailable",e.strategy="strategy",e.isLocal="isLocal",e.autoAdjust="autoAdjust",e.deviceSupported="deviceSupported",e}({}),v=function(e){return e.Bluetooth_Degrades_HiFi="Bluetooth_Degrades_HiFi",e.Change_Cellular_Settings="Change_Cellular_Settings",e.Connect_Explanation="Connect_Explanation",e.Default_To_Very_High="Default_To_Very_High",e.Need_To_Redownload="Need_To_Redownload",e.Opt_Out_Of_Downgrade="Opt_Out_Of_Downgrade",e.Poor_Bandwidth_Interferes="Poor_Bandwidth_Interferes",e.Hihi_Unavailable="Hifi_Unavailable",e}({}),g=function(e){return e[e.Internet=0]="Internet",e[e.Spotify_Connect=1]="Spotify_Connect",e[e.Downloads=2]="Downloads",e}({}),x=function(e){return e.Good="good",e.Poor="poor",e.Unknown="unknown",e.Unavailable="unavailable",e}({});const h=[{criteria:{online:!0,streamingHiFi:!1,targetingHiFi:!1,bitrateStrategy:[c.kZ.CACHED_FILE,c.kZ.BACKEND_ADVISED,c.kZ.BEST_MATCHING],trackHiFiAvailable:!0},result:v.Change_Cellular_Settings},{criteria:{online:!0,autoAdjust:!1,trackHiFiAvailable:!0},result:v.Opt_Out_Of_Downgrade},{criteria:{online:!0,streamingHiFi:!1,targetingHiFi:!0,deviceCompatible:!0,internetBandwidth:x.Poor,trackHiFiAvailable:!0},result:v.Poor_Bandwidth_Interferes},{criteria:{online:!0,autoAdjust:!0,streamingHiFi:!1,targetingHiFi:!1,deviceCompatible:!0,internetBandwidth:x.Poor,trackHiFiAvailable:!0},result:v.Default_To_Very_High},{criteria:{online:!0,streamingHiFi:!1,bitrateStrategy:[c.kZ.OFFLINED_FILE],trackHiFiAvailable:!0},result:v.Need_To_Redownload},{criteria:{online:!0,streamingHiFi:!0,trackHiFiAvailable:!0},result:v.Connect_Explanation},{criteria:{online:!0,targetingHiFi:!0,trackHiFiAvailable:!1},result:v.Hihi_Unavailable}];const p=[{criteria:{bitrateLevel:[c.M4.HIFI],strategy:[c.kZ.BEST_MATCHING,c.kZ.BACKEND_ADVISED,c.kZ.CACHED_FILE],deviceSupported:!0,autoAdjust:!0},result:x.Good},{criteria:{bitrateLevel:[c.M4.LOW,c.M4.NORMAL,c.M4.HIGH,c.M4.VERY_HIGH],targetBitrateLevel:[c.M4.LOW,c.M4.NORMAL,c.M4.HIGH,c.M4.VERY_HIGH],strategy:[c.kZ.BEST_MATCHING,c.kZ.CACHED_FILE],deviceSupported:!0,autoAdjust:!0},result:x.Good},{criteria:{bitrateLevel:[c.M4.LOW,c.M4.NORMAL,c.M4.HIGH,c.M4.VERY_HIGH],targetBitrateLevel:[c.M4.HIFI],strategy:[c.kZ.BEST_MATCHING,c.kZ.BACKEND_ADVISED,c.kZ.CACHED_FILE],targetBitrateAvailable:!0,deviceSupported:!0,autoAdjust:!0},result:x.Poor},{criteria:{bitrateLevel:[c.M4.LOW,c.M4.NORMAL,c.M4.HIGH,c.M4.VERY_HIGH],targetBitrateLevel:[c.M4.LOW,c.M4.NORMAL,c.M4.HIGH,c.M4.VERY_HIGH],strategy:[c.kZ.BACKEND_ADVISED],deviceSupported:!0,autoAdjust:!0},result:x.Poor},{criteria:{bitrateLevel:[c.M4.LOW,c.M4.NORMAL,c.M4.HIGH,c.M4.VERY_HIGH],targetBitrateLevel:[c.M4.HIFI],targetBitrateAvailable:!1,deviceSupported:!0,autoAdjust:!0},result:x.Unavailable},{criteria:{autoAdjust:!1},result:x.Unknown},{criteria:{deviceSupported:!1},result:x.Unknown}],m=[{criteria:{bitrateLevel:[c.M4.HIFI],deviceSupported:!0},result:!0},{criteria:{bitrateLevel:[c.M4.UNKNOWN,c.M4.LOW,c.M4.NORMAL,c.M4.HIGH,c.M4.VERY_HIGH],strategy:[c.kZ.BEST_MATCHING,c.kZ.BACKEND_ADVISED,c.kZ.CACHED_FILE],targetBitrateLevel:[c.M4.HIFI],targetBitrateAvailable:!0,deviceSupported:!0},result:!0},{criteria:{bitrateLevel:[c.M4.UNKNOWN,c.M4.LOW,c.M4.NORMAL,c.M4.HIGH,c.M4.VERY_HIGH],strategy:[c.kZ.OFFLINED_FILE],targetBitrateLevel:[c.M4.HIFI],targetBitrateAvailable:!0,deviceSupported:!0},result:!1},{criteria:{strategy:[c.kZ.BEST_MATCHING,c.kZ.BACKEND_ADVISED,c.kZ.CACHED_FILE],targetBitrateAvailable:!0,deviceSupported:!0},result:!1},{criteria:{deviceSupported:!1},result:!0},{criteria:{bitrateLevel:[c.M4.UNKNOWN,c.M4.LOW,c.M4.NORMAL,c.M4.HIGH,c.M4.VERY_HIGH],targetBitrateLevel:[c.M4.HIFI],targetBitrateAvailable:!1,deviceSupported:!0},result:!0},{criteria:{targetBitrateLevel:[c.M4.HIFI]},result:!0}],C=(e,t)=>{for(const[i,n]of Object.entries(t.criteria))if(i===u.bitrateLevel){if(!n.includes(e[u.bitrateLevel]))return!1}else if(i===u.targetBitrateLevel){if(!n.includes(e[u.targetBitrateLevel]))return!1}else if(i===u.strategy){if(!n.includes(e[u.strategy]))return!1}else{if(!n===e[i])return!1}return!0};var b=i(57882),f=i(9443);const y={hifiStatus:c.dR.NONE,bitrateLevel:c.M4.UNKNOWN,targetBitrateLevel:c.M4.UNKNOWN,targetBitrateAvailable:!1,strategy:c.kZ.UNKNOWN};function j(){const{hifiStatus:e,bitrateLevel:t,targetBitrateLevel:i,targetBitrateAvailable:a,strategy:r}=(0,o.Y)((e=>({...y,...(null==e?void 0:e.playbackQuality)??null})),d.V),s=(0,l.B)((e=>e.activeDevice)),v=(0,n.useMemo)((()=>null!==s&&s.hifiSupport?s.hifiSupport:{fullySupported:!1,deviceSupported:!1,userEligible:!1}),[s]).deviceSupported,{settings:{values:j}}=(0,b.rV)(),S=j["audio.allow_downgrade"],H=(null==s?void 0:s.isLocal)||!1;let w;w=H?r===c.kZ.CACHED_FILE||r===c.kZ.OFFLINED_FILE?g.Downloads:g.Internet:g.Spotify_Connect;const N={bitrateLevel:t,targetBitrateLevel:i,targetBitrateAvailable:a,strategy:r,isLocal:H,deviceSupported:v,autoAdjust:S},E=(e=>{for(const t of m)if(C(e,t))return t.result;return e[u.bitrateLevel]===c.M4.HIFI||e[u.targetBitrateLevel]===c.M4.HIFI})(N),_=(e=>{for(const t of p)if(C(e,t))return t.result;return e[u.strategy]===c.kZ.BACKEND_ADVISED?x.Poor:x.Good})(N),k=(0,f.k)(),A=i===c.M4.HIFI&&a,I=function(e){let{online:t,streamingHiFi:i,targetingHiFi:n,strategy:a,trackHiFiAvailable:r,autoAdjust:s,internetBandwidth:l,hifiCompatibleDevice:o,isLocal:c}=e;const d=[];for(const u of h){const{criteria:e,result:v}=u;e.online===t&&(void 0!==e.autoAdjust&&e.autoAdjust!==s||void 0!==e.streamingHiFi&&e.streamingHiFi!==i||void 0!==e.targetingHiFi&&e.targetingHiFi!==n||void 0!==e.deviceCompatible&&e.deviceCompatible!==o||void 0!==e.bitrateStrategy&&!1===c||(void 0===e.bitrateStrategy||void 0!==a&&e.bitrateStrategy.includes(a))&&(void 0!==e.internetBandwidth&&e.internetBandwidth!==l||void 0!==e.trackHiFiAvailable&&e.trackHiFiAvailable!==r||d.push(v)))}return d}({online:k,streamingHiFi:t===c.M4.HIFI,targetingHiFi:i===c.M4.HIFI,strategy:r,trackHiFiAvailable:A,autoAdjust:S,internetBandwidth:_,hifiCompatibleDevice:v,isLocal:H});return{hifiStatus:e,bitrateLevel:t,flags:I,internetBandwidth:_,playingVia:{channelIsHiFi:E,channel:w},hifiCompatibleDevice:v}}var S=i(32414);const H="cJMj4UrGP_oAOqCx48nR";var w=i(11527);const N=()=>(0,w.jsxs)(S.x,{variant:"tinted",className:H,children:[(0,w.jsx)(s.x,{variant:"bodyMedium",semanticColor:"textBase",children:"Listen in Lossless, offline"}),(0,w.jsx)(s.x,{variant:"bodySmall",semanticColor:"textSubdued",children:"Download your audio in Lossless to listen in our highest quality while you’re offline. Update download quality in Settings."})]});var E=i(25331),_=i(15671),k=i(60046),A=i(64966);const I="RC4O1refNWyxOrqUoE4N",M="hvDtTjFeompKZLI60Sy7",L=e=>{let{title:t,message:i,id:n}=e;return(0,w.jsx)(E.w,{id:n,className:I,variant:"tinted",pretitle:(0,w.jsxs)("div",{className:M,children:[(0,w.jsx)(_.l,{size:"small",semanticColor:"textWarning"}),(0,w.jsx)(s.x,{variant:"bodySmall",semanticColor:"textSubdued",children:"Troubleshoot"})]}),title:t,body:(0,w.jsx)(A.k,{LinkComponent:k.default,source:i,splitter:/\|/g,semanticColor:"textSubdued"})})};var D=i(85648),O=i(82322),B=i(16145),F=i(8172);const T="meFagfHOyIABVkyjrLW2",V="bDxrAHtivqsWjq5P3zcK",R="H57fABDcHNmhfpukMqam",z="wwRfoIhkgiHhfHyluH34",P="SKCb8zWWttHQDTYn1r8m";let U=function(e){return e[e.PASSING=0]="PASSING",e[e.NEEDS_ATTENTION=1]="NEEDS_ATTENTION",e[e.UNKNOWN=2]="UNKNOWN",e}({});const Z=e=>{let{metric:t,label:i,severity:n}=e;return(0,w.jsxs)("div",{className:r()(T,{[z]:n===U.UNKNOWN}),children:[(()=>{switch(n){case U.PASSING:return(0,w.jsx)(O.K,{size:"large",className:V,semanticColor:"textBase"});case U.NEEDS_ATTENTION:return(0,w.jsx)(B.l,{size:"large",className:R,semanticColor:"textWarning"});case U.UNKNOWN:return(0,w.jsx)(F.S,{size:"large",className:R,semanticColor:"textBase"});default:return null}})(),(0,w.jsxs)("div",{className:P,children:[(0,w.jsx)(s.x,{as:"p",variant:"bodyMedium",semanticColor:"textBase",children:t}),(0,w.jsx)(s.x,{as:"p",semanticColor:"textSubdued",variant:"bodySmall",children:i})]})]})},G=()=>{const{hifiCompatibleDevice:e,playingVia:t,internetBandwidth:i}=j();return(0,w.jsxs)("div",{children:[(0,w.jsx)(Z,{metric:D.ag.get("hifi.hifiCompatibleDevice"),label:e?D.ag.get("hifi.yes"):D.ag.get("hifi.no"),severity:e?U.PASSING:U.NEEDS_ATTENTION}),(0,w.jsx)(Z,{metric:D.ag.get("hifi.playingVia"),label:(()=>{const{channel:e}=t;switch(e){case g.Downloads:return D.ag.get("local-files.source.downloads");case g.Internet:return D.ag.get("hifi.networkConnection");case g.Spotify_Connect:return D.ag.get("spotify-connect");default:return""}})(),severity:t.channelIsHiFi?U.PASSING:U.NEEDS_ATTENTION}),(0,w.jsx)(Z,{metric:D.ag.get("hifi.internetBandwidth"),label:(()=>{switch(i){case x.Good:return D.ag.get("hifi.good");case x.Poor:return D.ag.get("hifi.poor");case x.Unknown:default:return D.ag.get("hifi.unknown")}})(),severity:(()=>{switch(i){case x.Good:return U.PASSING;case x.Poor:return U.NEEDS_ATTENTION;case x.Unknown:default:return U.UNKNOWN}})()})]})};let W=function(e){return e.INFO="INFO",e.ERROR="ERROR",e}({});function q(e){return e.type===W.ERROR}i(20550),i(27082);const Q={[v.Connect_Explanation]:()=>({type:"info",message:D.ag.get("hifi.connectExplanation",`<img src='images/connect-to-devices-white.svg'\n        alt='${D.ag.get("spotify-connect")}' width="16" height="16"/>`,`<img src='images/hifi.svg'\n    alt='${D.ag.get("desktop.settings.streamingQualityHiFi")}' width="16" height="7"/>`)}),[v.Change_Cellular_Settings]:()=>({type:"info",message:D.ag.get("hifi.changeCellularSettings")}),[v.Opt_Out_Of_Downgrade]:()=>({type:"error",title:"Change your settings for a smoother listening experience",message:D.ag.get("hifi.optOutOfDowngrade")}),[v.Poor_Bandwidth_Interferes]:()=>({type:"error",title:"Check your connection",message:D.ag.get("hifi.poorBandwidthInterferes")}),[v.Default_To_Very_High]:()=>({type:"info",message:D.ag.get("hifi.defaultToVeryHigh")}),[v.Need_To_Redownload]:()=>({type:"error",title:"Re-download your songs to stream them in HiFi",message:D.ag.get("hifi.needToReDownload")}),[v.Bluetooth_Degrades_HiFi]:()=>({type:"info",message:D.ag.get("hifi.bluetoothDegradesHifi",`<img src='images/hifi.svg'\n  alt='${D.ag.get("desktop.settings.streamingQualityHiFi")}' width="16" height="7"/>`)}),[v.Hihi_Unavailable]:()=>({type:"error",title:"Content not available in HiFi",message:"The content you're trying to listen to isn't available in HiFi."})},K=e=>{switch(e){case c.M4.HIFI24:return{title:"Lossless",bitrateLabel:"≤2,117 kbps",bitrateDetails:["Up to 15.9 MB/min","Up to 24-bit/44.1 kHz • FLAC"]};case c.M4.HIFI:return{title:"Lossless",bitrateLabel:"≤1,441 kbps",bitrateDetails:["Up to 10.6 MB/min","Up to 16-bit/44.1 kHz • FLAC"]};case c.M4.VERY_HIGH:return{title:"Very High",bitrateLabel:"320 kbps",bitrateDetails:["Up to 320 kbps • 2 MB/min"]};case c.M4.HIGH:return{title:"High",bitrateLabel:"160 kbps",bitrateDetails:["Up to 160 kbps • 1 MB/min"]};case c.M4.NORMAL:return{title:"Normal",bitrateLabel:"96 kbps",bitrateDetails:["Up to 96 kbps • 0.6 MB/min"]};case c.M4.LOW:return{title:"Low",bitrateLabel:"24 kpbs",bitrateDetails:["Up to 24 kbps • 0.2 MB/min"]};case c.M4.UNKNOWN:default:return{title:"Unknown",bitrateLabel:null}}};var Y=i(83335),X=i(54941);const J=e=>{let{children:t,...i}=e;return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(Y.V,{panel:X.s.Puffin,...i}),t]})};i(22849),i(606);var $=i(84317);let ee=function(e){return e.Overview="overview",e.ActivationDetection="activationDetection",e.ActivationSpecific="activationSpecific",e.ActivationExternalization="activationExternalization",e.Error="error",e.ManualSelection="manualSelection",e.AudioQualitySettings="audioQualitySettings",e.AudioQualityDetails="audioQualityDetails",e.DiscoverHifi="discoverHifi",e}({}),te=function(e){return e.GetStarted="getStarted",e.OnError="onError",e.SelectManually="selectManually",e.Continue="continue",e.Close="close",e.Activate="activate",e.SetupNewDevice="setupNewDevice",e.NotFound="notFound",e.Settings="settings",e.OnboardHifi="onboardHifi",e.Details="details",e}({});const ie={[ee.Overview]:{[te.GetStarted]:ee.ActivationDetection,[te.OnError]:ee.Error,[te.SelectManually]:ee.ManualSelection,[te.Settings]:ee.AudioQualitySettings,[te.OnboardHifi]:ee.DiscoverHifi,[te.Details]:ee.AudioQualityDetails},[ee.ActivationDetection]:{[te.SelectManually]:ee.ManualSelection,[te.Close]:ee.Overview,[te.OnError]:ee.Error,[te.Continue]:ee.ActivationExternalization},[ee.ActivationExternalization]:{[te.Close]:ee.Overview,[te.OnError]:ee.Error,[te.Continue]:ee.ActivationSpecific,[te.Activate]:ee.Overview},[ee.ActivationSpecific]:{[te.Close]:ee.Overview,[te.OnError]:ee.Error,[te.Activate]:ee.Overview},[ee.ManualSelection]:{[te.Continue]:ee.ActivationExternalization,[te.Close]:ee.Overview,[te.OnError]:ee.Error,[te.NotFound]:ee.ActivationExternalization},[ee.DiscoverHifi]:{[te.Continue]:ee.Overview},[ee.AudioQualitySettings]:{},[ee.AudioQualityDetails]:{},[ee.Error]:{}},ne=(0,n.createContext)({currentView:ee.Overview,viewTransitions:ie,setCurrentView:()=>{},toPreviousView:()=>{},viewOptions:null}),ae=e=>{let{children:t}=e;const i=(0,$.mI)(),[a,r]=(0,n.useState)((()=>(e=>[{view:e===X.s.PuffinActivation?ee.ActivationDetection:ee.Overview,options:{}}])(i))),s=(0,n.useCallback)(((e,t)=>{e===ee.Overview?r([{view:e,options:t??{}}]):r((i=>[...i,{view:e,options:t??{}}]))}),[]),l=(0,n.useCallback)((()=>{r((e=>e.slice(0,-1)))}),[]);if(0===a.length)throw new Error("Puffin view state stack should never be empty");const{view:o,options:c}=a.at(-1);return(0,w.jsx)(ne.Provider,{value:{currentView:o,viewOptions:c,setCurrentView:s,toPreviousView:l,viewTransitions:ie},children:t})},re="qMaFDVQQmaISMsPv0U2G",se="CQswwQrGh_V_7HZvIYdV",le="xLt3LoPc1ngk_OEJoxoy",oe=()=>{var e;const{toPreviousView:t}=(0,n.useContext)(ne),i=j(),a=K(i.bitrateLevel),r=(()=>{const{flags:e}=j(),t=[];return e.forEach((e=>{if(Q[e]){const{type:i,message:n,title:a}=Q[e]();"info"===i?t.push({id:e,text:n,type:W.INFO}):t.push({id:e,text:n,title:a??"",type:W.ERROR})}})),t})(),l=r.filter(q);return(0,w.jsx)(J,{onBack:t,children:(0,w.jsxs)("div",{className:re,children:[(0,w.jsx)(s.x,{variant:"bodySmall",semanticColor:"textSubdued",children:"Current quality"}),(0,w.jsx)(s.x,{variant:"titleMedium",semanticColor:"textBrightAccent",children:a.title}),(0,w.jsx)("div",{className:se,children:null===(e=a.bitrateDetails)||void 0===e?void 0:e.map(((e,t)=>(0,w.jsx)(s.x,{variant:"bodySmall",semanticColor:"textBrightAccent",children:e},`bitrate-details-${t}`)))}),(0,w.jsx)(s.x,{variant:"bodySmall",semanticColor:"textBrightAccent"}),(0,w.jsx)("div",{className:le,children:(0,w.jsx)(G,{})}),l.map((e=>{let{text:t,title:i,id:n}=e;return(0,w.jsx)(L,{id:n,title:i,message:t},n)})),(0,w.jsx)(N,{})]})})};var ce=i(6487),de=i(36879);const ue=e=>{let{subtitles:t}=e;return(0,w.jsx)(w.Fragment,{children:t.map(((e,t)=>(0,w.jsx)(s.x,{semanticColor:"textSubdued",variant:"bodySmall",children:e},`subtitle-${t}`)))})},ve="X9MNTs22yzn5ToovQOmE",ge="yBIuz1wIV3CyRacOwXyO",xe="k_jPgesB17n6Hh6VnSdL",he="yufpxn5NeaZzerlZWxyY",pe="AzeKzsaxTtvIb3Rj0Yp_",me=e=>{let{title:t,isLossless:i}=e;return(0,w.jsxs)("div",{className:xe,children:[(0,w.jsx)(s.x,{variant:"bodyMedium",semanticColor:"textBase",children:t}),i&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(s.x,{variant:"bodyMedium",semanticColor:"textBase",children:"•"}),(0,w.jsx)(s.x,{variant:"bodyMedium",semanticColor:"textBrightAccent",children:"Highest"})]})]})};let Ce=function(e){return e[e.AUTOMATIC=0]="AUTOMATIC",e[e.LOW=1]="LOW",e[e.MEDIUM=2]="MEDIUM",e[e.HIGH=3]="HIGH",e[e.VERY_HIGH=4]="VERY_HIGH",e[e.HIFI=5]="HIFI",e}({});var be=i(46729);function fe(){return(0,be.Zq)()}var ye=i(41194);var je=i(22496),Se=i(49598),He=i(9709);function we(e){const t=(0,n.useMemo)((()=>["useSettingsValue",e.key]),[e.key]),i=(0,je.NL)(),a=(0,ye.a)({queryKey:t,queryFn:async()=>await e.getValue(),gcTime:36e5,staleTime:6e5,retry:(e,t)=>!(t instanceof He.P)&&e<3}),r=(0,Se.D)({mutationFn:async t=>{await e.setValue(t)},onMutate:async e=>{await i.cancelQueries({queryKey:t});const n=i.getQueryData(t);return i.setQueryData(t,e),{prevState:n,newState:e}},onError:(e,n,a)=>{He.P,i.setQueryData(t,null==a?void 0:a.prevState)}});return(0,n.useEffect)((()=>e.subValue((e=>{i.setQueryData(t,e)}))),[i,t,e]),[a,r]}const Ne=e=>{switch(e){case Ce.HIFI:return{title:"Lossless",subtitles:["Up to 2117 kbps • 15.9 MB/min","24-bit/44.1kHz • FLAC"]};case Ce.VERY_HIGH:return{title:"Very High",subtitles:["320 kbps • 2 MB/min"]};case Ce.HIGH:return{title:"High",subtitles:["160 kbps • 1 MB/min"]};case Ce.MEDIUM:return{title:"Normal",subtitles:["96 kbps • 0.6 MB/min"]};case Ce.LOW:return{title:"Low data",subtitles:["24 kbps • 0.2 MB/min"]};default:return{title:null,subtitles:null}}},Ee=e=>{let{onClick:t,quality:i,playQuality:n}=e;const{title:a,subtitles:r}=Ne(i);if(null===a||null===r)return null;const s=n===i,l=i===Ce.HIFI;return(0,w.jsx)(E.w,{id:"title",variant:"naked",verticalGap:"2px",onClick:t,title:(0,w.jsx)(me,{title:a,isLossless:l}),subtitle:(0,w.jsx)(ue,{subtitles:r}),trailing:s?(0,w.jsx)(ce.N,{semanticColor:"textBrightAccent"}):void 0})},_e=()=>{const{toPreviousView:e}=(0,n.useContext)(ne),t=fe(),[{data:i},{mutate:a}]=we(t.quality.streamingQuality),[{data:r},{mutate:l}]=we(t.quality.autoAdjustQuality),o=function(){const e=fe();return(0,ye.a)({queryKey:["settings-formats"],queryFn:()=>e.quality.getFormats(),gcTime:36e5,staleTime:6e5}).data}();return void 0===o||void 0===r||void 0===i?null:(0,w.jsxs)(J,{onBack:e,children:[(0,w.jsx)(s.x,{className:ve,variant:"titleSmall",semanticColor:"textBase",children:"Streaming quality"}),(0,w.jsx)("div",{className:ge,children:o.sort(((e,t)=>e.quality-t.quality)).map(((e,t)=>(0,w.jsx)(Ee,{quality:e.quality,playQuality:i,onClick:()=>a(e.quality)},t)))}),(0,w.jsx)(s.x,{children:"Lossless audio will play when available. 24-bit lossless available on limited songs."}),(0,w.jsxs)("div",{className:he,children:[(0,w.jsx)(s.x,{variant:"bodyMediumBold",semanticColor:"textBase",children:"Listening Preferences"}),(0,w.jsx)(E.w,{className:pe,variant:"naked",size:"sm",id:"auto-adjust-quality",horizontalGap:"0px",title:(0,w.jsx)(s.x,{variant:"bodyMedium",semanticColor:"textBase",children:"Auto adjust quality"}),trailing:(0,w.jsx)(de.Z,{id:"desktop.settings.automatic-downgrade",value:r,onSelected:l,condensed:!0})}),(0,w.jsx)(s.x,{variant:"bodySmall",semanticColor:"textSubdued",children:"Recommended setting: On"}),(0,w.jsx)(s.x,{variant:"bodySmall",semanticColor:"textSubdued",children:"We adjust your audio quality when your internet bandwidth is poor. Turning this off may cause interruptions to your listening."})]})]})};var ke=i(70526),Ae=i(43286),Ie=i(65786);const Me=()=>(0,Ie.z)("onboarding-dismissed:hifi",!1);var Le=i(35534);const De="UxZdDYEyLTJdUVpcSnlV",Oe="m9h5qSziGER706uY2RLQ",Be="jIYF1gLzIxXVZrOmD9Xw",Fe="hgN38CBl0wgc1seJdwV1",Te="xg5jMOqKDEckYRUdLhd_",Ve="ylnh7SyD5oExDYYaJntU",Re=e=>{let{path:t}=e;return(0,w.jsx)("div",{className:Be,children:(0,w.jsx)(n.Suspense,{fallback:null,children:(0,w.jsx)(Le.M,{loop:!0,autoplay:!0,path:t})})})},ze=e=>{let{title:t,subtitle:i,footer:n,lottiePath:a}=e;return(0,w.jsxs)("div",{className:De,children:[(0,w.jsx)(Re,{path:a}),(0,w.jsxs)("div",{className:Oe,children:[(0,w.jsx)(s.x,{variant:"titleMedium",semanticColor:"textBase",children:t}),i&&(0,w.jsx)(s.x,{variant:"bodyMedium",children:i})]}),(0,w.jsx)("div",{children:n})]})},Pe=e=>{let{nrSteps:t,atStep:i}=e;return(0,w.jsx)("div",{className:Fe,children:Array.from({length:t}).map(((e,t)=>(0,w.jsx)("div",{className:r()(Te,{[Ve]:i===t})},t)))})},Ue=[{get title(){return"Quality made clear"},get subtitle(){return"It’s easy to know when you’re streaming music in Lossless, song by song."},get buttonLabel(){return"Next"},get lottiePath(){return"https://puffin.spotifycdn.com/pigeon_onboarding_animation_1.json"}},{get title(){return"Simple controls"},get subtitle(){return"Not getting Lossless or want to conserve mobile data? Troubleshoot with a tap."},get buttonLabel(){return"Next"},get lottiePath(){return"https://puffin.spotifycdn.com/pigeon_onboarding_animation_2.json"}},{get title(){return"Everywhere you listen"},get subtitle(){return"Lossless streams on any compatible device and works with Spotify Connect."},get buttonLabel(){return"Next"},get lottiePath(){return"https://puffin.spotifycdn.com/pigeon_onboarding_animation_3.json"}},{get title(){return"Nonstop beats"},get subtitle(){return"Smart technology means fewer delays when your connection is slow. "},get buttonLabel(){return"Listen now"},get lottiePath(){return"https://puffin.spotifycdn.com/pigeon_onboarding_animation_4.json"}}],Ze=()=>{const[e,t]=(0,n.useState)(0),[i,a]=Me(),{setCurrentView:r,toPreviousView:s,viewTransitions:l}=(0,n.useContext)(ne),o=l[ee.DiscoverHifi],{title:c,subtitle:d,buttonLabel:u,lottiePath:v}=Ue[e];return(0,w.jsx)(J,{titleSlot:(0,w.jsx)(Pe,{nrSteps:4,atStep:e}),onBack:s,preventDefaultClose:!0,children:(0,w.jsx)(ze,{title:c,subtitle:d,lottiePath:v,footer:(0,w.jsx)(Ae.D,{colorSet:"invertedLight",size:"medium",onClick:()=>{3===e?(a(!0),r(o[te.Continue])):t((e=>e+1))},children:u})})})};var Ge=i(13379),We=i(16095);function qe(e){const t=(0,n.useRef)(e),i=(0,Ge.f)();t.current=e,(0,n.useEffect)((()=>{const e=i.getFiltersEvents(),n=e=>t.current(e);return null==e||e.addListener(We.s.DEVICE_CONNECTED,n),()=>{null==e||e.removeListener(We.s.DEVICE_CONNECTED,n)}}),[i])}const Qe=()=>{const e=(0,Ge.f)(),[t,i]=(0,n.useState)((()=>e.getCurrentAudioDevice()));return qe((e=>{let{data:{audioDevice:t}}=e;i(t)})),t};var Ke=i(74058),Ye=i(90779),Xe=i(22429),Je=i(92432);const $e={device:null,predictedState:null,isOnboarded:!1,currentState:{externalizationEnabled:!1,specificEnabled:!1},contentRestrictions:{specificRestricted:!1,externalizationRestricted:!1},toggleTuneHeadphones:null,toggleTuneStudio:null,setFilterState:()=>Promise.resolve()},et=()=>{const e=(0,Ge.f)(),t=(0,je.NL)(),{isPlayingRemotely:i}=(0,Je.H)(),a=(0,n.useMemo)((()=>["puffin-current-device"]),[]),{data:r,isLoading:s,isError:l}=(0,ye.a)({queryKey:a,queryFn:async()=>await e.getFilterState(),gcTime:5e3,staleTime:5e3});return function(e){const t=(0,n.useRef)(e),i=(0,Ge.f)();t.current=e,(0,n.useEffect)((()=>{const e=i.getFiltersEvents(),n=e=>t.current(e);return null==e||e.addListener(We.s.UPDATE,n),()=>{null==e||e.removeListener(We.s.UPDATE,n)}}),[i])}((()=>t.invalidateQueries({queryKey:a}))),{deviceFilterState:!i&&r||$e,isLoading:s,isError:l}},tt=()=>{var e;const{setCurrentView:t,viewTransitions:i}=(0,n.useContext)(ne),{deviceFilterState:a,isLoading:r}=et(),s=Qe(),l=i[ee.ActivationDetection];return(0,n.useLayoutEffect)((()=>{const e=(null==s?void 0:s.transportType)===Ke.Fl.TRANSPORT_TYPE_BLUETOOTH;s&&!e&&t(ee.ManualSelection)}),[s,t]),(0,w.jsx)(ze,{title:`We think you’re using ${null===(e=a.device)||void 0===e?void 0:e.deviceName}`,lottiePath:"https://puffin.spotifycdn.com/puffin_shot_1.json",footer:r||!a.device?(0,w.jsx)(Xe.H,{}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{children:(0,w.jsx)(Ae.D,{colorSet:"invertedLight",size:"medium",onClick:()=>{t(l.continue)},children:"Next"})}),(0,w.jsx)(Ye.o,{semanticColor:"textSubdued",size:"medium",onClick:()=>{t(l.selectManually)},condensed:!0,children:"Not my headphones"})]})})};var it=i(24071),nt=i(47543);const at=()=>{const e=(0,Ge.f)();return{setCurrentDevice:(0,n.useCallback)((t=>{e.setCurrentDevice(t)}),[e]),removeCurrentDevice:(0,n.useCallback)((()=>{e.removeCurrentDevice()}),[e])}},rt=e=>{let{onClick:t}=e;const{deviceFilterState:i}=et(),{setCurrentDevice:a}=at(),r=Qe(),s=(0,it.s4)(),{setCurrentView:l}=(0,n.useContext)(ne),o=(0,n.useCallback)((async()=>{a(i.device);try{await i.setFilterState({specificEnabled:!!i.toggleTuneHeadphones,externalizationEnabled:!!i.toggleTuneStudio})}catch{return void l(ee.Error)}((e,t,i)=>{var n,a,r,s;e.send((0,nt.m)({has_tuner:!!t.toggleTuneHeadphones,filter_brand:(null===(n=t.device)||void 0===n?void 0:n.brand)??null,filter_model:(null===(a=t.device)||void 0===a?void 0:a.model)??null,was_predicted:!!t.predictedState,headphone_name_over_bluetooth:(null==i?void 0:i.transportType)===Ke.Fl.TRANSPORT_TYPE_BLUETOOTH?(null==i?void 0:i.name)??null:null,external_accessory_mapping_predicted_brand:(null===(r=t.predictedState)||void 0===r?void 0:r.predictedBrand)??null,external_accessory_mapping_predicted_model:(null===(s=t.predictedState)||void 0===s?void 0:s.predictedModel)??null}))})(s,i,r),t()}),[i,s,t,a,l,r]);return(0,w.jsx)(Ae.D,{colorSet:"invertedLight",size:"medium",onClick:o,children:"Start listening"})},st=e=>{let{onClick:t}=e;return(0,w.jsx)(Ae.D,{colorSet:"invertedLight",size:"medium",onClick:async()=>{t()},children:"Next"})},lt=()=>{const{deviceFilterState:e,isLoading:t}=et(),{setCurrentView:i,viewTransitions:a}=(0,n.useContext)(ne),r=a[ee.ActivationExternalization];return(0,w.jsx)(ze,{title:"Spatialize",subtitle:"Broaden the output from your headphones. Like you’re in front of speakers.",lottiePath:"https://puffin.spotifycdn.com/puffin_shot_1.json",footer:t||!e.device?(0,w.jsx)(Xe.H,{}):(0,w.jsx)(w.Fragment,{children:e.toggleTuneHeadphones?(0,w.jsx)(st,{onClick:()=>{i(r.continue)}}):(0,w.jsx)(rt,{onClick:()=>{i(r.activate)}})})})},ot=()=>{const{setCurrentView:e,viewTransitions:t}=(0,n.useContext)(ne),i=t[ee.ActivationExternalization];return(0,w.jsx)(ze,{title:"Optimize",subtitle:"Improve the sound of your headphones without new hardware.",lottiePath:"https://puffin.spotifycdn.com/puffin_shot_2.json",footer:(0,w.jsx)(rt,{onClick:()=>{e(i.activate)}})})},ct="gaHyKsxwiyCh1yZbAPGu",dt="UdGQGXIUZX8XSGzT_vjV",ut="tPVta1L63yHDp2xTlCsV",vt="Z5JRUt7Q9Fs7sIOxMyZO",gt=e=>{let{number:t,message:i}=e;return(0,w.jsxs)("div",{className:ut,children:[(0,w.jsx)("div",{className:vt,children:(0,w.jsx)(s.x,{variant:"bodySmall",semanticColor:"textBase",children:t})}),(0,w.jsx)(s.x,{variant:"bodySmall",semanticColor:"textSubdued",children:i})]})},xt=()=>{const{setCurrentView:e}=(0,n.useContext)(ne);return(0,w.jsxs)("div",{className:ct,children:[(0,w.jsx)(s.x,{variant:"titleSmall",semanticColor:"textBase",children:"We can’t detect your headphones"}),(0,w.jsxs)("div",{className:dt,children:[(0,w.jsx)(gt,{number:1,message:"Make sure Bluetooth is turned on."}),(0,w.jsx)(gt,{number:2,message:"Make sure your headphones are connected. Try restarting them."}),(0,w.jsx)(gt,{number:3,message:"Make sure that only one set of headphones are connected."}),(0,w.jsx)(gt,{number:4,message:"Using speakers or another device? Spatialize and Optimize are only available for headphones."})]}),(0,w.jsx)(Ye.o,{semanticColor:"textSubdued",onClick:()=>{e(ee.Overview)},children:"Still not working"})]})};var ht=i(29608),pt=i(18534);const mt=e=>{let{title:t,description:i,confirmButtonText:a="OK",cancelButtonText:r="Cancel",onConfirm:s}=e;const{setCurrentView:l}=(0,n.useContext)(ne),o=(0,pt.hv)(),[c,d]=(0,n.useState)(!1),u=(0,n.useRef)(!1);return{dialog:c?(0,w.jsx)(ht.Q,{onClose:()=>d(!1),onConfirm:()=>{s(),u.current?o($.rZ.PUFFIN_BUTTON_CLICK):l(ee.Overview)},titleText:t,"aria-label":t,descriptionText:i,cancelText:r,confirmText:a}):null,triggerDialog:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];u.current=e,d(!0)}}},Ct=()=>mt({title:"Cancel setup?",description:"You won’t get the best possible sound for your headphones.",confirmButtonText:"Cancel setup",cancelButtonText:"Continue setup",onConfirm:()=>{}}),bt=e=>{let{type:t}=e;const{deviceFilterState:i}=et(),a=Qe(),{triggerDialog:r,dialog:s}=Ct(),l=(0,n.useRef)("detection"===t);let o=i.toggleTuneHeadphones?3:2,c=0;return"externalization"===t?c=1:"specific"===t&&(c=2),l.current||(o--,c--),(0,w.jsx)(J,{titleSlot:o>1&&(0,w.jsx)(Pe,{nrSteps:o,atStep:c}),onClose:()=>r(!0),onBack:()=>r(!1),preventDefaultClose:!0,children:a?(0,w.jsxs)(w.Fragment,{children:[s,"detection"===t&&(0,w.jsx)(tt,{}),"externalization"===t&&(0,w.jsx)(lt,{}),"specific"===t&&(0,w.jsx)(ot,{})]}):(0,w.jsx)(xt,{})})},ft="QHqVFDnSvA0HvBE6X5Ji",yt="NNAfew5cs1pJOizGgvAY",jt=()=>{const{toPreviousView:e,setCurrentView:t}=(0,n.useContext)(ne);return(0,w.jsx)(J,{onBack:()=>{e()},children:(0,w.jsxs)("div",{className:ft,children:[(0,w.jsx)(B.l,{size:"xlarge",semanticColor:"textBase"}),(0,w.jsxs)("div",{className:yt,children:[(0,w.jsx)(s.x,{variant:"titleSmall",semanticColor:"textBase",children:"Something went wrong"}),(0,w.jsx)(s.x,{variant:"bodySmall",semanticColor:"textSubdued",children:"We couldn’t turn on your headphone tools."})]}),(0,w.jsx)(Ae.D,{colorSet:"invertedLight",size:"medium",onClick:()=>{t(ee.Overview)},children:"Retry"})]})})};var St=i(8824),Ht=i(65432),wt=i(52438),Nt=i(97345),Et=i(94260);const _t=e=>{let{device:t,onClick:i}=e;return(0,w.jsx)(E.w,{variant:"naked",size:"md",id:t.id,title:(0,w.jsx)(Nt.g,{onClick:()=>{i(t)},children:t.model}),subtitle:t.brand,trailing:(0,w.jsx)(Et.V,{size:"small",semanticColor:"textSubdued"}),isRedundantOnClick:!0,onClick:()=>{i(t)}},t.id)};i(75930);const kt="hPzDNLh2VHVetpMYUWhh",At="OWzwomCJ96sclkARJ4MT",It="ixg1HpUqNVD6i3sodyVM",Mt="D7_plcRuh6XZ4e92bHRf",Lt="Df8qBgxamgAzXiwF9WjI",Dt="ldOw2XsBvAI5g3JI6zWk",Ot="xCjuBeXCCAIL4i_xHXFD",Bt=e=>{let{search:t}=e;return(0,w.jsxs)("div",{className:Ot,children:[(0,w.jsx)(s.x,{semanticColor:"textBase",variant:"titleSmall",children:`Couldn’t find “${t}”`}),(0,w.jsx)(s.x,{semanticColor:"textSubdued",variant:"bodySmall",children:"Try searching again using a different spelling or keyword."})]})},Ft={id:"unknown_device",brand:"",model:"",deviceName:"Unknown"},Tt=e=>{let{devices:t,transitions:i,setCurrentView:a}=e;const{filter:r,setFilter:s}=(0,n.useContext)(Ht.fo),{setCurrentDevice:l}=at(),o=(0,n.useCallback)((e=>{l(e),a(i.continue),s("")}),[l,a,s,i.continue]),c=t.filter((e=>e.deviceName.toLowerCase().includes(r.toLowerCase())));return(0,w.jsxs)("div",{className:Lt,children:[c.map((e=>(0,w.jsx)(_t,{device:e,onClick:o},e.id))),0===c.length&&(0,w.jsx)(Bt,{search:r}),(0,w.jsx)("div",{className:Mt,children:(0,w.jsx)(wt.P,{size:"small",onClick:()=>{o(Ft)},children:"I don't see my headphones"})})]})},Vt=()=>{const{setCurrentView:e,toPreviousView:t,viewTransitions:i,viewOptions:a}=(0,n.useContext)(ne),r=i[ee.ManualSelection],{data:l}=(()=>{const e=(0,Ge.f)(),{data:t,isLoading:i,isError:n}=(0,ye.a)({queryKey:["puffin-devices"],queryFn:async()=>await e.getDevices(),gcTime:18e5,staleTime:6e5});return{data:t??null,loading:i,error:n}})(),{triggerDialog:o,dialog:c}=Ct();return(0,w.jsxs)(J,{onBack:()=>{null!=a&&a.showDialogOnBack?o():t()},children:[c,(0,w.jsxs)(Ht.hz,{uri:"spotify:internal:bettersound",children:[(0,w.jsxs)("div",{className:At,children:[(0,w.jsxs)("div",{className:It,children:[(0,w.jsx)(s.x,{variant:"bodyMediumBold",semanticColor:"textBase",children:"Find brand and exact model"}),(0,w.jsx)(s.x,{variant:"bodySmall",children:"Headphone tools work best when you select an exact match."})]}),(0,w.jsx)(St.K,{placeholder:"Search for brand or model",alwaysExpanded:!0,fullWidth:!0,debounceFilterChangeTimeout:0})]}),l?(0,w.jsx)("div",{className:kt,children:(0,w.jsx)(Tt,{devices:l,transitions:r,setCurrentView:e})}):(0,w.jsx)("div",{className:Dt,children:(0,w.jsx)(Xe.H,{})})]})]})},Rt="UcDa2y41UOzWUqXjcx_B",zt="rR61D1vJxNsSk_XQNMX4",Pt="m7gWknJdcwkdw8mcSQvg",Ut=e=>{let{quality:t}=e;const i=K(t),n=[c.M4.VERY_HIGH,c.M4.HIGH,c.M4.NORMAL,c.M4.LOW];t===c.M4.HIFI24?n.unshift(c.M4.HIFI24):n.unshift(c.M4.HIFI);const a=t===c.M4.UNKNOWN?"textBase":"textBrightAccent";return(0,w.jsxs)(S.x,{variant:"tinted",className:Rt,children:[(0,w.jsx)(E.w,{id:"quality",size:"lg",pretitle:"Current quality",title:(0,w.jsx)(s.x,{variant:"titleSmall",semanticColor:a,children:i.title}),paddingInlineStart:"0px",paddingInlineEnd:"0px",variant:"naked"}),(0,w.jsx)("div",{children:n.map(((e,i)=>{const n=K(e),a=e===t,l=a?"textBrightAccent":"textSubdued";return(0,w.jsx)(E.w,{id:n.title,size:"sm",paddingInlineStart:"0px",paddingInlineEnd:"0px",media:(0,w.jsx)("div",{className:r()(zt,{[Pt]:a})}),title:(0,w.jsx)(s.x,{semanticColor:l,children:n.title}),trailing:(0,w.jsx)(s.x,{semanticColor:l,children:n.bitrateLabel}),variant:"naked"},i)}))})]})};var Zt=i(26368);const Gt=e=>{let{onClick:t}=e;const{bitrateLevel:i}=j(),n=i===c.M4.HIFI||c.M4.HIFI24;return(0,w.jsx)(E.w,{id:"aboutLossless",variant:"naked",title:n?"About Lossless":"How to listen in Lossless",leading:(0,w.jsx)(Zt.Z,{size:"small",semanticColor:n?"textBrightAccent":"textWarning"}),onClick:t,padding:"0px 12px"})};var Wt=i(767);const qt=e=>{let{onClick:t}=e;const i=fe(),[{data:n}]=we(i.quality.streamingQuality);if(void 0===n)return null;const{title:a}=Ne(n);return(0,w.jsx)(E.w,{id:"qualitySetting",variant:"naked",title:D.ag.get("desktop.settings.streamingQuality"),leading:(0,w.jsx)(Wt.E,{size:"small"}),subtitle:a,onClick:t,padding:"0px 12px"})},Qt=e=>{let{onSettings:t,onDetails:i}=e;const{bitrateLevel:n}=j();return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(Ut,{quality:n}),(0,w.jsx)(Gt,{onClick:i}),(0,w.jsx)(qt,{onClick:t})]})};var Kt=i(18517),Yt=i(16941),Xt=i(17676);const Jt=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=Qe(),{activeDevice:i}=(0,l.B)((e=>({activeDevice:e.activeDevice})));let n=null;return t?n=t.transportType===Ke.Fl.TRANSPORT_TYPE_BLUETOOTH?t.name:"Wired Connection":!e&&i&&(n=i.isLocal?D.ag.get("web-player.connect.device-picker.this-computer"):i.name),n},$t=()=>{const e=Jt();return e?(0,w.jsx)(s.x,{variant:"titleSmall",semanticColor:"textBase",children:e}):null},ei=e=>{let{isError:t}=e;return t?(0,w.jsx)(E.w,{id:"filterError",variant:"tinted",paddingBlockStart:"12px",paddingBlockEnd:"12px",paddingInlineStart:"16px",paddingInlineEnd:"16px",leading:(0,w.jsx)(B.l,{semanticColor:"textSubdued",size:"small"}),title:"Sorry, this is unavailable. Try reconnecting your headphones."}):null},ti="XdRXn03t5BJZ3PT5elBo",ii="nYCK_YoWW2PD8dZ2wW8m",ni="UNs86HBsi2znq4noJ4R_",ai="mVvvhBvCvKpGkXj2iBOE",ri="XuO5zqsxmXxWGN4ewmbR",si="akOXhXhi7WpVAH3Hpggp",li=e=>{let{currentDeviceState:t}=e;const i=(0,n.useCallback)((()=>{var e;null===(e=t.toggleTuneHeadphones)||void 0===e||e.call(t)}),[t]),a=(0,n.useCallback)((()=>{var e;null===(e=t.toggleTuneStudio)||void 0===e||e.call(t)}),[t]),r=null!==t.toggleTuneHeadphones,s=t.contentRestrictions.externalizationRestricted,l=!!t.device&&!s;return(0,w.jsxs)("div",{className:ai,children:[(r||t.contentRestrictions.specificRestricted)&&(0,w.jsx)(E.w,{variant:"naked",size:"md",id:"headphones",className:ri,disabled:t.contentRestrictions.specificRestricted,title:(0,w.jsx)(Nt.g,{className:si,children:"Optimize"}),subtitle:"Fine-tune your headphones",trailing:(0,w.jsx)(de.Z,{id:"headphoneTunes",onSelected:i,disabled:t.contentRestrictions.specificRestricted,value:t.currentState.specificEnabled,condensed:!0})}),(0,w.jsx)(E.w,{variant:"naked",size:"md",id:"studio",className:ri,title:(0,w.jsx)(Nt.g,{className:si,children:"Spatialize"}),subtitle:s?"Unavailable for this content":"Broaden your sound",disabled:!l,trailing:(0,w.jsx)(de.Z,{id:"externalization",onSelected:a,disabled:!l,value:t.currentState.externalizationEnabled,condensed:!0})})]})},oi=()=>{var e;const{setCurrentView:t,viewTransitions:i}=(0,n.useContext)(ne),a=i[ee.Overview],{deviceFilterState:r}=et(),l=r.isOnboarded;return(0,w.jsx)(E.w,{id:"listeningWith",variant:"tinted",pretitle:"Model",horizontalGap:"0px",paddingBlockStart:"12px",paddingBlockEnd:"12px",paddingInlineStart:"16px",paddingInlineEnd:"16px",trailing:(0,w.jsx)(wt.P,{size:"small",onClick:()=>{t(a.selectManually)},children:(0,w.jsx)(s.x,{variant:"bodySmallBold",children:"Change model"})}),footer:l&&(0,w.jsx)(li,{currentDeviceState:r}),title:(null===(e=r.device)||void 0===e?void 0:e.deviceName)??"Select your headphone model"})};var ci=i(58997);const di=()=>{const{removeCurrentDevice:e}=at(),{triggerDialog:t,dialog:i}=mt({title:"Forget sound settings?",description:"By confirming, you'll loose the Dirac settings for this device",onConfirm:e});return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(E.w,{id:"qualitySetting",variant:"naked",title:"Reset headphone tools",leading:(0,w.jsx)(ci.F,{size:"small"}),onClick:()=>t(!1),padding:"0px 12px"}),i]})},ui="k4f1o0jOMnxv6OS8dC7p",vi=e=>{let{title:t,subtitle:i,buttonLabel:n,onClick:a}=e;return(0,w.jsx)(E.w,{variant:"naked",size:"lg",id:"getStarted",className:ui,title:t,subtitle:i,paddingBlockStart:"16px",paddingBlockEnd:"16px",footer:(0,w.jsx)(wt.P,{size:"small",onClick:a,children:(0,w.jsx)(s.x,{variant:"bodySmallBold",children:n})})})},gi=()=>{const{setCurrentView:e,viewTransitions:t}=(0,n.useContext)(ne),i=t[ee.Overview],a=(()=>{const e=(0,Kt.W6)(Xt.y$S),t="1"===(0,Yt.m)("is-pigeon");return e&&t})(),{deviceFilterState:r,isError:s,isLoading:l}=et(),o=Qe(),c=r.isOnboarded,d=o&&!r.isOnboarded,[u]=Me(),v=(0,n.useCallback)((()=>{r.device?e(i.getStarted):e(i.selectManually,{showDialogOnBack:!0})}),[r.device,e,i.getStarted,i.selectManually]);return(0,w.jsx)(J,{children:(0,w.jsxs)("div",{className:ti,children:[(0,w.jsx)($t,{}),(0,w.jsx)("div",{className:ii,children:s||l?(0,w.jsx)(ei,{isError:s}):(0,w.jsxs)(w.Fragment,{children:[c&&(0,w.jsx)(oi,{}),d&&(0,w.jsx)(vi,{title:"Enhance your headphones",subtitle:"Use patented technology to improve your headphones’ performance. ",buttonLabel:"Set up",onClick:v})]})}),a&&(0,w.jsxs)("div",{className:ni,children:[!u&&(0,w.jsx)(vi,{title:"Lose yourself in Lossless audio",subtitle:"Stream in up to 24-bit on any compatible device.",buttonLabel:"Take a tour",onClick:()=>e(i.onboardHifi)}),(0,w.jsx)(Qt,{onSettings:()=>{e(i.settings)},onDetails:()=>{e(i.details)}})]}),c&&(0,w.jsx)(di,{})]})})};var xi=i(13481),hi=i(58800);const pi="mRZxP51i40ow4s1NHWLQ",mi="KblagRGVFNw3gchTTRNk",Ci=()=>{const{currentView:e}=(0,n.useContext)(ne);switch(e){case ee.ActivationDetection:return(0,w.jsx)(bt,{type:"detection"});case ee.ActivationExternalization:return(0,w.jsx)(bt,{type:"externalization"});case ee.ActivationSpecific:return(0,w.jsx)(bt,{type:"specific"});case ee.Error:return(0,w.jsx)(jt,{});case ee.ManualSelection:return(0,w.jsx)(Vt,{});case ee.Overview:return(0,w.jsx)(gi,{});case ee.AudioQualitySettings:return(0,w.jsx)(_e,{});case ee.AudioQualityDetails:return(0,w.jsx)(oe,{});case ee.DiscoverHifi:return(0,w.jsx)(Ze,{});default:return(0,ke._)(e),null}},bi=()=>{const{currentView:e}=(0,n.useContext)(ne),t=(0,pt.hv)(),i=[ee.ActivationDetection,ee.ActivationExternalization,ee.ActivationSpecific,ee.DiscoverHifi].includes(e),a=[ee.ActivationDetection,ee.ActivationExternalization,ee.ActivationSpecific,ee.ManualSelection].includes(e);return(0,n.useEffect)((()=>{t(a?$.rZ.PUFFIN_START_ACTIVATION:$.rZ.PUFFIN_FINISH_ACTIVATION)}),[t,a]),(0,w.jsx)(hi.K,{className:r()({[mi]:i}),children:(0,w.jsxs)("div",{className:pi,children:[(0,w.jsx)(Ci,{}),false]})})},fi=()=>(0,w.jsx)(xi.l,{label:"Puffin",children:(0,w.jsx)(ae,{children:(0,w.jsx)(bi,{})})});var yi=i(71354),ji=i(78171),Si=i(27782),Hi=i(91731);const wi="lQazeor2VZZkCA3YXIhP",Ni="SO3L1795AEEiylsvaA3X",Ei=e=>{let{onHide:t}=e;const i=(0,pt.hv)();return(0,w.jsxs)("div",{className:Ni,children:[(0,w.jsx)(s.x,{variant:"bodyMedium",children:"Enhance these headphones?"}),(0,w.jsx)(Ye.o,{semanticColor:"textBrightAccent",onClick:()=>{i($.rZ.PUFFIN_START_ACTIVATION)},condensedAll:!0,size:"small",children:"Set up"}),(0,w.jsx)(Ye.o,{semanticColor:"textSubdued",onClick:t,condensedAll:!0,size:"small",children:"Not now"})]})},_i=()=>{const e=Jt(!0);return(0,w.jsx)("div",{className:Ni,children:(0,w.jsx)(s.x,{variant:"bodyMedium",children:`Optimized for ${e}`})})},ki=()=>(0,w.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"110",height:"24",viewBox:"0 0 110 24",fill:"none",children:[(0,w.jsx)("g",{clipPath:"url(#clip0_2548_75340)",children:(0,w.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.15734 9.25061C8.85004 8.13001 15.2302 8.34115 19.0985 10.6382C19.6303 10.9549 20.3199 10.7793 20.6363 10.2458C20.9524 9.71333 20.7776 9.02438 20.244 8.70775C15.7911 6.06437 8.74454 5.81575 4.50579 7.10274C3.91237 7.283 3.57803 7.90967 3.75774 8.50285C3.93745 9.09586 4.56443 9.4307 5.15734 9.25061ZM5.72724 12.9502C9.54258 11.7923 14.4602 12.3664 17.6847 14.3488C18.1247 14.6191 18.7003 14.481 18.9717 14.0407C19.2424 13.6014 19.1038 13.0254 18.6638 12.7544C14.9602 10.4784 9.54206 9.83755 5.1838 11.1605C4.68965 11.3109 4.41084 11.8322 4.55976 12.327C4.71006 12.8208 5.23257 13.0996 5.72724 12.9502ZM5.93306 16.4002C10.1104 15.446 13.657 15.8349 16.475 17.5571C16.8275 17.7727 17.2879 17.6619 17.5034 17.3084C17.7191 16.9557 17.6079 16.4949 17.2554 16.2796C14.0923 14.3469 10.1715 13.8972 5.60011 14.9421C5.19677 15.0339 4.94546 15.4352 5.03782 15.8377C5.12966 16.2401 5.53059 16.4923 5.93306 16.4002ZM12 24C5.37285 24 0 18.6277 0 11.9998C0 5.37264 5.37285 0 12 0C18.6277 0 24 5.37264 24 11.9998C24 18.6277 18.6277 24 12 24ZM85.0133 18H87.2078V9.88199H85.0133V18ZM86.1023 5.85599C85.3598 5.85599 84.7493 6.46649 84.7493 7.22549C84.7493 7.95149 85.3598 8.56199 86.1023 8.56199C86.8613 8.56199 87.4553 7.95149 87.4553 7.22549C87.4553 6.46649 86.8613 5.85599 86.1023 5.85599ZM38.712 9.08999L36.666 9.71699C36.5505 9.07349 36.0225 8.06699 34.5375 8.06699C33.432 8.06699 32.706 8.77649 32.706 9.55199C32.706 10.1955 33.1185 10.707 33.9765 10.872L35.61 11.1855C37.7385 11.598 38.877 12.984 38.877 14.634C38.877 16.4325 37.3755 18.2475 34.653 18.2475C31.551 18.2475 30.1815 16.251 30 14.5845L32.112 14.0235C32.211 15.1785 33.0195 16.218 34.6695 16.218C35.8905 16.218 36.567 15.6075 36.567 14.7825C36.567 14.106 36.0555 13.578 35.148 13.3965L33.5145 13.0665C31.65 12.687 30.4455 11.4825 30.4455 9.71699C30.4455 7.63799 32.31 6.05399 34.521 6.05399C37.359 6.05399 38.448 7.76999 38.712 9.08999ZM44.9872 18C44.9542 17.835 44.9212 17.4555 44.9212 17.1255C44.4757 17.8845 43.5352 18.2145 42.6772 18.2145C40.7137 18.2145 39.5917 16.779 39.5917 15.0135V9.88199H41.7862V14.568C41.7862 15.4755 42.2482 16.2015 43.2712 16.2015C44.2447 16.2015 44.8057 15.5415 44.8057 14.601V9.88199H47.0002V16.5315C47.0002 17.1585 47.0497 17.7195 47.0827 18H44.9872ZM48.2744 21.135H50.4689V17.208C50.8649 17.7525 51.6899 18.198 52.8119 18.198C55.1054 18.198 56.6399 16.383 56.6399 13.9245C56.6399 11.5155 55.2704 9.70049 52.8944 9.70049C51.6734 9.70049 50.7659 10.245 50.4029 10.872V9.88199H48.2744V21.135ZM52.4654 11.664C53.5874 11.664 54.4784 12.5055 54.4784 13.941C54.4784 15.393 53.5874 16.2345 52.4654 16.2345C51.3434 16.2345 50.4359 15.3765 50.4359 13.941C50.4359 12.5055 51.3434 11.664 52.4654 11.664ZM62.4857 9.84899V12.06C62.2382 12.0105 62.0237 11.994 61.8257 11.994C60.7037 11.994 59.7302 12.5385 59.7302 14.2875V18H57.5357V9.88199H59.6642V11.0865C60.1592 10.014 61.2812 9.81599 61.9742 9.81599C62.1557 9.81599 62.3207 9.83249 62.4857 9.84899ZM66.5605 11.4165C67.8145 11.4165 68.3425 12.2085 68.3755 13.017H64.7455C64.795 12.2745 65.422 11.4165 66.5605 11.4165ZM70.4215 15.6735L68.59 15.129C68.326 15.855 67.765 16.3665 66.742 16.3665C65.653 16.3665 64.7455 15.591 64.696 14.5185H70.504C70.504 14.5104 70.506 14.4845 70.509 14.4454C70.5182 14.3248 70.537 14.0787 70.537 13.842C70.537 11.235 69.0355 9.63449 66.5275 9.63449C64.4485 9.63449 62.5345 11.3175 62.5345 13.908C62.5345 16.647 64.498 18.2475 66.7255 18.2475C68.722 18.2475 70.009 17.076 70.4215 15.6735ZM73.6282 18H71.4337V9.88199H73.5292V10.872C73.9747 10.08 75.0142 9.65099 75.9052 9.65099C77.0107 9.65099 77.9017 10.1295 78.3142 11.004C78.9577 10.014 79.8157 9.65099 80.8882 9.65099C82.3897 9.65099 83.8252 10.5585 83.8252 12.7365V18H81.6967V13.182C81.6967 12.3075 81.2677 11.6475 80.2612 11.6475C79.3207 11.6475 78.7597 12.3735 78.7597 13.248V18H76.5817V13.182C76.5817 12.3075 76.1362 11.6475 75.1462 11.6475C74.1892 11.6475 73.6282 12.357 73.6282 13.248V18ZM93.7872 18C93.7542 17.835 93.7212 17.4555 93.7212 17.1255C93.2757 17.8845 92.3352 18.2145 91.4772 18.2145C89.5137 18.2145 88.3917 16.779 88.3917 15.0135V9.88199H90.5862V14.568C90.5862 15.4755 91.0482 16.2015 92.0712 16.2015C93.0447 16.2015 93.6057 15.5415 93.6057 14.601V9.88199H95.8002V16.5315C95.8002 17.1585 95.8497 17.7195 95.8827 18H93.7872ZM97.0744 18H99.2689V13.248C99.2689 12.357 99.8299 11.6475 100.787 11.6475C101.777 11.6475 102.222 12.3075 102.222 13.182V18H104.4V13.248C104.4 12.3735 104.961 11.6475 105.902 11.6475C106.908 11.6475 107.337 12.3075 107.337 13.182V18H109.466V12.7365C109.466 10.5585 108.03 9.65099 106.529 9.65099C105.456 9.65099 104.598 10.014 103.955 11.004C103.542 10.1295 102.651 9.65099 101.546 9.65099C100.655 9.65099 99.6154 10.08 99.1699 10.872V9.88199H97.0744V18Z",fill:"black",fillOpacity:"0.9"})}),(0,w.jsx)("defs",{children:(0,w.jsx)("clipPath",{id:"clip0_2548_75340",children:(0,w.jsx)("rect",{width:"110",height:"24",fill:"white"})})})]}),Ai=e=>{let{message:t}=e;return(0,w.jsxs)("div",{className:wi,children:[(0,w.jsx)(ki,{}),(0,w.jsx)(s.x,{variant:"bodyMedium",children:t})]})},Ii=e=>{let{hasDevice:t}=e;const{isPlayingRemotely:i}=(0,Je.H)();return i?(0,w.jsx)(Ai,{message:"Your enhanced listening"}):t?(0,w.jsx)(Ai,{message:"Control your new headphone tools"}):(0,w.jsx)(Ai,{message:"Control your Lossless listening"})},Mi=e=>{let{state:t,hasDevice:i,onHide:n}=e;switch(t){case"detection":return(0,w.jsx)(Ei,{onHide:n});case"initial":return(0,w.jsx)(Ii,{hasDevice:i});case"filters_applied":return(0,w.jsx)(_i,{});default:(0,ke._)(t)}return null};var Li=i(32636);const Di="lUMd22gkllxoPeSGTbLy",Oi=$.rZ.PUFFIN_BUTTON_CLICK,Bi=()=>{const{isActive:e,panelSend:t}=(0,$.Wy)(X.s.Puffin),[i,a]=(0,n.useState)("none"),[r,s]=(0,Ie.z)("onboarding-dismissed:puffin",!1),l=(0,pt.aT)(Oi),{deviceFilterState:o}=et(),c=!!Qe(),d=o.currentState.externalizationEnabled||o.currentState.specificEnabled,u=(0,Ge.f)().getSavedDevices().length>0;qe((t=>{let{data:{deviceFilterState:i}}=t;e||null===i||(r&&!i.isOnboarded?a("detection"):(i.currentState.externalizationEnabled||i.currentState.specificEnabled)&&a("filters_applied"))}));const v=(0,n.useCallback)((()=>{a("none")}),[]);(0,n.useEffect)((()=>{const e=setTimeout(v,5e3);return()=>clearTimeout(e)}),[v,i]),(0,n.useEffect)((()=>{u||r||a("initial")}),[u,r,e,v,s]),(0,n.useEffect)((()=>{!e&&c||(v(),s(!0))}),[v,e,s,c]);const g=d?yi.Q:ji.F;return(0,w.jsx)(Si.x,{placement:"topStart",hideCloseButton:!0,overlay:"none"!==i&&(0,w.jsx)(Hi.J,{role:"alertdialog",arrow:"bottomEnd",colorSet:"invertedLight",className:Di,onClose:v,children:(0,w.jsx)(Mi,{state:i,hasDevice:c,onHide:v})}),children:(0,w.jsx)(Li.C,{isActive:e,isActiveNoIndicator:d||c,onToggle:()=>{t(Oi)},label:"Music Room",icon:g,disabled:!l})})};if(!["development","test"].includes("production")&&!{}.ENABLE_PUFFIN)throw new Error("Puffin can only be imported in development")},16095:(e,t,i)=>{i.d(t,{A:()=>r,s:()=>a});var n=i(84469);let a=function(e){return e.UPDATE="update",e.DEVICE_CONNECTED="deviceConnected",e}({});class r extends n.r{}}}]);
//# sourceMappingURL=xpui-puffin.65932064.js.map