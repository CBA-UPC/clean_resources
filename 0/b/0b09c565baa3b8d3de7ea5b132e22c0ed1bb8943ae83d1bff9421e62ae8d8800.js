"use strict";(window.webpackChunkNRBA=window.webpackChunkNRBA||[]).push([[78],{2573:(t,e,s)=>{s.d(e,{o:()=>d});var i=s(4247),n=s(1117),r=s(8673),a=s(8310),o=s(5763),h=s(3860);class d extends n.w{constructor(t,e,s){super(s),this.endpoint=t,this.opts=e||{},this.started=!1,this.timeoutHandle=null,this.aborted=!1,this.harvest=new r.M(this.sharedContext),(0,a.L)(this.unload.bind(this),(0,o.Mt)(this.sharedContext.agentIdentifier,"allow_bfcache")),this.sharedContext?.ee.on(h.wO.RESET,(()=>this.runHarvest({forceNoRetry:!0})))}unload(){this.aborted||(this.opts.onUnload&&this.opts.onUnload(),this.runHarvest({unload:!0}))}startTimer(t,e){this.interval=t,this.started=!0,this.scheduleHarvest(null!=e?e:this.interval)}stopTimer(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.aborted=t,this.started=!1,this.timeoutHandle&&clearTimeout(this.timeoutHandle)}scheduleHarvest(t,e){this.timeoutHandle||(null==t&&(t=this.interval),this.timeoutHandle=setTimeout((()=>{this.timeoutHandle=null,this.runHarvest(e)}),1e3*t))}runHarvest(t){if(this.aborted)return;const e=e=>{t?.forceNoRetry&&(e.retry=!1),this.onHarvestFinished(t,e)};let s,n,r=[];if(this.opts.getPayload){if(s=i.qD({isFinalHarvest:t?.unload}),!s)return!1;const e=!t?.unload&&s===i.Be;if(n=this.opts.getPayload({retry:e}),!n)return void(this.started&&this.scheduleHarvest());n="[object Array]"===Object.prototype.toString.call(n)?n:[n],r.push(...n)}let a=t=>this.harvest.sendX(t);r.length?a=this.opts.raw?t=>this.harvest._send(t):t=>this.harvest.send(t):r.push(void 0),r.forEach((i=>{a({endpoint:this.endpoint,payload:i,opts:t,submitMethod:s,cbFinished:e,customUrl:this.opts.customUrl,raw:this.opts.raw})})),this.started&&this.scheduleHarvest()}onHarvestFinished(t,e){if(this.opts.onFinished&&this.opts.onFinished(e),e.sent&&e.retry){const s=e.delay||this.opts.retryDelay;this.started&&s?(clearTimeout(this.timeoutHandle),this.timeoutHandle=null,this.scheduleHarvest(s,t)):!this.started&&s&&this.scheduleHarvest(s,t)}}}},8310:(t,e,s)=>{s.d(e,{L:()=>o});var i=s(3239),n=s(7872),r=s(385),a=s(7956);if(r.v6){r._A.cleanupTasks=[];const t=r._A.close;r._A.close=()=>{for(let t of r._A.cleanupTasks)t();t()}}function o(t,e){if(r.il)if(e)(0,a.N)(t,!0),(0,i.bP)("pagehide",t);else{var s=(0,n.Z)(t);!r.IF||navigator.sendBeacon?(0,i.bP)("pagehide",s):(0,i.bP)("beforeunload",s),(0,i.bP)("unload",s)}else r.v6&&r._A.cleanupTasks.push(t)}},1832:(t,e,s)=>{s.r(e),s.d(e,{Aggregate:()=>v});var i=s(1284),n=s(4351),r=s(4322),a=s(2573),o=s(4222),h=s(5763),d=s(4649),u=s(8e3),l=s(385),c=s(2222);class v extends c.m{static featureName=d.t;constructor(t,e){var s;super(t,e,d.t),s=this,this.eventsPerMinute=240,this.harvestTimeSeconds=(0,h.Mt)(this.agentIdentifier,"page_action.harvestTimeSeconds")||(0,h.Mt)(this.agentIdentifier,"ins.harvestTimeSeconds")||30,this.eventsPerHarvest=this.eventsPerMinute*this.harvestTimeSeconds/60,this.referrerUrl,this.currentEvents,this.events=[],this.att=(0,h.C5)(this.agentIdentifier).jsAttributes,l.il&&document.referrer&&(this.referrerUrl=(0,o.f)(document.referrer)),(0,r.X)("api-addPageAction",(function(){return s.addPageAction(...arguments)}),this.featureName,this.ee);var i=new a.o("ins",{onFinished:function(){return s.onHarvestFinished(...arguments)}},this);i.harvest.on("ins",(function(){return s.onHarvestStarted(...arguments)})),this.ee.on("drain-".concat(this.featureName),(()=>{this.blocked||i.startTimer(this.harvestTimeSeconds,0)})),(0,r.X)("block-ins",(()=>{this.blocked=!0,i.stopTimer(!0)}),this.featureName,this.ee),(0,u.L)(this.agentIdentifier,this.featureName)}onHarvestStarted(t){const{userAttributes:e,atts:s}=(0,h.C5)(this.agentIdentifier);var i={qs:{ua:e,at:s},body:{ins:this.events}};return t.retry&&(this.currentEvents=this.events),this.events=[],i}onHarvestFinished(t){t&&t.sent&&t.retry&&this.currentEvents&&(this.events=this.events.concat(this.currentEvents),this.currentEvents=null)}addPageAction(t,e,s){if(!(this.events.length>=this.eventsPerHarvest||this.blocked)){var r,a,d={};l.il&&window.document.documentElement&&(r=window.document.documentElement.clientWidth,a=window.document.documentElement.clientHeight);var u={timestamp:t+(0,h.OP)(this.agentIdentifier).offset,timeSinceLoad:t/1e3,browserWidth:r,browserHeight:a,referrerUrl:this.referrerUrl,currentUrl:(0,o.f)(""+location),pageUrl:(0,o.f)((0,h.OP)(this.agentIdentifier).origin),eventType:"PageAction"};(0,i.D)(u,c),(0,i.D)((0,h.C5)(this.agentIdentifier).jsAttributes,c),s&&"object"==typeof s&&(0,i.D)(s,c),d.actionName=e||"",this.events.push(d)}function c(t,e){d[t]=e&&"object"==typeof e?(0,n.P)(e):e}}}},4649:(t,e,s)=>{s.d(e,{t:()=>i});const i=s(3325).D.pageAction}}]);