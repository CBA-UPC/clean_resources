(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[598],{"01Cu":function(e,t,r){"use strict";r.r(t),r.d(t,"SearchPreloadModuleNgFactory",(function(){return je}));var i=r("keVe"),n=r("QjXU"),o=r("O4I2"),a=r("mXGw"),s=r.n(a),c=r("3g20"),l=r("BaAg"),u=r("7Rc8"),p=r("kpuN"),h=r("6nG3"),d=r("OWzB"),g=r("W3Zz"),S=r("hZW2"),v=r("Z0U4"),m=r("n826"),f=r("5aVq"),C=r("w1PR"),b=r("TIi1"),y=r("BMb5"),T=r("hoyd"),k=r("4/We"),P=r("cgnd"),w=r("LQqy"),x=r("/I02"),I=r("PBJH"),_=r("JH4S"),M=r("BMc1"),L=r("eda8"),D=r("3anA"),E=r("A/um"),A=function(){function e(e,t){this.locService=e,this.searchConfigService=t}return e.prototype.getCommercialAppList=function(){return this.commercialApps},e.prototype.initializeCommericalAppList=function(e){var t=[{AppName:this.searchConfigService.config.resources.BrandVisio,IconUnicodeCodepointCssClass:this.getBaseCSSClass()+" "+D.a.getCssClass(E.a.Visio),Referral:"VisioOnline",Title:this.locService.format(this.searchConfigService.config.resources.SearchSuggestionGetAppForBusinessText,this.searchConfigService.config.resources.BrandVisio),Url:"https://www.microsoft.com/microsoft-365/visio/flowchart-software"},{AppName:this.searchConfigService.config.resources.BrandPowerBI,IconUnicodeCodepointCssClass:this.getBaseCSSClass()+" "+D.a.getCssClass(E.a.PowerBI),Referral:"PowerBi",Title:this.locService.format(this.searchConfigService.config.resources.SearchSuggestionGetAppForBusinessText,this.searchConfigService.config.resources.BrandPowerBI),Url:"https://powerbi.microsoft.com"},{AppName:this.searchConfigService.config.resources.BrandPublisher,IconUnicodeCodepointCssClass:this.getBaseCSSClass()+" "+D.a.getCssClass(E.a.Publisher),Referral:"Publisher",Title:this.locService.format(this.searchConfigService.config.resources.SearchSuggestionGetAppForBusinessText,this.searchConfigService.config.resources.BrandPublisher),Url:"https://www.microsoft.com/microsoft-365/publisher"},{AppName:this.searchConfigService.config.resources.BrandAccess,IconUnicodeCodepointCssClass:this.getBaseCSSClass()+" "+D.a.getCssClass(E.a.Access),Referral:"Access",Title:this.locService.format(this.searchConfigService.config.resources.SearchSuggestionGetAppForBusinessText,this.searchConfigService.config.resources.BrandAccess),Url:"https://www.microsoft.com/microsoft-365/access"},{AppName:this.searchConfigService.config.resources.BrandSharePoint,IconUnicodeCodepointCssClass:this.getBaseCSSClass()+" "+D.a.getCssClass(E.a.SharePoint),Referral:"SharePoint",Title:this.locService.format(this.searchConfigService.config.resources.SearchSuggestionGetAppForBusinessText,this.searchConfigService.config.resources.BrandSharePoint),Url:"https://www.microsoft.com/microsoft-365/sharepoint/collaboration"},{AppName:this.searchConfigService.config.resources.BrandHighLander,IconUnicodeCodepointCssClass:this.getBaseCSSClass()+" "+D.a.getCssClass(E.a.HighLander),Referral:"HighLander",Title:this.locService.format(this.searchConfigService.config.resources.SearchSuggestionGetAppForBusinessText,this.searchConfigService.config.resources.BrandHighLander),Url:"https://www.microsoft.com/microsoft-365/business/task-management-software"},{AppName:this.searchConfigService.config.resources.BrandProject,IconUnicodeCodepointCssClass:this.getBaseCSSClass()+" "+D.a.getCssClass(E.a.Project),Referral:"Project",Title:this.locService.format(this.searchConfigService.config.resources.SearchSuggestionGetAppForBusinessText,this.searchConfigService.config.resources.BrandProject),Url:"https://www.microsoft.com/microsoft-365/project/project-management-software"},{AppName:this.searchConfigService.config.resources.BrandSkypeForBusiness,IconUnicodeCodepointCssClass:this.getBaseCSSClass()+" "+D.a.getCssClass(E.a.SkypeForBusiness),Referral:"SkypeForBusiness",Title:this.locService.format(this.searchConfigService.config.resources.SearchSuggestionGetAppForBusinessText,this.searchConfigService.config.resources.BrandSkypeForBusiness),Url:"https://www.microsoft.com/microsoft-365/skype-for-business/download-app"},{AppName:this.searchConfigService.config.resources.BrandStream,IconUnicodeCodepointCssClass:this.getBaseCSSClass()+" "+D.a.getCssClass(E.a.Stream),Referral:"MicrosoftStream",Title:this.locService.format(this.searchConfigService.config.resources.SearchSuggestionGetAppForBusinessText,this.searchConfigService.config.resources.BrandStream),Url:"https://www.microsoft.com/microsoft-365/microsoft-stream"}],r=[];t.forEach((function(t){for(var i=!1,n=0;n<e.length;n++)if(e[n].Title&&e[n].Title===t.Referral){i=!0;break}i||r.push(t)})),this.commercialApps=r},e.prototype.getBaseCSSClass=function(){return D.a.SvgIconCssClass+" "+D.a.FluentIconCssClass},e.ɵprov=i.kc({factory:function(){return new e(i.lc(I.a),i.lc(c.a))},token:e,providedIn:"root"}),e}(),U=function()return e.prototype.initializeSettingList=function(e){var t=this;this.homePageLearnings=[{displayText:this.locService.format(this.searchConfigService.config.resources.SearchSuggestionLearningButtonText1,this.searchConfigService.config.resources.SearchSuggestionLearningContentText3),onClick:function(){return e.Search.SetSearchText(t.searchConfigService.config.resources.SearchSuggestionLearningContentText3)}}],this.wordPageLearnings=[{displayText:this.locService.format(this.searchConfigService.config.resources.SearchSuggestionLearningButtonText1,this.searchConfigService.config.resources.SearchSuggestionLearningContentText3),onClick:function(){return e.Search.SetSearchText(t.searchConfigService.config.resources.SearchSuggestionLearningContentText3)}}],this.excelLearnings=[{displayText:this.locService.format(this.searchConfigService.config.resources.SearchSuggestionLearningButtonText1,this.searchConfigService.config.resources.SearchSuggestionLearningContentText1),onClick:function(){return e.Search.SetSearchText(t.searchConfigService.config.resources.SearchSuggestionLearningContentText1)}}],this.powerPointLearnings=[{displayText:this.locService.format(this.searchConfigService.config.resources.SearchSuggestionLearningButtonText1,this.searchConfigService.config.resources.SearchSuggestionLearningContentText2),onClick}]},e.prototype.getLearningList=function(e){switch(e){case l.b.Word:return this.wordPageLearnings;case l.b.Excel:return this.excelLearnings;case l.b.PowerPoint:return this.powerPointLearnings;default:return this.homePageLearnings}},e.ɵprov=i.kc({factor},token:e,providedIn:"root"}),e}(),O=function(}return e.prototype.getSettingLis},e.prototype.initializeSettingList=function(){this.settings=[{IconUnicodeCodepointCssClass:this.getBaseCSSClass()+" "+D.a.getCssClass(E.a.PlayerSettings),RelatedSearchQueries:["account","my account","my profile","change password","update password","password","setting"],Title:this.searchConfigService.config.resources.SettingSearchMyAccountText,Url:"https://account.microsoft.com"},{IconUnicodeCodepointCssClass:this.getBaseCSSClass()+" "+D.a.getCssClass(E.a.Devices3),RelatedSearchQueries:["device","manage devices","my device"],Title:this.searchConfigService.config.resources.SettingSearchManageDevicesText,Url:"https://account.microsoft.com/devices/"},{IconUnicodeCodepointCssClass:this.getBaseCSSClass()+" "+D.a.getCssClass(E.a.ContactCardSettings),RelatedSearchQueries:["profile","my profile","picture","my picture","change my email","birthday","country","physical address","language","change language","language settings","change culture","culture"],Title:this.searchConfigService.config.resources.SettingSearchMyProfileText,Url:"https://account.microsoft.com/profile/"},{IconUnicodeCodepointCssClass:this.getBaseCSSClass()+" "+D.a.getCssClass(E.a.Download),RelatedSearchQueries:["get office","install office","install word","install powerpoint","install excel","install outlook","download office"],Title:this.searchConfigService.config.resources.SettingSearchInstallOfficeText,Url:"https://account.microsoft.com/services/office/install"},{IconUnicodeCodepointCssClass:this.getBaseCSSClass()+" "+D.a.getCssClass(E.a.Office2),RelatedSearchQueries:["buy office","subscription","renew","renew subscription"],Title:this.searchConfigService.config.resources.SettingSearchBuyOrRenewOfficeText,Url:"https://www.microsoft.com/microsoft-365/buy/microsoft-365-family"},{IconUnicodeCodepointCssClass:this.getBaseCSSClass()+" "+D.a.getCssClass(E.a.GiftCard),RelatedSearchQueries:["redeem gift card","gift code"],Title:this.searchConfigService.config.resources.SettingSearchRedeemGiftCardText,Url:"https://redeem.microsoft.com/"},{IconUnicodeCodepointCssClass:this.getBaseCSSClass()+" "+D.a.getCssClass(E.a.Permissions),RelatedSearchQueries:["renew","product key","key","activate"],Title:this.searchConfigService.config.resources.SettingSearchEnterProductKeyText,Url:"https://setup.office.com"}]},e.prototype.getBaseCSSClas},e.ɵprov=i.kc({facto)},token:e,providedIn:"root"}),e}(),R=r("5Q+n"),B=r("unjt"),N=r("uh00"),F=r("7ZAG"),j=r("zbYf"),H=r("kEzv"),G=r("l3Ry"),W={file:{matchTitle:!0,matchDescription:!0,minLength:1,maxLength:9},files:{matchTitle:!0,matchDescription:!0,minLength:1,maxLength:9},templatePreview:{matchTitle:!0,matchDescription:!1,minLength:1,maxLength:9},help:{matchTitle:!0,matchDescription:!0,minLength:9,maxLength:Number.MAX_VALUE}};function X(e,t,r){var i,o,a,s,c,l,u=Object(F.a)(Object(j.a)(e,(function(e){return e.id})]})),p=(r&&r.searchText).toLowerCase()||"",h={},d=Object(H.a)(e.map((function(e){return e.optimalCount}))),g=0;try{for(var S=Object(n.__values)(t),v=S.next();!v.done;v=S.next()){var m=v.value;h[m.id]=0;var f=u[m.id].optimalCount||Number.MAX_VALUE;g+=f;var C=W[m.id];if(C&&p.length>=C.minLength&&p.length<=C.maxLength){for(var b=Math.min(m.suggestions.length,u[m.id].maxCount||Number.MAX_VALUE,f),y=0;y<b;y++){var T=m.suggestions[y],k=null===(s=(null==T?void 0:T.title)||(null==T?void 0:T.displayName)||(null===(a=null==T?void 0:T.templatePreviewData)||void 0===a?void 0:a.Title))||void 0===s?void 0:s.toLowerCase(),P=null===(l=(null==T?void 0:T.secondaryDisplayText)||(null===(c=null==T?void 0:T.templatePreviewData)||void 0===c?void 0:c.Description))||void 0===l?void 0:l.toLowerCase();C.matchTitle&&k?h[m.id]+=-1!==k.indexOf(p)||-1!==p.indexOf(k)?1:0:C.matchDescription&&P&&(h[m.id]+=-1!==P.indexOf(p)||-1!==p.indexOf(P)?1:0)}h[m.id]>0&&(h[m.id]=h[m.id]/b)}}}catch(e){i={error:e}}finally{try{v&&!v.done&&(o=S.return)&&o.call(S)}finally{if(i)throw i.error}}return e.map((function(e){return e.id})).map((function(e){return Object(G.a)(e}))})).filter((function(e){return e})).slice(0).sor]})).map((function(e){if(!e)return null;var t=e.suggestions.slice(0,Math.min(e.suggestions.length,u[e.id].maxCount||Number.MAX_VALUE,(u[e.id].optimalCount||Number.MAX_VALUE)+(d-g)));return g-=t.length,t?Object(n.__assign)(Object(n.__assign)({},e),{suggestions:t}):null}),[]).filter((function(e){return e}))}var q=r("ZRHl"),Z=r("uTi/"),Q=r("gdDe"),V=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t.prototype.createStream=function(e){var r=[],i=[];return""!==(null==e?void 0:e.trim())&&(r.push({contentLauncherEnabled:t.capabilitiesService.capabilities.contentLauncherEnabled,isPwa:t.capabilitiesService.capabilities.isPwaInUwp,isDarkMode:t.isDarkMode,title:t.getButtonText(e),urlToOpen:t.bingURL+e+t.bingFormCode,searchInstrumentationService:t.searchInstrumentationService,urlLauncherService:t.urlLauncherService}),i.push("Bing")),t.searchInstrumentationService.setRenderedProviderResults("Bing",i),Q.Observable.fromArray(r)},t.prototype.getId=function(){return"bing"},t.bingURL="https://www.bing.com/search?q=",t.bingFormCode="&form=OFFCS1",t}(Z.a),z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t.prototype.createStream=function(r){return t.searchConfigService.config.fastODCFileProviderEnabled&&""!==(null==r?void 0:r.trim())?(t.searchInstrumentationService.setRenderedProviderResults("File",[]),Q.Observable.empty()):e.prototype.createStream.call(this,r)},t.prototype.getId=function(){return"files"},t}(L.a),K=(r("KMtT"),"<b0>"),J="</b0>",Y=K.length,$=J.length,ee=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(e){var r,i;e.currentTarget.blur(),null===(i=(r=t.props).handleClick)||void 0===i||i.call(r,e)},t.handleKeyPress=function(e){"Enter"===e.key?(e.preventDefault(),e.currentTarget.blur(),t.props.handleClick(e)):"ArrowRight"===e.key&&t.props.secondaryButtonProps&&(e.preventDefault(),e.currentTarget.blur(),t.props.secondaryButtonProps.onClick(e))},t.handleSubButtonCli)},t}return Object(n.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props.title.indexOf(K),r=this.props.title.lastIndexOf(J);return s.a.createElement("div",{className:void 0!==this.props.style?"search-compound-button-container "+this.props.style:"search-compound-button-container"},s.a.createElement("a",{href:"#",className:"search-compound-button-container__link",role:this.props.role||"option","data-nav":"true",tabIndex:-1,onClick:function(t){return e.handleClick(t)},onKeyPress:function(t){return e.handleKeyPress(t)},target:this.props.target},!this.props.hideIcon&&s.a.createElement("div",{className:"search-icon"},s.a.createElement("div",{className:"search-icon__container"},this.props.fileTypeNarratorString&&s.a.createElement("span",{className:"Search-icon__container__offScreen"},this.props.fileTypeNarratorString),s.a.createElement("div",{className:this.props.icon+" search-icon--image"}))),s.a.createElement("div",{className:(this.props.isDarkMode?"search-compound-button-container__text--darkMode":"search-compound-button-container__text")+(this.props.useThemeColor?" ms-fcl-tda":"")},t>=0?s.a.createElement("div",{className:"search-buttons-title"},s.a.createElement("span",null,this.props.title.substring(0,t)),s.a.createElement("strong",null,this.props.title.substring(t+Y,r)),s.a.createElement("span",null,this.props.title.substring(r+$))):s.a.createElement("div",{"aria-label":this.props.title+"."},s.a.createElement("div",{className:"search-buttons-title"},this.props.title)),s.a.createElement("div",{className:"search-compound-button-container__text__description"},this.props.description))),this.props.secondaryButtonProps&&s.a.createElement("div",null,s.a.createElement("span",{className:"search-compound-button-wrapper"},s.a.createElement("span",{className:"search-compound-button-wrapper_divider "+(this.props.isDarkMode?"search-compound-button-wrapper_divider--darkMode":"search-compound-button-wrapper_divider--normal")})),s.a.createElement("div",{className:"search-subButton "+(this.props.isDarkMode?"search-subButton--darkMode":"search-subButton--normal"),tabIndex:-1,onClick:function(t){return e.handleSubButtonClick(t)},"aria-label":this.props.secondaryButtonProps.ariaLabel},s.a.createElement("div",null,s.a.createElement("div",{className:this.props.secondaryButtonProps.icon+" search-subButton__icon"})))))},t}(s.a.Component),te=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(e,r){return function(i){i.preventDefault(),t.props.sharedSearchService.setFilesAutosuggestClick(Object(n.__assign)(Object(n.__assign)({},e),{customLoggingFunction:t.logFileAutosuggestClick(r),displayText:e.title+"."+e.fileExtension,url:e.isLocal||void 0===e.webUrl?e.url:e.webUrl,canonicalUrl:e.consumerSearchWdQueryParamsEnabled?void 0:e.url,shortUrl:!e.consumerSearchWdQueryParamsEnabled&&void 0!==e.webUrl}))}},t.logFileAutosuggestClick=function(e){return function(r,i){r&&t.props.searchInstrumentationService.logSearchClickEvent("File","MSA_Auto_Suggest_File",!0,"File",void 0,e,void 0,void 0,i)}},t}return Object(n.__extends)(t,e),t.prototype.render=function(){var e=l.a.fileTypeFromExtension(this.props.fileExtension),r=l.a.referralFromFileType(e);return s.a.createElement(ee,{title:this.props.title,description:this.props.secondaryDisplayText,icon:this.props.iconClass,isDarkMode:Z.a.isDarkMode,isPwa:Z.a.capabilitiesService.capabilities.isPwaInUwp,fileTypeNarratorString:t.createFileTypeStringForNarrator(this.props.fileType)+":",handleClick:this.handleClick(this.props,r),target:"_blank"})},t}(s.a.Component),re=r("hGaZ"),ie=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tellMeServiceEndPoint="https://tellmeservice.osi.office.net/tellmeservice/api/suggestions",t.debounceWaitTime=200,t.maxCharacterLength=256,t.searchTextUsedInVisualTesting=["testing","account","sharepoint"],t}return Object(n.__extends)(t,e),t.prototype.createStream=function(e){var r=this;return""===(null==e?void 0:e.trim())||t.clientStartupConfigService.config.authType!==P.a.MSA&&"Create"!==t.officeRouteService.getCurrentRoute().route?Q.Observable.empty():Q.Observable.create((function(i){return Object(n.__awaiter)(r,void 0,void 0,(function(){var r,o,a,s,c=this;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return Z.a.contextService.sharedContext.inMockMode&&this.searchTextUsedInVisualTesting.includes(e)?(this.getMockedSearchSuggestion(e,i),[3,5]):[3,1];case 1:return e!==t.currentSearchInfo?[3,3]:(r=this.getSearchSuggestion,o=[e],[4,t.suggestionPromise]);case 2:return r.apply(this,o.concat([n.sent(),i])),[3,5];case 3:return t.currentSearchInfo=e,window.clearTimeout(t.debounceTimeoutId),t.debounceTimeoutId=null,a=new Promise((function(r){t.debounceTimeoutId=null,t.debounceTimeoutId=window.setTimeou)}),c.debounceWaitTime)})),t.suggestionPromise=a,[4,a];case 4:s=n.sent(),this.getSearchSuggestion(e,s,i),n.label=5;case 5:return[2]}}))}))}))},t.prototype.createRequestPromise=function(e){e.length>this.maxCharacterLength&&(e=e.substring(0,this.maxCharacterLength));var r=new Map;r.set("Content-Type","application/json"),r.set("Accept","application/json"),r.set("X-Office-Application",t.capabilitiesService.capabilities.isPwaInUwp?"PWAMSA":"OfficeHomeMSA"),r.set("X-Office-Platform","Web"),r.set("X-TellMe-SuggestionTypes","Help,Template"),r.set("X-TellMe-Culture",t.contextService.sharedContext.officeMarket),r.set("X-TellMe-SessionId",t.searchInstrumentationService.getSearchSessionId());var i={url:this.tellMeServiceEndPoint,headers:r},n={Query:e,TemplateInfo:{Application:this.getApplicationList(t.currentRoute.app)}};return t.searchInstrumentedXhrService.sendIntrumentedPostRequest("TellMe_Search_Suggestion_Request","TellMe_Search_Suggestion",this.tellMeServiceEndPoint,n,i)},t.prototype.getApplicationLi}},t}(Z.a),ne=function(t}return Object(n.__extends)(t,e),t.prototype.getId=function(){return"help"},t.prototype.getSearchSuggestion=function(e,r,i){var n,o=r,a=[];try{if(o.Groups&&o.Groups.length>0){for(var s=0;s<o.Groups.length;s++)if("Help"===o.Groups[s].GroupType){n=o.Groups[s].Suggestions;break}if(n)for(var c=0;c<this.maxCount&&c<n.length;c++)i.onNext({id:c.toString(),title:n[c].name,articleId:n[c].id,isPwa:t.capabilitiesService.capabilities.isPwaInUwp,isDarkMode:t.isDarkMode,shellShim:t.shellShim,searchInstrumentationService:t.searchInstrumentationService}),a.push(n[c].id)}}catch(e){i.onCompleted()}t.searchInstrumentationService.setRenderedProviderResults("Help",a),i.onCompleted()},t.prototype.getMockedSearchSuggestion=function(e,r){r.onNext({id:"0",title:"Use a template to create a resume",articleId:"6053fbbb-94d8-471e-9957-49f4e7ab6fb8",isPwa:t.capabilitiesService.capabilities.isPwaInUwp,isDarkMode:t.isDarkMode,shellShim:t.shellShim,searchInstrumentationService:t.searchInstrumentationService}),r.onCompleted()},t}(ie),oe="<b0>",ae="</b0>",se=oe.length,ce=ae.length,le=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleCli)},t.handleKeyPress=function(e){"Enter"===e.key&&(e.preventDefault(),e.currentTarget.blur(),t.props.handleClick(e))},t}return Object(n.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props.title.indexOf(oe),r=this.props.title.lastIndexOf(ae);return s.a.createElement("div",{className:void 0!==this.props.style?"search-button-container "+this.props.style:"search-button-container"},s.a.createElement("a",{href:"#",className:"search-button-container__link",role:"option","data-nav":"true",tabIndex:-1,onClick:function(t){return e.handleClick(t)},target:this.props.target,onKeyPress:function(t){return e.handleKeyPress(t)}},s.a.createElement("div",{className:"search-icon"},s.a.createElement("div",{className:"search-icon__container"},s.a.createElement("div",{className:this.props.icon+" search-icon--image"}))),s.a.createElement("div",{className:this.props.isDarkMode?"search-button-container__text--darkMode":"search-button-container__text"},t>=0?s.a.createElement("div",{className:"search-buttons-title"},s.a.createElement("span",null,this.props.title.substring(0,t)),s.a.createElement("strong",null,this.props.title.substring(t+se,r)),s.a.createElement("span",null,this.props.title.substring(r+ce))):s.a.createElement("div",null,s.a.createElement("div",{className:"search-buttons-title"},this.props.title)))))},t}(s.a.Component),ue=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(){return function(){t.props.shellShim.NFD.OpenHelp(t.props.articleId),t.props.searchInstrumentationService.logSearchClickEvent("Help","MSA_Auto_Suggest_Help",!1,"Help",t.props.articleId,void 0,void 0,t.props.id)}},t}return Object(n.__extends)(t,e),t.prototype.render=function(){return s.a.createElement(le,{title:this.props.title,icon:D.a.SvgIconCssClass+" "+D.a.FluentIconCssClass+" "+D.a.getCssClass(E.a.Question)+(this.props.isDarkMode?" search-Icon--darkMode":""),isDarkMode:this.props.isDarkMode,isPwa:this.props.isPwa,handleClick:this.handleClick(),target:"_self"})},t}(s.a.Component),pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t.prototype.createStream=function(e){var r=t.learnings.getLearningList(t.currentRoute.app),i=Math.floor(Math.random()*r.length);return""===(null==e?void 0:e.trim())&&(void 0===t.shouldShowLearningSuggestions&&(t.shouldShowLearningSuggestions=this.shouldShowLearningSuggestions()),t.shouldShowLearningSuggestions)?Q.Observable.fromArray([{ariaLabel:t.searchConfigService.config.resources.SearchSuggestionLearningAriaLabel,isPwa:t.capabilitiesService.capabilities.isPwaInUwp,isDarkMode:t.isDarkMode,onClick:r[i].onClick,puid:t.clientStartupConfigService.config.puid,searchInstrumentationService:t.searchInstrumentationService,shellShim:t.shellShim,title:r[i].displayText,hideLearningSuggestions:this.hideLearningSuggestions}]):Q.Observable.empty()},t.prototype.getId=function(){return"learning"},t.prototype.hideLearningSuggestio1},t.prototype.shouldShowLearningSuggestions=function(){var e=localStorage.getItem("OfficeDotComConsumerLearningStateObject");return null===e||!JSON.parse(e).includes(t.clientStartupConfigService.config.puid)},t}(Z.a),he=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(e){return function(r){r.preventDefault(),t.props.sharedSearchService.setAppsAutosuggestClick(Object(n.__assign)(Object(n.__assign)({},e),{id:e.id,customLoggingFunction:t.logAppsAutosuggestClick}),r,void 0)}},t.logAppsAutosuggestClick=function(e,r,i){e&&t.props.searchInstrumentationService.logSearchClickEvent("App","MSA_Auto_Suggest_App",i,"App",void 0,t.props.referral?t.props.referral:t.props.title,void 0,void 0,r)},t}return Object(n.__extends)(t,e),t.prototype.render=function(){return s.a.createElement(le,{title:this.props.title,icon:this.props.iconClass+(this.props.isDarkMode?" ms-ohp-Icon--see-more--darkMode":" ms-ohp-Icon--see-more"),isDarkMode:this.props.isDarkMode,isPwa:this.props.isPwa,handleClick:this.handleClick(this.props),target:"_blank"})},t}(s.a.Component),de=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(){return function(e){e.preventDefault(),t.props.contentLauncherEnabled?Promise.all([r.e(0),r.e(1),r.e(2),r.e(3),r.e(4),r.e(33)]).then(r.bind(null,"DZQ9")).then((function(e){e.launchUrl(t.props.urlToOpen,{action:"OpenAutosuggestBing"}).then((function(){t.props.searchInstrumentationService.logSearchClickEvent("Bing","MSA_Auto_Suggest_Bing",!0,"Bing")}))})):t.props.urlLauncherService.openUrl(t.props.urlToOpen,"OpenAutosuggestBing").then((function(){t.props.searchInstrumentationService.logSearchClickEvent("Bing","MSA_Auto_Suggest_Bing",!0,"Bing")}))}},t}return Object(n.__extends)(t,e),t.prototype.render=function(){var e=D.a.FluentIconCssClass,t=D.a.SvgIconCssClass;return s.a.createElement(ee,{title:this.props.title,handleClick:this.handleClick(),icon:t+" "+e+"  ms-Icon--BingLogo"+(this.props.isDarkMode?" ms-ohp-Icon--see-more--darkMode":" ms-ohp-Icon--see-more"),description:"",style:this.props.isDarkMode?"search-compound-button-container--see-more--darkMode":"search-compound-button-container--see-more",target:"_blank",isDarkMode:this.props.isDarkMode,isPwa:this.props.isPwa,role:"button"})},t}(s.a.Component),ge=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(){return function(e){e.preventDefault(),t.props.contentLauncherEnabled?Promise.all([r.e(0),r.e(1),r.e(2),r.e(3),r.e(4),r.e(33)]).then(r.bind(null,"DZQ9")).then((function(e){e.launchUrl(t.props.url,{action:"OpenAutosuggestGoTo"}).then((function(){t.props.searchInstrumentationService.logSearchClickEvent("Go_To","MSA_Auto_Suggest_Go_To",!0,"Go_To",void 0,t.props.referral)}))})):t.props.urlLauncherService.openUrl(t.props.url,"OpenAutosuggestGoTo").then((function(){t.props.searchInstrumentationService.logSearchClickEvent("Go_To","MSA_Auto_Suggest_Go_To",!0,"Go_To",void 0,t.props.referral)}))}},t}return Object(n.__extends)(t,e),t.prototype.render=function(){return s.a.createElement(le,{title:this.props.title,icon:this.props.iconClass+" ms-ohp-Icon--see-more",isDarkMode:this.props.isDarkMode,isPwa:this.props.isPwa,handleClick:this.handleClick(),target:"_blank"})},t}(s.a.Component),Se=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(){return function(e){e.preventDefault(),t.props.onClick(),t.setLeanringState(),t.props.searchInstrumentationService.logSearchClickEvent("Learning","MSA_Auto_Suggest_Learning",!1,"LearningPrimary",t.props.title)}},t.handleRemoveLearningClick=function(){return function(e){e.preventDefault(),document.getElementById("learning").style.display="none",t.props.shellShim.Search.FocusSearchBox(),t.setLeanringState(),t.props.searchInstrumentationService.logSearchClickEvent("Learning","MSA_Auto_Suggest_Learning",!1,"LearningSecondary",t.props.title)}},t}return Object(n.__extends)(t,e),t.prototype.render=function(){var e=D.a.FluentIconCssClass,t=D.a.SvgIconCssClass;return s.a.createElement(ee,{title:this.props.title,handleClick:this.handleClick(),icon:t+" "+e+"  ms-Icon--Lightbulb ms-ohp-Icon--learning--lightBulb"+(this.props.isDarkMode?" ms-ohp-Icon--see-more--darkMode":" ms-ohp-Icon--see-more"),description:"",secondaryButtonProps:{icon:t+" "+e+" "+D.a.getCssClass(E.a.X)+(this.props.isDarkMode?" ms-ohp-Icon--learning--cancelButton--darkMode":" ms-ohp-Icon--learning--cancelButton"),onClick:this.handleRemoveLearningClick(),ariaLabel:this.props.ariaLabel},style:this.props.isDarkMode?"search-compound-button-container--see-more--darkMode":"search-compound-button-container--see-more",target:"_blank",isDarkMode:this.props.isDarkMode,isPwa:this.props.isPwa})},t.prototype.setLeanringState=function(){var e=localStorage.getItem("OfficeDotComConsumerLearningStateObject"),t=[];e&&(t=JSON.parse(e)),t.push(this.props.puid),localStorage.setItem("OfficeDotComConsumerLearningStateObject",JSON.stringify(t)),this.props.hideLearningSuggestions()},t}(s.a.Component),ve=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t.prototype.createStream=function(e){var r=[],i=[];return""!==(null==e?void 0:e.trim())&&(r.push({contentLauncherEnabled:t.capabilitiesService.capabilities.contentLauncherEnabled,isPwa:t.capabilitiesService.capabilities.isPwaInUwp,isDarkMode:t.isDarkMode,url:t.oneDriveURL+e,title:t.getButtonText(e),searchInstrumentationService:t.searchInstrumentationService,urlLauncherService:t.urlLauncherService}),i.push("See_More")),t.searchInstrumentationService.setRenderedProviderResults("See_More",i),Q.Observable.fromArray(r)},t.prototype.getId=function(){return"seeMore"},t.oneDriveURL="https://onedrive.live.com/?id=root&qt=search&q=",t}(Z.a),me=r("p6Zr"),fe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(){return function(e){e.preventDefault(),t.props.contentLauncherEnabled?Promise.all([r.e(0),r.e(1),r.e(2),r.e(3),r.e(4),r.e(33)]).then(r.bind(null,"DZQ9")).then((function(e){e.launchUrl(t.props.url,{action:"OpenAutosuggestSeeMore"}).then((function(){t.props.searchInstrumentationService.logSearchClickEvent("See_More","MSA_Auto_Suggest_See_More",!0,"See_More",void 0,me.a.OneDrive)}))})):t.props.urlLauncherService.openUrl(t.props.url,"OpenAutosuggestSeeMore").then((function(){t.props.searchInstrumentationService.logSearchClickEvent("See_More","MSA_Auto_Suggest_See_More",!0,"See_More",void 0,me.a.OneDrive)}))}},t}return Object(n.__extends)(t,e),t.prototype.render=function(){var e=D.a.FluentIconCssClass,t=D.a.SvgIconCssClass;return s.a.createElement(ee,{title:this.props.title,handleClick:this.handleClick(),description:"",icon:t+" "+e+" "+D.a.getCssClass(E.a.OneDrive)+" ms-ohp-Icon--see-more",style:this.props.isDarkMode?"search-compound-button-container--see-more--darkMode":"search-compound-button-container--see-more",target:"_blank",isDarkMode:this.props.isDarkMode,isPwa:this.props.isPwa,role:"button"})},t}(s.a.Component),Ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t.prototype.createStream=function(e){var r=[],i=[];return""!==(null==e?void 0:e.trim())&&(r.push({isPwa:t.capabilitiesService.capabilities.isPwaInUwp,isDarkMode:t.isDarkMode,ngZone:t.ngZone,officeRouteService:t.officeRouteService,title:t.getButtonText(),searchInstrumentationService:t.searchInstrumentationService,searchText:e,urlLauncherService:t.urlLauncherService}),i.push("Serp")),t.searchInstrumentationService.setRenderedProviderResults("Serp",i),Q.Observable.fromArray(r)},t.prototype.getId=function(){return"Serp"},t}(Z.a),be=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(){return function(e){e.preventDefault(),t.props.searchInstrumentationService.logSearchClickEvent("Serp","MSA_Auto_Suggest_Serp",!0,"See_More"),t.props.ngZone.run((function(){return t.props.officeRouteService.navigateTo({route:"ConsumerAllSearch"},!1,{q:t.props.searchText})}))}},t}return Object(n.__extends)(t,e),t.prototype.render=function(){return s.a.createElement(ee,{title:this.props.title,handleClick:this.handleClick(),hideIcon:!0,description:"",style:this.props.isDarkMode?"serp-search-suggestion-text search-compound-button-container--see-more--darkMode ohpAppTheme ms-fcl-tda":"serp-search-suggestion-text search-compound-button-container--see-more ohpAppTheme ms-fcl-tda",target:"_blank",isDarkMode:this.props.isDarkMode,isPwa:this.props.isPwa,useThemeColor:!0,role:"button"})},t}(s.a.Component),ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t.prototype.createStream=function(e){var r,i,o,a;if(""!==(null==e?void 0:e.trim())){var s=[],c=[],l=e.replace(/\s/g,"").toLowerCase();if(0===t.contextService.sharedContext.officeMarket.indexOf(t.languagePrefix)&&l.length>=t.MIN_NUM_OF_CHARS)try{for(var u=Object(n.__values)(t.settings.getSettingList()),p=u.next();!p.done;p=u.next()){var h=p.value,d=h.RelatedSearchQueries;try{for(var g=(o=void 0,Object(n.__values)(d)),S=g.next();!S.done;S=g.next()){var v=S.value.replace(/\s/g,"").toLowerCase();if(0===l.indexOf(v)||0===v.indexOf(l)){c.push(h);break}}}catch(e){o={error:e}}finally{try{S&&!S.done&&(a=g.return)&&a.call(g)}finally{if(o)throw o.error}}if(c.length===t.MAXCOUNT)break}}catch(e){r={error:e}}finally{try{p&&!p.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}return c.forEach((function(e,r){s.push({contentLauncherEnabled:t.capabilitiesService.capabilities.contentLauncherEnabled,id:r.toString(),isPwa:t.capabilitiesService.capabilities.isPwaInUwp,isDarkMode:t.isDarkMode,title:e.Title,iconClass:e.IconUnicodeCodepointCssClass,url:e.Url,searchInstrumentationService:t.searchInstrumentationService,urlLauncherService:t.urlLauncherService})})),Q.Observable.fromArray(s)}return Q.Observable.empty()},t.prototype.getId=function(){return"setting"},t.languagePrefix="en",t.MIN_NUM_OF_CHARS=2,t.MAXCOUNT=2,t}(Z.a),Te=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(){return function(e){e.preventDefault(),t.props.contentLauncherEnabled?Promise.all([r.e(0),r.e(1),r.e(2),r.e(3),r.e(4),r.e(33)]).then(r.bind(null,"DZQ9")).then((function(e){e.launchUrl(t.props.url,{action:"OpenAutosuggestApp"}).then((function(){t.props.searchInstrumentationService.logSearchClickEvent("Setting","MSA_Auto_Suggest_Setting",!0,"Setting",t.props.title)}))})):t.props.urlLauncherService.openUrl(t.props.url,"OpenAutoSuggestSetting").then((function(){t.props.searchInstrumentationService.logSearchClickEvent("Setting","MSA_Auto_Suggest_Setting",!0,"Setting",t.props.title)}))}},t}return Object(n.__extends)(t,e),t.prototype.render=function(){return s.a.createElement(le,{title:this.props.title,icon:this.props.iconClass+(this.props.isDarkMode?" ms-ohp-Icon--see-more--darkMode":" ms-ohp-Icon--see-more"),handleClick:this.handleClick(),target:"_blank",isDarkMode:this.props.isDarkMode,isPwa:this.props.isPwa})},t}(s.a.Component),ke=function(e){function t(){var r=null!==e&&e.apply(this,arguments)||this;return r.renderedResults=[],r.maxCount=3,r.templateId="templatePreview",r.seeMoreInHeaderId="seeMoreInHeader",r.templateURL="https://templates.office.com/"+t.contextService.sharedContext.officeMarket+"/Search/results?query=",r.templateUpsellURL="https://www.microsoft.com/"+t.contextService.sharedContext.officeMarket+"/microsoft-365/premium-templates-with-microsoft-365?ocid=",r.templatePlatform="&platform=Wac",r}return Object(n.__extends)(t,e),t.prototype.getId=function(){return"templatePreview"},t.prototype.getSearchSuggestion=function(e,r,i){var n,o=r;this.renderedResults=[];try{if(o.Groups&&o.Groups.length>0){for(var a=0;a<o.Groups.length;a++)if("Template"===o.Groups[a].GroupType){n=o.Groups[a].Suggestions;break}if(n)for(var s=0,c=0;s<this.maxCount&&c<n.length;c++){if(!n[c].IsPremium||t.searchConfigService.config.premiumTemplatesForSearchEnabled||t.clientStartupConfigService.config.authType===P.a.OrgId){var l=t.capabilitiesService.capabilities.isPwaInUwp,u=l?this.templateUpsellURL+"cmm6pexr7oa":this.templateUpsellURL+"cmm6es9k55z";i.onNext({contentLauncherEnabled:t.capabilitiesService.capabilities.contentLauncherEnabled,createDocumentService:t.createDocumentService,deviceDetector:t.deviceDetector,id:this.templateId+s.toString(),isEndOfResult:!1,isMSA:t.clientStartupConfigService.config.authType===P.a.MSA,isPwa:l,isSubscribed:t.isSubscribedUser,isDarkMode:t.isDarkMode,searchConfigService:t.searchConfigService,searchInstrumentationService:t.searchInstrumentationService,searchText:e,templatePreviewData:this.getTemplatePreviewData(n,c,s),templateUpsellURL:u,urlLauncherService:t.urlLauncherService}),s++}s!==this.maxCount&&c!==n.length-1||(i.onNext({contentLauncherEnabled:t.capabilitiesService.capabilities.contentLauncherEnabled,createDocumentService:t.createDocumentService,deviceDetector:t.deviceDetector,id:this.seeMoreInHeaderId,isEndOfResult:!0,isMSA:t.clientStartupConfigService.config.authType===P.a.MSA,isPwa:t.capabilitiesService.capabilities.isPwaInUwp,isSubscribed:t.isSubscribedUser,isDarkMode:t.isDarkMode,ngZone:t.ngZone,officeRouteService:t.officeRouteService,searchConfigService:t.searchConfigService,searchInstrumentationService:t.searchInstrumentationService,searchText:e,templatePreviewData:null,templateUpsellURL:this.templateUpsellURL,urlLauncherService:t.urlLauncherService,seeMoreTemplateUrl:this.templateURL+e+this.templatePlatform}),this.renderedResults.push("Template"))}}}catch(e){i.onCompleted()}t.searchInstrumentationService.setRenderedProviderResults("Template",this.renderedResults),i.onCompleted()},t.prototype.getMockedSearchSuggestion=function(e,r){for(var i=0;i<3;i++)r.onNext({contentLauncherEnabled:t.capabilitiesService.capabilities.contentLauncherEnabled,createDocumentService:t.createDocumentService,deviceDetector:t.deviceDetector,id:this.templateId+i.toString(),isEndOfResult:!1,isPwa:t.capabilitiesService.capabilities.isPwaInUwp,isSubscribed:t.isSubscribedUser,isDarkMode:t.isDarkMode,searchConfigService:t.searchConfigService,searchInstrumentationService:t.searchInstrumentationService,searchText:e,templatePreviewData:this.getMockedTemplatePreviewData(i+1),templateUpsellURL:this.templateUpsellURL,urlLauncherService:t.urlLauncherService});r.onNext({contentLauncherEnabled:t.capabilitiesService.capabilities.contentLauncherEnabled,createDocumentService:t.createDocumentService,deviceDetector:t.deviceDetector,id:this.seeMoreInHeaderId,isEndOfResult:!0,isPwa:t.capabilitiesService.capabilities.isPwaInUwp,isSubscribed:t.isSubscribedUser,isDarkMode:t.isDarkMode,ngZone:t.ngZone,officeRouteService:t.officeRouteService,searchConfigService:t.searchConfigService,searchInstrumentationService:t.searchInstrumentationService,searchText:e,templatePreviewData:null,templateUpsellURL:this.templateUpsellURL,urlLauncherService:t.urlLauncherService,seeMoreTemplateUrl:this.templateURL+e+this.templatePlatform}),r.onCompleted()},t.prototype.getTemplatePreviewData=function(e,r,i){var n;try{r<e.length&&(n={AssetId:e[r].AssetId,Description:e[r].Description,TemplateBinaryUrl:e[r].TemplateBinaryUrl,Market:t.contextService.sharedContext.officeMarket,NumberOfRatings:e[r].RecommendationModifier,IsPremium:t.clientStartupConfigService.config.authType!==P.a.OrgId&&e[r].IsPremium,RecsMod:null,Title:e[r].Title,Thumbnails:null,IsBlank:!1,Categories:null,application:e[r].Application,imageHeight:e[r].Images[0].Height,imageWidth:e[r].Images[0].Width,imageUrl:e[r].Images[0].Url,position:(i+1).toString()},this.renderedResults.push(e[r].AssetId+":"+e[r].Application))}catch(e){return n}return n},t.prototype.getMockedTemplatePreviewData=function(e){return{AssetId:"TM67008005",Categories:null,Description:"This column resume template is useful both as a sample resume and to show off your accomplishments.",IsBlank:!1,IsPremium:!1,Market:"en-US",NumberOfRatings:void 0,RecsMod:null,TemplateBinaryUrl:"https://binaries.templates.cdn.office.net/support/templates/en-us/tf67008005_wac.docx",Thumbnails:null,Title:"Columns resume",application:"Word",imageHeight:600,imageUrl:"https://binaries.templates.cdn.office.net/support/templates/en-us/lt67008005.png",imageWidth:462,position:e.toString()}},t}(ie),Pe=(r("FdWx"),function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(e){"click"===e.type&&(e.preventDefault(),e.currentTarget.blur(),t.props.handleTemplateClick(e))},t.handleKeyPress=function(e){"Enter"===e.key&&(e.preventDefault(),e.currentTarget.blur(),t.props.handleTemplateClick(e))},t}return Object(n.__extends)(t,e),t.prototype.render=function(){var e=this;return s.a.createElement("a",{href:"#",className:this.props.isDarkMode?"gallery-item-container--darkMode":"gallery-item-container",role:"option","data-nav":"true",tabIndex:-1,onClick:function(t){return e.handleClick(t)},onKeyPress:function(t){return e.handleKeyPress(t)}},s.a.createElement("div",{className:"gallery-item-image-wrapper"},s.a.createElement("img",{src:this.props.imageUrl,className:"gallery-item-image",alt:""})),s.a.createElement("div",{className:"gallery-item-text"},s.a.createElement("div",{className:this.props.isDarkMode?"gallery-item-text__title--darkMode":"gallery-item-text__title"},this.props.isPremium&&s.a.createElement("div",{className:this.props.icon+" gallery-item-icon"}),this.props.title),s.a.createElement("div",{className:"gallery-item-text__application"},this.props.application)))},t}(s.a.Component)),we=function(s}return Object(n.__extends)(t,e),t.getTemplateUm},t.prototype.createStream=function(e){var r=[],i=[];if(0===t.contextService.sharedContext.officeMarket.indexOf(t.languagePrefix)&&(e.length>=t.MIN_NUM_OF_CHARS||"cv"===e.toLowerCase())){var n=1,o=e.toLowerCase();t.topTemplateSearchTexts.forEach((function(e){var a=e.toLowerCase();if(0===a.indexOf(o)||0===o.indexOf(a)){var s=e.replace(/\w\S*/)}));r.push({contentLauncherEnabled:t.capabilitiesService.capabilities.contentLauncherEnabled,id:(n++).toString(),isPwa:t.capabilitiesService.capabilities.isPwaInUwp,isDarkMode:t.isDarkMode,urlToOpen:t.getTemplateURL(s),title:t.buttonText(s),matchedTemplate:s,searchInstrumentationService:t.searchInstrumentationService,urlLauncherService:t.urlLauncherService}),i.push(s)}}))}return t.searchInstrumentationService.setRenderedProviderResults("Template",i),Q.Observable.fromArray(r)},t.prototype.getId=function(){return"template"},t.MIN_NUM_OF_CHARS=3,t.languagePrefix="en",t.templateURL="https://templates.office.com/en-US/Search/results?query=",t.templatePlatform="&platform=Wac",t.topTemplateSearchTexts=["resume","cover letter","CV","gantt","calendar","budget","menu","brochure","presentation","flyer","invoice","paper","report","timeline","planner","tracker","certificate","newsletter","schedule","card","business card","agenda","label","photo album","business plan","curriculum","letter"],t}(Z.a),xe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(){return function(e){e.preventDefault(),t.props.contentLauncherEnabled?Promise.all([r.e(0),r.e(1),r.e(2),r.e(3),r.e(4),r.e(33)]).then(r.bind(null,"DZQ9")).then((function(e){e.launchUrl(t.props.urlToOpen,{action:"OpenAutosuggestTemplate"}).then((function(){t.props.searchInstrumentationService.logSearchClickEvent("Template","MSA_Auto_Suggest_Template",!0,"Template",t.props.matchedTemplate,void 0,void 0,t.props.id)}))})):t.props.urlLauncherService.openUrl(t.props.urlToOpen,"OpenAutosuggestTemplate").then((function(){t.props.searchInstrumentationService.logSearchClickEvent("Template","MSA_Auto_Suggest_Template",!0,"Template",t.props.matchedTemplate,void 0,void 0,t.props.id)}))}},t}return Object(n.__extends)(t,e),t.prototype.render=function(){var e=D.a.FluentIconCssClass,t=D.a.SvgIconCssClass;return s.a.createElement(le,{title:this.props.title,handleClick:this.props.handleClick?this.props.handleClick:this.handleClick(),icon:t+" "+e+" "+D.a.getCssClass(E.a.PreviewLink)+(this.props.isDarkMode?" ms-ohp-Icon--see-more--darkMode":" ms-ohp-Icon--see-more"),target:"_blank",style:this.props.style,isDarkMode:this.props.isDarkMode,isPwa:this.props.isPwa})},t}(s.a.Component),Ie="templatePreview",_e=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(){return function(e){if(e.preventDefault(),t.props.templatePreviewData.IsPremium&&!t.props.isSubscribed)t.props.contentLauncherEnabled?Promise.all([r.e(0),r.e(1),r.e(2),r.e(3),r.e(4),r.e(33)]).then(r.bind(null,"DZQ9")).then((function(e){e.launchUrl(t.props.templateUpsellURL,{action:"OpenAutosuggestTemplate"}).then((function(){t.logTemplateClickEvent("Template")}))})):t.props.urlLauncherService.openUrl(t.props.templateUpsellURL,"OpenAutosuggestTemplate").then((function(){t.logTemplateClickEvent("Template")}));else{var i=l.a.fileTypeNameToFileType(t.props.templatePreviewData.application),n=l.a.referralFromFileType(i);t.props.createDocumentService.createItem(i,null,t.props.templatePreviewData,(function(e){t.props.searchInstrumentationService.logSearchClickEvent("Template","MSA_Auto_Suggest_Template",!0,"Template",t.props.templatePreviewData.AssetId,n,void 0,t.props.templatePreviewData.position)}),void 0,void 0,"_blank")}}},t.handleSeeMoreTemplateClick=function(){return function(e){e.preventDefault(),t.props.deviceDetector.isMobileDevice()||t.props.searchConfigService.config.disableSearchEnterPressedAction||!t.props.isMSA?t.props.contentLauncherEnabled?Promise.all([r.e(0),r.e(1),r.e(2),r.e(3),r.e(4),r.e(33)]).then(r.bind(null,"DZQ9")).then((function(e){e.launchUrl(t.props.seeMoreTemplateUrl,{action:"OpenAutosuggestTemplate"}).then((function(){t.logTemplateClickEvent("See_More")}))})):t.props.urlLauncherService.openUrl(t.props.seeMoreTemplateUrl,"OpenAutosuggestTemplate").the)})):(t.logTemplateClickEvent("See_More"),t.props.ngZone.run((function(){return t.props.officeRouteService.navigateTo({route:"ConsumerTemplateSearch"},!1,{q:t.props.searchText})})))}},t}return Object(n.__extends)(t,e),t.prototype.render=function(){var e=D.a.FluentIconCssClass,t=D.a.SvgIconCssClass;return this.props.isEndOfResult?s.a.createElement(xe,{contentLauncherEnabled:this.props.contentLauncherEnabled,displayText:this.props.displayText,handleClick:this.handleSeeMoreTemplateClick(),id:this.props.id,isDarkMode:this.props.isDarkMode,isPwa:this.props.isPwa,searchInstrumentationService:this.props.searchInstrumentationService,searchText:this.props.searchText,style:this.props.searchConfigService.config.templatePreviewProviderWithNoThumbnails?"":"templatePreviewSeeMoreButton",title:we.seeMoreButtonText(this.props.searchText),url:this.props.url,urlLauncherService:this.props.urlLauncherService,urlToOpen:we.getTemplateURL(this.props.searchText)}):this.props.searchConfigService.config.templatePreviewProviderWithNoThumbnails?s.a.createElement("div",null,null!=this.props.templatePreviewData&&s.a.createElement(xe,{contentLauncherEnabled:this.props.contentLauncherEnabled,displayText:this.props.displayText,handleClick:this.handleClick(),id:this.props.id,isDarkMode:this.props.isDarkMode,isPwa:this.props.isPwa,searchInstrumentationService:this.props.searchInstrumentationService,searchText:this.props.searchText,title:this.props.templatePreviewData.Title+" - "+this.props.templatePreviewData.application,url:this.props.url,urlLauncherService:this.props.urlLauncherService,urlToOpen:we.getTemplateURL(this.props.searchText)})):s.a.createElement("div",{id:this.props.id},null!=this.props.templatePreviewData&&s.a.createElement(Pe,{application:this.props.templatePreviewData.application,icon:t+" "+e+" "+D.a.getCssClass(E.a.Diamond)+(this.props.isDarkMode?" search-Icon--darkMode":""),imageUrl:this.props.templatePreviewData.imageUrl,isPremium:this.props.templatePreviewData.IsPremium,key:this.props.templatePreviewData.position,title:this.props.templatePreviewData.Title,handleTemplateClick:this.handleClick(),isDarkMode:this.props.isDarkMode,isPwa:this.props.isPwa,target:"_blank"}))},t.prototype.componentDidMount=function(){if(!this.props.searchConfigService.config.templatePreviewProviderWithNoThumbnails)if(this.props.isEndOfResult)document.getElementById(Ie).parentNode.style.lineHeight="0px";else{var e=document.getElementById(Ie+(parseInt(this.props.templatePreviewData.position)-1)).parentElement;e.style.width="31%",e.style.display="inline-block","1"===this.props.templatePreviewData.position?(e.style.marginLeft="2.5%",e.style.marginRight="1%"):"2"===this.props.templatePreviewData.position&&(e.style.marginRight="1%")}},t.prototype.logTemplateClickEvent=function(e){this.props.searchInstrumentationService.logSearchClickEvent("Template","MSA_Auto_Suggest_Template",!0,e)},t}(s.a.Component);function Me(e,t){var r=e.resources,i=[];return[{groupId:"serp",create:function(){return{position:11,optimalCount:1,maxCount:1,providers:[Ce],component:be,heading:"",ariaLabel:r.SearchSuggestionSeeMoreHeading}}},{groupId:"learning",create:function(){return{position:10,optimalCount:1,maxCount:1,providers:[pe],component:Se,heading:"",ariaLabel:r.SearchSuggestionLearningAriaLabel}}},{groupId:"seeMore",create:function(){return{position:9,optimalCount:1,maxCount:1,providers:[ve],component:fe,heading:"",ariaLabel:r.SearchSuggestionOneDriveHeading}}},{groupId:"bing",create:function(){return{position:8,optimalCount:1,maxCount:1,providers:[V],component:de,heading:"",ariaLabel:r.SearchSuggestionBingHeading}}},{groupId:"help",create:function(){return{position:7,optimalCount:2,maxCount:3,providers:[ne],component:ue,heading:r.SearchSuggestionHelpHeading,ariaLabel:r.SearchSuggestionHelpHeading}}},{groupId:"templateNoPreview",create:function(){return{position:6,optimalCount:4,maxCount:4,providers:[ke],component:_e,heading:r.SearchSuggestionTemplateHeading,ariaLabel:r.SearchSuggestionTemplateHeading}}},{groupId:"templatePreview",create:function(){return{position:6,optimalCount:4,maxCount:4,providers:[ke],component:_e,heading:r.SearchSuggestionTemplateHeading,ariaLabel:r.SearchSuggestionTemplateHeading}}},{groupId:"setting",create:function(){return{position:5,optimalCount:1,maxCount:2,providers:[ye],component:Te,heading:"Settings",ariaLabel:"Settings"}}},{groupId:"files",create:function(){return{position:4,optimalCount:3,maxCount:5,providers:[z],component:te,heading:r.SearchSuggestionFileHeading,ariaLabel:r.SearchSuggestionFileHeading}}},{groupId:"template",create:function(){return{position:2,optimalCount:1,maxCount:3,providers:[we],component:xe,heading:r.SearchSuggestionTemplateHeading,ariaLabel:r.SearchSuggestionTemplateHeading}}},{groupId:"goTo",create:function(){return{position:1,optimalCount:2,maxCount:3,providers:[re.a],component:ge,heading:r.SearchSuggestionGoToHeading,ariaLabel:r.SearchSuggestionGoToHeading}}},{groupId:"apps",create:function(){return{position:0,optimalCount:2,maxCount:4,providers:[q.a],component:he,heading:r.SearchSuggestionAppHeading,ariaLabel:r.SearchSuggestionAppHeading}}}].forEach((function(r){switch(r.groupId){case"goTo":e.goToProviderEnabled&&i.push(r);break;case"setting":e.settingProviderEnabled&&i.push(r);break;case"template":(t||!e.templatePreviewProviderWithSeeMoreEnabled&&!e.templatePreviewProviderWithNoThumbnails)&&i.push(r);break;case"templatePreview":!t&&e.templatePreviewProviderWithSeeMoreEnabled&&i.push(r);break;case"learning":e.learningProviderEnabled&&!t&&e.templatePreviewProviderWithSeeMoreEnabled&&i.push(r);break;case"templateNoPreview":!t&&e.templatePreviewProviderWithNoThumbnails&&i.push(r);break;case"serp":t||e.disableSearchEnterPressedAction||i.push(r);break;default:i.push(r)}})),i}var Le=r("sKtG"),De=void 0,Ee=function(){function e(e,t,r,i,n,o,a,s,c,l,u,p,h,d,g,S,v,m,f,C,b,y,T,k,P,w,x,I){this.accessTokenService=e,this.capabilitiesService=t,this.clientStartupConfigService=r,this.commercialApps=i,this.consumerInstallConfigService=n,this.consumerLearnings=o,this.contextService=a,this.createDocumentService=s,this.deviceDetector=c,this.documentService=l,this.fastSearchUXService=u,this.locService=p,this.mruDataService=h,this.ngZone=d,this.officeRouteService=g,this.oneDriveGraphService=S,this.searchConfigService=v,this.searchInstrumentationService=m,this.searchInstrumentedXhrService=f,this.consumerAccountSettings=C,this.sharedSearchService=b,this.shellShimService=y,this.themingService=T,this.urlLauncherService=k,this.userContextService=P,this.windowService=w,this.workloadsService=x,this.searchPageInstrumentationService=I,this.currentProps={querySearchText:null,pathname:null},this.consumerSearchEnterEventAdded=!1,this.keysDown=new Set}return e.prototype.configureSearchBox=function(){var e;return Object(n.__awaiter)(this,void 0,void 0,(function(){var t,r,i,o,a,s,c,u,p=this;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return t=this,[4,this.shellShimService.getShellShim()];case 1:return t.shellShim=n.sent(),[4,this.searchPageInstrumentationService.searchUXInstrumenter];case 2:return r=n.sent(),this.shellShim.Search?(this.setupNavigationHandler(),(null===(e=this.officeRouteService.getCurrentRoute())||void 0===e?void 0:e.app)===l.b.Fluid?this.shellShim.Search.SetSearchBoxVisibility(!1):this.shellShim.Search.SetSearchBoxVisibility(!0),this.clientStartupConfigService.config.authType!==P.a.MSA?[3,7]:(o=void 0,this.searchConfigService.config.consumerSearchOneDriveMigrationAwareEnabled?(i=this,[4,this.getOneDriveConvergenceStatusForConsumer()]):[3,4])):[3,11];case 3:return i.consumerOneDriveMigrated=n.sent(),o={instrumenter:r,useSharedCDN:!0,tokenProviders:{Substrate:function(){return p.accessTokenService.getAccessToken("Substrate").then((function(e){return e.token}))}}},[3,5];case 4:o={instrumenter:r,useSharedCDN:!0},n.label=5;case 5:return this.shellShim.Search.SetSearchBoxSettings(o),this.shellShim.Search.SetProviderConfigUpdaters(this.getProviderConfigUpdatersForConsumer()),this.shellShim.Search.OnSearchBoxActivated((function(e){return p.onConsumerSearchBoxActivated(e)})),this.shellShim.Search.OnSearchBoxDeactivated((function(){return p.onConsumerSearchBoxDeactivated()})),this.shellShim.Search.OnSearchTextChange)})),this.shellShim.Search.SetPlaceholderText(this.searchConfigService.config.resources.ConsumerSearchBoxStringExperimentA),this.registerSuggestionProviders(),this.searchInstrumentationService.setSearchReferralPlatform(this.deviceDetector.isUwp()),this.sharedSearchService.initializePrefetchLibrary(),[4,this.fastSearchUXService.searchUXMainModule];case 6:return s=n.sent(),this.shellShim.Search.OnSubmitSearch(s.createSubmitSearchHandle)}))),(0,s.getScopeRouterApi)().then((function(e){var t=!0;(0,e.listenToRoute)((0,e.createScopeRouter)(r,(function(e){t?(p.currentProps=e,t=!1):(p.onRouteChanged(p.currentProps,e),p.currentProps=e)})),!0)})),[3,9];case 7:return o={instrumenter:r,useSharedCDN:!0,tokenProviders:{BingForBusiness:function(){return p.accessTokenService.getAccessToken("BingAnswers").then((function(e){return e.token}))},Graph:function(){return p.accessTokenService.getAccessToken("Graph").then((function(e){return e.token}))},Loki:function(){return p.accessTokenService.getAccessToken("Loki").then((function(e){return e.token}))},SharePoint:function(){return p.accessTokenService.getAccessToken("SharePoint",!1,p.contextService.sharedContext.sharePointResourceId).then((function(e){return e.token}))},Substra)}}},a=this.getStartPageTypeFromLocation(location.pathname,r),this.shellShim.Search.SetSearchBoxSettings(o),this.shellShim.Search.SetProviderConfigUpdaters(this.getProviderConfigUpdaters()),this.shellShim.Search.OnSearchBoxActivated((function(){return p.onSearchBoxActivated()})),(this.searchConfigService.config.templateProviderInCommercialEnabled||this.searchConfigService.config.helpProviderInCommercialEnabled)&&this.registerSuggestionProviders(),this.sharedSearchService.initializePrefetchLibrary(),this.fastSearchUXService.warmup3S().then((function(e){404===e.xhr.status&&p.shellShim.Search.SetSearchBoxVisibility(!1)})),[4,this.fastSearchUXService.searchUXMainModule];case 8:s=n.sent(),c=this.fastSearchUXService.getStartQuery(s),this.shellShim.Search.OnSubmitSearch(s.createSubmitSearchHandler((function(e,t){return p.ngZone.run((function(){var r,i,n;return p.searchConfigService.config.fastDisableStarQuery?"stream"===a?p.onSubmitStreamScopedSearch(e):"person"===(null==t?void 0:t.scopeType)&&(null===(r=null==t?void 0:t.data)||void 0===r?void 0:r.id)?p.onSubmitPersonScopedSearch(t):"topic"===(null==t?void 0:t.scopeType)&&(null===(i=null==t?void 0:t.data)||void 0===i?void 0:i.id)?p.onSubmitTopicScopedSearch(t):"meeting"===(null==t?void 0:t.scopeType)&&(null===(n=null==t?void 0:t.data)||void 0===n?void 0:n.id)?p.onSubmitMeetingScopedSearch(t):p.onSubmitSearch(e,c):p.onSubmitSearchFallback(e,t)}))}))),this.removeAndSetExitSearch(),(0,s.getScopeRouterApi)().then((function(e){(0,e.listenToRoute)((0,e.createScopeRouter)(e})))})),n.label=9;case 9:return u=Z.a,[4,this.isSubscribedUser()];case 10:u.isSubscribedUser=n.sent(),n.label=11;case 11:return this.searchConfigService.config.typeToSearchEnabled&&this.typeToSearch(),[2]}}))}))},e.prototype.getStartPageTypeFromLocation=function(e,t){return"officehome"===t.props.hostAppInfo.id.toLowerCase()&&e.toLowerCase().endsWith("stream")?"stream":"default"},e.prototype.removeAndSetExitSearch=function(){var e,t,r,i,n,o,a=this;De&&(null===(r=null===(t=null===(e=this.shellShim)||void 0===e?void 0:e.Search)||void 0===t?void 0:t.RemoveOnExitSearch)||void 0===r||r.call(t,De)),De=null===(o=null===(n=null===(i=this.shellShim)||void 0===i?void 0:i.Search)||void 0===n?void 0:n.OnExitSearch)||void 0===o?void 0:o.call()}))},e.prototype.setupNavigationHandler=function(){var e=this,t=this.officeRouteService.getRouteChangeStartObservable(),r=this.officeRouteService.getRouteChangeEndObservable();t.subscribe((function(t){return Object(n.__awaiter)(e,void 0,void 0,(function(){var e;return Object(n.__generator)(this,(function(r){switch(r.label){case 0:return this.shellShim?(e=this,[4,this.shellShimService.getShellShim()]):[3,2];case 1:e.shellShim=r.sent(),r.label=2;case 2:return this.shellShim.Search.SetSearchBoxVisibility("Content"!==t.currentRoute.route||!t.currentRoute.app||t.currentRoute.app!==l.b.Fluid),[2]}}))}))})),r.subscribe}))},e.prototype.onSubmitStreamScopedSearch=function(e){e&&this.officeRouteService.navigateTo({route:"Search"},!1,{q:e,refiner:'{"FileType": ["video"]}',oobRefiners:'{"FileType": ["video"]}'})},e.prototype.onSubmitPersonScopedSearch=function(e){var t,r,i,o;if("person"===(null==e?void 0:e.scopeType)||(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.id)){var a=(null===(r=null==e?void 0:e.data)||void 0===r?void 0:r.isPCSOverviewVerticalEnabled)?"SearchPersonScopedOverview":"SearchPersonScoped";this.officeRouteService.navigateTo({route:a},!1,Object(n.__assign)({pp:e.data.id},(null===(i=null==e?void 0:e.data)||void 0===i?void 0:i.query)&&{q:null===(o=null==e?void 0:e.data)||void 0===o?void 0:o.query}))}},e.prototype.onSubmitTopicScopedSearch=function(e){var t,r;("topic"===(null==e?void 0:e.scopeType)||(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.id))&&this.officeRouteService.navigateTo({route:"SearchTopicScoped"},!1,{topicId:e.data.id,topicName:null===(r=e.data)||void 0===r?void 0:r.displayName})},e.prototype.onSubmitMeetingScopedSearch=function(e){var t,r;("meeting"===(null==e?void 0:e.scopeType)||(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.id))&&this.officeRouteService.navigateTo({route:"SearchMeetingScoped"},!1,{meetingId:e.data.id,meetingName:null===(r=e.data)||void 0===r?void 0:r.displayName})},e.prototype.onSubmitSearch=function(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){var r;return Object(n.__generator)(this,(function(i){switch(i.label){case 0:return e?[4,this.searchPageInstrumentationService.searchUXInstrumenter]:[2];case 1:return r=i.sent(),t&&t(e,{destination:"all",instrumenter:r}),this.officeRouteService.navigateTo({route:"Search"},!1,{q:e}),[2]}}))}))},e.prototype.onSubmitSearchFallback=function(e,t){var r,i,n,o,a,s,c,l,u={q:e},p="Search",h="person"===(null==t?void 0:t.scopeType)&&(null===(r=null==t?void 0:t.data)||void 0===r?void 0:r.id),d="topic"===(null==t?void 0:t.scopeType)&&(null===(i=null==t?void 0:t.data)||void 0===i?void 0:i.id),g="meeting"===(null==t?void 0:t.scopeType)&&(null===(n=null==t?void 0:t.data)||void 0===n?void 0:n.id);h?(u.pp=t.data.id,u.q=t.data.query||u.q,p=(null===(o=null==t?void 0:t.data)||void 0===o?void 0:o.isPCSOverviewVerticalEnabled)?"SearchPersonScopedOverview":"SearchPersonScoped"):d?(u.topicId=null===(a=null==t?void 0:t.data)||void 0===a?void 0:a.id,u.topicName=null===(s=null==t?void 0:t.data)||void 0===s?void 0:s.displayName,p="SearchTopicScoped"):g&&(u.meetingId=null===(c=null==t?void 0:t.data)||void 0===c?void 0:c.id,u.meetingName=null===(l=null==t?void 0:t.data)||void 0===l?void 0:l.displayName,p="SearchMeetingScoped"),this.officeRouteService.navigateTo({route:p},!1,u)},e.prototype.onExitSearch=function(){var e=this.defaultBackRoute();this.officeRouteService.navigateTo({route:e},!0)},e.prototype.defaultBackRoute=function(){var e;switch(null===(e=this.officeRouteService.getCurrentRoute())||void 0===e?void 0:e.route){case"Search":case"SearchTopicScoped":case"SearchMeetingScoped":case"SearchPersonScoped":case"SearchPersonScopedOverview":return"OfficeHome";case"SearchSiteScoped":return"Search";default:return}},e.prototype.onRouteChanged=function(e,t){t.querySearchText===e.querySearchText&&t.pathname===e.pathname||this.shellShim.Search.SetSearchText(t.querySearchText?t.querySearchText:""),this.removeAndSetExitSearch()},e.prototype.getOneDriveConvergenceStatusForConsumer=function(){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(t){return[2,this.oneDriveGraphService.getMyDrive().then((function(t){var r=t.webUrl;return!!r&&r.startsWith(e.migratedDriveEndpoint)})).catch((function(){}))]}))}))},e.prototype.getProviderConfigUpdatersForConsumer=function(){var e=[{id:"search",groupCreators:Me(this.searchConfigService.config,this.deviceDetector.isMobileDevice()),groupUpdaters:[this.getFilesProviderUpdaterForConsumer()]}];if(this.searchConfigService.config.enableConsumerSearchExactMatchRanker){var t=Object(o.a)(X);e.push({id:"ranker",rankerUpdatt}})}return e},e.prototype.getProviderConfigUpdaters=function(){var e=[this.getPeopleProviderConfigUpdater(),this.getFilesProviderConfigUpdater(),this.getAppsProviderConfigUpdater()],t=this.searchConfigService.config;return!this.deviceDetector.isMobileDevice()&&t.templateProviderInCommercialEnabled&&t.templatePreviewProviderWithSeeMoreEnabled&&!this.userContextService.user.isGcc&&e.push(this.getTemplatePreviewProviderConfigUpdater()),t.helpProviderInCommercialEnabled&&e.push(this.getHelpProviderConfigUpdater()),e},e.prototype.getHelpProviderConfigUpdater=function(){var e=this;return{id:"helpProviderConfigUpdater",groupCreators:[{groupId:"help",create:function(){return{position:6,optimalCount:2,maxCount:3,providers:[ne],component:ue,heading:e.searchConfigService.config.resources.SearchSuggestionHelpHeading,ariaLabel:e.searchConfigService.config.resources.SearchSuggestionHelpHeading}}}]}},e.prototype.getTemplatePreviewProviderConfigUpdater=function(){var e=this;return{id:"templatePreviewProviderConfigUpdater",groupCreators:[{groupId:"templatePreview",create:function(){return{position:7,optimalCount:4,maxCount:4,providers:[ke],component:_e,heading:e.searchConfigService.config.resources.SearchSuggestionTemplateHeading,ariaLabel:e.searchConfigService.config.resources.SearchSuggestionTemplateHeading}}}]}},e.prototype.getPeopleProviderConfigUpdater=function(){var e=this.documentService.nativeDocument.createElement("div");this.documentService.nativeDocument.body.appendChild(e);var t=this;return{id:"personProviderConfigUpdater",groupUpdaters:[{groupId:"person",createUpdater:function(){return{component:function(r){return function(i){return s.a.createElement(r,Object(n.__assign)(Object(n.__assign)({},i),{onCli)}}))}}}}}]}},e.prototype.getFilesProviderConfigUpdater=function(){var e=this;return{id:"fileProviderConfigUpdater",groupUpdaters:[{groupId:"file",createUpdater:function(){return{providers:function(t){var r=Object(n.__spread)(t);return e.capabilitiesService.capabilities.isPwaInUwp&&r.push(L.a),r},optimalCoue},component:function(t){return function(r){return s.a.createElement(t,Object(n.__assign)(Object(n.__assign)({},r),{onCli)}}))}}}}}]}},e.prototype.getAppsProviderConfigUpdater=function(){var e=new Array;this.workloadsService.getThirdPartyWorkloads().subscribt}));var t=this;return{id:"appProviderConfigUpdater",groupUpdaters:[{groupId:"app",createUpdater:function(){return{component:function(r){return function(i){return s.a.createElement(r,Object(n.__assign)(Object(n.__assign)({},i),{onClick:function(r){r.preventDefault(),t.sharedSearchService.setAppsAutosuggestClick(i,Object(n.__assign)({},r),e)}}))}}}}}]}},e.prototype.getFilesProviderUpdaterForConsumer=function(){var e=this;return{groupId:"file",createUpdater:function(){return{position:function(){return 2},optimalCount:function(){return 2},maxCou5},providers:function(t){var r,i=Object(n.__spread)(t);return e.consumerOneDriveMigrated?(r=i.findIndex((function(e){var t,r;return"searchux.suggestionProvider.provider.bingConsumerDocument"===(null===(r=null===(t=e.prototype)||void 0===t?void 0:t.getId)||void 0===r?void 0:r.call(t))})))>=0&&i.splice(r,1):(r=i.findIndex((function(e){var t,r;return"searchux.suggestionProvider.provider.autosuggestfile"===(null===(r=null===(t=e.prototype)||void 0===t?void 0:t.getId)||void 0===r?void 0:r.call(t))})))>=0&&i.splice(r,1),i},component:function(t){return function(r){return s.a.createElement(t,Object.assign({},Object(n.__assign)({},r),{onClick:function(t){t.preventDefault();var i=l.a.fileTypeFromExtension(r.fileExtension&&"."===r.fileExtension[0]?r.fileExtension.substr(1):r.fileExtension),o=l.a.referralFromFileType(i);e.sharedSearchService.setFilesAutosuggestClick(Object(n.__assign)(Object(n.__assign)({},r),{customLoggingFunction:function(t,r){t&&e.searchInstrumentationService.logSearchClickEvent("File","MSA_Auto_Suggest_File",!0,"File",void 0,o,void 0,void 0,r)},url:r.url,shortUrl:!0}))}}))}}}}}},e.prototype.registerSuggestionProviders=function(){var e=this;Z.a.capabilitiesService=this.capabilitiesService,Z.a.clientStartupConfigService=this.clientStartupConfigService,Z.a.contextService=this.contextService,Z.a.createDocumentService=this.createDocumentService,Z.a.deviceDetector=this.deviceDetector,Z.a.locService=this.locService,Z.a.ngZone=this.ngZone,Z.a.officeRouteService=this.officeRouteService,Z.a.searchConfigService=this.searchConfigService,Z.a.searchInstrumentationService=this.searchInstrumentationService,Z.a.sharedSearchService=this.sharedSearchService,Z.a.shellShim=this.shellShim,Z.a.urlLauncherService=this.urlLauncherService,ne.searchInstrumentedXhrService=this.searchInstrumentedXhrService,ie.searchInstrumentedXhrService=this.searchInstrumentedXhrService,we.buttonText=function(t){return e.locService.format(e.searchConfigService.config.resources.SearchSuggestionTemplateButtonText,t)},we.seeMoreButtonText=function(t){return e.locService.format(e.searchConfigService.config.resources.SearchSuggestionTemplateSeeMoreButtonText,t)},this.capabilitiesService.capabilities.darkModeEnabled&&this.themingService.darkModeSubscription.subscribe((function(e){void 0!==e&&(Z.a.isDarkMode=e)})),this.clientStartupConfigService.config.authType===P.a.MSA&&(Promise.all([this.workloadsService.getProvisionedWorkloads(),this.workloadsService.getAdditionalWorkloads()]).then((function(t){var r=t[0].concat(t[1]);q.a.allApps=r,re.a.commercialApps=e.commercialApps,re.a.commercialApps.initializeCommericalAppList(r)})),this.consumerLearnings.initializeSettingList(this.shellShim),V.getButtonText=function(t){return e.locService.format(e.searchConfigService.config.resources.SearchSuggestionBingButtonText,t)},L.a.capabilitiesService=this.capabilitiesService,L.a.clientStartupConfigService=this.clientStartupConfigService,L.a.contextService=this.contextService,L.a.deviceDetector=this.deviceDetector,L.a.mruDataService=this.mruDataService,L.a.secondaryDisplayTextEnabled=!0,L.a.consumerSearchWdQueryParamsEnabled=this.searchConfigService.config.consumerSearchWdQueryParamsEnabled,L.a.searchInstrumentationService=this.searchInstrumentationService,L.a.sharedSearchService=this.sharedSearchService,z.searchConfigService=this.searchConfigService,te.createFileTypeStringForNarrator=function(t){return e.locService.format(e.searchConfigService.config.resources.SearchSuggestionFileTypeNarratorText,t)},pe.learnings=this.consumerLearnings,ve.getButtonTe)},ye.settings=this.consumerAccountSettings,Ce.getButtonTet})},e.prototype.typeToSearch=function(){var e=this;this.windowService.nativeWindow.addEventListener("keydown",(function(t){return Object(n.__awaiter)(e,void 0,void 0,(function(){var e,r,i,o;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return r=(e=this.documentService.nativeDocument.activeElement)?e.tagName.toLowerCase():"",i=e?e.getAttribute("contenteditable"):null,"input"===r||"textarea"===r||i&&"true"===i.toLowerCase()?[2]:(16!==(o=t.keyCode)&&this.keysDown.add(t.code),1===this.keysDown.size&&(191===o||o>=48&&o<=57||o>=65&&o<=90)?[4,this.shellShimService.getShellShim()]:[3,2]);case 1:n.sent().Search.FocusSearchBo0})),191===o&&t.preventDefault(),n.label=2;case 2:return[2]}}))}))})),this.windowService.nativeWindow.addEventListener("keyup",(function(t){16!==t.keyCode&&e.keysDown.delete(t.code)}))},e.prototype.onSearchBoxActivat)},e.prototype.onConsumerSearchBoxActivated=function(e){var t=this;if(this.deviceDetector.isMobileDevice()||!this.consumerSearchEnterEventAdded&&this.searchConfigService.config.disableSearchEnterPressedAction){var r=document.getElementsByClassName("ms-suiteux-search-box");r&&r[0]&&(r[0].addEventListener("keypress",(function(e){var r=e.key||e.charCode||e.keyCode||0;"input"!==document.activeElement.tagName.toLowerCase()||13!==r&&"Enter"!==r||(t.searchInstrumentationService.setSearchSubmittedAction(),e.preventDefault())})),this.consumerSearchEnterEventAdded=!0)}this.searchInstrumentationService.updateSearchSessionId(),this.searchInstrumentationService.updateSearchText(e)},e.prototype.onConsumerSearchBoxDeactivat)},e.prototype.onConsumerSearchBoxSubmitted=function(e){this.searchInstrumentationService.setSearchSubmittedAction(),0!==(null==e?void 0:e.trim().length)&&this.officeRouteService.navigateTo({route:"ConsumerAllSearch"},!1,{q:e})},e.prototype.onConsumerSearchTextChang)},e.prototype.isSubscribedUser=function(){return Object(n.__awaiter)(this,void 0,void 0,(function(){var e;return Object(n.__generator)(this,(function(t){switch(t.label){case 0:return this.clientStartupConfigService.config.authType!==P.a.MSA?[3,2]:[4,this.consumerInstallConfigService.getCurrentSku()];case 1:return[2,null!==(e=t.sent())&&!(e===h.b.NonActive||e===h.b.NotSubscribed||e===h.b.NotDetected||e===h.b.Perpetual||e===h.b.Perpetual2019)];case 2:return[2,!0]}}))}))},e.migratedDriveEndpoint="https://my.microsoftpersonalcontent.com/personal/",e.ɵprov=i.kc({factory:function(){return new e(i.lc(p.b),i.lc(k.a),i.lc(P.b),i.lc(A),i.lc(w.a),i.lc(U),i.lc(x.a),i.lc(d.a),i.lc(g.c),i.lc(S.a),i.lc(M.a),i.lc(I.a),i.lc(u.a),i.lc(i.F),i.lc(v.a),i.lc(m.a),i.lc(c.a),i.lc(R.a),i.lc(B.a),i.lc(O),i.lc(Le.a),i.lc(f.a),i.lc(C.b),i.lc(b.a),i.lc(_.a),i.lc(y.b),i.lc(T.a),i.lc(N.a))},token:e,providedIn:"root"}),e}())}}(),Ue=Ae{}}(),Re=i.Fb({encapsulation:2,styles:[],data:{l)}var Ne=i.Db("ohp-search-preload",Ae,(function(e){return i.jc(0,[(e()(),i.Hb(0,0,null,null,1,"ohp-search-preload",[],null,null,null,Be,Re)),i.Gb(1,49152,null,0,Ae,[Ee],null,null)],null,null)}),{},{},[]),Fe=r("CCRL"),je=i.Eb(Oe,[],(function(e){return i.Tb([i.Ub(512,i.k,i.hb,[[8,[Ne]],[3,i.k],i.D]),i.Ub(1073742336,Oe,Oe,[]),i.Ub(256,Fe.a,Ue,[])])}))}}]);
//# sourceMappingURL=search-preload.9b34835d5517abc36ddb.chunk.v7.js.map