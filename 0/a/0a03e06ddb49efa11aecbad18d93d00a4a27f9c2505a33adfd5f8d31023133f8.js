/* EverydayHealthConfig GptMeasurement HouseHold ImplementationValidator LegacyLayer SignalsAutoInsertion SignalsBsc SignalsIds SignalsTvp SignalsVlp */
(()=>{var ge=Object.defineProperty,Yr=Object.defineProperties,Kr=Object.getOwnPropertyDescriptor,Hr=Object.getOwnPropertyDescriptors;var Qt=Object.getOwnPropertySymbols;var Ne=Object.prototype.hasOwnProperty,Le=Object.prototype.propertyIsEnumerable;var le=A=k=i=var Fe=var a=var c=var E=var $t={queueAdRequest:defineSlot:getTargeting:;var de=i(de,"Core");var qt=de;var ce=[],ue=ce;var d=i("moduleClass"),B=i("attachModule"),C=i((o,t)=>{var e;o.executeConfig=(e=o.executeConfig)!=null?e:[],o.executeConfig.push({method:t})},"executeMethod"),p=i("pluginMethod"),yt=i("apiMethod"),ke=i("errorMethod");var zt=["BSC","ABS"],Be=["IDS"],wt=["VLP","TVP"],Jr=[...zt,...Be,...wt],qe=i(o=>Jr.includes(o.toUpperCase()),"isSignal"),Ge=i(o=>wt.includes(o.toUpperCase()),"isSlotSignal"),Ve=i(o=>Be.includes(o.toUpperCase()),"isUserSignal"),je=i("isPageSignal");var me=i(me,"AsyncQueue");var Wt=me;var I=i(I,"AdRequestQueue"),a([yt("queueAdRequest")],I.prototype,"_queueAdRequest",1),I=a([d],I);var Yt,Xr=new Uint8Array(16);(pe,"rng");var M=[];for(let o=0;o<256;++o)M.push((o+256).toString(16).slice(1));(Qe,"unsafeStringify");var Zr=typeof crypto!="undefined"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),fe={randomUUID:Zr};(to,"v4");var Se=to;var St=i("uuid");var he=i(he,"Slot");var Gt=he;var eo={getTargeting:()=>[],setTargeting:()=>{}},_=i(_,"SlotStore"),_=a([d],_);var ro=[[/((\?)|&)(?:amp_lite|fr=operanews)/g,"$2"],[/(^https?:\/\/)(www\.)/g,"$1"],[/(((\?)|&|%3F|%26|;)(?:utm_campaign|utm_source|utm_content|utm_term|utm_viral|utm_medium|utm_identifier|utm_key|fb_source|referrer|referer|ref|rand|rnd|randid|\.?rand|\.?partner|cb|count|adid|session|sessionid|session_redirect|param\d|userinfo|uid|refresh|ocid|ncid|clickenc|fbclid|amp_js_v|amp_gsa|ns_source|ns_campaign|ns_mchanel|ns_mchannel|ns_linkname|ns_fee|src|ex_cid|usqp|source|xid|trkid|utm_social-type|mbid|utm_brand|__twitter_impression|utm_referrer|CMP|cmp|_cmp|cq_cmp)=[^&]*)/g,"$3"],[/[/.]amp(?:\/[?&]*)?$/g,""],[/((\?)|&)(?:outputType|isFollow|suppressMediaBar|cid|ICID|icid|bdk|wtu_id_h|utm_placement|intcmp|_native_ads|traffic_source|entry|\.tsrc|autoplay|autostart|dc_data|influencer|pubdate|utm_hp_ref|redirect|service|refresh_ce|refresh_cens|xcmg|target_id|_amp)=[^&]*/g,"$2"],[/(\?|&)(?:amp)(?:&|$|=[^&]*)/g,"$1"]],oo=[[/(?:\/|\/\?|\?|&|\/\$0|#[\s\S]*)+$/g,""],[/(?:\/|\/\?|\?|&|\/\$0|#[\s\S]*)+$/g,""]],$e=i("replaceByRules"),ze=i("normalizeUrl");var We=i("stripUrlQuery");var Ye=i("parseInfo"),Ke=i("parseLegacyPagetagUrl");var no=/^\/dvtag\/([^/]+)\/([^/]+)\/pub\.js$/,v=i(v,"Context"),a([C],v.prototype,"_initialize",1),v=a([d],v);var L=i(L,"DefinedVariables"),L=a([d],L);var V=i(V,"Fetch"),V=a([d],V);var Kt=i("getPositionSuffix");var io=/^(\d+)x(\d+)$/,He=i("stringToSlotSizes"),Te=i("slotSizesToString"),Je=i("slotSizesToStringIfSpecific");var Ee="https://pub.doubleverify.com/dvtag/signals/",j=i(j,"SignalsUrlBuilder"),j=a([d],j);var ht=i(ht,"PageSignals"),ht=a([d],ht);var Tt=i(Tt,"SlotSignals"),Tt=a([d],Tt);var Et=i(Et,"UserSignals"),Et=a([d],Et);var b=i(b,"Signals"),a([C],b.prototype,"_initialize",1),a([p(I,"adRequestQueued")],b.prototype,"_onAdRequestQueued",1),a([p(_,"slotDiscovered")],b.prototype,"_onSlotDiscovered",1),b=a([d],b);var Ct=class{_getEnabledSignals(){return"IDS"}};i(Ct,"SignalsIds"),a([p(b,"getEnabledSignals")],Ct.prototype,"_getEnabledSignals",1),Ct=a([d],Ct);var It=class{_getEnabledSignals(){return"BSC"}};i(It,"SignalsBsc"),a([p(b,"getEnabledSignals")],It.prototype,"_getEnabledSignals",1),It=a([d],It);var Ot=class{_getEnabledSignals(){return"VLP"}};i(Ot,"SignalsVlp"),a([p(b,"getEnabledSignals")],Ot.prototype,"_getEnabledSignals",1),Ot=a([d],Ot);var Ut=i(Ut,"SignalsTvp"),a([p(b,"getEnabledSignals")],Ut.prototype,"_getEnabledSignals",1),Ut=a([d],Ut);var Pt=i("parseSlotSizes"),Xe=i("parseSlotSize");var Ze=i("getGptSlotSize");var so="dvp_spos",Ht=i("gptSlotToAdUnit");var Jt=i("gptSlotToTargetable");var Q=i(Q,"LegacyPq"),Q=a([d],Q);var R=i(R,"Environment"),R=a([d],R);var tr="https://vtrk.doubleverify.com";var er=i("randomInt");var _e="qt_loaded",rr="pts_pid",or="pts_sid",Ae=i(Ae,"QtError");var Xt=Ae;var nr=i("formatSlotTargetingForTracking");var ir=i("getCacheStatus");var Re=i("summarizeSlotTargeting");var _t=i("timeSpan");var be=i(be,"PendingEvent");var Zt=be;var ao=5,lo=["ids","bsc","vlp"],ot=i(ot,"LegacyTracking"),ot=a([d],ot);var sr=i("parseLegacyAdUnit");var ar=i("setUserTargetingOnPts"),lr=i("setPageTargetingOnPts"),gr=i("setSlotTargetingOnPts");var go={loadSignals:"load-signals",getTargeting:"load-signals",loadSignalsForSlots:"load-signals-slots"},co="legacy-api",dr="gpt",W=i(W,"LegacyLayer"),a([C],W.prototype,"_initialize",1),a([p(ot,"getLegacyType")],W.prototype,"_getLegacyType",1),a([p(b,"userTargetingUpdated")],W.prototype,"_setUserTargetingOnPts",1),a([p(b,"pageTargetingUpdated")],W.prototype,"_setPageTargetingOnPts",1),a([p(b,"slotTargetingUpdated")],W.prototype,"_setSlotTargetingOnPts",1),W=a([d],W);var te="gpt",cr="gpt-slot-reference",uo=["impressionViewable","slotOnload","slotVisibilityChanged","rewardedSlotGranted","rewardedSlotClosed","rewardedSlotReady","slotRequested","slotRenderEnded","slotResponseReceived"],y=i(y,"Googletag"),a([C],y.prototype,"_initialize",1),a([p(I,"adRequestQueued")],y.prototype,"_onAdRequestQueued",1),a([p(_,"slotDiscovered")],y.prototype,"_onSlotDiscovered",1),a([p(_,"slotDestroyed")],y.prototype,"_onSlotDestroyed",1),a([p(y,"slotRequested")],y.prototype,"_onSlotRequested",1),y=a([d],y);var ve=i("getGreenlightSignal");var J=i(J,"SignalsAutoInsertion"),a([C],J.prototype,"_autoInsertPageId",1),a([p(_,"slotDiscovered")],J.prototype,"_autoInsertSlotId",1),a([p(b,"userTargetingUpdated"),p(b,"pageTargetingUpdated")],J.prototype,"_autoInsertGlobalTargeting",1),a([p(b,"slotTargetingUpdated")],J.prototype,"_autoInsertSlotTargeting",1),J=a([d,B(y)],J);var ur=["GPT_MEASUREMENT","CREATIVE_WRAPPER","MEASUREMENT_INJECTION_TIMING","MEASUREMENT_INJECTION_STRATEGY","F9_AD_LOCATORS_SEPARATE_TASKS","AD_CONTAINER_LOCATION_STRATEGY"],mr={GPT_MEASUREMENT:["off","on"],CREATIVE_WRAPPER:["off","on"],MEASUREMENT_INJECTION_TIMING:["onAdRendered (deprecated)","onAdLoaded (deprecated)"],MEASUREMENT_INJECTION_STRATEGY:["rootPage (deprecated)","preferPiggyback (deprecated)"],F9_AD_LOCATORS_SEPARATE_TASKS:["off (deprecated)","on (deprecated)"],AD_CONTAINER_LOCATION_STRATEGY:["preferGptIframe (deprecated)","preferGptDiv (deprecated)","preferGptIframeBody (deprecated)","preferCwSpan (deprecated)"]};var f=i(f,"Logging"),f=a([d],f);var De={GPT_MEASUREMENT:"off",CREATIVE_WRAPPER:"on",MEASUREMENT_INJECTION_TIMING:"onAdRendered (deprecated)",MEASUREMENT_INJECTION_STRATEGY:"preferPiggyback (deprecated)",F9_AD_LOCATORS_SEPARATE_TASKS:"on (deprecated)",AD_CONTAINER_LOCATION_STRATEGY:"preferGptIframeBody (deprecated)"},mo={featureFlags:De,weight:1},ee={variations:[mo],adServers:{}};var x=i(x,"ConfigModule"),x=a([d],x);var po=i("scaledRandom"),pr=i("weightedRandom");var Y=i(Y,"VariationsModule"),a([C],Y.prototype,"_initialize",1),Y=a([d],Y);var F=i(F,"FeatureFlags"),F=a([d],F);var fr="gpt-measurement-slot-params",O=i(O,"MeasurementUrlParams"),O=a([d],O);var nt=i(nt,"BuildTracking"),a([C],nt.prototype,"_trackBuildData",1),nt=a([d],nt);var ye=i("stateToString");var Sr=i("createScriptElement");var re=i("addElement"),hr=i("removeElement");var Vt=i("setAttributeIfDefined");var Tr=i("setIframeContent"),Er=i("createIframe"),jt=i("getIframeDocument"),Nt=i("getIframeDocumentBody"),At=i("isCrossOriginIframe");var fo="google_ads_iframe_",Z=i("lookupGptIframe");var it=i(it,"GoogletagIframeOnload"),a([p(y,"slotRenderEnded")],it.prototype,"_setIframeOnloadCallback",1),it=a([d],it);var st=i(st,"GoogletagInferredEvents"),a([p(y,"googletagSlotDiscovered")],st.prototype,"_detectSlotEmptied",1),st=a([d],st);var Lt=i("getNetworkCodeFromSlot");var _r=i("parseSlotRenderEndedEvent"),Ar=i("parseSlotResponseReceivedEvent");var So={targetingSetForSlot:"targeted",disableMeasurementForSlot:"disabled"},ho={adRequestedForSlot:"measurable"},To={measurementInjected:"measured"},Eo={adRequestedForSlot:"measurable"},_o={empty:So,targeted:ho,measurable:To,measured:Eo,disabled:{}},ne=i("updateState"),Ao=i("transition");var vo={adRequestedForSlot:"adRequested",newSlotDetected:"new"},Do={adRequestedForSlot:"adRequested",adReceivedForSlot:"adPending",slotEmptied:"adRequested"},yo={adRequestedForSlot:"adRequested",adEmptyForSlot:"adEmpty",adRenderedForSlot:"adRendered",slotEmptied:"adPending"},Co={adRequestedForSlot:"adRequested",adLoadedForSlot:"adLoaded",slotEmptied:"adEmpty"},Io={adRequestedForSlot:"adRequested",slotEmptied:"adEmpty"},Oo={adRequestedForSlot:"adRequested"},Uo={new:vo,adRequested:Do,adPending:yo,adRendered:Co,adLoaded:Io,adEmpty:Oo},Rr=i("transitionState"),xo=i("transition"),wo=i("updateMeasurementState");var br="gpt-measurement-slot-state",vr="gpt-measurement-creative",D=i(D,"SlotStateStore"),a([p(y,"googletagSlotDiscovered")],D.prototype,"_onGoogletagSlotDiscovered",1),a([p(y,"slotRequested")],D.prototype,"_onAdRequestedForSlot",1),a([p(y,"slotResponseReceived")],D.prototype,"_onSlotResponseReceived",1),a([p(y,"slotRenderEnded")],D.prototype,"_onSlotRenderEnded",1),a([p(y,"slotOnload")],D.prototype,"_onSlotOnload",1),a([p(it,"iframeOnload")],D.prototype,"_onSlotIframeOnload",1),a([p(st,"slotEmptied")],D.prototype,"_onSlotEmptied",1),D=a([d],D);var at=i(at,"DuplicateMeasurement"),a([p(D,"newSlot")],at.prototype,"_scheduleTargetingIfNeeded",1),at=a([d],at);var yr="gpt-measurement-impression-count",Cr="gpt-measurement-url-params",$=i($,"ImpressionTopology"),a([p(D,"newSlot")],$.prototype,"_onNewSlotDetected",1),a([p(D,"adRequestedForSlot")],$.prototype,"_adRequestedForSlot",1),$=a([d],$);var Rt=i(Rt,"LocateGptIframe"),Rt=a([d],Rt);var tt=class{getAdContainer(t,e){let r=this.core.get(R).getDocument().getElementById(t.elementId);return r==null?{element:null,type:0}:this.core.get(Rt).locate(r,e.preferBody)}};i(tt,"SlotAdLocator"),tt=a([d],tt);var Or="gptm";var lt=i(lt,"GptmCustomContext"),a([C],lt.prototype,"_trackOriginalValues",1),lt=a([d],lt);var Ur=i("truncate");var Mo="104",xr=i("getAdServerTracking");var bt=i(bt,"TargetingCustomTracking"),bt=a([d],bt);var vt=i(vt,"CustomMetadataTracking"),vt=a([d],vt);var wr=i("getCwTracking");var Mr=["hb_pb","hb_adid","hb_bidder","hb_size","hb_format","hb_deal","hb_uuid","hb_cache_id","hb_cache_host","hb_cache_path","hb_source","hb_adomain","hb_env"],Po=i("hasAtLeastOnePrebidTargetingConfigured"),Pr=i("getPrebidTracking");var Nr=i("getLocatedElementTracking");var ie=i("parseCreativeSize");var Lr=i("getQtTracking");var Fr=i("getAsQueryString");var No="data-dv-gptm-ad-container",Lo="dv-gptm-",Ie=i("getAdContainerMarker"),kr=i("markAdContainer");var Br=i("lookupCwSpan");var qr=i((o,t)=>{if(o==null)return!1;let e=Z(o);return!(e==null||At(e,t))},"canDetectCreativeWrapper"),Gr=i(o=>{let t=Nt(o);return Br(t)!==null},"isCreativeWrapperPresentInIframe");var Vr=i("escapeRegExp");var Fo=["embed","object","link","img","span","iframe","div","canvas","svg"],Oe=i("formatForBtreg"),jr=i("getBtParamsForAdContainer");var ko="https://cdn.doubleverify.com/dvtp_src.js",Dt=class{sCreativeWrapperPresent(t){let e=this.core.get(R).getWindow(),r=this.core.get(R).getDocument().getElementById(t.elementId);if(qr(r,e)===!1)return null;let n=Z(r);if(n==null)throw new Error("Gpt iframe not found");return Gr(n)}_getAdditionalTrackingParams(t,e,r){let n=Lr(t,e,this.core.get(v).getVisitUuid()),s=A(A({},xr(t,this.core.get(x).getConfiguration())),this.core.get(vt).trackCustomMetadata(t)),l=A(A(A(A(A({dvp_uptseid:this._truncateElementId(t.elementId)},Pr(t)),wr(this._isCreativeWrapperPresent(t))),Nr(r)),this.core.get(O).getGlobalParams()),this.core.get(O).getSlotParams(t));return A(A(A({},n),s),l)};i(Dt,"MeasurementScriptTag"),Dt=a([d],Dt);var et=class{constructorddMeasurement(t){if(!this.canUseStrategy(t))return this.core.get(f).info(`Slot ${t.elementId} can't be measured using ${this.injectionStrategyName}`),!1;try{this._trackStrategy(t);let e=this.locateAdContainer(t),r=this._createMeasurementScriptTag(t,e);this.inject(r,t)}catch(e){return this.core.get(f).error(`Error adding measurement to slot ${t.elementId} using ${this.injectionStrategyName}`),!1}return this.core.get(f).info(`Start measuring slot ${t.elementId} using ${this.injectionStrategyName}`),!0},"MeasurementInjectionBase"),et=a([d],et);var Ue="gpt-measurement-iframe-element",gt=class extends et{constructor(){super(...arguments);c(this,"injectionType",0);c(this,"injectionStrategyName","iframe wrapper")}addMeasurement(e){return super.addMeasurement(e)}ocateAdContainer(e){return this.core.get(tt).getAdContainer(e,{preferBody:!1})};i(gt,"IFrameWrappedMeasurement"),gt=a([d],gt);var Qr=i("canPiggyBackMeasurement"),xe=i("getGptIframe");var dt=class extends et{ddMeasurement(e){return super.addMeasurement(e)}cateAdContainer(e){return this.core.get(tt).getAdContainer(e,{preferBody:!0})};i(dt,"PiggybackMeasurement"),dt=a([d],dt);var ct=i(ct,"VariationTracking"),a([p(Y,"variationSelected")],ct.prototype,"_trackSelectedVariation",1),ct=a([d],ct);var ut=class{aybeAddMeasurementOnSlot(t,{measurementState:e}){if(!this._isEligibleForMeasurement(e))return;let r=this.core.get(dt).addMeasurement(t);r||(r=this.core.get(gt).addMeasurement(t)),r?this.core.get(D).updateStateWithEvent(t,"measurementInjected"):this.core.get(f).info(`Measurement injection completely failed for slot ${t.elementId}`)};i(ut,"GptMeasurement"),a([C],ut.prototype,"_trackActivationPath",1),a([p(D,"adRenderedForSlot")],ut.prototype,"_maybeAddMeasurementOnSlot",1),a([p(D,"adRequestedForSlot"),p(D,"adEmptyForSlot")],ut.prototype,"_maybeRemoveMeasurementOnSlot",1),ut=a([d,B(nt),B($),B(ct),B(at)],ut);var $r=[{featureFlags:{GPT_MEASUREMENT:"on",CREATIVE_WRAPPER:"off"},weight:5},{featureFlags:{GPT_MEASUREMENT:"on",CREATIVE_WRAPPER:"on"},weight:45},{featureFlags:{GPT_MEASUREMENT:"off",CREATIVE_WRAPPER:"on"},weight:950}];var zr="21184944",xt=class{_provideConfig(t){return t!==zr?(this.core.get(f).error(`Invalid ctx provided for EverydayHealthConfig, got ${t}, expected ${zr}`),{}):{variations:$r,settings:{GPT_MEASUREMENT_OVERRIDE_CTX:"818052",GPT_MEASUREMENT_OVERRIDE_CMP:"DV1168644"},adServers:{4213:{adServerId:37,customTracking:{c1:{type:"targeting",key:"src"},c2:{type:"targeting",key:"pos"},c3:{type:"targeting",key:"slot"},c4:{type:"targeting",key:"ct"}}}}}}};i(xt,"EverydayHealthConfig"),a([p(x,"provideConfig")],xt.prototype,"_provideConfig",1),xt=a([d],xt);var q={TYPE:"b1",COMMIT_HASH:"b2",ENTRY_MODULES:"b3",HOSTNAME:"b4",CTX:"b5",CMP:"b6",VISIT_ID:"b7",FEATURE_FLAGS:"b8",SAMPLE_INTERVAL:"d1",FLUSH_TO_PXSRV:"d2",_PLACEHOLDER_BLOB_9:"b9",_PLACEHOLDER_BLOB_10:"b10",_PLACEHOLDER_DOUBLE_3:"d3",_PLACEHOLDER_DOUBLE_4:"d4",_PLACEHOLDER_DOUBLE_5:"d5"},se=k(A({},q),{LOG_LEVEL:"b11",MESSAGE:"b12",TRACE:"b13"}),ae=k(A({},q),{AD_REQUEST_STATUS:"b11",AD_REQUEST_INDEX:"d6",AD_REQUEST_DELAY:"d7"});var qo="https://pub.doubleverify.com/dvtag/metrics/event.png",Go=1,Vo=1,z=i(z,"Events"),a([p(I,"adRequestCompleted")],z.prototype,"_onAdRequestCompleted",1),a([ke],z.prototype,"_handleError",1),z=a([d],z);var P=((P||{}),jo=1e-4,Qo=5e3,$o=5,we="adRequestFirstSeen",Wr="wasReady",Me="isReady",G=i(G,"ImplementationValidator"),a([C],G.prototype,"_initialize",1),a([p(I,"adRequestQueued")],G.prototype,"_onAdRequestQueued",1),a([p(_,"slotScanned")],G.prototype,"_onSlotScanned",1),a([p(I,"adRequestCompleted")],G.prototype,"_onAdRequestCompleted",1),a([p(_,"slotRequested")],G.prototype,"_onSlotRequested",1),G=a([d],G);var mt=i(mt,"CommandBuffer"),a([C],mt.prototype,"_initialize",1),mt=a([d],mt);var Pe="api",pt=i(pt,"DefineSlot"),a([yt("defineSlot")],pt.prototype,"_defineSlot",1),pt=a([d],pt);var ft=i(ft,"GetTargeting"),a([yt("getTargeting")],ft.prototype,"_getTargeting",1),ft=a([d],ft);var Ft=i(Ft,"HouseHold"),Ft=a([d,B(I),B(mt),B(pt),B(ft),B(z)],Ft);if(window.dvtag==null||window.dvtag._core==null)try{new qt(ue,window)}catch(o){}})();
