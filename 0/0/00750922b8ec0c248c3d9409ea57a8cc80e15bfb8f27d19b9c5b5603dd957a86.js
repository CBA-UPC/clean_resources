(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[60146],{337708:t=>{t.exports={}},347455:t=>{t.exports={}},905183:t=>{t.exports={}},101426:t=>{t.exports={}},12630:t=>{t.exports={}},938897:329221:153579:642949:504637:(t,e,i)=>{"use strict";i.d(e,{template:()=>o});var s=i(634527);const o='<div data-id="{{chartId}}" class="tv-widget-chart-like-button apply-common-tooltip {{typeClass}}" title="{{titleTooltip}}"><span class="tv-widget-chart-like-button__icon-place">'+s+'</span><span class="js-likes-counter"></span></div>'},33070:(t,e,i)=>{"use strict";i.d(e,{WidgetBanner:()=>_,WidgetSource:()=>s});var s,o=i(50959),a=i(497754),n=i.n(a),r=i(83436),h=i(201465),l=i(897782),d=i(49437),c=i(776734),u=i(444372),p=i(663346),g=i.n(p),m=i(153579);function _(t){const{text:e,icon:a,buttonText:c,storageKey:p,source:_,placement:f,bridge:b,onActionClick:w,widgetIsVisible:y}=t,[C,S]=(0,o.useState)(();(0,o.useEffect)((()=>{C&&(f===s.Streams||y)&&T();const t=()=>{const t=null==b?void 0:b.visible.value();C&&t&&T()};return null==b||b.active.subscribe(t),()=>null==b?void 0:b.active.unsubscribe(t)}),[y,C]);const M=n()(m.defaultBanner,{[m.mindsBanner]:_===s.Minds});return o.createElement(o.Fragment,null,C&&o.createElement("div",{className:M},o.createElement(l.NavButton,{icon:g(),size:"xsmall",className:m.closeIcon,"aria-label":u.t(null,{context:"action"},i(768508)),onClick:),o.createElement(r.Icon,{icon:a,className:m.icon}),o.createElement("p",{className:m.text},e),o.createElement(h.RoundButton,{size:"medium",variant:"quiet-primary",className:n()(m.button,m.buttonHover),onClick:()=>{w&&w(),v("click",p.toLowerCase(),f)}},c)));function T(){v("show",p.toLowerCase(),f)}}async function v(t,e,i){var s;const o=window.is_authenticated?null!==(s=window.user.pro_plan)&&void 0!==s?s:"free":"visitor",a=await(0,c.getTracker)();a&&a.trackToastDialog(e,t,e,i,o)}!s||(s={}))},155040:(t,e,i)=>{"use strict";var s=i(262078).pushStreamMultiplexer,o=i(226722).TVXWindowEvents,a=i(345848).trackEvent,n=function(){var t="tvdesktopnotifications.",e="tabs-hidden";o.on("desktop-notification-tab-visibility-request",(function(){"true"===TVLocalStorage.getItem(t+e)&&TVLocalStorage.setItem(t+e,document.hidden)}));function i(t){var e=t.split("\n");return e.length>1&&(t=e[0]),((t=t.trim()).length>30||e.length>1)&&(t=t.substring(0,30)+"..."),t}unction r(t){var e=n();"granted"===e&&"function"==typeof t?t():"default"===e&&window.Notification.requestPermission((function(e){
"granted"===e&&"function"==typeof t&&t()}))}return window.Notification?{show:function(h,l,d,c){s.ownPushStream()&&(a("Desktop Notifications","Notification Show Attempt"),"denied"!==n()&&r((function(){TVLocalStorage.setItem(t+e,document.hidden),o.emit("desktop-notification-tab-visibility-request"),setTimeout((function(){"false"!==TVLocalStorage.getItem(t+e)&&document.hidden?(function(t,e,s,o,n){var r=new window.Notification(t,{body:i(e),icon:s||"/static/images/desktop-notification.png"});r.onclick=function(){window.focus(),"function"==typeof o&&(n&&a.apply(null,["desktop-notification-interaction"].concat(n)),o())},setTimeout(r.close.bind(r),5e3)}(h,l,d,c),a("Desktop Notifications","Notification Show Success")):a("Desktop Notifications","Notification Show Tab Visible")}),100)})))},askPermission:r}:{show:function(){},askPermission:function(){}}}();t.exports=n},421448:(t,e,i)=>{"use strict";i.r(e),i.d(e,{DEFAULT_SOUNDS:()=>C,alertSounds:()=>T,availableSounds:()=>S,enableAlertSoundsForMobile:()=>A,enableForMobile:()=>I,isPlaying:()=>k,onStopped:()=>x,play:()=>$,stop:()=>R});var s=i(444372),o=i(314802),a=i(201089),n=i(129025);const r=i.p+"alarm_clock.ba219c712b5dce956b08.mp3",h=i.p+"beep_beep.cddbb5d281594d0b4b8d.mp3",l=i.p+"alert_calling.205c6b5ccb0a10decbc1.mp3",d=i.p+"chat_calling.067c844a001001872f78.mp3",c=i.p+"call.6d2888370f40fbb8cd8d.mp3",u=i.p+"chirpy.bcc136ad76d4496efe29.mp3",p=i.p+"fault.ca1f77478c28a528be67.mp3",g=i.p+"fired.aaee45a643068df3a94b.mp3",m=i.p+"hand_bell.bd1c77bbd21a64aa4fe8.mp3",_=i.p+"hangup.0a486c8d934145d68c11.mp3",v=i.p+"message.c44275a460737d0d50ff.mp3",f=i.p+"notification.01a81746825289ed9423.mp3",b=i.p+"popup.184287feaec7efccbb27.mp3",w=i.p+"3_notes_reverb.dc905347b1eda03c1db2.mp3",y=(0,a.getLogger)("Lib.Sound",{color:"#dea433"}),C={sound:"notification/notification",alert:"alert/fired"},S=[{title:s.t(null,void 0,i(792586)),path:"alert/alarm_clock",soundForAlerts:!0,filePath:r}];S.unshift({path:C.sound,title:s.t(null,void 0,i(204329)),common:!0,filePath:f},{title:s.t(null,void 0,i(274471)),path:"chat/message",filePath:v,common:!0},{title:s.t(null,void 0,i(307769)),path:"chat/popup",filePath:b,common:!0},{title:s.t(null,void 0,i(514561)),path:"chat/call",filePath:c},{title:s.t(null,void 0,i(74210)),path:"chat/calling",filePath:d},{title:s.t(null,void 0,i(719791)),path:"chat/hangup",filePath:_},{title:s.t(null,void 0,i(7246)),path:C.alert,filePath:g,soundForAlerts:!0},{title:s.t(null,void 0,i(829406)),path:"alert/3_notes_reverb",filePath:w,soundForAlerts:!0}),S.push({title:s.t(null,void 0,i(476002)),path:"alert/beep_beep",filePath:h,soundForAlerts:!0},{title:s.t(null,void 0,i(115390)),path:"alert/calling",filePath:l,soundForAlerts:!0},{title:s.t(null,void 0,i(114579)),path:"alert/chirpy",filePath:u,soundForAlerts:!0},{title:s.t(null,void 0,i(926559)),path:"alert/fault",filePath:p,soundForAlerts:!0},{title:s.t(null,void 0,i(120021)),path:"alert/hand_bell",filePath:m,soundForAlerts:!0});const M={};function T(){return S.filter((t=>!!t.soundForAlerts))}function $(t=C.sound,e){if((0,
o.isOnMobileAppPage)("any"))return Promise.resolve();y.logNormal(`Sound play attempt for "${t}" duration-${e||0}s;`);return B(t).play(e)}function R(t,e=!1){if((0,o.isOnMobileAppPage)("any"))return;let i=[];t?i.push(B(t)):i=Object.values(M),i.forEach(()}function x(t,e){(0,o.isOnMobileAppPage)("any")||B(t).playing.subscribe((,{once:!0})}function k(t){return!(0,o.isOnMobileAppPage)("any")&&B(t).playing.value()}function A(){I(T().map((t=>t.path)))}function I(t){if((0,o.isOnMobileAppPage)("any"))return;if(!t)return;if(!/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi/i.test(window.navigator.userAgent))return;if(Array.isArray(t)||(t=[t]),0===(t=t.filter((t=>{const e=B(t);return!(!e||!e.el.load||e._mobilePreloadActive)&&(e._mobilePreloadActive=!0,!0)}))).length)return void y.logNormal("enableForMobile no sounds passed");const e=()=>{const s=[];Array.isArray(t)&&t.forEach((t=>{const e=B(t);e.el.load();const i=e.play().catch((t=>{if("AbortError"!==t.name)throw y.logError(`enableForMobile for "${e.el.src}" preload error: - ${t.message}`),t}));e.el.pause(),s.push(i)})),Promise.all(s).then((()=>{y.logNormal("enableForMobile sounds initialized")})),i.forEach((t=>{document.removeEventListener(t,e,!0)}))},i=["click","touchend","keydown"];i.forEach(()}const B=t=>{if(t in M)return M[t];y.logNormal(`requested sound  ${t} not cached, building a new audio element`);const e=S.find((e=>e.path===t));if(void 0===e)throw new Error(`Cannot find sound "${t}"`);const i=new Audio(e.filePath),s={el:i,playing:new n.WatchedValue(!1),play:(e=0)=>s.playing.value()?(y.logNormal("sound already playing"),Promise.reject("already playing")):(s.playing.setValue(!0),new Promise(((i,o)=>{let a=e>0;const n=()=>{const e=function(t){try{y.logNormal(`"${t.el.src}" triggering html5 play method, readyState - ${t.el.readyState}; muted - ${t.el.muted}; volume - ${t.el.volume}; currentTime - ${t.el.currentTime}`);let e=t.el.play();return e||(e=Promise.resolve()),e}catch(e){return y.logError(`play method for "${t.el.src}" catch error - ${e.message}`),Promise.reject(e)}}(s);e.catch((e=>{y.logNormal(`stop counting sound "${t}"; as playing due to an error: ${e.message}`),s.stop(),o(e)}))};s._onEnded=s.el.addEventListener("ended",s._onEnded),a&&setTimeout((()=>{y.logNormal(`"${t}" repeat timeout - ${e}s off`),a=!1}),1e3*e),n()}))),stop:(t=!1)=>{s.el.pause(),t&&(s.el.currentTime=0),s.playing.setValue(!1),s._onEnded&&s.el.removeEventListener("ended",s._onEnded)}};M[t]=s;return["canplaythrough","error"].forEach((e=>{i.addEventListener(e,(,!1)})),y.logNormal(`canPlayType - ${i.canPlayType("audio/mp3")}`),M[t]};I(S.filter(().map(())},903974:(t,e,i)=>{"use strict";i.d(e,{getBadgeAccountNameWithoutFeaturedBroker:()=>r,renderBadgeAccountWithoutFeaturedBroker:()=>n});var s=i(970704),o=i(461495),a=i(527800);function n(t,e){const{badges:i,size:s,getTitle:o,getLink:n,isShort:h}=e,l=r(i);l&&(0,
a.renderBadgeAccount)(t,{name:l,title:o&&o(i),href:n&&n(l),size:s,isShort:h})}function r(t){const e=t.filter(();return(0,o.getBadgeAccountName)(e)}},296633:(t,e,i)=>{"use strict";i.d(e,{convertToBadgeAccountProps:()=>l});i(586463);var s=i(444372),o=i(781014),a=i(255453);const n=s.t(null,void 0,i(150522)),r=s.t(null,void 0,i(619449)),h=s.t(null,void 0,i(278903));function l(t){if(Array.isArray(t.badges))return t.badges;const e=[];return t.is_pine_wizard&&e.push({name:"pine_wizard",verbose_name:r}),t.is_tradingview_wizard&&e.push({name:"tradingview_wizard",verbose_name:h}),t.is_featured&&e.push({name:o.BadgeBrokerNames.BrokerExtraFeatured,verbose_name:""}),t.broker_plan&&e.push({name:`broker:${t.broker_plan}`,verbose_name:""}),t.is_moderator&&!t.hide_mod_badge&&e.push({name:"moderator",verbose_name:n}),t.is_pro&&t.pro_plan&&e.push({name:`pro:${t.pro_plan}`,verbose_name:(0,a.getPlanName)(t.pro_plan)}),e}},607509:(t,e,i)=>{"use strict";var s;i.d(e,{ACTION_ID:()=>s}),s||(s={}))},432369:(t,e,i)=>{"use strict";var s=i(823127),o=i(791325).ESC,a=i(541558).guid,n=i(778785).mobiletouch,r=i(351290).getRootOverlapManager;i(12630);var h=function(t,e,l){var d,c,u=".popup-menu";t=s(t),(l=l||{}).activeClass=l.activeClass||"",d=(l.event||"click")+u,l.hideEvent&&(c=l.hideEvent+u);var p=function(){},g=p,m={},_=function(d,u,_){var v=a(),f=d.target.ownerDocument,b=f.defaultView,w=r(f),y=u||e;if("function"==typeof y&&(y=y()),s(this).hasClass("open")||s(this).hasClass("active"))return d.preventDefault(),g(),void(E=m.scrollTop);function C(e){var i=s(e.target).parents().andSelf();i.is(T)||i.is(t)||i.is(".charts-popup-tab-headers, .charts-popup-itemheader")||g()}function S(t){if(m.preventFirstProcessClick)m.preventFirstProcessClick=!1;else{var e=s(t.target).parents().andSelf();e.is(".charts-popup-tab-headers, .charts-popup-itemheader")||l.notCloseOnButtons&&e.is(".icon-delete")||g()}}=function(){m.scrollTop=T.scrollTop(),T.remove(),w.removeWindow(v),t.removeClass("active open "+l.activeClass),t.data("popup-menu",null),s(f).off("click",S),s(f).off("mousedown",C),n&&s(f).off("touchstart.chartgui",C),s(f).off("selectstart..popup-menu"),f.removeEventListener("keydown",M,!1),g=p,l.onRemove&&l.onRemove()},t.addClass("active open "+l.activeClass);var T=s('<div class="charts-popup-list">');l.addClass&&T.addClass(l.addClass),l.zIndex&&T.css("z-index",l.zIndex);var $=T;function R(e,o,a){if(e instanceof h.TabGroup){if(!e.tabs||!e.tabs.length)return;if(1===e.tabs.length&&!e.tabs[0].title)return void s.each(e.tabs[0].items,(function(){R(this,void 0,a)}));var n=s('<div class="charts-popup-tab-group"></div>').appendTo(a),r=s('<div class="charts-popup-tab-headers"></div>').appendTo(n),d=null;s.each(e.tabs||[],(function(t,i){if(i.items&&i.items.length){var o=s('<div class="charts-popup-tab"></div>').hide().appendTo(n);s.each(i.items,(function(){R(this,void 0,o)}));var a=s('<span class="charts-popup-tab-header">').append(s('<a href="javascript://" class="charts-popup-tab-header-label">').text(i.name)).appendTo(r);a.on("click",(function(t){a.is(".active")||(r.find(".charts-popup-tab-header.active").removeClass("active"),a.addClass("active"),n.find(".charts-popup-tab").hide(),o.show(),t&&t.preventDefault(),"function"==typeof e.onChange&&e.onChange.call(e,i.name))})),d&&!i.active||(d=a,r.find(".charts-popup-tab-header.active").removeClass("active"),
a.addClass("active"),n.find(".charts-popup-tab").hide(),o.show())}}))}else if(e instanceof h.Group){var c=s('<div class="charts-popup-group"></div>').appendTo(a);if(e.title){var u=s('<div class="charts-popup-itemheader"></div>').text(e.title).prepend(s('<span class="charts-popup-itemheader-icon"></span>'));e.collapsible&&(c.addClass("charts-popup-group-collapsible"),c.toggleClass("collapsed",e.collapsed),u.on("click",(function(){c.toggleClass("collapsed"),"function"==typeof e.onChange&&e.onChange(c.hasClass("collapsed")),T.height()===parseInt(T.css("max-height"))?T.addClass("popup-menu-scroll-y"):T.height()<parseInt(T.css("max-height"))&&T.removeClass("popup-menu-scroll-y")}))),c.append(u)}s.each(e.items,()}else if(e instanceof h.Header)a.append(s('<div class="charts-popup-itemheader"></div>').text(e.title));else if(e.separator){var p=s('<span class="separator"></span>');a.append(p)}else{var g;p=s('<a class="item">');if(e.url&&p.attr("href",e.url),e.target&&p.attr("target",e.target),o||p.addClass("first"),"function"==typeof e.active?e.active(e)&&p.addClass("active"):e.active&&p.addClass("active"),e.addClass&&p.addClass(e.addClass),e.addData&&p.data(e.addData),e.disabled&&p.addClass("disabled"),"function"==typeof e.action){var m=e.action,_=function(t){var i=s(t.target).parents().andSelf();i.is(y)||(m.apply(p,arguments),!e.url&&t&&"function"==typeof t.preventDefault&&t.preventDefault())};l.upAction?p.bind("mouseup",_):p.bind("click",_)}if(e.date)g=s('<span class="title"></span>').appendTo(p),s('<span class="date"></span>').text(e.date||"").appendTo(p);else if(e.icon&&!l.svg){var v=s('<span class="icon"></span>').appendTo(p);v.css("background-image",e.icon.image||""),e.icon.offset&&v.css("background-position","string"==typeof e.icon.offset?e.icon.offset:e.icon.offset.x+"px "+e.icon.offset.y+"px"),g=s('<span class="title"></span>').appendTo(p)}else!0===l.svg&&e.svg?(l.wrapIcon?p.append(s('<span class="icon-wrap">').addClass(e.iconClass).append(e.svg)):p.append(e.svg),g=s('<span class="title"></span>').appendTo(p)):e.iconClass?(p.append(s('<span class="icon"></span>').addClass(e.iconClass)),g=s('<span class="title"></span>').appendTo(p)):g=s('<span class="title-expanded"></span>').appendTo(p);e.html?g.html(e.html):g.text(TradingView.clean(e.title,!0)||"");var f=s('<span class="shortcut"></span>').appendTo(p);if(e.shortcut&&f.text(e.shortcut.keys),"function"==typeof e.deleteAction){var b=e.deleteAction,w=e.deleteAction.title||i.tf(null,void 0,i(614319)),y=s('<span class="icon-delete">');y.html(i(608636)),y.attr("title",w),y.on("click",(),p.append(y)}if(e.externalLink){var C=s('<span class="icon-external">');C.html(i(78620)),p.append(C)}if(e.buttons instanceof Array&&e.buttons.length&&e.buttons.forEach((function(t){t.el instanceof s||(t.el=s(t.el)),t.el.appendTo(p),t.handler&&t.el.on("click",()})),void 0!==e.counter)if("function"==typeof e.counter){
s('<span class="counter"></span>').html(e.counter()).appendTo(p)}else{var S=e.counterBlue?"blue":"";s('<span class="counter"></span>').text(e.counter+"").addClass(S).appendTo(p)}e.name&&p.attr("data-name",e.name),a.append(p),t.data("popup-menu",a)}}l.listInner&&($=s('<div class="list-inner">').appendTo($)),l.listTable&&($=s('<div class="list-table">').appendTo($)),s.each(y,(),c||(m.preventFirstProcessClick=!0),s(f).on("click",S),s(f).on("mousedown",C),f.addEventListener("keydown",M,!1),n&&s(f).on("touchstart.chartgui",C),l.upAction&&s(f).on("selectstart.popup-menu",(function(){return!1})),T.appendTo(w.ensureWindow(v));var x=f.documentElement.clientWidth,k=f.documentElement.clientHeight,A=t.outerWidth(),I=t.outerHeight(),B=t.offset(),E=s(b).scrollTop()||0;B.top-=E,B.top=Math.round(B.top),B.left=Math.round(B.left);var P=T.outerWidth(),L=T.outerHeight(),W=void 0!==l.viewportSpacing?l.viewportSpacing:10,D=l.popupSpacing?~~l.popupSpacing:1,V=l.popupDrift?~~l.popupDrift:0,N=L-T.height(),H="down";l.direction&&(H="function"==typeof l.direction?l.direction():l.direction);var z=!!l.reverse;if("down"===H){var O=k-B.top-I-D-W-N,F=B.top-D-W-N;O<Math.max(L||0,100)&&F>O&&(H="up")}else if("right"===H){var U=x-B.left-A-D-W-N,j=B.left-D-W-N;U<Math.max(P||0,100)&&j>U&&(H="left")}switch(H){case"down":case"up":"down"===H?T.css("top",B.top+I+D+"px"):T.css("bottom",k-B.top+D+"px").css("top","auto"),z?T.css("left",Math.max(B.left+V+A-P,W)+"px").css("right","auto"):T.css("left",B.left+V+"px").css("right","auto");break;case"right":case"left":D=Math.max(D,4),"right"===H?T.css("left",Math.floor(B.left+A+D)+"px").css("right","auto"):T.css("left",Math.floor(Math.max(B.left-P-D,W))+"px").css("right","auto"),z?T.css("top",Math.floor(Math.max(B.top+V+I-L,W))+"px"):T.css("top",Math.floor(B.top+V)+"px")}T.show();var X=B.top;if("up"===H||{left:1,right:1}[H]&&z?"up"!==H?X+=I:X-=I+D+N+W:X=k-X-I-2*D-N,T.height()>X&&T.addClass("popup-menu-scroll-y"),T.css("max-height",X+"px"),l.careRightBorder){var Z=x+s(b).scrollLeft();parseInt(T.css("left"))+T.width()+W>Z&&T.css("left",Z-T.width()-W+"px").css("right","auto")}l.careBottomBorder&&parseInt(T.css("top"))+T.height()+W>k+E&&T.css("top",k-T.height()-W+E+"px");var G=T.offset();T.css({position:"fixed",left:G.left-s(f).scrollLeft(),right:"auto"}),T[0].scrollHeight>T.height()&&T.addClass("popup-with-scroll"),d&&d.preventDefault()};d&&t.bind(d,_),c&&t.bind(c,(function(){g()})),l.runOpened&&_()};h.TabGroup=function t(e){if(!(this instanceof t))return new t(e);e=e||{},this.tabs=[],"function"==typeof e.onChange&&(this.onChange=e.onChange)},h.TabGroup.prototype.appendTab=function(t,e,i){if(null==t?t="":t+="",e||(e=[]),i||(i={}),!Array.isArray(e))throw new TypeError("items must be an array");return this.tabs.push({name:t,items:e,active:!!i.active}),e},h.Header=function t(e){if(!(this instanceof t))return new t(e);this.title=e},h.Group=function t(e){if(!(this instanceof t))return new t(e);e=e||{},this.items=[],this.title=null==e.title?"":e.title+"",this.collapsible=!!e.collapsible,
this.collapsed=!!e.collapsed,"function"==typeof e.onChange&&(this.onChange=e.onChange)},h.Group.prototype.push=e.bindPopupMenu=h},260391:(t,e,i)=>{"use strict";i.d(e,{ChatMessageTypeCustomizer:()=>s});class s{ddssage(t){var e;const i=null===(e=this._types[t.type])||void 0===e?void 0:e.onMessage;i&&i(t)}getHandlers(t){const e={};return Object.keys(this._types).forEach((i=>{e[i]=this.getHandler(i)||t})),e}onCreateMessage(t,e){const{onCreateMessage:i}=this._types[e.type];i&&i(t,e)}},984968:(t,e,i)=>{"use strict";i.d(e,{ChatNotificationControl:()=>n});var s=i(444372),o=i(226722),a=i(62802);class n{constructor(t){this._title=s.t(null,void 0,i(416449)),this._settingsKey="messages.show_onsite_notifications",this._eventKey="messages.toggleonsitenotifications",t?(this._emailKey="privatemessages.send_email_notifications",this._emailTitle=s.t(null,void 0,i(269299))):(this._emailKey="publicchats.send_email_notifications",this._emailTitle=s.t(null,void 0,i(341074))),this._isOn=a.getBool(this._settingsKey,!0),this._isOnEmail=a.getBool(this._emailKey,!0),o.TVXWindowEvents.on(this._eventKey,this._toggle.bind(this))}destroy(){o.TVXWindowEvents.off(this._eventKey,this._toggle.bind(this))}onsiteMenuItem(){let t=a.getBool(this._settingsKey);return t=void 0!==t?t:this._isOn,{title:this._title,icon:{image:"url('"+i(762966)+"')",offset:t?"0 -16px":void 0},action:()=>{var e;this._isOn=!t,window.TradingView.profile&&(null===(e=window.TradingView.profile.$settings)||void 0===e||e.find('input[name="notification_mention_in_chat_onsite"]').prop("checked",this._isOn)),a.setValue(this._settingsKey,this._isOn,{forceFlush:!0})}}}emailMenuItem(){let t=a.getBool(this._emailKey);return t=void 0!==t?t:this._isOnEmail,{title:this._emailTitle,icon:{image:"url('"+i(762966)+"')",offset:t?"0 -16px":void 0},action:()=>{var e;this._isOnEmail=!t,window.TradingView.profile&&"privatemessages.send_email_notifications"!==this._emailKey&&(null===(e=window.TradingView.profile.$settings)||void 0===e||e.find('input[name="notification_mention_in_chat_email"]').prop("checked",this._isOnEmail)),a.setValue(this._emailKey,this._isOnEmail,{forceFlush:!0})}}}},504368:(t,e,i)=>{"use strict";i.d(e,{ChatRoomListSearchFilter:()=>r});var s=i(444372),o=i(650151),a=i(868073),n=i(823127);class r{ppendInput(t){this._$searchInputWrap=n('<div class="msg-input-wrap js-hidden">').appendTo(t),this._$searchInput=n('<div class="msg-input">').appendTo(this._$searchInputWrap),this._$searchInputText=n('<input type="text" placeholder="'+s.t(null,void 0,i(417690))+'"></textarea>').appendTo(this._$searchInput),
this._$searchInputReset=n('<a class="input-reset js-hidden">').appendTo(this._$searchInput),this._$searchInputText.on("keydown",(t=>{if(13===t.which||38===t.which||40===t.which)return!1})).on("keyup",(t=>{var e,i,s,o,r,h,l,d,c,u,p,g,m;const _=null===(e=this._$searchInputText)||void 0===e?void 0:e.val(),v=new RegExp(_.split("").map(a.regExpEscape).join(".*"),"i");if(27===t.which)""===(null===(i=this._$searchInputText)||void 0===i?void 0:i.val())&&(this._isOn=!1,null===(s=this._$searchInputWrap)||void 0===s||s.addClass("js-hidden"),this._parentWidget.resize(),null===(o=this._$searchButton)||void 0===o||o.removeClass("active"),this._newRoom?(null===(r=this._parentWidget.scroll)||void 0===r||r.animateTo(this._newRoom.position().top),delete this._newRoom):null===(h=this._parentWidget.scroll)||void 0===h||h.restore()),null===(l=this._$searchInputText)||void 0===l||l.val(""),this.showRooms(),null===(d=this._$searchInputReset)||void 0===d||d.addClass("js-hidden");else{if(this.hideRooms(),0===(null===(c=this._$searchInputText)||void 0===c?void 0:c.val().length))return null===(u=this._$searchInputReset)||void 0===u||u.addClass("js-hidden"),void this.showRooms();null===(p=this._$searchInputReset)||void 0===p||p.removeClass("js-hidden"),null===(g=this._parentWidget.scroll)||void 0===g||g.scrollToStart();const t=this;null===(m=this._$data)||void 0===m||m.find(".title").each((function(){v.test(n(this).text())&&t.canShowRoom(n(this).parent())&&n(this).parent().removeClass("js-hidden")}))}})),this._$searchInputReset.on("click",(()=>{var t,e,i;null===(t=this._$searchInputText)||void 0===t||t.val(""),null===(e=this._$searchInputReset)||void 0===e||e.addClass("js-hidden"),this.showRooms(),null===(i=this._$searchInputText)||void 0===i||i.focus()}))}appendButton(t){this._$searchButton=n('<a class="button apply-common-tooltip" title="'+s.t(null,void 0,i(417690))+'" data-role="button" data-name="search">').append(n(i(67375)).attr({width:28,height:28})).appendTo(t),this._$searchButton.on("click",(()=>{var t,e,i,s,o,a,n,r,h,l;this._isOn?(this._isOn=!1,null===(t=this._$searchButton)||void 0===t||t.removeClass("active"),null===(e=this._$searchInputWrap)||void 0===e||e.addClass("js-hidden"),null===(i=this._$searchInputText)||void 0===i||i.val(""),null===(s=this._$searchInputReset)||void 0===s||s.addClass("js-hidden"),this.showRooms(),this._parentWidget.resize(),this._newRoom?(null===(o=this._parentWidget.scroll)||void 0===o||o.animateTo(this._newRoom.position().top),delete this._newRoom):null===(a=this._parentWidget.scroll)||void 0===a||a.restore()):(this._isOn=!0,null===(n=this._$searchButton)||void 0===n||n.addClass("active"),null===(r=this._parentWidget.scroll)||void 0===r||r.save(),null===(h=this._$searchInputWrap)||void 0===h||h.removeClass("js-hidden"),this._parentWidget.resize(),null===(l=this._$searchInputText)||void 0===l||l.focus(),this._onOpenCallback&&this._onOpenCallback())}))}setRoomList(t){this._$data=t}setOpenCallback(t){this._onOpenCallback=t}hideRooms(){var t
;null===(t=this._$data)||void 0===t||t.children().addClass("js-hidden")}showRooms(){var t;const e=this;null===(t=this._$data)||void 0===t||t.children().each((function(){e.canShowRoom(n(this))&&n(this).removeClass("js-hidden")}))}deInput(){var t,e,i,s;null===(t=this._$searchButton)||void 0===t||t.removeClass("active"),null===(e=this._$searchInputWrap)||void 0===e||e.addClass("js-hidden"),null===(i=this._$searchInputText)||void 0===i||i.val(""),null===(s=this._$searchInputReset)||void 0===s||s.removeClass("js-hidden"),this.showRooms(),this._parentWidget.resize()}getInputHeight(){return(0,o.ensureDefined)(this._$searchInputWrap).hasClass("js-hidden")?0:(0,o.ensureDefined)(this._$searchInputWrap).outerHeight()}isOpen(){return this._isOn}},372301:(t,e,i)=>{"use strict";var s=i(823127),o=i(213398),a=i(960769),n=i(50959),r=i(500962),h=i(643528).LightAnchorButton,l=i(607509).ACTION_ID;i(332848),i(376111),i(161530),i(347455),i(642949),i(145038),i(558552);var d=i(329221),c=i(633202).default,u=i(779923).showWarning,p=i(706433).getUserProfilePath,g=i(113600),m=i(867109).getUsernameHintList,_=i(867109).getUserChatSuggestListHandler,v=i(867109).destroyUsernameHintList,f=i(498966),b=i(500521).pushChartPage,w=i(373571).Separator,y=i(373571).Action,C=i(783375).ContextMenuManager,S=i(342395).takeChartSnapshot,M=i(186164).addPineCodeListener,T=i(421448),$=i(828616),R=i(947792),x=i(189843),k=x.showBanUserDialog,A=x.showUnbanUserDialog,I=i(721015).getViolations,B=i(252458).openPMDialog,E=i(246669).openDonationPopup,P=i(765381).ChatDonationButton,L=i(275108).showReportModal,W=i(644142).SidebarCustomScroll,D=i(432369).bindPopupMenu,V=i(201348).emoji,N=i(33900).showNoticeDialog,H=i(779923).showConfirm,z=i(348735);const{isLatin:O}=i(439385);var F=i(941285).Spinner,U=i(345848).trackEvent,j=i(741749).trackChatEvent,{trackSocialNetworkEvent:X,FeatureId:Z,DialogAction:G,errorCode:K,createExtendedSolution:Q}=i(46277),q=i(55826),Y=i(728811),J=i(468867),tt=i(185515).buildUtmQueryStringFromUrlParams,et=i(504637).template;i(739740);var it=i(31341).detectAutoDirection,st=i(296633).convertToBadgeAccountProps,ot=i(180184).BadgeSize,at=i(903974).renderBadgeAccountWithoutFeaturedBroker,nt=i(461495).getBadgeAccountTitle,rt=i(712797).getBadgeAccountLink,ht=i(260391).ChatMessageTypeCustomizer,lt=i(713984),dt=i(919476).htmlEscape,ct=i(691239).validateUrlsInText,ut=i(470316).hashFromEvent,pt=i(470316).Modifiers,gt=i(791325);const{parsePineTags:mt}=i(874639),{wrapPineTags:_t,disposeWrapPineTags:vt}=i(796246);var ft=i(778785).mobiletouch,bt=i(740254).enabled,wt=i(833813).ProductFeatures,yt=i(960337).createGoProDialog,Ct=i(314802).isOnMobileAppPage,St=i(255453).isOldUser,Mt=i(33005).openImageDialog,Tt=i.tf(null,{context:"like_button"},i(288711));function $t(t){var e=function(){window.user._chatInputs||(window.user._chatInputs={})};e(),loginStateChange.subscribe(this,e),this._bridge=t;var i=t.$body;this._model=null
;var s=this._bridge.visible.value();this.isPrivate()?this._model=z.makePrivateModel():this._bridge.live&&this._bridge.rooms?this._model=z.makeLiveSeparateModel(this._bridge.rooms):(this._model=z.makePublicModel("en"===window.language),"en"!==window.language&&(s=!0)),this._model.messageReceived().subscribe(this,this._onMessageWrapper),this._model.messageDeleted().subscribe(this,this._onMessageDeleted),this._model.roomChanged().subscribe(this,this._onRoomChanged),this._model.setActive(s),this._isHistoryEnded=!1,this._markNewMessagesAsUnread=!1,this._invisibleMessagesNumber=0,this._inputDisabled=!1,this.MESSAGES_CONCATENATION_TIMEOUT=12e4,this.MAX_MESSAGES=100,this.MAX_HIGHLIGHTED_MESSAGES=10,this.USERLINK_POPUP_TIMEOUT=1e3,this.META_VERSION="0.2",this._init_history_loading=!0,this._init_history_loaded=!1,this._onBridgeVisibleChange=null,this._onSymbolChanged=null,this._onIntervalChanged=null,this._onResize=null,this._onMaximized=null,this._standalone=!t||!!t.standalone,this._embedded=!t||!!t.embedded,this._noAutoFocus=!!t.noAutoFocus,this.utm=tt(!1),this.isPrivate()||(this._updateMessageBatches(),this.updateLikesHandlers(),this.canHandleLikes=!0),this._hintListElement=null,this.prepareLayout(i),this.toggleSnaphotPreview(TVSettings.getBool("chat.show_snapshot_preview",!0));var o=null;this._standalone&&t.activeRoom?o=t.activeRoom:t&&t.properties&&(o=(t.properties.value()||{}).room||o),this.likeButtonTemplate=et,this._messageTypeCustomizer=new ht(this._bridge.typeHandlers||{},this._updateMessageContext),this._updateMessageContext(),(this.isPrivate()||this._standalone&&this._model.getRoomById(o)||this._bridge.live)&&this.selectChannel(o),t&&(t.symbol&&(this._onSymbolChanged=this.update.bind(this),t.symbol.subscribe(this._onSymbolChanged,{callWithLast:!0})),t.interval&&(this._onIntervalChanged=this.update.bind(this),t.interval.subscribe(this._onIntervalChanged,{callWithLast:!0})),this._onResize=this.resize.bind(this),t.height&&t.height.subscribe(this._onResize),t.width&&t.width.subscribe(this._onResize),t.onMessage&&!t.live&&t.onMessage(this.onBridgeMessage.bind(this)))}$t.prototype._onMessageWrapper=$t.prototype.currentRoom=$t.prototype.enablePosting=function(){this._postingDisabled&&(this._hiddenElements&&this._hiddenElements.forEach((),this._$inputNoPostingMessage&&this._$inputNoPostingMessage.remove(),this.resizeHeader(),this._postingDisabled=!1)},$t.prototype.onBridgeMessage=function(t,e){"chat_set_sound_state"===t?e.isPrivate===this.isPrivate()&&this.sound.set(e.state):"toggle_snaphot_preview"===t&&this.toggleSnaphotPreview(),this.isPrivate()?"private_chat_hidden"===t?this._markMessagesAsUnread(!0):"private_chat_visible"===t?(this._scroll.checkContentVisibility(),this._markMessagesAsUnread(!1)):"private_chat_msgs_read"===t&&this._markAsRead(e.idString):"chat_select_channel"===t?(this._newMessagesToHighlight=e.new_msgs,
this.selectChannel(e.room_id)):"chat_edit_room"===t?this.editRoom(this._model.getRoomById(e)):"chat_delete_room"===t&&this.deleteRoom(this._model.getRoomById(e))},$t.prototype.playSound=function(t){this.sound.state[t]&&(this.isPrivate()?T.play("chat/popup"):T.play("chat/message"))},$t.prototype._clearExcessiveMessages=function(){var t=this._$data.find(".ch-item");return t.length>this.MAX_MESSAGES&&((t=t.slice(0,t.length-this.MAX_MESSAGES)).add(".ch-item-empty"),q.jQueryCompatibleDestroy(t),t.remove()),this._history_hide_timeout&&(clearTimeout(this._history_hide_timeout),this._history_hide_timeout=null),!!t.length},$t.prototype._markAsRead=function(t){var e=t.split(":");this._scroll.triggerVisibilityCallbacks((function(t){var i=e.indexOf(t.id);return i>=0&&(e.splice(i,1),!0)}))},$t.prototype._markMessagesAsUnread=function(t){t&&this._markNewMessagesAsUnread!==t&&(this._prepareUnreadMarker=!0),this._markNewMessagesAsUnread=t},$t.prototype._shouldPlaceUnreadMarkerNow=function(){var t=this._prepareUnreadMarker;return this._prepareUnreadMarker=!1,this._markNewMessagesAsUnread&&t},$t.prototype.onMessage=function(t,e){if(this._model.ignoredUsers().includes(t.user_id))return;if(t.id&&this._lastMessageId===t.id)return;this._lastMessageId=t.id;var i=t.user_id!==window.user.id,s=i&&this._shouldPlaceUnreadMarkerNow();s&&this._$data.append(this._getNewUnreadMarker()),this.isPrivate()&&this._bridge.visible.value()&&this._bridge.postMessage("private_message_read",{id:"marker"}),(this._isMessageFromIgnoredUser(t)||xt(t))&&this._invisibleMessagesNumber++;var o=this.createMessage(t,{markAsUnread:this._markNewMessagesAsUnread,forceFullMessage:s,batch:1});const a=o.get(0);this._renderPineElements([a]);var n=o[0].querySelector(".js-badge-wrapper");if(null!==n&&at(n,{badges:st(t),size:ot.XSmall,getTitle:nt,getLink:rt,isShort:!0}),o.data("short")){var r=this.getLastMessages(1);o.insertAfter(r.find(".ch-item-text:last"))}else this._$data.removeClass("no-messages"),o.appendTo(this._$data);this._scroll.atEnd(2*o.height())&&this._clearExcessiveMessages.apply(this),i&&this._bridge&&(t.meta.service_msg||(!this.isStandalone()&&!this.isPrivate()||e||this.playSound(o.data("is_reply")?"onMessageForUser":"onMessage"),this.highlightMessage(o,t.id))),this._scroll.atEnd(2*o.height())&&this._scroll.scrollToEnd(),this._messageTypeCustomizer.onMessage(t)},$t.prototype.highlightMessage=function(t,e){var i=this;this._bridge.visible.value()?this.isPrivate()&&this._bridge.postMessage("private_message_read",{id:e}):this.isPrivate()||(this._messagesToHighlight?this._messagesToHighlight=this._messagesToHighlight.concat(t.attr("id")).slice(-this.MAX_HIGHLIGHTED_MESSAGES):(this._messagesToHighlight=[t.attr("id")],this._bridge.visible.when((function(){var t=i._messagesToHighlight;delete i._messagesToHighlight,i._$data.find("#"+t.join(", #")).highlight(5)})),t=null))},$t.prototype._onMessageDeletedBySelf=function(t){this._slidingUp||(this._slidingUp=[]),this._slidingUp.push(t),t.slideUp({queue:!1,complete:function(){
this._slidingUp.splice(this._slidingUp.indexOf(t),1),this._slidingUp.length||delete this._slidingUp,this.removeMessage(t)}.bind(this)})},$t.prototype._onMessageDeleted=function(t){var e=s("#ch-item-"+t.id);if(e.hasClass("ch-item-text")&&(e=e.closest(".ch-item")),e.length>0&&this._messagesIdsToBeDeletedBySelf&&this.getMessagesData(e)[0]===this._messagesIdsToBeDeletedBySelf[0])return this._messagesIdsToBeDeletedBySelf=null,this._onMessageDeletedBySelf(e);e.length>0&&(window.is_authenticated&&window.user.id===t.user_id?this.highlightAsModerated(e):this.removeMessage(e),this._scroll.resize())},$t.prototype._onRoomChanged=$t.prototype.removeMessage=$t.prototype.highlightAsModerated=function(t){t.prepend('<div class="ch-message-moderated-layout"><div class="ch-overlap">'+i.tf(null,void 0,i(705198))+"</div></div>").addClass("ch-message-moderated")},$t.prototype.getLastMessages=function(t,e){var i=e instanceof DocumentFragment?s(e.childNodes).filter(".ch-item"):(e||this._$data).find(".ch-item");return i.slice(i.length-t)},$t.prototype.getFirstMessages=function(t,e){return(e instanceof DocumentFragment?s(e.childNodes).filter(".ch-item"):(e||this._$data).find(".ch-item")).slice(0,t)},$t.prototype.update=function(){this._bridge&&this._bridge.symbol&&this._model.setStatSymbol(this._bridge.symbol.value()||void 0),this._bridge&&this._bridge.interval&&this._model.setStatInterval(this._bridge.interval.value()||void 0)},$t.prototype._clearMessageBatch=function(t){this._messageBatches[t].count>0&&(this._messageBatches[t]=Rt(t))},$t.prototype._putMessageInBatch=function(t,e){this._messageBatches[t].clearAfterTriggering&&this._messageBatches[t].visibilityCallbacksFired&&this._clearMessageBatch(t),this._messageBatches[t].messages[e]=!0,this._messageBatches[t].count++},$t.prototype._checkMessageBatchQuantity=function(t){return this._messageBatches[t].visibilityCallbacksFired||this._onMessagesVisibility(t),this._messageBatches[t].fireAlt};function Rt(t){var e={messages:{},count:0,visibilityCallbacksFired:!1,fireAlt:!1};return 1===t&&(e.clearAfterTriggering=!0),e}nction At(t){if(window.getSelection().toString())return!0;var e=s(t);if(e.is("img, a, path"))return!0;var i=e.closest("div");return i.hasClass("js-snapshot-like")||i.hasClass("js-chart-like")}$t.prototype._onMessagesVisibility=function(t){this._messageBatches[t].visibilityCallbacksFired=!0,this._messageBatches[t].count<=5&&(this._messageBatches[t].fireAlt=!0)},$t.prototype._updateMessageBatches=function(){this._messageBatches&&delete this._messageBatches,this._messageBatches=[Rt(0),Rt(1)]},$t.prototype._canLoadHistoryMessages=function(){return this._scroll.isContentShort()&&!this._isHistoryEnded&&this._bridge.visible.value()},$t.prototype._loadChatHistory=function(){let t=!1;this._history_loading=!0,this._$data.addClass("loading"),
this._model.loadHistory(this._$data.find(".ch-item-text").length+this._invisibleMessagesNumber,((e,i)=>{this._scroll.save(),f.isSymbolRoom(this._model.room())&&i&&(e.messages.push(f.defaultSymbolRoomMesssage()),t=!0),this.prependMessages(e.messages,(()=>{t||this._scroll.restore(),this._history_loading=!1,this._isHistoryEnded=i,this._$data.removeClass("loading"),this._history_hide_timeout&&clearTimeout(this._history_hide_timeout),this._history_hide_timeout=setTimeout((()=>{this._clearExcessiveMessages.apply(this)&&(this._scroll.scrollToEnd(),this._isHistoryEnded=!1)}),24e5),this._canLoadHistoryMessages()&&this._loadChatHistory()}))}))},$t.prototype.updateRoom=function(t){this._invisibleMessagesNumber=0,this._isHistoryEnded=!1,this._$data.addClass("loading"),this._spinner||(this._spinner=new F("mini").spin(this._$scrollContainer.get(0))),this._init_history_loading=!0,this.isPrivate()&&(this.updateLikesHandlers(),this._updateMessageBatches()),this._$inputDisabledMessage.hide(),this._$invalidLinkMessage.hide();this._model.setRoom(t,((t,e,i)=>{this.isPrivate()&&this._bridge.xWindowDataSync&&"function"==typeof this._bridge.xWindowDataSync&&this._bridge.xWindowDataSync(t),q.jQueryCompatibleDestroy(this._$data),this._$data.empty(),this.resizeHeader(),this.isPrivate()&&!i&&(this._lastVisited=1e3*t.last_visited),this._isHistoryEnded=e,t.messages.length&&(this._lastMessageId=t.messages[0].id),f.isSymbolRoom(this._model.room())&&e&&t.messages.push(f.defaultSymbolRoomMesssage()),this.prependMessages(t.messages,(()=>{if(this.updateTitle(),this._$data.removeClass("loading"),this._spinner&&(this._spinner.stop(),delete this._spinner),this._scroll.scrollToEnd(),this._newMessagesToHighlight&&t.messages.length>0){var e=Math.min(this._newMessagesToHighlight,this.MAX_HIGHLIGHTED_MESSAGES);f.highlightNewMessages(this._$data,e,5),this._newMessagesToHighlight=0}this._init_history_loading=!1,this.isPrivate()&&this.restoreInputText(),this._init_history_loaded&&this.inputEditFocus(),this._init_history_loaded=!0,this._canLoadHistoryMessages()&&this._loadChatHistory()}))}))},$t.prototype.getRoomTitle=$t.prototype.isStandalone=function(){return!!this._standalone},$t.prototype.isEmbedded=$t.prototype.isPrivate=$t.prototype._updateMessageContext=$t.prototype.getMessageContext=function(){var t=this;return Object.assign({join:function(t){return{text:"<i>"+i.tf(null,{replace:{username:dt(t.username)}},i(1310))+"</i>",isService:!0}},leave:function(t){return{text:"<i>"+i.tf(null,{replace:{username:dt(t.username)}},i(141985))+"</i>",isService:!0}},delete_room:function(t){return{text:"<i>"+i.tf(null,{replace:{title:dt(t.meta.room_title)}},i(287147))+"</i>",isService:!0}},warning:function(e){return s.extend(t.normalMessageContext(e),{isService:!0,isWarning:!0})},normal:t.normalMessageContext,get:function(e){
return e.type&&this[e.type]?this[e.type](e):t.normalMessageContext(e)}},this._messageTypeCustomizer.getHandlers(t.normalMessageContext))},$t.prototype.normalMessageContext=function(t){var e,s=t.meta&&"snapshot"===t.meta.type,a=this.META_VERSION===t.meta.version,n=t.meta.temp;return e=a?this.renderText(t).replace(/\n/g,"<br/>"):R.urlizeAndParseQuotesAndClean(t.text||"").replace(/\n/g,"<br/>"),s&&(e&&(e+="<br/>"),e+=o.render('<div class="ch-item-preview-wrap"><div class="ch-item-snapshot-link"><i class="icon icon-snapshot-small" title="{{title}}"></i> <a href="{{url}}" target="_blank">{{metaText}}</a></div><div class="ch-item-snapshot-preview"><a href="{{url}}" target="_blank"><img src="{{previewURL}}" loading="lazy" class = "snapshot-preview" alt=""/></a></div>{{#chartId}}{{> ideaLikesButton }}{{/chartId}}</div>',{title:i.tf(null,void 0,i(511938)),url:TradingView.clean(t.meta.url),metaText:i.tf(null,void 0,i(511938)),previewURL:TradingView.clean(t.meta.preview_url?t.meta.preview_url:t.meta.url),chartId:!(this.isPrivate()||!n)&&t.id,typeClass:"js-snapshot-like",titleTooltip:Tt},{ideaLikesButton:this.likeButtonTemplate})),{text:e,showAuthor:!t.meta.service_msg,isAuthor:user.id===t.user_id,isReport:t.meta.report_type,isModNotification:t.meta.mod_notification,isBanNotification:t.meta.ban_notification,newMeta:a,tempMeta:n,snapshotAttached:s}},$t.prototype.renderText=function(t){var e=this.utm?"?"+this.utm:"",s=new R.UrlizeBuffer(TradingView.clean(t.text),t.utm);if(s=R.obsceneWords(s),t.meta.links&&t.meta.links.charts){var a=t.meta.links.charts.occurences,n=t.meta.links.charts.data;a.forEach((function(t){var a=n[t.id],r=TradingView.clean(t.match);s.text.indexOf(r)>=0&&(s.text=s.text.replace(r,"<"+s.count+++">"),s.values.push(o.render('{{#showLikesButton}}<div class="ch-item-preview-wrap">{{/showLikesButton}}<div class="ch-item-chart-link"><i class="icon icon-snapshot-small" title="{{publishedIdea}}"></i> <a href="{{href}}" target="_blank" data-id="{{chartId}}" data-symbol="{{symbol}}" data-url="{{href}}">{{publishedIdea}}</a></div><div class="ch-item-chart-preview"><a  href="{{href}}" target="_blank" data-id="{{chartId}}" data-symbol="{{symbol}}" data-url="{{href}}"><div class="tv-idea-preview-button__container"><img src="{{imageUrl}}" loading="lazy" alt="" class="idea-preview"/>{{#isVideo}}<div class="tv-idea-preview-button__play-icon">'+i(3044)+'</div>{{/isVideo}}{{#videoCam}}<div class="tv-idea-preview-button__video-cam">'+i(205128)+"</div>{{/videoCam}}</div></a></div>{{#showLikesButton}}{{> ideaLikesButton }}{{/showLikesButton}}{{#showLikesButton}}</div>{{/showLikesButton}}",{href:a.published_chart_url+e,publishedIdea:i.tf(null,void 0,i(442537)),title:a.name,symbol:a.symbol.split(":")[1],imageUrl:Y.createPublishedChartImageUrl(a.image_url),showLikesButton:!this.isPrivate(),chartId:a.image_url,typeClass:"js-chart-like",titleTooltip:Tt,isVideo:a.is_video,videoCam:a.video_cam},{ideaLikesButton:this.likeButtonTemplate})))}),this)}s.text=J.parseQuotes(s.text),s=mt(s);var r=R.chainedUrlize(s,R.commonFunctors)
;return r=V.parseNativeEmoji(r)},$t.prototype._isMessageFromIgnoredUser=$t.prototype.createMessage=function(t,e,a){if(this._isMessageFromIgnoredUser(t)||xt(t))return s();var h,d=this.messageContext.get(t),c=t.meta.interval?" "+t.meta.interval:"",u=document.createElement("div");u.innerHTML=d.text;for(var g=0;g<u.childNodes.length&&(u.childNodes[g].nodeType!==Node.TEXT_NODE||!(h=it(u.childNodes[g].textContent)));g+=1);var m=s(o.render('<div class="ch-item ch-item-user-{{userID}} js-userlink-popup-anchor" id="ch-item-{{messageID}}"><a class="ch-item-userpic ch-item-userpic-{{userID}}" href="{{profileUrl}}" data-username="{{username}}" data-userlinkpopup-timeout="{{userlinkPopupTimeout}}" target="_blank"><img src="{{userPic}}" loading="lazy" alt="Avatar"/></a><div class="ch-item-content">{{#showHeader}}<div class="ch-item-header">{{#showAuthor}}<span class="ch-item-author"><a href="{{profileUrl}}" target="_blank" class="ch-userlink selectable js-chat-suggest" data-username="{{username}}" data-userlinkpopup-timeout="{{userlinkPopupTimeout}}">{{username}}</a><span class="ch-userlink__badge-wrapper js-badge-wrapper"></span></span>{{/showAuthor}}<span class="ch-item-info">{{{symbolInterval}}}<span class="ch-item-time"><time></time></span></span>{{#showActions}}<div class="ch-item-actions js-actions"></div>{{/showActions}}</div>{{/showHeader}}<div class="ch-item-text selectable {{^showHeader}}ch-item-text-no-header{{/showHeader}} js-text"{{#autoDirection}}dir={{autoDirection}}{{/autoDirection}}>{{{text}}}</div>{{#isDonate}}<div class="ch-item-coins__button js-coins"/>{{/isDonate}}</div></div>',{userID:t.user_id,messageID:t.id,username:t.username,userPic:t.user_pic,userlinkPopupTimeout:this.USERLINK_POPUP_TIMEOUT,showHeader:!("join"===t.type),isDonate:t.meta.coins&&t.meta.coins>0,showAuthor:d.showAuthor,symbolInterval:""!==t.symbol?'<span class="ch-item-symbol">'+dt(t.symbol.substring(t.symbol.indexOf(":")+1)+c)+",</span>":"",showActions:!d.isService,text:d.text,autoDirection:h,profileUrl:p({username:t.username,is_broker:t.is_broker},{query:this.utm})})),v=this;if(m.find(".ch-item-userpic img").one("error",(),e.markAsUnread&&!d.isAuthor&&(this._putMessageInBatch(e.batch,t.id),m.addClass("js-unread-message"),this._scroll.subscribeToContentVisible(t.id,m[0],(function(i){if(i||v._bridge.postMessage("private_message_read",{id:t.id}),v._checkMessageBatchQuantity(e.batch))return m.removeClass("js-unread-message"),void m.highlight(5);m.addClass("js-read-message"),m.removeClass("js-unread-message"),setTimeout((function(){m.removeClass("js-read-message")}),2500)}))),d.isService)return m.addClass("ch-message-service"),d.isWarning&&m.addClass("ch-message-type-warning"),m;this._messageTypeCustomizer.isTypeExists(t.type)&&this._messageTypeCustomizer.onCreateMessage(m[0],t);var f=m.find(".js-text");0===f.text().length&&1===f.children().length&&(f.children().hasClass("emoji")||f.children().hasClass("tv-emoji-wrapper"))&&f.addClass("ch-item-text-emoji")
;var S=m.find(".js-coins");if(S[0]&&r.render(n.createElement(P,{username:t.username,coins:String(t.meta.coins),recipient:t.meta.recipient_username}),S[0]),this.canHandleLikes&&d.tempMeta){if(d.snapshotAttached){var M=t.meta.temp.message_likes;M&&this._snapshotMessagesLikesHandler.addIdea(m.find(".js-snapshot-like")[0],t.id,M.count,M.voted)}if(d.newMeta&&t.meta.links.charts&&t.meta.temp.chart_likes){g=0;var T=t.meta.temp.chart_likes;m.find(".js-chart-like").each((function(){var e=s(this).data("id");e===t.meta.links.charts.occurences[g++].id&&v._chartLikesHandler.addIdea(this,e,T[e].count,T[e].voted)}))}}var $,R=m.find(".js-actions");if(R.append(s('<a class="ch-item-action apply-common-tooltip" title="'+i.tf(null,void 0,i(460407))+'">')).children().last().append(s(i(15989)).attr({width:12,height:12})).on("click",(function(e){e.stopPropagation(),v.insertQuote(m,t)})),d.isAuthor||R.append(s('<a class="ch-item-action apply-common-tooltip" title="'+i.tf(null,void 0,i(972104))+'">')).children().last().append(s(i(265872)).attr({width:12,height:12})).on("click",(function(e){e.preventDefault(),window.runOrSignIn((function(){window.user.username!==t.username&&v.donate(m,t)}),{source:"Reply with cheer button"})})),d.isAuthor||R.append(s('<a class="ch-item-action ch-item-action-report apply-common-tooltip" title="'+i.tf(null,void 0,i(773326))+'">')).children().last().append(s(i(822353)).attr({width:12,height:12})).on("click",(),R.append(s('<a class="ch-item-action js-settings apply-common-tooltip" title="'+i.tf(null,void 0,i(473771))+'">')).children().last().append(s(i(214729)).attr({width:12,height:12})),R.on("contextmenu",(function(t){t.preventDefault(),t.stopPropagation()})),this.bindMessageMenu(m,t),this.isEmbedded()||m.find(".js-chat-suggest").on("click",function(e){e.preventDefault(),e.stopPropagation(),_().then((),this.insertAtCursorPosition("@"+t.username.replace(/\s/g," ")+" ")}.bind(this)),!this.isStandalone()){var x=m.find(".ch-item-snapshot-link a, .ch-item-snapshot-preview a");s(x).each((function(){Mt(this)})),m.find(".ch-item-chart-link a, .ch-item-chart-preview a").click((function(){var t=s(this).data("url"),e=s(this).data("id"),o=s(this).data("symbol"),a=v._bridge.getChartWidgetCollection();if(t)b({chartId:e,chartName:i.tf(null,void 0,i(442537)),publishedUrl:t,shortSymbol:o,chartWidgetCollection:a});else if(o){var n=Y.createPublishedChartUrl(e,o);b({chartId:e,chartName:i.tf(null,void 0,i(442537)),publishedUrl:n,shortSymbol:o,chartWidgetCollection:a})}else b({chartId:e,chartName:i.tf(null,void 0,i(442537)),chartWidgetCollection:a});return!1}))}this.isStandalone()||this.isEmbedded()||m.on("contextmenu",(function(e){At(e.target)||(e.preventDefault(),v._model.getBanStatus(t,(function(i,s){t.is_banned=i&&s;var o=v.prepareMessageMenu(m,t).map((function(t){return t.separator?new w:new y({actionId:l.UnknownAction,options:{label:t.title,onExecute:t.action}})}));C.showMenu(o,e)})))})),
q.jQueryCompatibleAgoDateFormatter(m.find(".ch-item-time time"),this._parseMessageTime(t.time)),m.data("message",JSON.stringify(t)).data("alive",!0),this.isStandalone()&&m.data("ch-is-standalone",!0),is_authenticated&&(!v.isEmbedded()&&d.isAuthor?m.addClass("ch-is-author"):d.isReport?(m.addClass("ch-is-report"),e.forceFullMessage=!0):d.isModNotification?(m.addClass("ch-mod-notification"),e.forceFullMessage=!0,d.isBanNotification&&m.addClass("ch-ban-notification")):t.text&&m.text().indexOf("@"+user.username.replace(/\s/g," "))>-1&&(m.addClass("ch-is-reply").data("is_reply",!0),$=!0));var k=this.getLastMessages(1,a),A=k&&!k.hasClass("ch-message-moderated")&&k.data("message");if(A)try{A=JSON.parse(A)}catch(t){A=null}return!e.forceFullMessage&&A&&t.username===A.username&&!A.type&&t.symbol===A.symbol&&t.interval===A.interval&&$===k.data("is_reply")&&new Date(t.time)-new Date(A.time)<this.MESSAGES_CONCATENATION_TIMEOUT&&!this._messageTypeCustomizer.getTypeNames().includes(t.type)?(k.find(".ch-item-symbol").replaceWith(m.find(".ch-item-symbol")),k.find(".ch-item-time time").replaceWith(m.find(".ch-item-time time")),m.find(".ch-item-text").data(m.data()).data("short",!0).addClass("js-message-concatenated").attr("id",m.attr("id"))):m},$t.prototype.getMessagesData=function(t){var e=[kt(t.data("message"))];return t.find(".ch-item-text[id]").each((function(t,i){var o=s(i).data("message");o&&e.push(kt(o))})),e},$t.prototype.insertQuote=function(t,e){var i=this._$inputEdit.val().trim();this._$inputEdit.focus(),this._$inputEdit.val(i+(i.length?"\n":"")+'[quote="'+e.username.replace(/\s/g," ")+'"]'+this.getFullMessage(t,e)+"[/quote]\n"),c.update(this._$inputEdit)},$t.prototype.getFullMessage=function(t,e,i){var o=[],a=i?J.removeBBCodes:J.removeQuotes;return o.push(a(e.text)),"snapshot"===e.meta.type&&o.push(e.meta.url),t.find(".js-message-concatenated").each((function(){var t=JSON.parse(s(this).data("message"));o.push(a(t.text)),"snapshot"===t.meta.type&&o.push(t.meta.url)})),o.filtet})).join("\n")},$t.prototype.bindMessageMenu=function(t,e){var i=this,s=t.find(".js-settings");s.on("click",(function(o){o.stopPropagation(),s.hasClass("open")?s.trigger("hide-popup"):i.createMessageMenu(t,e,(function(t){s.trigger("show-popup",[t,!0])}))})),D(s,null,{event:"show-popup",hideEvent:"hide-popup",addClass:"ch-popup ch-item-settings-popup",careBottomBorder:!0,careRightBorder:!0})},$t.prototype.showReportDialog=function(t,e){var s=this.getFullMessage(t,e,!0),o={};this.isPrivate()||(o.additionalText=i.tf(null,void 0,i(205415)).format({title:this._roomTitle})),runOrSignIn(L.bind(null,e.username,"message",e.id.replace(/-/g,""),s,e.id,o),{source:"Chat report message",verifiedPhoneRequired:!0})},$t.prototype.prepareMessageMenu=function(t,e){var s=[],o=this;s.push({title:i.tf(null,void 0,i(460407)),action:function(){o.insertQuote(t,e)}}),user.id!==e.user_id&&s.push({title:i.tf(null,void 0,i(972104)),acti)}});const a=o.isPrivate()?i.tf(null,void 0,i(635117)):i.tf(null,void 0,i(8435));if(s.push({title:a,
action:function(){o.isPrivate()?window.open("/chat/m/"+e.id.replace(/-/g,"")+"/"):window.open(o._getChatHistoryLink(new Date(e.time))+"&msgid="+e.id)}}),user.id===e.user_id||this.isPrivate()||o.isStandalone()||s.push({title:i.tf(null,void 0,i(773326)),action:this.showReportDialog.bind(this,t,e)}),(user.permissions&&user.permissions.can_moderate_public_chats||user.id===e.user_id)&&s.push({title:i.tf(null,void 0,i(564414)),action:function(){var e=o.getMessagesData(t);o._messagesIdsToBeDeletedBySelf=e,o._model.deleteMessage(e,null}))}}),s.push({separator:!0}),user.permissions&&user.permissions.can_ban_people&&user.id!==e.user_id&&!e.is_moderator){var n=!!e.is_banned,r={unban:i.tf(null,{replace:{username:e.username}},i(483228)),ban:i.tf(null,{replace:{username:e.username}},i(768408))},h={title:n?r.unban:r.ban,action:function(){n?A(e.user_id,e.username,(function(){h.title=r.ban,n=!1})):k(o.getFullMessage(t,e,!0),e,{modal:!0},(function(){h.title=r.unban,n=!0}))}};s.push(h),t.find(".ch-userlink, ch-item-userpic").on("userbanchange",(function(t,e){n=e,h.title=n?r.unban:r.ban}))}if(window.user.id!==e.user_id&&!e.is_moderator){var l=!!this._model.ignoredUsers().includes(e.user_id),d={ignore:i.tf(null,{replace:{username:e.username}},i(920268)),unignore:i.tf(null,{replace:{username:e.username}},i(420420))},c={title:l?d.unignore:d.ignore,action:function(){l?o._model.ignoreUserV2(e,!1,(function(){c.title=d.ignore,l=!1}),(function(t){t&&N({title:i.tf(null,void 0,i(482751)),content:t.message})})):H({text:i.tf(null,{replace:{username:e.username}},i(898331)),onConfirm:function(t){return new Promise((function(s){o._model.ignoreUserV2(e,!0,(function(){s(),t.dialogClose(),c.title=d.unignore,l=!0}),(function(e){s(),t.dialogClose(),e&&N({title:i.tf(null,void 0,i(482751)),content:e.message})}))}))}})}};s.push(c),t.find(".ch-userlink, ch-item-userpic").on("userignorechange",(function(t,e){l=e,c.title=l?d.unignore:d.ignore}))}var u;(o.isStandalone()||o.isPrivate()||user.id===e.user_id||s.push({title:i.tf(null,{replace:{username:e.username}},i(972090)),action:function(){runOrSignIn(B.bind(this,e.user_id,e.username),{source:"Chat send private message",verifiedPhoneRequired:!0,doNotCheckSuspicious:!0})}}),o.isPrivate())||(u=user.id===e.user_id?i.tf(null,void 0,i(508167)):i.tf(null,{replace:{username:e.username}},i(534522)),s.push({title:u,action:function(){window.open(o._getChatHistoryLink(new Date,e.username))}}));return s[s.length-1].separator&&s.pop(),s},$t.prototype.createMessageMenu=function(t,e,i){var s=this;this._model.getBanStatus(e,(function(o,a){var n=["private_chats","public_chats"].includes(e.type);(!e.type||n||s._messageTypeCustomizer.getTypeNames().includes(e.type))&&(e.is_banned=o&&a,i(s.prepareMessageMenu(t,e)))}))},$t.prototype._getChatHistoryLink=function(t,e){
var i=t.getMonth()+1,s=t.getDate(),o=t.getMinutes(),a=t.getHours(),n=(a<10?"0":"")+a+"%3A"+(o<10?"0":"")+o,r=t.getFullYear()+"-"+(i<10?"0":"")+i+"-"+(s<10?"0":"")+s,h="/chat/history/?room="+this._model.room()+"&date="+r+"&tzoffset="+t.getTimezoneOffset();return e?h+"&usernames="+e:h+"&timefrom="+n},$t.prototype._messageUnread=function(t){return new Date(t)>new Date(this._lastVisited)},$t.prototype.prependMessages=function(t,e){if(t.length){var i,o=this.getFirstMessages(1),a=o&&o.data("message");if(a)try{i=(a=JSON.parse(a)).username}catch(t){}var n,r,h,l=document.createDocumentFragment(),d=!1,c=!!this._lastVisited,u=t.reverse();u.forEach((function(t){var e=c&&this._messageUnread(t.time);if(e){var i=this._updateUnreadMarker(0);l.appendChild(i.get(0)),d=!0,c=!1}(this._isMessageFromIgnoredUser(t)||xt(t))&&this._invisibleMessagesNumber++;var s=this.createMessage(t,{markAsUnread:d,forceFullMessage:e,batch:0},l);if(s.length)if(s.data("short")){var o=this.getLastMessages(1,l).find(".ch-item-text:last");s.insertAfter(o)}else l.appendChild(s.get(0)),n=s}),this);if(this._renderPineElements(Array.from(l.childNodes)),this._messageUnread(u[0].time)||delete this._lastVisited,i&&n&&(r=n.data("message"))){try{h=(r=JSON.parse(r)).username}catch(t){}if(h&&h===i&&new Date(a.time)-new Date(r.time)<this.MESSAGES_CONCATENATION_TIMEOUT){var p=o.find(".ch-item-text");p.eq(0).attr("id",o.attr("id")),p.eq(0).data(o.data()),p.insertAfter(n.find(".ch-item-text:last")),o.remove()}}for(var g=Object.values(l.childNodes),m=0;m<g.length;m++){var _=g[m],v=_.querySelector(".js-badge-wrapper");if(null!==v){var f=s(_).data("message");if(f&&0!==f.length){var b=JSON.parse(f);at(v,{badges:st(b),size:ot.XSmall,getTitle:nt,getLink:rt,isShort:!0})}}}var w=this._$data.get(0);w.insertBefore(l,w.firstChild),e()}else e()},$t.prototype._renderPineElements=async function(t){constel)};for(const s of t){const t=t=>{this._scroll.scrollTo(s,{position:"top"}),t()};await _t(s,{scrollToWidget:t,onTransitionEnd:i,isCancelled:e,stretch:!0})}requestAnimationFram()))},$t.prototype._getNewUnreadMarker=function(){return this._$unreadMarker?s():this._updateUnreadMarker(1)},$t.prototype._resetUnreadMark)},$t.prototype._updateUnreadMarker=function(t){return this._resetUnreadMarker(),this._$unreadMarker=s('<div class="js-unread-marker ch-unread-marker">'),this._scroll.subscribeToContentVisible("__marker__",this._$unreadMarker[0],function(e){if(e||this._bridge.postMessage("private_message_read",{id:"__marker__"}),this._checkMessageBatchQuantity(t))this._$unreadMarker.remove();else{this._$unreadMarker.addClass("js-vanish");var i=this._$unreadMarker;setTimeout((function(){i.remove()}),2500)}delete this._$unreadMarker}.bind(this)),this._$unreadMarker},$t.prototype._parseMessageTime=function(t){return a.utc(t,"ddd MMM DD hh:mm:ss YYYY","en").toDate()},
$t.prototype.insertAtCursorPosition=function(t){var e=this._$inputEdit.val(),i=this._$inputEdit.prop("selectionStart");this._$inputEdit.val(e.slice(0,i)+t+e.slice(i)),this._$inputEdit.putCursorAtPosition(i+t.length),c.update(this._$inputEdit).focus()},$t.prototype.privateChatCounter=function(){if(this.isPrivate()){var t=this._bridge.membersCount(),e=document.getElementById("js-members-count");if(t>1){var s=i.tf(null,{plural:"{membersCount} users",count:t,replace:{membersCount:t.toString()}},i(530805));e.innerHTML=s}else e.innerHTML=""}},$t.prototype.prepareLayout=function(t){var e=this;if(this._$container=t,this._$widget=s('<div class="tv-chat">').appendTo(t),this._$scrollContainer=s('<div class="tv-chat-scroll-container">').appendTo(this._$widget),this._$scrollContainer.on("contextmenu",(function(t){t.target.classList.contains("tv-chat-scroll-container")&&t.preventDefault()})),this._$data=s('<div class="ch-data no-messages">').appendTo(this._$scrollContainer),this._$data.on("click",".ch-item",(function(t){At(t.target)||e.toggleHighlightUserMessages(s(t.currentTarget))})).on("mouseenter",".ch-item",(function(){var t=s(this),e=t.find(".ch-item-info");t.find(".ch-item-header").width()-(t.find(".ch-item-author").width()+e.width())<t.find(".js-actions").width()&&e.addClass("js-hidden")})).on("mouseleave",".ch-item)})),this._$input=s(),this.isEmbedded())return;if(this._bridge&&this._bridge.$headerspace&&(this.isPrivate()||this.isStandalone()||(this._$mentionsButton=s('<a class="button apply-common-tooltip" title="'+i.tf(null,void 0,i(766178))+'" data-role="button" data-name="mentions"></a>').append(s(i(122694)).attr({width:28,height:28})).appendTo(this._bridge.$headerspace),this._$mentionsButton.on("click1}))),this._bridge.hideMaximize||(this._bridge.options||{}).hideMaximize||"function"!=typeof this._bridge.toggleMaximize||(this._$maximizeButton=s('<a class="button apply-common-tooltip" title="'+(this._bridge.maximized.value()?i.tf(null,void 0,i(194787)):i.tf(null,void 0,i(403212)))+'" data-role="button" data-name="maximize"></a>').append(s(i(718043)).attr({width:28,height:28})).appendTo(this._bridge.$headerspace),this._$maximizeButton.on("click",(function(t){e._bridge.toggleMaximize(),e.resize(),e._$maximizeButton.prop("title",e._bridge.maximized.value()?i.tf(null,void 0,i(194787)):i.tf(null,void 0,i(403212))),t.preventDefault()})),this._bridge.hideDetach||this._$maximizeButton.addClass("button-half"),this._bridge.maximized&&(this._onMaximized=function(t){e._$maximizeButton.toggleClass("active",!!t),e.resizeHeader(),e.resize()},this._bridge.maximized.subscribe(this._onMaximized),this._bridge.maximized.value()&&this._$maximizeButton.addClass("active"))),this._bridge.hideDetach||(this._$detachButton=s('<a class="button apply-common-tooltip svg-detach" title="'+i.tf(null,void 0,i(681326))+'" data-role="button" data-name="detach"></a>').append(s(i(899280)).attr({width:28,height:28
})).appendTo(this._bridge.$headerspace),this._$detachButton.on("click touchend",(function(t){t.preventDefault(),$t.openBoundWindow({roomId:e.currentRoom(),isPriva)}})})),this._$maximizeButton&&this._$detachButton.addClass("button-half button-nomarginleft")),e.privateChatCounter(),this.isPrivate())){var o=this._bridge.isAuthor?i.tf(null,void 0,i(293643)):i.tf(null,void 0,i(615880));this._$addButton=s('<a class="button apply-common-tooltip" id="add-people" title="'+o+'" data-role="button" data-name="add-people">').append(s(i(703074)).attr({width:28,height:28})).prependTo(this._bridge.$headerspace),this._$addButton.on("click)}))}this._$inputWrap=s('<div class="ch-input">').appendTo(this._$widget),this._$progressBarWrap=s('<div class="progress-bar-wrap">').appendTo(this._$inputWrap),this._$progressBar=s('<div class="progress-bar">').appendTo(this._$progressBarWrap),this._$input=s('<div class="wrap">').appendTo(this._$inputWrap),this._$inputDisabledMessage=s('<div class="ch-disabled-message">'+i.tf(null,void 0,i(187513))+"</div>").prependTo(this._$inputWrap),this._$invalidLinkMessage=s('<div class="ch-disabled-message">'+i.tf(null,void 0,i(364494))+"</div>").prependTo(this._$inputWrap),this._$inputSnapshotLink=s('<div class="ch-snapshot-link"><a><img src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="Screenshot preview"></a><i class="icon icon-snapshot-small" title="Chart Snapshot"></i> <a target="_blank">'+i.tf(null,void 0,i(645888))+'</a><i class="icon icon-snapshot-delete" title="'+i.tf(null,void 0,i(614319))+'"></i> </div>').prependTo(this._$inputWrap),this._$inputSnapshotLink.find(".icon-snapshot-delete").on("click",this.attachSnapshot.bind(this)),this._$inputEditSizer=s('<div class="ch-textarea-sizer"></div>').appendTo(this._$input);var a=this.isPrivate()?i.tf(null,void 0,i(146686)):i.tf(null,void 0,i(757808));this._$inputEdit=s('<textarea class="message-input" autocomplete="off" enterkeyhint="send"></textarea>'),this._$inputEdit.appendTo(this._$inputEditSizer),c(this._$inputEdit),this._$inputEdit.on("autosize:resized",(function(){var t=e._$inputEdit.height();if(t!==e._header_height){var i=e._$inputEdit.outerHeight();e._header_height=t,e._$input.height(i),e.resizeHeader()}})),this._$inputEdit.attr("placeholder",a);const n=this._$inputEdit.get(0);this._destroyPineCodeListener=M()})),m(this._getHintListOptions()).then((function(t){e._hintListElement=t;var i=e._$container.parent().parent();s(e._hintListElement).appendTo(i),e._$inputEdit[0].addEventListener("keydown",(function(t){var i=ut(t);if(i!==gt.ENTER||t.defaultPrevented||(t.preventDefault(),e.post()),i===gt.ENTER+pt.Mod||i===gt.ENTER+pt.Shift){t.preventDefault();var s=e._$inputEdit.val(),o=e._$inputEdit.prop("selectionStart");e._$inputEdit.val(s.slice(0,o)+"\n"+s.slice(o)).putCursorAtPosition(o+1),c.update(e._$inputEdit)}})),e._$inputEdit[0].addEventListener("paste)}))})),this._$snapshotButton=s('<span class="ch-snapshot-button" title="'+i.tf(null,void 0,i(549428))+'"></span>').append(s(i(661963)).attr({width:16,height:13})).on("click",this.attachSnapshot.bind(this)).on("contextmenu",(function(t){t.preventDefault()})).appendTo(this._$inputEditSizer),this._$smilesButton=s('<span class="ch-smiles-button" title="'+i.tf(null,void 0,i(767217))+'"></span>').append(s(i(633502)).attr({width:18,height:18})).on("click",this.showSmilesPopup.bind(this)).on("contextmenu)})).appendTo(this._$inputEditSizer),this._bridge&&this._bridge.getChartWidget&&this._bridge.getChartWidget()||(this._$snapshotButton.hide(),this._$smilesButton.addClass("off-chart")),this._scroll=new W(this._$scrollContainer[0],this._$data[0],{vAlignBottom:!0,headerHeight:0}),this._onBridgeVisibleChange=function(t){if(t){if(setTimeou)}),1e3),!e.isPrivate()){var i=e._model.room();e._model.setRoom(""),e.updateRoom(i)}}else e._model.setActive(t);t&&e.isPrivate()&&e._model.setMessagesRead(),t&&(e._$inputEdit&&c.update(e._$inputEdit),e.resizeHeader(),e._notInitialVisible||(e._scroll.scrollToEnd(),e._notInitialVisible=!0),e.inputEditFocus())},this._bridge.visible.subscribe(this._onBridgeVisibleChange),s(window).on("visibilitychange)})),this._bridge.visible.value()&&(this._notInitialVisible=!0),this._scroll.scrolltostart.subscribe(this,(function(){e._model.isHistoryLoading()||e._isHistoryEnded||e._init_history_loading||e._loadChatHistory()})),is_authenticated&&user&&user.is_moderator&&this.prepareModeratorLayout(),this.sound=new g.ChatSoundControl(this.isPrivate()?"privatemessages.sound":"chat.sound"),this.progressBar=new g.ChatProgressBar(this._$progressBar,200,90,5,[200,200,400])},$t.prototype._getHintListOptions=function(){var t=this,e=this.isStandalone()?this._$container.parent()[0]:this._$container.parent().parent().parent()[0];return{fullBorder:!0,maxItems:5,suggestLimit:5,className:d.userNameHintList,closeOnMouseOutClick:!0,input:this._$inputEdit[0],container:e,onItemSelected:function(e,i,s){t._$inputEdit.val(i).putCursorAtPosition(s),c.update(t._$inputEdit)}}},$t.prototype.prepareModeratorLayout=function(){this._$warningTemplates=s('<div class="ch-button ch-warning-templates-button"></div>').on("click",this.warningTemplatesPopup.bind(this)).insertAfter(this._$inputEditSizer),this._$widget.addClass("moderator-layout"),r.render(n.createElement(h,{startIcon:i(466563),variant:"primary",size:"small",title:i.tf(null,void 0,i(575271))}),this._$warningTemplates[0]),D(this._$warningTemplates,null,{event:"show-popup",hideEvent:"hide-popup",addClass:"ch-popup ch-warning-templates-popup",careRightBorder:!0,viewportSpacing:2,reverse:!0,popupDrift:68})},$t.prototype.warningTemplatesPopup=function(t){var e=I().map(function(t){return{title:t.name,action:this.initMessageTypeWarning.bind(this,t.text,t.id)}}.bind(this));e.push({title:i.tf(null,void 0,i(610264)),action:this.initMessageTypeWarning.bind(this,"",null)
}),e.push({separator:!0}),e.push({title:i.tf(null,void 0,i(620036)),action:this.resetMessageType.bind(this)}),s(t.target).trigger("show-popup",[e]),t.stopPropagation()},$t.prototype.initMessageTypeWarning=function(t,e){(t=(this._$inputEdit.val()?this._$inputEdit.val()+" ":"")+t)&&(this._$inputEdit.val(t),c.update(this._$inputEdit).putCursorAtEnd()),this._$inputWrap.addClass("custom-message-warning"),setTimeout(function(){this._$warningTemplates.addClass("active")}.bind(this),0),this._messageType="warning",this._warningType=e},$t.prototype.resetMessageType=function(t){this._$inputWrap[0].className=this._$inputWrap[0].className.replace(/\bcustom-message-.*?\b/g,""),this._$warningTemplates.removeClass("active"),delete this._messageType,delete this._warningType},$t.prototype.messageAuthorToDonationUser=function(t){return{id:t.user_id,username:t.username,avatars:{small:t.user_pic||""},is_broker:t.is_broker,badges:t.badges}},$t.prototype.getDonateQoute=function(t,e){return'[quote="'+e.username.replace(/\s/g," ")+'"]'+this.getFullMessage(t,e)+"[/quote]\n"},$t.prototype.donate=function(t,e){E({closeOnEsc:!0,donationUserInfo:this.messageAuthorToDonationUser(e),donationKind:this.isPrivate()?"private_chats":"public_chats",targetObjectId:e.room_id,chatMessage:this.getDonateQoute(t,e)})},$t.prototype.showSettingsDialog=function(t,e){return s(t.delegateTarget).hasClass("open")?(s(t.delegateTarget).trigger("hide-popup"),!1):(new g.ChatSettingsDialog(this._bridge,(function(e,i){s(t.delegateTarget).trigger("show-popup",[e,i])}),e||this._model.getRooms()),t.preventDefault(),!1)},$t.prototype.editRoom=function(t){i(182534).prototype.showEditRoomDialog.call(this,t)},$t.prototype.deleteRoom=function(t){var e=this;H({text:i.tf(null,void 0,i(255905)).format({name:t.title}),onConfirm:function(s){return new Promise((function(o){e._model.deleteRoom(t.room_id,(function(t){o(),s.dialogClose(),t.error&&N({title:i.tf(null,void 0,i(482751)),content:t.error})}))}))}})},$t.prototype.saveInputText=function(){var t=this._$inputEdit.val().trim();t&&(window.user._chatInputs[this.currentRoom()]=t)},$t.prototype.restoreInputText=function(){this.currentRoom()in window.user._chatInputs&&(this._$inputEdit.val(window.user._chatInputs[this.currentRoom()]),c.update(this._$inputEdit),delete window.user._chatInputs[this.currentRoom()])},$t.prototype.selectChannel=function(t){if(!this._checkRoom(t))throw new Error("Chat room not found");if(this._roomTitle=this.getRoomTitle(t),this._bridge&&this._bridge.properties&&this._bridge.properties.setValue){var e=this._bridge.properties.value()||{};e.room=t,this._bridge.properties.setValue(e)}this.updateRoom(t)},$t.prototype._checkRoom=function(t){return!!(this._model.getRoomById(t)||t.match(/pm_*/)||t.match(/live_*/))},$t.prototype.getText=function(t){return this._$inputEdit.val()||t},$t.prototype.clearInput=function(){this._$inputEdit.val("")},$t.prototype.post=function(t){var e=this,s=e._postMeta||{text:""};if(this.checkInput(),!this._inputDisabled){if(bt(wt.SOCIAL_ACTIVITY)||this.isPrivate()||Ct("new")||St()){
var o=this.currentRoom(),a=this._model.getRoomById(o);e._sheduledSending=function(){var n=t||e._$inputEdit.val();if(!n&&!s.text)return!1;e._$inputEdit.val(""),c.update(e._$inputEdit),"snapshot"!==s.type&&n&&e.inputEditFocus();var r={};e._messageType&&(r.messageType=e._messageType,e._warningType&&(r.warningType=e._warningType),e.resetMessageType());var h=(new Date).getTime();e.progressBar.start(h),e._model.sendMessageToRoom(o,n,s,r,(function(t){var o=t.error||t.warning;if(o){var r=t.title;let s;t.code===K&&(s=Q(o,Z.CreateMessageChat),X(Z.CreateMessageChat,G.Open)),"phone_not_verified"===t.code?(e.inputEditBlur(),e._$inputEdit.val(n),c.update(e._$inputEdit),e.progressBar.finishOnError(h)):u({title:t.error?r||i.tf(null,void 0,i(482751)):r||i.tf(null,void 0,i(533603)),html:s||o,onClose:function(){e.inputEditFocus()}}).then((function(){e.inputEditBlur(),e._$inputEdit.val(n),c.update(e._$inputEdit),e.progressBar.finishOnError(h)}))}else e.progressBar.finish(h),j(a,n,s)}),(function(){e.progressBar.finishOnError(h),N({title:i.tf(null,void 0,i(482751)),content:i.tf(null,void 0,i(744268))}),e._$inputEdit.val(n),c.update(e._$inputEdit)})),e._postMeta=null,e._$snapshotButton.removeClass("active"),e._$inputSnapshotLink.hide(),e.resizeHeader()};var n={source:"Chat post message",sourceMeta:this.getChartWidgetCollection()?"Chart":null,verifiedPhoneRequired:!0,doNotCheckSuspicious:!0};return runOrSignll}),n),!1}yt({feature:"socialActivity"})}},$t.prototype.resize=function(t){this._scroll.resize(),this._$inputEdit&&c.update(this._$inputEdit)},$t.prototype.updateTitle=function(t){this._bridge&&this._bridge.setTitle&&this._bridge.setTitle(this._roomTitle)},$t.prototype.validateLanguageCheck=function(t){var e=!1;if("en"===window.language){var i=this._model.getRoomById(this.currentRoom());e=!!i&&!!i.pinned&&!O(t)}return e},$t.prototype.checkInput=function(){var t=this._$inputEdit.val(),e=this.validateLanguageCheck(t),i=ct(t);this._$inputEdit.toggleClass("disabled",e||!i),this._$inputDisabledMessage.toggle(e),this._$invalidLinkMessage.toggle(!i),e!==this._inputDisabled&&this.resizeHeader(),this._inputDisabled=e||!i},$t.prototype.resizeHeader=function(){this._$scrollContainer.css("bottom",this._$inputWrap.outerHeight()),this._scroll.resize()},$t.prototype.getChartWidgetCollect()},$t.prototype.attachSnapshot=function(){var t=this,e=this.getChartWidgetCollection();if(e){if(t._postMeta)t._postMeta=null,t._$snapshotButton.removeClass("active"),t._$inputSnapshotLink.hide(),t.resizeHeader();else{va")},a={previews:["thumb"],onInvalidSnapshotImage:o};t._$snapshotButton.addClass("loading"),S(e,(function(e){var o=Y.createSnapshotImageUrls(e);t._postMeta={text:i.tf(null,void 0,i(511938)),url:o.url,preview_url:o.preview,type:"snapshot"},t._$snapshotButton.removeClass("loading").addClass("active")
;var a=t._$inputSnapshotLink.show().find("a");a.attr("href",o.url),s(a).eas)})),t._$inputSnapshotLink.find("img").attr("src",o.url).on("load",t.resizeHeader.bind(t)),t.inputEditFocus()}),o,a)}return!1}},$t.prototype.toggleSnaphotPreview=function(t){this._showSnapshotPreview=void 0!==t?t:!this._showSnapshotPreview,TVSettings.setValue("chat.show_snapshot_preview",this._showSnapshotPreview),this._$widget.toggleClass("show-snapshot-preview",this._showSnapshotPreview),this.resize()},$t.prototype.toggleHighlightUserMessages=function(t){var e=t.attr("class").match(/ch-item-user-(\d+)/)[1],i=!t.hasClass("ch-highlight-user");s(".ch-item").removeClass("ch-highlight-user"),e&&i&&this._$data.find(".ch-item-user-"+e).addClass("ch-highlight-user")},$t.prototype.destroy=function(){this._isHistoryEnded=!0,this.isPrivate()&&this.saveInputText(),this._sheduledSending&&(this._sheduledSending(),this._sheduledSending=null),this._destroyPineCodeListener&&this._destroyPineCodeListener(),(document.querySelectorAll(".ch-data > .ch-item")||[]).forEat)})),this._model.messageReceived().unsubscribe(this,this._onMessageWrapper),this._model.messageDeleted().unsubscribe(this,this._onMessageDeleted),this._model.roomChanged().unsubscribe(this,this._onRoomChanged),this._model.destroy(),this._model=null,window.loginStateChange.unsubscribeAll(this),this._scroll.scrolltostart.unsubscribeAll(this),this._bridge.visible.unsubscribe(this._onBridgeVisibleChange),this._bridge.symbol&&this._onSymbolChanged&&this._bridge.symbol.unsubscribe(this._onSymbolChanged),this._bridge.interval&&this._onIntervalChanged&&this._bridge.interval.unsubscribe(this._onIntervalChanged),this._bridge.height&&this._onResize&&this._bridge.height.unsubscribe(this._onResize),this._bridge.width&&this._onResize&&this._bridge.width.unsubscribe(this._onResize),this._bridge.maximized&&this._onMaximized&&this._bridge.maximized.unsubscribe(this._onMaximized),this.destroyLikesHandlers(),q.jQueryCompatibleDestroy(this._$data),this.sound.destroy(),this._bridge&&this._bridge.$headerspace&&this._bridge.$headerspace.empty(),v(this._hintListElement)},$t.openBoundWindow=function(t){var e="";e=t.isPrivate()?"/chat/"+t.roomId+"/":"/chat/#"+t.roomId,$.open({url:e,parameters:{menubar:!1,location:!1,status:!1,directories:!1,width:470,height:600}}),U("GUI","Chat Detached")},$t.prototype.toggleMentionsOnly=function(){this._mentionsOnly=!this._mentionsOnly,this._$data.toggleClass("mentions-only"),this._scroll.scrollToEnd(),this._$mentionsButton.toggleClass("active")},$t.prototype.showSmilesPopup=function(t){var e=this,i=s('<div class="ch-smiles-popup">').appendTo(document.body);V.each((function(t){if(t.showInPopUp){var e=s('<div class="emoji-container js-emoji" title="'+t.code+'">');e.data("code",t.code),e.append(V.getElement(t)),e.appendTo(i)}})),i.on("click",".js-emoji",(function(t){var o=e._$inputEdit.val(),a=e._$inputEdit.prop("selectionStart"),n=a>0&&" "!==o.charAt(a-1)?" ":"",r=a<o.length&&" "!==o.charAt(a)?" ":""
;e.insertAtCursorPosition(n+s(t.target).closest(".js-emoji").data("code")+r),i.remove()}));var o=this._$smilesButton.offset(),a=this._$smilesButton.outerWidth(),n=this._$smilesButton.outerHeight(),r=o.top+n/2,h=o.left+a/2,l=15,d=i.outerHeight(),c=i.outerWidth(),u="top",p=!0,g=h-c/2,m=s(document).width(),_=s(window).width();g+c+10>_&&(g=_-(c+10),m-h<20&&(p=!1,l=10));var v=r+l,f=s(window).height(),b=s(window).scrollTop(),w=s(window).scrollLeft();v-b+d+l>f&&(v=r-d-l,u="bottom"),p&&s('<div class="ch-smiles-caret ch-smiles-caret-'+u+'">').css("left",h-g-w).prependTo(i),i.css({left:g+w,top:v}).on("mousedownoutsid()}))},$t.prototype.inputEditFocus=function(){ft||this._noAutoFocus||this._$inputEdit&&this._$inputEdit.focus()},$t.prototype.inputEditBlur=function(){this._$inputEdit&&this._$inputEdit.blur()},$t.getLaunchInSeparateWindowAction=function(t,e){return{title:i.tf(null,void 0,i(655721)),act})}}},$t.prototype.destroyLikesHandl()},$t.prototype.updateLikesHandlers=function(){this.destroyLikesHandlers(),this._chartLikesHandler=g.ChatLikesHandler.getChartsHandler(),this._snapshotMessagesLikesHandler=g.ChatLikesHandler.getMessagesSnapshotsHandler()},t.exports=$t},741749:(t,e,i)=>{"use strict";i.d(e,{trackChatEvent:()=>c});var s=i(345848),o=i(201348);const a=/((https?:\/\/)|(www\.))(-\.)?([^\s/?.#]+\.)+([^\s<>]*)?/g,n=/^(https?:\/\/).*tradingview.com/,r=/tradingview.com\/(chart|script)\//,h=/(image|i)\/([0-9a-zA-Z]{8})\/$/,l=/x\/([0-9a-zA-Z]{8})\/(.+?)?\/?$/,d=/^pm_.{16}/;function c(t,e,i){const c=d.test(t.room_id),u=c?"pm":"public chat",p=function(t){const e=[];return o.emoji.each((i=>{t.search(i.re)>=0&&e.push(i.code)})),e}(e),g=p.length>0,m=function(t){const e={snapshot:0,chart:0,internal:0,external:0},i=t.match(a);return null!==i&&i.forEach((t=>{n.test(t)?l.test(t)||h.test(t)?e.snapshot++:r.test(t)?e.chart++:e.internal++:e.external++})),e}(e);e&&c?(0,s.trackEvent)("Chat",`Send message to ${u}`):e&&!c&&(0,s.trackEvent)("Chat",`Send message to ${u}`,String(t.title)),(i&&"snapshot"===i.type||m.snapshot>0)&&(0,s.trackEvent)("Chat","Send chart snapshot",u),m.chart>0&&(0,s.trackEvent)("Chat","Send chart link",u),m.internal>0&&(0,s.trackEvent)("Chat","Send internal link",u),m.external>0&&(0,s.trackEvent)("Chat","Send external link",u),g&&p.forEat)}))}},113600:(t,e,i)=>{"use strict";var s=i(823127),o=i(91326).openIgnoreUsersDialog,a=i(402243).whenVerified,n=i(348735),r=i(226722).TVXWindowEvents,h=i(120780).fetch;function l(t,e,i,s,o){this._$bar=t,this._value=0,this._state="off",this._halt=i,this._tick=s,this._step=this._halt*this._tick/e,this._animations=o}function d(t,e,s){var o=i(182534);this._bridge=t,this._handler=e,this._rooms=s,this.favoritesSettings=o.prototype.getLocalizedJsonSetting("publiccharts.favorites",{}),this.state={slowMode:!1},
this.getAsyncState().then((t=>{this.state={...this.state,...t},this._handler(this.getMenu())}))}function c(t){this._settingsKey=t,this.state=this._getState(),this._updateSettingsListener=this._setFromAnother.bind(this),r.on("chat-sound-control-changed",this._updateSettingsListener),loginStateChange.subscribe(null,this._updateSettingsListen[]}l.prototype.start=function(t){"running"===this._state&&this.stop(),this._transaction=t,this._$bar.css("opacity","1"),this._$bar.css("background-color","#18BE8A"),this._state="running",this._intervalID=setInterval(this.update.bind(this),this._tick)},l.prototype.s=0},l.prototype.update=function(){this._value>=this._halt?this.stop():"running"===this._state&&(this._value+=this._step,this._$bar.width(this._value+"%"))},l.prototype.finish=function(t,e){"off"!==this._state&&this._transaction===t&&(this.stop(),this.transaction=-1,e&&this._$bar.css("background-color","red"),this._state="off",this._$bar.animate({width:"100%"},this._animations[0]),this._$bar.animate({opacity:"0"},e?this._animations[2]:this._animations0)}.bind(this)))},l.prototype.finishOnEr0)},d.prototype.soundSettings=[{title:i.tf(null,void 0,i(464142)),state:{onMessage:!0,onMessageForUser:!0}},{title:i.tf(null,void 0,i(285022)),state:{onMessage:!1,onMessageForUser:!0}},{title:i.tf(null,void 0,i(550420)),state:{onMessage:!1,onMessageForUser:!1}}],d.prototype.getAsyncState=function(){return new Promise((t=>{!this._bridge.private_chat&&window.is_authenticated&&window.user.permissions.can_moderate_public_chats?h(`/chats/public/state/${this._bridge._room}/`).th()})).then((e=>{e&&void 0!==e.slow_mode?t({slowMode:e.slow_mode}):t(this.state)})):t(this.state)}))},d.prototype.toggleSlowMode=function(){const t={slow_mode:!this.state.slowMode};h(`/chats/public/state/${this._bridge._room}/`,{method:"POST",body:JSON.stringify(t)})},d.prototype.getMenu=function(){var t=[],e=this,s=i(372301),a=i(182534);if(this._bridge.private_chat&&!this._bridge.standalone&&(t=t.concat(this._bridge.privateMenuItems().multiUserActions)).length&&t.push({separator:!0}),(t=t.concat(this.soundMenuItems(this.soundSettings,TVSettings.getJSON(this._bridge.private_chat?"privatemessages.sound":"chat.sound",c.prototype._default_state)))).push({separator:!0}),this._bridge.standalone||this._bridge.options&&this._bridge.options.layoutWithSelect||(this._bridge.private_chat||t.push(this._bridge.chatNotificationControl.onsiteMenuItem()),t.push(this._bridge.chatNotificationControl.emailMenuItem()),t.push({separator:!0})),t.push({title:i.tf(null,void 0,i(613531)),icon:{image:"url('/static/images/dialogs/checkbox.png')",offset:TVSettings.getBool("chat.show_snapshot_preview")?"0 -16px":void 0},action:function(t){this._bridge.postMessage("toggle_snaphot_preview")}.bind(this)}),
!this._bridge.private_chat&&window.is_authenticated&&window.user.permissions&&window.user.permissions.can_moderate_public_chats&&t.push({title:i.tf(null,void 0,i(569920)),icon:{image:"url('/static/images/dialogs/checkbox.png')",offset:this.state.slowMode?"0 -16px":void 0},action:()=>this.toggleSlowMode()}),this._bridge.private_chat||this._bridge.standalone||t.push({title:i.tf(null,void 0,i(930863)),icon:{image:"url('/static/images/dialogs/checkbox.png')",offset:TVSettings.getBool("chat.show_only_favorites")?"0 -16px":void 0},action:function(t){this._bridge.postMessage("toggle_show_only_favorites")}.bind(this)}),this._bridge.private_chat&&t.push({title:i.tf(null,void 0,i(793242)),icon:{image:"url('/static/images/dialogs/checkbox.png')",offset:TVSettings.getBool("chat.show_unread_top")?"0 -16px":void 0},act")}.bind(this)}),t.push({separator:!0}),this._bridge.private_chat&&!this._bridge.standalone){var n=this._bridge.privateMenuItems();t.push(n.markAsUnread),t.push(n.hideConversation)}if(t.push({title:i.tf(null,void 0,i(965668)),action:function(t){runOrSign()}),{source:"Chat ignore list"})}}),!this._bridge.standalone){for(var r,h=(!this._bridge.private_chat&&this._bridge._room in this.favoritesSettings),l=0;l<this._rooms.length;l++)if(this._rooms[l].room_id===this._bridge._room){r=this._rooms[l];break}if(r){t.push({separator:!0});var d=s.getLaunchInSeparateWindowAction(e._bridge._roat}));this._bridge.private_chat?t.push(d):(r.pinned||t.push({title:h?i.tf(null,void 0,i(823057)):i.tf(null,void 0,i(445847)),actt)}.bind(this,this._bridge._room)}),(t=t.concat(a.publicMenuItems(this._bridge._room,this._bridge))).push(d),r.pinned||((r.user_id===user.id||window.user.permissions&&window.user.permissions.can_moderate_public_chats)&&t.push({title:i.tf(null,void 0,i(446315)),action:function(t){this._bridge.postMessage("chat_edit_room",this._bridge._room)}.bind(this)}),window.user.permissions&&window.user.permissions.can_moderate_public_chats&&t.push({title:i.tf(null,void 0,i(177517)),actm)}.bind(this)})))}}return t},d.prototype.upd0)},d.prototype._radioIcon="data:image/gif;base64,R0lGODlhBgAGAMIGAIuMjo+QkpOUlrS1tra2uLe4uf///////yH5BAEKAAcALAAAAAAGAAYAAAMQeCVSRyACEiQIVYZhx2NOAgA7",d.prototype.soundMenuItems=function(t,e){return"boolean"==typeof e&&(e=s.extend(c.prototype._default_state,{onMessage:e})),t.map(function(t){var i=!0;for(var s in e)if((s in t.state||!e[s])&&t.state[s]!==e[s]){i=!1;break}return t.icon={image:"url("+this._radioIcon+")"},t.icon.offset=i?{x:5,y:5}:{x:-30,y:-30},t.action=function(e){this._bridge.postMessage("chat_set_sound_state",{isPrivate:!!this._bridge.private_chat,state:t.state})}.bind(this),t}.bind(this))},c.prototype._default_state={onMessage:!1,onMessageForUser:!0},c.prototype._getState=function(t){
var e=s.extend({},this._default_state),i=TVSettings.getJSON(this._settingsKey,null,t);return null!==i&&("boolean"==typeof i?s.extend(e,{onMessage:i}):s.extend(e,i)),e},c.prototype.set=function(t){this._set(t),TVSettings.setJSON(this._settingsKey,this.state),r.emit("chat-sound-control-changed")},c.prototype._setFromAnot))},c.prototype._t)},c.prototype.dest))},u._likesMonitoringModel=null,u._createLikesMonitoringModelIfNee))},u.getChartsHandler=function(){u._createLikesMonitoringModelIfNeeded();var t=u._likesMonitoringModel;return new u(t.voteForChart.bind(t))},u.getMessagesSnapshotsHandler=function(){u._createLikesMonitoringModelIfNeeded();var t=u._likesMonitoringModel;return new u(t.voteForMessageWithSnapshot.bind(t))},u.prototype.getIdeaByID=function(t,e){for(var i=0;i<this.ideas.length;i++)if(this.ideas[i].id===t)return e?i:this.ideas[i];return!1},u.prototype.addIdea=function(t,e,i,o,a){var n=this.getIdeaByID(e);n?n.elements.push(t):(n=new u.Idea(e,i,o,t),this.ideas.push(n)),s(t).on("click",this.onClickUpdateVote.bind(this,n,a)),n.updateView()},u.prototype.onClickUpdateVote=function(t,e=null){if(window.user.id){var i=this;a({showDialog:!0,source:"Widgetbar vote"}).done((function(){if(t.blocked||t.voteStatus<0)return;t.blocked=!0;const s=!!(1-t.voteStatus);i.voteSender(t,s,(o=>{i.onData(t,s,o.score),e&&e(o)}))}))}else runOrSig1)}.bind(this),{source:"Widgetbar vote",verifiedPhoneRequired:!0})},u.prototype.onData=function(t,e,i){t.likes=i,t.voteStatus>=0&&(t.voteStatus=e,t.blocked=!1),t.updateView(!1)},u.prototype.dest){},u.Idea=function(t,e,i,s){this.id=t,this.likes=e,this.voteStatus=i,this.elements=[s]},u.Idea.prototype.updateView=function(t){var e=s(this.elements);e.toggleClass("js-has-likes",!!this.likes),setTimeout(function(){e.find(".js-likes-counter").text(this.likes?this.likes:"")}.bind(this),75),e.toggleClass("active",!!this.voteStatus),t&&(e.removeClass("js-like-highlight"),setTimeo")}),10))},e.ChatProgressBar=l,e.ChatSettingsDialog=d,e.ChatSoundControl=c,e.ChatLikesHandler=u},689492:(t,e,i)=>{"use strict";function s(t,e,s,o){return Promise.all([i.e(35213),i.e(63830),i.e(1888),i.e(60512),i.e(69704),i.e(63165),i.e(87461),i.e(88748),i.e(25977),i.e(11595),i.e(31549)]).then(i.bind(i,918389)).th,o)))}i.d(e,{showDialog:()=>s})},867109:(t,e,i)=>{"use strict";i.d(e,{destroyUsernameHintList:()=>h,getUserChatSuggestListHandler:()=>r,getUsernameHintList:()=>n});var s=i(50959),o=i(500962),a=i(650151);async function n(t){const e=await Promise.all([i.e(68795),i.e(96911)]).then(i.bind(i,820107)),a=document.createElement("div")
;return o.render(s.createElement(e.UsernameHintList,t),a),a}async function r(t){return(await Promise.all([i.e(68795),i.e(96911)]).then(i.bind(i,820107))).getUserChatSuggestListHandler()}function h(t){o.unmountComponentAtNode((0,a.ensureNotNull)(t))}},814729:(t,e,i)=>{"use strict";i.d(e,{Widget:()=>Z,sendMessageToUser:()=>Q});var s=i(444372),o=i(182534),a=i.n(o),n=i(372301),r=i.n(n),h=i(504368),l=i(984968),d=i(867109),c=i(373571),u=i(783375),p=i(421448),g=i(155040),m=i(252458),_=i(644142),v=i(432369),f=i(348735),b=i(779923),w=i(55826),y=i(468867),C=i(226722),S=i(741749),M=i(778785),T=i(583912),$=i(180184),R=i(903974),x=i(461495),k=i(712797),A=i(129025),I=i(62802),B=i(707957),E=i(461794),P=i(650151),L=i(125226),W=i(314802),D=i(638456);i(161530),i(905183),i(337708),i(227372);var V=i(329221),N=i.n(V),H=i(823127),z=i(213398);const O="chat.show_unread_top",F="/static/images/favicon/unread_messages/favicon.ico",U="/favicon.ico";let j,X;class Z{constructor(t){this._visibilityToggled=!1,this._flipped=!1,this._roomToBeOpenedWhenAdded=null,this._roomNotifications={},this._headerWrapHieght=0,this._$chatMembersContent=H(),this._$data=H(),this._$chat=H(),this._$chatWidgetContainer=H(),this._$headerWrap=H(),this._$chatMembers=H(),this._$membersActions=H(),this._$settingsButton=H(),this._$addChatButton=H(),this._$inputText=H(),this._$chatBody=H(),this._$widget=H(),this._$dataWrap=H(),this._$inputWrap=H(),this._$select=H(),this._onXWindowNewMessagesRead=()=>{},this._onXWindowChatVisibility=()=>{},this._onXWindowChatStatus=()=>{},this._onXWindowChatOpen=()=>{},this._bridge=t,this._$container=t.$body,this._visible=!1,this._isActiveTab=!0,this._notificationCount=0,this._unreadFlag=!1,this._notificationsMap=new Map,this._model=G(),this._model.roomAdded().subscribe(this,this._onRoomAdded),this._model.roomChanged().subscribe(this,this._onRoomChanged),this._model.roomDeleted().subscribe(this,this._onRoomDeleted),this._model.roomsChanged().subscribe(this,this._onRoomsChanged),this._model.otherRoomMessagesRead().subscribe(this,this._onRoomMessagesRead),this._model.roomMarkAsUnread().subscribe(this,this._onRoomMarkAsUnread),this._model.messageReceivedInOtherRoom().subscribe(this,this._onChatMessage),this._$chatHeadingHeaderspace=this._bridge.$headerspace,this._chatMaximized=new A.WatchedValue,this.layoutWithSelect()||this._chatMaximized.subscrit)})),this._standalone=t.standalone,this._layoutWithSelect=t.layoutWithSelect,this._chatNotificationControl=new l.ChatNotificationControl(!0),this.layoutWithSelect()?(a().prototype.prepareLayoutWithSelect.call(this,!0,this._notAuthMessage()),this.roomChange=new B.Delegate):this._prepareLayout(),0!==this._model.getRooms().length&&this._onRoomsChanged(this._model.getRooms(),[]),this._connect(),this.resize(),t.onMessage&&t.onMessage(this._onBridgeMessage.bind(this)),t.watchedTab&&(this._isActiveTab="private"===t.watchedTab.value(),t.watchedTab.subscribe(this._onActiveTabChange.bind(this))),t.visible.subscribe((e=>{if(this._visible=e,
!e||!this._isActiveTab)return void this._bridge.postMessage("private_chat_hidden",{});this._bridge.postMessage("private_chat_visible",{}),queueMicrotask((()=>this.resize()));const i=I.getValue("privatemessages.activechat","");this._visibilityToggled?this._visibilityToggled=!1:i&&this._getRoomById(i)&&this.openChat(i),this._model.getRooms().forEach((t=>{this._roomNotifications[t.room_id]&&(H("#msg-item-"+t.room_id).highlight(1),this._isCurrentRoom(t.room_id)&&H("#msg-item-"+t.room_id+" .counter").text("0").removeClass("active")),delete this._roomNotifications[t.room_id]})),t.notify(0,{stopHighlightTab:!0,force:!0}),this._updateNotifications()}),{callWithLast:!0}),t.height&&t.height.subscribe(this._onWindowResize.bind(this)),t.width&&t.width.subscribe(this._resizeChat.bind(this)),j=this,setInterval(this._checkUnreadRooms.bind(this),1e3)}destroy(){this._chatWidget&&(this._chatWidget.destroy(),delete this._chatWidget),this._model.roomAdded().unsubscribe(this,this._onRoomAdded),this._model.roomChanged().unsubscribe(this,this._onRoomChanged),this._model.roomDeleted().unsubscribe(this,this._onRoomDeleted),this._model.roomsChanged().unsubscribe(this,this._onRoomsChanged),this._model.otherRoomMessagesRead().unsubscribe(this,this._onRoomMessagesRead),this._model.roomMarkAsUnread().unsubscribe(this,this._onRoomMarkAsUnread),this._model.messageReceivedInOtherRoom().unsubscribe(this,this._onChatMessage),this._model.destroy(),C.TVXWindowEvents.off("messages.openchat",this._onXWindowChatOpen),C.TVXWindowEvents.off("messages.chatstatus",this._onXWindowChatStatus),C.TVXWindowEvents.off("messages.chatvisibility",this._onXWindowChatVisibility),C.TVXWindowEvents.off("messages.newmessagesread",this._onXWindowNewMessagesRead)}addRoom(t,e,i){var s,o,a,n,r;let h=this._model.isRoomHidden(t.room_id);h&&t.new_msgs&&(this._model.removeHiddenRoom(t.room_id),h=!1);const l=t.last_message?y.removeBBCodes((0,E.clean)(t.last_message)):"",d={roomId:t.room_id,isHidden:h,title:(0,E.clean)(this._roomTitle(t)),lastMessage:l},c=H(z.render('<div data-room="{{roomId}}"{{#isHidden}} data-hidden-conversation="true"{{/isHidden}} id="msg-item-{{roomId}}" class="msg-item{{#isHidden}} js-hidden{{/isHidden}}"><div class="title"><div>{{title}}</div><div class="js-badge-wrapper badge"></div></div><div class="desc"><span class="last-message js-last-message">{{lastMessage}}</span></div><div class="counter">0</div></div>',d));if(l.length){const e=H("<time>");e.insertAfter(c.find(".js-last-message")),w.jQueryCompatibleAgoDateFormatter(e,new Date(t.updated&&1e3*t.updated||Date.now()))}this._isCurrentRoom(t.room_id)&&c.addClass("active");const u=H('<div class="userpics"></div>').prependTo(c);let p,g=0;for(let e=0;e<(null!==(o=null===(s=t.members_info)||void 0===s?void 0:s.length)&&void 0!==o?o:0);e++){if(p=null===(a=t.members_info)||void 0===a?void 0:a[e],(null==p?void 0:p.username)===window.user.username)continue;const i=c[0].querySelector(".js-badge-wrapper")
;t.title||2!==(null!==(r=null===(n=t.members_info)||void 0===n?void 0:n.length)&&void 0!==r?r:0)||null===i||void 0===(null==p?void 0:p.badges)||(0,R.renderBadgeAccountWithoutFeaturedBroker)(i,{badges:p.badges,size:$.BadgeSize.XSmall,getTitle:x.getBadgeAccountTitle,getLink:k.getBadgeAccountLink,isShort:!0}),g<4&&(g++,H('<i class="userpic userpic-'+g+((null==p?void 0:p.online)?" online":"")+'"><img src="'+(null==p?void 0:p.user_pic)+'"/></i>').appendTo(u))}return u.addClass("layout-"+g),e?c.prependTo(this._$data).highlight(1):c.appendTo(this._$data),t.new_msgs&&!this._isCurrentRoom(t.room_id)&&(c.find(".counter").addClass("active").text(t.new_msgs),this._notificationCount+=t.new_msgs,i&&(this._roomNotifications[t.room_id]=!0),this._updateNotifications()),this._$data.find(".js-placeholder-message").remove(),h?0:1}openChat(t,e){var i,s,o;null===(i=this._$data)||void 0===i||i.find("div.msg-item").removeClass("active"),H("#msg-item-"+t).addClass("active"),this._markChatAsRead(t),(this._visible&&this._isActiveTab||e)&&this._updateNotifications(),this._isCurrentRoom(t)||(this.layoutWithSelect()||this._flipWidgets(),this.isStandalone()&&C.TVXWindowEvents.emit("messages.chatstatus",+new Date+":"+t),this._bridge.setTitle(this._getRoomTitleById(t)),this.layoutWithSelect()&&this._$select&&this._$select.html(this._getRoomTitleById(t,!0)),this._removePlaceholder(this._$chat),this._closeChat(),this._createChatWidget(t,e),null===(s=this._chatWidget)||void 0===s||s.resize(),this.resize(),this.isStandalone()||I.setValue("privatemessages.activechat",t),this.layoutWithSelect()||this._toggleMaximize(I.getBool("privatemessages.chatmaximized")),this.layoutWithSelect()&&(null===(o=this.roomChange)||void 0===o||o.fire(t)),this._removeToastNotifications(t))}isStandalone(){return this._standalct}resize(){var t;if(!this.layoutWithSelect()){let e=this._$widget.height();e-=(0,P.ensureDefined)(this._searchFilter).getInputHeight(),this._$headerWrap&&(e-=this._$headerWrap.outerHeight()),this._$dataWrap.height(e),null===(t=this.scroll)||void 0===t||t.resize()}this._resizeChat()}sendMessageToUser(t,e){K(this._model,t,e,this._onMessageSentSuccess.bind(thi!0}))}_emitXWindowOnNewMessagesRead(t){this._xWindowNewMessagesReadBuffer?this._xWindowNewMessagesReadBuffer.push(t):(this._xWindowNewMessagesReadBuffer=[t],setTimeout((()=>{const t=(0,P.ensureDefined)(this._xWindowNewMessagesReadBuffer).join(":");C.TVXWindowEvents.emit("messages.newmessagesread",t),delete this._xWindowNewMessagesReadBuffer}),500))}_toggleUnreadTopMessages(){this._showUnreadTopMessages=I.getBool(O),I.setValue(O,!this._showUnreadTopMessages),this._model.updateRooms()}_onBridgeMessage(t,e){"private_message_read"===t&&this._emitXWindowOnNewMessagesRead(e.id),"toggle_show_unread_top"===t&&this._toggleUnreadTopMessages()}_updateNotifications(){const t=this._$data.find(".counter.active").length;0===t&&(this._notificationCount=0),
this._bridge.onUnreadMessagesUpdate?this._onUnreadMessagesUpdate(t):this._bridge.notify(1,{notificationValue:t,clear:!t,force:!0,stopHighlightTab:!1})}_notifyAboutUnreadMessages(){if(!(0,L.isFeatureEnabled)("show_toast_about_unread_message")||(0,W.isOnMobileAppPage)("any")||D.CheckMobile.any())return;const t="TradingView";this._model.getRooms().forEach((async e=>{var s;if(!e.members_info)return;const o=(null===(s=e.members_info)||void 0===s?void 0:s.length)<=2,a=e.new_msgs&&e.new_msgs>0,n=window.user.username!==t&&e.members_info.fi==t));if(o&&a&&n&&(!this._isCurrentRoom(e.room_id)||!this._isActiveTab)){const t=await async function(t,e,s){const{showChatToastNotification:o}=await Promise.all([i.e(48986),i.e(56400),i.e(98899),i.e(43447),i.e(64370)]).then(i.bind(i,540830));return o(t,e,s)}(n.username,e.room_id,this._removeToastNotifications.bind(this,e.room_id));this._notificationsMap.set(e.room_id,t)}}))}_removeToastNotifications(t){var e;this._notificationsMap.has(t)&&(null===(e=this._notificationsMap.get(t))||void 0===e||e(),this._notificationsMap.delete(t))}_checkUnreadRooms(){this._$data.find(".counter.active").length?this._unreadFlag||(this._unreadFlag=!0,this._setTabIcon(F)):this._unreadFlag&&(this._unreadFlag=!1,this._setTabIcon(U))}_setTabt)}_prepareLayout(){const t=this;this._$widget=H('<div class="tv-messages">').appendTo(this._$container),this._$addChatButton=H('<a class="button apply-common-tooltip" title="'+s.t(null,void 0,i(693049))+'" data-role="button" data-name="new-chat">').append(H(i(561720)).attr({width:28,height:28})).click((()=>{window.runOrSignIn(m.newPrivateChatDialog,{source:"Private message dialog",verifiedPhoneRequired:!0})})).appendTo(this._bridge.$headerspace),this._searchFilter=new h.ChatRoomListSearchFilter(this),this._searchFilter.appendButton(this._bridge.$headerspace),this._searchFilter.appendInput(this._$widget),this._$dataWrap=H('<div class="msg-data-wrap">').appendTo(this._$widget),this._$dataWrap.on("contextmenu",(t=>{t.target.classList.contains("msg-data-wrap")&&t.preventDefault()})),this._$data=H('<div class="msg-data">').appendTo(this._$dataWrap),this._$data.on("click",".msg-item",(function(){t._searchFilter&&t._searchFilter.isOpen()&&t._searchFilter.setNewRoom(H("#msg-item-"+H(this).data("room"))),t.openChat(H(this).data("room"))})).on("contextmenu",".msg-item",(function(e){e.preventDefault(),t._showRoomContextMenu(e,H(this).data("room"))})),this._searchFilter.setRoomList(this._$data),this._searchFilter.setOpenCallback((()=>{this._model.loadMoreRooms(1e3)})),window.is_authenticated||this._notAuthMessage().appendTo(this._$data),this.scroll=new _.SidebarCustomScroll(this._$dataWrap[0],this._$data[0]),this.scroll.scrolltoend.subscribe(th()}))}_getMessageItemForRo`)}_onRoomAdded(t){var e,i,s;this.addRoom(t,!0);const o=t.room_id;this._roomToBeOpenedWhenAdded&&this._roomToBeOpenedWhenAdded===o&&(this._roomToBeOpenedWhenAdded=null,
null===(e=this.scroll)||void 0===e||e.animateTo(this._getMessageItemForRoomId(o).position().top),this.openChat(o)),this.isStandalone()&&(null===(s=(i=this._bridge).updateRoomsCount)||void 0===s||s.call(i,this._model.getRooms().length))}_onRoomCha))}_onRoomDeleted(t){this._getMessageItemForRoomId(t.room_id).remove()}_sortRooms(t){return I.getBool(O)?t.slice().sort(this._sortFilter.bind(this)):t.slice()}_sortFilter(t,e){var i,s,o,a;return t.new_msgs&&t.new_msgs>0&&0===e.new_msgs?-1:0===t.new_msgs&&e.new_msgs&&e.new_msgs>0?1:(null!==(i=t.updated)&&void 0!==i?i:0)>(null!==(s=e.updated)&&void 0!==s?s:0)?-1:(null!==(o=t.updated)&&void 0!==o?o:0)<(null!==(a=e.updated)&&void 0!==a?a:0)?1:0}_onRoomsChanged(t,e){var i,s,o,a,n,r;if(!window.is_authenticated)return void(this.isStandalone()&&(null===(s=(i=this._bridge).updateRoomsCount)||void 0===s||s.call(i,0)));if(this._$data.empty(),!t.length)return void(this.isStandalone()?null===(a=(o=this._bridge).updateRoomsCount)||void 0===a||a.call(o,0):this._appendPlaceholder("empty"));this.isStandalone()&&(null===(r=(n=this._bridge).updateRoomsCount)||void 0===r||r.call(n,t.length));const h=0===e.length&&0!==t.length;let l=0;if((t=this._sortRooms(t)).forEach((t=>{l+=this.addRoom(t,!1,h)})),!l)return void this._appendPlaceholder("hidden");const d=this.layoutWithSelect()&&this._bridge.activeRoom?this._bridge.activeRoom:I.getValue("privatemessages.activechat","");h&&this._visible&&d&&this._getRoomById(d)&&this.openChat(d),h||!d||this._getRoomById(d)||this._closeChat(),h&&this._notifyAboutUnreadMessages()}_onChatMessage(t,e,i){var s,o;if(this._model.ignoredUsers().includes(t.user_id))return;const a=H("#msg-item-"+e);a.prependTo(this._$data),!t.type&&this._model.isRoomHidden(e)&&a.hasClass("js-hidden")&&this._showRoom(e,a);const n=a.find(".desc");n.find(".last-message").text(t.username+": "+y.removeBBCodes(t.text));let r=n.find("time");r.length?w.jQueryCompatibleDestroy(r):(r=H("<time>"),r.insertAfter(a.find(".js-last-message"))),w.jQueryCompatibleAgoDateFormatter(r,new Date(t.time));const h=t.user_id!==window.user.id,l=this._model.getRoomById(e);if(h&&(!this._isCurrentRoom(e)||!this._visible)){if(h&&!i&&!t.type&&!this.isStandalone()&&!this.layoutWithSelect()&&window.user.notification_popup&&document.hidden){let i,a;(null!==(o=null===(s=null==l?void 0:l.members_info)||void 0===s?void 0:s.length)&&void 0!==o?o:0)>2?(a=this._roomTitle(l),i=t.username+": "+y.removeBBCodes(t.text)):(a=t.username,i=y.removeBBCodes(t.text)),(0,g.show)(a,i,t.user_pic,(()=>{var t;const i=null===(t=window.widgetbar)||void 0===t?void 0:t.setPage("union_chats");if(i){const t=i.widget("unionchats");t&&t.widgetObject&&t.widgetObject.setTab("private")}this.openChat(e,!1)}),["chat",e])}const n=this._$data.find('div[data-room="'+e+'"] .counter'),r=parseInt(n.text(),10);n.addClass("active").text(r+1),this._notificationCount++,a.highlight(1),this._updateNotifications()
;const d=I.getJSON("privatemessages.sound",null),c=t.text&&y.removeBBCodes(t.text).indexOf("@"+window.user.username)>-1;h&&!i&&(!d||d.onMessage||c&&d.onMessageForUser)&&p.play("chat/popup")}!l||this._roomNotifications[l.room_id]||this._visible||this._isActiveTab||(this._updateNotifications(),this._roomNotifications[l.room_id]=!0)}_connect(){this._onXWindowChatOpen=this._onXWChatOpen.bind(this),this._onXWindowChatStatus=this._onXWChatStatus.bind(this),this._onXWindowChatVisibility=this._onXWChatVisibility.bind(this),this._onXWindowNewMessagesRead=this._onXWNewMessagesRead.bind(this),C.TVXWindowEvents.on("messages.newmessagesread",this._onXWindowNewMessagesRead),this.isStandalone()||(C.TVXWindowEvents.on("messages.openchat",this._onXWindowChatOpen),C.TVXWindowEvents.on("messages.chatstatus",this._onXWindowChatStatus),C.TVXWindowEvents.on("messages.chatvisibility",this._onXWindowChatVisibilit})}_onXWChatOpen(t){if(!this._model.getRooms().length)return;const e=t.indexOf(":"),i=t.indexOf("@"),s=t.substring(e+1,i);this.openChat(s,!0)}_onXWChatStatus(t){if(!this._model.getRooms().length)return;const e=t.split(":")[1];H("#msg-item-"+e+" .counter").text("0").removeClass("active"),this._updateNotifications()}_onXWChatVisibility(t){if(!this._model.getRooms().length)return;const e=t.split(":")[0],i=t.split(":")[1];this._getRoomById(e)&&"hide"===i&&this._hideRoom(e,!0)}_removePlaceholder(t){t&&t.find(".js-placeholder-message").remove(),this.isStandalone()?(this._bridge.$header.show(),this._bridge.$body.find(".js-placeholder-message").remove()):this._$data.find(".js-placeholder-message").remove()}_appendPlaceholder(t,e){let o,a;e?a=e:this.isStandalone()?(this._bridge.$header.hide(),a=this._bridge.$body):a=this._$data,"empty"===t?o=s.t(null,void 0,i(958801)):"hidden"===t&&(a.is(".chat-body")&&H(document.body).addClass("no-chats"),o=s.t(null,void 0,i(933004))),a.append('<div class="msg-empty tv-widget-empty-message js-placeholder-message">'+o+"</divt)}_roomTitle(t,e){var i;if(!t)return"";if(t.title){const i=(0,E.clean)(t.title);return e?"<strong>"+i+"</strong>":i}const s=[];let o;null===(i=t.members_info)||void 0===i||i.forEach((t=>{t.username!==window.user.username&&s.push(t.username)}));let a=s.slice(0,4);return e&&(a=a.map((t=>"<strong>"+(0,E.clean)(t)+"</strong>"))),o=a.join(", "),s.length>4&&(o+=", +"+(s.length-4)),o}_getRoomTitlee)}_setRoomTitleById(t,e){var i,s;const o=(0,E.clean)(e);this._bridge.setTitle(o);const a=this._model.getRoomById(t);(null!==(s=null===(i=null==a?void 0:a.members_info)||void 0===i?void 0:i.length)&&void 0!==s?s:0)<=2||H("#msg-item-"+t+" .title").text(o)}_onRoomMessagesRead(t){this._isActiveTab&&(this._markChatAsRead(t.room_id),this._updateNotifications())}_onRoomMarkAsUnread(t){this._$data.find("#msg-item-"+t.room_id).find(".counter").addClass("active").text(1),this._notificationCount+=1,
this._roomNotifications[t.room_id]=!0,this._updateNotifications()}_onActiveTabChange(t){this._isActiveTab="private"===t;const e=this._model.getRoomById(this._currentRoom());this._isActiveTab&&this.resize(),this._isActiveTab&&e&&(this._markChatAsRead(e.room_id),this._removeToastNotifications(e.room_id)),this._updateNotifications()}_markChatAsRead(t){const e=H("#msg-item-"+t+" .counter"),i=parseInt(e.text(),10);return e.text("0").removeClass("active"),i&&(this._notificationCount=Math.max(0,this._notificationCount-i)),i}_membersFime}_membersCount(t){var e,i,s;const o=this._model.getRoomById(t);return o?void 0!==o.members_count?o.members_count>2?o.members_count-1:0:(null!==(i=null===(e=o.members_info)||void 0===e?void 0:e.length)&&void 0!==i?i:0)>2?null===(s=o.members_info)||void 0===s?void 0:s.filter(this._membersFilter).length:0:0}_createChatWidget(t,e){const i=this.layoutWithSelect()&&this._bridge.$body?this._bridge.$body:this._$chat;this._$chatWidgetContainer=H('<div class="msg-window" id="msg-window-'+t+'" data-room="'+t+'"></div>').appendTo(i),this._$chatBody=H('<div class="msg-window-body chat-page"></div>').appendTo(this._$chatWidgetContainer),this.layoutWithSelect()&&this._$chatBody.css("height","100%"),this._createUsernameHint(t),this.symbolLinking=T.linking.symbol.spawn(),this.intervalLinking=T.linking.interval.spawn();const s=this._model.getRoomById(t),o=H.extend(!0,{},this._bridge.options);o.hideMaximize=o.hideMaximize||this.layoutWithSelect();const a={$body:this._$chatBody,_room:t,properties:{vat})},options:o,visible:this._bridge.visible,$headerspace:this._bridge.$headerspace,$header:this._bridge.$header,private_chat:!0,privateMenuItems:()=>this._getPrivateRoomActions((0,P.ensureNotNull)(s)),getChartWidget:this._bridge.getChartWidget,postMessage:this._bridge.postMessage,onMessage:this._bridge.onMessage,chatNotificationControl:this._chatNotificationControl,getChartWidgetCollection:this._bridge.getChartWidgetCollection,addPeople:this._addPeople.bind(this),membersCount:this._membersCount.bind(this,t),hideDetach:this._standalone,standalone:this._standalone||this.layoutWithSelect(),toggleMaximize:this._toggleMaximize.bind(this),maximized:this._chatMaximized.readonly(),symbol:this.symbolLinking,interval:this.intervalLinking,isAuthor:null==s?void 0:s.is_author,xWindowDataSync:this.isStandalone()||e?void 0:e=>{C.TVXWindowEvents.emit("messages.openchat",+new Date+":"+t+"@"+JSON.stringify(e))}};this._chatWidget=new(r())(a),M.mobiletouch||this.layoutWithSelect()||this._$chat.find(".message-input").focus()}_toggleMaximize(t){var e;if("boolean"!=typeof t)t=!this._chatMaximized.value();else if(t===this._chatMaximized.value())return;this._$chat.toggleClass("msg-chat-maximized",t),this._chatMaximized.setValue(t),null===(e=this._chatWidget)||void 0===e||e.resize()}_isCurrentUserAuthor(t){const e=this._getRoomById(t||this._currentRoom());return window.is_authenticated&&(null==e?void 0:e.is_author)}_getHintListOptions(){return{
container:this._$chatWidgetContainer.parent().parent().parent()[0],input:this._$inputText[0],fullBorder:!0,simpleMode:!0,showBrokers:!1,className:N().userNameHintList,closeOnMouseOutClick:!0,onMouseDownOuts")},onItemSelect)}}}_createUsernameHint(t){const e=this._isCurrentUserAuthor(t)||window.user.is_moderator||window.user.is_staff;if(this._$chatMembers=H(z.render('<div class="msg-members">{{#canEditMembers}}<div class="msg-input-wrap js-hidden"><div class="msg-input"><textarea placeholder="{{ placeholderText }}"></textarea></div></div>{{/canEditMembers}}<div class="msg-chat-members{{#canEditMembers}} msg-chat-members--height_decreased{{/canEditMembers}}"></div><div class="msg-username-hint-actions">{{#canEditMembers}}<a class="tv-button tv-button--default js-cancel">'+s.t(null,void 0,i(620036))+'</a><a class="tv-button tv-button--primary js-ok">'+s.t(null,void 0,i(758901))+'</a>{{/canEditMembers}}{{^canEditMembers}}<a class="tv-button tv-button--default js-cancel">'+s.t(null,{context:"action"},i(768508))+"</a>{{/canEditMembers}}</div></div>",{canEditMembers:e,placeholderText:s.t(null,void 0,i(511963))})),this._$chatMembers.appendTo(this._$chatBody),this._$inputWrap=this._$chatMembers.find(".msg-input-wrap"),this._$inputText=this._$chatMembers.find("textarea"),this._$chatMembersContent=this._$chatMembers.find(".msg-chat-members"),this._$membersActions=this._$chatMembers.find(".msg-username-hint-actions"),e&&(0,d.getUsernameHintList)(this._getHintListOptions()).then((t=>{const e=this._$chatWidgetContainer.parent().parent().parent();H(t).appendTo(e)})),e){const t=this;this._$chatMembersContent.on("click",".remove",(function(e){return e.stopPropagation(),e.preventDefault(),t._removeNewRecipient(H(this).parent().data("id")),t._syncDeleteButtonVisibility(),!1}))}this._$membersActions.on("click",".js-ok",(()=>{const t=this._$membersActions.find(".js-ok");t.hasClass("i-disabled")||(t.addClass("i-disabled"),this._saveRecipients(this._getCurrentRecipients()).th")})))})),this._$membersActions.on("click",".js-cancel",(()=>{this._$chatHeadingHeaderspace.find("#add-people").removeClass("active"),this._$inputWrap.addClass("js-hidden"),this._$chatMembers.hide()}))}_addPeople(){const t=this._$chatHeadingHeaderspace.find("#add-people");t.hasClass("active")?(t.removeClass("active"),this._$inputWrap.addClass("js-hidden"),this._$chatMembers.hide()):(t.addClass("active"),this._$inputWrap.removeClass("js-hidden"),this._$chatMembers.show(),this._$inputText.val("").focus(),this._showMembersList())}_showMembersList(){this._$chatMembersContent.empty().css("height",""),this._model.updateRoomInfo(this._currentRoom(),(()=>{var t,e;const i=this._model.getRoomById(this._currentRoom());if(!i)return;const s=(null!==(e=null===(t=i.members_info)||void 0===t?void 0:t.so1:1)).filter(this._membersFilter))&&void 0!==e?e:[]).md}))),o=this._renderRecipients(s)
;this._$chatMembersContent.append(o),this._syncDeleteButtonVisibility()}))}_syncDeleteButtonVisibility(){const t=this._$chatMembersContent.find(".recipient").length,e=this._$chatMembersContent.find(".remove");t&&t>1?e.show():e.hide()}_addNewRecipient(t){this._$inputText.val("").focus();if(-1!==this._getCurrentRecipients().indexOf(t.id))return void(0,b.showWarning)({title:s.t(null,void 0,i(934739)),text:s.t(null,void 0,i(936400)).format({name:t.username})});const e=H.extend({},t);this._renderRecipients([e]).prependTo(this._$chatMembersContent),this._syncDeleteButtonVisibility()}_renderRecipients(t){const e=this._isCurrentUserAuthor();return H(z.render('{{#recipients}}<a href="/u/{{ username }}/" target="_blank" class="recipient{{#online}} online{{/online}}" data-id="{{ id }}"><img src="{{ userpic }}"/><span class="recipient-username">{{ username }}</span>{{#showDeleteButton}}<i class="remove"></i>{{/showDeleteButton}}</a>{{/recipients}}',{recipients:t,showDeleteButton:e||window.user.is_moderator||window.user.is_staff}))}_removeNewRecipient(t){H('.recipient[data-id="'+t+'"]').remove(),this._$inputText.focus()}_saveRecipients(t){return new Promise((e=>{if(!t.length)return void e();const o=this._currentRoom();new Promise((e=>{this._model.getRoomInfo(o,(o=>{var a;2===(null===(a=o.members_info)||void 0===a?void 0:a.length)&&t.length>2?(0,b.showConfirm)({title:s.t(null,void 0,i(97764)),text:s.t(null,void 0,i(467180)),mainButtonText:s.t(null,void 0,i(913254)),cancelButtonText:s.t(null,void 0,i(979595)),onConfirm:t=>{e(!1),t.dialogClose()},onCan()}}):e(!0)}))})).the)}))}))}_saveRecipientsImpl(t,e,o,a){this._model.updateRoomUsers(t,e,(t=>{if(t.error)return(0,b.showWarning)({title:s.t(null,void 0,i(482751)),html:t.error}),void a();this._$inputWrap.addClass("js-hidden"),this._$chatHeadingHeaderspace.find("#add-people").removeClass("active"),this._$chatMembers.hide();const e=t.room;if(e.existing)return this.openChat(e.room_id),void a();this._isCurrentRoom(e.room_id)||this.isStandalone()||(this._roomToBeOpenedWhenAdded=e.room_id),a()}),{updateExistingRoom:o})}_flipWidgets(){if(this._flipped)return;let t=this._$container.height();const e=parseFloat(I.getValue("privatemessages.paneratio","0.5"));let o=Math.round(e*t);this._bridge.visible.value()||this._bridge.visible.subscribe((()=>{t=this._$container.height(),o=Math.round(e*t-this._headerWrapHieght),this._$chat.height(o),this._$widget.height(t-o),this.resize()}),{once:!0}),this._$headerWrap=H('<div class="tv-messages-header">').prependTo(this._$widget),this._$headerWrap.on("contextmen()}));const a=H('<div class="widgetbar-widgetheader"><div class="widgetbar-widgettitle">'+s.t(null,void 0,i(769708))+"</div></div>").appendTo(this._$headerWrap),n=H('<div class="widgetbar-headerspace">').append(this._$addChatButton).append((0,P.ensureDefined)(this._searchFilter).getButton()).appendTo(a)
;this._$settingsButton=H('<a class="button apply-common-tooltip" title="'+s.t(null,void 0,i(389517))+'" data-role="button" data-name="settings">').append(H(i(844996)).attr({width:28,height:28})).appendTo(n),this._$settingsButton.on("click",(t=>{var e;null===(e=this._chatWidget)||void 0===e||e.showSettingsDialog(t,this._model.getRooms())})),(0,v.bindPopupMenu)(this._$settingsButton,null,{event:"show-popup",addClass:"ch-popup ch-settings-popup",careBottomBorder:!0,careRightBorder:!0,viewportSpacing:2,reverse:!0}),this._$chat=H('<div class="msg-chat-wrap">').insertBefore(this._$widget),this._headerWrapHieght=this._$headerWrap.outerHeight(),o-=this._headerWrapHieght,this._$chat.height(o),this._$widget.height(t-o),this._$chat.data("heightRatio",e),H('<div class="msg-divider"></div>').prependTo(this._$widget),H('<div class="msg-window-handle"></div>').on("mousedown touchstart",this._onWidgetResizeHandleMousedown.bind(this)).appendTo(this._$widget),this._flipped=!0}_onWidgetResizeHandleMousedown(t){if(t.isDefaultPrevented())return;t.preventDefault();const e=this._$chat,i=this._$widget;let s;s=t.originalEvent.touches?t.originalEvent.touches[0].clientY:t.pageY;const o=e.height(),a=this._$container.height();let n;const r=t=>{let r;r=t.originalEvent.touches?t.originalEvent.touches[0].clientY:t.pageY;const h=r-s,l=Math.max(0,Math.min(o+h,a-this._$headerWrap.outerHeight()));n!==l&&(n=l,e.data("heightRatio",(l/(a-this._bridge.$header.height())).toFixed(2)),e.height(l),i.height(a-l),this.resize())},h=()=>{H(document.documentElement).off("mousemove touchmove",r).off("mouseup touchend",h),n!==o&&I.setValue("privatemessages.paneratio",e.data("heightRatio"))};H(document.documentElement).on("mousemove touchmove",r).one("mouseup touchend"()}_onWindowResize(t){if(this._chatWidget)if(this.layoutWithSelect())this._chatWidget.resize();else{const e=t-this._bridge.$header.height(),i=parseFloat(I.getValue("privatemessages.paneratio","0.5")),s=Math.min(Math.round(i*e),e-this._headerWrapHieght);this._$chat.height(s),this._$widget.height(e-s),this.resize()}}_closeChat(t){if(this._chatWidget&&(this._chatWidget.destroy(),delete this._chatWidget),this._$chatWidgetContainer.remove(),this._$chatHeadingHeaderspace&&this._$chatHeadingHeaderspace.empty(),t){this._bridge.setTitle(s.t(null,void 0,i(538730)));const t=document.getElementById("js-members-count");t&&(t.innerHTML=""),this._appendPlaceholder("hidden",this._$chat)}this.isStandalone()||I.setValue("privatemessages.activechat","")}_onMessageSentSuccess(t){var e;if(this.openChat(t),window.widgetbar){const t=window.widgetbar.setPage("union_chats");if(t){const e=t.widget("unionchats");e&&e.widgetObject&&e.widgetObject.setTab("private")}}null===(e=this.scroll)||void 0===e||e.scrollToStart()}_currentt}_onUnreadMessagesUpdate(t){this._bridge.onUnreadMessagesUpdate&&this._bridge.onUnreadMessagesUpdate("private",t)}_notAuthMessage(){
const t=H('<div class="ch-item-empty">'+s.t(null,{replace:{signInLink:'<a href="#signin">'+s.t(null,void 0,i(601346))+"</a>"}},i(732812))+"</div>");return t.on("click",(()=>(window.runOrSign>{}),{source:"Private messages widget placeholder",sourceMeta:"Chart"}),!1))),t}_setRoomTitle(t){(0,b.showRename)({text:s.t(null,void 0,i(667961)),initValue:this._getRoomTitleById(t),maxLength:128,onRename:e=>new Promise((o=>{const a=e.newValue;a?this._model.editRoom(t,a,"",(t=>{t.error&&(0,b.showWarning)({title:t.errorTitle||s.t(null,void 0,i(482751)),text:t.error}),o(),e.dialogClose()})):o()}))})}_showRoom(t,e){e.removeClass("js-hidden"),e.data("hidden-conversation",!1),this._removePlaceholder(),this._model.removeHiddenRoom(t)}_hideRoom(t,e){var i;if(this._model.isRoomHidden(t))return;const s=this._$data.find("#msg-item-"+t),o=this._isCurrentRoom(t),a=this._$data.find(".msg-item").not(".js-hidden");s.addClass("js-hidden"),s.removeClass("active"),s.data("hidden-conversation",!0),1===a.length&&this._appendPlaceholder("hidden"),o&&(this._closeChat(!0),null===(i=this.scroll)||void 0===i||i.scrollToStart()),this._model.addHiddenRoom(t),e||C.TVXWindowEvents.emit("messages.chatvisibility",t+":hide")}_markAsUnread(t){if(this._$data.find("#msg-item-"+t).find(".counter").hasClass("active"))return;this._isCurrentRoom(t)&&this._openNextChat(t),this._model.markAsUnread(t)}_openNextChat(t){const e=this._model.getRoomById(t);if(!e)return;const i=this._model.getRooms();if(i.length<2)return void this._closeChat();const s=i.indexOf(e),o=i[s+1]?s+1:0;this.openChat(i[o].room_id)}_showRoomContextMenu(t,e){const i=this._getRoomById(e),s=this._getPrivateRoomActions((0,P.ensureNotNull)(i));let o=[s.markAsUnread,s.hideConversation];o=o.concat(s.multiUserActions),o.push(r().getLaunchInSeparateWindowAction>!0))),u.ContextMenuManager.showMenu(o.map((t=>new c.Action({actionId:"UnknownAction",options:{label:t.title,onExecute:t.action}}))),t)}_getPrivateRoomActions(t){var e,o;const a=t.room_id,n={hideConversation:{title:s.t(null,void 0,i(957656)),action:()=>{this._hideRoom(a)}},markAsUnread:{title:s.t(null,void 0,i(353088)),action:()=>{this._markAsUnread(a)}},multiUserActions:[]};return(null!==(o=null===(e=t.members_info)||void 0===e?void 0:e.length)&&void 0!==o?o:0)>2&&n.multiUserActions.push({title:s.t(null,void 0,i(737792)),acta)}},{title:s.t(null,void 0,i(607986)),action:()=>{(0,b.showConfirm)({text:s.t(null,void 0,i(716541)),onConfirm:t=>new Promise((e=>{this._model.leaveFromRoom(a,(o=>{if(e(),o.error)return(0,b.showWarning)({title:o.errorTitle||s.t(null,void 0,i(482751)),text:o.error}),void t.dialogClose();this._isCurrentRoom(a)&&this._closeChat(!0),this.resize(),t.dialogClose()}))}))})}}),n}_getCurrentRecipients(){const t=this._$chatMembersContent.find(".recipient").toArray().m"))));return window.user.id&&t.push(window.user.id),t}}function G(){return X||(X=(0,f.makePrivateModel)()),X}function K(t,e,o,a,n){if(o===window.user.id)return;const r=function(t,e){for(const i of t){
const{members_info:t}=i;if(t&&(2===t.length&&(t[0].user_id===e||t[1].user_id===e)))return i}return null}(t.getRooms(),o),h=o=>{t.getRoomInfo(o,(n=>{(0,S.trackChatEvent)(n,e),t.sendMessageToRoom(o,e,{},{},(t=>{const e=t.error||t.warning;if(e){const o=t.title;(0,b.showWarning)({title:t.error?o||s.t(null,void 0,i(482751)):o||s.t(null,void 0,i(533603)),html:e})}"function"==typeof a&&a(o)}),(()=>{(0,b.showWarning)({title:s.t(null,void 0,i(482751)),text:s.t(null,void 0,i(682468))})}))}))};"function"==typeof n&&n(),r?h(r.room_id):t.createRoom("","",[o],(t=>{t.error?(0,b.showWarning)({title:t.errorTitle||s.t(null,void 0,i(482751)),html:t.error}):h(t.room.room_id)}))}function Q(t,e){j?j.sendMessageToUser(t,e):K(G(),t,e)}},182534:(t,e,i)=>{"use strict";var s=i(823127);i(161530);var o=i(50959),a=i(500962),n=i(372301),r=i(113600),h=i(984968).ChatNotificationControl,l=i(504368).ChatRoomListSearchFilter,d=i(498966),c=i(373571).Action,u=i(783375).ContextMenuManager,p=i(125226).isFeatureEnabled,g=i(421448),m=i(155040),_=i(583912).linking,v=i(644142).SidebarCustomScroll,f=i(432369).bindPopupMenu,b=i(348735),w=i(689492).showDialog;const y=i(607509).ACTION_ID;var C=i(55826),S=i(468867),M=i(740254).enabled,T=i(833813).ProductFeatures,$=i(33070).WidgetBanner,R=i(33070).WidgetSource,x=i(960337).createGoProDialog;const{htmlEscape:k}=i(919476),{copyToClipboard:A}=i(963239),I=i(309103),B=i(653063);function E(t){this._bridge=t,this._container=t.$body,this._rooms_obj={},this._visible=!1,this._isActiveTab=!0,this._notificationCount=0,this._currentSymbol="",this.SORT_ROOMS_INTERVAL=5e3,this._model=b.makePublicModel(),this._model.roomAdded().subscribe(this,this._onRoomAdded),this._model.roomChanged().subscribe(this,this._onRoomChanged),this._model.roomDeleted().subscribe(this,this._onRoomDeleted),this._model.roomsChanged().subscribe(this,this._onRoomsChanged),this._model.messageReceivedInOtherRoom().subscribe(this,this._onEventInOtherRooms),this._symbolHands(),_.seriesShortSymbol.subscribe(this._symbolHandler),this._standalone=!!t.standalone,this._layoutWithSelect=!!t.layoutWithSelect||!!(t.options||{}).layoutWithSelect,this._bridge.chatNotificationControl=this._chatNotificationControl=new h(!1),t.visible&&(this._visible=t.visible.value(),t.visible.subscribe(this.onVisibilityChange.bind(this))),t.watchedTab&&(this._isActiveTab="public"===t.watchedTab.value(),t.watchedTab.subscribe(this._onActiveTabChange.bind(this))),t.height&&t.height.subscribe(this.onWindowResize.bind(this)),t.width&&t.width.subscribe(this.resize.bind(this)),this._bridge.onMess)}}.bind(this)),this.layoutWithSelect()?this.prepareLayoutWithSelect():this.prepareLayout(),this.setSortRoomsInterval(),loginStateChange.subscribe(tD)}.bind(this)),0!==this._model.getRooms().length&&this._onRoomsChanged(this._model.getRooms(),[]),
this.layoutWithSelect()&&this._createChatWidget(),this.connect(),this.resize(),this._mindsCurrentChannel="",this._mindsReconnectTimeout=null}i(101426),E.prototype._onRoomAddedBySelf=function(t){return!!this._model.getRoomById(t)&&(this.scrollToRoom(t),this.openChat(t),!0)},E.prototype._onRoomAdded=function(t){this.sortRooms(),t.user_id===window.user.id&&this._needScrollToAddedRoom&&(this._onRoomAddedBySelf(t.room_id),this._needScrollToAddedRoom=!1)},E.prototype._onRoomChanged=function(t){this.updateRoomCounter(t.room_id);var e=s("#pc-item-"+t.room_id);e.find(".title-text").text(t.title),e.find(".desc span").text(t.description)},E.prototype._onRoomDeleted=function(t){var e=s("#pc-item-"+t.room_id);C.jQueryCompatibleDestroy(e),e.remove(),this.resize(),this._bridge._room===t.room_id&&this.openChat(this.getDefaultRoom())},E.prototype._addWidgetBanner=function(){this._standalone||(this._$mindsBanner=s('<div class="tv-minds-banner">').appendTo(this._$data),a.render(o.createElement($,{text:i.tf(null,void 0,i(706239)),buttonText:i.tf(null,void 0,i(950569)),icon:B,storageKey:"show_minds_banner",source:R.Minds,placement:R.Chats,onActionClick:async function(){const{openMindsPage:t}=await i.e(20603).then(i.bind(i,732246));t(_.proSymbol.value())},bridge:this._bridge,widgetIsVisible:this._bridge.visible.value()}),this._$mindsBanner[0]))},E.prototype._onRoomsChanged=function(t,e){var i,s=0===e.length&&0!==t.length;this._notificationCount=0,s&&(this._$data.empty(),this._addWidgetBanner(),this._rooms_obj={}),this.initNotificationsSettings(),i=this.layoutWithSelect()&&this._bridge.activeRoom?this._bridge.activeRoom:this.getActiveRoom(),this.sortRooms(s,i),this.toggleFavoritesVisibility(),s&&i&&(this.layoutWithSelect()&&this._rooms_obj[i]&&this._$select.html("<strong>"+k(this._rooms_obj[i].title)+"</strong>"+(this._rooms_obj[i].description?": "+k(this._rooms_obj[i].description):"")),this.isStandAlone()||setTimeout(function(){this.openChat(this._model.getRoomById(i)?i:this.getDefaultRoom())}.bind(this),0))},E.prototype._onEventInOtherRooms=function(t,e,i){var o=this,a=this._rooms_obj[t.room_id];if(a){var n=s("#pc-item-"+a.room_id);if(this.updateRoomCounter(t.room_id),t.type||this.updateRoomDescMsg(a.room_id,t.username,t.text),t.user_id!==window.user.id&&this.roomNotificationsOn(a)){var h,l,d=TVSettings.getJSON("chat.sound",r.ChatSoundControl.prototype._default_state,!0);if(t.text&&(h=(l=S.removeBBCodes(t.text)).indexOf("@"+user.username)>-1),!i&&(!0===d||d.onMessage||h&&d.onMessageForUser)&&g.play("chat/message"),h&&!i&&!o._standalone&&!o.layoutWithSelect()&&window.user.notification_popup&&document.hidden&&m.show(a.title,t.username+": "+l,t.user_pic),!o.isCurrentRoom(a.room_id)||!o._visible||!o._isActiveTab){var c=o._$data.find('a[data-room="'+a.room_id+'"] .counter'),u=parseInt(c.text(),10);c.addClass("active").text(u+1),o._notificationCount++,n.highlight(1)}o.updateNotifications()}}},E.prototype.settingsKey=function(t){return"en"!==window.language&&(t+="."+window.locale),t},E.prototype.getLocalizedSetting=function(t,e){
return TVSettings.getValue(this.settingsKey(t),e)},E.prototype.getLocalizedJsonSetting=function(t,e){return TVSettings.getJSON(this.settingsKey(t),e)},E.prototype.setTVSettings=function(t,e){return"en"!==window.language&&(t+="."+window.locale),TVSettings.setValue(t,e)},E.prototype.setJsonSette)},E.prototype.onVisibilityChange=function(t){this._visible=t,t&&this._bridge._room&&s("#pc-item-"+this._bridge._room+" .counter").text("0").removeClass("active"),this.updateNotifications()},E.prototype._onActiveTabChange=function(t){this._isActiveTab="public"===t,this._isActiveTab&&this._bridge._room&&s("#pc-item-"+this._bridge._room+" .counter").text("0").removeClass("active"),this.updateNotifications()},E.prototype.initNotificationsSettings=function(){this.notificationsSettings=this.getLocalizedJsonSetting("publiccharts.notifications"),this.notificationsSettings||(this.notificationsSettings=this._model.getRooms().reduce((function(t,e){return e.pinned&&(t[e.room_id]=1),t}),{}))},E.prototype.setupDataEvents=function(){var t=this;this._$data.on("click touchend",".pc-item, .msg-item",(function(e){t._touch_scroll||(t._searchFilter&&t._searchFilter.isOpen()&&t._searchFilter.setNewRoom(s("#pc-item-"+s(this).data("room"))),t.openChat(s(this).data("room")),e.preventDefault())})).on("touchstart",(function(){t._touch_scroll=!1})).on("touchmov!0})).on("contextmenu",".pc-item",(function(e){e.preventDefault(),t.showRoomContextMenu(e,s(this).data("room"))})),this.isStandAlone&&!this.isStandAlone()&&this._$data.on("click touchend",".pc-item .fav",(function(e){t.toggleFavoriteForRoom(s(this).data("room")),e.stopPropagation(),e.preventDefault()})).on("click touchend",".pc-item .notifications-toggle",(function(e){t.toggleNotificationsForRoom(s(this).data("room")),e.stopPropagation(),e.preventDefault()}))},E.prototype.showRoomContextMenu=function(t,e){var i=E.publicMenuItems(e,this._bridge,this);i.push(n.getLaunchInSeparateWindowAction!1}))),u.showMenu(i.map((function(t){return new c({actionId:y.UnknownAction,options:{label:t.title,onExecute:t.action}})})),t)},E.prototype.prepareLayout=function(){var t=this;this._$widget=s('<div class="tv-publicchats">').appendTo(this._container),t._touch_scroll=!1,this._searchFilter=new l(this),this._searchFilter.appendInput(this._$widget),this._$dataWrap=s('<div class="pc-data-wrap">').appendTo(this._$widget),this._$dataWrap.on("contextmen()})),this._$data=s('<div class="pc-data">').appendTo(this._$dataWrap),this._$noFavoritesMessage=s("<div>"),this._$noFavoritesMessage.addClass("tv-widget-empty-message js-hidden"),this._$noFavoritesMessage.text(i.tf(null,void 0,i(112039))),this._$noFavoritesMessage.appendTo(this._$dataWrap),this._searchFilter.setRoomList(this._$data),this.setupDataEvents(),
(p("enable_new_custom_public_chats")||window.user.permissions&&window.user.permissions.can_create_public_chats)&&(this._$addButton=s('<a class="button apply-common-tooltip" title="'+i.tf(null,void 0,i(876509))+'" data-role="button" data-name="create">').append(s(i(6198)).attr({width:28,height:28})).appendTo(this._bridge.$headerspace),this._$addButton.on("clic()}))),this._searchFilter.appendButton(this._bridge.$headerspace),this._$settingsButton=s('<a class="button apply-common-tooltip" title="'+i.tf(null,void 0,i(389517))+'" data-role="button" data-name="settings">').append(s(i(844996)).attr({width:28,height:28})).appendTo(this._bridge.$headerspace),this._$settingsButton.on("click",n.prototype.showSettingsDialog.bind(this)),f(this._$settingsButton,null,{event:"show-popup",hideEvent:"hide-popup",addClass:"ch-popup ch-settings-popup",careBottomBorder:!0,careRightBorder:!0,viewportSpacing:2,reverse:!0}),this._$resizeHandle=s('<div class="pc-window-handle"></div>').on("mousedown touchstart",this.onWidgetResizeHandleMousedown.bind(this)).insertBefore(this._bridge.$header),this._scroll=new v(this._$dataWrap[0],this._$data[0])},E.prototype.onWidgetResizeHandleMousedown=function(t){if(!t.isDefaultPrevented()){t.preventDefault();var e,i=this,o=this._bridge.$chat,a=this._$widget;e=t.originalEvent.touches?t.originalEvent.touches[0].clientY:t.pageY;var n,r=o.height(),h=r+a.height(),l=function(t){var s=(t.originalEvent.touches?t.originalEvent.touches[0].clientY:t.pageY)-e,l=Math.max(0,Math.min(r+s,h));n!==l&&(n=l,o.data("heightRatio",(l/h).toFixed(2)),o.height(l),a.height(h-l),i.resize(),i._bridge.chatWidget.resize())},d=function(t){s(document.documentElement).off("mousemove touchmove",l).off("mouseup touchend",d),n!==r&&TVSettings.setValue("publicmessages.paneratio",o.data("heightRatio"))};s(document.documentElement).on("mousemove touchmove",l).one("mouseup touchend",d)}},E.prototype.onWindowResize=function(t){if(this.layoutWithSelect())this.resize();else{var e=this._bridge.chatWidget._bridge.$header.height(),i=t-(this._bridge.$header.height()+e),s=parseFloat(TVSettings.getValue("publicmessages.paneratio","0.5")),o=Math.round(s*i);this._bridge.$chat.height(o),this._$widget.height(i-o),this.resize(),this._bridge.chatWidget.resize()}},E.prototype.prepareLayoutWithSelect=function(t,e){var o=this,a=!1;if(t&&!is_authenticated)return this._bridge.$header.hide(),void(this._$data=this._bridge.$body.append(e instanceof s?e:'<div>Please <a href="#signin" onclick="runOrSignIn(function(){}, { source: "Public chat widget" }); return false;">'+i.tf(null,void 0,i(601346))+"</a></div>"));function r(t){var e=s(t.target).parents().andSelf();e.is(o._$select)||e.is(o._$data)||o._toggleList()}this._bridge.$header.show(),this._bridge.$body.empty(),this._bridge.$header.addClass("chat-select-container"),this._$select=s('<div class="standalone-chat-select">').appendTo(this._bridge.$header),this._toggleList=function(){if(a)o._$data.stop().height("auto").removeClass("sliding open");else{
o._$data.height("auto").addClass("sliding");var t=Math.min(s(window).height()-o._$data.offset().top-5,o._$data.height());o._$data.height(0).animate({height:t},{duration:200,height:t,compl")}})}o._$select[a?"removeClass":"addClass"]("active"),s(document)[a?"off":"on"]("mousedown touchstart",r),a=!a},this._$select.cli()})),this._$settingsButton=s('<a class="button apply-common-tooltip" title="'+i.tf(null,void 0,i(389517))+'"></a>').append(s(i(648449)).attr({width:17,height:17})).appendTo(this._bridge.$header).click((function(t){o instanceof i(814729).Widget&&o._chatWidget?o._chatWidget.showSettingsDialog(t):o instanceof E&&n.prototype.showSettingsDialog.call(o,t)})),f(this._$settingsButton,null,{event:"show-popup",addClass:"ch-popup ch-settings-popup",careBottomBorder:!0,careRightBorder:!0,viewportSpacing:2,reverse:!0}),this._$data=s('<div class="standalone-chat-list msg-data pc-data">').appendTo(this._bridge.$header).on("click touchen()})),E.prototype.setupDataEvents.call(this)},E.prototype.connect=function(){this._bridge.onMessage(function(t,e){"toggle_show_only_favorites"===t&&(this._model.toggleShownOnlyFavorites(),this.toggleFavoritesVisibility(),this.resize())}.bind(this))},E.prototype.destroy=function(){clearInterval(this._roomUpdateInterval),clearInterval(this._roomStatusInterval),this._model.roomAdded().unsubscribe(this,this._onRoomAdded),this._model.roomChanged().unsubscribe(this,this._onRoomChanged),this._model.roomDeleted().unsubscribe(this,this._onRoomDeleted),this._model.roomsChanged().unsubscribe(this,this._onRoomsChanged),this._model.messageReceivedInOtherRoom().unsubscribe(this,this._onEventInOtherRooms),_.seriesShortSymbol.unsubscribe(this._symbolHandler),this._model.destroy(),this._model=null},E.prototype.getDefaultRoom=function(){for(var t,e=this._model.getRooms(),i=e.length-1;i>=0;i--)e[i].is_default&&(t=e[i].room_id);return t=t||("en"!==window.language?"general_"+window.locale:"general")},E.prototype.getActiveRoom=function(){var t=this.getLocalizedSetting("publicchats.activechat");return t||(t=this.getDefaultRoom()),t},E.prototype.updateRoomCounter=function(t,e){var s=this._rooms_obj[t],o=(new Date).getDate();if(s&&!s.isSymbol){!0!==e?(s.msgs_total++,s.msgs_date!==o?(s.msgs_date=o,s.msgs_days++,s.msgs_today=1,s.msgs_average=Math.round((s.msgs_total-1)/s.msgs_days)):s.msgs_today++):s.msgs_date=o;var a=function(t){if(t<1e3)return String(t);var e=Math.floor(Math.log(t)/Math.log(1e3));return Math.round(t/Math.pow(1e3,e)*Math.pow(10,1))/Math.pow(10,1)+"KMGTPE".charAt(e-1)}(~~s.msgs_total),n=this._$data.find("#pc-item-"+t);n.find(".title-total").text(a),this.layoutWithSelect()||n.find(".title-text, .title-total").addClass("apply-common-tooltip common-tooltip-html").attr("title",k(s.description)+"<br><small>"+i.tf(null,void 0,i(219934)).format({messagesCount:s.msgs_total})+"<br>"+i.tf(null,void 0,i(340354)).format({
messagesCount:s.msgs_today})+"<br>"+(0===s.msgs_average?i.tf(null,void 0,i(796637)):i.tf(null,void 0,i(515155)).format({messagesCount:s.msgs_average}))+"</small>")}},E.prototype.addRoom=function(t,e){var o=s('<a href="#" data-room="'+k(t.room_id)+'" id="pc-item-'+k(t.room_id)+'" class="pc-item'+(e?" active":"")+(t.pinned?" pinned":"")+(this._model.isRoomFavorite(t.room_id)?" favorite":"")+'"><div class="title">'+(t.symbol?'<span class="title-icon"></span>':"")+'<span class="title-text">'+k(t.title)+"</span>"+(t.isSymbol?"":' <span class="title-total">0</span>')+'</div><div class="desc'+(t.symbol?" with-icon":"")+'"><span>'+k(t.description)+'</span></div><div class="counter">0</div>'+(this.isStandAlone()?"":'<div class="notifications-toggle'+(this.roomNotificationsOn(t)?" active":"")+'" data-room="'+k(t.room_id)+'" title="'+i.tf(null,void 0,i(907194))+'">'+i(667130)+'</div><i class="fav'+(this._model.isRoomFavorite(t.room_id)?" active":"")+'" data-room="'+k(t.room_id)+'" title="'+i.tf(null,void 0,i(757469))+'">'+i(372665)+"</i>")+"</div></a>");if(o.appendTo(this._$data),t.symbol){const e=o.find(".title-icon")[0];d.renderIconTemplate(t.symbol,e)}if(this.updateRoomCounter(t.room_id,!0),t.msgs_last_ts&&(t.last_message_time=1e3*+t.msgs_last_ts),t.msgs_last_text){var a=t.msgs_last_text.split(": ");this.updateRoomDescMsg(t.room_id,a[0],a[1])}},E.prototype.updateRoom=function(t){s("#pc-item-"+t.room_id).appendTo(this._$data)},E.prototype.deleteRoomById=function(t){s("#pc-item-"+t).remove(),delete this._rooms_obj[t]},E.prototype.updateRoomDescMsg=function(t,e,i){var o=this._rooms_obj[t];if(o){var a=s("#pc-item-"+t).find(".desc");C.jQueryCompatibleDestroy(a);var n=a.find("time");n.length||(n=s("<time>").appendTo(a)),a.find("span").text(e+": "+S.removeBBCodes(i)),C.jQueryCompatibleAgoDateFormatter(n,new Date(o.last_message_time||Date.now()))}},E.prototype.updateNotifications=function(){var t=this._$data.find(".counter.active").length;this._bridge.onUnreadMessagesUpdate?this.onUnreadMessagesUpdate(t):this._bridge.notify(1,{notificationValue:t,clear:!t,force:!0,room:this._model.getRoomById(this._bridge._room)})},E.prototype.openChat=function(t,e){if(!this._bridge._room||t!==this._bridge._room){this._$data.find("a").removeClass("active"),s("#pc-item-"+t).addClass("active");var i=s("#pc-item-"+t+" .counter"),o=parseInt(i.text(),10);if(i.text("0").removeClass("active"),this._bridge.postMessage("chat_select_channel",{room_id:t,new_msgs:o}),o&&(this._notificationCount=Math.max(0,this._notificationCount-o)),this._bridge._room=t,this.isStandAlone()||this.setTVSettings("publicchats.activechat",t),this.layoutWithSelect()){var a=this._model.getRoomById(t);this._$select.html("<strong>"+k(a.title)+"</strong>"+(a.description?": "+k(a.description):""))}this.updateNotifications()}},E.prototype.res()},E.prototype.isCurrentR=t},E.prototype.scrollToRoom=function(t){this._scroll.animateTo(s("#pc-item-"+t).position().top-10)
},E.prototype.toggleFavoritesVisibility=function(){if(!this.isStandAlone()){this._$data.toggleClass("js-only-favorites",this._model.isShownOnlyFavorites());var t=this._model.isShownOnlyFavorites()&&0===this._$data.find(".favorite").length;this.layoutWithSelect()||this._$noFavoritesMessage.toggleClass("js-hidden",!t)}},E.prototype.toggleFavoriteForRoom=function(t){var e=!1;this._model.isRoomFavorite(t)?(this._model.removeFavoriteRoom(t),e=!1):(this._model.addFavoriteRoom(t),e=!0);var i=s("#pc-item-"+t);i.toggleClass("favorite",e),i.find(".fav").toggleClass("active",e),this.toggleFavoritesVisibility()},E.prototype.setSortRoomsInterval=function(){if(!this._sortRoomsIntervalID){var t=this;(this._$dataWrap||this._$data).on("mouseenter",(function(){t._pointerInsideData=!0})).on("mouseleav!1})),this._sortRoomsIntervalID=setInterval((function(){t._pointerInsideData||t._bridge&&t._bridge.visible&&!t._bridge.visible.value()||t.sortRooms()}),this.SORT_ROOMS_INTERVAL)}},E.prototype.sortRooms=function(t,e){e||(e=this.getActiveRoom());var i=this._model.getRooms();i.sort(this.sortRoomsFilter.bind(this)),i.forEach((function(i){t||!(i.room_id in this._rooms_obj)?(this._rooms_obj[i.room_id]=i,this.addRoom(i,e===i.room_id)):this.updateRoom(i)}),this)},E.prototype.sortRoomsFilter=function(t,e){return t.isSymbol&&!e.isSymbol?-1:!t.isSymbol&&e.isSymbol?1:t.isSymbol&&e.isSymbol?t.symbol===this._currentSymbol?-1:1:t.pinned&&!e.pinned?-1:!t.pinned&&e.pinned?1:t.pinned&&e.pinned?t.title.toLowerCase()>e.title.toLowerCase()?1:-1:this._model.isRoomFavorite(t.room_id)&&!this._model.isRoomFavorite(e.room_id)?-1:!this._model.isRoomFavorite(t.room_id)&&this._model.isRoomFavorite(e.room_id)?1:"number"==typeof t.last_message_time&&"number"!=typeof e.last_message_time?-1:"number"!=typeof t.last_message_time&&"number"==typeof e.last_message_time?1:"number"==typeof t.last_message_time&&"number"==typeof e.last_message_time&&t.last_message_time>e.last_message_time?-1:"number"==typeof t.last_message_time&&"number"==typeof e.last_message_time&&t.last_message_time<e.last_message_time||t.title.toLowerCase()>e.title.toLowerCase()?1:-1},E.prototype.toggleNotificationsForRoom=function(t){t in this.notificationsSettings?delete this.notificationsSettings[t]:this.notificationsSettings[t]=1,this.setJsonSetting("publiccharts.notifications",this.notificationsSettings),s("#pc-item-"+t+" .notifications-toggle").toggleClass("active",t in this.notificationsSettings)},E.prototype.roomNotificationsOn=function(t){return this.notificationsSettings||this.initNotificationsSettings(),t.room_id in this.notificationsSettings},E.prototype.showEditRoomDialog=function(t){var e=this;runOrSignIn((function(){window.user.permissions.can_moderate_public_chats||M(T.CAN_EDIT_PUBLIC_CHATS)?w(t,e._model.createRoom.bind(e._model),e._model.editRoom.bind(e._model),(function(i){t||e._onRoomAddedBySelf(i.room.room_id)||(e._needScrollToAddedRoom=!0)})):x({feature:"editCreatePublicChat",isTrialAvailable:!0,upgradeMessage:i.tf(null,void 0,i(993550))})}),{
source:"Public chat widget",verifiedPhoneRequired:!0})},E.prototype.isStandAlone=function(){return this._standalone},E.prototype.layoutWithSelct},E.prototype.onUnreadMessagesUpdt)},E.copyLinkToRoom=async function(t){const e=new URL("/chat/#"+t,location.href).href;await A({text:e});const o=s("#pc-item-"+t)[0];o&&(I.showOnElement(o,{content:{type:"text",data:i.tf(null,void 0,i(679732))}}),setTimeout((()=>{I.hide()}),1500))},E.prototype._createChatWidget=function(){var t=s.extend(!0,{},this._bridge,{$header:null,publicMenuItems:this.publicMenuItems,hideMaximize:(this._bridge.options||{}).hideMaximize||this._layoutWithSelect,standalone:this.isStandAlone()||this.layoutWithSelect()});this.chatWidget=new n(t)},E.publicMenuItems=function(t,e){var s=[];return s.push({title:i.tf(null,void 0,i(892503)),actt)}}),s.push({title:i.tf(null,void 0,i(74420)),actt)}}),s.push({title:i.tf(null,void 0,i(491936)),action:function(){var e=new Date,i=e.getMonth()+1,s=e.getDate(),o=e.getFullYear()+"-"+(i<10?"0":"")+i+"-"+(s<10?"0":"")+s;window.open("/chat/history/?room="+t+"&date="+o+"&tzoffset="+e.getTimezoneOffset())}}),s},t.exports=E},342395:(t,e,i)=>{"use strict";i.d(e,{makeSnapshotRequest:()=>l,takeChartSnapshot:()=>h,takeChartSnapshotPromise:()=>r});i(586463);var s=i(444372),o=i(77122),a=i(229534),n=i(1207}},739740:(t,e,i)=>{"use strict";i.r(e);i(823127);var s=i(823127),o=i(823127);s.fn.putCursorAtEnd=function(){return this.each((function(){if(o(this).focus(),this.setSelectionRange){const t=2*o(this).val().length;this.setSelectionRange(t,t)}else o(this).val(o(this).val());this.scrollTop=999999}))},s.fn.putCursorAtPosition=function(t){return this.each((function(){o(this).focus(),this.setSelectionRange&&this.setSelectionRange(t,t)}))}},721015:(t,e,i)=>{"use strict";i.d(e,{getViolations:()=>a});var s=i(444372);let o=null;function a(){if(null===o){const t=window.location.protocol+"//"+window.location.host,e=t+"/house-rules/",a=t+"/advertising-info/";o=[{name:s.t(null,void 0,i(375445)),text:s.t(null,void 0,i(476659)),id:"multi_acc"},{name:s.t(null,void 0,i(494238)),text:s.t(null,void 0,i(808911)),id:"links"},{name:s.t(null,void 0,i(559831)),text:s.t(null,void 0,i(110312)),id:"hate_speech"},{name:s.t(null,void 0,i(617816)),text:s.t(null,void 0,i(286283)),id:"language"},{name:s.t(null,void 0,i(780697)),text:s.t(null,void 0,i(21673)),id:"personal_info"},{name:s.t(null,void 0,i(353)),text:s.t(null,void 0,i(40676)),id:"illicit_content"},{name:s.t(null,void 0,i(809494)),text:s.t(null,void 0,i(186251)),id:"copyright"},{name:s.t(null,void 0,i(746424)),text:s.t(null,void 0,i(265905)).format({link:a}),id:"ads"},{name:s.t(null,void 0,i(739762)),text:s.t(null,{replace:{link:e}},i(129759)),id:"recidive"},{name:s.t(null,void 0,i(405156)),text:s.t(null,void 0,i(657959)).format({link:e}),id:"script_publishing"}]}return o}},91326:(t,e,i)=>{"use strict";function s(){return Promise.all([i.e(22666),i.e(62253),i.e(34465),i.e(69121),i.e(9817),i.e(92108),i.e(87845),i.e(13152),i.e(38669),i.e(5145),i.e(25190),i.e(36747),i.e(45896),i.e(64534),i.e(90684),i.e(13821),i.e(27620),i.e(74188),i.e(43131),i.e(88158),i.e(58739),i.e(3981),i.e(90368),i.e(30979),i.e(1031),i.e(745),i.e(6097),i.e(94398)]).then(i.bind(i,864813)).thg()))}i.d(e,{openIgnoreUsersDialog:()=>s})},33005:(t,e,i)=>{"use strict";function s(t){const e=t=>{Promise.all([i.e(22666),i.e(62253),i.e(9817),i.e(92108),i.e(61298),i.e(51893),i.e(745),i.e(10373)]).then(i.bind(i,567871)).th(t)))};if("string"==typeof t)return void e(t);const s=i=>{i.preventDefault(),i.stopPropagation(),t.href&&e(t.href)};return t.addEventListener("click"s)}}i.d(e,{openImageDialog:()=>s})},275108:(t,e,i)=>{"use strict";function s(t,e,s,o,a,n){return Promise.all([i.e(76592),i.e(63987),i.e(35213),i.e(63830),i.e(1888),i.e(69704),i.e(25977),i.e(40228),i.e(11595),i.e(59356)]).then(i.bind(i,28866)).th,n)))}i.d(e,{showReportModal:()=>s})},186164:(t,e,i)=>{"use strict";i.d(e,{addPineCodeListener:()=>h,
insertPineCode:()=>r,isClipboardHasPineCode:()=>n,markPineCodeHand=>o});const s="pi")}function a(t){return`[pine]${e=t,e.replace(/\s+$/g,"")}[/pine]`;vas)}function r(t){const{clipboardText:e,value:i,selectionStart:s=0,selectionEnd:o=0}=t,n=a(e);return i.substring(0,s)+n+i.substring(o)}function h(t,e){const i=i=>{if(!i.clipboardData||!n(i.clipboardData))return;i.preventDefault();const s=i.clipboardData.getData("text"),o=t.selectionStart||0,r=t.selectionEnd||0;t.setRangeText(a(s),o,r,"select"),null==e||e(i)};return t.addEventListener("paste",i)}},828616:t=>{"use strict";var e,i=[];function s(){for(var t=!1,s=i.length;s--;){var o=i[s].onclose;i[s].wnd.closed?(o&&o.call(i[s].wnd),i.splice(s,1)):o&&(t=!0)}!t&&e&&(clearInterval(e),e=void 0)}t.exports={open:function(t){"string"==typeof t?t={url:t}:null==t&&(t={}),null!=t.url&&""!==t.url||(t.url="about:blank"),null==t.name&&(t.name=void 0);var o=window.open(t.url,t.name,function(t){if(null==t)return"";if("object"==typeof t){var e="";for(var i in t){var s=t[i];if("boolean"==typeof s)s=s?"yes":"no";else if(null==s)continue;e+=(e?",":"")+i+"="+s}return e}return t+""}(t.parameters)),a=void 0!==t.data,n={wnd:o,data:t.data};return"function"==typeof t.onclose&&(n.onclose=t.onclose,a=!0),"function"==typeof t.onbound&&(n.onbound=t.onbound,a=!0),a&&(i.push(n),!e&&n.onclose&&(e=setInterval(s,1e3))),o},getData:function(t){for(var e=i.length;e--;)if(i[e].wnd===t)return i[e].onbound&&(i[e].onbound.call(t),i[e].onbound=null),i[e].data}}},466563:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="m7.47 11.53 1.06-1.06L14 15.94l5.47-5.47 1.06 1.06L14 18.06l-6.53-6.53Z"/></svg>'},561720:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M6.5 7C5.67 7 5 7.67 5 8.5V20l4-3.01h5v1H9.34L4 22V8.5A2.5 2.5 0 0 1 6.5 6h12A2.5 2.5 0 0 1 21 8.5V11h-1V8.5c0-.83-.67-1.5-1.5-1.5h-12Zm7.5 6v1H8v-1h6Zm12 12ZM8 10h9v1H8v-1Zm12 7h-4v1h4v4h1v-4h4v-1h-4v-4h-1v4Z"/></svg>'},6198:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M13.9 14.1V22h1.2v-7.9H23v-1.2h-7.9V5h-1.2v7.9H6v1.2h7.9Z"/></svg>'},899280:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M8.5 6A2.5 2.5 0 0 0 6 8.5v11A2.5 2.5 0 0 0 8.5 22h11a2.5 2.5 0 0 0 2.5-2.5v-3h-1v3c0 .83-.67 1.5-1.5 1.5h-11A1.5 1.5 0 0 1 7 19.5v-11C7 7.67 7.67 7 8.5 7h3V6h-3zm7 1h4.8l-7.49 7.48.71.7L21 7.72v4.79h1V6h-6.5v1z"/></svg>'},67375:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M12.5 6a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM5 12.5a7.5 7.5 0 1 1 13.1 4.99l4.75 4.65-.7.72-4.76-4.67A7.5 7.5 0 0 1 5 12.5Z"/></svg>'},703074:t=>{
t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M11 10.5c0-1.02.27-1.89.8-2.5.54-.6 1.39-1 2.7-1 1.31 0 2.16.4 2.7 1 .53.61.8 1.48.8 2.5s-.27 1.89-.8 2.5c-.54.6-1.39 1-2.7 1-1.31 0-2.16-.4-2.7-1-.53-.61-.8-1.48-.8-2.5ZM14.5 6c-1.53 0-2.68.49-3.44 1.34A4.67 4.67 0 0 0 10 10.5c0 1.19.31 2.32 1.06 3.16.76.85 1.91 1.34 3.44 1.34s2.68-.49 3.44-1.34A4.67 4.67 0 0 0 19 10.5c0-1.19-.31-2.32-1.06-3.16C17.18 6.49 16.03 6 14.5 6ZM7 23c0-2.4 1.83-5 5-5h5v-1h-5c-3.83 0-6 3.15-6 6h1Zm14-3h-4v1h4v4h1v-4h4v-1h-4v-4h-1v4Z"/></svg>'},844996:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="none"><path fill="currentColor" fillRule="evenodd" clipRule="evenodd" d="M7.5 13a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zM5 14.5a2.5 2.5 0 1 1 5 0 2.5 2.5 0 0 1-5 0zm9.5-1.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zM12 14.5a2.5 2.5 0 1 1 5 0 2.5 2.5 0 0 1-5 0zm9.5-1.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zM19 14.5a2.5 2.5 0 1 1 5 0 2.5 2.5 0 0 1-5 0z"/></svg>'},667130:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 12" width="12" height="12"><path d="M5 .7C3 .7 2 3 2 5c0 4 0 4-2 5h12c-2-1-2-1-2-5C10 3 9 .7 7 .7c0-.9-2-.9-2 0zM4 11c0 1 1 1 2 1s2 0 2-1z"/></svg>'},648449:t=>{
t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="evenodd"><path fill-rule="nonzero" d="M14 17a3 3 0 1 1 0-6 3 3 0 0 1 0 6zm0-1a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"/><path d="M5.005 16A1.003 1.003 0 0 1 4 14.992v-1.984A.998.998 0 0 1 5 12h1.252a7.87 7.87 0 0 1 .853-2.06l-.919-.925c-.356-.397-.348-1 .03-1.379l1.42-1.42a1 1 0 0 1 1.416.007l.889.882A7.96 7.96 0 0 1 12 6.253V5c0-.514.46-1 1-1h2c.557 0 1 .44 1 1v1.253a7.96 7.96 0 0 1 2.06.852l.888-.882a1 1 0 0 1 1.416-.006l1.42 1.42a.999.999 0 0 1 .029 1.377s-.4.406-.918.926a7.87 7.87 0 0 1 .853 2.06H23c.557 0 1 .447 1 1.008v1.984A.998.998 0 0 1 23 16h-1.252a7.87 7.87 0 0 1-.853 2.06l.882.888a1 1 0 0 1 .006 1.416l-1.42 1.42a1 1 0 0 1-1.415-.007l-.889-.882a7.96 7.96 0 0 1-2.059.852v1.248c0 .56-.45 1.005-1.008 1.005h-1.984A1.004 1.004 0 0 1 12 22.995v-1.248a7.96 7.96 0 0 1-2.06-.852l-.888.882a1 1 0 0 1-1.416.006l-1.42-1.42a1 1 0 0 1 .007-1.415l.882-.888A7.87 7.87 0 0 1 6.252 16H5.005zm3.378-6.193l-.227.34A6.884 6.884 0 0 0 7.14 12.6l-.082.4H5.005C5.002 13 5 13.664 5 14.992c0 .005.686.008 2.058.008l.082.4c.18.883.52 1.71 1.016 2.453l.227.34-1.45 1.46c-.004.003.466.477 1.41 1.422l1.464-1.458.34.227a6.959 6.959 0 0 0 2.454 1.016l.399.083v2.052c0 .003.664.005 1.992.005.005 0 .008-.686.008-2.057l.399-.083a6.959 6.959 0 0 0 2.454-1.016l.34-.227 1.46 1.45c.003.004.477-.466 1.422-1.41l-1.458-1.464.227-.34A6.884 6.884 0 0 0 20.86 15.4l.082-.4h2.053c.003 0 .005-.664.005-1.992 0-.005-.686-.008-2.058-.008l-.082-.4a6.884 6.884 0 0 0-1.016-2.453l-.227-.34 1.376-1.384.081-.082-1.416-1.416-1.465 1.458-.34-.227a6.959 6.959 0 0 0-2.454-1.016L15 7.057V5c0-.003-.664-.003-1.992 0-.005 0-.008.686-.008 2.057l-.399.083a6.959 6.959 0 0 0-2.454 1.016l-.34.227-1.46-1.45c-.003-.004-.477.466-1.421 1.408l1.457 1.466z"/></g></svg>'},661963:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 11.5" width="20" height="16"><path d="M7.5 4.8c-1.1 0-1.9.9-1.9 1.9s.9 1.9 1.9 1.9c1.1 0 1.9-.9 1.9-1.9s-.9-1.9-1.9-1.9zM13 1.9h-2.2c0-1-.9-1.9-2-1.9H6.1C5 0 4.2.9 4.2 1.9H1.9c-1 0-1.9.9-1.9 2v5.7c0 1.1.9 1.9 1.9 1.9H13c1.1 0 1.9-.9 1.9-1.9V3.9c.1-1.1-.8-2-1.9-2zm-5.5 8.3C5.6 10.2 4 8.6 4 6.7s1.5-3.4 3.4-3.4 3.4 1.5 3.4 3.4c.1 1.9-1.4 3.5-3.3 3.5z"/></svg>'},372665:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14" width="14" height="14"><path d="M10.893 9.512l.458 3.624c.014.105-.006.16-.02.176-.028.03-.109.005-.182-.03L7.812 11.73a1.973 1.973 0 0 0-.811-.16c-.302 0-.59.057-.81.16l-3.338 1.552c-.118.056-.164.051-.182.03-.014-.016-.034-.07-.02-.178L3.11 9.51c.06-.503-.162-1.18-.505-1.54L.087 5.302c-.085-.091-.09-.148-.086-.158.003-.01.04-.053.16-.077l3.621-.689c.491-.09 1.069-.506 1.315-.948L7.004 0l1.902 3.43c.246.442.824.859 1.312.947l3.617.69c.123.024.162.068.164.077.003.01-.003.066-.089.157L11.4 7.97c-.348.367-.57 1.045-.506 1.543z"/></svg>'},122694:t=>{
t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M14.33 23.62c1.5 0 2.84-.18 3.75-.5v-1.19c-.76.3-2.22.5-3.74.5-4.65 0-8.05-3.06-8.05-8.18v-.01c0-4.75 3.31-8.14 7.84-8.14 4.6 0 7.77 2.9 7.77 7.38 0 2.9-.89 4.45-2.27 4.45-1.04 0-1.72-.84-1.72-2.43V9.86h-1.3v1.57h-.08a2.99 2.99 0 0 0-2.85-1.8c-2.29 0-3.89 1.9-3.89 4.68 0 2.83 1.57 4.72 3.9 4.72 1.42 0 2.6-.7 3.14-2.15h.09l.03.12c.34 1.25 1.29 2.12 2.66 2.12 2.1 0 3.6-1.98 3.6-5.64v-.02c0-5.2-3.76-8.55-8.98-8.55C8.82 4.9 5 8.74 5 14.23c0 5.9 3.9 9.39 9.34 9.39Zm-.47-5.81c-1.63 0-2.68-1.36-2.68-3.5 0-2.11 1.05-3.47 2.7-3.47 1.65 0 2.7 1.32 2.7 3.43v.01c0 2.15-1.07 3.53-2.72 3.53Z"/></svg>'},265872:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 12" width="12" height="12"><path d="M6 12A6 6 0 1 0 6 0a6 6 0 0 0 0 12ZM4.29 4.29c.29-.3.77-.3 1.06 0l1.54 1.54 1.53-1.54a.75.75 0 1 1 1.06 1.06L7.42 7.42a.75.75 0 0 1-1.06 0L4.82 5.88 3.28 7.42a.75.75 0 0 1-1.06-1.06l2.07-2.07Z"/></svg>'},15989:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 24" width="32px" height="24px"><path d="M32 24V0L20 12v12zm-20 0V0L0 12v12z"/></svg>'},718043:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M19.32 6H8.68A2.68 2.68 0 0 0 6 8.68V11h1V8.68C7 7.75 7.75 7 8.68 7h10.64c.93 0 1.68.75 1.68 1.68V11h1V8.68C22 7.2 20.8 6 19.32 6ZM7 19.32c0 .93.75 1.68 1.68 1.68h10.64c.93 0 1.68-.75 1.68-1.68V17h1v2.32C22 20.8 20.8 22 19.32 22H8.68A2.68 2.68 0 0 1 6 19.32V17h1v2.32Z"/></svg>'},822353:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 12" width="12px" height="12px" fill="currentColor"><path d="M10.37.6c-.43.053-.97.13-1.55.13C7.918.73 7.1.52 6.273.35 5.433.175 4.566 0 3.648 0 1.816 0 1.195.38 1.133.42L1 .51V12h.625V6.626c.234-.094.85-.26 2.027-.26.852.002 1.65.313 2.496.49.86.175 1.75.36 2.715.36.574 0 1.082-.076 1.512-.125.234-.023.44-.05.625-.08V.506c-.184.035-.395.065-.63.095z"/></svg>'},214729:t=>{
t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 42 42" width="42px" height="42px"><path d="M38.626 17.554h-2.81c-.354-1.755-1.055-3.157-1.756-4.566l1.756-1.755c1.4-1.4 1.4-3.51 0-4.912s-3.51-1.4-4.912 0l-1.756 1.76c-1.4-.7-2.81-1.4-4.565-1.752V3.51c0-2.11-1.402-3.51-3.51-3.51s-3.52 1.41-3.52 3.51v2.81c-1.754.355-3.156 1.056-4.565 1.756L11.233 6.32c-1.4-1.4-3.51-1.4-4.912 0s-1.4 3.512 0 4.913l1.76 1.755c-.7 1.402-1.4 2.81-1.753 4.566H3.51c-2.1 0-3.51 1.41-3.51 3.51s1.4 3.512 3.51 3.512h2.81c.355 1.755 1.056 3.156 1.756 4.565L6.32 30.9c-1.4 1.402-1.4 3.51 0 4.913s3.512 1.4 4.913 0l1.755-1.756c1.402.7 2.81 1.402 4.566 1.756v2.815c0 2.11 1.4 3.51 3.51 3.51s3.51-1.4 3.51-3.51v-2.81c1.757-.354 3.158-1.055 4.567-1.756l1.76 1.754c1.4 1.4 3.51 1.4 4.915 0s1.4-3.51 0-4.912l-1.756-1.756c.7-1.4 1.4-2.81 1.755-4.565h2.81c2.107 0 3.51-1.4 3.51-3.51.006-2.11-1.403-3.52-3.505-3.52zm-17.56 14.05c-5.968 0-10.534-4.565-10.534-10.532s4.566-10.54 10.533-10.54 10.532 4.566 10.532 10.533-4.558 10.54-10.532 10.54zm0-14.05c-2.11 0-3.512 1.4-3.512 3.51s1.4 3.512 3.51 3.512 3.51-1.402 3.51-3.51-1.4-3.512-3.51-3.512z"/></svg>'},633502:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M9 1.91A7.09 7.09 0 1 0 9 16.1 7.09 7.09 0 0 0 9 1.9ZM2.91 9A6.09 6.09 0 1 1 15.1 9 6.09 6.09 0 0 1 2.9 9Zm8.34-.64a.96.96 0 1 0 0-1.93.96.96 0 0 0 0 1.93Zm-3.54-.97a.96.96 0 1 1-1.92 0 .96.96 0 0 1 1.92 0Zm4.55 4.1.3-.4-.8-.6-.3.39a3.07 3.07 0 0 1-2.45 1.21 3.08 3.08 0 0 1-2.45-1.2l-.3-.4-.8.61.3.4a4.07 4.07 0 0 0 3.25 1.6v-.5.5a4.08 4.08 0 0 0 3.25-1.62Z"/></svg>'},78620:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 11 11" width="11" height="11"><path fill="none" stroke="currentColor" d="M10.5 6v3.5a1 1 0 0 1-1 1h-8a1 1 0 0 1-1-1v-8a1 1 0 0 1 1-1H5m5.5 0L6 5M7 .5h3.5V4"/></svg>'},3044:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="50" height="50"><path d="M20 17.995c0-1.102.753-1.51 1.69-.91l10.62 6.83c.934.6.937 1.57 0 2.17l-10.62 6.83c-.934.6-1.69.192-1.69-.91v-14.01z"/></svg>'},205128:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="27" height="16"><g fill="none"><rect width="27" height="16" fill="#2962FF" rx="8"/><path stroke="#FFF" stroke-linejoin="round" d="M8.5 3.5h6a2 2 0 0 1 2 2v1l4-2v7l-4-2v1a2 2 0 0 1-2 2h-6a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2z"/><path fill="#FFF" fill-rule="nonzero" d="M20 5.309l-3.276 1.638A.5.5 0 0 1 16 6.5v-1A1.5 1.5 0 0 0 14.5 4h-6A1.5 1.5 0 0 0 7 5.5v5A1.5 1.5 0 0 0 8.5 12h6a1.5 1.5 0 0 0 1.5-1.5v-1a.5.5 0 0 1 .724-.447L20 10.69V5.309zM17 10.5a2.5 2.5 0 0 1-2.5 2.5h-6A2.5 2.5 0 0 1 6 10.5v-5A2.5 2.5 0 0 1 8.5 3h6A2.5 2.5 0 0 1 17 5.5v.191l3.276-1.638A.5.5 0 0 1 21 4.5v7a.5.5 0 0 1-.724.447L17 10.31v.191z"/></g></svg>'},653>'},713984:(t,e,i)=>{"use strict";t.exports=i.p+"avatar.4c0c4f3044bab1770420.png"},762g"}}]);