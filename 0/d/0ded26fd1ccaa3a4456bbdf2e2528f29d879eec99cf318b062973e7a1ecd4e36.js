fluctAdScript.mod.define("lib/tpl/2/surface",["../../logger","../../util"],(function(t,e){"use strict";function o(t){if(t&&t.__esModule)return t;var e=Object.create(null);return t&&Object.keys(t).forEach((function(o){if("default"!==o){var i=Object.getOwnPropertyDescriptor(t,o);Object.defineProperty(e,o,i.get?i:{enumerable:!0,get:function(){return t[o]}})}})),e.default=t,Object.freeze(e)}var i=o(t),n=16/9;return function(){function t(t,o,n){void 0===n&&(n=!1);var a=[];if(this.params={closeButton:e.getValueOrDefault(null==t?void 0:t.closeButton,"disable",(function(){a.push("close_button")})),closeButtonSize:e.getValueOrDefault(null==t?void 0:t.closeButtonSize,null,(function(){})),videoPosition:e.getValueOrDefault(null==t?void 0:t.videoPosition,"right_bottom",(function(){a.push("video_position")})),maxVideoWidthRatio:e.getValueOrDefault(null==t?void 0:t.maxVideoWidthRatio,.5,(function(){a.push("max_video_width_ratio")})),videoRemain:e.getValueOrDefault(null==t?void 0:t.videoRemain,!0,(function(){a.push("video_remain")}))},!n&&a.length>0){var s="Detect null record interstitial Template on group "+o+": "+a;i.warn(s,{msg:s},1)}}return t.prototype.buildCloseButton=function(t){var e=document.createElement("img");return e.src="https://pdn.adingo.jp/asset/close.svg",e.style.position="absolute",e.style.pointerEvents="auto",e.style.right="0px",e.style.top=-4-t+"px",e.style.width=t+"px",e.style.height=t+"px",e},t.prototype.apply=function(t){var e,o=this,i=function(t,e){return Math.min(t.documentElement.clientWidth*e,.25*t.documentElement.clientHeight*n,384)}(t.ownerDocument,this.params.maxVideoWidthRatio),a=i/n;t.style.width=i+"px",t.style.height=a+"px";var s=t.style;switch(s.filter="drop-shadow(4px 4px 4px black)",s.position="fixed",s.opacity="0.0",s.zIndex="20000",this.params.videoPosition){case"right_bottom":s.bottom="-"+a+"px",s.right="24px";break;case"left_bottom":s.bottom="-"+a+"px",s.left="24px";break;case"right_top":s.top="24px",s.right="24px";break;case"left_top":s.top="24px",s.left="24px";break;default:s.bottom="-"+a+"px",s.right="24px"}if("disable"!==this.params.closeButton){var r=null!==(e=this.params.closeButtonSize)&&void 0!==e?e:Math.min(i/12,32),l=this.buildCloseButton(r);t.appendChild(l),l.addEventListener("click",(function(){"right_top"===o.params.videoPosition||"left_top"===o.params.videoPosition?(s.transition="opacity 1s linear 0s, top 0.5s ease-in 0.5s",s.top="-"+(a+r+4)+"px"):(s.transition="opacity 1s linear 0s, bottom 0.5s ease-in 0.5s",s.bottom="-"+(a+r+4)+"px"),s.opacity="0.0",t.dispatchEvent(new Event("clickCloseButton"))}))}t.addEventListener("load",(function(){"right_top"===o.params.videoPosition||"left_top"===o.params.videoPosition?(s.transition="opacity 1s linear, top 0.5s ease-in",s.top="24px"):(s.transition="opacity 1s linear, bottom 0.5s ease-in",s.bottom="24px"),s.opacity="1.0"})),"disable"!==this.params.closeButton&&!1!==this.params.videoRemain||t.addEventListener("complete",(function(){"right_top"===o.params.videoPosition||"left_top"===o.params.videoPosition?(s.transition="opacity 1s linear 1.5s, top 0.5s ease-in 2.0s",s.top="-"+a+"px"):(s.transition="opacity 1s linear 1.5s, bottom 0.5s ease-in 2.0s",s.bottom="-"+a+"px"),s.opacity="0.0"}))},t}()}));
fluctAdScript.mod.define("lib/tpl/2",["../util","../logger","../promise","./2/surface"],(function(t,o,e,n){"use strict";r a=i(o),l=r(n),u="https://pdn.adingo.jp/asset/close.svg";return function(){function o(o,e,n){var r,i,l,s,c,p,d,v,h,f,m,y,g,b,B,P,x,O;void 0===n&&(n=!1);var k=document.createElement("div");this.componentMap={background:k};var C=[];if(this.overlayParams={prHeight:t.getValueOrDefault(null===(r=o.overlay)||void 0===r?void 0:r.prHeight,0,(function(){C.push("pr_height")})),prText:t.getValueOrDefault(null===(i=o.overlay)||void 0===i?void 0:i.prText,"【PR】",(function(){C.push("pr_text")})),prColor:t.getValueOrDefault(null===(l=o.overlay)||void 0===l?void 0:l.prColor,"#fff",(function(){C.push("pr_color")})),prBgColor:t.getValueOrDefault(null===(s=o.overlay)||void 0===s?void 0:s.prBgColor,"#000",(function(){C.push("pr_bg_color")})),closeButton:t.getValueOrDefault(null===(c=o.overlay)||void 0===c?void 0:c.closeButton,"disable",(function(){C.push("close_button")})),closeButtonPosition:t.getValueOrDefault(null===(p=o.overlay)||void 0===p?void 0:p.closeButtonPosition,"right",(function(){C.push("close_button_position")})),closeButtonSize:t.getValueOrDefault(null===(d=o.overlay)||void 0===d?void 0:d.closeButtonSize,null,(function(){})),closeButtonUrl:t.getValueOrDefault(null===(v=o.overlay)||void 0===v?void 0:v.closeButtonUrl,u,(function(){C.push("close_button_url")})),zoom:t.getValueOrDefault(null===(h=o.overlay)||void 0===h?void 0:h.zoom,"enable",(function(){C.push("zoom")})),zIndex:t.getValueOrDefault(null===(f=o.overlay)||void 0===f?void 0:f.zIndex,2e4,(function(){})),autoPadding:t.getValueOrDefault(null===(m=o.overlay)||void 0===m?void 0:m.autoPadding,){})),backgroundColor:t.getValueOrDefault(null===(y=o.overlay)||void 0===y?void 0:y.backgroundColor,"#333",(function(){C.push("background_color")})),backgroundOpacity:t.getValueOrDefault(null===(g=o.overlay)||void 0===g?void 0:g.backgroundOpacity")}))},!n&&C.length>0){var M="Detect null record overlay Template on group "+e+": "+C;a.warn(M,{msg:M},1)}this.surfaceParams={maxVideoWidthRatio:null===(b=o.overlay)||void 0===b?void 0:b.maxVideoWidthRatio,videoPosition:null===(B=o.overlay)||void 0===B?void 0:B.videoPosition,videoRemain:null===(P=o.overlay)||void 0===P?void 0:P.videoRemain,closeButton:null===(x=o.overlay)||void 0===x?void 0:x.closeButton,closeButtonSize:null===(O=o.overlay)||void 0===O?void 0:O.closeButtonSize},this.groupId=e,this.isLegacy=n}return o.prototype.apo)},o.prototype.buildComponents=function(t){var o=this,e=document.createElement("div");if(t.appendChild(e),this.componentMap.prBand=e,t.parentNode.insertBefore(this.componentMap.background,t),"disable"!==this.overlayParams.closeButton&&"video_only"!==this.overlayParams.closeButton){var n=document.createElement("img");t.appendChild(n),n.addEventListener("click",(function(){var e=[t.style];e.push(o.componentMap.background.style),e.forEae"}))})),this.componentMap.closeButton=n}},o.prototype.calcScale=function(t,o){return"disable"===this.overlayParams.zoom?1:t.ownerDocument.documentElement.clientWidth/o},o.prototype.layoutPrBand=function(){if(this.componentMap.prBand){var t=this.overlayParams.prHeight,o=this.componentMap.prBand.style;if(o.width="100%",o.position="absolute",o.overflow="hidden",0===t)return o.height="0",void(o.bottom="0");o.height=t+"px",o.lineHeight=t+"px",o.bottom="-"+t+"px",o.textAlign="center",o.backgroundColor=this.overlayParams.prBgColor,o.color=this.overlayParams.prColor,o.fontSize="12px",this.componentMap.prBand.innerHTML=this.overlayParams.prText}},o.prototype.getCloseButtonUrl=function(o){if(t.isValidUrl(o))return o;var e='Detect invalid close button url "'+o+'"';return a.warn(e,{msg:e},1),u},o.prototype.layoutCloseButton=function(t,o){var e;if(this.componentMap.closeButton){var n=this.componentMap.closeButton;n.src=this.getCloseButtonUrl(this.overlayParams.closeButtonUrl);var r=n.style;r.position="absolute";var i=null!==(e=this.overlayParams.closeButtonSize)&&void 0!==e?e:Math.min(t/12,32),a=o.getBoundingClientRect();switch(this.overlayParams.closeButtonPosition){case"left":r.left="-"+a.x+"px";break;default:r.right="-"+a.x+"px"}r.top="-"+i+"px",r.width=i+"px",r.height=i+"px",r.pointerEvents="auto"}},o.prototype.layoutBackground=function(t,o){if(this.componentMap.background){var e=t+this.overlayParams.prHeight,n=this.componentMap.background.style;n.width="100%",n.height=e+"px",n.position="fixed",n.left="0px",n.bottom="0px",n.zIndex=String(this.overlayParams.zIndex-1),n.border="0px",n.transform="scaleY("+o+")",n.transformOrigin="left bottom",n.background=this.overlayParams.backgroundColor,n.opacity=""+this.overlayParams.backgroundOpacity}},o.prototype.layout=function(t,o,e){var n=t.ownerDocument,r=this.calcScale(t,o),i=this.overlayParams.prHeight,a=t.style;a.width=o+"px",a.height=e+"px",a.position="fixed",a.bottom=i*r+"px",a.left="calc(50% - "+o*r+"px / 2)",a.transform="scale("+r+")",a.transformOrigin="left bottom",a.zIndex=String(this.overlayParams.zIndex);var l=(e+i)*r;!0===this.overlayParams.autoPadding&&(n.body.style.paddingBottom=l+"px"),this.layoutPrBand(),this.layoutCloseButton(o,t),this.layoutBackground(e,r)},o.prototype.changeStackingOrderOfGamOverlayCloseButton=function(t){var o=t.getElementById("fluct-pc-sticky-ad-close-button");o&&(o.style.zIndex=String(this.overlayParams.zIndex))},o.prototype.overlay=function(o,n){var r=this;if(t.escapeFromIframe(o),this.changeStackingOrderOfGamOverlayCloseButton(o.ownerDocument),"vast"===n.creative_type)return new l.default(this.surfaceParams,this.groupId,this.isLegacy).apply(o),e.PromiseLike.resolve({root:o,componentMap:{},modifierMap:{}});if(!t.hasActualSize(n))return e.PromiseLike.resolve({root:o,componentMap:{},modifierMap:{}});var i=n.width,a=n.height;return this.buildComponents(o),this.layout(o,i,a),e.PromiseLike.resolve({root:o,componentMap:this.componentMap,modifierMap:{setHeight:function(t){a=t,r.layout(o,i,a)},setPrHeia)},setWia)}}})},o}()}));
