;
(self.AMP=self.AMP||[]).push({m:0,v:"2401032027001",n:"amp-autocomplete",ev:"0.1",l:!0,f:function(t,n){!function(){var n,i,e,r=Object.create,u=Object.defineProperty,o=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,a=Object.getPrototypeOf,c=Object.prototype.hasOwnProperty,h=(n={"third_party/fuzzysearch/index.js":function(t,n){"use strict";n.exports=function(t,n){var i=n.length,e=t.length;if(e>i)return!1;if(e===i&&t===n)return!0;t:for(var r=0,u=0;r<e;r++){for(var o=t.charCodeAt(r);u<i;)if(n.charCodeAt(u++)===o)continue t;return!1}return!0}}},;ay.isArray;ar j=Object.prototype,O=j.hasOwnProperty,R=j.toString;tion A(t,n,i,e,r,u,o,s,a,c,h){return t} P=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;elf.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var M=self.__AMP_LOG;ion(t){return J(t,"batched-xhr")},Q=function(t){return J(t,"xhr")};r X,Y,Z=),tt=),nt=new Set(["c","v","a","ad"]),it="__amp_source_origin",et=nction ot(t,n,i,e){return t,ut(n,i),e)}r ct=["GET","POST"],ht=[w,;ar lt=function(t,n,i){return i=null!=t?r(a(t)):{},function(t,n,i,e){if(n&&"object"==typeof n||"function"==typeof n)for(var r,a=s(n),h=0,f=a.length;h<f;h++)r=a[h],c.call(t,r)||void 0===r||u(t,r,{get:bind(null,r),enumerable:!(e=o(n,r))||e.enumerable});return t}(t&&t.__esModule?i:u(i,"default",{value:t,enumerable:!0}),t)}(h()),pt=function(){function t(t){var n=t.element;this.Ut=n,this.No=this.Ut.getAttribute("inline"),L(""!==this.No,'Empty value for the "inline" attr is unsupported, %s. %s',"amp-autocomplete",n),L(""!==this.No,"AutocompleteBindingInline does not support an empty value in the constructor."),this.tQ=null;var i=this.No.replace(/([()[{*+.$^\\|?])/g,"\\$1"),e="((".concat(i,"|^").concat(i,")(\\w+)?)");this.nQ=new RegExp(e,"gm")}var n=t.prototype;return n.shouldAutocomplete=function(t){var n=this.iQ(this.nQ,t);return this.tQ=n,!!n},n.iQ=function(t,n){if(!t)return null;for(var i,e,r=n.selectionStart,u=n.value;null!==(i=t.exec(u))&&!(i[0].length+T(i,"index")>r);)e=i;return!e||e[0].length+T(e,"index")<r?null:e},n.getUserInputForUpdate=function(t){return this.tQ&&this.tQ[0]?this.tQ[0].slice(this.No.length):""},n.getUserInputForUpdateWithSelection=function(t,n,i){if(!this.tQ)return n.value;var e=n.selectionStart,r=Number(T(this.tQ,"index")),u=i.length;e>=r+u&&(e-=u),k(n),e=e+t.length+1,n.setSelectionRange(e,e),this.tQ=null;var o=n.value;return o.slice(0,r+this.No.length)+t+" "+o.slice(r+this.No.length+u)},n.resetInputOnWrapAround=n.shouldSuggestFirst=function(){return this.Ut.hasAttribute("suggest-first")},n.shouldShowOnFocus=function(){return!1},n.displayActiveItemInInput=n.removeSelectionHighlighting=n.shouldPreventDefaultOnEnter=t}(),dt=function(){function t(t){var n=t.element;this.eQ=n.hasAttribute("suggest-first");var i=n.getAttribute("filter");this.eQ&&"prefix"!==i&&(this.eQ=!1,z().warn("AMP-AUTOCOMPLETE",'"suggest-first" expected "filter" type "prefix".')),this.rQ=n.hasAttribute("submit-on-enter")}var n=t.prototype;return n.shouldAutocomplete=n.getUserInputForUpdate=n.getUserInputForUpdateWithSelection=n.resetInputOnWrapAround=n.shouldSuggestFirst=n.shouldShowOnFocus=n.displayActiveItemInInput=function(t,n,i){t.value=n,this.eQ&&t.setSelectionRange(i.length,n.length)},n.removeSelectionHighlighting=n.shouldPreventDefaultOnEnter=t}();ar mt=),bt="amp-autocomplete",yt="none",xt=function(t){!r,t);var n,i,e=(n=r,i=),;function r(t){var n,i,r,u;return(n=e.call(this,t)).Du=null,n.uQ=null,n.oQ=null,n.sQ="",n.ZN="",n.aQ=1,n.cQ=null,n.eQ=!1,n.hQ=!1,n.fQ=!1,n.lQ="",n.pQ="",n.dQ=-1,n.vQ=null,n.mB=t.id?t.id:Math.floor(100*Math.random()),n.pg=null,n.DG=!1,n.mQ=null,n.Xb=null,n.bQ=!1,n.getSsrTemplateHelper=(i=!1,r=null,u=function(){return new mt(bt,B(n.element,"viewer"),n.Xb)},,n.yQ=!1,n.Yo=null,n.Ph=null,n.xQ=!1,n.wQ=t.id?t.id:Math.floor(100*Math.random())+"_AMP_content_",n}var u=r.prototype;return u.buildCallback=function(){this.Xb=B(this.element,"templates"),this.Yo=$(this.element,"action"),this.Ph=B(this.element,"viewport"),this.oQ=this.gQ();var t=this.oQ.getAttribute("type");L(!this.oQ.hasAttribute("type")||"text"===t||"search"===t,'%s requires the "type" attribute to be "text" or "search" if present on <input>. %s',bt,this.element),this.Du=this.jQ(),this.pQ=this.element.getAttribute("query"),this.lQ=this.element.getAttribute("src");var n=this.element.querySelector('script[type="application/json"]');n?this.uQ=this.OQ(n):this.element.hasAttribute("src")||z().warn(bt,'Expected a <script type="application/json"> child or a URL specified in "src".'),this.oQ.setAttribute("dir","auto"),this.oQ.setAttribute("aria-autocomplete","both"),this.oQ.setAttribute("role","textbox"),this.oQ.setAttribute("aria-controls",this.wQ),"INPUT"===this.oQ.tagName&&(this.element.setAttribute("role","combobox"),this.oQ.setAttribute("aria-multiline","false")),this.element.setAttribute("aria-haspopup","listbox"),this.element.setAttribute("aria-expanded","false"),this.element.setAttribute("aria-owns",this.wQ);var i,e=this.RQ();e&&e.hasAttribute("autocomplete")&&(this.mQ=e.getAttribute("autocomplete")),this.yQ=this.getSsrTemplateHelper().isEnabled(),this.bQ=this.Xb.hasTemplate(this.element,"template, script[template]"),this.yQ&&(L(this.lQ,'%s requires data to be provided via "src" attribute for server-side rendering. %s',bt,this.element),L(this.bQ,"".concat(bt,' should provide a <template> or <script type="plain/text"> element.')),L(!this.element.hasAttribute("filter"),"".concat(bt," does not support client-side filter when server-side render is required."))),this.ZN=this.element.getAttribute("filter")||yt,L("substring"===(i=this.ZN)||"prefix"===i||"token-prefix"===i||"fuzzy"===i||"custom"===i||"none"===i,"Unexpected filter: %s. %s",this.ZN,this.element),this.aQ=this.element.hasAttribute("min-characters")?parseInt(this.element.getAttribute("min-characters"),10):1,this.element.hasAttribute("max-entries")&&z().warn(bt,'"max-items" attribute is preferred to "max-entries"');var r=this.element.getAttribute("max-items")||this.element.getAttribute("max-entries");return this.cQ=r?parseInt(r,10):null,this.eQ=this.Du.shouldSuggestFirst(),this.fQ=this.element.hasAttribute("highlight-user-entry"),this.pg=this.hH(),this.element.appendChild(this.pg),this.uA(),l()},u.uA=function(){var t=this;this.oQ.addEventListener("touchstart",(function(){t.EQ()}),{passive:!0}),this.oQ.addEventListener("input",(function(){t.SQ()})),this.oQ.addEventListener("keydown",(function(n){t.TQ(n)})),this.oQ.addEventListener("focus",(function(){t.EQ().then(()})),this.oQ.addEventListener("blur",(function(){t.UQ(!1)})),this.pg.addEventListener("mousedown",(function(n){t.AQ(n)}))},u.gQ=function(){var t=this.element.querySelectorAll("input,textarea");return L(1==t.length,"%s should contain exactly one <input> or <textarea> descendant %s",bt,this.element),t[0]},u.RQ=u.jQ=function(){return this.element.hasAttribute("inline")?new pt(this):new dt(this)},u.OQ=function(t){var n=I(t.textContent,(function(t){throw t})),i=this.element.getAttribute("items")||"items",e=U(n,i);return e?z().assertArray(e):(z().warn(bt,'Expected key "%s" in data but found nothing. Rendering empty results.',i),[])},u.IQ=function(){var t=this,n=this.getAmpDoc(),i=this.element.getAttribute("items")||"items";return this.kQ(),this.yQ?vt(this.element,this.element.getAttribute("src"),2,!1).then((function(n){var e,r,u;n.xhrUrl=(e=t.win,r=n.xhrUrl,u=n.fetchOpt,A("string"==typeof r),!1!==u.ampCors&&(r=function(t,n){!function(t){var n=rt(t).search);L(!(it in n),"Source origin is not allowed in %s",t)}(n);var i=function(t){return rt(t)).origin}(t.location.href);return ot(n,it,i)}(e,r)),r),n.fetchOpt=t.win,n.xhrUrl,n.fetchOpt),n.fetchOpt);var o={"ampAutocompleteAttributes":{"items":i,"maxItems":t.cQ}};return t.getSsrTemplateHelper().ssr(t.element,n,null,o)})):n,this.element,{expr:i,urlReplacement:2}).catch((function(){return z().warn(bt,'Expected key "%s" in data but found nothing. Rendering empty results.',i),[]}))},u.kQ=function(){if(this.pQ){var t=this._Q(this.sQ);this.element.setAttribute("src",t)}},u._Q=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return ot(this.lQ,this.pQ,t)},u.hH=function(){var t=this.element.ownerDocument.createElement("div");return t.classList.add("i-amphtml-autocomplete-results"),this.PQ()&&t.classList.add("i-amphtml-autocomplete-results-up"),t.setAttribute("role","listbox"),t.setAttribute("id",this.wQ),_(t,!1),t},u.layoutCallback=function(){return this.oQ.setAttribute("autocomplete","off"),this.element.hasAttribute("prefetch")&&this.EQ(),this.CQ(this.uQ,this.sQ)},u.mutatedAttributesCallback=function(t){var n=this,i=t.src;return null==i?l():"string"==typeof i?(this.lQ=i,this.IQ().then((function(t){n.uQ=t||[],n.CQ(n.uQ,n.sQ)}),(function(t){n.MQ(t)}))):"object"===m(i)?(this.uQ=i.items||[],this.CQ(this.uQ,this.sQ)):void z().error(bt,'Unexpected "src" type: '+i)},u.zQ=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=this.element.ownerDocument.createElement("div");i.classList.add("i-amphtml-autocomplete-item"),i.setAttribute("role","option"),i.setAttribute("data-value",t),i.setAttribute("dir","auto"),i.textContent=t;var e=i.childNodes[0],r=t.toLocaleLowerCase(),u=n.toLocaleLowerCase();if(this.fQ&&n&&n.length<=t.length&&g(r,u)){var o=r.indexOf(u),s=this.element.ownerDocument.createElement("span");s.classList.add("autocomplete-partial"),s.appendChild(this.element.ownerDocument.createTextNode(t.slice(o,o+n.length)));var a=e.splitText(o);a.splitText(n.length),i.replaceChild(s,a)}return i},u.SQ=function(){var t=this;return this.Du.shouldAutocomplete(this.oQ)?this.qQ():this.mutateElement(()},u.qQ=function(){var t=this,n=0===this.sQ.length&&1===this.oQ.value.length;return this.sQ=this.Du.getUserInputForUpdate(this.oQ),(this.yQ||this.pQ?this.IQ():Promise.resolve(this.uQ)).then((function(i){return t.uQ=i,t.mutateElement((function(){t.CQ(t.uQ,t.sQ).then(()}))}))},u.LQ=function(t){this.JQ(!0),this.eQ&&(this.hQ&&!t||this.BQ(1),this.hQ=!1)},u.AQ=function(t){var n=this,i=t.target,e=this.$Q(i),r=this.DQ(e),u=r.selectedObject,o=r.selectedText;return this.mutateElement((function(){n.FQ(o,u)}))},u.CQ=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.NQ(),!t||n.length<this.aQ?l():this.yQ?S(t,"html")?this.GQ(t,this.pg,n):l():this.HQ(t,n)},u.HQ=function(t,n){if(!t.length)return l();var i=this.KQ(t,n).map((function(t){var n=t;return"object"===m(t)&&(n=v(v({},t),{},{objToJson:)),n}));return this.GQ(i,this.pg,n)},u.GQ=function(t,n,i){var e=this,r=l();return this.QQ(),this.bQ?r=this.getSsrTemplateHelper().applySsrOrCsrTemplate(this.element,t).then((function(t){(w(t)?t:[t]).forEach((function(t){t.hasAttribute("data-disabled")?t.setAttribute("aria-disabled","true"):t.hasAttribute("data-value")||z().warn(bt,'Expected a "data-value" or "data-disabled" attribute on the rendered template item. %s',t),t.classList.add("i-amphtml-autocomplete-item"),t.setAttribute("role","option"),n.appendChild(t)}))})):t.forEach((function(t){L("string"==typeof t,"%s data must provide template for non-string items. %s",bt,e.element),n.appendChild(e.zQ(t,i))})),r},u.KQ=function(t,n){var i=this;if(this.ZN===yt)return this.VQ(t);n=n.toLocaleLowerCase();var e=this.element.getAttribute("filter-value")||"value",r=t.filter((function(t){switch("object"===m(t)&&(t=U(t,e)),L("string"==typeof t,'%s data property "%s" must map to string type. %s',bt,e,i.element),t=t.toLocaleLowerCase(),i.ZN){case"substring":return g(t,n);case"prefix":return t.startsWith(n);case"token-prefix":return i.WQ(t,n);case"fuzzy":return(0,lt.default)(n,t);case"custom":throw new Error("Filter not yet supported: %s",i.ZN,i.element);default:throw new Error("Unexpected filter: %s",i.ZN,i.element)}}));return this.VQ(r)},u.WQ=function(t,n){if(""===n)return!0;var i=this.XQ(t),e=this.XQ(n),r=this.YQ(i),u=e[e.length-1];e.splice(e.length-1,1);for(var o=!0,s=0;s<e.length;s++){var a=e[s];if(""!==a){if(!S(r,a)){o=!1;break}var c=Number(T(r,a));c>1?r[a]=c-1:delete r[a]}}var h=Object.keys(r);return o&&(""===u||h.some(())},u.XQ=u.YQ=function(t){var n=E();return t.forEach((function(t){var i=S(n,t)?T(n,t)+1:1;n[t]=i})),n},u.VQ=function(t){return this.cQ&&this.cQ<t.length&&(t=t.slice(0,this.cQ)),t},u.JQ=function(t){this.oQ.setAttribute("aria-expanded",t),_(this.pg,t)},u.UQ=function(t){var n=this,i=this.RQ();i&&(t?i.setAttribute("autocomplete","off"):this.mQ?i.setAttribute("autocomplete",this.mQ):i.removeAttribute("autocomplete"));var e=!1;return this.measureMutateElement((,(function(){t||(n.sQ=n.oQ.value,n.CQ(n.uQ,n.sQ),n.QQ()),n.ZQ(e),n.JQ(t)}))},u.EQ=function(){var t=this;return this.xQ||!this.element.hasAttribute("src")?l():(this.xQ=!0,this.IQ().then((,())},u.ZQ=u.PQ=function(){var t=this.Ph.getHeight()||0;return this.oQ.getBoundingClientRect().top>t/2},u.t0=function(){return!this.pg.hasAttribute("hidden")&&this.pg.children.length>0},u.$Q=function(t){return null===t?null:t.classList.contains("i-amphtml-autocomplete-item")?t:this.$Q(t.parentElement)},u.DQ=function(t){if(null===t||t.hasAttribute("data-disabled"))return{selectedObject:null,selectedText:null};var n=this.n0(t);return this.i0(n),{selectedObject:this.e0(t),selectedText:n}},u.i0=function(t){this.oQ.value=this.Du.getUserInputForUpdateWithSelection(t,this.oQ,this.sQ),this.sQ=this.Du.getUserInputForUpdate(this.oQ)},u.n0=function(t){return t.getAttribute("data-value")||t.textContent||""},u.e0=function(t){return t.hasAttribute("data-json")?I(t.getAttribute("data-json"),():null},u.FQ=function(t,n){null!==t&&(this.r0(t,n),this.NQ(),this.JQ(!1))},u.r0=function(t,n){var i="select",e=v({value:t},n&&{valueAsObject:n}),r=V(this.win,"amp-autocomplete.".concat(i),e);this.Yo.trigger(this.element,i,r,3);var u=V(this.win,"change",e,{bubbles:!0});this.oQ.dispatchEvent(u)},u.BQ=function(t){var n=this;if(0===t||!this.t0()||this.DG)return l();var i=-1===this.dQ&&t<0?t:this.dQ+t,e=this.u0();if(0===e.length)return l();var r,u,o,s,a=(r=i,u=e.length,r>0&&u>0?r%u:(r%u+u)%u),c=e[a],h=c.getAttribute("data-value");return this.Du.displayActiveItemInInput(this.oQ,h,this.sQ),this.measureMutateElement((function(){var i=c.offsetHeight,e=c.offsetTop,r=n.pg,u=r.offsetHeight,a=r.scrollTop;o=a>e||a+u<e+i,s=t>0?e+i-u:e}),(function(){o&&(n.pg.scrollTop=s),n.QQ(),c.classList.add("i-amphtml-autocomplete-item-active"),c.setAttribute("aria-selected","true");var t=c.getAttribute("id");t||(t=n.mB+"_AMP_content_"+a,c.setAttribute("id",t)),n.oQ.setAttribute("aria-activedescendant",t),n.dQ=a,n.vQ=c,k(n.vQ)}))},u.u0=u.o0=u.QQ=function(){this.vQ&&(this.vQ.classList.toggle("i-amphtml-autocomplete-item-active",!1),this.vQ.removeAttribute("aria-selected"),"autocomplete-selected"===this.vQ.getAttribute("id")&&this.vQ.removeAttribute("id"),this.oQ.removeAttribute("aria-activedescendent"),this.vQ=null,this.dQ=-1)},u.NQ=function(){this.DG=!1,this.pg)},u.TQ=function(t){var n=this;switch(t.key){case"ArrowDown":return t.preventDefault(),this.t0()?this.dQ===this.u0().length-1?(this.o0(),l()):this.BQ(1):this.mutateElement((function(){n.CQ(n.uQ,n.sQ),n.JQ(!0)}));case"ArrowUp":return t.preventDefault(),0===this.dQ?(this.o0(),l()):this.BQ(-1);case"Enter":var i=this.Du.shouldPreventDefaultOnEnter(!!this.vQ);if(this.t0()&&i&&t.preventDefault(),this.Du.removeSelectionHighlighting(this.oQ),this.t0()&&this.vQ){var e=this.DQ(this.vQ),r=e.selectedObject,u=e.selectedText;return this.mutateElement(()}return this.mutateElement(();case"Escape":return this.mutateElement((function(){n.DG||(t.preventDefault(),n.o0(),n.JQ(!1))}));case"Tab":if(this.t0()&&this.vQ){t.preventDefault();var o=this.DQ(this.vQ),s=o.selectedObject,a=o.selectedText;return this.mutateElement(()}return l();case"Backspace":return this.hQ=this.eQ,l();default:return l()}},u.MQ=function(t){if(!this.DG){if(this.NQ(),!this.getFallback())throw t;this.DG=!0,this.toggleFallback(!0)}},u.isLayoutSupported=r}(t.BaseElement);t.registerElement(bt,xt,"amp-autocomplete,amp-autocomplete>input,amp-autocomplete>textarea{font-family:sans-serif}amp-autocomplete>input,amp-autocomplete>textarea{border-radius:4px;box-sizing:border-box}.i-amphtml-autocomplete-results{position:absolute;top:100%;width:calc(100% + 1rem);min-width:calc(2em + 2rem);max-height:40vh;margin-top:.5rem;margin-left:-.5rem;border-radius:4px;overflow-y:auto;overflow-x:hidden;background-color:#fff;box-shadow:0px 2px 4px 0px rgba(0,0,0,.5);z-index:10}.i-amphtml-autocomplete-results-up{top:auto;bottom:100%;margin-bottom:.5rem}.i-amphtml-autocomplete-item{position:relative;padding:.5rem 1rem;cursor:pointer}.i-amphtml-autocomplete-item:first-child{border-radius:4px 4px 0px 0px}.i-amphtml-autocomplete-item:nth-last-child(2){border-radius:0px 0px 4px 4px}.i-amphtml-autocomplete-item-active:not([data-disabled]),.i-amphtml-autocomplete-item:hover:not([data-disabled]){background-color:rgba(0,0,0,.15)}.i-amphtml-autocomplete-item[data-disabled]{color:rgba(0,0,0,.33)}\n/*# sourceURL=/extensions/amp-autocomplete/0.1/amp-autocomplete.css*/")}();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-autocomplete-0.1.js.map