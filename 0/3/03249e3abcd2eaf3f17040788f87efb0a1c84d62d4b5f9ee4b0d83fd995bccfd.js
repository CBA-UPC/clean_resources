(window.webpackJsonp=window.webpackJsonp||[]).push([[85],{1267:function(e,t,s){"use strict";s.r(t);var i=s(5),a=s(1103),r=s(821),o=s(509),n=s(872),l=s(589),c=s(564),u=s(87),d=s(155),h=s(17),m=s(811),p=s(830),k=s(845),v=s(846),b=s(1117),f={components:{BaseButton:s(507).a,FormRow:o.o,ThreadDuplicates:r.a,FormMessageList:o.m,ControlLoader:n.a,FormInputLabeled:o.i,FormInputIcon:o.h,ControlLinkErrors:m.a,CheckVoucherCodeDuplicates:p.a,CheckBlockedLinks:k.a,GetLinkMerchantSuggestion:v.a,EventTrigger:b.a},mixins:[l.b],data:()=>Object.assign({},Object(u.d)({thread:{namespace:"threadForm",path:"thread",deep:!0}}),{submitLink:"",submitCode:"",hasErrors:!1,hasDuplicates:!1}),computed:{canSubmitvoucherType:()=>h.o,inlineLinkErrorsMessages(){return this.$v?this.$v.messages.link.filter(():[]},duplicatesFilter:,validations:()=>({link:[Object(c.n)(!0)],voucherCode:[Object(c.o)("voucherCode")]}),watch:{"thread.link"(){this.resetData()},"thread.voucherCode"(){this.resetData()}},methods:{resetLink(){this.thread.link="",this.thread.voucherCode="",this.resetData(),this.validateLink()},resetCoderesetData(){this.hasErrors=!1,this.hasDuplicates=!1,this.submitLink="",this.submitCode="",this.$v.clear("link")},async validateLink(){await this.$v.validate("link",this.thread.link)},async submit(){const{link:e,voucherCode:t}=this.thread;this.resetData(),await this.validateLink(),!this.$v.error.link&&e&&(this.submitLink=e,this.submitCode=t)},showFullFormsubmitVoucher(){Object(d.b)({type:"submit",target:this.$el}),this.showFullForm()},submitWithoutLink(){this.thread.link="",this.thread.voucherCode="",this.thread.merchant={},this.showFullForm()},continueWithCodesetLinkErrors(e){let{hasErrors:t}=e;this.hasErrors=t},setDuplicates},C=s(45),g=Object(C.a)(f,(function(){var e=this,t=e._self._c;return t("section",{directives:[{name:"track",rawName:"v-track:linkForm.view",value:{type:e.voucherType},expression:"{ type: voucherType }",arg:"linkForm",modifiers:{view:!0}}],staticClass:"flex flex--dir-col flex--grow-1 space--fromW2-h-4 space--h-3 space--t-3 space--b-2"},[t("div",{staticClass:"flex--grow-1 space--mb-3"},[t("h1",{staticClass:"size--all-xxxl size--fromW2-xxl text--b text--color-charcoalTint space--t-3"},[e._v(" "+e._s("Comparte una cupón con millones de personas")+" ")]),t("p",{staticClass:"size--all-l text--color-greyShade space--mt-3 space--fromW2-mt-1 space--mb-3"},[e._v(" "+e._s("Introduce el código y el enlace donde otras personas pueden canjear tu cupón")+" ")]),t("form",{staticClass:"width--all-12",on:{subm)}}},[t("div",{staticClass:"flex boxAlign-ai--all-c"},[t("div",{staticClass:"flex--grow-1"},[t("ol",{staticClass:"flex flex--dir-col flex--fromW2-dir-row"},[t("FormRow",{staticClass:"space--fromW2-r-2 flex--grow-1 width--fromW2-10",attrs:{error:e.$v.error.link}},[t("FormInputLabeled",{attrs:{id:"link",name:"link",placeholder:"https://www.site.com/supercupon",inputmode:"url"},on:{input:e.resetData,change:e.validateLink},scopedSlots:e._u([{key:"prependIcon",fn:function(){return[t("FormInputIcon",{attrs:{name:"link"}})]},proxy:!0}]),model:{value:e.thread.link,callba)},expression:"thread.link"}}),t("FormMessageList",{staticClass:"hide--fromW2",attrs:{messages:e.$v.messages.link}})],1),t("FormRow",{attrs:{error:e.$v.error.voucherCode}},[t("FormInputLabeled",{staticClass:"space--t-2 space--fromW2-t-0",attrs:{id:"voucherCode",name:"voucherCode",placeholder:"Código de cupón"},on:{input:e.resetData},scopedSlots:e._u([{key:"prependIcon})]},proxy:!0}]),model:{value:e.thread.voucherCode,call,t)},expression:"thread.voucherCode"}}),t("FormMessageList",{attrs:{messages:e.$v.messages.voucherCode}})],1)],1)]),e.canSubmit?t("div",{staticClass:"space--l-2 hide--toW2"},[t("BaseButton",{staticClass:"width--all-12",attrs:{type:"submit",variant:"primary",mode:"brand",disabled:!e.thread.link}},[e._v(" "+e._s("¡Empecemos!")+" ")])],1):e._e()]),e.submitLink?t("CheckBlockedLinks",{attrs:{link:e.submitLink},on:{request:e.setLinkErrors},scopedSlots:e._u([{key:"default",fn:function({isLoading:s,hasErrors:i,errors:a}){return[i?t("ControlLinkErrors",{attrs:{"error-messages":a},on:{cancel:e.resetLink}}):t("CheckVoucherCodeDuplicates",{attrs:{link:e.submitLink,code:e.submitCode,"thread-id":e.thread.threadId,filter:e.duplicatesFilter},on:{request:e.setDuplicates},scopedSlots:e._u([{key:"default",fn:function({isLoading:a,hasDuplicates:r,duplicates:o}){return[t("div",[t("GetLinkMerchantSuggestion",{attrs:{link:e.submitLink,"keep-alive":!s}}),s||a?t("ControlLoader",[e._v(" "+e._s("Checando poisbles duplicados")+" ")]):r?t("ThreadDuplicates",{attrs:{type:e.voucherType,threads:o},on:{cancel:e.resetCode,continue:e.continueWithCode}}):e._e(),t("EventTrigger",{attrs:{"is-loading":s||a,"has-errors":i||r},on:{trigger:e.submitVoucher}})],1)]}}],null,!0)})]}}],null,!1,1511078266)}):e._e(),t("FormMessageList",{staticClass:"hide--toW2",attrs:{messages:e.$v.messages.link}}),e.canSubmit?t("div",{staticClass:"hide--fromW2 space--mt-3"},[t("BaseButton",{directives:[{name:"track",rawName:"v-track:submitWithLink.click",arg:"submitWithLink",modifiers:{click:!0}}],staticClass:"width--all-12 space--mb-3",attrs:{variant:"primary",mode:"brand",type:"submit",disabled:!e.thread.link}},[e._v(" "+e._s("¡Empecemos!")+" ")])],1):e._e()],1)]),e.canSubmit?t("div",{staticClass:"hAlign--all-c"},[t("BaseButton",{directives:[{name:"track",rawName:"v-track:submitWithoutLink.click",arg:"submitWithoutLink",modifiers:{click:!0}}],attrs:{variant:"tertiary",mode:"default"},on:{click:e.submitWithoutLink}},[e._v(" "+e._s("No se necesita link")+" ")])],1):e._e()])}),[],!1,null,null,null),L=g.exports,_=Object(i.defineComponent)({__name:"voucher-submission-wizard",setup:e=>({__sfc:!0,ThreadSubmissionWizardContent:a.a,VoucherSubmissionLinkForm:L,VOUCHER_TYPE:h.o})}),w=Object(C.a)(_,(function(){var e=this,t=e._self._c,s=e._self._setupProxy;return t(s.ThreadSubmissionWizardContent,{attrs:{"thread-type":s.VOUCHER_TYPE}},[t(s.VoucherSubmissionLinkForm,{staticClass:"flex--grow-1",on:{"show-fullorm")}}})],1)}),[],!1,null,null,null);t.default=w.exports},830:function(e,t,s){"use strict";var i=s(5),a=s(544),r=s(616),o=s(715);const n=()=>{let e=null;const t=Object(i.ref)([]),{isLoading:s,setLoader:n}=Object(a.a)(),l=()=>{t.value=[],s.value&&Object(o.a)(e)};return{duplicates:t,checkDuplicates:(s,i,a)=>{i&&(l(),(s=>{let{link:i,code:a,filter:o}=s;e=Object(r.b)(i,a,o),e.requestue=e)})).finally(n())})({link:s,code:i,filter:a}))},resetDuplicates:l,isLoading:s}};var l=Object(i.defineComponent)({__name:"check-voucher-code-duplicates",props:{link:null,code:null,filter:null},setup(e){const t=e,{duplicates:s,isLoading:a,checkDuplicates:r,resetDuplicates:o}=n(),l=Object(i.complength));return Object(i.wt.code),(()=>{t.code?r(t.link,t.code,t.filter):o()}),{immediate:!0}),Object(i.onBeforeUnm>{o()})),{__sfc:!0,props:t,duplicates:s,isLoading:a,checkDuplicates:r,resetDuplicates:o,hasDuplicates:l}}}),c=s(45),u=Object(c.a)(l,(function(){var e=this,t=e._self._c,s=e._self._setupProxy;return t("div",[e._t("default",null,{isLoading:s.isLoading,duplicates:s.duplicates,hasDuplicates:s.hasDuplicates,reset:s.resetDuplicates})],2)}),[],!1,null,null,null);t.a=u.exports}}]);