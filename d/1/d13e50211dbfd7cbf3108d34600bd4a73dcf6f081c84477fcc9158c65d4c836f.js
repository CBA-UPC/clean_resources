var RMS=function(){var e,t,n=location.protocol+"//cdid.c-ctrip.com/model-poc2/h",o=!1;location.hostname.indexOf(".trip.com")>0&&(n="https://riskpoc.trip.com/h");var r=location.protocol+"//"+location.host;function i(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].join("_"));return t.join("-")}function a(e,t){for(var n=[],o=0;o<e.length;o++){n[o]=[];for(var r=0;r<t;r++)n[o][r]=0}return n}var d=[["J_mobile","p_name_0","mobilephone","nloginname","givenName_0"],["pickupEmail","I_contact_phone","txtContactEMail","npwd","contactPhoneNum"],["p_card_no_0","card_number_1","card_number_2","card_number_3","card_number_4","card_number","cardNum_0_0"]],s=[["J_resident_1"],["J_resident_2"],["txtContactMobilePhone","J_mobile"]],c=[0,0,0],u=a(d,10),h=a(s,3),p=function(e){var t=e.target||e.srcElement;if(e.keyCode||e.ctrlKey||e.altKey||e.shiftKey||e.metaKey){for(var n=-1,o=0;o<s.length;o++)for(var r=0;r<s[o].length;r++)if(s[o][r]==t.id){n=o;break}if(-1!=n)try{e.ctrlKey&&67==e.keyCode&&(h[n][0]=1),e.ctrlKey&&86==e.keyCode&&(h[n][1]=1),e.ctrlKey&&88==e.keyCode&&(h[n][2]=1)}catch(e){console.log(e)}n=-1;for(o=0;o<d.length;o++)for(r=0;r<d[o].length;r++)if(d[o][r]==t.id){n=o;break}if(-1!=n)try{var i=!1;(e.metaKey||e.ctrlKey)&&67==e.keyCode&&(u[n][0]=1,i=!0),(e.metaKey||e.ctrlKey)&&86==e.keyCode&&(u[n][1]=1,i=!0),(e.metaKey||e.ctrlKey)&&88==e.keyCode&&(u[n][2]=1,i=!0),8==e.keyCode&&"keydown"==e.type&&(u[n][3]+=1,i=!0),0==c[n]?c[n]=1*new Date:u[n][4]=1*new Date-c[n],e.altKey&&"keydown"==e.type&&(u[n][6]=1,i=!0),e.shiftKey&&"keydown"==e.type&&(u[n][7]+=1,i=!0),e.shiftKey&&e.ctrlKey&&"keydown"==e.type&&(u[n][8]+=1,i=!0),e.ctrlKey&&32==e.keyCode&&(u[n][9]+=1,i=!0),i?u[n][5]+=1:"keydown"==e.type&&(u[n][5]+=1)}catch(e){console.log(e)}}},f=[0,0,0,0,0,0,0,0,0,0],y=0,l=function(e){try{if("input"!=e.target.tagName.toLowerCase())return;var t=!1;(e.metaKey||e.ctrlKey)&&67==e.keyCode&&(f[0]+=1,t=!0),(e.metaKey||e.ctrlKey)&&86==e.keyCode&&(f[1]+=1,t=!0),(e.metaKey||e.ctrlKey)&&88==e.keyCode&&(f[2]+=1,t=!0),8==e.keyCode&&"keydown"==e.type&&(f[3]+=1,t=!0),0==y?y=1*new Date:f[4]=1*new Date-y,e.altKey&&"keydown"==e.type&&(f[6]+=1,t=!0),e.shiftKey&&"keydown"==e.type&&(f[7]+=1,t=!0),e.shiftKey&&e.ctrlKey&&"keydown"==e.type&&(f[8]+=1,t=!0),e.ctrlKey&&32==e.keyCode&&(f[9]+=1,t=!0),t?f[5]+=1:"keydown"==e.type&&(f[5]+=1)}catch(e){}},m=!1,_=function(e){try{(e.metaKey||e.ctrlKey)&&e.shiftKey&&46==e.keyCode&&(m=!0)}catch(e){}};document.addEventListener?(document.addEventListener("keydown",p,!1),document.addEventListener("keyup",p,!1)):(document.attachEvent("onkeydown",p),document.attachEvent("onkeyup",p)),document.addEventListener?(document.addEventListener("keydown",l,!1),document.addEventListener("keyup",l,!1)):(document.attachEvent("onkeydown",l),document.attachEvent("onkeyup",l)),document.addEventListener?document.addEventListener("keydown",_,!1):document.attachEvent("onkeydown",_);var w=function(){var e,t=window,n=(t.XMLHttpRequest&&"withCredentials"in new t.XMLHttpRequest?e=t.XMLHttpRequest:t.XDomainRequest&&(e=t.XDomainRequest),e),o=["head","get","post","put","delete"],r={};.prototype.init=function(e){this.xhr=new n,this.method=e.method,this.url=e.url,this.success=e.success,this.error=e.error;try{this.xhr.timeout=2e3,this.xhr.ontimeout=!0===e.credentials&&(this.xhr.withCredentials=!0)}catch(o){}var t=e.params?e.params:e.data;return this.headers=e.headers,this.send(t),this},i.prototype.send=function(e){var t=this;return t.success!==undefined&&(t.xhr.onload=function(){t.success.call(this,this.responseText)}),t.error!==undefined&&(t.xhr.error=,t.xhr.open(t.method,t.url,!0),t.headers!==undefined&&t.setHeaders(),e?t.xhr.send(e):t.xhr.send(),t},i.prototype.setHeaders=function(){var e,t=this.headers;try{for(e in t)t.hasOwnProperty(e)&&this.xhr.setRequestHeader(e,t[e])}catch(n){}return this};for(var a=0;a<o.length;a++)!function(){var e=o[a];r[e]=function(t,n){var o={};if(t===undefined)throw new Error("CORS: url must be defined");return"object"==typeof t?o=t:("function"==typeof n&&(o.success=n),o.url=t),o.method=e.toUpperCase(),new i(o).xhr}}();return r}(),g=function(e,t,n){var o=document.createElement("input");return o.type="hidden",o.name=t,o.value=n,o.id=t+"_d__",e.appendChild(o),o},v=function(n,i,a,d){if(o)return setTimeout(30);if(o=!0,"XMLHttpRequest"in window&&"withCredentials"in new XMLHttpRequest){var s=i+"="+a+"&serverName="+r;w.post({url:n,credentials:!0,params:s,method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},success:function(e){o=!1,e?d&&d(e,!0):d&&d(e,!1)},error:function(){o=!1,d&&d(data,!1)}})}else{if(createIframe(),e.action=n,t.name=i,t.value=a,guid){var c=document.getElementById("guid_d__");c?c.value=guid:g(e,"guid",guid)}e.submit()}},a=!1;return{init:function(e){if(!a){a=!0,e=e||{};var t=this;if(window.__bfi=window.__bfi||[],window.__bfi.push(["_getFP",!1]),window.__bfi.push(["_getStatus",!1]),window.__bfi.push(["_getPageid",function(n,o){!n&&o&&(e.pageId||(e.pageId=o+"")),t.pageId=o}]),window&&window.location){setTimeout(function(){var e=document.createElement("script");e.type="text/javascript",e.id="rmsd__script",e.async=!0,e.src=("https:"==document.location.protocol?"https:":"http:")+"//webresource.tripcdn.com/resaresenglish/risk/ubtrms/d.min.ad882159.js",e.crossOrigin="anonymous";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)},10),window.rmsd__startScriptLoad=1*new Date}!function(){var e=window.__rmsbfi||[],t=e.push=function(){for(var e=arguments,t=e.length,n=0;n<t;n++)try{if(window.__bfi.push(["_devTrace","215858",{type:"_push-first0",msg:"typeof args="+typeof e[n]}]),"function"==typeof e[n])window.__bfi.push(["_devTrace","215858",{type:"_push-first1"}]),e[n]();else if("[object Array]"===Object.prototype.toString.call(e[n])){if(window.__bfi.push(["_devTrace","215858",{type:"_push-first2",msg:"args[i].length="+e[n].length}]),2!=e[n].length)continue;var o=e[n][0],r=e[n][1];const t="_push-first3,typeof callback="+typeof r+";typeof func="+typeof o+";func="+o;window.__bfi.push(["_devTrace","215858",{type:"_push-first3",msg:t}]),"string"==typeof o&&"_getRmsToken"===o&&"function"==typeof r&&(window.__bfi.push(["_devTrace","215858",{type:"_push-first4"}]),r(RMS.getRmsToken()))}}catch(i){window.__bfi.push(["_devTrace","215858",{type:"_push-error",msg:i.message}])}return 0};for(window.__bfi.push(["_devTrace","215858",{type:"__rmsbfi-length",rmsbfi:"length="+e.length}]),window.__rmsbfi=e;e.length>0;)t(e.shift())}()}},getRmsToken:function(){var e,t,n="";try{window.__bfi.push(["_devTrace","215858",{vid:this.vid,msg:"firstdata"}]);var o=navigator.userAgent.length>300?navigator.userAgent.substring(0,300):navigator.userAgent;n="fp="+(this.fp?this.fp:""),n+="&vid="+(this.vid?this.vid:""),n+="&pageId="+(this.pageId?this.pageId:"");var r=/\_RGUID=([a-z0-9\-]+)(;|$)/.exec(document.cookie),a=/guid\_\_=([a-z0-9\-]+)(;|$)/.exec(document.cookie);if(r&&r.length>1)n+="&r="+r[1].replace(/\-/g,"");else if(a&&a.length>1){n+="&r="+a[1].replace(/\-/g,"")}else n+="&r="+window.CHLOROFP_STATUS;var d=window.CHLOROFP_IP;if(!d){var s=/\_RF1=([0-9\.]+)(;|$)/.exec(document.cookie);s&&s.length>1&&(d=s[1])}isNaN(Number(d))||(e=Number(d),(t=new Array)[0]=e>>>24>>>0,t[1]=e<<8>>>24>>>0,t[2]=e<<16>>>24,t[3]=e<<24>>>24,d=String(t[0])+"."+String(t[1])+"."+String(t[2])+"."+String(t[3])),d&&(d=d.replace(/^\s+|\s+$/g,"")),n+="&ip="+d,n+="&rg="+window.RG_STA,n+="&kpData="+i([h[2]]),n+="&kpControl="+i([h[0],h[1]]),n+="&kpEmp="+i(u),n+="&screen="+screen.width+"x"+screen.height;var c=(new Date).getTimezoneOffset()/60;n+="&tz="+(c<0?"+":"-")+Math.abs(c),n+="&blang="+navigator.language||navigator.userLanguage,n+="&oslang="+navigator.language||navigator.systemLanguage,n+="&ua="+encodeURIComponent(o);var p=/^https?:\/\/([a-zA-Z0-9.\-_]+)\/?/.exec(window.location);if(p&&p.length>1){var y=p[1];n+="&d="+encodeURIComponent(y)}return n+="&v=25",this.uuid&&(n+="&rmsId="+this.uuid),n+="&kpg="+f.join("_"),n+="&adblock="+function(){var e=document.createElement("div");e.style.cssText="width:1px; height: 1px; position:absolute; top: -1000px; left: -1000px;",e.innerHTML="&nbsp;",e.className="adsbox";var t="F";try{document.body.appendChild(e),0===document.getElementsByClassName("adsbox")[0].offsetHeight&&(t="T"),document.body.removeChild(e)}catch(n){t="F"}return t}(),n+="&cck="+function(){if(m)return"T";var e="F";try{window.cookieStatusInD&&(e="T")}catch(t){}return e}(),window.__bfi.push(["_devTrace","215858",{vid:this.vid,rmstoken:n}]),n}catch(l){return window.__bfi.push(["_devTrace","243111",{type:"getRmsTokenErr",msg:l.message}]),n}},ping:function(e){if(window&&window.location&&"WebSocket"in window){if(!e){var t=/\_RGUID=([a-z0-9\-]+)(;|$)/.exec(document.cookie),o=/guid\_\_=([a-z0-9\-]+)(;|$)/.exec(document.cookie);t&&t.length>1?e=t[1].replace(/\-/g,""):o&&o.length>1&&(e=o[1].replace(/\-/g,""))}e&&(e=e+"_"+(r=1,i=100,Math.floor(Math.random()*(i-r+1))+r),window.RG_STA="b4",v(n,"requestId",e,function(e,t){t?(window.CHLOROFP_IP=window.CHLOROFP_IP||e,window.RG_STA="fin"):window.RG_STA="err"}))}var r,i}}}();RMS.init(),RMS.ping();