(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2113],{3378:function(e,t,s){Promise.resolve().then(s.bind(s,39795)),Promise.resolve().then(s.bind(s,80332)),Promise.resolve().then(s.t.bind(s,19167,23))},39795:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return microsoft_teams_microsoft_teams}});var o=s(57437),a=s(2265),n=s(27587),r=s(20446),l=s.n(r),c=s(67768),i=s(19809),m=s(84727),d=s(30358),u=s(99843),h=s(80332),p=s(75474),f=s(53714),b=s(6613),x=s(98954),g=s(24033),microsoft_teams_form=()=>{let{language:e,site:t,headers:s,url:n}=(0,a.useContext)(h.CustomContext),r=(0,x.Z)(e),k=(0,f.Z)(t.brandColor),[C,j]=(0,a.useState)(""),[w,v]=(0,a.useState)(t.components.map(e=>e.id)),[N,y]=(0,a.useState)(!0),[_,S]=(0,a.useState)(!1),[T,Z]=(0,a.useState)(""),[E,M]=(0,a.useState)(!1),{theme:B}=(0,i.useSiteTheme)(),U=(0,g.useRouter)(),A=(0,p.Z)(null==t?void 0:t.htmlBelowSubscribeTranslation,e,null==t?void 0:t.htmlBelowSubscribe),G=(0,b.Z)(),handleSubmit=async t=>{t.preventDefault(),M(!0);try{let t=await G();await (0,u.Ld)({url:n,microsoftTeamsWebhook:C,all:N,components:w,language:e.languageCode,headers:{"Content-Type":"application/json"},hcaptchaToken:t}),U.push("/subscribe/microsoft-teams/done")}catch(t){M(!1),S(!0);let e=t.graphQLErrors.map(e=>e.message);return Z(e),!1}},handleAllChange=(e,s)=>{s?(y(!0),v(t.components.map()):(y(!1),v([]))};return(0,o.jsxs)("div",{className:"max-w-xl mx-auto mt-8 relative z-10 dark:border-gray-900 border-gray-100 md:border bg-white md:shadow-md md:p-12 subscribe-by-webhook-page md:rounded-xl dark:bg-gray-980 md:dark:bg-gray-950 ".concat(l()({"md:-mt-32":"stormtrooper"===t.skin||"panda"===t.skin})),children:[(0,o.jsxs)("div",{className:"flex flex-col items-center justify-center text-black dark:text-white",children:[(0,o.jsx)(d.Z,{className:"text-gray-900 fill-current w-14 h-14 md:w-16 md:h-16 dark:text-gray-300"}),(0,o.jsx)("h3",{className:"mt-3 text-3xl font-bold text-center md:text-4xl",children:r("getUpdatesMicrosoftTeamsShort")})]}),(0,o.jsxs)("form",{className:"flex flex-col items-start justify-start max-w-lg mx-auto mt-10 text-sm microsoft-teams-subscribe-form",onSubmit:handleSubmit,children:[_&&(0,o.jsx)("div",{children:T}),(0,o.jsxs)("div",{className:"w-full",children:[(0,o.jsx)("span",{className:"form-label",children:r("webhookUrl")}),(0,o.jsx)("input",{autoComplete:"off",name:"webhook",value:C,className:"w-full form-input email-subscribe-form__input ".concat(l()({"form-input-brand":"dark"===k&&"dark"!==B,"form-input-black":"light"===k})),placeholder:"https://company.webhooks.microsoft.com/...",onChange:e=>{let{value:t}=e.target;j(t),S(!1)}})]}),(0,o.jsx)("p",{className:"mt-1 text-sm text-gray-700 dark:text-gray-500",children:(0,o.jsx)("a",{target:"_blank",rel:"noopener noreferrer",href:"https://docs.microsoft.com/microsoftteams/platform/webhooks-and-connectors/how-to/add-incoming-webhook#add-an-incoming-webhook-to-a-teams-channel",className:"font-medium focus:outline-none underline ".concat(l()({"text-brand":"dark"===k&&"light"===B,"text-black":"light"===k})),children:r("learnMicrosoftTeamsWebhook")})}),(0,o.jsxs)("div",{className:"block my-6 text-black dark:text-white",children:[(0,o.jsxs)("label",{htmlFor:"all",className:"flex items-center my-2",children:[(0,o.jsx)("input",{type:"radio",id:"all",className:"w-5 h-5 form-radio focus:outline-none ".concat(l()({"form-radio-brand":"dark"===k,"form-radio-black":"light"===k})),name:"components",value:"all",checked:N,onChange:e=>handleAllChange(e,!0)}),(0,o.jsx)("span",{className:"ml-2 cursor-pointer",children:r("toAllComponents")})]}),(0,o.jsxs)("label",{htmlFor:"some",className:"inline-flex items-center my-2",children:[(0,o.jsx)("input",{type:"radio",id:"some",className:"block w-5 h-5 form-radio ".concat(l()({"form-radio-brand":"dark"===k,"form-radio-black":"light"===k})),name:"components",value:"some",checked:!N,onChange:),(0,o.jsx)("span",{className:"ml-2 cursor-pointer",children:r("toCertainComponents")})]}),(0,o.jsx)("div",{className:l()({hidden:N,"flex flex-col":!N}),children:(0,o.jsx)(m.Z,{selectedComponents:w,components:t.components,handleChange:e=>{let{id:t,checked:s}=e.target;s&&!w.includes(t)?v([...w,t]):!s&&w.includes(t)&&v(w.filter()}})})]}),(0,o.jsx)("button",{type:"submit","aria-label":"Subscribe",className:"webhookemail-subscribe-form__submit text-white p-4 w-full mt-4 font-medium rounded-lg focus:outline-none ".concat(l()({"bg-black":"light"===k,"bg-brand":"dark"===k})),children:r(E?"working":"subscribe")}),(0,o.jsx)(c.Z,{className:"pt-10 custom-html-subscribe-page",value:A})]})]})},microsoft_teams_microsoft_teams=e=>{let{site:t,languages:s}=e,{language:r}=(0,a.useContext)(h.CustomContext),l=(0,x.Z)(r);return(0,o.jsx)(n.Z,{type:n.G.SUBSCRIBE,languages:s,title:"".concat(l("getUpdatesBy")," ").concat(l("microsoftTeams")),description:"".concat(l("getUpdatesBy")," ").concat(l("microsoftTeams")),children:(0,o.jsx)(microsoft_teams_form,{})})}},84727:function(e,t,s){"use strict";var o=s(57437),a=s(2265),n=s(20446),r=s.n(n),l=s(80332),c=s(75474),i=s(53714);let ComponentItem=e=>{let{selectedComponents:t,item:s,handleChange:n}=e,{language:m,site:d}=(0,a.useContext)(l.CustomContext),u=(0,i.Z)(d.brandColor),h=(0,c.Z)(s.nameTranslation,m,s.name);return(0,o.jsx)("div",{className:"flex items-center justify-between w-full h-8 select-components select-affected",children:(0,o.jsxs)("div",{className:"flex items-center flex-grow",children:[(0,o.jsx)("input",{id:s.id,name:s.id,type:"checkbox",checked:t.includes(s.id),onChange:n,className:"w-5 h-5 appearance-none cursor-pointer form-checkbox ".concat(r()({"form-checkbox-brand":"dark"===u,"form-checkbox-black":"light"===u}))}),(0,o.jsx)("label",{className:"pl-3 leading-none cursor-pointer rtl:pr-3",htmlFor:s.id,children:h})]})},s.id)},ComponentGroup=e=>{let{group:t,selectedComponents:s,handleChange:n}=e,{language:r}=(0,a.useContext)(l.CustomContext),i=(0,c.Z)(t.nameTranslation,r,t.name);return(0,o.jsxs)("div",{className:"mt-2",children:[(0,o.jsx)("p",{className:"mt-2 font-medium",children:i}),(0,o.jsx)("div",{className:"pt-2 pl-3 rtl:pr-3",children:t.children.map((e,t)=>e.children.length>0?(0,o.jsx)(ComponentGroup,{selectedComponents:s,group:e,handleChange:n},t):(0,o.jsx)("div",{className:"-ml-3",children:(0,o.jsx)(ComponentItem,{selectedComponents:s,item:e,handleChange:n},t)}))})]})};t.Z=e=>{let{components:t,selectedComponents:s,handleChange:a}=e;return(0,o.jsx)("div",{className:"flex flex-col my-1",children:(0,o.jsx)("div",{className:"w-full",children:t.sort((e,t)=>e.order-t.order).map((e,t)=>e.children.sort(.length>0?(0,o.jsx)(ComponentGroup,{group:e,selectedComponents:s,handleChange:a},t):(0,o.jsx)(ComponentItem,{selectedComponents:s,item:e,handleChange:a},t))})})}},6613:function(e,t,s){"use strict";s.d(t,{Z:);var o=s(2265),use_observable=e=>{let[t,s]=(0,o.useState)(e),a=(0,o.useMemo)([]),n=(0,o.useMemo)(()=>e=>{s(e),a.forEach(},[a]),r=(0,o.useMemo)(()=>function(e){let s=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return a.push(e),s&&e(t),,[t,a]),l=(0,o.useMemo)(()=>function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return new Promise(s=>{let o=r(t=>{(!e||e(t))&&(s(t),o())},t)})},[r]);return{value:t,next:n,subscribe:r,wait:l}};let a=globalThis.window;var use_hcaptcha=()=>{let[e,t]=(0,o.useState)(!1),{next:s,wait:n}=use_observable("");(0,o.useMemo)(()=>{if(a){let e=a.document.createElement("script");e.src="https://js.hcaptcha.com/1/api.js",e.async=!0,e.defer=!0,e.onload=a.document.head.appendChild(e)}},[]),(0,o.useEffect)(()=>{if(!e)return;let t=a.document.createElement("div");a.document.body.appendChild(t);let o=globalThis.hcaptcha.render(t,{sitekey:"b31f0eef-6783-4d15-991e-90be691a6f01",size:"invisible"});return s(o),()=>{try{globalThis.hcaptcha.remove(o)}catch(e){}s(""),t.remove()}},[e,s]);let r=(0,o.useCallback)(async()=>{let e=await n(,t=(await globalThis.hcaptcha.execute(e,{async:!0})).response;if(!t)throw Error("No response");return t},[n]);return r}}},);