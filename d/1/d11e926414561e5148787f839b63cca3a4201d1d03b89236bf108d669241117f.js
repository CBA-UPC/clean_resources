/* funnel-relay version 2.6.16 - do the magic here 2022-08-03 11:11 */
trx=window.trx||{},trx.runcount=0,trx.runtime=function(){"use strict";trx.magicLinksEngine=null,trx.MagicLinks=class{static prepareDefaultSettings(e){return"object"!=typeof e.detection_rules&&(e.detection_rules={auto:!0,custom:[],exclude_urls:[],page_url_filter:""}),null==e.detection_rules.auto&&(e.detection_rules.auto=!0),null==e.detection_rules.auto_networks&&(e.detection_rules.auto_networks={amazon:!1,ls:!0,cj:!0,sas:!1,awin:!1,pj:!1,sl:!1,vl:!1,ir:!1,td:!1,wg:!1,pt:!1,al:!1,at:!1,tt:!1,ho:!1,tc:!1,bol:!1,afs:!1,rv:!1,wyf:!1,ef:!1,dc:!1,afy:!1,ebay:!1,rfs:!1,ct:!1,fo:!1,pap:!1,bhp:!1,eff:!1,fnc:!1,dd:!1,dynamic:!1}),e.detection_rules.custom instanceof Array||(e.detection_rules.custom=[]),e.detection_rules.exclude_urls instanceof Array||(e.detection_rules.exclude_urls=[]),null==e.detection_rules.page_url_filter&&(e.detection_rules.page_url_filter=""),null==e.detection_rules.amazon_no_append&&(e.detection_rules.amazon_no_append=!1),"object"!=typeof e.features&&(e.features={}),null==e.features.append_referrer&&(e.features.append_referrer={enabled:!0,attr_name:"referrer",new_query_param:!1}),null==e.features.asin_map&&(e.features.asin_map={enabled:!1}),null==e.features.asin_tag&&(e.features.asin_tag={enabled:!1}),null==e.features.wait_then_click&&(e.features.wait_then_click={enabled:!1}),null==e.features.use_beacon&&(e.features.use_beacon={enabled:!1}),null==e.features.observe&&(e.features.observe={enabled:!1}),null==e.features.urlchange&&(e.features.urlchange={enabled:!1}),null==e.features.iid_track&&(e.features.iid_track={enabled:!1}),null==e.features.new_window&&(e.features.new_window={enabled:!1}),null==e.features.attributes_forwarding&&(e.features.attributes_forwarding={enabled:!0,attributes:["utm_source","utm_campaign","utm_content","utm_medium","utm_term","gclid","fbclid","cntt"]}),null==e.features.append_timing&&(e.features.append_timing={enabled:!1,t_load:!1,t_clicked:!1,t_toclick:!1,new_query_param:!1}),null==e.features.append_attributes&&(e.features.append_attributes={enabled:!1,attributes:""}),null==e.features.track_events&&(e.features.track_events={enabled:!1,pageview:!1,clicks:!1,props_map:{xid:"prop1",link:"prop2",label:"prop3",referrer:"prop4",origin:"prop5"},props_map_custom:[]}),null==e.features.auto_optimize_link&&(e.features.auto_optimize_link={enabled:!1}),null==e.features.link_preview&&(e.features.link_preview={enabled:!1,show_icon:!1,show_metadata:!1,show_coupons:!1}),null==e.features.shorten_extra_param&&(e.features.shorten_extra_param={enabled:!1}),null==e.features.metadata&&(e.features.metadata={enabled:!1,selectors:""}),null==e.features.spot&&(e.features.spot={enabled:!1,link_rules:!1,asin_rules:!1,asin_per_page:!1,direct_deals:!1}),null==e.features.srs&&(e.features.srs={enabled:!1}),e}nit(){try{if(this._onPageSettings=trx.magic_links_settings||{},this._envSettings={"events_recording_env":"businessinsider","events_recording_api":"https://zouvd4sc05.execute-api.us-east-1.amazonaws.com/Prod","app_key":"gsd65fgr0hgTTT","events_recording_iid":"https://trx-hub.com"},this._serverSettings={"detection_rules":{"auto":"true","page_url_filter":"","auto_networks":{"amazon":"false","awin":"true","cj":"true","dynamic":"true","ir":"true","ls":"true","sas":"true","sl":"true","pj":"true","td":"true","wg":"true","pt":"true","al":"false","at":"false","tt":"false","vg":"true","ho":"false","tc":"false","bol":"false","rv":"false","afs":"false","wyf":"false","ef":"false","dc":"false","afy":"false","ebay":"false","rfs":"false","fo":"false","ct":"false","pap":"false","bhp":"false","eff":"false","fnc":"false","dd":"false"},"amazon_no_append":"true"},"features":{"append_referrer":{"enabled":"true","attr_name":"referrer"},"spot":{"enabled":"true","link_rules":"true","asin_rules":"false","asin_per_page":"false","direct_deals":"true","dd":{"enabled":"false"}},"asin_map":{"enabled":"false"},"asin_tag":{"enabled":"false","tags_required":"0"},"iid_track":{"enabled":"true"},"wait_then_click":{"enabled":"false"},"use_beacon":{"enabled":"false"},"observe":{"enabled":"false"},"urlchange":{"enabled":"false"},"new_window":{"enabled":"false"},"attributes_forwarding":{"enabled":"true","attributes":["utm_source","utm_campaign","utm_content","utm_medium","gclid","fbclid"]},"append_timing":{"enabled":"true","t_load":"true","t_clicked":"true","t_toclick":"true"},"append_attributes":{"enabled":"false","attributes":""},"track_events":{"enabled":"false","pageview":"false","clicks":"false","analytics_code":"","props_map":{"xid":"prop1","link":"prop2","label":"prop3","referrer":"prop4","origin":"prop5"}},"link_preview":{"enabled":"false","show_icon":"false","show_metadata":"false","show_coupons":"false"},"link_optimization":{"enabled":"false","shortening_extra_param":"false"},"metadata":{"enabled":"true","selectors":"headline | html\/head\/title\nvertical | html\/head\/meta[@name='tbi-vertical']\/@content\ncategory | js::window.Fenrir.config.tracking.postTrackingObject.category"}},"dynamic_domains":[""],"profile":"test","profile_name":"test","impact_domains":{"2cw9.net":1,"w6fg.net":1,"7ymy.net":1,"zz6n.net":1,"a4v3ci.net":1,"dttq.net":1,"5oih.net":1,"njih.net":1,"rfvk.net":1,"rt8x.net":1,"43k8.net":1,"7eer.net":1,"uzvs.net":1,"u44t.net":1,"pvxt.net":1,"vaz6fn.net":1,"ojrq.net":1,"mvvx.net":1,"yx69dc.net":1,"awb5.net":1,"k7qtpo.net":1,"8odi.net":1,"mp5l.net":1,"evyy.net":1,"fx3vf7.net":1,"2npn3e.net":1,"i9pljp.net":1,"l9vx.net":1,"75r4.net":1,"ulnv.net":1,"74rjtv.net":1,"trw6mw.net":1,"xwrk.net":1,"dgdrgu.net":1,"tnu8.net":1,"pq2o.net":1,"snlv.net":1,"yfb7.net":1,"vzck.net":1,"glg9ob.net":1,"5f77.net":1,"sk2bvq.net":1,"iln8.net":1,"7tiv.net":1,"o93x.net":1,"yfh6ag.net":1,"zfrcsk.net":1,"kwpkyy.net":1,"6cqhdo.net":1,"fziv.net":1,"f9tmep.net":1,"bwa8.net":1,"74az.net":1,"gnv2.net":1,"uidg.net":1,"i3zp.net":1,"ssxmnr.net":1,"l9yg.net":1,"ixmz.net":1,"fmtgqt.net":1,"uydo.net":1,"2lsp.net":1,"oie8.net":1,"7mh5.net":1,"tmfhgn.net":1,"ngi2ba.net":1,"bs6l.net":1,"fdf2.net":1,"ruqo.net":1,"bts6.net":1,"yxku6p.net":1,"xhuc.net":1,"b9i7.net":1,"vzffua.net":1,"oteh.net":1,"uskn.net":1,"kxyi.net":1,"hyyc7q.net":1,"5ad6.net":1,"n76h.net":1,"quvl.net":1,"qflm.net":1,"8hwt.net":1,"ig9i.net":1,"d2lsjo.net":1,"9quv.net":1,"rao4.net":1,"xikq.net":1,"72mu89.net":1,"xrx2ci.net":1,"q4ew.net":1,"j4ib.net":1,"wrrv.net":1,"uqzq.net":1,"mw46.net":1,"z6vo.net":1,"g39l.net":1,"2det.net":1,"ibfwsl.net":1,"jtlo.net":1,"dfjeo3.net":1,"wqi6.net":1,"jgpt48.net":1,"eccsr4.net":1,"myi4.net":1,"j4df.net":1,"s7so.net":1,"w2wxmz.net":1,"64ud.net":1,"6rfywi.net":1,"rrmo.net":1,"2m8f.net":1,"fu4n.net":1,"ryvx.net":1,"mjs4.net":1,"bn5x.net":1,"7xde.net":1,"5vju.net":1,"7zd4df.net":1,"xuok.net":1,"o64jx9.net":1,"am3t9s.net":1,"w2t6.net":1,"xr64.net":1,"vayb.net":1,"ygwk.net":1,"ioym.net":1,"dg6u.net":1,"oyuv.net":1,"otg8.net":1,"8ujrgu.net":1,"3qag.net":1,"3f64ir.net":1,"hrlo.net":1,"fjbu.net":1,"fqik.net":1,"43wo.net":1,"ncw6.net":1,"9nz77o.net":1,"xk3g.net":1,"p7qb.net":1,"mvqw.net":1,"ntaf.net":1,"iypa.net":1,"rv5k.net":1,"wjx7.net":1,"5d3x.net":1,"saq2.net":1,"vegb.net":1,"pxi6.net":1,"b54k.net":1,"njv3dp.net":1,"nob9.net":1,"t8puue.net":1,"briy.net":1,"bpu9.net":1,"voq9.net":1,"8aog.net":1,"dodxnr.net":1,"igs4ds.net":1,"w9v5.net":1,"exgl.net":1,"3uu8.net":1,"ei7w.net":1,"vjggsg.net":1,"79ic8e.net":1,"6noy.net":1,"zrjdwn.net":1,"vdcy.net":1,"8ne3.net":1,"tk2x2c.net":1,"2xc8.net":1,"3tvl.net":1,"tkjf.net":1,"r69o.net":1,"o5kg.net":1,"74wq.net":1,"zc5a.net":1,"e8i7.net":1,"bvrd.net":1,"r2oa.net":1,"uisv.net":1,"uqhv.net":1,"y8uw.net":1,"o67m.net":1,"ydow.net":1,"mlvy.net":1,"liln.net":1,"ga3c.net":1,"szey.net":1,"2lka.net":1,"opfm.net":1,"rhq9ml.net":1,"jvam.net":1,"uqog.net":1,"ork2.net":1,"nwh3qn.net":1,"znqymu.net":1,"wsslc4.net":1,"8kt6.net":1,"9pctbx.net":1,"7voo.net":1,"ifmu.net":1,"fzsu.net":1,"9j4c.net":1,"ow29pp.net":1,"sgur.net":1,"icjj.net":1,"27exom.net":1,"6ywx.net":1,"upvt.net":1,"4paxeq.net":1,"ue8cqz.net":1,"2su64p.net":1,"wo8g.net":1,"lvuv.net":1,"36c4.net":1,"vzew.net":1,"hmqldu.net":1,"m768hc.net":1,"7no9.net":1,"xuvt.net":1,"pfm4.net":1,"3lki.net":1,"p73z.net":1,"i3f2.net":1,"7isk.net":1,"7z5k.net":1,"brvi.net":1,"fi2z.net":1,"znvt.net":1,"tpeipe.net":1,"imlz.net":1,"audw.net":1,"rqu9.net":1,"hjef.net":1,"ln72.net":1,"a5fp.net":1,"juo2.net":1,"ir2by2.net":1,"tf77py.net":1,"eszb.net":1,"2gib.net":1,"bop8.net":1,"nsji.net":1,"mpye.net":1,"hs9x.net":1,"vocq.net":1,"msafflnk.net":1,"8zwg.net":1,"58dp.net":1,"973t.net":1,"hu6f.net":1,"5kd8.net":1,"ue7a.net":1,"i8h2.net":1,"7orgeq.net":1,"mp4l.net":1,"6wfgdb.net":1,"ayxtyv.net":1,"h4km.net":1,"mxu9.net":1,"w9iork.net":1,"ftcv.net":1,"6eld.net":1,"atkw.net":1,"nkwcmr.net":1,"vwz6.net":1,"xovt.net":1,"lkze4s.net":1,"uxsi.net":1,"wkq9.net":1,"8utb.net":1,"2j9x.net":1,"kk2kau.net":1,"iy7a.net":1,"2xje.net":1,"vqi8.net":1,"keof.net":1,"givvml.net":1,"x57o.net":1,"33qw.net":1,"nbq93e.net":1,"tlir.net":1,"7st3op.net":1,"l3km.net":1,"pb6g.net":1,"hj2i.net":1,"8f6i.net":1,"tql5.net":1,"otpb.net":1,"2gfm.net":1,"whij.net":1,"9zpg.net":1,"8mz3uu.net":1,"8hslpj.net":1,"nrku7u.net":1,"xg6r.net":1,"jyae.net":1,"o3ae.net":1,"9vn7kv.net":1,"rw9xb6.net":1,"z5dw.net":1,"wk5q.net":1,"e9jo.net":1,"r7kg.net":1,"uikc.net":1,"258o.net":1,"eyip.net":1,"c9ftyd.net":1,"a9yw.net":1,"krg4.net":1,"et7l.net":1,"wd2f.net":1,"nvaz.net":1,"ozkewk.net":1,"5sfo.net":1,"qumg.net":1,"5l5h.net":1,"cwv7.net":1,"qbt4.net":1,"ytuz.net":1,"3xvk.net":1,"zlyuo6.net":1,"58mq.net":1,"z27l.net":1,"iqoc.net":1,"eqjw.net":1,"dbapeb.net":1,"hgphc2.net":1,"wnbi.net":1,"te8rfv.net":1,"qyiv3c.net":1,"jv6k.net":1,"9rwv.net":1,"zgkv.net":1,"p5ld.net":1,"s4lle7.net":1,"eqcm.net":1,"wsktbf.net":1,"7ema.net":1,"2rch.net":1,"y6mxrg.net":1,"cmuw.net":1,"jedg.net":1,"wmempi.net":1,"lmwjx3.net":1,"zpn8dk.net":1,"z724.net":1,"zihf.net":1,"i5md.net":1,"yaub.net":1,"syuh.net":1,"htuy.net":1,"pbj2.net":1,"zvq6.net":1,"rg35.net":1,"8ibi.net":1,"kbp968.net":1,"5zd6.net":1,"n72aat.net":1,"aiy7.net":1,"nnh2.net":1,"z6rjha.net":1,"7fdy.net":1,"8bvm.net":1,"qodh.net":1,"jwpdsd.net":1,"otegtm.net":1,"2t23.net":1,"i5em.net":1,"xibx.net":1,"xlwzq3.net":1,"deg5.net":1,"3anx.net":1,"78cfvm.net":1,"57ib.net":1,"6dny.net":1,"auhm.net":1,"tm7566.net":1,"tm7516.net":1,"tm7569.net":1,"tm7559.net":1,"tm7560.net":1,"tm7562.net":1,"tm8534.net":1,"lusg.net":1,"bxvfun.net":1,"8bga.net":1,"22o6.net":1,"ebml.net":1,"9q66.net":1,"i679.net":1,"attfm2.net":1,"ztk5.net":1,"dubn.net":1,"yuxg.net":1,"2nm686.net":1,"meqk.net":1,"kd4a.net":1,"e2rq.net":1,"m43q4j.net":1,"hblm3c.net":1,"yvzx.net":1,"vp6l.net":1,"u97e.net":1,"5rmr.net":1,"qyov.net":1,"yoxl.net":1,"e54b.net":1,"akum7z.net":1,"hg7mxc.net":1,"pdy5.net":1,"aqpq.net":1,"mivh.net":1,"eqwh.net":1,"vx83.net":1,"vtdix3.net":1,"xvtl.net":1,"ulvh.net":1,"cw3o.net":1,"zvcr.net":1,"eat8mo.net":1,"ikkr9x.net":1,"6x7g.net":1,"bzi2vw.net":1,"43a8.net":1,"gfpv.net":1,"sjv.io":1,"pxf.io":1,"affiliates.abebooks.com":1,"go.corsair.com":1,"go.gemvara.com":1,"go.jewelry.com":1,"go.web.plus.espn.com":1,"goto.bodybuilding.com":1,"goto.carters.com":1,"goto.grocery.walmart.com":1,"goto.kayosports.com.au":1,"goto.target.com":1,"goto.walmart.com":1,"hpn.houzz.com":1,"linkto.hrblock.com":1,"partners.alamo.com":1,"partners.enterprise.com":1,"partners.hostgator.com":1,"partners.hotwire.com":1,"partners.nationalcar.com":1,"refer.turo.com":1,"tracking.maxcdn.com":1,"tracking.stackpath.com":1,"hpn.houzz.co.uk":1,"partners.wantable.co":1,"i284638.net":1,"xayxet.net":1,"7sb2uw.net":1,"dcm9zy.net":1,"6jxl.net":1,"cfzu.net":1,"i140643.net":1,"i125364.net":1,"i127288.net":1,"8ocm68.net":1,"jlud63.net":1,"i312864.net":1,"rv8crv.net":1,"haujjd.net":1,"qq3wj3.net":1,"4hyab9.net":1,"i308314.net":1,"oet7.net":1,"uym8.net":1,"avo2.net":1,"i279709.net":1,"i139476.net":1,"3tpfen.net":1,"bbgqo9.net":1,"i139049.net":1,"nm3tqp.net":1,"soyxmd.net":1,"partner.canva.com":1,"4xc4ep.net":1,"frhi32.net":1,"wrjfga.net":1,"i206080.net":1,"8s4u9r.net":1,"fubo.tv":1,"8u86.net":1,"shrw9t.net":1,"ouod.net":1,"i157428.net":1,"i274555.net":1,"gqce.net":1,"nhuie7.net":1,"i310051.net":1,"i351729.net":1,"i181536.net":1,"xyibsh.net":1,"i326295.net":1,"obak77.net":1,"7w7o67.net":1,"i206938.net":1,"zvvq7p.net":1,"oloiyb.net":1,"wvr2.net":1,"8rh8hm.net":1,"i276600.net":1,"i358707.net":1,"d67ag4.net":1,"magpmk.net":1,"i7cdw9.net":1,"i114090.net":1,"ubertrk.com":1,"i240138.net":1,"7ufqwl.net":1,"fdcm73.net":1,"n5ka.net":1,"q77h.net":1,"goto.bluenile.com":1,"bodybuilding.com":1,"ayph.net":1,"pvzi.net":1,"35p2.net":1,"cezg3w.net":1,"i294747.net":1,"ml6pmo.net":1,"i200065.net":1,"k77v.net":1,"l49yho.net":1,"i301580.net":1,"lf49oc.net":1,"i242740.net":1,"i142493.net":1,"zvbf.net":1,"risj.net":1,"partners.inmotionhosting.com":1,"fum2sp.net":1,"av4d.net":1,"i240196.net":1,"i134524.net":1,"i263265.net":1,"i8epma.net":1,"ihfo.net":1,"i209368.net":1,"oedf.net":1,"i6xjt2.net":1,"i328067.net":1,"i146980.net":1,"idgz2n.net":1,"drn3.net":1,"i305175.net":1,"i271380.net":1,"vxca.net":1,"c3me6x.net":1,"i317579.net":1,"iyhh.net":1,"wgn3fr.net":1,"vthnbx.net":1,"i277339.net":1,"ifgza3.net":1,"llbyf9.net":1,"c5l5.net":1,"i263671.net":1,"4fq8.net":1,"blihtq.net":1,"rjnwm7.net":1,"43zz.net":1,"i275503.net":1,"i276271.net":1,"2gl34e.net":1,"i206969.net":1,"i303683.net":1,"hbbswr.net":1,"ewrvdi.net":1,"hq6ajo.net":1,"kmlj9i.net":1,"goto.americanexpress.com":1,"hw4zyk.net":1,"4ok7ht.net":1,"i179050.net":1,"wmsyr7.net":1,"a6gkwq.net":1,"i257289.net":1,"4tqiav.net":1,"i203032.net":1,"ie8t3j.net":1,"xr2bd6.net":1,"i286093.net":1,"ustnul.net":1,"uewp.net":1,"nd8t.net":1,"txuqk6.net":1,"xpfo.net":1,"8x7ctf.net":1,"i130883.net":1,"i295461.net":1,"i294432.net":1,"t7c9v8.net":1,"chx3kt.net":1,"i297327.net":1,"c38gzp.net":1,"i123888.net":1,"i246982.net":1,"i148866.net":1,"gcc3.net":1,"ver28r.net":1,"xkpq.net":1,"xkri.net":1,"9yde.net":1,"i134784.net":1,"xhtgk3.net":1,"hv8ceq.net":1,"77jaha.net":1,"9u2rlz.net":1,"uztnuq.net":1,"mkr3.net":1,"642pbb.net":1,"2xkn.net":1,"qk4r.net":1,"gfko.net":1,"mno8.net":1,"znhhcm.net":1,"iybsj3.net":1,"aht6xo.net":1,"8zaeu3.net":1,"kjorbe.net":1,"sfe5.net":1,"i299105.net":1,"6uu72h.net":1,"4g9yrz.net":1,"1.envato.market":1,"4drrzr.net":1,"c3nu2i.net":1,"vs9au6.net":1,"tdndqm.net":1,"i339540.net":1,"i285710.net":1,"i250869.net":1,"775j.net":1,"7q8j.net":1,"83ckgt.net":1,"i300907.net":1,"qn6r.net":1,"p8mc.net":1,"lgkftb.net":1,"i334637.net":1,"i205484.net":1,"ldw66v.net":1,"aqp4qa.net":1,"i358993.net":1,"i168918.net":1,"hnyj8s.net":1,"7qto.net":1,"i121497.net":1,"mrlph3.net":1,"fhsxpf.net":1,"npfrrw.net":1,"i116782.net":1,"u7lr6p.net":1,"648q.net":1,"tbthfv.net":1,"i116503.net":1,"uqrxu7.net":1,"i302106.net":1,"i183635.net":1,"pa4kxy.net":1,"3obyns.net":1,"i210675.net":1,"xb398u.net":1,"i276400.net":1,"fb8d.net":1,"kbasqv.net":1,"i189637.net":1,"i190936.net":1,"i140070.net":1,"i353150.net":1,"t2bw9u.net":1,"vvtnn9.net":1,"p3oc.net":1,"g6gdil.net":1,"i213011.net":1,"ule4b9.net":1,"qy67zi.net":1,"8zgmnp.net":1,"wxc9hm.net":1,"bueme2.net":1,"wcmu8e.net":1,"i260660.net":1,"2ygtwc.net":1,"i122908.net":1,"74tzgq.net":1,"e4wb.net":1,"5nfc.net":1,"zafxzt.net":1,"e9ppfh.net":1,"tv2h87.net":1,"nkygzf.net":1,"i108736.net":1,"i163678.net":1,"i144304.net":1,"f6rcao.net":1,"9yoxzr.net":1,"erik73.net":1,"r37x9j.net":1,"ng4cgr.net":1,"8v4lqg.net":1,"o7n83a.net":1,"i261477.net":1,"m4ibck.net":1,"74xz8u.net":1,"i169060.net":1,"i117711.net":1,"epvitm.net":1,"puasq9.net":1,"wf373c.net":1,"gyuyee.net":1,"pkpakz.net":1,"i340849.net":1,"i344083.net":1,"i203761.net":1,"i270719.net":1,"vwli.net":1,"i295768.net":1,"i359245.net":1,"i258711.net":1,"rvgu.net":1,"mwztt8.net":1,"elfm.net":1,"eyjo.net":1,"gqco.net":1,"hmxg.net":1,"ijrn.net":1,"jewn.net":1,"tzva.net":1,"wfraqy.net":1,"dne9je.net":1,"4byfvk.net":1,"i181990.net":1,"xq2wid.net":1,"7oyhzp.net":1,"aydjxz.net":1,"i331371.net":1,"ffxwxg.net":1,"i363662.net":1,"obbk.net":1,"fgjaok.net":1,"h382za.net":1,"i113075.net":1,"i130297.net":1,"a49pb4.net":1,"8kpa2n.net":1,"i128439.net":1,"i326837.net":1,"w27s.net":1,"gtlppj.net":1,"i104546.net":1,"go.silpada.com":1,"i160067.net":1,"gvhb.net":1,"8lvxaf.net":1,"i191769.net":1,"awv4zz.net":1,"gtlptb.net":1,"7ck3j6.net":1,"w7ma.net":1,"j8ujgp.net":1,"c2ukkg.net":1,"u4prjd.net":1,"t2nfq3.net":1,"i317572.net":1,"i246054.net":1,"woc3yh.net":1,"zytd7d.net":1,"jpzeir.net":1,"li9jiy.net":1,"i141006.net":1,"i141602.net":1,"mzte.net":1,"vz7pkt.net":1,"yardaz.net":1,"a49tr6.net":1,"tkl68z.net":1,"i298770.net":1,"2uf4ta.net":1,"i156748.net":1,"jmx223.net":1,"nqn6.net":1,"n72y7a.net":1,"i357552.net":1,"i274396.net":1,"vdvm.net":1,"8n4773.net":1,"btyhsg.net":1,"g7ix2j.net":1,"4qxjn9.net":1,"vfjm.net":1,"nrlq2m.net":1,"wyfx2f.net":1,"4emhls.net":1,"ovon4f.net":1,"2rcf97.net":1,"krym8q.net":1}},null==this._envSettings.events_recording_env&&(this._envSettings.events_recording_env="prod"),this._embedUrlToken="FR-EMBEDDED-RF",this._delimiter1="|",this._delimiter2="~",this._delimiter3="%40%40",this._delimiter4="-",this._logPrefix="FunnelRelay:: ",this._loadTime=Date.now(),this._links=[],this._links_unique={},this._customLinks=new Map,this._report={},this._exclude_urls_regex=[],this._iframed=window.self!==window.top,!0===this._iframed&&void 0!==document.referrer&&""!==document.referrer&&(trx.source=document.referrer),this._scriptEm=document.getElementById("funnel-relay-installer"),null!=this._scriptEm){if(!this._scriptEm.hasAttribute("data-property-id")||!this._scriptEm.hasAttribute("data-customer-id")||this._isEmpty(this._scriptEm.hasAttribute("data-property-id"))||this._isEmpty(this._scriptEm.hasAttribute("data-customer-id")))return void this._error("Missing one of the mandatory script attributes 'data-customer-id' and/or 'data-property-id'");this._customerId=this._scriptEm.getAttribute("data-customer-id"),this._propertyId=this._scriptEm.getAttribute("data-property-id"),this._isSimulator=this._scriptEm.hasAttribute("data-simulator")}else{if(!window.trxFrTag)return void this._error('Installation script is missing  id="funnel-relay-installer" attribute. Funnel Relay will not run');this._customerId=window.trxFrCustomerId,this._propertyId=window.trxFrPropertyId,this._isSimulator=!1}var e=/iPad|iPhone|iPod/.test(navigator.platform||"");this._new_window=!1,0==this._new_window&&void 0!==this._serverSettings.features&&void 0!==this._serverSettings.features.new_window&&!0===this._asBoolean(this._serverSettings.features.new_window.enabled)&&(this._new_window=!0),this._iid_track=!1,0==this._iid_track&&void 0!==this._serverSettings.features&&void 0!==this._serverSettings.features.iid_track&&!0===this._asBoolean(this._serverSettings.features.iid_track.enabled)&&(this._iid_track=!0),this._asin_map=!1,0==this._asin_map&&void 0!==this._serverSettings.features&&void 0!==this._serverSettings.features.asin_map&&!0===this._asBoolean(this._serverSettings.features.asin_map.enabled)&&(this._asin_map=!0),this._asin_tag=!1,0==this._asin_tag&&void 0!==this._serverSettings.features&&void 0!==this._serverSettings.features.asin_tag&&!0===this._asBoolean(this._serverSettings.features.asin_tag.enabled)&&(this._asin_tag=!0),this._use_beacon=e,0==this._use_beacon&&void 0!==this._serverSettings.features&&void 0!==this._serverSettings.features.use_beacon&&!0===this._asBoolean(this._serverSettings.features.use_beacon.enabled)&&(this._use_beacon=!0),void 0!==trx.amp_redirect&&1==trx.amp_redirect?this.ampRedirectNow():(this._prepareSettings(),this._prepareExcludeRegExp(),this._autoRun&&this.run(),this.retransmit_sotrage_items(),this._observe=!1,0==this._observe&&void 0!==this._serverSettings.features&&void 0!==this._serverSettings.features.observe&&!0===this._asBoolean(this._serverSettings.features.observe.enabled)&&(this._observe=!0),this._observe&&this.observe(),this._url_change=!1,0==this._url_change&&void 0!==this._serverSettings.features&&void 0!==this._serverSettings.features.urlchange&&!0===this._asBoolean(this._serverSettings.features.urlchange.enabled)&&(this._url_change=!0),void 0==trx.his&&this._url_change&&(trx.his=!0,this._debug("bind location change!"),history.pushState=(e=>(function t(){var i=e.apply(this,arguments);return window.dispatchEvent(new Event("pushstate")),window.dispatchEvent(new Event("locationchange")),i}))(history.pushState),history.replaceState=((history.replaceState),window.addEventListener("popstate",,window.addEventListener("locationchange",))}catch(e){console.error("Magic Links 'init' procedure fail! Details: "+e),e.stack&&console.error(e.stack)}}observe(){if(void 0===trx.observer){var e=0,t={attributes:!0,childList:!0,subtree:!0};window.MutationObserver&&(trx.observer=new MutationObserver(function(i){e>1||1==(e+=1)&&(trx.observer.disconnect(),setTimeout(function(){this._links=[],this._debug("Rerun..."),this.run(),e=0,trx.observer.observe(document.body,t)}.bind(this),3e3))}.bind(this)),trx.observer.observe(document.body,t))}}retransmitlog(e){let t=this._envSettings.events_recording_api+"/log",i={method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrer:"*client",body:e};return navigator.sendBeacon&&this._use_beacon?navigator.sendBeacon(t,e):fetch(t,i).then(t=>{if(t.ok){let i="Write to events-recording service. Body:\n"+e;return this._isSimulator&&this._log(i),this._debug(i),t.json()}this._log("Fail to write event data. HTTP error, status = "+t.status)}).then(e=>{e&&e.message&&this._log(e.message)}).catch(e=>{this._log(e)})}nPageSettings(){return this._onPageSettings}et paramsBuffer(){return this._paramsBuffer}un(){if(this.isInRunFunction)this._debug("Already in run function.");else{0===trx.runcount&&(trx.runcount=trx.runcount+1),this.isInRunFunction=!0;try{if(this._isEmpty(this._envSettings.events_recording_api))return void this._error("Missing environment settings. Check that you setup $ENV_SETTINGS in my.cfg.php and that 'events_recording_api' is set there!");if(!this._checkPageUrlMatch())return;if(document.links.length>0)for(let e=0;e<document.links.length;e++){let t=document.links[e];if(trx.magicLinksSimulator){let e=t.getAttribute("data-orig-url");this._isEmpty(e)||(t.href=e),t.removeAttribute("data-ml-dynamic-type"),t.removeAttribute("data-ml-dynamic"),t.removeAttribute("data-ml-id"),t.removeAttribute("data-xid"),t.removeAttribute("data-ml")}t.hasAttribute("data-skimlinks-tracking")&&t.setAttribute("data-skimlinks-tracking",this._cleanupXid(t.getAttribute("data-skimlinks-tracking")))}this._detectLinks(),this._disbaleLinks(),this._links.length>0&&(this._appendUUID(),this._runFeatures()),(this._asin_map||this._asin_tag)&&this._asinMapCall(),this._logPageTrace(),this._debug("Links count "+this._links.length);for(let e=0;e<this._links.length;e++){let t=this._links[e];t.info.dynamic||t.info.disable||(t.info.embedded?t.anchor.href=t.info.wrapping_url.replace(this._embedUrlToken,encodeURIComponent(t.info.url)):void 0!==t.info.selector_attribute?t.anchor.setAttribute(t.info.selector_attribute,t.info.url):t.anchor.href=t.info.url)}null!=r&&"true"===r.getAttribute("data-report")&&this._postReport(),void 0!==trx.SpotClient&&(trx.spotEngine=new trx.SpotClient(this),trx.spotEngine.start()),this._iid_track&&this._updateIID()}catch(e){this._error("'run' procedure fail! Details: "+e,e.stack),this.isInRunFunction=!1}this.isInRunFunction=!1}}pdateIID(){var e=!1;if(void 0===trx.iid&&(e=!0,trx.iid=this._generateUUID().replace("fr","iid")),void 0!==trx.LZString&&void 0!==this._envSettings.events_recording_iid){if(e){let e=this._paramsBuffer;if(e.client_time=(new Date).toISOString(),e.page_title=document.title,e.iid=trx.iid,e.event_type="impression",void 0===e.customer_id){e.cidp1=e.customer_id=this._customerId;const t=this._paramsBuffer.customer_id.split("_");if(-1!==e.customer_id.indexOf("_")){const t=e.customer_id.split("_");if(t.length>2){let i=t.slice(0,t.length-1);e.cidp1=i.join("_"),e.cidp2=t[t.length-1]}}}var t=JSON.stringify(e),i=trx.LZString.compressToEncodedURIComponent(t);this._debug("Meta "+t.length+"  bytes decresed to "+i.length+" bytes ("+Math.round(100*i.length/t.length)+" %)");var r=this._envSettings.events_recording_iid+"/i/m/i.png?q="+i;if(this.pixel_append(r),r.length>=8e3)try{if("undefined"!=typeof Storage){var s,n="fr_log_"+(s=Math.round((new Date).getTime()/1e3)),a={},o;(o=this._getLogInfomration(a)).url=window.location.href,o.message="pixel too big "+r.length,localStorage.setItem(n,JSON.stringify(o))}}catch(e){this._debug(e)}}if(console.log("iid ll"+this._links.length),this._links.length>0){var l=[],d=25,c=0,h=0;for(var u in this._links)void 0===l[c]&&(l[c]={}),l[c][this._links[u].info.xid]=this._links[u].anchor.getAttribute("data-orig-url"),h>=25&&(c+=1,h=0),h+=1;for(var _=0;_<=c;_++)if(void 0!==l[_]){this._debug(l[_]);var f={pid:this._paramsBuffer.customer_id,iid:trx.iid,xids:l[_]},g=JSON.stringify(f),m=trx.LZString.compressToEncodedURIComponent(g);this._debug(g.length+" bytes decresed to "+m.length+" bytes ("+Math.round(100*m.length/g.length)+" %)");var r=this._envSettings.events_recording_iid+"/i/x/i.png?q="+m;if(this.pixel_append(r),r.length>=8e3)try{if("undefined"!=typeof Storage){var s,n="fr_log_"+(s=Math.round((new Date).getTime()/1e3)),a={},o;(o=this._getLogInfomration(a)).url=window.location.href,o.message="pixel too big "+r.length,localStorage.setItem(n,JSON.stringify(o))}}catch(e){this._debug(e)}}}}}icked(e,t,i){if("true"===e.anchor.getAttribute("data-written"))return void this._debug("click already saved.");if(e.info.dynamic){let t;if("vg"===e.anchor.getAttribute("data-ml-dynamic-type")){let t=vglnk.opt("cuid");t=this._cleanupXid(t),this._isEmpty(t)||(t+="|"),t+="xid:"+e.info.xid,vglnk.opt("cuid",t)}}this._collectClickTimeParams();let r=!1;if(void 0!==e.anchor&&"true"===(r=e.anchor.getAttribute("data-written")))return;let s=this._promiseTimeout(2e3,this._writeDataToEventsService(e,t.type,i));s.then(,s.catch(}cleanupXid(e,t){if(null==e)return"";let i,r;return null==t&&(t=""),this._isEmpty(e)||(i=e.indexOf("|xid:fr"),r="|xid:fr".length,-1===i&&(i=e.indexOf("xid:fr"),r="xid:fr".length),-1!==i&&(e=this._insertSubstringToString(e,t,i,i+r+16))),e}_appendUUID(){let e={amazon:this._asBoolean(this._settings.detection_rules.amazon_no_append)};const t=Date.now();for(let r=0;r<this._links.length;r++){let s=this._links[r];if(s.anchor.hasAttribute("data-xid")){var i=s.anchor.getAttribute("data-xid").replace("fr","").slice(0,-3);if(!(parseInt(i)+86400<t))continue;s.anchor.removeAttribute("data-xid")}let n=s.info.url,a=s.network,o=this._generateUUID();1==s.anchor.hasAttribute("data-prepend-xid")&&(o=s.anchor.getAttribute("data-prepend-xid")),1==s.anchor.hasAttribute("data-written")&&s.anchor.removeAttribute("data-written"),this._xids[o]="",s.info.xid=o,null!=e[a]&&!1!==e[a]||1==s.anchor.hasAttribute("data-prepend-xid")&&1==s.anchor.hasAttribute("data-affiliation-url")||(s.info.embedded&&null!=s.info.wrapping_url&&-1==s.info.wrapping_url.indexOf("shop-links.co")&&(s.info.wrapping_url=this._appendExtraParam(s.info.wrapping_net,s.info.wrapping_url,"xid",o,!1)),s.info.url=this._appendExtraParam(a,n,"xid",o,!1)),s.anchor.setAttribute("data-xid",o),this._new_window&&0==s.anchor.hasAttribute("target")&&s.anchor.setAttribute("target","_blank"),null!=window.trxdebug&&s.anchor.setAttribute("data-network",a)}}OptimizeLinks(e){this._asBoolean(e.enabled)}yUrl(){let e,t,i=this._settings.detection_rules.auto_networks;for(let n=0;n<document.links.length;n++){let a=document.links[n];if(!0===trx.magicLinksSimulator||!a.hasAttribute("data-xid")){e=a.href;var r=this._getAbsoluteOffsetFromBody(a);if(void 0===this._links_unique[r.top+"_"+r.left+"_"+e]&&!this._isEmpty(e)&&this._isAbsolute(e)&&!this._isExcludedUrl(e)){let n={inxStart:0,inxEnd:0,embedded:!1,dynamic:!1,dynamicType:null,url:"",network:""};if(t=this._detectKnownAffiliateLink(e,n),this._checkEmbeddedLink(e,n),!1!==t&&this._asBoolean(i[t])||a.hasAttribute("data-prepend-xid")){if(a.hasAttribute("data-prepend-xid")&&this._debug("found prepended xid"),n.network=t,"sas"==t&&-1!==e.search(/(r\.cfm\?b=999&)|(r.cfm%3Fb%3D999%26)/)){this._log("found wrong SAS url.");var s=e;void 0!==n.wrapping_url&&(s=n.url),s=(s=s.replace("r.cfm?b=999&","r.cfm?b=999999&")).replace("r.cfm%3Fb%3D999%26","r.cfm%3Fb%3D999999%26"),n.url=s,a.setAttribute("data-orig-url",e)}this._links.push({network:t,anchor:a,info:n}),this._links_unique[r.top+"_"+r.left+"_"+e]=a,a.hasAttribute("data-orig-url")||a.setAttribute("data-orig-url",e)}else!1===t&&this._asBoolean(i.dynamic)&&"true"===a.getAttribute("data-ml-dynamic")&&(n.inxStart=0,n.inxEnd=0,n.embedded=!1,n.dynamic=!0,n.dynamicType=a.getAttribute("data-ml-dynamic-type"),n.url="",n.network=a.getAttribute("data-ml-dynamic-type"),this._links.push({network:t,anchor:a,info:n}),this._links_unique[r.top+"_"+r.left+"_"+e]=a,a.hasAttribute("data-orig-url")||a.setAttribute("data-orig-url",e))}}}}etectKnownAffiliateLink(e,t){let i,r,s={};void 0!==this._serverSettings.impact_domains&&(s=this._serverSettings.impact_domains);var n=e.match(/^https?\:\/\/([^\/?#]+)(?:[\/?#]|$)/i),a=n&&n[1];if(null!==a&&1!==s[a]){const e=/(([a-z\-0-9]+)(?:\.com|\.fr|\.co.uk|\.io|\.net|\.com.au|\.co|\.tv|\.market))/g;null!==(n=a.match(e))&&1==n.length&&(a=n[0])}if(-1!==e.indexOf("/dp/")&&e.includes("tag=")&&(r=-1!==e.indexOf("amazon."))||-1!==e.indexOf("/gp/")&&e.includes("tag=")&&(r=-1!==e.indexOf("amazon."))||(r=-1!=e.indexOf("/amzn."))||(r=-1!=e.indexOf("/www.amzn."))||(r=-1!=e.indexOf(".amazon-adsystem.com")))i="amazon";else if(-1!==(r=e.indexOf("linksynergy")))i="ls";else if(-1!==(r=e.indexOf("anrdoezrs.net"))||-1!==(r=e.indexOf("jdoqocy.com"))||-1!==(r=e.indexOf("tqlkg.com"))||-1!==(r=e.indexOf("tkqlhce.com"))||-1!==(r=e.indexOf("dpbolvw.net"))||-1!==(r=e.indexOf("jqoqocy.com"))||-1!==(r=e.indexOf("kqzfj.com"))||-1!==(r=e.indexOf("kqzyfj.com"))||-1!==(r=e.indexOf("ftjcfx.com"))||-1!==(r=e.indexOf("lduhtrp.net"))||-1!==(r=e.indexOf("qksrv.net")))i="cj";else if(-1!==(r=e.indexOf("shareasale.com")))i="sas";else if(-1!==(r=e.indexOf("awin1.com")))i="awin";else if(-1!==(r=e.indexOf("pepperjamnetwork.com"))||-1!==(r=e.indexOf("pjtra.com/t/"))||-1!==(r=e.indexOf("gopjn.com/t/"))||-1!==(r=e.indexOf("pjatr.com/t/"))||-1!==(r=e.indexOf("pntra.com/t/"))||-1!==(r=e.indexOf("pntrs.com/t/"))||-1!==(r=e.indexOf("pntrac.com/t/")))i="pj";else if(-1!==(r=e.indexOf("track.webgains.com")))i="wg";else if(-1!==(r=e.indexOf("prf.hn/click")))i="pt";else if(-1!==(r=e.indexOf("tradedoubler.com/click?"))||-1!==(r=e.indexOf("pf.tradedoubler.com/pf/")))i="td";else if(-1!==(r=e.search(/\/c\/(\d+)\/(\d+)\//))||-1!==(r=e.search(/%2Fc%2F(\d+)%2F(\d+)%2F(\d+)%/))||1==s[a])i="ir";else if(-1!==(r=e.indexOf("go.redirectingat.com"))||-1!==e.indexOf("go.skimresources.com")||-1!==e.indexOf("fave.co"))i="sl";else if(-1!==(r=e.indexOf("redirect.viglink.com")))i="vg";else if(-1!==(r=e.indexOf("avantlink.com/click")))i="al";else if(-1!==(r=e.indexOf("track.adtraction.com"))||-1!==(r=e.indexOf("adtr.co"))||-1!==(r=e.search(/\/t\/t\/\?a=(\d+)/))||-1!==(r=e.search(/\/t\/t\?a=(\d+)/)))i="at";else if(-1!==(r=e.indexOf("tc.tradetracker.net"))||-1!==(r=e.search(/(\?|\&)tt=(\d+)_(\d+)_(\d+)(_[\w-]+)?/)))i="tt";else if(-1!==(r=e.indexOf("/aff_c"))&&-1!==e.search(/aff_id=(\d+)/))i="ho";else if(r=-1!==e.indexOf("c.trackmytarget.com"))i="tc";else if(r=-1!==e.indexOf("buy.geni.us/Proxy.ashx"))i="ge";else if((r=-1!==e.indexOf("partner.bol.com/click/click"))||(r=-1!==e.indexOf("tracking.bol.com/click/click")))i="bol";else if(r=-1!==e.indexOf("track.wg-aff.com/click"))i="afs";else if(r=-1!==e.indexOf("oc.brcclx.com/t/?"))i="rv";else if(r=-1!==e.search(/(wayfair\.com[\S]+refid=)/))i="wyf";else if((r=-1!==e.search(/(ndt5\.net\/c\/)/))||(r=-1!==e.search(/(ds1\.nl\/c\/)/))||(r=-1!==e.search(/(lt45\.net\/c\/)/))||(r=-1!==e.search(/(fr135\.net\/c\/)/))||(r=-1!==e.search(/(dt51\.net\/c\/)/))||(r=-1!==e.search(/(at19\.net\/c\/)/))||(r=-1!==e.search(/(jf79\.net\/c\/)/)))i="dc";else if(r=-1!==e.search(/(ostlon\.com\/4LS8T4J\/9LLP2M\/)|(hiasor\.com\/4LS8T4J\/ZCJM85\/)|(goplay4\.com\/4LS8T4J\/HWPZ42Z\/)|(trck1t\.com\/4LS8T4J\/J5ZP3HL\/)/))i="ef";else if(r=-1!==e.search(/((ebay\.)(?=.*\bcampid=[\d+])(?=.*\bmkcid=1\b)(?=.*\bmkrid=[\d+]*\b)[\S]*)|((ebay\.)(?=.*\bcampid=[\d+])(?=.*\bmpre=[\d+]*\b)(?=.*\bpub=[\d+]*\b)[\S]*)|((ebay\.).[\S]*(mkcid%3D)[\S]*(mkrid%3D[0-9\-]*)[\S]*(%26campid%3D[0-9]*)[\S]*)/))i="ebay";else if(r=-1!==e.search(/((spindlemattress|worldwidecyclery|thegravitycartel|verdebikes|gaggiadirect|cobocbd|leafremedys)\.com[\S]*[\&|\?]aff=[\d]+)|(lumen\.me[\S]*[\&|\?]fid=[\d]+)/))i="afy";else if(r=-1!==e.search(/(\?|\&)(rfsn=([0-9]{1,})\.([a-z0-9]{3,}))/))i="rfs";else if(r=-1!==e.search(/(cmtcr\.com\/clk\.trk|qwxyq\.com\/clk\.trk)/))i="ct";else if(r=-1!==e.search(/(track\.flexlinkspro\.com|track\.flexlinks\.com)/))i="fo";else if(r=-1!==e.search(/(stackedbrands\.com|getrxd\.com|transparentlabs\.com|roguefitness\.com|leanbeanofficial\.com|realketones\.com|amplemeal\.com)|([\?|\&|\#]a_aid=[a-zA-Z0-9]+)/))i="pap";else if(r=-1!==e.search(/(bhphotovideo\.com\/c\/product[\S]*\/BI\/[\d]*[\S]*\/KBID\/[\d]*)/))i="bhp";else if(r=-1!==e.search(/(track.effiliation.com\/)[\S]*(id_compteur=[1-9]+)/))i="eff";else if(r=-1!==e.search(/(financeads\.net\/tc\.php)/))i="fnc";else{if(!(r=-1!==e.search(/(\.digidip\.net\/visit[\S]*(url=))|(\.digidip\.net%2Fvisit[\S]*(url%3D))/)))return!1;i="dd"}return t.inxNext=r,i}heckEmbeddedLink(e,t){let i=t.inxNext,r=e.lastIndexOf("=",i);if(-1!==r&&r<i){t.inxStart=r+1;let s=e.indexOf("&",i);-1===s&&(s=e.length),t.inxEnd=s,t.embedded=!0,t.url=decodeURIComponent(e.substring(t.inxStart,t.inxEnd));let n=e.substring(0,t.inxStart),a=e.substring(t.inxEnd);t.wrapping_url=n+this._embedUrlToken+a,-1!==e.indexOf("go.redirectingat.com")||-1!==e.indexOf("go.skimresources.com")?t.wrapping_net="sl":-1!==e.indexOf("redirect.viglink.com")?t.wrapping_net="vg":-1!==e.indexOf("(.digidip.net%2Fvisit[S]*(url%3D))")&&(t.wrapping_net="dd")}else t.inxStart=0,t.inxEnd=e.length,t.embedded=!1,t.url=e}teDataToEventsService(e,t,i){let r;try{r=JSON.parse(JSON.stringify(this._paramsBuffer))}catch(e){this._log(e),r=this._paramsBuffer}r.uuid=e.info.xid;var s=e.info.xid;if(r.link_replaced=!1,e.anchor.hasAttribute("data-spot-rid")){let t=e.anchor.getAttribute("data-spot-rid"),i=e.anchor.getAttribute("data-orig-url"),n=e.anchor.getAttribute("data-spot-replaced");s=t,r.uuid=t,r.original_xid=e.info.xid,r.link_replaced=!0,r.orig_url=i,r.link_replace_to=n}if(void 0===s&&e.anchor.hasAttribute("data-xid")&&(s=e.anchor.getAttribute("data-xid")),e.anchor.hasAttribute("data-orig-url")&&(r.anchor_orig=e.anchor.getAttribute("data-orig-url")),r.client_time=(new Date).toISOString(),r.anchor_id=this._emptyIfNull(e.anchor.id),r.anchor_href=e.anchor.href,r.anchor_label=e.anchor.innerText,r.page_title=document.title,r.spot_id="",r.network=e.info.network,null!=t&&(r.event_type=t),e.anchor.hasAttribute("data-affiliation-url")&&(r.anchor_href=e.anchor.getAttribute("data-affiliation-url"),r.network=this._detectKnownAffiliateLink(r.anchor_href,{})),e.anchor.hasAttribute("data-vars-link-id")&&(void 0===r.metadata&&(r.metadata={}),r.metadata.linkid=e.anchor.getAttribute("data-vars-link-id")),void 0!==e.anchor.attributes)for(var n=e.anchor.attributes,a="",o=n.length-1;o>=0;o--)(n[o].name.indexOf("trx-vars-")>-1||n[o].name.indexOf("affluent-details-")>-1)&&(void 0==r.link_meta&&(r.link_meta={}),(a=n[o].value.replace(/[^a-z0-9A-Z \-\_]/gi,"")).length>256&&(a=a.slice(0,256)),r.link_meta[n[o].name.replace("trx-vars-","").replace("affluent-details-","")]=a);if(null!=i&&"object"==typeof i)for(let e in i)i.hasOwnProperty(e)&&0===e.indexOf("custom_")&&(r[e]=i[e]);let l=this._envSettings.events_recording_api+"/write",d={env:this._envSettings.events_recording_env,id:s,app_key:this._envSettings.app_key,property_id:r.property_id,customer_id:r.customer_id,cidp1:r.cidp1,cidp2:r.cidp2,event_type:r.event_type,network:r.network,data:encodeURIComponent(JSON.stringify(r))},c=JSON.stringify(d),h=JSON.parse(c);h.data=r;let u=JSON.stringify(h),_=r.uuid;delete r.uuid,delete r.client_time,delete r.anchor_href,delete r.anchor_label,delete r.page_title,delete r.spot_id;try{if("undefined"!=typeof Storage){var f="fr_click_"+_;localStorage.setItem(f,c)}}catch(e){this._debug(e)}if(void 0!==this._envSettings.events_recording_api2){let e=this._envSettings.events_recording_api2+"/write";var g={method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrer:"*client",body:c};this._iframed&&(g.referrer=location.href),fetch(e,g).then(.then(.catch(}let m={method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrer:"*client",body:c};if(this._iframed&&(m.referrer=location.href),"AMP"==t){var p=l.match(/^https?\:\/\/([^\/?#]+)(?:[\/?#]|$)/i),b,b,k;if(void 0!==(b=(p&&p[1]).replace("www.","")))(b=b.split(".").slice(-2).join("."))==location.hostname.split(".").slice(-2).join(".")&&(this._debug("same domain"),m.credentials=m.headers=m.mode=void 0)}if(navigator.sendBeacon&&this._use_beacon){try{let e=navigator.sendBeacon(l,c)}catch(e){console.log(e)}if(this._debug("sendBeacon: URL = "+l+"; status = "+status),1==status)try{localStorage.removeItem(f)}catch(e){this._debug(e)}return status}return fetch(l,m).then(.then(t=>{if(t&&t.message){this._log(t.message);try{if("undefined"!=typeof Storage){var i=Math.round((new Date).getTime()/1e3);f="fr_log_"+i;var s=this._getLogInfomration(r);s.message=t.message,s.xid=e.info.xid,localStorage.setItem(f,JSON.stringify(s))}}catch(e){this._debug(e)}}}).catch(}pareExcludeRegExp(){this._exclude_urls_regex=[];let e=this._settings.detection_rules.exclude_urls;if(e.length>0)for(let t=0;t<e.length;t++)try{this._exclude_urls_regex.push(new RegExp(e[t],"i"))}catch(e){this._debug(e)}}pendExtraParam(e,t,i,r,s){let n=null,a=!1;var o=":";let l=!1;if(s)n=null;else switch(e){case"cj":n="sid",a=!0,o="-";break;case"ls":n="u1";break;case"sas":n="afftrack";break;case"awin":n="clickref";break;case"pj":n="sid";break;case"sl":n="xcust";break;case"vg":n="cuid";break;case"ir":n="subId3";break;case"wg":n="clickref";break;case"td":n="epi(",a=!0;break;case"pt":n="pubref:",a=!0;break;case"amazon":n="ascsubtag";break;case"al":n="ctc";break;case"at":n="epi",o="%3A";break;case"tt":-1!==t.indexOf("tc.tradetracker.net")?n="r":(n="tt",o="-");break;case"ho":n="aff_sub3",o="%3A";break;case"tc":n="ref3";break;case"bol":n="subid",o="-","xid"==i&&(i="fr-xid");break;case"afs":n="sub5",o="-";break;case"dc":n="ws3";break;case"ef":n="sub3";break;case"ebay":n="customid",-1===t.indexOf("https%3A%2F%2Fwww.ebay.com")&&-1===t.indexOf("https%3A%2F%2Febay.com")||(l=!0);break;case"rfs":n="subid";break;case"ct":n="sid";break;case"fo":n="fobs";break;case"pap":n="data1";break;case"bhp":n="SID",a=!0,o="-";break;case"eff":n="effi_id";break;case"fnc":n="subid";break;case"dd":n="ref",-1!==t.search(/\.digidip\.net%2Fvisit[\S]*(url%3D)/)&&(l=!0);break;case"afy":n="xid";break;case"rv":n="tid",o="-","xid"==i&&(i="fr-xid");break;default:n=null}return this._appendNameValueToUrl(t,i,r,n,a,e,o,l)}_appendNameValueToUrl(e,t,i,r,s,n,a,o){let l,d,c,h,u,_;if(void 0===o&&(o=!1),i=encodeURIComponent(i),void 0===a&&(a=":"),null!=r){if(u=t+a+i,s)return-1!==(l=e.indexOf(r+"/"))?(l+=(r+"/").length,-1===(d=e.indexOf("/",l))&&(d=e.length),(_=e.substring(l,d)).length>0&&(u=this._getDelimiter(e,n)+u),this._insertToString(e,u,d)):"pt"===n?this._appendNameValueToUrl_PT(e,t,i,r,u):"cj"===n?this._appendNameValueToUrl_CJ(e,t,i,r,u):"td"===n?this._appendNameValueToUrl_TD(e,t,i,r,u):(u="/"+r+"/"+u,this._insertToString(e,u,e.length));if(-1===(l=1==o?e.toLocaleLowerCase().indexOf(r.toLocaleLowerCase()+encodeURIComponent("=").toLocaleLowerCase()):e.toLocaleLowerCase().indexOf(r.toLocaleLowerCase()+"="))){a="=";var f="?";return-1!==e.indexOf("?")&&(f="&"),!0===o&&(f=encodeURIComponent(f),a=encodeURIComponent(a)),u=f+r+a+u,this._insertToString(e,u,e.length)}return 1==o?-1===(d=e.indexOf(encodeURIComponent("&").toLocaleLowerCase(),l))&&(d=e.indexOf("&",l)):d=e.indexOf("&",l),-1===d&&(d=e.length),(_=e.substring(l+r.length+1,d)).length>0&&(u=1==o?encodeURIComponent(this._getDelimiter(e,n)+u):this._getDelimiter(e,n)+u),this._insertToString(e,u,d)}return s?e+=t+"/"+i:-1!==e.indexOf("?")?e+="&"+t+"="+i:e+="?"+t+"="+i,e}_appendNameValueToUrl_TD(e,t,i,r,s){let n,a,o,l,d;return-1===(n=e.indexOf("epi("))?-1!==(n=e.indexOf("url("))?e+"epi("+s+")":-1===(o=e.indexOf("&epi="))?e+"&epi="+s:-1===(l=e.indexOf("&",o+5))?e+this._getDelimiter(e)+s:(s=this._getDelimiter(e)+s,this._insertToString(e,s,l)):(n+=r.length,-1!==(a=e.indexOf(")",n))?((d=e.substring(n,a)).length>0&&(s=this._getDelimiter(e)+s),this._insertToString(e,s,a)):e)}(e){return"true"===e||!0===e}etDelimiter(e,t){return e.includes("assoc-redirect.amazon")?this._delimiter2:this._isCJ(e)?this._delimiter4:"ho"==t||"at"==t?encodeURI(this._delimiter1):"tt"==t&&-1===e.indexOf("tc.tradetracker.net")?this._delimiter4:"bol"==t?this._delimiter4:"rv"==t?this._delimiter4:"afs"==t?this._delimiter4:this._delimiter1},trx.get={};trx.get.category = trx.GATracker=trx.AdobeTracker=let e=void 0,t="prod",i=!0,r=document.getElementById("funnel-relay-installer");null!=r&&r.hasAttribute("data-autorun")&&(i="false"!==r.getAttribute("data-autorun"));let n=3e3,a="{START_DELAY}",o=parseInt("{START_DELAY}");Number.isInteger(o)&&(n=o),void 0==trx.global_trace&&(trx.global_trace=[]),n>0?setTimeout(()=>{trx.magicLinksEngine=new trx.MagicLinks(i),trx.magicLinksEngine._runFRCallback()},n):(trx.magicLinksEngine=new trx.MagicLinks(i),trx.magicLinksEngine._runFRCallback());/* Spot version 2.6.16  - do the magic here 2022-08-03 11:11 */
trx.SpotClient=class{constructor(e,t){this._frClient=e,null==t&&(t={}),this._options=t,this._settingsLoaded=!1,this._websiteId=null,this._pageId=null,this._actionLinks=[],this._asinRules={},this._spotSettings={"s3_rule_action_links_url":"https:\/\/fr-actions.trackonomics.net\/prod"},this._dataset={uri:{},asin:{}},this._autoRun=this._asBoolean(!0),this._reportEnabled=this._asBoolean(t.report_enabled),this._report={links:[],activity:[]},this._refDate=0}et autoRun(e){this._autoRun=e}c applyRules(){if(this._logActivity("Rules actions were found for this page and will be apply depending on spot feature settings."),this._asBoolean(this._frClient._settings.features.spot.enabled)){let e=!1;if(this._asBoolean(this._frClient._settings.features.spot.link_rules)?(!1!==(e=await this._loadPageActionLinks())&&(this._websiteId=e.website_id,this._pageId=e.page_id,this._actionLinks=e.action_links,this._settingsLoaded=!0,this._reportEnabled&&(this.report.num_actions=Object.keys(this._actionLinks).length)),this._prepareAnchorURI(),void 0!==this._actionLinks&&Object.keys(this._actionLinks).length>0?(this._logActivity("Checking link_rules."),this._applyLinkRules()):this._logActivity("link_rules no rules to apply.")):this._logActivity("link_rules feature is disabled."),this._asBoolean(this._frClient._settings.features.spot.asin_rules)?(!1!==(e=await this._loadAsinsPerEnv())&&(this._asinRules=e.asins,this._settingsLoaded=!0,this._reportEnabled&&(this.report.num_asins=Object.keys(this._asinRules).length)),void 0!==this._asinRules&&Object.keys(this._asinRules).length>0?(this._dataset.asin=this._frClient._prepareAnchorASIN(),this._applyASINRules(),this._logActivity("Checking asin_rules.")):this._logActivity("link_rules no rules to apply.")):this._logActivity("asin_rules feature is disabled."),this._asBoolean(this._frClient._settings.features.spot.asin_per_page)){let t=this._getAllPerPageAnchors();t.length>0?!1!==(e=await this._loadLogic("/{l}/{c}/{p}/{u}/{i}","pp","tags.json"))&&this._applyPerPageLogic(e,t):this._logActivity("no asin to replace.")}else this._logActivity("asin_per_page feature is disabled.");this._asBoolean(this._frClient._settings.features.spot.direct_deals)?(e=await this._loadLogic("/{l}/{c}/{u}/{i}","pl","place.json"),void 0===trx.LZString?this.error("Fail to load the LZ lib."):!1!==e&&void 0!==trx.LZString&&this._applyDirectDealsLogic(e)):this._logActivity("direct deals feature is disabled.")}}ync _loadLogic(e,t,i){let a=this._frClient._customerId,r=a.split("_"),n=r[0],s=a.replace(r[0]+"_"+r[1]+"_",""),o=this.getWebPageURI();var l=e.replace("{l}",t).replace("{c}",n).replace("{p}",s).replace("{u}",o).replace("{i}",i).replace("//","/");let d=(this._spotSettings.s3_rule_action_links_url+l).toLowerCase();const _=await fetch(d);return _.ok?await _.json():403!==_.status&&(this._logWarning(`Fail to read rule's logic for page from S3. Possibly file does not exist on S3. Status: ${_.statusText} Code: ${_.status}`),!1)}AllPerPageAnchors(){let e=[];for(let t=0;t<document.links.length;t++){let i=document.links[t],a=i.href,r=i.getAttribute("data-orig-url");((-1!==a.indexOf("/dp/")||a.indexOf(encodeURIComponent("/dp/")))&&-1!==a.indexOf("amazon.")||(-1!==a.indexOf("/gp/")||a.indexOf(encodeURIComponent("/gp/")))&&-1!==a.indexOf("amazon.")||-1!=a.indexOf("/amzn.")||-1!=a.indexOf("/www.amzn.")||-1!=a.indexOf(".amazon-adsystem.com"))&&e.push(i)}return e}applyDirectDealLogic(e){let t=this._frClient._generateUUID();var i=e.aff_link.replace("%7bxid%7d",t);i=(i=(i=(i=i.replace("%7boffer_id%7d",e.offer_id)).replace("%7bcampaign_id%7d",e.campaign_id)).replace("%7badtype%7d",e.ad_unit)).replace("%7bclick_type%7d","cpc");var a=["%26srcref%3D","%26imp_ref_url%3D"],r=a[0]+encodeURIComponent(location.href),n=this._frClient._paramsBuffer.referrer;if(void 0==n&&void 0!==this._frClient._paramsBuffer.page_trace&&void 0!==this._frClient._paramsBuffer.page_trace[0]&&void 0!==this._frClient._paramsBuffer.page_trace[0].referrer&&(n=this._frClient._paramsBuffer.page_trace[0].referrer),r=r+a[1]+encodeURIComponent(n),void 0!==e.placement){var s=trx.LZString.decompressFromEncodedURIComponent(e.placement);let n=document.createElement("div");n.style="margin: 40px 0px;",n.className="trx_ppp",s=(s=s.replace("{tracking_url}",i+r)).replace("{affiliate_link}",i+r),n.innerHTML=s;var o=document.querySelector(e.placement_positions);if(null===o&&e.optional_placement_positions&&Object.keys(e.optional_placement_positions).length>0)for(let t in e.optional_placement_positions)if(null!==(o=document.querySelector(e.optional_placement_positions[t])))break;if(null!==o){var l=i.indexOf("q=");if(-1!==l){var d=i.indexOf("&p=");if(-1!==d)var _=i.substring(l+2,d);else var _=i.substring(l+2);_.length>0&&(_=decodeURIComponent(_).replace("/c/","/i/")+r.replace(a[0],decodeURIComponent(a[0])).replace(a[1],decodeURIComponent(a[1])),n.innerHTML+="<img src='"+_+"' style='display:none;'/>")}o.appendChild(n),this._recordDirectDealsImp(e,t)}else if("undefined"!=typeof Storage){var c,p="fr_log_"+Math.round((new Date).getTime()/1e3),h={},u=this._frClient._getLogInfomration(h);u.url=window.location.href,u.message="cannot place ad on page.",localStorage.setItem(p,JSON.stringify(u))}}else if("text"==e.ad_unit){let a=document.getElementsByTagName("body")[0].innerHTML;var f=new RegExp(e.keywords,"i");a=a.replace(f,'<a href="'+i+r+'" class="trx_ppp_txt" target="_blank" >'+e.keywords+"</a>"),document.getElementsByTagName("body")[0].innerHTML=a,this._recordDirectDealsImp(e,t)}}applyPerPageLogic(e,t){if(void 0!==e.replace&&void 0!==e.replace.amazon||void 0!==e.all&&void 0!==e.all.amazon||void 0!==e.add&&void 0!==e.add.amazon){let d=0,_=0,c=0,p=0;var i={};for(var a in void 0!==e.all&&(e.all=this._perPageCleanParams(e.all)),void 0!==e.replace&&(e.replace=this._perPageCleanParams(e.replace)),void 0!==e.add&&(e.add=this._perPageCleanParams(e.add)),t){let i=t[a];if(i.hasAttribute("data-spot-replaced"))continue;void 0!==e.sl&&void 0!==i.href&&void 0!==e.sl&&void 0!==e.sl[i.href]&&(i.setAttribute("data-orig-url",i.href),i.href=e.sl[i],p+=1);let h=i.href,u=i.getAttribute("data-orig-url");this._isEmpty(u)||(h=u),u=h;let f=this._pageId;null==f&&(f="");let g=this._frClient.parseQueryString(u),m="";this._isEmpty(g.tag)||(m=g.tag);let v=this._frClient._detectKnownAffiliateLink(i.href,{});var r=!1;void 0!==e.all&&(r=this._perPageReplaceParams(i,e.all.amazon,r)),void 0!==e.replace&&(r=this._perPageReplaceParams(i,e.replace.amazon,r));var n=!1;if(!1===r&&(-1!==h.indexOf("/dp/")||-1!==h.indexOf("/gp/")||-1!==h.indexOf(encodeURIComponent("/dp/"))||-1!==h.indexOf(encodeURIComponent("/gp/")))){""!==v&&null!==v||(v="amazon");var s=!1;-1===h.indexOf(encodeURIComponent("/dp/"))&&-1===h.indexOf(encodeURIComponent("/gp/"))||(s=!0),void 0!==e.all&&(n=this._perPageAppendParams(i,e.all.amazon,n,s)),void 0!==e.add&&(n=this._perPageAppendParams(i,e.add.amazon,n,s))}if(!0===n||!0===r){if(!i.hasAttribute("data-xid")){let e=this._frClient._generateUUID();i.setAttribute("data-xid",e)}i.setAttribute("data-orig-url",u),i.setAttribute("data-spot-replaced","1")}if(!1===r&&!1===n)continue;var o={20:"United States"};if("ge"==v&&void 0!==e.all&&void 0!==e.all.amazon.tag&&void 0!==permutive&&void 0!==permutive.context&&void 0!==permutive.context.country){var l=e.all.amazon.tag.split("-");if(l.length>0&&-1!==o[l[l.length-1]]&&o[l[l.length-1]]==permutive.context.country&&(i.href=i.href.replace(/(TSID=[\d]*&)/,""),!i.hasAttribute("data-xid"))){let e=this._frClient._generateUUID();i.setAttribute("data-xid",e)}}let y={orig_url:u,url:i.href};this._reportEnabled&&this._report.links.push(y);let k={network:v,anchor:i,info:y};this._clickRebind(k),d+=1,!0===r&&(c+=1),!0===n&&(_+=1)}d>0&&this._frClient._runFeatures(),this._logActivity(`Action applied for rule per page '${d}' , switched tag '${c}', reattributed '${_}', short links opend '${p}' `)}}I(e,t,i,a){a=this.decodeHtmlSpecialChars(a),a=this.replaceAll(a,"\n","");let r=e+t+i+(a=this.replaceAll(a,"\r",""));return trx.md5?trx.md5(r):md5?md5(r):(this.error("Fail to load the md5 function. Spot's links recognition will not work properly."),a)}or(e){console.error(e),this._reportEnabled&&this.report.activity.push("E::"+e)};}();
//@formatter:off
trx.run_md5 = !this);
//@formatter:on
trx.LZString=);"function"==typeof define&&define.amd?define("trx.LZString",:"undefined"!=typeof module&&null!=module&&(module.exports=trx.LZString);