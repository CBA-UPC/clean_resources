![function(e,t,r){"use strict";r.d(t,"c",(function(){return l.c})),r.d(t,"b",(function(){return P})),r.d(t,"a",(function(){return M}));var n=r(3),i=r(0);onst o=a=var d=r(7),u=r(6),c=r(10),l=r(5);
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const h=let p=!0;void 0===window.ShadyCSS?p=!1:void 0===window.ShadyCSS.prepareTemplateDom&&(console.warn("Incompatible ShadyCSS version detected. Please update to at least @webcomponents/webcomponentsjs@2.0.2 and @webcomponents/shadycss@1.3.1."),p=!1);const f=g=["html","svg"],m=new Set,_=window.JSCompiler_renameProperty=const v={toAttributefromAttribute,w=b={attribute:!0,type:String,converter:v,reflect:!1,hasChanged:w};class S extends HTMLElement{let r=!0;if(void 0!==e){const n=this.constructor,i=n.getPropertyOptions(e);n._valueHasChanged(this[e],t,i.hasChanged)?(this._changedProperties.has(e)||this._changedProperties.set(e,t),!0!==i.reflect||16&this._updateState||(void 0===this._reflectingProperties&&(this._reflectingProperties=new Map),this._reflectingProperties.set(e,i))):r=!1}!this._hasRequestedUpdate&&r&&(this._updatePromise=this._enqueueUpdate())}t _hasRequestedUpdate(){return 4&this._updateState}erformUpdate(){this._instanceProperties&&this._applyInstanceProperties();let e=!1;const t=this._changedProperties;try{e=this.shouldUpdate(t),e?this.update(t):this._markUpdated()}catch(t){throw e=!1,this._markUpdated(),t}e&&(1&this._updateState||(this._updateState=1|this._updateState,this.firstUpdated(t)),this.updated(t))}etUpdateComplete(){return this._updatePromise}dated(e){}S.finalized=!0;
/**
@license
Copyright (c) 2019 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
const y="adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,E=Symbol();onst P=
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
(window.litElementVersions||(window.litElementVersions=[])).push("2.3.1");const O={};.finalized=!0,M.render=,function(e,t,r){"use strict";r.d(t,"b",(function(){return o.a})),r.d(t,"a",(function(){return n.b})),r.d(t,"c",(function(){return a}));var n=r(1);
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */const i=new var s=r(9),o=r(8);r(3),r(2),r(7),r(6),r(10),r(0);
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
"undefined"!=typeof window&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.3.0");const a=,function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));const n={SIMPLIFIED_URL_AD_FETCH_ERROR:{message:"SIMPLIFIED_URL_AD_FETCH_ERROR",priority:"P2"},SIMPLIFIED_URL_AD_RENDER_ERROR:{message:"SIMPLIFIED_URL_AD_RENDER_ERROR",priority:"P2"},AD_POST_MESSAGE_ERROR:{message:"AD_POST_MESSAGE_ERROR",priority:"P1"},AD_IMPRESSION_URL_NOT_FOUND:{message:"AD_IMPRESSION_URL_NOT_FOUND",priority:"P3"},UCI_CONFIG_NOT_FOUND:{message:"UCI_CONFIG_NOT_FOUND",priority:"P0"},SLOT_INVALID:{message:"SLOT_INVALID",priority:"P0"},GPT_AD_CREATION_FAILED:{message:"GPT_AD_CREATION_FAILED",priority:"P0"},EXPERIMENTS_ERROR:{message:"EXPERIMENTS_ERROR",priority:"P2"},EXPERIMENTS_NOT_FOUND:{message:"EXPERIMENTS_NOT_FOUND",priority:"P2"},EXPERIMENTS_TIMED_OUT:{message:"EXPERIMENTS_TIMED_OUT",priority:"P2"},EXPERIMENTS_CONFIG_INVALID:{message:"EXPERIMENTS_CONFIG_INVALID",priority:"P2"},EXPERIMENTS_QUEUE_NOT_DEFINED:{message:"EXPERIMENTS_QUEUE_NOT_DEFINED",priority:"P2"},GPT_LAZY_LOAD_ERROR:{message:"GPT_LAZY_LOAD_ERROR",priority:"P0"},GPT_INVALID_ARGS_ERROR:{message:"GPT_INVALID_ARGS_ERROR",priority:"P0"},SLOT_RENDERED_REGISTRATION_FAILED:{message:"SLOT_RENDERED_REGISTRATION_FAILED",priority:"P3"},CAROUSEL_FETCH_ERROR:{message:"CAROUSEL_FETCH_ERROR",priority:"P1"},CAROUSEL_CLICK_ERROR:{message:"CAROUSEL_CLICK_ERROR",priority:"P1"},NATIVE_AD_INVALID_JSON:{message:"NATIVE_AD_INVALID_JSON",priority:"P0"},SCHEMA_VALIDATION_FAILURE:{message:"SCHEMA_VALIDATION_FAILURE",priority:"P0"},NATIVE_TILE_BACKGROUND_POSITION_ERROR:{message:"NATIVE_TILE_BACKGROUND_POSITION_ERROR",priority:"P1"},INVALID_IMPRESSION_LOG:{message:"INVALID_IMPRESSION_LOG",priority:"P2"},IMPRESSION_LOG_SUCCESSFUL:{message:"IMPRESSION_LOG_SUCCESSFUL",priority:"P3"},PRIVACY_SETTINGS_FAILURE:{message:"PRIVACY_SETTINGS_FAILURE",priority:"P2"},PRIVACY_SETTINGS_NOT_FOUND:{message:"PRIVACY_SETTINGS_NOT_FOUND",priority:"P2"},INVALID_ADX_RESPONSE:{message:"INVALID_ADX_RESPONSE",priority:"P2"},MISSING_PARTNER_CODE_FROM_CARS_BRL:{message:"MISSING_PARTNER_CODE_FROM_CARS_BRL",priority:"P3"},UNFILLED_AD:{message:"UNFILLED_AD",priority:"P3"},AD_RESPONSE_SERVED:{message:"AD_RESPONSE_SERVED",priority:"P3"},AD_REQUEST_ERROR:{message:"AD_REQUEST_ERROR",priority:"P2"}}},function(e,t,r){"use strict";var n=r(15),i=r(14);class s{constructor(e){this.moduleName=e,this.isDebugLoggingEnabled=window.location&&window.location.search&&window.location.search.includes("debug=true")}static setSessionConfigendLogPayload(e,t,r){window.meso=window.meso||{},window.meso.logging=window.meso.logging||[],s.setSessionConfig(window.meso.pageInfo);const o=Object.assign({type:e,moduleName:this.moduleName},t&&t.message?t:{message:t},s.config,{details:r},i.e);window.meso.logging.push({logs:o,platform:n.a.logging.platform,timestamp:i.a,epoch:Date.now()})}info(e,t){this.sendLogPayload("info",e,t)}rror(e,t,r){const n=t instanceof Error||"object"==typeof t?{message:t.message}:{message:""+t};this.sendLogPayload("error",e,Object.assign({exception:n},r))}trackEvent(e,t,r){this.sendLogPayload("track-event",{name:e,vars:t,events:r})}ebug(e,t){this.isDebugLoggingEnabled&&console.info(`${performance.now()} ${this.moduleName}:${e}`,t||{})}perf(e,t){if(t&&t.mark&&performance.getEntriesByName(t.mark).length>0){const{mark:e}=t;performance.measure("Performance Measure",e),t.duration=performance.getEntriesByType("measure")[0].toJSON().duration,performance.clearMeasures(),delete t.mark}this.sendLogPayload("perf",e,t)}}const o={};window.addEventListener("mesoRender",,t.a=e=>(o[e]||(o[e]=new s(e)),o[e])},function(e,t,r){"use strict";const n=t.a={promiseFetch:(e,t={})=>{const r=t&&t.timeout||5e3;return Promise.race([fetch(e,t),new Promise(])},sanitizeProtocol:n,fireBeacon:e=>{e=n(e),(new Image).src=encodeURI(e)}}},function(e,t,r){"use strict";r.d(t,"e",(function(){return s})),r.d(t,"a",(function(){return a})),r.d(t,"c",(function(){return d})),r.d(t,"b",(function(){return u})),r.d(t,"d",(function(){return c}));r(20),r(13);r(22);var n=r(18),i=r.n(n);const s=(()=>{if(window&&window.navigator&&window.navigator.userAgent){const e=i.a.getParser(window.navigator.userAgent);return{userAgent:e.getUA(),userAgentName:e.getBrowserName(),userAgentVersion:e.getBrowserVersion(),userAgentDeviceType:e.getPlatformType()}}})(),o=a=(()=>{const e=new Date;return`${e.getUTCFullYear()}-${o(e.getUTCMonth()+1)}-${o(e.getUTCDate())}T${o(e.getUTCHours())}:${o(e.getUTCMinutes())}:${o(e.getUTCSeconds())}`})(),d=function(e,t){return new Promise((r,n)=>{const i=setTimeout(()=>{clearTimeout(i),n(new Error(t))},e)})},u=()=>window&&window.location&&window.location.href||"",c=(e,t,r)=>{const n=new URL(e);return n.searchParams.set(t,r),n.href}},function(e,t,r){"use strict";var n=r(17);let i;i={environmentName:"Production",environmentShort:"PROD",dfp:{network:"23171577"},proxy:"https://www.uciservice.com/ds/api/v1/proxy",deeplink:"https://www.uciservice.com/deeplink"};const s=r.n(n)()({appName:"ads-templates",dfp:{gpt:"https://www.googletagservices.com/tag/js/gpt.js",network:"11850712",surl:"https://pubads.g.doubleclick.net/gampad/adx",gptlight:"https://securepubads.g.doubleclick.net/static/glade.js"},abacus:{endpoint:"/api/bucketing/v1"},proxy:"https://ads-delivery-service.us-west-2.test.meso.expedia.com/api/v1/proxy",deeplink:"https://deep-link-service.us-west-2.test.meso.expedia.com",others:{hotelLinkDirect:{holdoutPercentage:20}},logging:{platform:"Web"}},i);t.a=s},function(e,t,r){"use strict";t.a=(e,t)=>{if("string"!=typeof e)throw new Error("registerComponent requires a name of type string");if(!t)throw new Error("registerComponent requires a valid component");window&&customElements&&void 0===customElements.get(e)&&(customElements.define(e,t),document.dispatchEvent(new CustomEvent("mesoAdTagRegistered",{detail:{name:e}})))}},function(e,t,r){"use strict";r.d(t,"c",(function(){return i})),r.d(t,"a",(function(){return s})),r.d(t,"b",();var n={displayAd:["CM1","CM2","CM3","CM4","CM5","CM6","CT1","CT2","CT3","CT4","CT5","R1","R2"],nativeAd:["NMC1","NMC2","NMC3","NTS1","RL1","RL2"]};const i=(e,t)=>{if(!t||!t.slot)return;const r=t.slot.getAdUnitPath(),n=t.slot.getSizes();if(!r||!n||n.length<1)return;const i="fluid"===n[0]?n[0]:n[0].getWidth(),s="fluid"===n[1]?n[0]:n[0].getHeight();return(i===e.width&&s===e.height||e.isfluid)&&r===e.adpath},s=e=>"string"==typeof e?e.split("/").pop():e,o=e=>-1!==n.displayAd.indexOf(e.toUpperCase())?"displayAd":-1!==n.nativeAd.indexOf(e.toUpperCase())?"nativeAd":e},function(e,t,r){"use strict";const n=e=>{const t=document.cookie.match(`(^|;) ?${e}=([^;]*)(;|$)`);return t?t[2]:null},i=(e,t,r=30)=>{const n=new Date;n.setTime(n.getTime()+864e5*r),document.cookie=`${e}=${t};path=/;expires=${n.toGMTString()};`},s=o=()=>{const e=n("tpid");return null!==e&&e.match(/^.*,[0-9]+$/)?e.split(",")[1]:null},a=()=>{const e=n("iEAPID");return null!==e&&e.match(/^[0-9]+$/)?e:null};t.a={getGuid:s,getCookie:n,setCookie:i,deleteCookie:parseSiteInfo:()=>({user:s(),guid:s(),site:1,tpid:o(),eapid:a(),abov:n("abov")}),parseOverrideExperiments:()=>{try{const e={},t=n("meov");return(null===t?[]:t.split(",")).forEach(,e}catch(e){return{}}}}},,function(e,t,r){"use strict";t.a={isObject:isTrue:e=>!0===e||"true"===e||"1"===e||1===e||"string"==typeof e&&"true"===e.toLowerCase(),verifyModel:(e,t,r)=>{const n=t.find(t=>void 0===((e,t)=>e.split(".").reduce((e,t)=>{if(e&&e[t]){if(e[t].length&&e[t].length<1)return;return e[t]}},t))(t,e));if(n&&n.length){throw new Error(`missing component properties from GAM - creative id: ${r} - missing: ${n}`)}return!0}}},,,,function(e,t,r){"use strict";var n=()=>{const e={promise:null,resolve:null,reject:null,isResolved:!1};return e.promise=new Promise((t,r)=>{e.resolve=e.reject=r}),e},i=r(12),s=r(11);const o=Object(i.a)("experiments-handler-v2");let a={},d=[];const u=e=>{e&&e.detail&&("initialize"!==e.detail.type&&"update"!==e.detail.type||e.detail.experiments&&(a=Object.assign({},a,e.detail.experiments),d=d.filter(e=>!e.checkExperiments(a))))};window&&"function"==typeof window.addEventListener&&window.addEventListener("mesoExperiments",u),window&&"function"==typeof window.dispatchEvent&&window.dispatchEvent(new CustomEvent("mesoExperiments",{detail:{type:"register"}}));t.a=class{constructor(e=[]){this._requested=Array.isArray(e)?e:[e],this._configured=this._buildExperimentConfig(),this._resolvable=this._resolvableExperiments(),this._TIMEOUT=500,this._completePromise=n()}checkExperiments(e){const t=!(this._resolvable.length>0)||this._resolvable.every(t=>e.hasOwnProperty(t));return t&&this._completePromise.resolve(this.getBuckets()),t}_resolvableExperiments(){const{resolvable:e,missing:t}=this._requested.reduce((e,t)=>(this._configured.includes(t)?e.resolvable.push(t):e.missing.push(t),e),{resolvable:[],missing:[]});return t.length>0&&o.warn(s.a.EXPERIMENTS_NOT_FOUND,{description:"Requested experiments were not found in configuration",configured:this._configured,requested:this._requested,resolvable:e,missing:t,methodName:"_resolvableExperiments"}),e}_buildExperimentConfig(){let e=window&&window.meso&&window.meso.experiments&&window.meso.experiments.configuredExperimentNames||[];Array.isArray(e)||(o.warn(s.a.EXPERIMENTS_CONFIG_INVALID,{description:"Configured experiments was not an array as expected",configuredExperiments:e,methodName:"_buildExperimentConfig"}),e=[]);let t=window&&window.meso&&window.meso.experiments&&window.meso.experiments.configuredOverrideNames||[];return Array.isArray(t)||(o.warn(s.a.EXPERIMENTS_CONFIG_INVALID,{description:"Configured overrides was not an array as expected",configuredOverrides:t,methodName:"_buildExperimentConfig"}),t=[]),[...e,...t]}getBuckets(){return this._requested.reduce((e,t)=>(this._resolvable.includes(t)?e[t]=a.hasOwnProperty(t)?a[t]:null:e[t]=null,e),{})}xposureLog(e){if(Array.isArray(e)||"string"==typeof e){const t={type:"exposure",experiments:e=(e=Array.isArray(e)?e:[e]).map(};window.meso=window.meso||{},window.meso.experiments=window.meso.experiments||[],window.meso.experiments.push(t)}}wait(){if(window&&window.meso&&void 0===window.meso.experiments)return o.warn(s.a.EXPERIMENTS_QUEUE_NOT_DEFINED,{description:"window.meso.experiments is not defined.",requested:this._requested,methodName:"wait"}),Promise.resolve(this.getBuckets());const e=Promise.race([this._completePromise.promise,new Promise(e=>{setTimeout(()=>{const t=this._resolvable.filter(e=>a.hasOwnProperty(e)),r=this._resolvable.filter(;r.length>0&&o.warn(s.a.EXPERIMENTS_TIMED_OUT,{description:`Experiments timed out in ${this._TIMEOUT} before evaluating all requested experiments`,requested:this._requsted,resolvable:this._resolvable,configured:this._configured,resolved:t,timedout:r,methodName:"wait"}),e(this.getBuckets())},this._TIMEOUT)})]);var t;return(t=this).checkExperiments(a)||d.push(t),e}get timeout(){return this._TIMEOUT}},,,,,,,,function(e,t,r){"use strict";t.a={chunkCallback:e=>requestAnimationFrame&&requestAnimationFrame(e)||setTimeout(e,0)}},,,function(e,t,r){"use strict";var n=r(12),i=r(11);const s=Object(n.a)("meso-ads-render-register");window.meso||(window.meso=window.meso||{}),window.meso.onAdsRendered||(window.meso.onAdsRendered=[]);t.a=class{static registerOnAfterRender(e,t){e&&Array.isArray(window.meso.onAdsRendered)?window.meso.onAdsRendered.push({callback:e,comparator:t}):s.error(i.a.SLOT_RENDERED_REGISTRATION_FAILED,new Error("Invalid arguments"))}static getAllRegisteredCallBack(){return window.meso.onAdsRendered?window.meso.onAdsRendered:[]}static deRegisterOnAfterRender(e){if(e)for(let t=0;t<window.meso.onAdsRendered.length;t++)window.meso.onAdsRendered[t].callback===e&&window.meso.onAdsRendered.splice(t,1)}}},,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";r.r(t);var n=r(4),i=r(19),s=r(20),o=r(27),a=r.n(o),d=r(35);const u=e=>!0===e?"1":!1===e?"0":Array.isArray(e)?String(e.map(e=>u(e))):String(e),c=e=>new Promise(t=>{null!=e&&0!==String(e).length&&d.a.chunkCallback(()=>{Array.isArray(e)||(e=[e]),t(window.googletag.pubads().refresh(e))})});let l=[];const h=a()(()=>Promise.all(l).then(e=>(l=[],c(e))),0);var p=(e,t,r)=>new Promise(n=>{window&&window.googletag&&window.googletag.pubads()&&window.googletag.pubads().getSlots()&&window.googletag.pubads().getSlots().length>=1&&window.googletag.pubads().getSlots().forEach(e=>{r===e.getSlotElementId()&&n(e)}),n(window.googletag.defineSlot(e,t,r).addService(window.googletag.pubads()))}),f=(e,t)=>new Promise(r=>{d.a.chunkCallback(()=>{r(window.googletag.defineOutOfPageSlot(e,t).addService(window.googletag.pubads()))})}),g=e=>new Promise(t=>{Array.isArray(e)||(e=[e]),t(window.googletag.destroySlots(e))}),m=e=>new Promise(t=>{d.a.chunkCallback(}),_=e=>(l.push(e),h()),v=(e,t={})=>new Promise((r,n)=>{d.a.chunkCallback(()=>{e&&"function"==typeof e.setTargeting||n(new Error("Invalid target specified for setting ad targeting")),Object.keys(t).forEach(r=>{t[r]=u(t[r]),e.setTargeting(r,t[r])}),r(t)})}),w=r(39),b=r(26),S=r(12),y=r(11);const E=Object(S.a)("gpt-manager");window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[];let A={};const P=["canSell"],O=new b.a(["MeSo_GPT_SRA"]);let M=!0;const R=e=>{if(!e.isEmpty){let t,r,n;try{n=e.slot.getAdUnitPath(),t=Object(i.a)(n),r=Object(i.b)(t),E.info(y.a.IMPRESSION_LOG_SUCCESSFUL,{advertiserId:e.advertiserId,adProductType:r,adStack:"ADS",campaignId:e.campaignId,creativeId:e.creativeId,description:"Render impression logged successfully",lineItemId:e.lineItemId,methodName:"_handleSlotRenderEnded",size:e.size,slot:t,source:n})}catch(i){E.warn(y.a.INVALID_IMPRESSION_LOG,{adProductType:r,adStack:"ADS",error:Error(i),message:"SlotRenderEndedEvent: "+JSON.stringify(e),methodName:"_handleSlotRenderEnded",slot:t,source:n})}}w.a.getAllRegisteredCallBack().forEach(t=>{(!t.comparator||"function"==typeof t.comparator&&t.comparator(e))&&t.callback(e)})},N=e=>{let t,r,n,s;try{n=e.slot.getAdUnitPath(),t=Object(i.a)(n),r=Object(i.b)(t),s=e.slot.getResponseInformation(),null===s?E.info(y.a.UNFILLED_AD,{adProductType:r,adStack:"ADS",description:"Ad was not filled: either no line item matched ad request or matching line items did not fill ad request",message:"SlotResponseReceivedEvent: "+JSON.stringify(e),methodName:"_handleSlotResponseReceived",slot:t,source:n}):E.info(y.a.AD_RESPONSE_SERVED,{advertiserId:s.advertiserId,adProductType:r,adStack:"ADS",campaignId:s.campaignId,description:"Ad server response served ad content",creativeId:s.creativeId,lineItemId:s.lineItemId,message:"SlotResponseReceivedEvent: "+JSON.stringify(e),methodName:"_handleSlotResponseReceived",slot:t,source:n})}catch(i){E.warn(y.a.AD_REQUEST_ERROR,{adProductType:r,adStack:"ADS",error:Error(i),message:"SlotResponseReceivedEvent: "+JSON.stringify(e),methodName:"_handleSlotResponseReceived",slot:t,source:n})}},T=(e,t)=>new Promise(r=>{window.googletag.cmd.push(()=>{if(!window.googletag.pubadsReady){(e=>{!1===e.canSell&&window.googletag.pubads().setPrivacySettings({restrictDataProcessing:!0})})(e),window.googletag.pubads().disableInitialLoad();const r=s.a.getCookie("eg_ppid");r&&window.googletag.pubads().setPublisherProvidedId(r),window.googletag.pubads().setForceSafeFrame(!0),window.googletag.pubads().set("page_url",window.location.href.toString()),window.googletag.pubads().addEventListener("slotRenderEnded",R),window.googletag.pubads().addEventListener("slotResponseReceived",N),Object.keys(A).forEach(e=>{window.googletag.pubads().setTargeting(e,A[e])}),window.googletag.pubads().enableLazyLoad({fetchMarginPercent:-1,renderMarginPercent:50,mobileScaling:2}),M=!0,n=t.MeSo_GPT_SRA||null,1===parseInt(n,10)&&window.googletag.cmd.push(}var n;r()})}),I=e=>new Promise(t=>{document.addEventListener("MesoTargeting",r=>{r&&r.detail&&("update"===r.detail.type||"gpt_update"===r.detail.type)&&r.detail.targeting&&!(e=>Object.keys(e).length<=1)(r.detail.targeting)&&(A=r.detail.targeting,t(e))}),document.dispatchEvent(new CustomEvent("MesoTargeting",{detail:{type:"register"}}))}),C=new Promise(e=>O.wait().then(t=>e(t),t=>{E.warn(y.a.EXPERIMENTS_TIMED_OUT,{description:t,methodName:"evaluateExperiments"}),e({})})).then(e=>I(e).then(e=>T(((e=P)=>{let t={};return window&&window.meso&&window.meso.privacy?t=e.reduce((e,t)=>{try{e[t]=window.meso.privacy.get(t)}catch(e){E.warn(y.a.PRIVACY_SETTINGS_FAILURE,{description:e.message,methodName:"getPrivacySettingsForKeys"})}return e},t):E.warn(y.a.PRIVACY_SETTINGS_NOT_FOUND,{description:"privacy settings not found on window object",methodName:"getPrivacySettingsForKeys"}),t})(),e).then(new Promise(e=>{window.googletag.cmd.push(()=>{window.googletag.pubadsReady||window.googletag.enableServices(),e()})}))));let x,L=[];const F=(e={})=>0===Object.keys(e).length?Promise.resolve():(x||(x=setTimeout(()=>{const t=new Promise(t=>{window.googletag.cmd.push(()=>{Object.keys(e).length>0&&t(v(window.googletag.pubads(),e))})});L.forEach(e=>e(t)),L=[],x=null},0)),new Promise();class k{pdateSlotTargeting(e={}){const t=this.adslotPromise;return Object.keys(e).length>0?t.then(:t}display(e={}){return Promise.all([this.adslotPromise,F(A),this.updateSlotTargeting(e)]).then(()=>m(this.element))}refresh(e={}){return Promise.all([this.adslotPromise,F(A),this.updateSlotTargeting(e)]).then(}etAdSlotPromise(){return this.adslotPromise}}const D={slotRequested:new Set,slotRenderEnded:new Set,impressionViewable:new Set,slotOnloadEvent:new Set,slotVisibilityChangedEvent:new Set};window.googletag.cmd.push(()=>{Object.keys(D).forEach(e=>{window.googletag.pubads().addEventListener(e,})});const j=(e,t)=>{window.googletag.cmd.push(()=>{window.googletag.pubads().addEventListener(e,})},U=e=>{if(!e||!e.slot)return;const t=e.slot.getAdUnitPath(),r=e.slot.getSizes();if(!t||!r||r.length<1)return;const n="fluid"===r[0]?r[0]:r[0].getWidth(),i={detail:{slot:{path:t,height:"fluid"===r[1]?r[0]:r[0].getHeight(),width:n},collapse:e.isEmpty}};document.dispatchEvent(new CustomEvent("mesoCollapseEmptyDisplayAdSlot",i))};var B=(e={})=>{if("string"==typeof e.path&&(e.outofpage||e.size&&Array.isArray(e.size))&&e.element&&"string"==typeof e.element.id){if(e.outofpage){const t=C.then(()=>j("slotRenderEnded",U)).then(;return new k(t,e.element)}const t=C.then(.then(()=>p(e.path,e.size,e.element.id));return new k(t,e.element)}E.error(y.a.GPT_INVALID_ARGS_ERROR,new Error("Tried to construct a gpt ad without the correct arguments"),{methodName:"createGptAd"})},V=G=j,q=z=r(16);const W=Object(S.a)("meso-gpt-ad");class $ extends n.a{onstructor(){super(),this._slotTargeting={},this._gptAd=null,this._targetingLastUpdated=0,this._lastLoaded=0,this._lastRefreshed=0,this._handleSlotRenderEnded=this._handleSlotRenderEnded.bind(this),this._dispatchAdLoadEvent=this._dispatchAdLoadEvent.bind(this),this._hasAdLoadEventDispatched=!1,this._adResponseReceived=!1}connectedCallback(){W.debug(this.adpath+" connectedCallback"),super.connectedCallback(),this.boundRefreshAdSlot=this.refreshAdSlot.bind(this),this.addEventListener("DisplayAdRefresh",this.boundRefreshAdSlot),this.boundDestroySlot=this.destroySlot.bind(this),this.addEventListener("mesoClear",this.boundDestroySlot),G("slotResponseReceived",e=>{if(q()&&Object(i.c)(this,e)){const t=e.slot.getResponseInformation()&&e.slot.getResponseInformation().creativeId;W.debug(this.adpath+" slotResponseReceived",e),t&&!this._hasAdLoadEventDispatched?(this._adResponseReceived=!0,clearTimeout(this._timeoutVal)):this._dispatchAdLoadEvent({code:"AD-LOAD-EMPTY",uci:this.adpath,src:"gpt/component.slotResponseReceived()",creativeid:t})}}),G("slotRenderEnded",this._handleSlotRenderEnded),G("slotOnload",e=>{Object(i.c)(this,e)&&(this._lastLoaded=Date.now())})}disconnectedCallback(){super.disconnectedCallback(),this.destroySlot(),this.removeEventListener("DisplayAdRefresh",this.boundRefreshAdSlot),this.removeEventListener("mesoClear",this.boundDestroySlot),V("slotRenderEnded",this._handleSlotRenderEnded)}efreshAdSlot(){this.enabled&&this._gptAd&&(this.performanceMarked=!1,this._lastRefreshed=Date.now(),this._gptAd.refresh(this._slotTargeting),this._hasAdLoadEventDispatched=!1)}firstUpdated(){!isNaN(this.timeout)&&this.timeout>0&&(W.debug(this.adpath+" Timeout: register"),this._timeoutVal=setTimeout(()=>{W.debug(this.adpath+" Timeout: invoked"),this._adResponseReceived||this._dispatchAdLoadEvent({code:"AD-LOAD-EMPTY",isTimeout:!0,uci:this.uci,src:"gpt/component.firstUpdated()"})},this.timeout))}updatedhouldUpdate(){return!!(this.adpath&&this.enabled&&(this.outofpage||this.width&&this.height||this.isfluid)&&null===this._gptAd)&&(W.debug(this.adpath+" conditons met for shouldUpdate"),this.updateComplete.then(e=>{if(e){W.debug(this.adpath+" updateComplete is in the complete state");const e=this.adContainer;if(null!==e){if(this._gptAd=B({path:this.adpath,size:this.isfluid?["fluid","fluid"]:[this.width,this.height],element:e,outofpage:this.outofpage}),W.debug(this.adpath+" gpt ad is created"),!this._gptAd)return void W.error(y.a.GPT_AD_CREATION_FAILED,new Error("Error in creating GPT ad "+this.adpath),{methodName:"shouldUpdate"});this._gptAd.getAdSlotPromise().then(e=>{W.debug(this.adpath+" gpt slot is defined"),this.dispatchEvent(new CustomEvent("gptSlotDefined",{detail:{gptSlot:e}}))});const{siteId:t,locale:r,pageName:n,variant:i,brand:s}=window.meso.adcontext.getAdContext(),o={siteId:t,locale:r,pageName:n,variant:i,brand:s};this._slotTargeting={...this._slotTargeting,...o},this._gptAd.display(this._slotTargeting),this.disableInitialLoad||this.refreshAdSlot()}}const t=Object(i.a)(this.adpath),r=Object(i.b)(t);W.perf("GPT Request Started",{mark:"AdComponentRender:"+t,uci:t,adProductType:r})}),!0)}handleSlotRenderEnded(e){if(Object(i.c)(this,e)){W.debug(this.adpath+" _handleSlotRenderEnded",e),void 0!==this._timeoutVal&&clearTimeout(this._timeoutVal);const t=e.isEmpty?"AD-LOAD-EMPTY":"AD-LOAD-PASS";this._hasAdLoadEventDispatched||this._dispatchAdLoadEvent({code:t,uci:this.adpath,src:"gpt/component._handleSlotRenderEnded()",creativeid:e.creativeId,campaignId:e.campaignId,lineItemId:e.lineItemId});const r=Object(i.a)(e.slot.getAdUnitPath()),n=Object(i.b)(r);"AD-LOAD-PASS"!==t||this.timeoutinvoked||W.perf("GPT Request Returned",{mark:"AdComponentRender:"+r,uci:r,adProductType:n})}}_dispatchAdLoadEvent(e){W.debug(this.adpath+" _dispatchAdLoadEvent",e),this.dispatchEvent(new CustomEvent("mesoAd",{detail:e})),this._hasAdLoadEventDispatched=!0}render(){const e=this._id();return W.info("meso-gpt-ad.renderÂ successfully",{id:e,methodName:"render"}),n.c`<div id="${e}"></div>`}set slotTargeting(e={}){Object.assign(this._slotTargeting,e)!function(){W.debug((this&&this.adPath||"")+" tag is registered"),Object(z.a)("meso-gpt-ad",$)}()}]);
//# sourceMappingURL=meso-gpt.js.map