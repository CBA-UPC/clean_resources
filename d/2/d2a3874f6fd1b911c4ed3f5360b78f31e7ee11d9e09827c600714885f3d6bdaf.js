"use strict";(self.webpackChunkWPS_Drive=self.webpackChunkWPS_Drive||[]).push([[1918],{76432:function(t,e,n){var i=n(37311),o=n(49200),a=n(2406),c=n.n(a),r=n(26426),s=n.n(r),d=n(16548),l=n(99238),u=n(47189),p=n(45821),f=n(79137),v="addcontacts",m="send_invite",g="cancel_send_invite",b={dwCoopConfirm:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,f.Z)(v,{action:m,result:t?"success":"fail"})},dwCoopCancel:function(){(0,f.Z)(v,{action:g})}};function C(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?C(Object(n),!0).forEach((function(e){(0,o.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var h={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"k-add-member-coop"},[n("KMemberItem",{attrs:{name:t.member.name||t.member.nick_name,avatar:t.member.avatar,hideActions:!0,hover:!1}}),t._v(" "),n("p",[t._v(t._s(t.lang_txt0))]),t._v(" "),n("div",{staticClass:"k-add-coop-btn"},[n("el-button",{on:{click:},[t._v(t._s(t.lang_txt1))]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:},[t._v(t._s(t.lang_txt2)+" ")])],1)],1)},staticRenderFns:[],name:"KAddToCoop",components:(0,o.Z)({KMemberItem:l.Z},s().name,s()),props:{member:{type:Object,required:!0},link:{type:Object,required:!0},permission:{type:String,default:"write"}},data:function(){return{lang_txt0:(0,p.t)("logic.AddToCoop.txt0"),lang_txt1:(0,p.t)("logic.AddToCoop.txt1"),lang_txt2:(0,p.t)("logic.AddToCoop.txt2")}},methods:y(y({},b),{},{onCancel:sendInvite:function(){var t=this;return(0,i.Z)(c().mark((function e(){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,u.G1$)({sid:t.link.sid||t.link.link.sid,permission:t.permission,userids:[t.member.id||t.member.userid]});case 3:t.$emit("success",t.member),t.dwCoopConfirm(!0),e.next=12;break;case 7:e.prev=7,e.t0=e.catch(0),n=e.t0.response?e.t0.response.data&&(e.t0.response.data.msg||e.t0.response.data.result):e.t0.message,d.Z.error(n),t.dwCoopConfirm(!1);case 12:case"end":return e.stop()}}),e,null,[[0,7]])})))()}}),install:function(t){t.component(h.name,h)}};e.Z=h},61918:function(t,e,n){n.d(e,{Z:);var i=n(49200),o=n(20144),a=n(38220),c=n(62414),r=n(45821),s=n(26743),d={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"k-drive-invite-notify-box"},[n("section",[n("div",{staticClass:"title"},[t._v(t._s(t.title))]),t._v(" "),n("div",{staticClass:"sub-title"},[t._v(t._s(t.subTitle))])]),t._v(" "),n("section",{staticClass:"tip-content"},[n("img",{attrs:{src:t.img}})]),t._v(" "),n("KButton",{staticClass:"btn",attrs:{type:"primary"},on:{click:t.onConfirm}},[t._v(t._s(t.confirmText))])],1)},staticRenderFns:[],name:"KInviteNotify",components:{KButton:c.Z},props:{title:{type:String,default:(0,r.t)("basic.inviteNotify.title")},subTitle:{type:String,default:(0,r.t)("basic.inviteNotify.subTitle")},img:{type:String,default:"".concat((0,s.getCDN)(),"/kdocs/cloud/static/cooperate/notify_member.png")},confirmText:{type:String,default:(0,r.t)("basic.inviteNotify.confirmText")},onConfirm:{type:Function,default:function(){}}},install:function(t){t.component(d.name,d)}},l=d,u=n(76432),p=n(74470),f={invitation:"invitation",feedback:"feedback",addCoop:"addCoop"},v={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:"dialog-fade"}},[t.show?n("div",{staticClass:"k-sendInvitationWrapper"},[t.type===t.TYPES.invitation?n("div",{staticClass:"k-sendInvitationWrapper-panel"},[n("div",{staticClass:"k-sendInvitationWrapper-content"},[n("KSendAddContactInvitation",{attrs:{name:t.userinfo.nickname||t.userinfo.name,targetId:t.selectedMember.userid,targetName:t.selectedMember.name,targetAvatar:t.selectedMember.avatar,onSuccess:t.handleCallbackSuccess,onCancel:t.handleCallbackCancel,onQIconClick:t.onQIconClick}})],1)]):t.type===t.TYPES.feedback?n("div",{staticClass:"k-invite-notify-content"},[n("KInviteNotify",{attrs:{onConfirm:t.handleFeedback,title:""+(t.done?t.lang_txt0:"")+t.lang_txt1,subTitle:t.lang_txt2,img:t.QN+"/kdocs/cloud/tips/notice/guide-contact.png",confirmText:t.lang_txt3}})],1):t.type===t.TYPES.addCoop?n("div",{staticClass:"k-addToCoop-content k-sendInvitationWrapper-panel"},[n("KAddToCoop",{attrs:{permission:t.isCanCoop(t.link.fname)?"write":"read",member:t.selectedMember,link:t.link},on:{success:t.handleCallbackSuccess,cancel:t.handleCallbackCancel}})],1):t._e()]):t._e()])},staticRenderFns:[],name:"KContactInvitationPanel",components:{KSendAddContactInvitation:a.Z,KInviteNotify:l,KAddToCoop:u.Z},props:{transitonName:{type:String,default:"slide"},inviteContent:{type:String,default:""},userinfo:{type:Object,default:function(){return{}}},callbackSuccess:{type:Function,default:function(){}},callbackCancel:{type:Function,default:function(){}},doNotShowFeedback:{type:Boolean,default:!1},errorFn:{type:Function,default:function(){}},link:{type:Object,default:,onLoad:{type:Function,default:function(){}}},data:function(){return{lang_txt0:(0,r.t)("logic.ContactInvitationPanel.txt0"),lang_txt1:(0,r.t)("logic.ContactInvitationPanel.txt1"),lang_txt2:(0,r.t)("logic.ContactInvitationPanel.txt2"),lang_txt3:(0,r.t)("logic.ContactInvitationPanel.txt3"),show:!1,type:"invitation",selectedMember:{},TYPES:f,back:!1,done:!1,QN:(0,s.getCDN)()}},computed:{onQIconClick:function(){var t=this;return this.doNotShowFeedback?void 0:},methods:{isCanCoop:p.M7,handleCallbackSuccess:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.type===f.addCoop;n&&(e.addedMessage=(0,r.t)("logic.ContactInvitationPanel.txt4")),this.callbackSuccess(t,e),this.doNotShowFeedback||e.RelationAdded||n||this.isFeedbackShowed()?this.show=!1:(this.done=!0,this.type=f.feedback,localStorage.setItem("".concat(this.$options.name,"-feedback"),"1"))},handleCallbackCancel:handleFeedback:function(){this.show=this.back,this.type=f.invitation,this.back=!1,this.done=!1},isFeedbackShowed:function(){try{return!!localStorage.getItem("".concat(this.$options.name,"-feedback"))}catch(t){return!1}}}};function m(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function g(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?m(Object(n),!0).forEach((function(e){(0,i.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var b,C=o.default.extend(v);var y=function(){return{mount:function(t,e){(b=new C({parent:t,propsData:g({},e)})).$mount(),t.$el.appendChild(b.$el)},show:function(t,e){b.selectedMember=t,b.show=!0,e&&(b.type=e),"invitation"===b.type&&b.onLoad()},close:changeType:function(t){b.type=t}}}},38220:function(t,e,n){var i=n(37311),o=n(49200),a=n(2406),c=n.n(a),r=n(47189),s=n(62414),d=n(99238),l=n(7626),u=n.n(l),p=n(85476),f=n(16548),v=n(27361),m=n.n(v),g=n(45821),b=n(423),C=n(79137),y="addcontacts",h="send_verification",_="cancel_send_verification",k="instructions",x={dwVerificationConfirm:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,C.Z)(y,{action:h,result:t?"success":"fail"})},dwVerificationCancel:function(){(0,C.Z)(y,{action:_})},dwInstructions:function(){(0,C.Z)(y,{action:k})}};r I={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"k-sendAddContactInvitation"},[n("KMemberItem",{attrs:{avatar:t.targetAvatar,name:t.targetName,hover:!1}}),t._v(" "),n("div",{staticClass:"k-sendAddContactInvitation-des"},[t._v("\n    "+t._s(t.lang_txt0)+"\n    "),t.onQIconClick?n("KIcon",{attrs:{type:"question"},nativeOn:{click:}):t._e()],1),t._v(" "),n("el-input",{ref:"input",attrs:{placeholder:t.lang_txt8,type:"text",maxlength:"32",autocomplete:"off"},model:{value:t.msg,callback:expression:"msg"}}),t._v(" "),n("div",{staticClass:"k-sendAddContactInvitation-error"},[t.error?[t._v("\n      "+t._s(t.lang_txt1)+"\n      "),n("span",{on:{click:t.toCenter}},[t._v(t._s(t.lang_txt2))]),t._v(t._s(t.lang_txt3)+"\n    ")]:t._e()],2),t._v(" "),n("div",{staticClass:"k-sendAddContactInvitation-buttons"},[n("KButton",{on:{click:t.cancelHandler}},[t._v(t._s(t.lang_txt4))]),t._v(" "),n("KButton",{attrs:{type:"primary"},on:{click:t.send}},[t._v(t._s(t.lang_txt5))])],1)],1)},staticRenderFns:[],name:"KSendAddContactInvitation",components:{KButton:s.Z,KMemberItem:d.Z,ElInput:u()},props:{name:{type:String,required:!0},targetId:{type:Number,required:!0},targetName:{type:String,required:!0},targetAvatar:{type:String,required:!0},onSuccess:{type:Function,default:function(){}},onCancel:{type:Function,default:,onQIconClick:{type:Function}},data:function(){return{lang_txt0:(0,g.t)("logic.SendAddContactInvitation.txt0"),lang_txt1:(0,g.t)("logic.SendAddContactInvitation.txt1"),lang_txt2:(0,g.t)("logic.SendAddContactInvitation.txt2"),lang_txt3:(0,g.t)("logic.SendAddContactInvitation.txt3"),lang_txt4:(0,g.t)("logic.SendAddContactInvitation.txt4"),lang_txt5:(0,g.t)("logic.SendAddContactInvitation.txt5"),lang_txt8:(0,g.t)("logic.SendAddContactInvitation.txt8"),msg:"".concat((0,g.t)("logic.SendAddContactInvitation.txt6")," ").concat(this.name).slice(0,32),loading:!1,error:!1}},mounted:methods:w(w({},x),{},{_onQIconClick:function(){this.onQIconClick(),this.dwInstructions()},send:function(){var t=this;return(0,i.Z)(c().mark((function e(){var n,i,o,a,s,d,l,u,v;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.loading){e.next=2;break}return e.abrupt("return");case 2:return t.loading=!0,n=t.targetId,i=t.targetName,o=t.targetAvatar,a=t.msg,s={targetId:n,targetName:i,targetAvatar:o},e.prev=5,e.next=8,(0,r.M5n)({receiver_id:n,type:0,msg:a});case 8:d=e.sent,t.error=!1,t.onSuccess(s,d),f.Z.success(d.RelationAdded||(0,g.t)("logic.SendAddContactInvitation.txt7")),t.dwVerificationConfirm(!0),e.next=27;break;case 15:if(e.prev=15,e.t0=e.catch(5),l=(0,p.Qb)(e.t0),u=(0,p.az)(e.t0),!(l.indexOf("RateLimited")>-1)){e.next=26;break}return e.next=22,(0,r.q6S)();case 22:v=e.sent,m()(v,"phone.value")?f.Z.error(u):t.error=!0,e.next=27;break;case 26:["ApplySended","RelationAdded"].indexOf(l)>-1?(t.error=!1,t.onSuccess(s),t.dwVerificationConfirm(!0),f.Z.success((0,g.t)("logic.SendAddContactInvitation.txt7"))):(f.Z.error(u),t.dwVerificationConfirm(!1));case 27:return e.prev=27,t.loading=!1,e.finish(27);case 30:case"end":return e.stop()}}),e,null,[[5,15,27,30]])})))()},cancelHandler:toCenter:),install:;e.Z=I}}]);
