(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[45],{"08+0":function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return c}));var n=r("qU2n"),o=r("SoYc");function a(e,t,r,a){var i=Object(o.a)(r);if(i){var c=Object(n.a)(e,a);try{var u=void 0===t?"null":JSON.stringify(t);i.setItem(c,u)}catch(e){}}}function i(e,t,r){return void 0===r&&(r="localStorage"),a(e,t,r)}function c(e,t,r,n){return void 0===n&&(n="localStorage"),a(t,r,n,e)}},"5oc8":function(e,t,r){"use strict";r.d(t,"b",(function(){return l})),r.d(t,"a",(function(){return b}));var n=r("NrNW"),o=r("B5kz"),a=r("/Oio"),i=r("66iV"),c=r("iiZS"),u=r("mXGw"),s=r("rbxU"),f=r("tgug"),d=r("7ckP"),l=function(e,t){var r=Object(i.a)(),n=Object(d.a)(e);return Object(o.c)(n,(function(){return Object(f.a)({storageKey:e,userStorageOptions:r})}),{cacheTime:1/0,staleTime:1/0,enabled:!!t&&!!r&&t.workload!==a.a.Hwa})},b=function(){var e=Object(n.a)().data,t=l(s.a,e).data,r=Object(c.a)(s.a).data;return Object(u.useMemo)((function(){return(null==e?void 0:e.workload)===a.a.Hwa?{result:r,fromPersistence:void 0!==r}:t}),[null==e?void 0:e.workload,r,t])}},"66iV":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("NrNW"),o=r("CaQ9"),a=r("mXGw"),i=function(){var e=Object(n.a)().data,t=Object(o.a)().data;return Object(a.useMemo)((function(){return e&&t?{correlationId:e.correlationId,getAccessToken:e.getAccessToken,getIdentity:function(){return Promise.resolve(t)},inMockMode:e.inMockMode,jwtAuthEnabled:e.jwtAuthEnabled,officeHomeApiRoot:e.officeHomeApiRoot,workload:e.workload}:null}),[t,e])}},"7ckP":function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e){return["UserStorage",e]}},DwyN:function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return l}));var n=r("QjXU"),o=r("NrNW"),a=r("/Oio"),i=r("LLg0"),c=r("hUdb"),u=r("Pspf"),s=r("mXGw"),f=r("rbxU"),d=function(e,t){var r={id:c.a.Office,lastModifiedTimeUtc:Date.now(),mode:c.b.System,preferHarmonyTheme:!1,version:1};return Object(n.__assign)(Object(n.__assign)(Object(n.__assign)({},r),e),t)},l=function(){var e=Object(o.a)().data,t=Object(i.a)(f.a,d),r=Object(u.a)(f.a,d);return Object(s.useMemo)((function(){return(null==e?void 0:e.workload)===a.a.Hwa?r:t}),[null==e?void 0:e.workload,r,t])}},GFGy:function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return b}));var n=r("QjXU"),o=r("mXGw"),a=r("AlWG"),i=r("dpyN"),c=r("hUdb"),u={id:c.a.Office,lastModifiedTimeUtc:Date.now(),mode:c.b.System,preferHarmonyTheme:!1,version:1},s=r("5oc8"),f=r("DwyN"),d=new a.a(void 0),l=d.asObservable().pipe(Object(i.a)()),b=function(){var e,t=Object(s.a)(),r=Object(n.__read)(Object(f.b)(),2)[0],a=Object(o.useCallback)((function(e){d.next(Object(f.a)(null==t?void 0:t.result,e)),r(e)}),[t,r]);return[null!==(e=null==t?void 0:t.result)&&void 0!==e?e:u,a]}},LLg0:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("QjXU"),o=r("MJsD"),a=r("B5kz"),i=r("W7wX"),c=r("beUW"),u=r("Yh/z");function s(e,t){var r=this,s=Object(c.a)(e);return Object(a.b)((function(){return Object(n.__awaiter)(r,void 0,void 0,(function(){var t,r,c,f,d;return Object(n.__generator)(this,(function(l){switch(l.label){case 0:return[4,Promise.all([Object(o.a)(),Object(i.a)()])];case 1:return t=n.__read.apply(void 0,[l.sent(),2]),c=t[1],f={correlationId:(r=t[0]).correlationId,getAccessToken:r.getAccessToken,getIdentity:inMockMode:r.inMockMode,jwtAuthEnabled:r.jwtAuthEnabled,officeHomeApiRoot:r.officeHomeApiRoot,workload:r.workload},[2,(d=a.a.getQueryData(s))&&Object(u.a)(e,d.result,f)]}}))}))}),{onMutate:function(e){a.a.cancelQueries(s);var r=a.a.getQueryData(s),o=t(r&&Object(n.__assign)({},r.result),e);return a.a.setQueryData(s,{result:o,fromPersistence:!!(null==r?void 0:r.fromPersistence)}),r},onError:function(e,t,r){a.a.setQueryData(s,r)}})}},PIlr:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return c}));var n=r("qU2n"),o=r("SoYc");function a(e,t,r){var a=Object(o.a)(t);if(a){var i=Object(n.a)(e,r),c=a.getItem(i);return"string"==typeof c?JSON.parse(c):void 0}}"Pd+Y":function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("QjXU"),o=r("8wW2"),a=r("a3FV"),i=r("0TX8"),c=r("Wa5Y"),u=r("mpo9");function s(e,t,r,s){var f=this;return void 0===r&&(r=!1),void 0===s&&(s=1),new Promise((function(d,l){return Object(n.__awaiter)(f,void 0,void 0,(function(){var f,b,v,j;return Object(n.__generator)(this,(function(O){switch(O.label){case 0:return(f=Object(u.b)()).hasOwnProperty(e)&&!r?(b=Array.isArray(f[e])?f[e]:Object(n.__assign)({},f[e]),d(b),[2]):Object(u.c)()||s<1?(d(void 0),[2]):[4,t.getIdentity()];case 1:return v=O.sent(),t.jwtAuthEnabled&&v.isMsa?(l("User storage does not support roaming"),[2]):(j={},[4,Object(i.a)(j,t.inMockMode,t.workload,t.getIdentity)]);case 2:return O.sent(),Object(c.a)(a.a.OfficeHomeStorageReadRequest,"OfficeHomeStorage_Read","".concat(t.officeHomeApiRoot,"/api/userstorage/").concat(e,"/"),j,t.jwtAuthEnabled,t.getAccessToken,t.officeHomeApiRoot,t.correlationId,"OfficeHome",{populateRequestEvent:function(t,r){r.RequestId=e},isRetriableError:).then((function(t){t.data&&(f[e]=Array.isArray(t.data)?t.data:Object(n.__assign)({},t.data)),d(t.data)})).catch((function(t){Object(o.a)().handleError(t,"Bn3rc"),t&&t.httpResponse&&404===t.httpResponse.status?d(void 0):l("Failed to get value from user data storage for <".concat(e,"> key."))})),[2]}}))}))}))}},Pspf:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r("QjXU"),o=r("B5kz"),a=r("W7wX"),i=r("08+0");function c(e,t){var r=this,c=["WebStorage",e];return Object(o.b)((function(u){return Object(n.__awaiter)(r,void 0,void 0,(function(){var r,s,f;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(a.a)()];case 1:return r=n.sent(),o.a.cancelQueries(c),s=o.a.getQueryData(c),(f=t(s,u))&&(o.a.setQueryData(c,f),Object(i.b)(r.puid,e,f),Promise.resolve(f)),Promise.reject("Invalid value"),[2]}}))}))}),{onError:)}},SoYc:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=new Map;function o(e){return n.has(e)||n.set(e,function(e){try{var t=window[e];if(!t)return;var r="".concat(Math.round(1e6*Math.random()));return t.setItem(r,r),t.removeItem(r),t}catch(e){return}}(e)),n.get(e)}},X0vp:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("PIlr"),o=function(e){var t=e.identity,r=e.storageKey;if(t)return Object(n.b)(t.puid,r)||void 0}},"Yh/z":function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r("QjXU"),o=r("8wW2"),a=r("muUJ"),i=r("a3FV"),c=r("CMIS"),u=r("0TX8"),s=r("cy7S"),f=r("oK0o"),d=r("mpo9");function l(e,t,r){var l=this;return new Promise((function(b,v){return Object(n.__awaiter)(l,void 0,void 0,(function(){var l,j,O;return Object(n.__generator)(this,(function(m){switch(m.label){case 0:return Object(d.b)()[e]=Array.isArray(t)?t:Object(n.__assign)({},t),[4,r.getIdentity()];case 1:if(l=m.sent(),r.jwtAuthEnabled&&l.isMsa)return v("User storage does not support roaming"),[2];if(j={headers:{}},!r.inMockMode&&!r.jwtAuthEnabled){if(!(O=f.get("AjaxSessionKey")))return Object(a.a)(i.a.CsrfTokenError),Object(c.a)({eventName:"Csrf_Token",errorType:"User_Storage_Error"}),v("CSRF token missing"),[2];j.headers.AjaxSessionKey=O}return[4,Object(u.a)(j,r.inMockMode,r.workload,r.getIdentity)];case 2:return m.sent(),Object(s.a)(i.a.OfficeHomeStorageWriteRequest,"OfficeHomeStorage_Write","".concat(r.officeHomeApiRoot,"/api/userstorage/").concat(e,"/"),t,j,r.jwtAuthEnabled,r.getAccessToken,r.officeHomeApiRoot,r.correlationId,"OfficeHome",{populateRequestEvent:).then(().catch((function(t){Object(o.a)().handleError(t,"J7GBR"),v("Failed to update or create value in roaming user data storage for <".concat(e,"> key."))})),[2]}}))}))}))}},beUW:function(e,t,r){"use strict";.d(t,"a",(function(){return n}))},cy7S:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("QjXU"),o=r("kb6k"),a=r("lAHu");function i(e,t,r,i,c,u,s,f,d,l,b,v){void 0===b&&(b={});var j=Object(n.__assign)(Object(n.__assign)({},c),{url:r,method:"PUT",body:i});return Object(o.a)((function(r){return Object(a.a)(e,t,r,f,d,void 0,b.populateRequestEvent,b.onUploadProgress,b.onDownloadProgress,b.cancellationToken,b.timeoutInMs)}),e,t,j,u,s,l,b.mockParam,b.resourceUrl,b.rpsHeaderPrefix,b.additionalAuthErrors,b.isRetriableError,b.updateRequestWithAuth,void 0,void 0,void 0,v)}},iiZS:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r("B5kz"),o=r("CaQ9"),a=r("X0vp"),i=r("vDMK");function c(e){var t=Object(o.a)().data,r=Object(i.a)(e);return Object(n.c)(r,(,{cacheTime:1/0,staleTime:1/0,enabled:!!t})}},mpo9:function(e,t,r){"use strict";r.d(t,"b",(function(){return f})),r.d(t,"c",(function(){return d})),r.d(t,"a",(function(){return l}));var n,o,a,i=r("E7ar"),c=r("8wW2"),u=!1;function s(){if(!u){u=!0;var e=void 0;try{e=Object(i.a)("userStorageCache")}catch(e){Object(c.a)().handleError(e)}n=e?e.content:{},o=!!e&&e.firstUse,a=e?e.firstUseTimestamp:0}}function f(){return s(),n}function d(){return s(),o},oK0o:qU2n:function(e,t,r){"use strict";function n(e,t){return t?"officeHome-".concat(t).concat(e):e}r.d(t,"a",(function(){return n}))},rbxU:tgug:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("QjXU"),o=r("Pd+Y"),a=function(e){var t=e.storageKey,r=e.userStorageOptions;return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(o.a)(t,r)];case 1:return(e=n.sent())?[2,{result:e,fromPersistence:!0}]:[2,{result:void 0,fromPersistence:!1}]}}))}))}},vDMK:function(e,t,r){"use strict";r.d(t,"a",();var n=}]);
//# sourceMappingURL=45.eaf8e0fa967deca0e51f.chunk.v7.js.map