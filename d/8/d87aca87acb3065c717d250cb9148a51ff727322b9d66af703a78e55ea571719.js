(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5090],{84056:5430:function(e,t,n){"use strict";n.d(t,{Z:function(){return PushAccountsSwitch}});var o=n(52322),a=n(77512);function PushAccountsSwitch(e){let{recordsName:t="Company",containerProps:n,textProps:i,companyTextProps:s,...r}=e;return(0,o.jsxs)("div",{className:"flex space-x-2",...n,children:[(0,o.jsx)(a.rs,{...r}),(0,o.jsxs)("span",{className:"text-sm text-gray-500",...i,children:["Create new"," ",(0,o.jsx)("span",{className:"rounded border bg-gray-50 p-1 text-[13px] leading-5 text-gray-600",...s,children:t})," ","records from collected emails or Account-Based Engagement."]})]})}},51527:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSP:function(){return k},default:);var o=n(52322),a=n(8583),i=n(2784),s=n(56958),r=n(5430),c=n(52934),l=n(77815),u=n(47330),d=n(45152),p=n(81571),m=n(21254),f=n(20851),g=n(47128),h=n(91077),x=n(27425),b=n(73022),S=n(38445),j=n(13710),w=n(40761);function HubSpotQuickConnect(e){let{webhook:t,integrationName:n,objectName:a,logo:r,afterCreateFields:c,autoMapField:l}=e,[u,d]=(0,i.useState)(!1),[p,m]=(0,i.useState)(!1),[f,g]=(0,i.useState)(!1),[h,x]=(0,i.useState)([]);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(w.Z,{objectName:a,logo:r,integrationName:n,onClick:()=>d(!0)}),(0,o.jsx)(j.Z,{name:n,logo:r,open:u,handleClose:()=>d(!1),handleNext:async e=>{m(!0);let n=b.VG.filter(,o=await fetch("/api/integration/hubspot/properties?id=".concat(t.id),{method:"POST",body:JSON.stringify(n)});m(!1),o.ok?(x(n),d(!1),g(!0)):s.A.error("Error creating fields! We're looking into it.")},loading:p,allowedFields:b.VG.filter(}),(0,o.jsx)(S.Z,{open:f,handleClose:name:n,logo:r,handleNext:()=>{h.forEach(l),g(!1),null==c||c()}})]})}var N=n(12659),v=n(64766),C=n(170);let y={name:"HubSpot",screenshot:"https://www.navattic.com/img/integrations/hubspot.png",webhookFormat:u.M8.Hubspot,Logo:a.I5b,ConnectComponent:N.Z,ConfigurationComponent:function(e){let{webhook:t,integrationSettings:n}=e,{workspace:b}=(0,d.cF)(),S=(0,d.NK)(b,u.TT.Enrichment),[,j]=(0,c.I)(),[w,N]=(0,i.useState)([]),[v,C]=(0,i.useState)([]),[y,k]=(0,i.useState)([]),[{data:E}]=(0,l.x)({variables:{workspaceId:t.workspaceId}}),[_,H]=(0,i.useState)((0,f.OA)(t.config||"")||p.Ul);(0,i.useEffect)(()=>{fetch("/api/integration/hubspot/properties?id=".concat(t.id)).then(e=>e.json()).then(},[t.id]),(0,i.useEffect)(()=>{fetch("/api/integration/hubspot/scopes?id=".concat(t.id)).then(.then(},[t.id]),(0,i.useEffect)(()=>{let e=(0,g.E)((null==E?void 0:E.formFieldMetadata)||[]),t=Object.keys(_.fieldMappings).map(,n=t.filter(;k([...e,...n])},[null==E?void 0:E.formFieldMetadata,_.fieldMappings]);let[A,I]=(0,i.useState)(Object.entries(_.fieldMappings).map((e,t)=>{let[n,o]=e;return{id:t.toString(),from:n,to:o}})),M=!v.includes(p.yd.CompaniesRead)||!v.includes(p.yd.CompaniesWrite);async function onSave(){return A.some(?s.A.error("There are still unfilled mappings. Please fill or delete them."):s.A.promise(j({id:t.id,config:(0,m.au)({..._,fieldMappings:Object.fromEntries(A.map()})}).then(e=>{if(null==e?void 0:e.error)throw Error("Error saving: ".concat(e.error.message))}),{success:"Saved HubSpot configuration!",loading:"Saving HubSpot configuration...",error:)}return(0,o.jsxs)("div",{className:"mx-auto flex max-w-[440px] flex-col space-y-3",children:[(0,o.jsx)(HubSpotQuickConnect,{webhook:t,integrationName:n.name,objectName:"Contacts",logo:n.Logo,autoMapField:e=>{I(t=>[...t,{id:t.length.toString(),from:e.name,to:e.name}])}}),(null==E?void 0:E.formFieldMetadata)?(0,o.jsx)(x.Z,{fromOptions:y.map(e=>({label:e.name,value:e.id})),toOptions:w.map(,mappings:A,onChange:I,fromIcon:()=>(0,o.jsx)(h.H,{className:"shrink-0",white:!1,height:15}),toIcon:n.Logo,title:"Contacts",preventDuplicates:!0,onCreateFromOption:e=>{k(}}):(0,o.jsxs)("div",{className:"mt-2 flex flex-row items-center justify-center space-x-2 text-sm text-gray-500",children:[(0,o.jsx)(a.L4p,{className:"h-3 w-3"}),(0,o.jsx)("span",{children:"Loading data..."})]}),S&&(0,o.jsxs)("div",{className:"flex flex-col space-y-2",children:[M&&(0,o.jsx)("div",{className:"rounded-md border bg-slate-50 p-2 text-sm",children:'Companies are unavailable until you re-authenticate with HubSpot. Click "Setup" and "Update" to re-authenticate.'}),(0,o.jsx)(r.Z,{checked:_.pushCompany,onChange:disabled:M})]}),(0,o.jsxs)("button",{onClick:onSave,className:"btn-white w-full justify-center bg-white font-medium shadow",children:[(0,o.jsx)(n.Logo,{className:"mr-2"}),"Save configuration"]})]})},allowTestConnection:!0,allowReAuth:!0};ubSpotIntegrationPage.getLayout=var k=!0,E=HubSpotIntegrationPage}},);
//# sourceMappingURL=hubspot-3b4493eb24a86ca9.js.map