(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[656],{bet9:function(e,o,t){"use strict";t.d(o,"a",();var r=t("Ishu"),n=t("mXGw"),i=t("xARA"),a=t("rwSX"),l=t("pJE1"),s=t("0Pdq"),c=t("HK/J"),u=t("/W62"),d=t("Pn3S"),g=t("5rnD"),h=t("FaLQ"),b=t("OeKw"),f=t("Crwh"),p=t("dtod"),m=t("ZQAo"),v=t("7JZK"),y=t("bi4m"),x=t("BFEF");const C={menuBackgroundColor:`var(${y.e.MenuBackground}, ${x.a.Neutral.white})`,menuBorderColor:`var(${y.e.MenuHeader}, ${x.a.Neutral.neutralLight})`,dividerBackgroundColor:`var(${y.e.MenuDivider}, ${x.a.Neutral.neutralQuaternaryAlt})`},w={buttonFontFamily:`var(${y.f.FontFamilyMenu}, Segoe UI, sans-serif)`,buttonFontSize:`var(${y.f.FontSizeMenu}, 14px)`,buttonFontWeight:`var(${y.f.FontWeightMenu}, 400)`,buttonColor:`var(${y.e.MenuItemText}, ${x.a.Neutral.neutralPrimary})`,buttonDisabledColor:`var(${y.e.DisabledBodyText}, ${x.a.Neutral.neutralTertiary})`,buttonHoverColor:`var(${y.e.MenuItemTextHovered}, ${x.a.Neutral.neutralDark})`,buttonHoverFocusBackgroundColor:`var(${y.e.MenuItemBackgroundHovered}, ${x.a.Neutral.neutralLighter})`,buttonPressedBackgroundColor:`var(${y.e.MenuItemBackgroundPressed}, ${x.a.Neutral.neutralLight})`,outlineColor:x.a.Neutral.neutralSecondaryAlt,outlineFocusedColor:`var(${y.e.FocusBorder}, ${x.a.Neutral.black})`},k=`var(${y.d.Scrollbar}, ${x.a.Neutral.neutralTertiary})`,S=`var(${y.d.ScrollbarPressed}, ${x.a.Neutral.neutralSecondaryAlt})`,F=(e,o)=>Object(c.B)(T(e),{height:16,margin:"7px 0",width:16,selectors:{[c.e]:{color:e.disabled?"grayText":e.toggled?"highlightText":"windowText"}},[`.${o}:hover &`]:{color:w.buttonHoverColor,selectors:{[c.e]:{color:e.disabled?"grayText":"highlightText",backgroundColor:"highlight"}}},[`.${o}:hover:focus &`]:{color:w.buttonHoverColor},[`.${o}:focus &`]:{color:"inherit",selectors:{[c.e]:{color:e.disabled?"grayText":"highlightText",backgroundColor:"highlight"}}}}),T=e=>({fontFamily:w.buttonFontFamily,fontSize:w.buttonFontSize,fontWeight:w.buttonFontWeight,color:e.disabled?w.buttonDisabledColor:w.buttonColor}),B=Object(c.B)({display:"flex",height:"auto",justifyContent:"flex-start",width:"100%"}),E=(e,o)=>({root:{...T(e),display:"inline",paddingLeft:12,paddingRight:12,selectors:{[c.e]:{color:e.disabled?"grayText":e.toggled?"highlightText":"windowText",backgroundColor:e.toggled?"highlight":"window"}},[`.${o}:hover &`]:{color:w.buttonHoverColor,selectors:{[c.e]:{color:e.disabled?"grayText":"highlightText",backgroundColor:"highlight"}}},[`.${o}:focus &`]:{color:"inherit",selectors:{[c.e]:{color:e.disabled?"grayText":"highlightText",backgroundColor:"highlight"}}},[`.${o}:hover:focus &`]:{color:w.buttonHoverColor}}}),$=Object(c.B)({color:w.buttonColor,lineHeight:14,paddingBottom:8,paddingTop:8,textAlign:"right",width:"100%"}),N=n.memo((function(e){var o;const{text:t,secondaryText:r,iconProps:i,index:a,onClick:l,onFocus:s,disabled:u,overrideWidth:d,refCallback:g}=e;let h={};void 0!==d&&(h={width:d});const b=(e=>Object(c.B)(T(e),{alignItems:"stretch",textAlign:"left",backgroundColor:e.checked?w.buttonPressedBackgroundColor:C.menuBackgroundColor,borderWidth:0,color:w.buttonColor,display:"flex",height:"auto",outline:e.toggled?"1px solid":"none",outlineOffset:e.toggled?"-1px":"0px",outlineColor:e.toggled?w.outlineFocusedColor:"none",padding:"0 11px",width:"100%",selectors:{[c.e]:{color:e.disabled?"grayText":"windowText",MsHighContrastAdjust:"none",forcedColorAdjust:"none",backgroundColor:e.disabled?"window":e.checked||e.toggled?"highlight":"window",outline:e.toggled?"1px solid":"none",outlineOffset:e.toggled?"-1px":"0px",outlineColor:"window"},":hover":{backgroundColor:w.buttonHoverFocusBackgroundColor,color:w.buttonHoverColor,selectors:{[c.e]:{backgroundColor:e.disabled?"window":"highlight",color:e.disabled?"grayText":"highlightText"}}},":active":{backgroundColor:w.buttonPressedBackgroundColor,color:w.buttonColor,selectors:{[c.e]:{backgroundColor:"highlight",color:e.disabled?"grayText":"highlightText",outline:"none"}}},":focus":{color:w.buttonColor,outline:"1px solid",outlineOffset:"-1px",outlineColor:w.outlineFocusedColor,selectors:{[c.e]:{backgroundColor:"highlight",color:e.disabled?"grayText":"highlightText",outline:e.toggled?"1px solid":"none",outlineOffset:e.toggled?"-1px":"0px",outlineColor:"window"}}},".ms-Fabric--isFocusHidden &:focus, .ms-Fabric--isFocusHidden &:focus:hover":{outline:"none",color:w.buttonHoverColor}}}))(e),f=null!==(o="menu-button"+a)&&void 0!==o?o:"";return n.createElement("button",{role:"option",className:b,onClick:u?M:l,onFocus:s,style:h,id:f,"data-automation-id":f,ref:e=>{g&&void 0!==a&&1===a&&null!==e&&g(e)}},n.createElement("span",{className:B,style:h},n.createElement("span",{className:F(e,b)},(null==i?void 0:i.iconName)&&n.createElement(m.a,{iconName:i.iconName})),n.createElement(p.a,{styles:E(e,b)},t),n.createElement(v.a,{className:$},r)))})),M=P={root:{borderWidth:1,borderColor:C.menuBorderColor,borderStyle:"solid",borderRadius:"4px",background:C.menuBackgroundColor,borderRadius:4,width:240,zIndex:100,selectors:{"@media (min-height: 210px)":{maxHeight:"200px !important"}}},calloutMain:{selectors:{"::-webkit-scrollbar":{height:6,width:6},"::-webkit-scrollbar-thumb":{background:k,borderRadius:3,opacity:0,selectors:{[c.e]:{background:"windowText"}}},":focus-within::-webkit-scrollbar-thumb, :hover::-webkit-scrollbar-thumb":{background:S,selectors:{[c.e]:{background:"windowText"}}}}}},I={display:"flex",flexDirection:"column",background:C.menuBackgroundColor},R={display:"flex",flexDirection:"column-reverse",background:C.menuBackgroundColor,overflow:"hidden"},D={fontFamily:w.buttonFontFamily,fontSize:w.buttonFontSize,fontWeight:w.buttonFontWeight,color:w.buttonColor},A={root:{width:"100%",marginLeft:"11px",marginRight:"11px"},field:{...D,padding:0,selectors:{"::placeholder":{color:"#BEBBB8"}}},fieldGroup:{...D,flex:1,background:C.menuBackgroundColor}},H={...D,overflow:"visible"},L=Object(c.B)(H,{borderWidth:"1px 0 0",borderStyle:"solid",borderColor:C.menuBorderColor}),O=Object(c.B)(H,{borderWidth:"0 0 1px",borderStyle:"solid",borderColor:C.menuBorderColor}),j=Object(c.B)({padding:"10px 40px",color:w.buttonColor}),W=n.memo((function(e){const{stringTable:o,onClose:t,searchResults:r,searchQuery:i,setSearchQuery:a,shouldPreventDismiss:l}=e,m=n.createRef(),v=n.createRef(),y=n.useRef(null),x=n.useRef(null),[C,w]=n.useState(void 0),k=n.useRef(!1),S=n.useRef(!1),F=/[\w ]|[^\x00-\x7F]/,T=n.useRef(!1),B=[s.a.tab,s.a.backspace];n.useEffect((,[m]),n.useEffect((()=>{e.shouldRequestFocus&&v.current&&null!==x.current&&!T.current&&r&&r.length>1?(x.current.focus(),x.current=null,T.current=!0):e.shouldRequestFocus&&v.current&&!T.current&&v.current.focus(!0)}),[v]);const E=$=()=>void 0===e.showSearch||e.showSearch,M=D=void 0===e.direction?P:Object(c.A)(P,{root:{direction:e.direction}});return n.createElement(d.a,{"data-automation-type":"Discover",isBeakVisible:!1,target:e.target,directionalHint:"rtl"===e.direction?e.flip?u.a.bottomRightEdge:u.a.topRightEdge:e.flip?u.a.bottomLeftEdge:u.a.topLeftEdge,coverTarget:!0,setInitialFocus:$(),shouldRestoreFocus:!1,styles:D,style:e.cssProperties?e.cssProperties():void 0,preventDismissOnEvent:()=>!!l&&l(S.current),onDismiss:,n.createElement(g.a,{componentRef:v,direction:h.a.vertical,onKeyDown:o=>{let r=!1;o.keyCode===s.a.escape?(t("calloutEscape"),r=!0):(e=>e.key.match(F)&&1===e.key.length||B.includes(e.keyCode))(o)&&void 0!==e.restoreFocusAndUpdateQuery&&!$()&&(S.current=!0,e.restoreFocusAndUpdateQuery(o.key),r=!0),r&&(T.current=!1,o.preventDefault())}},n.createElement("div",{style:e.flip?R:I,"aria-expanded":r&&r.length>0?"true":"false"},$()&&n.createElement("div",{style:{display:"flex"}},n.createElement(b.a,{defaultValue:i,"aria-autocomplete":"list",ariaLabel:o.searchBoxAriaLabel,autoComplete:"off",borderless:!0,componentRef:m,id:"discover-textfield",onChange:(e,o)=>{a(o||"")},onKeyDown:e=>{switch(e.keyCode){case s.a.enter:return r&&void 0!==C&&C<r.length&&E(r[C]),void e.preventDefault();case s.a.backspace:return void(""===i&&(t("searchBackspace"),e.preventDefault()));case s.a.escape:return t("searchEscape"),e.stopPropagation(),void e.preventDefault()}},placeholder:o.search,styles:A})),n.createElement("div",{className:e.flip?O:L,"data-is-scrollable":!0,"aria-label":o.menuAriaLabel,"data-automation-id":"discoverListTestId"},r&&r.length>0&&n.createElement(f.a,{"aria-label":o.listAriaLabel,role:"listbox",items:r,onRenderCell:(o,t,r)=>o&&n.createElement(N,{iconProps:{iconName:o.icon},onClick:onFocus:text:o.displayName,toggled:0===t&&!e.shouldRequestFocus&&!$(),refCallback:M,tabIndex:0,index:t}),componentRef:y}),!r&&n.createElement(p.a,{className:j},o.loading),r&&0===r.length&&n.createElement(p.a,{className:j},o.noResult)))))}));let z;var J=t("Wx5u");ew Set,new Set,new Map([["Automation",1],["SyntheticTraffic",1],["Local",1],["Staging",1],["Dogfood",.1],["Preview",.1],["Microsoft",.01],["Production",.001],["GCC",0],["GCC-High",0],["DoD",0]]);var q=t("5+n6");const K=.03928,G=12.92,U=/^rgb(?:a)?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/i;function V(e){return function(e){if("transparent"===e)return[0,0,0,0];const o=document.createElement("div");o.style.color=e;const t=o.style.color.match(U);if(t){const e=[parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10),t[4]?parseFloat(t[4]):1];return X(e),e}throw new Error("Can not parse color string: "+e)}(e).slice(0,3)}function Z(e){const o=e[0]/255,t=e[1]/255,r=e[2]/255;return.2126*(o<=K?o/G:_(o))+.7152*(t<=K?t/G:_(t))+.0722*(r<=K?r/G:_(r))}function X(e){if(e.length<3)throw new Error("The color array should have a length of at least 3");for(let o=0;o<3;o+=1){if(!Number.isInteger(e[o]))throw new Error("The color value should be an integer: "+e[o]);if(e[o]<0)throw new Error("The color value should be greater or equal than 0: "+e[o]);if(e[o]>255)throw new Error("The color value should be lesser or equal than 255: "+e[o])}}lass Y{et IContainerServiceFactoryHelper(){return this}instantiateContainerService(e){const o=e.synthesize(this.optionalProviders,void 0);return new this.ctor(o)}}class ee{sync getView(e){return await this.initializationPromise,async function(e,o){const{coordinates:t,ownerDocument:r,locale:s}=e;if(void 0===t||void 0===r)return;const c=e.flip||window.innerHeight-t.y<250;if(void 0===z){const o={x:t.x,y:t.y};c&&e.coordinatesFlip&&(o.x=e.coordinatesFlip.x,o.y=e.coordinatesFlip.y),z=function(e,o){const t=o.createElement("div");return t.style.position="absolute",t.style.left=e.x+"px",t.style.top=e.y+"px",o.body.appendChild(t),t}(o,r)}const u=Object(a.c)(s);return{async render(t){if(void 0===z)return;const r={...e,...t,target:z,flip:c,cssProperties:o,direction:Object(l.b)(u)};i.render(n.createElement(W,r),z)},clear(){void 0!==z&&(i.unmountComponentAtNode(z),z.remove(),z=void 0)}}}(e,()}constructor(e){var o,t;this.initializationPromise=Promise.all([null==e||null===(o=e.NamespaceLogger)||void 0===o?void 0:o.then((e=>this.logger=e)).catch((()=>{})),null==e||null===(t=e.StylingService)||void 0===t?void 0:t.then(().catch((()=>{}))]).then((()=>{if(this.stylingService){const o=async()=>{let o;this.stylingService&&Array.from(this.stylingService.themeProperties()).forEach((e=>{void 0===o&&(o={}),o[e.name]=e.value})),this.stylingProperties=o;const t=await(null==e?void 0:e.SettingsProvider);(async function(e,o,t){if(!Object(q.a)("accessibility.validateThemingAccessibility",!1,t)||!e||!o)return;const r=function(e){const o=[];return e.forEach((e=>{const t=function(e){if(e.color1&&e.color2)try{const o=function(e,o){X(e),X(o);const t=Z(e)+.05,r=Z(o)+.05;return t>r?t/r:r/t}(V(e.color1),V(e.color2));if(o<e.threshold)return`Insufficient contrast ratio (${o}): ${JSON.stringify(e)}`}catch(o){return`Error getting contrast ratio of colors: ${JSON.stringify(e)}`}}(e);void 0!==t&&o.push(t)})),o}([{color1:e[y.e.MenuBackground],color1Label:y.e.MenuBackground,color2:e[y.e.MenuItemText],color2Label:y.e.MenuItemText,threshold:4.5},{color1:e[y.e.MenuBackground],color1Label:y.e.MenuBackground,color2:e[y.e.InputBackgroundChecked],color2Label:y.e.InputBackgroundChecked,threshold:3}]);r.length>0&&function(e,o,t){t&&function(e,o){!function(e,o){var t;const r="object"==typeof e&&null!==e;function n(o){if(!r)return;const t=e[o];return"string"==typeof t?t:void 0}o.errorMessage=null!==(t=n("message"))&&void 0!==t?t:String(e),o.errorName=n("name"),o.stack=n("stack"),o.errorType=n("errorType"),o.errorInstanceId=n("errorInstanceId")}(o,e),e.message=e.message?`${e.message}\n${e.errorMessage}`:e.errorMessage,void 0===e.stack&&(e.stack=function(){let e=(new Error).stack;if(!e)try{throw new Error}catch(o){e=o.stack}return e}()),e.errorMessage&&(e.errorMessage=Q(e.errorMessage.toString())),e.message&&(e.message=Q(e.message.toString())),e.stack&&(e.stack=Q(e.stack.toString())),e.error&&(e.error=Q(e.error.toString())),e.responseMessage&&(e.responseMessage=Q(e.responseMessage.toString()))}(o,t),e.send({...o,category:J.b.Error})}(o,{eventName:"ThemingAccessibility"},{message:JSON.stringify(r)})})(this.stylingProperties,this.logger,t).catch((()=>{}))};this.stylingService.on(r.a.themePropertiesChanged,(),o().catch((()=>{}))}})).catch(()}}(()=>{ee.serviceFactory=new Y(ee,{NamespaceLogger:"NamespaceLogger",StylingService:"StylingService",SettingsProvider:"SettingsProvider"})})()},tUvO:]);
//# sourceMappingURL=vendors~menu-view-service.988d6e3f48b8c22abcea.chunk.v7.js.map