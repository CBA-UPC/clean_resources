"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8145],{30669:function(e,t,a){a.d(t,{y8:function(){return M},$v:function(){return r},KM:function(){return SettingsRootUserControls},ZP:function(){return SettingsRootAccountControls},$X:function(){return generateDemoDataKey}});var n,r,o=a(52322),l=a(2784),s=a(32517),i=a(3016),c=a(78066),d=a(49323),u=a(73235),p=a(66547),m=a(17676),g=a(26806);function _templateObject(){let e=(0,u._)(["\n    mutation UpdateWorkspaceFeatureFlag($workspaceId: String!, $featureFlag: FeatureFlag!, $isOn: Boolean!) {\n  updateWorkspaceFeatureFlag(\n    workspaceId: $workspaceId\n    featureFlag: $featureFlag\n    isOn: $isOn\n  ) {\n    ...WorkspaceFeatureFlag\n  }\n}\n    ",""]);return _templateObject=function(){return e},e}let h=(0,p.ZP)(_templateObject(),m.b);var b=a(10347);function listWorkspaceFeatureFlags_templateObject(){let e=(0,u._)(["\n    query ListWorkspaceFeatureFlags($workspaceId: String, $featureFlag: FeatureFlag) {\n  workspaceFeatureFlags(workspaceId: $workspaceId, featureFlag: $featureFlag) {\n    ...WorkspaceFeatureFlag\n  }\n}\n    ",""]);return listWorkspaceFeatureFlags_templateObject=function(){return e},e}let x=(0,p.ZP)(listWorkspaceFeatureFlags_templateObject(),m.b);var f=a(47330),v=a(20851),j=a(77512),y=a(56958);let T=[{name:"Trial",value:f.SO.Trial},{name:"Customer",value:f.SO.Customer},{name:"Navattic Internal",value:f.SO.Internal},{name:"None",value:f.SO.None}],w=[{value:"All",name:"All"},...T];function FeatureFlagManagementModal(e){let{...t}=e,[,a]=g.Db(h),[{data:n}]=(0,b.r)(),[r,u]=(0,l.useState)(f.TT.Offline),[p,m]=(0,l.useState)("All"),[{data:T,fetching:k}]=g.aM({query:x,variables:{featureFlag:r}}),F=(0,l.useMemo)(()=>{var e,t;return null!==(t=null==n?void 0:null===(e=n.currentUserMemberships)||void 0===e?void 0:e.map(e=>{let{workspace:t}=e;return t}).filter()&&void 0!==t?t:[]},[p,null==n?void 0:n.currentUserMemberships]),N=(0,l.useMemo)(()=>{var e,t;let a=new Set(null!==(t=null==T?void 0:null===(e=T.workspaceFeatureFlags)||void 0===e?void 0:e.map()&&void 0!==t?t:[]);return F.map(.sort(},[null==T?void 0:T.workspaceFeatureFlags,F]),D=(0,l.useCallback)((e,t)=>y.A.promise(a({workspaceId:t,featureFlag:r,isOn:e}).then(e=>{if(e.error)throw Error("Failed to update feature flag");return e}),{loading:"".concat(e?"Enabling":"Disabling"," ").concat(r," ..."),success:"".concat(e?"Enabled":"Disabled"," ").concat(r),error:s.bW}),[r,a]),C=[{Header:"Workspace",Cell:e=>{let{cell:{row:{original:{workspaceName:t}}}}=e;return(0,o.jsx)("div",{children:t})}},{Header:"Account Type",Cell:e=>{let{cell:{row:{original:{workspaceAccountType:t}}}}=e;return(0,o.jsx)("div",{children:(0,v.LF)(t)})}},{Header:"Enabled",Cell:e=>{let{cell:{row:{original:{enabled:t,workspaceId:a}}}}=e;return(0,o.jsx)(j.rs,{checked:t,onChange:)}}];return(0,o.jsx)(c.Z,{...t,title:"Feature Flags",isRaw:!0,children:(0,o.jsxs)("div",{className:"inline-block h-[75vh] w-full max-w-[97vw] transform overflow-scroll rounded-lg bg-white p-4 shadow-xl sm:align-middle",children:[(0,o.jsxs)("div",{className:"mb-2 mr-auto flex gap-x-4 text-left",children:[(0,o.jsxs)("div",{className:"w-1/5",children:[(0,o.jsx)("label",{className:"label-small",children:"Account Type"}),(0,o.jsx)(i.Z,{items:w,selected:p,onChange:e=>{let{value:t}=e;return m(t)}})]}),(0,o.jsxs)("div",{className:"w-1/5",children:[(0,o.jsx)("label",{className:"label-small",children:"Feature Flag"}),(0,o.jsx)(i.Z,{items:M.map(,selected:r,onChange:)]})]}),(0,o.jsx)(d.Z,{loading:k,columns:C,data:N})]})})}var k=a(53954);function FeatureFlagSwitch(e){let{featureFlagOption:{name:t,value:a},workspace:n,...r}=e,l=(0,k.NK)(n,a);return(0,o.jsx)(j.rs,{checked:l,label:(0,o.jsx)("div",{className:"flex items-center text-sm",children:t}),...r})}function FeatureFlagTable(e){let{groupedFeatureFlagOptions:t,workspace:a,toggleFeatureFlag:n}=e;return(0,o.jsx)("div",{className:"grid gap-y-6",children:Object.entries(t).map(e=>{let[t,l]=e;return(0,o.jsxs)("div",{className:"rounded border",children:[(0,o.jsxs)("div",{className:"rounded-t border-b bg-gray-50 px-5 py-2 text-base font-semibold",children:[(0,o.jsx)("div",{className:"text-base font-semibold",children:t}),t===r.INTERNAL_TESTING&&(0,o.jsx)("div",{className:"text-xs",children:"For Navattic internal use only"})]}),(0,o.jsx)("div",{className:"grid gap-y-6 px-2 py-4",children:l.map(e=>(0,o.jsx)(FeatureFlagSwitch,{featureFlagOption:e,onChange:workspace:a},e.value))})]},t)})})}var F=a(66227),N=a(56268);function closeWorkspace_templateObject(){let e=(0,u._)(["\n    mutation CloseWorkspace($id: String!, $isClosed: Boolean!) {\n  closeWorkspace(id: $id, isClosed: $isClosed) {\n    id\n    isClosed\n  }\n}\n    "]);return closeWorkspace_templateObject=function(){return e},e}let D=(0,p.ZP)(closeWorkspace_templateObject());function updateUserFeatureFlag_templateObject(){let e=(0,u._)(["\n    mutation UpdateUserFeatureFlag($featureFlag: FeatureFlagUser!, $isOn: Boolean!) {\n  updateUserFeatureFlag(featureFlag: $featureFlag, isOn: $isOn) {\n    id\n    featureFlags {\n      id\n      name\n    }\n  }\n}\n    "]);return updateUserFeatureFlag_templateObject=function(){return e},e}let C=(0,p.ZP)(updateUserFeatureFlag_templateObject());var S=a(9602),R=a(60696);let teamLimitFromPlanType=var A=a(95965);et W=(0,p.ZP)(workspaceDataDeletionRequest_templateObject());function createWorkspaceDataDeletionRequest_templateObject(){let e=(0,u._)(["\n    mutation CreateWorkspaceDataDeletionRequest($workspaceId: String!) {\n  createWorkspaceDataDeletionRequest(workspaceId: $workspaceId) {\n    ...WorkspaceDataDeletionRequest\n  }\n}\n    ",""]);return createWorkspaceDataDeletionRequest_templateObject=function(){return e},e}let I=(0,p.ZP)(createWorkspaceDataDeletionRequest_templateObject(),W);function listWorkspaceDataDeletionRequests_templateObject(){let e=(0,u._)(["\n    query ListWorkspaceDataDeletionRequests($workspaceId: String!) {\n  workspaceDataDeletionRequests(workspaceId: $workspaceId) {\n    ...WorkspaceDataDeletionRequest\n  }\n}\n    ",""]);return listWorkspaceDataDeletionRequests_templateObject=function(){return e},e}let E=(0,p.ZP)(listWorkspaceDataDeletionRequests_templateObject(),W);var O=a(46085);function DeleteWorkspaceDataModal(e){var t;let{open:a,handleClose:n,workspace:r}=e,[s,i]=(0,l.useState)(""),[{data:d}]=(t={variables:{workspaceId:r.id}},g.aM({query:E,...t})),[,u]=g.Db(I),p=null==d?void 0:d.workspaceDataDeletionRequests.find(e=>e.status===f.hP.InProgress||e.status===f.hP.Pending),m=null==d?void 0:d.workspaceDataDeletionRequests.find(,h=s===r.slug,handleCreateRequest=async()=>{await u({workspaceId:r.id})};return(0,o.jsx)(c.Z,{title:"Delete Workspace Data",open:a,handleClose:n,handleNext:handleCreateRequest,nextText:"Submit",nextDisabled:!h,hideFooter:void 0!==p,nextOnEnter:!0,children:p?(0,o.jsx)(PendingWorkspaceDataDeletionDetails,{request:p}):(0,o.jsx)(RequestWorkspaceDataDeletion,{inputtedSlug:s,setInputtedSlug:i,lastCompletedRequest:m})})}t P=[{name:"Base",value:f.Iv.Base},{name:"Startup",value:f.Iv.Startup},{name:"Growth",value:f.Iv.Growth},{name:"Enterprise",value:f.Iv.Enterprise},{name:"None",value:f.Iv.None}],U=Array.from(Array(51).keys()).map(e=>({name:"".concat(e),value:Number(e)}));(n=r||(r={})).WORKSPACE_ORGANIZATION="Workspace Organization",n.ADVANCED_FEATURES="Advanced Features",n.CUSTOMER_TESTING="Customer Testing",n.INTERNAL_TESTING="Internal Testing";let M=[{name:"SSO",value:f.TT.Sso,group:"Workspace Organization"},{name:"Directory Sync (SCIM)",value:f.TT.DirectorySync,group:"Internal Testing"},{name:"Enhanced Permissions",value:f.TT.EnhancedPermissions,group:"Workspace Organization"},{name:"Audio player",value:f.TT.AudioPlayer,group:"Customer Testing"},{name:"Launchpad",value:f.TT.Launchpad,group:"Advanced Features"},{name:"Audit Logs",value:f.TT.AuditLogs,group:"Workspace Organization"},{name:"Account-Based Lead Enrichment",value:f.TT.Enrichment,group:"Advanced Features"},{name:"Offline",value:f.TT.Offline,group:"Advanced Features"},{name:"Click to capture",value:f.TT.ClickToCapture,group:"Customer Testing"},{name:"Session export",value:f.TT.SessionsExport,group:"Customer Testing"},{name:"Allow Dev Tool Edits",value:f.TT.DevToolEdits,group:"Internal Testing"},{name:"Mass Editor",value:f.TT.MassEditor,group:"Customer Testing"},{name:"Multilingual",value:f.TT.Multilingual,group:"Internal Testing"},{name:"IP Geolocation tracking",value:f.TT.IpGeoTracking,group:"Internal Testing"},{name:"Personalized Navigation Actions",value:f.TT.PersonalizationNavigation,group:"Customer Testing"},{name:"Project Tracking Scripts",value:f.TT.TrackingScripts,group:"Customer Testing"},{name:"Video Captures",value:f.TT.VideoCaptures,group:"Customer Testing"},{name:"Jump to Step",value:f.TT.JumpToStep,group:"Customer Testing"}],$=M.reduce({}),_=["Workspace Organization","Advanced Features","Customer Testing","Internal Testing"].reduce({}),LocalStorageSwitch=RootControlSection=e=>{let{title:t,description:a,children:n}=e;return(0,o.jsxs)("div",{className:"max-w-md",children:[(0,o.jsx)("h2",{className:"mb-1 text-lg font-semibold leading-6 text-gray-900",children:t}),(0,o.jsx)("p",{className:"text-sm text-gray-600",children:a}),(0,o.jsx)("div",{className:"mt-8",children:n})]})},AdministrationSection=unction SettingsRootUserControls(){let{workspace:e}=(0,k.cF)(),{currentUser:t}=(0,k.xJ)(),[,a]=g.Db(C),handleUpdateUserFeatureFlag=async e=>{let{value:t,isOn:n}=e;y.A.promise(a({featureFlag:t,isOn:n}).then(,{loading:"".concat(n?"Enabling":"Disabling"," ").concat(t," ..."),success:"".concat(n?"Enabled":"Disabled"," ").concat(t),error:s.bW})};return(0,o.jsx)(AdministrationSection,{title:"Navattic Internal User Administration",children:(0,o.jsx)(RootControlSection,{title:"Personal settings",description:"Custom settings that are local to your browser only",children:(0,o.jsxs)("div",{className:"grid gap-y-6",children:[(0,o.jsx)(j.rs,{checked:(0,k.sg)(t,f.lR.ImportExportProject),onChange:label:"Import / Export Product Demos"}),(0,o.jsx)(LocalStorageSwitch,{disabled:!1,persistKey:generateDemoDataKey(e.id),name:"Show demo data for Visitors / Analytics"})]})})})}function SettingsRootAccountControls(){let[,e]=(0,S.M)(),[,t]=g.Db(D),[,a]=g.Db(h),[n,r]=(0,l.useState)(void 0),[c,d]=(0,l.useState)(!1),[u,p]=(0,l.useState)(!1),{workspace:m}=(0,k.cF)(),handleUpdateFeatureFlag=async e=>{let{value:t,isOn:n}=e;y.A.promise(a({workspaceId:m.id,featureFlag:t,isOn:n}).then(e=>{if(e.error)throw Error("Failed to update feature flag");return e}),{loading:"".concat(n?"Enabling":"Disabling"," ").concat(t," ..."),success:"".concat(n?"Enabled":"Disabled"," ").concat(t),error:s.bW})},handleUpdateCloseWorkspace=async e=>{y.A.promise(t({id:m.id,isClosed:e}),{loading:"".concat(e?"Closing":"Opening"," workspace ..."),success:"".concat(e?"Closed":"Opened"," workspace"),error:s.bW})},handleUpdateAccountType=async t=>{let{value:a}=t;y.A.promise(e({id:m.id,accountType:a}),{loading:"Updating account type",success:"Updated account type",error:s.bW})},handleUpdatePlanType=async t=>{let{value:a}=t;y.A.promise(e({id:m.id,planType:a}),{loading:"Updating plan type",success:"Updated plan type",error:s.bW})},handleUpdateBranding=async t=>{y.A.promise(e({id:m.id,showNavatticBranding:t}),{loading:"".concat(t?"Enabling":"Disabling"," navattic branding ..."),success:"".concat(t?"Enabled":"Disabled"," navattic branding"),error:s.bW})},handleUpdateHideAccountsTab=async t=>{y.A.promise(e({id:m.id,hideAccountsTab:t}),{loading:"".concat(t?"Hiding":"Showing",' "Accounts" tab ...'),success:'"Accounts" tab is '.concat(t?"hidden":"visible"),error:s.bW})},handleUpdatePaymentMethodRequired=async t=>{y.A.promise(e({id:m.id,paymentMethodRequired:t}),{loading:"".concat(t?"Enabling":"Disabling"," payment method required ..."),success:"".concat(t?"Enabled":"Disabled"," payment method required"),error:s.bW})},handleUpdateTrialEndDate=async t=>{let a=t.target.value;if(r(a),void 0===a)return;let n=new Date;n.setDate(n.getDate()+parseInt(a)||0),y.A.promise(e({id:m.id,trialEndDate:n.toISOString()}),{loading:"Updating trial days left",success:"Updated trial days left",error:s.bW})},handleUpdateTeamLimit=async t=>{let{value:a}=t;y.A.promise(e({id:m.id,teamLimit:a}),{loading:"Updating team limit",success:"Updated team limit",error:s.bW})},b=m.trialEndDate&&Math.ceil((new Date(m.trialEndDate).getTime()-Date.now())/864e5);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(AdministrationSection,{title:"Navattic Workspace Administration",children:(0,o.jsx)("div",{className:"grid gap-y-14",children:(0,o.jsxs)(RootControlSection,{title:"Account",description:"Settings related to managing a Navattic customer account",children:[(0,o.jsx)(j.oi,{labelText:"Workspace ID",className:"mb-4 w-full",disabled:!0,value:m.id}),(0,o.jsx)(i.Z,{label:"Workspace account type",items:T,placeHolder:"Select an account type",field:"name",className:"mb-3 w-full flex-1",onChange:handleUpdateAccountType,selected:m.accountType}),m.accountType===f.SO.Trial&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("label",{className:"label-small",children:"Days left in trial"}),(0,o.jsx)("input",{className:"input-base",type:"number",value:n||b||0,onChange:handleUpdateTrialEndDate})]}),(0,o.jsx)(i.Z,{label:"Workspace plan type",items:P,placeHolder:"Select a plan type",field:"name",className:"mb-3 w-full flex-1",onChange:handleUpdatePlanType,selected:m.planType,hasError:m.accountType===f.SO.Customer&&m.planType===f.Iv.None}),(0,o.jsx)(i.Z,{label:"Team count",items:[{name:"Default for plan (".concat(teamLimitFromPlanType(m.planType),")"),value:null},...U],placeHolder:"Select a plan type",field:"name",className:"mb-3 w-full flex-1",onChange:handleUpdateTeamLimit,selected:m.teamLimit}),(0,o.jsx)(j.rs,{className:"my-5",checked:m.showNavatticBranding||!1,onChange:()=>handleUpdateBranding(!(null==m?void 0:m.showNavatticBranding)),label:"Show Navattic branding"}),(0,o.jsx)(j.rs,{className:"my-5",checked:m.hideAccountsTab||!1,onChange:label:(0,o.jsx)("div",{className:"flex items-center text-sm",children:'Hide "Accounts" tab'})}),(0,o.jsx)(j.rs,{className:"my-5",checked:m.paymentMethodRequired||!1,onChange:label:(0,o.jsxs)("div",{className:"flex items-center text-sm",children:["Payment method required",(0,o.jsx)(N.Z,{className:"ml-2 text-sm",colorClassName:"text-gray-400 hover:text-gray-500",descriptionClassName:"w-56 p-2 font-normal",children:"A banner will prompt all members to add a payment method. Members will be unable to use the app."})]})}),(0,o.jsx)(F.Z,{children:(0,o.jsxs)("div",{className:"flex flex-col gap-1",children:[m.isClosed?(0,o.jsx)("button",{className:"btn-gray-border",onClick:()=>handleUpdateCloseWorkspace(!1),children:"Open workspace"}):(0,o.jsx)("button",{className:"btn-red",onClick:()=>handleUpdateCloseWorkspace(!0),children:"Close workspace"}),(0,o.jsx)("button",{className:"btn-red",disabled:!m.isClosed,onClick:()=>d(!0),children:"Delete all workspace data"})]})})]})})}),(0,o.jsx)(AdministrationSection,{title:"Navattic Workspace Feature Flags",children:(0,o.jsxs)(RootControlSection,{title:"Feature Flags",description:"Limited access features to enable across a workspace",children:[(0,o.jsx)(FeatureFlagManagementModal,{open:u,handleClose:()=>p(!1)}),(0,o.jsx)("button",{className:"btn-zinc mb-4 ml-auto mr-0 whitespace-nowrap px-4 py-2 text-sm font-medium",onClick:()=>p(!0),children:"Manage"}),m&&(0,o.jsx)(FeatureFlagTable,{groupedFeatureFlagOptions:_,workspace:m,toggleFeatureFlag:handleUpdateFeatureFlag})]})}),(0,o.jsx)(DeleteWorkspaceDataModal,{workspace:m,open:c,handleClose:)]})}},49323:87823:78066:},960},1991:function(e,t,a){a.d(t,{$T:function(){return apiProjectVersionIdRoute},CW:function(){return apiGuideVisitorsRoute},T6:function(){return apiIntegrationSalesforceSobjectsRoute},ZA:function(){return apiIntegrationMarketoProgramsRoute},e9:function(){return previewFlowFlowIdRoute},g5:function(){return apiAuthSsoPortalRoute},g9:function(){return apiIntegrationMarketoFieldsRoute},h7:function(){return apiEnrichmentRoute},iu:function(){return apiGuideTimeMeasurementsRoute},nt:function(){return previewCaptureIdRoute},p3:function(){return previewProjectIdRoute},u4:function(){return apiEdgeExportVisitorsRoute},xH:function(){return apiEdgeExportAccountsRoute}});let previewProjectIdRoute=e=>{let{id:t}=e;return"/preview/project/".concat(t)},previewFlowFlowIdRoute=e=>{let{flow_id:t}=e;return"/preview/flow/".concat(t)},previewCaptureIdRoute=e=>{let{id:t}=e;return"/preview/capture/".concat(t)},apiProjectVersionIdRout},apiGuideVisitorsRoute=()=>"/api/guide/visitors",apiGuideTimeMeasurementsRoute=()=>"/api/guide/time-measurements",apiEnrichmentRoute=()=>"/api/enrichment",apiIntegrationSalesforceSobjectsRoute=()=>"/api/integration/salesforce/sobjects",apiIntegrationMarketoProgramsRoute=()=>"/api/integration/marketo/programs",apiIntegrationMarketoFieldsRoute=()=>"/api/integration/marketo/fields",apiEdgeExportVisitorsRoute=()=>"/api/edge/export/visitors",apiEdgeExportAccountsRoute=()=>"/api/edge/export/accounts",apiAuthSsoPortalRout"},4608}}]);
//# sourceMappingURL=8145-404c23d06fb07df5.js.map