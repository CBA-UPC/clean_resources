(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[760],{pITe:function(e,t,r){"use strict";r.r(t),r.d(t,"createTodo",();var o=r("QjXU"),n=r("g46F"),a=r("So0z"),s=r("a3FV"),i=r("qyk8"),c=r("jwpY"),d=r("zPk6"),u=r("fNDz"),l=function(e){var t=e.graphXhrOptions,r=e.list,n=void 0===r?"Tasks":r,a=e.todoTask;return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return[2,Object(c.a)(s.a.AddToToDoRequest,"Add_To_To_Do",Object(u.a)(t.graphApiRoot,Object(i.a)("me/todo/lists/{0}/tasks",n)),a,{method:"POST",headers:{"Content-Type":"application/json"}},t.jwtAuthEnabled,t.getAccessToken,t.officeApiRoot,t.correlationId,"Graph",{populateRequestEvent:function(e,t){t.RequestId=Object(d.a)(e)||""}},void 0,"Tasks.ReadWrite").then((function(e){if(!e||!e.ok||void 0===e.data)throw new Error((null==e?void 0:e.statusText)||"Graph API error");return e.data})).catch((function(e){var t,r;throw Object(o.__assign)(Object(o.__assign)({},e),{clientError:null===(r=null===(t=e.httpResponse.data)||void 0===t?void 0:t.error)||void 0===r?void 0:r.code})}))]}))}))},p=r("5ANk"),v=r("gd1C"),b=r("BULU"),f=r("EgtZ"),h=r("/DG8"),_=r("NkqM"),j=r("bb9Y"),O=function(e){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var t,r,n;return Object(o.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,Object(j.a)()];case 1:return t=a.sent(),r=t?Object(o.__spreadArray)(Object(o.__spreadArray)([],Object(o.__read)(t.coreAndSegmentApps),!1),Object(o.__read)(t.nonCoreAndSegmentApps),!1).find(():void 0,n=new URL(r?r.Url:""),[2,Object(_.a)("".concat(n.origin,"/tasks/").concat(e,"/details").concat(n.search))];case 2:throw a.sent(),new Error("No valid To Do workload found");case 3:return[2]}}))}))},T=function(e,t,r){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var t,s,i,c,d,u,_;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,7,,8]),t=e.todoTask,s="",[4,Object(b.a)()];case 1:if(i=o.sent().commanding,e.useSelection){if(!(c=r.result)||0===c.length)return[2,{result:n.a.Error,resultType:"errorMissingSelection"}];t.title=c[0].fileName}return e.navigate?[3,5]:[4,Object(h.a)()];case 2:return d=o.sent(),[4,l({graphXhrOptions:d,todoTask:t,list:"tasks"})];case 3:if(!(u=o.sent()).id)throw new Error("No task returned");return[4,O(u.id)];case 4:return s=o.sent(),[2,{command:[],result:n.a.Success,resultType:"open",eventCommand:{id:Object(p.a)(),type:a.a.CreateTodo,payload:{userFacingActionText:i.viewInTodo,todoTask:e.todoTask,navigate:!0,navigateUrl:s}}}];case 5:return[4,Object(v.a)(e.navigateUrl,{action:"OpenToDoLink"})];case 6:return o.sent(),[2,{result:n.a.Success,resultType:"opened"}];case 7:return _=o.sent(),[2,{command:[],result:n.a.Error,resultType:"itemNotFound"===(null==_?void 0:_.code)||404===(null==_?void 0:_.statusCode)?"errorNotSupported":"errorExecution",error:"Error creating todo",debugInfo:Object(f.b)(_)}];case 8:return[2]}}))}))}}}]);
//# sourceMappingURL=760.22a8d77c297db123f0b1.chunk.v7.js.map