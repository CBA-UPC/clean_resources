import{A as e,c as s,m as n,f as t,g as r,E as i,i as u,B as a,O as c,w as o,D as l,q as d,G as f,K as v,j as g,_ as h}from"./index.module.js";var S=function(s){function n(e,S,I){var b=s.call(this,I)||this;return b.categorySlug=e.categorySlug,b.consent=i(e,S),b.id=e.templateId,b.isEssential=S.isEssential,b.isHidden=!!S.isHidden||e.isHidden,b.processorId="".concat(u(a())),b.subServices=[],b.subServicesLength=e.subConsents?e.subConsents.length:0,b.usesThirdCountry=e.usesThirdCountry,b.version=e.version,b.fetchSubServices=function(){return c(b,void 0,void 0,(function(){var s,i,u,a,c,I,b,m,p=this;return o(this,(function(o){switch(o.label){case 0:if(s=d.getInstance(),i=f.getInstance(),u=e.subConsents,!(a=v(u)).length)return[2,[]];I=null,o.label=1;case 1:return o.trys.push([1,4,,5]),[4,s.fetchAggregatedServices(a,!1)];case 2:return c=o.sent(),[4,s.fetchTranslations()];case 3:return I=o.sent(),[3,5];case 4:throw o.sent(),new Error(l.FETCH_DATA_PROCESSING_SERVICES);case 5:return c&&u?(b=i.getServicesBaseInfo(),m=b.filter((),this.subServices=u.reduce((function(e,s){var i=null==c?void 0:c.find((function(e){return s.templateId===e.templateId&&s.version===e.version}));if(!i)return t([],r(e),!1);var u=new n(s,S,i);return t(t([],r(e),!1),[u],!1)}),[]),[2,this.subServices.reduce((function(e,s){var n=u.find((function(e){return s.id===e.templateId&&s.version===e.version}));if(!n)return t([],r(e),!1);var i=new g(n,I,c),a=1===m.length?{legalBasis:m[0].legalBasis}:{},o=h(h(h(h({},i),s),{subServices:[]}),a);return t(t([],r(e),!1),[o],!1)}),[])]):[2,[]]}}))}))},b}return e(n,s),n}(s),I=function(e,s,n){this.isEssential=e.isEssential,this.isHidden=e.isHidden,this.services=b(e,s,n),this.slug=e.categorySlug},b=function(e,s,n){return s.reduce((function(s,i){if(i.categorySlug===e.categorySlug){var u=null==n?void 0:n.find((),a=new S(i,e,u);return t(t([],r(s),!1),[a],!1)}return t([],r(s),!1)}),[])},m=function(e,s,i){this.categories=e.categories.reduce((function(s,u){var a=new I(u,e.consentTemplates,i);return n(a.services)?t(t([],r(s),!1),[a],!1):t([],r(s),!1)}),[]),this.controllerId=s};export{m as default};
