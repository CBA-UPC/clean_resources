(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{1376:function(e,t,a){},150:151:152:function(e,t,a){"use strict";r c=a(166);function i(e){return function(){var t,a,i,l=n(e);if()){var s=n(this).constructor;t=Reflect.construct(l,arguments,s)}else t=l.apply(this,arguments);return a=this,!(i=t)||"object"!==r(i)&&"function"!==typeof i?Object(c.a)(a):i}}a.d(t,"a",function(){return i})},1528:function(e,t,a){"use strict";a.r(t),a.d(t,"default",function(){return u});var n=a(150),r=a(151),c=a(153),i=a(152),l=a(0),s=a.n(l),o=a(708),d=a(35),u=(a(1376),function(e){Object(c.a)(a,e);var t=Object(i.a)(a);function a(){var e;return Object(n.a)(this,a),(e=t.call(this)).toggleAdditionalStops=e.addStopPackages=function(t){e.setState({addPackage:!0,newPkgQuantity:t||1})},e.removeStopPackages=e.setQuantity=function(t){var a=t.target.value;e.setState({newPkgQuantity:parseInt(a,10)})},e.selectMenu=function(){var t=e.state.newPkgQuantity;return s.a.createElement(s.a.Fragment,null,s.a.createElement("span",{className:"select-menu"},"Qty:",s.a.createElement("select",{onChange:e.setQuantity,value:t},s.a.createElement("option",{value:1},"1"),s.a.createElement("option",{value:2},"2"),s.a.createElement("option",{value:3},"3"),s.a.createElement("option",{value:4},"4"),s.a.createElement("option",{value:5},"5"))),s.a.createElement("span",{className:"price"},199*t),s.a.createElement("span",{className:"remove-package"},s.a.createElement(d.a,{className:"remove-package-btn",handleClick:e.removeStopPackages},s.a.createElement("i",{className:"material-icons"},"remove_circle"),"\xa0 Remove Package")))},e.state={addPackage:!1,newPkgQuantity:0},e}return Object(r.a)(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.stripeId,a=e.packageQuantity,n=e.history,r=e.selectedPlan.name;t||"starter"!==r||n.push("/home/settings/subscription"),a!==this.state.newPkgQuantity&&this.addStopPackages(a)}},{key:"render",value:function(){var e=this.props,t=e.upgradeAccount,a=e.updatePackageQuantity,n=e.packageQuantity,r=e.email,c=e.stripeId,i=e.tier,l=e.changePlan,u=e.updating,p=e.selectedPlan,m=p.name,g=p.description,h=p.price,y=e.paymentData,b=e.stripeError,f=e.setStripeError,E=e.accountName,N=this.state,v=N.addPackage,k=N.newPkgQuantity;return s.a.createElement("main",null,s.a.createElement("header",null,s.a.createElement("h2",null,c?"Update your Tour Builder plan":"Finish upgrading your plan"),s.a.createElement("p",null,c?"Add or remove tour stop packages, or change plans":"We can't wait to see what you build")),s.a.createElement("section",{className:"checkout"},s.a.createElement("div",{className:"selected-package"},s.a.createElement("h3",null,m),s.a.createElement(d.a,{handleClick:,"Change Plan"),s.a.createElement("span",{className:"price"},h),s.a.createElement("p",{className:"starter"===m?"package-desc starter":"package-desc"},g&&g.map()),"starter"!==m&&s.a.createElement("div",{className:"package-wrapper"},s.a.createElement(d.a,{style:{color:v?"#4a4a4a":"#62789d"},className:"add-package-btn",disabled:v,handleClick:this.toggleAdditionalStops},v?"Additional tour stop package (10 stops)":s.a.createElement(s.a.Fragment,null,s.a.createElement("i",{className:"material-icons"},"add_circle"),"\xa0 Add additional tour stops to your current plan")),v&&this.selectMenu()),"starter"!==m&&s.a.createElement(o.a,{email:r,price:h,newPkgQuantity:k,packageQuantity:n,newTier:m,currentTier:i,stripeId:c,accountName:E,upgradeAccount:t,updatePackageQuantity:a,updating:u,paymentSources:y,total:"".concat(h+199*k),stripeError:b,setStripeError:f}),s.a.createElement("div",{className:"total"},s.a.createElement("div",null,s.a.createElement("span",null,"Total tour stops"),s.a.createElement("span",null,10+10*k," stops")),s.a.createElement("div",null,s.a.createElement("span",{className:"billed-amt"},"Total amount to be billed"),s.a.createElement("span",{className:"price"},"".concat(h+199*k)))),s.a.createElement("p",{className:"terms"},"Your card will be charged your subscription total on this day each month. Completing this purchase is subject to agreeing to the Terms and Conditions. Subscription increases during a billing cycle will result in your next payment being prorated.")))}}]),a}(l.Component))},153:165:function(e,t,a){"use strict";var n=a(12),r=a(0),c=a.n(r),i=a(24),l=a.n(i),s=a(171),o=["charCount","classNames","displayError","displayWarning","editIcon","errorText","handleInput","handleKeyPress","handleKeyUp","hideErrorText","iconName","id","inputOptional","inputValue","label","labelAbove","maxCount","name","showCount","type"],d=Object(r.memo)(function(e){var t=e.charCount,a=e.classNames,r=e.displayError,i=e.displayWarning,d=e.editIcon,u=e.errorText,p=e.handleInput,m=e.handleKeyPress,g=e.handleKeyUp,h=e.hideErrorText,y=e.iconName,b=e.id,f=e.inputOptional,E=e.inputValue,N=e.label,v=e.labelAbove,k=e.maxCount,C=e.name,w=e.showCount,S=void 0===w||w,P=e.type,I=Object(n.a)(e,o);return c.a.createElement(s.a,{charCount:t,classNames:a,displayWarning:i,displayError:r,editIcon:d,errorText:u,hideErrorText:h,iconName:y,id:b,inputOptional:f,label:N,labelAbove:v,maxCount:k,showCount:S},c.a.createElement("input",Object.assign({id:b,type:P||"text",value:E||"",onChange:p,onKeyPress:m,onKeyUp:g,maxLength:k,className:l()({error:r,warning:i}),name:C,"data-testid":b},I)))});t.a=d},166:171:function(e,t,a){"use strict";var n=a(150),r=a(151),c=a(153),i=a(152),l=a(0),s=a.n(l),o=a(1),d=(a(177),function(e){var t=e.inputId,a=e.label,n=e.displayError,r=e.displayWarning,c=e.inputOptional,i=e.editIcon,l=e.ariaHidden;return s.a.createElement("label",{style:Object(o.a)(Object(o.a)({},n&&{color:"#a23f3f"}),r&&{color:"#b18830"}),htmlFor:t,"aria-hidden":l||!1},a,c&&s.a.createElement("span",null,"(Optional)"),i&&s.a.createElement("i",{className:"material-icons"},"edit"))}),u=a(24),p=a.n(u),m=function(e){var t=e.id,a=e.hideErrorText,n=e.errorText,r=e.label,c=e.displayWarning;return s.a.createElement(s.a.Fragment,null,!a&&s.a.createElement("div",{"data-testid":"".concat(t,"-input-error"),className:p()("input-error",{warning:c})},n||"".concat(r," is a required field")))},g=function(e){var t=e.iconName,a=e.iconClasses;return s.a.createElement("div",{className:"input-icon ".concat(a)},s.a.createElement("i",{"aria-hidden":"true",className:"material-icons"},t))},h=function(e){var t=e.max,a=e.count;return e.inputDisabled?null:s.a.createElement("div",{className:"char-count"},t-a)},y=(a(178),function(e){Object(c.a)(a,e);var t=Object(i.a)(a);function a(){var e;return Object(n.a)(this,a),(e=t.call(this)).enableInput=e.state={inputDisabled:!0},e}return Object(r.a)(a,[{key:"render",value:function(){var e=this.state.inputDisabled,t=this.props,a=t.charCount,n=t.children,r=t.classNames,c=t.displayError,i=t.displayWarning,l=t.editIcon,o=t.errorText,u=t.hideErrorText,p=t.iconClasses,y=t.iconName,b=t.id,f=t.inputOptional,E=t.label,N=t.labelAbove,v=t.maxCount,k=t.name,C=t.showCount,w=t.toolTipClickHandler,S=t.toolTipText;return s.a.createElement("div",{className:r},N&&s.a.createElement(d,{ariaHidden:!0,inputId:b,label:E,htmlFor:k,inputOptional:f,editIcon:l,displayError:c,displayWarning:i}),S&&s.a.createElement("span",{className:"form-interactive-tooltip",onClick:w},S),n,!N&&s.a.createElement(d,{ariaHidden:!0,inputId:b,label:E,htmlFor:k,inputOptional:f,editIcon:l,displayError:c,displayWarning:i}),C&&v&&s.a.createElement(h,{inputDisabled:e,max:v,count:a}),y&&s.a.createElement(g,{iconClasses:p,iconName:y}),(c||i)&&s.a.createElement(m,{id:b,displayWarning:i,hideErrorText:u,errorText:o,label:E}))}}]),a}(l.PureComponent));t.a=y},177:function(e,t,a){},178:function(e,t,a){},520:function(e,t,a){},694:708:function(e,t,a){"use strict";var n=a(150),r=a(151),c=a(153),i=a(152),l=a(0),s=a.n(l),o=a(555),d=a(6),u=a(2),p=a.n(u),m=a(3),g=a(4),h=a(24),y=a.n(h),b=a(55),f=a(35),E=(a(520),function(e){var t=e.brand,a=e.last4,n=e.exp_month,r=e.exp_year,c=e.cardholderData,i=(e.className,e.editable);return s.a.createElement(s.a.Fragment,null,i&&s.a.createElement("div",{className:"user-data-wrap"},c.map(function(e){return s.a.createElement("div",{className:"card-user-data ".concat(e.className),key:e.label},s.a.createElement("span",{className:"label"},e.label),s.a.createElement("span",{className:"content"},e.content))})),s.a.createElement("div",{className:"card-data"},s.a.createElement("span",null,s.a.createElement("i",{className:"material-icons"},"credit_card"),"\xa0 ",t),s.a.createElement("span",null,"**** **** ****"),s.a.createElement("span",null,a),s.a.createElement("span",{className:"exp"},"".concat(n,"/").concat(r))))}),N=function(e){var t=e.error,a=e.resetError;return s.a.createElement("p",{className:"card-error"},t,s.a.createElement("span",{onClick:,s.a.createElement("i",{className:"material-icons"},"add_circle")))},v=function(e){var t=e.paymentSources,a=e.editable,n=e.editCard,r=e.error,c=e.resetError,i=t[0],l=i.brand,o=i.last4,d=i.exp_month,u=i.exp_year,p=i.name,m=i.address_line1,g=i.address_city,h=i.address_state,y={cardholderName:p,billingAddress:m,city:g,state:h};return s.a.createElement("div",{className:a?"existing-card editable":"existing-card"},!a&&s.a.createElement("h3",{className:"form-title"},"Payment Information"),!a&&s.a.createElement("h4",null,"Saved Card"),s.a.createElement(E,{editable:a,brand:l,last4:o,exp_month:d,exp_year:u,cardholderData:[{label:"cardholder name",content:p,className:"name"},{label:"billing address",content:m,className:"address"},{label:"city",content:g,className:"city"},{label:"state",content:h,className:"state"}]}),r&&s.a.createElement(N,{error:r,resetError:c}),a?s.a.createElement(f.a,{className:"update-card-btn",handleClick:,s.a.createElement("i",{className:"material-icons"},"edit"),"\xa0Update Card Information"):s.a.createElement(b.a,{className:"edit-payment-btn",to:"/home/settings/account"},s.a.createElement("i",{className:"material-icons"},"mode_edit"),"\xa0 Change payment method"))},k=a(165),C=a(54),w=function(e){var t=e.stripeId,a=e.editable,n=e.changed,r=e.updating,c=e.handleUpgrade,i=e.editingCard,l=e.addNewCard,o=e.updatePaymentMethod,d=(e.validateForm,e.toggleEditCard),u=e.toggleNewCard,p=e.errors;return s.a.createElement("footer",null,a?(i||l)&&s.a.createElement("div",{className:"btn-wrapper"},s.a.createElement(f.a,{className:r?"save-card-btn":"save-card-btn check",disabled:Boolean(p.length),handleClick:o},r&&s.a.createElement(C.ClipLoader,{color:"#2560a6",size:13}),"\xa0 Save Card"),s.a.createElement(f.a,{className:"cancel-card-btn",handleClick:i?d:u},s.a.createElement("i",{className:"material-icons"},"cancel"),"\xa0 Cancel")):s.a.createElement(f.a,{className:"complete-btn",disabled:Boolean(p.length)||!n,handleClick:c},t?s.a.createElement("span",null,r?s.a.createElement(C.ClipLoader,{color:"#2560a6",size:12}):s.a.createElement("i",{className:"material-icons"},"update"),"\xa0 Update Plan"):s.a.createElement("span",{className:r?"":"check"},r&&s.a.createElement(C.ClipLoader,{color:"#2560a6",size:13}),"\xa0 Complete Upgrade")))},S=function(e){Object(c.a)(a,e);var t=Object(i.a)(a);function a(){var e;return Object(n.a)(this,a),(e=t.call(this)).handleChange=function(t){var a=e.state.errors,n=t.target,r=n.name,c=n.value;c&&a.includes(r)&&e.setState({errors:a.filter(}),e.setState(},e.createStripeToken=Object(m.a)(p.a.mark(function t(){var a,n,r,c,i,l,s,o;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.state,n=a.billingAddress,r=a.city,c=a.state,i=a.cardholderName,t.prev=1,t.next=4,e.props.stripe.createToken({name:i,address_line1:n,address_city:r,address_state:c});case 4:if(l=t.sent,s=l.token,!(o=l.error)){t.next=11;break}e.props.setStripeError(o.message),t.next=12;break;case 11:return t.abrupt("return",s);case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(1),console.error(t.t0);case 17:case"end":return t.stop()}},t,null,[[1,14]])})),e.createStripeCustomer=Object(m.a)(p.a.mark(function t(){var a,n,r,c,i,l,s,o;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.props,n=a.newPkgQuantity,r=a.stripeId,c=a.newTier,i=a.upgradeAccount,l=a.email,t.next=3,e.createStripeToken();case 3:(s=t.sent)&&(o=Object.assign({},s,{userId:localStorage.getItem("uid"),accountId:localStorage.getItem("aid"),accountName:e.state.accountName,packageQuantity:n,email:l,stripeId:r,newTier:c}),e.validateForm(o,i));case 5:case"end":return t.stop()}},t)})),e.updateStopPackages=function(){var t=e.props,a=t.newPkgQuantity,n=t.stripeId,r=t.newTier;(0,t.upgradeAccount)({accountName:t.accountName,stripeId:n,packageQuantity:a,newTier:r,userId:localStorage.getItem("uid"),accountId:localStorage.getItem("aid")})},e.updatePaymentMethod=Object(m.a)(p.a.mark(function t(){var a,n,r,c,i,l,s,o,d,u,m,g,h,y;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.state,n=a.billingAddress,r=a.city,c=a.state,i=a.cardholderName,l=a.addNewCard,s=e.props,o=s.updatePaymentSource,d=s.addNewPaymentSource,u=s.stripeId,m=s.paymentSources,!l){t.next=9;break}return t.next=5,e.createStripeToken();case 5:(g=t.sent)&&(h=Object.assign({},g,{userId:localStorage.getItem("uid"),stripeId:u,oldCardId:m[0].id,callback:e.toggleNewCard}),e.validateForm(h,d)),t.next=11;break;case 9:y={stripeId:u,userId:localStorage.getItem("uid"),cardData:{id:m[0].id,name:i,address:n,city:r,state:c},callback:e.toggleEditCard},e.validateForm(y,o);case 11:case"end":return t.stop()}},t)})),e.editCard=function(t){var a=t.cardholderName,n=t.billingAddress,r=t.city,c=t.state;e.setState({editingCard:!0,cardholderName:a,billingAddress:n,city:r,state:c})},e.toggleNewCard=function(){e.setState({addNewCard:!e.state.addNewCard})},e.toggleEditCard=e.handleUpgrade=e.validateForm=function(t,a){var n=e.props,r=n.editable,c=n.stripeId,i=[];for(var l in e.state)!r&&c||"string"!==typeof e.state[l]||!Boolean(e.state[l].length)&&i.push(l);e.setState(function(){!Boolean(e.state.errors.length)&&a(t)})},e.state={accountName:"",cardholderName:"",billingAddress:"",city:"",state:"",editingCard:!1,addNewCard:!1,changed:!1,errors:[]},e}return Object(r.a)(a,[{key:"componentDidMount",value:,{key:"componentDidUpdate",value:function(e,t){var a=this.state.changed,n=this.props,r=n.packageQuantity,c=n.currentTier,i=n.newTier;a||e.newPkgQuantity===r&&i===c||this.setState({changed:!0}),a&&e.newPkgQuantity===r&&i===c&&this.setState({changed:!1})}},{key:"render",value:function(){var e=this.state,t=e.accountName,a=e.cardholderName,n=e.billingAddress,r=e.city,c=e.state,i=e.editingCard,l=e.changed,d=e.addNewCard,u=e.errors,p=this.props,m=p.paymentSources,g=p.updating,h=p.stripeId,b=p.packageQuantity,E=p.editable,C=p.stripeError,S=p.setStripeError,P=y()({editable:E,error:C});return s.a.createElement(s.a.Fragment,null,!h||i||d?s.a.createElement("form",{id:"checkout-form",className:P},s.a.createElement(s.a.Fragment,null,!d&&!i&&s.a.createElement(k.a,{label:"Organization Name",id:"account-name",classNames:"input-wrapper medium",name:"accountName",inputValue:t,handleInput:this.handleChange,placeholder:"Organization Name",displayError:u.includes("accountName")}),s.a.createElement("h3",null,"Update Card"),s.a.createElement(k.a,{label:"Cardholder Name",id:"cardholder-name",classNames:"input-wrapper medium",name:"cardholderName",inputValue:a,handleInput:this.handleChange,placeholder:"Cardholder Name",displayError:u.includes("cardholderName")}),s.a.createElement(k.a,{label:"Billing Address",id:"billing-address",classNames:"input-wrapper medium",name:"billingAddress",inputValue:n,handleInput:this.handleChange,placeholder:"Billing Address",displayError:u.includes("billingAddress")}),s.a.createElement(k.a,{label:"City",id:"city",classNames:"input-wrapper short",name:"city",inputValue:r,handleInput:this.handleChange,placeholder:"City",displayError:u.includes("city")}),s.a.createElement(k.a,{label:"State",id:"state",classNames:"input-wrapper vshort",name:"state",inputValue:c,handleInput:this.handleChange,placeholder:"State",displayError:u.includes("state")}),(d&&!i||!h)&&s.a.createElement(o.CardElement,{style:{base:{color:"#4a4a4a",fontSize:"14px",fontFamily:'"Open Sans", sans-serif',fontSmoothing:"antialiased","::placeholder":{color:"#ccc"}},invalid:{color:"#cc6666"}}}),C&&s.a.createElement(N,{error:C,resetError:S}))):s.a.createElement(s.a.Fragment,null,E&&s.a.createElement(f.a,{className:"add-card-btn",handleClick:this.toggleNewCard},s.a.createElement("i",{className:"material-icons"},"add_circle"),"\xa0 Add new card"),s.a.createElement(v,{paymentSources:m,packageQuantity:b,editCard:this.editCard,editingCard:i,editable:E,updatePaymentMethod:this.updatePaymentMethod,error:C,resetError:S})),s.a.createElement(w,{editable:E,stripeId:h,changed:l,handleUpgrade:this.handleUpgrade,updatePaymentMethod:this.updatePaymentMethod,editingCard:i,addNewCard:d,validateForm:this.validateForm,updating:g,toggleEditCard:this.toggleEditCard,toggleNewCard:this.toggleNewCard,errors:u}))}}]),a}(l.Component),P=Object(o.injectStripe)(S),I=(a(694),function(e){Object(c.a)(a,e);var t=Object(i.a)(a);function a(){var e;return Object(n.a)(this,a),(e=t.call(this)).state={stripe:null},e}return Object(r.a)(a,[{key:"componentDidMount",value:function(){var e=this;if(!document.getElementById("stripe-script")){var t=document.createElement("script");t.id="stripe-script",t.src="https://js.stripe.com/v3/",t.async=!0,t.onload=document.body&&document.body.appendChild(t)}}},{key:"render",value:function(){var e=this.props,t=e.email,a=e.price,n=e.updating,r=e.newPkgQuantity,c=e.packageQuantity,i=e.newTier,l=e.currentTier,d=e.stripeId,u=e.accountName,p=e.upgradeAccount,m=e.paymentSources,g=e.updatePackageQuantity,h=e.addNewPaymentSource,y=e.updatePaymentSource,b=e.total,f=e.editable,E=e.stripeError,N=e.setStripeError;return s.a.createElement("section",{id:"stripe-js"},s.a.createElement(o.StripeProvider,{stripe:this.state.stripe},s.a.createElement(o.Elements,null,s.a.createElement(P,{email:t,price:a,newPkgQuantity:r,packageQuantity:c,newTier:i,currentTier:l,stripeId:d,accountName:u,upgradeAccount:p,updating:n,updatePackageQuantity:g,addNewPaymentSource:h,updatePaymentSource:y,paymentSources:m&&m.sources.data,total:parseInt(b,10),editable:f,stripeError:E,setStripeError:N}))))}}]),a}(l.Component));t.a=I}}]);