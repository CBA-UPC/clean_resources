(self.webpackChunk_cleverpush_cleverpush_js_sdk=self.webpackChunk_cleverpush_cleverpush_js_sdk||[]).push([[407],{9407:function(e,t,n){"use strict";n.r(t),n.d(t,{default:);var i=n(6156),o=n(6610),s=n(5991),l=n(6034),r=n(3114),A=n(1078);n(8606);1804);var p=function(){function e(t,n,i,s,l,r){(0,o.Z)(this,e),this.config=t,this.subscriptionManager=n,this.isSubscribed=this.subscriptionManager.subscribed,this.api=i,this.confirm=s,this.triggerEvent=l,this.triggerOptIn=r,this.localization=this.getLocalization(),this.show=this.show.bind(this),this.reset=this.reset.bind(this),this.onClick=this.onClick.bind(this)}return(0,s.Z)(e,[{key:"initCleverPushTrigger",value:,{key:"getClassName",value:function(){var e="cleverpush-bell";return this.config.notificationBellPosition&&(e+=" cleverpush-bell-position-".concat(this.config.notificationBellPosition)),this.config.notificationBellPositionY&&(e+=" cleverpush-bell-position-".concat(this.config.notificationBellPositionY)),e}},{key:"initPrompt",value:function(){var e=this;if(!(this.promptInited||this.isSubscribed||window.innerWidth<768||localStorage.getItem("cleverpush-bell-prompt-denied"))){this.promptInited=!0;var t=this.confirm.getLocalization({});this.prompt=document.createElement("div"),this.prompt.className="cleverpush-bell-prompt",this.prompt.innerHTML='\n    <div class="cleverpush-bell-prompt-icon" style="background-image: url(\''.concat(this.config.channelIcon,'\')"></div>\n    <div class="cleverpush-bell-prompt-content">\n      <div class="cleverpush-bell-prompt-title">\n      ').concat(t.title,'\n      </div>\n      <div class="cleverpush-bell-prompt-buttons">\n      <button class="cleverpush-confirm-btn cleverpush-confirm-btn-deny">').concat(t.deny,'</button>\n        <button class="cleverpush-confirm-btn cleverpush-confirm-btn-allow" style="').concat(this.config.confirmAlertAllowButtonStyle&&this.config.confirmAlertAllowButtonStyle.color?"color: ".concat(this.config.confirmAlertAllowButtonStyle.color,";"):""," ").concat(this.config.confirmAlertAllowButtonStyle&&this.config.confirmAlertAllowButtonStyle.backgroundColor?"border-color: transparent !important; background: none; background-color: ".concat(this.config.confirmAlertAllowButtonStyle.backgroundColor,";"):"",'">').concat(t.allow,"</button>\n      </div>\n    </div>\n    "),this.promptAllow=this.prompt.querySelector(".cleverpush-confirm-btn-allow"),this.promptAllow&&this.promptAllow.addEventListener("click",(),this.promptDeny=this.prompt.querySelector(".cleverpush-confirm-btn-deny"),this.promptDeny&&this.promptDeny.addEventListener("click",(function(t){t.preventDefault(),t.stopPropagation(),localStorage.setItem("cleverpush-bell-prompt-denied","".concat(Date.now())),e.prompt.style.display="none"})),this.bell.appendChild(this.prompt)}}},{key:"getLocalization",value:function(){var e=this.config.bellLocalization||{},t=(0,r.ej)(this.config||{});return this.config.bellLocalizationTranslations&&t&&this.config.bellLocalizationTranslations[t]&&(e=c(c({},e),this.config.bellLocalizationTranslations[t])),{subscribe:(0,r.RG)(e.subscribe)||(0,r.Iu)("bell.subscribe"),subscribed:(0,r.RG)(e.subscribed)||(0,r.Iu)("bell.subscribed"),hide:(0,r.RG)(e.hide)||(0,r.Iu)("bell.hide"),settings:(0,r.RG)(e.settings)||(0,r.Iu)("panel.settings")}}},{key:"show",value:function(e){var t=this;(0,A.tI)("bell.show",e),this.initCleverPushTrigger(),this.isSubscribed=e;var n=!1;try{n="true"===localStorage.getItem("cleverpush-bell-hidden")}catch(e){}if(!n){var i,o=this.getClassName();e?(o+=" cleverpush-bell-disabled",i=this.localization.subscribed,this.config.hideNotificationBellSubscribed&&(o+=" cleverpush-bell-hidden")):i=this.localization.subscribe;var s="";this.config.notificationBellMoreButtons&&(s='<button type="button" class="cleverpush-bell-more-btn cleverpush-bell-more-settings" style="display: none"><svg viewBox="0 0 18 18" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M18.88 12.88a6.83 6.83 0 0 0 0-1.76l1.95-1.49a.45.45 0 0 0 .11-.57l-1.85-3.12c-.11-.2-.36-.27-.56-.2l-2.3.9a6.8 6.8 0 0 0-1.57-.88l-.35-2.38a.45.45 0 0 0-.46-.38h-3.7a.45.45 0 0 0-.45.38l-.35 2.38c-.57.23-1.09.53-1.57.88l-2.3-.9a.46.46 0 0 0-.57.2L3.06 9.06c-.12.2-.06.44.12.57l1.95 1.49a6.95 6.95 0 0 0 0 1.76l-1.95 1.49a.45.45 0 0 0-.12.57l1.85 3.12c.12.2.37.27.57.2l2.3-.9c.48.36 1 .65 1.57.88l.35 2.38c.03.22.22.38.45.38h3.7c.23 0 .43-.16.46-.38l.35-2.38a7.16 7.16 0 0 0 1.56-.88l2.3.9c.22.08.46 0 .57-.2l1.85-3.12a.45.45 0 0 0-.11-.57l-1.95-1.49zM12 15.15A3.2 3.2 0 0 1 8.76 12 3.2 3.2 0 0 1 12 8.85 3.2 3.2 0 0 1 15.24 12 3.2 3.2 0 0 1 12 15.15z" id="park-svg-settings-path-1"></path></defs><use xlink:href="#park-svg-settings-path-1" transform="translate(-3 -3)" stroke="none" stroke-width="1" fill-rule="evenodd"></use></svg><span class="cleverpush-tooltip">'.concat(this.localization.settings,'</span></button>\n<button type="button" class="cleverpush-bell-more-btn cleverpush-bell-more-subscribe" style="display: none"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 1000 1000" enable-background="new 0 0 1000 1000" xml:space="preserve">\n<g><path d="M380.6,989.9c-30.5,0-59.3-14.2-77.8-38.7L52.6,621C20,578,28.5,516.8,71.5,484.3c43-32.6,104.1-24.1,136.7,18.9l164.6,217.3L786.7,56c28.5-45.7,88.7-59.7,134.5-31.2c45.8,28.4,59.7,88.7,31.2,134.4L463.5,944c-17,27.4-46.4,44.5-78.5,45.9C383.6,990,382.1,990,380.6,989.9L380.6,989.9z"/></g>\n</svg><span class="cleverpush-tooltip">').concat(this.localization.subscribe,'</span></button>\n<button type="button" class="cleverpush-bell-more-btn cleverpush-bell-more-hide" style="display: none"><svg viewBox="0 0 8 8" version="1.1" xmlns="http://www.w3.org/2000/svg"><path d="M8 6.87L6.87 8 4 5.13 1.13 8 0 6.87 2.87 4 0 1.13 1.13 0 4 2.87 6.87 0 8 1.13 5.13 4z"></path></svg><span class="cleverpush-tooltip">').concat(this.localization.hide,"</span></button>\n")),this.bell=document.createElement("div"),this.bell.className=o,this.bell.innerHTML="".concat(s,"<div class='cleverpush-bell-message'>").concat(i,"</div>");var l=document.body;if(this.config.bellParentSelector&&(l=document.querySelector(this.config.bellParentSelector)||document.body),l.appendChild(this.bell),this.bell&&(this.bell.addEventListener("click",this.onClick.bind(this)),this.config.notificationBellColor&&this.config.notificationBellColor.length&&(this.bell.style.backgroundColor=this.config.notificationBellColor),this.config.notificationBellOffsetTop&&"bottom"!==this.config.notificationBellPositionY&&(this.bell.style.top="".concat(this.config.notificationBellOffsetTop,"px")),this.config.notificationBellOffsetBottom&&"top"!==this.config.notificationBellPositionY&&(this.bell.style.bottom="".concat(this.config.notificationBellOffsetBottom,"px")),this.config.notificationBellOffsetLeft&&"right"!==this.config.notificationBellPosition&&(this.bell.style.left="".concat(this.config.notificationBellOffsetLeft,"px")),this.config.notificationBellOffsetRight&&"left"!==this.config.notificationBellPosition&&(this.bell.style.right="".concat(this.config.notificationBellOffsetRight,"px")),this.config.notificationBellSize&&(this.bell.style.height="".concat(this.config.notificationBellSize,"px"),this.bell.style.width="".concat(this.config.notificationBellSize,"px")),this.config.notificationBellMoreButtons&&this.initMoreButtons()),this.config.showNotificationBellPrompt){var r=!0;if(this.config.notificationBellPromptVisits){var a=parseInt(localStorage.getItem("cleverpush-bell-prompt-visits"),10)||0;r=a>=this.config.notificationBellPromptVisits,a+=1,localStorage.setItem("cleverpush-bell-prompt-visits","".concat(a))}r&&setTimeout((,this.config.notificationBellPromptSeconds||0)}}}},{key:"initMoreButtons",value:function(){var e=this;this.settingsButton=this.bell.querySelector(".cleverpush-bell-more-settings"),this.settingsButton.onclick=function(t){t.stopPropagation(),e.moreButtonsVisible=!1,e.settingsButton.style.display="none",e.hideButton.style.display="none",e.config.notificationBellSettingsLink?window.open(e.config.notificationBellSettingsLink,"_blank"):e.showPanel()},this.subscribeButton=this.bell.querySelector(".cleverpush-bell-more-subscribe"),this.subscribeButton.onclick=function(t){t.stopPropagation(),e.moreButtonsVisible=!1,e.subscribeButton.style.display="none",e.hideButton.style.display="none",e.subscribe()},this.hideButton=this.bell.querySelector(".cleverpush-bell-more-hide"),this.hideButton.onclick=},{key:"reset",value:function(e){if((0,A.tI)("bell.reset",e),this.isSubscribed=e,this.moreButtonsVisible=!1,this.bell){var t,n=this.getClassName();e?(n+=" cleverpush-bell-disabled",this.config.hideNotificationBellSubscribed&&(n+=" cleverpush-bell-hidden"),t=this.localization.subscribed):t=this.localization.subscribe,this.bell.className=n;var i=this.bell.querySelector(".cleverpush-bell-message");i&&(i.innerHTML=t);var o=this.bell.querySelector(".cleverpush-loader");o&&o.parentNode&&o.parentNode.removeChild(o),this.config.notificationBellMoreButtons&&this.initMoreButtons()}e&&this.prompt&&(this.prompt.style.display="none")}},{key:"hideForever",value:function(){this.bell.style.setProperty("display","none","important"),localStorage.setItem("cleverpush-bell-hidden","true")}},{key:"showMessage",value:function(e,t){var n=this;if(this.bell){var i=this.bell.querySelector(".cleverpush-bell-message");i.className+=" cleverpush-bell-message-open",i.innerHTML=e,setTimeout((function(){i.innerHTML=n.localization.subscribe,i.className="cleverpush-bell-message"}),1e3*t)}}},{key:"showPanel",value:function(){this.panel||(this.panel=new l.default(this.config,this.subscriptionManager,this.triggerEvent,this.api)),this.panel.show()}},{key:"setLoading",value:function(){this.bell.className+=" cleverpush-bell-loading",this.bell.innerHTML+='<div class="cleverpush-loader"><div></div><div></div><div></div><div></div></div>'}},{key:"subscribe",value:function(){var e=this;(0,A.tI)("bell.subscribe");var t=this.subscriptionManager.getNotificationPermission(!0),n="default"===t;this.api.fromBellWidget=!0,this.api.confirmAlertShown(),this.subscriptionManager.isSubscribing||(A.cM.debug("showBackdrop",n),"denied"!==t&&this.setLoading(),this.triggerOptIn(!0,(function(t){t?(e.reset(e.isSubscribed),!e.config.ownDomain||"https:"!==location.protocol||"denied"!==t.reason&&"default"!==t.reason?A.cM.error(t):e.subscriptionManager.confirm&&e.subscriptionManager.confirm.showBackdrop(void 0,"denied",t.message)):e.subscriptionManager.getSubscriptionId().then(()})),this.confirm.resetBell(())}},{key:"toggleMoreButtons",value:function(){(0,A.tI)("bell.toggleMoreButtons");var e=this.bell.querySelector(".cleverpush-bell-message");this.moreButtonsVisible?(this.settingsButton.style.display="none",this.subscribeButton.style.display="none",this.hideButton.style.display="none",this.moreButtonsVisible=!1,this.isSubscribed&&(this.bell.className+=" cleverpush-bell-disabled"),e&&window.innerWidth<768&&(e.className="cleverpush-bell-message"),window.document.activeElement&&window.document.activeElement.blur()):(this.isSubscribed?(this.settingsButton.style.display="flex",this.bell.className=this.getClassName()):this.subscribeButton.style.display="flex",this.hideButton.style.display="flex",this.moreButtonsVisible=!0,e&&window.innerWidth<768&&(e.className+=" cleverpush-bell-message-open"))}},{key:"onClick",value:function(){var e=this;if((0,A.tI)("bell.onClick",!!this.bell),this.bell){"function"==typeof this.handleLoadSdk?(this.setLoading(),this.handleLoadSdk().then((function(){window.CleverPush.waitForBell().then(()})).catch(()):e.config.notificationBellMoreButtons?e.toggleMoreButtons():e.isSubscribed?e.showPanel():e.subscribe()}}}]),e}()},8606:5413:1667:1804:4451:]);
//# sourceMappingURL=407.997a9a798853a61f7e13.js.map