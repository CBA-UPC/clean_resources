!);var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"redpop@b474a6ad4354f4ba5fde672fa4e9c2c267684761"};"use strict";(self.webpackChunk_tumblr_redpop=self.webpackChunk_tumblr_redpop||[]).push([[7119],{94765:(e,t,a)=>{a.d(t,{Z:()=>h});var s=a(54138),n=a.n(s),l=a(9156),r=a(95004),o=a(78994),i=a(36485),c=a(22979),d=a(78667),u=a(26963),m=let h=e=>{var t=e.children,a=e.getEndpointApiRequestFromQueryParams,s=e.timelineName,u=(0,d.bp)().bestStuffFirstDisabled,h=(0,o.s0)(),p=(0,o.TH)(),v=p.pathname,x=p.search,b=p.state,j=(0,o.UO)(),g=(0,l.Z)((e,t,s,l,r)=>a(n()({max_post_id:t,v:s,"wrapped-timeline":l},r&&{cursor:r})),{maxSize:1});(0,r.useEffect)(()=>{var e=()=>{window.history.replaceState(n()(n()({},b),{},{paginationQueryParams:{}}),"")};return window.addEventListener("beforeunload",e),,[]);var f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0;return n()(n()(n()({},!t&&(null==b?void 0:b.paginationQueryParams)),m(e)),j)},y=f();return(0,r.cloneElement)(t,{endpointApiRequest:g(s,y.max_post_id,y.v,y["wrapped-timeline"],y.cursor),updateUrlFromCurrentPageLink:(e,t)=>{var a=f(e,t||!e);h((0,i.Z)(v,n()(n()({},m(x)),{},{max_post_id:a.max_post_id})),{state:n()(n()({},b),{},{paginationQueryParams:a})})},updateUrlFromObjects:e=>{if(u){var t,a=null==e||null===(t=e.filter(c.xT))||void 0===t?void 0:t[0];if(a){var s=a.id;"undefined"!=typeof BigInt&&(s=(BigInt(s)+BigInt(1)).toString()),h((0,i.Z)(v,n()(n()({},m(x)),{},{max_post_id:s})),{state:n()(n()({},b),{},{paginationQueryParams:{}})})}}},prevButtonIsRefresh:!!y.max_post_id})}},53852:(e,t,a)=>{a.d(t,{Z:()=>n});var s=(0,a(36343).q)("posts-photo",{altIcon:"posts-photo-alt"});s.defaultProps={size:{width:24,height:24},useAltIcon:!1};let n=s},931:(e,t,a)=>{a.d(t,{Z:()=>L});var s=a(50209),n=a.n(s),l=a(5754),r=a.n(l),o=a(95004),i=a(55351),c=a(90127),d=a(43452),u=a(5700),m=a(59215),h=a(44561),p=a(83875),v=a(39277),x=a(54138),b=a.n(x),j=a(81022),g=a(66052),f=a(48430),y=a(53852),C=a(75815),N=a(60951),P=a(40565),k=a(63583),w=a(70834),_=a(2629),E={height:35,width:40},Q={[u.hQ.Text]:(0,_.jsx)(N.Z,{colors:{primary:k.colorTextPostIcon},size:E}),[u.hQ.Photo]:(0,_.jsx)(y.Z,{colors:{primary:k.colorPhotoPost},size:E}),[u.hQ.Quote]:(0,_.jsx)(C.Z,{colors:{primary:k.colorQuotePost},size:E}),[u.hQ.Link]:(0,_.jsx)(f.Z,{colors:{primary:k.colorLinkPost},size:E}),[u.hQ.Chat]:(0,_.jsx)(g.Z,{colors:{primary:k.colorChatPost},size:E}),[u.hQ.Audio]:(0,_.jsx)(j.Z,{colors:{primary:k.colorAudioPost},size:E}),[u.hQ.Video]:(0,_.jsx)(P.Z,{colors:{primary:k.colorVideoPost},size:E})};let T=function(e){var t=e.postType,a=e.label,s=e.onClick,n=(0,w.I)("new-post-type-button");return(0,_.jsxs)("button",b()(b()({onClick:e=>s(e,t),className:"FOqaP","aria-label":a},n),{},{children:[(0,_.jsx)("span",{className:"ADK9v",children:Q[t]}),a]}))};class B extends o.Component{constructor(){super(...arguments),n()(this,"state",{}),n()(this,"onPostTypeButtonClick",(e,t)=>{(this.props.onPostCreation||this.createDefaultPost.bind(this))(t)})}tchBlog(){var e=this.props,t=e.selectedBlogName;return(0,e.appContext.getUserInfo)().then(e=>{var a=t?e.blogs.find(e=>e.name===t):(0,h.Z)(e.blogs);this.setState({blog:a})})}createDefaultPost(e){var t=this.props,a=t.navigate,s=t.saveButtonState,n=t.selectedBlogName;(0,t.appContext.logEvent)({eventName:(0,p.Y)(e),page:"toolbar"}),a((0,c.TL)({postType:e},{[d.xq.PostSaveButtonState]:s,[d.xq.BlogName]:n}))}render(){var e=this.props.appContext._t;return(0,_.jsx)(i.Z,{children:(0,_.jsx)("div",{className:r()("wttFd",this.props.className),children:(0,_.jsxs)("ul",{children:[(0,_.jsx)("li",{children:(0,_.jsx)(T,{postType:u.hQ.Text,onClick:this.onPostTypeButtonClick,label:e("Text")})}),(0,_.jsx)("li",{children:(0,_.jsx)(T,{postType:u.hQ.Photo,onClick:this.onPostTypeButtonClick,label:e("Photo")})}),(0,_.jsx)("li",{children:(0,_.jsx)(T,{postType:u.hQ.Quote,onClick:this.onPostTypeButtonClick,label:e("Quote")})}),(0,_.jsx)("li",{children:(0,_.jsx)(T,{postType:u.hQ.Link,onClick:this.onPostTypeButtonClick,label:e("Link")})}),(0,_.jsx)("li",{children:(0,_.jsx)(T,{postType:u.hQ.Chat,onClick:this.onPostTypeButtonClick,label:e("Chat")})}),(0,_.jsx)("li",{children:(0,_.jsx)(T,{postType:u.hQ.Audio,onClick:this.onPostTypeButtonClick,label:e("Audio")})}),(0,_.jsx)("li",{children:(0,_.jsx)(T,{postType:u.hQ.Video,onClick:this.onPostTypeButtonClick,label:e("Video")})})]})})})}}var I=(0,m.X9)(B,{appContext:!0});let L=(0,v.Z)(I)},80341:(e,t,a)=>{a.r(t),a.d(t,{Communities:()=>ey});var s=a(5754),n=a.n(s),l=a(94765),r=a(931),o=a(98724),i=a(48352),c=a(91264),d=a(25190),u=a(93804),m=a(2024),h=a(17276),p=a.n(h),v=a(33590),x=a(45561),b=a(33970),j=a.n(b),g=a(55673),f=a(25731),y=a(94833),C=y.z.union([y.z.literal("explore"),y.z.literal("popular"),y.z.literal("recent"),y.z.literal("polls"),y.z.literal("discover")]),N=()=>{var e=(0,g.lr)(),t=j()(e,1)[0];return(0,f._)(C,t.get("tab")).getWithDefault("recent")},P=a(91253),k=a(61547),w=a(56491),_=a(78667),E=y.z.object({timeline:y.z.object({elements:y.z.array(w.Qw.passthrough()),links:k.L.optional()})}),Q=(0,P.i)(E),T=(e,t)=>x.x.concat(["timeline",{communityName:e,type:t}]),B=(e,t)=>{var a=(0,_.bp)().apiFetchWithSchema;return(0,v.a)({queryKey:T(e,t),queryFn:()=>{var s;return p()().async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,p()().awrap(a(`/v2/communities/${e}/timeline`,Q,{queryParams:{type:t}}));case 2:return s=n.sent.response,n.abrupt("return",s.timeline);case 5:case"end":return n.stop()}},null,null,null,Promise)}})},I=a(65262),L=a(18744),Z=a(95004),S=a(78994),z=a(32468),F=a(43523),O=a(60023),A=a(22424),D=a(6259),M=a(17114),R=a(40563),q=a(55015),J=a(95506),U=a(62054),V="non_monitored_element",$=e=>e.reason==V?U.x4.Ok("It is an element that should not be monitored."):U.x4.Error(e),W=(e,t,a)=>U.x4.Error({reason:e,source:t,details:a}),X=G=H=a(70834),Y=K=(e,t)=>Object.keys(t).reduce((a,s)=>{if(!s.startsWith(e))return a;var n=Y(s.replace(e,"")),l=t[s];return a[n]=l,a},{}),ee=y.z.object({context:y.z.literal("communities"),action:y.z.string(),description:y.z.string().optional()}),et=e=>U.Wx.fromNullable(e).flatMap(e=>(0,f.o)(ee,K("wall",e))).toResult(G().value),ea=a(2629),es=e=>{var t=e.children,a=e.context,s=e.modal,n=e.checkEvent,l=(0,Z.useState)(null),r=j()(l,2),o=r[0],i=r[1],c=(0,_.bp)().logEvent,d=(0,Z.useCallback)([]),u=(0,Z.useCallback)([d]),m=(0,Z.useCallback)(e=>{var t,a;c({eventName:"CommunityWallOpen",eventDetails:{action:e.reason,source:null===(t=e.source)||void 0===t?void 0:t.action,message:null===(a=e.details)||void 0===a?void 0:a.message}})},[c]),h=(0,Z.useCallback)(e=>{var t,a=null===(t=e.target)||void 0===t?void 0:t.closest("[data-wall-context]");et(null==a?void 0:a.dataset).flatMap(n).flatMapError($).tapError(.tapError(m)},[n,m,u]);return(0,Z.useEffect)([h,n]),(0,ea.jsxs)(H.L.Provider,{value:a,children:[o&&(0,ea.jsx)(s,{onClose:error:o}),t]})},en=a(25811),el=a(6233),er=a(72803),eo=a(78317),ei=e=>{var t=e.onClose,a=e.communityId,s=(0,_.bp)()._c,n=(0,S.s0)(),l=return(0,ea.jsx)(el.Z,{showClose:!1,theme:el.L.Rounded,onClose:l,children:(0,ea.jsxs)("div",{className:"umYtk",children:[(0,ea.jsx)("h2",{className:"XABFZ",children:s("Text shown as title for a community's guidelines.","Membership has its privileges.")}),(0,ea.jsx)("p",{className:"yVybm",children:s("It explains what the user needs do to continue the action","Before you can do that, you need to be a member of the community")}),(0,ea.jsxs)("div",{className:"yunAG",children:[(0,ea.jsx)(er.L,{onClick:l,children:s("Button that allows users to decline joining a community after reading its guidelines","Decline")}),(0,ea.jsx)(eo.p,{onClick:()=>{n((0,u.O5)({communityId:a})),l()},children:s("Button that allows users to join a community after reading its guidelines","Agree and join")})]})]})})},ec=e=>{var t=e.onClose,a=e.error,s=(0,S.UO)().communityId;return s&&"membership_is_required"===a.reason?(0,ea.jsx)(ei,{onClose:t,communityId:s}):null},ed=e=>{var t=e.children,a=(0,en.U)().data;return(0,ea.jsx)(es,{checkEvent:e=>null!=a&&a.isMember?X(e):W("membership_is_required",e),modal:ec,context:"communities",children:t})};let eu={community:"uMmnd",postBar:"ijQ66",timeline:"pvWan",tabs:"SnsaE",explore:"hEJyw"};var em=a(76276),eh=e=>{var t=e.children;return(0,ea.jsx)("div",{className:"G9_pV",children:t})},ep=a(3597),ev=a(91488),ex=a(82158),eb=a(37448),ej=a(56004),eg=()=>{var e=(0,_.bp)()._c;return(0,ea.jsx)(eh,{children:(0,ea.jsx)("p",{children:e("A message on the commmunity page explain the popular tab is still not available","A feed of this community’s popular posts will be here… someday.")})})},ef=()=>(0,ea.jsxs)("div",{className:eu.explore,children:[(0,ea.jsx)(ep.r,{}),(0,ea.jsx)(ej.h,{}),(0,ea.jsx)(eb.N,{})]}),ey=()=>{var e,t=N(),a=(0,_.bp)(),s=a._c,h=a._t,p=a.apiFetch,v=(0,d.v$)().isMobile,x=(0,S.s0)(),b=(0,S.UO)().communityId,j=B(b,t),g=j.data,f=j.isPending,y=(0,m.Z)(b).refetch,C=(0,A.wL)().logEvent,P=(0,R.J)("communities"),k=(0,D._)().addOnCloseModalRouteHandler,w=(0,Z.useRef)(),E=(0,Z.useRef)(),Q=(0,Z.useMemo)(()=>[{id:"explore",label:h("Explore"),availableOnlyOnMobile:!0,component:(0,ea.jsx)(ef,{})},{id:"recent",label:h("Latest")},{id:"popular",label:s("Name of the tab on a community page that will show the most popular posts","Popular"),component:(0,ea.jsx)(eg,{})},{id:"polls",label:s("Name of the tab on a community page that will show posts containing polls","Polls")},{id:"discover",label:s("Name of the tab on a community page that will show related posts from global tumblr","Discover")}].filteile),[s,h,v]),T=null!==(e=Q.f==t))&&void 0!==e?e:Q[0];(0,Z.useEffect)(()=>{v||"explore"!==t||x("?tab=recent")},[t,v,x]),(0,Z.useEffect)(()=>(w.current=k(e=>{var t,a=e.isModalSuccess,s=e.isNewPost;a&&s&&(null===(t=E.current)||void 0===t||t.call(E),y()w)}),[k,y]);var U=(0,Z.useMemo)(()=>({renderCustomFooter:"discover"!==t?em.n:void 0}),[t]);return P?(0,ea.jsxs)(A.nO,{eventDetails:{communityId:b},children:[(0,ea.jsx)(i.Z,{page:J.H.analyticsPageName,eventDetails:{tab:t}}),(0,ea.jsxs)(ed,{children:[(0,ea.jsx)(S.j3,{}),(0,ea.jsx)(I.A,{activePage:z.vS.community(b),children:(0,ea.jsxs)(ev.Me,{className:eu.community,children:[(0,ea.jsx)(ev.NC,{children:(0,ea.jsx)(ex.cI,{})}),(0,ea.jsxs)(ev.eX,{className:eu.communityBody,children:[!v&&(0,ea.jsx)(r.Z,{className:n()(eu.postBar,eu.noMargin),"data-member-only":"member",onPostCreat))}}),(0,ea.jsx)(L.y,{tabs:Q,className:eu.tabs,activeTabId:null==T?void 0:T.id,onClick:e=>C({eventName:F.J.CommunitiesTabView,eventDetails:{tab:e}})}),null!=T&&T.component?T.component:(0,ea.jsx)("div",{className:eu.timeline,children:f?(0,ea.jsx)(o.w,{condensed:!0}):(0,ea.jsx)(M.$.Provider,{value:U,children:(0,ea.jsx)(l.Z,{timelineName:`communities-${b}`,getEndpointApiRequestFromQueryParams:()=>new O.x(p,`/v2/communities/${b}/timeline`,{method:"GET",queryParams:{type:null==T?void 0:T.id}}),children:(0,ea.jsx)(c.ZP,{id:`communities-${b}`,getInitialPage:()=>{var e,t;return{objects:null!==(e=null==g?void 0:g.elements)&&void 0!==e?e:[],nextLink:null==g||null===(t=g.links)||void 0===t?void 0:t.next}},getObjectsFromResponse:e=>{var t,a;return null!==(t=null===(a=e.response.timeline)||void 0===a?void 0:a.elements)&&void 0!==t?t:[]},overridePresentationStyle:q.Z.community,setRefreshCallb=e}},null==T?void 0:T.id)})})})]}),(0,ea.jsx)(ev.N_,{children:!v&&(0,ea.jsxs)(ea.Fragment,{children:[(0,ea.jsx)(ep.r,{}),(0,ea.jsx)(ej.h,{}),(0,ea.jsx)(eb.N,{})]})})]})})]})]}):null}},3597:(e,t,a)=>{a.d(t,{r:()=>i});var s=a(90235),n=a(68346),l=a(25811),r=a(4862),o=a(2629),i=e=>{var t=e.className,a=(0,l.U)().data;if(!a)return null;var i=a.avatarImage,c=a.title,d=a.name,u=new n.Z(i).getLargestImage().url;return(0,o.jsxs)(s.Z,{className:t,children:[(0,o.jsxs)("div",{className:"RH2rH",children:[(0,o.jsx)("div",{children:(0,o.jsx)("img",{src:u,className:"RL0HO",alt:""})}),(0,o.jsxs)("div",{className:"EvO8u",children:[(0,o.jsx)("span",{className:"zU4kw",children:c}),(0,o.jsxs)("span",{className:"eG2sU",children:["@@",d]})]})]}),(0,o.jsx)("hr",{className:"dBrOk"}),(0,o.jsx)(r.W,{community:a})]})}},37448:(e,t,a)=>{a.d(t,{N:()=>m});var s=a(90235),n=a(25811),l=a(18488),r=a(90127),o=a(78994),i=a(43523),c=a(22424),d=a(2629),u=e=>{var t=e.tags,a=(0,c.wL)().logEvent,s=(0,o.s0)();return(0,d.jsx)("div",{className:"vehmL",children:t.map(e=>(0,d.jsxs)(l.Z,{className:"yej87",label:e,isRounded:!0,onClick:()=>{a({eventName:i.J.CommunitiesRelatedTagsClick,eventDetails:{tag:e}}),s((0,r.fO)(e))},href:`/tagged/${e}`,children:["#",e]},e))})},m=()=>{var e=(0,n.U)().data;return null!=e&&e.tags.length?(0,d.jsx)(s.Z,{title:"Related tags",children:(0,d.jsx)(u,{tags:e.tags})}):null}},56004:(e,t,a)=>{a.d(t,{h:()=>x});var s=a(93804),n=a(90235),l=a(54138),r=a.n(l),o=a(5754),i=a.n(o),c=a(37236);let d={container:"c7xit",avatar:"_8t27",avatarSquare:"VfO3a",avatarCircle:"s6LDn",title:"fGxq9",adminBadge:"wWLkf",subtitle:"JENfJ"};var u=a(2629),m=e=>{var t=e.avatar,a=e.avatarShape,s=e.title,n=e.subtitle,l=e.url,r=e.isAdmin;return(0,u.jsxs)("a",{href:l,className:d.container,children:[(0,u.jsx)("img",{src:t,alt:s,className:i()(d.avatar,a===c.o.Square?d.avatarSquare:d.avatarCircle)}),(0,u.jsxs)("div",{children:[(0,u.jsxs)("div",{className:d.title,children:[s,r&&(0,u.jsx)("div",{className:d.adminBadge,children:"Admin"})]}),(0,u.jsx)("div",{className:d.subtitle,children:n})]})]})},h=e=>{var t=e.objects;return(0,u.jsx)("ul",{className:"vXnmx",children:t.map((e,t)=>(0,u.jsx)("li",{className:"a5occ",children:(0,u.jsx)(m,r()({},e))},`${e.url}-${t}`))})},p=a(78667),v=a(25811),x=()=>{var e,t=(0,p.bp)(),a=t._getLocaleNumberString,l=t._t,r=(0,v.U)().data,o=null==r||null===(e=r.relatedCommunities)||void 0===e?void 0:e.map(e=>({avatar:e.avatarImage[0].url,avatarShape:c.o.Square,title:e.title,subtitle:`${a(e.memberCount,"short")} members`,url:(0,s.j0)({communityId:e.name})}));return null!=o&&o.length?(0,u.jsx)(n.Z,{title:l("Related communities"),children:(0,u.jsx)(h,{objects:o})}):null}},18744:(e,t,a)=>{a.d(t,{y:()=>g});var s=a(33970),n=a.n(s),l=a(5754),r=a.n(l),o=a(19486),i=a(25190),c=a(95004),d=a(55673),u=a(43523),m=a(78667),h=a(22424),p=a(42914),v=a(93575),x=a(2629),b=e=>{var t=e.active,a=e.className,s=e.label,n=e.onClick;return(0,x.jsx)("button",{className:r()("wRXfV",a,{uXt5V:t}),onClick:n,type:"button","aria-label":s,children:s})};let j={tabs:"Av6XX",tab:"pasN9",searchIcon:"dCbQ4",search:"qBtG9",memberSearch:"ktCEK"};var g=e=>{var t=e.tabs,a=e.activeTabId,s=e.withSearch,l=e.className,g=e.onClick,f=(0,m.bp)()._c,y=(0,i.v$)().isMobile,C=(0,h.wL)().logEvent,N=(0,c.useState)(),P=n()(N,2),k=P[0],w=P[1],_=(0,c.useState)(y),E=n()(_,2),Q=E[0],T=E[1],B=(0,d.lr)(),I=n()(B,2),L=I[0],Z=I[1e)};(0,c.useEffect)(()=>{var e=L.get("searchTab");e?(w(e),T(!0)):y&&T(!0)},[y]);var z=(0,c.useMemo)(()=>(0,p.Z)(e=>{e?L.set("searchTab",e):L.delete("searchTab"),Z(L)},250),[L,Z]),F=(0,x.jsxs)(x.Fragment,{children:[s&&!Q&&(0,x.jsx)(o.Z,{className:j.searchIcon,onCl!0)}),s&&Q&&(0,x.jsx)(v.o,{value:k,className:r()(j.search,j.memberSearch),placeholder:f("Members page search bar placeholder on desktop","Search members…"),onCz(e)},onBlur:e=>!e&&S(!1),onTap}),autoFocus:!0,iconLeft:y})]});return(0,x.jsxs)("div",{className:r()(j.wrapper,l),children:[(0,x.jsxs)("div",{className:j.tabs,children:[t.map(e=>{var t=e.id,s=e.label;return(0,x.jsx)(b,{active:a===t,className:j.tab,label:s,onClick:()=>{L.set("tab",t),Z(L),null==g||g(t)}},t)}),!y&&F]}),y&&F]})}},83875:(e,t,a)=>{a.d()=>l});var s=a(43523),n=a(5700),l=e=>{switch(e){case n.hQ.Text:return s.J.PFComposePostText;case n.hQ.Audio:return s.J.PFComposePostAudio;case n.hQ.Photo:return s.J.PFComposePostPhoto;case n.hQ.Quote:return s.J.PFComposePostQuote;case n.hQ.Link:return s.J.PFComposePostLink;case n.hQ.Chat:return s.J.PFComposePostChat;case n.hQ.Video:return s.J.PFComposePostVideo}}}}]);