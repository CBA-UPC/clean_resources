"use strict";(self.webpackChunkjtnews=self.webpackChunkjtnews||[]).push([[36191],{"4wB92QX9":(e,t,i)=>{i.d(t,{Z:);var s=i("mrSGxOB2"),o=i("x3nPnaOK"),r=i("Em3K7/vc"),n=i("P4szYjiP");class a extends n.g{constructor(e,t){super(e,t),this.name="OpinionsBlockUseCaseError"}static of(e,t){return new a(e,t)}}class l extends r.k{constructor(e){super(e),this._maxTryGetBlock=3;const{regionId:t,isMobile:i,deps:{analyticsService:s,getBlock:o,presenter:r,store:n,blockSliderRepository:a}}=e;this._analyticsService=s,this._regionId=t,this._isMobile=i,this._getBlock=o,this._presenter=r,this._blockSliderRepository=a,this._store=n}async getBlock(){try{const{data:e}=await this._getBlock.get({regionId:this._regionId,retry:{maxTry:this._maxTryGetBlock}}),t=this._presenter.present({data:e,params:{isMobile:this._isMobile}});this._store.updateOpinionsBlock(t)}catch(e){this.logger.capture({error:a.of("Не удалось получить блerRepository.get(e)}setBlockPlace(e){this._analyticsServntArticleClick(e,t)}processAuthorClick(e){this._analyticsService.sendEventBlockShown(e)}}var c,d,p=i("FhW7IjWR"),h=i("cHfy7l2+"),u=i("afO6HulC");!function(e){e.View="Просмотрon",e.Click="clickBlockOpinion"),this._blockName="Блок мнений"}sendEventArticleClick(e,t){const i={[c.Click]:{[`Place${t+1}`]:e.toString()}};this.analytics.send({event:{pageName:this.pageName,blockType:this.blockPlace,fieldType:this._blockName,goalName:d.Click,valueName:i}})}sendEventAuthorClick(e){const t={[c.Click]:{"Переход на автора":e.toString()}};this.analytics.send({event:{pageName:this.pageName,blockType:this.blockPlace,fieldType:this._blockName,goalName:d.Click,valueName:t}}entBlockShown(e){var t,i;const s=null!==(t=e.map((&&void 0!==t?t:"",o=null!==(i=e.map(((e,t)=>`Place${t+1}`)).join(", "))&&void 0!==i?i:"",r={[c.View]:{[o]:s}};this.analytics.send({event:{pageName:this.pageName,blockType:this.blockPlace,fieldType:this._blockName,goalName:d.View,valueName:r}})}}var g=i("VUUbCwGh"),m=i("1xnQlAlL"),k=i("wcuQJwbD");class b{get(e){return window.innerWidth>k.Z.Desktop&&e===m.K.Right||window.innerWidth<=k.Z.Tablet}}var v=i("CvernJVt");class w extends v.C{constructor(e){super(e)}async get(e){const{regionId:t,retry:i}=e,{data:s,responseTime:o}=await this.client.get(t,w.OPINIONS_BLOCK_URL,{retry:i});return{data:s,duration:o}}}w.OPINIONS_BLOCK_URL="/pubnsBlockPresenterError"}static of(e,t){return new C(e,t)}}var _=i("tfi2qRj4"),f=i("E/68V7Uw"),O=i("wiMJEks1"),S=i("wQefqERb");class I extends S.j{constructor(e){super(e),this._imageWidth=48,this._imageValues=[{breakpoint:0,width:48,noMedia:!0}],this._opinionsCountInMobile=5,this._opinionsCountInDesktop=3,this._presentOpinionImage=e=>{const t=(0,O.or)({url:e,width:this._imageWidth,values:this._imageValues,aspectRatio:f.Ot.Square,isPreloadImage:!1,isLazy:!0});return{src:t.data.src,sources:t.data.sources,decoding:t.data.decoding,loading:t.data.loading}}}presentOpinions(e,t){try{return(t?null==e?void 0:e.slice(0,this._opinionsCountInMobile):nulountInDesktop)).map(((e,t)=>this._presentOpinionItem(e,t)))}catch(e){throw C.of("Не удалось выполнить presentOpinions",e)}}_presentOpinionItem(e,t){var i,s;const o=!(0,_.ZO)(t);let r={id:0,name:"Анонимное мнение",jobPosition:"",url:"",image:null};if((0,_.eL)(e.authors)&&(0,_.i1)(e.authors)){const[t]=e.authors;r={id:t.id,image:(0,_.eL)(t.image)?this._presentOpinionImage(t.image.fileName):null,jobPosition:t.jobPosition,name:t.name,url:t.url}}return{id:e.id,header:{link:null!==(i=null===(s=e.urls)||void 0=!==i?i:"",text:e.header},author:r,isPrimary:o}}}class B extends I{constructor(e){super(e)}present(e){try{const{data:{data:t,params:i,reach_goal:s},params:{isMobile:o}}=e;return{type:"recent_opinions",isLazy:!1,params:i,reachGoal:this.presentReachGoals(s),data:this.presentOpinions(t,o)}}catch(e){throw C.of("Не удалось выполнить present",e)}}}var A=i("xWl6hVeO"),P=i("pHogJ2Seturn{articleId:this.item.id,index:this.index}}emitClickToAuthor(){return{authorId:this.item.author.id}}};(0,s.gn)([(0,o.fI)({required:!0,type:Object}),(0,s.w6)("design:type",Object)],L.prototype,"item",void 0),(0,s.gn)([(0,o.fI)({required:!0,type:String}),(0,s.w6)("design:type",String)],L.prototype,"title",void 0),(0,s.gn)([(0,o.fI)({required:!0,type:Number}),(0,s.w6)("design:type",Number)],L.prototype,"index",void 0),(0,s.gn)([(0,o.y1)("articleClicked"),(0,s.w6)("design:type",Function),(0,s.w6)("design:paramtypes",[]),(0,s.w6)("design:returntype",Object)],L.prototype,"emitClickToArticle",null),(0,s.gn)([(0,o.y1)("authorClicked"),(0,s.w6)("design:type",Function),(0,s.w6)("design:paramtypes",[]),(0,s.w6)("design:returntype",Object)],L.prototype,"emitClickToAuthor",null),L=(0,s.gn)([(0,o.wA)({components:{UiAvatar:E.Z,UiLabel:$.Z}})],L);const T=L,R={wrapper:"Eu+IA",content:"ivi0Z",label:"jQMrS",headerWrap:"jtxqY",fadeEffect:"dNku7",header:"KhZHz",author:"Sl96J",name:"ebwFD",anonymous:"beacR",jobPosition:"aZxGg",primary:"TQg-4",secondary:"TSs1o"};var U=i("KHd+Ze9M");const Z=(0,U.Z)(T,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:[e.$style.wrapper,e.$style[e.linkClass]]},[i("div",{class:e.$style.content},[i("UiLabel",{class:e.$style.label,attrs:{"color-scheme":"color",color:"primary"}},[e._v(" "+e._s(e.title)+" ")]),i("div",{class:[e.$style.headerWrap,e.isShowFadeEffect&&e.$style.fadeEffect]},[i("a",{class:e.$style.header,attrs:{href:e.item.header.link},domProps:{innerHTML:e._s(e.item.header.text)},on:{click:e.emitClickToArticle}})]),e.hasAuthorLink?i("a",{class:e.$style.author,attrs:{href:e.item.author.url},on:{click:e.emitClickToAuthor}},[i("UiAvatar",{attrs:{"avatar-size":48,image:e.item.author.image}}),i("div",{class:e.$style.name},[e._v(" "+e._s(e.item.author.name)+" "),i("div",{class:e.$style.jobPosition},[e._v(" "+e._s(e.item.author.jobPosition)+" ")])])],1):i("div",{class:[e.$style.author,e.$style.anonymous]},[i("UiAvatar",{attrs:{"avatar-size":48}}),i("div",{class:e.$style.name},[e._v(" "+e._s(e.item.author.name)+" ")])],1)],1)])}),[],!1,(function(e){this.$style=R.locals||R}),null,null).exports;var M;let z=class extends o.w3{constructor(){super(...arguments),this.useCase=new l({regionId:this.pageStoreFacade.regionId,isMobile:this.pageStoreFacade.isMobile,deps:{blockSliderRepository:new b,analyticsService:new y({pageName:this.pageStoreFacade.pageName,deps:{blockPlaceRepository:this.blockPlaceRepository,analytics:this.reachGoalAnalytics}}),getBlock:new w({deps:{client:this.newsClient}}),presenter:new B({deps:{logger:this.logger}}),store:this.paider=!1}get items(){return this.block.isLazy?[]:this.block.useCase.setBlockPlace(this.blockPlaceConfig)}processBlockShown(){this.useCase.processBlockShown(this.items)}procest}){this.useCase.processArticleClick(e,t)}onAuthorClicked({authorId:e}){this.useCase.processAuthorClick(e)}};(0,s.gn)([(0,o.fI)({required:!0,type:Object}),(0,s.w6)("design:type",Object)],z.prototype,"block",void 0),(0,s.gn)([(0,o.fI)({required:!0,type:Object}),(0,s.w6)("design:type",Object)],z.prototype,"blockPlaceConfig",void 0),(0,s.gn)([(0,o.tB)(p.n),(0,s.w6)("design:type",Object)],z.prototype,"logger",void 0),(0,s.gn)([(0,o.tB)(A.lu),(0,s.w6)("design:type",Object)],z.prototype,"newsClient",void 0),(0,s.gn)([(0,o.tB)(g.k),(0,s.w6)("design:type",Object)],z.prototype,"reachGoalAnalytics",void 0),(0,s.gn)([(0,o.tB)(P._),(0,s.w6)("design:type",Object)],z.prototype,"blockPlaceRepository",void 0),(0,s.gn)([(0,o.tB)(h.B),(0,s.w6)("design:type","function"==typeof(M=void 0!==h.y&&h.y)?M:Object)],z.prototype,"pageStoreFacade",void 0),z=(0,s.gn)([(0,o.wA)({name:"OpinionsBlock",components:{OpinionsItem:Z,UiSlider:j.Z,UiObserveVisibility:x.Z,UiScrollable:N.Z}})],z);const F=z,V={wrapper:"YrxJB",slider:"CqqKQ",sliderContainer:"uAa57",sliderItem:"Fp7tz"};const q=(0,U.Z)(F,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("UiObserveVisibility",{attrs:{tag:"section",hook:"lazyLoad"},on:{visible:e.processLazyLoad}},[e.canRender?i("UiObserveVisibility",{class:e.$style.wrapper,attrs:{hook:"half"},on:{visible:e.processBlockShown}},[e.isSlider?i("UiScrollable",{class:e.$style.slider},[i("div",{class:e.$style.sliderContainer},e._l(e.items,(function(t,s){return i("OpinionsItem",{key:t.id+"_"+s,class:e.$style.sliderItem,attrs:{index:s,item:t,title:"Мнение"},on:{articleClicked:e.onArticleClicked,authorClicked:e.onAuthorClicked}})})),1)]):e._l(e.items,(function(t,s){return i("OpinionsItem",{key:t.id+"_"+s,attrs:{index:s,item:t,ted:e.onArticleClicked,authorClicked:e.onAuthorClicked}})}))],2):e._e()],1)}),[],!1,(function(e){this.$style=V.locals||V}),null,null).exports}}]);
//# sourceMappingURL=36191.fda7cc1.js.map