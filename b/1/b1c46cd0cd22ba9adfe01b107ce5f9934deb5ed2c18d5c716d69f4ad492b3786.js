(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[89],{"3Tf6":dxPo:function(e,t,i){"use strict";i.d(t,"a",(function(){return f})),i.d(t,"b",(function(){return S}));var a=i("keVe"),n=i("TOqr"),l=i("pzhl"),r=i("PkQn"),s=i("4/We"),o=i("xSeq"),p=i("k0+M"),c=i("/I02"),u=i("hhzZ"),m=i("PBJH"),h=i("Uqr9"),f=a.Fb({encapsulation:2,styles:[],data:{animation:[{type:7,name:"enterAndLeave",definitions:[{type:1,expr:"void => TemplateSlow",animation:{type:10,animation:{type:8,animation:[{type:6,styles:{opacity:0,transform:"scale(1.15)"},offset:null},{type:3,steps:[{type:4,styles:{type:6,styles:{opacity:1},offset:null},timings:"{{ fadeDuration }} {{ delay }}"},{type:4,styles:{type:6,styles:{transform:"scale(1)"},offset:null},timings:"{{ scaleDuration }} {{ delay }} cubic-bezier(0.1, 0.9, 0.2, 1)"}],options:null}],options:{params:{fadeDuration:"100ms",scaleDuration:"400ms",delay:"50ms"}}},options:{params:{delay:"98ms"}}},options:null},{type:1,expr:"void => TemplateFast",animation:{type:10,animation:{type:8,animation:[{type:6,styles:{opacity:0,transform:"scale(1.15)"},offset:null},{type:3,steps:[{type:4,styles:{type:6,styles:{opacity:1},offset:null},timings:"{{ fadeDuration }} {{ delay }}"},{type:4,styles:{type:6,styles:{transform:"scale(1)"},offset:null},timings:"{{ scaleDuration }} {{ delay }} cubic-bezier(0.1, 0.9, 0.2, 1)"}],options:null}],options:{params:{fadeDuration:"100ms",scaleDuration:"400ms",delay:"50ms"}}},options:{params:{fadeDuration:"50ms",scaleDuration:"300ms",delay:"40ms"}}},options:null},{type:1,expr:"void => FirstTemplateSlow",animation:{type:10,animation:{type:8,animation:[{type:6,styles:{opacity:0,transform:"scale(1.15)"},offset:null},{type:3,steps:[{type:4,styles:{type:6,styles:{opacity:1},offset:null},timings:"{{ fadeDuration }} {{ delay }}"},{type:4,styles:{type:6,styles:{transform:"scale(1)"},offset:null},timings:"{{ scaleDuration }} {{ delay }} cubic-bezier(0.1, 0.9, 0.2, 1)"}],options:null}],options:{params:{fadeDuration:"100ms",scaleDuration:"400ms",delay:"50ms"}}},options:{params:{delay:"103ms"}}},options:null},{type:1,expr:"void => FirstTemplateFast",animation:{type:10,animation:{type:8,animation:[{type:6,styles:{opacity:0,transform:"scale(1.15)"},offset:null},{type:3,steps:[{type:4,styles:{type:6,styles:{opacity:1},offset:null},timings:"{{ fadeDuration }} {{ delay }}"},{type:4,styles:{type:6,styles:{transform:"scale(1)"},offset:null},timings:"{{ scaleDuration }} {{ delay }} cubic-bezier(0.1, 0.9, 0.2, 1)"}],options:null}],options:{params:{fadeDuration:"100ms",scaleDuration:"400ms",delay:"50ms"}}},options:{params:{fadeDuration:"50ms",scaleDuration:"300ms",delay:"50ms"}}},options:null},{type:1,expr:"void => BlankTemplateSlow",animation:{type:10,animation:{type:8,animation:[{type:6,styles:{opacity:0,transform:"scale(1.15)"},offset:null},{type:3,steps:[{type:4,styles:{type:6,styles:{opacity:1},offset:null},timings:"{{ fadeDuration }} {{ delay }}"},{type:4,styles:{type:6,styles:{transform:"scale(1)"},offset:null},timings:"{{ scaleDuration }} {{ delay }} cubic-bezier(0.1, 0.9, 0.2, 1)"}],options:null}],options:{params:{fadeDuration:"100ms",scaleDuration:"400ms",delay:"50ms"}}},options:{params:{delay:"106ms"}}},options:null},{type:1,expr:"void => BlankTemplateFast",animation:{type:10,animation:{type:8,animation:[{type:6,styles:{opacity:0,transform:"scale(1.15)"},offset:null},{type:3,steps:[{type:4,styles:{type:6,styles:{opacity:1},offset:null},timings:"{{ fadeDuration }} {{ delay }}"},{type:4,styles:{type:6,styles:{transform:"scale(1)"},offset:null},timings:"{{ scaleDuration }} {{ delay }} cubic-bezier(0.1, 0.9, 0.2, 1)"}],options:null}],options:{params:{fadeDuration:"100ms",scaleDuration:"400ms",delay:"50ms"}}},options:{params:{fadeDuration:"50ms",scaleDuration:"300ms",delay:"90ms"}}},options:null},{type:1,expr:"* => void",animation:[{type:6,styles:{opacity:1},offset:null},{type:4,styles:{type:6,styles:{opacity:0},offset:null},timings:"50ms"}],options:null}],options:{}}]}});function d(e){return a.jc(0,[(e()(),a.Hb(0,0,null,null,2,"img",[["aria-hidden","true"],["class","premium-overlay"]],[[8,"src",4]],null,null,null,null)),a.Gb(1,278528,null,0,n.i,[a.x,a.y,a.o,a.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),a.Xb(2,1)],(function(e,t){var i=e(t,2,0,t.component.isRtl?"premium-overlay--left":"");e(t,1,0,"premium-overlay",i)}),()}function b(e){return a.jc(0,[(e()(),a.Hb(0,0,null,null,1,"img",[["aria-hidden","true"],["class","generic-tile__thumbnail"],["data-clicklog","custom"]],[[8,"src",4],[8,"alt",0]],null,null,null,null)),a.Gb(1,278528,null,0,n.i,[a.x,a.y,a.o,a.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null)],(,(function(e,t){var i=t.component;e(t,0,0,i.tileConfig.thumbnail,a.Ob(1,"",i.tileConfig.title,""))}))}function y(e){return a.jc(0,[(e()(),a.Hb(0,0,null,null,1,"ohp-icon-font",[["cssClass","new-template-icon"],["size","32"]],null,null,null,l.b,l.a)),a.Gb(1,638976,null,0,r.a,[s.a],{cssClass:[0,"cssClass"],iconFontType:[1,"iconFontType"],size:[2,"size"]},null)],(function(e,t){e(t,1,0,"new-template-icon",t.component.tileConfig.icon,"32")}),null)}function v(e){return a.jc(0,[(e()(),a.Hb(0,0,null,null,3,"div",[["class","generic-tile__fallback-image-container ms-fcl-tp icon-template-tile__thumbnail"]],null,null,null,null,null)),a.Gb(1,278528,null,0,n.i,[a.x,a.y,a.o,a.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),(e()(),a.qb(16777216,null,null,1,null,y)),a.Gb(3,16384,null,0,n.k,[a.W,a.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,1,0,"generic-tile__fallback-image-container ms-fcl-tp icon-template-tile__thumbnail",(i.small?"icon-template-tile__thumbnail--small--":"icon-template-tile__thumbnail--large--")+i.tileConfig.appName),e(t,3,0,i.tileConfig.icon)}),null)}function g(e){return a.jc(0,[(e()(),a.Hb(0,0,null,null,4,"div",[["class","generic-tile__images"]],null,null,null,null,null)),(e()(),a.qb(16777216,null,null,1,null,b)),a.Gb(2,16384,null,0,n.k,[a.W,a.S],{ngIf:[0,"ngIf"]},null),(e()(),a.qb(16777216,null,null,1,null,v)),a.Gb(4,16384,null,0,n.k,[a.W,a.S],{ngIf:[0,"ngIf"]},null)],(,null)}function T(e){return a.jc(0,[(e()(),a.Hb(0,0,null,null,1,"div",[["class","icon-template-tile__thumbnail template-folder-icon document-icon--folder"]],null,null,null,null,null)),a.Gb(1,278528,null,0,n.i,[a.x,a.y,a.o,a.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null)],(function(e,t){var i=t.component;e(t,1,0,"icon-template-tile__thumbnail template-folder-icon document-icon--folder",(i.small?"icon-template-tile__thumbnail--small--":"icon-template-tile__thumbnail--large--")+i.tileConfig.appName+" "+i.folderIcon)}),null)}function S(e){return a.jc(0,[(e()(),a.Hb(0,0,null,null,12,"a",[["class","generic-tile template-tile"],["data-clicklog","custom"],["href","#"]],[[8,"title",0],[1,"aria-label",0],[24,"@enterAndLeave",0]],[[null,"click"]],(,null,null)),a.Gb(1,278528,null,0,n.i,[a.x,a.y,a.o,a.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),a.Gb(2,4210688,null,0,o.a,[a.o,a.h],{focusOnLoad:[0,"focusOnLoad"],detectChanges:[1,"detectChanges"]},null),(e()(),a.qb(16777216,null,null,1,null,d)),a.Gb(4,16384,null,0,n.k,[a.W,a.S],{ngIf:[0,"ngIf"]},null),(e()(),a.Hb(5,0,null,null,4,"div",[["class","generic-tile__images_container"]],null,null,null,null,null)),(e()(),a.qb(16777216,null,null,1,null,g)),a.Gb(7,16384,null,0,n.k,[a.W,a.S],{ngIf:[0,"ngIf"]},null),(e()(),a.qb(16777216,null,null,1,null,T)),a.Gb(9,16384,null,0,n.k,[a.W,a.S],{ngIf:[0,"ngIf"]},null),(e()(),a.Hb(10,0,null,null,2,"div",[["class","template__title"]],null,null,null,null,null)),a.Gb(11,278528,null,0,n.i,[a.x,a.y,a.o,a.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),(e()(),a.gc(12,null,["",""]))],(function(e,t){var i=t.component;e(t,1,0,"generic-tile template-tile",i.getTemplateTileClassString()),e(t,2,0,i.focusOnLoad,!0),e(t,4,0,i.tileConfig.premiumDiamond),e(t,7,0,!i.folder&&!i.visioLibraryTile),e(t,9,0,i.folder||i.visioLibraryTile),e(t,11,0,"template__title",i.small?"template__title--small":"")}),(function(e,t){var i=t.component;e(t,0,0,i.tileConfig.title,i.tileConfig.ariaLabel,i.animationState),e(t,12,0,i.tileConfig.title)}))}a.Db("ohp-template-item",p.b,(function(e){return a.jc(0,[(e()(),a.Hb(0,0,null,null,1,"ohp-template-item",[],null,null,null,S,f)),a.Gb(1,114688,null,0,p.b,[s.a,c.a,u.a,m.a,h.b],null,null)],(,null)}),{app:"app",handler:"handler",index:"index",visioLibraryTile:"visioLibraryTile",small:"small",animationType:"animationType",focusOnLoad:"focusOnLoad",folder:"folder",enableBrandHoverColors:"enableBrandHoverColors"},{folderNavigation:"folderNavigation"},[])},"k0+M":function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return c}));var a,n=i("keVe"),l=i("lUkk"),r=i("Dn7E"),s=i("rTyw"),o=i("hhzZ"),p=i("BaAg");i("Uqr9"),i("4/We"),i("/I02"),i("PBJH"),a||(a={}));var c=function(){eturn e.prototype.ngOnInit=function(){this.visioLibraryTile?(this.folderIcon=this.getVisioLibraryTileIcon(),this.tileConfig={appName:p.b[this.app].toLowerCase(),ariaLabel:this.locService.format(this.locService.DocumentDescriptiveAriaLabelTitle,this.locService.VisioLibraryTileTitle),title:this.locService.VisioLibraryTileTitle}):this.folder?(this.folderIcon=this.getFolderIcon(),this.tileConfig={appName:p.b[this.app].toLowerCase(),ariaLabel:this.locService.format(this.locService.DocumentDescriptiveAriaLabelTitle,this.folder.Title),title:this.folder.Title}):this.handler&&(this.tileConfig=this.handler.tileConfig),this.fluentRefresh=this.capabilitiesService.capabilities.fluentRefresh,this.isRtl=this.contextService.isRtl,this.setAnimationState(),this.templateImgStyle=(this.small?"generic-tile__thumbnail--"+this.tileConfig.appName:"template-tile__thumbnail--large")+" template-tile__thumbnail--"+this.tileConfig.appName},e.prototype.onTemplateClick=function(t){var i=this;null==t||t.preventDefault(),this.folder?this.folderNavigation.emit(this.folder):this.visioLibraryTile?this.folderNavigation.emit(null):this.handler.handleClick((function(t){var a,n,c,u,m,h;!function(t,a){var n={};n.Index=i.index.toString(),n.DocumentType=i.handler.tileConfig.appName,n.TemplateType=i.handler.templateType;var r=t?p.a.referralFromFileType(i.app):"";if(i.instrumentationService.logClickEvent("Template_Click",i.handler.assetId,o.b.Templates,r,a,n),Object(l.a)({eventName:"Template_Click",id:i.handler.assetId,area:"StartPage",subArea:"Templates",result:r?"Refer":"Navigate",target:r?Object(s.a)(r):"Other"}),i.app===p.b.Visio&&e.isFirstClick){var c=i.performanceService.getRecordedMarkerNameBySubstring("Paint_Templates");c&&i.performanceService.mark("Template_First_ItemClick",c),e.isFirstClick=!1}}("Error"!==t.type&&"CreatePending"!==t.type,t.platform);var f={};f.Action=t.type,f.Latency=t.latency.toString(),f.Index=i.index.toString(),f.DocumentType=i.handler.tileConfig.appName,f.ElementId=i.handler.assetId,f.TemplateType=i.handler.templateType,f.Area=o.b.Templates,f.DebugInfo=null!==(a=t.debugInfo)&&void 0!==a?a:"",f.Error=null!==(n=t.errorMsg)&&void 0!==n?n:"",f.HttpCode=null!==(c=t.httpCode)&&void 0!==c?c:"",i.instrumentationService.logGenericEvent("Template_Click_Result",f),Object(r.a)({featureName:"Create",eventName:"TemplateClickResult",area:"Templates",params:{ElementId:i.handler.assetId,Action:t.type,Latency:t.latency.toString(),DocumentType:i.handler.tileConfig.appName,Index:i.index.toString(),TemplateType:i.handler.templateType,DebugInfo:null!==(u=t.debugInfo)&&void 0!==u?u:"",Error:null!==(m=t.errorMsg)&&void 0!==m?m:"",HttpCode:null!==(h=t.httpCode)&&void 0!==h?h:""}})}))},e.prototype.getTemplateTileClassString=function(){return(this.fluentRefresh?"template-tile--fluent ms-fcl-nd "+(this.enableBrandHoverColors?"ms-bgc-tlr-h ms-bgc-tt-a":"ms-bgc-nlh-h ms-bgc-nlp-a")+" ":"generic-tile--shadowed template-tile--legacy ms-fcl-np ms-fcl-tda-h ms-fcl-tda-f "+(this.enableBrandHoverColors?"ms-bgc-tlr-h":"ms-bgc-nl-h")+" ms-bgc-g40-f ms-bgc-g40-a ")+(this.small?"template-tile--small template-tile--small--"+this.tileConfig.appName:"template-tile--large")+" template-tile--"+this.index},e.prototype.getFolderIcon=function(){if(this.app===p.b.Visio){var e=this.small?"icon-template-tile-collection-folder__thumbnail--small--visio":"icon-template-tile-collection-folder__thumbnail--large--visio";switch(this.folder.CollectionId){case p.b[p.b.VisioBusinessWac]:return"document-icon--visioBussinessTemplate "+e;case p.b[p.b.VisioFlowChartWac]:return"document-icon--visioFlowChartTemplate "+e;case p.b[p.b.VisioGeneralWac]:return"document-icon--visioGeneralTemplate "+e;case p.b[p.b.VisioNetworkWac]:return"document-icon--visioNetworkTemplate "+e;case p.b[p.b.VisioSoftwareWac]:return"document-icon--visioSoftwareTemplate "+e}}return"document-icon--folder"},e.prototype.getVisioLibraryTileIcon=e.prototype.setAnimationState=function(){this.animationState=(0===this.index?"Blank":1===this.index?"First":"")+"Template"+a[this.animationType]},e}()},vSbP:function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"a",(function(){return L}));var a,n=i("QjXU"),l=i("y3b+"),r=i("k+kJ"),s=i("JScD"),o=i("uG5N"),p=i("vSs+"),c=i("A/um"),u=i("BaAg"),m=i("OWzB"),h=i("hZW2"),f=i("m+UP"),d=i("BJbw"),b=i("TIi1"),y=i("4/We"),v=i("PBJH"),g=i("uUrA"),T=i("idgT"),S=i("keVe");!a||(a={}));var C=function(){function e(e,t,i,a){this.tileConfig=e,this.template=t,this.app=i,this.createDocumentService=a,this.categories=t?t.Categories:void 0}return e.prototype.handleClick=function(e){return this.createDocumentService.createItem(this.app,null,this.template,e,this.driveId)},e}(),w=function(e){function t(t,i,n,l){var r=this,s=i.resources(t);return(r=e.call(this,{title:s.CreateNewBlankText||s[""+a.CreateNewBlankText+u.b[t]],ariaLabel:s.CreateNewBlankAriaLabel||s[""+a.CreateNewBlankAriaLabel+u.b[t]],icon:l?null:c.a.Add,appName:x.getAppName(t)},void 0,t,n)||this).templateType="Blank",r}return Object(n.__extends)(t,e),t}(C),I=function(e){function t(t,i,a,n,l){var r,s=this,o=l.resources(t);return i&&!i.TemplateBinaryUrl&&i.Binaries&&i.Binaries.length>0&&(i.TemplateBinaryUrl=null===(r=i.Binaries.find((function(e){var t,i;return"wac"===(null===(t=e.Platform)||void 0===t?void 0:t.toLowerCase())||"online"===(null===(i=e.Platform)||void 0===i?void 0:i.toLowerCase())})))||void 0===r?void 0:r.Url),(s=e.call(this,{title:i.Title,ariaLabel:n.format(o.CreateFromTemplateAriaLabel,i.Title),thumbnail:x.getThumbnail(i.Thumbnails,i.Images),appName:x.getAppName(t),extension:u.a.getFileExtension(i.TemplateBinaryUrl),galleryThumbnail:x.getGalleryThumbnail(i.Thumbnails)},i,t,a)||this).assetId=i.AssetId,s.templateType=i.IsPremium?"Premium":"Standard",s}return Object(n.__extends)(t,e),t}(C),k=function(e){function t(t,i,a,n,l,r){var s,o=this,p=l.resources(t);return i&&!i.TemplateBinaryUrl&&i.Binaries&&i.Binaries.length>0&&(i.TemplateBinaryUrl=null===(s=i.Binaries.find((function(e){var t,i;return"wac"===(null===(t=e.Platform)||void 0===t?void 0:t.toLowerCase())||"online"===(null===(i=e.Platform)||void 0===i?void 0:i.toLowerCase())})))||void 0===s?void 0:s.Url),(o=e.call(this,{title:i.Title,ariaLabel:n.format(p.CreateFromTemplateAriaLabel,i.Title),thumbnail:x.getThumbnail(i.Thumbnails),appName:x.getAppName(t),extension:u.a.getFileExtension(i.TemplateBinaryUrl.slice(0,i.TemplateBinaryUrl.indexOf("&",i.TemplateBinaryUrl.lastIndexOf("."))))},i,t,a)||this).assetId=i.AssetId,o.driveId=r,o.templateType="Enterprise",o}return Object(n.__extends)(t,e),t}(C),D=function(){function e(e,t,i,a,n,l,r){this.capabilitiesService=t,this.urlLauncherService=a;var s=r.resources(e);this.tileConfig={title:i.Title,ariaLabel:l.format(s.CreateFromTemplateAriaLabel,i.Title),thumbnail:x.getThumbnail(i.Thumbnails),appName:x.getAppName(e),extension:u.a.getFileExtension(i.TemplateBinaryUrl)},this.assetId=i.AssetId,this.templateType="Standard",this.app=e,this.templateUrl=e===u.b.Sway?n.appendPvrAndUpnAuthParams(i.TemplateBinaryUrl):i.TemplateBinaryUrl}return e.prototype.handleClick=function(e){var t=this;return this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3),i.e(4),i.e(5)]).then(i.bind(null,"DZQ9")).then((function(i){return i.launchUrl(t.templateUrl,{action:"OpenTemplate"}).then((function(){e({type:"GoToBlankDoc",latency:0,platform:"Web"})}),(function(){e({type:"Error",latency:0})}))})):this.urlLauncherService.openUrl(this.templateUrl,"OpenTemplate").then((,(function(){e({type:"Error",latency:0})}))},e}(),_=function(){function e(e,t,i,a,n,l,r,s){this.capabilitiesService=t,this.documentService=a,this.uploadManagerService=n,this.swayService=l,this.urlLauncherService=r,this.uploadConfigService=s;var o=i.resources(e);this.tileConfig={title:o.CreateFromDocumentText,ariaLabel:o.CreateFromDocumentAriaLabel,icon:c.a.Upload,appName:x.getAppName(u.b.Sway)},this.assetId="_DocumentUpload",this.templateType="Standard",this.app=e}return e.prototype.handleClick=function(e){var t=this;return new Promise((function(a){var n=l=t.swayService.swayConfig.uploadSupportedExtensions.map(();t.documentService.selectFile(l).then((function(l){var s=t.uploadManagerService.upload(l[0],t.swayService,g.a.createGuid(),t.uploadConfigService.config.swayResources,r.d.Button);if(s)var o=s.subscribe((function(l){l.state===r.c.Completed?(e({type:"GoToBlankDoc",latency:0,platform:"Web"}),t.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([i.e(0),i.e(1),i.e(2),i.e(3),i.e(4),i.e(5)]).then(i.bind(null,"DZQ9")).then((function(e){e.launchUrl(l.result.pollingUrl,{action:"CreateFromDocument",linkTarget:"_top"})})):t.urlLauncherService.openUrl(l.result.pollingUrl,"CreateFromDocument","_top"),o.unsubscribe(),a()):l.state!==r.c.Failed&&l.state!==r.c.Cancelled||(o.unsubscribe(),n({type:"Error",latency:0}))}));else n({type:"Error",latency:0})})).catch(()}))},e}(),F=function(){function e(e,t,i,a){this.upsellDataService=i,this.installConfigService=a;var n=t.resources(e),l=[{Size:"medium",Height:55,Width:55,Url:n.PremiumTemplatesUpsellThumbnail,ImageType:"MT"}];this.app=e,this.tileConfig={title:n.PremiumTemplatesHookTitle,ariaLabel:n.PremiumTemplatesHookTitle,thumbnail:x.getThumbnail(l),appName:x.getAppName(e),premiumDiamond:t.config.premiumTemplatesDiamondCorner},this.assetId="_PremiumTemplatesUpsellHook",this.templateType="Upsell",this.installConfigService.config.dimeEnabled&&this.upsellDataService.warmupDime("templates")}return e.prototype.handleClick=function(e){var t=this;return new Promise((function(i){if(t.installConfigService.config.dimeEnabled){var a=t.installConfigService.config.goPremiumUrlPremiumTemplates.replace("{OEM}",t.upsellDataService.getUpsellTrackingParam());t.upsellDataService.launchDime("templates",a)}e({type:"Upsell",latency:0}),i()}))},e}(),L=function(){eturn e.prototype.createCreateNewFromBlankTemplateCreationHandlers=function(e){var t=this;return e.map((function(e){return new w(e,t.templatesConfigService,t.documentCreateService,t.capabilitiesService.capabilities.fluentRefresh)}))},e.prototype.createCreateNewFromTemplateCreationHandler=e.prototype.createOpenTemplateCreationHandler=function(e,t){return new D(e,this.capabilitiesService,t,this.urlLauncherService,this.urlAuthenticatorService,this.locService,this.templatesConfigService)},e.prototype.createFileTemplateCreationHandler=function(e){return new _(e,this.capabilitiesService,this.templatesConfigService,this.documentService,this.uploadManagerService,this.swayService,this.urlLauncherService,this.uploadConfigService)},e.prototype.createPremiumLinkCreationHandler=e.prototype.createCreateNewFromEnterpriseTemplateCreationHandler=function(e,t,i){return new k(e,t,this.documentCreateService,this.locService,this.templatesConfigService,i)},e.ɵprov=S.kc({factory:function(){return new e(S.lc(y.a),S.lc(m.a),S.lc(b.a),S.lc(d.a),S.lc(T.a),S.lc(v.a),S.lc(f.a),S.lc(h.a),S.lc(o.a),S.lc(s.a),S.lc(l.a),S.lc(p.a))},token:e,providedIn:"root"}),e}(),x=function()return e.getAppName,e.getThumbnail=function(e,t){var i,a;if(e){var n=e.find((function(e){return"MT"===e.ImageType}));return n?n.Url:void 0}if(t){var l=null===(i=t.find((function(e){return"large"===e.ImageSize.toLowerCase()})))||void 0===i?void 0:i.Url,r=null===(a=t.find()))||void 0===a?void 0:a.Url;return l||r}},e.getGalleryThumbnail=function(e){if(e){var t=e.find((function(e){return"LT"===e.ImageType})),i=e.find((function(e){return"MT"===e.ImageType}));return t||i}},e}()},zfYE:function(e,t,i){"use strict";i.d(t,"a",));var a=i("laSs"),n=i("AlWG"),l=i("BaAg"),r=i("cgnd"),s=[l.b.VisioBusinessWac,l.b.VisioFlowChartWac,l.b.VisioGeneralWac,l.b.VisioNetworkWac,l.b.VisioSoftwareWac],o=function(){function e(e,t,i,a,l,r,s,o,p,c,u,m,h,f,d,b,y,v,g,T,S,C){this.activatedRoute=e,this.capabilitiesService=t,this.clientStartupConfigService=i,this.contextService=a,this.documentService=l,this.eventService=r,this.errorDialogService=s,this.globalErrorHandler=o,this.instrumentationService=p,this.locService=c,this.officeRouteService=u,this.oneDriveGraphService=m,this.templateCreationHandlerFactory=h,this.templatesConfigService=f,this.templatesService=d,this.workloadsService=b,this.numTemplates=y,this.createFromFileTemplateTileEnabled=v,this.performanceService=g,this.browserPaintMeasurementService=T,this.accessTokenService=S,this.userConsentConfigService=C,this.templates=[],this.enterpriseTemplatesLibraries=[],this.templatesObservableSubject=new n.a(null)}return e.prototype.ngOnInit=function(){var e=this;this.templatesObservable=this.templatesObservableSubject.asObservable(),this.app=l.a.fileTypeNameToFileType(this.activatedRoute.snapshot.params.app),this.appName=l.b[this.app].toLowerCase();var t=this.capabilitiesService.capabilities,i=t.startPageApps;if(this.fluentRefresh=t.fluentRefresh,this.app&&i&&i.has(this.app)){if(this.clientStartupConfigService.config.authType===r.a.OrgId&&this.workloadsService.getWorkloads().then((function(t){var i=t.find());e.app!==l.b.Sway&&e.app!==l.b.Forms&&e.app!==l.b.FormsQuiz&&i&&!e.contextService.sharedContext.oneDriveResourceId&&e.showError("OneDriveProvisioning")})),this.creationEnabled=t.createDocumentSupported||this.app===l.b.Forms,this.templatesResources=this.templatesConfigService.resources(this.app),this.templatesErrorMessage=this.templatesResources.TemplatesErrorMessage,this.showTemplatesAriaLabel=this.templatesResources.StartPageShowTemplatesText,this.showTemplatesText=this.templatesResources.StartPageShowTemplatesText,this.hideTemplatesAriaLabel=this.templatesResources.StartPageHideTemplatesText,this.hideTemplatesText=this.templatesResources.StartPageHideTemplatesText,this.premiumTemplatesText=this.templatesResources.PremiumTemplatesHookTitle,this.standardTemplatesText=this.templatesResources.StandardTemplatesHeaderTitle,this.isCommercial=this.clientStartupConfigService.config.authType===r.a.OrgId,this.premiumTemplates=[],this.enterpriseTemplatesEnabled=this.templatesConfigService.config.enterpriseTemplatesEnabled&&!this.capabilitiesService.capabilities.pwaEnabled&&(this.app===l.b.PowerPoint||this.app===l.b.Word&&this.templatesConfigService.config.wordOrgTemplatesEnabled||this.app===l.b.Excel&&this.templatesConfigService.config.excelOrgTemplatesEnabled),l.b.Forms===this.app&&(this.templatesConfigService.config.templatesFormsEnabled||!this.isCommercial)||this.app!==l.b.OneNote&&this.app!==l.b.Forms&&this.app!==l.b.Stream){this.templatesLoading=!0,this.blankTemplates=this.templateCreationHandlerFactory.createCreateNewFromBlankTemplateCreationHandlers(this.app===l.b.Forms?[l.b.Forms,l.b.FormsQuiz]:[this.app]),this.createFromFileTemplateTileEnabled&&this.app===l.b.Sway&&(this.createFromDocumentTemplate=this.templateCreationHandlerFactory.createFileTemplateCreationHandler(this.app));var a=this.templatesService.getTemplates(this.app===l.b.Visio?l.b.VisioStartWac:this.app);this.templateDataSubscription=a.results.subscribe((function(t){e.app===l.b.Visio&&t.Template.forEach((function(e){e.Title=e.Title.substring(0,e.Title.lastIndexOf("_")>0?e.Title.lastIndexOf("_"):e.Title.length)})),e.isCommercial?e.templates=t.Template.slice(0,e.numTemplates-(e.createFromDocumentTemplate?2:1)).map((function(t){return e.createTemplateHandler(t)})):(e.capabilitiesService.capabilities.userConsentCallEnabled?e.userConsentConfigService.getConfig().then((function(i){0===i.userConsent&&(e.premiumTemplates=t.Template.filter((function(e){return e.IsPremium})).map((function(t){return e.createTemplateHandler(t)})))})):e.premiumTemplates=t.Template.filter((function(e){return e.IsPremium})).map((function(t){return e.createTemplateHandler(t)})),e.templates=t.Template.filter()).slice(0,e.numTemplates-(e.createFromDocumentTemplate?2:1)).map())),e.templatesObservableSubject.next(e.templates),e.templatesLoading=!1,e.performanceService.mark(t.fromCache?"Cached_Templates_Ready":"Templates_Ready")})),a.initialCompletion.then((function(t){t&&(t.cacheError&&t.networkError&&(e.templateError=!0,e.templatesLoading=!1),e.globalErrorHandler.handleCacheObservableError(t,"wCFMp","CUIi8")),e.onTemplatesLoaded()}))}this.app===l.b.Sway&&this.accessTokenService.getAccessToken("Sway"),this.onInit()}else this.officeRouteService.redirectAndRewrite()},e.prototype.ngAfterViewInit=function(){var t=this,i=this.getTitle();if(this.eventService.broadcastEvent({name:"changeTitle",args:[i]}),this.templatesConfigService.prefetchStaticResources(this.app),e.wacApps.has(this.app)){var a=this.templatesConfigService.config.sharePointAuthFrameUrl;this.clientStartupConfigService.config.authType===r.a.OrgId&&this.capabilitiesService.capabilities.oneDriveApisEnabled&&a&&this.oneDriveGraphService.getMyDriveRootUrl().then((function(e){var i=e.userRoot,n=i.lastIndexOf("/",i.length-2);if(!(n<=0)){var l=i.substring(0,n);t.documentService.addIframeToPage(""+l+a)}}))}},e.prototype.ngOnDestroy,e.prototype.trackTemplateByAssetId,e.prototype.createInstrumentTemplatesImpression=function(e,t,i){var n=this;void 0===i&&(i={templatesImpression:"Templates_Impression",templatesErrorImpression:"Templates_Error_Impression",templatesImpressionOtel:"Templates_Impression",templatesErrorImpressionOtel:"Templates_Error_Impression"});var l,r={};if(this.templateError)l=i.templatesErrorImpression,Object(a.a)({eventName:l.toString(),area:"Templates"});else{l=i.templatesImpression,r.TotalSize=((e?e.length:0)+(t?t.length:0)).toString();var s=e?e.map((function(e){return e.ItemId})).join(";"):"",o=t?t.map()).join(";"):"";r.Distribution=s.concat(o);var p=e?e.map()).join(";"):"",c=t?t.map()).join(";"):"";r.TemplateType=p.concat(c);var u=e?e.map((function(e){return i.templatesFolderType||n.getTemplatesFolderType()+"-"+e.ItemId})).join(";"):"",m=t?t.map()).join(";"):"";Object(a.a)({eventName:l.toString(),area:"Templates",distribution:u.concat(m),totalSize:(e?e.length:0)+(t?t.length:0)})}this.instrumentationService.logImpressionEvent(l,r),this.enterpriseTemplatesLoading||this.templatesLoading||this.browserPaintMeasurementService.recordWhenPainted("Templates")},e.prototype.showError=function(e){"None"!==e&&this.errorDialogService.showErrorDialog({category:"StartPage",error:e,fileType:this.app})},e.prototype.createTemplateHandler=function(e,t){return void 0===t&&(t=""),t?this.templateCreationHandlerFactory.createCreateNewFromEnterpriseTemplateCreationHandler(this.app,e,t):this.app===l.b.Sway?this.templateCreationHandlerFactory.createOpenTemplateCreationHandler(this.app,e):this.templateCreationHandlerFactory.createCreateNewFromTemplateCreationHandler(this.app,e)},e.prototype.getTemplatesFolderType=function(){switch(this.app){case l.b.Visio:return"VisioTemplateFolder";default:return"UnknownTemplateFolder"}},e.prototype.getVisioCollections=function(){var e=this;return s.map((function(t){return{ItemId:l.b[t],Title:e.templatesService.getVisioLocalizationLabel(t),CollectionId:l.b[t]}}))},e.wacApps=new Set([l.b.Word,l.b.Excel,l.b.PowerPoint]),e}()}}]);
//# sourceMappingURL=templates~wac-start.ff1151f02a5bd7d80239.chunk.v7.js.map