window.CQ_Analytics||(window.CQ_Analytics={});CQ_Analytics.Operator=);CQ_Analytics.Operator.IS="is";CQ_Analytics.Operator.EQUALS="equals";CQ_Analytics.Operator.NOT_EQUAL="notequal";CQ_Analytics.Operator.GREATER="greater";CQ_Analytics.Operator.GREATER_OR_EQUAL="greaterorequal";CQ_Analytics.Operator.OLDER="older";CQ_Analytics.Operator.OLDER_OR_EQUAL="olderorequal";CQ_Analytics.Operator.LESS="less";CQ_Analytics.Operator.LESS_OR_EQUAL="lessorequal";
CQ_Analytics.Operator.YOUNGER="younger";CQ_Analytics.Operator.YOUNGER_OR_EQUAL="youngerorequal";CQ_Analytics.Operator.CONTAINS="contains";CQ_Analytics.Operator.BEGINS_WITH="beginswith";CQ_Analytics.Operator.EXISTS="exists";CQ_Analytics.Operator.DOES_NOT_EXIST="doesnotexist";CQ_Analytics.Operator.formatIP=function(a){var b=String(a).match(/^([0-9]+)\.([0-9]+)\.([0-9]+)\.([0-9]+)$/);if(b&&5===b.length){b.shift();for(a=[];b.length;)a.push(("00"+b.shift()).slice(-3));a=a.join(".")}return a};
CQ_Analytics.OperatorActions=function(){var a={},b=b(CQ_Analytics.Operator.EQUALS,"equals","\x3d\x3d");b(CQ_Analytics.Operator.IS,"is","\x3d\x3d");b(CQ_Analytics.Operator.NOT_EQUAL,"is not equal to","!\x3d");b(CQ_Analytics.Operator.GREATER,"is greater than","\x3e");b(CQ_Analytics.Operator.GREATER_OR_EQUAL,"is equal to or greater than","\x3e\x3d");b(CQ_Analytics.Operator.OLDER,"is older than","\x3e");b(CQ_Analytics.Operator.OLDER_OR_EQUAL,"is equal to or older than","\x3e\x3d");
b(CQ_Analytics.Operator.LESS,"is less than","\x3c");b(CQ_Analytics.Operator.LESS_OR_EQUAL,"is equal to or less than","\x3c\x3d");b(CQ_Analytics.Operator.YOUNGER,"is younger than","\x3c");b(CQ_Analytics.Operator.YOUNGER_OR_EQUAL,"is equal to or younger than","\x3c\x3d");b(CQ_Analytics.Operator.CONTAINS,"contains",function(a,b){return a?b?(b=""+b,-1!=(""+a).toLowerCase().indexOf(b.toLowerCase())):!0:!1});b(CQ_Analytics.Operator.BEGINS_WITH,"begins with",function(a,b){return a?b?(b=""+b,0==(""+a).toLowerCase().indexOf(b.toLowerCase())):
!0:!1});b(CQ_Analytics.Operator.EXISTS,"exists",;b(CQ_Analytics.Operator.DOES_NOT_EXIST,"does not exist",;var c=function(a){a&&(a=a.replace(/\'/ig,a));return a};return{getText:function(b){return a[b]&&a[b][0]?a[b][0]:""},setText:function(b,c){a[b]&&a[b][0]&&(a[b][0]=c)},getOperation:function(b){return a[b]&&a[b][1]?a[b][1]:""},operate:function(a,b,f,g,h){var d=this.getOperation(f);d=d?d:f;h&&""!==h||!(d in{"\x3c":1,"\x3c\x3d":1,"\x3e":1,"\x3e\x3d":1})||
isNaN(parseFloat(g-0))||(h="parseFloat");try{if(a){f="";var e=CQ.shared.XSS.getXSSTablePropertyValue(a,b);if("function"==typeof d)return d.call(this,e,g,h);if(h)f=h+"('"+e+"') "+d+" "+h+"('"+g+"')";else{var l=c(e),t=c(g);f="'"+l+"' "+d+" '"+t+"'"}return eval(f)}}catch(q){}return!1}}}();
CQ_Analytics.Utils=new function(){return{registerDocumentEventHandler:function(a,b){var c=window.document[a];window.document[a]="function"!=typeof window.document[a]?b:,eventWrapper:function(a){return function(b){if(document.all){var c=window.event.keyCode;b=window.event}else c="undefined"!=typeof b.which?b.which:0;b&&a(b,c)}},loadElement:loadTeaserElement:function(a,b){var c=$CQ("#"+b).css("height"),d=$CQ("#"+b).height();0<d&&$CQ("#"+b).css("height",
d);var e=function(a){if(a&&""!=a){a=$CQ(a).css("display","none");var d=$CQ("#"+b)[0];$CQ("#"+b).empty().append(a);d&&d.parentElement&&$CQ(d.parentElement).trigger("target-dom-loaded");a.fadeIn(function(){c&&"0px"!=c&&$CQ("#"+b).css("height",c)})}else c&&"0px"!=c&&$CQ("#"+b).css("height",c)},f=function(a,b){CQ_Analytics.Utils.teasersCache||(CQ_Analytics.Utils.teasersCache={});CQ_Analytics.Utils.teasersCache[a]=b},g=function(){CQ_Analytics.Utils.teasersCache&&CQ_Analytics.Utils.teasersCache[a]?e(CQ_Analytics.Utils.teasersCache[a]):
(CQ_Analytics.Utils.teasersLoading=CQ_Analytics.Utils.teasersLoading||{},CQ_Analytics.Utils.teasersLoading[a]?window.setTimeout(100):(CQ_Analytics.Utils.teasersLoading[a]=!0,h()))},h=function(){var b=a,c=location.href;"undefined"!=typeof CQ_CONTENT_PATH&&(c=CQ_CONTENT_PATH);(c=CQ.shared.HTTP.getParameter(c,"wcmmode"))&&(b+=(0<b.indexOf("?")?"\x26":"?")+"wcmmode\x3d"+c);CQ.shared.HTTP.get(b,function(b,c,d){if(c){if(b=d.body)b=b.replace(/\n/ig,""),
b=b.replace(/\r/ig,""),f(a,b),delete CQ_Analytics.Utils.teasersLoading[a],g()}else f(a,"")})},k=$CQ("#"+b).children().length;if(0<k){var m=0;$CQ("#"+b).children().fadeOut(function(){var a=$CQ(this);window.setTimeout(function(){a.remove();m++;m>=k&&g()},50)})}else g()},clearElement:function(a){a&&$CQ("#"+a).html("")},indexOf:load:function(a,b,c){return CQ.shared.HTTP.get(a,b,c)},post:getPagePath:function(){return CQ.shared.HTTP.getPath()},getPath:function(a){return CQ.shared.HTTP.getPath(a)},addParameter:removeParameters:function(a){return CQ.shared.HTTP.removeParameters(a)},removeAnchor:function(a){return CQ.shared.HTTP.removeAnchor(a)},getSchemeAndAuthority:function(a){return CQ.shared.HTTP.getSchemeAndAuthority(a)},internalize:externalize:encodePathOfURI:function(a){return CQ.shared.HTTP.encodePathOfURI(a)},encodePath:function(a){return CQ.shared.HTTP.encodePath(a)},getContextPath:function(){return CQ.shared.HTTP.getContextPath()},detectContextPath:function(){return CQ.shared.HTTP.detectContextPath()},urlEncode:function(a){if(!a)return"";if("string"==typeof a)return a;var b=[],c;for(c in a){var d=a[c],e=encodeURIComponent(c),f=typeof d;if("undefined"==f)b.push(e,"\x3d\x26");else if("function"!=f&&"object"!=f)b.push(e,"\x3d",encodeURIComponent(d),
"\x26");else if("array"==typeof d)if(d.length){f=0;for(var g=d.length;f<g;f++)b.push(e,"\x3d",encodeURIComponent(void 0===d[f]?"":d[f]),"\x26")}else b.push(e,"\x3d\x26")}b.pop();return b.join("")},getUID:getTimestamp:insert:function(a,b,c){if(!a||isNaN(b)||!c)return a;for(var d="",e=0,f=b;f<a.length;)d+=a.substring(e,f)+c,e+=b,f+=b;e<a.length&&
(d+=a.substring(e));return d},addListener:function(){return window.addEventListener?function(a,b,c,d){a.addEventListener(b,c,d)}:window.attachEvent?function(){}},removeListener:};
CQ_Analytics.ClickstreamcloudRenderingUtils=new function(){return{createLink:function(a,b,c,d){var e=document.createElement("a");e.href=d;e.onclick=b;e.innerHTML=a;if(c)for(var f in c)c.hasOwnProperty(f)&&(e[f]=c[f]);return e},createStaticLink:createNameValue:createText:function(a,
b,c){var d=document.createElement("span");d.className=b||"ccl-data";a&&a.indexOf&&(-1!=a.indexOf("/home")&&-1!=a.indexOf("/image")||-1!=a.indexOf("/")&&-1!=a.indexOf(".png"))?d.innerHTML='\x3cimg src\x3d"'+a+'.prof.thumbnail.png" border\x3d"0"\x3e':a&&a.indexOf&&-1!=a.indexOf("www.gravatar.com")?d.innerHTML='\x3cimg src\x3d"'+a+'"\x3e':d.innerHTML=a;d.title=c;d.alt=c;return d},createEditablePropertySpan:function(a,b){var c="var editSpan \x3d this.parentNode; var readSpan \x3d this.parentNode.previousSibling;var newValue \x3d this.value;editSpan.style.display \x3d 'none'; readSpan.innerHTML \x3d '"+
a+" \x3d '+value; readSpan.style.display \x3d 'block';",d=document.createElement("span");d.innerHTML="\x3cspan class\x3d\"ccl-data\" onclick\x3d\"var editSpan \x3d this.nextSibling; this.style.display \x3d 'none'; editSpan.style.display \x3d 'block';\"\x3e"+a+" \x3d "+b+"\x3c/span\x3e";d.innerHTML+='\x3cspan class\x3d"ccl-data" style\x3d"display: none;"\x3e'+a+' \x3d \x3cinput class\x3d"ccl-input" type\x3d"text" value\x3d"'+b+'" onblur\x3d"'+c+'"\x3e\x3c/span\x3e';d.className="ccl-data";return d}}};
var generateURLSignature=function(a,b,c){if(a&&a.match(/^https?:\/\/maps\.googleapis\.com\//)){var d=a.replace(/^https?:\/\/[^/]*/,"").replace(/&amp;/g,"\x26");$CQ.ajax({url:CQ.shared.HTTP.externalize("/etc/cloudsettings/default/contexthub/geolocation.signature.json"),method:"get",dataType:"json",cache:!1,data:{url:d}}).done(function(a,d,g){g&&g.responseJSON?(a=this.baseURL.replace(/&amp;/g,"\x26"),a+="\x26client\x3d"+g.responseJSON.client,a+="\x26channel\x3d"+g.responseJSON.channel,a+="\x26signature\x3d"+
g.responseJSON.signature,b(a)):"function"===typeof c&&c()}.bind({baseURL:a})).fail(c)}else b(a)};
CQ_Analytics.ClientContextUtils=new function(){return{renderStoreProperty:function(a,b,c,d,e,f){if(CQ_Analytics&&CQ_Analytics.CCM)CQ_Analytics.CCM.onReady(function(){CQ_Analytics.ClientContextUtils.onStoreRegistered(b,function(){var g=CQ_Analytics.StoreRegistry.getStore(b);if(g){var h=function(){var b=g.getProperty(c)||f,m=$CQ("#"+a);if(!m.attr("contenteditable")||"inherit"==m.attr("contenteditable"))if("string"!=typeof b||(0!=b.indexOf("/")||-1==b.toLowerCase().indexOf(".png")&&-1==b.toLowerCase().indexOf(".jpg")&&
-1==b.toLowerCase().indexOf(".gif"))&&0!=b.toLowerCase().indexOf("http"))b=CQ_Analytics.Variables.replaceVariables(b),b=CQ_Analytics.isUIAvailable?b&&""!=b?b=d+b+e:CQ.I18n.getMessage("No",null,"Ex: No address, No keywords")+" "+c:b&&""!=b?b=d+b+e:"No "+c,m.html()!=b&&!1!==g.fireEvent("beforepropertyrender",g,a)&&(m.html(b),g.fireEvent("propertyrender",g,a));else if(b&&""!=b){var l="";l=0==m.parents(".cq-cc-thumbnail").length||0==b.toLowerCase().indexOf("http")||0==b.indexOf("/libs/wcm/mobile")?b.replace(/&amp;/g,
"\x26"):CQ.shared.HTTP.addParameter("/etc/clientcontext/shared/thumbnail/content.png","path",CQ_Analytics.Variables.replaceVariables(b));l=CQ_Analytics.Variables.replaceVariables(l);-1===(m.find("div").css("background-image")||"").indexOf(l+")")&&!1!==g.fireEvent("beforepropertyrender",g,a)&&generateURLSignature(CQ.shared.HTTP.externalize(l),}else m.children().remove(),CQ_Analytics.isUIAvailable?m.html(CQ.I18n.getMessage("No",null,"Ex: No address, No keywords")+" "+c):m.html("No "+c)};!1!==g.fireEvent("beforeinitialpropertyrender",g,a)&&(h(),g.addListener&&g.addListener("update",function(){h()}),g.fireEvent("initialpropertyrender",g,a))}})})},renderStore:function(a,b){if(CQ_Analytics&&CQ_Analytics.CCM&&a&&b)CQ_Analytics.CCM.onReady(function(){CQ_Analytics.ClientContextUtils.onStoreRegistered(b,function(){var c=CQ_Analytics.StoreRegistry.getStore(b);
if(c){c.divId=a;var d=function(){!1!==c.fireEvent("beforerender",c,c.divId)&&(c.renderer(c,c.divId),c.fireEvent("render",c,c.divId))};!1!==c.fireEvent("beforeinitialrender",c,a)&&(d(),c.addListener&&c.addListener("update",,c.fireEvent("initialrender",c,a))}})})},storesOptionsProvider:function(){var a=[],b=CQ_Analytics.StoreRegistry.getStores(),c;for(c in b)a.push({value:c});return a},storePropertiesOptionsProvider:function(a,b){var c=[];if(a=CQ_Analytics.StoreRegistry.getStore(a))for(var d=
a.getPropertyNames(),e=0;e<d.length;e++){var f=d[e];if(!CQ.shared.XSS.KEY_REGEXP.test(f)){var g={value:f};b&&(g.text=f+" - "+a.getProperty(f));c.push(g)}}return c},onStoreRegistered:function(a,b){if(b){var c=CQ_Analytics.StoreRegistry.getStore(a);c?b.call(c,c):CQ_Analytics.CCM.addListener("storeregister",function(c,e){e.getName()==a&&b.call(e,e)})}},onStoreInitialized:function(a,b,c){!0===c&&(c=CQ_Analytics.ClientContextUtils.DEFAULT_INIT_DELAY);var d=function(){var d=CQ_Analytics.StoreRegistry.getStore(a);
d.DELAYED_INIT_TIMEOUT&&(window.clearTimeout(d.DELAYED_INIT_TIMEOUT),d.DELAYED_INIT_TIMEOUT=null);0<c?d.DELAYED_INIT_TIMEOUT=window.setTimeout(c):b.call(d,"initialize",d)},e=CQ_Analytics.StoreRegistry.getStore(a);e?e.isInitialized()?(d.call(e),e.addListener("initialize",function(a,b){d.call(b)})):e.addListener("initialize",:CQ_Analytics.CCM.addListener("storeregister",function(d,e){if(e.getName()==a)CQ_Analytics.ClientContextUtils.onStoreInitialized(a,
b,c)})},init:function(a,b,c){CQ_Analytics.ClientContextMgr.PATH=a;CQ_Analytics.ClientContextMgr.loadConfig(c,!0);$CQ.ajax({url:CQ.shared.HTTP.externalize(a+"/content/jcr:content/stores.init.js"),cache:!1,async:!0,dataType:"script",data:{path:b}})},initUI:};CQ_Analytics.ClientContextUtils.DEFAULT_INIT_DELAY=200;
CQ_Analytics.Variables=new function(){return{containsVariable:function(a){return 0<CQ_Analytics.Variables.getVariables(a).length},getVariables:function(a){return a&&"string"==typeof a?(a=a.match(/\$\{([\w/]*)\}/ig))?a:[]:[]},replaceVariables:function(a){if(!a)return a;var b="",c=a;for(a=CQ_Analytics.Variables.getVariables(a);0<a.length&&-1==b.indexOf(a.join());){for(var d=0;d<a.length;d++){var e=CQ_Analytics.Variables.getPropertyPath(a[d]),f=CQ_Analytics.ClientContext.get(e)||"";c=CQ_Analytics.Variables.replace(c,
e,f)}b+=a.join();a=CQ_Analytics.Variables.getVariables(c)}return c},getPropertyPath:function(a){return!a||2>a.length?null:a.substring(2,a.length-1)},getPropertyName:function(a){if(a=CQ_Analytics.Variables.getPropertyPath(a))if(a=a.split("/"),3==a.length)return a[2];return null},getStoreName:function(a){if(a=CQ_Analytics.Variables.getPropertyPath(a))if(a=a.split("/"),1<a.length)return a[1];return null},replace:};
CQ_Analytics.SessionPersistence=CQ.shared.ClientSidePersistence;CQ_Analytics.Cookie=CQ.shared.ClientSidePersistence.CookieHelper;CQ_Analytics.Observable=function(){this.fireEvent=function(a){if(a&&this.listeners&&!this.suppressEvents){a=a.toLowerCase();for(var b=Array.prototype.slice.call(arguments,0),c=this.listeners.slice(0),d=0;d<c.length;d++){var e=c[d];if(a==e.event&&!1===e.fireFn.apply(e.scope||this||window,b))return!1}}return!0}};
CQ_Analytics.Observable.prototype.addListener=function(a,b,c){this.listeners=this.listeners||[];a&&b&&this.listeners.push({event:a.toLowerCase(),fireFn:b,scope:c})};CQ_Analytics.Observable.prototype.removeListener=function(a,b){this.listeners=this.listeners||[];if(a&&b)for(var c=0;c<this.listeners.length;c++)this.listeners[c].event==a&&this.listeners[c].fireFn==b&&this.listeners.splice(c,1)};CQ_Analytics.Observable.prototype.setSuppressEvents=function(a){this.suppressEvents=a};
CQ_Analytics.Observable.prototype.listeners=null;CQ_Analytics.Observable.prototype.suppressEvents=!1;CQ_Analytics.StoreRegistry||(CQ_Analytics.StoreRegistry=new function(){var a={};return{register:getStores:getStore:});CQ_Analytics.SessionStore=function(){};CQ_Analytics.SessionStore.prototype=new CQ_Analytics.Observable;
CQ_Analytics.SessionStore.prototype.setProperty=function(a,b){null==this.data&&this.init();this.data[a]=b;this.fireEvent("update",a)};CQ_Analytics.SessionStore.prototype.setProperties=function(a){null==this.data&&this.init();var b=[],c;for(c in a)a.hasOwnProperty(c)&&(b.push(c),this.data[c]=a[c]);0<b.length&&this.fireEvent("update",b)};CQ_Analytics.SessionStore.prototype.initialized=!1;CQ_Analytics.SessionStore.prototype.init=function(){this.initialized=!0;this.fireEvent("initialize",this)};
CQ_Analytics.SessionStore.prototype.getLabel=function(a){return a};CQ_Analytics.SessionStore.prototype.getLink=function(a){return a};CQ_Analytics.SessionStore.prototype.removeProperty=function(a){null==this.data&&this.init();this.data[a]&&delete this.data[a];this.fireEvent("update",a)};CQ_Analytics.SessionStore.prototype.getPropertyNames=function(a){null==this.data&&this.init();a=a?a:[];var b=[],c;for(c in this.data)-1==CQ_Analytics.Utils.indexOf(a,c)&&b.push(c);return b};
CQ_Analytics.SessionStore.prototype.getSessionStore=function(){return this};CQ_Analytics.SessionStore.prototype.clear=CQ_Analytics.SessionStore.prototype.getData=function(a){null==this.data&&this.init();if(a){var b={},c;for(c in this.data)-1==CQ_Analytics.Utils.indexOf(a,c)&&(b[c]=this.data[c]);return b}return this.data};CQ_Analytics.SessionStore.prototype.reset=
CQ_Analytics.SessionStore.prototype.getProperty=function(a,b){null==this.data&&this.init();a=this.data[a];return b?a:CQ.shared.XSS.getXSSValue(a)};CQ_Analytics.SessionStore.prototype.getName=function(){return this.STORENAME};CQ_Analytics.SessionStore.prototype.addInitProperty=CQ_Analytics.SessionStore.prototype.getInitProperty=
CQ_Analytics.SessionStore.prototype.loadInitProperties=function(a,b){if(a)for(var c in a)this.addInitProperty(c,a[c]),b&&this.data&&void 0===this.data[c]&&this.setProperty(c,a[c])};CQ_Analytics.SessionStore.prototype.isInitialized=function(){return this.initialized};CQ_Analytics.PersistedSessionStore=function(){};CQ_Analytics.PersistedSessionStore.prototype=new CQ_Analytics.SessionStore;CQ_Analytics.PersistedSessionStore.prototype.STOREKEY="key";
CQ_Analytics.PersistedSessionStore.prototype.setNonPersisted=function(a){this.nonPersisted||(this.nonPersisted={});this.nonPersisted[a]=!0};CQ_Analytics.PersistedSessionStore.EXCLUDED_PROPERTIES_REGEX="^generated*";CQ_Analytics.PersistedSessionStore.prototype.isPersisted=function(a){this.nonPersisted||(this.nonPersisted={});return!0!==this.nonPersisted[a]&&!(new RegExp(CQ_Analytics.PersistedSessionStore.EXCLUDED_PROPERTIES_REGEX,"ig")).test(a)&&!$CQ.isFunction(this.data[a])&&"object"!=typeof this.data[a]};
CQ_Analytics.PersistedSessionStore.prototype.getStoreKey=function(){return this.STOREKEY};CQ_Analytics.PersistedSessionStore.prototype.persist=function(){!1!==this.fireEvent("beforepersist")&&((new CQ_Analytics.SessionPersistence({container:"ClientContext"})).set(this.getStoreKey(),this.toString()),this.fireEvent("persist"))};
CQ_Analytics.PersistedSessionStore.prototype.setProperty=function(a,b){null==this.data&&this.init();this.data[a]=b;this.isPersisted(a)&&this.persist();this.fireEvent("update",a)};CQ_Analytics.PersistedSessionStore.prototype.setProperties=function(a){null==this.data&&this.init();var b=[],c=!1,d;for(d in a)a.hasOwnProperty(d)&&(b.push(d),this.data[d]=a[d],this.isPersisted(d)&&(c=!0));c&&this.persist();0<b.length&&this.fireEvent("update",b)};
CQ_Analytics.PersistedSessionStore.prototype.toString=function(){var a=null;if(this.data)for(var b in this.data)if(this.isPersisted(b)&&this.data.hasOwnProperty(b)){a=null===a?"":a+",";var c=b+"\x3d",d;(d=this.data[b])&&"string"==typeof d&&(d=d.replace(/,/g,"\x26#44;"),d=d.replace(/=/g,"\x26#61;"),d=d.replace(/\|/g,"\x26#124;"));a+=c+d}return a};
CQ_Analytics.PersistedSessionStore.prototype.parse=function(a){var b={};a=a.split(",");for(var c in a)if(a.hasOwnProperty(c)){var d=a[c].split("\x3d");if(2==d.length){var e=d[0];(d=d[1])&&"string"==typeof d&&(d=d.replace(/&#44;/g,","),d=d.replace(/&#61;/g,"\x3d"),d=d.replace(/&#124;/g,"|"));b[e]=d}}return b};CQ_Analytics.PersistedSessionStore.prototype.reset=function(a){null!=this.data&&(this.data={},this.persist(),this.data=null,a||this.fireEvent("update"))};
CQ_Analytics.PersistedSessionStore.prototype.removeProperty=function(a){null==this.data&&this.init();this.data[a]&&(delete this.data[a],this.isPersisted(a)&&this.persist());this.fireEvent("update",a)};CQ_Analytics.PersistedSessionStore.prototype.clear=function(){(new CQ_Analytics.SessionPersistence({container:"ClientContext"})).remove(this.getStoreKey());this.data=null};
CQ_Analytics.ClientContextMgr||(CQ_Analytics.ClientContextMgr=function(){this.clientcontextToServer=this.clientcontext=null;this.stores={};this.config=this.data=null;this.areStoresLoaded=this.isConfigLoaded=!1},CQ_Analytics.ClientContextMgr.prototype=new CQ_Analytics.PersistedSessionStore,CQ_Analytics.ClientContextMgr.prototype.STOREKEY="CLIENTCONTEXT",CQ_Analytics.ClientContextMgr.prototype.STORENAME="clientcontext",CQ_Analytics.ClientContextMgr.prototype.INITIALIZATION_EVENT_TIMER=1E3,CQ_Analytics.ClientContextMgr.prototype.CONFIG_PATH=
CQ_Analytics.Utils.externalize("/etc/clientcontext/legacy/config.json",!0),CQ_Analytics.ClientContextMgr.prototype.init=function(){this.initialized||(this.clientcontext={},this.clientcontextToServer={});var a=(new CQ_Analytics.SessionPersistence({container:"ClientContext"})).get(this.getStoreKey());this.data=a?this.parse(a):{};this.initialized=!0;this.fireEvent("initialize",this)},CQ_Analytics.ClientContextMgr.prototype.getSessionId=function(){this.data.sessionId||this.setSessionId(CQ_Analytics.Utils.getUID());
return this.data.sessionId},CQ_Analytics.ClientContextMgr.prototype.setSessionId=CQ_Analytics.ClientContextMgr.prototype.getVisitorId=CQ_Analytics.ClientContextMgr.prototype.setVisitorId=CQ_Analytics.ClientContextMgr.prototype.getId=CQ_Analytics.ClientContextMgr.prototype.isAnonymous=
CQ_Analytics.ClientContextMgr.prototype.isMode=CQ_Analytics.ClientContextMgr.prototype.get=function(a){null==this.clientcontext&&this.init();return a?this.clientcontextToServer:this.clientcontext},CQ_Analytics.ClientContextMgr.prototype.register=function(a){null==this.clientcontext&&this.init();var b=this;this.clientcontext[a.getName()]=a.getData();this.stores[a.getName()]=a;CQ_Analytics.StoreRegistry.register(a);var c=this.getStoreConfig(a.getName());
!1!==c.stats&&"false"!=c.stats&&(this.clientcontextToServer[a.getName()]=a.getData(c.excludedFromStats));this.initTimer&&(window.clearTimeout(this.initTimer),this.initTimer=null);this.initTimer=window.setTimeout(this.isConfigLoaded&&"undefined"!==typeof this.config.initializationEventTimer?this.config.initializationEventTimer:this.INITIALIZATION_EVENT_TIMER);a.addListener("update",;CQ_Analytics.ClientContextMgr.ServerStorage.handleStoreRegistration(a);
this.addListener("clear",;this.fireEvent("storeregister",a);this.fireEvent("storeupdate",a)},CQ_Analytics.ClientContextMgr.prototype.update=function(a){null==this.clientcontext&&this.init();this.clientcontext[a.getName()]=a.getData();var b=this.getStoreConfig(a.getName());!1!==b.stats&&"false"!=b.stats&&(this.clientcontextToServer[a.getName()]=a.getData(b.excludedFromStats));this.fireEvent("storeupdate",a)},CQ_Analytics.ClientContextMgr.prototype.startPosting=function(){return CQ_Analytics.ClientContextMgr.ServerStorage.startPosting()},
CQ_Analytics.ClientContextMgr.prototype.stopPosting=function(){return CQ_Analytics.ClientContextMgr.ServerStorage.stopPosting()},CQ_Analytics.ClientContextMgr.prototype.post=function(){return CQ_Analytics.ClientContextMgr.ServerStorage.post()},CQ_Analytics.ClientContextMgr.prototype.getCCMToJCR=CQ_Analytics.ClientContextMgr.prototype.getName=function(){return this.STORENAME},CQ_Analytics.ClientContextMgr.prototype.clear=
CQ_Analytics.ClientContextMgr.prototype.getRegisteredStore=CQ_Analytics.ClientContextMgr.prototype.loadConfig=function(a,b){var c=function(a,b){"undefined"===typeof b&&(b={});a.config=b;a.isConfigLoaded=!0;a.fireEvent("configloaded");a.fireEvent("storesloaded");a.areStoresLoaded=!0};a?c(this,a):b?c(this,{}):(a={},a.path=CQ_Analytics.Utils.getPagePath(),
a.cq_ck=(new Date).valueOf(),b=this.CONFIG_PATH,b+="?"+CQ_Analytics.Utils.urlEncode(a),CQ_Analytics.Utils.load(b,function(a,b,f){a={};try{a=eval("config \x3d "+f.responseText)}catch(g){}c(this,a)},this))},CQ_Analytics.ClientContextMgr.prototype.getConfig=function(){return this.config},CQ_Analytics.ClientContextMgr.prototype.getStoreConfig=function(a){return this.config&&this.config.configs&&this.config.configs[a]&&this.config.configs[a].store?this.config.configs[a].store:{}},CQ_Analytics.ClientContextMgr.prototype.getEditConfig=
function(a){return this.config&&this.config.configs&&this.config.configs[a]&&this.config.configs[a].edit?this.config.configs[a].edit:{}},CQ_Analytics.ClientContextMgr.prototype.getUIConfig=function(a){return this.config&&this.config.configs&&this.config.configs[a]&&this.config.configs[a].ui?this.config.configs[a].ui:{}},CQ_Analytics.ClientContextMgr.prototype.getInitialData=function(a){return this.config&&this.config.data&&this.config.data[a]?this.config.data[a]:{}},CQ_Analytics.ClientContextMgr.prototype.getStores=
function(){return this.stores},CQ_Analytics.ClientContextMgr.prototype.onReady=function(a,b){a&&(this.areStoresLoaded?a.call(b):this.addListener("storesloaded",a,b))},CQ_Analytics.ClientContextMgr=new CQ_Analytics.ClientContextMgr,CQ_Analytics.CCM=CQ_Analytics.ClientContextMgr,CQ_Analytics.ClickstreamcloudMgr=CQ_Analytics.CCM,CQ_Analytics.ContextCloudMgr=CQ_Analytics.CCM,CQ_Analytics.ClientContextMgr.PATH=null,CQ_Analytics.ClientContextMgr.getClientContextURL=window.setTimeout(1),CQ_Analytics.Utils.addListener(window,"unload",function(){try{for(var a in CQ_Analytics.ClientContextMgr)delete CQ_Analytics.ClientContextMgr[a];CQ_Analytics.ClientContextMgr=null}catch(b){}CQ_Analytics.CCM=null}));
window.CQ_Analytics&&window.CQ_Analytics.ClientContextMgr&&!window.CQ_Analytics.ClientContextMgr.ServerStorage&&(CQ_Analytics.ClientContextMgr.ServerStorage=CQ_Analytics.ClientContextMgr.ServerStorage.prototype.POST_MODE_PAGELOAD=1,CQ_Analytics.ClientContextMgr.ServerStorage.prototype.POST_MODE_TIMER=2,CQ_Analytics.ClientContextMgr.ServerStorage.prototype.POST_MODE_DATAUPDATE=4,CQ_Analytics.ClientContextMgr.ServerStorage.prototype.POST_TIMER=600,CQ_Analytics.ClientContextMgr.ServerStorage.prototype.POST_PROCESS_TIMER=
60,CQ_Analytics.ClientContextMgr.ServerStorage.prototype.POST_MODE=6,CQ_Analytics.ClientContextMgr.ServerStorage.prototype.POST_PATH="/var/statistics/",CQ_Analytics.ClientContextMgr.ServerStorage.prototype.init=function(){if(this.isMode(CQ_Analytics.ClientContextMgr.ServerStorage.POST_MODE_TIMER)){var a=this;(function(){a.timer=window.setInterval(function(){try{var b=parseInt(a.data.lastPost),c=!1;isNaN(b)?c=!0:(new Date).getTime()>b+1E3*CQ_Analytics.ClientContextMgr.ServerStorage.POST_TIMER&&(c=
!0)}catch(d){}c&&a.post()},1E3*CQ_Analytics.ClientContextMgr.ServerStorage.POST_PROCESS_TIMER)}).call(this)}this.initialized=!0},CQ_Analytics.ClientContextMgr.ServerStorage.prototype.isMode=function(a){return 0<(CQ_Analytics.CCM.POST_MODE&a)},CQ_Analytics.ClientContextMgr.ServerStorage.prototype.handleStoreRegistration=function(a){this.initialized||this.init();this.isMode(CQ_Analytics.ClientContextMgr.ServerStorage.POST_MODE_DATAUPDATE)&&a.addListener("persist",},
CQ_Analytics.ClientContextMgr.ServerStorage.prototype.startPosting=function(){this.posting=!0},CQ_Analytics.ClientContextMgr.ServerStorage.prototype.stopPosting=CQ_Analytics.ClientContextMgr.ServerStorage.prototype.post=function(a,b){if(this.posting||b)try{var c=this.getCCMToJCR(a),d=CQ_Analytics.Utils.getTimestamp();c["./jcr:primaryType"]="nt:unstructured";c["./sessionId"]=CQ_Analytics.CCM.getSessionId();var e=this.POST_PATH+"clientcontext/";if(CQ_Analytics.CCM.isAnonymous()){var f=
CQ_Analytics.Utils.insert(CQ_Analytics.CCM.getId(),2,"/");e+="anonymous/"+f+"/"+d}else e+="users/"+CQ_Analytics.CCM.getId()+"/"+d;CQ_Analytics.Utils.post(e,null,c);this.lastPost=d}catch(g){}},CQ_Analytics.ClientContextMgr.ServerStorage.prototype.getCCMToJCR=function(a){var b=CQ_Analytics.CCM.get(!0),c={},d;for(d in b)if(!a||d==a){var e=b[d];encodeURIComponent(d);if("object"==typeof e)for(var f in e){var g=e[f];f=f.replace(":","/");c["./"+d+"/./"+f]=g}else c["./"+d]=e}return c},CQ_Analytics.ClientContextMgr.ServerStorage=
new CQ_Analytics.ClientContextMgr.ServerStorage,CQ_Analytics.ClickstreamcloudMgr.POST_MODE_PAGELOAD=CQ_Analytics.ClientContextMgr.ServerStorage.POST_MODE_PAGELOAD,CQ_Analytics.ClickstreamcloudMgr.POST_MODE_TIMER=CQ_Analytics.ClientContextMgr.ServerStorage.POST_MODE_TIMER,CQ_Analytics.ClickstreamcloudMgr.POST_MODE_DATAUPDATE=CQ_Analytics.ClientContextMgr.ServerStorage.POST_MODE_DATAUPDATE,CQ_Analytics.ClickstreamcloudMgr.POST_TIMER=CQ_Analytics.ClientContextMgr.ServerStorage.POST_PROCESS_TIMER,CQ_Analytics.ClickstreamcloudMgr.POST_PROCESS_TIMER=
CQ_Analytics.ClientContextMgr.ServerStorage.POST_PROCESS_TIMER,CQ_Analytics.ClickstreamcloudMgr.POST_MODE=CQ_Analytics.ClientContextMgr.ServerStorage.POST_MODE,CQ_Analytics.ClickstreamcloudMgr.POST_PATH=CQ_Analytics.ClientContextMgr.ServerStorage.POST_PATH);CQ_Analytics.Percentile={};
CQ_Analytics.Percentile.matchesPercentiles=function(a){var b=ClientContext.get("/surferinfo/percentile");b?b=Number(b):(b=Math.round(100*Math.random()),ClientContext.set("/surferinfo/percentile",b));for(var c=0;c<a.length;c++){var d=a[c];if(Number(d.start)<=b&&b<Number(d.end))return!0}return!1};
CQ_Analytics.SegmentMgr||(CQ_Analytics.SegmentMgr=CQ_Analytics.SegmentMgr.prototype=new CQ_Analytics.SessionStore,CQ_Analytics.SegmentMgr.prototype.STORENAME="segments",CQ_Analytics.SegmentMgr.prototype.register=function(a,b,c){this.segments[a]=b;this.rulesCache&&
this.rulesCache[a]&&(this.rulesCache[a]=!1);this.boosts[a]=isNaN(c)?0:parseInt(c);this.fireUpdate()},CQ_Analytics.SegmentMgr.prototype.resolveArray=function(a,b,c){b=b||CQ_Analytics.ClientContextMgr.get();if(!(a instanceof Array))return this.resolve(a,b);c="AND"==c?"AND":"OR";for(var d="AND"==c,e=0;e<a.length;e++){var f=this.resolve(a[e],b);if("AND"==c){if(!0!==f)return f}else if(!0===f)return!0}return d},CQ_Analytics.SegmentMgr.prototype.resolve=function(a,b){b=b||CQ_Analytics.ClientContextMgr.get();
if(!a)return!1;if(a instanceof Array)return this.resolveArray(a,b);if(0!=a.indexOf(this.SEGMENTATION_ROOT))return!1;if(a==this.SEGMENTATION_ROOT||!this.segments[a])return!0;var c=a.substring(0,a.lastIndexOf("/"));if(0==c.indexOf(this.SEGMENTATION_ROOT)&&(c=this.resolve(c,b),!0!==c))return c;c="function(clientcontext, contextcloud, clickstreamcloud) { return true "+(" \x26\x26 ( "+this.segments[a]+" ) ");c+=";}";try{var d=null;this.rulesCache=this.rulesCache||{};this.rulesCache[a]?d=this.rulesCache[a]:
(eval("f \x3d "+c),this.rulesCache[a]=d);var e=null==d||d(b,b,b)}catch(f){return"Unresolved - Error while evaluating segment "+a+" : "+f.message}return!0===e},CQ_Analytics.SegmentMgr.prototype.getResolved=function(a){a=a||CQ_Analytics.ClientContextMgr.get();var b=[],c;for(c in this.segments)!0===this.resolve(c,a)&&b.push(c);return b},CQ_Analytics.SegmentMgr.prototype.getMaxBoost=function(a,b){if(!(a instanceof Array))return this.getBoost(a);for(var c=0,d=0;d<a.length;d++){var e=a[d];!0===this.resolve(e,
b)&&(e=this.boosts[e]||0,e>c&&(c=e))}return c},CQ_Analytics.SegmentMgr.prototype.getBoost=function(a){a instanceof Array||(a=[a]);return this.boosts[a]||0},CQ_Analytics.SegmentMgr.prototype.reload=function(a){a||(a=this.SEGMENTATION_ROOT);if(a){-1==a.indexOf(this.SEGMENT_SELECTOR)&&(a+=this.SEGMENT_SELECTOR);try{a+=(-1===a.indexOf("?")?"?":"\x26")+"_\x3d"+(new Date).getTime(),CQ_Analytics.Utils.load(a,this),CQ.HTTP.get(scripts[i].src)}catch(b){}}},
CQ_Analytics.SegmentMgr.prototype.getSessionStore=function(){return this},CQ_Analytics.SegmentMgr.prototype.getProperty=function(a){return a},CQ_Analytics.SegmentMgr.prototype.getLink=CQ_Analytics.SegmentMgr.prototype.getLabel=function(a){if(a){var b=a,c=b.lastIndexOf("/");-1!=c&&(b=b.substring(c+1,b.length));c=this.resolve(a);if(!0===c)return b;if(!0!==c)return'\x3cspan class\x3d"invalid" title\x3d"'+c+'" alt\x3d"'+c+'"\x3e'+b+"\x3c/span\x3e"}return a},CQ_Analytics.SegmentMgr.prototype.getPropertyNames=
CQ_Analytics.SegmentMgr=new CQ_Analytics.SegmentMgr,CQ_Analytics.SegmentMgr.loadSegments=function(a){CQ_Analytics.SegmentMgr.areSegmentsLoaded=!1;a&&0!==a.length?$CQ.ajax({url:CQ.shared.HTTP.externalize(a+this.SEGMENT_SELECTOR),dataType:"script",async:!0,cache:!0}).complete(function(){CQ_Analytics.SegmentMgr.areSegmentsLoaded=!0;CQ_Analytics.SegmentMgr.fireEvent("segmentsload")}):(CQ_Analytics.SegmentMgr.areSegmentsLoaded=!0,CQ_Analytics.SegmentMgr.fireEvent("segmentsload"))},
CQ_Analytics.SegmentMgr.renderer=function(a,b){if(a&&a.STORENAME==CQ_Analytics.SegmentMgr.STORENAME){var c=a.getPropertyNames(),d=[];d.push("\x3cdiv\x3e");for(var e=0;e<c.length;e++){var f=c[e];d.push('\x3cspan title\x3d"'+a.getProperty(f)+'" \x3e\x3ca href\x3d"'+CQ.shared.HTTP.externalize(a.getLink(f))+'"  title\x3d"'+a.getProperty(f)+'" \x3e'+a.getLabel(f)+"\x3c/a\x3e\x3c/span\x3e")}d.push("\x3c/div\x3e");$CQ("#"+b).children().remove();$CQ("#"+b).append(d.join(""))}},CQ_Analytics.ClientContextMgr.addListener("storeupdate",
CQ_Analytics.SegmentMgr.fireUpdate),CQ_Analytics.Utils.addListener(window,"unload",function(){try{for(var a in CQ_Analytics.SegmentMgr)delete CQ_Analytics.SegmentMgr[a]}catch(b){}CQ_Analytics.SegmentMgr=null}));
CQ_Analytics.StrategyMgr||(CQ_Analytics.StrategyMgr=function(){this.strategies={}},CQ_Analytics.StrategyMgr.prototype={},CQ_Analytics.StrategyMgr.prototype.isRegistered=CQ_Analytics.StrategyMgr.prototype.register=CQ_Analytics.StrategyMgr.prototype.choose=function(a,b){return 1==b.length?b[0]:this.strategies[a]?this.strategies[a].call(this,b):null},CQ_Analytics.StrategyMgr=new CQ_Analytics.StrategyMgr);
CQ_Analytics.StrategyMgr.register("clickstream-score",function(a){if(1==a.length)return a[0];var b=[];if(window.CQ_Analytics&&window.CQ_Analytics.TagCloudMgr){var c=CQ_Analytics.TagCloudMgr.getTags();c=c||{};for(var d=-1,e=0;e<a.length;e++){var f=0,g=a[e].tags;if(g)for(var h=0;h<g.length;h++)f+=parseInt(c[g[h].tagID])||0;f==d?b.push(a[e]):f>d&&(b=[],b.push(a[e]),d=f)}}else b=a;if(1==b.length)return b[0];a=null;window.CQ_Analytics&&window.CQ_Analytics.PageDataMgr&&(a=CQ_Analytics.PageDataMgr.getProperty("random"));
a||(a=window.CQ_StrategyRandom);a||(a=window.CQ_StrategyRandom=Math.random());1<parseFloat(a)&&(a=1/a);1==parseFloat(a)&&(a=0);return b[Math.floor(a*b.length)]});CQ_Analytics.StrategyMgr.register("first",;
CQ_Analytics.StrategyMgr.register("random",function(a){var b=null;window.CQ_Analytics&&window.CQ_Analytics.PageDataMgr&&(b=CQ_Analytics.PageDataMgr.getProperty("random"));b||(b=window.CQ_StrategyRandom);b||(b=window.CQ_StrategyRandom=Math.random());1<parseFloat(b)&&(b=1/b);1==parseFloat(b)&&(b=0);return a[Math.floor(b*a.length)]});
CQ_Analytics.PageDataMgr||(CQ_Analytics.PageDataMgr=function(){},CQ_Analytics.PageDataMgr.prototype=new CQ_Analytics.SessionStore,CQ_Analytics.PageDataMgr.prototype.STORENAME="pagedata",CQ_Analytics.PageDataMgr.prototype.FORCE_EXPERIENCE_COOKIE="cq-forceexperience",CQ_Analytics.PageDataMgr.prototype.init=function(){this.data={};for(var a in this.initProperty)this.data[a]=this.initProperty[a];this.initialized=!0;this.fireEvent("initialize",this);this.fireEvent("update")},CQ_Analytics.PageDataMgr.prototype.getLabel=
function(a){return a},CQ_Analytics.PageDataMgr.prototype.getLink=function(a){return""},CQ_Analytics.PageDataMgr.prototype.setExperience=CQ_Analytics.PageDataMgr.prototype.getExperience=CQ_Analytics.PageDataMgr.prototype.clearExperience=CQ_Analytics.PageDataMgr=new CQ_Analytics.PageDataMgr,CQ_Analytics.CCM.addListener("configloaded",CQ_Analytics.PageDataMgr));
CQ_Analytics.BrowserInfo=function(){var a=navigator.userAgent.toLowerCase(),b=c=function(){if(b(/opera/))return{browserFamily:"Opera",browserVersion:""};if(b(/trident/)){var c={"7.0":"11","6.0":"10","5.0":"9","4.0":"8"},e=a.match(/trident\/([0-9\.]*)/),f="";e&&1<e.length&&(f=c[e[1]]);return{browserFamily:"IE",browserVersion:f}}return b(/edge/)?(e=a.match(/edge\/([0-9]*)/),f="",e&&1<e.length&&(f=e[1]),{browserFamily:"Edge",browserVersion:f}):b(/chrome/)?{browserFamily:"Chrome",
browserVersion:""}:b(/safari/)?b(/applewebkit\/4/)?{browserFamily:"Safari",browserVersion:"2"}:b(/version\/3/)?{browserFamily:"Safari",browserVersion:"3"}:b(/version\/4/)?{browserFamily:"Safari",browserVersion:"4"}:b(/version\/5/)?{browserFamily:"Safari",browserVersion:"5"}:b(/version\/6/)?{browserFamily:"Safari",browserVersion:"6"}:{browserFamily:"Safari",browserVersion:"7 or higher"}:b(/webkit/)?{browserFamily:"WebKit",browserVersion:""}:b(/msie/)?b(/msie 6/)?{browserFamily:"IE",browserVersion:"6"}:
b(/msie 7/)?{browserFamily:"IE",browserVersion:"7"}:b(/msie 8/)?{browserFamily:"IE",browserVersion:"8"}:b(/msie 9/)?{browserFamily:"IE",browserVersion:"9"}:b(/msie 10/)?{browserFamily:"IE",browserVersion:"10"}:{browserFamily:"IE",browserVersion:"11 or higher"}:b(/gecko/)?b(/rv:1\.8/)?{browserFamily:"Firefox",browserVersion:"2"}:b(/rv:1\.9/)?{browserFamily:"Firefox",browserVersion:"3"}:b(/rv:2.0/)?{browserFamily:"Firefox",browserVersion:"4"}:b(/rv:5./)?{browserFamily:"Firefox",browserVersion:"5"}:
b(/rv:6./)?{browserFamily:"Firefox",browserVersion:"6"}:b(/rv:7./)?{browserFamily:"Firefox",browserVersion:"7"}:b(/rv:8./)?{browserFamily:"Firefox",browserVersion:"8"}:b(/rv:9./)?{browserFamily:"Firefox",browserVersion:"9"}:{browserFamily:"Firefox",browserVersion:"10 or higher"}:b(/adobeair/)?{browserFamily:"Adobe AIR",browserVersion:""}:{browserFamily:"Unresolved",browserVersion:"Unresolved"}}.call();this.browserFamily=c.browserFamily;this.browserVersion=c.browserVersion;this.OSName=function(){return b(/windows 98|win98/)?
"Windows 98":b(/windows nt 5.0|windows 2000/)?"Windows 2000":b(/windows nt 5.1|windows xp/)?"Windows XP":b(/windows nt 5.2/)?"Windows Server 2003":b(/windows nt 6.0/)?"Windows Vista":b(/windows nt 6.1/)?"Windows 7":b(/windows nt 6.2/)?"Windows 8":b(/windows nt 6.3/)?"Windows 8.1":b(/windows nt 10.0/)?"Windows 10":b(/windows nt 4.0|winnt4.0|winnt/)?"Windows NT 4.0":b(/windows me/)?"Windows ME":b(/mac os x/)?b(/ipad/)||b(/iphone/)?"iOS":"Mac OS X":b(/macintosh|mac os/)?"Mac OS":b(/android/)?"Android":
b(/linux/)?"Linux":"Unresolved"}.call();this.deviceType=function(){return b(/ipad/)?"iPad":b(/iphone/)?"iPhone":b(/mobi/)?"Mobile":"Desktop"}.call();this.ua=a;/^https/i.test(window.location.protocol);this.screenResolution=screen.width+"x"+screen.height};
CQ_Analytics.BrowserInfo.prototype={getBrowserName:getBrowserFamily:function(){return this.browserFamily},getBrowserVersion:function(){return this.browserVersion},getOSName:function(){return this.OSName},getScreenResolution:function(){return this.screenResolution},getDeviceType:function(){return this.deviceType},getUserAgent:function(){return this.ua},isMobile:function(a){a||(a=this.getDeviceType());a=a?a.toLowerCase():"desktop";return"desktop"!=
a},isIE:function(a){return"IE"==this.getBrowserFamily()&&(a?this.getBrowserVersion()==a:!0)},isIE6:function(){return this.isIE("6")},isIE7:function(){return this.isIE("7")},isIE8:function(){return this.isIE("8")},isIE9:function(){return this.isIE("9")}};CQ_Analytics.BrowserInfoInstance=new CQ_Analytics.BrowserInfo;
CQ_Analytics.MousePositionMgr||(CQ_Analytics.MousePositionMgr=function(){this.position={x:0,y:0};this.getPageX=function(a){var b=a.pageX;b||0===b||(b=a.clientX||0);return b};this.getPageY=function(a){var b=a.pageY;b||0===b||(b=a.clientY||0);return b};var a=this;this.timer=null;$CQ(document).bind("mousemove",function(b,c,d,e){if((b=b||window.event)&&!a.timer){var f=a.getPageX(b),g=a.getPageY(b);a.timer=setTimeout(500)}});this.init()},CQ_Analytics.MousePositionMgr.prototype=
new CQ_Analytics.SessionStore,CQ_Analytics.MousePositionMgr.prototype.STORENAME="mouseposition",CQ_Analytics.MousePositionMgr.prototype.setPosition=CQ_Analytics.MousePositionMgr.prototype.getProperty=CQ_Analytics.MousePositionMgr.prototype.getLabel=function(a){return a},CQ_Analytics.MousePositionMgr.prototype.getLink=function(a){return""},CQ_Analytics.MousePositionMgr.prototype.getPropertyNames=
CQ_Analytics.MousePositionMgr.prototype.getSessionStore=CQ_Analytics.MousePositionMgr.prototype.getData=CQ_Analytics.MousePositionMgr.prototype.clear=CQ_Analytics.MousePositionMgr=new CQ_Analytics.MousePositionMgr,CQ_Analytics.CCM.register(CQ_Analytics.MousePositionMgr));
CQ_Analytics.EventDataMgr||(CQ_Analytics.EventDataMgr=function(){},CQ_Analytics.EventDataMgr.prototype=new CQ_Analytics.SessionStore,CQ_Analytics.EventDataMgr.prototype.STORENAME="eventdata",CQ_Analytics.EventDataMgr.prototype.init=function(){this.data={};for(var a in this.initProperty)this.data[a]=this.initProperty[a];this.initialized=!0;this.fireEvent("initialize",this);"undefined"!=typeof this.initProperty&&this.fireEvent("update")},CQ_Analytics.EventDataMgr.prototype.getLabel=
CQ_Analytics.EventDataMgr.prototype.getLink=CQ_Analytics.EventDataMgr=new CQ_Analytics.EventDataMgr,CQ_Analytics.EventDataMgr.init(),CQ_Analytics.CCM.register(CQ_Analytics.EventDataMgr));
window.CQ_Context||(window.CQ_Context=function(){},window.CQ_Context.prototype=new CQ_Analytics.Observable,window.CQ_Context.prototype.getProfile=function(){return function(){return{getUserId:function(){return this.getProperty("authorizableId")},getDisplayName:function(){var a=this.getProperty("formattedName");return a?a:(a=this.getProperty("displayName"))?a:this.getUserId()},getFirstname:function(){return this.getProperty("givenName")},getLastname:function(){return this.getProperty("familyName")},
getEmail:function(){return this.getProperty("email")},getProperty:getProperties:function(){return window.CQ_Analytics&&window.CQ_Analytics.ProfileDataMgr?CQ_Analytics.ProfileDataMgr.getData():{}},getAvatar:onUpdate:function(a,b){a&&CQ_Analytics&&CQ_Analytics.ProfileDataMgr&&CQ_Analytics.ProfileDataMgr.addListener("update",a,b||this)}}}()},
window.CQ_Context=new window.CQ_Context);
CQ_Analytics.Engine=function(){function a(){return!!(window.CQ&&CQ.WCM&&CQ.WCM.isEditMode())}unction c(a){var b=$CQ.Deferred(),c=CQ.WCM.getEditable(a);if(c)b.resolve(c);else CQ.WCM.onEditableReady(a,;return b.promise()}function d(a,b){CQ_Analytics.loadedTeasersStack||(CQ_Analytics.loadedTeasersStack=[],$CQ(window).unload(function(){try{var a=CQ_Analytics.loadedTeasersStack;if(a){delete CQ_Analytics.loadedTeasersStack;
for(var c=b,d=0;d<a.length;d++)c=CQ.shared.HTTP.addParameter(c,"path",a[d]);CQ.shared.HTTP.get(c,function(){})}}catch(v){}}));CQ_Analytics.loadedTeasersStack.push(a.path)}function e(a,b,c){function d(a,b,c,d){return'\x3ca href\x3d"'+b+'" class\x3d"cq-teaser-segment-link"\x3e\x3cimg src\x3d"'+c+'" class\x3d"cq-teaser-decision-thumbnail '+(d?"cq-teaser-decision-match":"cq-teaser-decision-nomatch")+'"\x3e\x3c/a\x3e'+a+"\x3cbr\x3e"}for(var e="",f,g=0;g<a.length;g++){var l=a[g],k=CQ.shared.HTTP.externalize(l.teaser.path+
".html");l.hasOwnProperty("boost")?(f=l.noSegment?CQ.I18n.getMessage("Experience: {0} - match (no segments, boost \x3d {1})",[l.teaser.title,l.boost]):CQ.I18n.getMessage("Experience: {0} - match (boost \x3d {1})",[l.teaser.title,l.boost]),f=d(f,k,l.teaser.thumbnail,!0),e=b===l.teaser.path?e+("\x3cb\x3e"+f+"\x3c/b\x3e"):e+f):(f=l.unknownSegment?CQ.I18n.getMessage("Experience: {0} - no match (unknown segment)",[l.teaser.title]):CQ.I18n.getMessage("Experience: {0} - no match",[l.teaser.title]),e+=d(f,
k,l.teaser.thumbnail,!1))}e+="\x3cbr\x3e";e=c?e+CQ.I18n.getMessage("Strategy \x3cb\x3e{0}\x3c/b\x3e selected current teaser.",c):e+CQ.I18n.getMessage("No strategy configured, used the first match.");return e+"\x3cbr\x3e"}function f(a,b,c,d){a.done(function(a){a.teaserToolTip&&(a.teaserToolTip.hide(),a.teaserToolTip.remove());a.teaserToolTip=new CQ.Ext.Tip({html:e(b,c,d),title:CQ.I18n.getMessage("Selection decision"),width:450,autoHide:!1,closable:!0,height:300,floating:!0,autoHeight:!1,bodyStyle:"overflow-y: scroll;"});
a.on(CQ.wcm.EditRollover.EVENT_SHOW_HIGHTLIGHT,function(b){this.teaserInfoButton||(this.teaserInfoButton=CQ.Ext.DomHelper.append("CQ",{tag:"div",cls:"x-tool x-tool-help cq-teaser-tooltip-tool"},!0),this.teaserInfoButton.position("absolute"),this.teaserInfoButton.on("click",);this.teaserInfoButton.anchorTo(b.frameBottom.getEl(),"tr",[-26,-15]);this.teaserInfoButton.show()});a.on(CQ.wcm.EditRollover.EVENT_HIDE_HIGHTLIGHT,
function(a){this.teaserInfoButton&&this.teaserInfoButton.hide()})})}function g(a){a.done(function(a){a.teaserToolTip&&(a.teaserToolTip.hide(),a.teaserToolTip.remove(),a.teaserToolTip=null)})}indow.CQ_trackTeasersStats=!0;var k={},m={};return{stopTeaserLoader:function(a){if(a=a.path||a){var b=k[a];b&&(CQ_Analytics.SegmentMgr.removeListener("update",b),delete k[a])}},resolveTeaser:function(a,b,c){for(var d=[],e=0,f=0;f<a.length;f++){var g=
a[f],l=g.segments;if(c){var k={teaser:g};c.push(k)}var m=!l||0===l.length;m&&k&&(k.noSegment=!0);!m&&CQ_Analytics.SegmentMgr.resolve(l)&&(m=!0,l&&0<l.length&&!CQ_Analytics.SegmentMgr.segments[l[0]]&&(m=!1,k&&(k.unknownSegment=!0)));m&&(l=CQ_Analytics.SegmentMgr.getMaxBoost(l),k&&(k.boost=l),l===e?d.push(g):l>e&&(d=[],d.push(g),e=l))}a=d;return 0===a.length?null:CQ_Analytics.StrategyMgr.choose(b,a)||a[0]},loadTeaser:function(e){if(a()){var k=CQ.WCM.getEditablePathFromDOM(document.getElementById(e.targetID));
var l=c(k)}var n=ClientContext.get("campaign");n&&n.isCampaignSelected()&&!b||(n=function(){var b=CQ_Analytics.PageDataMgr.getExperience();if(b){CQ_Analytics.PageDataMgr.clearExperience();var c="/_jcr_content/par.html";a()&&(c+="?wcmmode\x3ddisabled");CQ_Analytics.Utils.loadElement(b+c,e.targetID)}else{var x=null;b=function(){var b=null;a()&&(b=[]);var c=ClientContext.get("campaign");if(c&&c.isCampaignSelected()){var k=c.data.path,h=c.data["recipe/path"],t=c.data.campaigns||[];c=e.teasers;for(var w,
u=0;u<c.length;u++)"default"===c[u].name&&(w=c[u]);if(m[e.targetID]&&m[e.targetID][h])var r=m[e.targetID][h];else{if("DEFAULT"===h)r=w;else{for(u=0;u<t.length;u++){var n=t[u];if(t[u].path===k){n=n.experiences;for(var p=0;p<n.length;p++)if(n[p].path===h&&n[p].hasOwnProperty("segments"))for(var q=n[p].segments,v=0;v<q.length;v++);}}for(u=0;u<c.length;u++){h=c[u];if(k=h.hasOwnProperty("segments")&&h.segments.length===q.length)a:if(k=q,h=h.segments,k&&h&&k.length===h.length){k.sort();h.sort();for(t=0;t<
k.length;t++)if(k[t]!==h[t]){k=!1;break a}k=!0}else k=!1;if(k){r=c[u];break}}}r||(r=w);m[e.targetID]={experience:r}}}else r=CQ_Analytics.Engine.resolveTeaser(e.teasers,e.strategy,b);r?x&&x.path===r.path||(x=r,CQ_Analytics.SegmentMgr.fireEvent("teaser-loaded",{campaignPath:r.campaignPath||"",campaignName:r.campainName||"",experiencePath:r.path||"",segmentName:r.title||"",segments:r.segments||[],targetElement:e.targetID}),w=r.url,a()&&(w+="?wcmmode\x3ddisabled"),CQ_Analytics.Utils.loadTeaserElement(w,
e.targetID),window.CQ_trackTeasersStats&&e.trackingURL&&d(r,e.trackingURL),l&&f(l,b,x.path,e.strategy)):(l&&g(l),CQ_Analytics.Utils.clearElement(e.targetID),x=null)};b.call();CQ_Analytics.SegmentMgr&&(k&&h(k,b),CQ_Analytics.SegmentMgr.addListener("update",b));CQ_Analytics.CampaignMgr&&CQ_Analytics.CampaignMgr&&CQ_Analytics.CampaignMgr.addListener("update",b)}},CQ_Analytics.CCM.areStoresInitialized?n.call(this):CQ_Analytics.CCM.addListener("storesinitialize",n))}}}();window.CQ_trackTeasersStats=!0;
function initializeTeaserLoader(a,b,c,d,e,f){d=!(!CQ.Ext||"true"!=d&&!0!==d);if(window.CQ_Analytics){var g=function(){var g="/_jcr_content/par.html";d&&(g+="?wcmmode\x3ddisabled");var k=CQ_Analytics.PageDataMgr.getExperience();if(k)CQ_Analytics.PageDataMgr.clearExperience(),CQ_Analytics.Utils.loadElement(k+g,c);else{var m=null;k=function(){var k=[];if(CQ_Analytics.SegmentMgr)for(var h=0,q=0;q<a.length;q++)if(!a[q].segments||0==a[q].segments.length||!0===CQ_Analytics.SegmentMgr.resolveArray(a[q].segments)){var n=
CQ_Analytics.SegmentMgr.getMaxBoost(a[q].segments);n==h?k.push(a[q]):n>h&&(k=[],k.push(a[q]),h=n)}if(0<k.length){if(h=k[0],CQ_Analytics.StrategyMgr&&(k=CQ_Analytics.StrategyMgr.choose(b,k),null!=k&&(h=k)),!m||m.path!=h.path)if(m=h,k=h.path+g,k=CQ.shared.HTTP.addSelectors(k,CQ.shared.HTTP.getSelectors(window.location.href)),CQ_Analytics.Utils.loadTeaserElement(k,c),window.CQ_trackTeasersStats&&e&&(CQ_Analytics.loadedTeasersStack||(CQ_Analytics.loadedTeasersStack=[],$CQ(window).unload(function(){try{var a=
CQ_Analytics.loadedTeasersStack;if(a){delete CQ_Analytics.loadedTeasersStack;for(var b=e,c=0;c<a.length;c++)b=CQ.shared.HTTP.addParameter(b,"path",a[c]);CQ.shared.HTTP.get(b,function(){})}}catch(z){}})),CQ_Analytics.loadedTeasersStack.push(h.path)),d&&f){var p=CQ.WCM.getEditable(f);p&&(p&&p.teaserToolTip?(p.teaserToolTip.hide(),p.teaserToolTip.remove(),p.teaserToolTip=null):(p.on(CQ.wcm.EditRollover.EVENT_SHOW_HIGHTLIGHT,function(c){this.teaserInfoButton||(this.teaserInfoButton=CQ.Ext.DomHelper.append("CQ",
{tag:"div",cls:"x-tool x-tool-help cq-teaser-tooltip-tool"},!0),this.teaserInfoButton.position("absolute"),this.teaserInfoButton.on("click",function(){if(!p.teaserToolTip){var c=p,d=CQ.Ext.Tip,e=m.path,f="",g=[];if(CQ_Analytics.SegmentMgr)for(var k=0,h=0;h<a.length;h++){var l=CQ.shared.HTTP.externalize(a[h].path+".html");if(a[h].segments&&0!=a[h].segments.length&&!0!==CQ_Analytics.SegmentMgr.resolveArray(a[h].segments))l=[a[h].title,a[h].thumbnail,l],f+=CQ.I18n.getMessage('\x3ca href\x3d"{2}" class\x3d"cq-teaser-segment-link"\x3e\x3cimg src\x3d"{1}" class\x3d"cq-teaser-decision-thumbnail cq-teaser-decision-nomatch"\x3e\x3c/a\x3eExperience: {0} - no match\x3cbr\x3e',
l);else{var n=CQ_Analytics.SegmentMgr.getMaxBoost(a[h].segments);l=[a[h].title,n,a[h].thumbnail,l];f=e==a[h].path?f+CQ.I18n.getMessage('\x3cb\x3e\x3ca href\x3d"{3}" class\x3d"cq-teaser-segment-link"\x3e\x3cimg src\x3d"{2}" class\x3d"cq-teaser-decision-thumbnail cq-teaser-decision-match"\x3e\x3c/a\x3eExperience: {0} - match ( boost \x3d {1} )\x3c/b\x3e\x3cbr\x3e',l):f+CQ.I18n.getMessage('\x3ca href\x3d"{3}" class\x3d"cq-teaser-segment-link"\x3e\x3cimg src\x3d"{2}" class\x3d"cq-teaser-decision-thumbnail cq-teaser-decision-match"\x3e\x3c/a\x3eExperience: {0} - match ( boost \x3d {1} )\x3cbr\x3e',
l);n==k?g.push(a[h]):n>k&&(g=[],g.push(a[h]),k=n)}}f+=CQ.I18n.getMessage("\x3cbr\x3eStrategy \x3cb\x3e{0}\x3c/b\x3e selected current teaser.\x3cbr\x3e",b);c.teaserToolTip=new d({html:f,title:CQ.I18n.getMessage("Selection decision"),width:450,autoHide:!1,closable:!0,height:300,floating:!0,autoHeight:!1,bodyStyle:"overflow-y: scroll;"})}c=this.getXY();p.teaserToolTip.setPosition(c[0]-460,c[1]-100);p.teaserToolTip.show()}));this.teaserInfoButton.anchorTo(c.frameBottom.getEl(),"tr",[-26,-15]);this.teaserInfoButton.show()}),
p.on(CQ.wcm.EditRollover.EVENT_HIDE_HIGHTLIGHT,))}}else d&&(p=CQ.WCM.getEditable(f))&&p.teaserToolTip&&(p.teaserToolTip.hide(),p.teaserToolTip.remove(),p.teaserToolTip=null),CQ_Analytics.Utils.clearElement(c),m=null};k.call();CQ_Analytics.SegmentMgr&&CQ_Analytics.SegmentMgr.addListener("update",k)}};CQ_Analytics.CCM.areStoresInitialized?g.call(this):CQ_Analytics.CCM.addListener("storesinitialize",g)}}
window.CQ_trackLandingPagesStats=!0;
function initializeLandingPageLoader(a,b,c,d,e){d=CQ.Ext&&("true"==d||!0===d);if(window.CQ_Analytics){var f=function(){var f=null,h=function(){var g=[];if(window.CQ_Analytics&&window.CQ_Analytics.SegmentMgr)for(var h=0,l=0;l<a.length;l++)if(!a[l].segments||0==a[l].segments.length||!0===CQ_Analytics.SegmentMgr.resolveArray(a[l].segments)){var t=CQ_Analytics.SegmentMgr.getMaxBoost(a[l].segments);t==h?g.push(a[l]):t>h&&(g=[],g.push(a[l]),h=t)}if(0<g.length){if(h=g[0],window.CQ_Analytics&&window.CQ_Analytics.StrategyMgr&&
(g=CQ_Analytics.StrategyMgr.choose(b,g),null!=g&&(h=g)),!f||f.path!=h.path){var q=f;f=h;g=CQ.shared.HTTP.get(h.path+".html").responseText;g=function(a,b){if(a&&-1!=a.indexOf('id\x3d"'+b+'"')){b=a.indexOf('id\x3d"'+b+'"');b=a.substring(0,b).lastIndexOf("\x3cdiv");a=a.substring(b);b=a.split(/<div/ig);for(var c=0,d=0;d<b.length;d++){c++;for(var e=b[d].split(/<\/div/ig),f=1;f<e.length;f++)if(c--,1==c)return c=b[d].lastIndexOf("\x3c/div")+6,c=a.indexOf(b[d])+c,a=a.substring(0,c),a=a.substring(a.indexOf("\x3e")+
1,a.lastIndexOf("\x3c/div"))}}return""}(g,c);var n=$CQ("#"+c)[0],p=function(a,b){if(d){b=CQ.WCM.getEditables();for(var c in b){var e=b[c];a&&-1==e.path.indexOf(a)||(e.hide(),e.remove())}}},v=document.createElement("div");v.innerHTML=g;q?($CQ("object",n).parent().fadeOut("slow"),$CQ("img",n).fadeOut("slow"),$CQ(n).slideUp("slow",function(){p(q.path,!1);$CQ(n).children().remove();n.insertBefore(v,n.firstChild);$CQ(n).slideDown("slow",function(){d&&CQ.DOM.executeScripts(CQ.Ext.get(v))})})):(n.insertBefore(v,
n.firstChild),$CQ(n).slideDown("slow",function(){d&&CQ.DOM.executeScripts(CQ.Ext.get(v))}));try{window.CQ_trackLandingPagesStats&&e&&(CQ_Analytics.loadedLandingPagesStack||(CQ_Analytics.loadedLandingPagesStack=[],$CQ(window).unload(function(){try{var a=CQ_Analytics.loadedLandingPagesStack;if(a){delete CQ_Analytics.loadedLandingPagesStack;for(var b=e,c=0;c<a.length;c++)b=CQ.shared.HTTP.addParameter(b,"path",a[c]);CQ.shared.HTTP.get(b,function(){})}}catch(y){}})),CQ_Analytics.loadedLandingPagesStack.push(h.path))}catch(x){}}}else CQ_Analytics.Utils.clearElement(c),
f=null};h.call();window.CQ_Analytics&&window.CQ_Analytics.SegmentMgr&&CQ_Analytics.SegmentMgr.addListener("update",h)};window.CQ_Analytics&&window.CQ_Analytics.ClickstreamcloudMgr&&(CQ_Analytics.ClickstreamcloudMgr.areStoresLoaded?f.call(this):CQ_Analytics.ClickstreamcloudMgr.addListener("storesloaded",f))}}CQ_Analytics.PersistedJSONStore=function(){};CQ_Analytics.PersistedJSONStore.prototype=new CQ_Analytics.PersistedSessionStore;CQ_Analytics.PersistedJSONStore.prototype.STOREKEY="";
CQ_Analytics.PersistedJSONStore.prototype.STORENAME="";CQ_Analytics.PersistedJSONStore.prototype.init=function(){var a=(new CQ_Analytics.SessionPersistence({container:"ClientContext"})).get(this.getStoreKey());if(a&&""!=a)this.data=this.parse(a);else{this.data={};for(var b in this.initProperty)this.data[b]=this.initProperty[b]}this.persist();this.initialized=!0;this.fireEvent("initialize",this);this.fireEvent("update")};
CQ_Analytics.PersistedJSONStore.prototype.clear=function(){(new CQ_Analytics.SessionPersistence({container:"ClientContext"})).remove(this.getStoreKey());this.data=null;this.initProperty={}};CQ_Analytics.PersistedJSONStore.prototype.initJSON=function(a,b){b||(this.initProperty={});var c=function(a,b,f){for(var d in f)"object"==typeof f[d]?c(a,b?b+"/"+d:d,f[d]):a[b?b+"/"+d:d]=f[d]};c(this.initProperty,null,a)};
CQ_Analytics.PersistedJSONStore.prototype.getJSON=function(){var a=this.getData(),b={},c;for(c in a)for(var d=c.split("/"),e=b,f=0;f<d.length;f++){var g=d[f];f==d.length-1?e[g]=a[c]:(e[g]=e[g]||{},e=e[g])}return b};CQ_Analytics.PersistedJSONStore.getInstance=function(a,b){var c=new CQ_Analytics.PersistedJSONStore;c.STOREKEY=a.toUpperCase();c.STORENAME=a;c.initJSON(b);return c};
CQ_Analytics.PersistedJSONStore.registerNewInstance=function(a,b){a=CQ_Analytics.PersistedJSONStore.getInstance(a,b);a.init();CQ_Analytics.CCM.register(a);return a};CQ_Analytics.JSONStore=function(){};CQ_Analytics.JSONStore.prototype=new CQ_Analytics.SessionStore;CQ_Analytics.JSONStore.prototype.STOREKEY="";CQ_Analytics.JSONStore.prototype.STORENAME="";
CQ_Analytics.JSONStore.prototype.init=function(){this.data={};for(var a in this.initProperty)this.data[a]=this.initProperty[a];this.initialized=!0;this.fireEvent("initialize",this);this.fireEvent("update")};CQ_Analytics.JSONStore.prototype.clear=
CQ_Analytics.JSONStore.prototype.initJSON=function(a,b){b||(this.initProperty={});var c=function(a,b,f){for(var d in f)"object"==typeof f[d]?c(a,b?b+"/"+d:d,f[d]):a[b?b+"/"+d:d]=f[d]};c(this.initProperty,null,a)};CQ_Analytics.JSONStore.prototype.getJSON=function(){var a=this.getData(),b={},c;for(c in a)for(var d=c.split("/"),e=b,f=0;f<d.length;f++){var g=d[f];f==d.length-1?e[g]=a[c]:(e[g]=e[g]||{},e=e[g])}return b};
CQ_Analytics.JSONStore.getInstance=CQ_Analytics.JSONStore.registerNewInstance=function(a,b){a=CQ_Analytics.JSONStore.getInstance(a,b);a.init();CQ_Analytics.CCM.register(a);return a};CQ_Analytics.PersistedJSONPStore=function(){};CQ_Analytics.PersistedJSONPStore.prototype=new CQ_Analytics.PersistedJSONStore;
CQ_Analytics.PersistedJSONPStore.prototype.setServiceURL=function(a){this.serviceURL=a};CQ_Analytics.PersistedJSONPStore.prototype.getServiceURL=function(){return this.serviceURL};
CQ_Analytics.PersistedJSONPStore.prototype.load=function(a,b,c){var d=this.getName();CQ_Analytics.PersistedJSONPStore.JSONPCallbacks[this.getName()]||(CQ_Analytics.PersistedJSONPStore.JSONPCallbacks[d]=function(a){var e=CQ_Analytics.CCM.getRegisteredStore(d);e&&(e.initJSON(a),b&&e.initJSON(b,!0));c&&c.call(e)});a&&this.setServiceURL(a);a=this.serviceURL;a=a.replace("${callback}","CQ_Analytics.PersistedJSONPStore.JSONPCallbacks."+d);$CQ.getScript(a)};
CQ_Analytics.PersistedJSONPStore.JSONPCallbacks={};CQ_Analytics.PersistedJSONPStore.getInstance=function(a,b,c,d,e){if(a&&b)try{var f=new CQ_Analytics.PersistedJSONPStore;f.STOREKEY=a.toUpperCase();f.STORENAME=a;b&&f.setServiceURL(b);d||f.load(b,c,e);return f}catch(g){console.log("Cannot create the JSONP store",a,b,g)}return null};
CQ_Analytics.PersistedJSONPStore.registerNewInstance=function(a,b,c,d){if(!b)return null;a||((a=CQ.shared.HTTP.getSchemeAndAuthority(b))?-1!=a.indexOf(".")?(a=a.substring(0,a.lastIndexOf(".")),a=a.substring(a.lastIndexOf(".")+1)):a=a.substring(a.lastIndexOf("/")+1):a=b);b=CQ_Analytics.PersistedJSONPStore.getInstance(a,b,c,!1,function(){this.init();this.reset();d&&d.call(this)});return null!=b?(CQ_Analytics.CCM.register(b),b):null};CQ_Analytics.JSONPStore=
CQ_Analytics.JSONPStore.prototype=new CQ_Analytics.JSONStore;CQ_Analytics.JSONPStore.prototype.setServiceURL=CQ_Analytics.JSONPStore.prototype.getServiceURL=function(){return this.serviceURL};
CQ_Analytics.JSONPStore.prototype.load=function(a,b,c){var d=this.getName();CQ_Analytics.JSONPStore.JSONPCallbacks[this.getName()]||(CQ_Analytics.JSONPStore.JSONPCallbacks[d]=function(a){var e=CQ_Analytics.CCM.getRegisteredStore(d);e&&(e.initJSON(a),b&&e.initJSON(b,!0));c&&c.call(e)});a&&this.setServiceURL(a);a=this.serviceURL;a=a.replace("${callback}","CQ_Analytics.JSONPStore.JSONPCallbacks."+d);$CQ.getScript(a)};CQ_Analytics.JSONPStore.JSONPCallbacks={};
CQ_Analytics.JSONPStore.getInstance=function(a,b,c,d,e){if(a)try{var f=new CQ_Analytics.JSONPStore;f.STOREKEY=a.toUpperCase();f.STORENAME=a;b&&(f.setServiceURL(b),d||f.load(b,c,e));return f}catch(g){console.log("Cannot create the JSONP store",a,b,g)}return null};
CQ_Analytics.JSONPStore.registerNewInstance=function(a,b,c,d){!a&&b&&((a=CQ.shared.HTTP.getSchemeAndAuthority(b))?-1!=a.indexOf(".")?(a=a.substring(0,a.lastIndexOf(".")),a=a.substring(a.lastIndexOf(".")+1)):(a=a.substring(a.lastIndexOf("/")+1),a=a.replace(/:/ig,"_")):a=b);b=CQ_Analytics.JSONPStore.getInstance(a,b,c,!1,function(){this.init();this.reset();d&&d.call(this)});return null!=b?(CQ_Analytics.CCM.register(b),b):null};
CQ_Analytics.ClientContext||(CQ_Analytics.ClientContext=new function(){return{get:function(a,b){if(a){0!=a.indexOf("/")&&(a="/"+a);var c=a.split("/")[1];a=a.substring(a.indexOf("/"+c)+c.length+2,a.length);if(c=CQ_Analytics.CCM.getRegisteredStore(c))return a&&(c=c.getProperty(a))&&b&&(c=CQ_Analytics.Variables.replaceVariables(c)),c}return null},set:function(a,b){if(a){0!=a.indexOf("/")&&(a="/"+a);var c=a.split("/")[1];a=a.substring(a.indexOf("/"+c)+c.length+2,a.length);(c=CQ_Analytics.CCM.getRegisteredStore(c))&&
a&&c.setProperty(a,b)}},clear:function(){var a=CQ_Analytics.CCM.getStores();if(a)for(var b in a)a[b].clear&&a[b].clear()},reset:function(){var a=CQ_Analytics.CCM.getStores();if(a)for(var b in a)a[b].reset&&a[b].reset()},persist:},window.ClientContext=CQ_Analytics.ClientContext,window.ContextCloud=CQ_Analytics.ClientContext);
CQ_Analytics&&!CQ_Analytics.CampaignSeedMgr&&(CQ_Analytics.CampaignSeedMgr=CQ_Analytics.JSONStore.registerNewInstance("campaignseed",{}),CQ_Analytics.CampaignSeedMgr.SERVICE_PATH="/_jcr_content.campaign.seeddata.json/{seed}",CQ_Analytics.CCM.addListener("configloaded",function(){CQ_Analytics.ProfileDataMgr.addListener("update",function(){var a=CQ_Analytics.ProfileDataMgr.getProperty("authorizableId");a!=this.lastUid&&(this.lastUid=a,this.clear(),this.fireEvent("update"))},CQ_Analytics.CampaignSeedMgr)},
CQ_Analytics.CampaignSeedMgr));
CQ_Analytics&&!CQ_Analytics.CampaignMetadataMgr&&(CQ_Analytics.CampaignMetadataMgr=CQ_Analytics.JSONStore.registerNewInstance("campaignmetadata",{}),CQ_Analytics.CampaignMetadataMgr.SERVICE_PATH="/_jcr_content.campaign.metadata.json",CQ_Analytics.CampaignMetadataMgr.setNLIntegrationURL=function(a){this.baseURL=CQ_Analytics.Utils.externalize(a);this.serviceURL=a+this.SERVICE_PATH;$CQ.post(this.serviceURL,{},function(a){CQ_Analytics.CampaignMetadataMgr.initJSON(a);CQ_Analytics.CampaignMetadataMgr.init();CQ_Analytics.CampaignMetadataMgr._isDataAvailable=
!0;if(CQ&&CQ.WCM){a=CQ.WCM.getEditables();for(var b in a)if(a.hasOwnProperty(b)){var d=a[b].element;CQ.personalization.variables.Variables.injectSpans(d,CQ.personalization.variables.Variables.SCANNED_TAGS,"cq-variable-code");CQ.personalization.variables.Variables.updateVariables(d,CQ_Analytics.CampaignSeedMgr.getData())}}CQ_Analytics.CampaignMetadataMgr._onDataAvailable&&(b=CQ_Analytics.CampaignMetadataMgr._onDataAvailable.fct,b(CQ_Analytics.CampaignMetadataMgr._onDataAvailable.data),CQ_Analytics.CampaignMetadataMgr._onDataAvailable=
null)})},CQ_Analytics.CampaignMetadataMgr._isDataAvailable=!1,CQ_Analytics.CampaignMetadataMgr._onDataAvailable=null,CQ_Analytics.CampaignMetadataMgr.whenDataAvailable=function(a,b){CQ_Analytics.CampaignMetadataMgr._isDataAvailable?a(b):CQ_Analytics.CampaignMetadataMgr._onDataAvailable={fct:a,data:b}},CQ_Analytics.CampaignMetadataMgr.rawJSON=void 0,CQ_Analytics.CampaignMetadataMgr.getRawJSON=CQ_Analytics.CampaignMetadataMgr.initJSON=function(a,b){function c(a,b,d){for(var e in d)if(d.hasOwnProperty(e)){var f=
d[e],g=b+"/"+e;$CQ.isPlainObject(f)?c(a,g,f):a[g]=f}}function d(a,b,g){for(var e in g)if(g.hasOwnProperty(e)){var f=g[e];if(f.hasOwnProperty("type")&&f.type)for(var m in f)if(f.hasOwnProperty(m)){var l=e+"/"+m;l=b?b+"/"+l:l;$CQ.isPlainObject(f[m])?c(a,l,f[m]):a[l]=f[m]}f.hasOwnProperty("content")&&d(a,b?b+"/"+e:e,f.content)}}b||(this.initProperty={});d(this.initProperty,null,a);this.rawJSON=a});
CQ_Analytics.ViewedProducts||(CQ_Analytics.ViewedProducts=CQ_Analytics.ViewedProducts.prototype=new CQ_Analytics.PersistedSessionStore,CQ_Analytics.ViewedProducts.prototype.STOREKEY="VIEWEDPRODUCTS",CQ_Analytics.ViewedProducts.prototype.STORENAME="viewedproducts",CQ_Analytics.ViewedProducts.prototype.record=function(a,b,c,d){this.data||this.init();for(var e=0;e<this.data.length;e++)if(this.data[e].path==a){this.data.splice(e,1);break}this.data.length==
this.MAX_COUNT&&this.data.shift();this.data.push({path:a,title:b,image:c,price:d});this.persist();this.fireEvent("update")},CQ_Analytics.ViewedProducts.prototype.mostRecent=function(){this.data||this.init();return 0<this.data.length?this.data[this.data.length-1]:null},CQ_Analytics.ViewedProducts.prototype.mostRecentNotInCart=function(){this.data||this.init();if(!CQ_Analytics.CartMgr)return this.mostRecent();for(var a=this.data.length-1;0<=a;a--){var b=this.data[a];if(!CQ_Analytics.CartHelper.containsProduct(CQ_Analytics.CartMgr.getData(),
b.path,1))return b}return null},CQ_Analytics.ViewedProducts.prototype.recent=function(a,b){var c=[];this.data||this.init();CQ_Analytics.CartMgr||(b=!1);for(var d=this.data.length-1;0<=d&&0<a;d--){var e=this.data[d];b&&CQ_Analytics.CartHelper.containsProduct(CQ_Analytics.CartMgr.getData(),e.path,1)||(c.push(e),a--)}return c},CQ_Analytics.ViewedProducts.prototype.getData=function(a){this.data||this.init();return this.data},CQ_Analytics.ViewedProducts.prototype.init=function(){var a=(new CQ_Analytics.SessionPersistence({container:"ClientContext"})).get(this.getStoreKey());
a=null===a?"":new String(a);a=a.split(";");this.data=[];for(var b=0;b<a.length;b++){var c=a[b].split(",");4<=c.length?this.data.push({path:c[0],title:c[1],image:c[2],price:c[3]}):3<=c.length&&this.data.push({path:c[0],title:c[1],image:c[2],price:void 0})}this.initialized=!0;this.fireEvent("initialize",this);this.fireEvent("update")},CQ_Analytics.ViewedProducts.prototype.persist=function(){if(!1!==this.fireEvent("beforepersist")){for(var a=new CQ_Analytics.SessionPersistence({container:"ClientContext"}),
b=[],c=0;c<this.data.length;c++){var d=this.data[c],e=d.path+","+d.title+","+d.image;d.price&&(e+=","+d.price);b.push(e)}a.set(this.getStoreKey(),b.join(";"));this.fireEvent("persist")}},CQ_Analytics.ViewedProducts.prototype.reset=function(){this.clear();this.fireEvent("update")},CQ_Analytics.ViewedProducts.prototype.clear=function(){(new CQ_Analytics.SessionPersistence({container:"ClientContext"})).remove(this.getStoreKey());this.data=[]},CQ_Analytics.ViewedProducts=new CQ_Analytics.ViewedProducts,
CQ_Analytics.CCM.register(CQ_Analytics.ViewedProducts));
CQ_Analytics.TagCloudMgr||(CQ_Analytics.TagCloudMgr=function(){this.data=null;this.addedTags={};this.initialTags=this.frequencies=null;this.initialAddedTags={};this.copyObject=,CQ_Analytics.TagCloudMgr.prototype=new CQ_Analytics.PersistedSessionStore,CQ_Analytics.TagCloudMgr.prototype.STOREKEY="TAGCLOUD",CQ_Analytics.TagCloudMgr.prototype.STORENAME="tagcloud",CQ_Analytics.TagCloudMgr.prototype.parseTagList=function(a){var b={};a=a.split(",");for(var c in a)if(a.hasOwnProperty(c)){var d=
a[c].split("\x3d");2==d.length&&(b[d[0]]=parseInt(d[1]))}return b},CQ_Analytics.TagCloudMgr.prototype.parseString=CQ_Analytics.TagCloudMgr.prototype.add=function(a){this.addedTags[a]=!0;this.data[a]=(this.data[a]||0)+1},CQ_Analytics.TagCloudMgr.prototype.each=CQ_Analytics.TagCloudMgr.prototype.calculateFrequencies=function(){var a={},b=[];this.each(function(c,
d){a[d]||b.push(d);a[d]=!0});b.sort(;return b},CQ_Analytics.TagCloudMgr.prototype.calculateNtile=function(a,b){null===this.frequencies&&(this.frequencies=this.calculateFrequencies());for(var c=0;;){if(c>=this.frequencies.length-1||this.frequencies[c]>=a)return Math.ceil((c+1)/this.frequencies.length*b);c++}},CQ_Analytics.TagCloudMgr.prototype.getTags=function(){return this.data},CQ_Analytics.TagCloudMgr.prototype.getData=CQ_Analytics.TagCloudMgr.prototype.getTag=
function(a){return 0<this.data[a]?this.data[a]:0},CQ_Analytics.TagCloudMgr.prototype.init=function(a){var b=(new CQ_Analytics.SessionPersistence({container:"ClientContext"})).get(this.getStoreKey());b=null===b?"":new String(b);this.data=this.parseTagList(b);if(a)for(var c in a)a.hasOwnProperty(c)&&this.add(a[c]);this.initialTags=this.copyObject(this.data);this.initialAddedTags=this.copyObject(this.addedTags);this.persist();this.initialized=!0;this.fireEvent("initialize",this);this.fireEvent("update")},
CQ_Analytics.TagCloudMgr.prototype.setProperty=function(a,b){null==this.data&&this.init();0<b?(this.addedTags[a]=!0,this.data[a]=0<b?b:0):(delete this.addedTags[a],delete this.data[a]);this.persist();this.fireEvent("update")},CQ_Analytics.TagCloudMgr.prototype.reset=CQ_Analytics.TagCloudMgr.prototype.getProperty=function(a){null==this.data&&this.init();return 0<this.data[a]?this.data[a]:0},CQ_Analytics.TagCloudMgr.prototype.removeProperty=function(a){null==
this.data&&this.init();this.setProperty(a,0)},CQ_Analytics.TagCloudMgr.prototype.clear=function(){(new CQ_Analytics.SessionPersistence({container:"ClientContext"})).remove(this.getStoreKey());this.addedTags={};this.data={}},CQ_Analytics.TagCloudMgr.prototype.getLink=function(a){return""},CQ_Analytics.TagCloudMgr.prototype.getLabel=function(a){a&&(a=a.split(":"),a=a[a.length-1].split("/"),a=a[a.length-1]);return a},CQ_Analytics.TagCloudMgr=new CQ_Analytics.TagCloudMgr,CQ_Analytics.CCM.register(CQ_Analytics.TagCloudMgr));
CQ_Analytics.SurferInfoMgr||(CQ_Analytics.SurferInfoMgr=function(){},CQ_Analytics.SurferInfoMgr.prototype=new CQ_Analytics.SessionStore,CQ_Analytics.SurferInfoMgr.prototype.STOREKEY="SURFERINFO",CQ_Analytics.SurferInfoMgr.prototype.STORENAME="surferinfo",CQ_Analytics.SurferInfoMgr.prototype.init=function(){this.data={};for(var a in this.initProperty)this.data[a]=this.initProperty[a];this.initialized=!0;this.fireEvent("initialize",this);this.fireEvent("update")},CQ_Analytics.SurferInfoMgr.prototype.clear=
function(){this.data=null;this.initProperty={}},CQ_Analytics.SurferInfoMgr.prototype.getLabel=function(a){return a},CQ_Analytics.SurferInfoMgr.prototype.getLink=function(a){return""},CQ_Analytics.SurferInfoMgr=new CQ_Analytics.SurferInfoMgr,CQ_Analytics.CCM.addListener("configloaded",function(){var a=CQ_Analytics.BrowserInfoInstance;this.addInitProperty("browserFamily",a.getBrowserFamily());this.addInitProperty("browserVersion",a.getBrowserVersion());this.addInitProperty("browser","${/surferinfo/browserFamily} ${/surferinfo/browserVersion}");
this.addInitProperty("OS",a.getOSName());this.addInitProperty("resolution",a.getScreenResolution());this.addInitProperty("device",a.getDeviceType());this.addInitProperty("isMobile",a.isMobile());this.addInitProperty("userAgent",a.getUserAgent());var b=new Date;this.addInitProperty("day",b.getDate());this.addInitProperty("month",b.getMonth()+1);this.addInitProperty("year",b.getFullYear());this.addInitProperty("hours",b.getHours());this.addInitProperty("minutes",b.getMinutes());b="${/surferinfo/browserFamily}";
a.isMobile()&&(b="${/surferinfo/device}");this.addInitProperty("image",b);b=CQ_Analytics.ClientContextMgr.getClientContextURL("/contextstores/surferinfo/resources/${/surferinfo/image}.png");this.addInitProperty("thumbnail",b);window.CQ_Analytics&&window.CQ_Analytics.MousePositionMgr&&CQ_Analytics.MousePositionMgr.addListener("update",this);
this.addListener("update",function(){var b=this.getProperty("device"),d="${/surferinfo/browserFamily}";a.isMobile(b)&&(d="${/surferinfo/device}");this.getProperty("image")!=d&&this.setProperty("image",d)},this);this.init();CQ_Analytics.CCM.register(this)},CQ_Analytics.SurferInfoMgr));
CQ_Analytics.SocialGraphMgr||(CQ_Analytics.SocialGraphMgr=CQ_Analytics.JSONPStore.registerNewInstance("socialgraph"),CQ_Analytics.CCM.addListener("configloaded",function(){CQ_Analytics.ProfileDataMgr.addListener("update",function(){CQ_Analytics.ProfileDataMgr.getProperty("authorizableId")!=this.lastUid&&this.fireEvent("update")},CQ_Analytics.SocialGraphMgr)},CQ_Analytics.SocialGraphMgr));
window.CQ_Analytics&&window.CQ_Analytics.SegmentMgr&&!window.CQ_Analytics.SegmentMgr.isResolvedRegistered&&(CQ_Analytics.SegmentMgr.isResolvedRegistered=!0,CQ_Analytics.CCM.addListener("configloaded",CQ_Analytics.SegmentMgr));
CQ_Analytics.RelatedProducts||(CQ_Analytics.RelatedProducts=function(){this.data=null},CQ_Analytics.RelatedProducts.prototype=new CQ_Analytics.SessionStore,CQ_Analytics.RelatedProducts.prototype.STOREKEY="RELATEDPRODUCTS",CQ_Analytics.RelatedProducts.prototype.STORENAME="relatedproducts",CQ_Analytics.RelatedProducts.prototype.products=function(a,b){var c=[];this.data||this.init();for(var d=0;d<this.data.length&&0<a;d++){var e=this.data[d];e.relationshipType===b&&(c.push(e),a--)}return c},CQ_Analytics.RelatedProducts.prototype.getData=
function(a){this.data||this.init();return this.data},CQ_Analytics.RelatedProducts.prototype.init=function(){this.data?(this.fireEvent("initialize",this),this.fireEvent("update")):this.data={}},CQ_Analytics.RelatedProducts=new CQ_Analytics.RelatedProducts,CQ_Analytics.CCM.register(CQ_Analytics.RelatedProducts));
CQ_Analytics.ProfileDataMgr||(CQ_Analytics.ProfileDataMgr=CQ_Analytics.ProfileDataMgr.prototype=new CQ_Analytics.PersistedSessionStore,CQ_Analytics.ProfileDataMgr.prototype.STOREKEY="PROFILEDATA",CQ_Analytics.ProfileDataMgr.prototype.STORENAME="profile",CQ_Analytics.ProfileDataMgr.prototype.LOADER_PATH=CQ_Analytics.Utils.externalize("/libs/cq/personalization/components/profileloader/content/load.js",!0),CQ_Analytics.ProfileDataMgr.prototype.PROFILE_LOADER=
CQ_Analytics.Utils.externalize("/libs/cq/personalization/components/profileloader/content/load.json",!0),CQ_Analytics.ProfileDataMgr.prototype.init=function(){this.persistence=new CQ_Analytics.SessionPersistence({container:"ClientContext"});var a=this.persistence.get(this.getStoreKey());if(a&&""!=a)this.data=this.parse(a);else{this.data={};for(var b in this.initProperty)this.data[b]=this.initProperty[b]}this.persist();this.initialized=!0;this.fireEvent("initialize",this);this.fireEvent("update")},
CQ_Analytics.ProfileDataMgr.prototype.checkAuthorizableId=function(){this.data||this.init();this.data.authorizableId?CQ_Analytics.CCM.setVisitorId(this.data.authorizableId):CQ_Analytics.CCM.setVisitorId("")},CQ_Analytics.ProfileDataMgr.prototype.getLabel=function(a){return a},CQ_Analytics.ProfileDataMgr.prototype.getLink=function(a){return""},CQ_Analytics.ProfileDataMgr.prototype.clear=function(){this.persistence&&this.persistence.remove(this.getStoreKey());this.data=null;this.initProperty={}},CQ_Analytics.ProfileDataMgr.prototype.getLoaderURL=
CQ_Analytics.ProfileDataMgr.prototype.loadProfile=function(a){var b=this.getLoaderURL();b=CQ_Analytics.Utils.addParameter(b,"authorizableId",a);try{var c=CQ.shared.HTTP.eval(b);if(c){this.data={};for(var d in c)this.data[d]=c[d];this.persist();this.fireEvent("initialize",this);this.fireEvent("update");CQ_Analytics.ClickstreamcloudEditor&&CQ_Analytics.ClickstreamcloudEditor.reload();return!0}}catch(e){console&&
console.log&&console.log("Error during profile loading",e)}return!1},CQ_Analytics.ProfileDataMgr=new CQ_Analytics.ProfileDataMgr,CQ_Analytics.CCM.addListener("configloaded",function(){this.checkAuthorizableId();this.addListener("update",function(a,b){if("birthday"==b||!b){a=this.getProperty("birthday");b=this.getProperty("age");var c="";if(a)try{var d=function(a){var b=new Date(a.getFullYear(),0,0);b=new Date(b.getTime());b.setUTCHours(a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds());
return(b.getTime()-a.getTime())/864E5*-1},e=new Date(Date.parse(a));if(isNaN(e.getTime()))c="";else{var f=new Date;if(d(e)==d(f)&&e.getMonth()==f.getMonth())c=CQ.shared.HTTP.externalize(CQ_Analytics.ClientContextMgr.getClientContextURL("/contextstores/profiledata/resources/birthday_cake.png"));else{var g=f.getFullYear()-e.getFullYear();c=d(e)>d(f)?g:Math.max(0,g-1)}}}catch(h){c=""}b!=c&&this.setProperty("age",c)}});CQ_Analytics.CCM.register(this)},CQ_Analytics.ProfileDataMgr));
CQ_Analytics.OrderHistoryMgr||(CQ_Analytics.OrderHistoryMgr=new CQ_Analytics.SessionStore,CQ_Analytics.OrderHistoryMgr.STOREKEY="ORDERHISTORY",CQ_Analytics.OrderHistoryMgr.STORENAME="orderhistory",CQ_Analytics.OrderHistoryMgr.init=function(){this.data?(this.fireEvent("initialize",this),this.fireEvent("update")):this.data={}},CQ_Analytics.CCM.addListener("configloaded",CQ_Analytics.OrderHistoryMgr));
CQ_Analytics.GeolocationUtils||(CQ_Analytics.GeolocationUtils=new function(){var a,b,c=[],d=function(){b=!0;for(var a=0;a<c.length;a++)c[a]&&c[a].call(this,CQ_Analytics.GeolocationUtils.getStore())};return{init:function(b){a=b;try{var c=navigator.geolocation}catch(k){}var e=function(b){var c=CQ_Analytics.PersistedJSONStore.registerNewInstance(a,b);c.addListener("update",function(b,d){b=CQ_Analytics.ClientContext.get(a+"/latitude");var e=CQ_Analytics.ClientContext.get(a+"/longitude");b&&e?c.getProperty("generatedThumbnail",
!0)==CQ_Analytics.GeolocationUtils.THUMBNAILS.fallback&&c.setProperty("generatedThumbnail",c.getInitProperty("generatedThumbnail")):"generatedThumbnail"!=d?c.setProperty("generatedThumbnail",CQ_Analytics.GeolocationUtils.THUMBNAILS.fallback):c.getProperty(d,!0)!=CQ_Analytics.GeolocationUtils.THUMBNAILS.fallback&&c.setProperty(d,CQ_Analytics.GeolocationUtils.THUMBNAILS.fallback)});d()},h=function(b,c){var d=CQ_Analytics.StoreRegistry.getStore(a);if(d){var f=!0;if(b){f=parseInt(1E6*b.latitude)/1E6;
var g=parseInt(1E6*b.longitude)/1E6;f=!(isFinite(f)&&"number"===typeof f&&isFinite(g)&&"number"===typeof g)}f&&(b=CQ_Analytics.GeolocationUtils.DEFAULTS);f=b.generatedThumbnail=d.getInitProperty("generatedThumbnail");d.initJSON(b);c||(d.init(),d.setProperty("generatedThumbnail",f))}else e(b)};e();c?c.getCurrentPosition(function(a){var b={longitude:parseInt(1E6*a.coords.longitude)/1E6,latitude:parseInt(1E6*a.coords.latitude)/1E6};a.address&&(b.address=a.address);h(b,CQ_Analytics.CCM.areStoresInitialized)},
function(a){if(!CQ_Analytics.CCM.areStoresInitialized){var b="Error";CQ_Analytics.isUIAvailable&&(b=CQ.I18n.getMessage("Connection timeout",null,"timeout while connecting geolocation service"),1==a.code?b=CQ.I18n.getMessage("Permission denied",null,"permission denied message from goelocation service"):2==a.code&&(b=CQ.I18n.getMessage("Position unavailable",null,"geolocation service couldn't find location")));h({address:{country:b}},CQ_Analytics.CCM.areStoresInitialized)}}):h()},onReady:function(a){b?
a.call(this,CQ_Analytics.GeolocationUtils.getStore()):c.push(a)},getStore:},CQ_Analytics.GeolocationUtils.DEFAULTS={latitude:37.331375,longitude:-121.893992},CQ_Analytics.GeolocationUtils.THUMBNAILS={fallback:document.location.protocol+"//maps.googleapis.com/maps/api/staticmap?center\x3d37,-121\x26zoom\x3d0\x26size\x3d80x80\x26sensor\x3dfalse\x26client\x3dgme-adobesystemsincorporated\x26channel\x3dclientcontext\x26signature\x3dwqNolKQ144hypPUiTmIypxPc1s8\x3d"});
CQ_Analytics.CartMgr||(CQ_Analytics.CartMgr=new CQ_Analytics.SessionStore,CQ_Analytics.CartMgr.STOREKEY="CART",CQ_Analytics.CartMgr.STORENAME="cart",CQ_Analytics.CartMgr.init=function(){if(this.data){var a=(new CQ_Analytics.SessionPersistence({container:"ClientContext"})).get(this.STOREKEY);if(a){a=a.split(";");if(a[0]){var b=a[0].split("\x3d");2==b.length&&(this.referenceTotalPrice=b[0],this.simulatedTotalPrice=b[1],this.updateSimulatedPrice())}if(a[1])for(this.simulatedPromotions=[],a=a[1].split(","),
b=0;b<a.length;b++){var c=a[b].split("\x3d");2==c.length&&this.simulatedPromotions.push({path:c[0],title:c[1]})}}this.initialized=!0;this.fireEvent("initialize",this);this.fireEvent("update")}else this.data={}},CQ_Analytics.CartMgr.persist=function(){if(!1!==this.fireEvent("beforepersist")){var a=new CQ_Analytics.SessionPersistence({container:"ClientContext"}),b="";this.referenceTotalPrice&&this.simulatedTotalPrice&&(b=this.referenceTotalPrice+"\x3d"+this.simulatedTotalPrice);b+=";";if(this.simulatedPromotions)for(var c=
0;c<this.simulatedPromotions.length;c++)0<c&&(b+=","),b+=this.simulatedPromotions[c].path+"\x3d"+this.simulatedPromotions[c].title;a.set(this.STOREKEY,b);this.fireEvent("persist")}},CQ_Analytics.CartMgr.updateSimulatedPrice=function(){this.simulatedTotalPrice&&this.referenceTotalPrice==this.data.totalPriceFloat?(this.data.totalPriceFloat=this.simulatedTotalPrice,this.data.totalPrice=this.data.totalPrice.replace(/[0-9]+\.[0-9]+/,parseFloat(this.simulatedTotalPrice).toFixed(2))):(this.simulatedTotalPrice=
null,this.persist())},CQ_Analytics.CartMgr.registerSimulatedPrice=function(a){this.simulatedTotalPrice?(this.simulatedTotalPrice=a,this.data.totalPrice=this.data.totalPrice.replace(/[0-9]+\.[0-9]+/,parseFloat(this.simulatedTotalPrice).toFixed(2))):(this.referenceTotalPrice=this.data.totalPriceFloat,this.simulatedTotalPrice=a);this.persist()},CQ_Analytics.CartMgr.addSimulatedPromotion=function(a,b){this.simulatedPromotions=this.simulatedPromotions||[];for(var c=!1,d=0;d<this.simulatedPromotions.length;d++)if(this.simulatedPromotions[d].path==
a){c=!0;break}c||(this.simulatedPromotions.push({path:a,title:b}),this.resolvePromotions()&&this.update())},CQ_Analytics.CartMgr.removeSimulatedPromotion=function(a){for(var b=-1,c=0;this.simulatedPromotions&&c<this.simulatedPromotions.length;c++)if(this.simulatedPromotions[c].path==a){b=c;break}0<=b&&(this.simulatedPromotions.splice(b,1),this.resolvePromotions()&&this.update())},CQ_Analytics.CartMgr.getSimulatedPromotions=function(){return this.simulatedPromotions},CQ_Analytics.CartMgr.getProperty=
function(a,b){this.data||this.init();var c=this.data;try{var d=a.split(".");for(a=0;a<d.length-1;a++){var e=d[a],f=e.indexOf("["),g=-1;0<f&&(g=parseInt(e.substring(f+1,e.length-1)),e=e.substring(0,f));c=c[e];0<=g&&(c=c[g])}var h=d[d.length-1];if(!b){var k=CQ.shared.XSS.getXSSPropertyName(h);if(c[k])return c[k]}return c[h]}catch(m){}},CQ_Analytics.CartMgr.validate=function(a,b){return"totalPriceFloat"==a?0<=parseFloat(b):0<a.indexOf(".quantity")?0<=parseInt(b):!0},CQ_Analytics.CartMgr.setProperty=
function(a,b){this.data||this.init();if(this.validate(a,b)){"totalPriceFloat"==a&&this.registerSimulatedPrice(b);for(var c=this.data,d=a.split("."),e=0;e<d.length-1;e++){var f=d[e],g=f.indexOf("["),h=-1;0<g&&(h=parseInt(f.substring(g+1,f.length-1)),f=f.substring(0,g));c[f]||(c[f]={});c=c[f];0<=h&&(c[h]||(c[h]={}),c=c[h])}d=d[d.length-1];c[d]=b;c=CQ.shared.XSS.getXSSPropertyName(d);this.data[c]=CQ.shared.XSS.getXSSValue(b)}this.fireEvent("change",a)},CQ_Analytics.CartMgr.addProductToCart=CQ_Analytics.CartMgr.addVoucher=function(a){this.data.vouchers=this.data.vouchers||[];for(var b=!1,c=0;c<this.data.vouchers.length;c++)if(this.data.vouchers[c].code==a){b=!0;break}b||(this.data.vouchers.push({code:a}),
this.fireEvent("change","vouchers"))},CQ_Analytics.CartMgr.removeVoucher=function(a){for(var b=-1,c=0;this.data.vouchers&&c<this.data.vouchers.length;c++)if(this.data.vouchers[c].path==a){b=c;break}0<=b&&(this.data.vouchers.splice(b,1),this.fireEvent("change","vouchers"))},CQ_Analytics.CartMgr.addListener("change",function(a,b){var c=this;b&&"totalPrice"!=b&&(this.resolvePromotions(),window.CQ_Analytics&&window.CQ_Analytics.CartMgr&&window.CQ_Analytics.CartMgr.refreshTimeout&&clearTimeout(CQ_Analytics.CartMgr.refreshTimeout),
CQ_Analytics.CartMgr.refreshTimeout=setTimeout(function(){c.update()},50))}),CQ_Analytics.CartMgr.update=function(){var a=this;window.ContextHub&&ContextHub.getStore("cart")||this.updateUrl&&$CQ.ajax({url:this.updateUrl,type:"POST",data:{cart:JSON.stringify(a.data)},externalize:!1,encodePath:!1,hook:!0,success:)},
CQ_Analytics.CartMgr.clear=function(){this.data.entries&&(this.data.entries=[]);this.data.vouchers&&(this.data.vouchers=[]);this.data.totalPrice="0";this.simulatedPromotions=this.simulatedTotalPrice=this.referenceTotalPrice=null},CQ_Analytics.CartMgr.reset=CQ_Analytics.CartMgr.resolvePromotions=function(){if(!this.promotionsMap)return!1;this.data.promotions||(this.data.promotions=[]);if(!CQ_Analytics.SegmentMgr.areSegmentsLoaded)return!1;
var a=CQ_Analytics.SegmentMgr.getResolved(),b=[],c,d;for(c=0;c<this.promotionsMap.length;c++){var e=this.promotionsMap[c],f=e.segments.split(",");var g=!1;for(d=0;d<f.length;d++)if(0<=$CQ.inArray(f[d],a)){g=!0;break}g&&b.push(e.path)}d=this.simulatedPromotions||[];for(c=0;c<d.length;c++)0>$CQ.inArray(d[c].path,b)&&b.push(d[c].path);e=!1;for(c=0;c<this.data.promotions.length;c++){a=this.data.promotions[c].path;g=!1;for(d=0;d<b.length;d++)if(b[d]==a){g=!0;break}g||(this.data.promotions.splice(c--,1),
e=!0)}for(c=0;c<b.length;c++){a=b[c];g=!1;for(d=0;d<this.data.promotions.length;d++)if(this.data.promotions[d].path==a){g=!0;break}g||(this.data.promotions.push({path:a}),e=!0)}return e},CQ_Analytics.CartMgr.resolveServerPromotions=function(){if(!this.serverPromotionsMap)return!1;this.data.promotions||(this.data.promotions=[]);if(!CQ_Analytics.SegmentMgr.areSegmentsLoaded)return!1;var a=CQ_Analytics.SegmentMgr.getResolved(),b=[],c,d;for(c=0;c<this.serverPromotionsMap.length;c++){var e=this.serverPromotionsMap[c],
f=e.segments.split(",");var g=!1;for(d=0;d<f.length;d++)if(0<=$CQ.inArray(f[d],a)){g=!0;break}g&&b.push(e.path)}e=!1;for(c=0;c<this.data.promotions.length;c++)if(this.data.promotions[c].resolve){a=this.data.promotions[c].path;g=!1;for(d=0;d<b.length;d++)if(b[d]==a){g=!0;break}g||(this.data.promotions.splice(c--,1),e=!0)}for(c=0;c<b.length;c++){a=b[c];g=!1;for(d=0;d<this.data.promotions.length;d++)if(this.data.promotions[d].path==a){g=!0;break}g||(this.data.promotions.push({path:a}),e=!0)}return e},
CQ_Analytics.CCM.addListener("configloaded",function(){CQ_Analytics.CCM.register(this);CQ_Analytics.SegmentMgr.addListener("update",function(){this.resolvePromotions()&&this.update()},CQ_Analytics.CartMgr);CQ_Analytics.SegmentMgr.addListener("update",CQ_Analytics.CartMgr)},CQ_Analytics.CartMgr));
CQ_Analytics.CartHelper||(CQ_Analytics.CartHelper=function(){return{containsProduct:function(a,b,c){for(var d=b?b.substring(0,b.lastIndexOf("#")):null,e=0;a.entries&&e<a.entries.length;e++){var f=a.entries[e],g=f.page.substring(0,f.page.lastIndexOf("#"));if((!b||g==d)&&(!c||f.quantity>=c))return!0}return!1},containsPromotion:function(a,b,c,d){function e(a){if(a){var b=a.lastIndexOf("#");-1<b&&(a=a.substring(0,b))}return a}function f(a,b,c){b=e(b);a=a.promotions;for(var d=0;a&&d<a.length;d++){var f=
a[d];if(e(f.path)==b&&c==f.status)return!0}return!1}return b&&c&&d?"contains"==d?f(a,b,c):"notcontains"==d?!f(a,b,c):!1:!1}}}());
CQ_Analytics.CampaignMgr||(CQ_Analytics.CampaignMgr=function(){},CQ_Analytics.CampaignMgr.prototype=new CQ_Analytics.PersistedSessionStore,CQ_Analytics.CampaignMgr.prototype.STOREKEY="CAMPAIGN",CQ_Analytics.CampaignMgr.prototype.STORENAME="campaign",CQ_Analytics.CampaignMgr.prototype.DEFAULT_EXPERIENCE="DEFAULT",CQ_Analytics.CampaignMgr.prototype.init=function(){var a;this.persistence=new CQ_Analytics.SessionPersistence({container:"ClientContext"});var b=this.persistence.get(this.getStoreKey());this.data||
(this.data={});if(b&&""!==b){if(this.data=this.parse(b),a=this.getInitProperty("campaigns"))this.data.campaigns=a}else for(a in this.initProperty)this.initProperty.hasOwnProperty(a)&&(this.data[a]=this.initProperty[a]);this.validate();this.persist();this.initialized=!0;this.fireEvent("initialize",this);this.fireEvent("update")},CQ_Analytics.CampaignMgr.prototype.validate=function(){this.data.campaigns&&(this.getCampaignBy("path",this.data.path)||this.getCampaignBy("id",this.data.id)||this.setCampaign(null),
this.data["recipe/path"]!==CQ_Analytics.CampaignMgr.DEFAULT_EXPERIENCE&&(this.getExperienceBy("path",this.data["recipe/path"])||this.getExperienceBy("id",this.data["recipe/id"])||this.setExperience(null)))},CQ_Analytics.CampaignMgr.prototype.getCampaignBy=function(a,b){if(!this.data||!this.data.campaigns)return null;var c,d=this.data.campaigns;for(c=0;c<d.length;c++){var e=d[c];if(e[a]===b)return e}return null},CQ_Analytics.CampaignMgr.prototype.getExperienceBy=function(a,b){if(!this.data||!this.data.campaigns)return null;
var c,d=this.data.campaigns;for(c=0;c<d.length;c++)for(var e=d[c],f=0;f<e.experiences.length;f++){var g=e.experiences[f];if(g[a]===b)return g}return null},CQ_Analytics.CampaignMgr.prototype.setCampaign=function(a){this.setProperties({name:a?a.title:"",path:a?a.path:"",id:a?a.id:"","recipe/name":a?CQ.I18n.getMessage("(default)"):"","recipe/path":a?this.DEFAULT_EXPERIENCE:"","recipe/id":a?this.DEFAULT_EXPERIENCE:""})},CQ_Analytics.CampaignMgr.prototype.setExperience=CQ_Analytics.CampaignMgr.prototype.setProperty=function(a,b){"id"===a||"path"===a?this.setCampaign(this.getCampaignBy(a,b)):"recipe/id"!==a&&"recipe/path"!==a||b===CQ_Analytics.CampaignMgr.DEFAULT_EXPERIENCE?CQ_Analytics.PersistedSessionStore.prototype.setProperty.call(this,a,b):this.setExperience(this.getExperienceBy(a.substring(7),b))},CQ_Analytics.CampaignMgr.prototype.isCampaignSelected=
CQ_Analytics.CampaignMgr.prototype.clear=function(){this.data=null;this.initProperty={}},CQ_Analytics.CampaignMgr.prototype.getLabel=function(a){return a},CQ_Analytics.CampaignMgr.prototype.getLink=function(a){return""},CQ_Analytics.CampaignMgr=new CQ_Analytics.CampaignMgr,CQ_Analytics.CCM.register(CQ_Analytics.CampaignMgr));
CQ_Analytics.ActivityStreamMgr||(CQ_Analytics.ActivityStreamMgr=CQ_Analytics.JSONStore.registerNewInstance("activitystream",{}),CQ_Analytics.ActivityStreamMgr.internalRenderer=function(a,b){a=a+".form.html"+CQ_Analytics.ClientContextMgr.getClientContextURL("/contextstores/activitystream.html");CQ.shared.HTTP.get(a+"?limit\x3d3",function(a,d,e){$CQ("#"+b).children().remove();d&&$CQ("#"+b).append(e.body)})},CQ_Analytics.ActivityStreamMgr.renderer=function(a,b){a.isReady||(a.isReady=!0,CQ_Analytics.ClientContextUtils.onStoreRegistered("profile",
function(a){a.addListener("update",function(a,c){a=this.getProperty("path");a!=CQ_Analytics.ActivityStreamMgr.currentProfilePath&&(CQ_Analytics.ActivityStreamMgr.currentProfilePath=a,CQ_Analytics.ActivityStreamMgr.internalRenderer(a,b))},a);a=a.getProperty("path");CQ_Analytics.ActivityStreamMgr.currentProfilePath=a;CQ_Analytics.ActivityStreamMgr.internalRenderer(a,b)}));return""});