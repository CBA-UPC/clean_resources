import{g as ze}from"./_commonjsHelpers-39b5b250.js";function Ze(Re,He){for(var De=0;De<He.length;De++){const de=He[De];if(typeof de!="string"&&!Array.isArray(de)){for(const ee in de)if(ee!=="default"&&!(ee in Re)){const Me=Object.getOwnPropertyDescriptor(de,ee);Me&&Object.defineProperty(Re,ee,Me.get?Me:{enumerable:!0,get:()=>de[ee]})}}}return Object.freeze(Object.defineProperty(Re,Symbol.toStringTag,{value:"Module"}))}var Ve={exports:{}};(function(Re,He){(function(De,de){Re.exports=de()})(self,function(){return function(){var De={2214:function(j,U,oe){var Pe;j=oe.nmd(j);var $=function(_e){var Z=1e7,Ee=9007199254740992,Le=le(Ee),Oe="0123456789abcdefghijklmnopqrstuvwxyz",Te=typeof BigInt=="function";function x(e,t,r,n){return e===void 0?x[0]:t===void 0||+t==10&&!r?M(e):P(e,t,r,n)}function c(e,t){this.value=e,this.sign=t,this.isSmall=!1}function g(e){this.value=e,this.sign=e<0,this.isSmall=!0}function T(e){this.value=e}function ue(e){return-Ee<e&&e<Ee}function le(e){return e<1e7?[e]:e<1e14?[e%1e7,Math.floor(e/1e7)]:[e%1e7,Math.floor(e/1e7)%1e7,Math.floor(e/1e14)]}function ye(e){ae(e);var t=e.length;if(t<4&&ve(e,Le)<0)switch(t){case 0:return 0;case 1:return e[0];case 2:return e[0]+e[1]*Z;default:return e[0]+(e[1]+e[2]*Z)*Z}return e}function ae(e){for(var t=e.length;e[--t]===0;);e.length=t+1}function Ce(e){for(var t=new Array(e),r=-1;++r<e;)t[r]=0;return t}function he(e){return e>0?Math.floor(e):Math.ceil(e)}function qe(e,t){var r,n,o=e.length,s=t.length,i=new Array(o),a=0,f=Z;for(n=0;n<s;n++)a=(r=e[n]+t[n]+a)>=f?1:0,i[n]=r-a*f;for(;n<o;)a=(r=e[n]+a)===f?1:0,i[n++]=r-a*f;return a>0&&i.push(a),i}function be(e,t){return e.length>=t.length?qe(e,t):qe(t,e)}function xe(e,t){var r,n,o=e.length,s=new Array(o),i=Z;for(n=0;n<o;n++)r=e[n]-i+t,t=Math.floor(r/i),s[n]=r-t*i,t+=1;for(;t>0;)s[n++]=t%i,t=Math.floor(t/i);return s}function ge(e,t){var r,n,o=e.length,s=t.length,i=new Array(o),a=0,f=Z;for(r=0;r<s;r++)(n=e[r]-a-t[r])<0?(n+=f,a=1):a=0,i[r]=n;for(r=s;r<o;r++){if(!((n=e[r]-a)<0)){i[r++]=n;break}n+=f,i[r]=n}for(;r<o;r++)i[r]=e[r];return ae(i),i}function Be(e,t,r){var n,o,s=e.length,i=new Array(s),a=-t,f=Z;for(n=0;n<s;n++)o=e[n]+a,a=Math.floor(o/f),o%=f,i[n]=o<0?o+f:o;return typeof(i=ye(i))=="number"?(r&&(i=-i),new g(i)):new c(i,r)}function Ue(e,t){var r,n,o,s,i=e.length,a=t.length,f=Ce(i+a),u=Z;for(o=0;o<i;++o){s=e[o];for(var y=0;y<a;++y)r=s*t[y]+f[o+y],n=Math.floor(r/u),f[o+y]=r-n*u,f[o+y+1]+=n}return ae(f),f}function Se(e,t){var r,n,o=e.length,s=new Array(o),i=Z,a=0;for(n=0;n<o;n++)r=e[n]*t+a,a=Math.floor(r/i),s[n]=r-a*i;for(;a>0;)s[n++]=a%i,a=Math.floor(a/i);return s}function Ge(e,t){for(var r=[];t-- >0;)r.push(0);return r.concat(e)}function Ie(e,t){var r=Math.max(e.length,t.length);if(r<=30)return Ue(e,t);r=Math.ceil(r/2);var n=e.slice(r),o=e.slice(0,r),s=t.slice(r),i=t.slice(0,r),a=Ie(o,i),f=Ie(n,s),u=Ie(be(o,n),be(i,s)),y=be(be(a,Ge(ge(ge(u,a),f),r)),Ge(f,2*r));return ae(y),y}function ke(e,t,r){return new c(e<Z?Se(t,e):Ue(t,le(e)),r)}function je(e){var t,r,n,o,s=e.length,i=Ce(s+s),a=Z;for(n=0;n<s;n++){r=0-(o=e[n])*o;for(var f=n;f<s;f++)t=o*e[f]*2+i[n+f]+r,r=Math.floor(t/a),i[n+f]=t-r*a;i[n+s]=r}return ae(i),i}function pe(e,t){var r,n,o,s,i=e.length,a=Ce(i);for(o=0,r=i-1;r>=0;--r)o=(s=1e7*o+e[r])-(n=he(s/t))*t,a[r]=0|n;return[a,0|o]}function me(e,t){var r,n=M(t);if(Te)return[new T(e.value/n.value),new T(e.value%n.value)];var o,s=e.value,i=n.value;if(i===0)throw new Error("Cannot divide by zero");if(e.isSmall)return n.isSmall?[new g(he(s/i)),new g(s%i)]:[x[0],e];if(n.isSmall){if(i===1)return[e,x[0]];if(i==-1)return[e.negate(),x[0]];var a=Math.abs(i);if(a<Z){o=ye((r=pe(s,a))[0]);var f=r[1];return e.sign&&(f=-f),typeof o=="number"?(e.sign!==n.sign&&(o=-o),[new g(o),new g(f)]):[new c(o,e.sign!==n.sign),new g(f)]}i=le(a)}var u=ve(s,i);if(u===-1)return[x[0],e];if(u===0)return[x[e.sign===n.sign?1:-1],x[0]];r=s.length+i.length<=200?function(O,N){var _,C,l,I,D,k,te,J=O.length,G=N.length,Q=Z,ie=Ce(N.length),q=N[G-1],ne=Math.ceil(Q/(2*q)),F=Se(O,ne),L=Se(N,ne);for(F.length<=J&&F.push(0),L.push(0),q=L[G-1],C=J-G;C>=0;C--){for(_=Q-1,F[C+G]!==q&&(_=Math.floor((F[C+G]*Q+F[C+G-1])/q)),l=0,I=0,k=L.length,D=0;D<k;D++)l+=_*L[D],te=Math.floor(l/Q),I+=F[C+D]-(l-te*Q),l=te,I<0?(F[C+D]=I+Q,I=-1):(F[C+D]=I,I=0);for(;I!==0;){for(_-=1,l=0,D=0;D<k;D++)(l+=F[C+D]-Q+L[D])<0?(F[C+D]=l+Q,l=0):(F[C+D]=l,l=1);I+=l}ie[C]=_}return F=pe(F,ne)[0],[ye(ie),ye(F)]}(s,i):function(O,N){for(var _,C,l,I,D,k=O.length,te=N.length,J=[],G=[],Q=Z;k;)if(G.unshift(O[--k]),ae(G),ve(G,N)<0)J.push(0);else{l=G[(C=G.length)-1]*Q+G[C-2],I=N[te-1]*Q+N[te-2],C>te&&(l=(l+1)*Q),_=Math.ceil(l/I);do{if(ve(D=Se(N,_),G)<=0)break;_--}while(_);J.push(_),G=ge(G,D)}return J.reverse(),[ye(J),ye(G)]}(s,i),o=r[0];var y=e.sign!==n.sign,E=r[1],b=e.sign;return typeof o=="number"?(y&&(o=-o),o=new g(o)):o=new c(o,y),typeof E=="number"?(b&&(E=-E),E=new g(E)):E=new c(E,b),[o,E]}function ve(e,t){if(e.length!==t.length)return e.length>t.length?1:-1;for(var r=e.length-1;r>=0;r--)if(e[r]!==t[r])return e[r]>t[r]?1:-1;return 0}function Fe(e){var t=e.abs();return!t.isUnit()&&(!!(t.equals(2)||t.equals(3)||t.equals(5))||!(t.isEven()||t.isDivisibleBy(3)||t.isDivisibleBy(5))&&(!!t.lesser(49)||void 0))}function Ne(e,t){for(var r,n,o,s=e.prev(),i=s,a=0;i.isEven();)i=i.divide(2),a++;e:for(n=0;n<t.length;n++)if(!e.lesser(t[n])&&!(o=$(t[n]).modPow(i,e)).isUnit()&&!o.equals(s)){for(r=a-1;r!=0;r--){if((o=o.square().mod(e)).isUnit())return!1;if(o.equals(s))continue e}return!1}return!0}c.prototype=Object.create(x.prototype),g.prototype=Object.create(x.prototype),T.prototype=Object.create(x.prototype),c.prototype.add=function(e){var t=M(e);if(this.sign!==t.sign)return this.subtract(t.negate());var r=this.value,n=t.value;return t.isSmall?new c(xe(r,Math.abs(n)),this.sign):new c(be(r,n),this.sign)},c.prototype.plus=c.prototype.add,g.prototype.add=function(e){var t=M(e),r=this.value;if(r<0!==t.sign)return this.subtract(t.negate());var n=t.value;if(t.isSmall){if(ue(r+n))return new g(r+n);n=le(Math.abs(n))}return new c(xe(n,Math.abs(r)),r<0)},g.prototype.plus=g.prototype.add,T.prototype.add=function(e){return new T(this.value+M(e).value)},T.prototype.plus=T.prototype.add,c.prototype.subtract=function(e){var t=M(e);if(this.sign!==t.sign)return this.add(t.negate());var r=this.value,n=t.value;return t.isSmall?Be(r,Math.abs(n),this.sign):function(o,s,i){var a;return ve(o,s)>=0?a=ge(o,s):(a=ge(s,o),i=!i),typeof(a=ye(a))=="number"?(i&&(a=-a),new g(a)):new c(a,i)}(r,n,this.sign)},c.prototype.minus=c.prototype.subtract,g.prototype.subtract=function(e){var t=M(e),r=this.value;if(r<0!==t.sign)return this.add(t.negate());var n=t.value;return t.isSmall?new g(r-n):Be(n,Math.abs(r),r>=0)},g.prototype.minus=g.prototype.subtract,T.prototype.subtract=function(e){return new T(this.value-M(e).value)},T.prototype.minus=T.prototype.subtract,c.prototype.negate=function(){return new c(this.value,!this.sign)},g.prototype.negate=function(){var e=this.sign,t=new g(-this.value);return t.sign=!e,t},T.prototype.negate=function(){return new T(-this.value)},c.prototype.abs=function(){return new c(this.value,!1)},g.prototype.abs=function(){return new g(Math.abs(this.value))},T.prototype.abs=function(){return new T(this.value>=0?this.value:-this.value)},c.prototype.multiply=function(e){var t,r,n,o=M(e),s=this.value,i=o.value,a=this.sign!==o.sign;if(o.isSmall){if(i===0)return x[0];if(i===1)return this;if(i===-1)return this.negate();if((t=Math.abs(i))<Z)return new c(Se(s,t),a);i=le(t)}return new c(-.012*(r=s.length)-.012*(n=i.length)+15e-6*r*n>0?Ie(s,i):Ue(s,i),a)},c.prototype.times=c.prototype.multiply,g.prototype._multiplyBySmall=function(e){return ue(e.value*this.value)?new g(e.value*this.value):ke(Math.abs(e.value),le(Math.abs(this.value)),this.sign!==e.sign)},c.prototype._multiplyBySmall=function(e){return e.value===0?x[0]:e.value===1?this:e.value===-1?this.negate():ke(Math.abs(e.value),this.value,this.sign!==e.sign)},g.prototype.multiply=function(e){return M(e)._multiplyBySmall(this)},g.prototype.times=g.prototype.multiply,T.prototype.multiply=function(e){return new T(this.value*M(e).value)},T.prototype.times=T.prototype.multiply,c.prototype.square=function(){return new c(je(this.value),!1)},g.prototype.square=function(){var e=this.value*this.value;return ue(e)?new g(e):new c(je(le(Math.abs(this.value))),!1)},T.prototype.square=function(e){return new T(this.value*this.value)},c.prototype.divmod=function(e){var t=me(this,e);return{quotient:t[0],remainder:t[1]}},T.prototype.divmod=g.prototype.divmod=c.prototype.divmod,c.prototype.divide=function(e){return me(this,e)[0]},T.prototype.over=T.prototype.divide=function(e){return new T(this.value/M(e).value)},g.prototype.over=g.prototype.divide=c.prototype.over=c.prototype.divide,c.prototype.mod=function(e){return me(this,e)[1]},T.prototype.mod=T.prototype.remainder=function(e){return new T(this.value%M(e).value)},g.prototype.remainder=g.prototype.mod=c.prototype.remainder=c.prototype.mod,c.prototype.pow=function(e){var t,r,n,o=M(e),s=this.value,i=o.value;if(i===0)return x[1];if(s===0)return x[0];if(s===1)return x[1];if(s===-1)return o.isEven()?x[1]:x[-1];if(o.sign)return x[0];if(!o.isSmall)throw new Error("The exponent "+o.toString()+" is too large.");if(this.isSmall&&ue(t=Math.pow(s,i)))return new g(he(t));for(r=this,n=x[1];!0&i&&(n=n.times(r),--i),i!==0;)i/=2,r=r.square();return n},g.prototype.pow=c.prototype.pow,T.prototype.pow=function(e){var t=M(e),r=this.value,n=t.value,o=BigInt(0),s=BigInt(1),i=BigInt(2);if(n===o)return x[1];if(r===o)return x[0];if(r===s)return x[1];if(r===BigInt(-1))return t.isEven()?x[1]:x[-1];if(t.isNegative())return new T(o);for(var a=this,f=x[1];(n&s)===s&&(f=f.times(a),--n),n!==o;)n/=i,a=a.square();return f},c.prototype.modPow=function(e,t){if(e=M(e),(t=M(t)).isZero())throw new Error("Cannot take modPow with modulus 0");for(var r=x[1],n=this.mod(t);e.isPositive();){if(n.isZero())return x[0];e.isOdd()&&(r=r.multiply(n).mod(t)),e=e.divide(2),n=n.square().mod(t)}return r},T.prototype.modPow=g.prototype.modPow=c.prototype.modPow,c.prototype.compareAbs=function(e){var t=M(e),r=this.value,n=t.value;return t.isSmall?1:ve(r,n)},g.prototype.compareAbs=function(e){var t=M(e),r=Math.abs(this.value),n=t.value;return t.isSmall?r===(n=Math.abs(n))?0:r>n?1:-1:-1},T.prototype.compareAbs=function(e){var t=this.value,r=M(e).value;return(t=t>=0?t:-t)===(r=r>=0?r:-r)?0:t>r?1:-1},c.prototype.compare=function(e){if(e===1/0)return-1;if(e===-1/0)return 1;var t=M(e),r=this.value,n=t.value;return this.sign!==t.sign?t.sign?1:-1:t.isSmall?this.sign?-1:1:ve(r,n)*(this.sign?-1:1)},c.prototype.compareTo=c.prototype.compare,g.prototype.compare=function(e){if(e===1/0)return-1;if(e===-1/0)return 1;var t=M(e),r=this.value,n=t.value;return t.isSmall?r==n?0:r>n?1:-1:r<0!==t.sign?r<0?-1:1:r<0?1:-1},g.prototype.compareTo=g.prototype.compare,T.prototype.compare=function(e){if(e===1/0)return-1;if(e===-1/0)return 1;var t=this.value,r=M(e).value;return t===r?0:t>r?1:-1},T.prototype.compareTo=T.prototype.compare,c.prototype.equals=function(e){return this.compare(e)===0},T.prototype.eq=T.prototype.equals=g.prototype.eq=g.prototype.equals=c.prototype.eq=c.prototype.equals,c.prototype.notEquals=function(e){return this.compare(e)!==0},T.prototype.neq=T.prototype.notEquals=g.prototype.neq=g.prototype.notEquals=c.prototype.neq=c.prototype.notEquals,c.prototype.greater=function(e){return this.compare(e)>0},T.prototype.gt=T.prototype.greater=g.prototype.gt=g.prototype.greater=c.prototype.gt=c.prototype.greater,c.prototype.lesser=function(e){return this.compare(e)<0},T.prototype.lt=T.prototype.lesser=g.prototype.lt=g.prototype.lesser=c.prototype.lt=c.prototype.lesser,c.prototype.greaterOrEquals=function(e){return this.compare(e)>=0},T.prototype.geq=T.prototype.greaterOrEquals=g.prototype.geq=g.prototype.greaterOrEquals=c.prototype.geq=c.prototype.greaterOrEquals,c.prototype.lesserOrEquals=function(e){return this.compare(e)<=0},T.prototype.leq=T.prototype.lesserOrEquals=g.prototype.leq=g.prototype.lesserOrEquals=c.prototype.leq=c.prototype.lesserOrEquals,c.prototype.isEven=function(){return(1&this.value[0])==0},g.prototype.isEven=function(){return(1&this.value)==0},T.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},c.prototype.isOdd=function(){return(1&this.value[0])==1},g.prototype.isOdd=function(){return(1&this.value)==1},T.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},c.prototype.isPositive=function(){return!this.sign},g.prototype.isPositive=function(){return this.value>0},T.prototype.isPositive=g.prototype.isPositive,c.prototype.isNegative=function(){return this.sign},g.prototype.isNegative=function(){return this.value<0},T.prototype.isNegative=g.prototype.isNegative,c.prototype.isUnit=function(){return!1},g.prototype.isUnit=function(){return Math.abs(this.value)===1},T.prototype.isUnit=function(){return this.abs().value===BigInt(1)},c.prototype.isZero=function(){return!1},g.prototype.isZero=function(){return this.value===0},T.prototype.isZero=function(){return this.value===BigInt(0)},c.prototype.isDivisibleBy=function(e){var t=M(e);return!t.isZero()&&(!!t.isUnit()||(t.compareAbs(2)===0?this.isEven():this.mod(t).isZero()))},T.prototype.isDivisibleBy=g.prototype.isDivisibleBy=c.prototype.isDivisibleBy,c.prototype.isPrime=function(e){var t=Fe(this);if(t!==_e)return t;var r=this.abs(),n=r.bitLength();if(n<=64)return Ne(r,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var o=Math.log(2)*n.toJSNumber(),s=Math.ceil(e===!0?2*Math.pow(o,2):o),i=[],a=0;a<s;a++)i.push($(a+2));return Ne(r,i)},T.prototype.isPrime=g.prototype.isPrime=c.prototype.isPrime,c.prototype.isProbablePrime=function(e){var t=Fe(this);if(t!==_e)return t;for(var r=this.abs(),n=e===_e?5:e,o=[],s=0;s<n;s++)o.push($.randBetween(2,r.minus(2)));return Ne(r,o)},T.prototype.isProbablePrime=g.prototype.isProbablePrime=c.prototype.isProbablePrime,c.prototype.modInv=function(e){for(var t,r,n,o=$.zero,s=$.one,i=M(e),a=this.abs();!a.isZero();)t=i.divide(a),r=o,n=i,o=s,i=a,s=r.subtract(t.multiply(s)),a=n.subtract(t.multiply(a));if(!i.isUnit())throw new Error(this.toString()+" and "+e.toString()+" are not co-prime");return o.compare(0)===-1&&(o=o.add(e)),this.isNegative()?o.negate():o},T.prototype.modInv=g.prototype.modInv=c.prototype.modInv,c.prototype.next=function(){var e=this.value;return this.sign?Be(e,1,this.sign):new c(xe(e,1),this.sign)},g.prototype.next=function(){var e=this.value;return e+1<Ee?new g(e+1):new c(Le,!1)},T.prototype.next=function(){return new T(this.value+BigInt(1))},c.prototype.prev=function(){var e=this.value;return this.sign?new c(xe(e,1),!0):Be(e,1,this.sign)},g.prototype.prev=function(){var e=this.value;return e-1>-Ee?new g(e-1):new c(Le,!0)},T.prototype.prev=function(){return new T(this.value-BigInt(1))};for(var fe=[1];2*fe[fe.length-1]<=Z;)fe.push(2*fe[fe.length-1]);var Ae=fe.length,se=fe[Ae-1];function Ye(e){return Math.abs(e)<=Z}function h(e,t,r){t=M(t);for(var n=e.isNegative(),o=t.isNegative(),s=n?e.not():e,i=o?t.not():t,a=0,f=0,u=null,y=null,E=[];!s.isZero()||!i.isZero();)a=(u=me(s,se))[1].toJSNumber(),n&&(a=se-1-a),f=(y=me(i,se))[1].toJSNumber(),o&&(f=se-1-f),s=u[0],i=y[0],E.push(r(a,f));for(var b=r(n?1:0,o?1:0)!==0?$(-1):$(0),O=E.length-1;O>=0;O-=1)b=b.multiply(se).add($(E[O]));return b}c.prototype.shiftLeft=function(e){var t=M(e).toJSNumber();if(!Ye(t))throw new Error(String(t)+" is too large for shifting.");if(t<0)return this.shiftRight(-t);var r=this;if(r.isZero())return r;for(;t>=Ae;)r=r.multiply(se),t-=Ae-1;return r.multiply(fe[t])},T.prototype.shiftLeft=g.prototype.shiftLeft=c.prototype.shiftLeft,c.prototype.shiftRight=function(e){var t,r=M(e).toJSNumber();if(!Ye(r))throw new Error(String(r)+" is too large for shifting.");if(r<0)return this.shiftLeft(-r);for(var n=this;r>=Ae;){if(n.isZero()||n.isNegative()&&n.isUnit())return n;n=(t=me(n,se))[1].isNegative()?t[0].prev():t[0],r-=Ae-1}return(t=me(n,fe[r]))[1].isNegative()?t[0].prev():t[0]},T.prototype.shiftRight=g.prototype.shiftRight=c.prototype.shiftRight,c.prototype.not=function(){return this.negate().prev()},T.prototype.not=g.prototype.not=c.prototype.not,c.prototype.and=function(e){return h(this,e,function(t,r){return t&r})},T.prototype.and=g.prototype.and=c.prototype.and,c.prototype.or=function(e){return h(this,e,function(t,r){return t|r})},T.prototype.or=g.prototype.or=c.prototype.or,c.prototype.xor=function(e){return h(this,e,function(t,r){return t^r})},T.prototype.xor=g.prototype.xor=c.prototype.xor;var m=1<<30;function v(e){var t=e.value,r=typeof t=="number"?t|m:typeof t=="bigint"?t|BigInt(m):t[0]+t[1]*Z|1073758208;return r&-r}function d(e,t){if(t.compareTo(e)<=0){var r=d(e,t.square(t)),n=r.p,o=r.e,s=n.multiply(t);return s.compareTo(e)<=0?{p:s,e:2*o+1}:{p:n,e:2*o}}return{p:$(1),e:0}}function w(e,t){return e=M(e),t=M(t),e.greater(t)?e:t}function p(e,t){return e=M(e),t=M(t),e.lesser(t)?e:t}function S(e,t){if(e=M(e).abs(),t=M(t).abs(),e.equals(t))return e;if(e.isZero())return t;if(t.isZero())return e;for(var r,n,o=x[1];e.isEven()&&t.isEven();)r=p(v(e),v(t)),e=e.divide(r),t=t.divide(r),o=o.multiply(r);for(;e.isEven();)e=e.divide(v(e));do{for(;t.isEven();)t=t.divide(v(t));e.greater(t)&&(n=t,t=e,e=n),t=t.subtract(e)}while(!t.isZero());return o.isUnit()?e:e.multiply(o)}c.prototype.bitLength=function(){var e=this;return e.compareTo($(0))<0&&(e=e.negate().subtract($(1))),e.compareTo($(0))===0?$(0):$(d(e,$(2)).e).add($(1))},T.prototype.bitLength=g.prototype.bitLength=c.prototype.bitLength;var P=function(e,t,r,n){r=r||Oe,e=String(e),n||(e=e.toLowerCase(),r=r.toLowerCase());var o,s=e.length,i=Math.abs(t),a={};for(o=0;o<r.length;o++)a[r[o]]=o;for(o=0;o<s;o++)if((y=e[o])!=="-"&&y in a&&a[y]>=i){if(y==="1"&&i===1)continue;throw new Error(y+" is not a valid digit in base "+t+".")}t=M(t);var f=[],u=e[0]==="-";for(o=u?1:0;o<e.length;o++){var y;if((y=e[o])in a)f.push(M(a[y]));else{if(y!=="<")throw new Error(y+" is not a valid character");var E=o;do o++;while(e[o]!==">"&&o<e.length);f.push(M(e.slice(E+1,o)))}}return A(f,t,u)};function A(e,t,r){var n,o=x[0],s=x[1];for(n=e.length-1;n>=0;n--)o=o.add(e[n].times(s)),s=s.times(t);return r?o.negate():o}function K(e,t){if((t=$(t)).isZero()){if(e.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(t.equals(-1)){if(e.isZero())return{value:[0],isNegative:!1};if(e.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-e.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var r=Array.apply(null,Array(e.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return r.unshift([1]),{value:[].concat.apply([],r),isNegative:!1}}var n=!1;if(e.isNegative()&&t.isPositive()&&(n=!0,e=e.abs()),t.isUnit())return e.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(e.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:n};for(var o,s=[],i=e;i.isNegative()||i.compareAbs(t)>=0;){o=i.divmod(t),i=o.quotient;var a=o.remainder;a.isNegative()&&(a=t.minus(a).abs(),i=i.next()),s.push(a.toJSNumber())}return s.push(i.toJSNumber()),{value:s.reverse(),isNegative:n}}function z(e,t,r){var n=K(e,t);return(n.isNegative?"-":"")+n.value.map(function(o){return function(s,i){return s<(i=i||Oe).length?i[s]:"<"+s+">"}(o,r)}).join("")}function Y(e){if(ue(+e)){var t=+e;if(t===he(t))return Te?new T(BigInt(t)):new g(t);throw new Error("Invalid integer: "+e)}var r=e[0]==="-";r&&(e=e.slice(1));var n=e.split(/e/i);if(n.length>2)throw new Error("Invalid integer: "+n.join("e"));if(n.length===2){var o=n[1];if(o[0]==="+"&&(o=o.slice(1)),(o=+o)!==he(o)||!ue(o))throw new Error("Invalid integer: "+o+" is not a valid exponent.");var s=n[0],i=s.indexOf(".");if(i>=0&&(o-=s.length-i-1,s=s.slice(0,i)+s.slice(i+1)),o<0)throw new Error("Cannot include negative exponent part for integers");e=s+=new Array(o+1).join("0")}if(!/^([0-9][0-9]*)$/.test(e))throw new Error("Invalid integer: "+e);if(Te)return new T(BigInt(r?"-"+e:e));for(var a=[],f=e.length,u=f-7;f>0;)a.push(+e.slice(u,f)),(u-=7)<0&&(u=0),f-=7;return ae(a),new c(a,r)}function M(e){return typeof e=="number"?function(t){if(Te)return new T(BigInt(t));if(ue(t)){if(t!==he(t))throw new Error(t+" is not an integer.");return new g(t)}return Y(t.toString())}(e):typeof e=="string"?Y(e):typeof e=="bigint"?new T(e):e}c.prototype.toArray=function(e){return K(this,e)},g.prototype.toArray=function(e){return K(this,e)},T.prototype.toArray=function(e){return K(this,e)},c.prototype.toString=function(e,t){if(e===_e&&(e=10),e!==10)return z(this,e,t);for(var r,n=this.value,o=n.length,s=String(n[--o]);--o>=0;)r=String(n[o]),s+="0000000".slice(r.length)+r;return(this.sign?"-":"")+s},g.prototype.toString=function(e,t){return e===_e&&(e=10),e!=10?z(this,e,t):String(this.value)},T.prototype.toString=g.prototype.toString,T.prototype.toJSON=c.prototype.toJSON=g.prototype.toJSON=function(){return this.toString()},c.prototype.valueOf=function(){return parseInt(this.toString(),10)},c.prototype.toJSNumber=c.prototype.valueOf,g.prototype.valueOf=function(){return this.value},g.prototype.toJSNumber=g.prototype.valueOf,T.prototype.valueOf=T.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};for(var B=0;B<1e3;B++)x[B]=M(B),B>0&&(x[-B]=M(-B));return x.one=x[1],x.zero=x[0],x.minusOne=x[-1],x.max=w,x.min=p,x.gcd=S,x.lcm=function(e,t){return e=M(e).abs(),t=M(t).abs(),e.divide(S(e,t)).multiply(t)},x.isInstance=function(e){return e instanceof c||e instanceof g||e instanceof T},x.randBetween=function(e,t){var r=p(e=M(e),t=M(t)),n=w(e,t).subtract(r).add(1);if(n.isSmall)return r.add(Math.floor(Math.random()*n));for(var o=K(n,Z).value,s=[],i=!0,a=0;a<o.length;a++){var f=i?o[a]:Z,u=he(Math.random()*f);s.push(u),u<f&&(i=!1)}return r.add(x.fromArray(s,Z,!1))},x.fromArray=function(e,t,r){return A(e.map(M),M(t||10),r)},x}();j.hasOwnProperty("exports")&&(j.exports=$),(Pe=function(){return $}.apply(U,[]))===void 0||(j.exports=Pe)}},de={};function ee(j){var U=de[j];if(U!==void 0)return U.exports;var oe=de[j]={id:j,loaded:!1,exports:{}};return De[j](oe,oe.exports,ee),oe.loaded=!0,oe.exports}ee.n=function(j){var U=j&&j.__esModule?function(){return j.default}:function(){return j};return ee.d(U,{a:U}),U},ee.d=function(j,U){for(var oe in U)ee.o(U,oe)&&!ee.o(j,oe)&&Object.defineProperty(j,oe,{enumerable:!0,get:U[oe]})},ee.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),ee.o=function(j,U){return Object.prototype.hasOwnProperty.call(j,U)},ee.nmd=function(j){return j.paths=[],j.children||(j.children=[]),j};var Me={};return function(){ee.d(Me,{default:function(){return Ye}});var j=function h(){(function(m,v){if(!(m instanceof v))throw new TypeError("Cannot call a class as a function")})(this,h),this.streamId=null,this.mediaInfo=null,this.segmentType=null,this.quality=NaN,this.index=NaN,this.bytes=null,this.start=NaN,this.end=NaN,this.duration=NaN,this.representationId=null,this.endFragment=null},U=function h(){(function(m,v){if(!(m instanceof v))throw new TypeError("Cannot call a class as a function")})(this,h),this.tcpid=null,this.type=null,this.url=null,this.actualurl=null,this.range=null,this.trequest=null,this.tresponse=null,this.responsecode=null,this.interval=null,this.trace=[],this.cmsd=null,this._stream=null,this._tfinish=null,this._mediaduration=null,this._quality=null,this._responseHeaders=null,this._serviceLocation=null,this._fileLoaderType=null};function oe(h,m){for(var v=0;v<m.length;v++){var d=m[v];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(h,d.key,d)}}U.GET="GET",U.HEAD="HEAD",U.MPD_TYPE="MPD",U.XLINK_EXPANSION_TYPE="XLinkExpansion",U.INIT_SEGMENT_TYPE="InitializationSegment",U.INDEX_SEGMENT_TYPE="IndexSegment",U.MEDIA_SEGMENT_TYPE="MediaSegment",U.BITSTREAM_SWITCHING_SEGMENT_TYPE="BitstreamSwitchingSegment",U.MSS_FRAGMENT_INFO_SEGMENT_TYPE="FragmentInfoSegment",U.DVB_REPORTING_TYPE="DVBReporting",U.LICENSE="license",U.CONTENT_STEERING_TYPE="ContentSteering",U.OTHER_TYPE="other";var Pe=function(){function h(d){(function(w,p){if(!(w instanceof p))throw new TypeError("Cannot call a class as a function")})(this,h),this.action=h.ACTION_DOWNLOAD,this.startTime=NaN,this.mediaStartTime=NaN,this.mediaType=null,this.mediaInfo=null,this.type=null,this.duration=NaN,this.timescale=NaN,this.range=null,this.url=d||null,this.serviceLocation=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.quality=NaN,this.index=NaN,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null,this.bytesLoaded=NaN,this.bytesTotal=NaN,this.delayLoadingTime=NaN,this.responseType="arraybuffer",this.representationId=null}var m,v;return m=h,(v=[{key:"isInitializationRequest",value:function(){return this.type&&this.type===U.INIT_SEGMENT_TYPE}},{key:"setInfo",value:function(d){this.type=d&&d.init?U.INIT_SEGMENT_TYPE:U.MEDIA_SEGMENT_TYPE,this.url=d&&d.url?d.url:null,this.range=d&&d.range?d.range.start+"-"+d.range.end:null,this.mediaType=d&&d.mediaType?d.mediaType:null}}])&&oe(m.prototype,v),h}();Pe.ACTION_DOWNLOAD="download",Pe.ACTION_COMPLETE="complete";var $=Pe;function _e(h){var m,v,d,w,p,S,P,A,K,z=(h=h||{}).streamProcessor,Y=h.baseURLController,M=h.debug;function B(){w&&(v.debug("Stop"),clearTimeout(S),w=!1,P=null,A=null)}function e(){if(w){var r=z.getRepresentationController().getCurrentRepresentation(),n=r.adaptation.period.mpd.manifest.Period_asArray[r.adaptation.period.index].AdaptationSet_asArray[r.adaptation.index],o=n.SegmentTemplate.SegmentTimeline.S_asArray,s=function(i,a,f){var u=i.SegmentTemplate.timescale,y=new $;return y.mediaType=p,y.type=U.MSS_FRAGMENT_INFO_SEGMENT_TYPE,y.startTime=f.t/u,y.duration=f.d/u,y.timescale=u,y.quality=a.index,y.index=K++,y.mediaInfo=z.getMediaInfo(),y.adaptationIndex=a.adaptation.index,y.representationId=a.id,y.url=Y.resolve(a.path).url+i.SegmentTemplate.media,y.url=y.url.replace("$Bandwidth$",a.bandwidth),y.url=y.url.replace("$Time$",f.tManifest?f.tManifest:f.t),y.url=y.url.replace("/Fragments(","/FragmentInfo("),y}(n,r,o[o.length-1]);t.call(this,s)}}function t(r){if(z.getFragmentModel().isFragmentLoadedOrPending(r))return v.debug("End of timeline"),void B();d.executeRequest(r)}return m={initialize:function(){p=z.getType(),d=z.getFragmentModel(),w=!1,P=null,A=null},controllerType:"MssFragmentInfoController",start:function(){w||(v.debug("Start"),w=!0,K=0,e())},fragmentInfoLoaded:function(r){if(w){var n,o,s,i=r.request;r.response?(P===null&&(P=new Date().getTime()),A||(A=i.startTime),o=(new Date().getTime()-P)/1e3,n=i.startTime+i.duration-A,s=Math.max(0,n-o),clearTimeout(S),S=setTimeout(function(){S=null,e()},1e3*s)):v.error("Load error",i.url)}},getType:function(){return p},reset:function(){B()}},v=M.getLogger(m),m}_e.__dashjs_factory_name="MssFragmentInfoController";var Z=dashjs.FactoryMaker.getClassFactory(_e),Ee=function h(m,v,d){(function(w,p){if(!(w instanceof p))throw new TypeError("Cannot call a class as a function")})(this,h),this.code=m||null,this.message=v||null,this.data=d||null};function Le(h,m){for(var v=0;v<m.length;v++){var d=m[v];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(h,d.key,d)}}function Oe(h){return Oe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},Oe(h)}function Te(h,m){return Te=Object.setPrototypeOf||function(v,d){return v.__proto__=d,v},Te(h,m)}function x(h,m){return!m||Oe(m)!=="object"&&typeof m!="function"?function(v){if(v===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v}(h):m}function c(h){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(m){return m.__proto__||Object.getPrototypeOf(m)},c(h)}var g=new(function(h){(function(p,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function");p.prototype=Object.create(S&&S.prototype,{constructor:{value:p,writable:!0,configurable:!0}}),S&&Te(p,S)})(w,h);var m,v,d=(m=w,v=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var p,S=c(m);if(v){var P=c(this).constructor;p=Reflect.construct(S,arguments,P)}else p=S.apply(this,arguments);return x(this,p)});function w(){var p;return function(S,P){if(!(S instanceof P))throw new TypeError("Cannot call a class as a function")}(this,w),(p=d.call(this)).MSS_NO_TFRF_CODE=200,p.MSS_UNSUPPORTED_CODEC_CODE=201,p.MSS_NO_TFRF_MESSAGE="Missing tfrf in live media segment",p.MSS_UNSUPPORTED_CODEC_MESSAGE="Unsupported codec",p}return w}(function(){function h(){(function(d,w){if(!(d instanceof w))throw new TypeError("Cannot call a class as a function")})(this,h)}var m,v;return m=h,(v=[{key:"extend",value:function(d,w){if(d){var p=!!w&&w.override,S=!!w&&w.publicOnly;for(var P in d)!d.hasOwnProperty(P)||this[P]&&!p||S&&d[P].indexOf("public_")===-1||(this[P]=d[P])}}}])&&Le(m.prototype,v),h}()));function T(h,m){for(var v=0;v<m.length;v++){var d=m[v];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(h,d.key,d)}}function ue(h){return ue=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},ue(h)}function le(h,m){return le=Object.setPrototypeOf||function(v,d){return v.__proto__=d,v},le(h,m)}function ye(h,m){return!m||ue(m)!=="object"&&typeof m!="function"?function(v){if(v===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v}(h):m}function ae(h){return ae=Object.setPrototypeOf?Object.getPrototypeOf:function(m){return m.__proto__||Object.getPrototypeOf(m)},ae(h)}var Ce=new(function(h){(function(p,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function");p.prototype=Object.create(S&&S.prototype,{constructor:{value:p,writable:!0,configurable:!0}}),S&&le(p,S)})(w,h);var m,v,d=(m=w,v=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var p,S=ae(m);if(v){var P=ae(this).constructor;p=Reflect.construct(S,arguments,P)}else p=S.apply(this,arguments);return ye(this,p)});function w(){var p;return function(S,P){if(!(S instanceof P))throw new TypeError("Cannot call a class as a function")}(this,w),(p=d.call(this)).AST_IN_FUTURE="astInFuture",p.BASE_URLS_UPDATED="baseUrlsUpdated",p.BUFFER_EMPTY="bufferStalled",p.BUFFER_LOADED="bufferLoaded",p.BUFFER_LEVEL_STATE_CHANGED="bufferStateChanged",p.BUFFER_LEVEL_UPDATED="bufferLevelUpdated",p.DYNAMIC_TO_STATIC="dynamicToStatic",p.ERROR="error",p.FRAGMENT_LOADING_COMPLETED="fragmentLoadingCompleted",p.FRAGMENT_LOADING_PROGRESS="fragmentLoadingProgress",p.FRAGMENT_LOADING_STARTED="fragmentLoadingStarted",p.FRAGMENT_LOADING_ABANDONED="fragmentLoadingAbandoned",p.LOG="log",p.MANIFEST_LOADING_STARTED="manifestLoadingStarted",p.MANIFEST_LOADING_FINISHED="manifestLoadingFinished",p.MANIFEST_LOADED="manifestLoaded",p.METRICS_CHANGED="metricsChanged",p.METRIC_CHANGED="metricChanged",p.METRIC_ADDED="metricAdded",p.METRIC_UPDATED="metricUpdated",p.PERIOD_SWITCH_STARTED="periodSwitchStarted",p.PERIOD_SWITCH_COMPLETED="periodSwitchCompleted",p.QUALITY_CHANGE_REQUESTED="qualityChangeRequested",p.QUALITY_CHANGE_RENDERED="qualityChangeRendered",p.TRACK_CHANGE_RENDERED="trackChangeRendered",p.STREAM_INITIALIZING="streamInitializing",p.STREAM_UPDATED="streamUpdated",p.STREAM_ACTIVATED="streamActivated",p.STREAM_DEACTIVATED="streamDeactivated",p.STREAM_INITIALIZED="streamInitialized",p.STREAM_TEARDOWN_COMPLETE="streamTeardownComplete",p.TEXT_TRACKS_ADDED="allTextTracksAdded",p.TEXT_TRACK_ADDED="textTrackAdded",p.THROUGHPUT_MEASUREMENT_STORED="throughputMeasurementStored",p.TTML_PARSED="ttmlParsed",p.TTML_TO_PARSE="ttmlToParse",p.CAPTION_RENDERED="captionRendered",p.CAPTION_CONTAINER_RESIZE="captionContainerResize",p.CAN_PLAY="canPlay",p.CAN_PLAY_THROUGH="canPlayThrough",p.PLAYBACK_ENDED="playbackEnded",p.PLAYBACK_ERROR="playbackError",p.PLAYBACK_NOT_ALLOWED="playbackNotAllowed",p.PLAYBACK_METADATA_LOADED="playbackMetaDataLoaded",p.PLAYBACK_LOADED_DATA="playbackLoadedData",p.PLAYBACK_PAUSED="playbackPaused",p.PLAYBACK_PLAYING="playbackPlaying",p.PLAYBACK_PROGRESS="playbackProgress",p.PLAYBACK_RATE_CHANGED="playbackRateChanged",p.PLAYBACK_SEEKED="playbackSeeked",p.PLAYBACK_SEEKING="playbackSeeking",p.PLAYBACK_STALLED="playbackStalled",p.PLAYBACK_STARTED="playbackStarted",p.PLAYBACK_TIME_UPDATED="playbackTimeUpdated",p.PLAYBACK_VOLUME_CHANGED="playbackVolumeChanged",p.PLAYBACK_WAITING="playbackWaiting",p.MANIFEST_VALIDITY_CHANGED="manifestValidityChanged",p.EVENT_MODE_ON_START="eventModeOnStart",p.EVENT_MODE_ON_RECEIVE="eventModeOnReceive",p.CONFORMANCE_VIOLATION="conformanceViolation",p.REPRESENTATION_SWITCH="representationSwitch",p.ADAPTATION_SET_REMOVED_NO_CAPABILITIES="adaptationSetRemovedNoCapabilities",p.CONTENT_STEERING_REQUEST_COMPLETED="contentSteeringRequestCompleted",p.INBAND_PRFT="inbandPrft",p}return w}(function(){function h(){(function(d,w){if(!(d instanceof w))throw new TypeError("Cannot call a class as a function")})(this,h)}var m,v;return m=h,(v=[{key:"extend",value:function(d,w){if(d){var p=!!w&&w.override,S=!!w&&w.publicOnly;for(var P in d)!d.hasOwnProperty(P)||this[P]&&!p||S&&d[P].indexOf("public_")===-1||(this[P]=d[P])}}}])&&T(m.prototype,v),h}()));function he(h){var m,v,d,w=(h=h||{}).dashMetrics,p=h.playbackController,S=h.errHandler,P=h.eventBus,A=h.ISOBoxer,K=h.debug;function z(B,e,t,r){var n=r.getRepresentationController().getCurrentRepresentation(),o=n.adaptation.period.mpd.manifest,s=o.Period_asArray[n.adaptation.period.index].AdaptationSet_asArray[n.adaptation.index],i=s.SegmentTemplate.timescale;if(v=r.getType(),o.type==="dynamic"||o.timeShiftBufferDepth)if(e){var a,f,u,y,E=s.SegmentTemplate.SegmentTimeline.S,b=e.entry,O=null,N=null;if(b.length!==0&&(a=b[0],!(o.type==="static"&&(f=E[0].tManifest?parseFloat(E[0].tManifest):E[0].t,a.fragment_absolute_time>f+o.timeShiftBufferDepth*i)))){if(f=E[E.length-1].tManifest?parseFloat(E[E.length-1].tManifest):E[E.length-1].t,a.fragment_absolute_time<=f)return u={start:E[0].t/i,end:t.baseMediaDecodeTime/i+B.duration},void Y(B.mediaType,u,r.getStreamInfo().manifestInfo);(O={}).t=a.fragment_absolute_time,O.d=a.fragment_duration,E[0].tManifest&&(O.t-=parseFloat(E[0].tManifest)-E[0].t,O.tManifest=a.fragment_absolute_time);var _=E[E.length-1];if(_.t+_.d!==O.t&&(d.debug("Patch segment duration - t = ",_.t+", d = "+_.d+" => "+(O.t-_.t)),_.d=O.t-_.t),E.push(O),o.type!=="static"){if(o.timeShiftBufferDepth&&o.timeShiftBufferDepth>0)for(N=((O=E[E.length-1]).t-o.timeShiftBufferDepth*i)/i,y=((O=E[0]).t+O.d)/i;y<N&&(p.isPaused()||!(p.getTime()<y));)E.splice(0,1),y=((O=E[0]).t+O.d)/i;u={start:E[0].t/i,end:t.baseMediaDecodeTime/i+B.duration},Y(v,u,r.getStreamInfo().manifestInfo)}else v==="video"&&(y=((O=E[E.length-1]).t+O.d)/i)>n.adaptation.period.duration&&P.trigger(Ce.MANIFEST_VALIDITY_CHANGED,{sender:this,newDuration:y})}}else S.error(new Ee(g.MSS_NO_TFRF_CODE,g.MSS_NO_TFRF_MESSAGE))}function Y(B,e,t){if(B==="video"||B==="audio"){var r=w.getCurrentDVRInfo(B);(!r||e.end>r.range.end)&&(d.debug("Update DVR range: ["+e.start+" - "+e.end+"]"),w.addDVRInfo(B,p.getTime(),t,e),p.updateCurrentTime(B))}}function M(B,e){var t=8,r=0;for(r=0;r<B.boxes.length;r++){if(B.boxes[r].type===e)return t;t+=B.boxes[r].size}return t}return m={convertFragment:function(B,e){var t,r=A.parseBuffer(B.response),n=r.fetch("tfhd");n.track_ID=B.request.mediaInfo.index+1;var o=r.fetch("tfdt"),s=r.fetch("traf");o===null&&((o=A.createFullBox("tfdt",s,n)).version=1,o.flags=0,o.baseMediaDecodeTime=Math.floor(B.request.startTime*B.request.timescale));var i=r.fetch("trun"),a=r.fetch("tfxd");a&&(a._parent.boxes.splice(a._parent.boxes.indexOf(a),1),a=null);var f=r.fetch("tfrf");z(B.request,f,o,e),f&&(f._parent.boxes.splice(f._parent.boxes.indexOf(f),1),f=null);var u=r.fetch("sepiff");if(u!==null){u.type="senc",u.usertype=void 0;var y=r.fetch("saio");if(y===null){(y=A.createFullBox("saio",s)).version=0,y.flags=0,y.entry_count=1,y.offset=[0];var E=A.createFullBox("saiz",s);if(E.version=0,E.flags=0,E.sample_count=u.sample_count,E.default_sample_info_size=0,E.sample_info_size=[],2&u.flags)for(t=0;t<u.sample_count;t+=1)E.sample_info_size[t]=10+6*u.entry[t].NumberOfEntries;else E.default_sample_info_size=8}}n.flags&=16777214,n.flags|=131072,i.flags|=1;var b=r.fetch("moof"),O=b.getLength();i.data_offset=O+8;var N=r.fetch("saio");if(N!==null){var _=M(b,"traf"),C=M(s,"senc");N.offset[0]=_+C+16}B.response=r.write()},updateSegmentList:function(B,e){if(!B.response)throw new Error("e.response parameter is missing");var t=A.parseBuffer(B.response),r=t.fetch("tfhd");r.track_ID=B.request.mediaInfo.index+1;var n=t.fetch("tfdt"),o=t.fetch("traf");n===null&&((n=A.createFullBox("tfdt",o,r)).version=1,n.flags=0,n.baseMediaDecodeTime=Math.floor(B.request.startTime*B.request.timescale));var s=t.fetch("tfrf");z(B.request,s,n,e),s&&(s._parent.boxes.splice(s._parent.boxes.indexOf(s),1),s=null)},getType:function(){return v}},d=K.getLogger(m),v="",m}he.__dashjs_factory_name="MssFragmentMoofProcessor";var qe=dashjs.FactoryMaker.getClassFactory(he);function be(h){var m,v,d,w,p,S,P=(h=h||{}).constants,A=h.ISOBoxer,K=h.protectionController;function z(e,t){A.createBox("frma",e).data_format=function(r){var n,o=0;for(n=0;n<r.length;n+=1)o|=r.charCodeAt(n)<<8*(r.length-n-1);return o}(t)}function Y(e){var t=A.createFullBox("schm",e);t.flags=0,t.version=0,t.scheme_type=1667591779,t.scheme_version=65536}function M(e){var t,r;t=A.createBox("schi",e),(r=A.createFullBox("tenc",t)).flags=0,r.version=0,r.default_IsEncrypted=1,r.default_IV_size=8,r.default_KID=w&&w.length>0&&w[0]["cenc:default_KID"]?w[0]["cenc:default_KID"]:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}function B(e){var t,r=new Uint8Array(e.length/2);for(t=0;t<e.length/2;t+=1)r[t]=parseInt(""+e[2*t]+e[2*t+1],16);return r}return{generateMoov:function(e){var t;if(e&&e.adaptation)return v=(d=e).adaptation,m=v.period,S=v.index+1,w=m.mpd.manifest.Period_asArray[m.index].AdaptationSet_asArray[v.index].ContentProtection,p=m.mpd.manifest.Period_asArray[m.index].AdaptationSet_asArray[v.index].SegmentTemplate.timescale,function(r){var n=A.createBox("ftyp",r);n.major_brand="iso6",n.minor_version=1,n.compatible_brands=[],n.compatible_brands[0]="isom",n.compatible_brands[1]="iso6",n.compatible_brands[2]="msdh"}(t=A.createFile()),function(r){var n=A.createBox("moov",r);(function(f){var u=A.createFullBox("mvhd",f);u.version=1,u.creation_time=0,u.modification_time=0,u.timescale=p,u.duration=m.duration===1/0?18446744073709552e3:Math.round(m.duration*p),u.rate=1,u.volume=1,u.reserved1=0,u.reserved2=[0,0],u.matrix=[1,0,0,0,1,0,0,0,16384],u.pre_defined=[0,0,0,0,0,0],u.next_track_ID=S+1})(n);var o=A.createBox("trak",n);(function(f){var u=A.createFullBox("tkhd",f);u.version=1,u.flags=7,u.creation_time=0,u.modification_time=0,u.track_ID=S,u.reserved1=0,u.duration=m.duration===1/0?18446744073709552e3:Math.round(m.duration*p),u.reserved2=[0,0],u.layer=0,u.alternate_group=0,u.volume=1,u.reserved3=0,u.matrix=[1,0,0,0,1,0,0,0,16384],u.width=d.width,u.height=d.height})(o);var s=A.createBox("mdia",o);(function(f){var u=A.createFullBox("mdhd",f);u.version=1,u.creation_time=0,u.modification_time=0,u.timescale=p,u.duration=m.duration===1/0?18446744073709552e3:Math.round(m.duration*p),u.language=v.lang||"und",u.pre_defined=0})(s),function(f){var u=A.createFullBox("hdlr",f);switch(u.pre_defined=0,v.type){case P.VIDEO:u.handler_type="vide";break;case P.AUDIO:u.handler_type="soun";break;default:u.handler_type="meta"}u.name=d.id,u.reserved=[0,0,0]}(s);var i=A.createBox("minf",s);switch(v.type){case P.VIDEO:(function(f){var u=A.createFullBox("vmhd",f);u.flags=1,u.graphicsmode=0,u.opcolor=[0,0,0]})(i);break;case P.AUDIO:(function(f){var u=A.createFullBox("smhd",f);u.flags=1,u.balance=0,u.reserved=0})(i)}(function(f){var u=A.createFullBox("dref",f);u.entry_count=1,u.entries=[];var y=A.createFullBox("url ",u,!1);y.location="",y.flags=1,u.entries.push(y)})(A.createBox("dinf",i));var a=A.createBox("stbl",i);A.createFullBox("stts",a)._data=[0,0,0,0,0,0,0,0],A.createFullBox("stsc",a)._data=[0,0,0,0,0,0,0,0],A.createFullBox("stco",a)._data=[0,0,0,0,0,0,0,0],A.createFullBox("stsz",a)._data=[0,0,0,0,0,0,0,0,0,0,0,0],function(f){var u=A.createFullBox("stsd",f);switch(u.entries=[],v.type){case P.VIDEO:case P.AUDIO:u.entries.push(function(y){var E=d.codecs.substring(0,d.codecs.indexOf("."));switch(E){case"avc1":return function(b,O){var N;if((N=w?A.createBox("encv",b,!1):A.createBox("avc1",b,!1)).reserved1=[0,0,0,0,0,0],N.data_reference_index=1,N.pre_defined1=0,N.reserved2=0,N.pre_defined2=[0,0,0],N.height=d.height,N.width=d.width,N.horizresolution=72,N.vertresolution=72,N.reserved3=0,N.frame_count=1,N.compressorname=[10,65,86,67,32,67,111,100,105,110,103,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],N.depth=24,N.pre_defined3=65535,N.config=function(){for(var C,l=null,I=15,D=[],k=[],te=0,J=0,G=0,Q=d.codecPrivateData.split("00000001").slice(1),ie=0;ie<Q.length;ie++)switch(31&(C=B(Q[ie]))[0]){case 7:D.push(C),I+=C.length+2;break;case 8:k.push(C),I+=C.length+2}D.length>0&&(te=D[0][1],G=D[0][2],J=D[0][3]);var q=0;(l=new Uint8Array(I))[q++]=(4278190080&I)>>24,l[q++]=(16711680&I)>>16,l[q++]=(65280&I)>>8,l[q++]=255&I,l.set([97,118,99,67],q),q+=4,l[q++]=1,l[q++]=te,l[q++]=G,l[q++]=J,l[q++]=255,l[q++]=224|D.length;for(var ne=0;ne<D.length;ne++)l[q++]=(65280&D[ne].length)>>8,l[q++]=255&D[ne].length,l.set(D[ne],q),q+=D[ne].length;l[q++]=k.length;for(var F=0;F<k.length;F++)l[q++]=(65280&k[F].length)>>8,l[q++]=255&k[F].length,l.set(k[F],q),q+=k[F].length;return l}(),w){var _=A.createBox("sinf",N);z(_,O),Y(_),M(_)}return N}(y,E);case"mp4a":return function(b,O){var N,_,C,l,I;if((N=w?A.createBox("enca",b,!1):A.createBox("mp4a",b,!1)).reserved1=[0,0,0,0,0,0],N.data_reference_index=1,N.reserved2=[0,0],N.channelcount=d.audioChannels,N.samplesize=16,N.pre_defined=0,N.reserved_3=0,N.samplerate=d.audioSamplingRate<<16,N.esds=(C=34+(_=B(d.codecPrivateData)).length,I=0,(l=new Uint8Array(C))[I++]=(4278190080&C)>>24,l[I++]=(16711680&C)>>16,l[I++]=(65280&C)>>8,l[I++]=255&C,l.set([101,115,100,115],I),I+=4,l.set([0,0,0,0],I),I+=4,l[I++]=3,l[I++]=20+_.length,l[I++]=(65280&S)>>8,l[I++]=255&S,l[I++]=0,l[I++]=4,l[I++]=15+_.length,l[I++]=64,l[I]=20,l[I]|=0,l[I++]|=1,l[I++]=255,l[I++]=255,l[I++]=255,l[I++]=(4278190080&d.bandwidth)>>24,l[I++]=(16711680&d.bandwidth)>>16,l[I++]=(65280&d.bandwidth)>>8,l[I++]=255&d.bandwidth,l[I++]=(4278190080&d.bandwidth)>>24,l[I++]=(16711680&d.bandwidth)>>16,l[I++]=(65280&d.bandwidth)>>8,l[I++]=255&d.bandwidth,l[I++]=5,l[I++]=_.length,l.set(_,I),l),w){var D=A.createBox("sinf",N);z(D,O),Y(D),M(D)}return N}(y,E);default:throw{code:g.MSS_UNSUPPORTED_CODEC_CODE,message:g.MSS_UNSUPPORTED_CODEC_MESSAGE,data:{codec:E}}}}(u))}u.entry_count=u.entries.length}(a),function(f){var u=A.createFullBox("trex",f);u.track_ID=S,u.default_sample_description_index=1,u.default_sample_duration=0,u.default_sample_size=0,u.default_sample_flags=0}(A.createBox("mvex",n)),w&&K&&function(f,u){var y,E,b;for(b=0;b<u.length;b+=1)(y=u[b].initData)&&(E=A.parseBuffer(y).fetch("pssh"))&&A.Utils.appendBox(f,E)}(n,K.getSupportedKeySystemsFromContentProtection(w))}(t),t.write()}}}be.__dashjs_factory_name="MssFragmentMoovProcessor";var xe=dashjs.FactoryMaker.getClassFactory(be);function ge(h,m){return h.length===m.length&&h.every(function(v,d){return v===m[d]})}function Be(){this._procFullBox(),1&this.flags&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("entry_count","uint",32),this._procFieldArray("offset",this.entry_count,"uint",this.version===1?64:32)}function Ue(){this._procFullBox(),1&this.flags&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("default_sample_info_size","uint",8),this._procField("sample_count","uint",32),this.default_sample_info_size===0&&this._procFieldArray("sample_info_size",this.sample_count,"uint",8)}function Se(){this._procFullBox(),this._procField("sample_count","uint",32),1&this.flags&&this._procField("IV_size","uint",8),this._procEntries("entry",this.sample_count,function(h){this._procEntryField(h,"InitializationVector","data",8),2&this.flags&&(this._procEntryField(h,"NumberOfEntries","uint",16),this._procSubEntries(h,"clearAndCryptedData",h.NumberOfEntries,function(m){this._procEntryField(m,"BytesOfClearData","uint",16),this._procEntryField(m,"BytesOfEncryptedData","uint",32)}))})}function Ge(){ge(this.usertype,[109,29,155,5,66,213,68,230,128,226,20,29,175,247,87,178])&&(this._procFullBox(),this._parsing&&(this.type="tfxd"),this._procField("fragment_absolute_time","uint",this.version===1?64:32),this._procField("fragment_duration","uint",this.version===1?64:32)),ge(this.usertype,[212,128,126,242,202,57,70,149,142,84,38,203,158,70,167,159])&&(this._procFullBox(),this._parsing&&(this.type="tfrf"),this._procField("fragment_count","uint",8),this._procEntries("entry",this.fragment_count,function(h){this._procEntryField(h,"fragment_absolute_time","uint",this.version===1?64:32),this._procEntryField(h,"fragment_duration","uint",this.version===1?64:32)})),ge(this.usertype,[162,57,79,82,90,155,79,20,162,68,108,66,124,100,141,244])&&(this._parsing&&(this.type="sepiff"),Se.call(this))}function Ie(h){h=h||{};var m,v,d,w=this.context,p=h.dashMetrics,S=h.playbackController,P=h.eventBus,A=h.protectionController,K=h.ISOBoxer,z=h.debug;return d={generateMoov:function(Y){return m.generateMoov(Y)},processFragment:function(Y,M){if(!Y||!Y.request||!Y.response)throw new Error("e parameter is missing or malformed");Y.request.type==="MediaSegment"?v.convertFragment(Y,M):Y.request.type===U.MSS_FRAGMENT_INFO_SEGMENT_TYPE&&(v.updateSegmentList(Y,M),Y.sender=null)}},K.addBoxProcessor("uuid",Ge),K.addBoxProcessor("saio",Be),K.addBoxProcessor("saiz",Ue),K.addBoxProcessor("senc",Se),m=xe(w).create({protectionController:A,constants:h.constants,ISOBoxer:K}),v=qe(w).create({dashMetrics:p,playbackController:S,ISOBoxer:K,eventBus:P,debug:z,errHandler:h.errHandler}),d}Ie.__dashjs_factory_name="MssFragmentProcessor";var ke=dashjs.FactoryMaker.getClassFactory(Ie),je=ee(2214),pe=ee.n(je);function me(h){var m,v,d,w=(h=h||{}).BASE64,p=h.debug,S=h.constants,P=h.manifestModel,A=h.settings,K=["AAC","AACL","AACH","AACP","AVC1","H264","TTML","DFXP"],z={CAPT:"main",SUBT:"alternate",DESC:"main"},Y={DESC:"2"},M={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12},B={video:"video/mp4",audio:"audio/mp4",text:"application/mp4"};function e(s,i){var a=s.getAttribute(i);return!!a&&a.toLowerCase()==="true"}function t(s,i){var a,f,u,y,E,b={},O=[],N=s.getAttribute("Name"),_=s.getAttribute("Type"),C=s.getAttribute("Language"),l=C?_+"_"+C:_;if(b.id=N||l,b.contentType=_,b.lang=C||"und",b.mimeType=B[_],b.subType=s.getAttribute("Subtype"),b.maxWidth=s.getAttribute("MaxWidth"),b.maxHeight=s.getAttribute("MaxHeight"),b.subType){if(z[b.subType]){var I={schemeIdUri:"urn:mpeg:dash:role:2011",value:z[b.subType]};b.Role=I,b.Role_asArray=[I]}if(Y[b.subType]){var D={schemeIdUri:"urn:tva:metadata:cs:AudioPurposeCS:2007",value:Y[b.subType]};b.Accessibility=D,b.Accessibility_asArray=[D]}}for(a=function(k,te){var J,G,Q,ie={};return J=(J=(Q=k.getAttribute("Url"))?Q.replace("{bitrate}","$Bandwidth$"):null)?J.replace("{start time}","$Time$"):null,G=(G=k.getAttribute("TimeScale"))?parseFloat(G):te,ie.media=J,ie.timescale=G,ie.SegmentTimeline=function(q,ne){var F,L,W,H,re,R,V={},we=q.getElementsByTagName("c"),ce=[],X=0;for(H=0;H<we.length;H++)if(F={},(W=we[H].getAttribute("t"))&&pe()(W).greater(pe()(Number.MAX_SAFE_INTEGER))&&(F.tManifest=W),F.t=parseFloat(W),F.d=parseFloat(we[H].getAttribute("d")),H!==0||F.t||(F.t=0),H>0&&((L=ce[ce.length-1]).d||(L.tManifest?L.d=pe()(W).subtract(pe()(L.tManifest)).toJSNumber():L.d=F.t-L.t,X+=L.d),F.t||(L.tManifest?(F.tManifest=pe()(L.tManifest).add(pe()(L.d)).toString(),F.t=parseFloat(F.tManifest)):F.t=L.t+L.d)),F.d&&(X+=F.d),ce.push(F),R=parseFloat(we[H].getAttribute("r")))for(re=0;re<R-1;re++)L=ce[ce.length-1],(F={}).t=L.t+L.d,F.d=L.d,L.tManifest&&(F.tManifest=pe()(L.tManifest).add(pe()(L.d)).toString()),X+=F.d,ce.push(F);return V.S=ce,V.S_asArray=ce,V.duration=X/ne,V}(k,ie.timescale),ie.availabilityTimeOffset="INF",ie}(s,i),f=s.getElementsByTagName("QualityLevel"),y=0;y<f.length;y++)f[y].BaseURL=b.BaseURL,f[y].mimeType=b.mimeType,E=f[y].getAttribute("Index"),f[y].Id=b.id+(E!==null?"_"+E:""),(u=r(f[y],s))!==null&&(u.SegmentTemplate=a,O.push(u));return O.length===0?null:(b.Representation=O.length>1?O:O[0],b.Representation_asArray=O,b.SegmentTemplate=a,b)}function r(s,i){var a,f,u={},y=i.getAttribute("Type"),E=null;if(u.id=s.Id,u.bandwidth=parseInt(s.getAttribute("Bitrate"),10),u.mimeType=s.mimeType,a=parseInt(s.getAttribute("MaxWidth"),10),f=parseInt(s.getAttribute("MaxHeight"),10),isNaN(a)||(u.width=a),isNaN(f)||(u.height=f),(E=s.getAttribute("FourCC"))!==null&&E!==""||(E=i.getAttribute("FourCC")),E===null||E===""){if(y===S.AUDIO)E="AAC";else if(y===S.VIDEO)return v.debug('FourCC is not defined whereas it is required for a QualityLevel element for a StreamIndex of type "video"'),null}return K.indexOf(E.toUpperCase())===-1?(v.warn("Codec not supported: "+E),null):(E==="H264"||E==="AVC1"?u.codecs=function(b){var O,N=b.getAttribute("CodecPrivateData").toString();return"avc1."+((O=/00000001[0-9]7/.exec(N))&&O[0]?N.substr(N.indexOf(O[0])+10,6):void 0)}(s):E.indexOf("AAC")>=0?(u.codecs=function(b,O){var N,_,C,l,I=parseInt(b.getAttribute("SamplingRate"),10),D=b.getAttribute("CodecPrivateData").toString(),k=0;return O==="AACH"&&(k=5),D===void 0||D===""?(k=2,C=M[I],O==="AACH"?(k=5,D=new Uint8Array(4),l=M[2*I],D[0]=k<<3|C>>1,D[1]=C<<7|b.Channels<<3|l>>1,D[2]=l<<7|8,D[3]=0,(_=new Uint16Array(2))[0]=(D[0]<<8)+D[1],_[1]=(D[2]<<8)+D[3],N=_[0].toString(16),N=_[0].toString(16)+_[1].toString(16)):((D=new Uint8Array(2))[0]=k<<3|C>>1,D[1]=C<<7|parseInt(b.getAttribute("Channels"),10)<<3,(_=new Uint16Array(1))[0]=(D[0]<<8)+D[1],N=_[0].toString(16)),D=(D=""+N).toUpperCase(),b.setAttribute("CodecPrivateData",D)):k===0&&(k=(248&parseInt(D.substr(0,2),16))>>3),"mp4a.40."+k}(s,E),u.audioSamplingRate=parseInt(s.getAttribute("SamplingRate"),10),u.audioChannels=parseInt(s.getAttribute("Channels"),10)):(E.indexOf("TTML")||E.indexOf("DFXP"))&&(u.codecs=S.STPP),u.codecPrivateData=""+s.getAttribute("CodecPrivateData"),u.BaseURL=s.BaseURL,u)}function n(s,i,a){var f=s[i];s[i]=s[a],s[a]=f}function o(s){var i,a,f,u,y,E,b,O,N,_,C,l={},I=[],D=s.getElementsByTagName("SmoothStreamingMedia")[0],k=s.getElementsByTagName("Protection")[0],te=null;l.protocol="MSS",l.profiles="urn:mpeg:dash:profile:isoff-live:2011",l.type=e(D,"IsLive")?"dynamic":"static",O=D.getAttribute("TimeScale"),l.timescale=O?parseFloat(O):1e7;var J=parseFloat(D.getAttribute("DVRWindowLength"));l.type!=="dynamic"||J!==0&&!isNaN(J)||(J=1/0),J===0&&e(D,"CanSeek")&&(J=1/0),J>0&&(l.timeShiftBufferDepth=J/l.timescale);var G=parseFloat(D.getAttribute("Duration"));for(l.mediaPresentationDuration=G===0?1/0:G/l.timescale,l.minBufferTime=2,l.ttmlTimeIsRelative=!0,l.type==="dynamic"&&G>0&&(l.type="static",l.timeShiftBufferDepth=G/l.timescale),l.type==="dynamic"&&(l.refreshManifestOnSwitchTrack=!0,l.doNotUpdateDVRWindowOnBufferUpdated=!0,l.ignorePostponeTimePeriod=!0,l.availabilityStartTime=new Date(null)),l.Period=function(L,W){var H,re,R={AdaptationSet_asArray:[]};H=L.getElementsByTagName("StreamIndex");for(var V=0;V<H.length;V++)(re=t(H[V],W))!==null&&R.AdaptationSet_asArray.push(re);return R.AdaptationSet_asArray.length>0&&(R.AdaptationSet=R.AdaptationSet_asArray.length>1?R.AdaptationSet_asArray:R.AdaptationSet_asArray[0]),R}(D,l.timescale),l.Period_asArray=[l.Period],(i=l.Period).start=0,k!==void 0&&((te=s.getElementsByTagName("ProtectionHeader")[0]).firstChild.data=te.firstChild.data.replace(/\n|\r/g,""),u=function(L){var W,H,re;return(W=function(R){var V,we,ce,X=0;for(R[X+3],R[X+2],R[X+1],R[X],R[(X+=4)+1],R[X],X+=2;X<R.length;)if(V=(R[X+1]<<8)+R[X],X+=2,V===1)return we=(R[X+1]<<8)+R[X],X+=2,(ce=new Uint8Array(we)).set(R.subarray(X,X+we)),ce;return null}(w.decodeArray(L.firstChild.data)))&&(W=new Uint16Array(W.buffer),W=String.fromCharCode.apply(null,W),H=new DOMParser().parseFromString(W,"application/xml").querySelector("KID").textContent,n(re=H=w.decodeArray(H),0,3),n(re,1,2),n(re,4,5),n(re,6,7)),H}(te),f=function(L){var W={__text:L.firstChild.data,__prefix:"mspr"};return{schemeIdUri:"urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95",value:"com.microsoft.playready",pro:W,pro_asArray:W}}(te),f["cenc:default_KID"]=u,I.push(f),f=function(L){var W={schemeIdUri:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",value:"com.widevine.alpha"};if(!L)return W;var H=new Uint8Array(2+L.length);H[0]=18,H[1]=16,H.set(L,2);var re=32+H.length,R=new Uint8Array(re),V=0;return R[V++]=(4278190080&re)>>24,R[V++]=(16711680&re)>>16,R[V++]=(65280&re)>>8,R[V++]=255&re,R.set([112,115,115,104,0,0,0,0],V),V+=8,R.set([237,239,139,169,121,214,74,206,163,200,39,220,213,29,33,237],V),V+=16,R[V++]=(4278190080&H.length)>>24,R[V++]=(16711680&H.length)>>16,R[V++]=(65280&H.length)>>8,R[V++]=255&H.length,R.set(H,V),R=String.fromCharCode.apply(null,R),R=w.encodeASCII(R),W.pssh={__text:R},W}(u),f["cenc:default_KID"]=u,I.push(f),l.ContentProtection=I,l.ContentProtection_asArray=I),a=i.AdaptationSet_asArray,_=0;_<a.length;_+=1)a[_].SegmentTemplate.initialization="$Bandwidth$",l.ContentProtection!==void 0&&(a[_].ContentProtection=l.ContentProtection,a[_].ContentProtection_asArray=l.ContentProtection_asArray),a[_].contentType==="video"&&(N=a[_].SegmentTemplate.SegmentTimeline.S_asArray[0].d/a[_].SegmentTemplate.timescale,l.minBufferTime=N,l.type==="dynamic"&&l.timeShiftBufferDepth>0&&l.timeShiftBufferDepth!==1/0&&l.timeShiftBufferDepth>a[_].SegmentTemplate.SegmentTimeline.duration&&(l.timeShiftBufferDepth=a[_].SegmentTemplate.SegmentTimeline.duration));if(l.minBufferTime=Math.min(l.minBufferTime,l.timeShiftBufferDepth?l.timeShiftBufferDepth:1/0),l.type==="dynamic"){var Q=A.get().streaming.delay.liveDelay;Q||(Q=N*(A.get().streaming.delay.liveDelayFragmentCount===null||isNaN(A.get().streaming.delay.liveDelayFragmentCount)?4:A.get().streaming.delay.liveDelayFragmentCount));var ie=Math.max(l.timeShiftBufferDepth-10,l.timeShiftBufferDepth/2),q=Math.min(ie,Q),ne=q-1.5*N;d={streaming:{buffer:{stableBufferTime:A.get().streaming.buffer.stableBufferTime,bufferTimeAtTopQuality:A.get().streaming.buffer.bufferTimeAtTopQuality,bufferTimeAtTopQualityLongForm:A.get().streaming.buffer.bufferTimeAtTopQualityLongForm},timeShiftBuffer:{calcFromSegmentTimeline:A.get().streaming.timeShiftBuffer.calcFromSegmentTimeline},delay:{liveDelay:A.get().streaming.delay.liveDelay}}},A.update({streaming:{buffer:{stableBufferTime:ne,bufferTimeAtTopQuality:ne,bufferTimeAtTopQualityLongForm:ne},timeShiftBuffer:{calcFromSegmentTimeline:!0},delay:{liveDelay:q}}})}if(delete l.ContentProtection,delete l.ContentProtection_asArray,l.type==="static"){var F=P.getValue();if(F&&F.timestampOffset)y=F.timestampOffset;else for(_=0;_<a.length;_++)a[_].contentType!==S.AUDIO&&a[_].contentType!==S.VIDEO||(E=(b=a[_].SegmentTemplate.SegmentTimeline.S_asArray)[0].t,y===void 0&&(y=E),y=Math.min(y,E),l.mediaPresentationDuration=Math.min(l.mediaPresentationDuration,a[_].SegmentTemplate.SegmentTimeline.duration));if(y>0){for(l.timestampOffset=y,_=0;_<a.length;_++){for(b=a[_].SegmentTemplate.SegmentTimeline.S_asArray,C=0;C<b.length;C++)b[C].tManifest||(b[C].tManifest=b[C].t.toString()),b[C].t-=y;a[_].contentType!==S.AUDIO&&a[_].contentType!==S.VIDEO||(i.start=Math.max(b[0].t,i.start),a[_].SegmentTemplate.presentationTimeOffset=i.start)}i.start/=l.timescale}}return l.mediaPresentationDuration=Math.floor(1e3*l.mediaPresentationDuration)/1e3,i.duration=l.mediaPresentationDuration,l}return m={parse:function(s){var i,a,f=window.performance.now();i=function(E){var b=null;if(window.DOMParser&&(b=new window.DOMParser().parseFromString(E,"text/xml")).getElementsByTagName("parsererror").length>0)throw new Error("parsing the manifest failed");return b}(s);var u=window.performance.now();if(i===null)return null;a=o(i);var y=window.performance.now();return v.info("Parsing complete: (xmlParsing: "+(u-f).toPrecision(3)+"ms, mss2dash: "+(y-u).toPrecision(3)+"ms, total: "+((y-f)/1e3).toPrecision(3)+"s)"),a},getMatchers:function(){return null},getIron:function(){return null},reset:function(){d&&A.update(d)}},v=p.getLogger(m),m}me.__dashjs_factory_name="MssParser";var ve=dashjs.FactoryMaker.getClassFactory(me);function Fe(h){h=h||{};var m,v,d,w,p=this.context,S=h.eventBus,P=h.events,A=h.constants,K=h.initSegmentType,z=h.playbackController,Y=h.streamController;function M(i){return Y.getActiveStreamProcessors().filter(function(a){return a.getType()===i})[0]}function B(i){return d.filter(function(a){return a.getType()===i})[0]}function e(){Y.getActiveStreamProcessors().forEach(function(i){if(i.getType()===A.VIDEO||i.getType()===A.AUDIO||i.getType()===A.TEXT){var a=B(i.getType());a||((a=Z(p).create({streamProcessor:i,baseURLController:h.baseURLController,debug:h.debug})).initialize(),d.push(a)),a.start()}})}function t(i){var a=M(i.mediaType);if(a){var f=a.getRepresentationController().getCurrentRepresentation(),u=a.getMediaInfo(),y=new $;y.mediaType=f.adaptation.type,y.type=K,y.range=f.range,y.quality=f.index,y.mediaInfo=u,y.representationId=f.id;var E=function(b,O,N){var _=new j;return _.streamId=O,_.mediaInfo=b.mediaInfo,_.segmentType=b.type,_.start=b.startTime,_.duration=b.duration,_.end=_.start+_.duration,_.index=b.index,_.quality=b.quality,_.representationId=b.representationId,_.endFragment=N,_}(y,u.streamInfo.id,i.type!==P.FRAGMENT_LOADING_PROGRESS);try{E.bytes=v.generateMoov(f),S.trigger(P.INIT_FRAGMENT_LOADED,{chunk:E},{streamId:u.streamInfo.id,mediaType:f.adaptation.type})}catch(b){h.errHandler.error(new Ee(b.code,b.message,b.data))}i.sender=null}}function r(i){if(!i.error){var a=M(i.request.mediaType);if(a){if(v.processFragment(i,a),i.request.type===U.MSS_FRAGMENT_INFO_SEGMENT_TYPE){var f=B(i.request.mediaType);f&&f.fragmentInfoLoaded(i)}var u=i.request.mediaInfo.streamInfo.manifestInfo;u.isDynamic||u.dvrWindowSize===1/0||e()}}}function n(){z.getIsDynamic()&&z.getTime()!==0&&e()}function o(){z.getIsDynamic()&&z.getTime()!==0&&e()}function s(i){i&&i.data&&(i.data=i.data.replace(/http:\/\/www.w3.org\/2006\/10\/ttaf1/gi,"http://www.w3.org/ns/ttml"))}return w={reset:function(){m&&(m.reset(),m=void 0),S.off(P.INIT_FRAGMENT_NEEDED,t,this),S.off(P.PLAYBACK_PAUSED,n,this),S.off(P.PLAYBACK_SEEKING,o,this),S.off(P.FRAGMENT_LOADING_COMPLETED,r,this),S.off(P.TTML_TO_PARSE,s,this),d.forEach(function(i){i.reset()}),d=[]},createMssParser:function(){return m=ve(p).create(h)},createMssFragmentProcessor:function(){v=ke(p).create(h)},registerEvents:function(){S.on(P.INIT_FRAGMENT_NEEDED,t,w,{priority:dashjs.FactoryMaker.getSingletonFactoryByName(S.getClassName()).EVENT_PRIORITY_HIGH}),S.on(P.PLAYBACK_PAUSED,n,w,{priority:dashjs.FactoryMaker.getSingletonFactoryByName(S.getClassName()).EVENT_PRIORITY_HIGH}),S.on(P.PLAYBACK_SEEKING,o,w,{priority:dashjs.FactoryMaker.getSingletonFactoryByName(S.getClassName()).EVENT_PRIORITY_HIGH}),S.on(P.FRAGMENT_LOADING_COMPLETED,r,w,{priority:dashjs.FactoryMaker.getSingletonFactoryByName(S.getClassName()).EVENT_PRIORITY_HIGH}),S.on(P.TTML_TO_PARSE,s,w)}},d=[],w}Fe.__dashjs_factory_name="MssHandler";var Ne=dashjs.FactoryMaker.getClassFactory(Fe);Ne.errors=g,dashjs.FactoryMaker.updateClassFactory(Fe.__dashjs_factory_name,Ne);var fe=Ne,Ae=typeof window<"u"&&window||ee.g,se=Ae.dashjs;se||(se=Ae.dashjs={}),se.MssHandler=fe;var Ye=se}(),Me.default}()})})(Ve);var Ke=Ve.exports;const Je=ze(Ke),Qe=Ze({__proto__:null,default:Je},[Ke]);export{Qe as d};
