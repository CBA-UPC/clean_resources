if(!Function.prototype.bind){Function.prototype.bind=}
var _trbo_namespaces,$jTrbo;"use strict";if(typeof _trbo_namespaces=='undefined'){_trbo_namespaces={};}
var _trbo;if(typeof _trbo=='undefined'){var _trbo_start=function(){var require=function(name){if(typeof _trbo.loadedModules[name]=='undefined'){if(typeof _trbo.modules[name]=='undefined'){throw Error('module "'+name+'" not found');}
_trbo.loadedModules[name]=_trbo.modules[name].module();}
return _trbo.loadedModules[name];}
_trbo={modules:{},loadedModules:{}}
_trbo_namespaces._trbo=_trbo;_trbo.require=require;_trbo.modules['Application']={module:function(){var module={exports:function(){console.log('bad module Application.js');}};"use strict";var EventDispatcher=require('EventDispatcher'),Tracker=require('tracking/Tracker'),PageListenerV2=require('tracking/PageListenerV2'),CompatibilityListener=require('tracking/CompatibilityListener'),ConversionListener=require('tracking/ConversionListener'),ProductViewListener=require('tracking/ProductViewListener'),UserMatchingListener=require('tracking/UserMatchingListener'),DataMatchingListener=require('tracking/DataMatchingListener'),VolatileDataListener=require('tracking/VolatileDataListener'),CnectrListener=require('tracking/CnectrListener'),ProductActionListener=require('tracking/ProductActionListener'),SegmentDataListener=require('tracking/SegmentDataListener'),SegmentIdListener=require('tracking/SegmentIdListener'),TestingDataListener=require('tracking/TestingDataListener'),MailTriggerListener=require('tracking/MailTriggerListener'),ConsentListener=require('tracking/ConsentListener'),DatalayerMapper=require('tracking/DatalayerMapper'),LayerListener=require('tracking/LayerListener'),LayerProvider=require('layer/LayerProvider'),LayerApi=require('layer/LayerApi'),JsonpTrackerAdapter=require('tracking/JsonpTrackerAdapter'),Chatchamp=require('helper/Chatchamp'),Trboq=require('Trboq'),TrbojQuery=require('lib/jTrbo');var Application=function(opts){if(!opts.browser||!opts.config){throw new Error('application expects browser and config');}
this.opts=opts;this.eventDispatcher=new EventDispatcher(this.opts);this.trboq=new Trboq({eventDispatcher:this.eventDispatcher});this.tracker=new Tracker({adapter:opts.trackerAdapter,userDataProvider:opts.userDataProvider,eventDispatcher:this.eventDispatcher});this.jsonpAdapter=new JsonpTrackerAdapter({config:opts.config,browser:opts.userDataProvider.getBrowser()});this.tracker.setJsonpAdapter(this.jsonpAdapter);var layerProvider=new LayerProvider({browser:opts.browser,config:opts.config});this.layerApi=new LayerApi({userDataProvider:opts.userDataProvider,requestDataTransformer:opts.requestDataTransformer,layerProvider:layerProvider,eventDispatcher:this.eventDispatcher,subplugins:opts.config.subplugins,config:opts.config});this.datalayerMapper=new DatalayerMapper({Trboq:this.trboq});if(opts.config.externalShopConfig&&opts.config.externalShopConfig.partner_1){this.chatchamp=new Chatchamp(opts.config.externalShopConfig.partner_1);}
this.setupListeners();};Application.prototype.reloadApi=function(removeLayers,addPageViewEvent){removeLayers=(removeLayers===undefined)?true:removeLayers;addPageViewEvent=(addPageViewEvent===undefined)?true:addPageViewEvent;if(_trbo.app.blockRequest==true&&_trbo.app.opts.config.requestBlockTime){return;}
try{if(window._trbo.pluginConfig&&window._trbo.pluginConfig.preventApiReloadForce&&window._trbo.pluginConfig.preventApiReloadForce===true){return;}}catch(err){}
try{if(window._TrboCurrentBasket&&_TrboCurrentBasket.pushBasket){window._TrboCurrentBasket.pushBasket();}}catch(e){}
try{this.layerApi.disableTriggers();}catch(e){console.log("failed to disable triggers");}
jTrbo(document).trigger("trbo:reloadApi",[removeLayers,addPageViewEvent]);try{if(window._trbo&&window._trbo.app&&window._trbo.app.internalBeforeReloadApi){window._trbo.app.internalBeforeReloadApi.call();}}catch(e){}
try{if(window._trbo&&window._trbo.app&&window._trbo.app.beforeReloadApi){window._trbo.app.beforeReloadApi.call();}}catch(e){}
try{_trbo.udp.productListing.run();}catch(e){}
try{}catch(e){}
try{_trbo.udp.datalayerHelper.run();_trbo.udp.dynamicSegment.reRun();}catch(e){}
if(addPageViewEvent!==false){this.trboq.push(['pageView',{}]);}
if(removeLayers===true){this.removeLayer();}
if(window&&window._trbo_prevent_api_call_force&&window._trbo_prevent_api_call_force===true){}else if(typeof(_trbo)!=='undefined'&&_trbo.pluginConfig&&_trbo.pluginConfig.prevent_api_call_force&&_trbo.pluginConfig.prevent_api_call_force===true){}else{if(window._trbo&&window._trbo.app&&window._trbo.app.beforeReloadApiTimeout){var that=this;window.setTimeout(window._trbo.app.beforeReloadApiTimeout);}else{this.layerApi.makeRequest();this.layerApi.callLayer();}}};Application.prototype.removeLayer=Application.prototype.settingsListener=function(event){for(var key in event){if(key!='type'){this.opts.config[key]=event[key];}}};Application.prototype.setupListeners=function(){var listenerParams={tracker:this.tracker,config:this.opts.config,userDataProvider:this.opts.userDataProvider};this.listeners={};this.eventDispatcher.addListener('trackerCallback',this.jsonpAdapter.handleTrackingCallback.bind(this.jsonpAdapter));var pageListener=new PageListenerV2(listenerParams);this.listeners.pageListener=pageListener;this.eventDispatcher.addListener('pageView',pageListener.handlePageView.bind(pageListener));this.eventDispatcher.addListener('page',pageListener.handlePage.bind(pageListener));this.eventDispatcher.addListener('currentBasket',pageListener.handleCurrentBasket.bind(pageListener));var compatibilityListener=new CompatibilityListener(listenerParams);this.listeners.compatibilityListener=compatibilityListener;this.eventDispatcher.addListener('writeImage',compatibilityListener.handleWriteImage.bind(compatibilityListener));var conversionListener=new ConversionListener(listenerParams);this.listeners.conversionListener=conversionListener;this.eventDispatcher.addListener('sale',conversionListener.handle.bind(conversionListener));this.eventDispatcher.addListener('basket',conversionListener.handle.bind(conversionListener));this.eventDispatcher.addListener('lead',conversionListener.handle.bind(conversionListener));this.eventDispatcher.addListener('funnel',conversionListener.handle.bind(conversionListener));var userMatchingListener=new UserMatchingListener(listenerParams);this.listeners.userMatchingListener=userMatchingListener;this.eventDispatcher.addListener('userMatching',userMatchingListener.handle.bind(userMatchingListener));var dataMatchingListener=new DataMatchingListener(listenerParams);this.listeners.dataMatchingListener=dataMatchingListener;this.eventDispatcher.addListener('dataMatching',dataMatchingListener.handle.bind(dataMatchingListener));var volatileDataListener=new VolatileDataListener(listenerParams);this.listeners.volatileDataListener=volatileDataListener;this.eventDispatcher.addListener('volatileData',volatileDataListener.handle.bind(volatileDataListener));var cnectrListener=new CnectrListener(listenerParams);this.listeners.cnectrListener=cnectrListener;this.eventDispatcher.addListener('cnectrSegment',cnectrListener.handle.bind(cnectrListener));var productActionListener=new ProductActionListener(listenerParams);this.listeners.productActionListener=productActionListener;this.eventDispatcher.addListener('productLike',productActionListener.handle.bind(productActionListener));this.eventDispatcher.addListener('productDislike',productActionListener.handle.bind(productActionListener));var segmentDataListener=new SegmentDataListener(listenerParams);this.listeners.segmentDataListener=segmentDataListener;this.eventDispatcher.addListener('segmentData',segmentDataListener.handle.bind(segmentDataListener));var segmentIdListener=new SegmentIdListener(listenerParams);this.listeners.segmentIdListener=segmentIdListener;this.eventDispatcher.addListener('segmentId',segmentIdListener.handle.bind(segmentIdListener));var testingDataListener=new TestingDataListener(listenerParams);this.listeners.testingDataListener=testingDataListener;this.eventDispatcher.addListener('testingData',testingDataListener.handle.bind(testingDataListener));var mailTriggerListener=new MailTriggerListener(listenerParams);this.listeners.mailTriggerListener=mailTriggerListener;this.eventDispatcher.addListener('mailTrigger',mailTriggerListener.handle.bind(mailTriggerListener));var productViewListener=new ProductViewListener(listenerParams);this.listeners.productViewListener=productViewListener;this.eventDispatcher.addListener('productView',productViewListener.handle.bind(productViewListener));this.eventDispatcher.addListener('settings',this.settingsListener.bind(this));var layerListener=new LayerListener(listenerParams);this.listeners.layerListener=layerListener;this.eventDispatcher.addListener('layerView',layerListener.handleLayerView.bind(layerListener));this.eventDispatcher.addListener('layerErrorView',layerListener.handleLayerErrorView.bind(layerListener));this.eventDispatcher.addListener('layerProductView',layerListener.handleLayerProductView.bind(layerListener));this.eventDispatcher.addListener('layerCouponView',layerListener.handleLayerCouponView.bind(layerListener));this.eventDispatcher.addListener('layerClick',layerListener.handleLayerClick.bind(layerListener));this.eventDispatcher.addListener('layerCouponRedeem',layerListener.handleLayerCouponRedeem.bind(layerListener));this.eventDispatcher.addListener('api',layerListener.handleApiResponse.bind(layerListener));var consentListener=new ConsentListener(listenerParams);this.listeners.consentListener=consentListener;this.eventDispatcher.addListener('consent',consentListener.handle.bind(consentListener));};Application.prototype.run=function(){if(typeof _trboq!='undefined'){this.trboq.seed(_trboq);_trboq=this.trboq;}
var window=this.opts.browser.getWindow();if(typeof window.trbo_track_conversion!='undefined'){this.trboq.push([window.trbo_track_conversion.type,window.trbo_track_conversion]);}
if(typeof(_trbo)!=='undefined'&&_trbo.pluginConfig&&_trbo.pluginConfig.prevent_page_view&&_trbo.pluginConfig.prevent_page_view===true){}else{this.trboq.push(["pageView",{}]);}
this.trboq.run();this.trboq.wait=false;this.opts.userDataProvider.saveData();if(this.opts.config.apiBaseUrl){if(parseInt(this.opts.userDataProvider.config.shopId)===12950&&!document.body){_trboq_sleep_timeout=100;var that=this;setTimeout(function(){that.layerApi.makeContainer();},_trboq_sleep_timeout);}else{this.layerApi.makeContainer();}
if(window&&window._trbo_prevent_api_call&&window._trbo_prevent_api_call===true){}else if(typeof(_trbo)!=='undefined'&&_trbo.pluginConfig&&_trbo.pluginConfig.prevent_api_call&&_trbo.pluginConfig.prevent_api_call===true){}else{var run_delay=0;if(typeof _trboq_sleep_timeout!="undefined"){run_delay=parseInt(_trboq_sleep_timeout);}
if(run_delay<0||run_delay>2000){run_delay=0;}
var that=this;if(parseInt(this.opts.userDataProvider.config.shopId)==12437){}else{setTimeout(function(){that.layerApi.callLayer();},run_delay);}}}
this.datalayerMapper.run(this.opts.config);_trboq=this.trboq;};Application.prototype.reset=function(){localStorage.clear();var udp=this.opts.userDataProvider,userId=udp.getUser().userId,sessionId=udp.getSession().sessionId,b=this.opts.browser;b.setCookie('us_'+userId,'',-100000);b.setCookie('sess_'+sessionId,'',-100000);b.setCookie('usr','',-100000);b.setCookie('session','',-100000);b.setCookie('m','',-100000);this.opts.userDataProvider.data={};return'User reset. Reload the page please';};Application.prototype.expireSession=function(){var udp=this.opts.userDataProvider,session=udp.getSession(),b=this.opts.browser;session.sessionSummary.lastClickTime-=udp.config.sessionTimeout+1;udp.saveData();b.setCookie('session','',-100000);return'Session expired. Reload the page please';};Application.prototype.setLayerId=function(layerId){var b=this.opts.browser,udp=this.opts.userDataProvider;this.reset();b.setCookie(layerId+'_countdown','',-100000);b.setCookie(layerId+'_cd','',-100000);b.setCookie(layerId+'_compr','',-100000);udp.getSession().abGroup=1;udp.saveData();return'User reset and layer changed to '+layerId+'. Reload the page please';};Application.prototype.test=function(){if(this.opts.config.campaign&&this.opts.config.campaign.campaignId==0){console.warn('campaign is disabled');return false;}
if(!this.opts.browser.getWindow()){console.warn('DOM is not reachable');return false;}
var udp=this.opts.userDataProvider;if(!udp.data||!udp.data.session){console.warn('session was not started');return false;}
if(!udp.data.session.sessionSummary.pageViewCount){console.warn('session has zero page views');return false;}
return true;};Application.prototype.createInterval=function(fn,timeout,maxTimeout){let usedTimeout=0;if(!timeout){timeout=100;}
if(!maxTimeout){maxTimeout=2000;}
const intervalId=setInterval(function(){const fallbackValue=fn();usedTimeout+=timeout;if(usedTimeout>=maxTimeout||fallbackValue){clearInterval(intervalId);}},timeout);var removeFn=jTrbo(document).on("trbo:reloadApi",removeFn);}
module.exports=Application;return module.exports;}}
_trbo.modules['Bootstrap']={module:function(){var module={exports:function(){console.log('bad module Bootstrap.js');}};"use strict";var Application=require('Application'),Browser=require('Browser'),UserDataProvider=require('UserDataProvider'),RequestDataTransformer=require('layer/RequestDataTransformer'),ImgTagTrackerAdapter=require('tracking/ImgTagTrackerAdapter');var Bootstrap=function(){};Bootstrap.prototype.bootstrap=function(config,inject){this.config=config;inject=inject||{};config=config||{};var opts={config:config};opts.window=inject.window?inject.window:window;opts.browser=new Browser({window:opts.window,config:config});var userDataProvider=new UserDataProvider(opts),requestDataTransformer=new RequestDataTransformer(userDataProvider),trackerAdapter=inject.trackerAdapter?inject.trackerAdapter:new ImgTagTrackerAdapter({config:opts.config,browser:opts.browser}),appOpts={config:opts.config,browser:opts.browser,userDataProvider:userDataProvider,trackerAdapter:trackerAdapter,requestDataTransformer:requestDataTransformer};this.app=new Application(appOpts);return this.app;};module.exports=Bootstrap;return module.exports;}}
_trbo.modules['Browser']={module:function(){var module={exports:function(){console.log('bad module Browser.js');}};"use strict";var Helper=require('Helper');var Browser=function(opts){if(!opts.window){if(typeof window!=="undefined"){opts.window=window;}else{throw new Error('Browser expects opts.window object');}}
this.deviceData={type:'desktop',device:'desktop',os:"windows",isTouch:false};this.window=opts.window;this.config=opts.config?opts.config:{};this.cookiePrefix=(opts.config.cookiePrefix||"trbo")+'_';};Browser.prototype.getLocation=function(){return this.getWindow().location;};Browser.prototype.getNavigator=function(){return this.getWindow().navigator;};Browser.prototype.getDocument=Browser.prototype.getWindow=function(){return this.window;};Browser.prototype.isIE8=Browser.prototype.getLocalStorage=function(){try{return this.config.skipLocalStorage?false:this.window.localStorage;}catch(err){return false;}};Browser.prototype.setCookie=function(cName,value,expires){var document=this.getDocument(),location=this.window.location,today=new Date();today.setTime(today.getTime());var expireDate=new Date(today.getTime()+(expires*1000));if(typeof this.config.tld4Cookie!="undefined"&&location&&location.host&&location.host.indexOf(this.config.tld4Cookie)!=-1){document.cookie=this.cookiePrefix+cName+"="+encodeURIComponent(value)+"; path=/; domain="+this.config.tld4Cookie+" ; expires="+expireDate.toGMTString()+"; SameSite=None; Secure";}else{document.cookie=this.cookiePrefix+cName+"="+encodeURIComponent(value)+"; path=/; expires="+expireDate.toGMTString()+"; SameSite=None; Secure";}
jTrbo(document).trigger("Browser:Cookie:set",{name:this.cookiePrefix+cName,content:value,expires:expires});};Browser.prototype.readCookie=function(cookieName){var name=cookieName+"=",ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' '){c=c.substring(1);}
if(c.indexOf(name)==0){return c.substring(name.length,c.length);}}
return false;};Browser.prototype.getCookie=function(cName,usePrefix){try{if(typeof usePrefix==='undefined'){usePrefix=true;}else if(usePrefix!==false&&usePrefix!==true){usePrefix=true;}}catch(err){usePrefix=true;}
var document=this.getDocument();if(document.cookie.length>0){if(usePrefix){var cStart=document.cookie.indexOf(this.cookiePrefix+cName+"=");}else{var cStart=document.cookie.indexOf(cName+"=");}
if(cStart!=-1){cStart=cStart+this.cookiePrefix.length+cName.length+1;var cEnd=document.cookie.indexOf(";",cStart);if(cEnd==-1){cEnd=document.cookie.length;}
var _tmp_cookie_data=decodeURIComponent(document.cookie.substring(cStart,cEnd));if(cName==='usr'){if(_tmp_cookie_data.length===32){return _tmp_cookie_data;}else if(_tmp_cookie_data.length>32){if(_tmp_cookie_data.indexOf(';')===32){_tmp_cookie_data=_tmp_cookie_data.substr(0,32);return _tmp_cookie_data;}else{return false;}}else{}}
return _tmp_cookie_data;}}
return false;};Browser.prototype.getCookieRaw=function(cookieName){try{var name=cookieName+"=",ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' '){c=c.substring(1);}
if(c.indexOf(name)===0){return c.substring(name.length,c.length);}}
return"";}catch(err){return"";}}
Browser.prototype.getClosedModules=function(){var modules=[];if(document.cookie.length>0){var regExp=new RegExp(this.cookiePrefix+"([0-9]+)_compr[=1]","g");document.cookie.replace(regExp,function(match,group){modules.push(group);});}
return modules;};Browser.deviceMatches=[{'regex':'mobile|android|phone','device':'?','deviceType':'mobile','browserType':'?','os':'?'},{'regex':'^Mozilla\\/[0-9. ]+\\(iPad; .*Mac OS X.*AppleWebKit.*$','device':'ipad','deviceType':'tablet','browserType':'safari','os':'mac'},{'regex':'Opera\\/[0-9. ]+\\(iPad[0-9]?; Opera Mini.*','device':'ipad','deviceType':'tablet','browserType':'opera','os':'mac'},{'regex':'^[a-zA-Z]+\\/[0-9. ]+.*Android.*Tablet.*$','device':'android','deviceType':'tablet','browserType':'android','os':'android'},{'regex':'Mozilla\\/[0-9. ]+ \\(iPhone;.*Mac OS X.*$','device':'iphone','deviceType':'mobile','browserType':'safari','os':'mac'},{'regex':'^Mozilla.*Linux.*Firefox.*$','device':'pc','deviceType':'desktop','browserType':'firefox','os':'linux'},{'regex':'^Mozilla.*Linux.*Chromium.*$','device':'pc','deviceType':'desktop','browserType':'chrome','os':'linux'},{'regex':'^Mozilla\/[0-9. ]+ \\(iPod;.*Mac OS X.*$','device':'ipod','deviceType':'mobile','browserType':'safari','os':'mac'},{'regex':'^Mozilla\/[0-9. ]+ \\(iPhone;.*Mac OS X.*$','device':'iphone','deviceType':'mobile','browserType':'safari','os':'mac'},{'regex':'^Opera\/[0-9. ]+ \\(iPhone.*$','device':'iphone','deviceType':'mobile','browserType':'safari','os':'mac'},{'regex':'^SonyEricsson.*$','device':'SonyEricsson','deviceType':'mobile','browserType':'?','os':'?'},{'regex':'^Mozilla\/[0-9. ]+ \\(Symbian.*Series[0-9]+.*Nokia.*$','device':'nokia','deviceType':'mobile','browserType':'?','os':'symbian'},{'regex':'^Mozilla\/[0-9. ]+ \\(Series[0-9]+.*Nokia.*$','device':'nokia','deviceType':'mobile','browserType':'?','os':'symbian'},{'regex':'^Mozilla\/[0-9. ]+ \\(SAMSUNG; SAMSUNG.*$','device':'samsung','deviceType':'mobile','browserType':'?','os':'?'},{'regex':'^Mozilla\/[0-9. ]+ \\(Linux.*Android [0-9]+.*Mobile Safari.*$','device':'android','deviceType':'mobile','browserType':'safari','os':'android'},{'regex':'^Mozilla\/[0-9. ]+ \\(Android; Mobile; rv.*Firefox.*$','device':'android','deviceType':'mobile','browserType':'firefox','os':'android'},{'regex':'^Mozilla\/[0-9. ]+ \\(compatible; MSIE [0-9]+.*Windows Phone.*IEMobile\/[0-9]+.*$','device':'windows','deviceType':'mobile','browserType':'ie','os':'windows'},{'regex':'^Opera\/[0-9. ]+ \\(Windows Mobile; WCE; Opera Mobi\/.*$','device':'windows','deviceType':'mobile','browserType':'opera','os':'windows'},{'regex':'^[a-zA-Z]+\/[0-9. ]+ \\(BlackBerry;.*$','device':'blackberry','deviceType':'mobile','browserType':'?','os':'blackberry'}];Browser.prototype.detectHasFlash=function(){try{return(this.getNavigator().plugins&&typeof this.getNavigator().plugins["Shockwave Flash"]=="object")||(this.getWindow().ActiveXObject&&(new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))!=false);}catch(e){return false;}};Browser.prototype.getViewport=function(){var window=this.getWindow(),document=window.document;if(window.innerWidth){return{width:window.innerWidth,height:window.innerHeight};}
if(document.compatMode==="CSS1Compat"){return{width:document.documentElement.clientWidth,height:document.documentElement.clientHeight}}
return{width:document.body.clientWidth,height:document.body.clientHeight};};Browser.prototype.getDeviceData=function(){var dm=Browser.deviceMatches,navigator=this.getNavigator(),dd=null;for(var i=0;i<dm.length;i++){var regex=new RegExp(dm[i].regex,'i');if(navigator.userAgent.match(regex)){dd=Helper.filterObject(dm[i],['device','deviceType','browserType','os']);break;}}
if(!dd){dd={'device':'','deviceType':'desktop','browserType':'','os':''};}
var viewport=this.getViewport();if(viewport.width<=640){dd.deviceType='mobile';}
dd.hasFlash=this.detectHasFlash();return dd;};Browser.prototype.parseUrlParams=function(query){var result={};if(typeof query!="undefined"&&query!=""){var chunks=query.split(/[&#]/);for(var i=0;i<chunks.length;i++){var parts=chunks[i].split('=');if(parts.length>=2){var key=parts.shift();result[key]=Helper.unescape(parts.join('=').replace(/\+/g,'%20'));}}}
return result;};Browser.prototype.getUrlParam=function(parameter,urlToUse){var parameters={},hash,url=urlToUse||document.location.href,hashes=url.slice(url.indexOf('?')+1).split('&');if(url.indexOf("?")>0){for(var i=0;i<hashes.length;i++){hash=hashes[i].split('=');try{parameters[decodeURIComponent(hash[0])]=decodeURIComponent(hash[1]);}catch(e){parameters[decodeURIComponent(hash[0])]=hash[1];}}}
if(parameter){return parameters[parameter]||"";}else{return parameters}};Browser.prototype.parseUrl=function(url){var regex=/^(http[s]?:\/\/)([^\/]+)[\/]?([^\?]*)[\?]?(.*)$/i,matched=url.match(regex);if(!matched){return null;}
var result={scheme:matched[1],domain:matched[2],path:matched[3],queryString:matched[4]};if(result.queryString){result.params=this.parseUrlParams(result.queryString);}
return result;};Browser.prototype.getJquery=function(){if(typeof this.window.$jTrbo!='undefined'){return this.window.$jTrbo;}else{return require('jquery')(this.window);}};Browser.prototype.log=function(priority,message){if(this.config.debugMode&&typeof console!='undefined'){if(typeof console[priority]=='function'){switch(priority){case'info':console.info(message);break;case'warn':console.warn(message);break;case'error':console.error(message);break;default:console.log(message);}}else{console.log('message with priority: '+priority);console.log(message);}}};Browser.prototype.detectDevice=function(){try{this.check_main_device();this.check_os();this.clean_up_deviceData();}catch(e){}
return this.deviceData;};Browser.prototype.check_main_device=function(){var me=this,found=false,navigator=this.getNavigator(),_device_matches={tablet:{"^Mozilla\/[0-9. ]+\\(iPad; .*Mac OS X.*AppleWebKit.*$":'ipad',"^Opera\/[0-9. ]+\\(iPad[0-9]?; Opera Mini.*$":'ipad',"^Mozilla\/[0-9. ]+.*compatible; MSIE [0-9.]+.*; Tablet PC [0-9.]+.*$":'msie',"^Mozilla\/[0-9. ]+.*Linux; Android [0-9.]+; X[0-9]+X Build.M.*Chrome.*Safari.*$":'android',"^Mozilla\/[0-9. ]+.*Linux; Android [0-9.]+; SM-T232.*Chrome.*Safari.*$":'android',"^Mozilla\/[0-9. ]+.*Linux;.*Android [0-9.]+; SM-T[0-9]+.*Chrome.*Safari.*$":'android',"^Mozilla\/[0-9. ]+.*Linux; Android [0-9.]+; Nexus 7.*Chrome.*Safari.*$":'android',"^Mozilla\/[0-9. ]+.*Linux; Android [0-9.]+; GT-P5210.*$":'android',"^Mozilla\/[0-9. ]+.*Linux;.*Android [0-9.]+;.*GT-P[0-9]+.*$":'android',"^Mozilla\/[0-9. ]+.*Linux; Android [0-9.]+; AGS-.*$":'android',"^Mozilla\/[0-9. ]+.*Linux;.*Android [0-9.]+;.*SAMSUNG SM-T.*$":'android',"^Mozilla\/[0-9. ]+.*Linux;.*Android [0-9.]+;.*SAMSUNG SM-P.*$":'android',".*Android.*SM-.*/":'android',"^Mozilla\/[0-9. ]+.*Linux;.*Android [0-9.]+;.*LIFETAB.*$":'android',"^Mozilla\/[0-9. ]+.*Linux;.*Android [0-9.]+;.*Mediapad.*$":'android',"^Mozilla\/[0-9. ]+.*Linux;.*Android [0-9.]+;.*Lenovo A[0-9]+-F.*$":'android',"^Mozilla\/[0-9. ]+.*Linux;.*Android [0-9.]+;.*Lenovo TAB.*$":'android',"^Mozilla\/[0-9. ]+.*Linux;.*Android [0-9.]+;.*SM-T[0-9]+ Build.*$":'android',"^Mozilla\/[0-9. ]+.*Linux;.*Android [0-9.]+; KF[A-Z]{2,4} Build\/[A-Z0-9]{5}.*Silk.*Chrome.*Safari.*$":'android',"^Mozilla\/[0-9. ]+.*iPad;.*$":'ipad',"^[a-zA-Z]+\/[0-9. ]+.*Android.*Tab.*$":'android'},mobile:{"^Mozilla\/[0-9. ]+ \\(iPod;.*Mac OS X.*$":'ipod',"^Mozilla\/[0-9. ]+ \\(iPhone;.*Mac OS X.*$":'iphone',"^Opera\/[0-9. ]+ \\(iPhone.*$":'iphone',"^SonyEricsson.*$/":'sonyericsson',"^Mozilla\/[0-9. ]+ \\(Symbian.*Series[0-9]+.*Nokia.*$/":'nokia',"^Mozilla\/[0-9. ]+ \\(Series[0-9]+.*Nokia.*$/":'nokia',"^Mozilla\/[0-9. ]+ \\(SAMSUNG; SAMSUNG.*$/":'samsung',"^Mozilla\/[0-9. ]+.*Linux; Android.*SAMSUNG.*$/":'samsung',"^Mozilla\/[0-9. ]+ \\(Linux.*Android [0-9]+.*Mobile Safari.*$":'android',"^Mozilla\/[0-9. ]+ \\(Android; Mobile; rv.*Firefox.*$/":'android',"^Mozilla\/[0-9. ]+ \\(Android [0-9.]+; Mobile; rv.*Firefox.*$/":'android',".*Android.*Mobile.*/":'android',"^Mozilla\/[0-9. ]+ \\(compatible; MSIE [0-9]+.*Windows Phone.*IEMobile\/[0-9]+.*$/":'windows',"^Opera\/[0-9. ]+ \\(Windows Mobile; WCE; Opera Mobi\/.*$/":'windows',"^Mozilla.*Linux.*Android.*$/":'android',"^[a-zA-Z]+\/[0-9. ]+ \\(BlackBerry;.*$":'blackberry',"^Mein%20o2.*CFNetwork.*Darwin.*$":'iphone'},console:{"^Mozilla\/[0-9. ]+ \\(playstation.*$":'playstation',"^Mozilla\/[0-9. ]+ \\(nintendo.*$":'nintendo'}};jTrbo.each(_device_matches,function(type,matches){if(!found){jTrbo.each(matches,function(regex,device){if(!found){if(navigator.userAgent.match(regex)){me.deviceData.type=type;me.deviceData.device=device;found=true;return false;}}});}});};Browser.prototype.check_os=function(){var me=this,navigator=this.getNavigator(),osMatches={"^.*Android.*$":'android',"^.*android.*$":'android',"^.*Mac OS.*$":'mac',"^.*Mac Os.*$":'mac',"^.*iPhone.*$":'ios',"^.*iPad.*$":'ios'};jTrbo.each(osMatches,function(regex,type){if(navigator.userAgent.match(regex)){me.deviceData.os=type;}});};Browser.prototype.clean_up_deviceData=function(){var isTouch=this.deviceData.isTouch=isTouch();if(this.deviceData.type==="desktop"&&this.deviceData.os==="mac"&&isTouch()){this.deviceData.type="tablet";this.deviceData.device="ipad";this.deviceData.os="ios";}};Browser.prototype.setLocalStorage=function(key,value){if(window._trbo.app.opts.config.skipLocalStorage===true){return false;}
window.localStorage.setItem(key,value);return true;};Browser.prototype.readLocalStorage=function(key,fallbackValue){const value=window.localStorage.getItem(key);if(value){return value;}
return fallbackValue;};module.exports=Browser;return module.exports;}}
_trbo.modules['ChannelAnalizer']={module:function(){var module={exports:function(){console.log('bad module ChannelAnalizer.js');}};"use strict";var Helper=require('Helper'),json=require('lib/JSON');var ChannelAnalizer=function(opts){this.opts=opts;};ChannelAnalizer.prototype.checkGoogle=function(cd){var isAdClick=false,pr=this.opts.browser.parseUrl(this.opts.browser.getDocument().referrer);if(pr&&pr.params){parameters=pr.params;}else{parameters=null;}
function referrFallback(){cd.isAdClick=false;cd.isReferrer=true;cd.category=pr.domain;cd.subcategory=pr.subcategory;}
if(!pr.domain){return;}
var isGoogleMatch=false;var google_regexes=[/^([a-z]*)\.google\.([a-z.]+)$/i,/(googleads).g.(doubleclick).net/];for(var i=0;i<google_regexes.length;i++){if(isGoogleMatch==true){continue;}
if(pr.domain.match(google_regexes[i])!=null){isGoogleMatch=true;}}
if(isGoogleMatch){if(parameters){if(typeof parameters.q!="undefined"){cd.keyword=Helper.unescape(parameters.q);}else if(typeof(parameters.as_q)){cd.keyword=Helper.unescape(parameters.as_q);}}
switch(pr.path){case'aclk':case'uds/afs':case'uds/afs/':cd.isAdClick=true;isAdClick=true;break;}
if(!isAdClick&&parameters){var _aclk_parameters=["adword","adurl","gclid"];for(var i=0;i<_aclk_parameters.length;i++){if(typeof parameters[_aclk_parameters[i]]!="undefined"&&parameters[_aclk_parameters[i]]!=""){cd.isAdClick=true;isAdClick=true;pr2cd();}}}}
if(!isAdClick&&isGoogleMatch){var googleRefPathRegexes=[/^products\?/i,/^imgres\?/i];var googleRefDomainRegexes=[/^docs.google.[a-z]+/i,/^images.google.[a-z]+/i,/^maps.google.[a-z]+/i];if(typeof pr.path!="undefined"&&pr.path!=""){for(var i=0;i<googleRefPathRegexes.length;i++){if(pr.path.match(googleRefPathRegexes[i])!=null){referrFallback();}}}
for(var i=0;i<googleRefDomainRegexes.length;i++){if(pr.domain.match(googleRefDomainRegexes[i])!=null){referrFallback();}}
if(typeof parameters!="undefined"&&parameters){if(typeof parameters.source!="undefined"&&parameters.source=="productsearch"){referrFallback();}}}
if(!cd.isAdClick&&!cd.isReferrer&&isGoogleMatch){cd.isOrganic=true;if(!cd.keyword){cd.keyword=='(not provided)';}}else if(!cd.isAdClick&&!cd.isReferrer&&!cd.isOrganic&&parameters){if(parameters.gclid&&parameters.gclid!==""){cd.isAdClick=true;isAdClick=true;}}};ChannelAnalizer.prototype.checkReferrer=function(cd){if(cd.isAdClick||cd.isOrganic||cd.isReferrer){return;}
var secondLevelRegex=/[^.]+\.[^.]+$/,currentDomain=this.opts.browser.getLocation().hostname.match(secondLevelRegex)+'',pr=this.opts.browser.parseUrl(this.opts.browser.getDocument().referrer),refDomain=pr.domain.match(secondLevelRegex)+'';if(currentDomain==refDomain){return;}
cd.keyword='';cd.isAdClick=false;cd.isReferrer=true;};module.exports=ChannelAnalizer;return module.exports;}}
_trbo.modules['EventDispatcher']={module:function(){var module={exports:function(){console.log('bad module EventDispatcher.js');}};"use strict";var EventParser=require('helper/EventParser');var EventDispatcher=function(opts){this.listeners={};this.eventParser=new EventParser(opts);};EventDispatcher.prototype.addListener=function(type,listener){if(typeof this.listeners[type]=="undefined"){this.listeners[type]=[];}
this.listeners[type].push(listener);};EventDispatcher.prototype.dispatch=function(event){if(typeof event=="string"){event={type:event};}
if(!event.type){throw new Error("Event object missing 'type' property.");}
try{event=this.eventParser.parse(event);}catch(e){this.eventParser.addLog(e.toString());}
if(typeof this.listeners[event.type]!='undefined'){var listeners=this.listeners[event.type];for(var i=0,len=listeners.length;i<len;i++){listeners[i].call(this,event);}}
try{window._trbo_notifications=window._trbo_notifications||[];_trbo_notifications.push(event);}catch(e){}};EventDispatcher.prototype.removeListener=function(type,listener){if(this.listeners[type]instanceof Array){var listeners=this.listeners[type];for(var i=0,len=listeners.length;i<len;i++){if(listeners[i]===listener){listeners.splice(i,1);break;}}}};module.exports=EventDispatcher;return module.exports;}}
_trbo.modules['Helper']={module:function(){var module={exports:function(){console.log('bad module Helper.js');}};"use strict";var Helper={};Helper.md5=function(str){var md5cycle=function(x,k){var a=x[0],b=x[1],c=x[2],d=x[3];a=ff(a,b,c,d,k[0],7,-680876936);d=ff(d,a,b,c,k[1],12,-389564586);c=ff(c,d,a,b,k[2],17,606105819);b=ff(b,c,d,a,k[3],22,-1044525330);a=ff(a,b,c,d,k[4],7,-176418897);d=ff(d,a,b,c,k[5],12,1200080426);c=ff(c,d,a,b,k[6],17,-1473231341);b=ff(b,c,d,a,k[7],22,-45705983);a=ff(a,b,c,d,k[8],7,1770035416);d=ff(d,a,b,c,k[9],12,-1958414417);c=ff(c,d,a,b,k[10],17,-42063);b=ff(b,c,d,a,k[11],22,-1990404162);a=ff(a,b,c,d,k[12],7,1804603682);d=ff(d,a,b,c,k[13],12,-40341101);c=ff(c,d,a,b,k[14],17,-1502002290);b=ff(b,c,d,a,k[15],22,1236535329);a=gg(a,b,c,d,k[1],5,-165796510);d=gg(d,a,b,c,k[6],9,-1069501632);c=gg(c,d,a,b,k[11],14,643717713);b=gg(b,c,d,a,k[0],20,-373897302);a=gg(a,b,c,d,k[5],5,-701558691);d=gg(d,a,b,c,k[10],9,38016083);c=gg(c,d,a,b,k[15],14,-660478335);b=gg(b,c,d,a,k[4],20,-405537848);a=gg(a,b,c,d,k[9],5,568446438);d=gg(d,a,b,c,k[14],9,-1019803690);c=gg(c,d,a,b,k[3],14,-187363961);b=gg(b,c,d,a,k[8],20,1163531501);a=gg(a,b,c,d,k[13],5,-1444681467);d=gg(d,a,b,c,k[2],9,-51403784);c=gg(c,d,a,b,k[7],14,1735328473);b=gg(b,c,d,a,k[12],20,-1926607734);a=hh(a,b,c,d,k[5],4,-378558);d=hh(d,a,b,c,k[8],11,-2022574463);c=hh(c,d,a,b,k[11],16,1839030562);b=hh(b,c,d,a,k[14],23,-35309556);a=hh(a,b,c,d,k[1],4,-1530992060);d=hh(d,a,b,c,k[4],11,1272893353);c=hh(c,d,a,b,k[7],16,-155497632);b=hh(b,c,d,a,k[10],23,-1094730640);a=hh(a,b,c,d,k[13],4,681279174);d=hh(d,a,b,c,k[0],11,-358537222);c=hh(c,d,a,b,k[3],16,-722521979);b=hh(b,c,d,a,k[6],23,76029189);a=hh(a,b,c,d,k[9],4,-640364487);d=hh(d,a,b,c,k[12],11,-421815835);c=hh(c,d,a,b,k[15],16,530742520);b=hh(b,c,d,a,k[2],23,-995338651);a=ii(a,b,c,d,k[0],6,-198630844);d=ii(d,a,b,c,k[7],10,1126891415);c=ii(c,d,a,b,k[14],15,-1416354905);b=ii(b,c,d,a,k[5],21,-57434055);a=ii(a,b,c,d,k[12],6,1700485571);d=ii(d,a,b,c,k[3],10,-1894986606);c=ii(c,d,a,b,k[10],15,-1051523);b=ii(b,c,d,a,k[1],21,-2054922799);a=ii(a,b,c,d,k[8],6,1873313359);d=ii(d,a,b,c,k[15],10,-30611744);c=ii(c,d,a,b,k[6],15,-1560198380);b=ii(b,c,d,a,k[13],21,1309151649);a=ii(a,b,c,d,k[4],6,-145523070);d=ii(d,a,b,c,k[11],10,-1120210379);c=ii(c,d,a,b,k[2],15,718787259);b=ii(b,c,d,a,k[9],21,-343485551);x[0]=add32(a,x[0]);x[1]=add32(b,x[1]);x[2]=add32(c,x[2]);x[3]=add32(d,x[3]);};var cmn=var ff=var gg=var hh=var ii=var md51=function(s){var n=s.length,state=[1732584193,-271733879,-1732584194,271733878],i;for(i=64;i<=s.length;i+=64){md5cycle(state,md5blk(s.substring(i-64,i)));}
s=s.substring(i-64);var tail=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(i=0;i<s.length;i++)
tail[i>>2]|=s.charCodeAt(i)<<((i%4)<<3);tail[i>>2]|=0x80<<((i%4)<<3);if(i>55){md5cycle(state,tail);for(i=0;i<16;i++)tail[i]=0;}
tail[14]=n*8;md5cycle(state,tail);return state;}
var md5blk=function(s){var md5blks=[],i;for(i=0;i<64;i+=4){md5blks[i>>2]=s.charCodeAt(i)
+(s.charCodeAt(i+1)<<8)
+(s.charCodeAt(i+2)<<16)
+(s.charCodeAt(i+3)<<24);}
return md5blks;}
var rhex=function(n){var hex_chr='0123456789abcdef'.split('');var s='',j=0;for(;j<4;j++)
s+=hex_chr[(n>>(j*8+4))&0x0F]+hex_chr[(n>>(j*8))&0x0F];return s;}
var hex=var add32=return hex(md51(str));};Helper.clone=function clone(obj){if(obj==null||typeof(obj)!='object'){return obj;}
var temp=obj.constructor();for(var key in obj)
temp[key]=clone(obj[key]);return temp;};Helper.getTime=function(str){return Math.floor((new Date()).getTime()/ 1000);};Helper.escape=function(str){return typeof encodeURIComponent=='function'?encodeURIComponent(str):escape(str);};Helper.unescape=Helper.mergeObjects=Helper.filterObject=function(obj,fields){var obj2={};for(var attrname in obj){if(fields.indexOf(attrname)!=-1){obj2[attrname]=obj[attrname];}}
return obj2;};Helper.makeQueryString=function(data){var chunks=[];for(var key in data){chunks.push(key+"="+Helper.escape(data[key]));}
return chunks.join('&');};Helper.olen=function(obj){var count=0;for(var prop in obj){if(obj.hasOwnProperty(prop))
count++;}
return count;}
Helper.cut=function(obj,limit,reverse){if(this.olen(obj)==limit)return obj;var keys=[],newObj={};for(var prop in obj){if(obj.hasOwnProperty(prop)){if(!reverse){keys.push(prop);}
else{keys.unshift(prop);}}}
for(var i=0;i<keys.length;i++){newObj[keys[i]]=obj[keys[i]];if(i+1==limit)break;}
return newObj;}
module.exports=Helper;return module.exports;}}
_trbo.modules['Trboq']={module:function(){var module={exports:function(){console.log('bad module Trboq.js');}};"use strict";var Trboq=function(opts){if(!opts.eventDispatcher){throw Error('Trboq requires eventDispatcher in opts');}
this.opts=opts;this.messages=[];this.wait=true;this.nextRunIndex=0;};Trboq.prototype.applyMessage=function(params){if(typeof params=='object'&&params.length==2){var event;if(typeof params[1]=='object'){event=params[1];if(typeof event.type!='undefined'){event._type=event.type;}
event.type=params[0];}else{event={type:params[0],data:params[1]};}
this.opts.eventDispatcher.dispatch(event);try{jTrbo(document).ready(function(){jTrbo(document).trigger("trbo:event",[params[0],params[1]]);})}catch(e){}}else{}};Trboq.eventSequence={settings:1,page:2,dataMatching:3,volatileData:3,pageView:3,productView:4,basket:5,sale:6,find:;Trboq.prototype.eventOrderComparator=function(a,b){return Trboq.eventSequence.find(a[0])-Trboq.eventSequence.find(b[0]);};Trboq.prototype.run=function(){this.messages=this.messages.sort(this.eventOrderComparator.bind(this));for(var i=this.nextRunIndex;i<this.messages.length;i++){this.applyMessage(this.messages[i]);}};Trboq.prototype.push=function(params){if(typeof params=='object'&&params.length==2){this.messages.push(params);if(!this.wait){this.applyMessage(params);}}};Trboq.prototype.seed=function(initialArray){if(typeof initialArray=='object'&&initialArray.length>0){for(var i=0;i<initialArray.length;i++){this.push(initialArray[i]);}}};Trboq.prototype.getConversionMessage=function(){for(var i=0;i<this.messages;i++){var message=this.messages[i];if(message[0]=='sale'||message[0]=='basket'){return message;}}
return false;};module.exports=Trboq;return module.exports;}}
_trbo.modules['UserDataProvider']={module:function(){var module={exports:function(){console.log('bad module UserDataProvider.js');}};"use strict";var Helper=require('Helper'),ChannelAnalizer=require('ChannelAnalizer'),ExternalData=require('helper/ExternalData'),TestPush=require('helper/TestPush'),Funnel=require('helper/Funnel'),DynamicSegment=require('helper/DynamicSegment'),ProductListing=require('helper/ProductListing'),Testing=require('helper/Testing'),Datalayer=require('helper/Datalayer'),json=require('lib/JSON');var UserDataProvider=function(opts){this.salt='trbo';this.pluginStartTime=Helper.getTime();this.localStorageSaved=false;this.useFixedCookieName=false;this.externalDataHelper=new ExternalData({storageKey:"_trbo_vdl"});this.testPush=new TestPush({externalPushIsBoundBySession:opts&&opts.config?opts.config.externalPushIsBoundBySession:undefined});this.funnel=new Funnel();this.dynamicSegment=new DynamicSegment();this.productListing=new ProductListing();this.datalayerHelper=new Datalayer(opts.config.datalayerConfigs,opts.config.datalayerTTls);if(!opts.config){opts.config={};}
this.opts=opts;if(this.opts.config.shopId==12795||this.opts.config.shopId==12796||this.opts.config.shopId==12797||this.opts.config.shopId==12798||this.opts.config.shopId==12799||this.opts.config.shopId==12800||this.opts.config.shopId==12999||this.opts.config.shopId==13728){this.useFixedCookieName=true;}
if(this.opts.config.useStaticCookieNames===true){this.useFixedCookieName=true;}
this.opts.config=Helper.mergeObjects({userTimeout:365*3600*24*3,sessionTimeout:30*60},this.opts.config);this.config=this.opts.config;var localStorage=opts.browser.getLocalStorage();this.setup();this.testing=new Testing(opts);};UserDataProvider.prototype.setup=function(){if(localStorage._trbo_ud){this.data=json.parse(localStorage._trbo_ud);if(!this.config.skipCookies&&this.opts.browser.getCookie('usr')){var cookieUid=this.opts.browser.getCookie('usr');if(this.data&&this.data.user&&typeof this.data.user.userId!='undefined'){if(cookieUid!=this.data.user.userId){this.data={};}}}}else{this.data={};}
if(!this.data.sessions)this.data.sessions={};if(!this.data.m)this.data.m=[];if(!this.sales)this.sales={};if(!this.currentProductIds)this.currentProductIds=[];this.lsSubmitCount=0;}
UserDataProvider.channels={seo:1,sea:2,typein:3,referrer:4,social:5,retargeting:6};UserDataProvider.prototype.getChannels=function(){return{seo:1,sea:2,typein:3,referrer:4,social:5,retargeting:6};};UserDataProvider.prototype.getDeviceTypes=UserDataProvider.prototype.getDeviceIds=function(){return{pc:1,'default':1,iphone:2,android:3,nokia:4,samsung:5,blackberry:6,ipad:7,ipod:8,msie:9,windows:10,linux:11,safari:12};};UserDataProvider.prototype.getConversionTypes=UserDataProvider.prototype.getPageTypeId=function(pageType){var types={detail:1,product:1,product_page:1,PDP:1,search:2,basket:3,storefront:3,start:4,home:4,homepage:4,storefront:4,other:5,checkout:6,static:7,category:8,PLP:8,unknown:9,confirmation:10,thankyou:11,account:12};return types[pageType]?types[pageType]:5;};UserDataProvider.prototype.getConversion=function(){var window=this.getBrowser().getWindow();};UserDataProvider.prototype.getPage=function(){if(!this.page){this.page={type:'other',subtype:-1};if(typeof this.getBrowser().getWindow().trbo_track_conversion!='undefined'){this.page={type:'basket',subtype:-1};}}
return this.page;};UserDataProvider.prototype.getCurrentBasket=function(){if(!this.currentBasket){this.currentBasket={value:0,num:0,voucher:0,p:[],c:[]};}
return this.currentBasket;};UserDataProvider.prototype.getUserMatching=function(){if(!this.userMatching){this.userMatching=''}
return this.userMatching;};UserDataProvider.prototype.saveLocalStorage=function(){var browser=this.opts.browser,localStorage=browser.getLocalStorage(),me=this;var lsSubmitWait=1000;if(this.lsSubmitCount>0){lsSubmitWait=100;}
if(this.opts.config&&this.opts.config.remoteLocalStorage&&this.opts.config.remoteLocalStorage.allowSend===true){window.setTimeout(function(){var trboLocalStorageData={};jTrbo.each(localStorage,function(key,value){if(key.indexOf("trbo")>=0){trboLocalStorageData[key]=value;}});try{document.getElementById(me.opts.config.remoteLocalStorage.iframeId).contentWindow.postMessage({type:'trbo:app:ls:submit',trboLocalStorageData:trboLocalStorageData,shopId:me.opts.config.shopId},'*');me.lsSubmitCount++;}catch(e){}},lsSubmitWait);}
try{if(this.config.skipLocalStorage&&this.config.skipLocalStorage===true){return;}}catch(err){}
if(localStorage){try{localStorage._trbo_ud=json.stringify(this.data);this.localStorageSaved=true;}catch(exception){this.localStorageSaved=false;}}};UserDataProvider.prototype.activateLocalStorage=function(){_trbo.app.opts.browser.config.skipLocalStorage=false;_trbo.udp.config.skipLocalStorage=false;_trbo.app.listeners.segmentIdListener.opts.config.skipLocalStorage=false;_trbo.app.layerApi.opts.config.skipLocalStorage=false;};UserDataProvider.prototype.activateCookie=function(){_trbo.udp.config.skipCookies=false;_trbo.app.opts.browser.config.skipCookies=false;_trbo.app.listeners.segmentIdListener.opts.config.skipCookies=false;_trbo.app.layerApi.opts.config.skipCookies=false;};UserDataProvider.prototype.saveData=function(){var browser=this.opts.browser;this.saveLocalStorage();if(!this.config.skipCookies){var user=this.getUser(),session=this.getSession();browser.setCookie('usr',user.userId,this.config.userTimeout);browser.setCookie('session',session.sessionId,this.config.sessionTimeout);if(this.useFixedCookieName===true){browser.setCookie('us_'+this.opts.config.shopId,json.stringify(this.getUserSummaryCookie()),this.config.userTimeout);browser.setCookie('sess_'+this.opts.config.shopId,json.stringify(session.sessionSummary),this.config.sessionTimeout);}else{browser.setCookie('us_'+user.userId,json.stringify(this.getUserSummaryCookie()),this.config.userTimeout);browser.setCookie('sess_'+session.sessionId,json.stringify(session.sessionSummary),this.config.sessionTimeout);}}};UserDataProvider.prototype.getBrowser=function(){return this.opts.browser;};UserDataProvider.prototype.getStateSummary=function(){return{onBasket:typeof this.getBrowser().getWindow().trbo_track_conversion!='undefined'};};UserDataProvider.prototype.getCurrentProductIds=function(){return this.currentProductIds;};UserDataProvider.prototype.getConfig=UserDataProvider.prototype.generateUniqueId=function(){var userAgent=this.opts.browser.getNavigator().userAgent,userIdString=Math.random()+userAgent;try{if(window.localStorage&&window.localStorage.ga_client_id){var tmpGaClientData=JSON.parse(window.localStorage.ga_client_id);if(tmpGaClientData&&tmpGaClientData.clientId&&tmpGaClientData.clientId!==''){return Helper.md5(tmpGaClientData.clientId);}}else{try{}catch(e){}
if(parseInt(this.opts.config.shopId)===13386){var tmpClientId=this.opts.browser.getCookieRaw('o2_client_id');if(tmpClientId&&tmpClientId!==false&&tmpClientId!==''){return Helper.md5(tmpClientId);}}
if(parseInt(this.opts.config.shopId)===13191){var tmpGaClientData=this.opts.browser.getCookieRaw('sid');if(tmpGaClientData&&tmpGaClientData!==false&&tmpGaClientData!==''){return Helper.md5(tmpGaClientData+userAgent);}}
if(parseInt(this.opts.config.shopId)===13661){var hash=Helper.md5(this.salt+userIdString),hashName="vri_"+Helper.md5(this.salt),currentHash=false;if(window.localStorage&&window.localStorage[hashName]){currentHash=window.localStorage[hashName];}
if(currentHash){return currentHash;}else{window.localStorage[hashName]=hash;return hash;}}
if(window.UC_UI){var tmpUCUserData=false;try{tmpUCUserData=window.UC_UI.getSettings().controllerId;}catch(err){}
if(tmpUCUserData){return Helper.md5(tmpUCUserData+userAgent);}}
try{if(window.usercentrics&&window.usercentrics.consents&&window.usercentrics.consents.length>0){var tmpUCUserData=false;try{tmpUCUserData=window.usercentrics.consents[0].controllerId;}catch(err){}
if(tmpUCUserData){return Helper.md5(tmpUCUserData+userAgent);}}}catch(err){}
try{if(window.localStorage&&window.localStorage.ucConsents){var ucConsents=JSON.parse(window.localStorage.ucConsents);if(ucConsents&&ucConsents.consents&&ucConsents.consents.length>0){var tmpUCUserData=false;try{tmpUCUserData=ucConsents.consents[0].controllerId;}catch(err){}
if(tmpUCUserData){return Helper.md5(tmpUCUserData+userAgent);}}}}catch(err){}
var tmpGaClientData=this.opts.browser.getCookieRaw('_ga');if(tmpGaClientData&&tmpGaClientData!==false&&tmpGaClientData!==''){return Helper.md5(tmpGaClientData+userAgent);}}}catch(err){}
return Helper.md5(this.salt+userIdString);};UserDataProvider.prototype.generateUniqueNumber=function(){var num=(Math.floor((new Date()).getTime()/ 10000)-120000000)*100+
Math.floor(Math.random()*100);if(num>4294967294||num<0){num=Math.floor(Math.random()*4294967295);}
return num;};UserDataProvider.prototype.addExternalUserId=UserDataProvider.prototype.addExternalData=function(externalData){for(var externalDataKeyName in externalData){try{if(this.opts.config.datalayerTTls&&this.opts.config.datalayerTTls[externalDataKeyName]){var validSessions=this.opts.config.datalayerTTls[externalDataKeyName];this.externalDataHelper.setValidTime(externalDataKeyName,validSessions*60*60);}}catch(e){}}
var userSummary=this.getUserSummary();var newExternalData=externalData;if(userSummary.externalData&&Object.keys(userSummary.externalData).length>0){for(var used_key in userSummary.externalData){if(newExternalData[used_key]===undefined&&userSummary.externalData[used_key]&&userSummary.externalData[used_key]!==""){newExternalData[used_key]=userSummary.externalData[used_key];}}}
userSummary.externalData=newExternalData;};UserDataProvider.prototype.setCurrentProductIds=function(eventData){this.currentProductIds=[];try{if(typeof eventData==="undefined"||!eventData||!eventData.type||eventData.type!=='productView'||!eventData.products||eventData.products.length<=0){return;}
for(var i=0;i<eventData.products.length;i++){if(eventData.products[i].product_id&&eventData.products[i].product_id!==''&&this.currentProductIds.indexOf(eventData.products[i].product_id)<0){this.currentProductIds.push(eventData.products[i].product_id);}}}catch(err){}};UserDataProvider.prototype.addSegmentData=function(segmentData,overwriteSegmentData){if(!this.data.segmentData){this.data.segmentData={};}
var newSegmentData=segmentData;if(overwriteSegmentData===undefined){overwriteSegmentData=false;}
if(overwriteSegmentData===false&&this.data.segmentData&&Object.keys(this.data.segmentData).length>0){for(var used_key in this.data.segmentData){if(newSegmentData[used_key]===undefined&&this.data.segmentData[used_key]&&this.data.segmentData[used_key]!==""){newSegmentData[used_key]=this.data.segmentData[used_key];}}}
this.data.segmentData=newSegmentData;this.saveData();};UserDataProvider.prototype.addTestingData=function(testingData){if(!this.data.testingData){this.data.testingData={};}
for(var testing_key in testingData){this.data.testingData[testing_key]=testingData[testing_key];}
this.saveData();};UserDataProvider.prototype.addStoryData=function(storyData,overwriteStoryData){if(!this.data.storyData){this.data.storyData={};}
var newStoryData=storyData;if(overwriteStoryData===false&&this.data.storyData&&Object.keys(this.data.storyData).length>0){for(var used_key in this.data.storyData){if(newStoryData[used_key]===undefined&&this.data.storyData[used_key]&&this.data.storyData[used_key]!==""){newStoryData[used_key]=this.data.storyData[used_key];0}}}
this.data.storyData=newStoryData;this.saveData();};UserDataProvider.prototype.addChannelData=function(channelData,overwriteChannelData){try{if(!this.data.channelData){this.data.channelData={};}
var newChannelData=channelData;if(overwriteChannelData===false&&this.data.channelData&&Object.keys(this.data.channelData).length>0){for(var used_key in this.data.channelData){if(newChannelData[used_key]===undefined&&this.data.channelData[used_key]&&this.data.channelData[used_key]!==""){newChannelData[used_key]=this.data.channelData[used_key];}}}
this.data.channelData=newChannelData;this.saveData();}catch(err){}};UserDataProvider.prototype.addPageView=function(){var now=Helper.getTime(),summary=this.getSession().sessionSummary,userSummary=this.getUserSummary();summary.pageViewCount++;userSummary.pageViewCountTotal++;if(summary.lastClickTime>0){userSummary.sessionDurationTotal+=now-summary.lastClickTime;}
summary.lastClickTime=now;summary.sessionDuration=summary.lastClickTime-summary.firstClickTime;};UserDataProvider.localRecordBlacklist=['shopId','userId','sessionId','campaignId','device','deviceType','os','browserType'];UserDataProvider.prototype.cleanupLocalEventData=function(data,fields){for(var i in fields){delete data[fields[i]];}};UserDataProvider.prototype.addSessionEvent=function(event){if(event.type=='conv'&&event.data&&event.data.conversionType=='sale'){this.getUserSummary().saleCount++;this.saveData();}else if(event.type=='os'){return false;}
var session=this.getSession();if(!session.events.push){session.events=[];}
session.events.push(event);if([12514,12926,12927,12928,12929,12937].indexOf(parseInt(this.opts.config.shopId))>=0&&session.events.length>15){session.events=session.events.slice(session.events.length-15);}
if(event.type=='productView'||event.type=='conv'||event.type=='layerClick'){if(this.localStorageSaved){this.saveLocalStorage();}}};UserDataProvider.prototype.getUser=function(){if(this.data.user&&this.data.user.shopId!=this.opts.config.shopId){this.data.user=null;}
if(!this.data.user){this.data.session=null;var cn='usr',localStorage=this.opts.browser.getLocalStorage(),isLocalStorageLeading=false,localStorageUserId=false;try{if([12897,13080].indexOf(parseInt(this.opts.config.shopId))>=0){isLocalStorageLeading=true;if(this.opts.browser.getCookie(cn)&&localStorage&&!localStorage._trbo_ud){localStorageUserId=this.opts.browser.getCookie(cn);}}}catch(err){}
if(isLocalStorageLeading===true&&localStorageUserId){this.data.user={userId:localStorageUserId};}else if(!this.config.skipCookies&&this.opts.browser.getCookie(cn)){var uid=this.opts.browser.getCookie(cn);this.data.user={userId:this.opts.browser.getCookie(cn)};}else{this.data.user={userId:this.generateUniqueId()};this.config.isNewUser=true;this.config.isNewSession=true;}
this.data.user.shopId=this.opts.config.shopId;if(!this.data.user.userSummary){if(!this.config.skipCookies){if(this.useFixedCookieName===true){var usCookie=this.opts.browser.getCookie('us_'+this.opts.config.shopId);}else{var usCookie=this.opts.browser.getCookie('us_'+this.data.user.userId);}
if(usCookie){this.data.user.userSummary=json.parse(usCookie);}}}}
return this.data.user;};UserDataProvider.prototype.getExternalUserId=function(){var userSummary=this.getDatalayerData();if(userSummary.hasOwnProperty("external_user_id")){return userSummary.external_user_id;}else{return false;}};UserDataProvider.prototype.assignAbGroup=UserDataProvider.prototype.makeChannelDataByReferrer=function(referrer){var match=/^(http[s]?:\/\/)([^\/]+)\/?([^\?]*)\??(.*)$/i,matched=referrer.match(match);if(!matched){return false;}
var cd={scheme:matched[1],category:matched[2],subcategory:matched[3],queryString:matched[4],params:this.getBrowser().parseUrlParams(matched[4]),referrer:referrer,position:0,isAdClick:false,isOrganic:false,isReferrer:false,isSocial:false,isClickin:false};var channelAnalizer=new ChannelAnalizer(this.opts);channelAnalizer.checkGoogle(cd);channelAnalizer.checkReferrer(cd);if(matched&&matched.length>=3&&matched[2]){if(matched[2].match(/\.facebook.com$/)||matched[2].match(/\.twitter.com$/)||matched[2].match(/\.instagram.com$/)){cd.isReferrer=false;cd.isSocial=true;}}
switch(true){case cd.isAdClick:cd.channel='sea';break;case cd.isOrganic:cd.channel='seo';break;case cd.isReferrer:cd.channel='referrer';break;case cd.isSocial:cd.channel='social';break;default:cd=null;}
if(cd){cd.scheme=null;cd.category=null;cd.subcategory=null;cd.queryString=null;cd.params=null;cd.referrer=null;cd.position=null;}
return cd;};UserDataProvider.prototype.makeChannelData=function(){var cn='ref',referrer=this.getBrowser().getCookie(cn),channelData=null;if(!referrer){referrer=this.getBrowser().getDocument().referrer;if(referrer){channelData=this.makeChannelDataByReferrer(referrer);}}
if((!channelData||!channelData.channel)&&document.location.search.match(/[?&]+gclid=.+/)){channelData={channel:'sea'};}
return channelData?channelData:{channel:"typein"};};UserDataProvider.prototype.makeSessionSummary=function(){var summary={firstClickTime:Helper.getTime(),lastClickTime:Helper.getTime(),pageViewCount:0,sessionDuration:0};return summary;};UserDataProvider.prototype.getSegmentData=function(){if(!this.data.segmentData){this.data.segmentData={};}
return this.data.segmentData;};UserDataProvider.prototype.getTestingData=function(){if(!this.data){return{};}
if(!this.data.testingData){this.data.testingData={};}
return this.data.testingData;};UserDataProvider.prototype.getTestingDataTracking=function(){var testingDataTracking={slots:{},data:{}};var validTestingData=[];try{var pluginConfigValidTestingData=window._trbo.pluginConfig.valid_testing_data;if(pluginConfigValidTestingData&&pluginConfigValidTestingData.length>0){validTestingData=pluginConfigValidTestingData;}}catch(err){}
try{if(this.data.testingData&&Object.keys(this.data.testingData).length>0){for(var tracking_slot_key in this.data.testingData){if(this.data.testingData[tracking_slot_key]&&this.data.testingData[tracking_slot_key]!==null&&this.data.testingData[tracking_slot_key]!==''){testingDataTracking.slots[tracking_slot_key]=this.data.testingData[tracking_slot_key];}}}
if(validTestingData&&validTestingData.length>0){var dataLayerData=this.getUserSummary().externalData;if(dataLayerData&&Object.keys(dataLayerData).length>0){for(var i=0;i<validTestingData.length;i++){if(dataLayerData[validTestingData[i]]&&dataLayerData[validTestingData[i]]!==''&&dataLayerData[validTestingData[i]]!=='n/a'&&dataLayerData[validTestingData[i]]!='-1'){testingDataTracking.data[validTestingData[i]]=dataLayerData[validTestingData[i]];}}}}}catch(err){}
return testingDataTracking;};UserDataProvider.prototype.getStoryData=function(){if(!this.data.storyData){this.data.storyData={};}
return this.data.storyData;};UserDataProvider.prototype.getChannelData=function(){if(!this.data.channelData){this.data.channelData={};}
return this.data.channelData;};UserDataProvider.prototype.getUserSummaryCookie=function(){var user=this.getUser();if(user.userSummary){return{saleCount:user.userSummary.saleCount,sessionCount:user.userSummary.sessionCount,brandSessionCount:user.userSummary.brandSessionCount,pageViewCountTotal:user.userSummary.pageViewCountTotal,sessionDurationTotal:user.userSummary.sessionDurationTotal,externalUserId:user.userSummary.externalUserId,userCreateTime:user.userSummary.userCreateTime};}
return user.userSummary={saleCount:0,sessionCount:0,brandSessionCount:0,pageViewCountTotal:0,sessionDurationTotal:0,externalUserId:"",userCreateTime:Helper.getTime()};};UserDataProvider.prototype.getUserSummary=function(){var user=this.getUser();if(user.userSummary){try{user.userSummary.externalData=this.externalDataHelper.getValidData(user.userSummary.externalData);}catch(e){}
return user.userSummary;}
return user.userSummary={saleCount:0,sessionCount:0,brandSessionCount:0,pageViewCountTotal:0,sessionDurationTotal:0,externalUserId:"",externalData:{},userCreateTime:Helper.getTime()};};UserDataProvider.prototype.getSession=function(){var userSummary=this.getUserSummary(),channelData=this.makeChannelData(),browser=this.opts.browser,isNewSession=false;if(this.data.session){var sessionSummary=this.data.session.sessionSummary;if(sessionSummary&&sessionSummary.lastClickTime){if(Helper.getTime()-sessionSummary.lastClickTime>this.config.sessionTimeout){var oldSessionId=this.data.session.sessionId.toString();this.data.sessions[oldSessionId]=this.data.session;browser.setCookie('session','',-10000);this.data.session=null;this.data.m=null;}}}
if(!this.data.session){var sessionId=browser.getCookie('session'),sessionSummary=null;if(sessionId&&!this.config.skipCookies){if(this.useFixedCookieName===true){var sessionCookie=browser.getCookie('sess_'+this.opts.config.shopId),sessionSummary=json.parse(sessionCookie);}else{var sessionCookie=browser.getCookie('sess_'+sessionId),sessionSummary=json.parse(sessionCookie);}}else{sessionId=this.generateUniqueNumber();userSummary.sessionCount++;if('typein'==channelData.channel){userSummary.brandSessionCount++;}
isNewSession=true;}
this.data.session={sessionId:sessionId,createTime:Helper.getTime(),campaignId:typeof this.opts.config.campaign=='undefined'?null:this.opts.config.campaign.campaignId,abGroup:this.assignAbGroup(),segmentId:0,channelData:channelData,deviceData:this.getBrowser().getDeviceData(),sessionSummary:sessionSummary?sessionSummary:this.makeSessionSummary(),events:[]};try{this.config.isNewSession=isNewSession;}catch(err){}
if(!this.config.skipCookies&&browser.getCookie('m')){this.data.session.m=json.parse(browser.getCookie('m'));}}
return this.data.session;};UserDataProvider.prototype.filterEvenets=UserDataProvider.prototype.filterSessions=function(){var sessions={};var count=0;var currentSessions=this.data.sessions;var maxSessionCount=this.config.maxSessionCount||10;var maxSessionTtlDays=this.config.maxSessionTtlDays||30;try{currentSessions=this.sortSessionsByCreatTime(this.data.sessions);}catch(e){}
for(var index in currentSessions){++count;if(currentSessions[index].createTime>Helper.getTime()-maxSessionTtlDays*24*3600){var sessionIndex=currentSessions[index].sessionId;sessions[sessionIndex]=currentSessions[index];if(sessionIndex.toString!=this.data.session.sessionId.toString()){if([12514,12926,12927,12928,12929,12937].indexOf(parseInt(this.opts.config.shopId))>=0){sessions[sessionIndex].events=[];}}}
if(count>maxSessionCount)break;}
if(count){this.data.sessions=sessions;}};UserDataProvider.prototype.getSessions=function(){this.filterSessions();var sessions=[];for(var session in this.data.sessions){sessions.unshift({sst:this.data.sessions[session].createTime,pvc:this.data.sessions[session].sessionSummary.pageViewCount,sd:this.data.sessions[session].sessionSummary.sessionDuration});}
var currentSession=this.getSession(),sessionSummary=currentSession.sessionSummary;sessions.unshift({sst:currentSession.createTime,pvc:sessionSummary.pageViewCount,sd:sessionSummary.sessionDuration});return sessions;};UserDataProvider.prototype.getRawSessions=UserDataProvider.prototype.postSetup=function(){this.checkForceUserId();}
UserDataProvider.prototype.checkForceUserId=function(){var fUserParam=this.getBrowser().getUrlParam("trbo_f_user_id");var valid=!!fUserParam;if(valid){this.setForcedUserId(fUserParam);}
return valid;}
UserDataProvider.prototype.setForcedUserId=UserDataProvider.prototype.sortSessionsByCreatTime=function(sessions){var sessionArray=[];if(this.opts.config.shopId!=12897){return sessions;}
jTrbo.each(sessions,function(sessionId,sessionData){sessionArray.push(sessionData);});sessionArray.sort(function(a,b){return a.createTime-b.createTime});sessionArray.reverse();return sessionArray;};UserDataProvider.prototype.getDatalayerData=function(){var dataLayer={},volatileData={},merged={};try{dataLayer=this.getUserSummary().externalData||{};}catch(e){}
try{volatileData=_trbo.app.listeners.volatileDataListener.getStorageData()||{};}catch(e){}
try{jTrbo.each(dataLayer,function(datalayerKey,datalayerValue){merged[datalayerKey]=datalayerValue;});jTrbo.each(volatileData,;}catch(e){return dataLayer;}
return merged;};UserDataProvider.prototype.getLikedProducts=function(){return this.getProductsByAction("productLike");};UserDataProvider.prototype.getDislikedProducts=UserDataProvider.prototype.getProductsByAction=function(type){var stack=[],cleanedUp=[],list=this.getUserSummary()[type]||[];for(var productId in list){stack.push([productId,list[productId]]);}
stack.sort(function(a,b){return a[1]-b[1];});stack.reverse();for(var index in stack){cleanedUp.push(stack[index][0]);}
return cleanedUp;}
module.exports=UserDataProvider;return module.exports;}}
_trbo.modules['helper/Chatchamp']={module:function(){var module={exports:function(){console.log('bad module helper/Chatchamp.js');}};"use strict";var Chatchamp=function(config){var me=this;jTrbo(document).on("trbo:event",function(jsEvent,trboEventName,trboEventPayload){if(trboEventName==="sale"){var chatchampProducts=[];jTrbo.each(trboEventPayload.products,;if(chatchampProducts.length>0){me.trackSale(config.external_shop_id,chatchampProducts,trboEventPayload.value);}}});};Chatchamp.prototype.trackSale=function(chatchampCustomerId,products,amount){(function(c,h,a,t,b,o,x){c.ccq=c.ccq.queue=[];o=h.createElement(a);o.src=t;o.async=1;o.setAttribute('data-chatchamp-customer-id',b);o.setAttribute('data-is-visible',false);x=h.getElementsByTagName(a)[0];x.parentNode.insertBefore(o,x);})(window,document,'script','https://js.chatchamp.com/bubble.min.js',chatchampCustomerId)
ccq('ordered',{products:products,total:amount})};module.exports=Chatchamp;return module.exports;}}
_trbo.modules['helper/Datalayer']={module:function(){var module={exports:function(){console.log('bad module helper/Datalayer.js');}};"use strict";var Datalayer=function(configs,datalayerTTls){this.log=[];this.configs=configs;this.datalayerTTls=datalayerTTls;};Datalayer.prototype.run=function(){var me=this,dataLayer={},volatileData={};window._trboq=window._trboq||[];jTrbo.each(me.configs,function(configIndex,itemConfig){var value=me.getValueByConfig(itemConfig.config),ttl=me.datalayerTTls[itemConfig.name]||1;if(value){try{if(ttl==-1){volatileData[itemConfig.name]=value;}else{dataLayer[itemConfig.name]=value;}}catch(e){console.log(e);}}else{if(itemConfig.config.fallbackTypeId==2){if(ttl==-1){volatileData[itemConfig.name]=itemConfig.config.fallbackValue;}else{dataLayer[itemConfig.name]=itemConfig.config.fallbackValue;}}}});if(Object.keys(dataLayer).length>0){window._trboq.push(["dataMatching",dataLayer]);me.log.push(dataLayer);}
if(Object.keys(volatileData).length>0){window._trboq.push(["volatileData",volatileData]);me.log.push(volatileData);}};Datalayer.prototype.getNestedValue=function(nest,path){var result=false,pathParts=path.split("."),ranTilEnd=true;try{jTrbo.each(pathParts,function(index,pathPart){if(nest.hasOwnProperty(pathPart)){nest=nest[pathPart];}else{ranTilEnd=false;return false}});}catch(e){return result;}
if(ranTilEnd){return nest}else{return false;}};Datalayer.prototype.getValueFromCookie=function(cookieName){var name=cookieName+"=",ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' '){c=c.substring(1);}
if(c.indexOf(name)==0){return c.substring(name.length,c.length);}}
return false;};Datalayer.prototype.getValueFromJsVariable=function(variableName){if(variableName.indexOf(".")>=0){return this.getNestedValue(window,variableName);}else{return window[variableName]||false;}};Datalayer.prototype.getValueFromGoogleDataLayer=function(datalayerName){var clientDataLayer=(window.dataLayer||window.datalayer||window.tefDatalayer),result=false,me=this;jTrbo.each(clientDataLayer,function(index,clientDataLayerItem){if(datalayerName.indexOf(".")>=0){result=me.getNestedValue(clientDataLayerItem,datalayerName);if(result!==false){return false;}}else{if(clientDataLayerItem.hasOwnProperty(datalayerName)){result=clientDataLayerItem[datalayerName];}}});return result;};Datalayer.prototype.getValueFromTealiumDataLayer=function(datalayerName){if(window.utag&&window.utag.data){if(datalayerName.indexOf(".")>=0){return this.getNestedValue(window.utag.data,datalayerName);}else if(window.utag.data.hasOwnProperty(datalayerName)){return window.utag.data[datalayerName];}else{return false;}}else{return false;}};Datalayer.prototype.getValueFromJsFunction=function(functionCode){try{var fn=new Function(functionCode);return fn();}catch(e){this.log.push(e);return false;}};Datalayer.prototype.getValueFromGetParam=function(paramName){var parameters={},hash,url=document.location.href,hashes=url.slice(url.indexOf('?')+1).split('&');if(url.indexOf("?")>0){for(var i=0;i<hashes.length;i++){hash=hashes[i].split('=');try{parameters[decodeURIComponent(hash[0])]=decodeURIComponent(hash[1]);}catch(e){parameters[decodeURIComponent(hash[0])]=hash[1];}}}
return parameters[paramName]||false;};Datalayer.prototype.getValueByConfig=function(config){var value=false;if(config.fillTypeId==2){value=this.getValueFromCookie(config.fillSourceName);}else if(config.fillTypeId==3){value=this.getValueFromJsVariable(config.fillSourceName);}else if(config.fillTypeId==4){value=this.getValueFromGoogleDataLayer(config.fillSourceName);}else if(config.fillTypeId==5){value=this.getValueFromTealiumDataLayer(config.fillSourceName);}else if(config.fillTypeId==6){value=this.getValueFromJsFunction(config.fillSourceFn);}else if(config.fillTypeId==7){value=this.getValueFromGetParam(config.fillSourceName);}
return value;};module.exports=Datalayer;return module.exports;}}
_trbo.modules['helper/DynamicSegment']={module:function(){var module={exports:function(){console.log('bad module helper/DynamicSegment.js');}};"use strict";var DynamicSegment=function(){this.pushes={};this.customDynamicSegmentConfigs=[];this.dynamicSegmentMatrix={};this.segments=[];this.segmentHistory={};};DynamicSegment.prototype.getDynamicSegmentValueFromDatalayer=function(key){try{var result="n/a";jTrbo.each(_trboq,function(pushIndex,pushConfig){var pushData=pushConfig[1];if(pushConfig[0]==="dataMatching"&&pushData.hasOwnProperty(key)){result=pushData[key];}});return result;}catch(e){return"n/a";}};DynamicSegment.prototype.startsWith=function(string,search){if(typeof string==="string"){const len=search.trim().length;if(string.substring(0,len)===search){return true;}}
return false;}
DynamicSegment.prototype.pregMatch=function(string,search){if(typeof string==="string"){let re=new RegExp(search,"g");if(string.match(re)){return true;}}
return false;}
DynamicSegment.prototype.isLocationValid=function(location,url){const matchType=parseInt(url.matchType);const check=url.url;switch(matchType){case 2:if(location.indexOf(check)>-1){return true;}
break;case 6:if(location.indexOf(check)===-1){return true;}
break;case 3:if(location===check){return true;}
break;case 8:if(location!==check){return true;}
break;case 7:return this.startsWith(location,check);case 1:return this.pregMatch(location,check);default:break;}
return false;}
DynamicSegment.prototype.isUrlPatternValid=function(url){const localHref=window.location.href;const localPath=window.location.pathname;if(url.type==="url"){return this.isLocationValid(localHref,url);}else if(url.type==="path"){return this.isLocationValid(localPath,url);}
return false;}
DynamicSegment.prototype.getDynamicSegmentValueFromUrl=function(attributes){let returnValue="n/a";let me=this;try{jTrbo.each(attributes,function(idx,urlGroup){jTrbo.each(urlGroup.urlPatterns,function(idy,url){if(me.isUrlPatternValid(url)){returnValue=urlGroup.value;return false;}});if(returnValue!=="n/a"){return false;}});}catch(e){}
return returnValue;}
DynamicSegment.prototype.addSegmentConfigs=function(segments){var me=this;if(typeof segments!=="undefined"){this.segments=segments;}
segments=typeof segments!=="undefined"?segments:this.segments;jTrbo.each(segments,function(segmentIndex,segment){try{var segmentTargetId=segment.segment_target_id,type=segment.dynamic_segment_config.type,targetAttribute=segment.dynamic_segment_config.targetAttribute,functionCode=segment.dynamic_segment_config.getFunction;me.dynamicSegmentMatrix[segmentTargetId]=segment.dynamic_segment_name;me.addSegment(segmentTargetId,type,targetAttribute,functionCode);}catch(e){}});try{this.pushSegments();}catch(e){}};DynamicSegment.prototype.reRun=DynamicSegment.prototype.addSegment=function(segmentTargetId,type,targetAttribute,functionCode){var segmentValue=false;if(type==="datalayer"){segmentValue=this.getDynamicSegmentValueFromDatalayer(targetAttribute);}else if(type==="product"){this.customDynamicSegmentConfigs.push({t:"2",id:segmentTargetId,pa:targetAttribute,s:"100;0;0"});}else if(type==="url"){segmentValue=this.getDynamicSegmentValueFromUrl(targetAttribute);}else if(type==="function"){var fn=new Function(functionCode);segmentValue=fn();}
if(segmentValue!==false&&segmentValue!=="n/a"){this.pushes[segmentTargetId]=segmentValue;}};DynamicSegment.prototype.getCustomDynamicSegmentConfigs=function(){return this.customDynamicSegmentConfigs;};DynamicSegment.prototype.pushSegments=function(){var me=this;window._trboq=window._trboq||[]
me.segmentHistory=_trbo.udp.data.segmentHistory||{};if(Object.keys(this.pushes).length>0){var data={dyn_segment:this.pushes};try{jTrbo.each(this.pushes,function(key,value){var segmentName=me.dynamicSegmentMatrix[key];if(segmentName){data[segmentName+"_latest"]=value}});}catch(e){}
window._trboq.push(["dataMatching",data]);try{jTrbo.each(this.pushes,function(key,value){var segmentName=me.dynamicSegmentMatrix[key];me.trackSegment(key,segmentName,value);});}catch(e){}}
this.addAutomaticSegments();if(_trbo.udp.opts.config.shopId==13745){_trbo.udp.data.segmentHistory=me.segmentHistory;_trbo.udp.saveData();jTrbo(document).trigger("trbo:dynamicSegment:stored",_trbo.udp.data.segmentHistory)}};DynamicSegment.prototype.addAutomaticSegments=function(){var me=this,automaticSegments=["category_path","brand"];jTrbo.each(automaticSegments,function(index,segmentName){var segmentValue=me.getDynamicSegmentValueFromDatalayer(segmentName);if(segmentValue!=="n/a"){me.trackSegment(segmentName,segmentName,segmentValue);}});}
DynamicSegment.prototype.trackSegment=function(segmentId,segmentName,value){if(!this.segmentHistory.hasOwnProperty(segmentId)){this.segmentHistory[segmentId]={segmentId:segmentId,segmentName:segmentName,values:{}}}
if(!this.segmentHistory[segmentId].values[value]){this.segmentHistory[segmentId].values[value]=0;}
this.segmentHistory[segmentId].values[value]++;}
module.exports=DynamicSegment;return module.exports;}}
_trbo.modules['helper/EventParser']={module:function(){var module={exports:function(){console.log('bad module helper/EventParser.js');}};"use strict";var EventParser=EventParser.prototype.parse=function(event){var type=event.type,eventParserConfig=this.opts.config.eventParserConfig;if(eventParserConfig==false){this.addLog("no parserConfig set");return event;}else{var parseKey="event_parser_"+type;if(eventParserConfig.hasOwnProperty(parseKey)&&eventParserConfig[parseKey]){this.addLog("parse "+type+": "+JSON.stringify(event));return this.parseByCode(event,eventParserConfig[parseKey]);}else{this.addLog("no parserConfig found for:"+type);return event;}
return event;}}
EventParser.prototype.parseByCode=function(event,code){var fn=new Function("event",code),result;try{result=fn(event);result.type=event.type;}catch(e){result=event;}
return result;}
EventParser.prototype.addLog=module.exports=EventParser;return module.exports;}}
_trbo.modules['helper/ExternalData']={module:function(){var module={exports:function(){console.log('bad module helper/ExternalData.js');}};"use strict";var ExternalData=function(opts){this.opts=opts;this.localStorageKey=opts.storageKey;this.currentConfig=this.getStorage();this.log=[];};ExternalData.prototype.setValue=function(keyName,keyValue,validFor){var storageData=this.getStorage(),currentDate=new Date(),validForTimestamp,storageItem;try{validForTimestamp=currentDate.getTime()+(parseInt(validFor,10)*1000);storageItem={validFor:validForTimestamp,};if(keyValue){storageItem.value=keyValue;}
storageData[keyName]=storageItem;this.saveStorage(storageData);this.log.push("set valid for '"+keyName+"' for "+validFor+"secs (till : "+validForTimestamp+")");}catch(e){this.log.push("failed to set value: "+e);}};ExternalData.prototype.getValue=function(key){var storage=this.getStorage();if(this.isStillValid(key)){try{return storage[key].value||"";}catch(e){return"";}}else{return"";}};ExternalData.prototype.setValidTime=function(keyName,validFor){try{this.setValue(keyName,false,validFor);}catch(e){this.log.push("failed to generate validForTimestamp: "+e);}};ExternalData.prototype.removeKey=function(keyName){try{var storageData=this.getStorage();delete storageData[keyName];this.saveStorage(storageData);}catch(e){this.log.push("failed to delete data: "+e);}};ExternalData.prototype.getStorage=function(){try{return JSON.parse(window.localStorage[this.localStorageKey]||"{}");}catch(e){return{};}};ExternalData.prototype.saveStorage=function(storageData){try{if(_trbo.app.opts.config.hasOwnProperty("skipLocalStorage")&&_trbo.app.opts.config.skipLocalStorage===true){return;}
window.localStorage[this.localStorageKey]=JSON.stringify(storageData);}catch(e){this.log.push("failed to save data: "+e);}};ExternalData.prototype.isStillValid=function(keyName){var configSetting=this.getStorage()[keyName]||false,currentDate=new Date(),currentTimestamp=currentDate.getTime();try{if(configSetting===false){return true;}else{if(currentTimestamp<configSetting.validFor){return true;}else{this.removeKey(keyName);return false;}}}catch(e){this.log.push("failed to validata data: "+e);return true;}};ExternalData.prototype.getLayerBlackList=function(externalData){var me=this,storage=this.getStorage(),volatileModulesOnBlacklist=[],currentBlackList=externalData.trbo_module_blacklist||[];jTrbo.each(storage,function(key,config){if(parseInt(config.value,10)===1&&key.indexOf("_compr")>=0){var keyArray=key.split("_");try{if(me.isStillValid(key)){volatileModulesOnBlacklist.push(parseInt(keyArray[1],10));}else{var currentPositionInList=currentBlackList.indexOf(parseInt(keyArray[1],10));if(currentPositionInList>=0){currentBlackList.splice(currentPositionInList,1);}}}catch(e){console.log(e);}}});if(volatileModulesOnBlacklist.length>0){jTrbo.each(volatileModulesOnBlacklist,function(blackListKey,moduleId){if(currentBlackList.indexOf(moduleId)===-1){currentBlackList.push(moduleId);}});return currentBlackList;}else{return currentBlackList;}};ExternalData.prototype.getValidData=function(externalData){var me=this,result={},backlistModules=this.getLayerBlackList(externalData);jTrbo.each(externalData,;if(backlistModules!==false){result.trbo_module_blacklist=backlistModules}
return result;};module.exports=ExternalData;return module.exports;}}
_trbo.modules['helper/Funnel']={module:function(){var module={exports:function(){console.log('bad module helper/Funnel.js');}};"use strict";var Funnel=Funnel.prototype.fire=function(conversionTypeId,products){var funnelData={order_id:'10_'+Math.floor(Date.now()/ 100000),funnel_id:conversionTypeId,value:1,currency:"EUR",coupon_code:"",products:products};_trboq.push(["funnel",funnelData]);this.log.push({"message":"fire funnel",data:funnelData});jTrbo(document).trigger("afterFunnelFired",[conversionTypeId,products])};Funnel.prototype.addToElement=function(conversionTypeId,products,funnelOptions){var me=this;try{var selector=funnelOptions.selector,addClick=if(selector){var counter=0,intervalId=window.setInterval(function(){var element=jTrbo(selector);if(counter>10){window.clearInterval(intervalId);}
if(element.length>0){addClick(element,conversionTypeId,products);window.clearInterval(intervalId);}
counter++;},1000);}}catch(e){}};Funnel.prototype.getBasketProducts=function(){var currentBasket=_trbo.udp.getCurrentBasket(),products=[];if(currentBasket.p&&currentBasket.p.length>0){jTrbo.each(currentBasket.p,function(productIndex,productId){products.push({product_id:productId,name:productId,price:1,quantity:1})})}
return products;};Funnel.prototype.getPageType=function(){return _trbo.udp.getPageTypeId(_trbo.udp.getPage().type);};Funnel.prototype.getDatalayer=function(key){try{var dataLayer=_trbo.udp.getUserSummary().externalData;if(dataLayer&&dataLayer[key]){return dataLayer[key];}else{return"";}}catch(e){return"";}};Funnel.prototype.getUrl=function(){return document.location.href;};Funnel.prototype.getPath=Funnel.prototype.run=function(){try{if((this.getUrl().indexOf('https://www.o2online.de/econtract/start')>=0||this.getUrl().indexOf('https://www.o2online.de/econtract/tariffchoice')>=0)){var products=[];this.fire(18,products);}}catch(e){console.log(e);}
try{if((this.getUrl().indexOf('https://www.o2online.de/econtract/hardwarechoice')>=0)){var products=[];this.fire(19,products);}}catch(e){console.log(e);}
try{if((this.getUrl().indexOf('https://www.o2online.de/econtract/options')>=0)){var products=[];this.fire(20,products);}}catch(e){console.log(e);}
try{if((this.getUrl().indexOf('https://www.o2online.de/econtract/data')>=0)){var products=[];this.fire(21,products);}}catch(e){console.log(e);}
try{if((this.getUrl().indexOf('https://www.o2online.de/econtract/checkout')>=0)){var products=[];this.fire(22,products);}}catch(e){console.log(e);}};module.exports=Funnel;return module.exports;}}
_trbo.modules['helper/ProductListing']={module:function(){var module={exports:function(){console.log('bad module helper/ProductListing.js');}};"use strict";var ProductListing=function(){this.log=[];this.productIds=[];this.productContainers=[];this.registerRerun();};ProductListing.prototype.setProductIds=function(list){this.productIds=list;};ProductListing.prototype.getProductIds=function(){try{var productIds=(function(){try{return[];}catch(e){return[];}})();}catch(e){productIds=[];}
this.productIds=productIds;return productIds;};ProductListing.prototype.getProductContainers=function(){try{var containers=(function(){try{return jTrbo('<div>');}catch(e){return jTrbo('<div>');}})();}catch(e){containers=[];}
this.productContainers=containers;return containers;};ProductListing.prototype.getProductContainerByProductId=function(productId){try{var container=(function(){try{return jTrbo('<div>');}catch(e){return jTrbo('<div>');}})(productId);}catch(e){return[];}
return container;};ProductListing.prototype.run=function(){var productIds=this.getProductIds();window._trboq=window._trboq||[];if(productIds.length>0){window._trboq.push(["dataMatching",{product_listing_ids:productIds.join("|")}]);}};ProductListing.prototype.registerRerun=function(){try{jTrbo("document").ready(function(){(function(){try{try{jTrbo('#applyFilters').on('click',}catch(e){};}catch(e){}})();});}catch(e){console.log(e);}};ProductListing.prototype.rerun=function(){this.run();_trbo.app.reloadApi(true,true);};module.exports=ProductListing;return module.exports;}}
_trbo.modules['helper/TestPush']={module:function(){var module={exports:function(){console.log('bad module helper/TestPush.js');}};"use strict";var TestPush=function(opts){this.log=[];this.opts=opts;this.externalPushIsBoundBySession=opts.externalPushIsBoundBySession||false;};TestPush.prototype.register=function(config){var me=this;this.log.push("register on :#"+config.module_selector);this.log.push("found :#"+jTrbo("#"+config.module_selector+",."+config.module_selector).length+" container");try{jTrbo("#"+config.module_selector+",."+config.module_selector).on("afterEventDispatched",function(event,eventName,moduleId,campaignId){var testSlotEventTypeId=parseInt(config.testing_slot_event_type_id,10);me.log.push("react on :#"+config.module_selector+": "+JSON.stringify(config)+" by "+eventName);if(testSlotEventTypeId===1&&eventName==="layerView"){me.fire(moduleId,campaignId,config.testing_slot_id,config.testing_slot_name);}else if(testSlotEventTypeId===2&&(eventName==="trackClickAndRedirect"||eventName==="redirect"||eventName==="layerClick")){me.fire(moduleId,campaignId,config.testing_slot_id,config.testing_slot_name);}});}catch(e){this.log.push("error register: "+e.message);}};TestPush.prototype.getExternalCustomDimensions=function(isBoundBySession){try{if(isBoundBySession===true||this.externalPushIsBoundBySession){const sessionId=_trbo.udp.getSession().sessionId;if(typeof _trbo.udp.data["externalCustomDimensionsBySession"]!=="undefined"&&typeof _trbo.udp.data["externalCustomDimensionsBySession"][sessionId]!=="undefined"){return _trbo.udp.data["externalCustomDimensionsBySession"][sessionId];}}else{if(typeof _trbo.udp.data["externalCustomDimensions"]!=="undefined"){return _trbo.udp.data["externalCustomDimensions"];}}}catch(e){this.log.push("error getExternalCustomDimensions: "+e.message);}
return{};};TestPush.prototype.setExternalCustomDimensions=function(data){try{const sessionId=_trbo.udp.getSession().sessionId;if(typeof _trbo.udp.data["externalCustomDimensionsBySession"]==="undefined"){_trbo.udp.data["externalCustomDimensionsBySession"]={};}
_trbo.udp.data["externalCustomDimensionsBySession"][sessionId]=data;try{Object.keys(_trbo.udp.data["externalCustomDimensionsBySession"]).forEach(function(x){if(x!=sessionId){delete _trbo.udp.data["externalCustomDimensionsBySession"][x];}});}catch(e){this.log.push("error old session cleanup: "+e.message);}
_trbo.udp.data["externalCustomDimensions"]=data;_trbo.udp.saveData();}catch(e){this.log.push("error setExternalCustomDimensions: "+e.message);}};TestPush.prototype.fire=function(moduleId,campaignId,slotId,slotValue){if(_trbo.app.layerApi&&_trbo.app.layerApi.response&&_trbo.app.layerApi.response.hasOwnProperty("dnt")&&_trbo.app.layerApi.response.dnt===true){this.log.push("fire prohibited: "+JSON.stringify({moduleId:moduleId,campaignId:campaignId,slotId:slotId,slotValue:slotValue,dnt:true}));return;}
var testPushData={};testPushData["slot"+slotId]=slotValue;window._trboq.push(["testingData",testPushData]);this.log.push("fire: "+JSON.stringify(testPushData));jTrbo(document).trigger("afterTestPushFired",[moduleId,campaignId,slotId,slotValue])};module.exports=TestPush;return module.exports;}}
_trbo.modules['helper/Testing']={module:function(){var module={exports:function(){console.log('bad module helper/Testing.js');}};"use strict";var Testing=function(opts){window._trboq=window._trboq||[];this.log=[];this.segmentTestCookieName="trbo_osi";this.campaignPreviewCookieName="trcpid";this.browser=opts.browser;this.styles="#tr_testing_notification {    position: fixed;bottom: 0;left: 50%;transform:translateX(-50%);background: #3fc0f0;color: #fff;font-family: Arial;font-size: 14px;padding: 0px 14px;transition: all .3s;    height: 0;    overflow : hidden;    z-index : 99999994;    border-radius : 4px 4px 0 0;}#tr_testing_notification.trboVisible {    padding: 14px;height: auto;}#tr_testing_notification a {    color: #fff;font-size: 14px;\n}#tr_testing_notification_close { margin-left : 20px; background: #3fc0f0;color: #fff;font-family: Arial;font-size: 14px;padding: 4px 8px;text-align: center;border: 2px solid #fff;font-size: 12px;border-radius: 4px;cursor: pointer;    transition: all .3s; white-space:nowrap}#tr_testing_notification_close:hover {     background: #00AFFE;\n}";var forcedSegmentId=this.browser.getUrlParam("trosi"),forcedSegmentName=this.browser.getUrlParam("trosn");this.startSegmentTest(forcedSegmentId,forcedSegmentName);};Testing.prototype.showMessage=function(){var trcpid=this.browser.getCookieRaw("trcpid"),segmentTestCookieContentRaw=this.browser.getCookieRaw(this.segmentTestCookieName),segmentTestCookieContent="",ud=JSON.parse(localStorage.getItem("_trbo_ud")),messages=[],lng="de",messageContainer=jTrbo("<div id='tr_testing_notification'><span id='tr_suffix'>Bitte beachten Sie: </span><span id='tr_testing_messages'></span><span id='tr_testing_notification_close'>Vorschau verlassen</span></div>");try{if(ud&&ud.user&&ud.user.lang==="en"){lng="en";}}catch(error){}
if(segmentTestCookieContentRaw){try{segmentTestCookieContent=JSON.parse(segmentTestCookieContentRaw);}catch(e){segmentTestCookieContent=false;}}
if(lng==="en"){if(segmentTestCookieContent&&segmentTestCookieContent.sid){var m=jTrbo("<span>the preview for <b></b> is active</span>");m.find("b").text(segmentTestCookieContent.sn);messages.push(m);}
messageContainer.find("#tr_testing_notification_close").html("Leave preview mode");messageContainer.find("#tr_suffix").html("Please observe: ");}else{if(segmentTestCookieContent&&segmentTestCookieContent.sid){var m=jTrbo("<span>Die Vorschau für <b></b> ist aktiv</span>");m.find("b").text(segmentTestCookieContent.sn);messages.push(m);}}
jTrbo.each(messages);if(!trcpid&&messages.length>0){jTrbo("body").append(messageContainer);jTrbo("body").append(jTrbo("<style></style>").html(this.styles));window.setTimeout(function(){messageContainer.addClass("trboVisible")},250);messageContainer.find("#tr_testing_notification_close").click);}};Testing.prototype.startSegmentTest=function(segmentId,segmentName){var dataMatching={override_segment_id:-1,override_segment_ids:-1,},me=this;try{var _tmp_date=new Date(),expire,content;if(segmentId){if(typeof segmentId==="string"&&segmentId.indexOf("|")===-1){segmentId=parseInt(segmentId,10);}
var _segmentNames=segmentName;try{_segmentNames=JSON.parse(decodeURIComponent(segmentName));_segmentNames=_segmentNames.join(",");}catch(e){_segmentNames=segmentName;}
content={sid:segmentId,sn:_segmentNames,};_tmp_date.setTime(_tmp_date.getTime()+(60*30*1000));expire=_tmp_date.toUTCString();document.cookie=this.segmentTestCookieName+'='+JSON.stringify(content)+';expires='+expire+';path=/';}else{var cookieContentRaw=this.browser.getCookieRaw(this.segmentTestCookieName),cookieContent,segmentId=false;if(cookieContentRaw){cookieContent=JSON.parse(cookieContentRaw);segmentId=cookieContent.sid;}
if(segmentId===false){this.stopSegmentTest();return;}}
if(segmentId){var isValid=false;if(typeof segmentId==="string"&&segmentId.indexOf("|")!==-1){delete dataMatching.override_segment_id;dataMatching.override_segment_ids=segmentId;isValid=true;}else if(parseInt(segmentId)&&parseInt(segmentId)>0){dataMatching.override_segment_id=segmentId;isValid=true;}
if(isValid){window.setTimeout,1000);}}
window._trboq.push(["dataMatching",dataMatching]);}catch(err){console.log(err);}};Testing.prototype.stopSegmentTest=function(){document.cookie=this.segmentTestCookieName+'=0;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/';try{window._trboq.push(["dataMatching",{override_segment_id:-1,override_segment_ids:-1}]);}catch(e){}};module.exports=Testing;return module.exports;}}
_trbo.modules['layer/LayerApi']={module:function(){var module={exports:function(){console.log('bad module layer/LayerApi.js');}};var json=require('lib/JSON'),Helper=require('Helper'),TextFormat=require('layer/TextFormat'),Triggers=require('layer/Triggers');function LayerApi(opts){this.allowAutoLayerViewEvent=true;if(!opts.layerProvider){throw Error('LayerApi requires layerProvider in opts');}
this.container=null;this.layerHtml=null;this.opts=opts;this.triggers=[];}
LayerApi.prototype.makeContainer=function(){var document=this.opts.userDataProvider.getBrowser().getDocument(),container=document.createElement('div'),config=this.opts.userDataProvider.getConfig();container.id='trbo_container_e0dd3c9ce40ccee402c5b331c88517a5';if(document&&document.body&&document.body.appendChild){document.body.appendChild(container);}else{jTrbo(document).ready,350);}
this.container=container;};LayerApi.prototype.insertStyles=function(){var document=this.opts.userDataProvider.getBrowser().getDocument(),head=document.getElementsByTagName('head')[0],styles=["//static.trbo.com/bootstrap-3.0.3_trbo.min.css","//static.trbo.com/fontawesome_trbo.min.css","//static.trbo.com/fontawesome-ie7_trbo.min.css","//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css"];for(var i=0,link;i<styles.length;i++){link=document.createElement('link');link.href=styles[i];link.rel="stylesheet";link.type="text/css";head.appendChild(link);}};LayerApi.prototype.applyRules=function(){var udp=this.opts.userDataProvider,campaign=udp.getConfig().campaign;if(campaign&&campaign.modules&&campaign.modules.length){for(var i in campaign.modules){var ruleName=campaign.modules[i].rule,negate=false;if(ruleName.substring(0,1)=='!'){negate=true;ruleName=ruleName.substring(1);}
var rule=require('rules/'+ruleName);if(negate^rule(udp)){return{moduleId:campaign.modules[i].moduleId}}}}
return false;};LayerApi.prototype.makeRequest=function(){var cic=[];if(typeof(_tr_global_click_in_channels_shop)!="undefined"){cic=_tr_global_click_in_channels_shop;}else if(document.cookie.indexOf('tr_cic=')>=0){cic=document.cookie.match('(^|;) ?tr_cic=([^;]*)(;|$)')[2];}
var udp=this.opts.userDataProvider;if(udp.getConfig().shopId==12856){if(jTrbo('#tyre-matchcode-search-input').length===1&&jTrbo('#tyre-matchcode-search-input').val()!=""){udp.addExternalData({searchDimension:jTrbo('#tyre-matchcode-search-input').val()});}}
var udp=this.opts.userDataProvider,rdt=this.opts.requestDataTransformer,window=udp.getBrowser().getWindow(),browser=udp.getBrowser(),currentConversion=udp.currentConversion,r={g:{st:udp.getSession().segmentId,p:browser.getLocation().href,t:udp.pluginStartTime,d:udp.getDeviceIds[udp.getBrowser().getDeviceData().device],dt:udp.getDeviceTypes[udp.getBrowser().getDeviceData().deviceType],sh:udp.getConfig().shopId,u:udp.getUser().userId,e:udp.getExternalUserId(),ts:udp.getUserSummary().saleCount,ust:udp.getUserSummary().userCreateTime,sdt:udp.getUserSummary().sessionDurationTotal,sc:udp.getUserSummary().sessionCount,bsc:udp.getUserSummary().brandSessionCount,bv:currentConversion?currentConversion.value:null,sid:udp.getSession().sessionId,pt:udp.getPageTypeId(udp.getPage().type),cb:udp.getCurrentBasket(),bw:browser.getViewport().width,bh:browser.getViewport().height,ct:udp.getChannels()[udp.getSession().channelData.channel],cic:cic,cic2:udp.getChannelData(),ref:''},s:rdt.getLatestSessions(),p:rdt.getProducts(),pl:udp.getLikedProducts(),pdl:udp.getDislikedProducts(),pc:rdt.getProductsCount(),sp:rdt.getSessionProducts(),cp:udp.getCurrentProductIds(),nbp:rdt.getNotBoughtProducts(),c:rdt.getSales(),mc:rdt.getModuleClicks(),b:rdt.getBasketData(),m:rdt.makeModules(),bl:browser.getClosedModules(),dl:udp.getDatalayerData(),seg:udp.getSegmentData(),se:udp.getStoryData(),cds:udp.dynamicSegment.getCustomDynamicSegmentConfigs()};try{if(document&&document.referrer&&document.referrer!==""){r.g.ref=document.referrer.substr(0,150);}}catch(err){}
try{if(udp.getConfig().skipLocalStorage===true){r.g.sdt=1;}}catch(err){}
try{if(udp.getConfig().allowCrossDevice===true){r.g.acd=1;}else{r.g.acd=0;}}catch(e){r.g.acd=0;}
try{var tmpTestingCookie=this.readTestingCookie();if(tmpTestingCookie&&tmpTestingCookie!==''){r.trcpid=tmpTestingCookie;}}catch(err){}
try{var geoData=sessionStorage["tr_geo"];if(geoData){r.geo=JSON.parse(geoData);}}catch(e){}
try{r.dd=udp.getBrowser().detectDevice();}catch(e){}
if(typeof this.opts.subplugins!='undefined'&&this.opts.subplugins.length>0){var requiredSubplugin,subpluginInstance;for(var key in this.opts.subplugins){if(this.opts.subplugins.hasOwnProperty(key)){requiredSubplugin=require(this.opts.subplugins[key]);subpluginInstance=new requiredSubplugin(this.opts);if(typeof requiredSubplugin.prototype.preRequest!='undefined'){r=subpluginInstance.preRequest(r);}}}}
return r;};LayerApi.prototype.readTestingCookie=function(){var testingCookieValue='';try{var testingCookieName='trcpid=';var cookieData=document.cookie.split(';');for(var i=0;i<cookieData.length;i++){var c=cookieData[i];if(c.charAt(0)==' ')c=c.substring(1);if(c.indexOf(testingCookieName)===0){var tmpTestingCookieValue=JSON.parse(c.substring(testingCookieName.length,c.length));if(tmpTestingCookieValue&&tmpTestingCookieValue.s&&tmpTestingCookieValue.c&&tmpTestingCookieValue.cl){testingCookieValue=tmpTestingCookieValue.cl+'-'+tmpTestingCookieValue.s+'-'+tmpTestingCookieValue.c;if(tmpTestingCookieValue.m){testingCookieValue+='-'+tmpTestingCookieValue.m.join(',');}
if(tmpTestingCookieValue.tb){if(!tmpTestingCookieValue.m){testingCookieValue+='-0';}
testingCookieValue+='-'+tmpTestingCookieValue.tb;}else if(tmpTestingCookieValue.tp){if(!tmpTestingCookieValue.m){testingCookieValue+='-0';}
testingCookieValue+='-0-'+tmpTestingCookieValue.tp;}}}}}catch(err){}
return testingCookieValue;};LayerApi.prototype.callLayer=function(){var udp=this.opts.userDataProvider,window=udp.getBrowser().getWindow();var deviceType=udp.getBrowser().getDeviceData().deviceType;if(!(deviceType=='desktop')){if(!this.opts.userDataProvider.config.shopId){return;}}
var rulesResult=this.applyRules();if(!rulesResult){rulesResult={moduleId:0};}
var layerRequest=this.makeRequest();if(window.trbo_track_conversion){layerRequest.ct=json.stringify(window.trbo_track_conversion);}
var cancel=false;if(typeof layerRequest.d!='undefined'){for(var i=0;i<layerRequest.d.length;i++){if(typeof layerRequest.d[i].d!='undefined'&&layerRequest.d[i].d=='c'){cancel=true;}}}
if(cancel===false){delete layerRequest.d;this.opts.layerProvider.callLayer(layerRequest,{rulesResult:rulesResult});if(_trbo.app.opts.config.requestBlockTime){_trbo.app.blockRequest=true;window.setTimeout,_trbo.app.opts.config.requestBlockTime);}}
try{udp.funnel.run();}catch(e){}};LayerApi.prototype.insertLayer=function(html,layerId){var document=this.opts.userDataProvider.getBrowser().getDocument(),jquery=this.opts.userDataProvider.getBrowser().getJquery(),me=this,_insertLayer=function(moduleString){if(me.opts.config.cspSettings&&me.opts.config.cspSettings.active===true){var jModule=jquery(moduleString),nonceValue=me.opts.config.cspSettings.getNonceValue();jquery.each(jModule,function(modulePartIndex,modulePart){var _t=jquery(modulePart),_tagName=_t.prop("tagName"),_id=_t.attr("id"),_className=_t.attr("class");if(_tagName){var s=document.createElement(_tagName.toLowerCase());s.innerHTML=_t.html();if(_id){s.id=_t.attr("id");}
if(_className){s.className=_t.attr("class");}
if(_tagName==="SCRIPT"||_tagName==="STYLE"){s.setAttribute("nonce",nonceValue);}
document.body.appendChild(s);}});}else{jquery(document).find('body').append(html);}};if(_trbo.app.opts.config.shopId==13477||_trbo.app.opts.config.shopId==13329||_trbo.app.opts.config.shopId==13328){console.log("skip insertLayer");if(html.indexOf("trboModule_")===-1){return;}}
if(document.querySelectorAll('.trbo_wrapper_'+layerId).length>0){return;}
if(jquery('.trboModuleContainer.trbo_module_'+layerId).length>0){if(jquery('.trboModuleContainer.trbo_module_'+layerId).length===1){var _tr_container_unique_id=jquery('.trboModuleContainer.trbo_module_'+layerId).attr('id');if(_tr_container_unique_id&&_tr_container_unique_id!==''&&_tr_container_unique_id.indexOf('_container')>0){var _tr_container_instance_id=_tr_container_unique_id.replace('_container','_instance');if(typeof window[_tr_container_instance_id]!=="undefined"&&window[_tr_container_instance_id]&&window[_tr_container_instance_id].moduleCallback){window[_tr_container_instance_id].moduleCallback();}}}
return;}
if(jquery){try{if(jquery(document).find('body').length<=0){var insertLayerTries=0;var insertLayerInterval=window.setInterval(function(layerId){if(jquery(document).find('body').length>0){_insertLayer(html);window.clearInterval(insertLayerInterval);}
insertLayerTries++;if(insertLayerTries>100){_insertLayer(html);window.clearInterval(insertLayerInterval);}},35,layerId);}else{_insertLayer(html);}}catch(err){console.log("eval.j error");console.log(err);}}else{var scripts=this.container.getElementsByTagName('script');for(var n in scripts){try{eval(scripts[n].innerHTML);}catch(err){console.log("eval error");console.log(err);}}}};LayerApi.prototype.callback=function(args){var that=this,firstLayer,secondLayer,_add_layer_triggers=[],udp=this.opts.userDataProvider,exitTriggerBound=this.opts.config.exitTriggerBound||10,session=udp.getSession(),sessionUpdated=false;this.response=args;window._trbo_obj=window._trbo_obj||{};window._trbo_obj.apiStatus='returned';try{if(window._trbo_obj.apiReturned&&typeof window._trbo_obj.apiReturned==='function'){window._trbo_obj.apiReturned.call();}}catch(err){}
try{jTrbo('head').removeClass('trbo-hide-async');}catch(err){}
if(args.code){if(args.code!=200){udp.opts.browser.log('warn',args.code+': '+args.msg);}}
try{if(args&&args.geo&&udp.getConfig().skipLocalStorage!==true){sessionStorage["tr_geo"]=JSON.stringify(args.geo);}}catch(e){}
if(!args)return null;if(typeof args.segment_id!='undefined'&&session.segmentId!=args.segment_id){udp.getSession().segmentId=args.segment_id;sessionUpdated=true;}
if(typeof args.ab_group!='undefined'&&session.abGroup!=args.ab_group){udp.getSession().abGroup=args.ab_group;sessionUpdated=true;}
if(typeof args.close_affects_abgroup!='undefined'&&session.closeAffectsAbgroup!=args.close_affects_abgroup){udp.getSession().closeAffectsAbgroup=args.close_affects_abgroup;sessionUpdated=true;}
var _click_in_channels=[];if(typeof args.cic!='undefined'&&args.cic!=''&&parseInt(this.opts.userDataProvider.config.shopId)!=12526&&parseInt(this.opts.userDataProvider.config.shopId)!=12525){if(document.cookie.indexOf('tr_cic=')>=0){_click_in_channels.push(document.cookie.match('(^|;) ?tr_cic=([^;]*)(;|$)')[2]);}else{_click_in_channels.push(args.cic);var _tr_global_click_in_channels_shop_date=new Date();if(parseInt(this.opts.userDataProvider.config.shopId)==12517){_tr_global_click_in_channels_shop_date.setTime(_tr_global_click_in_channels_shop_date.getTime()+(1000*60*60*24));}else{_tr_global_click_in_channels_shop_date.setTime(_tr_global_click_in_channels_shop_date.getTime()+(1000*60*60*1));}
document.cookie="tr_cic="+args.cic+";path=/; expires="+_tr_global_click_in_channels_shop_date.toUTCString();}}
try{var _tr_api_update_save=false;if(typeof args.seg!=='undefined'&&args.seg!==''&&args.seg!==false){udp.addSegmentData(args.seg,true);_tr_api_update_save=true;try{var _tracking_segment_ids=[];for(var _seg_i in args.seg){if(_seg_i>=10&&typeof(args.seg[_seg_i])==='number'){_tracking_segment_ids.push(_seg_i);}}
if(_tracking_segment_ids.length>0){var _segment_tracking_event={stt:'onsite',sts:_tracking_segment_ids.join(',')}
if(udp.currentConversion&&udp.currentConversion.conversionType&&udp.currentConversion.conversionType==='sale'){_segment_tracking_event.stt='sale';_segment_tracking_event.value=udp.currentConversion.value;}
window._trboq.push(['segmentId',_segment_tracking_event]);}}catch(err){}}
if(typeof args.se!=='undefined'&&args.se!==''&&args.se!==false){udp.addStoryData(args.se,true);_tr_api_update_save=true;}
if(typeof args.cic2!=='undefined'&&args.cic2!==''&&args.cic2!==false){udp.addChannelData(args.cic2,true);_tr_api_update_save=true;}
if(typeof args.xdl!=='undefined'&&args.xdl!==''&&args.xdl!==false){udp.addExternalData(args.xdl);_tr_api_update_save=true;}
if(_tr_api_update_save===true){udp.saveData();}}catch(err){}
if(args.content_api2){if($jTrbo){TextFormat($jTrbo);}
try{if(args.xng&&args.xng!==""&&this.opts.userDataProvider){this.opts.userDataProvider.xng=args.xng;}}catch(err){}
if(args.sticky&&args.sticky!='none'){var config=udp.getConfig(),layerSticker={sticky:args.sticky,m:args.m,ci:args.ci};if(args.data&&args.data.coupons&&args.data.coupons[0].coupon_code_id){layerSticker.cci=args.data.coupons[0].coupon_code_id;}
udp.getSession().m=layerSticker;if(!config.skipCookies){if(args.sticky_global&&args.sticky_global==1){}else{}}
sessionUpdated=true;}
firstLayer=new Triggers({udp:udp,moduleId:args.m,triggers:args.triggers,exitTriggerBound:exitTriggerBound,fun:function(){that.insertLayer(args.content_api2,args.m);}});firstLayer.show();if(args.triggers&&args.triggers.length>0){this.triggers.push(firstLayer);}
if(typeof args.additional_layers!=="undefined"){if(parseInt(args.m)>3000){jTrbo.each(args.additional_layers,function(index,additional_layer){var trigger=new Triggers({udp:udp,moduleId:args.m,triggers:additional_layer.triggers,exitTriggerBound:exitTriggerBound,fun:function(){that.insertLayer(additional_layer.content_api2,additional_layer.m);try{this.disable();}catch(e){}}});trigger.show();if(additional_layer.triggers.length>0){that.triggers.push(trigger);}});}else{var secondArgs=args.additional_layers[0];secondLayer=new Triggers({udp:udp,moduleId:args.m,triggers:secondArgs.triggers,exitTriggerBound:exitTriggerBound,fun});secondLayer.show();if(secondArgs.triggers.length>0){this.triggers.push(secondLayer);}}}}
if(args.code&&args.code!=200&&args.devmode&&console){console.warn('LayerApi.callback: '+args.msg);}
if(args.devcode&&args.devcode!==""){var jquery=this.opts.userDataProvider.getBrowser().getJquery();jquery(document).find('body').append(args.devcode);}
if(sessionUpdated){udp.saveData();}};LayerApi.prototype.moveToWithoutTrbo=function(){var udp=this.opts.userDataProvider;udp.getSession().abGroup=0;udp.saveData();};LayerApi.prototype.disableTriggers=function(){if(this.triggers.length>0){for(var index in this.triggers){try{this.triggers[index].disable();}catch(e){console.log("failed to disable trigger for",this.triggers[index]);}}}
this.triggers=[];};module.exports=LayerApi;return module.exports;}}
_trbo.modules['layer/LayerProvider']={module:function(){var module={exports:function(){console.log('bad module layer/LayerProvider.js');}};"use strict";var Helper=require('Helper'),json=require('lib/JSON')
LayerProviderV3.prototype.callLayer=function(layerRequest){var document=this.opts.browser.getDocument(),script=document.createElement('script'),src=this.opts.apiBaseUrl,stringified={};window._trbo_obj=window._trbo_obj||{};window._trbo_obj.apiStatus='pending';if(layerRequest){if(layerRequest.ct){delete layerRequest.ct;}
for(var key in layerRequest){stringified[key]=json.stringify(layerRequest[key]);}
if(window._trbo_overwrite_api_base_url&&window._trbo_overwrite_api_base_url!==""){this.opts.config.apiBaseUrl=window._trbo_overwrite_api_base_url;}else if(typeof(_trbo)!=='undefined'&&_trbo.pluginConfig&&_trbo.pluginConfig.overwrite_api_base_url&&_trbo.pluginConfig.overwrite_api_base_url!==""){this.opts.config.apiBaseUrl=_trbo.pluginConfig.overwrite_api_base_url;}
var _api_script_name='/r.php';if(window._trbo&&window._trbo.pluginConfig&&window._trbo.pluginConfig.overwrite_api_script_name&&window._trbo.pluginConfig.overwrite_api_script_name!==""){_api_script_name=window._trbo.pluginConfig.overwrite_api_script_name;}
script.type='text/javascript';script.src=this.opts.config.apiBaseUrl+_api_script_name+'?'+Helper.makeQueryString(stringified);script.async=1;if(document.location.href.indexOf('felix=test2')>=0&&document.location.hostname.indexOf('blau.de')>=0){document.head.appendChild(script);}else if(document.location.href.indexOf('felix=test')>=0||document.location.hostname.indexOf('blau.de')>=0||document.location.hostname.indexOf('o2online.de')){jTrbo.getScript(this.opts.config.apiBaseUrl+_api_script_name+'?'+Helper.makeQueryString(stringified));}else if(this.opts.config.apiBaseUrl.indexOf('api-v2')>=0){jTrbo('body').append(script);}else{try{jTrbo.getScript(this.opts.config.apiBaseUrl+_api_script_name+'?'+Helper.makeQueryString(stringified));}catch(err){}}}};module.exports=LayerProviderV3;return module.exports;}}
_trbo.modules['layer/RequestDataTransformer']={module:function(){var module={exports:function(){console.log('bad module layer/RequestDataTransformer.js');}};"use strict";var Helper=require('Helper'),json=require('lib/JSON');var RequestDataTransformer=function(udp){this.udp=udp;};RequestDataTransformer.prototype.composeEvents=function(){var events=[],keys=[],sessionEvents=this.udp.getSession().events,sessions=this.udp.data.sessions,index=0;if(sessionEvents){events[index]=[];for(var i=sessionEvents.length-1,c=0;c<=i;i--){events[index].unshift(sessionEvents[i]);}}
if(Helper.olen(sessions)>0){for(var key in sessions){keys.unshift(key);}
var allSessionsEvents;for(var k=0;k<keys.length;k++){index++;events[index]=[];allSessionsEvents=sessions[keys[k]].events;for(var i=allSessionsEvents.length-1,c=0;c<=i;i--){events[index].push(allSessionsEvents[i]);}}}
return events;};RequestDataTransformer.prototype.processEvents=function(events,event,type){var data={},eventTime;if(event==="layerClick"){data=[];}
if(events)for(var c=events.length-1,n=0;n<=c;c--){if(events[c].type==event&&(!type||type&&events[c].data.conversionType==type)){var products=[],p=[];if(events[c].data&&events[c].data.products&&events[c].data.products!==""){products=json.parse(events[c].data.products);}
if(event=='conv'&&type=='sale'){for(var i=0;i<products.length;i++){try{p.push(products[i].product_id);}catch(e){}}
data[events[c].data.conversionId]={cv:events[c].data.value,t:events[c].data.clientTime,p:p};this.udp.saveData();}
else if(event=='productView'||(event=='conv'&&type=='basket')){eventTime=events[c].data.clientTime;for(var i=0;i<products.length;i++){try{if(products[i].product_id==undefined&&products[i].products_id!=undefined){products[i].product_id=products[i].products_id;}
if(products[i].product_id==undefined&&products[i].id!=undefined){products[i].product_id=products[i].id;}
if(!data[products[i].product_id]||data[products[i].product_id]<eventTime){data[products[i].product_id]=eventTime;}}catch(e){}}
if(type=='basket'&&Helper.olen(data)>0){break;}}else if(event=="layerClick"){var moduleId=events[c].moduleId;if(data.indexOf(moduleId)===-1){data.push(moduleId);}}}}
return data;};RequestDataTransformer.prototype.getEventData=function(event,type,max){var events=this.composeEvents(),currentEvents,obj={};currentEvents=this.processEvents(events[0],event,type,max);if(event=='conv'&&type=='basket'){if(Helper.olen(currentEvents)>0){return currentEvents;}
else{for(var i=0;i<events.length;i++){obj=this.processEvents(events[i],event,type,max);if(Helper.olen(obj)>0){break;}}
return obj;}}
else{for(var i=0;i<events.length;i++){obj=Helper.mergeObjects(obj,this.processEvents(events[i],event,type,max));}
obj=Helper.mergeObjects(obj,currentEvents);return obj;}};RequestDataTransformer.prototype.getSales=function(){return Helper.cut(this.getEventData('conv','sale'),15,true);};RequestDataTransformer.prototype.getNotBoughtProducts=function(){try{var allEventsBySession=this.composeEvents(),allSaleProducts=[],allBasketProducts=[],notBoughtProducts=[],result={};jTrbo.each(allEventsBySession,function(sessionIndex,sessionEvents){var _sessionBasketProducts=[];jTrbo.each(sessionEvents,function(eventIndex,event){try{if(event.data.conversionType==="basket"&&event.data.products){var products=JSON.parse(event.data.products);jTrbo.each(products,function(productIndex,product){_sessionBasketProducts.push(product);});}else if(event.data.conversionType==="sale"&&event.data.products){var products=JSON.parse(event.data.products);jTrbo.each(products);}}catch(e){}});allBasketProducts=allBasketProducts.concat(_sessionBasketProducts);});jTrbo.each(allBasketProducts,function(eventIndex,basketProduct){try{var basketProductId=basketProduct.product_id;if(allSaleProducts.indexOf(basketProductId)===-1&&eventIndex<20){result[basketProductId]=parseFloat(basketProduct.price)||0;}}catch(e){}});return result;}catch(e){}
return result;};RequestDataTransformer.prototype.getModuleClicks=function(){try{var result=[],events=Helper.cut(this.getEventData('layerClick',null),10);jTrbo.each(events);return result;}catch(e){return[];}};RequestDataTransformer.prototype.getProducts=function(){var _tmp_event_data=this.getEventData('productView',null);var _newObj={};var _maxProducts=13;if(this.udp&&this.udp.config&&this.udp.config.shopId==12897){_maxProducts=26;}
var keysSorted=Object.keys(_tmp_event_data).sort(function(a,b){return _tmp_event_data[b]-_tmp_event_data[a]});for(var i=0;i<keysSorted.length;i++){if(i<_maxProducts){_newObj[keysSorted[i]]=_tmp_event_data[keysSorted[i]];}}
return _newObj;};RequestDataTransformer.prototype.getProductsCount=function(){var sessionEvents=this.composeEvents();var _newObj={},_result={},lastProducts=this.getProducts();try{jTrbo.each(sessionEvents,function(sessionIndex,session){jTrbo.each(session,function(eventIndex,event){if(event.type==="productView"&&event.data&&event.data.products&&event.data.clientTime){var products=JSON.parse(event.data.products);jTrbo.each(products,function(productIndex,product){if(product.product_id){if(!_newObj.hasOwnProperty(product.product_id)){_newObj[product.product_id]=1;}else{_newObj[product.product_id]++;}}});}});});jTrbo.each(lastProducts,function(productId,timestamp){if(_newObj.hasOwnProperty(productId)){_result[productId]=_newObj[productId];}});}catch(e){}
return _result;};RequestDataTransformer.prototype.getSessionProducts=function(){var sessionEvents=this.udp.getSession().events,_tmp_event_data={},_newObj={};jTrbo.each(sessionEvents,function(eventIndex,event){var products=[];if(event.type==="productView"&&event.data&&event.data.products&&event.data.clientTime){products=JSON.parse(event.data.products);try{jTrbo.each(products,function(productIndex,product){if(product.product_id){_tmp_event_data[product.product_id]=event.data.clientTime;}});}catch(e){}}});var keysSorted=Object.keys(_tmp_event_data).sort(function(a,b){return _tmp_event_data[b]-_tmp_event_data[a]});for(var i=0;i<keysSorted.length;i++){if(i<13){_newObj[keysSorted[i]]=_tmp_event_data[keysSorted[i]];}}
return _newObj;};RequestDataTransformer.prototype.getBasketData=function(){return Helper.cut(this.getEventData('conv','basket'),10,true);};RequestDataTransformer.prototype.makeModules=function(){var s=this.udp.getSession(),m={},start=0,udpModules=this.udp.data.m;if(!s.m)return udpModules;if(!udpModules)return[];for(var i=0;i<udpModules.length;i++){m[udpModules[i].m]=udpModules[i].ci;}
if(!Helper.olen(udpModules)||s.m.sticky=='module'&&(typeof m[s.m.m]=='undefined'||(m[s.m.m]&&m[s.m.m]!=s.m.ci))){udpModules.push({m:s.m.m,ci:s.m.ci,cci:s.m.cci});}
udpModules=udpModules.slice(-3);if(s.m&&s.m.m){var duplicate=false;for(var i=0;i<udpModules.length;i++){if(udpModules[i].m==s.m.m&&udpModules[i].ci==s.m.ci){duplicate=true;break;}}
if(!duplicate){udpModules.push({m:s.m.m,ci:s.m.ci,cci:s.m.cci});udpModules=udpModules.slice(-3);}}
return udpModules;};RequestDataTransformer.prototype.getLatestSessions;module.exports=RequestDataTransformer;return module.exports;}}
_trbo.modules['layer/TextFormat']={module:function(){var module={exports:function(){console.log('bad module layer/TextFormat.js');}};module.exports=function($){$.fn.trbo_textF=function(optName,opts){var fontStyle=$.parseJSON(opts[optName+'_em']),content=opts[optName];return this.each(function(){$(this).css({'font-family':opts[optName+'_fontfamily'],'font-size':opts[optName+'_fontsize']+'em','color':'#'+opts[optName+'_color'],'font-weight':fontStyle.b?'bold':'inherit','font-style':fontStyle.i?'italic':'inherit','text-decoration':fontStyle.u?'underline':'inherit'}).html(content);});};$.fn.trbo_ctaF=function(opts){return this.each(function(){var me=$(this);$(this).css({"-webkit-border-radius":opts.radius,"-moz-border-radius":opts.radius,"-ms-border-radius":opts.radius,"-o-border-radius":opts.radius,"border-radius":opts.radius,"border-color":opts.borderColor,"background-color":opts.bgColor}).addClass('glowing-off');if(opts.isGlow){setInterval(function(){if(me.hasClass('glowing-off')){me.css({'-moz-box-shadow':'0px 0px 12px '+opts.glowColor,'-webkit-box-shadow':'0px 0px 12px '+opts.glowColor,'box-shadow':'0px 0px 12px '+opts.glowColor});}else{me.css({'-moz-box-shadow':'0px 0px 1px '+opts.glowColor,'-webkit-box-shadow':'0px 0px 1px '+opts.glowColor,'box-shadow':'0px 0px 1px '+opts.glowColor});}
me.toggleClass('glowing').toggleClass('glowing-off');},750);}});};};return module.exports;}}
_trbo.modules['layer/Triggers']={module:function(){var module={exports:function(){console.log('bad module layer/Triggers.js');}};var inserted_module_trigger={exit:[],inactive:[],exitMobile:[]};function Triggers(opts){var that=this;this.moduleId=opts.moduleId;this.udp=opts.udp;this.triggers=opts.triggers||[];this.showFunction=opts.fun;this.exitTriggerBound=opts.exitTriggerBound||10;this.availableTriggers={};this.availableTriggers.default=function(){that.showFunction();};this.availableTriggers.exit=function(value){var document=that.udp.getBrowser().getDocument(),window=that.udp.getBrowser().getWindow(),_value;try{if(value&&typeof value!=="undefined"){_value=parseInt(value);}else{_value=that.exitTriggerBound;}
if(_value===0){_value=that.exitTriggerBound;}}catch(e){_value=that.exitTriggerBound;}
if(inserted_module_trigger.exit.indexOf(this.moduleId)<0){inserted_module_trigger.exit.push(this.moduleId);}else{return;}
that.mouseWatch({topLeft:{x:0,y:0,w:((window.innerWidth||document.documentElement.clientWidth)/ 2)-10,h:_value,mouseDir:['NE','N','NW'],onEnter:that.showFunction},topRight:{x:((window.innerWidth||document.documentElement.clientWidth)/ 2)+10,y:0,w:((window.innerWidth||document.documentElement.clientWidth)/ 2)-10,h:_value,mouseDir:['NW','N','NE'],onEnter:that.showFunction},});};this.availableTriggers.exitMobile=function(){var document=that.udp.getBrowser().getDocument();if(!inserted_module_trigger.hasOwnProperty("exitMobile")){inserted_module_trigger.exitMobile=[];}
if(inserted_module_trigger.exitMobile.indexOf(this.moduleId)<0){inserted_module_trigger.exitMobile.push(this.moduleId);}else{return;}
var hiddenKey,visibilityChangeEvent;if(typeof document.hidden!=="undefined"){hiddenKey="hidden";visibilityChangeEvent="visibilitychange";}else if(typeof document.msHidden!=="undefined"){hiddenKey="msHidden";visibilityChangeEvent="msvisibilitychange";}else if(typeof document.webkitHidden!=="undefined"){hiddenKey="webkitHidden";visibilityChangeEvent="webkitvisibilitychange";}
var handler=function(){that.showFunction();that.removeEventListener(document,visibilityChangeEvent,handler);jTrbo(window).off("blur",handler);};if(typeof document.addEventListener==="undefined"||hiddenKey===undefined){}else{document.addEventListener(visibilityChangeEvent,handler,false);jTrbo(window).on("blur",handler);this.removeExitTriggerMobile}};this.availableTriggers.inactive=function(value){var document=that.udp.getBrowser().getDocument(),idleTime=0,inactivity,showLayer=false,handler;if(inserted_module_trigger.inactive.indexOf(this.moduleId)<0){inserted_module_trigger.inactive.push(this.moduleId);}else{return;}
handler=function(event){idleTime=0;if(showLayer){that.showFunction();that.removeEventListener(document,'mousemove',handler);that.removeEventListener(document,'keypress',handler);that.removeEventListener(document,'touchstart',handler);}};inactivity=setInterval(function(){idleTime+=1;if(idleTime>=value){clearInterval(inactivity);showLayer=true;}},1000);that.addEventListener(document,'mousemove',handler);that.addEventListener(document,'keypress',handler);that.addEventListener(document,'touchstart',handler);that.removeInactive=function(){that.removeEventListener(document,'mousemove',handler);that.removeEventListener(document,'keypress',handler);that.removeEventListener(document,'touchstart',handler);clearInterval(inactivity);showLayer=false;}};this.availableTriggers.instantInactive=function(value){var document=that.udp.getBrowser().getDocument(),idleTime=0,inactivity,showLayer=false,handler;if(inserted_module_trigger.inactive.indexOf(this.moduleId)<0){inserted_module_trigger.inactive.push(this.moduleId);}else{return;}
handler=function(event){idleTime=0;if(showLayer){that.showFunction();that.removeEventListener(document,'mousemove',handler);that.removeEventListener(document,'keypress',handler);that.removeEventListener(document,'touchstart',handler);}};inactivity=setInterval(function(){idleTime+=1;if(idleTime>=value){clearInterval(inactivity);showLayer=true;handler();}},1000);that.addEventListener(document,'mousemove',handler);that.addEventListener(document,'keypress',handler);that.addEventListener(document,'touchstart',handler);that.removeInstantInactive=function(){that.removeEventListener(document,'mousemove',handler);that.removeEventListener(document,'keypress',handler);that.removeEventListener(document,'touchstart',handler);clearInterval(inactivity);showLayer=false;}};this.availableTriggers.timeout=function(value){var timeoutId=setTimeout(that.showFunction,parseInt(value)*1000);that.removeTimeoutTrigger=function(){window.clearTimeout(timeoutId);}}
this.availableTriggers.scroll=function(value){var document=that.udp.getBrowser().getDocument(),documentHeight=document.documentElement.offsetHeight,handler;if(document.body.scrollHeight&&document.body.scrollHeight>documentHeight){documentHeight=document.body.scrollHeight;}
handler=function(event){var viewportHeight=window.innerHeight||document.documentElement.clientHeight,scroll=document.documentElement.scrollTop||document.body.scrollTop;if((viewportHeight+scroll)/ documentHeight*100>=value){that.showFunction();that.removeEventListener(document,'scroll',handler);}};that.addEventListener(document,'scroll',handler);that.removeExitTrigger=function(){that.removeEventListener(document,'mousemove',handler);}};this.availableTriggers.scrollpixel=function(value){var document=that.udp.getBrowser().getDocument(),documentHeight=document.documentElement.offsetHeight,handler;handler=function(event){var scroll=document.documentElement.scrollTop||document.body.scrollTop;if(scroll>=value){that.showFunction();that.removeEventListener(document,'scroll',handler);}};that.addEventListener(document,'scroll',handler);that.removeScrollTrigger=function(){that.removeEventListener(document,'scroll',handler);}};this.availableTriggers.scrollInverse=function(value){var document=that.udp.getBrowser().getDocument(),oldScrollY,inverseHandler,activateHandler;value=typeof value!=="undefined"?value:0;inverseHandler=function(event){var scroll=document.documentElement.scrollTop||document.body.scrollTop;if(scroll<oldScrollY){that.showFunction();that.removeEventListener(document,'scroll',inverseHandler);}
oldScrollY=scroll;};activateHandler=function(event){var scroll=document.documentElement.scrollTop||document.body.scrollTop;if(scroll>=value){that.removeEventListener(document,'scroll',activateHandler);that.addEventListener(document,'scroll',inverseHandler);}
oldScrollY=scroll;}
that.addEventListener(document,'scroll',activateHandler);that.removeScrollInverseTrigger=function(){that.removeEventListener(document,'scroll',inverseHandler);that.removeEventListener(document,'scroll',activateHandler);}};this.availableTriggers.scrollInversePercent=function(value){var document=that.udp.getBrowser().getDocument(),oldScrollY,inverseHandler,activateHandler;value=typeof value!=="undefined"?value:0;inverseHandler=function(event){var scroll=document.documentElement.scrollTop||document.body.scrollTop;if(scroll<oldScrollY){that.showFunction();that.removeEventListener(document,'scroll',inverseHandler);}
oldScrollY=scroll;};activateHandler=function(event){var scroll=document.documentElement.scrollTop||document.body.scrollTop,viewportHeight=document.documentElement.clientHeight||document.body.clientHeight,documentHeight=document.documentElement.scrollHeight||document.body.scrollHeight;if(!isNaN(document.documentElement.clientHeight)&&!isNaN(document.body.clientHeight)){viewportHeight=Math.min(document.documentElement.clientHeight,document.body.clientHeight);}
let diff=documentHeight-viewportHeight<=0?documentHeight:documentHeight-viewportHeight;if(scroll / diff*100>=value){that.removeEventListener(document,'scroll',activateHandler);that.addEventListener(document,'scroll',inverseHandler);}
oldScrollY=scroll;}
that.addEventListener(document,'scroll',activateHandler);that.removeScrollInverseTriggerPercent=function(){that.removeEventListener(document,'scroll',inverseHandler);that.removeEventListener(document,'scroll',activateHandler);};};this.availableTriggers.waitTime=function(value){const key='tr_wt_'+that.moduleId;let timerHandle;value=typeof value!=="undefined"?parseInt(value):0;if(isNaN(value)){value=0;}
function addSeconds(date,seconds){return new Date(date.getTime()+seconds*1000);}
if(!localStorage.getItem(key)){localStorage.setItem(key,addSeconds(new Date(),value).getTime());}
timerHandle=setInterval(function(){const currentTime=new Date().getTime();const timeLeft=localStorage.getItem(key)-currentTime;if(timeLeft<=0){that.showFunction();clearInterval(timerHandle);}},1000);that.removeWaitTimeTrigger;};}
Triggers.prototype.addEventListener=function(eventTarget,eventName,handler){if(eventTarget.addEventListener){eventTarget.addEventListener(eventName,handler,false);}else{eventTarget.attachEvent('on'+eventName,handler);}};Triggers.prototype.removeEventListener;Triggers.prototype.mouseWatch=function(areas){var document=this.udp.getBrowser().getDocument(),that=this,x0=0,y0=0,mouseDir='',isNeededDir,isHovered,handler;handler=function(event){var x1=event.pageX,y1=event.pageY;mouseDir='';if(y1!=y0){mouseDir+=y1>y0?'S':'N';}
if(x1!=x0){mouseDir+=x1>x0?'E':'W';}
isHovered(x0,y0);x0=x1;y0=y1;};isNeededDir=function(neededDirs){for(var i=0;i<neededDirs.length;i++){if(neededDirs[i]==mouseDir){return true;}}
return false;};isHovered=function(x,y){var area,key;for(key in areas){if(areas.hasOwnProperty(key)){area=areas[key];var scrollY=area.y+(document.documentElement.scrollTop||document.body.scrollTop);if(x>=area.x&&x<=area.x+area.w&&y>=scrollY&&y<=scrollY+area.h&&isNeededDir(area.mouseDir)){area.onEnter();that.removeEventListener(document,'mousemove',handler);}}}};this.addEventListener(document,'mousemove',handler);this.removeExitTrigger};Triggers.prototype.show=function(){var i,trigger;if(this.triggers.length===0){this.showFunction();return;}
for(i=0;i<this.triggers.length;i++){trigger=this.triggers[i];if(this.availableTriggers.hasOwnProperty(trigger.name)){this.availableTriggers[trigger.name](parseInt(trigger.value,10));}}};Triggers.prototype.disable=function(){if(this.hasOwnProperty("removeExitTrigger")){this.removeExitTrigger.apply();}
if(this.hasOwnProperty("removeExitTriggerMobile")){this.removeExitTriggerMobile.apply();}
if(this.hasOwnProperty("removeInstantInactive")){this.removeInstantInactive.apply();}
if(this.hasOwnProperty("removeInactive")){this.removeInactive.apply();}
if(this.hasOwnProperty("removeTimeoutTrigger")){this.removeTimeoutTrigger.apply();}
if(this.hasOwnProperty("removeScrollTrigger")){this.removeScrollTrigger.apply();}
if(this.hasOwnProperty("removeScrollInverseTrigger")){this.removeScrollInverseTrigger.apply();}
if(this.hasOwnProperty("removeScrollInverseTriggerPercent")){this.removeScrollInverseTriggerPercent.apply();}
if(this.hasOwnProperty("removeWaitTimeTrigger")){this.removeWaitTimeTrigger.apply();}
inserted_module_trigger={exit:[],inactive:[]};};module.exports=Triggers;return module.exports;}}
_trbo.modules['lib/JSON']={module:function(){var module={exports:function(){console.log('bad module lib/JSON.js');}};"use strict";var TrboJSON={};(function()
if(typeof Date.prototype.toJSON!=='function'){Date.prototype.toJSON;String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON;}
var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'},rep
function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(typeof rep==='function'){value=rep.call(holder,key,value);}
switch(typeof value){case'string':return quote(value);case'number':return isFinite(value)?String(value):'null';case'boolean':case'null':return String(value);case'object':if(!value){return'null';}
gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==='[object Array]'||Object.prototype.toString.apply(value)==='[object Array Iterator]'){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||'null';}
v=partial.length===0?'[]':gap?'[\n'+gap+partial.join(',\n'+gap)+'\n'+mind+']':'['+partial.join(',')+']';gap=mind;return v;}
if(rep&&typeof rep==='object'){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==='string'){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v);}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v);}}}}
v=partial.length===0?'{}':gap?'{\n'+gap+partial.join(',\n'+gap)+'\n'+mind+'}':'{'+partial.join(',')+'}';gap=mind;return v;}}
if(typeof TrboJSON.stringify!=='function'){TrboJSON.stringify;}
if(typeof TrboJSON.parse!=='function'){TrboJSON.parse;}}());module.exports=TrboJSON;return module.exports;}}
_trbo.modules['lib/jTrbo']={module:function(){var module={exports:function(){console.log('bad module lib/jTrbo.js');}};"use strict";if(typeof(jTrbo)=='undefined'){)(window);jTrbo.noConflict();}
if(typeof $jTrbo=='undefined'){$jTrbo=jTrbo;}(function(i){"use strict";var e=window.Slick||{};(e=function(){var e=0;return function(t,o){var s,n=this;n.defaults={accessibility:!0,adaptiveHeight:!1,appendArrows:i(t),appendDots:i(t),arrows:!0,asNavFor:null,prevArrow:'<div class="trboSlider-prev trbo-pager" aria-label="Previous"><i class="trboIconDirection-3-right"></i></div>',nextArrow:'<div class="trboSlider-next trbo-pager" aria-label="Next"><i class="trboIconDirection-3-left"></i></div>',autoplay:!1,autoplaySpeed:3e3,centerMode:!1,centerPadding:"50px",cssEase:"ease",customPaging,dots:!1,dotsClass:"trboSlider-dots",draggable:!0,easing:"linear",edgeFriction:.35,fade:!1,focusOnSelect:!1,focusOnChange:!1,infinite:!0,initialSlide:0,lazyLoad:"ondemand",mobileFirst:!1,pauseOnHover:!0,pauseOnFocus:!0,pauseOnDotsHover:!1,respondTo:"window",responsive:null,rows:1,rtl:!1,slide:"",slidesPerRow:1,slidesToShow:1,slidesToScroll:1,speed:500,swipe:!0,swipeToSlide:!1,touchMove:!0,touchThreshold:5,useCSS:!0,useTransform:!0,variableWidth:!1,vertical:!1,verticalSwiping:!1,waitForAnimate:!0,zIndex:1e3},n.initials={animating:!1,dragging:!1,autoPlayTimer:null,currentDirection:0,currentLeft:null,currentSlide:0,direction:1,$dots:null,listWidth:null,listHeight:null,loadIndex:0,$nextArrow:null,$prevArrow:null,scrolling:!1,slideCount:null,slideWidth:null,$slideTrack:null,$slides:null,sliding:!1,slideOffset:0,swipeLeft:null,swiping:!1,$list:null,touchObject:{},transformsEnabled:!1,unslicked:!1},i.extend(n,n.initials),n.activeBreakpoint=null,n.animType=null,n.animProp=null,n.breakpoints=[],n.breakpointSettings=[],n.cssTransitions=!1,n.focussed=!1,n.interrupted=!1,n.hidden="hidden",n.paused=!0,n.positionProp=null,n.respondTo=null,n.rowCount=1,n.shouldClick=!0,n.$slider=i(t),n.$slidesCache=null,n.transformType=null,n.transitionType=null,n.visibilityChange="visibilitychange",n.windowWidth=0,n.windowTimer=null,s=i(t).data("slick")||{},n.options=i.extend({},n.defaults,o,s),n.currentSlide=n.options.initialSlide,n.originalSettings=n.options,void 0!==document.mozHidden?(n.hidden="mozHidden",n.visibilityChange="mozvisibilitychange"):void 0!==document.webkitHidden&&(n.hidden="webkitHidden",n.visibilityChange="webkitvisibilitychange"),n.autoPlay=i.proxy(n.autoPlay,n),n.autoPlayClear=i.proxy(n.autoPlayClear,n),n.autoPlayIterator=i.proxy(n.autoPlayIterator,n),n.changeSlide=i.proxy(n.changeSlide,n),n.clickHandler=i.proxy(n.clickHandler,n),n.selectHandler=i.proxy(n.selectHandler,n),n.setPosition=i.proxy(n.setPosition,n),n.swipeHandler=i.proxy(n.swipeHandler,n),n.dragHandler=i.proxy(n.dragHandler,n),n.keyHandler=i.proxy(n.keyHandler,n),n.instanceUid=e++,n.htmlExpr=/^(?:\s*(<[\w\W]+>)[^>]*)$/,n.registerBreakpoints(),n.init(!0)}}()).prototype.activateADA,e.prototype.addSlide=e.prototype.slickAdd,e.prototype.animateHeight,e.prototype.animateSlide,e.prototype.getNavTarget,e.prototype.asNavFor,e.prototype.applyTransition,e.prototype.autoPlay,e.prototype.autoPlayClear,e.prototype.autoPlayIterator,e.prototype.buildArrows,e.prototype.buildDots,e.prototype.buildOut,e.prototype.buildRows,e.prototype.checkResponsive,e.prototype.changeSlide,e.prototype.checkNavigable,e.prototype.cleanUpEvents,e.prototype.cleanUpSlideEvents,e.prototype.cleanUpRows,e.prototype.clickHandler,e.prototype.destroy,e.prototype.disableTransition,e.prototype.fadeSlide,e.prototype.fadeSlideOut,e.prototype.filterSlides=e.prototype.slickFilter,e.prototype.focusHandler,e.prototype.getCurrent=e.prototype.slickCurrentSlide=function(){return this.currentSlide},e.prototype.getDotCount,e.prototype.getLeft,e.prototype.getOption=e.prototype.slickGetOption,e.prototype.getNavigableIndexes,e.prototype.getSlick,e.prototype.getSlideCount,e.prototype.goTo=e.prototype.slickGoTo,e.prototype.init,e.prototype.initADA,e.prototype.initArrowEvents,e.prototype.initDotEvents,e.prototype.initSlideEvents,e.prototype.initializeEvents,e.prototype.initUI,e.prototype.keyHandler,e.prototype.lazyLoad,e.prototype.loadSlider,e.prototype.next=e.prototype.slickNext=function(){this.changeSlide({data:{message:"next"}})},e.prototype.orientationChange,e.prototype.pause=e.prototype.slickPause,e.prototype.play=e.prototype.slickPlay,e.prototype.postSlide,e.prototype.prev=e.prototype.slickPrev,e.prototype.preventDefault=function(i){i.preventDefault()},e.prototype.progressiveLazyLoad,e.prototype.refresh,e.prototype.registerBreakpoints,e.prototype.reinit,e.prototype.resize,e.prototype.removeSlide=e.prototype.slickRemove,e.prototype.setCSS,e.prototype.setDimensions,e.prototype.setFade,e.prototype.setHeight,e.prototype.setOption=e.prototype.slickSetOption,e.prototype.setPosition,e.prototype.setProps,e.prototype.setSlideClasses,e.prototype.setupInfinite,e.prototype.interrupt,e.prototype.selectHandler,e.prototype.slideHandler,e.prototype.startLoad,e.prototype.swipeDirection,e.prototype.swipeEnd,e.prototype.swipeHandler,e.prototype.swipeMove,e.prototype.swipeStart,e.prototype.unfilterSlides=e.prototype.slickUnfilter,e.prototype.unload,e.prototype.unslick,e.prototype.updateArrows,e.prototype.updateDots,e.prototype.visibility,i.fn.slick});try{var _trboStyleIntervalCount=0,_trboStyleInterval=window.setInterval(function(){_trboStyleIntervalCount++;if(_trboStyleIntervalCount>10){window.clearInterval(_trboStyleInterval);}
if(jTrbo("head").length>0){window.clearInterval(_trboStyleInterval);jTrbo("head").append("<style>.trboSlider-slider{position: relative;display: block;box-sizing: border-box;-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;-webkit-touch-callout: none;-khtml-user-select: none;-ms-touch-action: pan-y;touch-action: pan-y;-webkit-tap-highlight-color: transparent;}.trboSlider-list{position: relative;display: block;overflow: hidden;margin: 0;padding: 0;}.trboSlider-list:focus{outline: none;}.trboSlider-list.dragging{cursor: pointer;cursor: hand;}.trboSlider-slider .trboSlider-track,.trboSlider-slider .trboSlider-list{-webkit-transform: translate3d(0, 0, 0);-moz-transform: translate3d(0, 0, 0);-ms-transform: translate3d(0, 0, 0);-o-transform: translate3d(0, 0, 0);transform: translate3d(0, 0, 0);}.trboSlider-track{position: relative;top: 0;left: 0;display: block;margin-left: auto;margin-right: auto;}.trboSlider-track:before,.trboSlider-track:after{display: table;content: '';}.trboSlider-track:after{clear: both;}.trboSlider-loading .trboSlider-track{visibility: hidden;}.trboSlider-slide{display: none;float: left;height: 100%;min-height: 1px;}[dir='rtl'] .trboSlider-slide{float: right;}.trboSlider-slide img{display: block;}.trboSlider-slide.trboSlider-loading img{display: none;}.trboSlider-slide.dragging img{pointer-events: none;}.trboSlider-initialized .trboSlider-slide{display: block;}.trboSlider-loading .trboSlider-slide{visibility: hidden;}.trboSlider-vertical .trboSlider-slide{display: block;height: auto;border: 1px solid transparent;}.trboSlider-arrow.trboSlider-hidden {display: none;}></style>");}},250);window.setTimeout,3000);}catch(e){}
module.exports={};return module.exports;}}
_trbo.modules['rules/OnBasketPage']={module:function(){var module={exports:function(){console.log('bad module rules/OnBasketPage.js');}};function OnBasketPage(udp){var type=udp.getPage().type;return type=='basket'||type=='checkout';};module.exports=OnBasketPage;return module.exports;}}
_trbo.modules['tracking/CnectrListener']={module:function(){var module={exports:function(){console.log('bad module tracking/CnectrListener.js');}};"use strict";var CnectrListener=function(opts){this.opts=opts;this.storage={};this.log=[];};CnectrListener.prototype.handle=function(event){var me=this;me.log.push(event);try{if(event.type==='cnectrSegment'){if(event.data){me.storage[event.data]=true;}else{jTrbo.each(event);}}}catch(e){}
me.saveToExternalData();};CnectrListener.prototype.getStorageData=function(){return this.storage;}
CnectrListener.prototype.saveToExternalData=function(){try{var storage=this.getStorageData(),segmentIds=[];for(var key in storage){segmentIds.push(parseInt(key,10));}
this.opts.userDataProvider.getUserSummary().externalData.cnectr_segments=segmentIds;this.opts.userDataProvider.saveData();}catch(e){this.log.push(e);}}
module.exports=CnectrListener;return module.exports;}}
_trbo.modules['tracking/CompatibilityListener']={module:function(){var module={exports:function(){console.log('bad module tracking/CompatibilityListener.js');}};"use strict";var Helper=require('Helper'),ImgTagTrackerAdapter=require('tracking/ImgTagTrackerAdapter'),Tracker=require('tracking/Tracker');var CompatibilityListener=function(opts){this.opts=opts;var tracker=opts.tracker,udp=tracker.opts.userDataProvider;this.imgTagTracker=new ImgTagTrackerAdapter({browser:udp.getBrowser()});};CompatibilityListener.prototype.handleWriteImage=function(event){var tracker=this.opts.tracker,udp=tracker.opts.userDataProvider,session=udp.getSession(),currentUrl=udp.getBrowser().getLocation().href,url=event.pixelUrl+'&group='+session.abGroup+'&sid='+session.sessionId+'&protocol='+Helper.escape(Tracker.extractProtocol(currentUrl))+'&device='+Helper.escape(session.deviceData.device)+'&device_type='+Helper.escape(session.deviceData.deviceType);if(!url.match(/&pg=/)){url+='&pg='+Helper.escape(Tracker.normalizeUrl(currentUrl));}
if(!url.match(/&c_id=/)){url+='&c_id='+Helper.escape(udp.getConfig().campaign.campaignId);}
this.imgTagTracker.insertImage(url);};module.exports=CompatibilityListener;return module.exports;}}
_trbo.modules['tracking/ConsentListener']={module:function(){var module={exports:function(){console.log('bad module tracking/ConsentListener.js');}};"use strict";var ConsentListener=function(opts){this.opts=opts;this.storage={};this.log=[];};ConsentListener.prototype.handle=function(event){var me=this;me.log.push(event);if(event.type==='consent'){if(event.status===1){dataLayer={trackingEnabled:"no",storageEnabled:"no",};window._trbo.pluginConfig.tracking_disabled=true;window._trbo.app.opts.config.skipCookies=true;window._trbo.app.opts.config.skipLocalStorage=true;window._trboq.push(["volatileData",dataLayer]);}else if(event.status===2){dataLayer={trackingEnabled:"yes",storageEnabled:"yes",};window._trbo.pluginConfig.tracking_disabled=false;window._trbo.app.opts.config.skipCookies=false;window._trbo.app.opts.config.skipLocalStorage=false;window._trboq.push(["dataMatching",dataLayer]);}else if(event.status===3){dataLayer={trackingEnabled:"yes",storageEnabled:"no",};window._trbo.pluginConfig.tracking_disabled=false;window._trbo.app.opts.config.skipCookies=true;window._trbo.app.opts.config.skipLocalStorage=true;window._trboq.push(["volatileData",dataLayer]);}
window._trboq.push("dataMatching",dataLayer);me.log.push(dataLayer);}};module.exports=ConsentListener;return module.exports;}}
_trbo.modules['tracking/ConversionListener']={module:function(){var module={exports:function(){console.log('bad module tracking/ConversionListener.js');}};"use strict";var Helper=require('Helper'),json=require('lib/JSON'),UserDataProvider=require('UserDataProvider');var ConversionListener=function(opts){this.opts=opts;};ConversionListener.prototype.makeConversion=function(data){var tracker=this.opts.tracker,udp=tracker.opts.userDataProvider,event=this.opts.tracker.makeBasicEvent(),requestDataTransformer=_trbo.app.opts.requestDataTransformer;try{if(data.products&&data.products.length>0){if(jTrbo.isArray(data.products[0])&&data.products.length===1){data.products=data.products[0];}
for(var i=0;i<data.products.length;i++){if(jTrbo.isArray(data.products[i])){}
if(!data.products[i].product_id){if(data.products[i].id){data.products[i].product_id=data.products[i].id;}}}}}catch(err){}
event=Helper.mergeObjects(event,{conversionId:udp.generateUniqueNumber(),currency:data.currency,orderId:data.order_id,conversionType:data.type,value:data.value,products:json.stringify(data.products),pst:this.opts.config.pst,couponCode:data.coupon_code?data.coupon_code:'',subtype:data.subtype?data.subtype:0});if(data.type=='sale'||data.type=='basket'){event=Helper.mergeObjects(event,{sessions:requestDataTransformer.getLatestSessions(),currentBasket:udp.getCurrentBasket(),dataLayer:udp.getUserSummary().externalData,segments:udp.getSegmentData(),saleCount:udp.getUserSummary().saleCount,sessionDurationTotal:udp.getUserSummary().sessionDurationTotal,sessionCount:udp.getUserSummary().sessionCount,href:document.location.href,productCounts:requestDataTransformer.getProductsCount(),lastSales:requestDataTransformer.getSales()});try{var externalUserId=udp.getExternalUserId();if(externalUserId){event.euid=externalUserId;}}catch(e){}}
if(data.type=='lead'){event.custom={email:data.email};}
if(data.type=='funnel'){if(data.funnel_id&&parseInt(data.funnel_id)>3&&parseInt(data.funnel_id)<256){event.conversionType=data.funnel_id;}else{event.conversionType=255;}}
return event;};ConversionListener.prototype.transformConversionSessionEvent=function(data){var udp=this.opts.tracker.opts.userDataProvider;udp.cleanupLocalEventData(data,UserDataProvider.localRecordBlacklist);delete data.type;return data;};ConversionListener.prototype.transformConversionTrackEvent=function(data){var result=this.opts.tracker.transformObject(data,{cl:'shopId',uid:'userId',euid:'euid',sid:'sessionId',c_id:'campaignId',c_bid:'sessionId',c_oid:'orderId',c_v:'value',c_type:'conversionType',c_cur:'currency',c_stype:'subtype',c_prods:'products',c_custom:{value:typeof data.custom=='object'?json.stringify(data.custom):data.custom},campaign_id:'campaignId',group:'abGroup',layer_groups:{value:2},device_type:'deviceType',device:'device',url:'url',protocol:'protocol',st:'segmentId',pst:'pst',cc:'couponCode',s:{value:typeof data.sessions=='object'?json.stringify(data.sessions):data.sessions},cb:{value:typeof data.currentBasket=='object'?json.stringify(data.currentBasket):data.currentBasket},dl:{value:typeof data.dataLayer=='object'?json.stringify(data.dataLayer):data.dataLayer},seg:{value:typeof data.segments=='object'?json.stringify(data.segments):data.segments},c:{value:typeof data.lastSales=='object'?json.stringify(data.lastSales):data.lastSales},ts:'saleCount',sdt:'sessionDurationTotal',sc:'sessionCount',p:'href',pc:{value:typeof data.productCounts=='object'?json.stringify(data.productCounts):data.productCounts}});return result;};ConversionListener.prototype.handle=function(event){var tracker=this.opts.tracker,conversion=this.makeConversion(event);if(event.type&&event.type=="sale"){tracker.opts.userDataProvider.currentConversion=conversion;}
tracker.track({type:'conv',data:this.transformConversionTrackEvent(conversion),callback:event.callback});if(event.type&&event.type!=='funnel'){tracker.opts.userDataProvider.addSessionEvent({type:'conv',data:this.transformConversionSessionEvent(conversion)});}};module.exports=ConversionListener;return module.exports;}}
_trbo.modules['tracking/DataMatchingListener']={module:function(){var module={exports:function(){console.log('bad module tracking/DataMatchingListener.js');}};"use strict";var Helper=require('Helper'),json=require('lib/JSON'),UserDataProvider=require('UserDataProvider');var DataMatchingListener=function(opts){this.opts=opts;};DataMatchingListener.prototype.makeEvent=function(data){var event=this.opts.tracker.makeBasicEvent(),udp=this.opts.tracker.opts.userDataProvider;event=Helper.mergeObjects(event,{euid:data.euid});event.clientTime=udp.pluginStartTime;return event;};DataMatchingListener.prototype.transformDataMatchingTrackEvent=function(data){var result=this.opts.tracker.transformObject(data,{cl:'shopId',uid:'userId',sid:'sessionId',device_type:'deviceType',device:'device',pg:'url',protocol:'protocol',euid:'euid'});return result;};DataMatchingListener.prototype.handle=function(event){var tracker=this.opts.tracker,userMatchingEvent=this.makeEvent(event),udp=this.opts.tracker.opts.userDataProvider,userSummary=udp.getUserSummary();var saveDataMatching={};var saveDataMatchingCount=0;if(typeof(event)==="object"&&event.type==='dataMatching'){for(var sdm_key in event){if(sdm_key!=='type'&&event[sdm_key]!==""){saveDataMatching[sdm_key]=event[sdm_key];saveDataMatchingCount++;}}}
if(saveDataMatchingCount>0){udp.addExternalData(saveDataMatching);}
try{var cats=["category_path","categoryPath"];for(var i=0;i<cats.length;i++){if(typeof saveDataMatching[cats[i]]!=="undefined"){var latestMatching={categoryPath_latest:saveDataMatching[cats[i]],};udp.addExternalData(latestMatching);}}
if(typeof saveDataMatching.brand!=="undefined"){udp.addExternalData({brand_latest:saveDataMatching.brand,});}}catch(e){console.log(e.message);}};module.exports=DataMatchingListener;return module.exports;}}
_trbo.modules['tracking/DatalayerMapper']={module:function(){var module={exports:function(){console.log('bad module tracking/DatalayerMapper.js');}};"use strict";var DatalayerMapper;DatalayerMapper.prototype.mapGoogleDataLayer=function(mappings){var me=this;if(typeof window.dataLayer!=="undefined"&&jTrbo.isArray(mappings)){var matched={},flattened={};jTrbo.each(window.dataLayer,function(index,dataObject){jTrbo.each(dataObject,function(key,value){if(jTrbo.isArray(value)){jTrbo.each(value,function(innerKey,nestedValue){if(jTrbo.isPlainObject(nestedValue)){jTrbo.each(nestedValue);}else{flattened[key+"."+innerKey]=nestedValue;}});}else if(jTrbo.isPlainObject(value)){jTrbo.each(value);}else{flattened[key]=value;}});});this.flattened=flattened;jTrbo.each(mappings,function(index,config){var value=config.fallback;if(typeof flattened[config.name]!=="undefined"){value=flattened[config.name];if(jTrbo.isArray(config.processors)){jTrbo.each(config.processors,function(processorIndex,processorConfig){try{value=me[processorConfig.name](value,processorConfig.options);}catch(Exception){}});}}
matched[config.mappedName]=value;});this.matched=matched;this.opts.Trboq.push(['dataMatching',matched]);}};DatalayerMapper.prototype.getFlattened=function(){return this.flattened;};DatalayerMapper.prototype.getMatched=function(){return this.matched;};DatalayerMapper.prototype.split=function(value,options){return value.split(options[0]);};DatalayerMapper.prototype.glue;DatalayerMapper.prototype.replace=function(value,options){return value.split(options[0]).join(options[1]);};DatalayerMapper.prototype.run=function(options){try{if(typeof options.datalayerMapping!=="undefined"){if(options.datalayerMapping.google){this.mapGoogleDataLayer(options.datalayerMapping.google.mappings);}}}catch(exception){}};module.exports=DatalayerMapper;return module.exports;}}
_trbo.modules['tracking/ImgTagTrackerAdapter']={module:function(){var module={exports:function(){console.log('bad module tracking/ImgTagTrackerAdapter.js');}};"use strict";var Helper=require('Helper');var ImgTagTrackerAdapter=function(opts){if(!opts.browser){throw new Error("TrackerAdapter expects browser in opts");}
this.opts=opts;this.debugConfig={};};ImgTagTrackerAdapter.prototype.makeUrl=function(type,data){var str=this.opts.config.trackingBaseUrl+'/'+type+'.php?',chunks=[];for(var key in data){chunks.push(key+"="+Helper.escape(data[key]));}
return str+chunks.join('&');};ImgTagTrackerAdapter.prototype.preventOldTacking=function(trackingPixel){if(trackingPixel.indexOf('/prov.php')>0||trackingPixel.indexOf('/c.php')>0||trackingPixel.indexOf('/limp.php')>0||trackingPixel.indexOf('/limps.php')>0||trackingPixel.indexOf('/lc.php')>0||trackingPixel.indexOf('/conv.php')>0||trackingPixel.indexOf('/lev.php')>0||trackingPixel.indexOf('/os.php')>0||trackingPixel.indexOf('/seg.php')>0||trackingPixel.indexOf('/testing.php')>0){return true}else{return false;}}
ImgTagTrackerAdapter.prototype.insertImage=function(pixelUrl){var navigator=this.opts.browser.getNavigator(),isIe6or7=(navigator.appVersion.match(/^MSIE [67]./)!==null),document=this.opts.browser.getDocument(),className="trbo_tr_img",me=this;pixelUrl+="&stot=1";if(document.body==null||isIe6or7){var defaultTrackingPixel='<img src="'+pixelUrl+'" width="1" height="1" alt="" style="width:1px; height:1px; display:inline; margin-top:-1px;" class="'+className+'" />';var trackingPixels=[];if(defaultTrackingPixel.indexOf('//track2.trbo.com')>=0&&defaultTrackingPixel.indexOf('/testing.php?cl=')<0){trackingPixels.push(defaultTrackingPixel);}
window._trbo_new_tracking_enabled=true;if(window._trbo_new_tracking_enabled&&window._trbo_new_tracking_enabled==true){this.debugConfig.trbo_new_tracking_enabled=window._trbo_new_tracking_enabled;if(defaultTrackingPixel.indexOf('//collect.trbo.com')<0){trackingPixels.push(defaultTrackingPixel.replace('//track2.trbo.com','//collect.trbo.com').replace('//track.trbo.com','//collect.trbo.com'));}}else if(typeof(_trbo)!=='undefined'&&_trbo.pluginConfig&&_trbo.pluginConfig.new_tracking_enabled&&_trbo.pluginConfig.new_tracking_enabled===true){this.debugConfig.new_tracking_enabled=_trbo.pluginConfig.new_tracking_enabled;if(defaultTrackingPixel.indexOf('//collect.trbo.com')<0){trackingPixels.push(defaultTrackingPixel.replace('//track2.trbo.com','//collect.trbo.com').replace('//track.trbo.com','//collect.trbo.com'));}}
if(true&&trackingPixels.length>0){if(jTrbo('body').length===1){trackingPixels.forEach(function(trackingPixel){if(trackingPixel.indexOf('//collect.trbo.com')>=0){jTrbo('body').append(trackingPixel);}else{if(me.preventOldTacking(trackingPixel)){}else{jTrbo('body').append(trackingPixel);}}});}else{jTrbo(document).ready(function(){trackingPixels.forEach(function(trackingPixel){if(trackingPixel.indexOf('//collect.trbo.com')>=0){jTrbo('body').append(trackingPixel);}else{if(me.preventOldTacking(trackingPixel)){}else{jTrbo('body').append(trackingPixel);}}});});}
return;}}else{var _load_legacy_pixel=false;if(pixelUrl.indexOf('//collect.trbo.com')>=0){_load_legacy_pixel=true;}else if(pixelUrl.indexOf('//track2.trbo.com')>=0){if(this.preventOldTacking(pixelUrl)){_load_legacy_pixel=false;}else{_load_legacy_pixel=true;}}else{_load_legacy_pixel=true;}
if(this.opts.config&&this.opts.config.useWhiteLabelTracking===true){_load_legacy_pixel=false;}
if(_load_legacy_pixel===true){var tag=document.createElement('img');tag.src=pixelUrl;tag.width=1;tag.height=1;tag.style.width='1px';tag.style.height='1px';tag.style.display='inline';tag.style.position='absolute';tag.style.marginTop='-1px';tag.alt='';tag.className=className;if(this.opts.config&&this.opts.config.shopId&&this.opts.config.shopId==12487){var _div_el_for_img=document.createElement('div');_div_el_for_img.style.display='none';_div_el_for_img.style.visibility='hidden';_div_el_for_img.appendChild(tag);document.body.appendChild(_div_el_for_img);}else{document.body.appendChild(tag);}}
var _new_tracking_enabled=false;if(window._trbo_new_tracking_enabled&&window._trbo_new_tracking_enabled==true){_new_tracking_enabled=true;}else if(typeof(_trbo)!=='undefined'&&_trbo.pluginConfig&&_trbo.pluginConfig.new_tracking_enabled&&_trbo.pluginConfig.new_tracking_enabled===true){_new_tracking_enabled=true;}
if(true||_new_tracking_enabled===true){var tag=document.createElement('img');tag.src=pixelUrl.replace('//track2.trbo.com','//collect.trbo.com').replace('//track.trbo.com','//collect.trbo.com');tag.width=1;tag.height=1;tag.style.width='1px';tag.style.height='1px';tag.style.display='inline';tag.style.position='absolute';tag.style.marginTop='-1px';tag.alt='';tag.className=className;if(this.opts.config&&this.opts.config.shopId&&this.opts.config.shopId==12487){var _div_el_for_img=document.createElement('div');_div_el_for_img.style.display='none';_div_el_for_img.style.visibility='hidden';_div_el_for_img.appendChild(tag);document.body.appendChild(_div_el_for_img);}else{document.body.appendChild(tag);}}}}
ImgTagTrackerAdapter.prototype.insertIframe=function(pixelUrl){var navigator=this.opts.browser.getNavigator(),isIe6or7=(navigator.appVersion.match(/^MSIE [67]./)!==null),document=this.opts.browser.getDocument(),me=this;pixelUrl+='&rnd='+Date.now();pixelUrl+="&stot=1";if(document.body==null||isIe6or7){var defaultTrackingPixel='<iframe height="0" width="0" src="'+pixelUrl+'" style="display: none;"></iframe>';var trackingPixels=[];if(defaultTrackingPixel.indexOf('//track2.trbo.com')>=0&&defaultTrackingPixel.indexOf('/testing.php?cl=')<0){trackingPixels.push(defaultTrackingPixel);}
window._trbo_new_tracking_enabled=true;if(window._trbo_new_tracking_enabled&&window._trbo_new_tracking_enabled==true){if(defaultTrackingPixel.indexOf('//collect.trbo.com')<0){trackingPixels.push(defaultTrackingPixel.replace('//track2.trbo.com','//collect.trbo.com').replace('//track.trbo.com','//collect.trbo.com'));}}else if(typeof(_trbo)!=='undefined'&&_trbo.pluginConfig&&_trbo.pluginConfig.new_tracking_enabled&&_trbo.pluginConfig.new_tracking_enabled===true){if(defaultTrackingPixel.indexOf('//collect.trbo.com')<0){trackingPixels.push(defaultTrackingPixel.replace('//track2.trbo.com','//collect.trbo.com').replace('//track.trbo.com','//collect.trbo.com'));}}
if(true&&trackingPixels.length>0){if(jTrbo('body').length===1){trackingPixels.forEach(function(trackingPixel){if(trackingPixel.indexOf('//collect.trbo.com')>=0){jTrbo('body').append(trackingPixel);}else{if(me.preventOldTacking(trackingPixel)){}else{jTrbo('body').append(trackingPixel);}}});}else{jTrbo(document).ready(function(){trackingPixels.forEach(function(trackingPixel){if(trackingPixel.indexOf('//collect.trbo.com')>=0){jTrbo('body').append(trackingPixel);}else{if(me.preventOldTacking(trackingPixel)){}else{jTrbo('body').append(trackingPixel);}}});});}
return;}}else{var _load_legacy_pixel=false;if(pixelUrl.indexOf('//collect.trbo.com')>=0){_load_legacy_pixel=true;}else if(pixelUrl.indexOf('//track2.trbo.com')>=0){if(this.preventOldTacking(pixelUrl)){_load_legacy_pixel=false;}else{_load_legacy_pixel=true;}}else{_load_legacy_pixel=true;}
if(this.opts.config&&this.opts.config.useWhiteLabelTracking===true){_load_legacy_pixel=false;}
if(_load_legacy_pixel===true){var tag=document.createElement('iframe');tag.src=pixelUrl;tag.height=0;tag.width=0;tag.style.display='none';document.body.appendChild(tag);}
var _new_tracking_enabled=false;if(window._trbo_new_tracking_enabled&&window._trbo_new_tracking_enabled==true){_new_tracking_enabled=true;}else if(typeof(_trbo)!=='undefined'&&_trbo.pluginConfig&&_trbo.pluginConfig.new_tracking_enabled===true){_new_tracking_enabled=true;}
if(true||_new_tracking_enabled===true){var tag=document.createElement('iframe');tag.src=pixelUrl.replace('//track2.trbo.com','//collect.trbo.com').replace('//track.trbo.com','//collect.trbo.com');tag.height=0;tag.width=0;tag.style.display='none';document.body.appendChild(tag);}}}
ImgTagTrackerAdapter.prototype.track=function(type,data){try{if(typeof(window._trbo)!=='undefined'&&window._trbo.pluginConfig&&window._trbo.pluginConfig.tracking_disabled&&window._trbo.pluginConfig.tracking_disabled===true){return;}}catch(err){}
if(window&&window._trbo_prevent_default_tracking&&window._trbo_prevent_default_tracking===true){if(window._trbo_prevent_default_tracking_types&&window._trbo_prevent_default_tracking_types.length>0){if(window._trbo_prevent_default_tracking_types.indexOf(type)>=0){return;}}else if(type==='c'||type==='os'){return;}}
if(typeof(_trbo)!=='undefined'&&_trbo.pluginConfig&&_trbo.pluginConfig.prevent_default_tracking&&_trbo.pluginConfig.prevent_default_tracking===true){if(_trbo.pluginConfig.prevent_default_tracking_types&&_trbo.pluginConfig.prevent_default_tracking_types.length>0){if(_trbo.pluginConfig.prevent_default_tracking_types.indexOf(type)>=0){return;}}else if(type==='c'||type==='os'){return;}}
if(this.opts.config&&this.opts.config.shopId&&this.opts.config.shopId==12950){var pixelUrl=this.makeUrl(type,data);if(type==='os'){pixelUrl=pixelUrl.replace('//track2.trbo.com','//collect.trbo.com');}
this.insertImage(pixelUrl);}else if(window&&window._trbo_use_image_tracking&&window._trbo_use_image_tracking===true){var pixelUrl=this.makeUrl(type,data);this.insertImage(pixelUrl);}else if(typeof(_trbo)!=='undefined'&&_trbo.pluginConfig&&_trbo.pluginConfig.use_image_tracking&&_trbo.pluginConfig.use_image_tracking===true){var pixelUrl=this.makeUrl(type,data);this.insertImage(pixelUrl);}else if(type==='prov'||type==='os'||type==='c'||type==='limp'||type==='lev'){var pixelUrl=this.makeUrl('i/'+type,data);this.insertIframe(pixelUrl);}else{var pixelUrl=this.makeUrl(type,data);this.insertImage(pixelUrl);}};module.exports=ImgTagTrackerAdapter;return module.exports;}}
_trbo.modules['tracking/JsonpTrackerAdapter']={module:function(){var module={exports:function(){console.log('bad module tracking/JsonpTrackerAdapter.js');}};"use strict";var Helper=require('Helper'),ImgTagTrackerAdapter=require('tracking/ImgTagTrackerAdapter');var JsonpTrackerAdapter;JsonpTrackerAdapter.prototype.makeUrl=ImgTagTrackerAdapter.prototype.makeUrl;JsonpTrackerAdapter.prototype.handleTrackingCallback=function(event){if(event.callbackId&&this.callbacks[event.callbackId]){this.callbacks[event.callbackId](event);delete this.callbacks[event.callbackId];}};JsonpTrackerAdapter.prototype.callJsonp=function(url,callbackId,callback){var navigator=this.opts.browser.getNavigator(),isIe6or7=(navigator.appVersion.match(/^MSIE [67]./)!==null),document=this.opts.browser.getDocument();this.callbacks[callbackId]=callback;if(document.body==null||isIe6or7){if(window._trbo_prevent_document_write&&window._trbo_prevent_document_write===true){return;}else if(typeof(_trbo)!=='undefined'&&_trbo.pluginConfig&&_trbo.pluginConfig.prevent_document_write&&_trbo.pluginConfig.prevent_document_write===true){document.write('<script src="'+url+'"></script>');}}else{var script=document.createElement('script');script.src=url;document.getElementsByTagName('body')[0].appendChild(script);}};JsonpTrackerAdapter.prototype.track=function(type,data,callback){var callbackId=Helper.md5(Helper.getTime()+''+Math.random()),pixelUrl=this.makeUrl(type,data)+'&f=jsonp&cbi='+callbackId;this.callJsonp(pixelUrl,callbackId,callback);};module.exports=JsonpTrackerAdapter;return module.exports;}}
_trbo.modules['tracking/LayerListener']={module:function(){var module={exports:function(){console.log('bad module tracking/LayerListener.js');}};"use strict";var Helper=require('Helper');var LayerListener=function(opts){this.opts=opts;this.layersRecorded=[];this.layerImpressions=[];this.layerImpressionsTimout=false;var me=this;try{jTrbo(document).ready(function(){jTrbo(document).on("trbo:tracking:click",function(event,moduleId,campaignId,module,trboContainer){me.recordLocalLayerClick(moduleId,[]);});});}catch(e){}};LayerListener.prototype.makeEvent;LayerListener.prototype.recordLocalLayerView=function(moduleId,contentIds){var lar=_trbo.app.layerApi.response,sessionEvent=this.opts.tracker.makeLocalEvent('layerView');sessionEvent=Helper.mergeObjects(sessionEvent,{moduleId:moduleId,contentIds:contentIds});this.opts.tracker.opts.userDataProvider.addSessionEvent(sessionEvent);this.layersRecorded.push({moduleId:moduleId,recorded:true});};LayerListener.prototype.recordLocalLayerClick=function(moduleId,contentIds){var lar=_trbo.app.layerApi.response,sessionEvent=this.opts.tracker.makeLocalEvent('layerClick');sessionEvent=Helper.mergeObjects(sessionEvent,{moduleId:moduleId,contentIds:contentIds});this.opts.tracker.opts.userDataProvider.addSessionEvent(sessionEvent);};LayerListener.prototype.makeLayerViewEvent=function(event){var campaignId=0;try{campaignId=_trbo.app.layerApi.response.campaign_id;}catch(err){}
if(event.campaignId){campaignId=event.campaignId;}
var fullEvent=this.opts.tracker.makeBasicEvent(),filteredEvent=this.opts.tracker.transformObject(fullEvent,{cl:'shopId',uid:'userId',sid:'sessionId',cp:{value:campaignId},c_id:{value:campaignId},ft:{value:'product'},group:'abGroup',ipt:{value:'view'},mid:{value:event.moduleId},device_type:'deviceType',device:'device',pt:'pageType',pg:'url',protocol:'protocol',st:'segmentId'});if(!filteredEvent.oc_id&&event.originalCampaignId){filteredEvent.oc_id=event.originalCampaignId;}
if(event.pageSubtype&&parseInt(event.pageSubtype)>0){filteredEvent.pst=event.pageSubtype;}else{try{var _tmpPageData=this.opts.userDataProvider.getPage();if(_tmpPageData&&_tmpPageData.subtype&&_tmpPageData.subtype>0){filteredEvent.pst=_tmpPageData.subtype;}}catch(err){}}
if(this.opts&&this.opts.userDataProvider&&this.opts.userDataProvider.xng&&this.opts.userDataProvider.xng!==""&&event.moduleId){if(this.opts.userDataProvider.xng[event.moduleId]){try{filteredEvent.xng=JSON.stringify(this.opts.userDataProvider.xng[event.moduleId]);}catch(err){}}}
return filteredEvent;};LayerListener.prototype.handleLayerErrorView=function(event){for(var i=0;i<this.layersRecorded.length;i++){var elem=this.layersRecorded[i];if(elem.moduleId===event.moduleId&&elem.recorded===true){}}
var filteredEvent=this.makeLayerViewEvent(event);if(event.productId){filteredEvent.cpid=event.productId;}
if(!event.errorCode){return;}
filteredEvent.ec=event.errorCode;this.opts.tracker.track({type:'lev',data:filteredEvent});this.recordLocalLayerView(event.moduleId,[]);};LayerListener.prototype.handleLayerView=function(event){if(this.opts.userDataProvider.getSession().campaignId==0){return;}
for(var i=0;i<this.layersRecorded.length;i++){var elem=this.layersRecorded[i];if(elem.moduleId===event.moduleId&&elem.recorded===true){if(event.forceView&&event.forceView===true){}else{return;}}}
var filteredEvent=this.makeLayerViewEvent(event);if(event.productId){filteredEvent.cpid=event.productId;}
if(window._trbo&&window._trbo.pluginConfig&&window._trbo.pluginConfig.use_combined_tracking===true){this.layerImpressions.push({type:'limp',data:filteredEvent});try{this.handleLayerViewMulti();}catch(err){this.opts.tracker.track({type:'limp',data:filteredEvent});}}else{this.opts.tracker.track({type:'limp',data:filteredEvent});}
this.recordLocalLayerView(event.moduleId,[]);try{var _event_name=event.campaignId+'';if(event.campaignName){_event_name+='.'+event.campaignName;}
_event_name+='.impression';var _event_id=event.moduleId+'';if(event.moduleName){_event_id+='.'+event.moduleName;}
if(parseInt(this.opts.config.shopId)===12853&&window.ga){}}catch(err){}};LayerListener.prototype.handleLayerViewMulti=function(){if(this.layerImpressions&&this.layerImpressions.length>0){if(this.layerImpressionsTimout&&this.layerImpressionsTimout!==false){window.clearTimeout(this.layerImpressionsTimout);}
this.layerImpressionsTimout=setTimeout(function(that){that.opts.tracker.track({type:'limps',data:{track:JSON.stringify(that.layerImpressions)}});that.layerImpressions=[];that.layerImpressionsTimout=false;},50,this);}};LayerListener.prototype.handleLayerProductView=function(event){if(this.opts.userDataProvider.getSession().campaignId==0){return;}
for(var i=0;i<this.layersRecorded.length;i++){var elem=this.layersRecorded[i];if(elem.moduleId===event.moduleId&&elem.recorded===true){return;}}
var cpids=[];for(var i=0;i<event.products.length;i++){cpids.push(event.products[i].product_id);}
var filteredEvent=this.makeLayerViewEvent(event);filteredEvent.cpid=event.product?event.product.product_id:null;filteredEvent.cpids=cpids.join('|');this.opts.tracker.track({type:'limp',data:filteredEvent});this.recordLocalLayerView(event.moduleId,cpids);};LayerListener.prototype.handleLayerCouponView=function(event){if(this.opts.userDataProvider.getSession().campaignId==0){return;}
for(var i=0;i<this.layersRecorded.length;i++){var elem=this.layersRecorded[i];if(elem.moduleId===event.moduleId&&elem.recorded===true){return;}}
var filteredEvent=this.makeLayerViewEvent(event);if(event.coupon){filteredEvent.cvid=event.coupon.voucher_id;if(event.coupon.coupon_code_id){filteredEvent.cci=event.coupon.coupon_code_id;}}
this.opts.tracker.track({type:'limp',data:filteredEvent});this.recordLocalLayerView(event.moduleId,[filteredEvent.cvid]);};LayerListener.prototype.handleLayerClick=function(event){var campaignId;try{if(this.opts.userDataProvider.getSession().campaignId==0){return;}
campaignId=_trbo.app.layerApi.response.campaign_id;}catch(e){}
if(event.campaignId){campaignId=event.campaignId;}
var fullEvent=this.opts.tracker.makeBasicEvent(),filteredEvent=this.opts.tracker.transformObject(fullEvent,{cl:'shopId',uid:'userId',sid:'sessionId',cp:{value:campaignId},c_id:{value:campaignId},group:'abGroup',module_id:{value:event.moduleId},device_type:'deviceType',device:'device',pg:'url',pt:'pageType',protocol:'protocol',st:'segmentId',dest:{value:''}});if(event.productId){filteredEvent.cpid=event.productId;}
if(event.pageSubtype&&parseInt(event.pageSubtype)>0){filteredEvent.pst=event.pageSubtype;}else{try{var _tmpPageData=this.opts.userDataProvider.getPage();if(_tmpPageData&&_tmpPageData.subtype&&_tmpPageData.subtype>0){filteredEvent.pst=_tmpPageData.subtype;}}catch(err){}}
try{if(event.clickTypeId&&parseInt(event.clickTypeId)>0){filteredEvent.cti=parseInt(event.clickTypeId);}}catch(err){}
if(this.opts&&this.opts.userDataProvider&&this.opts.userDataProvider.xng&&this.opts.userDataProvider.xng!==""&&event.moduleId){if(this.opts.userDataProvider.xng[event.moduleId]){try{filteredEvent.xng=JSON.stringify(this.opts.userDataProvider.xng[event.moduleId]);}catch(err){}}}
this.opts.tracker.track({type:'lc',data:filteredEvent});this.recordLocalLayerClick(event.moduleId,[]);};LayerListener.prototype.handleApiResponse=function(data){try{_trbo.app.layerApi.callback(data)}catch(e){console.log(e);}};LayerListener.prototype.handleLayerCouponRedeem=LayerListener.prototype.handleLayerClick;module.exports=LayerListener;return module.exports;}}
_trbo.modules['tracking/MailTriggerListener']={module:function(){var module={exports:function(){console.log('bad module tracking/MailTriggerListener.js');}};"use strict";var MailTriggerListener=function(opts){this.opts=opts;};MailTriggerListener.prototype.handle=function(event){try{var tracker=this.opts.tracker,triggerEvent=this.makeEvent(event);tracker.track({type:'trigger',data:triggerEvent});}catch(err){console.log(err);}};MailTriggerListener.prototype.makeEvent=function(data){var udp=this.opts.userDataProvider,user=udp.getUser(),session=udp.getSession(),externalUserId=false,userSummary=udp.getUserSummary(),externalData={};if(userSummary&&userSummary.hasOwnProperty("externalData")){externalData=userSummary.externalData;}
if(externalData&&externalData.hasOwnProperty("external_user_id")){externalUserId=externalData.external_user_id;}
console.log(externalUserId);if(externalUserId===false){throw new Error('MailTriggerListener:no external user id set');}
return{uid:user.userId,cl:user.shopId,sid:session.sessionId,c_prods:JSON.stringify(data.products),euid:externalUserId,tt:data._type||"pos",dl:JSON.stringify(externalData)};};module.exports=MailTriggerListener;return module.exports;}}
_trbo.modules['tracking/PageListenerV2']={module:function(){var module={exports:function(){console.log('bad module tracking/PageListenerV2.js');}};"use strict";var Helper=require('Helper');var PageListenerV2=function(opts){this.opts=opts;};PageListenerV2.prototype.makeClick=function(){var udp=this.opts.tracker.opts.userDataProvider,session=udp.getSession(),browser=udp.getBrowser(),deviceData=browser.getDeviceData(),channelData=session.channelData,event=this.opts.tracker.makeBasicEvent();event=Helper.mergeObjects(event,deviceData);event=Helper.mergeObjects(event,channelData);event=Helper.mergeObjects(event,session.sessionSummary);event=Helper.mergeObjects(event,udp.getUserSummary());return event;};PageListenerV2.prototype.transformOnsiteSessionEvent;PageListenerV2.prototype.transformOnsiteTrackEvent=function(data){var udp=this.opts.tracker.opts.userDataProvider;var result=this.opts.tracker.transformObject(data,{cl:'shopId',c_id:'campaignId',cls:'sessionDuration',created:'firstClickTime',fct:'firstClickTime',group:'abGroup',lct:'lastClickTime',nsc:'pageViewCount',num_conversions:'saleCount',num_sessions:'sessionCount',page_duration:'sessionDuration',sdt:'sessionDurationTotal',pg:'url',rand:{value:Math.random()*4000000000},sid:'sessionId',total_page_views:'pageViewCountTotal',uid:'userId',protocol:'protocol',browser:'userAgent',st:'segmentId',bw:udp.getBrowser().getViewport().width,bh:_trbo.udp.getBrowser().getViewport().height,pt:{value:udp.getPageTypeId(udp.getPage().type)}});try{var _data_layer=udp.getUserSummary().externalData;var _submit_dl={};var _submit_dl_count=0;for(var _dl_key in _data_layer){if(_data_layer[_dl_key]!==''&&_data_layer[_dl_key]!=='n/a'&&_data_layer[_dl_key]!==-1&&_dl_key!='_type'&&_dl_key!='trbo_module_blacklist'){_submit_dl[_dl_key]=_data_layer[_dl_key];_submit_dl_count++;}}
result.dl=JSON.stringify(_submit_dl);}catch(err){}
return result;};PageListenerV2.prototype.transformClickSessionEvent;PageListenerV2.prototype.transformClickTrackEvent=function(data){var udp=this.opts.tracker.opts.userDataProvider;var result=this.opts.tracker.transformObject(data,{browser:'userAgent',browser_type:'browserType',c_id:'campaignId',channel:'channel',cl:'shopId',click_type:'channel',pg:'url',device:'device',device_type:'deviceType',group:'abGroup',has_flash:{cast:'int',key:'hasFlash'},is_adclick:{cast:'int',key:"isAdClick"},is_click_in:{value:1},is_mobile:{cast:'int',value:data.deviceType=='mobile'},is_organic:{cast:'int',key:"isOrganic"},is_referrer:{cast:'int',key:"isReferrer"},is_tablet:{cast:'int',value:data.deviceType=='tablet'},is_typein:{cast:'int',value:data.channel=='typein'},keyword:'keyword',os:'os',protocol:'protocol',rand:{value:Math.random()*4000000000},referrer:'referrer',uid:'userId',sid:'sessionId',bw:udp.getBrowser().getViewport().width,bh:_trbo.udp.getBrowser().getViewport().height,pt:{value:udp.getPageTypeId(udp.getPage().type)}});return result;};PageListenerV2.prototype.handleByType=function(type,data,transformSessionFunc,transformTrackFunc){this.opts.tracker.track({type:type,data:transformTrackFunc(data)});var udp=this.opts.tracker.opts.userDataProvider;udp.addSessionEvent({type:type,data:transformSessionFunc(data)});};PageListenerV2.prototype.handlePage=function(event){var udp=this.opts.tracker.opts.userDataProvider,page=udp.getPage();if(event._type){page.type=event._type;page.subtype=-1;try{if(event.subtype&&parseInt(event.subtype)>0){page.subtype=event.subtype;}}catch(err){}
var _page_type_id=udp.getPageTypeId(page.type);if((_page_type_id<0&&_page_type_id<4)||_page_type_id>5){udp.addSessionEvent({type:'page',data:{page_type_id:_page_type_id,page_type:page.type}});}}};PageListenerV2.prototype.handleCurrentBasket=function(event){var udp=this.opts.tracker.opts.userDataProvider,currentBasket=udp.getCurrentBasket();if(typeof(event.value)!=="undefined"&&parseFloat(event.value)>=0){currentBasket.value=parseFloat(event.value);}
if(event.voucher){try{if(event.voucher=='[[voucher]]'){event.voucher='0';}}catch(err){}
currentBasket.voucher=event.voucher;}
if(event.product_ids){currentBasket.p=event.product_ids;}
if(event.categories){currentBasket.c=event.categories;}}
PageListenerV2.prototype.handlePageView=function(event){var udp=this.opts.tracker.opts.userDataProvider,session=udp.getSession(),window=udp.getBrowser().getWindow(),data=this.makeClick(),summary=session.sessionSummary,userSummary=udp.getUserSummary();udp.addPageView();if(summary.pageViewCount==1){this.handleByType('c',data,this.transformClickSessionEvent.bind(this),this.transformClickTrackEvent.bind(this));}else{this.handleByType('os',data,this.transformOnsiteSessionEvent.bind(this),this.transformOnsiteTrackEvent.bind(this));}
if(typeof _trbo!=="undefined"&&_trbo.app&&_trbo.app.listeners&&_trbo.app.listeners.layerListener&&_trbo.app.listeners.layerListener.layersRecorded){_trbo.app.listeners.layerListener.layersRecorded=[];}};module.exports=PageListenerV2;return module.exports;}}
_trbo.modules['tracking/ProductActionListener']={module:function(){var module={exports:function(){console.log('bad module tracking/ProductActionListener.js');}};"use strict";var ProductActionListener=function(opts){this.opts=opts;};ProductActionListener.prototype.handle=function(event){var me=this,type=event.type,productId=event.data;if(productId&&(type==="productLike"||type==="productDislike")){if(!this.opts.userDataProvider.getUserSummary().hasOwnProperty(type)){this.opts.userDataProvider.getUserSummary()[type]={};}
var currentList=this.opts.userDataProvider.getUserSummary()[type];currentList[productId]=(new Date()).getTime();currentList=me.cleanUpList(currentList,20);this.opts.userDataProvider.getUserSummary()[type]=currentList;this.opts.userDataProvider.saveData();}};ProductActionListener.prototype.cleanUpList=function(list,maxEntries){var stack=[],cleanedUp={};for(var productId in list){stack.push([productId,list[productId]]);}
stack.sort);stack.reverse();for(var index in stack){if(index<maxEntries){cleanedUp[stack[index][0]]=stack[index][1]}}
return cleanedUp;};module.exports=ProductActionListener;return module.exports;}}
_trbo.modules['tracking/ProductViewListener']={module:function(){var module={exports:function(){console.log('bad module tracking/ProductViewListener.js');}};"use strict";var Helper=require('Helper'),json=require('lib/JSON'),UserDataProvider=require('UserDataProvider');var ProductViewListener=function(opts){this.opts=opts;};ProductViewListener.prototype.makeEvent=function(data){var event=this.opts.tracker.makeBasicEvent(),udp=this.opts.tracker.opts.userDataProvider,requestDataTransformer=_trbo.app.opts.requestDataTransformer;if(typeof data.products==='object'){data.products=jTrbo.makeArray(data.products);}
try{jTrbo.each(data.products,function(productIndex,product){product.product_id=(product.product_id+"").substring(0,150);});}catch(e){}
if(typeof JSON=='object'&&typeof JSON.stringify==='function'){var _str_products=JSON.stringify(data.products);}else{var _str_products=json.stringify(data.products);}
event=Helper.mergeObjects(event,{pageType:udp.getPageTypeId(udp.getPage().type),products:_str_products,pvt:this.opts.config.pvt});if([12611,13788,1].indexOf(parseInt(this.opts.config.shopId))>=0){event=Helper.mergeObjects(event,{sessions:requestDataTransformer.getLatestSessions(),currentBasket:udp.getCurrentBasket(),saleCount:udp.getUserSummary().saleCount,sessionDurationTotal:udp.getUserSummary().sessionDurationTotal,sessionCount:udp.getUserSummary().sessionCount,href:document.location.href,productCounts:requestDataTransformer.getProductsCount(),lastSales:requestDataTransformer.getSales()});}
event.clientTime=Helper.getTime();return event;};ProductViewListener.prototype.transformProductViewSessionEvent=function(data){var udp=this.opts.tracker.opts.userDataProvider;var blacklist_fields=UserDataProvider.localRecordBlacklist;blacklist_fields.push('url');blacklist_fields.push('abGroup');blacklist_fields.push('segmentId');blacklist_fields.push('pageType');blacklist_fields.push('protocol');udp.cleanupLocalEventData(data,blacklist_fields);delete data.pvt;delete data.type;return data;};ProductViewListener.prototype.transformProductViewTrackEvent=function(data){var result=this.opts.tracker.transformObject(data,{cl:'shopId',uid:'userId',sid:'sessionId',st:'segmentId',c_id:'campaignId',group:'abGroup',device_type:'deviceType',device:'device',pg:'url',protocol:'protocol',c_prods:'products',pt:'pageType',pvt:'pvt',s:{value:typeof data.sessions=='object'?json.stringify(data.sessions):data.sessions},cb:{value:typeof data.currentBasket=='object'?json.stringify(data.currentBasket):data.currentBasket},seg:{value:typeof data.segments=='object'?json.stringify(data.segments):data.segments},c:{value:typeof data.lastSales=='object'?json.stringify(data.lastSales):data.lastSales},ts:'saleCount',sdt:'sessionDurationTotal',sc:'sessionCount',p:'href',pc:{value:typeof data.productCounts=='object'?json.stringify(data.productCounts):data.productCounts},});try{var externalUserId=this.opts.tracker.opts.userDataProvider.getExternalUserId();if(externalUserId){result.euid=externalUserId;}}catch(e){}
try{result.dl='{}';var submitExternalData={};if(this.opts.tracker.opts.userDataProvider.getUserSummary().externalData){for(var i in this.opts.tracker.opts.userDataProvider.getUserSummary().externalData){if(i==='trbo_module_blacklist'){continue;}
if(!this.opts.tracker.opts.userDataProvider.getUserSummary().externalData[i]){continue;}
if(this.opts.tracker.opts.userDataProvider.getUserSummary().externalData[i]===''){continue;}
if(this.opts.tracker.opts.userDataProvider.getUserSummary().externalData[i]==='n/a'||this.opts.tracker.opts.userDataProvider.getUserSummary().externalData[i]==-1){continue;}
submitExternalData[i]=this.opts.tracker.opts.userDataProvider.getUserSummary().externalData[i];}
result.dl=json.stringify(submitExternalData);}}catch(err){}
return result;};ProductViewListener.prototype.handle=function(event){try{if(event&&event.products&&typeof event.products==='object'){event.products=jTrbo.makeArray(event.products);}}catch(e){}
try{if(!event||!event.products||event.products.length<=0){return;}else{if(event.products.length===1&&Array.isArray(event.products[0])===true){event.products=event.products[0];}
var _new_products=[];for(var i=0;i<event.products.length;i++){if(!event.products[i].product_id&&!event.products[i].id&&!event.products[i].products_id){continue;}
if(!event.products[i].product_id){if(event.products[i].id&&event.products[i].id!=="null"&&event.products[i].id!=="NULL"&&event.products[i].id!==""){event.products[i].product_id=event.products[i].id;delete event.products[i].id;}else if(event.products[i].products_id&&event.products[i].products_id!=="null"&&event.products[i].products_id!=="NULL"&&event.products[i].products_id!==""){event.products[i].product_id=event.products[i].products_id;delete event.products[i].products_id;}}
if(event.products[i].product_id&&event.products[i].product_id!==""){if(!event.products[i].name){event.products[i].name='';}
if(!event.products[i].quantity||event.products[i].quantity===""){event.products[i].quantity=1;}
_new_products.push(event.products[i]);}}
if(_new_products.length<=0){return;}
event.products=_new_products;}}catch(err){}
var tracker=this.opts.tracker,productViewEvent=this.makeEvent(event);tracker.track({type:'prov',data:this.transformProductViewTrackEvent(productViewEvent)});tracker.opts.userDataProvider.addSessionEvent({type:'productView',data:this.transformProductViewSessionEvent(productViewEvent)});tracker.opts.userDataProvider.setCurrentProductIds(event);};module.exports=ProductViewListener;return module.exports;}}
_trbo.modules['tracking/SegmentDataListener']={module:function(){var module={exports:function(){console.log('bad module tracking/SegmentDataListener.js');}};"use strict";var Helper=require('Helper'),json=require('lib/JSON'),UserDataProvider=require('UserDataProvider');var SegmentDataListener=function(opts){this.opts=opts;};SegmentDataListener.prototype.makeEvent=function(data){var event=this.opts.tracker.makeBasicEvent(),udp=this.opts.tracker.opts.userDataProvider;event=Helper.mergeObjects(event,{euid:data.euid});event.clientTime=udp.pluginStartTime;return event;};SegmentDataListener.prototype.transformSegmentDataTrackEvent=function(data){var result=this.opts.tracker.transformObject(data,{cl:'shopId',uid:'userId',sid:'sessionId',device_type:'deviceType',device:'device',pg:'url',protocol:'protocol',euid:'euid'});return result;};SegmentDataListener.prototype.handle=function(event){var tracker=this.opts.tracker,userMatchingEvent=this.makeEvent(event),udp=this.opts.tracker.opts.userDataProvider,userSummary=udp.getUserSummary(),browserTs=parseInt(Math.round((new Date()).getTime()/ 1000));var saveSegmentData={};var saveSegmentDataCount=0;if(typeof(event)==="object"&&event.type==='segmentData'){for(var sdm_key in event){if(sdm_key!=='type'&&event[sdm_key]!==""){if(parseInt(event[sdm_key])!=='NaN'){saveSegmentData[sdm_key]=parseInt(event[sdm_key]);if(saveSegmentData[sdm_key]>0){saveSegmentData[sdm_key]+=browserTs;}
saveSegmentDataCount++;}}}}
if(saveSegmentDataCount>0){udp.addSegmentData(saveSegmentData);}};module.exports=SegmentDataListener;return module.exports;}}
_trbo.modules['tracking/SegmentIdListener']={module:function(){var module={exports:function(){console.log('bad module tracking/SegmentIdListener.js');}};"use strict";var Helper=require('Helper'),json=require('lib/JSON'),UserDataProvider=require('UserDataProvider');var SegmentIdListener=function(opts){this.opts=opts;};SegmentIdListener.prototype.makeEvent=function(data){var event=this.opts.tracker.makeBasicEvent(),udp=this.opts.tracker.opts.userDataProvider;event=Helper.mergeObjects(event,{stt:data.stt,sts:data.sts});try{if(data.value&&parseFloat(data.value)>0){event.c_v=parseFloat(data.value);event.stt='sale';}
if(event.td){delete event.td;}}catch(err){}
event.clientTime=udp.pluginStartTime;return event;};SegmentIdListener.prototype.transformSegmentIdsTrackEvent=function(data){var result=this.opts.tracker.transformObject(data,{cl:'shopId',uid:'userId',sid:'sessionId',device_type:'deviceType',device:'device',pg:'url',protocol:'protocol',stt:'stt',sts:'sts',c_type:'c_type'});result.sinu=[];result.sins=[];if(data.c_v&&parseFloat(data.c_v)>0){result.c_v=parseFloat(data.c_v);}
try{var _segment_ids=result.sts.split(',');var _local_storage_segment_ids=[];var _session_storage_segment_ids=[];var _local_storage_segment_ids_by_date={};var _current_date='19790715';try{try{if(window._trbo.app.layerApi.response.ts&&parseInt(window._trbo.app.layerApi.response.ts)>0){var d=new Date(parseInt(window._trbo.app.layerApi.response.ts)*1000);}else{var d=new Date();}}catch(err){var d=new Date();}
_current_date=[d.getFullYear(),('0'+(d.getMonth()+1)).slice(-2),('0'+d.getDate()).slice(-2)].join('');}catch(err){}
try{_local_storage_segment_ids_by_date=JSON.parse(window.localStorage._trbo_seg);_session_storage_segment_ids=JSON.parse(window.sessionStorage._trbo_seg);}catch(err){}
if(_local_storage_segment_ids_by_date&&_local_storage_segment_ids_by_date[_current_date]){_local_storage_segment_ids=_local_storage_segment_ids_by_date[_current_date];}
if(_segment_ids&&_segment_ids.length>0){for(var i=0;i<_segment_ids.length;i++){var _segment_id=parseInt(_segment_ids[i]);if(_local_storage_segment_ids.indexOf(_segment_id)<0){_local_storage_segment_ids.push(_segment_id);result.sinu.push(_segment_id);}
if(_session_storage_segment_ids.indexOf(_segment_id)<0){_session_storage_segment_ids.push(_segment_id);result.sins.push(_segment_id);}}
if(result.sinu.length>0){var _new_local_storage_segment_ids={}
_new_local_storage_segment_ids[_current_date]=_local_storage_segment_ids;if(!this.opts.config.skipLocalStorage||this.opts.config.skipLocalStorage!==true){window.localStorage._trbo_seg=JSON.stringify(_new_local_storage_segment_ids);}}
if(result.sins.length>0){if(!this.opts.config.skipLocalStorage||this.opts.config.skipLocalStorage!==true){window.sessionStorage._trbo_seg=JSON.stringify(_session_storage_segment_ids);}}}
result.sinu=JSON.stringify(result.sinu);result.sins=JSON.stringify(result.sins);}catch(err){}
return result;};SegmentIdListener.prototype.handle=function(event){var tracker=this.opts.tracker,segmentIdEvent=this.makeEvent(event);tracker.track({type:'seg',data:this.transformSegmentIdsTrackEvent(segmentIdEvent)});};module.exports=SegmentIdListener;return module.exports;}}
_trbo.modules['tracking/TestingDataListener']={module:function(){var module={exports:function(){console.log('bad module tracking/TestingDataListener.js');}};"use strict";var Helper=require('Helper'),json=require('lib/JSON'),UserDataProvider=require('UserDataProvider');var TestingDataListener=function(opts){this.opts=opts;};TestingDataListener.prototype.handle=function(event){var tracker=this.opts.tracker,udp=this.opts.tracker.opts.userDataProvider,browserTs=parseInt(Math.round((new Date()).getTime()/ 1000));var saveTestingData={};var saveTestingDataCount=0;var oldTestingDataTracking=this.opts.userDataProvider.getTestingDataTracking();try{if(typeof(event)==="object"&&event.type==='testingData'){for(var sdm_key in event){if(sdm_key!=='type'&&event[sdm_key]!==""&&sdm_key.match(/^slot[0-9]{1,10}$/)){if(typeof event[sdm_key]==='string'||typeof event[sdm_key]==='number'){saveTestingData[sdm_key]=event[sdm_key];saveTestingDataCount++;}}}}
if(saveTestingDataCount>0){udp.addTestingData(saveTestingData);}}catch(err){}
try{var newTestingDataTracking=this.opts.userDataProvider.getTestingDataTracking();if(JSON.stringify(oldTestingDataTracking.slots)!==JSON.stringify(newTestingDataTracking.slots)){var trackingData=this.makeTrackingEvent(event);trackingData.td=JSON.stringify(newTestingDataTracking);tracker.track({type:'testing',data:trackingData});}}catch(err){}};TestingDataListener.prototype.makeTrackingEvent=function(data){var basicEvent=this.opts.tracker.makeBasicEvent(),udp=this.opts.tracker.opts.userDataProvider;basicEvent=Helper.mergeObjects(basicEvent,{pageType:udp.getPageTypeId(udp.getPage().type)});basicEvent.clientTime=Helper.getTime();return this.opts.tracker.transformObject(basicEvent,{cl:'shopId',uid:'userId',sid:'sessionId',st:'segmentId',device_type:'deviceType',device:'device',pg:'url',protocol:'protocol',pt:'pageType'});};module.exports=TestingDataListener;return module.exports;}}
_trbo.modules['tracking/Tracker']={module:function(){var module={exports:function(){console.log('bad module tracking/Tracker.js');}};"use strict";var Helper=require('Helper');var Tracker=function(opts){if(!opts.adapter||!opts.userDataProvider){throw new Error("Tracker expects adapter and userDataProvider in opts");}
this.opts=opts;};Tracker.normalizeUrl;Tracker.extractProtocol;Tracker.prototype.track=function(event){try{if(_trbo.app.layerApi&&_trbo.app.layerApi.response&&_trbo.app.layerApi.response.hasOwnProperty("dnt")&&_trbo.app.layerApi.response.dnt===true){event.data.dnt=true;}}catch(e){}
try{event.data.td=JSON.stringify(this.opts.userDataProvider.getTestingDataTracking());if(event.type&&event.type==='seg'){delete event.data.td;}}catch(err){}
if(event.data&&event.data.dnt===true&&(event.type==="limp"||event.type==="limps"||event.type==="lc")){return;}
if(event.callback){return this.jsonpAdapter.track(event.type,event.data,event.callback);}else{return this.opts.adapter.track(event.type,event.data);}};Tracker.prototype.makeLocalEvent=function(type){var udp=this.opts.userDataProvider,href=udp.getBrowser().getLocation().href;return{type:type||'none',url:Tracker.normalizeUrl(href),protocol:Tracker.extractProtocol(href),clientTime:Helper.getTime()};};Tracker.prototype.setJsonpAdapter=function(jsonpAdapter){this.jsonpAdapter=jsonpAdapter;};Tracker.prototype.makeBasicEvent=function(){var udp=this.opts.userDataProvider,user=udp.getUser(),session=udp.getSession(),browser=udp.getBrowser(),deviceData=browser.getDeviceData();return Helper.mergeObjects({userId:user.userId,sessionId:session.sessionId,clientTime:Helper.getTime(),abGroup:session.abGroup,segmentId:session.segmentId,shopId:user.shopId,campaignId:session.campaignId,device:deviceData.device,deviceType:deviceData.deviceType,pageType:udp.getPageTypeId(udp.getPage().type)},this.makeLocalEvent());};Tracker.prototype.trackClickAndRedirect=function(redirectUrl,productId,trackingParams){var campaignId=_trbo.app.layerApi.response.campaign_id;var moduleId=_trbo.app.layerApi.response.m;if(trackingParams!=undefined){if(trackingParams.campaignId){campaignId=trackingParams.campaignId;}
if(trackingParams.moduleId){moduleId=trackingParams.moduleId;}}
var basicEvent=this.makeBasicEvent(),params=this.transformObject(basicEvent,{cl:'shopId',uid:'userId',sid:'sessionId',c_id:{value:campaignId},module_id:{value:moduleId},device_type:'deviceType',device:'device',protocol:'protocol',st:'segmentId',pg:'url',pt:'pageType',dest:{value:redirectUrl}});if((productId+'').length>0){params.cpid=productId;}
try{params.td=JSON.stringify(this.opts.userDataProvider.getTestingDataTracking());}catch(err){}
this.opts.userDataProvider.getBrowser().getLocation().href=this.opts.adapter.makeUrl('lc',params);};Tracker.prototype.transformObject=function(data,map){var obj={};for(var key in map){var oldKey=map[key];switch(typeof oldKey){case'object':if(oldKey.cast){var subject;switch(true){case typeof oldKey.key!='undefined':subject=data[oldKey.key];break;case typeof oldKey.value!='undefined':subject=oldKey.value;break;default:throw Error('Tracker.cast expects key or value field');}
switch(oldKey.cast){case'int':obj[key]=Math.floor(0+subject);break;case'string':obj[key]=String(typeof data[oldKey.key]=='undefined'?'':data[subject]);break;default:throw Error('cannot Tracker.cast to type "'+data[oldKey].cast+'" when preparing '+key);}}else if(oldKey.value){obj[key]=oldKey.value;}
break;case'string':if(typeof data[oldKey]!='undefined'){obj[key]=data[oldKey];}
break;case'undefined':default:}}
return obj;};Tracker.prototype.prepareExternalCode=function(code,userType,campaignId,campaignName,moduleId,moduleName,additionalData){var clickType=1;try{clickType=additionalData.clickTypeId||1;}catch(e){}
code=code.replace(new RegExp("__TRBO_USER_TYPE__","g"),userType);code=code.replace(new RegExp("__TRBO_CAMPAIGN_ID__","g"),campaignId);code=code.replace(new RegExp("__TRBO_CAMPAIGN_NAME__","g"),campaignName);code=code.replace(new RegExp("__TRBO_MODULE_ID__","g"),moduleId);code=code.replace(new RegExp("__TRBO_MODULE_NAME__","g"),moduleName);code=code.replace(new RegExp("__TRBO_CLICK_TYPE_ID__","g"),clickType);return code;};Tracker.prototype.trackExternalEvent=function(type,data,additionalData,module){if(type==="view"){this.trackExternalView(data.userType,data.campaignId,data.campaignName,data.moduleId,data.moduleName,additionalData,module);}else if(type==="click"){this.trackExternalClick(data.userType,data.campaignId,data.campaignName,data.moduleId,data.moduleName,additionalData,module);}else if(type==="close"){this.trackExternalClose(data.userType,data.campaignId,data.campaignName,data.moduleId,data.moduleName,additionalData);}else if(type==="unfold"){this.trackExternalUnfold(data.userType,data.campaignId,data.campaignName,data.moduleId,data.moduleName,additionalData);}else if(type==="fold"){this.trackExternalFold(data.userType,data.campaignId,data.campaignName,data.moduleId,data.moduleName,additionalData);}else if(type==="mouseOver"){this.trackExternalMouseOver(data.userType,data.campaignId,data.campaignName,data.moduleId,data.moduleName,additionalData);}else if(type==="mouseOut"){this.trackExternalMouseOut(data.userType,data.campaignId,data.campaignName,data.moduleId,data.moduleName,additionalData);}};Tracker.prototype.trackExternalView=function(userType,campaignId,campaignName,moduleId,moduleName,additionalData,module){try{var rawCode=this.prepareExternalCode("(function(){var _ga_event_type=\'__TRBO_USER_TYPE__\'.replace(/_/g,\' \');if(_ga_event_type===\'trbo validation\')_ga_event_type=\'trbo control group\';if(_ga_event_type===\'trbo_validation\')_ga_event_type=\'trbo_control_group\';var _ga_event_name=\'__TRBO_MODULE_NAME__\'.replace(/_/g,\' \')+\'_\'+\'__TRBO_CAMPAIGN_NAME__\'.replace(/_/g,\' \')+\'___TRBO_MODULE_ID_____TRBO_CAMPAIGN_ID__\';if(typeof(tefDataLayer)!==\"undefined\"){tefDataLayer.push({event:\"eventGeneric\",eCat:_ga_event_type,eAct:\"impression\",eLab:_ga_event_name,eVal:0});}})();try{window.trbo_contentsquare_campaign_container=window.trbo_contentsquare_campaign_container||[],dataObject={\'campaign_id\':\'__TRBO_CAMPAIGN_ID__\',\'campaign_name\':\'__TRBO_CAMPAIGN_NAME__\',\'module_id\':\'__TRBO_MODULE_ID__\',\'module_name\':\'__TRBO_MODULE_NAME__\',\'user_type\':\'__TRBO_USER_TYPE__\',\'type\':\"impression\"};window.trbo_contentsquare_campaign_container.push(dataObject);window.jTrbo(document).trigger(\"trbo:contentSquare:campaignContainer:add\",[dataObject]);}catch(e){console.log(e);}",userType,campaignId,campaignName,moduleId,moduleName,additionalData),fnc=new Function("userType","campaignId","campaignName","moduleId","moduleName","additionalData","module",rawCode);fnc(userType,campaignId,campaignName,moduleId,moduleName,additionalData,module);}catch(e){}};Tracker.prototype.trackExternalClick=function(userType,campaignId,campaignName,moduleId,moduleName,additionalData,module){try{var rawCode=this.prepareExternalCode("(function(){var _ga_event_type=\'__TRBO_USER_TYPE__\'.replace(/_/g,\' \');if(_ga_event_type===\'trbo validation\')_ga_event_type=\'trbo control group\';if(_ga_event_type===\'trbo_validation\')_ga_event_type=\'trbo_control_group\';var _ga_event_name=\'__TRBO_MODULE_NAME__\'.replace(/_/g,\' \')+\'_\'+\'__TRBO_CAMPAIGN_NAME__\'.replace(/_/g,\' \')+\'___TRBO_MODULE_ID_____TRBO_CAMPAIGN_ID__\';if(typeof(tefDataLayer)!==\"undefined\"){tefDataLayer.push({event:\"eventGeneric\",eCat:_ga_event_type,eAct:\"click\",eLab:_ga_event_name,eVal:0});}})();try{window.trbo_contentsquare_campaign_container=window.trbo_contentsquare_campaign_container||[],dataObject={\'campaign_id\':\'__TRBO_CAMPAIGN_ID__\',\'campaign_name\':\'__TRBO_CAMPAIGN_NAME__\',\'module_id\':\'__TRBO_MODULE_ID__\',\'module_name\':\'__TRBO_MODULE_NAME__\',\'user_type\':\'__TRBO_USER_TYPE__\',\'type\':\"click\"};window.trbo_contentsquare_campaign_container.push(dataObject);window.jTrbo(document).trigger(\"trbo:contentSquare:campaignContainer:add\",[dataObject]);}catch(e){console.log(e);}",userType,campaignId,campaignName,moduleId,moduleName,additionalData,module),fnc=new Function("userType","campaignId","campaignName","moduleId","moduleName","additionalData","module",rawCode);fnc(userType,campaignId,campaignName,moduleId,moduleName,additionalData,module);}catch(e){}};Tracker.prototype.trackExternalClose=function(userType,campaignId,campaignName,moduleId,moduleName,additionalData){try{var rawCode=this.prepareExternalCode("",userType,campaignId,campaignName,moduleId,moduleName,additionalData),fnc=new Function(rawCode);fnc();}catch(e){}};Tracker.prototype.trackExternalUnfold=function(userType,campaignId,campaignName,moduleId,moduleName,additionalData){try{var rawCode=this.prepareExternalCode("",userType,campaignId,campaignName,moduleId,moduleName,additionalData),fnc=new Function(rawCode);fnc();}catch(e){}};Tracker.prototype.trackExternalFold=function(userType,campaignId,campaignName,moduleId,moduleName,additionalData){try{var rawCode=this.prepareExternalCode("",userType,campaignId,campaignName,moduleId,moduleName,additionalData),fnc=new Function(rawCode);fnc();}catch(e){}};Tracker.prototype.trackExternalMouseOver=function(userType,campaignId,campaignName,moduleId,moduleName,additionalData){try{var rawCode=this.prepareExternalCode("",userType,campaignId,campaignName,moduleId,moduleName,additionalData),fnc=new Function(rawCode);fnc();}catch(e){}};Tracker.prototype.trackExternalMouseOut=function(userType,campaignId,campaignName,moduleId,moduleName,additionalData){try{var rawCode=this.prepareExternalCode("",userType,campaignId,campaignName,moduleId,moduleName,additionalData),fnc=new Function(rawCode);fnc();}catch(e){}};module.exports=Tracker;return module.exports;}}
_trbo.modules['tracking/UserMatchingListener']={module:function(){var module={exports:function(){console.log('bad module tracking/UserMatchingListener.js');}};"use strict";var Helper=require('Helper'),json=require('lib/JSON'),UserDataProvider=require('UserDataProvider');var UserMatchingListener;UserMatchingListener.prototype.makeEvent=function(data){var event=this.opts.tracker.makeBasicEvent(),udp=this.opts.tracker.opts.userDataProvider;event=Helper.mergeObjects(event,{euid:data.euid});event.clientTime=udp.pluginStartTime;return event;};UserMatchingListener.prototype.transformUserMatchingTrackEvent=function(data){var result=this.opts.tracker.transformObject(data,{cl:'shopId',uid:'userId',sid:'sessionId',device_type:'deviceType',device:'device',pg:'url',protocol:'protocol',euid:'euid'});return result;};UserMatchingListener.prototype.handle=function(event){var tracker=this.opts.tracker,userMatchingEvent=this.makeEvent(event),udp=this.opts.tracker.opts.userDataProvider,userSummary=udp.getUserSummary();udp.addExternalUserId(event.euid);udp.saveData();tracker.track({type:'um',data:this.transformUserMatchingTrackEvent(userMatchingEvent)});};module.exports=UserMatchingListener;return module.exports;}}
_trbo.modules['tracking/VolatileDataListener']={module:function(){var module={exports};"use strict";var VolatileDataListener;VolatileDataListener.prototype.handle=function(event){var me=this;me.log.push(event);if(typeof(event)==="object"&&event.type==='volatileData'){jTrbo.each(event,function(dataKey,dataValue){if(dataKey!=="type"){me.storage[dataKey]=dataValue;}});}};VolatileDataListener.prototype.getStorageData
VolatileDataListener.prototype.resetStorage
module.exports=VolatileDataListener;return module.exports;}}}
_trbo_start();}
(function(plugin,params){var _run_plugin_code=true;try{if(document.location.pathname==='/shops/verfuegbarkeit/'&&document.location.search.indexOf('name=')>0){_run_plugin_code=true;}}catch(err){}
if(_run_plugin_code!==false){if(params&&params.shopId&&parseInt(params.shopId)===12437){window._trbo_new_tracking_enabled=true;}
if(params.remoteLocalStorage.allowSend===true){var runTrboApp=function(){if(window._TrboCurrentBasket&&window._TrboCurrentBasket.pushBasket&&parseInt(params.shopId)===13850){_TrboCurrentBasket.pushBasket()}
plugin.udp.setup();plugin.udp.datalayerHelper.run();plugin.app.run();},setAllowGet=function(){var currentHost=document.location.hostname,referrer=document.referrer,referrerHost,mainDomain=params.domains.main,refererTag=document.createElement("a"),referrerDomainNotCurrentDomain=function(referrerHost,currentHost,mainDomain){var referrerRest=referrerHost.replace(mainDomain,""),currentHostRest=currentHost.replace(mainDomain,"");if(referrerRest!==currentHostRest){return true;}else{return false;}};if(referrer===""||!referrer){return false;}
refererTag.href=referrer;referrerHost=refererTag.hostname;if(referrerHost.indexOf(mainDomain)>=0&&referrerDomainNotCurrentDomain(referrerHost,currentHost,mainDomain)){return true;}
return false;}
params.remoteLocalStorage.allowGet=setAllowGet();}
plugin.bootstrap=new(plugin.require('Bootstrap'))();plugin.app=plugin.bootstrap.bootstrap(params);plugin.udp=plugin.app.opts.userDataProvider;if(params.remoteLocalStorage.allowSend===true||params.remoteLocalStorage.allowGet===true){var buildFrame=function(name,src,callback){var frame=document.createElement("iframe");frame.setAttribute("id",name);frame.setAttribute("src",src);frame.setAttribute("style","display: none;");frame.setAttribute("height","0");frame.setAttribute("width","0");document.body.appendChild(frame);frame.onload=function(){callback.call();jTrbo("#"+name).addClass("trbo-loaded");};}
jTrbo(document).ready(function(){buildFrame(params.remoteLocalStorage.iframeId,params.remoteLocalStorage.iframeUrl,function(){if(params.remoteLocalStorage.allowGet===true){var successCallbackFired=false;document.getElementById(params.remoteLocalStorage.iframeId).contentWindow.postMessage({type:'trbo:app:ls:request',shopId:params.shopId},'*');window.setTimeout(function(){if(successCallbackFired===false){runTrboApp();}
successCallbackFired=true;},3000);window.addEventListener('message',function(message){var data=message.data;if(data.type==="trbo:app:ls:send"){var trboLocalStorageData=data.trboLocalStorageData;if(trboLocalStorageData&&typeof trboLocalStorageData==="object"&&successCallbackFired===false){try{jTrbo.each(trboLocalStorageData,function(key,value){if(value!=="undefined"&&value&&value.length>0){localStorage[key]=value;}});}catch(e){}}
if(successCallbackFired===false){runTrboApp();}
successCallbackFired=true;}});}});});}
if(plugin.udp.config&&plugin.udp.config.shopId&&parseInt(plugin.udp.config.shopId)===12437){if(params.remoteLocalStorage.allowGet!==true){plugin.udp.setup();plugin.app.run();}}else{setTimeout(function(){if(params.remoteLocalStorage.allowGet!==true){plugin.udp.setup();plugin.app.run();}},0);}}})(_trbo,{"trackingBaseUrl":"\/\/track2.trbo.com","useWhiteLabelTracking":false,"apiBaseUrl":"\/\/api.trbo.com","apiVersion":"3.2.0","skipLocalStorage":false,"skipCookies":false,"useStaticCookieNames":false,"shopId":12897,"namespace":"_trbo","pvt":"86400","pst":"604800","campaign":{},"datalayerMapping":[],"exitTriggerBound":10,"userTimeout":94608000,"datalayerTTls":{"loggedIn":1,"pushBundle-pex809":1,"ARE.ctid":1,"brand":1,"category_path":1,"categoryPath":1,"ARE.ocfup":1,"ARE.trbd":1,"ARE.tram":1,"ARE.hs":1,"ARE.amhv":1,"ARE.cg":1,"tes408":1,"ARE.rd30":1,"ARE.hwbdm":1,"ARE.spf_mt":1,"usernumber":1,"istheSameNumber":1,"ARE.onperm":1,"tes425Contact":1,"ARE.su":1,"ARE.ssid":1,"ARE.kue":1,"ARE.mev":1,"ARE.vvl_2nd_sim_oid":1,"ARE.yp":1,"ARE.2ndSim_call_not_reached":1,"tarifId_tes437":1,"ARE.consent_data":1,"search_keywords":1,"ARE.rv":1,"ARE.sco_2nd_sim":1,"mkt_cnst":-1,"is404":1,"ARE.gd":1,"ARE.age":1,"browser_language_en":1,"ARE.CTR_RET_5G_PACK_FLAG":1,"ARE.dsl_xsell_call_not_reached":1,"ARE.ret_vvl_inbox_mssg_unlimited":1,"loggedInFunc":1,"genericPdpId":1,"ARE.call_propensity":1,"ARE.call_reason_1":1,"isSafari":1,"latestGenericPdpId":1,"hotlineStatusCustomer":1,"latestProductId":1,"lastestTarifId":1,"permView":1,"permAdlayer":1,"pdpCustomerChoice":1,"pdpTVChoice":1,"vvlSelectedTarif":1,"vvlSelectedFlow":1,"TAA_LineOwner":1,"ARE.dh":1,"aep_segments":-1,"ARE.tsakv":1,"ARE.Iath_technlgy":1,"ARE.spf_mtvvl":1,"ARE.spf_dslvvl":1,"appliedStrokePrice":1,"appliedStrokePriceCode":1,"ARE.cid":1,"V-Check":1,"ARE.v4m_teaser":1,"selectedHWO":1,"ARE.permission_benefit_flag":1,"UC_Consent-Overlay_trbo":1,"basketContent":1,"ARE.FTTH_DTAG_AUSBAUSTATUS":1,"isSmartphoneCheck":1,"cbAllProducts":1,"allBasketContent":1,"lastPartnerTariffInWK fn":127,"ARE.hwo_36m_legit":1,"ARE.bp":1,"ARE.pauschaloffer":1,"ARE.pp_active":1,"ARE.pp_ben_used":1,"lastPartnerTariffInWK AB":127,"getWkAbbrecherStorage":1,"ARE.unbefr_treue":1,"PDP_includes_smartphone":1,"tesWKRedesign":1,"ARE.k1_promo_teaser":1},"datalayerConfigs":[{"name":"search_keywords","config":{"fillTypeId":"6","fallbackTypeId":1,"fallbackValue":"n\/a","fillSourceFn":"var value = _trbo.udp.datalayerHelper.getValueFromGetParam(\"q\");\n\nreturn value;","fillSourceName":"q"}},{"name":"is404","config":{"fillTypeId":"6","fallbackTypeId":1,"fallbackValue":"n\/a","fillSourceFn":"if (jTrbo('.breadcrumb:contains(404)').length > 0) {\n    return 'yes';\n}\n\nreturn 'no';","fillSourceName":"item_name"}},{"name":"browser_language_en","config":{"fillTypeId":"6","fallbackTypeId":1,"fallbackValue":"n\/a","fillSourceFn":"var browser_language_en = \"\";\ntry {\n    var userLang = navigator.language || navigator.userLanguage;\n    if (userLang.indexOf(\"en\") > -1) {\n        browser_language_en = \"yes\";\n    } else {\n        browser_language_en = \"no\";\n    }\n} catch (error) {\n    console.log(error);\n}\nreturn browser_language_en;\n","fillSourceName":"item_name"}},{"name":"loggedInFunc","config":{"fillTypeId":"6","fallbackTypeId":"2","fallbackValue":"NA","fillSourceFn":"try {\n    setTimeout(function () {\n        var shadowRootElement = document.querySelector(\"tef-navigation\");\n        if (typeof shadowRootElement != \"undefined\" && shadowRootElement !== null) {\n            if (!!shadowRootElement.shadowRoot) {\n                try {\n                    if (jTrbo(document.querySelector(\"tef-navigation\").shadowRoot.querySelector(\"header.loggedIn\")).length > 0) {\n                        \/\/ window._trbo_data_layer.loggedIn = \"Y\";\n                        return \"Y\";\n                    } else {\n                        return \"N\";\n                    }\n                } catch (error) {console.log(\"dl sr\", error)}\n            }\n        } else {\n            return \"root element not found\";\n        }\n    }, 1000);\n} catch (error) {console.log(\"dl sr\", error)}\n","fillSourceName":"item_name"}},{"name":"genericPdpId","config":{"fillTypeId":"6","fallbackTypeId":1,"fallbackValue":"n\/a","fillSourceFn":"if (jTrbo('section.section .items .shop-tile h2.shop-tile-h2').length) {\n    return jTrbo('section.section .items .shop-tile h2.shop-tile-h2').first().html().toLowerCase().replace(\/ \/g, '-').replace(\/&nbsp;\/g, '-');\n}\nreturn 'n\/a';","fillSourceName":"item_name"}},{"name":"latestGenericPdpId","config":{"fillTypeId":"6","fallbackTypeId":1,"fallbackValue":"n\/a","fillSourceFn":"if (jTrbo('section.section .items .shop-tile h2.shop-tile-h2').length) {\n    return jTrbo('section.section .items .shop-tile h2.shop-tile-h2').first().html().toLowerCase().replace(\/ \/g, '-').replace(\/&nbsp;\/g, '-');\n}","fillSourceName":"item_name"}},{"name":"hotlineStatusCustomer","config":{"fillTypeId":"6","fallbackTypeId":"2","fallbackValue":"n\/a","fillSourceFn":"if (location.href.indexOf('o2online.de\/kontakt\/') > -1) {\n    \/\/console.log('trbo ' + jTrbo('.panel-group:first .panel:contains(O2 Kunden-Hotline) .occupancy-status-graph-tooltip:contains(Jetzt)').text());\n    return jTrbo('.panel-group:first .panel:contains(O2 Kunden-Hotline) .occupancy-status-graph-tooltip:contains(Jetzt)').text();\n}\nreturn 'no';","fillSourceName":"item_name"}},{"name":"latestProductId","config":{"fillTypeId":"6","fallbackTypeId":1,"fallbackValue":"n\/a","fillSourceFn":"if (window._parse_trbo_detail_dl().smartphone && window._parse_trbo_detail_dl().smartphone.id) {\n    return window._parse_trbo_detail_dl().smartphone.id;\n}\nelse {\n    return 'n\/a';\n}","fillSourceName":"item_name"}},{"name":"lastestTarifId","config":{"fillTypeId":"6","fallbackTypeId":1,"fallbackValue":"n\/a","fillSourceFn":"if (_trbo.udp.page.type === 'detail' && window._parse_trbo_detail_dl().postpaid && window._parse_trbo_detail_dl().postpaid.id) {\n    return window._parse_trbo_detail_dl().postpaid.id;\n}\n","fillSourceName":"item_name"}},{"name":"pdpCustomerChoice","config":{"fillTypeId":"6","fallbackTypeId":1,"fallbackValue":"n\/a","fillSourceFn":"if (sessionStorage.getItem(\"pdpCustomerChoice\") !== null) {\n    return sessionStorage.getItem(\"pdpCustomerChoice\");\n}\n","fillSourceName":"item_name"}},{"name":"pdpTVChoice","config":{"fillTypeId":"6","fallbackTypeId":1,"fallbackValue":"n\/a","fillSourceFn":"if (sessionStorage.getItem(\"pdpTVChoice\") !== null) {\n    return sessionStorage.getItem(\"pdpTVChoice\");\n}\n","fillSourceName":"item_name"}},{"name":"vvlSelectedTarif","config":{"fillTypeId":"6","fallbackTypeId":1,"fallbackValue":"n\/a","fillSourceFn":"if (location.href.indexOf('o2online.de\/econtract\/checkout') > -1) {\n    return jTrbo('.app-checkout.app-checkout-sticky .basket-item:last .main').text();\n}\nreturn 'n\/a';","fillSourceName":"item_name"}},{"name":"vvlSelectedFlow","config":{"fillTypeId":"6","fallbackTypeId":1,"fallbackValue":"n\/a","fillSourceFn":"if (location.href.indexOf('\/econtract\/auswahlseite') > -1 || location.href.indexOf('\/econtract\/star') > -1) {\n    console.log('set vvlSelectedFlow');\n    if (jTrbo(\"#content .stage-vvl .offer .headline .tariff-slogan:contains(Tarifwechsel)\").length > 0) {\n        return 'TW';\n    } else {\n        return 'VVL';\n    }\n}","fillSourceName":"item_name"}},{"name":"aep_segments","config":{"fillTypeId":"6","fallbackTypeId":1,"fallbackValue":"n\/a","fillSourceFn":"if(localStorage.hasOwnProperty(\"aep_segments\")) {\n    return JSON.parse(localStorage[\"aep_segments\"]);    \n}\n\nreturn 'n\/a';","fillSourceName":"item_name"}},{"name":"UC_Consent-Overlay_trbo","config":{"fillTypeId":"6","fallbackTypeId":"1","fallbackValue":"no","fillSourceFn":"if(localStorage.getItem(\"uc_user_interaction\")) {\n    return localStorage.getItem(\"uc_user_interaction\");\n}\nreturn 'n\/a';","fillSourceName":"item_name"}},{"name":"basketContent","config":{"fillTypeId":"6","fallbackTypeId":1,"fallbackValue":"n\/a","fillSourceFn":"try {\n    var hasSimOnly = false;\n    var hasBundle = false;\n    var hasTAA = false;\n\n    if (location.href.indexOf('o2online.de\/e-shop\/warenkorb') > -1) {\n        jTrbo('co-cart-item').each(function(){\n            if (jTrbo(this).find('.co-cart-item-header__title').text().trim() === 'Tarif'){\n                hasSimOnly = true;\n            }\n            else if (jTrbo(this).find('.co-cart-item-header__title').text().trim() === 'Internet und Festnetz') {\n                hasTAA = true;\n            }\n            else if (jTrbo(this).find('.co-cart-item-header__title').text().trim() === 'Ger\u00e4t mit Tarif'){\n                hasBundle = true;\n            }\n        });\n        if (hasSimOnly && hasBundle) {\n            return 'Mixed Basket';\n        }\n        else if (hasSimOnly) {\n            return 'Sim-Only';\n        }\n        else if (hasBundle) {\n            return 'Bundle';\n        }\n        else if (hasTAA) {\n            return 'TAA';\n        }\n        return 'n\/a';\n    }\n} catch (err) {}","fillSourceName":"item_name"}},{"name":"isSmartphoneCheck","config":{"fillTypeId":"6","fallbackTypeId":1,"fallbackValue":"n\/a","fillSourceFn":"const detailID = _parse_trbo_detail_dl().smartphone.id;\nif (detailID.indexOf(\"tv\") > -1 || detailID.indexOf(\"nintendo\") > -1) {\n    return \"no\";\n}\nif (detailID.indexOf(\"galaxy\") < 0 && detailID.indexOf(\"iphone\") < 0 && detailID.indexOf(\"xiaomi\") < 0 && detailID.indexOf(\"pixel\") < 0 && detailID.indexOf(\"xperia\") < 0 && detailID.indexOf(\"moto\") < 0 && detailID.indexOf(\"nokia-x\") < 0) {\n    return \"no\";\n}\nif (detailID.indexOf(\"mit\") < 0 && (detailID.indexOf(\"buds\") > -1 || detailID.indexOf(\"watch\") > -1 || detailID.indexOf(\"pods\") > -1)) {\n    return \"no\";\n}\nreturn \"yes\";\n","fillSourceName":"item_name"}},{"name":"cbAllProducts","config":{"fillTypeId":"6","fallbackTypeId":1,"fallbackValue":"n\/a","fillSourceFn":"return window._trboq.messages\n    .find((item) => item[0] === 'currentBasket')[1]\n    .product_ids\n    .join(' | ')\n    || 'n\/a';","fillSourceName":"item_name"}},{"name":"allBasketContent","config":{"fillTypeId":"6","fallbackTypeId":1,"fallbackValue":"n\/a","fillSourceFn":"let check = 'n\/a';\nlet basketArr = [];\n\nconst checkItems = {\n    'Internet und Festnetz': 'TAA',\n    'Ger\u00e4t mit Tarif': 'bundle',\n    'Tarif mit Flex': 'SimOnly-Flex',\n    'Tarif ohne Flex': 'SimOnly-Regular'\n};\n\n\nif (jTrbo('co-cart-item').length) {\n    jTrbo('co-cart-item').each(function () {\n        let productTitle;\n        if (jTrbo(this).find('.co-cart-item-header__title').text().trim() === 'Tarif') {\n            productTitle = jTrbo(this).find('span[data-co-uitest-element=\"article-name\"]').text().toLowerCase();\n            if (productTitle.includes('flex')) {\n                productTitle = 'Tarif mit Flex';\n            } else {\n                productTitle = 'Tarif ohne Flex';\n            }\n        } else {\n            productTitle = jTrbo(this).find('.co-cart-item-header__title').text().trim();\n        }\n        if (checkItems.hasOwnProperty(productTitle)) {\n            basketArr.push(' | ' + checkItems[productTitle]);\n        }\n    });\n    check = basketArr.join('').replace(' | ', '');\n}\n\nreturn check;","fillSourceName":"item_name"}},{"name":"lastPartnerTariffInWK fn","config":{"fillTypeId":"6","fallbackTypeId":1,"fallbackValue":"n\/a","fillSourceFn":"const tarifArray = [];\n\njTrbo(\"co-cart-item [data-co-uitest-element='cart-item-title']\").each(function () {\n    if (jTrbo(this).text().toLowerCase().trim() === \"tarif\") {\n        const tarifName = jTrbo(this).parents(\".co-cart-item\").find(\".co-article-heading__title\").text().toLowerCase().trim();\n        tarifArray.push(tarifName);\n    }\n});\n\nconst partnerTarif = tarifArray.find(function (entry) {\n    return entry.includes(\"partnerkarte\");\n});\nreturn partnerTarif;\n","fillSourceName":"item_name"}},{"name":"lastPartnerTariffInWK AB","config":{"fillTypeId":"6","fallbackTypeId":1,"fallbackValue":"n\/a","fillSourceFn":"const tarifArray = [];\n\njTrbo(\"co-cart-item [data-co-uitest-element='cart-item-title']\").each(function () {\n    if (jTrbo(this).text().toLowerCase().trim() === \"tarif\") {\n        const tarifName = jTrbo(this).parents(\".co-cart-item\").find(\".co-article-heading__title\").text().toLowerCase().trim();\n        tarifArray.push(tarifName);\n    }\n});\n\nconst partnerTarif = tarifArray.find(function (entry) {\n    return entry.includes(\"partnerkarte\");\n});\n\nif (partnerTarif && partnerTarif.length > 1) {\n    if (Math.random() < 0.5) {\n        return \"nullgruppe\";\n    } else {\n        return partnerTarif;\n    }\n}\n","fillSourceName":"item_name"}},{"name":"getWkAbbrecherStorage","config":{"fillTypeId":"6","fallbackTypeId":1,"fallbackValue":"n\/a","fillSourceFn":"if (localStorage.getItem(\"_tr_dbli\") && localStorage.getItem(\"_tr_dbli\") !== null) {\n    return localStorage.getItem(\"_tr_dbli\");\n}\n","fillSourceName":"item_name"}},{"name":"PDP_includes_smartphone","config":{"fillTypeId":"6","fallbackTypeId":1,"fallbackValue":"n\/a","fillSourceFn":"const detailID = _parse_trbo_detail_dl().smartphone.id;\nif (\n    (detailID.indexOf(\"galaxy-s\") > -1 ||\n        detailID.indexOf(\"galaxy-z\") > -1 ||\n        detailID.indexOf(\"galaxy-a\") > -1 ||\n        detailID.indexOf(\"galaxy-x\") > -1 ||\n        detailID.indexOf(\"iphone\") > -1 ||\n        detailID.indexOf(\"xiaomi-13\") > -1 ||\n        detailID.indexOf(\"xiaomi-redmi\") > -1 ||\n        detailID.indexOf(\"pixel-7\") > -1 ||\n        detailID.indexOf(\"pixel-8\") > -1 ||\n        detailID.indexOf(\"pixel-fold\") > -1 ||\n        detailID.indexOf(\"xperia\") > -1 ||\n        detailID.indexOf(\"moto\") > -1 ||\n        detailID.indexOf(\"nokia-x\") > -1 ||\n        detailID.indexOf(\"nokia-g\") > -1 ||\n        detailID.indexOf(\"cat-s\") > -1 ||\n        detailID.indexOf(\"fairphone\") > -1 ||\n        detailID.indexOf(\"nothing\") > -1 ||\n        detailID.indexOf(\"emporia\") > -1) &&\n        \n        (detailID.indexOf(\"-case-\") < 0 && \n        detailID.indexOf(\"keinhandyxyz\") < 0)\n) {\n    return \"yes\";\n}\nreturn \"no\";","fillSourceName":"item_name"}}],"domains":{"main":"","sub":[]},"remoteLocalStorage":{"allowGet":false,"allowSend":false,"iframeId":"trbo-app-remote-ls","iframeUrl":"https:\/\/static-v2.trbo.com\/iframe.html"},"externalPushIsBoundBySession":false,"eventParserConfig":false,"allowCrossDevice":false,"cookiePrefix":"tef","externalShopConfig":[],"tld4Cookie":".o2online.de"});_e0dd3c9ce40ccee402c5b331c88517a5_find_namespace=function(){for(var key in _trbo_namespaces){return _trbo_namespaces[key];}};_e0dd3c9ce40ccee402c5b331c88517a5_write_img_tag=function(pixelUrl){var namespace=_e0dd3c9ce40ccee402c5b331c88517a5_find_namespace();namespace.app.eventDispatcher.dispatch({type:'writeImage',pixelUrl:pixelUrl})};function _e0dd3c9ce40ccee402c5b331c88517a5_vocuher_layer_click(url){$jTrbo('#trbo_layer .cta').click(function(){_e0dd3c9ce40ccee402c5b331c88517a5_write_img_tag(url.replace('__link__',decodeURIComponent(document.location)));});}
if(!window._trbo.pluginConfig){window._trbo.pluginConfig={}}
try{window._trbo.pluginConfig["whiteLabelTrackingUrl"]="//track2.trbo.com"}catch(e){console.log(e);}
try{window._trbo.pluginConfig["overwrite_api_base_url"]="//api.trbo.com"}catch(e){console.log(e);}
try{window._trbo.pluginConfig["overwrite_api_script_name"]="/r.php"}catch(e){console.log(e);}
try{window._trbo.pluginConfig["cookiePrefix"]="tef"}catch(e){console.log(e);}
try{var _trboq=_trboq||[];var _trbo=_trbo||{};var _trbo_obj={apiStatus:"init",helper:{productCategories:[],},reloadApi:function(removeLayers,addPageViewEvent){var urlBlacklist=["edel.o2online.de/e-shop/","cci.o2online.de/e-shop/","leads.o2online.de/retail/","o2online.de/shops/verfuegbarkeit/"],currentUrl=document.location.href,reloadAllowed=true;jTrbo.each(urlBlacklist,function(urlIndex,urlPart){if(currentUrl.indexOf(urlPart)>-1){reloadAllowed=false;}});if(reloadAllowed===true){_trbo.app.reloadApi(removeLayers,addPageViewEvent);}},};window._trbo_prevent_document_write=true;window._trbo_overwrite_api_base_url="//api-v4.trbo.com";window._trbo_prevent_api_call=true;window._trbo_is_special_detail_page=false;window._trbo_use_image_tracking=true;window._trbo_check4_data_layer=false;window._trbo_new_tracking_enabled=true;window._trbo_detail_products=[];_trbo.pluginConfig={prevent_document_write:true,overwrite_api_base_url:"//api-v4.trbo.com",prevent_api_call:true,prevent_page_view:true,use_image_tracking:true,new_tracking_enabled:true,valid_testing_data:["custCookie","trafficType","detailProductType","productCategory","basketProducts"],};window._trbo_plugin_start=Date.now()/ 1000;window._trbo_current_basket={num:0,value:0,voucher:0,product_ids:[],};window._trbo_data_layer=window._trbo_data_layer||{permView:"false",pageCategory:"n/a",pageType:"static",pageSubType:-1,productId:"n/a",productIdGeneric:"n/a",tarifId:"n/a",tarifId_tes437:"n/a",mediacode:"n/a",partnerId:"n/a",partnerType:"n/a",isAffiliateUser:"no",appliedVoucherCode:"none",detailInfos:{},detailProduct:"n/a",detailProductBrand:"n/a",detailProductGeneric:"n/a",detailProductType:"n/a",brand:"n/a",categoryPath:"n/a",basketHasPostpaid:"no",basketHasSmartphone:"no",loggedIn:"N",trafficType:"other",service_funnel_active:"no",ARESIM:"n/a",productCategory:"n/a",basketProducts:"n/a",dyn_segment:{3:"n/a",4:"n/a",5:"n/a",6:"n/a",7:"n/a",8:"n/a",},override_segment_id:-1,cbProduct:"n/a",areWpId:"n/a",};window._tr_uc_check_consent=function(){try{var _uc_consent_data=JSON.parse(window.localStorage.getItem("usercentrics"));var _ucSettings_v2=JSON.parse(window.localStorage.getItem("uc_settings"));var _uc_tr_marketing_enabled=false;if(_uc_consent_data&&_uc_consent_data.consents&&_uc_consent_data.consents.length>0){for(var i=0;i<_uc_consent_data.consents.length;i++){if(_uc_consent_data.consents[i].templateId&&["__GnLvNxT","0mz99RC3x"].indexOf(_uc_consent_data.consents[i].templateId)>=0&&_uc_consent_data.consents[i].consentStatus===true){_uc_tr_marketing_enabled=true;}else if(_uc_consent_data.consents[i].dataProcessors&&_uc_consent_data.consents[i].dataProcessors.length>0&&_uc_consent_data.consents[i].dataProcessors.indexOf("trbo (Personalisierung)")>=0&&_uc_consent_data.consents[i].consentStatus===true){_uc_tr_marketing_enabled=true;}}}
if(_ucSettings_v2&&_ucSettings_v2.services){var trboConsentId="__dump_value";try{var filter=UC_UI.getServicesBaseInfo().filter(function(x){return x.name.toLowerCase().indexOf("trbo")>-1&&x.categorySlug=="marketing";});trboConsentId=filter[0].id;}catch(e){}
var ucConsentIds=["0mz99RC3x","__GnLvNxT"];if(trboConsentId!=="__dump_value"&&ucConsentIds.indexOf(trboConsentId)===-1){ucConsentIds.push(trboConsentId);}
jTrbo.each(_ucSettings_v2.services,function(ucServiceIndex,ucService){if(ucConsentIds.indexOf(ucService.id)>=0&&ucService.status===true){_uc_tr_marketing_enabled=true;}});}
if(_uc_tr_marketing_enabled!==true){window._trbo.pluginConfig.tracking_disabled=true;window._trbo.app.opts.config.skipCookies=true;window._trbo.app.opts.config.skipLocalStorage=true;window._trbo_data_layer.mkt_cnst="n";}else{window._trbo.pluginConfig.tracking_disabled=false;window._trbo.app.opts.config.skipCookies=false;window._trbo.app.opts.config.skipLocalStorage=false;window._trbo_data_layer.mkt_cnst="y";}
_trboq.push(["volatileData",{mkt_cnst:window._trbo_data_layer.mkt_cnst}]);_trbo.udp.saveData();delete window._trbo_data_layer.mkt_cnst;}catch(err){}};window._tr_uc_check_consent();window.addEventListener("UC_UI_INITIALIZED",function(event){window._tr_uc_check_consent();});window.addEventListener("UC_UI_VIEW_CHANGED",function(event){window._tr_uc_check_consent();});if(document.location.href.indexOf("felix=test")>0){console.log("try trbo api ::: init");}
try{if(["/e-shop/","/e-shop/","/"].indexOf(document.location.pathname)>=0){window._trbo.pluginConfig.use_combined_tracking=true;}}catch(err){}
function _tr_read_cookie_7a77a(cookieName){var name=cookieName+"=",ca=document.cookie.split(";");for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==" "){c=c.substring(1);}
if(c.indexOf(name)===0){return c.substring(name.length,c.length);}}
return"";}
try{var shadowRootElement=document.querySelector("tef-navigation");if(typeof shadowRootElement!="undefined"&&shadowRootElement!==null){if(!!shadowRootElement.shadowRoot){if(jTrbo(document.querySelector("tef-navigation").shadowRoot.querySelector("header.loggedIn")).length>0){window._trbo_data_layer.loggedIn="Y";}}}}catch(error){}
try{const fourteenDaysMS=14*24*60*60*1000;if(localStorage.getItem("_trbo_permView")!==null&&localStorage.getItem("_trbo_permView")==="true"&&localStorage.getItem("_trbo_permViewTime")!==null){if(parseInt(Date.now())-parseInt(localStorage.getItem("_trbo_permViewTime"))<fourteenDaysMS){window._trbo_data_layer.permView="true";}else{localStorage.removeItem("_trbo_permView");window._trbo_data_layer.permView="false";}}else{window._trbo_data_layer.permView="false";}}catch(error){}
try{var _trbo_override_segment_id=document.location.search.match(/trbo_override_segment_id=([\-]?[0-9]+)/);if(_trbo_override_segment_id&&_trbo_override_segment_id.length===2){_trbo_override_segment_id=_trbo_override_segment_id[1];var _tmp_date=new Date();_tmp_date.setTime(_tmp_date.getTime()+60*30*1000);var _trbo_override_segment_expire=_tmp_date.toUTCString();if(_trbo_override_segment_id==-1){_trbo_override_segment_id=-1;_trbo_override_segment_expire="Thu, 01 Jan 1970 00:00:00 UTC";}
document.cookie="_trbo_override_segment_id="+_trbo_override_segment_id+";expires="+_trbo_override_segment_expire+";path=/;domain=.o2online.de";}else{_trbo_override_segment_id=_tr_read_cookie_7a77a("_trbo_override_segment_id");if(!_trbo_override_segment_id||_trbo_override_segment_id===""){_trbo_override_segment_id=-1;}}
if(_trbo_override_segment_id&&parseInt(_trbo_override_segment_id)&&parseInt(_trbo_override_segment_id)>0){window._trbo_data_layer.override_segment_id=_trbo_override_segment_id;jTrbo.getScript("//static-v2.trbo.com/segmentTest.js");}}catch(err){}
try{var _trbo_are_wp_cookie=_tr_read_cookie_7a77a("are-wp");if(_trbo_are_wp_cookie&&_trbo_are_wp_cookie!==""){window._trbo_data_layer.areWp=_trbo_are_wp_cookie;window._trbo_data_layer.areWpId=_trbo_are_wp_cookie;}else{var _trbo_are_wp_dl=_trbo.udp.getUserSummary().externalData.areWp;if(_trbo_are_wp_dl&&_trbo_are_wp_dl!==""){_trbo.udp.getUserSummary().externalData.areWp=undefined;}}}catch(err){}
try{var _trbo_are_sim_cookie=_tr_read_cookie_7a77a("ARESIM");if(_trbo_are_sim_cookie&&_trbo_are_sim_cookie!==""){window._trbo_data_layer.ARESIM=_trbo_are_sim_cookie;}}catch(err){}
try{if(document.location.search&&document.location.search.indexOf("version=")>=0){var _tmp_version_url_match=document.location.search.match(/version=([a-z]{1})/);if(_tmp_version_url_match&&_tmp_version_url_match.length===2){window._trbo_data_layer.versionUrl=_tmp_version_url_match[1];}}}catch(err){}
try{if(document.location.search&&document.location.search.indexOf("leadid")>=0){var _tmp_leadid_url_match=document.location.search.match(/leadid=([a-z0-9]+)/);if(_tmp_leadid_url_match&&_tmp_leadid_url_match.length===2){window._trbo_data_layer.lead_id=_tmp_leadid_url_match[1];}}}catch(err){}
try{var _tr_o2_webshop_cookie=unescape(_tr_read_cookie_7a77a("webShop"));if(_tr_o2_webshop_cookie&&_tr_o2_webshop_cookie!==""){var _tr_o2_webshop_cookie_parts=_tr_o2_webshop_cookie.replace(/^\?/,"").split("&");if(_tr_o2_webshop_cookie_parts&&_tr_o2_webshop_cookie_parts.length>0){for(var _ci=0;_ci<_tr_o2_webshop_cookie_parts.length;_ci++){var _tr_o2_webshop_cookie_parts_sub=_tr_o2_webshop_cookie_parts[_ci].split("=");if(_tr_o2_webshop_cookie_parts_sub&&_tr_o2_webshop_cookie_parts_sub.length===2){if(_tr_o2_webshop_cookie_parts_sub[0]==="mediacode"){window._trbo_data_layer.mediacode=_tr_o2_webshop_cookie_parts_sub[1];}
if(_tr_o2_webshop_cookie_parts_sub[0]==="partnerId"){window._trbo_data_layer.partnerId=_tr_o2_webshop_cookie_parts_sub[1];}
if(_tr_o2_webshop_cookie_parts_sub[0]==="type"){window._trbo_data_layer.partnerType=_tr_o2_webshop_cookie_parts_sub[1];}}}}}
if(window._trbo_data_layer.partnerId&&window._trbo_data_layer.partnerId!=="n/a"){if(window._trbo_data_layer.partnerId.indexOf("O2_DTI_NEW_TEF_11003")>=0||window._trbo_data_layer.partnerId.indexOf("O2_AFF_")===0||window._trbo_data_layer.partnerId.indexOf("o2_off_")===0||window._trbo_data_layer.partnerId.indexOf("O2_OFF_")===0){window._trbo_data_layer.isAffiliateUser="yes";}
if(window._trbo_data_layer.partnerId.indexOf("_DSP")>=0){window._trbo_data_layer.trafficType="display";}else if(window._trbo_data_layer.partnerId.indexOf("_AFF")>=0){window._trbo_data_layer.trafficType="affiliate";}else if(window._trbo_data_layer.partnerId.indexOf("_DTI")>=0){window._trbo_data_layer.trafficType="direct";}else if(window._trbo_data_layer.partnerId.indexOf("_PAT")>=0){window._trbo_data_layer.trafficType="partnering";}else if(window._trbo_data_layer.partnerId.indexOf("_SEM")>=0){window._trbo_data_layer.trafficType="sem";}else if(window._trbo_data_layer.partnerId.indexOf("_SEO")>=0){window._trbo_data_layer.trafficType="seo";}}}catch(err){}
try{window._trbo_data_layer.custCookie="neukunde";var _customer_cookie=unescape(_tr_read_cookie_7a77a("cust"));if(_customer_cookie&&_customer_cookie.indexOf("CUST:1")>=0){window._trbo_data_layer.custCookie="bestandskunde";}}catch(err){}
try{var _trbo_tmp_url_parts=document.location.pathname.replace(/\/$/,"").split("/");var _is_valid_detail_page=false;if(_trbo_tmp_url_parts&&_trbo_tmp_url_parts.length>=4&&_trbo_tmp_url_parts[1]==="e-shop"){_is_valid_detail_page=true;}else if(_trbo_tmp_url_parts&&_trbo_tmp_url_parts.length>=4&&_trbo_tmp_url_parts[1]==="shop-configurator"&&_trbo_tmp_url_parts[2]==="pdp"){_is_valid_detail_page=true;}
if(_is_valid_detail_page===true){if(_trbo_tmp_url_parts[_trbo_tmp_url_parts.length-1].indexOf("-details")>0){window._trbo_data_layer.detailProduct=_trbo_tmp_url_parts[_trbo_tmp_url_parts.length-1].replace(/-details$/,"");window._trbo_data_layer.detailProductBrand=_trbo_tmp_url_parts[_trbo_tmp_url_parts.length-2];if(["android","bestandskunden","bestelldaten","bestellung","cci","default","ios","konfiguration","kopfhoerer","lautsprecher","o2","pdp","produkte","registrierung","selbstaendige","selbststaendige","studenten","surfsticks","tablets","tarif","test","warenkorb","zahlungsinformation","zahlungsinformationen","zubehoer","zusatzangebote"].indexOf(window._trbo_data_layer.detailProductBrand)>=0){window._trbo_data_layer.detailProductBrand="n/a";}
if(window._trbo_data_layer.detailProductBrand.indexOf("-")>=0){window._trbo_data_layer.detailProductBrand="n/a";}
if(jTrbo('link[rel="canonical"]').length===1){var _canonical_href=jTrbo('link[rel="canonical"]').attr("href").split("/");_canonical_href=_canonical_href[_canonical_href.length-1];if(_canonical_href.indexOf("-details")>0){window._trbo_data_layer.detailProduct=_canonical_href.replace(/-details$/,"");}}
if(document.location.search.indexOf("ohne-tarif=ja")>=0){window._trbo_data_layer.detailProduct+="-hwo";}else{window._trbo_data_layer.detailProduct+="-bundle";}}else if(_trbo_tmp_url_parts[2]==="tarif"){window._trbo_data_layer.detailProductBrand="o2";window._trbo_data_layer.detailProduct=_trbo_tmp_url_parts[_trbo_tmp_url_parts.length-1]+"-tarif";}
window._trbo_data_layer.brand=window._trbo_data_layer.detailProductBrand;}}catch(err){}
try{var _eshop_pathnames=document.location.pathname.split("/");if(_eshop_pathnames.length>=3&&_eshop_pathnames[1]=="e-shop"&&_eshop_pathnames[2]!=="warenkorb"&&_eshop_pathnames[2].match(/^[a-zA-Z-]+$/)){if(["tarif","bestandskunden"].indexOf(_eshop_pathnames[2].toLowerCase())<0){window._trbo_data_layer.brand=_eshop_pathnames[2].toLowerCase();}}else if(document.location.pathname.indexOf("/blog/themen/ios")>=0){window._trbo_data_layer.brand="apple";}else if(document.location.hostname=="hilfe.o2online.de"&&document.location.search&&document.location.search.match(/q=([a-zA-Z0-9+]+)/)){var _query_match=document.location.search.match(/q=([a-zA-Z0-9+]+)/);var _valid_brands=["apple","samsung","huawei","sony","lg","htc","honor"];for(var _xvb=0;_xvb<_valid_brands.length;_xvb++){if(_query_match[1].toLowerCase().indexOf(_valid_brands[_xvb])>=0){window._trbo_data_layer.brand=_valid_brands[_xvb];}}}
if(window._trbo_data_layer.brand&&window._trbo_data_layer.brand!=="n/a"){if(window._trbo_data_layer.brand.indexOf("-")>0){window._trbo_data_layer.brand="n/a";}else if(["android","bestandskunden","bestelldaten","bestellung","cci","default","ios","konfiguration","kopfhoerer","lautsprecher","o2","pdp","produkte","registrierung","selbstaendige","selbststaendige","studenten","surfsticks","tablets","tarif","test","warenkorb","zahlungsinformation","zahlungsinformationen","zubehoer","zusatzangebote"].indexOf(window._trbo_data_layer.brand)>=0){window._trbo_data_layer.brand="n/a";}}
if(window._trbo_data_layer.brand==="n/a"){if(_trbo.udp.getUserSummary().externalData.dsCurvedStrongestBrand&&_trbo.udp.getUserSummary().externalData.dsCurvedStrongestBrand!=="n/a"){window._trbo_data_layer.brand=_trbo.udp.getUserSummary().externalData.dsCurvedStrongestBrand;}else if(_trbo.udp.getUserSummary().externalData.dsCurvedLatestBrand&&_trbo.udp.getUserSummary().externalData.dsCurvedLatestBrand!=="n/a"){window._trbo_data_layer.brand=_trbo.udp.getUserSummary().externalData.dsCurvedLatestBrand;}}}catch(err){}
window._parse_trbo_detail_dl=function(save_data_to_dl){var _detail_infos={smartphone:{monthly:0,total:0,id:"",},tablet:{monthly:0,total:0,id:""},postpaid:{monthly:0,total:0,id:"",},total:{monthly:0,total:0,},};try{if(typeof tefDataLayer!=="undefined"&&tefDataLayer.length>0){for(var _tef_i=0;_tef_i<tefDataLayer.length;_tef_i++){if(tefDataLayer[_tef_i].u2&&(tefDataLayer[_tef_i].u2==="bundle"||tefDataLayer[_tef_i].u2==="hardwareonly")){if(tefDataLayer[_tef_i].u6==="smartphone"&&tefDataLayer[_tef_i].u16&&tefDataLayer[_tef_i].u16!==""){_detail_infos.smartphone.monthly=parseFloat(tefDataLayer[_tef_i].u16);_detail_infos.smartphone.total=parseFloat(tefDataLayer[_tef_i].u1);_detail_infos.smartphone.id=tefDataLayer[_tef_i].u13;}
if(tefDataLayer[_tef_i].u6==="tablet"&&tefDataLayer[_tef_i].u16&&tefDataLayer[_tef_i].u16!==""){_detail_infos.tablet.monthly=parseFloat(tefDataLayer[_tef_i].u16);_detail_infos.tablet.total=parseFloat(tefDataLayer[_tef_i].u1);_detail_infos.tablet.id=tefDataLayer[_tef_i].u13;}
if(tefDataLayer[_tef_i].u6==="postpaid"&&tefDataLayer[_tef_i].u16&&tefDataLayer[_tef_i].u16!==""){_detail_infos.postpaid.monthly=parseFloat(tefDataLayer[_tef_i].u16);_detail_infos.postpaid.total=parseFloat(tefDataLayer[_tef_i].u1);_detail_infos.postpaid.id=tefDataLayer[_tef_i].u13;}}
if(tefDataLayer[_tef_i].product_selected&&tefDataLayer[_tef_i].product_selected.length>0){for(var _tef_ii=0;_tef_ii<tefDataLayer[_tef_i].product_selected.length;_tef_ii++){if(tefDataLayer[_tef_i].product_selected[_tef_ii].type==="postpaid"){_detail_infos.postpaid.monthly=tefDataLayer[_tef_i].product_selected[_tef_ii].monthly_cost;if(tefDataLayer[_tef_i].product_selected[_tef_ii].discounts&&tefDataLayer[_tef_i].product_selected[_tef_ii].discounts.length>0){for(var _rc_i=0;_rc_i<tefDataLayer[_tef_i].product_selected[_tef_ii].discounts.length;_rc_i++){if(tefDataLayer[_tef_i].product_selected[_tef_ii].discounts[_rc_i].amountRC&&tefDataLayer[_tef_i].product_selected[_tef_ii].discounts[_rc_i].amountRC>0){_detail_infos.postpaid.monthly-=tefDataLayer[_tef_i].product_selected[_tef_ii].discounts[_rc_i].amountRC;}}}
_detail_infos.postpaid.total=_detail_infos.postpaid.monthly*tefDataLayer[_tef_i].product_selected[_tef_ii].rate_number;_detail_infos.postpaid.id=tefDataLayer[_tef_i].product_selected[_tef_ii].name;}
if(tefDataLayer[_tef_i].product_selected[_tef_ii].type==="smartphone"&&tefDataLayer[_tef_i].product_selected[_tef_ii].action=="Produktansicht"){_detail_infos.smartphone.monthly=tefDataLayer[_tef_i].product_selected[_tef_ii].monthly_cost;_detail_infos.postpaid.total=_detail_infos.smartphone.monthly*tefDataLayer[_tef_i].product_selected[_tef_ii].rate_number;_detail_infos.smartphone.id=tefDataLayer[_tef_i].product_selected[_tef_ii].name;_detail_infos.smartphone.total=_detail_infos.smartphone.monthly*tefDataLayer[_tef_i].product_selected[_tef_ii].rate_number;}
if(tefDataLayer[_tef_i].product_selected[_tef_ii].type==="tablet"&&tefDataLayer[_tef_i].product_selected[_tef_ii].action=="Produktansicht"){_detail_infos.tablet.monthly=tefDataLayer[_tef_i].product_selected[_tef_ii].monthly_cost;_detail_infos.postpaid.total=_detail_infos.tablet.monthly*tefDataLayer[_tef_i].product_selected[_tef_ii].rate_number;_detail_infos.tablet.id=tefDataLayer[_tef_i].product_selected[_tef_ii].name;_detail_infos.tablet.total=_detail_infos.tablet.monthly*tefDataLayer[_tef_i].product_selected[_tef_ii].rate_number;}}}}}
_detail_infos.total.total=parseFloat(_detail_infos.smartphone.total+_detail_infos.postpaid.total).toFixed(2);_detail_infos.total.monthly=parseFloat(_detail_infos.smartphone.monthly+_detail_infos.postpaid.monthly).toFixed(2);if(save_data_to_dl&&save_data_to_dl===true){_trboq.push(["dataMatching",{detailInfos:_detail_infos}]);_trbo.udp.saveData();}}catch(err){}
var _detail_infos_update=false;if(_detail_infos&&_detail_infos.postpaid&&_detail_infos.postpaid.id&&_detail_infos.postpaid.id!==""&&window._trbo_data_layer.tarifId!=_detail_infos.postpaid.id){window._trbo_data_layer.tarifId=_detail_infos.postpaid.id;window._trbo_data_layer.tarifId_tes437=_detail_infos.postpaid.id.split("online")[0].replace("bestandskunden","privatkunden").replace("studenten","privatkunden").replace("selbstaendige","privatkunden")+"online";_detail_infos_update=true;}
if(_detail_infos&&_detail_infos.smartphone&&_detail_infos.smartphone.id&&_detail_infos.smartphone.id!==""&&window._trbo_data_layer.productId!=_detail_infos.smartphone.id){window._trbo_data_layer.productId=_detail_infos.smartphone.id;_detail_infos_update=true;}
if(_detail_infos_update===true){window._trbo_parse_segment_data();}
try{if(_detail_infos&&_detail_infos.postpaid&&_detail_infos.postpaid.id){window._trbo_data_layer.customerType=_detail_infos.postpaid.id.split("-")[0];}
if(window._trbo_data_layer.customerType!=="privatkunden"){window._trbo_data_layer.customerTypeDetail=window._trbo_data_layer.customerType;_trboq.push(["dataMatching",{customerTypeDetail:window._trbo_data_layer.customerTypeDetail,},]);_trbo.udp.saveData();}}catch(err){}
return _detail_infos;};window._trbo_parse_data_layer=function(){if(document.location.pathname==="/shops/verfuegbarkeit/"){if(!window.tefDataLayer){window.tefDataLayer=[];}
return true;}
try{if(!window.tefDataLayer){if(document.location.pathname==="/"){window.tefDataLayer=[];window._trbo_data_layer.pageCategory="home";window._trbo_data_layer.pageType="home";}else{return false;}}else if(document.location.pathname=="/"){if(window.tefDataLayer.length<1){return false;}}else if(window.tefDataLayer.length<3){if(window.tefDataLayer[0]&&window.tefDataLayer[0].page&&window.tefDataLayer[0].page.content&&window.tefDataLayer[0].page.content.indexOf("cms/")===0){if(document.location.href.indexOf("felix=test")>0){console.log("trbo ::: cms skip ::: "+window.tefDataLayer.length);}}else{return false;}}else if(document.location.pathname.indexOf("/shop-configurator/pdp")===0&&window.tefDataLayer.length<5){return false;}}catch(err){if(document.location.href.indexOf("felix=test")>0){console.log(err);}
return false;}
if(document.location.href.indexOf("felix=test")>0){console.log("trbo-data-layer ::: found");}
try{if(jTrbo("script#voucher").length===1){var _script_json_voucher=JSON.parse(jTrbo("script#voucher").html());if(_script_json_voucher&&_script_json_voucher.appliedVoucher&&_script_json_voucher.appliedVoucher.voucherCode&&_script_json_voucher.appliedVoucher.voucherCode!==""){window._trbo_data_layer.appliedVoucherCode=_script_json_voucher.appliedVoucher.voucherCode;}}}catch(err){}
var _trbo_page_value_found=false;try{if(jTrbo("#pageValue").length>0){var _trbo_page_value=JSON.parse(jTrbo("#pageValue").first().html());if(_trbo_page_value["@type"]){switch(_trbo_page_value["@type"]){case"dslTariffDetails:DslTariffDetailsPageValue":case"pdp:PageValue":window._trbo_data_layer.pageCategory="detail";window._trbo_data_layer.pageType="detail";_trbo_page_value_found=true;break;}}}}catch(err){}
for(var _xii=0;_xii<window.tefDataLayer.length;_xii++){try{if(window.tefDataLayer[_xii].customer&&window.tefDataLayer[_xii].customer.type&&window.tefDataLayer[_xii].customer.type=="existingCustomer"){window._trbo_data_layer.Bestandskunde="ja";}}catch(err){}
try{if(window.tefDataLayer[_xii].Categories&&document.location.pathname.indexOf("/blog/")>=0){if(window.tefDataLayer[_xii].Categories!==""){window._trbo_data_layer.categoryPath=window.tefDataLayer[_xii].Categories.split(",")[0];window._trbo_data_layer.dsLatestAffinnity=window._trbo_data_layer.categoryPath;}}
if(!window._trbo_data_layer.dsLatestAffinnity||window._trbo_data_layer.dsLatestAffinnity=="n/a"){if(_trbo.udp.getUserSummary().externalData.dsCurvedStrongestAffinity&&_trbo.udp.getUserSummary().externalData.dsCurvedStrongestAffinity!=="n/a"){window._trbo_data_layer.dsLatestAffinnity=_trbo.udp.getUserSummary().externalData.dsCurvedStrongestAffinity;}
if(_trbo.udp.getUserSummary().externalData.dsCurvedLatestAffinity&&_trbo.udp.getUserSummary().externalData.dsCurvedLatestAffinity!=="n/a"){window._trbo_data_layer.dsLatestAffinnity=_trbo.udp.getUserSummary().externalData.dsCurvedLatestAffinity;}}}catch(err){}
if(window.tefDataLayer[_xii].pageCategory){window._trbo_data_layer.pageCategory=window.tefDataLayer[_xii].pageCategory;}
if(window.tefDataLayer[_xii].product_selected&&window.tefDataLayer[_xii].product_selected.length>0){for(var __xii=0;__xii<window.tefDataLayer[_xii].product_selected.length;__xii++){if(tefDataLayer[_xii].product_selected[__xii].action=="Produktansicht"){if(window._trbo_data_layer.productId==="n/a"){window._trbo_data_layer.productId=window.tefDataLayer[_xii].product_selected[__xii].name;}
if(window.tefDataLayer[_xii].product_selected[__xii].type==="postpaid"){window._trbo_data_layer.tarifId=window.tefDataLayer[_xii].product_selected[__xii].name;window._trbo_data_layer.tarifId_tes437=window.tefDataLayer[_xii].product_selected[__xii].name.split("online")[0].replace("bestandskunden","privatkunden").replace("studenten","privatkunden").replace("selbstaendige","privatkunden")+"online";}else if(window.tefDataLayer[_xii].product_selected[__xii].type==="dsl"){window._trbo_data_layer.tarifId=window.tefDataLayer[_xii].product_selected[__xii].name;window._trbo_data_layer.tarifId_tes437=window.tefDataLayer[_xii].product_selected[__xii].name.split("online")[0].replace("bestandskunden","privatkunden").replace("studenten","privatkunden").replace("selbstaendige","privatkunden")+"online";}
if(window.tefDataLayer[_xii].product_selected[__xii].id&&window.tefDataLayer[_xii].product_selected[__xii].id.indexOf(" ")>0){var _tmp_main_device_id_suffix=parseInt(window.tefDataLayer[_xii].product_selected[__xii].id.split(" ")[0]);if(_tmp_main_device_id_suffix===4510||_tmp_main_device_id_suffix===4938){window._trbo_data_layer.detailProductType="smartphone";}else if(_tmp_main_device_id_suffix===4515){window._trbo_data_layer.detailProductType="tablet";}else{window._trbo_data_layer.detailProductType="gadget";}}}}}
try{if(window.tefDataLayer[_xii].u6&&window.tefDataLayer[_xii].u6!==""){window._trbo_data_layer.productCategory=tefDataLayer[_xii].u6.toLowerCase();if(tefDataLayer[_xii].u2&&tefDataLayer[_xii].u2=="bundle"){window._trbo_data_layer.productCategory="bundle";}}
var _tmp_category=false;if(window.tefDataLayer[_xii].u2==="hardwareonly"){if(window.tefDataLayer[_xii].u6==="smartphone"){_tmp_category="hw-only_smartphone";}else if(window.tefDataLayer[_xii].u6==="tablet"){_tmp_category="hw-only_tablet";}else{_tmp_category="hw-only";}}else if(window.tefDataLayer[_xii].u2==="simonly"){if(window.tefDataLayer[_xii].u6==="postpaid"){_tmp_category="postpaid_sim-only";}else if(window.tefDataLayer[_xii].u6==="prepaid"){_tmp_category="prepaid_sim-only";}else{_tmp_category="postpaid_sim-only";}}else if(window.tefDataLayer[_xii].u2==="bundle"){_tmp_category="postpaid_bundle";}else if(window.tefDataLayer[_xii].u2==="dsl"){_tmp_category="dsl";}
if(_tmp_category!==false&&window._trbo_obj.helper.productCategories.indexOf(_tmp_category)<0){window._trbo_obj.helper.productCategories.push(_tmp_category);}
if(window._trbo_obj.helper.productCategories.length>0){window._trbo_data_layer.productCategory=window._trbo_obj.helper.productCategories.join("|");}}catch(err){}
if(window.tefDataLayer[_xii].static&&window.tefDataLayer[_xii].static.length>0){var __tmp_basket_segments=[];for(var __xii=0;__xii<window.tefDataLayer[_xii].static.length;__xii++){if(window.tefDataLayer[_xii].static[__xii].action==="cart"){if(window.tefDataLayer[_xii].static[__xii].type==="postpaid"){try{var _tmp_customer_type_basket_postpaid=window.tefDataLayer[_xii].static[__xii].name.split("-")[0];if(["bestandskunden","privatkunden","studenten","selbstaendige"].indexOf(_tmp_customer_type_basket_postpaid)>=0){window._trbo_data_layer.customerType=_tmp_customer_type_basket_postpaid;}
window._trbo_data_layer.basketProducts=window.tefDataLayer[_xii].static[__xii].name;}catch(err){}
window._trbo_data_layer.basketHasPostpaid="yes";}
if(window.tefDataLayer[_xii].static[__xii].type==="smartphone"){window._trbo_data_layer.basketHasSmartphone="yes";}
try{var _tmp_first_part_basket_name=window.tefDataLayer[_xii].static[__xii].name.split("-")[0];if(_tmp_first_part_basket_name&&_tmp_first_part_basket_name.length>0&&__tmp_basket_segments.indexOf(_tmp_first_part_basket_name)<0&&["bestandskunden","privatkunden","studenten","selbstaendige"].indexOf(_tmp_first_part_basket_name)>=0){__tmp_basket_segments.push(_tmp_first_part_basket_name);}}catch(err){}
try{if(window._trbo_current_basket.product_ids.indexOf(window.tefDataLayer[_xii].static[__xii].name)<0){window._trbo_current_basket.product_ids.push(window.tefDataLayer[_xii].static[__xii].name);if(window.tefDataLayer[_xii].static[__xii].type!=="pack"){window._trbo_data_layer.cbProduct=window.tefDataLayer[_xii].static[__xii].name;}
if(window.tefDataLayer[_xii].static[__xii].rate_number&&window.tefDataLayer[_xii].static[__xii].rate_number>0&&window.tefDataLayer[_xii].static[__xii].monthly_cost>0){window._trbo_current_basket.value+=window.tefDataLayer[_xii].static[__xii].rate_number*window.tefDataLayer[_xii].static[__xii].monthly_cost;}else{window._trbo_current_basket.value+=99;}}}catch(err){}}}
if(__tmp_basket_segments.length>0){window._trbo_data_layer.basketCustomerTypes=__tmp_basket_segments.join("|");}}}
if(jTrbo("#pricesAndBenefitsPageValue").length===1&&window._trbo_current_basket.value<=0&&document.location.pathname=="/e-shop/warenkorb"){try{var priceAndBenefitPageValue=Object.keys(JSON.parse(jTrbo("#pricesAndBenefitsPageValue").html()).initialChargesMap)[0];var priceAndBenefitPageValueMatch=priceAndBenefitPageValue.match(/^(o2shop|cctroj)\-([a-z]+)\-/);var priceAndBenefitPageValueMatchSubs=priceAndBenefitPageValue.replace(/^(o2shop|cctroj)\-/,"").split("-"+priceAndBenefitPageValueMatch[2]);if(priceAndBenefitPageValueMatchSubs&&priceAndBenefitPageValueMatchSubs.length>=2){window._trbo_current_basket.value=1;window._trbo_current_basket.product_ids.push(priceAndBenefitPageValueMatchSubs[0]);window._trbo_current_basket.product_ids.push(priceAndBenefitPageValueMatch[2]+priceAndBenefitPageValueMatchSubs[1]);}else if(priceAndBenefitPageValueMatchSubs.length==1){window._trbo_current_basket.value=1;window._trbo_current_basket.product_ids.push(priceAndBenefitPageValueMatchSubs[0]);}
var __tmp_basket_segments=[];if(window._trbo_current_basket.product_ids.length>0){for(var basket_product_key=0;basket_product_key<window._trbo_current_basket.product_ids.length;basket_product_key++){var __tmp_basket_customer_segment=window._trbo_current_basket.product_ids[basket_product_key].split("-")[0];if(["bestandskunden","privatkunden","studenten","selbstaendige"].indexOf(__tmp_basket_customer_segment)>=0&&__tmp_basket_segments.indexOf(__tmp_basket_customer_segment)<0){__tmp_basket_segments.push(__tmp_basket_customer_segment);}}
if(__tmp_basket_segments.length>0){window._trbo_data_layer.basketCustomerTypes=__tmp_basket_segments.join("|");}}}catch(err){}}
if(document.location.href.indexOf("felix=test")>0){console.log("trbo-data-layer ::: tefDataLayer done");}
try{if(!window._trbo_data_layer.Bestandskunde||window._trbo_data_layer.Bestandskunde!=="ja"){if(!_trbo.udp.getUserSummary().externalData.Bestandskunde){window._trbo_data_layer.Bestandskunde="nein";}}}catch(err){}
if(window._trbo_data_layer.pageCategory==="n/a"){if(document.location.pathname.indexOf("/handy/")===0){window._trbo_data_layer.pageCategory="static";}else if(document.location.pathname=="/"||document.location.pathname==""){window._trbo_data_layer.pageCategory="home";}else if(document.location.pathname.indexOf("/shop-configurator/pdp")===0){window._trbo_data_layer.pageCategory="detail";}else{window._trbo_data_layer.pageCategory="other";}}
switch(window._trbo_data_layer.pageCategory){case"whitelabel-cart-dev":window._trbo_data_layer.pageType="basket";break;case"whitelabel-checkout-dev":window._trbo_data_layer.pageType="checkout";break;case"whitelabel-catalog-dev":window._trbo_data_layer.pageType="category";break;case"whitelabel-configurator-dev":case"detail":window._trbo_data_layer.detailInfos=window._parse_trbo_detail_dl();if(jTrbo("section.section .items .shop-tile h2.shop-tile-h2").length>=1){window._trbo_data_layer.productIdGeneric=jTrbo("section.section .items .shop-tile h2.shop-tile-h2").first().html().toLowerCase().replace(/ /g,"-").replace(/&nbsp;/g,"-");window._trbo_data_layer.detailProductGeneric=window._trbo_data_layer.productIdGeneric;}
try{if(window._trbo_data_layer.detailInfos&&window._trbo_data_layer.detailInfos.postpaid&&window._trbo_data_layer.detailInfos.postpaid.id){window._trbo_data_layer.customerType=window._trbo_data_layer.detailInfos.postpaid.id.split("-")[0];}
if(window._trbo_data_layer.customerType!=="privatkunden"){window._trbo_data_layer.customerTypeDetail=window._trbo_data_layer.customerType;_trboq.push(["dataMatching",{customerTypeDetail:window._trbo_data_layer.customerTypeDetail,},]);_trbo.udp.saveData();}}catch(err){}
window._trbo_data_layer.pageType="detail";break;case"whitelabel-order-dev":window._trbo_data_layer.pageType="confirmation";break;case"static":window._trbo_data_layer.pageType="static";break;case"other":window._trbo_data_layer.pageType="other";break;case"home":window._trbo_data_layer.pageType="home";break;}
try{if(document.location.search&&document.location.search.indexOf("ohne-tarif=ja")>=0){window._trbo_data_layer.dsLatestOffertype="HW-Only";window._trbo_data_layer.pageSubType=4;}else if(document.location.pathname.indexOf("/tarife/")===0||document.location.pathname.indexOf("/service/vertrag-tarif/")===0){window._trbo_data_layer.dsLatestOffertype="SIM-Only";window._trbo_data_layer.pageSubType=3;}else if(["/e-shop/"].indexOf(document.location.pathname)>=0){window._trbo_data_layer.dsLatestOffertype="Bundle";window._trbo_data_layer.pageSubType=2;}else if(window._trbo_data_layer.pageType==="detail"){window._trbo_data_layer.dsLatestOffertype="Bundle";window._trbo_data_layer.pageSubType=2;}}catch(err){}
try{if(window._trbo_data_layer.pageType==="confirmation"){var _trbo_submit_sale=false;var _trbo_sales_data={order_id:"trbo_"+Math.floor(Date.now()/ 10000),value:1,currency:"EUR",coupon_code:"",products:[],};for(var _xii=0;_xii<window.tefDataLayer.length;_xii++){if(window.tefDataLayer[_xii].checkout&&window.tefDataLayer[_xii].checkout.step_name&&window.tefDataLayer[_xii].checkout.step_name==="confirmationPage"){_trbo_submit_sale=true;}
if(window.tefDataLayer[_xii].order_submitted&&window.tefDataLayer[_xii].order_submitted.length>0){for(var _xxii=0;_xxii<window.tefDataLayer[_xii].order_submitted.length;_xxii++){if(window.tefDataLayer[_xii].order_submitted[_xxii].agreement_number&&window.tefDataLayer[_xii].order_submitted[_xxii].agreement_number!==""){_trbo_sales_data.order_id=window.tefDataLayer[_xii].order_submitted[_xxii].agreement_number;}}}
if(window.tefDataLayer[_xii].static&&window.tefDataLayer[_xii].static.length>0){var _bundle_offers={tarif:false,device:false};for(var _xxii=0;_xxii<window.tefDataLayer[_xii].static.length;_xxii++){if(window.tefDataLayer[_xii].static[_xxii].name){try{if(window.tefDataLayer[_xii].static[_xxii].type=="smartphone"){_bundle_offers.device=window.tefDataLayer[_xii].static[_xxii].name;}else if(window.tefDataLayer[_xii].static[_xxii].type=="postpaid"){_bundle_offers.tarif=window.tefDataLayer[_xii].static[_xxii].name;}}catch(err){}
_trbo_sales_data.products.push({product_id:window.tefDataLayer[_xii].static[_xxii].name,quantity:1,name:window.tefDataLayer[_xii].static[_xxii].name,price:1,});}
if(window.tefDataLayer[_xii].static[_xxii].monthly_cost&&parseFloat(window.tefDataLayer[_xii].static[_xxii].monthly_cost)>0){_trbo_sales_data.value+=parseFloat(window.tefDataLayer[_xii].static[_xxii].monthly_cost);}}
if(_bundle_offers.tarif&&_bundle_offers.device){_trbo_sales_data.products.push({product_id:_bundle_offers.tarif+"_"+_bundle_offers.device,quantity:1,name:_bundle_offers.tarif+"_"+_bundle_offers.device,price:1,});}}}
if(_trbo_submit_sale===true){_trboq.push(["sale",_trbo_sales_data]);}}else if(window._trbo_data_layer.pageType==="detail"&&window._trbo_data_layer.productId!=="n/a"){var _tracking_products=[];if(window._trbo_detail_products.indexOf(window._trbo_data_layer.productId)<0){_tracking_products.push({product_id:window._trbo_data_layer.productId,name:window._trbo_data_layer.productId,quantity:1,price:1,});window._trbo_detail_products.push(window._trbo_data_layer.productId);}
try{if(jTrbo('link[rel="canonical"]').length===1){var _tmp_detail_product="";var _tmp_canonical_path=jTrbo('link[rel="canonical"]').attr("href").replace(/\/$/,"").split("/");if(_tmp_canonical_path&&_tmp_canonical_path.length>3){_tmp_canonical_path=_tmp_canonical_path[_tmp_canonical_path.length-1].toLowerCase();_tmp_canonical_path=_tmp_canonical_path.replace(/-details$/,"");if(_tmp_canonical_path&&_tmp_canonical_path!==""){_tmp_detail_product=_tmp_canonical_path;}}
if(_tmp_detail_product!==""&&window._trbo_detail_products.indexOf(_tmp_detail_product)<0){_tracking_products.push({product_id:_tmp_detail_product,name:_tmp_detail_product,quantity:1,price:1,});window._trbo_detail_products.push(_tmp_detail_product);}}}catch(err){}
if(window._trbo_data_layer.tarifId&&window._trbo_data_layer.tarifId!=="n/a"&&window._trbo_data_layer.tarifId!==window._trbo_data_layer.productId){if(window._trbo_detail_products.indexOf(window._trbo_data_layer.tarifId)<0){_tracking_products.push({product_id:window._trbo_data_layer.tarifId,name:window._trbo_data_layer.tarifId,quantity:1,price:1,});window._trbo_detail_products.push(window._trbo_data_layer.tarifId);_tracking_products.push({product_id:window._trbo_data_layer.tarifId+"_"+window._trbo_data_layer.productId,name:window._trbo_data_layer.tarifId,quantity:1,price:1,});window._trbo_detail_products.push(window._trbo_data_layer.tarifId+"_"+window._trbo_data_layer.productId);}}
if(_tracking_products.length>0){_trboq.push(["productView",{products:_tracking_products}]);}}else if(document.location.pathname==="/e-shop/warenkorb"){try{var _tmp_funnel_products=[];if(window._trbo_current_basket&&window._trbo_current_basket.product_ids&&window._trbo_current_basket.product_ids.length>0){for(var _xii=0;_xii<window._trbo_current_basket.product_ids.length;_xii++){_tmp_funnel_products.push({product_id:window._trbo_current_basket.product_ids[_xii],name:window._trbo_current_basket.product_ids[_xii],price:1,quantity:1,});}}
_trboq.push(["funnel",{order_id:"10_"+Math.floor(Date.now()/ 100000),funnel_id:10,value:1,currency:"EUR",coupon_code:"",products:_tmp_funnel_products,},]);}catch(err){}}else if(document.location.pathname.indexOf("/e-shop/bestelldaten/")===0&&document.location.hash&&document.location.hash==="#/myData"){try{var _tmp_funnel_products=[];if(window._trbo_current_basket&&window._trbo_current_basket.product_ids&&window._trbo_current_basket.product_ids.length>0){for(var _xii=0;_xii<window._trbo_current_basket.product_ids.length;_xii++){_tmp_funnel_products.push({product_id:window._trbo_current_basket.product_ids[_xii],name:window._trbo_current_basket.product_ids[_xii],price:1,quantity:1,});}}
_trboq.push(["funnel",{order_id:"11_"+Math.floor(Date.now()/ 100000),funnel_id:11,value:1,currency:"EUR",coupon_code:"",products:_tmp_funnel_products,},]);}catch(err){}}else if(document.location.pathname.indexOf("/e-shop/bestelldaten/")===0&&document.location.hash&&document.location.hash==="#/paymentData"){try{var _tmp_funnel_products=[];if(window._trbo_current_basket&&window._trbo_current_basket.product_ids&&window._trbo_current_basket.product_ids.length>0){for(var _xii=0;_xii<window._trbo_current_basket.product_ids.length;_xii++){_tmp_funnel_products.push({product_id:window._trbo_current_basket.product_ids[_xii],name:window._trbo_current_basket.product_ids[_xii],price:1,quantity:1,});}}
_trboq.push(["funnel",{order_id:"12_"+Math.floor(Date.now()/ 100000),funnel_id:12,value:1,currency:"EUR",coupon_code:"",products:_tmp_funnel_products,},]);}catch(err){}}else if(document.location.pathname.indexOf("/e-shop/bestelldaten/")===0&&document.location.hash&&document.location.hash==="#/summary"){try{var _tmp_funnel_products=[];if(window._trbo_current_basket&&window._trbo_current_basket.product_ids&&window._trbo_current_basket.product_ids.length>0){for(var _xii=0;_xii<window._trbo_current_basket.product_ids.length;_xii++){_tmp_funnel_products.push({product_id:window._trbo_current_basket.product_ids[_xii],name:window._trbo_current_basket.product_ids[_xii],price:1,quantity:1,});}}
_trboq.push(["funnel",{order_id:"13_"+Math.floor(Date.now()/ 100000),funnel_id:13,value:1,currency:"EUR",coupon_code:"",products:_tmp_funnel_products,},]);if(jTrbo("a.btn-action").length===1){jTrbo("a.btn-action").on("click",function(){_trboq.push(["funnel",{order_id:"14_"+Math.floor(Date.now()/ 100000),funnel_id:14,value:1,currency:"EUR",coupon_code:"",products:_tmp_funnel_products,},]);jTrbo("a.btn-action").off("click");});}}catch(err){}}}catch(err){}
try{if(document.location.href.indexOf("/ecare")>=0){window._trbo_data_layer.customerType="bestandskunde";window._trbo_data_layer.Bestandskunde="ja";}}catch(e){}
return true;};window._trbo_parse_page_value=function(){var _page_value={};try{_page_value=JSON.parse(jTrbo("#pageValue").html());}catch(err){return false;}
try{if(!_page_value||!_page_value.configuration){return false;}
if(_page_value.configuration.customerSegmentType&&_page_value.configuration.customerSegmentType.name){window._trbo_data_layer.customerSegmentType=_page_value.configuration.customerSegmentType.name.toLowerCase();}
if(_page_value.configuration.hardware){if(_page_value.configuration.hardware.name){window._trbo_data_layer.hardwareName=_page_value.configuration.hardware.name.toLowerCase();}
if(_page_value.configuration.hardware.hardwareId){window._trbo_data_layer.hardwareId=_page_value.configuration.hardware.hardwareId;}}}catch(err){return false;}};window._trbo_parse_segment_data=function(){try{var _trbo_segment_data=_trbo.udp.getSegmentData();if(_trbo_segment_data&&_trbo_segment_data[2]){_trbo_segment_data=_trbo_segment_data[2];var _sortedSegmentData=Object.keys(_trbo_segment_data).sort(function(a,b){return _trbo_segment_data[b]-_trbo_segment_data[a];});if(_sortedSegmentData&&_sortedSegmentData.length>0){window._trbo_data_layer.dsStrongestBrand=_sortedSegmentData[0];}}
if(window._trbo_data_layer.brand&&window._trbo_data_layer.brand!=="n/a"&&window._trbo_data_layer.brand!=="pdp"){window._trbo_data_layer.dsLatestBrand=window._trbo_data_layer.brand;}}catch(err){}
try{if(!window._trbo_data_layer.dsStrongestBrand||window._trbo_data_layer.dsStrongestBrand=="n/a"||window._trbo_data_layer.dsStrongestBrand==""){if(navigator.userAgent&&(navigator.userAgent.toLowerCase().indexOf("iphone")>0||navigator.userAgent.toLowerCase().indexOf("macintosh")>0)){window._trbo_data_layer.dsStrongestBrand="apple";window._trbo_data_layer.dsLatestBrand="apple";}else if(navigator.userAgent.match(/SAMSUNG|SGH-[I|N|T]|GT-[I|P|N]|SM-[N|P|T|Z|G]|SHV-E|SCH-[I|J|R|S]|SPH-L/i)){window._trbo_data_layer.dsStrongestBrand="samsung";window._trbo_data_layer.dsLatestBrand="samsung";}}}catch(err){}
if(window._trbo_data_layer.dsLatestOffertype&&window._trbo_data_layer.dsLatestOffertype!=="n/a"){window._trbo_data_layer.dyn_segment["8"]=window._trbo_data_layer.dsLatestOffertype;}
try{var _trbo_segment_data=_trbo.udp.getSegmentData();if(_trbo_segment_data&&_trbo_segment_data[1]){_trbo_segment_data=_trbo_segment_data[1];var _sortedSegmentData=Object.keys(_trbo_segment_data).sort(function(a,b){return _trbo_segment_data[b]-_trbo_segment_data[a];});if(_sortedSegmentData&&_sortedSegmentData.length>0){window._trbo_data_layer.dsStrongestAffinity=_sortedSegmentData[0];}}
if(window._trbo_data_layer.categoryPath&&window._trbo_data_layer.categoryPath!=="n/a"&&window._trbo_data_layer.categoryPath!=="pdp"){window._trbo_data_layer.dsLatestAffinnity=window._trbo_data_layer.categoryPath;}}catch(err){}
try{var _trbo_all_segment_data=_trbo.udp.getSegmentData();if(_trbo_all_segment_data){if(_trbo_all_segment_data[3]){_trbo_segment_data=_trbo_all_segment_data[3];var _sortedSegmentData=Object.keys(_trbo_segment_data).sort(function(a,b){return _trbo_segment_data[b]-_trbo_segment_data[a];});if(_sortedSegmentData&&_sortedSegmentData.length>0){window._trbo_data_layer.dsStrongestGeneralDevice=_sortedSegmentData[0];}}
if(_trbo_all_segment_data[4]){_trbo_segment_data=_trbo_all_segment_data[4];var _sortedSegmentData=Object.keys(_trbo_segment_data).sort(function(a,b){return _trbo_segment_data[b]-_trbo_segment_data[a];});if(_sortedSegmentData&&_sortedSegmentData.length>0){window._trbo_data_layer.dsStrongestDevice=_sortedSegmentData[0];}}
if(_trbo_all_segment_data[5]){_trbo_segment_data=_trbo_all_segment_data[5];var _sortedSegmentData=Object.keys(_trbo_segment_data).sort(function(a,b){return _trbo_segment_data[b]-_trbo_segment_data[a];});if(_sortedSegmentData&&_sortedSegmentData.length>0){window._trbo_data_layer.dsStrongestGeneralTarif=_sortedSegmentData[0];}}
if(_trbo_all_segment_data[6]){_trbo_segment_data=_trbo_all_segment_data[6];var _sortedSegmentData=Object.keys(_trbo_segment_data).sort(function(a,b){return _trbo_segment_data[b]-_trbo_segment_data[a];});if(_sortedSegmentData&&_sortedSegmentData.length>0){window._trbo_data_layer.dsStrongestTarif=_sortedSegmentData[0];}}
if(_trbo_all_segment_data[7]){_trbo_segment_data=_trbo_all_segment_data[7];var _sortedSegmentData=Object.keys(_trbo_segment_data).sort(function(a,b){return _trbo_segment_data[b]-_trbo_segment_data[a];});if(_sortedSegmentData&&_sortedSegmentData.length>0){window._trbo_data_layer.dsStrongestClient=_sortedSegmentData[0];}}
if(_trbo_all_segment_data[8]){_trbo_segment_data=_trbo_all_segment_data[8];var _sortedSegmentData=Object.keys(_trbo_segment_data).sort);if(_sortedSegmentData&&_sortedSegmentData.length>0){window._trbo_data_layer.dsStongestOffertype=_sortedSegmentData[0];}}}
if(document.location.href.indexOf("privatkunden")>=0){window._trbo_data_layer.dyn_segment["7"]="NK";window._trbo_data_layer.dsLatestClient="NK";}else if(document.location.href.indexOf("fuer-kunden")>=0||document.location.href.indexOf("bestandskunden")>=0){window._trbo_data_layer.dyn_segment["7"]="BK";window._trbo_data_layer.dsLatestClient="BK";}else if(document.location.href.indexOf("junge-leute")>=0||document.location.href.indexOf("studenten")>=0){window._trbo_data_layer.dyn_segment["7"]="YP";window._trbo_data_layer.dsLatestClient="YP";}else if(document.location.href.indexOf("selbstaendige")>=0){window._trbo_data_layer.dyn_segment["7"]="SOHO";window._trbo_data_layer.dsLatestClient="SOHO";}
if(window._trbo_data_layer&&window._trbo_data_layer.productId&&window._trbo_data_layer.productId!="n/a"){var _tmp_product_id_parts=window._trbo_data_layer.productId.split("-");if(_tmp_product_id_parts.length>=3&&_tmp_product_id_parts[1]!="o2"){window._trbo_data_layer.dsLatestGeneralDevice=_tmp_product_id_parts[1]+"-"+_tmp_product_id_parts[2];window._trbo_data_layer.dyn_segment["3"]=window._trbo_data_layer.dsLatestGeneralDevice;if(jTrbo("section.section .items .shop-tile h2.shop-tile-h2").length>=1){window._trbo_data_layer.dsLatestDevice=jTrbo("section.section .items .shop-tile h2.shop-tile-h2").first().html().toLowerCase().replace(/"/g,"").replace(/\(/,"").replace(/\)/,"").replace(/&nbsp;/g," ").replace(/ /g,"-");window._trbo_data_layer.dyn_segment["4"]=window._trbo_data_layer.dsLatestDevice;}}}
var _tmp_tarif_name="";var _tmp_tarif_main_type="";if(window._trbo_data_layer&&window._trbo_data_layer.tarifId&&window._trbo_data_layer.tarifId!=="n/a"){var _o2_mobile_match=window._trbo_data_layer.tarifId.match(/^[a-z]+-(o2|myprepaid)-(free-[a-z]+)-(online|boost?).*$/);var _o2_dsl_match=window._trbo_data_layer.tarifId.match(/^[a-z]+-(o2-my-home-[a-z]+).*$/);if(_o2_mobile_match&&_o2_mobile_match.length===4){if(_o2_mobile_match[1]==="myprepaid"){_tmp_tarif_main_type="prepaid";}else{_tmp_tarif_main_type="postpaid";}
_tmp_tarif_name=_o2_mobile_match[1]+"-"+_o2_mobile_match[2]+"-"+_o2_mobile_match[3];}else if(_o2_dsl_match&&_o2_dsl_match.length===2){_tmp_tarif_main_type="dsl";_tmp_tarif_name=_o2_dsl_match[1];}
if(_tmp_tarif_main_type!==""&&_tmp_tarif_name!==""){window._trbo_data_layer.dyn_segment["5"]=_tmp_tarif_main_type;window._trbo_data_layer.dyn_segment["6"]=_tmp_tarif_name;window._trbo_data_layer.dsLatestGeneralTarif=_tmp_tarif_main_type;window._trbo_data_layer.dsLatestTarif=_tmp_tarif_name;}}
if(_tmp_tarif_main_type===""){var _prepaid_url_parts=["/tarife/prepaid-tarife/","/bezahlen-per-handyrechnung/","/guthaben-aufladen","/sim-karte/sim-karte-aktivieren/","vertrag-tarif/tarifarchiv/o2-o-prepaid/","vertrag-tarif/tarifarchiv/s-m-l-mit/","vertrag-tarif/tarifarchiv/s-m-l-ohne/","vertrag-tarif/tarifarchiv/o2-loop/","vertrag-tarif/tarifarchiv/loop-alltime/","vertrag-tarif/tarifarchiv/loop-alltime-card/","vertrag-tarif/tarifarchiv/loop-classic/","vertrag-tarif/tarifarchiv/loop-classic-card/","vertrag-tarif/tarifarchiv/o2-go-prepaid/","vertrag-tarif/tarifarchiv/prepaid-optionen/",];for(var _xii=0;_xii<_prepaid_url_parts.length;_xii++){if(document.location.pathname.indexOf(_prepaid_url_parts[_xii])>=0){_tmp_tarif_main_type="prepaid";window._trbo_data_layer.dyn_segment["5"]=_tmp_tarif_main_type;window._trbo_data_layer.dsLatestGeneralTarif=_tmp_tarif_main_type;}}}
window.setTimeout(function(){_trbo_obj.pushToTefDatalayer();},500);}catch(err){}};if(document.location.pathname=="/"&&window._trbo_parse_data_layer()===true){if(document.location.href.indexOf("felix=test")>0){console.log("try trbo api ::: exec");}
window._trbo_parse_segment_data();try{_trbo.udp.getPage().type=window._trbo_data_layer.pageType;}catch(err){}
_trboq.push(["page",{type:window._trbo_data_layer.pageType,subtype:window._trbo_data_layer.pageSubType}]);_trboq.push(["dataMatching",window._trbo_data_layer]);_trboq.push(["currentBasket",window._trbo_current_basket]);setTimeout(function(){if(document.location.hostname.indexOf("blau.de")<0){_trbo_obj.reloadApi(true,true);}},3);}else{window._trbo_check4_data_layer_runs=0;window._trbo_api_called=false;window._trbo_check4_data_layer=setInterval(function(){if(document.location.href.indexOf("felix=test")>0){console.log("try trbo api ::: runs = "+window._trbo_check4_data_layer_runs);}
if(window._trbo_parse_data_layer()===true){if(document.location.href.indexOf("felix=test")>0){console.log("tefDataLayer found ::: exec ::: "+(Date.now()/ 1000-window._trbo_plugin_start));}
window._trbo_parse_segment_data();_trboq.push(["page",{type:window._trbo_data_layer.pageType,subtype:window._trbo_data_layer.pageSubType}]);_trboq.push(["dataMatching",window._trbo_data_layer]);_trboq.push(["currentBasket",window._trbo_current_basket]);if(document.location.hostname.indexOf("blau.de")<0){setTimeout(function(){if(document.location.hostname.indexOf("crt.o2online.de")>-1){_trbo_obj.reloadApi(false,true);}else{_trbo_obj.reloadApi(true,true);}},5);window._trbo_api_called=true;}
if(document.location.href.indexOf("felix=test")>0){console.log("tefDataLayer2 ::: length = "+tefDataLayer.length);console.log(tefDataLayer);}
clearInterval(window._trbo_check4_data_layer);setTimeout(function(){window._trbo_parse_data_layer();_trboq.push(["dataMatching",window._trbo_data_layer]);},100);}
window._trbo_check4_data_layer_runs++;if(window._trbo_check4_data_layer_runs>200){clearInterval(window._trbo_check4_data_layer);if(!window._trbo_api_called||window._trbo_api_called===false){window._trbo_check4_data_layer=setInterval(function(){if(jTrbo("body").length>=1){window._trbo_parse_data_layer();window._trbo_parse_segment_data();_trboq.push(["page",{type:window._trbo_data_layer.pageType,subtype:window._trbo_data_layer.pageSubType}]);_trboq.push(["dataMatching",window._trbo_data_layer]);_trboq.push(["currentBasket",window._trbo_current_basket]);if(document.location.hostname.indexOf("blau.de")<0){_trbo_obj.reloadApi(true,true);window._trbo_api_called=true;}
if(document.location.href.indexOf("felix=test")>0){console.log("trbo - exceeded ::: 500 ::: 2");}
clearInterval(window._trbo_check4_data_layer);}},100);}}},10);}
if(document.location.pathname.indexOf("/e-shop/bestelldaten/")===0){try{window.addEventListener("hashchange",function(){window._trbo_parse_data_layer();window._trbo_parse_segment_data();_trboq.push(["page",{type:window._trbo_data_layer.pageType,subtype:window._trbo_data_layer.pageSubType}]);_trboq.push(["dataMatching",window._trbo_data_layer]);_trboq.push(["currentBasket",window._trbo_current_basket]);},false);}catch(err){}}
if(document.location.pathname.indexOf("/ecare")===0){window._trbo.app.beforeReloadApi=function(){try{window._trbo_parse_data_layer();window._trbo_parse_segment_data();_trboq.push(["page",{type:window._trbo_data_layer.pageType,subtype:window._trbo_data_layer.pageSubType}]);_trboq.push(["dataMatching",window._trbo_data_layer]);_trboq.push(["currentBasket",window._trbo_current_basket]);}catch(err){}};}
_trbo_obj.pushToTefDatalayer=function(){var tefDataLayer=window.tefDataLayer||[],getFromTrbodataLayer=function(key){if(window._trbo.udp.getUserSummary().externalData.hasOwnProperty(key)){return _trbo.udp.getUserSummary().externalData[key];}else{return"n/a";}};tefDataLayer.push({event:"trboInit",trboData:{strongestAffinityManufacturer:getFromTrbodataLayer("dsStrongestBrand"),latestAffinityManufacturer:getFromTrbodataLayer("dsLatestBrand"),strongestAffinityClientType:getFromTrbodataLayer("dsStrongestClient"),latestAffinityClientType:getFromTrbodataLayer("dsLatestClient"),strongestAffinityGeneralTariff:getFromTrbodataLayer("dsStrongestGeneralTarif"),latestAffinityGeneralTariff:getFromTrbodataLayer("dsLatestGeneralTarif"),strongestAffinityOfferType:getFromTrbodataLayer("dsStongestOffertype"),latestAffinityOfferType:getFromTrbodataLayer("dsLatestOffertype"),},});};_trbo_obj.replace_adspace_tags;_trbo_obj.replace_adspace_tags();document.addEventListener("DOMContentLoaded");_trbo_obj.replace_adspace_fallback=function(){if(document.location.href.indexOf("trppids")>=0){return;}
var cleanUpWhenNoChildrens=function($itemcollection){var hasTrueChildren=false;$itemcollection.children().each(function(){if(jTrbo(this).attr("class")!=="headline"){hasTrueChildren=true;}});if(!hasTrueChildren){var $inner=$itemcollection.parent();$itemcollection.remove();if($inner.children().length===0){var $section=$inner.parent();$inner.remove();if($section.children().length===0){$section.remove();}}}};jTrbo('[data-js="adspace-replaced-trbo"]').each(function(){if(jTrbo(this).parent().hasClass('contact-items')){}
else{var $fallbackContent=jTrbo(this).children().not("div.loader");if($fallbackContent.length>0){jTrbo(this).replaceWith($fallbackContent);}
var isAdspaceHide=jTrbo(this).hasClass("hide");if(isAdspaceHide){var $parent=jTrbo(this).parent();jTrbo(this).remove();var childrenLength=$parent.children().length;if(childrenLength===0){var $itemCollection=$parent.parent();$parent.remove();cleanUpWhenNoChildrens($itemCollection);}}}});};if(jTrbo.isReady===true){window.setTimeout,2000);}else{document.addEventListener("DOMContentLoaded",function(event){window.setTimeout(function(){if(window._trbo_obj&&window._trbo_obj.apiStatus&&window._trbo_obj.apiStatus==="pending"){if(document.location.href.indexOf("felix=test")>0){console.log("trbo ::: adspace NOT replace DOMContentLoaded ::: "+document.readyState);}else{_trbo_obj.replace_adspace_fallback();}}else{_trbo_obj.replace_adspace_fallback();}},2500);});window.setTimeout(function(){if(window._trbo_obj&&window._trbo_obj.apiStatus&&(window._trbo_obj.apiStatus==="pending"||window._trbo_obj.apiStatus==="returned")){if(document.location.href.indexOf("felix=test")>0){console.log("trbo ::: adspace NOT replace --> pending API ::: "+document.readyState);}else{_trbo_obj.replace_adspace_fallback();}}else{_trbo_obj.replace_adspace_fallback();}},6000);}
_trbo_obj.apiReturned=function(){window.setTimeout,1313);window._trbo_parse_data_layer();_trboq.push(["dataMatching",window._trbo_data_layer]);};try{jTrbo("head").append('<style type="text/css">.trbo_tr_img {position:absolute; left:0; bottom:0;}</style>');}catch(err){}
(function(){try{var validTES345Paths=["/tarife/smartphone-tarife/","/tarife/","/vorteile/fuer-kunden/tarife/smartphone-tarife/","/vorteile/fuer-kunden/tarife/","/tarife/smartphone-tarife","/tarife","/vorteile/fuer-kunden/tarife/smartphone-tarife","/vorteile/fuer-kunden/tarife","tarife/smartphone-tarife","tarife","vorteile/fuer-kunden/tarife/smartphone-tarife","vorteile/fuer-kunden/tarife"],currentPath=document.location.pathname,isValid="no";jTrbo.each(validTES345Paths,function(pathIndex,tesPath){if(currentPath===tesPath){isValid="yes";}});window._trboq.push(["dataMatching",{TES345:isValid}]);}catch(e){console.log(e);}})();(function(){try{var adspace_254578="no";if(jTrbo("#254578").length>0){adspace_254578="yes";}
window._trboq.push(["dataMatching",{adspace_254578:adspace_254578}]);}catch(e){console.log(e);}})();(function(){var testValid=document.location.href.indexOf("trbo_deprecated_tabs")>-1;if(testValid){var tryCount=0,maxTries=10;function replaceTabHeadlines(){var indicesArray=[];jTrbo(".slick-slide [trbo-module]").not(".trbo-headline-moved").each(function(){var parent=jTrbo(this).parent();if(!parent.hasClass("slick-cloned")&&parent.hasClass("slick-slide")){var dataSlickIndex=parent.attr("data-slick-index");var headline=jTrbo(this).find(".headline.h2").clone().children().remove().end().text();indicesArray.push([dataSlickIndex,headline]);jTrbo(this).addClass("trbo-headline-moved");}});var adspacesToReplace=jTrbo(".adspace-trbo-tabs").children();for(var i=0;i<indicesArray.length;i++){if(i<adspacesToReplace.length)jTrbo(adspacesToReplace[indicesArray[i][0]]).text(indicesArray[i][1]);}}
var retryInterval=window.setInterval(function(){replaceTabHeadlines();tryCount++;if(tryCount>maxTries){window.clearInterval(retryInterval);}},500);}})();(function(){var tryCount=0,maxTries=10,tabSelector="div#top section ul.stage-tabs";function replaceTabHeadlines(){var indicesArray=[];jTrbo(".item-collection-unobtrusive > div.headline  > h3").not(".trbo-headline-moved").each(function(){var parent=jTrbo(this).parents(".slick-slide").first();if(jTrbo(this).parents(".slick-cloned").length===0){var dataSlickIndex=parent.attr("data-slick-index");var headline=jTrbo(this).html();indicesArray.push([dataSlickIndex,headline]);jTrbo(this).addClass("trbo-headline-moved");}});var adspacesToReplace=jTrbo(tabSelector).children("li.stage-tab");for(var i=0;i<indicesArray.length;i++){if(i<adspacesToReplace.length)jTrbo(adspacesToReplace[indicesArray[i][0]]).html(indicesArray[i][1]);}}
var retryInterval=window.setInterval(function(){replaceTabHeadlines();tryCount++;if(tryCount>maxTries){window.clearInterval(retryInterval);}},500);})();var _trboKitt={deviceData:{os:false,device:false,},processAssetUrl:function(assetUrl,options){try{if(!_trboKitt.deviceData.os&&!_trboKitt.deviceData.device){jTrbo.ajax({method:"GET",async:false,url:"https://www.o2online.de/device-service/device/request",success:function(data,text,request){_trboKitt.deviceData.os=encodeURIComponent(request.getResponseHeader("x-o2-device-os"));_trboKitt.deviceData.device=encodeURIComponent(request.getResponseHeader("x-o2-device-type"));},});}
return assetUrl+"?channel="+_trboKitt.deviceData.device+"&channel="+_trboKitt.deviceData.os;}catch(e){return assetUrl;}},};_trbo.app.kittScrollSpy=function(){var elementConfigs=[],pushedData=[],add,isSliderTeaser=function(element){try{return!!element.parent().hasClass("slide");}catch(e){return false;}},isElementVisible=function(element){try{var boundRect=element.get(0).getBoundingClientRect(),elementTop=boundRect.top,elementButtom=boundRect.bottom,elementHeight=boundRect.height,containerTop=0,containerHeight=window.innerHeight,offset=elementHeight*0.25;return elementTop-containerTop+offset<containerHeight&&elementButtom>=0;}catch(e){return false;}},parseAssetName=function(assetUrl){try{var parts=assetUrl.split("/"),lastPart=parts[parts.length-1],blacklistedWords=["teaser","consumer","stage","hero","bk","nk","soho","tab","collection"],nameParts=lastPart.split("-"),result=[];jTrbo.each(nameParts,function(index,part){if(blacklistedWords.indexOf(part)===-1){result.push(part);}});return result.join("-");}catch(e){return assetUrl;}},watchSlider=function(elementConfig){try{var watcherId=window.setInterval(function(){if(!elementConfig.done){var currentSlide="";if(elementConfig.element.parent().attr("slot")){currentSlide=elementConfig.element.parent().attr("slot").replace("slot-","");}
if(isElementVisible(elementConfig.element)&&elementConfig.element.parent().hasClass("slide")&&jTrbo(elementConfig.element.closest("tef-carousel")[0].shadowRoot.querySelectorAll("li.slide:not(.glide__slide--clone)[data-index='"+currentSlide+"']")).hasClass("glide__slide--active")){elementConfig.done=true;fireViewTracking(elementConfig);window.clearInterval(watcherId);}else{}}},1000);}catch(e){}},scrollHandler=function(){jTrbo.each(elementConfigs,function(elementIndex,elementConfig){if(isSliderTeaser(elementConfig.element)&&!elementConfig.isSlider){elementConfig.isSlider=true;watchSlider(elementConfig);}
if(!elementConfig.done&&!elementConfig.isSlider){if(isElementVisible(elementConfig.element)){elementConfig.done=true;fireViewTracking(elementConfig);}}});},getPromotionData=function(elementConfig){return{id:"trbo_KITT_"+elementConfig.tracking.campaignId+":"+elementConfig.tracking.moduleId,name:parseAssetName(elementConfig.creative.asset),creative:elementConfig.creative.segmentGroupName+":"+elementConfig.creative.segmentTagName+":"+elementConfig.creative.segmentName,position:elementConfig.creative.placementGroupName+":"+elementConfig.creative.placementName,};},fireTracking=function(_type,pushData,elementConfig){pushedData.push(pushData);if(window.tefDataLayer){tefDataLayer.push(pushData);var _eventDispatcherData={type:_type,moduleId:elementConfig.tracking.moduleId,campaignId:elementConfig.tracking.campaignId,};_trbo.app.eventDispatcher.dispatch(_eventDispatcherData);}},viewTimeout=false,viewPromotions=[],fireViewTracking=function(elementConfig){viewPromotions.push(getPromotionData(elementConfig));var _eventDispatcherData={type:"layerView",moduleId:elementConfig.tracking.moduleId,campaignId:elementConfig.tracking.campaignId,};_trbo.app.eventDispatcher.dispatch(_eventDispatcherData);if(!viewTimeout){viewTimeout=true;window.setTimeout(function(){if(window.tefDataLayer){tefDataLayer.push({event:"promoView_Kitt_trbo",ecommerce:{promoView:{promotions:viewPromotions,},},});}
viewPromotions=[];viewTimeout=false;},250);}},fireClickTracking=function(elementConfig){var pushData={event:"promoClick_Kitt_trbo",ecommerce:{promoClick:{promotions:[getPromotionData(elementConfig)],},},};fireTracking("layerClick",pushData,elementConfig);},fireAdlayerClickTracking=function(elementConfig){var pushData={event:"promoClick_Kitt_AdLayer_trbo",ecommerce:{promoClick:{promotions:[{id:"trbo_KITT_AdLayer_"+elementConfig.tracking.campaignId+":"+elementConfig.tracking.moduleId,name:parseAssetName(elementConfig.creative.asset),creative:elementConfig.creative.segmentGroupName+":"+elementConfig.creative.segmentTagName+":"+elementConfig.creative.segmentName,position:elementConfig.creative.placementGroupName+":"+elementConfig.creative.placementName,},],},},};tefDataLayer.push(pushData);},fireAdlayerImpressionTracking=function(elementConfig){var pushData={event:"promoView_Kitt_AdLayer_trbo",ecommerce:{promoView:{promotions:[{id:"trbo_KITT_AdLayer_"+elementConfig.tracking.campaignId+":"+elementConfig.tracking.moduleId,name:parseAssetName(elementConfig.creative.asset),creative:elementConfig.creative.segmentGroupName+":"+elementConfig.creative.segmentTagName+":"+elementConfig.creative.segmentName,position:elementConfig.creative.placementGroupName+":"+elementConfig.creative.placementName,},],},},};tefDataLayer.push(pushData);};this.add=add;this.fireClickTracking=fireClickTracking;this.fireAdlayerClickTracking=fireAdlayerClickTracking;this.fireAdlayerImpressionTracking=fireAdlayerImpressionTracking;this.getConfigs=function(){return elementConfigs;};this.getPushedData=function(){return pushedData;};jTrbo(window).scroll(scrollHandler);};var _trboKittScrollSpy=new _trbo.app.kittScrollSpy();jTrbo(document).on("kittTeaser:inserted",function(event,teaserData){_trboKittScrollSpy.add(teaserData);});jTrbo(document).on("kittTeaser:clicked",function(event,teaserData){_trboKittScrollSpy.fireClickTracking(teaserData);});jTrbo(document).on("adlayer:clicked",function(event,teaserData){_trboKittScrollSpy.fireAdlayerClickTracking(teaserData);});jTrbo(document).on("adlayer:inserted",function(event,teaserData){_trboKittScrollSpy.fireAdlayerImpressionTracking(teaserData);});try{if(sessionStorage.vvlLoadingList==="yes"){jTrbo(document).on("click",".trbo-addBtn-183417, li>a[href='https://www.o2online.de/econtract']");if(location.href.indexOf("/econtract/auswahlseite")>-1){jTrbo("#content").hide();jTrbo(".loading-spinner").hide();}
if(location.href.indexOf("/ecareng/tariff-and-simcard/")>-1){jTrbo("#content").hide();jTrbo(".loading-spinner").hide();}}}catch(err){}
try{if(sessionStorage.showTrboVVLFlow==="yes"){if(location.href.indexOf("o2online.de/econtract/auswahlseite")>-1){jTrbo(".process-bar.app-vvl").hide();}
if(location.href.indexOf("o2online.de/econtract/start")>-1){jTrbo(".process-bar.app-vvl").hide();}
if(location.href.indexOf("o2online.de/econtract/hardwarechoice")>-1){jTrbo(".process-bar.app-vvl").hide();}
if(location.href.indexOf("o2online.de/econtract/tariffchoice")>-1){jTrbo(".process-bar.app-vvl").hide();}
if(location.href.indexOf("o2online.de/econtract/bundle")>-1){jTrbo(".process-bar.app-vvl").hide();}
if(location.href.indexOf("o2online.de/econtract/tarif")>-1){jTrbo(".process-bar.app-vvl").hide();}
if(location.href.indexOf("o2online.de/econtract/data")>-1){jTrbo(".process-bar.app-vvl").hide();}
if(location.href.indexOf("o2online.de/econtract/checkout")>-1){jTrbo(".process-bar.app-vvl").hide();}
if(location.href.indexOf("o2online.de/econtract/bestellung")>-1){jTrbo(".process-bar.app-vvl").hide();}}}catch(err){}
try{if(location.href.indexOf("o2online.de/econtract/start")>-1&&location.href.indexOf("e2e2.o2online.de")===-1){if(jTrbo('div[slot="nav-title"]').text().trim()==='Vertragsverlängerung'){jTrbo("body").append('<style id="trbo-hideContent506">.tile-slider .slick-slider {display: none !important;}</style>');setTimeout(function(){jTrbo("#trbo-hideContent506").remove();window.dispatchEvent(new Event("resize"));},9900);}}}catch(err){}
try{if(window.location.href.indexOf("?tes-508-redirect=ja")>-1){window.location="https://prev.o2online.de/test/simon-a/home-b/";}}catch(error){}
try{if(window.location.href.indexOf("o2online.de/e-shop/warenkorb")>-1&&sessionStorage.hideContentWK==='true'){console.log('hide content by plugin');jTrbo("body").append('<style id="trbo-hideContentWK">#content {display: none !important;}</style>');setTimeou},9900);}}catch(error){}}catch(e){}
try{if(window.location.href.indexOf('trbotest')>-1){try{if(location.href.indexOf("www.o2online.de")>-1&&location.href.indexOf("o2online.de/tarife/junge-leute")>-1){var _uc_consent_data=JSON.parse(window.localStorage.getItem("usercentrics"));var _ucSettings_v2=JSON.parse(window.localStorage.getItem("uc_settings"));var _uc_tr_marketing_enabled=false;if(_uc_consent_data&&_uc_consent_data.consents&&_uc_consent_data.consents.length>0){for(var i=0;i<_uc_consent_data.consents.length;i++){if(_uc_consent_data.consents[i].templateId&&["__GnLvNxT","0mz99RC3x"].indexOf(_uc_consent_data.consents[i].templateId)>=0&&_uc_consent_data.consents[i].consentStatus===true){_uc_tr_marketing_enabled=true;}else if(_uc_consent_data.consents[i].dataProcessors&&_uc_consent_data.consents[i].dataProcessors.length>0&&_uc_consent_data.consents[i].dataProcessors.indexOf("trbo (Personalisierung)")>=0&&_uc_consent_data.consents[i].consentStatus===true){_uc_tr_marketing_enabled=true;}}}
if(_ucSettings_v2&&_ucSettings_v2.services){var trboConsentId="__dump_value";try{var filter=UC_UI.getServicesBaseInfo().filter(function(x){return x.name.toLowerCase().indexOf("trbo")>-1&&x.categorySlug=="marketing";});trboConsentId=filter[0].id;}catch(e){}
var ucConsentIds=["8_kLUmr9g","__GnLvNxT","0mz99RC3x"];if(trboConsentId!=="__dump_value"&&ucConsentIds.indexOf(trboConsentId)===-1){ucConsentIds.push(trboConsentId);}
jTrbo.each(_ucSettings_v2.services,function(ucServiceIndex,ucService){if(ucConsentIds.indexOf(ucService.id)>=0&&ucService.status===true){_uc_tr_marketing_enabled=true;}});}
if(_uc_tr_marketing_enabled!==true){window._trbo.pluginConfig.tracking_disabled=true;window._trbo.app.opts.config.skipCookies=true;window._trbo.app.opts.config.skipLocalStorage=true;window._trbo_data_layer.mkt_cnst="n";}else{window._trbo.pluginConfig.tracking_disabled=false;window._trbo.app.opts.config.skipCookies=false;window._trbo.app.opts.config.skipLocalStorage=false;window._trbo_data_layer.mkt_cnst="y";}
if((localStorage.getItem("uc_user_interaction")==="true"&&window._trbo_data_layer.mkt_cnst==="y")||(localStorage.getItem("uc_user_interaction")!=="true"&&window._trbo_data_layer.mkt_cnst==="n")){console.log("TES-530");jTrbo("head").append('<style id="trbo-hideContent530">article.primaryHeadline {opacity: 0 !important;}</style>');setTimeou},10000);}
delete window._trbo_data_layer.mkt_cnst;}}catch(err){}
try{console.log(_trbo.udp.getDatalayerData(),_trbo.udp.getDatalayerData().tesWKRedesign);if(!_trbo.udp.getDatalayerData().tesWKRedesign){var AorB=Math.floor(Math.random()*2);if(AorB===0){AorB='A';}
else{AorB='B';}
_trboq.push(["dataMatching",{tesWKRedesign:AorB}]);_trbo.udp.saveData();}}catch(error){}}}catch(e){}
try{if(!window._trbo.templates){window._trbo.templates={};}window._trbo.templates.getConsentStatus=function(){console.log("implement me");};}catch(e){}
_trbo.udp.datalayerHelper.run();_trbo.udp.productListing.run();