"use strict";(globalThis.webpackChunk_zendesk_web_widget_classic=globalThis.webpackChunk_zendesk_web_widget_classic||[]).push([[7983],{96837:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Xl});var n=i(98049),s=i.n(n),o=i(15826),a=i(96351),r=i(41613),l=i(9775),d=i(31040),c=i(685),h=i(55786);class m extends o.Component{static propTypes={className:s().string,circleClasses:s().string,height:s().number,width:s().number,viewBox:s().string};static defaultProps={className:"",circleClasses:"",height:100,width:100,viewBox:"0 0 180 180"};render=()=>{const{className:e,circleClasses:t,width:i,height:n,viewBox:s}=this.props,o=`u-userStrokeColor ${c.locals.circle} ${t}`;return(0,h.jsx)("svg",{className:`${c.locals.spinner} ${e}`,width:i,height:n,viewBox:s,"data-testid":d.z7.LOADING_SPINNER,children:(0,h.jsx)("circle",{className:o,cx:"90",cy:"90",r:"70"})})}}var p=i(35870),u=i(42e3),g=i(78009),f=i(55217),b=i(86381),y=i.n(b),C=i(81447),x=i.n(C),w=i(56599),v=i(25701),_=i(83623),j=i(73963);const S=e=>{let{values:t,isDepartmentFieldVisible:i}=e;return async(e,n)=>{const s={...t},o=(0,w.iI)(n(),s.department);if((0,v.j3)(n())){const e=(0,v.X8)(n());Object.assign(s,{name:e.display_name,email:e.email})}if(o&&"offline"===o.status)return await new Promise(((t,i)=>{e((0,_.pI)(s,(()=>{e((0,_.a9)(j.fb)),t()}),(()=>{e((0,_.a9)(j.KF)),i()})))}));if((s.display_name||s.name||s.email||s.phone)&&(await e((0,_.vK)({visitor:x()({display_name:s.display_name||s.name,email:s.email,phone:s.phone},y()),identifier:"prechat form"})),(0,v.kE)(n())))throw new Error("failed to submit details");i&&(o?await new Promise((t=>{e((0,_.fH)(o.id,t,t))})):await new Promise((t=>{e((0,_.M$)(t))}))),s.message&&e((0,_.g_)(s.message)),e((0,_.HS)(s))}};var k=i(15240),T=i(57025),P=i(2432),I=i(83070),E=i(17255);const N=E.ZP.div.withConfig({displayName:"styles__UserProfileDetailsContainer",componentId:"sc-rn00aj-0"})(["display:inline-block;max-width:",";padding-left:","rem;",""],(e=>`calc(100% - ${(e.isSociallyAuthenticated?70:20)/e.theme.fontSize}rem)`),(e=>12/e.theme.fontSize),(e=>e.theme.rtl&&`\n    padding-left: 0;\n    padding-right: ${12/e.theme.fontSize}rem;\n  `)),R=E.ZP.div.withConfig({displayName:"styles__DisplayName",componentId:"sc-rn00aj-1"})(["font-weight:bold;"]),A=e=>{let{isSociallyAuthenticated:t,displayName:i,email:n}=e;return(0,h.jsxs)(N,{isSociallyAuthenticated:t,children:[(0,h.jsx)(R,{children:i}),(0,h.jsx)("div",{children:n})]})};A.propTypes={isSociallyAuthenticated:s().bool.isRequired,displayName:s().string,email:s().string};const L=A;var M=i(96520),z=i(66988),Z=i(87914);const O=E.ZP.div.withConfig({displayName:"styles__AuthenticatedProfileContainer",componentId:"sc-xwfbkc-0"})(["position:relative;word-break:break-all;color:",";background-color:",";border:","rem solid ",";border-radius:","rem;margin-bottom:","rem;margin-top:","rem;min-height:","rem;padding-top:","rem;padding-bottom:","rem;padding-left:","rem;line-height:","rem;",""],(e=>e.theme.palette.grey[800]),(e=>e.theme.palette.grey[100]),(e=>1/e.theme.fontSize),(e=>e.theme.palette.grey[300]),(e=>4/e.theme.fontSize),(e=>15/e.theme.fontSize),(e=>8/e.theme.fontSize),(e=>35/e.theme.fontSize),(e=>8/e.theme.fontSize),(e=>8/e.theme.fontSize),(e=>15/e.theme.fontSize),(e=>18/e.theme.fontSize),(e=>e.theme.rtl&&`padding-left: 0;\n      padding-right: ${15/e.theme.fontSize}rem;`)),q=(0,E.ZP)(z.default).withConfig({displayName:"styles__LogoutIcon",componentId:"sc-xwfbkc-1"})(["cursor:pointer;position:absolute;top:","rem;color:",";"," "," path{fill:",";}&:hover,&:focus,&:active{path{fill:",";}}"],(e=>18/e.theme.fontSize),(e=>e.theme.palette.grey[500]),(e=>!1===e.theme.rtl&&`\n    right: ${16/e.theme.fontSize}rem;\n    `),(e=>e.theme.rtl&&`\n    left: ${16/e.theme.fontSize}rem;\n    `),(e=>e.theme.palette.grey[500]),(e=>e.theme.palette.grey[600])),D=(0,E.ZP)(m).withConfig({displayName:"styles__LoadingSpinnerIcon",componentId:"sc-xwfbkc-2"})(["position:absolute;top:","rem;color:",";height:","rem;width:","rem;"," ",""],(e=>10/e.theme.fontSize),(e=>e.theme.palette.grey[500]),(e=>15/e.theme.fontSize),(e=>15/e.theme.fontSize),(e=>!1===e.theme.rtl&&`\n    right: ${16/e.theme.fontSize}rem;\n    `),(e=>e.theme.rtl&&`\n    left: ${16/e.theme.fontSize}rem;\n    `)),B=(0,E.ZP)(Z.q).withConfig({displayName:"styles__SocialAvatar",componentId:"sc-xwfbkc-3"})(["&&&{display:inline-block !important;vertical-align:top;height:","rem;width:","rem;margin-top:","rem;svg{min-height:","rem;min-width:","rem;max-height:","rem;max-width:","rem;}}"],(e=>30/e.theme.fontSize),(e=>30/e.theme.fontSize),(e=>2/e.theme.fontSize),(e=>30/e.theme.fontSize),(e=>30/e.theme.fontSize),(e=>30/e.theme.fontSize),(e=>30/e.theme.fontSize)),H=e=>{let{socialLogin:t,visitor:i,initiateSocialLogout:n}=e;const s=(0,M.Z)(),o=t.screen===I.W7.LOGOUT_PENDING?(0,h.jsx)(D,{}):(0,h.jsx)(q,{onClick:n,"data-testid":d.z7.ICON_LOGOUT});return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("p",{children:s("embeddable_framework.chat.form.common.field.social_login.title")}),(0,h.jsxs)(O,{children:[t.authenticated&&(0,h.jsx)(B,{src:t.avatarPath,fallbackIcon:d.UZ.AGENT_AVATAR}),(0,h.jsx)(L,{isSociallyAuthenticated:t.authenticated,displayName:i.display_name,email:i.email}),t.authenticated&&o]})]})};H.propTypes={socialLogin:s().shape({avatarPath:s().string,authenticated:s().bool,screen:s().oneOf([...Object.values(I.W7),""])}),visitor:s().shape({display_name:s().string,email:s().string}),initiateSocialLogout:s().func.isRequired};const F=H;var K=i(20228);const U=E.ZP.div.withConfig({displayName:"styles__Container",componentId:"sc-so35us-0"})(["color:",";margin-bottom:","rem;white-space:pre-line;"],(e=>e.theme.palette.grey[800]),(e=>13/e.theme.fontSize)),V=e=>{let{message:t}=e;return(0,h.jsx)(U,{"data-testid":d.z7.FORM_GREETING_MSG,children:(0,h.jsx)(K.ZP,{properties:{target:"_blank"},children:t})})};V.propTypes={message:s().string};const $=V;var G=i(50248),W=i(80630);const Q=()=>{const e=(0,G.cI)(),t=(0,o.useCallback)((t=>{e.batch((()=>{t.display_name&&e.change("name",t.display_name),t.email&&e.change("email",t.email)}))}),[e]),i=(0,o.useCallback)((function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.batch((()=>{t.name&&e.change("name",t.name),t.email&&e.change("email",t.email),t.phone&&e.change("phone",t.phone)}))}),[e]),n=(0,o.useCallback)((function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.batch((()=>{t.departmentId!==e.values?.department&&e.change("department",t.departmentId)}))}),[e]),s=(0,o.useCallback)((function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.batch((()=>{t.name&&e.change("name",t.name),t.email&&e.change("email",t.email),t.phone&&e.change("phone",t.phone)}))}),[e]);return(0,W.Z)("chatVisitor","prechat-form",s),(0,W.Z)("identify","prechat-form",t),(0,W.Z)("prefill","prechat-form",i),(0,W.Z)("chatDepartmentSelect","prechat-form",n),null};var X,Y,J,ee=i(77058);function te(){return te=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},te.apply(this,arguments)}const ie=e=>{let{title:t,titleId:i,...n}=e;return o.createElement("svg",te({width:"1000px",height:"1000px",viewBox:"0 0 1000 1000",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink","aria-labelledby":i},n),t?o.createElement("title",{id:i},t):null,X||(X=o.createElement("desc",null,"Created with Sketch.")),Y||(Y=o.createElement("defs",null)),J||(J=o.createElement("g",{stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},o.createElement("g",{transform:"translate(-1.000000, -49.000000)",fillRule:"nonzero",fill:"#000000"},o.createElement("g",{transform:"translate(1.000000, 49.000000)"},o.createElement("path",{d:"M875,0 L125,0 C56.25,0 0,56.25 0,125 L0,875 C0,943.75 56.25,1000 125,1000 L875,1000 C943.75,1000 1000,943.75 1000,875 L1000,125 C1000,56.25 943.75,0 875,0 Z M824.875,562.5 L687.5,562.5 L687.5,937.5 L562.5,937.5 L562.5,562.5 L437.5,562.5 L437.5,437.5 L562.5,437.5 C562.5,437.5 562.5,382.125 562.5,323.375 C562.5,234.5 605,152.875 737.313,152.875 C790.751,152.875 830.438,158.063 830.438,158.063 L827.25,281.626 C827.25,281.626 786.875,281.251 742.75,281.251 C695,281.251 687.375,303.251 687.375,339.751 C687.375,345.189 687.375,346.376 687.375,345.876 C687.375,355.814 687.375,375.064 687.375,437.564 L831,437.564 L824.875,562.5 Z"}))))))};var ne,se,oe,ae,re,le;function de(){return de=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},de.apply(this,arguments)}const ce=e=>{let{title:t,titleId:i,...n}=e;return o.createElement("svg",de({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 48 48","aria-labelledby":i},n),t?o.createElement("title",{id:i},t):null,ne||(ne=o.createElement("defs",null,o.createElement("path",{id:"a",d:"M44.5 20H24v8.5h11.8C34.7 33.9 30.1 37 24 37c-7.2 0-13-5.8-13-13s5.8-13 13-13c3.1 0 5.9 1.1 8.1 2.9l6.4-6.4C34.6 4.1 29.6 2 24 2 11.8 2 2 11.8 2 24s9.8 22 22 22c11 0 21-8 21-22 0-1.3-.2-2.7-.5-4z"}))),se||(se=o.createElement("clipPath",{id:"b"},o.createElement("use",{xlinkHref:"#a",overflow:"visible"}))),oe||(oe=o.createElement("path",{clipPath:"url(#b)",fill:"#FBBC05",d:"M0 37V11l17 13z"})),ae||(ae=o.createElement("path",{clipPath:"url(#b)",fill:"#EA4335",d:"M0 11l17 13 7-6.1L48 14V0H0z"})),re||(re=o.createElement("path",{clipPath:"url(#b)",fill:"#34A853",d:"M0 37l30-23 7.9 1L48 0v48H0z"})),le||(le=o.createElement("path",{clipPath:"url(#b)",fill:"#4285F4",d:"M48 48L17 24l-4-3 35-10z"})))},he=E.ZP.div.withConfig({displayName:"styles__SocialLoginContainer",componentId:"sc-1c3wj5y-0"})(["&&&{margin-bottom:","rem;display:flex;align-items:center;}",""],14/d.Kt,(e=>e.shouldSpace&&`\n  margin-top: ${15/e.theme.fontSize}rem`)),me=(0,E.ZP)(ee.hU).withConfig({displayName:"styles__LoginIconButton",componentId:"sc-1c3wj5y-1"})(["&&&{border:","rem solid "," !important;width:","rem !important;height:","rem !important;border-radius:","rem;position:relative;top:","rem;margin-left:","rem;display:inline-block;",":focus{box-shadow:0 0 0 ","rem "," !important;background-color:"," !important;}:hover{background-color:"," !important;}}"],1/d.Kt,(e=>e.theme.palette.grey[400]),44/d.Kt,28/d.Kt,14/d.Kt,3/d.Kt,5/d.Kt,(e=>e.theme.rtl&&`\n      margin-right: ${5/d.Kt}rem;\n    `),3/d.Kt,(e=>e.theme.headerFocusRingColorStr),(e=>e.theme.palette.white),(e=>e.theme.palette.grey[100])),pe=(0,E.ZP)(ie).withConfig({displayName:"styles__FacebookLoginIcon",componentId:"sc-1c3wj5y-2"})(["{&&{width:","rem;height:","rem;}path{fill:#3b5998;}}"],15/d.Kt,15/d.Kt),ue=(0,E.ZP)(ce).withConfig({displayName:"styles__GoogleLoginIcon",componentId:"sc-1c3wj5y-3"})(["{&&{width:","rem;height:","rem;}}"],15/d.Kt,15/d.Kt),ge=e=>{let{authUrls:t={},shouldSpace:i=!1}=e;const n=(0,M.Z)();return 0===Object.values(t).length?null:(0,h.jsxs)(he,{shouldSpace:i,children:[(0,h.jsx)("p",{children:n("embeddable_framework.chat.form.common.field.social_login.label")}),t.facebook&&(0,h.jsx)(me,{title:"facebook",onClick:()=>window.open(t.facebook),ignoreThemeOverride:!0,children:(0,h.jsx)(pe,{"data-testid":d.z7.ICON_FACEBOOK})}),t.google&&(0,h.jsx)(me,{title:"google",onClick:()=>window.open(t.google),ignoreThemeOverride:!0,children:(0,h.jsx)(ue,{"data-testid":d.z7.ICON_GOOGLE})})]})};ge.propTypes={authUrls:s().shape({google:s().string,facebook:s().string}),shouldSpace:s().bool};const fe=ge;var be=i(69104),ye=i.n(be),Ce=i(87713),xe=i.n(Ce),we=i(25862);const ve=e=>e.chat.chatHistory.chats,_e=e=>e.chat.chatHistory.log.entries,je=e=>Te(e)>0,Se=e=>e.chat.chatHistory.hasMore,ke=e=>e.chat.chatHistory.requestStatus,Te=(0,we.createSelector)([ve],(e=>e?e.size:0)),Pe=xe()(ve,((e,t)=>t),((e,t)=>ye()(t,(t=>e.get(t)))))(((e,t)=>t[t.length-1]));var Ie=i(51860);const Ee=E.ZP.div.withConfig({displayName:"styles__Container",componentId:"sc-hm5hn2-0"})(["border-bottom:"," ","rem solid;text-align:center;padding-bottom:","rem;margin-bottom:","rem;"],(e=>e.theme.palette.grey[300]),(e=>1/e.theme.fontSize),(e=>10/e.theme.fontSize),(e=>10/e.theme.fontSize)),Ne=(0,E.ZP)(ee.zx).attrs((()=>({isLink:!0,ignoreThemeOverride:!0}))).withConfig({displayName:"styles__Button",componentId:"sc-hm5hn2-1"})(["&&&{&,&:hover{color:"," !important;}}"],(e=>e.theme.palette.grey[800])),Re=(0,E.ZP)(Ie.default).withConfig({displayName:"styles__HistoryIcon",componentId:"sc-hm5hn2-2"})(["&&&{margin-right:","rem;vertical-align:middle;color:",";","}"],(e=>6/e.theme.fontSize),(e=>e.theme.palette.grey[600]),(e=>e.theme.rtl&&`\n      margin-right: 0;\n      margin-left: ${6/e.theme.fontSize}rem;\n    `)),Ae=e=>{let{canShowHistory:t,onOpenChatHistory:i}=e;const n=(0,M.Z)();return t?(0,h.jsxs)(Ee,{children:[(0,h.jsx)(Re,{}),(0,h.jsx)(Ne,{onClick:i,children:n("embeddable_framework.chat.historyLink.label")})]}):null};Ae.propTypes={canShowHistory:s().bool,onOpenChatHistory:s().func};const Le={onOpenChatHistory:_.QF},Me=(0,a.$j)((e=>({canShowHistory:(0,v.j3)(e)&&je(e)})),Le)(Ae);var ze=i(57137),Ze=i.n(ze),Oe=i(32257),qe=i(92844),De=i(52133);const Be=e=>{const t=(0,De.ak)(e),{departments:i=[]}=(0,qe.z8)(e);return(!Array.isArray(t)||0!==t.length)&&(0!==i.length&&(1!==i.length||!i[0].isDefault))},He=e=>{const t=(0,De.n7)(e),i=(0,qe.Ph)(e),n=t?.departmentLabel,s=i?.department?.label,o=Oe.a.t("embeddable_framework.chat.form.common.dropdown.chooseDepartment");return Oe.a.getSettingTranslation(n)||s||o},Fe=e=>(0,qe.KF)(e).message;(0,we.createSelector)([De.Lj,v.yj,v.By],((e,t,i)=>{const n=e||t;return Ze()(i,(e=>e.name.toLowerCase()===n||e.id===n))}));var Ke=i(41967);const Ue={name:e=>{let{field:t,value:i}=e;if(t.required&&!i)return"embeddable_framework.validation.error.name"},email:e=>{let{field:t,value:i}=e;return t.required&&!i?"embeddable_framework.validation.error.email":i?d.QI.test(i)?void 0:"embeddable_framework.validation.error.email":void 0},department:e=>{let{field:t,value:i,isOfflineFormEnabled:n,isVisibleDepartmentsFeatureEnabled:s}=e;if(t.required&&!i)return"embeddable_framework.validation.error.department";const o=t.options.find((e=>e.value===i));return s&&!o&&t.required||o&&o.disabled&&!n?"embeddable_framework.validation.error.department":void 0},phone:e=>{let{field:t,value:i}=e;return t.required&&!i?"embeddable_framework.validation.error.phone":i?d.mj.test(i)?void 0:"embeddable_framework.validation.error.phone":void 0},message:e=>{let{field:t,value:i}=e;if(t.required&&!i)return"embeddable_framework.validation.error.message"}},Ve=e=>{let{values:t,fields:i,isOfflineFormEnabled:n,isVisibleDepartmentsFeatureEnabled:s}=e;const o={};if(i.forEach((e=>{const i=Ue[e.id]?.({value:t[e.id],field:e,isOfflineFormEnabled:n,isVisibleDepartmentsFeatureEnabled:s});i&&(o[e.id]=i)})),Object.keys(o).length>0)return o},$e=e=>{let{title:t,getVisibleFields:i,isAuthenticated:n,onSubmit:s,greetingMessage:o,visitor:a,socialLogin:r,authUrls:l,initiateSocialLogout:d,readOnlyValues:c,isOfflineFormEnabled:m,departments:g,isPreview:b,initialValues:y}=e;const C=(0,k.Z)("web_widget_prechat_form_visible_departments"),x=(0,M.Z)(),w=function(){return i(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).some((e=>"department"===e.id))},v=(e,t)=>{if(C){const i=e.some((e=>"department"===e.id)),n=Boolean(e.find((e=>"department"===e.id))?.options.some((e=>e.value===t)));return(!i||i&&n)&&"offline"===g[t]?.status}return"offline"===g[t]?.status},_=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i={};return t.department&&(i.department=t.department),{...i,...e}};return(0,h.jsxs)(p.Z,{children:[(0,h.jsx)(u.Z,{title:t}),(0,h.jsxs)(T.Z,{formId:"prechat-form",onSubmit:(e,t)=>s({values:_(e,t),isDepartmentFieldVisible:w(e)}).then((()=>({success:!0}))),initialValues:{message:y?.message},getFields:i,controls:(0,h.jsx)(Q,{}),isPreview:b,validate:e=>Ve({values:e,isAuthenticated:n,fields:i(e),isOfflineFormEnabled:m,isVisibleDepartmentsFeatureEnabled:C}),footer:e=>{let{isSubmitting:t,formValues:i,fields:n}=e;return(0,h.jsx)(f.Z,{children:(0,h.jsx)(P.Z,{submitting:t,label:v(n,i?.department)?x("embeddable_framework.chat.preChat.offline.button.sendMessage"):x("embeddable_framework.chat.preChat.online.button.startChat")})})},extraFieldOptions:{socialLogin:()=>(0,h.jsx)(fe,{authUrls:l})},readOnlyValues:c,children:[(0,h.jsx)(Me,{}),o&&(0,h.jsx)($,{message:o}),Boolean(n||r?.authenticated)&&(0,h.jsx)(F,{visitor:a,socialLogin:r,initiateSocialLogout:d})]})]})};$e.propTypes={title:s().string,onSubmit:s().func,getVisibleFields:s().func,isAuthenticated:s().bool,greetingMessage:s().string,visitor:F.propTypes.visitor,socialLogin:F.propTypes.socialLogin,authUrls:fe.propTypes.authUrls,initiateSocialLogout:F.propTypes.initiateSocialLogout,readOnlyValues:s().objectOf(s().bool),isOfflineFormEnabled:s().bool,isPreview:s().bool,departments:s().objectOf(s().shape({status:s().string})),initialValues:s().shape({message:s().string})};const Ge=(0,a.$j)((e=>({title:(0,qe.U)(e),customerDefinedDepartmentsEnabled:(0,De.ak)(e),getVisibleFields:t=>function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=(0,qe.z8)(e),n=(0,v.G7)(e),s=(0,v.j3)(e),{authenticated:o}=(0,v.cA)(e),a=(0,w.iI)(e,t.department),r="offline"===a?.status||void 0;return[{id:"name",title:Oe.a.t("embeddable_framework.common.textLabel.name"),required:Boolean(i.name?.required||r),visible:n.enabled&&!s&&!o,type:"text"},{id:"socialLogin",type:"socialLogin",visible:n.enabled&&!s&&!o},{id:"email",title:Oe.a.t("embeddable_framework.common.textLabel.email"),required:Boolean(i.email?.required||r),visible:n.enabled&&!s&&!o,type:"email"},{id:"department",title:He(e),required:Boolean(i.department?.required),visible:Be(e),type:"dropdown",options:i.departments?.map((e=>({name:e.name,value:e.id,disabled:e.disabled})))},{id:"phone",title:Oe.a.t("embeddable_framework.common.textLabel.phone_number"),required:Boolean(i.phone?.required),visible:n.enabled&&!s&&n.phoneEnabled,type:"text"},{id:"message",title:Oe.a.t("embeddable_framework.common.textLabel.message"),required:Boolean(i.message?.required||r),visible:!0,type:"textarea"}].filter((e=>e.visible))}(e,t),isAuthenticated:(0,v.j3)(e),greetingMessage:Fe(e),visitor:(0,v.X8)(e),socialLogin:(0,v.cA)(e),authUrls:(0,w.zC)(e),readOnlyValues:(0,Ke.ek)(e),isOfflineFormEnabled:(0,qe._v)(e).enabled,departments:(0,v.Ps)(e),initialValues:(0,v.$w)(e)})),{initiateSocialLogout:_.XX,onSubmit:S})($e);var We=i(18942),Qe=i(52189);const Xe=e=>{let{onClick:t,label:i,hideButton:n}=e;return(0,h.jsx)(f.Z,{children:!n&&(0,h.jsx)(ee.zx,{isPrimary:!0,onClick:t,type:"submit","data-testid":d.z7.CHAT_START,children:i})})};Xe.propTypes={onClick:s().func,label:s().string,hideButton:s().bool},Xe.defaultProps={onClick:()=>{},label:"",hideButton:!1};const Ye=Xe,Je=e=>{let{title:t,updateChatScreen:i}=e;const n=(0,M.Z)();return(0,h.jsxs)(p.Z,{children:[(0,h.jsx)(u.Z,{title:t}),(0,h.jsx)(g.Z,{children:(0,h.jsx)(Qe.Z,{icon:(0,h.jsx)(We.Z,{}),doneText:n("embeddable_framework.common.button.goBack"),onClick:()=>i(j.KF)})}),(0,h.jsx)(Ye,{hideButton:!0,scrollShadowVisible:!1})]})};Je.propTypes={title:s().string,updateChatScreen:s().func};const et={updateChatScreen:_.a9},tt=(0,a.$j)((e=>({title:(0,qe.U)(e)})),et)(Je);var it=i(76920);class nt extends o.Component{static propTypes={screen:s().string.isRequired,title:s().string.isRequired,selectedDepartment:s().shape({id:s().number,status:s().string}),isPreview:s().bool};static defaultProps={hideZendeskLogo:!1,sendOfflineMessage:()=>{},preChatFormSettings:{},loginSettings:{},settingsDepartmentsEnabled:[]};renderLoadingSpinner(){return(0,h.jsxs)(p.Z,{children:[(0,h.jsx)(u.Z,{title:this.props.title}),(0,h.jsx)(g.Z,{children:(0,h.jsx)(m,{className:it.locals.loadingSpinner})}),(0,h.jsx)(f.Z,{})]})}render=()=>{switch(this.props.screen){case j.KF:return(0,h.jsx)(Ge,{isPreview:this.props.isPreview});case j.dG:return this.renderLoadingSpinner();case j.fb:return(0,h.jsx)(tt,{})}return null}}const st={updateChatScreen:_.a9,handlePreChatFormChange:_.rn,initiateSocialLogout:_.XX,openedChatHistory:_.QF,submitPrechatForm:S},ot=(0,a.$j)((e=>{const t=(0,v.$w)(e);return{selectedDepartment:t.department?(0,v.Ps)(e)[t.department]:void 0,screen:(0,v.Cb)(e),offlineMessage:(0,v.AC)(e),chatVisitor:(0,v.X8)(e),title:(0,qe.U)(e)}}),st,null,{forwardRef:!0})(nt);var at=i(69110),rt=i(66386);function lt(e){return{type:rt.mE,payload:e}}var dt=i(73785);function ct(e){return(t,i)=>new Promise(((n,s)=>{t({type:rt.Ob,payload:e}),(0,dt.A)(i,"sendEmailTranscript")(e,(i=>{i?(t({type:rt.C_,payload:e}),s()):(t({type:rt.oU,payload:e}),n())}))}))}const ht=(0,E.ZP)(ee.zx).withConfig({displayName:"styles__StyledButton",componentId:"sc-gl1ajb-0"})(["&&&{background-color:",";border-color:"," !important;color:"," !important;box-shadow:0 ","rem ","rem 0 rgba(0,0,0,0.2);left:50%;transform:translateX(-50%);position:fixed;z-index:2;bottom:50%;font-size:","rem;padding:0 ","rem !important;&:hover,&:focus,&:active{background:"," !important;}"," ","}"],(e=>e.theme.palette.white),(e=>e.theme.palette.grey[200]),(e=>e.theme.palette.grey[800]),1/d.Kt,10/d.Kt,15/d.Kt,20/d.Kt,(e=>e.theme.palette.grey[100]),(e=>e.isMobile&&`\n        bottom: ${60/d.Kt}rem;\n        box-sizing: border-box !important;\n        display: block !important;\n      `),(e=>e.theme.rtl&&`\n        padding-left: ${9/d.Kt}rem !important;\n        padding-right: ${14/d.Kt}rem !important;\n        white-space: nowrap !important;\n      `)),mt=e=>{let{onClick:t=(()=>{}),children:i}=e;return(0,h.jsx)(ht,{onClick:t,isPill:!0,children:i})};mt.propTypes={children:s().node,onClick:s().func};const pt=mt,ut=E.ZP.div.withConfig({displayName:"styles__Container",componentId:"sc-1nlarwu-0"})(["position:absolute;top:0;bottom:0;left:0;right:0;display:flex;align-items:center;justify-content:center;"]),gt=e=>{let{onClick:t}=e;const i=(0,M.Z)();return(0,h.jsx)(ut,{children:(0,h.jsx)(pt,{onClick:t,children:i("embeddable_framework.chat.chatLog.reconnect.label")})})};gt.propTypes={onClick:s().func};const ft=gt;var bt=i(2806);const yt=E.ZP.div.withConfig({displayName:"styles__Container",componentId:"sc-z770lh-0"})(["position:absolute;top:3rem;bottom:0;left:0;right:0;display:flex;align-items:center;justify-content:center;z-index:1;"]),Ct=E.ZP.div.withConfig({displayName:"styles__Bubble",componentId:"sc-z770lh-1"})(["opacity:0.9;border-radius:","rem !important;box-shadow:0 ","rem ","rem 0 rgba(0,0,0,0.2);max-width:90%;height:","rem;line-height:","rem;background-color:",";display:flex;justify-content:space-between;align-items:center;padding-left:","rem;padding-right:","rem;"],(e=>30/e.theme.fontSize),(e=>1/e.theme.fontSize),(e=>10/e.theme.fontSize),(e=>30/e.theme.fontSize),(e=>30/e.theme.fontSize),(e=>e.theme.palette.white),(e=>15/e.theme.fontSize),(e=>12/e.theme.fontSize)),xt=E.ZP.div.withConfig({displayName:"styles__Message",componentId:"sc-z770lh-2"})(["margin-right:","rem;margin-bottom:","rem;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;color:",";"],(e=>7/e.theme.fontSize),(e=>1/e.theme.fontSize),(e=>e.theme.palette.grey[800])),wt=()=>{const e=(0,M.Z)();return(0,h.jsx)(yt,{children:(0,h.jsxs)(Ct,{children:[(0,h.jsxs)(xt,{role:"status","aria-live":"polite",children:[e("embeddable_framework.chat.reconnecting")," "]}),(0,h.jsx)(bt.$j,{})]})})};var vt=i(76299);const _t=E.ZP.img.withConfig({displayName:"styles__Image",componentId:"sc-m2mc5j-0"})(["display:block !important;padding:0 !important;text-align:center !important;border-radius:50%;background-color:",";height:","rem;width:","rem;"],(e=>e.theme.palette.grey[500]),32/d.Kt,32/d.Kt),jt={[d.UZ.AGENT_AVATAR]:vt.default},St=e=>{let{src:t,fallbackIcon:i}=e;const n=jt[i]||vt.default;return t?(0,h.jsx)(_t,{"aria-hidden":"true",alt:"avatar",src:t}):(0,h.jsx)(n,{"aria-hidden":"true",alt:"avatar"})};St.propTypes={src:s().string,fallbackIcon:s().string};const kt=St,Tt=E.ZP.div.withConfig({displayName:"styles__Container",componentId:"sc-7qwaeq-0"})(["width:100% !important;display:flex !important;align-items:center !important;height:","rem !important;"],50/d.Kt),Pt=E.ZP.div.withConfig({displayName:"styles__TextContainer",componentId:"sc-7qwaeq-1"})(["color:",";line-height:","rem;padding-left:","rem;overflow:hidden;[dir='rtl'] &{padding-left:0 !important;padding-right:","rem !important;}"],(e=>e.theme.palette.grey[800]),16/d.Kt,15/d.Kt,10/d.Kt),It="\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  overflow: hidden;\n",Et=E.ZP.div.withConfig({displayName:"styles__AgentName",componentId:"sc-7qwaeq-2"})([""," font-weight:700;"],It),Nt=E.ZP.div.withConfig({displayName:"styles__AgentTitle",componentId:"sc-7qwaeq-3"})([""," color:",";"],It,(e=>e.theme.palette.grey[600])),Rt=e=>{let{agent:t}=e;return(0,h.jsxs)(Tt,{children:[(0,h.jsx)(kt,{src:t.avatar_path,fallbackIcon:d.UZ.AGENT_AVATAR}),(0,h.jsxs)(Pt,{children:[(0,h.jsx)(Et,{children:t.display_name}),(0,h.jsx)(Nt,{children:t.title})]})]})};Rt.propTypes={agent:s().shape({nick:s().string,isTyping:s().bool,title:s().string,display_name:s().string}).isRequired};const At=Rt,Lt=e=>{let{agents:t}=e;return(0,h.jsx)("ul",{children:Object.values(t).map((e=>(0,h.jsx)("li",{children:(0,h.jsx)(At,{agent:e})},e.nick)))})};Lt.propTypes={agents:s().shape({[s().string]:s().shape({nick:s().string,isTyping:s().bool,title:s().string,display_name:s().string})}).isRequired};const Mt=(0,a.$j)((e=>({agents:(0,w.Vy)(e)})))(Lt),zt=e=>{let{updateChatScreen:t}=e;const i=(0,M.Z)();return(0,h.jsxs)(p.Z,{children:[(0,h.jsx)(u.Z,{title:i("embeddable_framework.helpCenter.label.link.chat")}),(0,h.jsx)(g.Z,{children:(0,h.jsx)(Mt,{})}),(0,h.jsx)(f.Z,{children:(0,h.jsx)(ee.zx,{isPrimary:!0,onClick:()=>t(j.ew),children:i("embeddable_framework.chat.agentList.button.backToChat")})})]})};zt.propTypes={updateChatScreen:s().func.isRequired};const Zt={updateChatScreen:_.a9},Ot=(0,a.$j)(null,Zt)(zt);var qt=i(98056),Dt=i(97416);const Bt=E.ZP.div.withConfig({displayName:"styles__Container",componentId:"sc-1xyc8p7-0"})(["display:flex;align-items:center;box-shadow:0 ","rem ","rem 0 rgba(0,0,0,0.1);padding:",";z-index:3;flex-shrink:0;"],(e=>4/e.theme.fontSize),(e=>8/e.theme.fontSize),(e=>`${12/e.theme.fontSize}rem ${16/e.theme.fontSize}rem`)),Ht=E.ZP.div.withConfig({displayName:"styles__AgentInfo",componentId:"sc-1xyc8p7-1"})(["display:flex;flex:1;border:none;text-align:left;background:none;min-width:0;",";",""],(e=>e.clickable&&"cursor: pointer"),(e=>e.theme.rtl&&"text-align: right;")),Ft=E.ZP.div.withConfig({displayName:"styles__Overflow",componentId:"sc-1xyc8p7-2"})(["display:flex;justify-content:center;align-items:center;border-radius:50%;height:","rem;width:","rem;border:"," ","rem solid;"],(e=>34/e.theme.fontSize),(e=>34/e.theme.fontSize),(e=>e.theme.palette.grey[400]),(e=>2/e.theme.fontSize)),Kt=E.ZP.div.withConfig({displayName:"styles__OverflowText",componentId:"sc-1xyc8p7-3"})(["color:",";"],(e=>e.theme.palette.grey[600])),Ut=E.ZP.div.withConfig({displayName:"styles__Text",componentId:"sc-1xyc8p7-4"})(["color:",";line-height:","rem;padding-top:","rem;flex:1;min-width:0;",""],(e=>e.theme.palette.grey[800]),16/d.Kt,1/d.Kt,(e=>e.showTitle?e.showAvatar?e.theme.rtl?{paddingRight:"12px"}:{paddingLeft:"12px"}:null:{visibility:"hidden"})),Vt=(0,E.ZP)(Z.q).withConfig({displayName:"styles__StyledAvatar",componentId:"sc-1xyc8p7-5"})([""]),$t=E.ZP.div.withConfig({displayName:"styles__TooltipWrapper",componentId:"sc-1xyc8p7-6"})(["> div{display:block;}"]),Gt=E.ZP.h2.withConfig({displayName:"styles__Title",componentId:"sc-1xyc8p7-7"})(["font-weight:700;font-size:","rem;width:100%;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;"],14/d.Kt),Wt=E.ZP.div.withConfig({displayName:"styles__Subtext",componentId:"sc-1xyc8p7-8"})(["width:100%;margin-top:","rem;overflow:hidden;display:-webkit-box;text-overflow:ellipsis;-webkit-box-orient:vertical;-webkit-line-clamp:2;"],1/d.Kt),Qt=E.ZP.div.withConfig({displayName:"styles__AvatarContainer",componentId:"sc-1xyc8p7-9"})(["align-self:center;position:relative;display:flex;flex-shrink:0;align-items:center;",",","{box-sizing:border-box;box-shadow:0 0 0 ","rem white;max-width:none;svg{padding-left:","rem;}}"],Vt,Ft,(e=>2/e.theme.fontSize),(e=>.5/e.theme.fontSize)),Xt=e=>{let{showAvatar:t,showTitle:i,showRating:n,onAgentDetailsClick:s,agentsActive:o,concierges:a,updateRating:r,rating:l}=e;const c=(0,M.Z)();if(!t&&!i&&!n)return null;const m=a.length,p=m>3?Math.min(m-2,99):0,u=a.slice(0,p?2:3),g=c("embeddable_framework.chat.header.default.title"),f=a[0].display_name||g,b=c("embeddable_framework.chat.header.by_line"),y=a[0].title||b;return(0,h.jsxs)(Bt,{"data-testid":d.z7.HEADER_CONTAINER,children:[(0,h.jsxs)(Ht,{clickable:Boolean(s&&o),onClick:o?s:void 0,as:o?"button":"div",children:[t&&(0,h.jsxs)(Qt,{children:[u.map(((e,t)=>{const i=e.avatar_path||"";return(0,h.jsx)(Vt,{index:t,src:i,fallbackIcon:d.UZ.AVATAR},i)})),p>0&&(0,h.jsx)(Ft,{children:(0,h.jsxs)(Kt,{children:["+",p]})})]}),i&&(0,h.jsxs)(Ut,{"data-testid":d.z7.CHAT_HEADER_TEXT_CONTAINER,showTitle:i,showAvatar:t,children:[(0,h.jsx)(Gt,{"data-testid":d.z7.CHAT_HEADER_TITLE,children:f}),(0,h.jsx)($t,{children:(0,h.jsx)(qt.u,{size:"medium",style:{display:"block"},content:y,children:(0,h.jsx)(Wt,{"data-testid":d.z7.CHAT_HEADER_SUBTEXT,tooltip:y,tabIndex:"-1",children:y})})})]})]}),n&&(0,h.jsx)(Dt.Z,{updateRating:r,rating:l})]})};Xt.propTypes={concierges:s().arrayOf(s().shape({displayName:s().string,title:s().string,avatarPath:s().string,avatarData:s().string})),updateRating:s().func,rating:s().string,showRating:s().bool,showAvatar:s().bool,showTitle:s().bool,onAgentDetailsClick:s().func,agentsActive:s().bool},Xt.defaultProps={updateRating:()=>{},rating:null,concierges:[{}],showRating:!1,showAvatar:!0,showTitle:!0,agentsActive:!1};const Yt={updateRating:_.cq},Jt=(0,a.$j)((e=>({showRating:(0,qe.dJ)(e),showTitle:(0,qe._5)(e).title,showAvatar:(0,qe._5)(e).avatar,rating:(0,v.sc)(e).value,concierges:(0,qe.I5)(e)})),Yt)(Xt);var ei=i(51393),ti=i(33080),ii=i(68008),ni=i(18789),si=i(84228),oi=i(123),ai=i(66925),ri=i(47020),li=i(24726),di=i(48829);const ci=()=>((0,r.K1)()?16:14)/d.Kt+"rem",hi=(0,E.ZP)(ee.hU).withConfig({displayName:"FooterIconButton",componentId:"sc-1e67ril-0"})(["width:auto !important;height:auto !important;"," svg{box-sizing:content-box;padding:",";min-width:",";min-height:",";width:"," !important;height:"," !important;g,path{",":"," !important;}}&:not(:disabled){&:hover,&:active,&:focus{background:"," !important;svg > g,path{",":"," !important;}}}&:disabled svg g{fill:"," !important;}"],(()=>(0,r.K1)()&&`\n  margin: 0 ${4/d.Kt}rem !important;\n  `),(()=>((0,r.K1)()?8:5)/d.Kt+"rem"),ci,ci,ci,ci,(e=>e.colorType),(e=>e.theme.palette.grey[600]),(e=>e.theme.palette.grey[300]),(e=>e.colorType),(e=>e.theme.palette.grey[800]),(e=>e.theme.palette.grey[400]));hi.propTypes={colorType:s().oneOf(["fill","stroke"])},hi.defaultProps={isPill:(0,r.K1)(),ignoreThemeOverride:!0,colorType:"stroke",size:"small"};const mi=hi;var pi=i(27483),ui=i(31931),gi=i(4223),fi=i(83164),bi=i(38607),yi=i(13991);const Ci=(0,E.ZP)(bi.Z).withConfig({displayName:"styles__StyledSoundOffIcon",componentId:"sc-10var20-0"})(["height:1em;vertical-align:middle;margin-left:","rem;"],6/d.Kt),xi=Ci.withComponent(yi.Z),wi=((0,E.ZP)(ee.hU).withConfig({displayName:"styles__StyledIconButton",componentId:"sc-10var20-1"})(["margin:","rem !important;height:3rem !important;width:3rem !important;svg{height:1rem;width:1rem;}&:focus{outline:none !important;box-shadow:0 0 0 ","rem rgba(255,255,255,0.4) !important;}"],3/d.Kt,3/d.Kt),(0,E.ZP)(ri.v2).withConfig({displayName:"styles__StyledMenu",componentId:"sc-10var20-2"})(["&&&{width:",";z-index:5;border-radius:0;margin:0;}"],(0,r.K1)()?"100vw":"calc(100vw - 40px)")),vi=E.ZP.div.withConfig({displayName:"styles__Container",componentId:"sc-10var20-3"})(["position:relative;"]),_i=(0,E.ZP)(fi.Z).withConfig({displayName:"styles__StyledEllipsisIcon",componentId:"sc-10var20-4"})(["&&&{color:inherit;margin-top:0;}"]),ji=(0,E.ZP)(gi.Z).withConfig({displayName:"styles__StyledMenuIcon",componentId:"sc-10var20-5"})(["pointer-events:none;"]),Si=e=>{let{isOpen:t,onToggle:i,soundEnabled:n,editContactDetailsEnabled:s,endChatDisabled:a,emailTranscriptEnabled:l,goBackIsVisible:c,soundIsVisible:m,handleSoundIconClick:p,updateEmailTranscriptVisibility:u,updateContactDetailsVisibility:g,updateEndChatModalVisibility:f,onBackClick:b}=e;const[y,C]=(0,o.useState)(null),x=(0,M.Z)(),w=(0,di.ND)(),v={sound:()=>p({sound:!n}),email:()=>u(!0),contact:()=>g(!0),endChat:()=>f(!0),back:b},_=(0,h.jsxs)(ri.Lt,{onSelect:e=>{v[e]&&(0,li.Fc)((()=>{v[e]()}))},isOpen:t,highlightedIndex:y,onStateChange:e=>{"sound"!==e.selectedItem&&(void 0!==e.isOpen&&(e.isOpen&&(u(!1),g(!1),f(!1)),i(e.isOpen)),void 0!==e.highlightedIndex&&C(e.highlightedIndex))},downshiftProps:{environment:w.window},children:[(0,h.jsx)(ri.xz,{children:(0,r.K1)()?(0,h.jsx)(oi.Z,{"aria-label":"Menu","data-testid":d.z7.CHAT_MENU,children:(0,h.jsx)(ji,{})}):(0,h.jsx)(mi,{"aria-label":"Menu","data-testid":d.z7.CHAT_MENU,children:(0,h.jsx)(_i,{"data-testid":d.z7.ICON_ELLIPSIS,"aria-hidden":"true"})})}),(0,h.jsxs)(wi,{placement:(0,r.K1)()?"bottom":"top","data-testid":d.z7.CHAT_MENU_LIST,popperModifiers:{preventOverflow:{padding:(0,r.K1)()?0:20}},children:[c&&(0,h.jsx)(ri.ck,{value:"back","data-testid":d.z7.CHAT_MENU_ITEM_BACK,children:x("embeddable_framework.common.button.goBack")}),m&&(0,h.jsxs)(ri.ck,{value:"sound","data-testid":d.z7.CHAT_MENU_ITEM_TOGGLE_SOUND,children:[x("embeddable_framework.chat.options.sound"),n?(0,h.jsx)(xi,{}):(0,h.jsx)(Ci,{})]}),l&&(0,h.jsx)(ri.ck,{value:"email","data-testid":d.z7.CHAT_MENU_ITEM_EMAIL_TRANSCRIPT,children:x("embeddable_framework.chat.options.emailTranscript")}),s&&(0,h.jsx)(ri.ck,{value:"contact","data-testid":d.z7.CHAT_MENU_ITEM_EDIT_CONTACT_DETAILS,children:x("embeddable_framework.chat.options.editContactDetails")}),(0,h.jsx)(ri.ck,{value:"endChat",disabled:a,"data-testid":d.z7.CHAT_MENU_ITEM_END_CHAT,children:x("embeddable_framework.chat.options.endChat")})]})]});return(0,r.K1)()?_:(0,h.jsx)(qt.u,{content:x("embeddable_framework.chat.icon.menu.hover.label"),children:(0,h.jsx)(vi,{role:"presentation",onKeyDown:e=>{"Escape"===e.key&&t&&e.stopPropagation()},tabIndex:"-1",children:_})})};Si.propTypes={isOpen:s().bool,onToggle:s().func,soundEnabled:s().bool,endChatDisabled:s().bool,editContactDetailsEnabled:s().bool,emailTranscriptEnabled:s().bool,goBackIsVisible:s().bool,soundIsVisible:s().bool,handleSoundIconClick:s().func,updateEmailTranscriptVisibility:s().func,updateContactDetailsVisibility:s().func,updateEndChatModalVisibility:s().func,onBackClick:s().func};const ki={onToggle:lt,handleSoundIconClick:e=>({type:rt._9,payload:e}),updateEmailTranscriptVisibility:_.Nw,updateContactDetailsVisibility:_.fj,updateEndChatModalVisibility:_.KH},Ti=(0,a.$j)(((e,t)=>({isOpen:(0,v.de)(e),soundEnabled:(0,v.q_)(e),endChatDisabled:!(0,v.OQ)(e),editContactDetailsEnabled:(0,v.G7)(e).enabled,emailTranscriptEnabled:(0,pi.xZ)(e),goBackIsVisible:(0,r.K1)()&&t.onBackClick&&(0,ui.dN)(e)&&(0,pi.Yj)(e),soundIsVisible:!(0,r.K1)()})),ki)(Si);var Pi=i(82414),Ii=i(37723),Ei=i(51716);const Ni=e=>e.preview.choice,Ri=e=>(e=>e.preview.enabled)(e)&&Ni(e)===Ei.J;var Ai,Li,Mi,zi=i(78038);function Zi(){return Zi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},Zi.apply(this,arguments)}const Oi=e=>{let{title:t,titleId:i,...n}=e;return o.createElement("svg",Zi({width:"10px",height:"10px",viewBox:"0 0 10 10",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink","aria-labelledby":i},n),t?o.createElement("title",{id:i},t):null,Ai||(Ai=o.createElement("desc",null,"Created with Sketch.")),Li||(Li=o.createElement("defs",null,o.createElement("path",{d:"M.00025.00043 9.793.00043 9.793 9.79343.00025 9.79343z"}))),Mi||(Mi=o.createElement("g",{stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},o.createElement("g",null,o.createElement("g",null),o.createElement("path",{d:"M1.7325,9.47483 L7.8135,3.39383 L7.8135,6.64683 C7.8135,7.21183 8.2375,7.63683 8.8035,7.63683 C9.3685,7.63683 9.7935,7.21183 9.7935,6.64683 L9.7935,0.98983 C9.7935,0.84883 9.7935,0.70683 9.7225,0.63683 C9.5815,0.35383 9.4405,0.21183 9.1565,0.07083 C9.0155,0.07083 8.9445,-0.00017 8.8035,-0.00017 L3.1465,-0.00017 C2.8635,-0.00017 2.6515,0.07083 2.4395,0.28283 C2.2275,0.49483 2.1565,0.70683 2.1565,0.98983 C2.1565,1.55583 2.5815,1.97983 3.1465,1.97983 L6.3995,1.97983 L0.3175,8.06083 C-0.1055,8.48583 -0.1055,9.05083 0.3175,9.47483 C0.7425,9.89983 1.3085,9.89983 1.7325,9.47483",fill:"#000000",mask:"url(#mask-2)"})))))},qi=(0,E.ZP)(Oi).withConfig({displayName:"styles__StyledPopoutIcon",componentId:"sc-19kv59d-0"})(["&&&{height:0.7rem !important;width:0.7rem !important;}"]),Di=e=>{let{title:t,zChat:i,popoutSettings:n,isChatPreview:s,isPopoutButtonVisible:o,locale:a,handlePopoutCreated:l}=e;const c=(0,ei.i)();return(0,h.jsx)(ti.Z,{children:(0,h.jsxs)(ii.Z,{children:[(0,r.K1)()?(0,h.jsx)(Ti,{onBackClick:c}):(0,h.jsx)(ni.Z,{}),(0,h.jsx)(si.Z,{children:t}),o&&(0,h.jsx)(oi.Z,{onClick:()=>{s||(l(),(0,zi.nG)(n,i.getMachineId(),a))},"aria-label":"Popout",children:(0,h.jsx)(qi,{"data-testid":d.z7.ICON_POPOUT})}),(0,h.jsx)(ai.Z,{})]})})};Di.propTypes={title:s().string,zChat:s().shape({getMachineId:s().func}),popoutSettings:s().shape({}),isChatPreview:s().bool,isPopoutButtonVisible:s().bool,locale:s().string,handlePopoutCreated:s().func};const Bi={handlePopoutCreated:Pi.L1},Hi=(0,a.$j)((e=>({title:(0,qe.U)(e),zChat:(0,v.u6)(e),popoutSettings:(0,De.bw)(e),isChatPreview:Ri(e),isPopoutButtonVisible:Boolean(Ri(e)||(0,qe.qo)(e)),locale:(0,Ii.Kd)(e)})),Bi)(Di);var Fi=i(84751),Ki=i(65676),Ui=i(60485);const Vi={chatRating:s().shape({value:s().oneOf(Object.values(Dt.k)),disableEndScreen:s().bool,comment:s().string})},$i=(0,E.ZP)(ee.zx).withConfig({displayName:"styles__SecondaryButton",componentId:"sc-1ujd536-0"})(["flex-grow:1;max-width:50%;"]),Gi=(0,E.ZP)(ee.zx).withConfig({displayName:"styles__SubmitButton",componentId:"sc-1ujd536-1"})(["flex-grow:1;max-width:50%;margin-left:","rem !important;",""],(e=>7/e.theme.fontSize),(e=>e.theme.rtl&&`\n      margin-left: 0 !important;\n      margin-right: ${7/e.theme.fontSize}rem !important;\n    `)),Wi=E.ZP.div.withConfig({displayName:"styles__ButtonGroup",componentId:"sc-1ujd536-2"})(["display:flex !important;"]),Qi=(0,E.ZP)(Ki.__).withConfig({displayName:"styles__StyledLabel",componentId:"sc-1ujd536-3"})(["color:",";font-weight:700;display:block !important;"],(e=>e.theme.palette.grey[800])),Xi=(0,E.ZP)(Ki.gx).withConfig({displayName:"styles__StyledTextarea",componentId:"sc-1ujd536-4"})(["margin-bottom:","rem;"],(e=>15/e.theme.fontSize)),Yi=(0,E.ZP)(Dt.Z).withConfig({displayName:"styles__StyledRatingGroup",componentId:"sc-1ujd536-5"})(["margin-bottom:","rem;margin-top:","rem;"],(e=>10/e.theme.fontSize),(e=>5/e.theme.fontSize)),Ji=e=>{let{rating:t={value:Dt.k.NOT_SET,comment:""},secondaryButtonText:i,handleSecondaryButtonClick:n,submitForm:s}=e;const o=(0,M.Z)();return(0,h.jsx)(G.l0,{onSubmit:(e,t,i)=>{e.rating||e.comment?s(e.rating,e.comment):i({[Fi.Ck]:"embeddable_framework.validation.error.feedback_form"})},initialValues:{comment:t.comment,rating:t.value},render:e=>{let{handleSubmit:t,submitError:s}=e;return(0,h.jsxs)("form",{onSubmit:t,noValidate:!0,children:[(0,h.jsx)(G.gN,{name:"rating",render:e=>{let{input:t}=e;return(0,h.jsxs)(Ki.gN,{children:[(0,h.jsx)(Qi,{"data-testid":d.z7.FORM_GREETING_MSG,children:o("embeddable_framework.chat.postChat.rating.new_title")}),(0,h.jsx)(Yi,{rating:t.value,updateRating:e=>{t.onChange(e)}})]})}}),(0,h.jsx)(G.gN,{name:"comment",render:e=>{let{input:t}=e;return(0,h.jsxs)(Ki.gN,{children:[(0,h.jsx)(Qi,{children:o("embeddable_framework.chat.postChat.rating.plainDescription")}),(0,h.jsx)(Xi,{rows:6,"data-testid":d.z7.MESSAGE_FIELD,value:t.value,onChange:e=>{t.onChange(e.target.value)}})]})}}),s&&(0,h.jsx)(Ui.b,{type:"error",role:"alert",children:(0,h.jsx)(Ui.D,{children:o(s)})}),(0,h.jsxs)(Wi,{children:[(0,h.jsx)($i,{onClick:n,"data-testid":d.z7.BUTTON_CANCEL,"aria-label":i,children:i}),(0,h.jsx)(Gi,{isPrimary:!0,type:"submit","data-testid":d.z7.BUTTON_OK,"aria-label":o("embeddable_framework.common.button.send"),children:o("embeddable_framework.common.button.send")})]})]})}})};Ji.propTypes={rating:Vi.chatRating.isRequired,secondaryButtonText:s().string.isRequired,handleSecondaryButtonClick:s().func,submitForm:s().func.isRequired};const en=Ji,tn=e=>{let{rating:t,sendChatRating:i,sendChatComment:n,sendLastChatRatingInfo:s,updateChatScreen:o,isAgentEndedChatSession:a}=e;const r=(0,M.Z)();return(0,h.jsxs)(p.Z,{children:[(0,h.jsx)(Hi,{}),(0,h.jsx)(Jt,{}),(0,h.jsx)(g.Z,{children:(0,h.jsx)(en,{rating:t,handleSecondaryButtonClick:()=>{o(j.ew)},submitForm:(e,t)=>{if(a){const i={rating:e};t&&(i.comment=t),s(i)}else i(e),t&&n(t);o(j.ew)},secondaryButtonText:r("embeddable_framework.common.button.cancel")})}),(0,h.jsx)(f.Z,{})]})},nn={sendChatRating:_.cq,sendChatComment:_.Zf,sendLastChatRatingInfo:_.o8,endChat:_.Nl,updateChatScreen:_.a9};tn.propTypes={rating:s().object.isRequired,sendChatRating:s().func.isRequired,sendChatComment:s().func.isRequired,sendLastChatRatingInfo:s().func.isRequired,updateChatScreen:s().func.isRequired,isAgentEndedChatSession:s().bool.isRequired};const sn=(0,a.$j)((e=>({isChatting:(0,v.OQ)(e),rating:(0,v.sc)(e),isAgentEndedChatSession:(0,v.bc)(e)})),nn,null,{forwardRef:!0})(tn);var on=i(76572),an=i.n(on),rn=i(49072),ln=i.n(rn),dn=i(39163),cn=i.n(dn),hn=i(91676),mn=i.n(hn),pn=i(4014),un=i.n(pn),gn=i(85793),fn=i(5102),bn=i.n(fn),yn=i(57603),Cn=i.n(yn),xn=i(48718),wn=i(63781);const vn={file:s().shape({lastModified:s().number,lastModifiedDate:s().object,name:s().string.isRequired,size:s().number.isRequired,type:s().string.isRequired,webkitRelativePath:s().string})};var _n=i(13214);class jn extends o.Component{static propTypes={attachmentId:s().string.isRequired,className:s().string,downloading:s().bool,errorMessage:s().string,fakeProgress:s().bool,file:vn.file,filenameMaxLength:s().number,handleRemoveAttachment:s().func,isDownloadable:s().bool.isRequired,isRemovable:s().bool.isRequired,icon:s().string,uploading:s().bool.isRequired,uploadProgress:s().number,uploadRequestSender:s().object};static defaultProps={attachmentId:"",downloading:!1,fakeProgress:!1,icon:"",isDownloadable:!1,isRemovable:!1,uploading:!1,uploadProgress:0,uploadRequestSender:{}};handleIconClick=()=>{this.props.uploading&&this.props.uploadRequestSender.abort(),this.props.handleRemoveAttachment(this.props.attachmentId)};formatAttachmentSize=e=>{const t=Cn()([e,1e3]);return t>=1e6?Oe.a.t("embeddable_framework.submitTicket.attachments.size_megabyte",{size:bn()(t/1e6,1)}):Oe.a.t("embeddable_framework.submitTicket.attachments.size_kilobyte",{size:bn()(t/1e3)})};truncateFilename=(e,t,i)=>{if(e.length<=t)return e;return`${e.slice(0,t-i-1)}â€¦${e.slice(-i)}`};renderLinkedEl=(e,t)=>(0,h.jsx)("a",{className:_n.locals.link,target:"_blank",href:t,rel:"noopener noreferrer",children:e});renderSecondaryText(e,t,i,n){const s=this.formatAttachmentSize(e.size),o=(0,h.jsxs)("div",{children:[(0,h.jsx)("span",{className:_n.locals.downloadSize,children:s}),(0,h.jsx)("span",{className:_n.locals.downloadText,children:Oe.a.t("embeddable_framework.chat.chatLog.attachmentDownload")})]});let a;return a=n?Oe.a.t("embeddable_framework.chat.chatLog.uploading"):i?Oe.a.t("embeddable_framework.chat.chatLog.loadingImage",{attachmentSize:s}):t?this.renderLinkedEl(o,e.url):s,a}previewNameString=()=>{const{file:e,filenameMaxLength:t}=this.props;return t?this.truncateFilename(e.name,t,7):e.name};renderPreviewIcon=()=>{if(!this.props.icon)return null;const{file:e,isDownloadable:t}=this.props,i=(0,h.jsx)(gn.J,{type:this.props.icon,className:_n.locals.iconPreview});return t?this.renderLinkedEl(i,e.url):i};renderAttachmentBox(){const{file:e,downloading:t,errorMessage:i,isDownloadable:n,uploading:s}=this.props;if(i)return;const o=(0,h.jsx)("div",{className:_n.locals.previewName,children:this.previewNameString()}),a=(0,h.jsx)(gn.J,{onClick:this.handleIconClick,className:_n.locals.icon,type:"Icon--close"}),r=un()(_n.locals.container,this.props.className),l=(0,h.jsx)(wn.Z,{percentLoaded:this.props.uploadProgress,fakeProgress:this.props.fakeProgress});return(0,h.jsxs)("div",{className:r,"data-testid":`${d.z7.FILE_NAME}-${this.props.attachmentId||"attachment"}`,children:[(0,h.jsxs)("div",{className:_n.locals.preview,children:[this.renderPreviewIcon(),(0,h.jsxs)("div",{className:_n.locals.description,"data-testid":d.z7.DESCRIPTION,children:[n?this.renderLinkedEl(o,e.url):o,(0,h.jsx)("div",{className:_n.locals.secondaryText,children:this.renderSecondaryText(e,n,t,s)})]}),this.props.isRemovable&&a]}),s&&!i&&l]})}renderAttachmentError(){const{errorMessage:e}=this.props;if(e)return(0,h.jsxs)(xn.bZ,{type:"error",role:"alert",className:_n.locals.containerError,"data-testid":d.z7.ERROR_MSG,children:[(0,h.jsx)(xn.Dx,{className:_n.locals.previewError,children:this.previewNameString()}),(0,h.jsx)("div",{className:_n.locals.secondaryTextError,children:e}),(0,h.jsx)(xn.x8,{onClick:this.handleIconClick})]})}render(){return(0,h.jsxs)("div",{children:[this.renderAttachmentBox(),this.renderAttachmentError()]})}}var Sn=i(744),kn=i(78473),Tn=i(51221);const Pn=void 0!==kn._v.ResizeObserver;class In extends o.Component{static propTypes={children:s().arrayOf(s().element).isRequired,speed:s().number,variableWidth:s().bool,infinite:s().bool,slidesToScroll:s().number,slidesToShow:s().number,className:s().string,onClick:s().func,slider:s().func,arrows:s().bool};static defaultProps={speed:500,variableWidth:!1,infinite:!1,slidesToScroll:1,slidesToShow:1,arrows:!0};constructor(e){super(e),this.currentPageIndex=0,this.pages=[],this.itemIndexToPageIndex={},this.isAnimating=!1,this.isFocused=!1,this.isMouseDown=!1}componentDidMount(){this.props.variableWidth&&(this.sliderEle=Sn.findDOMNode(this.slider),this.calculatePagesInfo(),this.slickTrack=En(this.child0,"slick-track")),Pn||kn._v.addEventListener("orientationchange",this.handleOrientationChange)}componentDidUpdate(){var e,t;this.props.variableWidth&&(this.updateSliderArrows(this.currentPageIndex),(e=this.sliderEle,t="slick-list",Ze()(e.children,(e=>e.classList.contains(t)))).scrollLeft=0)}componentWillUnmount(){Pn||kn._v.removeEventListener("orientationchange",this.handleOrientationChange)}handleOrientationChange=()=>{this.forceUpdate()};calculatePagesInfo(){const e=this.sliderEle.clientWidth;let t=0,i=0,n=0;this.pages.push({canGoToPrevPage:!1,canGoToNextPage:!0,cssTransformVal:0});for(let s=0;s<this.props.children.length;s++){const o=Nn(this[`child${s}`]);t+=o,t<=e?this.itemIndexToPageIndex[s]=i:(this.itemIndexToPageIndex[s]=++i,this.pages.push({canGoToPrevPage:!0,canGoToNextPage:!0,cssTransformVal:n}),t=o),n+=o}const s=this.pages[this.pages.length-1];s.canGoToNextPage=!1,s.cssTransformVal=n-e}goTo=e=>{if(!(e===this.currentPageIndex||this.isAnimating||e<0||e>=this.pages.length)){if(this.props.variableWidth){const{cssTransformVal:t}=this.pages[e];this.slickTrack.style.transition=this.isFocused?"":`transform ${this.props.speed}ms ease 0s`,this.slickTrack.style.transform=`translate3d(${-t}px, 0, 0)`,this.updateSliderArrows(e),this.animateLock()}else this.slider.slickGoTo(e,this.isFocused);this.currentPageIndex=e}};updateSliderArrows=e=>{const{canGoToPrevPage:t,canGoToNextPage:i}=this.pages[e];t?this.slickTrack.parentElement.previousSibling.classList.remove("slick-disabled"):function(e){e.parentElement.previousSibling.classList.add("slick-disabled")}(this.slickTrack),i?function(e){e.parentElement.nextSibling.classList.remove("slick-disabled")}(this.slickTrack):function(e){e.parentElement.nextSibling.classList.add("slick-disabled")}(this.slickTrack)};goNext=()=>{this.goTo(this.currentPageIndex+1)};goPrev=()=>{this.goTo(this.currentPageIndex-1)};animateLock=()=>{this.isAnimating=!this.isFocused,setTimeout((()=>{this.isAnimating=!1}),this.props.speed)};render(){const e=this.props.slider,t=o.Children.map(this.props.children,((e,t)=>(0,o.cloneElement)(e,{className:un()(e.props.className,Tn.locals.item),ref:e=>{this[`child${t}`]=Sn.findDOMNode(e)},onMouseDown:()=>{this.isMouseDown=!0},onMouseUp:()=>{this.isMouseDown=!0},onFocus:()=>{if(this.isMouseDown)return;this.isFocused=!0;const e=this.itemIndexToPageIndex[t];this.goTo(e)},onBlur:()=>{this.isFocused=!1}}))),i=e=>{const{className:t,onClick:i}=e;return(0,h.jsx)(ee.hU,{size:"small",className:un()(Tn.locals.sliderButton,Tn.locals["sliderButton--right"],t),onClick:this.props.variableWidth?this.goNext:i,children:(0,h.jsx)(gn.J,{type:"Icon--chevron-right-fill"})})},n=e=>{const{className:t,onClick:i}=e;return(0,h.jsx)(ee.hU,{size:"small",className:un()(Tn.locals.sliderButton,Tn.locals["sliderButton--left"],t),onClick:this.props.variableWidth?this.goPrev:i,children:(0,h.jsx)(gn.J,{type:"Icon--chevron-left-fill"})})},s={speed:this.props.speed,infinite:this.props.infinite,variableWidth:this.props.variableWidth,slidesToScroll:this.props.slidesToScroll,slidesToShow:this.props.slidesToShow,draggable:!1,arrows:this.props.arrows,nextArrow:(0,h.jsx)(i,{}),prevArrow:(0,h.jsx)(n,{})};return(0,h.jsx)(e,{...s,ref:e=>{this.slider=e},className:this.props.variableWidth?"variableWidth":"",children:t})}}function En(e,t){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;if(1===i||arguments.length>2&&void 0!==arguments[2]&&arguments[2])return e;const n=e.parentElement;return n.classList.contains(t)?En(n,t,!0,i--):En(n,t,!1,i--)}function Nn(e){const t=En(e,"slick-slide");return t.clientWidth+function(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?parseFloat(window.getComputedStyle(e)[t]):window.getComputedStyle(e)[t]}(t,"margin-right",!0)}const Rn=(0,a.$j)((e=>({slider:(0,v.b7)(e)})),null,null,{forwardRef:!0})(In);var An=i(83678);class Ln extends o.Component{static propTypes={children:s().arrayOf(s().element).isRequired,isMobile:s().bool};static defaultProps={isMobile:!1};constructor(e){super(e)}render=()=>{const e=un()("structuredMessageSlider",An.locals.carouselSlider),t={arrows:!this.props.isMobile};return(0,h.jsx)("div",{className:e,children:(0,h.jsx)(Rn,{...t,children:this.props.children})})}}var Mn=i(33530),zn=i.n(Mn),Zn=i(46958),On=i(4490);const qn=(0,r.K1)();class Dn extends o.Component{static propTypes={children:s().node.isRequired};render(){const e=un()(On.locals.buttonItem,{[On.locals.overwriteState]:qn});return(0,h.jsx)("ul",{className:On.locals.buttonList,children:this.props.children.map(((t,i)=>(0,h.jsx)("li",{className:e,children:t},i)))})}}var Bn=i(6422);class Hn extends o.Component{static propTypes={children:s().node.isRequired,className:s().string};render(){return(0,h.jsx)("div",{className:un()(Bn.locals.card,this.props.className),children:this.props.children})}}class Fn extends o.Component{static propTypes={children:s().node.isRequired,message:s().string,className:s().string};static defaultProps={message:""};render(){const{message:e,children:t,className:i}=this.props;return(0,h.jsxs)(Hn,{className:i,children:[(0,h.jsx)("div",{className:Zn.locals.message,children:e}),(0,h.jsx)(Dn,{children:t})]})}}var Kn=i(3351),Un=i(78523);const Vn=(0,r.K1)();class $n extends o.Component{static propTypes={label:s().string.isRequired,onClick:s().func};render(){const e=un()(Un.locals.button,{[Un.locals.overwriteState]:Vn});return(0,h.jsx)(Kn.K,{className:e,onClick:this.props.onClick,title:this.props.label,children:this.props.label})}}const{QUICK_REPLY_ACTION:Gn,LINK_ACTION:Wn}=I.CHAT_STRUCTURED_MESSAGE_ACTION_TYPE,Qn=s().shape({type:s().oneOf([Gn,Wn]).isRequired,value:s().string.isRequired}),Xn={text:s().string.isRequired,action:Qn.isRequired},Yn=s().shape(Xn);class Jn extends o.Component{static propTypes={...Xn,createAction:s().func};render(){const{text:e,createAction:t,action:i}=this.props;return(0,h.jsx)($n,{label:e,onClick:t(i)})}}var es=i(11088);class ts extends o.Component{static propTypes={...ts.schemaPropTypes,createAction:s().func.isRequired,className:s().string,isMobile:s().bool};static defaultProps={msg:""};static schemaPropTypes={buttons:s().arrayOf(Yn).isRequired,msg:s().string};render(){const{createAction:e}=this.props,t=this.props.buttons.map(((t,i)=>(0,o.createElement)(Jn,{...t,key:i,createAction:e}))),i=un()({[es.locals.mobile]:this.props.isMobile});return(0,h.jsx)(Fn,{message:this.props.msg,className:i,children:t})}}var is=i(8073),ns=i(22673);const ss=e=>{let{className:t,onClick:i,children:n}=e;return i?(0,h.jsx)(Kn.K,{className:t,onClick:i,children:n}):(0,h.jsx)("div",{className:t,children:n})};ss.propTypes={className:s().string,onClick:s().func,children:s().node};const os=s().shape({heading:s().string.isRequired,paragraph:s().string,imageUrl:s().string,imageAspectRatio:s().number,headingLineClamp:s().number,paragraphLineClamp:s().number,onClick:s().func,layout:s().oneOf(["thumbnail"]),align:s().oneOf(["left","right"]),withBorderBottom:s().bool}),as=function(e){return(0,r.vU)()?16*e/d.Kt+"rem":"auto"};class rs extends o.Component{static propTypes={panel:os};static defaultProps={panel:{headingLineClamp:2,paragraphLineClamp:2,imageAspectRatio:2,layout:"hero",roundedTop:!1,roundedBottom:!1,withBorderBottom:!0}};renderHeroImage(e){if("hero"===e.layout&&e.imageUrl)return this.renderImage({containerClassNames:ns.locals.imageContainer,panel:e})}renderPanelContent(e){const t=un()(ns.locals.panelHeading,ns.locals.lineClamp),i=un()(ns.locals.panelParagraph,ns.locals.lineClamp),n={WebkitLineClamp:e.headingLineClamp,maxHeight:as(e.headingLineClamp)},s={WebkitLineClamp:e.paragraphLineClamp,maxHeight:as(e.paragraphLineClamp)},o="thumbnail"===e.layout?un()(ns.locals.floatedPanelContent,{[ns.locals.floatLeft]:"right"===e.align,[ns.locals.floatRight]:"left"===e.align}):"";return(0,h.jsxs)("div",{className:ns.locals.panelContent,children:[this.renderThumbnail(e),(0,h.jsxs)("div",{className:o,children:[(0,h.jsx)("div",{className:t,style:n,"data-testid":d.z7.STR_MSG_PANEL_HEADING,children:e.heading}),e.paragraph?(0,h.jsx)("div",{className:i,style:s,children:e.paragraph}):null]})]})}renderThumbnail(e){if("thumbnail"!==e.layout)return;const t=un()(ns.locals.panelContentImage,{[ns.locals.floatLeft]:"left"===e.align,[ns.locals.floatRight]:"right"===e.align});return this.renderImage({containerClassNames:t,panel:e})}renderImage(e){let{containerClassNames:t,panel:i}=e;const n={paddingBottom:1/i.imageAspectRatio*100+"%"},s={backgroundImage:`url(${i.imageUrl})`},o=un()(ns.locals.imagePlaceholder,{[ns.locals.scaleUp]:"hero"===i.layout});return(0,h.jsxs)("div",{className:t,children:[(0,h.jsx)("div",{className:ns.locals.aspectRatioStub,style:n}),(0,h.jsx)("div",{className:o,children:(0,h.jsx)(gn.J,{type:"Icon--image-stroke"})}),(0,h.jsx)("div",{className:ns.locals.image,style:s})]})}render(){const e={...rs.defaultProps.panel,...this.props.panel},t=un()(ns.locals.panel,{[ns.locals.hasLink]:e.onClick,[ns.locals.noBorderRadiusTop]:!e.roundedTop,[ns.locals.noBorderRadiusBottom]:!e.roundedBottom,[ns.locals.noBorderBottom]:!e.withBorderBottom});return(0,h.jsxs)(ss,{className:t,onClick:e.onClick,children:[this.renderHeroImage(e),this.renderPanelContent(e)]})}}const ls=s().shape({heading:s().string.isRequired,paragraph:s().string.isRequired,imageUrl:s().string,headingLineClamp:s().number,onClick:s().func,layout:s().oneOf(["hero","thumbnail"]),align:s().oneOf(["left","right"]),roundedTop:s().bool,roundedBottom:s().bool,withBorderBottom:s().bool});class ds extends o.Component{static propTypes={items:s().arrayOf(ls).isRequired,buttons:s().node,isMobile:s().bool.isRequired};static defaultProps={buttons:[],isMobile:!1};render(){const{items:e,buttons:t}=this.props,i=un()(is.locals.cardContainer,{[is.locals.mobile]:this.props.isMobile});return(0,h.jsxs)(Hn,{className:i,children:[(0,h.jsx)("ul",{className:is.locals.panelList,children:e.map(((i,n)=>(i.withBorderBottom=!1,n?n===e.length-1&&(i.roundedBottom=0===t.length,i.withBorderBottom=!0):i.roundedTop=!0,(0,h.jsx)("li",{children:(0,h.jsx)(rs,{panel:i})},n))))}),(0,h.jsx)(Dn,{children:t})]})}}const{LINK_ACTION:cs}=I.CHAT_STRUCTURED_MESSAGE_ACTION_TYPE,hs=s().shape({type:s().oneOf([cs]).isRequired,value:s().string.isRequired}),ms=s().shape({heading:s().string.isRequired,paragraph:s().string.isRequired,image_url:s().string,action:hs.isRequired,isMobile:s().bool.isRequired});class ps extends o.Component{static propTypes={...ps.schemaPropTypes,createAction:s().func.isRequired};static defaultProps={items:[],buttons:[],isMobile:!1};static schemaPropTypes={items:s().arrayOf(ms).isRequired,buttons:s().arrayOf(Yn)};render(){const{createAction:e}=this.props,t=this.props.buttons&&this.props.buttons.map(((t,i)=>(0,o.createElement)(Jn,{...t,key:i,createAction:e}))),i=this.props.items.map((t=>({...t,onClick:e(t.action),imageUrl:t.image_url,layout:"thumbnail",align:"right",headingLineClamp:1})));return(0,h.jsx)(ds,{items:i,buttons:t,isMobile:this.props.isMobile})}}var us=i(70644),gs=i.n(us);class fs extends o.Component{static propTypes={panel:os,children:s().node,className:s().string};static defaultProps={children:[],panel:{roundedTop:!0}};render(){const e={...fs.defaultProps.panel,...this.props.panel};return e.roundedBottom=0===this.props.children.length,(0,h.jsxs)(Hn,{className:this.props.className,children:[(0,h.jsx)(rs,{panel:e}),(0,h.jsx)(Dn,{children:this.props.children})]})}}var bs=i(14500);const{LINK_ACTION:ys}=I.CHAT_STRUCTURED_MESSAGE_ACTION_TYPE,Cs=s().shape({type:s().oneOf([ys]).isRequired,value:s().string.isRequired}),xs=s().shape({heading:s().string.isRequired,paragraph:s().string,image_url:s().string,action:Cs});class ws extends o.Component{static propTypes={...ws.schemaPropTypes,createAction:s().func.isRequired,isMobile:s().bool.isRequired,inCarousel:s().bool};static defaultProps={buttons:[],inCarousel:!1};static schemaPropTypes={panel:xs,buttons:s().arrayOf(Yn)};render(){const{createAction:e}=this.props,t=this.props.buttons&&this.props.buttons.map(((t,i)=>(0,o.createElement)(Jn,{...t,key:i,createAction:e}))),i={...gs()(this.props.panel,["heading","paragraph"]),imageUrl:this.props.panel.image_url,onClick:this.props.panel.action?e(this.props.panel.action):null},n=un()({[bs.locals.mobileInCarousel]:this.props.inCarousel&&this.props.isMobile,[bs.locals.mobile]:!this.props.inCarousel&&this.props.isMobile});return(0,h.jsx)(fs,{panel:i,className:n,children:t})}}class vs extends o.Component{static propTypes={sendMsg:s().func,schema:s().oneOfType([s().shape(zn()({type:s().string.isRequired},ts.schemaPropTypes)),s().shape(zn()({type:s().string.isRequired},ws.schemaPropTypes)),s().shape(zn()({type:s().string.isRequired},ps.schemaPropTypes))]).isRequired,isMobile:s().bool.isRequired,inCarousel:s().bool};createAction=e=>{let{type:t,value:i}=e;const{QUICK_REPLY_ACTION:n,LINK_ACTION:s}=I.CHAT_STRUCTURED_MESSAGE_ACTION_TYPE;switch(t){case n:return()=>{this.props.sendMsg(i)};case s:return()=>{kn._v.open(i)};default:return}};render(){const{schema:{type:e}}=this.props,t=I.u_.CHAT_STRUCTURED_MESSAGE_TYPE;switch(e){case t.BUTTON_TEMPLATE:const{buttons:e,msg:i}=this.props.schema;return(0,h.jsx)(ts,{buttons:e,msg:i,createAction:this.createAction,isMobile:this.props.isMobile});case t.PANEL_TEMPLATE:return(0,h.jsx)(ws,{...this.props.schema,createAction:this.createAction,isMobile:this.props.isMobile,inCarousel:this.props.inCarousel});case t.LIST_TEMPLATE:return(0,h.jsx)(ps,{...this.props.schema,isMobile:this.props.isMobile,createAction:this.createAction})}}}const _s={sendMsg:_.g_},js=(0,a.$j)(null,_s,null,{forwardRef:!0})(vs);class Ss extends o.Component{static propTypes={items:s().array.isRequired,isMobile:s().bool};static defaultProps={isMobile:!1};render(){const e=this.props.items.map(((e,t)=>(0,h.jsx)(js,{schema:e,isMobile:this.props.isMobile,inCarousel:!0},t)));return(0,h.jsx)(Ln,{isMobile:this.props.isMobile,children:e})}}var ks=i(61206);const Ts=(0,E.ZP)(bt.$j).withConfig({displayName:"styles__StyledSpinner",componentId:"sc-1ynxsac-0"})(["color:"," !important;"],(e=>e.theme.palette.grey[500])),Ps=E.ZP.div.withConfig({displayName:"styles__ImageContainer",componentId:"sc-1ynxsac-1"})(["display:flex;flex-direction:column;justify-content:center;align-items:center;background:",";border:","rem solid ",";border-radius:","rem;width:","rem;height:","rem;"],(e=>e.theme.palette.grey[200]),(e=>1/e.theme.fontSize),(e=>e.theme.palette.grey[300]),(e=>8/e.theme.fontSize),(e=>150/e.theme.fontSize),(e=>113/e.theme.fontSize)),Is=E.ZP.img.withConfig({displayName:"styles__StyledImage",componentId:"sc-1ynxsac-2"})(["display:flex;flex-direction:column;align-items:center;background:",";border:","rem solid ",";border-radius:","rem;background-position:center;background-size:cover;width:","rem;height:","rem;"],(e=>e.theme.palette.grey[200]),(e=>1/e.theme.fontSize),(e=>e.theme.palette.grey[300]),(e=>8/e.theme.fontSize),(e=>150/e.theme.fontSize),(e=>113/e.theme.fontSize)),Es=E.ZP.a.withConfig({displayName:"styles__Link",componentId:"sc-1ynxsac-3"})(["&:hover,&:active,&:focus{text-decoration:none !important;}"]),Ns=e=>{let{placeholderEl:t,onImageLoad:i,file:n}=e;const[s,o]=(0,ks.Z)(!1),a=new Image;a.src=n.url,a.onload=()=>{s||(o(!0),i())};const r=t||(0,h.jsx)(Ps,{children:(0,h.jsx)(Ts,{size:"4rem"})}),l=(0,h.jsx)(Es,{"data-testid":d.z7.IMAGE_MESSAGE_LINK,target:"_blank",href:n.url,children:(0,h.jsx)(Is,{src:a.src})});return s?l:r};Image.propTypes={url:s().string.isRequired},Ns.propTypes={placeholderEl:s().element,onImageLoad:s().func.isRequired,file:vn.file.isRequired};const Rs=Ns,As=(0,E.ZP)(Kn.K).withConfig({displayName:"styles__Button",componentId:"sc-xvmuf7-0"})(["border:none;background:none;width:100%;text-align:inherit;"]),Ls=E.ZP.ul.withConfig({displayName:"styles__OptionsList",componentId:"sc-xvmuf7-1"})(["&&&{display:block;}"]),Ms=E.ZP.li.withConfig({displayName:"styles__ListItem",componentId:"sc-xvmuf7-2"})(["color:",";line-height:","rem;padding:","rem ","rem;transition:background-color 250ms ease-out;border:","rem "," solid;border-top:none;max-width:","rem;&:hover{background-color:",";cursor:pointer;transition:background-color 250ms ease-in;color:",";}&:last-child{border-bottom-left-radius:","rem;border-bottom-right-radius:","rem;}"],(e=>e.theme.listColorStr),(e=>16/e.theme.fontSize),(e=>8/e.theme.fontSize),(e=>12/e.theme.fontSize),(e=>1/e.theme.fontSize),(e=>e.theme.palette.grey[200]),(e=>219/e.theme.fontSize),(e=>e.theme.palette.grey[200]),(e=>e.theme.listHighlightColorStr),(e=>16/e.theme.fontSize),(e=>16/e.theme.fontSize)),zs=e=>{let{options:t=[],onSelect:i}=e;return(0,h.jsx)(Ls,{children:t.map(((e,t)=>(0,h.jsx)(Ms,{children:(0,h.jsx)(As,{onClick:()=>i(e),children:(0,h.jsx)("div",{"data-testid":d.z7.MESSAGE_OPTION,children:e})})},`${e}-${t}`)))})};zs.propTypes={options:s().arrayOf(s().string),onSelect:s().func.isRequired};const Zs=zs,Os=E.ZP.div.withConfig({displayName:"styles__Container",componentId:"sc-97fe4c-0"})(["&&&{display:flex;flex-direction:column;}"]),qs=E.ZP.div.withConfig({displayName:"styles__MessageContainer",componentId:"sc-97fe4c-1"})(["display:inline-block;white-space:pre-wrap;word-wrap:break-word !important;border-radius:","rem;line-height:","rem;padding:","rem ","rem;max-width:","rem;"," "," ",""],(e=>16/e.theme.fontSize),(e=>16/e.theme.fontSize),(e=>8/e.theme.fontSize),(e=>12/e.theme.fontSize),(e=>245/e.theme.fontSize),(e=>!e.isAgent&&(0,E.iv)(["background-color:"," !important;&,a{color:"," !important;}"],e.theme.buttonColorStr,e.theme.buttonTextColorStr)),(e=>e.isAgent&&(0,E.iv)(["background-color:",";max-width:","rem !important;"],e.theme.palette.grey[200],219/e.theme.fontSize)),(e=>e.hasOptions&&(0,E.iv)(["border-bottom-left-radius:0;border-bottom-right-radius:0;border:","rem #f3f3f3 solid;"],1/e.theme.fontSize))),Ds=E.ZP.span.withConfig({displayName:"styles__Message",componentId:"sc-97fe4c-2"})([""]),Bs=(0,E.ZP)(ee.zx).attrs((()=>({isLink:!0,ignoreThemeOverride:!0}))).withConfig({displayName:"styles__TranslateLink",componentId:"sc-97fe4c-3"})(["&&&{margin-left:","rem;transition:100ms ease;border-bottom:","rem solid transparent;background-color:transparent;[dir='rtl'] &{margin-right:","rem;margin-left:0;}&:hover{border-color:",";cursor:pointer;text-decoration:none !important;}}"],(e=>5/e.theme.fontSize),(e=>1/e.theme.fontSize),(e=>5/e.theme.fontSize),(e=>e.theme.palette.blue[400])),Hs=(0,E.ZP)(ee.ee).attrs((()=>({ignoreThemeOverride:!0}))).withConfig({displayName:"styles__MessageBubbleLink",componentId:"sc-97fe4c-4"})(["user-select:auto !important;"]),Fs=e=>{let{message:t,translatedMessage:i,isAgent:n,options:s=[],onOptionSelect:a}=e;const r=(0,M.Z)(),[l,c]=(0,o.useState)(!0),m=(l?i:t)||t;return(0,h.jsxs)(Os,{"data-testid":n?d.z7.CHAT_MSG_AGENT:d.z7.CHAT_MSG_USER,children:[(0,h.jsxs)(qs,{isAgent:n,hasOptions:s.length>0,children:[(0,h.jsx)(Ds,{children:(0,h.jsx)(K.ZP,{properties:{target:"_blank",link:!0},component:Hs,children:m})}),i&&(0,h.jsx)(Bs,{"data-testid":d.z7.TRANSLATE_LINK,onClick:()=>{c(!l)},children:r(l?"embeddable_framework.chat.show_original":"embeddable_framework.chat.show_translated")})]}),s.length>0&&(0,h.jsx)(Zs,{onSelect:a,options:s})]})};Fs.propTypes={message:s().string,translatedMessage:s().string,isAgent:s().bool,options:s().arrayOf(s().string),onOptionSelect:s().func.isRequired};const Ks=Fs,Us=(0,E.ZP)(xn.bZ).withConfig({displayName:"styles__Container",componentId:"sc-sknllr-0"})(["margin-bottom:$spacing-tny;display:inline-block;float:",";&&&{background-color:transparent;color:",";background-position:","rem ","rem;border:none;font-size:","rem;padding-bottom:","rem;padding-top:0;background-size:","rem;",":0rem;",":","rem;}"],(e=>e.theme.rtl?"left":"right"),(e=>e.theme.palette.red[500]),(e=>14/e.theme.fontSize),(e=>3/e.theme.fontSize),(e=>14/e.theme.fontSize),(e=>12/e.theme.fontSize),(e=>14/e.theme.fontSize),(e=>e.theme.rtl?"padding-left":"padding-right"),(e=>e.theme.rtl?"padding-right":"padding-left"),(e=>42/e.theme.fontSize)),Vs=E.ZP.span.withConfig({displayName:"styles__ErrorSpan",componentId:"sc-sknllr-1"})(["display:inline-block;line-height:#{18 / $font-size}rem;max-width:calc( ","rem - ","rem );"],(e=>202/e.theme.fontSize),(e=>19/e.theme.fontSize)),$s=E.ZP.button.withConfig({displayName:"styles__ErrorButton",componentId:"sc-sknllr-2"})(["background-color:transparent;border:none;cursor:pointer;text-decoration:none;margin:0;padding:0;color:",";cursor:pointer;text-decoration:underline;&:hover,&:focus,&:active{color:",";}line-height:","rem;max-width:calc( ","rem - ","rem );"],(e=>e.theme.palette.red[500]),(e=>e.theme.palette.red[500]),(e=>18/e.theme.fontSize),(e=>202/e.theme.fontSize),(e=>19/e.theme.fontSize)),Gs=e=>{let{errorMessage:t,onClick:i}=e;return(0,h.jsx)(Us,{type:"error",role:"alert",children:i?(0,h.jsx)($s,{onClick:i,children:t}):(0,h.jsx)(Vs,{children:t})})};Gs.propTypes={errorMessage:s().string.isRequired,onClick:s().func};const Ws=Gs,Qs={chatMessage:s().shape({type:s().oneOf(mn()(I.Fy)).isRequired,timestamp:s().number.isRequired,nick:s().string.isRequired,display_name:s().string.isRequired,msg:s().string,options:s().arrayOf(s().string),file:vn.file,attachment:s().shape({mime_type:s().string,name:s().string,size:s().number,url:s().string})}),chatLogEntry:s().shape({type:s().oneOf(["message","event"]).isRequired,author:s().string.isRequired,messages:s().arrayOf(s().number)})};var Xs=i(85004);const Ys=mn()(I.u_.CHAT_STRUCTURED_MESSAGE_TYPE);class Js extends o.Component{static propTypes={messages:s().arrayOf(Qs.chatMessage),isAgent:s().bool.isRequired,showAvatar:s().bool.isRequired,handleSendMsg:s().func,onImageLoad:s().func,chatLogCreatedAt:s().number,socialLogin:s().object,avatarPath:s().string,children:s().object,isMobile:s().bool.isRequired};static defaultProps={messages:[],isAgent:!1,handleSendMsg:()=>{},onImageLoad:()=>{},chatLogCreatedAt:0,socialLogin:{},avatarPath:""};constructor(e){super(e),this.container=null}state={shouldShowAvatar:!1};static getDerivedStateFromProps(e,t){const i=!!e.socialLogin.avatarPath&&""!==e.socialLogin.avatarPath,n=e.showAvatar&&(e.isAgent||i);return n!==t.shouldShowAvatar?{shouldShowAvatar:n}:null}renderName=(e,t,i)=>{const n=cn()(i,"0.display_name"),s=cn()(i,"0.timestamp")>this.props.chatLogCreatedAt,o=un()({[Xs.locals.nameAvatar]:t,[Xs.locals.nameNoAvatar]:!t,[Xs.locals.fadeIn]:s});return e&&n?(0,h.jsx)("div",{className:o,children:n}):null};renderChatMessages=(e,t,i)=>{let n=un()(Xs.locals.message,{[Xs.locals.messageUser]:!e,[Xs.locals.messageAgent]:e});return i.map((i=>{let s;if(i.msg)if(i.structured_msg&&Ys?.includes(i.structured_msg.type))n=un()(n,Xs.locals.structuredMessageContainer),s=this.renderStructuredMessage(i.structured_msg);else if(i.structured_msg&&Object.values(I.u_.CAROUSEL).includes(i.structured_msg.type))n=un()(n,{[Xs.locals.carouselContainer]:!this.props.isMobile,[Xs.locals.carouselMobileContainer]:this.props.isMobile}),s=this.renderCarousel(i.structured_msg.items);else if(i.structured_msg&&i.structured_msg.type===I.u_.QUICK_REPLIES){const n={...i,msg:i.structured_msg.msg,options:[]};s=this.renderPrintedMessage(n,e,t)}else s=this.renderPrintedMessage(i,e,t);else(i.file||i.attachment)&&(s=this.renderInlineAttachment(e,i));const o=i.timestamp>this.props.chatLogCreatedAt,a=un()(Xs.locals.wrapper,{[Xs.locals.avatarAgentWrapper]:this.state.shouldShowAvatar&&this.props.isAgent,[Xs.locals.avatarEndUserWrapper]:this.state.shouldShowAvatar&&!this.props.isAgent,[Xs.locals.fadeUp]:o});return(0,h.jsx)("div",{className:a,children:(0,h.jsx)("div",{className:n,children:s})},i.timestamp)}))};renderMessageBubble=(e,t)=>{const{msg:i,options:n,translation:s}=e;return(0,h.jsx)(Ks,{isAgent:t,message:i,options:n,translatedMessage:s?.msg,onOptionSelect:this.props.handleSendMsg})};renderErrorMessage=(e,t)=>{const{numFailedTries:i,msg:n,timestamp:s}=e,o=1===i?(0,h.jsx)(Ws,{errorMessage:Oe.a.t("embeddable_framework.chat.messagefailed.resend"),onClick:()=>this.props.handleSendMsg(n,s)}):(0,h.jsx)(Ws,{errorMessage:Oe.a.t("embeddable_framework.chat.messagefailed.failed_twice")});return(0,h.jsxs)("div",{children:[this.renderMessageBubble(e,t),o]})};renderDefaultMessage=(e,t)=>{const i=e.status===I.eU.CHAT_MESSAGE_SUCCESS?(0,h.jsx)(gn.J,{className:Xs.locals.sentIndicator,type:"Icon--mini-tick"}):null;return(0,h.jsxs)("div",{className:Xs.locals.defaultMessageContainer,children:[i,this.renderMessageBubble(e,t)]})};renderPrintedMessage=(e,t,i)=>e.status===I.eU.CHAT_MESSAGE_FAILURE?this.renderErrorMessage(e,t,i):this.renderDefaultMessage(e,t,i);renderInlineAttachment=(e,t)=>{let i;const n=t.file?t.file:{...t.attachment,type:t.attachment.mime_type},s=n.name.split(".").pop().toUpperCase(),o=d.o4[s]||d.UZ.PREVIEW_DEFAULT,a=/(gif|jpe?g|png)$/i.test(s),r=un()(Xs.locals.attachment,{[Xs.locals.attachmentError]:!!n.error});if(i=(0,h.jsx)(jn,{className:r,downloading:!n.error&&!n.uploading&&a,fakeProgress:!0,file:n,filenameMaxLength:20,icon:o,isDownloadable:!n.error&&!n.uploading,uploading:!n.error&&n.uploading}),n.error&&n.error.message){const e=I.bQ[n.error.message]||I.bQ.UNKNOWN_ERROR,t=Oe.a.t(`embeddable_framework.chat.attachments.error.${e}`);return(0,h.jsxs)("div",{children:[i,(0,h.jsx)(Ws,{errorMessage:t})]})}if(!n.uploading&&a){const t=e?null:i;return(0,h.jsx)(Rs,{file:n,placeholderEl:t,onImageLoad:this.props.onImageLoad})}return i};renderAvatar=e=>{if(!this.state.shouldShowAvatar)return;const t=cn()(e,"0.timestamp")>this.props.chatLogCreatedAt,i=this.props.isAgent?this.props.avatarPath:this.props.socialLogin.avatarPath,n=un()({[Xs.locals.avatar]:!0,[Xs.locals.agentAvatar]:this.props.isAgent,[Xs.locals.endUserAvatar]:!this.props.isAgent,[Xs.locals.fadeIn]:t});return(0,h.jsx)(Z.q,{className:n,src:i,fallbackIcon:"Icon--agent-avatar"})};renderStructuredMessage=e=>(0,h.jsx)(js,{schema:e,isMobile:this.props.isMobile});renderCarousel=e=>(0,h.jsx)(Ss,{items:e,isMobile:this.props.isMobile});render(){const{isAgent:e,messages:t,showAvatar:i}=this.props;return(0,h.jsxs)("div",{ref:e=>{this.container=e},className:Xs.locals.container,children:[this.renderName(e,i,t),this.renderChatMessages(e,i,t),this.renderAvatar(t),this.props.children]})}}const eo=(0,a.$j)(((e,t)=>({messages:(0,w.S7)(e,t.messageKeys)})),{},null,{forwardRef:!0})(Js),to=E.ZP.div.withConfig({displayName:"styles__Message",componentId:"sc-46lcwk-0"})(["text-align:center;margin-top:","rem;margin-bottom:","rem;color:",";",""],(e=>5/e.theme.fontSize),(e=>10/e.theme.fontSize),(e=>e.theme.palette.grey[600]),(e=>{if(e.showAnimation)return(0,E.iv)(["animation:fadeIn 200ms 1 ease-in-out;@keyframes fadeIn{0%{opacity:0;}100%{opacity:1;}}"])})),io=(e,t)=>{const i=!!(e.nick&&e.nick.indexOf("agent:")>-1);switch(e.type){case"chat.memberjoin":return i?t("embeddable_framework.chat.chatLog.agentJoined",{agent:e.display_name}):t("embeddable_framework.chat.chatLog.chatStarted");case"chat.memberleave":return i?t(I.me?.includes(e.reason)?"embeddable_framework.chat.chatLog.agentDisconnected":"embeddable_framework.chat.chatLog.agentLeft",{agent:e.display_name}):t("embeddable_framework.chat.chatLog.chatEnded");case"chat.rating":const n=e.new_rating,s=e.rating;if(!n)return s?t("embeddable_framework.chat.chatLog.rating.removed"):void 0;const o=t(`embeddable_framework.chat.chatLog.rating.${n}`);return t("embeddable_framework.chat.chatLog.rating.description",{value:o});case"chat.comment":return t("embeddable_framework.chat.chatlog.comment.submitted");case"chat.contact_details.updated":return t("embeddable_framework.chat.contact_details.updated")}},no=e=>{let{event:t={},children:i,divider:n=null,chatLogCreatedAt:s=0}=e;const o=(0,M.Z)();return(0,h.jsxs)(to,{"data-testid":d.z7.CHAT_MSG_EVENT,showAnimation:t.timestamp>s,children:[n,io(t,o),i]},t.timestamp)};no.propTypes={event:s().shape({timestamp:s().number,nick:s().string,type:s().string,display_name:s().string}),children:s().node,divider:s().node,chatLogCreatedAt:s().number};const so=(0,a.$j)(((e,t)=>({event:t.isHistory?(0,v.Qb)(e,t.eventKey):(0,v.Tm)(e,t.eventKey)})),{},null)(no),oo=(0,E.ZP)(ee.zx).withConfig({displayName:"styles__StyledButton",componentId:"sc-fx94fs-0"})(["margin-top:","rem !important;"],(e=>10/e.theme.fontSize)),ao=e=>{let{eventKey:t,onClick:i,canRateChat:n,activeAgentCount:s,chatRating:o,latestRating:a,latestRatingRequest:r,latestAgentLeaveEvent:l}=e;const d=(0,M.Z)(),c=((e,t,i,n,s,o)=>{const a=n===e,r=s===e,l=t<1&&o===e,d=i.value||i.comment,c=l&&!d,h=a&&!i.comment;if((r||c||h)&&!(e<Math.max(n,s,o)))return-1!==n&&i.value&&h?"embeddable_framework.chat.chatLog.button.leaveComment":"embeddable_framework.chat.chatLog.button.rateChat"})(t,s,o,a,r,l);return n&&c?(0,h.jsx)("div",{children:(0,h.jsx)(oo,{"aria-label":d(c),onClick:i,children:d(c)})}):null};ao.propTypes={onClick:s().func.isRequired,eventKey:s().number.isRequired,canRateChat:s().bool.isRequired,latestRating:s().number.isRequired,latestRatingRequest:s().number.isRequired,latestAgentLeaveEvent:s().number.isRequired,activeAgentCount:s().number.isRequired,chatRating:Vi.chatRating.isRequired};const ro=(0,a.$j)((e=>({latestRating:(0,v.Ok)(e),latestRatingRequest:(0,v.EL)(e),latestAgentLeaveEvent:(0,v.KU)(e),activeAgentCount:(0,w.Zv)(e),canRateChat:(0,v.hB)(e).enabled,chatRating:(0,v.sc)(e)})),{},null)(ao);var lo=i(74658);class co extends o.PureComponent{static propTypes={chatLog:s().arrayOf(Qs.chatLogEntry),firstVisitorMessage:s().number.isRequired,agents:s().object,goToFeedbackScreen:s().func.isRequired,showAvatar:s().bool.isRequired,agentEndedChatSession:s().bool,handleSendMsg:s().func,onImageLoad:s().func,showUpdateInfo:s().bool.isRequired,updateInfoOnClick:s().func,socialLogin:s().object,conciergeAvatar:s().string,isMobile:s().bool.isRequired,isChatting:s().bool.isRequired};static defaultProps={socialLogin:{}};constructor(e){super(e),this.createdTimestamp=Date.now()}renderGroup=e=>{const{agents:t,showAvatar:i,handleSendMsg:n,onImageLoad:s,socialLogin:o,conciergeAvatar:a,isMobile:r}=this.props;if("message"===e.type){const l=e.messages[0],d=e.author||"visitor",c=e.author.indexOf("agent:")>-1,m=cn()(t,`${d}.avatar_path`)||a;return(0,h.jsx)(eo,{isAgent:c,messageKeys:e.messages,avatarPath:m,showAvatar:i,onImageLoad:s,handleSendMsg:n,socialLogin:o,chatLogCreatedAt:this.createdTimestamp,isMobile:r,children:this.renderUpdateInfo(l)},l)}if("event"===e.type){const t=e.messages[0];return(0,h.jsx)(so,{isHistory:!1,eventKey:t,chatLogCreatedAt:this.createdTimestamp,children:(this.props.isChatting||this.props.agentEndedChatSession)&&(0,h.jsx)(ro,{onClick:this.props.goToFeedbackScreen,eventKey:t})},t)}};renderUpdateInfo(e){const{showUpdateInfo:t,firstVisitorMessage:i,updateInfoOnClick:n}=this.props;if(t&&i===e)return(0,h.jsx)("button",{onClick:n,className:lo.locals.updateInfo,children:Oe.a.t("embeddable_framework.chat.chatLog.login.updateInfo")})}render(){return ln()(this.props.chatLog)?null:(0,h.jsx)("div",{role:"log","aria-live":"polite",children:ye()(this.props.chatLog,this.renderGroup)})}}const ho=(0,a.$j)((e=>({chatLog:(0,v.L2)(e),firstVisitorMessage:(0,v.lK)(e),showUpdateInfo:(0,w.ZL)(e),locale:Oe.a.getLocale(),isChatting:(0,v.OQ)(e),agentEndedChatSession:(0,v.bc)(e)})),{},null,{forwardRef:!0})(co),mo=(0,a.$j)(((e,t)=>({messages:Pe(e,t.messageKeys),locale:Oe.a.getLocale()})),{},null,{forwardRef:!0})(Js);var po=i(62426),uo=i.n(po);const go={showToday:!1,month:"long",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric"},fo={hour:"numeric",minute:"numeric"};const bo=e=>{const t=new Date(e),i=new Date;return t.getDate()===i.getDate()&&t.getMonth()===i.getMonth()&&t.getFullYear()===i.getFullYear()};var yo=i(97052);class Co extends o.Component{static propTypes={chatHistoryLog:s().array.isRequired,agents:s().object,showAvatar:s().bool.isRequired,firstMessageTimestamp:s().number,isMobile:s().bool.isRequired};static defaultProps={firstMessageTimestamp:null};constructor(e){super(e),this.createdTimestamp=Date.now(),this.container=null}getScrollHeight=()=>this.container&&this.container.scrollHeight||0;renderDivider=e=>{const t=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=uo()({},go,t),n=Oe.a.dateTimeFormat(e,i);if(i.showToday&&bo(e)){const t=Oe.a.dateTimeFormat(e,fo);return Oe.a.t("embeddable_framework.common.today",{time:t})}return n}(e,{showToday:!0});return(0,h.jsx)("div",{className:yo.locals.divider,children:t})};renderHistoryLog=()=>{const e=ye()(this.props.chatHistoryLog,(e=>{const{type:t,author:i,first:n}=e;if("message"===t){const t=e.messages[0],n=i||"visitor",s=i.indexOf("agent:")>-1,o=cn()(this.props.agents,`${n}.avatar_path`);return(0,h.jsx)(mo,{isAgent:s,messageKeys:e.messages,avatarPath:o,showAvatar:this.props.showAvatar,isMobile:this.props.isMobile,chatLogCreatedAt:this.createdTimestamp},t)}if("event"===t){const t=e.messages[0];return(0,h.jsx)(so,{eventKey:t,chatLogCreatedAt:this.createdTimestamp,divider:n?this.renderDivider(t):null,isHistory:!0},t)}}));return e};render(){return ln()(this.props.chatHistoryLog)?null:(0,h.jsxs)("div",{ref:e=>{this.container=e},children:[this.renderHistoryLog(),this.renderDivider(this.props.firstMessageTimestamp)]})}}const xo=(0,a.$j)((e=>({chatHistoryLog:_e(e)})),{},null,{forwardRef:!0})(Co);var wo=i(74743);const vo=(0,E.ZP)(bt.gF).withConfig({displayName:"styles__LoadingDots",componentId:"sc-wr7l5d-0"})(["color:"," !important;vertical-align:middle;height:1.4rem !important;width:1.4rem !important;padding-bottom:","rem;",""],(e=>e.theme.palette.grey[500]),2/d.Kt,(e=>e.theme.rtl?`margin-left: ${5/d.Kt}rem;`:`margin-right: ${5/d.Kt}rem;`)),_o=E.ZP.div.withConfig({displayName:"styles__Container",componentId:"sc-wr7l5d-1"})(["width:100%;padding-top:",";padding-bottom:",";color:",";"],(()=>(0,r.K1)()?0:12/d.Kt+"rem"),(()=>(0,r.K1)()?4/d.Kt+"rem":6/d.Kt+"rem"),(e=>e.theme.palette.grey[600])),jo=(e,t)=>{switch(t.length){case 1:return((e,t)=>e("embeddable_framework.chat.chatLog.isTyping",{agent:t[0].display_name}))(e,t);case 2:return((e,t)=>e("embeddable_framework.chat.chatLog.isTyping_two",{agent1:t[0].display_name,agent2:t[1].display_name}))(e,t);default:return(e=>e("embeddable_framework.chat.chatLog.isTyping_multiple"))(e)}},So=(0,o.forwardRef)(((e,t)=>{let{agentsTyping:i=[]}=e;const n=(0,M.Z)();return(0,h.jsx)("div",{"aria-live":"polite",ref:t,children:0!==i.length&&(0,h.jsxs)(_o,{children:[(0,h.jsx)(vo,{"data-testid":d.z7.ICON_ELLIPSIS}),jo(n,i)]})})}));So.propTypes={agentsTyping:s().array};const ko=So,To=E.ZP.div.withConfig({displayName:"styles__LogoContainer",componentId:"sc-elrwaj-0"})(["padding-bottom:0.5rem;padding-top:0.5rem;text-align:center;"]),Po=o.forwardRef(((e,t)=>{let{agentsTyping:i,hideZendeskLogo:n=!1,isMobile:s=!1}=e;return i.length>0?(0,h.jsx)(ko,{agentsTyping:i,ref:t}):!n&&s?(0,h.jsx)(To,{children:(0,h.jsx)(wo.Z,{linkToChat:!0})}):null}));Po.propTypes={agentsTyping:s().array,hideZendeskLogo:s().bool,isMobile:s().bool};const Io=Po;class Eo extends o.Component{static propTypes={activeClassName:s().string,children:s().node,className:s().string,disableClick:s().bool,onDragEnter:s().func,onDragLeave:s().func,onDrop:s().func.isRequired,style:s().object,containerStyle:s().object,dropzoneId:s().string};static defaultProps={activeClassName:"",className:"",disableClick:!1,onDragEnter:()=>{},onDragLeave:()=>{},style:{},containerStyle:{},dropzoneId:""};constructor(e,t){super(e,t),this.state={isDragActive:!1}}componentDidMount=()=>{this.enterCounter=0};onDragEnter=e=>{e.preventDefault(),++this.enterCounter,this.setState({isDragActive:!0}),this.props.onDragEnter(e)};onDragOver=e=>(e.preventDefault(),e.stopPropagation(),!1);onDragLeave=e=>{e.preventDefault(),--this.enterCounter>0||(this.setState({isDragActive:!1}),this.props.onDragLeave(e))};onDrop=e=>{e.preventDefault();const t=e.dataTransfer?e.dataTransfer.files:e.target.files;this.setState({isDragActive:!1}),this.props.onDrop(t,e)};onClick=()=>{this.props.disableClick||(this.fileInputEl.value=null,this.fileInputEl.click())};render=()=>{const e=this.state.isDragActive?this.props.activeClassName:"",t=`${this.props.className} ${e}`;return(0,h.jsx)("div",{"data-testid":d.z7.DROPZONE,onDragEnter:this.onDragEnter,onDragOver:this.onDragOver,onDragLeave:this.onDragLeave,style:this.props.containerStyle,onDrop:this.onDrop,children:(0,h.jsxs)("div",{role:"presentation",onClick:this.onClick,style:this.props.style,className:t,children:[this.props.children,(0,h.jsx)("input",{type:"file",style:{display:"none"},multiple:!0,ref:e=>this.fileInputEl=e,onChange:this.onDrop,id:this.props.dropzoneId,"data-testid":this.props.dropzoneId})]})})}}var No=i(96730);const Ro=(0,E.ZP)(No.Z).withConfig({displayName:"styles__StyledIcon",componentId:"sc-kdp607-0"})(["&&&{display:inline-block;min-width:","rem;min-height:","rem;height:","rem;width:","rem;transform-origin:center;transform:rotate(45deg);}"],(e=>16/e.theme.fontSize),(e=>16/e.theme.fontSize),(e=>16/e.theme.fontSize),(e=>16/e.theme.fontSize)),Ao=e=>{let{isPreview:t=!1,isMobile:i=!1,handleAttachmentDrop:n=(()=>{}),theme:{rtl:s}}=e;const o=(0,M.Z)(),a=(0,h.jsx)(mi,{ignoreThemeOverride:!0,size:"small","aria-label":o("embeddable_framework.chat.icon.attachments.hover.label"),"data-testid":d.z7.CHAT_ATTACHMENT_BUTTON,children:(0,h.jsx)(Ro,{"data-testid":d.z7.ICON_CHAT_ATTACHMENT})});return t?a:i?(0,h.jsx)(Eo,{onDrop:n,children:a}):(0,h.jsx)(Eo,{onDrop:n,children:(0,h.jsx)(qt.u,{content:o("embeddable_framework.chat.icon.attachments.hover.label"),placement:s?"top-start":"top-end",children:a})})};Ao.propTypes={isPreview:s().bool,isMobile:s().bool,handleAttachmentDrop:s().func,theme:s().shape({rtl:s().bool})};const Lo=(0,E.Zz)(Ao);var Mo;function zo(){return zo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},zo.apply(this,arguments)}const Zo=e=>{let{title:t,titleId:i,...n}=e;return o.createElement("svg",zo({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 14 13.99","aria-labelledby":i},n),t?o.createElement("title",{id:i},t):null,Mo||(Mo=o.createElement("g",{"data-name":"Layer 2"},o.createElement("g",{"data-name":"Layer 2"},o.createElement("path",{d:"M8.72,9.28a.47.47,0,0,0-.47.47v2H5.42V2.22H8.26v2a.47.47,0,1,0,.93,0V1.76a.47.47,0,0,0-.47-.47H5.42V.47A.47.47,0,0,0,4.79,0L.31,1.66A.47.47,0,0,0,0,2.1v9.79a.47.47,0,0,0,.31.44L4.79,14,5,14a.47.47,0,0,0,.27-.08.46.46,0,0,0,.2-.38v-.87h3.3a.47.47,0,0,0,.47-.47V9.75A.47.47,0,0,0,8.72,9.28ZM4.49,12.86.93,11.57V2.43L4.49,1.13Z"}),o.createElement("path",{d:"M13.85,6.62l-2-2a.5.5,0,1,0-.7.71l1.11,1.09H6.5a.51.51,0,0,0,0,1h5.77L11.13,8.61a.5.5,0,1,0,.7.71l2-2a.5.5,0,0,0,0-.71Z"})))))},Oo=(0,E.ZP)(Zo).withConfig({displayName:"styles__StyledIcon",componentId:"sc-nx60c6-0"})(["display:inline-block;",""],(e=>e.theme.isMobile&&"padding: 0;")),qo=e=>{let{endChat:t,isChatting:i,theme:{rtl:n}}=e;const s=(0,M.Z)(),o=(0,h.jsx)(mi,{ignoreThemeOverride:!0,colorType:"fill",size:"small",onClick:e=>{i&&t(e)},"aria-label":s("embeddable_framework.chat.icon.endChat.hover.label"),disabled:!i,"data-testid":d.z7.BUTTON_END_CHAT,children:(0,h.jsx)(Oo,{"data-testid":d.z7.ICON_END_CHAT})});return(0,h.jsx)(qt.u,{placement:n?"top-start":"top-end",content:s("embeddable_framework.chat.icon.endChat.hover.label"),children:o})};qo.propTypes={isChatting:s().bool,endChat:s().func,theme:s().shape({rtl:s().bool})};const Do=(0,E.Zz)(qo);var Bo=i(41627);const Ho=E.ZP.div.withConfig({displayName:"styles__BottomRow",componentId:"sc-1kohmtk-0"})(["display:flex;justify-content:space-between;align-items:flex-end;margin-top:","rem;"],(e=>8/e.theme.fontSize)),Fo=(0,E.ZP)(Bo.ZP).withConfig({displayName:"styles__Footer",componentId:"sc-1kohmtk-1"})(["z-index:2;"]),Ko=E.ZP.div.withConfig({displayName:"styles__IconContainer",componentId:"sc-1kohmtk-2"})(["display:flex;flex:1;justify-content:flex-end;align-items:center;transform:translate(0px,33%);button{margin-right:","rem;}"],(e=>3/e.theme.fontSize)),Uo=e=>{let{attachmentsEnabled:t,children:i,endChat:n,handleAttachmentDrop:s,hideZendeskLogo:o,isChatting:a,isMobile:r,isPreview:l}=e;return(0,h.jsxs)(Fo,{"data-testid":d.z7.CHAT_FOOTER_DESKTOP,children:[i,(0,h.jsxs)(Ho,{children:[!o&&(0,h.jsx)(wo.Z,{linkToChat:!0}),(0,h.jsxs)(Ko,{"data-testid":d.z7.CHAT_FOOTER_MENU_BUTTONS,children:[(0,h.jsx)(Do,{endChat:n,isChatting:a}),t&&(0,h.jsx)(Lo,{isPreview:l,isMobile:r,handleAttachmentDrop:s}),(0,h.jsx)(Ti,{})]})]})]})};Uo.propTypes={attachmentsEnabled:s().bool,children:s().node,endChat:s().func,handleAttachmentDrop:s().func,hideZendeskLogo:s().bool,isChatting:s().bool,isMobile:s().bool,isPreview:s().bool};const Vo=Uo;var $o,Go,Wo;function Qo(){return Qo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},Qo.apply(this,arguments)}const Xo=e=>{let{title:t,titleId:i,...n}=e;return o.createElement("svg",Qo({width:"14px",height:"14px",viewBox:"0 0 14 14",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink","aria-labelledby":i},n),t?o.createElement("title",{id:i},t):null,$o||($o=o.createElement("desc",null,"Created with sketchtool.")),Go||(Go=o.createElement("defs",null)),Wo||(Wo=o.createElement("g",{stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd",transform:"translate(-1253.000000, -897.000000)"},o.createElement("g",{transform:"translate(902.000000, 883.000000)",fill:"#999999"},o.createElement("path",{d:"M352.557407,22.5218986 L358.807516,20.9997271 L352.557407,19.4688426 L351.051175,15.1567495 C350.792305,14.4161394 351.582213,13.7417486 352.292332,14.0981128 L364.515949,20.2233935 C365.16135,20.546648 365.16135,21.4528062 364.515949,21.7760607 L352.291445,27.9022127 C351.581326,28.2577055 350.791419,27.5841861 351.050289,26.843576 L352.557407,22.5218986 Z"})))))},Yo=(0,E.ZP)(Xo).withConfig({displayName:"styles__StyledIcon",componentId:"sc-1dghge2-0"})(["&&&{display:inline-block;padding:","rem;color:"," !important;}"],(e=>10/e.theme.fontSize),(e=>e.theme.baseColor)),Jo=e=>{let{sendChat:t}=e;const i=(0,M.Z)();return(0,h.jsx)(mi,{colorType:"fill",onClick:t,"aria-label":i("embeddable_framework.submitTicket.form.submitButton.label.send"),children:(0,h.jsx)(Yo,{"data-testid":d.z7.ICON_SEND_CHAT})})};Jo.propTypes={sendChat:s().func};const ea=Jo,ta=E.ZP.div.withConfig({displayName:"styles__Container",componentId:"sc-6hlybu-0"})(["display:flex;align-items:center;box-shadow:0 ","rem 0 0 ",";padding:","rem 0;margin-bottom:","px;"],(e=>-1/e.theme.fontSize),(e=>e.theme.palette.grey[300]),(e=>10/e.theme.fontSize),(e=>e.isComposerFocused&&(0,r.N5)()?40:0)),ia=E.ZP.div.withConfig({displayName:"styles__InputContainer",componentId:"sc-6hlybu-1"})(["flex-grow:1;"]),na=e=>{let{attachmentsEnabled:t,children:i,handleAttachmentDrop:n,isMobile:s,isPreview:o,sendChat:a,isComposerFocused:r}=e;return(0,h.jsxs)(ta,{"data-testid":d.z7.CHAT_FOOTER_MOBILE,isComposerFocused:r,children:[t&&(0,h.jsx)(Lo,{isPreview:o,isMobile:s,handleAttachmentDrop:n}),(0,h.jsx)(ia,{children:i}),(0,h.jsx)(ea,{sendChat:a})]})};na.propTypes={attachmentsEnabled:s().bool,children:s().node,handleAttachmentDrop:s().func,isMobile:s().bool,isPreview:s().bool,isComposerFocused:s().bool,sendChat:s().func};const sa=na,oa=e=>{let{attachmentsEnabled:t,children:i,endChat:n,sendAttachments:s,hideZendeskLogo:o,isChatting:a,theme:r,isPreview:l,sendChat:d,isComposerFocused:c}=e;return r.isMobile?(0,h.jsx)(sa,{attachmentsEnabled:t,handleAttachmentDrop:s,isMobile:r.isMobile,isPreview:l,sendChat:d,isComposerFocused:c,children:i}):(0,h.jsx)(Vo,{attachmentsEnabled:t,handleAttachmentDrop:s,endChat:n,hideZendeskLogo:o,isChatting:a,isMobile:r.isMobile,isPreview:l,children:i})};oa.propTypes={attachmentsEnabled:s().bool.isRequired,children:s().node.isRequired,endChat:s().func,sendAttachments:s().func,hideZendeskLogo:s().bool,isChatting:s().bool,isPreview:s().bool,sendChat:s().func,theme:s().shape({isMobile:s().bool.isRequired}),isComposerFocused:s().bool};const aa={sendAttachments:_.mJ},ra=(0,a.$j)((e=>({attachmentsEnabled:(0,v.c_)(e),menuVisible:(0,v.de)(e),isChatting:(0,v.OQ)(e),hideZendeskLogo:(0,pi.Dh)(e)})),aa)((0,E.Zz)(oa));var la=i(95216);const da=(0,E.ZP)(Ki.__).withConfig({displayName:"styles__HiddenLabel",componentId:"sc-5gtam6-0"})(["position:absolute !important;overflow:hidden !important;width:1px !important;height:1px !important;padding:0 !important;border:0 !important;clip:rect(1px,1px,1px,1px) !important;"]),ca=E.ZP.div.withConfig({displayName:"styles__Container",componentId:"sc-5gtam6-1"})(["vertical-align:bottom !important;margin:0 ","rem;"],(e=>1/e.theme.fontSize)),ha=(0,E.ZP)(Ki.gx).withConfig({displayName:"styles__StyledTextarea",componentId:"sc-5gtam6-2"})([""," &::-webkit-scrollbar{width:","rem;}&::-webkit-scrollbar-thumb{background:",";border-radius:","rem;}"],(0,r.K1)()&&(0,E.iv)(["padding:","rem;border:none !important;border-radius:0;box-shadow:none !important;font-size:","rem !important;"],(e=>8/e.theme.fontSize),(e=>16/e.theme.fontSize)),(e=>4/e.theme.fontSize),(e=>e.theme.palette.grey[300]),(e=>4/e.theme.fontSize)),ma=e=>{let{currentMessage:t="",sendChat:i,handleChatBoxChange:n,isMobile:s,onFocus:o,onBlur:a}=e;const r=(0,M.Z)(),{handleCompositionStart:l,handleCompositionEnd:c,handleKeyDown:m,handleKeyUp:p}=(0,la.Z)(i),u=r("embeddable_framework.chat.chatBox.placeholder.typeMessageHere_v2");return(0,h.jsx)(ca,{children:(0,h.jsxs)(Ki.gN,{children:[(0,h.jsx)(da,{children:u}),(0,h.jsx)(ha,{value:t,onChange:e=>{const{value:t}=e.target;n(t)},onKeyDown:m,onKeyUp:p,onCompositionStart:l,onCompositionEnd:c,placeholder:u,name:"chatBox",rows:s?1:3,"data-testid":d.z7.MESSAGE_FIELD,onFocus:o,onBlur:a})]})})};ma.propTypes={isMobile:s().bool.isRequired,currentMessage:s().string,sendChat:s().func.isRequired,handleChatBoxChange:s().func.isRequired,onFocus:s().func,onBlur:s().func};const pa=ma;var ua=i(94029);const ga=E.ZP.div.withConfig({displayName:"styles__Container",componentId:"sc-n8hnag-0"})(["position:absolute;display:flex;justify-content:center;align-items:center;top:","rem;left:0;right:0;"],120/d.Kt),fa=E.ZP.div.withConfig({displayName:"styles__Text",componentId:"sc-n8hnag-1"})(["color:",";border-radius:","rem !important;box-shadow:0 ","rem ","rem 0 rgba(0,0,0,0.2);max-width:90%;height:","rem;line-height:","rem;padding:0 ","rem;background-color:",";transition:opacity 300ms ease-in-out;opacity:0;"],(e=>e.theme.palette.grey[800]),30/d.Kt,1/d.Kt,10/d.Kt,30/d.Kt,30/d.Kt,12/d.Kt,(e=>e.theme.palette.white)),ba=e=>{let{loading:t}=e;const i=(0,M.Z)(),n={entering:{opacity:.9},entered:{opacity:1}};return(0,h.jsx)(ga,{children:(0,h.jsx)(ua.ZP,{timeout:0,in:t,unmountOnExit:!0,children:e=>(0,h.jsx)(fa,{style:{...n[e]},children:i("embeddable_framework.chat.fetching_history")})})})};ba.propTypes={loading:s().bool};const ya=ba;var Ca=i(52682);const xa=e=>{let{isAuthenticated:t,submitting:i,updateContactDetailsVisibility:n}=e;const s=(0,M.Z)();return(0,h.jsxs)(Ca.$_,{children:[(0,h.jsx)(Ca.o_,{children:(0,h.jsx)(ee.zx,{onClick:()=>n(!1),"data-testid":d.z7.BUTTON_CANCEL,ref:e=>{t&&e?.focus()},children:s("embeddable_framework.common.button.cancel")})}),!t&&(0,h.jsx)(Ca.o_,{children:(0,h.jsx)(P.Z,{submitting:i,label:s("embeddable_framework.common.button.save")})})]})};xa.propTypes={isAuthenticated:s().bool.isRequired,submitting:s().bool.isRequired,updateContactDetailsVisibility:s().func.isRequired};const wa=xa;var va=i(55387);const _a=(0,E.ZP)(G.gN).withConfig({displayName:"styles__StyledField",componentId:"sc-fr6hgy-0"})(["margin-bottom:","rem;"],(e=>16/e.theme.fontSize)),ja=e=>{let{isAuthenticated:t,isRequired:i,label:n,name:s,testId:o,shouldFocusOnMount:a=!1}=e;const r=(0,M.Z)(),[l,d]=(0,ks.Z)(!1);return(0,h.jsx)(_a,{name:s,render:e=>{let{input:s,meta:c}=e;return(0,h.jsxs)(Ki.gN,{children:[(0,va.fA)(Ki.__,r(n),i),(0,h.jsx)(Ki.II,{value:s.value,name:s.name,disabled:t,validation:c.error?"error":void 0,onChange:e=>s.onChange(e),ref:e=>{a&&!l&&setTimeout((()=>{e?.focus(),d(!0)}),0)},"data-testid":o}),c.error&&(0,h.jsx)(Ki.v0,{validation:"error",children:r(c.error)})]})}})};ja.propTypes={isAuthenticated:s().bool.isRequired,isRequired:s().bool.isRequired,label:s().string.isRequired,name:s().string.isRequired,testId:s().string.isRequired,shouldFocusOnMount:s().bool};const Sa=ja,ka=E.ZP.div.withConfig({displayName:"styles__DefaultProfileContainer",componentId:"sc-jb3co2-0"})(["margin-bottom:","rem;"],(e=>16/e.theme.fontSize)),Ta=e=>{let{isAuthenticated:t,socialLogin:i,visitor:n,nameField:s,authUrls:o,emailField:a,initiateSocialLogout:r,shouldSpaceSocialLogin:l}=e;const{authenticated:d}=i,c=d||t;return(0,h.jsxs)("div",{children:[c&&(0,h.jsx)(F,{visitor:n,socialLogin:i,initiateSocialLogout:r}),!c&&(0,h.jsxs)(ka,{children:[s,(0,h.jsx)(fe,{authUrls:o,shouldSpace:l}),a]})]})};Ta.propTypes={authUrls:s().objectOf(s().string),emailField:s().node,initiateSocialLogout:s().func.isRequired,isAuthenticated:s().bool.isRequired,nameField:s().node,shouldSpaceSocialLogin:s().bool,socialLogin:s().shape({authenticated:s().bool,screen:s().string,avatarPath:s().string}),visitor:s().shape({display_name:s().string,email:s().string}).isRequired};const Pa=Ta,Ia=e=>{let{authUrls:t,initiateSocialLogout:i,isAuthenticated:n,requiredFormData:s,socialLogin:o,visitor:a}=e;const{name:r,email:l}=s,c=(0,h.jsx)(Sa,{isAuthenticated:n,isRequired:r.required,name:"display_name",label:"embeddable_framework.common.textLabel.name",testId:d.z7.NAME_FIELD,shouldFocusOnMount:!0}),m=(0,h.jsx)(Sa,{isAuthenticated:n,isRequired:l.required,name:"email",label:"embeddable_framework.common.textLabel.email",testId:d.z7.EMAIL_FIELD});return(0,h.jsx)(Pa,{authUrls:t,emailField:m,initiateSocialLogout:i,isAuthenticated:n,nameField:c,socialLogin:o,visitor:a,shouldSpaceSocialLogin:!0})};Ia.propTypes={authUrls:s().objectOf(s().string),initiateSocialLogout:s().func.isRequired,isAuthenticated:s().bool.isRequired,requiredFormData:s().shape({name:s().shape({required:s().bool}),email:s().shape({required:s().bool})}),socialLogin:s().shape({authenticated:s().bool,screen:s().string,avatarPath:s().string}).isRequired,visitor:s().shape({display_name:s().string,email:s().string})};const Ea=Ia,Na=(e,t)=>{const i=!(0,li.BC)(e.display_name??"",{allowEmpty:!t?.name?.required}),n=!(0,li.s$)(e.email??"",{allowEmpty:!t?.email?.required});if(i||n){const e={};return n&&(e.email="embeddable_framework.validation.error.email"),i&&(e.display_name="embeddable_framework.validation.error.name"),e}return null},Ra=E.ZP.form.withConfig({displayName:"styles__Form",componentId:"sc-18zeu9e-0"})(["margin-bottom:0 !important;height:60%;"]),Aa=(0,E.ZP)(Ca.uT).withConfig({displayName:"styles__StyledBody",componentId:"sc-18zeu9e-1"})(["padding-bottom:0px !important;"]),La=e=>{let{authUrls:t,contactDetails:i,editContactDetailsSubmitted:n,initiateSocialLogout:s,isAuthenticated:a,onSuccess:r,requiredFormData:l,socialLogin:d,updateContactDetailsVisibility:c,visitor:m}=e;const[p,u]=(0,o.useState)(!1),g=(0,M.Z)();return(0,h.jsx)(G.l0,{validate:e=>{if(p)return Na(e,l)},onSubmit:(e,t,i)=>{const s=Na(e,l);if(s)return u(!0),void i(s);Promise.resolve(n({display_name:e.display_name??"",email:e.email??""})).then((()=>{u(!1),i(),r()})).catch((()=>i({[Fi.Ck]:"embeddable_framework.chat.options.editContactDetailsSubmission.error"})))},initialValues:i,render:e=>{let{handleSubmit:i,submitting:n,submitError:o}=e;return(0,h.jsxs)(Ra,{noValidate:!0,onSubmit:e=>{e.preventDefault(),i()},children:[(0,h.jsx)(Ca.h4,{children:g("embeddable_framework.chat.options.editContactDetails")}),(0,h.jsxs)(Aa,{children:[(0,h.jsx)(Ea,{authUrls:t,initiateSocialLogout:s,isAuthenticated:a,requiredFormData:l,socialLogin:d,visitor:m}),o&&(0,h.jsx)(Ui.b,{type:"error",role:"alert",children:(0,h.jsx)(Ui.D,{children:g(o)})})]}),(0,h.jsx)(wa,{isAuthenticated:a,updateContactDetailsVisibility:c,submitting:n})]})}})};La.propTypes={authUrls:s().object.isRequired,contactDetails:s().object.isRequired,editContactDetailsSubmitted:s().func.isRequired,initiateSocialLogout:s().func.isRequired,isAuthenticated:s().bool,onSuccess:s().func.isRequired,requiredFormData:s().shape({name:s().shape({required:s().bool}),email:s().shape({required:s().bool})}),socialLogin:s().object.isRequired,updateContactDetailsVisibility:s().func,visitor:s().object.isRequired};const Ma={updateContactDetailsVisibility:_.fj,editContactDetailsSubmitted:_.bn,initiateSocialLogout:_.XX},za=(0,a.$j)((e=>({authUrls:(0,w.zC)(e),contactDetails:(0,v.QD)(e),isAuthenticated:(0,v.j3)(e),requiredFormData:(0,qe.Ph)(e),socialLogin:(0,v.cA)(e),visitor:(0,v.X8)(e)})),Ma)(La),Za=()=>{const e=(0,M.Z)();return(0,h.jsx)(xn.P_,{type:"success",role:"alert",tabIndex:0,ref:e=>{setTimeout((()=>{e?.focus()}),0)},children:(0,h.jsx)(Ui.D,{children:(0,h.jsx)("strong",{children:e("embeddable_framework.chat.options.editContactDetailsSubmission.success")})})})},Oa=e=>{let{onClose:t}=e;const[i,n]=(0,o.useState)(null),[s,a]=(0,o.useState)(!1);return(0,h.jsx)("div",{ref:e=>n(e),children:i&&(0,h.jsx)(Ca.u_,{backdropProps:{style:{position:"absolute"}},onClose:e=>{e.stopPropagation(),t()},appendToNode:i,"data-testid":d.z7.CHAT_EDIT_CONTACT_DETAILS_MODAL,children:s?(0,h.jsx)(Za,{}):(0,h.jsx)(za,{onSuccess:()=>a(!0)})})})};Oa.propTypes={onClose:s().func.isRequired};const qa=(0,E.Zz)(Oa);var Da=i(42884);const Ba=e=>{let{showErrors:t}=e;const i=(0,M.Z)(),n=(0,G.cI)();return(0,Da.Z)((()=>{n.reset({})})),(0,h.jsx)(G.gN,{name:"email",render:e=>{let{input:n,meta:s}=e;return(0,h.jsxs)(Ki.gN,{children:[(0,h.jsx)(Ki.__,{children:i("embeddable_framework.common.textLabel.email")}),(0,h.jsx)(Ki.II,{onChange:e=>{n.onChange(e.target.value)},ref:e=>{setTimeout((()=>{e?.focus()}),0)},value:n.value,name:"email"}),s.error&&t&&(0,h.jsx)(Ki.v0,{validation:"error",children:i("embeddable_framework.validation.error.email")})]})}})};Ba.propTypes={showErrors:s().bool};const Ha=Ba;var Fa=i(47126);const Ka=E.ZP.form.withConfig({displayName:"styles__Form",componentId:"sc-ug7bw3-0"})(["","{margin-top:","rem;margin-bottom:0 !important;}"],Fa.bZ,(e=>16/e.theme.fontSize)),Ua=e=>{if(!d.QI.test(e.email))return{email:"not valid"}},Va=e=>{let{onClose:t,onSuccess:i}=e;const n=(0,M.Z)(),s=(0,a.I0)(),r=(0,a.v9)(v.MP),[l,d]=(0,o.useState)(!1);return(0,h.jsx)(G.l0,{onSubmit:function(e,t,n){d(!0);const o=Ua(e);o?n(o):Promise.resolve(s(ct(e.email))).then((()=>{n(),i(e.email)})).catch((()=>{n({[Fi.Ck]:"submit failed"})}))},validate:e=>{if(l)return Ua(e)},initialValues:{email:r},children:e=>{let{handleSubmit:i,submitError:s,submitting:o}=e;return(0,h.jsxs)(Ka,{onSubmit:i,children:[(0,h.jsx)(Ca.h4,{children:n("embeddable_framework.chat.emailtranscript.title")}),(0,h.jsxs)(Ca.uT,{children:[(0,h.jsx)(Ha,{onSubmit:i,onClose:t,showErrors:l,submitError:s,isSubmitting:o}),s&&l&&(0,h.jsx)(Fa.bZ,{type:"error",role:"alert",children:(0,h.jsx)(Fa.Dx,{children:n("embeddable_framework.chat.emailtranscript.failure_message")})})]}),(0,h.jsxs)(Ca.$_,{children:[(0,h.jsx)(Ca.o_,{children:(0,h.jsx)(ee.zx,{isBasic:!0,onClick:t,children:n("embeddable_framework.common.button.cancel")})}),(0,h.jsx)(Ca.o_,{children:(0,h.jsx)(P.Z,{label:n("embeddable_framework.common.button.send"),submitting:o})})]})]})}})};Va.propTypes={onClose:s().func,onSuccess:s().func};const $a=Va,Ga=e=>{let{email:t}=e;const i=(0,M.Z)();return(0,h.jsx)(Fa.P_,{type:"success",role:"alert",tabIndex:0,ref:e=>{setTimeout((()=>{e?.focus()}),0)},children:(0,h.jsx)(Fa.Dx,{dangerouslySetInnerHTML:{__html:i("embeddable_framework.chat.emailtranscript.success_message",{email:`<strong>${t}</strong>`})}})})};Ga.propTypes={email:s().string};const Wa=Ga,Qa=e=>{let{onClose:t}=e;const[i,n]=(0,o.useState)(null),[s,a]=(0,o.useState)(null);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{ref:e=>n(e),"data-testid":d.z7.CHAT_EMAIL_TRANSCRIPT_MODAL}),i&&(0,h.jsx)(Ca.u_,{backdropProps:{style:{position:"absolute"}},onClose:e=>{e.stopPropagation(),t()},appendToNode:i,children:s?(0,h.jsx)(Wa,{email:s}):(0,h.jsx)($a,{onSuccess:e=>a(e),onClose:t})})]})};Qa.propTypes={onClose:s().func};const Xa=(0,E.Zz)(Qa);var Ya=i(28365),Ja=i(30058);const er=E.ZP.div.withConfig({displayName:"styles__Backdrop",componentId:"sc-jpz7mp-0"})(["background:",";position:fixed;top:",";right:0;bottom:0;left:0;display:flex;justify-content:center;align-items:",";z-index:4;padding-bottom:20px;overflow:hidden;"],(()=>(0,r.K1)()?"rgba(0, 0, 0, 0.4)":"rgba(0, 0, 0, 0)"),(()=>(0,r.K1)()?42.5/d.Kt+"rem":0),(()=>(0,r.K1)()?"flex-start":"flex-end")),tr=E.ZP.h4.withConfig({displayName:"styles__Header",componentId:"sc-jpz7mp-1"})(["color:",";margin-bottom:","rem;text-align:center;font-size:","rem;"],(e=>e.theme.palette.grey[800]),16/d.Kt,15/d.Kt),ir=E.ZP.div.withConfig({displayName:"styles__ModalActions",componentId:"sc-jpz7mp-2"})(["display:flex;margin-top:","rem;> *{flex:1;}> *:not(:first-child){margin-left:","rem;}"],16/d.Kt,12/d.Kt),nr=(0,E.ZP)(Ja.K).withConfig({displayName:"styles__StyledSlideAppear",componentId:"sc-jpz7mp-3"})(["width:","%;max-height:calc(100% - 4.5rem);overflow-y:scroll;padding:20px;background:",";position:relative;background-color:",";border-radius:","rem;box-shadow:0rem 0rem ","rem 0rem rgba(0,0,0,0.3);margin-bottom:","rem;",""],(()=>(0,r.K1)()?100:90),(e=>e.theme.palette.white),(e=>e.theme.palette.white),3/d.Kt,8/d.Kt,15/d.Kt,(e=>e.noPadding&&"padding: 0;")),sr=e=>{let{title:t,children:i,onClose:n,focusOnMount:s,"data-testid":a,noPadding:l,animate:d=!0}=e;const c=(0,o.useRef)(null),m=(0,di.ND)(),{getBackdropProps:p,getModalProps:u,getTitleProps:g,getContentProps:f}=(0,Ya.d)({onClose:e=>{e.stopPropagation(),n()},modalRef:c,focusOnMount:s,environment:m.document});return(0,h.jsx)(er,{...p(),"data-testid":a,children:(0,h.jsx)(nr,{direction:"up",duration:d?200:0,startPosHeight:"-10px",endPosHeight:"-5px'",transitionOnMount:!(0,r.K1)(),noPadding:l,children:(0,h.jsxs)("div",{...u({ref:c}),children:[t&&(0,h.jsx)(tr,{...g(),children:t}),(0,h.jsx)("section",{...f(),children:i})]})})})};sr.propTypes={title:s().node,children:s().node,onClose:s().func,focusOnMount:s().bool,"data-testid":s().string,noPadding:s().bool,animate:s().bool};const or=sr,ar=E.ZP.div.withConfig({displayName:"styles__ChatEndModalDescription",componentId:"sc-cvd5yc-0"})(["color:",";&&&{padding-bottom:","rem !important;}"],(e=>e.theme.palette.grey[800]),(e=>20/e.theme.fontSize)),rr=e=>{let{endChatViaPostChatScreen:t,onClose:i}=e;const n=(0,M.Z)();return(0,h.jsxs)(or,{onClose:i,focusOnMount:!0,"data-testid":d.z7.CHAT_END_MODAL,children:[(0,h.jsx)(ar,{children:n("embeddable_framework.chat.form.endChat.description")}),(0,h.jsxs)(ir,{children:[(0,h.jsx)(ee.zx,{onClick:i,"data-testid":d.z7.BUTTON_CANCEL,"aria-label":n("embeddable_framework.common.button.cancel"),children:n("embeddable_framework.common.button.cancel")}),(0,h.jsx)(ee.zx,{onClick:()=>{i(),t()},isPrimary:!0,"aria-label":n("embeddable_framework.common.button.end"),"data-testid":d.z7.BUTTON_OK,children:n("embeddable_framework.common.button.end")})]})]})};rr.propTypes={endChatViaPostChatScreen:s().func.isRequired,onClose:s().func.isRequired};const lr=rr,dr=e=>{let{editContactDetails:t,emailTranscript:i,endChatModalVisible:n,endChatViaPostChatScreen:s,updateContactDetailsVisibility:o,updateEmailTranscriptVisibility:a,updateEndChatModalVisibility:r}=e;return(0,h.jsxs)("div",{"data-testid":d.z7.CHAT_MODAL_CONTAINER,children:[t.show&&(0,h.jsx)(qa,{onClose:()=>o(!1)}),i.show&&(0,h.jsx)(Xa,{onClose:()=>a(!1)}),n&&(0,h.jsx)(lr,{endChatViaPostChatScreen:s,onClose:()=>r(!1)})]})};dr.propTypes={editContactDetails:s().shape({show:s().bool}),emailTranscript:s().shape({show:s().bool}),endChatModalVisible:s().bool,endChatViaPostChatScreen:s().func,updateContactDetailsVisibility:s().func,updateEmailTranscriptVisibility:s().func,updateEndChatModalVisibility:s().func};const cr={endChatViaPostChatScreen:_.ry,updateContactDetailsVisibility:_.fj,updateEmailTranscriptVisibility:_.Nw,updateEndChatModalVisibility:_.KH},hr=(0,a.$j)((e=>({editContactDetails:(0,v.QD)(e),emailTranscript:(0,v.Fu)(e),endChatModalVisible:(0,v.Yi)(e)})),cr)(dr),mr=E.ZP.div.withConfig({displayName:"styles__Container",componentId:"sc-1iqa83a-0"})(["text-align:center !important;margin-top:","rem;margin-bottom:","rem;color:",";"],5/d.Kt,10/d.Kt,(e=>e.theme.palette.grey[600])),pr=e=>{let{queuePosition:t=1}=e;const i=(0,M.Z)();return(0,h.jsx)(mr,{role:"status","aria-live":"polite",children:i("embeddable_framework.chat.chatLog.queuePosition",{value:t})})};pr.propTypes={queuePosition:s().number};const ur=pr;var gr,fr=i(39936);class br extends o.Component{static propTypes={label:s().string.isRequired,onClick:s().func,className:s().string,onFocus:s().func,onBlur:s().func,onMouseDown:s().func,onMouseUp:s().func};static defaultProps={onClick:()=>{}};render=()=>{const e=un()(this.props.className,fr.locals.quickReply);return(0,h.jsx)(ee.zx,{className:e,isPill:!0,onClick:this.props.onClick,onFocus:this.props.onFocus,onBlur:this.props.onBlur,onMouseDown:this.props.onMouseDown,onMouseUp:this.props.onMouseUp,children:this.props.label})}}class yr extends o.Component{static propTypes={children:s().arrayOf(s().element).isRequired,isMobile:s().bool};constructor(e){super(e),this.state={useCarousel:!1}}componentDidMount(){this.props.isMobile||this.container.scrollWidth>this.container.clientWidth&&this.setState({useCarousel:!0})}stopScrollingPropagation(e){e.stopPropagation()}render=()=>{const e=o.Children.map(this.props.children,((e,t)=>{const i=this.props.children.length-1;return(0,o.cloneElement)(e,{className:un()({[fr.locals.separator]:t!==i,[fr.locals.lastSeparator]:t===i})})})),t=un()({[fr.locals.container]:!0,structuredMessageSlider:!0,[fr.locals.mobile]:this.props.isMobile}),i={variableWidth:!0,speed:300};return this.state.useCarousel?(0,h.jsx)("div",{className:t,children:(0,h.jsx)(Rn,{...i,children:e})}):(0,h.jsx)("div",{className:t,ref:e=>{this.container=e},onScroll:this.stopScrollingPropagation,children:(0,h.jsx)("div",{className:fr.locals.scroll,children:e})})}}function Cr(){return Cr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},Cr.apply(this,arguments)}const xr=e=>{let{title:t,titleId:i,...n}=e;return o.createElement("svg",Cr({xmlns:"http://www.w3.org/2000/svg",width:12,height:16,viewBox:"0 0 12 16","aria-labelledby":i},n),t?o.createElement("title",{id:i},t):null,gr||(gr=o.createElement("path",{fill:"none",className:"lines",stroke:"#000",strokeLinecap:"round",d:"M1,5.5 L15.5,5.5 M5.5,0.5 L0.9,5.1 C0.7,5.3 0.7,5.6 0.9,5.8 L5.5,10.4",transform:"rotate(-90 8 7.5)"})))},wr=(0,E.ZP)(xr).withConfig({displayName:"styles__StyledArrowDownIcon",componentId:"sc-1dvt47p-0"})(["height:","rem;min-height:","rem;min-width:","rem;padding-left:","rem;position:relative;top:","rem;vertical-align:text-top;width:","rem;.lines{stroke:",";}",""],16/d.Kt,16/d.Kt,16/d.Kt,5/d.Kt,1/d.Kt,16/d.Kt,(e=>e.theme.palette.grey[800]),(e=>e.theme.rtl&&`padding-left: 0 !important;\n    padding-right: ${5/d.Kt}rem !important;`)),vr=e=>{let{notificationCount:t,onClick:i}=e;const n=(0,M.Z)(),s=t>1?n("embeddable_framework.common.notification.manyMessages",{plural_number:t}):n("embeddable_framework.common.notification.oneMessage");return(0,h.jsxs)(pt,{onClick:i,children:[s,(0,h.jsx)(wr,{"data-testid":"Icon--arrow-down","aria-hidden":"true"})]})};vr.propTypes={notificationCount:s().number.isRequired,onClick:s().func.isRequired};const _r=vr,jr=e=>{const{scrollHeight:t,scrollTop:i,offsetHeight:n}=e;return t-(i+n)},Sr=E.ZP.div.withConfig({displayName:"styles__Shadow",componentId:"sc-1o2chhf-0"})(["box-shadow:0 0 ","rem ","rem ",";height:0;width:100%;z-index:1;"],(e=>12/e.theme.fontSize),(e=>8/e.theme.fontSize),(e=>e.theme.palette.white)),kr=E.ZP.div.withConfig({displayName:"styles__ChatLogContainer",componentId:"sc-1o2chhf-1"})(["min-height:calc(100% - calc(","rem + 6px));",""],(e=>30/e.theme.fontSize),(e=>e.isMobile&&`\n  min-height: 100%;\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-end;\n  padding-bottom: ${e=>14/e.theme.fontSize}rem;`)),Tr=e=>{let{latestQuickReply:t,currentMessage:i,showChatEndFn:n,sendMsg:s,handleChatBoxChange:r,updateChatScreen:l,toggleMenu:c,showAvatar:m,queuePosition:u,isMobile:f=!1,agentsTyping:b=[],hasMoreHistory:y=!1,historyRequestStatus:C="",allAgents:x={},activeAgents:S={},resetCurrentMessage:k=(()=>{}),fetchConversationHistory:T=(()=>{}),hideZendeskLogo:P=!1,firstMessageTimestamp:E=null,socialLogin:N={},conciergeSettings:R={},showContactDetails:A=(()=>{}),notificationCount:L=0,markAsRead:M=(()=>{}),visible:z=!1,isPreview:Z=!1,connection:O}=e;const q=(0,o.useRef)(null),D=(0,o.useRef)(null),[B,H]=(0,o.useState)(!1),F=()=>!!q.current&&jr(q.current)<I.SC,K=(0,o.useCallback)((()=>{(0,li.Fc)((()=>{q.current&&(q.current.scrollTop=q.current.scrollHeight)}))}));(e=>{const t=(0,a.I0)();(0,o.useEffect)((()=>{e(),t((0,_.zJ)())}),[])})(K),((e,t)=>{const i=(0,a.v9)(ke),[n,s]=(0,o.useState)(!1);(0,o.useEffect)((()=>{e&&i===I.EI.PENDING&&s(e.scrollHeight)}),[i]),(0,o.useEffect)((()=>{if(i!==I.EI.DONE)return;if(!e)return;if(!n)return t();const o=e.scrollTop,a=e.scrollHeight-n;0!==a&&(e.scrollTop=o+a),s(null)}),[i])})(q.current,K),((e,t,i)=>{const n=(0,a.v9)(w.FZ).length;(0,o.useEffect)((()=>{0!==n&&t&&e&&jr(t)<=e.offsetHeight&&i()}),[n])})(D.current,q.current,K),((e,t)=>{const[i,n]=(0,o.useState)(!1),s=()=>{const e=t.scrollHeight-i;return jr(t)<e+I.SC},r=(0,a.I0)(),l=(0,a.v9)(w.Lg),d=(0,a.v9)(v.r2);(0,o.useEffect)((()=>{t&&(n(t.scrollHeight),s()&&(0,zi.YN)(d)&&r((0,_.zJ)()),(s()||"visitor"===d)&&e())}),[l,d,i])})(K,q.current);const U=Boolean(L>0&&!F()),V=Boolean(u&&0===an()(S)),$=an()(S)>0?()=>l(j.fm):null;return(0,h.jsxs)(p.Z,{children:[(0,h.jsx)(Hi,{}),(0,h.jsx)(Jt,{agentsActive:Object.keys(S).length>0,onAgentDetailsClick:$}),(0,h.jsxs)(g.Z,{ref:q,onScroll:()=>{q.current&&(0===q.current.scrollTop&&y&&C!==I.EI.PENDING&&T(),z&&F()&&M())},children:[(0,h.jsxs)(kr,{"data-testid":d.z7.CHAT_LOG,children:[(0,h.jsx)(xo,{isMobile:f,showAvatar:m,agents:x,firstMessageTimestamp:E}),(0,h.jsx)(ho,{isMobile:f,showAvatar:m,agents:x,goToFeedbackScreen:()=>{l(j.Yw)},handleSendMsg:s,onImageLoad:K,conciergeAvatar:R.avatar_path,updateInfoOnClick:A,socialLogin:N}),V&&(0,h.jsx)(ur,{queuePosition:u}),(0,h.jsx)(Io,{agentsTyping:b,ref:D,isMobile:f,hideZendeskLogo:P}),(0,h.jsx)(ya,{loading:"pending"===C}),U&&(0,h.jsx)(_r,{notificationCount:L,onClick:()=>{M(),K()}})]}),(()=>{if(!t)return null;const{timestamp:e,items:i}=t;return i?(0,h.jsx)(yr,{isMobile:f,children:i.map(((e,t)=>{const{action:i,text:n}=e;return(0,h.jsx)(br,{label:n,onClick:()=>s(i.value)},t)}))},e):null})()]}),(0,h.jsx)(Sr,{}),(()=>{const e=()=>{O===I.WO.CONNECTED&&(ln()(i.trim())||s(i),k())};return(0,h.jsx)(ra,{endChat:n,sendChat:e,toggleMenu:c,isPreview:Z,isComposerFocused:B,children:(0,h.jsx)(pa,{isMobile:f,currentMessage:i,sendChat:e,handleChatBoxChange:e=>{O===I.WO.CONNECTED&&r(e)},onFocus:()=>{H(!0)},onBlur:()=>{H(!1)}})})})(),(0,h.jsx)(hr,{})]})};Tr.propTypes={activeAgents:s().object.isRequired,agentsTyping:s().array.isRequired,allAgents:s().object.isRequired,conciergeSettings:s().object.isRequired,currentMessage:s().string.isRequired,fetchConversationHistory:s().func,firstMessageTimestamp:s().number,handleChatBoxChange:s().func.isRequired,hasMoreHistory:s().bool,hideZendeskLogo:s().bool,historyRequestStatus:s().string,isMobile:s().bool,isPreview:s().bool,latestQuickReply:s().object,markAsRead:s().func,notificationCount:s().number,queuePosition:s().number,resetCurrentMessage:s().func,sendMsg:s().func.isRequired,showAvatar:s().bool.isRequired,showChatEndFn:s().func.isRequired,showContactDetails:s().func.isRequired,socialLogin:s().object,toggleMenu:s().func.isRequired,updateChatScreen:s().func.isRequired,visible:s().bool,connection:s().string};const Pr={fetchConversationHistory:_.Be,handleChatBoxChange:_.tH,markAsRead:_.zJ,resetCurrentMessage:_.jB,sendMsg:_.g_,updateChatScreen:_.a9},Ir=(0,a.$j)((e=>({activeAgents:w.Vy(e),agentsTyping:w.FZ(e),allAgents:w.ud(e),conciergeSettings:(0,qe.B9)(e),currentMessage:v.hG(e),firstMessageTimestamp:v.yH(e),hasMoreHistory:Se(e),historyRequestStatus:ke(e),latestQuickReply:w.O3(e),notificationCount:v.of(e),queuePosition:v.Pv(e),showAvatar:w.oA(e),socialLogin:v.cA(e),visible:(0,qe.sw)(e),connection:v.B5(e)})),Pr,null,{forwardRef:!0})(Tr),Er=e=>{let{rating:t,sendChatRating:i,sendChatComment:n,endChat:s,updateChatScreen:o}=e;const a=(0,M.Z)();return(0,h.jsxs)(p.Z,{children:[(0,h.jsx)(Hi,{}),(0,h.jsx)(Jt,{}),(0,h.jsx)(g.Z,{children:(0,h.jsx)(en,{rating:t,handleSecondaryButtonClick:()=>{s(),o(j.ew)},submitForm:(e,t)=>{i(e),t&&n(t),s(),o(j.ew)},secondaryButtonText:a("embeddable_framework.chat.postChat.rating.button.skip")})}),(0,h.jsx)(f.Z,{})]})},Nr={sendChatRating:_.cq,sendChatComment:_.Zf,endChat:_.Nl,updateChatScreen:_.a9};Er.propTypes={rating:Vi.chatRating.isRequired,sendChatRating:s().func.isRequired,sendChatComment:s().func.isRequired,endChat:s().func.isRequired,updateChatScreen:s().func.isRequired};const Rr=(0,a.$j)((e=>({isChatting:(0,v.OQ)(e),rating:(0,v.sc)(e)})),Nr,null,{forwardRef:!0})(Er);var Ar=i(33355);class Lr extends o.Component{static propTypes={attachmentsEnabled:s().bool.isRequired,screen:s().string.isRequired,sendAttachments:s().func.isRequired,isMobile:s().bool,handleReconnect:s().func.isRequired,updateContactDetailsVisibility:s().func.isRequired,updateEmailTranscriptVisibility:s().func.isRequired,updateChatBackButtonVisibility:s().func,updateMenuVisibility:s().func,menuVisible:s().bool,connection:s().string.isRequired,hideZendeskLogo:s().bool,isLoggingOut:s().bool.isRequired,updateEndChatModalVisibility:s().func,isPreview:s().bool};static defaultProps={attachmentsEnabled:!1,isMobile:!1,sendEmailTranscript:()=>{},emailTranscript:{},resetEmailTranscript:()=>{},updateChatBackButtonVisibility:()=>{},updateMenuVisibility:()=>{},menuVisible:!1,connection:"",departments:{},clearDepartment:()=>{},hideZendeskLogo:!1,isLoggingOut:!1,isPreview:!1};constructor(e){super(e),this.state={endChatFromFeedbackForm:!1},this.menu=null}componentDidMount(){this.props.updateChatBackButtonVisibility()}toggleMenu=()=>{this.props.updateMenuVisibility(!this.props.menuVisible)};onKeyDown=e=>{e.keyCode===l.KEY_CODES.ESCAPE&&this.props.menuVisible&&(e.stopPropagation(),this.props.updateMenuVisibility(!1))};showContactDetailsFn=e=>{e.stopPropagation(),this.props.updateContactDetailsVisibility(!0)};renderPrechatScreen=()=>{if(this.props.screen===j.KF||this.props.screen===j.fb||this.props.screen===j.dG)return(0,h.jsx)(ot,{hideZendeskLogo:this.props.hideZendeskLogo,isMobile:this.props.isMobile,isPreview:this.props.isPreview})};renderChatScreen=()=>{if(this.props.screen!==j.ew)return;return(0,h.jsx)(Ir,{toggleMenu:this.toggleMenu,showChatEndFn:e=>{e.stopPropagation(),this.props.updateMenuVisibility(!1),this.props.updateEndChatModalVisibility(!0),this.props.updateContactDetailsVisibility(!1),this.props.updateEmailTranscriptVisibility(!1)},hideZendeskLogo:this.props.hideZendeskLogo,isMobile:this.props.isMobile,showContactDetails:this.showContactDetailsFn,isPreview:this.props.isPreview})};handleDragDrop=e=>this.props.sendAttachments(e);renderAttachmentsBox=()=>{const{screen:e,attachmentsEnabled:t,isPreview:i}=this.props;if(e===j.ew&&t&&!i)return(0,h.jsx)(at.Q1,{onDrop:this.handleDragDrop})};renderChatRatingPage=()=>this.props.screen!==j.Yw?null:(0,h.jsx)(sn,{});renderPostChatPage=()=>this.props.screen!==j.DW?null:(0,h.jsx)(Rr,{});renderChatReconnectionBubble=()=>{const{connection:e,isLoggingOut:t}=this.props;if(e===I.WO.CONNECTING&&!t)return(0,h.jsx)(wt,{})};renderAgentListScreen=()=>this.props.screen!==j.fm?null:(0,h.jsx)(Ot,{});renderChatReconnectButton=()=>{const{connection:e,isLoggingOut:t}=this.props;if(e===I.WO.CLOSED&&!t)return(0,h.jsx)(ft,{onClick:this.props.handleReconnect})};render=()=>(0,h.jsx)("div",{onKeyDown:this.onKeyDown,role:"presentation",className:Ar.locals.chat,children:(0,h.jsxs)(at.kv,{children:[this.renderPrechatScreen(),this.renderChatScreen(),this.renderAgentListScreen(),this.renderChatRatingPage(),this.renderPostChatPage(),this.renderAttachmentsBox(),this.renderChatReconnectionBubble(),this.renderChatReconnectButton()]})})}const Mr={sendAttachments:_.mJ,sendEmailTranscript:ct,resetEmailTranscript:_.KQ,updateMenuVisibility:lt,handleReconnect:_.Nx,updateContactDetailsVisibility:_.fj,updateEmailTranscriptVisibility:_.Nw,updateEndChatModalVisibility:_.KH},zr=(0,a.$j)((e=>({attachmentsEnabled:(0,v.c_)(e),screen:(0,v.Cb)(e),emailTranscript:(0,v.Fu)(e),menuVisible:(0,v.de)(e),connection:(0,v.B5)(e),departments:(0,v.Ps)(e),isLoggingOut:(0,v.H_)(e)})),Mr,null,{forwardRef:!0})(Lr);var Zr=i(91855);class Or extends o.Component{static propTypes={historyLength:s().number,hasMoreHistory:s().bool,historyRequestStatus:s().oneOf([I.EI.PENDING,I.EI.DONE,I.EI.FAIL]),isMobile:s().bool,allAgents:s().object.isRequired,showAvatar:s().bool.isRequired,fetchConversationHistory:s().func,firstMessageTimestamp:s().number,title:s().string};static defaultProps={isMobile:!1,concierges:[],historyLength:0,hasMoreHistory:!1,historyRequestStatus:"",allAgents:{},fetchConversationHistory:()=>{},firstMessageTimestamp:null,showContactDetails:()=>{},markAsRead:()=>{}};constructor(e){super(e),this.scrollContainer=null,this.scrollHeightBeforeUpdate=null,this.scrollToBottomTimer=null}componentDidMount(){const{historyLength:e}=this.props;e>0&&this.scrollToBottom()}UNSAFE_componentWillUpdate(e){e.historyRequestStatus===I.EI.PENDING&&this.props.historyRequestStatus===I.EI.DONE&&(this.scrollHeightBeforeUpdate=this.scrollContainer.scrollHeight)}componentDidUpdate(){this.scrollContainer&&this.didUpdateFetchHistory()}componentWillUnmount(){clearTimeout(this.scrollToBottomTimer)}didUpdateFetchHistory=()=>{if(!this.scrollHeightBeforeUpdate)return;const e=this.scrollContainer.scrollTop,t=this.scrollContainer.scrollHeight-this.scrollHeightBeforeUpdate;0!==t&&(this.scrollContainer.scrollTop=e+t,this.scrollHeightBeforeUpdate=null)};isScrollCloseToBottom=()=>!!this.scrollContainer&&jr(this.scrollContainer)<I.SC;scrollToBottom=()=>{this.scrollToBottomTimer=(0,li.Fc)((()=>{this.scrollContainer&&(this.scrollContainer.scrollTop=this.scrollContainer.scrollHeight)}))};handleChatScreenScrolled=()=>{this.scrollContainer&&0===this.scrollContainer.scrollTop&&this.props.hasMoreHistory&&this.props.historyRequestStatus!==I.EI.PENDING&&this.props.fetchConversationHistory()};render=()=>{const{isMobile:e,title:t}=this.props,i=un()(Zr.locals.chatLogContainer,{[Zr.locals.chatLogContainerMobile]:e});return(0,h.jsxs)(p.Z,{children:[(0,h.jsx)(u.Z,{title:t}),(0,h.jsx)(g.Z,{ref:e=>{this.scrollContainer=e},onScroll:this.handleChatScreenScrolled,className:un()({[Zr.locals.scrollBarFix]:(0,r.vU)()}),children:(0,h.jsxs)("div",{className:i,children:[(0,h.jsx)(xo,{isMobile:this.props.isMobile,showAvatar:this.props.showAvatar,agents:this.props.allAgents,firstMessageTimestamp:this.props.firstMessageTimestamp}),(0,h.jsx)(ya,{loading:"pending"===this.props.historyRequestStatus})]})}),(0,h.jsx)(f.Z,{})]})}}const qr={updateChatScreen:_.a9,fetchConversationHistory:_.Be},Dr=(0,a.$j)((e=>({historyLength:Te(e),hasMoreHistory:Se(e),historyRequestStatus:ke(e),allAgents:w.ud(e),visitor:v.X8(e),showAvatar:w.oA(e),firstMessageTimestamp:v.yH(e),title:(0,qe.U)(e)})),qr,null,{forwardRef:!0})(Or);var Br=i(41234);const Hr=(0,E.ZP)(ee.zx).withConfig({displayName:"styles__StyledButton",componentId:"sc-1xu2k2-0"})(["width:100%;"]),Fr=E.ZP.p.withConfig({displayName:"styles__Greeting",componentId:"sc-1xu2k2-1"})(["margin-top:","rem;font-size:","rem;color:",";flex-grow:1;"],(e=>6/e.theme.fontSize),(e=>15/e.theme.fontSize),(e=>e.theme.palette.grey[800])),Kr=E.ZP.div.withConfig({displayName:"styles__InnerContentContainer",componentId:"sc-1xu2k2-2"})(["flex-direction:column;display:flex;padding-bottom:","rem;height:100%;"],(e=>25/e.theme.fontSize)),Ur=e=>{let{title:t,onButtonClick:i}=e;const n=(0,M.Z)();return(0,h.jsxs)(p.Z,{children:[(0,h.jsx)(u.Z,{title:t}),(0,h.jsx)(g.Z,{children:(0,h.jsxs)(Kr,{children:[(0,h.jsx)(Me,{}),(0,h.jsx)(Fr,{"data-testid":d.z7.FORM_GREETING_MSG,children:n("embeddable_framework.chat.offline.label.noForm")}),(0,h.jsx)(Hr,{isPrimary:!0,onClick:i,children:n("embeddable_framework.chat.offline.button.close")})]})})]})};Ur.propTypes={title:s().string.isRequired,onButtonClick:s().func.isRequired};const Vr=(0,a.$j)((e=>({title:(0,qe.U)(e)})),{onButtonClick:Pi.x8})(Ur);var $r;function Gr(){return Gr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},Gr.apply(this,arguments)}const Wr=e=>{let{title:t,titleId:i,...n}=e;return o.createElement("svg",Gr({xmlns:"http://www.w3.org/2000/svg",height:25,width:25,viewBox:"0 0 25 25","aria-labelledby":i},n),t?o.createElement("title",{id:i},t):null,$r||($r=o.createElement("path",{d:"M12.5 6.25c-3.452 0-6.25 2.59-6.25 5.786 0 1.817.906 3.44 2.322 4.5v2.214l2.133-1.17a6.77 6.77 0 0 0 1.795.24c3.452 0 6.25-2.59 6.25-5.784 0-3.196-2.798-5.786-6.25-5.786zm.674 7.256l-1.655-1.433-3.19 1.47 3.493-3.09 1.655 1.432 3.186-1.468-3.493 3.09zM25 12.5A12.5 12.5 0 0 1 12.5 25 12.5 12.5 0 0 1 0 12.5 12.5 12.5 0 0 1 12.5 0 12.5 12.5 0 0 1 25 12.5z",fillRule:"evenodd"})))};var Qr;function Xr(){return Xr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},Xr.apply(this,arguments)}const Yr=e=>{let{title:t,titleId:i,...n}=e;return o.createElement("svg",Xr({width:25,height:25,viewBox:"0 0 25 25",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":i},n),t?o.createElement("title",{id:i},t):null,Qr||(Qr=o.createElement("path",{d:"M12.5 25C5.596 25 0 19.404 0 12.5S5.596 0 12.5 0 25 5.596 25 12.5 19.404 25 12.5 25zm-2.142-6.337c5.23 0 8.09-4.333 8.09-8.09 0-.123-.002-.246-.008-.367.555-.402 1.038-.903 1.42-1.473-.51.227-1.06.38-1.634.448.587-.35 1.038-.9 1.25-1.57-.55.33-1.158.57-1.805.69-.51-.55-1.25-.9-2.07-.9-1.57 0-2.84 1.28-2.84 2.85 0 .225.026.44.074.65-2.363-.117-4.46-1.25-5.86-2.97-.245.42-.385.91-.385 1.43 0 .986.5 1.857 1.265 2.367-.467-.015-.905-.143-1.29-.356v.037c0 1.378.98 2.528 2.28 2.79-.236.064-.49.1-.75.1-.18 0-.36-.02-.532-.053.363 1.13 1.413 1.953 2.658 1.976-.972.763-2.2 1.22-3.53 1.22-.23 0-.455-.016-.68-.04 1.26.804 2.755 1.275 4.36 1.275z",fillRule:"evenodd"})))},Jr=E.ZP.div.withConfig({displayName:"ChatMessagingChannelsStyles__Container",componentId:"sc-1xt2rnf-0"})(["margin-bottom:","rem;"],(e=>15/e.theme.fontSize)),el=e=>`\nmin-width: ${(e.mobile?40:24)/e.theme.fontSize}rem;\nmin-height: ${(e.mobile?40:24)/e.theme.fontSize}rem;\nmax-width: ${(e.mobile?40:24)/e.theme.fontSize}rem;\nmax-height: ${(e.mobile?40:24)/e.theme.fontSize}rem;\nheight: ${(e.mobile?40:24)/e.theme.fontSize}rem;\nwidth: ${(e.mobile?40:24)/e.theme.fontSize}rem;\n`,tl=E.ZP.a.withConfig({displayName:"ChatMessagingChannelsStyles__ChannelIcon",componentId:"sc-1xt2rnf-1"})(["display:inline-block;padding-right:","rem;",""],(e=>(e.theme.isMobile?12:8)/e.theme.fontSize),(e=>e.theme.rtl&&`\n    padding-right: 0;\n    padding-left: ${(e.theme.isMobile?12:8)/e.theme.fontSize}rem;\n  `)),il=(0,E.ZP)(Yr).withConfig({displayName:"ChatMessagingChannelsStyles__StyledTwitterIcon",componentId:"sc-1xt2rnf-2"})([""," path{fill:#1da1f2;}"],el),nl=E.ZP.div.withConfig({displayName:"ChatMessagingChannelsStyles__ButtonsContainer",componentId:"sc-1xt2rnf-3"})(["margin-top:","rem;"],(e=>8/e.theme.fontSize)),sl=(0,E.ZP)(Wr).withConfig({displayName:"ChatMessagingChannelsStyles__StyledMessengerIcon",componentId:"sc-1xt2rnf-4"})([""," path{fill:#0084ff;}"],el),ol=e=>{let{channels:{facebook:t,twitter:i},theme:{isMobile:n}}=e;const s=(0,M.Z)(),{allowed:o,page_id:a}=t,{allowed:r,page_id:l}=i;return o||r?(0,h.jsxs)(Jr,{children:[(0,va.fA)("label",s("embeddable_framework.chat.messagingChannels.title"),!0),(0,h.jsxs)(nl,{children:[o&&(0,h.jsx)(tl,{href:`https://m.me/${a}`,target:"_blank",rel:"noopener noreferrer",isMobile:n?"true":null,children:(0,h.jsx)(sl,{mobile:n?"true":null,"data-testid":d.z7.ICON_MESSENGER})}),r&&(0,h.jsx)(tl,{href:`https://twitter.com/messages/compose?recipient_id=${l}`,target:"_blank",rel:"noopener noreferrer",isMobile:n?"true":null,children:(0,h.jsx)(il,{mobile:n?"true":null,"data-testid":d.z7.ICON_TWITTER})})]})]}):null};ol.propTypes={channels:s().shape({facebook:s().shape({allowed:s().bool,page_id:s().string}),twitter:s().shape({allowed:s().bool,page_id:s().string})}),theme:s().shape({isMobile:s().bool})};const al=(0,E.Zz)(ol),rl=()=>{const e=(0,G.cI)(),t=(0,o.useCallback)((t=>{e.batch((()=>{t.display_name&&e.change("name",t.display_name),t.email&&e.change("email",t.email)}))}),[e]),i=(0,o.useCallback)((function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.batch((()=>{t.name&&e.change("name",t.name),t.email&&e.change("email",t.email),t.phone&&e.change("phone",t.phone)}))}),[e]);return(0,W.Z)("identify","offline-form",t),(0,W.Z)("prefill","offline-form",i),null},ll=(0,E.ZP)(K.ZP).withConfig({displayName:"styles__OfflineGreetingLink",componentId:"sc-yb4gcd-0"})(["margin-top:","rem !important;display:block;white-space:pre-wrap;margin-bottom:","rem;"],(e=>5/e.theme.fontSize),(e=>9/e.theme.fontSize)),dl=e=>{let{greeting:t}=e;return(0,h.jsx)(ll,{properties:{target:"_blank"},children:(0,h.jsx)("span",{"data-testid":d.z7.FORM_GREETING_MSG,children:t})})};dl.propTypes={greeting:s().string};const cl=dl,hl=(0,E.ZP)(ee.zx).withConfig({displayName:"styles__OperatingHoursLink",componentId:"sc-iyhaaa-0"})(["&&&{color:"," !important;cursor:pointer;text-decoration:underline !important;display:block !important;line-height:","rem !important;height:auto !important;margin-bottom:","rem;&:hover{text-decoration:none !important;}}"],(e=>e.theme.palette.grey[800]),(e=>17/e.theme.fontSize),(e=>9/e.theme.fontSize)),ml=e=>{let{onClick:t}=e;const i=(0,M.Z)();return(0,h.jsx)(hl,{isLink:!0,onClick:t,children:i("embeddable_framework.chat.operatingHours.label.anchor")})};ml.propTypes={onClick:s().func.isRequired};const pl=ml,ul={name:e=>{let{field:t,value:i}=e;if(t.required&&!i)return"embeddable_framework.validation.error.name"},email:e=>{let{field:t,value:i}=e;return t.required&&!i?"embeddable_framework.validation.error.email":i?d.QI.test(i)?void 0:"embeddable_framework.validation.error.email":void 0},phone:e=>{let{field:t,value:i}=e;return t.required&&!i?"embeddable_framework.validation.error.phone":i?d.mj.test(i)?void 0:"embeddable_framework.validation.error.phone":void 0},message:e=>{let{field:t,value:i}=e;if(t.required&&!i)return"embeddable_framework.validation.error.message"}},gl=e=>{let{values:t,fields:i}=e;const n={};if(i.forEach((e=>{const i=ul[e.id]?.({value:t[e.id],field:e});i&&(n[e.id]=i)})),Object.keys(n).length>0)return n},fl=e=>{let{authUrls:t,formSettings:{channels:i,message:n},getFields:s,handleOperatingHoursClick:o,initiateSocialLogout:a,isAuthenticated:r,isPreview:l=!1,operatingHours:d={enabled:!1},readOnlyValues:c,onSubmit:m,setHasSubmitted:p,socialLogin:u,visitor:g}=e;const b=(0,M.Z)(),y=!ln()(i),C=r||u.authenticated;return(0,h.jsxs)(T.Z,{controls:(0,h.jsx)(rl,{}),formId:"offline-form",onSubmit:async e=>{try{return await m(e,C?{name:g.display_name,email:g.email}:{}),p(),{success:!0}}catch{return{success:!1}}},getFields:s,isPreview:l,validate:e=>gl({values:e,isAuthenticated:r,fields:s()}),footer:e=>{let{isSubmitting:t}=e;return(0,h.jsx)(f.Z,{children:(0,h.jsx)(P.Z,{label:b("embeddable_framework.chat.preChat.offline.button.sendMessage"),submitting:t})})},extraFieldOptions:{socialLogin:()=>(0,h.jsx)(fe,{authUrls:t})},readOnlyValues:c,children:[(0,h.jsx)(Me,{}),n&&(0,h.jsx)(cl,{greeting:n}),d.enabled&&(0,h.jsx)(pl,{onClick:o}),y&&(0,h.jsx)(al,{channels:i}),C&&(0,h.jsx)(F,{visitor:g,socialLogin:u,initiateSocialLogout:a})]})};fl.propTypes={authUrls:fe.propTypes.authUrls,formSettings:s().shape({message:s().string,channels:s().shape({facebook:s().shape({allowed:s().bool,page_id:s().string}),twitter:s().shape({allowed:s().bool,page_id:s().string})})}),getFields:s().func.isRequired,handleOperatingHoursClick:s().func.isRequired,initiateSocialLogout:s().func.isRequired,isAuthenticated:s().bool.isRequired,isPreview:s().bool,offlineMessage:s().shape({screen:s().string}),operatingHours:s().object,readOnlyValues:s().objectOf(s().bool),onSubmit:s().func.isRequired,setHasSubmitted:s().func.isRequired,socialLogin:F.propTypes.socialLogin,visitor:s().shape({display_name:s().string,email:s().string})};const bl={handleOperatingHoursClick:_.Gv,initiateSocialLogout:_.XX,onSubmit:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async i=>new Promise(((n,s)=>{i((0,_.pI)({...e,...t},n,s))}))}},yl=(0,a.$j)((e=>({authUrls:(0,w.zC)(e),formSettings:(0,qe._v)(e),getFields:()=>(e=>{const{phoneEnabled:t}=(0,v.G7)(e),i=(0,qe.O3)(e),n=(0,v.j3)(e),s=(0,v.cA)(e).authenticated;return[{id:"name",title:Oe.a.t("embeddable_framework.common.textLabel.name"),required:Boolean(i.name?.required),visible:!n&&!s,type:"text"},{id:"socialLogin",type:"socialLogin",visible:!n&&!s},{id:"email",title:Oe.a.t("embeddable_framework.common.textLabel.email"),required:Boolean(i.email?.required),visible:!n&&!s,type:"email"},{id:"phone",title:Oe.a.t("embeddable_framework.common.textLabel.phone_number"),required:Boolean(i.phone?.required),visible:!n&&t,type:"text"},{id:"message",title:Oe.a.t("embeddable_framework.common.textLabel.message"),required:Boolean(i.message?.required),visible:!0,type:"textarea"}].filter((e=>e.visible))})(e),isAuthenticated:(0,v.j3)(e),operatingHours:(0,w.PV)(e),readOnlyValues:(0,v.ek)(e),socialLogin:(0,v.cA)(e),visitor:(0,v.X8)(e)})),bl)(fl);var Cl=i(8202),xl=i(57289);const wl=e=>{let{onClick:t}=e;const i=(0,M.Z)(),n=(0,a.I0)(),s=(0,a.v9)((e=>(0,xl.X)(e,"offline-form")));return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(g.Z,{children:(0,h.jsx)(Qe.Z,{icon:(0,h.jsx)(We.Z,{}),doneText:i("embeddable_framework.common.button.done"),onClick:()=>{n((0,Cl.uC)("offline-form",{...s,message:""})),t()}})}),(0,h.jsx)(Ye,{hideButton:!0,scrollShadowVisible:!1})]})};wl.propTypes={onClick:s().func.isRequired};const vl=wl,_l=e=>{let{title:t}=e;const[i,n]=(0,o.useState)(!1);return(0,h.jsxs)(p.Z,{children:[(0,h.jsx)(u.Z,{title:t}),!i&&(0,h.jsx)(yl,{setHasSubmitted:()=>n(!0)}),i&&(0,h.jsx)(vl,{onClick:()=>n(!1)})]})};_l.propTypes={title:s().string.isRequired};const jl=(0,a.$j)((e=>({title:(0,qe.U)(e)})),{handleOfflineFormBack:_.Uy})(_l);var Sl=i(25292),kl=i.n(Sl);const Tl=e=>{let{departmentSchedule:t,selectedDepartment:i,setSelectedDepartment:n,theme:s}=e;const o=(0,M.Z)(),a=(0,di.ND)(),r=t.map((e=>(0,h.jsx)(ri.ck,{value:String(e.id),children:e.name},e.id))),{name:l}=Ze()(t,(e=>e.id.toString()===i));return(0,h.jsxs)(ri.Lt,{name:"department",selectedItem:String(i),onSelect:e=>n(e),downshiftProps:{environment:a.window},children:[(0,h.jsxs)(ri.gN,{children:[(0,h.jsx)(ri.__,{children:o("embeddable_framework.chat.form.common.dropdown.chooseDepartment")}),(0,h.jsx)(ri.Ph,{children:l})]}),(0,h.jsx)(ri.v2,{style:{maxHeight:140/s.fontSize+"rem",overflow:"auto"},popperModifiers:{flip:{enabled:!1},preventOverflow:{escapeWithReference:!0}},children:r})]})};Tl.propTypes={departmentSchedule:s().array.isRequired,selectedDepartment:s().string.isRequired,setSelectedDepartment:s().func.isRequired,theme:s().shape({fontSize:s().number})};const Pl=(0,E.Zz)(Tl),Il=E.ZP.dl.withConfig({displayName:"styles__DayList",componentId:"sc-5fi5af-0"})(["font-size:","rem;margin:","rem 0;"],(e=>15/e.theme.fontSize),(e=>16/e.theme.fontSize)),El=E.ZP.dt.withConfig({displayName:"styles__DayName",componentId:"sc-5fi5af-1"})(["font-size:","rem;font-weight:bold;padding-bottom:","rem;"],(e=>15/e.theme.fontSize),(e=>4/e.theme.fontSize)),Nl=E.ZP.dd.withConfig({displayName:"styles__LastTiming",componentId:"sc-5fi5af-2"})(["padding-bottom:","rem;"],(e=>12/e.theme.fontSize)),Rl=E.ZP.dd.withConfig({displayName:"styles__Hours",componentId:"sc-5fi5af-3"})(["",""],(e=>e.lastTiming&&`margin-bottom: ${12/e.theme.fontSize}rem;`)),Al=e=>{let{days:t}=e;const i=(0,M.Z)(),n=e=>i(`embeddable_framework.chat.operatingHours.label.${["monday","tuesday","wednesday","thursday","friday","saturday","sunday"][e-1]}`);return(0,h.jsx)(El,{children:t.map((e=>Array.isArray(e)?e.map(n).join(i("embeddable_framework.chat.operatingHours.label.separator.range")):n(e))).join(i("embeddable_framework.chat.operatingHours.label.separator.overall"))})};Al.propTypes={days:s().oneOfType([s().array,s().number])};const Ll=Al;function Ml(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en-US";const i=new Intl.DateTimeFormat(t,{hour:"numeric",minute:"numeric"}),n=parseInt(e,10),s=Math.floor(n/60),o=n%60;return i.format(new Date(2018,10,15,s,o,0))}const zl=e=>{let{periods:t,locale:i}=e;const n=(0,M.Z)();return 0===t.length?(0,h.jsx)(Nl,{children:n("embeddable_framework.chat.operatingHours.label.closed")},"dd--closed"):t.map(((e,s)=>{const o=s===t.length-1;return(0,h.jsx)(Rl,{lastTiming:o,children:0===e.start&&1440===e.end?n("embeddable_framework.chat.operatingHours.label.openAllDay"):n("embeddable_framework.chat.operatingHours.label.timeRange",{openingTime:Ml(e.start,i),closingTime:Ml(e.end,i)})},`dd-${s}`)}))};zl.propTypes={periods:s().arrayOf(s().shape({start:s().number,end:s().number})),locale:s().string.isRequired};const Zl=zl,Ol=e=>{let{schedule:t,locale:i}=e;return(0,h.jsx)(Il,{children:t.map(((e,t)=>(0,h.jsxs)("div",{children:[(0,h.jsx)(Ll,{days:e.days},`dt-${t}`),(0,h.jsx)(Zl,{periods:e.periods,locale:i},`gp-${t}`)]},t)))})};Ol.propTypes={schedule:s().arrayOf(s().shape({days:s().oneOfType([s().array,s().number]),periods:s().arrayOf(s().shape({start:s().number,end:s().number}))})).isRequired,locale:s().string.isRequired};const ql=Ol,Dl=E.ZP.div.withConfig({displayName:"styles__Title",componentId:"sc-165qc4e-0"})(["font-size:","rem;span{font-weight:normal;}"],(e=>15/e.theme.fontSize)),Bl=(0,E.ZP)(ee.zx).withConfig({displayName:"styles__Button",componentId:"sc-165qc4e-1"})(["max-width:100%;width:100%;&&{margin-bottom:","rem;}"],(e=>16/e.theme.fontSize)),Hl=e=>{let{operatingHours:t,handleOfflineFormBack:i,locale:n}=e;const s=t.department_schedule?(()=>{const{department_schedule:e}=t;return kl()(e).id.toString()})():null,a=(0,M.Z)(),[r,l]=(0,o.useState)(s),d=a("embeddable_framework.chat.operatingHours.label.title",{timezone:`<span>(${t.timezone})</span>`}),c=r?(()=>{const{department_schedule:e}=t;return Ze()(e,(e=>e.id.toString()===r)).schedule})():t.account_schedule;return(0,h.jsxs)("div",{children:[(0,h.jsx)(Dl,{dangerouslySetInnerHTML:{__html:d}}),r&&(0,h.jsx)(Pl,{departmentSchedule:t.department_schedule,selectedDepartment:r,setSelectedDepartment:l}),(0,h.jsx)(ql,{schedule:c,locale:n}),(0,h.jsx)(Bl,{isPrimary:!0,onClick:i,children:a("embeddable_framework.common.button.goBack")})]})};Hl.propTypes={operatingHours:s().object.isRequired,locale:s().string.isRequired,handleOfflineFormBack:s().func.isRequired};const Fl=Hl,Kl=e=>{let{handleOfflineFormBack:t,operatingHours:i,title:n,locale:s}=e;return(0,h.jsxs)(p.Z,{children:[(0,h.jsx)(u.Z,{title:n}),(0,h.jsx)(g.Z,{children:(0,h.jsx)(Fl,{handleOfflineFormBack:t,operatingHours:i,locale:s})})]})};Kl.propTypes={handleOfflineFormBack:s().func.isRequired,operatingHours:s().shape({}).isRequired,title:s().string.isRequired,locale:s().string.isRequired};const Ul={handleOfflineFormBack:_.Uy},Vl=(0,a.$j)((e=>({operatingHours:(0,w.PV)(e),title:(0,qe.U)(e),locale:(0,Ii.Kd)(e)})),Ul)(Kl),$l=e=>{let{formSettings:{enabled:t=!1},offlineMessage:{screen:i}}=e;return i===I.nd.OPERATING_HOURS?(0,h.jsx)(Vl,{}):t?(0,h.jsx)(jl,{}):(0,h.jsx)(Vr,{})};$l.propTypes={formSettings:s().shape({enabled:s().bool}).isRequired,offlineMessage:s().shape({screen:s().oneOf(Object.values(I.nd))})};const Gl=(0,a.$j)((e=>({formSettings:(0,qe._v)(e),offlineMessage:(0,v.AC)(e)})),null,null,{forwardRef:!0})($l);var Wl=i(4246);class Ql extends o.Component{static propTypes={hasSdkConnected:s().bool.isRequired,isMobile:s().bool,hideZendeskLogo:s().bool,showOfflineChat:s().bool.isRequired,showChatHistory:s().bool.isRequired,isPreview:s().bool,chatStandalone:s().bool,helpCenterAvailable:s().bool,channelChoiceAvailable:s().bool,updateBackButtonVisibility:s().func};static defaultProps={isMobile:!1,hideZendeskLogo:!1,isPreview:!1};handleDragEnter=()=>{this.online&&this.online.handleDragEnter()};renderChatHistory=()=>{if(this.props.showChatHistory)return(0,h.jsx)(Dr,{hideZendeskLogo:this.props.hideZendeskLogo})};renderChatOnline=()=>{if(!this.props.showOfflineChat&&!this.props.showChatHistory)return(0,h.jsx)(zr,{ref:e=>{this.online=e},isMobile:this.props.isMobile,updateChatBackButtonVisibility:()=>{this.props.chatStandalone||this.props.updateBackButtonVisibility(this.props.helpCenterAvailable||this.props.channelChoiceAvailable)},hideZendeskLogo:this.props.hideZendeskLogo,isPreview:this.props.isPreview})};renderChatOffline=()=>{if(this.props.showOfflineChat&&!this.props.showChatHistory)return(0,h.jsx)(Gl,{})};render(){return this.props.hasSdkConnected?(0,h.jsxs)("div",{children:[this.renderChatHistory(),this.renderChatOnline(),this.renderChatOffline()]}):(0,h.jsx)(Br.Z,{})}}const Xl=(0,a.$j)((e=>({showOfflineChat:(0,w.G2)(e),showChatHistory:(0,v._A)(e),hasSdkConnected:(0,v.OH)(e),isMobile:(0,r.K1)(),hideZendeskLogo:(0,pi.Dh)(e),chatStandalone:(0,Ii.Nw)(e),helpCenterAvailable:(0,ui.dN)(e),channelChoiceAvailable:(0,pi.nd)(e)})),{updateBackButtonVisibility:Wl.LO},null,{forwardRef:!0})(Ql)},3351:(e,t,i)=>{i.d(t,{K:()=>h});var n=i(4014),s=i.n(n),o=i(98049),a=i.n(o),r=i(15826),l=i(9775),d=i(78937),c=i(55786);class h extends r.Component{static propTypes={children:a().node.isRequired,className:a().string,onClick:a().func,title:a().string};render(){return(0,c.jsx)(l.KeyboardFocusContainer,{children:e=>{let{keyboardFocused:t,getFocusProps:i}=e;const n=s()(d.locals.button,this.props.className,{[d.locals.keyboardFocus]:t});return(0,c.jsx)("button",{...i({className:n,onClick:this.props.onClick,title:this.props.title}),children:this.props.children})}})}}},95216:(e,t,i)=>{i.d(t,{Z:()=>a});var n=i(15826),s=i(41613),o=i(11814);const a=e=>{const t=(0,n.useRef)(!1);return{handleCompositionStart:()=>t.current=!0,handleCompositionEnd:()=>t.current=!0,handleKeyDown:i=>{if((i.key!==o.D.ENTER||!i.shiftKey)&&i.key===o.D.ENTER){if(i.nativeEvent.isComposing)return;if((0,s.G6)()&&t.current)return;i.preventDefault(),e()}},handleKeyUp:()=>t.current=!1}}},55387:(e,t,i)=>{i.d(t,{L5:()=>r,fA:()=>l});i(69104),i(72651),i(57137);var n=i(46136),s=i.n(n),o=i(32257),a=i(55786);const r=(e,t)=>{if(!e)return null;const i=s()(e,{allowedTags:[]});return t?`<strong>${i}</strong>`:o.a.t("embeddable_framework.validation.label.new_optional",{label:i})},l=(e,t,i)=>{const n=r(t,i);return(0,a.jsx)(e,{dangerouslySetInnerHTML:{__html:n}})}}}]);