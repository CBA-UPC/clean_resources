(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[659],{aofH:function(e,t,o){"use strict";o.d(t,"a",();var n=o("Wx5u");unction i(e,t,o){o&&function(e,t){!function(e,t){var o;const n="object"==typeof e&&null!==e;function r(t){if(!n)return;const o=e[t];return"string"==typeof o?o:void 0}t.errorMessage=null!==(o=r("message"))&&void 0!==o?o:String(e),t.errorName=r("name"),t.stack=r("stack"),t.errorType=r("errorType"),t.errorInstanceId=r("errorInstanceId")}(t,e),e.message=e.message?`${e.message}\n${e.errorMessage}`:e.errorMessage,void 0===e.stack&&(e.stack=function(){let e=(new Error).stack;if(!e)try{throw new Error}catch(t){e=t.stack}return e}()),e.errorMessage&&(e.errorMessage=r(e.errorMessage.toString())),e.message&&(e.message=r(e.message.toString())),e.stack&&(e.stack=r(e.stack.toString())),e.error&&(e.error=r(e.error.toString())),e.responseMessage&&(e.responseMessage=r(e.responseMessage.toString()))}(t,o),e.send({...t,category:n.b.Error})}function a(e,t){e.send({...t,category:n.b.UserAction})}new Set,new Set,new Map([["Automation",1],["SyntheticTraffic",1],["Local",1],["Staging",1],["Dogfood",.1],["Preview",.1],["Microsoft",.01],["Production",.001],["GCC",0],["GCC-High",0],["DoD",0]]);var s=o("rwSX"),c=o("ccbu"),u=o("5+n6"),l=o("YIvB");const d="InsertComponentFromDiscover",p="InsertComponentFromDiscoverError";var v=o("VMWk");const m=let f;async function g(e){var t;void 0===f&&(f=await async function(e){const{locale:t=s.a,menuViewProvider:o}=e;if(void 0===o)return;const n=Object(s.c)(t),r=await async function(e){const t=await async function(e,t){const o=await e(t);return Object(v.a)(o,t)}(m,e);return{...t,menuAriaLabel:t.discoverMenuAriaLabel,listAriaLabel:t.discoverMenuListLabel}}(n);let g,y,D,C,w,b=!1,T=0,S=0,I="";return{async update(e){const{insertRequestData:t,producerCallback:n,logger:s,audience:v}=e,{floatingUXContext:m}=t.hostContext,k={...e,stringTable:r,coordinates:null==m?void 0:m.coordinates,coordinatesFlip:null==m?void 0:m.coordinatesFlip,ownerDocument:null==m?void 0:m.ownerDocument},E=await o.getView(k);if(void 0===E)return;const N=t.insertionContext;if(void 0!==N){const{onInsert:e,onInsertActivityBlueprint:o,onInsertComponent:r,onInsertBlueprint:m,onClose:k,queryText:x}=N,F=t=>{var o,n;if(void 0!==e){if(s)switch(t.configurationType){case"componentConfiguration":a(s,{eventName:d,componentType:t.loadComponentData.componentType.toString()});break;case"templateConfiguration":a(s,{eventName:"InsertActivityBlueprintFromDiscover",configurationId:null===(o=t.loadTemplateData.configurationId)||void 0===o?void 0:o.toString()})}try{e(t)}catch(e){if(s)switch(t.configurationType){case"componentConfiguration":s&&i(s,{eventName:p,componentType:t.loadComponentData.componentType.toString()},e);break;case"templateConfiguration":s&&i(s,{eventName:"InsertActivityBlueprintFromDiscoverError",configurationId:null===(n=t.loadTemplateData.configurationId)||void 0===n?void 0:n.toString()},e)}}}},q=e=>{if(void 0!==r){s&&a(s,{eventName:d,componentType:e.componentType.toString()});try{r(e)}catch(t){s&&i(s,{eventName:p,componentType:e.componentType.toString()},t)}}},A=e=>{if(void 0!==m){s&&a(s,{eventName:"InsertBlueprintFromDiscover"});try{m(e)}catch(o){var t;s&&i(s,{eventName:"InsertBlueprintFromDiscoverError",componentType:null===(t=e.componentType)||void 0===t?void 0:t.toString()},o)}}},O=e=>{!function(e){return e.isComponentData}(e)?e)?F&&F(e.configuration):e)&&o&&o(e):e.blueprintData?A(e.blueprintData):e.loaderData&&(q?q(e.loaderData):F&&F({configurationType:"componentConfiguration",loadComponentData:e.loaderData}))},L=e=>{switch(e){case"searchBackspace":return{restoreFocus:!0,dismissed:!0};case"searchEscape":case"calloutEscape":return{replaceWithExistingContent:!0,restoreFocus:!0,dismissed:!0};case"executeItem":return{restoreFocus:!0};case"calloutDismiss":return{replaceWithExistingContent:void 0!==(null==x?void 0:x()),dismissed:!0}}},B=(e,o,n)=>{const{replaceWithExistingContent:r=!1,restoreFocus:i=!1,dismissed:c=!1}=L(e);c&&s&&a(s,{eventName:"CloseDiscoverWithoutContentInserted",isLightDismiss:n}),null==k||k(!t.hostContext.preventContentInsertion&&r,o,i),E.clear(),f=void 0},{canHandleInlineComponentsOnly:j,permittedComponentDataTypes:R,disallowedComponentDataTypes:W,contextData:P,baseContextData:Q,showSearch:H}=t.hostContext,{lightDismissEnabled:J,shouldLightDismiss:U,announceSearchResults:z,transferFocus:V,insertFirstComponent:$,shouldForceClose:G,restoreFocusAndUpdateQuery:X}=t.insertionContext||{},_=async e=>{if(" "===e)return void B("calloutEscape",e,!0);y=void 0,T+=1;const t=T,o={searchQuery:e};n&&(await n("DiscoverData",o)).forEach((o=>{o.then((o=>{t===T&&Y(o,e,oe)})).catch((e=>{s&&i(s,{eventName:"Problem fetching discover data"},e)}))}))},Y=(e,t,o)=>{const n=Z(e,t),r=(y||[]).concat(n);if(P&&Z(P,t).filter((e=>!r.includes(e))).forEach((e=>r.push(e))),Q&&Z(Q,t,!0).filter(().forEach((),r){const e={searchResultsCount:r.length,queryLength:t.length,inputLengthOnLastSuggestion:S};J&&U&&U(e)?B("calloutEscape",t,!0):r.length>0&&(S=t.length)}var i;Object(c.b)()||!z||(null===(i=y)||void 0===i?void 0:i.length)===r.length&&0!==r.length||V||C||(C=setTimeout((()=>{let e="";y&&y.length>0&&(e=y[0].queryableData.displayName+" 1 of "+y.length+" selected",z(y.length,e))}),1e3)),y=r,o(r)},Z=(e,t,o)=>{let n=e.filter((e=>function(e,t){if(h(e.displayName,t))return!0;for(let o=0;o<e.keywords.length;o+=1)if(h(e.keywords[o],t))return!0;return!1}(e.queryableData,t)));return j&&(n=n.filter(()),o||void 0===R&&void 0===W||(n=n.filter((e=>{var t;const o=[];null===(t=e.queryableData.manifest)||void 0===t||t.forEach((e=>{void 0!==e.dataType&&o.push(e.dataType)}));for(const e of o){if(W&&W.indexOf(e)>=0)return!1;if(-1!==(null==R?void 0:R.indexOf(e)))return!0}return void 0===R}))),Object(u.a)("discover.testComponents",!1,void 0)||(n=n.filter((e=>{var t;return!(null!==(t=e.queryableData.properties)&&void 0!==t&&t.testComponent)}))),Object(u.a)("discover.dogfoodComponents",Object(l.a)("Dogfood",v),void 0)||(n=n.filter(()),n},K=e=>{I=e,void 0!==D&&clearTimeout(D),D=setTimeout((async()=>{void 0!==D&&(clearTimeout(D),D=void 0),await _(I)}),200),b=!1},ee=e=>{b||(b=!0,B(e,I,!1))},te=e=>!!b||e,oe=e=>{try{if(JSON.stringify(g)===JSON.stringify(e))return}catch(e){s&&i(s,{eventName:"DiscoverDataNotSerializableError"})}g=e,ne()},ne=()=>{const e=g?g.map((e=>({icon:e.queryableData.icon,displayName:e.queryableData.displayName,execute:))):void 0;E.render({onClose:ee,showSearch:H,shouldRequestFocus:V,searchResults:e,searchQuery:I,setSearchQuery:K,restoreFocusAndUpdateQuery:X,shouldPreventDismiss:te});try{const e=performance.measure("timeToRenderDiscover","renderDiscoverMenu");s&&a(s,{eventName:"TimeToRenderDiscover",duration:e.duration}),performance.clearMarks("timeToRenderDiscover"),performance.clearMarks("renderDiscoverMenu")}catch(e){}};if(!b)if($){var M;const e=g&&(null===(M=g)||void 0===M?void 0:M.length)>0?g[0]:void 0;e&&(O(e),ee("executeItem"))}else{const e=(null==x?void 0:x())||"";if(e!==w){I=e,w=e;let t=[];P&&(t=[...t,...P]),Q&&(t=[...t,...Q]),oe(t),await _(I)}else void 0===g&&await _(I);G?ee("calloutEscape"):ne()}}}}}(e)),await(null===(t=f)||void 0===t?void 0:t.update(e))}function h(e,t){const o=e.substr(0,t.length);return 0===y.compare(o,t)}const y=new Intl.Collator(void 0,{usage:"search",sensitivity:"base"})},oss8:]);
//# sourceMappingURL=vendors~renderdiscovermenu.e3f0b0834d2e0c7ba341.chunk.v7.js.map