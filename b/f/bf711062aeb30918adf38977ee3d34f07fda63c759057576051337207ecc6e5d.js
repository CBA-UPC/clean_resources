import{d as k,B as b,o as c,c as j,F as $,f as B,y as q,b as g,_ as V,r as U,a as S,aa as E,j as y,e as G,w,u as f,g as M,s as A,Z as J,n as z,Q as K,h as Q,G as W,D as Y,t as Z,aq as X,a2 as ee}from"./entry.14d269f6.js";import{_ as te}from"./4a608d8f.js";import{k as T,p as oe,l as se,n as ne,o as ie,t as re,q as ae,v as le,w as h,c as I,b as ue}from"./b2c54706.js";import{M as ce,N as me,O as pe,P as de,Q as fe,R as je,S as _e,T as ve,U as ge}from"./6e3fcbcb.js";import{u as ye}from"./9a8302a0.js";const xe={class:"flex gap-3"},ke=["onClick"],Ee=k({__name:"EmojiPickerGroupIcons",props:{groups:{type:Array,required:!1},activeGroup:{type:Number,required:!0}},emits:["selected"],setup(l,{emit:i}){return(n,s)=>{const t=b("fa");return c(),j("div",xe,[(c(!0),j($,null,B(l.groups,({icon:r},e)=>(c(),j("button",{key:`icon_${e}`,type:"button",class:q(["flex h-6 w-6 items-center justify-center rounded-lg transition-colors hover:bg-gray-30",{"bg-gray-30":l.activeGroup===e}]),onClick:o=>i("selected",e)},[g(t,{icon:r,class:"text-lg text-gray-100"},null,8,["icon"])],10,ke))),128))])}}}),$e={},we={class:"z-10 bg-white text-sm text-gray-200 shadow-[0_6px_6px_0_white]"};onst Se=V($e,[["render",be]]),Me=["src","alt"],H=k({__name:"EmojiButton",props:{emoji:{}},emits:["selected"],setup(l,{emit:i}){return(n,s)=>(c(),j("button",{type:"button",class:"flex h-10 w-10 items-center justify-center overflow-hidden rounded-lg hover:bg-gray-30",onClick:s[0]||(s[0]=,onMousedown:s[1]||(s[1]=E(()=>{},["stop","prevent"]))},[S("img",{src:`/images/emojis/${n.emoji.utfUnified}.png`,class:"w-6",alt:n.emoji.emoji},null,8,Me)],32))}}),Te=k({__name:"EmojiGroupButton",props:{emoji:{}},emits:["selected"],setup(l,{emit:i}){const n=l,s=y(!1),t=y(),r=o=>{var a;return[o,...(a=o.variants)==null?void 0:a.map(p=>T(p)).filter(Boolean)]},e=G(()=>r(n.emoji.parent?T(n.emoji.parent):n.emoji));return(o,a)=>{const p=H,d=b("VDropdown");return c(),j("div",{ref_key:"emojiGroupButton",ref:t},[g(d,{"popper-class":"emoji-picker",placement:"top",shown:f(s),triggers:[],"popper-triggers":[],strategy:"fixed",delay:{show:500,hide:200},container:f(t)},{popper:w(()=>[S("div",{class:"flex max-w-[408px] flex-wrap p-1",onMouseenter:a[3]||(a[3]=_=>s.value=!0),onMouseleave:a[4]||(a[4]=_=>s.value=!1)},[(c(!0),j($,null,B(f(e),_=>(c(),M(p,{key:`variant_${_.emoji}`,emoji:_,onSelected:L=>i("selected",_)},null,8,["emoji","onSelected"]))),128))],32)]),default:w(()=>[g(p,{emoji:o.emoji,onSelected:a[0]||(a[0]=,onMouseenter:a[1]||(a[1]=_=>s.value=!0),onMouseleave:a[2]||(a[2]=},null,8,["emoji"])]),_:1},8,["shown","container"])],512)}}}),Be=k({__name:"EmojiList",props:{emojis:{type:Array,required:!0}},emits:["selected"],setup(l,{emit:i}){const n=y();return(s,t)=>{const r=Te,e=H;return c(),j("div",{ref_key:"emojiListRef",ref:n,class:"relative grid grid-cols-[repeat(8,40px)]"},[(c(!0),j($,null,B(l.emojis,o=>(c(),j($,{key:`emoji_${o.emoji}`},[o.variants||o.parent?(c(),M(r,{key:0,emoji:o,onSelected:t[0]||(t[0]=a=>i("selected",a))},null,8,["emoji"])):(c(),M(e,{key:1,emoji:o,onSelected:a=>i("selected",o)},null,8,["emoji","onSelected"]))],64))),128))],512)}}}),C="tenchat.emoji.history",Ce=(l=32)=>{const{username:i}=A(J()),n=`${i.value===""?"":`.${i.value}`}`,t=(r=>{const e=r.map(o=>o.utfUnified?o:T(o.emoji)).filter(Boolean);return localStorage.setItem(`${C}${n}`,JSON.stringify(e)),e})(JSON.parse(localStorage.getItem(`${C}${n}`)||"[]"));return{emojisHistory:t,addToHistory:r=>{const e=t.findIndex(;e>=0&&t.splice(e,1),t.unshift(r),t.length=Math.min(t.length,l),localStorage.setItem(`${C}${n}`,JSON.stringify(t))}}},Le={ref:"emojiPickerRef","data-cy":"emoji-picker"},Pe={class:"flex h-[452px] w-[348px] flex-col gap-3 bg-white px-3 pt-3"},he=["id"],Ie=k({__name:"EmojiPicker",emits:["selected"],setup(l,{emit:i}){const{emojisHistory:n,addToHistory:s}=Ce(),t=y(null),r=y(null),e=y(""),o=a=({tags:m})=>(m||[""]).some(u=>u.includes(e.value.toLowerCase())),p=({tags:m,parent:u})=>!u&&(m||[""]).some(,d=y(0),_=G(()=>[n.length?{title:"Недавние",icon:ce,items:n.filter(a)}:null,{title:"Люди и эмоции",icon:me,items:oe.filter(p)},{title:"Еда и напитки",icon:pe,items:se.filter(p)},{title:"Природа и животные",icon:de,items:ne.filter(p)},{title:"Активность",icon:fe,items:ie.filter(p)},{title:"Путешествия и места",icon:je,items:re.filter(p)},{title:"Объекты и символы",_e,items:ae.filter(p)},{title:"Флаги и страны",icon:ve,items:le.filter(p)}].filter(m=>m)),L=m=>{e.value="",X(()=>{var u;if(r.value){const v=r.value[m];(u=t.value)==null||u.scroll({top:v.offsetTop-t.value.offsetTop})}})};return z(()=>{var u;const{obsue=+v.id.split("_")[1]},rootElement:t});(u=r.value)==null||u.forEach(v=>m==null?void 0:m.observe(v))}),(m,u)=>{const v=Ee,D=te,R=Se,N=Be;return c(),j("div",Le,[S("div",Pe,[g(v,{groups:f(_),"active-group":f(d),onSelected:u[0]||(u[0]ups","active-group"]),g(D,{modelValue:f(e),"onUpdate:modelValue":u[1]||(u[1]=x=>K(e)?e.value=x:null),placeholder:"Поиск",onClick:u[2]||(u[2]=E(()=>{},["stop"]))},null,8,["modelValue"]),S("div",{ref_key:"pickerBodyRef",ref:t,class:"tc-small-scrollbar -mr-2 flex select-none flex-col overflow-y-scroll","data-cy":"emojis"},[(c(!0),j($,null,B(f(_),({items:x,title:F},P)=>Q((c(),j("div",{id:`emoji_${P}`,key:P,re:"emojiListRefs",ref:r,class:"mb-px pb-3"},[g(R,{ticky top-0 mb-1.5"},{default:w(()=>[Y(Z(F),1)]),_:2},1024),g(N,{emojis:x,onSelected:u[3]||(u[3]=O=>o(O))},null,8,["emojis"])],8,he)),[[W,x.length]])),128))],512)])],512)}}});const Ve=V(Ie,[["__scopeId","data-v-4396f879"]]),Ge=()=>{let l,i;const n=y(!1);return{isMenuVisible:n,mouseEnimeout(l),i=setTue=!0},50)},mouseLeave:()=>{clearTimeout(i),l=setTimeout(()=>n.value=!1,300)},closeMenu:()=>{n.value=!1}}},Oe=k({__name:"EmojiPickerModal",props:{autoHide:{type:Boolean},container:{}},emits:["tab-focus","focus","selected-emoji"],setup(l,{emit:i}){const{isMenuVisible:n,mouseEnter:s,mouseLeave:t}=Ge();return(r,e)=>{const o=b("fa"),a=Ve,p=b("VMenu");return c(),M(p,{"popper-class":"emoji-picker","popper-triggers":[],"auto-hide":r.autoHide,shown:f(n),placement:"top",triggers:[],class:"leading-4",delay:{end:1e3},container:r.container,"data-cy":"smile"},{popper:w(()=>[g(a,{onMouseenter:e[6]||(e[6]=d=>f(s)()),onMouseleave:e[7]||(e[7]=d=>f(t)()),onSelected:e[8]||(e[8]=d=>i("selected-emoji",d))})]),default:w(()=>[g(o,{"data-cy":"emoji",class:"h-5 cursor-pointer text-gray-80 outline-none hover:text-blue-300 focus-visible:text-bl,size:"lg",icon:f(ge),onMousedown:e[0]||(e[0]=E(()=>{},["stop","prevent"])),onClick:e[1]||(e[1]=E(()=>{},["st,onKeydown:e[2]||(e[2]=ee(E(d=>i("tab-focus",d),["exact"]),["tocus:e[3]||(e[3]=d=>i("focus",d)),onMouseenter:e[4]||(e[4]=d=>f(s)()),onMouseleave:e[5]||(e[5]=d=>f(t)())},null,8,["icon"])]),_:1},8,["auto-hide","shown","container"])}}}),qe=()=>{function l(s,t){const r=s,e=r.data,o=h(e);if(e&&o){const a=T(r.data);a&&(document.execCommand("delete"),document.execCommand("insertHTML",!1,I(a,t)))}}function i(s,t,r=!0){const e=s.clipboardData;if(e){const o=e.getData("text/plain").replace(/(\r\n)|\n/g,r?"<br />":"");return o&&h(o)?(s.preventDefault(),s.stopPropagation(),document.execCommand("insertHTML",!1,ue(o,t)),!0):!1}}function n(s){document.execCommand("insertHTML",!1,I(s))}return{addEmoji:n,onInputEmoji:l,onPasteEmoji:i}};export{Oe as _,qe as u};
