(self.webpackChunkgw_web_app=self.webpackChunkgw_web_app||[]).push([[3724],{91180:(U,b,r)=>{"use strict";var C=r(96315)),f=C.tokenize,h=C.options.Options;nction k(m){if(!m)return"";var c=[];for(var u in m)c.push(u+'="'+O(m[u]+"")+'"');return c.join(" ")}function Z(m){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};c=new h(c);for(var u=f(m),l=[],P=0;P<u.length;P++){var v=u[P];if("nl"===v.type&&c.nl2br)l.push("<br>\n");else if(v.isLink&&c.check(v)){var x=c.resolve(v),L=x.formatted,S=x.formattedHref,D=x.tagName,F=x.className,y=x.target,H=x.attributes,T="<"+D+' href="'+O(S)+'"';F&&(T+=' class="'+O(F)+'"'),y&&(T+=' target="'+O(y)+'"'),H&&(T+=" "+k(H)),T+=">"+w(L)+"</"+D+">",l.push(T)}else l.push(w(v.toString()))}return l.join("")}if(!String.prototype.linkify)try{Object.defineProperty(String.prototype,"linkify",{set:function(){},get:function(){return function(u){return Z(this,u)}}})}catch(m){String.prototype.linkify||(String.prototype.linkify=}b.default=Z},20019:35502:(U,b,r)=>{"use strict";r.d(b,{_:()=>A});var d=r(74788);let A=(()=>{class C{constructor(f,e){this.elementRef=f,this.renderer2=e}nblur(){this.renderer2.setAttribute(this.elementRef.nativeElement,"placeholder",this.dynamicPlaceholder)}return C.\u0275fac=function(f){return new(f||C)(d.Y36(d.SBq),d.Y36(d.Qsj))},C.\u0275dir=d.lG2({type:C,selectors:[["","dynamicPlaceholder",""]],hostVars:1,hostBindings:function(f,e){1&f&&d.NdJ("focus",function(){return e.onFocused()})("blur",function(){return e.onblur()}),2&f&&d.Ikx("placeholder",e.placeHolder)},inputs:{dynamicPlaceholder:"dynamicPlaceholder"}}),C})()},83724:(U,b,r)=>{"use strict";r.r(b),r.d(b,{MessagesModule:);var d=r(40064),A=r(58102),C=r.n(A),_=r(82068),f=r(94686),e=r(74788),h=r(87314),w=r(33982),O=r(29459),k=r(10379),Z=r(38902),m=r(3849),c=r(15248),u=r(56305),l=r(24751),P=r(2895),v=r(23021),x=r(49356),L=r(35502),S=r(13513);const F=["filterSelectElementRef"];class y{constructor(i){this.messagesService=i,this.form=new l.cw({searchField:new l.NI}),this.showFilters=!0,this.eConversationListFilters=c.ri}ngOnInit(){}getMessages(){this.messagesService.apiSearchConversations(this.form.value.searchField.trim())}toggleFiltersSelect(){this.filterSelectElementRef.toggle()}onSelectConversationFilter(i){this.messagesService.conversationListFilter=i}changeOrder(){this.messagesService.changeOrder(!0)}}y.\u0275fac=function(i){return new(i||y)(e.Y36(h.K))},y.\u0275cmp=e.Xpm({type:y,selectors:[["messages-users-list-header"]],viewQuery:function(i,t){if(1&i&&e.Gf(F,5),2&i){let s;e.iGM(s=e.CRH())&&(t.filterSelectElementRef=s.first)}},decls:30,vars:14,consts:[[1,"header"],[1,"header__actions"],["mat-icon-button","",1,"actions__add",3,"click"],["xmlns","http://www.w3.org/2000/svg","id","Icon_Add_Message","width","24","height","24","viewBox","0 0 24 24"],["id","Rectangle_5100","fill","none","d","M0 0H24V24H0z"],["id","Group_8225","transform","translate(-2085 -1547)"],["id","Path_14982","d","M2105 1563v-3h-2v3h-3v2h3v3h2v-3h3v-2z",2,"fill","var(--gw-gray-800)"],["id","Path_14983","d","M2088 1565v-13a1 1 0 0 1 1-1h13a1 1 0 0 1 1 1v5h2v-5a3 3 0 0 0-3-3h-13a3 3 0 0 0-3 3v17l5.333-4H2098v-2h-7.333z",2,"fill","var(--gw-gray-800)"],["id","Rectangle_5109","d","M0 0H11V2H0z","transform","translate(2090 1554)",2,"fill","var(--gw-gray-800)"],["id","Rectangle_5110","d","M0 0H8V2H0z","transform","translate(2090 1558)",2,"fill","var(--gw-gray-800)"],["mat-icon-button","",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","",3,"click"],[1,"search"],[1,"material-icons","gw-vertical-align-middle"],[1,"messages-search",3,"formGroup"],["aria-label","search input","formControlName","searchField","type","text",1,"gw-search-input",3,"dynamicPlaceholder","keyup"]],template:function(i,t){if(1&i&&(e.TgZ(0,"div",0),e.TgZ(1,"h2"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",1),e.TgZ(5,"button",2),e.NdJ("click",,e.O4$(),e.TgZ(6,"svg",3),e._UZ(7,"path",4),e.TgZ(8,"g",5),e._UZ(9,"path",6),e._UZ(10,"path",7),e._UZ(11,"path",8),e._UZ(12,"path",9),e.qZA(),e.qZA(),e.qZA(),e.kcU(),e.TgZ(13,"button",10),e.TgZ(14,"mat-icon"),e._uU(15,"more_vert"),e.qZA(),e.qZA(),e.TgZ(16,"mat-menu",null,11),e.TgZ(18,"button",12),e.NdJ("click",function(){return t.onSelectConversationFilter(t.eConversationListFilters.all)}),e._uU(19),e.ALo(20,"translate"),e.qZA(),e.TgZ(21,"button",12),e.NdJ("click",,e._uU(22),e.ALo(23,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(24,"div",13),e.TgZ(25,"i",14),e._uU(26,"search"),e.qZA(),e.TgZ(27,"form",15),e.TgZ(28,"input",16),e.NdJ("keyup",function(){return t.getMessages()}),e.ALo(29,"translate"),e.qZA(),e.qZA(),e.qZA()),2&i){const s=e.MAs(17);e.xp6(2),e.Oqu(e.lcZ(3,6,"directMessages")),e.xp6(11),e.Q6J("matMenuTriggerFor",s),e.xp6(6),e.Oqu(e.lcZ(20,8,"allMessages")),e.xp6(3),e.Oqu(e.lcZ(23,10,"unreadMessages")),e.xp6(5),e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("dynamicPlaceholder",e.lcZ(29,12,"searchMessages"))}},directives:[P.lW,v.p6,x.Hw,v.VK,v.OP,l._Y,l.JL,l.sg,l.Fj,l.JJ,l.u,L._],pipes:[S.X],styles:[".header[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,auto);justify-content:space-between;padding:8px 8px 0}.header__actions[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;transform:translateY(-4px)}.header__actions__add[_ngcontent-%COMP%]{border:0;outline:0}.search[_ngcontent-%COMP%]{border-radius:50px;display:flex;width:100%;background-color:var(--gw-gray-100);padding:6px 15px;height:45px;align-items:center}.search[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{background:0 0;color:currentColor;border:none;outline:0;padding:0;margin:0;width:100%;max-width:100%;text-align:inherit}.search[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]::-ms-clear{display:none;width:0;height:0}.search[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]::-ms-reveal{display:none;width:0;height:0}.search[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]::-webkit-search-decoration, .search[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]::-webkit-search-cancel-button, .search[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]::-webkit-search-results-button, .search[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]::-webkit-search-results-decoration{display:none}"]}),function(n,i,t,s){var g,a=arguments.length,o=a<3?i:null===s?s=Object.getOwnPropertyDescriptor(i,t):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(n,i,t,s);else for(var M=n.length-1;M>=0;M--)(g=n[M])&&(o=(a<3?g(o):a>3?g(i,t,o):g(i,t))||o);a>3&&o&&Object.defineProperty(i,t,o)}([(0,u.K)(500)],y.prototype,"getMessages",null);var H=r(73094),T=r.n(H);let Q=(()=>{class n{constructor(t,s){this.elementRef=t,this.scrolledInOffset=new e.vpe,this.throttle=500,this.elem=t.nativeElement,s.listen(t.nativeElement,"scroll",T()(this.onScroll.bind(this),this.throttle))}onScroll(t){this.pause||(this.offsetBottomDistance&&this.onScrollCheckBottomOffset(t),this.offsetTopDistance&&this.onScrollCheckTopOffset(t))}onScrollCheckBottomOffset(t){this.elem.clientHeight+this.elem.scrollTop<this.elem.scrollHeight-this.offsetBottomDistance||this.scrolledInOffset.emit(t)}onScrollCheckTopOffset(t){this.elem.scrollTop>this.offsetTopDistance||this.scrolledInOffset.emit(t)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.SBq),e.Y36(e.Qsj))},n.\u0275dir=e.lG2({type:n,selectors:[["","gwInfiScroll",""]],inputs:{offsetTopDistance:"offsetTopDistance",offsetBottomDistance:"offsetBottomDistance",pause:"pause",throttle:"throttle"},outputs:{scrolledInOffset:"scrolledInOffset"}}),n})();var p=r(12057),J=r(48873),z=r(36726),G=r.n(z),j=r(26312),N=r(47592);let $=(()=>{class n{transform(t,s){return"string"!=typeof t?t:t.length>s?t.substring(0,s)+"...":t}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275pipe=e.Yjl({name:"truncate",type:n,pure:!0}),n})();function K(n,i){if(1&n&&(e.TgZ(0,"div",7),e._UZ(1,"p",8),e.ALo(2,"truncate"),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("innerHTML",e.xi3(2,1,t.conversation.lastMessage.text,64),e.oJD)}}const X=let W=(()=>{class n{et conversation(t){this._conversation=G()(t,{participantUsersInfo:{}})}gOnInit(){}displayByDateFormat(t){if(!t)return;const s=J().isSame(J(t),"year")?"":"YYYY ";return J(t).format(s+"MMM D")}t settings$(){return this.settingsService.getGeneralSettings()}changeOrder(){this.messagesService.changeOrder(!0)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(h.K),e.Y36(j.F))},n.\u0275cmp=e.Xpm({type:n,selectors:[["messages-users-list-item"]],inputs:{conversation:"conversation"},decls:10,vars:13,consts:[[1,"participent",3,"ngClass","click"],[3,"imgSrc","recentlyOnlineEnabled","onlineStatus","diameter"],[1,"gw-primary-color"],[1,"gw-flex","gw-between"],[1,"participent__data__fullName","mat-body-2"],[1,"participent__data__date","mat-small"],["class","participent__data__lastMessage mat-small",4,"ngIf"],[1,"participent__data__lastMessage","mat-small"],[3,"innerHTML"]],template:function(t,s){if(1&t&&(e.TgZ(0,"div",0),e.NdJ("click",function(){return s.changeConversation(s.conversation.userId),s.changeOrder()}),e._UZ(1,"gw-avatar",1),e.ALo(2,"async"),e.TgZ(3,"div",2),e.TgZ(4,"div",3),e.TgZ(5,"div",4),e._uU(6),e.qZA(),e.TgZ(7,"div",5),e._uU(8),e.qZA(),e.qZA(),e.YNc(9,K,3,4,"div",6),e.qZA(),e.qZA()),2&t){let a;e.Q6J("ngClass",e.WLB(10,X,s.isCurrent,!s.conversation.isRead)),e.xp6(1),e.Q6J("imgSrc",null==s.conversation||null==s.conversation.participantUsersInfo?null:s.conversation.participantUsersInfo.photoUrl)("recentlyOnlineEnabled",null==(a=e.lcZ(2,8,s.settings$))?null:a.enableRecentlyOnline)("onlineStatus",null==s.conversation||null==s.conversation.participantUsersInfo?null:s.conversation.participantUsersInfo.status)("diameter",40),e.xp6(5),e.Oqu(null==s.conversation||null==s.conversation.participantUsersInfo?null:s.conversation.participantUsersInfo.name),e.xp6(2),e.hij(" ",s.displayByDateFormat(null==s.conversation||null==s.conversation.lastMessage?null:s.conversation.lastMessage.time),""),e.xp6(1),e.Q6J("ngIf",null==s.conversation?null:s.conversation.lastMessage)}},directives:[p.mk,N.H,p.O5],pipes:[p.Ov,$],styles:['[_nghost-%COMP%]{cursor:pointer}.participent[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto 1fr;padding:10px;border-radius:10px;grid-column-gap:10px;column-gap:10px;align-items:start}.participent__data[_ngcontent-%COMP%]:after{display:block;content:"";width:105%;position:relative;bottom:-10px;height:1px;background:var(--gw-gray-200)}.participent__data__date[_ngcontent-%COMP%]{font-size:10px}.participent__current[_ngcontent-%COMP%]{background-color:var(--gw-gray-100)}.participent__current[_ngcontent-%COMP%]   .participent__data[_ngcontent-%COMP%]:after{display:none}.participent__unread[_ngcontent-%COMP%]   .participent__data__fullName[_ngcontent-%COMP%]{font-weight:800;color:currentColor;text-shadow:darkgoldenrod}']}),n})();const ee=["infiScrollAreaElementRef"];et ne=(()=>{class n{gOnInit(){this.messagesService.conversationsListSubject.subscribe(t=>{this.conversationsList=t}),this.messagesService.onSearchConversation.subscribe(}scrolledInOffset(t){this.pauseInfiScroll=!0,this.messagesService.apiGetConversations().subscribe(s=>{!s||0===s.length||(this.messagesService.conversationsList=new c._u(...this.messagesService.conversationsList.concat(s)),this.pauseInfiScroll=!1)})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(h.K))},n.\u0275cmp=e.Xpm({type:n,selectors:[["messages-users-list"]],viewQuery:function(t,s){if(1&t&&e.Gf(ee,5),2&t){let a;e.iGM(a=e.CRH())&&(s.infiScrollAreaElementRef=a.first)}},decls:4,vars:4,consts:[["gwInfiScroll","",1,"sidebar-main-content",3,"pause","throttle","offsetBottomDistance","scrolledInOffset"],["infiScrollAreaElementRef",""],[4,"ngFor","ngForOf"],[3,"conversation"]],template:function(t,s){1&t&&(e._UZ(0,"messages-users-list-header"),e.TgZ(1,"div",0,1),e.NdJ("scrolledInOffset",function(o){return s.scrolledInOffset(o)}),e.YNc(3,te,2,1,"ng-container",2),e.qZA()),2&t&&(e.xp6(1),e.Q6J("pause",s.pauseInfiScroll)("throttle",500)("offsetBottomDistance",500),e.xp6(2),e.Q6J("ngForOf",s.conversationsList))},directives:[y,Q,p.sg,W],styles:["[_nghost-%COMP%]{padding-right:8px;display:grid;grid-template-rows:auto 1fr}messages-users-list-header[_ngcontent-%COMP%]{display:block;margin-bottom:16px}.sidebar-main-content[_ngcontent-%COMP%]{overflow-x:hidden;overflow-y:auto}@media screen and (min-width: 1024px){.sidebar-main-content[_ngcontent-%COMP%]{max-height:calc(100vh - 281px)}}[_ngcontent-%COMP%]::-webkit-scrollbar{width:4px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#888;border-radius:10px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:var(--gw-gray-800)}"]}),n})();var Y=r(76088);let se=(()=>{class n{constructor(t){this.elementRef=t,this.scrollDelayMs=0}ngOnInit(){}ngOnChanges(t){"scrollToEnd"in t&&(this.scrollingSubscription=this.scrollToEnd.subscribe(()=>{setTimeout(()=>{this.elementRef.nativeElement.scrollTop=this.elementRef.nativeElement.scrollHeight},this.scrollDelayMs)}))}ngOnDestroy(){this.scrollingSubscription.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.SBq))},n.\u0275dir=e.lG2({type:n,selectors:[["","scrollToEnd",""]],inputs:{scrollToEnd:"scrollToEnd",scrollDelayMs:"scrollDelayMs"},features:[e.TTD]}),n})();function ie(n,i){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",1),e.TgZ(2,"div",5),e.TgZ(3,"div",6),e.TgZ(4,"div",7),e.TgZ(5,"i",8),e._uU(6),e.qZA(),e.qZA(),e.TgZ(7,"div",9),e._uU(8),e.qZA(),e.TgZ(9,"div",10),e.NdJ("click",function(){const o=e.CHM(t).$implicit;return e.oxw(2).messagesService.removeFile(o)}),e.TgZ(10,"i",8),e._uU(11,"close"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.BQk()}if(2&n){const t=i.$implicit;e.xp6(6),e.Oqu(t.type.match("image")?"image":"insert_drive_file"),e.xp6(2),e.Oqu(t.name)}}function ae(n,i){if(1&n&&(e.TgZ(0,"div",1),e.TgZ(1,"div",2),e.TgZ(2,"div",3),e.YNc(3,ie,12,2,"ng-container",4),e.qZA(),e.qZA(),e.qZA()),2&n){const t=e.oxw();e.xp6(3),e.Q6J("ngForOf",t.files)}}let re=(()=>{class n{constructor(t){this.messagesService=t,this.files=[],this.files=this.messagesService._filesList,this.messagesService.filesListSubject.subscribe(}return n.\u0275fac=function(t){return new(t||n)(e.Y36(h.K))},n.\u0275cmp=e.Xpm({type:n,selectors:[["messages-chat-files-list"]],decls:1,vars:1,consts:[["class","item",4,"ngIf"],[1,"item"],[1,"gw-send-attachments-list"],[1,"gw-send-attachments-list-inner"],[4,"ngFor","ngForOf"],[1,"gw-send-attachment"],[1,"gw-send-attachment-inner","gw-primary-color"],[1,"icon"],[1,"material-icons"],[1,"name"],[1,"remove",3,"click"]],template:directives:[p.O5,p.sg],styles:["[_nghost-%COMP%]{display:block;position:absolute;bottom:10px;width:100%}.gw-send-attachment-inner[_ngcontent-%COMP%]{border-radius:8px;box-shadow:0 0 2px 0 currentColor}.gw-send-attachments-list-inner[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,auto);justify-content:start;grid-gap:10px;gap:10px}"]}),n})();var oe=r(54395),ce=r(79765),le=r(3069),ge=r(42194),me=r(32911);let de=(()=>{class n{nInput(){this.adjust()}onFocus(){this.adjust()}gOnInit(){this.autoGrow&&(this.autoGrowSubscription=this.autoGrow.subscribe()}adjust(){let t=this.elementRef.nativeElement;t.style.overflow="auto",t.style.height="auto",t.style.height=t.scrollHeight<this.maxHeightBeforeScroll?t.scrollHeight+"px":this.maxHeightBeforeScroll+"px"}ngOnDestroy(){this.autoGrowSubscription.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.SBq))},n.\u0275dir=e.lG2({type:n,selectors:[["","autoGrow",""]],hostBindings:inputs:{maxHeightBeforeScroll:"maxHeightBeforeScroll",autoGrow:"autoGrow"}}),n})(),pe=(()=>{class n{constructor(t,s,a){this.messagesService=t,this.matSnackBar=s,this.eventLogService=a,this.form=new l.cw({message:new l.NI(null,[l.kI.required])}),this.messageMaxLength=4e3,this.editorResizeEmitter$=new ce.xQ}get lengthError(){return this.form.value.message&&this.form.value.message.length>this.messageMaxLength}get isEmptyMessage(){return!this.form.value.message||!this.form.value.message.trim()}get isMessageValid(){return!(this.isComposeDisabled||this.lengthError||this.isEmptyMessage&&this.messagesService._filesList.length<1)}gOnInit(){this.form.get("message").valueChanges.pipe((0,oe.b)(1e3)).subscribe(,this.messagesService.editorContentSubject.subscribe(t=>this.form.get("message").setValue(t,{emitEvent:!1}))}addFile(t){this.messagesService.addFile(t)}onEditorKeydown(t){if(this.isComposeDisabled)return this.matSnackBar.open("Please choose a user"),void t.preventDefault();13===t.keyCode&&!t.shiftKey&&this.isMessageValid&&(this.submitMessage(),t.preventDefault())}submitMessage(){let s;s=""===this.form.value.message.replace(/^\s+/,"").replace(/\s+$/,"")?this.form.value.message:this.form.value.message.replace(/\r\n|\r|\n/g,"<br />");const o=new FormData;o.append("PrivateMessageForPostDto",JSON.stringify({ParticipantUserId:parseInt(this.messagesService.activeChatUserId,10),PrivateMessageTypeId:1,Text:s})),this.messagesService._filesList.forEach(g=>{o.append("file_"+g.name,g,g.name)}),this.messagesService.apiSendMessage(o,()=>this.form.get("message").setValue(s)),this.form.get("message").setValue(null),this.messagesService.filesListSubject.next([]),this.eventLogService.log("userend",this.messagesService.activeChatMessages.length>0?"pm_reply":"pm_send",{target:this.messagesService.activeChatUserId.toString()}),this.editorResizeEmitter$.next()}onKeyDown(t){"Enter"===t.key&&!t.shiftKey&&(t.preventDefault(),this.submitMessage())}fileInputClick(t){!this.isComposeDisabled||(this.matSnackBar.open("Please choose a user"),t.preventDefault())}}return n.\u0275fac=n.\u0275cmp=e.Xpm({type:n,selectors:[["messages-textbox"]],decls:7,vars:12,consts:[[1,"message",3,"formGroup"],[1,"message__file"],[3,"primaryColor","maxSize","hideOutput","icon","text","multiple","click","onFileChange"],["cols","30","rows","1","formControlName","message",1,"mat-body-1",3,"autoGrow","maxHeightBeforeScroll","keydown"],[1,"message__send",3,"disabled","click"]],template:function(t,s){1&t&&(e.TgZ(0,"form",0),e.TgZ(1,"div",1),e.TgZ(2,"gw-file-upload-input",2),e.NdJ("click",function(o){return s.fileInputClick(o)})("onFileChange",function(o){return s.addFile(o)}),e.qZA(),e.qZA(),e.TgZ(3,"textarea",3),e.NdJ("keydown",,e.qZA(),e.qZA(),e.TgZ(4,"button",4),e.NdJ("click",function(){return s.submitMessage()}),e.TgZ(5,"mat-icon"),e._uU(6,"send"),e.qZA(),e.qZA()),2&t&&(e.Q6J("formGroup",s.form),e.xp6(2),e.Q6J("primaryColor",!1)("maxSize",10)("hideOutput",!0)("icon","attach_file")("text","")("multiple",!0),e.xp6(1),e.Q6J("autoGrow",s.editorResizeEmitter$)("maxHeightBeforeScroll",60),e.xp6(1),e.Udp("cursor",s.isMessageValid?"pointer":"not-allowed"),e.Q6J("disabled",!s.isMessageValid))},directives:[l._Y,l.JL,l.sg,me.K,l.Fj,l.JJ,l.u,de,x.Hw],styles:["[_nghost-%COMP%]{display:grid;grid-template-columns:1fr auto;align-items:center;grid-column-gap:8px;column-gap:8px;margin-top:6px}.message[_ngcontent-%COMP%]{background:white;border-radius:22px;grid-column-gap:8px;column-gap:8px;display:grid;grid-template-columns:auto 1fr auto auto;padding:8px}.message[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{border:none;line-height:24px;padding:0;outline:none;resize:none}.message[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]::-webkit-scrollbar{width:2px}.message[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f0f0f0}.message[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#888;border-radius:10px}.message[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:var(--gw-gray-800)}.message__emojy[_ngcontent-%COMP%]{border:none;background:transparent;display:grid;outline:none;padding:0;place-items:center}.message__send[_ngcontent-%COMP%]{border:none;display:grid;outline:none;place-items:center;background:transparent}.message__file[_ngcontent-%COMP%]{display:grid;align-items:center}  .mat-menu-panel{max-width:none}"]}),n})();var he=r(75319),ue=r(33718),_e=r.n(ue),fe=r(33834),ve=r.n(fe),Ce=r(28971),xe=r(89316),Me=r(70861),q=r(41120),we=r(4665),ye=r(40517);function Oe(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"mat-icon",16),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return a.messagesService.activeChatUserId=null,a.changeOrder()}),e._uU(1," arrow_back"),e.qZA()}}unction Te(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",18),e.NdJ("click",,e.O4$(),e.TgZ(1,"svg",19),e._UZ(2,"path",20),e.qZA(),e.qZA()}}function Ze(n,i){if(1&n&&(e.TgZ(0,"div",21),e.TgZ(1,"mat-icon"),e._uU(2,"more_vert"),e.qZA(),e.qZA()),2&n){e.oxw();const t=e.MAs(17);e.Q6J("matMenuTriggerFor",t)}}const Pe=function Ie(n,i){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",2),e.TgZ(2,"div",3),e.YNc(3,Oe,2,0,"mat-icon",4),e.TgZ(4,"div",5),e._UZ(5,"gw-avatar",6),e.ALo(6,"async"),e.qZA(),e.TgZ(7,"div",7),e.TgZ(8,"div",8),e.TgZ(9,"a",9),e._uU(10),e.qZA(),e.qZA(),e.YNc(11,Se,2,1,"div",10),e.qZA(),e.qZA(),e.TgZ(12,"div",11),e.YNc(13,Te,3,0,"div",12),e.ALo(14,"async"),e.YNc(15,Ze,3,1,"div",13),e.TgZ(16,"mat-menu",null,14),e.TgZ(18,"button",15),e.NdJ("click",,e.TgZ(19,"mat-icon"),e._uU(20),e.qZA(),e._uU(21),e.ALo(22,"translate"),e.qZA(),e.TgZ(23,"button",15),e.NdJ("click",,e.TgZ(24,"mat-icon"),e._uU(25,"delete"),e.qZA(),e._uU(26),e.ALo(27,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();let s;e.xp6(5),e.Q6J("imgSrc",null==t.messagesService||null==t.messagesService.currentConversationUser?null:t.messagesService.currentConversationUser.photoUrl)("recentlyOnlineEnabled",null==(s=e.lcZ(6,12,t.settings$))?null:s.enableRecentlyOnline)("onlineStatus",null==t.messagesService||null==t.messagesService.currentConversationUser?null:t.messagesService.currentConversationUser.status)("diameter",40),e.xp6(4),e.Q6J("routerLink",e.VKq(20,Pe,t.messagesService.currentConversationUser.id)),e.xp6(1),e.Oqu(t.messagesService.currentConversationUser.name),e.xp6(1),e.Q6J("ngIf",t.messagesService.currentConversationUser.jobTitle||t.messagesService.currentConversationUser.companyName),e.xp6(2),e.Q6J("ngIf",e.lcZ(14,14,t.callEnabled$)),e.xp6(2),e.Q6J("ngIf",t.shouldDisplayDeleteAndUnreadButton),e.xp6(5),e.Oqu(t.messagesService.currentConversation.isRead?"mail":"drafts"),e.xp6(1),e.hij(" ",e.lcZ(22,16,t.messagesService.currentConversation.isRead?"markAsUnread":"markAsRead")," "),e.xp6(5),e.hij(" ",e.lcZ(27,18,"deleteConversation")," ")}}function Ae(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"mat-icon",16),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return a.messagesService.activeChatUserId=null,a.changeOrder()}),e._uU(1," arrow_back"),e.qZA()}}unction ke(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",30),e.NdJ("click",,e._UZ(1,"gw-avatar",31),e.TgZ(2,"div",32),e.TgZ(3,"div",33),e.TgZ(4,"div",34),e._uU(5),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&n){const t=i.$implicit;e.xp6(1),e.Q6J("imgSrc",null==t?null:t.photoUrl)("diameter",40),e.xp6(4),e.Oqu(t.name)}}function Le(n,i){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",28),e.NdJ("scrolledInOffset",,e.YNc(2,ke,6,3,"div",29),e.qZA(),e.BQk()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("pause",t.pauseInfiScroll)("offsetBottomDistance",500),e.xp6(1),e.Q6J("ngForOf",t.messagesService.usersSearchList)}}function De(n,i){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",22),e.YNc(2,Ae,2,0,"mat-icon",4),e.YNc(3,Ue,2,0,"div",23),e.TgZ(4,"div",24),e.TgZ(5,"i",25),e._uU(6,"search"),e.qZA(),e.TgZ(7,"input",26),e.NdJ("keydown",function(){return e.CHM(t),e.oxw().resetSearch()})("keyup",("ngModelChange",,e.ALo(8,"translate"),e.qZA(),e.qZA(),e.qZA(),e.YNc(9,Le,3,3,"ng-container",0),e.BQk()}if(2&n){const t=e.oxw();e.xp6(7),e.Q6J("gwFocus",!1)("ngModel",t.messagesService.userNameSearchInput)("dynamicPlaceholder",e.lcZ(8,4,"typeName")),e.xp6(2),e.Q6J("ngIf",t.messagesService.usersSearchList&&t.messagesService.usersSearchList.length>0)}}class I{constructor(i,t,s,a,o,g,M,ut,_t,ft){this.messagesService=i,this.gwMobileService=t,this.languageService=s,this.store=a,this.usersService=o,this.cordovaService=g,this.appStore=M,this.jitsiService=ut,this.route=_t,this.settingsService=ft,this.pauseInfiScroll=!1,this.showDeleteDialog=!1,this.subscriptions=new he.w}get shouldDisplayDeleteAndUnreadButton(){return 0!==C()(this,"messagesService.currentConversation.privateMessages.length",0)}get userTitle(){const i=[];return _e()(this.messagesService.currentConversationUser.affiliations,t=>{t=this.languageService.translate(t),i.push(t)}),i.push(this.messagesService.currentConversationUser.jobTitle),i.push(this.messagesService.currentConversationUser.companyName),ve()(i,.join(", ")}gOnInit(){this.store.dispatch(_.wx({payload:this.cordovaService.isCordova})),this.callEnabled$=this.store.pipe((0,d.Ys)(f.f)),this.store.dispatch(_.nR({payload:null})),this.route.queryParams.subscribe(()=>{var i;const t=this.route.snapshot.params,s=this.route.snapshot.queryParams;this.jitsiService.init(null===(i=this.usersService.currentUser)||void 0===i?void 0:i.id,t.id,t.roomId,s.vmid,s.cid,this.referrer)}),this.subscriptions.add(this.appStore.pipe((0,d.Ys)(Ce.Ep)).subscribe()}ngOnDestroy(){this.store.dispatch(_.Sn({payload:null})),this.subscriptions.unsubscribe(),this.messagesService.conversationsList=null}handleServerSentEvent(i){if("messages"!==i.name)return;const t=i.data;this.jitsiService.sync(this.usersService.currentUser.id,t),t.callStatus===c.Dc.didNotAnswer&&(this.store.dispatch(_.E4({payload:!1})),this.store.dispatch(_.pj({payload:null})))}getUsers(){""!==this.messagesService.userNameSearchInput?(this.pauseInfiScroll=!0,this.subscriptions.add(this.messagesService.apiSearchUsers(this.messagesService.userNameSearchInput).subscribe((i=>{this.messagesService.usersSearchList=new c.j5(...i),this.pauseInfiScroll=!1}).bind(this)))):this.resetSearch()}usersSelectScroll(i){this.pauseInfiScroll=!0,this.subscriptions.add(this.messagesService.apiSearchUsers(this.messagesService.userNameSearchInput).subscribe(t=>{0!==t.length&&(this.messagesService.usersSearchList=new c.j5(...this.messagesService.usersSearchList.concat(t)))}))}resetSearch(){this.pauseInfiScroll=!1,this.messagesService.usersSearchList&&(this.messagesService.usersSearchList.length=0)}ngeOrder(){this.messagesService.changeOrder(!1)}showVideoChatModal(){this.jitsiService.showVideoChatModal()}}I.\u0275fac=I.\u0275cmp=e.Xpm({type:I,selectors:[["messages-chat-header"]],inputs:{referrer:"referrer"},decls:6,vars:12,consts:[[4,"ngIf"],[3,"shouldShow","title","cancelBtnTitle","confirmBtnTitle","shouldShowChange","dialogCancel","dialogConfirm"],[1,"header"],[1,"recipient"],["class","recipient__back gw-primary-color",3,"click",4,"mobile"],[1,"recipient__photo"],[3,"imgSrc","recentlyOnlineEnabled","onlineStatus","diameter"],[1,"recipient_info"],[1,"recipient__info__fullName"],[1,"recipient-name","gw-primary-color","mat-body-2",3,"routerLink"],["class","recipient__info__profession mat-small",4,"ngIf"],[1,"actions"],["class","actions__camera gw-primary-color",3,"click",4,"ngIf"],["class","actions__ellipsis",3,"matMenuTriggerFor",4,"ngIf"],["menu","matMenu"],["mat-menu-item","",3,"click"],[1,"recipient__back","gw-primary-color",3,"click"],[1,"recipient__info__profession","mat-small"],[1,"actions__camera","gw-primary-color",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","18","height","12","viewBox","0 0 18 12",1,"camera_svg"],["d","M17 10.5V7a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-3.5l4 4v-11z","transform","translate(-3 -6)"],[1,"actions__ellipsis",3,"matMenuTriggerFor"],[1,"newChat"],["class","mat-body-2 gw-primary-color newChat__title","gwTranslate","",4,"desktop"],[1,"newChat__search"],[1,"material-icons","gw-vertical-align-middle"],["type","text",1,"gw-search-input","gw-body-1",3,"gwFocus","ngModel","dynamicPlaceholder","keydown","keyup","ngModelChange"],["gwTranslate","",1,"mat-body-2","gw-primary-color","newChat__title"],["gwInfiScroll","",1,"users-search",3,"pause","offsetBottomDistance","scrolledInOffset"],["class","newChat__user",3,"click",4,"ngFor","ngForOf"],[1,"newChat__user",3,"click"],[3,"imgSrc","diameter"],[1,"conversation-person-content"],[1,"person-name-line"],[1,"person-name"]],template:function(i,t){1&i&&(e.YNc(0,Ie,28,22,"ng-container",0),e.YNc(1,De,10,6,"ng-container",0),e.TgZ(2,"gw-yes-no-dialog",1),e.NdJ("shouldShowChange",("dialogCancel",("dialogConfirm",,e.ALo(3,"translate"),e.ALo(4,"translate"),e.ALo(5,"translate"),e.qZA()),2&i&&(e.Q6J("ngIf",!t.messagesService.isNewChat&&!!t.messagesService.currentConversation),e.xp6(1),e.Q6J("ngIf",t.messagesService.isNewChat),e.xp6(1),e.Q6J("shouldShow",t.showDeleteDialog)("title",e.lcZ(3,6,"deleteConversationQuestion"))("cancelBtnTitle",e.lcZ(4,8,"cancel"))("confirmBtnTitle",e.lcZ(5,10,"delete")))},directives:[p.O5,m.w,k.f,N.H,w.yS,v.VK,v.OP,x.Hw,v.p6,Z.I,l.Fj,we.D,l.JJ,l.On,L._,ye.H,Q,p.sg],pipes:[S.X,p.Ov],styles:["[_nghost-%COMP%]{display:block;position:relative;background:#F5F2ee;border-radius:8px;padding:10px 8px 8px}.header[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,auto);justify-content:space-between}.header[_ngcontent-%COMP%]   .recipient[_ngcontent-%COMP%]{display:flex;grid-column-gap:8px;column-gap:8px}.header[_ngcontent-%COMP%]   .recipient__back[_ngcontent-%COMP%]{align-self:center;cursor:pointer}.header[_ngcontent-%COMP%]   .recipient__photo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%}.header[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,auto);align-items:center;line-height:0px}.header[_ngcontent-%COMP%]   .actions__ellipsis[_ngcontent-%COMP%]{cursor:pointer}.header[_ngcontent-%COMP%]   .actions__camera[_ngcontent-%COMP%]{cursor:pointer;width:40px;height:40px;border-radius:50%;background:white;display:grid;place-items:center}.header[_ngcontent-%COMP%]   .actions__camera[_ngcontent-%COMP%]   .camera_svg[_ngcontent-%COMP%]{transition:transform .1s,fill .2s;fill:var(--gw-gray-800)}.header[_ngcontent-%COMP%]   .actions__camera[_ngcontent-%COMP%]:hover   .camera_svg[_ngcontent-%COMP%]{fill:currentColor;transform:scale(1.2)}.newChat[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto 1fr;grid-column-gap:16px;align-items:center}.newChat__title[_ngcontent-%COMP%]{border-right:2px solid rgba(0,0,0,.2);padding-right:30px}.newChat__search[_ngcontent-%COMP%]{border-radius:50px;align-items:center;display:grid;grid-template-columns:auto 1fr;grid-column-gap:8px;column-gap:8px;width:100%;padding:6px 0}.newChat__search[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{background:0 0;color:currentColor;border:none;outline:0;padding:0;margin:0;width:100%;max-width:100%;vertical-align:bottom;text-align:inherit}.newChat__user[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;justify-content:start;align-items:center;grid-column-gap:12px;column-gap:12px;padding:4px;cursor:pointer}.newChat__user[_ngcontent-%COMP%]:hover{background:var(--gw-gray-200)}.users-search[_ngcontent-%COMP%]{display:grid;position:absolute;z-index:1;max-height:calc(100vh - 272px);left:0;overflow-y:auto;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));width:calc(100% - 0px);border-radius:8px;background:white}"]}),[(0,u.K)(500)],I.prototype,"getUsers",null);var V=r(91276);function Fe(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",5),e.NdJ("click",,e.TgZ(1,"mat-icon",6),e._uU(2,"videocam"),e.qZA(),e._uU(3),e.ALo(4,"translate"),e.qZA()}2&n&&(e.xp6(3),e.hij("",e.lcZ(4,1,"joinVideoChat")," "))}function He(n,i){if(1&n&&(e.ynx(0),e.TgZ(1,"span"),e._uU(2),e.qZA(),e.YNc(3,Fe,5,3,"button",4),e.ALo(4,"async"),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.Oqu(t.startedAVideoChatText),e.xp6(1),e.Q6J("ngIf",e.lcZ(4,2,t.enabled$))}}function Je(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){return e.CHM(t),e.oxw(3).handleVideoChatButtonClick(null)}),e.TgZ(1,"mat-icon",6),e._uU(2,"videocam"),e.qZA(),e._uU(3),e.qZA()}if(2&n){const t=e.oxw(3);e.xp6(3),e.hij("",t.missedCallButtonText," ")}}function Ne(n,i){if(1&n&&(e.ynx(0),e.TgZ(1,"span",7),e._uU(2),e.qZA(),e.YNc(3,Je,4,1,"button",8),e.ALo(4,"async"),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.Oqu(t.missedCallText),e.xp6(1),e.Q6J("ngIf",e.lcZ(4,2,t.enabled$))}}function Ye(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",,e.TgZ(1,"mat-icon",6),e._uU(2,"videocam"),e.qZA(),e._uU(3),e.qZA()}if(2&n){const t=e.oxw(3);e.xp6(3),e.hij("",t.callAgainText," ")}}function Be(n,i){if(1&n&&(e.ynx(0),e.TgZ(1,"span",7),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,Ye,4,1,"button",8),e.ALo(5,"async"),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.Oqu(e.lcZ(3,2,"callHasEnded")),e.xp6(2),e.Q6J("ngIf",e.lcZ(5,4,t.enabled$))}}function Ee(n,i){if(1&n&&(e.TgZ(0,"div",1),e.TgZ(1,"div",2),e._uU(2),e.qZA(),e.YNc(3,He,5,4,"ng-container",3),e.YNc(4,Ne,5,4,"ng-container",3),e.YNc(5,Be,6,6,"ng-container",3),e.qZA()),2&n){const t=e.oxw();e.xp6(2),e.Oqu(t.gwDateTimeService.displayByTimeFormat(t.message.time,t.timeFormat)),e.xp6(1),e.Q6J("ngIf",t.canShowJoinVideoChat),e.xp6(1),e.Q6J("ngIf",t.missedVideoChat),e.xp6(1),e.Q6J("ngIf",t.videoChatEnded)}}let Qe=(()=>{class n{et callerName(){return this.message.isIncoming?this.messagesService.currentConversation.participantUsersInfo.firstName:this.usersService.currentUser.firstName}get canShowJoinVideoChatet missedVideoChat(){return this.message.call.status===c.Dc.didNotAnswer}et missedCallText(){return this.translatePipe.transform(this.message.isIncoming?"youMissedAVideoChat":"userCouldNotAnswerYourCall",null,[{replace:"#FirstName#",with:this.callerName}])}get missedCallButtonTextt startedAVideoChatText(){return this.translatePipe.transform("hasStartedVideoChat",null,[{replace:"#FirstName#",with:this.callerName}])}ngOnInit(){this.enabled$=this.store.pipe((0,d.Ys)(f.f))}handleVideoChatButtonClick(t){this.store.dispatch(_.pj({payload:t})),this.store.dispatch(_.E4({payload:!0}))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Y.f),e.Y36(d.yh),e.Y36(S.X),e.Y36(h.K),e.Y36(V.V))},n.\u0275cmp=e.Xpm({type:n,selectors:[["messages-video-chat-item"]],inputs:{message:"message",timeFormat:"timeFormat"},decls:1,vars:1,consts:[["class","join-chat-container gw-flex-container gw-flex-column gw-justify-center gw-align-center",4,"ngIf"],[1,"join-chat-container","gw-flex-container","gw-flex-column","gw-justify-center","gw-align-center"],[1,"join-chat-container__time"],[4,"ngIf"],["class","join-chat-container__join-video","mat-stroked-button","","color","primary",3,"click",4,"ngIf"],["mat-stroked-button","","color","primary",1,"join-chat-container__join-video",3,"click"],[1,"gw-margin-right-tiny"],[1,"join-chat-container__missed-call"],["mat-button","","color","primary",3,"click",4,"ngIf"],["mat-button","","color","primary",3,"click"]],template:function(t,s){1&t&&e.YNc(0,Ee,6,4,"div",0),2&t&&e.Q6J("ngIf",!!s.message.call)},directives:[p.O5,P.lW,x.Hw],pipes:[p.Ov,S.X],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   .join-chat-container[_ngcontent-%COMP%]{border-radius:12px;height:110px;width:100%;background:var(--gw-gray-50)}[_nghost-%COMP%]   .join-chat-container__time[_ngcontent-%COMP%]{color:#a6a6a6}[_nghost-%COMP%]   .join-chat-container__join-video[_ngcontent-%COMP%]{max-width:250px;border:solid 1.5px}[_nghost-%COMP%]   .join-chat-container__missed-call[_ngcontent-%COMP%]{color:#f84350}"]}),n})();var R=r(20019),je=r(32619);let qe=(()=>{class n{transform(t,...s){if(!t||"string"!=typeof t)return t;let a=R;if(s&&s[0])switch(s[0]){default:case"string":a=R;break;case"html":a=je}return this.processWithAllowedCharacters(t,a,{defaultProtocol:s&&s[1]||"https",target:s&&s[2]||"_blank"})}processWithAllowedCharacters(t,s,a){const o=[{key:"<3",value:"___########___TEMP_VALUE___########___"}];return o.forEach(g=>{t=t.split(g.key).join(g.value)}),t=s(t,a).toString(),o.forEach(,t}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275pipe=e.Yjl({name:"linkify",type:n,pure:!0}),n})();function Ve(n,i){if(1&n&&(e.TgZ(0,"div",8),e.TgZ(1,"div",9),e._uU(2),e.qZA(),e.qZA()),2&n){const t=e.oxw();e.xp6(2),e.Oqu(t.gwDateTimeService.displayByPlatformDateFormat(t.message.time))}}function Re(n,i){if(1&n&&e._UZ(0,"gw-avatar",10),2&n){const t=e.oxw();e.Q6J("imgSrc",t.profileImage)("diameter",24)("routerLink",t.userProfileLink)}}function ze(n,i){if(1&n&&(e._UZ(0,"div",11),e.ALo(1,"linkify")),2&n){const t=e.oxw();e.Q6J("innerHTML",e.xi3(1,1,t.message.text,"html"),e.oJD)}}const Ge=function(n){return{"background-image":n}};function $e(n,i){if(1&n&&(e.TgZ(0,"div",8),e.TgZ(1,"a",14),e.TgZ(2,"div",15),e.TgZ(3,"div",16),e._UZ(4,"div",17),e.TgZ(5,"div",18),e.TgZ(6,"span"),e._uU(7),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&n){const t=i.$implicit;e.xp6(1),e.s9C("href",t.link,e.LSH),e.xp6(2),e.Q6J("ngClass",t.type),e.xp6(1),e.Q6J("ngStyle",e.VKq(4,Ge,"url("+t.previewUrl+")")),e.xp6(3),e.Oqu(t.name)}}function Ke(n,i){if(1&n&&(e.ynx(0),e.TgZ(1,"div",12),e.YNc(2,$e,8,6,"div",13),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("ngForOf",t.message.attachments)}}function Xe(n,i){if(1&n&&(e.TgZ(0,"div",19),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",t.gwDateTimeService.displayByPlatformTimeFormat(t.message.time)," ")}}const We=et=let tt=(()=>{class n{gOnIniteturn n.\u0275fac=n.\u0275cmp=e.Xpm({type:n,selectors:[["messages-chat-item"]],inputs:{profileImage:"profileImage",message:"message",userId:"userId"},outputs:{onItemAddedView:"onItemAddedView"},decls:8,vars:15,consts:[["class","item",4,"ngIf"],[1,"message",3,"ngClass"],["class","no-border",3,"imgSrc","diameter","routerLink",4,"ngIf"],[1,"message__body",3,"ngClass"],["class","message__body__text",3,"innerHTML",4,"ngIf"],[4,"ngIf"],["class","message__body__time mat-small",4,"ngIf"],[3,"message","timeFormat"],[1,"item"],[1,"date","mat-small"],[1,"no-border",3,"imgSrc","diameter","routerLink"],[1,"message__body__text",3,"innerHTML"],[1,"message-attachments"],["class","item",4,"ngFor","ngForOf"],["target","_blank",3,"href"],[1,"gw-message-attachment"],[1,"gw-message-attachment-inner",3,"ngClass"],[1,"attachment-preview",3,"ngStyle"],[1,"attachment-caption"],[1,"message__body__time","mat-small"]],template:function(t,s){1&t&&(e.YNc(0,Ve,3,1,"div",0),e.TgZ(1,"div",1),e.YNc(2,Re,1,3,"gw-avatar",2),e.TgZ(3,"div",3),e.YNc(4,ze,2,4,"div",4),e.YNc(5,Ke,3,1,"ng-container",5),e.YNc(6,Xe,2,1,"div",6),e._UZ(7,"messages-video-chat-item",7),e.qZA(),e.qZA()),2&t&&(e.Q6J("ngIf",s.message.isFirstInDay),e.xp6(1),e.ekj("message--full-width",!!s.message.call),e.Q6J("ngClass",e.VKq(11,We,s.message.isIncoming?"incoming":"outgoing")),e.xp6(1),e.Q6J("ngIf",!s.message.call),e.xp6(1),e.Q6J("ngClass",e.VKq(13,et,1===s.message.privateMessageTypeId)),e.xp6(1),e.Q6J("ngIf",!!s.message.text),e.xp6(1),e.Q6J("ngIf",!!s.message.attachments),e.xp6(1),e.Q6J("ngIf",!s.message.call),e.xp6(1),e.Q6J("message",s.message)("timeFormat",s.gwDateTimeService.horizontalTimeFormat))},directives:[p.O5,p.mk,Qe,N.H,w.rH,p.sg,p.PC],pipes:[qe],styles:['[_nghost-%COMP%]     p{margin:0!important}[_nghost-%COMP%]{display:block;margin-bottom:4px}[_nghost-%COMP%]   .date[_ngcontent-%COMP%]{line-height:1.5;text-align:center}.message[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,auto);justify-content:start;grid-column-gap:12px;column-gap:12px}.message--full-width[_ngcontent-%COMP%]{grid-template-columns:1fr}.message.outgoing[_ngcontent-%COMP%]{direction:rtl}.message.outgoing[_ngcontent-%COMP%]   .message__body__text[_ngcontent-%COMP%]{width:80%;min-width:250px;display:inline-block;border-radius:10px;padding:4px 10px;direction:ltr;word-break:break-word;background:rgba(0,0,0,.07)}.message.incoming[_ngcontent-%COMP%]   .message__body__text[_ngcontent-%COMP%]{width:80%;min-width:250px;display:inline-block;border-radius:10px;padding:4px 10px;direction:ltr;word-break:break-word;background:white}.message__body__time[_ngcontent-%COMP%]{font-size:10px}.gw-message-attachment-inner[_ngcontent-%COMP%]{height:100px;width:150px;position:relative;cursor:pointer;border:1px solid #eaeaea;border-radius:3px}.gw-message-attachment-inner[_ngcontent-%COMP%]   .attachment-preview[_ngcontent-%COMP%]{width:100%;height:100%;background-size:contain;background-repeat:no-repeat;background-position:center center;position:relative;border-radius:2px;margin:4px 0}.gw-message-attachment-inner[_ngcontent-%COMP%]   .attachment-preview[_ngcontent-%COMP%]:after{content:"";display:block;width:0;height:0;border-style:solid;border-width:0 0 16px 16px;border-color:transparent transparent #ddd transparent;position:absolute;right:0;bottom:0;z-index:10}.gw-message-attachment-inner[_ngcontent-%COMP%]   .attachment-preview[_ngcontent-%COMP%]:before{content:"";display:block;border-width:0 0 16px 16px;border-style:solid;border-color:transparent transparent var(--gw-white) transparent;position:absolute;right:-1px;bottom:-1px;z-index:10}.gw-message-attachment-inner[_ngcontent-%COMP%]   .attachment-caption[_ngcontent-%COMP%]{position:absolute;bottom:0;z-index:5;left:0;width:100%;height:25px;padding:5px 40px 5px 10px;background:rgba(114,114,114,.75);color:var(--gw-white)}.gw-message-attachment-inner[_ngcontent-%COMP%]   .attachment-caption[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:10px;line-height:15px;display:block;height:15px}.gw-message-attachment-inner[_ngcontent-%COMP%]   .attachment-caption[_ngcontent-%COMP%]:after{content:"";display:block;width:0;height:0;border-style:solid;border-width:16px 16px 0 0;border-color:#5e5e5e transparent transparent transparent;position:absolute;right:0px;bottom:0px;z-index:10}.gw-message-attachment-inner[_ngcontent-%COMP%]   .attachment-caption[_ngcontent-%COMP%]:before{content:"";display:block;width:0;height:0;border-style:solid;border-width:0 0 16px 16px;border-color:transparent transparent #464646 transparent;position:absolute;right:16px;bottom:0px;z-index:10}.gw-message-attachment-inner.type-file[_ngcontent-%COMP%]   .attachment-preview[_ngcontent-%COMP%]:after{border-color:transparent transparent var(--gw-white) transparent}.gw-message-attachment-inner.type-file[_ngcontent-%COMP%]   .attachment-caption[_ngcontent-%COMP%]{background:var(--gw-gray-100);color:var(--gw-text-color)}.gw-message-attachment-inner.type-file[_ngcontent-%COMP%]   .attachment-caption[_ngcontent-%COMP%]:after{border-color:#589ccd transparent transparent transparent}.gw-message-attachment-inner.type-file[_ngcontent-%COMP%]   .attachment-caption[_ngcontent-%COMP%]:before{border-color:transparent transparent #d3d3d3 transparent}@media screen and (max-width: 1024px){.gw-message-attachment-inner[_ngcontent-%COMP%]{width:100px;height:85px}}messages-video-chat-item[_ngcontent-%COMP%]{margin-bottom:8px}']}),n})();const nt=["messageItems"];nction at(n,i){if(1&n&&e._UZ(0,"messages-chat-item",10),2&n){const t=i.$implicit,s=e.oxw(2);e.Q6J("profileImage",t.isIncoming?s.otherUserImageUrl:s.currentUserImageUrl)("message",t)("userId",t.isIncoming?s.otherUserId:s.currentUserId)}}et ot=(()=>{class n{constructor(t,s){this.messagesService=t,this.usersService=s,this.callEnabled=!1,this.daysArray=[],this.pauseScroll=!1,this.messageSubject$=this.messagesService.rawActiveChatMessagesBehaviorSubject,this.currentUserImageUrl=this.messagesService.currentUserImageUrl}get otherUserImageUrlInit(){this.messageSubscription=this.messagesService.rawActiveChatMessagesBehaviorSubject.subscribe(t=>{this.daysArray=[],this.messages=new c.jA(...t||[])}),this.messagesService.conversationListFilter=c.ri.all}return n.\u0275fac=n.\u0275cmp=e.Xpm({type:n,selectors:[["messages-chat"]],viewQuery:inputs:{callEnabled:"callEnabled",referrer:"referrer"},decls:10,vars:5,consts:[[1,"messages-chat-container","gw-keyboard-input-small"],[3,"referrer",4,"ngIf","ngIfElse"],["blankDiv",""],[1,"gw-messages-list"],[1,"gw-message-items",3,"scrollToEnd","scrollDelayMs"],["messageItems",""],[4,"ngIf"],[3,"referrer"],[1,"data"],[3,"profileImage","message","userId",4,"ngFor","ngForOf"],[3,"profileImage","message","userId"]],template:function(t,s){if(1&t&&(e.TgZ(0,"div",0),e.YNc(1,st,1,1,"messages-chat-header",1),e.YNc(2,it,1,0,"ng-template",null,2,e.W1O),e.TgZ(4,"div",3),e.TgZ(5,"div",4,5),e.YNc(7,rt,2,1,"ng-container",6),e.qZA(),e._UZ(8,"messages-chat-files-list"),e.qZA(),e._UZ(9,"messages-textbox"),e.qZA()),2&t){const a=e.MAs(3);e.xp6(1),e.Q6J("ngIf",s.canShowMessageChatHeader)("ngIfElse",a),e.xp6(4),e.Q6J("scrollToEnd",s.messageSubject$)("scrollDelayMs",0),e.xp6(2),e.Q6J("ngIf",s.canShowMessageChatHeader)}},directives:[p.O5,se,re,pe,I,p.sg,tt],styles:[".messages-chat-container[_ngcontent-%COMP%]{background:#ede9e2;padding:8px;border-radius:12px}@media screen and (max-width: 1024px){.messages-chat-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:calc(100vh - 82px)}}@media screen and (min-width: 1024px){.messages-chat-container[_ngcontent-%COMP%]{display:grid;grid-template-rows:auto 1fr auto;height:calc(100vh - 165px)}}.gw-messages-list[_ngcontent-%COMP%]   messages-chat-item[_ngcontent-%COMP%]{margin-bottom:4px}.gw-messages-list[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-scrollbar{width:4px}.gw-messages-list[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1}.gw-messages-list[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#888;border-radius:10px}.gw-messages-list[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:var(--gw-gray-800)}.gw-messages-list[_ngcontent-%COMP%]{padding-top:9px;position:relative;height:calc(100% - 8px);overflow-y:hidden}.gw-messages-list[_ngcontent-%COMP%]   .gw-message-items[_ngcontent-%COMP%]{padding:6px 15px 15px;border-bottom:1px solid #ddd;height:100%;overflow-y:auto;overflow-x:hidden;scroll-behavior:smooth;width:100%;margin-right:0;transition:all .2s}@media screen and (max-width: 1024px){.gw-messages-list[_ngcontent-%COMP%]   .gw-message-items[_ngcontent-%COMP%]{height:100%}}"]}),n})();function ct(n,i){if(1&n&&(e._UZ(0,"messages-users-list"),e.ALo(1,"async")),2&n){const t=e.oxw();e.Udp("display",e.lcZ(1,2,t.messagesService.chatOrder$)?"none":"grid")}}unction gt(n,i){if(1&n&&(e._UZ(0,"messages-chat",6),e.ALo(1,"async"),e.ALo(2,"async"),e.ALo(3,"async")),2&n){const t=e.oxw();e.Udp("display",e.lcZ(1,4,t.messagesService.chatOrder$)?"grid":"none"),e.Q6J("referrer",e.lcZ(2,6,t.referrer$))("callEnabled",e.lcZ(3,8,t.callEnabled$))}}function mt(n,i){if(1&n&&(e._UZ(0,"messages-chat",6),e.ALo(1,"async"),e.ALo(2,"async")),2&n){const t=e.oxw();e.Q6J("referrer",e.lcZ(1,2,t.referrer$))("callEnabled",e.lcZ(2,4,t.callEnabled$))}}let B=(()=>{class n{constructor(t,s,a,o,g){this.messagesService=t,this.activatedRoute=s,this.gwMobileService=a,this.router=o,this.store=g,this.areConversationsLoaded=!1;const M=this.getCallReferrer();this.store.dispatch(_.Sn({payload:M}))}get usersListCssClass(){return{hide:this.isMobileViewHideByName("users-list")}}get chatCssClassgOnInit(){this.getConversationFromUrlParam(),this.callEnabled$=this.store.pipe((0,d.Ys)(f.f)),this.referrer$=this.store.pipe((0,d.Ys)(f.Re))}isMobileViewHideByName(t){return this.gwMobileService.isMobileModeOn&&this.messagesService.mobileView!==t}getConversationFromUrlParam(){const t=parseInt(C()(this.activatedRoute.snapshot.params,"id",null),10);!t||(this.messagesService.conversationsListSubject.subscribe(s=>{this.areConversationsLoaded||(s&&s.get(t)&&(this.messagesService.activeChatUserId=t),this.messagesService.skipActiveChatUserFromFilter=!0,this.areConversationsLoaded=!!s)}),this.gwMobileService.isMobileModeOn&&(this.messagesService.mobileView="users-list"))}getCallReferrer(){const t=this.router.getCurrentNavigation();return t&&t.extras&&t.extras.state?t.extras.state.videoChatReferrer:null}}return n.\u0275fac=n.\u0275cmp=e.Xpm({type:n,selectors:[["messages"]],decls:11,vars:13,consts:[[1,"messages-container","card-container"],[3,"display",4,"mobile"],[4,"desktop"],[3,"referrer","callEnabled","display",4,"mobile"],[3,"referrer","callEnabled",4,"desktop"],[3,"title","confirmBtnTitle","cancelBtnTitle","shouldShow","shouldShowChange","dialogConfirm"],[3,"referrer","callEnabled"]],template:function(t,s){1&t&&(e.TgZ(0,"div",0),e.YNc(1,ct,2,4,"messages-users-list",1),e.YNc(2,lt,1,0,"messages-users-list",2),e.YNc(3,gt,4,10,"messages-chat",3),e.YNc(4,mt,3,6,"messages-chat",4),e.qZA(),e.TgZ(5,"gw-yes-no-dialog",5),e.NdJ("shouldShowChange",("dialogConfirm",,e.ALo(6,"translate"),e.ALo(7,"translate"),e.ALo(8,"translate"),e._uU(9),e.ALo(10,"translate"),e.qZA()),2&t&&(e.xp6(5),e.Q6J("title",e.lcZ(6,5,"confirmDiscardChanges"))("confirmBtnTitle",e.lcZ(7,7,"discard"))("cancelBtnTitle",e.lcZ(8,9,"cancel"))("shouldShow",s.messagesService.showDiscardChangesDialog),e.xp6(4),e.hij("",e.lcZ(10,11,"confirmDiscardChangesMessage")," "))},directives:[k.f,Z.I,m.w,ne,ot],pipes:[S.X,p.Ov],styles:[".messages-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 2fr;padding:8px;margin:6px 0 0}@media screen and (max-width: 1024px){.messages-container[_ngcontent-%COMP%]{grid-template-columns:1fr}}[_nghost-%COMP%]     .video-chat-main-container{width:100%;height:100%}[_nghost-%COMP%]     .video-chat-main-container iframe{border-radius:12px}[_nghost-%COMP%]     .video-chat-main-container .video-chat-container{display:flex;justify-content:flex-start;align-items:center;flex-direction:column;color:var(--gw-gray-800);height:100%}[_nghost-%COMP%]     .video-chat-main-container .video-chat-container--center{justify-content:center}[_nghost-%COMP%]     .video-chat-main-container .video-chat-container .video-chat-inner{display:flex;align-items:center;flex-direction:column;max-width:300px}[_nghost-%COMP%]     .video-chat-main-container .video-chat-container .video-chat-inner__title{margin:0;font-size:20px;font-weight:bold;line-height:1.2;text-align:center}[_nghost-%COMP%]     .video-chat-main-container .video-chat-container .video-chat-description{min-width:300px;line-height:1.4;text-align:center;width:100%}[_nghost-%COMP%]     .video-chat-main-container .video-chat-container .video-chat-description__title{width:60%;display:inline-block;font-weight:500;font-size:16px}[_nghost-%COMP%]     .video-chat-main-container .video-chat-container .video-chat-description__subtitle{display:inline-block;width:70%;font-size:16px}[_nghost-%COMP%]     .video-chat-main-container .video-chat-container .video-chat-description__subtitle--small{font-size:14px}[_nghost-%COMP%]     .video-chat-main-container .video-chat-container .video-chat-buttons-container{margin-top:20px;display:flex;flex-direction:column}[_nghost-%COMP%]     .video-chat-main-container .video-chat-container .video-chat-buttons-container button{margin-bottom:8px}[_nghost-%COMP%]     .gw-send-attachment-inner{display:flex;width:215px;padding:3px 8px;background:var(--gw-gray-50);border-radius:3px;transition:all .3s;cursor:pointer}[_nghost-%COMP%]     .gw-send-attachment-inner:hover{background:#ddd}[_nghost-%COMP%]     .gw-send-attachment-inner .icon, [_nghost-%COMP%]     .gw-send-attachment-inner .remove{flex:none;color:var(--gw-text-color)}[_nghost-%COMP%]     .gw-send-attachment-inner .icon i, [_nghost-%COMP%]     .gw-send-attachment-inner .remove i{display:block;font-size:var(--font-size-l);line-height:18px}[_nghost-%COMP%]     .gw-send-attachment-inner .icon{margin-right:6px;margin-left:-3px}[_nghost-%COMP%]     .gw-send-attachment-inner .name{flex:auto;font-size:12px;line-height:18px;color:var(--gw-text-color);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}[_nghost-%COMP%]     .gw-send-attachment-inner .remove{transition:all .3s;margin-left:10px;margin-right:-3px}[_nghost-%COMP%]     .gw-send-attachment-inner .remove:hover{color:var(--gw-gray-900)}@media screen and (max-width: 1024px){[_nghost-%COMP%]     .gw-send-attachment-inner{width:100%;padding:9px 8px}}"]}),n})();var dt=r(24270),E=r(29007);const pt=[{path:"",component:B,canDeactivate:[E.M]},{path:":id/meet/:roomId",component:B,canDeactivate:[E.M]},{path:":id",component:B,canDeactivate:[E.M]}];let ht=(()=>{eturn n.\u0275fac=n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[h.K,q.r],imports:[[w.Bz.forChild(pt),dt.m],w.Bz]}),n})()}}]);