!"undefined"!=typeof window?window:this,function(e,t){urn!0}e=ne.concat,ae=ne.push,se=ne.indexOf,ue={},ce=ue.toString,le=ue.hasOwnProperty,de={},fe="1.12.4",pe=he=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ve=/^-ms-/,me=/-([\da-z])/gi,ge=pe.fn=pe.prototype={jquery:fe,constructor:pe,selector:"",length:0,toArray:get:pushStack:each:map:slice:first:last:eq:end:push:ae,sort:ne.sort,splice:ne.splice},pe.extend=pe.fn.extend=pe.extend({expando:"jQuery"+(fe+Math.random()).replace(/\D/g,""),isReady:!0,error:noop:function(){},isFunction:function(e){return"function"===pe.type(e)},isArray:Array.isArray||isWindow:isNumeric:isEmptyObject:isPlainObject:type:globalEval:camelCase:nodeName:each:trim:makeArray:inArray:merge:grep:map:guid:1,proxy:now:support:de}),"function"==typeof Symbol&&(pe.fn[Symbol.iterator]=ne[Symbol.iterator]),pe.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),;var ye=e);pe.find=ye,pe.expr=ye.selectors,pe.expr[":"]=pe.expr.pseudos,pe.uniqueSort=pe.unique=ye.uniqueSort,pe.text=ye.getText,pe.isXMLDoc=ye.isXML,pe.contains=ye.contains;var be=_e=we=pe.expr.match.needsContext,xe=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,Ce=/^.[^:#\[\.,]*$/;pe.filter=pe.fn.extend({find:filter:function(e){return this.pushStack(r(this,e||[],!1))},not:is:);var Ee,Te=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,Se=pe.fn.init=Se.prototype=pe.fn,Ee=pe(re);var ke=/^(?:parents|prev(?:Until|All))/,Ae={children:!0,contents:!0,next:!0,prev:!0};pe.fn.extend({has:closest:index:add:addBack:),pe.each({parent:parents:function(e){return be(e,"parentNode")},parentsUntil:function(e,t,n){return be(e,"parentNode",n)},next:function(e){return i(e,"nextSibling")},prev:function(e){return i(e,"previousSibling")},nextAll:function(e){return be(e,"nextSibling")},prevAll:nextUntil:function(e,t,n){return be(e,"nextSibling",n)},prevUntil:siblings:children:contents:,;var Re=/\S+/g;pe.Callbacks=pe.extend({Deferred:when:);var je;pe.fn.ready=pe.extend({isReady:!1,readyWait:1,holdReady:ready:),pe.ready.promise=pe.ready.promise();var Oe;for(Oe in pe(de))break;de.ownFirst="0"===Oe,de.inlineBlockNeedsLayout=!1,pe(,);var Ne=De=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Pe=/([A-Z])/g;pe.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:data:removeData:function(e,t){return d(e,t)},_data:_removeData:),pe.fn.extend({data:removeData:function(e){return this.each(function(){pe.removeData(this,e)})}}),pe.extend({queue:dequeue:_queueHooks:),pe.fn.extend({queue:dequeue:clearQueue:promise:),);var Ie=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Fe=new RegExp("^(?:([+-])=|)("+Ie+")([a-z%]*)$","i"),Le=["Top","Right","Bottom","Left"],Me=qe=Be=/^(?:checkbox|radio)$/i,He=/<([\w:-]+)/,Ue=/^$|\/(?:java|ecma)script/i,$e=/^\s+/,Ge="abbr|article|aside|audio|bdi|canvas|data|datalist|details|dialog|figcaption|figure|footer|header|hgroup|main|mark|meter|nav|output|picture|progress|section|summary|template|time|video";!);var Ve={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:de.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]};Ve.optgroup=Ve.option,Ve.tbody=Ve.tfoot=Ve.colgroup=Ve.caption=Ve.thead,Ve.th=Ve.td;var We=/<|&#?\w+;/,Xe=/<tbody/i;!);var ze=/^(?:input|select|textarea)$/i,Je=/^key/,Qe=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Ye=/^(?:focusinfocus|focusoutblur)$/,Ke=/^([^.]*)(?:\.(.+)|)/;pe.event={global:{},add:remove:trigger:dispatch:handlers:fix:props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:,mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:,special:{load:{noBubble:!0},focus:{trigger:delegateType:"focusin"},blur:{trigger:delegateType:"focusout"},click:{trigger:_default:,beforeunload:{postDispatch:},simulate:,pe.removeEvent=re.removeEventListener?pe.Event=pe.Event.prototype={constructor:pe.Event,isDefaultPrevented:b,isPropagationStopped:b,isImmediatePropagationStopped:b,preventDefault:stopPropagation:stopImmediatePropagation:,pe.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},,de.submit||(pe.event.special.submit={setup:postDispatch:teardown:),de.change||(pe.event.special.change={setup:handle:teardown:),de.focusin||pe.each({focus:"focusin",blur:"focusout"},,pe.fn.extend({on:one:off:trigger:triggerHandler:);var Ze=/ jQuery\d+="(?:null|\d+)"/g,et=new RegExp("<(?:"+Ge+")[\\s/>]","i"),tt=/<script|<style|<link/i,nt=/checked\s*(?:[^=]|=\s*.checked.)/i,rt=/^true\/(.*)/,it=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ot=p(re),at=ot.appendChild(re.createElement("div"));pe.extend({htmlPrefilter:function(e){return e},clone:cleanData:),pe.fn.extend({domManip:k,detach:remove:function(e){return A(this,e)},text:append:prepend:before:after:empty:clone:html:replaceWith:),pe.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",
insertAfter:"after",replaceAll:"replaceWith"},;var st,ut={HTML:"block",BODY:"block"},ct=/^margin/,lt=new RegExp("^("+Ie+")(?!px)[a-z%]+$","i"),dt=ft=re.documentElement;!);var pt,ht,vt=/^(top|right|bottom|left)$/;e.getComputedStyle?(pt=ht=:ft.currentStyle&&(pt=function(e){return e.currentStyle},ht=;var mt=/alpha\([^)]*\)/i,gt=/opacity\s*=\s*([^)]*)/i,yt=/^(none|table(?!-c[ea]).+)/,bt=new RegExp("^("+Ie+")(.*)$","i"),_t={position:"absolute",visibility:"hidden",display:"block"},wt={letterSpacing:"0",fontWeight:"400"},xt=["Webkit","O","Moz","ms"],Ct=re.createElement("div").style;pe.extend({cssHooks:{opacity:{get:},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:de.cssFloat?"cssFloat":"styleFloat"},style:css:),pe.each(["height","width"],,de.opacity||(pe.cssHooks.opacity={get:set:),pe.cssHooks.marginRight=O(de.reliableMarginRight,,pe.cssHooks.marginLeft=O(de.reliableMarginLeft,,pe.each({margin:"",padding:"",border:"Width"},,pe.fn.extend({css:show:hide:function(){return D(this)},toggle:),pe.Tween=L,L.prototype={constructor:L,init:cur:run:,L.prototype.init.prototype=L.prototype,L.propHooks={_default:{get:set:},L.propHooks.scrollTop=L.propHooks.scrollLeft={set:,pe.easing={linear:function(e){return e},swing:_default:"swing"},pe.fx=L.prototype.init,pe.fx.step={};var Et,Tt,St=/^(?:toggle|show|hide)$/,kt=/queueHooks$/;pe.Animation=pe.extend($,{tweeners:{"*":[},tweener:prefilters:[H],prefilter:),pe.speed=pe.fn.extend({fadeTo:animate:stop:finish:),pe.each(["toggle","show","hide"],,pe.each({slideDown:q("show"),slideUp:q("hide"),slideToggle:q("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},,pe.timers=[],pe.fx.tick=pe.fx.timer=pe.fx.interval=13,pe.fx.start=pe.fx.stop=pe.fx.speeds={slow:600,fast:200,_default:400},pe.fn.delay=);var At=/\r/g,Rt=/[\x20\t\r\n\f]+/g;pe.fn.extend({val:),pe.extend({valHooks:{option:{get:,select:{get:set:}}),pe.each(["radio","checkbox"],;var jt,Ot,Nt=pe.expr.attrHandle,Dt=/^(?:checked|selected)$/i,Pt=de.getSetAttribute,It=de.input;pe.fn.extend({attr:function(e,t){return qe(this,pe.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){pe.removeAttr(this,e)})}}),pe.extend({attr:attrHooks:{type:{set:},removeAttr:),Ot={set:,pe.each(pe.expr.match.bool.source.match(/\w+/g),,It&&Pt||(pe.attrHooks.value={set:),Pt||(jt={set:,Nt.id=Nt.name=Nt.coords=pe.valHooks.button={get:set:jt.set},pe.attrHooks.contenteditable={set:,pe.each(["width","height"],),de.style||(pe.attrHooks.style={get:set:);var Ft=/^(?:input|select|textarea|button|object)$/i,Lt=/^(?:a|area)$/i;pe.fn.extend({prop:removeProp:),pe.extend({prop:propHooks:{tabIndex:{get:},propFix:{for:"htmlFor",class:"className"}}),de.hrefNormalized||pe.each(["href","src"],,de.optSelected||(pe.propHooks.selected={get:set:),pe.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],,de.enctype||(pe.propFix.enctype="encoding");var Mt=/[\t\r\n\f]/g;pe.fn.extend({addClass:removeClass:toggleClass:hasClass:),pe.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),,pe.fn.extend({hover:);var qt=e.location,Bt=pe.now(),Ht=/\?/,Ut=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;pe.parseJSON=pe.parseXML=var $t=/#.*$/,Gt=/([?&])_=[^&]*/,Vt=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Wt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Xt=/^(?:GET|HEAD)$/,zt=/^\/\//,Jt=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Qt={},Yt={},Kt="*/".concat("*"),Zt=qt.href,en=Jt.exec(Zt.toLowerCase())||[];pe.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Zt,type:"GET",isLocal:Wt.test(en[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Kt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":pe.parseJSON,"text xml":pe.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:ajaxPrefilter:V(Qt),ajaxTransport:V(Yt),ajax:getJSON:getScript:),pe.each(["get","post"],,pe._evalUrl=pe.fn.extend({wrapAll:wrapInner:wrap:unwrap:),pe.expr.filters.hidden=pe.expr.filters.visible=var tn=/%20/g,nn=/\[\]$/,rn=/\r?\n/g,on=/^(?:submit|button|image|reset|file)$/i,an=/^(?:input|select|textarea|keygen)/i;pe.param=pe.fn.extend({serialize:serializeArray:),pe.ajaxSettings.xhr=void 0!==e.ActiveXObject?Z;var sn=0,un={},cn=pe.ajaxSettings.xhr();e.attachEvent&&e.attachEvent("onunload",,de.cors=!!cn&&"withCredentials"in cn,cn=de.ajax=!!cn,cn&&pe.ajaxTransport(,pe.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":}),pe.ajaxPrefilter(,pe.ajaxPrefilter("script",,pe.ajaxTransport("script",;var ln=[],dn=/(=)\?(?=&|$)|\?\?/;pe.ajaxSetup({jsonp:"callback",jsonpCallback:),pe.ajaxPrefilter("json jsonp",,pe.parseHTML=var fn=pe.fn.load;pe.fn.load=pe.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],,pe.expr.filters.animated=pe.offset={setOffset:,pe.fn.extend({offset:position:offsetParent:),pe.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},,pe.each(["top","left"],,pe.each({Height:"height",Width:"width"},,pe.fn.extend({bind:unbind:delegate:undelegate:),pe.fn.size=function(){return this.length},pe.fn.andSelf=pe.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return pe});var pn=e.jQuery,hn=e.$;return pe.noConflict=t||(e.jQuery=e.$=pe),pe}),!function(){var e,t,n;return {1:[{}],2:[function(e,t,n){"use strict";unction i(e,t,n){this._lateQueue.push(e,t,n),this._queueTick()}r s;try{throw new Error}catch(e){s=e}var u=e("./schedule.js"),c=e("./queue.js"),l=e("./util.js");r.prototype.disableTrampolineIfNecessary=r.prototype.enableTrampoline=r.prototype.haveItemsQueued=r.prototype.throwLater=l.hasDevTools?(u.isStatic&&(u=function(e){setTimeout(e,0)}),r.prototype.invokeLater=r.prototype.invoke=r.prototype.settlePromises=:(r.prototype.invokeLater=i,r.prototype.invoke=o,r.prototype.settlePromises=a),r.prototype.invokeFirst=r.prototype._drainQueue=r.prototype._drainQueues=r.prototype._queueTick=r.prototype._reset=function(){this._isTickUsed=!1},t.exports=new r,t.exports.firstLineError=s},{"./queue.js":20,"./schedule.js":21,"./util.js":26}],3:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=i=o=function(e,t){this._isPending()&&this._resolveCallback(t.target)},a=e.prototype.bind=function(r){var s=n(r),u=new e(t);u._propagateFrom(this,1);var c=this._target();if(u._setBoundTo(s),s instanceof e){var l={promiseRejectionQueued:!1,promise:u,target:c,bindingPromise:s};c._then(t,i,u._progress,u,l),s._then(o,a,u._progress,u,l)}else u._resolveCallback(c);return u},e.prototype._setBoundTo=e.prototype._isBound=function(){return 131072===(131072&this._bitField)},e.bind=function(r,i){var o=n(r),a=new e(t);return a._setBoundTo(o),o instanceof e?o._then(function(){a._resolveCallback(i)},a._reject,a._progress,a,null):a._resolveCallback(i),a}}},{}],4:[{"./promise.js":17}],5:[function(e,t,n){"use strict";t.exports=function(t){var n=e("./errors.js"),r=e("./async.js"),i=n.CancellationError;t.prototype._cancel=t.prototype.cancel=t.prototype.cancellable=function(){return this._cancellable()?this:(r.enableTrampoline(),this._setCancellable(),this._cancellationParent=void 0,this)},t.prototype.uncancellable=t.prototype.fork=},{"./async.js":2,"./errors.js":11}],6:[function(e,t,n){"use strict";t.exports=function(){on s(e){var t;if("function"==typeof e)t="[function "+(e.name||"anonymous")+"]";else{t=e.toString();var n=/\[object [a-zA-Z0-9$_]+\]/;if(n.test(t))try{var r=JSON.stringify(e);t=r}catch(e){}0===t.length&&(t="(empty array)")}return"(<"+u(t)+">, no stack trace)"}r l,d=e("./async.js"),f=e("./util.js"),p=/[\\\/]bluebird[\\\/]js[\\\/](main|debug|zalgo|instrumented)/,h=null,v=null,m=!1;f.inherits(t,Error),t.prototype.uncycle=t.prototype.parent=function(){return this._parent},t.prototype.hasParent=t.prototype.attachExtraTrace=function(e){if(!e.__stackCleaned__){this.uncycle();for(var a=t.parseStackAndMessage(e),s=a.message,u=[a.stack],c=this;void 0!==c;)u.push(o(c.stack.split("\n"))),c=c._parent;i(u),r(u),f.notEnumerableProp(e,"stack",n(s,u)),f.notEnumerableProp(e,"__stackCleaned__",!0)}},t.parseStackAndMessage=function(e){var t=e.stack,n=e.toString();return t="string"==typeof t&&t.length>0?a(e):["    (No stack trace)"],{message:n,stack:o(t)}},t.formatAndLogError=function(e,t){if("undefined"!=typeof console){var n;if("object"==typeof e||"function"==typeof e){var r=e.stack;n=t+v(r,e)}else n=t+String(e);"function"==typeof l?l(n):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(n)}},t.unhandledRejection=t.isSupported=t.fireRejectionEvent=var g=function(){return!1},y=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;t.setBounds=function(e,n){if(t.isSupported()){for(var r,i,o=e.stack.split("\n"),a=n.stack.split("\n"),s=-1,u=-1,l=0;l<o.length;++l){var d=c(o[l]);if(d){r=d.fileName,s=d.line;break}}for(var l=0;l<a.length;++l){var d=c(a[l]);if(d){i=d.fileName,u=d.line;break}}s<0||u<0||!r||!i||r!==i||s>=u||(g=}};var b,_=function(){var e=/^\s*at\s*/,t=if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit=Error.stackTraceLimit+6,h=e,v=t;var n=Error.captureStackTrace;return g=function(e){return p.test(e)},var r=new Error;if("string"==typeof r.stack&&r.stack.split("\n")[0].indexOf("stackDetection@")>=0)return h=/@/,v=t,m=!0,var i;try{throw new Error}catch(e){i="stack"in e}return"stack"in r||!i||"number"!=typeof Error.stackTraceLimit?(v=null):(h=e,v=t,}([]),w=function(){if(f.isNode)return var e=!1,t=!0;try{var n=new self.CustomEvent("test");e=n instanceof CustomEvent}catch(e){}if(!e)try{var r=document.createEvent("CustomEvent");r.initCustomEvent("testingtheevent",!1,!0,{}),self.dispatchEvent(r)}catch(e){t=!1}t&&(b=function(t,n){var r;return e?r=new self.CustomEvent(t,{detail:n,bubbles:!1,cancelable:!0}):self.dispatchEvent&&(r=document.createEvent("CustomEvent"),r.initCustomEvent(t,!1,!0,n)),!!r&&!self.dispatchEvent(r)});var i={};return i.unhandledRejection="onunhandledRejection".toLowerCase(),i.rejectionHandled="onrejectionHandled".toLowerCase(),();return"undefined"!=typeof console&&"undefined"!=typeof console.warn&&(l=function(e){console.warn(e)},f.isNode&&process.stderr.isTTY?l=f.isNode||"string"!=typeof(new Error).stack||(l=),t}},{"./async.js":2,"./util.js":26}],7:[function(e,t,n){"use strict";t.exports=function(t){unction r(e,t){var n={},r=a(e).call(n,t);if(r===s)return r;var i=u(n);return i.length?(s.e=new c("Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n"),s):r}var i=e("./util.js"),o=e("./errors.js"),a=i.tryCatch,s=i.errorObj,u=e("./es5.js").keys,c=o.TypeError;return n.prototype.doFilter=function(e){for(var n=this._callback,i=this._promise,o=i._boundValue(),u=0,c=this._instances.length;u<c;++u){var l=this._instances[u],d=l===Error||null!=l&&l.prototype instanceof Error;if(d&&e instanceof l){var f=a(n).call(o,e);return f===s?(t.e=f.e,t):f}if("function"==typeof l&&!d){var p=r(l,e);if(p===s){e=s.e;break}if(p){var f=a(n).call(o,e);return f===s?(t.e=f.e,t):f}}}return t.e=e,t},n}},{"./errors.js":11,"./es5.js":12,"./util.js":26}],8:[function(e,t,n){"use strict";t.exports=function(e,t,n){unction i(){if(n())return new r}ar a=[];return r.prototype._pushContext=r.prototype._popContext=e.prototype._peekContext=o,e.prototype._pushContext=r.prototype._pushContext,e.prototype._popContext=r.prototype._popContext,i}},{}],9:[function(e,t,n){"use strict";t.exports=function(t,n){var r,i,o=t._getDomain,a=e("./async.js"),s=e("./errors.js").Warning,u=e("./util.js"),c=u.canAttachTrace,l=u.isNode&&(!!process.env.BLUEBIRD_DEBUG||"development"===process.env.NODE_ENV);return l&&a.disableTrampolineIfNecessary(),t.prototype._ignoreRejections=function(){this._unsetRejectionIsUnhandled(),this._bitField=16777216|this._bitField},t.prototype._ensurePossibleRejectionHandled=t.prototype._notifyUnhandledRejectionIsHandled=t.prototype._notifyUnhandledRejection=t.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=524288|this._bitField},t.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=this._bitField&-524289},t.prototype._isUnhandledRejectionNotified=function(){return(524288&this._bitField)>0},t.prototype._setRejectionIsUnhandled=function(){this._bitField=2097152|this._bitField},t.prototype._unsetRejectionIsUnhandled=t.prototype._isRejectionUnhandled=function(){return(2097152&this._bitField)>0},t.prototype._setCarriedStackTrace=t.prototype._isCarryingStackTrace=function(){return(1048576&this._bitField)>0},t.prototype._getCarriedStackTrace=t.prototype._captureStackTrace=t.prototype._attachExtraTrace=t.prototype._warn=t.onPossiblyUnhandledRejection=function(e){var t=o();i="function"==typeof e?null===t?e:t.bind(e):void 0},t.onUnhandledRejectionHandled=t.longStackTraces=function(){if(a.haveItemsQueued()&&l===!1)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/DT1qyG\n");l=n.isSupported(),l&&a.disableTrampolineIfNecessary()},t.hasLongStackTraces=n.isSupported()||(t.longStackTraces=function(){},l=!1),function(){return l}}},{"./async.js":2,"./errors.js":11,"./util.js":26}],10:[function(e,t,n){"use strict";var r=e("./util.js"),i=r.isPrimitive;t.exports=function(e){var t=n=r=function(){},o=a=e.prototype.return=e.prototype.thenReturn=function(e){return void 0===e?this.then(r):i(e)?this._then(a(e,2),void 0,void 0,void 0,void 0):this._then(t,void 0,void 0,e,void 0)},e.prototype.throw=e.prototype.thenThrow=function(e){return void 0===e?this.then(o):i(e)?this._then(a(e,1),void 0,void 0,void 0,void 0):this._then(n,void 0,void 0,e,void 0)}}},{"./util.js":26}],11:[function(e,t,n){"use strict";r o,a,s=e("./es5.js"),u=s.freeze,c=e("./util.js"),l=c.inherits,d=c.notEnumerableProp,f=r("Warning","warning"),p=r("CancellationError","cancellation error"),h=r("TimeoutError","timeout error"),v=r("AggregateError","aggregate error");try{o=TypeError,a=RangeError}catch(e){o=r("TypeError","type error"),a=r("RangeError","range error")}for(var m="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),g=0;g<m.length;++g)"function"==typeof Array.prototype[m[g]]&&(v.prototype[m[g]]=Array.prototype[m[g]]);s.defineProperty(v.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),v.prototype.isOperational=!0;var y=0;v.prototype.toString=l(i,Error);var b=Error.__BluebirdErrorTypes__;b||(b=u({CancellationError:p,TimeoutError:h,OperationalError:i,RejectionError:i,AggregateError:v}),d(Error,"__BluebirdErrorTypes__",b)),t.exports={Error:Error,TypeError:o,RangeError:a,CancellationError:b.CancellationError,OperationalError:b.OperationalError,TimeoutError:b.TimeoutError,AggregateError:b.AggregateError,Warning:f}},{"./es5.js":12,"./util.js":26}],12:[{}],13:[function(e,t,n){"use strict";t.exports=function(t,n,r){tion u(e,t,n){var r;return r=f(t)?n?a(t):s(t):n?i:o,e._then(r,p,void 0,t,void 0)}function c(e){var i=this.promise,o=this.handler,a=i._isBound()?o.call(i._boundValue()):o();if(void 0!==a){var s=r(a,i);if(s instanceof t)return s=s._target(),u(s,e,i.isFulfilled())}return i.isRejected()?(n.e=e,n):e}function l(e){var n=this.promise,i=this.handler,o=n._isBound()?i.call(n._boundValue(),e):i(e);if(void 0!==o){var a=r(o,n);if(a instanceof t)return a=a._target(),u(a,e,!0)}return e}var d=e("./util.js"),f=d.isPrimitive,p=d.thrower;t.prototype._passThroughHandler=t.prototype.lastly=t.prototype.finally=function(e){return this._passThroughHandler(e,!0)},t.prototype.tap=},{"./util.js":26}],14:[function(e,t,n){"use strict";t.exports=function(t,n,r,i){var o=e("./util.js");o.canEvaluate,o.tryCatch,o.errorObj;t.join=function(){var e,t=arguments.length-1;if(t>0&&"function"==typeof arguments[t]){e=arguments[t];var r}for(var i=arguments.length,o=new Array(i),a=0;a<i;++a)o[a]=arguments[a];e&&o.pop();var r=new n(o).promise();return void 0!==e?r.spread(e):r}}},{"./util.js":26}],15:[{"./util.js":26}],16:[{"./async.js":2,"./util.js":26}],17:[function(e,t,n){"use strict";t.exports=function(){r r,i=o=a=s=e("./util.js");r=s.isNode?function(){return null},s.notEnumerableProp(t,"_getDomain",r);var u=e("./async.js"),c=e("./errors.js"),l=t.TypeError=c.TypeError;t.RangeError=c.RangeError,t.CancellationError=c.CancellationError,t.TimeoutError=c.TimeoutError,t.OperationalError=c.OperationalError,t.RejectionError=c.OperationalError,t.AggregateError=c.AggregateError;var d=function(){},f={},p={e:null},h=e("./thenables.js")(t,d),v=e("./promise_array.js")(t,d,h,a),m=e("./captured_trace.js")(),g=e("./debuggability.js")(t,m),y=(e("./context.js")(t,m,g),e("./catch_filter.js")(p)),b=e("./promise_resolver.js"),_=b._nodebackForPromise,w=s.errorObj,x=s.tryCatch;return t.prototype.toString=function(){return"[object Promise]"},t.prototype.caught=t.prototype.catch=function(e){var n=arguments.length;if(n>1){var r,i=new Array(n-1),o=0;for(r=0;r<n-1;++r){var a=arguments[r];if("function"!=typeof a)return t.reject(new l("Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n"));i[o++]=a}i.length=o,e=arguments[r];var s=new y(i,e,this);return this._then(void 0,s.doFilter,void 0,s,void 0)}return this._then(void 0,e,void 0,void 0,void 0)},t.prototype.reflect=t.prototype.then=t.prototype.done=function(e,t,n){var r=this._then(e,t,n,void 0,void 0);r._setIsFinal()},t.prototype.spread=t.prototype.isCancellable=t.prototype.toJSON=t.prototype.all=function(){return new v(this).promise()},t.prototype.error=t.is=t.fromNode=t.all=function(e){return new v(e).promise()},t.defer=t.pending=t.cast=function(e){var n=h(e);if(!(n instanceof t)){var r=n;n=new t(d),n._fulfillUnchecked(r)}return n},t.resolve=t.fulfilled=t.cast,t.reject=t.rejected=t.setScheduler=t.prototype._then=function(e,n,i,o,a){var s=void 0!==a,c=s?a:new t(d);s||(c._propagateFrom(this,5),c._captureStackTrace());var l=this._target();l!==this&&(void 0===o&&(o=this._boundTo),s||c._setIsMigrated());var f=l._addCallbacks(e,n,i,c,o,r());return l._isResolved()&&!l._isSettlePromisesQueued()&&u.invoke(l._settlePromiseAtPostResolution,l,f),c},t.prototype._settlePromiseAtPostResolution=t.prototype._length=t.prototype._isFollowingOrFulfilledOrRejected=function(){return(939524096&this._bitField)>0},t.prototype._isFollowing=function(){return 536870912===(536870912&this._bitField)},t.prototype._setLength=t.prototype._setFulfilled=function(){this._bitField=268435456|this._bitField},t.prototype._setRejected=function(){this._bitField=134217728|this._bitField},t.prototype._setFollowing=function(){this._bitField=536870912|this._bitField},t.prototype._setIsFinal=function(){this._bitField=33554432|this._bitField},t.prototype._isFinal=function(){return(33554432&this._bitField)>0},t.prototype._cancellable=function(){return(67108864&this._bitField)>0},t.prototype._setCancellable=function(){this._bitField=67108864|this._bitField},t.prototype._unsetCancellable=function(){this._bitField=this._bitField&-67108865},t.prototype._setIsMigrated=t.prototype._unsetIsMigrated=t.prototype._isMigrated=function(){return(4194304&this._bitField)>0},t.prototype._receiverAt=function(e){var t=0===e?this._receiver0:this[5*e-5+4];return void 0===t&&this._isBound()?this._boundValue():t},t.prototype._promiseAt=function(e){return 0===e?this._promise0:this[5*e-5+3]},t.prototype._fulfillmentHandlerAt=function(e){return 0===e?this._fulfillmentHandler0:this[5*e-5+0]},t.prototype._rejectionHandlerAt=t.prototype._boundValue=function(){var e=this._boundTo;return void 0!==e&&e instanceof t?e.isFulfilled()?e.value():void 0:e},t.prototype._migrateCallbacks=function(e,n){var r=e._fulfillmentHandlerAt(n),i=e._rejectionHandlerAt(n),o=e._progressHandlerAt(n),a=e._promiseAt(n),s=e._receiverAt(n);a instanceof t&&a._setIsMigrated(),this._addCallbacks(r,i,o,a,s,null)},t.prototype._addCallbacks=function(e,t,n,r,i,o){var a=this._length();if(a>=131066&&(a=0,this._setLength(0)),0===a)this._promise0=r,void 0!==i&&(this._receiver0=i),"function"!=typeof e||this._isCarryingStackTrace()||(this._fulfillmentHandler0=null===o?e:o.bind(e)),"function"==typeof t&&(this._rejectionHandler0=null===o?t:o.bind(t)),"function"==typeof n&&(this._progressHandler0=null===o?n:o.bind(n));else{var s=5*a-5;this[s+3]=r,this[s+4]=i,"function"==typeof e&&(this[s+0]=null===o?e:o.bind(e)),"function"==typeof t&&(this[s+1]=null===o?t:o.bind(t)),"function"==typeof n&&(this[s+2]=null===o?n:o.bind(n))}return this._setLength(a+1),a},t.prototype._setProxyHandlers=t.prototype._proxyPromiseArray=t.prototype._resolveCallback=t.prototype._rejectCallback=function(e,t,n){n||s.markAsOriginatingFromRejection(e);var r=s.ensureErrorObject(e),i=r===e;this._attachExtraTrace(r,!!t&&i),this._reject(e,i?void 0:r)},t.prototype._resolveFromResolver=t.prototype._settlePromiseFromHandler=function(e,t,n,r){if(!r._isRejected()){r._pushContext();var o;if(o=t!==f||this._isRejected()?x(e).call(t,n):x(e).apply(this._boundValue(),n),r._popContext(),o===w||o===r||o===p){var a=o===r?i():o.e;r._rejectCallback(a,!1,!0)}else r._resolveCallback(o)}},t.prototype._target=t.prototype._followee=function(){return this._rejectionHandler0},t.prototype._setFollowee=function(e){this._rejectionHandler0=e},t.prototype._cleanValues=t.prototype._propagateFrom=t.prototype._fulfill=t.prototype._reject=t.prototype._settlePromiseAt=function(e){var n=this._promiseAt(e),r=n instanceof t;if(r&&n._isMigrated())return n._unsetIsMigrated(),u.invoke(this._settlePromiseAt,this,e);var i=this._isFulfilled()?this._fulfillmentHandlerAt(e):this._rejectionHandlerAt(e),o=this._isCarryingStackTrace()?this._getCarriedStackTrace():void 0,a=this._settledValue,s=this._receiverAt(e);this._clearCallbackDataAtIndex(e),"function"==typeof i?r?this._settlePromiseFromHandler(i,s,a,n):i.call(s,a,n):s instanceof v?s._isResolved()||(this._isFulfilled()?s._promiseFulfilled(a,n):s._promiseRejected(a,n)):r&&(this._isFulfilled()?n._fulfill(a):n._reject(a,o)),e>=4&&4===(31&e)&&u.invokeLater(this._setLength,this,0)},t.prototype._clearCallbackDataAtIndex=t.prototype._isSettlePromisesQueued=function(){return(this._bitField&-1073741824)===-1073741824},t.prototype._setSettlePromisesQueued=function(){this._bitField=this._bitField|-1073741824},t.prototype._unsetSettlePromisesQueued=t.prototype._queueSettlePromises=t.prototype._fulfillUnchecked=t.prototype._rejectUncheckedCheckError=t.prototype._rejectUnchecked=function(e,t){if(e===this){var n=i();return this._attachExtraTrace(n),this._rejectUnchecked(n)}return this._setRejected(),this._settledValue=e,this._cleanValues(),this._isFinal()?void u.throwLater(void 0===t?e:t):(void 0!==t&&t!==e&&this._setCarriedStackTrace(t),void(this._length()>0?this._queueSettlePromises():this._ensurePossibleRejectionHandled()))},t.prototype._settlePromises=s.notEnumerableProp(t,"_makeSelfResolutionError",i),e("./progress.js")(t,v),e("./method.js")(t,d,h,a),e("./bind.js")(t,d,h),e("./finally.js")(t,p,h),e("./direct_resolve.js")(t),e("./synchronous_inspection.js")(t),e("./join.js")(t,v,h,d),t.Promise=t,e("./cancel.js")(t),e("./settle.js")(t,v),e("./some.js")(t,v,a),e("./any.js")(t),s.toFastProperties(t),s.toFastProperties(t.prototype),n({a:1}),n({b:2}),n({c:3}),n(1),n(function(){}),n(void 0),n(!1),n(new t(d)),m.setBounds(u.firstLineError,s.lastLineError),t}},{"./any.js":1,"./async.js":2,"./bind.js":3,"./cancel.js":5,"./captured_trace.js":6,"./catch_filter.js":7,"./context.js":8,"./debuggability.js":9,"./direct_resolve.js":10,"./errors.js":11,"./finally.js":13,"./join.js":14,"./method.js":15,"./progress.js":16,"./promise_array.js":18,"./promise_resolver.js":19,"./settle.js":22,"./some.js":23,"./synchronous_inspection.js":24,"./thenables.js":25,"./util.js":26}],18:[function(e,t,n){"use strict";t.exports=function(t,n,r,i){r s=e("./util.js"),u=s.isArray;return a.prototype.length=function(){return this._length},a.prototype.promise=function(){return this._promise},a.prototype._init=function e(n,a){var s=r(this._values,this._promise);if(s instanceof t){if(s=s._target(),this._values=s,!s._isFulfilled())return s._isPending()?void s._then(e,this._reject,void 0,this,a):void this._reject(s._reason());if(s=s._value(),!u(s)){var c=new t.TypeError("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n");return void this.__hardReject__(c)}}else if(!u(s))return void this._promise._reject(i("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n")._reason());if(0===s.length)return void(a===-5?this._resolveEmptyArray():this._resolve(o(a)));var l=this.getActualLength(s.length);this._length=l,this._values=this.shouldCopyValues()?new Array(l):this._values;for(var d=this._promise,f=0;f<l;++f){var p=this._isResolved(),h=r(s[f],d);h instanceof t?(h=h._target(),p?h._ignoreRejections():h._isPending()?h._proxyPromiseArray(this,f):h._isFulfilled()?this._promiseFulfilled(h._value(),f):this._promiseRejected(h._reason(),f)):p||this._promiseFulfilled(h,f)}},a.prototype._isResolved=function(){return null===this._values},a.prototype._resolve=a.prototype.__hardReject__=a.prototype._reject=a.prototype._promiseProgressed=a.prototype._promiseFulfilled=function(e,t){this._values[t]=e;var n=++this._totalResolved;n>=this._length&&this._resolve(this._values)},a.prototype._promiseRejected=a.prototype.shouldCopyValues=a.prototype.getActualLength=a}},{"./util.js":26}],19:[function(e,t,n){"use strict";nction o(e){return function(t,n){if(null!==e){if(t){var r=i(u(t));e._attachExtraTrace(r),e._reject(r)}else if(arguments.length>2){for(var o=arguments.length,a=new Array(o-1),s=1;s<o;++s)a[s-1]=arguments[s];e._fulfill(a)}else e._fulfill(n);e=null}}}var a,s=e("./util.js"),u=s.maybeWrapAsError,c=e("./errors.js"),l=c.TimeoutError,d=c.OperationalError,f=s.haveGetters,p=e("./es5.js"),h=/^(?:name|message|stack|cause)$/;if(a=f?function(e){this.promise=e}:f){var v={get:;p.defineProperty(a.prototype,"asCallback",v),p.defineProperty(a.prototype,"callback",v)}a._nodebackForPromise=o,a.prototype.toString=function(){return"[object PromiseResolver]"},a.prototype.resolve=a.prototype.fulfill=function(e){if(!(this instanceof a))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");this.promise._resolveCallback(e)},a.prototype.reject=function(e){if(!(this instanceof a))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");this.promise._rejectCallback(e)},a.prototype.progress=a.prototype.cancel=function(e){this.promise.cancel(e)},a.prototype.timeout=a.prototype.isResolved=function(){return this.promise.isResolved()},a.prototype.toJSON=t.exports=a},{"./errors.js":11,"./es5.js":12,"./util.js":26}],20:[{}],21:[function(e,t,n){"use strict";var r,i=e("./util"),o=if(i.isNode&&"undefined"==typeof MutationObserver){var a=global.setImmediate,s=process.nextTick;r=i.isRecentNode?function(e){a.call(global,e)}:else"undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&window.navigator.standalone?r="undefined"!=typeof setImmediate?"undefined"!=typeof setTimeout?function(e){setTimeout(e,0)}:o:(r=function(e){var t=document.createElement("div"),n=new MutationObserver(e);return n.observe(t,{attributes:!0}),,r.isStatic=!0);t.exports=r},{"./util":26}],22:[function(e,t,n){"use strict";t.exports=function(t,n){ar i=t.PromiseInspection,o=e("./util.js");o.inherits(r,n),r.prototype._promiseResolved=function(e,t){this._values[e]=t;var n=++this._totalResolved;n>=this._length&&this._resolve(this._values)},r.prototype._promiseFulfilled=function(e,t){var n=new i;n._bitField=268435456,n._settledValue=e,this._promiseResolved(t,n)},r.prototype._promiseRejected=t.settle=t.prototype.settle=},{"./util.js":26}],23:[function(e,t,n){"use strict";t.exports=function(t,n,r){r a=e("./util.js"),s=e("./errors.js").RangeError,u=e("./errors.js").AggregateError,c=a.isArray;a.inherits(i,n),i.prototype._init=i.prototype.init=i.prototype.setUnwrap=i.prototype.howMany=function(){return this._howMany},i.prototype.setHowMany=i.prototype._promiseFulfilled=i.prototype._promiseRejected=i.prototype._fulfilled=function(){return this._totalResolved},i.prototype._rejected=i.prototype._addRejected=function(e){this._values.push(e)},i.prototype._addFulfilled=i.prototype._canPossiblyFulfill=i.prototype._getRangeError=i.prototype._resolveEmptyArray=t.some=function(e,t){return o(e,t)},t.prototype.some=t._SomePromiseArray=i}},{"./errors.js":11,"./util.js":26}],24:[function(e,t,n){"use strict";t.exports=function(e){.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/hc1DLj\n");return this._settledValue},t.prototype.error=t.prototype.reason=t.prototype.isFulfilled=e.prototype._isFulfilled=function(){return(268435456&this._bitField)>0},t.prototype.isRejected=e.prototype._isRejected=function(){return(134217728&this._bitField)>0},t.prototype.isPending=e.prototype._isPending=t.prototype.isResolved=e.prototype._isResolved=e.prototype.isPending=function(){return this._target()._isPending()},e.prototype.isRejected=function(){return this._target()._isRejected()},e.prototype.isFulfilled=function(){return this._target()._isFulfilled()},e.prototype.isResolved=e.prototype._value=function(){return this._settledValue},e.prototype._reason=e.prototype.value=e.prototype.reason=e.PromiseInspection=t}},{}],25:[function(e,t,n){"use strict";t.exports=function(t,n){function r(e,r){if(c(e)){if(e instanceof t)return e;if(o(e)){var l=new t(n);return e._then(l._fulfillUnchecked,l._rejectUncheckedCheckError,l._progressUnchecked,l,null),l}var d=s.tryCatch(i)(e);if(d===u){r&&r._pushContext();var l=t.reject(d.e);return r&&r._popContext(),l}if("function"==typeof d)return a(e,d,r)}return e}nction a(e,r,i){ l=new t(n),d=l;i&&i._pushContext(),l._captureStackTrace(),i&&i._popContext();var f=!0,p=s.tryCatch(r).call(e,o,a,c);return f=!1,l&&p===u&&(l._rejectCallback(p.e,!0,!0),l=null),d}var s=e("./util.js"),u=s.errorObj,c=s.isObject,l={}.hasOwnProperty;return r}},{"./util.js":26}],26:[function(e,t,n){"use strict";,C="undefined"==typeof navigator,E=),T={e:{}},S,k=A=),R=/this\s*\.\s*\S+\s*=/,j=/^[a-z$_][a-z$_0-9]*$/i,O=),N={isClass:f,isIdentifier:h,inheritedDataKeys:A,getDataPropertyOrDefault:c,thrower:d,isArray:x.isArray,haveGetters:E,notEnumerableProp:l,isPrimitive:o,isObject:a,canEvaluate:C,errorObj:T,tryCatch:i,inherits:k,withAppended:u,maybeWrapAsError:s,toFastProperties:p,filledRange:v,toString:m,canAttachTrace:b,ensureErrorObject:O,originatesFromRejection:y,markAsOriginatingFromRejection:g,classString:_,copyDescriptors:w,hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:"undefined"!=typeof process&&"[object process]"===_(process).toLowerCase()};N.isRecentNode=N.isNode&&),N.isNode&&N.toFastProperties(process);try{throw new Error}catch(e){N.lastLineError=e}t.exports=N},{"./es5.js":12}]},{},[4])(4)}),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise),function(e){var t={};if(t.EventTarget=function(){"use strict";eturn e.prototype={constructor:e,on:function(e,t){var n,r,i=this._handlers[e];for("undefined"==typeof i&&(i=this._handlers[e]=[]),n=0,r=i.length;n<r;n++)if(i[n]===t)return;i.push(t)},fire:function(e,t){var n,r,i,o={type:e,data:t};if(n=this._handlers[o.type],n instanceof Array)for(n=n.concat(),r=0,i=n.length;r<i;r++)n[r].call(this,o)},off:function(e,t){var n,r,i=this._handlers[e];if(i instanceof Array)for(n=0,r=i.length;n<r;n++)if(i[n]===t){i.splice(n,1);break}}},e}(),t.JQueryDOM=function(){"use strict";return{type:"jquery",query:function(e,t){return jQuery(e).find(t)[0]||null},queryAll:function(e,t){return jQuery.makeArray(jQuery(e).find(t))},on:function(e,t,n){jQuery(e).on(t,n)},off:}(),t.DOM=t.JQueryDOM,t.DOMEventDelegate=function(){"use strict";function e(e){return e&&e.hasAttribute("data-module")}unction r(t){for(var r=!1,i=!1;!r&&t&&t.parentNode&&!i;)r=n(t),i=e(t),r||(t=t.parentNode);return r?t:null}function i(e,t,n,r){var i,o;for(i=0;i<e.length;i++)o=e[i],t["on"+o]&&n.call(r,o)}function o(e,t,n){this.element=e,this._handler=t,this._eventTypes=n||a,this._boundHandler={},this._attached=!1}var a=["click","mouseover","mouseout","mousedown","mouseup","mouseenter","mouseleave","mousemove","keydown","keyup","submit","change","contextmenu","dblclick","input","focusin","focusout"];return o.prototype={constructor:o,_handleEvent:function(e){var t=r(e.target),n=t?t.getAttribute("data-type"):"";this._handler["on"+e.type](e,t,n)},attachEvents:function(){this._attached||(i(this._eventTypes,this._handler,function(e){ar r=this;t.DOM.on(this.element,e,n),this._boundHandler[e]=n},this),this._attached=!0)},detachEvents:function(){i(this._eventTypes,this._handler,function(e){t.DOM.off(this.element,e,this._boundHandler[e])},this)}},o}(),t.Context=function(){"use strict";eturn e.prototype={broadcast:getService:function(e){return this.application.getService(e)},hasService:function(e){return this.application.hasService(e)},getConfig:getGlobal:function(e){return this.application.getGlobal(e)},getGlobalConfig:reportError:getElement:function(){return this.element}},e}(),t.Application=function(){"use strict";nction i(){y={},b={},w={},_=[],x={},C={},E=!1}function o(e){for(var t=0,n=_.length;t<n;t++)if(_[t]===e)return!0;return!1}function a(e){if(y.debug)throw e;T.fire("error",{exception:e})}function s(e,t){var n,r;for(n in e)r=e[n],"function"==typeof r&&(e[n]=function(e,n){return function(){var r=t+"."+e+"() - ";try{return n.apply(this,arguments)}catch(n){n.methodName=e,n.objectName=t,n.name=r+n.name,n.message=r+n.message,a(n)}}}(n,r))}unction c(e,t){"function"==typeof e[t]&&e[t].apply(e,Array.prototype.slice.call(arguments,2))}function l(e){var t=w[e];if(t){if(!t.instance){if(o(e))return a(new ReferenceError("Circular service dependency: "+_.join(" -> ")+" -> "+e)),null;_.push(e),t.instance=t.creator(T),_.pop()}return t.instance}return a(new Error('Service "'+e+'" not found')),null}function d(e){var t,n,r,i,o,s=[],u={};for(n=e.instance.behaviors||[],t=0;t<n.length;t++)o=n[t],"behaviorInstances"in e||(e.behaviorInstances={}),i=e.behaviorInstances,r=x[o],o in u?a(new Error('Behavior "'+o+'" cannot be specified twice in a module.')):r?(i[o]||(i[o]=r.creator(e.context)),s.push(i[o])):a(new Error('Behavior "'+o+'" not found')),u[o]=!0;return s}function f(e,n,r){var i=new t.DOMEventDelegate(n,r,y.eventTypes);e.push(i),i.attachEvents()}function p(e){var t=e.eventDelegates,n=d(e);f(t,e.element,e.instance);for(var r=0;r<n.length;r++)f(t,e.element,n[r])}function h(e){for(var t=e.eventDelegates,n=0;n<t.length;n++)t[n].detachEvents();e.eventDelegates=[]}unction m(e,t,n){null!==e.onmessage&&"object"==typeof e.onmessage&&e.onmessage.hasOwnProperty(t)?e.onmessage[t].call(e,n):r(e.messages||[],t)!==-1&&e.onmessage.call(e,t,n)}var g="[data-module]",y={},b={},_=[],w={},x={},C={},E=!1,T=new t.EventTarget;return n(T,{init:function(e){return n(y,e||{}),this.startAll(document.documentElement),this.fire("init"),E=!0,this},destroy:function(){return this.stopAll(document.documentElement),i(),this},isStarted:function(e){var t=v(e);return"object"==typeof t},start:function(e){var n,r,i,o=u(e),l=b[o];if(!l)return a(new Error('Module type "'+o+'" is not defined.')),this;if(!this.isStarted(e)){e.id||(e.id="mod-"+o+"-"+l.counter),l.counter++,r=new t.Context(this,e),i=l.creator(r),y.debug||s(i,o),n={moduleName:o,instance:i,context:r,element:e,eventDelegates:[]},C[e.id]=n;for(var f,h=d(n),v=0,m=h.length;v<m;v++)f=h[v],c(f,"init");c(n.instance,"init"),p(n)}return this},stop:function(e){var t=v(e);if(t){h(t);for(var n,r=d(t),i=r.length-1;i>=0;i--)n=r[i],c(n,"destroy");c(t.instance,"destroy"),delete C[e.id]}else if(y.debug)return a(new Error("Unable to stop module associated with element: "+e.id)),this;return this},startAll:function(e){for(var n=t.DOM.queryAll(e,g),r=0,i=n.length;r<i;r++)this.start(n[r]);return this},stopAll:function(e){for(var n=t.DOM.queryAll(e,g),r=0,i=n.length;r<i;r++)this.stop(n[r]);return this},addModule:function(e,t){return"undefined"!=typeof b[e]?(a(new Error("Module "+e+" has already been added.")),this):(b[e]={creator:t,counter:1},this)},getModuleConfig:function(e,n){var r=v(e),i=null;if(r&&r.config)i=r.config;else{var o=t.DOM.query(e,'script[type="text/x-config"]');if(o)try{i=JSON.parse(o.text)}catch(t){a(new Error("Module with id "+e.id+" has a malformed config."))}r&&(r.config=i)}return i?"undefined"==typeof n?i:n in i?i[n]:null:null},addService:function(e,t){return"undefined"!=typeof w[e]?(a(new Error("Service "+e+" has already been added.")),this):(w[e]={creator:t,instance:null},this)},getService:l,hasService:addBehavior:function(e,t){return"undefined"!=typeof x[e]?(a(new Error("Behavior "+e+" has already been added.")),this):(x[e]={creator:t,instance:null},this)},broadcast:function(e,t){var n,r,i,o,a;for(r in C)if(C.hasOwnProperty(r))for(i=C[r],m(i.instance,e,t),a=d(i),n=0;n<a.length;n++)o=a[n],m(o,e,t);return this.fire("message",{message:e,messageData:t}),this},getGlobal:getGlobalConfig:function(e){return"undefined"==typeof e?y:e in y?y[e]:null},setGlobalConfig:function(e){return E?(a(new Error("Cannot set global configuration after application initialization")),this):(n(y,e),this)},reportError:a,reportWarning:function(e){if(y.debug){var t=this.getGlobal("console");t&&t.warn&&t.warn(e)}else T.fire("warning",e)}})}(),"function"==typeof define&&define.amd)define("t3",[],function(){return t});else if("object"==typeof module&&"object"==typeof module.exports)module.exports=t;else{e.Box=e.Box||{};for(var n in t)t.hasOwnProperty(n)&&(e.Box[n]=t[n])}}("undefined"!=typeof window?window:this);var $t=function(){"use strict";function e(e,t){var n,r=t.length,i=/%\d+/g;return e&&r?n=e.replace(i,function(e){var n=e.substr(1)-1;return t[n]||e}):e}function t(){var e,t=!1;return window.Box=window.Box||{},e=window.initialConfig||Box.config,e&&(t=e.emitTranslationTags),t}return function(n,r){var i=[].slice.call(arguments,2);if(t())return r;if("undefined"!=typeof PseudoLocalization&&null!==PseudoLocalization&&PseudoLocalization.isEnabledFromCookie()){var o=PseudoLocalization.translate(n);return e(o,i)}return"undefined"!=typeof LANGUAGE&&TRANSLATIONS&&Object.prototype.hasOwnProperty.call(TRANSLATIONS,r)?e(TRANSLATIONS[r],i):e(n,i)}}();window.moment=function(e){"use strict";return{format:function(){var t=Box.Application.getGlobalConfig("locale")||"en-US";return"en-US"===t?e.toDateString():e.toLocaleDateString(t)},toDate:isValid:add:function(t,n){if("days"!==n)throw new TypeError;var r=24*parseInt(t,10)*60*60*1e3;return{toDate:function(){return new Date(this.toDate(e).getTime()+r)}.bind(this)}},subtract:function(t,n){if("days"!==n)throw new TypeError;var r=24*parseInt(t,10)*60*60*1e3;return{toDate:function(){return new Date(this.toDate(e).getTime()-r)}.bind(this)}}}},window.Resin=window.Resin||{},Resin=function(){"use strict";function e(e,t){x.call(this,{type:e,data:t})}function t(e,t){for(var n in t)t.hasOwnProperty(n)&&!e[n]&&(e[n]=t[n]);return e}function n(){var e=Date.now();return"xxxxxxxxxxxxxxxxxxxxxx".replace(/x/g,function(){var t=Math.floor((e+16*Math.random())%16);return t.toString(16)})}function r(e){for(var t,n=0,r=C.length;e&&!e.disabled&&!(T<n);){for(t=0;t<r;t++)if(e.nodeName===C[t])return e;e=e.parentElement,n++}return null}function i(e,r){var i=Date.now()-_,o=r?b:y;return t(e,{path:window.location.pathname,session:w,id:n(),isWaypoint:r,elapsedTime:i,prevId:o?o.id:null,prevAction:o?o.action:null,prevTarget:o?o.target:null,prevComponent:o?o.component:null,prevFeature:o?o.feature:null})}function o(e){return y&&e.component===y.component&&e.target===y.target&&e.elapsedTime<500}function a(e,t){var n=t.target;return"keypress"!==e||t.which!==S&&t.which!==k?!("change"!==e||!n.options||"undefined"==typeof n.selectedIndex)||("change"===e&&"boolean"==typeof n.checked||"change"!==e&&"keypress"!==e):"TEXTAREA"!==n.nodeName&&(t.which!==k||"INPUT"!==n.nodeName)}function s(e){return e.split("-").slice(2).join("-").replace(/-([a-z0-9])/g,function(e){return e[1].toUpperCase()})}unction c(e){return e.sort(function(e,t){var n=R.indexOf(e.name),r=R.indexOf(t.name);return n-r}),e}function l(e){for(var t=e.attributes,n=t.length,r=[],i=0;i<n;i++){var o=t[i];u(o)&&r.push(o)}return c(r)}function d(e){for(var t,n=e,r={target:null,feature:null,component:null,page:null,application:null,client:null,isWaypoint:!1,data:{}},i=-1;n&&null===r.client;){t=l(n);for(var o=0;o<t.length;o++){var a=t[o],u=s(a.name),c=R.indexOf(a.name);c-1===i?(i++,r[u]=a.value):c>=0||("data-resin-waypoint"===a.name?r.isWaypoint="true"===a.value:"data-resin-feature"===a.name?r.feature=a.value:r.data[u]||(r.data[u]=a.value))}n=n.parentElement}return r}function f(e){return!!e.target&&(e.feature&&!e.feature.match(A)?(console.warn("Resin: Feature must be an alphanum"),!1):e.component?e.component.match(A)?e.page?e.page.match(A)?e.application?e.application.match(A)?e.client?!!e.client.match(A)||(console.warn("Resin: Client must be an alphanum"),!1):(console.warn("Resin: Client not found"),!1):(console.warn("Resin: Application must be an alphanum"),!1):(console.warn("Resin: Application not found"),
!1):(console.warn("Resin: Page must be an alphanum"),!1):(console.warn("Resin: Page not found"),!1):(console.warn("Resin: Component must be an alphanum"),!1):(console.warn("Resin: Component not found"),!1))}function p(n){return function(s){var u,c,l,p,h,v,m=s.target;if(a(n,s)&&(u="change"===n&&m.options?m.options[m.selectedIndex]:r(m))){if(l=d(u),!l||!f(l))return;if(l.action=n,p=l.isWaypoint,v=t({},l),l.isWaypoint=!1,c=i(l,!1),o(c)||c.elapsedTime<200)return;p&&(h=i(v,!0),b=h,e("useraction",h)),e("useraction",c),y=c,_=Date.now()}}}unction v(){if(h()){var e=sessionStorage.getItem("resin-last-action-time");w=sessionStorage.getItem("resin-session-id"),(!w||!e||Date.now()-e>18e5)&&(w=n(),sessionStorage.setItem("resin-session-id",w),sessionStorage.setItem("resin-last-action-time",_))}}function m(e){var t;for(var n in e)e.hasOwnProperty(n)&&(t=p(n),document.addEventListener(e[n],t),N[n]=t)}function g(){for(var e in N)N.hasOwnProperty(e)&&document.removeEventListener(e,N[e])}var y,b,_,w,x,C=["A","BUTTON","OPTION","INPUT","SELECT","TEXTAREA"],E="keypress|click|change|drop|programmatic|doubleclick|rightclick|hover",T=3,S=13,k=32,A=/^[a-zA-Z0-9|]+$/i,R=["data-resin-target","data-resin-component","data-resin-page","data-resin-application","data-resin-client"],j={click:"click",keypress:"keypress",change:"change"},O=!1,N={};return{start:function(e,n){var r=n&&n.events?t(n.events,j):j;if(O)throw new Error("Resin is already started");_=Date.now(),v(),m(r),x=e,O=!0},stop:function(){y=null,_=null,w=null,x=null,O=!1,g()},recordAction:function(t){var n,r=E.indexOf(t.action)!==-1;O&&r?(n=i(t),e("useraction",n),y=n,_=Date.now()):console.warn("Action "+t.action+" is not whitelisted")},getActionAttributes:d}}(),Box.Application.addBehavior("passwordometer",function(e){"use strict";function t(e,t){if(!t)return m;var n=parseInt(c.getAttribute("data-min-length"),10)||6,r=parseInt(c.getAttribute("data-num-digits"),10)||0,i=parseInt(c.getAttribute("data-num-symbols"),10)||0,o="1"===c.getAttribute("data-mixed-case"),a=!!/[a-z]/.exec(t),s=!!/[A-Z]/.exec(t),u=a&&s,l=!!/[0-9]/.exec(t),d=!!/\W/.exec(t),f=t.replace(/\D/g,"").length,p=t.replace(/\w/g,"").length;if(t.length<6)return g;if(e&&e.length>1){var h=t.indexOf(e);if(0===h||h!==-1&&t.length-e.length<e.length/2)return g}return t.length<n||p<i||o&&!u||f<r?g:t.length>25||u&&l&&d?_:t.length>15||u&&(l||d)?b:t.length>15||(u||l)&&d?b:t.length>15||(u||d)&&l?b:y}function n(){if(p){var e=u.query("ul",p);if(e){h=!1;var t=parseInt(c.getAttribute("data-min-length"),10);if(!isNaN(t)&&0!==t){var n=document.createElement("li"),r=$t("At least %1 characters","required_password_length",t);u.setText(n,r),e.appendChild(n),h=!0}var i=parseInt(c.getAttribute("data-num-digits"),10);if(!isNaN(i)&&0!==i){var o=document.createElement("li"),a=$t("At least %1 digits","required_password_digits",i);u.setText(o,a),e.appendChild(o),h=!0}var s=parseInt(c.getAttribute("data-num-symbols"),10);if(!isNaN(s)&&0!==s){var l=document.createElement("li"),d=$t("At least %1 symbols","required_password_symbols",s);u.setText(l,d),e.appendChild(l),h=!0}var f=c.getAttribute("data-mixed-case");if(null!==f&&"1"===f){var v=document.createElement("li"),m=$t("Mixed case characters","required_password_mixed_case");u.setText(v,m),e.appendChild(v),h=!0}}}}function r(){var e=u.query(".passwordometer-wrapper");e&&(p=u.query(".password-requirements",e))}function i(){null!==p&&u.addClass(p,v)}function o(){null!==p&&u.removeClass(p,v)}r u,c,l,d,f,p,h,v="is-active",m=0,g=1,y=2,b=3,_=4;return{init:function(){c=e.getElement(),l=c.getAttribute("data-user-email"),l&&(d=l.substr(0,l.indexOf("@"))),u=e.getService("dom"),r(),n()},onfocusin:function(e){var t=e.target;t&&"password"===t.getAttribute("type")&&a()},onfocusout:function(e){var t=e.target;t&&"password"===t.getAttribute("type")&&s()},oninput:function(n){var r=n.target;if(r)if("email"===r.getAttribute("type"))c.setAttribute("data-user-email",r.value);else if("password"===r.getAttribute("type")){var i=u.getNearest(r,".passwordometer-wrapper");if(!i)return;l=c.getAttribute("data-user-email"),l&&(d=l.substr(0,l.indexOf("@")));var o=t(d,r.value);o!==f&&(i.className=i.className.replace(/\s*password-strength-\d/,"")+" password-strength-"+o,e.broadcast("passwordstrengthchanged",o),f=o)}}}}),Box.Application.addBehavior("tooltips-amsterdam",function(e){"use strict";ar n;return{messages:["contentrefreshed","formvalidatorerrorcleared","navigationstart"],onmessage:function(e,r){switch(e){case"formvalidatorerrorcleared":n.hide(r);break;case"contentrefreshed":case"navigationstart":n.hideAll();break;default:t()}},init:onfocusin:function(e,t,r){n&&n.handleEvent(e,t,r)},onfocusout:function(e,t,r){n&&n.handleEvent(e,t,r)},onmouseover:function(e,t,r){n&&n.handleEvent(e,t,r)},onmouseout:function(e,t,r){n&&n.handleEvent(e,t,r)},onclick:}),Box.Application.addBehavior("login-instrumentation",function(e){"use strict";var t,n,r,i="login",o="twostage",a="login",s="password",u="EMAIL_AUTOFILLED_",c="PASSWORD_AUTOFILLED_",l=200;return{init:function(){t=e.getService("dom"),n=e.getService("logger"),r=t.query("#login-form"),this.isTwoStageLogin()?this.logTwoStageLoginAutofillStatus():this.logOneStageLoginAutofillStatus()},logOneStageLoginAutofillStatus:function(){setTimeout(bind(this),l)},logTwoStageLoginAutofillStatus:function(){setTimeout(function(){var e=t.query(".form-field input",r).name;e===a?this.logEmailAutofill(this.isLoginFilledIn(),o):e===s&&this.logPasswordAutofill(this.isPasswordFilledIn(),o)}.bind(this),l)},logEmailAutofill:function(e,t){var r=[u,e?"YES":"NO"].join("");n.sendLog(i,r,{pageType:t})},logPasswordAutofill:function(e,t){var r=[c,e?"YES":"NO"].join("");n.sendLog(i,r,{pageType:t})},isTwoStageLogin:function(){return 1===t.queryAll(".form-field",r).length},isLoginFilledIn:function(){var e=t.query("input[name=login]",r);return e&&e.value.length>0},isPasswordFilledIn:function(){var e=t.query("input[name=password]",r);return e&&e.value.length>0}}}),Box.Application.addBehavior("menu-toggle",function(e){"use strict";function t(e){var t=e.target||e.srcElement;if(!t)return null;if(t.getAttribute("data-type")===i)return t;for(;;){if(t=t.parentNode,!t||t===document.body||!t.getAttribute)return null;if(t.getAttribute("data-type")===i)return t}}var n,r,i="menu-toggle-button",o="is-visible",a={init:function(){var t=e.getService("menu-toggle");n=e.getService("dom"),r=t.create(),r.init(),n.on(document.body,"keyup",this.keyupHandler)},destroy:function(){n.off(document.body,"keyup",this.keyupHandler),r.destroy()},keyupHandler:onclick:function(e,t,r){r===i?(this.showMenu(t),e.preventDefault(),e.stopPropagation()):!n.getNearest(e.target,".menu-option")||null!==t&&t.disabled||this.closeMenu()},onkeyup:function(e){if(32===e.keyCode){var r=t(e);if(r)return a.showMenu(r),void e.preventDefault();var i=(e.target||e.srcElement).parentNode;do{if("MENU"===i.nodeName){e.stopPropagation();var s=n.getNearest(i,".menu-wrapper");return n.removeClass(s,o),void setTimeout(a.closeMenu,100)}i=i.parentNode}while(i&&i!==document.body)}},showMenu:closeMenu:;return a}),Box.Application.addModule("embed-widget-login",function(e){"use strict";var t,n,r="/login?popup=true";return{init:onclick:redirectToApp:function(){var n=e.getConfig("redirectURL");n?t.redirect(n):t.reload()},showLoginPopup:function(){var t=e.getService("window-popup"),i="https://"+n.location.hostname+r,o=t.create(i,{height:450,width:500});o.setCloseCallback(this.redirectToApp),o.show()}}}),Box.Application.addModule("login-form",function(e){"use strict";var t,n,r,i=250,o=e.getService("dom");return{init:function(){r=e.getElement().querySelector(".login-preview"),n=e.getElement().querySelector("[name=login]"),t=n.value,setInterval(bind(this),i)},isLoginFieldSynced:syncLoginField:function(){t=n.value,o.setText(r,$t("Signing in as %1.","login_username_display",t))},getInterval:function(){return i}}}),Box.Application.addModule("login-header",function(e){"use strict";return{behaviors:["login-instrumentation","menu-toggle"],init:}),Box.Application.addModule("login-popup-close",function(){"use strict";return{onclick:}),Box.Application.addModule("password-create",function(e){"use strict";unction n(){i=e.getElement(),o=r.query('input[name="new_password"]',i),a=r.query('input[name="confirm_password"]',i),s=r.query(".server-error",i),u=r.query(".form-error.password-mismatch",i)}var r,i,o,a,s,u;return{behaviors:["passwordometer"],init:onsubmit:validatePasswordMismatch:function(){return o.value===a.value||(r.addClass(s,"hidden"),r.removeClass(u,"hidden"),!1)}}}),Box.Application.addModule("password-reset",function(){"use strict";return{behaviors:["passwordometer"]}}),Box.Application.addModule("device-trust-checker",function(e){"use strict";function t(t){for(var n,r=i.queryAll(".dtsection",e.getElement()),o=0;o<r.length;o++)n=r[o],n===t?i.removeClass(n,"hidden"):i.addClass(n,"hidden");var a=i.query(".device-trust-login.message");i.removeClass(a,"hidden")}function n(){return y=e.getConfig(),Array.isArray(y)||(y=[y]),y[0].group_based_device_trust}function r(){p?(_=e.getService("com-server-client"),T=_.constants,_.isInitialized()||_.initialize(W)):_=e.getService("com-server").create(W)}var i,o,a,s,u,c,l,d,f,p,h,v,m,g,y,b,_,w,x,C,E,T,S,k,A,R,j="device-trust-checker",O=2e3,N=5e3,D=5e3,P=9e3,I=5e3,F=3,L=7,M=5,q=4,B=6,H=0,U="iPhone",$="iPad",G="windows",V="mac",W="PostureCheck";return n()?{init:function(){i=e.getService("dom"),o=e.getService("ajax"),a=i.query(".view-stack"),s=i.query(".check-error-section",a),u=i.query(".check-failed-section",a),c=i.query(".install-instructions-section",a),l=i.query(".install-instructions-safari-section",a),d=i.query(".install-instructions-section-deprecated",a),f=i.query(".ios-browser-unsupported-section",a),m=i.query(".upgrade-browser-section",a),g=i.query(".unsupported-os-section",a),h=i.query(".download-admin",d),v=i.query(".download-user",d),p=e.getGlobalConfig("isDeviceTrustV4Enabled"),A=e.getService("console-logger").formattedLog.bind(null,j),A("init"),E=!1,S=!1,k=!1,y=e.getConfig(),R={dtIteration:"deviceTrustIteration",dtPolicies:"deviceTrustIteration_"},b=[],Array.isArray(y)||(y=[y]);for(var t=0;t<y.length;t++){var n=JSON.stringify(y[t].device_trust_requirements);b.push(n)}var r=y[0].client_environment;x=y[0].redirect_url,A("environment, ",{clientEnvironment:r,isDeviceTrustV4Enabled:p}),C=y[0].enable_dt_in_external_browser_login;var _={android:this.performChecksInAndroid,ios:this.performChecksInIOS,sync:this.performChecksInSync,webapp:this.performChecksInWeb};w=_[r].bind(this),void 0!==w&&w()},updateCheckStatuses:function(e){for(var t,n,r,o,a=0;a<e.length;a++)if(!y[a].in_test_mode&&(t=e[a],!t.pass)){n=t.checks,this.updateFailedCheckTitles(t,a);for(var s=0;s<n.length;s++)r=n[s],o=this.getFailureMessageElement(r,a),r.pass?i.addClass(o,"hidden"):i.removeClass(o,"hidden")}},isErrorUnknownPostureCheck:function(e){return e&&e.hasOwnProperty("error")&&e.error.toLocaleUpperCase().indexOf("UNKNOWN POSTURE CHECK TYPE")>-1},getFailureMessageElement:function(e,t){var n;return n="securityCenter"===e.type?"."+e.provider:"android"===y[t].client_environment&&"notJailbroken"===e.type?".notRooted":this.isErrorUnknownPostureCheck(e)?".unknownPostureCheck":"."+e.type,i.query(n)},updateFailedCheckTitles:function(e,t){var n=i.query(".singleListTitle"),r=i.query(".groupedListsTitle"),o=i.query(".ownershipRequirementsTitle"),a=i.query(".securityRequirementsTitle");y[t].have_grouped_requirements?(i.addClass(n,"hidden"),i.removeClass(r,"hidden"),e.failedOwnershipRequirements&&i.removeClass(o,"hidden"),e.failedSecurityRequirements&&i.removeClass(a,"hidden")):(i.removeClass(n,"hidden"),i.addClass(r,"hidden"),i.addClass(o,"hidden"),i.addClass(a,"hidden"))},checkResults:function(e){for(var t,n,r=0,i=0;i<e.length;i++){if(n=y[i].client_environment,t=e[i],t.env=n,"webapp"===n||"sync"===n){var o=this.checkOwnershipResults(t,i),a=this.checkSecurityResults(t);y[i].have_grouped_requirements?t.pass=o&&a:t.pass=o||a}t.pass||r++}return 0===r&&e.length>0},checkOwnershipResults:function(e,t){for(var n,r=e.checks,i=!0,o=!0,a=!0,s=0;s<r.length;s++)n=r[s],"certificatePresent"!==n.type&&"perDeviceCertificatePresent"!==n.type||(i=n.pass),"joinedToDomain"===n.type&&(o=n.pass),this.isErrorUnknownPostureCheck(n)&&(e.agent_present="OUT_OF_DATE");var u=y[t].have_domain_cert_check;return"domainAndCertCheck"===u?a=i&&o:"domainOrCertCheck"===u?a=i||o:"domainCheckOnly"===u?a=o:"certCheckOnly"===u&&(a=i),a||(e.failedOwnershipRequirements=!0),a},checkSecurityResults:function(e){for(var t,n=e.checks,r=0;r<n.length;r++)if(t=n[r],"certificatePresent"!==t.type&&"joinedToDomain"!==t.type&&"perDeviceCertificatePresent"!==t.type&&(this.isErrorUnknownPostureCheck(t)&&(e.agent_present="OUT_OF_DATE"),!t.pass))return e.failedSecurityRequirements=!0,!1;return!0},getCurrentDeviceTrustIteration:function(){var e=JSON.parse(sessionStorage.getItem(R.dtIteration));return e?Number(e):0},formatSessionStoragePolicyString:handleDtRedirectForDriveAndMobile:function(t,n){sessionStorage.setItem(this.formatSessionStoragePolicyString(t),JSON.stringify(n[0])),sessionStorage.setItem(R.dtIteration,JSON.stringify(++t)),e.getGlobal("window").location.replace(location.href)},fetchAllResults:function(e){var t=this.getCurrentDeviceTrustIteration(),n=e.pop();if(t)for(var r=0;r<t;r++){var i=this.formatSessionStoragePolicyString(r),o=JSON.parse(sessionStorage.getItem(i));e.push(o),sessionStorage.removeItem(i)}return e.push(n),e},cleanUpSessionStorage:handleDriveAndMobileResults:function(e,t){var n=e+1>=b.length;return n?this.fetchAllResults(t):(this.handleDtRedirectForDriveAndMobile(e,t),!1)},allRequirementsInTestMode:function(){for(var e=0;e<y.length;e++)if(!y[e].in_test_mode)return!1;return!0},allRequirementsInTestModeOrPass:function(e){for(var t=0;t<y.length;t++)if(!y[t].in_test_mode&&!e[t].pass)return!1;return!0},handleCheckResults:function(n,r,i){if(r="undefined"!=typeof r&&r,i="undefined"!=typeof i?i:0,!r||(n=this.handleDriveAndMobileResults(i,n))){var a=A.bind(null,"handleCheckResults");if(a({results:n}),this.updateResultsWithMetadata(n),!this.checkResults(n)){if(this.allRequirementsInTestModeOrPass(n))return void this.handleTestMode(n);if(t(u),this.updateCheckStatuses(n),this.cleanUpSessionStorage(),!E){for(var c=0;c<n.length;c++)n[c].pass||this.deviceTrustCheckFailedRunmode(n[c],!1,"handleCheckResults");E=!0}return setTimeout(w,O),void a("Failed")}this.cleanUpSessionStorage(),o.post("pass_device_trust_check",n[0],{success:function(){a("Checks Passed -",{redirectUrl:x}),e.getGlobal("window").location.replace(x)},error:function(){a("Error"),t(s)},application:this})}},updateResultsWithMetadata:function(e){for(var t=0;t<e.length;t++)y[t].in_test_mode&&(e[t].testMode=!0),e[t].agent_present="YES",e[t].platform=y[t].platform,e[t].env=y[t].client_environment,e[t].device_trust_name=y[t].device_trust_name,e[t].device_trust_id=y[t].device_trust_id},deviceTrustCheckFailedRunmode:function(n,r,i){var a=A.bind(null,"handleCheckResults");String.prototype.format||(String.prototype.format=,r?o.post("device_trust_check_failed",n,{success:function(){a("{0}: Checks failed, but test mode enabled".format(i),{redirectUrl:x}),e.getGlobal("window").location.replace(x)},error:function(){a("{0}: Error".format(i)),t(s)},application:this}):o.post("device_trust_check_failed",n,{success:function(){a("{0}: Checks failed. Logged successfully the failed event".format(i))},error:application:this}),E=!0},handleTestMode:function(e){if(!Array.isArray(e))return void(e?e.hasOwnProperty("error")&&this.deviceTrustCheckFailedRunmode(e,!0,"handleTestMode"):this.emptyResultsTestMode(e));if(!E)for(var t=0;t<e.length;t++)e[t].testMode&&!e[t].pass&&this.deviceTrustCheckFailedRunmode(e[t],!0,"handleTestMode")},emptyResultsTestMode:function(e){e={agent_present:"YES",platform:y[0].platform,env:y[0].client_environment,testMode:!0},this.deviceTrustCheckFailedRunmode(e,!0,"emptyResultsTestMode")},performChecksInSync:function(){var n=A.bind(null,"performChecksInSync");n("Enter");var r=e.getGlobal("window"),o=e.getGlobal("window").external,a=o&&("function"==typeof o.CheckDeviceTrust||"unknown"==typeof o.CheckDeviceTrust),u=r.webkit&&r.webkit.messageHandlers&&r.webkit.messageHandlers.checkDeviceTrust;if(a){for(var c,l,d=[],f=0;f<b.length;f++)c=b[f],l=o.CheckDeviceTrust(c),d.push(JSON.parse(l));n({results:d}),this.handleCheckResults(d,!1,0)}else if(u){if(r.deviceTrust)return;var p=!1,h=this.getCurrentDeviceTrustIteration();r.deviceTrust={requirements:b[h],receiveResults:function(e){p=!0,this.handleCheckResults([JSON.parse(e)],!0,h)}.bind(this)},i.on(document,"load",function(){setTimeout(function(){p||t(s)},I)})}else C?this.performChecksInWeb():t(s)},performChecksInAndroid:function(){var n=e.getGlobal("window");if(!n.deviceTrust&&!this.checkAndroidAppVersion()){var r=!1,o=this.getCurrentDeviceTrustIteration();n.deviceTrust={requirements:b[o],receiveResults:function(e){r=!0,this.handleCheckResults([JSON.parse(e)],!0,o)}.bind(this)},i.on(document,"load",function(){setTimeout(function(){r||t(s)},D)})}},showAndroidAppTooOldError:function(){t(u);var e={pass:!1,checks:[{type:"androidAppVersion",pass:!1}]};this.updateCheckStatuses(e)},checkAndroidAppVersion:function(){var e=navigator.userAgent,n=/(?:(?:forgepond.com.box.emm.androids)|(?:com.box.emm.android)|(?:com.box.android))\/(\d+)\.(\d+)\.(\d+)/,r=n.exec(e);if(!r||4!==r.length)return t(s),!0;var i=parseInt(r[1],10),o=parseInt(r[2],10),a=parseInt(r[3],10);if(i>q)return!1;if(i===q){if(o>B)return!1;if(o===B&&a>=H)return!1}return this.showAndroidAppTooOldError(),!0},checkComServerStatus:function(){var t=A.bind(null,"checkComServerStatus");if(t("Enter"),!p&&e.getGlobalConfig("isDeviceTrustFallbackEnabled")){var n="ComServerNotAvailable";return t({errorCode:n}),Promise.reject(n)}return _.getComServerStatus()},performChecksInIOS:function(){var n=e.getGlobal("window");if(!n.deviceTrust&&!this.checkIOSAppVersion()){var r=!1,o=this.getCurrentDeviceTrustIteration();n.deviceTrust={requirements:b[o],receiveResults:function(e){r=!0,this.handleCheckResults([JSON.parse(e)],!0,o)}.bind(this)},i.on(document,"load",function(){setTimeout(function(){r||t(s)},N)})}},showIOSAppTooOldError:function(){t(u);var e={pass:!1,checks:[{type:"iosAppVersion",pass:!1}]};this.updateCheckStatuses(e)},checkIOSAppVersion:function(){var e=navigator.userAgent,n=/(?:(?:net.box.BoxNet)|(?:com.box.ios.dev)|(?:com.box.mdmios)|(?:com.box.ios.devemm))\/(\d+)\.(\d+)\.(\d+)/,r=n.exec(e);if(!r||4!==r.length)return t(s),!0;var i=parseInt(r[1],10),o=parseInt(r[2],10),a=parseInt(r[3],10);if(i>F)return!1;if(i===F){if(o>L)return!1;if(o===L&&a>=M)return!1}return this.showIOSAppTooOldError(),!0},performChecksInWeb:function(){r();var e=A.bind(null,"performChecksInWeb"),n=this.handleTestMode.bind(this),o=this.allRequirementsInTestMode.bind(this),a=this.deviceTrustCheckFailedRunmode.bind(this);e("Enter"),y[0].platform===U||y[0].platform===$?t(f):y[0].platform===G||y[0].platform===V||y[0].allow_unsupported_oses?this.checkComServerStatus().then(function(){for(var e,t,n=[],r=0;r<b.length;r++)e=b[r],t=_.sendRequest(e,!1,P),n.push(t);return new Promise.all(n)}).then(this.handleCheckResults.bind(this)).caught(function(r){if(e({error:r}),o())return r.testMode=!0,void n(r);if(!E){var u={agent_present:"UNABLE_TO_COMMUNICATE",platform:y[0].platform,env:y[0].client_environment};a(u,!1,"performChecksInWeb"),r.error===T.BOX_EDIT_ADMIN_DEPRECATED_ERROR&&(i.removeClass(h,"hidden"),i.addClass(v,"hidden"))}if(r&&"CommunicationError"===r.name)t(s);else{if(r&&r.error&&T)switch(r.error){case T.BOX_EDIT_UPGRADE_BROWSER_ERROR:case T.BOX_EDIT_NOT_SUPPORTED_ERROR:t(m);break;case T.BOX_EDIT_SAFARI_ERROR:t(l);break;case T.BOX_EDIT_ADMIN_DEPRECATED_ERROR:case T.BOX_EDIT_DEPRECATED_ERROR:t(d);break;default:t(c)}else t(c);setTimeout(w,O)}}):t(g)}}:{init:function(){i=e.getService("dom"),o=e.getService("ajax"),a=i.query(".view-stack"),s=i.query(".check-error-section",a),u=i.query(".check-failed-section",a),c=i.query(".install-instructions-section",a),l=i.query(".install-instructions-safari-section",a),d=i.query(".install-instructions-section-deprecated",a),f=i.query(".ios-browser-unsupported-section",a),m=i.query(".upgrade-browser-section",a),g=i.query(".unsupported-os-section",a),h=i.query(".download-admin",d),v=i.query(".download-user",d),p=e.getGlobalConfig("isDeviceTrustV4Enabled"),A=e.getService("console-logger").formattedLog.bind(null,j),A("init"),E=!1,S=!1,k=!1,y=e.getConfig(),Array.isArray(y)&&(y=y[0]);var t={},n=for(var r in y)if(y.hasOwnProperty(r)){var _=y[r],T=n(r);t[T]=_}y=t;var R=y.clientEnvironment;x=y.redirectUrl,b=JSON.stringify(y.deviceTrustRequirements),A("environment, ",{clientEnvironment:R,isDeviceTrustV4Enabled:p}),C=y[0].enable_dt_in_external_browser_login;var O={android:this.performChecksInAndroid,ios:this.performChecksInIOS,sync:this.performChecksInSync,webapp:this.performChecksInWeb};w=O[R].bind(this),void 0!==w&&w()},updateCheckStatuses:function(e){var t,n,r=e.checks;this.updateFailedCheckTitles();for(var o=0;o<r.length;o++)t=r[o],n=this.getFailureMessageElement(t),t.pass?i.addClass(n,"hidden"):i.removeClass(n,"hidden")},isErrorUnknownPostureCheck:function(e){return e&&e.hasOwnProperty("error")&&e.error.toLocaleUpperCase().indexOf("UNKNOWN POSTURE CHECK TYPE")>-1},getFailureMessageElement:function(e){var t;return t="securityCenter"===e.type?"."+e.provider:"android"===y.clientEnvironment&&"notJailbroken"===e.type?".notRooted":this.isErrorUnknownPostureCheck(e)?".unknownPostureCheck":"."+e.type,i.query(t)},updateFailedCheckTitles:function(){var e=i.query(".singleListTitle"),t=i.query(".groupedListsTitle"),n=i.query(".ownershipRequirementsTitle"),r=i.query(".securityRequirementsTitle");y.haveGroupedRequirements?(i.addClass(e,"hidden"),i.removeClass(t,"hidden"),S&&i.removeClass(n,"hidden"),k&&i.removeClass(r,"hidden")):(i.removeClass(e,"hidden"),i.addClass(t,"hidden"),i.addClass(n,"hidden"),i.addClass(r,"hidden"))},checkResults:function(e){var t=y.clientEnvironment;if(e.env=y.clientEnvironment,e.pass)return!0;if("webapp"===t||"sync"===t){var n=this.checkOwnershipResults(e),r=this.checkSecurityResults(e);return y.haveGroupedRequirements?n&&r:n||r}return!1},checkOwnershipResults:function(e){for(var t,n=e.checks,r=!0,i=!0,o=!0,a=0;a<n.length;a++)t=n[a],"certificatePresent"!==t.type&&"perDeviceCertificatePresent"!==t.type||(r=t.pass),"joinedToDomain"===t.type&&(i=t.pass),this.isErrorUnknownPostureCheck(t)&&(e.agent_present="OUT_OF_DATE");return"domainAndCertCheck"===y.haveDomainCertCheck?o=r&&i:"domainOrCertCheck"===y.haveDomainCertCheck?o=r||i:"domainCheckOnly"===y.haveDomainCertCheck?o=i:"certCheckOnly"===y.haveDomainCertCheck&&(o=r),o||(S=!0),o},checkSecurityResults:function(e){for(var t,n=e.checks,r=0;r<n.length;r++)if(t=n[r],"certificatePresent"!==t.type&&"joinedToDomain"!==t.type&&"perDeviceCertificatePresent"!==t.type&&(this.isErrorUnknownPostureCheck(t)&&(e.agent_present="OUT_OF_DATE"),!t.pass))return k=!0,!1;return!0},handleCheckResults:function(n){var r=A.bind(null,"handleCheckResults");return r({results:n}),n.agent_present="YES",n.platform=y.platform,this.checkResults(n)?void o.post("pass_device_trust_check",n,{success:function(){r("Checks Passed -",{redirectUrl:x}),e.getGlobal("window").location.replace(x)},error:function(){r("Error"),t(s)},application:this}):y.inTestMode?void this.handleTestMode(n):(t(u),this.updateCheckStatuses(n),E||(o.post("device_trust_check_failed",n,{success:function(){r("handleCheckResults: Checks failed. Logged successfully the failed event")},error:function(){r("handleCheckResults: Checks failed. Couldnot log the failure event")},application:this}),E=!0),setTimeout(w,O),void r("Failed"))},handleTestMode:function(n){var r=A.bind(null,"handleCheckResults");n||(n={}),n.testMode=!0,E||(o.post("device_trust_check_failed",n,{success:function(){r("Checks failed, but test mode enabled",{redirectUrl:x}),e.getGlobal("window").location.replace(x)},error:application:this}),E=!0)},performChecksInSync:function(){var n=A.bind(null,"performChecksInSync");n("Enter");var r=e.getGlobal("window"),o=e.getGlobal("window").external,a=o&&("function"==typeof o.CheckDeviceTrust||"unknown"==typeof o.CheckDeviceTrust),u=r.webkit&&r.webkit.messageHandlers&&r.webkit.messageHandlers.checkDeviceTrust;if(a){var c=o.CheckDeviceTrust(b);n({results:c}),this.handleCheckResults(JSON.parse(c))}else if(u){if(r.deviceTrust)return;var l=!1;r.deviceTrust={requirements:b,receiveResults:function(e){l=!0,this.handleCheckResults(JSON.parse(e))}.bind(this)},i.on(document,"load",function(){setTimeout(function(){l||t(s)},I)})}else C?this.performChecksInWeb():t(s)},performChecksInAndroid:function(){var n=e.getGlobal("window");if(!n.deviceTrust&&!this.checkAndroidAppVersion()){var r=!1;n.deviceTrust={requirements:b,receiveResults:function(e){r=!0,this.handleCheckResults(JSON.parse(e))}.bind(this)},i.on(document,"load",function(){setTimeout(function(){r||t(s)},D)})}},showAndroidAppTooOldError:function(){t(u);var e={pass:!1,checks:[{type:"androidAppVersion",pass:!1}]};this.updateCheckStatuses(e)},checkAndroidAppVersion:function(){var e=navigator.userAgent,n=/(?:(?:forgepond.com.box.emm.androids)|(?:com.box.emm.android)|(?:com.box.android))\/(\d+)\.(\d+)\.(\d+)/,r=n.exec(e);if(!r||4!==r.length)return t(s),!0;var i=parseInt(r[1],10),o=parseInt(r[2],10),a=parseInt(r[3],10);if(i>q)return!1;if(i===q){if(o>B)return!1;if(o===B&&a>=H)return!1}return this.showAndroidAppTooOldError(),!0},checkComServerStatus:function(){var t=A.bind(null,"checkComServerStatus");if(t("Enter"),!p&&e.getGlobalConfig("isDeviceTrustFallbackEnabled")){var n="ComServerNotAvailable";return t({errorCode:n}),Promise.reject(n)}return _.getComServerStatus()},performChecksInIOS:function(){var n=e.getGlobal("window");if(!n.deviceTrust&&!this.checkIOSAppVersion()){var r=!1;n.deviceTrust={requirements:b,receiveResults:function(e){r=!0,this.handleCheckResults(JSON.parse(e))}.bind(this)},i.on(document,"load",function(){setTimeout(N)})}},showIOSAppTooOldError:function(){t(u);var e={pass:!1,checks:[{type:"iosAppVersion",pass:!1}]};this.updateCheckStatuses(e)},checkIOSAppVersion:function(){var e=navigator.userAgent,n=/(?:(?:net.box.BoxNet)|(?:com.box.ios.dev)|(?:com.box.mdmios)|(?:com.box.ios.devemm))\/(\d+)\.(\d+)\.(\d+)/,r=n.exec(e);if(!r||4!==r.length)return t(s),!0;var i=parseInt(r[1],10),o=parseInt(r[2],10),a=parseInt(r[3],10);if(i>F)return!1;if(i===F){if(o>L)return!1;if(o===L&&a>=M)return!1}return this.showIOSAppTooOldError(),!0},performChecksInWeb:function(){r();var e=A.bind(null,"performChecksInWeb"),n=this.handleTestMode.bind(this);e("Enter"),y.platform===U||y.platform===$?t(f):y.platform===G||y.platform===V||y.allow_unsupported_oses?this.checkComServerStatus().then(.then(this.handleCheckResults.bind(this)).caught(function(r){if(e({error:r}),y.inTestMode)return void n(r);if(!E){var a={agent_present:"UNABLE_TO_COMMUNICATE",platform:y.platform,env:y.clientEnvironment};o.post("device_trust_check_failed",a,{success:function(){e("performChecksInWeb: Checks failed. Logged successfully the failed event")},error:application:this}),E=!0,r.error===T.BOX_EDIT_ADMIN_DEPRECATED_ERROR&&(i.removeClass(h,"hidden"),i.addClass(v,"hidden"))}if(r&&"CommunicationError"===r.name)t(s);else{if(r&&r.error&&T)switch(r.error){case T.BOX_EDIT_UPGRADE_BROWSER_ERROR:case T.BOX_EDIT_NOT_SUPPORTED_ERROR:t(m);break;case T.BOX_EDIT_SAFARI_ERROR:t(l);break;case T.BOX_EDIT_ADMIN_DEPRECATED_ERROR:case T.BOX_EDIT_DEPRECATED_ERROR:t(d);break;default:t(c)}else t(c);setTimeout(w,O)}}):t(g)}}}),Box.Application.addService("adobe-analytics",function(e){"use strict";function t(){var e=new Date;return"s"+Math.floor(e.getTime()/108e5)%10+Math.floor(1e13*Math.random())}function n(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n].indexOf(t)>-1)return e[n+1];return""}unction i(){var e=new Date,t=e.getDate(),n=e.getMonth(),r=e.getFullYear(),i=e.getDay(),o=e.getTimezoneOffset(),a=t+"/"+n+"/"+r,s=e.getHours()+":"+e.getMinutes()+":"+e.getSeconds();return a+" "+s+" "+i+" "+o}function o(e){var t=e.signup||{},n=[];return t.view&&1===t.step&&n.push("event4"),t.start&&1===t.step&&n.push("event5"),t.view&&2===t.step&&n.push("event6"),t.start&&2===t.step&&n.push("event29"),t.view&&3===t.step&&n.push("event33"),t.start&&3===t.step&&n.push("event34"),t.view&&4===t.step&&n.push("event35"),t.start&&4===t.step&&n.push("event36"),t.view&&5===t.step&&n.push("event37"),t.end&&n.push("event7"),n.join(",")}function a(e){var t=864e5;return t*e}function s(){var e=new Date,t=e.getTime();return(t+a(7))/1e3}function u(){var e=new Date,t=e.getTime();return t+a(730)}function c(){var e=location.hostname.split(".");return e[e.length-2]+"."+e[e.length-1]}function l(){var e=[],t=1256414278,n=s();return e.push(t),T.marketingCloudId&&(e.push("MCMID"),e.push(T.marketingCloudId)),T.audienceManagerLocationHint&&(e.push("MCAAMLH-"+n),e.push(T.audienceManagerLocationHint)),T.audienceManagerBlob&&(e.push("MCAAMB-"+n),e.push(T.audienceManagerBlob)),e.join("|")}function d(){var e=u(),t=c(),n=l();x.set(_,n,e,"/",t)}function f(e,t){var n={ndh:"1",pf:"1",t:i(),D:"D=",mid:T.marketingCloudId,aamlh:T.audienceManagerLocationHint,ce:"UTF-8",ns:"boxinc",pageName:r(),g:window.location.href,events:o(e),aamb:T.audienceManagerBlob,v4:"D=pageName",v9:window.location.hostname,v15:E,v21:"D=g",v:"Y",k:"Y"};return e.signup&&e.signup.account&&(n.v3=e.signup.account),e.signup&&e.signup.type&&(n.v62=e.signup.type),e.signup&&e.signup.version&&(n.v68=e.signup.version),"event"===t&&(n.pe="lnk_o",n.pev=e.eventName),n}function p(e,n){var r=f(e,n),i=C.encode(r),o=g.DEV;return e.live&&(o=g.LIVE),"https://"+y+"/b/ss/"+o+"/1/JS-1.4.3-D56N/"+t()+"?AQB=1&"+i+"&AQE=1"}function h(e,t){var n=new Image;n.src=p(e,t)}function v(e,t){return T.marketingCloudId?void h(e,t):void $.ajax({url:w,dataType:"jsonp",jsonp:"d_cb",success:function(e){T.marketingCloudId=e.d_mid||"",T.audienceManagerLocationHint=e.dcs_region||"",T.audienceManagerBlob=e.d_blob||"",d()},complete:)}function m(){if(!T.marketingCloudId){var e=x.get(_),t=e.split("|");T.marketingCloudId=n(t,"MCMID"),T.audienceManagerLocationHint=n(t,"MCAAMLH-"),T.audienceManagerBlob=n(t,"MCAAMB-")}}var g={LIVE:"boxincmarketinglive,boxincglobalproduction",DEV:"boxincmarketingstaging"},y="boxinc.sc.omtrdc.net",b="B9B28F7954BD76240A4C98BC@AdobeOrg",_="AMCV_"+encodeURIComponent(b),w="https://dpm.demdex.net/id?d_rtbd=json&d_ver=2&d_orgid="+b,x=e.getService("cookies"),C=e.getService("url-amsterdam"),E=x.get("box_visitor_id"),T={
marketingCloudId:"",audienceManagerLocationHint:"",audienceManagerBlob:""};return m(),{trackPage:function(e){v(e,"page")},trackEvent:getAdobeTrackingObject:}),Box.Application.addService("ajax",function(e){"use strict";function t(e){4!==e.readystate&&e.abort()}unction r(e){var t;try{t=JSON.parse(e.responseText)}catch(n){t=e.responseText}return{status:e.status,data:t}}unction o(t,n){if($.isEmptyObject(t)&&$.isEmptyObject(n))return u.createResolved();var r=e.getService("assets"),i=u.create(function(e){r.loadJSByHash(t,function(){e()})}),o=u.create(;return u.all([i,o])}function a(e){return!("$ver"in e||"data"in e)}function s(s,c,l,d,f){function p(t,s){function u(r,i,u){function c(){"function"==typeof d&&(f.context?d.call(f.context,l):d(l))}var l,d=f.success,p=null===r||"undefined"==typeof r;if(p)r=null;else{if(!$.isPlainObject(r))return void s(new Error("Invalid Response Data. Response data must be a plain object."));if("unidb"===r.type&&"params"in r){var h=e.hasService("unidb")?e.getService("unidb"):null;h&&(r=h.decode(r))}}p||a(r)?(l=n(r,u),c(),t(l)):(l=n(r.data,u),o(r.js||{},r.css||{}).then()}function c(e,t,n){if(0!==e.status||"abort"!==t||"abort"!==n){var o=r(e),a=f.error;"function"==typeof a&&(f.context?a.call(f.context,o):a(o));var u=new Error(i(t));u.status=o.status,u.data=o.data,s(u)}}v=$.ajax(m).done(u).fail(c)}var h,v,m={type:s,dataType:c,url:"/index.php?rm="+l,data:d,dataFilter:async:f.async!==!1};return h=u.createCancellable(p).caught(u.CancellationError,,"function"!=typeof f.success&&"function"!=typeof f.error||h.then(function(){},function(){}),h}var u=e.getService("promises");return{get:function(e,t,n){return n=n||{},s("GET","json",e,t,{success:n.success,error:n.error,context:n.context,async:n.async})},post:function(t,n,r){return r=r||{},n=n||{},n.request_token&&e.reportError(new Error("Request token will be appended automatically and should not passed in manually")),n.request_token=e.getGlobalConfig("requestToken")||e.getGlobal("request_token"),s("POST","json",t,n,{success:r.success,error:r.error,context:r.context,async:r.async})}}}),Box.Application.addService("browser",function(e){"use strict";function t(e){var t,n,r,i=null,o=null;for(t=0,n=e.length;t<n;t++)if(r=e[t].string,_=e[t].versionSearch||e[t].identity,r&&r.indexOf(e[t].subString)!==-1){i=e[t].identity,o=e[t].device;break}return{identity:i,device:o}}function n(e){var t,n=e.indexOf(_);return n===-1?"":(t=e.substring(n+_.length+1).match(/[0-9]+(?:\.[0-9]*)?/),t&&t.length?t[0]:void 0)}function r(){var e=y.userAgent.match(/Mac OS X (([\d]+)_([\d]+)_([\d]+))/i);return e&&e[1]?{version:e[1].replace(/_/g,"."),major:parseInt(e[2],10),minor:parseInt(e[3],10),maintenance:parseInt(e[4],10)}:null}unction o(){var e,t=y.userAgent.match(/Windows NT (([\d]+).([\d]+))/i);return t&&t[1]?(e=t[1],"5.1"===e||"5.2"===e?"XP":"6.0"===e?"Vista":"6.1"===e?"7":"6.2"===e?"8":"6.3"===e?"8.1":"Unknown"):null}function a(){var e;return d.OS===m.MAC&&(e=r(),e.major>10||10===e.major&&e.minor>=7)}function s(){var e,t,n=y.plugins;if(!n)return!1;for(n.refresh&&n.refresh(!1),e=0;e<n.length;e++)if(t=n[e],t&&t.name.match(/^Java/))return!0;return!1}function u(t){var n=e.getGlobal("ActiveXObject"),r=t||"htmlfile",i=!1;try{"ActiveXObject"in window&&(i=!!new n(r))}catch(e){i=!1}return i}function c(e,t){var n;if(0===e.indexOf("audio/"))n=b.createElement("audio");else{if(0!==e.indexOf("video/"))return!1;n=b.createElement("video")}return!(!n.canPlayType||n.canPlayType(e).replace(/^no$/,"")!==t)}ar d,f="9",p='video/mp4; codecs="avc1.42E01E"',h='video/mp4; codecs="avc1.4D401E"',v='video/mp4; codecs="avc1.64001E"',m={CHROME:"Chrome",EDGE:"Edge",FIREFOX:"Firefox",MAC:"Mac",SAFARI:"Safari"},g=e.getGlobal("window"),y=e.getGlobal("navigator"),b=e.getGlobal("document"),_="",w=[{string:y.userAgent,subString:m.EDGE,identity:m.EDGE},{string:y.userAgent,subString:m.CHROME,identity:m.CHROME},{string:y.userAgent,subString:"criOS",identity:m.CHROME,versionSearch:"criOS"},{string:y.vendor,subString:"Apple",identity:m.SAFARI,versionSearch:"Version"},{string:y.userAgent,subString:m.FIREFOX,identity:m.FIREFOX},{string:y.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:y.userAgent,subString:"Trident",identity:"Explorer",versionSearch:"rv"},{string:y.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"}],x=[{string:y.platform,subString:"Win",identity:"Windows"},{string:y.userAgent,subString:"iPod",identity:"iOS",device:"iPod"},{string:y.userAgent,subString:"iPhone",identity:"iOS",device:"iPhone"},{string:y.userAgent,subString:"iPad",identity:"iOS",device:"iPad"},{string:y.platform,subString:m.MAC,identity:m.MAC},{string:y.userAgent,subString:"Android",identity:"Android"},{string:y.platform,subString:"Linux",identity:"Linux"}];return d={constants:m,init:function(){this.browser=t(w).identity||"an unknown browser",this.version=n(y.userAgent)||n(y.appVersion)||"an unknown version";var e=t(x);this.OS=e.identity||"an unknown OS",this.device=e.device||"an unknown device"},getName:function(){return this.browser},getVersion:function(){return this.version},getOSName:function(){return this.OS},getDeviceName:getOSVersionName:function(){switch(this.getOSName()){case m.MAC:return i();case"Windows":return o();default:return"Unknown"}},isFolderDragAndDropUploadSupported:isMinBrowser:function(e,t){return this.browser.toLowerCase()===e.toLowerCase()&&parseFloat(this.version)>=parseFloat(t)},isHtml5EnabledIE:function(){return!(!this.isMinBrowser("explorer","10")||!b.documentMode)&&parseInt(b.documentMode,10)>=10},isIncompatibleChromeMacCombination:function(){return this.isChrome()&&a()&&!s()},isIncompatibleSafariMacCombination:function(){return!(d.OS!==m.MAC||!this.isSafari()||s())&&this.isMinBrowser(m.SAFARI,"6.1")},isMobileOS:canUseFlash:function(){var t=e.getGlobal("swfobject");return!(!this.isIE()||!t)&&t.hasFlashPlayerVersion("9.28.0")},canUseHtml5:function(){return this.isMinBrowser(m.FIREFOX,"3.6")||this.isMinBrowser(m.CHROME,"5")||this.isHtml5EnabledIE()||this.isMinBrowser(m.SAFARI,"4")},canPlayH264Baseline:function(){return l(p)},canPlayH264Main:function(){return l(h)},canPlayH264High:canPlayMP3:function(){return c("audio/mpeg","maybe")||c("audio/mpeg","probably")},supportsDash:function(){var t=e.getGlobal("MediaSource");return!!t&&("function"==typeof t.isTypeSupported?t.isTypeSupported(v):this.canPlayH264High())},supportsMSE:supportsWebGL:function(){var e,t=b.createElement("canvas");try{e=t.getContext("webgl")||t.getContext("experimental-webgl")}catch(e){}return null!==e&&void 0!==e},canUseHtml5Dnd:function(){return this.isMinBrowser(m.FIREFOX,"3.6")||this.isMinBrowser(m.CHROME,"10")||this.isHtml5EnabledIE()||this.isEdge()||this.isMinBrowser(m.SAFARI,"5")},canUseSessionStorage:function(){var t=e.getGlobal("sessionStorage");try{return t.setItem("testKey","testValue"),t.removeItem("testKey"),!0}catch(e){return!1}},isSafari:function(){return this.browser===m.SAFARI},isFirefox:function(){return this.browser===m.FIREFOX},isChrome:function(){return this.browser===m.CHROME},isIE:isEdge:isIEAndSpecificBrowserPluginSupported:function(e){return this.isIE()&&u(e)},isBrowserPluginsSupported:function(){return y&&"object"==typeof y.plugins&&y.plugins.length>0||this.isIE()&&u()},isTransformSupported:function(){return!this.isIE()||this.isMinBrowser("explorer","9")},canFolderUpload:function(){return this.isMinBrowser(m.CHROME,"21")||this.isMinBrowser(m.EDGE,"14")||this.isMinBrowser(m.FIREFOX,"50")},hasMinimumFlashVersion:function(){var t=e.getGlobal("swfobject"),n=t.getFlashPlayerVersion();return n.major>=parseInt(f,10)},hasSVGSupport:getMinimumFlashVersion:function(){return f},isFileApiSupported:function(){return"undefined"!=typeof Blob&&!!Blob.prototype.slice},isInlineWorkerSupported:function(){function e(){}if(!this.isFileApiSupported())return!1;var t=URL||webkitURL;if(!t)return!1;try{var n=new Blob(["("+e.toString()+").call()"],{type:"text/javascript"}),r=t.createObjectURL(n),i=new Worker(r);return i.terminate(),t.revokeObjectURL(r),!0}catch(e){return!1}},isCryptoSupported:isSubtleCryptoSupported:function(){return this.isCryptoSupported()&&!!(g.crypto||g.msCrypto||g.webkitCrypto).subtle}},d.init(),d}),Box.Application.addService("console-logger",function(e){"use strict";unction n(e,t,n){var r=[];for(e=String(e||""),t-=e.length;t>0;)r.push(n),t--;return r.push(e),r.join("")}function r(e,t){var r=new Date,o=[r.getFullYear(),n(r.getMonth()+1,2,"0"),n(r.getDate(),2,"0")],s=[n(r.getHours(),2,"0"),n(r.getMinutes(),2,"0"),n(r.getSeconds(),2,"0")],u=Array.prototype.slice.call(arguments,2);u=u.map(;var c=[o.join("-"),s.join(":"),[e,t].join(":")+" -"].concat(u);a.isSafari()?i.log(c.join(" ")):a.isIE()?i.dir(c.join(" ")):i.log.apply(null,c)}var i=e.getGlobal("console"),o=e.getGlobalConfig("isConsoleLoggingEnabled"),a=e.getService("browser");return{formattedLog:o?r:t}}),Box.Application.addService("com-server",function(e){"use strict";function t(){return!!R.getItem("comUseFallback")}nction i(){e.getGlobalConfig("useUnSecureUrlForComServer")&&(j=y)}function o(){return t()?{primary:S,fallback:T}:{primary:T,fallback:S}}function a(t,n,r){var i;try{if(window.XMLHttpRequest&&(i=new XMLHttpRequest,"withCredentials"in i))return i.open(t,n,r),i;if("undefined"!=typeof XDomainRequest)return i=new XDomainRequest,i.open(t,n),i.onprogress=function(){},i.ontimeout=i}catch(i){O<3&&setTimeout(function(){return O++,a(t,n,r)},500*O),e.reportError(i)}return null}function s(e,t,n,r){return new Promise(function(i,o){var s=a(e,t,!0);s?(e===b&&"function"==typeof s.setRequestHeader&&s.setRequestHeader(w,x),s.onload=function(){i(s)},s.onerror=function(){o(s)},r>0&&(s.timeout=r,s.ontimeout=,setTimeout(0)):o()})}function u(e){return s(_,j+e+"/status",null,E).then(function(e){var t=JSON.parse(e.responseText);return t.running?t:Promise.reject(C)})}function c(){function e(e,i){h=e;var o;e===T?(r(),o="primary"):(n(),o="fallback"),A.recordAction({application:"files",page:"",component:"",feature:"boxedit",target:"available"+o,action:"programmatic"}),t(i)}var t,i;v=new Promise(;var a=o(),s=a.primary,c=a.fallback;return u(s).then(e.bind(this,s)).catch(function(t){return t===C?void i():void u(c).then(e.bind(this,c)).catch(}),v}function l(){var e=(new Date).getTime();return"xxxxxxxx".replace(/x/g,function(){var t=Math.floor((e+16*Math.random())%16);return t.toString(16)})}unction f(e){var t=d(e)||l(),n="bgp-"+t,r=(new Date).getTime()+m;return k.set(e+"-bgp-id",t,r),k.set("bgp-"+t,"generic",r),n}ar h,v,m=31536e6,g="https://edit.boxlocalhost.com:",y="http://127.0.0.1:",b="POST",_="GET",w="Content-Type",x="text/plain; charset=UTF-8",C="notrunning",E=5e3,T=17223,S=17224,k=e.getService("cookies"),A=e.getService("resin"),R=e.getService("local-store"),j=g,O=0;return p.prototype={getComServerStatus:function(){return!v||v.isRejected()?(v=null,c()):v},sendRequest:function(e,t,n){var r=j+h+"/application_request?application="+this.appName+"&com="+this.comChannelName;if(!t){if(n>0){var i=Math.floor((n-500)/1e3);i>0&&(r+="&timeout="+i)}return s(b,r,e,n).then(function(e){var t=JSON.parse(e.responseText);return t.response_type&&"error"===t.response_type?Promise.reject({name:"CommunicationError",message:t.message}):t})}var o=a(b,r,!1);if(o&&("function"==typeof o.setRequestHeader&&o.setRequestHeader(w,x),o.send(e),4===o.readyState&&2===Math.floor(o.status/100)))return JSON.parse(o.responseText)},sendCommand:function(e){var t=j+h+"/application_command?application="+this.appName+"&com="+this.comChannelName;return s(b,t,e)}},{create:function(t){var n=e.getService("logger"),r={marker_date:"2017-10-09",marker_location:"webapp/Login/js/services/com-server.js:create",message:t};return n.sendLog("tombstone","zombie",r),i(),new p(t)}}}),Box.Application.addService("com-server-client",function(e){"use strict";function t(e){return C.http_channel_status=j,z("createHTTPChannel",e),$.create(e,S,k)}function n(e){return C.https_channel_status=j,z("createHTTPSChannel",e),$.create(e,T,A)}function r(e){return C.safari_channel_status=j,z("createSafariChannel",e),G.create(e)}function i(e){return C.activex_channel_status=j,z("createActiveXChannel",e),V.create(e)}function o(e){return C.activex_channel_status=j,z("createActiveXChannel",e),V.createSynchronous(e)}function a(){return!!e.getGlobalConfig("isMSEdgeSupportForBoxEditEnabled")}unction u(e,t){var n=e.split("."),r=t.split(".");n=n.map(Number),r=r.map(Number);for(var i=0;i<n.length;++i){if(n[i]<r[i])return!0;if(n[i]>r[i])return!1}return!1}function c(e){return!(!U.isMinBrowser(U.constants.CHROME,102)&&!U.isMinBrowser(U.constants.EDGE,102))&&u(e,q)}function l(){return U.isMinBrowser(U.constants.EDGE,I)||U.isMinBrowser(U.constants.EDGE,P)&&U.getVersion().match(F)}function d(){return U.isEdge()&&!l()}function f(){return U.isMinBrowser(U.constants.CHROME,53)||U.isMinBrowser(U.constants.FIREFOX,D)||a()&&l()}nction v(){return U.isFirefox()&&!U.isMinBrowser(U.constants.FIREFOX,D)}unction g(){return m()&&U.isIEAndSpecificBrowserPluginSupported(E)}function y(e){var t=B.BOX_EDIT_NOT_SUPPORTED_ERROR;return f()?t=B.BOX_EDIT_UNINSTALLED_ERROR:m()?t=B.BOX_EDIT_UNINSTALLED_ERROR:U.isFirefox()||U.isChrome()||h()||a()&&d()?t=B.BOX_EDIT_UPGRADE_BROWSER_ERROR:p()&&(t=B.BOX_EDIT_SAFARI_ERROR),null!==this&&this.isDeprecated&&(t=this.isAdminInstallation?B.BOX_EDIT_ADMIN_DEPRECATED_ERROR:B.BOX_EDIT_DEPRECATED_ERROR),z("comServerErrorGenerator",t),C.error_message=t,X.sendBatchLog(N,"boxtools_error_log",C),e({error:t})}function b(e){var t=L;return"number"==typeof e&&e>=0&&(t=Math.floor(e)),z("validateAndReturnBrowserToComServerTimeout",t),t}function _(e){var t=(e/1e3).toFixed(2);return e<2?t/=2:t-=1,z("shortenAndReturnComServerToApplicationTimeout",t),t}function w(){var e=U.getName(),t=U.getVersion();C={browser_name:e,browser_version:t,http_channel_status:R,https_channel_status:R,activex_channel_status:R,safari_channel_status:R}}var x,C,E="Box.BoxTools",T="https://edit.boxlocalhost.com:",S="http://127.0.0.1:",k="http_channel",A="https_channel",R="uncreated",j="created",O="active",N="webapp_boxtools_analytics",D=55,P="16.16299",I="17.17134",F=/^16\.\d*/,L=5e3,M=4,q="4.16.1.910",B={BOX_EDIT_NOT_SUPPORTED_ERROR:"box_edit_not_supported_error",BOX_EDIT_UNINSTALLED_ERROR:"box_edit_uninstalled_error",BOX_EDIT_UPGRADE_BROWSER_ERROR:"box_edit_upgrade_browser_error",BOX_EDIT_SAFARI_ERROR:"box_edit_safari_error",BOX_EDIT_INSECURE_REQUESTS_UPGRADED_ERROR:"box_edit_insecure_requests_upgraded_error",BOX_EDIT_DEPRECATED_ERROR:"box_edit_deprecated_error",BOX_EDIT_ADMIN_DEPRECATED_ERROR:"box_edit_admin_deprecated_error"},H="com-server-client",U=e.getService("browser"),$=e.getService("http-channel"),G=e.getService("safari-channel"),V=e.getService("activex-channel"),W=e.getService("promises"),X=e.getService("logger"),z=e.getService("console-logger").formattedLog.bind(null,H),J=[],Q=!1;return{constants:B,initialize:function(e){Q||(Q=!0,w(),f()?J.push(t(e)):p()?J.push(r(e)):g()?J.push(i(e)):v()||a()&&d()||(J=J.concat([t(e),r(e),o(e)])),s()||J.push(n(e)),z("initialize",C))},isInitialized:getComServerStatus:function(e){var t=b(e),n=_(t),r=!a()&&U.isEdge()||a()&&d();return new Promise(function(e,i){r&&(z("getComServerStatus","Unsupported browser - Edge"),y.call(null,i)),J.length||y.call(null,i),W.one(J.map(function(r){return r.getComServerStatus(t,n).then(function(t){if(x=r,t){C.installation_type=t.installation_type,C.box_tools_version=t.version;var n=parseInt(t.version,10),o=t.version;if(s()){var n=parseInt(t.version,10);n&&n<M&&y.call(null,i)}if((r.channelName===k||r.channelName===A)&&c(o)){var a={isDeprecated:!0,isAdminInstallation:"per-user"!==t.installation_type};y.call(a,i)}}return C[r.channelName+"_status"]=O,X.sendBatchLog(N,"boxtools_log",C),z("getComServerStatus",{activeChannel:r.channelName}),e(t)})})).catch(y.bind(null,i))})},sendRequest:function(e,t,n){var r=b(n),i=_(r);return z("sendRequest",e),x?x.sendRequest(e,r,i):this.getComServerStatus().then(function(){return x.sendRequest(e,r,i)})},sendCommand:function(e,t){var n=b(t),r=_(n);return z("sendCommand",e),x?x.sendCommand(e,n,r):this.getComServerStatus().then(}}}),Box.Application.addService("activex-channel",function(e){"use strict";function t(){var t=e.getGlobal("ActiveXObject");return j("createActiveXObjectJSRef","ActiveX object instance created"),new t(m)}function n(){return D?t():k.query(v)}function r(){if(D)return void j("renderActiveXObjectToDom","ActiveXObject JS ref used to communicate");var e=k.query(v);if(!e){var t=k.createFragmentFromHtml(h);e=S.body.appendChild(t),j("renderActiveXObjectToDom","ActiveX object attached to DOM")}}function i(){if(!D){var e=k.query(v);e&&(k.remove(e),j("removeActiveXObjectFromDom","ActiveX object removed from DOM"))}}unction a(e){if(A.isIEAndSpecificBrowserPluginSupported(m)){if(O>=b)return void j("repairActiveXConnection",b+" retries failed.");O+=1,i(),setTimeout(function(){j("repairActiveXConnection","Retry attempt #"+O),r(),s(e)},100)}}function s(e,t){var r=j.bind(null,"executeActiveXEvent");r(e);var i=n(),o="ExecuteSync"in i;r({hasExecuteAPI:"Execute"in i,hasExecuteSyncAPI:o,synchronousExecutionRequested:t});try{t&&o?i.ExecuteSync(JSON.stringify(e)):i.Execute(JSON.stringify(e))}catch(t){r("Connection to ActiveX lost",t),a(e)}}function u(e){var t=j.bind(null,"appExtensionEventResponseHandler");O>0&&(t("Retry successful"),O=0);var n="string"==typeof e.detail?JSON.parse(e.detail):e.detail;if(t("Received",n),N.has(n.req_id)){var r=N.get(n.req_id);clearTimeout(r.rejectTimeout),N.delete(n.req_id);var i="string"==typeof n.com_server_response.data?JSON.parse(n.com_server_response.data):n.com_server_response.data;t("Resolved",i),r.resolve(i)}else t("Request ID missing",{response:n})}function c(e,t,n,r){var i=r.toString(),a={operation:t,properties:{application:e,timeout:i},req_id:o()};if(t!==T){if(!n)throw new TypeError("Data cannot be undefined for "+t,"activex-channel.js");a.data=n}return a}function l(e,t,n,r,i,o){var a=j.bind(null,"createCallbackInstanceFactory");return new Promise(function(u,l){var d=c(e,t,r,o);a("Start Promise",{details:d});var f=setTimeout(function(){a("Request timed out",{details:d}),l({status_code:x})},i);N.set(d.req_id,{resolve:u,rejectTimeout:f}),s({detail:d},n)})}function d(){P||(S.addEventListener(_,u),P=!0),r()}function f(){P&&(S.removeEventListener(_,u),P=!1),i()}function p(e,t){this.getComServerStatus=l.bind(this,e,T,t,null),this.sendRequest=l.bind(this,e,E,t),this.sendCommand=l.bind(this,e,C,t),this.channelName=g}var h='<object ID="ATLActiveX2" CLASSID="CLSID:BA58190A-A733-4982-8AE2-E2021F0DD503"></object>',v="#ATLActiveX2",m="Box.BoxTools",g="activex_channel",y="activex-channel",b=2,_="box_extension_output",w="BOX-EXT-REQ-ID-",x=408,C="application_command",E="application_request",T="status",S=e.getGlobal("document"),k=e.getService("dom"),A=e.getService("browser"),R=e.getGlobal("performance"),j=e.getService("console-logger").formattedLog.bind(null,y),O=0,N=new Map,D=e.getGlobalConfig("shouldUseActiveXObjectJSRef"),P=!1;return{create:function(e){return d(),new p(e,(!1))},createSynchronous:function(e){return d(),new p(e,(!0))},destroy:function(){f()}}}),Box.Application.addService("http-channel",function(e){"use strict";function t(){return!!S.getItem("comUseFallback")}function n(){S.setItem("comUseFallback",1)}function r(){S.removeItem("comUseFallback")}function i(){return t()?{primary:C,fallback:x}:{primary:x,fallback:C}}function o(t,n){var r;try{return r=new XMLHttpRequest,r.open(t,n,!0),r}catch(r){this.retryCounter<3&&setTimeout(function(){return this.retryCounter++,o(t,n)},500*this.retryCounter),e.reportError(r)}return null}function a(e,t,n,r){var i=k.bind(null,"sendComServerRequest"),a=++w;return i("Start promise","#"+a,"-",{method:e,url:t,data:n,timeoutMS:r}),new Promise(function(i,a){var s=o(e,t);s?(s.setRequestHeader(y,b),s.onload=function(){i(s)},s.onerror=function(){a(s)},r>0&&(s.timeout=r,s.ontimeout=function(){a(s)}),setTimeout(function(){s.send(n)},0)):a()}).finally(}function s(e,t){return a(g,this.url+e+"/status",null,t).then(function(e){var t=JSON.parse(e.responseText);return t.running?t:Promise.reject(_)})}function u(e){function t(e,t){p=e;var i;e===x?(r(),i="primary"):(n(),i="fallback"),T.recordAction({application:"files",page:"",component:"",feature:"boxedit",target:"available"+i,action:"programmatic"}),o(t)}var o,a;this.comServerInstallationPromise=new Promise(function(e,t){o=e,a=t});var u=i(),c=u.primary,l=u.fallback;return s.call(this,c,e).then(t.bind(this,c)).catch(function(n){return n===_?void a():void s.call(this,l,e).then(t.bind(this,l)).catch(function(){a()})}.bind(this)),this.comServerInstallationPromise}function c(){var e=(new Date).getTime();return"xxxxxxxx".replace(/x/g,function(){var t=Math.floor((e+16*Math.random())%16);return t.toString(16)})}function l(e){return E.get(e+"-bgp-id")}function d(e){var t=l(e)||c(),n="bgp-"+t,r=(new Date).getTime()+v;return E.set(e+"-bgp-id",t,r),E.set("bgp-"+t,"generic",r),n}function f(e,t,n){this.appName=e,this.comChannelName=d(e),this.channelName=n,this.comServerInstallationPromise=null,this.retryCounter=0,this.url=t}var p,h="http-channel",v=31536e6,m="POST",g="GET",y="Content-Type",b="text/plain; charset=UTF-8",_="notrunning",w=0,x=17223,C=17224,E=e.getService("cookies"),T=e.getService("resin"),S=e.getService("local-store"),k=e.getService("console-logger").formattedLog.bind(null,h);return f.prototype={getComServerStatus:function(e){return!this.comServerInstallationPromise||this.comServerInstallationPromise.isRejected()?(this.comServerInstallationPromise=null,u.call(this,e)):this.comServerInstallationPromise},sendRequest:function(e,t,n){var r=this.url+p+"/application_request?application="+this.appName+"&com="+this.comChannelName+"&timeout="+n;return a(m,r,e,t).then(function(e){var t=JSON.parse(e.responseText);return t.response_type&&"error"===t.response_type?Promise.reject({name:"CommunicationError",message:t.message}):t})},sendCommand:function(e,t,n){var r=this.url+p+"/application_command?application="+this.appName+"&com="+this.comChannelName+"&timeout="+n;return a(m,r,e,t).then(function(e){return JSON.parse(e.responseText)})}},{create:function(e,t,n){return new f(e,t,n)}}}),Box.Application.addService("safari-channel",function(e){"use strict";function t(){return l+g.now()}function n(e){y("createAndDispatchAppExtensionEvent",{payload:e});var t=new CustomEvent(u,e);m.dispatchEvent(t)}function r(e){var t=y.bind(null,"appExtensionEventResponseHandler");t("Received",e);var n="string"==typeof e.detail?JSON.parse(e.detail):e.detail;if(b.has(n.req_id)){var r=b.get(n.req_id);clearTimeout(r.rejectTimeout),b.delete(n.req_id);var i="string"==typeof n.com_server_response.data?JSON.parse(n.com_server_response.data):n.com_server_response.data;t("Resolve",n),r.resolve(i)}else t("Request ID missing",{response:n})}function i(e,n,r,i){var o=i.toString(),a={operation:n,properties:{application:e,timeout:o},req_id:t()};if(n!==v){if(!r)throw new TypeError("Data cannot be undefined for "+n,"safari-channel.js");a.data=r}return a}function o(e,t,r,o,a){var s=y.bind(null,"createCallbackInstanceFactory");return new Promise(function(u,c){var l=i(e,t,r,a);s("Start Promise","#"+l.req_id);var f=setTimeout(function(){c({status_code:d}),s("Timed out","#"+l.req_id)},o);b.set(l.req_id,{resolve:u,rejectTimeout:f}),n({detail:l})})}function a(e){this.getComServerStatus=o.bind(this,e,v,null),this.sendRequest=o.bind(this,e,h),this.sendCommand=o.bind(this,e,p),this.channelName=f}var s="safari-channel",u="box_extension_input",c="box_extension_output",l="BOX-EXT-REQ-ID-",d=408,f="safari_channel",p="application_command",h="application_request",v="status",m=e.getGlobal("document"),g=e.getGlobal("performance"),y=e.getService("console-logger").formattedLog.bind(null,s),b=new Map,_=!1;return{create:function(e){return _||(m.addEventListener(c,r),_=!0),new a(e)},destroy:}),Box.Application.addService("cookies",function(e){"use strict";var t=e.getGlobal("document");return{get:function(e){var n,r,i,o=t.cookie.split("; ");for(r=0,i=o.length;r<i;r++)if(n=o[r].split("="),n[0]===e)return n[1]?decodeURIComponent(n[1]):"";return""},remove:set:function(n,r,i,o,a){var s,u=new Date;"undefined"==typeof i&&(i=u.getTime()+5184e6),u.setTime(i),o=o||"/";var c=e.getGlobalConfig("cookieDomain");!a&&c?a=c:a||"undefined"==typeof e.getGlobal("cookie_domain")||("undefined"!=typeof Tombstone&&Tombstone.marker("./js/common/services/cookies.js:82","2014-02-10","need to weed out usage of cookie_domain and move it over to globalconfig"),a=e.getGlobal("cookie_domain")),s=n+"="+encodeURIComponent(r),0!==i&&(s+="; expires="+u.toGMTString()),s+="; path="+o,a&&(s+="; domain="+a),s+="; secure",t.cookie=s},isEnabled:function(){return!!(t.cookie&&t.cookie.length>0)},setOnRootDomain:function(t,n,r,i,o){var a=e.getGlobalConfig("cookieRootDomain");this.set(t,n,r,i,a,o)}}}),Box.Application.addService("credit-card",function(e){"use strict";var t={34:"AmericanExpress",37:"AmericanExpress",4:"Visa",51:"MasterCard",52:"MasterCard",53:"MasterCard",54:"MasterCard",55:"MasterCard",6011:"Discover"};return{getCardType:function(e){var n,r,i;for(n=1;n<=4&&(r=e.substring(0,n),!(i=t[r]));n++);return i},isCardExpired:function(e,t){var n=new Date,r=new Date(t,e);return n.getTime()>r.getTime()},passesLuhnCheck:function(e){var t,n=1&e.length,r=0;for(t=0;t<e.length;t++){var i=parseInt(e.charAt(t));1&t^n||(i*=2,i>9&&(i-=9)),r+=i}return r%10===0}}}),Box.Application.addService("dom",function(e){"use strict";function t(e,t,n,r){r=r||{},$(e).on(t,r,n)}unction r(e,t){return function(n){window.setTimeout(0)}}function i(e,t){return function(){for(var r=0,i=d.length;r<i;r++)n(e,d[r],t)}}function o(e,n){for(var o=r(e,n),a=i(e,o),s=0,u=d.length;s<u;s++)t(e,d[s],o,{detachHandler:a})}function a(){var e,t=document.createElement("fakeelement");for(e in l)"undefined"!=typeof t.style[e]&&d.push(l[e]);f=!0}function s(e,t,n){"add"===n?$(e).addClass(t):"remove"===n&&t?$(e).removeClass(t):"remove"===n&&$(e).removeClass()}function u(e,t,n){var r,i,o,a=/\s+/;if(p&&"string"==typeof t)if(Array.isArray(e))for(r=0,i=e.length;r<i;r++)u(e[r],t,n);else if(e instanceof HTMLElement)for(o=t.split(a),r=0,i=o.length;r<i;r++)e.classList[n](o[r].trim());else s(e,t,n);else s(e,t,n)}function c(e,t,n,r){d.length>0?(o(e,r),u(e,t,n)):(u(e,t,n),window.setTimeout(function(){r(e)},0))}var l={transition:"transitionend",WebkitTransition:"webkitTransitionEnd",animation:"animationend",WebkitAnimation:"webkitAnimationEnd"},d=[],f=!1,p="undefined"!=typeof document&&"classList"in document.documentElement;return{query:function(e,t){return $(t||document).find(e)[0]},queryAll:function(e,t){return $(t||document).find(e).get()},setHTML:function(t,n){t&&1===t.nodeType?(e.stopAll(t),$(t).html(n),e.startAll(t)):e.reportError(new Error("setHTML() requires a valid DOM element"))},setText:function(e,t){"textContent"in e?e.textContent=t:e.innerText=t},insertAfter:remove:addClass:function(e,t,n){f||a(),"function"==typeof n?c(e,t,"add",n):u(e,t,"add")},hasClass:function(e,t){return p&&e instanceof HTMLElement?e.classList.contains(t):$(e).hasClass(t)},removeClass:function(e,t,n){f||a(),"function"==typeof n?c(e,t,"remove",n):u(e,t,"remove")},getNearestUnbounded:function(e,t){var n=$(e),r=n.closest(t);return r.length?r[0]:null},getNearest:function(e,t){for(var n=$(e),r=n.is(t);!r&&n.length&&!n.is("[data-module]");)n=n.parent(),r=n.is(t);return r?n[0]:null},getNearestTypeElement:getData:isVisible:on:t,off:n,createFragmentFromHtml:function(e){var t=document.createElement("div"),n=document.createDocumentFragment();for($(t).html(e);t.firstChild;)n.appendChild(t.firstChild);return n},getComputedCSS:function(t){var n,r,i={},o=$(t),a=e.getGlobal("getComputedStyle");if(a&&(n=a(t,null))){if(n.length)for(var s=0,u=n.length;s<u;s++)r=n[s],i[r]=o.css(r);else for(r in n)n.hasOwnProperty(r)&&(i[r]=o.css(r));return i}if(t.currentStyle){n=t.currentStyle;for(r in n)i[r]=o.css(r)}return i},getBoundingClientRect:function(e){var t=e.getBoundingClientRect();if("number"==typeof t.width)return t;var n={left:t.left,top:t.top,right:t.right,bottom:t.bottom},r=$(e);return n.width=r.outerWidth(),n.height=r.outerHeight(),n},getFirstElementChild:function(e){for(var t=3,n=e.firstChild;n&&n.nodeType===t;)n=n.nextSibling;return n}}}),Box.Application.addService("focus",function(e){"use strict";function t(e){for(var t=a.queryAll(o,e),n=[],r=0;r<t.length;r++)a.isVisible(t[r])&&n.push(t[r]);return n}function n(e){return function(n){var i=t(e);i.length>0&&n&&n.data&&n.data.field&&(n.data.field===r?i[0].focus():i[i.length-1].focus())}}var r="after",i="before",o="a[href], button:not(.popup-x-btn), input, select, textarea",a=e.getService("dom");return{wrap:function(e,o){if(!e.isFocusWrapped){e.isFocusWrapped=!0;var s=document.createElement("i");s.setAttribute("tabindex","0");var u=document.createElement("i");if(u.setAttribute("tabindex","0"),a.on(s,"focusin",n(e),{field:i}),a.on(u,"focusin",n(e),{field:r}),e.children.length>0&&(e.insertBefore(s,e.firstChild),e.appendChild(u)),"undefined"==typeof o||o===!0){var c=t(e);o=c[0]}o&&o.focus&&o.focus()}}}}),Box.Application.addService("form-validator",function(e){"use strict";function t(){return"function"==typeof N.createElement("input").checkValidity}unction r(e){var t=e.tagName?e.tagName.toLowerCase():"";return"input"===t||"textarea"===t||"select"===t}function i(e){var t=e.nodeName?e.nodeName.toLowerCase():"",n=D.getNearest(e,O);"select"===t&&n?D.addClass(n,T):D.addClass(e,T)}function o(e){var t=e.nodeName?e.nodeName.toLowerCase():"",n=D.getNearest(e,O);"select"===t&&n?D.removeClass(n,T):D.removeClass(e,T)}function a(t){var n=_?t.validationMessage:t.getAttribute(w);i(t),t.setAttribute(A,""),t.setAttribute(S,"tooltip"),t.setAttribute(k,n),t.setAttribute(R,j),e.broadcast("formvalidatorerrorshown",t)}function s(t){o(t),t.removeAttribute(A),t.removeAttribute(S),t.removeAttribute(k),t.removeAttribute(R),e.broadcast("formvalidatorerrorcleared",t)}
function u(e){for(var t=0,n=P.length;t<n;t++)if(e.name===P[t].name)return!0;return!1}unction l(e,t){var n=t.getAttribute(E);return n&&(e=$t("%1 (%2)","form_validation_error_message_with_fieldname",e,n)),e}function d(e){var t,n=e.validity;if(n.valueMissing)t=$t("Field required.","form_error_required");else if(n.typeMismatch&&"email"===e.type)t=$t("Email address not valid.","form_email_not_valid");else if(n.typeMismatch&&"url"===e.type)t=$t("URL not valid.","form_url_not_valid");else if(n.tooLong)t=$t("Input must be no more than %1 characters.","form_error_too_long",e.maxLength);else if(n.tooShort)t=c(e.minLength);else if((n.rangeOverflow||n.rangeUnderflow)&&""!==e.min&&""!==e.max)t=$t("Value must be between %1 and %2.","form_error_between_values",e.min,e.max);else if(n.rangeUnderflow)t=$t("Value must be greater than or equal to %1.","form_error_under_min",e.min);else if(n.rangeOverflow)t=$t("Value must be less than or equal to %1.","form_error_over_max",e.max);else{if(!(n.stepMismatch||n.typeMismatch||n.patternMismatch||n.badInput))return;t=$t("Input not valid.","form_error_not_valid")}t=l(t,e),e.setCustomValidity(t)}function f(e){return!!r(e)&&(!e.disabled&&!D.getNearest(e,".disabled")&&!(_&&!e.willValidate))}function p(e,t){var n=e.getAttribute(C);if(n)for(var r=n.split(" "),i=0,o=r.length;i<o;i++)if(r[i]===t)return!0;return!1}function h(e){for(var t,n=D.queryAll("input, select, textarea",e),r=[],i=0,o=n.length;i<o;i++)t=n[i],f(t)&&r.push(t);return r}function v(e,t){t=l(t,e),_?(e.setCustomValidity(t),e.removeAttribute(w)):""===t?e.removeAttribute(w):e.setAttribute(w,t)}function m(e,t){v(e,t),e.setAttribute(x,!0),a(e)}unction y(e){var t;if(_){if(e.setCustomValidity(""),e.removeAttribute(x),e.checkValidity(),!e.validity.valid)return d(e),a(e),!1;for(var n=D.getNearest(e,"form"),r=g(),i=0,o=P.length;i<o;i++)if(t=P[i],t.shouldValidate(r,n,e)&&!t.validate(r,n,e))return a(e),!1;return s(e),!0}return!e.hasAttribute(w)}function b(e){function t(e){var t=e.target;r(t)&&t.hasAttribute(x)&&(t.removeAttribute(x),v(t,""),s(t))}D.on(e,"input",t),D.on(e,"change",t)}var _,w="data-form-error",x="data-temp-error",C="data-validator",E="data-error-display-name",T="is-invalid",S="data-focus",k="aria-label",A="data-tooltip",R="data-tooltip-theme",j="error",O=".select-container",N=e.getGlobal("document"),D=e.getService("dom"),P=[];_=t();var I={initForm:function(e){e.setAttribute("novalidate","novalidate");for(var t=h(e),n=0,r=t.length;n<r;n++){var i=t[n],o=i.getAttribute(w);o&&m(i,o)}b(e)},canValidate:f,checkValidity:function(e){if(n(e)){for(var t=h(e),i=!0,o=0,a=t.length;o<a;o++)y(t[o])||(i=!1);return i}if(r(e))return!f(e)||y(e);throw new Error("checkValidity() requires a form, input, select, or textarea element!")},setCustomError:m,addValidationRule:function(e){if("function"!=typeof e.shouldValidate||"function"!=typeof e.validate)throw new Error("Validation rules must have a shouldValidate() function and a validate() function");if("string"!=typeof e.name)throw new Error("Validation rules must have a unique `name` property");u(e)||P.push(e)}};return I.addValidationRule({name:"minlength",shouldValidate:function(e,t,n){return e.hasValidatorAttribute(n,"minlength")},validate:function(e,t,n){var r=n.value,i=parseInt(n.getAttribute("minlength"),10);return!(r&&r.length<i)||(e.setCustomValidity(n,c(i)),!1)}}),I.addValidationRule({name:"non-empty",shouldValidate:validate:function(e,t,n){return!!n.value.trim()||(e.setCustomValidity(n,$t("Field cannot be empty.","field_cannot_be_empty_tooltip")),!1)}}),I}),Box.Application.addService("local-store",function(e){"use strict";function t(e){return i+"/"+o+"/"+e}function n(){try{return r=e.getGlobal("localStorage"),r.setItem(t("TestKey"),"testValue"),r.removeItem(t("TestKey")),!0}catch(e){return!1}}var r,i="localStore",o="0",a={},s=n();return{setItem:function(e,n){if(s)try{r.setItem(t(e),JSON.stringify(n))}catch(e){}else a[e]=n},getItem:function(e){if(!s)return a[e];try{return JSON.parse(r.getItem(t(e)))}catch(e){return null}},removeItem:function(e){if(s)try{r.removeItem(t(e))}catch(e){}else a[e]&&delete a[e]}}}),Box.Application.addService("logger",function(e){"use strict";function t(){var t=e.getGlobal("XMLHttpRequest"),n=e.getGlobal("ActiveXObject");return t?new t:n?new n("Microsoft.XMLHTTP"):null}function n(e,n,r){var i=u+"?"+$.param(e),o=t();null!==o&&("function"==typeof n&&(o.onreadystatechange=function(){4===o.readyState&&(200!==o.status&&204!==o.status&&1223!==o.status||n())}),o.open("GET",i,!r),o.send())}function r(e,n){var r=t();null!==r&&(r.open("POST",e,!0),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),r.send("data="+JSON.stringify(n)))}function i(e){var t=f.getItem(d)||[];t.push(e),f.setItem(d,t)}function o(){var e=f.getItem(d);f.removeItem(d),clearTimeout(s),r(c,e),s=null}function a(t,n,r){var i=[];return i.push("experiment="+encodeURIComponent(t)),i.push("event="+encodeURIComponent(n)),r&&i.push("additional_params="+encodeURIComponent(JSON.stringify(r))),i.push("request_token="+encodeURIComponent(e.getGlobal("request_token"))),i.join("&")}var s,u="/gen204",c="/index.php?rm=box_gen204_batch_record",l=5e3,d="LOGGER_SERVICE_QUEUE",f=e.getService("session-store");return{sendLog:function(e,t,r,i,o,a){r=r||{},o=o||{};var s={category:e,event_type:t,keys_and_values:r,runmode_options:o};n(s,i,a)},sendBatchLog:function(e,t,n,r){n.client_ds=Math.floor((new Date).getTime()/1e3),i({event_type:t,category:e,events:[n]}),r?o():s||(s=setTimeout(o,l))},sendMetric:function(e,t){t=t||{};var r={category:"metrics",event_type:"metrics",keysAndValues:{name:e,value:"+1",type:"counter",tags:t}};n(r)},sendSplitTestLog:function(e,t,r){r=r||{},r.experiment=e;var i={category:"experiment_data",event_type:t,keys_and_values:r};n(i)},sendSplitTestConversion:function(e,n,r){var i=t();if(null!==i){var o=a(e,n,r);i.open("POST","/index.php?rm=experiment_convert",!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),i.send(o)}}}}),Box.Application.addService("menu-toggle",function(e){"use strict";unction n(){if(f){var e=f.menuEl,n=u.getNearestUnbounded(e,".menu-wrapper");u.removeClass(n,d),setTimeout(100),t("closed"),f=null}}function r(e,r){var i=e.nextElementSibling;if(i){for(;"BUTTON"===i.nodeName&&!u.isVisible(i);)if(i=i.nextSibling,!i)return;if("UL"===i.nodeName||(i=u.queryAll(".menu",i),i.length)){var o=u.getNearestUnbounded(i,".menu-wrapper");if(u.hasClass(o,d))return void n();f&&n(),f=r,f.menuEl=i,o=u.getNearestUnbounded(i,".menu-wrapper"),c.wrap(o),i.style.display="block",setTimeout(function(){u.addClass(o,d)},100),t("opened")}}}function i(e){var t=e.target||e.srcElement;if(!t)return null;if(t.getAttribute("data-type")===l)return t;for(;;){if(t=t.parentNode,!t||t===document.body||!t.getAttribute)return null;if(t.getAttribute("data-type")===l)return t}}function o(e){var t=e.target||e.srcElement;return!!u.getNearestUnbounded(t,".menu")}function a(e){if(f){var r=i(e);if(r){var a=r.nextElementSibling;if(!a||a===f.menuEl)return}o(e)||(t("lostfocus"),n())}}function s(e){this.events=new Box.EventTarget,this.menuEl=null,this.shouldCloseMenuOnBlur="undefined"==typeof e||e,this.wrappedGlobalClickHandler=function(e){a(e)}}var u,c,l="menu-toggle-button",d="is-visible",f=null;return s.prototype={init:function(){u=e.getService("dom"),c=e.getService("focus"),this.shouldCloseMenuOnBlur&&u.on(document.body,"mousedown",this.wrappedGlobalClickHandler)},destroy:function(){this.shouldCloseMenuOnBlur&&u.off(document.body,"mousedown",this.wrappedGlobalClickHandler)},showMenu:closeMenu:function(){n()},on:function(e,t){this.events.on(e,t)},off:function(e,t){this.events.off(e,t)}},{create:function(e){return new s(e)}}}),Box.Application.addService("promises",function(e){"use strict";return Promise.longStackTraces(),Promise.customUnhandledRejectionHandlerDisabled||Promise.onPossiblyUnhandledRejection(function(t,n){var r=n.reason();"undefined"!=typeof r&&("[object Object]"===t.message&&(t.message="Missing an error or rejection handler for "+(r.data||"a promise")),e.reportError(t))}),{CancellationError:Promise.CancellationError,TimeoutError:Promise.TimeoutError,all:Promise.all,settle:Promise.settle,some:Promise.some,one:function(e){var t,n=[],r=0;return new Promise(function(i,o){function a(i){return function(a){n[i]=a,++r===e.length&&(t=new Error("no promises resolved"),t.errors=n,o(t))}}e.forEach(})},any:Promise.any,create:createResolved:function(e){return Promise.resolve(e)},createRejected:function(e){return Promise.reject(e)},createCancellable:function(e){return new Promise(e).cancellable()}}}),Box.Application.addService("resin",function(e){"use strict";function t(){if(o=e.getService("browser"),!c&&(!o.isIE()||o.isMinBrowser("explorer","10"))){var t=e.getGlobalConfig("showResinTagTracker");r=e.getGlobal("Resin"),a=e.getService("logger"),s=e.getGlobal("document"),t?(i=e.getService("resin-tag-tracker"),i.trackTags()):r.start(function(e){var t=e.data.client;delete e.data.client,e.data.data&&(e.data.data=JSON.stringify(e.data.data)),a.sendBatchLog("resin",t,e.data)},{events:{click:"mouseup",keypress:"keydown"}}),c=!0}}function n(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}var r,i,o,a,s,u="data-resin-target",c=!1,l={recordAction:function(e){c&&r&&(e.client="web",e.application||(e.application=s.body.getAttribute("data-resin-application")),e.page||(e.page=s.body.getAttribute("data-resin-page")),r.recordAction(e))},recordActionFromElement:function(e,t){if(c&&!e.getAttribute("data-resin-target")){var r=this.getActionAttributes(e);this.recordAction({application:this.sanitize(t.application||r.application),page:this.sanitize(t.page||r.page),component:this.sanitize(t.component||r.component),feature:this.sanitize(t.feature||r.feature),target:this.sanitize(t.target||r.target),action:this.sanitize(t.action||r.action),data:n(r.data,t.data||{})})}},getSessionId:getActionAttributes:function(e){var t,n={};return c&&r&&(t=e.hasAttribute(u),t||e.setAttribute(u,""),n=r.getActionAttributes(e),t||e.removeAttribute(u)),n},sanitize:;return t(),l}),Box.Application.addService("resin-tag-tracker",function(e){"use strict";unction n(e){var t=e.split("").reduce(function(e,t){return("string"==typeof e?e.charCodeAt(0):e)+t.charCodeAt(0)})%h.length;return h[t]}function r(e){if(!t(e)){var r=f.show(e,{tooltipText:"x",tooltipPosition:"bottom"});r&&(r.style.cursor="pointer",d.query(".tooltip-inner",r).style.backgroundColor=n(e.getAttribute("data-resin-target")),d.on(r,"contextmenu",,d.on(r,"click",function(t){t.preventDefault();var n=new CustomEvent("tagtracker",{bubbles:!0});e.dispatchEvent(n)}))}}function i(e){var t=e.keyCode||e.which;114===t&&(e.preventDefault(),e.stopPropagation(),a())}function o(){var e=p.createTemplateFragment(v);c.body.appendChild(e),s=d.query(".tag-tracker-events",c.body),d.on(c.body,"keypress",i),l.start(function(e){var t=m,r=$.extend(e.data,{color:n(e.data.target)}),i=r.data;i&&"object"==typeof i&&Object.getOwnPropertyNames(i).length&&(t+="<div>-----Custom Data-----</div>",r.data=Object.getOwnPropertyNames(i).forEach(function(e){r[e]=i[e],t+="<div>"+e+": <%= "+e+" %></div>"})),t+="</li>";var o=p.createTemplateFragment(t,r);s.insertBefore(o,s.firstChild)},{events:{click:"tagtracker"}}),g=!0}function a(){g||o(),f.hideAll(),u=d.queryAll("[data-resin-target]",c),[].forEach.call(u,r)}var s,u,c=e.getGlobal("document"),l=e.getGlobal("Resin"),d=e.getService("dom"),f=e.getService("tooltips-amsterdam"),p=e.getService("templates"),h=["#26C281","#22A7F0","#DF6CE2","#FFDA04","#0EA5F3","#F03354"],v='<div class="tag-tracker-hud"><ul class="tag-tracker-events"><li>Press \'r\' to refresh tags</li><li>Left click a tag to trigger the event</li><li>Right click a tag to hide it</li></ul></div>',m='<li style="color: <%= color %>"><div>Application: <%= application %></div><div>Page: <%= page %></div><div>Component: <%= component %></div><div>Feature: <%= feature %></div><div>Target: <%= target %></div>',g=!1;return{trackTags:a,destroy:function(){g&&(d.off(c.body,"keypress",i),l.stop())}}}),Box.Application.addService("templates",function(e){"use strict";unction n(e,n){return n?e.replace(/<%=\s*(\w+)\s*%>/g,function(e,r){var i=n[r]||"";return i?t(i):""}):e}var r=/[<>"&'\/`]/g,i={"<":"&lt;",">":"&gt;",'"':"&quot;","&":"&amp;","'":"&#x27;","/":"&#x2f;","`":"&#x60;"},o=document;return{escapeHTML:t,getTemplateHTML:function(e,t){var r=o.getElementById("jst-"+e),i="";if(r){if(i=r.text.replace(/^\s+|\s+$/g,""))return n(i,t);throw new Error('Template "'+e+'" is an empty string.')}throw new Error('Template "'+e+'" not found.')},createTemplateFragment:function(t,r){if("string"!=typeof t)throw new TypeError("Template text must be a string.");var i=e.getService("dom"),o=n(t,r);return i.createFragmentFromHtml(o)},getTemplateFragment:function(t,n){var r=e.getService("dom"),i=this.getTemplateHTML(t,n);return r.createFragmentFromHtml(i)}}}),Box.Application.addService("session-store",function(e){"use strict";unction n(){try{return r=e.getGlobal("sessionStorage"),r.setItem(t("TestKey"),"testValue"),r.removeItem(t("TestKey")),!0}catch(e){return!1}}var r,i="sessionStore",o="0",a={},s=n();return{setItem:function(e,n){if(s)try{r.setItem(t(e),JSON.stringify(n))}catch(e){}else a[e]=n},getItem:function(e){if(!s)return a[e];try{return JSON.parse(r.getItem(t(e)))}catch(e){return null}},removeItem:function(e){if(s)try{r.removeItem(t(e))}catch(e){}else a[e]&&delete a[e]},removeAll:function(){if(s)try{r.clear()}catch(e){}else Object.keys(a).length>0&&(a={})}}}),Box.Application.addService("tooltips-amsterdam",function(e){"use strict";function t(){}function n(e,t){t=t||"body";var n=$(e),r=$(t),i=$.extend({},n.offset(),{width:n.outerWidth(),height:n.outerHeight()});return"body"!==t&&(i.left=n.offset().left-r.offset().left,i.top=n.offset().top-r.offset().top),i.right=i.left+i.width,i.bottom=i.top+i.height,i}function r(e,t,r){var i=n(e),o=n(t),a=$(document),s=a.height(),u=a.width();switch(r){case"top":return i.top-o.height>0;case"bottom":return i.bottom+o.height<s;case"left":return i.left-o.width>0;case"right":return i.left+i.width+o.width<u;default:return!1}}unction o(t,n,r){var i,o=S.getBoundingClientRect(t).width,a=r.left,s=e.getGlobal("document"),u=s.body.clientWidth;"bottom"!==n&&"top"!==n||(a<0?r.left=0:a+o>u&&(i=a+o-u,r.left=a-i)),t.style.left=r.left+"px",t.style.top=r.top+"px"}function a(e,t){return e.top+(e.height-t.height)/2}function s(e,t){return e.left+(e.width-t.width)/2}function u(e,t){return{left:e.left+e.width+L,top:a(e,t)}}function c(e,t){return{left:e.left-t.width-L,top:a(e,t)}}function l(e,t){return{left:s(e,t),top:e.top-t.height-L}}function d(e,t){return{left:s(e,t),top:e.top+e.height+L}}function f(e,t,r,i){var o=n(i,e),a=n(r,e);switch(t){case"right":return u(a,o);case"left":return c(a,o);case"bottom":return d(a,o);case"top":return l(a,o);default:return u(a,o)}}function p(e){var t=e.getAttribute("aria-describedby"),n=R[t];n&&(e.removeAttribute("aria-describedby"),S.removeClass(e,D),$(n).fadeOut("fast").remove(),delete R[t],j--)}unction v(){if(j){for(var e=S.queryAll("["+I+"]"),t=0;t<e.length;t++)p(e[t]);h()}}function m(){var t=e.getGlobal("window");t.addEventListener&&t.addEventListener("scroll",v,!0),A=!0}function g(t){var n=e.getGlobal("document"),r=k.createTemplateFragment(T,t),i=$(t.tooltipRelative);if(!i.length)throw new Error("Tooltip relative container does not exist");return i.append(r),R[t.id]=n.getElementById(t.id),j++,A||m(),R[t.id]}function y(e,t){if(!t.text)return null;if(!$(e).is(":visible"))return null;var n=R[t.id]||g(t);if("body"===t.tooltipRelative&&(n.style.left=0,n.style.top=0),!r(e,n,t.tooltipPosition)){var a=t.tooltipPosition;t.tooltipPosition=F[t.tooltipPosition],i(n,a,t.tooltipPosition)}return e.setAttribute("aria-describedby",t.id),o(n,t.tooltipPosition,f(t.tooltipRelative,t.tooltipPosition,e,n)),S.addClass(e,D),$(n).show(),n}function b(e){do e+=Math.floor(1e6*Math.random());while(document.getElementById(e));return e}function _(e,t){return $.inArray(e,t)>-1}function w(e,n,r){var i=r.tooltipTrigger.split(" ");return _("click",i)&&"click"===e?N.TOGGLE:"focusin"===e&&_("focus",i)&&!S.hasClass(n,D)?N.SHOW:"focusout"===e&&_("focus",i)&&S.hasClass(n,D)?N.HIDE:"mouseover"===e&&_("hover",i)&&!S.hasClass(n,D)?N.SHOW:"mouseout"===e&&_("hover",i)&&S.hasClass(n,D)?n===document.activeElement&&_("focus")?t():N.HIDE:t()}function x(e){var t=$(e);return{tooltip:t.attr("data-tooltip"),tooltipTrigger:t.attr("data-tooltip-trigger"),tooltipPosition:t.attr("data-tooltip-position"),tooltipTheme:t.attr("data-tooltip-theme"),tooltipText:t.attr("data-tooltip-text"),tooltipRelative:t.attr("data-tooltip-relative")}}function C(e,t){if($(e).is($(t.tooltipRelative)))throw new Error("Tooltip cannot be configured relative to itself")}function E(e,t){var n=$.extend({},O,x(e),t);return n.text=n.tooltipText||e.getAttribute(I+"-text")||e.getAttribute("aria-label"),n.id=e.getAttribute("aria-describedby")||b("tooltip"),C(e,n),n}var T='<div id="<%= id %>" class="tooltip-amsterdam <%= tooltipPosition %> <%= tooltipTheme %>" role="tooltip"><div class="tooltip-inner"><%= text %></div></div>',S=e.getService("dom"),k=e.getService("templates"),A=!1,R={},j=0,O={tooltipPosition:"right",tooltipTrigger:"hover focus",tooltipRelative:"body"},N={TOGGLE:"toggle",HIDE:"hide",SHOW:"show"},D="tooltip-active",P=".tooltip-amsterdam",I="data-tooltip",F={right:"left",left:"right",top:"bottom",bottom:"top"},L=10;return{handleEvent:function(e){var t=S.getNearest(e.target,"["+I+"]");if(t){var n=E(t);switch(w(e.type,t,n)){case N.SHOW:this.show(t,n);break;case N.HIDE:this.hide(t,n);break;case N.TOGGLE:this.toggle(t,n);break;default:return}}},show:hide:hideAll:function(){v()},toggle:function(e,t){S.hasClass(e,D)?this.hide(e,t):this.show(e,t)}}}),Box.Application.addService("url-amsterdam",function(){"use strict";ction r(n){if("string"==typeof n||"number"==typeof n)return t(n);for(var r=[],i=e(n).sort(),o=0;o<i.length;o++){var a=i[o],s=n[a];void 0===s?r.push(t(a)):r.push(t(a)+"="+t(s))}return r.join("&")}function i(e,t){if(!e||"?"===e)return{};e&&"?"===e[0]&&(e=e.substr(1));for(var r=e.split("&"),i={},o=0,a=r.length;o<a;o++){var s=r[o].split("=");!s[0]||t&&void 0===s[1]||(i[n(s[0])]=n(s[1]))}return i}return{encode:r,decode:i}}),Box.Application.addService("xhr",function(e){"use strict";function t(e,t,n,i){i=i||{};var o;if(window.XMLHttpRequest)o=new XMLHttpRequest;else{if(!window.ActiveXObject)return null;o=new ActiveXObject("MSXML2.XMLHTTP.3.0")}return o.open(e,t,!0),i.corsRequest||(o.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.requestToken&&o.setRequestHeader("X-Request-Token",r.requestToken)),"string"==typeof n&&o.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),o.send(n||null),o}var n=e.getService("promises"),r=e.getGlobalConfig();return{send:function(e,r,i,o){var a=t(e,r,i,o),s=!1,u=n.create(function(e,t){a.onreadystatechange=function(){return s?null:void(4===a.readyState&&(2===(a.status/100|0)?e(a):t(a)))},a.onerror=function(){return s?null:void t(a)}});return u.abort=u},parseJSONResponse:function(e){return n.create(function(t,n){var r;try{r=JSON.parse(e.responseText)}catch(e){return void n(e)}t(r)})},handleLegacyAJAXResponse:function(e){return n.create(function(t,n){var r;try{r=JSON.parse(e.responseText)}catch(e){return void n(e)}return"data"in r?void t(r.data):void n(r)})}}}),Box.Application.addService("notifications-amsterdam",function(e){"use strict";function t(){return r?r:(r=d.createElement("div"),r.className="notifications-wrapper",d.body.appendChild(r),r)}function n(e,t,n){this.type=e,this.title=t,this.buttons=n,this.uniqueID="notification_"+(new Date).getTime(),this.shown=!1,this.elem=null,this.promise=null}var r,i="info",o="warn",a="error",s=27,u=4e3,c=e.getService("dom"),l=e.getService("promises"),d=e.getGlobal("document"),f=0;return n.prototype.show=function(e){if(this.shown)return this.promise;this.shown=!0;var n=this.elem=d.createElement("div");n.className="notification is-hidden notification-type-"+this.type,n.setAttribute("role","alert"),n.setAttribute("aria-labeledby",this.uniqueID+"_label");var r=d.createElement("span");r.id=this.uniqueID+"_label",c.setText(r,this.title),n.appendChild(r);var i=bind(this);return this.promise=l.create(function(r,i){this.buttons&&this.buttons.forEach(function(e,t){var i=d.createElement("button");i.className="btn notification-btn",i.setAttribute("data-button-index",t),c.setText(i,e),n.appendChild(i),n.className+=" has-btn",c.on(i,"click",r)});var o=d.createElement("button");o.className="notification-close-btn",c.setHTML(o,"&#10005;"),o.title=$t("Close","notification_close"),n.appendChild(o),c.on(o,"click",i),t().appendChild(n),setTimeout(function(){c.removeClass(n,"is-hidden"),f++},100),e!==-1&&setTimeout(i,e)}.bind(this)),this.promise.then(i,i),c.on(d.body,"keydown",bind(this)),this.promise},n.prototype.hide=function(){this.shown&&(this.elem.style.marginTop="-"+(this.elem.clientHeight+10)+"px",c.addClass(this.elem,"is-hidden"),setTimeout(function(){this.elem.parentNode&&this.elem.parentNode.removeChild(this.elem),f--}.bind(this),250))},{info:function(e,t){return this._show(i,e,t)},confirm:warn:error:function(e,t){return t=t||{},t.duration=t.duration||-1,this._show(a,e,t)},create:_show:function(e,t,n){n=n||{},n.duration=n.duration||u,n.buttonText&&"string"==typeof n.buttonText&&(n.buttonText=[n.buttonText]);var r=this.create(e,t,n.buttonText||null),i=r.show(n.duration);return n.clickHandler=n.clickHandler||function(){},n.hideHandler=n.hideHandler||function(){},n.onhide=n.onhide||function(){},i.then(n.clickHandler,n.hideHandler),i.then(null,n.onhide),i}}}),Box.Application.addService("popups-amsterdam",function(e){"use strict";function t(e,t){var n=new Box.EventTarget;this.on=function(){n.on.apply(n,arguments)},this.fire=setTimeout(function(){g.on(t,"click",},500),g.on(e,"click",function(e){e.stopPropagation();var t=g.getNearest(e.target||e.srcElement,"[data-event-type]");t&&n.fire(t.getAttribute("data-event-type"),e)}),g.on(e,"keyup",function(e){27===e.keyCode&&(n.fire("close",e),e.stopPropagation(),e.preventDefault())});var r=this;n.on("close",function(){r.close()})}function n(e,n){var r=this.elem=document.createElement("div");r.className="popup-wrapper disable_selectable",r.setAttribute("data-resin-page","popupsamsterdam"),r.setAttribute("data-resin-component","wrapper"),r.setAttribute("data-resin-feature","interactions"),this.spinnerElem=w.getTemplateFragment("spinner-light-large");var i=this.innerElem=document.createElement("div");i.className=n?"popup "+n:"popup",i.setAttribute("tabindex","-1"),e instanceof Element?(i.appendChild(e),r.appendChild(i)):"string"==typeof e?(g.setHTML(i,e),r.appendChild(i)):g.addClass(r,m),t.call(this,i,r)}function r(){i||(i=setTimeout(50))}var i,o='<button class="btn-plain popup-x-btn" title="<%=closeBtnText%>" data-event-type="close" data-resin-target="closebutton"><span class="accessibility-hidden"><%=closeBtnText%></span>&times;</button><div class="popup-contents"><h2 class="popup-heading"><%=heading%></h2><p class="mbn"><%=message%></p><div class="popup-btn-group"><button class="btn btn-primary" data-event-type="close">'+$t("Okay","alert_popup_button_title")+"</button></div></div>",a='<button class="btn-plain popup-x-btn" title="<%=closeBtnText%>" data-event-type="close" data-resin-target="closebutton"><span class="accessibility-hidden"><%=closeBtnText%></span>&times;</button><div class="popup-contents"><h2 class="popup-heading"><%=heading%></h2><p><%=message%></p><form>\t<input class="popup-prompt-input" type="text" <%=required%> placeholder="<%=placeholder%>" value="<%=defaultValue%>" pattern="<%=pattern%>" title="<%=title%>"><div class="popup-btn-group"><button class="btn popup-cancel-btn" data-event-type="close" type="button">'+$t("Cancel","popup_prompt_button_cancel")+'</button><button class="btn btn-primary" data-event-type="ok">'+$t("Okay","alert_popup_button_title")+"</button></div></form></div>",s='<button class="btn-plain popup-x-btn" title="<%=closeBtnText%>" data-event-type="close" data-resin-target="closebutton"><span class="accessibility-hidden"><%=closeBtnText%></span>&times;</button><div class="popup-contents"><h2 class="popup-heading"><%=heading%></h2><p class="mbn"><%=message%></p><div class="button-bar"><button class="btn popup-cancel-btn" data-event-type="cancel"><%=cancelBtnText%></button><button class="btn btn-primary popup-confirm-btn" data-event-type="ok"><span class="btn-text"><%=okBtnText%></span></button></div></div>',u='<button class="btn-plain popup-x-btn" title="<%=closeBtnText%>" data-event-type="close" data-resin-target="closebutton"><span class="accessibility-hidden"><%=closeBtnText%></span>&times;</button><div class="popup-contents"></div>',c=$t("Okay","popup_generic_button_okay"),l=$t("Cancel","popup_generic_button_cancel"),d=$t("Close","popup_generic_button_close"),f=$t("required","required_parameter"),p=$t("Error","popup_generic_failure_message_title"),h=$t("An error has occurred while loading this feature.","popup_generic_failure_message"),v="is-disabled",m="is-loading",g=e.getService("dom"),y=e.getService("focus"),b=e.getService("nav"),_=e.getService("promises"),w=e.getService("templates"),x=e.getService("tooltips-amsterdam"),C=!1,E=[],T=0;return n.prototype.show=function(){document.body.appendChild(this.elem),x&&x.hideAll(),T++,g.addClass(document.body,"has-active-popup"),E.push(this)},n.prototype.focus=function(){this._focusActivated||(y.wrap(this.elem,!0),this._focusActivated=!0)},n.prototype.resize=function(e){for(var t=this.innerElem.childNodes,n=0,r=0;r<t.length;r++)if(t[r].offsetHeight&&!g.hasClass(t[r],"popup-x-btn")){var i=t[r].currentStyle;i||(i=getComputedStyle(t[r])),n+=t[r].offsetHeight+parseInt(i.marginTop,10)+parseInt(i.marginBottom,10)}this.innerElem.style.height=n+"px",e&&(this.innerElem.style.width=e)},n.prototype.close=function(){if(this.elem.parentNode&&!C){x&&x.hideAll(),e.stopAll(this.elem),this.elem.parentNode.removeChild(this.elem),T--,T||g.removeClass(document.body,"has-active-popup");for(var t=0;t<E.length;t++)if(E[t]===this)return void E.splice(t,1)}},n.prototype.setContent=function(e){g.removeClass(this.elem,m);var t=g.query(".popup-contents",this.innerElem);g.setHTML(t,e)},n.prototype.query=function(e){return this.innerElem.querySelector(e)},n.prototype.queryAll=n.prototype.$=function(e){return this.innerElem.querySelectorAll(e)},{_triggerPageReload:r,create:alert:function(e,t){var n=this.create();return _.create(function(r){var i=w.createTemplateFragment(o,{closeBtnText:d,heading:t,message:e});n.innerElem.appendChild(i),n.elem.appendChild(n.innerElem),n.show(),n.focus(),n.resize(),n.on("close",r)})},prompt:function(e){var t=this.create();return _.create(function(n){e.closeBtnText||(e.closeBtnText=d),e.isOptional||(e.required=f);var r=w.createTemplateFragment(a,e);t.innerElem.appendChild(r),t.elem.appendChild(t.innerElem);var i=g.query("input",t.elem);t.show(),t.focus(),t.resize(),e.defaultValue&&i.select(),t.on("ok",function(){i.checkValidity&&!i.checkValidity()||(t.close(),n(i.value))}),g.query("form",t.elem).addEventListener("submit",})},confirm:function(e,t,n){=n||{};var i=this.create(),o=_.create(function(r,o){var a=w.createTemplateFragment(s,{closeBtnText:d,heading:t,message:e,okBtnText:n.confirmText||c,cancelBtnText:n.cancelText||l});i.innerElem.appendChild(a),i.elem.appendChild(i.innerElem);var u=i.query(".popup-confirm-btn"),f=w.getTemplateFragment("spinner");u.appendChild(f),i.show(),i.focus(),i.resize(),i.on("ok",function(){r()}),i.on("cancel",function(){o()})});return n.isBlocking||i.on("ok",r),i.on("cancel",r),o},open:function(t,n){n=n||{};var r=this,i=e.getService("ajax"),o=this.create(),a=w.createTemplateFragment(u,{closeBtnText:d});o.innerElem.appendChild(a),o.elem.appendChild(o.spinnerElem),o.show(),o.hasLoaded=!1,o.on("close",;var s=n.data||{};s["!popup"]="yesplease";var c=n.isPostRequest?i.post:i.get;return c(t,s).then(function(e){o.elem.appendChild(o.innerElem),o.setContent(e.data.html),o.focus(),o.resize(n.width),g.addClass(o.innerElem,"is-active"),o.hasLoaded=!0},function(t){"JSON Parse Error"===t.message&&e.reportError("Popup being retrieved is not configured with $this->setUpPopup();"),o.hasLoaded=!0,o.close();var n=t.data||{};r.alert(n.message||h,p)}),o},resize:function(){var e;if(0!==E.length)for(var t=0;t<E.length;t++)e=E[t],e.hasLoaded&&e.resize()},close:function(e){var t,n=!1;if(e=e||{},!E.length)return void(e.alternateDestination&&b.navigate(e.alternateDestination));e.enableClose&&(C=!1);do t=E.shift(),t.hasLoaded&&(n=!0),t.close();while(E.length);n&&!e.unsafeSkipRefresh&&this._triggerPageReload()},showConfirmBlockingState:function(){if(E.length){var e=E[E.length-1],t=e.query(".popup-confirm-btn"),n=e.query(".popup-cancel-btn");t&&(g.addClass(t,m),g.addClass(t,v)),n&&g.addClass(n,v),C=!0}},anyPopupsOpen:}),Box.Application.addService("nav",function(e){"use strict";function t(){var e=y.getItem(d);return e?JSON.parse(e):null}function n(e,n){this.toState={url:e,data:n},this.fromState=t(),this.continueNavigation=!0}function r(e,t){if(!e)throw new TypeError("Invalid URL provided for Ajax navigation.");var r=l._getRelativeURL(e);return v.create(function(e){var i=new n(r,t),o=b.beforeStateChange.map(;v.all(o).then(})}unction o(e){if(!e)return null;for(var t=b.intercept,n=e.split("?")[0],r=0,i=t.length;r<i;r++)if(t[r].regex.test(n))return t[r];return null}function a(){var e=m.getState()||{},t={url:e.hash?e.hash.replace(/[?&]_suid=\d+/,""):g.pathname+g.search,data:e.data?e.data.data:null};return t.url=t.url.replace(/\?$/,""),t.title=e.title||p.title,t}function s(){y.setItem(d,JSON.stringify(a()))}function u(){var e=a();m.replaceState(e,e.title,e.url)}function c(t){s(),e.broadcast("navigationend",t)}var l,d="nav:state",f=e.getGlobal("$"),p=e.getGlobal("document"),h=e.getService("dom-fragment"),v=e.getService("promises"),m=e.getGlobal("History"),g=e.getGlobal("location"),y=e.getGlobal("sessionStorage"),b={intercept:[],beforeStateChange:[]},_=!1;return n.prototype.updateState=function(e,t){e&&(this.toState.url=e),t&&(this.toState.data=t)},n.prototype.stopNavigation=function(){this.continueNavigation=!1},l={registerBeforeStateChange:function(e){var t=b.beforeStateChange,n=t.some(;if(n)throw new TypeError("beforeStateChange handler already registered: "+e);
t.push(e)},unregisterBeforeStateChange:function(e){for(var t=b.beforeStateChange,n=0,r=t.length;n<r;n++)t[n]===e&&t.splice(n,1)},_coreNavigate:function(t,n){var r=t.url,a=o(r),s=n.url,u=o(s),l=!0,d={from:n,to:t};return e.broadcast("navigationstart",d),u&&u.exit&&(l=u.exit(t,n)),a&&a.enter&&(l=a.enter(t,n)&&l),v.create(function(e){return l?void f.ajax({method:"get",url:r,dataFilter:function(e){return e}}).done(function(t,n,r){h.update(r.responseText),c(d),e()}).fail(function(){i(r)}):(c(d),void e())})},_getRelativeURL:function(e){"?"===e.charAt(0)&&(e=g.pathname+e);var t=p.createElement("a");t.href=e;var n="/"===t.pathname.charAt(0)?t.pathname:"/"+t.pathname;return n+t.search},init:function(){_||(u(),m.Adapter.bind(window,"statechange",function(){var e=m.getState(),n=e.data,r=t();this._coreNavigate(n,r)}.bind(this)),s(),_=!0)},destroy:function(){f(window).unbind("statechange"),_=!1},getState:function(){var e=m.getState();return e&&e.data?e.data.data:null},intercept:function(t,n){n.enter||n.exit||e.reportError(new TypeError("Second argument missing enter and exit methods.")),b.intercept.push({regex:t,enter:n.enter,exit:n.exit})},removeInterceptor:navigate:function(e,t){r(e,t).then(function(e){m.pushState(e,p.title,e.url)})},redirect:function(e){i(e)},replace:function(e,t){r(e,t).then(},refresh:function(){var e=t();return this._coreNavigate(e,e)},reload:function(e){g.reload(e)},navigateOrRefresh:function(e,n){var r=t();r&&r.url===e?this._coreNavigate(r,r):this.navigate(e,n)}}}),Box.Application.addService("url",function(e){"use strict";unction n(){return r.location.pathname&&0===r.location.pathname.indexOf("/master/content")}var r=e.getGlobal("window"),i=/\+/g,o=/([^&=]+)=?([^&]*)/g,a=/\?(.*)/;return{getCurrentWindowUrl:getHostDomain:function(){var e=r.location.hostname.split("."),t=e.length;return e[t-2]+"."+e[t-1]},getGcmCompatibleRm:function(e){return n()&&(e="box_master_gcm_"+e),e},getGcmCompatibleRmUrl:updateQueryStringParameter:function(e,t,n){var r=new RegExp("([?&])"+t+"=.*?(&|$)","i"),i=e.indexOf("?")!==-1?"&":"?",o=!n&&"number"!=typeof n,a=e.match(r),s=encodeURIComponent(t),u=encodeURIComponent(n);return o&&a?e.replace(r,""):o?e:a?e.replace(r,"$1"+s+"="+u+"$2"):e+i+s+"="+u},createUrl:function(e,t){var n,r;"?"===e[e.length-1]&&(e=e.slice(0,e.length-1));for(r in t)t.hasOwnProperty(r)&&(n=t[r],e=this.updateQueryStringParameter(e,r,n));return e},goToUrl:function(t){var n=e.getGlobal("open_link_in_new_window"),i=e.getGlobal("path_prefix");return t=this.addAdditionalContext(t),n&&t&&i&&t.indexOf(i)<0?void r.open(t):void(r.location.href=t)},goToUrlInBackground:function(t){var n=e.getService("dom"),r=e.getGlobal("document"),i=n.query("#downloadiframe"),o=!1;i||(i=r.createElement("iframe"),o=!0),t=this.addAdditionalContext(t),i.src=t,i.style.display="none",i.setAttribute("id","downloadiframe"),o&&r.body.appendChild(i)},openWindow:function(e,t,n,i){return e?(t=t||"",n=n||"",i=i||!1,e=this.addAdditionalContext(e),r.open(e,t,n,i)):null},addAdditionalContext:function(t){var n=e.getGlobal("additional_context");if(n&&t.indexOf("additional_context")<0){var r="additional_context="+encodeURIComponent(n);t+=(t.indexOf("?")>0?"&":"?")+r}return t},formatLegacyQueryParams:function(e){function t(e){for(var n in e)e.hasOwnProperty(n)&&("object"==typeof e[n]?t(e[n]):"boolean"==typeof e[n]&&(e[n]=e[n]?1:0))}return t(e),{q:e}},encodePathComponent:function(e){return e=encodeURIComponent(e).replace(/%2F/g,"%252F").replace(/%23/g,"%2523").replace(/%26/g,"%2526")},decodePathComponent:function(e){return e=e.replace(/%2526/g,"%26").replace(/%2523/g,"%23").replace(/%252F/g,"%2F"),t(e)},getQueryParams:function(e){var n,r,i=e.match(a),s={};if(i)for(r=i[1];n=o.exec(r);)s[t(n[1])]=t(n[2]);return s},getQueryParamString:}),Box.Application.addService("window-popup",function(e){"use strict";function t(e,t){var n;n=setInterval(function(){try{(null===e||e.closed)&&(clearInterval(n),t())}catch(e){}},r)}function n(e,t){t=t||{},this.url=e,this.options=$.extend(!0,{},i,t)}var r=1e3,i={popupName:"BoxPopup",queryParams:{},width:270,height:320,left:500,top:200,toolbar:0,scrollbars:1,status:0,resizable:1,location:1,menuBar:0};return n.prototype={popup:null,url:null,options:null,closeCallback:null,closeIntervalId:null,_getPopupUrl:function(){var e=this.url.indexOf("?")>-1?"&":"?";return this.url+($.isEmptyObject(this.options.queryParams)?"":e+$.box.formatQuery(this.options.queryParams))},_getPopupConfiguration:function(){var t,n=e.getGlobal("screen");return t={width:this.options.width,height:this.options.height,toolbar:this.options.toolbar,scrollbars:this.options.scrollbars,status:this.options.status,resizable:this.options.resizable,location:this.options.location,menuBar:this.options.menuBar,left:n?(n.availWidth-this.options.width)/2:this.options.left,top:n?(n.availHeight-this.options.height)/2:this.options.top},$.param(t).replace(/&/g,",")},setCloseCallback:function(e){this.closeCallback=e},show:function(){var n=e.getService("url"),r=this._getPopupUrl(),i=this._getPopupConfiguration();this.popup&&!this.popup.closed?this.popup.focus():(this.popup=n.openWindow(r,this.options.popupName,i),this.closeCallback&&t(this.popup,this.closeCallback))},hide:,{create:function(e,t){return new n(e,t)}}}),Box.Application.addService("dom-fragment",function(e){"use strict";var t=e.getService("dom"),n=e.getService("tooltips-amsterdam");return{setContentFor:function(r){for(var i,o,a,s=0,u=r.length;s<u;s++){if(a=r[s],i=a.getAttribute("data-content-for"),o=t.query(i),!o)return void e.reportError("Could not find "+i);if(e.stopAll(o),e.hasService("tooltips-amsterdam")&&n.hideAll(),$(o).empty(),"TITLE"===o.tagName)document.title=a.firstChild.nodeValue;else for(;a.firstChild;)o.appendChild(a.firstChild);e.startAll(o)}},addClassFor:function(e){e.forEach(function(e){var n=e.getAttribute("data-add-class-for"),r=e.getAttribute("data-class"),i=t.query(n);t.addClass(i,r)})},removeClassFor:function(e){e.forEach(function(e){var n=e.getAttribute("data-remove-class-for"),r=e.getAttribute("data-class"),i=t.query(n);t.removeClass(i,r)})},update:function(e){var n={"[data-content-for]":this.setContentFor,"[data-add-class-for]":this.addClassFor,"[data-remove-class-for]":this.removeClassFor},r=t.createFragmentFromHtml(e);for(var i in n)if(n.hasOwnProperty(i)){var o=Array.prototype.slice.call(r.querySelectorAll(i)),a=n[i];a(o)}}}}),function(){"use strict";function e(t,n){var r=[];for(var i in t)t.hasOwnProperty(i)&&("object"==typeof t[i]?r.push(e(t[i],n?n+"["+i+"]":i)):n?r.push(n+"["+i+"]="+encodeURIComponent(t[i])):r.push(i+"="+encodeURIComponent(t[i])));return r.join("&")}function t(t){var n;if(window.XMLHttpRequest)n=new XMLHttpRequest;else{if(!window.ActiveXObject)return;n=new ActiveXObject("MSXML2.XMLHTTP.3.0")}n.open("get","/gen204?"+e(t),!0),n.send(null)}function n(e){var t=window.performance;if(t){var n=t.timing,r=t.navigation;if(r&&(e.nt_red_cnt=r.redirectCount,e.nt_nav_type=r.type),n)for(var i in n)i in s&&n[i]&&(e[s[i]]=n[i])}}function r(){var e={current_rm:Box.Application.getGlobalConfig("currentRm")||"unknown",datacenterTag:Box.Application.getGlobalConfig("datacenterTag")||"unknown",uri:window.location.href,is_old:window.initial_config||Box.Application.getGlobalConfig("browser_is_old"),version:a.version},r={category:"boomerang",event_type:"beacon",keys_and_values:e,runmode_options:{splunk:1,add_geo:1}};n(e),e.nt_load_end&&e.nt_nav_st&&(e.t_done=e.nt_load_end-e.nt_nav_st),e.nt_req_st&&e.nt_res_st&&(e.t_resp=e.nt_res_st-e.nt_req_st),Box.Timing.events.bodyFlush&&Box.Timing.events.headFlush?e.t_page=Box.Timing.events.bodyFlush-Box.Timing.events.headFlush:e.nt_res_st&&e.nt_load_end&&(e.t_page=e.nt_load_end-e.nt_res_st),Box.Timing.boomerangData=e,t(r)}function i(){var e=Box.Application.getService("resin"),t=Box.Timing.boomerangData.t_done,n=a.resinPageName;e.recordAction({application:"files",page:n,component:"",feature:"",target:"pageloaded",action:"programmatic",data:{pageLoadTime:t}})}function o(){return window.sinon?(window.aggregateHook=r,void(window.logResinData=i)):void setTimeout(function(){r(),i()},0)}window.Box=window.Box||{},Box.Timing=Box.Timing||{execution:[],scripts:{},events:{},serverData:{}};var a=Box.Timing.attributes=Box.Timing.attributes||{version:1,amsterdam:1};Box.Timing.events=Box.Timing.events||{};var s={navigationStart:"nt_nav_st",redirectStart:"nt_red_st",redirectEnd:"nt_red_end",fetchStart:"nt_fet_st",domainLookupStart:"nt_dns_st",domainLookupEnd:"nt_dns_end",connectStart:"nt_con_st",connectEnd:"nt_con_end",requestStart:"nt_req_st",responseStart:"nt_res_st",responseEnd:"nt_res_end",domLoading:"nt_domloading",domInteractive:"nt_domint",domContentLoadedEventStart:"nt_domcontloaded_st",domContentLoadedEventEnd:"nt_domcontloaded_end",domComplete:"nt_domcomp",loadEventStart:"nt_load_st",loadEventEnd:"nt_load_end",secureConnectionStart:"nt_ssl_st"};window.addEventListener?window.addEventListener("load",o):window.attachEvent("onload",o)}(),function(){"use strict";function e(){}Box.Application.on("init",function(){var t=window.Box.Application,n=t.getGlobalConfig(),r=n.debug,i=t.getGlobal("localStorage");i&&i.getItem("debug")&&(r=!0),r?t.on("error",:e()})}(),Box.Application.addService("v5",function(e){"use strict";return{get:function(t){var n=null;return n=e.getGlobal(t),n&&"function"==typeof n.get&&(n=n.get()),n}}}),Box.Application.addService("native-app",function(e){"use strict";function t(e){return(new Date).getTime()-e>s}function n(e){d.fire(l,{url:e})}function r(e){d.fire(c,{url:e})}function i(e){var i=(new Date).getTime();a=setTimeout(function(){a=void 0,t(i)?r(e):n(e)},u)}function o(e){try{window.location=e}catch(t){n(e)}}var a,s=2e3,u=500,c="nativeredirectsuccess",l="nativeredirectfailed",d=$.extend({},new Box.EventTarget);return $.extend(d,{BROADCAST_EVENT_SUCCESS:c,BROADCAST_EVENT_FAILURE:l,redirectToApp:)}),Box.Application.addModule("smart-app-banner",function(e){"use strict";function t(){var e=u.get("Mobile");e&&$(".search_overlay").length&&e.show_search_overlay()}function n(){var e=document.domain.split(".");return e.length>2&&(e=e.slice(1)),e.join(".")}function r(){var e=new Date,t=n();e.setTime((new Date).getTime()+m),c.set(v,"1",e.toGMTString(),"/",t)}ction s(e){var t="UNKNOWN";switch(d[0].getAttribute("data-platform")){case"ios":t="iOS";break;case"android":t="Android";break;case"windows_phone":t="Windows Phone"}h.recordAction({application:"login",page:"login",component:"mobileAppBanner",feature:"login",target:e,action:"click",data:{userPlatform:t}})}var u,c,l,d,f,p,h,v="hide_smart_app_banner",m=864e5,g="auto_redirect_to_app",y="1";return{init:function(){var t;u=e.getService("v5"),c=e.getService("cookies"),l=e.getService("native-app"),h=e.getService("resin"),d=$(e.getElement()),t=d.find('[data-type="launch-btn"]'),f=t.attr("data-app-url"),p=t.attr("data-store-url"),f&&i()&&this.launch()},onclick:function(t,n,r){s(r),"remove-btn"===r?(this.remove(),t.preventDefault(),t.stopPropagation()):"launch-btn"===r?(this.launch(),t.preventDefault(),t.stopPropagation()):"open-in-app-btn"===r?e.broadcast("appopenbuttonclicked"):"go-to-mobile-site"===r&&$(".splash-screen").hide()},remove:launch:function(){this.tryRedirect(f||p)},handleRedirectionSuccess:function(e){var t=e.data.url;t===f&&(this.unregisterBroadcastListeners(),o()),t===p&&this.unregisterBroadcastListeners()},handleRedirectionFailure:function(e){var t=e.data.url;t===f?(this.unregisterBroadcastListeners(),a(),this.tryRedirect(p)):t===p&&this.unregisterBroadcastListeners()},registerBroadcastListeners:function(){l.on(l.BROADCAST_EVENT_FAILURE,$.proxy(this,"handleRedirectionFailure")),l.on(l.BROADCAST_EVENT_SUCCESS,$.proxy(this,"handleRedirectionSuccess"))},unregisterBroadcastListeners:function(){l.off(l.BROADCAST_EVENT_FAILURE,$.proxy(this,"handleRedirectionFailure")),l.off(l.BROADCAST_EVENT_SUCCESS,$.proxy(this,"handleRedirectionSuccess"))},tryRedirect:}),Box.Application.addModule("mobile-app-auto-redirect",function(e){"use strict";function t(){return o.set("auto-redirect","1")}function n(){return o.set("auto-redirect","0")}function r(){var e="1"===o.get("auto-redirect"),t="1"===o.get("auto-redirect-ff");return e&&t}function i(){var t=e.getElement(),n=t.getAttribute("data-platform-id"),r=t.getAttribute("data-auto-redirect-url");return!!r&&("ios"===n&&(t.src=r,!0))}var o;return{messages:["appopenbuttonclicked"],_getWindowLocation:_getHostnameFromReferrer:init:function(){if(o=e.getService("cookies"),r()){var t=this._getWindowLocation(),a=this._getHostnameFromReferrer()===t.hostname,s=t.search&&t.search.indexOf("sharedRedirect=1")>=0;a&&!s?n():i()}},onmessage:destroy:});
//# sourceMappingURL=/webapp_assets/login/js/login-7da6045b7e.js.map