!function(){"use strict";var AbstractEvent=),LogLevel,d;d=LogLevel||(LogLevel={}),d[d.Error=0]="Error",d[d.Warning=1]="Warning",d[d.Debug=2]="Debug";var CSS_LOG=["color: #fff;","background: #ff8f1c;","display: inline-block;","padding: 1px 4px;","border-radius: 3px;"].join(" "),Log=function(){function r(){}return r.Log=function(t,e){if(!(r.LOGLEVEL<t)){var n=LogLevel[t].toUpperCase(),o=window.navigator.userAgent,i=0<o.indexOf("MSIE ")||0<o.indexOf("Trident/");window.console?i?console.log("[PubTag] "+n+": "+e):console.log("%cPubTag",CSS_LOG,n+": "+e):t<=LogLevel.Error&&alert("[PubTag] "+n+": "+e)}},r.Debug=function(t){r.Log(LogLevel.Debug,t)},r.Warning=function(t){r.Log(LogLevel.Warning,t)},r.Error=r.LOGLEVEL=LogLevel.Error,r}();ar TimeMeasurer=function(){eturn n.CreateRunning=n.CreateWithStartTime=n.TimeSincePageLoad=n.prototype.start=n.prototype.elapsed=n}();ar CRITEO_VENDOR_ID=91,cmpCallbacks={};function hasCMP(t){return cmpInFrame(t)||void 0!==getCMPFrame(t)}function retrieveGDPRConsent(t,n,e){void 0===e&&(e=1e4);var o=TimeMeasurer.CreateRunning(),i=!1,r=setTimeout(function(){i=!0,Log.Warning("Timeout: Unable to resolve GDPR consent after "+e+"ms"),n(void 0)},e);executeCommand(t,"getVendorConsents",[CRITEO_VENDOR_ID],function(t,e){i||(clearTimeout(r),e?(Log.Debug("Consent retrieved in "+o.elapsed()+"ms"),getVendorConsentsCallback(t,n)):(Log.Warning("Error retrieving GDPR consent data from CMP"),n(void 0)))})}function getVendorConsentsCallback(t,e){if(t){var n={};void 0!==t.metadata&&(n.consentData=t.metadata),void 0!==t.gdprApplies&&(n.gdprApplies=!!t.gdprApplies),t.vendorConsents&&void 0!==t.vendorConsents[CRITEO_VENDOR_ID.toString()]&&(n.consentGiven=!!t.vendorConsents[CRITEO_VENDOR_ID.toString()]),e(n)}else Log.Warning("Unable to read GDPR consent data from CMP"),e(void 0)}function executeCommand(t,e,n,o){if(!cmpInFrame(t)){Log.Debug("No CMP defined on current frame");var r=getCMPFrame(t);t.__cmp=function(t,e,n){if(!r)return Log.Warning("CMP not found"),void n({msg:"CMP not found"},!1);var o=Math.random().toString(10),i={__cmpCall:{command:t,parameter:e,callId:o}};cmpCallbacks[o]=n,r.postMessage(i,"*")},t.addEventListener("message",function(t){var e="string"==typeof t.data?tryParseJson(t.data):t.data;if(e&&e.__cmpReturn&&e.__cmpReturn.callId&&e.__cmpReturn.returnValue){var n=e.__cmpReturn;cmpCallbacks[n.callId](n.returnValue,n.success),delete cmpCallbacks[n.callId]}},!1)}t.__cmp(e,n,o)}unction getCMPFrame(t){for(var e,n=t,o=0;o<10;++o){try{n.frames.__cmpLocator&&(e=n)}catch(t){}if(n===t.top)break;n=n.parent}return e}function tryGetLocalStorage(t){try{return t.localStorage}catch(t){return}}var LocalStorageHelper=function(){function t(t){this.EXPIRE_SUFFIX="_expires",this.CHECK_STORAGE_KEY="criteo_localstorage_check",this.localStorage=tryGetLocalStorage(t||window)}return t.prototype.checkLocalStorage=function(){if(!this.localStorage)return!1;var t=this.CHECK_STORAGE_KEY;try{return this.localStorage.setItem(t,t),this.localStorage.removeItem(t),!0}catch(t){return!1}},t.prototype.removeItem=function(t){this.localStorage.removeItem(t),this.localStorage.removeItem(t+this.EXPIRE_SUFFIX)},t.prototype.getItem=function(t,e){var n=(new Date).getTime(),o=this.localStorage.getItem(t+this.EXPIRE_SUFFIX),i=o?parseInt(o,10):-1;return-1!==i&&i<n||e&&(-1===i||e<i-n)?(this.removeItem(t),null):this.localStorage.getItem(t)},t.prototype.setItem=function(t,e,n){if(this.localStorage.setItem(t,e),n){var o=(new Date).getTime()+n;this.localStorage.setItem(t+this.EXPIRE_SUFFIX,o.toString())}},t}(),DirectBiddingSilentModeManager=function(){function n(){this.localStorageHelper=new LocalStorageHelper,this.localStorageEnabled=this.localStorageHelper.checkLocalStorage()}return n.prototype.silentModeEnabled=function(){var t=n.SILENT_MODE_KEY;return this.localStorageEnabled&&null!==this.localStorageHelper.getItem(t)},n.prototype.enableSilentMode=function(t){if(this.localStorageEnabled){var e=n.SILENT_MODE_KEY;this.localStorageHelper.setItem(e,"1",t)}},n.SILENT_MODE_KEY="criteo_silent_mode",n}();ar Lock=function(){function t(t){this.x=t+"_lock_A",this.y=t+"_lock_B",this.id=Math.floor(1e9*Math.random()).toString()}return t.prototype.get=function(t){var e=localStorage.getItem(t);if(e){var n=e.split("|");if(!(n.length<2||parseInt(n[1],10)<now()))return n[0]}},t.prototype.set=function(t,e){var n=now()+e;localStorage.setItem(t,this.id+"|"+n)},t.prototype.acquire=function(t,e,n){var o=this;void 0===n&&(n=100),n<=0||this.tryAcquire(e)?(t(),this.release()):setTimeout(function(){o.acquire(t,e,n-10)},10)},t.prototype.tryAcquire=function(t){localStorage.setItem(this.x,this.id);var e=this.get(this.y);return!(e&&e!==this.id||(this.set(this.y,t),localStorage.getItem(this.x)!==this.id||this.get(this.y)!==this.id))},t.prototype.release=t}(),Size=),SlotKey=function(){function t(t){this.impressionId=t}return t.prototype.toString=t}(),__extends=(Qa=function(t,e){return(Qa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}Qa(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Qa,SlotKeyWithSize=function(i){function t(t,e,n){var o=i.call(this,t)||this;return o.size=e,o.networkId=n,o}return __extends(t,i),t.prototype.toString=function(){return i.prototype.toString.call(this)+"_Size"+this.size+"_NetworkId"+this.networkId},t}(SlotKey),__extends$1=(fb=function(t,e){return(fb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}fb(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),fb,SlotKeyWithZoneId=function(o){eturn __extends$1(t,o),t.prototype.toString=t}(SlotKey),SlotKeyFactory=function(){eturn t.prototype.createKeysFromSlotRequest=function(t){if(this.useZoneIdIntegration)return[new SlotKeyWithZoneId(t.impId,t.zoneId)];for(var e=[],n=0,o=t.sizes;n<o.length;n++){var i=o[n];e.push(new SlotKeyWithSize(t.impId,i,this.networkId))}return e},t.prototype.createKeyFromSlotResponse=function(t){return this.useZoneIdIntegration?new SlotKeyWithZoneId(t.impid,t.zoneid):new SlotKeyWithSize(t.impid,new Size(t.width,t.height),this.networkId)},t.prototype.createKeyFromBid=function(t){return this.useZoneIdIntegration?new SlotKeyWithZoneId(t.impressionId,t.zoneId):new SlotKeyWithSize(t.impressionId,new Size(t.width,t.height),this.networkId)},t}(),DirectBiddingBidManager=function(){function l(t,e){this.localStorageHelper=new LocalStorageHelper,this.localStorageEnabled=this.localStorageHelper.checkLocalStorage(),this.slotKeyFactory=new SlotKeyFactory(t,e)}return l.useZoneIdIntegration=function(t,e){return void 0===e||0===t.filter(function(t){return void 0!==t.sizes&&0<t.sizes.length}).length},l.prototype.get=function(t){var e=l.BID_KEY_PREFIX+t.toString(),n=this.localStorageHelper.getItem(e),o=n&&tryParseJson(n);return o&&"object"==typeof o&&"bids"in o?(o.bids=o.bids.filter(function(t){return t.expiration>now()}),o):{bids:[]}},l.prototype.set=function(t,e){var n=l.BID_KEY_PREFIX+t.toString();0<e.bids.length||e.no_bid&&e.no_bid>now()?this.localStorageHelper.setItem(n,JSON.stringify(e)):this.localStorageHelper.removeItem(n)},l.prototype.filterNoBidSlots=function(t){for(var e=[],n=0,o=t;n<o.length;n++){for(var i=o[n],r=[],a=0,s=this.slotKeyFactory.createKeysFromSlotRequest(i);a<s.length;a++){var d=s[a];this.getBid(d,0)!==l.NO_BID&&(d instanceof SlotKeyWithSize?r.push(d.size):e.push(i))}0<r.length&&(i.sizes=r,e.push(i))}return e},l.prototype.getRequestCachedBids=function(t,e){void 0===e&&(e=5e3);for(var n=[],o=0,i=t;o<i.length;o++)for(var r=i[o],a=0,s=this.slotKeyFactory.createKeysFromSlotRequest(r);a<s.length;a++){var d=s[a],c=this.getBid(d,e);void 0!==c&&c!==l.NO_BID&&n.push(c)}return n},l.prototype.getBid=function(t,e){if(void 0===e&&(e=5e3),this.localStorageEnabled){var n=this.get(t);if(n.no_bid&&n.no_bid>now())return l.NO_BID;if(0<e)for(var o=0,i=n.bids;o<i.length;o++){var r=i[o];if(new Lock(l.BID_KEY_PREFIX+r.bid.slotid).tryAcquire(e))return r.bid}}},l.prototype.storeRequestNoBid=function(t,e){for(var n=0,o=this.slotKeyFactory.createKeysFromSlotRequest(t);n<o.length;n++){var i=o[n];this.storeNoBid(i,e)}},l.prototype.storeResponseBid=function(e,n){var t=this.slotKeyFactory.createKeyFromSlotResponse(e);this.modifyCache(t,function(t){t.bids.push({bid:e,expiration:now()+1e3*n})})},l.prototype.storeNoBid=function(t,e){this.modifyCache(t,function(t){t.no_bid=Math.max(t.no_bid||0,now()+1e3*e)})},l.prototype.removeBid=function(n){var t=this.slotKeyFactory.createKeyFromBid(n);this.modifyCache(t,function(t){for(var e=0;e<t.bids.length;e++)if(t.bids[e].bid.slotid===n.slotId)return void t.bids.splice(e,1)}),new Lock(t.toString()).release()},l.prototype.modifyCache=function(e,n){var o=this;if(this.localStorageEnabled){var i=new Lock(e.toString());i.acquire(function(){var t=o.get(e);n(t),o.set(e,t),i.release()},1e3)}},l.NO_BID="nobid",l.BID_KEY_PREFIX="criteo_pt_cdb_bidcache_",l}(),DirectBiddingCache=function(){function t(t,e,n){var o=DirectBiddingBidManager.useZoneIdIntegration(e,n);this.bidManager=new DirectBiddingBidManager(o,n),this.silentModeManager=new DirectBiddingSilentModeManager,this.context=t}return t.prototype.filterNoBidSlots=function(t){var e=this.bidManager.filterNoBidSlots(t);return this.context.shouldIgnoreSilentMode?(e.length!==t.length&&this.context.setSilentModeIgnored&&this.context.setSilentModeIgnored(),t):e},t.prototype.silentModeEnabled=function(){var t=!1;return this.silentModeManager.silentModeEnabled()&&(this.context.shouldIgnoreSilentMode&&this.context.setSilentModeIgnored?this.context.setSilentModeIgnored():t=!0),t},t.prototype.getCachedBids=t.prototype.removeBid=t.prototype.handleResponse=function(t,e,n,o){var i=n.time_to_next_call;0<i&&(Log.Debug("Global silent mode enabled for "+i+" seconds"),this.silentModeManager.enableSilentMode(1e3*i));var r={};if(n.slots)for(var a=0,s=n.slots;a<s.length;a++){(h=s[a]).ttl&&(r[h.imp_id]=h.ttl)}if(e.slots)for(var d=0,c=e.slots;d<c.length;d++){var l=0;(h=c[d]).slotid in r&&(l=r[h.slotid],delete r[h.slotid]),o&&0<l&&(Log.Debug("Post-timeout bid for slot '"+h.impid+"' cached for "+l+" seconds"),this.bidManager.storeResponseBid(h,l))}for(var u in r)if(r.hasOwnProperty(u))for(var p=0,f=t;p<f.length;p++){var h;if((h=f[p]).slotId===u){l=r[u];Log.Debug("Silent mode for slot '"+h.impId+"' enabled for "+l+" seconds"),this.bidManager.storeRequestNoBid(h,l)}}},t}(),AsyncRequest=function(){eturn a.prototype.send=a.prototype.getXMLHttpRequest=a.prototype.getXDomainRequest=a.LOCAL_PASSBACK_TIMEOUT=3e4,a}();ar PublisherTagVersion=65,DirectBiddingMetric=DirectBiddingMetricSlot=DirectBiddingMetricBuilder=function(){function t(){this.elapsed=0,this.isTimeout=!1,this.pageLoadElapsed=0,this.adapterStartElapsed=0,this.cdbCallStartElapsed=0,this.cdbCallEndElapsed=0,this.adapterEndElapsed=0,this.cachedBidsReturned=[],this.slots=[]}return t.prototype.withElapsed=function(t){return this.elapsed=Math.round(t),this},t.prototype.withIsTimeout=function(t){return this.isTimeout=t,this},t.prototype.withPageLoadElapsed=function(t){return this.pageLoadElapsed=Math.round(t),this},t.prototype.withAdapterStartElapsed=function(t){return this.adapterStartElapsed=Math.round(t),this},t.prototype.withCdbCallStartElapsed=function(t){return this.cdbCallStartElapsed=Math.round(t),this},t.prototype.withCdbCallEndElapsed=function(t){return this.cdbCallEndElapsed=Math.round(t),this},t.prototype.withSetTargetingElapsed=function(t){return this.setTargetingElapsed=Math.round(t),this},t.prototype.withAdapterEndElapsed=t.prototype.withAdapterTimeout=t.prototype.withCachedBidsReturned=t.prototype.addSlot=function(t,e,n){var o=0<this.cachedBidsReturned.filter(.length;return this.slots.push(new DirectBiddingMetricSlot(t,e,n,o)),this},t.prototype.build=function(){var t;return void 0!==this.adapterTimeout&&(t=this.adapterEndElapsed>this.adapterTimeout),new DirectBiddingMetric(PublisherTagVersion,this.slots,this.elapsed,this.isTimeout,this.pageLoadElapsed,this.adapterStartElapsed,this.cdbCallStartElapsed,this.cdbCallEndElapsed,this.adapterEndElapsed,this.setTargetingElapsed,this.adapterTimeout,t)},t}(),DirectBiddingMetricsManager=function(){function i(){this.localStorageHelper=new LocalStorageHelper,this.localStorageEnabled=this.localStorageHelper.checkLocalStorage()}return i.prototype.getMetrics=function(t){if(this.localStorageEnabled){var e=i.METRICS_STORAGE_KEY,n=this.localStorageHelper.getItem(e),o=n?tryParseJson(n):[];return t&&this.localStorageHelper.removeItem(e),o}return[]},i.prototype.setMetrics=function(t){if(this.localStorageEnabled){var e=i.METRICS_STORAGE_KEY;this.localStorageHelper.setItem(e,JSON.stringify(t),36e5)}},i.prototype.storeMetric=function(t){if(this.localStorageEnabled){var e=this.getMetrics(!1);e.push(t),this.setMetrics(e)}},i.METRICS_STORAGE_KEY="criteo_pt_cdb_metrics",i}(),IntegrationMode,Ce;e=IntegrationMode||(IntegrationMode={}),Ce[Ce.Unspecified=0]="Unspecified",Ce[Ce.AMP=1]="AMP";var DirectBiddingRequestBuilder=function(){function t(t,e,n,o,i,r,a,s,d,c){this.slots=t,this.context=e,this.metricsManager=n,this.urlBuilder=o,this.profileId=i,this.integrationMode=r||IntegrationMode.Unspecified,this.networkId=a,this.adapterVersion=s,this.gdprConsent=d,this.wrapperVersion=c}return t.prototype.isValid=t.prototype.getRequest=function(){for(var t=[],e=0,n=this.slots;e<n.length;e++){var o=n[e],i={slotid:o.slotId,impid:o.impId};if(void 0!==o.zoneId&&(i.zoneid=o.zoneId),void 0!==o.nativeCallback&&(i.native=!0),void 0!==o.transactionId&&(i.transactionid=o.transactionId),void 0!==o.publisherSubId&&(i.publishersubid=o.publisherSubId),void 0!==o.sizes){for(var r=[],a=0,s=o.sizes;a<s.length;a++){var d=s[a];r.push(d.width+"x"+d.height)}i.sizes=r}t.push(i)}var c={publisher:{url:this.context.highestAccessibleUrl},slots:t};void 0!==this.networkId&&(c.publisher.networkid=this.networkId);var l=this.metricsManager.getMetrics(!0);return l.length&&(c.previousBidFeedback=l),this.gdprConsent&&(c.gdprConsent=this.gdprConsent),c},t.prototype.getUrl=t}();r DirectBiddingTimer=function(){function t(t,e,n){this.hasSetTargetingBeenCalled=!1,this.builder=t,this.timer=void 0!==e?TimeMeasurer.CreateWithStartTime(e):TimeMeasurer.CreateRunning();var o=this.timer.elapsed();this.builder.withAdapterStartElapsed(o),this.builder.withPageLoadElapsed(TimeMeasurer.TimeSincePageLoad()-o),void 0!==n&&this.builder.withAdapterTimeout(n)}return t.prototype.sendRequest=t.prototype.requestReceived=t.prototype.setTargeting=function(){this.hasSetTargetingBeenCalled||(this.builder.withSetTargetingElapsed(this.timer.elapsed()),this.hasSetTargetingBeenCalled=!0)},t.prototype.finish=function(t){if(this.builder.withAdapterEndElapsed(this.timer.elapsed()),t&&0!==t.length)for(var e=0,n=t;e<n.length;e++){var o=n[e];this.builder.addSlot(o.imp_id,o.zone_id,o.ad_unit_id)}else this.builder.addSlot("");return this.build()},t.prototype.build=function(){return this.builder.build()},t}(),__extends$2=(qf=function(t,e){return(qf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}qf(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),qf,DirectBiddingEvent=function(u){function p(t,e,n,o,i,r,a,s,d,c){var l=u.call(this,p.NAME)||this;return l.profileId=t,l.urlBuilder=e,l.slots=n,l.metricBuilder=new DirectBiddingMetricBuilder,l.metricsManager=new DirectBiddingMetricsManager,l.callbackSuccess=o,l.callbackError=i,l.callbackTimeout=r,l.timeout=a,l.networkId=s,l.integrationMode=d,l.adapterVersion=c,l}return __extends$2(p,u),p.prototype.setGDPRConsent=p.prototype.getMetricBuilder=function(){return this.metricBuilder},p.prototype.eval=p.prototype.evalWithTimeout=function(t,e){var o=this,n=p.getCriteoAdapterBidRequest(),i=p.getRequestAuctionStart(n),r=e||resolvePrebidTimeout(n&&n.timeout),a=new DirectBiddingTimer(this.metricBuilder,i,r),s=new DirectBiddingRequestBuilder(this.slots,t.context,this.metricsManager,this.urlBuilder,this.profileId,this.integrationMode,this.networkId,this.adapterVersion,this.gdprConsent);if(s.isValid()&&"undefined"!=typeof JSON){var d=s.getRequest(),c=JSON.stringify(d),l=s.getUrl(),u=new AsyncRequest(l,c,"application/x-www-form-urlencoded");a.sendRequest(l),u.send(function(t){a.requestReceived();var e=tryParseJson(t)||{},n=extractExtraData(e);void 0!==o.callbackSuccess&&o.callbackSuccess(JSON.stringify(e),n),o.metricsManager.storeMetric(a.finish(n.slots))},function(t,e){a.requestReceived(),void 0!==o.callbackError&&o.callbackError(t,e),o.metricsManager.storeMetric(a.finish())},function(){a.requestReceived(!0),void 0!==o.callbackTimeout&&o.callbackTimeout(),o.metricsManager.storeMetric(a.finish())},this.timeout)}else this.callbackError(void 0,void 0)},p.getCriteoAdapterBidRequest=p.getRequestAuctionStart=p.NAME="directbidding",p}(AbstractEvent),__extends$3=(ig=function(t,e){return(ig=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}ig(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),ig,DirectBiddingEventWithCaching=function(p){function f(t,e,n,o,i,r,a,s,d,c){var l=p.call(this,f.NAME)||this,u=Math.max(10*(a||3e3),3e3);return l.cache=new DirectBiddingCache(window.criteo_pubtag.context,n,s),l.directBiddingEvent=new DirectBiddingEvent(t,e,l.cache.filterNoBidSlots(n),function(t,e){return l.onSuccess(t,e)},function(){return l.onHttpTimeout()},u,s,d,c),l.slots=n,l.callbackSuccess=o,l.callbackError=i,l.callbackTimeout=r,l.timeout=a,l.hasTimeouted=!1,l.hasResponded=!1,l}return __extends$3(f,p),f.prototype.eval=function(e){var n=this;hasCMP(window)?retrieveGDPRConsent(window,:this.evalWithCmp(e,void 0)},f.prototype.evalWithCmp=function(t,e){var n=this;if(this.cache.silentModeEnabled())return Log.Debug("Request ignored because the global silent mode is enabled"),void this.callbackSuccess("",void 0);setTimeout(this.timeout||3e3),this.directBiddingEvent.setGDPRConsent(e),this.directBiddingEvent.evalWithTimeout(t,this.timeout)},f.prototype.onSuccess=function(t,e){if(this.hasResponded=!0,void 0!==e){var n=tryParseJson(t);this.cache.handleResponse(this.slots,n,e,this.hasTimeouted)}this.hasTimeouted||this.callbackSuccess(t,e)},f.prototype.onError=f.prototype.onHttpTimeout=f.prototype.onTimeout=function(){if(!this.hasResponded){this.hasTimeouted=!0;var t=this.cache.getCachedBids(this.slots);0===t.length?this.callbackTimeout():(Log.Debug("Cached bids returned because of timeout: ['"+t.map(.join("', '")+"']"),this.directBiddingEvent.getMetricBuilder().withCachedBidsReturned(t),this.callbackSuccess(JSON.stringify({slots:t}),void 0))}},f.prototype.getMetricBuilder=f.prototype.getBidCache=function(){return this.cache},f.NAME="directbidding",f}(AbstractEvent),CacheBusterGenerator=),DirectBiddingUrlBuilder=function(){eturn a.prototype.buildUrl=function(t,e,n,o,i){void 0===n&&(n=IntegrationMode.Unspecified);var r=("https:"===e.protocol?"https:":"http:")+a.CRITEO_BIDDER_URL+this.getHandlerPath();return r+="?ptv="+PublisherTagVersion,r+="&profileId="+String(t),r+=e.ctoIdOnPublisherDomain?"&idcpy="+e.ctoIdOnPublisherDomain:"",r+=e.idfs?"&idfs="+e.idfs:"",r+=e.secureId?"&sid="+e.secureId:"",r+=e.isOptOut?"&optout=1":"",n!==IntegrationMode.Unspecified&&(r+="&im="+n),void 0!==o&&(r+="&av="+String(o)),void 0!==i&&(r+="&wv="+encodeURIComponent(i)),r+=e.silentModeIgnored?"&smi=1":"",r+="&cb="+String(CacheBusterGenerator.generateCacheBuster()),r+=e.getContextFlags()},a.prototype.getHandlerPath=a.CRITEO_BIDDER_URL="//bidder.criteo.com/",a.CRITEO_BIDDER_HANDLER="cdb",a.CRITEO_BIDDER_AUDIT_HANDLER="prebid/audit",a}();function retrieveGoogleTagPlacements(e){window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[],window.googletag.cmd.push(function(){var t=googleSlotsToDynamicSlots(window.googletag.pubads().getSlots());e(t)})}function googleSlotsToDynamicSlots(t){for(var e=[],n=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,o=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,i=0,r=t;i<r.length;i++){for(var a=r[i],s=a.getSlotElementId(),d=[],c=0,l=a.getSizes(n,o)||a.getSizes();c<l.length;c++){var u=l[c];"function"==typeof u.getWidth&&u.getWidth()&&"function"==typeof u.getHeight&&u.getHeight()&&d.push(u.getWidth()+"x"+u.getHeight())}s&&0<d.length&&e.push({slotId:s,sizes:d})}return e}unction createDFPTargeting(t,e){return{crt_pb:[t],crt_bidid:[e]}}var DFPKeyValueTargeter=);r BidEventTarget=function(){},__extends$4=(Sh=function(t,e){return(Sh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}Sh(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Sh,BidEventContainerTarget=function(_super){function BidEventContainerTarget(t,e){var n=_super.call(this)||this;n.containerId=e;var o=t.getElementById(e);return o?n.element=o:Log.Error("Target element '"+e+"' not found in the document"),n}return __extends$4(BidEventContainerTarget,_super),BidEventContainerTarget.prototype.ResizeFrame=BidEventContainerTarget.prototype.Write=BidEventContainerTarget.prototype.LoadScript=BidEventContainerTarget}(BidEventTarget),__extends$5=(ii=function(t,e){return(ii=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}ii(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),ii,BidEventDocumentTarget=function(n){eturn __extends$5(t,n),t.prototype.ResizeFrame=t.prototype.Write=t.prototype.LoadScript=t}(BidEventTarget),__extends$6=(Ci=function(t,e){return(Ci=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}Ci(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Ci,Custom=AbstractEvent),BidResponseSlot=function(){function t(t,e,n,o,i,r){this.id=this.generateRandomId(),this.slotId=t,this.impressionId=e,this.cpm=n,this.width=o,this.height=i,this.zoneId=r}return t.prototype.generateRandomId=t}(),__extends$7=(Zi=function(t,e){return(Zi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}Zi(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Zi,DisplayUrlBidResponseSlot=function(d){function t(t,e,n,o,i,r,a){var s=d.call(this,t,e,n,o,i,r)||this;return s.displayUrl=a,s}return __extends$7(t,d),t.prototype.GenerateEvent=function(t){var e=this;return t.ResizeFrame(this.width,this.height),new Custom(function(){return t.LoadScript(e.displayUrl)})},t.prototype.GenerateMessage=function(){return{displayUrl:this.displayUrl}},t}(BidResponseSlot),__extends$8=(uj=function(t,e){return(uj=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}uj(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),uj,HtmlCreativeBidResponseSlot=function(d){eturn __extends$8(t,d),t.prototype.GenerateEvent=t.prototype.GenerateMessage=function(){return{creative:this.creative}},t}(BidResponseSlot),LineItemRange=function(){eturn f.createLineItemRangesFromString=function(t){for(var e=[],n=0,o=t.split(";");n<o.length;n++){var i=o[n],r=i.split(".."),a=f.roundToDecimal(r[0],2),s=r[1].split(":"),d=f.roundToDecimal(s[0],2),c=f.roundToDecimal(s[1],2);if(isNaN(a)||isNaN(d)||isNaN(c)||0===c){Log.Warning("Could not parse range parameter: "+i);break}if(a<0||d<0||c<0){Log.Warning("Positive values must be set for range bounds: "+i);break}var l=d-a,u=l/c,p=u===Math.floor(u);d<a?Log.Warning("Lower bound ("+a+") greater than upper bound ("+d+")"):p?e.push(new f(a,d,c)):Log.Warning("Range ("+l+") is not divisible by increment ("+c+")")}return e.sort(,e},f.getDefaultDenseLineItemRanges=f.computeLineItemPricebandValue=function(t,e){0===e.length&&(e=f.getDefaultDenseLineItemRanges());for(var n=0,o=e;n<o.length;n++){var i=o[n];if(t<=i.upperBound&&t>i.lowerBound){var r=Math.floor(t/i.increment+1e-4)*i.increment;return f.formatPriceBand(r)}}return t<e[0].lowerBound?void 0:t===e[0].lowerBound?f.formatPriceBand(e[0].lowerBound):f.formatPriceBand(e[e.length-1].upperBound)},f.formatPriceBand=f.roundToDecimal=function(t,e){var n=parseFloat(t),o=Math.pow(10,e);return Math.round(n*o)/o},f}(),__extends$9=(xk=function(t,e){return(xk=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}xk(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),xk,NativeBidResponseSlot=function(c){function t(t,e,n,o,i,r,a,s){var d=c.call(this,t,e,n,o,i,r)||this;return d.nativeCallback=a,d.nativePayload=s,d}return __extends$9(t,c),t.prototype.GenerateEvent=t.prototype.GenerateMessage=t}(BidResponseSlot),InputParameters=function(){eturn t.prototype.addParameter=t.prototype.tryFillParameters=function(t){for(var e in t)if(void 0!==t[e]){var n=e.toLowerCase();this.paramParser[n]?this.paramParser[n](t[e]):Log.Warning("Unknown parameter: "+e)}},t}(),__extends$10=(bl=function(t,e){return(bl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}bl(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),bl,RenderAdInputParameters=InputParameters);ar DirectBiddingSlot=function(t,e,n,o,i,r){this.slotId=generateUuid().replace(/-/g,""),this.impId=t,this.zoneId=e,this.nativeCallback=n,this.transactionId=o,this.sizes=i,this.publisherSubId=r},__extends$11=(Dl=function(t,e){return(Dl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}Dl(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Dl,PlacementInputParameters=function(e){function t(t){var i=e.call(this)||this;return i.slotId=void 0,i.zoneId=void 0,i.sizes=[],i.nativeCallback=void 0,i.publisherSubId=void 0,i.addParameter("slotid",function(t){i.slotId=t}),i.addParameter("zoneid",function(t){i.zoneId=t}),i.addParameter("sizes",function(t){for(var e=0,n=t;e<n.length;e++){var o=n[e].split("x");i.sizes.push(new Size(parseInt(o[0],10),parseInt(o[1],10)))}}),i.addParameter("nativecallback",function(t){i.nativeCallback=t}),i.addParameter("publisherSubId",function(t){i.publisherSubId=t}),e.prototype.tryFillParameters.call(i,t),i}return __extends$11(t,e),t}(InputParameters),__extends$12=(_l=function(t,e){return(_l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}_l(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),_l,StandaloneInputParameters=function(n){function t(t){var e=n.call(this)||this;return e.placements=void 0,e.networkId=void 0,e.addParameter("networkId",function(t){e.networkId=t}),e.addParameter("placements",,n.prototype.tryFillParameters.call(e,t),e}return __extends$12(t,n),t.prototype.deserializePlacementInput=function(t){for(var e=[],n=0,o=t;n<o.length;n++){var i=o[n],r=new PlacementInputParameters(i);e.push(new DirectBiddingSlot(r.slotId,r.zoneId,r.nativeCallback,void 0,r.sizes,r.publisherSubId))}return e},t}(InputParameters),standaloneProfileId=184;nction RequestBidsOnGoogleTagSlots(t,e,n){if("number"==typeof t){DiscoverTagsAndRequestBids(o=t,e,n)}else{var o=getParam(t,"networkId","number"),i=getParam(t,"placements","object"),r=getParam(t,"callback","function"),a=getParam(t,"timeout","function");void 0===i?DiscoverTagsAndRequestBids(o,r,a):RequestBidsWithProfileId({networkId:o,placements:googleSlotsToDynamicSlots(i)},standaloneProfileId,r,a)}}var metricBuilders={},bidCaches={};function RequestBidsWithProfileId(t,e,v,n){var m=new StandaloneInputParameters(t);if(checkInputParameters(m)){for(var o=function(){void 0!==v&&v([])},i=new DirectBiddingEventWithCaching(e,new DirectBiddingUrlBuilder(!1),m.placements,function(t){var e=tryParseJson(t);if(void 0!==e&&void 0!==e.slots){var a={};if(e.invocation_codes)for(var n=0,o=e.invocation_codes;n<o.length;n++)for(var i=o[n],r=0,s=i.slot_ids;r<s.length;r++){var d=s[r];a[d]=i.invocation_code}for(var c=function(e){for(var t=void 0,n=0,o=m.placements;n<o.length;n++){var i=o[n];if(i.nativeCallback&&i.impId===e.impid){t=i.nativeCallback;break}}!t&&e.slotid in a&&(t=;var r=GenerateBidResponseSlot(e.slotid,e.impid,e.cpm,e.width,e.height,e.zoneid,t,e.native,e.displayurl,e.creative);void 0!==r&&(window.criteo_pubtag.standaloneBidder.bids[r.id]=r)},l=0,u=e.slots;l<u.length;l++)c(u[l]);e.granularity&&SetLineItemRanges(e.granularity)}if(void 0!==v){for(var p=[],f=0,h=m.placements;f<h.length;f++){var g=h[f];p.push(g.impId)}v(GetBids({impressionIds:p}))}},o,o,n||3e3,m.networkId,m.integrationMode),r=[],a=0,s=m.placements;a<s.length;a++){var d=s[a];r.push(d.impId),metricBuilders[d.slotId]=i.getMetricBuilder(),bidCaches[d.slotId]=i.getBidCache()}window.criteo_pubtag.standaloneBidder.impIds=r,window.criteo_pubtag.push(i)}}function SetLineItemRanges(t){var e=LineItemRange.createLineItemRangesFromString(t);window.criteo_pubtag.standaloneBidder.lineItemRanges=e}function markSetTargetingMetrics(){for(var t=new DirectBiddingMetricsManager,e=t.getMetrics(!1),n={},o=0;o<e.length;++o)for(var i=0,r=e[o].slots;i<r.length;i++){n[r[i].impressionId]=o}for(var a in metricBuilders)if(metricBuilders.hasOwnProperty(a)){var s=metricBuilders[a],d=TimeMeasurer.TimeSincePageLoad()-s.pageLoadElapsed;s.withSetTargetingElapsed(d),a in n&&(e[n[a]]=s.build())}t.setMetrics(e)}function SetDFPKeyValueTargeting(){var t=new DFPKeyValueTargeter;t.resetKeyValuesForSlots(window.criteo_pubtag.standaloneBidder.impIds);var e=window.criteo_pubtag.standaloneBidder.lineItemRanges,n=GetImpressionIdToBestBid();for(var o in n)if(n.hasOwnProperty(o)){var i=ComputeDFPTargeting(n[o],e);void 0!==i&&t.setKeyValuePerSlot(o,i)}markSetTargetingMetrics()}unction ComputeDFPTargeting(t,e){var n=LineItemRange.computeLineItemPricebandValue(t.cpm,e);return void 0===n?void 0:createDFPTargeting(n,t.id)}function RenderAd(t,e){var n=new RenderAdInputParameters("string"==typeof t?{bidId:t,document:e}:t);if(n.bidId){var o=void 0!==n.containerId?new BidEventContainerTarget(n.document,n.containerId):new BidEventDocumentTarget(n.document);RenderAdOnTarget(n.bidId,o)}else Log.Error("You must provide a bidId to the RenderAd call")}function RenderAdOnTarget(t,e){var n=window.criteo_pubtag.standaloneBidder.bids;if(n.hasOwnProperty(t)){var o=n[t],i=o.GenerateEvent(e);window.criteo_pubtag.push(i),o.slotId in bidCaches&&bidCaches[o.slotId].removeBid(o),delete n[t]}else Log.Error("Could not render bid with id: "+t)}function GetBids(t){var e=window.criteo_pubtag.standaloneBidder.bids;if(null===e)return[];var n=window.criteo_pubtag.standaloneBidder.lineItemRanges,o=[];for(var i in e)if(e.hasOwnProperty(i)){var r=e[i];if(!t||!t.impressionIds||-1!==t.impressionIds.indexOf(r.impressionId)){if(0<n.length){var a=LineItemRange.computeLineItemPricebandValue(r.cpm,n);r.cpm_bucket=a}o.push(r)}}return o}function GetBidsForAdUnit(t,e){void 0===e&&(e=1);var n=GetBids({impressionIds:[t]});return n.sort(.slice(0,Math.min(Math.max(e,0),n.length))}function checkInputParameters(t){if(void 0===t.placements)return Log.Error("Missing 'placements' parameter"),!1;if(0===t.placements.length)return Log.Error("'placements' parameter is empty"),!1;for(var e=0,n=t.placements;e<n.length;e++){var o=n[e];if(IsEmptyOrUndefined(o.impId))return Log.Error("Missing 'slotId' parameter in placements object"),!1;if(IsEmptyOrUndefined(o.zoneId)&&(IsEmptyOrUndefined(o.sizes)||IsEmptyOrUndefined(t.networkId)))return Log.Error("Missing zone information: specify either a zoneId or a networkId and a zone size"),!1;if(void 0!==o.nativeCallback&&"function"!=typeof o.nativeCallback)return Log.Error("'nativeCallback' parameter is not a function in placements object"),!1}return!0}function GetImpressionIdToBestBid(){var t={},e=window.criteo_pubtag.standaloneBidder.bids;for(var n in e)if(e.hasOwnProperty(n)){var o=e[n];if(t.hasOwnProperty(o.impressionId))t[o.impressionId].cpm<o.cpm&&(t[o.impressionId]=o);else t[o.impressionId]=o}return t}function GenerateBidResponseSlot(t,e,n,o,i,r,a,s,d,c){return void 0!==a&&void 0!==s?new NativeBidResponseSlot(t,e,n,o,i,r,a,s):void 0===d||void 0!==c&&"<script"!==c.substr(0,7)?void 0!==c?new HtmlCreativeBidResponseSlot(t,e,n,o,i,r,c):void 0:new DisplayUrlBidResponseSlot(t,e,n,o,i,r,d)}ar AMP=function(){function s(){}return s.Standalone=function(i,r,a){RequestBids({integrationmode:"amp",placements:[{slotid:i.slot,zoneid:i.zone,sizes:[i.width+"x"+i.height]}]},function(t){if("DFP"===i.adserver){s.listenForCreativeRequests(t);for(var e=0,n=t;e<n.length;e++){var o=ComputeStandaloneDFPTargeting(n[e],i.lineItemRanges);void 0!==o&&a(o)}0===t.length&&a({})}r(null)},i.timeout)},s.listenForCreativeRequests=function(s){window.addEventListener("message",function(t){var e=t.data instanceof Object?t.data:tryParseJson(t.data);if(e&&e.bidId&&t.source)for(var n=0,o=s;n<o.length;n++){var i=o[n];if(i.id===e.bidId){var r=t.source,a=i.GenerateMessage();a.message="Criteo creative",r.postMessage(JSON.stringify(a),"*")}}},!1)},s}(),Prebid=function(){function o(t,e,n,o,i){var r,a;this.timer=new DirectBiddingTimer(new DirectBiddingMetricBuilder,o.auctionStart,resolvePrebidTimeout(o.timeout)),this.auctionId=o.auctionId,this.bidRequests=n,this.slots=[];for(var s=0,d=n;s<d.length;s++){var c=d[s];this.slots.push(new DirectBiddingSlot(c.adUnitCode,c.params.zoneId,c.params.nativeCallback,c.transactionId,c.sizes.map(,c.params.publisherSubId)),r=c.params.networkId||r,c.params.integrationMode&&(a=parse(c.params.integrationMode))}var l={};o.gdprConsent&&(void 0!==o.gdprConsent.consentString&&(l.consentData=o.gdprConsent.consentString),void 0!==o.gdprConsent.gdprApplies&&(l.gdprApplies=!!o.gdprConsent.gdprApplies),o.gdprConsent.vendorData&&o.gdprConsent.vendorData.vendorConsents&&void 0!==o.gdprConsent.vendorData.vendorConsents[CRITEO_VENDOR_ID.toString(10)]&&(l.consentGiven=!!o.gdprConsent.vendorData.vendorConsents[CRITEO_VENDOR_ID.toString(10)])),this.metricsManager=new DirectBiddingMetricsManager,this.cache=new DirectBiddingCache(window.criteo_pubtag.context,this.slots,r),this.requestBuilder=new DirectBiddingRequestBuilder(this.cache.filterNoBidSlots(this.slots),window.criteo_pubtag.context,this.metricsManager,new DirectBiddingUrlBuilder(!1),t,a,r,e,l,i),this.url=this.requestBuilder.getUrl(),window.Criteo.prebid_adapters=window.Criteo.prebid_adapters||{},window.Criteo.prebid_adapters[this.auctionId]=this}return o.prototype.buildCdbUrl=o.prototype.buildCdbRequest=function(){if(this.cache.silentModeEnabled())Log.Debug("Request ignored because the global silent mode is enabled");else{if(this.requestBuilder.isValid())return this.timer.sendRequest(this.url),this.requestBuilder.getRequest();Log.Debug("Request ignored because it doesnt contain any slot")}},o.GetAllAdapters=o.GetAdapter=o.prototype.createNativeAd=function(t,e,n){return window.criteo_prebid_native_slots=window.criteo_prebid_native_slots||{},window.criteo_prebid_native_slots[t]={callback:n,payload:e},'<script type="text/javascript">\n            var win = window;\n            for (var i = 0; i < 10; ++i) {\n                win = win.parent;\n                if (win.criteo_prebid_native_slots) {\n                    var responseSlot = win.criteo_prebid_native_slots["'+t+'"];\n                    responseSlot.callback(responseSlot.payload);\n                    break;\n                }\n            }\n        <\/script>'},o.prototype.getBidRequestForSlot=o.prototype.interpretResponse=function(t,e){this.timer.requestReceived();var n=extractExtraData(t),o={};if(void 0!==n.slots)for(var i=0,r=n.slots;i<r.length;i++){o[(c=r[i]).imp_id]=c}var a=[];if(t.slots&&Array.isArray(t.slots))for(var s=0,d=t.slots;s<d.length;s++){var c=d[s],l=this.getBidRequestForSlot(c);if(l){var u=l.bidId,p=c.native?this.createNativeAd(u,c.native,l.params.nativeCallback):c.creative,f=c.ttl||o[c.slotid]&&o[c.slotid].ttl||60;a.push({requestId:u,adId:generateUuid(),cpm:c.cpm,ad:p,currency:c.currency,netRevenue:!0,ttl:f,creativeId:u,width:c.width,height:c.height})}else Log.Error('Could not get bid request for slot "'+c+'"')}return this.cache.handleResponse(this.slots,t,n,!1),this.metricsManager.storeMetric(this.timer.finish(n.slots)),a},o.prototype.handleBidWon=function(t){this.updateMetric(t,},o.prototype.handleBidTimeout=function(){this.timer.requestReceived(!0),this.metricsManager.storeMetric(this.timer.finish())},o.prototype.handleSetTargeting=function(t){var e=this;this.timer.setTargeting(),this.updateMetric(t,},o.prototype.updateMetric=function(t,e){for(var n=this.metricsManager.getMetrics(!1),o=0;o<n.length;++o)for(var i=0,r=n[o].slots;i<r.length;i++){var a=r[i];if(a.adUnitId===t.adUnitCode){var s=e(a);s&&(n[o]=s)}}this.metricsManager.setMetrics(n)},o}();r AdBlocker=function(){eturn a.prototype.isAdBlocked=function(t,e){var n=this,o="https:"===t?"https:":"http:",i=o+a.allowedPixelUrl,r=o+a.blockedPixelUrl;this.createPixel(i,function(){(n.allowedPixelLoaded=!0)===n.blockedPixelFailed&&e(!0)},function(){}),this.createPixel(r,},a.prototype.createPixel=a.allowedPixelUrl="//static.criteo.net/images/pixel.gif?ch=1",a.blockedPixelUrl="//static.criteo.net/images/pixel.gif?ch=2",a}(),__extends$13=(eq=function(t,e){return(eq=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}eq(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),eq,ConditionalEvent=function(r){eturn __extends$13(a,r),a.prototype.canEval=function(){return void 0===this.conditionRequirement||this.conditionRequirement.apply(this)},a.prototype.eval=function(t){this.condition.apply(this)?this.eventIfTrue.eval(t):this.eventIfFalse.eval(t)},a.NAME="conditionalEvent",a}(AbstractEvent),AdFormatType,xq;xq=AdFormatType||(AdFormatType={}),xq[xq.Classic=0]="Classic",xq[xq.StickyFooter=1]="StickyFooter",xq[xq.ScrollingBanner=2]="ScrollingBanner";var CookieHelper=function(){function f(){}return f.SetCookie=function(t,e,n,o,i){void 0===i&&(i=!1);var r=o||document,a=r.location.hostname,s=new Date;s.setTime(s.getTime()+60*n*60*1e3);var d="expires="+s.toUTCString();if(!i)return f.setCookieString(t,e,d,void 0,r),a;for(var c=a.split("."),l=0;l<c.length;++l){var u=c.slice(c.length-l-1,c.length).join(".");f.setCookieString(t,e,d,u,r);var p=f.GetCookie(t,o);if(p&&p===e)return u}return a},f.DeleteCookie=function(t,e,n){void 0===n&&(n=!1),f.SetCookie(t,"",0,e,n)},f.GetCookie=function(t,e){for(var n=0,o=(e||document).cookie.split(";");n<o.length;n++){var i=o[n],r=i.substr(0,i.indexOf("=")).replace(/^\s+|\s+$/g,""),a=i.substr(i.indexOf("=")+1);if(r===t)return decodeURIComponent(a)}},f.setCookieString=function(t,e,n,o,i){var r=t+"="+encodeURIComponent(e)+";"+n+";";o&&""!==o&&(r+="domain=."+o+";"),i.cookie=r+"path=/"},f}(),AdvancedAdFormats=function(){eturn t.prototype.CreateAdvancedAdFormatContainer=function(t){return this.adFormat===AdFormatType.StickyFooter?this.CreateStickyFooterContainer(t):this.adFormat===AdFormatType.ScrollingBanner?this.CreateScrollingBannerContainer(t):void 0},t.prototype.IsUserOptout=function(){return this.adFormat===AdFormatType.StickyFooter&&"true"===CookieHelper.GetCookie("cto_sticky_closed")},t.prototype.CreateStickyFooterContainer=function(t){var e=document.createElement("div");e.style.position="fixed",e.style.zIndex="2147483646",e.style.bottom="0",e.style.left="0",e.style.padding="0",e.style.borderColor="rgb(196, 196, 196)",e.style.width="100%",e.style.backgroundColor="rgba(245, 245, 245, 0.54902)",e.style.borderStyle="solid",e.style.borderWidth="1px";var n=document.createElement("a");e.appendChild(n),n.style.backgroundColor="rgb(221, 221, 221)",n.style.backgroundImage="url('//static.criteo.net/images/criteo/publishertag/close.png')",n.style.backgroundRepeat="no-repeat",n.style.backgroundPosition="center",n.style.display="block",n.style.position="absolute",n.style.left="0",n.style.top="-24px",n.style.width="23px",n.style.height="24px",n.style.borderBottomColor="#6d6c71",n.style.cursor="pointer",n.onclick=function(){e.style.display="none",CookieHelper.SetCookie("cto_sticky_closed","true",24)};var o=document.createElement("div");if(e.appendChild(o),o.id="cto_sticky",o.style.margin="0 auto",o.style.display="table",void 0===t||""===t)document.body.appendChild(e);else{var i=document.getElementById(t);i?i.appendChild(e):Log.Error('Target element "'+t+'" not found in the document')}return o.id},t.prototype.CreateScrollingBannerContainer=function(t){var e,n=this;if(void 0===t||""===t)(e=document.createElement("div")).id="cto_scrolling",document.body.appendChild(e);else{var o=document.getElementById(t);if(!o)return Log.Error('Target element "'+t+'" not found in the document'),t;e=o}var i=e.offsetTop;return window.addEventListener?window.addEventListener("scroll",function(){n.SetScrollingContainerPosition(e,i)},!1):window.attachEvent("onscroll",,this.SetScrollingContainerPosition(e,i),e.id},t.prototype.SetScrollingContainerPosition=function(t,e){var n=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;t.style.top=e-10<=n?(t.style.position="fixed","10px"):(t.style.position="static","auto")},t}(),DisplayContext,sr;sr=DisplayContext||(DisplayContext={}),sr[sr.InFriendlyIframe=1]="InFriendlyIframe",sr[sr.InUnfriendlyIframe=2]="InUnfriendlyIframe",sr[sr.DirectIntegration=3]="DirectIntegration";var DomManipulationTools=function(){function t(){}return t.getHighestAccessibleWindow=t.getHighestAccessibleUrl=t.inIframe=t}(),ViewabilityComputer=function(){eturn r.GetAtfRatio=function(t,e){var n=document.getElementById(e);if(t.displayContext===DisplayContext.DirectIntegration){if(null!==n)return r.GetRatioAboveFold(n);document.write("<div id='compute_visibility_helper' width='0px' height='0px'></div>");var o=document.getElementById("compute_visibility_helper"),i=r.GetRatioAboveFold(o);return o.parentElement.removeChild(o),i}if(t.displayContext===DisplayContext.InFriendlyIframe)return r.GetRatioAboveFold(frameElement)},r.GetRatioAboveFold=function(t){var e=DomManipulationTools.getHighestAccessibleWindow(window).topFrame,n=e.document,o=e.innerHeight||n.documentElement.clientHeight||n.body.clientHeight,i=t.getBoundingClientRect(),r=n.documentElement.scrollTop||n.body.scrollTop;return o>=i.bottom+r?1:o<=i.top+r?0:(o-i.top-r)/t.offsetHeight},r}(),__extends$14=(Sr=function(t,e){return(Sr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}Sr(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Sr,DisplayEvent=function(i){eturn __extends$14(t,i),t.prototype.eval=function(t){this.displayParameters.atfRatio=ViewabilityComputer.GetAtfRatio(t.context,this.displayParameters.containerid)},t.prototype.buildCasUrl=function(e,n,o,i,r){var a=this;hasCMP(window)?retrieveGDPRConsent(window,function(t){e(a.urlBuilder.buildUrl(a.displayParameters,n,o,i,r,t))}):e(this.urlBuilder.buildUrl(this.displayParameters,n,o,i,r))},t}(AbstractEvent),HandlerType,ps;ps=HandlerType||(HandlerType={}),ps[ps.AFR=0]="AFR",ps[ps.AJS=1]="AJS";var __extends$15=(qs=function(t,e){return(qs=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}qs(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),qs,DisplayEventAFR=function(a){function i(t,e,n){var o=a.call(this,i.NAME,t,e)||this;return o.respectsEyeoDeal=n,o}return __extends$15(i,a),i.prototype.eval=function(e){var n=this;a.prototype.eval.call(this,e);var o=this.displayParameters.containerid,i=this.displayParameters.callbackSuccess,r=this.displayParameters.callbackError;this.buildCasUrl(function(t){if(e.context.isAdBlocked){if(!n.respectsEyeoDeal)return;n.loadIframe(t,o,i,r)}else n.loadIframe(t,o,i,r)},e.context,HandlerType.AFR)},i.prototype.loadIframe=function(t,e,n,o){var i=document.createElement("iframe");i.src=t,i.id=e+"_cto_iframe",i.frameBorder="0",i.setAttribute("hspace","0"),i.setAttribute("vspace","0"),i.marginWidth="0px",i.marginHeight="0px",i.width="100%",i.height="100%",i.scrolling="no",n&&(i.onload=n),o&&(i.onerror=o);var r=document.getElementById(e);r?r.appendChild(i):Log.Error('Target element "'+e+'" not found in the document')},i.NAME="displayAfr",i}(DisplayEvent),__extends$16=(Ts=function(t,e){return(Ts=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}Ts(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Ts,DisplayEventAsync=function(_super){function DisplayEventAsync(t,e){return _super.call(this,DisplayEventAsync.NAME,t,e)||this}return __extends$16(DisplayEventAsync,_super),DisplayEventAsync.prototype.eval=function(e){var n=this;_super.prototype.eval.call(this,e);var o=this.displayParameters.containerid,i=this.displayParameters.width,r=this.displayParameters.height,t=this.displayParameters.layout,a=this.displayParameters.callbackSuccess,s=this.displayParameters.callbackError,d=this.displayParameters.passbackCode;if(""===o||void 0===o)Log.Error("No containerid provided");else if(void 0!==t){var c=DisplayEventAsync.CHAPI_NAME+"="+encodeURIComponent(JSON.stringify(t)),l=function(){var t=n.getContainerSize(o,i,r);n.buildCasUrl(e.context,void 0,t.width,t.height)};void 0!==i&&void 0!==r?l():window.addEventListener?window.addEventListener("load",l,!1):window.attachEvent("onload",l)}else this.buildCasUrl(function(t){n.loadScriptAsync(t,void 0,a,s,d)},e.context)},DisplayEventAsync.prototype.loadScriptAsync=function(url,data,callBackSuccess,callbackFail,passbackCode){var request=new AsyncRequest(url,data);request.send(function(responseText){var pb=passbackCode||eval(responseText),void 0!==callBackSuccess&&callBackSuccess(responseText)},function(t,e){void 0!==passbackCode&&passbackCode(),void 0!==callbackFail&&callbackFail(t,e)},passbackCode)},DisplayEventAsync.prototype.getContainerSize=function(t,e,n){var o=document.getElementById(t),i=DomManipulationTools.inIframe(),r=e||(i?document.body.offsetWidth:o?o.offsetWidth:0),a=n||(i?document.body.offsetHeight:o?o.offsetHeight:0);return(0===r||0===a||r<80||a<40)&&(r=a=void 0),{width:r,height:a}},DisplayEventAsync.NAME="displayEventAsync",DisplayEventAsync.CHAPI_NAME="publisherCreativeConfiguration",DisplayEventAsync}(DisplayEvent),__extends$17=(Bt=function(t,e){return(Bt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}Bt(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Bt,DisplayEventSync=function(n){eturn __extends$17(o,n),o.prototype.eval=function(t){var e=this;n.prototype.eval.call(this,t),this.buildCasUrl(t.context)},o.prototype.loadScriptSync=o.NAME="displaySync",o}(DisplayEvent),__extends$18=(Ut=,Ut,DisplayInputParameters=function(n){function t(t){var e=n.call(this)||this;return e.zoneid=void 0,e.async=void 0,e.containerid=void 0,e.width=void 0,e.height=void 0,e.callbackSuccess=void 0,e.callbackError=void 0,e.callIfNotAdblocked=void 0,e.passbackCode=void 0,e.publisherUrl=void 0,e.overridenWpdt0=void 0,e.overridenCt0=void 0,e.layout=void 0,e.atfRatio=void 0,e.adFormat=AdFormatType.Classic,e.overrideZoneFloor=!0,e.collapseContainerIfNotAdblocked=!0,e.extraData={},e.addParameter("zoneId",function(t){e.zoneid=t}),e.addParameter("async",,e.addParameter("containerId",function(t){e.containerid=t}),e.addParameter("width",function(t){e.width=t}),e.addParameter("height",function(t){e.height=t}),e.addParameter("callbackSuccess",function(t){e.callbackSuccess=t}),e.addParameter("callbackError",function(t){e.callbackError=t}),e.addParameter("callIfNotAdblocked",function(t){e.callIfNotAdblocked=t}),e.addParameter("passbackCode",function(t){e.passbackCode=t}),e.addParameter("layout",function(t){e.layout=t}),e.addParameter("publisherCreativeConfiguration",,e.addParameter("extraData",function(t){e.extraData=t}),e.addParameter("publisherUrl",function(t){e.publisherUrl=t}),e.addParameter("wpdt0",function(t){e.overridenWpdt0=t}),e.addParameter("ct0",function(t){e.overridenCt0=t}),e.addParameter("overrideZoneFloor",function(t){e.overrideZoneFloor=t}),e.addParameter("collapseContainerIfNotAdblocked",function(t){e.collapseContainerIfNotAdblocked=t}),e.addParameter("adFormat",function(t){e.adFormat=e.parseAdFormat(t)}),n.prototype.tryFillParameters.call(e,t),e}return __extends$18(t,n),t.prototype.parseAdFormat=t}(InputParameters),DisplayUrlBuilder=function(){function l(){}return l.prototype.buildUrl=function(t,e,n,o,i,r){var a;a=n===HandlerType.AFR?l.CAS_URL_AFR:l.CAS_URL_AJS;var s=("https:"===e.protocol?"https:":"http:")+a+"?ptv="+PublisherTagVersion;if(!0===e.isAdBlocked){var d=this.getAbpParameter(t,e);s+="&abp="+String(d)}for(var c in n!==HandlerType.AFR&&(s+=void 0!==t.containerid&&""!==t.containerid?"&containerid="+encodeURIComponent(t.containerid):""),s+="&zoneid="+String(t.zoneid),s+=o?"&width="+o:"",s+=i?"&height="+i:"",s+=e.ctoIdOnPublisherDomain?"&idcpy="+e.ctoIdOnPublisherDomain:"",s+=e.idfs?"&idfs="+e.idfs:"",s+=e.secureId?"&sid="+e.secureId:"",s+=e.isOptOut?"&optout=1":"",s+="&cb="+String(CacheBusterGenerator.generateCacheBuster()),s+="&nodis="+(e.dising?"0":"1"),s+=e.charset?"&charset="+e.charset:"",s+=t.overridenCt0?"&ct0="+encodeURIComponent(t.overridenCt0):e.ct0?"&ct0="+encodeURIComponent(e.ct0):"",s+=t.overridenWpdt0?"&wpdt0="+encodeURIComponent(t.overridenWpdt0):e.wpdt0?"&wpdt0="+encodeURIComponent(e.wpdt0):"",t.publisherUrl&&(s+="&publisherurl="+encodeURIComponent(t.publisherUrl)),s+=e.getContextFlags(),t.extraData)void 0!==t.extraData[c]&&(s+="&"+c+"="+encodeURIComponent(t.extraData[c]));(s+=t.passbackCode?"&dlp=1":"",t.integrationMode!==IntegrationMode.Unspecified&&(s+="&im="+t.integrationMode),s+="&dc="+e.displayContext,void 0!==t.atfRatio)&&(s+="&atfr="+Math.round(100*t.atfRatio)/100);return s+=e.highestAccessibleUrl?"&loc="+encodeURIComponent(e.highestAccessibleUrl).substring(0,1600):"",r&&(void 0!==r.consentData&&(s+=r.consentData?"&gdprDta="+r.consentData:""),void 0!==r.consentGiven&&(s+="&gdprGvn="+(r.consentGiven?"1":"0")),void 0!==r.gdprApplies&&(s+="&gdprApp="+(r.gdprApplies?"1":"0"))),s},l.prototype.getAbpParameter=function(t,e){return(e.isAdBlocked?1:0)|(t.overrideZoneFloor?0:2)},l.CAS_URL_AJS="//cas.criteo.com/delivery/ajs.php",l.CAS_URL_AFR="//cas.criteo.com/delivery/afr.php",l}(),EyeoDealValidator=function(){function a(){}return a.prototype.respectsEyeoDeal=function(t){var e=document.getElementById(t);if(!this.respectsSizeConstraints(e))return Log.Debug("The element "+t+"does not respect Eyeo acceptable ads size constraints"),!1;var n=this.getNewRatiosFeatures(e),o=n.respectsAdRatioConstraint;return o?(a.atfRatio=n.newAtfRatio,a.btfRatio=n.newBtfRatio):Log.Debug("The element "+t+"does not respect Eyeo acceptable ads ratio constraints"),o},a.prototype.respectsSizeConstraints=function(t){var e=this.getAdLocationAttribute(t);switch(e){case"above-content":return t.offsetHeight<=200;case"in-content":return!1;case"below-content":return t.offsetHeight<=400;case"side-content":return t.offsetWidth<=350;default:return void 0!==e&&Log.Error("Unknown data-ad-loc attribute : "+e),!0}},a.prototype.getAdLocationAttribute=a.prototype.getNewRatiosFeatures=function(t){var e=ViewabilityComputer.GetRatioAboveFold(t),n=t.offsetHeight*t.offsetWidth,o=screen.width*screen.height,i=a.atfRatio+e*n/o,r=a.btfRatio+(1-e)*n/o;return{respectsAdRatioConstraint:i<=.15&&r<=.25,newAtfRatio:i,newBtfRatio:r}},a.atfRatio=0,a.btfRatio=0,a}();function DisplayAd(t){var e=new DisplayInputParameters(t);if(e.async=!1!==e.async,void 0!==e.zoneid)if(void 0===e.layout||!1!==e.async)if(!0!==e.async||void 0!==e.containerid&&""!==e.containerid){if(!1===e.async&&void 0!==e.passbackCode&&(Log.Error("Criteo.DisplayAd does not support synchronous local passback"),e.passbackCode=void 0),e.adFormat!==AdFormatType.Classic){var n=new AdvancedAdFormats(e.adFormat);if(n.IsUserOptout())return void Log.Debug("The user has opted-out for 1 day when closing the sticky footer.");e.containerid=n.CreateAdvancedAdFormatContainer(e.containerid)}var o;o=e.async?new DisplayEventAsync(new DisplayUrlBuilder,e):new DisplayEventSync(new DisplayUrlBuilder,e),window.criteo_pubtag.push(o)}else Log.Error("Missing parameter 'containerid' for an async display");else Log.Error("Criteo hosted ads only work in async mode");else Log.Error("missing parameter 'zoneid'")}function DisplayAcceptableAdIfAdblocked(t){var e=new DisplayInputParameters(t);if(void 0!==e.zoneid)if(void 0!==e.containerid&&""!==e.containerid){var n=document.getElementById(e.containerid);if(isVisible(n)){var o=window.criteo_pubtag.context;if(void 0===o.isAdBlocked)(new AdBlocker).isAdBlocked(o.protocol,;var i,r,a=new EyeoDealValidator;i=new DisplayEventAFR(new DisplayUrlBuilder,e,a.respectsEyeoDeal(e.containerid)),r=new Custom(function(){e.collapseContainerIfNotAdblocked&&(n.style.display="none"),void 0!==e.callIfNotAdblocked&&e.callIfNotAdblocked()});var s;s=new ConditionalEvent(function(){return!0===window.criteo_pubtag.context.isAdBlocked},i,r,,window.criteo_pubtag.push(s)}else Log.Error("can't display acceptable ad : the container \""+e.containerid+'" is not visible')}else Log.Error("missing parameter 'containerid' to display acceptable ads");else Log.Error("missing parameter 'zoneid'")}function isVisible(t){if(t===document)return!0;if(!t)return!1;if(!t.parentNode)return!1;if(t.style){if("none"===t.style.display)return!1;if("hidden"===t.style.visibility)return!1}if(window.getComputedStyle){var e=window.getComputedStyle(t,"");if("none"===e.display)return!1;if("hidden"===e.visibility)return!1}var n=t.currentStyle;if(n){if("none"===n.display)return!1;if("hidden"===n.visibility)return!1}return isVisible(t.parentNode)}var Polyfills=function(){function t(){}return t.LoadPolyfills=t.DefineIsArray=t.DefineIndexOf=t.DefineFilter=t}(),StorageOrigin,Pv;=StorageOrigin||(StorageOrigin={}),Pv[Pv.None=0]="None",Pv[Pv.Cookie=1]="Cookie",Pv[Pv.LocalStorage=2]="LocalStorage";var CookieSynchronizer=function(){function o(t,e,n){this.isDebug=e,this.topWin=t,this.topDoc=t.document,this.localStorageHelper=new LocalStorageHelper(this.topWin),this.localStorageEnabled=this.localStorageHelper.checkLocalStorage(),this.canWriteCookies=this.checkCookiesAreWriteable(),this.topUrl=n}return o.isSafariBrowser=function(){return null!==navigator.userAgent.match(o.SAFARI_CHECK_REGEX)},o.isAndroidBrowser=function(){return-1<navigator.userAgent.toLowerCase().indexOf("android")},o.isFirefoxBrowser=o.prototype.synchronizeCriteoUid=function(t){var e=this;if((t||o.isSafariBrowser()||o.isAndroidBrowser()||o.isFirefoxBrowser())&&this.topWin.addEventListener)if("complete"===this.topDoc.readyState)this.appendGumIframeIfDoesNotExist();else{var n=function(){e.topDoc.removeEventListener("DOMContentLoaded",n),e.topWin.removeEventListener("load",n),e.appendGumIframeIfDoesNotExist()};this.topWin.addEventListener("load",n,!1),this.topDoc.addEventListener("DOMContentLoaded",n,!1)}},o.prototype.appendGumIframeIfDoesNotExist=function(){var n=this,t=this.createGumIframe();this.topDoc.getElementById(o.SYNCFRAME_ID)||(this.topWin.addEventListener("message",function(t){var e=t.data;e&&e.isCriteoMessage&&(t.stopImmediatePropagation(),e.optout?(n.setClientSideOptOut(),n.deleteClientSideUid(),n.deleteClientSideIdfs(),n.deleteClientSideSecureId()):(e.uid&&n.setClientSideUid(e.uid),e.idfs&&n.setClientSideIdfs(e.idfs),e.removeSid?n.deleteClientSideSecureId():e.sid&&n.setClientSideSecureId(e.sid)))},!0),this.topDoc.body.appendChild(t))},o.prototype.getClientSideUid=function(){return this.getFromAllStorages(o.GUID_COOKIE_NAME)},o.prototype.setClientSideUid=function(t){this.writeOnAllStorages(o.GUID_COOKIE_NAME,t,o.GUID_RETENTION_TIME_HOUR)},o.prototype.deleteClientSideUid=function(){this.deleteFromAllStorage(o.GUID_COOKIE_NAME)},o.prototype.getClientSideOptOut=function(){var t=this.getFromAllStorages(o.OPTOUT_COOKIE_NAME);return{value:"1"===t.value,origin:t.origin}},o.prototype.setClientSideOptOut=o.prototype.deleteClientSideIdfs=function(){this.deleteFromAllStorage(o.IDFS_COOKIE_NAME)},o.prototype.getClientSideIdfs=function(){return this.getFromAllStorages(o.IDFS_COOKIE_NAME)},o.prototype.setClientSideIdfs=function(t){this.writeOnAllStorages(o.IDFS_COOKIE_NAME,t,o.GUID_RETENTION_TIME_HOUR)},o.prototype.getClientSideSecureId=o.prototype.setClientSideSecureId=o.prototype.deleteClientSideSecureId=o.prototype.getLocalWebId=function(){var t=this.getFromAllStorages(o.LOCAL_WEB_ID_COOKIE_NAME);if(this.canWriteCookies){var e=t.value;e||(e=generateUuid()),this.writeOnAllStorages(o.LOCAL_WEB_ID_COOKIE_NAME,String(e),o.GUID_RETENTION_TIME_HOUR),t=this.getFromAllStorages(o.LOCAL_WEB_ID_COOKIE_NAME)}return t.value&&t||{value:"NA",origin:StorageOrigin.None}},o.prototype.checkCookiesAreWriteable=function(){var t="cto_writeable";CookieHelper.SetCookie(t,"1",1,this.topDoc,!0);var e="1"===CookieHelper.GetCookie(t,this.topDoc);return CookieHelper.DeleteCookie(t,this.topDoc,!0),e},o.prototype.createGumIframe=function(){var t=this.topDoc.createElement("iframe"),e=this.buildSyncframeSrc();return t.src=e,t.id=o.SYNCFRAME_ID,t.style.display="none",t},o.prototype.writeOnAllStorages=function(t,e,n){this.localStorageEnabled&&this.localStorageHelper.setItem(t,e),CookieHelper.SetCookie(t,e,n,this.topDoc,!0)},o.prototype.getFromAllStorages=function(t){var e,n=CookieHelper.GetCookie(t,this.topDoc);return this.localStorageEnabled&&(e=this.localStorageHelper.getItem(t)||void 0),{value:n||e,origin:(n&&StorageOrigin.Cookie)|(e&&StorageOrigin.LocalStorage)}},o.prototype.deleteFromAllStorage=function(t){CookieHelper.DeleteCookie(t,this.topDoc,!0),this.localStorageEnabled&&this.localStorageHelper.removeItem(t)},o.prototype.getTld=function(){var t=CookieHelper.SetCookie(o.TLD_TEST_COOKIE_NAME,"test",1,this.topDoc,!0);return CookieHelper.DeleteCookie(o.TLD_TEST_COOKIE_NAME,this.topDoc,!0),t},o.prototype.buildSyncframeSrc=function(){var t=this.getClientSideUid(),e=this.getClientSideIdfs(),n=this.getClientSideOptOut(),o=this.getClientSideSecureId(),i=this.getLocalWebId(),r=this.getTld(),a=encodeURIComponent(parseUri(this.topUrl).hostname),s=PublisherTagVersion,d="https://gum.criteo.com/syncframe?topUrl="+a+(this.isDebug?"&debug=1":"");return d+="#"+JSON.stringify({optout:n,uid:t,idfs:e,sid:o,origin:"publishertag",version:s,lwid:i,tld:r,topUrl:a})},o.GUID_COOKIE_NAME="cto_idcpy",o.GUID_RETENTION_TIME_HOUR=9360,o.IDFS_COOKIE_NAME="cto_idfs",o.SECURE_ID_COOKIE_NAME="cto_sid",o.LOCAL_WEB_ID_COOKIE_NAME="cto_lwid",o.OPTOUT_COOKIE_NAME="cto_optout",o.OPTOUT_RETENTION_TIME_HOUR=43200,o.TLD_TEST_COOKIE_NAME="cto_pub_test_tld",o.SYNCFRAME_ID="criteo-syncframe",o.SAFARI_CHECK_REGEX=/^Mozilla\/5\.0 \([^)]+\) AppleWebKit\/[^ ]+ \(KHTML, like Gecko\) Version\/([^ ]+)( Mobile\/[^ ]+)? Safari\/[^ ]+$/i,o}(),Context=function(){function t(t,e){this.charset=t.charset||t.characterSet||"";var n=DomManipulationTools.getHighestAccessibleWindow(e);this.displayContext=this.getDisplayContext(n),this.highestAccessibleUrl=DomManipulationTools.getHighestAccessibleUrl(n),this.synchronizeCriteoUid(n,this.highestAccessibleUrl);var o=this.getQueryStringParams(this.highestAccessibleUrl);this.debugMode="1"===o.pbt_debug||!1,this.noLog="1"===o.pbt_nolog||!1,this.shouldIgnoreSilentMode=this.computeShouldIgnoreSilentMode(),this.silentModeIgnored=!1,this.debugMode&&SetLogLevel(LogLevel.Debug),this.location=e.location,this.protocol=e.location.protocol,this.dising=!1,this.ct0=void 0,this.wpdt0=void 0,this.isAdBlocked=void 0,this.rtaVarNames=[]}return t.prototype.getContextFlags=t.prototype.getDisplayContext=t.prototype.getQueryStringParams=function(t){var e={},n=t.split("?");if(1<n.length)for(var o=0,i=n[1].split("&");o<i.length;o++){var r=i[o].split("=");e[tryDecodeURIComponent(r[0])]=tryDecodeURIComponent(r[1])}return e},t.prototype.synchronizeCriteoUid=function(t,e){var n=t.topFrame,o=new CookieSynchronizer(n,this.debugMode,e);this.ctoIdOnPublisherDomain=o.getClientSideUid().value,this.isOptOut=o.getClientSideOptOut().value,this.idfs=o.getClientSideIdfs().value,this.secureId=o.getClientSideSecureId().value,o.synchronizeCriteoUid()},t.prototype.getIdfs=t.prototype.setIdfs=function(t){var e=t.split(":");e[0]&&(this.idfs=e[0]),e[1]&&(this.secureId=e[1])},t.prototype.computeShouldIgnoreSilentMode=function(){return Math.floor(100*Math.random())<5},t.prototype.setSilentModeIgnored=t}(),StandaloneDirectBidder=ar PublisherTag=function(){function t(){this.standaloneBidder=new StandaloneDirectBidder,this.events=[],this.context=new Context(document,window),Log.Debug("Publisher Tag loaded")}return t.prototype.push=t.prototype.evalEvents=t.VERSION=PublisherTagVersion,t}();function safeFunction(t){var e=t,n=function(){try{return e.apply(this,arguments)}catch(t){Log.Error("Exception caught: "+t.toString())}};for(var o in n.prototype=e.prototype,e)e.hasOwnProperty(o)&&(n[o]=e[o]);return n}function safeObject(t){for(var e in t)if(t.hasOwnProperty(e)){var n=t[e];"function"==typeof n?t[e]=safeFunction(n):"object"==typeof n&&(t[e]=safeObject(n))}return t}ar __extends$19=(zx=function(t,e){return(zx=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}zx(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),zx,DefaultCrtgContentName="crtg_content",DefaultCrtgRtaCookieName="crtg_rta",RtaInputParameters=function(n){function t(t){var e=n.call(this)||this;return e.networkId=void 0,e.crtgContentName=void 0,e.crtgRtaCookieName=void 0,e.adserver=void 0,e.addParameter("networkId",function(t){e.networkId=t}),e.addParameter("varName",function(t){e.crtgContentName=t}),e.addParameter("cookieName",function(t){e.crtgRtaCookieName=t}),e.addParameter("adserver",function(t){e.adserver=t}),n.prototype.tryFillParameters.call(e,t),e}return __extends$19(t,n),t}(InputParameters),__extends$20=(Sx=function(t,e){return(Sx=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}Sx(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Sx,RtaEvent=function(_super){function RtaEvent(t,e){var n=_super.call(this,RtaEvent.NAME)||this;return n.urlBuilder=t,n.parameters=e,n}return __extends$20(RtaEvent,_super),RtaEvent.prototype.eval=function(t){_super.prototype.eval.call(this,t);var e=this.urlBuilder.buildUrl(this.parameters,t.context),n=new AsyncRequest(e),o=this.parameters.crtgContentName||DefaultCrtgContentName;-1===t.context.rtaVarNames.indexOf(o,0)&&t.context.rtaVarNames.push(o),n.send(this.executeScript,},RtaEvent.prototype.executeScript=function(responseText){eval(responseText)},RtaEvent.NAME="rtaEvent",RtaEvent}(AbstractEvent);function ExtractKeyValuesFromRtaResponse(t){if(void 0===t||""===t)return{};for(var e={},n=0,o=t.split(";");n<o.length;n++){var i=o[n];if(""!==i){var r=i.split("=");if(2===r.length){var a=r[0],s=r[1];e[a]=e[a]||[],e[a].push(""+s)}}}return e}var __extends$21=(ty=function(t,e){return(ty=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}ty(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),ty,RtaTargetingEvent=function(o){eturn __extends$21(i,o),i.prototype.eval=function(t){if(void 0!==this.adserver)switch(this.adserver.toLowerCase()){case"dfp":this.setTargetingDFP(this.targetingValues);break;default:Log.Error("unknown adserver '"+this.adserver+"'")}else Log.Error("undefined adserver")},i.prototype.setTargetingDFP=i.NAME="rtaTargetingEvent",i}(AbstractEvent),RtaUrlBuilder=function(){function o(){}return o.prototype.buildUrl=function(t,e){var n=("https:"===e.protocol?"https:":"http:")+o.RTA_URL+"?ptv="+PublisherTagVersion;return!0===e.isAdBlocked&&(n+="&abp=1"),n+="&netid="+String(t.networkId),n+=e.ctoIdOnPublisherDomain?"&idcpy="+e.ctoIdOnPublisherDomain:"",n+=e.idfs?"&idfs="+e.idfs:"",n+=e.secureId?"&sid="+e.secureId:"",n+=e.isOptOut?"&optout=1":"",t.crtgRtaCookieName&&(n+="&cookieName="+encodeURIComponent(t.crtgRtaCookieName)),t.crtgContentName&&(n+="&varName="+encodeURIComponent(t.crtgContentName)),n+="&rnd="+String(CacheBusterGenerator.generateCacheBuster()),n+=e.getContextFlags(),t.integrationMode!==IntegrationMode.Unspecified&&(n+="&im="+t.integrationMode),n},o.RTA_URL="//rtax.criteo.com/delivery/rta/rta.js",o}();function CallRTA(t){var e=new RtaInputParameters(t);if(void 0!==e.networkId){var n=e.crtgContentName?e.crtgContentName:DefaultCrtgContentName,o=e.crtgRtaCookieName?e.crtgRtaCookieName:DefaultCrtgRtaCookieName;window[n]=CookieHelper.GetCookie(o)||"";var i=new RtaEvent(new RtaUrlBuilder,e);window.criteo_pubtag.push(i)}else Log.Error("missing parameter 'networkid'")}function SetTargeting(t){var e=new RtaInputParameters(t);if(void 0!==e.adserver){var n=[];if(void 0!==e.crtgContentName)n.push(e.crtgContentName);else if(0<window.criteo_pubtag.context.rtaVarNames.length)for(var o=0,i=window.criteo_pubtag.context.rtaVarNames;o<i.length;o++){var r=i[o];n.push(r)}else n.push(DefaultCrtgContentName);for(var a=0,s=n;a<s.length;a++){var d=s[a],c=ExtractKeyValuesFromRtaResponse(window[d]),l=new RtaTargetingEvent(e.adserver,c);window.criteo_pubtag.push(l),RemoveCrtgContentNameFromPublisherTagContext(d)}}else Log.Error("missing parameter 'adserver'")}function ComputeDFPTargetingForAMP(t,e){var n=ExtractKeyValuesFromRtaResponse(CookieHelper.GetCookie(t));return RemoveCrtgContentNameFromPublisherTagContext(e),n}function RemoveCrtgContentNameFromPublisherTagContext(t){var e=window.criteo_pubtag.context.rtaVarNames.indexOf(t,0);-1<e&&window.criteo_pubtag.context.rtaVarNames.splice(e,1)}var passbackProfileId=206;function SetupPassbackEventQueue(){window.Criteo.passbackEvents=createEventProcessor(window.Criteo.passbackEvents)}unction RenderAdPassback(t,e,n,o){var i;"string"==typeof t?i=t:(i=getParam(t,"adUnit","string"),e=getParam(t,"passback","function"),n=getParam(t,"customRenderFunction","function"),o=getParam(t,"minimumBidPrice","number")),void 0!==i?void 0!==e?("function"!=typeof n&&(n=,window.Criteo.passbackEvents=window.Criteo.passbackEvents||[],window.Criteo.passbackEvents.push():Log.Error("A passback callback should be provided"):Log.Error("An adUnit string parameter should be provided")}window.criteo_pubtag||(Polyfills.LoadPolyfills(),window.criteo_pubtag=new PublisherTag),window.Criteo=safeObject({CallRTA:CallRTA,ComputeDFPTargetingForAMP:ComputeDFPTargetingForAMP,SetTargeting:SetTargeting,DisplayAd:DisplayAd,DisplayAcceptableAdIfAdblocked:DisplayAcceptableAdIfAdblocked,ComputeStandaloneDFPTargeting:ComputeStandaloneDFPTargeting,GetBids:GetBids,GetBidsForAdUnit:GetBidsForAdUnit,RenderAd:RenderAd,RequestBids:RequestBids,RequestBidsOnGoogleTagSlots:RequestBidsOnGoogleTagSlots,SetDFPKeyValueTargeting:SetDFPKeyValueTargeting,SetLineItemRanges:SetLineItemRanges,Passback:{RequestBids:RequestBidsPassback,RenderAd:RenderAdPassback},PubTag:{Adapters:{AMP:AMP,Prebid:Prebid},Context:{SetIdfs:SetIdfs,GetIdfs:GetIdfs},DirectBidding:{DirectBiddingEvent:DirectBiddingEventWithCaching,DirectBiddingSlot:DirectBiddingSlot,DirectBiddingUrlBuilder:DirectBiddingUrlBuilder,Size:Size},RTA:{DefaultCrtgContentName:DefaultCrtgContentName,DefaultCrtgRtaCookieName:DefaultCrtgRtaCookieName}},events:window.Criteo?window.Criteo.events:[],passbackEvents:window.Criteo?window.Criteo.passbackEvents:[],usePrebidEvents:!window.Criteo||window.Criteo.usePrebidEvents}),window.Criteo.events=createEventProcessor(window.Criteo.events)}();