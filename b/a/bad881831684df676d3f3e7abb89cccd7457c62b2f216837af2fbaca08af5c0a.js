(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[98],{"005W":function(e,t,n){"use strict";n.r(t),n.d(t,"WacContentModuleNgFactory",(function(){return re}));var o=n("keVe"),i=n("EUVs"),r=function(){function e(e){this.wacContentService=e}return e.prototype.ngOnInit=e.prototype.trackByBootId=e}(),s=r,a=),c=n("fYis"),l=function(){eturn e.prototype.ngOnDestroy=e}(),u=o.Fb({encapsulation:2,styles:[],data:{}});ar p=o.Db("ohp-wac-content-loader",l,(function(e){return o.jc(0,[(e()(),o.Hb(0,0,null,null,1,"ohp-wac-content-loader",[],null,null,null,d,u)),o.Gb(1,180224,null,0,l,[i.a],null,null)],null,null)}),{},{},[]),h=n("TOqr"),f=n("QjXU"),v=n("Dn7E"),m=n("kxm0"),b=n("AlWG"),g=n("qSxk"),S=n("2dXW"),I=n("zvoD"),y=n("3Vsh"),w=n("RZvG"),A=n("f0qX"),C=n("zKXa"),H=n("OPwp"),T=n("3GGT"),E=n("hhzZ"),k=n("BaAg"),U=n("kpuN"),O=n("OWzB"),D=n("hZW2"),R=n("EYcb"),_=n("1LNb"),F=n("Z0U4"),P=n("dmOj"),W=n("5aVq"),M=n("Xc4i"),j=n("TIi1"),N=n("BMb5"),G=n("hoyd"),x=n("pOWU"),B=n("4/We"),L=n("/I02"),V=n("ufVG"),q=n("IBRu"),z=n("pjz5"),J=n("y9oG"),X=(n("bEJa"),function(){function e(e,t,n,o,i,r,s,a,c,l,u,d,p,h,f,v,m,g,S,I){this.accessTokenService=e,this.capabilitiesService=t,this.createDocumentService=n,this.contextService=o,this.documentService=i,this.errorDialogService=r,this.feedbackService=s,this.instrumentationService=a,this.officeRouteService=c,this.officeTitleService=l,this.reactShellConfigService=u,this.shareControlService=d,this.moveToFolderControlService=p,this.shellShimService=h,this.titleService=f,this.uiHostBootstrapperService=v,this.wacContentService=m,this.windowService=g,this.workloadsService=S,this.urlLauncherService=I,this.saveStatus="Saved",this.deferredError="None",this.queuedMessages=[],this.inProgress=!1,this.visibleSubject=new b.a(this.visible)}return Object.defineProperty(e.prototype,"visible",{get:set:function(e){this._visible=e,this.showError(this.deferredError),this.visibleSubject.next(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bootAndLoadInfo",{set:function(e){if(e){var t=e.correlationId,n=e.bootedDocumentInfo;this.wacPendingLoadData=e.data,this.correlationId=t,n&&(this.bootId=n.bootId,this.documentInfo=n.documentInfo)}},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=e.prototype.ngAfterViewInit=function(){var e=this;this.visibleSubscription=this.visibleSubject.asObservable().pipe(Object(I.a)((),Object(y.a)(1)).subscribe((function(){return Object(f.__awaiter)(e,void 0,void 0,(function(){var e,t=this;return Object(f.__generator)(this,(function(n){switch(n.label){case 0:return this.instrumentPageView(),this.fileNamePromise.then((),this.shellHeader=this.documentService.nativeDocument.querySelector("#ReactShellHeader"),this.shellHeader&&this.shellHeader.childElementCount?(this.documentService.addCssClassToElement(this.shellHeader,i.a.HiddenShellClass),[4,this.shellShimService.getShellShim()]):[3,2];case 1:(e=n.sent()).Notifications.MuteToasts&&e.Notifications.MuteToasts(),e.FlexPane.CloseFlexPaneForProvider(null),n.label=2;case 2:return[2]}}))}))})),this.listenForApplicationBoot()},e.prototype.ngOnDestroy=e.prototype.renameDocument=e.prototype.checkAndInstrumentAbandon=e.prototype.bootDocument=function(){var e=this;this.uiHostBootstrapperService.logPerformanceEventFromClick(this.bootId,"WacContent_Document_Component_Loaded",this.documentInfo.fileType);var t=this.wacPendingLoadData,n=t.fileNamePromise,o=t.documentIdentifierPromise;this.bootstrapperObservable=t.bootstrapperObservable,this.visible||this.instrumentDocumentPreload(),this.fileNamePromise=n,null==o||o.then((function(t){t&&e.wacContentService.updateInformation(e.bootId,t,e.visible,!0)}))},e.prototype.listenForApplicationBoot=function(){var e=this;this.flushTime=Date.now(),this.appLoadSubscription=this.bootstrapperObservable.pipe(Object(w.a)(()).subscribe((,(function(t){(null==t?void 0:t.instrumentationEvent)||(t={instrumentationEvent:"WacDocument_Generic_Boot_Error",error:t}),e.instrumentBootError(t);var n=t.error,o=n instanceof x.b?x.a.getErrorTypeFromServiceError(n):"Generic";e.showError(o)}))},e.prototype.tearDownApp=function(e){return void 0===e&&(e=!1),Object(f.__awaiter)(this,void 0,void 0,(function(){var t,n,o;return Object(f.__generator)(this,(function(i){switch(i.label){case 0:if(this.appLoadSubscription&&this.appLoadSubscription.unsubscribe(),this.appPostMessageSubscription&&this.appPostMessageSubscription.unsubscribe(),this.visibleSubscription&&this.visibleSubscription.unsubscribe(),this.errorDismissSubject&&(this.errorDismissSubject.next(),this.errorDismissSubject.complete()),!this.officeApplication)return[3,2];switch(this.documentInfo.fileType!==k.b.PowerPoint&&(this.officeApplication.RemoveEventHandler("UI_Sharing",this.shareHandler),this.officeApplication.RemoveEventHandler("File_Rename",this.renameHandler),this.officeApplication.RemoveEventHandler("UI_SaveStatus",this.saveStatusHandler),this.officeApplication.RemoveEventHandler("UI_CheckUserAccessAndGrantPermissions",this.userAccessHandler),this.officeApplication.RemoveEventHandler("SetOverlayContent",this.setContentOverlayHandler),this.officeApplication.RemoveEventHandler("User_Activity",this.userActivityHandler),this.officeApplication.RemoveEventHandler("GetAuthToken",this.getAuthTokenHandler),this.officeApplication.RemoveEventHandler("GetCustomAuthConfig",this.getCustomAuthConfigHandler),this.officeApplication.RemoveEventHandler("MoveToFolder",this.moveToFolderHandler)),this.documentInfo.fileType===k.b.Excel&&this.officeApplication.RemoveEventHandler("WopiInfoFromUrl",this.getWopiInfoFromUrlHandler),this.officeApplication.RemoveEventHandler("DocReboot",this.documentRebootHandler),t=Object(f.__read)(Object(q.a)(),2),n=t[0],o=t[1],this.documentInfo.fileType){case k.b.Word:this.officeApplication.RemoveErrorHandler(this.errorHandler),this.officeApplication.RegisterEventHandler("Disposed",o);break;case k.b.Excel:this.officeApplication.RemoveErrorHandler(this.errorHandler),this.officeApplication.RegisterEventHandler("Disposed",o),this.queuedMessages=[],this.inProgress=!1;break;case k.b.Visio:o();break;default:this.officeApplication.RegisterEventHandler("Unloaded",o)}return this.officeApplication.Dispose(),[4,n];case 1:i.sent(),this.officeApplication=void 0,i.label=2;case 2:return e&&(this.wacContainer.nativeElement.innerText=""),[2]}}))}))},e.prototype.initApp=function(t,n){var o=this;if(t&&n){this.queuedMessages=[],this.inProgress=!1,this.wacContentService.markBootCompleted(this.bootId),this.officeApplication=t,this.officeApplicationUrl=n.wac.applicationUrl,this.errorHandler=this.shareHandler=function(e){o.instrumentAppEvent("UI_Sharing"),o.checkSessionId(e)&&o.shareControlService.showControl({file:o.convertToMruFileItem(o.documentInfo,n),index:0,mode:H.b.getShareControlModeFromString(e.mode),nav:e.nav})},this.saveStatusHandler=function(e){o.instrumentAppEvent("UI_SaveStatus"),o.checkSessionId(e)&&(o.saveStatus=e.StatusText||"Saved")},this.renameHandler=function(e){o.instrumentAppEvent("File_Rename"),o.checkSessionId(e)&&(o.docTitle=e.NewName||o.docTitle,o.setPageTitle())},this.userAccessHandler=function(e){o.instrumentAppEvent("UI_CheckUserAccessAndGrantPermissions"),o.checkSessionId(e)&&o.shareControlService.showControl({file:o.convertToMruFileItem(o.documentInfo,n),index:0,mode:H.a.AtMention,defaultRecipients:e.Persons.map((function(e){return e.Id})),onGrantAccessComplete:function(t,n,i){void 0===n&&(n=!1),o.postMessageUIHost("CheckUserAccessAndGrantPermissions_Result",{Persons:e.Persons.map((function(e){return{Id:e.Id,Provider:e.Provider,Status:t?0:3,Reason:""}})),DialogCanceled:n,Id:e.Id})}})},this.documentRebootHandler=function(e){if(o.instrumentAppEvent("DocReboot"),o.checkSessionId(e)){var t={};if(e.queryOverrides)try{t=JSON.parse(e.queryOverrides)}catch(e){t={}}var n=Object(f.__assign)(Object(f.__assign)({},e),{queryOverrides:t});switch(e.rebootMode){case"1":o.wacContentService.bootstrapAndRoute({docUrl:e.documentUrl,fileType:o.documentInfo.fileType,wdOrigin:o.contextService.getWdOrigin("BACKSTAGE-MRU"),rebootOverrideData:n},void 0,Date.now());break;default:var i=Object(f.__assign)(Object(f.__assign)({},o.documentInfo),{wdOrigin:o.contextService.getWdOrigin("REBOOT"),rebootOverrideData:n});o.tearDownApp().then(()}}};var i=function(e){o.checkSessionId(e)&&o.uiHostBootstrapperService.getWopiData(o.documentInfo,!1,!0).then((function(t){if(t){var n=t.wopiHostData.wac,i=e.Tokens.map(();o.postMessageUIHost("Host_RefreshSessionInfo",{Tokens:i})}})).catch((function(t){if(t.httpResponse.status===T.a.TokenUnavailable){var n=t.httpResponse.subStatus;t.httpResponse.status=null!=n&&(n<400||n>=500)?n:T.a.Unauthorized}var i=e.Tokens.map((function(e){return{Name:e,Errors:[{Id:t.httpResponse.status.toString(),Details:new E.d(JSON.stringify(t))}]}}));o.postMessageUIHost("Host_RefreshSessionInfo",{Tokens:i})}))};this.createNewHandler=function(e){if(o.instrumentAppEvent("App_CreateNewDocument"),o.checkSessionId(e)){var t="blank"!==e.template?{AssetId:e.template,Description:void 0,TemplateBinaryUrl:void 0,Market:e.lcid,NumberOfRatings:0,RecsMod:void 0,Title:void 0,Thumbnails:[],IsBlank:!1,Categories:[]}:void 0,n=o.documentInfo.fileType,i=o.workloadsService.getWorkloadId(n);o.createDocumentService.createItem(n,void 0,t,(function(e){var t={};t.Action=e.type,t.Latency=e.latency.toString(),t.Area=E.b.BackstageMru,t.ElementId=i,t.DocumentType=k.b[o.documentInfo.fileType].toLowerCase(),o.instrumentationService.logGenericEvent("Create_Link_Click_Result",o.getInstrumentationParams(t)),Object(v.a)({featureName:"Create",eventName:"CreateLinkClickResult",area:"BackstageMru",params:{ElementId:i,Action:e.type,Latency:e.latency.toString(),DocumentType:k.b[o.documentInfo.fileType].toLowerCase(),ResourceId:o.correlationId,WacHostEntry:o.documentInfo.wdOrigin,FileFormat:k.a.fileTypeNameFromType(o.documentInfo.fileType)}})}))}},this.getAuthTokenHandler=function(e){o.capabilitiesService.capabilities.isPwaInUwp&&(o.instrumentAppEvent("GetAuthToken"),o.checkSessionId(e)&&o.accessTokenService.getAccessToken("None",!1,e.Resource,!1,void 0,e.ClientId).then((function(t){var n,i;if(t){var r=void 0;t.success||(r=null!==(i=null===(n=t.error)||void 0===n?void 0:n.toString())&&void 0!==i?i:""),o.postMessageUIHost("Host_SetAuthToken",{requestId:e.RequestId,authToken:t.token,identityType:e.IdentityType,tokenExpiration:t.expiryMs,error:r})}})))},this.getWopiInfoFromUrlHandler=function(e){if(o.instrumentAppEvent("WopiInfoFromUrl"),!e.Url){var t={Id:"Url is null",Details:"Url is null".toString()};return o.handleWopiInfoFailure(e.Url,t)}if(o.queuedMessages.length>=100)return t={Id:T.a.Throttled.toString(),Details:"Too many requests".toString()},o.handleWopiInfoFailure(e.Url,t);o.queuedMessages.push(e),o.inProgress||o.processQueue()},this.moveToFolderHandler=function(e){o.instrumentAppEvent("MoveToFolder"),o.checkSessionId(e)&&o.moveToFolderControlService.showControl({onItemMoved:function(t,n,i){o.postMessageUIHost("Host_MoveToFolder",{wdUserSession:e.wdUserSession,isMoveSuccessful:t,updatedDocumentUrl:n,isCrossSiteMove:i})},docUrl:o.documentInfo.docUrl,wopiData:n,supportsCrossSiteMove:e.supportsCrossSiteMove})},this.getCustomAuthConfigHandler=function(e){o.instrumentAppEvent("GetCustomAuthConfig");var t=o.reactShellConfigService.reactShellConfig.acctSwitchingConfig,n=z.a.getHostName(o.officeApplicationUrl),i=z.a.addMissingProtocol(n);t.type="webMsaWithAadProxy",t.aad.wreply=i,t.msa={wreply:i,siteId:t.aad.appId},o.postMessageUIHost("Host_SetCustomAuthConfig",{RequestId:e.RequestId,AuthConfig:JSON.stringify(t)})},this.setContentOverlayHandler=function(e){if(o.instrumentAppEvent("SetOverlayContent"),o.checkSessionId(e)){var t=o.windowService.nativeWindow;t.navigator.virtualKeyboard&&void 0!==t.navigator.virtualKeyboard.overlaysContent&&(t.navigator.virtualKeyboard.overlaysContent=e.overlayContent),o.postMessageUIHost("SetOverlayContent",{})}},this.userActivityHandler=function(){var e;o.capabilitiesService.capabilities.activityBasedTimeoutEnabled&&(null===(e=o.windowService.nativeWindow.AbtInteraction)||void 0===e||e.AbtRegisterActivity())};var r=Object(g.a)(this.windowService.nativeWindow,"message").pipe(Object(I.a)((function(t){return!!t.data&&!!t.origin&&t.origin.endsWith(e.OfficeAppsOrigin)})),Object(A.a)((),Object(I.a)(());t.RegisterEventHandler("DocReboot",this.documentRebootHandler),t.RegisterEventHandler("App_CreateNewDocument",this.createNewHandler),this.documentInfo.fileType===k.b.Excel&&t.RegisterEventHandler("WopiInfoFromUrl",this.getWopiInfoFromUrlHandler),this.documentInfo.fileType===k.b.PowerPoint?this.appPostMessageSubscription=r.subscribe((function(e){switch(e.MessageId){case"UI_Sharing":o.shareHandler(e.Values);break;case"UI_SaveStatus":o.saveStatusHandler(e.Values);break;case"File_Rename":o.renameHandler(e.Values);break;case"UI_CheckUserAccessAndGrantPermissions":o.userAccessHandler(e.Values);break;case"App_RefreshSessionInfo":i(e.Values);break;case"SetOverlayContent":o.setContentOverlayHandler(e.Values);break;case"User_Activity":o.userActivityHandler();break;case"GetAuthToken":o.getAuthTokenHandler(e.Values);break;case"GetCustomAuthConfig":o.getCustomAuthConfigHandler(e.Values);break;case"MoveToFolder":o.moveToFolderHandler(e.Values)}})):(this.documentInfo.fileType!==k.b.Visio&&t.RegisterErrorHandler(this.errorHandler),t.RegisterEventHandler("UI_Sharing",this.shareHandler),t.RegisterEventHandler("File_Rename",this.renameHandler),t.RegisterEventHandler("UI_SaveStatus",this.saveStatusHandler),t.RegisterEventHandler("UI_CheckUserAccessAndGrantPermissions",this.userAccessHandler),t.RegisterEventHandler("SetOverlayContent",this.setContentOverlayHandler),t.RegisterEventHandler("User_Activity",this.userActivityHandler),t.RegisterEventHandler("GetAuthToken",this.getAuthTokenHandler),t.RegisterEventHandler("GetCustomAuthConfig",this.getCustomAuthConfigHandler),t.RegisterEventHandler("MoveToFolder",this.moveToFolderHandler),this.appPostMessageSubscription=r.subscribe((function(e){switch(e.MessageId){case"App_RefreshSessionInfo":i(e.Values)}}))),this.instrumentDocumentLoad()}else this.instrumentBootError({instrumentationEvent:"WacDocument_Generic_Boot_Error",error:"JsApi did not return an app or the wopihostdata did not exist"}),this.showError("Generic")},e.prototype.getErrors=function(e){var t={Id:"",Details:""};if(!e.httpResponse.status||!e.httpResponse.data||!e.httpResponse.data.error)return t.Id=T.a.TokenUnavailable.toString(),t.Details="Failed to fetch access token",t;var n=e.httpResponse.status,o=e.httpResponse.data.error.code,i=e.httpResponse.data.error.message;switch(n){case T.a.OK:t="MissingProperty"===o?{Id:T.a.InternalServerError.toString(),Details:"No data retrieved"}:{Id:T.a.InternalServerError.toString(),Details:i.toString()};break;case T.a.Unknown:t={Id:T.a.ServiceUnavailable.toString(),Details:"Unable to connect to service"};break;case T.a.ServiceUnavailable:t={Id:T.a.ServiceUnavailable.toString(),Details:"Service Unavailable"};break;default:t={Id:n.toString(),Details:i.toString()}}return t},e.prototype.processQueue=function(){var e=this;this.inProgress=!0;var t=this.queuedMessages.shift(),n={docUrl:this.constructFullUrl(t.Url),fileType:this.documentInfo.fileType,wdOrigin:this.contextService.getWdOrigin("OTHER")};this.uiHostBootstrapperService.getWopiData(n).then(().catch(().finally((function(){e.inProgress=!1,e.queuedMessages.length>0&&e.processQueue()}))},e.prototype.constructFullUrl=function(e){e=e.toLowerCase();var t=z.a.getHostName(this.documentInfo.docUrl),n=z.a.addMissingProtocol(t),o=z.a.removeFileNameFromDocUrl(this.documentInfo.docUrl);return 0===e.indexOf("https://")||0===e.indexOf("http://")?e:"/"===e.charAt(0)?""+n+e:o+"/"+e},e.prototype.handleWopiInfoSuccess=function(e,t){this.postMessageUIHost("Host_WopiInfoFromUrl",{WopiSrc:t.wopiHostData.wac.wopiSrc,Url:e,AccessToken:t.wopiHostData.wac.accessToken,AccessTokenExpiry:t.wopiHostData.wac.accessTokenExpiry})},e.prototype.handleWopiInfoFailure=e.prototype.convertToMruFileItem=function(e,t){return{documentUrl:e.docUrl,canonicalUrl:e.docUrl,fileName:t.fileName,sharepointIds:null==t?void 0:t.sharepointIds}},e.prototype.getSessionRefreshResponseFromWopi=function(e,t){var n=t.accessTokenExpiry,o=t[e.charAt(0).toLowerCase()+e.slice(1)];return o?{Name:e,Expiry:n,Value:o.toString()}:{Name:e,Errors:[{Id:"404",Details:"Could not find this token"}]}},e.prototype.postMessageUIHost=function(e,t){var n={MessageId:e,SendTime:(new Date).getTime(),Values:t},o=JSON.stringify(n),i=this.getApplicationIFrame();i&&i.contentWindow.postMessage(o,"*")},e.prototype.getApplicationIFrame=e.prototype.checkSessionId=function(e){var t=this.documentInfo.fileType===k.b.PowerPoint?null:this.officeApplication.sessionId;return!(t&&e.wdUserSession!==t)},e.prototype.showError=function(e){var t,o=this;if(this.visible){if("None"!==e)if("NotFound"!==e&&"Unauthorized"!==e||!this.documentInfo.docUrl||this.contextService.sharedContext.inMockMode){var i=this.documentInfo.fileType===k.b.PowerPoint?null:null===(t=this.officeApplication)||void 0===t?void 0:t.sessionId;console.log("WAC Session Id: "+i+". Host Session Id: "+this.correlationId);var r=this.officeRouteService.getInitialRoute(),s="Generic"===e,a=s&&this.capabilitiesService.capabilities.showFeedback&&"Content"!==(null==r?void 0:r.route)?function(){o.wacContentService.unloadAllDocuments(),o.wacContentService.resetShell(),o.officeRouteService.navigateTo(r).then(()}:void 0;this.errorDismissSubject=new S.a;var c={category:"ContentPage",error:s?"WacDocumentBootFailed":e,fileType:this.documentInfo.fileType,onClose:onActionClicked:a,dismissDialogObservable:this.errorDismissSubject.asObservable().pipe(Object(y.a)(1)),skipOnClose:!0,correlationId:this.correlationId};this.errorDialogService.showErrorDialog(c),this.deferredError="None"}else this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchUrl(o.documentInfo.docUrl,{action:"OpenFile",linkTarget:"_self"})})):this.urlLauncherService.openUrl(this.documentInfo.docUrl,"OpenFile","_self")}else this.deferredError=e},e.prototype.setPageTitle=function(){this.titleService.setTitle(this.officeTitleService.getTitle({app:this.documentInfo.fileType,route:"Content"},this.docTitle))},e.prototype.instrumentDocumentLoad=function(){this.instrumentationService.logGenericEvent("WacDocument_Loaded",this.getInstrumentationParams())},e.prototype.instrumentDocumentPreload=function(){this.instrumentationService.logGenericEvent("WacDocument_Preload",this.getInstrumentationParams())},e.prototype.instrumentAbandon=e.prototype.instrumentAppEvent=function(e){var t,n=((t={}).WacEventName=e,t);this.instrumentationService.logGenericEvent("WacPageAction",this.getInstrumentationParams(n))},e.prototype.instrumentBootError=function(e){var t,n,o,i,r;this.instrumentationService.logErrorEvent(e.instrumentationEvent,this.getInstrumentationParams());var s=((t={}).Error=(null==e?void 0:e.error)?JSON.stringify(e.error):"",t.HttpCode=null!==(r=null===(i=null===(o=null===(n=null==e?void 0:e.error)||void 0===n?void 0:n.httpResponse)||void 0===o?void 0:o.status)||void 0===i?void 0:i.toString())&&void 0!==r?r:"",t);this.instrumentationService.logDebugCacheEvent(e.instrumentationEvent,this.getInstrumentationParams(s))},e.prototype.instrumentError=function(e){var t,n=((t={}).Error=e?new E.d(JSON.stringify(e)):"",t);this.instrumentationService.logErrorEvent("WacContent_Error",this.getInstrumentationParams(n))},e.prototype.instrumentPageView=function(){this.instrumentationService.logGenericEvent("WacContent_PageView",this.getInstrumentationParams(),["WacContent_PageView"]),Object(m.d)({eventName:"WacContent_PageView",isIntentional:!window.prelaunchMode})},e.prototype.getInstrumentationParams=function(e){return void 0===e&&(e={}),Object(J.a)(this.correlationId,this.documentInfo,e)},e.OfficeAppsOrigin="officeapps.live.com",e}()),K=n("y1jW"),Z=o.Fb({encapsulation:2,styles:[],data:{}});function Q(e){return o.jc(0,[o.cc(671088640,1,{wacContainer:0}),(e()(),o.Hb(1,0,null,null,3,"div",[],null,null,null,null,null)),(e()(),o.Hb(2,0,[[1,0],["WacContainer",1]],null,2,"div",[],null,null,null,null,null)),o.Gb(3,278528,null,0,h.i,[o.x,o.y,o.o,o.K],{ngClass:[0,"ngClass"]},null),o.Zb(4,{"wac-content-hidden":0})],(function(e,t){var n=e(t,4,0,!t.component.visible);e(t,3,0,n)}),null)}o.Db("ohp-wac-content-host",X,(function(e){return o.jc(0,[(e()(),o.Hb(0,0,null,null,1,"ohp-wac-content-host",[],null,[["window","beforeunload"]],(function(e,t,n){var i=!0;return"window:beforeunload"===t&&(i=!1!==o.Wb(e,1).checkAndInstrumentAbandon()&&i),i}),Q,Z)),o.Gb(1,4440064,null,0,X,[U.b,B.a,O.a,L.a,D.a,R.a,_.a,E.a,F.a,P.a,V.a,H.b,C.a,W.a,K.h,M.a,i.a,N.b,G.a,j.a],null,null)],(function(e,t){e(t,1,0)}),null)}),{visible:"visible",bootAndLoadInfo:"bootAndLoadInfo"},{},[]);var Y=o.Fb({encapsulation:2,styles:[],data:{}});function $(e){return o.jc(0,[(e()(),o.Hb(0,0,null,null,3,"ohp-wac-content-host",[],null,[["window","beforeunload"]],(,Q,Z)),o.Gb(1,4440064,null,0,X,[U.b,B.a,O.a,L.a,D.a,R.a,_.a,E.a,F.a,P.a,V.a,H.b,C.a,W.a,K.h,M.a,i.a,N.b,G.a,j.a],{visible:[0,"visible"],bootAndLoadInfo:[1,"bootAndLoadInfo"]},null),o.Yb(131072,h.b,[o.h]),o.Yb(131072,h.b,[o.h])],(function(e,t){var n,i;e(t,1,0,null==(n=o.hc(t,1,0,o.Wb(t,2).transform(t.context.$implicit.data)))?null:n.visible,null==(i=o.hc(t,1,1,o.Wb(t,3).transform(t.context.$implicit.data)))?null:i.bootAndLoadInfo)}),null)}function ee(e){return o.jc(0,[(e()(),o.qb(16777216,null,null,2,null,$)),o.Gb(1,278528,null,0,h.j,[o.W,o.S,o.x],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null),o.Yb(131072,h.b,[o.h])],(function(e,t){var n=t.component;e(t,1,0,o.hc(t,1,0,o.Wb(t,2).transform(n.wacDocuments)),n.trackByBootId)}),null)}var te=o.Db("ohp-wac-content-container",r,(function(e){return o.jc(0,[(e()(),o.Hb(0,0,null,null,1,"ohp-wac-content-container",[],null,null,null,ee,Y)),o.Gb(1,114688,null,0,r,[i.a],null,null)],(,null)}),{},{},[]),ne=n("+P5Z"),oe=n("X+PR"),ie=n("CCRL"),re=o.Eb(a,[],(function(e){return o.Tb([o.Ub(512,o.k,o.hb,[[8,[c.a,p,te]],[3,o.k],o.D]),o.Ub(4608,h.m,h.l,[o.z]),o.Ub(1073742336,h.c,h.c,[]),o.Ub(1073742336,ne.a,ne.a,[]),o.Ub(1073742336,oe.o,oe.o,[[2,oe.u],[2,oe.n]]),o.Ub(1073742336,a,a,[]),o.Ub(1024,oe.l,(,[]),o.Ub(256,ie.a,s,[])])}))},zKXa:function(e,t,n){"use strict";n.d(t,"a",();var o=n("2dXW"),i=n("zvoD"),r=n("f0qX"),s=n("BaAg"),a=n("p6Zr"),c=n("kpuN"),l=n("pjz5"),u=n("keVe"),d=function(){eturn e.prototype.getToken=function(e,t,n,o){void 0===o&&(o=null);var i=l.a.getLocation(e),r=i?i.protocol+"//"+i.hostname:"";return null===o&&(o=this.getTokenType(e)),this.accessTokenService.getAccessToken(o,!1,r,t,{category:"Share",fileType:n})},e.prototype.getTokenType=function(e){return s.a.referralFromFileLocation(e)===a.a.OneDrive?"OneDrive":"SharePoint"},e.prototype.showControl=function(e){this.updateNext(e,0)},e.prototype.hideControl=e.prototype.subscribeToOpenEvents=function(e){return this.moveToFolderControl.asObservable().pipe(Object(i.a)((function(e){return e&&0===e.type})),Object(r.a)((function(e){return e.moveToFolderControl}))).subscribe(e)},e.prototype.subscribeToCloseEvents=function(e){return this.moveToFolderControl.asObservable().pipe(Object(i.a)((),Object(r.a)(()).subscribe(e)},e.prototype.updateNext=e.ɵprov=u.kc({factory,token:e,providedIn:"root"}),e}()}}]);
//# sourceMappingURL=wac-cnt.383996290d262f409be7.chunk.v7.js.map