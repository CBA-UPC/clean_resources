"use strict";var ark_Search={Initialize:function(e){ark_jQuery("#searchfield").autocomplete({minLength:3,appendTo:ark_jQuery(".arena-mb-li"),source:function(e,a){var t=new RegExp(ark_jQuery.ui.autocomplete.escapeRegex(e.term),"i");arkArena.getItems(!0).done(function(e){a(ark_jQuery.grep(e,function(e){return e.priority=t.test(e.name)?1:t.test(e.description)?2:t.test(e.mechanic)?3:0,e.priority>0}))})},select:function(e,a){if(ark_Search.TrackAdaptPageView(a.item.key,ark_jQuery("#searchfield").val()),arkPage.arena.inIframe){var t=a.item.url.indexOf("games/")>0?a.item.url.indexOf("games/"):a.item.url.indexOf("QuizDetails"),r="arkpath=/"+a.item.url.substring(t,a.item.url.length),n=removeParam("arkpath",document.referrer),i=n.indexOf("?")>0?"&":"?";parent.postMessage("event=changeUrl&url="+encodeURIComponent(n+i+r),"*")}else document.location.href=a.item.url},create:function(){ark_jQuery(this).data("ui-autocomplete")._renderMenu=function(e,a){var t=this;ark_jQuery(".arena-wrapper").hasClass("arena-platform-narrow")&&ark_jQuery(".ui-autocomplete").addClass("arena-platform-narrow"),a.sort(function(e,a){return e.priority>a.priority?1:e.priority<a.priority?-1:0}),a=ark_Search._distinct(a),ark_jQuery.each(a,},ark_jQuery(this).data("ui-autocomplete")._renderItemData=ark_jQuery(this).data("ui-autocomplete")._renderItem=function(e,a){var t=ark_jQuery("<ark-li>").append(ark_jQuery("<a>").attr("href",a.url).attr("search-item-key",a.key).attr("data-buttonname","SearchResult").append(ark_jQuery("<ark-span>").attr("class","arena-autocmplt-img").append(ark_jQuery("<img>").attr("src",a.getImage("75x75")))).append(ark_jQuery("<ark-span>").attr("class","arena-autocmplt-txt").text(a.name))).appendTo(e);return arkGaEventsHandler&&arkGaEventsHandler.init&&arkGaEventsHandler.init(e.context),t}}})},_distinct:function(e){for(var a=[],t=[],r=0;r<e.length;r++)a.indexOf(e[r].key)<0&&(a.push(e[r].key),t.push(e[r]));return t},TrackAdaptPageView:function(e,a){var t="OriginPage="+arkPage.Params.Page+"&OriginModule=Search";void 0!==arkPage.game&&void 0!==arkPage.game.externalGameId&&arkPage.game.externalGameId.length>0&&(t=t+"&OriginGame="+arkPage.game.externalGameId),"string"==typeof a&&a.length>0&&(t=t+"&SearchTearm="+a);var r=new Date;r.setTime(r.getTime()+6e4),ark_jQuery.cookie("arkadaptparams",t,{expires:r,path:"/"})}};function cutDescription(){ark_jQuery(".nodeHeight").each(function(){for(var e=ark_jQuery(this).height(),a=ark_jQuery(this).find("span").height(),t=ark_jQuery(this).find("span").text(),r=t.length;a>e&&r>0;)r--,ark_jQuery(this).find("span").text(t.slice(0,r)+"..."),a=ark_jQuery(this).find("span").height()})}ark_jQuery(document).ready(function(){ark_Search.Initialize()}),ark_jQuery(document).ready(function(){cutDescription()});var ark_Popup={settings:{autoClose:!1,autoCloseTime:6e5,alignLeft:!1,alignLeftElement:".ark-container",alignTop:!1},Initialize:function(e){arkPage.arena.isIPad&&ark_jQuery("html").addClass("arena-ipad"),arkPage.arena.isIOS&&ark_jQuery("html").addClass("arena-ios")},close:function(e){ark_jQuery("body").removeClass("body-modal-open"),ark.triggerEvent("ARK_PopUp_"+e+":EventClose");var a=ark_jQuery("#ARK_popup_"+e+".ARK_popup");ark_jQuery("html, body").removeClass("ARK_popup_opened"),+a.attr("data-scrolltop")&&ark_jQuery("body").scrollTop(+a.attr("data-scrolltop")),a.removeClass("ARK_popup-active"),a.attr("style",""),ark_jQuery("#gameBlock").removeClass("pop_up_active");var t=parseInt(a.attr("data-close-timer"));isNaN(t)||(clearTimeout(ark_Popup.timer),a.attr("data-close-timer","")),ark_jQuery("#flash_game").removeClass("game_hidden")},open:function(e,a,t){var r=ark_jQuery("#ARK_popup_"+e);if(r.hasClass("ARK_popup-active"))return ark.logging("ark_Popup: "+e+" already open"),!1;if(ark_jQuery("body").addClass("body-modal-open"),t&&ark_jQuery("#ARK_popup_"+e+" ark-span.akrpopup-content-close").hide(),ark_jQuery("body").on("click",function(a){var r=a.target;if(!t){if(!ark_jQuery(r).hasClass("ARK_overlay")&&!ark_jQuery(r).hasClass("arena-popup-close"))return;ark_Popup.close(e),console.log(r,e)}}),r.length<1)return ark.logging("ark_Popup: "+e+" not defined"),!1;if("body"!=r.attr("data-place")&&r.appendTo("body").attr("data-place","body"),a=a||null,ark_Popup._show(e,r,a),r.attr("data-auto-close")||ark_Popup.settings.autoClose){var n=parseInt(r.attr("data-close-timer"));isNaN(n)||clearTimeout(n),n=setTimeout(function(){r.hasClass("ARK_popup-active")&&(r.attr("data-close-timer",""),ark_Popup.close(e))},ark_Popup.settings.autoCloseTime),r.attr("data-close-timer",n),ark.logging("ark_Popup: "+e+" autoClose timer started")}ark.logging("ark_Popup: "+e+" opened")},_show:function(e,a,t){var r,n=!!ark_jQuery('.arena-wrapper[class*="inIframe-"]').length,i=arkPage.arena.isIPad;ark.triggerEvent("ARK_PopUp_"+e+":EventOpen"),n?(a.addClass("ark_popup_iframe"),ark_jQuery(".ARK_overlay").css({display:"none"}),ark_Popup._alignInFrame(a,t)):i?(a.attr("data-scrolltop",ark_jQuery("body").scrollTop()),fixScroll(a)):ark_jQuery("html, body").addClass("ARK_popup_opened"),a.addClass("ARK_popup-active"),ark_jQuery("#gameBlock").addClass("pop_up_active"),r=a[0].getBoundingClientRect(),n&&(r.top<0&&a.css({top:0}),r.bottom>document.body.offsetHeight&&a.css({bottom:0}))},load:showCustomContent:function(e,a){void 0==a?ark_jQuery("#ARK_popup_"+e).toggleClass("ARK_popup-custom"):ark_jQuery("#ARK_popup_"+e).toggleClass("ARK_popup-custom",a)},_alignInFrame:function(e,a){var t,r=a||{},n={left:"auto",right:"auto",top:"auto",bottom:"auto"},i={x:"50%",y:"50%"};if(a){var o=getCoordinates(r.target);o.availLeft<300&&o.availRight<300?(n.left="0",n.right="0",i.x="50%"):o.availLeft>=300?(n.left=o.left+"px",n.right=o.availLeft<600?"0":"auto",n.textAlign="left",i.x="0"):o.availRight>=300&&(n.right=o.right+"px",n.left=o.availRight<600?"0":"auto",n.textAlign="right",i.x="100%"),o.availBottom<=o.availTop?(n.bottom=o.bottom+"px",i.y="100%"):(n.top=o.top+"px",i.y="0")}else n.top="0",n.left="0",n.right="0",i.y="0";e.css(n),e.find(".ARK_popup_content").css({"transform-origin":i.x+" "+i.y,"transition-delay":"0s"}),ark_jQuery(window).on("resize",function(){t=setTimeout(function(){if(!e.hasClass("ARK_popup-active"))return clearTimeout(t),!1;ark_Popup._alignInFrame(e,r)},500),clearTimeout(t)}),ark_jQuery(window).on("orientationchange",function(){if(!e.hasClass("ARK_popup-active"))return clearTimeout(t),!1;ark_Popup._alignInFrame(e,r)})}};function getCoordinates(e){var a=e.getBoundingClientRect();return{width:a.width,height:a.height,top:a.bottom,left:a.left,bottom:document.body.offsetHeight-a.top,right:document.body.offsetWidth-a.right,availBottom:document.body.offsetHeight-a.bottom,availTop:a.top,availLeft:document.body.offsetWidth-a.left,availRight:a.right}}function fixScroll(e){var a=+e.attr("data-scrolltop");ark_jQuery("html, body").addClass("ARK_popup_opened"),e.css({top:a+"px",bottom:-a+"px"}),e[0].scrollIntoView()}var ark_Rating={CurrentRating:0,UserReview:{ReviewObj:{},LoadUserReview:function(e,a){var t={userReview:!0};t.ExtGameId=e,ark_jQuery.ajax({url:"/Services/RatingHelper.ashx?r="+Math.random(),data:t,type:"POST",success:function(t){if(t){if(ark_Rating.UserReview.ReviewObj=JSON.parse(t),null!=ark_Rating.UserReview.ReviewObj.Feedback){var r=ark_Rating.UserReview.ReviewObj.Feedback.split("|||"),n=3==r.length||2==r.length?r[0]:"",i=3==r.length||2==r.length?r[1]:r[0];ark_jQuery("#varTitle").val(n),ark_jQuery(".Ark_UserFeedback").val(i)}else ark_jQuery("#varTitle").val(""),ark_jQuery(".Ark_UserFeedback").val("");ark_Rating.UserRenderStars(e,ark_Rating.UserReview.ReviewObj.Value,"arena-ratingForPopup"),ark_Popup.open("ReviewRating",a)}}})},SaveUserReview:function(e){ark_Rating.UserReview.ReviewObj.Feedback=e,ark_Rating.ReviewGame(ark_Rating.UserReview.ReviewObj.Value,ark_Rating.UserReview.ReviewObj.RatingKey,e)}},RenderStars:function(e,a,t,r){var n=0,i=parseFloat(a);0!==i&&(n=Math.round(parseFloat(i)/5*100)),ark_jQuery(e).find(".ark_rating_full2").css("width",n+"%"),ark_jQuery(e).find(".ark_rating_full2").attr("data-ark_quality_number",a),ark_jQuery(e).find(".ark_rating_full2").attr("data-ark_max_quality",t),ark_jQuery(e).find(".ark_rating_full2").attr("data-ark_coun_rate",r)},ReRenderStars:function(e,a,t,r){var n=0,i=parseFloat(a);0!==i&&(n=Math.round(parseFloat(i)/5*100)),ark_jQuery.each(ark_jQuery(".ark_rating_full2."+e),function(){void 0===ark_jQuery(this).attr("data-ark_user_rate")&&(ark_jQuery(this).parent().parent().find(".ark_rating_full2."+e).css("width",n+"%"),ark_jQuery(this).parent().parent().find(".ark_rating_full2."+e).attr("data-ark_quality_number",a),ark_jQuery(this).parent().parent().find(".ark_rating_full2."+e).attr("data-ark_max_quality",t),ark_jQuery(this).parent().parent().find(".ark_rating_full2."+e).attr("data-ark_coun_rate",r),ark_jQuery(this).parent().parent().find(" .arena-count-rate").html("("+r+")"))})},UserRenderStars:function(e,a,t){var r=0,n=parseFloat(a);0!==n&&(r=Math.round(parseFloat(n)/5*100)),ark_jQuery("."+t+" .ark_rating_full2."+e).css("width",r+"%"),ark_jQuery("."+t+" .ark_rating_full2."+e).attr("data-ark_quality_number",a),ark_jQuery("."+t+" .ark_rating_full2."+e).attr("data-ark_max_quality",5),ark_jQuery("."+t+" .ark_rating_full2."+e).attr("data-ark_coun_rate",1),ark_jQuery("."+t+" .ark_rating_full2."+e).attr("data-ark_user_rate",!0),ark_jQuery("."+t+" .arena-count-rate").hide()},RateGame:function(e,a,t,r){var n={};n.ExtGameId=a,n.RateValue=e,n.ReviewText=t,this.CurrentRating=e,ark_jQuery.ajax({url:"/Services/RatingHelper.ashx?r="+Math.random(),data:n,type:"POST",success:function(t){if(t){var n=JSON.parse(t);0==n.SumRate?ark_Rating.ReRenderStars(a,n.AvgRate,10,0):ark_Rating.UserRenderStars(a,e,r),ark.logging(t),ark.triggerEvent("ark_rating_addedRating")}}})},ReviewGame:function(e,a,t){var r={};r.ExtGameId=a,r.RateValue=e,r.ReviewText=t,ark_jQuery.ajax({url:"/Services/RatingHelper.ashx?r="+Math.random(),data:r,type:"POST",success:)},Initialize:function(e,a,t,r,n,i){ark_jQuery(document).ready(function(){ark_Rating.ReRenderStars(e,r,n,i),ark_jQuery(".ark_user_rate2."+e).hide()})},ReviewInitialization:function(e){ark_jQuery("#ReviewRatePopUp_"+e+" .RateButton_submit_"+e).on("click",function(){if(!((0==ark_Rating.CurrentRating?parseInt(ark_jQuery(".arena-ratingForPopup .ark_rating_full2").data().ark_quality_number):ark_Rating.CurrentRating)<=0)){var a=ark_jQuery("#ReviewRatePopUp_"+e+" input").val(),t=ark_jQuery("#ReviewRatePopUp_"+e+" textarea").val();""!=t&&(""==a&&(a="Review"),ark_Rating.UserReview.SaveUserReview(a+"|||"+t))}}),ark_jQuery("#ReviewRatePopUp_"+e+" .RateButton_cancel_"+e).on("click",function(){ark_Popup.close("ReviewRating")}),ark_jQuery("#popUpReviewStars").appendTo("#popupRatingStars")}};function fbLogin(e){loginLogic(),ark.triggerEvent("login-click")}function fbLoginTopNav(e,a){loginLogic(a),ark.triggerEvent("top-nav-login-click")}function loginLogic(e){var a=e;if(a||(a="arkIsolationIframe"),"fb"!==arkPage.arena.loginSystems)"function"==typeof window.DoCustomRegisterLogin&&window.DoCustomRegisterLogin();else{var t=document.getElementById(a);t&&t.contentWindow.postMessage({action:"arkLogin"},"*")}}ark.addListener("arkFbUpdateUserInfo",function(e){arkPage.user.update(e.id,e.name,e.email,"fb"),arkPage.user.updateUserInfoFromServer(),window.arkWidgetLeaderboard&&window.arkWidgetLeaderboard.refreshLeaderboard({gameId:window.arkPage.game.externalGameId})});var TK={encrypt:function(e,a){var t=TK.charsToLongs(TK.strToChars(e)),r=TK.charsToLongs(TK.strToChars(a)),n=t.length;if(0==n)return"";1==n&&(t[n++]=0);for(var i,o,s=t[n-1],u=t[0],c=Math.floor(6+52/n),d=0;c-- >0;){d+=2654435769,o=(d>>>=0)>>>2&3;for(var l=0;l<n-1;l++)i=(s>>>5^(u=t[l+1])<<2)+(u>>>3^s<<4)^(d^u)+(r[3&l^o]^s),i>>>=0,t[l]+=i,t[l]=t[l]>>>0,s=t[l];i=(s>>>5^(u=t[0])<<2)+(u>>>3^s<<4)^(d^u)+(r[3&l^o]^s),i>>>=0,t[n-1]+=i,t[n-1]=t[n-1]>>>0,s=t[n-1]}return TK.charsToHex(TK.longsToChars(t))},decrypt:function(e,a){var t=TK.charsToLongs(TK.hexToChars(e)),r=TK.charsToLongs(TK.strToChars(a)),n=t.length;if(0==n)return"";for(var i,o,s=t[n-1],u=t[0],c=2654435769*Math.floor(6+52/n);0!=c;){o=c>>>2&3;for(var d=n-1;d>0;d--)i=((s=t[d-1])>>>5^u<<2)+(u>>>3^s<<4)^(c^u)+(r[3&d^o]^s),u=t[d]-=i;i=((s=t[n-1])>>>5^u<<2)+(u>>>3^s<<4)^(c^u)+(r[3&d^o]^s),u=t[0]-=i,c-=2654435769}for(var l=TK.longsToChars(t),p=l.length-1;p>=0&&0==l[p];p--)l.splice(p,1);return TK.charsToStr(l)},charsToLongs:function(e){for(var a=new Array(Math.ceil(e.length/4)),t=0;t<a.length;t++)a[t]=e[4*t]+(e[4*t+1]<<8)+(e[4*t+2]<<16)+(e[4*t+3]<<24);return a},longsToChars:function(e){for(var a=new Array,t=0;t<e.length;t++)a.push(255&e[t],e[t]>>>8&255,e[t]>>>16&255,e[t]>>>24&255);return a},charsToHex:function(e){for(var a=new String(""),t=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"),r=0;r<e.length;r++)a+=t[e[r]>>4]+t[15&e[r]];return a},hexToChars:function(e){for(var a=new Array,t="0x"==e.substr(0,2)?2:0;t<e.length;t+=2)a.push(parseInt(e.substr(t,2),16));return a},charsToStr:function(e){for(var a=new String(""),t=0;t<e.length;t++)a+=String.fromCharCode(e[t]);return a},strToChars:function(e){e=e||"";for(var a=new Array,t=0;t<e.length;t++)a.push(e.charCodeAt(t));return a}},md5=function(e){,d,l,p,m,g,k,f,h=Array();for(h=e=e)),m=1732584193,g=4023233417,k=2562383102,f=271733878,u=0;u<h.length;u+=16)c=m,d=g,l=k,p=f,g=o(g=o(g=o(g=o(g=i(g=i(g=i(g=i(g=n(g=n(g=n(g=n(g=r(g=r(g=r(g=r(g,k=r(k,f=r(f,m=r(m,g,k,f,h[u+0],7,3614090360),g,k,h[u+1],12,3905402710),m,g,h[u+2],17,606105819),f,m,h[u+3],22,3250441966),k=r(k,f=r(f,m=r(m,g,k,f,h[u+4],7,4118548399),g,k,h[u+5],12,1200080426),m,g,h[u+6],17,2821735955),f,m,h[u+7],22,4249261313),k=r(k,f=r(f,m=r(m,g,k,f,h[u+8],7,1770035416),g,k,h[u+9],12,2336552879),m,g,h[u+10],17,4294925233),f,m,h[u+11],22,2304563134),k=r(k,f=r(f,m=r(m,g,k,f,h[u+12],7,1804603682),g,k,h[u+13],12,4254626195),m,g,h[u+14],17,2792965006),f,m,h[u+15],22,1236535329),k=n(k,f=n(f,m=n(m,g,k,f,h[u+1],5,4129170786),g,k,h[u+6],9,3225465664),m,g,h[u+11],14,643717713),f,m,h[u+0],20,3921069994),k=n(k,f=n(f,m=n(m,g,k,f,h[u+5],5,3593408605),g,k,h[u+10],9,38016083),m,g,h[u+15],14,3634488961),f,m,h[u+4],20,3889429448),k=n(k,f=n(f,m=n(m,g,k,f,h[u+9],5,568446438),g,k,h[u+14],9,3275163606),m,g,h[u+3],14,4107603335),f,m,h[u+8],20,1163531501),k=n(k,f=n(f,m=n(m,g,k,f,h[u+13],5,2850285829),g,k,h[u+2],9,4243563512),m,g,h[u+7],14,1735328473),f,m,h[u+12],20,2368359562),k=i(k,f=i(f,m=i(m,g,k,f,h[u+5],4,4294588738),g,k,h[u+8],11,2272392833),m,g,h[u+11],16,1839030562),f,m,h[u+14],23,4259657740),k=i(k,f=i(f,m=i(m,g,k,f,h[u+1],4,2763975236),g,k,h[u+4],11,1272893353),m,g,h[u+7],16,4139469664),f,m,h[u+10],23,3200236656),k=i(k,f=i(f,m=i(m,g,k,f,h[u+13],4,681279174),g,k,h[u+0],11,3936430074),m,g,h[u+3],16,3572445317),f,m,h[u+6],23,76029189),k=i(k,f=i(f,m=i(m,g,k,f,h[u+9],4,3654602809),g,k,h[u+12],11,3873151461),m,g,h[u+15],16,530742520),f,m,h[u+2],23,3299628645),k=o(k,f=o(f,m=o(m,g,k,f,h[u+0],6,4096336452),g,k,h[u+7],10,1126891415),m,g,h[u+14],15,2878612391),f,m,h[u+5],21,4237533241),k=o(k,f=o(f,m=o(m,g,k,f,h[u+12],6,1700485571),g,k,h[u+3],10,2399980690),m,g,h[u+10],15,4293915773),f,m,h[u+1],21,2240044497),k=o(k,f=o(f,m=o(m,g,k,f,h[u+8],6,1873313359),g,k,h[u+15],10,4264355552),m,g,h[u+6],15,2734768916),f,m,h[u+13],21,1309151649),k=o(k,f=o(f,m=o(m,g,k,f,h[u+4],6,4149444226),g,k,h[u+11],10,3174756917),m,g,h[u+2],15,718787259),f,m,h[u+9],21,3951481745),m=t(m,c),g=t(g,d),k=t(k,l),f=t(f,p);return(s(m)+s(g)+s(k)+s(f)).toLowerCase()},arkArenaProtocol={wrapperPlayId:"",callback:"",showGameEnd:!0,arenaPlayId:"0",init:iframeInit:domInit:searchQuery:function(e){for(var a={},t=(e=e.replace("?","")).split("&"),r=0;r<t.length;r++){var n=t[r].split("=");a[decodeURIComponent(n[0])]=decodeURIComponent(n[1]||"")}return a},isInIframe:parseData:function(e){var a=this.searchQuery(e).events;if(a)for(var t=a.split(","),r=0;r<t.length;r++)this.registerEvent(t[r]);this.wrapperPlayId=this.searchQuery(e).wrapper_play_id,this.callback=this.searchQuery(e).callback,this.showGameEnd="false"!=this.searchQuery(e).show_game_end},registerEvent:function(e){"function"==typeof this.eventHandlers[e]?this.eventHandlers[e]():this.eventHandlers.def(e)},eventHandlers:{game_game_end:function(){ark.addListener("game_game_end",function(e){for(var a={},t=0;t<e.data.length;t++)a[e.data[t].key]=e.data[t].value;ark_jQuery.ajax({url:"/arenaapi/GetGameEndScoreHash/",type:"POST",data:{score:a.score,wrapperPlayId:arkArenaProtocol.wrapperPlayId,externalGameId:arkPage.game.externalGameId,arenaPlayId:arkArenaProtocol.arenaPlayId,arenaHash:a.score_hash},success:function(e){arkArenaProtocol.sentDataToClient("event=game_game_end&score="+a.score+"&score_hash="+JSON.parse(e).hash)},error:)})},def:,sentDataToClient:function sentDataToClient(message){try{if(this.isInIframe())try{window.opener?window.opener.postMessage(message,"*"):parent.postMessage(message,"*")}catch(e){}else eval(this.callback+'("'+message+'");')}catch(e){console.log(e)}}};arkArenaProtocol.init();var cookie=window.ark_jQuery.cookie("arkArenaAbTestVariationSelected");function parseGaParams(e){for(var a={},t=e.split("&"),r=0;r<t.length;r++){var n=t[r].split("=");a[n[0]]=n[1]}return a}unction setParentIframeHeight(){var e=ark_jQuery(document).height();parent.postMessage("event=changeHeight&height="+e,"*")}function sleep(e){for(e+=(new Date).getTime();new Date<e;);}function removeParam(e,a){var t=a.split("?")[0],r=[],n=-1!==a.indexOf("?")?a.split("?")[1]:"";if(""!==n){for(var i=(r=n.split("&")).length-1;i>=0;i-=1)r[i].split("=")[0]===e&&r.splice(i,1);t=t+"?"+r.join("&")}return t}unction hasRetinaDisplay(){return!!(isIOS()&&window.devicePixelRatio&&window.devicePixelRatio>1)}ookie&&window.ark_jQuery.cookie("arkArenaAbTestVariationSelected",cookie,{path:"/",expires:365}),window.loginManager={login:function(){masterViewGlobals.loginFunction()}},ark_jQuery(document).ready(,ark_jQuery(document).ready(function(){null==ark_jQuery.cookie("ark_begin_session")&&ark_jQuery.cookie("ark_begin_session",!0,{path:"/"});for(var e=ark_jQuery(".ark-container").find("ark-grid[arkmodulekey]"),a=0,t=0;t<e.length;t++)if("Container"!=ark_jQuery(e[t]).attr("arkmodulekey")){a+=1;for(var r=ark_jQuery(e[t]).find("a[href]"),n=0;n<r.length;n++){var i=ark_jQuery(r[n]);i.attr("parentarkmodulekey",ark_jQuery(e[t]).attr("arkmodulekey")),i.attr("parentarkmodulesorttype",ark_jQuery(e[t]).attr("arkmodulesorttype")),i.attr("parentarkmodulescreenposition",a),i.attr("originmodpos",n+1),i.on("mousedown touch",function(e){var a=ark_jQuery(this),t=a.attr("parentarkmodulekey"),r=a.attr("parentarkmodulesorttype"),n=a.attr("parentarkmodulescreenposition"),i=a.attr("OriginModPos"),o=a.attr("data-buttonname"),s="ModuleScreenPosition="+n+"&OriginPage="+masterViewGlobals.pageName+"&OriginModPos="+i;void 0!==arkPage.game&&void 0!==arkPage.game.externalGameId&&arkPage.game.externalGameId.length>0&&(s=s+"&OriginGame="+arkPage.game.externalGameId),"string"==typeof o&&o.length>0&&(s=s+"&ButtonName="+o),s="string"==typeof r&&r.length>0?s+"&OriginModule="+r:s+"&OriginModule="+t;var u=new Date;u.setTime(u.getTime()+6e4),ark_jQuery.cookie("arkadaptparams",s,{expires:u,path:"/"})})}}ark_jQuery(".change-width-block").parent().addClass("backColorGrid")}),ark_jQuery(document).ready(function(){arkPage.user.isActive?ark_jQuery(".ark-logOut").show():ark_jQuery(".ark-logOut").hide(),ark_jQuery("#bookmarkme").click(function(){var e=navigator.userAgent.toLowerCase(),a=/windows/.test(e),t=(/windows nt 5.1/.test(e)||/windows nt 5.2/.test(e),/os x/.test(e),/chrome/.test(e)&&parseInt(/chrome\/(.+?)\./.exec(e).pop(),10),/chrome/.test(e)&&!/rockmelt/.test(e)),r=(/chrome\/(1[2345678]|2\d)/.test(e),/iphone/.test(e)||/ipod/.test(e),/android/.test(e),/windows phone/.test(e),/ipad/.test(e)),n=/safari/.test(e)&&!/chrome/.test(e),i=/opera/.test(e),o=/firefox/.test(e),s=(/firefox\/2/.test(e),/firefox\/((3.[6789][0-9a-z]*)|(4.[0-9a-z]*))/.test(e),/msie 6.0/.test(e),/msie 7.0/.test(e),/msie 8.0/.test(e),/msie 9.0/.test(e),/msie 10.0/.test(e),/trident\/7.0/.test(e)),u=(/msie/.test(e)&&/opera/.test(e),/(iphone|ipod|ipad|android|mobi|blackberry|opera mini|silk)/.test(e),"Press <"+(a?"Control":"Command")+">+D to bookmark in "),c=location.href,d=document.title;r?alert("Tap the <plus> to bookmark in Safari"):n||t?alert(u+(t?"Chrome":"Safari")):i?alert(u+"Opera"):s?alert(u+"InternetExplorer"):o&&!window.sidebar.addPanel?alert(u+"Firefox"):document.all?window.external.AddFavorite(c,d):window.sidebar.addPanel(d,c,"")}),ark_jQuery(".arena-wrapper img").each(function(){ark_jQuery(this).error(function(){var e=ark_jQuery(this);e.attr("oldsrc",e.attr("src")),e.attr("src").indexOf("150x150")>-1?e.attr("src",arkPage.arena.siteBaseUrl+"/Content/Images/default/150x150_gameicon.jpg"):e.attr("src").indexOf("300x300")>-1?e.attr("src",arkPage.arena.siteBaseUrl+"/Content/Images/default/300x300_gameicon.jpg"):e.attr("src").indexOf("600x600")>-1||e.attr("src").indexOf("640x295")>-1?e.attr("src",arkPage.arena.siteBaseUrl+"/Content/Images/default/600x600_gameicon.jpg"):e.attr("src",arkPage.arena.siteBaseUrl+"/Content/Images/default/75x75_gameicon.jpg"),e.attr("style","border:1px")}).attr("src",ark_jQuery(this).attr("src"))}),arkPage.arena.inIframe&&arkIframeLinksLogicUpdate()}),window.addEventListener?window.addEventListener("load",function(){arkPage.arena.inIframe&&setParentIframeHeight()},!1):window.attachEvent("onload",;var cookieValHasRetinaDisplay=ark_jQuery.cookie("hasRetinaDisplay");if(null==cookieValHasRetinaDisplay&&""==cookieValHasRetinaDisplay){var isHasRetinaDisplay=hasRetinaDisplay();ark_jQuery.cookie("hasRetinaDisplay",isHasRetinaDisplay)}function receiveMSG(e){var a=e.data;if("string"==typeof a){var t=a.toString().split("&")[0].split("=")[1];"getHeight"==t&&setParentIframeHeight(),"game_end"==t&&ark.handleMessageFromGame&&ark.handleMessageFromGame(e.data)}}function fbLogOut(e){var a=document.getElementById("arkIsolationIframe");a&&a.contentWindow.postMessage({action:"arkLogout"},"*"),arkPage.user.isActive=!1,arkPage.user.logout(),HideUserElements()}function HideUserElements(){var e=document.querySelector('a[data-buttonname="SignIn"]');e&&ark_jQuery(e).hide(),document.querySelector('a[data-buttonname="SignInOnGameEnd"]')&&ark_jQuery(e).show()}function ShowUserElements(){var e=document.querySelector('a[data-buttonname="SignIn"]');e&&ark_jQuery(e).show(),document.querySelector('a[data-buttonname="SignInOnGameEnd"]')&&ark_jQuery(e).hide()}window.addEventListener?window.addEventListener("message",receiveMSG,!1):window.attachEvent("onmessage",receiveMSG),ark_jQuery(document).ready(function(){ark_jQuery(".arena-more, .arena-more__title").on("click",function(e){var a=ark_jQuery(this),t=a.attr("parentarkmodulesorttype"),r=a.attr("parentarkmodulekey"),n=(a.attr("originmodpos"),a.attr("data-buttonname"));"string"==typeof t&&t.length,ark.storage().setItem("more",n)}),cutDescription(),setParentIframeHeight(),arkPage.arena.inIframe&&ark.addListener("arkGameStartEvent",,"pc"===arkPage.arena.device&&ark_jQuery("body").addClass("arena-page-body-on-pc")}),ark.addListener(ark.analytic_social_button_click_event,function(e){"fb-like"!=e&&"fb-comment"!=e&&"fb-share"!=e||ark_jQuery(".ark-logOut").show()}),ark.addListener("ark:login",function(e){ark_jQuery(".ark-logOut").show(),ark_jQuery(".arena-post-score").hide(),ShowUserElements()}),ark.addListener("ark:logout",function(e){ark_jQuery(".ark-logOut").hide(),"game end"!=arkGaVirtualPages.part1&&ark_jQuery(".arena-post-score").show(),HideUserElements()}),window.twttr=function(e,a,t){var r=arkPage.arena.inIframe?document.referrer:document.location.href;r+=r.indexOf("?")>0?"&":"?";var n="https://twitter.com/intent/tweet?url="+(r+="refSource=twit-share")+"&lang="+masterViewGlobals.language;ark_jQuery(".twitter-share-button").attr("href",n),ark_jQuery("#shareOnTwitterButton").attr("href",n);var i,o,s=e.getElementsByTagName(a)[0];if(!e.getElementById(t))return(o=e.createElement(a)).id=t,o.src="//platform.twitter.com/widgets.js",s.parentNode.insertBefore(o,s),window.twttr||(i={_e:[],ready:function(e){i._e.push(e)}})}(document,"script","twitter-wjs"),ark_jQuery(document).ready(function(){var e=function(e){for(var a={},t=(e=e.replace("?","")).split("&"),r=0;r<t.length;r++){var n=t[r].split("=");a[decodeURIComponent(n[0])]=n[1]||""}return a}(document.location.search).showpopup,a=decodeURIComponent(e);if(a&&"undefined"!=a){var t=window.location;history&&"pushState"in history&&history.pushState("",document.title,t.pathname+t.search.replace("&showpopup="+e,"").replace("?showpopup="+e,"")),ark_jQuery("#redirectMessage").text(a),ark_Popup.open("RedirectMessage"),setTimeout(2e4)}}),window.parent!==window&&(window.sizePingTimer=setInterval(function(){window.parent.postMessage({arkAction:"size-ping",arkParam:{height:ark_jQuery("main").outerHeight()}},"*")},500),window.parent.postMessage({arkAction:"navigate",arkParam:{path:document.location.pathname}},"*"));var filesForSend=[];function Ark_checkContactForm(){var e={};if(!(ark_jQuery("#varName").val().length>0))return ark_jQuery("#varName").focus(),void overRequest(ark_jQuery("#varName").data("text"),"varName");if(e.user=encodeURI(ark_jQuery("#varName").val()),!validateEmail(ark_jQuery("#varEmail").val()))return ark_jQuery("#varEmail").focus(),void overRequest(ark_jQuery("#varEmail").data("text"),"varEmail");e.userEmail=encodeURI(ark_jQuery("#varEmail").val());var a=document.getElementById("varSubject");if(!(ark_jQuery(a).val().length>0))return ark_jQuery("#varSubject").focus(),void overRequest(ark_jQuery("#otherSubject").data("text"),"otherSubject");if("otherSubject"==a.options[a.selectedIndex].getAttribute("data-extra-field")){var t=document.getElementById("otherSubject");if(!(t.value.length>0))return t.focus(),void overRequest(ark_jQuery("#otherSubject").data("text"),"otherSubject");e.Subject=encodeURI(t.value)}else e.Subject=encodeURI(ark_jQuery(a).val());if(ark_jQuery("#billing-items").length>0&&(e.billingItems=encodeURI(ark_jQuery("#billing-items").val())),!(ark_jQuery("#varMessage").val().length>0))return ark_jQuery("#varMessage").focus(),void overRequest(ark_jQuery("#varMessage").data("text"),"varMessage");if(e.Message=encodeURI(ark_jQuery("#varMessage").val()),e.files=filesForSend,!(ark_jQuery("#recaptcha_response_field").val().length>0))return ark_jQuery("#recaptcha_response_field").focus(),void overRequest(ark_jQuery("#conactus_recapcha").data("text"));e.recaptchaResponse=encodeURI(ark_jQuery("#recaptcha_response_field").val());var r=getClientData();e.recaptchaChallenge=ark_jQuery("#recaptcha_challenge_field").val(),e.flashversion=encodeURI(r.flashVersion),e.userAgent=encodeURI(r.browser+" "+r.browserMajorVersion+" ("+r.browserVersion+")"),e.clientOs=encodeURI(r.os+" ("+r.osVersion+")"),e.siteBaseUrl=encodeURI(arkPage.arena.siteBaseUrl),arkPage.user.isActive?e.userInfo=encodeURI(arkPage.user.id+";"+arkPage.user.name+";"+arkPage.user.email+";"+arkPage.user.session+";"+arkPage.arena.localization):e.userInfo=encodeURI("Guest"),e.location=document.location.href}function getClientData(){var e="";screen.width&&(e+=(screen.width?screen.width:"")+" x "+(screen.height?screen.height:""));var a,t,r,n=navigator.appVersion,i=navigator.userAgent,o=navigator.appName,s=""+parseFloat(navigator.appVersion),u=parseInt(navigator.appVersion,10);-1!=(t=i.indexOf("Opera"))&&(o="Opera",s=i.substring(t+6),-1!=(t=i.indexOf("Version"))&&(s=i.substring(t+8))),-1!=(t=i.indexOf("OPR"))?(o="Opera",s=i.substring(t+4)):-1!=(t=i.indexOf("MSIE"))?(o="Microsoft Internet Explorer",s=i.substring(t+5)):-1!=(t=i.indexOf("Chrome"))?(o="Chrome",s=i.substring(t+7)):-1!=(t=i.indexOf("Safari"))?(o="Safari",s=i.substring(t+7),-1!=(t=i.indexOf("Version"))&&(s=i.substring(t+8))):-1!=(t=i.indexOf("Firefox"))?(o="Firefox",s=i.substring(t+8)):-1!=i.indexOf("Trident/")?(o="Microsoft Internet Explorer",s=i.substring(i.indexOf("rv:")+3)):(a=i.lastIndexOf(" ")+1)<(t=i.lastIndexOf("/"))&&(o=i.substring(a,t),s=i.substring(t+1),o.toLowerCase()==o.toUpperCase()&&(o=navigator.appName)),-1!=(r=s.indexOf(";"))&&(s=s.substring(0,r)),-1!=(r=s.indexOf(" "))&&(s=s.substring(0,r)),-1!=(r=s.indexOf(")"))&&(s=s.substring(0,r)),u=parseInt(""+s,10),isNaN(u)&&(s=""+parseFloat(navigator.appVersion),u=parseInt(navigator.appVersion,10));var c=/Mobile|mini|Fennec|Android|iP(ad|od|hone)/.test(n),d=!!navigator.cookieEnabled;void 0!==navigator.cookieEnabled||d||(document.cookie="testcookie",d=-1!=document.cookie.indexOf("testcookie"));var l="-",p=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];for(var m in p){var g=p[m];if(g.r.test(i)){l=g.s;break}}var k="-";switch(/Windows/.test(l)&&(k=/Windows (.*)/.exec(l)[1],l="Windows"),l){case"Mac OS X":k=/Mac OS X (10[\.\_\d]+)/.exec(i)[1];break;case"Android":k=/Android ([\.\_\d]+)/.exec(i)[1];break;case"iOS":k=(k=/OS (\d+)_(\d+)_?(\d+)?/.exec(n))[1]+"."+k[2]+"."+(0|k[3])}var f="no check";if("undefined"!=typeof swfobject){var h=swfobject.getFlashPlayerVersion();f=h.major>0?h.major+"."+h.minor+" r"+h.release:"-"}return{screen:e,browser:o,browserVersion:s,browserMajorVersion:u,mobile:c,os:l,osVersion:k,cookies:d,flashVersion:f}}function getFlashVersion(){try{try{var e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");try{e.AllowScriptAccess="always"}catch(e){return"6,0,0"}}catch(e){}return new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(e){try{if(navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)return(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(e){}}return"0,0,0"}function FileUpload(){for(var e,a=0;e=filesForSend[a];a++)if(document.getElementById("output-list").innerHTML="",e.type.match("image.*")){var t=new FileReader;t.onload=function(e){return function(a){e.userImgBase64=a.target.result,e.userfilelastModifiedDate=a.target.name,e.userfilename=a.target.name,e.userfiletype=a.target.type,e.userfilesize=a.target.size;var t=document.createElement("span");t.innerHTML=['<img src="',a.target.result,'" title="',encodeURI(e.name),'" style="width:100px;"/>'].join(""),document.getElementById("output-list").insertBefore(t,null)}}(e),t.readAsDataURL(e)}}function handleFileSelect(e){ark_jQuery(".arena-ContactUs .arena-file_upload").removeClass("active"),e.stopPropagation(),e.preventDefault();for(var a,t=e.dataTransfer.files,r=[],n=0,i=0;a=t[i];i++)r.push("<li><strong>",encodeURI(a.name),"</strong> (",a.type||"n/a",") - ",a.size," bytes, last modified: ",a.lastModifiedDate.toLocaleDateString(),"</li>"),n+=a.size,filesForSend.push(a);handleFileSizeLimit(n)?FileUpload():filesForSend.pop()}function handleFileSelectInput(e){for(var a,t=e.target.files,r=[],n=0,i=0;a=t[i];i++)r.push("<li><strong>",encodeURI(a.name),"</strong> (",a.type||"n/a",") - ",a.size," bytes, last modified: ",a.lastModifiedDate.toLocaleDateString(),"</li>"),n+=a.size,filesForSend.push(a);handleFileSizeLimit(n)?FileUpload():filesForSend.pop()}unction handleFileSizeLimit(e){var a=e<20971520;return a||overRequest("Total size of files are out of 20 MB"),a}function checkMultipleProp(){return!!("multiple"in document.createElement("input"))}var dropZone=document.getElementById("drop_zone");function SSOGameEndLogin(){if(-1!=arkPage.arena.loginSystems.indexOf("sso:")){var e=parseInt(ark_jQuery("#score").html().replace(",",""));ark_jQuery.cookie("ssoGELogin",base64.encode("externalGameId="+arkPage.game.externalGameId+"&score="+e),{path:"/"}),window.DoCustomRegisterLogin()}}function SSOSaveGuestAfterLogin(){if(null!=ark_jQuery.cookie("ssoGELogin")){for(var e,a,t=base64.decode(ark_jQuery.cookie("ssoGELogin")).split("&"),r=0;r<t.length;r++){var n=t[r].split("=");"externalGameId"==n[0]&&(a=n[1]),"score"==n[0]&&(e=n[1])}var i={externalGameId:a,score:e};ark_jQuery.post("/manage/saveguestgamescore/",i,function(e){"true"==e?(ark_jQuery(".arena-post-score").hide(),ark_jQuery("#arkLeaderboardTab").hasClass("active")&&(ark_jQuery.cookie("lbTimePeriod","day",{expires:300,path:"/"}),ark_jQuery(".arena-detail-tabs span").removeClass("active"),ark_jQuery("#arkLeaderboardTab").addClass("active"),ark_jQuery.cookie("arkInfoTabLastActive","arkLeaderboardTab",{path:"/"})),updateLeaderboardWithoutCache(),ark_jQuery.cookie("ssoGELogin","",{expires:-1,path:"/"})):ark.logging("Error: Score submit error in saveguestgamescore")})}}function ArkUserBadgesWorker(){var e=!1,a=window.ark_jQuery;function t(){var e=navigator.userAgent;return e.indexOf("MSIE ")>-1||e.indexOf("Trident/")>-1||e.indexOf("Edge/")>-1}function r(e,r){"function"!=typeof r&&(r=;var n="/UserItems/AwardBadge";t()&&(n+="?v="+Math.random()),a.post(n,{Key:e},function(e){r(e)})}function n(){var a="/UserItems/UserBadgesInfo/";t()&&(a+="?v="+Math.random()),ark_jQuery.ajax({async:!1,type:"GET",url:a,success:function(a){a.Result&&function(a){if(e)return;window.userBadges=a.filter(function(e){return e.IsUnlocked});for(var t=function(e){for(var a=[],t=["badge-30-days-visit","badge-7-days-visit","badge-played-5-games","badge-played-25-games"],r=0;r<e.length;r++){var n=e[r];-1===t.indexOf(n.Key)||n.IsUnlocked||a.push(e[r])}return a}(a),r=0;r<t.length;r++){var n=t[r];try{i[n.Key].initWatcher()}catch(e){}}e=!0}(a.Result)}})}var i={"badge-30-days-visit":{initWatcher:function(){var e="arkBadge30DaysVisitCookie",t=a.cookie(e),n={},i=(new Date).getTime();if(t){if(i-(n=JSON.parse(base64.decode(t))).lastDate>864e5&&(n.firstDate=i),n.lastDate=i,a.cookie(e,base64.encode(JSON.stringify(n)),{expires:365,path:"/"}),n.lastDate-n.firstDate>=2592e6)return void r("badge-30-days-visit",function(t){ark.triggerEvent("arkUserBadgeAwarded","badge-30-days-visit"),a.cookie(e,"",{expires:-1,path:"/"})})}else n.lastDate=i,n.firstDate=i;a.cookie(e,base64.encode(JSON.stringify(n)),{expires:365,path:"/"})}},"badge-7-days-visit":{initWatcher:function(){var e="arkBadge7DaysVisitCookie",t=a.cookie(e),n={},i=(new Date).getTime();if(t){if(i-(n=JSON.parse(base64.decode(t))).lastDate>864e5&&(n.firstDate=i),n.lastDate=i,a.cookie(e,base64.encode(JSON.stringify(n)),{expires:365,path:"/"}),n.lastDate-n.firstDate>=6048e5)return void r("badge-7-days-visit",function(t){ark.triggerEvent("arkUserBadgeAwarded","badge-7-days-visit"),a.cookie(e,"",{expires:-1,path:"/"})})}else n.lastDate=i,n.firstDate=i;a.cookie(e,base64.encode(JSON.stringify(n)),{expires:365,path:"/"})}},"badge-played-5-games":{initWatcher:function(){function e(){var e="arkBadge5GamesPlayed",t=a.cookie(e),n=[];t&&(n=JSON.parse(base64.decode(t))),-1===n.indexOf(arkPage.game.externalGameId)&&n.push(arkPage.game.externalGameId),a.cookie(e,base64.encode(JSON.stringify(n)),{expires:365,path:"/"}),n.length>=5&&r("badge-played-5-games",function(){ark.triggerEvent("arkUserBadgeAwarded","badge-played-5-games"),a.cookie(e,"",{expires:-1,path:"/"})})}ark.removeListener("arkContentStartEvent",e),ark.addListener("arkContentStartEvent",e),ark.removeListener("arkContentEndEvent",e),ark.addListener("arkContentEndEvent",e)}},"badge-played-25-games":{initWatcher:function(){function e(){var e="arkBadge25GamesPlayed",t=a.cookie(e),n=[];t&&(n=JSON.parse(base64.decode(t))),-1===n.indexOf(arkPage.game.externalGameId)&&n.push(arkPage.game.externalGameId),a.cookie(e,base64.encode(JSON.stringify(n)),{expires:365,path:"/"}),n.length>=25&&r("badge-played-25-games",function(){ark.triggerEvent("arkUserBadgeAwarded","badge-played-25-games"),a.cookie(e,"",{expires:-1,path:"/"})})}ark.removeListener("arkContentStartEvent",e),ark.addListener("arkContentStartEvent",e),ark.removeListener("arkContentEndEvent",e),ark.addListener("arkContentEndEvent",e)}}};this.userBadgesList=window.masterViewGlobals.supportBadges&&(arkPage.user.isActive?n():ark.addListener("ark:login",)}function ArkUserGameRecommendationService(e){var a="gr-control",t="gr-ml",r="ark_displayAd_split",n="https://arenacloud.cdn.arkadiumhosted.com/arenaxstorage-blob",i=masterViewGlobals.useGameRecommendation;function o(e){ark_Ga.ready?ark_Ga.SetGlobalDimensions(e):ark.addListener("arkGaReady",}function s(e){switch(e){case!0:case"true":case 1:case"1":case"on":case"yes":return!0;default:return!1}}this.Run=function(){try{if(i){o([{slot:1,value:s(function(e){for(var a=window.location.search.substring(1).split("&"),t=0;t<a.length;t++){var r=a[t].split("=");if(r[0]===e)return r[1]}return null}("recommended"))}]);var u=function(){var n=e.cookie(r);if(n===a||n===t)return n;n=Math.random()<.5?a:t;var i=new Date;return i.setMonth(i.getMonth()+6),e.cookie(r,n,{expires:i,path:"/"}),n}();!function(e){o([{slot:10,value:e}])}(u);var c=function(){var a=[];return e("[data-use-recommendation]").each(function(t,r){s(e(r).attr("data-use-recommendation"))&&a.push(e(r))}.bind(this)),a}();c&&c.length&&function(a,r){var i=function(){var a=e.cookie("ai_user");if(a){var t=a.split("|");if(t.length>0)return t[0]}return null}();i&&function(a){var t=e.Deferred(),r=localStorage.getItem("recsys");if(r){var i=null;try{i=JSON.parse(r)}catch(e){}if(i&&i.timeStamp){var o=new Date(i.timeStamp);if(o.setMinutes(o.getMinutes()+15),o>new Date)return t.resolve(i.value),t}}var s=function(e,a){var t=base64.encode(e).replace("/","_"),r=encodeURIComponent(t);return a+"/recsys-results/"+r+".json"}(a,n);return e.get(s).done(function(e){var a={value:e,timeStamp:new Date};localStorage.setItem("recsys",JSON.stringify(a)),t.resolve(e)}),t}(i).done(function(n){!function(a,r,n){n&&n.games&&n.games.length>0&&a&&a.length>0&&a.forEach(function(a){var i=e(a),o=i.find("[data-external-game-id]");if(o&&o.length>0&&r===t){!function(a,t){var r={};a.each(function(a,t){var n=e(t),i=n.attr("data-external-game-id");r[i]=n});for(var n=e(a[0]),i=t.games.length-1;i>=0;i--){var o=t.games[i],s=r[o];s&&(n.before(s),n=s)}}(o,n);var s=i.attr("data-visible-games-count");if(s){var u=i.find("[data-external-game-id]");u.slice(s).hide(),u.slice(0,s).show()}}}.bind(this))}(a,r,n)})}(c,u)}}catch(e){}},this.Run()}function ToolTipHelper(){var e=ark_jQuery,a=this;this.Init=function(a){(a=a||document.querySelector("body"))&&e("body").hasClass("arena-page-body-on-pc")&&e(a).find(".js-show-ark-tooltip").hover(function(){var a=e(this).data("ark-tooltip");if(a){var t='<ark-div class="ark-game-tooltip" style="opacity: 0">'+a+"</ark-div>";e("body").append(t);var r=e(this),n=e(".ark-game-tooltip"),i=n.outerWidth(),o=n.outerHeight(),s=r.outerWidth(),u=r.outerHeight(),c=s/2,d=e(this).offset().left,l=e(this).offset().top,p=l-o-10,m=d+c-i/2,g=m<0,k=m+i>e(window).width(),f=p<e(window).scrollTop();g&&(m=d),k&&(m=d-i+s),f&&(p=l+u),g&&f&&n.addClass("ark-game-tooltip--left-bottom"),k&&f&&n.addClass("ark-game-tooltip--right-bottom"),k||g||!f||n.addClass("ark-game-tooltip--center-bottom"),g&&!f&&n.addClass("ark-game-tooltip--left-top"),k&&!f&&n.addClass("ark-game-tooltip--right-top"),n.css({top:p,left:m,opacity:1})}},function(){e(".ark-game-tooltip").remove()})},e(document).ready(function(){a.Init()})}function ArchivingViewModel(e,a,t,r){var n=this;this.progressCircleRadius=54,this.progressCircleRef=2*Math.PI*n.progressCircleRadius,this.feedsCount=0,this.data=null,this.isReady=!1,this.initDate=null,this.selectedYear=null,this.selectedMonth=null,this.yearDropDownExpanded=!1,this.selectMonth=function(t){var i=n.selectedYear.months.find(function(e){return e.month===t});n.selectedMonth=i||n.selectedYear.months.find(function(e){return parseInt(e.month)===o()}),this.selectedMonth.items=function(t,n){for(var i=new Date(parseInt(t),parseInt(n),0),o=l(),c=new Date,d=c.getFullYear()===parseInt(t)&&c.getMonth()===parseInt(n)-1?c.getDate():i.getDate(),p=o.getFullYear()===parseInt(t)&&o.getMonth()===parseInt(n)-1?o.getDate()-1:0,m=e.prefix,g=e.feedId,k=e.lsPrefix||"TheDailyCrossword",f=!e.hideProgress,h=[],v=p;v<d;v++){var y=(t+u(n)+u(v+1)).toString(),_=k+"_"+g+"_progress_"+m+y.substr(2)+".xml";_=_.replace("/","");var w=new ArchivingFeedItem({clientTitleOnly:e.clientTitleOnly,puzzleDate:new Date(parseInt(t),parseInt(n)-1,v+1),gameName:e.gameName,showProgress:f,progress:parseFloat(s(_)),title:"...",puzzleParam:"?puzzleDate="+y,puzzleUrl:e.feedUrl+"/"+e.prefix+y.substr(2)+".xml",progressKey:_},r,a);h.push(w)}return h=h.reverse()}(n.selectedYear.year,n.selectedMonth.month),a.location.hash="!"+n.selectedYear.year+n.selectedMonth.month},this.selectYear=function(e){var a=n.data.years.find(;a?(n.selectedYear=a,n.selectMonth(n.selectedYear.months.last().month)):g()},this.currentMonthLastAvailableItem=function(){return n.selectedMonth?n.selectedMonth.items.filter(.sortBy("puzzleParam").last():null},this.dispose=this.openYearDropdown=function(){n.yearDropDownExpanded=!0},this.closeYearDropdown=this.dropDownOnClick=this.onProgressChanged=function(t){for(var r={},i=0;i<t.data.length;i++)r[t.data[i].key]=t.data[i].value;!function(e){var t=k();for(var r in e)t[r]=e[r];a.localStorage.setItem("progress_circle",JSON.stringify(t))}(r),e.nonDaily?n.selectedMonth={items:c(n.feedsCount)}:n.selectMonth(n.selectedMonth.month)};var i=[{name:"JAN",num:"01"},{name:"FEB",num:"02"},{name:"MAR",num:"03"},{name:"APR",num:"04"},{name:"MAY",num:"05"},{name:"JUN",num:"06"},{name:"JUL",num:"07"},{name:"AUG",num:"08"},{name:"SEP",num:"09"},{name:"OCT",num:"10"},{name:"NOV",num:"11"},{name:"DEC",num:"12"}];function o(){return(new Date).getMonth()+1}function s(e){return(k()[e]||"0").toString()}function u(e){return(e=parseInt(e))<10?"0"+e.toString():e.toString()}function c(t){for(var n=e.prefix,i=e.feedId,o=e.lsPrefix||"TheDailyCrossword",u=!e.hideProgress,c=[],l=0;l<t;l++){var p=d(l+1,3),m=o+"_"+i+"_progress_"+n+p+".xml",g=new ArchivingFeedItem({clientTitleOnly:e.clientTitleOnly,number:l+1,numbersCount:t,showProgress:u,progress:parseFloat(s(m)),title:"...",puzzleParam:"?puzzleIndex="+(l+1),puzzleUrl:e.feedUrl+n+p+".xml",progressKey:m},r,a);c.push(g)}return c=c.reverse()}nction p(){var e=function(e){e=e.replace("?","").split("#")[0];var a={};try{for(var t=e.split("&"),r=0;r<t.length;r++){var n=t[r].split("=");a[decodeURIComponent(n[0])]=decodeURIComponent(n[1]||"")}}catch(e){}return a}(a.location.search).puzzleDate;if(!e||e.length<8)return null;var t=e.slice(0,4),r=parseInt(t);if(!r||r<1e3||r>9999)return null;var n=e.slice(4,6),i=parseInt(n);if(!i||i<1||i>12)return null;var o=new Date(0);return o.setYear(r),o.setMonth(i-1),o}function m(){return p()||function(){var e=a.location.hash.replace("#","").replace("!","");if(!e||e.length<6)return null;var t=e.slice(0,4),r=parseInt(t);if(!r||r<1e3||r>9999)return null;var n=e.slice(4,6),i=parseInt(n);if(!i||i<1||i>12)return null;var o=new Date(0);return o.setYear(r),o.setMonth(i-1),o}()}function g(){if(n.data&&n.data.years&&n.data.years.length>0){var e=m();if(e&&e<=new Date)n.selectYear(e.getFullYear().toString()),n.selectMonth(i[e.getMonth()].num);else{var a=n.data.years.sortBy("year").last();n.selectYear(a.year)}}}function k(){return JSON.parse(a.localStorage.getItem("progress_circle"))||{}}Array.prototype.last=Array.prototype.sortBy=function(e){return this.slice(0).sort(},Array.prototype.find||(Array.prototype.find=,String.prototype.endsWith||Object.defineProperty(String.prototype,"endsWith",{value:),e.nonDaily||e&&e.firstDate?(n.data={years:[]},e.nonDaily?r.get(e.feedUrl+"info.txt",function(e){try{n.feedsCount=parseInt(e),n.selectedMonth={items:c(n.feedsCount)}}catch(e){}}):function(){n.initDate=l(),(new Date).setHours(0,0,0,0);for(var e=n.initDate.getFullYear(),a=(new Date).getFullYear(),t=function(){var t=l();n.data.years.push({year:e.toString(),months:[{month:"01",title:"JAN"},{month:"02",title:"FEB"},{month:"03",title:"MAR"},{month:"04",title:"APR"},{month:"05",title:"MAY"},{month:"06",title:"JUN"},{month:"07",title:"JUL"},{month:"08",title:"AUG"},{month:"09",title:"SEP"},{month:"10",title:"OCT"},{month:"11",title:"NOV"},{month:"12",title:"DEC"}].filter(function(r){var n=!0;return e===t.getFullYear()&&(n=n&&parseInt(r.month)>=t.getMonth()+1),e===a&&(n=n&&parseInt(r.month)<=o()),n})}),e++};e<=a;)t();g()}(),t.addListener("game_local_save",n.onProgressChanged),n.isReady=!0):console.error("Config is invalid",e)}function ArchivingFeedItem(e,a,t){var r=this;this.exists=!1,this.puzzleDate=e.puzzleDate,this.number=e.number?e.number:null,this.numbersCount=e.numbersCount?e.numbersCount:null,this.gameName=e.gameName,this.clientTitleOnly=e.clientTitleOnly,this.showProgress=e.showProgress,this.progress=e.progress,this.title=e.title,this.puzzleParam=e.puzzleParam,this.puzzleUrl=e.puzzleUrl,this.progressKey=e.progressKey,this.clues=[],this.url=function(){for(var e=t.location.pathname;e.endsWith("/");)e=e.substr(0,e.length-1);return e+"/"+r.puzzleParam},this.updateTitle=function(e){var n=r.number?r.gameName+" No. "+r.number:r.title=r.gameName+" - "+r.puzzleDate.toDateString().substr(4);try{var i=e.querySelector("metadata > title").innerHTML;i?r.number?r.title=r.clientTitleOnly?i:n:r.title=r.clientTitleOnly?i:n+" ("+i+")":r.title=n}catch(e){r.title=n}document.location.search.indexOf(r.puzzleParam)>=0&&a("title").html(r.title),r.exists=!0,t.arkArchiveModule.$forceUpdate()},this.addClues=function(e){var t,n,i=location.search;if(r.number)t=i?parseInt(i.substr(i.indexOf("=")+1)):r.numbersCount,n=r.number;else{var o=new Date;t=i?i.substr(i.indexOf("=")+1):formatArchivingDate(o),n=formatArchivingDate(r.puzzleDate)}t===n&&a(e).find("clues").each(function(){var e={title:a(this).find("title").text(),clues:[]};a(this).find("clue").each(function(){e.clues.push({question:a(this).text(),number:a(this).attr("number"),format:a(this).attr("format")})}),r.clues.push(e)})},a.ajax({type:"GET",url:r.puzzleUrl,success:error:function(){r.exists=!1,t.arkArchiveModule.$forceUpdate()}})}function ArchivingFeedItemNumeric(e,a,t){var r=this;this.exists=!1,this.number=e.number,this.gameName=e.gameName,this.clientTitleOnly=e.clientTitleOnly,this.showProgress=e.showProgress,this.progress=e.progress,this.title=e.title,this.puzzleParam=e.puzzleParam,this.puzzleUrl=e.puzzleUrl,this.progressKey=e.progressKey,this.url=function(){for(var e=t.location.pathname;e.endsWith("/");)e=e.substr(0,e.length-1);return e+"/"+r.puzzleParam},this.updateTitle=function(e){try{var n=e.querySelector("metadata > title").innerHTML;n&&r.clientTitleOnly?r.title=n:r.title=r.gameName+" No. "+r.number}catch(e){r.title=r.gameName+" No. "+r.number}document.location.search.indexOf(r.puzzleParam)>=0&&a("title").html(r.title),r.exists=!0,t.arkArchiveModule.$forceUpdate()},a.ajax({type:"GET",url:r.puzzleUrl,success:r.updateTitle,error:)}function formatArchivingDate(e){return e.getFullYear().toString()+("0"+(e.getMonth()+1)).slice(-2)+("0"+e.getDate()).slice(-2)}ark_jQuery(dropZone).on("dragover",handleDragOver).on("dragenter",function(){ark_jQuery(".arena-ContactUs .arena-file_upload").addClass("active")}).on("dragleave",function(){ark_jQuery(".arena-ContactUs .arena-file_upload").removeClass("active")}).on("drop",handleFileSelect).on("change",handleFileSelectInput),checkMultipleProp()||ark_jQuery(dropZone).parent().addClass("notSupportDragDrop"),ark.addListener("ARK_PopUp_ContactUs:EventOpen",function(){ark_jQuery("#ARK_popup_ContactUs .arena-ContactUs").show(),ark_jQuery("#ARK_popup_ContactUs .ark_subtitle.arena-message-result").text("").hide(),GenerateRecaptcha("conactus_recapcha",null,,ark_jQuery("#varSubject").trigger("change")}),ark_jQuery("#varSubject").on("change",function(){ark_jQuery("#otherSubject + .arena-field-required .arena-field-required-warning").text("");var e=this.options[this.selectedIndex].getAttribute("data-extra-field");ark_jQuery(".optionalField").hide(),ark_jQuery("#otherSubject").removeAttr("required"),void 0!=e&&""!=e&&(ark_jQuery("."+e).show(),"otherSubject"==e&&ark_jQuery("#otherSubject").attr("required","required"))}),ark.addListener("ARK_PopUp_ContactUs:EventClose",function(){ark_jQuery("#ARK_popup_ContactUs form")[0].reset(),ark_jQuery(".optionalField").hide(),ark_jQuery("#output-list").html(""),filesForSend=[],DestroyRecaptcha()}),window.arkExternalApiCommunicator={_userId:null,_sessionStart:null,_gameId:null,_avgGameRevenue:0,_adsEvents:[],_s2sTransactionId:null,_callbackPeriodSeconds:window.userActivityCallbackPeriod||30,_eventPeriodSeconds:window.externalApiEventPeriod||30,_gameStarted:!1,_gameEnded:!1,_callbackTimeoutId:0,_eventIntervalId:0,_gameplayStartDateTime:null,_html5OverlayTimeoutId:0,_gameEndHandled:!1,overallGameplayTime:0,init:function(){this._getUserIp(),this._sessionStart=new Date,this._gameId=arkPage.game.externalGameId,this._userId=this._getUserId(),this._initListeners(),this._loadGameRevenue()},reinit:function(){this._userId=null,this._sessionStart=null,this._avgGameRevenue=0,this._adsEvents=[],this._callbackPeriodSeconds=window.userActivityCallbackPeriod||30,this._eventPeriodSeconds=window.externalApiEventPeriod||30,this._gameStarted=!1,this._gameEnded=!1,this._killCallbacks(),this._gameEndHandled=!1,this.overallGameplayTime=0,this._gameplayStartDateTime=null,this._sessionStart=new Date,this._gameId=arkPage.game.externalGameId,this._userId=this._getUserId(),this._loadGameRevenue()},_getUserIp:function(){ark_jQuery.get("/manage/GetUserIp/").done(},_killCallbacks:function(){this._callbackTimeoutId&&(clearInterval(this._callbackTimeoutId),this._callbackTimeoutId=0),this._eventIntervalId&&(clearInterval(this._eventIntervalId),this._eventIntervalId=0),this._html5OverlayTimeoutId&&(clearTimeout(this._html5OverlayTimeoutId),this._html5OverlayTimeoutId=0)},_initListeners:function(){ark.addListener("game_scores_ready",,ark.addListener("game_event_change",function(e){window.arkExternalApiCommunicator.refreshActivityCallback()}),ark.addListener("game_user_interaction",,ark.addListener("arkContentEndEvent",,ark.addListener("arkGaOnEventSending",function(e){var a=e.data;-1===a.eventCategory.indexOf("Roll_End")&&-1===a.eventCategory.indexOf("OnPageDisp")||-1!==window.arkExternalApiCommunicator._adsEvents.indexOf(a)||window.arkExternalApiCommunicator._adsEvents.push(a)}),ark.addListener("game_event_change",function(){window.arkExternalApiCommunicator.refreshActivityCallback()}),ark.addListener("game_user_interaction",function(){window.arkExternalApiCommunicator.refreshActivityCallback()}),ark.addListener("arkContentStartEvent",function(){window.ark_jQuery("ark-div.game-over-button").show(),window.arkExternalApiCommunicator._gameplayStartDateTime=new Date,window.arkExternalApiCommunicator._gameStarted=!0,window.ark_jQuery(document).on("touch touchstart touchend click mousemove keypress keydown keyup",function(){window.arkExternalApiCommunicator.refreshActivityCallback()}),window.addEventListener?window.addEventListener("message",window.arkExternalApiCommunicator.handleMessageFromGame,!1):window.attachEvent("onmessage",window.arkExternalApiCommunicator.handleMessageFromGame),window.arkExternalApiCommunicator.refreshActivityCallback(),window.arkExternalApiCommunicator._setTimeBasedEvent()}),ark.addListener("rewardTransactionOpenRequest",function(e){window.arkExternalApiCommunicator.s2sTransactionOpen(e)}),ark.addListener("rewardTransactionCloseRequest",},handleMessageFromGame:function(e){try{var a=ark.makeEventObject(e);a.name&&""!==a.name&&window.arkExternalApiCommunicator.refreshActivityCallback()}catch(e){}},_setTimeBasedEvent:function(){this._eventIntervalId=setInterval(function(){var e=window.arkExternalApiCommunicator._processAdsEvents(),a={uid:window.arkExternalApiCommunicator._userId,user_ip:arkPage.arena.userIP,gameId:window.arkExternalApiCommunicator._gameId,sessionDuration:Math.floor(((new Date).getTime()-window.arkExternalApiCommunicator._sessionStart.getTime())/1e3),gameplayDuration:window.arkExternalApiCommunicator.overallGameplayTime+window.arkExternalApiCommunicator._getGameplayDuration(),adsServed:e,avgRevenuePerSession:window.arkExternalApiCommunicator._avgGameRevenue,avgRevenue:window.arkExternalApiCommunicator._avgRev(e)};ark.triggerEvent("arkGameCompletionDataProgress",a)},1e3*this._eventPeriodSeconds)},_disableTimeBasedEvent:_getUserId:function(){for(var e={},a=document.location.search.replace("?","").split("&"),t=0;t<a.length;t++){var r=a[t].split("=");e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]||"")}var n=e.user_id;return n&&window.ark_jQuery.cookie("externalUserId",n,{path:"/"}),window.ark_jQuery.cookie("externalUserId")},_loadGameRevenue:function(){try{for(var e=arkPage.game.adsRevData.grd,a={pc:"desktop",phone:"mobile",tablet:"tablet"}[arkPage.arena.device],t=0;t<e.platform.length;t++){var r=e.platform[t];r.Key===a&&r.Value&&r.Value.revenue&&(window.arkExternalApiCommunicator._avgGameRevenue=r.Value.revenue)}}catch(e){}},_getGameplayDuration:function(){if(window.arkExternalApiCommunicator._gameplayStartDateTime){var e=(new Date).getTime()-window.arkExternalApiCommunicator._gameplayStartDateTime.getTime();return Math.floor(e/1e3)}return 0},refreshActivityCallback:function(){window.arkExternalApiCommunicator._gameStarted&&(this._gameplayStartDateTime||(this._gameplayStartDateTime=new Date),this._callbackTimeoutId&&clearTimeout(this._callbackTimeoutId),this._html5OverlayTimeoutId&&(clearTimeout(this._html5OverlayTimeoutId),this.removeHtml5Overlay()),arkExternalApiCommunicator._isIe()||(this._callbackTimeoutId=setTimeout(function(){window.arkExternalApiCommunicator.stopActivityCallback()},1e3*window.arkExternalApiCommunicator._callbackPeriodSeconds),this._html5OverlayTimeoutId=setTimeout(1e4)),console.log("activity timeout refresh"))},stopActivityCallback:function(){this.overallGameplayTime+=this._getGameplayDuration(),this._gameplayStartDateTime=null,console.log("activity timeout stop"),window.arkExternalApiCommunicator._gameEndHandled||"game start"!==arkGaVirtualPages.part1||"pc"==arkPage.arena.device&&ark_Popup.open("gamePaused")},_isIe:function(){return!!(window.navigator.userAgent.indexOf("MSIE ")>0||navigator.userAgent.match(/Trident.*rv\:11\./))},setHtml5Overlay:function(){window.ark_jQuery("iframe.ark-game-iframe").css("pointer-events","none")},removeHtml5Overlay:_parseSearchQuery:function(e){for(var a={},t=(e=e.replace("?","")).split("&"),r=0;r<t.length;r++){var n=t[r].split("=");a[decodeURIComponent(n[0])]=decodeURIComponent(n[1]||"")}return a},_processAdsEvents:function(){for(var e=[],a=0;a<this._adsEvents.length;a++){var t=this._adsEvents[a];if(-1!==t.eventCategory.indexOf("Roll")){var r=t.eventCategory.split("_")[1];e.push({adType:"video",adSubtype:r})}else e.push({adType:"display",adSubtype:t.eventCategory})}return e},_avgRev:function(e){var a=0;if(e)for(var t=0;t<e.length;t++)try{var r=e[t];arkPage.game.adsRevData&&arkPage.game.adsRevData.ard&&arkPage.game.adsRevData.ard.cpms&&arkPage.game.adsRevData.ard.cpms[r.adType]&&(a+=arkPage.game.adsRevData.ard.cpms[r.adType]/1e3)}catch(e){}return a},getGameplayDataObject:function(){var e=this._processAdsEvents();return{gameplayDuration:this.overallGameplayTime+this._getGameplayDuration(),avgRevenue:this._avgRev(e)}},stopGame:function(e){window.arkExternalApiCommunicator._gameEnded=!0,window.arkExternalApiCommunicator._disableTimeBasedEvent(),this._killCallbacks();var a=this._processAdsEvents(),t={uid:this._userId,user_ip:arkPage.arena.userIP,gameId:this._gameId,score:e.score,scoreHash:e.hash,sessionDuration:Math.floor(((new Date).getTime()-this._sessionStart.getTime())/1e3),gameplayDuration:this.overallGameplayTime+this._getGameplayDuration(),adsServed:a,avgRevenuePerSession:this._avgGameRevenue,avgRevenue:this._avgRev(a)};ark.triggerEvent("arkGameCompletionDataReady",t),window.arkExternalApiCommunicator.reinit()},s2sTransactionOpen:function(e){if(arkPage.user.isActive&&arkPage.arena.rewardApiBaseUrl){var a=arkPage.arena.rewardApiBaseUrl+"/api/transaction/open",t={ExternalUserId:arkPage.user.id,ExternalGameId:arkPage.game.externalGameId,CaptchaToken:e};window.ark_jQuery.ajax({type:"POST",beforeSend:function(e){e.setRequestHeader("X-CDN-Target-Host",document.location.hostname)},url:a,timeout:6e4,contentType:"application/json",async:!0,data:JSON.stringify(t),success:error:function(e,a,t){ark_Ga.Event("Reward_System","Transaction Open",a+" "+t)}})}},s2sTransactionClose:function(e){if(arkPage.arena.rewardApiBaseUrl&&arkPage.arena.rewardApiServerToServerMode&&e){var a=arkPage.arena.rewardApiBaseUrl+"/api/transaction/close",t={TransactionId:window.arkExternalApiCommunicator._s2sTransactionId,PlayHistoryId:base64.decode(e.playId),GameplayDuration:e.gameplayDuration,AvgRevenue:e.avgRevenue,GameScores:e.score,Platform:arkPage.arena.device};window.ark_jQuery.ajax({type:"POST",beforeSend:url:a,contentType:"application/json",async:!1,data:JSON.stringify(t)})}}},window.useAwardBasedMechanics&&window.arkExternalApiCommunicator.init(),ark_jQuery(document).ready(,ark_jQuery(document).ready(,window.arkToolTipHelper=new ToolTipHelper,"undefined"!=typeof module&&(module.exports={ArchivingViewModel:ArchivingViewModel,ArchivingFeedItem:ArchivingFeedItem,ArchivingFeedItemNumeric:ArchivingFeedItemNumeric});var prerollObjTestFunctionFabric={functions:[],addProvider:function(e){e&&"function"==typeof e&&this.functions.push(e)},shouldSkip:function(){if(!this.functions.length)return!1;for(var e=!1,a=0;a<this.functions.length;a++){var t=this.functions[a]();if(!0===(e=e||"boolean"==typeof t&&t))return e}return e}};prerollObjTestFunctionFabric.addProvider(function(){var e,a;if(!1===(arkPage&&arkPage.arena&&!0===arkPage.arena.disablePrerollForNewUsers))return!1;return void 0===arkUsertypeValue?"new"===(e="arkUserFirstVisit",(a=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)")))?decodeURIComponent(a[1]):void 0):"string"==typeof arkUsertypeValue&&"new"===arkUsertypeValue});var abData={cookieNameABpiGroup:"arkABpiGroup",cookieNameABpiData:"arkABpiData",cookieNameABpiRawData:"arkABpiRawData",cookieNameABDisplayAd_split:"ark_displayAd_split",cookieNameABpiSkipResult:"arkABpiSkipResult",productServiceUrl:masterViewGlobals.marketProductListUrl,userProductServiceUrl:masterViewGlobals.marketUserProductListUrl,marketProcessingUrl:masterViewGlobals.marketProcessingUrl,marketType:"ads-free",putTogether:getCookie:setCookie:,userFacade={isUserInControlGroup:function(){var e=abData.getCookie(abData.cookieNameABpiGroup);return"control"==JSON.parse(e).sku},userPrice:function(){try{var e=abData.getCookie(abData.cookieNameABpiGroup);return"$"+JSON.parse(e).priceAmount}catch(e){return""}},isUserShowTriggerPoints:function(){if(0!==Object.keys(arkPage.arena.subscriptionSystemSettings).length&&!arkPage.arena.subscriptionSystemSettings.isClosingPeriod&&!userFacade.isUserInControlGroup()){var e=0,a=abData.getCookie(abData.cookieNameABpiData);if(a)e=JSON.parse(a).days;return 0==e}return!1},showUserPopupAfterNDays:function(e){var a="storageId"+e,t=abData.getCookie(abData.cookieNameABpiData);if(t){var r=localStorage.getItem(a),n=JSON.parse(t);n.days!=e||0!=n.status||r||(localStorage.setItem(a,!0),showArenaWithoutADsPopupSafe(e))}return Promise.resolve("userFacade.showUserPopupAfterNDays")},isUserAllowToBuy:function(){if(!arkPage.arena.subscriptionSystemSettings.isClosingPeriod){var e=0,a=abData.getCookie(abData.cookieNameABpiData);if(a)e=JSON.parse(a).days;return-1!=e&&60!=e||(showArenaWithoutADsPopupSafe(e),!1)}return!1},isUserPaymentValid:function(){var e=abData.getCookie(abData.cookieNameABpiData);if(!e)return!1;var a=JSON.parse(e);if(0==a.status)return!1;var t=(new Date).getTime(),r=new Date(a.startDate).getTime(),n=new Date(a.endDate).getTime();return t>r&&n>t}},LayoutFacade={layoutSetup:function(){return LayoutFacade.messageBannerSetup(),LayoutFacade.buttonOnGameEndAdd(),LayoutFacade.textOnAdBlockerPopupAdd(),Promise.resolve("LayoutFacade.layoutSetup")},messageBannerImpression:!1,buttonOnGameEndImpression:!1,textOnAdBlockerPopupImpression:!1,messageBannerSetup:function(){if(userFacade.isUserShowTriggerPoints()){var e=userFacade.userPrice();if(ark_jQuery("#price").text(e),ark_jQuery("#price2").text(e),ark_jQuery("#price3").text(e),ark_jQuery("#custom-banner-text").show(),!LayoutFacade.messageBannerImpression&&!userFacade.isUserInControlGroup()){try{ark_Ga.Event("Subscription_Initial","Impression","Banner")}catch(e){}LayoutFacade.messageBannerImpression=!0}}else ark_jQuery("#custom-banner-text").hide()},isIE:function(){var e=window.navigator.userAgent,a=/MSIE|Trident/.test(e);return a},buttonOnGameEndAdd:function(){if(userFacade.isUserShowTriggerPoints()){var e="iframe[ark-test-id='ark-arena-without-ads-button']",a=".game-end-question-button";ark_jQuery(e).length>0&&ark_jQuery(e).remove(),ark_jQuery(a).length>0&&ark_jQuery(a).remove();var t=document.querySelector(".ark-game-end-buttons"),r="",n="",i=20,o="top: 70%; left: 158%;",s="",u="",c=window.masterViewGlobals.deviceType,d=arkPage.user.isActive;t&&(t.classList.add("ab-test"),d?(t.classList.remove("user-not-active"),t.classList.add("user-active"),u="ark-div[ark-test-id='ark-all-games-button']"):(t.classList.remove("user-active"),t.classList.add("user-not-active"),u=e)),r=d&&"pc"===c?"Buy 1 Month of Ad-Free Games and VIP Access":"Buy 1 Month of Ad-Free <br/> Games and VIP Access",d&&"pc"===c?(s="ark-play-again-button",n="height: 70px; width: 100%;",o="top: 65%; left: 158%;"):d&&"pc"!==c?(o="top: 78%; left: 104%;",s="ark-all-games-button",n="height: 70px;",i=17):d||"pc"===c?d||(s="ark-gameend-leaderboard-button",n="height: 70px; width: 250px;"):(s="ark-gameend-leaderboard-button",n="height: 70px;",i=17,o="top: 83%; left: 104%;");var l="<iframe class='ark-game-end-button' style='"+n+"' id='arkGameEndBuyNowIframe' ark-test-id='ark-arena-without-ads-button' src='"+window.masterViewGlobals.arenaFbFrameBaseUrl+"/Content/FB/ArkFBLogin_AB_Test_GameEnd.html?fbid="+arkPage.arena.fbAppID+"&buttonText="+r+"&buttonFontSize="+i+"'></iframe>";ark_jQuery("ark-div[ark-test-id='".concat(s,"']")).after(l);if(ark_jQuery(u).after("<div class='game-end-question-button'><i id='game-end-question-icon' class='far fa-question-circle fa-3x'></i></div>"),!d&&LayoutFacade.isIE()){var p=ark_jQuery("ark-div[ark-test-id='ark-gameend-leaderboard-button']")[0];p&&(p.style.right="16px")}ark_jQuery(a).attr("style",o).click(function(){ark.triggerEvent("arkPaymentPopup"),ark_Ga.Event("Subscription_Initial","Click","Game_End"),localStorage.setItem(Subscription_InitialStorage,"Game_End")})}else ark_jQuery(e).hide(),ark_jQuery(a).hide()},textOnAdBlockerPopupAdd:function(){if(userFacade.isUserShowTriggerPoints()&&0===ark_jQuery("#arkAdBlockBuyNowIframe").length){var e=document.querySelector("#ARK_popup_disableAdblock");if(!e)return;e.classList.add("ab-test"),"boolean"!=typeof window.Adv_ab&&ark.addListener("arkGaReady",function(){LayoutFacade.textOnAdBlockerPopupImpression||userFacade.isUserInControlGroup()||(ark_Ga.Event("Subscription_Initial","Impression","Ad_Blocker"),LayoutFacade.textOnAdBlockerPopupImpression=!0)});var a=document.querySelector("ark-adb-div[class='ark-ad-block-message-body']"),t="<div class='disableAdblock_text2'>1. For only <b>"+userFacade.userPrice()+"</b>, you can start playing <b>ad-free</b> - and also gain access to exclusive <b>VIP games</b> - for one month.</div>",r="<div class='mobile-text'>For ad blocker disabling instructions, <a href='"+document.querySelector("#ARK_popup_disableAdblock .ark-ad-block-message-link a").getAttribute("href")+"'>click here.</a></div>",n="<iframe id='arkAdBlockBuyNowIframe'src='"+window.masterViewGlobals.arenaFbFrameBaseUrl+"/Content/FB/ArkFBLogin_AB_Test_AdBlock.html?fbid="+arkPage.arena.fbAppID+"'></iframe>";a&&(a.innerHTML="<div class='disableAdblock_text1'>Ads help keep our games free to play, and we make sure that every ad you see on this site is safe and secure.In order to keep playing, please choose a method below:</div><hr class='adblock-divider-line' /><div class='mobile-text'>In order to keep playing, please disable your ad <br/> blocker or Try <b>Ad-Free Games.</b></div>"+t+n+"<div class='disableAdblock_text2 buynow-description'><ark-p>By clicking “BUY NOW” you will be redirected to a payment page.</ark-p><ark-p class='banner-stripe-service-links'><a href='https://stripe.com/en-US/ssa' target='_blank'>Service Agreement</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href='https://stripe.com/en-US/privacy' target='_blank'>Privacy Policy</a></ark-p></div><hr class='adblock-divider-line' /><div class='disableAdblock_text2'>2. Please enable ads to appear on this site.</div><div class='mobile-text mobile-buynow-description' id='mobile-buynow-description-block' style='display: none;'><ark-p>By clicking “BUY NOW” you will be redirected <br/> to a payment page.</ark-p><ark-p class='banner-stripe-service-links'><a href='https://stripe.com/en-US/ssa' target='_blank'>Service Agreement</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href='https://stripe.com/en-US/privacy' target='_blank'>Privacy Policy</a></ark-p></div>"+r+"<div class='mobile-text adblock-question-button'><i id='adblock-question-icon' class='far fa-question-circle fa-3x'></i></div>"),ark_jQuery(".adblock-question-button"e(500)})}},payButtonTextInit:function(){arkPage.user.isActive?ark_jQuery("#proceedToPayButton").text("Remove ads for 30 days'"):ark_jQuery("#proceedToPayButton").text("Login and Remove ads for 30 days'")},applyStyle:function(){var e,a,t=(a=navigator.userAgent.toLowerCase(),(e=a).indexOf("msie ")>-1||e.indexOf("trident/")>-1||e.indexOf("edge/")>-1?"pc":/(ipad|tablet|(android(?!.*mobile))|(windows(?!.*phone)(.*touch))|kindle|playbook|silk|(puffin(?!.*(IP|AP|WP))))/.test(a)?"tablet":/(mobi|ipod|phone|blackberry|opera mini|fennec|minimo|symbian|psp|nintendo ds|archos|skyfire|puffin|blazer|bolt|gobrowser|iris|maemo|semc|teashark|uzard)/.test(a)?"phone":"pc"),r=document.createElement("style");r.innerHTML="ark-ad-right, ark-top-ad, ark-bottom-ad { display:none!important; }","phone"!==t&&(r.innerHTML+="ark-article.arena-main-col { margin:auto!important; max-width:640px!important;overflow:unset!important; }"),"pc"!==t&&(r.innerHTML+=".ark-top-ad { display:none!important; }"),document.querySelector("head").appendChild(r),ark_jQuery("#ark-top-ad-container").css("height",0)},subscribeForFBIframeEvents:function(){window.addEventListener("message",function(e){e.data&&"ark-remove-ads-for-30-days-event-from-game-end"===e.data.action&&(ark_Ga.Event("Subscription_Initial","Purchase Request","Game_End"),localStorage.setItem(window.Subscription_InitialStorage,"Game_End"),window.proceedToPay("arkGameEndBuyNowIframe"))}),window.addEventListener("message",function(e){e.data&&"ark-remove-ads-for-30-days-event-from-adblock"===e.data.action&&(ark_Ga.Event("Subscription_Initial","Purchase Request","Ad_Blocker"),localStorage.setItem(window.Subscription_InitialStorage,"Ad_Blocker"),window.proceedToPay("arkAdBlockBuyNowIframe"))})}},userProductFacade={userProductProcessing:function(e){for(var a=(new Date).getTime(),t=!1,r=0;r<e.length;r++)if(e[r].type==abData.marketType){var n=new Date(e[r].startDate).getTime(),i=new Date(e[r].endDate).getTime();if(a>n&&i>a){t=!0;var o=new Object;return o.sku=e[r].sku,o.stripeSku=e[r].stripeSku,o.startDate=e[r].startDate,o.endDate=e[r].endDate,o.status=1,o.days=-1,abData.setCookie(abData.cookieNameABpiData,JSON.stringify(o),{expires:31536e3,path:"/"}),abData.setCookie(abData.cookieNameABpiSkipResult,"forceSkip",{expires:31536e3,path:"/"}),(o=new Object).sku=e[r].sku,o.stripeSku=e[r].stripeSku,o.priceAmount=variationFacade.getPriceByVariation(e[r].sku),abData.setCookie(abData.cookieNameABpiGroup,JSON.stringify(o),{expires:31536e3,path:"/"}),"undefined"!=typeof storageTopNavLogin&&"true"==localStorage.getItem(storageTopNavLogin)&&(document.location.href=document.location.href),Promise.resolve("userProductFacade.userProductProcessing")}}return t?Promise.resolve("userProductFacade.userProductProcessing"):(userProductFacade.userProductCreateEmpty(e.length),Promise.resolve("userProductFacade.userProductProcessing"))},userProductCreateEmpty:function(e){var a=new Object;switch(a.sku=null,a.stripeSku=null,a.startDate=null,a.endDate=null,a.status=0,e){case 0:a.days=0;break;case 1:a.days=30;break;case 2:default:a.days=60}abData.setCookie(abData.cookieNameABpiData,JSON.stringify(a),{expires:31536e3,path:"/"}),abData.setCookie(abData.cookieNameABpiSkipResult,"notSkip",{expires:31536e3,path:"/"})},userProductInit:function(){return new Promise(function(e,a){var t=ftuxMessage.ParseSearchQuery(window.location.search).pistatus,r=abData.getCookie(abData.cookieNameABpiData);if(arkPage.user.isActive&&(t&&"1"===t||!r&&!userFacade.isUserInControlGroup()))return t&&"1"===t&&abData.setCookie(abData.putTogether(abData.cookieNameABpiRawData,arkPage.user.id),"",{expires:-1,path:"/"}),void userProductFacade.userProductFromMarketInit().then(userProductFacade.userProductProcessing).then(function(){e("userProductFacade.userProductInit")});if(!r){return userProductFacade.userProductCreateEmpty(0),void e("userProductFacade.userProductInit")}e("userProductFacade.userProductInit")})},userProductFromMarketInit:function(){return new Promise(function(e,a){arkPage.user.id&&""!==arkPage.user.id||(console.log("Problem in getting user product from Market with empty arkPage.user.id"),a(null));var t=abData.getCookie(abData.putTogether(abData.cookieNameABpiRawData,arkPage.user.id));if(t){var r=JSON.parse(t);if(r)return void e(r)}ark_jQuery.ajax({async:!1,type:"GET",data:{arenaId:arkPage.arena.id,userId:arkPage.user.id,type:abData.marketType},url:abData.userProductServiceUrl,success:function(a){abData.setCookie(abData.putTogether(abData.cookieNameABpiRawData,arkPage.user.id),JSON.stringify(a),{expires:86400,path:"/"}),e(a)){a(e)}})})}},variationFacade={variationData:null,variationInit:function(){return new Promise(function(e,a){return abData.getCookie(abData.cookieNameABpiGroup)?void e("variationFacade.variationInit"):void variationFacade.variationFromMarketInit().then(variationFacade.variationProcessing).then(function(){e("variationFacade.variationInit")})})},variationFromMarketInit:function(){return new Promise(function(e,a){ark_jQuery.ajax({async:!1,type:"GET",url:abData.productServiceUrl,a,e(a)),a(e)}})})},getPriceByVariation:function(e){if(null!=variationFacade.variationData)for(var a=0;a<variationFacade.variationData.length;a++)if(variationFacade.variationData[a].sku==e)return variationFacade.variationData[a].price.amount;return""},variationProcessing:function(e){var a=Math.random();if(2==e.length&&e[0].type==abData.marketType&&"ads-free-sku-1"==e[0].sku&&e[1].type==abData.marketType&&"ads-free-sku-2"==e[1].sku){var t=new Object;a<1/3?(t.sku=e[0].sku,t.stripeSku=e[0].stripeSku,t.priceAmount=e[0].price.amount):a>=1/3&&a<1/3*2?(t.sku=e[1].sku,t.stripeSku=e[1].stripeSku,t.priceAmount=e[1].price.amount):a>=1/3*2&&a<=1&&(t.sku="control",t.stripeSku=null,t.priceAmount=null),abData.setCookie(abData.cookieNameABpiGroup,JSON.stringify(t),{expires:31536e3,path:"/"})}return Promise.resolve("variationFacade.variationProcessing")}},arkAdsPromise,arkUpdatedUserFromServerDone=!1,arenaWithoutAdsFacade={init:function(){return arkAdsPromise||(arkAdsPromise=new Promise(function(e,a){ark.addListener("arkUpdatedUserFromServer",function(){arkUpdatedUserFromServerDone||arkPage&&arkPage.arena&&arkPage.arena.subscriptionSystemSettings&&!0===arkPage.arena.subscriptionSystemSettings.isActive&&arkPage.arena.subscriptionSystemSettings.controlGroup&&"number"==typeof arkPage.arena.subscriptionSystemSettings.controlGroup&&variationFacade.variationInit().then(userProductFacade.userProductInit).then(LayoutFacade.layoutSetup).then(userFacade.showUserPopupAfterNDays(30)).then(userFacade.showUserPopupAfterNDays(60init")}),arkUpdatedUserFromServerDone=!0})})),arkAdsPromise}};arkPage&&arkPage.arena&&arkPage.arena.subscriptionSystemSettings&&!0===arkPage.arena.subscriptionSystemSettings.isActive&&arkPage.arena.subscriptionSystemSettings.controlGroup&&"number"==typeof arkPage.arena.subscriptionSystemSettings.controlGroup&&(variationFacade.variationFromMarketInit(),arenaWithoutAdsFacade.init()),ark.addListener("game_game_end",function(){LayoutFacade.buttonOnGameEndAdd(),LayoutFacade.buttonOnGameEndImpression||userFacade.isUserInControlGroup()||!userFacade.isUserShowTriggerPoints()||(ark_Ga.Event("Subscription_Initial","Impression","Game_End"),ark_Ga.Event("Subscription_Initial","Impression","Banner"),LayoutFacade.buttonOnGameEndImpression=!0)}),ark.addListener("arkAdBlockDetectiopAdd()}),ark.addListener("arkPaymentPopup",function(){if(!arkPage.arena.subscriptionSystemSettings.isClosingPeriod){var e=0,a=abData.getCookie(abData.cookieNameABpiData);if(a)e=JSON.parse(a).days;showArenaWithoutADsPopupSafe(e)}});var adsObjTestFunctionFabric={functions:[],addPush(e)},shouldSkip:function(){if(!this.functions.length)return!1;for(var e=!0,a=0;a<this.functions.length;a++){var t=this.functions[a]();if(!1===(e=e&&"boolean"==typeof t&&t))return e}return e}},skipResult;adsObjTestFunctionFabric.addProvider(function(){if(!(arkPage&&arkPage.arena&&arkPage.arena.subscriptionSystemSettings&&arkPage.arena.subscriptionSystemSettings.controlGroup&&"number"==typeof arkPage.arena.subscriptionSystemSettings.controlGroup))return!1;var e=abData.getCookie(abData.cookieNameABpiSkipResult);if(!e)return!1;var a=ftuxMessage.ParseSearchQuery(window.location.search).pistatus;return!(e&&"notSkip"==e&&!a)&&(ark.triggerEvent("applyStyleNoAds"),LayoutFacade.applyStyle(),!0)}),LayoutFacade.subscribeForFBIframeEvents();