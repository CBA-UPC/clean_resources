(function(){const EMITTER_HOST="https://pixel.barion.com";const IFRAME_DOCUMENT_NAME="barion.html";const IFRAME_BASE_DOCUMENT_NAME="barionbase.html";const IFRAME_MARKETING_DOCUMENT_NAME="barionmarketing.html";const CLIENT_ID_CONTAINER="ba_client_id";const IMPRESSION_ID_CONTAINER="ba_impression_id";const SESSION_COOKIE_PREFIX="ba_sid";const VISITOR_COOKIE_PREFIX="ba_vid";const CONSENT_COOKIE_PREFIX='BarionMarketingConsent';var need_iframe=true;var barion_pixel_id="";const SECONDS_IN_YEAR=31536000;const SECONDS_IN_MINUTE=60;const FINGERPRINT_SALT=5433454359586;const SESSION_TIMEOUT=30*SECONDS_IN_MINUTE;const VISITOR_TIMEOUT=1.5*SECONDS_IN_YEAR;let message_counter=0;if(!Array.prototype.indexOf){Array.prototype.indexOf=function(item){let i=this.length;while(i--){if(this[i]===item)return i;}
return-1;}}/*!litejs.com/MIT-LICENSE.txt*/
const cookie=!function(){"use strict";ar h="object"==typeof window?window:{},s=!h.JS_SHA1_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;s&&(h=global);var i=!h.JS_SHA1_NO_COMMON_JS&&"object"==typeof module&&module.exports,e="function"==typeof define&&define.amd,r="0123456789abcdef".split(""),o=[-2147483648,8388608,32768,128],n=[24,16,8,0],a=["hex","array","digest","arrayBuffer"],f=[],u=c=p=t.prototype.update=t.prototype.finalize=t.prototype.hash=t.prototype.hex=t.prototype.toString=t.prototype.hex,t.prototype.digest=t.prototype.array=t.prototype.digest,t.prototype.arrayBuffer=var y=c();i?module.exports=y:(h.sha1=y,e&&define()}();(function(y,z){nction x(a){a=l(a^a>>>16,2246822507);a^=a>>>13;a=l(a,3266489909);return a^=a>>>16}{version:"2.1.2",x86:{},x64:{}};t.x86.hash32=function(a,c){a=a||"";for(var b=a.length%4,p=a.length-b,d=c||0,e=0,f=0;f<p;f+=4)e=a.charCodeAt(f)&255|(a.charCodeAt(f+1)&255)<<8|(a.charCodeAt(f+2)&255)<<16|(a.charCodeAt(f+3)&255)<<24,e=l(e,3432918353),e=r(e,15),e=l(e,461845907),d^=e,d=r(d,13),d=l(d,5)+3864292196;e=0;switch(b){case 3:e^=(a.charCodeAt(f+2)&255)<<16;case 2:e^=(a.charCodeAt(f+1)&255)<<8;case 1:e^=a.charCodeAt(f)&255,e=l(e,3432918353),e=r(e,15),e=l(e,461845907),d^=e}d^=a.length;d=x(d);return d>>>0};t.x86.hash128=function(a,c){a=a||"";c=c||0;for(var b=a.length%16,p=a.length-b,d=c,e=c,f=c,h=c,m=0,n=0,g=0,q=0,k=0;k<p;k+=16)m=a.charCodeAt(k)&255|(a.charCodeAt(k+1)&255)<<8|(a.charCodeAt(k+2)&255)<<16|(a.charCodeAt(k+3)&255)<<24,n=a.charCodeAt(k+4)&255|(a.charCodeAt(k+5)&255)<<8|(a.charCodeAt(k+6)&255)<<16|(a.charCodeAt(k+7)&255)<<24,g=a.charCodeAt(k+8)&255|(a.charCodeAt(k+9)&255)<<8|(a.charCodeAt(k+10)&255)<<16|(a.charCodeAt(k+11)&255)<<24,q=a.charCodeAt(k+12)&255|(a.charCodeAt(k+13)&255)<<8|(a.charCodeAt(k+14)&255)<<16|(a.charCodeAt(k+15)&255)<<24,m=l(m,597399067),m=r(m,15),m=l(m,2869860233),d^=m,d=r(d,19),d+=e,d=l(d,5)+1444728091,n=l(n,2869860233),n=r(n,16),n=l(n,951274213),e^=n,e=r(e,17),e+=f,e=l(e,5)+197830471,g=l(g,951274213),g=r(g,17),g=l(g,2716044179),f^=g,f=r(f,15),f+=h,f=l(f,5)+2530024501,q=l(q,2716044179),q=r(q,18),q=l(q,597399067),h^=q,h=r(h,13),h+=d,h=l(h,5)+850148119;q=g=n=m=0;switch(b){case 15:q^=a.charCodeAt(k+14)<<16;case 14:q^=a.charCodeAt(k+13)<<8;case 13:q^=a.charCodeAt(k+12),q=l(q,2716044179),q=r(q,18),q=l(q,597399067),h^=q;case 12:g^=a.charCodeAt(k+11)<<24;case 11:g^=a.charCodeAt(k+10)<<16;case 10:g^=a.charCodeAt(k+9)<<8;case 9:g^=a.charCodeAt(k+8),g=l(g,951274213),g=r(g,17),g=l(g,2716044179),f^=g;case 8:n^=a.charCodeAt(k+7)<<24;case 7:n^=a.charCodeAt(k+6)<<16;case 6:n^=a.charCodeAt(k+5)<<8;case 5:n^=a.charCodeAt(k+4),n=l(n,2869860233),n=r(n,16),n=l(n,951274213),e^=n;case 4:m^=a.charCodeAt(k+3)<<24;case 3:m^=a.charCodeAt(k+2)<<16;case 2:m^=a.charCodeAt(k+1)<<8;case 1:m^=a.charCodeAt(k),m=l(m,597399067),m=r(m,15),m=l(m,2869860233),d^=m}d^=a.length;e^=a.length;f^=a.length;h^=a.length;d=d+e+f;d+=h;e+=d;f+=d;h+=d;d=x(d);e=x(e);f=x(f);h=x(h);d+=e;d+=f;d+=h;e+=d;f+=d;h+=d;return("00000000"+(d>>>0).toString(16)).slice(-8)+("00000000"+(e>>>0).toString(16)).slice(-8)+("00000000"+(f>>>0).toString(16)).slice(-8)+("00000000"+(h>>>0).toString(16)).slice(-8)};t.x64.hash128=function(a,c){a=a||"";c=c||0;for(var b=a.length%16,l=a.length-b,d=[0,c],e=[0,c],f=[0,0],h=[0,0],m=[2277735313,289559509],n=[1291169091,658871167],g=0;g<l;g+=16)f=[a.charCodeAt(g+4)&255|(a.charCodeAt(g+5)&255)<<8|(a.charCodeAt(g+6)&255)<<16|(a.charCodeAt(g+7)&255)<<24,a.charCodeAt(g)&255|(a.charCodeAt(g+1)&255)<<8|(a.charCodeAt(g+2)&255)<<16|(a.charCodeAt(g+3)&255)<<24],h=[a.charCodeAt(g+12)&255|(a.charCodeAt(g+13)&255)<<8|(a.charCodeAt(g+14)&255)<<16|(a.charCodeAt(g+15)&255)<<24,a.charCodeAt(g+8)&255|(a.charCodeAt(g+9)&255)<<8|(a.charCodeAt(g+10)&255)<<16|(a.charCodeAt(g+11)&255)<<24],f=u(f,m),f=w(f,31),f=u(f,n),d=p(d,f),d=w(d,27),d=v(d,e),d=v(u(d,[0,5]),[0,1390208809]),h=u(h,n),h=w(h,33),h=u(h,m),e=p(e,h),e=w(e,31),e=v(e,d),e=v(u(e,[0,5]),[0,944331445]);f=[0,0];h=[0,0];switch(b){case 15:h=p(h,s([0,a.charCodeAt(g+14)],48));case 14:h=p(h,s([0,a.charCodeAt(g+13)],40));case 13:h=p(h,s([0,a.charCodeAt(g+12)],32));case 12:h=p(h,s([0,a.charCodeAt(g+11)],24));case 11:h=p(h,s([0,a.charCodeAt(g+10)],16));case 10:h=p(h,s([0,a.charCodeAt(g+9)],8));case 9:h=p(h,[0,a.charCodeAt(g+8)]),h=u(h,n),h=w(h,33),h=u(h,m),e=p(e,h);case 8:f=p(f,s([0,a.charCodeAt(g+7)],56));case 7:f=p(f,s([0,a.charCodeAt(g+6)],48));case 6:f=p(f,s([0,a.charCodeAt(g+5)],40));case 5:f=p(f,s([0,a.charCodeAt(g+4)],32));case 4:f=p(f,s([0,a.charCodeAt(g+3)],24));case 3:f=p(f,s([0,a.charCodeAt(g+2)],16));case 2:f=p(f,s([0,a.charCodeAt(g+1)],8));case 1:f=p(f,[0,a.charCodeAt(g)]),f=u(f,m),f=w(f,31),f=u(f,n),d=p(d,f)}d=p(d,[0,a.length]);e=p(e,[0,a.length]);d=v(d,e);e=v(e,d);d=A(d);e=A(e);d=v(d,e);e=v(e,d);return("00000000"+(d[0]>>>0).toString(16)).slice(-8)+("00000000"+(d[1]>>>0).toString(16)).slice(-8)+("00000000"+(e[0]>>>0).toString(16)).slice(-8)+("00000000"+(e[1]>>>0).toString(16)).slice(-8)};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=t),exports.murmurHash3=t):(t._murmurHash3=y.murmurHash3,t.noConflict=function(){y.murmurHash3=t._murmurHash3;t._murmurHash3=z;t.noConflict=z;return t},y.murmurHash3=t)})(this);const uuid=function(){let uuid="",i,random;for(i=0;i<32;i++){random=Math.random()*16|0;if(i===8||i===12||i===16||i===20){uuid+="-"}
uuid+=(i===12?4:(i===16?(random&3|8):random)).toString(16);}
return uuid;};const now=const extend_or_create_cookie=function(name,timeout){if(cookie(name)===""){cookie(name,uuid(),timeout,"/","."+document.domain);}else{cookie(name,cookie(name),timeout,"/","."+document.domain);}};const create_iframe=function(){const ifrm=document.createElement("iframe");ifrm.setAttribute("src",EMITTER_HOST+"/"+IFRAME_DOCUMENT_NAME+"?s="+location.protocol+"//"+location.hostname);let scripts=document.getElementsByTagName("script");let script;if(window["barion_pixel_id"]!==undefined){barion_pixel_id=window["barion_pixel_id"];}else{for(let i=0;i<scripts.length;i++){script=scripts[i].innerText.replace(/\n/g,"").replace(/ /g,"").replace(/\t/g,"");if(script.length<=1000&&script.match(/.*BP-.{10}-.*/))
barion_pixel_id=script.substr(script.indexOf("BP-"),16,16);}}
barion_pixel_id=barion_pixel_id.trim();ifrm.name=barion_pixel_id;ifrm.width="0";ifrm.height="0";ifrm.border="0";ifrm.style.cssText="border: 0px!important; padding: 0px!important; margin: 0px!important; display: none!important;";document.body.appendChild(ifrm);};const create_base_iframe=function(){const ifrm=document.createElement("iframe");ifrm.setAttribute("src",EMITTER_HOST+"/"+IFRAME_BASE_DOCUMENT_NAME+"?s="+location.protocol+"//"+location.hostname);ifrm.name=barion_pixel_id;ifrm.width="0";ifrm.height="0";ifrm.border="0";ifrm.id="barion_receiver";ifrm.style.cssText="border: 0px!important; padding: 0px!important; margin: 0px!important; display: none!important;";document.body.appendChild(ifrm);};const create_marketing_iframe=function(){const ifrm=document.createElement("iframe");ifrm.setAttribute("src",EMITTER_HOST+"/"+IFRAME_MARKETING_DOCUMENT_NAME+"?s="+location.protocol+"//"+location.hostname);ifrm.name=barion_pixel_id;ifrm.width="0";ifrm.height="0";ifrm.border="0";ifrm.id="barion_receiver";ifrm.style.cssText="border: 0px!important; padding: 0px!important; margin: 0px!important; display: none!important;";document.body.appendChild(ifrm);};const get_session_cookie_name=function(){if(document.domain==="pixel.barion.com"){return SESSION_COOKIE_PREFIX;}else{return SESSION_COOKIE_PREFIX+'.'+murmurHash3.x86.hash32(document.domain);}};const get_visitor_cookie_name=function(){return VISITOR_COOKIE_PREFIX+'.'+murmurHash3.x86.hash32(document.domain);};const get_consent_cookie_name=function(){return CONSENT_COOKIE_PREFIX+'.'+murmurHash3.x86.hash32(document.domain);};const each=const getCanvasFp=function(){let result=[];let canvas=document.createElement('canvas');canvas.width=2000;canvas.height=200;canvas.style.display='inline';let ctx=canvas.getContext('2d');ctx.rect(0,0,10,10);ctx.rect(2,2,6,6);result.push('canvas winding:'+((ctx.isPointInPath(5,5,'evenodd')===false)?'yes':'no'));ctx.textBaseline='alphabetic';ctx.fillStyle='#f60';ctx.fillRect(125,1,62,20);ctx.fillStyle='#069';ctx.font='11pt Arial';ctx.fillText('Cwm fjordbank glyphs vext quiz, \ud83d\ude03',2,15);ctx.fillStyle='rgba(102, 204, 0, 0.2)';ctx.font='18pt Arial';ctx.fillText('Cwm fjordbank glyphs vext quiz, \ud83d\ude03',4,45);ctx.globalCompositeOperation='multiply';ctx.fillStyle='rgb(255,0,255)';ctx.beginPath();ctx.arc(50,50,50,0,Math.PI*2,true);ctx.closePath();ctx.fill();ctx.fillStyle='rgb(0,255,255)';ctx.beginPath();ctx.arc(100,50,50,0,Math.PI*2,true);ctx.closePath();ctx.fill();ctx.fillStyle='rgb(255,255,0)';ctx.beginPath();ctx.arc(75,100,50,0,Math.PI*2,true);ctx.closePath();ctx.fill();ctx.fillStyle='rgb(255,0,255)';ctx.arc(75,75,75,0,Math.PI*2,true);ctx.arc(75,75,25,0,Math.PI*2,true);ctx.fill('evenodd');if(canvas.toDataURL){result.push('canvas fp:'+canvas.toDataURL());}
return result;};const getWebglCanvas=const getWebglFp=function(){let gl;const fa2s=const maxAnisotropy=gl=getWebglCanvas();if(!gl){return null;}
let result=[];const vShaderTemplate='attribute vec2 attrVertex;varying vec2 varyinTexCoordinate;uniform vec2 uniformOffset;void main(){varyinTexCoordinate=attrVertex+uniformOffset;gl_Position=vec4(attrVertex,0,1);}';const fShaderTemplate='precision mediump float;varying vec2 varyinTexCoordinate;void main() {gl_FragColor=vec4(varyinTexCoordinate,0,1);}';let vertexPosBuffer=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,vertexPosBuffer);let vertices=new Float32Array([-0.2,-0.9,0,0.4,-0.26,0,0,0.732134444,0]);gl.bufferData(gl.ARRAY_BUFFER,vertices,gl.STATIC_DRAW);vertexPosBuffer.itemSize=3;vertexPosBuffer.numItems=3;let program=gl.createProgram();let vshader=gl.createShader(gl.VERTEX_SHADER);gl.shaderSource(vshader,vShaderTemplate);gl.compileShader(vshader);let fshader=gl.createShader(gl.FRAGMENT_SHADER);gl.shaderSource(fshader,fShaderTemplate);gl.compileShader(fshader);gl.attachShader(program,vshader);gl.attachShader(program,fshader);gl.linkProgram(program);gl.useProgram(program);program.vertexPosAttrib=gl.getAttribLocation(program,'attrVertex');program.offsetUniform=gl.getUniformLocation(program,'uniformOffset');gl.enableVertexAttribArray(program.vertexPosAttrib);gl.vertexAttribPointer(program.vertexPosAttrib,vertexPosBuffer.itemSize,gl.FLOAT,!1,0,0);gl.uniform2f(program.offsetUniform,1,1);gl.drawArrays(gl.TRIANGLE_STRIP,0,vertexPosBuffer.numItems);try{result.push(gl.canvas.toDataURL());}catch(e){}
result.push('extensions:'+(gl.getSupportedExtensions()||[]).join(';'));result.push('webgl aliased line width range:'+fa2s(gl.getParameter(gl.ALIASED_LINE_WIDTH_RANGE)));result.push('webgl aliased point size range:'+fa2s(gl.getParameter(gl.ALIASED_POINT_SIZE_RANGE)));result.push('webgl alpha bits:'+gl.getParameter(gl.ALPHA_BITS));result.push('webgl antialiasing:'+(gl.getContextAttributes().antialias?'yes':'no'));result.push('webgl blue bits:'+gl.getParameter(gl.BLUE_BITS));result.push('webgl depth bits:'+gl.getParameter(gl.DEPTH_BITS));result.push('webgl green bits:'+gl.getParameter(gl.GREEN_BITS));result.push('webgl max anisotropy:'+maxAnisotropy(gl));result.push('webgl max combined texture image units:'+gl.getParameter(gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS));result.push('webgl max cube map texture size:'+gl.getParameter(gl.MAX_CUBE_MAP_TEXTURE_SIZE));result.push('webgl max fragment uniform vectors:'+gl.getParameter(gl.MAX_FRAGMENT_UNIFORM_VECTORS));result.push('webgl max render buffer size:'+gl.getParameter(gl.MAX_RENDERBUFFER_SIZE));result.push('webgl max texture image units:'+gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS));result.push('webgl max texture size:'+gl.getParameter(gl.MAX_TEXTURE_SIZE));result.push('webgl max varying vectors:'+gl.getParameter(gl.MAX_VARYING_VECTORS));result.push('webgl max vertex attribs:'+gl.getParameter(gl.MAX_VERTEX_ATTRIBS));result.push('webgl max vertex texture image units:'+gl.getParameter(gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS));result.push('webgl max vertex uniform vectors:'+gl.getParameter(gl.MAX_VERTEX_UNIFORM_VECTORS));result.push('webgl max viewport dims:'+fa2s(gl.getParameter(gl.MAX_VIEWPORT_DIMS)));result.push('webgl red bits:'+gl.getParameter(gl.RED_BITS));result.push('webgl renderer:'+gl.getParameter(gl.RENDERER));result.push('webgl shading language version:'+gl.getParameter(gl.SHADING_LANGUAGE_VERSION));result.push('webgl stencil bits:'+gl.getParameter(gl.STENCIL_BITS));result.push('webgl vendor:'+gl.getParameter(gl.VENDOR));result.push('webgl version:'+gl.getParameter(gl.VERSION));try{let extensionDebugRendererInfo=gl.getExtension('WEBGL_debug_renderer_info');if(extensionDebugRendererInfo){result.push('webgl unmasked vendor:'+gl.getParameter(extensionDebugRendererInfo.UNMASKED_VENDOR_WEBGL));result.push('webgl unmasked renderer:'+gl.getParameter(extensionDebugRendererInfo.UNMASKED_RENDERER_WEBGL));}}catch(e){}
if(!gl.getShaderPrecisionFormat){return result;}
each(['FLOAT','INT'],;return result;};const has_feature=const fingerprint=function(){let simpleFp=[navigator.userAgent,navigator.platform,navigator.language,(new Date()).getTimezoneOffset()/60,screen.height,screen.width,screen.colorDepth,has_feature('localStorage'),has_feature('sessionStorage'),has_feature('indexedDB')];let cfp=getCanvasFp();let wgfp=getWebglFp();return murmurHash3.x64.hash128(simpleFp.concat(cfp).concat(wgfp).join(),FINGERPRINT_SALT);};const getPartnerIds=const send_message=function(msg){let consentVal=cookie(get_consent_cookie_name());msg[CLIENT_ID_CONTAINER]=window[CLIENT_ID_CONTAINER]||"";msg['ga']=cookie('_ga');msg['gid']=cookie('_gid');msg["vid"]=cookie(get_visitor_cookie_name());msg["sid"]=cookie(get_session_cookie_name());msg["iid"]=window[IMPRESSION_ID_CONTAINER]||"";msg["ord"]=message_counter++;msg["tsClient"]=now();msg["ba_partner_ids"]=getPartnerIds();if(consentVal==="1"){msg["marketingConsent"]=1;}else{msg["marketingConsent"]=0;}
if(document.getElementById("barion_receiver")!==null){document.getElementById("barion_receiver").contentWindow.postMessage(msg,EMITTER_HOST);}else{console.log("iframe is undefined now.");}};const send_error=function(code,description){let msg={"event_method":"track","event_name":"error","code":code,"description":description};send_message(msg);console.log(code,description);};const send_barion_error=function(code,params){switch(code){case 10:send_error(10,'Barion Pixel: Mandatory key '+params[0]+' is missing from '+params[1]+'.');break;case 11:send_error(11,'Barion Pixel: Type of '+params[0]+' is not '+params[1]+' in '+params[2]+'.');break;case 12:send_error(12,'Barion Pixel: Format of '+params[0]+' format is invalid in '+params[1]+'.');break;case 13:send_error(13,'Barion Pixel: Invalid key '+params[0]+' in '+params[1]+'.');break;case 14:send_error(14,"Wrong number of parameters for "+params[0]+" event. Number of event's parameters should be "+params[1]+'.');break;case 15:send_error(15,"Unrecognized event name "+params[0]);break;case 16:send_error(12,"String is too long. Max length is 1024 character.");break;case 17:send_error(12,"Barion Pixel: Invalid contentType property in contentView event is "+params[0]+". Allowed values: ['Page','Product','Article','Promotion','Banner','Misc']");break;case 18:send_error(12,"Barion Pixel: Invalid contentType property in "+params[0]+" event is "+params[1]+". Allowed values: ['Page','Product','Article','Promotion','Banner','Misc']");break;case 19:send_error(12,"Barion Pixel: Invalid list property in "+params[0]+" event is "+params[1]+". Allowed values: ['HomePage', 'SearchPage', 'ProductPage', 'Recommendation', 'ComparisonPage', 'BasketPage', 'Checkout', 'Misc']");break;default:break;}};const extend_object=function(obj_to_extend,other_object,prefixAtr){let prefix=prefixAtr||'';for(let name in other_object){if(other_object.hasOwnProperty(name)){if(prefix!==''){obj_to_extend[prefix+'_'+name]=other_object[name];}else{obj_to_extend[name]=other_object[name];}}}};const eventify=function(array,callback){array.push=function(e){Array.prototype.push.call(array,e);callback(array);};};const is_string=function(v){return typeof v==="string";};const is_numeric=const to_str=function(v){v=""+v;if(v.length>1024){send_barion_error(16);return v.substr(0,1024);}
return ""+v;};const to_int=function(v){try{return Math.floor(parseInt(v));}catch(e){return v;}};const to_float=const to_contents=function(contents){let new_contents=[];for(let c_idx in contents){let current_content=contents[c_idx];const contents_mandatory_keys=['id','contentType','name','unit','unitPrice','totalItemPrice','currency','quantity'];const contents_type_conversion={'id':to_str,'contentType':to_str,'name':to_str,'brand':to_str,'category':to_str,'unit':to_str,'unitPrice':to_float,'totalItemPrice':to_float,'currency':to_currency_code,'quantity':to_float,'ean':to_str,'variant':to_str,'description':to_str,'imageUrl':to_str};validate(current_content,'contents',contents_mandatory_keys,contents_type_conversion);new_contents.push(current_content);}
return new_contents;};const to_currency_code=function(v){if(v!==undefined)
return v.toUpperCase();};const to_country_code=function(v){if(v!==undefined)
return v.toUpperCase();};const to_region=function(v){if(v!==undefined)
return v.toUpperCase();};const to_county=function(v){if(v!==undefined)
return v.toUpperCase();};const to_language=function(v){if(v!==undefined)
return v.toLowerCase();};const to_address=function(v){const address_mandatory_keys=[];const address_type_conversion={'deliveryMethod':to_str,'country':to_country_code,'city':to_str,'region':to_region,'zipCode':to_str,'street':to_str,'street2':to_str,'fullName':to_str,'phone':hash};if(validate(v,'address',address_mandatory_keys,address_type_conversion)){return v;}};const convert=function(obj,key,cnv_func){if(key in obj){obj[key]=cnv_func(obj[key]);}};const has_key=const in_list=const hash=const type_check=function(d,k,type_conversion,event_name){let type_error=false;let type_name;if(typeof d[k]==='undefined'){return;}
if(type_conversion===to_str){if(!is_string(d[k])&&k!=='gender'){type_error=true;type_name='string'}}else if(type_conversion===to_contents){if(d[k].length>50){d[k]=d[k].slice(0,50);type_error=true;}}else if(type_conversion===to_int){if(!is_numeric(d[k])&&d[k]%1!==0){type_error=true;type_name='integer'}}else if(type_conversion===to_float){if(!is_numeric(d[k])){type_error=true;type_name='float'}}else if(type_conversion===to_country_code){if(!is_string(d[k])){type_error=true;type_name='string'}}else if(type_conversion===to_currency_code){if(!is_string(d[k])){type_error=true;type_name='string'}}else if(type_conversion===to_region){if(!is_string(d[k])){type_error=true;type_name='string'}}else if(type_conversion===to_county){if(!is_string(d[k])){type_error=true;type_name='string'}}else if(type_conversion===to_language){if(!is_string(d[k])){type_error=true;type_name='string'}}else if(type_conversion===hash){if(k==="email"){if(!is_string(d[k])){type_error=true;type_name='string'}}else if(k==="phone"){if(!is_string(d[k])){type_error=true;type_name='string'}}else if(k==="userId"){if(!is_string(d[k])){type_error=true;type_name='string'}}}
if(k==="contentType"&&!in_list(d[k],['Page','Product','Article','Promotion','Banner','Misc'])){send_barion_error(18,[event_name,d[k]])}
if(k==="list"&&!in_list(d[k],['HomePage','SearchPage','ProductPage','Recommendation','ComparisonPage','BasketPage','Checkout','Misc'])){send_barion_error(19,[event_name,d[k]])}
if(type_error){if(event_name==='contents'){send_barion_error(11,[k,type_name,'contents property']);}else if(event_name==='address'){send_barion_error(11,[k,type_name,'address property']);}else{send_barion_error(11,[k,type_name,event_name+' event']);}}};const format_check=function(d,event_name,key){let format_error=false;if(!in_list(key,['country','county','currency','email','lang','currency','list','region'])||typeof d[key]==='undefined'){return;}else if(key==='country'||key==='lang'){if(d[key].length!==2){format_error=true;}}else if(key==='county'||key==='region'){if(d[key].length!==5){format_error=true;}}else if(key==='currency'){if(d[key].length!==3){format_error=true;}}
if(format_error){if(event_name==='contents'){send_barion_error(12,[key,'contents property']);}else if(event_name==='address'){send_barion_error(12,[key,'address property']);}else{send_barion_error(12,[key,event_name+' event']);}}};const validate=function(d,event_name,mandatory_keys,type_conversion){for(let k=0;k<mandatory_keys.length;k++){if(has_key(d,mandatory_keys[k])){}else{send_barion_error(10,[mandatory_keys[k],event_name+' event']);return false;}}
for(let k in d){if(!has_key(type_conversion,k)){if(k[0]==='_'){k=k.substr(1,k.length);if(!has_key(d,'custom')){d['custom']={};}
d['custom'][k]=d['_'+k];}
else{send_barion_error(13,[k,event_name+' event']);}
delete d[k];}
if(event_name==='contentView'){if(k==='contentType'){let content_type=d[k];if(!in_list(content_type,['Page','Product','Article','Promotion','Banner','Misc'])){send_barion_error(17,[content_type]);return false;}
if(content_type==='Product'){const content_view_product_mandatory_attrs=['unitPrice','unit','currency','quantity'];content_view_product_mandatory_attrs.forEach(function(element){if(!has_key(d,element)){send_barion_error(10,[element,event_name+' event']);return false;}})}}}}
for(let k in type_conversion){type_check(d,k,type_conversion[k],event_name);convert(d,k,type_conversion[k]);format_check(d,event_name,k);}
return true;};const handle_message_from_queue=function(msg){let type_conversion;let mandatory_keys;let msg_to_post;let method=msg[0];let event_name=msg[1];switch(event_name){case "addBarionPixelId":if(msg.length!==3){send_barion_error(14,[event_name,msg.length]);}else{window[CLIENT_ID_CONTAINER]=msg[2].replace(/ /g,'')||'';if(document.referrer.indexOf("search")!==-1){msg_to_post={event_method:method,event_name:event_name,init_ref:document.referrer,init_domain:document.domain,init_url:document.URL,init_base_uri:window.location.pathname,init_ua:navigator.userAgent,init_plat:navigator.platform,init_lang:navigator.language,init_tzo:Math.floor((new Date()).getTimezoneOffset()/60),init_sh:Math.floor(screen.height),init_sw:Math.floor(screen.width),init_avw:Math.floor(screen.availWidth),init_avh:Math.floor(screen.availHeight),init_bh:Math.floor(document.getElementsByTagName('body')[0].clientHeight),init_bw:Math.floor(document.getElementsByTagName('body')[0].clientWidth),init_cd:Math.floor(screen.colorDepth),searchString:document.referrer.substring(document.referrer.indexOf("q=")+2).substr(0,document.referrer.substring(document.referrer.indexOf("q=")+2).indexOf("&"))}}else{msg_to_post={event_method:method,event_name:event_name,init_ref:document.referrer,init_domain:document.domain,init_url:document.URL,init_base_uri:window.location.pathname,init_ua:navigator.userAgent,init_plat:navigator.platform,init_lang:navigator.language,init_tzo:Math.floor((new Date()).getTimezoneOffset()/60),init_sh:Math.floor(screen.height),init_sw:Math.floor(screen.width),init_avw:Math.floor(screen.availWidth),init_avh:Math.floor(screen.availHeight),init_bh:Math.floor(document.getElementsByTagName('body')[0].clientHeight),init_bw:Math.floor(document.getElementsByTagName('body')[0].clientWidth),init_cd:Math.floor(screen.colorDepth)}}
send_message(msg_to_post);}
break;case "setUserProperties":if(msg.length!==3){send_barion_error(14,[event_name,msg.length]);}else{msg_to_post={event_method:method,event_name:event_name,init_domain:document.domain};let userProperties=msg[2];mandatory_keys=['userId'];type_conversion={'userId':hash,'email':hash,'phone':hash,'accountCreatedTime':to_int,'country':to_country_code,'region':to_county,'city':to_str,'zipCode':to_str,'gender':to_str,'age':to_str,'currency':to_currency_code,'lang':to_language,'interests':to_str,'shippingAddress':to_address,'step':to_int};if(validate(userProperties,event_name,mandatory_keys,type_conversion)){extend_object(msg_to_post,userProperties,'');send_message(msg_to_post);}}
break;case "contentView":case "clickProduct":case "clickProductDetail":case "customizeProduct":case "clickPromo":if(msg.length!==3){send_barion_error(14,[event_name,msg.length]);}else{if(event_name==="contentView"){mandatory_keys=['id','contentType','name'];}
if(event_name==="clickProduct"){mandatory_keys=['id','contentType','name','unitPrice','unit','currency','quantity'];}
if(event_name==="clickProductDetail"){mandatory_keys=['id','contentType','name','unitPrice','unit','currency'];}
if(event_name==="customizeProduct"){mandatory_keys=['id','contentType','name','unitPrice','unit','currency','variant'];}
if(event_name==="clickPromo"){mandatory_keys=['id','contentType','name','creative'];}
if(event_name==="contentView"){msg_to_post={event_method:method,event_name:event_name,init_url:document.URL,init_domain:document.domain};}else{msg_to_post={event_method:method,event_name:event_name,init_domain:document.domain};}
let contentViewProperties=msg[2];type_conversion={'id':to_str,'contentType':to_str,'name':to_str,'contents':to_contents,'ean':to_str,'brand':to_str,'category':to_str,'variant':to_str,'list':to_str,'positioning':to_str,'creative':to_str,'unitPrice':to_float,'imageUrl':to_str,'unit':to_str,'currency':to_currency_code,'quantity':to_float,'step':to_int,'customerValue':to_float};if(validate(contentViewProperties,event_name,mandatory_keys,type_conversion)){extend_object(msg_to_post,contentViewProperties,'');send_message(msg_to_post);}}
break;case "addToCart":case "removeFromCart":if(msg.length!==3){send_barion_error(14,[event_name,msg.length]);}else{msg_to_post={event_method:method,event_name:event_name,init_domain:document.domain};let contentViewProperties=msg[2];mandatory_keys=['id','contentType','name','unitPrice','unit','totalItemPrice','currency','quantity'];type_conversion={'id':to_str,'contentType':to_str,'name':to_str,'contents':to_contents,'ean':to_str,'brand':to_str,'category':to_str,'variant':to_str,'list':to_str,'positioning':to_str,'creative':to_str,'unit':to_str,'unitPrice':to_float,'totalItemPrice':to_float,'currency':to_currency_code,'quantity':to_float,'step':to_int,'customerValue':to_float,'coupon':to_str};if(validate(contentViewProperties,event_name,mandatory_keys,type_conversion)){extend_object(msg_to_post,contentViewProperties,'');send_message(msg_to_post);}}
break;case 'initiateCheckout':if(msg.length!==3){send_barion_error(14,[event_name,msg.length]);}else{msg_to_post={event_method:method,event_name:event_name,init_domain:document.domain};let initiateCheckoutData=msg[2];mandatory_keys=['contents','step','revenue','currency'];type_conversion={'contentType':to_str,'contents':to_contents,'list':to_str,'positioning':to_str,'creative':to_str,'currency':to_currency_code,'step':to_int,'customerValue':to_float,'coupon':to_str,'orderNumber':to_str,'revenue':to_float,'tax':to_float,'shipping':to_float,'shippingAddress':to_address,'opt':to_str};if(validate(initiateCheckoutData,event_name,mandatory_keys,type_conversion)){extend_object(msg_to_post,initiateCheckoutData,'');send_message(msg_to_post);}}
break;case 'addPaymentInfo':if(msg.length!==3){send_barion_error(14,[event_name,msg.length]);}else{msg_to_post={event_method:method,event_name:event_name,init_domain:document.domain};let addPaymentInfoData=msg[2];mandatory_keys=['contents','step','paymentMethod'];type_conversion={'contentType':to_str,'contents':to_contents,'list':to_str,'positioning':to_str,'creative':to_str,'currency':to_currency_code,'step':to_int,'customerValue':to_float,'coupon':to_str,'orderNumber':to_str,'revenue':to_float,'tax':to_float,'shipping':to_float,'shippingAddress':to_address,'opt':to_str,'paymentMethod':to_str};if(validate(addPaymentInfoData,event_name,mandatory_keys,type_conversion)){extend_object(msg_to_post,addPaymentInfoData,'');send_message(msg_to_post);}}
break;case 'purchase':case 'initiatePurchase':if(msg.length!==3){send_barion_error(14,[event_name,msg.length]);}else{msg_to_post={event_method:method,event_name:event_name,init_domain:document.domain};let initiatePurchaseData=msg[2];mandatory_keys=['contents','currency','step','revenue'];type_conversion={'contentType':to_str,'contents':to_contents,'list':to_str,'positioning':to_str,'creative':to_str,'currency':to_currency_code,'step':to_int,'customerValue':to_float,'coupon':to_str,'orderNumber':to_str,'revenue':to_float,'tax':to_float,'shipping':to_float,'shippingAddress':to_address,'opt':to_str};if(validate(initiatePurchaseData,event_name,mandatory_keys,type_conversion)){extend_object(msg_to_post,initiatePurchaseData,'');send_message(msg_to_post);}}
break;case 'search':if(msg.length!==3){send_barion_error(14,[event_name,msg.length]);}else{msg_to_post={event_method:method,event_name:event_name,init_domain:document.domain};let siteSearchData=msg[2];mandatory_keys=["searchString"];type_conversion={contentType:to_str,'id':to_str,'name':to_str,'contents':to_contents,'searchString':to_str,'customerValue':to_float,'currency':to_currency_code,'totalResults':to_int};if(validate(siteSearchData,event_name,mandatory_keys,type_conversion)){extend_object(msg_to_post,siteSearchData,'');send_message(msg_to_post);}}
break;case 'signUp':mandatory_keys=['id','contentType','name'];if(msg.length!==3){send_barion_error(14,[event_name,msg.length]);}else{msg_to_post={event_method:method,event_name:event_name,init_domain:document.domain};let signUpData=msg[2];type_conversion={'id':to_str,'contentType':to_str,'name':to_str,'contents':to_contents,'customerValue':to_float,'currency':to_currency_code,'ean':to_str,'brand':to_str,'category':to_str,'variant':to_str,'unit':to_str,'unitPrice':to_float};if(validate(signUpData,event_name,mandatory_keys,type_conversion)){extend_object(msg_to_post,signUpData,'');send_message(msg_to_post);}}
break;case 'customEvent':if(msg.length!==3){send_barion_error(14,[event_name,msg.length]);}else{msg_to_post={event_method:method,event_name:event_name,init_domain:document.domain};let customEvent=msg[2];if(validate(customEvent,event_name,[],{})){extend_object(msg_to_post,customEvent,'');send_message(msg_to_post);}}
break;case 'grantConsent':if(window["pixelStatus"]["approvedMarketing"]){cookie(get_consent_cookie_name(),1,1.5*SECONDS_IN_YEAR,"/","."+document.domain);}
msg_to_post={event_method:method,event_name:event_name,init_domain:document.domain};send_message(msg_to_post);break;case 'revokeConsent':cookie(get_consent_cookie_name(),1,-1,"/","."+document.domain);msg_to_post={event_method:method,event_name:event_name,init_domain:document.domain};send_message(msg_to_post);break;case 'rejectConsent':if(msg.length!==2){send_barion_error(14,[event_name,msg.length]);}else{cookie(get_consent_cookie_name(),0,SESSION_TIMEOUT,"/","."+document.domain);msg_to_post={event_method:method,event_name:event_name,init_domain:document.domain};send_message(msg_to_post);}
break;case "error":if(msg.length!==3){send_barion_error(14,[event_name,msg.length]);}else{msg_to_post={event_method:method,event_name:event_name,init_domain:document.domain};let customEvent=msg[2];send_error(customEvent['code'],customEvent['description']);}
break;case "categorySelection":if(msg.length!==3){send_barion_error(14,[event_name,msg.length]);}else{msg_to_post={event_method:method,event_name:event_name,init_domain:document.domain};let categorySelProperties=msg[2];mandatory_keys=['id','name'];type_conversion={'id':to_str,'name':to_str,'brand':to_str,'category':to_str,'contents':to_contents,'contentType':to_str,'customerValue':to_float,'list':to_str,'positioning':to_str,'step':to_int};if(validate(categorySelProperties,event_name,mandatory_keys,type_conversion)){extend_object(msg_to_post,categorySelProperties,'');send_message(msg_to_post);}}
break;default:send_barion_error(15,[event_name]);}};window.addEventListener("message",function(e){if(e.origin===EMITTER_HOST){if(e.data["message"]==="pixelStatusBase"){window["pixelStatus"]=e.data["pixelStatus"];if(!window["pixelStatus"]["deniedBase"]){if(need_iframe){if(cookie(get_consent_cookie_name())==="1")
create_marketing_iframe();else
create_base_iframe();need_iframe=false;}
if(window["pixelStatus"]["approvedBase"]){if('multisite_session_id'in e.data){if(e.data['multisite_session_id']!=''){window[SESSION_COOKIE_PREFIX]=e.data['multisite_session_id'];cookie(SESSION_COOKIE_PREFIX,e.data['multisite_session_id']);}}
extend_or_create_cookie(get_session_cookie_name(),SESSION_TIMEOUT);update_visitor_cookie(0);}}}else if(e.data["message"]==="pixelStatus"){window["pixelStatus"]=e.data["pixelStatus"];if(!window["pixelStatus"]["deniedBase"]){if(window["pixelStatus"]["approvedBase"]){if('multisite_session_id'in e.data){if(e.data['multisite_session_id']!=''){window[SESSION_COOKIE_PREFIX]=e.data['multisite_session_id'];cookie(SESSION_COOKIE_PREFIX,e.data['multisite_session_id']);}}
extend_or_create_cookie(get_session_cookie_name(),SESSION_TIMEOUT);update_visitor_cookie(0);}
load_tracker();}}
if(e.data["cookieAllowed"]){window[VISITOR_COOKIE_PREFIX]=e.data[VISITOR_COOKIE_PREFIX];}
else{window[VISITOR_COOKIE_PREFIX]="";}}});const update_visitor_cookie=function(lv){let last_visit;let visitor_cookie_name=get_visitor_cookie_name();let current_visitor_cookie=cookie(visitor_cookie_name);let current_visitor_cookie_value="place_ba_vid";if(current_visitor_cookie!==""){let cookie_content_list=current_visitor_cookie.split(',');let fp=cookie_content_list[1];let first_visit=cookie_content_list[2];let current_visit=now();if(lv===0){last_visit=now();}else{last_visit=lv;}
let current_session_cookie=cookie(get_session_cookie_name());let third_party_cookie_available=window[VISITOR_COOKIE_PREFIX]!=='';if(+third_party_cookie_available!==1){if(cookie_content_list[0]!==""){current_visitor_cookie_value=cookie_content_list[0]}else{current_visitor_cookie_value=uuid();}}
let cookie_value=[current_visitor_cookie_value,fp,first_visit,current_visit,last_visit,current_session_cookie,+third_party_cookie_available].join(',');cookie(visitor_cookie_name,cookie_value,VISITOR_TIMEOUT,"/","."+document.domain);}else{let fp=fingerprint();let current_visit_ts=now();let current_session_cookie=cookie(get_session_cookie_name());let third_party_cookie_available=window[VISITOR_COOKIE_PREFIX]!=='';if(+third_party_cookie_available!==1){current_visitor_cookie_value=uuid();}
let cookie_value=[current_visitor_cookie_value,fp,current_visit_ts,current_visit_ts,current_visit_ts,current_session_cookie,+third_party_cookie_available].join(',');cookie(visitor_cookie_name,cookie_value,VISITOR_TIMEOUT,"/","."+document.domain);}};const callbackFunction=function(msg_queue){while(msg_queue.length>0){let current_msg=msg_queue.shift();if(current_msg){if(current_msg.length<2){send_barion_error(14,[current_msg.msg_type,current_msg.length]);}else{handle_message_from_queue(current_msg);}}}};const load_tracker=function(){let function_name=window.barionpixel_function;if(typeof(function_name)=='undefined'){function_name='bp'}
window[IMPRESSION_ID_CONTAINER]=uuid();if(window[window.BarionAnalyticsObject]===undefined){eventify(window[function_name].q,callbackFunction);window[function_name].q.push();}else{eventify(window[window.BarionAnalyticsObject].q,callbackFunction);window[window.BarionAnalyticsObject].q.push();}};window.addEventListener('load',;}());