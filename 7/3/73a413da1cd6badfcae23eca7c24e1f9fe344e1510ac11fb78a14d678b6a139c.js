(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1439],{45221:6781:function(e,t,n){"use strict";var r=n(52322),i=n(99219);t.Z=,83244:function(e,t,n){"use strict";n.d(t,{ZP:function(){return CapturePreviewProvider},hi:function(){return useCapturePreview}});var r,i,l=n(52322),a=n(2784),o=n(47330);(r=i||(i={})).Element="element",r.Input="input",r.Position="position";let s=(0,a.createContext)({openCapturePreview:()=>{},closeCapturePreview:);et useCapturePreview=,15363:function(e,t,n){"use strict";n.d(t,{Z:function(){return EditorTabGrid}});var r=n(52322);ar i=n(83122),l=n(53954);,87017:function(e,t,n){"use strict";n.d(t,{Z:function(){return EditorBlock}});var r=n(52322);},95631:function(e,t,n){"use strict";n.d(t,{Z:function(){return SelectPersonalizeField}});var r=n(52322),i=n(18318),l=n(55839),a=n(47330),o=n(83122),s=n(53954}},61096:function(e,t,n){"use strict";n.d(t,{s:function(){return EditableText}});var r=n(52322),i=n(2784),l=n(83122),a=n(20851}},8129},95623:function(e,t,n){"use strict";n.d(t,{Z:function(){return InputWithUnits}});var r=n(52322),i=n(2784),l=n(83122),a=n(20851},74262:function(e,t,n){"use strict";n.d(t,{N:function(){return useRenameWebBasedCaptureMutation}});var r=n(73235),i=n(66547),l=n(26806);function _templateObject(){let e=(0,r._)(["\n    mutation RenameWebBasedCapture($input: RenameWebBasedCaptureInput!) {\n  renameWebBasedCapture(input: $input) {\n    id\n    name\n  }\n}\n    "]);return _templateObject=function(){return e},e}let a=(0,i.ZP)(_templateObject()}},64627:function(e,t,n){"use strict";n.d(t,{Az:function(){return getWebCaptureFromCache},J9:function(){return fetchWebCaptureCacheFirst},KE:function(){return requestThemeToken},Y6:function(){return initiateWebCapture},qd:function(){return requestProductDemoCaptureToken}});var r=n(24595),i=n(17840),l=n(16377),a=n(39391);let requestProductDemoCaptureToken=async e=>{let{collectionId:t,flowId:n,maxAge:i=300}=e;return await r.Z.requestSessionToken({collectionId:t,flowId:n,action:"EDIT",mode:"product-demo","max-age":i})}let initiateWebCapture=async e=>{let{collectionId:t,url:n,clickToCaptureEnabled:r}=e,l=await i.qE();if(!l)return{ok:!1,error:"Chrome extension needs to be installed"};let a=await requestProductDemoCaptureToken({collectionId:t,maxAge:3600});if(!a)return{ok:!1,error:"Failed to request session token for initiating capture"};let o=await i.Xi({url:n,token:a,collectionId:t,config:{clickToCapture:r}});return o?{ok:!1,error:o}:{ok:!0,error:void 0}},o=l.Z.CAPTURE_PLAYER_URL,fetchWebCaptur},s=new Map,fetchWebCaptureCacheFirs},getWebCaptureFromCach)},6337:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ep}});var r=n(52322),i=n(2784),l=n(21038);function checklistBuilderReducer(e,t){if("set-language"===t.type){let{language:n}=t.payload;return{...e,language:n}}return e}var a=n(86210),o=n(98269);function checklistDocumentReducer(e,t){if("set-checklist"===t.type)return t.checklist;if(!e||!e.editVersion)return e;switch(t.type){case"update-checklist-doc":return(0,a.a)(e.editVersion.doc,t.payload.patch),{...e};case"set-theme":var n;return e.editVersion.doc.theme=t.payload,e.editVersion.doc.themeId=null===(n=t.payload)||void 0===n?void 0:n.id,{...e};case"append-task":return e.editVersion.doc.tasks.push(t.payload),{...e};case"update-task":return(0,a.a)(e.editVersion.doc.tasks[t.payload.index],t.payload.patch),{...e};case"delete-task":return e.editVersion.doc.tasks.splice(t.payload.index,1),{...e};case"append-task-action":{let n=e.editVersion.doc.tasks[t.payload.taskIndex];return n.actions||(n.actions=[]),n.actions.push(t.payload.action),{...e}}case"update-task-action":{let n=e.editVersion.doc.tasks[t.payload.taskIndex];if(n.actions){let r=n.actions[t.payload.actionIndex];return(0,a.a)(r,t.payload.patch),{...e}}break}case"delete-task-action":{let n=e.editVersion.doc.tasks[t.payload.taskIndex];if(n.actions)return n.actions.splice(t.payload.actionIndex,1),{...e};break}case"set-multilingual-launcher-text":return e.editVersion.doc.multilingualLauncherText=(0,o.Gy)(e.editVersion.doc.multilingualLauncherText,t.payload.content,t.payload.language),{...e};case"set-multilingual-title":return e.editVersion.doc.multilingualTitle=(0,o.Gy)(e.editVersion.doc.multilingualTitle,t.payload.content,t.payload.language),{...e};case"set-multilingual-body":return e.editVersion.doc.multilingualBody=(0,o.Gy)(e.editVersion.doc.multilingualBody,t.payload.content,t.payload.language),{...e};case"set-task-multilingual-title":return(0,o.Gy)(e.editVersion.doc.tasks[t.payload.index].multilingualTitle,t.payload.content,t.payload.language),{...e};case"set-task-multilingual-body":return(0,o.Gy)(e.editVersion.doc.tasks[t.payload.index].multilingualBody,t.payload.content,t.payload.language),{...e}}}var s=n(73235),u=n(23094),c=n(88366),d=n(66548),p=n(82851),h=n(28165),f=n(2397),m=n(12853),v=n(71209),g=n(99219),x=n(3016),y=n(15366),b=n(47819),k=n(83122),C=n(53954),j=n(18838),w=n(71942),E=n(20851),S=n(6676),P=n.n(S),T=n(70443),N=n(91957),F=n(47330),I=n(46995);function ChecklistTask(e){let{idx:t,openSidePanel:n,handleClose:i,completed:l=!1,canEdit:a,checklistDoc:s,language:u,handleChange:c}=e,{workspace:d}=(0,C.cF)(),p=(0,C.NK)(d,F.TT.Multilingual),h=s.tasks[t],{title:f,multilingualTitle:m,body:v,multilingualBody:g}=h,x=p?(0,o._k)(m,u):f,y=p?(0,o._k)(g,u):v;return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(T.xu,{pr:4,pl:0,py:2,variant:"styles.ChecklistTask",onClick:()=>n({panelType:"TASK",props:{handleClose:i,taskIndex:t,checklistDoc:s,language:u,handleChange:c}}),children:(0,r.jsxs)(T.kC,{sx:{justifyContent:"flex-start",alignItems:"center",cursor:a?"pointer":"default"},children:[(0,r.jsx)(T.xu,{className:l?"completed":"",variant:"styles.ChecklistTaskCheck",children:l&&(0,r.jsx)("svg",{viewBox:"0 0 512 512",children:(0,r.jsx)("path",{fill:"currentColor",d:"M435.848 83.466L172.804 346.51l-96.652-96.652c-4.686-4.686-12.284-4.686-16.971 0l-28.284 28.284c-4.686 4.686-4.686 12.284 0 16.971l133.421 133.421c4.686 4.686 12.284 4.686 16.971 0l299.813-299.813c4.686-4.686 4.686-12.284 0-16.971l-28.284-28.284c-4.686-4.686-12.284-4.686-16.97 0z"})})}),(0,r.jsxs)(T.xu,{variant:"styles.ChecklistTaskText",className:l?"navattic-task-completed":"",children:[(0,r.jsx)(T.X6,{as:"h4",px:"5px",py:1,sx:{fontWeight:600,fontSize:"15px",borderRadius:4},children:x||"Untitled Task"}),y&&(0,r.jsx)(T.X6,{as:"h5",px:"5px",py:1,sx:{opacity:".7",fontWeight:400,fontSize:"14px",borderRadius:4},children:y})]})]})})})}function _templateObject(){let e=(0,s._)(["\n  0% {\n    opacity: 0;\n  }\n  100% {\n    opacity: 1;\n  }\n"]);return _templateObject=function(){return e},e}function _templateObject1(){let e=(0,s._)(["\n  animation: "," 0.25s ease;\n"]);return _templateObject1=function(){return e},e}let SortableItem=e=>{let{attributes:t,listeners:n,setNodeRef:i,transform:l,transition:a}=(0,d.nB)({id:e.id}),o={transform:p.ux.Transform.toString(l),transition:a},s="rounded border border-dashed border-transparent px-2 -mr-2 -ml-2",u=e.canEdit?(0,k.AK)(s,"cursor-pointer","hover:border-gray-300"):s;return(0,r.jsx)("div",{className:u,ref:i,style:o,...t,...n,children:(0,r.jsx)(ChecklistTask,{...e})})},L=(0,h.F4)(_templateObject()),_=f.Z.div(_templateObject1(),L),RemainderWidge),B=[{name:"Edit checklist",value:"CHECKLIST"},{name:"Edit checklist launcher",value:"CHECKLIST_LAUNCHER"}],A=[{name:"View checklist",value:"CHECKLIST"},{name:"View checklist launcher",value:"CHECKLIST_LAUNCHER"}],R="flex-1 w-full rounded border border-dashed border-transparent px-2 py-2 -my-2 -mx-2",V="py-4 mt-10 flex justify-center rounded border border-dashed border-transparent";function ChecklistBuilder(e){var t;let{canEdit:n,checklist:l,language:a,defaultLanguage:s,updateChecklist:p,handleChange:h}=e,{workspace:f}=(0,C.cF)(),S=(0,C.NK)(f,F.TT.Multilingual),L=null==l?void 0:null===(t=l.editVersion)||void 0===t?void 0:t.doc,{checklistTitle:D,multilingualTitle:W,checklistBody:Z,multilingualBody:O,theme:K,tasks:G,checklistLauncherText:q,multilingualLauncherText:z,checklistLauncherShowRemainder:H}=L||{},M=S?(0,o._k)(W,a):D,U=S?(0,o._k)(O,a):Z,$=S?(0,o._k)(z,a):q,[X,J]=(0,i.useState)("CHECKLIST"),{openSidePanel:Y,closeSidePanel:Q}=(0,m.u)(),openSidePane),ee=(null==K?void 0:K.published)||y.LIGHT_THEME.config,et=(0,w.Is)(ee),en=n?(0,k.AK)(R,"cursor-pointer","hover:border-gray-300"):R,er=n?(0,k.AK)(V,"cursor-pointer","hover:border-gray-300"):V,ei=(0,u.Dy)((0,u.VT)(v.L,{activationConstraint:{distance:5}}));return L?(0,r.jsx)(N.f,{theme:et,children:(0,r.jsx)(_,{style:{width:450},children:(0,r.jsx)("div",{className:"px-4 pb-2",children:(0,r.jsxs)("div",{className:"mt-8 py-2 pt-1",children:[(0,r.jsx)(x.Z,{items:n?B:A,field:"name",className:"mb-8 mt-2 flex-1",onChang},selected:X}),"CHECKLIST"==X?(0,r.jsx)(T.xu,{variant:"styles.ChecklistWrapper",sx:{width:"100%!important"},children:(0,r.jsxs)(T.kC,{variant:"styles.ChecklistBox",sx:{height:500},children:[(0,r.jsx)(T.xu,{py:3,px:3,children:(0,r.jsx)(T.kC,{sx:{justifyContent:"space-between",flex:1},onClick:()=>openSidePanel({panelType:"CHECKLIST",props:{checklistDoc:L,language:a,handleChange:h,handleClose:Q}}),children:(0,r.jsxs)("div",{className:en,children:[(0,r.jsx)(T.X6,{as:"h4",pl:1,sx:{flex:"1 1 auto"},children:M||"Untitled Checklist"}),(0,r.jsx)(T.X6,{as:"h5",px:"5px",py:1,sx:{opacity:".7",fontWeight:400,fontSize:"14px",borderRadius:4},children:U})]})})}),(0,r.jsxs)(T.kC,{px:3,pb:4,sx:{flex:1,flexDirection:"column",justifyContent:"start",overflowY:"scroll"},children:[(0,r.jsx)(u.LB,{modifiers:[c.DL],sensors:ei,onDragEnd:e=>{let{active:t,over:n}=e;if(!n||!L||!L.tasks)return;let r=L.tasks.findIndex(e=>e.id===t.id),i=L.tasks.findIndex(e=>e.id===n.id);L.tasks=(0,b.yz)((0,E.qY)(L.tasks,r,i)),p({...l,draft:L})},collisionDetection:u.pE,children:(0,r.jsx)(d.Fo,{items:null!=G?G:[],strategy:d.qw,children:(0,r.jsx)("div",{children:G&&G.map((e,t)=>(0,r.jsx)(SortableItem,{id:e.id,idx:t,"data-checklist-builder-task":t,checklistDoc:L,language:a,openSidePanel:openSidePanel,canEdit:n,handleClose:Q,handleChange:h},e.id))})})}),n&&(0,r.jsxs)("button",{onClick:()=>{var e;if(!L)return;let t={id:P()(),title:"",multilingualTitle:s?[{language:s,content:""}]:void 0,body:"",multilingualBody:s?[{language:s,content:""}]:void 0,actions:[],order:(null==L?void 0:null===(e=L.tasks)||void 0===e?void 0:e.length)||0};h({type:"append-task",payload:t}),openSidePanel({panelType:"TASK",props:{checklistDoc:L,taskIndex:t.order,language:a,handleChange:h,handleClose:Q}})},className:"btn-transparent my-2 border border-dashed border-gray-200 text-sm text-gray-400 hover:border-gray-300 hover:text-gray-400",children:[(0,r.jsx)(g.pOD,{className:"mr-2 h-5"}),(0,r.jsx)("span",{children:" Add new task"})]}),(0,r.jsx)(I.h,{enabled:!!ee.watermarkImageSrc,children:(0,r.jsx)(j.Z,{themeConfig:ee,emitNavigateEventOnWatermarkClick:!1})})]})]})}):(0,r.jsx)("div",{className:er,onClick:()=>openSidePanel({panelType:"LAUNCHER",props:{checklistDoc:L,language:a,handleChange:h,handleClose:Q}}),children:(0,r.jsx)(T.xu,{sx:{variant:"styles.ChecklistlauncherContainer"},children:(0,r.jsx)(T.kC,{sx:{justifyContent:"center",alignItems:"center",height:"100%",width:"100%"},children:(0,r.jsxs)(T.kC,{variant:"styles.ChecklistLauncher",children:[(0,r.jsx)("div",{children:$||"Get Started"}),H&&(0,r.jsx)(RemainderWidget,{})]})})})})]})})})}):null}var D=n(83244),W=n(17415),Z=n(52484),O=n(6781),K=n(27783),G=n(15127),q=n(27907),z=n(2715),H=n(86414);function ChecklistBuilderNav(e){var t;let{checklist:n,canEdit:i,isDirty:l,isSaving:a,saveDraft:o,heightClass:s,handleChange:u,dispatchChecklistBuilder:c,checklistBuilderState:d}=e;return(0,r.jsxs)(K.Z,{heightClass:s,children:[n?(0,r.jsx)(K.o,{itemName:"Checklist"}):(0,r.jsx)("div",{}),(0,r.jsx)("div",{children:(0,r.jsx)("div",{className:"flex items-center text-base",children:(0,r.jsxs)("div",{className:"flex items-center gap-x-4",children:[(0,r.jsx)(G.Z,{selectedLanguage:d.language,onChange:e=>{c({type:"set-language",payload:{language:e}}),H.Z.track("product_demo_multilingual_checklist_edited",{language:e})}}),(0,r.jsx)(q.O,{handleChange:u,canEdit:i,checklistDoc:null==n?void 0:null===(t=n.editVersion)||void 0===t?void 0:t.doc}),(0,r.jsx)("div",{className:"w-20 text-sm text-gray-400",children:a?"Saving...":"Draft saved"}),(0,r.jsx)("div",{className:"flex gap-x-2",children:i&&(0,r.jsx)(z.Z,{upToDate:!l&&!a,documentType:"checklist",saveDraft:o})})]})})})]})}var M=n(82057);let U="top-12";function ChecklistBuilderLayout(e){var t,n,i;let{handleChange:l,isSaving:a,isDirty:o,canEdit:s,checklist:u,saveDraft:c,fetching:d,children:p,dispatchChecklistBuilder:h,checklistBuilderState:f}=e,{dialogFontFamily:m,dialogFontUrl:v}=(null==u?void 0:null===(i=u.editVersion)||void 0===i?void 0:null===(n=i.doc)||void 0===n?void 0:null===(t=n.theme)||void 0===t?void 0:t.published)||{};return(0,Z.j)({fontFamily:m,url:v}),(0,r.jsxs)(D.ZP,{children:[(0,r.jsx)(ChecklistBuilderNav,{handleChange:l,heightClass:"h-12",checklist:u,canEdit:s,isDirty:o,saveDraft:c,isSaving:a,dispatchChecklistBuilder:h,checklistBuilderState:f}),d?(0,r.jsx)("div",{className:(0,k.AK)("fixed bottom-0 h-full w-full",U),children:(0,r.jsx)(O.Z,{})}):(0,r.jsx)(W.Z,{topClassName:U,alignCenter:!0,"data-attr":"guide-builder-scroll-container",children:(0,r.jsx)("div",{className:"flex w-full justify-center",children:p})}),(0,r.jsx)(M.Z,{flowBuilderState:{flow:void 0,selectedStepIndices:new Set,selectingSteps:!1,language:void 0}})]})}var $=n(38524),X=n(97185),J=n(22918),Y=n(32517),Q=n(81291),ee=n(54532),et=n(66547),en=n(26806}let er=(0,et.ZP)(updateEditChecklistVersion_templateObject());var ei=n(12902}let el=(0,et.ZP)(getProjectChecklist_templateObject(),ei.o);var ea=n(68793),eo=n(44565),es=n(49830),eu=n(5546),ec=n(5632);let ed=new eo.d(1e3);function ChecklistBuilderPage(){var e,t,n;let a=(0,ec.useRouter)(),o=(0,k.H8)(a.query),s=o.id,u=o.workspace_slug,[{data:c,fetching:d,error:p}]=en.aM({query:el,variables:{id:s}}),[{data:h}]=(0,ea.N)({variables:{projectId:s}}),f=null==h?void 0:h.projectDefaultLanguage,[m,v]=(0,i.useState)(0),[g,x]=(0,i.useState)(-1),[y,j]=(0,i.useState)(!1),[w,E]=(0,i.useState)(!1),[S,P]=(0,i.useState)(),[,T]=en.Db(er),[N,I]=(0,i.useReducer)(checklistDocumentReducer,null==c?void 0:null===(e=c.project)||void 0===e?void 0:e.checklist),[L,_]=(0,i.useReducer)(checklistBuilderReducer,{checklist:N,language:f}),[B]=(0,i.useState)(es.MW),A=(0,C.j_)(F.KG.Projects),R=A===F.KA.Edit,V=m-1>g;(0,i.useEffect)(()=>{var e;(null==c?void 0:null===(e=c.project)||void 0===e?void 0:e.checklist)&&!(null==N?void 0:N.id)&&I({type:"set-checklist",checklist:c.project.checklist})},[c,null==N?void 0:N.id]);let D=(0,i.useCallback)(e=>{e&&(I({type:"set-checklist",checklist:e}),1))},[]),W=(0,i.useCallback)(async()=>{let e=await B.acquire();try{let e=m-1;if(x(e),N){let{editVersion:e}=N,t=null==e?void 0:e.doc,{theme:n,...r}=t||{},i=JSON.parse(JSON.stringify(r));(0,b.lJ)(i),(0,b.ww)(i);let l=await T({projectId:s,checklistVersion:{doc:i}});return l.error&&(e=>{var t;let n="Error saving guide draft";console.error(e),(0,Y.Rn)(n),eu.u.error(n,{workspace_slug:null!=u?u:null,guideId:null!==(t=null==N?void 0:N.id)&&void 0!==t?t:null,error:null!=e?e:null})})(l.error.message),l}}finally{B.release(e)}},[N,m,B,s,T,u]),Z=(0,i.useCallback)(async()=>(await B.isAvailable(),ed.cal})),[B,W]),O=(0,i.useCallback)(()=>(j(!0),V)?Z():ed.promise,[V,Z]);(0,i.useEffect)(()=>{f&&!L.language&&_({type:"set-language",payload:{language:f}})},[L.language,f]),(0,i.useEffect)(()=>{let e=m-1;e!==g&&Z()},[Z,g,m]),(0,i.useEffect)(()=>{let handleRouteChange=e=>{if(V)throw P(e),E(!0),a.events.emit("routeChangeError"),"routeChange aborted. This error can be safely ignored - https://github.com/zeit/next.js/issues/2476."};return a.events.on("routeChangeStart",handleRouteChange)},[a.events,V]);let handleChange=e=>{I(e),N&&D({...N})};return(0,r.jsxs)(ee.Z,{workspaceItem:F.KG.Projects,children:[(0,r.jsx)(Q.Z,{title:"".concat((null==c?void 0:null===(t=c.project)||void 0===t?void 0:t.name)||"(Untitled Project)"," checklist"),includeSlug:!0}),(0,r.jsx)(ChecklistBuilderLayout,{fetching:d,canEdit:R,isSaving:y,isDirty:V,checklist:N||(null==c?void 0:null===(n=c.project)||void 0===n?void 0:n.checklist),handleChange:handleChange,saveDraft:O,dispatchChecklistBuilder:_,checklistBuilderState:L,children:(0,r.jsx)(ChecklistBuilder,{canEdit:R,checklist:N,language:L.language,defaultLanguage:f,updateChecklist:D,handleChange:handleChange})}),(0,r.jsx)(l.Z,{saveDraft:Z,open:w,handleClos),path:S}),(0,r.jsx)(J.Z,{}),(0,r.jsx)($.Z,{})]})}ChecklistBuilderPage.getLayout=function(e){return(0,r.jsx)(X.Z,{blockLayout:!0,fixedLayout:!0,children:(0,r.jsx)(m.Z,{children:e})})};var ep=ChecklistBuilderPage},67569:function(e,t,n){"use strict";n.d(t,{N:function(){return d}});var r=n(52322),i=n(2784),l=n(43833),a=n(15993),o=n(97015),s=n(2877),u=n(89370),c=n(71664);let d={boxShadow:"0 0 4px 0 rgba(124, 148, 166, 0.8), 0 0 0 1000vw rgba(218, 228, 235, 0.5)"},getParentIfSve;t.}},4714},43833:function(e,t,n){"use strict}n.d(t,{}})},15993:function(e,t,n){"use strict";n.d(t,{I},VB:function(){return extractElFromEvent},g_:function(){return getIframeDocumentSafe},wK:function(){return getFrameElement}});var r=n(98751),i=n(55283),l=n(20851let collectFrame},getFirstLevelFrame,2877:function(e,t,n){"use strict";n.d(t,{Z:function(){return generateSelector}});var r=n(89370),i=n(55283),l=n(97015}},50733:function(e,t,n){"use strict";n.d(t,{$M:function(){return i},JH:function(){return r},SW:function(){return a},lk:function(){return l}});let r="__NAVATTIC_FLOW____CAPTURE_OPEN__",i=Symbol("nv_node_ref"),l={width:1200,height:750},a=800},63749:function(e,t,n){"use strictn.d(t,{w:function(){return objectAssign}})}}]);
//# sourceMappingURL=builder-05f8baeab82224c7.js.map