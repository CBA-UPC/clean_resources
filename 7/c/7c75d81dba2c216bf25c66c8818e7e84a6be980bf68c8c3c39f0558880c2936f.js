"use strict";(self.webpackChunkphotobucket_web=self.webpackChunkphotobucket_web||[]).push([[5363],{55127:function(e,t,r){r.d(t,{Z:function(){return a}});var n=r(99881),i=r(46417);function a(e){return(0,i.jsx)(n.Z,{"data-test":"alert",elevation:6,variant:"filled",severity:e.severity,sx:{marginBottom:"12px",zIndex:100},children:e.children})}},65079:function(e,t,r){r.d(t,{Z:function(){return o}});var n=r(16031),i=r(55127),a=r(46417);function o(e){var t=e.error;if(!t)return null;var r=t.networkError,o=t.graphQLErrors;return(0,n.isEmpty)(o)?r?(0,a.jsx)(i.Z,{severity:"error",children:r.message}):null!==t&&void 0!==t&&t.networkError?(0,a.jsxs)(i.Z,{severity:"error",children:["Network Error: ",t.networkError.message]}):null:(0,a.jsx)(a.Fragment,{children:t.graphQLErrors.map((function(e){return(0,a.jsx)(i.Z,{severity:"error",children:e.message},"".concat(e.name,"-").concat(e.path))}))})}o.defaultProps={error:void 0}},2970:function(e,t,r){var n;r.d(t,{D:function(){return n}}),n||(n={}))},64271:function(e,t,r){r.d(t,{Z:function(){return i}});var n=r(46417);function i(e){var t=e.width,r=e.height;return(0,n.jsxs)("svg",{width:t,height:r,viewBox:"0 0 114 98",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("path",{d:"M105.708 18.8333H54.8843C53.2152 18.8333 51.6562 18.0005 50.7282 16.6131L44.904 7.90522C44.5121 7.31922 43.9812 6.83872 43.3583 6.50636C42.7354 6.174 42.0399 6.00007 41.3333 6H11.2917C10.1534 6 9.06184 6.45069 8.257 7.25293C7.45216 8.05517 7 9.14324 7 10.2778L7 78.7222C7 79.8568 7.45216 80.9448 8.257 81.7471C9.06184 82.5493 10.1534 83 11.2917 83H105.708C106.847 83 107.938 82.5493 108.743 81.7471C109.548 80.9448 110 79.8568 110 78.7222V23.1111C110 21.9766 109.548 20.8885 108.743 20.0863C107.938 19.284 106.847 18.8333 105.708 18.8333Z",fill:"url(#paint0_linear)",fillOpacity:"0.8"}),(0,n.jsx)("path",{d:"M102.042 12H55.393C53.7127 12 52.1447 11.156 51.2194 9.75345L45.96 1.7815C45.5986 1.23356 45.1089 0.784258 44.5344 0.473482C43.9599 0.162706 43.3183 6.61295e-05 42.6667 0H14.9583C13.9085 0 12.9017 0.421428 12.1594 1.17157C11.417 1.92172 11 2.93913 11 4V68C11 69.0609 11.417 70.0783 12.1594 70.8284C12.9017 71.5786 13.9085 72 14.9583 72H102.042C103.091 72 104.098 71.5786 104.841 70.8284C105.583 70.0783 106 69.0609 106 68V16C106 14.9391 105.583 13.9217 104.841 13.1716C104.098 12.4214 103.091 12 102.042 12Z",fill:"url(#paint1_linear)",fillOpacity:"0.5"}),(0,n.jsx)("path",{d:"M41.5359 14.8928L41.536 14.8929L48.1415 24.8009C49.1616 26.331 50.8788 27.25 52.7177 27.25H109.25C110.377 27.25 111.458 27.6978 112.255 28.4948C113.052 29.2918 113.5 30.3728 113.5 31.5V93.25C113.5 94.3772 113.052 95.4582 112.255 96.2552C111.458 97.0522 110.377 97.5 109.25 97.5H4.75C3.62283 97.5 2.54182 97.0522 1.7448 96.2552C0.947767 95.4582 0.5 94.3772 0.5 93.25V17.25C0.5 16.1228 0.947767 15.0418 1.7448 14.2448C2.54183 13.4478 3.62283 13 4.75 13H38C38.6996 13.0001 39.3884 13.1729 40.0053 13.5031C40.6221 13.8333 41.1479 14.3107 41.5359 14.8928Z",fill:"url(#paint2_linear)",stroke:"url(#paint3_diamond)"}),(0,n.jsx)("path",{d:"M71.2822 49L99.2822 85H38.2822L71.2822 49Z",fill:"url(#paint4_linear)"}),(0,n.jsx)("path",{d:"M37 56L59 85H17L37 56Z",fill:"url(#paint5_linear)"}),(0,n.jsx)("circle",{cx:"99",cy:"44",r:"5",fill:"url(#paint6_linear)",fillOpacity:"0.4"}),(0,n.jsxs)("defs",{children:[(0,n.jsxs)("linearGradient",{id:"paint0_linear",x1:"136.265",y1:"39.7124",x2:"59.7924",y2:"79.8056",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{offset:"0.136937",stopColor:"#B6CEFC"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#C2E4FF"})]}),(0,n.jsxs)("linearGradient",{id:"paint1_linear",x1:"130.225",y1:"31.5233",x2:"59.2782",y2:"68.2128",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{offset:"0.136937",stopColor:"#B6CEFC"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#C2E4FF"})]}),(0,n.jsxs)("linearGradient",{id:"paint2_linear",x1:"143.07",y1:"49.9339",x2:"51.3013",y2:"102.3",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{offset:"0.136937",stopColor:"#9FBEFA"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#C2E4FF"})]}),(0,n.jsxs)("radialGradient",{id:"paint3_diamond",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(6.00001 13) rotate(65.3981) scale(150.128 200.171)",children:[(0,n.jsx)("stop",{stopColor:"white"}),(0,n.jsx)("stop",{offset:"1",stopColor:"white",stopOpacity:"0"})]}),(0,n.jsxs)("linearGradient",{id:"paint4_linear",x1:"-5.03583e-07",y1:"54",x2:"99",y2:"92.5",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#C5D8FE"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#84A9EF"})]}),(0,n.jsxs)("linearGradient",{id:"paint5_linear",x1:"-5.03583e-07",y1:"54",x2:"99",y2:"92.5",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#C5D8FE"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#84A9EF"})]}),(0,n.jsxs)("linearGradient",{id:"paint6_linear",x1:"94",y1:"43.0446",x2:"100.356",y2:"49.8326",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#7EABFF"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#B0CBFF"})]})]})]})}i.defaultProps={width:114,height:98}},944:96849:function(e,t,r){var n=r(47131),i=r(17592);t.Z=(0,i.ZP)(n.Z,{shouldForwardProp:)((function(e){var t=e.isActive;return{position:"absolute",color:e.theme.palette.primary.contrastText,backgroundColor:"rgba(71,85,105,0.5)",padding:"2px",display:t?"inline-flex":"none","&:hover":{display:"inline-flex"}}}))},4587:function(e,t,r){r.d(t,{Z:function(){return m}});var n=r(29439),i=r(91554),a=r(17592),o=r(61113),l=r(16031),s=r(47313),u=r(58467),d=r(91345),c=r(48509),p=r(46417),f=(0,a.ZP)(i.Z)((function(e){return{position:"absolute",width:"100%",color:"#fff",zIndex:e.theme.zIndex.drawer-1,alignItems:"baseline"}}));function m(e){var t,r=e.albumId,i=(0,d.at)(),a=(0,u.UO)().albumId,m=r||a||(null===i||void 0===i||null===(t=i.profile)||void 0===t?void 0:t.defaultAlbum),v=(0,c.Z)(),h=(0,s.useRef)(v),g=(0,s.useRef)(null),x=(0,s.useState)(!1),b=(0,n.Z)(x,2),Z=b[0],y=b[1];return(0,s.useEffect)((function(){var e,t=null===(e=g.current)||void 0===e?void 0:e.parentElement;if(!t)return var r=function(e){var t;e.preventDefault(),e.stopPropagation(),null!==(t=e.dataTransfer)&&void 0!==t&&t.types&&e.dataTransfer.types.includes("Files")&&y(!0)},n=i=function(e){var t;e.preventDefault(),e.stopPropagation(),y(!1);var r=null===(t=e.dataTransfer)||void 0===t?void 0:t.files;r&&!(0,l.isEmpty)(r)&&m&&h.current.uploadMultiple(r,m)};return t.addEventListener("dragover",r),t.addEventListener("drop",i),t.addEventListener("dragleave",n),),[m]),(0,p.jsx)(f,{ref:g,open:Z,children:(0,p.jsx)(o.Z,{variant:"h4",align:"center",sx:{position:"sticky",top:100,fontWeight:600},children:"Drop your media here"})})}m.defaultProps={albumId:void 0}},48509:function(e,t,r){r.d(t,{Z:function(){return F}});var n,i=r(15861),a=r(93433),o=r(1413),l=r(64687),s=r.n(l),u=r(61511),d=r(90297),c=r(72668),p=r(44766),f=r(31881),m=r.n(f),v=r(19655),h=r(16031),g=r(18248),x=r(28297),b=r(28422),Z=r(91345),y=r(2970),w=r(11149),C=r(25258),j=r(39437),I=r(63694),A=r(98976),k=r(4942),S=(n={},(0,k.Z)(n,b.hqH.DateTaken,"dateTaken"),(0,k.Z)(n,b.hqH.Date,"uploadDate"),(0,k.Z)(n,b.hqH.Title,"title"),n),E=r(31500);function F(){var e,t,r,n,l,f,k,F,U,_,P=(0,u.x)(),L=(0,Z.at)(),T=(0,w.Z)().settings,z=(0,I.Z)(),D=(0,E.Z)(),R=(0,j.Z)().createAlert,B=(0,d.l)(Z.Xs),M=(0,c.a)(b.d5z,{onError:function(e){C.Z.error("[GET_SUPPORTED_FILE_TYPES]: ".concat(e.message)),R("Unable to retrieve acceptable file types. Please try again later")}}).data,N=new Map,O=new Map,H=(null===M||void 0===M?void 0:M.getSupportedFileTypes.maxImageFileSizeInBytes)||1/0,V=(null===M||void 0===M?void 0:M.getSupportedFileTypes.maxVideoFileSizeInBytes)||1/0;null===M||void 0===M||M.getSupportedFileTypes.imageTypes.forEach((function(e){return N.set(e,!0)})),null===M||void 0===M||M.getSupportedFileTypes.videoTypes.forEach(();var G=(null===L||void 0===L||null===(e=L.profile)||void 0===e||null===(t=e.subscription)||void 0===t?void 0:t.totalImagesCount)||0,X=(null===L||void 0===L||null===(r=L.profile)||void 0===r||null===(n=r.subscription)||void 0===n?void 0:n.totalUserUsedSpace)||0,q=(null===L||void 0===L||null===(l=L.profile)||void 0===l||null===(f=l.subscription)||void 0===f||null===(k=f.plan)||void 0===k?void 0:k.maxImagesCount)||Number.MAX_SAFE_INTEGER,W=(null===L||void 0===L||null===(F=L.profile)||void 0===F||null===(U=F.subscription)||void 0===U||null===(_=U.plan)||void 0===_?void 0:_.maxSpace)||Number.MAX_SAFE_INTEGER,Q=function(e){var t=e.data;return(0,o.Z)((0,o.Z)({},t),{},{__typename:"Image",image:(0,o.Z)((0,o.Z)({},t.image),{},{isLandscape:null,__typename:"ImageFile"}),originalImage:(0,o.Z)((0,o.Z)({},t.originalImage),{},{isLandscape:null,__typename:"ImageFile"}),thumbnailImage:(0,o.Z)((0,o.Z)({},t.originalImage),{},{isLandscape:null,__typename:"ImageFile"})})},Y=function(e){var t=S[T.sortBy.field];P.cache.updateQuery({query:b.b6e,variables:{albumId:e.albumId,sortBy:T.sortBy,pageSize:A.IV}},(function(r){if(!r)return null;var n=r.getAlbumImagesV2,i=n.items,o=n.scrollPointer;return{getAlbumImagesV2:{items:(0,h.orderBy)([].concat((0,a.Z)(i),[e]),t,T.sortBy.desc?"desc":"asc"),scrollPointer:o}}})),P.cache.updateQuery({query:b.x4R,variables:{albumId:z.defaultAlbum,sortBy:T.sortBy,pageSize:A.IV}},(function(r){if(!r)return null;var n=r.getImagesFromAlbumAndSubAlbums,i=n.items,o=n.scrollPointer;return{getImagesFromAlbumAndSubAlbums:{items:(0,h.orderBy)([].concat((0,a.Z)(i),[e]),t,T.sortBy.desc?"desc":"asc"),scrollPointer:o}}})),P.cache.modify({id:"AlbumV2:".concat(e.albumId),fields:{counters:function(e){return{imageCount:e.imageCount+1,imageCountIncludeSubAlbums:e.imageCountIncludeSubAlbums}}}})},$=function(e){var t=0;return Array.from(e).forEach((),!(G+1>q||X+t>W)||(R("You have reached your storage limit. Upgrade your account to upload more images."),!1)},J=function(){var e=(0,i.Z)(s().mark((function e(t,r,n){var a,l,u;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(a=(0,v.v0)().currentUser)||void 0===a?void 0:a.getIdToken();case 2:if(l=e.sent){e.next=6;break}return(0,Z.sh)([{id:(0,p.k$)(),message:"Send Request Failed: Unauthorized.",severity:"error"}]),e.abrupt("return");case 6:return u=t.map(function(){var e=(0,i.Z)(s().mark((function e(t){var r,n,i,a,u,d,c,p,f,v,h,b;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.file,n=t.id,i=t.albumId,a={"Content-Type":"multipart/form-data",authorization:l,"x-correlation-id":(0,g.Z)()},u={albumId:i},d=new FormData,c=r.name.split("."),p=c[c.length-1],f=null===p||void 0===p?void 0:p.toLowerCase(),e.prev=7,f&&(N.get(f)||O.get(f))){e.next=10;break}throw new Error("File name ".concat(r.name," has an incompatible file type"));case 10:if(!(N.get(f)&&r.size>H)){e.next=12;break}throw new Error("File name ".concat(r.name," has a file size greater than ").concat(H," bytes"));case 12:if(!(O.get(f)&&r.size>V)){e.next=14;break}throw new Error("File name ".concat(r.name," has a file size greater than ").concat(V," bytes"));case 14:return d.append("file",r),e.next=17,m().post(x.ZP.api.upload,d,{headers:a,params:u});case 17:v=e.sent,h=Q(v),Y(h),B[n]=(0,o.Z)((0,o.Z)({},B[n]),{},{status:y.D.Completed}),(0,Z.Xs)((0,o.Z)({},B)),e.next=31;break;case 24:e.prev=24,e.t0=e.catch(7),b=e.t0,C.Z.error("Something is wrong",e.t0),B[n]=(0,o.Z)((0,o.Z)({},B[n]),{},{status:y.D.Failed}),(0,Z.Xs)((0,o.Z)({},B)),R(b.message);case 31:case"end":return e.stop()}}),e,null,[[7,24]])})));return ()),e.next=9,Promise.all(u);case 9:C.Z.debug("Batch ".concat(r," of ").concat(n),(new Date).toISOString());case 10:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),K=function(){var e=(0,i.Z)(s().mark((function e(t,r,n){var i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.pop()){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,J(i,r,n);case 5:return e.next=7,K(t,r+1,n);case 7:case"end":return e.stop()}}),e)})));return (),ee=function(){var e=(0,i.Z)(s().mark((function e(t,r){var n,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if($(t)){e.next=3;break}return e.abrupt("return");case 3:return n=Array.from(t).map((function(e){var t=(0,g.Z)();return B[t]={url:URL.createObjectURL(e),albumId:r,status:y.D.InProgress,type:e.type},(0,Z.Xs)((0,o.Z)({},B)),{file:e,id:t,albumId:r}})),i=(0,h.chunk)(n,5),e.next=7,K(i,1,i.length);case 7:return e.next=9,D.execute();case 9:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),te=function(){var e=(0,i.Z)(s().mark((function e(t,r){var n,i,a,l,u,d,c,f,h,b,w,j;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(n=(0,v.v0)().currentUser)||void 0===n?void 0:n.getIdToken();case 2:if(i=e.sent){e.next=6;break}return(0,Z.sh)([{id:(0,p.k$)(),message:"Send Request Failed: Unauthorized.",severity:"error"}]),e.abrupt("return",null);case 6:if($([t])){e.next=9;break}return e.abrupt("return",null);case 9:if(a=(0,g.Z)(),B[a]={url:URL.createObjectURL(t),albumId:r,status:y.D.InProgress,type:t.type},(0,Z.Xs)((0,o.Z)({},B)),l={"Content-Type":"multipart/form-data",authorization:i,"x-correlation-id":(0,g.Z)()},u={albumId:r},d=new FormData,c=t.name.split("."),f=c[c.length-1],h=null===f||void 0===f?void 0:f.toLowerCase(),e.prev=18,h&&(N.get(h)||O.get(h))){e.next=21;break}throw new Error("File name ".concat(t.name," has an incompatible file type"));case 21:if(!(N.get(h)&&t.size>H)){e.next=23;break}throw new Error("File name ".concat(t.name," has a file size greater than ").concat(H," bytes"));case 23:if(!(O.get(h)&&t.size>V)){e.next=25;break}throw new Error("File name ".concat(t.name," has a file size greater than ").concat(V," bytes"));case 25:return d.append("file",t),e.next=28,m().post(x.ZP.api.upload,d,{headers:l,params:u});case 28:return b=e.sent,w=Q(b),Y(w),B[a]=(0,o.Z)((0,o.Z)({},B[a]),{},{status:y.D.Completed}),(0,Z.Xs)((0,o.Z)({},B)),e.next=35,D.execute();case 35:return e.abrupt("return",w.id);case 38:e.prev=38,e.t0=e.catch(18),j=e.t0,C.Z.error("Something is wrong",e.t0),B[a]=(0,o.Z)((0,o.Z)({},B[a]),{},{status:y.D.Failed}),(0,Z.Xs)((0,o.Z)({},B)),R(j.message);case 45:return e.abrupt("return",null);case 46:case"end":return e.stop()}}),e,null,[[18,38]])})));return function(t,r){return e.apply(this,arguments)}}();return{uploadMultiple:ee,uploadSingle:te,stopPropagation:}},31500:function(e,t,r){r.d(t,{Z:function(){return d}});var n=r(1413),i=r(29439),a=r(96420),o=r(18248),l=r(28422),s=r(91345),u=r(25258);function d(){var e=(0,a.t)(l.D9W,{onCompleted:function(e){var t=e.getProfile;t&&(0,s.at)({profile:(0,n.Z)({},t)})},onError:function(e){u.Z.error("Something went wrong while updating user usage statistics",e);var t={id:(0,o.Z)(),message:"Something went wrong while updating user image count. Please refresh the page to show new image count.",severity:"none"};(0,s.sh)([t])}});return{execute:(0,i.Z)(e,1)[0]}}},47053:function(e,t,r){function n(e){var t,r,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;if(null!==e&&void 0!==e&&null!==(t=e.originalImage)&&void 0!==t&&t.url){var a=e.originalImage.url.split("?")[0],o=e.originalImage.width||1/0,l={width:(null===(r=e.originalImage.width)||void 0===r?void 0:r.toString())||"590",height:(null===(n=e.originalImage.height)||void 0===n?void 0:n.toString())||"590",fit:"bounds"};i<=590&&o>=590&&(l.width="590",l.height="590"),i<=320&&o>=320&&(l.width="320",l.height="320");var s=new URLSearchParams(l).toString();return"".concat(a,"?").concat(s)}}r.d(t,{Z:function(){return n}})},40497:function(e,t,r){r.d(t,{Z:function(){return f}});var n=r(4942),i=r(1413),a=r(29439),o=r(24193),l=r(16783),s=r(47313),u=r(65079),d=r(51748),c=r(83798),p=r(46417);function f(e){var t,r={title:(new Date).toLocaleDateString()},f=(0,s.useRef)(r),m=e.parentAlbumId,v=e.onClose,h=(0,c.Z)(),g=h.mutation,x=h.results,b=(0,s.useState)(f.current),Z=(0,a.Z)(b,2),y=Z[0],w=Z[1],C=(0,s.useState)({}),j=(0,a.Z)(C,2),I=j[0],A=j[1];(0,s.useEffect)((function(){var e;null!==(e=x.data)&&void 0!==e&&e.albumCreate&&w(f.current)}),[null===(t=x.data)||void 0===t?void 0:t.albumCreate]);return(0,p.jsxs)("form",{children:[(0,p.jsx)(u.Z,{error:x.error}),(0,p.jsx)(l.Z,{autoFocus:!0,"data-test":"create-album-title",error:Boolean(I.title),fullWidth:!0,helperText:I.title,label:"Album Name",margin:"normal",name:"title",onChange:function(e){var t=(0,i.Z)({},y),r=e.target.name;t[r]=e.target.value,w(t);var n=(0,i.Z)({},I);delete n[r],delete n.general,A(n)},value:y.title}),(0,p.jsx)(o.Z,{color:"primary",variant:"contained",onClick:function(){try{if(!y.title)throw new d.Z("Title is required","title");var e={parentAlbumId:m,title:y.title};g({variables:e}),v()}catch(r){var t=r;if("RequiredParameterException"===t.code)A((0,n.Z)({},t.parameterName,t.message));else A({general:t.message})}},type:"submit","data-test":"submit-create-album",children:"Create Album"}),(0,p.jsx)(o.Z,{onClick:v,children:"Cancel"})]})}},15363:function(e,t,r){r.r(t),r.d(t,{default:);var n=r(72668),i=r(16031),a=r(58467),o=r(39837),l=r(28422),s=r(91345),u=r(85109),d=r(3404),c=r(24193),p=r(61113),f=r(2135),m=r(12164),v=r(46417);function h(){var e,t,r,n=(0,m.Z)().currentAlbum,i=(0,s.at)(),a=(null===n||void 0===n?void 0:n.parentAlbumId)===(null===i||void 0===i||null===(e=i.profile)||void 0===e?void 0:e.defaultAlbum);return n?(0,v.jsxs)(d.Z,{separator:(0,v.jsx)(u.Z,{fontSize:"small"}),children:[(0,v.jsx)(c.Z,{color:"primary",to:"/u/".concat(null===i||void 0===i||null===(t=i.profile)||void 0===t?void 0:t.username,"/albums"),component:f.rU,style:{textTransform:"none"},children:"All Albums"}),!a&&(0,v.jsx)(c.Z,{color:"primary",to:"/u/".concat(null===i||void 0===i||null===(r=i.profile)||void 0===r?void 0:r.username,"/a/").concat(n.parentAlbumId),component:f.rU,children:"..."}),(0,v.jsx)(p.Z,{sx:{fontSize:"14px",color:"black",fontWeight:"600"},children:n.title},n.id)]}):null}var g=r(15861),x=r(1413),b=r(64687),Z=r.n(b),y=r(19860),w=r(24813),C=r(36241),j=r(47313),I=r(8566),A=r(17189),k=r(72657),S=r(4587),E=r(90297),F=r(68728),U=r(90891),_=r(19536),P=r(73984),L=r(56854),T=r(9289),z=r(71651),D=r(64271),R=r(944),B=r(63694),M=r(96672),N=r(96849),O=r(43986),H=r(47053);function V(e){var t,r=e.albumId,i=e.boundary,a=e.handleClick,o={albumId:r,pageSize:4},s=(null===(t=(0,n.a)(l.b6e,{variables:o}).data)||void 0===t?void 0:t.getAlbumImagesV2.items)||[],u=function(e){e.stopPropagation(),e.currentTarget.src=R.N,e.currentTarget.srcset=R.N};return s&&s.length?(0,v.jsx)(P.Z,{sx:{width:i,height:i,margin:0,overflow:"hidden"},variant:"quilted",cols:2,rowHeight:Math.floor(Number(i||0)/2),onClick:a,children:s.map((function(e,t){var r=(0,H.Z)(e,i),n=function(e,t){var r={0:{cols:1,rows:1},1:{cols:1,rows:1},2:{cols:1,rows:1},3:{cols:1,rows:1}};switch(e){case 1:r[0]={cols:2,rows:2};break;case 2:r[0]={cols:1,rows:2},r[1]={cols:1,rows:2};break;case 3:r[0]={cols:1,rows:1},r[1]={cols:1,rows:2},r[2]={cols:1,rows:1}}return r[t]}(s.length,t),a=n.cols,o=n.rows;return r?(0,v.jsx)(L.Z,{cols:a,rows:o,children:(0,v.jsx)("img",{src:r,alt:e.title,onError:u,loading:"lazy"})},e.id):null}))}):(0,v.jsx)(P.Z,{sx:{width:i,height:i,margin:0},cols:1,rowHeight:Number(i||0),onClick:a,children:(0,v.jsx)(L.Z,{cols:1,rows:1,sx:{justifyContent:"center",alignItems:"center"},children:(0,v.jsx)(D.Z,{})})})}function G(e){var t,r,n,o=e.album,l=e.boundary,u=(0,s.at)(),d=(0,B.Z)().isFreeUser,c=(0,a.s0)(),m=(0,y.Z)(),h=(0,j.useRef)(null),g=(0,z.Z)(h),x=(0,E.l)(s._N).albums,b=(0,O.Z)(),Z=b.selectedAlbums,w=b.toggleSelect,C=(0,b.isSelected)(o.id),I=!o.parentAlbumId||o.parentAlbumId===o.id,A=o.id===(null===u||void 0===u||null===(t=u.profile)||void 0===t?void 0:t.mobileAlbum),k=o.counters,S=k.imageCount,P=void 0===S?0:S,L=k.nestedAlbumsCount,D=void 0===L?0:L,R="".concat(P," images");I&&1===P?R="1 image not in any album":I?R="".concat(P," images not in any album"):1===P&&(R="1 image");return(0,v.jsxs)("div",{ref:h,style:{padding:12,position:"relative"},children:[(0,v.jsxs)(N.Z,{isActive:x||!!C||g,sx:{top:8,left:8,zIndex:1,backgroundColor:C?m.palette.primary.main:"rgba(71,85,105,0.5)","&:hover":{backgroundColor:C?"white":"rgba(71,85,105,0.9)"}},onClick:"data-id":o.id,"data-test":C?"deselect":"select",children:[C&&(0,v.jsx)(F.Z,{color:"inherit",sx:{background:m.palette.primary.main,borderRadius:"50%",padding:"1px"}}),!C&&(0,v.jsx)(F.Z,{color:"inherit",sx:{background:"transparent",borderRadius:"50%",padding:"1px"}})]}),(0,v.jsx)(V,{albumId:o.id,boundary:l,handleClick:function(){(0,i.isEmpty)(Z)&&!x?c("/u/".concat(o.owner,"/a/").concat(o.id)):w(o.id)}}),(0,v.jsxs)(T.Z,{disableGutters:!0,sx:{paddingTop:2},children:[(0,v.jsx)(M.ZP,{hidden:I,album:o,isPasswordProtectedDisabled:d}),(0,v.jsxs)("div",{children:[(0,v.jsx)(p.Z,{variant:"subtitle2",children:I?"Images without albums":o.title}),(0,v.jsxs)(p.Z,{variant:"caption",sx:{display:"flex",flexWrap:"wrap"},children:[(0,v.jsx)(U.Z,{component:f.rU,to:"/u/".concat(null===u||void 0===u||null===(r=u.profile)||void 0===r?void 0:r.username,"/a/").concat(o.id),children:R}),!I&&!A&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(_.Z,{orientation:"vertical",sx:{marginLeft:1,marginRight:1}}),(0,v.jsx)(U.Z,{component:f.rU,to:"/u/".concat(null===u||void 0===u||null===(n=u.profile)||void 0===n?void 0:n.username,"/a/").concat(o.id,"/subalbums"),children:"".concat(D," Album").concat(1===D?"":"s")})]})]})]})]})]})}var X=r(29439),q=r(41434),W=r(47131),Q=r(40497);function Y(e){var t=e.boundary,r=(0,s.at)(),n=(0,a.TH)(),i=(0,a.UO)().albumId,o=(0,j.useState)(!1),l=(0,X.Z)(o,2),u=l[0],d=l[1];return(0,j.useEffect)((function(){var e=(n.state?n.state:{createNewAlbum:!1}).createNewAlbum;d(!!e)}),[n]),null!==r&&void 0!==r&&r.profile?(0,v.jsxs)("div",{style:{marginTop:12,marginLeft:12,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center",height:t,width:t,border:"1px dashed #0672CB",backgroundColor:"rgba(6, 114, 203, 0.08)"},children:[!u&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(W.Z,{onClick:"data-test":"create-album-add-button",size:"large",id:"create-album-add-button",children:(0,v.jsx)(q.Z,{})}),(0,v.jsx)(p.Z,{color:"primary",style:{fontWeight:"bold"},children:"Create new album"})]}),u&&(0,v.jsx)(Q.Z,{parentAlbumId:i||r.profile.defaultAlbum,onClose:)]}):null}function $(e){var t=e.data,r=e.rowIndex,n=e.columnIndex,a=e.style,o=t.zoom,l=t.items[r*o+n];return(0,i.isUndefined)(l)?null:(0,i.isNull)(l)?(0,v.jsx)("div",{style:a,children:(0,v.jsx)(Y,{boundary:Number(a.width)-12})}):(0,v.jsx)("div",{style:a,children:(0,v.jsx)(G,{album:l,boundary:Number(a.width)-12})})}var J=(0,j.forwardRef)((function(e,t){var r=e.children,n=e.style,i=e.onScroll;return(0,v.jsx)("div",{id:"gallery",style:(0,x.Z)((0,x.Z)({},n),{},{overflowX:"hidden"}),onScroll:i,ref:t,children:r})}));function K(e){var t=e.items,r=e.fetchMore,n=e.hasMore,i=C.isMobile?0:14,o=l=(0,y.Z)(),u=(0,w.Z)(l.breakpoints.up("sm")),d=(0,w.Z)(l.breakpoints.up("md")),c=(0,w.Z)(l.breakpoints.up("lg")),p=(0,w.Z)(l.breakpoints.up("xl")),f=(0,a.UO)().albumId;(0,j.useEffect)((function(){return(0,s.WV)([]),(0,s._N)({}),(0,s.MD)(null),(0,s.eG)({}),function(){(0,s.WV)([]),(0,s._N)({}),(0,s.MD)(null),(0,s.eG)({})}}),[f]);var m=function(){var e=(0,g.Z)(Z().mark((function e(n,i){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t[i]||r();case 1:case"end":return e.stop()}}),e)})));return (),h=2;return p?h=5:c?h=4:d?h=3:u&&(h=2),(0,v.jsxs)("div",{"data-test":"drag-and-drop",style:{flex:1,position:"relative"},children:[(0,v.jsx)(S.Z,{}),(0,v.jsx)(I.Z,{children:function(e){var r=e.height,a=e.width;return a&&r?(0,v.jsx)(k.Z,{isItemLoaded:o,itemCount:t.length+Number(n),loadMoreItems:m,children:function(e){var n=e.onItemsRendered,o=e.ref;return(0,v.jsx)(A.Ym,{columnCount:h,columnWidth:Math.floor(a/h)-Math.floor(i/h),height:r,itemData:{items:t,zoom:h},ref:o,outerElementType:J,rowCount:Math.ceil(t.length/h),rowHeight:Math.floor(a/h)-Math.floor(i/h)+100,width:a,onItemsRendered:function(e){var t=e.overscanRowStartIndex*h,r=e.overscanRowStopIndex*h,i=e.visibleRowStartIndex*h,a=e.visibleRowStopIndex*h;n({overscanStartIndex:t,overscanStopIndex:r,visibleStartIndex:i,visibleStopIndex:a})},children:$})}}):(0,v.jsx)("div",{})}})]})}function ee(){var e,t,r,u=(0,s.at)(),d=(0,n.a)(l.Xsc,{variables:{sortBy:{desc:!1}}}),c=(null===(e=d.data)||void 0===e?void 0:e.albumsReadAll)||[],p=(0,i.groupBy)(c,(function(e){var t,r,n;return null!==(t=null!==(r=e.parentAlbumId)&&void 0!==r?r:null===u||void 0===u||null===(n=u.profile)||void 0===n?void 0:n.defaultAlbum)&&void 0!==t?t:"parent"})),f=(0,a.UO)().albumId,m=f||(null===u||void 0===u||null===(t=u.profile)||void 0===t?void 0:t.defaultAlbum),g=m?p[m]:[],x=null===g||void 0===g?void 0:g.filter((function(e){var t;return e.parentAlbumId&&e.id!==e.parentAlbumId&&e.id!==(null===u||void 0===u||null===(t=u.profile)||void 0===t?void 0:t.mobileAlbum)})),b=(0,i.sortBy)(x,"title"),Z=c.find((function(e){var t;return e&&e.id===(null===u||void 0===u||null===(t=u.profile)||void 0===t?void 0:t.mobileAlbum)}));!f&&Z&&b.unshift(Z);var y=c.find((function(e){var t;return e&&e.id===(null===u||void 0===u||null===(t=u.profile)||void 0===t?void 0:t.defaultAlbum)}));!f&&y&&b.unshift(y),b.unshift(null);var w=null,C=(0,i.debounce)((,500,{leading:!0});return null!==u&&void 0!==u&&null!==(r=u.profile)&&void 0!==r&&r.defaultAlbum?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(o.Z,{title:"Albums"}),f&&(0,v.jsx)(h,{}),(0,v.jsx)(K,{items:b,fetchMore:C,hasMore:!1})]}):null}}}]);