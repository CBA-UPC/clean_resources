"use strict";(self.webpackChunkphotobucket_web=self.webpackChunkphotobucket_web||[]).push([[5106],{62515:function(e,t,n){n.r(t),n.d(t,{default:function(){return Y}});var r=n(93433),o=n(1413),i=n(29439),a=n(61511),s=n(96420),l=n(72668),c=n(16031),u=n(47313),d=n(58467),v=n(2135),f=n(39837),h=n(28422),p=n(91345),g=n(76391),m=n(39437),y=n(32756),w=n(46171),Z=n(94849),x=n(4587),b=n(52442),M=n(11149),j=n(63336),k=n(9635),I=n(11482),S=n(46417);function B(){var e,t,n,v,f,g=(0,a.x)(),b=(0,M.Z)().settings,j=(0,p.at)(),k=(0,m.Z)().createAlert,I=(0,d.UO)(),B=I.albumId,D=void 0===B?null===j||void 0===j||null===(e=j.profile)||void 0===e?void 0:e.defaultAlbum:B,Y=I.mediaId,T={field:null===b||void 0===b||null===(t=b.sortBy)||void 0===t?void 0:t.field,desc:null===b||void 0===b||null===(n=b.sortBy)||void 0===n?void 0:n.desc},P=(0,s.t)(h.yMU,{onCompleted:function(e){var t=e.image;t&&g.cache.updateQuery({query:h.x4R,variables:{albumId:D,sortBy:T,pageSize:40}},(function(e){if(!e)return null;var n=null===e||void 0===e?void 0:e.getImagesFromAlbumAndSubAlbums;return{getImagesFromAlbumAndSubAlbums:(0,o.Z)((0,o.Z)({},n),{},{items:[].concat((0,r.Z)(n.items),[t])})}}))}}),C=(0,i.Z)(P,1)[0],E=(0,l.a)(h.x4R,{skip:!D,variables:{albumId:D,sortBy:T,pageSize:40},notifyOnNetworkStatusChange:!0,onError:),A=(null===(v=E.data)||void 0===v?void 0:v.getImagesFromAlbumAndSubAlbums.items)||[],F=null===(f=E.data)||void 0===f?void 0:f.getImagesFromAlbumAndSubAlbums.scrollPointer,V=A.find((),U=(0,u.useRef)(C);(0,u.useEffect)((function(){Y&&E.called&&!E.loading&&!V&&U.current({variables:{id:Y}})}),[E,Y,V]);var L=(0,c.debounce)((function(){F&&E.fetchMore({variables:{scrollPointer:F}})}),500,{leading:!0});return E.data||E.error?(0,c.isEmpty)(A)?(0,S.jsxs)("div",{style:{position:"relative"},children:[(0,S.jsx)(x.Z,{}),(0,S.jsx)(Z.Z,{defaultAlbum:D})]}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(w.Z,{items:A,fetchMore:L,hasMore:!!F,loading:!E.called||E.loading}),(!Y||V)&&(0,S.jsx)(y.Z,{items:A,fetchMore:L,hasMore:!!F})]}):null}function D(){switch((0,M.Z)().settings.groupedBy){case g.yI.Day:return(0,S.jsx)(j.Z,{});case g.yI.Month:return(0,S.jsx)(k.Z,{});case g.yI.Year:return(0,S.jsx)(I.Z,{});default:return(0,S.jsx)(B,{})}}function Y(){var e,t=(0,d.s0)(),n=(0,p.at)(),r=(0,M.Z)().settings,o=(0,v.lr)(),a="slideshow"===(0,i.Z)(o,1)[0].get("mode"),s=r.layout!==g.sH.Grid||r.groupedBy===g.yI.Year||r.groupedBy===g.yI.Month,l=r.groupedBy===g.yI.Year||r.groupedBy===g.yI.Month;return(0,u.useEffect)((function(){var e;a&&t("/u/".concat(null===n||void 0===n||null===(e=n.profile)||void 0===e?void 0:e.id,"/slideshow"))}),[a,t,null===n||void 0===n||null===(e=n.profile)||void 0===e?void 0:e.id]),(0,u.useEffect)((function(){(0,p.sE)({shouldPrivacyMenuHide:!0,isTitleMenuEditDisabled:!0,isCropModeHidden:s,isZoomMenuDisabled:l})}),[s,l]),(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(f.Z,{title:"My Bucket"}),(0,S.jsx)(b.Z,{}),(0,S.jsx)(D,{})]})}},9635:function(e,t,n){n.d(t,{Z:function(){return F}});var r=n(76035),o=n(58873),i=n(9289),a=n(9019),s=n(24193),l=n(61113),c=n(70816),u=n.n(c),d=n(47313),v=n(86948),f=n(58467),h=n(8566),p=n(91345),g=n(93433),m=n(15861),y=n(29439),w=n(64687),Z=n.n(w),x=n(61511),b=n(96420),M=n(24813),j=n(20201),k=n(3485),I=k.jU&&(I("pushState"),I("replaceState"));var S=B="function"===typeof Event,D=k.jU&&B?Y=n(18248),T=n(28422),P=n(11149),C=n(50693);var E=n(50378),A=n(46417);function F(){var e=(0,f.UO)().userId,t=function(){var e,t=(0,x.x)(),n=D(),r=new URLSearchParams(n.search).get("selected"),o=(0,P.Z)().settings,i=(0,d.useState)([]),a=(0,y.Z)(i,2),s=a[0],l=a[1],c=(0,d.useState)(),u=(0,y.Z)(c,2),v=u[0],f=u[1],h=(0,d.useState)(),w=(0,y.Z)(h,2),k=w[0],I=w[1],S=(0,j.Z)(),B=(0,M.Z)(S.breakpoints.down("md"))?C.OX-3:C.OX,E=(0,d.useMemo)((,[o.sortBy]),A=(0,b.t)(T.nQQ,{fetchPolicy:"no-cache",onCompleted:),F=(0,y.Z)(A,2),V=F[0],U=F[1],L=(0,d.useRef)(V);(0,d.useEffect)((function(){var e,t,n;null!==(e=U.data)&&void 0!==e&&e.monthsView&&(l(null===(t=U.data)||void 0===t?void 0:t.monthsView.items),I(null===(n=U.data)||void 0===n?void 0:n.monthsView.scrollPointer))}),[null===(e=U.data)||void 0===e?void 0:e.monthsView]),(0,d.useEffect)((function(){if(U.error){var e={id:(0,Y.Z)(),message:"There was a problem fetching your data. Please try again later.",severity:"error"};(0,p.sh)([e])}}),[U.error]);var O=(0,d.useCallback)((0,m.Z)(Z().mark((function e(){var t,n,r,o;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!v||!U.fetchMore){e.next=10;break}return e.next=4,U.fetchMore({variables:{topDays:B,scroll:{scrollPointer:v,direction:T.IeD.Up},pagination:E}});case 4:t=e.sent,n=t.data.monthsView,r=n.items,o=n.scrollPointer,l((function(e){return[].concat((0,g.Z)(r),(0,g.Z)(e))})),f(o);case 10:e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(0),new Error("Something was not right. ");case 15:case"end":return e.stop()}}),e,null,[[0,12]])}))),[v,U,B,E]),H=(0,d.useCallback)((0,m.Z)(Z().mark((function e(){var t,n,r,o;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!k||!U.fetchMore){e.next=10;break}return e.next=4,U.fetchMore({variables:{topDays:B,scroll:{scrollPointer:k,direction:T.IeD.Down},pagination:E}});case 4:t=e.sent,n=t.data.monthsView,r=n.items,o=n.scrollPointer,l((function(e){return[].concat((0,g.Z)(e),(0,g.Z)(r))})),I(o);case 10:e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(0),new Error("Something was not right. ");case 15:case"end":return e.stop()}}),e,null,[[0,12]])}))),[k,U,E,B]),R=(0,d.useCallback)((function(e,t){if(e){var n=o.sortBy.field,r={topDays:B,scroll:{scrollPointer:e,direction:t},pagination:{desc:o.sortBy.desc,pageSize:C.IV,sortingField:n}};L.current({variables:r})}}),[L,o.sortBy,B]),z=(0,d.useCallback)((function(){var e=o.sortBy.field,t={topDays:B,pagination:{desc:o.sortBy.desc,pageSize:C.IV,sortingField:e}};L.current({variables:t})}),[L,o.sortBy,B]),q=(0,d.useCallback)(function(){var e=(0,m.Z)(Z().mark((function e(n){var r,i,a,s,l;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.sortBy.field,s={imageId:n,sortingField:a},e.next=4,t.query({query:T.MYz,variables:s});case 4:l=e.sent,R(null===(r=l.data)||void 0===r?void 0:r.monthsScrollPointer,T.IeD.Down),f(null===(i=l.data)||void 0===i?void 0:i.monthsScrollPointer);case 7:case"end":return e.stop()}}),e)})));return (),[t,o.sortBy.field,f,R]);return(0,d.useEffect)((,[o,r,z,R,q]),{items:s,loading:U.loading,nextToken:k,prevToken:v,setPrevToken:f,setNextToken:I,fetchBelow:H,fetchAbove:O}}(),n=t.items,c=t.nextToken,w=t.prevToken,k=t.fetchBelow,I=t.fetchAbove,S=t.loading,B=(0,d.useRef)(0);return n?(0,A.jsx)("div",{style:{flex:1,position:"relative",overflowY:"scroll",overflowX:"hidden",padding:14},onScroll:function(e){var t=e.currentTarget,n=t.scrollTop,r=t.scrollHeight,o=t.offsetHeight;S||n!==r-o||k(),n>100&&n>B.current?(0,p.MD)("down"):(0,p.MD)("up"),B.current=e.currentTarget.scrollTop},children:(0,A.jsx)(h.Z,{children:function(t){var d=t.height,f=t.width;return(0,A.jsxs)("div",{style:{height:d,width:f,position:"relative"},id:"scrollable-gallery",children:[(0,A.jsx)(i.Z,{}),w&&(0,A.jsx)(a.ZP,{container:!0,justifyContent:"center",children:(0,A.jsxs)(s.Z,{color:"primary",variant:"outlined",onClick:I,children:["Load more ",(0,A.jsx)(r.Z,{})]})}),(0,A.jsx)(v.Z,{dataLength:n.length,loader:(0,A.jsx)(a.ZP,{container:!0,justifyContent:"center",children:(0,A.jsx)(l.Z,{variant:"h6",sx:{textAlign:"center"},children:"Loading..."})}),next:k,hasMore:Boolean(c),scrollableTarget:"main",children:n.map((function(t){if(t){var n=t.previewStats.map((function(e){return{localDate:u()([t.localDate,null===e||void 0===e?void 0:e.dayOfMonth.padStart(2,"0")].join("-")).format("YYYY-MM-DD"),dayOfMonth:null===e||void 0===e?void 0:e.dayOfMonth,mediaCount:null===e||void 0===e?void 0:e.mediaCount,imageUrl:null===e||void 0===e?void 0:e.previewImage.originalImage.url,imageId:null===e||void 0===e?void 0:e.previewImage.imageId}}));return(0,A.jsx)(E.Z,{date:t.localDate,items:n,displayMoreStats:t.viewMoreStats,config:{dateFormat:"MMMM YYYY",previewTitleFormat:"DD MMM"},groupLink:"/u/".concat(e,"/d/").concat(u()(null===t||void 0===t?void 0:t.localDate).format("YYYY/MM")),fallbackGroupLink:"/u/".concat(e)},t.localDate)}return null}))}),c&&(0,A.jsx)(a.ZP,{container:!0,justifyContent:"center",sx:{padding:5},children:(0,A.jsxs)(s.Z,{color:"primary",variant:"outlined",onClick:k,children:["Load More ",(0,A.jsx)(o.Z,{})]})})]})}})}):null}},11482:function(e,t,n){n.d(t,{Z:);var r=n(1413),o=n(58873),i=n(9289),a=n(9019),s=n(24193),l=n(16031),c=n(70816),u=n.n(c),d=n(47313),v=n(58467),f=n(8566),h=n(28422),p=n(91345),g=n(73184),m=n(11149),y=n(93433),w=n(15861),Z=n(29439),x=n(64687),b=n.n(x),M=n(72668),j=n(24813),k=n(20201),I=n(18248),S=n(25258),B=n(50693);var D=n(50378),Y=n(46417);function T(){var e=(0,m.Z)(),t=e.settings,n=e.saveGallerySettings,c=(0,d.useMemo)((,[]),x=(0,v.UO)().userId,T=function(){var e,t=(0,m.Z)().settings,n=(0,k.Z)(),r=(0,j.Z)(n.breakpoints.down("md"))?B.cB-3:B.cB,o={pageSize:B.IV,desc:t.sortBy.desc,sortingField:t.sortBy.field},i={topMonths:r,pagination:o},a=(0,d.useState)([]),s=(0,Z.Z)(a,2),l=s[0],c=s[1],u=(0,d.useState)(),v=(0,Z.Z)(u,2),f=v[0],g=v[1],x=(0,M.a)(h.TDc,{variables:i,fetchPolicy:"no-cache"});(0,d.useEffect)((function(){var e;null!==(e=x.data)&&void 0!==e&&e.yearsView&&(c(x.data.yearsView.items),g(x.data.yearsView.scrollPointer))}),[null===(e=x.data)||void 0===e?void 0:e.yearsView]),(0,d.useEffect)((function(){if(x.error){var e={id:(0,I.Z)(),message:"There was a problem fetching your data. Please try again later.",severity:"error"};(0,p.sh)([e])}}),[x.error]);var D=function(){var e=(0,w.Z)(b().mark((function e(){var t,n,i,a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!f||!x.fetchMore){e.next=10;break}return e.next=4,x.fetchMore({variables:{topMonths:r,scrollPointer:f,pagination:o}});case 4:t=e.sent,n=t.data.yearsView,i=n.items,a=n.scrollPointer,c((),g(a);case 10:e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(0),new Error("Something was not right. ");case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return ();return(0,d.useEffect)((,[t.sortBy]),{items:l,loading:x.loading,nextToken:f,fetchMore:D}}(),P=T.items,C=T.nextToken,E=T.fetchMore,A=T.loading;(0,d.useEffect)((function(){c.includes(t.sortBy.field)||n((0,r.Z)((0,r.Z)({},t),{},{sortBy:g.n.sortBy}))}),[c,t,n]);var F=(0,d.useRef)(0);return(0,Y.jsx)("div",{style:{flex:1,position:"relative",overflowY:"scroll",overflowX:"hidden",padding:14},onScroll:function(e){var t=e.currentTarget,n=t.scrollTop,r=t.scrollHeight,o=t.offsetHeight;A||n!==r-o||E(),n>100&&n>F.current?(0,p.MD)("down"):(0,p.MD)("up"),F.current=e.currentTarget.scrollTop},children:(0,Y.jsx)(f.Z,{children:function(e){var t=e.height,n=e.width;return(0,Y.jsxs)("div",{style:{height:t,width:n,position:"relative"},id:"scrollable-gallery",children:[(0,Y.jsx)(i.Z,{}),P.map((function(e){var t,n=(0,l.map)(null===e||void 0===e?void 0:e.previewStats,(function(t){return{localDate:[null===e||void 0===e?void 0:e.year,null===t||void 0===t?void 0:t.month].join("-"),mediaCount:null===t||void 0===t?void 0:t.mediaCount,imageUrl:null===t||void 0===t?void 0:t.previewImage.originalImage.url,imageId:null===t||void 0===t?void 0:t.previewImage.imageId}}))||[],r=(0,l.orderBy)(n,"localDate","desc");return(0,Y.jsx)(D.Z,{date:u()(null===e||void 0===e?void 0:e.year).format("YYYY"),items:r,config:{dateFormat:"YYYY",previewTitleFormat:"MMMM"},groupLink:"/u/".concat(x,"/v/month?selected=").concat(null===e||void 0===e||null===(t=e.previewStats[0])||void 0===t?void 0:t.previewImage.imageId),fallbackGroupLink:"/u/".concat(x)},null===e||void 0===e?void 0:e.year)})),C&&(0,Y.jsx)(a.ZP,{container:!0,justifyContent:"center",sx:{padding:5},children:(0,Y.jsxs)(s.Z,{color:"primary",variant:"outlined",onClick:E,children:["Load More ",(0,Y.jsx)(o.Z,{})]})})]})}})})}}}]);