"use strict";(self.webpackChunkWPS_Drive=self.webpackChunkWPS_Drive||[]).push([[3341],{73341:function(t,e,i){i.r(e),i.d(e,{default:);var n=i(37311),o=i(2406),a=i.n(o),c=i(47189),r=i(85476),s=i(45821),l=i(18487),u={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",[t._v(t._s(t.lang_txt0))]),t._v(" "),i("div",{staticClass:"k-dialog-link-jump-tip-footer"},[i("KButton",{on:{click:},[t._v(t._s(t.lang_txt1))]),t._v(" "),i("KButton",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:t.onConfirm}},[t._v(t._s(t.lang_txt2))])],1)])},staticRenderFns:[],name:"KDialogLinkJumpTip",componentName:"KDialogLinkJumpTip",components:{KButton:i(62414).Z},props:{onOk:Function},data:function(){return{lang_txt0:(0,s.t)("logic.DialogLinkJumpTip.txt0"),lang_txt1:(0,s.t)("logic.DialogLinkJumpTip.txt1"),lang_txt2:(0,s.t)("logic.DialogLinkJumpTip.txt2")}},methods:{onConfirm:},p=(0,l.Z)({entry:u,pages:[{title:(0,s.t)("logic.DialogLinkJumpTip.txt3"),className:"k-dialog-link-jump-tip",width:"400px",body:u,footer:null,closeOnClickModal:!1}]}),d=i(16548),g=i(423),m=i(26743),h=i(16569),f=i.n(h),v=i(1059),k=i.n(v),_=i(30553),x=/\[([^[\]]+)\]\(link=([^()]+)\)/g,N={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"notice",staticClass:"k-team-top-area-notice"},[i("section",{directives:[{name:"show",rawName:"v-show",value:!t.loading&&!t.originNotice&&!t.editing,expression:"!loading && !originNotice && !editing"}],staticClass:"k-team-top-area-notice-guide"},[t.useNewLayout?[i("span",[t._v(t._s(t.lang_tips))])]:[t._v("\n      "+t._s(t.lang_click)+"\n      "),i("span",{staticClass:"k-team-top-area-notice-guide-add",on:{click:t.edit}},[t._v(t._s(t.lang_add))]),t._v("\n      "+t._s(t.lang_txt0)+"\n      "),i("span",{staticClass:"k-team-top-area-notice-guide-demo",on:{click:t.onExample}},[t._v(t._s(t.lang_txt1))])]],2),t._v(" "),t.showView?i("section",{staticClass:"k-team-top-area-notice-show"},[i("div",{staticClass:"k-team-top-area-notice-show-content"},[t._v(t._s(t.originNotice))])]):t._e(),t._v(" "),t.useNewLayout?i("section",{directives:[{name:"show",rawName:"v-show",value:!t.loading&&t.editing,expression:"!loading && editing"}],staticClass:"k-team-top-area-notice-new-edit"},[i("kd-input",{ref:"textinput",attrs:{type:"textarea",maxlength:t.maxlength,placeholder:t.lang_placeHolder},on:{focus:function(e){return t.updateFocus(!0)},blur:function(e){return t.updateFocus(!1)}},nativeOn:{keydown:function(e){return t.onKeydown(e)}},model:{value:t.editNotice,callback:function(e){t.editNotice=e},expression:"editNotice"}}),t._v(" "),i("div",{staticClass:"k-team-top-area-notice-new-edit-footer"},[i("kd-button",{attrs:{type:"secondary"},on:{click:t.unedit}},[t._v(t._s(t.lang_cancel))]),t._v(" "),i("kd-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v(t._s(t.lang_ok))])],1)],1):i("section",{directives:[{name:"show",rawName:"v-show",value:!t.loading&&t.editing,expression:"!loading && editing"}],class:{"k-team-top-area-notice-edit":!0,"k-team-top-area-notice-edit-focus":t.focus}},[i("el-input",{ref:"textinput",staticClass:"k-team-top-area-notice-edit-input",attrs:{type:"textarea",autofocus:!0,maxlength:t.maxlength,placeholder:t.lang_placeHolder},on:{focus:function(e){return t.updateFocus(!0)},blur:,nativeOn:{keydown:,model:{value:t.editNotice,callback:expression:"editNotice"}}),t._v(" "),i("div",{staticClass:"k-team-top-area-notice-edit-footer"},[i("el-button",{staticClass:"cancel",attrs:{plain:""},on:{click:t.unedit}},[t._v(t._s(t.lang_cancel))]),t._v(" "),i("el-button",{staticClass:"confirm",attrs:{type:"primary"},on:{click:t.submit}},[t._v(t._s(t.lang_ok))])],1)],1)])},staticRenderFns:[],name:"KTeamTopAreaNotice",componentName:"KTeamTopAreaNotice",components:{KdButton:f(),KdInput:k()},props:{groupId:String,groupType:String,companyId:String,teamRole:String,useNewLayout:{type:Boolean,default:!1}},data:function(){return{lang_click:(0,s.t)("logic.TeamTopAreaNotice.click"),lang_add:(0,s.t)("logic.TeamTopAreaNotice.add"),lang_txt0:(0,s.t)("logic.TeamTopAreaNotice.txt0"),lang_txt1:(0,s.t)("logic.TeamTopAreaNotice.txt1"),lang_tips:(0,s.t)("logic.TeamTopAreaNotice.tips"),lang_placeHolder:this.useNewLayout?(0,s.t)("logic.TeamTopAreaNotice.newPlaceHolder"):(0,s.t)("logic.TeamTopAreaNotice.placeHolder"),lang_cancel:(0,s.t)("logic.TeamTopAreaNotice.cancel"),lang_ok:(0,s.t)("logic.TeamTopAreaNotice.ok"),editing:!1,focus:!0,maxlength:1024,submited:!1,originNotice:"",editNotice:"",loading:!1}},computed:{showView:,watch:{editing:function(t){t&&(this.editNotice=this.originNotice.replace(x,(function(t,e,i){try{return atob(i),e}catch(e){return t}})))},groupId:showView:,mounted:function(){var t=this;this.fetchNotice(),this.$on("edit",this.edit),this.$on("unedit",this.unedit),this.$refs.notice.addEventListener("click",(function(e){var i=e.target;if("k-team-top-area-notice-link"===i.className){var n=i.getAttribute("data-link");t.clickLink(n)}}))},methods:{fetchNotice:function(){var t=this;return(0,n.Z)(a().mark((function e(){var i,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.next=3,(0,c.Rxm)(t.groupId).catch(();case 3:i=e.sent,n=i.content,t.originNotice=n,t.loading=!1;case 7:case"end":return e.stop()}}),e)})))()},edit:function(){this.editing=!0,this.$nextTick((function(){var t=this.$refs.textinput&&this.$refs.textinput.$refs.textarea;t&&t.focus&&t.focus(),t&&t.setSelectionRange&&t.setSelectionRange(this.editNotice.length,this.editNotice.length)}))},unedit:onExample:updateFocus:submit:function(){var t=this;return(0,n.Z)(a().mark((function e(){var i,n,o,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.validate()){e.next=4;break}return e.abrupt("return");case 4:return t.submited=!1,i=t.originNotice.replace(x,"$1"),n=t.editNotice,o=n.replace(i,t.originNotice),e.next=10,(0,c.RzN)(t.groupId,o);case 10:s=e.sent,t.editing=!1,t.submited=!0,t.originNotice=s.content,t.$emit("updateNotice",s),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),(0,r._N)(e.t0);case 20:case"end":return e.stop()}}),e,null,[[0,17]])})))()},validate:function(){return!(this.editNotice.length>this.maxlength)||(d.Z.error((0,s.t)("logic.TeamTopAreaNotice.maxLengthError",[this.maxlength])),!1)},onKeydown:function(t){var e=t.keyCode,i=t.which,n=t.charCode,o=t.ctrlKey,a=t.shiftKey,c=t.altKey;if(e=e||i||n,(o||a)&&13===e)return this.insertContent("\n"),t.preventDefault(),void t.stopPropagation();if(!(13!==e||o||a||c))return this.submit(),t.preventDefault(),void t.stopPropagation();if(o&&65===e){var r=this.$refs.textinput&&this.$refs.textinput.$refs.textarea;return r&&r.select&&r.select(),t.preventDefault(),void t.stopPropagation()}},insertContent:function(t){var e,i=this.$refs.textinput&&this.$refs.textinput.$refs.textarea,n=i&&i.selectionStart||0,o=i&&i.selectionEnd||0,a=this.editNotice&&this.editNotice.split("")||[],c=this.editNotice.substr(0,n);a.splice(n,o-n,t),this.editNotice=a.join(""),e=n+t.length,this.$nextTick((function(){i.setSelectionRange(e,e);var t=i.cols,n=i.clientHeight/i.rows,o=c.split("\n"),a=o.length+o.reduce((function(e,i){return e+Math.floor(i.length/t)}),1);i.scrollTop=n*a}))},clickLink:function(t){var e=this,i=["wps.cn","kdocs.cn"];(0,m.isKaeRelease)("oem")&&(i=[(0,g.XF)("kdocs")]);var n=new RegExp("^http(s?):\\/\\/(([\\w.]+\\.)?(".concat(i.join("|"),"))"));!t.match(/(https?|ftp|file):\/\/[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]/)||t.match(n)?this.$emit("callInterior",{link:t}):p.show({onOk:)},viewNoticeFormatter:function(){var t=document.querySelector(".k-team-top-area-notice-show-content"),e=t.innerHTML;e=e.replace(/(\[([^[\]]+)\]\(link=([^()]+)\))|((https?|ftp|file):\/\/[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|])/g,(function(t,e,i,n){if(t.match(x)){try{n=atob(n)}catch(e){return t}return'<span class="k-team-top-area-notice-link" data-link="'.concat(n,'">').concat(i,"</span>")}return n=decodeURIComponent(escape(t)),'<span class="k-team-top-area-notice-link" data-link="'.concat(n,'">').concat(n,"</span>")})),t.innerHTML=e}}},y="business_grouptop",w={onExample:function(){return{event:y,params:{operate:"click_example",companyid:this.$vm.companyId,groupid:this.$vm.groupId,group_type:this.$vm.groupType}}},submit:function(){return{event:y,params:{operate:"release_notice_complete",companyid:this.$vm.companyId,groupid:this.$vm.groupId,group_type:this.$vm.groupType}}},clickLink:function(t){return{event:y,params:{operate:"click_link",companyid:this.$vm.companyId,content:t,groupid:this.$vm.groupId,group_type:this.$vm.groupType}}}},T={KTeamTopAreaNotice:[{event:y,trigger:"click",el:".k-team-top-area-notice-guide-add",listener:,{event:"group_inform",trigger:"mounted",listener:function(t){var e=this,i=t.submit;t.submit=function(){var n={operate:"inform_notice",position:"inform",companyid:t.companyId||0,groupid:t.groupId,group_type:t.groupType,role:t.teamRole};n&&e.track("group_inform",n),i.apply(this,arguments)}}},(0,_.Z)(w)]};N.install=N.dw=T;var $=N}}]);
