/*! For license information please see pricing-context-module.min.js.LICENSE.txt */
(()=>{var t={956:(t,e,n)=>{"use strict";var i=n(318),r=i(n(319)),o=i(n(713));r u=n(171),c=n(506);!function(){var e,n="PCXT",i=new RegExp("(^| )".concat(n,"=([^;]+)")),o="PCXT-V3-ModuleInitialized",s="PCXT-V3-ContextChanged",h="https://pricing-context-service.products.vpsvc.com",p={},l=["vpsvc","vistaprint","promotique"];async function f(t,e){var n,i;return await(n=e.timeout,i=fetch(t,a({},e)),new Promise(())}p.version="3.11.0";var d=function(){try{var t=new u.WebAuth;return{authorization:t.getAuthorizationHeader(),shopperId:t.getCanonicalId()}}catch(t){return{}}},g=function(){return window&&window.location&&window.location.href?"pcxt-".concat(window.location.href.substr(0,100)):"pcxt"},y=function(t){var e=new Date;return new Date(e.getTime()+6e4*t)},m=v=function(t,e){if("undefined"!=typeof document){var n=new CustomEvent(t,{detail:e});document.dispatchEvent(n)}},w=function(t){return btoa(JSON.stringify(t)).replace(/\+/g,"-").replace(/=/g,"").replace(/\//g,"_")},b=function(t){var e=t.replace(/-/g,"+").replace(/_/g,"/");return JSON.parse(atob(e))},_=function(t){var i=new Date,r=new Date(i.getTime()+6048e5),o=w(t),s="".concat(n,"=").concat(o,";expires=").concat(r.toUTCString(),";SameSite=Strict;path=/");if("undefined"!=typeof document&&void 0!==document.cookie){var a=function(){if("undefined"==typeof document||void 0===document.cookie)return"";for(var t=window.location.hostname,e=0;e<l.length;e+=1){var n=t.lastIndexOf(l[e]);if(n>=0)return t.slice(n)}return t}();s+=";domain=".concat(a),document.cookie=s}e=s},T=function(){var t="undefined"!=typeof document&&void 0!==document.cookie&&""!==document.cookie&&document.cookie.match(i)?document.cookie:e;try{var n=t.match(i);return n?n[2]:null}catch(t){return null}},k=function(t){try{var e=c.getAllTreatments();return t?(0,r.default)(new Set([].concat((0,r.default)(t),(0,r.default)(e)))):e}catch(t){console.log("treatment initialization failed on: ".concat(t.message))}return t},I=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=T();if(!n)throw new Error("Pricing context module not initialized.");try{var i=b(n);if(t){var r=Object.keys(i).filter(().filter(().reduce((function(t,e){return t[e]=i[e],t}),{});i=r}if(e){var o=["version","vatInclusive","expiresAt","developmentMode","shopperId"],s=Object.keys(i).filter(().reduce((,{});i=s}return i.customerGroups=k(i.customerGroups),i}catch(t){throw new Error("Failed to decode pricing context string.")}},C=async function(t){var e,n=g(),i="".concat(h,"/v1/pricingContext/").concat(t.merchantId,"/").concat(t.market,"/").concat(t.shopperInfo.shopperId),r="?developmentMode=".concat(t.developmentMode,"&Requestor=").concat(n);r+=t.effectiveDateTime?(e=t.effectiveDateTime,/\d{4}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[1-2]\d|3[0-1])T(?:[0-1]\d|2[0-3]):[0-5]\d:[0-5]\d(?:\.\d+|)(?:Z|(?:\+|\-)(?:\d{2}):?(?:\d{2}))/.test(e)?"&EffectiveDateTime=".concat(t.effectiveDateTime):"&EffectiveDateTime=clear"):"";var o=await f(i+encodeURI(r),{timeout:1500,headers:{"Content-Type":"application/json",Authorization:t.shopperInfo.authorization}});if(o.status>=400&&o.status<600)throw new Error("Pricing Context Service returned ".concat(o.status));return await o.json()},O=function(t,e){return t.couponCode?t.couponCode.toUpperCase()===e.toUpperCase():!e},E=S=async function(t){var e=I();if(!e.couponCode||e.couponCode.toUpperCase()!==t.couponCode.toUpperCase())try{var n=d();if(!E(n))throw new Error("Missing shopper info");var i={merchantId:e.merchantId,market:e.market,shopperInfo:n,couponCode:t.couponCode,developmentMode:e.developmentMode},r=await async function(t){var e=g(),n="".concat(h,"/v1/pricingContext/").concat(t.merchantId,"/").concat(t.market,"/").concat(t.shopperInfo.shopperId,"/applyCoupon"),i="?developmentMode=".concat(t.developmentMode,"&Requestor=").concat(e),r=await f(n+encodeURI(i),{method:"POST",body:JSON.stringify({couponCode:t.couponCode}),timeout:5e3,headers:{"Content-Type":"application/json",Authorization:t.shopperInfo.authorization}});if(422!==r.status&&r.status>=400&&r.status<600)throw new Error("Pricing Context Service returned ".concat(r.status));return await r.json()}(i),o=a(a({},r.currentPricingContext),{},{vatInclusive:e.vatInclusive,shopperId:n.shopperId});return _(o),v("PCXT-V3-CouponCodeChanged",o),v(s,o),{couponApplied:O(o,t.couponCode),validationErrors:r.validationErrors||[],couponInfoLinks:r.couponInfoLinks||{},currentPricingContext:o}}catch(t){console.info("Retaining existing context")}return{couponApplied:O(e,t.couponCode),validationErrors:["UnableToValidate"],couponInfoLinks:{},currentPricingContext:e}},A=function(){var t={};if("undefined"==typeof window||void 0===window.location||!window.location.search)return t;var e=new URLSearchParams(window.location.search.toUpperCase()),n=e.get("PCXTVATINCLUSIVE");n&&(t.vatInclusive="TRUE"===n);var i=e.get("PCXTEFFECTIVEDATETIME");return i&&(t.effectiveDateTime=i),t},U=async function(t,e){if(void 0!==t&&void 0!==e){var n=e.toUpperCase(),i=t.toUpperCase();if("VISTAPRINT"===n&&"FR"===i){try{if(window&&window.location&&window.location.host&&window.location.pathname&&window.location.host.includes(".vistaprint.")){var r=encodeURIComponent(window.location.pathname),o="/static/merch/default-tax-inclusivity.prod/v1/".concat(n,"/").concat(i,"/").concat(r),s=await f(o,{timeout:500});if(!0===(await s.json()).included)return!0}}catch(t){console.log("error fetching specific default tax inclusivity",t)}return!1}if("SG"===i&&(new Date).toISOString()>="2023-04-03T14:00:00.000Z")return!0;if("VISTAPRINT"===n||"VISTAPRINT-FASHION-MASKS"===n||"VISTAPRINT-PAYPAL"===n)switch(i){case"US":case"CA":case"NZ":case"SG":return!1;default:return!0}else if("PROMOTIQUE"===n)switch(i){case"DE":case"AU":case"IN":return!0;default:return!1}return!1}},R=async function(t,e,n){return void 0!==n.vatInclusive?n.vatInclusive:void 0!==t.vatInclusive?t.vatInclusive:void 0===e.vatInclusive?U(e.market,e.merchantId):e.vatInclusive},x=async function(){var t,e=A();try{t=I()}catch(t){return}var n=d(),i=n&&n.shopperId?n.shopperId:"";if(E(n)&&void 0!==t&&void 0!==t.merchantId&&void 0!==t.market){var r,o;try{r=await C({merchantId:t.merchantId,market:t.market,shopperInfo:n,effectiveDateTime:e.effectiveDateTime,developmentMode:t.developmentMode})}catch(t){return}r.customerGroups=k(r.customerGroups),r.vatInclusive=await R(t,r,e),r.shopperId=i;try{o=I()}catch(t){return}t.merchantId===o.merchantId&&t.market===o.market&&(_(r),v(s,r))}};p.getPricingContext=p.getEncodedContextString=function(){return w(I(!0,!0))},p.getContextAsQueryString=function(t){return function(t){for(var e=I(!0,!0),n=Object.keys(e),i=n.filter(().map(().join("&"),r=n.filter((),o=function(){var t=r[s],n=e[t].map(().join("&");i+="&".concat(n)},s=0;s<r.length;s+=1)o();return t?encodeURI(i):i}(t)},p.setEffectiveDateTime=async function(t){if(!("string"==typeof t||t instanceof String))throw new Error("Must pass a string for parameter 'effectiveDateTime'");await async function(t){var e=I();if(t!==e.effectiveDateTime)try{var n=d();if(!E(n))throw new Error("Missing shopper info to call for remote context");var i=a(a({},await C({merchantId:e.merchantId,market:e.market,shopperInfo:n,effectiveDateTime:t,developmentMode:e.developmentMode})),{},{vatInclusive:e.vatInclusive,shopperId:n.shopperId});_(i),v(s,i),i.effectiveDateTime&&i.effectiveDateTime!==e.effectiveDateTime&&v("PCXT-V3-EffectiveDateTimeChanged",i)}catch(t){return void console.info("Retaining existing context")}}(t.toUpperCase())},p.setCouponCode=async function(t){if("string"==typeof t||t instanceof String)return await S({couponCode:t});throw new Error("Must pass a string for parameter 'couponCode'")},p.getCouponCode=function(){return I().couponCode},p.setVatInclusive=function(t){var e,n,i;if("boolean"==typeof t||t instanceof Boolean)e=t;else{if(void 0===t||""===t||"TRUE"!==t.toUpperCase()&&"FALSE"!==t.toUpperCase())throw new Error("Must pass a boolean for parameter 'isInclusive'");e="TRUE"===t.toUpperCase()}n=e,(i=I()).vatInclusive=n,_(i),v("PCXT-V3-VatInclusivityChanged",i),v(s,i)},p.isVatInclusive=p.isDefaultTaxInclusive=p.orderPlaced=async function(){var t;(t=I()).couponCode=void 0,t.expiresAt=y(5),_(t),await S("")},p.isInitialized=function(t,e,n){var i,r=d(),o=A();try{i=I()}catch(t){i={version:0,merchantId:void 0,market:void 0,couponCode:void 0,effectiveDateTime:void 0,customerGroups:void 0,vatInclusive:void 0,expiresAt:void 0,developmentMode:void 0,shopperId:void 0}}return t&&e&&void 0!==n?void 0!==i.shopperId&&(!r.shopperId||r.shopperId===i.shopperId)&&i.developmentMode===n&&void 0!==i.expiresAt&&i.expiresAt>m()&&i.merchantId===t.toUpperCase()&&i.market===e.toUpperCase()&&(!o.effectiveDateTime||i.effectiveDateTime===o.effectiveDateTime):!(void 0===i.merchantId||void 0===i.market||void 0===i.vatInclusive)},p.init=async function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!("string"==typeof t||t instanceof String)||""===t||"undefined"===t.toLowerCase())throw new Error("Must pass a non-empty, defined string for parameter 'merchantId'");if(!("string"==typeof e||e instanceof String)||""===e||"undefined"===e.toLowerCase())throw new Error("Must pass a non-empty, defined string for parameter 'market'");var i,r=A();try{i=I()}catch(t){i={version:0,merchantId:void 0,market:void 0,couponCode:void 0,effectiveDateTime:void 0,customerGroups:void 0,vatInclusive:void 0,expiresAt:void 0,developmentMode:void 0,shopperId:void 0}}var s,a=d(),u=a&&a.shopperId?a.shopperId:"",c=i.developmentMode!==n||void 0===i.expiresAt||i.expiresAt<=m()||i.merchantId!==t.toUpperCase()||i.market!==e.toUpperCase()||r.effectiveDateTime&&i.effectiveDateTime!==r.effectiveDateTime,h=""!==u&&i.shopperId!==u;if(c||h)try{if(!E(a))throw new Error("Missing shopper info to call for remote context");s=await C({merchantId:t,market:e,shopperInfo:a,effectiveDateTime:r.effectiveDateTime,developmentMode:n})}catch(r){(s=i).merchantId=t.toUpperCase(),s.market=e.toUpperCase(),s.expiresAt=y(1),s.developmentMode=n}else s=i;return s.customerGroups=k(s.customerGroups),s.vatInclusive=await R(i,s,r),s.shopperId=u,_(s),v(o,s),s},E(d())?x():"undefined"!=typeof window&&window.addEventListener("userIdentity",(),"undefined"!=typeof document?(document.pcxtV3=p,v("PCXT-V3-ScriptLoaded",{version:p.version})):t.exports=p}()},228:646:713:318:860:206:319:379:171:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=(i={},"undefined"!=typeof window&&(i=window),i.vp=i.vp||{},i.vp.auth=i.vp.auth||{},i.vp.auth.deps=i.vp.auth.deps||null,i.vp.auth.cache=i.vp.auth.cache||null,i),o=function(){return r.vp.auth.deps},s=function(t){t&&(r.vp.auth.deps=t)},a=function(){return null!==r.vp.auth.deps},u=c=h=function p(t){var e=t.split(".");try{var n=e[1];return JSON.parse(atob(n))}catch(t){return null}}var l={parse:p,getCanonicalId:function(t){return t["https://claims.cimpress.io/canonical_id"]},getRecentAnonymousIds:isValidToken:function(t){return p(t).exp-Math.round(Date.now()/1e3)>7200}},f="a00e1368c32c471cb7e2ba0defd99a1a",d="h7mue3Z1WYL2KW1DHv0dO0qbqd29aG61",g="cimpress.auth0.com"; w=["vistaprint","vista"],b=function(t){if(!t)return null;for(var e=t.split(".").slice(-3),n=e.length-1;n>=0;n-=1){var i=e[n];if(w.indexOf(i)>=0)return e.slice(n).join(".")}return t};function _(t,e,n){var i=b(window.location.hostname);document.cookie=t+"="+e+";expires="+n+";path=/;domain="+i}function T(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=null;try{return document.cookie.split(";").every((function(e){var i=m(e.trim().split("=")),r=i[0],o=i.slice(1);return r!==t||(n=o.join("="),!1)})),n&&e?JSON.parse(n):n}catch(e){return console.error("Unable to parse cookie value for - ".concat(t)),null}}var k={setPresumedLoginState:function(){var t=new Date;t.setTime(t.getTime()+2592e6),_("_pls",1,t.toUTCString())},deletePresumedLoginState:function(){_("_pls","","Thu, 01 Jan 1970 00:00:00 UTC")},getPresumedLoginState:function(){return T("_pls")},setAnonymousIdentityState:function(t,e,n){var i=new Date;i.setTime(i.getTime()+864e8);var r=i.toUTCString(),o={id:t,nonce:e,anonKey:n};_("anon",JSON.stringify(o),r)},getAnonymousIdentityState:function(){return T("anon")},deleteAnonymousIdentityState:function(){_("anon","","Thu, 01 Jan 1970 00:00:00 UTC")},getOptimizelyId:function(){return T("optimizelyEndUserId",!1)},setAuthCookie:function(t){var e=new Date;e.setTime(e.getTime()+2592e6);var n=e.toUTCString();_("vpauth",JSON.stringify(t),n)},getAuthCookie:function(){return T("vpauth")},deleteAuthCookie:function(){_("vpauth","","Thu, 01 Jan 1970 00:00:00 UTC")},getCookie:T,setSessionCookie:function(t){var e=new Date;e.setTime(e.getTime()+2592e6),_("vpsession",t,e.toUTCString())},getSessionCookie:deleteSessionCookie:function(){_("vpsession","","Thu, 01 Jan 1970 00:00:00 UTC")},setConfigCookie:function(t,e){var n=new Date;n.setTime(n.getTime()+2592e6);var i=n.toUTCString();_("vpconfig",JSON.stringify({clientId:t,domain:e}),i)},getConfigCookie:deleteConfigCookie:,I="https://sessions.cimpress.io/v1/sessions";function C(t){var e=k.getSessionCookie(),n=new XMLHttpRequest;n.onload=O,n.onerror=O,n.passToken=t,n.open("PUT","".concat(I,"/").concat(e,"/tokens")),n.setRequestHeader("Content-Type","application/json"),n.send(JSON.stringify({accessToken:t}))}function O(){if(200!==this.status)return console.log("Unable to update session from Sessions service. Status:"+this.status),t=this.passToken,void setTimeout((function(){C(t)}),12e4);var t}function E(){204===this.status?k.deleteSessionCookie():console.log("Unable to close session from Sessions service. Status:"+this.status)}var S={createSession:function(t,e,n){var i=new XMLHttpRequest;i.onload=function(){if(201===this.status){var e=JSON.parse(this.response).sessionId;k.setSessionCookie(e)}window.location=decodeURIComponent(t.redirectUrl)},i.onerror=function(){console.log("Unable to create a new session from Sessions service having the origin"+window.location.origin),window.location=decodeURIComponent(t.redirectUrl)},i.open("POST",I),i.setRequestHeader("Content-Type","application/json"),i.send(JSON.stringify({origin:window.location.origin,clientId:t.clientId||e.oidc.clientID,accessToken:n.accessToken}))},updateSession:C,closeSession:function(){var t=k.getSessionCookie(),e=new XMLHttpRequest;e.onload=E,e.onerror=E,e.open("POST","".concat(I,"/").concat(t,"/lifecycle/logout")),e.send()}},A=["signUp"];function U(t){this.connection=t.connection,this.site=t.site,this.culture=t.culture,this.allowGuestUser=t.allowGuestUser,this.guestReturnUrl=t.guestReturnUrl,this.clientId=t.oidc&&t.oidc.clientID,this.domain=t.oidc&&t.oidc.domain,this.hasAnonymousId=!1,this.hasCulture=!1,this.skipFasterCheckoutText=!0===t.skipFasterCheckoutText,this.loginContext=t.loginContext,this.navHint=t.navHint,this.originUrl=String(window.location.href).split("?")[0],this.requireSession=!0===t.requireSession,this.customText=t.customText,this.enableGoogleOneTap=!0===t.enableGoogleOneTap,this.enforcedEmail=t.enforcedEmail,this.isFirstLogin=!0===t.isFirstLogin,this.unificationEntityId=t.unificationEntityId}function R(){for(var t=((window.location||{}).host||"").split("."),e={promotique:"Promotique","99designs":"99designs",vistacreate:"vistacreate"},n=Object.keys(e),i=0;i<t.length;i++)if(n.includes(t[i]))return e[t[i]];return"Vistaprint"}function x(t,e,n,i,r){var o={redirectUrl:t,wauth:e,clientId:n,requireSession:i,domain:r};return btoa(JSON.stringify(o))}U.prototype.withReturnUrl=function(t){if(!t)throw new Error("[AuthOptionsBuilder] Error: ReturnUrl is not provided.");return this.returnUrl=t,this},U.prototype.withAnonymousId=function(){return this.hasAnonymousId=!0,this},U.prototype.withCulture=U.prototype.build=function(){if(!this.returnUrl)throw new Error("[AuthOptionsBuilder] Error: ReturnUrl was not set up.");var t;return-1===this.connection.indexOf("ADFS")&&(t=function(t,e,n,i,r,o,s,a,u,c,h,p,l,f,d,g){var y={site:s||R()};if(t){var m=k.getAnonymousIdentityState();m&&(y.anonymousId=encodeURIComponent(m.id),y.validationKey=encodeURIComponent(m.nonce),y.anonKey=m.anonKey&&encodeURIComponent(m.anonKey))}var v=k.getOptimizelyId();v&&(y.optimizelyId=v),e&&n&&(y.culture=n),o&&(y.redirectUrl=o),i&&(y.guestReturnUrl=r||o),a&&(y.skipFasterCheckoutText=!0),u&&(y.loginContext=u),c&&(A.includes(c)?y.navHint=c:console.error("Invalid nav hint value passed - ",c)),h&&(y.originUrl=h);var w=k.getCookie("_ga",!1);w&&(y.ga=w);var b=k.getCookie("visit",!1);return b&&(y.visit=b),p&&(y.customText=p),l&&(y.enableGoogleOneTap=l),f&&(y.enforcedEmail=f),d&&(y.isFirstLogin=d),g&&(y.unificationEntityId=g),btoa(JSON.stringify(y))}(this.hasAnonymousId,this.hasCulture,this.culture,this.allowGuestUser,this.guestReturnUrl,this.returnUrl,this.site,this.skipFasterCheckoutText,this.loginContext,this.navHint,this.originUrl,this.customText,this.enableGoogleOneTap,this.enforcedEmail,this.isFirstLogin,this.unificationEntityId)),{connection:this.connection,state:x(this.returnUrl,t,this.clientId,this.requireSession,this.domain),wauth:t}};var D=U;function P(t){if(!t||!t.href||!t.origin)throw new Error("[ReturnUrlBuilder]: Parameter 'location' has to be specified and valid.");this.location=t,this.additionalQueryParams=[],this.additionalHashParams=[]}unction j(t,e,n){if(0===e.length)return t;var i=e.map(().join("&");return"".concat(t).concat(n).concat(i)}P.prototype.withAdditionalQueryParam=function(t,e){var n=encodeURIComponent(t),i=encodeURIComponent(e);return this.additionalQueryParams.push([n,i]),this},P.prototype.withAdditionalHashParam=function(t,e){var n=encodeURIComponent(t),i=encodeURIComponent(e);return this.additionalHashParams.push([n,i]),this},P.prototype.build=function(){if(0===this.additionalQueryParams.length&&0===this.additionalHashParams.length&&this.location.search.indexOf("askUserToLogin")<0)return this.location.href;var t=this.location.origin,e=this.location.search?function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"askUserToLogin",n=t.split("?");if(n.length>=2){for(var i=encodeURIComponent(e)+"=",r=n[1].split(/[&;]/g),o=r.length-1;o>=0;o--)-1!==r[o].lastIndexOf(i,0)&&r.splice(o,1);return n[0]+(r.length>0?"?"+r.join("&"):"")}return t}(this.location.search):"";return t=j(t=B(t=t,this.location.pathname),e),this.additionalQueryParams,e?"&":"?"),j(t=B(t,this.location.hash),this.additionalHashParams,e?"&":"#")};var M=P,L=function(t,e){!function(t,e){window&&window.tracking&&"function"==typeof window.tracking.track?window.tracking.track("Sign-in Flow Initiated",{caller:e}):console.warn("Tracking-js not found. Cannot track sign-in event.")}(0,t),e&&setTimeout(e,300)},q="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{};function N(t,e){return t(e={exports:{}},e.exports),e.exports}for(var H=N((),V=[],z=[],W="undefined"!=typeof Uint8Array?Uint8Array:Array,F="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Y=0,J=F.length;Y<J;++Y)V[Y]=F[Y],z[F.charCodeAt(Y)]=Y;"-".charCodeAt(0)]=62,z["_".charCodeAt(0)]=63;var G=$=Z=Q=tt={}.toString,et=Array.isArray||nt=N((function(t,e){||R(t,0,n,4),Q(t,e,n,i,23,4),n+4}.Buffer=r,e.SlowBuffer=e.INSPECT_MAX_BYTES=50,r.TYPED_ARRAY_SUPPORT=void 0!==q.TYPED_ARRAY_SUPPORT?q.TYPED_ARRAY_SUPPORT:),e.kMaxLength=n(),r.poolSize=8192,r._augment=r.from=r.TYPED_ARRAY_SUPPORT&&(r.prototype.__proto__=Uint8Array.prototype,r.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&r[Symbol.species]===r&&Object.defineProperty(r,Symbol.species,{value:null,configurable:!0})),r.alloc=r.allocUnsafe=function(t){return a(null,t)},r.allocUnsafeSlow=r.isBuffer=r.compare=r.isEncoding=r.concat=r.byteLength=h,r.prototype._isBuffer=!0,r.prototype.swap16=r.prototype.swap32=r.prototype.swap64=r.prototype.toString=r.prototype.equals=r.prototype.inspect=r.prototype.compare=r.prototype.includes=r.prototype.indexOf=function(t,e,n){return f(this,t,e,n,!0)},r.prototype.lastIndexOf=r.prototype.write=r.prototype.toJSON=r.prototype.slice=r.prototype.readUIntLE=r.prototype.readUIntBE=r.prototype.readUInt8=r.prototype.readUInt16LE=r.prototype.readUInt16BE=r.prototype.readUInt32LE=r.prototype.readUInt32BE=r.prototype.readIntLE=r.prototype.readIntBE=r.prototype.readInt8=r.prototype.readInt16LE=r.prototype.readInt16BE=r.prototype.readInt32LE=r.prototype.readInt32BE=r.prototype.readFloatLE=function(t,e){return e||E(t,4,this.length),Z(this,t,!0,23,4)},r.prototype.readFloatBE=function(t,e){return e||E(t,4,this.length),Z(this,t,!1,23,4)},r.prototype.readDoubleLE=function(t,e){return e||E(t,8,this.length),Z(this,t,!0,52,8)},r.prototype.readDoubleBE=r.prototype.writeUIntLE=r.prototype.writeUIntBE=r.prototype.writeUInt8=r.prototype.writeUInt16LE=r.prototype.writeUInt16BE=r.prototype.writeUInt32LE=r.prototype.writeUInt32BE=r.prototype.writeIntLE=r.prototype.writeIntBE=r.prototype.writeInt8=r.prototype.writeInt16LE=r.prototype.writeInt16BE=r.prototype.writeInt32LE=r.prototype.writeInt32BE=r.prototype.writeFloatLE=function(t,e,n){return x(this,t,e,!0,n)},r.prototype.writeFloatBE=function(t,e,n){return x(this,t,e,!1,n)},r.prototype.writeDoubleLE=function(t,e,n){return D(this,t,e,!0,n)},r.prototype.writeDoubleBE=r.prototype.copy=r.prototype.fill=var P=/[^+\/0-9A-Za-z-_]/g;nction M(t){return G(t))})),it=(nt.Buffer,nt.SlowBuffer,nt.INSPECT_MAX_BYTES,nt.kMaxLength,N((function(t,e){var n=nt.Buffer;from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?t.exports=nt:(i(nt,e),e.Buffer=r),r.prototype=Object.create(n.prototype),i(n,r),r.from=r.alloc=r.allocUnsafe=r.allocUnsafeSlow=))),rt=(it.Buffer,it.Buffer);t.prototype.update=ot.prototype.digest=ot.prototype._update=function(){throw new Error("_update must be implemented by subclass")};var st=ot,at=it.Buffer,ut=[1518500249,1859775393,-1894007588,-899497514],ct=new Array(80);function ht(){this.init(),this._w=ct,st.call(this,64,56)}function pt(t){return t<<30|t>>>2}function lt(t,e,n,i){return 0===t?e&n|~e&i:2===t?e&n|e&i|n&i:e^n^i}H(ht,st),ht.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},ht.prototype._update=ht.prototype._hash=function(){var t=at.allocUnsafe(20);return t.writeInt32BE(0|this._a,0),t.writeInt32BE(0|this._b,4),t.writeInt32BE(0|this._c,8),t.writeInt32BE(0|this._d,12),t.writeInt32BE(0|this._e,16),t};var ft=ht,dt=it.Buffer,gt=[1518500249,1859775393,-1894007588,-899497514],yt=new Array(80);function mt(){this.init(),this._w=yt,st.call(this,64,56)}function vt(t){return t<<5|t>>>27}mt,st),mt.prototype.init=mt.prototype._update=mt.prototype._hash=var _t=mt,Tt=it.Buffer,kt=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],It=new Array(64);function Ct(){this.init(),this._w=It,st.call(this,64,56)}function Ot(t,e,n){return n^t&(e^n)}function Et(t,e,n){return t&e|n&(t|e)}function St(t){return(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10)}Ct,st),Ct.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},Ct.prototype._update=Ct.prototype._hash=var Rt=Ct,xt=it.Buffer,Dt=new Array(64);function Pt(){this.init(),this._w=Dt,st.call(this,64,56)}H(Pt,Rt),Pt.prototype.init=Pt.prototype._hash=var Bt=Pt,jt=it.Buffer,Mt=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],Lt=new Array(160);function qt(){this.init(),this._w=Lt,st.call(this,128,112)}nction Vt(t,e){return(t>>>28|e<<4)^(e>>>2|t<<30)^(e>>>7|t<<25)}function zt(t,e){return(t>>>14|e<<18)^(t>>>18|e<<14)^(e>>>9|t<<23)}function Wt(t,e){return(t>>>1|e<<31)^(t>>>8|e<<24)^t>>>7}function Ft(t,e){return(t>>>1|e<<31)^(t>>>8|e<<24)^(t>>>7|e<<25)}t,st),qt.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},qt.prototype._update=qt.prototype._hash=var Xt=qt,Gt=it.Buffer,$t=new Array(160);(Zt,Xt),Zt.prototype.init=Zt.prototype._hash=var Qt=Zt,te=N((function(t){var e=t.exports=e.sha=ft,e.sha1=_t,e.sha224=Bt,e.sha256=Rt,e.sha384=Qt,e.sha512=Xt})),ee=N((function(t){var e=it.Buffer,n=q.crypto||q.msCrypto;n&&n.getRandomValues?t.exports=t.exports=));function ne(){this.version="6.1.135"}function ie(t){return-1!==t.options.connection.indexOf("ADFS")}e.prototype.getToken=function(){if(!a())return null;var t=o(),e=t.storage.get(t.options.storageTokenKey);return e?e.value:null},ne.prototype.getTokenType=function(){if(!a())return null;var t=o(),e=t.storage.get(t.options.storageTokenKey);return e?e.type:null},ne.prototype.signIn=function(t,e,n){if(!a())throw new Error("[WebAuth] Error: Not initialized. Use init().");var i=o();if(!this.isSignedIn()){var r=function(t,e){var n=new M(window.location);return Array.isArray(t)&&t.forEach((function(t){t&&n.withAdditionalQueryParam(t.key,t.value)})),Array.isArray(e)&&e.forEach((),n.build()}(t,e);console.error("[authjs] Debug:redirectURL "+r);var s=i.options||{};n&&(void 0!==n.allowGuestUser&&(s.allowGuestUser=n.allowGuestUser),void 0!==n.guestReturnUrl&&(s.guestReturnUrl=n.guestReturnUrl),void 0!==n.site&&(s.site=n.site),void 0!==n.skipFasterCheckoutText&&(s.skipFasterCheckoutText=n.skipFasterCheckoutText),void 0!==n.loginContext&&(s.loginContext=n.loginContext),void 0!==n.navHint&&(s.navHint=n.navHint),void 0!==n.requireSession&&(s.requireSession=n.requireSession),void 0!==n.enableGoogleOneTap&&(s.enableGoogleOneTap=n.enableGoogleOneTap),void 0!==n.enforcedEmail&&(s.enforcedEmail=n.enforcedEmail),void 0!==n.customText&&(s.customText=n.customText),void 0!==n.isFirstLogin&&(s.isFirstLogin=n.isFirstLogin),void 0!==n.unificationEntityId&&(s.unificationEntityId=n.unificationEntityId));var u=new D(s).withReturnUrl(r);ie(i)||(u.withAnonymousId().withCulture(),console.error("[authjs] Debug:culture "+s.culture));var c=this;L(n&&n.trackingCaller,()}},ne.prototype.authorize=function(t,e){var n,i=re(ee(32).toString("base64")),r=(n=i,re(te("sha256").update(n).digest("base64")));e.storage.set(e.options.storageVerifierKey,"user",i);var o="https://".concat(e.options.oidc.domain,"/authorize");o+="?connection=".concat(t.connection),o+="&state=".concat(encodeURIComponent(t.state)),o+="".concat(ie(e)?"":"&wauth=".concat(t.wauth)),o+="&response_type=".concat(e.options.oidc.responseType),o+="&client_id=".concat(e.options.oidc.clientID),o+="&audience=".concat(e.options.oidc.audience),o+="&code_challenge=".concat(r),o+="&code_challenge_method=S256",o+="&scope=".concat(encodeURIComponent(e.options.oidc.scope)),o+="&redirect_uri=".concat(e.options.oidc.redirectUri),window.location=o},ne.prototype.signOut=function(){if(!a())throw new Error("[WebAuth] Error: Not initialized. Use init().");var t=o();if(this.isSignedIn()){t.storage.delete(t.options.storageTokenKey),t.storage.delete(t.options.storageRefreshKey),k.deleteAuthCookie(),k.deletePresumedLoginState();var e,n,i,r,s=function(t){return new RegExp("-Customers$").test(t.options.connection)||new RegExp("-Unification$").test(t.options.connection)}(t),u=(e=t.options.signOutUrl,n=(r=o().options.redirectAfterSignOutCallback())?"raso=".concat(encodeURIComponent(r)):null,i="".concat(e,"/sign-out-callback/"),o().options.developmentMode&&(i="".concat(e,"/")),n?"".concat(i,"?").concat(n):i),c={returnTo:u};if(s)if(t.options&&"Vistaprint-Staging-Customers"===t.options.connection)c.federated=!0;else if("VP-Customers-Unification"===t.options.connection)c={clientID:"KYWF9D4UM3hT8jM1asfQj7X6xSDXZp7R",returnTo:"https://vistaprint-unification.eu.auth0.com/v2/logout?returnTo=".concat(u,"&client_id=7KyluKip2WIpBexLw8HuyujKPiSnAuBI")};else{var h="https://account.vista.com/v2/logout?returnTo=".concat(u,"&client_id=YhWiXWN12uDSeYo62BY2uD35vWLeETx1");c={clientID:void 0,returnTo:"https://account.vistaprint.com/v2/logout?returnTo=".concat(encodeURIComponent(h),"&client_id=YhWiXWN12uDSeYo62BY2uD35vWLeETx1")}}t.options.requireSession&&k.getSessionCookie()&&S.closeSession(),this.logout(c)}},ne.prototype.logout=function(t){if(!a())throw new Error("[WebAuth] Error: Not initialized. Use init().");var e=o(),n=k.getConfigCookie(),i=e.options.oidc.clientID,r=e.options.oidc.domain;n?r=n.domain:i===f&&(r=g);var s="https://".concat(r,"/v2/logout");s+="?returnTo=".concat(encodeURIComponent(t.returnTo)),t.clientID&&(s+="&clientID=".concat(t.clientID)),t.federated&&(s+="&federated"),window.location=s},ne.prototype.isSignedIn=function(){if(!a())return!1;var t=o(),e=this.getTokenType();return t.options.enableCrossSiteSso?"user"===e:"user"===e&&k.getPresumedLoginState()},ne.prototype.getProfile=function(){var t=this.getToken();return t?l.parse(t):null},ne.prototype.getCanonicalId=function(){var t=this.getProfile();return t?l.getCanonicalId(t):null},ne.prototype.getRecentAnonymousIds=ne.prototype.getIdentity=ne.prototype.getAuthorizationHeader=function(){var t=this.getAuthorization();return t?"".concat(t.type," ").concat(t.token):null},ne.prototype.getAuthorization=function(){var t=this.getToken();return t?{type:"Bearer",token:t}:null},ne.prototype.onUserIdentityUpdate=function(t){"function"==typeof t&&(h()&&t(u()),window.addEventListener("userIdentity",(function(e){t(e.detail)})))};var oe=ne,se="undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{};ar ue=ae((function(t){var e,n;e=se,n=function(){return function(){return function(t){var e=[];if(t[0].match(/^[^\/:]+:\/*$/)&&t.length>1){var n=t.shift();t[0]=n+t[0]}t[0].match(/^file:\/\/\//)?t[0]=t[0].replace(/^([^\/:]+):\/*/,"$1:///"):t[0]=t[0].replace(/^([^\/:]+):\/*/,"$1://");for(var i=0;i<t.length;i++){var r=t[i];if("string"!=typeof r)throw new TypeError("Url must be a string. Received "+r);""!==r&&(i>0&&(r=r.replace(/^[\/]+/,"")),r=i<t.length-1?r.replace(/[\/]+$/,""):r.replace(/[\/]+$/,"/"),e.push(r))}var o=e.join("/"),s=(o=o.replace(/\/(\?|&|#[^!])/g,"$1")).split("?");return s.shift()+(s.length>0?"?":"")+s.join("&")}("object"==y(arguments[0])?arguments[0]:[].slice.call(arguments))}},t.exports?t.exports=n():e.urljoin=n()})),ce=ae((function(t,e){var n=Object.prototype.hasOwnProperty,i=);e.arrayToObject=e.merge=function(t,i,r){if(!i)return t;if("object"!=y(i)){if(Array.isArray(t))t.push(i);else{if("object"!=y(t))return[t,i];(r.plainObjects||r.allowPrototypes||!n.call(Object.prototype,i))&&(t[i]=!0)}return t}if("object"!=y(t))return[t].concat(i);var o=t;return Array.isArray(t)&&!Array.isArray(i)&&(o=e.arrayToObject(t,r)),Array.isArray(t)&&Array.isArray(i)?(i.forEach((function(i,o){n.call(t,o)?t[o]&&"object"==y(t[o])?t[o]=e.merge(t[o],i,r):t.push(i):t[o]=i})),t):Object.keys(i).reduce((,o)},e.decode=e.encode=e.compact=function(t,n){if("object"!=y(t)||null===t)return t;var i=n||[],r=i.indexOf(t);if(-1!==r)return i[r];if(i.push(t),Array.isArray(t)){for(var o=[],s=0;s<t.length;++s)t[s]&&"object"==y(t[s])?o.push(e.compact(t[s],i)):void 0!==t[s]&&o.push(t[s]);return o}return Object.keys(t).forEach((),t},e.isRegExp=e.isBuffer=)),he=(ce.arrayToObject,ce.merge,ce.decode,ce.encode,ce.compact,ce.isRegExp,ce.isBuffer,String.prototype.replace),pe=/%20/g,le={default:"RFC3986",formatters:{RFC1738:RFC3986:function(t){return t}},RFC1738:"RFC1738",RFC3986:"RFC3986"},fe={brackets:indices:repeat:,de=Date.prototype.toISOString,ge={delimiter:"&",encode:!0,encoder:ce.encode,encodeValuesOnly:!1,serializeDate:skipNulls:!1,strictNullHandling:!1},ye=me=Object.prototype.hasOwnProperty,ve={allowDots:!1,allowPrototypes:!1,arrayLimit:20,decoder:ce.decode,delimiter:"&",depth:5,parameterLimit:1e3,plainObjects:!1,strictNullHandling:!1},we=function(t,e,n){if(t){var i=n.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,r=/(\[[^[\]]*])/g,o=/(\[[^[\]]*])/.exec(i),s=o?i.slice(0,o.index):i,a=[];if(s){if(!n.plainObjects&&me.call(Object.prototype,s)&&!n.allowPrototypes)return;a.push(s)}for(var u=0;null!==(o=r.exec(i))&&u<n.depth;){if(u+=1,!n.plainObjects&&me.call(Object.prototype,o[1].slice(1,-1))&&!n.allowPrototypes)return;a.push(o[1])}return o&&a.push("["+i.slice(o.index)+"]"),function t(e,n,i){if(!e.length)return n;var r,o=e.shift();if("[]"===o)r=(r=[]).concat(t(e,n,i));else{r=i.plainObjects?Object.create(null):{};var s="["===o.charAt(0)&&"]"===o.charAt(o.length-1)?o.slice(1,-1):o,a=parseInt(s,10);!isNaN(a)&&o!==s&&String(a)===s&&a>=0&&i.parseArrays&&a<=i.arrayLimit?(r=[])[a]=t(e,n,i):r[s]=t(e,n,i)}return r}(a,e,n)}},be=function(t,e){var n=t,i=e||{};if(null!==i.encoder&&void 0!==i.encoder&&"function"!=typeof i.encoder)throw new TypeError("Encoder has to be a function.");var r=void 0===i.delimiter?ge.delimiter:i.delimiter,o="boolean"==typeof i.strictNullHandling?i.strictNullHandling:ge.strictNullHandling,s="boolean"==typeof i.skipNulls?i.skipNulls:ge.skipNulls,a="boolean"==typeof i.encode?i.encode:ge.encode,u="function"==typeof i.encoder?i.encoder:ge.encoder,c="function"==typeof i.sort?i.sort:null,h=void 0!==i.allowDots&&i.allowDots,p="function"==typeof i.serializeDate?i.serializeDate:ge.serializeDate,l="boolean"==typeof i.encodeValuesOnly?i.encodeValuesOnly:ge.encodeValuesOnly;if(void 0===i.format)i.format=le.default;else if(!Object.prototype.hasOwnProperty.call(le.formatters,i.format))throw new TypeError("Unknown format option provided.");var f,d,g=le.formatters[i.format];"function"==typeof i.filter?n=(d=i.filter)("",n):Array.isArray(i.filter)&&(f=d=i.filter);var m,v=[];if("object"!=y(n)||null===n)return"";m=i.arrayFormat in fe?i.arrayFormat:"indices"in i?i.indices?"indices":"repeat":"indices";var w=fe[m];f||(f=Object.keys(n)),c&&f.sort(c);for(var b=0;b<f.length;++b){var _=f[b];s&&null===n[_]||(v=v.concat(ye(n[_],_,w,o,s,a?u:null,d,c,h,p,g,l)))}return v.join(r)},_e=ae((),Te=ke=Ie;function Ie(t){if(t)return function(t){for(var e in Ie.prototype)t[e]=Ie.prototype[e];return t}(t)}Ie.prototype.clearTimeout=Ie.prototype.parse=function(t){return this._parser=t,this},Ie.prototype.responseType=function(t){return this._responseType=t,this},Ie.prototype.serialize=function(t){return this._serializer=t,this},Ie.prototype.timeout=function(t){if(!t||"object"!=y(t))return this._timeout=t,this._responseTimeout=0,this;for(var e in t)switch(e){case"deadline":this._timeout=t.deadline;break;case"response":this._responseTimeout=t.response;break;default:console.warn("Unknown timeout option",e)}return this},Ie.prototype.retry=var Ce=["ECONNRESET","ETIMEDOUT","EADDRINFO","ESOCKETTIMEDOUT"];Ie.prototype._shouldRetry=Ie.prototype._retry=Ie.prototype.then=Ie.prototype.catch=Ie.prototype.use=Ie.prototype.ok=function(t){if("function"!=typeof t)throw Error("Callback required");return this._okCallback=t,this},Ie.prototype._isResponseOK=Ie.prototype.get=function(t){return this._header[t.toLowerCase()]},Ie.prototype.getHeader=Ie.prototype.get,Ie.prototype.set=Ie.prototype.unset=Ie.prototype.field=Ie.prototype.abort=Ie.prototype._auth=Ie.prototype.withCredentials=Ie.prototype.redirects=Ie.prototype.maxResponseSize=Ie.prototype.toJSON=Ie.prototype.send=Ie.prototype.sortQuery=Ie.prototype._finalizeQueryString=Ie.prototype._appendQueryString=Ie.prototype._timeoutError=Ie.prototype._setTimeouts=var Oe=Ee;.prototype.get=Ee.prototype._setHeaderProperties=function(t){var e=t["content-type"]||"";this.type=e);var n=e);for(var i in n)this[i]=n[i];this.links={};try{t.link&&(this.links=t.link))}catch(t){}},Ee.prototype._setStatusProperties=["use","on","once","set","query","type","accept","auth","withCredentials","sortQuery","retry","ok","redirects","timeout","buffer","serialize","parse","ca","key","pfx","cert"].forEach((),Se.prototype._setDefaults=for(var Ae=Se,Ue=ae((function(t,e){var n;undefined"!=typeof window?n=window:"undefined"!=typeof self?n=self:(console.warn("Using browser-only version of superagent in non-browser environment"),n=se);var r=e=t.exports=e.Request=p,r.getXHR=var o="".trim?lizeObject=s,r.parseString=u,r.types={html:"text/html",json:"application/json",xml:"text/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},r.serialize={"application/x-www-form-urlencoded":s,"application/json":JSON.stringify},r.parse={"application/x-www-form-urlencoded":u,"application/json":JSON.parse},Oe(h.prototype),h.prototype._parseBody=h.prototype.toError=r.Response=h,_e(p.prototype),ke(p.prototype),p.prototype.type=function(t){return this.set("Content-Type",r.types[t]||t),this},p.prototype.accept=p.prototype.auth=function(t,e,n){return 1===arguments.length&&(e=""),"object"==y(e)&&null!==e&&(n=e,e=""),n||(n={type:"function"==typeof btoa?"basic":"auto"}),this._auth(t,e,n,()},p.prototype.query=p.prototype.attach=p.prototype._getFormData=p.prototype.callback=p.prototype.crossDomainError=p.prototype.buffer=p.prototype.ca=p.prototype.agent=p.prototype.pipe=p.prototype.write=p.prototype._isHost=function(t){return t&&"object"==y(t)&&!Array.isArray(t)&&"[object Object]"!==Object.prototype.toString.call(t)},p.prototype.end=p.prototype._end=r.agent=["GET","POST","OPTIONS","PATCH","PUT","DELETE"].forEach((),Ae.prototype.del=Ae.prototype.delete,r.get=function(t,e,n){var i=r("GET",t);return"function"==typeof e&&(n=e,e=null),e&&i.query(e),n&&i.end(n),i},r.head=function(t,e,n){var i=r("HEAD",t);return"function"==typeof e&&(n=e,e=null),e&&i.query(e),n&&i.end(n),i},r.options=function(t,e,n){var i=r("OPTIONS",t);return"function"==typeof e&&(n=e,e=null),e&&i.send(e),n&&i.end(n),i},r.del=l,r.delete=l,r.patch=function(t,e,n){var i=r("PATCH",t);return"function"==typeof e&&(n=e,e=null),e&&i.send(e),n&&i.end(n),i},r.post=function(t,e,n){var i=r("POST",t);return"function"==typeof e&&(n=e,e=null),e&&i.send(e),n&&i.end(n),i},r.put=)),Re=(Ue.Request,[]),xe=[],De="undefined"!=typeof Uint8Array?Uint8Array:Array,Pe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Be=0,je=Pe.length;Be<je;++Be)Re[Be]=Pe[Be],xe[Pe.charCodeAt(Be)]=Be;unction Le(t,e,n){for(var i,r=[],o=e;o<n;o+=3)i=(t[o]<<16)+(t[o+1]<<8)+t[o+2],r.push(Re[(s=i)>>18&63]+Re[s>>12&63]+Re[s>>6&63]+Re[63&s]);var s;return r.join("")}xe["-".charCodeAt(0)]=62,xe["_".charCodeAt(0)]=63;var qe=function(t){var e,n,i,r,o,s,a=t.length;o=Me(t),s=new De(3*a/4-o),i=o>0?a-4:a;var u=0;for(e=0,n=0;e<i;e+=4,n+=3)r=xe[t.charCodeAt(e)]<<18|xe[t.charCodeAt(e+1)]<<12|xe[t.charCodeAt(e+2)]<<6|xe[t.charCodeAt(e+3)],s[u++]=r>>16&255,s[u++]=r>>8&255,s[u++]=255&r;return 2===o?(r=xe[t.charCodeAt(e)]<<2|xe[t.charCodeAt(e+1)]>>4,s[u++]=255&r):1===o&&(r=xe[t.charCodeAt(e)]<<10|xe[t.charCodeAt(e+1)]<<4|xe[t.charCodeAt(e+2)]>>2,s[u++]=r>>8&255,s[u++]=255&r),s},Ne=He=Ve={raw:"9.10.4"},ze=Object.prototype.toString;function We(t,e,n,i){if(n="array"===n?"object":n,t&&y(t[e])!==n)throw new Error(i)}function Fe(t,e,n){if(y(t)!==e)throw new Error(n)}ar Je={check:attribute:We,variable:Fe,value:Ye,isArray:supportsIsArray:;ar Xe=n={toSnakeCase:function t(e,n){return"object"!=y(e)||Je.isArray(e)||null===e?e:(n=n||[],Object.keys(e).reduce((,{}))},toCamelCase:function t(e,n,i){return"object"!=y(e)||Je.isArray(e)||null===e?e:(n=n||[],i=i||{},Object.keys(e).reduce((,{}))},blacklist:merge:pick:Ge,getKeysNotIn:extend:Ze,getOriginFromUrl:getLocationFromUrl:Qe,trimUserDetails:;unction rn(t){this.request=t}.prototype.abort=function(){this.request.abort()},nn.prototype.getMethod=function(){return this.method},nn.prototype.getBody=function(){return this.body},nn.prototype.getUrl=function(){return this.url},nn.prototype.getHeaders=rn.prototype.set=rn.prototype.send=rn.prototype.withCredentials=rn.prototype.end=on.prototype.setCommonConfiguration=on.prototype.getTelemetryData=on.prototype.get=function(t,e){return new rn(this.setCommonConfiguration(Ue.get(t),e))},on.prototype.post=function(t,e){return new rn(this.setCommonConfiguration(Ue.post(t),e))},on.prototype.patch=var an={redirect:getDocument:function(){return sn().document},getWindow:sn,getOrigin:;function un(){}un.prototype.getItem=function(){return null},un.prototype.removeItem=function(){},un.prototype.setItem=function(){};var cn=ae((function(t,e){t.exports=)}));function hn(){}nction fn(t){this.handler=new ln(t)}.prototype.getItem=function(t){return cn.get(t)},hn.prototype.removeItem=function(t){cn.remove(t)},hn.prototype.setItem=pn.prototype.warning=ln.prototype.failover=ln.prototype.getItem=function(t){try{return this.storage.getItem(t)}catch(e){return this.warn.warning(e),this.failover(),this.getItem(t)}},ln.prototype.removeItem=ln.prototype.setItem=fn.prototype.getItem=fn.prototype.removeItem=fn.prototype.setItem=dn.prototype.set=dn.prototype.get=var yn={buildResponse:gn,invalidToken:function(t){return gn("invalid_token",t)}};ar vn=["realm","audience","client_id","client_secret","redirect_uri","scope","code","grant_type","username","password","refresh_token","assertion","client_assertion","client_assertion_type","code_verifier"],wn=["connection","connection_scope","auth0Client","owp","device","realm","protocol","_csrf","_intstate","login_ticket","client_id","response_type","response_mode","redirect_uri","audience","scope","state","nonce","display","prompt","max_age","ui_locales","claims_locales","id_token_hint","login_hint","acr_values","claims","registration","request","request_uri","code_challenge","code_challenge_method","access_type","display"],bn=_n=Tn=ae((function(t,e){var n;t.exports=n=n||Math)})),kn=ae((),In=ae((),Cn=ae((),On=ae((function(t,e){(function(){var e;r r="undefined"!=typeof navigator;r&&"Microsoft Internet Explorer"==navigator.appName?(n.prototype.am=e=30):r&&"Netscape"!=navigator.appName?(n.prototype.am=e=26):(n.prototype.am=e=28),n.prototype.DB=e,n.prototype.DM=(1<<e)-1,n.prototype.DV=1<<e,n.prototype.FV=Math.pow(2,52),n.prototype.F1=52-e,n.prototype.F2=2*e-52;var o,s,a=new Array;for(o="0".charCodeAt(0),s=0;s<=9;++s)a[o++]=s;for(o="a".charCodeAt(0),s=10;s<36;++s)a[o++]=s;for(o="A".charCodeAt(0),s=10;s<36;++s)a[o++]=s;function u(t){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(t)}){}prototype.convert=l.prototype.revert=function(t){return t},l.prototype.reduce=l.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},l.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},f.prototype.convert=f.prototype.revert=f.prototype.reduce=f.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},f.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},n.prototype.copyTo=n.prototype.fromInt=n.prototype.fromString=n.prototype.clamp=n.prototype.dlShiftTo=n.prototype.drShiftTo=n.prototype.lShiftTo=n.prototype.rShiftTo=n.prototype.subTo=n.prototype.multiplyTo=n.prototype.squareTo=n.prototype.divRemTo=n.prototype.invDigit=n.prototype.isEven=n.prototype.exp=n.prototype.toString=n.prototype.negate=n.prototype.abs=n.prototype.compareTo=n.prototype.bitLength=n.prototype.mod=n.prototype.modPowInt=n.ZERO=h(0),n.ONE=h(1),b.prototype.convert=_,b.prototype.revert=_,b.prototype.mulTo=b.prototype.sqrTo=T.prototype.convert=T.prototype.revert=function(t){return t},T.prototype.reduce=T.prototype.mulTo=T.prototype.sqrTo=var k,I,C,O=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],E=(1<<26)/O[O.length-1];f(n.prototype.chunkSize=n.prototype.toRadix=n.prototype.fromRadix=n.prototype.fromNumber=n.prototype.bitwiseTo=n.prototype.changeBit=n.prototype.addTo=n.prototype.dMultiply=n.prototype.dAddOffset=n.prototype.multiplyLowerTo=n.prototype.multiplyUpperTo=n.prototype.modInt=n.prototype.millerRabin=n.prototype.clone=function(){var t=i();return this.copyTo(t),t},n.prototype.intValue=n.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},n.prototype.shortValue=n.prototype.signum=n.prototype.toByteArray=n.prototype.equals=n.prototype.min=n.prototype.max=n.prototype.and=function(t){var e=i();return this.bitwiseTo(t,d,e),e},n.prototype.or=function(t){var e=i();return this.bitwiseTo(t,g,e),e},n.prototype.xor=function(t){var e=i();return this.bitwiseTo(t,y,e),e},n.prototype.andNot=n.prototype.not=n.prototype.shiftLeft=function(t){var e=i();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e},n.prototype.shiftRight=n.prototype.getLowestSetBit=n.prototype.bitCount=n.prototype.testBit=n.prototype.setBit=function(t){return this.changeBit(t,g)},n.prototype.clearBit=function(t){return this.changeBit(t,m)},n.prototype.flipBit=n.prototype.add=function(t){var e=i();return this.addTo(t,e),e},n.prototype.subtract=function(t){var e=i();return this.subTo(t,e),e},n.prototype.multiply=n.prototype.divide=n.prototype.remainder=n.prototype.divideAndRemainder=n.prototype.modPow=n.prototype.modInverse=n.prototype.pow=n.prototype.gcd=n.prototype.isProbablePrime=n.prototype.square=n.prototype.Barrett=T,null==I){var A;if(I=new Array,C=0,"undefined"!=typeof window&&window.crypto)if(window.crypto.getRandomValues){var U=new Uint8Array(32);for(window.crypto.getRandomValues(U),A=0;A<32;++A)I[C++]=U[A]}else if("Netscape"==navigator.appName&&navigator.appVersion<"5"){var R=window.crypto.random(32);for(A=0;A<R.length;++A)I[C++]=255&R.charCodeAt(A)}for(;C<B;)A=Math.floor(65536*Math.random()),I[C++]=A>>>8,I[C++]=255&A;C=0,S()}unction D(){}.prototype.nextBytes=P.prototype.init=P.prototype.next=var B=256;n.SecureRandom=D,n.BigInteger=n,t.exports=n}).call(se)})).BigInteger,En={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},Sn={sha256:kn};n.prototype.verify=var Un=An; Pn=function(t){return t=Rn(t).replace(/\-/g,"+").replace(/_/g,"/"),decodeURIComponent(xn(qe(t)).split("").map(().join(""))},Bn=jn=Mn=ae((function(t){var e,n;e=se,n=function(){return function(){var t=arguments;"object"==y(arguments[0])&&(t=arguments[0]);var e=[].slice.call(t,0).join("/");return e.replace(/:\//g,"://").replace(/([^:\s])\/+/g,"$1/").replace(/\/(\?|&|#[^!])/g,"$1").replace(/(\?.+)\?/g,"$1&")}},t.exports?t.exports=n():e.urljoin=n()}));ar qn=function(t,e){var n=t.jwksURI||Mn(t.iss,".well-known","jwks.json");return Ue.get(n).end((function(n,i){var r,o,s=null;if(n)return e(n);for(r=0;r<i.body.keys.length&&null===s;r++)(o=i.body.keys[r]).kid===t.kid&&(s=o);return e(null,Ln(s))}))};function Nn(t){this.name="ConfigurationError",this.message=t||""}n.prototype=Error.prototype,Hn.prototype=Error.prototype;var Vn={ConfigurationError:Nn,TokenValidationError:Hn};function zn(){}zn.prototype.get=zn.prototype.has=function(){return!1},zn.prototype.set=function(){};var Wn=zn,Fn=["RS256"];function Yn(t){var e=t||{};if(this.jwksCache=e.jwksCache||new Wn,this.expectedAlg=e.expectedAlg||"RS256",this.issuer=e.issuer,this.audience=e.audience,this.leeway=e.leeway||0,this.__disableExpirationCheck=e.__disableExpirationCheck||!1,this.jwksURI=e.jwksURI,this.leeway<0||this.leeway>60)throw new Vn.ConfigurationError("The leeway should be positive and lower than a minute.");if(-1===Fn.indexOf(this.expectedAlg))throw new Vn.ConfigurationError("Algorithm "+this.expectedAlg+" is not supported. (Expected algs: ["+Fn.join(",")+"])")}Yn.prototype.verify=function(t,e,n){var i=this.decode(t);if(i instanceof Error)return n(i,!1);var r=i.encoded.header+"."+i.encoded.payload,o=Bn(i.encoded.signature),s=i.header.alg,a=i.header.kid,u=i.payload.aud,c=i.payload.iss,h=i.payload.exp,p=i.payload.nbf,l=i.payload.nonce||null;if(this.issuer!==c)return n(new Vn.TokenValidationError("Issuer "+c+" is not valid."),!1);if(this.audience!==u)return n(new Vn.TokenValidationError("Audience "+u+" is not valid."),!1);if(this.expectedAlg!==s)return n(new Vn.TokenValidationError("Algorithm "+s+" is not supported. (Expected algs: ["+Fn.join(",")+"])"),!1);if(l!==e)return n(new Vn.TokenValidationError("Nonce does not match."),!1);var f=this.verifyExpAndNbf(h,p);return f?n(f,!1):this.getRsaVerifier(c,a,()},Yn.prototype.verifyExpAndNbf=Yn.prototype.verifyExpAndIat=Yn.prototype.getRsaVerifier=function(t,e,n){var i=this,r=t+e;if(this.jwksCache.has(r)){var o=this.jwksCache.get(r);n(null,new Un(o.modulus,o.exp))}else qn({jwksURI:this.jwksURI,iss:t,kid:e},()},Yn.prototype.decode=function(t){var e,n,i=t.split(".");if(3!==i.length)return new Vn.TokenValidationError("Cannot decode a malformed JWT");try{e=JSON.parse(Pn(i[0])),n=JSON.parse(Pn(i[1]))}catch(t){return new Vn.TokenValidationError("Token header or payload is not valid JSON")}return{header:e,payload:n,encoded:{header:i[0],payload:i[1],signature:i[2]}}},Yn.prototype.validateAccessToken=function(t,e,n,i){if(this.expectedAlg!==e)return i(new Vn.TokenValidationError("Algorithm "+e+" is not supported. (Expected alg: "+this.expectedAlg+")"));var r=kn(t),o=Cn.stringify(r),s=o.substring(0,o.length/2),a=Cn.parse(s),u=In.stringify(a);return i(jn(u)!==n?new Vn.TokenValidationError("Invalid access_token"):null)};var Jn=Yn;n.prototype.get=var Xn=totype.process=Gn.prototype.generateTransaction=function(t,e,n,i,r){return e=e||Xn(this.keyLength),n=n||(r?Xn(this.keyLength):null),an.getWindow().location.host===this.options.domain||this.storage.setItem(this.namespace+e,{nonce:n,appState:t,state:e,lastUsedConnection:i},{expires:1/48}),{state:e,nonce:n}},Gn.prototype.getStoredTransaction=Gn.prototype.clearTransaction=$n.prototype.init=$n.prototype.eventListener=$n.prototype.timeoutHandler=$n.prototype.destroy=Zn.prototype.run=Qn.prototype.login=Qn.prototype.callback=ei.prototype.loginWithCredentials=ei.prototype.signupAndLogin=var ni=ae((function(t){var e=function(){function t(t,e,n){t.attachEvent?t.attachEvent("on"+e,n):t.addEventListener&&t.addEventListener(e,n,!1)}r i=);return"undefined"!=typeof window&&window.JSON&&window.JSON.stringify&&window.JSON.parse&&window.postMessage?{open:function(r,o){if(!o)throw"missing required callback argument";var s,a;r.url||(s="missing required 'url' parameter"),r.relay_url||(s="missing required 'relay_url' parameter"),s&&setTimeout((,0),r.window_name||(r.window_name=null),r.window_features&&!)||(r.window_features=void 0);var u,c=r.origin||n(r.url);if(c!==n(r.relay_url))return setTimeout((function(){o("invalid arguments: origin of url and relay_url must match")}),0);i&&((a=document.createElement("iframe")).setAttribute("src",r.relay_url),a.style.display="none",a.setAttribute("name","__winchan_relay_frame"),document.body.appendChild(a),u=a.contentWindow);var h=r.popup||window.open(r.url,r.window_name,r.window_features);r.popup&&(h.location.href=r.url),u||(u=h);var p=setInterval((,500),l=JSON.stringify({a:"request",d:r.params});turn t(window,"unload",f),t(window,"message",d),{close:f,focus:},onOpen::{open:onOpen:}();t.exports&&(t.exports=e)})),ii=on hi(t,e){this.baseOptions=e,this.request=t}function pi(t,e){this.baseOptions=e,this.request=t}.prototype.calculatePosition=ri.prototype.preload=ri.prototype.load=function(t,e,n,i){var r=this,o=this.calculatePosition(n.popupOptions||{}),s=en.merge(o).with(n.popupOptions),a=en.merge({url:t,relay_url:e,window_features:be(s,{delimiter:",",encode:!1}),popup:this._current_popup}).with(n),u=ni.open(a,();return u.focus(),u},oi.prototype.buildPopupHandler=oi.prototype.preload=oi.prototype.getPopupHandler=oi.prototype.callback=oi.prototype.authorize=function(t,e){var n,i,r={},o=this.baseOptions.plugins.get("popup.authorize"),s=en.merge(this.baseOptions,["clientID","scope","domain","audience","tenant","responseType","redirectUri","_csrf","state","_intstate","nonce"]).with(en.blacklist(t,["popupHandler"]));return Je.check(s,{type:"object",message:"options parameter is not valid"},{responseType:{type:"string",message:"responseType option is required"}}),i=ue(this.baseOptions.rootUrl,"relay.html"),t.owp?s.owp=!0:(r.origin=ii(s.redirectUri),i=s.redirectUri),t.popupOptions&&(r.popupOptions=en.pick(t.popupOptions,["width","height","top","left"])),o&&(s=o.processParams(s)),(s=this.transactionManager.process(s)).scope=s.scope||"openid profile email",delete s.domain,n=this.client.buildAuthorizeUrl(s),this.getPopupHandler(t).load(n,i,r,mn(e,{keepOriginalCasing:!0}))},oi.prototype.loginWithCredentials=oi.prototype.passwordlessVerify=oi.prototype.signupAndLogin=si.create=si.prototype.login=si.prototype.getEventValidator=si.prototype.getCallbackHandler=function(t,e){return function(n){var i;i=e?"object"==y(n.event.data)&&n.event.data.hash?n.event.data.hash:n.event.data:n.sourceObject.contentWindow.location.hash,t(null,i)}},ai.prototype.login=ai.prototype.callback=ui.prototype.login=ui.prototype.signupAndLogin=ui.prototype.getSSOData=ci.prototype.parseHash=function(t,e){var n,i;e||"function"!=typeof t?t=t||{}:(e=t,t={});var r=an.getWindow(),o=void 0===t.hash?r.location.hash:t.hash;if((n=o=o.replace(/^#?\/?/,""))).hasOwnProperty("error"))return i=yn.buildResponse(n.error,n.error_description),n.state&&(i.state=n.state),e(i);if(!n.hasOwnProperty("access_token")&&!n.hasOwnProperty("id_token")&&!n.hasOwnProperty("refresh_token"))return e(null,null);var s=(this.baseOptions.responseType||t.responseType||"").split(" ");return s.length>0&&-1!==s.indexOf("token")&&!n.hasOwnProperty("access_token")?e(yn.buildResponse("invalid_hash","response_type contains `token`, but the parsed hash does not contain an `access_token` property")):s.length>0&&-1!==s.indexOf("id_token")&&!n.hasOwnProperty("id_token")?e(yn.buildResponse("invalid_hash","response_type contains `id_token`, but the parsed hash does not contain an `id_token` property")):this.validateAuthenticationResponse(t,n,e)},ci.prototype.validateAuthenticationResponse=function(t,e,n){var i=this;t.__enableIdPInitiatedLogin=t.__enableIdPInitiatedLogin||t.__enableImpersonation;var r=e.state,o=this.transactionManager.getStoredTransaction(r),s=t.state||o&&o.state||null,a=s===r;if((r||s||!t.__enableIdPInitiatedLogin)&&!a)return n({error:"invalid_token",errorDescription:"`state` does not match."});var u=t.nonce||o&&o.nonce||null,c=t.state||o&&o.appState||null,h=return e.id_token?this.validateToken(e.id_token,u,(function(t,n){return t?"invalid_token"!==t.error||"Nonce does not match."===t.errorDescription||"HS256"!==(new Jn).decode(e.id_token).header.alg?h(t):e.access_token?i.client.userInfo(e.access_token,():h({error:"invalid_token",description:"The id_token cannot be validated because it was signed with the HS256 algorithm and public clients (like a browser) can’t store secrets. Please read the associated doc for possible ways to fix this. Read more: https://auth0.com/docs/errors/libraries/auth0-js/invalid-token#parsing-an-hs256-signed-id-token-without-an-access-token"}):e.access_token&&n.at_hash?(new Jn).validateAccessToken(e.access_token,"RS256",n.at_hash})):h(null,n)})):h(null,null)},ci.prototype.validateToke},ci.prototype.renewAuth=function(t,e){var n=!!t.usePostMessage,i=t.postMessageDataType||!1,r=t.postMessageOrigin||an.getWindow().origin,o=t.timeout,s=this,a=en.merge(this.baseOptions,["clientID","redirectUri","responseType","scope","audience","_csrf","state","_intstate","nonce"]).with(t);a.responseType=a.responseType||"token",a.responseMode=a.responseMode||"fragment",a=this.transactionManager.process(a),Je.check(a,{type:"object",message:"options parameter is not valid"}),Je.check(e,{type:"function",message:"cb parameter is not valid"}),a.prompt="none",a=en.blacklist(a,["usePostMessage","tenant","postMessageDataType","postMessageOrigin"]),si.create({authenticationUrl:this.client.buildAuthorizeUrl(a),postMessageDataType:i,postMessageOrigin:r,timeout:o}).login(n,(function(t,n){if("object"==y(n))return e(t,n);s.parseHash({hash:n},e)}))},ci.prototype.checkSessio},ci.prototype.changePassword=function(t,e){return this.client.dbConnection.changePassword(t,e)},ci.prototype.passwordlessStar},ci.prototype.signu},ci.prototype.authoriz},ci.prototype.signupAndAuthoriz},ci.prototype.logi},ci.prototype.passwordlessLogi},ci.prototype.crossOriginAuthenticationCallbac},ci.prototype.crossOriginVerificatio},ci.prototype.logou},ci.prototype.passwordlessVerif},hi.prototype.buildVerifyUr},hi.prototype.star},hi.prototype.verif},pi.prototype.signu},pi.prototype.changePasswor},li.prototype.buildAuthorizeUr},li.prototype.buildLogoutUr},li.prototype.loginWithDefaultDirector},li.prototype.logi},li.prototype.oauthToke},li.prototype.loginWithResourceOwne},li.prototype.getSSODat},li.prototype.userInf},li.prototype.delegatio},li.prototype.getUserCountr},fi.prototype.getUse},fi.prototype.patchUserMetadat},fi.prototype.linkUse};var di={Authentication:li,Management:fi,WebAuth:ci,version:Ve},gi=function(t){return{clientId:t&&t.shopperToken?f:d,connection:"VP-Customers",defaultSite:"Vistaprint",domain:t&&t.shopperToken?"oauth.cimpress.io":g}}function mi(t,e){var n={domain:e.domain,clientID:e.clientId,audience:"https://api.cimpress.io/",redirectUri:window.location.origin+yi(t),responseType:"code",scope:"openid offline_access",leeway:60};return"object"===y(t)&&("string"==typeof t.clientID&&(n.clientID=t.clientID,"string"!=typeof t.domain&&(n.domain="cimpress.auth0.com")),"string"==typeof t.redirectUriOrigin&&(n.redirectUri=t.redirectUriOrigin.replace(/\/$/,"")+yi(t)),"string"==typeof t.domain&&(n.domain=t.domain),"string"==typeof t.audience&&(n.audience=t.audience),"string"==typeof t.scope&&(n.scope=t.scope)),n}var vi=function(t,e){var n=gi(e);return{developmentMode:!!t,storageTokenKey:"vp-access-token",storageRefreshKey:"vp-refresh-token",storageVerifierKey:"vp-code-verifier",oidc:mi(t,n),tokenRefreshInterval:18e5,connection:n.connection,site:n.defaultSite||"Vistaprint",anonymousEndpoint:"https://anon.oauth.cimpress.io/v0/7AeLhPS4Ab7fztoMVAchwX",cimpressAnonymousEndpoint:"https://anon.oauth.cimpress.io/v0/pA8i267E3bgjL8Tomhmrew",signOutUrl:window.location.origin,redirectAfterSignOutCallbac}}}var bi=("undefined"!=typeof window&&"function"!=typeof window.CustomEvent&&(window.CustomEvent=wi),wi}_i.prototype.publis},_i.prototype.publishUserIdentity=function(t){var e=l.parse(t);this.publish("userIdentity",{detail:{profile:e,accessToken:t,isSignedIn:!0,canonicalId:l.getCanonicalId(e),recentAnonymousIds:l.getRecentAnonymousIds(e),authorizationHeader:"Bearer ".concat(t),authorization:{type:"Bearer",token:t}}})},_i.prototype.publishAnonymousIdentity=function(t){var e=l.parse(t);this.publish("userIdentity",{detail:{profile:e,accessToken:t,isSignedIn:!1,canonicalId:l.getCanonicalId(e),authorizationHeader:"Bearer ".concat(t),authorization:{type:"Bearer",token:t}}})};var Ti=_}ki.prototype.subscribeOnce=function(t,e){this.storageChangedBound=this.storageChanged.bind(this,t,e),this.storage.addStorageChangedInOtherWindowEventListener(this.storageChangedBound)},ki.prototype.storageChanged=function(t,e,n){if(n.key===this.options.storageTokenKey){var }(n.newValue);i&&i.type===t&&(this.storage.removeStorageChangedInOtherWindowEventListener(this.storageChangedBound),e())}};var Ii,Ci=ki;function Oi(t,e,n){if(!e)throw new Error("[Session] Error: Storage layer not provided.");if(!t)throw new Error("[Session] Error: Anonymous fallback not provided.");if(!n)throw new Error("[Session] Error: Options not provided.");this.anon=t,this.storage=e,this.options=n,this.events=new Ti,this.storageNotification=new Ci(e,n),this.hasInitialEventBeenPublished=!1,this.bindedEventListenerCallback=this.eventListenerCallback.bind(this)}Oi.prototype.init=function(){if(!this.options.enableCrossSiteSso&&!k.getPresumedLoginState()){var t=this.storage.get(this.options.storageTokenKey);return t&&"user"===t.type&&this.storage.delete(this.options.storageTokenKey),this.storage.delete(this.options.storageRefreshKey),k.deleteAuthCookie(),this.anon.init(this)}this.storageNotification.subscribeOnce("anonymous",this.storageChanged.bind(this)),this.checkRefresh(),window.addEventListener("visibilitychange",this.bindedEventListenerCallback)},Oi.prototype.eventListenerCallbac},Oi.prototype.refreshPkce=function(t,e,n){var i=new XMLHttpRequest;i.onload=this.refreshTokenCallback.bind(this,i,{clientId:n,domain:e}),i.onerror=this.refreshTokenCallback.bind(this,i,{clientId:n,domain:e}),i.open("POST","https://".concat(e,"/oauth/token")),i.setRequestHeader("Content-Type","application/json"),i.send(JSON.stringify({grant_type:"refresh_token",refresh_token:t,client_id:n}))},Oi.prototype.refreshTokenCallback=function(t,e){if(this.signedOutInOtherWindow)this.signedOutInOtherWindow=null;else{if(200!==t.status)return k.deleteAuthCookie(),k.deleteSessionCookie(),k.deleteConfigCookie(),this.storage.delete(this.options.storageRefreshKey),this.options.requireSession&&k.getSessionCookie()&&S.closeSession(),this.cleanUp();var n=JSON.parse(t.response);this.options.requireSession&&k.getSessionCookie()&&S.updateSession(n.access_token),this.storage.set(this.options.storageTokenKey,"user",n.access_token),this.storage.set(this.options.storageRefreshKey,"user",n.refresh_token),k.setAuthCookie(n.refresh_token),k.setConfigCookie(e.clientId,e.domain),k.setPresumedLoginState(),this.events.publishUserIdentity(n.access_token),this.schedule()}},Oi.prototype.schedule=function(t){Ii&&clearTimeout(Ii);var e=t||this.options.tokenRefreshInterval;Ii=setTimeout(this.checkRefresh.bind(this),e)},Oi.prototype.checkRefresh=function(){if(this.signedOutInOtherWindow)this.signedOutInOtherWindow=null;else{var t=this.storage.get(this.options.storageTokenKey),e=this.storage.get(this.options.storageRefreshKey),n=k.getAuthCookie()||e&&e.value;if(n){var i=this.options.oidc.domain,r=this.options.oidc.clientID,o=k.getConfigCookie();if(o?(r=o.clientId,i=o.domain):r===f&&(r=d,i=g),t&&"anonymous"!==t.type){var s=Date.now()-t.timestamp;l.isValidToken(t.value)?(this.hasInitialEventBeenPublished||(this.events.publishUserIdentity(t.value),this.hasInitialEventBeenPublished=!0),this.schedule(this.options.tokenRefreshInterval-s>0?this.options.tokenRefreshInterval-s:this.options.tokenRefreshInterval)):this.refreshPkce(n,i,r)}else this.refreshPkce(n,i,r)}else this.cleanUp()}},Oi.prototype.cleanUp=function(){return this.sessionEnded=!0,this.hasInitialEventBeenPublished=!1,k.deletePresumedLoginState(),window.removeEventListener("visibilitychange",this.bindedEventListenerCallback),this.anon.init(this)},Oi.prototype.storageChanged=function(){this.sessionEnded?this.sessionEnded=null:(this.signedOutInOtherWindow=!0,this.hasInitialEventBeenPublished=!1,window.removeEventListener("visibilitychange",this.bindedEventListenerCallback),this.anon.init(this))};var Ei=O}function Ai(t){window.addEventListener("storage",t}var Ri={getStorage:function(){return Si()?{getItem:window.localStorage.getItem.bind(window.localStorage),setItem:window.localStorage.setItem.bind(window.localStorage),removeItem:window.localStorage.removeItem.bind(window.localStorage),addStorageChangedInOtherWindowEventListener:Ai,removeStorageChangedInOtherWindowEventListener:Ui}:null},isAvailable:Si}xi.prototype.getIte},xi.prototype.setIte},xi.prototype.removeIte},xi.prototype.addStorageChangedInOtherWindowEventListener=function(){},xi.prototype.removeStorageChangedInOtherWindowEventListene};var Di=xi;function Pi(){!0===Ri.isAvailable()?this.storage=Ri.getStorage():this.storage=new Di}Pi.prototype.set=function(t,e,n,i){if("string"!=typeof n)throw new Error("[Storage.prototype.set] Error: Value must be of type 'string'.");var r={type:e,value:n,timestamp:Date.now(),data:i},o=JSON.stringify(r);this.storage.setItem(t,o)},Pi.prototype.get=function(t){var e=this.storage.getItem(t);if(!e)return null;try{return JSON.parse(e)}catch(e){return this.storage.removeItem(t),null}},Pi.prototype.delete=function(t){this.storage.removeItem(t)},Pi.prototype.addStorageChangedInOtherWindowEventListener=function(t){this.storage.addStorageChangedInOtherWindowEventListener(t)},Pi.prototype.removeStorageChangedInOtherWindowEventListene};var Bi,ji=Pi;function Mi(t,e){if(!t)throw new Error("[AnonymousSession] Error: Storage layer not provided.");if(!e)throw new Error("[AnonymousSession] Error: Options not provided.");this.storage=t,this.options=e,this.cookies=k,this.events=new Ti,this.auth0AnonKey=e.anonymousEndpoint.split("/").pop(),this.cimpressAnonKey=e.cimpressAnonymousEndpoint.split("/").pop(),this.hasInitialEventBeenPublished=!1,this.storageNotification=new Ci(t,e)}Mi.prototype.init=function(t){this.session=t,this.storageNotification.subscribeOnce("user",this.storageChanged.bind(this)),this.checkRefresh()},Mi.prototype.checkRefresh=function(){if(this.signedInOtherWindow)this.signedInOtherWindow=null;else{var t=this.storage.get(this.options.storageTokenKey),e=this.cookies.getAnonymousIdentityState();if(e)if(t){var n=Date.now()-t.timestamp;l.isValidToken(t.value)?n>this.options.tokenRefreshInterval?this.validateAnonymousIdentity(e,t):(this.hasInitialEventBeenPublished||(this.events.publishAnonymousIdentity(t.value),this.hasInitialEventBeenPublished=!0),this.schedule(this.options.tokenRefreshInterval-n)):this.refreshAnonymousIdentity(e)}else this.refreshAnonymousIdentity(e);else this.createAnonymousIdentity()}},Mi.prototype.createAnonymousIdentity=function(){var t=new XMLHttpRequest;t.onload=this.createAnonymousIdentityCallback.bind(this,t),t.onerror=this.createAnonymousIdentityCallback.bind(this,t);var e=this.options.anonymousEndpoint;this.options.overrides&&this.options.overrides.anonToken&&(e=this.options.cimpressAnonymousEndpoint),t.open("POST",e+"/token"),t.send()},Mi.prototype.refreshAnonymousIdentity=function(t){var e=new XMLHttpRequest;e.onload=this.refreshAnonymousIdentityCallback.bind(this,e,t),e.onerror=this.refreshAnonymousIdentityCallback.bind(this,e,t);var n=t.anonKey===this.cimpressAnonKey?this.options.cimpressAnonymousEndpoint:this.options.anonymousEndpoint;e.open("POST",n+"/identities/"+t.id+"/token"),e.setRequestHeader("Content-Type","application/json"),e.send(JSON.stringify({validationKey:t.nonce}))},Mi.prototype.validateAnonymousIdentity=function(t,e){var n=new XMLHttpRequest;n.onload=this.validateAnonymousIdentityCallback.bind(this,n,e),n.onerror=this.validateAnonymousIdentityCallback.bind(this,n,e);var i=t.anonKey===this.cimpressAnonKey?this.options.cimpressAnonymousEndpoint:this.options.anonymousEndpoint;n.open("POST",i+"/identities/"+t.id+"/validate"),n.setRequestHeader("Content-Type","application/json"),n.send(JSON.stringify({validationKey:t.nonce}))},Mi.prototype.createAnonymousIdentityCallback=function(t){201===t.status?this.processTokenResponse(t.response,this.options.overrides&&this.options.overrides.anonToken?this.cimpressAnonKey:this.auth0AnonKey):(console.log("Unable to create token from Cimpress anon service. Status:"+t.status),[408,429,500,502,503,504,522,524].includes(t.status)&&this.scheduleCreateAnonymousIdentity())},Mi.prototype.refreshAnonymousIdentityCallback=function(t,e){if(200!==t.status)return console.log("Unable to refresh token from Cimpress anon service. Status:"+t.status),void this.schedule();this.processTokenResponse(t.response,e.anonKey||this.auth0AnonKey)},Mi.prototype.validateAnonymousIdentityCallback=function(t,e){204!==t.status?console.log("Unable to validate anonymous identity from Cimpress anon service. Status:"+t.status):this.events.publishAnonymousIdentity(e.value),this.schedule()},Mi.prototype.processTokenResponse=function(t,e){if(this.signedInOtherWindow)this.signedInOtherWindow=null;else{var n=JSON.parse(t),i={id:n.anonymousId,nonce:n.validationKey,value:n.anonymousToken};this.storage.set(this.options.storageTokenKey,"anonymous",i.value),this.cookies.setAnonymousIdentityState(i.id,i.nonce,e),this.schedule(),this.events.publishAnonymousIdentity(i.value)}},Mi.prototype.schedule=function(t){Bi&&clearTimeout(Bi);var e=t||this.options.tokenRefreshInterval;Bi=setTimeout(this.checkRefresh.bind(this),e)},Mi.prototype.scheduleCreateAnonymousIdentit},Mi.prototype.storageChange};var Li=Mi,qi=function(){return window.location.hash||window.location.search?(!window.location.search||-1===window.location.search.indexOf("code=")&&-1===window.location.search.indexOf("raso=")?window.location.hash:window.location.search).substring(1).split("&").reduce}),{}):{}},Ni=function(t){try{return JSON.parse(atob(decodeURIComponent(t)))}catch(e){return{redirectUrl:t}}};function Hi(t,e,n,i){var r=qi();k.setPresumedLoginState(),k.getAnonymousIdentityState()&&k.deleteAnonymousIdentityState(),n?(e.set(t.storageTokenKey,"user",n.accessToken),e.set(t.storageRefreshKey,"user",n.refreshToken),k.setAuthCookie(n.refreshToken),k.setConfigCookie(i.clientId,i.domain)):e.set(t.storageTokenKey,"user",r.access_token)}function Vi(t){console.error("[callback] Debug:redirectURL "+t),window.location=decodeURIComponent(tfunction Fi(t){if(!t)return!1;var e=t.split("-");return 2===e.length?zi(e[0])&&Wi(e[1]):3===e.length&&zi(e[0])&&!!e[1].match(/^[a-zA-Z]{4}$/)&&Wi(e[2])}var Yi={isCultureCodeValid:Fi,convertToConvention:function(t){if(!Fi(t))return t;var e=t.split("-");return 2===e.length?[e[0].toLowerCase(),e[1].toUpperCase()].join("-"):3===e.length?[e[0].toLowerCase(),e[1].charAt(0).toUpperCase()+e[1].slice(1).toLowerCase(),e[2].toUpperCase()].join("-"):void 0}};function Ji(t,e,n,i){var r={anonToken:!1,shopperToken:!1};if(200===t.status){var o=JSON.parse(t.response);o&&(o.anonToken&&o.anonToken.includes(window.location.hostname)&&(r.anonToken=!0),o.shopperToken&&o.shopperToken.includes(window.location.hostname)&&(r.shopperToken=!0))}Ki(e,n,r,i)}function Ki(t,e,n,i){(function(t,e){var n=function(t,e){if(!t)throw new Error("[@vp/auth#init] Configuration must be provided.");if(!Yi.isCultureCodeValid(t.culture))throw new Error("[@vp/auth#init] Configuration must contain a valid culture code.");if(t.options=t.options||{},null!=t.options.redirectAfterSignOutCallback&&!(t.options.redirectAfterSignOutCallback instanceof Function))throw new Error("[@vp/auth#init] redirectAfterSignOutCallback must be a function.");t.options.culture=Yi.convertToConvention(t.culture),t.options.enableCrossSiteSso=!!t.enableCrossSiteSso,t.developmentMode=t.developmentMode||!1;var n,i,r=(n=vi(t.developmentMode,e),i=t.options,"function"==typeof Object.assign?Object.assign({},n,i):[n,i].reduce((function(t,e){return null==e||Object.keys(e).forEach})),t}),{}));return t.options.clientID&&(r.oidc.clientID=t.options.clientID,t.developmentMode&&t.developmentMode.domain||(r.oidc.domain="cimpress.auth0.com")),r.overrides=e,r}(t,e),i=new ji;t.developmentMode&&function(t,e,n){var i=qi();if(n.developmentMode&&i.raso&&Vi(i.raso),window.location.origin+window.location.pathname===n.oidc.redirectUri)if(window.location.search){if(i.code&&i.state){var r=e.get(n.storageVerifierKey),o=Ni(i.state),s=o.requireSession,a=o.clientId||n.oidc.clientID,u=o.domain||n.oidc.domain;t.oauthToken({grantType:"authorization_code",clientId:a,codeVerifier:r.value,code:i.code,redirect_uri:o.redirectUrl},(function(t,i){t?console.error(t):(Hi(n,e,i,{clientId:a,domain:u}),s&&i?S.createSession(o,n,i):Vi(o.redirectUrl))}))}}else window.location.hash&&(i.access_token&&Hi(n,e),i.state&&Vi(Ni(i.state).redirectUrl))}(new di.Authentication({domain:n.oidc.domain,clientID:n.oidc.clientID,audience:n.oidc.audience,scope:"openid offline_access"}),i,n);var r=new Li(i,n),o=new Ei(r,i,n);s({options:n,storage:i,anon:r,session:o})})(t,n),window.addEventListener("userIdentity"})),Xi(e);var r=o();r.session&&r.session.init(),i&&i.askUserToLogin&&(new oe).signIn([],[],{})}function Xi(t){"function"==typeof t&&(h()?t(u()):window.addEventListener("userIdentity",(function e(n){window.removeEventListener("userIdentity",e,!1),t(n.detail)})))}console.log("@vp/auth:6.1.135");var Gi={WebAuth:oe,init:function(t,e){a()?Xi(e):function(t,e){var n;if(window.location.search&&(n=window.location.search.substring(1).split("&").reduce((function(t,e){var n=e.split("=");return t[n[0]]=n[1],t}),{})),n&&(n.overrides||n.code&&n.state)){var i={anonToken:!1,shopperToken:!1};(n.overrides||n.code&&n.state&&Ni(n.state).clientId===f)&&(i={anonToken:!0,shopperToken:!0}),Ki(t,e,i,n)}else{var r=new XMLHttpRequest;r.onload=Ji.bind(this,r,t,e,n),r.onerror=Ji.bind(this,r,t,e,n),r.open("GET","https://oauth.cimpress.io/overrides.json"),r.send(null)}}(t,e)}},$i=Gi.WebAuth,Zi=Gi.init;e.WebAuth=$i,e.default=Gi,e.init=Zi},506:(t,e,n)=>{const i=n(378),{deserialize:r,deserializeCF:o}=n(630),s="puc-ctc",a="userContext",u=()=>{const t=i.get(a);if(!t){const t=i.get(s);return t?r(t):(console.warn("ctc-reader: Context cookie are missing. If you are developing locally check the readme;)"),[])}return o(t)};function c(){try{return!!i.get(a)||!!i.get(s)}catch(t){return console.warn("ctc-reader in isAvailable failed.",t),!1}}t.exports={isTreatmentEnabled:t=>{try{return u().includes(t)}catch(t){console.warn("ctc-reader in isTreatmentEnabled failed.",t)}},getAllTreatments:()=>{try{return u()}catch(t){return console.warn("ctc-reader in getAllTreatments failed.",t),[]}},isAvailable:c,whenAvailable:function(t){const };c()?t():window.addEventListener("treatmentsResolved",e)}}},630:t=>{t.exports.deserialize=t=>t.split(",").map))).filtert)),t.exports.deserializeCF=t=>{const e=JSON.parse(decodeURIComponent(t));return e.ctc&&e.ctc.v1?e.ctc.v1:[]}},37}},e={}n.}();n(956)})();