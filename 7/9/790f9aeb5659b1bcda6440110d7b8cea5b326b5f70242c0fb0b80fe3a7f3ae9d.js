(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[659],{"+I+c":"7L9N":E02R:NS33:O2oa:function(e,t,n){"use strict";n.r(t);var o=n("QjXU"),r=n("NZpx"),a=n("NrNW"),i=n("ynVX"),c=n("MgoT");function u(e,t,n,r){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(o){return e&&t&&n&&r?[2,{jwtAuthEnabled:e.jwtAuthEnabled,getAccessToken:e.getAccessToken,officeHomeApiRoot:e.officeHomeApiRoot,officeCorrelationId:e.correlationId,inMockMode:e.inMockMode,graphApiRoot:t.graphApiRoot,userId:n.puid,loginHint:n.loginHint,loginHintEnabled:r.outgoingLoginHintEnabled}]:[2,Promise.resolve(void 0)]}))}))}var l=n("B5kz"),s=n("CaQ9"),d=n("mXGw"),f=n.n(d),p=n("P1B7"),b=n("m32Q"),_=n("lkvL"),g=n("a3FV"),v=n("CMIS"),O=n("Wa5Y"),h=n("zPk6"),m=n("gI4v"),j=n("fNDz"),N="graph-get-onenote-notebooks-api";function x(e,t){var n=this;if(e)return Object(p.a)((function(){return function(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e,n,r,a;return Object(o.__generator)(this,(function(o){return t?(e="".concat(m.b,"?orderby=lastModifiedTime%20desc"),n=t.inMockMode?t.officeHomeApiRoot:t.graphApiRoot,r=Object(j.a)(n,e,!1),a={headers:{},responseType:"json"},[2,Object(O.a)(g.a.OneNoteGraphGetNotebooksRequest,"OneNote_Graph_Get_NoteBooks",r,a,t.jwtAuthEnabled,t.getAccessToken,t.officeHomeApiRoot,t.officeCorrelationId,"Graph",{populateRequestEvent:function(e,t){t.RequestId=Object(h.a)(e)||""}},"network-first").then((function(e){return e&&e.data?Promise.resolve({value:e.data.value,fromCache:!1}):Promise.reject({clientError:"Invalid response returned for Graph OneNote Notebook request"})})).catch((function(e){return Object(v.a)({eventName:"OneNote_Graph_Get_NoteBooks_Error",errorType:"OneNote_Get_Graph_Error",message:e.httpResponse.statusText}),Promise.reject({clientError:"fetchNotebooks Error: ".concat(e.httpResponse.statusText)})}))]):[2,Promise.reject({clientError:"Invalid createNewNotebookOptions"})]}))}))}(0,e)}),(function(){return Object(b.a)({userId:e.userId,collectionName:N,collectionVersion:1,key:e.userId})}),(function(t){return Object(o.__awaiter)(n,void 0,void 0,(function(){return Object(o.__generator)(this,(function(n){return[2,Object(_.a)({userId:e.userId,collectionName:N,collectionVersion:1,key:e.userId,data:t})]}))}))}),()}var k=n("h8qh"),E=n("GuUx"),y=n("5nT3"),w=n("wt0k"),R=n("MMEL"),D=n("x3xY"),C=n("hoB/"),T=n("LWen"),I=n("X7Ji"),A=n("XxaS"),M=n("Wws9"),S=n("AcOL"),H=n("5DIn"),B=n("p/uK"),L=n("DU/N"),P=n("sLnE"),W=Object(B.a)({onenoteDialog_surface:Object(o.__assign)({width:"80%",minWidth:"240px",maxWidth:"448px",boxShadow:L.a.shadow16},P.a.padding("28px"," 32px"," 28px","32px")),onenoteDialog_title:{color:L.a.colorNeutralForeground4,fontSize:"22px",lineHeight:L.a.lineHeightBase500,fontWeight:L.a.fontWeightMedium,fontFamily:L.a.fontFamilyBase},onenoteDialog_button:Object(o.__assign)({marginLeft:"auto",display:"block"},P.a.borderRadius("2px")),onenoteDialog_input:{width:"auto",height:"28px",paddingLeft:"10px",paddingRight:"10px",top:"12px",fontSize:"12px",marginTop:"4px"},invalid_input_error:Object(o.__assign)(Object(o.__assign)({width:"auto",height:"28px"},P.a.borderColor(L.a.colorPaletteRedBorderActive)),{paddingLeft:"10px",paddingRight:"10px",top:"12px",fontSize:"12px",marginTop:"4px"}),onenoteDialog_input_error_message:{color:L.a.colorPaletteRedBorderActive,marginBottom:"5px",marginTop:"15px",minHeight:"36px",fontSize:"12px"},dialog_dismiss:Object(o.__assign)(Object(o.__assign)({marginLeft:"auto",position:"absolute",top:"0",right:"0"},P.a.padding("14px")),{marginRight:"5px",":hover":{color:L.a.colorNeutralForeground2}}),onenoteDialog_body:{display:"flex",flexDirection:"column"},onenoteDialog_input_section:{display:"flex",flexDirection:"column"},onenoteDialog_dialog_actions:{display:"flex",flexDirection:"column"}}),G=function(e){var t=e.inputDialog,n=e.createOneNoteNotebookResources,r=e.handleCreateNotebookClick,a=e.handleInput,i=e.handleDialogComponentClose,c=e.lastFocusedHtmlElement,u=W(),l=Object(o.__read)(Object(d.useState)(!0),2),s=l[0],p=l[1],b=Object(o.__read)(Object(d.useState)(!0),2),_=b[0],g=b[1],v=Object(o.__read)(Object(d.useState)(""),2),O=v[0],h=v[1],m=Object(o.__read)(Object(d.useState)(!1),2),j=m[0],N=m[1],x=Object(o.__read)(Object(d.useState)(""),2),k=x[0],B=x[1],L=Object(d.useRef)(null),P=Object(d.useRef)(null);Object(d.useEffect)((,[]);var G=Object(d.useCallback)((function(e){var t,n=e.target.value;if(n){var o=a(n);o&&o.isValid?(p(!1),j&&N(!1),B(n)):(N(!0),h(null!==(t=null==o?void 0:o.errorMessage)&&void 0!==t?t:""),s||p(!0))}else p(!0),j&&N(!1)}),[s,j,a]),V=Object(d.useCallback)((,[i]),F=Object(d.useCallback)((,[r,k]),q=Object(d.useCallback)((function(e){var t=Object(S.a)(e);if(t===H.a.Enter)switch(e.preventDefault(),t){case H.a.Enter:F()}}),[F]),z=Object(d.useCallback)((function(e){var t=Object(S.a)(e);if(t===H.a.Enter||t===H.a.Space)switch(e.preventDefault(),t){case H.a.Enter:case H.a.Space:V(),Object(M.a)(L.current,c)}}),[V,c]);return f.a.createElement(E.a,{modalType:"modal",open:_&&null!=t},f.a.createElement(y.a,{className:u.onenoteDialog_surface,id:"dialog-surface",ref:,f.a.createElement(w.a,{className:u.onenoteDialog_body},f.a.createElement(R.a,{action:"close"},f.a.createElement(D.a,{appearance:"transparent","aria-label":"close",icon:f.a.createElement(A.y,null),onClick:V,className:u.dialog_dismiss,onKeyDown:z})),f.a.createElement(C.a,{className:u.onenoteDialog_title},null==n?void 0:n.createNewBlankText),f.a.createElement(T.a,{className:u.onenoteDialog_dialog_actions},f.a.createElement("div",{id:"input-dialog-section",className:u.onenoteDialog_input_section},f.a.createElement(I.a,{placeholder:null==n?void 0:n.createNewNoteBookInputPlaceholder,id:"onenote-notebook-dialog-input-field",className:j?u.invalid_input_error:u.onenoteDialog_input,onKeyDown:q,onChange:G,ref:P}),f.a.createElement("div",{id:"input-error",className:u.onenoteDialog_input_error_message,tabIndex:j&&O?0:void 0},j&&O)),f.a.createElement(D.a,{className:u.onenoteDialog_button,appearance:s?void 0:"primary",onClick:F,disabled:!!s},null==n?void 0:n.createFileDialogButtonText)))))};t.default=function(e){var t,n=e.inputDialog,p=Object(a.a)().data,b=Object(i.a)().data,_=Object(s.a)().data,g=Object(r.a)().data,v=Object(k.a)().data,O=null==v?void 0:v.createOneNoteNotebookResources,h=Object(d.useCallback)((function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return p&&b&&_&&g?[3,1]:[2];case 1:return[4,u(p,b,_,g)];case 2:return[2,e.sent()]}}))}))}),[g,p,_,b]),m=function(){var e=this,t=Object(a.a)().data,n=Object(i.a)().data,c=Object(s.a)().data,u=Object(r.a)().data,f=Object(d.useMemo)((function(){return t&&n&&c&&u?{jwtAuthEnabled:t.jwtAuthEnabled,getAccessToken:t.getAccessToken,officeHomeApiRoot:t.officeHomeApiRoot,officeCorrelationId:t.correlationId,inMockMode:t.inMockMode,graphApiRoot:n.graphApiRoot,userId:c.puid,loginHint:c.loginHint,loginHintEnabled:u.outgoingLoginHintEnabled}:void 0}),[u,c,t,n]),p=Object(d.useMemo)((,[]),b=Object(d.useCallback)((function(){return Object(o.__awaiter)(e,void 0,void 0,(function(){return Object(o.__generator)(this,()}))}),[f,p]);return Object(l.c)(p,b,{staleTime:1/0,cacheTime:1/0,enabled:t&&n&&c&&u})}().data,j=function(e,t){if(e&&e.length){var n=[].concat([function(e){return e)?void 0:{isValid:!1,errorMessage:""}},function(e){return function(e,t){var n,r;try{for(var a=Object(o.__values)(["?","*","\\","/",":","<",">","|","'"]),i=a.next();!i.done;i=a.next())if(-1!==e.indexOf(i.value))return!1}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return!0}(e)?void 0:{isValid:!1,errorMessage:null==t?void 0:t.createNewNoteBookNameInvalidChars}},function(e){return function(e){return!e||e&&" "!==e[0]}(e)?void 0:{isValid:!1,errorMessage:null==t?void 0:t.createNewNoteBookNameCannotStartWithSpace}},function(e){return function(e,t){return e.length<=128}(e)?void 0:{isValid:!1,errorMessage:null==t?void 0:t.createNewNoteBookNameExceeds128Chars}}]);return n.push((function(n){return function(e,t,n){return void 0===n&&(n=!1),n?function(e,t){var n,r;try{for(var a=Object(o.__values)(t),i=a.next();!i.done;i=a.next()){var c=i.value;if(e.trim().toLowerCase()===c.trim().toLowerCase())return!1}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return!0}(e,t):-1===t.indexOf(e)}(n,e.map((),!0)?null:{isValid:!1,errorMessage:null==t?void 0:t.createNewNoteBookNameAlreadyExist}})),n}}(null===(t=null==m?void 0:m.result)||void 0===t?void 0:t.value,O);if(!n)return null;var N={inputDialog:n,createOneNoteNotebookResources:O,handleCreateNotebookClick:function(e){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return[4,h()];case 1:return t=o.sent(),n.onResult(e,t),Object(c.a)(),[2]}}))}))},handleInput:function(e){return function(e,t){var n,r;if(t)try{for(var a=Object(o.__values)(t),i=a.next();!i.done;i=a.next()){var c=(0,i.value)(e);if(c)return c}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return{isValid:!0,errorMessage:""}}(e,j)},handleDialogComponentClose:lastFocusedHtmlElement:n.lastFocusedHtmlElement};return f.a.createElement(G,Object(o.__assign)({},N))}},W0B4:WZgq:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var o=n("mXGw"),r=a=new WeakSet;function i(e,t){const n=r();o.useEffect((()=>a.has(n)?e():(a.add(n),void e())),t)}var c=new WeakSet;function u(e,t){return o.useMemo((()=>{const t=r();return c.has(t)?e():(c.add(t),null)}),t)}function l(e,t){var n;const r=(()&&!1,a=r?u:o.useMemo,c=r?i:o.useEffect,[l,s]=null!=(n=a((,t))?n:[null,;return c((,t),l}},Wws9:function(e,t,n){"use strict";n.d(t,"a",();var o=function(e,t){e&&e.contains(document.activeElement)&&(t?t.focus():e.blur())}}}]);
//# sourceMappingURL=vendors~onenote-ip-dialog.60b7fbd69a3b116ef2ef.chunk.v7.js.map