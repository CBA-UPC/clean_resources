(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[588],{"6oTH":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var a=new Map([["mru","Recent"],["unpinned-mru","Recent"],["pinned-mru","Pinned"],["shared-mru","Shared"],["trending-docs","Trending"],["classNotebook-mru","ClassNotebooks"],["app-items-mru","AppItems"],["app-items-forms","AppItems"],["app-items-deleted","Other"],["groupItemsForms","AppItems"],["groupItemsFormsDeleted","Other"]])},NoF4:UAwW:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var a=i("QjXU"),n=i("SQAW"),s=i("0Cfz"),r=i("2uMA"),o=i("ZO6L"),l=i("EgzG"),u=i("f0qX");ar d=function(e){eturn a.__extends(t,e),t.prototype.notifyNext=t.prototype.notifyComplete=t}(l.a)},lJPE:function(e,t,i){"use strict";i.r(t),i.d(t,"MyFormsModuleNgFactory",(function(){return _}));var a=i("keVe"),n=),s=i("fYis"),r=i("TOqr"),o=i("g/dT"),l=i("W3Zz"),u=i("hhzZ"),c=i("srvQ"),d=i("zZhH"),b=i("4/We"),p=i("hZW2"),h=i("7Gwk"),m=i("PBJH"),f=i("rmEM"),v=i("rBrS"),S=i("BaAg"),g=i("JT1q"),T=i("TDzr"),L=i("cgnd"),M=i("/I02"),I=i("iX+N"),w=(i("fUFp"),function(){function e(e,t,i,a,n,s,r,o){this.eventService=e,this.activatedRoute=t,this.locService=i,this.contextService=a,this.formsService=n,this.wacStartConfigService=s,this.capabilitiesService=r,this.clientStartupConfigService=o,this.tabListId=v.a.FormsTabList,this.appItemsForms="app-items-forms",this.appItemsTabDeleted="app-items-deleted",this.wacStartConfig=this.wacStartConfigService.config}return e.prototype.ngOnInit=function(){var e=this;this.app=S.a.fileTypeNameToFileType(this.activatedRoute.snapshot.params.app),this.formsService.onInitFormsStartPage(),this.fluentRefresh=this.capabilitiesService.capabilities.fluentRefresh,this.area=u.b.Documents,this.tabListCreatorModels=[{dataStream:this.formsService.getMyForms(!1),dataStreamResultProcessor:function(t){return new Promise((function(i){t.value?i(t.value.filter((function(e){return null!==e})).map((function(t){return Object(g.b)(t,S.a.fileTypeNameFromType(S.b.Forms)+"_item_"+t.id,S.a.fileTypeNameFromType(S.b.Forms)+"Impression",e.contextService.isRtl,e.clientStartupConfigService.config.authType,!1)}))):i()}))},dataStreamExpandableListModelCreator:function(t,i){return new f.a(t,e.locService.ShowMoreMruResultsAriaLabel,e.locService.ShowLessMruResultsAriaLabel,e.locService.ShowMoreMruResultsUpdateAriaLabel,e.locService.ShowLessMruResultsUpdateAriaLabel,e.wacStartConfig.maxInitialDocuments,1e3,i,e.capabilitiesService.capabilities.disableAnimation?"None":"FadeAndScale",{infiniteShowMoreEnabled:!1,isSmallMobileCards:!0,isEvenPadding:!0})},dataStreamTabCreator:function(t,i,a){return{id:e.appItemsForms,title:e.locService.AllFormsTabLabel,ariaLabel:e.locService.AllFormsTabLabel,listModel:i,zeroExperienceTitle:e.locService.NoAllFormsTitle,zeroExperienceSubtitle:e.locService.NoAllFormsSubtitle,zeroExperienceImage:"emptystate-icons-sprite emptystate-recent",errorTitle:e.locService.MruErrorTitle,errorSubtitle:e.locService.MruErrorSubtitle,errorImage:"emptystate-icons-sprite emptystate-error",showZeroExperience:!0,attribution:null,loaded:!1,fromCache:a,showCardsInTileView:!0,onLoad:t}}},{dataStream:this.formsService.getMyForms(!1),dataStreamResultProcessor:function(t){return new Promise((function(i){t.value?i(t.value.filter(().map((function(t){return Object(g.b)(t,S.a.fileTypeNameFromType(S.b.Forms)+"_item_"+t.id,S.a.fileTypeNameFromType(S.b.Forms)+"Impression",e.contextService.isRtl,e.clientStartupConfigService.config.authType,!1)}))):i()}))},dataStreamExpandableListModelCreator:function(t,i){return new f.a(t,e.locService.ShowMoreMruResultsAriaLabel,e.locService.ShowLessMruResultsAriaLabel,e.locService.ShowMoreMruResultsUpdateAriaLabel,e.locService.ShowLessMruResultsUpdateAriaLabel,e.wacStartConfig.maxInitialDocuments,1e3,i,e.capabilitiesService.capabilities.disableAnimation?"None":"FadeAndScale",{infiniteShowMoreEnabled:!1,isSmallMobileCards:!0,isEvenPadding:!0})},dataStreamTabCreator:function(t,i,a){return{id:e.appItemsTabDeleted,title:e.locService.RecycleBinTabLabel,ariaLabel:e.locService.RecycleBinTabLabel,listModel:i,zeroExperienceTitle:e.locService.NoDeletedFormsTitle,zeroExperienceImage:"emptystate-icons-sprite emptystate",errorTitle:e.locService.MruErrorTitle,errorSubtitle:e.locService.MruErrorSubtitle,errorImage:"emptystate-icons-sprite emptystate-error",showZeroExperience:!0,attribution:null,loaded:!1,fromCache:a,showCardsInTileView:!0,onLoad:t}}}],this.title=this.locService.MyFormsHeroTitle,this.eventService.broadcastEvent({name:"changeTitle",args:[this.title,this.title]}),this.defaultView="Card"},e}()),y=i("X+PR"),C=a.Fb({encapsulation:2,styles:[],data:{}});function E(e){return a.jc(0,[(e()(),a.Hb(0,0,null,null,5,"div",[["class","section--fluent"],["ohpInstrumentPageView","MyForms_PageView"]],null,null,null,null,null)),a.Gb(1,278528,null,0,r.i,[a.x,a.y,a.o,a.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),a.Zb(2,{"width-restrictor width-restrictor--responsive":0,"width-restrictor--no-gutter":1}),a.Gb(3,81920,null,0,o.a,[l.c,u.a],{pageName:[0,"pageName"]},null),(e()(),a.Hb(4,0,null,null,1,"ohp-editable-tab-list-wrapper",[],null,null,null,c.b,c.a)),a.Gb(5,245760,null,0,d.a,[b.a,p.a,h.a,u.a,m.a],{tabListId:[0,"tabListId"],area:[1,"area"],app:[2,"app"],defaultView:[3,"defaultView"],tabListCreatorModels:[4,"tabListCreatorModels"]},null)],(function(e,t){var i=t.component,a=e(t,2,0,!i.fluentRefresh,i.fluentRefresh);e(t,1,0,"section--fluent",a),e(t,3,0,"MyForms_PageView"),e(t,5,0,i.tabListId,i.area,i.app,i.defaultView,i.tabListCreatorModels)}),null)}var F=a.Db("ohp-my-forms-component",w,(function(e){return a.jc(0,[(e()(),a.Hb(0,0,null,null,1,"ohp-my-forms-component",[],null,null,null,E,C)),a.Gb(1,114688,null,0,w,[h.a,y.a,m.a,M.a,T.a,I.a,b.a,L.b],null,null)],(function(e,t){e(t,1,0)}),null)}),{},{},[]),A=i("xIlw"),D=i("+a0u"),x=i("lQwO"),O=i("+P5Z"),R=i("CfLe"),U=i("ej7j"),P=i("VY7U"),k=i("T/SX"),V=i("up2P"),N=i("D8EG"),z=i("D6F8"),j=i("izKO"),H=i("9InZ"),Z=i("upmJ"),G=i("NoF4"),_=a.Eb(n,[],(function(e){return a.Tb([a.Ub(512,a.k,a.hb,[[8,[s.a,F]],[3,a.k],a.D]),a.Ub(4608,r.m,r.l,[a.z]),a.Ub(1073742336,y.o,y.o,[[2,y.u],[2,y.n]]),a.Ub(1073742336,r.c,r.c,[]),a.Ub(1073742336,A.a,A.a,[]),a.Ub(1073742336,D.a,D.a,[]),a.Ub(1073742336,x.a,x.a,[]),a.Ub(1073742336,O.a,O.a,[]),a.Ub(1073742336,R.a,R.a,[]),a.Ub(1073742336,U.a,U.a,[]),a.Ub(1073742336,P.a,P.a,[]),a.Ub(1073742336,k.a,k.a,[]),a.Ub(1073742336,V.a,V.a,[]),a.Ub(1073742336,N.a,N.a,[]),a.Ub(1073742336,z.a,z.a,[]),a.Ub(1073742336,j.a,j.a,[]),a.Ub(1073742336,H.a,H.a,[]),a.Ub(1073742336,Z.a,Z.a,[]),a.Ub(1073742336,G.a,G.a,[]),a.Ub(1073742336,n,n,[]),a.Ub(1024,y.l,(,[])])}))},rBrS:srvQ:function(e,t,i){"use strict";i.d(t,"a",(function(){return X})),i.d(t,"b",(function(){return $}));var a=i("keVe"),n=i("9gjh"),s=i("7J/E"),r=i("PBJH"),o=i("/I02"),l=i("55A9"),u=i("TDzr"),c=i("7Gwk"),d=i("EYcb"),b=i("cgnd"),p=i("2lMP"),h=i("dx17"),m=i("4/We"),f=i("qCYW"),v=i("pd4Y"),S=i("W3Zz"),g=i("hZW2"),T=i("y1jW"),L=i("hhzZ"),M=i("Bc8L"),I=i("QOOv"),w=i("kfAr"),y=i("dOgD"),C=i("Z0U4"),E=i("Dpxn"),F=i("EqbI"),A=i("Uqr9"),D=i("1Bt+"),x=i("OPwp"),O=i("uNUv"),R=i("6u39"),U=i("TIi1"),P=i("Xc4i"),k=i("EUVs"),V=i("BMb5"),N=i("hoyd"),z=i("7Rc8"),j=i("DQbD"),H=i("GmnP"),Z=i("kpuN"),G=i("U8M1"),_=i("TOqr"),W=i("hjJp"),B=i("345u"),J=i("xoWf"),q=i("lrJm"),Q=i("zZhH"),X=a.Fb({encapsulation:2,styles:[],data:{}});function Y(e){return a.jc(0,[(e()(),a.Hb(0,0,null,null,3,"div",[],null,null,null,null,null)),(e()(),a.Hb(1,0,null,null,2,"ohp-mru-item",[],null,[[null,"deleteItem"],[null,"addItem"]],(,n.b,n.a)),a.bc(512,null,s.a,s.a,[r.a,o.a,l.a,u.a,c.a,d.a,b.b]),a.Gb(3,770048,null,0,p.a,[h.a,m.a,b.b,f.a,o.a,v.a,S.c,g.a,T.b,c.a,L.a,M.a,r.a,I.a,w.a,s.a,y.a,C.a,E.a,F.a,A.b,a.K,D.a,x.b,O.a,R.a,U.a,P.a,k.a,V.b,N.a,z.a,j.a,H.a,Z.b,G.a],{item:[0,"item"],index:[1,"index"],view:[2,"view"],listId:[3,"listId"],focusOnLoad:[4,"focusOnLoad"],showActivity:[5,"showActivity"],showSharing:[6,"showSharing"],showAnalytics:[7,"showAnalytics"],mruAppType:[8,"mruAppType"]},{addItem:"addItem",deleteItem:"deleteItem"})],(function(e,t){var i=t.component;e(t,3,0,t.context.item,t.context.index,t.context.itemView,t.context.listId,!i.focusOnFilter&&0===t.context.index,!1,!1,!1,i.app)}),null)}function K(e){return a.jc(0,[(e()(),a.Hb(0,0,null,null,9,"div",[],null,null,null,null,null)),a.Gb(1,278528,null,0,_.i,[a.x,a.y,a.o,a.K],{ngClass:[0,"ngClass"]},null),a.Zb(2,{"recent-tab__height-restrictor":0}),(e()(),a.Hb(3,0,null,null,1,"div",[["aria-live","polite"],["class","visually-hidden"]],null,null,null,null,null)),(e()(),a.gc(4,null,["",""])),(e()(),a.Hb(5,0,null,null,4,"ohp-tab-list",[],null,[[null,"tabClicked"]],(,W.b,W.a)),a.Gb(6,4308992,null,1,B.b,[m.a,S.c,L.a,r.a,J.a,a.h,b.b,q.b],{model:[0,"model"],columnsEnabled:[1,"columnsEnabled"],tileViewEnabled:[2,"tileViewEnabled"],listState:[3,"listState"],defaultStateNoMinHeight:[4,"defaultStateNoMinHeight"],defaultView:[5,"defaultView"],pillTabs:[6,"pillTabs"],showFilter:[7,"showFilter"],filterInput:[8,"filterInput"]},{tabClicked:"tabClicked"}),a.cc(603979776,1,{tabListItems:1}),(e()(),a.qb(0,null,null,1,null,Y)),a.Gb(9,16384,[[1,4]],0,B.c,[a.S],null,null)],(function(e,t){var i=t.component,a=e(t,2,0,!(null!=i.tabListModel.tabs[i.selectedTab].listModel&&i.tabListModel.tabs[i.selectedTab].listModel.items.length)||i.tabListModel.tabs[i.selectedTab].hasError);e(t,1,0,a),e(t,6,0,i.tabListModel,!0,!0,i.initialListState,!0,i.defaultView,i.fluentRefresh,i.tabListModel.tabs[i.selectedTab].loaded,i.onFilter)}),()}function $(e){return a.jc(0,[(e()(),a.qb(16777216,null,null,1,null,K)),a.Gb(1,16384,null,0,_.k,[a.W,a.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,1,0,i.tabListModel&&i.tabListModel.tabs&&i.tabListModel.tabs[i.selectedTab]&&i.tabListModel.tabs[i.selectedTab].listModel)}),null)}a.Db("ohp-editable-tab-list-wrapper",Q.a,(function(e){return a.jc(0,[(e()(),a.Hb(0,0,null,null,1,"ohp-editable-tab-list-wrapper",[],null,null,null,$,X)),a.Gb(1,245760,null,0,Q.a,[m.a,g.a,c.a,L.a,r.a],null,null)],(,null)}),{tabListId:"tabListId",area:"area",app:"app",defaultView:"defaultView",tabListCreatorModels:"tabListCreatorModels"},{},[])},zZhH:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var a=i("laSs"),n=i("UAwW"),s=i("zvoD"),r=(i("hZW2"),i("4/We"),i("hhzZ"),i("BaAg")),o=i("6oTH"),l=(i("7Gwk"),i("PBJH"),i("CC5A")),u=function(){eturn e.prototype.ngOnInit=function(){this.selectedTab=0,this.fluentRefresh=this.capabilitiesService.capabilities.fluentRefresh,this.setupTabs(),this.setupEventListener(),this.onFilter=this.onFilter.bind(this)},e.prototype.ngOnDestroy=e.prototype.setupEventListener=function(){var e=this;this.moveSubscription=this.eventService.events.withScope(1).pipe(Object(s.a)(()).subscribe((function(t){3===t.args[0]&&e.onDelete(t.args[1])}))},e.prototype.onTabClicked=e.prototype.onDelete=function(e){var t=this.tabListData.findIndex((function(t){return t.docId===e.item.docId})),i=this.tabListData[t],a=!0;switch(e.deleteOption){case 4:i.lastModifiedTime=new Date,i.isDeleted=!1;break;case 1:i.lastModifiedTime=new Date,i.isDeleted=!0;break;case 2:this.tabListData.splice(t,1);break;case 3:this.tabListData.splice(t,1),a=!1;break;default:return}var n=this.tabListModel.tabs[this.selectedTab].listModel.items.findIndex(();this.updateTabModels(this.tabListData,!1,!0),a&&this.setFocusOnStateChange(n)},e.prototype.onAdd=function(e){var t=this.tabListData.findIndex(();this.tabListData.splice(t,0,e.addedItem),this.updateTabModels(this.tabListData,!1,!0)},e.prototype.onFilter=function(e){if(e){var t=new RegExp(e,"i"),i=this.tabListData.filter(();this.updateTabModels(i,!1,!0),this.screenReaderText=this.locService.format(this.locService.FilterResultsFound,this.tabListModel.tabs[this.selectedTab].listModel.items.length.toString())}else this.updateTabModels(this.tabListData,!1,!0),this.screenReaderText=this.locService.NoFiltersApplied;this.focusOnFilter=!0},e.prototype.setFocusOnStateChange=function(e){var t=this;setTimeout((function(){var i,a=t.tabListModel.tabs[t.selectedTab],n=a.listModel.items;if(0===n.length)i=t.documentService.nativeDocument.getElementById("tab-list-header-link-"+a.id);else{var s=n[e<n.length?e:e-1];i=s?t.documentService.nativeDocument.getElementById(a.id+"-"+s.getId()):null}i&&i.focus()}),0)},e.prototype.updateTabModels=function(e,t,i){if(this.tabListModel&&this.tabListModel.tabs.length>=2&&this.tabListModel.tabs[0].listModel&&this.tabListModel.tabs[1].listModel){var a=this.tabListModel.tabs[0].listModel.items=e.filter(().sort(a),this.tabListModel.tabs[1].listModel.items=e.filter((function(e){return e.isDeleted})).sort(a),this.tabListModel.tabs[0].fromCache=t,this.tabListModel.tabs[1].fromCache=t,this.tabListModel.tabs[0].loaded=i,this.tabListModel.tabs[1].loaded=i}},e.prototype.setupTabs=function(){var e=this;this.tabListModel=new l.b({id:this.tabListId,area:this.area,tabs:[],logImpression:this.logTabImpression.bind(this),tabActivationAriaLabel:this.locService.MruTabActivationAriaLabel});var t=this.tabListCreatorModels[0],i=this.tabListCreatorModels[1],a=new Promise((function(a,n){var s=!1;e.tabListSubscription=t.dataStream.results.subscribe((function(r){r.fromCache&&s||(r.fromCache||(s=!0),t.dataStreamResultProcessor(r).then((function(n){e.tabListModel.tabs[0]||e.tabListModel.updateOrAddTab(t.dataStreamTabCreator(null,t.dataStreamExpandableListModelCreator([],e.logPendingTabImpression),!1)),e.tabListModel.tabs[1]||e.tabListModel.updateOrAddTab(i.dataStreamTabCreator(null,i.dataStreamExpandableListModelCreator([],e.logPendingTabImpression),!1)),e.tabListData=n,e.updateTabModels(e.tabListData,r.fromCache,!0),a()})).catch(n))})),t.dataStream.initialCompletion.then((function(e){e&&e.cacheError&&e.networkError&&n()}))}));this.tabListModel.tabs[0]||this.tabListModel.updateOrAddTab(t.dataStreamTabCreator((function(){return a}),t.dataStreamExpandableListModelCreator([],this.logPendingTabImpression),!1)),this.tabListModel.tabs[1]||this.tabListModel.updateOrAddTab(i.dataStreamTabCreator((,i.dataStreamExpandableListModelCreator([],this.logPendingTabImpression),!1)),this.tabListData=[],this.updateTabModels(this.tabListData,!1,!1)},e.prototype.logTabImpression=function(e,t,i,a,n,s){var r=this;void 0===s&&(s=l.a.Loaded);var o=e.slice(0,i);this.logOtelImpressionEvent(e,t,o,n,s),this.pendingTabImpressionEvent&&this.logPendingTabImpression();var u=this.createImpressionEvent(e,t,o,a,n,s),c=++this.tabImpressionIndex;this.pendingTabImpressionEvent={event:u,items:o,id:c},s===l.a.Loaded?this.waitOnItemInflations(o).then((function(){r.pendingTabImpressionEvent&&r.pendingTabImpressionEvent.id===c&&r.logPendingTabImpression()})):this.logPendingTabImpression()},e.prototype.logPendingTabImpression=e.prototype.waitOnItemInflations=function(e){return Object(n.a)(e.map(()).toPromise()},e.prototype.createImpressionEvent=function(e,t,i,a,n,s,o){void 0===s&&(s=l.a.Loaded);var u=i,c=r.a.distributionFromFileItems(u),d={};return d.RenderSize=(u?u.length:0).toString(),d.Distribution=c,d.ElementId=t,d.TotalSize=e.length.toString(),d.State=a,d.TabState=l.a[s],d.FromServiceWorkerCache=(!!n).toString(),void 0!==o&&(d.Index=o.toString()),this.instrumentationService.generateEvent("Mru_Impression","Generic_Impression",0,d)},e.prototype.logOtelImpressionEvent=function(e,t,i,n,s){void 0===s&&(s=l.a.Loaded);var u=i,c=s===l.a.Loaded?r.a.distributionFromFileItems(u):l.a[s],d=u?u.length:0;Object(a.a)({eventName:"Mru",area:"Documents",subArea:o.a[t],fromCache:!!n,renderSize:d,totalSize:e.length,distribution:c})},e}()}}]);
//# sourceMappingURL=officeforms-my-forms.ccaefadefd9856c379cf.chunk.v7.js.map