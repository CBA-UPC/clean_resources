(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[696],{"4+X7":function(e,r,o){"use strict";o.d(r,"b",(function(){return a})),o.d(r,"a",(function(){return s}));var t=o("PJyT");const n=()=>"_",a=(Object(t.a)((async(e,r,o)=>{const n=await Object(t.b)((r=>e.getToken(["user.read"],r)),("Consumer"===e.identityType?"https://graph.microsoft.com/beta/":"")+"me/photo/$value","GetMyPhoto",r,void 0,{signal:o},t.c);return 200===n.status?URL.createObjectURL(await n.blob()):n.status}),n),Object(t.a)((async(e,r,o,n,a)=>{const s=await Object(t.b)((r=>e.getToken(["user.readbasic.all"],r)),`users/${r}/photos/96x96/$value`,"GetUserPhoto",o,n,{signal:a},t.c);return 200===s.status?{userPrincipalName:r,pictureUrl:URL.createObjectURL(await s.blob())}:s.status}),((e,r)=>r))),s=Object(t.a)((async(e,r)=>{if("Consumer"===e.identityType)return 404;const o=await Object(t.b)((r=>e.getToken(["user.read"],r)),"organization?$select=displayName","GetMyCompanyName",r,void 0,void 0,t.c);if(200===o.status){var n,a;const e=await o.json(),r=null==e||null===(n=e.value)||void 0===n||null===(a=n[0])||void 0===a?void 0:a.displayName;if(r)return r}return o.status}),n);Object(t.a)((async(e,r,o,n)=>{const a=await Object(t.b)((r=>e.getToken(["user.readbasic.all"],r)),`users/${r}?$select=id,displayName,mail`,"GetUserDetails",o,n,void 0,t.c);if(200===a.status){const{id:e,displayName:o,mail:t}=await a.json();return{id:e,userPrincipalName:r,displayName:o,mail:t}}return a.status}),(),Object(t.a)((async(e,r,o)=>{if("Enterprise"!==r.identityType)return"";const n=await Object(t.b)((e=>r.getToken(["user.readbasic.all"],e)),`users/${e}?$select=givenName`,"GetUserGivenName",o,void 0,void 0,t.c);if(200===n.status){const{givenName:e}=await n.json();if(e)return e}return n.status}),()},"43dV":function(e,r,o){"use strict";.d(r,"a",(function(){return t}))},JC3W:function(e,r,o){"use strict";o.d(r,"a",(function(){return n})),o.d(r,"b",(function(){return a}));var t=o("5+n6");function n(e){return Object(t.a)("share.pageLinkWithoutFluidSignature",!1,e)}function a(e){return Object(t.a)("share.isResolvedUrlUsedForLocator",!1,e)}},"Kk/N":function(e,r,o){"use strict";o.r(r),o.d(r,"SharepointShareService",(function(){return h}));var t=o("p1PQ"),n=o("uAd/"),a=o("kxAM"),s=o("LpbE"),i=o("Ito+"),l=o("TVWn"),c=o("ttmr");const d=async(e,r,o,t,d)=>{const u=n.a.start(c.a.CheckDocumentAccess,t);try{var m,h;const n=Object(a.a)(r.siteUrl),p={getToken:e=>{const t={...e,siteUrl:r.siteUrl,driveId:r.driveId,itemId:r.itemId};return o.getToken([`${n}/files.readwrite.all`],t)},url:`${n}/_api/v2.1/drives/${r.driveId}/items/${r.itemId}/oneDrive.checkAccess`,tenantId:d,requestInit:{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({value:[{email:e.userPrincipalName,objectId:e.id}]})},retryPolicy:s.b,tokenPolicy:Object(s.a)(o,!1)},g=t?await Object(i.b)({...p,logger:t,nameForLogging:c.a.CheckDocumentAccess,getAdditionalProps:async(e,r)=>Object(l.a)(e)}):await Object(i.a)(p),v=await g.result.json();return u.setResult(!0),null==v||null===(m=v.value)||void 0===m||null===(h=m[0])||void 0===h?void 0:h.canWrite}catch(e){return u.setResult(!1,{errorType:c.b.CheckDocumentAccessError}),Promise.reject(e)}};var u=o("Ndf8"),m=o("dK6p");class h{ync checkUserAccess(e){let{resolvedUrl:r,userPrincipalName:o}=e;const t=Object(u.a)(this.props.bootDocumentInfo,r,this.props.logger);return d({userPrincipalName:o,name:""},t,this.props.tokenProvider,this.props.logger,this.props.tenantId)}async grantPermissions(e){let{resolvedUrl:r,userPrincipalNames:o,uxConfiguration:n}=e;const a=Object(u.a)(this.props.bootDocumentInfo,r,this.props.logger),s=this.resolveShareUXConfig(n,{shareMode:t.a.atMention});return Object(m.g)({tokenProvider:this.props.tokenProvider,logger:this.props.logger,settingsProvider:this.props.settingsProvider,localization:this.props.localization,defaultRecipients:o,...a,fileId:a.itemId,shareUXConfig:s,tenantId:this.props.tenantId,appName:this.props.appName,sharingContext:r&&this.props.getFileContext?await this.props.getFileContext(r):void 0})}async checkRecipientAccess(e){let{resolvedUrl:r,recipient:o}=e;const t=Object(u.a)(this.props.bootDocumentInfo,r,this.props.logger);return d(o,t,this.props.tokenProvider,this.props.logger,this.props.tenantId)}async grantRecipientsPermission(e){let{resolvedUrl:r,recipients:o,uxConfiguration:n}=e;const a=Object(u.a)(this.props.bootDocumentInfo,r,this.props.logger),s=this.resolveShareUXConfig(n,{shareMode:t.a.atMention}),i=o.map(();return Object(m.g)({tokenProvider:this.props.tokenProvider,logger:this.props.logger,settingsProvider:this.props.settingsProvider,localization:this.props.localization,defaultRecipients:i,...a,fileId:a.itemId,shareUXConfig:s,tenantId:this.props.tenantId,appName:this.props.appName,sharingContext:r&&this.props.getFileContext?await this.props.getFileContext(r):void 0})}async shareLink(e){let{resolvedUrl:r,componentPath:o,uxConfiguration:t}=e;const n=this.resolveShareUXConfig(t),a={tokenProvider:this.props.tokenProvider,logger:this.props.logger,settingsProvider:this.props.settingsProvider,localization:this.props.localization,shareUXConfig:n,tenantId:this.props.tenantId};if(void 0===o){const e=Object(u.a)(this.props.bootDocumentInfo,r,this.props.logger);return Object(m.g)({...a,...e,fileId:e.itemId})}const s=this.getComponentLocator(o,r);return Object(m.g)({...a,...s,sharingContext:r&&this.props.getFileContext?await this.props.getFileContext(r,o):void 0,fileId:s.itemId})}async getPermissions(e){let{resolvedUrl:r}=e;return(async(e,r,o,t)=>{const d=n.a.start(c.a.GetPermissions,o);try{if("Consumer"===r.identityType)throw new Error("Getting permissions for consumer account is not supported.");const n=Object(a.a)(e.siteUrl),c={getToken:o=>{const t={...o,siteUrl:e.siteUrl,driveId:e.driveId,itemId:e.itemId};return r.getToken([`${n}/files.readwrite.all`],t)},url:`${n}/_api/v2.1/drives/${e.driveId}/items/${e.itemId}/permissions`,tenantId:t,requestInit:{method:"GET"},retryPolicy:s.b,tokenPolicy:Object(s.a)(r)},u=o?await Object(i.b)({...c,logger:o,nameForLogging:"GetPermissions",getAdditionalProps:async(e,r)=>Object(l.a)(e)}):await Object(i.a)(c),m=await u.result.json(),h=[],p={},g=[],v=e=>{if(e.email){const r={id:e.id,name:e.displayName,userPrincipalName:e.email};p[r.userPrincipalName]||(p[r.userPrincipalName]=r)}else g.push(e.displayName)};null!=m&&m.value&&m.value.map((e=>{e.grantedTo&&v(e.grantedTo.user),e.grantedToIdentities&&e.grantedToIdentities.map((),e.link&&h.push({text:e.link.localizedDescription,scope:e.link.scope,type:e.link.type})}));const C={personas:Object.values(p),links:h,groups:g};return d.setResult(!0),C}catch(e){return d.setResult(!1,{errorType:c.b.GetPermissionsError}),Promise.reject(e)}})(Object(u.a)(this.props.bootDocumentInfo,r,this.props.logger),this.props.tokenProvider,this.props.logger,this.props.tenantId)}getComponentLocator(e,r){return{...Object(u.a)(this.props.bootDocumentInfo,r,this.props.logger),dataStorePath:e,appName:this.props.appName}}resolveShareUXConfig(e,r){var o;const t=Object(m.e)(e)?e:r;var n,a,s,i;return null!=t&&null!==(o=t.shareControl)&&void 0!==o&&o.props&&(t.shareControl.props={...t.shareControl.props,target:null!==(n=null===(a=t.shareControl.props)||void 0===a?void 0:a.target)&&void 0!==n?n:null===(s=(i=this.props).getShareUXTargetElement)||void 0===s?void 0:s.call(i)}),t}}},Ndf8:function(e,r,o){"use strict";o.d(r,"a",(function(){return s}));var t=o("ef5c"),n=o("a9wj");const a="GetDocumentInfoError",s=(e,r,o)=>{var s;if(!r)return o&&Object(t.c)(o,{eventName:a}),e;if(!Object(n.e)(r)){const r=new Error("Invalid file information: ResolvedUrl is not of the expected ODSP type");return o&&Object(t.b)(o,{eventName:a},r),e}return{driveId:r.driveId,siteUrl:r.siteUrl,itemId:r.itemId,containerPackageName:null===(s=r.codeHint)||void 0===s?void 0:s.containerPackageName}}},PJyT:function(e,r,o){"use strict";o.d(r,"c",(function(){return i})),o.d(r,"b",(function(){return l})),o.d(r,"a",(function(){return c}));var t=o("graM"),n=o("aFvx"),a=o("Ito+"),s=o("TVWn");const i={respectRetryAfterHeader:!0,maxRetries:3,filter:Object(t.c)([429,503]),backoffFn:Object(n.c)(100)};async function l(e,r,o,t,n,i,l){let c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,d=arguments.length>8?arguments[8]:void 0;const u=r.startsWith("http")?r:`https://graph.microsoft.com/v1.0/${r}`,m={getToken:e,url:u,tenantId:n,requestInit:i,retryPolicy:l,timeoutMs:c},h=t&&o?Object(a.b)({...m,logger:t,nameForLogging:o,doNotLogOnSuccess:d,getAdditionalProps:):Object(a.a)(m);return(await h).result}function c(e,r){const o=new Map;return function(){const t=r(...arguments),n=o.get(t);if(n)return n.then();const a=e(...arguments);return o.set(t,a),a.then((e=>("number"==typeof e&&200!==e&&404!==e&&o.delete(t),e)),()}}},Xq91:function(e,r,o){"use strict";o.d(r,"a",(function(){return t}));const t=(e,r)=>{if(void 0!==e&&void 0!==r)return e-r}},dK6p:function(e,r,o){"use strict";o.d(r,"g",(function(){return Ne})),o.d(r,"h",(function(){return Ie})),o.d(r,"f",(function(){return Se})),o.d(r,"e",(function(){return Oe})),o.d(r,"c",(function(){return Te})),o.d(r,"a",(function(){return je})),o.d(r,"b",(function(){return Fe})),o.d(r,"d",(function(){return we}));var t=o("mXGw"),n=o("xARA"),a=o("A3AF"),s=o("j7+w"),i=o("xg6W"),l=o("D317"),c=o("kxAM"),d=o("a9wj"),u=o("4+X7"),m=o("ki/R"),h=o("43dV"),p=o("p1PQ"),g=o("VORP");const v="--colorNeutralForeground1",C="--colorNeutralForeground1Hover",f="--colorNeutralForeground1Selected",k="--colorNeutralForeground2Hover",P="--colorNeutralForeground3",B="--colorNeutralForeground4",b="--colorNeutralForegroundDisabled",y="--colorBrandForegroundLink",N="--colorBrandForegroundLinkHover",I="--colorNeutralForegroundOnBrand",S="--colorNeutralBackground1",O="--colorNeutralBackground1Hover",T="--colorNeutralBackground1Pressed",j="--colorNeutralBackground1Selected",F="--colorNeutralBackground2",w="--colorNeutralBackgroundDisabled",x="--colorBrandBackground",L="--colorBrandBackgroundHover",D="--colorBrandBackgroundPressed",E="--colorCompoundBrandBackground",U="--colorCompoundBrandBackgroundHover",H="--colorBrandBackgroundInvertedSelected",A="--colorNeutralStrokeAccessible",M="--colorNeutralStrokeAccessibleHover",R="--colorNeutralStroke1",G="--colorNeutralStroke2",$="--colorCompoundBrandStroke",z="--colorNeutralStrokeDisabled",W="--ms-themeColorDisabledBodySubtext",X="--ms-themeColorPaletteThemeDarker",V="--ms-themeColorPaletteThemeDark",J="--ms-themeColorPaletteThemeDarkAlt",q="--ms-themeColorPaletteThemePrimary",Q="--ms-themeColorPaletteThemeSecondary",_="--ms-themeColorPaletteThemeLight",K="--ms-themeColorPaletteThemeLightAlt",Y="--ms-themeColorPaletteNeutralPrimary",Z="--ms-themeColorPaletteNeutralSecondary",ee="--ms-themeColorPaletteNeutralTertiaryAlt",re="--ms-themeColorPaletteNeutralQuaternary",oe="--ms-themeColorPaletteNeutralQuaternaryAlt",te="--ms-themeColorPaletteNeutralLight",ne="--ms-themeColorPaletteNeutralLighter",ae="--ms-themeColorPaletteNeutralLighterAlt",se="--ms-themeColorPaletteWhite",ie=new Map([[v,Y],[C,Y],["--colorNeutralForeground1Pressed",Y],[f,Y],["--colorNeutralForeground2",Z],[k,Y],["--colorNeutralForeground2Pressed",Y],["--colorNeutralForeground2Selected",Y],["--colorNeutralForeground2BrandHover",q],["--colorNeutralForeground2BrandPressed",J],["--colorNeutralForeground2BrandSelected",q],[P,"--ms-themeColorPaletteNeutralTertiary"],["--colorNeutralForeground3Hover",Z],["--colorNeutralForeground3Pressed",Z],["--colorNeutralForeground3Selected",Z],["--colorNeutralForeground3BrandHover",q],["--colorNeutralForeground3BrandPressed",J],["--colorNeutralForeground3BrandSelected",q],[B,re],[b,ee],[y,J],[N,V],["--colorBrandForegroundLinkPressed",X],["--colorBrandForegroundLinkSelected",J],["--colorCompoundBrandForeground1",q],["--colorCompoundBrandForeground1Hover",J],["--colorCompoundBrandForeground1Pressed",V],["--colorBrandForeground1",q],["--colorBrandForeground2",J],["--colorNeutralForeground1Static",Y],["--colorNeutralForegroundInverted",se],["--colorNeutralForegroundInvertedHover",se],["--colorNeutralForegroundInvertedPressed",se],["--colorNeutralForegroundInvertedSelected",se],[I,se],["--colorNeutralForegroundInvertedLink",se],["--colorNeutralForegroundInvertedLinkHover",se],["--colorNeutralForegroundInvertedLinkPressed",se],["--colorNeutralForegroundInvertedLinkSelected",se],["--colorBrandForegroundInverted",Q],["--colorBrandForegroundInvertedHover","--ms-themeColorPaletteThemeTertiary"],["--colorBrandForegroundInvertedPressed",Q],["--colorBrandForegroundOnLight",q],["--colorBrandForegroundOnLightHover",J],["--colorBrandForegroundOnLightPressed",V],["--colorBrandForegroundOnLightSelected",V],[S,se],[O,ne],[T,oe],[j,te],[F,ae],["--colorNeutralBackground2Hover",ne],["--colorNeutralBackground2Pressed",oe],["--colorNeutralBackground2Selected",te],["--colorNeutralBackground3",ne],["--colorNeutralBackground3Hover",te],["--colorNeutralBackground3Pressed",re],["--colorNeutralBackground3Selected",oe],["--colorNeutralBackground4",ne],["--colorNeutralBackground4Hover",ae],["--colorNeutralBackground4Pressed",ne],["--colorNeutralBackground4Selected",se],["--colorNeutralBackground5",te],["--colorNeutralBackground5Hover",ne],["--colorNeutralBackground5Pressed",ne],["--colorNeutralBackground5Selected",ae],["--colorNeutralBackground6",te],["--colorNeutralBackgroundInverted",Z],["--colorSubtleBackgroundHover",ne],["--colorSubtleBackgroundPressed",oe],["--colorSubtleBackgroundSelected",te],[w,ne],["--colorNeutralStencil1",te],["--colorNeutralStencil2",ae],[x,q],[L,J],[D,X],["--colorBrandBackgroundSelected",V],[E,q],[U,J],["--colorCompoundBrandBackgroundPressed",V],["--colorBrandBackgroundStatic",q],["--colorBrandBackground2",K],["--colorBrandBackgroundInverted",se],["--colorBrandBackgroundInvertedHover",K],["--colorBrandBackgroundInvertedPressed",_],[H,"--ms-themeColorPaletteThemeLighter"],[A,Z],[M,Z],["--colorNeutralStrokeAccessiblePressed",Z],["--colorNeutralStrokeAccessibleSelected",q],[R,re],["--colorNeutralStroke1Hover",ee],["--colorNeutralStroke1Pressed",ee],["--colorNeutralStroke1Selected",ee],[G,oe],["--colorNeutralStroke3",ne],["--colorNeutralStrokeOnBrand",se],["--colorNeutralStrokeOnBrand2",se],["--colorNeutralStrokeOnBrand2Hover",se],["--colorNeutralStrokeOnBrand2Pressed",se],["--colorNeutralStrokeOnBrand2Selected",se],["--colorBrandStroke1",q],["--colorBrandStroke2",_],[$,q],["--colorCompoundBrandStrokeHover",J],["--colorCompoundBrandStrokePressed",V],[z,oe],["--ms-themeColorAccentButtonBackground",x],["--ms-themeColorAccentButtonText",I],["--ms-themeColorActionLink",v],["--ms-themeColorActionLinkHovered",C],["--ms-themeColorBodyBackground",S],["--ms-themeColorBodyBackgroundChecked",j],["--ms-themeColorBodyBackgroundHovered",O],["--ms-themeColorBodyDivider",G],["--ms-themeColorBodyFrameBackground",S],["--ms-themeColorBodyFrameDivider",G],["--ms-themeColorBodyStandoutBackground",F],["--ms-themeColorBodySubtext",P],["--ms-themeColorBodyText",v],["--ms-themeColorBodyTextChecked",f],["--ms-themeColorButtonBackground",S],["--ms-themeColorButtonBackgroundChecked",j],["--ms-themeColorButtonBackgroundCheckedHovered",O],["--ms-themeColorButtonBackgroundDisabled",w],["--ms-themeColorButtonBackgroundHovered",O],["--ms-themeColorButtonBackgroundPressed",T],["--ms-themeColorButtonBorder",R],["--ms-themeColorButtonBorderDisabled",z],["--ms-themeColorButtonText",v],["--ms-themeColorButtonTextChecked",v],["--ms-themeColorButtonTextCheckedHovered",v],["--ms-themeColorButtonTextDisabled",b],["--ms-themeColorButtonTextHovered",v],["--ms-themeColorButtonTextPressed",v],["--ms-themeColorCardStandoutBackground",S],["--ms-themeColorDefaultStateBackground",F],["--ms-themeColorDisabledBackground",w],[W,b],[W,b],["--ms-themeColorDisabledBorder",z],["--ms-themeColorDisabledSubtext",b],["--ms-themeColorDisabledText",b],["--ms-themeColorFocusBorder","--colorStrokeFocus2"],["--ms-themeColorInputBackground",S],["--ms-themeColorInputBackgroundChecked",E],["--ms-themeColorInputBackgroundCheckedHovered",U],["--ms-themeColorInputBorder",A],["--ms-themeColorInputBorderHovered",M],["--ms-themeColorInputFocusBorderAlt",$],["--ms-themeColorInputForegroundChecked",I],["--ms-themeColorInputIcon",P],["--ms-themeColorInputIconDisabled",b],["--ms-themeColorInputIconHovered",P],["--ms-themeColorInputPlaceholderBackgroundChecked",H],["--ms-themeColorInputPlaceholderText",B],["--ms-themeColorInputText",v],["--ms-themeColorInputTextHovered",C],["--ms-themeColorLink",y],["--ms-themeColorLinkHovered",N],["--ms-themeColorListBackground",S],["--ms-themeColorListHeaderBackgroundHovered",O],["--ms-themeColorListHeaderBackgroundPressed",T],["--ms-themeColorListItemBackgroundChecked",j],["--ms-themeColorListItemBackgroundCheckedHovered",j],["--ms-themeColorListItemBackgroundHovered",O],["--ms-themeColorListText",v],["--ms-themeColorListTextColor",v],["--ms-themeColorMenuBackground",S],["--ms-themeColorMenuDivider",G],["--ms-themeColorMenuHeader",P],["--ms-themeColorMenuIcon",v],["--ms-themeColorMenuItemBackgroundChecked",S],["--ms-themeColorMenuItemBackgroundHovered",O],["--ms-themeColorMenuItemBackgroundPressed",O],["--ms-themeColorMenuItemText",v],["--ms-themeColorMenuItemTextHovered",k],["--ms-themeColorMessageLink",y],["--ms-themeColorMessageLinkHovered",N],["--ms-themeColorMessageText",v],["--ms-themeColorPrimaryButtonBackground",x],["--ms-themeColorPrimaryButtonBackgroundDisabled",w],["--ms-themeColorPrimaryButtonBackgroundHovered",L],["--ms-themeColorPrimaryButtonBackgroundPressed",D],["--ms-themeColorPrimaryButtonBorder","--colorTransparentStroke"],["--ms-themeColorPrimaryButtonText",I],["--ms-themeColorPrimaryButtonTextDisabled",b],["--ms-themeColorPrimaryButtonTextHovered",I],["--ms-themeColorPrimaryButtonTextPressed",I]]),le="--ms-themeColorPalette",ce="--ms-themeColor";function de(e,r){const o=e.substring(r.length);return`${o.substring(0,1).toLowerCase()}${o.substring(1)}`}const ue=var me=o("ttmr"),he=o("xcVN"),pe=o("VMWk");const ge=function ve(e){return async function(e,r){const o=await e(r);return Object(pe.a)(o,r)}(ge,e)}var Ce=o("Xq91"),fe=o("ef5c"),ke=o("uAd/");function Pe(e,r){return{payloadLoadStartTime:Object(Ce.a)(e.payloadLoadStartTime,r),payloadLoadEndTime:Object(Ce.a)(e.payloadLoadEndTime,r),payloadSendStartTime:Object(Ce.a)(e.payloadSendStartTime,r),sharePointLoadStartTime:Object(Ce.a)(e.sharePointLoadStartTime,r)}}const Be=/^var\((--[\w-]+)(?:,.*)?\)$/;function be(e,r){if(r)return Object.fromEntries(Object.entries(r).map((r=>{let[o,t]=r;const n=o;let a=t;const s=Be.exec(t);if(s){const[,r]=s;a=e().getPropertyValue(r)}return[n,a]})))}var ye=o("y5lx");function Ne(e){let{shareUXConfig:r,tokenProvider:s,fileId:c,driveId:d,siteUrl:u,localization:m,logger:h,settingsProvider:v,defaultRecipients:C,dataStorePath:f,appName:k,containerPackageName:P,sharingContext:B,correlationId:b}=e;const y={},N=new i.a,I=new i.a,S=(null==r?void 0:r.shareMode)||p.a.default,O=b||Object(a.a)();h&&function(e,r,o,t,n,a){const s=r);Object(fe.c)(e,{eventName:me.c.ShareDialogOpened,entrypoint:s,sharePointCorrelationId:a}),t.then((r=>{Object(fe.a)(e,{eventName:me.a.CompleteShare,succeeded:!0,shared:r,entrypoint:s,sharePointCorrelationId:a}),r&&Object(fe.d)(e,{eventName:me.d.ShareDocument,entrypoint:s})})).catch((r=>{Object(fe.a)(e,{eventName:me.a.CompleteShare,succeeded:!1,entrypoint:s,sharePointCorrelationId:a,errorType:r.errorType||me.b.UnknownShareError,spoError:r.spoError,spoErrorCategory:r.spoErrorCategory},r)}));const i=ke.a.start(me.a.RenderShare,e);o.then((e=>{i.setResult(!0,{rendered:e,entrypoint:s,sharePointCorrelationId:a,...Pe(n,i.startTime)})})).catch((e=>{i.setResult(!1,{entrypoint:s,sharePointCorrelationId:a,errorType:e.errorType||me.b.UnknownShareError,spoError:e.spoError,spoErrorCategory:e.spoErrorCategory,...Pe(n,i.startTime)},e)}))}(h,S,I,N,y,O),Object(l.b)(25e3,[I,N]).then((e=>{if(e){const e=new he.a(me.b.IframeLoadTimeoutError);Se(I,N,e)}})).catch(();try{var T,j;y.payloadLoadStartTime=performance.now();let{theme:e,themeProperties:a,target:i}=null!==(T=null==r||null===(j=r.shareControl)||void 0===j?void 0:j.props)&&void 0!==T?T:{theme:void 0,themeProperties:void 0};!e&&a&&(e=function(e){const r=e?function(e){const r=[];for(let o of e){r.push({name:o.name,value:o.value});const e=ie.get(o.name);e&&void 0===r.find(()&&r.push({name:e,value:o.value})}return r}(e):void 0,o={},t={},n=Object(g.a)(),a=(e,r)=>{if(e.startsWith(le)){const t=function(e){const r="--ms-themeColorPaletteShared",o="--ms-themeColorPaletteAccent";return e.startsWith(r)?de(e,r):e.startsWith(o)?de(e,o):e.startsWith(le)?de(e,le):void 0}(e);void 0!==t&&n.palette.hasOwnProperty(t)&&!o[t]&&(o[t]=r)}else if(e.startsWith(ce)){const o=de(e,ce);o&&n.semanticColors.hasOwnProperty(o)&&!t[o]&&(t[o]=r)}};if(r)for(let e of r)a(e.name,e.value);return Object(g.a)({palette:o,semanticColors:t})}(a),r.shareControl.props.theme=e);const{shareControl:l,setFocusOnDismiss:p}=null!=r?r:{shareControl:void 0,setFocusOnDismiss:void 0},b=()=>{!function(e,r,o){e.resolve(!1),r.resolve(!1)}(I,N),null==p||p()},F=i||document.createElement("div");if("Callout"===(null==l?void 0:l.type)){const e=t.lazy((()=>async function(e){const[r,n]=await Promise.all([ve(e),Promise.all([o.e(97),o.e(602)]).then(o.bind(null,"WtYk"))]);return{default:e=>t.createElement(n.ShareCalloutRenderer,{stringTable:r,...e})}}(m.locale))),a=O;n.render(t.createElement(t.Suspense,{fallback:t.createElement(ue,null)},t.createElement(e,{onRenderPromise:I,onCompletePromise:N,onDismissCallout:b,perfMarks:y,localization:m,calloutProps:l.props,showShareProps:{shareUXConfig:r,tokenProvider:s,fileId:c,driveId:d,siteUrl:u,localization:m,logger:h,settingsProvider:v,defaultRecipients:C,dataStorePath:f,appName:k,correlationId:a,containerPackageName:P,sharingContext:B}})),F)}else{const e=t.lazy((()=>async function(e){const[r,n]=await Promise.all([ve(e),Promise.all([o.e(97),o.e(603)]).then(o.bind(null,"F8Hw"))]);return{default:e=>t.createElement(n.ShareDialogRenderer,{stringTable:r,...e})}}(m.locale))),a=O;n.render(t.createElement(t.Suspense,{fallback:t.createElement(ue,null)},t.createElement(e,{onRenderPromise:I,onCompletePromise:N,onDismissDialog:b,perfMarks:y,shareMode:S,localization:m,dialogProps:null==l?void 0:l.props,showShareProps:{shareUXConfig:r,tokenProvider:s,fileId:c,driveId:d,siteUrl:u,localization:m,logger:h,settingsProvider:v,defaultRecipients:C,dataStorePath:f,appName:k,correlationId:a,containerPackageName:P,sharingContext:B}})),F)}}catch(e){Se(I,N,e)}return N}function Ie(e,r,o){const[n,a]=t.useState(new i.a);return t.useEffect((()=>{const t=document.createElement("div");document.body.append(t);const n=function(e,r){let o;const t=()=>(o||(o=getComputedStyle(e)),o);return{palette:be(t,r.palette),semanticColors:be(t,r.semanticColors)}}(t,r?Object(s.a)(e,r):e);t.remove(),a(function(e,r){var o;return async function(e,r,o,t,n,a,s,i,l,p,g,v,C,f,k){if(!n||!t||!o)throw new he.a(me.b.GeneratePayloadError,"File information is missing");if("UnauthenticatedGuest"===r.identityType)throw new he.a(me.b.GeneratePayloadError,"UnauthenticatedGuest user is not allowed to use share functionality");const P="Consumer"===r.identityType,B=Object(c.a)(n),[b,y,N]=await Promise.all([Object(d.a)(r,n,t,o,s,a),r.getToken([`${B}/files.readwrite.all`],{tenantId:a}),P?Promise.resolve(""):Object(u.a)(r,s)]);if(!b||!b.webDavUrl||!b.name)throw new he.a(me.b.GeneratePayloadError,"Failed to fetch file info");const I=void 0!==p?{siteUrl:n,driveId:t,itemId:o,dataStorePath:p,appName:g,containerPackageName:v,context:C}:void 0,S={mode:e,authToken:y.token,clientId:"fluid",itemName:b.name,itemExtension:"fluid",isFolder:!1,isODB:B.indexOf(`${m.a}.`)>0,organizationName:Object(h.a)(N)?"":N,webAbsoluteUrl:n,correlationId:i,navId:void 0!==I?Object(ye.a)(I,{includeFluidSignature:Object(ye.b)(I,k)}):void 0,listId:b.sharepointIds.listId,listItemId:b.sharepointIds.listItemId,theme:f};return l&&(S.defaultRecipients=l,S.accessChecked=!0),JSON.stringify(S)}((null===(o=e.shareUXConfig)||void 0===o?void 0:o.shareMode)||p.a.default,e.tokenProvider,e.fileId,e.driveId,e.siteUrl,e.localization.locale,e.logger,e.correlationId,e.defaultRecipients,e.dataStorePath,e.appName,e.containerPackageName,e.sharingContext,r,e.settingsProvider)}(o,n))}),[e,r,o]),n}function Se(e,r,o){e.reject(o),r.reject(o)}onst Te=320,je=500,Fe=350;,p1PQ:ttmr:function(e,r,o){"use strict";var t,n,a,s;o.d(r,"d",(function(){return t})),o.d(r,"a",(function(){return n})),o.d(r,"b",(function(){return a})),o.d(r,"c",(function(){return s})),function(e){e.ShareDocument="ShareDocument"}(t||(t={})),n||(n={})),a||(a={})),s||(s={}))},xcVN:function(e,r,o){"use strict";var t;o.d(r,"a",(function(){return n})),t||(t={}));class n extends Error{constructor(e,r,o,t,n){super(r||e),this.errorType=e,this.debugErrorMessage=o,this.spoError=t,this.spoErrorCategory=n}}},y5lx:function(e,r,o){"use strict";o.d(r,"b",(function(){return a})),o.d(r,"a",();var t=o("ZaV9"),n=o("JC3W");function a(e,r){return!Object(n.a)(r)||"@fluidx/loop-page-container"!==e.containerPackageName||!e.context}function s(e,r){const o=Object(t.a)(e);if(r.includeFluidSignature)return o;const n=new URLSearchParams(atob(o));return n.delete("fluid"),btoa(n.toString())}}}]);
//# sourceMappingURL=696.ab699bc1050456b9b46c.chunk.v7.js.map