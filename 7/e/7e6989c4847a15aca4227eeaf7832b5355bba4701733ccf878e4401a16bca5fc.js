(()=>{ar t=n=/(\/b|\/s|\/l).*(node=)(\d{1,12})/,a=new Map,i=function(){if(!a.has(window.location.href)){var e=n.exec(window.location.href),t=e&&e[3]?e[3]:null;a.set(window.location.href,t)}return a.get(window.location.href)},o=function(e){var t=i();if(!e||!t)return null;var n=e.split(":");return n.splice(n.length-1,0,t),n.join(":")},s=function(e){var t=i();return t?"".concat(e,":").concat(t):null},r={wb:"ues",bb:"uet",af:"uet",cf:"uet",be:"uet",ld:"uex"},d=function(e){var n,a,i=e.latencyEvent,r=e.scope,d=e.placement,p=e.timestamp;c(i)&&(l(i,m(r),d.id,p),l(i,m(r),t(d.name),p),l(i,m(r),null!==(n=o(d.name))&&void 0!==n?n:void 0,p),l(i,m(r),null!==(a=s(d.id))&&void 0!==a?a:void 0,p))},c=l=function(e,t,n,a){void 0===a&&(a=new Date);var i=r[e];n&&"function"==typeof window[i]&&window[i](e,t+n,{wb:1},a)},m=p=h=function(e,n,a){if(void 0===a&&(a=1),w()){var i=function(e,t,n){t&&v("".concat(g(e),":").concat(t),n)};i(e,n.id,a),i(e,s(n.id),a),i(e,t(n.name),a),i(e,o(t(n.name)),a)}},u=function(e,t){void 0===t&&(t=1),w()&&v(g(e),t)},w=function(){var e;return"function"==typeof(null===(e=null===window||void 0===window?void 0:window.ue)||void 0===e?void 0:e.count)},v=function(e,t){var n;return null===(n=null===window||void 0===window?void 0:window.ue)||void 0===n?void 0:n.count(e,t)},f="adplacements",g=function(e){return e.startsWith(f)?e:"".concat(f,":").concat(e)},y=function(e,t){S("ERROR",e,t)},b=S=function(e,t,n){console.error(t,I(t,n)),u("safeFrameError"),window.ueLogError&&window.ueLogError(I(t,n),{logLevel:e,attribution:"APE-safeframe",message:A(t,n)+" | "})},I=function(e,t){return t instanceof Error?t:t?new Error(t):new Error(e)},A=function(e,t){return t instanceof Error?e+": "+t.message:e},M=function(e,t,n){if(window.csa)try{window.csa("Content",{element:e})("mark",t,null==n?void 0:n.getTime())}catch(a){y("Error with 'mark' CSA",a)}};class E{sendLatencyMetric({latencyMetricType:e,placementId:t,placementName:n,placementDivId:a,timestamp:i}){d({latencyEvent:e.csmKey,scope:e.csmMessage,placement:{id:t,name:n},timestamp:i}),M(document.getElementById(a),e.csaKey,i)}}const D=var k=function(e,t,n){if(""===t)throw new Error("Invalid queryParamKey input to addJSONQueryParamToURL: "+JSON.stringify({queryParamKey:t}));var a=new URL(e),i=a.searchParams.get(t),o=i||"{}",s=JSON.parse(o),r=Object.assign(s,n);return a.searchParams.set(t,JSON.stringify(r)),a.toString()};onst L="com.amazon.ads.cpp.",x=onst N=C=z=/^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)?$/,R=e=>z.test(e),F=H=e=>btoa(unescape(encodeURIComponent(e))),O=W=$=B=U=()=>window.innerHeight||document.documentElement.clientHeight,j=q=e=>e.getBoundingClientRect().top-U(),V=(e,t)=>({t:e.top,l:e.left,r:e.right,b:e.bottom,w:e.width,h:e.height,z:t}),J=e=>{const t=e.getBoundingClientRect();return V(t,Number(window.getComputedStyle(e,null).zIndex))},Y=e=>{const t=Z(e);return{t:e.t,l:e.l,r:e.r,b:e.b,w:e.w,h:e.h,z:e.z,xiv:t.xiv,yiv:t.yiv,iv:t.iv}},X=()=>{const e=window.screenY?window.screenY:window.screenTop,t=window.screenX?window.screenX:window.screenLeft,n=j(),a=U();return{t:e,l:t,w:n,h:a,b:e+a,r:t+n}},K=G=e=>{const t=function(e){const t=document.body.getBoundingClientRect();if(Q(t))return null;const n=J(e),a=U(),i=j(),o=Math.max(0,Math.min(t.left+i,n.r)-n.l),s=Math.max(0,Math.min(t.top+a,n.b)-n.t),r=o*s/(n.h*Math.min(n.w,i));return Number(Math.min(1,Math.max(0,r)).toFixed(2))}(e);return null==t?"unknown":t>=.5},Q=const Z=e=>{const t=j(),n=U(),a=Math.max(0,ae(e.t,e.b,n)),i=Math.max(0,ae(e.l,e.r,t)),o=a*i,s=e.h*Math.min(e.w,t);return 0!==s||0!==o?{xiv:Number(Math.min(1,i/e.w).toFixed(2)),yiv:Number(Math.min(1,a/e.h).toFixed(2)),iv:Number(Math.min(1,Math.max(0,o/s)).toFixed(2))}:{xiv:0,yiv:0,iv:0}},ee=e=>{const t=e.getBoundingClientRect();return te(t)},te=e=>({t:e.top,l:e.left,r:j()-e.right,b:U()-e.bottom,xs:Math.max(document.body.scrollWidth,document.documentElement.scrollWidth)>j()?1:0,yx:Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)>U()?1:0}),ne=ae=(e,t,n)=>{let a=0;return"visible"!==document.visibilityState?a:(a=e>0?n-e:t>0?Math.min(t,n):0,Math.min(a,t-e))},ie=oe=se=re="localstorage_impression",de=(e,t)=>{const n=document.createElement("img");return n.id=e,n.style.display="none",n.setAttribute("pixel-url",t),n},ce="localstorage:impression",le=var me;me=const pe="sfImpression",he="LightAdImpression",ue="viewablelatency",we=ve=we("bodyBegin","bb",pe),fe=(we("bodyBegin","bb",he),we("bodyEnd","be"),we("clickToATF","af"),we("criticalFeature","cf")),ge=(we("criticalFeature","cf",pe),we("criticalFeature","cf",he),we("loaded","ld"),we("loaded","ld",pe),we("loaded","ld",he),we("viewablelatency:bodyBegin","bb",ue)),ye=we("viewablelatency:loaded","ld",ue),be=e=>null==e?void 0:e.replace("criticalFeature","").replace("windowOnLoad","").replace("spATFEvent","").replace("r2OnLoad","").replace("aboveTheFold","").replace("af",""),Se=Ie=Ae=Me=Ee=(e,t,n,a,i,o)=>{const s=null==e?void 0:e[t];(null==s?void 0:s.valid)&&(s.loaded=!0,s.viewed&&(D().sendLatencyMetric({latencyMetricType:ye,placementId:a,placementName:n,placementDivId:i,timestamp:new Date(o)}),h("htmlviewed:loaded",{id:a,name:n})))},De=var ke=function(e){if(window.csa)try{window.csa("Events",{producerId:"adplacements"})("setEntity",{adCreativeMetaData:e})}catch(t){y("Error with 'setEntity' CSA",t)}},Te=function(e,t,n){if(void 0===n&&(n=1),window.csa)try{window.csa("Events",{producerId:"adplacements"})("log",{schemaId:"ApeSafeframe.csaEvent.1",metricName:e+":"+t.name+":"+t.id,metricValue:n},{ent:"all"})}catch(a){y("Error with 'logCsaEvent' CSA",a)}},Le=function(e,t){if(void 0===t&&(t=1),window.csa)try{window.csa("Events",{producerId:"adplacements"})("log",{schemaId:"ApeSafeframe.csaEvent.1",metricName:e,metricValue:t},{ent:"all"})}catch(n){y("Error with 'incrementCounter' CSA",n)}};const xe=Pe=_e=Ne=Ce=ze=Re=Fe=He=Oe=We=$e=Be=e=>e.length>1&&"%"===e.charAt(e.length-1),Ue=const je=(e,t)=>{for(const n of Object.keys(t))e.style[n]=t[n];return e},qe=Ve=Je=Ye=(e,t)=>document.getElementById(t[e].placementDivId),Xe=Ke=Ge=Qe=Ze="expanded-feedback-label",et="expanded-safeframe",tt="expandable-ads-styles",nt=at=it=ot=st=rt=dt=ct=lt=lass pt{nstructor(e){this.parentHtmlId=e}}onst ut=wt="adfeedback_request",vt="adfeedback_success",ft="adfeedback_error",gt="adfeedback_sponsoredlabelrendered_creative",yt="adfeedback_sponsoredlabelrendered_host",bt="adfeedback:request",St="adfeedback:success",It="adfeedback:error",At="adfeedback:sponsoredlabelrendered:creative",Mt="adfeedback:sponsoredlabelrendered:host",Et="adfeedback:sponsoredlabelrendered",Dt="adfeedback:transparencyinfo:missing";class kt{request(){h(bt,this.placement),u(bt),Te(wt,this.placement)}success(){h(St,this.placement),u(St),Te(vt,this.placement)}error(){h(It,this.placement),Te(ft,this.placement)}labelRenderedCreative(){h(At,this.placement),u(Et),Te(gt,this.placement)}labelRenderedHost(){h(Mt,this.placement),u(Et),Te(yt,this.placement)}transparencyInfoMissing(){h(Dt,this.placement),u(Dt)}constructor(e){this.placement=e}}class Tt{ass xt{appendChildTo(e,t){var n,a;function i(e){const t=document.createElement("div");return t.setAttribute("id",e.getHtmlId()),n(t,e.feedbackStyle),t.append(function(e){const t=document.createElement("div");return t.innerHTML=e.labelText,n(t,e.labelStyle),t}(e)),t;1===t.position?null===(n=Pt(e))||void 0===n||n.prepend(i(t)):0===t.position&&(null===(a=Pt(e))||void 0===a||a.append(i(t)))}updateElement(e,t){const n=Pt(e);n&&(n.innerHTML=t.html,function(e,t){const n=e);n.innerHTML=t.script}(n,t))}clickChildLink(e){const t=document.getElementById(e.getHtmlId());var n;if(t)for(const a of t.children)if("A"===(n=a).tagName||"DIV"===n.tagName)return void a.click()}const Pt=_t={code:"BE",hostname:"www.amazon.com.be",name:"Belgium"},Nt={code:"FR",hostname:"www.amazon.fr",name:"France"},Ct={code:"DE",hostname:"www.amazon.de",name:"Germany"},zt={code:"IT",hostname:"www.amazon.it",name:"Italy"},Rt={code:"NL",hostname:"www.amazon.nl",name:"Netherlands"},Ft={code:"PL",hostname:"www.amazon.pl",name:"Poland"},Ht={code:"ES",hostname:"www.amazon.es",name:"Spain"},Ot={code:"SE",hostname:"www.amazon.se",name:"Sweden"},Wt=$t=Bt=e=>{var t,n,a,i,o,s;const r=[];jt(null===(a=null===(n=null===(t=null==e?void 0:e.url)||void 0===t?void 0:t.parameters)||void 0===n?void 0:n.adPlacementMetaData)||void 0===a?void 0:a.slotName)&&r.push("DSA Error: slotName missing");const d=null===(s=null===(o=null===(i=null==e?void 0:e.url)||void 0===i?void 0:i.parameters)||void 0===o?void 0:o.adCreativeMetaData)||void 0===s?void 0:s.adCreativeDetails;(!d||d.length<=0)&&r.push("DSA Error: transparency info missing"),null==d||d.every(();for(const c of r)y(c);return r.length<=0},Ut=(e,t)=>{var n,a,i,o,s;e.version||t.push("DSA Error: version missing"),jt(e.advertiserIdNS)&&t.push("DSA Error: advertiserIdNS missing"),void 0!==(null===(n=e.selectionSignals)||void 0===n?void 0:n.context)&&null!==(null===(a=e.selectionSignals)||void 0===a?void 0:a.context)||t.push("DSA Error: selectionSignals.context missing"),void 0!==(null===(i=e.selectionSignals)||void 0===i?void 0:i.location)&&null!==(null===(o=e.selectionSignals)||void 0===o?void 0:o.location)||t.push("DSA Error: selectionSignals.location missing"),jt(null===(s=e.selectionSignals)||void 0===s?void 0:s.pastActivity)&&t.push("DSA Error: selectionSignals.pastActivity missing")},jt=e=>!e||e.length<=0,qt=()=>new Vt(new ht(new xt,new Lt({origin:)));onst Jt=Yt=Xt=e=>{qt().openModal(e.options.adPlacementMetaData.adElementId)},Kt=Gt=Qt={};et en=null; on=function(e,n,a){sn()&&(rn(dn(e,n.id,a)),rn(dn(e,t(n.name),a)))},sn=rn=dn=function(e,t,n){return"".concat(e,":").concat(t).concat(cn(n))},cn=class ln{constructor(t,n){this.hms=t,this.hc=n,this.changeSize=(e,t)=>{var n;if(!e.options.allowChangeSize||un(e,t))return;const a=null===(n=e.options.allowedSizes)||void 0===n?void 0:n.concat(vn(e.options.size));if(pn(t,a)){e.iframe.style.height=t.height,e.iframe.style.width=t.width;const n=Xe(e.options.arid,this.hc.AD_IDS);e.placement.style.height=n?t.height:"auto",e.placement.style.width=t.width,hn(e)}else y(`Size is not allow-listed: '${t.width}' x '${t.height}'`)},this.sendAdBarTrace=this.startPixelTracking=this.logAPIInvocation=this.logError=this.logCsaEvent=this.addCsaEntity=this.sendLatencyMetric=this.customMessage=this.fireViewableLatencyMetrics=async(e,t)=>{Ee(this.hc.viewableLatencyTrackers,e.options.arid,e.options.placementName,e.options.placementId,e.options.adUnitPlacementId,t.adLoadedTimestamp)},this.countMetric=this.addCsmTag=this.requestVideoAutoplay=this.releaseVideoAutoplay=this.haveVideoAutoplayPermission=async e=>{an(e)},this.feedbackLabelRendered=e=>{Yt(e)},this.feedbackOpenModal=e=>{Xt(e)},this.handleFallbackExperience=this.expandAdSlot=this.expandAdSlotWithOverlap=this.resetSlotSize=this.triggerEventInIframe=this.registerCODFallback=this.clearCODFallback=this.safeFrameReady=this.saveAdDetailsForAdReporter=}const mn=pn=hn=un=wn=vn=fn=onst yn="adload:start",bn="adload:delayloadcallback",Sn="adload_delayload";onst An=Mn="div#ape_Detail_desktop-detail-ilm_desktop_placement",En="nav-ewc-persistent-hover",Dn=kn=Tn=Ln=onst Pn=_n=Nn=(e,t,n)=>e>0?n>e:t>0,Cn=(e,t,n,a,i,o)=>{var s,r;const d=null===(r=null===(s=null===document||void 0===document?void 0:document.getElementById)||void 0===s?void 0:s.call(document,n))||void 0===r?void 0:r.getBoundingClientRect();if(d&&Nn(d.top,d.bottom,U())&&Nn(d.left,d.right,j())){if(D().sendLatencyMetric({latencyMetricType:ge,placementId:i,placementName:a,placementDivId:n,timestamp:new Date}),e[o].loaded){D().sendLatencyMetric({latencyMetricType:ye,placementId:i,placementName:a,placementDivId:n,timestamp:new Date});const e={id:i,name:a};h("adplacements:htmlviewed:loaded:",e),h("adplacements:htmlviewed",e)}t.viewed=!0,c=t.tracker,window.removeEventListener("scroll",c),window.removeEventListener("resize",c),document.removeEventListener("visibilitychange",c)}var c},zn=(e,t,n,a,i)=>{if(!e[i]){e[i]={valid:!1};try{const o=e[i];Cn(e,o,t,n,a,i);const s=C(T(20,(),y);De(s),o.tracker=s,o.valid=!0}catch(o){throw y("Error initializing viewable latency instrumentation",o),o}}},Rn=Fn=class Hn{constructor(e,t,n,a){this.hc=e,this.hms=t,this.hmr=n,this.supportedCommands=a,this.initializeAdIds=this.initAllSafeFrames=this.secondPhaseLoadAd=async(e,t,n)=>{this.initializeAdIds(t),_n(t,this.hc,n);const a=this.hc,i=this.hms,o=this.hc.adMap[e].options;qe(o.arid,o.size.width,o.size.height,o.maxAdWidth,i,a.AD_IDS),o.resizePlacementStyle&&Ve(o.arid,a.AD_IDS,o.resizePlacementStyle),window.addEventListener("resize",Rn(i,a,o)),window.addEventListener("resize",Fn(a,o)),Pn(a,o),Wn(a,i,o);const s=An(document.getElementById(this.hc.AD_IDS[e].placementDivId),o),r=this.hc.AD_IDS[e];if(zn(a.viewableLatencyTrackers,r.placementDivId,r.slotId,s.id,e),o.forcePunt)return on("forcePunt",s),ke({forcePunt:"true"}),void s.collapse();On(o),jn(o),h(bn,s),Te(Sn,s);try{await Gt(o)?($n(s,a,o,this.hmr,this.hms),Bn(a,o,i)):s.collapse()}catch(d){throw s.collapse(),d}}}}const On=Wn=(e,t,n)=>{e.ADS_HANDLERS[n.arid]=e.ADS_HANDLERS[n.arid]||{},e.ADS_HANDLERS[n.arid].defaultResizeSafeFrameHandler=Rn(t,e,n),e.ADS_HANDLERS[n.arid].defaultSetResizePlacementStyle=Fn(e,n)},$n=Bn=(e,t,n)=>{"desktop-detail-ilm"===t.slotName&&kn()},Un=jn=qn="custommessage:notallowlisted";lass Jn{constructor(e={},t={},n={},a={},i={}){this.adMap=e,this.ADS_HANDLERS=t,this.AD_IDS=n,this.AD_TRACERS=a,this.viewableLatencyTrackers=i}}onst Xn=var Kn;null===(Kn=null===performance||void 0===performance?void 0:performance.mark)||void 0===Kn||Kn.call(performance,"SafeFrame: SafeFrame: Starting DAsf");const Gn=new Jn,Qn=new Vn(null==Gn?void 0:Gn.adMap),Zn=new Gn,Qn);C((,y,"Error initializing safeFrame")()})();
//# sourceMappingURL=DAsf-1.50.db7f3cd6.js.map
