!"undefined"!=typeof self?self:this,(e=>(()=>{var t,r,n={9025:(e,t,r)=>{e.exports={ITEM_TYPES:r(8834).iB}},8834:(e,t)=>{"use strict";t.iB=t._5=void 0,t._5="STATIC_PAGE_V2",t.iB={DEFAULT:"DEFAULT",STATIC_PAGE:"STATIC_PAGE",STATIC_PAGE_V2:t._5,STORES_PRODUCT:"STORES_PRODUCT",FORUM_POST:"FORUM_POST",FORUM_CATEGORY:"FORUM_CATEGORY",PRO_GALLERY_ITEM:"PRO_GALLERY_ITEM",BLOG_POST:"BLOG_POST",BLOG_CATEGORY:"BLOG_CATEGORY",BLOG_TAGS:"BLOG_TAGS",BLOG_ARCHIVE:"BLOG_ARCHIVE",GROUPS_PAGE:"GROUPS_PAGE",GROUPS_POST:"GROUPS_POST",EVENTS_PAGE:"EVENTS_PAGE",CHALLENGES_PAGE:"CHALLENGES_PAGE",SEARCH_PAGE:"SEARCH_PAGE",BOOKINGS_SERVICE:"BOOKINGS_SERVICE",BOOKINGS_CALENDAR:"BOOKINGS_CALENDAR",BOOKINGS_FORM:"BOOKINGS_FORM",BREADCRUMBS_COMPONENT:"BREADCRUMBS_COMPONENT",BLOG_HASHTAGS:"BLOG_HASHTAGS",RESTAURANTS_ORDER_PAGE:"RESTAURANTS_ORDER_PAGE",MEMBERS_AREA_PROFILE:"MEMBERS_AREA_PROFILE",VIDEO_COMPONENT:"VIDEO_COMPONENT",PORTFOLIO_COLLECTIONS:"PORTFOLIO_COLLECTIONS",PORTFOLIO_PROJECTS:"PORTFOLIO_PROJECTS",GIFT_CARD:"GIFT_CARD",SCHEDULE_PAGE:"SCHEDULE_PAGE",WIX_DATA_PAGE_ITEM:"WIX_DATA_PAGE_ITEM",REVIEWS_COMPONENT:"REVIEWS_COMPONENT",STORES_CATEGORY:"STORES_CATEGORY",STORES_GALLERY_COMPONENT:"STORES_GALLERY_COMPONENT",RESTAURANTS_MENU_PAGE:"RESTAURANTS_MENU_PAGE",RESTAURANTS_MENU_COMPONENT:"RESTAURANTS_MENU_COMPONENT",MEMBERS_AREA_PROFILE_TABS:"MEMBERS_AREA_PROFILE_TABS",PROGRAMS_COMPONENT:"PROGRAMS_COMPONENT",SERVICES_COMPONENT:"SERVICES_COMPONENT",PAYMENT_PAGE:"PAYMENT_PAGE",THANK_YOU_PAGE:"THANK_YOU_PAGE"}},5965:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WIX_FAQ=t.WIX_SITE_SEARCH=t.WIX_MUSIC=t.BANDSINTOWN=t.WIX_PORTFOLIO=t.WIX_PRO_GALLERY=t.WIX_PHOTO_ALBUMS=t.WIX_HOTELS_RUNNER=t.WIX_VIDEO=t.WIX_GET_SUBSCRIBERS=t.INSTAGRAM_FEED=t.DEVIANTART_FEED=t.WIX_CHAT=t.WIX_RESTAURANTS_TABLE_RESERVATIONS=t.WIX_RESTAURANTS_MENUS_NEW=t.WIX_RESTAURANTS_MENUS=t.WIX_RESTAURANTS_ORDERS_NEW=t.WIX_RESTAURANTS_ORDERS=t.WIX_RESERVATIONS=t.NOTIFICATIONS=t.META_SITE=t.MEMBERS=t.MEMBERS_AREA_V2=t.MEMBERS_AREA=t.WIX_NEW_STORES=t.WIX_STORES=t.WIX_ECOM=t.PRICING_PLANS=t.WIX_FORUM=t.WIX_BOOKINGS=t.WIX_EVENTS=t.WIX_BLOG=t.WIX_HOTELS=t.ADMIN_PAGES=t.DASHBOARD_SALES=t.DASHBOARD_SUGGESTIONS=t.DASHBOARD_SETUP=t.BUSINESS_DASHBOARD=t.WIX_CODE_PLATFORM_VISIBILITY=t.WIX_ACCESSIBILITY_WIZARD=t.WIX_CODE_SITE_MONITORING=t.WIX_CODE_SECRETS_MANAGER=t.WIX_CODE_RELEASE_MANAGER=t.CLOUD_DATA_SCHEMA_NOTIFIER=t.OLD_BLOG=t.SITE_MEMBERS=t.DATA_BINDING=t.WIX_CODE_DUPLEXER=t.WIX_CODE_SITE_EXTENSION=t.WIX_CODE=void 0,t.getAppDependencies=t.WIX_DONATIONS=t.PRODUCT_PAGE_ON_BLOCKS=t.WIX_CHECKOUT_REQUIREMENTS=t.FERA_REVIEWS=t.CMS=t.MULTILINGUAL=t.MEMBERS_ACCOUNT_INFO=t.MEMBERS_ABOUT=t.MY_SUBSCRIPTIONS=t.MAP_PLUGIN=t.WIX_REVIEWS=t.WISHLIST_BLOCKS=t.RESTAURANTS=t.WIX_FILE_SHARE=t.RICH_CONTENT=t.WIX_GROUPS=t.WIX_CHALLENGES=t.WIX_FORMS=void 0,t.WIX_CODE="wix-code",t.WIX_CODE_SITE_EXTENSION="CloudSiteExtension",t.WIX_CODE_DUPLEXER="af6d536e-0fc6-428b-a7f9-1d8cd6aa3703",t.DATA_BINDING="dataBinding",t.SITE_MEMBERS="SiteMembers",t.OLD_BLOG="79f391eb-7dfc-4adf-be6e-64434c4838d9",t.CLOUD_DATA_SCHEMA_NOTIFIER="f1fbeff1-05c3-4121-bdb5-75e74b6e9e51",t.WIX_CODE_RELEASE_MANAGER="8c41f3a6-47f7-40be-ad77-02a72cb2ddb3",t.WIX_CODE_SECRETS_MANAGER="4b10fcce-732d-4be3-9d46-801d271acda9",t.WIX_CODE_SITE_MONITORING="675bbcef-18d8-41f5-800e-131ec9e08762",t.WIX_ACCESSIBILITY_WIZARD="9699c03d-5c19-4a7c-a454-e8109a6e43fc",t.WIX_CODE_PLATFORM_VISIBILITY="8048f115-449b-4dab-b0e6-e09d5ffc8199",t.BUSINESS_DASHBOARD="a7597ab5-1ed4-458f-a5c1-5884d5e14281",t.DASHBOARD_SETUP="0750d046-d599-4cfc-9f6b-e9f4af169aa9",t.DASHBOARD_SUGGESTIONS="cead4297-02ee-4c0f-ae07-461f4ba71b3b",t.DASHBOARD_SALES="f95c72b1-84de-48ec-a61b-d96d61315ffe",t.ADMIN_PAGES="1514b01b-cb08-41b4-8582-0a88551ac769",t.WIX_HOTELS="135aad86-9125-6074-7346-29dc6a3c9bcf",t.WIX_BLOG="14bcded7-0066-7c35-14d7-466cb3f09103",t.WIX_EVENTS="140603ad-af8d-84a5-2c80-a0f60cb47351",t.WIX_BOOKINGS="13d21c63-b5ec-5912-8397-c3a5ddb27a97",t.WIX_FORUM="14724f35-6794-cd1a-0244-25fd138f9242",t.PRICING_PLANS="1522827f-c56c-a5c9-2ac9-00f9e6ae12d3",t.WIX_ECOM="1380b703-ce81-ff05-f115-39571d94dfcd",t.WIX_STORES="1380b703-ce81-ff05-f115-39571d94dfcd",t.WIX_NEW_STORES="215238eb-22a5-4c36-9e7b-e7c08025e04e",t.MEMBERS_AREA="14cc59bc-f0b7-15b8-e1c7-89ce41d0e0c9",t.MEMBERS_AREA_V2="b976560c-3122-4351-878f-453f337b7245",t.MEMBERS="14dbefd2-01b4-fb61-32a7-3abd44da4908",t.META_SITE="22bef345-3c5b-4c18-b782-74d4085112ff",t.NOTIFICATIONS="14f25924-5664-31b2-9568-f9c5ed98c9b1",t.WIX_RESERVATIONS="1475ab65-206b-d79a-856d-fa10bdb479ea",t.WIX_RESTAURANTS_ORDERS="13e8d036-5516-6104-b456-c8466db39542",t.WIX_RESTAURANTS_ORDERS_NEW="9a5d83fd-8570-482e-81ab-cfa88942ee60",t.WIX_RESTAURANTS_MENUS="13c1402c-27f2-d4ab-7463-ee7c89e07578",t.WIX_RESTAURANTS_MENUS_NEW="b278a256-2757-4f19-9313-c05c783bec92",t.WIX_RESTAURANTS_TABLE_RESERVATIONS="f9c07de2-5341-40c6-b096-8eb39de391fb",t.WIX_CHAT="14517e1a-3ff0-af98-408e-2bd6953c36a2",t.DEVIANTART_FEED="7d297b79-baed-46d7-ac58-4bd68dcb70d0",t.INSTAGRAM_FEED="14635256-b183-1c71-a4d2-f55179b80e8a",t.WIX_GET_SUBSCRIBERS="1375baa8-8eca-5659-ce9d-455b2009250d",t.WIX_VIDEO="14409595-f076-4753-8303-9a86f9f71469",t.WIX_HOTELS_RUNNER="826670ba-3a6b-4157-ac72-7c4fca9ce220",t.WIX_PHOTO_ALBUMS="13ff8629-c1fc-e289-e81f-bc8c8968e9d6",t.WIX_PRO_GALLERY="14271d6f-ba62-d045-549b-ab972ae1f70e",t.WIX_PORTFOLIO="d90652a2-f5a1-4c7c-84c4-d4cdcc41f130",t.BANDSINTOWN="1405ef82-0ee0-65fb-88a1-2f172aa3573c",t.WIX_MUSIC="13bb5d67-1add-e770-a71f-001277e17c57",t.WIX_SITE_SEARCH="1484cb44-49cd-5b39-9681-75188ab429de",t.WIX_FAQ="14c92d28-031e-7910-c9a8-a670011e062d",t.WIX_FORMS="14ce1214-b278-a7e4-1373-00cebd1bef7c",t.WIX_CHALLENGES="2936472a-a1ed-4ae5-9f71-614313a9f4e7",t.WIX_GROUPS="148c2287-c669-d849-d153-463c7486a694",t.RICH_CONTENT="949cfcc9-2a3f-4a96-bd6c-11d9d82763a4",t.WIX_FILE_SHARE="1537b24e-29d1-6d8f-b8e1-d6860f2f70b9",t.RESTAURANTS="9142e27e-2e30-4948-ad8f-7e128939efc4",t.WISHLIST_BLOCKS="a97c0203-062a-4dd5-97cf-a90f9800a13a",t.WIX_REVIEWS="a95a5fce-e370-4402-9ce4-96956acc747d",t.MAP_PLUGIN="c5fedde3-63c7-4041-a5fb-c77bbe6308dc",t.MY_SUBSCRIPTIONS="2bef2abe-7abe-43da-889c-53c1500a328c",t.MEMBERS_ABOUT="14dbef06-cc42-5583-32a7-3abd44da4908",t.MEMBERS_ACCOUNT_INFO="14cffd81-5215-0a7f-22f8-074b0e2401fb",t.MULTILINGUAL="14d84998-ae09-1abf-c6fc-3f3cace5bf19",t.CMS="1973457f-c021-4da5-941f-58444ff761d4",t.FERA_REVIEWS="c9064755-5cc8-4faf-a5a6-41a0150a6640",t.WIX_CHECKOUT_REQUIREMENTS="eeb6edab-5c38-4903-b070-58ac767a3389",t.PRODUCT_PAGE_ON_BLOCKS="a0c68605-c2e7-4c8d-9ea1-767f9770e087",t.WIX_DONATIONS="333b456e-dd48-4d6b-b32b-9fd48d74e163";var r={};t.getAppDependencies=,9540:e=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}var r="User",n="Error",o="EDM",a=e.exports={markUserError:function(e){return a(e,r)},isUserError:function(e){return e&&e.errorGroup===r},markAppError:function(e){return a(e,n)},isAppError:function(e){return e&&e.errorGroup===n},markEdmError:function(e){return a(e,o)},isEdmError:markError:a,isMarked:USER_ERROR_GROUP:r,APP_ERROR_GROUP:n,EDM_ERROR_GROUP:o,UNKNOWN_ERROR_GROUP:"Unknown"}},3164:(e,t,r)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}=r(9540),u=Error));e.exports={UserCodeError:u}},3065:(e,t,r)=>{"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}ar i=r(9540),s=r(3164);e.exports=o(o({},s),i)},5882:(e,t,r)=>{"use strict";t.PL=t.ah=void 0;var n=r(4725);Object.defineProperty(t,"ah",{enumerable:!0,get:function(){return n.convertToCustomFormat}}),Object.defineProperty(t,"PL",{enumerable:!0,get:function(){return n.convertFromCustomFormat}});var o=r(6658)},4455:5362:5574:4725:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertFromCustomFormat=t.convertToCustomFormat=void 0;var n=r(4455),o=r(5362),a=r(5574),i=new n.ConvertersComposer(new o.DateConverter,new a.DefaultConverter);t.convertToCustomFormat=function(e){return i.convertToCustomFormat(e)};t.convertFromCustomFormat=function(e){return i.convertFromCustomFormat(e)}},1561:6658:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBackendPackageNameFromImportName=t.generateBackendPackageWebMethodUrl=t.generatePackageWebMethodUrl=t.exceptionToWebMethodPayload=t.resultToWebMethodPayload=void 0;var n=r(4725);t.resultToWebMethodPayload=t.exceptionToWebMethodPayload=var o=t.generatePackageWebMethodUrl=o;t.generateBackendPackageWebMethodUrl=t.getBackendPackageNameFromImportName=function(e){return"".concat(e,"-backend")}},4479:(e,t,r)=>{"use strict";const n=r(7030),o=r(1290),a="currentUser";e.exports.X=e=>n(e)&&e[o]===a},8031:(e,t,r)=>{"use strict";const n=r(7030),{DATA_BINDING:o}=r(5965),a=r(1290),i=o;e.exports.X=e=>n(e)&&e[a]===i},1290:3878:(e,t,r)=>{"use strict";const n=r(7030),o=r(1290),a="userInput";e.exports.X=,8582:e=>{"use strict";e.exports=(e,t)=>t.reduce(((e,t)=>e.chain((e=>t.map((t=>Array.isArray(t)?e.concat([t]):e.concat(t)))))),e.of([]))},7538:477:6939:3297:4169:5635:3121:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultMaxPageSize=void 0;const n=r(3810);t.DefaultMaxPageSize={[n.PagingMode.Offset]:1e3,[n.PagingMode.Cursor]:100}},2295:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AllowedFilterOperator=t.FieldType=void 0,t.FieldType||(t.FieldType={})),function(e){e.eq="eq",e.ne="ne",e.lt="lt",e.lte="lte",e.gt="gt",e.gte="gte",e.hasSome="hasSome",e.hasAll="hasAll",e.contains="contains",e.startsWith="startsWith",e.endsWith="endsWith",e.urlized="urlized",e.exists="exists"}(t.AllowedFilterOperator||(t.AllowedFilterOperator={}))},9347:2722:4361:9166:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Direction=void 0,function(e){e.asc="asc",e.desc="desc"}(t.Direction||(t.Direction={}))},3810:47:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CMS_PLUGIN_ID=t.PAGE_LINK_PLUGIN_ID=t.SHARED_PLUGIN_ID=t.MULTILINGUAL_PLUGIN_ID=t.UrlizedFormat=t.URLIZED_PLUGIN_ID=t.SINGLES_PLUGIN_ID=t.GRID_APPLESS_PLUGIN_ID=t.PublishingStatus=t.DRAFT_DATE_FIELD_KEY=t.PUBLISH_DATE_FIELD_KEY=t.PUBLISH_STATUS_FIELD_KEY=t.PUBLISHING_PLUGIN_ID=void 0,t.PUBLISHING_PLUGIN_ID="publishing",t.PUBLISH_STATUS_FIELD_KEY="_publishStatus",t.PUBLISH_DATE_FIELD_KEY="_publishDate",t.DRAFT_DATE_FIELD_KEY="_draftDate",function(e){e.DRAFT="DRAFT",e.PUBLISHED="PUBLISHED"}(t.PublishingStatus||(t.PublishingStatus={})),t.GRID_APPLESS_PLUGIN_ID="gridAppless",t.SINGLES_PLUGIN_ID="singleItem",t.URLIZED_PLUGIN_ID="urlized",function(e){e.PLAIN="plain",e.ORIGINAL="original"}(t.UrlizedFormat||(t.UrlizedFormat={})),t.MULTILINGUAL_PLUGIN_ID="multilingual",t.SHARED_PLUGIN_ID="shared",t.PAGE_LINK_PLUGIN_ID="persistentPageLink",t.CMS_PLUGIN_ID="cms"},3530:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Storage=t.PermissionRole=t.CollectionOperation=t.DataOperation=void 0,function(e){e.aggregate="aggregate",e.bulkInsert="bulkInsert",e.bulkRemove="bulkRemove",e.bulkSave="bulkSave",e.bulkUpdate="bulkUpdate",e.count="count",e.distinct="distinct",e.find="find",e.get="get",e.insert="insert",e.insertReference="insertReference",e.isReferenced="isReferenced",e.queryReferenced="queryReferenced",e.remove="remove",e.removeReference="removeReference",e.replaceReferences="replaceReferences",e.save="save",e.truncate="truncate",e.update="update"}(t.DataOperation||(t.DataOperation={})),function(e){e.UPDATE="update",e.REMOVE="remove"}(t.CollectionOperation||(t.CollectionOperation={})),function(e){e.anyone="anyone",e.siteMember="siteMember",e.siteMemberAuthor="siteMemberAuthor",e.admin="admin"}(t.PermissionRole||(t.PermissionRole={})),t.Storage||(t.Storage={}))},5675:e=>{var t=Object.prototype.toString;e.exports=,3741:()=>{if("function"!=typeof self.queueMicrotask&&(self.queueMicrotask=,"function"!=typeof Array.prototype.at){const e=Reflect.getPrototypeOf(Int8Array);for(const t of[Array,String,e])Object.defineProperty(t.prototype,"at",{value:function(e){if((e=Math.trunc(e)||0)<0&&(e+=this.length),!(e<0||e>=this.length))return this[e]},writable:!0,enumerable:!1,configurable:!0})}},5554:857:3366:1242:7353:2107:7157:241:7772:5125:7030:7320:4126:(e,t,r)=>{"use strict";var n=r(2938),o=r(7320),a=r(5554);ction l(e,t){var r=function(e){var t;switch(e.arrayFormat){case"index":return function(e,r,n){/\[(\d*)\]$/.exec(e),e.replace(/\[\d*\]$/,""),t?(void 0===n[e]&&(n[e]={}),n[e][t[1]]=r):n[e]=r};case"bracket":return function(e,r,n){/(\[\])$/.exec(e),e.replace(/\[\]$/,""),t?void 0!==n[e]?n[e]=[].concat(n[e],r):n[e]=[r]:n[e]=r};default:return }(o({arrayFormat:"none"},t)),n=Object.create(null);return"string"!=typeof e?n:e.trim().replace(/^[?#&]/,"")?(e.split("&").forEach((function(e){var t=e.replace(/\+/g," ").split("="),o=t.shift(),i=t.length>0?t.join("="):void 0;void 0===i?null:a(i),r(a(o),i,n)})),Object.keys(n).sort().reduce((,Object.create(null))):n}t.Pz=,2938:7375:4438:e=>{"use strict";var t=function(e){return null!=e&&"function"==typeof e.run&&"boolean"==typeof e.isQueued&&(!e.resultActionCreator||"function"==typeof e.resultActionCreator)};e.exports={isEffect:t,isImmediateEffect:isQueuedEffect:},6286:6356:(e,t,r)=>{"use strict";var n=r(4520).isPromise,o=r(8620),a=o.sequence,i=o.try_,s=r(5676),c=r(4438),l=c.isEffect,u=c.isImmediateEffect,d=c.isQueuedEffect,p=function(e){return ;e.exports=function(){var e=[],t=[],r=Promise.resolve();return{middleware:function(o){return function(c){return function(p){var f=function(e){var t=i(();return t.fold((function(r){var n=e.resultActionCreator?o.dispatch(e.resultActionCreator(!0,r)):Promise.resolve();return[t,n]}),(function(r){if(n(r)){var a=r.then((function(t){return e.resultActionCreator?o.dispatch(e.resultActionCreator(!1,t)):Promise.resolve()}),(function(t){throw e.resultActionCreator&&o.dispatch(e.resultActionCreator(!0,t)).catch((function(){})),t}));return[t,a]}var i=e.resultActionCreator?o.dispatch(e.resultActionCreator(!1,r)):Promise.resolve();return[t,i]}))},h=function(){var e=void 0,n=new Promise((),o=new Promise((function(e,o){var a=r=r.then(().then(function(e,t){return function(r){if(r.length>0){var n=r.filter(d).map(f);return Promise.all(n.map((function(e){return e[1]}))).then((function(){return e()}),t),Promise.all(n.map((function(e){return e[0]})).map((function(e){return e.fold((function(e){return Promise.reject(e)}),(function(e){return e}))}))).catch(t)}return e(),Promise.resolve()}}(e,o),o).catch(o).then((function(){a===r&&t.slice().forEach(()}))}));return{promise:o,trigger:e}},m=function(e){var t=h(),r=t.promise,n=t.trigger;return i((function(){return function(e){var t=e.filter(u).map(f);return t.map((function(e){return e[0]})).map((function(e){return e.fold((,()})),t.map(().map((),e.filter(d)}(e)})).fold((function(e){throw n([]),e}),()},g=o.getState(),v=c(p),y=o.getState();if(g!==y){var E=s(g,y);return a(e.slice().map((function(e){return i((function(){return e(E)||[]}))}))).fold((function(e){throw e}),()}return Promise.resolve(v)}}},subscribe:p(e),onIdle:p(t)}}},8620:e=>{"use strict";var t=function(){},r=function(e,r){return e.fold(r.Error||t,r.Ok||t)},n=function(e){return{map:function(e){return this},fold:function(t,r){return t(e)},chain:match:function(e){return r(this,e)},value:e}},o=function e(t){return{map:function(r){return e(r(t))},fold:chain:function(e){return e(t)},match:value:t}},a={Left:n,Right:o};e.exports={Either:a,sequence:function(e){return e.reduce((,o([]))},try_:},4520:e=>{"use strict";e.exports.isPromise=,5676:e=>{"use strict";e.exports=function(e,t){var r={from:e,to:t,hasChanged:hasChangedToMatch:function(e,n){return r.hasChanged(e)&&n(e(t))},hasChangedToTrue:function(e){return r.hasChangedToMatch(e,(function(e){return!0===e}))},hasChangedToFalse:function(e){return r.hasChangedToMatch(e,()},hasChangedToNull:function(e){return r.hasChangedToMatch(e,()},hasChangedToNotNull:function(e){return r.hasChangedToMatch(e,()}};return r}},7245:5174:e=>{var t=Object.prototype.hasOwnProperty;exports=e.exports.ensureProperties=n},4846:8022:8725:9157:4481:6426:9479:7544:2440:2132:7481:4070:6290:8064:7739:7425:,o={};.m=n,a.n=r=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,a.t=a.d=a.f={},a.e=a.u=a.g=),a.o=a.r=a.p="https://static.parastorage.com/services/dbsm-viewer-app/0b89dfcdba188725a6bdb3a83c490914efc380283989723c178593f2/webworker/",(()=>{var e={143:1};a.f.i=var t=("undefined"!=typeof self?self:this).webpackJsonp__wix_dbsm_viewer_app=("undefined"!=typeof self?self:this).webpackJsonp__wix_dbsm_viewer_app||[],r=t.push.bind(t);t.push=)();var i={};return(()=>{"use strict";a.r(i),a.d(i,{createControllers:()=>Lg,initAppForPage:()=>xg});var e={};a.r(e),a.d(e,{READ:()=>Xe,READ_WRITE:()=>Ye,WRITE:()=>Je});var t={};a.r(t),a.d(t,{t:()=>br,ROUTER_DATASET:()=>Or});var r={};a.r(r),a.d(r,{DBSMViewer:()=>Do,UserErrors:()=>xo,WixData:()=>Lo});var n=a(6290),o=a.n(n),s=a(7481),c=a.n(s),l=a(4070),u=a.n(l),d=a(5965);const p={"tpa/addVariantToCart":async({wixSdk:e,currentItem:t})=>{var r;const{window:n,location:o,site:a}=e,i=await a.getPublicAPI(d.WIX_STORES),s="Mobile"===n.formFactor;if(t.managedVariant)await i.cart.addProducts([{productId:t.productId,quantity:1,options:{choices:t.choices}}]),s?await i.navigate.toCart():i.cart.showMinicart();else if(s){const e=await i.product.getRelativeProductUrl({id:t.productId});null===(r=o.to)||void 0===r||r.call(o,e)}else await i.product.openQuickView(t.productId)},"tpa/addProductToCart":async({wixSdk:e,currentItem:t})=>{var r;const{window:n,location:o,site:a}=e,i=await a.getPublicAPI(d.WIX_STORES),s="Mobile"===n.formFactor;var c;(c=t).customFields&&c.customFields.length>0||Object.keys(c.productOptions||{}).length>0?s?null===(r=o.to)||void 0===r||r.call(o,t.productPageUrl):await i.product.openQuickView(t._id):(await i.cart.addProducts([{productId:t._id,quantity:1}]),s?await i.navigate.toCart():i.cart.showMinicart())},"tpa/quicklyViewProduct":async({wixSdk:e,currentItem:t})=>{const r=await e.site.getPublicAPI(d.WIX_STORES);await r.product.openQuickView(t._id)},"tpa/purchasePricingPlan":async({wixSdk:e,currentItem:t})=>{await e["pricing-plans"].checkout.startOnlinePurchase(t._id)},"tpa/pricingPlansNavigateToCheckout":async({wixSdk:e,currentItem:t})=>{await e["pricing-plans"].customPurchaseFlow.navigateToCheckout({planId:t._id})}};a(3741);var f=a(4846),h=a.n(f);var m=a(4361);const{text:g,boolean:v,number:y,dateTime:E,date:I,richText:_,url:T,reference:w,stringArray:R}=m.FieldType,S=[g,_,v,E,I,w,y,T,R];var b=a(8022),O=a.n(b);const C=({httpClient:e})=>({reportFormEventToAutomationCreator:()=>async({detailedEventPayload:t,eventUTCTime:r})=>{const n={eventIdentifier:{eventUniqueId:O().v4(),eventType:"form/form/code",sourceUniqueId:"675bbcef-18d8-41f5-800e-131ec9e08762"},eventUTCTime:r,detailedEventPayload:t};await e.post("/_api/action-triggers-server/v1/report-event",n)}});class P extends Error{static withMessage(e){return class extends(this){constructor(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];super(e,...r)}}}static with(e){let{message:t,options:r}=e;return class extends(this){constructor(e){super(t||e instanceof String&&e,{...r,...e instanceof Object?e:{}})}}}constructor(e,t,r){void 0===r&&(r="DataBindingError"),super(e,t);const{cause:n,...o}=t||{};this.name=r,this.options=o,this.cause||(this.cause=n)}toString(){return this.cause?super.toString()+"\nCaused by "+this.cause.toString():super.toString()}}o()(P,"scopes",{USER_SCOPE:"userCodeZone",APPLICATION_SCOPE:"applicationCodeZone",SERVER_SCOPE:"wixDataCodeZone"});class N extends P{constructor(e,t){super(e,t,"AppError"),this.scope=P.scopes.APPLICATION_SCOPE}}class A extends P{constructor(e,t,r){void 0===r&&(r="UserError"),super(e,t,r),this.scope=P.scopes.USER_SCOPE}}class D extends A{constructor(e,t){const{code:r,...n}=t;super(e,n,"DatasetError"),this.code=r}}()(x,"codes",["WD_SITE_IN_TEMPLATE_MODE","WD_PERMISSION_DENIED","WD_COLLECTION_DELETED","WD_VALIDATION_FAILED"]);class L extends P{constructor(e,t){const{code:r,...n}=t;super(e,n,"ServerError"),this.scope=P.scopes.SERVER_SCOPE,this.code=r}}class F extends P{var M=a(9479);function U(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}var k=new WeakMap;const G=new class{constructor(){U(this,k,{writable:!0,value:new Proxy({},{get(e,t){if(e[t])return e[t];throw new ReferenceError("There is no "+t+" in context. Check if the context has been already set")}})})}set(e){Object.entries(e).forEach((e=>{let[t,r]=e;c()(this,k)[t]=r}))}get(){return c()(this,k)}},j=G.get(),V=G.set.bind(G);function W(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}var B=new WeakMap,H=new WeakMap;class q{constructor(e){W(this,B,{writable:!0,value:void 0}),W(this,H,{writable:!0,value:new X}),u()(this,B,e)}dispatch(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return c()(this,H).has(e)?c()(this,H).get(e).reduce(((t,n)=>[...t,j.errorReporting(n,N.with({message:e+" listener failed",options:{extra:c()(this,B)}}))(c()(this,B),...r)]),[]):void 0}subscribe(e,t){return e.constructor===Object?Object.entries(e).reduce(((e,t)=>{let[r,n]=t;return[...e,this.subscribe(r,n)]}),[]):(c()(this,H).getOrDefault(e,new J).add(t),}unsubscribe(e,t){return c()(this,H).has(e)&&c()(this,H).get(e).delete(t)}}class z{constructor(){const e={};return e.promise=new Promise(((t,r)=>{e.resolve=function(){return t(...arguments),e.promise},e.reject=function(){return r(...arguments),e.promise}})),e}}const $=(e,t)=>function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];try{const r=e(...n);return(null==r?void 0:r.catch)instanceof Function?r.catch(():r}catch(e){return t(e,...n)}};class Y{constructor(e){return null!=e&&e.then?e:{then:t=>t(e)}}}class X extends Map{getOrDefault(e,t){return this.has(e)?this.get(e):this.set(e,t).get(e)}find(e){const[,t]=Array.from(this).find((t=>{let[r,n]=t;return e(n,r,this)}))||[];return t}}class J extends Set{reduce(e,t){return Array.from(this).reduce(((t,r,n)=>e(t,r,n,this)),t)}}const K="unknown",Q=e=>{const t=e.split("/"),r=t[t.length-3],n=t[t.length-2];if(!/^\d+\.\d+\.\d+$/.test(n))throw new Error(`Invalid version string ${n}`);return{appName:r,version:n}},Z=ee=te=re="detailsRepeaterRole",ne="detailsDatasetRole",oe="filterInputRole",ae="textRole",ie="galleryRole",se="mediaGalleryRole",ce="ratingsDisplayRole",le="dropdownOptionsRole",ue="MobuiPickerOptionsRole",de="gridRole",pe="datepickerRole",fe="radioGroupRole",he="uploadButtonRole",me="repeaterRole",ge="pageRole",ve="paginationRole",ye="addressInputRole",Ee="googleMapRole",Ie="timePickerRole",_e="progressBarRole",Te="selectionTagsOptionsRole",we="signatureInputRole",Re="richContentRole",Se="userInputFilterDropdownRole",be="userInputFilterCheckboxRole",Oe="userInputFilterRadioGroupRole",Ce="userInputFilterCheckboxGroupRole",Pe="userInputFilterSelectionTagsRole",Ne="userInputFilterRangeSliderRole",Ae=[Se,be,Oe,Ce,Pe,Ne],De="RESET_ALL",xe=[Se,Oe,Ce,Pe],Le=new Map([["new","add"]]),Fe="dbsm-viewer-app";function Me(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}class Ue{constructor(e){let{collectionId:t,collectionName:r,componentType:n,datasetId:a,datasetMode:i,datasetType:s,fieldType:c,filteredBy:l,id:u,numberOfResults:p,pageId:f,pageUrl:h,viewMode:m}=e;o()(this,"type",Ue.types.EVENT),o()(this,"event",void 0),this.event={pageId:f,src:79,ver:Z(te(Fe)),app_name:Fe,app_id:d.DATA_BINDING,evid:u,ds_id:a,ds_type:s,mode:i,collection_name:r,collection_id:t,component_type:n,filtered_by:l,field_type:c,number_of_results:p,viewmode:m,page_url:h}}}o()(Ue,"types",{EVENT:"event",ERROR:"error"});class ke extends Ue{constructor(e){let{message:t,code:r}=e;super({}),o()(this,"type",Ue.types.ERROR);const n=(e=>{if((0,M.isString)(e)){const t=e.replace(/\D/g,""),r=parseInt(t);if(Number.isNaN(r))return 1}return(0,M.isNumber)(e)?Number.isNaN(e)?1:e:1})(r);this.event={evid:10,src:79,dsc:t,errn:t,errc:n}}}var Ge=new WeakMap,je=new WeakMap,Ve=new WeakMap;class We{constructor(e,t,r){o()(this,"onStart",(e=>u()(this,Ge,e))),o()(this,"onEnd",(e=>u()(this,je,e))),Me(this,Ge,{writable:!0,value:()=>{}}),Me(this,je,{writable:!0,value:()=>{}}),Me(this,Ve,{writable:!0,value:{[We.types.TRACE]:e=>(c()(this,Ge).call(this),new Y(e()).then((e=>(c()(this,je).call(this),e)))),[We.types.START]:()=>c()(this,Ge).call(this),[We.types.END]:()=>c()(this,je).call(this)}});const{type:n,fn:a}=t instanceof Function?{type:We.types.TRACE,fn:t}:{type:t};this.name=e,this.params=r,this.run=()=>c()(this,Ve)[n](a)}}o()(We,"types",{START:"START",END:"END",TRACE:"TRACE"});class Be{static with(e){let{category:t,message:r,level:n,data:o}=e;return class extends(this){constructor(e){let{category:a=t,message:i=r,level:s=n,data:c}=e;super({category:a,message:i,level:s,data:c||o?{...c,...o}:void 0})}}}constructor(e){let{category:t,message:r,level:n="info",data:o}=e;this.event={category:t,message:r,level:n,data:o}}}var He=new WeakMap,qe=new WeakMap;class ze{static with(e){return class extends(this){constructor(t,r){void 0===r&&(r={}),super(t,{...e,...r})}}}constructor(e,t){o()(this,"messages",[]),Me(this,He,{writable:!0,value:{[ze.types.DS_API.CALLED]:e=>{let{methodName:t,args:r}=e;return 0===r.length?["[wix-dataset."+t+"] called"]:["[wix-dataset."+t+"] called with (",JSON.stringify(r),")"]},[ze.types.DS_API.SUCCED]:e=>{let{methodName:t,result:r}=e;return void 0===r?["[wix-dataset."+t+"] returned"]:["[wix-dataset."+t+"] returned with (",JSON.stringify(r),")"]},[ze.types.DS_API.DEPRECATED]:e=>{let{methodName:t,replacementMethodName:r}=e;return["[wix-dataset."+t+"] is deprecated"+(r?"; use [wix-dataset."+r+"] instead":"")]},[ze.types.DS_API.REGISTERED]:e=>{let{methodName:t}=e;return["["+t+" callback registered] on wix-dataset"]},[ze.types.DS_API.TRIGGERED]:e=>{let{eventName:t,eventArgs:r=[]}=e;if(r.length){const e=r.map(();return["["+t+" event] triggered on wix-dataset with (",JSON.stringify(e),")"]}return["["+t+" event] triggered on wix-dataset"]}}}),Me(this,qe,{writable:!0,value:{}}),u()(this,qe,t),this.messages=c()(this,He)[e](t)}_getComponentPresentation(){const{component:{nickname:e,parentRepeater:t}}=c()(this,qe);return t?"#"+t.nickname+".#"+e:"#"+e}}o()(ze,"types",{DS_API:{CALLED:"DS_API_CALLED",SUCCED:"DS_API_SUCCED",DEPRECATED:"DS_API_DEPRECATED",REGISTERED:"DS_API_REGISTERED",TRIGGERED:"DS_API_TRIGGERED"}});class $e{constructor(e,t){void 0===t&&(t="log"),o()(this,"message",void 0),o()(this,"level",void 0),this.message=e,this.level=t}}const Ye="READ_WRITE",Xe="READ",Je="WRITE",Ke=(e,t)=>[de,ve].includes(e)||t&&t.properties&&Object.keys(t.properties).length>0;var Qe=a(477);const Ze=Object.keys,et=(Object.values,Object.entries),tt=e=>null!=e,rt={AddressInput:{viewerType:["wixui.AddressInput"],sdkType:"$w.AddressInput"},Text:{viewerType:["wysiwyg.viewer.components.WRichText"],sdkType:"$w.Text"},Image:{viewerType:["wysiwyg.viewer.components.WPhoto","wixui.ImageX"],sdkType:"$w.Image"},TextInput:{viewerType:["wysiwyg.viewer.components.inputs.TextInput"],sdkType:"$w.TextInput"},TimePicker:{viewerType:["wixui.TimePicker"],sdkType:"$w.TimePicker"},Button:{viewerType:["wysiwyg.viewer.components.SiteButton"],sdkType:"$w.Button"},IconButton:{viewerType:["wysiwyg.common.components.imagebutton.viewer.ImageButton"],sdkType:"$w.IconButton"},RatingsDisplay:{viewerType:["wixui.RatingsDisplay"],sdkType:"$w.RatingsDisplay"},RatingsInput:{viewerType:["wixui.RatingsInput"],sdkType:"$w.RatingsInput"},VerticalMenu:{viewerType:["wysiwyg.common.components.verticalmenu.viewer.VerticalMenu"],sdkType:"$w.VerticalMenu"},Checkbox:{viewerType:["wysiwyg.viewer.components.inputs.Checkbox"],sdkType:"$w.Checkbox"},Gallery:{viewerType:["wysiwyg.viewer.components.MatrixGallery","wysiwyg.viewer.components.SliderGallery","wysiwyg.viewer.components.SlideShowGallery","wysiwyg.viewer.components.PaginatedGridGallery","wysiwyg.viewer.components.tpapps.TPAWidget"],sdkType:"$w.Gallery"},Dropdown:{viewerType:["wysiwyg.viewer.components.inputs.ComboBoxInput","wixui.Dropdown"],sdkType:"$w.Dropdown"},TextBox:{viewerType:["wysiwyg.viewer.components.inputs.TextAreaInput"],sdkType:"$w.TextBox"},RichTextBox:{viewerType:["wixui.RichTextBox"],sdkType:"$w.RichTextBox"},Table:{viewerType:["wysiwyg.viewer.components.Grid"],sdkType:"$w.Table"},DatePicker:{viewerType:["wysiwyg.viewer.components.inputs.DatePicker"],sdkType:"$w.DatePicker"},RadioButtonGroup:{viewerType:["wysiwyg.viewer.components.inputs.RadioGroup"],sdkType:"$w.RadioButtonGroup"},UploadButton:{viewerType:["wysiwyg.viewer.components.inputs.UploadButton","wixui.FileUploaderNew","wysiwyg.viewer.components.inputs.FileUploader"],sdkType:"$w.UploadButton"},ClassicSection:{viewerType:["wysiwyg.viewer.components.ClassicSection"],sdkType:"$w.Section"},Column:{viewerType:["wysiwyg.viewer.components.Column"],sdkType:"$w.Column"},Video:{viewerType:["wysiwyg.viewer.components.Video"],sdkType:"$w.Video"},VideoPlayer:{viewerType:["wixui.VideoPlayer"],sdkType:"$w.VideoPlayer"},VideoBox:{viewerType:["wysiwyg.viewer.components.MediaPlayer"],sdkType:"$w.VideoBox"},MusicPlayer:{viewerType:["wixui.MusicPlayer"],sdkType:"$w.AudioPlayer"},Repeater:{viewerType:["wysiwyg.viewer.components.Repeater"],sdkType:"$w.Repeater"},Pagination:{viewerType:["wixui.Pagination"],sdkType:"$w.Pagination"},Page:{viewerType:["mobile.core.components.Page"],sdkType:"$w.Page"},Document:{viewerType:["fake-document-type"],sdkType:"$w.Document"},MediaContainer:{viewerType:["wysiwyg.viewer.components.MediaContainer"],sdkType:"$w.Container"},StripColumnsContainer:{viewerType:["wysiwyg.viewer.components.StripColumnsContainer"],sdkType:"$w.ColumnStrip"},ToggleSwitch:{viewerType:["wixui.ToggleSwitch"],sdkType:"$w.Switch"},Slider:{viewerType:["wixui.Slider"],sdkType:"$w.Slider"},RangeSlider:{viewerType:["wixui.RangeSlider"],sdkType:"$w.RangeSlider"},StylableButton:{viewerType:["wixui.StylableButton"],sdkType:"$w.StylableButton"},GoogleMap:{viewerType:["wysiwyg.viewer.components.GoogleMap"],sdkType:"$w.GoogleMap"},CheckboxGroup:{viewerType:["wysiwyg.viewer.components.inputs.CheckboxGroup"],sdkType:"$w.CheckboxGroup"},ProgressBar:{viewerType:["wixui.ProgressBar"],sdkType:"$w.ProgressBar"},VectorImage:{viewerType:["wysiwyg.viewer.components.VectorImage","wysiwyg.viewer.components.svgshape.SvgShape"],sdkType:"$w.VectorImage"},SelectionTags:{viewerType:["wixui.SelectionTagsList"],sdkType:"$w.SelectionTags"},Section:{viewerType:["responsive.components.Section"],sdkType:"$w.Section"},SignatureInput:{viewerType:["wixui.SignatureInput"],sdkType:"$w.SignatureInput"},RefComponent:{viewerType:["wysiwyg.viewer.components.RefComponent"],sdkType:"$w.RefComponent"},RichContent:{viewerType:["wysiwyg.viewer.components.tpapps.TPAWidget"],sdkType:"$w.RichContent"},AppController:{viewerType:["platform.components.AppController"],sdkType:"$w.AppController"},SlideshowRepeater:{viewerType:["wixui.Slideshow"],sdkType:"$w.Slideshow"}},nt=(0,M.mapValues)(rt,(),{AddressInput:ot,RatingsInput:at,TextInput:it,TextBox:st,RichTextBox:ct,Checkbox:lt,DatePicker:ut,RadioButtonGroup:dt,Dropdown:pt,UploadButton:ft,ToggleSwitch:ht,Slider:mt,TimePicker:gt,CheckboxGroup:vt,SelectionTags:yt,SignatureInput:Et}=(Ze(rt).reduce((,[]),Ze(rt).map((e=>rt[e].viewerType)).reduce(((e,t)=>e.concat(t)),[]).reduce(((e,t)=>(e[t.split(".").reverse()[0]]=t,e)),{}),Ze(rt).map((e=>rt[e].sdkType)),nt),It=[{type:ot,role:ye},{type:at,role:"ratingsInputRole"},{type:it,role:"textInputRole"},{type:st,role:"textAreaRole"},{type:ct,role:"richTextBoxRole"},{type:lt,role:"checkboxRole"},{type:ut,role:pe},{type:dt,role:fe},{type:pt,role:"dropdownRole"},{type:ft,role:he},{type:ht,role:"toggleSwitchRole"},{type:mt,role:"sliderRole"},{type:gt,role:Ie},{type:vt,role:"checkboxGroupRole"},{type:yt,role:"selectionTagsRole"},{type:Et,role:we}],_t=(It.map((e=>e.type)),It.map((e=>e.role))),Tt=e=>e.some((e=>{return t=(0,M.get)(e,"role"),_t.includes(t);var t})),wt=(e,t)=>((e)&&(e=>e.some((e=>"save"===(0,M.get)(e,"config.events.onClick.action"))))(t)&&Tt(t);nction bt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}r Pt="function"==typeof Symbol&&Symbol.observable||"@@observable",Nt=At={INIT:"@@redux/INIT"+Nt(),REPLACE:"@@redux/REPLACE"+Nt(),PROBE_UNKNOWN_ACTION:;t Mt={collectionName:null,readWriteType:Xe,filter:null,sort:null,includes:null,nested:[],pageSize:12,deferred:!1},Ut="SET_CURRENT_RECORD",kt="UPDATE_FIELDS",Gt="REFRESH_CURRENT_RECORD",jt="REFRESH_CURRENT_VIEW",Vt="INCREMENT_NUM_PAGES_TO_SHOW",Wt="SET_DEFAULT_RECORD",Bt="GO_TO_INDEX",Ht="GO_TO_NEXT_PAGE",qt="GO_TO_PREVIOUS_PAGE",zt="LOAD_PAGE",$t="GET_RECORD_BY_INDEX_RESULT",Yt="CURRENT_VIEW_UPDATED",Xt="REVERT_CHANGES",Jt="RECORD_REVERTED",Kt="SAVE_RECORD",Qt="SAVE_RECORD_RESULT",Zt="REMOVE_CURRENT_RECORD",er="REMOVE_CURRENT_RECORD_RESULT",tr="NEW_RECORD",rr="NEW_RECORD_RESULT",nr="REFRESH",or="SET_USER_INPUT_OPTION_VALUES",ar={INIT:"INIT",SET_PAGINATION_DATA:"SET_PAGINATION_DATA"},ir=ar,sr=e=>{let{controllerConfig:t={},connections:r=[],isScoped:n=!1,datasetType:o}=e;return{type:ar.INIT,datasetConfig:t.dataset||{},connections:r,isScoped:n,datasetType:o}},cr=lr="SET_FILTER",ur="SET_SORT",dr="SET_IS_DATASET_READY",pr="SET_FIXED_FILTER_ITEM",fr=e=>null==e?void 0:e.readWriteType,hr=mr=fr,gr=vr={currentRecord:{index:void 0,data:void 0,fieldsToUpdate:void 0,updateSource:void 0},lastSavedRecord:{index:void 0,data:void 0},desiredIndex:void 0,refreshCurrentRecord:!1,removeCurrentRecord:!1,newRecordIndex:null,refreshCurrentView:!1,refreshController:!1,setFilterCalled:!1,revertChanges:!1,saveRecord:!1,defaultRecord:void 0,isForm:void 0,page:{numPagesToShow:1,offset:0,size:Mt.pageSize},schema:void 0,userFilterInitialData:null,isApplyUserInputFiltersActionBindingPresent:!1},yr=e=>((e,t)=>(0,M.inRange)(e,wr(t).offset,wr(t).offset+wr(t).size))(Rr(e),e),Er=Ir=(e,t,r,n)=>{const o={...e,currentRecord:{index:t,data:r,updateSource:n},desiredIndex:t,refreshCurrentRecord:!1,refreshController:!1};return yr(o)?o:{...o,page:{...o.page,offset:Math.floor(o.currentRecord.index/o.page.size)*o.page.size,numPagesToShow:1}}},_r=e=>e.page.size,Tr=e=>e.currentRecord.data,wr=e=>e.page,Rr=e=>e.currentRecord.index,Sr={reducer:function(e,t){switch(void 0===e&&(e=vr),t.type){case Ut:{const{recordIndex:r,record:n,updateSource:o}=t;return Ir(e,r,n,o)}case tr:return{...e,newRecordIndex:t.atIndex};case rr:return gr(t).fold((,(t=>({...Ir(e,e.newRecordIndex,t),newRecordIndex:null})));case kt:{const{fieldsToUpdate:r,updateSource:n}=t;return{...e,currentRecord:{...e.currentRecord,fieldsToUpdate:r,updateSource:n}}}case Bt:return{...e,desiredIndex:t.index};case $t:return gr(t).fold((()=>({...e,desiredIndex:e.currentRecord.index,refreshCurrentRecord:!1,refreshController:!1})),(t=>t.matchWith({Record:InvalidIndex:()=>({...e,desiredIndex:e.currentRecord.index,refreshCurrentRecord:!1}),NoRecord:)));case Gt:return{...e,refreshCurrentRecord:!0};case Zt:return{...e,removeCurrentRecord:!0};case er:return gr(t).fold((()=>({...e,removeCurrentRecord:!1})),(()=>({...e,removeCurrentRecord:!1,refreshCurrentRecord:!0})));case jt:return{...e,refreshCurrentView:!0};case Yt:return{...e,refreshCurrentView:!1};case Xt:return{...e,revertChanges:!0};case Jt:return{...e,revertChanges:!1};case Wt:{const{record:r}=t;return{...e,defaultRecord:r}}case ir.INIT:{const{datasetConfig:r,connections:n}=t,o=hr(r),a=mr(r);return{...e,isForm:wt(a,n),page:{...e.page,size:o||e.page.size},isApplyUserInputFiltersActionBindingPresent:Er(n)}}case ir.SET_PAGINATION_DATA:{const r={...e,page:{...e.page,...t.paginationData}};return yr(r)?r:{...r,desiredIndex:r.page.offset}}case Ht:{const t=wr(e),r=_r(e),n=t.offset+r,o={...e,page:{...e.page,numPagesToShow:1,offset:n}};return yr(o)?o:{...o,desiredIndex:o.page.offset}}case qt:{const t=wr(e),r=Math.max(0,t.offset-t.size),n={...e,page:{...e.page,numPagesToShow:1,offset:r}};return yr(n)?n:{...n,desiredIndex:n.page.offset}}case zt:{const{size:r}=wr(e),n={...e,page:{...e.page,numPagesToShow:1,offset:r*(t.pageNumber-1)}};return yr(n)?n:{...n,desiredIndex:n.page.offset}}case Vt:return{...e,page:{...e.page,numPagesToShow:e.page.numPagesToShow+1}};case Kt:return{...e,saveRecord:!0,lastSavedRecord:{index:void 0,data:void 0}};case Qt:return gr(t).fold((,(t=>({...e,saveRecord:!1,lastSavedRecord:{index:e.currentRecord.index,data:t}})));case lr:return{...e,setFilterCalled:!0,refreshController:!0};case ur:case nr:return{...e,refreshController:!0};case or:return{...e,userFilterInitialData:t.userFilterInitialData};default:return e}},getPaginationData:wr,hasCurrentRecord:selectDefaultDraft:selectCurrentRecord:Tr,selectCurrentRecordIndex:Rr,selectDesiredRecordIndex:e=>e.desiredIndex,selectFieldsToUpdate:e=>e.currentRecord.fieldsToUpdate,selectLastSavedRecord:e=>e.lastSavedRecord.data,selectLastSavedRecordIndex:e=>e.lastSavedRecord.index,selectRefreshCurrentRecord:e=>e.refreshCurrentRecord,selectRemoveCurrentRecord:e=>e.removeCurrentRecord,selectRefreshController:e=>e.refreshController,selectSetFilterCalled:e=>e.setFilterCalled,selectRefreshCurrentView:e=>e.refreshCurrentView,selectRevertChanges:e=>e.revertChanges,selectSaveRecord:e=>e.saveRecord,selectUpdateSource:selectNewRecordIndex:e=>e.newRecordIndex,isDuringSave:e=>e.saveRecord,isForm:e=>e.isForm,getUserFilterInitialData:e=>e.userFilterInitialData,selectIsApplyUserInputFiltersActionBindingPresent:e=>e.isApplyUserInputFiltersActionBindingPresent},br="dataset",Or="router_dataset",Cr=e=>{var t;const{prop:r,fieldName:n}=null!=(t=null==e?void 0:e.userInputFilter)?t:{};return!(!r||!n)},{WRITE:Pr}=e,{ROUTER_DATASET:Nr}=t,Ar=["collectionName","readWriteType","includes","cursor"],Dr=["filter","sort"],xr=e=>(0,M.pick)(e,Ar),Lr=e=>(0,M.pick)(e,Dr),Fr=e=>{let{datasetConfig:t,connections:r,isScoped:n,datasetType:o}=e;const a=o===Nr,i=r.some((e=>{let{role:t}=e;return t===ne})),s=n,c=!n,l=t.readWriteType===Pr;return{datasetIsRouter:a,datasetIsMaster:i,datasetIsVirtual:s,datasetIsReal:c,datasetIsDeferred:Boolean(t.deferred)&&!(s||i||a||l),dynamicPageNavComponentsShouldBeLinked:a&&c,userFilterConnectionProps:r.filter((e=>{let{role:t,config:r}=e;return Ae.includes(t)&&Cr(r)})).map((e=>{let{config:{userInputFilter:t},role:r}=e;return{...t,role:r}}))}},Mr=(e,t)=>({...e,transientData:{...e.transientData,...t}}),Ur={canonicalData:xr(Mt),canonicalCalculatedData:{},transientData:{isDatasetReady:!1,...Lr(Mt)}},kr={reducer:function(e,t){switch(void 0===e&&(e=Ur),t.type){case ir.INIT:{const{datasetConfig:r,connections:n,isScoped:o,datasetType:a}=t;return{...e,canonicalData:{...e.canonicalData,...xr(t.datasetConfig)},canonicalCalculatedData:Fr({datasetConfig:r,connections:n,isScoped:o,datasetType:a}),transientData:{...e.transientData,...Lr(t.datasetConfig)}}}case lr:{const{filter:r}=t;return Mr(e,{filter:r})}case ur:{const{sort:r}=t;return Mr(e,{sort:r})}case dr:{const{isDatasetReady:r}=t;return Mr(e,{isDatasetReady:r})}case pr:{const{fixedFilterItem:r}=t;return Mr(e,{fixedFilterItem:r})}default:return e}},isWriteOnly:e=>(0,M.get)(e,["canonicalData","readWriteType"])===Je,isReadOnly:e=>(0,M.get)(e,["canonicalData","readWriteType"])===Xe,getReadWriteMode:e=>(0,M.get)(e,["canonicalData","readWriteType"]),isDatasetReady:e=>(0,M.get)(e,["transientData","isDatasetReady"]),isDatasetConfigured:e=>!!(0,M.get)(e,["canonicalData","collectionName"]),isCursorPagingRequired:e=>!!(0,M.get)(e,["canonicalData","cursor"]),isDatasetRouter:e=>{let{canonicalCalculatedData:{datasetIsRouter:t}}=e;return t},isDatasetMaster:e=>{let{canonicalCalculatedData:{datasetIsMaster:t}}=e;return t},isDatasetVirtual:e=>{let{canonicalCalculatedData:{datasetIsVirtual:t}}=e;return t},isDatasetReal:e=>{let{canonicalCalculatedData:{datasetIsReal:t}}=e;return t},isDatasetDeferred:e=>{let{canonicalCalculatedData:{datasetIsDeferred:t}}=e;return t},shouldLinkDynamicPageNavComponents:e=>{let{canonicalCalculatedData:{dynamicPageNavComponentsShouldBeLinked:t}}=e;return t},getUserFilterConnectionProps:e=>{let{canonicalCalculatedData:{userFilterConnectionProps:t}}=e;return t},getFixedFilterItem:e=>(0,M.get)(e,["transientData","fixedFilterItem"]),getFilter:e=>(0,M.get)(e,["transientData","filter"]),getSort:e=>(0,M.get)(e,["transientData","sort"]),getIncludes:e=>(0,M.get)(e,["canonicalData","includes"])||[],getCollectionName:,Gr="NEXT_DYNAMIC_PAGE_URL_RESULT",jr="PREVIOUS_DYNAMIC_PAGE_URL_RESULT",Vr="INITIALIZE",Wr=(0,Qe.union)("DynamicPageUrlLoadState",{Empty(){},Loading(){},Loaded:e=>{if(!e)throw new Error("url must exist");return{url:e}}},{hasUrl:e=>()=>e.matchWith({Empty:()=>!1,Loading:()=>!1,Loaded:()=>!0}),shouldLoadUrl:e=>()=>e.matchWith({Empty:()=>!1,Loading:()=>!0,Loaded:()=>!1})});Wr.fromUrl=const Br=Wr,{fromUrl:Hr}=Wr,qr={nextDynamicPageUrl:Br.Empty(),previousDynamicPageUrl:Br.Empty()},zr=e=>{const t=(e=>{const t=e.filter(();return new Set(t.map(())})(e),r=return{nextDynamicPageUrl:r(t.has("nextDynamicPage")),previousDynamicPageUrl:r(t.has("previousDynamicPage"))}},$r={reducer:function(e,t){switch(void 0===e&&(e=qr),t.type){case Vr:return{...e,...zr(t.connections)};case Gr:return{...e,nextDynamicPageUrl:Br.fromUrl(t.payload)};case jr:return{...e,previousDynamicPageUrl:Br.fromUrl(t.payload)};default:return e}},selectNextDynamicPageUrl:e=>e.nextDynamicPageUrl,selectPreviousDynamicPageUrl:e=>e.previousDynamicPageUrl},Yr={records:Sr.reducer,config:kr.reducer,dynamicPages:$r.reducer}),Xr=e=>kr.getCollectionName(e.config),Jr=e=>kr.getFilter(e.config),Kr=e=>kr.getSort(e.config),Qr=e=>Sr.getPaginationData(e.records),Zr=e=>kr.getReadWriteMode(e.config),en=e=>kr.isDatasetConfigured(e.config),tn=e=>kr.isDatasetReady(e.config),rn=e=>kr.isReadOnly(e.config),nn=e=>kr.isWriteOnly(e.config),on=e=>(e=>Sr.hasCurrentRecord(e.records))(e)&&!rn(e),an=e=>kr.isDatasetRouter(e.config),sn=e=>kr.isDatasetMaster(e.config),cn=e=>kr.isDatasetVirtual(e.config),ln=e=>kr.isDatasetReal(e.config),un=e=>kr.isDatasetDeferred(e.config),dn=e=>kr.shouldLinkDynamicPageNavComponents(e.config),pn=e=>Sr.selectCurrentRecord(e.records),fn=e=>Sr.selectCurrentRecordIndex(e.records),hn=e=>Sr.selectDefaultDraft(e.records),mn=e=>Sr.selectDesiredRecordIndex(e.records),gn=e=>Sr.selectFieldsToUpdate(e.records),vn=e=>Sr.selectUpdateSource(e.records),yn=e=>Sr.selectNewRecordIndex(e.records),En=e=>$r.selectNextDynamicPageUrl(e.dynamicPages),In=e=>$r.selectPreviousDynamicPageUrl(e.dynamicPages),_n=e=>Sr.selectRefreshController(e.records),Tn=e=>Sr.selectSetFilterCalled(e.records),wn=e=>Sr.selectRefreshCurrentRecord(e.records),Rn=e=>Sr.selectRefreshCurrentView(e.records),Sn=e=>Sr.selectRemoveCurrentRecord(e.records),bn=e=>Sr.selectRevertChanges(e.records),On=e=>Sr.selectSaveRecord(e.records),Cn=e=>Sr.getUserFilterInitialData(e.records),{READ_WRITE:Pn,READ:Nn}=e;function An(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}var Dn=new WeakMap,xn=new WeakMap;class Ln{constructor(e,t){An(this,Dn,{writable:!0,value:void 0}),An(this,xn,{writable:!0,value:new X([[Ue,e=>{let{mode:t,env:r}=e;return t.csr&&!r.dev}],[ze,e=>{let{mode:t,env:r}=e;return t.verbose&&r.preview}]])}),u()(this,Dn,e),this._listenToUnhandledErrors(t)}log(e){if(this._shouldLogErrorBi(e)&&c()(this,Dn).log(e,new ke(e.cause||e)),this._shouldLog(e))return c()(this,Dn).log(e)}logError(e,t,r){this.log(e instanceof P?e:new N(t,{cause:e,...r}))}_shouldLog(e){const t=c()(this,xn).find(()||(()=>!0);return t(j.platform.settings)}_shouldLogErrorBi(e){return e instanceof P&&!(e instanceof A)&&c()(this,xn).get(Ue)(j.platform.settings)}_listenToUnhandledErrors(e){e.addEventListener("unhandledrejection",(e=>{e.reason instanceof P&&(e.preventDefault(),c()(this,Dn).log(new F({cause:e.reason})))}))}}const Fn=e=>(t,r)=>$(t,(t=>e.log(new r({cause:t})))),Mn=e=>(t,r)=>$((function(){for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];const i=t(...o);return e.log(new r({data:{args:o,result:i}})),i}),(t=>{throw e.log(new r({data:{exception:t},level:"error"})),t})),Un=e=>(t,r)=>function(){for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];if(r.startsWith("on"))return e.log(new ze(ze.types.DS_API.REGISTERED,{methodName:r})),t(...o);if(e.log(new ze(ze.types.DS_API.CALLED,{methodName:r,args:o})),Le.has(r)){const t=Le.get(r);e.log(new ze(ze.types.DS_API.DEPRECATED,{methodName:r,replacementMethodName:t}))}return new Y(t(...o)).then((t=>(e.log(new ze(ze.types.DS_API.SUCCED,{methodName:r,result:t})),t)))};class kn{constructor(e){let{id:t,collectionId:r,collectionName:n,datasetId:o,datasetType:a,datasetMode:i,numberOfResults:s,filteredBy:c,componentType:l,fieldType:u}=e;const{platform:{location:{pageId:d,pageUrl:p},settings:{env:f}}}=j;return new Ue({id:t,collectionId:r,collectionName:n,datasetId:o,datasetType:a,datasetMode:i,viewMode:f.name,pageId:d,pageUrl:p,numberOfResults:s,filteredBy:c,componentType:l,fieldType:u})}}var Gn=a(5882);class jn{constructor(e){let{message:t,code:r}=e;const n=new Error(t);return n.code=r,n}}class Vn{sync _makeRequestTo(e,t){const{instance:r,gridAppId:n}=this.getRequestParams();return(await this.httpClient.post("/_serverless/data-binding-server/"+e,t,{params:{gridAppId:n},headers:{Authorization:r,"Content-Type":"application/json"}})).data}async fetchBulkData(e){const{recordsByCollectionId:t,recordsInfoByDataset:r}=await this._makeRequestTo("fetch-initial-data",e);return{recordsInfoByDataset:r.reduce(((e,t)=>{let{itemIds:r=[],totalCount:n=0,error:o}=t;return[...e,{itemIds:r,totalCount:n,error:o?new jn(o):void 0}]}),[]),recordsByCollectionId:Object.entries(t).reduce(((e,t)=>{let[r,n]=t;return{...e,[r]:Object.entries(n).reduce(((e,t)=>{let[r,n]=t;return{...e,[r]:(0,Gn.PL)(n)}}),{})}}),{})}}async fetchData(e){const{items:t,...r}=await this._makeRequestTo("fetch-data",e);return{...r,items:t.map((e=>(0,Gn.PL)(e)))}}sync save(e){const{item:t}=await this._makeRequestTo("save",e);return(0,Gn.PL)(t)}}const Wn=".",Bn=Hn=e=>e.split(Wn),qn=zn=(e,t)=>e!==t&&qn(e)&&!qn(t)?e:t,$n=function(e,t){void 0===t&&(t={});for(const r of e){const e=t[r._id];t[r._id]=(0,M.mergeWith)(e,r,zn)}return t},Yn=(e,t)=>{const r=t.flatMap(().concat("type");return(0,M.get)(e,r)},Xn=(e,t)=>r=>{const n=Hn(r);if(((e,t)=>t.length>=2&&Yn(e,[t[0]])===m.FieldType.reference)(e,n)){const[r,...o]=n,a=e&&e.fields[r]?e.fields[r].referencedCollection:null,i=t&&a?t[a]:null;return Yn(i,o)}return Yn(e,n)},Jn=(e,t)=>null!=t&&null!=t.fields[e]?t.fields[e].referencedCollection:null,Kn=Qn=Zn=eo=e=>{var t;let{schema:r,defaultToDbDriverLimit:n}=e;const o=n?100:1e3;return null!=(t=Qn(r))?t:o},to=(e,t)=>async r=>{const{baseQuery:n,fieldName:o,schema:a}=r,i=((e,t,r)=>{var n;const o=null===(n=e.fields[t])||void 0===n?void 0:n.queryOperators;return!o||o.includes(r)})(a,o,m.AllowedFilterOperator.ne);if(i)return t({...r,baseQuery:n.ne(o,e)});const s=await t(r);return(0,M.filter)(s,(t=>(((t)?t[o]:t)!==e))},ro=no=oo=async e=>{let{baseQuery:t,schema:r,fieldName:n}=e;const o=eo({schema:r,defaultToDbDriverLimit:!0}),{items:a}=await t.limit(o).find(),i=a.flatMap((e=>e[n]));return(0,M.uniq)(i)},ao=async e=>{let{baseQuery:t,fieldName:r,schema:n}=e;const o=eo({schema:n,defaultToDbDriverLimit:!1}),{items:a}=await t.limit(o).distinct(r,null);return a},io=e=>{let{wixData:t,schema:r,sortModel:n,fieldName:o,filterModel:a}=e;const i=(e=>{let{wixData:t,schema:r,sortModel:n,fieldName:o}=e;const a=Bn(o);if(a){var i,s,c;const e=null==(i=null==(s=r.fields[a])?void 0:s.sortable)||i,o=r.defaultSort?[{[r.defaultSort.fieldName]:r.defaultSort.direction}]:null,l=(null==n?void 0:n.length)>0,u=!((null==n?void 0:n.find((e=>e[a])))||(null==r||null==(c=r.defaultSort)?void 0:c.fieldName)===a)&&e,d=t.sort().ascending(a).getSortModel();if(l)return u?[...n,...d]:n;if(o)return u?[...o,...d]:o;if(e)return d}return null})({wixData:t,schema:r,sortModel:n,fieldName:o});return t.query(r.id).setFilterModel(a).setSortModel(i)},so=async e=>{let{baseQuery:t,schema:r,references:n}=e;const o=eo({schema:r,defaultToDbDriverLimit:!0}),{items:a}=await t.hasSome("_id",n).limit(o).find();return a},co=async e=>{let{baseQuery:t,schema:r,wixData:n,customSortExists:o,referencingFieldName:a,referencedFieldName:i,referencedSchema:s}=e;const c=eo({schema:r,defaultToDbDriverLimit:!1}),{items:l}=await t.limit(c).distinct(a,null),u=ro(no(so)),d=await u({baseQuery:n.query(s.id),schema:s,fieldName:i,references:l});return o?l.flatMap(():d},lo=async e=>{let{baseQuery:t,schema:r,fieldName:n}=e;const o=eo({schema:r,defaultToDbDriverLimit:!0}),{items:a}=await t.limit(o).include(n).find();return a},uo=async e=>{let{baseQuery:t,schema:r,referencingFieldName:n,referencedFieldName:o}=e;const a=no(lo),i=await a({baseQuery:t,schema:r,fieldName:n});return(0,M.uniqBy)(i.map((e=>e[n])).filter((e=>!["",void 0].includes(e[o]))),"_id")},po=async e=>{var t;let{schema:r,schemas:n,wixData:o,fieldName:a,role:i,sortModel:s,filterModel:c}=e;const l=io({wixData:o,schema:r,fieldName:a,sortModel:s,filterModel:c}),[u,d]=Hn(a),p=n[r.fields[u].referencedCollection];if(!p)return null;const f=(null==s?void 0:s.length)>0,h=(null==(t=r.allowedOperations)?void 0:t.includes(m.DataOperation.distinct))?co:uo,g=await h({baseQuery:l,schema:r,schemas:n,wixData:o,fieldName:a,customSortExists:f,referencingFieldName:u,referencedFieldName:d,referencedSchema:p}),v=(e=>{let{referencedItems:t,referencedSchema:r,referencedFieldName:n,customSortExists:o}=e;const a=(0,M.uniq)(t.flatMap((e=>e[n]))),i=r.fields[n].type;return o?a:i===m.FieldType.number?a.sort(():a.sort()})({referencedItems:g,referencedSchema:p,referencedFieldName:d,customSortExists:f}),y=(e=>{let{referencedItems:t,referencedFieldName:r,options:n}=e;return Object.fromEntries(n.map((e=>[e,t.filter((t=>(0,M.isArray)(t[r])?t[r].includes(e):t[r]===e)).map((e=>e._id))])))})({referencedItems:g,options:v,referencedFieldName:d});return{fieldName:a,role:i,options:v,referencedItemIdsByOption:y}},fo=async e=>{var t;let{schema:r,wixData:n,fieldName:o,role:a,filterModel:i}=e;const s={wixData:n,schema:r,filterModel:i,fieldName:o,role:a};return(null==(t=r.allowedOperations)?void 0:t.includes(m.DataOperation.aggregate))?(async e=>{var t;let{wixData:r,schema:n,filterModel:o,fieldName:a,role:i}=e;const s=r.filter().setFilterModel(o),{items:c}=await r.aggregate(n.id).filter(s).max(a,"max").min(a,"min").run(),{min:l,max:u}=null!=(t=c[0])?t:{};return{fieldName:a,role:i,min:l,max:u}})(s):(async e=>{let{wixData:t,schema:r,filterModel:n,fieldName:o,role:a}=e;const i=t.query(r.id).setFilterModel(n).limit(1),[{items:s},{items:c}]=await Promise.all([i.ascending(o).find(),i.descending(o).find()]),l=s.map((e=>e[o]))[0],u=c.map((e=>e[o]))[0];return{fieldName:o,role:a,min:l,max:u}})(s)};function ho(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}var mo=new WeakMap,go=new WeakMap;class vo{constructor(e){let{wixData:t,wixDataSchemas:r}=e;ho(this,mo,{writable:!0,value:void 0}),ho(this,go,{writable:!0,value:void 0}),u()(this,mo,yo.reduce(((e,r)=>(e[r]=function(){const e=t[r](...arguments);return e.catch instanceof Function?e.catch(():e},e)),{...t})),u()(this,go,r)}async fetchBulkData(e){const t=await Promise.all(e.map((e=>{let{collectionId:t,filter:r,sort:n,offset:o,cursor:a,length:i,includes:s,uniqueFieldValues:c}=e;return this.fetchData({collectionId:t,filter:r,sort:n,offset:o,cursor:a,length:i,includes:s,uniqueFieldValues:c}).catch(()})));return((e,t)=>t.reduce(((t,r,n)=>{let{items:o,nextCursor:a,totalCount:i,uniqueFieldValues:s,error:c}=r;if(c)return t.recordInfosInDatasetOrder.push({error:c}),t;t.recordInfosInDatasetOrder.push({itemIds:o.map((e=>{let{_id:t}=e;return t})),totalCount:i,nextCursor:a});const l=e[n].collectionId,u=t.recordsByCollectionId[l];return t.recordsByCollectionId[l]=$n(o,u),t.uniqueFieldValuesByCollection[l]={...t.uniqueFieldValuesByCollection[l],...s},t}),{recordInfosInDatasetOrder:[],recordsByCollectionId:{},uniqueFieldValuesByCollection:{}}))(e,t)}async fetchData(e){let{collectionId:t,filter:r,sort:n,offset:o=0,includes:a,cursor:i,length:s,uniqueFieldValues:l}=e;const u=i?c()(this,mo).fetch(t,i,s):(()=>{let e=c()(this,mo).query(t).setFilterModel(r).setSortModel(n).skip(o).limit(s);return null==a||a.forEach((),e.find()})(),d=l.length>0?this._fetchUniqueValues({collectionId:t,fieldKeys:l}):Promise.resolve({}),[p,f]=await Promise.all([u,d]),{items:h,totalCount:m,nextCursor:g}=p;return{items:h,nextCursor:g,totalCount:m||0,uniqueFieldValues:f}}async fetchUserFilterInitialData(e){let{filter:t,sort:r,userFilterConnectionProps:n,schema:o,schemas:a}=e;const i=[Ne],s=(0,M.uniqBy)(n.filter((e=>{let{role:t}=e;return i.includes(t)})),"fieldName"),l=(0,M.uniqWith)(n.filter((e=>{let{role:t}=e;return xe.includes(t)})),(),u=await Promise.all([...s.map((async e=>{let{fieldName:r,role:n}=e;const a={schema:o,wixData:c()(this,mo),fieldName:r,role:n,filterModel:t};return fo(a)})),...l.map((async e=>{let{fieldName:n,role:i}=e;const s=Zn(n),l={wixData:c()(this,mo),schema:o,schemas:a,fieldName:n,role:i,sortModel:r,filterModel:t};return s?po(l):(async e=>{var t;let{wixData:r,schema:n,fieldName:o,role:a,sortModel:i,filterModel:s}=e;const c=io({wixData:r,schema:n,fieldName:o,sortModel:i,filterModel:s}),l=null==(t=n.allowedOperations)?void 0:t.includes(m.DataOperation.distinct),u=ro(l?ao:no(oo));return{fieldName:o,role:a,options:await u({baseQuery:c,fieldName:o,schema:n})}})(l)}))]);return u.filter(tt)}async remove(e){let{collectionId:t,recordId:r}=e;return c()(this,mo).remove(t,r)}async save(e){let{collectionId:t,record:r,includeReferences:n}=e;return c()(this,mo).save(t,r,{includeReferences:n})}async getSibling(e){let{collectionName:t,filter:r,sort:n,fieldValues:o,sortFields:a,directionTowardSibling:i}=e;const s=c()(this,mo).query(t).setFilterModel(r),{items:[l]}=await Eo({sort:n,sortFields:a,fieldValues:o,baseQuery:s,directionTowardSibling:i}).find();return l}fetchSchemas(e){return c()(this,go).bulkGet(e,{referencedCollectionsDepth:1})}createSimpleFilter(e,t){return c()(this,mo).filter().eq(e,t).getFilterModel()}async _fetchUniqueValues(e){let{collectionId:t,fieldKeys:r}=e;return(await Promise.all(r.map((e=>c()(this,mo).query(t).distinct(e))))).reduce(((e,t,n)=>{let{_items:o}=t;return e[r[n]]=o,e}),{})}}const yo=["save","remove","find","sort","filter","query","fetch","aggregate"],Eo=e=>{let{sort:t,sortFields:r,directionTowardSibling:n,fieldValues:o,baseQuery:a}=e;return Io({sort:t,sortFields:r,directionTowardSibling:n,fieldValues:o,baseQuery:a})(r.length-1).reduce(()},Io=e=>{let{baseQuery:t,sortFields:r,sort:n,directionTowardSibling:o,fieldValues:a}=e;return function e(i){if(-1===i)return[];const s=r[i];if(!a[s])return e(i-1);return[(0,M.flow)(_o(n,o),To(n[s],o,s,a[s]),wo(i,r,a))(t),...e(i-1)]}},_o=(e,t)=>r=>Object.entries(e).reduce(((e,r)=>{let[n,o]=r;return o===t?e.ascending(n):e.descending(n)}),r),To=(e,t,r,n)=>o=>e===t?o.gt(r,n):o.lt(r,n),wo=(e,t,r)=>n=>(0,M.range)(e).reduce(((e,n)=>e.eq(t[n],r[t[n]])),n).limit(1);class Ro{constructor(e){if(!e.stack){const{message:t,code:r}="string"==typeof e?{message:e,code:"WD_VALIDATION_FAILED"}:e,n=new Error(t);return n.code=r,n}return e}}class So{constructor(e){o()(this,"warmupData",void 0),this.warmupData=e}getSchemas(){return this.warmupData.get("schemas")}setSchemas(e){this.warmupData.set("schemas",e)}UserFilterInitialDatafunction bo(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}var Oo=new WeakMap,Co=new WeakMap,Po=new WeakMap,No=new WeakMap;class Ao{constructor(e){if(bo(this,Oo,{writable:!0,value:void 0}),bo(this,Co,{writable:!0,value:void 0}),bo(this,Po,{writable:!0,value:void 0}),bo(this,No,{writable:!0,value:void 0}),e&&e.config){u()(this,Oo,e.config.dataset.collectionName),u()(this,Co,e.items),u()(this,Po,e.schemas);const t=e.nextCursor||void 0,r=e.totalCount||0,n=(e.items||[]).length;u()(this,No,{cursor:t,total:r,loaded:n})}}getSchemas(){return c()(this,Po)}getDataStore(){if(c()(this,Co))return(e=>{let{items:t,datasetSize:r,collectionId:n}=e;return{recordInfosInDatasetOrder:[{itemIds:t.map((e=>{let{_id:t}=e;return t})),datasetSize:r,collectionId:n}],recordsByCollectionId:{[n]:$n(t,{})}}})({items:c()(this,Co),datasetSize:c()(this,No),collectionId:c()(this,Oo)})}getItems(){return c()(this,Co)}}const Do={dsn:"https://27180ecd50484e4eafe543b40d29866d@sentry.wixpress.com/89"},xo={dsn:"https://73a0410004ae41b7b60ca1c4b4684996@sentry.wixpress.com/183"},Lo={dsn:"https://9653fbb3e48143d890dba8a09a5a98c6@sentry.wixpress.com/184"},Fo=["ReactSource","EditorSource","experiments","petri_ovr","WixCodeRuntimeSource","js-wixcode-sdk-override","debug"],Mo=e=>{try{const t=(e=>Array.from(new URL(e).searchParams.entries()).reduce((,{}))(e||"");return((t)||(e=>Object.keys(e).every(())(t)}catch(e){return!0}},Uo=[e=>(e=>{var t,r,n;return[null===(r=null===(t=null==e?void 0:e.request)||void 0===t?void 0:t.headers)||void 0===r?void 0:r.Referer,null===(n=null==e?void 0:e.request)||void 0===n?void 0:n.url]})(e).every(Mo)],ko=(e,t)=>Uo.concat(t||(e=>e)).every((t=>t(e))),Go=e=>{try{return e()}catch(e){return"unknown"}},jo=e=>{try{return e()}catch(e){return"object"==typeof e&&null!==e&&"message"in e?e.message:void 0}},Vo=({Raven:e,globalScope:t,dsn:r,params:n={},appName:o})=>{/https?:\/\/localhost/.test(ee())||((({Raven:e,appName:t,browserUrlGetter:r,dsn:n,params:o})=>{const a=te(t),i=Z(a);e.config(n,{maxUrlLength:1e3,captureUnhandledRejections:!1,autoBreadcrumbs:{dom:!1}}),e.setRelease(o.release||i),e.setShouldSendCallback(o.shouldSendCallback||ko),e.setDataCallback(((e,t)=>(e.request=Object.assign(e.request||{},{url:r()}),(t||(e=>e))(e))))})({Raven:e,appName:o,browserUrlGetter:()=>Go((()=>{var e;return null===(e=null==t?void 0:t["wix-location"])||void 0===e?void 0:e.url})),dsn:r,params:n}),e.setDataCallback(((e,r=()=>(e.extra=Object.assign(e.extra||{},(e=>({referrer:jo((()=>{var t;return null===(t=null==e?void 0:e["wix-window"])||void 0===t?void 0:t.referrer})),workerUrl:jo(()}))(t)),e.tags=Object.assign(e.tags||{},n.tags||{},(e=>({renderMode:Go((()=>{var t,r;return null===(r=null===(t=null==e?void 0:e["wix-window"])||void 0===t?void 0:t.rendering)||void 0===r?void 0:r.env})),viewMode:Go((()=>{var t;return null===(t=null==e?void 0:e["wix-window"])||void 0===t?void 0:t.viewMode})),santaVersion:Go((()=>{var t;return(((null===(t=null==e?void 0:e.location)||void 0===t?void 0:t.href)||"")}))}))(t)),r(e)))))};function Wo(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}const{USER_SCOPE:Bo,APPLICATION_SCOPE:Ho,SERVER_SCOPE:qo}=P.scopes,{DBSMViewer:{dsn:zo},UserErrors:{dsn:$o},WixData:{dsn:Yo}}=r,Xo={[Ho]:zo,[Bo]:$o,[qo]:Yo};let Jo=function(e,t){return r=>this.mode.dev?(e===Error&&(this.console.error(r),r.cause&&this.console.error("Caused by:",r.cause)),null==r.run?void 0:r.run()):t(r)};var Ko=new WeakMap,Qo=new WeakMap,Zo=new WeakMap,ea=new WeakMap,ta=new WeakMap,ra=new WeakMap;class na{constructor(e){let{fedops:t,bi:r,monitor:n,verbose:o,console:a,global:i,settings:s}=e;Wo(this,Ko,{writable:!0,value:void 0}),Wo(this,Qo,{writable:!0,value:void 0}),Wo(this,Zo,{writable:!0,value:void 0}),Wo(this,ea,{writable:!0,value:void 0}),Wo(this,ta,{writable:!0,value:void 0}),Wo(this,ra,{writable:!0,value:void 0});const c=a.factory();Jo=Jo.bind({mode:s.mode,console:c}),u()(this,Ko,this._createEventToHandler()),u()(this,Qo,this._createFedopsLogger(t)),u()(this,Zo,this._createBiLoggers({bi:r,settings:s})),u()(this,ea,this._setupMonitor({monitor:n,global:i,settings:s})),u()(this,ta,o.factory()),u()(this,ra,c)}log(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(t.length>1)return t.map(();const[n]=t,[,o]=Array.from(c()(this,Ko)).find(()||[];return o?o(n):c()(this,ra).error("Oj-vej! This event is not supported by logger",n)}_createEventToHandler(){return new Map([[Error,Jo(Error,(e=>{if(e instanceof F)c()(this,ra).warn("You have unhandled error in async operation. Consider catching it and handling accordingly.\n",e.cause);else{const{scope:t,cause:r,options:{extra:n,...o}={}}=e;e instanceof A&&(c()(this,ra).error(e),r&&c()(this,ra).error("Caused by:",r)),c()(this,ea)[t].captureException(e,{zone:t,extra:{cause:r,...n},...o})}}))],[Ue,Jo(Ue,(e=>{let{event:t,type:r}=e;return r===Ue.types.ERROR?c()(this,Zo).errorLogger.log(t):c()(this,Zo).logger.log(t)}))],[We,Jo(We,(e=>{let{name:t,params:r,run:n,onStart:o,onEnd:a}=e;return o((()=>c()(this,Qo).interactionStarted(t,r))),a((()=>c()(this,Qo).interactionEnded(t,r))),n()}))],[Be,Jo(Be,(e=>{let{event:t}=e;return c()(this,ea)[Ho].captureBreadcrumb(t)}))],[ze,e=>{let{messages:t}=e;return c()(this,ta).log(...t)}],[$e,e=>{let{message:t,level:r}=e;return c()(this,ra)[r](t)}]])}_createFedopsLogger(e){let{factory:t,hooks:{start:r,end:n}}=e;return t.getLoggerForWidget({appId:"databinding",appName:"databinding",startHook:r,endHook:n})}_createBiLoggers(e){let{bi:{factory:t},settings:{env:r}}=e;return{logger:t().logger({endpoint:r.editor?"platform":"platform-viewer"}),errorLogger:t().logger({endpoint:"trg"})}}_setupMonitor(e){let{monitor:{factory:t},global:r,settings:{metaSiteId:n,userId:o}}=e;return Object.entries(Xo).reduce(((e,a)=>{let[i,s]=a;const c=t(s);return e[i]=c,Vo({dsn:s,Raven:c,globalScope:r,appName:Fe,user:{id:o},params:{tags:{msid:n}}}),e}),{})}}function oa(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}var aa=new WeakMap,ia=new WeakMap,sa=new WeakMap,ca=new WeakMap,la=new WeakMap;class ua{constructor(){oa(this,aa,{writable:!0,value:{}}),oa(this,ia,{writable:!0,value:{}}),oa(this,sa,{writable:!0,value:{}}),oa(this,ca,{writable:!0,value:{}}),oa(this,la,{writable:!0,value:{}})}getData(e){let{datasetId:t,collectionId:r,includes:n}=e;const o=c()(this,aa)[t];return o?{datasetSize:o.datasetSize,items:o.itemIds.map((e=>da(c()(this,ia)[r][e],this.getSchema(r),n)))}:null}getRecord(e){var t;let{collectionId:r,recordId:n,includes:o}=e;const a=null==(t=c()(this,ia)[r])?void 0:t[n];return a&&da(a,this.getSchema(r),o)}updateCollectionData(e){let{collectionId:t,data:r}=e;const{[t]:n}=c()(this,ia),{[t]:o}=c()(this,sa),{items:a,uniqueFieldValues:i}=r;c()(this,ia)[t]=pa(a,n),c()(this,sa)[t]=fa(i,o)}getSchema(e){return c()(this,ca)[e]}updateStore(e){let{recordsByCollectionId:t={},recordInfosByDatasetId:r={},uniqueFieldValuesByCollection:n={}}=e;u()(this,aa,{...c()(this,aa),...r});for(const[e,r]of Object.entries(t))c()(this,ia)[e]={...c()(this,ia)[e],...r};for(const[e,t]of Object.entries(n))c()(this,sa)[e]={...c()(this,sa)[e],...t}}getStore(){return{recordInfosByDatasetId:c()(this,aa),recordsByCollectionId:c()(this,ia),uniqueFieldValuesByCollection:c()(this,sa)}}hasDataset(e){return Boolean(c()(this,aa)[e])}setUniqueFieldValues(e){let{collectionId:t,fieldKey:r,data:n}=e;c()(this,sa)[t]={...c()(this,sa)[t],[r]:n}}getUniqueFieldValues(e){var t;let{collectionId:r,fieldKey:n}=e;return null==(t=c()(this,sa)[r])?void 0:t[n]}updateSchemas(e){for(const[t,r]of Object.entries(e))c()(this,ca)[t]={...c()(this,ca)[t],...r}}getSchemas(){return c()(this,ca)}getUserFilterInitialData(e){return c()(this,la)[e]}setUserFilterInitialData(e,t){c()(this,la)[e]=t}}const da=(e,t,r)=>Object.entries(e).reduce(((e,n)=>{let[o,a]=n;return((e,t)=>{var r;return(null==t||null==(r=t.fields)||null==(r=r[e])?void 0:r.type)===m.FieldType.reference})(o,t)&&((r,o)&&Boolean(null==a?void 0:a._id)?e[o]=a._id:e[o]=a,e}),{}),pa=function(e,t){return void 0===t&&(t={}),e.reduce(((e,t)=>{const r=e[t._id];return e[t._id]=r?(0,M.mergeWith)(r,t,zn):t,e}),t)},fa=function(e,t){return void 0===e&&(e={}),void 0===t&&(t={}),{...t,...e}},ha=e=>{var t,r,n;return null===(n=null===(r=null===(t=null==e?void 0:e.plugins)||void 0===t?void 0:t[m.CMS_PLUGIN_ID])||void 0===r?void 0:r.siteSort)||void 0===n?void 0:n.sort},ma=async({datasetConfigSort:e,getSchema:t})=>{const r=e&&e.length>0?e:(n=await t(),(ha(n)||[]).map((({fieldName:e,direction:t})=>({[e]:t}))));var n;return r.length>0?r:null};function ga(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}var va=new WeakMap,ya=new WeakMap,Ea=new WeakMap,Ia=new WeakMap,_a=new WeakMap,Ta=new WeakMap,wa=new WeakMap;class Ra{constructor(){ga(this,va,{writable:!0,value:void 0}),ga(this,ya,{writable:!0,value:void 0}),ga(this,Ea,{writable:!0,value:void 0}),ga(this,Ia,{writable:!0,value:void 0}),ga(this,_a,{writable:!0,value:void 0}),ga(this,Ta,{writable:!0,value:void 0}),ga(this,wa,{writable:!0,value:void 0});const{logger:e,dataFetcher:t}=j;u()(this,ya,t),u()(this,va,e),u()(this,Ea,new ua),u()(this,Ia,{}),u()(this,_a,Promise.resolve())}createInitialDataRequest(e){u()(this,Ia,e.reduce(((e,t)=>{let{id:r,refresh:n}=t;return n||!c()(this,Ea).hasDataset(r)?{...e,[r]:new z}:e}),{}));const t=Object.entries(c()(this,Ia)).map(();u()(this,_a,this._waitForDataFetched(t).then((()=>u()(this,Ia,{}))))}async getInitialData(e){let{datasetId:t,collectionId:r,cursorPaging:n,filter:o,sort:a,length:i,includes:s,uniqueFieldValues:l}=e;return c()(this,Ia)[t]&&(c()(this,Ia)[t].resolve({datasetId:t,collectionId:r,cursorPaging:n,filter:o,sort:a,length:i,includes:s,uniqueFieldValues:l}),await c()(this,_a)),c()(this,Ea).getData({datasetId:t,collectionId:r,includes:s})||this.getData({datasetId:t,collectionId:r,cursorPaging:n,filter:o,sort:a,offset:0,length:i,includes:s,uniqueFieldValues:l})}async getSort(e){let{sort:t,collectionId:r}=e;return await ma({datasetConfigSort:t,getSchema:async()=>(await this.waitForSchemasLoaded(),this.getSchema(r))})}async getData(e){const{collectionId:t,cursorPaging:r,offset:n,filter:o,includes:a,length:i,datasetSize:s,uniqueFieldValues:l}=e,u=e=>!this.getUniqueFieldValues({collectionId:t,fieldKey:e}),d=await this.getSort(e),{items:p,totalCount:f,nextCursor:h,uniqueFieldValues:m}=await c()(this,ya).fetchData({collectionId:t,offset:n,filter:o,sort:d,includes:a,cursor:r?null==s?void 0:s.cursor:void 0,length:i,uniqueFieldValues:l.filter((e=>u(e)))}).catch(ba("Data fetching failed",{datasetConfig:e}));return await this.waitForSchemasLoaded(),c()(this,Ea).updateCollectionData({collectionId:t,data:{items:p,uniqueFieldValues:m}}),{items:p,datasetSize:{total:f,loaded:((null==s?void 0:s.loaded)||0)+p.length,cursor:h},uniqueFieldValues:m}}async remove(e){let{collectionId:t,recordId:r}=e;return c()(this,ya).remove({collectionId:t,recordId:r}).catch(ba("Record removing failed",{collectionId:t,recordId:r}))}async save(e){let{collectionId:t,record:r,includeReferences:n}=e;return c()(this,ya).save({collectionId:t,record:r,includeReferences:n}).catch(ba("Record saving failed",{collectionId:t,record:r,includeReferences:n}))}async getSibling(e){return await c()(this,ya).getSibling(e)}async loadSchemas(e){const t=c()(this,Ea).getSchemas(),r=e.filter(();u()(this,Ta,r.length?c()(this,ya).fetchSchemas(r).catch(ba("Schema fetching failed",{collectionIds:r})):Promise.resolve({}));const n=await c()(this,Ta);return c()(this,Ea).updateSchemas({...t,...n}),c()(this,Ea).getSchemas()}async setSchemasetSchemas(){return c()(this,Ea).getSchemas()}getRecord(e){let{collectionId:t,recordId:r,includes:n}=e;return c()(this,Ea).getRecord({collectionId:t,recordId:r,includes:n})}getSchema(e){return c()(this,Ea).getSchema(e)}etReferencedSchemas(e){const t=this.getSchema(e),r=c()(this,Ea).getSchemas();return(e=>e?(0,M.flow)((e=>(0,M.pickBy)(e,()),(e=>(0,M.map)(e,(e=>{let{referencedCollection:t}=e;return t}))),M.uniq,()(e.fields):[])(t).reduce((,{})}setCollectionData(e){let{collectionId:t,data:r}=e;r&&c()(this,Ea).updateCollectionData({collectionId:t,data:r})}setStore(e){e&&c()(this,Ea).updateStore(e)}setStaticStore(e){const{recordsByCollectionId:t,recordInfosInDatasetOrder:r,uniqueFieldValuesByCollectionId:n}=e,o=c()(this,wa).find((e=>{let{type:t}=e;return t===Or}));if(o){const{datasetId:e}=o,a={[e]:r[0]};c()(this,Ea).updateStore({recordsByCollectionId:t,recordInfosByDatasetId:a,uniqueFieldValuesByCollectionId:n})}}getStoreetUniqueFieldValues(e){let{collectionId:t,fieldKey:r,data:n}=e;return c()(this,Ea).setUniqueFieldValues({collectionId:t,fieldKey:r,data:n})}getUniqueFieldValues(e){let{collectionId:t,fieldKey:r}=e;return c()(this,Ea).getUniqueFieldValues({collectionId:t,fieldKey:r})}createSimpleFilter(e,t){return c()(this,ya).createSimpleFilter(e,t)}setDatasetConfigsetUserFilterInitialDataetUserFilterInitialData(e,t){c()(this,Ea).setUserFilterInitialData(e,t)}async _fetchInitialData(e){try{const{recordsByCollectionId:t,recordInfosInDatasetOrder:r,uniqueFieldValuesByCollection:n}=await c()(this,va).log(new We("dataset/fetchPrimaryInitialData",(async()=>c()(this,ya).fetchBulkData(await Promise.all(e.map((async e=>({...e,sort:await this.getSort(e)}))))))));return{recordsByCollectionId:t,recordInfosByDatasetId:r.reduce(((t,r,n)=>{let{itemIds:o=[],error:a,nextCursor:i,totalCount:s}=r;const l=e[n];return a&&c()(this,va).log(new Sa("Initial data fetching failed for one of the datasets",{cause:a,extra:{datasetConfig:l}})),t[l.datasetId]={itemIds:o,datasetSize:{total:s,loaded:o.length,cursor:i}},t}),{}),uniqueFieldValuesByCollection:n}}catch(t){throw new N("Initial data fetching failed",{cause:t,extra:{datasetConfigs:e}})}}async waitForSchemasLoaded(){await c()(this,Ta)}async _waitForDataFetched(e){if(e.length){const t=await Promise.all(e),r=await this._fetchInitialData(t);await this.waitForSchemasLoaded(),c()(this,Ea).updateStore(r)}}}class Sa{constructor(e,t){let{cause:r,...n}=t;return new(x.codes.includes(r.code)?x:L)(e,{...n,cause:r,code:r.code})}}const ba=(e,t)=>r=>{throw new Sa(e,{cause:r,extra:t})},Oa="PRIMARY";var Ca=a(8582),Pa=a.n(Ca);const Na=function(e,t,r){return void 0===r&&(r=[]),e(t)?[{path:(0,M.clone)(r),filterExpression:t}]:(n=t,Array.isArray(n)||(0,M.isPlainObject)(n)?(0,M.flatMap)(t,((t,n)=>Na(e,t,r.concat(n)))):[]);var n},Aa=e=>t=>t.reduce(((e,t)=>{let{path:r,filterExpression:n}=t;return((e,r,n)}),(0,M.cloneDeep)(e)),Da=(e,t,r)=>{const n=((e,t)=>Pa()(Qe.Maybe,t.map((t=>{let{path:r,filterExpression:n}=t;return e(n).map(()}))))(t,Na(e,r));return n.map(Aa(r))},xa=()=>()=>Qe.Maybe.fromNullable(j.platform.user).map((),La=e=>t=>{let{filterId:r}=t;return Qe.Maybe.fromNullable(e(r)).chain((e=>{let t,{masterDataset:r,fieldName:n}=e;try{t=r.api.getCurrentItem()}catch(e){}return Qe.Maybe.fromNullable(t).map(()}))},Fa=e=>Ua(e).chain((e=>{let[t,r]=e;return"$not"===t&&(0,M.isArray)(r)?Ma({positive:!1,filterExpression:r[0]}):Qe.Maybe.Nothing()})).orElse((),Ma=e=>{let{positive:t,filterExpression:r}=e;return Ua(r).chain((e=>{let[r,n]=e;return Ua(n).map((e=>{let[n,o]=e;return{field:r,condition:n,value:o,positive:t}}))}))},Ua=e=>{if(!(0,M.isPlainObject)(e))return Qe.Maybe.Nothing();const t=(0,M.entries)(e)[0];return Qe.Maybe.fromNullable(t)},{stringArray:ka,number:Ga}=m.FieldType,ja=Va=e=>{let{previousRecord:t,currentRecord:r,fieldName:n}=e;return!(0,M.isEqual)(ja(t,n),ja(r,n))},{mediaGallery:Wa}=m.FieldType,Ba="datetime",Ha=qa=za=e=>{let{time:t,date:r}=e;const[n,o]=t.split(":");return r.setHours(n),r.setMinutes(o),r.setSeconds(0),r.setMilliseconds(0),r},$a=e=>e.toTimeString().split(" ")[0]+".000",Ya=e=>{const t=new Date(e);return qa(t)?t:(()=>{const e=new Date;return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e})()},Xa=Ja=e=>[e.getFullYear(),Xa(e.getMonth()+1),Xa(e.getDate())].join("-"),Ka=e=>{let{value:t,formatter:r,fieldType:n,format:o}=e;if(o.type===Ba){const e=n===m.FieldType.date,a=((e,t)=>{switch(t){case m.FieldType.date:return new Date(e);case m.FieldType.time:return new Date("1970-01-01T"+e);default:return e}})(t,n);return qa(a)?r?r.formatDateTime(a,o.params.dateFormat,{timeZone:e?"UTC":void 0}):e&&"string"==typeof t?t:"":t}return t},Qa=e=>null==e||"function"!=typeof e.toString?"":Array.isArray(e)?e.join(", "):e.toString(),{mediaGallery:Za,address:ei,date:ti}=m.FieldType,ri=(e,t)=>{let{fieldType:r,role:n,componentIsInput:o,propPath:a}=t;const i=[{converter:condition:e&&r===ei&&n!==ye},{converter:Qa,condition:n===ae||!o&&![ce,se,_e,Re].includes(n)&&r!==m.FieldType.boolean},{converter:e=>(e=>{let{value:t}=e;const{platform:{utils:{media:r}}}=j,n=r.parseMediaItemUri(t);if(n.error)return t;switch(n.type){case r.types.IMAGE:return r.getScaleToFillImageURL(n.mediaId,n.width,n.height,n.width,n.height,{name:n.title});case r.types.VIDEO:return"https://video.wixstatic.com/video/"+n.mediaId+"/file";case r.types.AUDIO:return"https://static.wixstatic.com/mp3/"+n.mediaId;default:return t}})({value:e}),condition:"link"===a&&n!==Ee},{converter:condition:!e&&r===Za},{converter:$a,condition:n===Ie&&qa(e)},{converter:e=>{const t=new Date(e);return null!==e&&qa(t)?t:""===e||null===e?void 0:e},condition:n===pe&&r===ti}],s=i.reduce(((e,t)=>{let{converter:r,condition:n}=t;return n&&e.push(r),e}),[]);return(0,M.flow)(s)(e)};var ni=oi= ci=li=ui=function(e){return null!==/^(wix:)?(image|video)(:\/\/)/.exec(e)},di=pi=fi=hi=mi=gi=function(e,t){return void 0===t&&(t=0),e)?function(e,t){var r,n,o,a=mi(e.src);"video"===(null==(r=e.type)?void 0:r.toLowerCase())&&(null!=(n=e.src)&&n.includes("youtube")||null!=(o=e.src)&&o.includes("vimeo"))&&(a.originWidth=1920,a.originHeight=1080),a.width=e.width||a.originWidth||a.originalWidth||a.posterWidth||1,a.height=e.height||a.originHeight||a.originalHeight||a.posterHeight||1;var i=e.settings&&e.settings.focalPoint,s=a.watermark,c=e.imageToken||e.token||a.token,l=(e.type||"image").toLowerCase(),u=ii({itemId:oi(e.slug)||(oi(e.title||e.id)||ni(e.src||e.html||t))+"_"+t,mediaUrl:di(e.src),metaData:Object.assign(ii({type:l,alt:e.alt||"",title:e.title||"",description:e.description||"",name:pi(e.src),fileName:pi(e.src),link:ci(e.link,e.target),width:a.width,height:a.height,sourceName:"private"},"customButtonText"in e&&{customButtonText:e.customButtonText}),i?{focalPoint:i}:{},s?{watermarkStr:s}:{}),orderIndex:t},c&&{token:c});if("text"===l){var d=e.style;u.metaData.height=a.height||500,u.metaData.width=a.width||500*d.layoutRatio,u.metaData.textStyle={width:u.metaData.width,height:u.metaData.height,backgroundColor:d.fillColor},u.metaData.html=u.editorHtml=e.html}if("video"===l){var p={};e.thumbnail&&(p=mi(e.thumbnail));var f=di(e.thumbnail))?di(e.thumbnail):a.posterUri;u.metaData.posters=[{url:f,width:p.width||a.width,height:p.height||a.height}],u.isExternal=0===e.src.indexOf("http"),u.isExternal||ui(e.src)?(u.metaData.source=e.src.indexOf("youtube.com")>0?"youtube":e.src.indexOf("vimeo.com")>0?"vimeo":"wix",u.metaData.videoUrl=e.src):u.metaData.qualities=[{width:a.width,height:a.height,quality:a.height+"p",formats:[ui(e.src)?"wix":e.src.split(/#|\?/)[0].split(".").pop().trim()]}]}return u}(e,t):e,t)},vi=const{mediaGallery:yi,documentArray:Ei}=m.FieldType,Ii=e=>{let{value:t,currentValue:r=[],fieldType:n}=e;switch(n){case yi:return[...r,...t.map((e=>{let{fileUrl:t,url:r}=e;return(e=>{let{uploadedFileUrl:t}=e;const{platform:{utils:{media:r}}}=j,n=r.parseMediaItemUri(t),o=r.createMediaItemUri(n).item,a=gi({...n,src:o});return vi(a)})({uploadedFileUrl:t||r})}))];case Ei:return[...r,...t.map(()];default:return t[0].fileUrl||t[0].url}},{reference:_i,dateTime:Ti,date:wi}=m.FieldType,Ri=e=>{let{value:t,currentValue:r,fieldType:n,fieldName:o,role:a,utils:{referenceFetcher:i}={}}=e;const s=[{converter:condition:n===_i},{converter:e=>((e,t)=>{const r={},n={};if(Ha(e))r.time=e,r.date=new Date;else{const t=Ya(e);r.date=t,r.time=$a(t)}return Ha(t)?n.time=t:n.date=Ya(t),za({...r,...n})})(r,e),condition:n===Ti&&[pe,Ie,fe].includes(a)},{converter:Ja,condition:n===wi&&a===pe},{converter:condition:a===he}],c=s.reduce(((e,t)=>{let{converter:r,condition:n}=t;return n&&e.push(r),e}),[]);return(0,M.flow)(c)(t)},Si=e=>{let{value:t,role:r,fieldType:n,propPath:o,componentIsInput:a,format:i,utils:{formatter:s}={}}=e;return(0,M.flow)([e=>(e=>{let{value:t,formatter:r,fieldType:n,format:o}=e;return o?Ka({value:t,formatter:r,fieldType:n,format:o}):t})({value:e,formatter:s,fieldType:n,format:i}),)(t)},bi={ALIGN:SPACES:STRIKE:e=>`<span style="text-decoration: line-through" class="wixui-rich-text__text">${e}</span>`,UNDERLINE:e=>`<span style="text-decoration: underline" class="wixui-rich-text__text">${e}</span>`,ITALIC:e=>`<span style="font-style: italic" class="wixui-rich-text__text">${e}</span>`,BOLD:HIGHLIGHT:(e,t)=>`<span style="background-color: ${e}" class="wixui-rich-text__text">${t}</span>`,COLOR:,Oi=(...e)=>[...e],Ci=({expression:e,functions:t,variables:r,throwIfVariableUnknown:n})=>{if("integer"===e.type)return parseInt(e.value);if("float"===e.type)return parseFloat(e.value);if("string"===e.type)return e.value;if("function"===e.type){const o="function"==typeof e.name?e.name:t[e.name];if(o)return o(...e.arguments.map(());throw new Error("Unknown function "+e.name)}if("variable"===e.type){if("false"===e.name)return!1;if("true"===e.name)return!0;if("undefined"===e.name)return;if("null"===e.name)return null;if(n&&!(e.name in r))throw new Error("Unknown variable "+e.name);return r[e.name]}throw new Error("Unknown AST node "+JSON.stringify(e))},Pi=Ni=e=>{if(0===e.trim().length)return{type:"string",parentFunction:void 0,closed:!0,value:"",doubleQuoted:!1,startedAt:0};let t={type:"initial",parentFunction:void 0},r=0,n=e[r];const o=()=>{n=e[++r]},a=e=>{t={type:"initial",parentFunction:e},o()},i=()=>void 0===n||")"===n&&(t.parentFunction&&!t.parentFunction.closed||"function"===t.type&&!t.closed)||"]"===n&&(t.parentFunction&&t.parentFunction.name===Oi&&!t.parentFunction.closed||"function"===t.type&&t.name===Oi&&!t.closed),s=()=>{if(void 0===n){const r=t.parentFunction||t;if("function"===r.type&&!r.closed)throw Pi("Function was not closed. Started at index "+r.startedAt+" with: "+e.slice(r.startedAt))}if(t.parentFunction)return"function"!==t.type||t.closed?(t.parentFunction.closed=!0,t=t.parentFunction,t.parentFunction&&(t=t.parentFunction)):(t.closed=!0,t=t.parentFunction),void o();for(o();/^\s$/.test(n||"");)o();if(void 0!==n)throw Pi("Unexpected characters after a finished expression at index "+r+": "+e.slice(r));return t};for(;;){if("initial"===t.type){if("["===n){t={type:"function",parentFunction:t.parentFunction,closed:!1,name:Oi,startedAt:r,arguments:[]},t.parentFunction&&t.parentFunction.arguments.push(t),o();continue}if("-"===n){t={type:"integer",parentFunction:t.parentFunction,closed:!1,value:"-"},t.parentFunction&&t.parentFunction.arguments.push(t),o();continue}if(n>="0"&&n<="9"){t={type:"integer",parentFunction:t.parentFunction,closed:!1,value:n},t.parentFunction&&t.parentFunction.arguments.push(t),o();continue}if("_"===n||n>="a"&&n<="z"||n>="A"&&n<="Z"){t={type:"variable",parentFunction:t.parentFunction,closed:!1,name:n,startedAt:r},t.parentFunction&&t.parentFunction.arguments.push(t),o();continue}if('"'===n||"'"===n){t={type:"string",parentFunction:t.parentFunction,closed:!1,doubleQuoted:'"'===n,startedAt:r,value:""},t.parentFunction&&t.parentFunction.arguments.push(t),o();continue}if(/^\s$/.test(n)){o();continue}throw Pi(`Unexpected character "${n}" near: ${e.slice(r)}`)}if("function"!==t.type){if("integer"===t.type){if("."===n){t.parentFunction&&t.parentFunction.arguments.pop(),t={type:"float",parentFunction:t.parentFunction,closed:!1,value:t.value+n},t.parentFunction&&t.parentFunction.arguments.push(t),o();continue}if(n>="0"&&n<="9"){if(t.closed)throw Pi(`Integer has unexpected whitespace near: ${e.slice(r-1)}`);t.value+=n,o();continue}if(","===n&&t.parentFunction){a(t.parentFunction);continue}if(i()){const e=s();if(e)return e;continue}if(/^\s$/.test(n)){t.closed=!0,o();continue}throw Pi(`Unexpected character "${n}" after integer near: ${e.slice(r)}`)}if("float"===t.type){if(n>="0"&&n<="9"){if(t.closed)throw Pi(`Floating number has unexpected whitespace near: ${e.slice(r-1)}`);t.value+=n,o();continue}if(","===n&&t.parentFunction){a(t.parentFunction);continue}if(i()){const e=s();if(e)return e;continue}if(/^\s$/.test(n)){t.closed=!0,o();continue}throw Pi(`Floating number has an unexpected character "${n}" near: ${e.slice(r)}`)}if("string"!==t.type){if("variable"===t.type){if(n>="0"&&n<="9"||"_"===n||n>="a"&&n<="z"||n>="A"&&n<="Z"){if(t.closed)throw Pi(`Unexpected whitespace near: ${e.slice(r-1)}`);t.name+=n,o();continue}if("("===n){t.parentFunction&&t.parentFunction.arguments.pop(),t={type:"function",parentFunction:t.parentFunction,closed:!1,name:t.name,startedAt:t.startedAt,arguments:[]},t.parentFunction&&t.parentFunction.arguments.push(t),o();continue}if(","===n&&t.parentFunction){a(t.parentFunction);continue}if(i()){const e=s();if(e)return e;continue}if(/^\s$/.test(n)){t.closed=!0,o();continue}throw Pi(`Unexpected character "${n}" in an identifier near: ${e.slice(r-1)}`)}}else{if(t.closed){if(","===n&&t.parentFunction){a(t.parentFunction);continue}if(i()){const e=s();if(e)return e;continue}if(/^\s$/.test(n)){o();continue}throw Pi("Unexpected characters after a closed string at index "+r+": "+e.slice(r))}if(void 0===n)throw Pi(`${t.doubleQuoted?"Double":"Single"}-quoted string was not closed. Started with: ${e.slice(t.startedAt)}`);if("\\"===n){if("\\"!==e[r+1]&&'"'!==e[r+1]&&"'"!==e[r+1])throw Pi(`Backslash cannot escape character ${e[r+1]} near: ${e.slice(r)}`);t.value+=e[r+1],o()}else t.doubleQuoted&&'"'===n||!t.doubleQuoted&&"'"===n?t.closed=!0:t.value+=n;o()}}else{if(","===n){if(t.closed)throw Pi("Unexpected comma after a closed top-level function near: "+e.slice(r));if(0===t.arguments.length)throw Pi("Function was not closed or first argument missing. Started at index "+t.startedAt+" with: "+e.slice(t.startedAt));a(t);continue}if(i()){const e=s();if(e)return e;continue}if(/^\s$/.test(n)){o();continue}if(t.closed)throw Pi(`Unexpected character "${n}" near: ${e.slice(r)}`);t={type:"initial",parentFunction:t}}}},Ai=Object.keys(bi),Di=e=>"function"===e.type&&(!("string"!=typeof e.name||!Ai.includes(e.name))||e.arguments.some(()),xi=({expression:e,functions:t,variables:r,throwIfVariableUnknown:n=!1})=>(({expression:e,functions:t,variables:r,throwIfVariableUnknown:n})=>{const o=Ci({expression:e,functions:t,variables:r,throwIfVariableUnknown:n});return Di(e)?{html:String(o),alignment:"function"===e.type&&"ALIGN"===e.name&&e.arguments[0]?String(Ci({expression:e.arguments[0],functions:t,variables:r,throwIfVariableUnknown:n})):"left"}:o})({expression:Ni(e),functions:t,variables:r,throwIfVariableUnknown:n});var Li=ject.create;Object.create;"function"==typeof SuppressedError&&SuppressedError;let Ui;const ki=async()=>{if(Ui)return;const e=await a.e(901).then(a.bind(a,1333)),{utils:t}=e,r=Mi(e,["utils"]);Ui=Object.assign(Object.assign(Object.assign({},r),t.symbols),bi)},Gi=()=>Ui,ji=e=>{let{expression:t,record:r,prop:n,role:o,componentIsInput:a,logger:i}=e;try{const e=xi({expression:t,variables:r,functions:Gi()});if("object"==typeof e&&null!==e&&"html"in e&&"alignment"in e&&2===Object.keys(e).length){const{html:t,alignment:r}=e,i="$text"===n?"html":n;return{value:'<p class="wixui-rich-text__text" style="text-align: '+r+';">'+Si({value:t,role:o,componentIsInput:a,propPath:i})+"</p>",propPath:i}}{const t="$text"===n?"text":n;return{value:Si({value:e,role:o,componentIsInput:a,propPath:t}),propPath:t}}}catch(e){return i.log("Failed to evaluate expression: "+e),{propPath:"$text"===n?"text":n,value:""}}},Vi=e=>{let{recordStore:t}=e;return t().fold((()=>null),(e=>e.isCursorPaging()))},Wi=e=>{let{state:t}=e;const{size:r}=Qr(t);return r},Bi=e=>{let{state:t}=e;const{offset:r}=Qr(t);return r},Hi=e=>{let{state:t}=e;const{size:r,numPagesToShow:n}=Qr(t);return r*n},qi=e=>{let{state:t}=e;const r=fn(t);return null==r?null:r},zi=e=>{let{state:t}=e;if(null==qi({state:t}))return null;const{features:r}=j;if(r.newCurrentPageIndex){const{size:e,offset:r}=Qr(t);return r/e+1}const{size:n,offset:o,numPagesToShow:a}=Qr(t);return o/n+a},$i=e=>{let{recordStore:t}=e;return t().fold((,()},Yi=e=>{let{state:t,recordStore:r}=e;const n=$i({recordStore:r});return n?Math.ceil(n.total/Wi({state:t})):null},Xi=e=>{let{recordStore:t}=e;return t().fold((,(e=>{const t=e.getDatasetSize();return e.isCursorPaging()&&!(null==t||!t.cursor)}))},Ji=e=>{let{state:t}=e;const r=qi({state:t});return null!=r&&r>0},Ki=e=>{let{state:t,recordStore:r}=e;if(Xi({recordStore:r}))return!0;const n=$i({recordStore:r});if(!n)return!1;const o=qi({state:t});return null!=o&&o<n.total-1},Qi=e=>{let{state:t}=e;const{offset:r}=Qr(t);return r>0},Zi=e=>{let{state:t,recordStore:r}=e;if(Xi({recordStore:r}))return!0;const n=$i({recordStore:r});if(!n)return!1;const{offset:o,size:a}=Qr(t);return o+a<n.total},es=async e=>{let{index:t,recordStore:r}=e;await r().fold((,()},{Checkbox:ts,Dropdown:rs}=nt,ns=os=e=>{let{component:t,connectionConfig:r,currentRecord:n,previousRecord:o,getFieldType:a,formatter:i,modeIsLivePreview:s,logger:c,recordStore:l,actions:u}=e;const{role:d,isInput:p}=t,{properties:f={},totalCount:h,expressions:m={}}=r,g={};if(h&&!u.isCursorPaging()){var v;const e=null==(v=$i({recordStore:l}))?void 0:v.total;if("number"==typeof e){const r=Si({value:e,role:d});t.setValue(r,{propPath:h.prop})}}n&&(et(m).forEach((e=>{let[r,{expression:o}]=e;const{value:a,propPath:i}=ji({expression:o,record:n,prop:r,role:d,componentIsInput:p,logger:c});g[i]=a,t.setValue(a,{propPath:i})})),et(f).forEach((e=>{let[r,l]=e;try{const{fieldName:e,format:c}=l,u=a(e).getOrElse(void 0),f=Si({value:ja(n,e),role:d,componentIsInput:p,fieldType:u,propPath:r,format:c,utils:{formatter:i}});if(g[r]=f,(e=>{let{previousRecord:t,currentRecord:r,fieldName:n}=e;return((t)||Va({previousRecord:t,currentRecord:r,fieldName:n})})({currentRecord:n,previousRecord:o,fieldName:e})){if(s&&(e=>void 0===e||""===e||Array.isArray(e)&&0===e.length)(f))return;t.setValue(f,{propPath:r,fieldType:u,binding:l})}}catch(e){c.log(new N("Failed setting "+r,{cause:e}))}})))},as=e=>{let{getConnectedComponents:t,getFieldType:r}=e;return e=>{const n=t();if(!n)return Qe.Maybe.Nothing();const o=n.filter((e=>{let{role:t}=e;return t===oe}));return Fa(e).map((e=>{let{field:t,condition:n,value:a,positive:i}=e;const s=((e,t)=>e.map((e=>e===Ga&&"string"==typeof t&&/^[+-]?(?:\d+\.?\d*|\d*\.?\d+)$/.test(t.trim())?Number(t):e===ka&&0===(0,M.get)(t,"length",0)?null:t)).getOrElse(t))(r(t),((e,t)=>{const{filterId:r}=e,n=t.find(();if(!n)return;const o=ns(n);return n.getValue({propPath:o})})(a,o));if(!s&&0!==s)return{$and:[]};const c={[t]:{[n]:s}};return i?c:{$not:[c]}}))}};var is=a(4479),ss=a(8031),cs=a(3878);const ls=e=>(0,is.X)(e)||(0,ss.X)(e)||ds(e),us=e=>{let{valueResolvers:t,getConnectedComponents:r,getFieldType:n,getUserFilterInitialData:o,wasSetFilterCalled:a}=e;return e=>{const i=Da(ls,(e=>(0,is.X)(e)?t.currentUser():(0,ss.X)(e)?t.dataBinding(e):ds(e)?t.userInput(e):void 0),e).map((e=>{if(a())return e;const t=r().filter(().map((e=>{const{userInputFilter:t}=e.connectionConfig,{prop:r,fieldName:a}=t,i=e.getValue({propPath:r}),s=Zn(a)?Bn(a):a;if([De,"",!1].includes(i)||(0,M.isEqual)(i,[])||e.role===Ne&&(0,M.isEqual)(i,e.getBounds()))return null;const c=(e=>{let{value:t,fieldType:r,fieldName:n,getUserFilterInitialData:o}=e;switch(r){case m.FieldType.reference:{var a;const e=null==(a=o())?void 0:a.find(();if(!e)return null;const{referencedItemIdsByOption:r}=e;return(0,M.isArray)(t)?t.flatMap((e=>r[e])):r[t]}case m.FieldType.number:return Array.isArray(t)?t.map(Number):Number(t);default:return t}})({value:i,fieldType:n(s).getOrElse(null),fieldName:a,getUserFilterInitialData:o});if(null===c)return null;return{[s]:e.role===Ne?{$gte:c[0],$lte:c[1]}:Array.isArray(c)?{$hasSome:c}:c}})).filter(Boolean);return 0===t.length?e:{$and:[e].filter(Boolean).concat(t)}}));return i}},ds=e=>Fa(e).map(().getOrElse(!1),ps=fs=e=>!(0,M.isEmpty)(Na(cs.X,e)),hs=e=>fs(e)||(e=>!(0,M.isEmpty)(Na(is.X,e)))(e)||((e),{WRITE:ms}=e,gs=(e,t,r)=>{const{readWriteType:n,deferred:o,filter:a,collectionName:i}=e,s=n===ms,c=r.some((),l=t===Or,u=Boolean(o)&&!(c||l||s),d=a&&hs(a),p=(e=>{let{collectionId:t,datasetHasDynamicFilter:r,datasetIsDeferred:n,datasetIsRouter:o,datasetIsWriteOnly:a}=e;return t?r||n||o||a?"REGULAR":Oa:"UNCONFIGURED"})({collectionId:i,datasetHasDynamicFilter:d,datasetIsDeferred:u,datasetIsRouter:l,datasetIsWriteOnly:s});return{sequenceType:p,datasetIsWriteOnly:s,datasetIsMaster:c,datasetIsRouter:l,datasetIsDeferred:u,datasetHasDynamicFilter:d}},vs=e=>{const t=(0,M.values)({DATASET:br,ROUTER_DATASET:Or});return e.map((e=>{const{id:r,type:n,collectionId:o,filter:a,sort:i,pageSize:s,readWriteType:c,includes:l,nested:u,deferred:d,connections:p,dataIsInvalidated:f,updatedCompIds:h,dynamicPageData:m,cursor:g}=e;t.includes(n)||j.logger.log(new N("type of controller MUST be one of "+t+" but is "+n));const v=(0,M.defaults)({collectionName:o,filter:a,sort:i,includes:l,nested:u,pageSize:s,readWriteType:c,cursor:g,deferred:d,uniqueFieldValues:[]},Mt);return{id:r,compId:r,type:n,livePreviewOptions:{shouldFetchData:f,compsIdsToReset:h},connections:p,dynamicPageData:m,config:{dataset:v,datasetStaticConfig:gs(v,n,p)}}}))},ys=Symbol("isPristine"),Es=Is=_s=(e,t)=>({...e,_id:t||O().v4(),[ys]:!0}),Ts=(e,t)=>e&&t&&e._id===t._id,ws=Rs=e=>{let{record:t,draft:r,includes:n,nestedFieldKeys:o,fieldKey:a}=e;return(e=>{let{includes:t,nestedFieldKeys:r,fieldKey:n}=e;const o=null==t?void 0:t.includes(n),a=r.includes(n);return o||a})({includes:n,nestedFieldKeys:o,fieldKey:a})&&(e=>{let{record:t,draft:r,fieldKey:n}=e;return(0,M.isPlainObject)(t[n])&&(0,M.isPlainObject)(r[n])})({record:t,draft:r,fieldKey:a})},Ss={chain:e=>t=>e.matchWith({Empty:()=>e,Results:),map:e=>t=>e.matchWith({Empty:Results:e=>{let{items:r,datasetSize:n,offset:o}=e;const{items:a=r,datasetSize:i=n,offset:s=o}=t({items:r,datasetSize:n,offset:o});return bs.Results(a,i,s)}}),filter:e=>t=>e.matchWith({Empty:()=>e,Results:r=>{let{items:n,datasetSize:o,offset:a}=r;return t({items:n,datasetSize:o,offset:a})?e:bs.Empty()}}),orElse:e=>t=>e.matchWith({Empty:()=>t(),Results:()=>e}),get:e=>()=>e.matchWith({Empty:()=>({items:[],datasetSize:{total:0,loaded:0},offset:0}),Results:e=>e}),of:()=>Os},bs=(0,Qe.union)("QueryResults",{Empty:()=>({}),Results:function(e,t,r){return void 0===r&&(r=0),{items:e,datasetSize:t,offset:r}}},Ss);function Os(e){let{items:t,datasetSize:r,offset:n}=e;return r&&Math.max(r.total,r.loaded)>0&&Array.isArray(t)?bs.Results(t,r,n):bs.Empty()}const Cs={Empty:bs.Empty,Results:bs.Results,fromWixDataQueryResults:function(e,t){return e?this.of({items:e.items,datasetSize:e.datasetSize,offset:t}):bs.Empty()},of:Os},Ps=e=>Ns=(e,t)=>r=>t(e(r))(r),As=(e,t,r)=>{const n=new Map;return function(){for(var o=arguments.length,a=new Array(o),i=0;i<o;i++)a[i]=arguments[i];const s=t(a),c=n.get(s);if(c&&r(a,c.args))return c.result;const l=e.apply(this,a);return n.set(s,{args:a,result:l}),l}},Ds=e=>Ps({records:e}),xs=e=>t=>{var r,n,o;return{...t,datasetSize:{cursor:null==(r=t.datasetSize)?void 0:r.cursor,total:((null==(n=t.datasetSize)?void 0:n.total)||0)+e,loaded:((null==(o=t.datasetSize)?void 0:o.loaded)||0)+e}}},Ls=e=>{let{cursor:t,loaded:r,total:n}=e;return e=>({...e,datasetSize:{cursor:t,loaded:r+ks(e),total:n+ks(e)}})},Fs=Ms=e=>e.matchWith({Empty:Results:e=>{let{items:t,datasetSize:r}=e;return(0,M.flow)(Ds(t.map((e=>Es(e)))),Ls(r),Fs)}}),Us=e=>ks=(e,t)=>e.newRecordMarkers.filter(().length,Gs=function(e,t,r){let{overwrite:n=!0,fixIndex:o=!0}=void 0===r?{}:r;return Ns((r=>{const a=e+(o?ks(r,e):0),i=Math.max(0,a-r.records.length),s=a+(n?t.length:0);return r.records.slice(0,a).concat(new Array(i)).concat(t.map((e=>Es(e)))).concat(r.records.slice(s))}),Ds)},js=(e,t,r)=>n=>Object.assign({},e(n),...r.map((e=>({[t(e)]:e})))),Vs=(e,t,r)=>n=>({...e(n),[t]:r(e(n)[t])}),Ws=(e,t)=>r=>Object.assign({},...Object.keys(e(r)).filter((e=>e!==t)).map((t=>({[t]:e(r)[t]})))),Bs=e=>Ps({records:e}),Hs=e=>Ps({drafts:e}),qs=(0,M.curry)(((e,t,r)=>Ps({scopes:{...r.scopes,[e]:t}})(r))),zs=$s=e=>Ns(js((e=>{let{records:t}=e;return t}),Es,e),Bs),Ys=e=>Ns(js((e=>{let{drafts:t}=e;return t}),Es,[e]),Hs),Xs=e=>Ns(Ws((e=>{let{drafts:t}=e;return t}),Es(e)),Hs),Js=Ks=e=>e.matchWith({Empty:Results:e=>{let{items:t}=e;return t.length>0?$s(t):e=>e}}),Qs=(e,t)=>Ns(Vs((e=>{let{drafts:t}=e;return t}),e,(0,M.flow)(Is,(e=>t=>Object.entries(e).reduce(((e,t)=>{let[r,n]=t;return(0,M.set)(e,r,n)}),(0,M.cloneDeep)(t)))(t))),Hs),Zs=(e,t,r,n)=>{const o=t.records[e],a=t.drafts[e],i=(0,M.isPlainObject)(o),s=(0,M.isPlainObject)(a);return i&&s?(e=>{let{record:t,draft:{_id:r,...n},includes:o,nestedFieldKeys:a}=e;const i=Object.keys(n).filter((),s={...t,...n};return i.reduce(((e,r)=>({...e,[r]:(0,M.merge)({},t[r],n[r])})),s)})({record:o,draft:a,includes:r,nestedFieldKeys:n}):i?{...o}:s?{...a}:null},ec=(0,M.curry)(((e,t,r)=>Object.keys(r.scopes).filter((e=>t(r.scopes[e],e))).map(())),tc=(0,M.curry)((function(e,t,r,n,o,a,i){void 0===i&&(i=!1);const{records:s,datasetSize:c}=zs(e)(a),l=r-t,u=s.slice(t,r).reduce(((e,t)=>{const r=Zs(t,a,n,o);return null!=r?e.concat(ws(r)):e}),[]);return Cs.of({items:u,datasetSize:c,offset:t}).filter((function(e){let{items:t}=e;return i||t.length>=l}))})),rc=(0,M.curry)(((e,t)=>Ns((0,M.flow)(zs(e),t),qs(e)))),nc=(0,M.curry)((),oc=ac=(0,M.curry)(((e,t)=>Ns((0,M.flow)(oc(e),t),nc(e)))),ic=e=>e===Je,sc=e=>{let[{datasetId:t}]=e;return t},cc=(e,t)=>{let[r]=e,[n]=t;return(0,M.every)(r,((e,t)=>{return"filter"===t?(r=e,o=n[t],JSON.stringify(r)===JSON.stringify(o)):e===n[t];var r,o}))},lc=e=>{let{primaryDatasetId:t,recordStoreCache:r,refreshStoreCache:n,dataProvider:o,mainCollectionName:a,includes:i,nestedFieldKeys:s,uniqueFieldValues:c,readWriteType:l,cursorPagingRequired:u}=e;const{breadcrumbReporting:d}=j,p=()=>r[t],f=((0,M.isEmpty)(p())||n||ic(l))&&f((e=>({[e]:{records:{},drafts:{},scopes:{}}}))(a));const h=[],g=As((e=>{let{pageSize:t,sort:r,filter:n,datasetId:g,referencedCollectionName:v,fixedRecordId:y}=e;const E=null!=v?v:a,I=JSON.stringify({filter:n,sort:r}),_=oc(E),T=ac(E),w=(0,M.flow)(_,zs(I)),R=rc(I),S=()=>o.getSchema(E),b=e=>e-e%t,O=(0,M.memoize)((e=>{let{offset:t,length:a,datasetSize:s}=e;return o.getData({datasetId:g,length:a,collectionId:E,cursorPaging:U.isCursorPaging(),offset:t,filter:n,sort:r,includes:null!=v?void 0:i,uniqueFieldValues:c,datasetSize:s}).then(()}),(e=>{let{offset:t,length:r,datasetSize:n}=e;return[t,r,null==n?void 0:n.cursor].join("-")})),C=e=>U.isCursorPaging()?(async e=>{const t=[];let{datasetSize:r}=w(p());for(const{offset:n,length:o}of e){const e=await O({offset:n,length:o,datasetSize:r});if(t.push(e),r=e.datasetSize,!r.cursor)break}return t})(e):Promise.all(e.map(()),P=(e,r,n)=>{const o=U.isCursorPaging()?0:b(r),a=(i=r,s=n,Math.ceil((b(i)+(s-b(i)))/t)*t);var i,s;const c=Qn(S())||m.DefaultMaxPageSize[U.getPaging()],l=((e,t,r)=>{const n=e.records.slice(t,r),o=n.findIndex(d),a=((e,t)=>{if(t.length>0)for(let r=t.length-1;r>=0;r-=1)if(e(t[r]))return r;return-1})(d,n),i=p(o,t),s=p(a,r),c=ks(e,i),l=i-c,u=s-c-l;return 0===u?Qe.Maybe.Nothing():Qe.Maybe.Just({offset:l,length:u});unction p(t,r){return-1===t?Math.max(e.records.length,r):o+r}})(e,o,a),u=l.map((e=>{let{offset:t,length:r}=e;return r<=c?[{offset:t,length:r}]:(0,M.flatten)((0,M.times)(Math.ceil(r/c),(e=>[{offset:t+e*c,length:Math.min(c,r-e*c)}])))})).getOrElse([]);return C(u)},N=(e,t,r)=>Pa()(Qe.Result,h.map((n=>Qe.Result.try((()=>n(null!=e?ws(e):null,null!=t?ws(t):null,r)))))),A=function(e,t,r){const n=w(p()).records[r],o=Zs(n,_(p()),i,s);if(null==o)return t();{const t=function(){f((0,M.flow)(...arguments)(p()))},u=e=>{const t=Zs(n,_(p()),i,s);return(0,M.isEqual)(o,t)?Qe.Result.Ok([]):N(o,t,e)};for(var a=arguments.length,c=new Array(a>3?a-3:0),l=3;l<a;l++)c[l-3]=arguments[l];return e({update:t,notifyIfChanged:u},o,r,...c)}},D=(e,t)=>function(r){for(var n=arguments.length,o=new Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];return A(e,t,r,...o)},x=(e,t)=>async function(r){for(var n=arguments.length,o=new Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];return A(e,t,r,...o)},L=(e,t)=>d(t,Be.with({category:"recordStore",message:e,data:{datasetId:g,scope:I}})),F=e=>{return e&&(t=Es(e),!_(p()).records[t]);var t},U={getRecords:L("getRecords",(async(e,t)=>{const{datasetSize:r}=w(p()),n=(e=>{let{from:t,length:r,datasetSize:n,cursorPaging:o}=e;if(!n)return t+r;const{total:a,loaded:i,cursor:s}=n,c=o?s?1/0:i:a;return Math.min(t+r,c)})({from:e,length:t,datasetSize:r,cursorPaging:U.isCursorPaging()}),o=tc(I,e,n,i,s),a=ic(l)||!r||(e=>{let{loaded:t,total:r,cursor:n}=e;return!t&&!r&&!n})(r);return o(_(p()),a).orElse((async()=>{const t=await P(w(p()),e,n),r=T((0,M.flow)(...t.map((e=>{let{items:t,datasetSize:r,offset:n}=e;return Cs.fromWixDataQueryResults({items:t,datasetSize:r},n)})).map((e=>(0,M.flow)(Ks(e),R(e.matchWith({Empty:()=>Ls({total:0,loaded:0}),Results:e=>{let{items:t,datasetSize:r,offset:n}=e;return(0,M.flow)(Ls(r),t.length>0?Gs(n,t):e=>e)}}))))))),a=p();var i,s;return f(r(p())),i=_(a),s=_(p()),Object.keys(i.records).filter((e=>(0,M.isPlainObject)(s.records[e])&&s.records[e]._updatedDate>i.records[e]._updatedDate)).forEach((),o(_(p()),!0)}))})),getRecordsLimitedByMaxPageSize:(e,t)=>{const r=Math.min(t,Qn(S())||t);return U.getRecords(e,r)},seed:L("seed",(()=>{if(0===w(p()).numSeedRecords){return(y?o.getData({datasetId:g,length:t,collectionId:E,cursorPaging:void 0,offset:0,filter:n,sort:r,includes:null!=v?void 0:i,uniqueFieldValues:c}):o.getInitialData({datasetId:g,collectionId:E,filter:n,sort:r,includes:i,length:t,uniqueFieldValues:c})).then((e=>{const t=Cs.fromWixDataQueryResults(e,0),r=T((0,M.flow)(Ks(t),R(Ms(t))));f(r(p()))}))}return Promise.resolve()})),getTheStore:p,getPaging:()=>(({schema:e,cursorPagingPreferred:t})=>{var r,n,o;const a=null===(r=null==e?void 0:e.pagingMode)||void 0===r?void 0:r.includes(m.PagingMode.Offset),i=null===(n=null==e?void 0:e.pagingMode)||void 0===n?void 0:n.includes(m.PagingMode.Cursor);return 1===(null===(o=null==e?void 0:e.pagingMode)||void 0===o?void 0:o.length)&&i||a&&i&&t?m.PagingMode.Cursor:m.PagingMode.Offset})({schema:S(),cursorPagingPreferred:u}),isCursorPaging:()=>U.getPaging()===m.PagingMode.Cursor,getSeedRecords:L("getSeedRecords",(()=>tc(I,0,w(p()).numSeedRecords,i,s,_(p()),!0))),getDatasetSize:L("getDatasetSize",(()=>w(p()).datasetSize)),getRecordById:L("getRecordById",(e=>Qe.Maybe.fromNullable(_(p()).records[e]))),removeRecord:L("removeRecord",x((async(e,t)=>{let{update:r,notifyIfChanged:n}=e;const a=Es(t);!F(t)&&a&&await o.remove({collectionId:E,recordId:a}),O.cache.clear();const i=ec(((e,t)=>{return rc(t,(0,M.flow)((n=a,Ns((,Ds)),xs(-1),Us((r=((a,e),e=>e.filter((e=>e!==r))))));var r,n}),(s=a,e=>e.records.includes(s)),_(p()));var s;return r(T((0,M.flow)((0,M.flow)(Xs(t),(e=>Ns(Ws((e=>{let{records:t}=e;return t}),e),Bs))(a)),...i))),n()}),()),reset:L("reset",(()=>{O.cache.clear(),f(T((0,M.flow)(qs(I,{records:[],numSeedRecords:0,newRecordMarkers:[]}),Js()))(p()))})),newRecord:L("newRecord",((e,t)=>{const r=_s(t),n=T((0,M.flow)(Ys(r),R((0,M.flow)(xs(1),Ps({newRecordMarkers:[e]}),Gs(e,[r],{overwrite:!1,fixIndex:!1})))));return f(n(p())),N(null,r),ws(r)})),saveRecord:L("saveRecord",x((async(e,t,r)=>{let{update:n,notifyIfChanged:a}=e;const i=await o.save({collectionId:E,record:ws(t),includeReferences:!0});return n(T((0,M.flow)(((i),Xs(t),R((0,M.flow)(((e,t)=>Gs(e,[t],{fixIndex:!1}))(r,i),Us(()))))),a(),ws(i)}),()),setFieldsValues:L("setFieldsValues",D(((e,t,r,n,o)=>{let{update:a,notifyIfChanged:i}=e;return Object.keys(n).length&&a(T(Qs(Es(t),n))),i(o)}),(()=>Qe.Result.Error("cannot update field values: index not found")))),isPristine:L("isPristine",D(((e,t)=>(e=>"boolean"!=typeof e[ys]||e[ys])(t)),(()=>!0))),hasDraft:L("hasDraft",D(((e,t)=>((t)),(()=>!1))),isNewRecord:L("isNewRecord",D(((e,t)=>F(t)),(()=>!0))),clearDrafts:L("clearDrafts",(()=>{f(T(Js())(p()))})),resetDraft:L("resetDraft",D(((e,t,r,n)=>{let{update:o,notifyIfChanged:a}=e;return o(T(F(t)?((e,t)=>Ns(Vs((e=>{let{drafts:t}=e;return t}),Es(e),(),Hs))(t,n):Xs(t))),a()}),()),hasSeedData:L("hasSeedData",(()=>w(p()).numSeedRecords>0)),getUniqueFieldValues:L("getUniqueFieldValues",()};if(_(p())||f(nc(E,{records:{},drafts:{},scopes:{}})(p())),!_(p()).scopes[I]){const e=[];if(y){const t=o.getRecord({collectionId:E,recordId:y,includes:i})||Zs(y,_(p()),i,s),r=t?[t]:[],n=r.length>0?Cs.of({items:r,offset:0,datasetSize:{loaded:r.length,total:r.length}}):Cs.Empty(),a=n.matchWith({Empty:Qe.Maybe.Nothing,Results:(0,M.flow)(Cs.of,Qe.Maybe.Just)});(0,M.some)(r,F)&&e.push(Ks(n)),a.fold((()=>{e.push(qs(I,{records:[],numSeedRecords:0,newRecordMarkers:[]}))}),(t=>{e.push(qs(I,Ms(t)({records:[],numSeedRecords:0,newRecordMarkers:[]})))}))}else e.push(qs(I,{records:[],numSeedRecords:0,newRecordMarkers:[]}));f(T((0,M.flow)(...e))(p()))}return U.externalApi={getRecords:async(e,t)=>(await U.getRecords(e,t)).map((e=>{let{items:t,...r}=e;return{items:(0,M.cloneDeep)(t),...r}})),getSeedRecords:()=>U.getSeedRecords().map((e=>{let{items:t,...r}=e;return{items:(0,M.cloneDeep)(t),...r}})),getRecordsLimitedByMaxPageSize:async(e,t)=>(await U.getRecordsLimitedByMaxPageSize(e,t)).map((e=>{let{items:t,...r}=e;return{items:(0,M.cloneDeep)(t),...r}}))},U}),sc,cc);var v;return g.onChange=(v=h,e=>(v.push(e),),g},uc=e=>{const t={};return{setController:(r,n)=>{let{repeaterId:o,itemId:a}=r;e.log(new Be({category:"scopeStore",message:"adding scope",data:{componentId:o,itemId:a}})),t[o]=t[o]||{},t[o][a]=n},getController:e=>{let{repeaterId:r,itemId:n}=e;const o=t[r];return o&&o[n]},removeController:r=>{let{repeaterId:n,itemId:o}=r;e.log(new Be({category:"scopeStore",message:"removing scope",data:{componentId:n,itemId:o}}));const a=t[n];(0,M.get)(a,o)&&(a[o].dispose(),(0,M.unset)(a,o))},getAll:()=>Object.values(t).reduce((,[])}};var dc=a(7538);const pc=(0,Qe.union)("GoToIndexResult",{Record:InvalidIndex:()=>({}),NoRecord:),fc=function(e,t){return void 0===t&&(t=!1),{type:Bt,index:e,suppressRefreshView:t}},hc=(e,t)=>({type:kt,fieldsToUpdate:e,updateSource:t}),mc=e=>({type:tr,atIndex:e}),gc=()=>({type:nr}),vc=async(e,t,r,n)=>{const o=await e(n).fold((()=>Cs.Empty()),(e=>e.externalApi.getRecords(t,r)));return o.get()},yc=(e,t)=>vc(e,Bi({state:t}),Hi({state:t})),Ec=e=>({type:or,userFilterInitialData:e}),Ic={doFetch:vc,fetchCurrentPage:yc,flushDraft:()=>({type:Kt}),goToRecordByIndexResult:(e,t)=>({type:$t,error:e,payload:t}),incrementNumOfPagesToShow:()=>({type:Vt}),initWriteOnly:loadPage:e=>({type:zt,pageNumber:e}),newRecord:mc,newRecordResult:(e,t)=>({type:rr,error:e,payload:t}),nextPage:()=>({type:Ht}),previousPage:()=>({type:qt}),reInitWriteOnly:refresh:gc,refreshCurrentRecord:()=>({type:Gt}),refreshCurrentView:()=>({type:jt}),refreshResult:(e,t)=>({type:$t,error:e,payload:t}),remove:()=>({type:Zt}),removeCurrentRecordResult:(e,t)=>({type:er,error:e,payload:t}),revert:revertResult:(e,t)=>({type:Jt,error:e,payload:t}),saveRecordResult:(e,t)=>({type:Qt,error:e,payload:t}),setCurrentIndex:fc,setCurrentRecord:setDefaultRecord:e=>({type:Wt,record:e}),updateCurrentViewResult:(e,t)=>({type:Yt,error:e,payload:t}),updateFields:hc,GoToIndexResult:pc},_c=e=>({type:Vr,connections:e}),Tc=e=>({type:lr,filter:e}),wc=e=>({type:ur,sort:e}),Rc=e=>({type:dr,isDatasetReady:e});var Sc=a(6286),bc=a.n(Sc);const Oc=(e,t)=>{const{middleware:r,subscribe:n,onIdle:o}=bc().createMiddleware(),a=xt(Yr,void 0,Ft(r,((e,t)=>()=>r=>n=>(e.log(new Be({category:"redux",message:n.type+" (dataset: "+t+")",data:(0,M.omit)(n,"type","record")})),r(n)))(e,t)));return{store:a,subscribe:n,onIdle:o}},{READ:Cc,WRITE:Pc,READ_WRITE:Nc}=e,Ac={[Cc]:"read-only",[Pc]:"write-only",[Nc]:"read-write"},Dc=(e,t)=>{if(e)throw new D("Operation ("+t+") not allowed on a dataset with non-offset paging mode",{code:"OPERATION_NOT_ALLOWED"})},xc=(e,t)=>{if(r=e(),Sr.isDuringSave(r.records))throw new D("Operation ("+t+") not allowed during save",{code:"OPERATION_NOT_ALLOWED"});var r},Lc=function(e,t,r,n,o){void 0===t&&(t=""),void 0===o&&(o=!0),((e,t,r)=>{if(!en(e()))throw new D(r===Or?"Operation ("+t+") is not allowed because the field used to build this page's URL is empty":"Operation ("+t+") not allowed on an unconfigured dataset",{code:"OPERATION_NOT_ALLOWED"})})(e,t,n),function(e,t,r){void 0===r&&(r=[]);const n=Zr(e());if(!(0,M.includes)(r,n))throw new D("Operation ("+t+") not allowed on "+Ac[n]+" dataset",{code:"OPERATION_NOT_ALLOWED"})}(e,t,r),o||xc(e,t)},Fc=(e,t)=>{if(!(0,M.isNumber)(t))throw new D("Parameter ("+e+") must be a number",{code:"DS_INVALID_ARGUMENT"})},Mc=(e,t)=>{if(!(0,M.isInteger)(t)||t<1)throw new D("Parameter ("+e+") must be a positive integer number",{code:"DS_INVALID_ARGUMENT"})},Uc=(e,t)=>{if(!(0,M.isFunction)(t))throw new D("The callback passed to ("+e+") must be a function",{code:"DS_INVALID_ARGUMENT"})},kc=(e,t)=>{if(!tn(e()))throw new D("The dataset didn't load yet. You need to call "+t+" inside the onReady for the dataset.",{code:"DS_NOT_LOADED"})},Gc=e=>{if(null==qi({state:e()}))throw new D("There is no current item",{code:"DS_NO_CURRENT_ITEM"})},jc=(e,t)=>{if(e)throw new D('The "'+t+'" function cannot be called on the dataset because the dataset was selected using a repeated item scope selector.\nRead more about repeated item scope selectors: http://wix.to/94BuAAs/$w.Repeater.html#repeated-item-scope',{code:"OPERATION_NOT_ALLOWED"})},Vc=e=>{let{datasetType:t,siblingDynamicPageUrlGetter:r}=e;const n={getNextDynamicPage:async()=>null!=r?r.getNextDynamicPageUrl():null,getPreviousDynamicPage:;return(0,M.mapValues)(n,((e,r)=>function(){return((e,t)=>{if(e!==Or)throw new D('"'+t+'" function on the dataset is not allowed. "'+t+'" can only be called on a Dynamic Page Dataset.',{code:"OPERATION_NOT_ALLOWED"})})(t,r),e(...arguments)}))},{READ:Wc,WRITE:Bc,READ_WRITE:Hc}=e,qc=e=>{let{store:{dispatch:t,getState:r},recordStore:n,eventListeners:{fireEvent:o,register:a},controllerStore:i,datasetId:s,datasetType:c,isFixedItem:l,siblingDynamicPageUrlGetter:u,onIdle:d,dispatcher:p,onReadyAsync:f}=e;const{logger:h,errorReporting:m,breadcrumbReporting:g,verboseReporting:v}=j,y=async function(){try{await t(Ic.flushDraft());const n=(e=r(),Sr.selectLastSavedRecord(e.records)||pn(r()));return(0,M.cloneDeep)(n)}catch(e){throw p.dispatch("datasetSaveError"),e}var e},E=async function(e,o){void 0===e&&(e=(e=>{let{state:t}=e;const r=qi({state:t});return null==r?0:r+1})({state:r()})),kc(r,o),Lc(r,o,[Bc,Hc],c,!1),Fc("atIndex",e),await y(),Vi({recordStore:n})&&await es({index:e,recordStore:n}),(e=>{let{index:t,datasetSize:{total:r,loaded:n}}=e;if(t<0||t>Math.max(r,n))throw new D("Invalid index",{code:"DS_INDEX_OUT_OF_RANGE"})})({index:e,datasetSize:$i({recordStore:n})}),await t(Ic.newRecord(e))};return e=>{const p=e?(e,t)=>m(e,A.withMessage("An error occurred in one of "+t+" callbacks")):M.identity,I={async isIdle(){await new Promise((e=>{const t=d(()}))},onBeforeSave:e=>(Uc("onBeforeSave",e),Lc(r,"onBeforeSave",[Bc,Hc],c,!1),a("beforeSave",p(e,"beforeSave"))),onAfterSave:e=>(Uc("onAfterSave",e),Lc(r,"onAfterSave",[Bc,Hc],c,!1),a("afterSave",p(e,"afterSave"))),async save(){Lc(r,"save",[Bc,Hc],c,!1);const e=await y();return nn(r())&&await t(Ic.reInitWriteOnly()),e},async getItems(e,t){Lc(r,"getItems",[Wc,Hc],c,!1),Fc("fromIndex",e),Fc("numberOfItems",t);const{items:o,offset:a,datasetSize:i}=await Ic.doFetch(n,e,t);return{items:o,totalCount:Vi({recordStore:n})?void 0:i.total,offset:a}},getTotalCount:()=>(Lc(r,"getTotalCount",[Wc,Hc],c,!1),tn(r())?(Dc(Vi({recordStore:n}),"getTotalCount"),$i({recordStore:n}).total):null),getCurrentItem:()=>{Lc(r,"getCurrentItem",[Wc,Bc,Hc],c);const e=pn(r());return e?(0,M.cloneDeep)(e):null},getCurrentItemIndex:()=>(Lc(r,"getCurrentItemIndex",[Wc,Hc],c),qi({state:r()})),async setCurrentItemIndex(e){jc(l,"setCurrentItemIndex"),Lc(r,"setCurrentItemIndex",[Wc,Hc],c,!1),(e=>{if(!(0,M.isInteger)(e))throw new D("Parameter ("+e+") must be a number",{code:"PARAMETER_NOT_ALLOWED"})})(e),await new Promise((e=>T.onReady(e))),rn(r())||await y(),await t(Ic.setCurrentIndex(e))},setFieldValue:(e,n)=>{kc(r,"setFieldValue"),Lc(r,"setFieldValue",[Bc,Hc],c),Gc(r),t(Ic.updateFields({[e]:(0,M.cloneDeep)(n)}))},setFieldValues:e=>{kc(r,"setFieldValues"),Lc(r,"setFieldValues",[Bc,Hc],c),Gc(r),t(Ic.updateFields((0,M.mapValues)(e,M.cloneDeep)))},async next(){if(jc(l,"next"),kc(r,"next"),Lc(r,"next",[Wc,Hc],c,!1),rn(r())||await y(),!T.hasNext())throw new D("There are no more items in the dataset",{code:"NO_SUCH_ITEM"});const e=qi({state:r()});return await t(Ic.setCurrentIndex(e+1)),T.getCurrentItem()},async previous(){if(jc(l,"previous"),kc(r,"previous"),Lc(r,"previous",[Wc,Hc],c,!1),rn(r())||await y(),!T.hasPrevious())throw new D("This is the first item in the dataset",{code:"NO_SUCH_ITEM"});const e=qi({state:r()});return await t(Ic.setCurrentIndex(e-1)),T.getCurrentItem()},hasNext:()=>(Lc(r,"hasNext",[Wc,Hc],c),Ki({state:r(),recordStore:n})),hasPrevious:()=>(Lc(r,"hasPrevious",[Wc,Hc],c),Ji({state:r()})),new:async e=>E(e,"new"),add:async remove(){kc(r,"remove"),Lc(r,"remove",[Hc],c,!1);if(null==qi({state:r()}))throw new D("Invalid index",{code:"DS_INDEX_OUT_OF_RANGE"});await t(Ic.remove())},revert:async()=>(kc(r,"revert"),Lc(r,"revert",[Bc,Hc],c,!1),Gc(r),t(Ic.revert())),async refresh(){kc(r,"refresh"),Lc(r,"refresh",[Wc,Bc,Hc],c,!1),await t(Ic.refresh())},onCurrentIndexChanged:e=>(Uc("onCurrentIndexChanged",e),Lc(r,"onCurrentIndexChanged",[Hc,Wc],c,!1),a("currentIndexChanged",p(e,"currentIndexChanged"))),onItemValuesChanged:e=>(Uc("onItemValuesChanged",e),Lc(r,"onItemValuesChanged",[Hc,Bc],c,!1),a("itemValuesChanged",p(e,"itemValuesChanged"))),onError:e=>(Uc("onError",e),Lc(r,"onError",[Hc,Wc,Bc],c,!1),a("datasetError",p(e,"datasetError"))),onReady:e=>(Uc("onReady",e),Lc(r,"onReady",[Wc,Bc,Hc],c,!1),tn(r())?(Promise.resolve(p(e)()),M.noop):a("datasetReady",p(e,"datasetReady"))),onReadyAsync:f,async setSort(e){jc(l,"setSort"),Lc(r,"setSort",[Wc,Hc],c,!1),(e=>{if(!e||!(0,M.isFunction)(e._build))throw new D("The given sort object is invalid",{code:"DS_INVALID_ARGUMENT"})})(e),await new Promise((e=>T.onReady(e))),rn(r())||await y();const n=m((()=>e._build()),A.withMessage("Sort building failed"));await t(wc((0,M.cloneDeep)(n())))},async setFilter(e){jc(l,"setFilter"),Lc(r,"setFilter",[Wc,Hc],c,!1),(e=>{if(!e||!(0,M.isFunction)(e._build))throw new D("The given filter object is invalid",{code:"DS_INVALID_ARGUMENT"})})(e),await new Promise((e=>T.onReady(e))),rn(r())||await y();const n=m((()=>e._build()),A.withMessage("Filter building failed"));await t(Tc((0,M.cloneDeep)(n())))},loadMore:async()=>{jc(l,"loadMore"),kc(r,"loadMore"),Lc(r,"loadMore",[Wc,Hc],c,!1),await t(Ic.incrementNumOfPagesToShow())},async nextPage(){if(jc(l,"nextPage"),kc(r,"nextPage"),Lc(r,"nextPage",[Wc,Hc],c,!1),rn(r())||await y(),!T.hasNextPage())throw new D("There are no more pages in the dataset",{code:"NO_SUCH_PAGE"});await t(Ic.nextPage());const{items:e}=await Ic.fetchCurrentPage(n,r());return e},async previousPage(){if(jc(l,"previousPage"),kc(r,"previousPage"),Lc(r,"previousPage",[Wc,Hc],c,!1),rn(r())||await y(),!T.hasPreviousPage())throw new D("This is the first page in the dataset",{code:"NO_SUCH_PAGE"});await t(Ic.previousPage());const{items:e}=await Ic.fetchCurrentPage(n,r());return e},hasNextPage:()=>(Lc(r,"hasNextPage",[Wc,Hc],c),Zi({state:r(),recordStore:n})),hasPreviousPage:()=>(Lc(r,"hasPreviousPage",[Wc,Hc],c),Qi({state:r()})),getTotalPageCount:()=>(Lc(r,"getTotalPageCount",[Wc,Hc],c),tn(r())?(Dc(Vi({recordStore:n}),"getTotalPageCount"),Yi({state:r(),recordStore:n})):null),getCurrentPageIndex:()=>(Lc(r,"getCurrentPageIndex",[Wc,Hc],c),zi({state:r()})),async loadPage(e){Lc(r,"loadPage",[Wc,Hc],c,!1),jc(l,"loadPage"),kc(r,"loadPage"),Dc(Vi({recordStore:n}),"loadPage"),((e,t)=>{if(Mc("pageNumber",e),e>t)throw new D("Page "+e+" does not exist",{code:"NO_SUCH_PAGE"})})(e,T.getTotalPageCount()),rn(r())||await y(),await t(Ic.loadPage(e));const{items:o}=await Ic.fetchCurrentPage(n,r());return o},inScope:(e,t)=>{Lc(r,"inScope",[Wc,Bc,Hc],c,!1);const n=i.getController({repeaterId:e,itemId:t});return n?n.staticExports:T},getPageSize:()=>(Lc(r,"getPageSize",[Wc,Hc],c),Wi({state:r()})),async setPageSize(e){Lc(r,"setPageSize",[Wc,Hc],c,!1),Mc("size",e),await new Promise((e=>T.onReady(e))),rn(r())||await y(),await t(cr({size:e}))}},_=Vc({datasetType:c,siblingDynamicPageUrlGetter:u}),T=Object.assign(I,_),w={};for(const e in T)w[e]=(0,M.flow)((t=>g(t,Be.with({category:"datasetAPI",message:"method: "+e+" - datasetId:"+s}))),(t=>v(t,e)),(t=>{return $(t,(r=e,e=>{throw e instanceof A?h.log(new A("datasetApi '"+r+"' operation failed",{cause:e})):e instanceof L?h.log(e):h.log(new N("datasetApi '"+r+"' operation failed",{cause:e})),o("datasetError",r,e instanceof x?e.cause.message:e.cause||e),e.cause||e}));var r}))(T[e]);return w}},zc=function(e){void 0===e&&(e=M.noop);let t=!1,r={};const n=e=>r[e]?r[e]:r[e]=[],o=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return Promise.all(n(e).map(())};return{register:(e,r)=>{if(t)return M.noop;const o=(e=>$((function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return Promise.resolve(e(t,...n))}),(e=>Promise.reject(e))))(r);return n(e).push(o),()=>{(0,M.remove)(n(e),()}},executeHooks:o,fireEvent:function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return j.logger.log(new ze(ze.types.DS_API.TRIGGERED,{eventName:t,eventArgs:n})),e(t,...n),o(t,...n)},dispose:},$c=["siteButtonRole","imageButtonRole","stylableButtonRole"],Yc=[le,ue,oe,Te,...Ae],Xc=e=>e.filter((e=>{let{role:t,isInput:r}=e;return r&&!Yc.includes(t)})),Jc=(e,t)=>e.filter(().filter((e=>{let{connectionConfig:r}=e;return(0,M.includes)(t,(0,M.get)(r,"events.onClick.action"))})),Kc=(e,t,r,n)=>{e.enabled!==t&&(t?e.enable():e.disable(),r.log(new Be({category:"components",message:e.id+" changed to "+(t?"enabled":"disabled")+" (dataset: "+n+")"})))},Qc=(e,t,r,n,o)=>{let{getState:a,subscribe:i}=e;const s={new:()=>!rn(a()),save:()=>on(a()),revert:()=>on(a()),remove:()=>on(a()),next:()=>Ki({state:a(),recordStore:o}),previous:()=>Ji({state:a()}),nextPage:()=>Zi({state:a(),recordStore:o}),previousPage:()=>Qi({state:a()}),nextDynamicPage:()=>En(a()).hasUrl(),previousDynamicPage:()=>In(a()).hasUrl(),loadMore:()=>(e=>{let{state:t,recordStore:r}=e;if(Xi({recordStore:r}))return!0;const n=$i({recordStore:r});return!!n&&Bi({state:t})+Hi({state:t})<n.total})({state:a(),recordStore:o})},{inputComponents:c,linkedComponents:l}=((e,t)=>{const r=(0,M.uniqBy)(e.filter((e=>{let{enabled:t}=e;return t})),(e=>{let{id:t}=e;return t}));return{inputComponents:Xc(r),linkedComponents:Jc(r,t)}})(t,Object.keys(s)),u=c.length+l.length?i((e=>{let{getState:t,inputComponents:r,linkedComponents:n,datasetId:o,logger:a,shouldEnableLinkedComponent:i}=e;return()=>{const e=t();if(!tn(e))return;const s=on(e);r.forEach((),n.forEach((e=>{const{action:t}=e.connectionConfig.events.onClick,r=i[t]();Kc(e,r,a,o)}))}})({getState:a,inputComponents:c,linkedComponents:l,datasetId:n,logger:r,shouldEnableLinkedComponent:s})):M.noop;return u},Zc=Object.assign(Object.assign({SHORT_DATE:"SHORT_DATE",MEDIUM_DATE:"MEDIUM_DATE",LONG_DATE:"LONG_DATE",FULL_DATE:"FULL_DATE",SHORT_DATE_TIME:"SHORT_DATE_TIME",LONG_DATE_TIME:"LONG_DATE_TIME",FULL_DATE_TIME:"FULL_DATE_TIME"},{MEDIUM_TIME_12:"MEDIUM_TIME_12",MEDIUM_TIME_24:"MEDIUM_TIME_24",LONG_TIME_12:"LONG_TIME_12",LONG_TIME_24:"LONG_TIME_24",HOUR_ONLY:"HOUR_ONLY",MINUTE_ONLY:"MINUTE_ONLY"}),{YEAR_ONLY:"YEAR_ONLY",MONTH_ONLY:"MONTH_ONLY",SHORT_MONTH_ONLY:"SHORT_MONTH_ONLY",DAY_ONLY:"DAY_ONLY"}),el=(new Set([Zc.SHORT_DATE_TIME,Zc.LONG_DATE_TIME,Zc.FULL_DATE_TIME,Zc.MEDIUM_TIME_12,Zc.MEDIUM_TIME_24,Zc.LONG_TIME_12,Zc.LONG_TIME_24,Zc.HOUR_ONLY,Zc.MINUTE_ONLY]),{[Zc.SHORT_DATE]:{day:"numeric",month:"numeric",year:"2-digit"},[Zc.MEDIUM_DATE]:{day:"numeric",month:"short",year:"numeric"},[Zc.LONG_DATE]:{day:"numeric",month:"long",year:"numeric"},[Zc.FULL_DATE]:{day:"numeric",month:"long",year:"numeric",weekday:"long"},[Zc.SHORT_DATE_TIME]:{day:"numeric",month:"numeric",year:"2-digit",hour:"numeric",minute:"numeric"},[Zc.LONG_DATE_TIME]:{day:"numeric",month:"long",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric"},[Zc.FULL_DATE_TIME]:{day:"numeric",month:"long",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric",weekday:"long",timeZoneName:"short"},[Zc.MEDIUM_TIME_12]:{minute:"numeric",hour:"numeric",hour12:!0},[Zc.MEDIUM_TIME_24]:{minute:"numeric",hour:"numeric",hour12:!1},[Zc.LONG_TIME_12]:{minute:"numeric",hour:"numeric",second:"numeric",hour12:!0},[Zc.LONG_TIME_24]:{minute:"numeric",hour:"numeric",second:"numeric",hour12:!1},[Zc.HOUR_ONLY]:{hour:"numeric"},[Zc.MINUTE_ONLY]:{minute:"numeric"},[Zc.YEAR_ONLY]:{year:"numeric"},[Zc.MONTH_ONLY]:{month:"long"},[Zc.SHORT_MONTH_ONLY]:{month:"short"},[Zc.DAY_ONLY]:{weekday:"long"}}),tl=({locale:e,timeZone:t}={})=>{if(!e)throw new Error('A "locale" parameter is required for wixFormatting');return{formatDateTime(r,n,{locale:o,timeZone:a}={}){const i=Object.assign(Object.assign({},el[n]),{timeZone:a||t});return new Intl.DateTimeFormat(o||e,i).format(r)},dateFormats:Zc}},rl=e=>(0,M.isEqual)(!1,e);function nl(e,t){return(0,M.mapValues)(t,((t,r)=>e(r).map((e=>function(e,t){switch(e){case"number":return Number(t);case"boolean":if("string"==typeof t)return"true"===t.toLowerCase()||"1"===t.toLowerCase();break;case"text":if(null!=t&&"function"==typeof t.toString)return t.toString()}return t}(e,t))).getOrElse(t)))}const ol=function(e,t,r,n,o,a,i,s){const{logger:c,errorReporting:l,breadcrumbReporting:u}=j,d=(e,t)=>u(t,Be.with({category:"effects",message:e,data:{datasetId:o}}));unction f(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return l(i,N.withMessage("Dataset "+e+" event execution failed"))(e,...r)}onst m=e=>{throw new D(e,{code:"DS_OPERATION_FAILED"})};return{goToRecordByIndex:(t,r,n)=>({run:d("goToRecordByIndex",(async function(){let o;Vi({recordStore:e})&&await es({index:r,recordStore:e});try{o=(e=>{let{recordStore:t,index:r}=e;const{total:n,loaded:o}=t().fold((e=>{throw e}),(e=>e.getDatasetSize()));return Math.max(Math.min(r,Math.max(n,o)-1),0)})({recordStore:e,index:r})}catch(e){m(e)}if(t!==o||n){const t=await(a=o,e().fold(m,(e=>e.getRecords(a,1))));return t.matchWith({Empty:()=>Ic.GoToIndexResult.NoRecord(),Results:e=>{let{items:t}=e;return Ic.GoToIndexResult.Record(o,t[0])}})}return Ic.GoToIndexResult.InvalidIndex();var a})),isQueued:!0,resultActionCreator:Ic.goToRecordByIndexResult}),setFieldsInCurrentRecord:(t,n,o)=>({run:d("setFieldsInCurrentRecord",(function(){const a=nl(r,t);return e().fold(m,(e=>e.setFieldsValues(n,a,o).fold((,(()=>{}))))})),isQueued:!1}),revertChanges:(t,r)=>({run:d("revertChanges",(function(){e().chain((e=>e.resetDraft(t,r))),p()})),isQueued:!1,resultActionCreator:Ic.revertResult}),saveRecord:(t,r)=>({run:d("saveRecord",(async function(){return await(c.log(new ze(ze.types.DS_API.TRIGGERED,{eventName:"beforeSave"})),n("beforeSave").then((e=>e.some(rl))).catch((e=>({error:e}))).then((e=>{if(e)throw new D("Operation cancelled by user code. "+((0,M.isBoolean)(e)?"":e.error),{code:"DS_OPERATION_CANCELLED"})}))),e().fold((()=>!1),(async e=>{if(e.hasDraft(t)){!function(e){const t=a.filter((t=>!t.isValid(e)));if(t.forEach((e=>e.updateValidityIndication())),t.length)throw new D("Some of the elements validation failed",{code:"DS_VALIDATION_ERROR"})}(r);const n=await e.saveRecord(t);return f("afterSave",r,n),s.dispatch("afterSave",r,n),n}}))})),isQueued:!0,resultActionCreator:Ic.saveRecordResult}),removeCurrentRecord:t=>({run:d("removeCurrentRecord",(()=>function(t){return e().fold(m,(e=>e.removeRecord(t)))}(t))),isQueued:!0,resultActionCreator:Ic.removeCurrentRecordResult}),newRecord:(t,r)=>({run:d("newRecord",(()=>function(t,r){return e().fold(m,(e=>e.newRecord(t,r)))}(t,r))),isQueued:!0,resultActionCreator:Ic.newRecordResult}),fireEvent:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return{run:d("fireEvent",(()=>f(e,...r))),isQueued:!1}},notifyIndexChange:e=>({run:d("notifyIndexChange",(()=>{t.onCurrentIndexChanged(),f("currentIndexChanged",e)})),isQueued:!1}),notifyRecordSetLoaded:()=>({run:d("notifyRecordSetLoaded",h),isQueued:!0}),updateCurrentView:e=>({run:d("updateCurrentView",(),isQueued:!0,resultActionCreator:Ic.updateCurrentViewResult}),refresh:(t,r,n)=>({run:d("refresh",(async function(){return e().fold(m,(async e=>(e.reset(),n?Ic.GoToIndexResult.Record(0,e.newRecord(0,r)):e.getRecords(0,1).then((e=>e.matchWith({Empty:Results:e=>{let{items:t}=e;return Ic.GoToIndexResult.Record(0,t[0])}}))))))})),isQueued:!0,resultActionCreator:Ic.refreshResult}),updateComponents:(e,t)=>({run:d("updateComponents",(),isQueued:!1})}},al=il=e=>En(e).shouldLoadUrl(),sl=cl=e=>{let{getNextDynamicPageUrl:t,getPreviousDynamicPageUrl:r}=e;const n={run:t,isQueued:!0,resultActionCreator:(e,t)=>({type:Gr,error:e,payload:t})},o={run:r,isQueued:!0,resultActionCreator:,a=e=>{let{hasChangedToTrue:t}=e;const r=[];return t(il)&&r.push(n),t(sl)&&r.push(o),r};return e=>(0,M.flatten)([a].map((t=>t(e))))},ll=/[^{}]+(?=\})/g,ul=/[^\dA-Za-z]/g,dl=async e=>{let{dataProvider:t,dynamicPagesData:{dynamicPageData:r,datasetConfig:{dataset:{sort:n,collectionName:o}},items:a}}=e;const i=await t.getSort({sort:n,collectionId:o})||[],{dynamicUrl:s,userDefinedFilter:c}=r,l=(0,Gn.PL)(a)[0],{fieldName:u,fieldDefinition:d}=vl({dynamicUrl:s,schema:t.getSchema(o)}),p=s&&l?d&&(!(h=d).queryOperators||[m.AllowedFilterOperator.gt,m.AllowedFilterOperator.lt].every(())?[u]:(f=s,f=((f),{fields:f.match(ll)||[],nonFields:f.replace(ll,"").split(ul).filter(()}).fields:[];var f,h;const g=pl(i),v=(0,M.difference)(p,g),y=fl([...i,...hl(v)]),E=[...g,...v];return{dynamicUrl:s,userDefinedFilter:c,dynamicUrlPatternFieldsValues:ml(l,E,p),sort:y,sortFields:E,patternFields:p}},pl=e=>(0,M.flatten)(e.map(()),fl=e=>e.reduce((,{}),hl=e=>e.map((),ml=(e,t,r)=>{const n=r.concat(t);return r.length?(0,M.pick)(e,n):null},gl=async e=>{let{dataProvider:t,collectionName:r,directionTowardSibling:n,dynamicPagesData:o}=e;const{dynamicUrl:a,userDefinedFilter:i,dynamicUrlPatternFieldsValues:s,sort:c,sortFields:l,patternFields:u}=o?await dl({dynamicPagesData:o,dataProvider:t}):{};if(null==a||!u.length)return null;const d=await t.getSibling({collectionName:r,sort:c,sortFields:l,directionTowardSibling:n,fieldValues:s,filter:i}),{fieldName:p}=vl({dynamicUrl:a,schema:t.getSchema(r)});return d&&p?d[p]:void 0},vl=e=>{let{schema:t,dynamicUrl:r}=e;const[n,o]=Object.entries(t.fields).find((e=>{let[t,n]=e;return n.type===m.FieldType.pageLink&&n.calculator.config.pattern===r}))||[];return{fieldName:n,fieldDefinition:o}},yl=(e,t)=>{try{return El(e(t))}catch(e){return Il(e)}},El=e=>({value:e,then:t=>yl(t,e),catch:()=>El(e)}),Il=e=>({error:e,then:()=>Il(e),catch:t=>yl(t,e)}),_l={resolve:El,reject:Il},Tl=e=>{let{recordStore:t}=e;const{logger:r}=j;return t().fold((()=>Promise.resolve(Qe.Maybe.Nothing())),(e=>e.hasSeedData()?(e=>e.getSeedRecords().matchWith({Empty:Results:e=>{let{items:t}=e;return _l.resolve(Qe.Maybe.Just(t[0]))}}))(e):r.log(new We("dataset/pageReady/getData",(()=>(e=>e.seed().then((()=>e.getRecords(0,1).then((e=>e.chain((e=>{let{items:t}=e;return Qe.Maybe.Just(t[0])})))))).catch((e=>(r.logError(e,"Fetch initial data failed"),Qe.Maybe.Nothing()))))(e))))))},wl=e=>{let{shouldFetchInitialData:t,recordStore:r,store:n,filter:o,sort:a,datasetIsDeferred:i,modeIsSSR:s,queueMicrotask:c,datasetIsReal:l,collectionId:u,filterResolver:d,dependencyManager:p,getSchemas:f,schemasLoading:h,getUserFilterInitialData:m}=e;const g=()=>{const e=(i=n.getState(),kr.getUserFilterConnectionProps(i.config));var i;const s=t?Tl({recordStore:r}):Promise.resolve();if(!(l&&(null==e?void 0:e.length)>0))return s.then(();const c=d(o).map((async t=>{const r=m();if(r)return n.dispatch(Ec(r)),r;await h;const o=f(),i=o[u];if(i){const r=await j.dataFetcher.fetchUserFilterInitialData({filter:t,sort:await ma({datasetConfigSort:a,getSchema:()=>i}),userFilterConnectionProps:e,schema:i,schemas:o});return n.dispatch(Ec(r)),r}})).getOrElse(null);return Promise.all([s,c])},v=p.getDependencyResolutionPromise(o),y=i&&((e,t)=>{const{promise:r,resolve:n}=new z;return e||t(n),r})(s,c),{waitingForUserInput:E,resolveUserInputDependency:I}=fs(o)&&(()=>{const{promise:e,resolve:t}=new z;return{waitingForUserInput:e,resolveUserInputDependency:t}})(),_=[v,y,E].filter((e=>Boolean(e)));return{fetchingInitialData:_.length?Promise.all(_).then(g):g(),resolveUserInputDependency:},Rl=e=>{let{value:t,fieldName:r,record:n,getFieldType:o}=e;const a=(e=>{let{value:t,currentValue:r,fieldType:n}=e;return n===m.FieldType.date&&qa(t)?Ja(t):Ha(r)&&qa(t)?za({time:r,date:t}):qa(r)&&Ha(t)?za({time:t,date:r}):t})({value:t,currentValue:(0,M.get)(n,r),fieldType:o(r).getOrElse(null)});(0,M.set)(n,r,a)},Sl=(e,t)=>{const r=["value","checked"];return e.reduce(((e,n)=>{var o;const a=(null==(o=n.connectionConfig)?void 0:o.properties)||{};return r.forEach((r=>{(0,M.has)(a,r)&&Rl({value:n.getValue({propPath:r}),fieldName:a[r].fieldName,record:e,getFieldType:t})})),e}),{})},bl=(e,t,r)=>{var n;return t===r||(null==(n=e[t])?void 0:n.some(())},Ol=e=>{let{components:t,connectionsGraph:r,updatedCompIds:n,datasetIsReal:o}=e;const a=t.filter((e=>(e=>{let{component:t,updatedCompIds:r,datasetIsReal:n,connectionsGraph:o}=e;if(r.length&&n){const{id:e}=t;return r.some((t=>bl(o,e,t)||bl(o,t,e)))}return!0})({component:e,connectionsGraph:r,updatedCompIds:n,datasetIsReal:o})));return a.some((e=>{let{role:t}=e;return t===oe}))?t:a},Cl=(e,t)=>{let{repeaterId:r,itemId:n}=t;return[e,"componentId",r,"itemId",n].join("_")},Pl=Nl=(e,t)=>{const{logger:r}=j;return(n,o,a)=>{const i=((e,t)=>(0,M.isNull)(e)&&(0,M.isNull)(t))(n,o);if(i)return void r.log(new N("onChangeHandler invoked with illegal arguments",{extra:{arguments:{before:n,after:o,componentIdToExclude:a}}}));if((e=>(0,M.isNull)(e))(n))return void t(Ic.refreshCurrentView()).catch((()=>{}));const s=pn(e());if(((0,o))return Ts(n,s)&&t(Ic.refreshCurrentRecord()).catch((()=>{})),void t(Ic.refreshCurrentView()).catch((()=>{}));if(((n,s)){const r=qi({state:e()});t(Ic.setCurrentRecord(o,r,a)).catch((()=>{}))}}},Al=e=>{let{detailsDatasetApis:t,masterDatasetApi:r,controllerConfig:n,unsubscribeHandlers:o}=e;const{logger:a}=j;t.forEach((e=>{const t=()=>{o.push(Dl({masterDatasetApi:r,masterDatasetConfig:n,detailsDatasetApi:e}))};try{o.push(r.onReady(t))}catch(e){a.log(new $e(new D("The dataset cannot filter by the dynamic dataset because the field used to build this page's URL is empty",{code:"DS_EMPTY_URL_FIELD",cause:e}),"error"))}}))},Dl=e=>{let{masterDatasetConfig:t,masterDatasetApi:r,detailsDatasetApi:n}=e;const o=fr(t.dataset);let a,i;return o!==Je&&(a=r.onCurrentIndexChanged(()),o!==Xe&&(i=r.onItemValuesChanged((()=>n.refresh()))),()=>[a,i].forEach(()},{richText:xl}=m.FieldType,Ll={$text:,Fl=e=>{let{propName:t,getFieldType:r}=e;return t in Ll?Ll[t](r()):t},Ml=Ul=e=>({id:e.id,role:e.role,isValidConnection:()=>!0,bind:()=>{},clear:()=>e.clear(),hide:()=>e.hide(),show:t=>e.show(t),resetUserFilter:()=>{},onRecordsLoaded:async()=>{},onCurrentViewChanged:async()=>{},onCurrentIndexChanged:async()=>{},onCurrentRecordModified:async()=>{}}),kl=e=>!!e&&Object.values(e).some((),Gl=(e,t,r)=>{const{logger:n,platform:{location:o,utils:a,executeTpaAction:i}}=j,{getState:s,getFieldType:c,wixFormatter:l,modeIsLivePreview:u}=r,d=o=>{os({currentRecord:pn(s()),previousRecord:o,component:e,connectionConfig:t,formatter:l,modeIsLivePreview:u,getFieldType:c,logger:n,recordStore:r.recordStore,actions:r.actions})},p=e=>e.matchWith({Empty(){},LoadingLoaded),f=t=>{const{datasetApi:s,getState:c,actions:l}=r;(0,M.forEach)(t,((t,r)=>{let{action:u,postAction:d}=t;e.on(r,(async()=>{try{if(u.startsWith("tpa/")){const e=s.getCurrentItem();return void await i({currentItem:e,action:u})}if("nextDynamicPage"===u)return p(En(c()));if("previousDynamicPage"===u)return p(In(c()));if("applyUserInputFilters"===u)return l.refresh();if("resetUserFilter"===u)return l.resetUserInputFilters();const e=await Promise.resolve(s[u]());if(d&&d.navigate){const t=((e,t)=>e.fieldName?ja(t,e.fieldName):e.linkObject?a.links.toUrl(e.linkObject):void 0)(d.navigate,e);o.navigateTo(t)}}catch(e){e instanceof P||n.log(new N(u+" operation failed:",{cause:e}))}}))}))};return{...Ul(e),isValidConnection:bind(){const{events:n,behaviors:o}=t;n&&f(n),o&&(t=>{const{dispatcher:n,eventListeners:{register:o}}=r;t.forEach((t=>{let r=!1;switch(t.type){case"saveSuccessFeedback":o("beforeSave",(()=>e.hide())),o("afterSave",(),o("currentIndexChanged",(()=>{r?r=!1:e.hide()})),o("itemValuesChanged",(()=>e.hide()));break;case"saveFailureFeedback":o("beforeSave",(()=>e.hide())),o("currentIndexChanged",(()=>e.hide())),n.subscribe("datasetSaveError",()}}))})(o)},clear(){const{getFieldType:n}=r,{properties:o}=t;(0,M.forEach)(o,((t,r)=>{const o=n(t.fieldName).getOrElse(void 0),a=(e=>e===Wa?[]:void 0)(o);e.setValue(a,{propPath:r,fieldType:o,binding:t})}))},async onRecordsLoaded(){const{behaviors:t}=e.connectionConfig;d(),t&&t.forEach(()},async onCurrentViewChanged(){d()},async onCurrentIndexChangedasync onCurrentRecordModified(e){d(e)}}};const jl=(e,t)=>{return r=e,n=t,Object.defineProperties({},{...Object.getOwnPropertyDescriptors(r),...Object.getOwnPropertyDescriptors(n)});var r,n},Vl=e=>{const t={getValue:()=>e.data,setValueclearonItemReady(t){e.onItemReady(t)},onItemRemoved;return jl(ql(e),t)},Wl=e=>"onChange"in e&&("value"in e||"checked"in e),Bl=(e,t)=>{const r=t.split("."),n=r.slice(0,-1),[o]=r.slice(-1);return{obj:n.length>0?(0,M.get)(e,n):e,prop:o}},Hl=e=>{if(!e||!e.parent)return;const{parent:t}=e;return t.type===nt.Repeater?Vl(t):Hl(t)},ql=e=>{const{connectionConfig:t,uniqueId:r,type:n,role:o,id:a}=e,i=!!e.hidden,s={id:r,connectionConfig:t,nickname:a,type:n,role:o,isInput:Wl(e),parentRepeater:Hl(e),getValue(t){let{propPath:r}=void 0===t?{}:t;if(r){const{obj:t,prop:n}=Bl(e,r);return t[n]}},setValue(t,r){let{propPath:n,fieldType:o,binding:a}=void 0===r?{}:r;if(n){const{obj:r,prop:i}=Bl(e,n);r[i]="reference"===o&&(e=>(0,M.isObject)(e)&&(0,M.has)(e,"_id"))(t)?t._id:t;const s=null==a?void 0:a.linkTarget;((o)&&s&&(r.target=s)}},setOptionshide(){e.hidden||null==e.hide||e.hide()},show(t){let{ignoreInitiallyHidden:r}=void 0===t?{ignoreInitiallyHidden:!1}:t;!e.hidden||r&&i||null==e.show||e.show()},clearget enabled(){return!("enabled"in e)||e.enabled},enable(){"enable"in e&&!s.enabled&&e.enable()},disable(){"disable"in e&&s.enabled&&e.disable()},isValid:()=>!("validity"in e)||"object"!=typeof e.validity||e.validity.valid,updateValidityIndication(){"updateValidityIndication"in e&&e.updateValidityIndication()},resetValidityIndicationonChangeon;return"placeholder"in e&&Object.defineProperty(s,"placeholder",{get:),s},zl=e=>{switch(e.role){case ae:return(e=>{const t={setValue(t,r){let{fieldType:n,propPath:o="text",binding:a}=void 0===r?{}:r;if(n===m.FieldType.url){const r=(null==a?void 0:a.linkTarget)||"_blank";e.text="<a href="+t+' target="'+r+'" style="text-decoration: underline">'+t+"</a>";const{html:n}=e;return e.text="",void(e.html=(0,M.unescape)(n))}n!==m.FieldType.richText?e[o]=t:e.html=t},clear(t){let{fieldType:r}=void 0===t?{}:t;const n=r===m.FieldType.richText||r===m.FieldType.url?"html":"text";e[n]=""}};return jl(ql(e),t)})(e);case me:case re:return Vl(e);case de:return(e=>{const t={get nextEnabled(){return e.nextEnabled},set nextEnabled(t){e.nextEnabled=t},get previousEnabled(){return e.previousEnabled},set previousEnabled(t){e.previousEnabled=t},setValue(t){e.rows=t},getValue:()=>e.rows,set rows(e){t.setValue(e)},get rows(){return e.rows},get columns(){return e.columns},clear(){e.rows=[],e.dataFetcher=void 0},set dataFetcher(t){e.dataFetcher=t},refresh:()=>e.refresh(),onCellSelect:t=>e.onCellSelect(t),onRowSelect:t=>e.onRowSelect(t)};return jl(ql(e),t)})(e);case he:return(e=>{const t={isValid(t){const{connectionConfig:r,validity:n}=e;if(n.valid)return!0;if((0,M.some)((0,M.values)((0,M.omit)(n,["valid","valueMissing"])),(e=>e)))return!1;const o=(0,M.get)(r,"properties.value.fieldName")||"";return!(0,M.isEmpty)(ja(t,o))},set fileType(t){e.fileType=t},get fileType(){return e.fileType},getValue:()=>e.value,clear(){e.reset()},uploadFiles:async()=>e.uploadFiles()};return jl(ql(e),t)})(e);case we:return(e=>{const t=ql(e),r={setValue;return jl(t,r)})(e);case ie:return(e=>{e.clickAction&&(e.clickAction=e.clickAction);const t={setValue(t){e.items=t},getValue:()=>e.items,clear(){e.items=[]},set currentIndex(t){try{e.galleryCapabilities.hasCurrentItem&&(e.currentIndex=t)}catch(e){}},get currentIndex(){return e.currentIndex},get clickAction(){return e.clickAction},onCurrentItemChanged(t){e.galleryCapabilities.hasCurrentItem&&e.onCurrentItemChanged((e=>{let{item:r,itemIndex:n}=e;return t(r,n)}))}};return jl(ql(e),t)})(e);case ve:return(e=>{const t={get currentPage(){return e.currentPage},set currentPage(t){e.currentPage=t},get totalPages(){return e.totalPages},set totalPages(t){e.totalPages=t},get nextEnabled(){return e.nextEnabled},set nextEnabled(t){e.nextEnabled=t},get previousEnabled(){return e.previousEnabled},set previousEnabled(t){e.previousEnabled=t},get navigationType(){return e.navigationType},set navigationType(t){e.navigationType=t},onNextClicked(t){e.onNextClicked(t)},onPreviousClicked(t){e.onPreviousClicked(t)}};return jl(ql(e),t)})(e);case Ee:return(e=>{const t={setValue(t){e.location=t},getValue:()=>e.location,clear(){e.markers=[]},set location(t){e.location=t},get location(){return e.location},set markers(t){e.markers=t},get markers(){return e.markers},setCenter(t){e.setCenter(t)}};return jl(ql(e),t)})(e);case Ne:return(e=>{const t={setValue(t){e.value=t},getValue:()=>e.value,clear(){e.value=[]},setBoundsgetBounds:;return jl(ql(e),t)})(e);default:return ql(e)}},$l=e=>t=>{const r=[],n=[];(0,M.uniq)(t.map((e=>{let{role:t}=e;return t}))).forEach((t=>{if(t===ne){return void(e("@"+t)||[]).forEach(()}if(t===ge){const t=e("@"+ge)||[],[n]=Array.isArray(t)?t:[t],o=e("Document");if(o&&n){const e=new Proxy(o,{get:(e,t)=>"connectionConfig"===t?n.connectionConfig:"role"===t?ge:e[t]});r.push(e)}return}(e("@"+t)||[]).forEach(()}));return{components:r.map((e=>zl(e))),detailsDatasetApis:n}},Yl=(e,t,r)=>{const{logger:n,errorReporting:o}=j,{getState:a,getFieldType:i,actions:s,modeIsLivePreview:c}=r,l=o=>{os({currentRecord:pn(a()),previousRecord:o,component:e,connectionConfig:t,modeIsLivePreview:c,getFieldType:i,logger:n,recordStore:r.recordStore,actions:r.actions})},u=()=>{const t=s.isCurrentRecordPristine(a()),r=s.isCurrentRecordNew(a());t&&r&&e.resetValidityIndication()};return{...Ul(e),isValidConnection:()=>kl(t),bind(){(()=>{const{id:r,role:n}=e,{properties:c}=t;e.onChange(o((e=>{const t=c.checked?"checked":"value",o=c[t].fieldName,l=pn(a()),u=Ri({value:e.target[t],currentValue:ja(l,o),fieldType:i(o).getOrElse(void 0),fieldName:o,utils:{referenceFetcher:(e,t)=>s.fetchRecordById(e,t).getOrElse(e)},role:n});s.setFieldInCurrentRecordAndSynchronize(o,u,r)}),N.withMessage("Input adapter onChange - setting value to record failed")))})(),t.filters&&e.onChange(o(s.refresh,N.withMessage("Input adapter onChange - sync actions failed")))},async onRecordsLoaded(){l(),u()},async onCurrentViewChanged(){l(),u()},async onCurrentIndexChangedasync onCurrentRecordModified},Xl={start:0,end:0},Jl=(e,t)=>{let{valueSource:r,labelField:n,dataTransformer:o}=t;const a=o(e,r);return{value:a,label:n?o(e,{type:"field",fieldName:n}):a}},Kl=Ql=(e,t,r)=>{const{errorReporting:n}=j,{actions:o,recordStore:a,getState:i}=r,s=t.userInputFilter.fieldName;e.onChange(n((async()=>{const t=Tn(i()),n=(c=i(),Sr.selectIsApplyUserInputFiltersActionBindingPresent(c.records));var c;if(t||n)return;await o.refresh();const l=a().fold((()=>{}),(),u=Xr(i());(e=>{let{state:t,numberOfResults:r,filteredBy:n,componentType:o,fieldType:a,schema:i}=e;const{logger:s,platform:{settings:{env:{editor:c}}}}=j,l=Zr(t),u=Xr(t);if(!u)return;const d=i.getOrElse({displayName:u}).displayName;s.log(new kn({id:c?366:371,collectionId:u,collectionName:d,datasetMode:l,numberOfResults:r,filteredBy:n,componentType:o,fieldType:a}))})({filteredBy:s,numberOfResults:l,state:r.getState(),componentType:e.type,fieldType:r.getFieldType(s).getOrElse(void 0),schema:r.getSchema(u)})}),N.withMessage("Filter input adapter onChange failed")))},Zl=(e,t,r)=>{const{i18n:n}=j,{getState:o}=r,a=t=>{const r=Array.isArray(e.getValue({propPath:t}))?[]:De;e.setValue(r,{propPath:t})};return{...Ul(e),isValidConnection:()=>Cr(t),bind(){Ql(e,t,r);const{userInputFilter:{prop:i,fieldName:s}}=t,c=(e=>{var t;return null==(t=Cn(o()))?void 0:t.find((t=>t.fieldName===e&&xe.includes(t.role)))})(s);c&&(e.setOptions((e=>{let{component:t,prop:r,userFilterInitialData:o}=e;return[!Array.isArray(t.getValue({propPath:r}))&&{value:De,label:n.t("USER_INPUT_FILTER_OPTION_RESET_ALL")},...o.options.map(()].filter(Boolean)})({component:e,prop:i,userFilterInitialData:c})),((e)||a(i))},resetUserFilter(){const{userInputFilter:{prop:r}}=t;e.getValue({propPath:r})&&a(r)}}},eu=new Map([[me,(e,t,r)=>{const{errorReporting:n}=j,{controllerFactory:o,controllerStore:a}=r,i=[],s=(t,r)=>{const n={repeaterId:e.id,itemId:r._id},s=o.createScopedDataset({datasetScope:n,fixedItem:r});a.setController(n,s);const c=$l(t.scoped),l=s.pageReady(c);i.push(l)},c=t=>{const r={repeaterId:e.id,itemId:t._id};a.removeController(r)},l=async()=>{const{actions:t,getState:n,modeIsLivePreview:o}=r,{items:a}=await t.fetchCurrentItems(n());o&&0===a.length||(e.setValue(a),await Promise.all(i),i.splice(0))};return{...Ul(e),bind(){e.onItemReady(n(s,N.withMessage("Repeater adapter onItemReady failed"))),e.onItemRemoved(n(c,N.withMessage("Repeater adapter onItemRemoved failed")))},onRecordsLoaded:async()=>l(),async onCurrentViewChanged(){l()},async onCurrentIndexChanged(){},async onCurrentRecordModified(){const{getState:t}=r,n=pn(t()),o=e.getValue();if(o&&o.length>0){const t=o.map(();e.setValue(t)}}}}],[re,(e,t,r)=>{const{errorReporting:n}=j,{controllerFactory:o,controllerStore:a}=r,i=(t,r)=>{const n={repeaterId:e.id,itemId:r._id},i=o.createScopedDetailsDataset({datasetScope:n});a.setController(n,i);const s=$l(t.scoped);i.pageReady(s)},s=return{...Ul(e),bind(){e.onItemReady(n(i,N.withMessage("Details repeater adapter onItemReady failed"))),e.onItemRemoved(n(s,N.withMessage("Details repeater adapter onItemRemoved failed")))}}}],[oe,(e,t,r)=>{const{errorReporting:n}=j,{actions:o}=r;return{...Ul(e),isValidConnection:()=>kl(t),bind(){e.onChange(n(o.refresh,N.withMessage("Filter input adapter onChange failed")))},resetUserFilter(){const t=ns(e);e.setValue((e=>{switch(e.type){case ts:return!1;case rs:return"";default:return null}})(e),{propPath:t})}}}],[Se,Zl],[Ce,Zl],[Oe,Zl],[Pe,Zl],[be,(e,t,r)=>{const n=()=>{const{userInputFilter:{prop:r}}=t;e.setValue(null,{propPath:r})};return{...Ul(e),isValidConnection:()=>Cr(t),bindresetUserFilter(){n()}}}],[Ne,(e,t,r)=>{const{getState:n}=r,o=t=>{var r;const o=null==(r=Cn(n()))?void 0:r.find(();if(!o)return null;const{min:a,max:i}=o;return void 0===a||void 0===i?null:{min:a,max:i}},a=r=>{let{firstRender:n,min:o,max:a}=r;const{userInputFilter:{prop:i}}=t;n&&e.setBounds(o,a),e.setValue([o,a],{propPath:i})};return{...Ul(e),isValidConnection:()=>Cr(t),bind(){const n=o(t.userInputFilter.fieldName);n&&(Ql(e,t,r),a({firstRender:!0,...n}))},resetUserFilter(){const e=o(t.userInputFilter.fieldName);e&&a({firstRender:!1,...e})}}}],[de,(e,t,r)=>{const{errorReporting:n}=j,{datasetApi:o,getState:a,modeIsLivePreview:i,actions:s}=r;let c=Xl;const l=e=>c=e,u=()=>l(Xl),d=e=>{let{fetchRows:t,logGridValue:r,disableNavigation:n=!1}=e;return async(e,o)=>{const{items:a,datasetSize:i}=await t(e,o-e);return r(a),{pageRows:a,totalRowsCount:n?a.length:i.total}}},p=t=>{let{fetchRows:r,logGridValue:n}=t;return async t=>{let{direction:o,limit:a}=t,{start:i,end:s}=c;"previous"===o?(s=i,i-=a):(i=s,s+=a);const{items:u,datasetSize:d}=await r(i,s-i);return l({start:i,end:s}),e.nextEnabled=!!d.cursor||s<d.loaded,e.previousEnabled=i>0,n(u),{pageRows:u,totalRowsCount:d.total||void 0}}},f=t=>{const r=[],n=e.columns;(0,M.forEach)(t,(e=>{const t={};(0,M.forEach)(n,(r=>{t[r.label]=(0,M.get)(e,r.dataPath)})),r.push(t)}))};return{...Ul(e),bind(){s.getInitialData().chain(();const t=pn(a());if(i&&!t)return;const r=s.isCursorPaging();e.dataFetcher=r?{type:"directional",value:p({fetchRows:s.fetch,logGridValue:f,component:e})}:{type:"pages",value:d({fetchRows:s.fetch,logGridValue:f})},e.onCellSelect(n((e=>{let{cellRowIndex:t}=e;o.setCurrentItemIndex(t)}),N.withMessage("Grid adapter onCellSelect failed"))),e.onRowSelect(n((,N.withMessage("Grid adapter onRowSelect failed"))),(()=>{const t={};e.columns.forEach((e=>{let{label:r,dataPath:n,linkPath:o}=e;(n||o)&&(t[r]=Object.assign(n?{dataPath:n}:{},o?{linkPath:o}:{}))}))})()},async onCurrentRecordModifiedasync onRecordsLoaded(){u(),e.refresh()},async onCurrentViewChanged}],[le,(e,t,r)=>{const{logger:n}=j,{actions:o,getFieldType:a,getSchema:i}=r,s=async()=>{var r;const{role:s}=e,c=(e=>{const t=e[0];return 1===e.length&&""===t.label&&""===t.value?[]:e})(await(async(e,t)=>{if("field"===t.type&&a(t.fieldName).map(().getOrElse(!1)){const{fieldName:r}=t;return i().chain((t=>{const n=Jn(r,t);return i(n).map(Kn).map((async t=>{const{items:n}=await o.fetchAll(r),a=n.map((r=>Jl(r,{valueSource:{type:"field",fieldName:"_id"},labelField:t,dataTransformer:e})));return(0,M.orderBy)(a,[e=>e.label.toLowerCase()])}))})).getOrElse(Promise.resolve([]))}{const{items:r}=await o.fetchAll(),n=r.map(();return(0,M.uniqBy)(n,"value")}})(((e,t)=>"expression"===t.type?ji({expression:t.expression,record:e,prop:"value",role:s,logger:n}).value:Si({value:ja(e,t.fieldName),role:s})),null!=(r=t.expressions)&&r.value?{type:"expression",expression:t.expressions.value.expression}:{type:"field",fieldName:t.properties.value.fieldName}));e.setOptions(c)};return{...Ul(e),isValidConnection:()=>kl(t),clear(){e.setOptions([])},async onRecordsLoaded(){s()},async onCurrentRecordModified(){s()}}}],[ue,(e,t,r)=>{const{logger:n}=j,{actions:o}=r,a=async()=>{var r;const{role:a}=e,i=(e=>{const t=e[0];return 1===e.length&&""===t.label&&""===t.value?[]:e})(await(async(e,t)=>{const{items:r}=await o.fetchAll(),n=r.map((r=>((e,t)=>{let{valueSource:r,labelField:n,dataTransformer:o}=t;const a=o(e,r);return{value:a,label:n?o(e,{type:"field",fieldName:n}):a}})(r,{valueSource:t,dataTransformer:e})));return(0,M.uniqBy)(n,"value")})(((e,t)=>"expression"===t.type?ji({expression:t.expression,record:e,prop:"options",role:a,logger:n}).value:Si({value:ja(e,t.fieldName),role:a})),null!=(r=t.expressions)&&r.value?{type:"expression",expression:t.expressions.options.expression}:{type:"field",fieldName:t.properties.options.fieldName}));e.setOptions(i)};return{...Ul(e),isValidConnection:()=>kl(t),clear(){e.setOptions([])},async onRecordsLoaded(){a()},async onCurrentRecordModified(){a()}}}],[Te,(e,t,r)=>{const{logger:n}=j,{actions:o,modeIsLivePreview:a}=r,i=async()=>{const{role:r}=e,{items:i}=await o.fetchAll(),s=i.reduce(((e,o)=>{var a;if(null!=(a=t.expressions)&&a.options){const{value:a}=ji({expression:t.expressions.options.expression,record:o,prop:"options",role:r,logger:n});return e.push({value:a,label:a}),e}const{properties:{options:{fieldName:i}}}=t,s=Si({value:ja(o,i),role:r});return s&&e.push({value:s,label:s}),e}),[]);a&&0===s.length||e.setOptions(s)};return{...Ul(e),isValidConnection:()=>kl(t),clearasync onRecordsLoaded(){i()},async onCurrentRecordModified(){i()}}}],[he,(e,t,r)=>{const{logger:n,errorReporting:o}=j,{actions:a,datasetApi:i,getState:s,getFieldType:c}=r,l={},u=function(r){void 0===r&&(r=!1);const n=pn(s()),o=Kl(t),i=a.isCurrentRecordNew(s()),c=(0,M.isEmpty)(ja(n,o));(a.isCurrentRecordPristine(s())||r)&&e.clear(),!c||i&&!r||e.updateValidityIndication()};return{...Ul(e),isValidConnection:()=>kl(t),bind(){if(rn(s()))return;const{id:r,role:u}=e,d=Kl(t),p=c(d).getOrElse(void 0);e.onChange(o((,N.withMessage("Upload button adapter onChange failed"))),i.onBeforeSave((()=>{if(l[r]&&e.getValue().length)return e.uploadFiles().then((e=>{l[r]=!1;const t=pn(s()),n=Ri({value:e,currentValue:ja(t,d),fieldType:p,fieldName:d,role:u});a.setFieldInCurrentRecordAndSynchronize(d,n,r)})).catch((t=>{const r=e.getValue(),o=Array.isArray(r)&&1===r.length?r[0].name:"unknown";throw n.log(new A("The "+o+" file failed to upload. Please try again later.",{cause:t})),t}))})),c(d).map((t=>{switch(t){case"image":e.fileType="Image";break;case"document":e.fileType="Document"}}))},async onCurrentRecordModified(r){const{id:n}=e,o=Kl(t),a=pn(s()),i=Va({previousRecord:r,currentRecord:a,fieldName:o});i&&(l[n]=!1),u(i)},async onRecordsLoaded(){u()},async onCurrentViewChanged(){u()},async onCurrentIndexChanged(){u()}}}],[ie,(e,t,r)=>{const{logger:n,errorReporting:o}=j,{actions:a,getState:i,getFieldType:s,modeIsLivePreview:c,wixFormatter:l}=r,u=(e,t,r,o)=>{(0,M.forEach)(r.expressions,((r,a)=>{let{expression:i}=r;const{value:s}=ji({expression:i,record:t,prop:a,role:o,logger:n});e[a]=s})),(0,M.forEach)(r.properties,((r,n)=>{let{fieldName:a,format:i}=r;const c=Si({value:ja(t,a),role:o,fieldType:s(a).getOrElse(void 0),propPath:n,format:i,utils:{formatter:l}});e[n]=c}))},d=()=>{e.currentIndex=qi({state:i()})},p=async()=>{const{role:r}=e,{items:n}=await a.fetchCurrentItems(i());try{const o=n.map((e=>{const n={};return u(n,e,t,r),n})),a=o.every(();if(c&&a)return;e.setValue(o)}catch(e){if("URIError"!==e.name)throw e}d()};return{...Ul(e),isValidConnection:()=>kl(t),bind(){e.onCurrentItemChanged(o((,N.withMessage("Gallery adapter onItemReady failed")))},async onCurrentRecordModified(){const{role:r}=e,n=pn(i()),o=qi({state:i()}),a=e.getValue()||[],s=a[o];s&&u(s,n,t,r),e.setValue(a),d()},async onRecordsLoaded(){p()},async onCurrentViewChanged(){p()},async onCurrentIndexChanged(){d()}}}],[ve,(e,t,r)=>{const{errorReporting:n}=j,{actions:o,getState:a}=r,i=()=>{o.isCursorPaging()?(()=>{const t=zi({state:a()});e.nextEnabled=o.hasNextPage(a()),e.previousEnabled=t>1})():(()=>{const t=zi({state:a()}),r=o.getTotalPageCount(a());e.currentPage=t,r<1?e.disable():(e.enable(),e.totalPages=r)})()};return{...Ul(e),bind(){const t=o.isCursorPaging(),r=e=>{let{delta:r,index:n}=e;const i=zi({state:a()}),s=r?i+r:n,c=Wi({state:a()}),l=t?s:(0,M.clamp)(s,1,o.getTotalPageCount(a()));o.setCurrentIndex(((e,t)=>t*(e-1))(l,c))};t?(e.navigationType="arrowsOnly",e.onNextClicked(n((,N.withMessage("Pagination adapter onNextClicked failed"))),e.onPreviousClicked(n((,N.withMessage("Pagination adapter onPreviousClicked failed")))):e.onChange(n((,N.withMessage("Pagination adapter onChange failed")))},async onRecordsLoaded(){i()},async onCurrentViewChanged(){i()}}}],[Ee,(e,t,r)=>{const{logger:n}=j,{actions:o,getState:a,getFieldType:i,wixFormatter:s}=r,c=(e,t,r)=>{let{expressions:n={},properties:o={}}=t;const a=e=>{let{propPath:t,marker:n,value:o,fieldType:a,format:i}=e;if("address"===t)return Object.assign(n,{address:(0,M.get)(o,"formatted"),location:(0,M.get)(o,"location")});if("link"===t&&(0,M.isEmpty)(o))return n;const c=Si({value:o,role:r,fieldType:a,propPath:t,format:i,utils:{formatter:s}});return Object.assign(n,{[t]:c})};let c={};return c=(0,M.reduce)(n,((t,r,n)=>{let{expression:o}=r;const i=xi({expression:o,variables:e,functions:Gi()});return a({propPath:n,marker:t,value:i})}),c),c=(0,M.reduce)(o,((t,r,n)=>{let{fieldName:o,format:s}=r;const c=ja(e,o);return a({propPath:n,marker:t,format:s,value:c,fieldType:i(o).getOrElse(void 0)})}),c),c},l=async()=>{const{role:r}=e;try{const{items:n}=await o.fetchCurrentItems(a());e.markers=n.map((e=>c(e,t,r)))}catch(e){n.log(new N("Failed setting markers",{cause:e}))}};return{...Ul(e),isValidConnection:()=>kl(t),async onRecordsLoaded(){l()},async onCurrentViewChanged(){l()},async onCurrentIndexChanged(){const t=qi({state:a()});e.setCenter((0,M.get)(e,["markers",t,"location"]))},async onCurrentRecordModified(){const{role:r}=e,n=pn(a()),o=qi({state:a()});e.markers[o]=c(n,t,r),e.setCenter((0,M.get)(e,["markers",o,"location"]))}}}]]),tu=e=>{let{components:t,context:r}=e;const n=(e=>{let{recordStore:t,dispatch:n}=e;const a={fetchRecordById:(e,r)=>t(r).fold((()=>Qe.Maybe.Nothing()),(t=>t.getRecordById(e))),fetchAll:e=>(async(e,t,r,n)=>{const o=await e(n).fold((()=>Cs.Empty()),();return o.get()})(t,0,1e3,e),fetchCurrentItems:e=>yc(t,e).catch((),fetchOne:()=>vc(t,0,1),fetch:getTotalPageCount:e=>Yi({state:e,recordStore:t}),getInitialData:()=>t().fold((()=>Cs.Empty()),(),setCurrentIndex:setFieldInCurrentRecordAndSynchronize:(e,t,r)=>{n(hc({[e]:(0,M.cloneDeep)(t)},r))},refresh:resetUserInputFilters:()=>{const e=o.filter((e=>{let{role:t}=e;return t===oe||Ae.includes(t)})),t=Tn(r.getState());e.length&&(e.forEach((e=>e.resetUserFilter())),t||a.refresh())},isCurrentRecordNew:e=>t().fold((()=>!1),(t=>t.isNewRecord(qi({state:e})))),isCurrentRecordPristine:e=>t().fold((()=>!1),(t=>t.isPristine(qi({state:e})))),isCursorPaging:hasNextPage:getUniqueFieldValues:e=>t().fold((()=>!1),(t=>t.getUniqueFieldValues(e)))};return a})(r),o=t.map((e=>((e,t,r)=>(eu.get(e.role)||(e.isInput?Yl:Gl))(e,t,r))(e,((e,t)=>{if(!e)return e;const{properties:r,totalCount:n}=e;return{...e,...r?{properties:(0,M.mapKeys)(r,((e,r)=>Ml(r)?Fl({propName:r,getFieldType:()=>t(e.fieldName).getOrElse(null)}):r))}:{},...n?{totalCount:{prop:Ml(n.prop)?Fl({propName:n.prop,getFieldType:()=>null}):n.prop}}:{}}})(e.connectionConfig,r.getFieldType),{...r,actions:n}))).filter((e=>e.isValidConnection()));return{bindAll:async()=>Promise.all(o.map(()),hideAll:()=>o.map((e=>e.hide())),showAll:()=>o.map((),clearAll:()=>o.map((e=>e.clear())),onRecordsLoaded:()=>o.map((e=>e.onRecordsLoaded())),onCurrentViewChanged:()=>o.map((e=>e.onCurrentViewChanged())),onCurrentIndexChanged:onCurrentRecordModified:(e,t)=>o.filter((e=>{let{id:r}=e;return!t||t!==r})).map((t=>t.onCurrentRecordModified(e)))}},ru=e=>{let{datasetId:t,masterIds:r,connectionsGraph:n}=e;const o=e=>n[t].includes(e.id)?"PRIMARY":r.some(()?"DETAILS":"OTHER";return{isInsidePrimaryOrDetailsRepeater:e=>{let{parentRepeater:t}=e;return!!(r=t)&&["PRIMARY","DETAILS"].includes(o(r));var r},getDetailsRepeaters:e=>{const t=[];return e.forEach((e=>{let{parentRepeater:r}=e;r&&"DETAILS"===o(r)&&t.push(new Proxy(r,{get:))})),(0,M.uniqBy)(t,"uniqueId")}}},nu=[m.FieldType.text,m.FieldType.number,m.FieldType.image,m.FieldType.video,m.FieldType.mediaGallery,m.FieldType.richContent],ou={[m.FieldType.text]:"text",[m.FieldType.number]:"number",[m.FieldType.image]:"image",[m.FieldType.video]:"video",[m.FieldType.mediaGallery]:"gallery",[m.FieldType.richContent]:"rich-content"},au=e=>{var t;let{recordStore:r,state:n,schema:o,connections:a,isDpItemDataset:i}=e;if(!i&&!a.length)return{collectionData:void 0};const s=pn(n);if(!s)return{collectionData:void 0};const{id:c,displayName:l,displayField:u,fields:d}=o,p=i&&u?s[u]:void 0,f=i?1:null!=(t=(e=>{let{recordStore:t}=e;const r=$i({recordStore:t});return r?r.total:null})({recordStore:r}))?t:void 0;return{title:p,collectionData:{id:c,name:l||c,totalCount:f,fields:iu({connections:a,fields:d,currentRecord:s}),primary:i}}},iu=e=>{let{connections:t,fields:r,currentRecord:n}=e;const o=t.reduce(cu,{});return Object.entries(r).filter((e=>{let[t,r]=e;return!r.pii&&!r.isDeleted&&nu.includes(r.type)})).map((e=>{var t;let[r,a]=e;return{key:r,type:ou[a.type],label:a.displayName,connected:!(null==(t=o[r])||!t.length),value:su({key:r,field:a,currentRecord:n,connections:o[r]||[]})}}))},su=e=>{let{key:t,field:r,currentRecord:n,connections:o}=e;const{type:a}=r,i=n[t];switch(a){case m.FieldType.image:return i&&lu({src:i},o);case m.FieldType.video:return i&&uu({src:i},o);case m.FieldType.mediaGallery:return du(i,o);case m.FieldType.text:case m.FieldType.number:case m.FieldType.richContent:return i;default:throw new Error("Unsupported field type: "+a)}},cu=(e,t)=>{var r;const n=(null==t||null==(r=t.config)?void 0:r.properties)||{};return Object.values(n).map((e=>{let{fieldName:t}=e;return t})).forEach((),e},lu=(e,t)=>{let{src:r}=e;const n=t.some((e=>{var t,r,n;let{role:o,config:a}=e;return o===se&&Boolean(null==a||null==(t=a.properties)?void 0:t.items)||o===ie&&Boolean(null==a||null==(r=a.properties)?void 0:r.src)||"imageRole"===o&&Boolean(null==a||null==(n=a.properties)?void 0:n.src)}));return{url:r,...pu(r),connectedToSrc:n}},uu=(e,t)=>{let{src:r,title:n,description:o}=e;const a=t.some((e=>{var t,r,n;let{role:o,config:a}=e;return o===se&&Boolean(null==a||null==(t=a.properties)?void 0:t.items)||"videoPlayerRole"===o&&Boolean(null==a||null==(r=a.properties)?void 0:r.src)||"videoRole"===o&&Boolean(null==a||null==(n=a.properties)?void 0:n.src)}));if(!mu(r))return{thumbnailUrl:void 0,title:n,description:o,uploadDate:void 0,connectedToSrc:a};const[i,s]=r.match(/posterUri=(\w+)/)||[],[c,l]=r.match(/posterWidth=(\d+)/)||[],[u,d]=r.match(/posterHeight=(\d+)/)||[];return{thumbnailUrl:fu({uri:s,width:Number(l),height:Number(d)}),title:n,description:o,uploadDate:void 0,connectedToSrc:a}},du=function(e,t){return void 0===e&&(e=[]),e.map((e=>"image"===e.type?lu(e,t):uu(e,t)),t)},pu=e=>{if(!hu(e))return{height:void 0,width:void 0};const[t,r]=e.match(/originHeight=(\d+)/)||[],[n,o]=e.match(/originWidth=(\d+)/)||[];return{height:r?Number(r):void 0,width:o?Number(o):void 0}},fu=e=>{let{uri:t,width:r,height:n,filename:o="image.ext"}=e;return"wix:image://v1/"+t+"/"+o+"#originWidth="+r+"&originHeight="+n},hu=e=>e.startsWith("wix:image://"),mu=e=>e.startsWith("wix:video://"),gu=(e,t)=>r=>{let{shouldCollectSeoData:n,controllerConfig:o,datasetType:a,connections:i,connectionsGraph:s,isScoped:c,datasetScope:l,dataProvider:u,dependencyManager:d,seoManager:p,firePlatformEvent:f,dynamicPagesData:h,datasetId:m,fixedRecordId:g,recordStoreService:v,updatedCompIds:y,markControllerAsRendered:E,markDatasetDataFetched:I,renderingRegularControllers:_,modeIsLivePreview:T,modeIsSSR:w,schemasLoading:R,listenersByEvent:S}=r;const b=i.filter((e=>!(e=>{let{role:t}=e;return Ae.includes(t)})(e)||e.config)),O=!!g,{logger:C,loadExpressionFunctions:P,platform:{user:A,settings:{locale:D},timers:{queueMicrotask:x}}}=j,{setConnectedComponents:L,getConnectedComponents:F}=(()=>{let e;return{setConnectedComponents:t=>e=t,getConnectedComponents:()=>e}})(),U=[],{store:k,subscribe:G,onIdle:V}=Oc(C,m),W=zc(f),{fireEvent:B,register:H}=W;U.push(W.dispose);const z=new q({datasetId:Pl(m),scopedDatasetId:c?m:void 0,getState:k.getState,getSchema:function(e){return void 0===e&&(e=ee),u.getSchema(e)}}),Y=z.subscribe(S);U.push(...Y),k.dispatch(sr({controllerConfig:o,connections:b,isScoped:c,datasetType:a}));const{datasetIsVirtual:X,datasetIsReal:J,datasetIsDeferred:K,datasetIsWriteOnly:Q,datasetIsRouter:Z,datasetCollectionName:ee,dynamicPageNavComponentsShouldBeLinked:te}=(re=k.getState(),{datasetIsRouter:an(re),datasetIsMaster:sn(re),datasetIsVirtual:cn(re),datasetIsReal:ln(re),datasetIsDeferred:un(re),datasetIsWriteOnly:nn(re),datasetCollectionName:Xr(re),dynamicPageNavComponentsShouldBeLinked:dn(re)});var re;const ne=Jr(k.getState()),oe=Kr(k.getState()),ae=function(e){return void 0===e&&(e=ee),Qe.Maybe.fromNullable(u.getSchema(e))},ie=e=>{const t=ae(ee),r=u.getReferencedSchemas(ee);return t.chain((t=>Qe.Maybe.fromNullable(Xn(t,r)(e))))},se=((e,t,r)=>({dataBinding:La(e),currentUser:xa(),userInput:as({getConnectedComponents:t,getFieldType:r})}))((,F,ie),ce=us({valueResolvers:se,getConnectedComponents:()=>tn(k.getState())?F():[],getFieldType:ie,getUserFilterInitialData:wasSetFilterCalled:(0,M.flow)((()=>k.getState()),Tn)}),le=(e=>{let{recordStoreService:t,getFilter:r,getSort:n,getPageSize:o,datasetId:a,filterResolver:i,getSchema:s,fixedRecordId:c}=e;return e=>{const l=o();return t.chain((t=>{if(e)return Qe.Result.fromMaybe(s().map((t=>Jn(e,t))),"cannot resolve referenced collection name for field "+e).map((e=>t({pageSize:l,sort:null,filter:null,datasetId:a,referencedCollectionName:e,fixedRecordId:c})));{const e=r();return Qe.Result.fromMaybe(i(e).map((e=>t({pageSize:l,sort:n(),filter:e,datasetId:a,referencedCollectionName:null,fixedRecordId:c}))),"could not resolve dynamic filter")}}))}})({recordStoreService:v,getFilter:(0,M.flow)((()=>k.getState()),Jr),getSort:(0,M.flow)((()=>k.getState()),Kr),getPageSize:()=>Wi({state:k.getState()}),datasetId:m,filterResolver:ce,getSchema:ae,fixedRecordId:g}),ue=te?(e=>{let{dataProvider:t,dynamicPagesData:r,collectionName:n}=e;return{getNextDynamicPageUrl:()=>gl({dataProvider:t,dynamicPagesData:r,collectionName:n,directionTowardSibling:"asc"}),getPreviousDynamicPageUrl:()=>gl({dataProvider:t,dynamicPagesData:r,collectionName:n,directionTowardSibling:"desc"})}})({dataProvider:u,dynamicPagesData:h,collectionName:ee}):null;let de,pe;te&&(G(cl(ue)),k.dispatch(_c(b)));const fe=new Promise((),me=c?void 0:()=>fe;c||H("datasetReady",de);const ge=qc({store:k,recordStore:le,eventListeners:W,controllerStore:t,datasetId:m,datasetType:a,isFixedItem:O,siblingDynamicPageUrlGetter:ue,onIdle:V,dispatcher:z,onReadyAsync:me}),ve=ge(!1);U.push(v.map(().getOrElse((()=>{})));const{fetchingInitialData:ye,resolveUserInputDependency:Ee}=wl({dependencyManager:d,shouldFetchInitialData:o&&!Q,recordStore:le,store:k,filter:ne,sort:oe,datasetIsDeferred:K,modeIsSSR:w,queueMicrotask:x,datasetIsReal:J,collectionId:ee,filterResolver:ce,getSchemas:()=>u.getSchemas(),schemasLoading:R,getUserFilterInitialData:()=>u.getUserFilterInitialData(m)});ye.then((()=>{I();const e=le().fold((()=>{}),(e=>e.getSeedRecords().matchWith({Empty:()=>{},Results:)));e&&k.dispatch(Ic.setCurrentRecord(e,0))}));c&&!O&&d.getDependenciesByFilter(ne,l).forEach((e=>{let{masterDataset:{api:t}}=e;Al({detailsDatasetApis:[ve],store:k,masterDatasetApi:t,controllerConfig:o,unsubscribeHandlers:U})}));n&&J&&!K&&Promise.all([ye,R]).then((()=>{let e={};try{e=au({isDpItemDataset:Z,recordStore:le,state:k.getState(),schema:u.getSchema(ee),connections:b})}catch(e){C.log(new N("Failed to extract seo data for dataset "+m,{cause:e}))}p.submitSeoData(e)}));const Ie=async function(r){A.onLogin((()=>{(()=>{const e=qi({state:k.getState()}),t=le().fold((()=>!1),(t=>t.isPristine(e)));return t&&!Q})()&&ve.refresh()}));const{components:n,detailsDatasetApis:i}=r(b),c=Ol({updatedCompIds:y,datasetIsReal:J,connectionsGraph:s,components:n});L(c);const l=((e,t)=>{let{datasetId:r,connectionsGraph:n,datasetIsReal:o,getDependencies:a}=t;if(!o)return e;const{isInsidePrimaryOrDetailsRepeater:i,getDetailsRepeaters:s}=ru({datasetId:r,connectionsGraph:n,masterIds:a().map((e=>e.masterDatasetId))}),c=e.filter(();return c.push(...s(e)),c})(c,{datasetId:m,datasetIsReal:J,connectionsGraph:s,getDependencies:);if(Al({detailsDatasetApis:i,masterDatasetApi:ve,dependencyManager:d,controllerConfig:o,unsubscribeHandlers:U}),J&&await R,Ee(),!en(k.getState())||!u.hasSchema(o.dataset.collectionName))return ye.then((()=>{E(),d.resolveDependants(m),k.dispatch(Rc(!0)),B("datasetReady")})),Promise.resolve();const p=tu({components:l,context:{connections:b,recordStore:le,dispatch:k.dispatch,getState:k.getState,datasetApi:ve,eventListeners:W,dispatcher:z,getFieldType:ie,getSchema:ae,controllerFactory:e,controllerStore:t,modeIsLivePreview:T,wixFormatter:D?tl({locale:D}):null}});G(((e,t,r,n,o,a,i,s)=>{const c=ol(e,t,r,n,o,a,i,s),l=e=>{let{from:t,to:r,hasChanged:n,hasChangedToFalse:o,hasChangedToTrue:a,hasChangedToMatch:i}=e;const s=fn(r),l=fn(t),u=mn(r),d=wn(r),p=[];return(i(mn,(e=>e>=0&&e!==s))||a(wn))&&p.push(c.goToRecordByIndex(l,u,d)),(n(fn)&&l>=0||o(_n)&&0===s)&&p.push(c.notifyIndexChange(s)),p},u=e=>{let{from:t,to:r,hasChanged:n,hasChangedToMatch:o,hasChangedToTrue:a}=e;const i=fn(r),s=pn(r),l=pn(t),u=[];Ts(l,s)?(0,M.isEqual)(l,s)||(u.push(c.updateComponents(vn(r),l)),u.push(c.fireEvent("itemValuesChanged",(0,M.cloneDeep)(l),(0,M.cloneDeep)(s)))):null==l||null==s||n(fn)||u.push(c.updateComponents());const d=gn(r);return o(gn,()&&u.push(c.setFieldsInCurrentRecord(d,i,vn(r))),a(bn)&&u.push(c.revertChanges(i,hn(r))),a(Sn)&&u.push(c.removeCurrentRecord(i)),u},d=e=>{let{to:t,hasChanged:r,hasChangedToFalse:n,hasChangedToTrue:o}=e;const a=[];return r(al)&&a.push(c.refresh(fn(t),hn(t),nn(t))),r(Qr)&&a.push(c.notifyRecordSetLoaded()),o(_n)&&a.push(c.refresh(fn(t),hn(t),nn(t))),n(_n)&&a.push(c.notifyRecordSetLoaded()),o(Rn)&&a.push(c.updateCurrentView()),a},p=e=>{let{to:t,hasChangedToTrue:r}=e;const n=fn(t),o=pn(t);if(r(On))return c.saveRecord(n,o)},f=e=>{let{to:t,hasChangedToNotNull:r}=e;const n=[];return r(yn)&&n.push(c.newRecord(yn(t),hn(t))),n};return e=>(0,M.flatten)([l,u,d,p,f].map((t=>t(e))))})(le,p,ie,W.executeHooks,m,l,B,z)),U.push(((k,l,C,m,le));const f=Sl(l.filter((e=>{let{role:t}=e;return![he,we].includes(t)})),ie);k.dispatch(Ic.setDefaultRecord(f)),Q&&await k.dispatch(Ic.initWriteOnly(X)),K&&(p.hideAll(),w&&p.clearAll());const h=b.some((e=>{var t;return Object.keys((null==e||null==(t=e.config)?void 0:t.expressions)||{}).length>0}))?P():Promise.resolve(),g=Promise.all([ye,h]).then((async()=>{if(K&&await _,!w)try{((e,t,r,n,o,a)=>{if(n)return;const i=Xr(e);if(!i)return;const s=a.fold((()=>i),(e=>e.displayName)),c=Zr(e),l=!!pn(e),{logger:u,platform:{settings:{env:{editor:d}}}}=j;l&&[Pn,Nn].includes(c)&&t.find(()&&u.log(new kn({id:d?153:152,collectionId:i,collectionName:s,datasetId:o,datasetType:r,datasetMode:c})),wt(Zr(e),t)&&u.log(new kn({id:d?157:156,collectionId:i,collectionName:s,datasetId:o,datasetType:r,datasetMode:c}))})(k.getState(),b,a,X,m,ae(ee))}catch(e){C.log(new N("Failed to report dataset active BI",{cause:e}))}await p.bindAll(),J&&await(e=>Promise.all(e.getAll().map((e=>new Promise(()))))(t),K&&p.showAll(),d.resolveDependants(m),k.dispatch(Rc(!0)),B("datasetReady")}));return K?(E(),Promise.resolve()):(g.then(E),g)},_e=ge(!0);return{pageReady:$(X?Ie:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return C.log(new We("dataset/pageReady",())},(e=>(pe(),C.logError(e,"Dataset pageReady callback failed",{datasetId:m})))),exports:e=>e.type===dc.l.COMPONENT?_e.inScope(e.compId,e.additionalData.itemId):_e,staticExports:_e,dispose:api:ve,userFilterInitialDataPromise:ye.then(()}},vu=(e,t)=>{const r=uc(e),n={createRealDataset:createScopedDetailsDataset:e=>{let{datasetScope:r}=e;return o({...t,isScoped:!0,firePlatformEvent:M.noop,datasetId:Cl(t.datasetId,r),datasetScope:r})},createScopedDataset:e=>{let{datasetScope:r,fixedItem:n}=e;const{dataProvider:a,controllerConfig:i,dynamicPagesData:s}=t,c=(0,M.cloneDeep)(i),l={items:[n]};c.dataset.filter=a.createSimpleFilter("_id",n._id);const{collectionName:u}=i.dataset;return a.setCollectionData({collectionId:u,data:l}),o({...t,isScoped:!0,controllerConfig:c,firePlatformEvent:M.noop,dynamicPagesData:s,datasetId:Cl(t.datasetId,r),fixedRecordId:r.itemId})}},o=gu(n,r);return n},yu=e=>ps(e).map(();var Eu=a(9025);function Iu(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}var _u=new WeakMap;class Tu{constructor(){Iu(this,_u,{writable:!0,value:void 0}),u()(this,_u,new Map)}get datasetConfigs(){return c()(this,_u)}}function wu(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}var Ru=new WeakMap,Su=new WeakMap,bu=new WeakMap,Ou=new WeakMap,Cu=new WeakMap,Pu=new WeakMap,Nu=new WeakMap;class Au{constructor(e){let{platform:t,dataFetcher:r,warmupCache:n,staticCache:o,features:a,listenersByEvent:i,logger:s,i18n:c,global:l,loadExpressionFunctions:d}=e;wu(this,Ru,{writable:!0,value:void 0}),wu(this,Su,{writable:!0,value:void 0}),wu(this,bu,{writable:!0,value:void 0}),wu(this,Ou,{writable:!0,value:void 0}),wu(this,Cu,{writable:!0,value:void 0}),wu(this,Pu,{writable:!0,value:void 0}),wu(this,Nu,{writable:!0,value:void 0});const p=new Ln(s,l);V({loadExpressionFunctions:d,platform:t,features:a,dataFetcher:r,i18n:c,appState:new Tu,logger:p,errorReporting:Fn(p),breadcrumbReporting:Mn(p),verboseReporting:Un(p)}),u()(this,Ru,new Ra),u()(this,Su,n),u()(this,bu,o),u()(this,Ou,a),u()(this,Pu,p),u()(this,Nu,{}),u()(this,Cu,i)}initializeDatasets(e){let{datasetConfigs:t,firePlatformEvent:r}=e;try{return c()(this,Pu).log(new We("databinding/createControllers",())}catch(e){return c()(this,Pu).logError(e,"Datasets initialisation failed"),[]}}_initializeDatasets(e){let{datasetConfigs:t,firePlatformEvent:r}=e;const{platform:{settings:{mode:{name:n,csr:o,ssr:a},env:{livePreview:i,live:s}},seo:l,location:u}}=j,d=vs(t),p=this._updateDatasetConfigsState(d),f=c()(this,Ou).warmupData,h=[],m=[],{resolve:g,promise:v}=new z;c()(this,Ru).setSchemas({...f&&o&&c()(this,Su).getSchemas()||{},...c()(this,bu).getSchemas()||{}});const y=c()(this,Pu).log(new We("databinding/loadSchemas",(()=>c()(this,Ru).loadSchemas(Du(d)).then((()=>f&&a&&c()(this,Su).setSchemas(c()(this,Ru).getSchemas()))))));c()(this,Ru).setDatasetConfigs(d.map((e=>{let{config:{dataset:{collectionName:t}},compId:r,type:n}=e;return{collectionId:t,datasetId:r,type:n}})));const E=o&&f&&c()(this,Su).getDataStore();E&&c()(this,Ru).setStore(Mu(E));const I=c()(this,bu).getDataStore();I&&c()(this,Ru).setStaticStore(Mu(I)),c()(this,Ru).createInitialDataRequest(this._getInitialDataRequestConfigs(d,p));const _=d.reduce(((e,t)=>{let{compId:r,connections:n}=t;return e[r]=n.map((e=>{let{compId:t}=e;return t})),e}),{}),T=(e=>{let{datasetConfigs:t}=e;const r={},n={},o=(e,t)=>{const o=n[e];if(!o)return;const a=r[o.masterDatasetId];return a?{...o,masterDataset:t?{...a,api:a.api.inScope(t.repeaterId,t.itemId)}:a}:o};return t.forEach((e=>{let{id:t,connections:r}=e;r.forEach((e=>{let{role:r,config:o}=e;r===ne&&Object.entries(o.filters).forEach((e=>{let r,[o,{fieldName:a}]=e;n[o]={id:o,fieldName:a,masterDatasetId:t,isResolved:!1,promise:new Promise((),resolve:}))}))})),{resolveDependants:e=>Object.values(n).forEach((t=>{let{id:r,masterDatasetId:o}=t;e===o&&n[r].resolve()})),getDependencyResolutionPromise:e=>{const t=yu(e).flatMap((e=>n[e]&&!n[e].isResolved?[n[e].promise]:[]));return t.length>0?Promise.all(t):void 0},getDependencyById:o,getDependenciesByFilter:(e,t)=>yu(e).flatMap((e=>o(e,t)||[])),registerDataset:e=>{let{id:t,api:n,config:o}=e;r[t]={id:t,api:n,config:o}}}})({datasetConfigs:d}),w=d.some((e=>{let{type:t,dynamicPageData:r}=e;return t===Or&&!(null==(n=null==r?void 0:r.dynamicUrl)||!n.match(/\{.+\}/));var n})),R=w&&d.some((e=>{let{type:t,dynamicPageData:r}=e;return t===Or&&(null==r?void 0:r.seoV2)})),S=s&&w&&R,b=S?(e=>{let{seo:t,pageUrl:r}=e;const{logger:n}=j;let o;const a={title:void 0,pageUrl:r,collections:[]};return{submitSeoData:e=>{let{title:t,collectionData:r}=e;o||(t&&(a.title=t),r&&a.collections.push(r))},renderSeoTagsOnce:()=>(o||(o=t.renderSEOTags({itemType:Eu.ITEM_TYPES.WIX_DATA_PAGE_ITEM,itemData:a}).catch(()),o)}})({seo:l,pageUrl:u.pageUrl}):null,O=d.map((e=>{let{type:t,config:s,connections:l,compId:u,livePreviewOptions:{shouldFetchData:d,compsIdsToReset:p=[]}={},dynamicPageData:g}=e;const{datasetIsRouter:I,datasetIsDeferred:w}=s.datasetStaticConfig;c()(this,Pu).log(new Be({category:"createControllers",message:"warmup data contents",data:{datasetId:u,datasetType:t,mode:n,warmupData:Boolean(E)}}));const R=(e=>{let{primaryDatasetId:t,recordStoreCache:r,refreshStoreCache:n,dataProvider:o,controllerConfig:a}=e;return Qe.Result.fromNullable(a,"missing controller configuration").chain((e=>{let{dataset:t}=e;return Qe.Result.fromNullable(t,"controller configuration is missing dataset object")})).chain((e=>{let{collectionName:t}=e;return Qe.Result.fromNullable(t,"dataset is not connected to a collection")})).map((e=>{const i=(0,M.get)(a,["dataset","includes"]),s=(0,M.get)(a,["dataset","nested"]),c=(0,M.get)(a,["dataset","cursor"]),l=(0,M.get)(a,["dataset","readWriteType"]),u=(0,M.get)(a,["dataset","uniqueFieldValues"]);return lc({primaryDatasetId:t,recordStoreCache:r,refreshStoreCache:n,dataProvider:o,mainCollectionName:e,includes:i,nestedFieldKeys:s,uniqueFieldValues:u,readWriteType:l,cursorPagingRequired:c})}))})({primaryDatasetId:u,recordStoreCache:c()(this,Nu),refreshStoreCache:d,dataProvider:c()(this,Ru),controllerConfig:s}),{promise:O,resolve:C}=new z;I||w||h.push(O);const{promise:P,resolve:N}=new z;m.push(P);const A=o&&f&&c()(this,Su).getUserFilterInitialData(u);A&&c()(this,Ru).setUserFilterInitialData(u,A);const D=vu(c()(this,Pu),{shouldCollectSeoData:S,seoManager:b,dependencyManager:T,controllerConfig:s,datasetType:t,connections:l,connectionsGraph:_,recordStoreService:R,dataProvider:c()(this,Ru),firePlatformEvent:r(u),dynamicPagesData:I&&g?{dynamicPageData:g,items:c()(this,bu).getItems(),datasetConfig:s}:void 0,datasetId:u,schemasLoading:y,listenersByEvent:c()(this,Cu),updatedCompIds:p,markControllerAsRendered:N,markDatasetDataFetched:C,renderingRegularControllers:v,modeIsLivePreview:i,modeIsSSR:a}).createRealDataset();return T.registerDataset({id:u,api:D.api,config:s}),a&&f&&D.userFilterInitialDataPromise.then((e=>{c()(this,Su).setUserFilterInitialData(u,e)})),xu(D)}));a&&f&&h.length&&Promise.all(h).then((()=>{c()(this,Su).setDataStore(Fu(c()(this,Ru).getStore()))})),Promise.all(m).then(g);const C=()=>Promise.all(h).then(b.renderSeoTagsOnce);return S?O.map((e=>({...e,pageReady:function(){return e.pageReady(...arguments).then(C)}}))):O}_updateDatasetConfigsState(e){const{appState:t}=j;return e.reduce(((e,r)=>{let{compId:n,config:{dataset:o}}=r;const a=t.datasetConfigs.get(n);return a&&!(0,M.isEqual)(a,o)&&e.push(n),t.datasetConfigs.set(n,o),e}),[])}_getInitialDataRequestConfigs(e,t){return e.reduce(((e,r)=>{let{compId:n,config:{datasetStaticConfig:{sequenceType:o}},livePreviewOptions:{shouldFetchData:a}={}}=r;return o===Oa?[...e,{id:n,refresh:a||t.includes(n)}]:e}),[])}}const Du=e=>[...e.reduce(((e,t)=>{let{config:{dataset:{collectionName:r}}}=t;return r?e.add(r):e}),new Set)],xu=Lu=e=>t=>{if(t)return{...t,recordsByCollectionId:Object.entries(t.recordsByCollectionId).reduce((,{})}},Fu=Lu(Gn.ah),Mu=Lu(Gn.PL),Uu=e=>{let{datasetId:t,record:r,schema:n,getSchema:o}=e;const a={"form-id":{value:t,keyName:""}},i=(0,M.pickBy)(n.fields,((e,t)=>((e,t)=>{const r=e.type,n=S.includes(r),o=!!e.systemField,a=["_createdDate","_updatedDate"].includes(t||e.name);return(!o||a)&&n})(e,t)&&!e)));return(0,M.forEach)(i,((e,n)=>{const i=function(e){let{record:t,fieldData:r,fieldName:n,getSchema:o}=e;if("reference"===r.type){const e=o(r.referencedCollection);if(!e)return;const a=ja(t[n],e.displayField);return{value:Qa(a),type:e.fields[e.displayField].type}}return{value:Qa(ja(t,n)),type:r.type}}({record:r,fieldData:e,fieldName:n,getSchema:o});if(!i)return;const{value:s,type:c}=i,{displayName:l,index:u}=e,d=((e,t)=>`${e}.${t}`)(t,n);a["field:"+d]={value:s,keyName:l,index:u,valueType:c}})),a};const ku=e=>{let{automationsClientCreator:t,pageId:r}=e;const n=t().reportFormEventToAutomationCreator();return{afterSave:async(e,t,o)=>{let{datasetId:a,getSchema:i,getState:s}=e;const c=s(),l=i();if(!Boolean(c.records.isForm)||!l)return;const{eventUTCTime:u,detailedEventPayload:d,collectionId:p}=(e=>{let{datasetId:t,getSchema:r,record:n,schema:o}=e;return{eventUTCTime:ja(n,"_updatedDate"),detailedEventPayload:Uu({datasetId:t,record:n,schema:o,getSchema:r}),collectionId:o.id}})({datasetId:a,record:o,schema:l,getSchema:i});await n({eventUTCTime:u,detailedEventPayload:d},p,r)}}};var Gu=a(5675),ju=a.n(Gu);function Vu(e){return"object"===ju()(e)}function Wu(e){return"array"===ju()(e)}nction qu(e){if(null==e||"object"!=typeof e)return e;var t=null;if(e))t=new Date(e.getTime());else for(var r in t=e.constructor(),e)t[r]=qu(e[r]);return t}var zu=a(3065);a(5174);var $u=function(){return"WDE0001: Collection name must be a string."},Yu=function(){return"WDE0002: ItemId must be a string."},Xu=function(){return"WDE0068: Item ids must be an array of strings"},Ju=function(e){return"WDE0069: Failed to remove items from [".concat(e,"].\nCannot remove more than 1000 items in one request")},Ku=function(){return"WDE0003: FieldName must be a string."},Qu=function(e,t){return"WDE0004: Failed to save [".concat(e,"] into [").concat(t,"].\nItems must be JavaScript objects.")},Zu=function(e){return"WDE0005: Failed to bulk save items into [".concat(e,"].\nItems must be an array of JavaScript objects and itemIds must be strings if present.")},ed=function(e){return"WDE0006: Failed to bulk save items into [".concat(e,"].\nCannot insert more than 1000 items in one request")},td=function(){return"WDE0007: Invalid update. Updated object must have a string _id property."},rd=nd=od=function(){return"WDE0019: Reference operation takes a string ID or an object with an ID to be connected."},ad=id=function(e){return"WDE0025: The ".concat(e," collection does not exist. You cannot work with a collection using the Data API before it is created in the Editor.")},sd=function(e){return"WDE0026: The ".concat(e," collection was removed, so you cannot work with it. To restore its data, create a new collection with the same name.")},cd={queryInvalid:isNumber:function(e,t,r){return"WDE0032: Invalid ".concat(e," parameter [").concat(Hu(r),"]. ").concat(e," parameter must be a ").concat(t," number.")},isPositiveNumber:function(e,t){return"WDE0033: Invalid ".concat(e," parameter [").concat(t,"]. ").concat(e," parameter must be a positive number.")},isNonNegativeNumber:function(e,t){return"WDE0034: Invalid ".concat(e," parameter [").concat(t,"]. ").concat(e," parameter must be a non-negative number.")},isInteger:isNonEmptyString:function(e){return"WDE0094: Invalid ".concat(e," parameter. ").concat(e," parameter must be non-empty string.")},notGreaterThan:invalidSkipParameter:noPrevPage:function(e){return"WDE0159: Invalid query on [".concat(e,"].\nThere is no prev page.")},noNextPage:,ld={arityIsZero:function(e){return"WDE0038: Invalid ".concat(e," usage. ").concat(e," does not take parameters.")},arityIsOne:function(e){return"WDE0039: Invalid ".concat(e," usage. ").concat(e," requires one parameter.")},arityIsTwo:function(e){return"WDE0040: Invalid ".concat(e," usage. ").concat(e," requires two parameters.")},arityIsThree:function(e){return"WDE0041: Invalid ".concat(e," usage. ").concat(e," requires three parameters.")},arityIsAtLeastTwo:function(e){return"WDE0042: Invalid ".concat(e," usage. ").concat(e," requires at least two parameters.")},arityIsAtLeastOne:,ud={ItemDoesNotExist:"WD_ITEM_DOES_NOT_EXIST",ItemAlreadyExists:"WD_ITEM_ALREADY_EXISTS",SiteInTemplateMode:"WD_SITE_IN_TEMPLATE_MODE",UnknownError:"WD_UNKNOWN_ERROR",ValidationError:"WD_VALIDATION_ERROR",CollectionDeleted:"WD_COLLECTION_DELETED",SchemaDoesNotExist:"WD_SCHEMA_DOES_NOT_EXIST",PermissionDenied:"WD_PERMISSION_DENIED",BadRequest:"WD_BAD_REQUEST",Unauthorized:"WD_UNAUTHORIZED",TooManyRequests:"WD_TOO_MANY_REQUESTS",RequestTimedOut:"WD_REQUEST_TIMED_OUT",QuotaExceeded:"WD_DATABASE_QUOTA_EXCEEDED",QueryExecutionError:"WD_QUERY_EXECUTION_ERROR"};ct.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0}}),hd.prototype=Object.create(zu.UserCodeError.prototype,{constructor:{value:hd,enumerable:!1,writable:!0,configurable:!0}});var md=),gd=(function(e){i(t,e),t.prototype.validateAndAggregate=t.prototype._appendIfInvalid=(md),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Fi(t,e),t.prototype.validateAndReject=function(){var e=this;return Promise.resolve().then((function(){e._validations.forEach((function(e){var t=e.predicateFn,r=e.messageFn;if(!t())throw pd(r(),ud.ValidationError)}))}))},t}(md));!function(e){i(t,e),t.prototype.arity=t.prototype._isObject=function(e,t){return this.addValidation((function(){return Vu(e)}),()},t.prototype.item=function(e,t,r){return this._isObject(e,t).addValidation((function(){return void 0!==e._id?Bu(e._id):!r}),(function(){return td()}))},t.prototype.items=function(e,t){return this.addValidation((function(){return Wu(e)&&e.every((function(e){return Vu(e)&&(void 0===e._id||null===e._id||Bu(e._id))}))}),(function(){return Zu(t)})).addValidation((function(){return e.length<=1e3}),(function(){return ed(t)}))},t.prototype.fieldName=function(e){return this.addValidation((function(){return Bu(e)}),(function(){return Ku()}))},t.prototype.itemId=function(e){return this.addValidation((function(){return Bu(e)}),(function(){return Yu()}))},t.prototype.itemIds=function(e,t){return this.addValidation((function(){return Wu(e)&&e.every((function(e){return Bu(e)}))}),(function(){return Xu()})).addValidation((,(function(){return Ju(t)}))},t.prototype._options=function(e,t){return this.addValidation((function(){var r=Vu(e)&&t.every((function(t){return"language"===t?null==(r=e[t])||Bu(r)&&r.length>0:function(e){return null==e||(t=e,"boolean"===ju()(t));var t}(e[t]);var r}));return null==e||r}),(function(){return nd(t)}))},t.prototype.referenceRemoveParameters=function(e){return this.addValidation((function(){return Wu(e)&&e.every(yd)}),od)},t.prototype.referenceParameters=function(e){return this.addValidation((function(){return Wu(e)&&e.every(vd)}),od)},t.prototype.referenceParameter=t.prototype.isNonEmptyString=t.prototype.references=function(e){return this.addValidation((function(){return Wu(e)&&e.every(()}),ad)},t.prototype.options=t.prototype.bulkInsertOptions=function(e){return this._options(e,["suppressAuth","suppressHooks","overrideExisting"])},t.prototype.bulkUpdateOptions=function(e){return this._options(e,["suppressAuth","suppressHooks","showDrafts"])},t.prototype.bulkRemoveOptions=t.prototype.truncateOptions=t.prototype.collectionName=function(e){return this.addValidation((,()}}(gd);function vd(e){return Bu(e)&&""!==e||Vu(e)&&e.hasOwnProperty("_id")}function yd(e){return Bu(e)||Vu(e)&&e.hasOwnProperty("_id")}var Ed=);function Id(e){return sd(e),ud.CollectionDeleted)}var _d,Td,wd,Rd,Sd,bd,Od,Cd,Pd,Nd,Ad,Dd,xd,Ld=function(e){function t(t,r){var n=e.call(this,t)||this;return Object.setPrototypeOf(n,r.prototype),n.name=r.name,Error.captureStackTrace?Error.captureStackTrace(n,r):n.stack=new Error(t).stack,n}return Ed(t,e),t}(Error),Fd=function(e){function t(r){var n=e.call(this,r,t)||this;return n.reason=r,n.message=r,n}return Ed(t,e),t}(Ld),Md=function(e){eturn Ed(t,e),t}(Ld);unction kd(e){for(var t={},r=0,n=Object.keys(e);r<n.length;r++){var o=n[r],a=e[o];void 0!==a&&(t[a]=o)}return t}function Gd(e,t){return null==e?void 0:t(e)}!_d||(_d={})),function(e){e.ASC="ASC",e.DESC="DESC"}(Td||(Td={})),wd||(wd={})),function(e){e.UPDATE="UPDATE",e.REMOVE="REMOVE"}(Rd||(Rd={})),Sd||(Sd={})),bd||(bd={})),function(e){e.UNKNOWN="UNKNOWN",e.CMS="CMS"}(Od||(Od={})),Cd||(Cd={})),function(e){e.UNKNOWN_PUBLISH_PLUGIN_STATUS="UNKNOWN_PUBLISH_PLUGIN_STATUS",e.PUBLISHED="PUBLISHED",e.DRAFT="DRAFT"}(Pd||(Pd={})),Nd||(Nd={})),Ad||(Ad={})),function(e){e.OFFSET="OFFSET",e.CURSOR="CURSOR"}(Dd||(Dd={})),xd||(xd={}));var jd=function(){return jd=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},jd.apply(this,arguments)},Vd={ADMIN:m.PermissionRole.admin,SITE_MEMBER_AUTHOR:m.PermissionRole.siteMemberAuthor,SITE_MEMBER:m.PermissionRole.siteMember,ANYONE:m.PermissionRole.anyone,UNKNOWN_ROLE:void 0},Wd=kd(Vd),Bd={TEXT:m.FieldType.text,NUMBER:m.FieldType.number,DATE:m.FieldType.date,DATETIME:m.FieldType.dateTime,IMAGE:m.FieldType.image,BOOLEAN:m.FieldType.boolean,DOCUMENT:m.FieldType.document,URL:m.FieldType.url,RICH_TEXT:m.FieldType.richText,VIDEO:m.FieldType.video,ANY:m.FieldType.any,ARRAY_STRING:m.FieldType.stringArray,ARRAY_DOCUMENT:m.FieldType.documentArray,AUDIO:m.FieldType.audio,TIME:m.FieldType.time,LANGUAGE:m.FieldType.language,RICH_CONTENT:m.FieldType.richContent,MEDIA_GALLERY:m.FieldType.mediaGallery,ADDRESS:m.FieldType.address,PAGE_LINK:m.FieldType.pageLink,REFERENCE:m.FieldType.reference,MULTI_REFERENCE:m.FieldType.multiReference,OBJECT:m.FieldType.object,ARRAY:m.FieldType.array,LEGACY_TIME:m.FieldType.time,LEGACY_BOOK:m.FieldType.legacyBook,LEGACY_EXTERNAL_URL:m.FieldType.legacyExternalUrl,LEGACY_BROKEN_REFERENCE:m.FieldType.legacyBrokenRef,LEGACY_IMAGE:m.FieldType.legacyImage,LEGACY_COLOR:m.FieldType.color,LEGACY_EXTERNAL_VIDEO:m.FieldType.legacyExternalVideo,UNKNOWN_FIELD_TYPE:void 0},Hd=kd(Bd),qd=[{v1Type:m.MULTILINGUAL_PLUGIN_ID,v2Type:Ad.MULTILINGUAL,toV2:function(e){return{multilingualOptions:{translatableFieldKeys:e.translatable}}},toV1:function(e){var t,r;return{translatable:null!==(r=null===(t=e.multilingualOptions)||void 0===t?void 0:t.translatableFieldKeys)&&void 0!==r?r:[]}}},{v1Type:m.PUBLISHING_PLUGIN_ID,v2Type:Ad.PUBLISH,toV2:function(e){return{publishOptions:{defaultStatus:e.defaultStatus}}},toV1:,{v1Type:m.SINGLES_PLUGIN_ID,v2Type:Ad.SINGLE_ITEM,toV2:function(e){return{singleItemOptions:{singleItemId:e.singleItemId}}},toV1:function(e){var t,r;return{singleItemId:null!==(r=null===(t=e.singleItemOptions)||void 0===t?void 0:t.singleItemId)&&void 0!==r?r:"SINGLE_ITEM_ID"}}},{v1Type:m.URLIZED_PLUGIN_ID,v2Type:Ad.URLIZED,toV2:function(e){return{urlizedOptions:{format:e.format.toUpperCase()}}},toV1:function(e){var t;return{format:(null===(t=e.urlizedOptions)||void 0===t?void 0:t.format)===Nd.ORIGINAL?m.UrlizedFormat.ORIGINAL:m.UrlizedFormat.PLAIN}}},{v1Type:m.GRID_APPLESS_PLUGIN_ID,v2Type:Ad.GRIDAPPLESS,toV2:function(e){return{gridapplessOptions:{migrated:e.isMigrated}}},toV1:function(e){var t,r;return{isMigrated:null!==(r=null===(t=e.gridapplessOptions)||void 0===t?void 0:t.migrated)&&void 0!==r&&r}}},{v1Type:m.SHARED_PLUGIN_ID,v2Type:Ad.SHARED,toV2:function(e){return{}},toV1:,{v1Type:m.PAGE_LINK_PLUGIN_ID,v2Type:Ad.EDITABLE_PAGE_LINK,toV2:toV1:function(e){var t,r,n,o;return{isPersisted:null!==(r=null===(t=e.editablePageLinkOptions)||void 0===t?void 0:t.isPersisted)&&void 0!==r&&r,isUpdatable:null!==(o=null===(n=e.editablePageLinkOptions)||void 0===n?void 0:n.isMutable)&&void 0!==o&&o}}},{v1Type:m.CMS_PLUGIN_ID,v2Type:Ad.CMS,toV1:function(e){var t,r;return jd(jd({},null!==(t=e.cmsOptions)&&void 0!==t?t:{}),{siteSort:Gd(null===(r=e.cmsOptions)||void 0===r?void 0:r.siteSort,(function(e){var t;return{sort:(null!==(t=e.sort)&&void 0!==t?t:[]).map((function(e){var t;return{fieldName:e.fieldKey,direction:null===(t=e.direction)||void 0===t?void 0:t.toLowerCase()}}))}}))})},toV2:function(e){return{cmsOptions:jd(jd({},e),{siteSort:Gd(e.siteSort,(function(e){return{sort:e.sort.map(()}}))})}}}];var zd,$d,Yd=[{v1Type:m.CMS_FIELD_PLUGIN_ID,v2Type:Od.CMS,toV1:function(e){var t,r;return{internal:null!==(r=null===(t=e.cmsOptions)||void 0===t?void 0:t.internal)&&void 0!==r&&r}},toV2:function(e){return{cmsOptions:{internal:e.internal}}}}];function Xd(e){for(var t={},r=function(e){var r=Yd.find((function(t){return t.v2Type===e.type}));void 0!==r?t[r.v1Type]=r.toV1(e):t[e.type]=e},n=0,o=e;n<o.length;n++){r(o[n])}return t}function Jd(e){for(var t=[],r=function(e,r){var n=Yd.find((function(t){return t.v1Type===e}));void 0!==n?t.push(jd({type:n.v2Type},n.toV2(r))):t.push(r)},n=0,o=Object.entries(e);n<o.length;n++){var a=o[n];r(a[0],a[1])}return t}function Kd(e){if(e.permissions)return{insert:Wd[e.permissions.insert],update:Wd[e.permissions.update],remove:Wd[e.permissions.remove],read:Wd[e.permissions.read]}}function Qd(e){return Object.entries(e.fields||{}).filter((function(e){e[0];return!e[1].isDeleted})).sort((function(e,t){var r,n,o=null!==(r=e[1].index)&&void 0!==r?r:0,a=null!==(n=t[1].index)&&void 0!==n?n:0;return o>a?1:o<a||null!=o&&null==a?-1:null==o&&null!=a?1:0})).map((function(e){return function(e,t){function r(e){return Object.values(e).some(()?e:void 0}return Ud({key:e,displayName:t.displayName,type:Hd[t.type],typeMetadata:Zd(t),encrypted:t.pii,description:t.description,plugin:t.plugin,stringLengthRange:r({minLength:t.minStrLength,maxLength:t.maxStrLength}),arraySizeRange:r({minSize:t.minArraySize,maxSize:t.maxArraySize}),readOnly:t.readOnly,numberRange:r({min:t.minValue,max:t.maxValue}),immutable:t.immutable,required:t.required,plugins:Gd(t.plugins,Jd)})}(e[0],e[1])}))}function Zd(e){switch(e.type){case"pagelink":return function(e){return null==e.calculator||null==e.calculator.config?void 0:{pageLink:{linkedRouterPage:e.linkedRouterPage,calculator:Ud({fieldsPattern:Ud({pattern:e.calculator.config.pattern,lowercase:e.calculator.config.lowercase}),urlizedOnlyPattern:Ud({pattern:e.calculator.config.pattern})})}}}(e);case"reference":return e);case"multi-reference":return e);case"object":return function(e){return null==e.fields?void 0:{object:{fields:Object.entries(e.fields).map((function(e){return function(e,t){return Ud({key:e,displayName:t.displayName,type:Hd[t.type],typeMetadata:Zd(t)})}(e[0],e[1])}))}}}(e);case"array":return function(e){return null==e.elementType?void 0:{array:Ud({elementType:Hd[e.elementType.type],typeMetadata:Zd(e.elementType)})}}(e)}}function ep(e){var t;return function(e){for(var t=[],r=function(e,r){var n=qd.find(();void 0!==n?t.push(jd({type:n.v2Type},n.toV2(r))):t.push(r)},n=0,o=Object.entries(e);n<o.length;n++){var a=o[n];r(a[0],a[1])}return t}(null!==(t=e.plugins)&&void 0!==t?t:{})}var tp=((zd={})[Dd.OFFSET]=m.PagingMode.Offset,zd[Dd.CURSOR]=m.PagingMode.Cursor,zd),rp=(($d={})[_d.NATIVE]=m.Storage.docstore,$d[_d.WIX_APP]=m.Storage.driver,$d[_d.BLOCKS_APP]=m.Storage.staticAppSchema,$d[_d.EXTERNAL]=m.Storage.external,$d),np={IS_REFERENCED:m.DataOperation.isReferenced,INSERT:m.DataOperation.insert,SAVE:m.DataOperation.save,BULK_INSERT:m.DataOperation.bulkInsert,BULK_UPDATE:m.DataOperation.bulkUpdate,UPDATE:m.DataOperation.update,TRUNCATE:m.DataOperation.truncate,REMOVE:m.DataOperation.remove,REMOVE_REFERENCE:m.DataOperation.removeReference,COUNT:m.DataOperation.count,FIND:m.DataOperation.find,REPLACE_REFERENCES:m.DataOperation.replaceReferences,BULK_REMOVE:m.DataOperation.bulkRemove,INSERT_REFERENCE:m.DataOperation.insertReference,GET:m.DataOperation.get,BULK_SAVE:m.DataOperation.bulkSave,QUERY_REFERENCED:m.DataOperation.queryReferenced,DISTINCT:m.DataOperation.distinct,AGGREGATE:m.DataOperation.aggregate},op={UPDATE:m.CollectionOperation.UPDATE,REMOVE:m.CollectionOperation.REMOVE},ap={EQ:m.AllowedFilterOperator.eq,LT:m.AllowedFilterOperator.lt,GT:m.AllowedFilterOperator.gt,NE:m.AllowedFilterOperator.ne,LTE:m.AllowedFilterOperator.lte,GTE:m.AllowedFilterOperator.gte,STARTS_WITH:m.AllowedFilterOperator.startsWith,ENDS_WITH:m.AllowedFilterOperator.endsWith,CONTAINS:m.AllowedFilterOperator.contains,HAS_SOME:m.AllowedFilterOperator.hasSome,HAS_ALL:m.AllowedFilterOperator.hasAll,EXISTS:m.AllowedFilterOperator.exists,URLIZED:m.AllowedFilterOperator.urlized};function ip(e){var t,r,n,o=e;return Ud({id:o.id,isDeleted:!1,namespace:Ep(o.id),storage:rp[o.collectionType],ownerAppId:o.ownerAppId||null,displayNamespace:o.displayNamespace||null,displayField:o.displayField,allowedOperations:lp(o),collectionOperations:up(o),fields:fp(o),displayName:null!==(t=o.displayName)&&void 0!==t?t:o.id,permissions:cp(o),maxPageSize:null!==(r=o.maxPageSize)&&void 0!==r?r:void 0,defaultSort:dp(o.defaultDisplayOrder),version:sp(o.revision),plugins:pp(o.plugins),pagingMode:null===(n=o.pagingModes)||void 0===n?void 0:n.map((function(e){return tp[e]})),translatable:!1,ttl:null,capabilities:_p(o)})}function sp(e){var t=parseInt(null!=e?e:"0",10);return isNaN(t)?0:t}function cp(e){if(e.permissions){var t=e.permissions;return{read:Vd[t.read],insert:Vd[t.insert],remove:Vd[t.remove],update:Vd[t.update]}}}function lp(e){var t;return(null===(t=null==e?void 0:e.capabilities)||void 0===t?void 0:t.dataOperations).map((function(e){return np[e]}))}function up(e){var t,r=null===(t=null==e?void 0:e.capabilities)||void 0===t?void 0:t.collectionOperations;return null==r?void 0:r.map((function(e){return op[e]}))}function dp(e){return e?{direction:e.direction===Td.DESC?m.Direction.desc:m.Direction.asc,fieldName:e.fieldKey}:null}function pp(e){if(e)return function(e){for(var t={},r=function(e){var r=qd.find(();void 0!==r?t[r.v1Type]=r.toV1(e):t[e.type]=e},n=0,o=e;n<o.length;n++)r(o[n]);return t}(e)}function fp(e){return e.fields?e.fields.reduce((function(e,t,r){var n;return Object.assign({},e,((n={})[t.key]=function(e,t){var r,n,o,a,i,s,c,l,u,d,p,f,h,m,g,v,y,E,I,_,T,w,R,S,b,O,C,P=e;return Ud({displayName:null!==(r=P.displayName)&&void 0!==r?r:P.key,systemField:null!==(n=P.systemField)&&void 0!==n&&n,sortable:null===(o=null==P?void 0:P.capabilities)||void 0===o?void 0:o.sortable,isDeleted:!1,index:t,queryOperators:vp(P),plugin:null!==(a=null==P?void 0:P.plugin)&&void 0!==a?a:void 0,calculator:yp(P),pii:!!P.encrypted||void 0,linkedRouterPage:null!==(c=null===(s=null===(i=null==P?void 0:P.typeMetadata)||void 0===i?void 0:i.pageLink)||void 0===s?void 0:s.linkedRouterPage)&&void 0!==c?c:void 0,description:null!==(l=P.description)&&void 0!==l?l:void 0,readOnly:null!==(u=P.readOnly)&&void 0!==u?u:void 0,immutable:null!==(d=P.immutable)&&void 0!==d?d:void 0,required:null!==(p=P.required)&&void 0!==p?p:void 0,minValue:null!==(h=null===(f=null==P?void 0:P.numberRange)||void 0===f?void 0:f.min)&&void 0!==h?h:void 0,maxValue:null!==(g=null===(m=null==P?void 0:P.numberRange)||void 0===m?void 0:m.max)&&void 0!==g?g:void 0,minStrLength:null!==(y=null===(v=null==P?void 0:P.stringLengthRange)||void 0===v?void 0:v.minLength)&&void 0!==y?y:void 0,maxStrLength:null!==(I=null===(E=null==P?void 0:P.stringLengthRange)||void 0===E?void 0:E.maxLength)&&void 0!==I?I:void 0,minArraySize:null!==(T=null===(_=null==P?void 0:P.arraySizeRange)||void 0===_?void 0:_.minSize)&&void 0!==T?T:void 0,maxArraySize:null!==(R=null===(w=null==P?void 0:P.arraySizeRange)||void 0===w?void 0:w.maxSize)&&void 0!==R?R:void 0,type:Bd[P.type],referencedCollection:Ip(P.typeMetadata),referencingFieldKey:null===(b=null===(S=P.typeMetadata)||void 0===S?void 0:S.multiReference)||void 0===b?void 0:b.referencingFieldKey,referencingDisplayName:null===(C=null===(O=P.typeMetadata)||void 0===O?void 0:O.multiReference)||void 0===C?void 0:C.referencingDisplayName,fields:mp(P.typeMetadata),elementType:gp(P.typeMetadata),plugins:Gd(P.plugins,Xd)})}(t,r),n))}),{}):{}}function hp(e,t){return{type:Bd[e],fields:mp(t),elementType:gp(t)}}function mp(e){var t,r=null==e?void 0:e.object;if(r)return null===(t=r.fields)||void 0===t?void 0:t.reduce((function(e,t){var r;return Object.assign(e,((r={})[t.key]=function(e){var t;return Ud(Object.assign({displayName:e.displayName,sortable:null===(t=null==e?void 0:e.capabilities)||void 0===t?void 0:t.sortable,queryOperators:vp(e)},hp(e.type,e.typeMetadata)))}(t),r))}),{})}function gp(e){var t=null==e?void 0:e.array;if(t)return Ud(hp(t.elementType,t.typeMetadata))}function vp(e){var t,r=null===(t=null==e?void 0:e.capabilities)||void 0===t?void 0:t.queryOperators;return r?r.length>=Object.keys(ap).length?void 0:r.map((function(e){return ap[e]})):[]}function yp(e){var t,r,n,o,a,i,s,c,l,u,d=null===(t=e.typeMetadata)||void 0===t?void 0:t.pageLink;return d?{config:{lowercase:null!==(o=null===(n=null===(r=d.calculator)||void 0===r?void 0:r.fieldsPattern)||void 0===n?void 0:n.lowercase)&&void 0!==o&&o,pattern:null!==(u=null!==(s=null===(i=null===(a=d.calculator)||void 0===a?void 0:a.fieldsPattern)||void 0===i?void 0:i.pattern)&&void 0!==s?s:null===(l=null===(c=d.calculator)||void 0===c?void 0:c.urlizedOnlyPattern)||void 0===l?void 0:l.pattern)&&void 0!==u?u:"unknown"}}:void 0}function Ep(e){if(!e)return null;var t=e.lastIndexOf("/");return-1===t?null:e.substring(0,t)}function Ip(e){var t,r,n;return null!==(r=null===(t=null==e?void 0:e.multiReference)||void 0===t?void 0:t.referencedCollectionId)&&void 0!==r?r:null===(n=null==e?void 0:e.reference)||void 0===n?void 0:n.referencedCollectionId}function _p(e){var t,r=null===(t=null==e?void 0:e.capabilities)||void 0===t?void 0:t.indexLimits;if(r)return{indexing:{regular:r.regular,unique:r.unique,total:r.total}}}var Tp=function(){return Tp=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Tp.apply(this,arguments)},wp=function(e,t,r,n){return new(r||(r=Promise))((function(o,a){function i(e){try{c(n.next(e))}catch(e){a(e)}}function s(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,s)}c((n=n.apply(e,t||[])).next())}))},Rp=function(e,t){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Sp=function(){eturn e.prototype.get=function(e,t){var r,n,o;return wp(this,void 0,void 0,(function(){var a;return Rp(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,Op(this.transport.get({dataCollectionId:e,consistentRead:null==t?void 0:t.consistentRead}))];case 1:return[2,ip(i.sent().collection)];case 2:if(a=i.sent(),"WDE0025"===(null===(o=null===(n=null===(r=null==a?void 0:a.responseText)||void 0===r?void 0:r.details)||void 0===n?void 0:n.applicationError)||void 0===o?void 0:o.code))throw fd(e);throw a;case 3:return[2]}}))}))},e.prototype.bulkGet=function(e,t){return void 0===t&&(t={referencedCollectionsDepth:0}),wp(this,void 0,void 0,(function(){var r=this;return Rp(this,(function(n){switch(n.label){case 0:return[4,Np(e,100,(function(e){return wp(r,void 0,void 0,(function(){var r,n,o,a,i;return Rp(this,(function(s){switch(s.label){case 0:return r={dataCollectionIds:e,includeReferencedCollections:(null!==(i=t.referencedCollectionsDepth)&&void 0!==i?i:0)>0,showDeletedCollections:t.includeDeletedCollections,consistentRead:null==t?void 0:t.consistentRead},[4,Op(this.transport.getBulk(r))];case 1:return n=s.sent(),o=(n.activeCollections||[]).map(ip),(a=(n.deletedCollections||[]).map(ip)).forEach((),[2,o.concat(a)]}}))}))}))];case 1:return[2,Cp(n.sent())]}}))}))},e.prototype.listCollections=function(e){var t,r,n,o;return wp(this,void 0,void 0,(function(){var a,i,s,c,l,u;return Rp(this,(function(d){switch(d.label){case 0:a=[],i={offset:0},d.label=1;case 1:return[4,Op(this.transport.list({paging:i,consistentRead:null==e?void 0:e.consistentRead}))];case 2:return s=d.sent(),a=a.concat(null!==(t=s.collections)&&void 0!==t?t:[]),c=s.pagingMetadata,l=(null!==(r=null==c?void 0:c.offset)&&void 0!==r?r:0)+(null!==(n=null==c?void 0:c.count)&&void 0!==n?n:0),u=null!==(o=null==c?void 0:c.total)&&void 0!==o?o:0,l<u?(i.offset=l,[3,1]):[2,a];case 3:return[2]}}))}))},e.prototype.list=function(e){return wp(this,void 0,void 0,(function(){return Rp(this,(function(t){switch(t.label){case 0:return[4,this.listCollections(e)];case 1:return[2,Cp(t.sent().map(ip))]}}))}))},e.prototype.save=function(e,t){return wp(this,void 0,void 0,(function(){var r;return Rp(this,(function(n){switch(n.label){case 0:return r=function(e){var t;return Ud({id:e.id,displayName:e.displayName,displayField:e.displayField,fields:Qd(e),permissions:Kd(e),revision:null===(t=e.version)||void 0===t?void 0:t.toString(),plugins:ep(e)})}(t),r.id=e||r.id,[4,Op(t.version>0?this.transport.update({collection:r}):this.transport.create({collection:r}))];case 1:return[2,[ip(n.sent().collection)]]}}))}))},e.prototype.remove=function(e){return wp(this,void 0,void 0,(function(){return Rp(this,(function(t){switch(t.label){case 0:return[4,Op(this.transport.delete({dataCollectionId:e}))];case 1:return t.sent(),[2,[{id:e,isDeleted:!0}]]}}))}))},e.prototype.restore=e}();const bp=Sp;function Op(e){return e.catch((function(e){if(!e.response)return Promise.reject(new Fd(Pp(e)));var t=e.response,r=t.headers&&t.headers["x-wix-request-id"];return Promise.reject(new Md(t.status,t.data,Pp(t.data),r))}))}function Cp(e){return e.reduce((,{})}function Pp(e){return"object"==typeof e&&e.message?e.message:"string"==typeof e?e:JSON.stringify(e)}function Np(e,t,r){return wp(this,void 0,void 0,(function(){var n,o;return Rp(this,(function(a){switch(a.label){case 0:for(n=[],o=0;o<e.length;o+=t)n.push(r(e.slice(o,o+t)));return[4,Promise.all(n)];case 1:return[2,a.sent().reduce((,[])]}}))}))}var Ap=function(e){return e.split("#")};var Dp="_",xp=/{(.*)}/,Lp=new RegExp("\\.(".concat(["wix.com","editorx.com"].join("|"),")$")),Fp=new RegExp("\\.(".concat(["42.wixprod.net","uw2-edt-1.wixprod.net"].join("|"),")$")),Mp=new RegExp(".*\\.".concat("dev.wix-code.com","$"));ar kp,Gp,jp="www._base_domain_";||(kp={}));var Hp,qp,zp,$p,Yp=((Gp={types:["google.protobuf.Timestamp"]})[kp.TO_JSON]={transform:,Gp[kp.FROM_JSON]={transform:,Gp),Xp=((Hp={types:["google.protobuf.FieldMask"]})[kp.TO_JSON]={transform:function(e){return e.join(",")},checkRepetable:,Hp[kp.FROM_JSON]={transform:,Hp),Jp=((qp={types:["google.protobuf.BytesValue","BYTES"]})[kp.TO_JSON]={transform:,qp[kp.FROM_JSON]={transform:,qp),Kp=((zp={types:["google.protobuf.Duration"]})[kp.TO_JSON]={transform:,zp[kp.FROM_JSON]={transform:,zp);ar Zp=(($p={types:["FLOAT","DOUBLE","google.protobuf.FloatValue","google.protobuf.DoubleValue"]})[kp.TO_JSON]={transform:,$p[kp.FROM_JSON]={transform:,$p),ef=function(){return ef=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},ef.apply(this,arguments)};var tf=[],[Yp,Xp,Jp,Kp,Zp],!0).reduce((,{});ar nf={typeMetadata:"_typeMetadata"},of={},af={activeCollections:"_dataCollection",deletedCollections:"_dataCollection"},sf={collection:"_dataCollection"},cf={collection:"_dataCollection"},lf={createdDate:"google.protobuf.Timestamp",updatedDate:"google.protobuf.Timestamp",fields:"_field"},uf={},df={},pf={numberRange:"_numberRange",typeMetadata:"_typeMetadata"},ff={},hf={collection:"_dataCollection",referencedCollections:"_dataCollection"},mf={},gf={collections:"_dataCollection"},vf={min:"google.protobuf.DoubleValue",max:"google.protobuf.DoubleValue"},yf={fields:"_objectField"},Ef={typeMetadata:"_typeMetadata"},If={object:"_object",array:"_array"},_f={collection:"_dataCollection"},Tf={collection:"_dataCollection"};function wf(e){return Up(Object.assign(e,{domainToMappings:{"api._api_base_domain_":[{srcPath:"/cloud-data",destPath:""}],"code._base_domain_":[{srcPath:"/_api/cloud-data/v1/data-settings",destPath:"/v1/data-settings"},{srcPath:"/_api/cloud-data/v1/schemas",destPath:"/v1/schemas"},{srcPath:"/_api/cloud-data/v1/connector",destPath:"/v1/connector"},{srcPath:"/_api/data/v1/data-settings",destPath:"/v1/data-settings"},{srcPath:"/_api/data/v1/schemas",destPath:"/v1/schemas"},{srcPath:"/_api/data/v1/connector",destPath:"/v1/connector"},{srcPath:"/_api/cloud-data/v1/wix-data",destPath:"/v1/wix-data"}],"cloud-data.wix-code.com":[{srcPath:"",destPath:""}],_:[{srcPath:"/_api/cloud-data",destPath:""}],"www._base_domain_":[{srcPath:"/_api/cloud-data",destPath:""},{srcPath:"/_api/data",destPath:""}],"dev._base_domain_":[{srcPath:"/_api/cloud-data",destPath:""}],"bo._base_domain_":[{srcPath:"/_api/cloud-data/v1",destPath:"/v1"},{srcPath:"/_api/cloud-data/v2",destPath:"/v2"}],"manage._base_domain_":[{srcPath:"/_api/cloud-data",destPath:""},{srcPath:"/_api/data",destPath:""}],"editor._base_domain_":[{srcPath:"/_api/cloud-data/v1/schemas",destPath:"/v1/schemas"},{srcPath:"/_api/cloud-data/dbs/tasks",destPath:"/dbs/tasks"},{srcPath:"/_api/data/v1/schemas",destPath:"/v1/schemas"},{srcPath:"/_api/data/dbs/tasks",destPath:"/dbs/tasks"},{srcPath:"/_api/cloud-data/v1/wix-data",destPath:"/v1/wix-data"},{srcPath:"/_api/cloud-data/v1/data-settings",destPath:"/v1/data-settings"},{srcPath:"/_api/data/v2/indexes",destPath:"/v2/indexes"},{srcPath:"/_api/cloud-data/v1/external-database-connections",destPath:"/v1/external-database-connections"},{srcPath:"/_api/data/v1/data-collection-sharing",destPath:"/v1/data-collection-sharing"},{srcPath:"/_api/cloud-data/v2/collections",destPath:"/v2/collections"},{srcPath:"/_api/cloud-data/v2/bulk",destPath:"/v2/bulk"}],"blocks._base_domain_":[{srcPath:"/_api/cloud-data/v1/schemas",destPath:"/v1/schemas"},{srcPath:"/_api/cloud-data/dbs/tasks",destPath:"/dbs/tasks"},{srcPath:"/_api/data/v1/schemas",destPath:"/v1/schemas"},{srcPath:"/_api/data/dbs/tasks",destPath:"/dbs/tasks"},{srcPath:"/_api/cloud-data/v1/wix-data",destPath:"/v1/wix-data"},{srcPath:"/_api/cloud-data/v1/data-settings",destPath:"/v1/data-settings"},{srcPath:"/_api/data/v2/indexes",destPath:"/v2/indexes"},{srcPath:"/_api/cloud-data/v1/external-database-connections",destPath:"/v1/external-database-connections"},{srcPath:"/_api/data/v1/data-collection-sharing",destPath:"/v1/data-collection-sharing"},{srcPath:"/_api/cloud-data/v2/collections",destPath:"/v2/collections"},{srcPath:"/_api/cloud-data/v2/bulk",destPath:"/v2/bulk"}],"create.editorx":[{srcPath:"/_api/cloud-data/v1/schemas",destPath:"/v1/schemas"},{srcPath:"/_api/cloud-data/dbs/tasks",destPath:"/dbs/tasks"},{srcPath:"/_api/data/v1/schemas",destPath:"/v1/schemas"},{srcPath:"/_api/data/dbs/tasks",destPath:"/dbs/tasks"},{srcPath:"/_api/cloud-data/v1/wix-data",destPath:"/v1/wix-data"},{srcPath:"/_api/cloud-data/v1/data-settings",destPath:"/v1/data-settings"},{srcPath:"/_api/data/v2/indexes",destPath:"/v2/indexes"},{srcPath:"/_api/cloud-data/v1/external-database-connections",destPath:"/v1/external-database-connections"},{srcPath:"/_api/data/v1/data-collection-sharing",destPath:"/v1/data-collection-sharing"},{srcPath:"/_api/cloud-data/v2/collections",destPath:"/v2/collections"},{srcPath:"/_api/cloud-data/v2/bulk",destPath:"/v2/bulk"}],"www.wixapis.com":[{srcPath:"/wix-data/v1/collections",destPath:"/v1/wix-data/collections"},{srcPath:"/wix-data/v1/external-database-connections",destPath:"/v1/external-database-connections"},{srcPath:"/wix-data/v2/indexes",destPath:"/v2/indexes"},{srcPath:"/wix-data/v1/items",destPath:"/v1/items"},{srcPath:"/wix-data/v1/bulk",destPath:"/v1/bulk"},{srcPath:"/wix-data/v1/external-databases",destPath:"/v1/external-databases"},{srcPath:"/wix-data/v2",destPath:"/v2"}],"www.wixgateway.com":[{srcPath:"/wix-data/v1/items",destPath:"/v1/items"},{srcPath:"/wix-data/v1/bulk",destPath:"/v1/bulk"}]}}))}var Rf=Sf=function(){function e(e,t,r){this.httpClient=e,this.signedInstance=t,this.baseUrl=function(e){var t=null==e?void 0:e.baseUrl;if(!t)return"https://cloud-data.wix-code.com";return t=Of(t,"/"),t=Of(t,"/v1/schemas")}(r)}return e.prototype._call=function(e){var t=this;return this.httpClient.request((function(r){var n=e(r),o=t.baseUrl+n.url,"/_api/cloud-data");return Rf(Rf({},n),{url:o,headers:Rf(Rf({},n.headers),{authorization:t.signedInstance})})}),{signedInstance:this.signedInstance}).then((function(e){return e.data}))},e.prototype.create=function(e){return this._call(function(e){var t=rf(sf,{_array:nf,_dataCollection:lf,_field:pf,_numberRange:vf,_object:yf,_objectField:Ef,_typeMetadata:If}),r=t.toJSON,n=t.fromJSON,o=rf(cf,{_array:nf,_dataCollection:lf,_field:pf,_numberRange:vf,_object:yf,_objectField:Ef,_typeMetadata:If}).fromJSON;function a(t){var n=t.host,a=r(e);return{entityFqdn:"wix.data.v2.data_collection",method:"POST",methodFqn:"com.wixpress.cloud.data.api.collectionservice.DataCollectionService.CreateDataCollection",url:wf({protoPath:"/v2/collections",data:a,host:n}),data:a,transformResponse:o}}return a.fromReq=n,a.__isAmbassador=!0,a}(e))},e.prototype.delete=function(e){return this._call(function(e){var t=rf(uf,{}),r=t.toJSON,n=t.fromJSON,o=rf(df,{}).fromJSON;function a(t){var n=t.host,a=r(e);return{entityFqdn:"wix.data.v2.data_collection",method:"DELETE",methodFqn:"com.wixpress.cloud.data.api.collectionservice.DataCollectionService.DeleteDataCollection",url:wf({protoPath:"/v2/collections/{dataCollectionId}",data:a,host:n}),params:Wp(a),transformResponse:o}}return a.fromReq=n,a.__isAmbassador=!0,a}(e))},e.prototype.get=function(e){return this._call(function(e){var t=rf(ff,{}),r=t.toJSON,n=t.fromJSON,o=rf(hf,{_array:nf,_dataCollection:lf,_field:pf,_numberRange:vf,_object:yf,_objectField:Ef,_typeMetadata:If}).fromJSON;function a(t){var n=t.host,a=r(e);return{entityFqdn:"wix.data.v2.data_collection",method:"GET",methodFqn:"com.wixpress.cloud.data.api.collectionservice.DataCollectionService.GetDataCollection",url:wf({protoPath:"/v2/collections/{dataCollectionId}",data:a,host:n}),params:Wp(a),transformResponse:o}}return a.fromReq=n,a.__isAmbassador=!0,a}(e))},e.prototype.getBulk=function(e){return this._call(function(e){var t=rf(of,{}),r=t.toJSON,n=t.fromJSON,o=rf(af,{_array:nf,_dataCollection:lf,_field:pf,_numberRange:vf,_object:yf,_objectField:Ef,_typeMetadata:If}).fromJSON;function a(t){var n=t.host,a=r(e);return{entityFqdn:"wix.data.v2.data_collection",method:"POST",methodFqn:"com.wixpress.cloud.data.api.collectionservice.DataCollectionService.BulkGetDataCollections",url:wf({protoPath:"/v2/bulk/collections/get",data:a,host:n}),data:a,transformResponse:o}}return a.fromReq=n,a.__isAmbassador=!0,a}(e))},e.prototype.list=function(e){return this._call(function(e){var t=rf(mf,{}),r=t.toJSON,n=t.fromJSON,o=rf(gf,{_array:nf,_dataCollection:lf,_field:pf,_numberRange:vf,_object:yf,_objectField:Ef,_typeMetadata:If}).fromJSON;eturn a.fromReq=n,a.__isAmbassador=!0,a}(e))},e.prototype.update=function(e){return this._call(function(e){var t=rf(_f,{_array:nf,_dataCollection:lf,_field:pf,_numberRange:vf,_object:yf,_objectField:Ef,_typeMetadata:If}),r=t.toJSON,n=t.fromJSON,o=rf(Tf,{_array:nf,_dataCollection:lf,_field:pf,_numberRange:vf,_object:yf,_objectField:Ef,_typeMetadata:If}).fromJSON;eturn a.fromReq=n,a.__isAmbassador=!0,a}(e))},e}();const bf=Sf;function Of(e,t){return e.endsWith(t)?e.substring(0,e.length-t.length):e}var Cf=a(4126),Pf=function(e){return"object"==typeof e&&e.message?e.message:"string"==typeof e?e:JSON.stringify(e)},Nf=function(e){return e.reduce((function(e,t){var r;return Object.assign({},e,((r={})[t.id]=t,r))}),{})},Af=function(e,t){return e.endsWith(t)?e.substring(0,e.length-t.length):e},Df=function(){function e(e,t,r,n){var o=this,a=function(e){return e=Af(e,"/"),Af(e,"/v1/schemas")}(n&&n.baseUrl||"https://cloud-data.wix-code.com");this.signedInstance=t,this.gridAppId=r,this.mutate=function(t,r,n){return e[t](a+r,n,o._setHeaders()).then((function(e){return e.data})).catch(o._handleError)},this.retrieve=function(t){return e.get(a+t,o._setHeaders()).then((function(e){return e.data})).catch(o._handleError)}}return e.prototype.wrapWithDefaultOptions=function(e){return Object.assign({},e,{appId:this.gridAppId})},e.prototype.formRequestUrl=e.prototype.get=function(e,t){void 0===t&&(t={includeDeletedCollections:!1});var r=this.wrapWithDefaultOptions({includeDeleted:!0,schemaIds:e});return this.retrieve(this.formRequestUrl(r)).then((function(r){var n=r.schemas[0];return n&&n.isDeleted&&!t.includeDeletedCollections?Id(e):n||Promise.reject(fd(e))}))},e.prototype.bulkGet=function(e,t){void 0===t&&(t={includeDeletedCollections:!1,referencedCollectionsDepth:0});var r=this.wrapWithDefaultOptions({depth:t.referencedCollectionsDepth||0,includeDeleted:t.includeDeletedCollections||!1,schemaIds:e});return this.retrieve(this.formRequestUrl(r)).then((function(e){var t=e.schemas;return Nf(t)}))},e.prototype.list=function(e){void 0===e&&(e={includeDeletedCollections:!1});var t=this.wrapWithDefaultOptions({schemaIds:[],depth:0,includeDeleted:e.includeDeletedCollections||!1});return this.retrieve(this.formRequestUrl(t)).then(()},e.prototype.save=function(e,t){var r=this.wrapWithDefaultOptions({schemaId:e,schema:t});return this.mutate("post","/v1/schemas",r).then((function(e){return e.schemas}))},e.prototype.setIsDeletedFlag=function(e,t){var r=this.wrapWithDefaultOptions({schemaId:e,partialSchema:{isDeleted:t}});return this.mutate("patch","/v1/schemas",r).then((function(e){return e.schemas}))},e.prototype.remove=function(e){return this.setIsDeletedFlag(e,!0)},e.prototype.restore=e.prototype._setHeaders=e.prototype._handleError=function(e){if(!e.response)return Promise.reject(new Fd(Pf(e)));var t=e.response,r=t.headers&&t.headers["x-wix-request-id"];return Promise.reject(new Md(t.status,t.data,Pf(t.data),r))},e}();const xf=Df;var Lf=Ff=Mf=function(){function e(e,t,r,n){(null==n?void 0:n.client)?this._client=n.client:(null==n?void 0:n.useApiV2)?this._client=new bp(new bf(e,t,n)):this._client=new xf(e,t,r,n)}return e.prototype.get=function(e,t){var r=this;return this._client.get(e,t).then((function(e){return r._mapDefaults(e)}))},e.prototype.bulkGet=function(e,t){return Lf(this,void 0,void 0,(function(){var r=this;return Ff(this,(function(n){return e&&0!==e.length?[2,this._client.bulkGet(e,t).then((function(e){return r._mapDefaultsForSchemas(e)}))]:[2,{}]}))}))},e.prototype.list=function(e){var t=this;return this._client.list(e).then(()},e.prototype.save=e.prototype.remove=function(e){return this._client.remove(e)},e.prototype.restore=e.prototype._mapDefaultsForSchemas=function(e){var t=this;return Object.keys(e).reduce((function(r,n){var o=e[n];return r[n]=t._mapDefaults(o),r}),{})},e.prototype._mapDefaults=function(e){var t,r;e.displayField||(e.fields&&e.fields.title?e.displayField="title":e.displayField="_id");for(var n=0,o=Object.values(e.fields);n<o.length;n++){var a=o[n];(null===(r=null===(t=a.plugins)||void 0===t?void 0:t.cms)||void 0===r?void 0:r.internal)&&(a.systemField=!0,a.sortable=!1,a.queryOperators=[])}return e},e}();const Uf=Mf;var kf=const Gf="v1",jf=2,Vf=1920,Wf=1920,Bf=1e3,Hf=1e3,qf={SCALE_TO_FILL:"fill",SCALE_TO_FIT:"fit",STRETCH:"stretch",ORIGINAL_SIZE:"original_size",TILE:"tile",TILE_HORIZONTAL:"tile_horizontal",TILE_VERTICAL:"tile_vertical",FIT_AND_TILE:"fit_and_tile",LEGACY_STRIP_TILE:"legacy_strip_tile",LEGACY_STRIP_TILE_HORIZONTAL:"legacy_strip_tile_horizontal",LEGACY_STRIP_TILE_VERTICAL:"legacy_strip_tile_vertical",LEGACY_STRIP_SCALE_TO_FILL:"legacy_strip_fill",LEGACY_STRIP_SCALE_TO_FIT:"legacy_strip_fit",LEGACY_STRIP_FIT_AND_TILE:"legacy_strip_fit_and_tile",LEGACY_STRIP_ORIGINAL_SIZE:"legacy_strip_original_size",LEGACY_ORIGINAL_SIZE:"actual_size",LEGACY_FIT_WIDTH:"fitWidth",LEGACY_FIT_HEIGHT:"fitHeight",LEGACY_FULL:"full",LEGACY_BG_FIT_AND_TILE:"legacy_tile",LEGACY_BG_FIT_AND_TILE_HORIZONTAL:"legacy_tile_horizontal",LEGACY_BG_FIT_AND_TILE_VERTICAL:"legacy_tile_vertical",LEGACY_BG_NORMAL:"legacy_normal"},zf={FIT:"fit",FILL:"fill",FILL_FOCAL:"fill_focal",CROP:"crop",LEGACY_CROP:"legacy_crop",LEGACY_FILL:"legacy_fill"},$f={CENTER:"center",TOP:"top",TOP_LEFT:"top_left",TOP_RIGHT:"top_right",BOTTOM:"bottom",BOTTOM_LEFT:"bottom_left",BOTTOM_RIGHT:"bottom_right",LEFT:"left",RIGHT:"right"},Yf={[$f.CENTER]:{x:.5,y:.5},[$f.TOP_LEFT]:{x:0,y:0},[$f.TOP_RIGHT]:{x:1,y:0},[$f.TOP]:{x:.5,y:0},[$f.BOTTOM_LEFT]:{x:0,y:1},[$f.BOTTOM_RIGHT]:{x:1,y:1},[$f.BOTTOM]:{x:.5,y:1},[$f.RIGHT]:{x:1,y:.5},[$f.LEFT]:{x:0,y:.5}},Xf={center:"c",top:"t",top_left:"tl",top_right:"tr",bottom:"b",bottom_left:"bl",bottom_right:"br",left:"l",right:"r"},Jf="img",Kf={AUTO:"auto",CLASSIC:"classic",SUPER:"super"},Qf={classic:1,super:2},Zf={radius:"0.66",amount:"1.00",threshold:"0.01"},eh=25e6,th=[1.5,2,4],rh={HIGH:{size:196e4,quality:90,maxUpscale:1},MEDIUM:{size:36e4,quality:85,maxUpscale:1},LOW:{size:16e4,quality:80,maxUpscale:1.2},TINY:{size:0,quality:80,maxUpscale:1.4}},nh={HIGH:"HIGH",MEDIUM:"MEDIUM",LOW:"LOW",TINY:"TINY"},oh={CONTRAST:"contrast",BRIGHTNESS:"brightness",SATURATION:"saturation",HUE:"hue",BLUR:"blur"},ah={JPG:"jpg",JPEG:"jpeg",JPE:"jpe",PNG:"png",WEBP:"webp",WIX_ICO_MP:"wix_ico_mp",WIX_MP:"wix_mp",GIF:"gif",SVG:"svg",UNRECOGNIZED:"unrecognized"},ih=(ah.JPG,ah.JPEG,ah.JPE,ah.PNG,ah.GIF,ah.WEBP,{isMobile:!1}),sh=function(e){return ih[e]};st dh=[ah.PNG,ah.JPEG,ah.JPG,ah.JPE,ah.WIX_ICO_MP,ah.WIX_MP,ah.WEBP],ph=[ah.JPEG,ah.JPG,ah.JPE];nst mh=["/","\\","?","<",">","|","\u201c",":",'"'].map(encodeURIComponent),gh=["\\.","\\*"],vh="_";$f.TOP,$f.TOP_LEFT,$f.TOP_RIGHT,$f.BOTTOM,$f.BOTTOM_LEFT,$f.BOTTOM_RIGHT,$f.LEFT,$f.RIGHT;h=lh`fit/w_${"width"},h_${"height"}`,Mh=lh`fill/w_${"width"},h_${"height"},al_${"alignment"}`,Uh=lh`fill/w_${"width"},h_${"height"},fp_${"focalPointX"}_${"focalPointY"}`,kh=lh`crop/x_${"x"},y_${"y"},w_${"width"},h_${"height"}`,Gh=lh`crop/w_${"width"},h_${"height"},al_${"alignment"}`,jh=lh`fill/w_${"width"},h_${"height"},al_${"alignment"}`,Vh=lh`,lg_${"upscaleMethodValue"}`,Wh=lh`,q_${"quality"}`,Bh=lh`,usm_${"radius"}_${"amount"}_${"threshold"}`,Hh=lh`,bl`,qh=lh`,wm_${"watermark"}`,zh={[oh.CONTRAST]:lh`,con_${"contrast"}`,[oh.BRIGHTNESS]:lh`,br_${"brightness"}`,[oh.SATURATION]:lh`,sat_${"saturation"}`,[oh.HUE]:lh`,hue_${"hue"}`,[oh.BLUR]:lh`,blur_${"blur"}`},$h=lh`,enc_auto`;onst Xh={[$f.CENTER]:"50% 50%",[$f.TOP_LEFT]:"0% 0%",[$f.TOP_RIGHT]:"100% 0%",[$f.TOP]:"50% 0%",[$f.BOTTOM_LEFT]:"0% 100%",[$f.BOTTOM_RIGHT]:"100% 100%",[$f.BOTTOM]:"50% 100%",[$f.RIGHT]:"100% 50%",[$f.LEFT]:"0% 50%"};Object.entries(Xh).reduce((,{}),qf.TILE,qf.TILE_HORIZONTAL,qf.TILE_VERTICAL,qf.LEGACY_BG_FIT_AND_TILE,qf.LEGACY_BG_FIT_AND_TILE_HORIZONTAL,qf.LEGACY_BG_FIT_AND_TILE_VERTICAL,qf.LEGACY_ORIGINAL_SIZE,qf.ORIGINAL_SIZE,qf.LEGACY_BG_NORMAL;onst Kh=/^media\//i,Qh="undefined"!=typeof window?window.devicePixelRatio:1,Zh=ch(),ch();const em={getScaleToFitImageURL:getScaleToFillImageURL:getCropImageURL:;ar rm=new WeakMap,nm=new WeakMap,om=new WeakMap,am=new WeakMap,im=new WeakMap,sm=new WeakMap,cm=new WeakMap;class lm{constructor(e){let{platformUtils:t,wixSdk:r,bi:n,tpaActionImplementations:o,devMode:a,verbose:i}=e;tm(this,rm,{writable:!0,value:void 0}),tm(this,nm,{writable:!0,value:void 0}),tm(this,om,{writable:!0,value:void 0}),tm(this,am,{writable:!0,value:void 0}),tm(this,im,{writable:!0,value:void 0}),tm(this,sm,{writable:!0,value:void 0}),tm(this,cm,{writable:!0,value:void 0}),u()(this,rm,this._getSettings({wixSdk:r,bi:n,devMode:a,verbose:i})),u()(this,nm,this._getUser(r.user)),u()(this,om,this._getLocation(r.location,n)),u()(this,am,this._getUtils(t)),u()(this,im,this._getTimers(r)),u()(this,sm,(async e=>{let{currentItem:t,action:n}=e;const a=o[n];await a({wixSdk:r,currentItem:t})})),u()(this,cm,this._getSeo(r))}get settings(){return c()(this,rm)}get user(){return c()(this,nm)}get location(){return c()(this,om)}get utils(){return c()(this,am)}get timers(){return c()(this,im)}get executeTpaAction(){return c()(this,sm)}getSettings(e){let{wixSdk:{window:{viewMode:t,rendering:{env:r},browserLocale:n},site:{regionalSettings:o=n}},bi:{metaSiteId:a,viewerName:i},devMode:s,verbose:c}=e;return{metaSiteId:a,locale:o,mode:{name:r,dev:s,verbose:c,ssr:"backend"===r,csr:"backend"!==r},env:{name:t,live:"Site"===t,preview:"Preview"===t,livePreview:"Editor"===t,editor:"Preview"===t||"Editor"===t,renderer:i}}}_getUser(e){return{get id(){return e.currentUser.id},get loggedInonLogin:e.onLogin}}_getLocation(e,t){let{baseUrl:r,url:n,to:o}=e,{pageId:a}=t;return{pageId:a,pageUrl:n,baseUrl:r,navigateTo:o}}_getUtils(e){let{links:t,mediaItemUtils:r}=e;return{links:t,media:{...r,getScaleToFillImageURL:em.getScaleToFillImageURL}}}_getTimers(e){var t;return{queueMicrotask:(null==(t=e.environment)||null==(t=t.timers)?void 0:t.queueMicrotask)||queueMicrotask}}const um=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"\u0627\u0644\u0643\u0644"}');var dm=a.t(um,2);const pm=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"\u0412\u0441\u0438\u0447\u043a\u0438"}');var fm=a.t(pm,2);const hm=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Tot"}');var mm=a.t(hm,2);const gm=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"V\u0161e"}');var vm=a.t(gm,2);const ym=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Alle"}');var Em=a.t(ym,2);const Im=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Alle"}');var _m=a.t(Im,2);const Tm=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"\u038c\u03bb\u03b1"}');var wm=a.t(Tm,2);const Rm=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"All"}');var Sm=a.t(Rm,2);const bm=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Todo"}');var Om=a.t(bm,2);const Cm=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Tout"}');var Pm=a.t(Cm,2);const Nm=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"\u05d4\u05db\u05dc"}');var Am=a.t(Nm,2);const Dm=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"\u0938\u092d\u0940"}');var xm=a.t(Dm,2);const Lm=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"\xd6sszes"}');var Fm=a.t(Lm,2);const Mm=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Semua"}');var Um=a.t(Mm,2);const km=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Tutti"}');var Gm=a.t(km,2);const jm=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"\u3059\u3079\u3066"}');var Vm=a.t(jm,2);const Wm=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"\uc804\uccb4"}');var Bm=a.t(Wm,2);const Hm=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Viskas"}');var qm=a.t(Hm,2);const zm=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Semua"}');var $m=a.t(zm,2);const Ym=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Alle"}');var Xm=a.t(Ym,2);const Jm=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Alle"}');var Km=a.t(Jm,2);const Qm=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Wszystkie"}');var Zm=a.t(Qm,2);const eg=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Todos"}');var tg=a.t(eg,2);const rg=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Toate"}');var ng=a.t(rg,2);const og=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"\u0412\u0441\u0435"}');var ag=a.t(og,2);const ig=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"V\u0161etky"}');var sg=a.t(ig,2);const cg=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Vse"}');var lg=a.t(cg,2);const ug=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Alla"}');var dg=a.t(ug,2);const pg=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"\u0e17\u0e31\u0e49\u0e07\u0e2b\u0e21\u0e14"}');var fg=a.t(pg,2);const hg=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Lahat"}');var mg=a.t(hg,2);const gg=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Hepsi"}');var vg=a.t(gg,2);const yg=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"\u0423\u0441\u0456"}');var Eg=a.t(yg,2);const Ig=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"T\u1ea5t c\u1ea3"}');var _g=a.t(Ig,2);const Tg=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"\u6240\u6709"}');const wg={ar:dm,bg:fm,ca:mm,cs:vm,da:Em,de:_m,el:wm,en:Sm,es:Om,fr:Pm,he:Am,hi:xm,hu:Fm,id:Um,it:Gm,ja:Vm,ko:Bm,lt:qm,ms:$m,nl:Xm,no:Km,pl:Zm,pt:tg,ro:ng,ru:ag,sk:sg,sl:lg,sv:dg,th:fg,tl:mg,tr:vg,uk:Eg,vi:_g,zh:a.t(Tg,2)},Rg=wg.en;function Sg(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}var bg=new WeakMap,Og=new WeakMap,Cg=new WeakMap,Pg=new WeakMap,Ng=new WeakMap,Ag=new WeakMap,Dg=new WeakMap;const{initAppForPage:xg,createControllers:Lg}=new class{constructor(e){var t=this;let{verbose:r=!1,wixDataSchemasForItTests:n,automationsClientCreator:i=C,tpaActionImplementations:s=p}=void 0===e?{}:e;return o()(this,"initAppForPage",(function(e,r,n,o){let{bi:i={},monitoring:{createMonitor:s},fedOpsLoggerFactory:l,biLoggerFactory:d,essentials:{httpClient:p,experiments:f}}=void 0===o?{}:o;try{const o=new lm({platformUtils:r,wixSdk:n,bi:i,tpaActionImplementations:c()(t,Dg),devMode:!1,verbose:c()(t,Pg)}),{settings:m}=o,{instance:g,appData:{gridAppId:v},url:y}=e;(e=>{try{a.p=e.substr(0,e.lastIndexOf("/")+1)}catch(e){}})(y);const{data:E,window:{warmupData:I,getRouterData:_},location:{baseUrl:T,protocol:w},site:{language:R,currentPage:S}}=n;u()(t,Cg,_()),u()(t,Og,new na({fedops:{factory:l,hooks:{start:e=>{let{name:r}=e;return c()(t,Og).log(new Be({category:"interaction start",message:"interaction "+r+" started"}))},end:e=>{let{name:r,duration:n}=e;return c()(t,Og).log(new Be({category:"interaction end",message:"interaction "+r+" ended after "+n+" ms"}))}}},bi:{factory:d},monitor:{factory:s},verbose:{factory:()=>({log:function(){var e;return((null==(e=n.telemetry)?void 0:e.console)||console).verbose(...arguments)}})},console:{factory:()=>{var e;return(null==(e=n.telemetry)?void 0:e.console)||console}},settings:m,global:self})),c()(t,Og).log(new We("databinding/initAppForPage",We.types.START));const b=(e=>{var t;const r=null!=(t=wg[e])?t:Rg;return{t:})(R),O=(e=>{let{experiments:t,settings:{env:r}}=e;return{get fes(){return t.enabled("specs.wixDataViewer.EnableFES")},get warmupData(){return r.live},get newCurrentPageIndex(){return t.enabled("specs.wixDataViewer.NewCurrentPageIndex")},get automationsClientV2})({experiments:f,settings:m}),C=O.fes?new Vn({httpClient:p,getRequestParams:):new vo({wixData:E,wixDataSchemas:c()(t,Ng)||kf(p,g,v,{baseUrl:(m.env.editor?"https":w)+"://"+h()(T).hostname+"/_api/cloud-data",useApiV2:!0})}),P=new So(I),N=new Ao(c()(t,Cg)),A=ku({automationsClientCreator:()=>O.automationsClientV2?(e=>({reportFormEventToAutomationCreator:()=>async(t,r,n)=>{const o=t.detailedEventPayload["form-id"].value,a=Ze(t.detailedEventPayload).filter(().reduce(((e,r)=>{const n=r.split(".")[1],{keyName:o,valueType:a,value:i}=t.detailedEventPayload[r];return e[n]={displayName:o,value:i,type:a},e}),{}),i={formId:o,pageId:n,submissionTime:new Date,fields:a,collectionId:r};await e.post("/_serverless/cms-automations/report-cms-form-submission",i)}}))(p):c()(t,Ag).call(t,{httpClient:p}),pageId:S.id});return u()(t,bg,new Au({platform:o,dataFetcher:C,warmupCache:P,staticCache:N,features:O,listenersByEvent:A,logger:c()(t,Og),i18n:b,global:self,loadExpressionFunctions:ki})),c()(t,Og).log(new We("databinding/initAppForPage",We.types.END)),Promise.resolve()}catch(e){return c()(t,Og)&&c()(t,Og).log(new N("App initialisation failed",{cause:e})),Promise.reject(e)}})),o()(this,"createControllers",(e=>{if(!e.length)return[];const t=(r=e,n=c()(this,Cg),r.map((e=>{let{compId:t,config:{dataset:{collectionName:r,filter:o,sort:a,includes:i,nested:s,pageSize:c,readWriteType:l,deferred:u,cursor:d}={}}={},type:p,connections:f,livePreviewOptions:{shouldFetchData:h,compsIdsToReset:m=[]}={}}=e;const g={id:t,type:p,collectionId:r,filter:o,sort:a,pageSize:c,readWriteType:l,includes:i,nested:s,deferred:u,connections:f,dataIsInvalidated:h,updatedCompIds:m,cursor:d};return p===Or&&n?((e,t)=>{const{readWriteType:r}=e,{config:{dataset:{collectionName:n,filter:o,sort:a,includes:i,pageSize:s,lowercase:c,seoV2:l}},dynamicUrl:u,userDefinedFilter:d}=t;return{...e,collectionId:n,filter:o,sort:a,includes:i,pageSize:s,readWriteType:r,dynamicPageData:{lowercase:c,dynamicUrl:u,userDefinedFilter:d,seoV2:l}}})(g,n):g})));var r,n;const o=e.reduce(((e,t)=>{let{$w:r,compId:n}=t;return e[n]=r.fireEvent,e}),{});return c()(this,bg).initializeDatasets({datasetConfigs:t,firePlatformEvent:e=>o[e]}).map((e=>({...e,pageReady:)))})),Sg(this,bg,{writable:!0,value:void 0}),Sg(this,Og,{writable:!0,value:void 0}),Sg(this,Cg,{writable:!0,value:void 0}),Sg(this,Pg,{writable:!0,value:void 0}),Sg(this,Ng,{writable:!0,value:void 0}),Sg(this,Ag,{writable:!0,value:void 0}),Sg(this,Dg,{writable:!0,value:void 0}),u()(this,Ng,n),u()(this,Ag,i),u()(this,Pg,r),u()(this,Dg,s),{initAppForPage:this.initAppForPage,createControllers:this.createControllers}}}})(),i})()));
//# sourceMappingURL=app.js.map