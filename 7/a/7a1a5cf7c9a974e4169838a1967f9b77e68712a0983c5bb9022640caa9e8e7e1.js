![,,function(t,e,n){var r,i,a;!)},function(t,e,n){"use strict";n.r(e),n.d(e,"init",(function(){return Je})),n.d(e,"apmBase",(function(){return Ve})),n.d(e,"ApmBase",(function(){return $e})),n.d(e,"apm",(function(){return Ve}));var r=i=setTimeout;unction o(){}type.catch=s.prototype.then=s.prototype.finally=r,s.all=s.resolve=s.reject=s.race=s._immediateFn="function"==typeof setImmediate&&|s._unhandledRejectionFn=var v=s,h={};y?h=window:"undefined"!=typeof self&&(h=self);var g="Promise"in h?h.Promise:v,m=[].slice,y="undefined"!=typeof window,_=y&&"undefined"!=typeof performance?performance:{};for(var b=[],S=0;S<256;++S)b[S]=(S+256).toString(16).substr(1);var w=new Uint8Array(16); I(t){return C(t,m.call(arguments,1),!1)}nction A(){}fetchInProgress:!1};r V=U("xhrIgnore"),J=U("xhrSync"),X=U("xhrURL"),Z=U("xhrMethod"),G="schedule",W="invoke",K="addEventListener",Q="removeEventListener",Y=["link","css","script","img","xmlhttprequest","fetch","beacon","iframe"],tt=3e5,et="page-load",nt="custom",rt="Unknown",it=[et,"route-change","user-interaction","http-request",nt,"temporary"],at=60,ot="xmlhttprequest",st="fetch",ct="history",ut="eventtarget",ft="error",dt="longtask",pt="measure",lt="navigation",vt="resource",ht="first-contentful-paint",gt="largest-contentful-paint",mt="first-input",yt="layout-shift",_t="ConfigService",bt="LoggingService",St="ApmServer",wt=".truncated",Tt=1024;function Et(t){var e=XMLHttpRequest.prototype;if(e&&e[K])var n="readystatechange",r="load",i="error",a="timeout",o="abort",s=$(e,"open",(),c=$(e,"send",(function(){return function(e,s){if(e[V])return c.apply(e,s);var f={source:ot,state:"",type:"macroTask",data:{target:e,method:e[Z],sync:e[J],url:e[X],status:""}};try{return function(e){if(e.state!==G){e.state=G,t(G,e);var s=e.data.target;c(n),c(r),c(a),c(i),c(o)}(f),c.apply(e,s)}catch(t){throw u(f,i),t}}}));for(var xt=["click"],kt={},Lt=0;Lt<xt.length;Lt++){var Ot=xt[Lt];kt[Ot]=U(Ot)}ar Nt=),It=new Nt,jt=!1;function Ft(){return jt||(jt=!0,Et((function(t,e){It.send(ot,[t,e])})),function(t){if(window.fetch&&window.Request){var e=window.fetch;window.fetch=function(t,i){var a,o,s=this,c=arguments;if("string"==typeof t)a=new Request(t,i),o=t;else{if(!t)return e.apply(s,c);o=(a=t).url}var u={source:st,state:"",type:"macroTask",data:{target:a,method:a.method,url:o,aborted:!1}};return new g(()}}function n(e){e.state=G,t(G,e)}((function(t,e){It.send(st,[t,e])})),function(t){if(window.history){var e=history.pushState;"function"==typeof e&&(history.pushState=function(n,r,i){var a={source:ct,data:{state:n,title:r,url:i}};t(W,a),e.apply(this,arguments)})}}((function(t,e){It.send(ct,[t,e])})),()),It}var At={bootstrapTime:null,lastHiddenStart:Number.MIN_SAFE_INTEGER},Pt=!1;ar Mt=n(0),qt=n.n(Mt);function Ht(t){var e=t.error,n=t.filename,r=t.lineno,i=t.colno,a=[];if(e)try{a=qt.a.parse(e)}catch(t){}return 0===a.length&&(a=[{fileName:n,lineNumber:r,columnNumber:i}]),a.map(().map(()}var zt=[["#","hash"],["?","query"],["/","path"],["@","auth",1],[NaN,"host",void 0,1]],Dt=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,Bt=);var Ut=91,$t=93,Vt="external",Jt="resource",Xt="hard-navigation";ction Kt(t,e){if(e){var n;switch(t.type){case Vt:n=e);break;case Jt:n=e);break;case Xt:n=e)}t.addContext(n)}}function Qt(t,e){var n=void 0===e?{}:e,r=(n.tags,function(t,e){if(null==t)return{};var n,r,i={},a=Object.keys(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(n,["tags"])),i=Wt(),a={};if(t.type===et&&z()){var o=_.getEntriesByType(lt);o&&o.length>0&&(a={response:Zt(o[0])})}t.addContext(i,a,r)}var Yt={service:{name:[Tt,!0],version:!0,agent:{version:[Tt,!0]},environment:!0},labels:{"*":!0}},te={"*":!0,headers:{"*":!0}},ee={user:{id:!0,email:!0,username:!0},tags:{"*":!0},http:{response:te},destination:{address:[Tt],service:{"*":[Tt,!0]}},response:te},ne={name:[Tt,!0],type:[Tt,!0],id:[Tt,!0],trace_id:[Tt,!0],parent_id:[Tt,!0],transaction_id:[Tt,!0],subtype:!0,action:!0,context:ee},re={name:!0,parent_id:!0,type:[Tt,!0],id:[Tt,!0],trace_id:[Tt,!0],span_count:{started:[Tt,!0]},context:ee},ie={id:[Tt,!0],trace_id:!0,transaction_id:!0,parent_id:!0,culprit:!0,exception:{type:!0},transaction:{type:!0},context:ee}; ce=["stack","message"];var ue=function(){ar e=t.prototype;return e.createErrorDataModel=function(t){var e=Ht(t)),n="(inline script)",r=e[e.length-1];r&&r.filename&&(n=r.filename);var i=t.message,a=t.error,o=i,s="",c={};if(a&&"object"==typeof a){o=o||a.message,s=a.name;var u=a);u&&(c.custom=u)}s||o&&o.indexOf(":")>-1&&(s=o.split(":")[0]);var f=this._transactionService.getCurrentTransaction(),d=f?f.context:{},p=this._configService.get("context"),l=(p.tags,p,["tags"])),v=j({},Wt(),d,l,c),h={id:T(),culprit:n,exception:{message:o,stacktrace:e,type:s},context:v};return f&&(h=I(h,{trace_id:f.traceId,parent_id:f.id,transaction_id:f.id,transaction:{type:f.type,sampled:f.sampled}})),se(ie,h)},e.logErrorEvent=e.registerListeners=e.logPromiseEvent=function(t){var e,n="Unhandled promise rejection: ",r=t.reason,i=void 0===r?"<no reason specified>":r;"string"==typeof i.message?e={error:i,message:n+(i.name?i.name+": ":"")+i.message}:e={message:n+(i="object"==typeof i?"<object>":"function"==typeof i?"<function>":i)};this.logErrorEvent(e)},e.logError=t}(),fe=);var de=),pe=function(){ar e=t.prototype;return e.ensureContext=e.addLabels=e.addContext=e.end=e.callOnEnd=e.duration=t}();var le=pe),ve=[["domainLookupStart","domainLookupEnd","Domain lookup"],["connectStart","connectEnd","Making a connection to the server"],["requestStart","responseEnd","Requesting and receiving the document"],["domLoading","domInteractive","Parsing the document, executing sync. scripts"],["domContentLoadedEventStart","domContentLoadedEventEnd",'Fire "DOMContentLoaded" event'],["loadEventStart","loadEventEnd",'Fire "load" event']]; ye=["fetchStart","domainLookupStart","domainLookupEnd","connectStart","connectEnd","requestStart","responseStart","responseEnd","domLoading","domInteractive","domContentLoadedEventStart","domContentLoadedEventEnd","domComplete","loadEventStart","loadEventEnd"],_e=["fs","ls","le","cs","ce","qs","rs","re","dl","di","ds","de","dc","es","ee"];function be(t){var e=function(t){var e=t.fetchStart,n=t.navigationStart;if(n&&e<n)return null;var r={};return ye.forEach((),r}(t);return null==e?null:{navigationTiming:e,agent:{timeToFirstByte:e.responseStart,domInteractive:e.domInteractive,domComplete:e.domComplete}}}function Se(t){if(t.captureTimings){var e=t._end;if(t.type===et){if(t.marks&&t.marks.custom){var n=t.marks.custom;Object.keys(n).forEach(()}t._start=0;var r=_.timing;((r,r.fetchStart,0,e).forEach((),t.addMarks(be(r))}if(z()){var i=t._start;((_.getEntriesByType(vt),At.bootstrapTime,i,e).forEach((function(e){return t.spans.push(e)})),function(t,e,n){for(var r=[],i=0;i<t.length;i++){var a=t[i],o=a.name,s=a.startTime,c=a.duration,u=s+c;if(!(c<=at)&&he(s,u,e,n)){var f=new le(o,"app");f._start=s,f.end(u),r.push(f)}}return r}(_.getEntriesByType(pt),i,e).forEach(()}}} xe=function(){ar e=t.prototype;return e.init=e._postJson=e._constructError=e._makeHttpRequest=e.fetchConfig=e.createMetaData=e.addError=function(t){var e;this.throttleEvents(((e={}).errors=t,e))},e.addTransaction=e.ndjsonErrors=e.ndjsonMetricsets=e.ndjsonTransactions=function(t,e){var n=this,r=e?"x":"transaction";return t.map((function(t){var i,a="",o="";return e||(t.spans&&(a=t.spans.map(().join(""),delete t.spans),t.breakdown&&(o=n.ndjsonMetricsets(t.breakdown),delete t.breakdown)),de.stringify(((i={})[r]=e?function(t){var e,n=t.spans.map((function(e){var n={id:e.id,n:e.name,t:e.type,s:e.start,d:e.duration,c:Te(e.context)};return e.parent_id!==t.id&&(n.pid=e.parent_id),!0===e.sync&&(n.sy=!0),e.subtype&&(n.su=e.subtype),e.action&&(n.ac=e.action),n}));return{id:t.id,tid:t.trace_id,n:t.name,t:t.type,d:t.duration,c:Te(t.context),m:Ee(t.marks),me:(e=t.breakdown,e.map(()),y:n,yc:{sd:n.length},sm:t.sampled,exp:t.experience}}(t):t,i))+a+o}))},e.sendEvents=t}();var ke,Le=function(){function t(){this.config={serviceName:"",serviceVersion:"",environment:"",serverUrl:"http://localhost:8200",active:!0,instrument:!0,disableInstrumentations:[],logLevel:"warn",breakdownMetrics:!1,ignoreTransactions:[],eventsLimit:80,queueLimit:-1,flushInterval:500,distributedTracing:!0,distributedTracingOrigins:[],distributedTracingHeaderName:"traceparent",pageLoadTraceId:"",pageLoadSpanId:"",pageLoadSampled:!1,pageLoadTransactionName:"",transactionSampleRate:1,centralConfig:!1,monitorLongtasks:!0,apiVersion:2,context:{}},this.events=new Nt,this.filters=[],this.version=""}var e=t.prototype;return e.init=e.isActive=e.setVersion=function(t){this.version=t},e.addFilter=e.applyFilters=e.get=e.setUserContext=e.setCustomContext=e.addLabels=e.setConfig=function(t){void 0===t&&(t={}),t.serverUrl&&(t.serverUrl=t.serverUrl.replace(/\/+$/,"")),j(this.config,t),this.events.send("config:change",[this.config])},e.validate=e.getLocalConfig=e.setLocalConfig=t}(),Oe=),Ce=((ke={})[_t]=ke[bt]=ke[St]=function(t){var e=t.getService([_t,bt]),n=e[0],r=e[1];return new xe(n,r)},ke),Ne=function(){ar e=t.prototype;return e.init=function(){if(!this.initialized){this.initialized=!0;var t=this.getService(_t);t.init();var e=this.getService([bt,St]),n=e[0],r=e[1];t.events.observe("config:change",(),r.init()}},e.getService=t}();var Ie=.05;var je=function(){ar e=t.prototype;return e.init=e.getEventTargetSub=function(){var t=this._transactionService;return function(e,n){if(e===G&&n.source===ut&&"click"===n.eventType){var r=n.target,i=r.getAttribute("name"),a="";i&&(a='["'+i+'"]');var o=r.tagName.toLowerCase(),s=t.startTransaction("Click - "+o+a,"user-interaction",{managed:!0,canReuse:!0,reuseThreshold:100});if(s){var c=r.getAttribute("class");c&&s.addContext({custom:{classes:c}})}}}},e.getHistorySub=e.getXHRSub=e.getFetchSub=e.processAPICalls=function(t,e){var n=this._configService,r=this._transactionService;if(t===G&&e.data){var i=e.data,a=new Bt(i.url),o=i.method+" "+(a.relative?a.path:L(a.href));r.getCurrentTransaction()||r.startTransaction(o,"http-request",{managed:!0});var s=r.startSpan(o,"external.http",{blocking:!0});if(!s)return;var c=n.get("distributedTracing"),u=n.get("distributedTracingOrigins"),f=new Bt(window.location.href),d=E(a.origin,f.origin)||E(a.origin,u),p=i.target;c&&d&&p&&this.injectDtHeader(s,p),i.sync&&(s.sync=i.sync),i.span=s}else if(t===W){var l=e.data;l&&l.span&&r.endSpan(l.span,l)}},e.injectDtHeader=e.extractDtHeader=e.filterTransaction=e.createTransactionDataModel=function(t){var e=t._start,n=t.spans.map((function(n){var r={id:n.id,transaction_id:t.id,parent_id:n.parentId||t.id,trace_id:t.traceId,name:n.name,type:n.type,subtype:n.subtype,action:n.action,sync:n.sync,start:parseInt(n._start-e),duration:n.duration(),context:n.context};return se(ne,r)})),r={id:t.id,trace_id:t.traceId,name:t.name,type:t.type,duration:t.duration(),spans:n,context:t.context,marks:t.marks,breakdown:t.breakdownTimings,span_count:{started:n.length},sampled:t.sampled,experience:t.experience};return se(re,r)},e.createTransactionPayload=function(t){var e=function(t){if(t.sampled){var e=t.spans.filter(();if(t.isManaged()){var n=e,t.duration(),Ie);t.spans=n}else t.spans=e}else t.resetSpans();return t}(t);if(this.filterTransaction(e))return this.createTransactionDataModel(t)},t}(),Fe=[["domainLookupStart","domainLookupEnd","DNS"],["connectStart","connectEnd","TCP"],["requestStart","responseStart","Request"],["responseStart","responseEnd","Response"],["domLoading","domComplete","Processing"],["loadEventStart","loadEventEnd","Load"]]; Me=function(t){var e,n;function r(e,n,r){var i;return(i=t.call(this,e,n,r)||this).traceId=T(),i.marks=void 0,i.spans=[],i._activeSpans={},i._activeTasks=new Set,i.blocked=!1,i.captureTimings=!1,i.breakdownTimings=[],i.sampled=Math.random()<=i.options.transactionSampleRate,i}n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n;var i=r.prototype;return i.addMarks=i.mark=i.canReuse=i.redefine=i.startSpan=function(t,e,n){var r=this;if(!this.ended){var i=I({},n);i.onEnd=i.traceId=this.traceId,i.sampled=this.sampled,i.parentId||(i.parentId=this.id);var a=new le(t,e,i);return this._activeSpans[a.id]=a,i.blocking&&this.addTask(a.id),a}},i.isFinished=i.detectFinish=i.end=i.captureBreakdown=i.block=i.addTask=i.removeTask=i.resetSpans=i._onSpanEnd=i.isManaged=r}(pe),qe={fid:0,fcp:0,tbt:{start:1/0,duration:0},cls:0},He=50;function ze(t,e){var n=e.capturePaint,r=t.getEntriesByType(dt),i={spans:function(t){for(var e=[],n=0;n<t.length;n++){var r=t[n],i=r.name,a=r.startTime,o=r.duration,s=r.attribution,c=a+o,u=new le("Longtask("+i+")",dt,{startTime:a});if(s.length>0){var f=s[0],d=f.name,p=f.containerType,l=f.containerName,v=f.containerId,h={attribution:d,type:p};l&&(h.name=l),v&&(h.id=v),u.addContext({custom:h})}u.end(c),e.push(u)}return e}(r),marks:{}};if(!n)return i;var a=t.getEntriesByType(gt),o=a[a.length-1];if(o){var s=parseInt(o.startTime);qe.lcp=s,i.marks.largestContentfulPaint=s}var c=_.timing,u=c.fetchStart-c.navigationStart,f=t.getEntriesByName(ht)[0];if(f){var d=parseInt(u>=0?f.startTime-u:f.startTime);qe.fcp=d,i.marks.firstContentfulPaint=d}var p=t.getEntriesByType(mt));return p&&(qe.fid=p._start,i.spans.push(p)),function(t){t.forEach(()}(r),function(t){t.forEach(()}(t.getEntriesByType(yt)),i}var De=),Be=function(){ar e=t.prototype;return e.ensureCurrentTransaction=e.getCurrentTransaction=e.setCurrentTransaction=e.createOptions=e.startManagedTransaction=e.startTransaction=e.handleTransactionEnd=function(t){var e=this;this.recorder.stop();var n=window.location.href;return g.resolve().then((function(){var r=t.name,i=t.type;if(!(At.lastHiddenStart>=t._start||e.shouldIgnoreTransaction(r)||"temporary"===i)){if(i===et){var a=e._config.get("pageLoadTransactionName");if(r===rt&&a&&(t.name=a),t.captureTimings){var o=qe.cls,s=qe.fid,c=qe.tbt;c.duration>0&&t.spans.push((f=(u=c).start,d=u.duration,(p=new le("Total Blocking Time",dt,{startTime:f})).end(f+d),p)),t.experience={},D(dt)&&(t.experience.tbt=c.duration),D(yt)&&(t.experience.cls=o),s>0&&(t.experience.fid=s)}}var u,f,d,p;t.name===rt&&(t.name=n)),Se(t),e.adjustTransactionTime(t),e._config.get("breakdownMetrics")&&t.captureBreakdown();var l=e._config.get("context");Qt(t,l),e._config.events.send("transaction:end",[t])}}),()},e.adjustTransactionTime=e.shouldIgnoreTransaction=e.startSpan=function(t,e,n){var r=this.ensureCurrentTransaction(void 0,"temporary",this.createOptions({canReuse:!0,managed:!0}));if(r){var i=r.startSpan(t,e,n);return i}},e.endSpan=t}();function Ue(){return Ce.TransactionService=Ce.PerformanceMonitoring=Ce.ErrorLogging=new Ne}var $e=function(){ar e=t.prototype;return e.init=function(t){var e=this;if(this.isEnabled()&&!this._initialized){this._initialized=!0;var n=this.serviceFactory.getService([_t,bt]),r=n[0],i=n[1];r.setVersion("5.5.0"),this.config(t);var a=r.get("logLevel");if(i.setLevel(a),r.isActive()){this.serviceFactory.init();var o=r.get("instrument"),r.get("disableInstrumentations"));if(this.serviceFactory.getService("PerformanceMonitoring").init(o),o[ft])this.serviceFactory.getService("ErrorLogging").registerListeners();var s=r.get("centralConfig")?this.fetchCentralConfig().then(s):s()}else this._disable=!0,i.warn("RUM agent is inactive")}return this},e.fetchCentralConfig=e._sendPageLoadMetrics=e.isEnabled=e.observe=e.config=function(t){var e=this.serviceFactory.getService(_t),n=e.validate(t),r=n.missing,i=n.invalid;if(0===r.length&&0===i.length)e.setConfig(t);else{var a=this.serviceFactory.getService(bt),o="RUM agent isn't correctly configured. ";r.length>0&&(o+=r.join(", ")+" is missing",i.length>0&&(o+=", ")),i.forEach((),a.error(o),e.setConfig({active:!1})}},e.setUserContext=function(t){this.serviceFactory.getService(_t).setUserContext(t)},e.setCustomContext=function(t){this.serviceFactory.getService(_t).setCustomContext(t)},e.addLabels=function(t){this.serviceFactory.getService(_t).addLabels(t)},e.setInitialPageLoadName=function(t){this.isEnabled()&&this.serviceFactory.getService(_t).setConfig({pageLoadTransactionName:t})},e.startTransaction=function(t,e,n){if(this.isEnabled())return this.serviceFactory.getService("TransactionService").startTransaction(t,e,n)},e.startSpan=e.getCurrentTransaction=e.captureError=e.addFilter=t}();var Ve=),Je=Ve.init.bind(Ve);e.default=Je}]);
//# sourceMappingURL=elastic-apm-rum.umd.min.js.map