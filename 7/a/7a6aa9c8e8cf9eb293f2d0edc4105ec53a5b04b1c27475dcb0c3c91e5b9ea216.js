try{![function(t,e){(void 0===window.QSI.PopUnderMixin||window.QTest)&&(QSI.PopUnderMixin={openParentWatcher:function(t,e){try{if(this.isPopUnderRunning())return;this.trigger("start");var i=new Date,n=i.valueOf().toString(),o=this.getName()+"_"+n;this.name=o;var r=this.getCurrentURL(),s=this.build(),a=this.getWidth(),h=this.getHeight();try{this.watcher=QSI.util.legacyOpenWin("",o,this.getWindowOptions()),QSI.windowHandler.addWindowHandle(o,this.watcher);var d=QSI.windowHandler.getWindowOrigin(window);QSI.windowHandler.addOptInIDAndWindowName(t,o,e||d),this.watcher.openerURL=r;var c=this.watcher.document.createElement("div"),u=this.watcher.document.createTextNode("");c.appendChild(u),c=this.watcher.document.createElement("div"),u=this.watcher.document.createTextNode(""),c.appendChild(u)}catch(t){return QSI.dbg.e("Failed to load PopUnder"),this.watcher&&this.watcher.close(),void QSI.cookie.erase(this.name)}this.validateWatcher(a,h),this.watcher.width=a,this.watcher.height=h,this.watcher.openerURL=r,this.watcher.openerOnLoadTime=i,this.writeHTMLToWatcher(a,h,s,bind(this)),setTimeout((function(){QSI.util.moveToBackground()}))}catch(t){QSI.dbg.e(t)}},getWindowOptions:function(){var t=this.getParentDims();return{width:this.getWidth(),height:this.getHeight(),scrollbars:"1",resizable:"1",top:t.top,left:t.left}},isPopUnderRunning:function(){QSI.dbg.e("You must implement isPopUnderRunning")},getName:function(){QSI.dbg.e("You must implement getName")},getWidth:function(){QSI.dbg.e("You must implement getWidth")},getHeight:function(){QSI.dbg.e("You must implement getHeight")},getCloseIfTab:function(){return!1},getCurrentURL:getParentDims:function(){var t=(window.screenTop?window.screenTop:window.screenY)||0,e=(window.screenLeft?window.screenLeft:window.screenX)||0;return{top:t+=20,left:e+=20}},build:function(){QSI.dbg.e("You must implement build")},validateWatcher:function(t,e){var i=QSI.util.getWindowSize(this.watcher);i.height!==e&&i.width!==t&&this.getCloseIfTab()&&(QSI.util.getWindowSize().width===i.width&&this.watcher.close())},getNonce:function(){for(var t=document.getElementsByTagName("script"),e=null,i=0;null===e&&i<t.length;){e=t[i].getAttribute("nonce"),i++}return e},loadScriptForWatcher:function(t,e){var i=t.createElement("script");i.src=QSI.global.hostedJSLocation+e+"?";var n=[];void 0!==QSI.Orchestrator&&void 0!==QSI.Orchestrator.getClientVersionQueryString&&n.push(QSI.Orchestrator.getClientVersionQueryString()),(-1!==window.location.href.indexOf("Q_DEBUG")||QSI.config.debug)&&n.push("Q_DEBUG=true"),i.src+=n.join("&"),t.head.appendChild(i)},writeHTMLToWatcher:function(t,e,i,n){var o="rgb(255,255,255)",r=o;this.popunderOptions&&this.popunderOptions.baseElement&&this.popunderOptions.baseElement.style&&(r=this.popunderOptions.baseElement.style.backgroundColor||o);var s=this.watcher.document;s.body.style.padding="0px",s.body.style.margin="0px",s.body.style.backgroundColor=r,s.body.innerHTML=i,this.watcher.QSI={parentOrigin:window.location.origin,winWidth:t,winHeight:e,scriptsInitialized:,this.loadScriptForWatcher(s,"PopUnderWatcherModule.js")},initWatcher:hasWatcherLoaded:function(t){for(var e=!1,i=0;i<2e4&&!e;i++)try{this.watcher.openerURL=t,e=!0}catch(t){}return e},on:trigger:function(t){if(this._evts&&this._evts[t])for(var e=this._evts[t],i=0,n=e.length;i<n;i++)e[i]()}})},function(t,e){(void 0===window.QSI.PopUnder||window.QTest)&&(QSI.PopUnder=QSI.util.Creative(QSI.BuildElementModule,QSI.PopUnderMixin,{initialize:function(t){try{this.globalInitialize(t),this.shouldAnchor=!0,this.name="QSIPopUnder_"+this.id,(void 0!==t.isPlaceholderWindow&&t.isPlaceholderWindow||void 0!==t.popunderOptions&&void 0!==t.popunderOptions.showTargetOnPopForward&&t.popunderOptions.showTargetOnPopForward)&&(this.name=this.name+"_placeholderWindow"),QSI.global.intercepts[this.id]&&(this.asid=QSI.global.intercepts[this.id].ASID),this.popunderOptions=this.options.popunderOptions||{},this.popunderHelperOptions=this.options.popunderHelperOptions||{},this.shouldPreloadImages=!1;var e=this;this.on("start",(function(){QSI.cookie.set(e.name.replace(/_placeholderWindow/,""),e.asid,0,null,{force:!0})})),this.on("show",(),this.shouldShow()&&this.prepareParentWatcher()}catch(t){QSI.dbg.e(t)}},prepareParentWatcher:function(){var t=this;this.setPreventRepeatedDisplayCookie(),this.f=function(){try{t.startWatcher()}catch(t){"undefined"!=typeof QSI&&QSI.dbg&&QSI.dbg.e&&QSI.dbg.e(t)}},QSI.util.observe(document,"click",this.f);for(var e=document.getElementsByTagName("embed"),i=0;i<e.length;i++){var n=e[i];QSI.util.observe(n,"mouseup",this.f)}},startWatcher:isPopUnderRunning:function(){var t=QSI.cookie.get(this.name);if(t){if(t===this.asid)return!0;QSI.util.legacyOpenWin("",this.name).close()}return!1},getName:function(){return this.name},getWidth:function(){return this.popunderOptions.width},getHeight:function(){return this.popunderOptions.height},getCloseIfTab:build:function(){return this.options.elements?(this.elements=this.options.elements.Elements||[],QSI.util.processLocators(this.elements),this.html=this.buildHTML()):(this.options.locators&&(QSI.PipedText.setLocators(this.options.locators),this.popunderOptions.html=QSI.PipedText.evaluateLocators(this.popunderOptions.html,this)),this.html=this.popunderOptions.html),this.html},buildHTML:function(){for(var t=[],e=0,i=0,n=0,o=0,r=this.elements.length;o<r;o++){var s=this.buildElement(this.elements[o]);s&&(s.style&&s.style.borderWidth&&(n=2*parseInt(s.style.borderWidth,10)),s.bc&&s.bc.x+n>e&&(e=s.bc.x+n),s.bc&&s.bc.y+n>i&&(i=s.bc.y+n),t.push(s))}this.width=e,this.height=i;var a="fixed";QSI.util.isFixed()?this.insertIntoBody&&(a="relative"):a="absolute";var h=this.height,d=QSI.util.build("div",{className:"QSIPopUnder "+this.id+"_PopUnderContainer",style:{width:"100%",height:h+"px",overflow:"hidden",position:a}},t),c=[];return c.push(d),QSI.util.build("div",{},c).innerHTML},initWatcher:function(){this.popunderHelperOptions.targetURL=this.getTarget(),this.popunderHelperOptions.parent=this,this.popunderHelperOptions.id=this.id,this.popunderHelperOptions.noshow=this.interceptDisplayOptions.noshow,this.popunderHelperOptions.cookieDomain=this.interceptDisplayOptions.cookieDomain,this.popunderHelperOptions.browser=QSI.Browser.name,this.popunderHelperOptions.domain=QSI.CookieDomain?QSI.CookieDomain:null,this.options.resetStyle&&(this.popunderHelperOptions.resetCSS=this.options.resetStyle);var t=this.watcher.w;t.initialize(this.popunderHelperOptions),QSI.util.observe(window,"unload",(function(){try{t.imagesLoaded<t.imgCount&&t.initializeImages()}catch(t){}})),this.watcher.blur(),window.focus(),setTimeout((function(){try{window.focus()}catch(t){"undefined"!=typeof QSI&&QSI.dbg&&QSI.dbg.e&&QSI.dbg.e(t)}}),1),this.watcher.w.startWatching()},killPopunder:function(t){return this.watcher&&((t=t||window.event).stopPropagation?t.stopPropagation():t.cancelBubble=!0,this.watcher.w.killPopunder()),!1},buildCloseButtonElement:function(t){var e=this.buildBaseElement(t);return this.fixTransparentWithOpacity(e),e.style.cursor="pointer",e.setAttribute("onclick","w.destroyPopunder()"),e},buildEmbeddedTargetElement:function(t){var e=t.embeddedData||[],i={id:"PopUnderTargetFrame","data-src":this.getTarget(e),width:t.style.width,height:t.style.height,frameBorder:0};QSI.global.isHostedJS()&&!QSI.util.isIE(9)&&(i.sandbox="allow-scripts allow-same-origin allow-popups");var n=QSI.util.build("iframe",i);return t.content=n,this.buildBaseElement(t)}}))},function(t,e){void 0===window.QSI.PopUnderTarget&&(QSI.PopUnderTarget=QSI.util.Class(QSI.PopUnderMixin,{initialize:function(t,e,i){this.options=e||{},this.url=t,this.width=e.targetFullScreen?screen.availWidth||screen.width:e.targetWidth,this.height=e.targetFullScreen?screen.availHeight||screen.height:e.targetHeight;var n=i.options.targetURLOrigin||"*";if(e.targetPopUnderDisplay&&e.targetPopUnderDisplay.creative){var o=e.targetPopUnderDisplay.creative;new QSI.PopUnder({id:i.id,requestId:i.requestId,type:"PopUnder",targetURL:t,impressionURL:"",interceptDisplayOptions:i.options.interceptDisplayOptions,actionOptions:{},elements:o.elements,resetStyle:"",locators:{},popunderOptions:o.popunderOptions,isPlaceholderWindow:!0,popunderHelperOptions:o.popunderHelperOptions}).startWatcher()}else this.openParentWatcher(i.id,n)},getWindowOptions:function(){var t=this.getParentDims();return{width:this.getWidth(),height:this.getHeight(),scrollbars:!1,resizable:"1",top:t.top,left:t.left}},build:getWidth:function(){return this.width},getHeight:isPopUnderRunning:getName:initWatcher:function(){if(this.watcher){var t=this.getParentDims();"Chrome"!==QSI.Browser.name&&this.watcher.blur(),window.focus(),setTimeout((function(){try{window.focus()}catch(t){"undefined"!=typeof QSI&&QSI.dbg&&QSI.dbg.e&&QSI.dbg.e(t)}}),1),this.watcher.w.initialize({showOnPageChange:!1,showOnSiteExit:!0,checkThreshold:3,watchInterval:1e3,width:this.width,height:this.height,parentTop:t.top,parentLeft:t.left,domain:QSI.CookieDomain?QSI.CookieDomain:null}),this.watcher.w.url=this.url,this.watcher.w.startWatching()}}}))},function(t,e){QSI.popunderWatcher=function(){this.initialize=function(t){var e=document.body.getElementsByTagName("img");for(var i in this.imgCount=e.length,this.imagesLoaded=0,this.options={},t)Object.prototype.hasOwnProperty.call(t,i)&&(this.options[i]=t[i]);this.id=this.options.id,this.name="QSIPopUnder_"+this.id,this.popForwardDelayInMS=5e3;var n=this;setInterval((function(){window.opener.postMessage("QSI_popunderwatcher_addWindowHandler|"+n.id+"|"+window.name,"*")}),40);var o=window.onbeforeunload=o,window.onunload=o;window.addEventListener("message",(function(t){try{n.popUnderWindowReceiveMessage(t)}catch(t){"undefined"!=typeof QSI&&QSI.dbg&&QSI.dbg.e&&QSI.dbg.e(t)}}),!1),this.options.resetCSS&&this.addCSSReset(),this.initializeImages(),this.onWindowFocus(t),this.initializeTargetLinks()},this.popUnderWindowReceiveMessage=function(t){if(void 0!==t&&void 0!==t.data&&void 0!==t.origin&&t.origin===QSI.parentOrigin){var e;try{e=JSON.parse(t.data)}catch(t){return}if("object"==typeof e&&"string"==typeof e.payload&&"setTargetUrlInPlaceholderWindow"==e.type){var i=e.payload;this.options.targetURL=i}}},this.eraseNameInOpenerSessionStorage=function(){try{if(!window.opener||!window.opener.sessionStorage)return}catch(t){return}var t=window.opener.sessionStorage,e=t.getItem("QSI_OptInIDsAndWindowNames");if(e){try{e=JSON.parse(e)}catch(t){return}for(var i in e)e[i]===window.name&&delete e[i];t.setItem("QSI_OptInIDsAndWindowNames",JSON.stringify(e))}},this.onWindowFocus=function(t){var e=this,i="onfocusin"in document?setTimeout((function(){try{document.onfocusin=i}catch(t){"undefined"!=typeof QSI&&QSI.dbg&&QSI.dbg.e&&QSI.dbg.e(t)}}),1):"Firefox"===t.browser?window.onfocus=i:window.onblur=,this.initializeTargetLinks=function(t){for(var e=(t=t||document).getElementsByTagName("div"),i=this,n=function(){try{i.openTarget(i.options.targetURL)}catch(t){"undefined"!=typeof QSI&&QSI.dbg&&QSI.dbg.e&&QSI.dbg.e(t)}},o=0,r=e.length;o<r;o++){var s=e[o];"target"===s.getAttribute("data-type")&&this.observe(s,"click",n)}},this.observe=function(t,e,i){if(t)if(t.addEventListener)t.addEventListener(e,i,!1);else if(t.attachEvent)t.attachEvent("on"+e,i);else if(t["on"+this.capFirst(e)]){if(t["on"+this.capFirst(e)]){var n=t["on"+this.capFirst(e)],o=i;i=t["on"+this.capFirst(e)]=i}},this.load=function(){this.loaded||(this.loaded=!0,this.initializeIframes(),this.impress(this.options.impressionURL))},this.capFirst=this.initializeIframes=function(t){for(var e=(t=t||document).getElementsByTagName("iframe"),i=0,n=e.length;i<n;i++){var o=e[i],r=o.getAttribute("data-src");r&&(o.src=r)}},this.initializeImages=function(t){for(var e=this,i=(t=t||document).getElementsByTagName("img"),n=o=0,r=i.length;o<r;o++){var s=i[o],a=s.getAttribute("data-src");s.onload=n,a&&(s.src=a)}},this.unload=function(){try{this.unloaded||(this.cookie.erase(this.name,this.options.domain),this.markDisplayed(),this.unloaded=!0)}catch(t){QSI.dbg.e(t)}return!0},this.markDisplayed=function(){0!=this.options.noshow&&this.cookie.set(this.id+"_intercept",!0,this.options.noshow,this.options.cookieDomain)},this.watch=function(){var t=this;this.lastLoc=window.opener.location.href,this.ival=setInterval((,this.options.watchInterval)},this.addCSSReset=function(t){try{var e=(t=t||document).getElementsByTagName("head")[0],i=t.createElement("style");e&&e.appendChild&&(i.type="text/css",i.styleSheet?i.styleSheet.cssText=this.options.resetCSS:i.appendChild(t.createTextNode(this.options.resetCSS)),e.appendChild(i))}catch(t){}},this.intervalWatch=function(){try{if(this.popunderDead)return void this.killPopunder()}catch(t){}var t=null;try{t=""+window.opener.location.href}catch(e){t=null}t?(this.lastLoc!==t&&this.onSiteChange(),this.lastLoc=t):this.onSiteExit()},this.clearWatcher=this.destroyPopunder=function(){try{this.clearWatcher(),this.cookie.erase(this.name,this.options.domain),window.opener=window.self,window.close()}catch(t){}},this.showPopunder=function(t){var e=this;this.clearWatcher();try{if(this.options.onPopForwardShowTarget&&this.options.targetURL){var i=!1;setTimeout((function(){try{i||(e.redirectToURL(e.options.targetURL),i=!0)}catch(t){"undefined"!=typeof QSI&&QSI.dbg&&QSI.dbg.e&&QSI.dbg.e(t)}}),t),e.observe(window,"focus",(function(){try{i||(i=!0,e.redirectToURL(e.options.targetURL))}catch(t){"undefined"!=typeof QSI&&QSI.dbg&&QSI.dbg.e&&QSI.dbg.e(t)}})),!i&&document.hasFocus()&&(i=!0,e.redirectToURL(e.options.targetURL))}else window.focus()}catch(t){}this.cookie.erase(this.name,this.options.domain)},this.redirectToURL=function(t){this.offsetWindowFromTopLeftCorner(100,100),document.hasFocus()||window.focus(),this.redirectTo(t),this.resizeToFitInterceptTarget()},this.offsetWindowFromTopLeftCorner=this.redirectTo=this.resizeToFitInterceptTarget=function(){if(this.options.targetFullScreen){var t=this.getWindowSize(),e=screen.width||t[0],i=screen.height||t[1];window.resizeTo(e,i),window.moveTo(0,0)}else this.options.targetWidth&&this.options.targetHeight&&window.resizeTo(parseInt(this.options.targetWidth,10),parseInt(this.options.targetHeight,10))},this.killPopunder=this.startWatching=this.onSiteChange=function(){this.popunderDead?this.killPopunder():this.options.showOnPageChange&&this.showPopunder(this.popForwardDelayInMS)},this.onSiteExit=function(){this.popunderDead?this.killPopunder():this.options.showOnSiteExit&&this.showPopunder(this.popForwardDelayInMS)},this.getWindowSize=function(){var t=0,e=0;return void 0!==window.innerWidth?(t=window.innerWidth,e=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(t=document.documentElement.clientWidth,e=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(t=document.body.clientWidth,e=document.body.clientHeight),[t,e]},this.cookie={set:function(t,e,i,n){var o="";if(i){var r=new Date;r.setTime(r.getTime()+864e5*i),o="; expires="+r.toGMTString()}var s="";n&&(s="domain="+n),document.cookie=t+"="+e+o+"; path=/; "+s},get:erase:,this.openTarget=function(t){try{this.markDisplayed();var e=this.getWindowSize(),i=this.options.targetFullScreen?screen.availWidth||screen.width||e[0]:this.options.targetWidth,n=this.options.targetFullScreen?screen.availHeight||screen.height||e[1]:this.options.targetHeight;window.open(t,"targetwindow","location=1,status=1,scrollbars=1,resizable=yes,width="+i+",height="+n).resizeTo(i,n)}catch(t){}this.destroyPopunder()},this.impress=function(t){if(t){var e=document.createElement("img");e.style.display="none",e.src=t,e.alt="",document.body.appendChild(e)}}}}]);}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}