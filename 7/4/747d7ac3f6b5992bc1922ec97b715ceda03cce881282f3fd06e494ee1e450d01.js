(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[737],{52979:(e,t,r)=>{"use strict";r.r(t),r.d(t,{CartView:()=>fn,default:);var n=r(45418),l=r.n(n),a=r(37922),o=r(74758),c=r(32396),i=r(84244),s=r(78317),d=r(84741),u=r(16618),m=r(79705),v=r(51415),p=r(79289);const f=({children:e})=>{const[t,r]=(0,n.useReducer)(v.tQ,{voucherWarnings:[],checkoutError:void 0}),a=(0,n.useMemo)((()=>({cartState:t,dispatch:r})),[t,r]);return l().createElement(p.A.Provider,{value:a},e)};var E=r(85449),g=r(50203),y=r(28901),b=r(71630),h=r(37817),O=r(9177),C=r(5094),x=r(29498),N=r(72668);const I={viewBox:"0 0 45 52",data:l().createElement("g",{fill:"none",fillRule:"evenodd"},l().createElement("path",{d:"M4.058 0C1.094 0 0 1.098 0 4.075v35.922c0 .338.013.65.043.94.068.65-.043 1.934 2.285 2.96 1.553.683 7.62 3.208 18.203 7.573 1.024.428 1.313.529 2.081.529.685.013 1.137-.099 2.072-.53 10.59-4.227 16.66-6.752 18.213-7.573 2.327-1.23 2.097-3.561 2.097-3.899V4.075C44.994 1.098 44.13 0 41.166 0H4.058z",fill:"currentColor"}),l().createElement("path",{stroke:"#FFF",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",d:"M14 18l4.91 2.545-2.455 4M25.544 28.705c-1.056-.131-1.806-.14-2.25-.025-.444.115-1.209.514-2.294 1.197M29.09 21.727L25 19.5l2.045-3.5"}))};var P=r(75364),S=r(17654);const w={container:(0,y.iv)({display:"flex",flexDirection:"column",alignItems:"center"}),icon:(0,y.iv)({marginBottom:30}),title:(0,y.iv)({marginBottom:12})},D={icon:(0,y.iv)({color:x.JD})},Z=(({renderIcon:e})=>({renderTitle:t,renderBody:r})=>l().createElement("div",{className:w.container},e&&l().createElement("div",{className:w.icon,"data-testid":"icon"},e),l().createElement("div",{className:w.title,"data-testid":"title"},l().createElement(P.Z.Text,null,t)),r&&l().createElement("div",{"data-testid":"body"},l().createElement(S.ZP,null,r))))({renderIcon:l().createElement(N.Z,{icon:I,className:D.icon,size:C.J7.XLARGE})}),k=()=>{const e=(e=>({link:(0,y.iv)({borderBottom:`1px solid ${e.accentOverlay}`,color:e.textSecondary,"&:hover":{color:e.textPrimary,borderColor:e.textPrimary}})}))((0,b.y)());return l().createElement(h.Z,{to:"/",className:e.link},l().createElement(O.Z,{code:"egstore.wishlist.empty_results.shop_discover"}))},R=()=>l().createElement(Z,{renderTitle:l().createElement(O.Z,{code:"egstore.cart.empty_cart_title"}),renderBody:l().createElement(k,null)});var L=r(36475),_=r(90274),A=r(75106);const T={cardMargin:(0,y.iv)({marginBottom:15,"&:last-of-type":{marginBottom:0}})},j=()=>l().createElement(l().Fragment,null,l().createElement(_.Z,null),l().createElement(_.Z,null),l().createElement(_.Z,null)),B=()=>{const{cartItems:e}=(0,L.N)();return l().createElement(l().Fragment,null,null==e?void 0:e.map((e=>l().createElement("div",{className:T.cardMargin,key:e.id},l().createElement(A.PP,{offerId:e.offerId,sandboxId:e.namespace,cartItemId:e.id,productId:e.catalogNs.parent,store:e.catalogNs.store})))))},M=()=>l().createElement(E.n4,{fallback:l().createElement(j,null)},l().createElement(B,null));var W=r(45440),U=r(97932),q=r(18711),H=r(6958),G=r(60401),$=r(99325),K=r(85858),z=r(13405),F=r(7464),V=r(7301),Y=r(21650),X=r(31265),J=r(34272);const Q=({children:e,renderLabel:t})=>{const r=(e=>({container:(0,y.iv)((0,J.yd)("left"),{width:"100%",borderColor:e.backgroundOverlay,borderWidth:1,borderStyle:"solid",padding:20,borderRadius:Y.VY}),label:(0,y.iv)({marginBottom:10}),list:(0,y.iv)({padding:0,margin:0,listStyle:"none",display:"flex",flexDirection:"column",gap:10})}))((0,V.Z)());return l().createElement("div",{className:r.container},t&&l().createElement("div",{className:r.label},l().createElement(X.Z,{textLevel:K.N.SECONDARY},t)),l().createElement("ul",{className:r.list},e))},ee={modalContent:(0,y.iv)({height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",textAlign:"center",[z.Uc.sm]:(0,y.iv)({maxWidth:360})}),list:(0,y.iv)({marginTop:10,marginBottom:10}),buttons:(0,y.iv)({width:"100%",display:"flex",marginTop:60,flexDirection:"column",gap:10,[z.Uc.sm]:(0,y.iv)({marginTop:40,flexDirection:"row",gap:20})})},te=({titles:e})=>({next:t,cancel:r})=>({Step:l().createElement("div",{className:ee.modalContent},l().createElement(P.Z.Heading,{headingLevel:2},l().createElement(O.Z,{code:"egstore.cart.checkout.partial_entitlement.title"})),l().createElement("div",{className:ee.list},l().createElement(S.ZP,{textLevel:K.N.SECONDARY},l().createElement(Q,{renderLabel:l().createElement(O.Z,{code:"egstore.common.product"})},null==e?void 0:e.map((e=>l().createElement("li",{key:e},e)))))),l().createElement(S.ZP,{textLevel:K.N.SECONDARY},l().createElement(O.Z,{code:"egstore.cart.checkout.partial_entitlement.detail"})),l().createElement("div",{className:ee.buttons},l().createElement(G.K,{onClick:t,buttonWidth:F.WL.BLOCK},l().createElement(O.Z,{code:"egstore.cart.checkout.cta.continue_checkout"})),l().createElement(H.gg,{onClick:r,buttonWidth:F.WL.BLOCK},l().createElement(O.Z,{code:"egstore.cart.checkout.cta.review_purchase"})))),modalVariant:$.v.DIALOG});var re=r(29327),ne=r(50535),le=r(36449);const ae=()=>{var e,t,r,a;const{cartValidation:o}=(0,U.H)(),{actions:c,state:i}=(0,le.A)(),s="entitlement"===i,d=[...null!=(e=null==o?void 0:o.possiblePartialUpgradeOffers)?e:[],...null!=(t=null==o?void 0:o.unablePartiallyUpgradeOffers)?t:[]],u=(0,re.t)(d),m=(0,q.f)({offers:u}),v=(0,n.useMemo)((()=>(null==m?void 0:m.reduce(((e,t)=>(null==t?void 0:t.title)?[...e,t.title]:e),[]))||[]),[m]);return(0,n.useEffect)((()=>{var e;(s&&0===d.length||s&&0===v.length)&&(null==(e=null==c?void 0:c.entitlement)||e.next())}),[d,v,i]),l().createElement(ne.Z,{isOpen:s&&v.length>0,onClose:null==(r=null==c?void 0:c.entitlement)?void 0:r.cancel,onComplete:null==(a=null==c?void 0:c.entitlement)?void 0:a.next,steps:[te({titles:v})]})};var oe=r(22538),ce=r(71535),ie=r(17054),se=r(83962),de=r(96366),ue=r(61141),me=r(59507),ve=r(6275);var pe=r(6665),fe=r(12757),Ee=r(89598),ge=Object.getOwnPropertySymbols,ye=Object.prototype.hasOwnProperty,be=Object.prototype.propertyIsEnumerable;const he=e=>{const t=(0,oe.useHistory)(),r=(0,a.useSelector)(ie.Gb),{dispatch:l}=(0,se.i)(),o=(0,a.useDispatch)(),{query:{invalidate:i}}=(0,Ee.e)({config:{enabled:!1}}),s=(0,a.useSelector)(ie.zd),{query:{invalidate:d}}=(0,me.Y)({enabled:!1}),u=(0,ue.n)(),{invalidateAllUserProductPurchasability:m}=(()=>{const e=(0,ce.NL)();return{invalidateAllUserProductPurchasability:()=>e.invalidateQueries({queryKey:[ve.c]})}})(),v=(0,n.useCallback)((,[e]),p=(0,ce.Db)(v,{onError:onSuccess:e=>{i(),"platform"===u&&m();const n=(e=>null==e?void 0:e.map((e=>({offerId:(null==e?void 0:e.OfferId)||(null==e?void 0:e.offerid),sandboxId:(null==e?void 0:e.OfferNamespace)||(null==e?void 0:e.offernamespace)}))))((null==e?void 0:e.Offers)||(null==e?void 0:e.offers)),l=(null==e?void 0:e.formattedEarnedEpicRewards)||(null==e?void 0:e.formattedearnedepicrewards);null==n||n.forEach((t=>{o(pe.ZP.purchaseSuccess(t.sandboxId,t.offerId,e,s))})),t.push({pathname:(0,c.generateRoutePath)(r?"/thank-you":"/cart/success"),state:{transactionId:(null==e?void 0:e.TransactionId)||(null==e?void 0:e.transactionid),offers:n,earnedEpicRewards:l}})},onSettled:),{mutate:f}=p,E=((e,t)=>{var r={};for(var n in e)ye.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&ge)for(var n of ge(e))t.indexOf(n)<0&&be.call(e,n)&&(r[n]=e[n]);return r})(p,["mutate"]);return(0,n.useMemo)((,[f,E])},Oe=()=>{const{actions:e,state:t}=(0,le.A)(),{cartItems:r}=(0,L.N)(),l=(e=>{if(e)return e.length>0?null==e?void 0:e.map((e=>({offerNamespace:e.namespace,offerId:e.offerId,quantity:e.quantity}))):[]})(r)||[],{startCheckout:a}=he(l);return(0,n.useEffect)((()=>{var r;"checkout"===t&&(null==(r=null==e?void 0:e.checkout)||r.next(),a())}),[t,e]),null},Ce=()=>l().createElement(E.n4,{fallback:null},l().createElement(W.Z,null),l().createElement(ae,null),l().createElement(Oe,null));var xe=r(86376),Ne=r(14058),Ie=r(50694),Pe=Object.defineProperty,Se=Object.defineProperties,we=Object.getOwnPropertyDescriptors,De=Object.getOwnPropertySymbols,Ze=Object.prototype.hasOwnProperty,ke=Object.prototype.propertyIsEnumerable,Re=(e,t,r)=>t in e?Pe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Le=(e,t)=>{for(var r in t||(t={}))Ze.call(t,r)&&Re(e,r,t[r]);if(De)for(var r of De(t))ke.call(t,r)&&Re(e,r,t[r]);return e},_e=const Ae={container:(0,y.iv)({display:"flex",flexDirection:"row",flexWrap:"wrap",[z.Uc.md]:{flexWrap:"nowrap"}}),mainContent:(0,y.iv)({flexGrow:1,marginBottom:30,[z.Uc.md]:{marginBottom:0}}),sidebar:(0,y.iv)({width:"100%",flexShrink:0,[z.Uc.md]:_e(Le({},(0,J.oI)(32)),{width:256}),[z.Uc.lg]:_e(Le({},(0,J.oI)(36)),{width:296})})},Te=({renderMain:e,renderSidebar:t})=>l().createElement("div",{className:Ae.container},l().createElement("div",{className:Ae.mainContent,"data-testid":"cart-layout-main"},e),t&&l().createElement("div",{className:Ae.sidebar,"data-testid":"cart-layout-sidebar"},t)),je={container:(0,y.iv)({marginTop:15,[z.Uc.md]:{marginTop:0}}),warnings:(0,y.iv)({width:"100%",marginBottom:50,":empty":{display:"none"}}),title:(0,y.iv)({marginBottom:50,display:"flex",flexDirection:"column-reverse",justifyContent:"space-between",[z.Uc.md]:{alignItems:"center",flexDirection:"row"}})},Be=({renderMain:e,renderSidebar:t,renderWarnings:r,renderWallet:n})=>()=>l().createElement(xe.Z,null,l().createElement(Ne.Z,{className:je.container},r&&l().createElement("div",{className:je.warnings,"data-testid":"cart-warnings"},r),l().createElement("div",{className:je.title},l().createElement(Ie.Z.Heading,{headingLevel:1},l().createElement(O.Z,{code:"egstore.cart.my_cart"})),n&&n),l().createElement(Te,{renderMain:e,renderSidebar:t})));var Me=r(57247),We=r(47867),Ue=r(24438);const qe=r.n(Ue)()`
    query getBulkOffersSubtotal($lineOffers: [NsOffersLineOfferReq]!, $country: String!, $merchantGroup: String = "EGS_MKT", $voucherCode: String = null) {
  PriceEngine {
    bulkNsOffersPrice(
      country: $country
      calculateTax: false
      merchantGroup: $merchantGroup
      lineOffers: $lineOffers
      voucherCode: $voucherCode
    ) {
      country
      totalPrice {
        currencyCode
        originalPrice
        discountPrice
        discount
        discountPercentage
        voucherDiscount
        voucherDiscountPercentage
        currencyInfo {
          decimals
        }
      }
      lineOffers {
        offerId
        namespace
        price {
          discountPrice
          voucherDiscount
        }
        voucherNotApplyReason
      }
      voucherNotApplyReason
    }
  }
}
    `;var He=Object.defineProperty,Ge=Object.defineProperties,$e=Object.getOwnPropertyDescriptors,Ke=Object.getOwnPropertySymbols,ze=Object.prototype.hasOwnProperty,Fe=Object.prototype.propertyIsEnumerable,Ve=(e,t,r)=>t in e?He(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Ye=(e,t)=>{for(var r in t||(t={}))ze.call(t,r)&&Ve(e,r,t[r]);if(Ke)for(var r of Ke(t))Fe.call(t,r)&&Ve(e,r,t[r]);return e};const Xe=e=>{var t;return(null==(t=null==e?void 0:e.PriceEngine)?void 0:t.bulkNsOffersPrice)||void 0},Je=({queryName:e,queryId:t},r)=>{const n=(null==r?void 0:r.lineOffers)||[];return[e,null==r?void 0:r.country,...n,null==r?void 0:r.voucherCode,t]},Qe=({lineOffers:e,voucherCode:t},r)=>{var n;const l=(0,a.useSelector)(s.vR),o=(0,a.useSelector)(s.eV),c=Boolean(null==e?void 0:e.length)&&Boolean(l)&&(null==(n=null==r?void 0:r.enabled)||n),i=(0,We.qM)({query:qe,variables:{country:o,lineOffers:e,voucherCode:t},reducer:Xe,config:(u=Ye({},r),m={enabled:c},Ge(u,$e(m))),queryKeyFn:Je}),{data:d}=i;var u,m;return{bulkOffersPrice:d,query:((e,t)=>{var r={};for(var n in e)ze.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&Ke)for(var n of Ke(e))t.indexOf(n)<0&&Fe.call(e,n)&&(r[n]=e[n]);return r})(i,["data"])}};var et=Object.getOwnPropertySymbols,tt=Object.prototype.hasOwnProperty,rt=Object.prototype.propertyIsEnumerable;const nt=({voucherCode:e}={})=>{const{cartItems:t}=(0,L.N)(),r=(0,n.useMemo)((()=>(e=>{if(e)return e.length>0?null==e?void 0:e.map(():[]})(t)),[t]),l=Qe({lineOffers:r||[],voucherCode:e}),{bulkOffersPrice:a}=l;return{cartSubtotal:a,query:((e,t)=>{var r={};for(var n in e)tt.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&et)for(var n of et(e))t.indexOf(n)<0&&rt.call(e,n)&&(r[n]=e[n]);return r})(l,["bulkOffersPrice"])}};var lt=r(84530),at=r(13986),ot=r(53288),ct=r(50560);const it=({renderCouponDiscount:e,renderCTA:t,renderPrice:r,renderSaleDiscount:n,renderSubtotal:o,renderTaxes:c})=>{const i=(0,a.useSelector)(ct.e),s=((e,t)=>({wrapper:(0,y.iv)({display:"flex",flexDirection:"column"}),title:(0,y.iv)({marginBottom:20,[z.Uc.mdOnly]:{marginBottom:16}}),lineItem:(0,y.iv)({marginTop:15,":empty":{display:"none"}}),subtotal:(0,y.iv)({marginTop:20,borderTop:`1px solid ${t?e.borderSubtle:e.accentOverlay}`,paddingTop:20}),cta:(0,y.iv)({marginTop:20,[z.Uc.mdOnly]:{marginTop:40}})}))((0,V.Z)(),i);return l().createElement("div",{className:s.wrapper},l().createElement("div",{className:s.title},l().createElement(P.Z.Text,null,l().createElement(O.Z,{code:"egstore.cart.summary.title_games"}))),r&&l().createElement("div",{className:s.lineItem,"data-testid":"cart-summary-price"},r),n&&l().createElement("div",{className:s.lineItem,"data-testid":"cart-summary-sale"},n),e&&l().createElement("div",{className:s.lineItem,"data-testid":"cart-summary-coupon"},e),c&&l().createElement("div",{className:s.lineItem,"data-testid":"cart-summary-taxes"},c),l().createElement("div",{className:s.subtotal,"data-testid":"cart-summary-subtotal"},o),t&&l().createElement("div",{className:s.cta,"data-testid":"cart-summary-cta"},t))},st={wrapper:(0,y.iv)({display:"flex",justifyContent:"space-between"}),title:(0,y.iv)((0,J.wz)(20))},dt=({renderTitle:e,renderValue:t})=>l().createElement("div",{className:st.wrapper},l().createElement("div",{className:st.title},e),t),ut=({code:e,textLevel:t,textWeight:r=S.G0.NORMAL})=>l().createElement(S.ZP,{weight:r,textLevel:t},l().createElement(i.v0,{code:e})),mt=()=>l().createElement(dt,{renderTitle:l().createElement(ut,{code:"egstore.cart.summary.subtotal",textWeight:S.G0.BOLD}),renderValue:l().createElement(ut,{textLevel:K.N.SECONDARY,code:"egstore.cart.summary.taxes_calculation"})});var vt=r(6223),pt=r(99219);const ft=(e,t,r)=>{if(!(0,Me.Z)(e)&&!(0,Me.Z)(t)&&r)return(0,vt.xG)((0,pt.z9)({price:e,decimals:t}),r,{maximumFractionDigits:t,minimumFractionDigits:t})};var Et=r(2139);const gt=({component:e=S.ZP})=>({currencyCode:t,decimals:r,price:a})=>{const o=(0,n.useMemo)((,[a,t,r]);return l().createElement(e,null,o)},yt=gt({component:S.ZP}),bt=gt({component:({children:e})=>l().createElement(S.ZP,{weight:S.G0.BOLD},e)}),ht=gt({component:({children:e})=>l().createElement(Et.Z,{textLevel:K.N.PRIMARY},e)}),Ot=({labelComponent:e,priceComponent:t})=>({currencyCode:r,decimals:n,messageCode:a,price:o})=>l().createElement(dt,{renderTitle:l().createElement(e,{code:a}),renderValue:l().createElement(t,{currencyCode:r,decimals:n,price:o})}),Ct=Ot({labelComponent:ut,priceComponent:yt}),xt=Ot({labelComponent:({code:e,textLevel:t})=>l().createElement(ut,{code:e,textLevel:t,textWeight:S.G0.BOLD}),priceComponent:bt});var Nt=r(92954),It=r(46741);const Pt={container:(0,y.iv)({display:"flex",flexDirection:"row",alignItems:"center"}),checkmark:(0,y.iv)({color:Nt.$w,marginLeft:8,marginRight:8,width:9,height:9,flexShrink:0,flexGrow:0,[z.Uc.md]:{marginLeft:7,marginRight:7,width:7,height:7},[z.Uc.xxl]:{width:11,height:11}})},St=()=>l().createElement(N.Z,{icon:C.kf.CHECK_MARK_THICK,className:Pt.checkmark,size:It.Z.CUSTOM}),wt=({couponName:e,isCouponActive:t})=>l().createElement("div",{className:Pt.container},t&&l().createElement(St,null),l().createElement(X.Z,null,e));var Dt=r(10035),Zt=r(97482),kt=r(58532);const Rt={listItem:(0,y.iv)({marginBottom:5,display:"flex",flexDirection:"row",flexWrap:"nowrap",justifyContent:"space-between"}),listPrice:(0,y.iv)((0,J.oI)(5),{flexShrink:0})},Lt=({currencyCode:e,decimals:t,price:r,title:n})=>l().createElement("li",null,l().createElement(Et.Z,{textLevel:K.N.PRIMARY},l().createElement("div",{className:Rt.listItem},l().createElement(kt.Z,{text:n,lines:1}),l().createElement("div",{className:Rt.listPrice},l().createElement(ht,{currencyCode:e,decimals:t,price:-r}))))),_t=({currencyCode:e,decimals:t,offerId:r,price:n,sandboxId:a})=>{const{title:o}=(0,Zt.Z)({offerId:r,sandboxId:a});return o&&e&&n&&!(0,Me.Z)(t)?l().createElement(Lt,{title:o,decimals:t,currencyCode:e,price:n}):null},At={detailsList:(0,y.iv)({listStyleType:"none",padding:0,margin:0})},Tt=({children:e})=>{const t=(0,Dt.useLocalization)()("egstore.coupons.use.aria.discount_list_description");return l().createElement("ul",{className:At.detailsList,"aria-label":t},e)},jt=({couponCode:e})=>{var t,r,n,a,o;const{cartSubtotal:c}=nt({voucherCode:e}),i=null!=(r=null==(t=null==c?void 0:c.totalPrice)?void 0:t.currencyCode)?r:void 0,s=null!=(o=null==(a=null==(n=null==c?void 0:c.totalPrice)?void 0:n.currencyInfo)?void 0:a.decimals)?o:void 0,d=(e=>{const t=(null==e?void 0:e.lineOffers)||[];return null==t?void 0:t.reduce(((e,t)=>{var r;return(null==t?void 0:t.offerId)&&(null==t?void 0:t.namespace)&&(null==(r=null==t?void 0:t.price)?void 0:r.voucherDiscount)?[...e,t]:e}),[])})(c);return d.length&&i&&!(0,Me.Z)(s)?l().createElement(Tt,null,d.map((e=>l().createElement(_t,{key:e.offerId,currencyCode:i,decimals:s,offerId:e.offerId,price:e.price.voucherDiscount,sandboxId:e.namespace})))):null};var Bt=r(53946),Mt=Object.defineProperty,Wt=Object.defineProperties,Ut=Object.getOwnPropertyDescriptors,qt=Object.getOwnPropertySymbols,Ht=Object.prototype.hasOwnProperty,Gt=Object.prototype.propertyIsEnumerable,$t=(e,t,r)=>t in e?Mt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Kt=(e,t)=>{for(var r in t||(t={}))Ht.call(t,r)&&$t(e,r,t[r]);if(qt)for(var r of qt(t))Gt.call(t,r)&&$t(e,r,t[r]);return e};const zt=e=>{var t;return(null==(t=null==e?void 0:e.PriceEngine)?void 0:t.salesEvent)||void 0},Ft=({salesEventId:e,config:t})=>{var r;const n=(0,Dt.useLocalizationLocale)(),l=Boolean(e)&&(null==(r=null==t?void 0:t.enabled)||r),a=(0,We.qM)({query:Bt.d,variables:{salesEventId:e,locale:n},config:(c=Kt({},t),i={enabled:l},Wt(c,Ut(i))),reducer:zt}),{data:o}=a;var c,i;return{salesEvent:o,query:((e,t)=>{var r={};for(var n in e)Ht.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&qt)for(var n of qt(e))t.indexOf(n)<0&&Gt.call(e,n)&&(r[n]=e[n]);return r})(a,["data"])}};var Vt=r(96049),Yt=r(44630);const Xt=({to:e,children:t})=>{const r=(e=>({link:(0,y.iv)({color:e.textSecondary,textDecoration:"underline","&:active":{color:e.textPrimary,textDecoration:"underline"},"&:hover":{color:e.textPrimary,textDecoration:"none"}})}))((0,b.y)());return l().createElement(h.Z,{to:e,className:r.link},l().createElement(Et.Z,{textLevel:K.N.SECONDARY},t))},Jt=({discountString:e,isCouponActive:t,thresholdString:r,url:n})=>{const a=(0,Dt.useLocalization)(),o=a("egstore.coupons.use.discount_eligible_description",[e,r]),c=a("egstore.coupons.use.discount_ineligible_description",[e,r]),i=a("egstore.coupons.use.view_details");return l().createElement(Et.Z,{textLevel:K.N.SECONDARY},t?o:c," ",n&&l().createElement(Xt,{to:n},i))},Qt=({currencyCode:e,decimals:t,isCouponActive:r,salesEventId:n})=>{var a,o,c,i,s;const d=(0,Dt.useLocalizationLocale)(),{salesEvent:u}=Ft({salesEventId:n,config:{enabled:Boolean(n)}});if(!u)return null;const m=(0,Vt.eb)(u),v=null!=(o=null==(a=u.currencyRewards)?void 0:a.find((t=>{var r;return(null==(r=null==t?void 0:t.currency)?void 0:r.code)===e})))?o:void 0,p=null!=(c=null==v?void 0:v.minSalePrice)?c:void 0,f=ft(p,t,e);if(!p||!f)return null;if(u.voucherDiscountType===Yt.I.DISCOUNT_AMOUNT){const n=null!=(i=null==v?void 0:v.reward)?i:void 0,a=ft(n,t,e);return n&&a?l().createElement(Jt,{discountString:a,isCouponActive:r,thresholdString:f,url:m}):null}if(u.voucherDiscountType===Yt.I.DISCOUNT_PERCENTAGE){const e=null!=(s=null==v?void 0:v.discountPercentage)?s:void 0,t=e?(0,vt.rl)(100-e,{},d):void 0;return t?l().createElement(Jt,{discountString:t,isCouponActive:r,thresholdString:f,url:m}):null}return null},er=({renderHeader:e,renderDescription:t,renderList:r})=>{const n=(e=>({container:(0,y.iv)({backgroundColor:e.level1,padding:10,borderRadius:Y.E0}),list:(0,y.iv)({marginTop:15,":empty":{display:"none"}}),description:(0,y.iv)({marginTop:2})}))((0,b.y)());return l().createElement("div",{className:n.container},e,l().createElement("div",{className:n.description},t),l().createElement("div",{className:n.list},r))},tr=({couponCode:e})=>{var t,r,n,a,o,c,i,s,d,u;const{cartSubtotal:m}=nt({voucherCode:e}),{coupons:v}=(0,lt.N)(),p=null!=(t=null==v?void 0:v.find()))?t:void 0,f=null!=(n=null==(r=null==p?void 0:p.salesEvent)?void 0:r.id)?n:void 0,E=!(null==m?void 0:m.voucherNotApplyReason),g=null!=(o=null==(a=null==p?void 0:p.salesEvent)?void 0:a.voucherName)?o:"",y=null!=(i=null==(c=null==m?void 0:m.totalPrice)?void 0:c.currencyCode)?i:void 0,b=null!=(u=null==(d=null==(s=null==m?void 0:m.totalPrice)?void 0:s.currencyInfo)?void 0:d.decimals)?u:void 0,h=(0,at.SO)(wt,{couponName:g,isCouponActive:E}),O=(0,at.SO)(jt,{couponCode:e}),C=(0,at.R)(Qt,{currencyCode:y,decimals:b,isCouponActive:E,salesEventId:f},Boolean(f)&&Boolean(y)&&!(0,Me.Z)(b));return l().createElement(er,{renderHeader:null==h?void 0:h(),renderDescription:null==C?void 0:C(),renderList:null==O?void 0:O()})},rr={couponDetails:(0,y.iv)({marginTop:10})},nr=({renderLineItem:e,renderDetails:t})=>l().createElement("div",null,e,t&&l().createElement("div",{className:rr.couponDetails,"data-testid":"coupon-details"},t)),lr=({couponCode:e,currencyCode:t,decimals:r,price:n})=>{const o=(0,a.useSelector)(d.cI),c=(0,at.R)(Ct,{currencyCode:t,decimals:r,messageCode:"egstore.cart.summary.coupon_discount",price:-n},n>0||o),i=(0,at.R)(tr,{couponCode:e},o);return c?l().createElement(nr,{renderLineItem:c(),renderDetails:null==i?void 0:i()}):null},ar={taxesMsg:(0,y.iv)((0,J.yd)("right"))},or=()=>l().createElement("div",{className:ar.taxesMsg},l().createElement(ut,{textLevel:K.N.SECONDARY,code:"egstore.cart.summary.taxes_calculation"})),cr=()=>l().createElement(dt,{renderTitle:l().createElement(ut,{code:"egstore.cart.summary.taxes"}),renderValue:l().createElement(or,null)});var ir=r(8086);var sr=r(63187);const dr=()=>{const e=(0,a.useSelector)(s.eV),{cartItems:t}=(0,L.N)(),r=(({offers:e})=>{const{data:t}=(0,ir.mr)({fields:[ir.Hd.countriesBlacklist,ir.Hd.countriesWhitelist,ir.Hd.id,ir.Hd.namespace],offers:e});return t})({offers:t?(0,re.t)(t):[]});return(0,n.useMemo)((()=>null==r?void 0:r.reduce(((t,r)=>(0,sr.H)({countriesBlacklist:null==r?void 0:r.countriesBlacklist,countriesWhitelist:null==r?void 0:r.countriesWhitelist,country:e})?[...t,{offerId:null==r?void 0:r.id,namespace:null==r?void 0:r.namespace}]:t),[])),[r])},ur=()=>{const e=(0,oe.useHistory)(),{dispatch:t}=(0,se.i)(),{cartValidation:r}=(0,U.H)(),a=dr()||[],{actions:o,state:c}=(0,le.A)(),i=(0,n.useCallback)((()=>{var r;e.push({search:""}),"inactive"===c&&(null==(r=null==o?void 0:o.inactive)||r.start(),t({type:de.$.CLEAR_CHECKOUT_ERROR}))}),[t,c,o]),{conflictingOffers:s=[],fullyOwnedOffers:d=[],missingPrerequisites:u=[]}=r||{},m=s.length+d.length+u.length+a.length;return l().createElement(l().Fragment,null,l().createElement(H.gg,{buttonWidth:F.WL.BLOCK,disabled:m>0,onClick:i},l().createElement(O.Z,{code:"egstore.common.cta.check_out"})))},mr=({couponCode:e,couponDiscount:t,currencyCode:r,decimals:n,originalPrice:o,saleDiscount:c,subtotalPrice:i})=>{const s=(0,a.useSelector)(d.Zb),u=(0,at.SO)(Ct,{currencyCode:r,decimals:n,messageCode:"egstore.cart.summary.price",price:o}),m=(0,at.R)(Ct,{currencyCode:r,decimals:n,messageCode:"egstore.cart.summary.sale_discount",price:-c},c>0),v=(0,at.R)(lr,{currencyCode:r,decimals:n,price:t,couponCode:e},s&&Boolean(e)),p=(0,at.SO)(xt,{currencyCode:r,decimals:n,messageCode:"egstore.cart.summary.subtotal",price:i});return l().createElement(it,{renderCouponDiscount:v&&v(),renderCTA:l().createElement(ur,null),renderPrice:u&&u(),renderSaleDiscount:m&&m(),renderSubtotal:p&&p(),renderTaxes:l().createElement(cr,null)})},vr,pr=()=>l().createElement(it,{renderCTA:l().createElement(ot.Od,{height:50}),renderPrice:l().createElement(vr,null),renderSubtotal:l().createElement(vr,null),renderTaxes:l().createElement(vr,null)}),fr=()=>l().createElement(it,{renderSubtotal:l().createElement(mt,null),renderCTA:l().createElement(ur,null)}),Er=()=>{var e,t,r,o,c,i,s,u;const{dispatch:m}=(0,se.i)(),v=(0,a.useSelector)(d.Zb),{coupons:p}=(0,lt.N)({enabled:v,refetchOnMount:"always"}),f=(null==(e=null==p?void 0:p[0])?void 0:e.code)||void 0,{cartSubtotal:E}=nt({voucherCode:f}),g=null!=(t=null==E?void 0:E.totalPrice.currencyCode)?t:void 0,y=null!=(o=null==(r=null==E?void 0:E.totalPrice.currencyInfo)?void 0:r.decimals)?o:void 0,b=null!=(c=null==E?void 0:E.totalPrice.originalPrice)?c:void 0,h=null!=(i=null==E?void 0:E.totalPrice.discount)?i:0,O=null!=(s=null==E?void 0:E.totalPrice.voucherDiscount)?s:0,C=null!=(u=null==E?void 0:E.totalPrice.discountPrice)?u:void 0,x=v?null==E?void 0:E.lineOffers:void 0;return(0,n.useEffect)((()=>{v&&x&&m({type:de.$.SET_VOUCHER_WARNINGS,payload:{lineOffers:x}})}),[x,v]),(0,Me.Z)(b)||(0,Me.Z)(C)||!g||(0,Me.Z)(y)?l().createElement(fr,null):l().createElement(mr,{couponDiscount:O,couponCode:f,currencyCode:g,decimals:y,originalPrice:b,saleDiscount:h,subtotalPrice:C})},gr=()=>l().createElement(E.n4,{fallback:l().createElement(pr,null)},l().createElement(Er,null));var yr=r(77909),br=r(92561),hr=r(69457),Or=r(53445),Cr=r(55637),xr=r(80881),Nr=r(81549),Ir=Object.defineProperty,Pr=Object.defineProperties,Sr=Object.getOwnPropertyDescriptors,wr=Object.getOwnPropertySymbols,Dr=Object.prototype.hasOwnProperty,Zr=Object.prototype.propertyIsEnumerable,kr=(e,t,r)=>t in e?Ir(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Rr=(e,t)=>{for(var r in t||(t={}))Dr.call(t,r)&&kr(e,r,t[r]);if(wr)for(var r of wr(t))Zr.call(t,r)&&kr(e,r,t[r]);return e};const Lr=({onClick:e,className:t})=>l().createElement("div",{className:t},l().createElement(Cr.h,{onClick:e},l().createElement(N.Z,{icon:Nr.Z.CLOSE_THIN,size:It.$.XXXSMALL}))),_r=(({renderIcon:e})=>({children:t,onClose:r,renderCTA:n,type:a=Or.N.INFO})=>{const o=Boolean(e),c=((e,t,r)=>{const n=t===Or.N.ERROR?{color:Nt.yF,borderRadius:"100%"}:t===Or.N.WARNING?{color:Nt.Kr}:{},l=r?(0,J.oI)(50):{};return{container:(0,y.iv)({borderRadius:Y.E0,display:"flex",flexDirection:"column",padding:"20px 15px",background:e.level2,[z.Uc.sm]:{flexDirection:"row"}}),main:(0,y.iv)({display:"flex",flexDirection:"row",alignItems:"baseline",width:"100%"}),icon:(0,y.iv)((0,J.wz)(10),Rr({display:"flex",width:40,height:40,alignItems:"center",justifyContent:"center",flexGrow:0,flexShrink:0},n)),message:(0,y.iv)({flexGrow:1,alignSelf:"center"}),close:(0,y.iv)((0,J.oI)(10),{width:44,height:44,color:e.textPrimary,"&:hover":{color:e.textSecondary},"&:focus":{border:`1px solid ${e.accent}`,borderRadius:Y.E0}}),desktopCta:(0,y.iv)((0,J.oI)(15),{display:"none",[z.Uc.sm]:{display:"block"}}),mobileCta:(0,y.iv)((a=Rr({display:"block",width:"100%",marginTop:15},l),o={[z.Uc.sm]:{display:"none"}},Pr(a,Sr(o))))};var a,o})((0,b.y)(),a,o);return l().createElement("div",{className:c.container},l().createElement("div",{className:c.main},e&&l().createElement("div",{className:c.icon,"data-testid":"alert-icon"},e),l().createElement("div",{className:c.message},l().createElement(S.ZP,null,t)),n&&l().createElement("div",{className:c.desktopCta,"data-testid":"cta-desktop"},n),r&&l().createElement(Lr,{className:c.close,onClick:r,"data-testid":"alert-close"})),n&&l().createElement("div",{className:c.mobileCta,"data-testid":"cta-mobile"},n))})({renderIcon:l().createElement(N.Z,{icon:xr.E,size:It.$.XXSMALL})});var Ar=r(67764),Tr=r(12967),jr=r(7885),Br=r(84320),Mr=r(98902);const Wr=({to:e})=>l().createElement(Ar.Mm,{to:e,buttonHeight:F.Ey.DENSED},l().createElement(O.Z,{code:"egstore.common.cta.view_product"})),Ur=({sandboxId:e,offerId:t,missingPrerequisiteItems:r})=>{const a=(0,Dt.useLocalization)(),{productHomeLinkTo:o}=(0,Tr.f)({sandboxId:e}),{title:c}=(0,Zt.Z)({sandboxId:e,offerId:t}),i=(0,hr.k)({items:(0,jr.l7)(r)}),s=o?l().createElement(Wr,{to:o}):null,d=a("egstore.common.inline_list.separator"),u=a("egstore.cart.validation.page_level.error.missing_prereq",[c||"",(0,n.useMemo)(),[i,d])])||"";return l().createElement(_r,{type:Or.N.ERROR,renderCTA:s},l().createElement(Mr.T,{source:u}))};var qr=Object.getOwnPropertySymbols,Hr=Object.prototype.hasOwnProperty,Gr=Object.prototype.propertyIsEnumerable;const $r=e=>{var t=e,{code:r,type:n}=t,a=)(t,["code","type"]);const{title:o}=(0,Zt.Z)(a);return l().createElement(_r,{type:n},l().createElement(O.Z,{code:r,args:[o||""]}))};var Kr=Object.defineProperty,zr=Object.getOwnPropertySymbols,Fr=Object.prototype.hasOwnProperty,Vr=Object.prototype.propertyIsEnumerable,Yr,Xr;const Jr=()=>l().createElement(_r,{type:Or.N.ERROR},l().createElement(O.Z,{code:"egstore.cart.validation.page_level.error.general"})),Qr=()=>l().createElement(_r,{type:Or.N.WARNING},l().createElement(O.Z,{code:"egstore.cart.validation.page_level.warning.general"})),en=()=>l().createElement(_r,{type:Or.N.ERROR},l().createElement(O.Z,{code:"egstore.cart.validation.page_level.error.checkout"})),tn=e=>l().createElement($r,Xr({code:"egstore.cart.validation.page_level.error.in_library",type:Or.N.ERROR},e)),rn=e=>l().createElement($r,Xr({code:"egstore.cart.validation.page_level.info.partial_upgrade",type:Or.N.INFO},e)),nn=e=>l().createElement($r,Xr({code:"egstore.cart.validation.page_level.warning.no_partial_upgrade",type:Or.N.WARNING},e)),ln=()=>{const{cartState:{voucherWarnings:e,checkoutError:t}}=(0,se.i)(),{cartValidation:r}=(0,U.H)(),n=dr()||[];if(!r)return null;if(t)return l().createElement(en,null);const{conflictingOffers:a=[],fullyOwnedOffers:o=[],missingPrerequisites:c=[],possiblePartialUpgradeOffers:i=[],unablePartiallyUpgradeOffers:s=[]}=r,d=a.length+o.length+c.length+n.length,u=d+(i.length+s.length+e.length);if(0===u)return null;if(u>1)return d>0?l().createElement(Jr,null):l().createElement(Qr,null);if(c.length){const[e]=c,t=(null==e?void 0:e.missingPrerequisiteItems)?e.missingPrerequisiteItems.reduce(br.c,[]):[];return e?l().createElement(Ur,{offerId:e.offerId,sandboxId:e.namespace,missingPrerequisiteItems:t}):null}if(o.length){const[e]=o;return l().createElement(tn,{offerId:null==e?void 0:e.offerId,sandboxId:null==e?void 0:e.namespace})}if(n.length)return l().createElement(Jr,null);if(i.length){const[e]=i;return l().createElement(rn,{offerId:null==e?void 0:e.offerId,sandboxId:null==e?void 0:e.namespace})}if(s.length){const[e]=s;return l().createElement(nn,{offerId:null==e?void 0:e.offerId,sandboxId:null==e?void 0:e.namespace})}return e.length?l().createElement(Qr,null):null},an=()=>l().createElement(E.n4,{fallback:null},l().createElement(ln,null));var on=r(58786);const cn=Be({renderMain:l().createElement(M,null),renderSidebar:l().createElement(gr,null),renderWarnings:l().createElement(an,null),renderWallet:l().createElement(yr.pp,null)}),sn=Be({renderMain:l().createElement(R,null),renderSidebar:null,renderWarnings:null,renderWallet:l().createElement(yr.pp,null)}),dn=Be({renderMain:l().createElement(j,null),renderSidebar:l().createElement(pr,null),renderWarnings:null,renderWallet:l().createElement(yr.N0,null)}),un=()=>{const e=(0,g.s)(),{cartItems:t}=(0,L.N)({refetchOnMount:"always",refetchOnWindowFocus:!0,staleTime:3e4});return e?l().createElement(on.w,null):l().createElement(l().Fragment,null,l().createElement(Ce,null),(null==t?void 0:t.length)?l().createElement(cn,null):l().createElement(sn,null))},mn=()=>l().createElement(E.n4,{fallback:l().createElement(dn,null)},l().createElement(un,null)),vn=["inactive","eula","entitlement","checkout"],pn=()=>{const{setPurchaseStates:e}=(0,le.A)();return(0,n.useEffect)(),[]),null},fn=()=>{const e=(0,a.useSelector)(d.WG),t=(0,a.useSelector)(s.vR),r=Boolean(t),n=(0,i.ql)();return e?r?l().createElement(m.Z,null,l().createElement(o.q,{title:n("egstore.cart.cart")}),l().createElement(pn,null),l().createElement("div",{"data-testid":"cart-view"},l().createElement(f,null,l().createElement(mn,null)))):l().createElement(u.Z,{to:(0,c.getPath)()}):l().createElement(u.Z,{to:(0,c.generateRoutePath)("/not-found")})},En=fn}}]);
//# sourceMappingURL=CartView.egstore-site.735efa4201ab9bc25761.js.map