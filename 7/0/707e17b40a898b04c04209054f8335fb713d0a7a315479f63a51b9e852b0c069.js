(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[731],{"4KCX":function(e,t,n){"use strict";n.r(t),n.d(t,"SharepointNotificationService",(function(){return So}));var r=n("A3AF"),o=n("uAd/"),s=n("a9wj");function i(e){return null!=e}function a(e,t,n){return i(t)?Array.isArray(t)?x(t,n,((t,n)=>a(e,t,n))):function(e,t){return(t|=0)<e.Min?e.Min:t>e.Max?e.Max:t}(e,t):null}a.bind(null,{Min:-128,Max:127}),a.bind(null,{Min:0,Max:255}),a.bind(null,{Min:-32768,Max:32767}),a.bind(null,{Min:0,Max:65535});const c=a.bind(null,{Min:-2147483648,Max:2147483647}),u=a.bind(null,{Min:0,Max:4294967295});a.bind(null,{Min:Number.MIN_SAFE_INTEGER,Max:Number.MAX_SAFE_INTEGER}),a.bind(null,{Min:0,Max:Number.MAX_SAFE_INTEGER});const d=function(e,t){return i(e)?Array.isArray(e)?x(e,t,d):e:null},l=function(e,t){return i(e)?Array.isArray(e)?x(e,t,l):i(e)&&""!==e?e:null:null},p=function(e,t){return i(e)?Array.isArray(e)?x(e,t,p):l(e.toISOString(),t):null},f=new Date(0);class m{constructor(e){this.value=e}static createNew(){return new m("xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})))}toString(){return this.value}}m.Empty=new m("00000000-0000-0000-0000-000000000000");const h=function(e,t){return i(e)?Array.isArray(e)?x(e,t,h):e!==m.Empty?l(e.toString(),t):null:null},v=m.Empty;function C(e){return function(e){return null!==e&&["number","string","boolean","object"].indexOf(typeof e)>=0}(e)&&!Array.isArray(e)}function I(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)}function P(e){if(I(e)){const t={};for(const n in e)t[n]=P(e[n]);return t}if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;++n){let r=e[n];C(r)&&t.push(r)}return t}return e}const A=function(e,t){return i(e)?Array.isArray(e)?x(e,t,A):P(e):null},y=function(e,t){return i(e)?Array.isArray(e)?x(e,t,y):l(e.toString(),t):null};function g(e){const t=[];for(let n=0;n<e;++n)t.push(n);return t}function w(e,t){const n=[];for(let r=0;r<t;++r)n.push(e[r]);return n}function T(e,t,n,r){if(!i(e))return null;if(Array.isArray(e))return x(e,r,((e,r)=>T(e,t,n,r)));if(8&r)return u(e,r);const o=Math.min(t.length,n.length);for(let s=0;s<o;++s)if(t[s]===e)return l(n[s],r);return l(e.toString(),r)}function S(e,t,n,r){if(!i(e))return null;if(Array.isArray(e))return x(e,r,((e,r)=>S(e,t,n,r)));if(8&r)return u(e,r);const o=[],s=Math.min(t.length,n.length);for(let r=0;r<s;++r){const s=t[r];if(e&s&&(o.push(n[r]),(e&=~s)<1))break}return e>0&&o.push(e.toString()),l(o.length<1?"None":o.join(","),r)}function x(e,t,n){if(!i(e)||e.length<1)return null;const r=[];for(const o of e){const e=n(o,t);i(e)&&!Array.isArray(e)&&r.push(e)}return r}new class{constructor(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.Major=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,this.Minor=e,this.Build=t,this.Revision=n}toString(){let e=this.Major+"."+this.Minor;return(this.Build>0||this.Revision>0)&&(e+="."+this.Build,this.Revision>0&&(e+="."+this.Revision)),e}};const b=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return 16777215&t|(255&e)<<24|4},N=function(e){return(-16777216&e)>>24};class O{constructor(){this.artifacts=new Map,this.parent=O.current,O.current=this}static getOrCreateArtifact(e,t){for(let e=O.current;e;e=e.parent){const n=e.artifacts.get(t);if(n)return n}const n=e();return i(O.current)&&O.current.artifacts.set(t,n),n}exit(){O.current=this.parent}}O.current=null;const D=function(e,t){return i(e)?Array.isArray(e)?x(e,t,D):e.toJsonValue(t):null},R=function(e,t,n){return i(e)?Array.isArray(e)?x(e,t,((e,t)=>R(e,t,n))):(1&t||4&t||e.TypeName!=n||(t|=1),e.toJsonValue(t)):null};function E(e,t,n,r){if(i(n))for(const t of n){let n=e[t];I(n)||(e[t]=n={}),e=n}i(r)&&(e[t]=r)}class M{update(e){}toJsonValue(e){const t=function(e,t){return 1&t||4&t?{}:2&t?{__metadata:{type:e}}:{__type:e}}(this.TypeName,e);return this.pjo(t,e,this.w2jo,this.w2fjo),t}toFacetJsonValue(e){return this.toJsonValue(b(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0))}toJson(){return JSON.stringify(this.toJsonValue(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0))}toFacetJson(e){return this.toJson(b(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0))}w2jo(e,t){}w2fjo(e,t){}pjo(e,t,n,r){!function(e,t){try{t()}finally{e.exit()}}(new O,(()=>{4&t?r.call(this,e,t):n.call(this,e,t)}))}}class j extends M{constructor(){super(...arguments),this.TypeClassification=2}}class k{static getOrCreate(){return O.getOrCreateArtifact(k.create,k.artifactId)}static getPersonIndex(e){return i(e)?k.findPerson(e):null}static addPerson(e){if(i(e)){let o=k.findAndUpdatePerson(e);i(o)||(o=new F,k.updatePerson(o,e),k.getOrCreate().push(o));for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(const e of n)i(o.Roles)?o.Roles.indexOf(e)<0&&o.Roles.push(e):o.Roles=[e]}}static addPeople(e){if(i(e)){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(const t of e)k.addPerson(t,...n)}}static create(){return[]}static findAndUpdatePerson(e){const t=k.findPerson(e);if(t>=0){const n=k.getOrCreate()[t];return k.updatePerson(n,e),n}return null}static findPerson(e){const t=k.getOrCreate();for(var n=0;n<t.length;++n){const r=t[n];if(i(r.Provider)&&""!==r.Provider){if(r.Provider===e.Provider&&r.Id===e.Id)return n;if(i(e.Provider)&&""!==e.Provider)continue}if(i(r.Email)&&""!==r.Email){if(r.Email===e.Email)return n;if(i(e.Email)&&""!==e.Email)continue}if(i(r.Name)&&""!==r.Name&&r.Name===e.Name)return n}return-1}static updatePerson(e,t){i(e.Provider)&&""!==e.Provider||(e.Provider=t.Provider,e.Id=t.Id),i(e.Email)&&""!==e.Email||(e.Email=t.Email),i(e.Name)&&""!==e.Name||(e.Name=t.Name)}}k.artifactId=Symbol();class U{static convertToArray(e,t){const n=k.getOrCreate();return t instanceof xe?(k.addPerson(t.Creator,"Creator","InThread"),k.addPeople(t.AnchorCreators,"AnchorCreator"),k.addPerson(t.ParentAuthor,"RepliedTo","InThread"),k.addPeople(t.Participants,"InThread"),k.addPerson(t.TaskCreator,"TaskCreator"),k.addPeople(t.TaskAssignees,"ExistingAssignee"),U.processCommentPreview(t.Preview),n):t instanceof Se?(k.addPerson(t.Creator,"Creator"),k.addPeople(t.AnchorCreators,"AnchorCreator"),k.addPerson(t.TaskCreator,"TaskCreator"),k.addPeople(t.TaskAssignees,"ExistingAssignee"),U.processCommentPreview(t.Preview),n):t instanceof Te?(k.addPerson(t.Creator,"Creator"),k.addPerson(t.Mentionee,"Mentioned"),k.addPerson(t.TaskCreator,"TaskCreator"),k.addPeople(t.TaskAssignees,"ExistingAssignee"),U.processCommentPreview(t.CommentPreview),n):t instanceof ce?(k.addPerson(t.Creator,"Creator"),k.addPerson(t.Mentionee,"Mentioned"),n):t instanceof Ne?(k.addPerson(t.Creator,"Creator"),k.addPerson(t.CommentThreadCreator,"CommentThreadCreator"),k.addPeople(t.Assignees,"NewAssignee"),U.processCommentPreview(t.CommentPreview),n):t instanceof De?(k.addPerson(t.Creator,"Creator"),k.addPerson(t.TaskCreator,"TaskCreator"),k.addPeople(t.Assignees,"ExistingAssignee"),k.addPeople(t.NewAssignees,"NewAssignee"),U.processCommentPreview(t.CommentPreview),n):t instanceof Oe?(k.addPerson(t.Creator,"Creator"),k.addPerson(t.TaskCreator,"TaskCreator"),k.addPeople(t.Assignees,"ExistingAssignee"),U.processCommentPreview(t.CommentPreview),n):t instanceof Re?(k.addPerson(t.Creator,"Creator"),k.addPerson(t.TaskCreator,"TaskCreator"),k.addPeople(t.Assignees,"Assignee"),k.addPeople(t.PreviousAssignees,"PreviousAssignee"),n):t instanceof Ee?(k.addPerson(t.Creator,"Creator"),n):t instanceof Me?(k.addPerson(t.Creator,"Creator"),k.addPerson(t.CommentCreator,"CommentCreator"),n):t instanceof je?(k.addPerson(t.Creator,"Creator"),k.addPeople(t.NudgedUsers,"NudgedUser"),n):t instanceof ke?(k.addPerson(t.Creator,"Creator"),k.addPeople(t.Recipients,"RecapRecipient"),n):n}static processCommentPreview(e){if(i(e))if(U.processPreviewFragment(e.Anchor,"AnchorCreator"),e instanceof we){if(U.processPreviewFragment(e.Comment,"CommentCreator","InThread"),U.processPreviewFragment(e.RootComment,"RepliedTo","InThread"),i(e.RecentComments))for(const t of e.RecentComments)U.processPreviewFragment(t,"InThread")}else U.processPreviewFragment(e.Comment,"CommentCreator")}static processPreviewFragment(e){if(i(e)){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];k.addPerson(e.Creator,...n)}}}class F extends M{constructor(){super(...arguments),this.TypeName="Unified.Person"}w2fjo(e,t){super.w2fjo(e,t);var n=N(t);0!==n&&1!==n||(E(e,"Id",null,l(this.Id,t)),E(e,"Name",null,l(this.Name,t)),E(e,"Email",null,l(this.Email,t)),E(e,"Provider",null,l(this.Provider,t)),E(e,"PictureUrl",null,l(this.PictureUrl,t)),E(e,"Roles",null,l(this.Roles,t)))}}var J,L,W,V,_;!function(e){e[e.User=0]="User",e[e.System=1]="System"}(J||(J={})),function(e){g(2),w(e,2)}(J),function(e){e[e.AAD=0]="AAD",e[e.MSA=1]="MSA"}(L||(L={})),function(e){g(2),w(e,2)}(L),function(e){e[e.Unknown=0]="Unknown",e[e.Message=1]="Message",e[e.File=2]="File",e[e.Calendar=3]="Calendar"}(W||(W={})),function(e){g(4),w(e,4)}(W),function(e){e[e.Unknown=0]="Unknown",e[e.Windows=1]="Windows",e[e.Android=2]="Android",e[e.iOS=3]="iOS",e[e.MacOS=4]="MacOS",e[e.Linux=5]="Linux",e[e.tvOS=6]="tvOS"}(V||(V={})),function(e){g(7),w(e,7)}(V),function(e){e[e.Unknown=0]="Unknown",e[e.Word=1]="Word",e[e.Excel=2]="Excel",e[e.PowerPoint=3]="PowerPoint",e[e.Outlook=4]="Outlook",e[e.OneNote=5]="OneNote",e[e.FluidApp=6]="FluidApp",e[e.Visio=7]="Visio"}(_||(_={}));const B=function(e){const t=g(8),n=w(e,8);return(e,r)=>T(e,t,(e=>n)(),r)}(_);var K;!function(e){e[e.Unknown=0]="Unknown",e[e.Win32=1]="Win32",e[e.WinRT=2]="WinRT",e[e.Android=3]="Android",e[e.Mac=4]="Mac",e[e.iOS=5]="iOS",e[e.Web=6]="Web",e[e.Server=7]="Server",e[e.Windows=8]="Windows",e[e.Linux=9]="Linux",e[e.tvOS=10]="tvOS"}(K||(K={}));const $=function(e){const t=g(11),n=w(e,11);return(e,r)=>T(e,t,(e=>n)(),r)}(K);var G,q;!function(e){e[e.Unspecified=0]="Unspecified",e[e.EditSession=1]="EditSession",e[e.PreExisting=2]="PreExisting"}(G||(G={})),function(e){g(3),w(e,3)}(G),function(e){e[e.Create=0]="Create",e[e.Update=1]="Update",e[e.Delete=2]="Delete"}(q||(q={}));const H=function(e){const t=g(3),n=w(e,3);return(e,r)=>T(e,t,(e=>n)(),r)}(q);var X;!function(e){e[e.Unknown=0]="Unknown",e[e.LiveId=1]="LiveId",e[e.OrgId=2]="OrgId",e[e.ActiveDirectory=3]="ActiveDirectory",e[e.ADAL=4]="ADAL",e[e.SSPI=5]="SSPI",e[e.OAuth2=6]="OAuth2",e[e.Badger=7]="Badger",e[e.Count=8]="Count"}(X||(X={}));const Q=function(e){const t=g(9),n=w(e,9);return(e,r)=>T(e,t,(e=>n)(),r)}(X);var z;!function(e){e[e.OID=0]="OID",e[e.PUID=1]="PUID",e[e.CID=2]="CID",e[e.Self=3]="Self"}(z||(z={}));const Y=function(e){const t=g(4),n=w(e,4);return(e,r)=>T(e,t,(e=>n)(),r)}(z);var Z,ee,te;!function(e){e[e.Unspecified=0]="Unspecified",e[e.AccessControlData=1]="AccessControlData",e[e.CustomerContent=2]="CustomerContent",e[e.EUII=3]="EUII",e[e.SupportData=4]="SupportData",e[e.AccountData=5]="AccountData",e[e.PublicPersonalData=6]="PublicPersonalData",e[e.EUPI=7]="EUPI",e[e.OII=8]="OII",e[e.SystemMetadata=9]="SystemMetadata",e[e.PublicNonPersonalData=10]="PublicNonPersonalData",e[e.Count=11]="Count"}(Z||(Z={})),function(e){g(12),w(e,12),new Map([[2,[e[0],"AccessControl",e[2],e[3],e[4],e[5],e[6],e[7],e[8],"SystemMetaData",e[10],e[11]]],[3,[e[0],"AccessControl",e[2],e[3],e[4],e[5],e[6],e[7],e[8],"SystemMetaData",e[10],e[11]]]])}(Z),function(e){e[e.Completed=0]="Completed",e[e.InProgress=1]="InProgress",e[e.CompletedMissingStart=2]="CompletedMissingStart"}(ee||(ee={})),function(e){g(3),w(e,3)}(ee);class ne extends M{constructor(){super(...arguments),this.TypeName="Base.UserInfo"}w2fjo(e,t){super.w2fjo(e,t);var n=N(t);2!==n&&3!==n||(E(e,"Id",null,l(this.Id,t)),E(e,"Name",null,l(this.Name,t)),E(e,"Email",null,l(this.Email,t)),E(e,"Provider",null,l(this.Provider,t)),E(e,"TenantId",null,l(this.TenantId,t)),E(e,"RawProvider",null,Q(this.RawProvider,t)),E(e,"RawId",null,l(this.RawId,t)),E(e,"RawIdKind",null,Y(this.RawIdKind,t)))}}class re extends j{constructor(){super(...arguments),this.Id=v,this.Created=f,this.Finalized=f,this.Observed=f,this.SourceApp=0,this.SourcePlatform=0,this.SourceSessionId=v}w2fjo(e,t){super.w2fjo(e,t);var n=N(t);0!==n&&1!==n||(E(e,"Id",null,h(this.Id,t)),E(e,"Timestamp",null,p(this.Created,t)),E(e,"AppSessionId",["ActivitySource"],h(this.SourceSessionId,t))),3===n&&E(e,"SignalInstanceId",["PreprocessorOptions"],h(this.Id,t)),2!==n&&3!==n||(E(e,"ActorDetails",["CustomProperties"],D(this.Creator,1|t)),E(e,"AppName",["Application"],B(this.SourceApp,t)),E(e,"AppVer",["Application"],y(this.SourceAppVersion,t)),E(e,"Platform",["CustomProperties","DeviceDetails"],$(this.SourcePlatform,t)),E(e,"OsVer",["Device"],y(this.SourcePlatformVersion,t)),E(e,"DeviceId",["Device"],l(this.SourceDeviceId,t)),E(e,"UserAgent",["Device"],l(this.SourceUserAgent,t)),E(e,"ClientIp",["Device"],l(this.SourceIpAddress,t)),E(e,"Context",["CustomProperties","ApplicationDetails"],A(this.SourceAppContext,t)),E(e,"NotifiedInBand",["CustomProperties"],d(this.NotifiedInBand,t))),0===n&&(E(e,"HostTimestamp",null,p(this.Observed,t)),E(e,"AppName",["ActivitySource"],B(this.SourceApp,t)),E(e,"AppVersion",["ActivitySource"],y(this.SourceAppVersion,t)),E(e,"AppPlatform",["ActivitySource"],$(this.SourcePlatform,t)),E(e,"AppContext",["ActivitySource"],A(this.SourceAppContext,t)),E(e,"NotifiedInBand",null,d(this.NotifiedInBand,t)))}}class oe extends re{w2fjo(e,t){super.w2fjo(e,t);var n=N(t);0===n&&E(e,"SuppressSendToSubstrate",null,d(this.SuppressSendToSubstrate,t)),0!==n&&1!==n||(E(e,"Type",null,l(class{static convertTo(e,t){return function(e){const t=e.TypeName,n=t.lastIndexOf(".");return n>=0?t.substring(n+1):t}(t)}}.convertTo({},this),t)),E(e,"People",null,D(U.convertToArray({},this),1|t)))}}class se extends oe{}class ie extends se{constructor(){super(...arguments),this.ContentOrigin=0}w2fjo(e,t){super.w2fjo(e,t);var n=N(t);0!==n&&1!==n||(E(e,"ContentId",["Data"],l(this.ContentId,t)),E(e,"NavigationId",["Data"],l(this.NavigationId,t)))}}class ae extends ie{constructor(){super(...arguments),this.Action=0}w2fjo(e,t){super.w2fjo(e,t);var n=N(t);0!==n&&1!==n||E(e,"ContentAction",["Data"],H(this.Action,t))}}class ce extends ae{}!function(e){e[e.UnsupportedClient=0]="UnsupportedClient",e[e.ProtectedDocument=1]="ProtectedDocument",e[e.Unnecessary=2]="Unnecessary"}(te||(te={}));const ue=function(e){const t=g(3),n=w(e,3),r=new Map([[0,["Unsupported_Client","Encrypted","NotNeeded"]],[1,["Unsupported_Client","Encrypted","NotNeeded"]]]);return(e,o)=>T(e,t,(e=>4&e?(e=>{var t;return null!==(t=r.get(e))&&void 0!==t?t:n})(N(e)):n)(o),o)}(te);var de;!function(e){e[e.NotStarted=0]="NotStarted",e[e.InProgress=1]="InProgress",e[e.Completed=2]="Completed"}(de||(de={}));const le=function(e){const t=g(3),n=w(e,3);return(e,r)=>T(e,t,(e=>n)(),r)}(de);var pe;!function(e){e[e.Urgent=0]="Urgent",e[e.Important=1]="Important",e[e.Medium=2]="Medium",e[e.Low=3]="Low"}(pe||(pe={}));const fe=function(e){const t=g(4),n=w(e,4);return(e,r)=>T(e,t,(e=>n)(),r)}(pe);var me;!function(e){e[e.None=0]="None",e[e.Assignees=1]="Assignees",e[e.Title=2]="Title",e[e.DueDate=4]="DueDate",e[e.Status=8]="Status",e[e.Priority=16]="Priority"}(me||(me={}));const he=function(e){const t=function(e){const t=[];for(let e=0;e<5;++e)t.push(1<<e);return t}(),n=function(e,t){const n=[];for(let t=0;t<5;++t)n.push(e[1<<t]);return n}(e);return(e,r)=>S(e,t,(e=>n)(),r)}(me);var ve;!function(e){e[e.Like=0]="Like"}(ve||(ve={}));const Ce=function(e){const t=g(1),n=w(e,1);return(e,r)=>T(e,t,(e=>n)(),r)}(ve);var Ie,Pe,Ae,ye;!function(e){e[e.Unknown=0]="Unknown",e[e.Local=1]="Local",e[e.Sharepoint=2]="Sharepoint"}(Ie||(Ie={})),function(e){g(3),w(e,3)}(Ie),function(e){e[e.Unknown=0]="Unknown",e[e.ReuseFile=1]="ReuseFile",e[e.SmartLookup=2]="SmartLookup",e[e.TellMe=3]="TellMe"}(Pe||(Pe={})),function(e){g(4),w(e,4)}(Pe),function(e){e[e.Slide=0]="Slide",e[e.Table=1]="Table",e[e.Image=2]="Image",e[e.Other=3]="Other"}(Ae||(Ae={})),function(e){g(4),w(e,4)}(Ae);class ge extends M{constructor(){super(...arguments),this.TypeName="Common.CommentPreview"}w2fjo(e,t){super.w2fjo(e,t);var n=N(t);0!==n&&1!==n||(E(e,"LocationText",null,l(this.Location,t)),E(e,"Anchor",null,D(this.Anchor,1|t)),E(e,"Comment",null,D(this.Comment,1|t)),E(e,"CommentThreadId",null,l(this.ThreadId,t)),E(e,"Options",null,R(this.Options,-2&t,"Common.PreviewOptions")))}}class we extends ge{constructor(){super(...arguments),this.ThreadLength=0,this.TypeName="Common.CommentReplyPreview"}w2fjo(e,t){super.w2fjo(e,t);var n=N(t);0!==n&&1!==n||(E(e,"RootComment",null,D(this.RootComment,1|t)),E(e,"RecentComments",null,D(this.RecentComments,1|t)),E(e,"ThreadCommentCount",null,c(this.ThreadLength,t)))}}class Te extends ce{constructor(){super(...arguments),this.TypeName="Common.Mention"}w2fjo(e,t){super.w2fjo(e,t);var n=N(t);0!==n&&1!==n||(E(e,"ParentContentId",["Data"],l(this.CommentContentId,t)),E(e,"CommentThreadId",["Data"],l(this.CommentThreadId,t)),E(e,"CommentThreadIsTask",["Data"],d(this.CommentThreadIsTask,t)),E(e,"Preview",null,R(this.CommentPreview,-2&t,"Common.CommentPreview")),E(e,"PreviewAbsenceReason",["Data"],ue(this.CommentPreviewAbsenceReason,t)))}}class Se extends ae{constructor(){super(...arguments),this.TypeName="Common.Comment"}w2fjo(e,t){super.w2fjo(e,t);var n=N(t);0!==n&&1!==n||(E(e,"CommentThreadId",["Data"],l(this.ThreadId,t)),E(e,"AnchorCreatorIndices",["Data"],c(class{static convertToOptional(e,t){return k.getPersonIndex(t)}static convertToArray(e,t){if(i(t)){const e=[];for(const n of t){const t=k.getPersonIndex(n);i(t)&&e.push(t)}return e}return null}}.convertToArray({},this.AnchorCreators),t)),E(e,"CommentThreadIsTask",["Data"],d(this.ThreadIsTask,t)),E(e,"Preview",null,R(this.Preview,-2&t,"Common.CommentPreview")),E(e,"PreviewAbsenceReason",["Data"],ue(this.PreviewAbsenceReason,t)))}}class xe extends Se{constructor(){super(...arguments),this.TypeName="Common.CommentReply"}}class be extends se{w2fjo(e,t){super.w2fjo(e,t);var n=N(t);0!==n&&1!==n||(E(e,"CommentThreadId",["Data"],l(this.CommentThreadId,t)),E(e,"NavigationId",["Data"],l(this.NavigationId,t)),E(e,"Preview",null,R(this.CommentPreview,-2&t,"Common.CommentPreview")),E(e,"PreviewAbsenceReason",["Data"],ue(this.CommentPreviewAbsenceReason,t)))}}class Ne extends be{constructor(){super(...arguments),this.TypeName="Common.TaskCreation"}}class Oe extends be{}class De extends Oe{constructor(){super(...arguments),this.TypeName="Common.TaskReassignment"}}class Re extends ae{constructor(){super(...arguments),this.DueDate=f,this.Status=0,this.Priority=0,this.TypeName="Common.CanvasTask"}w2fjo(e,t){super.w2fjo(e,t);var n=N(t);0!==n&&1!==n||(E(e,"Title",["Data"],l(this.Title,t)),E(e,"DueDate",["Data"],p(this.DueDate,t)),E(e,"Status",["Data"],le(this.Status,t)),E(e,"Priority",["Data"],fe(this.Priority,t)),E(e,"Updates",["Data"],he(this.Updates,t)))}}class Ee extends se{}class Me extends ae{constructor(){super(...arguments),this.ReactionType=0,this.TypeName="Common.CommentReaction"}w2fjo(e,t){super.w2fjo(e,t);var n=N(t);0!==n&&1!==n||(E(e,"CommentId",["Data"],l(this.CommentId,t)),E(e,"ReactionType",["Data"],Ce(this.ReactionType,t)))}}class je extends ae{constructor(){super(...arguments),this.TypeName="Common.Nudge"}w2fjo(e,t){super.w2fjo(e,t);var n=N(t);0!==n&&1!==n||(E(e,"NudgeEmoji",["Data"],l(this.NudgeEmoji,t)),E(e,"MessagePreview",["Data"],A(this.MessagePreview,t)))}}class ke extends ae{constructor(){super(...arguments),this.TypeName="Common.Recap"}w2fjo(e,t){super.w2fjo(e,t);var n=N(t);0!==n&&1!==n||E(e,"RecapProperties",["Data"],A(this.RecapProperties,t))}}!function(e){e[e.Success=0]="Success",e[e.UnknownError=1]="UnknownError",e[e.BadRequest=2]="BadRequest",e[e.AccessDenied=3]="AccessDenied",e[e.SignalTypeNotFound=4]="SignalTypeNotFound",e[e.SignalAlreadyExists=5]="SignalAlreadyExists",e[e.Disabled=6]="Disabled",e[e.InternalError=7]="InternalError",e[e.Throttled=8]="Throttled",e[e.Unknown=9]="Unknown"}(ye||(ye={})),function(e){g(10),w(e,10)}(ye);const Ue="writeToFacetJsonObject";function Fe(e){return null!=e}function Je(e,t,n){return Fe(t)?Array.isArray(t)?rt(t,n,((t,n)=>Je(e,t,n))):function(e,t){return(t|=0)<e.Min?e.Min:t>e.Max?e.Max:t}(e,t):null}Je.bind(null,{Min:-128,Max:127}),Je.bind(null,{Min:0,Max:255}),Je.bind(null,{Min:-32768,Max:32767}),Je.bind(null,{Min:0,Max:65535});const Le=Je.bind(null,{Min:-2147483648,Max:2147483647}),We=Je.bind(null,{Min:0,Max:4294967295});Je.bind(null,{Min:Number.MIN_SAFE_INTEGER,Max:Number.MAX_SAFE_INTEGER}),Je.bind(null,{Min:0,Max:Number.MAX_SAFE_INTEGER});const Ve=function(e,t){return Fe(e)?Array.isArray(e)?rt(e,t,Ve):e:null},_e=function(e,t){return Fe(e)?Array.isArray(e)?rt(e,t,_e):Fe(e)&&""!==e?e:null:null},Be=function(e,t){return Fe(e)?Array.isArray(e)?rt(e,t,Be):_e(e.toISOString(),t):null},Ke=new Date(0);class $e{constructor(e){this.value=e}static createNew(){return new $e("xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})))}toString(){return this.value}}$e.Empty=new $e("00000000-0000-0000-0000-000000000000");const Ge=function(e,t){return Fe(e)?Array.isArray(e)?rt(e,t,Ge):e!==$e.Empty?_e(e.toString(),t):null:null},qe=$e.Empty;function He(e){return function(e){return null!==e&&["number","string","boolean","object"].indexOf(typeof e)>=0}(e)&&!Array.isArray(e)}function Xe(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)}function Qe(e){if(Xe(e)){const t={};for(const n in e)t[n]=Qe(e[n]);return t}if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;++n){let r=e[n];He(r)&&t.push(r)}return t}return e}const ze=function(e,t){return Fe(e)?Array.isArray(e)?rt(e,t,ze):Qe(e):null},Ye=function(e,t){return Fe(e)?Array.isArray(e)?rt(e,t,Ye):_e(e.toString(),t):null};function Ze(e){const t=[];for(let n=0;n<e;++n)t.push(n);return t}function et(e){return Object.keys(e).sort(((t,n)=>e[t]-e[n]))}function tt(e,t,n,r){if(!Fe(e))return null;if(Array.isArray(e))return rt(e,r,((e,r)=>tt(e,t,n,r)));if(8&r)return We(e,r);const o=Math.min(t.length,n.length);for(let s=0;s<o;++s)if(t[s]===e)return _e(n[s],r);return _e(e.toString(),r)}function nt(e,t,n,r){if(!Fe(e))return null;if(Array.isArray(e))return rt(e,r,((e,r)=>nt(e,t,n,r)));if(8&r)return We(e,r);const o=[],s=Math.min(t.length,n.length);for(let r=0;r<s;++r){const s=t[r];if(e&s&&(o.push(n[r]),(e&=~s)<1))break}return e>0&&o.push(e.toString()),_e(o.length<1?"None":o.join(","),r)}function rt(e,t,n){if(!Fe(e)||e.length<1)return null;const r=[];for(const o of e){const e=n(o,t);Fe(e)&&!Array.isArray(e)&&r.push(e)}return r}new class{constructor(e=0,t=0,n=0,r=0){this.Major=e,this.Minor=t,this.Build=n,this.Revision=r}toString(){let e=this.Major+"."+this.Minor;return(this.Build>0||this.Revision>0)&&(e+="."+this.Build,this.Revision>0&&(e+="."+this.Revision)),e}};const ot=function(e,t=0){return 16777215&t|(255&e)<<24|4},st=function(e){return(-16777216&e)>>24};class it{constructor(){this.artifacts=new Map,this.parent=it.current,it.current=this}static getOrCreateArtifact(e,t){for(let e=it.current;e;e=e.parent){const n=e.artifacts.get(t);if(n)return n}const n=e();return Fe(it.current)&&it.current.artifacts.set(t,n),n}exit(){it.current=this.parent}}it.current=null;const at=function(e,t){return Fe(e)?Array.isArray(e)?rt(e,t,at):e.toJsonValue(t):null},ct=function(e,t,n){return Fe(e)?Array.isArray(e)?rt(e,t,((e,t)=>ct(e,t,n))):(1&t||4&t||e.TypeName!=n||(t|=1),e.toJsonValue(t)):null};function ut(e,t,n,r){if(Fe(n))for(const t of n){let n=e[t];Xe(n)||(e[t]=n={}),e=n}Fe(r)&&(e[t]=r)}class dt{update(e){}toJsonValue(e){const t=function(e,t){return 1&t||4&t?{}:2&t?{__metadata:{type:e}}:{__type:e}}(this.TypeName,e);return this.processJsonObject(t,e,this.writeToJsonObject,this.writeToFacetJsonObject),t}toFacetJsonValue(e,t=0){return this.toJsonValue(ot(e,t))}toJson(e=0){return JSON.stringify(this.toJsonValue(e))}toFacetJson(e,t=0){return this.toJson(ot(e,t))}writeToJsonObject(e,t){}[Ue](e,t){}processJsonObject(e,t,n,r){!function(e,t){try{t()}finally{e.exit()}}(new it,(()=>{4&t?r.call(this,e,t):n.call(this,e,t)}))}}class lt extends dt{constructor(){super(...arguments),this.TypeClassification=2}}class pt{static getOrCreate(){return it.getOrCreateArtifact(pt.create,pt.artifactId)}static getPersonIndex(e){return Fe(e)?pt.findPerson(e):null}static addPerson(e,...t){if(Fe(e)){let n=pt.findAndUpdatePerson(e);Fe(n)||(n=new bn,pt.updatePerson(n,e),pt.getOrCreate().push(n));for(const e of t)Fe(n.Roles)?n.Roles.indexOf(e)<0&&n.Roles.push(e):n.Roles=[e]}}static addPeople(e,...t){if(Fe(e))for(const n of e)pt.addPerson(n,...t)}static create(){return[]}static findAndUpdatePerson(e){const t=pt.findPerson(e);if(t>=0){const n=pt.getOrCreate()[t];return pt.updatePerson(n,e),n}return null}static findPerson(e){const t=pt.getOrCreate();for(var n=0;n<t.length;++n){const r=t[n];if(Fe(r.Provider)&&""!==r.Provider){if(r.Provider===e.Provider&&r.Id===e.Id)return n;if(Fe(e.Provider)&&""!==e.Provider)continue}if(Fe(r.Email)&&""!==r.Email){if(r.Email===e.Email)return n;if(Fe(e.Email)&&""!==e.Email)continue}if(Fe(r.Name)&&""!==r.Name&&r.Name===e.Name)return n}return-1}static updatePerson(e,t){Fe(e.Provider)&&""!==e.Provider||(e.Provider=t.Provider,e.Id=t.Id),Fe(e.Email)&&""!==e.Email||(e.Email=t.Email),Fe(e.Name)&&""!==e.Name||(e.Name=t.Name)}}pt.artifactId=Symbol();class ft{static convertToArray(e,t){const n=pt.getOrCreate();return t instanceof fr?(pt.addPerson(t.Creator,"Creator","InThread"),pt.addPeople(t.AnchorCreators,"AnchorCreator"),pt.addPerson(t.ParentAuthor,"RepliedTo","InThread"),pt.addPeople(t.Participants,"InThread"),pt.addPerson(t.TaskCreator,"TaskCreator"),pt.addPeople(t.TaskAssignees,"ExistingAssignee"),ft.processCommentPreview(t.Preview),n):t instanceof pr?(pt.addPerson(t.Creator,"Creator"),pt.addPeople(t.AnchorCreators,"AnchorCreator"),pt.addPerson(t.TaskCreator,"TaskCreator"),pt.addPeople(t.TaskAssignees,"ExistingAssignee"),ft.processCommentPreview(t.Preview),n):t instanceof lr?(pt.addPerson(t.Creator,"Creator"),pt.addPerson(t.Mentionee,"Mentioned"),pt.addPerson(t.TaskCreator,"TaskCreator"),pt.addPeople(t.TaskAssignees,"ExistingAssignee"),ft.processCommentPreview(t.CommentPreview),n):t instanceof er?(pt.addPerson(t.Creator,"Creator"),pt.addPerson(t.Mentionee,"Mentioned"),n):t instanceof hr?(pt.addPerson(t.Creator,"Creator"),pt.addPerson(t.CommentThreadCreator,"CommentThreadCreator"),pt.addPeople(t.Assignees,"NewAssignee"),ft.processCommentPreview(t.CommentPreview),n):t instanceof Cr?(pt.addPerson(t.Creator,"Creator"),pt.addPerson(t.TaskCreator,"TaskCreator"),pt.addPeople(t.Assignees,"ExistingAssignee"),pt.addPeople(t.NewAssignees,"NewAssignee"),ft.processCommentPreview(t.CommentPreview),n):t instanceof vr?(pt.addPerson(t.Creator,"Creator"),pt.addPerson(t.TaskCreator,"TaskCreator"),pt.addPeople(t.Assignees,"ExistingAssignee"),ft.processCommentPreview(t.CommentPreview),n):t instanceof Ir?(pt.addPerson(t.Creator,"Creator"),pt.addPerson(t.TaskCreator,"TaskCreator"),pt.addPeople(t.Assignees,"Assignee"),pt.addPeople(t.PreviousAssignees,"PreviousAssignee"),n):t instanceof Pr?(pt.addPerson(t.Creator,"Creator"),n):t instanceof yr?(pt.addPerson(t.Creator,"Creator"),pt.addPerson(t.CommentCreator,"CommentCreator"),pt.addPerson(t.LatestReactor,"LatestReactor"),n):t instanceof wr?(pt.addPerson(t.Creator,"Creator"),pt.addPeople(t.NudgedUsers,"NudgedUser"),n):t instanceof Tr?(pt.addPerson(t.Creator,"Creator"),pt.addPeople(t.Recipients,"RecapRecipient"),n):t instanceof gr?(pt.addPerson(t.Creator,"Creator"),pt.addPerson(t.LatestReactor,"LatestReactor"),pt.addPeople(t.TargetActors,"TargetActor"),n):n}static processCommentPreview(e){if(Fe(e))if(ft.processPreviewFragment(e.Anchor,"AnchorCreator"),e instanceof ur){if(ft.processPreviewFragment(e.Comment,"CommentCreator","InThread"),ft.processPreviewFragment(e.RootComment,"RepliedTo","InThread"),Fe(e.RecentComments))for(const t of e.RecentComments)ft.processPreviewFragment(t,"InThread")}else ft.processPreviewFragment(e.Comment,"CommentCreator")}static processPreviewFragment(e,...t){Fe(e)&&pt.addPerson(e.Creator,...t)}}function mt(e){const t=e.TypeName,n=t.lastIndexOf(".");return n>=0?t.substring(n+1):t}const ht="Name",vt="Email",Ct="Provider",It="PictureUrl",Pt="User",At="Unknown",yt="File",gt="Windows",wt="Android",Tt="Linux",St="tvOS",xt="TenantId",bt="ItemId",Nt="Unspecified",Ot="Count",Dt="CustomerContent",Rt="EUII",Et="Completed",Mt="InProgress",jt="RawProvider",kt="RawIdKind",Ut="SourceApp",Ft="SourcePlatform",Jt="SourceSessionId",Lt="ActivitySource",Wt="CustomProperties",Vt="Application",_t="AppName",Bt="SourceAppVersion",Kt="Device",$t="SourceAppContext",Gt="NotifiedInBand",qt="SuppressSendToSubstrate",Ht="ContentId",Xt="Data",Qt="NavigationId",zt="StartTime",Yt="Status",Zt="Item",en="Title",tn="DueDate",nn="Priority",rn="CommentThreadId",on="Common.CommentPreview",sn="ThreadLength",an="RootComment",cn="RecentComments",un="Revisions",dn="CommentThreadIsTask",ln="CommentPreview",pn="Preview",fn="CommentPreviewAbsenceReason",mn="PreviewAbsenceReason",hn="TaskCreatedDate",vn="LatestReaction",Cn="LatestEmoji",In="ReactionCounts",Pn="EmojiCounts",An="TotalReactorCount",yn="TargetPreview",gn="NudgeEmoji",wn="MessagePreview",Tn="RecapProperties",Sn="ActivityCompliance",xn=Object.assign;class bn extends dt{constructor(){super(),this.TypeName="Unified.Person"}[Ue](e,t){super.writeToFacetJsonObject(e,t);var n=st(t);0!==n&&1!==n||(ut(e,"Id",null,_e(this.Id,t)),ut(e,ht,null,_e(this.Name,t)),ut(e,vt,null,_e(this.Email,t)),ut(e,Ct,null,_e(this[Ct],t)),ut(e,It,null,_e(this[It],t)),ut(e,"Roles",null,_e(this.Roles,t)))}}!function(e){Ze(2),et(e)}({[Pt]:0,System:1});const Nn={AAD:0,MSA:1},On=function(e){const t=Ze(2),n=et(e);return(e,r)=>tt(e,t,(e=>n)(),r)}(Nn),Dn={[At]:0,EXO:1,SPO:2,OXO:3,MileIQ:4,AFS:5,Teams:6,Stream:7,ODB:8,MicrosoftPowerBI:9,Yammer:10},Rn=function(e){const t=Ze(11),n=et(e);return(e,r)=>tt(e,t,(e=>n)(),r)}(Dn),En=(function(e){Ze(4),et(e)}({[At]:0,Message:1,[yt]:2,Calendar:3}),{[At]:0,[gt]:1,[wt]:2,iOS:3,MacOS:4,[Tt]:5,[St]:6}),Mn=function(e){const t=Ze(7),n=et(e);return(e,r)=>tt(e,t,(e=>n)(),r)}(En);class jn extends dt{constructor(){super(),this.TypeName="SIGS.Actor",this.IdKind=0}[Ue](e,t){super.writeToFacetJsonObject(e,t);var n=st(t);2!==n&&3!==n||(ut(e,"ActorIdType",null,On(this.IdKind,t)),ut(e,"ActorId",null,_e(this.Id,t)),ut(e,"AadTenantId",null,_e(this.TenantId,t)),ut(e,"ActorType",null,_e(Pt,t)))}}class kn extends dt{[Ue](e,t){super.writeToFacetJsonObject(e,t);var n=st(t);2!==n&&3!==n||ut(e,"Url",null,_e(this.Url,t))}}class Un extends kn{constructor(){super(),this.TypeName="SIGS.SharePointDocumentInfo"}[Ue](e,t){super.writeToFacetJsonObject(e,t);var n=st(t);2!==n&&3!==n||(ut(e,"SiteUrl",null,_e(this.SiteUrl,t)),ut(e,xt,null,Ge(this.TenantId,t)),ut(e,"SiteId",null,Ge(this.SiteId,t)),ut(e,"WebId",null,Ge(this.WebId,t)),ut(e,"ListId",null,Ge(this.ListId,t)),ut(e,bt,null,Ge(this.ItemId,t)))}}const Fn=function(e){const t=Ze(9),n=et(e);return(e,r)=>tt(e,t,(e=>n)(),r)}({[At]:0,Word:1,Excel:2,PowerPoint:3,Outlook:4,OneNote:5,FluidApp:6,Visio:7,Planner:8}),Jn={[At]:0,Win32:1,WinRT:2,[wt]:3,Mac:4,iOS:5,Web:6,Server:7,[gt]:8,[Tt]:9,[St]:10},Ln=function(e){const t=Ze(11),n=et(e);return(e,r)=>tt(e,t,(e=>n)(),r)}(Jn),Wn=(function(e){Ze(3),et(e)}({[Nt]:0,EditSession:1,PreExisting:2}),{Create:0,Update:1,Delete:2}),Vn=function(e){const t=Ze(3),n=et(e);return(e,r)=>tt(e,t,(e=>n)(),r)}(Wn),_n={[At]:0,LiveId:1,OrgId:2,ActiveDirectory:3,ADAL:4,SSPI:5,OAuth2:6,Badger:7,[Ot]:8},Bn=function(e){const t=Ze(9),n=et(e);return(e,r)=>tt(e,t,(e=>n)(),r)}(_n),Kn={OID:0,PUID:1,CID:2,Self:3},$n=function(e){const t=Ze(4),n=et(e);return(e,r)=>tt(e,t,(e=>n)(),r)}(Kn),Gn=function(e){const t=Ze(12),n=et(e),r=[[n[0],"AccessControl",n[2],n[3],n[4],n[5],n[6],n[7],n[8],"SystemMetaData",n[10],n[11]]],o=new Map([[2,r[0]],[3,r[0]]]);return(e,r)=>tt(e,t,(e=>4&e?(e=>{var t;return null!==(t=o.get(e))&&void 0!==t?t:n})(st(e)):n)(r),r)}({[Nt]:0,AccessControlData:1,[Dt]:2,[Rt]:3,SupportData:4,AccountData:5,PublicPersonalData:6,EUPI:7,OII:8,SystemMetadata:9,PublicNonPersonalData:10,[Ot]:11}),qn=function(e){const t=Ze(3),n=et(e);return(e,r)=>tt(e,t,(e=>n)(),r)}({[Et]:0,[Mt]:1,CompletedMissingStart:2});class Hn extends dt{constructor(){super(),this.TypeName="Base.UserInfo"}[Ue](e,t){super.writeToFacetJsonObject(e,t);var n=st(t);2!==n&&3!==n||(ut(e,"Id",null,_e(this.Id,t)),ut(e,ht,null,_e(this.Name,t)),ut(e,vt,null,_e(this.Email,t)),ut(e,Ct,null,_e(this[Ct],t)),ut(e,xt,null,_e(this.TenantId,t)),ut(e,jt,null,Bn(this[jt],t)),ut(e,"RawId",null,_e(this.RawId,t)),ut(e,kt,null,$n(this[kt],t)))}}class Xn extends lt{constructor(){super(),xn(this,{Id:qe,Created:Ke,Finalized:Ke,Observed:Ke,[Ut]:0,[Ft]:0,[Jt]:qe})}[Ue](e,t){super.writeToFacetJsonObject(e,t);var n=st(t);0!==n&&1!==n||(ut(e,"Id",null,Ge(this.Id,t)),ut(e,"Timestamp",null,Be(this.Created,t)),ut(e,"AppSessionId",[Lt],Ge(this[Jt],t))),3===n&&ut(e,"SignalInstanceId",["PreprocessorOptions"],Ge(this.Id,t)),2!==n&&3!==n||(ut(e,"ActorDetails",[Wt],at(this.Creator,1|t)),ut(e,_t,[Vt],Fn(this[Ut],t)),ut(e,"AppVer",[Vt],Ye(this[Bt],t)),ut(e,"Platform",[Wt,"DeviceDetails"],Ln(this[Ft],t)),ut(e,"OsVer",[Kt],Ye(this.SourcePlatformVersion,t)),ut(e,"DeviceId",[Kt],_e(this.SourceDeviceId,t)),ut(e,"UserAgent",[Kt],_e(this.SourceUserAgent,t)),ut(e,"ClientIp",[Kt],_e(this.SourceIpAddress,t)),ut(e,"Context",[Wt,"ApplicationDetails"],ze(this[$t],t)),ut(e,Gt,[Wt],Ve(this[Gt],t))),0===n&&(ut(e,"HostTimestamp",null,Be(this.Observed,t)),ut(e,_t,[Lt],Fn(this[Ut],t)),ut(e,"AppVersion",[Lt],Ye(this[Bt],t)),ut(e,"AppPlatform",[Lt],Ln(this[Ft],t)),ut(e,"AppContext",[Lt],ze(this[$t],t)),ut(e,Gt,null,Ve(this[Gt],t)))}}class Qn extends Xn{[Ue](e,t){super.writeToFacetJsonObject(e,t);var n=st(t);0===n&&ut(e,qt,null,Ve(this[qt],t)),0!==n&&1!==n||(ut(e,"Type",null,_e(class{static convertTo(e,t){return mt(t)}}.convertTo({},this),t)),ut(e,"People",null,at(ft.convertToArray({},this),1|t)))}}class zn extends Qn{}class Yn extends zn{constructor(){super(),this.ContentOrigin=0}[Ue](e,t){super.writeToFacetJsonObject(e,t);var n=st(t);0!==n&&1!==n||(ut(e,Ht,[Xt],_e(this[Ht],t)),ut(e,Qt,[Xt],_e(this[Qt],t)))}}class Zn extends Yn{constructor(){super(),this.Action=0}[Ue](e,t){super.writeToFacetJsonObject(e,t);var n=st(t);0!==n&&1!==n||ut(e,"ContentAction",[Xt],Vn(this.Action,t))}}class er extends Zn{}class tr extends Xn{constructor(){super(),this[zt]=Ke,this.EndTime=Ke}[Ue](e,t){super.writeToFacetJsonObject(e,t);var n=st(t);2!==n&&3!==n||(ut(e,zt,null,Be(this[zt],t)),ut(e,"EndTime",null,Be(this.EndTime,t)),ut(e,Yt,null,qn(this.Status,t)),ut(e,"CV",null,_e(this.CorrelationVector,t)),ut(e,"Locale",null,_e(this.Locale,t)),ut(e,"Workload",[Vt],Rn(this.AppWorkload,t)),ut(e,bt,[Zt],_e(this.ItemId,t)),ut(e,"ContainerType",[Zt],_e(this.ItemContainerKind,t)),ut(e,"ContainerId",[Zt],_e(this.ItemContainerId,t)),ut(e,"ContainerTypeId",[Wt],_e(this.CustomContainerTypeId,t)),ut(e,"SignalType",null,_e(class{static convertTo(e,t){if(t instanceof nr&&Fe(t.Data)){const e="Office"+mt(t.Data);return t.Data instanceof Zn?e+Vn(t.Data.Action,0):e}return mt(t)}}.convertTo({},this),t)),ut(e,"Actor",null,at(class{static convertTo(e,t){var n;if(!Fe(t)||!Fe(t.Creator)||!Fe(t.Creator.RawId)&&t.Creator.RawIdKind!=Kn.Self)return null;const r=new jn,o=t.Creator.RawProvider==_n.LiveId,s=null!==(n=t.Creator.RawId)&&void 0!==n?n:"";return r.IdKind=o?Nn.MSA:Nn.AAD,r.TenantId=t.Creator.TenantId,r.Id=Fe(t.Creator.RawIdKind)?t.Creator.RawIdKind==Kn.OID?o?"OID:"+s:s:t.Creator.RawIdKind==Kn.PUID?o?s:"PUID:"+s:t.Creator.RawIdKind==Kn.CID?"CID:"+s:"Self":o?"CID:"+s:s,r}}.convertTo({},this),1|t)),ut(e,"Os",[Kt],Mn(class{static convertTo(e,t){switch(t.SourcePlatform){case Jn.Win32:case Jn.WinRT:case Jn.Windows:return En.Windows;case Jn.Android:return En.Android;case Jn.Mac:return En.MacOS;case Jn.iOS:return En.iOS;case Jn.Linux:return En.Linux;case Jn.tvOS:return En.tvOS;default:return En.Unknown}}}.convertTo({DefaultValue:0},this),t)),ut(e,"Compliance",null,Gn(class{static convertTo(e,t){return t.TypeClassification}}.convertTo({DefaultValue:0},this),t)),ut(e,"AadAppId",[Vt],_e("3d9f2b8c-fab8-4011-a098-2652bdd0b55d",t)),ut(e,"ItemType",[Zt],_e(yt,t)))}}class nr extends tr{[Ue](e,t){super.writeToFacetJsonObject(e,t);var n=st(t);2!==n&&3!==n||(ut(e,"FileDetails",[Wt],ct(this.DocumentInfo,-2&t,"SIGS.DocumentInfo")),ut(e,"ActivityDetails",[Wt],ct(this.Data,-2&ot(1,t),"Base.NormalActivity")))}}const rr=function(e){const t=Ze(3),n=et({UnsupportedClient:0,ProtectedDocument:1,Unnecessary:2}),r=[["Unsupported_Client","Encrypted","NotNeeded"]],o=new Map([[0,r[0]],[1,r[0]]]);return(e,r)=>tt(e,t,(e=>4&e?(e=>{var t;return null!==(t=o.get(e))&&void 0!==t?t:n})(st(e)):n)(r),r)}(),or=function(e){const t=Ze(3),n=et(e);return(e,r)=>tt(e,t,(e=>n)(),r)}({NotStarted:0,[Mt]:1,[Et]:2}),sr=function(e){const t=Ze(4),n=et({Urgent:0,Important:1,Medium:2,Low:3});return(e,r)=>tt(e,t,(e=>n)(),r)}(),ir=function(e){const t=function(e){const t=[];for(let e=0;e<5;++e)t.push(1<<e);return t}(),n=function(e){return Object.keys(e).filter((e=>"None"!==e)).sort(((t,n)=>e[t]-e[n]))}(e);return(e,r)=>nt(e,t,(e=>n)(),r)}({None:0,Assignees:1,[en]:2,[tn]:4,[Yt]:8,[nn]:16}),ar=function(e){const t=Ze(1),n=et({Like:0});return(e,r)=>tt(e,t,(e=>n)(),r)}();(function(e){Ze(3),et(e)})({[At]:0,Local:1,Sharepoint:2}),function(e){Ze(4),et(e)}({[At]:0,ReuseFile:1,SmartLookup:2,TellMe:3}),function(e){Ze(4),et({Slide:0,Table:1,Image:2,Other:3})}();class cr extends dt{constructor(){super(),this.TypeName=on}[Ue](e,t){super.writeToFacetJsonObject(e,t);var n=st(t);0!==n&&1!==n||(ut(e,"LocationText",null,_e(this.Location,t)),ut(e,"Anchor",null,at(this.Anchor,1|t)),ut(e,"Comment",null,at(this.Comment,1|t)),ut(e,rn,null,_e(this.ThreadId,t)),ut(e,"Options",null,ct(this.Options,-2&t,"Common.PreviewOptions")))}}class ur extends cr{constructor(){super(),this.TypeName="Common.CommentReplyPreview",this[sn]=0}[Ue](e,t){super.writeToFacetJsonObject(e,t);var n=st(t);0!==n&&1!==n||(ut(e,an,null,at(this[an],1|t)),ut(e,cn,null,at(this[cn],1|t)),ut(e,"ThreadCommentCount",null,Le(this[sn],t)))}}class dr extends zn{constructor(){super(),this.TypeName="Common.RevisionSet",this.TypeClassification=3}[Ue](e,t){super.writeToFacetJsonObject(e,t);var n=st(t);0!==n&&1!==n||ut(e,un,[Xt],_e(class{static convertToArray(e,t){if(Fe(t)){const e=[];for(const n of t)Fe(n)&&e.push(n.RevisionID);return e}return null}}.convertToArray({},this[un]),t))}}class lr extends er{constructor(){super(),this.TypeName="Common.Mention"}[Ue](e,t){super.writeToFacetJsonObject(e,t);var n=st(t);0!==n&&1!==n||(ut(e,"ParentContentId",[Xt],_e(this.CommentContentId,t)),ut(e,rn,[Xt],_e(this[rn],t)),ut(e,dn,[Xt],Ve(this[dn],t)),ut(e,pn,null,ct(this[ln],-2&t,on)),ut(e,mn,[Xt],rr(this[fn],t)))}}class pr extends Zn{constructor(){super(),this.TypeName="Common.Comment"}[Ue](e,t){super.writeToFacetJsonObject(e,t);var n=st(t);0!==n&&1!==n||(ut(e,rn,[Xt],_e(this.ThreadId,t)),ut(e,dn,[Xt],Ve(this.ThreadIsTask,t)),ut(e,pn,null,ct(this.Preview,-2&t,on)),ut(e,mn,[Xt],rr(this[mn],t)))}}class fr extends pr{constructor(){super(),this.TypeName="Common.CommentReply"}}class mr extends zn{[Ue](e,t){super.writeToFacetJsonObject(e,t);var n=st(t);0!==n&&1!==n||(ut(e,rn,[Xt],_e(this[rn],t)),ut(e,Qt,[Xt],_e(this[Qt],t)),ut(e,pn,null,ct(this[ln],-2&t,on)),ut(e,mn,[Xt],rr(this[fn],t)))}}class hr extends mr{constructor(){super(),this.TypeName="Common.TaskCreation"}}class vr extends mr{}class Cr extends vr{constructor(){super(),this.TypeName="Common.TaskReassignment"}}class Ir extends Zn{constructor(){super(),this.TypeName="Common.CanvasTask"}[Ue](e,t){super.writeToFacetJsonObject(e,t);var n=st(t);0!==n&&1!==n||(ut(e,en,[Xt],_e(this.Title,t)),ut(e,hn,[Xt],Be(this[hn],t)),ut(e,tn,[Xt],Be(this.DueDate,t)),ut(e,Yt,[Xt],or(this.Status,t)),ut(e,nn,[Xt],sr(this.Priority,t)),ut(e,"Updates",[Xt],ir(this.Updates,t)))}}class Pr extends zn{}class Ar extends Yn{[Ue](e,t){super.writeToFacetJsonObject(e,t);var n=st(t);0!==n&&1!==n||(ut(e,vn,[Xt],ar(this[vn],t)),ut(e,Cn,[Xt],_e(this[Cn],t)),ut(e,In,[Xt],at(this[In],1|t)),ut(e,Pn,[Xt],at(this[Pn],1|t)),ut(e,An,[Xt],We(this[An],t)))}}class yr extends Ar{constructor(){super(),this.TypeName="Common.CommentReactionUpdate"}}class gr extends Ar{constructor(){super(),this.TypeName="Common.TargetedReactionUpdate"}[Ue](e,t){super.writeToFacetJsonObject(e,t);var n=st(t);0!==n&&1!==n||(ut(e,"TargetId",[Xt],_e(this.TargetId,t)),ut(e,yn,[Xt],ze(this[yn],t)))}}class wr extends Zn{constructor(){super(),this.TypeName="Common.Nudge"}[Ue](e,t){super.writeToFacetJsonObject(e,t);var n=st(t);0!==n&&1!==n||(ut(e,gn,[Xt],_e(this[gn],t)),ut(e,wn,[Xt],ze(this[wn],t)))}}class Tr extends Zn{constructor(){super(),this.TypeName="Common.Recap"}[Ue](e,t){super.writeToFacetJsonObject(e,t);var n=st(t);0!==n&&1!==n||ut(e,Tn,[Xt],ze(this[Tn],t))}}class Sr extends nr{constructor(){super(),this.TypeName="Common.ActivitySignalWithoutContent",this.TypeClassification=3}[Ue](e,t){super.writeToFacetJsonObject(e,t);var n=st(t);2!==n&&3!==n||ut(e,Sn,[Wt],_e(Rt,t))}}class xr extends nr{constructor(){super(),this.TypeName="Common.ActivitySignalWithContent"}[Ue](e,t){super.writeToFacetJsonObject(e,t);var n=st(t);2!==n&&3!==n||ut(e,Sn,[Wt],_e(Dt,t))}}class br extends dt{constructor(){super(),this.TypeName="Vroom.WrappedActivity",this.Id=qe}[Ue](e,t){super.writeToFacetJsonObject(e,t);var n=st(t);0!==n&&1!==n||(ut(e,"Id",null,Ge(this.Id,t)),ut(e,"activity",null,ct(this.Activity,-2&t,"Base.Activity")))}}class Nr extends dt{constructor(){super(),this.TypeName="Vroom.PatchStreamPayload"}[Ue](e,t){super.writeToFacetJsonObject(e,t);var n=st(t);0!==n&&1!==n||ut(e,"value",null,at(this.Activities,1|t))}}class Or extends dt{constructor(){super(),this.TypeName="Transport.PreprocessorPayload"}[Ue](e,t){super.writeToFacetJsonObject(e,t);var n=st(t);2!==n&&3!==n||ut(e,"activities",null,ct(this.Signals,-2&t,"Base.ActivitySignal"))}}!function(e){Ze(11),et(e)}({Success:0,UnknownError:1,BadRequest:2,AccessDenied:3,SignalTypeNotFound:4,SignalAlreadyExists:5,Disabled:6,InternalError:7,Throttled:8,ServiceUnavailable:9,[At]:10});class Dr{get NamespaceLogger(){return this}get PersistedProperties(){return this}addPersistedProperties(e){this.persistedProperties={...this.persistedProperties,...e}}send(e){this.sendWithNamespace(e,this.namespace)}sendWithNamespace(e,t){var n;null===(n=this.logger)||void 0===n||n.sendWithNamespace({...this.persistedProperties,...e},t)}dispose(){this.logger=null}constructor(e,t,n){if(this.namespace=e,t instanceof Dr){const e={...t.persistedProperties,...n};this.logger=t.logger,this.persistedProperties=e}else this.logger=t,this.persistedProperties=n}}var Rr=n("RdgM"),Er=n("kxAM"),Mr=n("LpbE"),jr=n("Ito+"),kr=n("aFvx"),Ur=n("graM"),Fr=n("5+n6");function Jr(e,t){const n=qr(e,"Pipelines."+t.TypeName,function(e){return e instanceof er||e instanceof dr||e instanceof mr?1:2}(t));return t instanceof Zn&&t.Action!==Wn.Create?t instanceof er&&(!Lr(e,"AllowMentionDeleteForSubstrate",!1)||t.Action!==Wn.Delete)?0:function(e,...t){let n=e;for(const e of t)n&=~e;return n}(n,1):n}function Lr(e,t,n){return qr(e,t,n)}function Wr(e){return Hr(e)&&"string"==typeof e.code&&Xr(e.message)&&Qr(e["@onedrive.errorReasonForTelemetry"])}function Vr(e){return Hr(e)&&Wr(e.error)}function _r(e){return Hr(e)&&"string"==typeof e.Id&&Xr(e.ServerId)&&Xr(e.Message)&&Qr(e.Status)&&(void 0===e.Error||Wr(e.Error))}function Br(e){return Hr(e)&&zr(e.Status,0,"Success")&&void 0===e.Error}function Kr(e){return Hr(e)&&"string"==typeof e.Id&&Qr(e.Status)}function $r(e){return Hr(e)&&zr(e.Status,0,"Success")}function Gr(e,t,n,o){const{siteUrl:s,siteId:i,webId:a,listId:c,listItemUniqueId:u}=n,d=function(e,t){if(e){if("Enterprise"===e.tokenProvider.identityType&&e.tenantId)return`SPO:SPO_${t.siteId}@SPO_${e.tenantId}`;if("Consumer"===e.tokenProvider.identityType)return e.rosterId}}(e,n),l=new Un;l.SiteUrl=s,l.TenantId=null!=e&&e.tenantId?new $e(e.tenantId):void 0,l.SiteId=new $e(i),l.WebId=new $e(a),l.ListId=new $e(c),l.ItemId=new $e(u);const p=function(e){return 2===e.TypeClassification?new xr:new Sr}(o);return o.SignalId||(o.SignalId=new $e(Object(r.a)())),p.Id=o.SignalId,p.Creator=o.Creator,p.SourceApp=o.SourceApp,p.SourceAppVersion=o.SourceAppVersion,p.SourcePlatform=o.SourcePlatform,p.SourcePlatformVersion=o.SourcePlatformVersion,p.SourceDeviceId=o.SourceDeviceId,p.SourceUserAgent=o.SourceUserAgent,p.SourceIpAddress=o.SourceIpAddress,p.SourceAppContext=o.SourceAppContext,p.NotifiedInBand=o.NotifiedInBand,p.StartTime=o.Created,p.EndTime=o.Created,p.ItemId=t,p.Data=o,p.DocumentInfo=l,p.AppWorkload=Dn.SPO,p.ItemContainerId=d,p.CustomContainerTypeId=null==e?void 0:e.containerTypeId,p}function qr(e,t,n){return Object(Fr.a)("ActivityTransport."+t,n,null==e?void 0:e.settingsProvider)}function Hr(e){return"object"==typeof e&&null!==e}function Xr(e){return void 0===e||"string"==typeof e}function Qr(e){return void 0===e||"number"==typeof e||"string"==typeof e}function zr(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return void 0===e||n.includes(e)}!function(...e){let t=0;for(const n of e)t|=n}(1,2);const Yr="OutgoingActivity",Zr="ActivityResult";function eo(e,t,n,r,o){const s=oo(Zr,t,Jr(e,t));s.TryCount=n.tries.length;const i=n.result.headers.get("SPRequestGuid");if(i&&(s.RequestId=i),s.Status=n.result.status,s.Success=!1,r){const e=function(e,t){const n=t.toLowerCase();return e.value.find((e=>e.Id.toLowerCase()===n))}(r,t.Id.toString());e&&(s.Success=!(e.Error||e.Status&&"Success"!==e.Status),e.Error?s.Error=e.Error.code:s.Success||(s.Error=e.Status),e.ServerId&&(s.ServerId=e.ServerId))}else o&&(s.Error=o.error.code);return s}function to(e,t,n,r,o){let s,i;t instanceof nr&&Fe(t.Data)?(s=so(Zr,t,Jr(e,t.Data)),i=t.Data.Id):(s=ro(Zr,t),i=t.Id),s.TryCount=n.tries.length;const a=n.result.headers.get("Request-Id");if(a&&(s.RequestId=a),s.Status=n.result.status,s.Success=!1,r){const e=function(e,t){const n=t.toLowerCase();return e.find((e=>e.Id.toLowerCase()===n))}(r,i.toString());e&&(s.Success=!e.Status||"Success"===e.Status,s.Success||(s.Error=e.Status))}else o&&(s.Error=o.error.code);return s}function no(e,t,n){const r=ro(Zr,e);r.TryCount=t.tries.length;const o=t.result.headers.get("Request-Id");return o&&(r.RequestId=o),r.Status=t.result.status,r.Success=t.result.ok,n&&(r.Error=n.error.code),r}function ro(e,t){return io(e,t)}function oo(e,t,n){const r=io(e,t);return r.Pipelines=n,r}function so(e,t,n){let r;return Fe(t.Data)?(r=oo(e,t.Data,n),r.ActivitySignalId=t.Id.toString()):r=ro(e,t),r}function io(e,t){const n={eventName:e,category:"Generic",TypeName:t.TypeName,ActivityId:t.Id.toString(),Age:new Date(Date.now()).valueOf()-t.Created.valueOf()};return t instanceof Zn&&(n.Action=t.Action),t instanceof pr&&(n.HasParent=t instanceof fr&&Fe(t.ParentAuthor),n.HasPreview=Fe(t.Preview),Fe(t.PreviewAbsenceReason)&&(n.PreviewAbsenceReason=t.PreviewAbsenceReason)),(t instanceof lr||t instanceof mr)&&(n.HasPreview=Fe(t.CommentPreview),Fe(t.CommentPreviewAbsenceReason)&&(n.PreviewAbsenceReason=t.CommentPreviewAbsenceReason)),n}async function ao(e,t){const n=e.logger?{...e,logger:new Dr("ActivityTransport",e.logger)}:e;t.forEach(vo.bind(null,n));const r=await async function(e,t){const n=[];for await(const r of async function*(e,t){const n=await async function(e){if(uo(e))try{return await Object(Rr.a)(e.tokenProvider,e)}catch(e){return}}(e),r=await async function(e){if(!uo(e))return;const{siteUrl:t,driveId:n,fileId:r}=e;try{return await Object(s.b)(e.tokenProvider,t,n,r)}catch(e){return}}(e);for(const s of t)if(n&&Po(s)){var o;const t=ro(Yr,s);null===(o=e.logger)||void 0===o||o.send(t),yield s}else if(Io(s)){const t=Jr(e,s);if(1&t){var i;const n=oo(Yr,s,t);null===(i=e.logger)||void 0===i||i.send(n),yield s}if(n&&r&&2&t){var a;const o=Gr(e,n,r,s),i=so(Yr,o,t);null===(a=e.logger)||void 0===a||a.send(i),yield o,s.SuppressSendToSubstrate=!0}}}(e,t))n.push(r);return n}(n,t);return(await Promise.all([fo(n,r.filter(Io)),mo(n,r.filter(Po))])).every((e=>e))}class co{constructor(e,t,n){this.provider=e,this.kind=t,this.id=n}}function uo(e){var t,n,r;return!!(null!==(t=e.senderIdentity)&&void 0!==t&&t.oid||null!==(n=e.senderIdentity)&&void 0!==n&&n.puid||lo(e)&&null!==(r=e.senderIdentity)&&void 0!==r&&r.cid)}function lo(e){return Lr(e,"EnableCidSupport",!0)}function po(e){return Lr(e,"UseInstrumentedAuthorizedFetchWithRetry",!0)}async function fo(e,t){if(t.length<1)return!0;const n=new Nr;n.Activities=t.map(Co);const r=Object(Er.a)(e.siteUrl),o={getToken:t=>{const n={...t,siteUrl:e.siteUrl,driveId:e.driveId,itemId:e.fileId};return e.tokenProvider.getToken([`${r}/files.readwrite.all`],n)},url:`${r}/_api/v2.1/drives/${e.driveId}/items/${e.fileId}/office_activityStream`,tenantId:e.tenantId,requestInit:{method:"PATCH",headers:{"Content-Type":"application/json"},body:n.toFacetJson(0)},retryPolicy:Mr.b,tokenPolicy:Object(Mr.a)(e.tokenProvider)},s=po(e)&&e.logger?await Object(jr.b)({...o,logger:e.logger,nameForLogging:"SendActivitiesToHost"}):await Object(jr.a)(o),i=await s.result.json();return function(e,t,n,r){const o=n.result.ok&&function(e){return Hr(e)&&Array.isArray(e.value)&&e.value.every(_r)}(r)?r:void 0,s=!n.result.ok&&Vr(r)?r:void 0;for(const r of t){var i;const t=eo(e,r,n,o,s);null===(i=e.logger)||void 0===i||i.send(t)}}(e,t,s,i),s.result.ok&&function(e){return Hr(e)&&Array.isArray(e.value)&&e.value.every(Br)}(i)}async function mo(e,t){if(t.length<1)return!0;try{return(await Promise.all(t.map(ho.bind(null,e)))).every((e=>e))}catch(e){return!1}}async function ho(e,t){if(!function(e){return Fe(e.Creator)&&Fe(e.Creator.RawIdKind)}(t))return!1;let n,r,o;const s=function(e){var t;switch(null===(t=e.environment)||void 0===t?void 0:t.audience){case"GCC":return"https://substrate.office365.us";case"GCC-High":case"DoD":return"https://substrate-dod.office365.us";default:return"https://substrate.office.com"}}(e),i=t instanceof nr;if(i){n=`${s}/signalpreprocessor/v1/office`;const e=new Or;e.Signals=[t],r=e,o=3}else n=`${s}/api/v2.0/me/signals`,r=t,o=2;const a={getToken:t=>e.tokenProvider.getToken([`${s}/Signals-Internal.ReadWrite`],t),url:n,tenantId:e.tenantId,requestInit:{method:"POST",headers:{"Content-Type":"application/json",Prefer:'exchange.behavior="SignalAccessV2,OpenComplexTypeExtensions"',"X-SignalInstanceId":t.Id.toString(),"X-AnchorMailbox":e.senderIdentity.upn},body:r.toFacetJson(o)},retryPolicy:{maxRetries:2,backoffFn:Object(kr.b)(500),filter:Object(Ur.c)([429,500])}},c=po(e)&&e.logger?await Object(jr.b)({...a,logger:e.logger,nameForLogging:"SendSignalToSubstrate"}):await Object(jr.a)(a),u=await c.result.json();return function(e,t,n,r,o){const s=!n.result.ok&&Vr(r)?r:void 0;if(o){const o=n.result.ok&&function(e){return Array.isArray(e)&&e.every(Kr)}(r)?r:void 0;for(const r of t){var i;const t=to(e,r,n,o,s);null===(i=e.logger)||void 0===i||i.send(t)}}else for(const r of t){var a;const t=no(r,n,s);null===(a=e.logger)||void 0===a||a.send(t);break}}(e,[t],c,u,i),i?c.result.ok&&function(e){return Array.isArray(e)&&e.every($r)}(u):c.result.ok}function vo(e,t){if(e.senderIdentity&&!t.Creator)if(lo(e)){const{provider:n,kind:r,id:o}=function(e,t){const{LiveId:n,ADAL:r}=_n,{OID:o,PUID:s,CID:i}=Kn,{oid:a,puid:c,cid:u}=t;if("Consumer"===e.identityType)return c?new co(n,s,c):u?new co(n,i,u):a?new co(n,o,a):new co(n);const d="Enterprise"===e.identityType?r:void 0;return a?new co(d,o,a):c?new co(d,s,c):u?new co(d,i,u):new co(d)}(e.tokenProvider,e.senderIdentity);t.Creator=new Hn,t.Creator.Id=o,t.Creator.Name=e.senderIdentity.name,t.Creator.Email=e.senderIdentity.upn,t.Creator.TenantId=e.senderIdentity.tenantId,t.Creator.RawProvider=n,t.Creator.RawId=t.Creator.Id,t.Creator.RawIdKind=r}else t.Creator=new Hn,t.Creator.Id=function(e){var t,n,r;return"Consumer"===e.tokenProvider.identityType&&null!==(t=e.senderIdentity)&&void 0!==t&&t.puid?e.senderIdentity.puid:null!==(n=e.senderIdentity)&&void 0!==n&&n.oid?e.senderIdentity.oid:null!==(r=e.senderIdentity)&&void 0!==r&&r.puid?e.senderIdentity.puid:void 0}(e),t.Creator.Name=e.senderIdentity.name,t.Creator.Email=e.senderIdentity.upn,t.Creator.TenantId=e.senderIdentity.tenantId,t.Creator.RawProvider=function(e){return"Consumer"===e.tokenProvider.identityType?_n.LiveId:"Enterprise"===e.tokenProvider.identityType?_n.ADAL:void 0}(e),t.Creator.RawId=t.Creator.Id,t.Creator.RawIdKind=function(e){var t,n,r;return"Consumer"===e.tokenProvider.identityType&&null!==(t=e.senderIdentity)&&void 0!==t&&t.puid?Kn.PUID:null!==(n=e.senderIdentity)&&void 0!==n&&n.oid?Kn.OID:null!==(r=e.senderIdentity)&&void 0!==r&&r.puid?Kn.PUID:void 0}(e)}function Co(e){const t=new br;return t.Activity=e,t.Id=e.Id,t}function Io(e){return e instanceof Qn}function Po(e){return e instanceof tr}var Ao,yo,go=n("y5lx"),wo=n("JC3W"),To=n("Ndf8");!function(e){e.AppContextError="AppContextError",e.MissingAuthorInformation="MissingAuthorInformation",e.NotificationActivityStreamError="NotificationActivityStreamError"}(Ao||(Ao={})),function(e){e.NotifyAtMention="NotifyAtMention",e.QueueAtMentionNotification="QueueAtMentionNotification"}(yo||(yo={}));class So{constructor(e){if(this.props=e,!this.props.fileId||!this.props.driveId||!this.props.siteUrl)throw new Error("Invalid file information: fileId, driveId or siteUrl might be missing")}get NotificationService(){return this}async notifyAtMention(e,t,n){const{siteUrl:r,driveId:o,fileId:s}=this.props;return this.sendNotification(e,t,n,yo.NotifyAtMention,{siteUrl:r,driveId:o,itemId:s,dataStorePath:t})}async queueAtMentionNotification(e){let{recipient:t,atMentionId:n,contentId:r,navigationPath:o,resolvedUrl:i,threadId:a}=e;const{siteUrl:c,driveId:u,fileId:d,appName:l,logger:p}=this.props,f={itemId:d,driveId:u,siteUrl:c},m=Object(wo.b)(this.props.settingsProvider)?Object(To.a)(f,i,p):f;let h,v;var C,I,P;i&&Object(s.e)(i)&&(h=null===(C=i.codeHint)||void 0===C?void 0:C.containerPackageName,v=await(null===(I=(P=this.props).getFileContext)||void 0===I?void 0:I.call(P,i,r)));const A={...m,dataStorePath:r,containerPackageName:h,appName:l,context:v};return Object(wo.b)(this.props.settingsProvider)&&i&&!Object(s.e)(i)&&(A.dataStorePath=""),this.sendNotification(t.userPrincipalName,r,o,yo.QueueAtMentionNotification,A,n,a)}getAppContext(e){let t,n;if(e)try{t={fluidComponents:JSON.parse(e)}}catch(e){n=e}return{appContext:t,appContextError:n}}async notifyOfficeActivityStream(e,t,n,o,s,i,a){const{correlationId:c}=this.props,u=Object(wo.b)(this.props.settingsProvider)?{...this.props,fileId:o.itemId,driveId:o.driveId,siteUrl:o.siteUrl}:{...this.props},d=Object(go.a)(o,{includeFluidSignature:Object(go.b)(o,this.props.settingsProvider)}),l=new Te;return l.Id=new m(Object(r.a)()),l.Created=l.Observed=new Date,l.SourceApp=_.FluidApp,l.SourcePlatform=K.Web,l.SourceSessionId=c?new m(c):v,l.SourceAppContext=s,l.ContentId=null!=i?i:t,l.NavigationId=d,l.CommentThreadId=a,l.Action=q.Create,l.Mentionee=new ne,l.Mentionee.Email=e,l.CommentPreviewAbsenceReason=te.UnsupportedClient,n.addAdditionalProps({activityId:l.Id.toString(),contentId:l.ContentId}),await ao(u,[l])}async sendNotification(e,t,n,r,s,i,a){const c=o.a.start("NotifyOfficeActivityStream",this.props.logger);if(!e)return c.setResult(!1,{navigationPath:n.length>0,entryPoint:r,errorType:Ao.MissingAuthorInformation}),!1;const{appContext:u,appContextError:d}=this.getAppContext(n);try{const o=await this.notifyOfficeActivityStream(e,t,c,s,u,i,a);return c.setResult(o&&!d,{appContextSent:!!u,notifyActivity:o,navigationPath:n.length>0,entryPoint:r,...d&&{errorType:Ao.AppContextError}},d),o}catch(e){return c.setResult(!1,{appContextSent:!!u,notifyActivity:!1,navigationPath:n.length>0,entryPoint:r,errorType:Ao.NotificationActivityStreamError},e),!1}}}},JC3W:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n("5+n6");function o(e){return Object(r.a)("share.pageLinkWithoutFluidSignature",!1,e)}function s(e){return Object(r.a)("share.isResolvedUrlUsedForLocator",!1,e)}},Ndf8:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("ef5c"),o=n("a9wj");const s="GetDocumentInfoError",i=(e,t,n)=>{var i;if(!t)return n&&Object(r.c)(n,{eventName:s}),e;if(!Object(o.e)(t)){const t=new Error("Invalid file information: ResolvedUrl is not of the expected ODSP type");return n&&Object(r.b)(n,{eventName:s},t),e}return{driveId:t.driveId,siteUrl:t.siteUrl,itemId:t.itemId,containerPackageName:null===(i=t.codeHint)||void 0===i?void 0:i.containerPackageName}}},RdgM:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("a9wj");async function o(e,t,n){const{siteUrl:o,driveId:s,fileId:i}=t,a=await Object(r.b)(e,o,s,i,n);if(!a)throw new Error("Failed to fetch file sharepoint ids");return function(e,t){const{siteId:n,webId:r,listId:o}=e;return`SPO_${function(e){return function(e){return e.replace(/(\+|\/|\=)/g,(e=>{if("+"===e)return"-";if("/"===e)return"_";if("="===e)return"";throw new TypeError(`Unexpected match ${e} encountered in urlEncodeBase64String. Only +/= are to be replaced.`)}))}(window.btoa(e))}(`${n},${r},${o}`)}_${t}`}(a,i)}},y5lx:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return i}));var r=n("ZaV9"),o=n("JC3W");function s(e,t){return!Object(o.a)(t)||"@fluidx/loop-page-container"!==e.containerPackageName||!e.context}function i(e,t){const n=Object(r.a)(e);if(t.includeFluidSignature)return n;const o=new URLSearchParams(atob(n));return o.delete("fluid"),btoa(o.toString())}}}]);
//# sourceMappingURL=731.a2f88d135cf3c1890832.chunk.v7.js.map