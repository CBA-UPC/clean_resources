!function(){var t,e,n,r,o={7518:6990:function(t,e,n){"use strict";n.d(e,{_f:function(){return u},n$:function(){return a},He:function(){return i},_Z:function(){return o}});var r=n(1771),o=function(t){if(null==t||!t.assistant)return new Error("Missing one or more of the required properties: assistant")},i=function(t){var e=t.lang,n=(0,r.a6)(e),o="/c/v1/chat/assistant/init";return n&&(o="".concat(o,"?lang=").concat(n)),o},a=function(t){return"/c/v2/chat/assistant/sessions/".concat(t,"/deflections")},u=new Map},4788:function(t,e,n){"use strict";n.d(e,{fj:function(){return f},$H:function(){return l},Yj:function(){return s}});var r=n(4578),o=n(1965),i=n(8898);function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){c(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var s=function(t){var e=t.attributes,n=t.custom,o=function(t){var e=null==t?void 0:t.attributes,n=null==t?void 0:t.custom;return e||n?e?function(t){var e,n=["emails","phones","socials"];return Object.entries(t).every((function(t){var r,o,i=t[0],a=t[1];return n.includes(i)?!("socials"===i&&(o=["twitter","instagram","facebook","linkedin"],a.every((function(t){return t.type&&t.username?!!o.includes(t.type)||(r=new Error("".concat(t.type," is not a valid social type. Socials must be one of: twitter, instagram, linkedin, facebook")),!1):(r=new Error("Social is missing one or more of the required properties: username, type"),!1)})),e=r)):(e=new Error("".concat(i," is not a valid attribute. Attributes must contain at least one of: emails, phones, socials")),!1)})),e}(e):void 0:new Error("Missing one or more of the required properties: attributes, customAttributes")}(t);return o?Promise.reject(o):(0,r.r$)("/c/v1/customers/current",{body:JSON.stringify(u(u({},e),{},{custom:n}))})},l=function(){return(0,r.U2)("/c/v1/chat/customers/current").then((function(t){return(0,o.ow)("customerContext",function(t){var e,n,r,o,i,a,u=(null==t||null===(e=t.data)||void 0===e?void 0:e.attributes)||{},c=u.activityAt,s=u.createdAt,l=u.lastMessageAt,f=u.lastMessageSentAt,d=u.lastOutboundMsgSentAt,v=u.lastSeenAt,p=u.signedUpAt,b=u.lastMessageUnrespondedTo,h=u.avgSatisfactionRating,g=u.avgSatisfactionScore,m=u.name,y=u.email,w=u.phone,O=u.sentiment,_=u.company,j=u.custom,P=(null==t||null===(n=t.data)||void 0===n||null===(r=n.attributes)||void 0===r?void 0:r.conversationCount)||{};return{activityAt:c,createdAt:s,lastMessageAt:l,lastMessageSentAt:f,lastMessageOutSentAt:d,lastSeenAt:v,signedUpAt:p,lastMessageUnrespondedToSentAt:b,satisfactionLevel:{avgRating:h,avgScore:g},conversationCounts:{all:P.all,done:P.done,open:P.open,snoozed:P.snoozed},name:m,email:y,phone:w,sentiment:O,company:_,createdBy:((null==t||null===(o=t.data)||void 0===o||null===(i=o.relationships)||void 0===i||null===(a=i.createdBy)||void 0===a?void 0:a.data)||{}).id,custom:j}}(t)),t}))},f=function(t){return(0,r.U2)(i.Dw).then((function(e){var n=e.data.attributes,r={total:n.totalUnreadCount,conversations:u({},n.sessionsWithUnreads)};return(0,o.t0)(r),"function"==typeof t&&t(),r}))}},4502:function(t,e,n){"use strict";n.d(e,{tn:function(){return d},Fq:function(){return b},MJ:function(){return p},rD:function(){return v}});var r=n(288),o=n(4578);function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var a=function(t){if(null==t||!t.length)return Promise.reject();var e=function(t){return t.find(()?new Error("Attachment is missing one or more of the required properties: file"):function(t){var e,n=0;return t.every((function(t){return n+=t.size,e=function(t){if(t.size>5e6)return new Error("Individual attachment file size is greater than 5MB")}(t),!e})),e||(n>9e6?new Error("Total attachments file size is greater than 9MB"):void 0)}(t.map((function(t){return t.file})))||void 0}(t);if(e)return Promise.reject(e);var n=t.reduce((function(t,e){var n,a,u,c=(a=(n=e).file,(0,r.J)().then((function(){var t;return(0,o.v_)("/c/v1/chat/attachments",{body:JSON.stringify({contentLength:a.size,contentType:a.type,name:a.name})}).then((function(e){return t=e,function(t,e){var n;if(null==e||null===(n=e.meta)||void 0===n||!n.upload)return Promise.reject();var r=e.meta.upload,i=r.fields,a=r.url,u=new FormData;return Object.entries(i).forEach((),u.append("file",t.file),(0,o.p7)(a,u)}(n,e)})).then((function(){return t}))})));return[].concat(function(t){if(Array.isArray(t))return i(t)}(u=t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(u)||function(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}(u)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[c])}),[]);return Promise.all(n)},u=n(1771),c=function(t,e){var n=t.lang,r=(0,u.a6)(n);return r?"".concat(e,"?lang=").concat(r):e};function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){f(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function f(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var d=function(t,e){var n=function(t,e){if(!t)return new Error("A conversationId must be provided.");var n=null==e?void 0:e.body,r=null==e?void 0:e.attachments;return n||null!=r&&r.length?void 0:new Error("Message is missing one or more of the required properties: body or attachments")}(t,e);if(n)return Promise.reject(n);var i=null==e?void 0:e.body,u=null==e?void 0:e.payload,s=null==e?void 0:e.attachments,f=null==e?void 0:e.lastDeflection,d=null==e?void 0:e.isInAssistantMode,v=null==e?void 0:e.initAssistantPayload;return(0,r.J)().then((function(){if(null!=s&&s.length)return a(s)})).then((function(n){var r,a;n&&(a=n.map(());var s={session:t,body:i,payload:u,lastDeflection:f,attachments:a,assistant:null==v?void 0:v.assistant,dialog:null==v?void 0:v.dialog,node:null==v?void 0:v.node,initialMessages:null==v?void 0:v.initialMessages},p=null!=e&&null!==(r=e.assistantOptions)&&void 0!==r&&r.emulation?l(l({},s),{},{assistantOptions:null==e?void 0:e.assistantOptions}):s;return d?(0,o.v_)(c(e,"/c/v2/chat/assistant/messages"),{body:JSON.stringify(p)}):(0,o.v_)(c(e,"/c/v2/chat/messages"),{body:JSON.stringify({session:t,body:i,payload:u,lastDeflection:f,attachments:a})})}))},v=function(t){return(0,o.U2)(t))},p=function(t,e){return(0,o.U2)(function(t,e){var n="/c/v2.1/chat/sessions/".concat(t,"/messages?count=").concat(e.count);return e.before?"".concat(n,"&before=").concat(e.before):n}(t,e))},b=function(t){return new Promise(()}},7882:function(t,e,n){"use strict";n.d(e,{EI:function(){return i},jI:function(){return a},yW:function(){return o}});var r=n(1771),o=function(t,e){if(!t)return new Error("A satisfactionId must be provided.");var n=e.rating,r=e.answers;return r&&r.find(()?new Error("Answers cannot exceed 1024 characters"):n&&("number"!=typeof n||n>10||n<1)?new Error("Rating must be a number between 1 and 10"):void 0},i=function(t,e,n){var r,o,i,a,u,c,s={},l=null==t||null===(r=t.relationships)||void 0===r||null===(o=r.conversation)||void 0===o||null===(i=o.data)||void 0===i?void 0:i.id,f=null==t||null===(a=t.relationships)||void 0===a||null===(u=a.session)||void 0===u||null===(c=u.data)||void 0===c?void 0:c.id;if(!t||!n||!l&&!f)return s;var d=t.id,v=t.attributes,p=v.rating,b=v.answers,h=v.createdAt,g=v.lockedAt;s.conversationId=l||f,s.satisfactionId=d;var m=h;if(e){var y=Number(e)/1e4;m=new Date(y).toISOString()}if(s.timetoken=m,s.lockedAt=g,s.response={rating:p,answers:b},n){var w=n.attributes,O=w.description,_=w.introduction,j=w.name,P=w.questions,I=w.ratingPrompt,k=w.scale;s.form={description:O,introduction:_,name:j,questions:P,ratingPrompt:I,scale:k}}return s},a=function(t,e){var n=(0,r.a6)(e),o="/c/v3/chat/satisfaction-responses/".concat(t,"?include=satisfaction");return n&&(o+="&lang=".concat(n)),o}},5123:8898:2218:function(t,e,n){"use strict";n.d(e,{ed:function(){return p},Gg:function(){return h},Rx:function(){return b},CT:function(){return g},Ly:function(){return m}});var r=n(1965),o=n(288),i=n(4578),a=n(7763),u=n(1771),c=n(8898),s=function(t){if(!t)return new Error("A conversationId must be provided.")},l=function(t){return"/c/v2/chat/sessions/".concat(t)};function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){v(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function v(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var p=function(t){var e=function(t){var e=null==t?void 0:t.title;if(e&&(0,a.HD)(e)&&e.length>256)return new Error("Title must be less than or equal to 256 characters")}(t);return e?Promise.reject(e):(0,o.J)().then((function(){return(0,i.v_)(function(t){var e=null==t?void 0:t.lang,n=(0,u.a6)(e);return n?"/c/v2.1/chat/sessions?lang=".concat(n):"/c/v2.1/chat/sessions"}(t),{body:JSON.stringify({title:t.title,assistant:t.assistant,brand:t.brand,custom:t.custom})}).then((function(t){var e=t.data.relationships.customer.data.id;return(0,r.ow)("customerId",e),(0,r.vV)(t.data),t}))}))},b=function(t){return(0,i.U2)((e=t,n=c.cA,o=null==e?void 0:e.page,a=null==e?void 0:e.pageSize,u=null==e?void 0:e.brandId,s=[],o&&s.push("page=".concat(o)),a&&s.push("pageSize=".concat(a)),u&&s.push("brandId=".concat(u)),s.length&&(n="/c/v2/chat/sessions?".concat(s.join("&"))),n)).then((function(t){var e=null==t?void 0:t.data.filter((function(t){var e,n=null==t||null===(e=t.attributes)||void 0===e?void 0:e.pubnub;return n&&!(null!=n&&n.error)}));return null==e||e.forEach((function(t){(0,r.vV)(t)})),d(d({},t),{},{data:e})}));var e,n,o,a,u,s},h=function(t){var e=s(t);return e?Promise.reject(e):(0,i.U2)(l(t)).then((function(t){return(0,r.vV)(t.data),t}))},g=function(t,e){var n=s(t);return n?Promise.reject(n):(0,i.gz)(l(t),{body:JSON.stringify(e)}).then(()},m=function(t){var e=null==t?void 0:t.body;return(0,i.r$)(function(t){var e=null==t?void 0:t.sessionId,n=null==t?void 0:t.messageIds;return"/c/v2/chat/sessions/".concat(e,"/messages/").concat(n)}(t),{body:JSON.stringify(e)})}},288:function(t,e,n){"use strict";n.d(e,{X:function(){return a},J:function(){return u}});var r,o=n(5238),i=n(4578),a=function(){return(0,i.U2)("/c/v1/tracking/tokens/current").then((function(t){var e=t.data.attributes.token;return(0,o.NM)(e),t}))},u=function(){return(0,o.qc)()?Promise.resolve():r||(r=a().then(())}},5022:function(t,e,n){"use strict";n.d(e,{Hh:function(){return i}});var r="https",o=null==="https://api.kustomerapp.com"?void 0:"https://api.kustomerapp.com".replace("".concat(r,"://"),""),i=,162:function(t,e,n){"use strict";n.d(e,{d:function(){return f}});var r=n(5022);function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var u,c=function(t){try{if(!t)throw new Error;var e=(o=t.split("."),i=2,o)||o,i)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}(o,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),n=(e[0],e[1]),r=JSON.parse(atob(n));return function(t){["orgName"].every(()||console.error("You've provided an invalid Kustomer api key.")}(r),r}catch(t){return console.error("You've provided an invalid Kustomer api key."),{}}var o,i}(null===(u=window.parent.KustomerCore)||void 0===u?void 0:u.a),s=c.orgName,l=c.pod,f=function(){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({pod:l,orgName:s},(0,r.Hh)())}},3701:function(t,e,n){"use strict";n.d(e,{F:function(){return a},j:function(){return i}});var r=n(7518),o=n(1965),i=function(t){return!![r.bp,r.P5,r.LC,r.wK,r.$t,r.YN,r.hv,r.cZ,r.fK,r.NX,r.Xk,r.pg,r.s0,r.Oz].includes(t)||(console.error("Provided Kustomer event type is invalid: ".concat(t)),!1)},a=function(t,e,n){var r=(0,o.bh)().listeners[t];null!=r&&r.length&&r.forEach(()}},7763:function(t,e,n){"use strict";function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n.d(e,{HD:function(){return a},Ku:function(){return u},jV:function(){return i},yo:function(){return o}});var o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=t);if(e<=0)return n;for(;o.length;)n.push(o.splice(0,e));return n},i=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return t.filter(()},a=u=function(){var t=window;if(!t||!t.KustomerMain)throw Error("KustomerMain object not found");return t.KustomerMain}},5731:function(t,e,n){"use strict";n.d(e,{$j:function(){return w},CC:function(){return y},D9:function(){return s},HT:function(){return l},I0:function(){return O},P:function(){return i},Px:function(){return p},Ry:function(){return c},VJ:function(){return j},ad:function(){return g},bf:function(){return v},h0:function(){return _},jy:function(){return f},mW:function(){return u},oU:function(){return d},oV:function(){return a},q1:function(){return o},sO:function(){return m},vt:function(){return b},xU:function(){return h},yz:function(){return r}});var r="PNSubscribeOperation",o="PNAccessDeniedCategory",i="PNReconnectedCategory",a="PNNetworkUpCategory",u="PNNetworkDownCategory",c=["PNNetworkIssuesCategory","PNBadRequestCategory",o],s="kustomer.app.chat.session.end",l="kustomer.assistant.chat.session.end",f="kustomer.app.chat.message.receive",d="kustomer.app.chat.message.send",v="kustomer.app.chat.session.update",p="kustomer.app.chat.session.delete",b="kustomer.app.chat.csat.send",h="kustomer.app.chat.csat.submit",g="kustomer.app.chat.session_merge.create",m="kustomer.customer.delete",y="user-typing",w="user-typing-ended",O="ai-assistant-user-typing",_="customer-typing-ended",j="customer-typing"},6612:function(t,e,n){"use strict";n.d(e,{BD:function(){return r},mg:function(){return o},xu:function(){return i}});var r=function(t,e){return"ext-convo-group-".concat(e,".cust-").concat(t)},o=function(t,e){return"ext-meta-cust-".concat(e,".cust-").concat(t)},i=,4578:function(t,e,n){"use strict";n.d(e,{U2:function(){return p},gz:function(){return h},p7:function(){return d},r$:function(){return g},v_:function(){return b}});var r=n(5238),o=n(1965),i=n(5123),a=n(162),u=n(6100);function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var f=function(t){if("No Content"!==t.statusText){var e=t.headers.get("content-type");return e&&e.includes("application/json")?t.ok?null==t?void 0:t.json():function(t){return t.json().then((function(e){var n=function(t){var e,n,r=t[0],o=null==r||null===(e=r.meta)||void 0===e||null===(n=e.subErrors)||void 0===n?void 0:n[0],i=r.title,a=r.code,u=r.source;if(o){var c=o.title;return{code:o.code,title:c,source:o.source.pointer}}return{source:(null==u?void 0:u.parameter)||(null==u?void 0:u.pointer),title:i,code:a}}(e.errors),r="".concat(null==t?void 0:t.status," ").concat(null==t?void 0:t.statusText," to ").concat(null==t?void 0:t.url);"badparam"===n.code&&(r="".concat(null==n?void 0:n.title,": ").concat(null==n?void 0:n.source));var o=new Error(r);throw o.title=null==n?void 0:n.title,o.status=t.status?"".concat(t.status):"",o.source=null==n?void 0:n.source,o.url=null==t?void 0:t.url,o.type=null==t?void 0:t.type,o}))}(t):null}},d=function(t,e){return fetch(t,{method:"POST",body:e}).then((function(t){return f(t)}))},v=function(t,e){var n,c=(0,a.d)(),l=c.protocol,d=c.orgName,v=c.baseUrlDomain;if(void 0===d)return Promise.reject(new Error("Missing org"));var p=(0,o.bh)(),b=null==p||null===(n=p.settings)||void 0===n?void 0:n.enabled,h=[i.h];if(!1===b&&!h.includes(t))return Promise.reject(new Error("Could not complete request because Kustomer Chat is disabled in your org settings"));var g="".concat(l,"://").concat(d,".").concat(v).concat(t),m=function(t){var e=(0,r.qc)()||"",n=new Headers({"Content-Type":"application/json","x-kustomer":"kustomer","x-kustomer-client":"chat-web","x-kustomer-tracking-token":e,credentials:"include"});return s(s({},t),{},{headers:n})}(e),y=(0,u.v3)(t,null==e?void 0:e.method);return null!=e&&e.ignoreTracking||(0,u.Dg)({name:y}),fetch(g,m).then((function(t){return f(t)})).finally((function(){null!=e&&e.ignoreTracking||(0,u.a4)({name:y})}))},p=function(t,e){var n=s({method:"GET"},e);return v(t,n)},b=function(t,e){var n=s({method:"POST"},e);return v(t,n)},h=function(t,e){var n=s({method:"PUT"},e);return v(t,n)},g=function(t,e){var n=s({method:"PATCH"},e);return v(t,n)}},2098:function(t,e,n){"use strict";n.d(e,{t:function(){return r}});var r=function(t){var e=t.id,n=t.attributes;return{conversationId:e,createdAt:n.createdAt,ended:!!n.lockedAt}}},2473:function(t,e,n){"use strict";n.d(e,{a:function(){return r},h:function(){return o}});var r=function(t){var e=t.attributes,n=e.htmlBody,r=e.metaDescription,o=e.title,i=e.article,a=e.updatedAt,u=e.lang,c=e.slug,s=e.hash,l=e.kbUrl,f=e.knowledgeBaseId;return{articleId:"string"==typeof i?i:null==i?void 0:i._id,htmlBody:n,title:o,description:r,updatedAt:a,lang:u,slug:c,hash:s,version:t.id,kbUrl:l,knowledgeBaseId:f}},o=function(t){return{articles:t}}},828:function(t,e,n){"use strict";n.d(e,{f:function(){return a},q:function(){return u}});var r=n(7518),o=n(3701),i=n(1965),a=function(t){if(!t)return new Error("A conversationId must be provided.")},u=function(t){var e=(0,i.v7)(),n={total:e.total,change:{conversationId:t,count:e.conversations[t]}};(0,o.F)(r.wK,n)}},1277:function(t,e,n){"use strict";n.d(e,{X:function(){return c}});var r=n(1965),o=n(2473);function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var c=function(t,e,n){var i,u,c,s,l,f,d,v=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"pubnub",p=null==n?void 0:n.find((function(t){return"user"===t.type})),b=null==p?void 0:p.attributes;if(b){var h=null==p?void 0:p.id;(0,r.u6)(h,b)}else{var g,m,y;b=(0,r.rU)(null==t||null===(g=t.relationships)||void 0===g||null===(m=g.sentBy)||void 0===m||null===(y=m.data)||void 0===y?void 0:y.id)}var w,O=null==n?void 0:n.find((function(t){return"template"===t.type})),_=null==n||null===(i=n.filter((function(t){return"article"===t.type})))||void 0===i?void 0:i.map(o.a),j=t.id,P=t.attributes,I=t.relationships;null!=e&&e.length&&(w=e.map((function(t){return function(t){var e=t.links.related,n=t.id,r=t.attributes;return{url:e,attachmentId:n,contentLength:r.contentLength,contentType:r.contentType,name:r.name}}(t)})));var k=P.appGenerated,S=P.auto,A=P.body,D=P.bodyOverride,E=P.createdAt,C=P.direction,M=P.directionType,N=P.titleOverride,T=P.meta,$=I.session.data.id,x=null===(u=I.sentBy)||void 0===u||null===(c=u.data)||void 0===c?void 0:c.type,U=null===(s=I.sentBy)||void 0===s||null===(l=s.data)||void 0===l?void 0:l.id,B=null===(f=b)||void 0===f?void 0:f.displayName,F=null===(d=b)||void 0===d?void 0:d.avatarUrl;return{appGenerated:k,messageId:j,body:A,createdAt:E,direction:C,directionType:M,conversationId:$,attachments:w,isInAssistantMode:Boolean(null==T?void 0:T.assistant),meta:{template:O&&a(a({},null==O?void 0:O.attributes),{},{id:null==O?void 0:O.id}),articles:_},notificationOverrides:{bodyOverride:D,titleOverride:N},sentBy:{type:S?"user":x,id:U,displayName:B,avatarUrl:F},source:v}}},1965:function(t,e,n){"use strict";n.d(e,{Bv:function(){return v},Gi:function(){return b},HA:function(){return j},TT:function(){return y},aN:function(){return m},bh:function(){return l},oc:function(){return d},ow:function(){return f},rU:function(){return _},t0:function(){return h},u6:function(){return O},v7:function(){return w},vV:function(){return p}});var r=n(6990);function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var c={listeners:{},sessions:{},unreadCounts:{conversations:{},total:0},users:{}},s=c,l=function(){return s},f=d=function(t,e){var n,r=s.listeners[t]||[];s=a(a({},s),{},{listeners:a(a({},s.listeners),{},u({},t,[].concat((n=r,function(t){if(Array.isArray(t))return o(t)}(n)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),[e])))})},v=function(t,e){var n=s.listeners[t];null!=n&&n.length&&(s=a(a({},s),{},{listeners:a(a({},s.listeners),{},u({},t,n.filter(()))}))},p=function(t){s=a(a({},s),{},{sessions:a(a({},s.sessions),{},u({},t.id,t))})},b=h=g=function(t,e,n){s=a(a({},s),{},{unreadCounts:{total:e,conversations:a(a({},s.unreadCounts.conversations),{},u({},t,n))}})},m=function(t){var e=s.unreadCounts.conversations[t],n=s.unreadCounts.total;g(t,n>0?n-e:0,0)},y=function(t){var e=s.unreadCounts.conversations[t]||0,n=s.unreadCounts.total||0;g(t,n+1,e+1)},w=function(){return s.unreadCounts},O=function(t,e){s=a(a({},s),{},{users:a(a({},s.users),{},u({},t,e))})},_=function(t){return s.users[t]},j=function(){f("customerId",void 0),f("externalId",void 0),f("email",void 0),f("verified",void 0),f("sessions",{}),f("users",{}),f("unreadCounts",c.unreadCounts),r._f.clear()}},3866:function(t,e,n){"use strict";n.d(e,{S:function(){return u}});var r=n(4158);function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var u=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.message,o=e.tags;return console.error(n,t),(0,r.Tb)(t,{tags:i({errorBoundary:!1},o)})}},6100:function(t,e,n){"use strict";n.d(e,{z_:function(){return h},Dg:function(){return g},a4:function(){return m},v3:function(){return p}});var r=n(5022),o=n(5238);function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}unction l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var f,d=function(){function t(e){var n=this;!this,t),l(this,"events",[]),l(this,"runningTimers",new Map),setInterval((,3e3),this.orgName=e}var e,n;return e=t,n=[{key:"setOrgName",value:,{key:"pushData",value:function(){0!==this.events.length&&this.orgName&&(("kustomer"===this.orgName||this.orgName.startsWith("zzz-")||this.orgName.startsWith("mikerapin"))&&function(t,e){if(!e)return Promise.reject(new Error("Missing org"));var n=(0,r.Hh)(),i=n.protocol,u=n.baseUrlDomain,c={body:t,method:"POST"},s="".concat(i,"://").concat(e,".").concat(u).concat("/c/v1/chat-events"),l=function(t){var e=(0,o.qc)()||"",n=new Headers({"Content-Type":"application/json","x-kustomer":"kustomer","x-kustomer-client":"chat-web","x-kustomer-tracking-token":e,credentials:"include"});return a(a({},t),{},{headers:n})}(c);fetch(s,l)}(JSON.stringify(this.events),this.orgName),this.events=[])}},{key:"createEvent",value:function(t){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({surface:"web",timestamp:Date.now()},t)}},{key:"countEvent",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";e<1||this.events.push(this.createEvent({context:n,count:e,name:t}))}},{key:"timeEventStart",value:,{key:"timeEventStop",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.runningTimers.has(t)||console.error("There is no timer event being tracked with name: ".concat(t));var n=this.runningTimers.get(t);this.events.push(this.createEvent({name:t,duration:Date.now()-n,context:e}))}}],n&&s(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),v=function(t){if(!t)return"";try{var e=t.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),n=decodeURIComponent(window.atob(e).split("").map(().join(""));return JSON.parse(n)}catch(t){return""}},p=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=t.substring(1,t.indexOf("?")>-1?t.indexOf("?"):t.length).replaceAll(/[0-9a-z]{24}\/?/g,"").replaceAll("/","_").replaceAll(/[,|.]/g,"").replace(/_$/g,""),r=e.toLowerCase();return"api.".concat(r,".").concat(n,".timer")},b=function(t){return f||(f=new d(t)),!f.orgName&&t&&f.setOrgName(t),f},h=function(t){var e=t.name,n=t.count,r=void 0===n?1:n,o=t.context,i=t.apiKey,a=i?v(i).orgName:null;b(a).countEvent(e,r,o)},g=function(t){var e=t.name,n=t.apiKey,r=n?v(n).orgName:null;b(r).timeEventStart(e)},m=function(t){var e=t.name,n=t.context,r=t.apiKey,o=r?v(r).orgName:null;b(o).timeEventStop(e,n)}},4158:function(t,e,n){"use strict";function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}unction i(t,e){return Promise.all([o(),Promise.all([n.e("vendors-node_modules_sentry_utils_esm_misc_js-node_modules_sentry_utils_esm_normalize_js-node-4b6837"),n.e("sentryHttpClient")]).then(n.bind(n,1195))]).then((function(n){var o,i,a=(i=2,function(t){if(Array.isArray(t))return t}(o=n)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],a=!0,u=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){u=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(u)throw o}}return i}}(o,i)||function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}(o,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=a[0],c=a[1].HttpClient;return u.getCurrentHub().getClient()||u.init({dsn:"https://".concat(t,"@o38471.ingest.sentry.io/6150287"),environment:"production",release:"release-v0.1.369",initialScope:{tags:{orgId:e}},beforeSend:function(t){var e,n;return null!==(e=t.exception)&&void 0!==e&&null!==(n=e.values)&&void 0!==n&&n.length&&!t.exception.values[0].stacktrace?null:t},integrations:[new c({failedRequestStatusCodes:[400,599]})],ignoreErrors:["TypeError: Failed to fetch","TypeError: NetworkError when attempting to fetch resource.","TypeError: cancelled","TypeError: Abgebrochen","TypeError: Kumottu","TypeError: annullato","TypeError: annulleret","TypeError: avbrutt","TypeError: geannuleerd","TypeError: poništeno","TypeError: vazgeçildi","TypeError: visszavonva","TypeError: скасовано","TypeError: ถูกยกเลิก","TypeError: キャンセルしましn o().then((function(n){return n.captureException(t,e)}))}n.d(e,{Tb:function(){return a},j6:function(){return i}})},5238:function(t,e,n){"use strict";n.d(e,{NM:function(){return r},Oq:function(){return i},fo:function(){return a},qc:function(){return o}});var r=function(t){try{localStorage.setItem("kustomer-chat-tracking-token",t)}catch(t){throw new Error("Setting tracking token in local storage")}},o=function(){try{return localStorage.getItem("kustomer-chat-tracking-token")}catch(t){throw  new Error("Removing tracking token from local storage")}},a=function(){var t=window.navigator.userAgent.toLowerCase();return!!/iphone|ipod|ipad/.test(t)&&"standalone"in window.navigator&&window.navigator.standalone}},1771:function(t,e,n){"use strict";n.d(e,{a6:function(){return c}});var r=n(9625),o=n(1338),i=n(7330),a=(n(7380),function(){var t,e=window.navigator;return(0,r.BY)()?null==e?void 0:e.browserLanguage:null==e||null===(t=e.languages)||void 0===t?void 0:t[0]}),u=function(t){var e=t.toLowerCase(),n=e.replace("-","_");return-1===n.indexOf("_")?e:i.a[n]?n:n.split("_")[0]},c=function(t){var e,n;if(t)return i.a[t];var r=null===(e=(0,o.W)())||void 0===e||null===(n=e.startParameters)||void 0===n?void 0:n.lang,c=r&&"string"==typeof r&&u(r);if(c&&i.a[c])return i.a[c];var s=u(a());return i.a[s]}},7330:function(t,e,n){"use strict";n.d(e,{a:function(){return r}});var r={af:"af",ar:"ar",be:"be",bg:"bg",bs:"bs",ca:"ca",he:"he",cs:"cs",da:"da",de:"de",nl:"nl",el:"el",en:"en_us",en_us:"en_us",en_ca:"en_ca",en_gb:"en_gb",es:"es",es_es:"es_es",et:"et",fi:"fi",fil:"fil",fr:"fr",fr_ca:"fr_ca",hi:"hi",hr:"hr",hu:"hu",id:"id",is:"is",it:"it",ja:"ja",ka:"ka",kk:"kk",ko:"ko",ky:"ky",lt:"lt",lv:"lv",no:"no",pa:"pa",pl:"pl",pt:"pt",pt_br:"pt_br",ro:"ro",ru:"ru",sk:"sk",sl:"sl",sq:"sq",sr:"sr",sv:"sv",sw:"sw",th:"th",tr:"tr",tw:"zh_tw",uk:"uk",ur:"ur",uz:h_cn",zh_cn:"zh_cn",zh_tw:"zh_tw"}},7380:function(t,e,n){},9625:function(t,e,n){"use strict";n.d(rAgent;return t.indexOf("MSIE")>0||t.indexOf("Trident")>0},o=function(){return r()?Promise.all([n.e("intl-relativetimeformat"),n.e("vendors-node_modules_formatjs_intl-getcanonicallocales_polyfill_js-node_modules_formatjs_inrn"An error occurred while loading polyfills, ".concat(t)})):Promise.resolve()}},1338:functioneturn funct+])];r o[t].calurn t.default}:function(etPrototypeOf?function(t){return Objn[t]t,n)&&Objecys(a.f).reduce((function(e,n){return a.f[n](t,e),e}),[]))},a.u=function(t){return t+"."+{"intl-relativetimeformat":"e085617b6ab95cb93a7a","vendors-node_modules_formatjs_intl-getcanonicallocales_polyfill_js-node_modules_formatjs_intl-64af64":"dae5fbe167debc297a24",polyfills:"a96963bdca6494292bb9","vendors-node_modules_sentry_utils_esm_misc_js-node_modules_sentry_utils_esm_normalize_js-node-4b6837":"feca650c7f06a927aee1",sentry:"38abdae46bbdbc710769",sentryHttpClient:"830937f39ae01b23d0c2",locale_en:"e51676e8b000b7c63fe7",lang_es:"6934057c432fb91acd95",locale_es:"881aee7709f2f6d390be",lang_fr:"ec2fb30ea1fcbed4c04e",locale_fr:"9924a8130543889f9882",lang_de:"fefac94135f0e0f65ce6",locale_de:"37f760571a4fa7dc8f7f",lang_pt:"eadc193ce6f7aa7950c3",locale_pt:"9a15228f497904f307c7",lang_ar:"66394ca78b6fde56fc04",locale_ar:"ffadc92ab135a0fbcefa",lang_he:"e803e3cc8fa2b55e10b5",locale_he:"fadfea0a8160ab23993c",lang_af:"d9bdb2966b849e1b3a62",loclae_af:"2e9b967fd8788991e6ad",lang_be:"3409416e031cd331f1e5",locale_be:"73485712d757c544a008",lang_bg:"d49b13bdc6570f6441a5",locale_bg:"d317169bdf9af940b7ab",lang_bs:"d031ed5d2078b5b12ccb",locale_bs:"fc5fbba1cb144af28bbb",lang_ca:"233855531410898b4936",locale_ca:"eae93f0036fb09688bb7",lang_cs:"16f50e933b25ca4038fd",locale_cs:"2b599fc647ecd2447d95",lang_da:"721e753aec466ce050af",locale_da:"3fcd4f4ad6c6af08041f",lang_nl:"71859ca089fbcfd50476",locale_nl:"79064fc6ff6d0f33264b",lang_el:"7210f11f0a87ed774e96",locale_el:"32aee654b1b9d72c0fd1",lang_et:"159c7a4d0cc9059af718",locale_et:"15f28e4b0c2fccb88365",lang_fi:"235799b438b501302088",locale_fi:"349ab8c58a7cd8d96d2c",lang_fil:"8cc9539621c85da26363",locale_fil:"85747a2ef5622aa3a33f",lang_hi:"ddc626a4b94daad629ac",locale_hi:"12e5f7a61f4f5e8d8b6a",lang_hr:"cbae61414212ee10ae20",locale_hr:"f89177599e2f3f94eca6",lang_hu:"b1400eb4264ed42b06fc",locale_hu:"c178227c5a27e9782685",lang_id:"0100895f0e23f0dcbaba",locale_id:"e72f66022b5fdea81d58",lang_is:"e0abc13310b2ffb8df45",locale_is:"df55c496a7e7fc1424dd",lang_it:"6ec7585883a56492aea2",locale_it:"a0bad7d95e01d35f3fb8",lang_ja:"7d7a02f64b7f134c8722",locale_ja:"14cb2935c1333ad224c0",lang_ka:"c78c1cd16af3c487bfbd",locale_ka:"1c0fb1d715f56ab82fd5",lang_kk:"2348fe9afcd57aa55670",locale_kk:"0821e1f2a1c696490141",lang_ko:"524ef1e577c0b4e8a3d7",locale_ko:"3f9fd53edc9b20448cf1",lang_ky:"0a86d8aed10346460038",locale_ky:"0300ff17ec8fb26d7988",lang_lt:"d0cc23d1bc43fa2fc4c3",locale_lt:"f8cd7fb1878000f6aa07",lang_lv:"b3289efd9c78a4c86dd9",locale_lv:"b0094d441dd11f70c68b",lang_no:"eec626e78ffc4cc56646",lang_pa:"a435ab134b073280849b",locale_pa:"47d88264b5c5384876a5",lang_pl:"bf9c582c08a904c38227",locale_pl:"4bebad36da77ce1de5ec",lang_pt_br:"f838b3e0b52cc8493090",lang_ro:"03d50d643d2d04136b8f",locale_ro:"d9944c8cba1fed9691ca",lang_ru:"9a84ae95fc8a0a8cfbd7",locale_ru:"d0e9b32cc7c27a66ba8c",lang_sk:"2f421be4bb075f3e7393",locale_sk:"93b79090db6b84d9db28",lang_sl:"a1a310e9055965cb596d",locale_sl:"b2e199ac30680a5a37b2",lang_sq:"4a1562430a104aa3af8e",locale_sq:"fe8205536ab5e44a068f",lang_sr:"2c34de9c9b8b225b7e9f",locale_sr:"687bd11e5d33ae8f216f",lang_sv:"069071cd82a5408d7057",locale_sv:"fb67a7aaa0a9b2b36b55",lang_sw:"90a55206455a8913aacf",locale_sw:"742a9d10f4fb06f38ac6",lang_th:"e0dd6545f2e9f4410a55",locale_th:"2504a97f25df4cea1a5a",lang_tr:"2101776444a84bfb4d7d",locale_tr:"3633a8ece3696baf42c1",lang_tw:"b4b8d6e0d170306c2dba",locale_ak:"64acf85e6ca400539c69",lang_uk:"bce76ca7e39e6dcc106c",locale_uk:"9345bf21342e55a1fb7b",lang_ur:"f86f8032132556aaa53b",locale_ur:"2593373a7509c4d3671b",lang_uz:"247d433f741e163cb0d8",locale_uz:"af8265b40339a0e6fdbe",lang_vi:"c603081db8e3f4653c64",locale_vi:"92e9b9a3c9a718f1122f",lang_zh_cn:"1af7af1d7a80c54eebbf","vendors-node_modules_pubnub_dist_web_pubnub_min_js":"99bea9abis")()}cr exion(t,e){return Object.ad=dodule"}),Object.defineProperty(t,"__esModule",{value:!0})},a.orEach(e.bind(null,0)),n.push=e. ee:n},0==--o&&e(r)}for(var a=0;a<r.length;a++)i(a,r[a])}))},n=setTin=!0,l(e,)}}u.prototype.car n=new this.constructor(i);r)}catch(t){n(t)}}for(var=typeof t,u.rejer(var r=0,i=t.length;r<i;r++)u.resolv)unction"==typeof r&&func&&console.urn a.g;throw new Error("unable to locate global object")}();"function"!=typeof b.Promise?b.Promise=p:(b.Promise.prototype.finally||(b.Promise.prototype.fin;e.prototype=window.Event.prototype,window.CustomEvent=e}}(),function(){"use strict";var t=a(9625),e=a(4578),n=a(1965),r=a(1771),o=function(t){return(o=t.brandId,(0,e.U2)(function(t){var e=null==t?void 0:t.brandId,n="/p/v1/chat/settings/versions/latest";return e&&(n="/p/v1/chat/brands/".con){return null==t?void 0:t.data.attributes.settingsVersion})).catch((function(){}))).then((function(o){return(0,e.U2)(function(t){var e=null==t?void 0:t.brandId,n=null==t?void 0:t.lang,o=null==t?void 0:t.settingsVersion,i="/p/v2/chat/settings";e&&(i="/p/v2/chat/brands/".concat(e,"/settings"));var a=(0,r.a6)(n),u=new URLSearchParams;n&&u.set("lang",a),void 0!==o&&u.set("settingsVersion",o.toString());var c=u.toString();return c.length&&(i="".concat(i,"?").concat(c)),i}({brandId:t.brandId,lang:t.lang,settingsVersion:o})).then((function(e){var r,o,i,a,u,c,s,l,f,d,v=e.data.attributes,p=v.assistantRules,b=v.botConsent,h=v.closableChat,g=v.colors,m=v.disableAttachments,y=v.domainCriteria,w=v.embedIconColor,O=v.embedIconUrl,_=v.enabled,j=v.greeting,P=v.noHistory,I=v.offhoursDisplay,k=v.offhoursImageUrl,S=v.offhoursMessage,A=v.outboundChatEnabled,D=v.sentry,E=v.sharedPubNubKeySet,C=v.showBotIdentifier,M=v.showBrandingIdentifier,N=v.showTypingIndicatorCustomerWeb,T=v.showTypingIndicatorWeb,$=v.singleSessionChat,x=v.teamIconUrl,U=v.teamName,B=v.volumeControl,F=v.waitMessage,z=v.widgetType,L=e.data.relationships.org.data.id,H=null==e||null===(r=e.data)||void 0===r||null===(o=r.relationships)||void 0===o||null===(i=o.brand)||void 0===i||null===(a=i.data)||void 0===a?void 0:a.id,q=null==e||null===(u=e.data)||void 0===u||null===(c=u.relationships)||void 0===c||null===(s=c.kb)||void 0===s||null===(l=s.data)||void 0===l?void 0:l.id,R=(null==t?void 0:t.assistantId)||(null==e||null===(f=e.data)||void 0===f||null===(d=f.attributes)||void 0===d?void 0:d.activeAssistant);return(0,n.ow)("settings",{activeAssistant:R,assistantRules:p,botConsent:b,brandId:H,closableChat:h,colors:g,disableAttachments:m,domainCriteria:y,embedIconColor:w,embedIconUrl:O,enabled:_,greeting:j,knowledgeBaseId:q,noHistory:P,offhoursDisplay:I,offhoursImageUrl:k,offhoursMessage:S,outboundChatEnabled:A,sentry:D,sharedPubNubKeySet:E,showBotIdentifier:C,showBrandingIdentifier:M,showTypingIndicatorCustomerWeb:N,showTypingIndicatorWeb:T,singleSessionChat:$,teamIconUrl:x,teamName:U,volumeControl:B,waitMessage:F,widgetType:z}),(0,n.ow)("orgId",L),e}))}));var o},i=a(5238),u=a(5123),c=a(288),s=function(t){return Promise.all([a.e("vendors-node_modules_pubnub_dist_web_pubnub_min_js"),a.e("pubnub")]).then(a.bind(a,6661)).then((function(e){if(!t)return e;var r=t.customerId,o=t.orgId,i=t.cb;return(0,n.bh)().isPubNubConnected?e:e.initializePubNub({customerId:r,orgId:o,cb:i}).then((function(){return e}))}))},l=a(3866),f=a(4158),d=function(){var t=(0,n.bh)().settings,e=t.embedIconUrl,r=t.embedIconColor,o=t.teamIconUrl,i=t.teamName,a=t.waitMessage,u=t.greeting,c=t.singleSessionChat,s=t.noHistory,l=t.disableAttachments,f=t.offhoursDisplay,d=t.offhoursImageUrl,v=t.offhoursMessage,p=t.closableChat,b=t.widgetType,h=t.activeAssistant,g=t.volumeControl,m=t.domainCriteria,y=t.colors,w=t.showBrandingIdentifier,O=t.brandId,_=t.knowledgeBaseId,j=t.assistantRules,P=t.sentry,I=t.botConsent,k=t.showBotIdentifier;return{settings:{embedIconUrl:e,embedIconColor:r,teamName:i,teamIconUrl:o,waitMessage:g.customWaitMessage||a,greeting:u,singleSessionChat:c,noHistory:s,disableAttachments:l,offhoursDisplay:f,offhoursImageUrl:d,offhoursMessage:v,closableChat:p,widgetType:b,activeAssistant:h,volumeControl:g,domainCriteria:m,colors:y,showBrandingIdentifier:w,brandId:O,knowledgeBaseId:_,assistantRules:j,sentry:P,botConsent:I,showBotIdentifier:k}}},v=function(t,r){var a,v,p,b,h=(0,i.qc)();return Promise.all([o({brandId:null==t?void 0:t.brandId,lang:null==t?void 0:t.lang,assistantId:null==t?void 0:t.assistantId}),(a=null==t?void 0:t.scheduleId,b=a||(null===(v=(0,n.bh)())||void 0===unction(t){return u.h.replace(":scheduleId",t||"default")}(b)).then((function(t){var e=t.included,r=t.data,o=r.id,i=r.attributes,a=i.hours,u=i.name,c=i.timezone,s=i.timezoneOffset;return(0,n.ow)("schedule",{id:o,hours:a,name:u,timezone:c,timezoneOffset:s,holidays:e}),t})))]).then((function(t){var e,o,a,u,l=null===(e=t[0])||void 0===e||null===(o=e.data)||void 0===o||null===(a=o.attributes)||void 0===a||null===(u=a.sentry)||void 0===u?void 0:u.web;if(l&&!(0,i.fo)()&&(0,f.j6)(l,(0,n.bh)().orgId),!(0,n.bh)().settings.enabled){var v="Kustomer Chat is disabled in your org settings. Initialization will not continue.";return console.warn(v),Promise.reject(new Error(v))}if(null!==h)return(0,c.X)().then((function(t){var e,o,i,a,u=null==t||null===(e=t.data)||void 0===e||null===(o=e.relationships)||void 0===o||null===(i=o.customer)||void 0===i||null===(a=i.data)||void 0===a?void 0:a.id;if((0,n.ow)("customerId",u),void 0!==u){var omerId:u,orgId:c,cb:function(){"function"==typeof r&&r(l)}}).then((function(){return l}))}(0,n.ow)("isPubNubConnected",!1)}));(0,n.ow)("isPubNubConnected",!1)})).then((function(t){if(!t&&"function"==typeof r){var e=d();r(e)}})).catch((function(t){"function"==typeof r&&r(null,t),(0,l.S)(t,{message:"Failed to initialize"})}))},p=a(2218),b=a(7518),h=a(3701),g=a(5731),m=function(t,e){var n=t.conversationChannels;return function(t){var r=t.operation,o=t.afn.filter((function(t){return null==o?void 0:o.includes(t)})).length===n.length||i)&&e(null,i?a:null)}},y=a(4502),w=a(1277),O=function(t){if(t)return Object.entries(t).reduce((function(t,e){var n,r=e[0],o=e[1],i={};t&&(i=t);var a=null==o||null===(n=o.match(/(page=)([0-9]+)/g))||void 0===n?void 0:n[0];if("string"==typeof a){var u,c=null===(u=a.split("="))||void 0===u?void 0:u[1];a=Number.parseInt(c,10)}return i?("prev"===r?i.previous=a:"self"===r?i.current=a:i[r]=a,i):t}),{})},_=a(7882);function j(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function P(t,e,n){return e in t?Object.defineProperty(t,e,{varray objects must have a [Symbol.iterator]() method.")}()}function k(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function S(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function A(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?S(Object(n),!0).forEach((function(e){D(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function D(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var E=function(t){var e=null==t?void 0:t.messages.map((function(t){return new Promise((function(e){var n,r,o;(null==t||null===(n=t.message)||void 0===n||null===(r=n.data)||void 0===r||null===(o=r.relationships)||void 0==ta.id).then((function(n){e(A(A({},t),{},{attachments:n}))})):e(t)}))}));return Promise.allSettled(e).then((function(t){var e=[];return t.forEach((function(t){"rejected"!==t.status?e.push(t.value):(0,l.S)(t.reason,{message:"Error appending attachment(s) to PubNub message"})})),{messages:e}}))},C=function(t,e){var r,o=null==t?void 0:t.conversationId;return s().then((function(t){return r=t,function(t){var e=(0,n.Gi)(t);return e?Promise.resolve(e):(0,p.Gg)(t).then((function(){return(0,n.Gi)(t)}))}(o)})).then((function(t){var e,i,a,u,c=null==t||null===(e=t.attributes)||void 0===e||null===(i=e.pubnub)||void 0===i||null===(a=i.data)||void 0===a?void 0:a.channels,s=(0,n.bh)(),f=s.settings,d=f.showTypingIndicatorCustomerWeb,v=f.showTypingIndicatorWeb,p=d||v;if(!c)throw new Error("Conversation PubNub channels not found");var h=c.find((function(t){return"conversation"===t.type}));if(!s.isPubNubConnected)return Promise.reject(new Error("PubNub isn't connected"));if(!h)return Promise.reject(new Error("No conversation channel found for conversation: ".concat(o)));var g=c.find((function(t){return"conversation"===t.type}));if(p&&g){var m,y,w=g.name.replace("ext-convo-","shrd-convo-");w.length&&(null===(m=r.getMetaPubNub())||void 0===m||null===(y=m.instance)||void 0===y||y.subscribe({channels:[w]}))}return function(t,e){return new Promise((function(n,r){!function o(i){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.fetchMessages({channels:[t],start:i,count:b.gG}).then((function(e){var r,i=(null==e||null===(r=e.channels)||void 0===r?void 0:r[t])||[],u=[].concat(I(a),I(i));if(null==i||!i.length||i.length<b.gG)return n({messages:u});var c=i[0].timetoken;return o(c,u)})).catch((function(t){(0,l.S)(t,{message:"Failed to get messages from pubnub"}),r(t)}))}(0)}))}(h.name,null===(u=r.getConversationPubNub())||void 0===u?void 0:u.instance)})).then(E).then((function(t){var n=function(t,e){var n={satisfaction:{},messages:[]};return null!=t&&t.length&&(n=t.reduce((function(t,e){var n,r;if(e.message.name!==g.jy&&e.message.name!==g.oU||t.messages.push((0,w.X)(e.message.data,null==e||null===(n=e.attachments)||void 0===n?void 0:n.data,null==e||null===(r=e.message)||void 0===r?void 0:r.included,"pubnub")),e.message.name===g.vt||e.message.eventType===g.xU){var o,i,a=null==e||null===(o=e.message.included)||void 0===o?void 0:o.find((function(t){return"satisfaction"===t.type})),u=e.timetoken;t.satisfaction=(0,_.EI)(null==e||null===(rty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({conversationId:e},n)}(null==t?void 0:t.messages,o);"function"==typeof e&&e(n)})).catch((function(t){(0,l.S)(t,{message:"Failed to get messages"}),"function"==typeof e&&e(null,t)}))};function M(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function N(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?M(Object(n),!0).forEach((function(e){T(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function T(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var $=function(t){var e,n=null==t||null===(e=t.data)||void 0===e?void 0:e.map((function(t){return new Promise((function(e){var n;(null==t||null===(n=t.relationshi.rD)(t.id).then((function(n){e({message:t,attachments:n})})):e({message:t})}))}));return Promise.allSettled(n).then((function(e){var n=[];return e.forEach((function(t){"rejected"!==t.status?n.push(t.value):(0,l.S)(t.reason,{message:"Error appending attachment(s) to historical message"})})),{messages:n,links:null==t?void 0:t.or===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L(t)}var H={s:"second",h:"hour",d:"day",w:"week",m:"minute",M:"month"};function q(t,e){var n=t.replace(/_/g,".");return z()(e,n)}function R(t){return null!=t&&("string"==typeof t?""!==t.trim():!Array.isArray(t)||0!==t.length)}function J(t,e){var n;if(Array.isArray(t)&&!Array.isArray(e))return t.includes(e);try{switch(L(t)){case"string":n=String(e);break;case"number":n=Number(e);break;case"boolean":n="boolean"==typeof e?e:"true"===e;break;default:n=e}}catch(t){n=e}return t==n}function K(t,e){if((0,x.HD)(t)&&(0,x.HD)(e)){var n=(t||"").toLocaleLowerCase(),r=(e||"").toLocaleLowerCase();return n.includes(r)}return!!(t||[]).filter((function(t){return(t||"").toLocaleLowerCase().includes((e||"").toLocaleLowerCase())})).length}function W(t,e){return(0,x.HD)(t)&&Array.isArray(e)?!!e.filter((function(e){return(t||"").toLocaleLowerCase().includes((e||"").toLocaleLowerCase())})).length:!(!Array.isArray(t)||!Array.isArray(e))&&e.some((function(e){return t.some((function(t){var n=(0,x.HD)(t)?t.toLocaleLowerCase():t,r=(0,x.HD)(e)?e.toLocaleLowerCase():e;return n.includes(r)}))}))}function Y(t,e){return Array.isArray(t)&&Array.isArray(e)?!!(0,x.jV)(t,e).length:(e||[]).inc(t)&&/^(now)[-+]([0-9]|[1-9][0-9])(s|h|d|w|m|M)/g.test(t)}function X(t){var e=t.substring(t.length-1),n=H[e];if(!n)throw new Error("date unit ".concat(e," not supported"));var r=t[3],o=Number(t.substring(4,t.length-1));return"-"===r?B()().subtract(o,n).toJSON():B()().add(o,n).toJSON()}function Z(t,e){var n=Object.keys(t)[0],r=t[n],o=r.operator,i=r.value;switch(o){case"is_set":case"not_set":return function(t,e){switch(t){case"is_set":return R(e);case"not_set":return!R(e);default:throw new Error("operation ".concat(t," not supported"))}}(o,q(n,e));case"equals":case"not_equals":case"gt":case"gte":case"lt":case"lte":case"in":case"not_in":case"contains":case"not_contains":case"contains_any_of":case"not_contains_any_of":return function(t,e,n){switch(t){case"equals":return J(e,n);case"not_equals":return!J(e,n);case"gt":return function(t,e){if(V(e)){var n=X(e);return Date.parse(t)>Date.parse(n)}return G(e)?Date.parse(t)>Date.parse(e):Number(t)>Number(e)}(e,n);case"gte":return function(t,e){if(V(e)){var n=X(e);return Date.parse(t)>=Date.parse(n)}return G(e)?Date.parse(t)>=Date.parse(e):Number(t)>=Number(e)}(e,n);case"lt":return function(t,e){if(V(e)){var n=X(e);return Date.parse(t)<Date.parse(n)}return G(e)?Date.parse(t)<Date.parse(e):Number(t)<Number(e)}(e,n);case"lte":return function(t,e){if(V(e)){var n=X(e);return Date.parse(t)<=Date.parse(n)}return G(e)?Date.parse(t)<=Date.parse(e):Number(t)<=Number(e)}(e,n);case"in":return Y(e,n);case"not_in":return!Y(e,n);case"contains":return K(e,n);case"not_contains":return!K(e,n);case"contains_any_of":return W(e,n);case"not_contains_any_of":return!W(e,n);default:throw new Error("operation ".concat(t," not supported"))}}(o,q(n,e),i);default:throw new Error("operation ".concat(o," not supported"))}}var Q=function(t,e,n){var r={session:e,customer:n};return function(t,e){var n;return null===(n=t.criteria.and)||void 0===n?void 0:n.every((function(t){return Z(t,e)}))}(t,r)&&functi;return!n||!n.length||!!n.find((function(t){retll===(n=e.pendingAssistant)||void 0===n?void 0:n.channel)}))},et=a(828),nt=function(t){var e=t.id,r=t.attributes.pubnub.data.channels.find((function(t){return"meta-conversation"===t.type}));return s().then((function(t){var o=t;if((0,n.bh)().isPubNubConnected&&r){var i,a,u={message:{eventType:"read"},channel:r.name};return null===(i=o.getMetaPubNub())||void 0===i||nd 0:a.publish(u).then((function(){(0,n.aN)(e),(0,et.q)(e)}))}}))},rt=a(2098);function ot(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Map;return{get:function(e){return new Promiseon(e,nKey:function(t){return Promise.resolve(JSON.stringify(t))}}}function it(t,e){var n=e||ot(),r=n.get,o=n.set,i=n.toKey;return function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return i(n).catch((function(){})).then((function(e){return void 0===e?t.apply(void 0,n):r(e).catch((function(){return t.apply(void 0,n).then((function(t){return o(e,t).then((function(){return t})).catch((function(){return t}))}))}))}))}}var at=a(6990);function ut(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ct(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ut(Object(n),!0).forEach((function(e){st(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ut(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function st(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var lt=it((function(t){var n=(0,at._Z)(t);if(n)return Promise.reject(n);var r=t.assistant,o=t.dialog,i=t.assistantOptions,a={assistant:r,dialog:o},u=null!=i&&i.emulation?ct(ct({},a),{},{assistantOptions:i}):a;return(0,e.v_)((0,at.He)(t),{body:JSON.stringify(u)})}),ot(at._f)),ft="online",dt="offline",vt=function(t){return{availability:t}},pt=function(t){var e=new Date,n=e.getTime()+6e4*e.getTimezoneOffset();return new Date(n+t)},bt=a(4788),ht=fissing one or more of the required properties: jwtToken")}(t);return n?Promise.reject(n):(0,c.J)().then((function(){returity",{body:JSON.stringify(t)}).then((function(t){return t}))}))}({externalToken:null==t?void 0:t.jwtToken}).then((function(t){var e,r,o={identified:(r=(e=t).data.attributes).verified,email:r.email,externalId:r.externalId,customerId:e.data.relationships.customer.data.id};return(0,n.ow)("customerId",o.customerId),(0,n.ow)("externalId",o.externalId),(0,n.ow)("email",o.email),(0,n.ow)("verified",o.identified),o})):o=(0,c.X)().then((function(t){var e,r,o,i,a=(0,n.bh)(),u=null==t||null===(e=t.data)||void 0===e||null===(r=e.relationships)||void 0===r||null===(o=r.customer)||void 0===o||null===(i=o.data)||void 0===i?void 0:i.id;return(0,n.ow)("customerId",u),{customerId:u,identified:!!a.verified,externalId:a.externalId,email:a.email}}));return o.then((function(t){var e,o,i=(0,n.bh)();return Array.isArray(null===(e=i.settings)||void 0===e?void 0:e.assistantRules)&&(null===(o=i.settings)||void 0===o?void 0:o.assistantRules.length)>0&&t.identified?(0,bt.$H)().catch((function(t){"function"==typeof r&&r(null,t),(0,h.F)(b.NX,null,t),(0,l.S)(t,{message:"Failed to get customer context:"})})).then((function(){return t})):t})).then((function(e){var o=function(){"function"==typeof r&&r(e),(0,h.F)(b.NX,e)};if((0,n.ow)("isPubNubConnected",!1),null!=t&&t.brandId||null!=t&&t.assistantId)return v({brandId:null==t?void 0:t.brandId,assistantId:null==t?void 0:t.assistantId},o);var i=(0,n.bh)().orrId:e.customerId,orgId:i,cb:o}).then((function(){return e}))})).catch((function(t){"function"==typeof r&&r(null,t),(0,h.F)(b.NX,null,t),(0,l.S)(t,{message:"Failed to identify customer:"})}))},gt=function(t){var e=t.userIdentifier,n=t.externalId,r=t.email;return t.verified&&[n,r].includes(e)};function mt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function yt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?mt(Object(n),!0).forEach((function(e){wt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):mt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function wt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Ot=function t(n){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(t){var n=function(t){if(!(null==t?void 0:t.lang))return new Error("Missing one or more of the required properties: lang")}(t);return n?Promise.reject(n):(0,e.U2)(function(t){var e=null==t?void 0:t.page,n=null==t?void 0:t.lang,o=null==t?void 0:t.knowledgeBaseId,i=(0,r.a6)(n),a="/p/v4/kb/categories?pageSize=1000&page=".concat(e);return i&&(a="".concat(a,"&lang=").concat(i)),o&&(a="".concat(a,"&knowledgeBaseId=").concat(o)),a}(t))}({page:o,lang:null==n?void 0:n.lang,knowledgeBaseId:null==n?void 0:n.knowledgeBaseId}).then((function(e){var r,a=e.data.reduce((function(t,e){var n,r;return t[e.id]=(r=(n=e).attributes,{categoryId:n.id,parentCategory:r.parent,childCategories:r.categoryPositions,title:r.title,description:r.description}),t}),i),u=yt(yt({},i),a);return null!==(r=e.links)&&void 0!==r&&r.next?t(n,o+1,u):i}))},_t=function t(n){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return function(t){return(0,e.U2)(function(t){var e=t.lang,n=t.knowledgeBaseId,o=t.page,i=(0,r.a6)(e),a="/p/v4/kb/articles",u=[];return i&&u.push("lang=".concat(i)),n&&u.push("knowledgeBaseId=".concat(n)),o&&u.push("page=".concat(o)),u.length&&(a="".concat(a,"?").concat(u.join("&"))),a}({lang:t.lang,knowledgeBaseId:t.knowledgeBaseId,page:t.page}))}({lang:n.lang,knowledgeBaseId:n.knowledgeBs.slug===n.articleSlug&&t.attributes.hash===n.articleHash}))||(null!=e&&null!==(r=e.links)&&void 0!==r&&r.next?t(n,o+1):null)}))},jt=a(2473),Pt=function(t,n){var o=function(t){var e=null==t?void 0:t.articleId,n=null==t?void 0:t.knowledgeBaseId,r=null==t?void 0:t.rating;if(!e||!n||!r)return new Error("Missing one or more of the required properties: articleId, knowledgeBaseId, and rating")}(t);return o?Promise.reject(o):function(t){return(0,e.v_)((n=t.articleId,o=t.lang,i=(0,r.a6)(o),"/p/v4/kb/articles/".concat(n,"/feedback?lang=").concat(i)),{body:JSON.stringify({rating:t.rating,knowledgeBaseId:t.knowledgeBaseId})}).then((function(t){return t.data}));var n,o,i}({knowledgeBaseId:t.knowledgeBaseId,articleId:t.articleId,lang:t.lang,rating:t.rating}).then((function(t){n&&n(t)}))},It=function(t){return function(t){var n=function(t){var e=null==t?void 0:t.categoryId,n=null==t?void 0:t.lang;if(!e||!n)return new Error("Missing one or more of the required properties: lang, categoryId")}(t);return n?Promise.reject(n):(0,e.U2)(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=t.categoryId,o=t.lang,i=t.knowledgeBaseId,a=(0,r.a6)(o),u="/p/v4/kb/categories/".concat(n,"?includeChildren=true&childrenLimit=").concat(e);return a&&(u="".concat(u,"&lang=").concat(a)),i&&(u="".concat(u,"&knowledgeBaseId=").concat(i)),u}(t))}(t).then((function(t){var e,n=t.data.attributes.positions,r=null==t||null===(e=t.included)||void 0===e?void 0:e.filter((function(t){return"article"===t.type}));return r&&r.length?var r=e.find((function(t){return t.attributes.article===n}));if(r){var o=(0,jt.a)(r);t.push(o)}return t}),[])}(n,r):[]}))},kt=function(t,n){return function(t){return function(t){return(0,e.U2)((n=t.knowledgeBaseId,o=null==t?void 0:t.lang,i=(0,r.a6)(o),"/p/v4/kb/featured-articles?knowledgeBaseId=".concat(n,"&lang=").concat(i))).then((function(t){return t.data}));var n,o,i}(t).then((function(t){var e=t;return e&&e.length?e.map((function(t){return(0,jt.a)(t)})):[]}))}(t).then((function(t){var e=(0,jt.h)(t);"function"==typeof n&&n(e)})).catch((function(t){"function"==typeof n&&n(null,t),(0,l.S)(t,{message:"Failed to get articles"})}))},St=function(){return(0,n.bh)().settings},At=it((function(){var t=St();return null!=t&&t.knowledgeBaseId?Promise.resolve(t.knowledgeBaseId):(0,e.U2)("/p/v4/kb/knowledge-bases/self").then((function(t){return t.data.id}))})),Dt=it((function(t){return(0,e.U2)((n=t.knowledgeBaseId,o=t.lang,i=(0,r.a6)(o),"/p/v4/kb/knowledge-bases/".concat(n,"?chat=true&lang=").concat(i)));var n,o,i})),Et=a(162),Ct=function(t){return At().then((function(e){return Dt({knowledgeBaseId:e}).then((function(e){var n=function(t){var e,n,r=t.data.attributes,o=r.domain,i=r.subdomain,a=null!=o&&o.domainName?"https://".concat(null==o?void 0:o.domainName,"/"):function(t){return"https://".concat(t,".").concat((e=(0,Et.d)().baseUrlDomain,null!=e&&e.includes("helpapp")?"helpapp":null!=e&&e.includes("helpsimply")?"helpsimply":"kustomer"),".").concat("prod2"===(0,Et.d)().pod?"support":"help","/");var e}(i);return{id:t.data.id,articleSurvey:null==t||null===(e=t.data)||void 0===e||null===(n=e.attributes)||void 0===n?void 0:n.articleSurvey,knowledgeBaseDomain:a}}(e);return"function"==typeof t&&t(n),n}))})).catch((function(e){return"function"==typeof t&&t(null,e),(0,l.S)(e,{m:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var $t=function(t,n){return(o=t,i=function(t){var e=null==t?void 0:t.term,n=null==t?void 0:t.lang;if(!e||!n)return new Error("Missing one or more of the required properties: lang, term")}(o),i?Promise.reject(i):(0,e.U2)(function(t){var e=t.term,n=t.lang,o=t.knowledgeBaseId,i=(0,r.a6)(n),a="/p/v4/kb/articles/search?pageSize=100&page=1&term=".concat(e,"&knowledgeBaseId=").concat(o);return i&&(a="".concat(a,"&langnction(t){var e=t.data.map((function(t){return(0,jt.a)(t)})),r=(0,jt.h)(e);"function"==typeof n&&n(r)})).catch((function(t){"function"==typeof n&&n(null,t),(0th);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Ut=function(t,try{a||null==n.return||n.return()}finally{if(u)throw i}}}}(t);try{for(a.s();!(i=a.n()).done;){var u=i.value.website_url,c=u.operator,s=u.value,l="equals"===c,f="not_equals"===c,d="not_contains"===c,v=e===s||o===s;if("contains"===c&&e.includes(s)||d&&!e.includes(s)||l&&v||f&&e!==s)r=!1;else if("and"===n){r=!0;break}}}catch(t){a.e(t)}finally{a.f()}return r},Bt=a(6612),Ft="online",zt="offline",Lt=a(6100);(0,t.ZN)().then((function(){window.KustomerMain={fetchSettings:o,init:function(t,e){v(t,e)},createConversation:function(t,e){!function(t,e){(0,p.ed)(t).then((function(t){var e=t.data.relationships.customer.data.ide,orgId:r}).then((function(e){return{pubnub:e,response:t}}))})).then((function(t){var r,o,i,a=t.pubnub,u=t.response;if(!(0,n.bh)().isPubNubConnected)throw new Error("Failed to connect to Pubnub");var c=((null==u||null===(r=u.data)||void 0===r?void 0:r.attributes.pubnub.data)||{}).channels.find((function(t){return"shared-conversation"===t.type})),s=null==c?void 0:c.name,l=s?[s]:void 0;if(l){var f,d,v={status:m({conversationChannels:l},(function(t,n){var r,o,i,c,s=null;n?null===(i=a.getMetaPubNub())||void 0===i||null===(c=i.instance)||void 0===c||c.unsubscribe({channels:l}):s=function(t){var e=t.data.id,n=t.data.attributes;return{conversationId:e,createdAt:n.createdAt,ended:!!n.lockedAt,isInAssistantMode:n.isInAssistantMode}}(u),null==a||null===(r=a.getMetaPubNub())||void 0===r||null===(o=r.instance)||void 0===o||o.removeListener(v),(0,h.F)(b.bp,s,n),"function"==typeof e&&e(s,n)}))};null===(f=a.getMetaPubNub())||void 0===f||null===(d=f.instance)||void 0===d||d.addListener(v)}return null===(o=a.getMetaPubNub())||void 0===o||null===(i=o.instance)||void 0===i||i.subscribe({channels:l}),a})).catch((function(t){"function"==typeof e&&e(null,t),(0,h.F)(b.bp,null,t),(0,l.S)(t,{message:"Failed to create conversation:"})}))}(t,e)},addListener:function(t,e){!function(t,e){!1!==(0,h.j)(t)&&"function"==typeof e&&(0,n.oc)(t,e)}(t,e)},removeListener:function(t,e){!function(t,e){!1!==(0,h.j)(t)&&"function"==typeof e&&(0,n.Bv)(t,e)}(t,e)},sendMessage:function(t,e){!function(t,e){var n,r=null==t?void 0:t.conversationId,o=null==t?void 0:t.body,i=null==t?void 0:t.payload,a=null==t?void 0:t.attachments,u=null==t?void 0:t.lastDeflection,c=null==t?void 0:t.isInAssistantMode,s=null==t?void 0:t.initAssistantPayload,f=null==t?void 0:t.lang,d=null==t?void 0:t.assistantOptions;(0,y.tn)(r,{body:o,payload:i,attachments:a,lastDeflection:u,isInAssistantMode:c,initAssistantPayload:s,lang:f,assistantOptions:d}).then((function(t){n=t;var e=t.data.id;if(null!=a&&a.length)return(0,y.Fq)(e)})).then((function(t){var r=null==t?void 0:t.data,o=(0,w.X)(n.data,r);(0,h.F)(b.P5,o),"function"==typeof e&&e(o)})).catch((function(t){if("function"==typeof e&&e(null,t),423===t.status){var n={conversationId:r,ended:!0};(0,h.F)(b.$t,n)}(0,h.F)(b.P5,null,t),(0,l.S)(t,{message:"Failed to send message:"})}))}(t,e)},getConversations:function(t,e){!function(t,e){(0,c.J)().then((function(){return(0,p.Rx)(t)})).then((functio.data.filter((function(t){return!0!==t.attributes.deleted})).map((function(t){var e;return{preview:t.attributes.preview,lastResponder:null===(e=t.attributes.previewDetails)||void 0===e?void 0:e.lastResponder,createdAt:t.attributes.createdAt,lastMessageAt:t.attributes.lastMessageAt,conversationId:t.id,ended:!!t.attributes.lockedAt,isInAssistantMode:t.attributes.isInAssistantMode}})),pages:O(t.links)}}(t);return"function"==typeof e&&e(n),t})).catch((function(t){"function"==typeof e&&e(null,t),(0,l.S)(t,{message:"Failed to get conversations for customer:"})}))}(t,e)},getConversation:function(t,e){!function(t,e){var n=null==t?void 0:t.conversationId;(0,p.Gg)(n).then((function(t){var n,r,o={conversationId:(n=t.data).id,createdAt:(r=n.attributes).createdAt,preview:r.preview,lastMessageAt:r.lastMessageAt,ended:!!r.lockedAt};return"function"==typeof e&&e(o),t})).catch((function(t){(0,l.S)(t,{message:"Failed to get conversation:"}),"function"==typeof e&&e(null,t)}))}(t,e)},getMessages:function(t,e){C(t,e)},getHistoricalMessages:function(t,e){!function(t,e){var n=null==t?void 0:t.conversationId,r=(null==t?void 0:t.count)||b.A6,o=null==t?void 0:t.before;(0,y.MJ)(n,{count:r,before:o}).then($).then((function(t){var r=function(t,e,n){var r={satisfaction:{},messages:[]};return null!=t&&t.length&&(r=t.reduce((function(t,e){var n,r,o,i,a,u,c,s,l,f,d;return"chat_message"===e.message.type&&t.messages.push((0,w.X)(e.message,null==e||null===(n=e.attachments)||void 0===n?void 0:n.data,(r=e.message,d=[],null!==(o=r.attributes)&&void 0!==o&&null!==(i=o.meta)&&void 0!==i&&i.template&&d.push({attributes:null===(l=r.attributes)||void 0===l||null===(f=l.meta)||void 0===f?void 0:f.template,type:"template"}),null===(a=r.attributes)||void 0===a||null===(u=a.meta)||void 0===u||null===(c=u.template)|function(t){return d.push(N(N({},t),{},{type:"article"}))})),d),"historical")),t}),r)),N(N({conversationId:e},r),{},{links:n})}(null==t?void 0:t.messages,n,t.links);"function"==typeof e&&e(r)})).catch((function(t){"function"==typeof e&&e(null,t),(0,l.S)(t,{message:"Failed to get historical messages"})}))}(t,e)},getAssistant:function(t){return function(t){var e,r,o=(0,n.bh)(),i=null!==(e=t.customer)&&void 0!==e?e:o.customerContext,a=null==o||null===(r=o.settings)||void 0===r?void 0:r.assistantRules,u=!!t.proactiveOnly;if(Array.isArray(a))for(var c=u?a.filter((function(t){var e,n,r;return!0===(null===(e=tt(t))||void 0===e||null===(n=e.input)||void 0===n||null===(r=n.pendingAssistant)||void 0===r?void 0:r.isProactive)})):a,s=0;s<c.length;s++){var l=c[s];if(Q(l,t.session,i)){var f,d,v=null===(f=tt(l))||void 0===f||null===(d=f.input)||void 0===d?void 0:d.pendingAssistant;if(null!=v&&v.assistant)return{assistant:null==v?void 0:v.assistant,dialog:null==v?void 0:v.startDialog}}}return!(u||!o.settings.activeAssistant)&&{assistant:o.settings.activeAssistant}}(t)},markRead:function(t){!function(t){var e=(0,n.bh)().sessions,r=null==t?void 0:t.conversationId,o=null==t?void 0:t.messageIds;try{var i=(0,et.f)(r);if(i)throw i;return Promise.resolve(e[r]).then((function(t){return t?Promise.resolve(t):(0,p.Gg)(r).then((function(t){return t.data}))})).then((function(t){var e=[nt(t)];return null!=o&&o.length&&e.push(function(t){var e=t.messageIds,n=t.sessionId;return(0,p.Ly)({messageIds:e,sessionId:n,body:{read:!0(t){(0,l.S)(t,{message:"Failed to mark message as read"})}))}catch(t){(0,l.S)(t,{messa},getUnreadCount:function(){return(0,n.bh)().unreadCounts},endConversation:function(t,e){!function(t,e){var n=null==t?void 0:t.conversationId;(0,p.CT)(n,{locked:!0,lockReason:"customer_ended"}).then((function(t){var n=(0,rt.t)(t.data);"function"==typeof e&&e(n)})).catch((function(t){"function"==typeof e&&e(null,t),(0,l.S)(t,{message:"Failed to end conversation"})}))}(t,e)},initAssistannction(t,e){return(0,c.J)().then((function(){return lt(t)})).then((function(t){var n,r,o,i,a={assistant:null==(n=t.data)||null===(r=n.meta)||void 0===r?void 0:r.assistant,dialog:null==n||null===(o=n.meta)||void 0===o?void 0:o.dialog,node:null==n||null===(i=n.meta)||void 0===i?void 0:i.node,initialMessages:null==n?void 0:n.initialMessages,attributes:null==n?void 0:n.attributes};return"function"==typeof e&&e(a),a})).catch((function(t){throw"function"==typeof e&&e(null,t),new Error(t)}))}(t,e)},sendKbDeflectionClick:function(t,n){return function(t,n){return function(t){return(0,e.gz)((0,at.n$)(t.sessionId),{body:JSON.stringify({articles:t.articles})})}(t).then(n)}(t,n)},isChatAvailable:function(){return function(){var t=(0,n.bh)(),e=t.settings,r=t.schedule,o=e.enabled,i=e.offhoursDisplay;if(!o)return vt("disabled");var a=function(t){var e=t.timezoneOffs;return r.filter((function(t){return t.attributes.enabled})).some((function(t){var e=new Date(t.attributes.startDate),n=new Date(t.attributes.endDate);return o>=e&&o<=n}))}(r),u=function(t){var e=t.hours,n=t.timezoneOffset,r=pt(n),o=e[r.getDay().toString()];if(!o||!Object.keys(o).length)return!1;var i=60*r.getHours()+r.getMinutes();return!!o.find((function(t){var e=t[0],n=t[1];return i>=e&&i<=n}))}(r)&&!a;return vt(u||i===ft?ft:ut:"hidden":dt)}()},getChatSettings:function(){return St()},submitSatisfactionForm:function(t,r){!function(t,r){var o,i,a,u,c=t.satisfactionId,f=t.rating,d=t.submittedAt;(o=c,i={rating:f,answers:t.answers,submittedAt:d},a=t.lang,u=(0,_.yW)(o,i),u?Promise.reject(u):(0,e.gz)((0,_.jI)(o,a),{body:JSON.stringify(i)})).then((function(t){return function(t,e){var r,o=ta.id;return s().then((function(t){return r=t,(0,n.Git)return(0,p.Gg)(o)})).then((function(){return(0,n.Gi)(o)})).then((function(o){var i,a,u,c=null==o||null===(i=o.attributes)||void 0===i||null===(a=i.pubnub)||void 0===a||null===(u=a.data)||void 0===u?void 0:u.channels,s=(0,n.bh)();if(!c)throw new Error("Conversation PubNub channels not found");var l=c.find((function(t){return"conversation"===t.type}));if(s.isPubNubConnected&&l){var f,d,v={message:{eventType:g.xU,data:t.data,included:t.included},channel:null==l?void 0:l.name};null===(f=r.getMetaPubNub())||void 0===f||null===(d=f.instance)||void 0===d||d.publish(v).then((function(n){var r,o=null==t||null===(r=t.included)||void 0===r?void 0:r.find((function(t){return"satisfaction"===t.type})),i=n.timetoken,a=(0,_.EI)(t.data,i,o);"function"==typeof e&&e(a)}))}}))}(t,r)})).catch((function(t){"function"==typeof r&&r(null,t),(0,l.S)(t,{message:"Failed to submit satisfaction form"})}))}(t,r)},sendTypingActivity:function(t){!function(t){var e=null==t?void 0:t.conversationId,r=null==t?void 0:t.typing;try{var o=function(t,e){return t?"boolean"!=typeof e?new Error("Typing status must be a boolean"):void 0:new Error("A conversationId must be provided.")}(e,r);if(o)throw o;var i=(0,n.bh)(),a=i.settings,u=i.sessions;if(!a.showTypingIndicatorWeb||!u[e])return;return function(t,e){return s().then((function(r){var o=r,i=(0,n.bh)(),a=i.sessils.find((function(t){return"shared-conversation"===t.type}));if(u){var c,s,l=u.name,f=e?g.VJ:g.h0;i.isPubNubConnected&&(null===(c=o.getMetaPubNub())||void 0===c||null===(s=c.instance)||void 0===s||s.signal({channel:l,message:f}))}}}))}(e,r)}catch(t){(0,l.S)(t,{message:"Failed to send typing status"})}}(t)},login:function(t,e){ht(t,e)},isLoggedIn:function(t,e){!function(t,e){var r=(null==t?void 0:t.email)||(null==t?void 0:t.externalId);if(!r)return Promise.resolve(e(!1));var o=(0,n.bh)(),i=o.externalId,a=o.email,u=o.verified;if(void 0!==u){var s=gt({userIdentifier:r,externalId:i,email:a,verified:u});return"function"==typeof e?Promise.resolve(e(s)):s}(0,c.X)().then((function(t){var n=t.data.attributes,o=n.externalId,i=n.email,a=n.verified,u=gt({userIdentifier:r,externalId:o,email:i,verified:a});return"function"==typeof e?e(u):u})).catch((function(t){"function"==typeof e&&e(null,t),(0,l.S)(t,{message:"Failed to check user is logged in:"})}))}(t,e)},describeCustomer:function(t,e){!function(t,e){var n,r={attributes:(n=t.attributes)?Object.entries(n).reduce((function(t,e){var n,r=e[0],o=e[1];return"phones"===r&&(n=o.ma}}))),"emails"===r&&(n=o.map((function(t){return{email:t}}))),t[r]=n||o,t}),{}):{},custom:t.customAttributes};(0,bt.Yj)(r).then((function(t){var n=function(t){var e,n,r,o=t.data,i=o.attributes;return{customerId:o.id,custom:i.custom,emails:null===(e=i.sharedEmails)||void 0===e?void 0:e.map((function(t){return t.email})),phones:null===(n=i.sharedPhones)||void 0===n?void 0:n.map((function(t){return t.phone})),so.map((function(t){return{username:t.username,type:t.type}}))}}(t);"function"==typeof e&&e(n)})).catch((function(t){"function"==typeof e&&e(null,t),(0,l.S)(t,{message:"Failed to describe customer:"})}))}(t,e)},describeConversation:function(t,n){!function(t,n){(function(t){var n=function(t){var e=null==t?void 0:t.conversationId,n=null==t?void 0:t.custom;return e?n?void 0:new Error("Missing one or more of the required properties: customAttributes"):new Error("A conversationId must be provided.")}(t);if(n)return Promise.reject(n);var r=t.conversationId,o=t.custom;return(0,e.r$)("/c/v2/conversations/".concat(r),{body:JSON.stringify({custom:o})})})({conversationId:null==t?void 0:t.conversationId,custom:null==t?void 0:t.customAttributes}).then((function(t){var e,r,o=(r=(e=t.data).attributes,{conversationId:e.id,custom:null==r?void 0:r.custom});"function"==typeof n&&n(o)})).catch((function(t){"function"==typeof n&&n(null,t),(0,l.S)(t,{message:"Failed to describe conversation:"})}))}(t,n)},getCategories:function(t,n){!function(t,n){var r={l==t?void 0:t.knowledgeBaseId):"/p/v4/kb/categories/root"}(t))})(t).then((function(e){var n,o,i;return r.rootCategory=(o=(n=e.data).attributes,i=n.id,{childCategories:o.categoryPositions,categoryId:i}),Ot(t)})).then((function(t){var e=r.rootCategory,o=e.categoryId;r.categories=t,r.categories[o]=e,"function"==typeof n&&n(r)})).catch((function(t){"function"==typeof n&&n(null,t),(0,l.S)(t,{message:"Failed to get categories"})}))}(t,n)},getArticles:function(t,e){!function(t,e){It(t).then((function(t){var n=(0,jt.h)(t);"function"==typeof e&&e(n)})).catch((function(t){"function"==typeof e&&e(null,t),(0,l.S)(t,{messages"})}))}(t,e)},getFeat{kt(t,e)},getKnowledgeBaseConfig:function(t){return Ct(t)},getArticleById:function(t,n){!function(t,n){(function(t){var n=function(t){var e=null==t?void 0:t.articleId,n=null==t?void 0:t.lang;if(!e||!n)return new Error("Missing one or more of the required properties: articleId, lang")}(t);return n?Promise.reject(n):(0,e.U2)(function(t){var e=t.articleId,n=t.lang,o=t.knowledgeBaseId,i=(0,r.a6)(n),a="/p/v4/kb/articles/:articleId".replace(":articleId",e),u=[];return i&&u.push("lang=".concat(i)),o&&u.push("knowledgeBaseId=".concat(o)),u.length&&(a="".concat(a,"?").concat(u.join("&"))),a}(t))})(t).then((function(t){var e=(0,jt.a)(t.data);"function"==typeof n&&n(e)})).catch((function(t){"function"==typeof n&&n(null,t),console.error("Failed to get article",t)}))}(t,n)},getArticleBySlug:function(t,e){return function(t,e){return _t(t).then((function(t){var n=null;return t&&(n=(0,jt.a)(t)),"function"==typeof e&&e(n),n})).catch((function(t){"function"==typeof e&&e(null,t),console.error((t,e)},submitArticleFeedback:function(t,e){return Pt(t,e)},updateArticleFeedback:function(t,n){return function(t,n){var r=function(t){var e,n=null==t?void 0:t.articleId,r=null==t?void 0:t.feedbackId,o=(null==t||null===(e=t.suggestedReasons)||void 0===e?void 0:e.length)||t.writtenFeedback;if(!n||!r||!o)return new Error("Missing one or more of the required properties: articleId, feedbackId, and suggestedReasons or writtenFeedback")}(t);return r?Promise.reject(r):function(t){return(0,e.r$)((n=t.articleId,r=t.id,"/p/v4/kb/articles/".concat(n,"/feedback/").concat(r)),{body:JSON.stringify({suggestedReasons:t.suack:t.writtenFeedback})}).then((function(t){return t.data}));var n,r}({articleId:t.articleId,id:t.feedbackId,suggestedReasons:t.suggesteeedback:t.writtenFeedback||""}).then((function(t){n&&n(t)}))}(t,n)},searchArticles:function(t,e){!function(t,e){var r,o=(0,n.bh)(),i=(null==t?void 0:t.knowledgeBaseId)||(null==o||null===(r=o.settings)||void 0===r?void 0:r.knowledgeBaseId);i?$t(Nt(Nt({},t),{},{knowledgeBaseId:i}),e):At().then((function(n){$t(Nt(Nt({},t),{},{knowledgeBaseId:n}),e)}))}(t,e)},isUrlAllowed:function(t){return function(t){try{var e=function(t){if("string"!=typeof(null==t?void 0:t.url))throw Error("A url must be provided.")}(t);if(e)throw e;return{allowed:!function(t){var e=(0,n.bh)().settings.domainCriteria;if(!e)return!1;var r=e.or,o=e.and,i=Ut(o,t,"and"),a=Ut(r,t,"or"),u=!1;return o&&r?u=!(!i&&!a):r?u=a:o&&(u=i),u}(null==t?void 0:t.url)}}catch(t){(0,l.S)(t,{message:"Failed to determine if url is allowed"})}}(t)},logout:function(t){!function(t){try{(0,n.HA)(),(0,i.Oq)(),ht({},(function(e,n){"function"==typeof t&&t(e,n),(0,h.F)(b.Xk,e,n)}))}catch(e){"function"==typeof t&&t(null,e),e instanceof Error&&(0,h.F)(b.Xk,null,e),(0,l.S)(e,{message:"Failed to logout"})}}(t)},sendPresenceActivity:function(t){!function(t){var e=(0,n.bh)(),r=e.orgId,o=e.customerId;if(o)try{var i=function(t){var e=null==t?void 0:t.presence;return e?[zt,Ft].includes(e)?void 0:new Error("presence must be one of: online, offline"):new Error("A presence value must be provided.")}(t);if(i)throw i;return s().then((function(n){var i,a,u,c,s=n,l=null==t?void 0:t.presence;e.isPubNubConnected&&(l===Ft&&(null===(i=s.getMetaPubNub())||void 0===i||null===(a=i.instance)||void 0===a||a.subscribe({channels:[(0,Bt.xu)(o,r)],withPresence:!0})),l===zt&&(null===(u=s.getMetaPubNub())||void 0===u||null===(c=u.instance)||void 0===c||c.unsubscribe({channels:[(0,Bt.xu)(o,r)]})))}))}catch(t){return void(0,l.S)(t,{message:"Failed to send presence acitivity"})}}(t)},stop:function(){return s().then((function(t){(0,n.HA)(),t.stopPubNub(),(0,n.ow)("isPubNubConnected",!1)}))},kustomerEventCount:function(t){(0,Lt.z_)(t)},kustomerEventTt.Dg)(t)},kustomerEventTimerStop:function(t){(0,Lt.a4)(t)}};var t=new CustomEvent("kustomer_core_main_ready");window.parent.dispatchEvent(t)}))}()}();
//# sourceMappingURL=core-main.6d71e170c52c0536bed4.js.map