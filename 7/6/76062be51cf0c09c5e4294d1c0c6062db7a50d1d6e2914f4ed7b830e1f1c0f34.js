import{E as _,P as k}from"./index.47a70548.js";import{a as x,A as E,r as I}from"./address-event.0a54fb2b.js";var q={exports:{}};(function(){function y(n,e){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(n);e&&(t=t.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),r.push.apply(r,t)}return r}function c(n){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?y(Object(r),!0).forEach(function(t){O(n,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(r,t))})}return n}function O(n,e,r){return e in n?Object.defineProperty(n,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[e]=r,n}function b(n,e){return function(r){if(Array.isArray(r))return r}(n)||function(r,t){var a=r&&(typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"]);if(a!=null){var s,o,i=[],u=!0,d=!1;try{for(a=a.call(r);!(u=(s=a.next()).done)&&(i.push(s.value),!t||i.length!==t);u=!0);}catch(l){d=!0,o=l}finally{try{u||a.return==null||a.return()}finally{if(d)throw o}}return i}}(n,e)||function(r,t){if(r){if(typeof r=="string")return p(r,t);var a=Object.prototype.toString.call(r).slice(8,-1);if(a==="Object"&&r.constructor&&(a=r.constructor.name),a==="Map"||a==="Set")return Array.from(r);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return p(r,t)}}(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(n,e){(e==null||e>n.length)&&(e=n.length);for(var r=0,t=new Array(e);r<e;r++)t[r]=n[r];return t}var P={"Content-Type":"application/json"};function f(n){return c(c({},P),n)}function m(n){return n.json().then(function(e){var r=c(c({},n),{},{body:e});if(!n.ok)throw r.body||r;return r})}var g=[void 0,null,""];function h(n){var e=n.url,r=n.queryParams,t=e.indexOf("http")===0,a=new URL((t?"":document.location.origin)+e),s=a.searchParams;return Object.entries(r||{}).filter(function(o){var i=b(o,2);return i[0],function(u){return!g.includes(u)&&(!Array.isArray(u)||u.filter(function(d){return!g.includes(d)}).length)}(i[1])}).forEach(function(o){var i=b(o,2),u=i[0],d=i[1];(Array.isArray(d)?d:[d]).forEach(function(l){return s.append(u,l)})}),a}var j={getDataViaApi:function(n){var e=n.url,r=n.queryParams,t=n.headers,a=h({url:e,queryParams:r});return fetch(a,{method:"GET",headers:f(t)}).then(m)},postDataViaApi:function(n){var e=n.url,r=n.queryParams,t=n.headers,a=n.body,s=h({url:e,queryParams:r});return fetch(s,{method:"POST",headers:f(t),body:JSON.stringify(a)}).then(m)},putDataViaApi:function(n){var e=n.url,r=n.queryParams,t=n.headers,a=n.body,s=h({url:e,queryParams:r});return fetch(s,{method:"PUT",headers:f(t),body:JSON.stringify(a)}).then(m)},deleteDataViaApi:function(n){var e=n.url,r=n.queryParams,t=n.headers,a=h({url:e,queryParams:r});return fetch(a,{method:"DELETE",headers:f(t)}).then(m)},requestDataViaExternalApi:function(n){var e=n.url,r=n.method,t=n.queryParams,a=n.headers,s=n.body,o=h({url:e,queryParams:t});return fetch(o,{method:r,headers:f(a),body:JSON.stringify(s)}).then(m)}},D=v={code:200,status:"OK"},A=q.exports={getData:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=n.currentUser,r=e&&e.username;return r?A().then(:new Promise(function(t){t(c(c({},v),{},{data:D()}))})}}})();var L=q.exports,S={exports:{}};(function(){ction b(e,r){return e)||function(t,a){var s=t&&(typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"]);if(s!=null){var o,i,u=[],d=!0,l=!1;try{for(s=s.call(t);!(d=(o=s.next()).done)&&(u.push(o.value),!a||u.length!==a);d=!0);}catch(w){l=!0,i=w}finally{try{d||s.return==null||s.return()}finally{if(l)throw i}}return u}}(e,r)||e,r)||)}ar P={"Content-Type":"application/json"};unction m(e){return e.json().then(function(r){var t=c(c({},e),{},{body:r});if(!e.ok)throw t.body||t;return t})}var g=[void 0,null,""];function h(e){var r=e.url,t=e.queryParams,a=r.indexOf("http")===0,s=new URL((a?"":document.location.origin)+r),o=s.searchParams;return Object.entries(t||{}).filter(function(i){var u=b(i,2);return u[0],function(d){return!g.includes(d)&&(!Array.isArray(d)||d.filter(.length)}(u[1])}).forEach(function(i){var u=b(i,2),d=u[0],l=u[1];(Array.isArray(l)?l:[l]).forEach(}),s}var j={getDataViaApi:function(e){var r=e.url,t=e.queryParams,a=e.headers,s=h({url:r,queryParams:t});return fetch(s,{method:"GET",headers:f(a)}).then(m)},postDataViaApi:function(e){var r=e.url,t=e.queryParams,a=e.headers,s=e.body,o=h({url:r,queryParams:t});return fetch(o,{method:"POST",headers:f(a),body:JSON.stringify(s)}).then(m)},putDataViaApi:function(e){var r=e.url,t=e.queryParams,a=e.headers,s=e.body,o=h({url:r,queryParams:t});return fetch(o,{method:"PUT",headers:f(a),body:JSON.stringify(s)}).then(m)},deleteDataViaApi:function(e){var r=e.url,t=e.queryParams,a=e.headers,s=h({url:r,queryParams:t});return fetch(s,{method:"DELETE",headers:f(a)}).then(m)},requestDataViaExternalApi:function(e){var r=e.url,t=e.method,a=e.queryParams,s=e.headers,o=e.body,i=h({url:r,queryParams:a});return fetch(i,{method:t,headers:f(s),body:JSON.stringify(o)}).then(m)}},D={member:{preferred_address:"/backend/member/preferred/address",addresses:"/backend/member/addresses",addressesV2:"/backend/member/addresses/v2",address:function(e){return"/backend/member/addresses/"+e},share_address_detail:share_address:"/backend/member/address/_share",subdistrictsDetail:"/backend/common/region/countries/{countryId}/provinces/{provinceId}/cities/{cityId}/districts/{districtId}/subDistricts",search_location:"/backend/member/region/location",search_subdistricts:"/backend/member/region/subdistricts",request_address:"/backend/member/address/_request",get_shared_address_list:"/backend/member/address/request/shared-detail"},common:{member_configs:"/backend/common/content/member-configs",google_maps_key:"/backend/common/configs/googleMapsKey",phone_number_prefix:"/backend/common/configs/setting-phonePrefixes",branch_io_key:"/backend/common/configs/branchIoKey",login:"/backend/common/users/_login",requestOtp:"/backend/common/users/_request-challenge-code"},external:{branchio:"https://api2.branch.io/v1/url"},subscription:{validate_address_change:"/backend/subscription/subscriptions/address/active"}},v=function(e){return e===""||e==null},A="blibli_member_preferredAddress",n={code:200,status:"OK",data:!0};S.exports={syncData:function(){var e,r=(e=localStorage.getItem(A))?JSON.parse(e):"";if(v(r))return new Promise(function(s){s(n)});var t,a=(t=function(s){return v(s)?{}:s.id?{id:s.id.trim()}:{geolocation:s.geolocation,address:{street:s.address.street,state:{name:s.address.state,longitude:0,latitude:0},city:{name:s.address.city,longitude:0,latitude:0},district:{name:s.address.district,longitude:0,latitude:0},subdistrict:{name:s.address.subdistrict,longitude:0,latitude:0},postalCode:s.address.postalCode}}}(r),j.postDataViaApi({url:D.member.preferred_address,body:t}));return new Promise(function(s,o){a.then(.catch(})}}})();var N=S.exports;const V={computed:{..._(["isLoggedIn","currentUser","isLoadingUser"])},methods:{...k("mainAddress",["setAddress","setAddressLoading"]),init(){this.initAddress(),x(E.CHANGE,this.handleAddressChangeEvent)},handleAddressChangeEvent(y){const c={data:y.detail};this.setAddress(c)},initAddress(){if(this.isLoggedIn){this.syncPreviousAddress();return}this.getAddress()},getAddress(){const y={currentUser:this.currentUser};L.getData(y).then(this.setAddress).catch(this.setAddressNull).finally(this.viewTracker)},setAddressNullsyncPreviousAddress(){N.syncData().then(this.getAddress).catch(this.setAddressNull)},handleCurrentUsersetAddressFinishedLoading,mounted(){this.init()},watch:{isLoadingUser,destroyed;export{V as c};
//# sourceMappingURL=customer-location-mixin.d9a86a52.js.map
