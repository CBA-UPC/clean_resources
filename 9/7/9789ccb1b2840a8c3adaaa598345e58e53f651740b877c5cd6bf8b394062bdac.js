"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[4950,456,2824],{34950:(e,t,n)=>{n.r(t),n.d(t,{AdsNpv:()=>Fe,default:()=>we});var i=n(10226),a=n(88737),s=n(22889),r=n(4572),l=n(50959),d=n(39505),c=n(10761);var o=n(17676),u=n(80626),m=n(69736),x=n(85648),v=n(24982),j=n(11527);const h=var g=n(97013),f=n(95841);const p=var C=n(88308),I=n(57028),k=n(24071);ar N=n(29132),_=n(21165),y=n(94948),T=n(26193),A=n(64569),E=n(45438);const P=U=(0,l.memo)(();var B=n(79936);const M=(0,l.memo)(();var V=n(37797),F=n(30456),w=n(12824);const D="JiMklw0itqYJ1aE76Vi8",q=J="NYcvpWpgvQYZploOD6rI",O="OpXrpghZvv_w9ygosJFP",z=var R=n(85781);const S=var Z=n(85039);const K="UhO5sUnZ2AoTQjzRdVvw",L=Q=W=Y="pvAyLo3KN8QP7KxQtiub",X="r4EqB8Z5_aywMW_8I84P",$=H=G="YwDjV6Zkmx7E1lOIi3up",ee="NTBclKVVTAhscebU_AIg",te="tD84X2SD0IicMx3osK8a",ne="lnZe3svuaFIiW5ZFInSS",ie=ae=se=var re=n(82187),le=n.n(re),de=n(36353),ce=n(25331),oe=n(97345),ue=n(94260),me=n(64420),xe=n(45514),ve=n(14302),je=n(60046);const he="mJucukPuB6OTWgaD4MZk",ge="i3o8ABclZov7rz8zzKYP",fe=(0,l.lazy)((),pe=Ce="axYKJRFEPoYl_JdDwH_k",Ie="e4ACuMrLPlskS8z9M_V3",ke="PZ89K8ONeOzgmwmcZRfJ",be="M7UVXKPsARIM71fmtSUG",Ne="HKhLNVB5OsH5osqax9lk",_e="i_7T75rV7Rj7AyykwrCf",ye="aEy4eegLkO7SLgOqnQMJ",Te="na5oNvZD9KtuYIUiIUZg",Ae="_7QFCuyjgT6BwUe1JJVL",Ee="g1fyNwi0G98CTbv9v4We",Pe=Ue="nqGBR5FksbL2ECk2pwi9",Be="vl6_GKpJYFTBMMj0Jnos",Me="p3X2EfF_IQHyI2bNxBYQ",Ve="qUsBVzhWK68O_ZpxUM1J",Fe=we=Fe},1826:30456:12824:]);
//# sourceMappingURL=4950.475cea57.js.mapn.value,n.id);if("appendBefore"===n.kind||"appendAfter"===n.kind)return function(n,t,e,r,i){var o=i||n,u=!1,c=document.querySelector(t),a=document.createElement("div"),s=function(){u||("appendBefore"===r&&(c=document.querySelector(t),v(function(){return c.parentNode.insertBefore(a,c)}),D(c),a=P(a,e),I&&a.setAttribute(N,o),u=!0),"appendAfter"===r&&(u||((c=document.querySelector(t)).nextSibling?(v(function(){return c.parentNode.insertBefore(a,c.nextSibling)}),D(c)):(v(function(){return c.parentNode.appendChild(a)}),D(c)),a=P(a,e),I&&a.setAttribute(N,o),u=!0)),u=!0)},f=function(){u&&(a.remove(),u=!1)};return{id:n,isApplied:function(){return u},kind:r,do:s,undo:f,redoIfNeeded:function(){var n=q(s,f,t,c);return n.element&&(c=n.element),n.isDetached},setDebugId:function(n){return o=n}}}(n.id,n.selector,n.value,n.kind,n.id);if("appendCss"===n.kind)return function(n,t,e,r){var i=r||n,o=!1,u=document.querySelector(t),c=document.createElement("style"),a=function(){o||(c.innerHTML=e,I&&c.setAttribute(N,i),document.head.appendChild(c),o=!0)},s=function(){o&&(c.remove(),o=!1)};return{id:n,kind:"appendCss",isApplied:function(){return o},do:a,undo:s,redoIfNeeded:function(){var n=q(a,s,t,u);return n.element&&(u=n.element),n.isDetached},setDebugId:function(n){return i=n}}}(n.id,n.selector,n.value,n.id);if("appendJs"===n.kind)return function(n,t,e,r,i){var o=r||n,u=!1,c=document.querySelector(t),a=document.createElement("script");a.setAttribute("type","application/javascript");var s=function(){u||(a.innerHTML=function(n,t){return n&&t?'(function (){\n    const _USE_CASE = "'+t.experienceId+'";\n    const _USE_CASE_VARIANT = "'+t.variantId+'";\n    const _USE_CASE_GA = "'+v(function(){return t.gaExperienceName.replace(/"/g,'\\"')},t.gaExperienceName)+'";\n    const _USE_CASE_GA_VARIANT = "'+v(function(){return t.gaVariantName.replace(/"/g,'\\"')},t.gaVariantName)+'"; \n    '+n+"\n  })()":n}(e,i),I&&(a.id=o),document.body.appendChild(a),u=!0)},f=function(){u&&(a.remove(),u=!1)};return{id:n,kind:"appendJs",isApplied:function(){return u},do:s,undo:f,redoIfNeeded:function(){var n=q(s,f,t,c);return n.element&&(c=n.element),n.isDetached},setDebugId:function(n){return o=n}}}(n.id,n.selector,n.value,n.id,n.options);if("appendFont"===n.kind){var r=JSON.parse(n.value);if(r&&r.family&&r.weights)return function(n,t,e){e=e||n;var r,i,o=!1,u=document.createElement("link"),c=(i=t.weights,(r=t.family).toLowerCase().includes("jetbrains")&&(r="JetBrains Mono"),"https://fonts.googleapis.com/css2?family="+encodeURIComponent(r)+":wght@"+v(function(){return i.join(";")})+"&display=block");return u.setAttribute("href",c),u.setAttribute("rel","stylesheet"),{id:n,isApplied:function(){return o},kind:"appendFont",do:function(){o||(I&&u.setAttribute(N,e),document.head.appendChild(u),o=!0)},undo:function(){o&&(u.remove(),o=!1)},redoIfNeeded:function(){return!1}}}(n.id,r,n.id)}else{if("compound"===n.kind){var i=n.value.map(function(e){return e.options=n.options,an(e,t)}).filter(function(n){return n});return function(n,t,e){var r=!1;return{id:n,isApplied:function(){return r},kind:"compound",do:function(){r||(t.filter(function(n){return!n.isApplied()}).forEach(function(n){n.setDebugId&&n.setDebugId(e),n.do()}),r=!0)},undo:function(){r&&(t.filter(function(n){return n.isApplied()}).reverse().forEach(function(n){return n.undo()}),r=!1)},redoIfNeeded:function(){return t.map(function(n){return n.redoIfNeeded()}).filter(function(n){return n}).length>0}}}(n.id,i,n.id)}if("widget"===n.kind){var o=v(function(){return n.block.value}),u=v(function(){return o.env.sectionId.substring(1)},n.id);return function(n,t,r,i,o,u,c){void 0===c&&(c="");var s=u||t,d=!1,l="vslyp-"+t,m=null,p=null,h=[],w=function(){if(!d){!function(n,t){var r=n+t,i="vslyw-"+r;if(!document.getElementById(i)){var o=v(function(){return window.loomi_ctx.env},e.LOCAL),u=document.createElement("script");if(u.id=i,u.type="text/javascript",o===e.PROD){var c=v(function(){return window.visually.flags["bunny-cdn"]});u.src="https://"+(c?"visually-sdk.b-cdn.net":"sdk.loomi-prod.xyz")+"/widgets/"+r+".js"}else u.src="https://sdk.loomi-stg.xyz/widgets/"+r+".js";document.head.appendChild(u)}}(i,c),"replace"===n?g():b();var r=i+c;f(function(){return v(function(){return!!window[H][F][r]})&&v(function(){return!!window.preact})},50,500).then(function(){D(m),v(function(){return window[H][F][r]("#"+t)})}),d=!0}},y=function(){if(d){p&&p.remove();var t=document.getElementById(l);if(t&&t.remove(),"replace"===n&&m&&m.children&&m.children.length>0)for(var e,r=0,i=a(m.children);!(e=i()).done;)e.value.style.display=h[r],r+=1;d=!1}},g=function(){if(m=J(r)){if(h=[],m.children&&m.children.length>0)for(var n,t=a(m.children);!(n=t()).done;){var e=n.value;e&&!e.getAttribute("preact")&&(h.push(e.style.display),e.style.display="none")}S(),m.appendChild(p)}else L("vsly","failed to find element with selector: "+r+" when trying to replace with widget")},b=function(){(m=J(r))?(S(),m.insertAdjacentElement("appendBefore"===n?"beforebegin":"afterend",p)):L("vsly","failed to find element with selector: "+r+" when trying to append widget")},S=function(){if(!(p=document.getElementById(t))){(p=document.createElement("section")).style.all="unset",p.style.width="100%",p.setAttribute("preact","1"),I&&p.setAttribute(N,s),I&&p.setAttribute(x,i),p.id=t;var n=document.createElement("script");n.id=l,n.setAttribute("type","text/props"),n.innerHTML=JSON.stringify(o),v(function(){return document.body.appendChild(n)})}};return{id:t,isApplied:function(){return d},kind:"widget",do:w,undo:y,redoIfNeeded:function(){var n=q(w,y,r,m);return n.element&&(m=n.element),n.isDetached}}}(o.htmlKind,u,n.selector,o.widgetId,o.env,u,o.version)}if("moveElem"===n.kind){var c=v(function(){return n.block.value});return function(n,t,e,r){var i=!1,o={display:""},u=null,c=null,a=function(){i||f(function(){return u=document.querySelector(t),c=document.querySelector(e),!!u&&!!c},50,500).then(function(){u=document.querySelector(t),c=document.querySelector(e),s()})},s=function(){c&&u&&(o={display:c.style.display,parentNode:u.parentElement,nextSib:u.nextElementSibling,prevSib:u.previousElementSibling},"appendBefore"===r?c.insertAdjacentElement("beforebegin",u):"appendAfter"===r?c.insertAdjacentElement("afterend",u):"replace"===r&&(c.style.display="none!important",c.insertAdjacentElement("afterend",u)),u.setAttribute(B,t),i=!0)};return{id:n,isApplied:function(){return i},kind:"moveElem",do:a,undo:function(){i&&c&&u&&(o&&o.prevSib?o.prevSib.insertAdjacentElement("afterend",u):o&&o.nextSib?o.nextSib.insertAdjacentElement("beforebegin",u):o&&o.parentNode&&o.parentNode.appendChild(u),"replace"===r&&(c.style.display=o.display),u.removeAttribute(B),i=!1)},redoIfNeeded:function(){return!(v(function(){return u.hasAttribute(B)})&&document.body.contains(u)||(i=!1,a(),0))}}}(n.id,n.selector,c.destSelector,v(function(){return c.htmlKind}))}if("automation"===n.kind){var s=v(function(){return n.block.value});return l=s.steps,m=!1,{id:"automation-"+(new Date).getDate(),kind:"automation",isApplied:function(){return m},do:function(){if(!m){m=!0;try{l.sort(function(n,t){return n.order-t.order}).map(function(n){switch(n.kind){case"click":return function(){return W(n)};case"type":return function(){return Q(n)};case"scroll":return function(){return z(n)};case"wait":return function(){return K(n)};default:return function(){return Promise.resolve()}}}).reduce(function(n,t){return n.then(function(n){return t()})},Promise.resolve()).then()}catch(n){L("failed to run automation with exception:",n)}}},undo:function(){},redoIfNeeded:function(){return!1}}}if("visualEdit"===n.kind){var d=v(function(){return n.block.value});return function(n,t){var e=!1,r={},i=function(n,t){var e=t.subChanges.map(function(t){switch(t.kind){case"text":return Z(n,t);case"style":return tn(n,t);case"image":return rn(n,t);case"video":return on(n,t);case"attr":return $(n,t)}});r[t.selector]={ve:t,elem:n,reverts:e}};return{id:n,kind:"visualEdit",isApplied:function(){return e},do:function(){e||(e=!0,t.forEach(function(n){f(function(){return!!document.querySelector(n.selector)},250,300).then(function(){var t=document.querySelector(n.selector);i(t,n)})}))},undo:function(){e&&(e=!1,Object.values(r).forEach(function(n){return n.ve.subChanges.forEach(function(t,e){return v(function(){return n.reverts[e]()})})}),r={})},redoIfNeeded:function(){if(!e)return!1;var n=!1;return Object.values(r).forEach(function(t,e){n=document.body.contains(t.elem)?function(n,t){return n.ve.subChanges.forEach(function(e,r){e.value!==function(n,t){switch(t.kind){case"text":return nn(n,t);case"attr":return X(n,t);case"style":return en(n,t);case"image":case"video":return un(n)}}(n.elem,e)&&(v(function(){return n.reverts[r]()}),i(n.elem,{selector:n.ve.selector,subChanges:[e]}),t=!0)}),t}(t,n):function(n,t){n.reverts[t]();var e=document.querySelector(n.ve.selector);return e&&i(e,n.ve),!0}(t,e)}),n}}}(n.id,d.changes)}}var l,m}var sn=!1;function fn(){sn||(sn=!0,requestAnimationFrame(dn))}function dn(){C.forEach(function(n){try{n.isApplied()?n.redoIfNeeded():n.do()}catch(t){L("failed to apply mutation command with exception:",t,n)}}),sn=!1}function ln(n){try{var t=C.get(n),e=t&&t.undo();C.delete(n);var r=O.findIndex(function(t){return t.id==n});return(i=v(function(){return O[r].selector}))&&v(function(){return R[i]})&&delete R[i],O.splice(r,1),fn(),e}catch(n){return}var i}function vn(n){return O.push(n),cn(),{revert:function(){return ln(n.id)},mutationId:n.id}}var mn="loomi-cart";function pn(){var n=v(function(){return window.loomi_ctx.cart});if(n)return n;var t=localStorage.getItem(mn);if(t)try{return JSON.parse(t)}catch(n){S()("failed to parse cart, with err: "+n.toString())}}var hn,wn="targeting-changed";!function(n){n.CART_CHANGE="CART_CHANGE",n.LOYALTY_CHANGE="LOYALTY_CHANGE"}(hn||(hn={}));var yn=b(function(n,t){var e=function(n,t){var e=new Event(wn);return e.key=n,e.value=t,e}(n,t);document.dispatchEvent(e),console.debug("Targeting has changed:",e)},80);function gn(n,t){yn(n,t)}function bn(n){return v(function(){return n.items.map(function(n){return v(function(){return n.selling_plan_allocation.selling_plan.name.toLowerCase()})}).filter(function(n){return!!n})},[])}function Sn(n,t){var e=this.cart;return e&&v(function(){return window.visually.flags["currency-aware-client-targeting"]})?v(function(){return e.currency===n?e.total_price/100:t?(window.loomi_ctx.Currency.convert(e.total_price,e.currency,n)||0)/100:0},0):0}function _n(n,t){function e(n){return n.toLowerCase()}var r={"==":function(t){return e(t)==e(n)},"!=":function(t){return e(t)!=e(n)},contains:function(t){return e(t).includes(e(n))},matches:function(t){return new RegExp(n).test(t)}};return!!this.CartSubs().find(function(n){return r[t](n)})}function In(){return bn(this.cart)}function En(n){var t=this.cart;return!!v(function(){return t.items.find(function(t){return t.handle===n})})}function An(n){var t=this.cart;return!!v(function(){return t.items.find(function(t){return!!t.tags&&t.tags.includes(n)})})}function Pn(n){var t=this.cart;return!!v(function(){return t.items.find(function(t){return!!t.collections&&t.collections.includes(n)})})}function kn(){return!0===v(function(){return window.loomi_ctx.loyalty.isMember},!1)}function On(){return v(function(){return window.loomi_ctx.loyalty.pointsBalance},0)}function Cn(){return v(function(){return window.loomi_ctx.loyalty.earnedPoints},0)}function Nn(){var n=v(function(){return window.loomi_ctx.sessionProducts});if(n)return n;var t=localStorage.getItem("loomi_session_products"),e=t?JSON.parse(t):[];return v(function(){return e.filter(function(n){return""!=n.handle}).reverse().slice(0,20)})}function xn(n){return JSON.parse(localStorage.getItem(n)||"[]")}function Tn(n,t,e,r){var i=v(function(){return t.filter(function(t){return!n.find(e(t))})})||[],o=[].concat(n||[],i).slice(0,25);return localStorage.setItem(r,JSON.stringify(o)),o}function jn(){return JSON.parse(localStorage.getItem("loomi_purchased_products")||"[]")}var Ln,Mn,Rn="vsly_params_history",Dn="vsly_visited_pages",qn=function(n){try{var t=n.matches?Mn.MOBILE:Mn.DESKTOP,e=function(){if(Ln!=t){j("device-listener","device changed to "+t+" from "+Ln),window.loomi_ctx.deviceOverride=t===Mn.MOBILE?"m":"d",Ln=t;var n=v(function(){return window.visually.reload}),e=function(){if(n)return Promise.resolve(n()).then(function(){});L("device-listener","can't find reload function")}();if(e&&e.then)return e.then(function(){})}}();return Promise.resolve(e&&e.then?e.then(function(){}):void 0)}catch(n){return Promise.reject(n)}};!function(n){n.MOBILE="MOBILE",n.DESKTOP="DESKTOP"}(Mn||(Mn={}));var Jn=function(){return edgetag("getUserId")},Un="lmi_utm_data";function Hn(){return v(function(){return pn().items.map(function(n){return{variantId:n.variant_id||0,quantity:n.quantity||0,productId:n.product_id||0,price:n.price||0}})})||[]}var Fn="__eventn_id";function Bn(n){return{firstSeen:v(function(){return parseInt(n.split(".")[1])},null),id:v(function(){return n.split(".")[0]})}}function Gn(n){var t=n||Math.random().toString(36).substring(2,12),e=Yn();return{newId:t,newEpoch:e,value:Vn(t,e)}}function Vn(n,t){return n+"."+t}function Yn(){return Math.trunc((new Date).getTime()/1e3)}var Kn="vsly_vid",zn="lmi_debug";function Qn(n){return v(function(){return new URL(window.location.href).searchParams.get(n)||void 0})}var Wn=["Roboto","Open Sans","Fredoka","Fredoka","Smooch Sans","Rubik","Lato","Poppins","Oswald","League Spartan","Noto Sans","Raleway","Merriweather","Playfair Display","Inter","JetBrains Mono","Jetbrains Mono"];function $n(n){try{(function(n){var t=n.flatMap(function(n){return v(function(){return n.code})}).filter(function(n){return!!n}).filter(function(n){return"widget"===n.kind}).map(function(n){return Xn(n.value.env)}).flatMap(function(n){for(var t=Object.entries(n).filter(function(n){var t=n[0];return t.includes("fontFamily")||t.includes("fontWeight")}).map(function(n){return n[1]}),e=[],r=function(n){e.push({family:t[n],weight:parseInt(v(function(){return t[n+1]}),10)||500})},i=0;i<t.length;i+=2)r(i);return e}).reduce(function(n,t){var e=t.family;return(n[e]||(n[e]=new Set)).add(t.weight),n},{});return Object.entries(t).filter(function(n){return Wn.includes(n[0])}).map(function(n){return{family:n[0],weights:Array.from(n[1]).sort()}})})(n).forEach(function(n){return vn(A("appendFont","div",JSON.stringify({family:n.family,weights:n.weights})))})}catch(n){L("failed to install custom fonts",n)}}function Xn(n){var t={};for(var e in n)if("object"!=typeof n[e]||Array.isArray(n[e]))t[e]=n[e];else{var r=Xn(n[e]);for(var i in r)t[e+"."+i]=r[i]}return t}var Zn=function(n,t,e,r){void 0===e&&(e=!0),void 0===r&&(r=void 0);try{var i=v(function(){return window.loomi_api.addToCart}),o=function(){if(i)return Promise.resolve(window.loomi_api.addToCart(n,t,e,r)).then(function(){})}();return Promise.resolve(o&&o.then?o.then(function(){}):void 0)}catch(n){return Promise.reject(n)}},nt=/*#__PURE__*/function(){function n(n,t){this._value=void 0,this._addedAt=void 0,this._value=n,this._addedAt=t||(new Date).getTime()}var t=n.prototype;return t.value=function(){return this._value},t.addedAt=function(){return this._addedAt},n}(),tt=/*#__PURE__*/function(){function n(n,t){this.backend=void 0,this.ttlMillis=void 0,this.backend=n,this.ttlMillis=t}var t=n.prototype;return t.isValid=function(n){return!!n&&(new Date).getTime()-n.addedAt()<=this.ttlMillis},t.get=function(n){var t=this.backend.get(n),e=this.isValid(t);if(t&&e)return t.value();e||this.backend.remove(n)},t.set=function(n,t,e){var r=new nt(t,e);this.backend.set(n,r)},n}(),et=/*#__PURE__*/function(){function n(n){this.namespace=void 0,this.namespace="vsly_cache_"+n,window[this.namespace]={}}var t=n.prototype;return t.get=function(n){var t=this;return v(function(){return window[t.namespace][n]})},t.remove=function(n){var t=this;v(function(){return delete window[t.namespace][n]})},t.set=function(n,t){window[this.namespace][n]=t},n}();function rt(){var n=v(function(){return window.ShopifyAnalytics}),t=v(function(){return window.visually.flags["override-shopify-pdp-meta"]}),e=v(function(){return n.meta.product}),r=v(function(){return t&&v(function(){return window.loomi_ctx.productId})||e.id}),i={};r&&(i.productId=""+r);var o=function(n,t){return it(n)||(n=function(){try{return new URL("http://"+window.location.pathname+window.location.search).searchParams.get("variant")}catch(n){return j("failed to get variant id from search params"),""}}()),it(n)||(n=v(function(){return t.variants[0].id})),function(n){var t=Number(n),e=isNaN(t)?Number((""+n).replace(/[^\d.]+/g,""))||void 0:t;if(void 0!==e)return""+e}(n)}(v(function(){return t&&v(function(){return window.loomi_ctx.variantId})||n.meta.selectedVariantId}),e);return o&&(i.variantId=o),i}function it(n){return("string"==typeof n||"number"==typeof n)&&""!==n&&0!==n}var ot=new(/*#__PURE__*/function(n){var t,e;function r(t,e){return n.call(this,new et(t),e)||this}return e=n,(t=r).prototype=Object.create(e.prototype),t.prototype.constructor=t,u(t,e),r}(tt))("recs_cache",300001),ut=function(n,t){try{var r=Promise.resolve([]);return Promise.resolve(function(i,u){try{var c=function(){function i(){return v(function(){return d.products})}if(!n)return r;var u=v(function(){return n.recommendationOptions});if(!u)return r;var c=!v(function(){return u.env!==e.PROD});!function(n){var t=rt(),e=t.productId,r=t.variantId;e||r?n.productId={productId:e,variantId:r}:window.loomi_ctx.productId&&(n.productId={productId:window.loomi_ctx.productId},window.loomi_ctx.variantId&&(n.productId.variantId=window.loomi_ctx.variantId))}(u),u.cartItems=ct(Hn()),u.currency=v(function(){return pn().currency},"USD"),u.cart_total=v(function(){return pn().total_price},0),at(u,"RECENTLY_VIEWED")&&(u.recentlyViewed=ct(Nn()));var a=jn();a.length>0&&(u.pastPurchases=a),at(u,"CART_ITEMS")&&(u.cartHistory=JSON.parse(localStorage.getItem("loomi-cart-history")||"[]")),u.userId=v(function(){return window.loomi_ctx.userId},""),t&&(u.widgetContext=t),v(function(){return!!window.loomi_ctx.storeAlias})&&(u.storeAlias=window.loomi_ctx.storeAlias);var s=function(n){return btoa(unescape(encodeURIComponent(JSON.stringify(o({},n)))))}(u),f=function(n,t){void 0===t&&(t=8397271938200529);for(var e,r=3735928559^t,i=1103547991^t,o=0;o<n.length;o++)e=n.charCodeAt(o),r=Math.imul(r^e,2654435761),i=Math.imul(i^e,1597334677);return r=Math.imul(r^r>>>16,2246822507)^Math.imul(i^i>>>13,3266489909),""+(4294967296*(2097151&(i=Math.imul(i^i>>>16,2246822507)^Math.imul(r^r>>>13,3266489909)))+(r>>>0))}(s),d=ot.get(f),l=function(){if(!d){var n=window.vslyNativeFetch||window.fetch;return Promise.resolve(n("https://sdk.loomi-"+(c?"prod":"stg")+".xyz/api/recommendations/web/public/recommend?q="+s)).then(function(n){return Promise.resolve(n.json()).then(function(n){ot.set(f,d=n)})})}}();return l&&l.then?l.then(i):i()}()}catch(n){return u(n)}return c&&c.then?c.then(void 0,u):c}(0,function(n){return L("loomi-widget,recProducts failed:",n),r}))}catch(n){return Promise.reject(n)}};function ct(n){return v(function(){return n.filter(function(n){return!!n.productId}).map(function(n){return{productId:""+n.productId,variantId:""+n.variantId,quantity:n.quantity||1}})})}function at(n,t){return n.type===t||v(function(){return n.strategyPerSlot.find(function(n){return n.strategy===t})})||v(function(){return!!Object.values(n.conditions).find(function(n){return n.qbProps.envKey===t})})||v(function(){return!!n.layeredRuling.find(function(n){return n.strategy===t||!!v(function(){return n.strategyPerSlot.slots.find(function(n){return n.strategy===t})})})})}function st(n){return"vsly_pi_"+n}function ft(n){return"vsly_hbt_"+n}function dt(n){return"vsly_hbc_"+n}function lt(n){return Array(n).fill(0).map(function(){return Math.floor(10*Math.random())}).join("")}var vt,mt="vslyb";function pt(n){return btoa(unescape(encodeURIComponent(JSON.stringify(n))))}function ht(n){if("number"==typeof n.chance&&n.chance<100){var t=pt({experienceId:n.name,variantId:n.variant,storeAlias:v(function(){return window.loomi_ctx.storeAlias}),anonymousId:v(function(){return window.loomi_ctx.userId})}),r=v(function(){return window.loomi_ctx.env},e.PROD),i=new URL(wt(r).cfgUrl.replace("/allocate","/match"));i.searchParams.append("q",t),fetch(i)}}function wt(n){var t="/api/allocator/web/public/allocate";return gt(n)&&(t="/allocate"),{cfgUrl:""+yt(n)+t}}function yt(n){return gt(n)?"http://localhost:8080":"https://sdk.loomi-"+(n===e.PROD?"prod":"stg")+".xyz"}function gt(n){return[e.TEST,e.LOCAL].includes(n)}!function(n){n.SIGNUP="SIGNUP",n.ADD_TO_CART="ADD_TO_CART",n.CHANGE_QTY="CHANGE_QTY",n.REMOVE_FROM_CART="REMOVE_FROM_CART",n.PAGE_LOAD="PAGE_LOAD",n.LOGIN="LOGIN",n.LOGOUT="LOGOUT",n.TIME_SPENT="TIME_SPENT",n.USE_CASE="USE_CASE"}(vt||(vt={}));var bt,St={DEBUG:{name:"DEBUG",severity:10},INFO:{name:"INFO",severity:100},WARN:{name:"WARN",severity:1e3},ERROR:{name:"ERROR",severity:1e4},NONE:{name:"NONE",severity:1e4}};function _t(){return bt||(n=v(function(){return window.location.search.includes("lmi_debug")})?St.WARN:St.NONE,t={minLogLevel:n},Object.values(St).forEach(function(e){var r=e.name,i=e.severity;t[r.toLowerCase()]=function(){var t=[].slice.call(arguments);if(i>=n.severity&&t.length>0&&"NONE"!=n.name){var e,o=t[0],u=t.splice(1),c="[VSLY-"+r+"] "+o;if("DEBUG"===r||"INFO"===r)(e=console).log.apply(e,[c].concat(u));else if("WARN"===r){var a;(a=console).warn.apply(a,[c].concat(u))}else{var s;(s=console).error.apply(s,[c].concat(u))}}}}),bt=t);var n,t}function It(n,t){if(!n&&!t)return!0;if(!n&&t)return!1;if(n&&!t)return!1;var e=Object.keys(n).sort(function(n,t){return n.localeCompare(t)}),r=Object.keys(t).sort(function(n,t){return n.localeCompare(t)});if(e.length!==r.length)return!1;for(var i,o=a(e);!(i=o()).done;){var u=i.value,c=n[u],s=t[u],f=Et(c)&&Et(s);if(f&&!It(c,s)||!f&&c!==s)return!1}return!0}function Et(n){return null!=n&&"object"==typeof n}function At(){if(v(function(){return void 0===window.loomi_ctx.cart})){var n=localStorage.getItem(Pt);if(n)try{window.loomi_ctx=o({},window.loomi_ctx||{},{cart:JSON.parse(n)})}catch(t){_t().error("failed parsing cart",n)}}return v(function(){return window.loomi_ctx.cart})}var Pt="loomi-cart";b(function(n){(function(n,t){try{return!It(n,t)&&void 0!==t}catch(n){return!0}})(At(),n)&&(!0===v(function(){return window.visually.flags["sdk-enable-cart-enrichment"]},!1)?function(n){try{var t=function(){return Promise.resolve(n)};if(v(function(){return n.items.length<=0}))return Promise.resolve(n);var e=function(t,e){try{var r=(i=v(function(){return Array.from(n.items.map(function(n){return n.handle}))},[]).map(function(n){return{name:n,oneOf:{productInfo:{handle:n,includeCollections:!0,includeTags:!0}}}}),Promise.resolve(window.loomi_api.allocatorQuery({queries:i})).then(function(t){n.items=n.items.map(function(n){return n.tags=v(function(){return t.results[n.handle].tags},[]),n.collections=v(function(){return t.results[n.handle].collections},[]),n})}))}catch(n){return e(n)}var i;return r&&r.then?r.then(void 0,e):r}(0,function(t){L("failed to enrich cart with error",t,n)});return Promise.resolve(e&&e.then?e.then(t):t())}catch(n){return Promise.reject(n)}}(n).then(function(n){Ot(n),gn(hn.CART_CHANGE,v(function(){return window.loomi_ctx.cart}))}):(Ot(n),gn(hn.CART_CHANGE,v(function(){return window.loomi_ctx.cart}))))},400);var kt="loomi-cart-history";function Ot(n){(function(n){try{var t=function(n){return v(function(){return n.items.map(function(n){return{price:n.price,variant_id:""+n.variant_id,product_id:""+n.product_id,quantity:n.quantity,timestamp:(new Date).toISOString()}})},[])}(n);e=function(n){var t=At(),e=v(function(){return t.items.map(function(n){return""+n.variant_id})},[]),r=JSON.parse(localStorage.getItem(kt)||"[]"),i=v(function(){return r.map(function(n){return""+n.variant_id})});return v(function(){return n.forEach(function(n){var t=i.indexOf(""+n.variant_id),o=e.includes(""+n.variant_id),u=t<0;u?r=[n].concat(r):o||u||(r[t]=n)})}),r}(t),localStorage.setItem(kt,JSON.stringify(e.slice(0,25)))}catch(n){_t().error("handleCartItemsHistory",n)}var e})(n),localStorage.setItem(Pt,JSON.stringify(n)),window.loomi_ctx=o({},window.loomi_ctx||{},{cart:n})}var Ct=!1,Nt={},xt={},Tt=function(n){return n.name+"-"+n.variant};function jt(){return{cart:pn(),Total:Sn,CartHasSubs:_n,CartSubs:In,CartHasItem:En,CartItemHasTag:An,CartItemHasCollection:Pn,IsLoyaltyCustomer:kn,LoyaltyPointsBalance:On,LoyaltyPointsEarned:Cn}}function Lt(n){var t;t=v(function(){return n.code.map(function(t){try{return function(n,t){if("compound"===n.kind){var e=n.value,r=function(n,t,e,r,i){var o=[];return e&&""!==e&&o.push(A(n,t,e)),r&&""!==r&&o.push(A("appendCss",t,r)),i&&""!==i&&o.push(A("appendJs",t,i)),o}(e.htmlKind,n.selector,e.html,e.css,e.js),i=A(n.kind,n.selector,r);i.options=t;var u=vn(i);return u.htmlId=r[0].id,r[1]&&(u.cssId=r[1].id),r[2]&&(u.jsId=r[2].id),u}if("widget"===n.kind){var c=A(n.kind,n.selector,"");c.options=t,c.block=n;var a=function(n,t){var e=v(function(){return n.block.value});return o({},t,{sectionId:v(function(){return e.env.sectionId}),widgetId:v(function(){return e.widgetId}),widgetVersion:v(function(){return e.version})})}(c,t);!function(n,t){var e=v(function(){return n.block.value.env});e&&Object.entries(t).forEach(function(n){return e[n[0]]=n[1]})}(c,a);var s=vn(c);return s.htmlId=c.id,s}if(["moveElem","automation","visualEdit"].includes(n.kind)){var f=A(n.kind,n.selector,"");f.options=t,f.block=n;var d=vn(f);return d.htmlId=f.id,d}var l=A(n.kind,n.selector,n.value);return l.options=t,vn(l)}(t,{experienceId:n.name,variantId:n.variant,gaExperienceName:n.gaName,gaVariantName:n.gaVariant,publishedAt:n.publishedAt})}catch(n){S()("running experience failed with err: "+n.toString()+" \n block: "+JSON.stringify(t))}}).filter(function(n){return!!n})},[]),xt[Tt(n)]=t}var Mt=new Set;function Rt(n){var t=v(function(){return n.clientTargetingFormula});return t&&""!==t}function Dt(n,t){if(Rt(n))try{return t.Total=Sn,t.CartHasSubs=_n,t.CartSubs=In,t.CartHasItem=En,t.CartItemHasTag=An,t.CartItemHasCollection=Pn,t.IsLoyaltyCustomer=kn,t.LoyaltyPointsBalance=On,t.LoyaltyPointsEarned=Cn,new Function("\n        const c = arguments[0];\n        return "+n.clientTargetingFormula)(t)}catch(n){return L("client side formula err",n),!1}return!0}function qt(n){var t=Object.entries(Nt).map(function(t){var e=t[1];return Rt(e)&&(Nt[Tt(e)]=e),{exp:e,shouldBeApplied:Dt(e,n),hasBeenApplied:!!xt[Tt(e)]}});!function(n){n.filter(function(n){return n.hasBeenApplied&&!n.shouldBeApplied}).flatMap(function(n){var t=v(function(){return xt[Tt(n.exp)]});return t&&delete xt[Tt(n.exp)],t}).forEach(function(n){v(n.revert)})}(t),function(n){n.filter(function(n){return n.shouldBeApplied&&!n.hasBeenApplied}).forEach(function(n){var t,e,r;Lt(n.exp),t=n.exp,e=Mt,void 0===r&&(r=_()),e.has(t.variant)||(Kt(r,t),e.add(t.variant),ht(t))})}(t)}var Jt=function(n){var t=v(function(){return n.key}),e=v(function(){return n.value}),r=jt();t===hn.CART_CHANGE?(qt(o({},r,{cart:e})),function(n){if(v(function(){return window.visually.flags.subscriptions_v1},!1)&&n&&"static"==window.vslyIntegrationType){var t=v(function(){return n.attributes[Ut]},""),e=v(function(){return n.attributes[Ht]||0},0),r=bn(n).length,i=Ut+"_"+n.token;(""+r!=""+e||t!=i)&&(n.attributes=n.attributes||{},n.attributes[Ut]=i,r>0&&(n.attributes[Ht]=""+r),Ot(n),Ft(i,r))}}(e)):t===hn.LOYALTY_CHANGE&&qt(r)},Ut="vslyCT",Ht="vslySUBS",Ft=b(function(n,t){try{var e=function(e,r){try{var i=function(){var e=new URLSearchParams;e.append("attributes["+Ut+"]",n),t>0&&e.append("attributes["+Ht+"]",""+t);var r=e.toString();return Promise.resolve(fetch("/cart/update.js?vsly=t",{credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},body:r,method:"POST",mode:"cors"})).then(function(){})}()}catch(n){return r(n)}return i&&i.then?i.then(void 0,r):i}(0,function(n){L("vsly cart attr update err",n)});return Promise.resolve(e&&e.then?e.then(function(){}):void 0)}catch(n){return Promise.reject(n)}},500);function Bt(n){return Vt(),Rt(n)&&(Nt[Tt(n)]=n),Gt(n)?(Lt(n),!0):(j("experience: "+n.gaName+" will not run due to client side targeting: "+n.clientTargetingFormula+" => false"),!1)}function Gt(n){return Dt(n,jt())}function Vt(){Ct||h(function(){return document}).then(function(){document.addEventListener(wn,Jt),Ct=!0})}function Yt(n,t,e){e()&&(Kt(t,n),Rt(n)&&ht(n))}function Kt(n,t){v(function(){n.register(t.name,t.variant,t.gaVariant,t.gaName),n.track(r.USE_CASE,o({use_case:t.name,use_case_variant:t.variant},t.version?{version:t.version}:{}),{gaName:t.gaName,gaVariant:t.gaVariant})})}var zt,Qt=new Set,Wt=new Set,$t=new Set,Xt=new Set;function Zt(n){void 0===zt&&(zt=new MutationObserver(ne(n))).observe(document.body,{childList:!0,subtree:!0,attributes:!1,characterData:!1})}function ne(n){return function(){te(Qt,$t,function(t,e){Yt(e,n,function(){return t.add(ee(e.trigger.selector,e)),Bt(e)})}),te(Wt,Xt,function(t,e,r){var i=e.trigger;t.add(ee(i.selector,e)),r.addEventListener(i.name,function(){Yt(e,n,function(){return Bt(e)})},{once:void 0!==i.once&&i.once})})}}function te(n,t,e){n.forEach(function(n){v(function(){var r=n.trigger.selector;document.body.querySelectorAll(r).forEach(function(i){t.has(ee(r,n))||e(t,n,i)})})})}function ee(n,t){return n+"-"+t.name}function re(n){var t,e=JSON.stringify(o({ts:(new Date).getTime()},n)),r=0;if(0===e.length)return r;for(t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return r}function ie(n){var t=re(n);return ce(t),f(function(){return new Function(n.code)(window)},n.timeoutMillis,n.retries,function(){return void 0===ae(t)})}function oe(n){return JSON.parse(localStorage.getItem(n)||"[]")}var ue=[],ce=function(n){ue.push(n)},ae=function(n){return ue.find(function(t){return t===n})};function se(t,e){switch(v(function(){return t.trigger.type})){case n.PageLoad:!function(n,t){Yt(n,t,function(){return Bt(n)})}(t,e);break;case n.Timeout:!function(n,t){var e,r=n.trigger.timeoutMillis;Yt(n,t,function(){return e=setTimeout(function(){Bt(n)},r),Gt(n)}),ce(function(){e&&clearTimeout(e)})}(t,e);break;case n.Selector:!function(n,t){Zt(n),Qt.add(t),ne(n)()}(e,t);break;case n.ExitIntent:!function(n,t){var e=function e(r){v(function(){return!r.toElement&&!r.relatedTarget})&&Yt(n,t,function(){var t=Bt(n);return p(function(){return document}).then(function(){document.removeEventListener("mouseout",e)}),t})};h(function(){return document}).then(function(){document.addEventListener("mouseout",e)}),ce(function(){p(function(){return document}).then(function(){document.removeEventListener("mouseout",e)})})}(t,e);break;case n.JSCondition:!function(n,t){ie(n.trigger).then(function(){Yt(n,t,function(){return Bt(n)})}).catch(function(n){return S()(""+n.toString())})}(t,e);break;case n.JSFunction:!function(n,t){!function(e,r){try{var i=new Function("return async function() { "+e.code+" }")()(),o=re(e);ce(o),i.then(function(){return void 0!==ae(o)&&void Yt(n,t,function(){return Bt(n)})})}catch(n){S()("failed to resole promise from async function trigger with error: "+n)}}(n.trigger)}(t,e);break;case n.JSEvent:!function(n,t){var e=n.trigger,r="vsly-js-events";function i(e){e&&Yt(n,t,function(){return Bt(n)})}var o=function(n){var t;try{t=new Function(e.jsEvent.matchCode)(n),localStorage.setItem(r,JSON.stringify([].concat(oe(r),[{event:{detail:n.detail},ts:(new Date).valueOf()/1e3}]).splice(0,25)))}catch(n){L("handleJsEvent",n),t=!1}i(t)};i(function(n,t){return v(function(){return!!oe(n).find(function(n){var e=n.ts;return(new Date).valueOf()/1e3-e<2628e3&&new Function(t)(n.event)})})}(r,e.jsEvent.matchCode)),h().then(function(){window.addEventListener(e.jsEvent.name,o)}),ce(function(){p().then(function(){window.removeEventListener(e.jsEvent.name,o)})})}(t,e);break;case n.Conjunction:!function(t,e){if(function(t){return[n.ExitIntent,n.Selector,n.Timeout].includes(t.trigger.condition.type)}(t)){var r=t.trigger;ie(r.jsCond).then(function(){se(o({},t,{trigger:r.condition}),e)}).catch(function(n){return S()(""+n.toString())})}}(t,e);break;case n.ElementEvent:!function(n,t){Zt(t),Wt.add(n),ne(t)()}(t,e);break;default:S()("unknown trigger: "+JSON.stringify(t))}}var fe=["vsly-backdrop-container","__loomi_crosshair_container"];function de(n){for(var t=v(function(){return n.target}),e=!1;t;){if(fe.includes(v(function(){return t.id}))){e=!0;break}t=v(function(){return t.parentElement})}e&&(j("vsly","about to stop propagation of event",n),v(function(){return n.stopImmediatePropagation()}),v(function(){return n.stopPropagation()}))}function le(n){var t=v(function(){return window.Shopify.currency.active},"USD"),e=v(function(){return window.Shopify.locale},"en-US"),r=v(function(){return window.Shopify.currency.rate},"1"),i=Number.parseFloat(r);i=Number.isNaN(i)?1:i;var o=new Intl.NumberFormat(e,{style:"currency",currency:t,minimumFractionDigits:0,maximumFractionDigits:2}),u=n*i;return v(function(){return!0!==window.visually.flags["op-locale-currency-no-round"]})&&(u=Math.round(u)),o.format(u)}function ve(){var n=v(function(){return!0===window.visually.flags["fb-locale-currency"]}),t=v(function(){return window.Shopify.currency},{}),e=!!v(function(){return t.active}),r=v(function(){return t.rate}),i=!!r&&!Number.isNaN(Number.parseFloat(r));return!!n&&e&&i}var me,pe=window.location.href,he=function(){requestAnimationFrame(function(){pe!==window.location.href&&(pe=window.location.href,window.dispatchEvent(new CustomEvent("vslyUrlChanged",{detail:{prev:pe,curr:window.location.href}})))})};!function(n){n.NONE="none",n.YOTPO="yotpo"}(me||(me={}));var we,ye,ge,be,Se={isMember:!1,provider:me.NONE},_e="vsly-loyalty-ctx",Ie=(ye=["swell:customer:updated","swell:redemption","swell:initialized","swell:setup","vsly:loyalty-changed"],be=function(n){v(function(){return"vsly:loyalty-changed"===n.type})&&v(function(){return window.swellAPI.refreshCustomerDetails()}),we(ge())},{provide:ge=function(){var n=v(function(){return window.swellConfig.customer});return n?{id:n.local_customer_id,providerId:n.id,email:n.email,earnedPoints:n.points_earned,isMember:!0===n.is_member,pointsBalance:n.points_balance,provider:me.YOTPO}:Se},isAvailable:function(){return!!document.querySelector('script[src*="yotpo"]')},onChangeListener:function(n){try{we=n;var t=function(n,t){try{var e=Promise.resolve(f(function(){return!!window.jQuery},50,200)).then(function(){ye.forEach(function(n){window.jQuery(document).on(n,be)})})}catch(n){return t()}return e&&e.then?e.then(void 0,t):e}(0,function(){ye.forEach(function(n){document.addEventListener(n,be)})});return Promise.resolve(t&&t.then?t.then(function(){}):void 0)}catch(n){return Promise.reject(n)}}}),Ee={provide:function(){return function(){if(location.href.includes("/checkouts/")){var n=localStorage.getItem(_e);if(n)return v(function(){return JSON.parse(n)})}}()||Se},onChangeListener:function(n){},isAvailable:function(){return!0}};function Ae(n){localStorage.setItem(_e,JSON.stringify(n)),window.loomi_ctx=o({},window.loomi_ctx||{},{loyalty:n})}var Pe=function(n,t){try{return void 0===n&&(n=e.PROD),Promise.resolve(function(e,r){try{var i=(function(){if(window.vsly_blocked)throw new Error(mt)}(),Promise.resolve(ke(n,t)).then(function(e){var r=e.jitsu,i=e.configuration;if(!v(function(){return i.flags["kill-switch"]}))return Promise.resolve(function(n,t){try{return Promise.resolve(f(function(){return!!document&&!!document.body&&!!document.querySelector},100,100)).then(function(){!function(){if("undefined"!=typeof document){V||(V=new MutationObserver(cn)),cn();var n="spa"===v(function(){return window.vslyIntegrationType},"static")?document:document.body;V.observe(n,{childList:!0,subtree:!0,characterData:!0,attributes:!1})}}()})}catch(n){return Promise.reject(n)}}()).then(function(){$n(i.experiments),function(n,t,e){v(function(){return t.experiments.forEach(function(t){se(t,n)})})}(r,i),function(n,t,e){var r=function(r){v(function(){return!!r.persisted})&&e(n,t,500).catch(function(n){L("failed  reloading sdk",n);var e=n;S()("init reloading sdk: "+l(e)+", alias:"+t)})};v(function(){return!window.loomi_ctx.pageshow})&&(j("pageshow initialized"),h().then(function(){window.addEventListener("pageshow",r),window.loomi_ctx.pageshow=!0}))}(n,t,Oe),function(){if(v(function(){return!0===window.visually.flags["reload-on-device-changed"]})){var n=window.matchMedia("(max-width: 960px)");n.removeEventListener("change",qn),n.addEventListener("change",qn)}}()})}))}catch(n){return r(n)}return i&&i.then?i.then(void 0,r):i}(0,function(n){v(function(){return n.message})!==mt&&(L("failed initialising sdk",n),S()(v(function(){return"init failed sdk: "+l(n)+", alias:"+t+"}"})))}))}catch(n){return Promise.reject(n)}},ke=function(n,t,r){try{void 0===n&&(n=e.PROD);var u=function(){try{return Promise.resolve(fetch("https://cdn.shopify.com/s/javascripts/currencies.js").then(function(n){return n.text()}).then(function(n){return new Function(n+";return Currency")()}).then(function(n){window.loomi_ctx=o({},v(function(){return window.loomi_ctx})||{},{Currency:n})}).catch(function(n){return console.error("fail currencies js",n)}))}catch(n){return Promise.reject(n)}}(),c=function(n,t,e){try{var r=(c=function(n,t){var e=function(n,t){var e,r=(e=n)&&decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null,i=Bn(r);if(r)return{id:i.id,firstSeen:i.firstSeen||0};var o=Gn(),u=o.newId,c=o.newEpoch;return y(n,o.value,Infinity,t,"http:"!==document.location.protocol),{id:u,firstSeen:c}}(n,t),r=e.id,i=e.firstSeen,o=function(n,t){var e=window.localStorage.getItem(n),r=Bn(e);if(e)return{id:r.id,firstSeen:r.firstSeen||1};var i=Gn(t),o=i.newId,u=i.newEpoch;return window.localStorage.setItem(n,i.value),{id:o,firstSeen:u}}(n,r),u=o.id,c=o.firstSeen;return i<=c?(function(n,t,e,r){n!=t&&localStorage.setItem(e,Vn(t,r))}(u,r,n,c),{id:r,firstSeen:i}):(function(n,t,e,r,i){n!=t&&y(e,Vn(n,r),Infinity,i,"http:"!==document.location.protocol)}(u,r,n,i,t),{id:u,firstSeen:c})}(Fn,w()),a=c.firstSeen,{id:c.id,firstSession:(new Date).getTime()/1e3-a<=1800}),u=function(n,t,e){var r=function(){var n=Hn(),t={path:window.location.pathname,host:window.location.hostname};v(function(){return n.length})>0&&(t.cartItems=n);var e=v(function(){return pn().token});e&&(t.cartToken=e);var r=function(){var n,t,e,r=(n=function(n){if(function(n){return!n||"{}"===JSON.stringify(n)}(n))return null;var t={};return n.campaign&&(t.campaign=n.campaign),n.medium&&(t.medium=n.medium),n.source&&(t.source=n.source),n.term&&(t.term=n.term),n.content&&(t.content=n.content),t}(v(function(){return function(n){var t={utm:{}};for(var e in n)if(n.hasOwnProperty(e)){var r=g[e];r&&(t.utm[r]=n[e])}return t}(function(n){for(var t=window.location.search.substring(1),e={},r=("?"===t[0]?t.substr(1):t).split("&"),i=0;i<r.length;i++){var o=r[i].split("=");e[decodeURIComponent(o[0])]=decodeURIComponent(o[1]||"")}return e}()).utm})),t=[],null!=(e=localStorage.getItem(Un))&&(t=[].concat(JSON.parse(e)).slice(0,20)),n&&(n.ts=new Date,t=[n].concat(t)),t);return localStorage.setItem(Un,JSON.stringify(r)),r}();return r&&(t.trafficSources=r),t.productsSeenInSession=Nn(),t.isCustomer="undefined"!=typeof __st&&!!v(function(){return __st.cid}),t.query=window.location.search||"",t}();r.storeAlias=n;var i=(m(function(){var n=new Function(document.querySelector('script[id="__st"]').textContent+";return __st.cid.toString()")();return window.localStorage.setItem("vsly__st",n),!0}),v(function(){return window.__st.cid.toString()})||window.localStorage.getItem("vsly__st"));i&&(r.clientId=i),r.anonymousId=t.id,r.firstSession=t.firstSession,r.gaId=v(function(){return document.cookie.split(";").map(function(n){return n.split("=")}).find(function(n){return"_ga"==n[0].trim()})[1]},"");var u,c=(u="vsly_edgetag",m(function(){return Jn()&&localStorage.setItem(u,Jn()),!0}),v(Jn)||localStorage.getItem(u));c&&(r.edgetag=c);var a,s=function(){try{var n=v(function(){return new URL(window.location.href)});if(v(function(){return n.searchParams.get("forceOverride")})){var t=v(function(){return n.searchParams.get("targeting")});if(t)return JSON.parse(atob(t))}}catch(n){L("preview overrides",n)}return{}}(),f=xn(Rn),d=Tn([{ts:new Date,name:(a=new URL(window.location.href),a.protocol+"//"+a.hostname+a.pathname)}],xn(Dn),function(n){return function(t){return n.name===t.name}},Dn),l=jn(),p=o({deviceKind:v(function(){return window.loomi_ctx.deviceOverride},void 0)},e||{});return o({},r,{queryHistory:f,visitedPages:d,purchasedLineItems:l},p||{},s||{})}(n,r,e);return Promise.resolve(function(n,t){try{var e=pt(t),r=(u=wt(n).cfgUrl,c=function(){[i,Kn].map(function(n){var t=Qn(n);t&&sessionStorage.setItem(n,t)});var n=sessionStorage.getItem(i),t=sessionStorage.getItem(Kn);return{previewKey:n,debugAllocator:Qn(zn),previewVariantId:t}}(),a=c.previewKey,s=c.debugAllocator,f=c.previewVariantId,d=new URL(u),a&&d.searchParams.append(i,a),s&&d.searchParams.append(zn,"true"),f&&d.searchParams.append(Kn,f),d);r.searchParams.append("q",e);var o=window.vslyNativeFetch||window.fetch;return Promise.resolve(o(r.href)).then(function(n){if(n.ok)return Promise.resolve(n.json());throw new Error("failed to load config: "+n.statusText)})}catch(n){return Promise.reject(n)}var u,c,a,s,f,d}(t,u)).then(function(n){return function(n){var t=n.currentVariant;window.loomi_ctx=o({},window.loomi_ctx||{});var e=v(function(){return t.pid});e&&(window.loomi_ctx.productId=""+e);var r=v(function(){return t.vid});r&&(window.loomi_ctx.variantId=""+r);var i=v(function(){return t.price});i&&(window.loomi_ctx.variantPrice=i);var u=v(function(){return t.meta});u&&(window.loomi_ctx.productMeta=""+u)}(n),Tn(n.queryHistory,u.queryHistory,function(n){return function(t){return t.v===n.v&&t.k===n.k}},Rn),function(n){var t;(t=n.experiments)&&t.findIndex(function(n){var t=v(function(){return n.clientTargetingFormula.toString()},"")||"";return t.includes("CartItemHasTag")||t.includes("CartItemHasCollection")})>-1||!0===v(function(){return n.flags["sdk-enable-cart-enrichment"]},!1)&&(n.flags["sdk-enable-cart-enrichment"]=!1)}(n),{configuration:n,tracking:r}})}catch(n){return Promise.reject(n)}var c,a}(t,n,r);return Promise.resolve(Promise.all([c,u])).then(function(r){var i,u,c,a,s,l=r[0],m=l.configuration,g=l.tracking;return i=m.flags,window.visually=o({},v(function(){return window.visually})||{},{flags:i}),localStorage.setItem("loomi-flags",JSON.stringify(i)),function(n,t,e,r,i){Vt(),window.loomi_ctx=o({},v(function(){return window.loomi_ctx})||{},{env:t,storeAlias:n,apply:function(n){$n([n]),Bt(n)}});var u=v(function(){return i.productId}),c=window.loomi_ctx;u&&!c.productId&&(c.productId=u);var a=v(function(){return i.variantId});a&&!c.variantId&&(c.variantId=a),window.loomi=o({},v(function(){return window.loomi})||{},{conf:e}),window.visually=o({},v(function(){return window.visually})||{},{flags:e.flags,sdk_api:{addToCart:Zn,recommendProducts:ut},reload:function(){try{return Promise.resolve(r(t,n,1e3)).then(function(){})}catch(n){return Promise.reject(n)}}})}(t,n,m,Oe,rt()),function(n,t,r){window.loomi_api={},window.loomi_api.when=d,window.loomi_api.awaitCondition=f,window.loomi_api.debounce=b,window.loomi_api.allocatorQuery=function(n){return function(n,t){try{var r=function(){return Promise.resolve(i)},i={results:{}},u=o({},n);u.queries=function(n,t){return n.queries.filter(function(n){var e=v(function(){return n.oneOf.productInfo});if(e){var r=st(e.handle),i=sessionStorage.getItem(r);if(!i)return!0;var o=JSON.parse(i);return!!function(n,t){return!(!n.includeCollections||t.collections)||!(!n.includeTags||t.tags)}(e,o)||(o.cached=!0,t.results[n.name]=o,!1)}var u=v(function(){return n.oneOf.handlesByTag});if(u){var c=ft(u),a=sessionStorage.getItem(c);if(!a)return!0;var s=JSON.parse(a);return s.cached=!0,t.results[n.name]=s,!1}var f=v(function(){return n.oneOf.handlesByCollection});if(f){var d=dt(f),l=sessionStorage.getItem(d);if(!l)return!0;var m=JSON.parse(l);return m.cached=!0,t.results[n.name]=m,!1}return!0})}(n,i);var c=function(){if(u.queries.length>0){var n=function(n,t,e){n.timestamp=""+lt(4)+t+lt(5),n.alias=window.loomi_ctx.storeAlias||"",n.userId=window.loomi_ctx.userId||"";var r=JSON.stringify(n),i=btoa(r);return{query:i,hashedQuery:(i+window.loomi_ctx.userId+window.loomi_ctx.storeAlias+t).split("").reduce(function(n,t){return(n=(n<<5)-n+t.charCodeAt(0))&n},0)}}(u,t),r=n.query,o=n.hashedQuery,c=v(function(){return window.loomi_ctx.env},e.STAGE)===e.PROD?"prod":"stg";return Promise.resolve(fetch("https://sdk.loomi-"+c+".xyz/api/allocator/web/public/query?q="+r+"&h="+o)).then(function(n){var t=function(){if(n.ok)return Promise.resolve(n.json()).then(function(n){n.results&&Object.entries(n.results).forEach(function(n){var t=n[0],e=n[1];!function(n,t,e){if(t)if("ProductInfo"===t.kind){var r=e.queries.find(function(t){return t.name===n});r&&(v(function(){return r.oneOf.productInfo.includeTags},!1)&&!t.tags&&(t.tags=[]),v(function(){return r.oneOf.productInfo.includeCollections},!1)&&!t.collections&&(t.collections=[]),sessionStorage.setItem(st(t.handle),JSON.stringify(t)))}else if("HandlesByCollection"===t.kind){var i=e.queries.find(function(t){return t.name===n});if(i){var o=v(function(){return i.oneOf.handlesByCollection},"")||"";sessionStorage.setItem(dt(o),JSON.stringify(t))}}else if("HandlesByTag"===t.kind){var u=e.queries.find(function(t){return t.name===n});if(u){var c=v(function(){return u.oneOf.handlesByTag},"")||"";sessionStorage.setItem(ft(c),JSON.stringify(t))}}}(t,e,u),i.results[t]=e})})}();if(t&&t.then)return t.then(function(){})})}}();return Promise.resolve(c&&c.then?c.then(r):r())}catch(n){return Promise.reject(n)}}(n,""+((new Date).getTime()+Math.round(1e6*Math.random())))},v(function(){return n.shopApi.forEach(function(n){var t=n.js,e=n.windowKey;try{window.loomi_api[e]=new Function(t)}catch(n){S()("crushed: "+e+","+n)}})}),r()&&(window.loomi_api.formatLocaleMoney=t)}(m,le,ve),c=m.uid,a=g.id,window.loomi_ctx.userId=c||a,c!==a&&(s=Vn(window.loomi_ctx.userId,Yn()),localStorage.setItem(Fn,s),y(Fn,s,Infinity,w(),"http:"!==document.location.protocol)),v(function(){return!0===window.visually.flags["op-focus-trap-removal"]})&&h(function(){return document}).then(function(){document.addEventListener("focusin",de,!0),document.addEventListener("mousedown",de,!0),document.addEventListener("touchstart",de,!0),document.addEventListener("touchend",de,!0)}),function(n,t){if(v(function(){return window.visually.flags["detect-url-changes"]})&&window.location.href.includes("/products/"))var e=function(r){var i=function(){requestAnimationFrame(function(){(v(function(){return window.visually.flags["url-ch-pathname"]})?new URL(Ne).pathname!==new URL(window.location.href).pathname:Ne!==window.location.href)&&(Ne=window.location.href,e(),Ce(n,t,10))})}||he,o=["click","touchend"];return h(function(){return document.body}).then(function(){o.forEach(function(n){return document.body.addEventListener(n,i,!0)})}),function(){p(function(){return document.body}).then(function(){o.forEach(function(n){document.body.removeEventListener(n,i,!0)})})}}()}(n,t),u=Ee,Ie.isAvailable()&&(u=Ie),u.onChangeListener(function(n){Ae(u.provide()),gn(hn.LOYALTY_CHANGE,n)}),Ae(u.provide()),{configuration:m,jitsu:_()}})}catch(n){return Promise.reject(n)}},Oe=function(n,t,e){void 0===e&&(e=1e3);try{return console.debug("vsly-sdk","about to reload sdk"),Promise.resolve(function(){try{return ue.forEach(function(n){try{"number"!=typeof n&&n()}catch(n){S()(""+n)}}),ue=[],Array.from(C.keys()).forEach(function(n){ln(n)}),V&&V.disconnect(),Promise.resolve()}catch(n){return Promise.reject(n)}}()).then(function(){return Promise.resolve((r=e,void 0===r&&(r=40),new Promise(function(n){return setTimeout(n,r)}))).then(function(){return Promise.resolve(Pe(n,t)).then(function(){})});var r})}catch(n){return Promise.reject(n)}},Ce=b(Oe,10),Ne=window.location.href,xe={initialize:Pe};export{xe as default,xe as sdk};
