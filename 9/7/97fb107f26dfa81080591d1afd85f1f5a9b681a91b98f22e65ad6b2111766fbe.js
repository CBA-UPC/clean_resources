!function e(t){this.Hls=function(){"use strict";,v,g,m={exports:{}};h=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,f=/^(?=([^\/?#]*))\1([^]*)$/,c=/(?:\/|^)\.(?=\/)/g,v=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,m.exports=g={buildAbsoluteURL:parseURL:normalizePath:buildURLFromParts:;var p=m.exports,y={}),E={}),T={}),S=function(){},L={trace:S,debug:S,log:S,warn:S,info:S,error:S},b=L;r k=b,D=/^(\d+)x(\d+)$/,_=/(.+?)=(".*?"|.*?)(?:,|$)/g,x=);ar I=function(){function e(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){var r=t.attr;for(var i in r)if(Object.prototype.hasOwnProperty.call(e,i)&&e[i]!==r[i]){k.warn('DATERANGE tag attribute: "'+i+'" does not match for tags with ID: "'+e.ID+'"'),this._badValueForSameId=i;break}e=Object.assign(new x({}),r,e)}if(this.attr=e,this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){var n=new Date(this.attr["END-DATE"]);Number.isFinite(n.getTime())&&(this._endDate=n)}}return i(e,[{key:"id",get:function(){return this.attr.ID}},{key:"class",get:function(){return this.attr.CLASS}},{key:"startDate",get:function(){return this._startDate}},{key:"endDate",get:,{key:"duration",get:function(){if("DURATION"in this.attr){var e=this.attr.decimalFloatingPoint("DURATION");if(Number.isFinite(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}},{key:"plannedDuration",get:,{key:"endOnNext",get:,{key:"isValid",get:function(){return!!this.id&&!this._badValueForSameId&&Number.isFinite(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)}}]),e}(),C=P="audio",F="video",O="audiovideo",M=),N=function(e){(t,e);var r=t.prototype;return r.setKeyFormat=r.abortRequests=r.setElementaryStreamInfo=r.clearElementaryStreamInfo=i(t,[{key:"decryptdata",get:,{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:,{key:"encrypted",get:]),t}(M),B=M),U=function(){eturn e.prototype.reloaded=i(e,[{key:"hasProgramDateTime",get:function(){return!!this.fragments.length&&Number.isFinite(this.fragments[this.fragments.length-1].programDateTime)}},{key:"levelTargetDuration",get:,{key:"drift",get:,{key:"edge",get:,{key:"partEnd",get:,{key:"fragmentEnd",get:,{key:"age",get:,{key:"lastPartIndex",get:,{key:"lastPartSn",get:]),e}();undefined"!=typeof self&&self.navigator&&self.navigator.requestMediaKeySystemAccess&&self.navigator.requestMediaKeySystemAccess.bind(self.navigator);var H,V=function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},K=Y=W=j=q=z=X=Q=$=Z=J=ee=te=ar ie=ne=Math.pow(2,32)-1,ae=[].push,se={video:1,audio:2,id3:3,text:4}; ge(e,t){if(!e||!t)return e;var r=t.keyId;r&&t.isCommonEncryption&&fe(e,["moov","trak"]).forEach(();return e}nction ye(e,t){var r=[],i=t.samples,n=t.timescale,a=t.id,s=!1;return fe(i,["moof"]).map((function(o){var l=o.byteOffset-8;fe(o,["traf"]).map((function(o){var u=fe(o,["tfdt"]).map(()[0];return void 0!==u&&(e=u),fe(o,["tfhd"]).map((function(u){var d=ue(u,4),h=16777215&ue(u,0),f=0,c=0!=(16&h),v=0,g=0!=(32&h),m=8;d===a&&(0!=(1&h)&&(m+=8),0!=(2&h)&&(m+=4),0!=(8&h)&&(f=ue(u,m),m+=4),c&&(v=ue(u,m),m+=4),g&&(m+=4),"video"===t.type&&(s=t.codec)),fe(o,["trun"]).map((function(a){var o=a[0],u=16777215&ue(a,0),d=0!=(1&u),h=0,c=0!=(4&u),g=0!=(256&u),m=0,p=0!=(512&u),y=0,E=0!=(1024&u),T=0!=(2048&u),S=0,L=ue(a,4),b=8;d&&(h=ue(a,b),b+=4),c&&(b+=4);for(var R=h+l,A=0;A<L;A++){if(g?(m=ue(a,b),b+=4):m=f,p?(y=ue(a,b),b+=4):y=v,E&&(b+=4),T&&(S=0===o?ue(a,b):de(a,b),b+=4),t.type===F)for(var k=0;k<y;){var D=ue(i,R);if(Ee(s,i[R+=4]))Te(i.subarray(R,R+D),s?2:1,e+S/n,r);R+=D,k+=D+4}e+=m/n}})))}))}))})),r} Le=);var be=/\{\$([a-zA-Z0-9-_]+)\}/g;={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dva1:!0,dvav:!0,dvh1:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}},Ie=xe();ar Pe=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,Fe=/#EXT-X-MEDIA:(.*)/g,Oe=/^#EXT(?:INF|-X-TARGETDURATION):/m,Me=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),Ne=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),Be=function(){function e(){}return e.findGroup=e.convertAVC1ToAVCOTI=e.resolve=e.isMediaPlaylist=function(e){return Oe.test(e)},e.parseMasterPlaylist=e.parseMasterPlaylistMedia=e.parseLevelPlaylist=function(e,t,r,i,n,a){var s,o,l,u=new U(t),d=u.fragments,h=null,f=0,c=0,v=0,g=0,m=null,p=new N(i,t),y=-1,E=!1;for(Me.lastIndex=0,u.m3u8=e,u.hasVariableRefs=Re(e);null!==(s=Me.exec(e));){E&&(E=!1,(p=new N(i,t)).start=v,p.sn=f,p.cc=g,p.level=r,h&&(p.initSegment=h,p.rawProgramDateTime=h.rawProgramDateTime,h.rawProgramDateTime=null));var T=s[1];if(T){p.duration=parseFloat(T);var S=(" "+s[2]).slice(1);p.title=S||null,p.tagList.push(S?["INF",T,S]:["INF",T])}else if(s[3]){if(Number.isFinite(p.duration)){p.start=v,l&&We(p,l,u),p.sn=f,p.level=r,p.cc=g,p.urlId=n,d.push(p);var L=(" "+s[3]).slice(1);p.relurl=ke(u,L),Ke(p,m),m=p,v+=p.duration,f++,c=0,E=!0}}else if(s[4]){var b=(" "+s[4]).slice(1);m?p.setByteRange(b,m):p.setByteRange(b)}else if(s[5])p.rawProgramDateTime=(" "+s[5]).slice(1),p.tagList.push(["PROGRAM-DATE-TIME",p.rawProgramDateTime]),-1===y&&(y=d.length);else{if(!(s=s[0].match(Ne))){k.warn("No matches on slow regex match for level playlist!");continue}for(o=1;o<s.length&&void 0===s[o];o++);var R=(" "+s[o]).slice(1),A=(" "+s[o+1]).slice(1),D=s[o+2]?(" "+s[o+2]).slice(1):"";switch(R){case"PLAYLIST-TYPE":u.type=A.toUpperCase();break;case"MEDIA-SEQUENCE":f=u.startSN=parseInt(A);break;case"SKIP":var _=new x(A);Ae(u,_,["RECENTLY-REMOVED-DATERANGES"]);var w=_.decimalInteger("SKIPPED-SEGMENTS");if(Number.isFinite(w)){u.skippedSegments=w;for(var C=w;C--;)d.unshift(null);f+=w}var P=_.enumeratedString("RECENTLY-REMOVED-DATERANGES");P&&(u.recentlyRemovedDateranges=P.split("\t"));break;case"TARGETDURATION":u.targetduration=Math.max(parseInt(A),1);break;case"VERSION":u.version=parseInt(A);break;case"EXTM3U":break;case"ENDLIST":u.live=!1;break;case"#":(A||D)&&p.tagList.push(D?[A,D]:[A]);break;case"DISCONTINUITY":g++,p.tagList.push(["DIS"]);break;case"GAP":p.gap=!0,p.tagList.push([R]);break;case"BITRATE":p.tagList.push([R,A]);break;case"DATERANGE":var F=new x(A);Ae(u,F,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),Ae(u,F,F.clientAttrs);var O=new I(F,u.dateRanges[F.ID]);O.isValid||u.skippedSegments?u.dateRanges[O.id]=O:k.warn('Ignoring invalid DATERANGE tag: "'+A+'"'),p.tagList.push(["EXT-X-DATERANGE",A]);break;case"DEFINE":var M=new x(A);Ae(u,M,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in M?_e(u,M,a):De(u,M,t);break;case"DISCONTINUITY-SEQUENCE":g=parseInt(A);break;case"KEY":var G=Ue(A,t,u);if(G.isSupported()){if("NONE"===G.method){l=void 0;break}l||(l={}),l[G.keyFormat]&&(l=Object.assign({},l)),l[G.keyFormat]=G}else k.warn('[Keys] Ignoring invalid EXT-X-KEY tag: "'+A+'"');break;case"START":u.startTimeOffset=Ge(A);break;case"MAP":var H=new x(A);if(Ae(u,H,["BYTERANGE","URI"]),p.duration){var V=new N(i,t);Ye(V,H,r,l),h=V,p.initSegment=h,h.rawProgramDateTime&&!p.rawProgramDateTime&&(p.rawProgramDateTime=h.rawProgramDateTime)}else Ye(p,H,r,l),h=p,E=!0;break;case"SERVER-CONTROL":var K=new x(A);u.canBlockReload=K.bool("CAN-BLOCK-RELOAD"),u.canSkipUntil=K.optionalFloat("CAN-SKIP-UNTIL",0),u.canSkipDateRanges=u.canSkipUntil>0&&K.bool("CAN-SKIP-DATERANGES"),u.partHoldBack=K.optionalFloat("PART-HOLD-BACK",0),u.holdBack=K.optionalFloat("HOLD-BACK",0);break;case"PART-INF":var Y=new x(A);u.partTarget=Y.decimalFloatingPoint("PART-TARGET");break;case"PART":var W=u.partList;W||(W=u.partList=[]);var j=c>0?W[W.length-1]:void 0,q=c++,z=new x(A);Ae(u,z,["BYTERANGE","URI"]);var X=new B(z,p,t,q,j);W.push(X),p.duration+=X.duration;break;case"PRELOAD-HINT":var Q=new x(A);Ae(u,Q,["URI"]),u.preloadHint=Q;break;case"RENDITION-REPORT":var $=new x(A);Ae(u,$,["URI"]),u.renditionReports=u.renditionReports||[],u.renditionReports.push($);break;default:k.warn("line parsed but not handled: "+s)}}}m&&!m.relurl?(d.pop(),v-=m.duration,u.partList&&(u.fragmentHint=m)):u.partList&&(Ke(p,m),p.cc=g,u.fragmentHint=p,l&&We(p,l,u));var Z=d.length,J=d[0],ee=d[Z-1];if((v+=u.skippedSegments*u.targetduration)>0&&Z&&ee){u.averagetargetduration=v/Z;var te=ee.sn;u.endSN="initSegment"!==te?te:0,u.live||(ee.endList=!0),J&&(u.startCC=J.cc)}else u.endSN=0,u.startCC=0;return u.fragmentHint&&(v+=u.fragmentHint.duration),u.totalduration=v,u.endCC=g,y>0&&d,y),u},e}();unction Ge(e){var t=new x(e).decimalFloatingPoint("TIME-OFFSET");return Number.isFinite(t)?t:null}nction Ke(e,t){e.rawProgramDateTime?e.programDateTime=Date.parse(e.rawProgramDateTime):null!=t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime),Number.isFinite(e.programDateTime)||(e.programDateTime=null,e.rawProgramDateTime=null)}r je="manifest",qe="level",ze="audioTrack",Xe="subtitleTrack",Qe="main",$e="audio",Ze="subtitle";r tt=function(){ar t=e.prototype;return t.startLoad=function(e){},t.stopLoad=function(){this.destroyInternalLoaders()},t.registerListeners=function(){var e=this.hls;e.on(y.MANIFEST_LOADING,this.onManifestLoading,this),e.on(y.LEVEL_LOADING,this.onLevelLoading,this),e.on(y.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(y.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},t.unregisterListeners=t.createInternalLoader=t.getInternalLoader=t.resetInternalLoader=t.destroyInternalLoaders=t.destroy=t.onManifestLoading=t.onLevelLoading=t.onAudioTrackLoading=function(e,t){var r=t.id,i=t.groupId,n=t.url,a=t.deliveryDirectives;this.load({id:r,groupId:i,level:null,responseType:"text",type:ze,url:n,deliveryDirectives:a})},t.onSubtitleTrackLoading=t.load=function(e){var t,r,i,n=this,a=this.hls.config,s=this.getInternalLoader(e);if(s){var o=s.context;if(o&&o.url===e.url)return void k.trace("[playlist-loader]: playlist request ongoing");k.log("[playlist-loader]: aborting previous loader for type: "+e.type),s.abort()}if((r=e.type===je?a.manifestLoadPolicy.default:Object.assign({},a.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),s=this.createInternalLoader(e),null!=(t=e.deliveryDirectives)&&t.part)&&(e.type===qe&&null!==e.level?i=this.hls.levels[e.level].details:e.type===ze&&null!==e.id?i=this.hls.audioTracks[e.id].details:e.type===Xe&&null!==e.id&&(i=this.hls.subtitleTracks[e.id].details),i)){var l=i.partTarget,u=i.targetduration;if(l&&u){var d=1e3*Math.max(3*l,.8*u);r=Object.assign({},r,{maxTimeToFirstByteMs:Math.min(d,r.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(d,r.maxTimeToFirstByteMs)})}}var h=r.errorRetry||r.timeoutRetry||{},f={loadPolicy:r,timeout:r.maxLoadTimeMs,maxRetry:h.maxNumRetry||0,retryDelay:h.retryDelayMs||0,maxRetryDelay:h.maxRetryDelayMs||0},c={onSuccess:onError:onTimeout:;s.load(e,f,c)},t.handleMasterPlaylist=t.handleTrackOrLevelPlaylist=function(e,t,r,i,n){var a=this.hls,s=r.id,o=r.level,l=r.type,u=et(e,r),d=Number.isFinite(s)?s:0,h=Number.isFinite(o)?o:d,f=Je(r),c=Be.parseLevelPlaylist(e.data,u,h,f,d,this.variableList);if(l===je){var v={attrs:new x({}),bitrate:0,details:c,name:"",url:u};a.trigger(y.MANIFEST_LOADED,{levels:[v],audioTracks:[],url:u,stats:t,networkDetails:i,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),r.levelDetails=c,this.handlePlaylistLoaded(c,e,t,r,i,n)},t.handleManifestParsingError=t.handleNetworkError=t.handlePlaylistLoaded=e}();r nt="org.id3",at="com.apple.quicktime.HLS",st="https://aomedia.org/emsg/ID3";ar lt=);ar dt=function(){ar t=e.prototype;return t.destroy=t._registerListeners=function(){var e=this.hls;e.on(y.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(y.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(y.MANIFEST_LOADING,this.onManifestLoading,this),e.on(y.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(y.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(y.LEVEL_UPDATED,this.onLevelUpdated,this)},t._unregisterListeners=t.onMediaAttached=function(e,t){this.media=t.media},t.onMediaDetaching=t.onManifestLoading=t.createTrack=t.getID3Track=t.onFragParsingMetadata=t.updateId3CueEnds=t.onBufferFlushing=t.onLevelUpdated=function(e,t){var r=this,i=t.details;if(this.media&&i.hasProgramDateTime&&this.hls.config.enableDateRangeMetadataCues){var n=this.dateRangeCuesAppended,a=this.id3Track,s=i.dateRanges,o=Object.keys(s);if(a)for(var l=Object.keys(n).filter((),u=d=l.length;d--;)u();var h=i.fragments[i.fragments.length-1];if(0!==o.length&&Number.isFinite(null==h?void 0:h.programDateTime)){this.id3Track||(this.id3Track=this.createTrack(this.media));for(var f=h.programDateTime/1e3-h.start,c=ot(),v=g=0;g<o.length;g++)v()}}},e}(),ht=),ft=["NONE","TYPE-0","TYPE-1",null],ct="",vt="YES",gt="v2";var mt=),pt=);function yt(e,t){var r=t.startPTS;if(Number.isFinite(r)){var i,n=0;t.sn>e.sn?(n=r-e.start,i=e):(n=e.start-r,i=t),i.duration!==n&&(i.duration=n)}else if(t.sn>e.sn){e.cc===t.cc&&e.minEndPTS?t.start=e.start+(e.minEndPTS-e.start):t.start=e.start+e.duration}else t.start=Math.max(e.start-t.duration,0)}function Et(e,t,r,i,n,a){i-r<=0&&(k.warn("Fragment should have a positive duration",t),i=r+t.duration,a=n+t.duration);var s=r,o=i,l=t.startPTS,u=t.endPTS;if(Number.isFinite(l)){var d=Math.abs(l-r);Number.isFinite(t.deltaPTS)?t.deltaPTS=Math.max(d,t.deltaPTS):t.deltaPTS=d,s=Math.max(r,l),r=Math.min(r,l),n=Math.min(n,t.startDTS),o=Math.min(i,u),i=Math.max(i,u),a=Math.max(a,t.endDTS)}var h=r-t.start;0!==t.start&&(t.start=r),t.duration=i-t.start,t.startPTS=r,t.maxStartPTS=s,t.startDTS=n,t.endPTS=i,t.minEndPTS=o,t.endDTS=a;var f,c=t.sn;if(!e||c<e.startSN||c>e.endSN)return 0;var v=c-e.startSN,g=e.fragments;for(g[v]=t,f=v;f>0;f--)yt(g[f],g[f-1]);for(f=v;f<g.length-1;f++)yt(g[f],g[f+1]);return e.fragmentHint&&yt(g[g.length-1],e.fragmentHint),e.PTSKnown=e.alignedSliding=!0,h}function Tt(e,t){for(var r=null,i=e.fragments,n=i.length-1;n>=0;n--){var a=i[n].initSegment;if(a){r=a;break}}e.fragmentHint&&delete e.fragmentHint.endPTS;var s,o=0;(e,t,(function(e,i){e.relurl&&(o=e.cc-i.cc),Number.isFinite(e.startPTS)&&Number.isFinite(e.endPTS)&&(i.start=i.startPTS=e.startPTS,i.startDTS=e.startDTS,i.maxStartPTS=e.maxStartPTS,i.endPTS=e.endPTS,i.endDTS=e.endDTS,i.minEndPTS=e.minEndPTS,i.duration=e.endPTS-e.startPTS,i.duration&&(s=i),t.PTSKnown=t.alignedSliding=!0),i.elementaryStreams=e.elementaryStreams,i.loader=e.loader,i.stats=e.stats,i.urlId=e.urlId,e.initSegment&&(i.initSegment=e.initSegment,r=e.initSegment)})),r)&&(t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments).forEach(();if(t.skippedSegments)if(t.deltaUpdateFailed=t.fragments.some((function(e){return!e})),t.deltaUpdateFailed){k.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var l=t.skippedSegments;l--;)t.fragments.shift();t.startSN=t.fragments[0].sn,t.startCC=t.fragments[0].cc}else t.canSkipDateRanges&&(t.dateRanges=function(e,t,r){var i=Object.assign({},e);r&&r.forEach(();return Object.keys(t).forEach((),i}(e.dateRanges,t.dateRanges,t.recentlyRemovedDateranges));var u=t.fragments;if(o){k.warn("discontinuity sliding from playlist, take drift into account");for(var d=0;d<u.length;d++)u[d].cc+=o}t.skippedSegments&&(t.startCC=t.fragments[0].cc),e.partList,t.partList,(),s?Et(t,s,s.startPTS,s.endPTS,s.startDTS,s.endDTS):St(e,t),u.length&&(t.totalduration=t.edge-u[0].start),t.driftStartTime=e.driftStartTime,t.driftStart=e.driftStart;var h=t.advancedDateTime;if(t.advanced&&h){var f=t.edge;t.driftStart||(t.driftStartTime=h,t.driftStart=f),t.driftEndTime=h,t.driftEnd=f}else t.driftEndTime=e.driftEndTime,t.driftEnd=e.driftEnd,t.advancedDateTime=e.advancedDateTime}on Dt(e){return n({},e,{errorRetry:null,timeoutRetry:null})}ar xt={search:;function wt(e,t,r,i){void 0===r&&(r=0),void 0===i&&(i=0);var n=null;if(e?n=t[e.sn-t[0].sn+1]||null:0===r&&0===t[0].start&&(n=t[0]),n&&0===It(r,i,n))return n;var a=xt.search(t,It.bind(null,r,i));return!a||a===e&&n?n:a}r Pt=3e5,Ft=0,Ot=2,Mt=5,Nt=0,Bt=1,Ut=2,Gt=function(){ar t=e.prototype;return t.registerListeners=function(){var e=this.hls;e.on(y.ERROR,this.onError,this),e.on(y.MANIFEST_LOADING,this.onManifestLoading,this),e.on(y.LEVEL_UPDATED,this.onLevelUpdated,this)},t.unregisterListeners=t.destroy=t.startLoad=t.stopLoad=function(){},t.getVariantLevelIndex=t.onManifestLoading=t.onLevelUpdated=function(){this.playlistError=0},t.onError=t.getPlaylistRetryOrSwitchAction=t.getFragRetryOrSwitchAction=t.getLevelSwitchAction=t.onErrorOut=t.sendAlternateToPenaltyBox=t.switchLevel=t.redundantFailover=function(e){var t=this,r=this.hls,i=this.penalizedRenditions,n=e.parent===Qe?e.level:r.loadLevel,a=r.levels[n],s=a.url.length,o=e.frag?e.frag.urlId:a.urlId;a.urlId!==o||e.frag&&!a.details||this.penalizeRendition(a,e);for(var l,u=d=1;d<s;d++)if(l=u())return l.v;return!1},t.penalizeRendition=e}();var Ht,Vt=function(){ar t=e.prototype;return t.destroy=t.clearTimer=t.startLoad=t.stopLoad=t.switchParams=t.loadPlaylist=t.shouldLoadPlaylist=t.shouldReloadPlaylist=t.playlistLoaded=function(e,t,r){var i=this,n=t.details,a=t.stats,s=self.performance.now(),o=a.loading.first?Math.max(0,s-a.loading.first):0;if(n.advancedDateTime=Date.now()-o,n.live||null!=r&&r.live){if(n.reloaded(r),r&&this.log("live playlist "+e+" "+(n.advanced?"REFRESHED "+n.lastPartSn+"-"+n.lastPartIndex:"MISSED")),r&&n.fragments.length>0&&Tt(r,n),!this.canLoad||!n.live)return;var l,u=void 0,d=void 0;if(n.canBlockReload&&n.endSN&&n.advanced){var h=this.hls.config.lowLatencyMode,f=n.lastPartSn,c=n.endSN,v=n.lastPartIndex,g=f===c;-1!==v?(u=g?c+1:f,d=g?h?0:v:v+1):u=c+1;var m=n.age,p=m+n.ageHeader,y=Math.min(p-n.partTarget,1.5*n.targetduration);if(y>0){if(r&&y>r.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+r.tuneInGoal+" to: "+y+" with playlist age: "+n.age),y=0;else{var E=Math.floor(y/n.targetduration);if(u+=E,void 0!==d)d+=Math.round(y%n.targetduration/n.partTarget);this.log("CDN Tune-in age: "+n.ageHeader+"s last advanced "+m.toFixed(2)+"s goal: "+y+" skip sn "+E+" to part "+d)}n.tuneInGoal=y}if(l=this.getDeliveryDirectives(n,t.deliveryDirectives,u,d),h||!g)return void this.loadPlaylist(l)}else n.canBlockReload&&(l=this.getDeliveryDirectives(n,t.deliveryDirectives,u,d));var T=this.hls.mainForwardBufferInfo,S=T?T.end-T.len:0,L=n,1e3*(n.edge-S));n.updated&&s>this.requestScheduled+L&&(this.requestScheduled=a.loading.start),void 0!==u&&n.canBlockReload?this.requestScheduled=a.loading.first+L-(1e3*n.partTarget||1e3):-1===this.requestScheduled||this.requestScheduled+L<s?this.requestScheduled=s:this.requestScheduled-s<=0&&(this.requestScheduled+=L);var b=this.requestScheduled-s;b=Math.max(0,b),this.log("reload live playlist "+e+" in "+Math.round(b)+" ms"),this.timer=self.setTimeout((function(){return i.loadPlaylist(l)}),b)}else this.clearTimer()},t.getDeliveryDirectives=t.checkRetry=e}(),Kt=function(e){(t,e);var r=t.prototype;return r._registerListeners=function(){var e=this.hls;e.on(y.MANIFEST_LOADING,this.onManifestLoading,this),e.on(y.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(y.LEVEL_LOADED,this.onLevelLoaded,this),e.on(y.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(y.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(y.FRAG_LOADED,this.onFragLoaded,this),e.on(y.ERROR,this.onError,this)},r._unregisterListeners=r.destroy=r.startLoad=r.resetLevels=r.onManifestLoading=function(e,t){this.resetLevels()},r.onManifestLoaded=r.filterAndSortMediaOptions=r.onError=r.onFragLoaded=r.onLevelLoaded=r.onAudioTrackSwitched=r.loadPlaylist=r.removeLevel=r.onLevelsUpdated=i(t,[{key:"levels",get:,{key:"level",get:function(){return this.currentLevelIndex},set:function(e){var t=this._levels;if(0!==t.length){if(e<0||e>=t.length){var r=new Error("invalid level idx"),i=e<0;if(this.hls.trigger(y.ERROR,{type:E.OTHER_ERROR,details:T.LEVEL_SWITCH_ERROR,level:e,fatal:i,error:r,reason:r.message}),i)return;e=Math.min(e,t.length-1)}var n=this.currentLevelIndex,a=this.currentLevel,s=a?a.attrs["PATHWAY-ID"]:void 0,o=t[e],l=o.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=o,n!==e||!o.details||!a||s!==l){this.log("Switching to level "+e+(l?" with Pathway "+l:"")+" from level "+n+(s?" with Pathway "+s:""));var u=Object.assign({},o,{level:e,maxBitrate:o.maxBitrate,attrs:o.attrs,uri:o.uri,urlId:o.urlId});delete u._attrs,delete u._urlId,this.hls.trigger(y.LEVEL_SWITCHING,u);var d=o.details;if(!d||d.live){var h=this.switchParams(o.uri,null==a?void 0:a.details);this.loadPlaylist(h)}}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:,{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:set:function(e){this._startLevel=e}},{key:"nextLoadLevel",get:set:]),t}(Vt);r jt="NOT_LOADED",qt="APPENDING",zt="PARTIAL",Xt="OK",Qt=);r Jt=Math.pow(2,17),er=);function tr(e,t){void 0===t&&(t=null);var r=t||e,i={frag:e,part:t,responseType:"arraybuffer",url:r.url,headers:{},rangeStart:0,rangeEnd:0},n=r.byteRangeStartOffset,a=r.byteRangeEndOffset;if(Number.isFinite(n)&&Number.isFinite(a)){var s,o=n,l=a;if("initSegment"===e.sn&&"AES-128"===(null==(s=e.decryptdata)?void 0:s.method)){var u=a-n;u%16&&(l=a+(16-u%16)),0!==n&&(i.resetIV=!0,o=n-16)}i.rangeStart=o,i.rangeEnd=l}return i}ar ir=u(Error)),nr=function(){ar t=e.prototype;return t.abort=t.detach=t.destroy=t.createKeyLoadError=t.loadClear=function(e,t){var r=this;if(this.emeController&&this.config.emeEnabled)for(var i=e.sn,n=e.cc,a=s=0;s<t.length&&!a();s++);},t.load=t.loadInternal=t.loadKeyEME=t.loadKeyHTTP=t.resetLoader=e}(),ar=),sr={length:0,start:function(){return 0},end:,or=),lr=nction hr(e,t,r){t&&(!function(e,t,r){if(e,r,t)){var i=function(e,t,r){var i=e.fragments,n=t.fragments;if(n.length&&i.length){var a=i,n[0].cc);if(a&&(!a||a.startPTS))return a;k.log("No frag in previous level to align on")}else k.log("No fragments to align")}(r.details,t);i&&Number.isFinite(i.start)&&(k.log("Adjusting PTS using last level due to CC increase within current level "+t.url),dr(i.start,t))}}(e,r,t),!r.alignedSliding&&t.details&&function(e,t){if(!t.fragments.length||!e.hasProgramDateTime||!t.hasProgramDateTime)return;var r=t.fragments[0].programDateTime,i=e.fragments[0].programDateTime,n=(i-r)/1e3+t.fragments[0].start;n&&Number.isFinite(n)&&(k.log("Adjusting PTS using programDateTime delta "+(i-r)+"ms, sliding:"+n.toFixed(3)+" "+e.url+" "),dr(n,e))}(r,t.details),r.alignedSliding||!t.details||r.skippedSegments||St(t.details,r))}var fr=),cr=);var vr=),gr=),mr=pr="STOPPED",yr="IDLE",Er="KEY_LOADING",Tr="FRAG_LOADING",Sr="FRAG_LOADING_WAITING_RETRY",Lr="PARSING",br="PARSED",Rr="ENDED",Ar="ERROR",kr="WAITING_LEVEL",Dr=function(e){(t,e);var r=t.prototype;return r.doTick=function(){this.onTickEnd()},r.onTickEnd=function(){},r.startLoad=function(e){},r.stopLoad=r._streamEnded=r.getLevelDetails=r.onMediaAttached=r.onMediaDetaching=r.onMediaSeeking=function(){var e=this.config,t=this.fragCurrent,r=this.media,i=this.mediaBuffer,n=this.state,a=r?r.currentTime:0,s=or.bufferInfo(i||r,a,e.maxBufferHole);if(this.log("media seeking to "+(Number.isFinite(a)?a.toFixed(3):a)+", state: "+n),this.state===Rr)this.resetLoadingState();else if(t){var o=e.maxFragLookUpTolerance,l=t.start-o,u=t.start+t.duration+o;if(!s.len||u<s.start||l>s.end){var d=a>u;(a<l||d)&&(d&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}r&&(this.fragmentTracker.removeFragmentsInRange(a,1/0,this.playlistType,!0),this.lastCurrentTime=a),this.loadedmetadata||s.len||(this.nextLoadPosition=this.startPosition=a),this.tickImmediate()},r.onMediaEnded=r.onManifestLoaded=r.onHandlerDestroying=r.onHandlerDestroyed=r.loadFragment=r._loadFragForPlayback=r.clearTrackerIfNeeded=r.flushMainBuffer=r._loadInitSegment=r.fragContextChanged=r.fragBufferedComplete=r.seekToStartPos=function(){},r._handleFragmentLoadComplete=r._handleFragmentLoadProgress=r._doFragLoad=function(e,t,r,i){var n,a=this;void 0===r&&(r=null);var s=null==t?void 0:t.details;if(!this.levels||!s)throw new Error("frag load aborted, missing level"+(s?"":" detail")+"s");var o=null;if(!e.encrypted||null!=(n=e.decryptdata)&&n.key?!e.encrypted&&s.encryptedFragments.length&&this.keyLoader.loadClear(e,s.encryptedFragments):(this.log("Loading key for "+e.sn+" of ["+s.startSN+"-"+s.endSN+"], "+("[stream-controller]"===this.logPrefix?"level":"track")+" "+e.level),this.state=Er,this.fragCurrent=e,o=this.keyLoader.load(e).then((),this.hls.trigger(y.KEY_LOADING,{frag:e}),null===this.fragCurrent&&(o=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))),r=Math.max(e.start,r||0),this.config.lowLatencyMode&&"initSegment"!==e.sn){var l=s.partList;if(l&&i){r>e.end&&s.fragmentHint&&(e=s.fragmentHint);var u=this.getNextPart(l,e,r);if(u>-1){var d,h=l[u];return this.log("Loading part sn: "+e.sn+" p: "+h.index+" cc: "+e.cc+" of playlist ["+s.startSN+"-"+s.endSN+"] parts [0-"+u+"-"+(l.length-1)+"] "+("[stream-controller]"===this.logPrefix?"level":"track")+": "+e.level+", target: "+parseFloat(r.toFixed(3))),this.nextLoadPosition=h.start+h.duration,this.state=Tr,d=o?o.then(().catch((function(e){return a.handleFragLoadError(e)})):this.doFragPartsLoad(e,h,t,i).catch((function(e){return a.handleFragLoadError(e)})),this.hls.trigger(y.FRAG_LOADING,{frag:e,part:h,targetBufferTime:r}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):d}if(!e.url||this.loadedEndOfParts(l,r))return Promise.resolve(null)}}this.log("Loading fragment "+e.sn+" cc: "+e.cc+" "+(s?"of ["+s.startSN+"-"+s.endSN+"] ":"")+("[stream-controller]"===this.logPrefix?"level":"track")+": "+e.level+", target: "+parseFloat(r.toFixed(3))),Number.isFinite(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=Tr;var f,c=this.config.progressive;return f=c&&o?o.then(().catch((function(e){return a.handleFragLoadError(e)})):Promise.all([this.fragmentLoader.load(e,c?i:void 0),o]).then(().catch((function(e){return a.handleFragLoadError(e)})),this.hls.trigger(y.FRAG_LOADING,{frag:e,targetBufferTime:r}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):f},r.doFragPartsLoad=r.handleFragLoadError=r._handleTransmuxerFlush=r.getCurrentContext=r.bufferFragmentData=r.flushBufferGap=r.getFwdBufferInfo=function(e,t){var r=this.getLoadPosition();return Number.isFinite(r)?this.getFwdBufferInfoAtPos(e,r,t):null},r.getFwdBufferInfoAtPos=r.getMaxBufferLength=r.reduceMaxBufferLength=r.getAppendedFrag=r.getNextFragment=r.isLoopLoading=r.getNextFragmentLoopLoading=r.mapToInitFragWhenRequired=r.getNextPart=r.loadedEndOfParts=r.getInitialLiveFragment=function(e,t){var r=this.fragPrevious,i=null;if(r){if(e.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+r.programDateTime),i=function(e,t,r){if(null===t||!Array.isArray(e)||!e.length||!Number.isFinite(t))return null;if(t<(e[0].programDateTime||0))return null;if(t>=(e[e.length-1].endProgramDateTime||0))return null;r=r||0;for(var i=0;i<e.length;++i){var n=e[i];if(Ct(t,r,n))return n}return null}(t,r.endProgramDateTime,this.config.maxFragLookUpTolerance)),!i){var n=r.sn+1;if(n>=e.startSN&&n<=e.endSN){var a=t[n-e.startSN];r.cc===a.cc&&(i=a,this.log("Live playlist, switching playlist, load frag with next SN: "+i.sn))}i||(i=t,r.cc),i&&this.log("Live playlist, switching playlist, load frag with same CC: "+i.sn))}}else{var s=this.hls.liveSyncPosition;null!==s&&(i=this.getFragmentAtPosition(s,this.bitrateTest?e.fragmentEnd:e.edge,e))}return i},r.getFragmentAtPosition=r.synchronizeToLiveEdge=r.alignPlaylists=function(e,t){var r=this.levels,i=this.levelLastLoaded,n=this.fragPrevious,a=null!==i?r[i]:null,s=e.fragments.length;if(!s)return this.warn("No fragments in live playlist"),0;var o=e.fragments[0].start,l=!t,u=e.alignedSliding&&Number.isFinite(o);if(l||!u&&!o){hr(n,a,e);var d=e.fragments[0].start;return this.log("Live playlist sliding: "+d.toFixed(2)+" start-sn: "+(t?t.startSN:"na")+"->"+e.startSN+" prev-sn: "+(n?n.sn:"na")+" fragments: "+s),d}return o},r.waitForCdnTuneIn=r.setStartPosition=function(e,t){var r=this.startPosition;if(r<t&&(r=-1),-1===r||-1===this.lastCurrentTime){var i=null!==this.startTimeOffset,n=i?this.startTimeOffset:e.startTimeOffset;null!==n&&Number.isFinite(n)?(r=t+n,n<0&&(r+=e.totalduration),r=Math.min(Math.max(t,r),t+e.totalduration),this.log("Start time offset "+n+" found in "+(i?"multivariant":"media")+" playlist, adjust startPosition to "+r),this.startPosition=r):e.live?r=this.hls.liveSyncPosition||t:this.startPosition=r=0,this.lastCurrentTime=r}this.nextLoadPosition=r},r.getLoadPosition=r.handleFragLoadAborted=r.resetFragmentLoading=r.onFragmentOrKeyLoadError=r.reduceLengthAndFlushBuffer=r.resetFragmentErrors=r.afterBufferFlushed=r.resetLoadingState=r.resetStartWhenNotLoaded=r.resetWhenMissingContext=r.removeUnbufferedFrags=r.updateLevelTiming=r.resetTransmuxer=r.recoverWorkerError=i(t,[{key:"state",get:function(){return this._state},set:]),t}(ar);r wr=function(){ar t=e.prototype;return t.resetInitSegment=t.resetTimeStamp=t.resetContiguity=t.canParse=t.appendFrame=t.demux=function(e,t){this.cachedData&&(e=pe(this.cachedData,e),this.cachedData=null);var r,i=Y(e,0),n=i?i.length:0,a=this._audioTrack,s=this._id3Track,o=i?i):void 0,l=e.length;for((null===this.basePTS||0===this.frameIndex&&Number.isFinite(o))&&(this.basePTS=Ir(o,t,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),i&&i.length>0&&s.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:nt,duration:Number.POSITIVE_INFINITY});n<l;){if(this.canParse(e,n)){var u=this.appendFrame(a,e,n);u?(this.frameIndex++,this.lastPTS=u.sample.pts,r=n+=u.length):n=l}else j(e,n)?(i=Y(e,n),s.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:nt,duration:Number.POSITIVE_INFINITY}),r=n+=i.length):n++;if(n===l&&r!==l){var d=G(e,r);this.cachedData?this.cachedData=pe(this.cachedData,d):this.cachedData=d}}return{audioTrack:a,videoTrack:xr(),id3Track:s,textTrack:xr()}},t.demuxSampleAes=t.flush=t.destroy=function(){},e}(),Ir=function(e,t,r){return Number.isFinite(e)?90*e:9e4*t+(r?9e4*r.baseTime/r.timescale:0)};ction Or(e,t){return t+1<e.length&&Cr(e,t)}Gr=wr),Hr=/\/emsg[-/]ID3/i,Vr=function(){ar t=e.prototype;return t.resetTimeStamp=function(){},t.resetInitSegment=t.resetContiguity=function(){this.remainderData=null},e.probe=t.demux=t.flush=t.extractID3Track=function(e,t){var r=this.id3Track;if(e.samples.length){var i=fe(e.samples,["emsg"]);i&&i.forEach((function(e){var i=e);if(Hr.test(i.schemeIdUri)){var n=Number.isFinite(i.presentationTime)?i.presentationTime/i.timeScale:t+i.presentationTimeDelta/i.timeScale,a=4294967295===i.eventDuration?Number.POSITIVE_INFINITY:i.eventDuration/i.timeScale;a<=.001&&(a=Number.POSITIVE_INFINITY);var s=i.payload;r.samples.push({data:s,len:s.byteLength,dts:n,pts:n,type:st,duration:a})}}))}return r},t.demuxSampleAes=t.destroy=function(){},e}(),Kr=null,Yr=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],Wr=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],jr=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],qr=[0,1,1,4];r=),ei=function(){ar t=e.prototype;return t.decryptBuffer=t.decryptAacSample=t.decryptAacSamples=t.getAvcEncryptedData=t.getAvcDecryptedUnit=t.decryptAvcSample=t.decryptAvcSamples=e}(),ti=188,ri=function(){.probe=e.syncOffset=e.createTrack=var t=e.prototype;return t.resetInitSegment=t.resetTimeStamp=function(){},t.resetContiguity=t.demux=t.flush=t.extractRemainingSamples=t.demuxSampleAes=t.decrypt=t.destroy=function(){this._duration=0},t.parseAVCPES=t.getLastNalUnit=t.parseAVCNALu=t.parseAACPES=t.parseMPEGPES=t.parseID3PES=function(e,t){if(void 0!==t.pts){var r=Object.assign({},t,{type:this._avcTrack?st:nt,duration:Number.POSITIVE_INFINITY});e.samples.push(r)}else k.warn("[tsdemuxer]: ID3 PES unknown PTS")},e}();=wr),di=),hi=Math.pow(2,32)-1,fi=);fi.types=void 0,fi.HDLR_TYPES=void 0,fi.STTS=void 0,fi.STSC=void 0,fi.STCO=void 0,fi.STSZ=void 0,fi.VMHD=void 0,fi.SMHD=void 0,fi.STSD=void 0,fi.FTYP=void 0,fi.DINF=void 0;ar vi=null,gi=null,mi=function(){ar t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=t.resetNextTimestamp=t.resetInitSegment=t.getVideoStartPts=t.remux=t.generateIS=function(e,t,r,i){var n,a,s,o=e.samples,l=t.samples,u=this.typeSupported,d={},h=this._initPTS,f=!h||i,c="audio/mp4";if(f&&(n=a=1/0),e.config&&o.length){if(e.timescale=e.samplerate,"mp3"===e.segmentCodec)u.mpeg?(c="audio/mpeg",e.codec=""):u.mp3&&(e.codec="mp3");d.audio={id:"audio",container:c,codec:e.codec,initSegment:"mp3"===e.segmentCodec&&u.mpeg?new Uint8Array(0):fi.initSegment([e]),metadata:{channelCount:e.channelCount}},f&&(s=e.inputTimeScale,h&&s===h.timescale?f=!1:n=a=o[0].pts-Math.round(s*r))}if(t.sps&&t.pps&&l.length&&(t.timescale=t.inputTimeScale,d.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:fi.initSegment([t]),metadata:{width:t.width,height:t.height}},f))if(s=t.inputTimeScale,h&&s===h.timescale)f=!1;else{var v=this.getVideoStartPts(l),g=Math.round(s*r);a=Math.min(a,pi(l[0].dts,v)-g),n=Math.min(n,v-g)}if(Object.keys(d).length)return this.ISGenerated=!0,f?(this._initPTS={baseTime:n,timescale:s},this._initDTS={baseTime:a,timescale:s}):n=s=void 0,{tracks:d,initPTS:n,timescale:s}},t.remuxVideo=function(e,t,r,i){var n,a,s=e.inputTimeScale,o=e.samples,l=[],u=o.length,d=this._initPTS,h=this.nextAvcDts,f=8,c=this.videoSampleDuration,v=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,m=!1;r&&null!==h||(h=t*s-(o[0].pts-pi(o[0].dts,o[0].pts)));for(var p=d.baseTime*s/d.timescale,S=0;S<u;S++){var L=o[S];L.pts=pi(L.pts-p,h),L.dts=pi(L.dts-p,h),L.dts<o[S>0?S-1:S].dts&&(m=!0)}m&&o.sort((),n=o[0].dts;var b=(a=o[o.length-1].dts)-n,R=b?Math.round(b/(u-1)):c||e.inputTimeScale/30;if(r){var A=n-h,D=A>R,_=A<-1;if((D||_)&&(D?k.warn("AVC: "+ci(A,!0)+" ms ("+A+"dts) hole between fragments detected, filling it"):k.warn("AVC: "+ci(-A,!0)+" ms ("+A+"dts) overlapping between fragments detected"),!_||h>=o[0].pts)){n=h;var x=o[0].pts-A;o[0].dts=n,o[0].pts=x,k.log("Video: First PTS/DTS adjusted: "+ci(x,!0)+"/"+ci(n,!0)+", delta: "+ci(A,!0)+" ms")}}n=Math.max(0,n);for(var w=0,I=0,C=0;C<u;C++){for(var P=o[C],F=P.units,O=F.length,M=0,N=0;N<O;N++)M+=F[N].data.length;I+=M,w+=O,P.length=M,P.dts=Math.max(P.dts,n),v=Math.min(P.pts,v),g=Math.max(P.pts,g)}a=o[u-1].dts;var B,U=I+4*w+8;try{B=new Uint8Array(U)}catch(e){return void this.observer.emit(y.ERROR,y.ERROR,{type:E.MUX_ERROR,details:T.REMUX_ALLOC_ERROR,fatal:!1,error:e,bytes:U,reason:"fail allocating video mdat "+U})}var G=new DataView(B.buffer);G.setUint32(0,U),B.set(fi.types.mdat,4);for(var H=!1,V=Number.POSITIVE_INFINITY,K=Number.POSITIVE_INFINITY,Y=Number.NEGATIVE_INFINITY,W=Number.NEGATIVE_INFINITY,j=0;j<u;j++){for(var q=o[j],z=q.units,X=0,Q=0,$=z.length;Q<$;Q++){var Z=z[Q],J=Z.data,ee=Z.data.byteLength;G.setUint32(f,ee),f+=4,B.set(J,f),f+=ee,X+=4+ee}var te=void 0;if(j<u-1)c=o[j+1].dts-q.dts,te=o[j+1].pts-q.pts;else{var re=this.config,ie=j>0?q.dts-o[j-1].dts:R;if(te=j>0?q.pts-o[j-1].pts:R,re.stretchShortVideoTrack&&null!==this.nextAudioPts){var ne=Math.floor(re.maxBufferHole*s),ae=(i?v+i*s:this.nextAudioPts)-q.pts;ae>ne?((c=ae-ie)<0?c=ie:H=!0,k.log("[mp4-remuxer]: It is approximately "+ae/90+" ms to the next segment; using duration "+c/90+" ms for the last video frame.")):c=ie}else c=ie}var se=Math.round(q.pts-q.dts);V=Math.min(V,c),Y=Math.max(Y,c),K=Math.min(K,te),W=Math.max(W,te),l.push(new Si(q.key,c,X,se))}if(l.length)if(vi){if(vi<70){var oe=l[0].flags;oe.dependsOn=2,oe.isNonSync=0}}else if(gi&&W-K<Y-V&&R/Y<.025&&0===l[0].cts){k.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");for(var le=n,ue=0,de=l.length;ue<de;ue++){var he=le+l[ue].duration,fe=le+l[ue].cts;if(ue<de-1){var ce=he+l[ue+1].cts;l[ue].duration=ce-fe}else l[ue].duration=ue?l[ue-1].duration:R;l[ue].cts=0,le=he}}c=H||!c?R:c,this.nextAvcDts=h=a+c,this.videoSampleDuration=c,this.isVideoContiguous=!0;var ve={data1:fi.moof(e.sequenceNumber++,n,Object.assign({},e,{samples:l})),data2:B,startPTS:v/s,endPTS:(g+c)/s,startDTS:n/s,endDTS:h/s,type:"video",hasAudio:!1,hasVideo:!0,nb:l.length,dropped:e.dropped};return e.samples=[],e.dropped=0,ve},t.remuxAudio=function(e,t,r,i,n){var a=e.inputTimeScale,s=a/(e.samplerate?e.samplerate:a),o="aac"===e.segmentCodec?1024:1152,l=o*s,u=this._initPTS,d="mp3"===e.segmentCodec&&this.typeSupported.mpeg,h=[],f=void 0!==n,c=e.samples,v=d?0:8,g=this.nextAudioPts||-1,m=t*a,p=u.baseTime*a/u.timescale;if(this.isAudioContiguous=r=r||c.length&&g>0&&(i&&Math.abs(m-g)<9e3||Math.abs(pi(c[0].pts-p,m)-g)<20*l),c.forEach((),!r||g<0){if(c=c.filter((),!c.length)return;g=0===n?0:i&&!f?Math.max(0,m):c[0].pts}if("aac"===e.segmentCodec)for(var S=this.config.maxAudioFramesDrift,L=0,b=g;L<c.length;L++){var R=c[L],A=R.pts,D=A-b,_=Math.abs(1e3*D/a);if(D<=-S*l&&f)0===L&&(k.warn("Audio frame @ "+(A/a).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*D/a)+" ms."),this.nextAudioPts=g=b=A);else if(D>=S*l&&_<1e4&&f){var x=Math.round(D/l);(b=A-x*l)<0&&(x--,b+=l),0===L&&(this.nextAudioPts=g=b),k.warn("[mp4-remuxer]: Injecting "+x+" audio frame @ "+(b/a).toFixed(3)+"s due to "+Math.round(1e3*D/a)+" ms gap.");for(var w=0;w<x;w++){var I=Math.max(b,0),C=di.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);C||(k.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),C=R.unit.subarray()),c.splice(L,0,{unit:C,pts:I}),b+=l,L++}}R.pts=b,b+=l}for(var P,F=null,O=null,M=0,N=c.length;N--;)M+=c[N].unit.byteLength;for(var B=0,U=c.length;B<U;B++){var G=c[B],H=G.unit,V=G.pts;if(null!==O){h[B-1].duration=Math.round((V-O)/s)}else{if(r&&"aac"===e.segmentCodec&&(V=g),F=V,!(M>0))return;M+=v;try{P=new Uint8Array(M)}catch(e){return void this.observer.emit(y.ERROR,y.ERROR,{type:E.MUX_ERROR,details:T.REMUX_ALLOC_ERROR,fatal:!1,error:e,bytes:M,reason:"fail allocating audio mdat "+M})}d||(new DataView(P.buffer).setUint32(0,M),P.set(fi.types.mdat,4))}P.set(H,v);var K=H.byteLength;v+=K,h.push(new Si(!0,o,K,0)),O=V}var Y=h.length;if(Y){var W=h[h.length-1];this.nextAudioPts=g=O+s*W.duration;var j=d?new Uint8Array(0):fi.moof(e.sequenceNumber++,F/s,Object.assign({},e,{samples:h}));e.samples=[];var q=F/a,z=g/a,X={data1:j,data2:P,startPTS:q,endPTS:z,startDTS:q,endDTS:z,type:"audio",hasAudio:!0,hasVideo:!1,nb:Y};return this.isAudioContiguous=!0,X}},t.remuxEmptyAudio=e}(); Ti,Si=Li=bi=function(){ar t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=t.resetNextTimestamp=t.resetInitSegment=t.generateInitSegment=t.remux=function(e,t,r,i,n,a){var s,o,l=this.initPTS,u=this.lastEndTime,d={audio:void 0,video:void 0,text:i,id3:r,initSegment:void 0};Number.isFinite(u)||(u=this.lastEndTime=n||0);var h=t.samples;if(null==h||!h.length)return d;var f={initPTS:void 0,timescale:1},c=this.initData;if(null!=(s=c)&&s.length||(this.generateInitSegment(h),c=this.initData),null==(o=c)||!o.length)return k.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),d;this.emitInitSegment&&(f.tracks=this.initTracks,this.emitInitSegment=!1);var v=h,c),g=c,h),m=null===g?n:g;(l,m,n,v)||f.timescale!==l.timescale&&a)&&(f.initPTS=m-n,l&&1===l.timescale&&k.warn("Adjusting initPTS by "+(f.initPTS-l.baseTime)),this.initPTS=l={baseTime:f.initPTS,timescale:1});var p=e?m-l.baseTime/l.timescale:u,y=p+v;!c,h,l.baseTime/l.timescale),v>0?this.lastEndTime=y:(k.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var E=!!c.audio,T=!!c.video,S="";E&&(S+="audio"),T&&(S+="video");var L={data1:h,startPTS:p,startDTS:p,endPTS:y,endDTS:y,type:S,hasAudio:E,hasVideo:T,nb:1,dropped:0};return d.audio="audio"===L.type?L:void 0,d.video="audio"!==L.type?L:void 0,d.initSegment=f,d.id3=yi(r,n,l,l),i.samples.length&&(d.text=Ei(i,n,l)),d},e}();ry{Ti=self.performance.now.bind(self.performance)}catch(e){k.debug("Unable to use Performance API on this environment"),Ti="undefined"!=typeof self&&self.Date.now}var Ai=[{demux:Vr,remux:bi},{demux:ri,remux:mi},{demux:Gr,remux:mi},{demux:ui,remux:mi}],ki=function(){ar t=e.prototype;return t.configure=t.push=function(e,t,r,i){var n=this,a=r.transmuxing;a.executeStart=Ti();var s=new Uint8Array(e),o=this.currentTransmuxState,l=this.transmuxConfig;i&&(this.currentTransmuxState=i);var u=i||o,d=u.contiguous,h=u.discontinuity,f=u.trackSwitch,c=u.accurateTimeOffset,v=u.timeOffset,g=u.initSegmentChange,m=l.audioCodec,p=l.videoCodec,S=l.defaultInitPts,L=l.duration,b=l.initSegmentData,R=s,t);if(R&&"AES-128"===R.method){var A=this.getDecrypter();if(!A.isSync())return this.decryptionPromise=A.webCryptoDecrypt(s,R.key.buffer,R.iv.buffer).then((),this.decryptionPromise;var D=A.softwareDecrypt(s,R.key.buffer,R.iv.buffer);if(r.part>-1&&(D=A.flush()),!D)return a.executeEnd=Ti(),Di(r);s=new Uint8Array(D)}var _=this.needsProbing(h,f);if(_){var x=this.configureTransmuxer(s);if(x)return k.warn("[transmuxer] "+x.message),this.observer.emit(y.ERROR,y.ERROR,{type:E.MEDIA_ERROR,details:T.FRAG_PARSING_ERROR,fatal:!1,error:x,reason:x.message}),a.executeEnd=Ti(),Di(r)}(h||f||g||_)&&this.resetInitSegment(b,m,p,L,t),(h||g||_)&&this.resetInitialTimestamp(S),d||this.resetContiguity();var w=this.transmux(s,R,v,c,r),I=this.currentTransmuxState;return I.contiguous=!0,I.discontinuity=!1,I.trackSwitch=!1,a.executeEnd=Ti(),w},t.flush=t.flushRemux=t.resetInitialTimestamp=t.resetContiguity=t.resetInitSegment=t.destroy=t.transmux=t.transmuxUnencrypted=t.transmuxSampleAes=t.configureTransmuxer=t.needsProbing=t.getDecrypter=e}();var Di=ar xi=wi=Ii={exports:{}};!Ii);var Ci=d(Ii.exports);d 0!==t&&t&&self);var Mi=xe()||{isTypeSupported:,Ni=function(){function t(t,r,i,n){var a=this;this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;var s=t.config;this.hls=t,this.id=r,this.useWorker=!!s.enableWorker,this.onTransmuxComplete=i,this.onFlush=n;var o=this.observer=new Ci,this.observer.on(y.FRAG_DECRYPTED,o),this.observer.on(y.ERROR,o);var l,u,d,h,f={mp4:Mi.isTypeSupported("video/mp4"),mpeg:Mi.isTypeSupported("audio/mpeg"),mp3:Mi.isTypeSupported('audio/mp4; codecs="mp3"')},c=navigator.vendor;if(this.useWorker&&"undefined"!=typeof Worker&&(s.workerPath||!0)){try{s.workerPath?(k.log("loading Web Worker "+s.workerPath+' for "'+r+'"'),this.workerContext=(d=s.workerPath,h=new self.URL(d,self.location.href).href,{worker:new self.Worker(h),scriptURL:h})):(k.log('injecting Web Worker for "'+r+'"'),this.workerContext=(l=new self.Blob(["var exports={};var module={exports:exports};function define(f){f()};define.amd=true;("+e.toString()+")(true);"],{type:"text/javascript"}),u=self.URL.createObjectURL(l),{worker:new self.Worker(u),objectURL:u})),this.onwmsg=var v=this.workerContext.worker;v.addEventListener("message",this.onwmsg),v.onerror=v.postMessage({cmd:"init",typeSupported:f,vendor:c,id:r,config:JSON.stringify(s)})}catch(e){k.warn('Error setting up "'+r+'" Web Worker, fallback to inline',e),this.resetWorker(),this.error=null,this.transmuxer=new ki(this.observer,f,s,c,r)}return}this.transmuxer=new ki(this.observer,f,s,c,r)}var r=t.prototype;return r.resetWorker=r.destroy=r.push=r.flush=r.transmuxerError=r.handleFlushResult=r.onWorkerMessage=r.configureTransmuxer=r.handleTransmuxComplete=t}(),Bi=function(){ar t=e.prototype;return t.destroy=t.poll=t._tryFixBufferStall=t._reportStall=t._trySkipBufferHole=t._tryNudgeBuffer=e}(),Ui=function(e){(t,e);var r=t.prototype;return r._registerListeners=r._unregisterListeners=r.onHandlerDestroying=r.startLoad=r.stopLoad=r.doTick=r.onTickEnd=r.doTickIdle=r.loadFragment=r.getBufferedFrag=r.followingBufferedFrag=r.immediateLevelSwitch=r.nextLevelSwitch=r.abortCurrentFrag=r.flushMainBuffer=r.onMediaAttached=r.onMediaDetaching=r.onMediaPlaying=r.onMediaSeeked=function(){var e=this.media,t=e?e.currentTime:null;Number.isFinite(t)&&this.log("Media seeked to "+t.toFixed(3));var r=this.getMainFwdBufferInfo();null!==r&&0!==r.len?this.tick():this.warn('Main forward buffer length on "seeked" event '+(r?r.len:"empty")+")")},r.onManifestLoading=r.onManifestParsed=r.onLevelLoading=r.onLevelLoaded=r._handleFragmentLoadProgress=r.onAudioTrackSwitching=r.onAudioTrackSwitched=r.onBufferCreated=r.onFragBuffered=r.onError=r.checkBuffer=r.onFragLoadEmergencyAborted=r.onBufferFlushed=r.onLevelsUpdated=r.swapAudioCodec=r.seekToStartPos=r._getAudioCodec=r._loadBitrateTestFrag=r._handleTransmuxComplete=function(e){var t,r="main",i=this.hls,n=e.remuxResult,a=e.chunkMeta,s=this.getCurrentContext(a);if(s){var o=s.frag,l=s.part,u=s.level,d=n.video,h=n.text,f=n.id3,c=n.initSegment,v=u.details,g=this.altAudio?void 0:n.audio;if(this.fragContextChanged(o))this.fragmentTracker.removeFragment(o);else{if(this.state=Lr,c){if(null!=c&&c.tracks){var m=o.initSegment||o;this._bufferInitSegment(u,c.tracks,m,a),i.trigger(y.FRAG_PARSING_INIT_SEGMENT,{frag:m,id:r,tracks:c.tracks})}var p=c.initPTS,E=c.timescale;Number.isFinite(p)&&(this.initPTS[o.cc]={baseTime:p,timescale:E},i.trigger(y.INIT_PTS_FOUND,{frag:o,id:r,initPTS:p,timescale:E}))}if(d&&v&&"initSegment"!==o.sn){var T=v.fragments[o.sn-1-v.startSN],S=o.sn===v.startSN,L=!T||o.cc>T.cc;if(!1!==n.independent){var b=d.startPTS,R=d.endPTS,A=d.startDTS,k=d.endDTS;if(l)l.elementaryStreams[d.type]={startPTS:b,endPTS:R,startDTS:A,endDTS:k};else if(d.firstKeyFrame&&d.independent&&1===a.id&&!L&&(this.couldBacktrack=!0),d.dropped&&d.independent){var D=this.getMainFwdBufferInfo(),_=(D?D.end:this.getLoadPosition())+this.config.maxBufferHole,x=d.firstKeyFramePTS?d.firstKeyFramePTS:b;if(!S&&_<x-this.config.maxBufferHole&&!L)return void this.backtrack(o);L&&(o.gap=!0),o.setElementaryStreamInfo(d.type,o.start,R,o.start,k,!0)}o.setElementaryStreamInfo(d.type,b,R,A,k),this.backtrackFragment&&(this.backtrackFragment=o),this.bufferFragmentData(d,o,l,a,S||L)}else{if(!S&&!L)return void this.backtrack(o);o.gap=!0}}if(g){var w=g.startPTS,I=g.endPTS,C=g.startDTS,F=g.endDTS;l&&(l.elementaryStreams[P]={startPTS:w,endPTS:I,startDTS:C,endDTS:F}),o.setElementaryStreamInfo(P,w,I,C,F),this.bufferFragmentData(g,o,l,a)}if(v&&null!=f&&null!=(t=f.samples)&&t.length){var O={id:r,frag:o,details:v,samples:f.samples};i.trigger(y.FRAG_PARSING_METADATA,O)}if(v&&h){var M={id:r,frag:o,details:v,samples:h.samples};i.trigger(y.FRAG_PARSING_USERDATA,M)}}}else this.resetWhenMissingContext(a)},r._bufferInitSegment=r.getMainFwdBufferInfo=r.backtrack=r.checkFragmentChanged=i(t,[{key:"nextLevel",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"currentFrag",get:,{key:"currentProgramDateTime",get:function(){var e=this.media;if(e){var t=e.currentTime,r=this.currentFrag;if(r&&Number.isFinite(t)&&Number.isFinite(r.programDateTime)){var i=r.programDateTime+1e3*(t-r.start);return new Date(i)}}return null}},{key:"currentLevel",get:,{key:"nextBufferedFrag",get:,{key:"forceStartLoad",get:function(){return this._forceStartLoad}}]),t}(Dr),Gi=),Hi=),Vi=function(){ar t=e.prototype;return t.registerListeners=function(){var e=this.hls;e.on(y.FRAG_LOADING,this.onFragLoading,this),e.on(y.FRAG_LOADED,this.onFragLoaded,this),e.on(y.FRAG_BUFFERED,this.onFragBuffered,this),e.on(y.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(y.LEVEL_LOADED,this.onLevelLoaded,this)},t.unregisterListeners=t.destroy=t.onFragLoading=t.onLevelSwitching=t.getTimeToLoadFrag=t.onLevelLoaded=function(e,t){var r=this.hls.config,i=t.stats,n=i.total,a=i.bwEstimate;Number.isFinite(n)&&Number.isFinite(a)&&(this.lastLevelLoadSec=8*n/a),t.details.live?this.bwEstimator.update(r.abrEwmaSlowLive,r.abrEwmaFastLive):this.bwEstimator.update(r.abrEwmaSlowVoD,r.abrEwmaFastVoD)},t._abandonRulesCheck=function(){var e=this.fragCurrent,t=this.partCurrent,r=this.hls,i=r.autoLevelEnabled,n=r.media;if(e&&n){var a=performance.now(),s=t?t.stats:e.stats,o=t?t.duration:e.duration,l=a-s.loading.start;if(s.aborted||s.loaded&&s.loaded===s.total||0===e.level)return this.clearTimer(),void(this._nextAutoLevel=-1);if(i&&!n.paused&&n.playbackRate&&n.readyState){var u=r.mainForwardBufferInfo;if(null!==u){var d=this.bwEstimator.getEstimateTTFB(),h=Math.abs(n.playbackRate);if(!(l<=Math.max(d,o/(2*h)*1e3))){var f=u.len/h;if(!(f>=2*o/h)){var c=s.loading.first?s.loading.first-s.loading.start:-1,v=s.loaded&&c>-1,g=this.bwEstimator.getEstimate(),m=r.levels,p=r.minAutoLevel,E=m[e.level],T=s.total||Math.max(s.loaded,Math.round(o*E.maxBitrate/8)),S=l-c;S<1&&v&&(S=Math.min(l,8*s.loaded/g));var L=v?1e3*s.loaded/S:0,b=L?(T-s.loaded)/L:8*T/g+d/1e3;if(!(b<=f)){var R,A=L?8*L:g,D=Number.POSITIVE_INFINITY;for(R=e.level-1;R>p;R--){var _=m[R].maxBitrate;if((D=this.getTimeToLoadFrag(d/1e3,A,o*_,!m[R].details))<f)break}D>=b||D>10*o||(r.nextLoadLevel=R,v?this.bwEstimator.sample(l-Math.min(d,c),s.loaded):this.bwEstimator.sampleTTFB(l),this.clearTimer(),k.warn("[abr] Fragment "+e.sn+(t?" part "+t.index:"")+" of level "+e.level+" is loading too slowly;\n      Time to underbuffer: "+f.toFixed(3)+" s\n      Estimated load time for current fragment: "+b.toFixed(3)+" s\n      Estimated load time for down switch fragment: "+D.toFixed(3)+" s\n      TTFB estimate: "+c+"\n      Current BW estimate: "+(Number.isFinite(g)?(g/1024).toFixed(3):"Unknown")+" Kb/s\n      New BW estimate: "+(this.bwEstimator.getEstimate()/1024).toFixed(3)+" Kb/s\n      Aborting and switching to level "+R),e.loader&&(this.fragCurrent=this.partCurrent=null,e.abortRequests()),r.trigger(y.FRAG_LOAD_EMERGENCY_ABORTED,{frag:e,part:t,stats:s}))}}}}}}},t.onFragLoaded=t.onFragBuffered=t.ignoreFragment=t.clearTimer=t.getNextABRAutoLevel=function(){var e=this.fragCurrent,t=this.partCurrent,r=this.hls,i=r.maxAutoLevel,n=r.config,a=r.minAutoLevel,s=r.media,o=t?t.duration:e?e.duration:0,l=s&&0!==s.playbackRate?Math.abs(s.playbackRate):1,u=this.bwEstimator?this.bwEstimator.getEstimate():n.abrEwmaDefaultEstimate,d=r.mainForwardBufferInfo,h=(d?d.len:0)/l,f=this.findBestLevel(u,a,i,h,n.abrBandWidthFactor,n.abrBandWidthUpFactor);if(f>=0)return f;k.trace("[abr] "+(h?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var c=o?Math.min(o,n.maxStarvationDelay):n.maxStarvationDelay,v=n.abrBandWidthFactor,g=n.abrBandWidthUpFactor;if(!h){var m=this.bitrateTestDelay;if(m)c=(o?Math.min(o,n.maxLoadingDelay):n.maxLoadingDelay)-m,k.trace("[abr] bitrate test took "+Math.round(1e3*m)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*c)+" ms"),v=g=1}return f=this.findBestLevel(u,a,i,h+c,v,g),Math.max(f,0)},t.findBestLevel=function(e,t,r,i,n,a){for(var s,o=this.fragCurrent,l=this.partCurrent,u=this.lastLoadedFragLevel,d=this.hls.levels,h=d[u],f=!(null==h||null==(s=h.details)||!s.live),c=null==h?void 0:h.codecSet,v=l?l.duration:o?o.duration:0,g=this.bwEstimator.getEstimateTTFB()/1e3,m=t,p=-1,y=r;y>=t;y--){var E=d[y];if(!E||c&&E.codecSet!==c)E&&(m=Math.min(y,m),p=Math.max(y,p));else{-1!==p&&k.trace("[abr] Skipped level(s) "+m+"-"+p+' with CODECS:"'+d[p].attrs.CODECS+'"; not compatible with "'+h.attrs.CODECS+'"');var T=E.details,S=(l?null==T?void 0:T.partTarget:null==T?void 0:T.averagetargetduration)||v,L=void 0;L=y<=u?n*e:a*e;var b=d[y].maxBitrate,R=this.getTimeToLoadFrag(g,L,b*S,void 0===T);if(k.trace("[abr] level:"+y+" adjustedbw-bitrate:"+Math.round(L-b)+" avgDuration:"+S.toFixed(1)+" maxFetchDuration:"+i.toFixed(1)+" fetchDuration:"+R.toFixed(1)),L>b&&(0===R||!Number.isFinite(R)||f&&!this.bitrateTestDelay||R<i))return y}}return-1},i(e,[{key:"nextAutoLevel",get:set:]),e}(),Ki=);var Yi=),Wi=xe(),ji=/([ha]vc.)(?:\.[^.,]+)+/,qi=function(){ar t=e.prototype;return t.hasSourceTypes=t.destroy=t.registerListeners=function(){var e=this.hls;e.on(y.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(y.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(y.MANIFEST_LOADING,this.onManifestLoading,this),e.on(y.MANIFEST_PARSED,this.onManifestParsed,this),e.on(y.BUFFER_RESET,this.onBufferReset,this),e.on(y.BUFFER_APPENDING,this.onBufferAppending,this),e.on(y.BUFFER_CODECS,this.onBufferCodecs,this),e.on(y.BUFFER_EOS,this.onBufferEos,this),e.on(y.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(y.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(y.FRAG_PARSED,this.onFragParsed,this),e.on(y.FRAG_CHANGED,this.onFragChanged,this)},t.unregisterListeners=t._initSourceBuffer=t.onManifestLoading=t.onManifestParsed=function(e,t){var r=2;t.audio&&!t.video||t.altAudio,r=1,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=r,k.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},t.onMediaAttaching=t.onMediaDetaching=t.onBufferReset=t.onBufferCodecs=t.appendChangeType=t.onBufferAppending=t.onBufferFlushing=t.onFragParsed=function(e,t){var r=this,i=t.frag,n=t.part,a=[],s=n?n.elementaryStreams:i.elementaryStreams;s[O]?a.push("audiovideo"):(s[P]&&a.push("audio"),s[F]&&a.push("video"));0===a.length&&k.warn("Fragments must have at least one ElementaryStreamType set. type: "+i.type+" level: "+i.level+" sn: "+i.sn),this.blockBuffers((,a)},t.onFragChanged=function(e,t){this.flushBackBuffer()},t.onBufferEos=t.onLevelUpdated=t.flushBackBuffer=function(){var e=this.hls,t=this.details,r=this.media,i=this.sourceBuffer;if(r&&null!==t){var n=this.getSourceBufferTypes();if(n.length){var a=t.live&&null!==e.config.liveBackBufferLength?e.config.liveBackBufferLength:e.config.backBufferLength;if(Number.isFinite(a)&&!(a<0)){var s=r.currentTime,o=t.levelTargetDuration,l=Math.max(a,o),u=Math.floor(s/o)*o-l;n.forEach(()}}}},t.updateMediaElementDuration=function(){if(this.details&&this.media&&this.mediaSource&&"open"===this.mediaSource.readyState){var e=this.details,t=this.hls,r=this.media,i=this.mediaSource,n=e.fragments[0].start+e.totalduration,a=r.duration,s=Number.isFinite(i.duration)?i.duration:0;e.live&&t.config.liveDurationInfinity?(k.log("[buffer-controller]: Media Source duration is set to Infinity"),i.duration=1/0,this.updateSeekableRange(e)):(n>s&&n>a||!Number.isFinite(a))&&(k.log("[buffer-controller]: Updating Media Source duration to "+n.toFixed(3)),i.duration=n)}},t.updateSeekableRange=t.checkPendingTracks=t.createSourceBuffers=t._onSBUpdateStart=t._onSBUpdateEnd=t._onSBUpdateError=t.removeExecutor=function(e,t,r){var i=this.media,n=this.mediaSource,a=this.operationQueue,s=this.sourceBuffer[e];if(!i||!n||!s)return k.warn("[buffer-controller]: Attempting to remove from the "+e+" SourceBuffer, but it does not exist"),void a.shiftAndExecuteNext(e);var o=Number.isFinite(i.duration)?i.duration:1/0,l=Number.isFinite(n.duration)?n.duration:1/0,u=Math.max(0,t),d=Math.min(r,o,l);d>u&&!s.ending?(s.ended=!1,k.log("[buffer-controller]: Removing ["+u+","+d+"] from the "+e+" SourceBuffer"),s.remove(u,d)):a.shiftAndExecuteNext(e)},t.appendExecutor=t.blockBuffers=t.getSourceBufferTypes=t.addBufferListener=t.removeBufferListeners=e}(),zi=);new zi(0,0,"").align;var Xi=ar $i=),Zi=),Ji=/^age:\s*[\d.]+\s*$/im,en=function(){ar t=e.prototype;return t.destroy=t.abortInternal=t.abort=function(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},t.load=t.loadInternal=t.openAndSendXhr=function(e,t,r){e.readyState||e.open("GET",t.url,!0);var i=this.context.headers,n=r.loadPolicy,a=n.maxTimeToFirstByteMs,s=n.maxLoadTimeMs;if(i)for(var o in i)e.setRequestHeader(o,i[o]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),r.timeout=a&&Number.isFinite(a)?a:s,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.timeout),e.send()},t.readystatechange=t.loadtimeout=t.retry=t.loadprogress=t.getCacheAge=t.getResponseHeader=e}();var tn=/(\d+)-(\d+)\/(\d+)/,rn=function(){ar t=e.prototype;return t.destroy=t.abortInternal=t.abort=t.load=function(e,t,r){var i=this,n=this.stats;if(n.loading.start)throw new Error("Loader can only be used once.");n.loading.start=self.performance.now();var a=function(e,t){var r={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(Object.assign({},e.headers))};e.rangeEnd&&r.headers.set("Range","bytes="+e.rangeStart+"-"+String(e.rangeEnd-1));return r}(e,this.controller.signal),s=r.onProgress,o="arraybuffer"===e.responseType,l=o?"byteLength":"length",u=t.loadPolicy,d=u.maxTimeToFirstByteMs,h=u.maxLoadTimeMs;this.context=e,this.config=t,this.callbacks=r,this.request=this.fetchSetup(e,a),self.clearTimeout(this.requestTimeout),t.timeout=d&&Number.isFinite(d)?d:h,this.requestTimeout=self.setTimeout((function(){i.abortInternal(),r.onTimeout(n,e,i.response)}),t.timeout),self.fetch(this.request).then((function(a){i.response=i.loader=a;var l=Math.max(self.performance.now(),n.loading.start);if(self.clearTimeout(i.requestTimeout),t.timeout=h,i.requestTimeout=self.setTimeout((,h-(l-n.loading.start)),!a.ok){var u=a.status,d=a.statusText;throw new an(d||"fetch, bad network response",u,a)}return n.loading.first=l,n.total=function(e){var t=e.get("Content-Range");if(t){var r=t);if(Number.isFinite(r))return r}var i=e.get("Content-Length");if(i)return parseInt(i)}(a.headers)||n.total,s&&Number.isFinite(t.highWaterMark)?i.loadProgressively(a,n,e,t.highWaterMark,s):o?a.arrayBuffer():"json"===e.responseType?a.json():a.text()})).then((function(a){var o=i.response;self.clearTimeout(i.requestTimeout),n.loading.end=Math.max(self.performance.now(),n.loading.first);var u=a[l];u&&(n.loaded=n.total=u);var d={url:o.url,data:a,code:o.status};s&&!Number.isFinite(t.highWaterMark)&&s(n,e,a,o),r.onSuccess(d,n,e,o)})).catch(()},t.getCacheAge=t.getResponseHeader=t.loadProgressively=e}();ar an=u(Error)),sn=/\s/,on={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},ln=n({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:en,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:Vi,bufferController:qi,capLevelController:$i,errorController:Gt,fpsController:Zi,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:null,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,certLoadPolicy:{default:on},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:on},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},{cueHandler:{newCue:function(e,t,r,i){for(var n,a,s,o,l,u=[],d=self.VTTCue||self.TextTrackCue,h=0;h<i.rows.length;h++)if(s=!0,o=0,l="",!(n=i.rows[h]).isEmpty()){for(var f,c=0;c<n.chars.length;c++)sn.test(n.chars[c].uchar)&&s?o++:(l+=n.chars[c].uchar,s=!1);n.cueStartTime=t,t===r&&(r+=1e-4),o>=16?o--:o++;var v=l.trim().replace(/<br(?: \/)?>/gi,"\n"),g=Qi(t,r,v);null!=e&&null!=(f=e.cues)&&f.getCueById(g)||((a=new d(t,r,v)).id=g,a.line=h+1,a.align="left",a.position=10+Math.min(80,10*Math.floor(8*o/32)),u.push(a))}return e&&u.length&&(u.sort((),u.forEach((function(t){return function(e,t){var r=e.mode;if("disabled"===r&&(e.mode="hidden"),e.cues&&!e.cues.getCueById(t.id))try{if(e.addCue(t),!e.cues.getCueById(t.id))throw new Error("addCue is failed for: "+t)}catch(r){k.debug("[texttrack-utils]: "+r);try{var i=new self.TextTrackCue(t.startTime,t.endTime,t.text);i.id=t.id,e.addCue(i)}catch(e){k.debug("[texttrack-utils]: Legacy TextTrackCue fallback failed: "+e)}}"disabled"===r&&(e.mode=r)}(e,t)}))),u}},enableWebVTT:!1,enableIMSC1:!1,enableCEA708Captions:!1,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0},{subtitleStreamController:void 0,subtitleTrackController:void 0,timelineController:void 0,audioStreamController:void 0,audioTrackController:void 0,emeController:void 0,cmcdController:void 0,contentSteeringController:void 0});r hn=function(){function e(t){void 0===t&&(t={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new Ci,this._autoLevelCapping=void 0,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,A(t.debug||!1,"Hls instance");var r=this.config=function(e,t){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==t.liveMaxLatencyDurationCount&&(void 0===t.liveSyncDurationCount||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(void 0===t.liveSyncDuration||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');var r=un(e),i=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return["manifest","level","frag"].forEach((),n({},r,t)}(e.DefaultConfig,t);this.userConfig=t,this._autoLevelCapping=-1,r.progressive&&dn(r);var i=r.abrController,a=r.bufferController,s=r.capLevelController,o=r.errorController,l=r.fpsController,u=new o(this),d=this.abrController=new i(this),h=this.bufferController=new a(this),f=this.capLevelController=new s(this),c=new l(this),v=new tt(this),g=new dt(this),m=r.contentSteeringController,p=m?new m(this):null,E=this.levelController=new Kt(this,p),T=new Qt(this),S=new nr(this.config),L=this.streamController=new Ui(this,T,S);f.setStreamController(L),c.setStreamController(L);var b=[v,E,L];p&&b.splice(1,0,p),this.networkControllers=b;var R=[d,h,f,c,g,T];this.audioTrackController=this.createController(r.audioTrackController,b);var D=r.audioStreamController;D&&b.push(new D(this,T,S)),this.subtitleTrackController=this.createController(r.subtitleTrackController,b);var _=r.subtitleStreamController;_&&b.push(new _(this,T,S)),this.createController(r.timelineController,R),S.emeController=this.emeController=this.createController(r.emeController,R),this.cmcdController=this.createController(r.cmcdController,R),this.latencyController=this.createController(ht,R),this.coreComponents=R,b.push(u);var x=u.onErrorOut;"function"==typeof x&&this.on(y.ERROR,x,u)}e.isSupported=var t=e.prototype;return t.createController=t.on=function(e,t,r){void 0===r&&(r=this),this._emitter.on(e,t,r)},t.once=t.removeAllListeners=t.off=t.listeners=function(e){return this._emitter.listeners(e)},t.emit=t.trigger=t.listenerCount=t.destroy=t.attachMedia=t.detachMedia=t.loadSource=t.startLoad=t.stopLoad=t.swapAudioCodec=t.recoverMediaError=t.removeLevel=i(e,[{key:"levels",get:,{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:,{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:,{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){k.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:set:,{key:"startLevel",get:function(){return this.levelController.startLevel},set:,{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:,{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:,{key:"bandwidthEstimate",get:function(){var e=this.abrController.bwEstimator;return e?e.getEstimate():NaN}},{key:"ttfbEstimate",get:,{key:"maxHdcpLevel",get:function(){return this._maxHdcpLevel},set:,{key:"autoLevelEnabled",get:,{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:,{key:"maxAutoLevel",get:,{key:"nextAutoLevel",get:set:,{key:"playingDate",get:function(){return this.streamController.currentProgramDateTime}},{key:"mainForwardBufferInfo",get:,{key:"audioTracks",get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:"audioTrack",get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)}},{key:"subtitleTracks",get:,{key:"subtitleTrack",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:set:,{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:,{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:],[{key:"version",get:function(){return"1.4.10"}},{key:"Events",get:function(){return y}},{key:"ErrorTypes",get:function(){return E}},{key:"ErrorDetails",get:,{key:"DefaultConfig",get:set:function(t){e.defaultConfig=t}}]),e}();return hn.defaultConfig=void 0,hn}()}(!1);
