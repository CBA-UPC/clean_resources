(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[661],{Q8nR:function(e,r,t){"use strict";t.r(r),t.d(r,"Microsoft365Ring",(function(){return S.a})),t.d(r,"loadSearchPage",(function(){return j}));var n=t("ldH3");function o(e,r){void 0===r&&(r=window);var t="";if(r){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(r.location.search);t=n&&r.decodeURIComponent(n[1].replace(/\+/g," "))||""}return t}var c,a="https://midgardbranches.blob.core.windows.net/lpc/refs/heads/",i="serp-bootstrapper-version-ecs",s=function(e){return"/".concat(e),".js")},u=new RegExp("https?://(localhost|local\\.teams\\.(office|live)\\.com)(:|/|$)"),d=l=["https://res.cdn.office.net","https://res-1.cdn.office.net","https://res-2.cdn.office.net","https://res-1.cdn.partner.office365.cn","https://outlook-1-cdn.azureedge.eaglex.ic.gov","https://outlook-1-cdn.azureedge.microsoft.scloud"];function f(e,r){var t=new URL("https://midgardbranches.blob.core.windows.net/lpc/refs/heads/"),n=r&&"/_next/"!==r&&"/"!==r?new URL(r):void 0,o=new URL(e,document.baseURI).origin;if(o===t.origin||n&&o===n.origin||o)||u.test(o))return e;throw new Error("TrustedType policy does not allow loading scripts from ".concat(o,", only from ").concat(t.origin,", ").concat(null==n?void 0:n.origin," and localhost."))}var p=t("mXGw"),g=t("xARA"),h=t("oNR1"),v=t("QjXU");function m(e){return"".concat(e,"?cachekey=").concat((new Date).getTime())}var _=function(e,r,t,n){var o=r+e+s(t);return"1.latest"===e&&(o=m(o)),console.log("Downloading bootstrapper version ".concat(e,".")),y(o,n,e)};function b(e,r,t,n){return Object(v.__awaiter)(this,void 0,void 0,(function(){var o;return Object(v.__generator)(this,(function(c){switch(c.label){case 0:return[4,_(e,r,t,n)];case 1:return o=c.sent(),function(e){var r=JSON.parse(localStorage.getItem(i)||"{}");console.log("Caching bootstrapper version ".concat(e,".")),localStorage.setItem(i,JSON.stringify(Object(v.__assign)(Object(v.__assign)({},r),{cachedVersion:e})))}(e),[2,o]}}))}))}function w(e,r,t,n){return Object(v.__awaiter)(this,void 0,void 0,(function(){return Object(v.__generator)(this,(function(o){return setTimeout((),[2]}))}))}var O=function(e,r){var t=JSON.parse(localStorage.getItem(i)||"{}");if(""!==e){var o=r.cdnOptions,c=r.loadingPattern,a=null==t?void 0:t.cachedVersion;a!==e&&(console.log("Bootstrapper cached version ".concat(a," but requested for ECS version ").concat(e,".")),localStorage.setItem(i,JSON.stringify(Object(v.__assign)(Object(v.__assign)({},t),{ecsVersion:e}))),w(e,Object(n.a)(o),c,r))}else localStorage.setItem(i,JSON.stringify(Object(v.__assign)(Object(v.__assign)({},t),{ecsVersion:""})))};function y(e,r,t){var n=window;return n.msfast_search_page_bootstrapper_react=p,n.msfast_search_box_teams_react=p,n.msfast_search_page_bootstrapper_react_dom=g,n.msfast_search_box_teams_react_dom=g,n.msfast_search_page_bootstrapper_react_router=h,function(e,r){void 0===r&&(r={});var t=n=document.head||document.getElementsByTagName("head")[0];if(!n)return Promise.reject(t("no head element"));var o=function(e,r,t){void 0===r&&(r=d()),void 0===t&&(t=!0);var n,o=null,a=function(){if(void 0===c&&(c=null,"undefined"!=typeof self&&self.trustedTypes))try{c=self.trustedTypes.createPolicy("@1js/midgard-trusted-types",{createHTML:function(e){return e},createScript:createScriptURL:)}catch(e){}return c}();try{o=t&&a?a.createScriptURL(e,r):f(e,r)}catch(e){n=e.message}return{error:n,url:o,trustedTypeAvailable:!!a}}(e);if(o.error)return Promise.reject(t(o.error));var a=document.createElement("script");a.src=o.url,a.crossOrigin="anonymous",a.async=!0,a.charset="utf-8",r.ref&&r.ref(a);var i=new Promise((function(e,n){return window.setTimeout((,r.timeout||12e4)})),s=new Promise((function(e,r){a.onload=a.onerror=function(e,n,o,c,a){var i="string"==typeof e?e:e.type,s=a?JSON.stringify(a):"none",u="Event: ".concat(i,", source: ").concat(n,", line: ").concat(o,", col: ").concat(c,", error: ").concat(s);r(t(u))}}));return n.appendChild(a),Promise.race([s,i])}(e).then((function(){var e=n.msfast_search_page_contract_version;if(1!==e)throw new Error("script contract version ".concat(e," is incompatible with bootstrapper contract version ").concat(1));r.ecsVersionListener=O;var o=n.msfast_search_page_bootstrapper_init;if(o){if(t&&"function"==typeof o[t])return o[t](r);var c=Object.keys(o).sort();if(0===c.length)throw new Error("init function has no versions, version: "+t);return o[c[c.length-1]](r)}throw new Error("init function not assigned by script "+t)}))}var S=t("N5xN");function j(e){return function(e){var r=e.cdnOptions,t=e.loadingPattern,c=e.isUrlOverridingEnabled,u=c?o("SearchPageLocal")||o("MidgardLocal"):"";if(u){var d=parseInt(u,10)||9e3,l="https://localhost:"+d+s(t);return e.cdnOptions.publicPath="https://localhost:"+d+"/",y(l,e)}var f=c?o("SearchPageBranch")||o("MidgardBranch"):"";if(f)return l=m(a+f+s(t)),e.cdnOptions.publicPath=a+f+"/",y(l,e);var p=JSON.parse(localStorage.getItem(i)||"{}"),g=c?o("SearchPageVersion")||o("MidgardVersion"):"",h=null==p?void 0:p.ecsVersion,v=e.preferredVersion,_=null==p?void 0:p.cachedVersion;console.log("Bootstrapper versionOverride : "+g+" ecsVersion : "+h+" preferredVersion : "+v+" cachedVersion : "+_);var O=Object(n.a)(r);return g?b(g,O,t,e):h&&_?(_!==h&&w(h,O,t,e),b(_,O,t,e)):v?b(v,O,t,e):(console.log("Couldnt find any version to load, loading the cached version"),b(_,O,t,e))}(e)}},ldH3:function(e,r,t){"use strict";t.d(r,"a",();var n="https://",o=n+"outlook-1-cdn.azureedge.",c="/agsc-midgard/";function a(e){switch(e.environment){case"Gallatin":return n+"res-1.cdn.partner.office365.cn/midgard/";case"AG08":return o+"eaglex.ic.gov"+c;case"AG09":return o+"microsoft.scloud"+c;default:return"https://res.cdn.office.net/midgard/"}}}}]);
//# sourceMappingURL=vendors~search-page-bootstrapper.7b93ae2c429d6bb5f7a6.chunk.v7.js.map