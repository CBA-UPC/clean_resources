define(["require","exports","Desktop/base/templates","jquery","Shared/Popup","Desktop/Product/attributeFilters","Shared/utils/url-substitutions","Desktop/base/custom/ProductList/date-filter","Shared/utils/dateHelper"],function(a,b,c,d,e,f,g,h,i){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Filters=void 0;var j=function(){eturn a.prototype.openPopup=function(){var b=(new e).init(a.options),f=d(c["product-filters/product-filters"]()),g=f.find(".js_product-filter-main");a.appendOfferFeaturesFilter(g),a.appendOfferAttributesFilters(g),a.appendDateRangeFilter(g),a.appendLocationFilter(g),b.runStatic(f),a.bindFilterLocationEvents(),a.bindFilterOfferFeatureEvents(),a.bindFilterOfferAttributesEvents(),a.bindAttributeFilterEvents(),a.bindFilterDateEvents(),a.clearAllEventHandler(),a.filterEventHandler()},a.appendOfferFeaturesFilter=a.appendLocationFilter=function(b){null!=a.filters.ByLocation&&a.appendFilter("product-filters/radioFilter",a.filters.ByLocation,b)},a.appendOfferAttributesFilters=function(b){a.filters.OffersAttributeFilters.Attributes.forEach(function(c){return a.appendOfferAttributeFilter(c,b)})},a.appendOfferAttributeFilter=a.appendFilter=function(b,d,e){var f=a.getElementLengthToSlice(d),g=c[b]({filter:d,maxNumberFilterToShow:f});e.append(g)},a.appendDateRangeFilter=function(b){var c=a.filters.OffersAttributeFilters.DateRange;null!=c&&a.appendFilter("product-filters/dateFilter",c,b)},a.bindFilterDateEvents=function(){var b=a.filters.OffersAttributeFilters.DateRange;null!=b&&(h.init({autoPick:JSON.stringify(null!=b.SelectedFirstWeek&&null!=b.SelectedLastWeek),offset:i.getHtmlTop()+10},{startDate:b.FirstAvailableDayInverted,endDate:b.UpperDateBoundaryIntersection,date:b.SelectedFirstDayInverted},{startDate:b.LowerDateBoundaryIntersection,endDate:b.LastAvailableDayInverted,date:b.SelectedLastDayInverted}),null==b.SelectedFirstDayInverted&&f.resetDateFilter(),f.showDateClearButton())},a.bindFilterOfferFeatureEvents=function(){a.bindCheckboxFilterEvents(a.filters.ByOfferFeature),a.bindUrlSubstitution(d("#"+a.filters.FilterName))},a.bindFilterLocationEvents=function(){if(null!==a.filters.ByLocation){var b=a.filters.ByLocation.FilterName;a.bindCommonFilterEvents(b,a.filters.ByLocation,"js_filter_radio fake-radio-new"),a.bindUrlSubstitution(d("#"+b))}},a.showClearButton=function(a,b){var c=d("#"+a);f.showClearButton(c,b)},a.bindFilterOfferAttributesEvents=function(){a.filters.OffersAttributeFilters.Attributes.forEach(},a.bindCheckboxFilterEvents=a.bindAttributeFilterEvents=a.clearToDefault=function(b,c){var e=d("#"+c).find(".js_filter_radio, .js_offer-attribute-filter");e.removeClass("checked"),a.isByLocationFilter(c)&&e.first().addClass("checked"),d(b).addClass("hidden"),f.setClearAllButtonAsDisabled()},a.clearAllEventHandler=function(){d("#clearAll").on("click",function(){return a.clearAll()})},a.clearAll=a.bindCommonFilterEvents=function(b,c,e){a.showClearButton(b,a.isByLocationFilter(b)),d("#"+b+"-clear").on("click",,d("#"+b+"-more").on("click",,d("#"+b+"-less").on("click",},a.isByLocationFilter=function(b){return null!=a.filters.ByLocation&&b===a.filters.ByLocation.FilterName},a.showMoreOptions=function(b,c,e,f){var g=a.getElementLengthToSlice(e),h=d(b),i=h.closest("#"+c),j=i.find(".js_option"),k=j.last(),l=k.data("id");if(e.Options[e.Options.length-1].OptionId===l)j.slice(g).toggleClass("hidden");else{var m=a.getMoreOptions(e,f,g);k.after(m)}h.toggleClass("hidden"),i.find(".js_less").toggleClass("hidden")},a.getElementLengthToSlice=function(b){var c=_.isUndefined(b.Options)?0:b.Options.filter(.length,d=6,e=a.isByLocationFilter(b.FilterName)?a.filters.ByOfferFeature.Options.length:d,f=c<e?e:c;return f},a.getMoreOptions=function(b,c,e){var f=d.map(b.Options.slice(e),;return f.join("")},a.hideMoreOptions=function(b,c,e){var f=a.getElementLengthToSlice(c),g=d(b),h=g.closest("#"+e),i=h.find(".js_option");i.slice(f).toggleClass("hidden"),g.toggleClass("hidden"),h.find(".js_more").toggleClass("hidden")},a.bindUrlSubstitution=a.filterEventHandler=a.filterOffers=function(){var b=null!=a.filters.ByLocation?f.getLocationFilterId(a.filters.ByLocation.FilterName):"",c=f.getOfferFeaturesFilter(a.filters.ByOfferFeature.FilterName),d=f.getAttributesFilters(a.filters.ByOfferFeature.FilterName),e=f.getDateFilter(),g="/"+a.filters.ProductId,h=_.isNaN(b)||_.isEmpty(b)?"":";"+b,i=_.isNaN(a.filters.ByShop)||_.isEmpty(a.filters.ByShop)?"":a.getFilterByShopQuery(),j=_.isNaN(a.filters.SelectedOrderBy)||_.isEmpty(a.filters.SelectedOrderBy)?"":";"+a.filters.SelectedOrderBy.UrlOptionElementName,k=a.filters.isProductListingAdsActive?";pla":"",l=""+g+h+k+i+j;f.filter(l,d,e,c)},a.getFilterByShopQuery=function(){var b="";return a.filters.ByShop.forEach(,b},a.prototype.init=a.options={extraClass:"product-filters-popup",position:"right"},a.inputTemplate=function(a,b){return b=a.Selected?b+" checked":b,'<li>\n                    <a href="#" rel="nofollow" class="'+b+' js_option" data-id="'+a.OptionId+'" data-filterid="'+a.FilterId+'">'+a.Text+"</a>\n                </li>"},a}();b.Filters=j});