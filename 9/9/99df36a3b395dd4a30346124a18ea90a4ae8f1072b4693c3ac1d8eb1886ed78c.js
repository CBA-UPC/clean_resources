!);var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"redpop@b474a6ad4354f4ba5fde672fa4e9c2c267684761"};"use strict";(self.webpackChunk_tumblr_redpop=self.webpackChunk_tumblr_redpop||[]).push([[9853],{89689:(e,t,o)=>{o.d(t,{c:()=>i});var r=o(5754),n=o.n(r);let s={wrapper:"VcWAj",icon:"WuiH9"};var a=o(2629),i=e=>{var t=e.text,o=e.Icon,r=e.wrapperClassName,i=e.iconClassName,l=e.iconSize,c=void 0===l?12:l,d=e.hideIcon;return(0,a.jsxs)("div",{className:n()(s.wrapper,r),children:[t,o&&!(void 0!==d&&d)&&(0,a.jsx)(o,{className:n()(s.icon,i),size:{width:c,height:c}})]})}},69486:(e,t,o)=>{o.d(t,{Z:()=>n});var r=(0,o(36343).q)("communities");r.defaultProps={size:{width:25,height:24}};let n=r},83189:(e,t,o)=>{o.d(t,{Z:()=>n});var r=(0,o(36343).q)("star-outline");r.defaultProps={size:{width:14,height:14}};let n=r},84665:(e,t,o)=>{o.d(t,{ZP:()=>T});var r=o(54138),n=o.n(r),s=o(50209),a=o.n(s),i=o(5754),l=o.n(i),c=o(95004),d=o(44009),p=o(93853),u=o(98384),h=o(10381),m=o(63665),g=o(59215),v=o(7070),b=o(63583),f=o.n(b),y=o(96467),x=o.n(y),C=o(91909);let N={manualPaginatorButtons:"m3lOJ",manualPaginatorButton:"PY8Tb",next:"B5txQ",prev:"jIdvc",manualPaginatorButtonInner:"Xp6EK"};var R=o(2629),w={width:13,height:13},k={href:"DON'T FETCH ME! OH GUY, PLEASE DON'T FETCH ME!"},j={prevNextLinks:[],linkForCurrentPage:k};class S extends C.Z{constructor(){super(...arguments),a()(this,"addObjectsToExisting",this.props.concatenate?e=>{var t=this.state.objects,o=this.props,r=o.direction,n=o.getObjectsFromResponse;return r===m.cU.Top?n(e).concat(t):t.concat(n(e))}:,a()(this,"shouldRenderMainLoader",()=>{var e=this.state,t=e.hasFetchedInitialPage,o=e.loadingNextPage;return!t||o}),a()(this,"preHandleContentFetch",e=>{var t=this.props.updateUrlFromCurrentPageLink,o=this.state.linkForCurrentPage;switch(e){case m.vO.Initial:return;case m.vO.Refresh:null==t||t();return;case m.vO.Pagination:null==t||t(null==o?void 0:o.href);return}}),a()(this,"getHotkeyCommands",()=>{var e=this.state,t=e.prevNextLinks,o=e.nextLink,r=[];return 0!==t.length&&r.push({key:p.SV.Left,command:this.onClickPrevious}),o&&r.push({key:p.SV.Right,command:this.onClickNext}),r}),a()(this,"renderPaginationButtons",e=>{var t=this.state,o=t.prevNextLinks,r=t.nextLink,s=this.props,a=s.prevButtonIsRefresh,i=s.manualPaginatorButtonCss,h=void 0===i?{}:i,m=h.containerClassName,g=h.prevButtonStyle,v=h.nextButtonStyle,b=s.appContext._c,y=s.nextButton,x=s.concatenate,C=b("The label for a button to return to the previous page of results","Previous"),k=b("The label for a button to refresh the contents of a set of posts to show the newest content in it","Latest"),j=b("The label for a button to go to the next page of results","Next"),S=!!o.length,P=S?this.onClickPrevious:this.refresh,L=S?C:k,T=S?{color:f().paletteWhite,background:f().paletteTransparentWhite65}:{color:f().paletteTransparentWhite87,background:"transparent",border:`2px solid ${f().paletteTransparentWhite87}`},B=!x&&S||a,I=!!r;return B||I?(0,R.jsxs)("div",{ref:this.setButtonContainerRef,className:l()(N.manualPaginatorButtons,m),children:[(0,R.jsx)(p.ZP,{hotkey:this.getHotkeyCommands()}),B&&(0,R.jsxs)(d.Z,{label:C,wrapperClassName:l()(N.manualPaginatorButton,N.prev),wrapperStyle:n()(n()({},T),g),className:N.manualPaginatorButtonInner,onClick:P,children:[(0,R.jsx)(u.sz,{size:w,colors:{primary:(null==g?void 0:g.color)||T.color||"currentcolor"}}),L]}),I&&(y?(0,c.cloneElement)(y,{label:j,onClick:this.onClickNext}):(0,R.jsxs)(d.Z,{label:j,wrapperClassName:l()(N.manualPaginatorButton,N.next),wrapperStyle:n()({color:f().paletteWhite,background:f().paletteAccent},this.getNextButtonStyle(e)),className:N.manualPaginatorButtonInner,onClick:this.onClickNext,children:[j,(0,R.jsx)(u.iL,{size:w,colors:{primary:v&&v.color||f().paletteWhite}})]}))]}):null}),a()(this,"onClickPrevious",()=>{var e=this.state,t=e.prevNextLinks,o=e.firstPageInfo,r=e.linkForCurrentPage,s=this.props.updateUrlFromCurrentPageLink,a=t.pop();if(!this.canFetchNextPage(a))return Promise.resolve();if(a===k&&o){var i=o.endpointApiRequest,l=o.objects;return this.nextPageApiRequest=i,null==s||s(i.getSearchParams(),!0),this.setState(n()(n()({},j),{},{objects:l,nextLink:r}),this.scrollToBottom),Promise.resolve()}return this.scrollToTop(),new Promise(e=>{this.setState({prevNextLinks:t,objects:[],linkForCurrentPage:a},e)}).then(.then(()=>this.scrollToBottom())}),a()(this,"onClickNext",()=>{var e=this.state,t=e.prevNextLinks,o=e.linkForCurrentPage,r=e.nextLink,s=e.objects,a=this.props,i=a.endpointApiRequest,l=a.concatenate;return this.canFetchNextPage(r)&&i?(l||this.scrollToTop(),new Promise(e=>{this.setState(n()({objects:l?this.state.objects:[],prevNextLinks:[...t,o],linkForCurrentPage:r},o===k&&{firstPageInfo:{objects:s,endpointApiRequest:i}}),e)}).then():Promise.resolve()}),a()(this,"setButtonContainerRef",,a()(this,"getNextButtonStyle",e=>{var t=this.props,o=t.manualPaginatorButtonCss,r=void 0===o?{}:o,s=r.doNotAccountForLowerRightContent,a=r.nextButtonStyle,i=t.messagingContext.offsetToAvoidLowerRightContentPx;if(s)return a;var l=this.state.buttonsContainerRef,c=l&&e?e-l.getBoundingClientRect().right:0;return n()(n()({},a),{},{transform:`translateX(-${c<i?i-c+x().lowerRightContentEdgeMarginPx:0}px)`})})}render(){var e=this.props.manualPaginatorButtonCss,t=(void 0===e?{}:e).doNotAccountForLowerRightContent;return(0,R.jsxs)(R.Fragment,{children:[super.render(),!this.shouldRenderMainLoader()&&(t?this.renderPaginationButtons():(0,R.jsx)(h.U$,{children:e=>{var t=e.bodyWidth;return this.renderPaginationButtons(t)}}))]})}getEmptyInitialState(){var e,t,o=null===(e=(t=this.props).getInitialPage)||void 0===e||null===(e=e.call(t))||void 0===e?void 0:e.prevLink;return n()(n()(n()({},super.getEmptyInitialState()),j),o&&{prevNextLinks:[o]})}didChangeEndpoint(e){var t,o=super.didChangeEndpoint(e)&&(!this.nextPageApiRequest||!(null!==(t=this.props.endpointApiRequest)&&void 0!==t&&t.isEqualTo(this.nextPageApiRequest,!0)));return o&&(this.nextPageApiRequest=null),o}getFetchNextPageRequest(e){return this.nextPageApiRequest=super.getFetchNextPageRequest(e),this.nextPageApiRequest}onPagination(e){super.onPagination(e);var t=e.requestType,o=e.response,r=this.props.getPrevLink,s=null==r?void 0:r(o);this.setState(e=>n()(n()({},[m.vO.Initial,m.vO.Refresh].includes(t)?j:e),!!s&&{prevNextLinks:[s]}))}}a()(S,"defaultProps",n()({},C.c));var P=(0,g.CN)(S,{appContext:!0,messagingContext:!0});(0,v.D)(P,`Inner${P.name}`);class L extends c.Component{render(){return(0,R.jsx)(P,n()(n()({},this.props),{},{ref:this.props.forwardedRef}))}}let T=L},4311:(e,t,o)=>{o.r(t),o.d(t,{SORT_DIRECTION_ASCENDING:()=>t1,SORT_DIRECTION_DESCENDING:()=>t2,SORT_DIRECTION_STORAGE_KEY:()=>t0,default:()=>t3});var r=o(33970),n=o.n(r),s=o(5754),a=o.n(s),i=o(95004),l=o(9041),c=o(44009),d=o(98478),p=o(36343),u=(0,p.q)("subscribe-off");u.defaultProps={size:{width:24,height:24}};var h=(0,p.q)("subscribe-on");h.defaultProps={size:{width:24,height:24}};var m=o(49457),g=o(43523),v=o(17901),b=o(85795),f=o(78667),y=o(43166),x=(0,i.createContext)(void 0);x.displayName="ReplyContext";var C=N=o(54138),R=o.n(N),w=o(22424);let k=()=>{var e=(0,w.wL)().logEvent,t=(0,y.uu)().post,o=t.id,r=t.blogName,n=t.serveId;return(t,s)=>{e({eventName:t,eventDetails:R()(R()({},s),{},{post_id:o,blog_name:r,serve_id:n})})}};var j=o(55015),S=o(49116),P=o(63583),L=o.n(P),T=o(69486),B=o(54916),I=o(82145),E=(0,p.q)("reblog-graph");E.defaultProps={size:{width:24,height:24}};var O=o(17635),W=o(77),Z=o(34330),A=o(40563);let D={root:"poThh",tabs:"RmVjB",tab:"ykm3O",tabCount:"HW9fu",replies:"lRHNZ",active:"F_5SW",reblogs:"_vT58",likes:"ztxCq",reblogGraph:"jTUmS",selector:"gXeqb",popoverLayout:"zEryr"};var F=o(2629),M="reblogFilterMode",_=H=e=>{var t=e.mode,o=e.className,r=e.activeModes,n=e.onClick,s=e.children,i=e.title,l=r.includes(t);return(0,F.jsx)("button",{className:a()(D.tab,o,{[D.active]:l}),onClick:role:"tab",title:i,children:s})},z=e=>{var t=e.mode,o=e.onChange,r=e.replyCount,n=void 0===r?0:r,s=e.reblogCount,a=e.likeCount,i=e.isReblog,l=e.selfReplyCount,c=(0,f.bp)(),d=c._t,p=c._c,u=c._getLocaleNumberString,h={width:18,height:18},m=k(),b=(0,W.iv)().tabId,y=(0,A.J)("communities")&&e.isCommunity,x=e=>{switch(e){case v.L.Replies:m(g.J.PostActivityTabSelectReplies,{tab:b,mode_from:t});break;case v.L.ReblogsWithComments:m(g.J.PostActivityTabSelectReblogs,{tab:b,mode_from:t});break;case v.L.Likes:m(g.J.PostActivityTabSelectLikes,{tab:b,mode_from:t});break;case v.L.ReblogGraph:m(g.J.PostActivityTabSelectReblogGraph,{tab:b,mode_from:t})}o(e)};return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsxs)(H,{className:D.replies,mode:t,activeModes:[v.L.Replies],onClick:x,title:d(y?"Community Replies":"Replies"),children:[y?(0,F.jsx)(T.Z,{size:h}):(0,F.jsx)(O.Z,{size:h}),(0,F.jsx)("span",{title:d(y?"Number of community replies":"Number of replies"),className:D.tabCount,children:u(y?void 0===l?0:l:n)})]}),i&&y&&(0,F.jsxs)(H,{className:D.replies,mode:t,activeModes:[v.L.RepliesOnRoot],onClick:x,title:d("Replies"),children:[(0,F.jsx)(O.Z,{size:h}),(0,F.jsx)("span",{title:d("Number of replies"),className:D.tabCount,children:u(n)})]}),(0,F.jsxs)(H,{className:D.reblogs,mode:t,activeModes:[v.L.ReblogsWithComments,v.L.ReblogsWithContentComments,v.L.Reblogs],onClick:e=>{var t=S.E.getItem(M);x(_(t)?t:e)},title:d("Reblogs"),children:[(0,F.jsx)(I.Z,{size:h}),(0,F.jsx)("span",{title:d("Number of reblogs"),className:D.tabCount,children:u(void 0===s?0:s)})]}),(0,F.jsxs)(H,{className:D.likes,mode:t,activeModes:[v.L.Likes],onClick:x,title:d("Likes"),children:[(0,F.jsx)(B.Z,{size:h}),(0,F.jsx)("span",{title:d("Number of likes"),className:D.tabCount,children:u(void 0===a?0:a)})]}),(0,F.jsx)(H,{className:D.reblogGraph,mode:t,activeModes:[v.L.ReblogGraph],onClick:x,title:p("Graphic display of the reblog network for a post","Reblog Graph"),children:(0,F.jsx)(E,{size:h})})]})};let q=e=>{var t=e.likeCount,o=e.popoverLayout,r=e.mode,n=e.onChangeMode,s=e.onChangeSortDirection,i=e.reblogCount,l=e.replyCount,c=e.selfReplyCount,d=e.sortDirection,p=e.isSelectorOpen,u=e.onChangeIsSelectorOpen,h=e.isCommunity,m=e.isReblog,b=(0,f.bp)()._t,y=(0,W.iv)().tabId,x=k(),C=null;switch(r){case v.L.Replies:case v.L.RepliesOnRoot:C=(0,F.jsx)(Z.Z,{value:d,title:b("Sort by"),options:[{label:b("Oldest first"),value:t1},{label:b("Newest first"),value:t2}],isOpen:p,onChangeIsOpen:u,onChange:e=>{x(g.J.PostActivityReplySortDirectionChange,{sort_type:e,tab:y}),null==s||s(e),S.E.setItem(t0,e)}},"repliesSelector");break;case v.L.ReblogsWithComments:case v.L.ReblogsWithContentComments:case v.L.Reblogs:C=(0,F.jsx)(Z.Z,{value:r,title:b("Filter by"),options:[{label:b("Comments and tags"),value:v.L.ReblogsWithComments},{label:b("Comments only"),value:v.L.ReblogsWithContentComments},{label:b("Other reblogs"),value:v.L.Reblogs}],isOpen:p,onChangeIsOpen:u,onChange:e=>{switch(e){case v.L.ReblogsWithComments:x(g.J.PostActivityReblogFilterSelectWithComments,{tab:y});break;case v.L.ReblogsWithContentComments:x(g.J.PostActivityReblogFilterSelectWithContentComments,{tab:y});break;case v.L.Reblogs:x(g.J.PostActivityReblogFilterSelectOther,{tab:y})}null==n||n(e),S.E.setItem(M,e)}},"reblogsSelector")}return(0,F.jsxs)("div",{className:a()(D.root,{[D.popoverLayout]:o}),children:[(0,F.jsx)("div",{className:D.tabs,children:(0,F.jsx)(z,{mode:r,onChange:n,replyCount:l,reblogCount:i,likeCount:t,selfReplyCount:c,isReblog:m,isCommunity:h})}),C&&(0,F.jsx)("div",{className:D.selector,children:C})]})};var G=e=>{var t=e.size,o=t.width,r=t.height,n=e.stroke;return(0,F.jsx)("svg",{fill:"none",width:o,height:r,viewBox:"0 0 56 50",children:(0,F.jsx)("path",{stroke:n,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M28.52 6.75C31.86 3.044 36.088 1 40.42 1c3.027 0 5.966 1.032 8.512 2.979 7.374 5.664 6.92 15.69 2.667 22.666-5.757 9.427-17.485 19.147-19.776 21A6.13 6.13 0 0127.994 49a6.133 6.133 0 01-3.831-1.355c-2.294-1.853-14.022-11.573-19.776-21C.136 19.685-.296 9.66 7.099 3.98 9.637 2.032 12.573 1 15.599 1c4.31 0 8.526 2.043 11.873 5.75.157.175.325.373.523.6.186-.233.365-.43.525-.6z"})})};G.defaultProps={size:{width:24,height:24},stroke:P.paletteBlack};var J=e=>{var t=e.size,o=t.width,r=t.height,n=e.stroke;return(0,F.jsxs)("svg",{fill:"none",width:o,height:r,viewBox:"0 0 50 62",children:[(0,F.jsx)("path",{stroke:n,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M38.333 1.667L49 12.333 38.333 23"}),(0,F.jsx)("path",{stroke:n,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M1 28.333V23a10.667 10.667 0 0110.667-10.667H49"}),(0,F.jsx)("path",{stroke:n,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11.667 60.333L1 49.667 11.667 39"}),(0,F.jsx)("path",{stroke:n,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M49 33.667V39a10.667 10.667 0 01-10.667 10.667H1"})]})};J.defaultProps={size:{width:24,height:24},stroke:P.paletteBlack};var U=e=>{var t=e.size,o=t.width,r=t.height,n=e.stroke;return(0,F.jsx)("svg",{fill:"none",width:o,height:r,viewBox:"0 0 50 50",children:(0,F.jsx)("path",{stroke:n,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M49 23.667c.01 3.52-.813 6.991-2.4 10.133a22.667 22.667 0 01-20.267 12.533c-3.52.01-6.991-.813-10.133-2.4L1 49l5.067-15.2a22.347 22.347 0 01-2.4-10.133A22.667 22.667 0 0116.2 3.4 22.346 22.346 0 0126.333 1h1.334A22.613 22.613 0 0149 22.333v1.334z"})})};U.defaultProps={size:{width:24,height:24},stroke:P.paletteBlack};let $={root:"f8GV2",button:"MlOHN",message:"rGJRV"},V=e=>{var t,o,r,n=e.className,s=e.mode,i=e.onChangeMode,l=e.canReply,d=e.canReblog,p=e.hasReplies,u=e.hasReblogs,h=e.hasSelfReplies,m=e.hasLikes,g=e.scope,b=e.hasTransientReplies,y=e.onTryAnotherFilter,x=(0,f.bp)(),C=x._c,N=x._t,w={size:{width:48,height:48},stroke:P.paletteGray65},k="self"===g&&s===v.L.Replies?h:p,j=e=>{var t=e.label,o=e.toTab;return(0,F.jsx)(c.Z,{label:t,onClick:className:$.button,children:t})},S=(0,F.jsx)(j,{label:N("Check out the Replies"),toTab:v.L.Replies}),L=(0,F.jsx)(j,{label:N("Check out the Reblogs"),toTab:v.L.ReblogsWithComments}),T=(0,F.jsx)(j,{label:N("Check out the Likes"),toTab:v.L.Likes});switch(s){case v.L.Replies:case v.L.RepliesOnRoot:if(b)return null;t=(0,F.jsx)(U,R()({},w)),k||(u?r=L:m&&(r=T),o=l?N(void 0!==r?"Be the first to Reply! Or...":"Be the first to Reply!"):C("New message when the reply notes view is empty","Move along, nothing to see here."));break;case v.L.Reblogs:case v.L.ReblogsWithComments:case v.L.ReblogsWithContentComments:t=(0,F.jsx)(J,R()({},w)),u?(o=N("No reblogs with this filter yet."),r=y?(0,F.jsx)(c.Z,{label:N("Try another filter?"),onClick:e=>{e.stopPropagation(),y()},className:$.button,children:N("Try another filter?")}):null):(m?r=T:p&&(r=S),o=N(d?void 0!==r?"Be the first to Reblog! Or...":"Be the first to Reblog!":"Reblogs are turned off for this post."));break;case v.L.Likes:t=(0,F.jsx)(G,R()({},w)),m||(p?r=S:u&&(r=L),o=N(void 0!==r?"Give the first Like! Or...":"Give the first Like!"))}return(0,F.jsxs)("div",{className:a()($.root,n),children:[(0,F.jsx)("div",{className:$.icon,children:t}),(0,F.jsx)("span",{className:$.message,children:o}),r]})};var Y=o(57921),K=o(6135),X=o(26705),Q=o(84665);let ee=(0,i.lazy)(;var et=o(94133),eo=o(25190),er=o(6259),en=o(74446),es=o(96467),ea=o(45222),ei=o(17287),el=o(31571),ec=o(11007);let ed={root:"UwAQg",avatar:"ZKQHp",content:"bsYWi",blogInfo:"S7gtL",blogLink:"WyQKf",followButtonWrapper:"alNOv"},ep=e=>{var t=e.note,o=t.avatar,r=t.avatarShape,s=t.blogName,a=t.blogUrl,l=t.blogTitle,c=t.followed,d=t.type,p=t.liveNow,u=e.avatarDimension,h=(0,f.bp)()._t,m=(0,i.useState)(c),b=n()(m,2),y=b[0],x=b[1],C=k(),N=(0,ec.g)().data;return(0,F.jsxs)("div",{className:ed.root,"aria-label":h("Like"),children:[(0,F.jsx)("div",{className:ed.avatar,children:(0,F.jsx)(ea.Z,{avatarShape:r,imageResponse:o,name:s,url:a,dimension:void 0===u?32:u,liveNow:p})}),(0,F.jsxs)("div",{className:ed.content,children:[(0,F.jsxs)("div",{className:ed.blogInfo,children:[(0,F.jsx)(ei.Z,{blogName:s,className:ed.blogLink,krakenEventName:g.J.PostActivityNoteClickBlogName,krakenEventDetails:{type:d},children:s}),(0,F.jsx)("span",{className:ed.blogTitle,children:l})]}),(null==N?void 0:N.name)!==s&&(0,F.jsx)(el.Z,{wrapperClassName:ed.followButtonWrapper,blogName:s,blogUrl:a,following:y,onFollow:(e,t)=>{C(g.J.PostActivityNoteClickFollow,{type:v.w.Like,action:t?"followed":"unfollowed"}),x(t)},showUnfollowText:!0})]})]})};var eu=o(85085),eh=o(3802),em=o(28431),eg=o(50213),ev=o(23326),eb=o(78994),ef=o(19937),ey=o(24994),ex=o(86033),eC=o(8737);let eN=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"cancelOnUnmount",r=(0,f.bp)().apiFetchWithSchema,n=(0,W.iv)().tabId,s=(0,er._)().addOnCloseModalRouteHandler,a=(0,eb.s0)(),l=(0,en.i)().onReblogged,c=(0,y.uu)(),d=c.post,p=d.id,u=d.placementId,h=c.getIsLongPost,m=(0,i.useRef)(),g=(0,i.useRef)(),v=(0,i.useRef)(),b=e=>{var t,o=e.isModalSuccess;(0,eC.Ly)(),o&&(null==l||l(p)),null===(t=m.current)||void 0===t||t.call(m)};return(0,i.useEffect)(()=>()=>{var e,t;(0,eC.Ly)(),null===(e=m.current)||void 0===e||e.call(m),"cancelOnUnmount"===o&&(null===(t=v.current)||void 0===t||t.cancel())},[o]),()=>{if((0,eC.r9)(p,u,null==h?void 0:h(),n),m.current=s(b),g.current){a(g.current);return}return v.current=(0,ex.Z)((0,ef.J)(r,{postId:e,blogIdentifier:t}).fetch()),v.current.then(e=>{var t=e.response.posts[0];if(t){var o=(0,ey.T)(t);g.current=o,a(o)}})}},eR=e=>{var t=e.blogName,o=e.disableNavigation,r=e.postId,n=e.unmountBehavior,s=e.noteType,a=(0,f.bp)(),i=a._t,l=a._c,c=a.isLoggedIn,d=(0,eb.TH)().pathname,p=eN(r,t,n),u=k();return(0,F.jsx)("button",R()(R()({onClick:e=>{e.ctrlKey||e.metaKey||o||(s&&u(g.J.PostActivityNoteClickReblog,{type:s}),p())}},!c&&{"data-login-wall-type":"reblog","data-login-wall-title":l('Login wall: Title shown when user clicks on the "Reblog" button, after exceeding click counter limit',"Want to share? You're nearly there…"),"data-login-wall-text":l('Login wall: Text shown when user clicks on the "Reblog" button, after exceeding click counter limit',"…because if you want to reblog this digital bit of online phantasmagoria, all you have to do is sign up to Tumblr today. It's waiting for you."),"data-login-wall-post-id":r,"data-login-wall-blog-name":t,"data-login-wall-redirect":d}),{},{children:i("Reblog")}))};var ew=o(43684),ek=o(93613),ej=o(399),eS=o(68782),eP=o(20775),eL=o(32415),eT=o(5700),eB=o(18145),eI=e=>{var t,o=(0,i.useState)(!1),r=n()(o,2),s=r[0],l=r[1],c=(0,i.useState)(!1),d=n()(c,2),p=d[0],u=d[1],h=(0,f.bp)(),m=h.isLoggedIn,x=h._t,C=h._c,N=h.apiFetch,k=(0,w.wL)().logEvent,j=(0,y.b8)().post,S=(0,ek.V)().toggleToast,P=(0,eL.Pc)().data,L=(0,b.ZP)(N),T=()=>!!(j.canReply&&e.note.type===v.w.Reply),B=()=>T()?(0,F.jsx)(em.Z,{className:eB.Z.meatballItem,onClick:e.onReplyClick,children:x("Reply")},"reblog"):null,I=e=>!!(j.canReblog&&[v.w.ReblogWithComment,v.w.ReblogWithContentComment].includes(e.type)),E=()=>{var t=e.blogName,o=e.note;if(I(o)){var r=o.type,n=o.postId;return(0,F.jsx)(em.Z,{isWrappingButton:!0,className:a()(eB.Z.meatballItem,eB.Z.thin,eB.Z.reblog),children:(0,F.jsx)(eR,{postId:n,blogName:t,noteType:r,unmountBehavior:"completeOnUnmount"})},"reblog")}return nulltes,W=()=>{var t=e.note;return O()?(0,F.jsx)(em.Z,{onClick:D,keepDropdownOpenAfterClick:!0,className:a()(eB.Z.meatballItem,eB.Z.red),children:t.type===v.w.Reply?x("Delete reply"):t.type===v.w.Tip?x("Hide tip"):x("Hide note")},"hide-delete"):null},Z=e=>!!(m&&!e),A=e=>Z(e)?(0,F.jsx)(em.Z,{onClick:M,className:a()(eB.Z.meatballItem,eB.Z.red),children:C("Menu item to report a note","Report")},"note-report"):null,D=()=>l(!s!p),_=()=>{var t=e.postTumblelogName,o=e.note,r=e.refreshContent,n=e.removeNote,s=e.scope;switch(o.type){case v.w.Reply:q(g.J.PostActivityNoteDelete,o);break;case v.w.ReblogWithComment:case v.w.ReblogWithContentComment:J(g.J.PostActivityNoteHide,o);break;case v.w.Tip:G(g.J.PostActivityNoteHide,o)}L.deleteNote(t,o.blogName,o.timestamp,j.id,s).fetch().t()}).catch(()=>{l(!1),S((0,eS.U)((0,ej.Pk)(x)),"error")})},H=()=>{var t=e.postTumblelogName,o=e.note;switch(o.type){case v.w.Reply:q(g.J.PostActivityNoteReport,o);break;case v.w.ReblogWithComment:case v.w.ReblogWithContentComment:J(g.J.PostActivityNoteReport,o);break;case v.w.Tip:G(g.J.PostActivityNoteReport,o)}L.flagNote(t,o.blogName,o.timestamp,j.id).fetch().then(()=>{S(x("Thanks for reporting! We'll have a look."),"success")}).catch(()=>{S((0,eS.U)((0,ej.Pk)(x)),"error")}).finally(()=>{u(!1)})},z=(0,i.useMemo)(()=>{var e,t=j.blogName,o=null==P||null===(e=P.user)||void 0===e?void 0:e.blogs.map(e=>e.name);return!!(null!=o&&o.includes(t))},[null==P||null===(t=P.user)||void 0===t?void 0:t.blogs,j.blogName]),q=(e,t)=>{var o=t.type,r=t.blogName,n=t.isOriginalPoster,s=t.content[0];(0,eT.dz)(s)&&k({eventName:e,eventDetails:{type:o,reply:s,replyAuthor:r,post_id:j.id,isActionTakenByPostAuthor:z,isReplyFromOriginalPoster:n}})},G=(e,t)=>{var o=t.type,r=t.blogName,n=t.isOriginalPoster;k({eventName:e,eventDetails:{content:t.content,type:o,post_id:j.id,tipAuthor:r,isActionTakenByPostAuthor:z,isReplyFromOriginalPoster:n}})},J=(e,t)=>{k({eventName:e,eventDetails:{type:t.type,tags:t.tags,post_id:t.postId,isActionTakenByPostAuthor:z,parentPostId:j.id}})};return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(eP.Z,R()(R()({},(0,eP._)(e)),{},{renderItems:e=>[B(),E(),W(),A(e)].fil==e),shouldRenderMenu:t=>{var o=e.note;return T()||I(o)||O()||Z(t)},width:150,onBlock:()=>{var t,o=e.note;switch(o.type){case v.w.Reply:q(g.J.PostActivityNoteBlock,o);break;case v.w.ReblogWithComment:case v.w.ReblogWithContentComment:J(g.J.PostActivityNoteBlock,o);break;case v.w.Tip:G(g.J.PostActivityNoteBlock,o)}null===(t=e.onBlock)||void 0===t||t.call(e)},popoverPosition:ew.I2.BottomEnd,popoverBoundary:ew.gc.ScrollParent,meatballsClassName:e.meatballsClassName,targetStyles:{flex:0,marginLeft:"auto"},positionOffsets:{[ew.I2.Bottom]:{left:-10},[ew.I2.Top]:{left:-10,top:-10}}})),s&&(()=>{switch(e.note.type){case v.w.Reblog:case v.w.ReblogWithComment:case v.w.ReblogWithContentComment:o=C("Ask if you want to remove this reblog","Hide this reblog"),t=C("Confirming you want to perform an action","You definitely want to hide this reblog?");break;case v.w.Reply:o=C("Ask if you want to remove this reply","Delete this reply"),t=C("Confirming you want to perform an action","You definitely want to delete this reply?");break;case v.w.Tip:o=C("Text on a button that will hide a tip from being visible in post notes","Yep, hide it"),t=C("Description of a button that will hide a tip from being visible in post notes","Hiding this tip will only remove it from the replies tab and notes. The tip will not be refunded. For further help contact Tumblr Support.");break;default:o=x("Hide"),t=x("This note type is not supported")}var t,o,r=[{text:x("Nevermind"),onClick:D,buttonStyle:ev.X.Cancel},{text:o,onClick:_,buttonStyle:ev.X.Confirm}];return(0,F.jsx)(eg.Z,{onGlassClick:D,glassIsClickable:!1,children:(0,F.jsx)(ev.O,{title:t,buttons:r})})})(),p&&(()=>{var t=e.note,o=[{text:x("Nevermind"),onClick:M,buttonStyle:ev.X.Cancel},{text:x("Report"),onClick:H,buttonStyle:ev.X.Confirm}];return(0,F.jsx)(eg.Z,{onGlassClick:M,glassIsClickable:!1,children:(0,F.jsx)(ev.O,{title:C("Reporting a user who is violating guidelines. Variable is blog name","Report %1$s?",[t.blogName]),body:x("If it violates our community guidelines, we'll remove it."),buttons:o})})})()]})},eE=o(69682),eO=o(50244),eW=o(64987),eZ=o(84961),eA=o(60857),eD=o(4455);let eF={avatarWidth:"24",root:"QjaJb",isPinned:"uSuWr",header:"K9Yy8",avatar:"rNL9q",avatarLiveNow:"qz0Pd",meta:"SsGE3",blogInfo:"x7pPP",blogLink:"mRxeE",reblogParent:"sQ1gJ",reblogIcon:"GWtN5",meatballsMenu:"fAVmw",animateOut:"DEZmC",content:"DW58W",imgIsFirstBlock:"QVqyR",imgIsLastBlock:"iC68K",expandButton:"qYZa2",ctaButtons:"gvA1t",communityLabelCoverWrapper:"Sabil",withDotSeparatorContainer:"zWtFe",withDotSeparator:"b6sjC"},eM=e=>{var t=(0,f.bp)(),o=t._t,r=t.timestamps,s=(0,eo.v$)().isMobile,l=e.canHideOrDelete,c=e.note,d=e.refreshContent,p=e.blog,u=e.restrictHeight,h=e.onBlock,m=c.avatar,b=c.avatarShape,y=c.blogName,x=c.blogUrl,C=c.postId,N=c.timestamp,w=c.type,j=c.liveNow,S=c.isPinnedPreview,P=(0,i.useState)(!1),L=n()(P,2),T=L[0],B=L[1],E=(0,i.useState)(!1),O=n()(E,2),W=O[0],Z=O[1],A=k(),D=c.type===v.w.ReblogWithComment||c.type===v.w.ReblogWithContentComment,M=(0,eD.L2)(D?c.communityLabels:void 0);if(T)return null;var _=eZ.z.Provider,H=null;return D&&(H=(0,F.jsx)(_,{value:{note:c},children:(0,F.jsx)(eE.ZP,{blocks:c.content,postingBlog:p,isOriginalPost:!0})}),H=(0,F.jsx)("div",{className:eF.communityLabelCoverWrapper,children:(0,F.jsx)(eD.TR,R()(R()({},M.coverProps),{},{children:H}))}),H=(0,F.jsx)("div",{className:a()(eF.content,{[eF.imgIsFirstBlock]:(0,eT.RD)(c.content[0]),[eF.imgIsLastBlock]:(0,eT.RD)(c.content[c.content.length-1])}),"aria-label":o("Content"),children:H})),(0,F.jsxs)("div",{"aria-label":o("Reblog"),className:a()(eF.root,{[eF.animateOut]:W,[eF.isPinned]:S}),onAnimationEnd:()=>W&&B(!0),"data-testid":"reblog-note-block",children:[(0,F.jsxs)("div",{className:eF.header,children:[(0,F.jsx)("div",{className:eF.avatar,children:(0,F.jsx)(ea.Z,{avatarShape:b,imageResponse:m,name:y,url:x,dimension:+eF.avatarWidth,badge:eu.Z.ofType(v.w.Reblog),liveNow:j,className:a()({[eF.avatarLiveNow]:j})})}),(0,F.jsxs)("div",{className:eF.meta,children:[(0,F.jsxs)("div",{className:eF.blogInfo,children:[(0,F.jsx)(ei.Z,{className:eF.blogLink,blogName:y,postId:C,krakenEventName:g.J.PostActivityNoteClickBlogName,krakenEventDetails:{type:w},ellipsisOverflow:!0,children:y}),(0,F.jsx)("div",{className:eF.reblogParent,children:c.reblogParentBlogName&&(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)("div",{className:eF.reblogIcon,children:(0,F.jsx)(I.Z,{size:{width:14,height:14},isCompact:!0})})," ",["house-ad","blrmerch"].includes(c.reblogParentBlogName)?c.reblogParentBlogName:(0,F.jsx)(ei.Z,{blogName:c.reblogParentBlogName,href:(0,eA.Z)(c.reblogParentBlogName),showBlogCard:!1,children:c.reblogParentBlogName})]})})]}),(0,F.jsxs)("div",{className:eF.withDotSeparatorContainer,children:[r&&N&&(0,F.jsx)(eW.Z,{date:`${1e3*N}`,className:eF.withDotSeparator}),(0,F.jsx)(eD.f0,R()(R()({},M.headerProps),{},{className:eF.withDotSeparator}))]})]}),(0,F.jsx)("div",{className:eF.meatballsMenu,children:D&&(0,F.jsx)(eI,{blogName:y,canHideOrDeleteNotes:void 0!==l&&l,note:c,postTumblelogName:e.blog.name,refreshContent:d,removeNote:()=>Z(!0),onBlock:h})})]}),D&&(0,F.jsxs)(F.Fragment,{children:[void 0===u||u?(0,F.jsx)(eh.Z,{maxHeight:400,expandButtonClassName:eF.expandButton,onExpand:()=>{A(g.J.PostActivityNoteClickExpand,{type:w})},children:H}):H,(0,F.jsx)(eO.Z,{tags:c.tags,collapsedHeight:s?es.wrappedTagsMobileHeight:es.wrappedTagsDesktopHeight,postChromeStyles:{paddingLeft:0,paddingRight:0,marginTop:0===c.content.length?es.postActivityTagsMargin:0,marginBottom:es.postActivityTagsMargin}}),(0,F.jsxs)("footer",{className:eF.ctaButtons,children:[(0,F.jsx)(eR,{postId:C,blogName:y,noteType:c.type}),(0,F.jsx)(ei.Z,{blogName:y,postId:C,showBlogCard:!1,children:o("View post")})]})]})]})};var e_=o(83189),eH=o(60085),ez=o(93853),eq=o(60023),eG=(e,t)=>new eq.x(e,`/v2/mention${t&&t.length?`/${t}`:""}`,{method:"GET"});let eJ=e=>{var t=(0,i.useState)(),o=n()(t,2),r=o[0],s=o[1];return(0,i.useEffect)(()=>{if(r){var t,o;null===(t=e.current)||void 0===t||t.focus(),null===(o=e.current)||void 0===o||o.setSelectionRange(r,r),s(void 0)}},[e,r]),{updateCaretPosition:e=>s(e)}};var eU=(e,t,o,r)=>e.substring(0,o)+t+e.substring(r),e$=e=>{var t=[...e.matchAll(/@[a-z0-9-]*/gi)],o=[];return t.forEach(e=>{e&&void 0!==e.index&&o.push([e[0].replace(/@/,""),e.index,e.index+e[0].length])}),o}|"";let eY=e=>{var t=e.inputText,o=e.inputRef,r=e.autocompleteContainerRef,s=e.mentionListWidth,a=e.showEmptySuggestions,l=e.showSuggestion,c=e.updateInputText,d=(0,i.useState)(!1),p=n()(d,2),u=p[0],h=p[1],m=(0,i.useState)(!1),g=n()(m,2),v=g[0],b=g[1],y=(0,i.useState)(!1),x=n()(y,2),C=x[0],N=x[1],R=(0,i.useState)(),w=n()(R,2),k=w[0],j=w[1],S=(0,i.useState)([]),P=n()(S,2),L=P[0],T=P[1],B=(0,i.useRef)(new Map),I=(0,f.bp)().apiFetch,E=(0,eo.v$)().isSmartphone,O=eJ(o).updateCaretPosition,W=(0,i.useRef)(),Z=E?250:void 0===s?435:s,A=()=>{j(void 0),N(!1),h(!1),b(!1),T([]),B.current=new Map};(0,i.useEffe()},[t]),(0,i.useEffect)(()=>{var e=()=>{if(o.current){var e,t,r=null===(e=o.current)||void 0===e?void 0:e.selectionStart,s=null===(t=o.current)||void 0===t?void 0:t.selectionEnd,a=e$(o.current.value),i=null==a?void 0:a.find(e=>{var t=n()(e,3),o=(t[0],t[1]),a=t[2];return r&&s&&o>-1&&r>=o&&s<=a});if(i){var l=i[0],c=B.current.get(l);j(l),c?(b(!0),T(c.blogs),h(!0)):b(!1)}else T([]),h(!1),j(void 0)}()};return document.addEventListener("selectionchange",e),window.addEventListener("keydown"t)}},[o]),(0,i.useEffect)(()=>{var e;if(C&&N(!1),k&&(!k||!v))return null===(e=W.current)||void 0===e||e.cancel(),W.current=(0,ex.Z)(eG(I,k).fetch()),W.current.then(e=>{var o=e.response.blogs;C||h(!0),N(!1),b(!0),T(o),B.current.set(k,{blogs:o,start:t.indexOf(`@${k}`),end:t.indexOf(`@${k}`)+k.length+1]()}},[k,C,v]);var D=e=>{var r;if(e&&null!==(r=o.current)&&void 0!==r&&r.selectionStart&&(h(!1),N(!0),k&&k!==e.name)){var n,s=B.current.get(k),a=(null===(n=o.current)||void 0===n?void 0:n.selectionStart)-(null==k?void 0:k.length)-1,i=`@${null==e?void 0:e.name} `;c(eU(t,i,a,a+k.length+1+1)),j(void 0),O(s.start+i.length)}ll),_=()=>v&&(null==a?void 0:a());return{isShowingSuggestions:u,mentionSelected:B,showMentionSuggestions:()=>k&&u?(0,F.jsx)(eH.Z,{isShowing:!0,shouldEscapeParentOverflow:!0,popoverWidth:Z,searchText:k,suggestions:L,renderSuggestion:l,renderEmptySuggestions:_,onSelection:D,onClose:M,getSearchTextFromSuggestion:eV,autocompleteContainerRef:r,popoverPosition:ew.I2.BottomEnd,positionBasedOffsetModifiers:{[ew.I2.Bottom]:{left:-10,top:25}}}):null}};var eK=o(37236),eX=(0,p.q)("dollar");eX.defaultProps={size:{width:14,height:14}};var eQ=o(89689),e0=o(22183),e1={OriginalPoster:e=>{var t=(0,f.bp)()._c;return(0,F.jsx)(eQ.c,R()({text:t("Badge indicating that this user is the owner of this post","Original Poster"),wrapperClassName:"jYM9A",Icon:e0.Z,iconSize:14},e))},Tipper:e=>{var t=(0,f.bp)()._c;return(0,F.jsx)(eQ.c,R()({text:t("Badge indicating that this user has made a tip on this post","Tipper"),wrapperClassName:"ApIA5",Icon:eX,iconSize:14},e))}},e2=o(67023);let e3={root:"MI6Q7",meatballsMenu:"Oy37M",header:"Rnjfn",avatar:"rbSdL",container:"As9E4",isOriginalPoster:"zEhTP",isTip:"bvvDn",isTransient:"gDV3_",originalPoster:"Qq2qn",blogLinkWrapper:"UYeiG",threadedReplies:"Tg_iZ",blogLink:"tNyYL",content:"BKpXK",timestamp:"SAVhn",animateOut:"Wu5H0",tipHeader:"JAQNx",tipperLabel:"x9eX8",narrowBadgeWrapper:"hZ_Er",threadedRepliesWrapper:"N4a8t",showReplies:"Up4z9",showMoreReplies:"ifclM",replyCountButton:"NcZPX",replyCountButtonInner:"tS5OZ",count:"P06x2"};var e6=e=>{var t=e.canHideOrDeleteNotes,o=e.handleRemove,r=e.note,n=e.onBlock,s=e.onReplyClick,i=e.popoverLayout,l=e.postBlogName,c=e.refreshContent,d=(0,f.bp)(),p=d._c,u=d._t,h=d.features.threadedReplies,m=d.timestamps,b=(0,eo.v$)().isMobile,y=r.blogName,x=r.canDelete,C=r.isOriginalPoster,N=r.timestamp,R=r.type,w=R===v.w.Tip,k=i||b,j=C||w;return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsxs)("div",{className:a()(e3.header,{[e3.threadedReplies]:h}),children:[!h&&w&&(0,F.jsxs)("div",{className:e3.tipHeader,children:[(0,F.jsx)(eX,{}),(0,F.jsx)("span",{className:e3.tipperLabel,children:p("label indicating that this user has made a tip on this post","Tipper")})]}),(0,F.jsx)("div",{className:a()(e3.blogLinkWrapper,{[e3.threadedReplies]:h}),"aria-label":u("Blog name"),children:(0,F.jsx)(ei.Z,{blogName:y,className:e3.blogLink,krakenEventName:g.J.PostActivityNoteClickBlogName,krakenEventDetails:{type:R},ellipsisOverflow:h,children:y})}),m&&N&&(0,F.jsx)(eW.Z,{className:a()(e3.timestamp,{[e3.threadedReplies]:h}),date:`${1e3*N}`,dateFormat:e2.q.AutomaticCompact}),h&&!k&&j&&(0,F.jsxs)(F.Fragment,{children:[C&&(0,F.jsx)(e1.OriginalPoster,{}),w&&(0,F.jsx)(e1.Tipper,{})]}),h&&(0,F.jsx)(eI,{canHideOrDeleteNotes:t||x,blogName:y,meatballsClassName:a()(e3.meatballsMenu,e3.threadedReplies),note:r,postTumblelogName:l,refreshContent:c,removeNote:o,onReplyClick:s,onBlock:n,fill:P.paletteGray25})]}),h&&k&&j&&(0,F.jsxs)("div",{className:e3.narrowBadgeWrapper,children:[C&&(0,F.jsx)(e1.OriginalPoster,{}),w&&(0,F.jsx)(e1.Tipper,{})]})]})},e4=o(17276),e5=o.n(e4),e7=o(86743),e9=o(1308),e8=o(34438),te=e=>e.response.timeline.elements.map(e=>{var t=e.timestamp,o=e.blog,r=o.avatar,n=o.theme,s=o.name,a=o.liveNow,i=e.content,l=e.isOriginalPoster,c=e.canDelete,d=e.type,p=e.replyId,u=e.replyCount,h=e.children;return{avatar:r,avatarShape:n.avatarShape,blogName:s,blogUrl:(0,e8.SS)({peeprBlogname:s}),canDelete:c,content:i,isOriginalPoster:l,timestamp:t,liveNow:a,type:d===v.w.Tip?v.w.Tip:v.w.Reply,replyId:p,replyCount:u,children:h}}),tt=e=>e.response.notes.map(e=>{var t=e.avatarShape,o=e.avatarUrl,r=e.blogName,n=e.postId,s=e.reblogParentBlogName,a=e.timestamp,i=e.liveNow,l=e.isPinnedPreview;return{avatar:Object.keys(o).map(e=>({height:Number(e),width:Number(e),url:o[e]})),avatarShape:t,blogName:r,blogUrl:(0,e8.SS)({peeprBlogname:r}),postId:n,reblogParentBlogName:s,timestamp:a,liveNow:i,isPinnedPreview:l,type:v.w.Reblog}}),to=e=>e.response.timeline.elements.map(e=>{var t=e.timestamp,o=e.blog,r=o.avatar,n=o.theme,s=o.name,a=o.liveNow,i=e.communityLabels,l=e.content,c=e.postId,d=e.reblogParentBlogName,p=e.tags,u=e.isPinnedPreview;return{avatar:r,avatarShape:n.avatarShape,blogName:s,blogUrl:(0,e8.SS)({peeprBlogname:s}),postId:c,communityLabels:i,content:l,reblogParentBlogName:d,tags:p,timestamp:t,liveNow:a,isPinnedPreview:u,type:v.w.ReblogWithComment}}),tr=e=>e.response.timeline.elements.map(e=>{var t=e.timestamp,o=e.blog,r=o.avatar,n=o.theme,s=o.name,a=o.liveNow,i=e.communityLabels,l=e.content,c=e.postId,d=e.reblogParentBlogName,p=e.tags,u=e.isPinnedPreview;return{avatar:r,avatarShape:n.avatarShape,blogName:s,blogUrl:(0,e8.SS)({peeprBlogname:s}),postId:c,communityLabels:i,content:l,reblogParentBlogName:d,tags:p,timestamp:t,liveNow:a,isPinnedPreview:u,type:v.w.ReblogWithContentComment}}),tn=e=>e.response.notes.map(e=>{var t=e.avatarShape,o=e.avatarUrl,r=e.blogName,n=e.blogTitle,s=e.blogUrl,a=e.followed,i=e.timestamp,l=e.liveNow;return{avatar:Object.keys(o).map(e=>({height:Number(e),width:Number(e),url:o[e]})),avatarShape:t,blogName:r,blogTitle:n,blogUrl:s,followed:a,timestamp:i,liveNow:l,type:v.w.Like}});let ts=e=>{var t,o,r,n=e.mode,s=e.apiFetch,a=e.postBlogUuid,i=e.queryParams;switch(n){case v.L.Replies:t=(0,b.ZP)(s).getNotesTimeline,o=te,r=e=>{var t;return null==e||null===(t=e.response)||void 0===t||null===(t=t.timeline)||void 0===t||null===(t=t.links)||void 0===t?void 0:t.next};break;case v.L.RepliesOnRoot:i.scope="",i.mode=v.L.Replies,t=(0,b.ZP)(s).getNotesTimeline,o=te,r=e=>{var t;return null==e||null===(t=e.response)||void 0===t||null===(t=t.timeline)||void 0===t||null===(t=t.links)||void 0===t?void 0:t.next};break;case v.L.Reblogs:t=(0,b.ZP)(s).getNotes,o=tt,r=e=>{var t;return null==e||null===(t=e.response)||void 0===t||null===(t=t.links)||void 0===t?void 0:t.next};break;case v.L.ReblogsWithComments:t=(0,b.ZP)(s).getNotesTimeline,o=to,r=e=>{var t;return null==e||null===(t=e.response)||void 0===t||null===(t=t.timeline)||void 0===t||null===(t=t.links)||void 0===t?void 0:t.next};break;case v.L.ReblogsWithContentComments:t=(0,b.ZP)(s).getNotesTimeline,o=txt};break;case v.L.Likes:t=(0,b.ZP)(s).getNotes,o=txt}}return{apiRequest:t(a,i),apiResponseHandler:o,apiGetNextLink:r}};var ta=e=>{var t=e.postBlogUuid,o=e.postId,r=e.parentReplyId,n=e.enabled,s=(0,f.bp)().apiFetch;return(0,e7.N)({queryKey:["threaded_replies",t,o,r],queryFn:e=>{var n,a,i;return e5()().async(function(l){for(;;)switch(l.prev=l.next){case 0:if(!(a=e.pageParam)){l.next=3;break}return l.abrupt("return",s(a));case 3:return l.next=5,e5()().awrap(s(`/v2/blog/${t}/post/${o}/replies/${r}`,{queryParams:R()({},(0,e9.n9)(["avatar"]))}));case 5:return i=l.sent,l.abrupt("return",{elements:te(i),next:null===(n=i.response.timeline.links)||void 0===n||null===(n=n.next)||void 0===n?void 0:n.href});case 7:case"end":return l.stop()}},null,null,null,Promise)},initialPageParam:void 0,getNextPageParam:e=>e.next,enabled:void 0!==n&&n})},ti=e=>{var t,o=(0,f.bp)()._t,r=e.blog,s=e.note,l=s.children,d=s.replyCount,p=s.replyId,u=e.postId,h=e.refreshContent,m=(0,i.useState)(!0),g=n()(m,2),v=g[0],b=g[1],y=(0,i.useState)(!1),x=n()(y,2),C=x[0],N=x[1],w=ta({postBlogUuid:r.uuid,postId:u,parentReplyId:p,enabled:C}),k=w.data,j=w.isPending,S=w.fetchNextPag!e),L=o(v?"Hide replies":"Show replies"),T=(null==k||null===(t=k.pages)||void 0===t?void 0:t.flatMap(e=>e.elements))||[],B=l&&d&&d>l.length+(null==T?void 0:T.length);return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(tl,R()(R()({},e),{},{note:R()(R()({},e.note),{},{children:[]}),toggleShowReplies:P})),l&&(0,F.jsxs)("div",{"aria-label":o("Threaded replies"),className:e3.threadedRepliesWrapper,children:[(0,F.jsx)(c.Z,{label:L,wrapperClassName:a()(e3.showReplies,{[e3.showReplies]:v}),onClick:P,children:L}),v&&(0,F.jsxs)(F.Fragment,{children:[l.map(e=>(0,F.jsx)(tl,{blog:r,note:e,refreshContent:h},`${e.blogName}-${e.timestamp}`)),!j&&T.map(e=>(0,F.jsx)(tl,{blog:r,note:e,refreshContent:h},`${e.blogName}-${e.timestamp}`)),B&&(0,F.jsx)(c.Z,{label:o("Show more replies"),wrapperClassName:e3.showMoreReplies,onCl0)},children:o("Show more replies")})]})]})]})},tl=e=>{var t,o=(0,y.uu)().post,r=o.id,s=o.blogName,l=(0,en.i)().onReplyRemoved,d=e.avatarDimension,p=e.note,u=e.blog,h=e.canHideOrDeleteNotes,m=e.refreshContent,g=e.onBlock,b=e.popoverLayout,x=e.toggleShowReplies,N=e.scope,R=p.avatar,w=p.blogName,k=p.blogUrl,j=p.canDelete,S=p.content,L=p.isOriginalPoster,T=p.type,B=p.liveNow,I=(0,f.bp)(),E=I._t,W=I.features.threadedReplies,Z=C(),A=Z.setReplyText,D=Z.setRootNoteForThreads,M=(0,i.useState)(!1),_=n()(M,2),H=_[0],z=_[1],q=(0,i.useState)(!1),G=n()(q,2),J=G[0],U=G[1],$=()=>{null==l||l(r,N),U(!0)},V=T===v.w.Tip,Y=()=>{W?D(p):A(`@${w} `)},K=T===v.w.Reply&&!!p.isTransient,X=W?eK.o.Circle:p.avatarShape;return W&&p.children&&(null===(t=p.children)||void 0===t?void 0:t.length)>0?(0,F.jsx)(ti,{note:p,blog:u,refreshContent:m,postId:r}):H?null:(0,F.jsxs)("div",{className:a()(e3.root,{[e3.animateOut]:J}),"aria-label":E("Reply"),onAnimation!0),children:[(0,F.jsx)("div",{className:e3.avatar,children:(0,F.jsx)(ea.Z,{avatarShape:X,imageResponse:R,name:w,url:k,dimension:void 0===d?32:d,className:e3.noteAvatar,liveNow:B})}),(0,F.jsxs)("div",{className:a()(e3.container,{[e3.isOriginalPoster]:L,[e3.isTip]:V,[e3.isTransient]:K,[e3.threadedReplies]:W}),children:[!W&&L&&(0,F.jsxs)("div",{className:a()(e3.originalPoster,{[e3.isTransient]:K}),"aria-label":E("Original poster"),children:[(0,F.jsx)(e_.Z,{colors:{primary:K?P.paletteGreen:P.paletteAccent}}),(0,F.jsx)("span",{children:E("Original Poster")})]}),(0,F.jsx)(e6,{canHideOrDeleteNotes:h,handleRemove:$,note:p,onBlock:g,onReplyClick:Y,popoverLayout:b,postBlogName:s,refreshContent:m}),(0,F.jsx)("div",{className:e3.content,children:(0,F.jsx)(eE.ZP,{blocks:S,postingBlog:u,isOriginalPost:!0})}),W&&void 0!==p.replyCount&&(0,F.jsxs)(c.Z,{label:E("reply count button"),onClx(),wrapperClassName:e3.replyCountButton,className:e3.replyCountButtonInner,children:[(0,F.jsx)(O.Z,{size:{width:16,height:16},emptyIconColors:{primary:P.paletteGray65}}),p.replyCount>0&&(0,F.jsx)("span",{className:e3.count,children:p.replyCount})]})]}),!W&&(0,F.jsx)(eI,{canHideOrDeleteNotes:h||j,blogName:w,meatballsClassName:e3.meatballsMenu,note:p,scope:N,postTumblelogName:s,refreshContent:m,removeNote:$,onReplyClick:Y,onBlock:g})]})},tc=e=>{var t=e.scrollHeight>e.clientHeight,o=!window.getComputedStyle(e).overflowY.includes("hidden");return t&&o},td=e=>e&&e!==document.body?tc(e)?e:td(e.parentNode):document.body;let tp=e=>{var t=(0,i.useState)({width:0,height:0}),o=n()(t,2),r=o[0],s=o[1],a=(0,i.useRef)(new ResizeObserver(e=>{var t=e[0].contentRect;s({width:t.width,height:t.height})}));return(0,i.useEffect)(()=>{var t=null==e?void 0:e.current,o=null==a?void 0:a.current;return t&&o.observet)}},[e,a]),r},tu=e=>{var t=(0,i.useState)(!1),o=n()(t,2),r=o[0],s=o[1],a=(0,i.useRef)(null);(0,i.useEffect)(()=>{s(!1)},[e]);var l=tp(a).height;return{isCollapsed:!r&&l>400,handleShowMore:()=>s(!0),elementRef:a}};var th=o(22979),tm=o(13521);let tg={root:"rEGcu",withPadding:"fYhK7",isCollapsed:"VClPW",popoverLayout:"d5zR_",fixedHeightLayout:"tprzO",fullHeight:"M9BAn",contentContainer:"hfBkK",content:"aoipA",reminder:"G2YHl",showMoreContainer:"wNGSH",showMoreButton:"z2TcU",loaderContainer:"eE_rR",withNotes:"RgVTP",paginatorButtonContainer:"n7VLa",backToTopContainer:"xuqFW",backToTop:"ltf_C",backToTopEnabled:"Jh7uo"};var tv=(e,t)=>e.timestamp===Math.floor(t.timestamp)&&e.blogName===t.blogName,tb=e=>{var t=e.blog,o=e.canHideOrDeleteNotes,r=void 0!==o&&o,n=e.objects,s=e.onResults,a=e.refresh,l=e.refreshNotes,c=e.transientReplies,d=void 0===c?[]:c,p=e.mode,u=e.popoverLayout,h=e.scope;(0,i.useEffect)(()=>{null==s||s((null==n?void 0:n.length)===0)},[null==n?void 0:n.length,s]),l.current=a;var m=p!==v.L.Replies?n:n.file))),g=[...d,...m].reduce((e,o,n)=>{var s,i=`${o.blogName}-${o.timestamp}`;switch(o.type){case v.w.Tip:case v.w.Reply:s=(0,F.jsx)(tl,{blog:t,note:o,scope:h,canHideOrDeleteNotes:r,refreshContent:a,onBlock:a,popoverLayout:u},i);break;case v.w.Reblog:case v.w.ReblogWithComment:case v.w.ReblogWithContentComment:s=(0,F.jsx)(eM,{blog:t,canHideOrDelete:r,note:o,refreshContent:a,restrictHeight:n>0,onBlock:a},i);break;case v.w.Like:s=(0,F.jsx)(ep,{note:o},i)}return[...e,s]},[]);return(0,F.jsx)(F.Fragment,{children:g})},tf=e=>{var t=e.onClick,o=(0,f.bp)()._c;return(0,F.jsx)("button",{className:tg.showMoreButton,"aria-label":o("Shore more notes for a post","Show more"),onClick:t,children:o("Shore more notes for a post","Show more")})};let ty=e=>{var t,o,r=e.blog,s=e.containerRef,c=e.popoverLayout,d=e.mode,p=e.onPagination,u=e.postId,h=e.refreshNotes,m=e.transientReplies,b=e.showBackToTop,x=e.sortDirection,C=e.canReblog,N=e.fixedHeightLayout,w=e.noResultsView,j=e.replyCount,S=void 0===j?0:j,T=e.reblogCount,B=void 0===T?0:T,I=e.likeCount,E=void 0===I?0:I,O=e.selfReplyCount,W=void 0===O?0:O,Z=e.scrollContainerRef,A=e.pinPreviewNote,D=e.scope,M=(0,en.i)().onNotesUpdate,_=(0,f.bp)(),H=_.apiFetch,z=_._c,q=_.features,G=_.isLoggedIn,J=(0,eo.v$)().isMobile,U=(0,er._)().peeprLocation,$=(0,i.useState)(!1),V=n()($,2),ea=V[0],ei=V[1],el=(0,i.useState)(!0),ec=n()(el,2),ed=ec[0],ep=ec[1],eu=(0,i.useState)(!1),eh=n()(eu,2),em=eh[0],eg=eh[1],ev=tu(d),eb=ev.handleShowMore,ef=ev.isCollapsed,ey=ev.elementRef,ex=k(),eC=(0,i.useRef)(),eN=(0,eL.Pc)().data,eR=(0,y.b8)().post,ew=((0,tm.cP)()||{}).numGlassOpen,ek=void 0===ew?0:ew,ej=(0,i.useRef)(ek),eS=(0,i.useState)(ek),eP=n()(eS,1)[0],eT=(0,i.useRef)(!0);(0,i.useEffect)(()=>{ej.current=ek,eE()&&(eO()?(eA(),eW()):void 0===eC.current&&eZ())},[ek]);var eB=(0,i.useCallback)(e=>{switch(e){case v.L.Replies:return S;case v.L.Reblogs:case v.L.ReblogsWithComments:case v.L.ReblogsWithContentComments:case v.L.ReblogGraph:return B;case v.L.Likes:return E;default:return}},[E,B,S]),eI=(0,i.useMemo)(()=>{var e,t=eR.blogName,o=null==eN||null===(e=eN.user)||void 0===e?void 0:e.blogs.ame);return!!(null!=o&&o.includes(t))},[null==eN||null===(t=eN.user)||void 0===t?void 0:t.blogs,eR.blogName])ententd 0,eZ=()=>eC.current=Date.now(),eA=(0,i.useCallback)(()=>{eB(d)&&eC.current&&ex(g.J.PostActivityTimeSpent,{mode:d,isLoggedIn:!!(null!=eN&&eN.isLoggedIn),isPostAuthor:eI,timeSpentInSeconds:Math.ceil((Date.now()-eC.current)/1e3)})},[eB,ex,eI,null==eN?void 0:eN.isLoggedIn,d]),eD=(0,i.useCallback)(()=>{if(eE()&&!eO())switch(document.visibilityState){case"hidden":eA(),eW();break;case"visible":eZ()}},[eA]);(0,i.useEffect)(()=>{document.addEventListener("visibilitychange",eD);var e=eB(d);return e&&ex(g.J.PostActivityDisplayMode,{mode:d,count:e}),eD)}},[d]);var eF=e=>{var t=e.objects,o=e.refresh;return(0,F.jsx)(tb,{blog:r,canHideOrDeleteNotes:ea,objects:t,refresh:o,refreshNotes:h,transientReplies:m,onResults:ep,mode:d,scope:D,popoverLayout:c})};if(!r.uuid)return null;if(d===v.L.ReblogGraph)o=(0,F.jsx)(et.Z,{fallback:(0,F.jsx)(K.Z,{small:!0,centerOrientation:"horizontalAndVertical",color:L().paletteGray65}),children:(0,F.jsx)(ee,{postId:u.toString(),blogUuid:r.uuid,width:c?es.reblogGraphPopoverWidth:es.reblogGraphWidth,height:c?es.reblogGraphPopoverHeight:es.reblogGraphHeight,popoverLayout:!!c})});else{var eM=ts({mode:d,apiFetch:H,postBlogUuid:r.uuid,queryParams:{scope:D,mode:d,id:u,sort:d===v.L.Replies||d===v.L.RepliesOnRoot?x:t2,pinPreviewNote:!!A}}),e_={endpointApiRequest:eM.apiRequest,getObjectsFromResponse:eM.apiResponseHandler,getNextLink:eM.apiGetNextLink,onPagination:e=>{var t=e.response.response,o=t.canHideOrDeleteNotes,r=t.canSubscribe,n=t.isSubscribed,s=t.hiddenNotes,a=t.totalLikes,i=t.totalReblogs,l=t.totalNotes,c=t.totalReplies,d=t.selfReplies;(B!==i||E!==a||S!==c||W!==d)&&(null==M||M(u,{totalNotes:l,totalLikes:a,totalReblogs:i,totalReplies:c,selfReplies:d})),ei(o),eg(s),null==p||p({canSubscribe:void 0!==r&&r,isSubscribed:void 0!==n&&n})},loader:(0,F.jsx)("div",{className:a()(tg.loaderContainer,{[tg.withNotes]:!ed}),children:(0,F.jsx)(K.Z,{small:!0,centerOrientation:"horizontalAndVertical",color:L().paletteGray65})}),emptyView:w,scrollContainer:Z.current,onFetchNextPage:()=>{ex(g.J.PostActivityFetchMoreNotes,{type:d})}};o=c||N?(0,F.jsx)(X.ZP,R()(R()({},e_),{},{children:eF})):(0,F.jsx)(Q.ZP,R()(R()({},e_),{},{manualPaginatorButtonCss:{containerClassName:tg.paginatorButtonContainer},nextButton:(0,F.jsx)(tf,{}),concatenate:!0,children:eF}))}return(0,F.jsxs)("div",{className:a()(tg.root,{[tg.isCollapsed]:ef,[tg.fullHeight]:ed&&!(null!=m&&m.length)||d===v.L.ReblogGraph,[tg.popoverLayout]:c,[tg.fixedHeightLayout]:!c&&N,[tg.withPadding]:!(c&&d===v.L.ReblogGraph)}),ref:Z,"data-testid":"notes-root",children:[[v.L.Reblogs,v.L.ReblogsWithComments,v.L.ReblogsWithContentComments].includes(d)&&!C&&!ed&&G&&(0,F.jsx)("div",{className:tg.reminder,children:z("Reminder about reblog is disabled when note has history reblogs","Reblogs have been turned off for this post")}),d===v.L.Replies&&G&&em&&S<=10&&(0,F.jsx)("div",{className:tg.reminder,children:eR.isBlazed||(0,th.uz)(eR)?z("Reminder about replies being filtered and the count on the post can be different from the number shown in the reply tab for TSP or blazed post","Some replies might be waiting for approval, or might have been hidden, blocked, or removed"):z("Reminder about replies being filtered and the count on the post can be different from the number shown in the reply tab","Some replies may have been hidden, blocked, or removed")}),(0,F.jsx)("div",{className:tg.contentContainer,ref:ey,children:(0,F.jsx)(l.df,{onChange:e=>{eT.current=e,!1===e&&(eA(),eW()),!0===e&&void 0===eC.current&&eZ()},className:tg.content,children:o})}),ef&&!c&&!N&&(0,F.jsx)("div",{className:tg.showMoreContainer,children:(0,F.jsx)(tf,{onClick:eb})}),!ef&&!ed&&!c&&!N&&(0,F.jsx)("div",{className:tg.backToTopContainer,children:(0,F.jsx)("button",{className:a()(tg.backToTop,{[tg.backToTopEnabled]:b}),title:z("Scroll back to the top of the notes list","Back to the top"),onClick:()=>{if(null!=s&&s.current){var e=U?td(s.current):window,t=U?e.scrollTop:e.scrollY,o=s.current.getBoundingClientRect().top,r=(J?es.mobileHeaderHeight:q.redpopDesktopVerticalNav?0:es.desktopHeaderHeightPx)+es.postFooterControlsHeight;e.scrollTo({top:o+t-r})}},children:(0,F.jsx)(Y.I,{colors:{primary:P.paletteWhite}})})})]})},tx=(e,t)=>{var o=(0,f.bp)().apiFetch,r=(0,i.useState)(!1),s=n()(r,2),a=s[0],l=s[1],c=(0,i.useState)(!1),d=n()(c,2),p=d[0],u=d[1];return{isSubscribed:a,isSubscribeFetching:p,setIsSubscribed:l,toggleIsSubscribed:r=>{if(r!==a)return l(null!=r?r:!a),u(!0),o(`/v2/blog/${t}/posts/${e}/subscription`,{method:a?"DELETE":"POST"}).caa)}).finally(()=>u(!1))}}},tC=e=>{var t=e.mode,o=e.sortDirection,r=(0,i.useState)([]),s=n()(r,2),a=s[0],l=s[1],c=(0,ec.g)().data,d=(0,y.b8)();return(0,i.useEffe])},[t,o]),{transientReplies:a,createTransientReply:(e,t,o,r)=>{var n;c&&l([{avatar:r.avatar||[],avatarShape:(null===(n=r.theme)||void 0===n?void 0:n.avatarShape)||eK.o.Circle,blogName:r.name,blogUrl:(0,e8.SS)({peeprBlogname:r.name}),canDelete:!0,content:e,isOriginalPoster:!o&&d.post.blog.name===r.name,timestamp:t,type:v.w.Reply,liveNow:r.liveNow,isTransient:!0},...a])}}};var tN=o(48341),tR=o(27755);let tw=e=>{var t=e.suggestion.avatarUrl;return(0,F.jsx)(ea.Z,{dimension:36,imageResponse:[{url:t,width:36,height:36}]})},tk=e=>{var t=e.suggestion.name,o=e.searchText.length;return(0,F.jsxs)("div",{className:"_sPxH",children:[(0,F.jsx)("span",{className:"JBbjt",children:t.substr(0,o)}),t.substr(o)]})},tj=e=>{var t=e.suggestion;return(0,F.jsxs)("div",{className:a()("qBXSD",{XlXWo:!t.title}),children:[t.title||" "," "]})},tS=e=>{var t=e.suggestion,o=e.isSelected,r=e.searchText,n=e.onSelection,s=e.onSoftSelectiot)(tll);return(0,F.jsx)(eo.ZP,{children:e=>{var n=e.isMobile;return(0,F.jsxs)(c.Z,{wrapperClassName:a()("Qm8bK",{DX4oj:o,ILfBB:n}),className:"oJ3Af",onClick:i,onFocus:l,onMouseEnter:l,onMouseLeave:d,label:t.name,children:[n&&(0,F.jsx)(tw,{suggestion:t}),(0,F.jsxs)("div",{className:"l8oCE",children:[(0,F.jsx)(tk,{suggestion:t,searchText:r}),!n&&(0,F.jsx)(tj,{suggestion:t})]}),!n&&(0,F.jsx)(tw,{suggestion:t})]})}})};var tP=o(40760),tL=o(54382),tT=o(20069),tB=(0,p.q)("caret-circle");tB.defaultProps={size:{width:24,height:24}};var tI=o(41524),tE=o(33590),tO=o(91253),tW=o(94833),tZ=(0,tO.i)(tW.z.record(tW.z.boolean())),tA=(e,t)=>{var o=(0,f.bp)().apiFetchWithSchema;return(0,tE.a)({queryKey:["can_reply",e,t],queryFn:()=>{var r;return e5()().async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e5()().awrap(o(`/v2/blog/${e}/posts/${t}/can_reply`,tZ));case 2:return r=n.sent,n.abrupt("return",r.response);case 4:case"end":return n.stop()}},null,null,null,Promise)},staleTime:6e4,retry:!1})},tD=o(5553);let tF={selectorArrow:"LVIPf",tooltip:"WfXq9",tooltipArrow:"_36lfe",selectorWrapper:"EjoMR"};var tM="hasSeenReplyBlogSelectorHint",t_=e=>{var t=e.onSelectedBlogChange,o=e.hideBlogSelector,r=e.onBlogSelectorLoaded,s=(0,f.bp)()._c,l=(0,w.wL)().logEvent,c=(0,tD.n)().data,d=(0,ec.g)().data,p=(0,y.b8)(),u=p.post,h=u.id,m=u.blogName,v=p.presentationStyle,b=tA(m,h),x=b.data,C=b.isPending,N=b.isError,k=b.refetch,L=b.isRefetching,T=(0,i.useState)(),B=n()(T,2),I=B[0],E=B[1],O=(0,i.useState)([]),W=n()(O,2),Z=W[0],A=W[1],D=(0,i.useState)([]),M=n()(D,2),_=M[0],H=M[1],z=(0,i.useState)(!1),q=n()(z,2),G=q[0],J=q[1],U=S.E.getItem(tM),$=Z.length-_.length>1,V=v===j.Z.masonry,Y=(0,i.useRef)();return((0,i.useEffect)(()=>{var e=Z.find(e=>e.name===m&&!_.includes(e.name))||d;E(e),null==t||t(e)},[Z,_,t,m,d]),(0,i.useEffect)(()=>{if(!C&&N)null==r||r([],N);else if(!C&&x&&c){var e=c.filn x),t=Object.keys(x).fil[e]);e.length===t.length?null==r||r([],N):1===e.length?E(e[0]):(A(e),H(t),null==r||r(e,N))}},[C,x,c,N,r]),(0,i.useEffect)(()=>{"true"!==U&&$&&(J(!0),S.E.setItem(tM,JSON.stringify(!0)),Y.current=setTime!1),2500))},[$,U]),(0,i.useEffe()},[o,L,k]),(0,i.useEffent),[]),o||!I)?null:(0,F.jsx)(tI.Z,R()(R()({content:s("Tooltip for the blog selector for user reply with different blog","✨ Switch to reply as a different blog"),isOpen:G,position:V?ew.I2.TopStart:ew.I2.Bottom,tooltipWrapperClassName:tF.tooltip},V&&{arrowWrapperClassName:tF.tooltipArrow}),{},{children:(0,F.jsx)(tT.ZP,{displayAvatar:!0,avatarOnly:!0,avatarShape:eK.o.Circle,avatarDimension:36,blogs:Z,onClickSelectet(e)},selectedBlog:I,onToggle:e=>{e&&l({eventName:g.J.PostActivityOpenReplyBlogSelector})},selectorWrapperClassName:tF.selectorWrapper,optionalSelectorElement:$?(0,F.jsx)("span",{className:a()(tF.selectorArrow,{[tF.isNarrow]:V}),children:(0,F.jsx)(tB,{size:{width:13,height:13},colors:{primary:P.paletteGray65,background:P.paletteGray15,accent:P.paletteWhite}})}):void 0,disabledBlogNames:_,disableToggle:!$})}))},tH=(0,p.q)("reply-error");tH.defaultProps={size:{width:34,height:34}};var tz=(0,p.q)("reply-off");tz.defaultProps={size:{width:34,height:34}};let tq={label:"sQAB1",retryButton:"Fe8hh"};var tG=e=>{var t=e.state,o=void 0===t?"restricted":t,r=e.onRetry,n=e.retryCount,s=(0,f.bp)()._c,a="error"===o&&n<3;return(0,F.jsxs)(F.Fragment,{children:["restricted"===o&&(0,F.jsx)(tz,{colors:{primary:L().paletteBlue}}),"error"===o&&(0,F.jsx)(tH,{colors:{primary:L().paletteRed}}),(0,F.jsxs)("div",{className:tq.label,children:["restricted"===o&&s("Label shown on reply field when replies are restricted for the post","Replies are restricted for this post."),"error"===o&&n>=3&&s("Label shown on reply field when replies networking is erroring","Uh oh, we're working on the problem. Try again later."),a&&s("Label shown on reply field when replies networking is erroring","Something went wrong")]}),a&&(0,F.jsx)(c.Z,{wrapperClassName:tq.retryButton,onClick:r,label:s("Label for retry button when replies networking is erroring","Try again"),children:s("Retry button text when replies networking is erroring","Try again")})]})},tJ=o(30420),tU=e=>{var t=e.title,o=e.subTitle,r=e.onClose,n=e.wrapperClassName,s=(0,f.bp)()._t;return(0,F.jsxs)("div",{className:a()("kZHH3",n),children:[(0,F.jsxs)("div",{className:"hMRSq",children:[(0,F.jsx)("div",{className:"cjuNE",children:t}),(0,F.jsx)("div",{className:"be_Qy",children:o})]}),(0,F.jsx)(c.Z,{label:s("Close"),on,r()},wrapperClassName:"ey360",children:(0,F.jsx)(tJ.Z,{size:{width:8,height:8},colors:{primary:P.paletteWhite}})})]})},t$=e=>{var t=e.height,o=e.shape,r=e.width,n=e.wrapperClassName;return(0,F.jsx)("div",{role:"progressbar","aria-busy":!0,className:a()("xirJ8",n,{gxPJ6:"circle"===(void 0===o?"rect":o)}),style:{width:r,height:t}})};let tV={root:"OQjMh",textInputContainer:"Dx_DM",hasTip:"id48r",textInput:"x2Npm",inputArea:"N8H25",replyButtonIcon:"v6i4P",replyButtonInner:"IDQzP",popoverLayout:"mXmh6",emptySuggestions:"Cqc5j",skeletonWrapper:"_U83q",avatar:"GrpSU",button:"NzB5j",threadedReplies:"cjxpN",isFocused:"WRQyC",inputContainer:"u5dEF",tippingButton:"JjH_m",enabled:"GZPMx",reminderWrapper:"HuVLA",mention:"bE2GZ",isMobile:"EzMzk"};var tY=e=>{var t=e.isPopover;return(0,F.jsxs)("div",{className:tV.skeletonWrapper,children:[(0,F.jsx)(t$,{shape:"circle",width:36,height:36,wrapperClassName:tV.avatar}),(0,F.jsx)(t$,{width:t?250:412}),(0,F.jsx)(t$,{width:40,wrapperClassName:tV.button})]})},tK=(0,i.forwardRef)((e,t)=>{var o=e.popoverLayout,r=e.onAddReply,s=e.focusOnMount,l=void 0!==s&&s,d=e.onTipButtonClick,p=e.canReply,u=e.forcePlaceholder,h=e.community,m=(0,f.bp)(),v=m._t,b=m._c,y=m.features.threadedReplies,x=(0,W.iv)().tabId,C=(0,eo.v$)().isSmartphone,N=(0,i.useState)(""),w=n()(N,2),j=w[0],S=w[1],P=(0,i.useState)(!p),L=n()(P,2),T=L[0],B=L[1],I=(0,i.useState)(null),E=n()(I,2),O=E[0],Z=E[1],A=(0,i.useRef)(null),D=(0,i.useRef)(null),M=(0,i.useRef)(null),_=eJ(D).updateCaretPosition,H=(0,ec.g)().data,z=(0,i.useRef)(),q=(0,i.useRef)(0),G=(0,i.useState)((0,eS.U)([v("Add to the discussion"),v("Unleash a compliment"),v("Have something to say?"),v("Reply your heart out"),v("Add something wonderful"),v("Send something nice"),v("Your words here"),v("Say your thing")])),J=n()(G,2),U=J[0],$=J[1],V=(0,i.useState)(),Y=n()(V,2),K=Y[0],X=Y[1],Q=y&&K,ee=(0,i.useCallback)(e=>{e&&(z.current=e,e.name&&$(b("Placeholder on reply bar on the notes view which includes selected user blog name","Reply as @%1$s",[e.name])))},[b]),et=kalue),en=e=>{var t;e.shiftKey||e.nativeEvent.isComposing||e.key!==ez.SV.Enter||null!==(t=M.current)&&void 0!==t&&t.isEnterAsSubmitDisabled()||eh||(e.preventDefault(),es())},es=()=>{var e,t;(null==j?void 0:j.trim())!==""&&(et(g.J.PostActivitySendReply,{tab:x,is_primary:(null===(e=z.current)||void 0===e?void 0:e.name)===(null==H?void 0:H.name),reply_as:null===(t=z.current)||void 0===t?void 0:t.name,communityId:h}),r(j,z.current),S(""))};(0,i.useEfs()}},[l]),(0,i.useImperativeHandle)(t,()=>({setReplyText:e=>{S(e),_(`${e} `.length)},setRootNoteForThreads:e=>X(e)}));var ea=(0,i.useCalld(j)},[j,d]),ei=(0,i.useState)("auto"),el=n()(ei,2),ed=el[0],ep=el[1];(0,i.useEffect)(()=>{var e,t=null===(e=D.current)||void 0===e?void 0:e.scrollHeight;""!==j&&0!==t?ep(`${t}px`):ep("auto")},[j]);var eu=eY({inputRef:D,inputText:j,autocompleteContainerRef:A,updateInpu>S(e),showSuggestion:e=>(0,F.jsx)(tS,R()({},e)),showEmptySuggestions:()=>(0,F.jsx)("div",{className:tV.emptySuggestions,children:b("No blogs found","Blog not found")})}),eh=eu.isShowingSuggestions,em=eu.showMentionSuggestions,eg=(0,i.useCallback)((e,t)=>{B(!1),t?Z("error"):0===e.length?Z("restricted"):e.length>0&&ee(e[0])},[ee]);if((0,i.useEft=H)},[H]),null!==O)return(0,F.jsx)("div",{className:a()(tV.root,{[tV.popoverLayout]:o}),"aria-label":v("Reply restricted"),children:(0,F.jsx)(tG,{state:O,onRetry:()=>{B(!0),Z(null),q.current+=1},retryCount:q.current})});var ev=!!(null!=j&&j.trim()),eb=()=>(0,F.jsx)(tU,{title:(0,F.jsx)(tL.ZP,{comment:"Reminder to remind user which blog and reply they are currently replying to",params:{blogName:`@${null==K?void 0:K.blogName}`},components:{mention:(0,F.jsx)("span",{className:tV.mention})},children:"Replying to [mention][blogName][/mention]"}),subTitle:(null==K?void 0:K.content[0]).text,onid 0),wrapperClassName:a()(tV.reminderWrapper,{[tV.isMobile]:C})});return(0,F.jsxs)(F.Fragment,{children:[Q&&C&&(0,F.jsx)(eb,{}),(0,F.jsx)("div",{className:a()(tV.root,{[tV.popoverLayout]:o,[tV.threadedReplies]:y}),"aria-label":v("Reply field"),children:(0,F.jsxs)(tN.Z,{forwardedRef:M,shouldRenderHotkeyBlocker:document.activeElement===D.current,children:[(0,F.jsx)(t_,{onSelectedBlogChange:ee,hideBlogSelector:T,onBlogSelectorLoaded:eg}),T&&(0,F.jsx)(tY,{isPopover:o}),!T&&(0,F.jsxs)(F.Fragment,{children:[(0,F.jsxs)("div",{className:a()(tV.textInputContainer,{[tV.hasTip]:!!d,[tV.threadedReplies]:y,[tV.isFocused]:document.activeElement===D.current||ev}),children:[Q&&!C&&(0,F.jsx)(eb,{}),y&&(0,F.jsxs)("div",{className:tV.inputContainer,children:[(0,F.jsx)("div",{className:tV.textInput,children:(0,F.jsx)("textarea",{className:tV.inputArea,"aria-label":v("Reply"),ref:D,maxLength:475,rows:1,placeholder:u||U,onChange:er,onKeyDown:en,value:j,style:{height:ed}})}),d&&(0,F.jsx)(tP.Z,{onClick:ea,size:{width:20,height:20},withLabel:!1,wrapperClassName:a()(tV.tippingButton,tV.threadedReplies)}),(0,F.jsx)(c.Z,{"data-testid":"reply-button",wrapperClassName:a()(tV.replyButtonIcon,tV.threadedReplies,{[tV.enabled]:ev}),className:tV.replyButtonInner,type:"submit",onClick:es,disabled:!ev,label:v("Reply"),children:(0,F.jsx)(tR.Z,{size:{width:20,height:20}})})]}),!y&&(0,F.jsx)("div",{className:tV.textInput,children:(0,F.jsx)("textarea",{className:tV.inputArea,"aria-label":v("Reply"),ref:D,maxLength:475,rows:1,placeholder:u||U,onChange:er,onKeyDown:en,value:j,style:{height:ed}})})]}),!y&&d&&(0,F.jsx)(tP.Z,{onClick:ea,size:{width:20,height:20},withLabel:!1}),!y&&(0,F.jsx)(c.Z,{"data-testid":"reply-button",wrapperClassName:tV.replyButtonIcon,className:tV.replyButtonInner,type:"submit",onClick:es,disabled:!ev,label:v("Reply"),children:(0,F.jsx)(tR.Z,{size:{width:20,height:20}})})]}),em()]})})]})}),tX=o(51207);let tQ={root:"EnRJg",header:"blSOv",replyBar:"ER5ZX",popoverLayout:"W5tdN",toolbar:"WeDBT",totalNoteCount:"uzB7k",subscribe:"gAoFY",unsubscribe:"rRNAa",close:"ITBWF",snackbar:"WeEdi",snackbarText:"XKcwN"};var t0="replySortDirection",t1="asc",t2="desc";let t3=e=>{var t=e.blog,o=e.canReply,r=e.canReblog,s=e.id,p=e.likeCount,C=e.popoverLayout,N=e.onClose,R=e.onReplyAdded,w=e.reblogCount,P=e.reblogKey,T=e.replyCount,B=e.selfReplyCount,I=e.totalNoteCount,E=e.focusReplyOnMount,O=e.onTipButtonClick,W=e.expandNotesOnMount,Z=e.pinPreviewNote,A=e.liked,D=e.onModeChange,_=e.reblogFrom,H=e.isReblog,z=e.isCommunity,G=e.defaultMode,J=S.E.getItem(t0)||t1,U=(0,f.bp)(),$=U.apiFetch,Y=U._t,K=U._n,X=U._c,Q=U.isLoggedIn,ee=(0,y.uu)(),et=ee.post,eo=ee.presentationStyle,er=et.placementId,en=(0,i.useState)(G||(Z?v.L.ReblogsWithComments:v.L.Replies)),es=n()(en,2),ea=es[0],ei=es[1],el=(0,i.useState)(J),ec=n()(el,2),ed=ec[0],ep=ec[1],eu=(0,i.useRef)(null),eh=(0,i.useRef)(ea),em=(0,i.useRef)(null),eg=(0,i.useRef)(),ev=(0,i.useRef)(null),eb=tC({mode:ea,sortDirection:ed}),ef=eb.transientReplies,ey=eb.createTransientReply,ex=(0,i.useState)(!1),eC=n()(ex,2),eN=eC[0],eR=eC[1],ew=tx(s,t.name),ek=ew.isSubscribed,ej=ew.isSubscribeFetching,eS=ew.setIsSubscribed,eP=ew.toggleIsSubscribed,eL=(0,i.useState)(!1),eT=n()(eL,2),eB=eT[0],eI=eT[1],eE=k(),eO=(0,l.YD)(),eW=eO.ref,eZ=eO.inView,eA=(0,i.useState)([]),eD=n()(eA,2),eF=eD[0],eM=eD[1],e_=(0,i.useState)([]),eH=n()(e_,2),ez=eH[0],eq=eH[1],eG=(0,i.useRef)(!0);(0,i.useEffect)(()=>{E&&ea!==v.L.Replies&&eY(v.L.Replies)},[E,ea]),(0,i.useEffect)(()=>{if(!eG.current&&eh.current===v.L.Likes){var e;null===(e=eg.current)||void 0===e||e.call(eg)}eG.current=!1},[A]),(0,i.useEffect)(()=>{if(W)!T&&(w?ei(v.L.ReblogsWithComments):p&&ei(v.L.Likes));else if(!o&&0===T){var e=v.L.ReblogsWithComments;ei(S.E.getItem(M)||e)}},[]),(0,i.useEffect)(()=>{var e,t=()=>{var e;(null===(e=eu.current)||void 0===e?void 0:e.scrollTop)===0&&eF.length>0&&(eq([]),eM([]))};return null===(e=eu.current)||void 0===e||e.addEventListener("scrol",t)}},[eF]);var eJ=()=>{var e;return null===(e=eu.current)||void 0===e?void 0:e.scrollTo({top:0,behavior:"smooth"})},eU=(e,t,o)=>{var r=(0,m.m)(e,t,o);retu.e,r]),r.id},e$=(0,i.useCallback)(()=>eq(e=>[...e].slice(0,-1)),[]),eV=z&&ea===v.L.Replies?"self":"",eY=e=>{ei(e),eh.current=e,null==D||D(e)},eK=e=>{e.stopPropagation(),ek||eE(g.J.PostActivitySubscribe),eP()};return(0,F.jsxs)("div",{"aria-label":Y("Post Activity"),className:a()(tQ.root,{[tQ.popoverLayout]:C}),ref:em,"data-testid":"post-activity-container",children:[(0,F.jsx)(m.Z,{snackbars:ez,containerRef:em.current,removeSnackbar:e$,isPopover:eo===j.Z.masonry}),C&&(0,F.jsxs)("div",{className:tQ.toolbar,children:[void 0!==I&&(0,F.jsx)("span",{className:tQ.totalNoteCount,"aria-label":Y("Total notes"),children:K("%1$s note","%1$s notes",I)}),eN&&(0,F.jsxs)(F.Fragment,{children:[!ek&&(0,F.jsx)("button",{className:tQ.subscribe,title:X("User is not subscribed to activity updates for this post","Not subscribed"),onClick:eK,disabled:ej,children:(0,F.jsx)(u,{size:{width:18,height:18},colors:{primary:ej?L().paletteGray40:L().paletteBlack}})}),ek&&(0,F.jsx)("button",{className:tQ.unsubscribe,title:X("User is subscribed to activity updates for this post","Subscribed"),onClick:eK,disabled:ej,children:(0,F.jsx)(h,{size:{width:16,height:16},colors:{primary:ej?L().paletteGray40:L().paletteBlack}})})]}),(0,F.jsx)("button",{className:tQ.close,"aria-label":Y("Close"),on|N()},children:(0,F.jsx)(d.Z,{size:{width:12,height:12},colors:{primary:L().paletteBlack}})})]}),(0,F.jsx)("div",{ref:eW,className:tQ.header,children:(0,F.jsx)(q,{likeCount:p,popoverLayout:C,mode:ea,onChangeMode:eY,onChangeSortDirection:ep,isReblog:H,isCommunity:z,reblogCount:w,replyCount:T,selfReplyCount:B,sortDirection:ed,isSelectorOpen:eB,onChangeIsSelectorOpen:eI})}),(ea===v.L.Replies||ea===v.L.RepliesOnRoot)&&Q&&(0,F.jsx)("div",{className:tQ.replyBar,children:(0,F.jsx)(tK,{focusOnMount:E,popoverLayout:C,onAddReply:(e,o)=>(0,b.ZP)($).postReply(s,e,P,t.name,er,null==o?void 0:o.name,eV).fetch().then(r=>{var n,a,i=r.response,l=i.timestamp,d=i.content,p=et.trail,u=!!p&&p.length>0;ey(d||[{type:tX.kH.Text,text:e}],l,u,o||t),null==R||R(s,eV),null!==(n=eu.current)&&void 0!==n&&n.scrollTop&&(null===(a=eu.current)||void 0===a?void 0:a.scrollTop)>0&&eM([...eF,eU((0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)("span",{className:tQ.snackbarText,children:Y("Reply sent!")}),(0,F.jsx)(c.Z,{onClick:eJ,children:Y("View")})]}),"success",tQ.snackbar)])}),onTipButtonClick:O,ref:ev,canReply:o,forcePlaceholder:z?ea===v.L.RepliesOnRoot?Y("Reply to %1$s...",[`@${_}`]):Y("Reply to the community..."):void 0})}),(0,F.jsx)(x.Provider,{value:{replyInputRef:ev.current,setReplyText:e=>{var t;return null===(t=ev.current)||void 0===t?void 0:t.setReplyText(e)},setRootNoteForThs(e)}},children:(0,F.jsx)(ty,{fixedHeightLayout:!0,blog:t,containerRef:em,scrollContainerRef:eu,popoverLayout:C,mode:ea,isCommunity:z,scope:eV,onPagination:e=>{var t=e.canSubscribe,o=e.isSubscribed;eR(t),eS(o)},postId:s,refreshNotes:eg,transientReplies:ef,showBackToTop:!eZ,sortDirection:ed,canReply:o,canReblog:r,replyCount:T,reblogCount:w,selfReplyCount:B,likeCount:p,noResultsView:(0,F.jsx)(V,{mode:ea,scope:eV,canReply:o,canReblog:r,hasReplies:T>0,hasReblogs:w>0,hasSelfReplies:B>0,hasLikes:p>0,hasTransientReplies:ef&&ef.length>0,onChangeMode:eY,onTryAnotherF(!0)}}),pinPreviewNote:Z})})]})}},11007:(e,t,o)=>{o.d()=>s});var r=o(32415),n=o(4)(a)}function a(e){var t;if(null!==(t=e.user)&&void 0!==t&&t.blogs.length)return(0,n.Z)(e.user.blogs)||e.user.blogs[0]}}}]);