"use strict";(self.webpackChunkLIB=self.webpackChunkLIB||[]).push([[231],{126848878634363:(t,e,s)=>{s.d(e,{FeedStore:()=>w});var i=s(672562019417818),n=s(589566015866475),o=s(417211624016302),r=s(965511500706342),h=s(423946036116194),c=s(299878361094175),a=s(819799928313609),d=s(495799138022148),f=s(461204004294138),l=s(849960424048606),u=s(896583711158915),v=s(61326109834648);const p=7884e5;let w=class extends c.v{constructor(t,e,s){super(),this.t=t,this.e=e,this.elements=new Map,this.feeds=new Map,this.loop=1,this.fontCharacterCache=new Map,this.s=!1,this.i=!1,this._URI=this.e.FEEDS_STORAGE_ORIGIN?(0,d.C6)(this.e.FEEDS_STORAGE_ORIGIN,s):"",this.loop=this.t.loop}preloadFeeds(t){const e=[];for(const s of[...new Set(t)])e.push(this.add(s));return Promise.all(e)}resetIndexState(){this.elements.forEach((t=>{t.currentIndex=t.feed.step.start-1})),this.loop=1}updateElementsCurrentIndex(){this.s?this.s=!1:this.elements.forEach((t=>{const e=t.items;t.currentIndex=this.n(t.feed,e)}))}n(t,e){const{size:s,start:i,occurrence:n}=t.step;return"loop"===n?(0,f.wQ)(i-1+(this.loop-1)*s,e):Math.min(t.step.start-1,e-1)}skipNextIndexUpdate(t=!0){this.s=t}setFeedLoop(t,e){e?this.loop=t:this.loop<0&&t>0?this.loop+=t:this.loop=Math.max(1,t)}async add(t,e){if(!t)return Promise.resolve({data:[],intervalInSeconds:p});const s=this.feeds.get(t);if((null==s?void 0:s.feed)&&!e)return s.feed;this.feeds.set(t,{});const i=await this.fetchFeedData(t);this.feeds.get(t)&&this.feeds.get(t).interval&&clearInterval(this.feeds.get(t).interval.id);let n=!1;return i.intervalInSeconds>=p&&(n=!0),this.feeds.set(t,{feed:i,interval:{frequency:1e3*i.intervalInSeconds,id:this.i||n?null:setInterval((()=>this.updateFeedData(t)),1e3*i.intervalInSeconds)}}),this.feeds.get(t).feed}async fetchFeedData(t,e){var s;const i=this.feeds.get(t);if(i&&(i.overridden||e))return i.feed;const n=(null===(s=null==i?void 0:i.interval)||void 0===s?void 0:s.frequency)||6e4,o=Math.floor(Date.now()/1e3),r=o-o%Math.min(n/1e3,60),h=this.e.STUDIO_JS?`?cb=${r}`:"",c=(0,d.C6)(this._URI,`${t}.json${h}`);try{const t=await fetch(c,{method:"GET",mode:"cors",cache:"no-cache"});if(!t.ok)throw Error(t.statusText);const e=await t.json();for(const s of e.data)for(const t of Object.keys(s))s[t].value=null===s[t].value?void 0:s[t].value;return e}catch(a){throw new Error(`Could not fetch feed data: ${a}`)}}async updateFeedData(t){if(this.i&&0===this.feeds.size)return;const e=await this.fetchFeedData(t),s=this.feeds.get(t);s?(s.feed=e,this.loadFontsBasedOnFeedData(t),this.emit("dataChanged",{id:t,feedData:s.feed})):(0,h.S)("Feed not found in feed store",{contexts:{feeds:Object.fromEntries(this.feeds),feedId:t}})}loadFontsBasedOnFeedData(t,e=!1){if(this.e.STUDIO_JS)return;const s=this.feeds.get(t).feed,i=new Map,o=(t,e,s)=>e.style.uppercase||s?t.toLocaleUpperCase():t;for(const r of Array.from(this.elements.values()))if((0,n.BM)(r.element)){const e=r.element;let h="",c="";const a=!!e.uppercase;for(const n of e.content.spans)if((0,u.WT)(n)){if("variable"===n.type&&n.style.variable&&n.style.variable.id===t)for(const t of s.data){const e=Object.keys(t).filter((t=>t===(0,v.nw)(n.style.variable.path)));for(const s of e)n.style.font?c+=o(t[s].value,n,a):h+=o(t[s].value,n,a)}else n.style&&n.style.font?c+=o(n.content,n,a):h+=o(n.content,n,a);if(n.style&&n.style.font){const t=i.get(n.style.font.id);i.set(n.style.font.id,{content:(t?t.content:"")+c,font:Object.assign({},n.style.font)})}}if(e.font){const t=(0,n.DL)(e).uppercase,s=i.get(e.font.id);i.set(e.font.id,{content:(s?s.content:"")+(t?h.toLocaleUpperCase():h),font:Object.assign({},e.font)})}}for(const[n,{content:r,font:h}]of i.entries()){if(h.src.startsWith("data")){this.t.injectFontFace(h);continue}const t=this.fontCharacterCache.get(n);let s="";if(t)for(const e of r.split(""))-1===t.indexOf(e)&&(s+=e);else s=r;if(s){const i=s+(t||""),{textParams:o,distinctText:r}=(0,l._)(i);this.fontCharacterCache.set(n,r);const c=h.src.split(l.N)[0];h.src=c+o,e||this.t.injectFontFace(h)}}}getFeedValue(t,e,s){var i,n;const o=decodeURIComponent(t.path);try{this.addFeedElement(e,t,s);const r=this.elements.get(e);if(!r)throw new Error("Could not get feeded element");const h=null===(n=null===(i=this.feeds.get(r.feed.id))||void 0===i?void 0:i.feed)||void 0===n?void 0:n.data[r.currentIndex][o];if(!h)throw new Error(`Could not find any feed items with the field ${o}`);const c="string"==typeof h.targetUrl?(0,a.Nm)(h.targetUrl):void 0;return{value:"string"==typeof h.value?(0,f.yo)(h.value):h.value,targetUrl:c}}catch(r){return console.warn(r),this.elements.get(e)?{value:this.elements.get(e).feed.fallback,targetUrl:void 0}:{value:"",targetUrl:void 0}}}getFeedValueUrl(t,e,s){if(!t)return;const i=this.getFeedValue(t,e,s);return i.value&&"string"==typeof i.value&&(0,a.w6)(i.value)?(0,a.Nm)(i.value):void 0}addFeedElement(t,e,s){try{const i=this.feeds.get(e.id).feed.data.length;this.elements.get(t)&&this.elements.delete(t),this.elements.set(t,{items:i,currentIndex:this.n(e,i),feed:(0,o.Xh)(e),element:s})}catch(i){}}o(t,e,s){const i=this.t.creativeDocument.elements.find((e=>e.id===t));i&&this.addFeedElement(e,s,i)}getFeed(t){const e=this.feeds.get(t);if(e)return e.feed}destroy(){this.i=!0,this.feeds.forEach((t=>{t.interval&&clearInterval(t.interval.id)})),this.feeds.clear(),this.elements.clear(),this.clearEvents()}};w=(0,i.gn)([(0,i.fM)(0,(0,r.f3)(3)),(0,i.fM)(1,(0,r.f3)(2)),(0,i.w6)("design:paramtypes",[Object,Object,String])],w)}}]);b=1705951475]]></Tracking>
            </CreativeExtension>
          </CreativeExtensions>
        </Creative>
      </Creatives>
      <Extensions>
        <Extension type="activeview">
          <CustomTracking>
            <Tracking event="viewable_impression"><![CDATA[//ad.vidverto.io/delivery/v2/video/tracking?vast=events&token=ZHsp2wYTt1QDUS4MbDlZ1UM07KzL5fPuaPexaZ7AuEWPae2%2FO8KfoKQev5Ta%2FSqEQbzKcMoXwVkFRhM2h%2FAp14QtsXGTU0fXL8KiF2GadH%2F2hQsFXaPQaMQcTXf3oGe%2FhHUf7hPe9pdgeP4zQdp74kTQ3SyQ5aLzEKdZchQWC6lVXg2dZZSTLnGHAbiu0PQ4V9HptdsKRR%2FrerTz26tNoI8lTYUhLi0blsGOzPk7g1I%3D&cb=1705951475]]></Tracking>
            <Tracking event="measurable_impression"><![CDATA[//ad.vidverto.io/delivery/v2/video/tracking?vast=events&token=f7GTwsqYTnNvGyNUVgnEMKqlKvhRqN9qpkBgvJqK5yqpCU9FpYessS1DFAeiF9aja7O2w%2BDOVLsP7KQIFT%2FdYg4KUsYvXd2CvfW%2FcPyWZPIpQxoGBW82aBzN%2FShs2WeYqCI%2BuZ2t7DwkF5%2FO0dWkfj9WFMCchWcQvv%2FinSRO8HpJUqo6jX%2FU%2F%2BDsZtznWKr%2FvAa0JfmToh%2FdtBuaWHAQA1crr41QKe14S0sCCjfCKcw%3D&cb=1705951475]]></Tracking>
            <Tracking event="fully_viewable_audible_half_duration_impression"><![CDATA[//ad.vidverto.io/delivery/v2/video/tracking?vast=events&token=dkkhny%2Fy1KfZ0%2FI2nArZ5yKl3jVaeup9anVZcqlK7RioJ1vyVQ%2BJo%2FIR7o%2B5fi7l%2FY9d9rDKM6UAbnkEgOWCTbspCo692nOl3YA%2Bv1YRHF1Lz0WqD7DfTj120Tm0ccd55EgLdj%2BnBoO8GKvsuirF1LK3riJPoamkTXnDdUc0HMzWZWgmjaba9EFSnaBpbD0H7bWuOX4YiGKnKd4jtexieXQmRZzoE2U4FukA9RICHuozm6Z31TeRFDqxTjHd7gWI&cb=1705951475]]></Tracking>
          </CustomTracking>
        </Extension>
      </Extensions>
    </Wrapper>
  </Ad>
</VAST>
