(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[634],{iUYb:function(e,t,n){"use strict";n.r(t),n.d(t,"ConsumerInstallButtonComponent",(function(){return H}));var l=n("QjXU"),o=n("NrNW"),r=n("zsD3"),i=n("Zmq1"),a=n("CaQ9"),u=n("x3xY"),s=n("duEa"),c=n("faO/"),d=n("mXGw"),p=n.n(d),b=n("6DEw"),m=n("p/uK"),f=n("DU/N"),v=n("sLnE"),O=Object(m.a)({buyButton:Object(l.__assign)(Object(l.__assign)({backgroundColor:f.a.colorBrandBackground,color:f.a.colorNeutralForegroundOnBrand},v.a.borderColor("transparent")),{marginLeft:"12px",":hover":Object(l.__assign)(Object(l.__assign)({backgroundColor:f.a.colorBrandBackgroundHover},v.a.borderColor("transparent")),{color:f.a.colorNeutralForegroundOnBrand}),":active":Object(l.__assign)(Object(l.__assign)({backgroundColor:f.a.colorBrandBackgroundPressed},v.a.borderColor("transparent")),{color:f.a.colorNeutralForegroundOnBrand})})}),g=function(e){var t=e.text,o=e.ariaLabel,r=e.goPremiumDialogProps,i=e.logInstallClick,a=e.onInstallUpsellClick,c=e.logToggleConsumerDropdown,b=Object(l.__read)(Object(d.useState)(!1),2),m=b[0],f=b[1],v=p.a.useRef(null),O=p.a.useRef(null),g=p.a.useCallback((function(e){var t;e?(O.current=document.activeElement,c&&c(!0)):O&&O.current&&O.current===v.current&&(null===(t=v.current)||void 0===t||t.focus(),O.current=null),f(e)}),[c]),j=p.a.useCallback((function(e,t){var n;(null===(n=v.current)||void 0===n?void 0:n.contains(e))||g(t)}),[g]),C=Object(d.useCallback)((,[g,m]),k=Object(d.useMemo)((,[]),M=Object(d.useMemo)((function(){return p.a.createElement(u.a,{ref:icon:k,"aria-label":o,onClick:C,tabIndex:0},t)}),[o,k,C,t]),x=Object(d.useRef)(Object(d.lazy)(()),P=Object(d.useMemo)((function(){return m&&null!=v.current&&r?p.a.createElement(d.Suspense,{fallback:""},p.a.createElement(x.current,{targetRef:v.current,goPremiumDialogProps:r,flyoutOpen:m,logInstallClick:i,onInstallUpsellClick:a,handleOpenChange:j})):null}),[m,r,j,i,a]);return p.a.createElement(p.a.Fragment,null,M,P)},j="consumer-buy-button",C=function(e){var t=e.ariaLabel,n=e.buyUpsellProps,l=e.isMobile,o=e.goPremiumProps,r=e.text,i=e.showConsumerUpsell,a=e.logInstallClick,m=e.onInstallUpsellClick,f=e.logToggleConsumerDropdown,v=e.goPremiumButtonRef,C=e.showConsumerInstallMenu,k=e.installLinks,M=O(),x=Object(d.useMemo)((function(){return i&&n?p.a.createElement(u.a,{id:j,ref:v,onClick:function(){m&&m(c.a.BuyButton,null==n?void 0:n.buyOffice365Url),a&&a(j,"Navigate","Other","Install")},"aria-label":null==n?void 0:n.buyUpsellBtnText,className:M.buyButton,href:null==n?void 0:n.buyOffice365Url,title:(null==n?void 0:n.buyUpsellBtnTooltipText)||""},null==n?void 0:n.buyUpsellBtnText):null}),[n,a,m,i,M.buyButton,v]),P=Object(d.useMemo)((function(){return i&&o&&!l?p.a.createElement(g,{text:r,ariaLabel:t,goPremiumDialogProps:o,logInstallClick:a,onInstallUpsellClick:m,logToggleConsumerDropdown:f}):f?p.a.createElement(u.a,{icon:p.a.createElement(s.G,null),onClick:,r):null}),[t,o,l,a,m,f,i,r]),h=Object(d.useMemo)((function(){if(k)return p.a.createElement(b.a,{ariaLabel:t,text:r,installLinks:k,logInstallMenuToggle:f})}),[k,t,r,f]),B=Object(d.useMemo)((,[P,h,C]);return p.a.createElement("div",{id:"install-button"},B,x)},k=n("kPR3"),M=n("h8qh"),x=n("D/tM"),P=n("/Oio"),h=n("AGMK"),B=n("iPRk"),w=n("gB6C"),y=n("pdjy"),U=n("VvsH"),T=n("Coo+"),I=n("MF0e"),E=n("CU8J"),A=n("bcUD"),R=n("0Dwc"),_=n("5qtj"),D=n("6kHl"),L=n("gd1C"),S=n("am3b"),F=n("wVmX"),N=n("TYBc"),K=n("adEP"),G=Object(d.lazy)((),H=function(e){var t,n=e.appFilter,u=e.componentArea,s=e.showConsumerInstallMenu,b=Object(k.a)().data,m=Object(a.a)().data,f=Object(r.a)().data,v=Object(o.a)().data,O=Object(M.a)().data,g=null===(t=Object(T.a)().data)||void 0===t?void 0:t.result,j=Object(D.a)().isPwaInUwpEnabled,H=Object(l.__read)(Object(d.useState)(!1),2),z=H[0],W=H[1],Y=I.c,V=Object(d.useMemo)((function(){return f&&f.currentSkuInfo?f.currentSkuInfo.skuType:x.a.NotDetected}),[f]),X=function(){var e=Object(A.a)({experiences:[c.a.BuyButton,c.a.InstallGoPremiumButton]});return Object(d.useMemo)((function(){return e?{showConsumerUpsell:!0,launchDime:e}:{showConsumerUpsell:!1,launchDime:void 0}}),[e])}(),Z=X.showConsumerUpsell,q=X.launchDime,J=Object(d.useMemo)((function(){return Z&&(null==m?void 0:m.isPipl)}),[null==m?void 0:m.isPipl,Z]),Q=Object(d.useRef)(!1),$=Object(d.useMemo)((,[]),ee=function(e){var t=void 0===e?{}:e,n=t.installConfig,l=t.locStrings,o=t.userEntitlements,r=t.showConsumerUpsell,i=t.authTypeString,a=t.upsellTrackingParam,u=void 0===a?"":a;return Object(d.useMemo)((function(){if(n&&i&&o&&l&&i===I.c&&r){var e=l.installResources,t=o.isConsumerUser||o.IsSmb,a=t?e.haveProductKeyLnkText:e.haveM365ProductKeyLnkText;return{goPremiumBtnText:e.goPremiumBtnText,goPremiumDescription:(t?e.goPremiumDescriptionAlta:e.goPremiumDescription).replace(/<c0>/g,"").replace(/<\/c0>/g,"")||"",goPremiumUrl:(null==n?void 0:n.goPremiumUrl.replace(I.d,u))||"",haveOfficeProductKeyUrl:(null==n?void 0:n.haveOfficeProductKeyUrl)||"",haveOfficeProductKeyLnkText:a,needHelpInstallingOfficeUrl:(null==n?void 0:n.needHelpInstallingOfficeUrl)||"",needHelpInstallingOfficeLnkText:e.needHelpInstallingOfficeLnkText}}}),[i,n,l,o,r,u])}({installConfig:b,locStrings:O,userEntitlements:g,showConsumerUpsell:Z,authTypeString:Y,upsellTrackingParam:""}),te=function(e,t,n,l,o){var r,i,a,u;void 0===o&&(o="");var s=null===(i=null===(r=Object(E.a)())||void 0===r?void 0:r.data)||void 0===i?void 0:i.result;return Object(d.useMemo)((function(){var r,i;if(e&&t&&l&&l===I.c&&n){var a=t.installResources;return{buyUpsellBtnText:(null===(r=null==s?void 0:s.installButtonReactGates)||void 0===r?void 0:r.installButtonReactAltTextExperimentEnabled)?a.buyMicrosoft365BtnExperimentText:a.buyMicrosoft365BtnText,buyUpsellBtnTooltipText:(null===(i=null==s?void 0:s.installButtonReactGates)||void 0===i?void 0:i.installButtonReactTooltipExperimentEnabled)?a.buyMicrosoft365BtnTooltipText:void 0,buyOffice365Url:null==e?void 0:e.buyOffice365Url.replace(I.d,o)}}}),[l,null===(a=null==s?void 0:s.installButtonReactGates)||void 0===a?void 0:a.installButtonReactAltTextExperimentEnabled,null===(u=null==s?void 0:s.installButtonReactGates)||void 0===u?void 0:u.installButtonReactTooltipExperimentEnabled,e,t,n,o])}(b,O,Z,Y),ne=Object(l.__read)(Object(d.useState)(void 0),2),le=ne[0],oe=ne[1],re=Object(R.a)(n,u,$,j,b,v,O,g,Y),ie=Object(d.useCallback)((function(){return Object(l.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return Object(l.__generator)(this,(function(l){switch(l.label){case 0:return[4,re()];case 1:return(e=l.sent())&&!le&&(Q.current=!0,oe(e),Object(w.a)((,y.d),t="Install_Button_Ready_"+n,Object(h.a)()&&Object(B.a)(t)),[2]}}))}))}),[n,u,le,re,V]),ae=Object(d.useMemo)((function(){return!J&&void 0!==b&&void 0!==m&&void 0!==v&&void 0!==O&&!!g&&void 0!==f}),[J,b,m,v,O,g,f]);Object(d.useEffect)((,[ae,ie]);var ue=Object(d.useMemo)((function(){return le&&le.info?{isMobile:"GetMobileApps"===le.info.scenario,navigateToUrl:le.info.url,showWizard:le.showWizard,scenario:le.info.scenario}:{isMobile:!1,navigateToUrl:void 0,showWizard:!1,scenario:void 0}}),[le]),se=ue.isMobile,ce=ue.navigateToUrl,de=ue.scenario,pe=ue.showWizard,be=Object(d.useCallback)((,[W]),me=(null==v?void 0:v.workload)===P.a.Hwa,fe=Object(_.b)(u,Z,se,me,de,ce,pe?be:void 0,q,s),ve=fe.logInstallClick,Oe=fe.onInstallUpsellClick,ge=fe.logToggleConsumerDropdown,je=Object(U.a)("Install_GoPremiumButton"),Ce=function(e){var t,n,l=e.componentArea,o=Object(M.a)().data,r=Object(F.a)(),i=Object(d.useCallback)((function(e){var t=r?"Consumer-InstallMenu-Paid":"Consumer-InstallMenu-Free";Object(N.a)(t,l,"Click",e)}),[l,r]),a=Object(d.useCallback)((function(){i("ExploreApps");var e={route:"AppGallery",type:S.a.Base};Object(L.a)(e)}),[i]),u=Object(d.useCallback)((function(e,t){i(e),Object(L.a)(t)}),[i]);return{installLinksForConsumer:Object(d.useMemo)((function(){var e=new Array;if(!(null==o?void 0:o.installResources))return[];var t=o.installResources,n=r?{id:"ExploreApps",title:t.exploreApps,ariaLabel:t.exploreApps,iconName:"Apps",description:t.exploreAppsSubtext,onClick:a}:{id:"ExploreApps",title:t.exploreFreeApps,ariaLabel:t.exploreFreeApps,iconName:"Apps",description:t.exploreFreeAppsSubtext,onClick:a},l={id:"InstallMobileApp",title:t.installMicrosoft365MobileApp,ariaLabel:t.installMicrosoft365MobileApp,iconName:"Phone",description:t.installMicrosoft365MobileAppSubtext,onClick:function(){return u("InstallMobileApp","https://go.microsoft.com/fwlink/?linkid=2245833")}},i={id:"RedeemProductKey",title:t.redeemProductKey,ariaLabel:t.redeemProductKey,iconName:"DialPad",description:r?t.redeemProductKeyExtendSubtext:t.redeemProductKeySubtext,onClick:function(){return u("RedeemProductKey","https://go.microsoft.com/fwlink/?linkid=".concat(r?"2245832":"2245654"))}};return e.push(r?{id:"InstallApps",title:t.installMicrosoft365Apps,ariaLabel:t.installMicrosoft365Apps,iconName:"Download",showDivider:!0,description:t.installMicrosoft365AppsSubtext,onClick::{id:"InstallApps",title:t.installPremiumMicrosoft365Apps,ariaLabel:t.installPremiumMicrosoft365Apps,iconName:"Download",description:t.installPremiumMicrosoft365AppsSubtext,showAsDisabled:!0,showDivider:!0}),e.push(n),e.push(l),e.push(i),e}),[a,r,u,o]),installMenuButtonCaption:Object(d.useMemo)((function(){var e,t;return r?null===(e=null==o?void 0:o.installResources)||void 0===e?void 0:e.installMenuButtonTextForPaidUser:null===(t=null==o?void 0:o.installResources)||void 0===t?void 0:t.installMenuButtonTextForFreeUser}),[r,null===(t=null==o?void 0:o.installResources)||void 0===t?void 0:t.installMenuButtonTextForFreeUser,null===(n=null==o?void 0:o.installResources)||void 0===n?void 0:n.installMenuButtonTextForPaidUser])}}({componentArea:u}),ke=Ce.installLinksForConsumer,Me=Ce.installMenuButtonCaption,xe=Object(d.useMemo)((function(){if(!le)return null;var e=s?Me||"":le.text;return p.a.createElement(C,{ariaLabel:s?e:le.ariaLabel,buyUpsellProps:te,isMobile:se,goPremiumProps:ee,text:e,showConsumerUpsell:Z,logInstallClick:ve,onInstallUpsellClick:Oe,logToggleConsumerDropdown:ge,goPremiumButtonRef:je,showConsumerInstallMenu:s,installLinks:ke})}),[le,s,Me,te,se,ee,Z,ve,Oe,ge,je,ke]),Pe={installResources:null==O?void 0:O.installResources,cdnDomain:null==v?void 0:v.cdnDomain,platform:$.platform.platformType,userPrincipalName:null==m?void 0:m.userPrincipalName,toggleWizard:be,locale:null==v?void 0:v.preferredCulture.toLowerCase()};return p.a.createElement(p.a.Fragment,null,xe,z?p.a.createElement(d.Suspense,{fallback:null},p.a.createElement(G,Object(l.__assign)({},Pe))):null)};t.default=H},t5Ut:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var l=n("Ydwi"),o=n("VpHC");const r=e=>{Object(o.a)(e);const{iconOnly:t,iconPosition:n}=e;return Object(l.b)(e.root,{children:["after"!==n&&e.icon&&Object(l.a)(e.icon,{}),!t&&e.root.children,"after"===n&&e.icon&&Object(l.a)(e.icon,{})]})}},x3xY:function(e,t,n){"use strict";n.d(t,"a",();var l=n("mXGw"),o=n("t5Ut"),r=n("IE6Z"),i=n("VRIK"),a=n("ksZa");const u=l.forwardRef(((e,t)=>{const n=Object(r.a)(e,t);return Object(i.a)(n),Object(a.c)("useButtonStyles_unstable")(n),Object(o.a)(n)}));u.displayName="Button"}}]);
//# sourceMappingURL=vendors~consumer-install-component.822c20401cc98c2be4fc.chunk.v7.js.map