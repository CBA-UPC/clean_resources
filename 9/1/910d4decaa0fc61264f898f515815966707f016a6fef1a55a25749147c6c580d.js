__jp0({"success":true,"app_id":"33b5f1fd-593a-463b-85d4-72b0af659279","version":2,"features":{"restrict_origin":{"enable":true},"cookie_sync":{"enable":false},"metrics":{"enable":true,"mixpanel_reporting_token":"7c2582e45a6ecf1501aa3ca7887f3673"},"enable_on_session":false,"web_on_focus_enabled":true,"session_threshold":30},"config":{"prompts":{"slidedown":{"enabled":true,"prompts":[{"icon":"","text":{"acceptButton":"I'm in!","cancelButton":"No thanks","actionMessage":"Get breaking news and exclusives first !\n\nClick 'I'm in!' then 'Allow' for notifications","confirmMessage":"Thank You!","customizationEnabled":false,"emailLabel":"Email Address","smsLabel":"Phone Number","negativeUpdateButton":"Cancel","positiveUpdateButton":"Save Preferences","updateMessage":"Update your push notification subscription preferences."},"type":"push","delay":{"pageViews":1,"timeDelay":0},"enabled":true,"autoPrompt":false}],"autoPrompt":false,"acceptButton":"I'm in!","cancelButton":"No thanks","actionMessage":"Get breaking news and exclusives first !\n\nClick 'I'm in!' then 'Allow' for notifications","customizeTextEnabled":false,"pageViews":1,"timeDelay":0,"isTagsEnabled":false,"categories":{"negativeUpdateButton":"Cancel","positiveUpdateButton":"Save Preferences","tags":[],"updateMessage":"Update your push notification subscription preferences."}}},"siteInfo":{"name":"thesun.co.uk","origin":"https://www.thesun.co.uk","proxyOrigin":null,"defaultIconUrl":"https://img.onesignal.com/permanent/db565ca1-8d16-4d05-b2e0-b02d099f575d/O0sNNRuTTYWsHIHhAYib_oneSignalLogo.png","proxyOriginEnabled":false},"webhooks":{"enable":false,"corsEnable":false,"notificationClickedHook":null,"notificationDismissedHook":null,"notificationDisplayedHook":null},"integration":{"kind":"typical"},"serviceWorker":{"path":"/","workerName":"OneSignalSDKWorker.js","registrationScope":"/onesignal","updaterWorkerName":"OneSignalSDKWorker.js","customizationEnabled":true},"setupBehavior":{"allowLocalhostAsSecureOrigin":false},"autoResubscribe":true,"welcomeNotification":{"url":"https://link.thesun.co.uk/join/5pl/sailthru-new-enter-email","title":"SIGN UP!","enable":true,"message":"Get The Sun's newsletters","urlEnabled":true},"notificationBehavior":{"click":{"match":"exact","action":"navigate"},"display":{"persist":true}},"staticPrompts":{"slidedown":{"enabled":true,"prompts":[{"icon":"","text":{"acceptButton":"I'm in!","cancelButton":"No thanks","actionMessage":"Get breaking news and exclusives first !\n\nClick 'I'm in!' then 'Allow' for notifications","confirmMessage":"Thank You!","customizationEnabled":false,"emailLabel":"Email Address","smsLabel":"Phone Number","negativeUpdateButton":"Cancel","positiveUpdateButton":"Save Preferences","updateMessage":"Update your push notification subscription preferences."},"type":"push","delay":{"pageViews":1,"timeDelay":0},"enabled":true,"autoPrompt":false}],"autoPrompt":true,"acceptButton":"Subscribe","cancelButton":"Later","actionMessage":"Subscribe to our notifications for the latest news and updates. You can disable anytime.","customizeTextEnabled":false,"isTagsEnabled":false,"categories":{"negativeUpdateButton":"Cancel","positiveUpdateButton":"Save Preferences","tags":[],"updateMessage":"Update your push notification subscription preferences."}},"native":{"enabled":false,"autoPrompt":true},"bell":{"enabled":false,"size":"large","color":{"main":"#E12D30","accent":"white"},"dialog":{"main":{"title":"Manage Notifications","subscribeButton":"Subscribe","unsubscribeButton":"Unsubscribe"},"blocked":{"title":"Unblock Notifications","message":"Click here to learn how to unblock notifications."}},"offset":{"left":15,"right":15,"bottom":15},"message":{"subscribing":"Thanks for subscribing!","unsubscribing":"You won't receive notifications again"},"tooltip":{"blocked":"You've blocked notifications","subscribed":"You're subscribed to notifications","unsubscribed":"Subscribe to notifications"},"location":"bottom-right","hideWhenSubscribed":false,"customizeTextEnabled":false},"fullscreen":{"enabled":false,"title":"example.com","caption":"You can unsubscribe anytime","message":"This is an example notification message.","acceptButton":"Continue","cancelButton":"No Thanks","actionMessage":"Subscribe to our notifications for the latest news and updates. You can disable anytime.","autoAcceptTitle":"Click Allow","customizeTextEnabled":false},"customlink":{"enabled":false,"style":"button","size":"medium","color":{"button":"#e54b4d","text":"#ffffff"},"text":{"subscribe":"Subscribe to push notifications","unsubscribe":"Unsubscribe from push notifications","explanation":""},"unsubscribeEnabled":true}},"vapid_public_key":"BHEYZOqTueyqbSbvJyHeH-1fKWBCMWwxYJuOYlDFQ44sWs3v7CBLeCWSarjEKcpYsdPjccWCTPql7yDE0wr-RmA","onesignal_vapid_public_key":"BMzCIzYqtgz2Bx7S6aPVK6lDWets7kGm-pgo2H4RixFikUaNIoPqjPBBOEWMAfeFjuT9mAvbe-lckGi6vvNEiW0","safari_web_id":"web.onesignal.auto.13dd012d-81c7-44d8-8660-15690626d9c4","origin":"https://www.thesun.co.uk","outcomes":{"direct":{"enabled":true},"indirect":{"enabled":true,"notification_attribution":{"minutes_since_displayed":60,"limit":10}},"unattributed":{"enabled":true}}},"generated_at":1706866306})[Symbol.iterator]() method.")}()}function c(e,r){if(e){if("string"==typeof e)return u(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?u(e,r):void 0}}function u(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var d,g,h=["https://media.guim.co.uk/","https://i.guim.co.uk/"],f=function(e){return h.some((function(r){return e.startsWith(r)}))},p=["%%CURRENCY_SYMBOL%%","%%COUNTRY_NAME%%"],m=/%%.*?%%/g,v=function(e){var r,t,n=e.buttonText,a=e.buttonUrl,o=e.ophanComponentId,i=e.highlightedText,s=y(e),l=!!(t=null===(r=((i||"")+" "+s.join(" ")).match(m))||void 0===r?void 0:r.filter((function(e){return!p.includes("".concat(e))})))&&t.length>0;return Boolean(n&&a&&o&&s.length>0&&!l)},y=function(e){var r,t=[],n=function(e,r){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=c(e))){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==t.return||t.return()}finally{if(s)throw o}}}}(Object.keys(e).filter((function(e){return/^paragraph\d$/.test(e)})).sort());try{for(n.s();!(r=n.n()).done;){var a=e[r.value];a&&t.push(a)}}catch(e){n.e(e)}finally{n.f()}return t},b=(s(d={},"AppBanner",(function(e){var r=e.header,t=e.body,n=e.cta,a=e.imageUrl;return!(!(r&&t&&n&&a)||!f(a)&&(console.log("Image URL ".concat(a," is not allowed")),1))})),s(d,"BannerWithLink",(function(e){var r=e.header,t=e.body,n=e.buttonText,a=e.buttonUrl,o=e.imageUrl,i=e.ophanComponentId;return o&&!f(o)?(console.log("Image URL ".concat(o," is not allowed")),!1):Boolean(r&&t&&n&&a&&o&&i)})),s(d,"StyleableBannerWithLink",(function(e){var r=e.header,t=e.body,n=e.buttonText,a=e.buttonUrl,o=e.imageUrl,i=e.imageAltText,s=e.ophanComponentId;return o&&!f(o)?(console.log("Image URL ".concat(o," is not allowed")),!1):Boolean(r&&t&&n&&a&&o&&i&&s)})),s(d,"BannerNewsletter",(function(e){var r=e.header,t=e.body,n=e.imageUrl,a=e.ophanComponentId,o=e.newsletterId,i=e.frequency;return n&&!f(n)?(console.log("Image URL ".concat(n," is not allowed")),!1):Boolean(r&&t&&n&&a&&o&&i)})),s(d,"Epic",v),s(d,"EpicWithSpecialHeader",(function(e){var r=v(e);if(r){var t=e.authoredEpicImageUrl,n=e.authoredEpicImageAltText,a=e.authoredEpicBylineName;return t&&!f(t)?(console.log("Image URL ".concat(t," is not allowed")),!1):Boolean(t&&n&&a)}return r})),s(d,"USNewsletterEpic",(function(e){var r=e.header,t=e.frequency,n=e.paragraph1,a=e.ophanComponentId;return Boolean(r&&t&&n&&a)})),s(d,"AUNewsletterEpic",(function(e){var r=e.header,t=e.frequency,n=e.paragraph1,a=e.ophanComponentId;return Boolean(r&&t&&n&&a)})),s(d,"UKNewsletterEpic",(function(e){var r=e.header,t=e.frequency,n=e.paragraph1,a=e.ophanComponentId;return Boolean(r&&t&&n&&a)})),s(d,"DownToEarthNewsletterEpic",(function(e){var r=e.header,t=e.frequency,n=e.paragraph1,a=e.ophanComponentId;return Boolean(r&&t&&n&&a)})),s(d,"EpicNewsletter_AU_AfternoonUpdate",(function(e){var r=e.header,t=e.frequency,n=e.paragraph1,a=e.ophanComponentId;return Boolean(r&&t&&n&&a)})),s(d,"EpicNewsletter_TheGuide",(function(e){var r=e.header,t=e.frequency,n=e.paragraph1,a=e.ophanComponentId;return Boolean(r&&t&&n&&a)})),s(d,"NewsletterEpic",(function(e){var r=e.header,t=e.frequency,n=e.paragraph1,a=e.imageUrl,o=e.newsletterId,i=e.ophanComponentId;return!(!(r&&t&&n&&a&&o&&i)||!f(a)&&(console.log("Image URL ".concat(a," is not allowed")),1))})),d),w=function(){function e(r,t,n,o,i,s){a(this,e),this.id=void 0,this.appboy=void 0,this.message=void 0,this.slotName=void 0,this.cache=void 0,this.errorHandler=void 0,this.id=r,this.message=t,this.appboy=n,this.slotName=o,this.cache=i,this.errorHandler=s}return i(e,[{key:"logImpression",value:function(){try{this.appboy.logInAppMessageImpression(this.message)}catch(e){e instanceof Error&&this.errorHandler(e,"BrazeMessage.logImpression")}this.cache.remove(this.slotName,this.id,this.errorHandler)}},{key:"logButtonClick",value:function(e){var r=new this.appboy.InAppMessageButton("Button: ID ".concat(e),void 0,void 0,void 0,void 0,void 0,e);try{this.appboy.logInAppMessageButtonClick(r,this.message)}catch(e){e instanceof Error&&this.errorHandler(e,"BrazeMessage.logButtonClick")}}},{key:"extras",get:function(){return this.message.extras}}]),e}(),C=function(){function e(r,t,n){a(this,e),this.appboy=void 0,this.freshMessageBySlot=void 0,this.cache=void 0,this.errorHandler=void 0,this.appboy=r,this.cache=t,this.freshMessageBySlot={Banner:this.getFreshMessagesForSlot("Banner"),EndOfArticle:this.getFreshMessagesForSlot("EndOfArticle")},this.errorHandler=n}return i(e,[{key:"getFreshMessagesForSlot",value:function(e){var r=this;return new Promise((function(t){r.appboy.subscribeToInAppMessage((function(n){var a=n,o=a.extras;o&&o.slotName&&o.slotName===e&&(r.cache.push(e,{message:a,id:"".concat(Math.random().toString(16).slice(2),"-").concat((new Date).getTime())},r.errorHandler),t(a))}))}))}},{key:"getMessageForBanner",value:function(e){return this.getMessageForSlot("Banner",e)}},{key:"getMessageForEndOfArticle",value:function(e){return this.getMessageForSlot("EndOfArticle",e)}},{key:"getMessageForSlot",value:function(e,r){var t=this,n=this.getHighestPriorityMessageFromCache(e,r);return n?Promise.resolve(n):this.freshMessageBySlot[e].then((function(){var n=t.getHighestPriorityMessageFromCache(e,r);if(n)return Promise.resolve(n);throw new Error("No valid messages for ".concat(e," slot"))}))}},{key:"getHighestPriorityMessageFromCache",value:function(e,r){var t,n=this.cache.all(e,this.appboy,this.errorHandler).filter((function(e){return!!(r=e.message.extras)&&!!b[r.componentName]&&b[r.componentName](r);var r})),a={messagesWithFilters:(t=n).filter((function(e){return Boolean(e.message.extras.section)})),messagesWithoutFilters:t.filter((function(e){return!Boolean(e.message.extras.section)}))},o=a.messagesWithoutFilters,i=l(a.messagesWithFilters.concat(o).filter((function(e){var t;if(!e.message.extras.section||"string"!=typeof e.message.extras.section)return!0;var n=null==r||null===(t=r.section)||void 0===t?void 0:t.toLowerCase();return!!n&&e.message.extras.section.split("|").map((function(e){return e.toLowerCase()})).includes(n)})),1)[0];if(i)return new w(i.id,i.message,this.appboy,e,this.cache,this.errorHandler)}}]),e}(),B=function(){function e(){a(this,e)}return i(e,[{key:"getMessageForBanner",value:function(){return Promise.reject(new Error("No banner message"))}},{key:"getMessageForEndOfArticle",value:function(){return Promise.reject(new Error("No end of article message"))}}]),e}(),I=((g={}).Banner="Banner",g.EndOfArticle="EndOfArticle",g),k=function(e){return e.ProfileBadge="ProfileBadge",e}({}),M=function(){function e(r,t,n,o,i){a(this,e),this.id=void 0,this.slotName=void 0,this.card=void 0,this.appboy=void 0,this.errorHandler=void 0,this.id=r,this.slotName=t,this.card=n,this.appboy=o,this.errorHandler=i}return i(e,[{key:"logImpression",value:function(){try{this.appboy.logCardImpressions([this.card],!0)||this.errorHandler(new Error("Failed to log card impression event"),"BrazeCard.logImpressions")}catch(e){e instanceof Error&&this.errorHandler(e,"BrazeCard.logImpressions")}}},{key:"logCardClick",value:function(){try{this.appboy.logCardClick(this.card,!0)||this.errorHandler(new Error("Failed to log card click event"),"BrazeCard.logCardClick")}catch(e){e instanceof Error&&this.errorHandler(e,"BrazeCard.logCardClick")}}},{key:"logCardDismissal",value:function(){try{this.appboy.logCardDismissal(this.card)||this.errorHandler(new Error("Failed to log card dismiss event"),"BrazeCard.logCardDismiss")}catch(e){e instanceof Error&&this.errorHandler(e,"BrazeCard.logCardDismiss")}}},{key:"extras",get:function(){var e=this.card.extras;return void 0===e?{}:e}},{key:"expiry",get:function(){var e=this.card.expiresAt;return null===e?void 0:e}}]),e}(),z=function(){function e(r,t){a(this,e),this.appboy=void 0,this.errorHandler=void 0,this.appboy=r,this.errorHandler=t}return i(e,[{key:"getCardsForProfileBadge",value:function(){return this.getCardsForSlot(k.ProfileBadge)}},{key:"getCardsForSlot",value:function(e){var r=this;return this.appboy.getCachedContentCards().cards.flatMap((function(t){var n=t.extras;return n&&n.slotName&&n.slotName===e?void 0===t.id?(r.errorHandler(new Error("appboy card had no ID"),"BrazeCards.getCardsForSlot"),[]):[new M(t.id,e,t,r.appboy,r.errorHandler)]:[]}))}},{key:"lastUpdated",get:function(){return this.appboy.getCachedContentCards().lastUpdated}}]),e}(),E=function(){function e(){a(this,e)}return i(e,[{key:"getCardsForProfileBadge",value:function(){return[]}}]),e}(),U=function(e){return"".concat("gu.brazeMessageCache",".").concat(e)},S=function(e,r){var t=U(e);n.t.local.set(t,r)},x=function(e,r){return new r.HtmlMessage(e.message,e.extras,e.campaignId,e.cardId,e.triggerId,e.dismissType,e.duration,e.animateIn,e.animateOut,e.frameColor,e.htmlId,e.css,e.messageFields)},A=function(e,r){var t=function(e){var r=U(e),t=n.t.local.get(r);return Array.isArray(t)?t:[]}(e),a=t.filter((function(e){return r=e,Boolean((null==r?void 0:r.expires)&&Number.isFinite(null==r?void 0:r.expires)&&(null==r||null===(t=r.message)||void 0===t?void 0:t.id)&&(null==r||null===(n=r.message)||void 0===n||null===(n=n.message)||void 0===n?void 0:n.triggerId)&&(null==r||null===(a=r.message)||void 0===a||null===(a=a.message)||void 0===a?void 0:a.extras));var r,t,n,a})).filter((function(e){return e.expires>Date.now()}));if(t.length!==a.length){var o=t.length-a.length;r(Error("Removed ".concat(o," expired message").concat(1===o?"":"s"," from queue")),"LocalMessageCache"),S(e,a)}return a},F=function(){function e(){a(this,e)}return i(e,null,[{key:"peek",value:function(e,r,t){var n=A(e,t)[0];if(n)return{id:n.message.id,message:x(n.message.message,r)}}},{key:"all",value:function(e,r,t){return A(e,t).map((function(e){return{id:e.message.id,message:x(e.message.message,r)}}))}},{key:"remove",value:function(e,r,t){var n=A(e,t),a=n.findIndex((function(e){return e.message.id===r}));return!!(a>=0&&n.splice(a,1))&&(S(e,n),!0)}},{key:"push",value:function(e,r,t){var n=A(e,t);if(n.length<2){var a={message:r,expires:Date.now()+864e5};return n.push(a),S(e,n),!0}return t(new Error("Failed to add message to queue - queue full"),"LocalMessageCache"),!1}},{key:"clear",value:function(){for(var e in I){var r=U(e);n.t.local.remove(r)}}}]),e}()},84250:(e,r,t)=>{t.d(r,{p:()=>a});const n=/\b\/{2,}/g,a=function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return r.join("/").replace(n,"/")}}}]);
//# sourceMappingURL=BrazeMessaging-importable.client.web.5530f3dc75f4ac5d0e45.js.map