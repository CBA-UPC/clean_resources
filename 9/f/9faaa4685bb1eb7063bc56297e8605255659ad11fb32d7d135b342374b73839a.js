import{a as R,m as U}from"./vuex.esm-bundler_aa359dca_r24-02-0_b0_t240129-161140.js";import{H as k,L as a,A as d,D as m,N as y,I as l,O as g,J as F,Z as I,G as _,_ as u,B as M,a7 as N,ar as B}from"./vendor_6ed58054_r24-02-0_b0_t240129-161140.js";import{u as P,c as T,G as x,l as $}from"./index_31ad23dc_r24-02-0_b0_t240129-161140.js";import{u as S}from"./csrGlobalStoreCMSSitewide_0c2e7b56_r24-02-0_b0_t240129-161140.js";import{f as G}from"./dynamicDependencyLoader_69917fd7_r24-02-0_b0_t240129-161140.js";import{l as O}from"./cmsContentHelper_f68cc642_r24-02-0_b0_t240129-161140.js";import{s as V}from"./stateMachineMixinFactory_56714f8c_r24-02-0_b0_t240129-161140.js";import{R as D}from"./ModalResponsive_88f7b561_r24-02-0_b0_t240129-161140.js";import{E as H}from"./EmailCheck_3b9ce130_r24-02-0_b0_t240129-161140.js";import{u as j}from"./csrViewStoreReferralCMS_447ed04c_r24-02-0_b0_t240129-161140.js";import{B as L}from"./BlockBasic_fa826e2d_r24-02-0_b0_t240129-161140.js";import{C as q}from"./CheckboxItem_c90003c9_r24-02-0_b0_t240129-161140.js";import{E as K,u as z}from"./AlertNotice_f548d739_r24-02-0_b0_t240129-161140.js";import{T as J}from"./TextField_69ef4928_r24-02-0_b0_t240129-161140.js";import{P as W}from"./PasswordField_e5e3802a_r24-02-0_b0_t240129-161140.js";import{C as Z}from"./ClickwrapNotice_237df641_r24-02-0_b0_t240129-161140.js";import{S as Q}from"./SvgIcon_e55bd28a_r24-02-0_b0_t240129-161140.js";import{r as X}from"./registrationMixin_78800bdc_r24-02-0_b0_t240129-161140.js";import{F as Y}from"./lsanalytics-loyalty_c6fb8ea0_r24-02-0_b0_t240129-161140.js";import{_ as w}from"./_plugin-vue_export-helper_c27b6911_r24-02-0_b0_t240129-161140.js";import{s as ee,S as f,E as p}from"./registrationGateModalFlowConfig_9df5dacd_r24-02-0_b0_t240129-161140.js";import"./csrGlobalStoreAppState_f9ff4bfa_r24-02-0_b0_t240129-161140.js";import"./typeOf_b861069e_r24-02-0_b0_t240129-161140.js";import"./i18n_4b81f106_r24-02-0_b0_t240129-161140.js";import"./Modal_886b6642_r24-02-0_b0_t240129-161140.js";import"./trapFocus_6aa864f5_r24-02-0_b0_t240129-161140.js";import"./SpinnerSkeleton_362db941_r24-02-0_b0_t240129-161140.js";import"./useEmail_841316a4_r24-02-0_b0_t240129-161140.js";import"./dateRules_139f881d_r24-02-0_b0_t240129-161140.js";import"./regexRules_cc2f3e2b_r24-02-0_b0_t240129-161140.js";import"./regexLocalization_16c032f3_r24-02-0_b0_t240129-161140.js";import"./ssrGlobalStoreHeadMeta_ca820fb3_r24-02-0_b0_t240129-161140.js";import"./lsanalytics-login_d6e95fa1_r24-02-0_b0_t240129-161140.js";import"./serverToUserErrorMessageTransformer_631b8f39_r24-02-0_b0_t240129-161140.js";import"./ErrorMessages_003296c8_r24-02-0_b0_t240129-161140.js";import"./rules_bb747cab_r24-02-0_b0_t240129-161140.js";const te={provide:inject:["mq"],mixins:[X],emits:["onEditLinkClick","redirectAndClose","userRegistered","etoUserFound"],components:{BlockBasic:L,CheckboxItem:q,ErrorMessage:K,TextField:J,PasswordField:W,ClickwrapNotice:Z,SvgIcon:Q},props:{suppliedEmail:{type:String,default:""},email_source_code:{type:String,default:""},headline_text:{type:String,default:""},copy:{type:String,default:""},remarketing_checkbox:{type:Object,default:,exit_link:{type:Object,default:},setup(e){const{data:t,tempUser:o,v$:i,register:n}=z(e);return{firstName:t.firstName,lastName:t.lastName,password:t.password,email:t.email,emailOptInChecked:t.emailOptInChecked,otherErrorsExist:t.otherErrorsExist,submitting:t.submitting,tempUser:o,v$:i,register:n}},computed:{...k(S,["globalModalAccountCreationContent"]),...R("emailSubscriptionState",["subSource"]),clickwrapNoticeIdfirstNameFieldName(){return this.$t("i18n.formFirstNameLabel").toLowerCase()},lastNameFieldNamelinkText(){var e;return((e=this.exit_link)==null?void 0:e.link_text)||""},linkUrl(){var e;return((e=this.exit_link)==null?void 0:e.link_url)||""},getClassNamepasswordFieldName(){return this.$t("i18n.passwordText").toLowerCase()},registrationHeadingComponentProps(){return{setAriaDetailsId:this.clickwrapNoticeId,copy:this.globalModalAccountCreationContent.copy||"",headline:this.globalModalAccountCreationContent.headline||""}},subsourceIdentifiererrorTexts(){return[...this.v$.firstName.$errors.map(e=>e.$message),...this.v$.lastName.$errors.map(e=>e.$message),...this.v$.password.$errors.map(]},disabledJoinButton(){return this.errorTexts.length>0||this.submitting||!(this.firstName||this.lastName||this.password)},analyticsModalName,watch:{suppliedEmail:{handlerimmediate:!0}},mountedmethods:{onLinkClickasync onButtonClick(){const e=this.subSource(this.mq.current,this.subsourceIdentifier);this.$store.commit("emailSubscriptionState/updateState",{property:"subscribedFrom",value:e}),await this.register({onValidFormSubmit:onEtoUserFound:onUserRegistered:()=>{Y(),this.$emit("userRegistered")}})}}},re={class:"email-container"},ie={class:"email__text"},oe=["aria-label"],ae={class:"name-container lsco-col-md--show"},se=["role"],ne=["innerHTML"];function le(e,t,o,i,n,r){const c=a("svg-icon"),h=a("ErrorMessage"),C=a("TextField"),b=a("PasswordField"),E=a("CheckboxItem"),v=a("ClickwrapNotice"),A=a("BlockBasic");return d(),m(A,{class:u(r.getClassName),headline:o.headline_text,copy:o.copy,"button-text":e.$t("i18n.joinNow"),"link-text":r.linkText,disabled:r.disabledJoinButton,onButtonClick:r.onButtonClick,onLinkClick:r.onLinkClick},{center:y(()=>[l("div",null,[l("div",re,[l("div",null,[g(c,{name:"checkmark-circle",title:"Checkmark",height:"24px",width:"24px"}),l("span",ie,F(i.email),1)]),l("a",{class:"email__edit",onClick:t[0]||(t[0]=s=>e.$emit("onEditLinkClick")),onKeyup:t[1]||(t[1]=I(["enter"]))}," edit ",32)]),l("form",{method:"POST",class:"registration-form",action:"javascript:void(0);","aria-label":e.$t("i18n.join"),onSubmit:t[6]||(t[6]=},[i.otherErrorsExist&&this.$route.name==="ProductDetail"?(d(),m(h,{key:0,class:"error-message","light-scheme":"","html-message":e.$t("i18n.registrationErrorMessageDefault")},null,8,["html-message"])):_("",!0),i.otherErrorsExist&&this.$route.name!=="ProductDetail"?(d(),m(h,{key:1,class:"error-message","dark-scheme":"","html-message":e.$t("i18n.registrationErrorMessageDefault")},null,8,["html-message"])):_("",!0),l("div",ae,[g(C,{modelValue:i.firstName,"onUpdate:modelValue":t[2]||(t[2]=s=>i.firstName=s),class:u(["registration__input","name__input","lsco-col-md-3"]),"max-length":127,"label-text":e.$t("i18n.formFirstNameLabel"),name:r.firstNameFieldName,errors:i.v$.firstName.$errors,placeholder:e.$t("i18n.formFirstNameLabel"),"show-label":!!i.firstName,"validation-options":{errorTextAllReplaceWith:{i18nPath:"errors.regex"}}},null,8,["modelValue","label-text","name","errors","placeholder","show-label","validation-options"]),g(C,{modelValue:i.lastName,"onUpdate:modelValue":t[3]||(t[3]=s=>i.lastName=s),"max-length":127,class:u(["registration__input","name__input","lsco-col-md-3","lsco-col-md-offset-1"]),"label-text":e.$t("i18n.userProfileLastNameLabel"),name:r.lastNameFieldName,errors:i.v$.lastName.$errors,placeholder:e.$t("i18n.userProfileLastNameLabel"),"show-label":!!i.lastName,"validation-options":{errorTextAllReplaceWith:{i18nPath:"errors.regex"}}},null,8,["modelValue","label-text","name","errors","placeholder","show-label","validation-options"])]),g(b,{type:"new",modelValue:i.password,"onUpdate:modelValue":t[4]||(t[4]=s=>i.password=s),"aria-describedby":"password-error-message-footer",name:r.passwordFieldName,class:u(["registration__input","password-input"]),"label-text":e.$t("i18n.passwordText"),"show-errors":!1,"show-label":!!i.password,placeholder:e.$t("i18n.passwordText"),errors:i.v$.password.$errors,"max-length":255},null,8,["modelValue","name","label-text","show-label","placeholder","errors"]),l("p",{id:"password-error-message-footer",class:u(["password-error-message",{"error--active":i.v$.password.$errors&&i.v$.password.$errors.length>0}]),role:i.v$.password.$errors&&i.v$.password.$errors.length>0?"role":""},F(e.$t("i18n.passwordValidationText")),11,se),o.remarketing_checkbox.show_remarketing_checkbox?(d(),m(E,{key:2,class:"email-optin__checkbox",id:"email-optin__checkbox",checked:i.emailOptInChecked,"onUpdate:checked":t[5]||(t[5]=s=>i.emailOptInChecked=s)},{default:y(()=>[l("label",{for:"email-optin__checkbox",innerHTML:e.globalModalAccountCreationContent.clickwrap_checkbox||""},null,8,ne)]),_:1},8,["checked"])):_("",!0),g(v,{class:"clickwrap-notice","content-id":r.clickwrapNoticeId,html:e.globalModalAccountCreationContent.clickwrap_notice||""},null,8,["content-id","html"])],40,oe)])]),_:1},8,["class","headline","copy","button-text","link-text","disabled","onButtonClick","onLinkClick"])}const de=w(te,[["render",le],["__scopeId","data-v-0f7fa4ee"]]),ce={components:{BlockBasic:L},props:{headline_text:{type:String,default:""},copy:{type:String,default:""}}},me={class:"container"};function he(e,t,o,i,n,r){const c=a("BlockBasic");return d(),M("div",me,[g(c,{headline:o.headline_text,copy:o.copy},null,8,["headline","copy"])])}const ue=w(ce,[["render",he]]);const{NGS_ENV_REFER_A_FRIEND_PROGRAM:pe}=$,ge={mixins:[V(ee)],emits:["close","resetPassword","etoUserFound","type"],props:{isValidParams:{type:Boolean,default:!1}},components:{EmailCheck:H,ReferFriendRegistrationForm:de,ResponsiveModal:D,ReferAFriendExistingUser:ue},data:()=>({email:"",editEmail:!1,registrationGateEntry:{}}),computed:{...k(P,["country","locale"]),...R("auth",["loggedIn","hardLoggedIn"]),...U("userProfileState",["record"]),...k(T,["countryHasLoyaltyInLSA","isLoyaltyReferAFriendEnabled","paths"]),...k(j,["referralPage"]),...k(S,["globalModalEmailSignupWelcomeContent"]),getClassName(){return["registration-gate-modal","raf-registration-gate-modal","light",this.getFormsClass]},getModalBodyClass(){return["registration-gate-body","lsco-col-xs-20","lsco-col-md-offset-2","lsco-col-md-offset-right-2","lsco-col-md-7",{"enrollment-confirmation__modal":this.stateName===f.ENROLLMENT_CONFIRMATION}]},canGoBack(){return[f.REGISTRATION].includes(this.stateName)},emailCheckProps(){var e,t,o;return{...(e=this.registrationGateEntry)==null?void 0:e.existing_email_check,ariaLabelledby:(o=(t=this.registrationGateEntry)==null?void 0:t.existing_email_check)==null?void 0:o.headline_text,darkScheme:!0}},registrationFormProps(){var e,t,o;return{...(e=this.registrationGateEntry)==null?void 0:e.create_account,ariaLabelledby:(o=(t=this.registrationGateEntry)==null?void 0:t.create_account)==null?void 0:o.headline_text}},existingUserRAFProps(){var e,t,o,i,n,r,c,h;return this.isValidParams?{...(r=this.registrationGateEntry)==null?void 0:r.email_exists,ariaLabelledby:(h=(c=this.registrationGateEntry)==null?void 0:c.email_exists)==null?void 0:h.headline_text}:(t=(e=this.registrationGateEntry)==null?void 0:e.not_eligible)!=null&&t.headline_text?{...(o=this.registrationGateEntry)==null?void 0:o.not_eligible,ariaLabelledby:(n=(i=this.registrationGateEntry)==null?void 0:i.not_eligible)==null?void 0:n.headline_text}:{headline_text:this.$t("i18n.referAFriendSorry"),copy:this.$t("i18n.referAFriendNotEligible"),ariaLabelledby:this.$t("i18n.referAFriendSorry")}},getFormsClass(){return this.isValidParams?"email-entry-form":(this.stateService.send(p.USER_FOUND),"oops-modal")},clickwrapNotice(){const{termsOfUseRedTab:e}=this.paths;return this.$t("i18n.referAFriendTermsApply",[e])}},watch:{loggedIn(e){if(!e)return;[f.EMAIL_CHECK,f.LOGIN].includes(this.stateName)&&this.close()},referralPage,created(){this.$_states=f,this.$_events=p,this.fetchCms()},methods:{closeonEmailCheckLinkClickedonUserFound(e){this.email=e,this.stateService.send(p.USER_FOUND)},onUserNotFoundredirectAndCloseModal({redirectPath:e}){this.$router.push({path:O(e,this.country,this.locale)}),this.close()},async fetchCms(){var e;this.registrationGateEntry=(e=this.referralPage)==null?void 0:e.referral_registration},onBackButtonClicked(){this.editEmail=!1,this.stateService.send(p.BACK)},onClickEditEmailonEtoUserFoundDuringRegistration(e){this.$authEmitter.emit(x.CLOSE_REGISTRATION_GATE),this.$authEmitter.emit(x.MERGE_ACCOUNT,{userEmail:e})},onUserRegisteredasync getPromoCode(){typeof window=="object"&&this.isLoyaltyReferAFriendEnabled&&this.hardLoggedIn&&(await G(),function(e,t,o,i,n){for(e[t]=e[t]||{},e[t].q=e[t].q||[];n<i.length;)o(i[n++],e[t])}(window,"extole",(e,t)=>{t[e]=t[e]||,["createZone"],0),window.extole.createZone({name:"conversion",data:{email:this.record.uid,coupon_code:"REFER",first_name:this.record.firstName,last_name:this.record.lastName,partner_user_id:this.record.customerId,label:pe,advocate_code:this.$route.query.extole_shareable_code,country:`${this.country}`,locale:`${this.locale}`}}))}}};function _e(e,t,o,i,n,r){const c=a("EmailCheck"),h=a("ReferFriendRegistrationForm"),C=a("ReferAFriendExistingUser"),b=a("ResponsiveModal");return d(),m(b,{class:u(r.getClassName),"full-width-mobile":!1,"can-close":!0,"show-back-button":r.canGoBack,"show-close-button":!0,onBackClicked:r.onBackButtonClicked,onCloseModal:r.close},{body:y(()=>[l("div",{"data-testid":"registration-gate-content",class:u(r.getModalBodyClass)},[e.stateName===e.$_states.EMAIL_CHECK?(d(),m(c,N({key:0},r.emailCheckProps,{class:"email-check","initial-email":e.email,"edit-email":e.editEmail,"clickwrap-notice":r.clickwrapNotice,onUserFound:r.onUserFound,onUserNotFound:r.onUserNotFound,onLinkClicked:r.onEmailCheckLinkClicked}),null,16,["initial-email","edit-email","clickwrap-notice","onUserFound","onUserNotFound","onLinkClicked"])):_("",!0),e.stateName===e.$_states.REGISTRATION?(d(),m(h,N({key:1},r.registrationFormProps,{"supplied-email":e.email,"onUpdate:suppliedEmail":t[0]||(t[0]=,onUserRegistered:r.onUserRegistered,onRedirectAndClose:r.redirectAndCloseModal,onOnEditLinkClick:r.onClickEditEmail,onEtoUserFound:r.onEtoUserFoundDuringRegistration}),null,16,["supplied-email","onUserRegistered","onRedirectAndClose","onOnEditLinkClick","onEtoUserFound"])):_("",!0),e.stateName===e.$_states.LOGIN?(d(),m(C,B(N({key:2},r.existingUserRAFProps)),null,16)):_("",!0)],2)]),_:1},8,["class","show-back-button","onBackClicked","onCloseModal"])}const Ye=w(ge,[["render",_e],["__scopeId","data-v-4c8b1844"]]);export{Ye as default};
