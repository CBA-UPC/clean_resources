/*! For license information please see draft-cnt.0168cbdccdfeb7c4843d.chunk.v7.js.LICENSE.txt */
(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[168,0,1,2,3,4,15,38,42,44,55,91,100,158,160,563,625,774,775],{"+4M4":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("NrNW"),o=n("B5kz"),i=n("CaQ9"),s=n("yNE0");function a(){var e=Object(r.a)().data,t=Object(i.a)().data;return Object(o.c)(["FeatureSettings"],(function(){return Object(s.a)(t,e)}),{staleTime:1/0,cacheTime:1/0,enabled:e&&t})}},"+Ckz":function(e,t,n){var r=n("V2ZB"),o=n("tb+2");e.exports=function(e,t){return r(e,o(e),t)}},"+DV+":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));class r{constructor(e,t){this.expiry=e,this.cleanup=t,this.gcTimeouts=new Map}schedule(e){"indefinite"!==this.expiry.policy&&this.gcTimeouts.set(e,setTimeout((()=>{this.cleanup(e),this.cancel(e)}),this.expiry.durationMs))}cancel(e){const t=this.gcTimeouts.get(e);void 0!==t&&(clearTimeout(t),this.gcTimeouts.delete(e))}update(e){"sliding"===this.expiry.policy&&(this.cancel(e),this.schedule(e))}}class o{constructor(){let{expiry:e={policy:"indefinite"},removeOnError:t=(()=>!0)}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.cache=new Map,this.removeOnError=t,this.gc=new r(e,(e=>this.remove(e)))}has(e){return this.cache.has(e)}get(e){return this.has(e)&&this.gc.update(e),this.cache.get(e)}remove(e){return this.gc.cancel(e),this.cache.delete(e)}async addOrGet(e,t){let n=this.get(e);return void 0===n&&(n=(async()=>t())(),this.cache.set(e,n),n.catch((t=>{this.removeOnError(t)&&this.remove(e)})),this.gc.schedule(e)),n}add(e,t){const n=this.has(e);return this.addOrGet(e,t).catch((()=>{})),!n}async addValueOrGet(e,t){return this.addOrGet(e,(async()=>t))}addValue(e,t){return this.add(e,(async()=>t))}}},"+I+c":"+fvi":function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"g",(function(){return m})),n.d(t,"f",(function(){return g})),n.d(t,"e",(function(){return v})),n.d(t,"d",(function(){return b}));var r=n("QjXU"),o=n("FtiY"),i=n("FPnS"),s=n("AlWG"),a=n("dpyN"),c=n("kAGr"),u=new s.a(o.a),l=new s.a(i.a.default),d=new s.a(void 0),h=u.asObservable(),f=l.asObservable().pipe(Object(a.a)()),p=d.asObservable().pipe(Object(a.a)()),m=o.a,g=i.a.default,v=void 0;function b(e,t,o){return void 0===t&&(t=!1),void 0===o&&(o=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){var i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(c.a)(e)];case 1:return i=r.sent(),t?[4,Promise.all([n.e(10),n.e(176)]).then(n.bind(null,"EBLj")).then((function(t){return t.loadLegacyFabricTheme(e)}))]:[3,3];case 2:r.sent(),r.label=3;case 3:return o?[4,n.e(586).then(n.bind(null,"LPeS")).then((function(t){return t.loadLegacyOfficeTheme(e)}))]:[3,5];case 4:r.sent(),r.label=5;case 5:return m=i,u.next(i),g=e.mode,l.next(e.mode),v=e.themeId,d.next(e.themeId),[2,i]}}))}))}},"+gb4":function(e,t,n){"use strict";function r(e,t,n){return!t||"Fluid"!==t&&"Forms"!==t?"_blank":"_self"}n.d(t,"a",(function(){return r}))},"+k3c":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("QjXU"),o=n("Dn7E"),i=n("NeQC"),s=n("nX9G"),a=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(s.a)()];case 1:return t=r.sent(),n=t.launchFile,a=t.launchInDesktopApps,[4,Object(i.a)()];case 2:return c=r.sent().capabilities,u={success:!1},e.webUrl&&c.lorByDefaultEnabled?[4,a(e)]:[3,4];case 3:u=r.sent(),r.label=4;case 4:return Object(o.a)({featureName:"LinksOpenRight",eventName:"LinksOpenRightLaunchNativeFile"}),u.success?[2,{success:u.success}]:[2,n(e)]}}))}))}},"+sqR":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("QjXU"),o=n("mXGw"),i=n("+fvi");function s(){var e=Object(r.__read)(Object(o.useState)(i.g),2),t=e[0],n=e[1];return Object(o.useEffect)((function(){var e=i.a.subscribe(n);return function(){null==e||e.unsubscribe()}}),[]),t}},"+vVg":function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var r=n("QjXU"),o=n("mgFK"),i=n("W7wX");function s(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Object(i.a)()];case 1:return[2,!e.sent().isMsa]}}))}))}function a(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Object(i.a)()];case 1:return[2,e.sent().isMsa]}}))}))}var c=n("/Oio"),u=n("MJsD");function l(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(u.a)()];case 1:return[2,t.sent().workload===e]}}))}))}function d(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,l(c.a.Hwa)];case 1:return[2,e.sent()]}}))}))}function h(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,l(c.a.Embed)];case 1:return[2,e.sent()]}}))}))}var f=n("vb0f"),p=n("yQST"),m=n("CRHC"),g=n("m32Q"),v=n("lkvL"),b=n("a3FV"),y=n("0TX8"),w=n("Wa5Y");function C(e,t,n,o,i,s,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:c={method:"GET",responseType:"json",url:"".concat(o,"/api/userEntitlements")},r.label=1;case 1:return r.trys.push([1,4,,5]),[4,Object(y.a)(c,n,i,t)];case 2:return r.sent(),[4,Object(w.a)(b.a.UserEntitlementsRequest,"UserEntitlements",c.url,c,a,s,o,e,"OfficeHome",{})];case 3:return(u=r.sent().data)?[2,u]:[3,5];case 4:return r.sent(),[3,5];case 5:return[2,null]}}))}))}var O=n("bIL4");function T(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(o.a)(O.a,e)];case 1:return[2,t.sent()]}}))}))}function S(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){return[2,Object(m.a)((function(){return function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o,i,c,u,l;return Object(r.__generator)(this,(function(m){switch(m.label){case 0:return o={isCommercialUserPromise:s(),isConsumerUserPromise:a(),isPwaPromise:d(),isEmbedPromise:h()},[4,T(t)];case 1:return void 0!==(n=m.sent())?[3,3]:[4,C(t.correlationId,(function(){return Promise.resolve(e)}),t.inMockMode,t.officeHomeApiRoot,t.workload,t.getAccessToken,t.jwtAuthEnabled)];case 2:n=m.sent(),m.label=3;case 3:return null===n?[3,8]:[4,o.isCommercialUserPromise];case 4:return i=m.sent(),[4,o.isConsumerUserPromise];case 5:return c=m.sent(),[4,o.isPwaPromise];case 6:return u=m.sent(),[4,o.isEmbedPromise];case 7:return l=m.sent(),[2,Object(r.__assign)(Object(r.__assign)({},n),{isCommercialUser:i,isConsumerUser:c,isEmbed:l,isPwa:u,isPwaInUwp:u&&Object(f.a)(),isPwaInWebView2:u&&Object(p.a)()})];case 8:return[2,null]}}))}))}(e,t)}),(function(){return Object(g.a)({userId:e.puid,collectionName:O.c,collectionVersion:O.d,key:O.c})}),(function(t){return Object(v.a)({userId:e.puid,collectionName:O.c,collectionVersion:O.d,key:O.c,data:t})}))]}))}))}},"/5e1":"/5so":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("QjXU"),o=n("mgFK");function i(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return t.isMsa?[4,Object(o.a)("consumerInstallInfo",e)]:[2,null];case 1:return[2,n.sent()||null]}}))}))}},"/Oio":"/Qyy":"/ieh":function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,o="~";function i(){}ct.create&&(i.prototype=Object.create(null),(new i).__proto__||(o=!1)),u.prototype.eventNames=u.prototype.listeners=u.prototype.listenerCount=u.prototype.emit=u.prototype.on=function(e,t,n){return a(this,e,t,n,!1)},u.prototype.once=u.prototype.removeListener=u.prototype.removeAllListeners=u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=o,u.EventEmitter=u,e.exports=u},"/mqz":function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));var r=n("iijs"),o=n("mXGw"),i=n.n(o),s=n("1D46"),a=n("yKdX"),c=n("9qdX"),u=n("GBVN");const l=Object(c.a)({root:{mc9l5x:"f22iagw",Beiy3e4:"f1vx9l62",Bt984gj:"f122n59"}},{d:[".f22iagw{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}",".f1vx9l62{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}",".f122n59{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}"]}),d=o.forwardRef(((e,t)=>{const n=((e,t)=>({components:{root:"div"},root:Object(s.a)("div",{ref:t,...e})}))(e,t);return(e=>{const t=l();e.root.className=Object(u.a)("fai-LatencyWrapper",t.root,e.root.className)})(n),(e=>{const{slots:t,slotProps:n}=Object(a.a)(e);return o.createElement(t.root,n.root)})(n)}));d.displayName="LatencyWrapper";var h=n("vtYf");const f=Object(c.a)({root:{B6of3ja:"f1mevb6",fsow6f:"f17mccla"}},{d:[".f1mevb6{margin-top:var(--spacingVerticalM);}",".f17mccla{text-align:center;}"]});var p=n("IE6Z"),m=n("VRIK"),g=n("t5Ut"),v=n("iTb/");const b=o.forwardRef(((e,t)=>{const n={appearance:"subtle",size:"small",icon:o.createElement(v.k,null),...e},r=Object(p.a)(n,t);return Object(m.a)(r),(e=>{const t=f();e.root.className=Object(u.a)("fai-LatencyCancel",t.root,e.root.className)})(r),Object(g.a)(r)}));b.displayName="LatencyCancel";var y=n("gCUk"),w=n("5DIn"),C=n("AcOL"),O=n("QjXU"),T=n("p/uK"),S=n("sLnE"),k=n("DU/N"),E=Object(T.a)({wrapper:{alignItems:"stretch",minHeight:"40px",marginTop:"128px"},loader:Object(O.__assign)({flexGrow:1,flexDirection:"row",alignItems:"center"},S.a.padding(k.a.spacingVerticalS)),cancel:{marginTop:"0",marginLeft:"auto"},headerCommon:Object(O.__assign)(Object(O.__assign)({},S.a.margin("0")),{fontSize:k.a.fontSizeBase200,display:"flex"}),headerTitle:{marginLeft:"12px"},headerIcon:{alignSelf:"center"},esc:Object(O.__assign)(Object(O.__assign)(Object(O.__assign)(Object(O.__assign)({},S.a.border("1px","solid",k.a.colorNeutralStroke2)),S.a.borderRadius("2px")),S.a.padding(k.a.spacingHorizontalNone,k.a.spacingHorizontalXS)),{marginLeft:k.a.spacingHorizontalS})}),_=function(e){var t=e.headerTitle,n=e.cancelButtonText,s=e.stopGeneratingCallback,a=E(),c=Object(o.useMemo)((function(){return i.a.createElement("div",{className:a.headerCommon},i.a.createElement(y.a,null),i.a.createElement("span",{className:a.headerTitle},t))}),[t,a]);return Object(o.useEffect)((function(){var e=function(e){e.key===w.a.Escape&&(s(),e.preventDefault())};return window.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[s]),i.a.createElement(r.a,null,i.a.createElement(d,{className:a.wrapper},i.a.createElement(h.a,{className:a.loader,header:{children:c}},i.a.createElement(b,{className:a.cancel,onClick:s,onKeyDown:function(e){Object(C.a)(e)===w.a.Enter&&(s(),e.preventDefault())}},n," ",i.a.createElement("span",{className:a.esc},"ESC")))))}},"01JL":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));const{AugLoopTextEncoder:r,AugLoopTextDecoder:o}=(()=>{if("undefined"==typeof TextEncoder){n("0kE7");const e={AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder};return TextEncoder=void 0,TextDecoder=void 0,e}return{AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder}})()},"0711":"07F0":"0942":"0EWy":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));const r=o=,"0KRy":function(e,t,n){var r=n("LSEb")(n("s3UK"),"Map");e.exports=r},"0TX8":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("QjXU"),o=n("JYsJ");function i(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var s,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:e.params||(e.params={}),e.params.workload=n,(s=Object(o.a)("flight"))&&(e.params.flight=s),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i()];case 2:return(a=r.sent())&&(e.headers||(e.headers={}),e.headers["X-OfficeHome-UserId"]=a.puid,e.headers["X-OfficeHome-TenantId"]=a.tenantId,a.authVersion&&(e.headers["X-OfficeHome-AuthVersion"]=a.authVersion),e.params[t?"mockauth":"auth"]=a.isMsa?"1":"2"),[3,4];case 3:return r.sent(),[3,4];case 4:return[2,e]}}))}))}},"0bKW":"0kE7":function(e,t,n){(function(e,t){!function(e){"use strict";function n(e){for(var t=0,n=Math.min(65536,e.length+1),r=new Uint16Array(n),o=[],i=0;;){var s=t<e.length;if(!s||i>=n-1){var a=r.subarray(0,i);if(o.push(String.fromCharCode.apply(null,a)),!s)return o.join("");e=e.subarray(t),t=0,i=0}var c=e[t++];if(0==(128&c))r[i++]=c;else if(192==(224&c)){var u=63&e[t++];r[i++]=(31&c)<<6|u}else if(224==(240&c)){u=63&e[t++];var l=63&e[t++];r[i++]=(31&c)<<12|u<<6|l}else if(240==(248&c)){var d=(7&c)<<18|(u=63&e[t++])<<12|(l=63&e[t++])<<6|63&e[t++];d>65535&&(r[i++]=(d-=65536)>>>10&1023|55296,d=56320|1023&d),r[i++]=d}}}var r="Failed to ",o=i="function"==typeof t&&t.from,s=i?function(e){return t.from(e)}:.prototype.encode=var c=!i&&"function"==typeof Blob&&"function"==typeof URL&&"function"==typeof URL.createObjectURL,u=["utf-8","utf8","unicode-1-1-utf-8"],l=n;i?l=c&&(l=;var d="construct 'TextDecoder'",h="".concat(r," ").concat(d,": the ");.prototype.decode=e.TextEncoder=e.TextEncoder||a,e.TextDecoder=e.TextDecoder||f}("undefined"!=typeof window?window:void 0!==e?e:this)}).call(this,n("pCvA"),n("zkTx").Buffer)},"11nE":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("Zmq1"),o=new Set(["AndroidPhone","iPhone","WindowsPhone"]);function i(){var e=Object(r.a)();return o.has(e.platform.platformType)}},"15s9":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("RJ4M");function o(e){return Object(r.a)(e).lastIndexOf("live.net")>0}},"1NSz":function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n("QjXU"),o=n("ovpI"),i=n("kbrL"),s=n("Sn4U"),a=n("5DIn"),c=n("AcOL"),u=n("8Jek"),l=n.n(u),d=n("mXGw"),h=n.n(d),f={button:"DropdownMenu-module__button__2dcDo","button--default":"DropdownMenu-module__button--default__1VlBB","button--small":"DropdownMenu-module__button--small__elUU4","button--hover":"DropdownMenu-module__button--hover__1soZ4","button--open":"DropdownMenu-module__button--open__2Fx_g","menu-wrapper":"DropdownMenu-module__menu-wrapper__2zWDA",menu:"DropdownMenu-module__menu__VFRSY","menu--large":"DropdownMenu-module__menu--large__3xoSs","menu--right":"DropdownMenu-module__menu--right___y-WY","menu-content":"DropdownMenu-module__menu-content___mCP2","menu-item-wrapper":"DropdownMenu-module__menu-item-wrapper__X7xKS","menu-item-wrapper--default":"DropdownMenu-module__menu-item-wrapper--default__1q5oE","menu-item-wrapper--small":"DropdownMenu-module__menu-item-wrapper--small__3GfUE","upper-divider":"DropdownMenu-module__upper-divider__1Wp9x","menu-item":"DropdownMenu-module__menu-item__ZoBwi","menu-item-text":"DropdownMenu-module__menu-item-text__1xIHA",hidden:"DropdownMenu-module__hidden__1Co_B","menu-item-icon-wrapper":"DropdownMenu-module__menu-item-icon-wrapper__swMcC",checkbox:"DropdownMenu-module__checkbox__1F-Nd DropdownMenu-module__menu-item-icon-wrapper__swMcC","checkbox--unchecked":"DropdownMenu-module__checkbox--unchecked__20jjP DropdownMenu-module__menu-item-icon-wrapper__swMcC",radio:"DropdownMenu-module__radio__3xf-n DropdownMenu-module__menu-item-icon-wrapper__swMcC","radio--unchecked":"DropdownMenu-module__radio--unchecked__3dAyK DropdownMenu-module__menu-item-icon-wrapper__swMcC","radio-circle":"DropdownMenu-module__radio-circle__2I4YB","radio-circle--active":"DropdownMenu-module__radio-circle--active__3rYQX","menu-option-background":"DropdownMenu-module__menu-option-background__3MWJ4",checkmark:"DropdownMenu-module__checkmark__1218D",icon:"DropdownMenu-module__icon__3CHS4"},p=n("Haco"),m=new Set([a.a.ArrowDown,a.a.ArrowUp,a.a.End,a.a.Enter,a.a.Escape,a.a.Home,a.a.Tab]),g=Object(d.forwardRef)((function(e,t){var n,u,g,v,b=e.buttonContent,y=e.items,w=e.dropdownMenuContent,C=e.options,O=e.menuItemType,T=e.onKeySelected,S=e.onDropdownOpened,k=e.onDropdownClosed,E=e.defaultSelected,_=e.stopButtonEventPropagation,j=e.checkedItemClassName,I=e.buttonTitle,N=e.buttonAriaLabel,A=e.disableFocus,P=e.ariaDescribedby,x=O,D=Object(r.__read)(Object(d.useState)(!1),2),L=D[0],M=D[1],R=L),F=Object(r.__read)(Object(d.useState)("string"==typeof E?[E]:E||[""]),2),B=F[0],U=F[1],W=Object(d.useRef)(null),q=Object(d.useRef)([]),H=Object(d.useRef)(null);Object(d.useEffect)((function(){var e=function(e){W.current&&e.target instanceof Node&&W.current.contains(e.target)||M(!1)};return document.addEventListener("click",e),function(){document.removeEventListener("click",e)}}),[]),Object(d.useEffect)((function(){var e=function(e){var t;W.current&&e.target instanceof Node&&W.current.contains(e.target)&&e.key===a.a.Escape&&(M(!1),null===(t=H.current)||void 0===t||t.focus())};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[]),Object(d.useEffect)((function(){var e,t;L?(S&&S(),null===(e=q.current[0])||void 0===e||e.focus()):k&&R&&(k(),null===(t=H.current)||void 0===t||t.focus())}),[S,k,L,R]),Object(d.useEffect)((function(){E&&"string"==typeof E&&U([E]),E&&"string"!=typeof E&&U(E)}),[E]);var z=Object(d.useCallback)((function(e){if(L){var t=q.current.length;q.current.some((function(n,r){var o;return!(!n||n!==document.activeElement||(null===(o=q.current[(r+e+t)%t])||void 0===o||o.focus(),0))}))}}),[L]),G=C||{},V=null!==(v=G.menuSize)&&void 0!==v?v:p.a.Default,$=Object(d.useCallback)((function(e,t){var n=B.indexOf(e.key)>=0;if(T&&T(e.key,t,!n),!G.multiSelect)return U([e.key]),void M(!1);U(n?B.filter(():B.concat(e.key))}),[T,G.multiSelect,B]),Q=Object(d.useCallback)((function(e,n){var r,o,i,s,u=Object(c.a)(e);if(m.has(u))switch(e.preventDefault(),u){case a.a.Enter:$(n,e);break;case a.a.Escape:M(!1),"function"!=typeof t&&(null===(r=null==t?void 0:t.current)||void 0===r||r.focus()),null===(o=H.current)||void 0===o||o.focus(),_&&e.stopPropagation();break;case a.a.ArrowUp:z(-1);break;case a.a.ArrowDown:z(1);break;case a.a.End:null===(i=q.current[q.current.length-1])||void 0===i||i.focus();break;case a.a.Home:null===(s=q.current[0])||void 0===s||s.focus();break;case a.a.Tab:z(e.shiftKey?-1:1)}}),[$,z,t,_]);return h.a.createElement("div",{ref:W,className:l()(f["menu-wrapper"],(n={},n[f["menu-wrapper--default"]]=V!==p.a.Small,n))},h.a.createElement("button",{ref:null!=t?t:H,className:l()(f.button,(u={},u[f["button--default"]]=V!==p.a.Small,u[f["button--small"]]=V===p.a.Small,u[f["button--hover"]]=!G.disableHoverColor,u)),onClick:function(e){e.preventDefault(),_&&e.stopPropagation(),M(!L)},onKeyDown:function(e){var t=Object(c.a)(e);t!==a.a.Enter&&t!==a.a.Space&&t!==a.a.Escape||(e.preventDefault(),_&&e.stopPropagation(),M(t!==a.a.Escape&&!L))},title:I||"","aria-label":N||"","aria-expanded":L,"data-clicklog":"custom",tabIndex:A?-1:0,"aria-describedby":P},b),h.a.createElement("div",{className:l()(f.menu,(g={},g[f.hidden]=!L,g[f["menu--right"]]=!G.leftAligned,g[f["menu--large"]]=V===p.a.Large,g))},w||h.a.createElement("ul",{className:l()(f["menu-content"]),role:x===i.a.Radio?"radiogroup":"menu"},y&&y.map((function(e,t){var n,r,a,c;return h.a.createElement("li",{onClick:onKeyDown:function(t){return Q(t,e)},key:e.key,className:l()(f["menu-item-wrapper"],(n={},n[f["menu-item-wrapper--default"]]=V!==p.a.Small,n[f["menu-item-wrapper--small"]]=V===p.a.Small,n[f["upper-divider"]]=e.hasUpperDivider,n)),ref:tabIndex:-1,role:x===i.a.Radio?"radio":O===i.a.Checkbox?"menuitemcheckbox":"menuitem","aria-checked":x===i.a.Radio||x===i.a.Checkbox?B.indexOf(e.key)>-1&&!j:void 0,"aria-label":e.ariaLabel},h.a.createElement("div",{className:l()(f["menu-item"]),title:e.title},x===i.a.Radio&&h.a.createElement("span",{className:l()(f.radio,(r={},r[f["radio--unchecked"]]=B.indexOf(e.key)<=-1,r["".concat(j)]=B.indexOf(e.key)>-1&&j,r[f["menu-option-background"]]=B.indexOf(e.key)>-1&&!j,r))},h.a.createElement("span",{className:l()(f["radio-circle"],(a={},a[f["radio-circle--active"]]=B.indexOf(e.key)>-1&&!j,a))})),x===i.a.Checkbox&&h.a.createElement("span",{className:l()(f.checkbox,(c={},c[f["checkbox--unchecked"]]=B.indexOf(e.key)<=-1,c["".concat(j)]=B.indexOf(e.key)>-1&&j,c[f["menu-option-background"]]=B.indexOf(e.key)>-1,c))},h.a.createElement(o.a,{className:f.checkmark,iconName:s.a.CheckMark})),e.iconElement?h.a.createElement("div",{className:l()(f.icon)},e.iconElement):null,h.a.createElement("div",{className:l()(f["menu-item-text"])},e.content)))})))))}))},"1aUa":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=,"1blO":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("QjXU"),o=n("fv+d"),i=n("RtYo"),s=n("qyk8"),a=function(e,t,n,a,c,u){var l=e.officeActionCreator(n,c,u);if(l)return function(e,t,n,r,o,s){var a;return{ariaLabel:n,contentActionOptions:{badgeText:e.metadata.badgeText,groupId:e.metadata.groupId,icon:(null===(a=e.metadata.icon)||void 0===a?void 0:a.type)==i.a.Brand&&null!=r?{type:e.metadata.icon.type,fileType:r}:e.metadata.icon},executeAction:t,id:"".concat(e.metadata.appId,"_").concat(e.metadata.id),title:n,disabled:o,tooltipString:s}}(e,(function(n,o){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,t.executeActionAsync(l,Object(r.__assign)(Object(r.__assign)({},a),{actionId:e.metadata.id,appId:e.metadata.appId,sourceUXComponent:o||a.sourceUXComponent,referral:l.payload.referral||void 0,referralPlatform:l.payload.referralPlatform||void 0}))];case 1:return n.sent(),[2]}}))}))}),e.metadata.id==o.b.OpenInApp?Object(s.a)(e.metadata.name,n.app):e.metadata.name,n.fileType,l.payload.disabled,l.payload.tooltipString)},c=function(e,t,n,o,i,s){var c,u,l=[];try{for(var d=Object(r.__values)(e),h=d.next();!h.done;h=d.next()){var f=a(h.value,t,n,o,i,s);f&&l.push(f)}}catch(e){c={error:e}}finally{try{h&&!h.done&&(u=d.return)&&u.call(d)}finally{if(c)throw c.error}}return l}},"1ezk":"25GD":function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return y})),n.d(t,"e",(function(){return C})),n.d(t,"d",(function(){return O}));var r=n("pkel"),o=n("eQkK"),i=n("rUkc"),s=n("Ez9J"),a=n("hPT0"),c=n("Fpy5");function u(e){const t=e.get("www-authenticate");if(!t)return;let n,r=!1;return t.split(",").map((e=>{const t=e.split("=");t.length>=2&&(r||"error"!==t[0].trim().toLowerCase()?n||"claims"!==t[0].trim().toLowerCase()||(n=Object(c.a)(JSON.parse(e.substring(e.indexOf("=")+1).trim()))):r="insufficient_claims"===JSON.parse(t[1].trim().toLowerCase()))})),r?n:void 0}const l="Bearer";function d(e){const t=e.get("www-authenticate");if(!t)return;const n=t.indexOf(l);if(n<0)return;let r;return t.substring(n+l.length).split(",").map((e=>{if(!r){const t=e.split("=");t.length>=2&&"realm"===t[0].trim().toLowerCase()&&(r=JSON.parse(t[1].trim()))}})),r}const h="2.0.0-internal.1.4.6",f=712,p="serviceReadOnly";function m(e){const t={sprequestduration:o.e.numberFromString(e.get("sprequestduration")),contentsize:o.e.numberFromString(e.get("content-length"))};[{headerName:"sprequestguid",logName:"sprequestguid"},{headerName:"request-id",logName:"requestId"},{headerName:"client-request-id",logName:"clientRequestId"},{headerName:"x-msedge-ref",logName:"xMsedgeRef"},{headerName:"X-Fluid-Retries",logName:"serverRetries"},{headerName:"content-encoding",logName:"contentEncoding"},{headerName:"content-type",logName:"contentType"}].forEach((n=>{const r=e.get(n.headerName);null!=r&&(t[n.logName]=r)}));const n=e.get("x-fluid-telemetry");if(null!=n){t.xFluidTelemetry=n;const e=n.split(",").map((e=>e.split("=")));for(const[n,r]of e)if("Origin"===n.trim()){let e;switch(null==r?void 0:r.trim()){case"c":e="cache";break;case"g":e="graph";break;default:e=null==r?void 0:r.trim()}t.responseOrigin=e;break}}return t}class g extends i.a{constructor(e,t,n){super(e,n,new Set(["redirectLocation"])),this.redirectLocation=t,this.errorType=r.a.fileNotFoundOrAccessDeniedError,this.canRetry=!1}}function v(e){try{if(void 0!==e){const t=JSON.parse(e);if(function(e){const t=null==e?void 0:e.error;return"string"==typeof(null==t?void 0:t.message)&&(void 0===(null==t?void 0:t.code)||"string"==typeof(null==t?void 0:t.code))}(t))return{success:!0,errorResponse:t}}}catch(e){}return{success:!1}}function b(e){const t=[];let n=e.error;for(;"object"==typeof n&&null!==n;)void 0!==n.code&&t.unshift(n.code),n=n.innerError;return t}function y(e,t,n,o,i){let c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};var l;let m;const y=v(i);let C,O,T;if(y.success){const e=y.errorResponse;c.responseMessage=e.error.message,C=b(e),void 0!==C&&(O=C[0],c.innerMostErrorCode=O)}const S=Object.assign({driverVersion:h,statusCode:t},c);switch(t){case 400:m=new s.e(e,r.a.genericNetworkError,S);break;case 401:case 403:if(O===p)m=new s.g(e,a.a.serviceReadOnly,S);else{const t=(null==o?void 0:o.headers)?u(o.headers):void 0,n=(null==o?void 0:o.headers)?d(o.headers):void 0;m=new s.a(e,t,n,S)}break;case 404:if(y.success){const t=null===(l=null==y?void 0:y.errorResponse)||void 0===l?void 0:l.error;if(T=null==t?void 0:t["@error.redirectLocation"],void 0!==T){m=new g(e,T,S);break}}m=new s.e(e,r.a.fileNotFoundOrAccessDeniedError,S);break;case 406:m=new s.e(e,r.a.unsupportedClientProtocolVersion,S);break;case 410:m=new s.e(e,a.a.cannotCatchUp,S);break;case 409:m=new s.e(e,r.a.fileOverwrittenInStorage,S);break;case 412:m=new s.e(e,r.a.genericNetworkError,S);break;case 413:m=new s.e(e,a.a.snapshotTooBig,S);break;case 414:m=new s.e(e,a.a.invalidFileNameError,S);break;case 500:m=new s.g(e,r.a.genericNetworkError,S);break;case 501:m=new s.e(e,a.a.fluidNotEnabled,S);break;case 507:m=new s.e(e,a.a.outOfStorageError,S);break;case f:m=new s.e(e,r.a.incorrectServerResponse,S);break;default:const t=void 0!==n?1e3*n:void 0;m=Object(s.j)(e,{canRetry:!0,retryAfterMs:t},S)}return w(m,o,C,void 0),m}function w(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var o;if(e.online=s.f[Object(s.l)()],void 0!==n&&(e.facetCodes=n),t&&(r.responseType=t.type,t.headers)){const n=m(t.headers);for(const e of Object.keys(n))r[e]=n[e];e.serverEpoch=null!==(o=t.headers.get("x-fluid-epoch"))&&void 0!==o?o:void 0}return e.addTelemetryProperties(r),e}function C(e,t,n,r,o){const i=y(e,t,function(e){if(null===e)return;const t=Number(e);return Number.isNaN(t)?void 0:t}(n.headers.get("retry-after")),n,r,o);throw i.addTelemetryProperties({odspError:!0,storageServiceError:!0}),i},"28zg":function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n("QjXU"),o=n("MJsD"),i=n("B5kz"),s=n("gCKw"),a=n("mJgL"),c=n("W7wX"),u=n("s1V1"),l=n("ohjr"),d=n("8VPm");function h(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,i.a.fetchQuery([e.key],(function(){var t={featureGatesPromise:Object(s.a)(),featureSettingsPromise:Object(a.a)(),userEntitlementsPromise:Object(u.a)(),contextPromise:Object(o.a)(),identityPromise:Object(c.a)()};return Object(l.a)(t,e)}),d.a)];case 1:return[2,t.sent()]}}))}))}},"2AbI":function(e,t,n){var r=n("6TGQ"),o=n("tb+2"),i=n("h0av");e.exports=function(e){return r(e,i,o)}},"2KG9":"2UBZ":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return r}));var r,o=["harmony","harmonyLegacy","Office"];!function(e){e.App="App",e.Harmony="Harmony",e.Shell="Shell"}(r||(r={}))},"2X5l":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("mXGw"),o=n.n(r),i={OutlookSvgIcon:function(e){return o.a.createElement("svg",{width:e.width,height:e.height,viewBox:e.viewBox,className:e.className,fill:e.fill,xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"},o.a.createElement("path",{d:"M17.8 9.52L11.5 5.92H11.41C11.3005 5.8427 11.1732 5.79453 11.04 5.78C10.9047 5.77891 10.7711 5.80974 10.65 5.87H10.56L4.25998 9.47C4.20058 9.50425 4.15156 9.55394 4.11811 9.6138C4.08466 9.67366 4.06803 9.74145 4.06998 9.81C4.06975 9.87571 4.08613 9.94042 4.1176 9.99811C4.14906 10.0558 4.1946 10.1046 4.24998 10.14L11.04 15L17.85 10.19C17.9066 10.1551 17.9536 10.1067 17.9868 10.0491C18.0199 9.99144 18.0382 9.92646 18.04 9.86C18.0362 9.78644 18.0116 9.71548 17.9691 9.65531C17.9266 9.59514 17.868 9.54822 17.8 9.52Z",fill:"#0A2767"}),o.a.createElement("path",{d:"M16.04 2H6.04004C5.77482 2 5.52047 2.10536 5.33293 2.29289C5.1454 2.48043 5.04004 2.73478 5.04004 3L11.04 5L17.04 3C17.04 2.73478 16.9347 2.48043 16.7471 2.29289C16.5596 2.10536 16.3053 2 16.04 2Z",fill:"#0364B8"}),o.a.createElement("path",{d:"M11 3H5V9L10.99 15.01H16.99V8.99L11 3Z",fill:"#28A8EA"}),o.a.createElement("path",{d:"M17 3H11V9H17V3Z",fill:"#50D9FF"}),o.a.createElement("path",{d:"M10.99 15.01L5 15V9H11L10.99 15.01Z",fill:"#0078D4"}),o.a.createElement("path",{opacity:"0.5",d:"M11.04 15L4.20996 10.17L4.71996 9.29L11.04 12.87L17.32 9.28L17.81 10.19L11.04 15Z",fill:"#0A2767"}),o.a.createElement("path",{d:"M17.81 10.19L11.5 13.78C11.3595 13.8697 11.1967 13.9183 11.03 13.92H10.97C10.887 13.9304 10.803 13.9304 10.72 13.92L13.04 17L17.68 17.83C17.7915 17.7483 17.8823 17.6414 17.9448 17.518C18.0074 17.3947 18.04 17.2583 18.04 17.12V9.85999C18.0342 9.9304 18.0099 9.99804 17.9695 10.056C17.9291 10.114 17.874 10.1602 17.81 10.19Z",fill:"#1490DF"}),o.a.createElement("path",{opacity:"0.1",d:"M12.04 13.48L11.5 13.79C11.3595 13.8798 11.1967 13.9283 11.03 13.93H10.97C10.887 13.9405 10.803 13.9405 10.72 13.93L13.04 17L17.68 17.83C17.7915 17.7483 17.8823 17.6414 17.9448 17.518C18.0074 17.3947 18.04 17.2583 18.04 17.12V16.85L12.04 13.48Z",fill:"black"}),o.a.createElement("path",{d:"M4.17995 10.19C4.13193 10.1502 4.09415 10.0994 4.06979 10.042C4.04543 9.9846 4.0352 9.92218 4.03995 9.85999V17.13C4.04 17.3099 4.0958 17.4853 4.19967 17.6321C4.30354 17.779 4.45037 17.89 4.61995 17.95C4.71602 17.9651 4.81388 17.9651 4.90995 17.95H17.12C17.3026 17.9522 17.4813 17.8961 17.63 17.79L4.17995 10.19Z",fill:"#28A8EA"}),o.a.createElement("path",{opacity:"0.5",d:"M11.04 16C11.5705 16 12.0792 15.7893 12.4543 15.4142C12.8293 15.0391 13.04 14.5304 13.04 14V7C13.04 6.73478 12.9347 6.48043 12.7471 6.29289C12.5596 6.10536 12.3053 6 12.04 6H5.04004V9.07L4.25004 9.52C4.19344 9.55488 4.14643 9.60332 4.11325 9.66094C4.08008 9.71856 4.06179 9.78354 4.06004 9.85H4.04004V15.99L11.04 16Z",fill:"black"}),o.a.createElement("path",{d:"M11 5H3C2.44772 5 2 5.44772 2 6V14C2 14.5523 2.44772 15 3 15H11C11.5523 15 12 14.5523 12 14V6C12 5.44772 11.5523 5 11 5Z",fill:"#0078D4"}),o.a.createElement("path",{d:"M4.20009 8.36999C4.4433 7.87674 4.83032 7.46881 5.31009 7.19999C5.84108 6.91364 6.43691 6.76899 7.04009 6.77999C7.6126 6.7651 8.17872 6.90318 8.68009 7.17999C9.1589 7.42919 9.55238 7.81571 9.81009 8.28999C10.0679 8.79774 10.1983 9.36059 10.1901 9.92999C10.2022 10.5265 10.0684 11.117 9.80009 11.65C9.54295 12.1263 9.15414 12.5186 8.68009 12.78C8.15853 13.0617 7.57271 13.203 6.98009 13.19C6.39396 13.2018 5.8149 13.0605 5.30009 12.78C4.83481 12.5183 4.45336 12.1299 4.20009 11.66C3.94353 11.1589 3.81309 10.6029 3.82009 10.04C3.8144 9.46126 3.94456 8.88927 4.20009 8.36999ZM5.39009 11.1C5.51592 11.4124 5.73171 11.6804 6.01009 11.87C6.30578 12.066 6.65563 12.1639 7.01009 12.15C7.36504 12.1564 7.71364 12.0553 8.01009 11.86C8.28645 11.6707 8.4991 11.4023 8.62009 11.09C8.7527 10.7492 8.81725 10.3856 8.81009 10.02C8.8138 9.65222 8.75288 9.28667 8.63009 8.93999C8.51851 8.61009 8.30358 8.32493 8.01718 8.12679C7.73078 7.92865 7.38815 7.82808 7.04009 7.83999C6.68611 7.82999 6.33742 7.92763 6.04009 8.11999C5.75823 8.31096 5.53631 8.57796 5.40009 8.88999C5.24769 9.23983 5.17265 9.61846 5.18009 9.99999C5.16838 10.3776 5.24008 10.7532 5.39009 11.1Z",fill:"white"}))},ParkSvgIcon:function(e){return o.a.createElement("svg",{width:e.width,height:e.height,viewBox:e.viewBox,className:e.className,fill:e.fill,xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"},o.a.createElement("path",{d:"M2 4.5C2 3.11929 3.11929 2 4.5 2H11.5C12.8807 2 14 3.11929 14 4.5V6.25716C13.6929 6.00353 13.3578 5.78261 13 5.59971V4.5C13 3.67157 12.3284 3 11.5 3H4.5C3.67157 3 3 3.67157 3 4.5V11.5C3 12.3284 3.67157 13 4.5 13H5.59971C5.78261 13.3578 6.00353 13.6929 6.25716 14H4.5C3.11929 14 2 12.8807 2 11.5V4.5ZM10.5 15C8.01472 15 6 12.9853 6 10.5C6 8.01472 8.01472 6 10.5 6C12.9853 6 15 8.01472 15 10.5C15 12.9853 12.9853 15 10.5 15ZM11.3964 8.60355L12.2929 9.5H10.75C9.23122 9.5 8 10.7312 8 12.25V12.5C8 12.7761 8.22386 13 8.5 13C8.77614 13 9 12.7761 9 12.5V12.25C9 11.2835 9.7835 10.5 10.75 10.5H12.2929L11.3964 11.3964C11.2012 11.5917 11.2012 11.9083 11.3964 12.1036C11.5917 12.2988 11.9083 12.2988 12.1036 12.1036L13.8557 10.3514C13.9026 10.304 13.938 10.2495 13.9621 10.1914C13.9865 10.1324 14 10.0678 14 10C14 9.93221 13.9865 9.86756 13.9621 9.80861C13.9377 9.74964 13.9015 9.69439 13.8536 9.64645L12.1036 7.89645C11.9083 7.70118 11.5917 7.70118 11.3964 7.89645C11.2012 8.09171 11.2012 8.40829 11.3964 8.60355Z",fill:"#212121"}))},PdfWorksSvgIcon:function(e){return o.a.createElement("svg",{width:e.width,height:e.height,viewBox:e.viewBox,className:e.className,fill:e.fill,xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"},o.a.createElement("path",{d:"M0 4C0 1.79086 1.79086 0 4 0H16C18.2091 0 20 1.79086 20 4V16C20 18.2091 18.2091 20 16 20H4C1.79086 20 0 18.2091 0 16V4Z",fill:"#FFBA2E"}),o.a.createElement("path",{d:"M6.49976 11.003C6.22361 11.003 5.99976 11.2268 5.99976 11.503V13.503C5.99976 13.7791 6.22361 14.003 6.49976 14.003C6.7759 14.003 6.99976 13.7791 6.99976 13.503V13.3366H7.33296C7.97736 13.3366 8.49976 12.8142 8.49976 12.1698C8.49976 11.5254 7.97736 11.003 7.33296 11.003H6.49976ZM7.33296 12.3366H6.99976V12.003H7.33296C7.42508 12.003 7.49976 12.0777 7.49976 12.1698C7.49976 12.2619 7.42508 12.3366 7.33296 12.3366ZM12.0005 11.5024C12.0008 11.2265 12.2246 11.003 12.5005 11.003H13.4988C13.7749 11.003 13.9988 11.2268 13.9988 11.503C13.9988 11.7791 13.7749 12.003 13.4988 12.003H12.9998L12.9994 12.3375H13.4988C13.7749 12.3375 13.9988 12.5613 13.9988 12.8375C13.9988 13.1136 13.7749 13.3375 13.4988 13.3375H13L13.0005 13.5017C13.0012 13.7779 12.7779 14.0023 12.5017 14.003C12.2256 14.0037 12.0012 13.7804 12.0005 13.5043L11.9988 12.8368L12.0005 11.5024ZM9.49829 11.003C9.22215 11.003 8.99829 11.2268 8.99829 11.503V13.503C8.99829 13.7791 9.22215 14.003 9.49829 14.003H9.99974C10.8282 14.003 11.4997 13.3314 11.4997 12.503C11.4997 11.6746 10.8282 11.003 9.99974 11.003H9.49829ZM9.99829 13.003V12.003H9.99974C10.2759 12.003 10.4997 12.2269 10.4997 12.503C10.4997 12.7791 10.2759 13.003 9.99974 13.003H9.99829ZM11 4.00195H6.5C5.67157 4.00195 5 4.67353 5 5.50195V9.08413C4.4174 9.29005 4 9.84567 4 10.4988V14.502C4 15.3304 4.67157 16.002 5.5 16.002H14.5C15.3284 16.002 16 15.3304 16 14.502V10.4988C16 9.84567 15.5826 9.29005 15 9.08413V7.99994H12.5C11.6716 7.99994 11 7.32837 11 6.49994V4.00195ZM5.5 9.99878H14.5C14.7761 9.99878 15 10.2226 15 10.4988V14.502C15 14.7781 14.7761 15.002 14.5 15.002H5.5C5.22386 15.002 5 14.7781 5 14.502V10.4988C5 10.2226 5.22386 9.99878 5.5 9.99878ZM14.7056 6.99994H12.5C12.2239 6.99994 12 6.77608 12 6.49994V4.29746L14.7056 6.99994Z",fill:"#792000"}))},TeamsSvgIcon:function(e){return o.a.createElement("svg",{width:e.width,height:e.height,viewBox:e.viewBox,className:e.className,fill:e.fill,xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"},o.a.createElement("path",{d:"M17.08 8H14.18L12.47 8.82V12.89C12.5121 13.5868 12.8186 14.2412 13.3269 14.7197C13.8352 15.1981 14.5069 15.4645 15.205 15.4645C15.903 15.4645 16.5748 15.1981 17.083 14.7197C17.5913 14.2412 17.8978 13.5868 17.94 12.89V8.82C17.9401 8.70887 17.9176 8.59886 17.874 8.49668C17.8303 8.39449 17.7663 8.30225 17.6858 8.22556C17.6054 8.14887 17.5102 8.08933 17.4061 8.05055C17.3019 8.01178 17.191 7.99458 17.08 8Z",fill:"#5059C9"}),o.a.createElement("path",{d:"M16 7C17.1046 7 18 6.10457 18 5C18 3.89543 17.1046 3 16 3C14.8954 3 14 3.89543 14 5C14 6.10457 14.8954 7 16 7Z",fill:"#5059C9"}),o.a.createElement("path",{d:"M6.82 8H14.18C14.3975 8 14.606 8.08639 14.7598 8.24017C14.9136 8.39395 15 8.60252 15 8.82V13.5C15 14.6935 14.5259 15.8381 13.682 16.682C12.8381 17.5259 11.6935 18 10.5 18C9.30653 18 8.16193 17.5259 7.31802 16.682C6.47411 15.8381 6 14.6935 6 13.5V8.82C6 8.60252 6.08639 8.39395 6.24017 8.24017C6.39395 8.08639 6.60252 8 6.82 8Z",fill:"#7B83EB"}),o.a.createElement("path",{d:"M11 8C12.6569 8 14 6.65685 14 5C14 3.34315 12.6569 2 11 2C9.34315 2 8 3.34315 8 5C8 6.65685 9.34315 8 11 8Z",fill:"#7B83EB"}),o.a.createElement("path",{opacity:"0.5",d:"M6.00003 8.82V13.5C5.99696 14.3892 6.25799 15.2593 6.75003 16H10.97C11.5005 16 12.0092 15.7893 12.3842 15.4142C12.7593 15.0391 12.97 14.5304 12.97 14V8H6.75003C6.5449 8.01757 6.35389 8.11166 6.21494 8.26358C6.07599 8.4155 5.99928 8.61412 6.00003 8.82Z",fill:"black"}),o.a.createElement("path",{opacity:"0.5",d:"M11.9699 6H8.16992C8.3332 6.46135 8.60686 6.87575 8.96704 7.20706C9.32722 7.53837 9.76299 7.77654 10.2363 7.9008C10.7097 8.02505 11.2062 8.03162 11.6827 7.91993C12.1592 7.80823 12.6011 7.58167 12.9699 7.26V7C12.9699 6.73478 12.8646 6.48043 12.677 6.29289C12.4895 6.10536 12.2351 6 11.9699 6Z",fill:"black"}),o.a.createElement("path",{opacity:"0.1",d:"M6.00003 8.82V13.5C5.99696 14.3892 6.25799 15.2593 6.75003 16H10.97C11.5005 16 12.0092 15.7893 12.3842 15.4142C12.7593 15.0391 12.97 14.5304 12.97 14V8H6.75003C6.5449 8.01757 6.35389 8.11166 6.21494 8.26358C6.07599 8.4155 5.99928 8.61412 6.00003 8.82Z",fill:"black"}),o.a.createElement("path",{opacity:"0.1",d:"M11.9699 6H8.16992C8.3332 6.46135 8.60686 6.87575 8.96704 7.20706C9.32722 7.53837 9.76299 7.77654 10.2363 7.9008C10.7097 8.02505 11.2062 8.03162 11.6827 7.91993C12.1592 7.80823 12.6011 7.58167 12.9699 7.26V7C12.9699 6.73478 12.8646 6.48043 12.677 6.29289C12.4895 6.10536 12.2351 6 11.9699 6Z",fill:"black"}),o.a.createElement("path",{d:"M11 5H3C2.44772 5 2 5.44772 2 6V14C2 14.5523 2.44772 15 3 15H11C11.5523 15 12 14.5523 12 14V6C12 5.44772 11.5523 5 11 5Z",fill:"#4B53BC"}),o.a.createElement("path",{d:"M10 8H8V13H7V8H5V7H10V8Z",fill:"white"}))},ToDoSvgIcon:function(e){return o.a.createElement("svg",{width:e.width,height:e.height,viewBox:e.viewBox,className:e.className,fill:e.fill,xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"},o.a.createElement("path",{d:"M3.36709 6.98102L1.32278 9.02532C0.892405 9.4557 0.892405 10.1013 1.32278 10.5317L4.98101 14.0823L8.53165 10.5317L4.98101 6.98102C4.55063 6.55064 3.79747 6.55064 3.36709 6.98102Z",fill:"#185ABD"}),o.a.createElement("path",{d:"M17.6772 5.47468L15.6329 3.32278C15.2025 2.89241 14.5569 2.89241 14.1266 3.32278L11.3291 6.12025L7.77846 9.77848L4.98099 12.576C4.55061 13.0063 4.55061 13.6519 4.98099 14.0823L7.02529 16.1266C7.45567 16.557 8.10124 16.557 8.53162 16.1266L11.3291 13.3291L14.8797 9.77848L17.6772 6.98101C18.1076 6.55063 18.1076 5.79747 17.6772 5.47468Z",fill:"url(#paint0_linear)"}),o.a.createElement("defs",null,o.a.createElement("linearGradient",{id:"paint0_linear",x1:"11.098",y1:"-0.731524",x2:"0.925508",y2:"9.81288",gradientUnits:"userSpaceOnUse"},o.a.createElement("stop",{stopColor:"#62C4F6"}),o.a.createElement("stop",{offset:"1",stopColor:"#2A88E5"}))))}}},"2rXV":"2wRU":"2y7E":function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l}));var r=n("QjXU"),o=n("a3FV"),i=n("ORuF"),s=n("Cd0O"),a=n("CMIS"),c=n("c/bn");function u(e,t,s,u,f){void 0===u&&(u="office-start-resources");var p=null==t?void 0:t.toLowerCase(),m=p&&i,g=function(e){return void 0===e&&(e="office-start-resources"),Object(r.__awaiter)(this,void 0,void 0,(function(){var t,o,i,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:o=0,i=3,r.label=1;case 1:if(!(o<i))return[3,6];r.label=2;case 2:return r.trys.push([2,4,,5]),o++,[4,n("i8/d")("./".concat(e,".json"))];case 3:return[2,r.sent().default];case 4:return s=r.sent(),o>=i&&(t="Failed to import ".concat(e," after ").concat(i," attempts.\n\nError: ").concat(s)),[3,5];case 5:return[3,1];case 6:throw Object(a.a)({eventName:"GetDefaultResources_Error",errorType:"LocStrings_Error",message:t}),new Error(t)}}))}))}(u).then((function(e){var t,n;return(null===(n=null===(t=null==f?void 0:f.result)||void 0===t?void 0:t.m365StringLogoGates)||void 0===n?void 0:n.m365StringLogoEnabled)?d(e):e}));if(!m)return Promise.resolve(g);if("en"===(p=function(e,t){if(e=l(e),i[h(t,e)])return e;var n=Object(r.__read)(e.split("-"),1)[0];return i[h(t,n)]?n:"default"}(p,u))||"default"===p)return Promise.resolve(g);var v={method:"GET",responseType:"json",url:"https://".concat(e,"/").concat(s,"/").concat(i[h(u,p)])};return Object(c.a)(o.a.ResourceStringsFetch,"Resource_Strings_Fetch",v).then((function(e){var t,n,r=e.data;return(null===(n=null===(t=null==f?void 0:f.result)||void 0===t?void 0:t.m365StringLogoGates)||void 0===n?void 0:n.m365StringLogoEnabled)?Promise.resolve(d(r)):r})).catch((function(){return Promise.resolve(g)}))}function l(e){return s&&s[e]&&(e=s[e]),e}function d(e){var t={},n=function(n){if(e.hasOwnProperty(n)){var o=e[n],i=Object(r.__assign)({},o);Object.keys(o).filter(().forEach((),t[n]=i}};for(var o in e)n(o);return t},"3+PR":function(e,t,n){"use strict";function r(e){try{var t;return null===(t=window.top.fluidDevOverrides)||void 0===t?void 0:t[e]}catch(e){return}}n.d(t,"a",(function(){return r}))},"3+RV":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("QjXU"),o=n("NrNW"),i=n("lUkk"),s=n("5eS3"),a=n("mXGw"),c=n("XlCq"),u=n("vaZn"),l=function(){var e=Object(u.a)(),t=Object(o.a)().data,n=Object(a.useMemo)((function(){var e=c.b;return t&&(e=t.loginHint?Object(s.a)(c.b,"".concat(c.a,"=").concat(t.loginHint)):c.b),e}),[t]),l=Object(a.useCallback)((function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return Object(i.a)({type:"Click",id:"StorageErrorManageStorage",area:"Other",subArea:"Other",result:"Navigate",target:"Other",eventName:"StorageError_ManageStorage"}),[2]}))}))}),[]);return Object(a.useMemo)((function(){if(e)return{link:n,caption:e.manageStorageText,description:e.manageStorageText,onClick:l}}),[l,n,e])}},"316b":"3MpG":function(e,t,n){"use strict";n.d(t,"j",(function(){return v})),n.d(t,"h",(function(){return b})),n.d(t,"i",(function(){return y})),n.d(t,"f",(function(){return w})),n.d(t,"e",(function(){return C})),n.d(t,"d",(function(){return O})),n.d(t,"g",(function(){return T})),n.d(t,"c",(function(){return S})),n.d(t,"l",(function(){return k})),n.d(t,"b",(function(){return E})),n.d(t,"k",(function(){return _})),n.d(t,"a",(function(){return j}));var r=n("pkel"),o=n("Ez9J"),i=n("C/Hs"),s=n("3tC7"),a=n("eQkK"),c=n("rUkc"),u=n("25GD"),l=n("hPT0");const d=e=>null===e||"string"==typeof e?e:void 0===e?null:e.token,h=e=>null===e||"string"==typeof e?void 0:e.fromCache;var f=n("Z4SR"),p=n("43aC"),m=n.n(p),g=n("AtPS");const v="getWithRetryForTokenRefreshRepeat",b=async function y(e){return e({refresh:!1}).catch((async t=>{const n={refresh:!0,previousError:t};switch(t.errorType){case r.a.authorizationError:return e(Object.assign(Object.assign({},n),{claims:t.claims,tenantId:t.tenantId}));case r.a.incorrectServerResponse:case l.a.fetchTokenError:return e(n);default:if(!0===t[v])return e(n);throw t}}))}async function w(e,t){const n=i.a.now();return(async(e,t)=>m()(e,t))(e,t).then((async e=>{const t=e;if(!t)throw new o.e("No response from ODSP fetch call",r.a.incorrectServerResponse,{driverVersion:g.a});(!t.ok||t.status<200||t.status>=300)&&Object(u.e)(`ODSP fetch error [${t.status}]`,t.status,t,await t.text());const s=function(e){const t=new Map;for(const[n,r]of e.entries())t.set(n,r);return t}(t.headers);return{content:t,headers:s,propsToLog:Object(u.c)(s),duration:i.a.now()-n}}),(e=>{const t=Object(o.l)(),n=`${e}`,i=n.replace(/((http|https):\/\/(\S*))/i,"REDACTED_URL");if("AbortError"===e.name)throw new o.g("Fetch Timeout (AbortError)",l.a.fetchTimeout,{driverVersion:g.a});if(n.includes("ETIMEDOUT"))throw new o.g("Fetch Timeout (ETIMEDOUT)",l.a.fetchTimeout,{driverVersion:g.a});throw t===o.f.Offline?new o.g(`ODSP fetch failure (Offline): ${i}`,r.a.offlineError,{driverVersion:g.a,rawErrorMessage:{value:n,tag:a.d.UserData}}):new o.g(`ODSP fetch failure: ${i}`,r.a.fetchFailure,{driverVersion:g.a,rawErrorMessage:{value:n,tag:a.d.UserData}})}))}async function C(e,t){const{content:n,headers:r,propsToLog:o,duration:i}=await w(e,t),s=await n.arrayBuffer();return o.bodySize=s.byteLength,{headers:r,content:s,propsToLog:o,duration:i}}async function O(e,t){const{content:n,headers:r,propsToLog:o,duration:i}=await w(e,t);let s;try{s=await n.text()}catch(e){Object(u.e)("Error while parsing fetch response",u.b,n,s)}return o.bodySize=s.length,{headers:r,content:JSON.parse(s),propsToLog:o,duration:i}}function T(e){return Object(s.a)(!0===e.odspResolvedUrl,478),e}const S=e=>a.a.create(e,"OdspDriver",{all:{driverVersion:g.a}});function k(e,t,n,r){return async function(i,s){let u=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return a.c.timedExecAsync(e,{eventName:`${s}_GetToken`,attempts:i.refresh?2:1,hasClaims:!!i.claims,hasTenantId:!!i.tenantId},(async e=>n(Object.assign(Object.assign({},i),t)).then((t=>{const n=d(t);if((u||e.duration>=32)&&e.end({fromCache:h(t),isNull:null===n}),null===n&&r)throw new o.e("The Host-provided token fetcher returned null",l.a.fetchTokenError,{method:s,driverVersion:g.a});return n}),(e=>{const t=null==e?void 0:e.canRetry;throw Object(c.i)(e,(e=>new o.d(`The Host-provided token fetcher threw an error: ${e}`,l.a.fetchTokenError,"boolean"==typeof t&&t,{method:s,driverVersion:g.a})))}))),{cancel:"generic"})}}function E(e){return{type:f.a,key:"",file:{resolvedUrl:e,docId:e.hashedDocumentId}}}const _=79872;function j(e){if(!e)return;const t=e.scope;if(!t)return`createLinkType=${e}`;let n=`createLinkScope=${t}`;const r=e.role;return n=r?`${n}&createLinkRole=${r}`:n,n}},"3YFW":function(e,t,n){"use strict";function r(e){if(this._capacity=i(e),this._length=0,this._front=0,o(e)){for(var t=e.length,n=0;n<t;++n)this[n]=e[n];this._length=t}}r.prototype.toArray=function(){for(var e=this._length,t=new Array(e),n=this._front,r=this._capacity,o=0;o<e;++o)t[o]=this[n+o&r-1];return t},r.prototype.push=function(e){var t=arguments.length,n=this._length;if(t>1){var r=this._capacity;if(n+t>r){for(var o=0;o<t;++o)this._checkCapacity(n+1),this[i=this._front+n&this._capacity-1]=arguments[o],n++,this._length=n;return n}var i=this._front;for(o=0;o<t;++o)this[i+n&r-1]=arguments[o],i++;return this._length=n+t,n+t}return 0===t?n:(this._checkCapacity(n+1),this[o=this._front+n&this._capacity-1]=e,this._length=n+1,n+1)},r.prototype.pop=r.prototype.shift=r.prototype.unshift=function(e){var t=this._length,n=arguments.length;if(n>1){if(t+n>(o=this._capacity)){for(var r=n-1;r>=0;r--){var o;this._checkCapacity(t+1),this[s=(this._front-1&(o=this._capacity)-1^o)-o]=arguments[r],t++,this._length=t,this._front=s}return t}var i=this._front;for(r=n-1;r>=0;r--){var s;this[s=(i-1&o-1^o)-o]=arguments[r],i=s}return this._front=i,this._length=t+n,t+n}return 0===n?t:(this._checkCapacity(t+1),this[r=(this._front-1&(o=this._capacity)-1^o)-o]=e,this._length=t+1,this._front=r,t+1)},r.prototype.peekBack=r.prototype.peekFront=r.prototype.get=function(e){var t=e;if(t===(0|t)){var n=this._length;if(t<0&&(t+=n),!(t<0||t>=n))return this[this._front+t&this._capacity-1]}},r.prototype.isEmpty=r.prototype.clear=function(){for(var e=this._length,t=this._front,n=this._capacity,r=0;r<e;++r)this[t+r&n-1]=void 0;this._length=0,this._front=0},r.prototype.valueOf=r.prototype.toString=r.prototype.removeFront=r.prototype.shift,r.prototype.removeBack=r.prototype.pop,r.prototype.insertFront=r.prototype.unshift,r.prototype.insertBack=r.prototype.push,r.prototype.enqueue=r.prototype.push,r.prototype.dequeue=r.prototype.shift,r.prototype.toJSON=r.prototype.toArray,Object.defineProperty(r.prototype,"length",{get:function(){return this._length},set:function(){throw new RangeError("")}}),r.prototype._checkCapacity=r.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e;var n=this._front,r=this._length;n+r>t&&this,0,this,t,n+r&t-1)};var o=Array.isArray;function i(e){if("number"!=typeof e){if(!o(e))return 16;e=e.length}return function(e){return e>>>=0,e-=1,e|=e>>1,e|=e>>2,e|=e>>4,1+((e|=e>>8)|e>>16)}(Math.min(Math.max(16,e),1073741824))}e.exports=r},"3kU/":"3tC7":function(e,t,n){"use strict";function r(e,t){if(!e)throw new Error("number"==typeof t?`0x${t.toString(16).padStart(3,"0")}`:t)}n.d(t,"a",(function(){return r}))},"43aC":"43jW":function(e,t,n){"use strict";n.d(t,"b",(function(){return T})),n.d(t,"a",(function(){return R}));var r=n("ovpI"),o=n("kbrL"),i=n("1NSz"),s=n("Sn4U"),a=n("x3xY"),c=n("GBVN"),u=n("OeRt"),l=n("mXGw"),d=n.n(l),h=n("QjXU"),f=n("p/uK"),p=n("sLnE"),m=n("DU/N"),g=Object(f.a)({pill:Object(h.__assign)(Object(h.__assign)(Object(h.__assign)({},p.a.margin("0px","5px")),p.a.border("1px","solid",m.a.colorBrandStroke2)),{color:m.a.colorNeutralForeground1,fontFamily:m.a.fontFamilyBase,fontWeight:m.a.fontWeightRegular,fontSize:m.a.fontSizeBase300,lineHeight:m.a.lineHeightBase300,":hover":{cursor:"pointer",backgroundColor:m.a.colorBrandBackground2Hover},":active":{backgroundColor:m.a.colorBrandBackground2Pressed}}),icon:{paddingRight:"4px",fontSize:"20px",paddingTop:"2px"},dropdownIcon:{paddingLeft:"4px",color:m.a.colorNeutralForeground1,fontSize:"12px"},likelihoodIconContainer:{paddingLeft:"4px",height:"16px",width:"16px"},likelihoodIcon:{color:m.a.colorNeutralForeground2},likelihoodIconSelected:{color:m.a.colorNeutralForeground2BrandPressed},pillSelected:Object(h.__assign)({color:m.a.colorNeutralForeground1,fontWeight:m.a.fontWeightSemibold,backgroundColor:m.a.colorBrandBackground2},p.a.border("1px","solid",m.a.colorBrandStroke1))}),v=Object(l.forwardRef)((function(e,t){var n=e.id,r=e.title,o=e.isActive,i=e.iconElement,s=e.iconElementRight,h=e.isDropdown,f=g(),p=Object(l.useMemo)((function(){return d.a.createElement("div",{className:f.icon},i)}),[f.icon,i]),m=Object(l.useMemo)((function(){return d.a.createElement(o?u.j:u.k,{className:f.dropdownIcon})}),[f.dropdownIcon,o]);return r?d.a.createElement(a.a,{id:n,shape:"circular",appearance:"outline",tabIndex:-1,className:o?Object(c.a)(f.pill,f.pillSelected):f.pill,ref:t},p,r,s?d.a.createElement("div",{className:o?Object(c.a)(f.likelihoodIconContainer,f.likelihoodIconSelected):Object(c.a)(f.likelihoodIconContainer,f.likelihoodIcon)},s):null,h&&m):null}));v.displayName="FluentPillControl";var b=n("chxZ"),y=n("iXzu"),w=n("elnK"),C=Object(w.create)((function(e,t){return{observer:new y.a((function(e){e.forEach((function(e){var n;null===(n=t().callbacks.get(e.target))||void 0===n||n(e)}))})),callbacks:new Map,observe:function(e,n){t().observer.observe(e),t().callbacks.set(e,n)},unobserve:function(e){t().observer.unobserve(e),t().callbacks.delete(e)}}}));function O(e){var t=function(){return C(()}(),n=t.observe,r=t.unobserve,o=Object(h.__read)(Object(l.useState)(!1),2),i=o[0],s=o[1],a=Object(l.useRef)(null),c=Object(l.useRef)(),u=Object(l.useRef)(void 0);u.current=e;var d=Object(l.useCallback)((function(){var e=a.current;c.current&&(c.current(),c.current=void 0),e&&(s(!0),n(e,(),c.current=}),[n,r]);return Object(l.useEffect)((,[]),{ref:Object(l.useCallback)((,[d]),elementSet:i}}var T,S=n("5DIn"),k=n("AcOL"),E=n("MqQ1"),_=n("qyk8"),j=n("8Jek"),I=n.n(j),N=n("LzJX"),A="PivotsControl-module__tab-list__header__tab-icon__hrEXI",P="PivotsControl-module__tab-list__header__title__1O_Iw",x="PivotsControl-module__tab-list__header__title-text--vertical-selected__216vS",D=!function(e){e[e.None=0]="None",e[e.Dropdown=1]="Dropdown"}(T||(T={}));var L=new Set([S.a.Enter,S.a.Space,S.a.ArrowLeft,S.a.ArrowRight]),M=new Set([S.a.Enter,S.a.Space,S.a.ArrowUp,S.a.ArrowDown]),R=function(e){var t,n=e.onSelectTab,a=e.tabs,c=e.pivotsOverflow,u=e.dropdownButtonText,h=e.isVertical,f=e.showIcons,p=e.activeTabOptions,m=e.maxPivotCount,g=e.showPills,y=void 0!==g&&g,w=e.onlyDropdownShownLeftAlignContext,C=void 0!==w&&w,j=e.onAddPendingPivot,R=e.onRemovePivot,F=e.pendingCustomPivotId,B=e.addCustomPivotButtonText,U=e.removeNewCustomPivotButtonText,W=e.removeNamedCustomPivotButtonText,q=e.persistTabOrder,H=e.selectedTabInDropdownAriaLabel,z=e.isFluentPill,G=h?M:L,V="rtl"===document.dir,$="add-pending-pivot-button",Q=(void 0===c?T.None:c)===T.Dropdown&&a.length>1,J=D(Object(b.a)(a),2),X=J[0],K=J[1],Y=a&&a.length?(null==p?void 0:p.id)&&!a.some((function(e){return e.id===p.id}))?p.id:a[0].id:"",Z=D(Object(b.a)(Y),2),ee=Z[0],te=Z[1],ne=D(Object(l.useState)(Y),2),re=ne[0],oe=ne[1],ie=D(Object(l.useState)(Y),2),se=ie[0],ae=ie[1],ce=D(Object(l.useState)(!1),2),ue=ce[0],le=ce[1],de=D(Object(b.a)(a.length),2),he=de[0],fe=de[1],pe=D(Object(l.useState)(!1),2),me=pe[0],ge=pe[1],ve=Object(l.useRef)(null),be=Object(l.useRef)(new Map),ye=Object(l.useRef)([]),we=Object(l.useRef)(null),Ce=D(Object(l.useState)(0),2),Oe=Ce[0],Te=Ce[1],Se=D(Object(l.useState)(0),2),ke=Se[0],Ee=Se[1],_e=Object(l.useCallback)((function(e){var t=e.contentRect.width;Te(j&&t>32?t-32:t)}),[j]),je=Object(l.useCallback)((,[]),Ie=O(_e),Ne=Ie.ref,Ae=Ie.elementSet,Pe=O(je),xe=Pe.ref,De=Pe.elementSet,Le=Object(l.useCallback)((function(e){te(e),n&&n({tabId:e}),oe(e),e!==F&&ae(e)}),[n,F,ae,te]),Me=Object(l.useMemo)((function(){return Q?X&&X.slice(he).map((function(e){var t=void 0,n=void 0,o=e.iconElement&&e.iconElementActive?e.iconElementActive:d.a.createElement(r.a,{iconName:s.a.CheckMark});return(q||0===he)&&me&&e.id===ee?(t=o,H&&(n=Object(_.a)(H,e.title))):e.iconElement&&e.iconElementActive&&(t=e.iconElement),{key:e.id,content:e.title,iconElement:t,ariaLabel:n,title:e.title}})):[]}),[Q,he,q,X,ee,me,H]),Re=Object(l.useCallback)((function(e){R&&(Le(se===e.id?"all":se),R(e))}),[R,se,Le]),Fe=Object(l.useCallback)((,[j,F,Le]),Be=Object(l.useCallback)((function(e){var t,n,r,o=a.findIndex((function(t){return e===t.id})),i=e===$;!i&&Q&&-1===o?null===(t=ve.current)||void 0===t||t.focus():i?null===(n=we.current)||void 0===n||n.focus():o<X.length&&(null===(r=ye.current[o])||void 0===r||r.focus())}),[a,Q,X.length]),Ue=Object(l.useCallback)((function(e,t){var n=Object(k.a)(e);if(G.has(n)){var r=Q?he:a.length,o=X.findIndex((function(e){return t===e.id}));e.preventDefault();var i=function(){Be(j&&o+1===r?$:X[(o+1)%r].id)},s=function(){Be(0===o&&j?$:t===$?Q&&Me.length&&De&&o-1<0?"":X[(o+r)%r].id:X[(o-1+r)%r].id)};switch(n){case S.a.Enter:case S.a.Space:t===$?Fe():Le(t);break;case S.a.ArrowLeft:if(V){i();break}case S.a.ArrowUp:s();break;case S.a.ArrowRight:if(V){s();break}case S.a.ArrowDown:i()}}}),[G,Q,V,he,a.length,X,j,Me.length,Fe,Le]),We=Object(l.useCallback)((function(e){var t=Object(k.a)(e);if(G.has(t)){var n;e.preventDefault();var r=function(){oe(n=j?$:X[0].id),Be(n)},o=function(){oe(n=X[he-1].id),Be(n)};switch(t){case S.a.ArrowLeft:V?r():o();break;case S.a.ArrowRight:V?o():r()}}}),[V,j,he,X,G,Be]),qe=Object(l.useCallback)((function(e){var t=null!=e?e:ee;te(t);for(var n=X.findIndex((function(e){return t===e.id})),r=be.current,o=0,i=0;i<a.length;i++){var s=r.get(a[i].id);if(s&&(o+=s,(i===a.length-1?o:o+ke)>Oe||m&&i===m))return fe(i),void ge(n>=i)}ge(!1),fe(X.length)}),[Oe,ke,X,ee,m,fe,te,a]),He=Object(N.a)((function(e){if(Q&&Ae&&be.current&&0!==be.current.size){if(q)return qe(e);var t=void 0;e&&(t=X.findIndex((),te(X[t].id));for(var n=t,r=be.current,o=r.get(ee)||0,i=!1,s=0;s<X.length;s++){var a=void 0;if(X[s].id!=ee?a=o+(r.get(X[s].id)||0):(a=o,i=!0),o=a,(s<X.length-1?a+ke:a)>=Oe||m&&s===m){if(n=Math.max(s-1,0),void 0!==t&&void 0!==n&&n!==t){var c=X.slice();c.splice(t,1),c.splice(n,0,X[t]),K(c),le(!0),He()}else if(!i){var u=X.findIndex((function(e){return e.id===ee})),l=X[u];X.splice(u,1),X.splice(n,0,l)}return void fe(s)}}fe(X.length)}}),50),ze=Object(l.useCallback)((function(e,t,r){var o;if(q)return te(e),null===(o=ve.current)||void 0===o||o.focus(),n&&n({tabId:e}),void ge(!0);r&&(te(e),oe(e),n&&n({tabId:e}),He(e),le(!0))}),[te,n,He,q]),Ge=Object(l.useMemo)((function(){return X&&X.length?X.slice(0,m&&m<he?m:he).map((function(e){var t,n,o,i,s,c,u=e.id+"-pivot";return d.a.createElement("span",{key:e.id,className:I()((t={},t[P]=!y,t["PivotsControl-module__tab-list__header__title--vertical__2YJ-0"]=h,t["PivotsControl-module__tab-list__header__title--selected__MFdUq"]=e.id===ee&&h,t[x]=e.id===ee&&h,t["PivotsControl-module__tab-list__fluentOutline__4MYIy"]=z,t)),onClick:onKeyDown:ref:function(t){var n;null===(n=e.onPivotRefChange)||void 0===n||n.call(e,t),ye.current[a.findIndex((function(t){return t.id===e.id}))]=t;var r=(null==t?void 0:t.offsetWidth)||0;(Q&&!be.current.has(e.id)||be.current.has(e.id)&&be.current.get(e.id)!=r&&0!=r)&&(be.current.set(e.id,r),He()),ue&&re===e.id&&(null==t||t.focus(),le(!1))},tabIndex:h&&e.id===X[0].id&&""==ee||ee===e.id||re===e.id?0:-1,"aria-labelledby":u,role:h?"menuitemradio":"tab","aria-selected":e.id===ee,"aria-checked":h&&e.id===ee},y?e.isCustomPivot&&R?d.a.createElement(E.a,{id:u,title:e.title,iconName:e.iconName,iconElement:e.iconElement,ariaLabel:null!==(o=e.ariaLabel)&&void 0!==o?o:e.title,isActive:e.id===ee,isRemovable:!0,onRemoveClick:function(){return Re(e)},disableFocus:!0,removePillAriaLabel:e.id===F?U:Object(_.a)(null!=W?W:"",null!==(i=e.title)&&void 0!==i?i:"")}):z?d.a.createElement(v,{id:u,title:e.title,isActive:e.id===ee,iconElement:e.iconElement instanceof Promise?void 0:e.iconElement,iconElementRight:e.iconElementRight}):d.a.createElement(E.a,{id:u,title:e.title,iconName:e.iconName,ariaLabel:null!==(s=e.ariaLabel)&&void 0!==s?s:e.title,isActive:e.id===ee||"all"==(null==p?void 0:p.activeMode),isRemovable:null==p?void 0:p.allTabsRemovable,onRemoveClick:(null==p?void 0:p.allTabsRemovable)?function(){return Re(e)}:void 0,iconElement:e.iconElement,iconElementActive:e.iconElementActive,disableFocus:!0}):d.a.createElement("div",{id:u,title:e.title,"aria-label":null!==(c=e.ariaLabel)&&void 0!==c?c:e.title,className:I()("PivotsControl-module__tab-list__header__title-text__3sGwC",(n={},n["PivotsControl-module__tab-list__header__title-text--selected__2c6us"]=e.id===ee&&!h,n["PivotsControl-module__tab-list__header__title-text--vertical__2-Nox"]=h,n["ms-fcl-nd ms-bcl-tda"]=e.id===ee&&!h,n[x]=e.id===ee&&h,n))},f&&e.icon?d.a.createElement("div",{className:A},e.icon):null,f&&e.iconName?d.a.createElement(r.a,{className:A,iconName:e.iconName}):null,f&&e.iconClassName?d.a.createElement("span",{className:e.iconClassName}):null,e.title))})):null}),[m,he,X,y,h,ee,z,re,R,F,U,W,f,Le,q,Ue,a,Q,ue,He,Re]);Object(l.useEffect)((function(){Q&&X.length===Me.length?ge(!0):(null==p?void 0:p.id)&&(a.some((function(e){return e.id===p.id}))?(Me.find((function(e){return e.key===p.id}))?q?ge(!0):(fe(X.length),He(p.id)):ge(!1),oe(p.id),te(p.id)):te(""))}),[p,Q,Me,He,q,X.length,fe,te,ge,a]),Object(l.useEffect)((,[Q,He,Oe]),Object(l.useEffect)((function(){if(a.length!==be.current.size){var e=be.current,t=new Set(a.map((function(e){return e.id}))),n=[],D(e.keys()),!1).find(();n&&e.delete(n),He()}}),[He,a]),Object(l.useEffect)((function(){if(X&&a){var e=void 0;if(X.length!==a.length)e=!0;else{var t=X.map((function(e){return e.id})).sort(),n=a.map(().sort();e=!t.every(()}e&&(K(a),te(a&&a.length?a[0].id:""),He())}}),[He,X,K,te,a]);var Ve=Object(l.useMemo)((function(){var e,t=u?Object(_.a)(u,Me.length.toString()):void 0;return Q&&Me.length?d.a.createElement("span",{ref:xe,className:"PivotsControl-module__tab-list__dropdown__3SBq9",onKeyDown:We},d.a.createElement(i.a,{buttonContent:y?z?d.a.createElement(v,{title:null!=t?t:"",isActive:q&&me,isDropdown:!0}):d.a.createElement(E.a,{title:null!=t?t:"",isActive:q&&me,isDropdown:!0,disableFocus:!0}):d.a.createElement("span",{className:I()(P,(e={},e["PivotsControl-module__tab-list__header__title--selected-underline__2owz9"]=q&&me,e["ms-fcl-nd ms-bcl-tda"]=q&&me,e))},t,d.a.createElement(r.a,{className:I()("ms-fcl-tda","PivotsControl-module__tab-list__more__icon__2LKBd"),iconName:s.a.ChevronDown})),items:Me,options:{leftAligned:C&&0===he},menuItemType:o.a.List,onKeySelected:ze,stopButtonEventPropagation:!0,ref:ve,buttonAriaLabel:t,disableFocus:!1})):null}),[u,Me,Q,We,y,q,me,z,C,he,ze,xe]);return d.a.createElement("div",{ref:Ne,className:I()("PivotsControl-module__tab-list__header__tabs__1sJbM",(t={},t["PivotsControl-module__tab-list__header__tabs--vertical__Lzme0"]=h,t["PivotsControl-module__tab-list__header__pills__-cUq0 PivotsControl-module__tab-list__header__tabs__1sJbM"]=y&&!z,t["PivotsControl-module__tab-list__header__fluentpills__cKz5O"]=z,t["PivotsControl-module__tab-list__header--hidden__EtmNv"]=0===Oe,t)),role:h?"menu":"tablist"},d.a.createElement(d.a.Fragment,null,Ge,Ve,!j||!B||a&&a.find(()?null:d.a.createElement("span",{key:$,role:"tab",tabIndex:re===F?0:-1,ref:we,onClick:Fe,title:B,"aria-label":B,onKeyDown:,d.a.createElement(r.a,{iconName:s.a.Add,className:"PivotsControl-module__tab-list__header__add-tab-button__1PSwT"}))))}},"4OlW":"4PWS":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={home:"5099F2E5-AD99-4BF2-BF82-DF525FFD0BE2",create:"83D3F491-B586-4266-8738-89776471BF21",mycontent:"F57D5D29-4967-495C-A648-F7AB66BF8572",orion:"099317ab-9a66-4a75-868c-dc2263ce2eb9",intents:"2CC62124-219E-4777-9A92-00CDE9062859",feed:"261d33d6-15ba-4e1d-b298-8096960fab40",appgallery:"26706956-2AAE-4A22-8960-09B98C35B28C",alps:"4fbe3a87-55c7-45f6-a518-462f40fd25a0",outlook:"Mail",onedrive:"Documents",teams:"SkypeTeams",word:"WordOnline",excel:"ExcelOnline",powerpoint:"PowerPointOnline",onenote:"OneNoteOnline",sway:"Sway",forms:"OfficeForms",admin:"Admin",visio:"VisioOnline",stream:"MicrosoftStream",todo:"ToDo",familysafety:"FamilySafety",calendar:"Calendar",skype:"Skype",people:"People",powerautomate:"LogicFlows",clipchamp:"Clipchamp",lists:"Lists",yammer:"Yammer",powerbi:"PowerBIv2",bing:"Bing",msn:"MSN",privacy:"Privacy",rewards:"Rewards",whiteboard:"Whiteboard",defender:"Defender"}},"5+lF":function(e,t,n){var r=n("naAV");e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}},"5+n6":function(e,t,n){"use strict";n.d(t,"b",(function(){})),n.d(t,"a",(function(){return c}));var r=n("I18q"),o=n("OfNt"),i=n("PtL/");const s=new Map;function a(e){if(null!=e){const t=Object(r.a)(e),n=void 0!==t?t:e;return"on"===n||"off"===n?"on"===n:n}}function c(e,t,n){return function(e,t,n,r){return n?n.getSetting(e,t,r):function(e,t){return function(e,t){const n=s.get(e);if(void 0!==n)return n;let r,c,u;return u=void 0!==(r=e))?r:void 0!==(c=function(e){var t;return a(null===(t=Object(o.a)())||void 0===t?void 0:t.getItem(e))}(e))?c:t,s.set(e,u),u}(e,t)}(e,t)}(e,t,n,"FluidExperiences")}},"5ANk":function(e,t,n){"use strict";.d(t,"a",(function(){return r}))},"5DIn":"5HQQ":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("QjXU");function o(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Promise.all([n.e(50),n.e(720)]).then(n.bind(null,"fTj/"))];case 1:return[2,t.sent().getInstalledApp(e).then(().catch((function(){return!1}))]}}))}))}},"5PdT":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("QjXU");function o(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){return[2,window.crypto.subtle.importKey("jwk",e,"AES-GCM",!1,["encrypt","decrypt"])]}))}))}function i(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(n=null===(t=e.encryptionConfig)||void 0===t?void 0:t.cryptoKey)?[4,o(n)]:[2,{key:null}];case 1:return[2,{key:r.sent()}]}}))}))}},"5Q+G":function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return b}));var r=n("V2nY");class o{constructor(e){r.a.assign(o,this,e)}static getTypeName(){return"AugLoop_Core_ItemDelta"}static getBaseTypes(){return[]}static typeGuard(e){return r.a.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{constructor(e){r.a.assign(i,this,e)}static getTypeName(){return"AugLoop_Core_ItemChangesDelta"}static getBaseTypes(){return["AugLoop_Core_ItemDelta"]}static typeGuard(e){return r.a.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class s{constructor(e){r.a.assign(s,this,e)}static getTypeName(){return"AugLoop_Core_Operation"}static getBaseTypes(){return[]}static typeGuard(e){return r.a.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class a{constructor(e){r.a.assign(a,this,e)}static getTypeName(){return"AugLoop_Core_OperationWithSiblingContext"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return r.a.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class c{constructor(e){r.a.assign(c,this,e)}static getTypeName(){return"AugLoop_Core_AddOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(e){return r.a.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{constructor(e){r.a.assign(u,this,e)}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(e){return r.a.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class l{constructor(e){r.a.assign(l,this,e)}static getTypeName(){return"AugLoop_Core_UpdateAnnotationMetaDataOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return r.a.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class d{constructor(e){r.a.assign(d,this,e)}static getTypeName(){return"AugLoop_Core_UpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return r.a.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class h{constructor(e){r.a.assign(h,this,e)}static getTypeName(){return"AugLoop_Core_DeleteOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return r.a.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class f{constructor(e){r.a.assign(f,this,e)}static getTypeName(){return"AugLoop_Core_PurgeOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return r.a.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class p{constructor(e){r.a.assign(p,this,e)}static getTypeName(){return"AugLoop_Core_FocusOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return r.a.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class m{constructor(e){r.a.assign(m,this,e)}static getTypeName(){return"AugLoop_Core_VisibilityOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return r.a.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class g{constructor(e){r.a.assign(g,this,e)}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return r.a.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class v{constructor(e){r.a.assign(v,this,e)}static getTypeName(){return"AugLoop_Core_MicroSyncOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return r.a.matchesTypesFor(e,[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class b{constructor(e){r.a.assign(b,this,e)}static getTypeName(){return"AugLoop_Signals_SignalOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return r.a.matchesTypesFor(e,[b.getTypeName()])}}b.H_={T_:b.getTypeName(),B_:b.getBaseTypes()}},"5QbJ":"5X7G":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return c}));var r,o,i,s=n("QjXU"),a=n("hBZP");!r||(r={})),o||(o={})),function(e){e.RunNext="run-next"}(i||(i={}));var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.__extends)(t,e),t.prototype.on=function(t,n){return e.prototype.on.call(this,t,n)},t.prototype.once=function(t,n){return e.prototype.once.call(this,t,n)},t.prototype.emit=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return e.prototype.emit.apply(this,Object(s.__spreadArray)([t],Object(s.__read)(n),!1))},t}(a.EventEmitter)},"5eS3":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("GeVZ");function o(e,t){if(!e||!t)return e;var n=Object(r.a)(e);if(!n)return e;var o=n.hostname,i=n.port,s=n.path,a=n.search,c=n.hash;return"".concat(n.protocol,"//").concat(o).concat(i?":"+i:"").concat(s).concat(a?a+"&":"?").concat(t).concat(c)}},"5f5u":function(e,t){var n="undefined"!=typeof self?self:this,r=);!function(e){!function(t){var n="URLSearchParams"in e,r="Symbol"in e&&"iterator"in Symbol,o="FileReader"in e&&"Blob"in e&&),i="FormData"in e,s="ArrayBuffer"in e;if(s)var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],c=ArrayBuffer.isView||pe.append=h.prototype.delete=h.prototype.get=h.prototype.has=h.prototype.set=h.prototype.forEach=h.prototype.keys=h.prototype.values=h.prototype.entries=r&&(h.prototype[Symbol.iterator]=h.prototype.entries);var b=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];ototype.clone=v.call(y.prototype),v.call(O.prototype),O.prototype.clone=O.error=var T=[301,302,303,307,308];O.redirect=t.DOMException=e.DOMException;try{new t.DOMException}catch(e){t.DOMException=t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function S(e,n){return new Promise((function(r,i){var s=new y(e,n);if(s.signal&&s.signal.aborted)return i(new t.DOMException("Aborted","AbortError"));var a=new XMLHttpRequest;.onload=a.onerror=function(){i(new TypeError("Network request failed"))},a.ontimeout=a.onabort=a.open(s.method,s.url,!0),"include"===s.credentials?a.withCredentials=!0:"omit"===s.credentials&&(a.withCredentials=!1),"responseType"in a&&o&&(a.responseType="blob"),s.headers.forEach((),s.signal&&(s.signal.addEventListener("abort",c),a.onreadystatechange=,a.send(void 0===s._bodyInit?null:s._bodyInit)}))}S.polyfill=!0,e.fetch||(e.fetch=S,e.Headers=h,e.Request=y,e.Response=O),t.Headers=h,t.Request=y,t.Response=O,t.fetch=S,Object.defineProperty(t,"__esModule",{value:!0})}({})}(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var o=r;(t=o.fetch).default=o.fetch,t.fetch=o.fetch,t.Headers=o.Headers,t.Request=o.Request,t.Response=o.Response,e.exports=t},"5zuf":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}));var r=n("KlUR"),o=n("Xou4");async function i(e,t){const n=await crypto.subtle.digest(t,e);return new Uint8Array(n)}function s(e,t){switch(t){case"hex":return Array.prototype.map.call(e,(e=>e.toString(16).padStart(2,"0"))).join("");case"base64":return r.fromByteArray(e)}}async function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"SHA-1",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"hex";if(void 0===crypto.subtle)return n.e(272).then(n.bind(null,"t0y+")).then((async n=>n.hashFile(e,t,r)));const o=await i(e,t);return s(o,r)}async function c(e){const t=`blob ${e.byteLength.toString()}${String.fromCharCode(0)}`;return a(o.a.from(t+e.toString()))}},"60TO":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("Htdc"),o=n("KlUR");async function i(e,t){const n=await crypto.subtle.digest(t,e);return new Uint8Array(n)}function s(e,t){switch(t){case"hex":return Array.prototype.map.call(e,().join("");case"base64":return o.fromByteArray(e)}}async function a(e,t){const o=r.a.from(`${e}_${t}`);return encodeURIComponent(await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"SHA-1",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"hex";return void 0===crypto.subtle?n.e(272).then(n.bind(null,"+eDm")).then(():s(await i(e,t),r)}(o,"SHA-256","base64"))}},6758:"6MXh":function(e,t,n){"use strict";function r(e,t,n,r,o,i,s,a){if(void 0===r&&(r=!1),void 0===i&&(i=!1),void 0===s&&(s=!1),void 0===a&&(a=!1),!document)return null;if(o){var c=document.getElementById(o);if(null!=c)return t&&t(),c}var u=document.createElement("script");if(u.src=e,o&&(u.id=o),t&&(u.onload=t),n&&(u.onerror=function(){var e;n(),s&&(null===(e=u.parentNode)||void 0===e||e.removeChild(u))}),i&&(u.crossOrigin="anonymous"),a&&(u.async=!0),r){var l=document.getElementsByTagName("script")[0];if(l&&l.parentNode)return l.parentNode.insertBefore(u,l)}return document.body.appendChild(u)}n.d(t,"a",(function(){return r}))},"6TGQ":"6iN7":"6s8r":"6vom":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r="OfficeWebHost"},"6y6H":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("QjXU"),o=n("B5kz"),i=n("5PdT"),s=n("W7wX");function a(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(s.a)()];case 1:return e=t.sent(),[2,o.a.fetchQuery(["EncryptionKey",e.puid],(,{staleTime:1/0,cacheTime:1/0})]}}))}))}},"71kK":"7L9N":"7LW7":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("QjXU"),o=n("28zg"),i=n("KQ1A");function s(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return[2,Object(o.a)(i.a)]}))}))}},"7Owc":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return v})),n.d(t,"c",(function(){return T})),n.d(t,"b",(function(){return P}));var r=n("fW/M"),o=n("RJ4T");const i=void 0!==e&&e.env?e.env.SERVICE_NAME:"client",s="abcdefghijklmnopqrstuvwxyz0123456789",a={97:0,98:1,99:2,100:3,101:4,102:5,103:6,104:7,105:8,106:9,107:10,108:11,109:12,110:13,111:14,112:15,113:16,114:17,115:18,116:19,117:20,118:21,119:22,120:23,121:24,122:25,48:26,49:27,50:28,51:29,52:30,53:31,54:32,55:33,56:34,57:35};let c,u=[],l=[],d=h=const f=new Map,p=new Map,m=new Map,g=new Map;var v;!function(e){e.defineCoreLogCategory=e=>({root:"Core",name:e}),e.defineWorkflowLogCategory=e.clearLoggers=()=>{u=[],l=[],p.clear(),m.clear()},e.clearAggregators=()=>{f.clear()},e.addLogger=e=>{-1===u.indexOf(e)&&(u.push(e),b(p,e))},e.addDecidingLogger=e=>{-1===l.indexOf(e)&&(l.push(e),b(m,e))},e.setCorrelationContextCallback=e=>{c=e},e.setStartPerformanceEventCallback=e=>{d=e},e.setStopPerformanceEventCallback=e.addAggregator=e=>{e.init((),f.has(e.eventName)?f.get(e.eventName).push(e):f.set(e.eventName,[e])},e.flushAggregators=e=>{f.forEach(()},e.setTagLevelOverride=e.resetTagLevelOverrides=e.error=(e,t,n,o,i,s,a,c,u,l)=>{E(e,t,r.a.error,n,o,i,s,a,c,u,l)},e.warn=(e,t,n,o,i,s,a,c,u,l)=>{E(e,t,r.a.warn,n,o,i,s,a,c,u,l)},e.info=(e,t,n,o,i,s,a,c,u,l)=>{E(e,t,r.a.info,n,o,i,s,a,c,u,l)},e.verbose=(e,t,n,o,i,s,a,c,u,l)=>{E(e,t,r.a.verbose,n,o,i,s,a,c,u,l)},e.debug=(e,t,n,o,i,s,a,c,u,l)=>{E(e,t,r.a.debug,n,o,i,s,a,c,u,l)},e.metric=(e,t,n,o,i,s,a,c,u,l)=>{E(e,t,r.a.metric,n,o,i,s,a,c,u,l)},e.formatMetric=(e,t,n,r)=>{const o={};return o[e]={dimensionNames:n,dimensionValues:r,value:t},o},e.dynamic=(v||(v={}));const b=(e,t)=>{const n=t.level;Object.keys(r.a).map(().filter(().filter(().forEach(()},y=e=>{if("string"==typeof e)return e;let t="";for(let n=0;n<e.length;n++){n>0&&(t+=" ");const r=e[n];r instanceof Error?t+=JSON.stringify({message:r.message,name:r.name,stack:r.stack}):t+="object"==typeof r?JSON.stringify(r):r}return t},w=[],C=["Level","Tag"],O=["Level","Tag","Workflow"],T=S=e=>void 0!==e?p.get(e)||w:u,k=(e,t)=>(void 0!==e?m.get(e)||[]:l).filter((e=>e.shouldLog(t))),E=(e,t,n,r,i,s,a,u,l,p,m)=>{n=g.get(e)||n;const v=S(n),b=k(n,r);if(0==v.length&&0==b.length)return;const w=d(o.a.Log),T=N(e),E=((e,t,n,r,o,i,s,a)=>{if(void 0===t&&("string"==typeof e||"object"==typeof e))return e;if(void 0===t&&"function"==typeof e)return e();const c=[];for(const u of[e,t,n,r,o,i,s,a])void 0!==u&&c.push("function"==typeof u?u():u);return c})(r,i,s,a,u,l,p,m);if(j(t))I(E)&&_({eventName:"Metrics",tagId:T,category:`${t.root}.${t.name}`,traceLevel:n,message:"",getMetrics:()=>E},!1,v,b);else if(I(E)){const e=E;e.tagId=T,e.category=`${t.root}.${t.name}`,"Operation"===e.eventName&&"Workflow"===t.root&&(e.eventName="WorkflowOperation",c&&(e.joinContextId=c().joinContextId)),e.traceLevel=n;const r=f.get(e.eventName);if(r)for(let t=0;t<r.length;++t){const n=r[t];if(n&&n.add(e,t===r.length-1))break}else _(e,!1,v,b)}else{const e=()=>{var e;return"Core"===t.root?{TraceEventV2:{dimensionNames:()=>C,dimensionValues:[String(n),T],value:1}}:{WorkflowTraceEvent:{dimensionNames:()=>O,dimensionValues:[String(n),T,c?null===(e=c())||void 0===e?void 0:e.workflow:""],value:1}}};_({eventName:"Log",tagId:T,category:`${t.root}.${t.name}`,traceLevel:n,message:y(E),getMetrics:e},!1,v,b)}h(w)},_=(e,t=!1,n,r)=>{var o,s,a;if(null==n&&(n=S(e.traceLevel)),r=r||w,n.length>0||r.length>0){if(e.serviceName=i,!t&&c){const t=c();if(t){e.cv=e.cv?e.cv:t.cv.toString(),e.sessionKey=e.sessionKey?e.sessionKey:t.sessionKey,e.workflow=e.workflow?e.workflow:t.workflow;const n=null===(o=t.clientMetadata)||void 0===o?void 0:o.appName;e.clientAppName=e.clientAppName?e.clientAppName:n;const r=null===(s=t.clientMetadata)||void 0===s?void 0:s.appPlatform;e.clientAppPlatform=e.clientAppPlatform?e.clientAppPlatform:r;const i=null===(a=t.clientMetadata)||void 0===a?void 0:a.releaseAudienceGroup;e.clientReleaseAudienceGroup=e.clientReleaseAudienceGroup?e.clientReleaseAudienceGroup:i}}for(const t of n)t.log(e);for(const t of r)t.log(e)}},j=I=e=>!Array.isArray(e)&&"object"==typeof e,N=e=>s[e>>24&63]+s[e>>18&63]+s[e>>12&63]+s[e>>6&63]+s[e>>0&63],A=e=>e&&5===e.length?a[e.charCodeAt(0)]<<24|a[e.charCodeAt(1)]<<18|a[e.charCodeAt(2)]<<12|a[e.charCodeAt(3)]<<6|a[e.charCodeAt(4)]:-1;.CoreDefault=v.defineCoreLogCategory("Default"),P.CoreSystem=v.defineCoreLogCategory("System"),P.WorkflowDefault=v.defineWorkflowLogCategory("Default"),P.WorkflowUnsampled=v.defineWorkflowLogCategory("Unsampled"),P.WorkflowMetricsOnly=v.defineWorkflowLogCategory("MetricsOnly")}).call(this,n("5IsQ"))},"7l51":function(e,t,n){"use strict";var r,o;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),r||(r={})),function(e){e[e.Normal=0]="Normal",e[e.Divider=1]="Divider"}(o||(o={}))},"7o+A":"7p/x":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("QjXU"),o=n("mXGw"),i=n("+fvi");function s(){var e=Object(r.__read)(Object(o.useState)(i.f),2),t=e[0],n=e[1];return Object(o.useEffect)((function(){var e=i.c.subscribe(n);return ),[]),t}},"7qnD":"8Jek":"8VPm":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={staleTime:1/0,cacheTime:1/0}},"9K2m":"9Q+N":function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("QjXU"),o=n("ovpI"),i=n("dvPJ"),s=n("vC/Q"),a=n("8Jek"),c=n.n(a),u=n("mXGw"),l=n.n(u),d=function(e){var t=e.menu,n=e.hidden,a=e.mouseEvent,d=e.onItemClick,h=e.onDismiss,f=null!=a?a:e.target,p=Object(u.useMemo)((function(){return{root:c()("ContextMenuControl-module__context-menu-item__1ezwS","ms-bgc-g40-h ms-bgc-w ms-bgc-g40-f ms-bgc-g40-a"),item:"ContextMenuControl-module__menu-item__flex-content__2zosE",label:c()("ContextMenuControl-module__context-menu-item__title__wb0-m","ms-fcl-bl"),subMenuIcon:"ContextMenuControl-module__submenu-icon__3oF7Q"}}),[]),m=function(e){return e.map((function(e){var t={key:e.id,text:e.title,disabled:e.disabled,onClick:;return t.itemProps={item:t,className:"context-menu-item",styles:p},e.extension&&(t.onRenderIcon=function(){return l.a.createElement(o.a,Object(r.__assign)({className:"ContextMenuControl-module__menu-icon__3Vh-I"},Object(s.a)({size:16,extension:e.extension,imageFileType:"svg"})))}),e.icon&&(t.iconProps={iconName:e.icon,className:c()("ContextMenuControl-module__context-menu__icon__11GIE","ms-fcl-bl")}),e.renderIcon&&(t.onRenderIcon=e.renderIcon),e.subMenus&&(t.subMenuProps={items:m(e.subMenus)}),t}))},g=m(t.items);return l.a.createElement(i.a,{items:g,hidden:n,target:f,onItemClick:d,onDismiss:h,className:c()("ContextMenuControl-module__context-menu__11Al8","ms-bgc-w")})}},"9Rh3":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("If7d"),o=!1;function i(e,t){if(void 0===t&&(t=!1),!o){o=!0;var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:"FabricMDL2Icons",src:"url('"+e+(t?"officestarticons-fluent-a4b37e10.woff":"officestarticons-6114ff7c.woff")+"') format('woff')"},icons:{Accounts:"",Add:"",AlertSolid:"",Attach:"",Calendar:"",Cancel:"",Chat:"",CheckMark:"",ChevronDown:"",ChevronLeft:"",ChevronRight:"",ChromeClose:"",CircleFill:"",CirclePlus:"",Clock:"",Comment:"",CompassNW:"",CubeShape:"",Delete:"",Diamond:"",DocumentSearch:"",Download:"",Edit:"",EditSolid12:"",ExcelLogo:"",ExploreContent:"",FabricFolder:"",FavoriteStar:"",Filter:"",Flag:"",FluidLogo:"",Forward:"",Glimmer:"",GridViewMedium:"",Group:"",Heart:"",HeartFill:"",Hide3:"",Home:"",Link:"",List:"",Mail:"",More:"",MoreVertical:"",News:"",ODLink:"",OEM:"",OfficeCatchUp:"",OneNoteLogo:"",OpenFile:"",OpenFolderHorizontal:"",OpenInNewTab:"",Page:"",People:"",PhotoVideoMedia:"",Pinned:"",PowerPointLogo:"",RedEye:"",Remove:"",Reply:"",ReturnKey:"",Rocket:"",Share:"",Sort:"",SortUp:"",Stop:"",Sync:"urn e(ton(){h.hasValue=!0,h.value=f}),[f]),l(f),f}},"9aUh":function(e,t){e.expoar i=28,t){n=n||0;for(var s=0;s<16;++s)t[n+s]=i[s];return t}return Object(o.a)(i)}},AJMQ:function(e,t){e.exports=function(e){return this.__data__.has(e)}},AcOL:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("5DIn"),o={Tab:r.a.Tab,Enter:r.a.Enter,Shift:r.a.Shift,Esc:r.a.Escape,Escape:r.a.Escape,Space:r.a.Space," ":r.a.Space,Left:r.a.ArrowLeft,ArrowLeft:r.a.ArrowLeft,Up:r.a.ArrowUp,ArrowUp:r.a.ArrowUp,Right:r.a.ArrowRight,ArrowRight:r.a.ArrowRight,Down:r.a.ArrowDown,ArrowDown:r.a.ArrowDown,Zero:r.a.Zero,Nine:r.a.Nine,a:r.aontextgba(54, 123, 217, 0.15) 100.3%), #FFFFFF",o{e.exports=function(e){function t(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return r.colors[Math.abs(t)%r.colors.length]}function r(e){let n;function s(...e){if(!s.enabled)return;const t=s,o=Number(new Date);t.diff=o-(n||o),t.prev=n,t.curr=o,n=o,e[0]=r.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let i=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,o)=>{if("%%"===n)return n;i++;const s=r.formatters[o];return"function"==typeof s&&(n=s.call(t,e[i]),e.splice(i,1),i--),n})),r.formatArgs.call(t,e),(t.log||r.log).apply(t,e)}return s.namespamespace+(void 0===t?":":t)+e);retuing(2,e.tonceof Err^"+e.substn!0;let t,n;for(t=0,n=r.skips.length;t<n;t++)est(e))return!1;for(t=0,n=r.names.length;t<n;t++)if(r.names[t].test(e))return!0;return!1},r.humanize=n("kKrb"),Object.keys(e).forEach((t=>{r[t]=e[t]})),r.instances=[],r.names=[],r.skips=[],r.formatters={},r.selectColor=t,r.enable(r.load()),r}},ArpJ:function(e,t,n){var r=n("V2ZB"),o=n("Vujp");e.expos.min.{var bols?){for(var i=arguments,s=-1,a=o(i.length-t,0),c=Array(a);++s<a;)c[s]=i[t+s];s=-1;for(var u=Array(t+1);++s<t;)u[s]=i[s];return u[t]=n(c),r(e,this,u)}}},B5kz:function(e,t,n){"use strict";n.d(t,"a",(function(){return F})),n.d(t,"d",(function(){return V})),n.d(t,"b",(function(){return ee})),n.d(t,"c",(function(){return te}));var r,o=n("Fcif");!function(e){e.Idle="idle",e.Loading="loading",e.Error="error",e?e(t):e}function d(e,t){if("function"==typeof t)throw new Error;return b(t)?Object.keys(ttutypeof document||[void 0,"visible","prerender"].includes(document.visibilityState)}function m(){return void 0===navigator.onLine||navigator.onLine}function g(e,t,n,r){var i,var t;return function(n){t&&t(),t=n(e)}}function T(e){Promise.resolve().then(e).catchction(){throw e}))}))}var S=function(e){e()},k={queries:{cacheTime:3eryFn:function(){return Promise.reject()},queryKeySerializerFn:function(e){try{var t=Array.isArray(e)?e:[e],n=function(e){return JSON.stringify(e,d)}(t);return[n,t=JSON.pars required!")}},refetchOnMount:!0,refetchOnReconnect:!0,refetchOnWindowFocus:!0,retry:3,retryDelay:function(e){return Math.min(1e3*Math.pow(2,e),3e4)},staleTime:0,structuralSharing:!0}};function E(e,t,n,r){var i=e.getDefaultConfig(),s=Object(o.a)({},k.queries,null==i?void 0:i.shared,null==i?void 0:i.queries,null==n?queryKeySerializerFn(t);return sansactions=t=e();return this.transactions--,this.transactions||this.flush(),t},t.schedule=function(e){this.tra{e()}))},t.flush=function(this),this.refetch=this.refetch.binabled&&(this.c),this.updateTied&&e.staleTime===t.staleTime||this.updateStaleTimeout(),e.enabled===t.enabled&&e.refetchInterval===t.refetchInterval||t)}},t.getrentQuery}lear=functio=functioonfig.queryFn===!this.isStale||this.config.suspense&&this.currentResult.isFetched||!this.config.refetchOnMount&&1!==this.currentQuery.observers.length||this.fetch()},t.updateStaleTimeout=function(){var e=this;if(!a&&(this.clearStaleTimeout(),!this.isStig.staleTime-t+1,0);this.stalechInterval)&&(this.refetchIntervalId=setInterval((function(){(e.config.refetchIntervalInBackgrouers=function(){this.updateStaleTimeout(),this.updateRefetchInterval()},t.clearTimers=function(){this.clearStaleTimeout(),this.clearRefetchInterval()},t.clearStaleTimeout=function(){this.staleTimeoutId&&(clearInterval(this.staleTimeoutId),this.staleTimeoutId=void 0)},t.clearRefetchInterval=function(){this.refetchIntervalId&&(clearInterval(this.refetchIntervalId),this.refetchIntervalId=void 0)},t.updateResult=function(){var e,t=this.currentQuery.state,n=t.data,r=t.status,i=t.updatedAt,s=!1;this.config.keepPreviousData&&t.isInitialData&&(null==(e=this.previousQueryResult)?void 0:e.isSuccess)&&(n=this.previousQueryResult.data,i=this.previousQueryResult.updatedAt,r=this.previousQueryResult.status,s=!0),this.currentResult=Object(o.a)({},C(r),{canFetchMore:t.canFetchMore,clear:this.remove,data:n,error:t.error,failureCount:t.failureCount,fetchMore:this.fetchMore,isFetched:t.updateCount>0,isFetchedAfterMount:t.updateCount>this.initialUpdateCount,isFetching:t.isFetching,isFetchingMore:t.isFetchingMore,isInitialData:t.isInitialData,isPreviousData:s,isStale:this.isStale,refetch:this.refetch,remove:this.remove,updatedAt:i})},t.updateQuery=function(){var e=this.config,t=this.currentQuery,n=e.queryCache.getQueryByHash(e.queryHash);n||(n=e.queryCache.createQuery(e)),n!==t&&(this.previousQueryResult=this.currentResult,this.currentQuery=n,this.initialUpdateCount=n.state.updateCount,this.isStale=n.state.isInitialData?!(!e.keepPreviousData||!t)||("function"==typeof e.initialStale?e.initialStale():"boolean"==typeof e.initialStale?e.initialStale:void 0===n.state.data):n.isStaleByTie){var i=schedion(){for(vnt:0,isFetching:n===r.Loading,isFetchine.now()}}(e),this.scheduleGc()}var t=e.prototype;return t.updateConfig=function(e){this.config=e,this.cacheTime=Math.max(this.cacheTime,e.cacheTime)},t.dispatch=function(e){var t=this;this.state=function(e,t){var n;switch(t.type){case 0:return Object(o.a)({},e,{failureCount:e.failureCount+1});case 1:return Object(o.a)({},e,{failureCount:0,isFetching:!0,isFetchingMore:t.isFetchingMore||!1,status:void 0!==e.data?r.Success:r.Loading});case 2:return Object(o.a)({},e,{canFetchMore:t.canFetchMore,data:t.data,error:null,failureCount:0,isFetching:!1,isFetchingMore:!1,isInitialData:!1,isInvalidated:!1,status:r.Success,updateCount:e.updateCount+1,updatedAt:null!=(n=t.updatedAt)?n:Date.now()});case 3:return Object(o.a)({},e,{error:t.error,failureCount:e.failureCount+1,isFetching:!1,isFetchingMore:!1,status:r.Err});default:retur e=this;ais.cacheTimcancelFetch?(this.canceunction(){var e;n.observers.forEach((function(e){e.clearTimers()}))},t.clearGcTimeout=function(){this.gcTimeout&&(clearTimeout(this.gcTimeout),this.gcTimeout=void 0)},t.setData=function(e,t){var n,r,o=this.state.data,i=l(e,o);this.config.structuralSharing&&(i=v(o,i)),(null==(n=(r=this.config).isDataEtedAt:nulu.warn("reemove()},t.clearGcTime=function(){ret))},t.isStaleByTOnWindowFocuetchOnReconnect||n.rsubscribe=function(e){is.observers=ers.lengthe.isInvalidarror)||(n=n.catch(c)),n},t.fetchMore=function(e,t,n){return this.fetch({fetchMore:{fetchMoreVariable:e,previous:(null==t?void 0:t.previous)||!1}},n)},t.fetch=function(e,t){try{var n=!1,r=this;return A((function(){if(r.promise)return function(){return(null==e?void 0:e.fetchMore)&&r.state.data?N(r.cancel(!0)):(n=!0,r.promise)}()}),(functi?P(r.startInfiniteFetch(t,s,e),(function(e){n=e})):P(r.startFetch(t,s,e),(function(e){n=e}))}),(function(){return r.setData(n),delete r.promise,n}))}),(function(e){throw w(e)&&e.silent||r.dispatch({type:3,error:e}),w(e)||u.error(e),delete r.promise,e}))}))(),r.p(e)}},t.startFetch=function(e,t,n){return this.state.isFetching||this.dispatch({type:1}),this.tryFetchData(e,(function(){return e.queryFn.apply(e,t)}))},t.startInfiniteFetch=function(e,t,n){var r=null==n?void 0:n.fetchMore,o=r||{},i=o.previous,s=o.fetchMoreVariable,a=!!r&&(i?"previous":"next"),c=this.state.d 0===o&&void 0!==i&&e.getFetchMore&&(o=e.getFetchMore(i,n)),P(e.queryFn.apply(e,t.concat([o])),(function(e){return r?[e].concatchingMore:a}),this.tryFetchData(e,(function(){if(a)return u(c,i,s);if(c.length){for(var e=u(rn new Promise((function(r,o){var s,a,Fetch,delete n.cransportCancelable,null==s||s()},d=function(e){u(),o(e)};ntch=funn(){return x((function(){var e=t(typeof(null==e?void 0:e.cancel)}(e)&&(a=function(){try{e.cancel()}catch(e){}},n.isTransportCancelable=!0),P(e,(function(e){!function(e){u(),r(e)}(e)}))retryDelay;in(t){setTimeout(t,e)}))}(l(ction M(e,t){returnhMore(M(t,n),t))}var F=new(function(){function efunction(e,t){return t.state.isFetching?e+1:e}),0),_.batch((function(){t.globalListeners.(){n(t,e)}))cribe=fuobalListeners.filter((function(t){return t!==e}))}},t.clear=function(e){this.removeQueries(),(null==e?void 0:e.notify)&&this.notifyGlobalListeners()},t.getQueries=function(e,t){var n,r=!0===e||void 0===e;if(r&&!t)return this.queriesArray;if("function"==typeof e)n=e;else{var o=t||{},i=o.exact,s=o.active,a=o.stale,c=this.getResolvedQueryConfig(e);n=function(e){if(!r)if(i){if(e.queryHash!==c.queryHash)return!1}else if(!h(e.queryKey,c.quive()!==s||"boolean"==typeof a&&e.isStale()!==a)}}return this.querie!0})[0]},t.get(e.destroy(),delturn t!==e})),ththis.getQueries(e,t).forEach((function(e){n.removeQuery(e)}))},t.cancefunction(e){e.cancel()}))},t.invalidateQueries=function(e,t){var n=this.getQueries(e,t);_.batch((function(){n.forEach((function(e){e.invalidate()}))}));var r=t||{},i=r.refetchActive,s=void 0===i||i,a=r.refetchInactive,c=void 0!==a&&a;if(!c&&!s)return Promise.resolve(n);var u=Object(o.a)({},t);s&&!c?u.active=!0:c&&!s&&(u.active=!1);var l(e){var n=e.fetch().thern e}))),r.pudary=!1}))},t.eQuery=function(e){var t=new L(e);return this.config.frozen||(this.queries[t.queryHash]=t,this.queriesArray.push(t),this.notifyGlobalListeners(t)),t},t.fetchQuery=function(e,t,n){var r=g(e,t,n),i=r[1],s=this.getResolvedQueryConfig(r[0],Object(o.a)({retry:!1},i)),a=this.getQuer),i=o[0],s=o[1],a=o[2];(null==a?void 0:a.force)&&(s.staleTime=0);var u=this.fetchQuery(i,s);return(null==a?void 0:a.ction(e,t,n){var r=g(e,t{frozen:a}),B=[F];function U(e){p()ange""foif(!a&&(null==(t=window)?void 0:t.addEventListener))return window.addEventListener("online",e,!1),function(){window.removeEventListener("online",e)}}));var W=n("xARH=n("mXGw"),z=n.n(H),G=.a.useContext($)}var J=z.a.createContext(function(){var e=!1;return{clearReset:function(){e=!1},reset:function(){e=!0},isReset:function(){return e}}}());function X(){var e=z.a.useRef(!1),t=z.a.useCallback((function(){return e.current}),[]);return z.a[a?"useEffect":"useLayoutEffect"]((function(){return e.current=!0,function(){e.current=!1}}),[]),t}function K(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function Y(){return Object(o.a)({},C(r.Idle),{data:void 0,error:null})}function Z(e,t){switch(t.type){case 0:return Y();case 1:return Object(o.a)({},C(r.Loading),{data:void 0,error:null});case 2:return Object(o.a)({},C(r.Success),{data:t.data,error:null});case 3:return Object(o.a)({},C(r.Error),{data:void 0,error:t.error});default:return e}}function ee(e,t){void 0===t&&(t={});var n=function(e,t,n){var r=e.getDefaultConfig();return Object(o.a)({},k.mutations,null==r?void 0:r.shared,null==r?void 0:r.mutations,null==t?void 0:t.shared,null==t?void 0:t.mutations,n)}(V(),Q(),t),r=z.a.useReducer(Z,null,Y),i=r[0],a=function(e){var t=X();return z.a.useCallback((function(){if(function(){for(var t=[],n=0;n<arguments.length;n++)tturn Promise.resolve(eromise.reject(e)}}}((function(e,t){void 0===t&&(t={});var n=d.current,r=function(){return s++}();c.current=r;var o,i=function(){return c.current===r};return function(r,s){try{var c=function(){return a({type:1}),K(null==n.onMutate?void 0:n.onMutate(e),(function(r){return o=r,K((0,l.current)(e),(function(r){return i()&&a({type:2,data:r}),K(null==n.onSuccess?void 0:n.onSuccess(r,e),(function(){return K(null==t.onSuccess?void 0:t.onSuccess(r,e),(function(){return K(null==n.onSettled?void 0:n.onSettled(r,null,e),(function(){return K(null==t.onSettled?void 0:t.onSettled(r,null,e),(function(){return r}))}))}))}))}))}))}()}catch(e){return s(e)}return c&&c.then?c.then(void 0,s):c}(0,(function(r){return u.error(r),K(null==n.onError?void 0:n.onError(r,e,o),(function(){return K(null==t.onError?void 0:t.onError(r,e,o),(function(){return K(null==n.onSettled?void 0:n.onSettled(void 0,r,e,o),(function(){return K(null==t.onSettled?void 0:t.onSettled(void 0,r,e,o),(function(){if(i()&&a({type:3,error:r}),t.throwOnError||n.throwOnError)throw r}))}))}))})ct((function(){var e=d.current;if((e.useErrorBoundary||e.suspense)&&i.error)throw i.error}),[i.error]);var f=z.a.useCallb0})}),[a]);return[h,Object(,n){var r=g(e,t,n);return function(e,t){var n=z.a.useReducer((function(e){return e+1}),0)[1]t),c=z.a.useRef(),u=!c.current,l=c.current||new j(a);c.current=l,z.a.useEffect((function(){return s.clearReset(),l.subscribe((function(){r()&&n()}))}),[r,l,n,s]),u||l.updateConfig(a);var d=l.getCurrentResult();if(a.suspense||a.useErrorBoundary){var h=l.getCurrentQuery();if(d.isError&&!s.isReset()&&h.state.throwInErrd.error;if(a.enabled&&a.suspense&&!d.isSuccess){s.clearReset();var f=l.subscribe();throw l.fetch().finally(f)}}return d}(r[0],r[1])}!function(e){S=e}(q)},B7gc:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("lUkk"),o=n("mXGw"),i=n("bcUD"),s=n("u9fO"),a=n("XlCq"),c=n("lJoY"),u=n("vaZn"),l=function(e){var t=Object(u.a)(),n=function(e){var t=function(){var e=function(){var e=Object(c.a)();return"Pwa"===(null==e?void 0:e.route)?"cmm8gnwxv06":"cmmhect(o.useMemo)((function(){return Object(s.a)(a.b,"ocid",e)}),[e])}(),n=Object(i.a)({experiences:[e]}),r=Object(o.useCallback)((function(){n&&n(e,t)}),[e,n,t]);return Object(o.useMemo)((function(){if(n)return r}),[r,n])}(e),l=Object(o.useCallback)((function(e){Object(r.a)({type:"Click",id:"StorageErrorUpsell",area:"Upsell",subArea:e,result:"Navigate",target:"Other",eventName:"StorageError_Upsell"}),n&&n()}),[n])ationRedirection="locationRedirection",e.fluidInvalidSchema="fluidInvalidSchema",e.usageError="usageError",e.fileIsLocked="fileIsLocked"}(r||(r={}))},BaIZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("z+rT"),o=n("GeVZ");function i(e,t,n){if(!e||!t||!t.length)return e;var i={},s=Object(o.a)(e);if(!s)return e;var a=s.protocol,c=s.hostname,u=s.p1).split("&").forEach((function(e){var r=e.split("="),o=n?decodeURIComponent(r[0]):r[0];t.some((function(e){return e.toLowerCase()===o.toLowerCase()}))||(i[o]=n?decodeURIComponent(r[1]):r[1])})),Object(r.a)(a+"//"+c+u+d,i,!1)}},BhFD:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("B5kz"),o=n("QjXU"),i=n("a3FV"),s=n("CRHC"),a=n("m32Q"),c=n("lkvL"),u=n("CMIS"),l=n("Wa5Y"),d=n("i3m/"),h=n("V1Qu"),f="vroom-fluid-enabled-api";function p(e){return Object(r.c)(["FluidEnabled"],(function(){return function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t,n,r,p=this;return Object(o.__generator)(this,(function(m){return e?(t="".concat(Object(h.e)(e.sharePointResourceId,e,!1,!0),"/").concat(d.b,"root/opStream/fluidEnabled"),n={headers:{accept:"application/json",Prefer:"allow-zerobyte",application:"officehome"}},r=new Promise((function(r,o){Object(l.a)(i.a.VroomGetFluidEnabled,"Vroom_Get_Fluid_Enabled",t,n,!!e.jwtAuthEnabled,e.getAccessToken,e.officeHomeApiRoot,e.correlationId,"SharePoint",{resourceUrl:e.sharePointResourceId}).then((function(e){e&&e.data?r(e.data.isFluidEnabled):o({clientError:"Invalid response returned for Vroom get Fluid enabled request"})})).catch((function(e){Object(u.a)({eventName:"Vroom_Get_Fluid_Enabled_Error",errorType:"Vroom_Get_Fluid_Enabled_Error",message:(null==e?void 0:e.message)||"",debugInfo:(null==e?void 0:e.stack)||""}),o(e)}))})),[2,Object(s.a)((function(){return r}),(function(){return Object(a.a)({userId:e.userId,collectionName:f,collectionVersion:1,key:e.userId})}),(function(t){return Object(o.__awaiter)(p,void 0,void 0,(function(){return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(c.a)({userId:e.userId,collectionName:f,collectionVersion:1,key:e.userId,data:t})];case 1:return n.sent(),[2]}}))}))}))]):[2,Promise.reject("vroomApiOptions not defined")]}))}))}(esMap,a=s?o(s):r;e.exports=a},Bq5F:function(e,t){e.exports=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}},"C/Hs":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=window.performance},C2Jl:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("slmW");function o(e){if(e.fileType&&!e.isEmailAttachment&&e.canonicalUrl){var t=Object(r.a)(e.fileType);if(t){var n=e.canonicalUrl.lastIndexOf("?"),o=e.canonicalUrl;return n>0&&(o=e.canonicalUrl.substring(0,n)),"".concat(t).concat(o)}}}},CDFH:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("QjXU"),o=n("mgFK");function i(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return t.isMsa?[4,Object(o.a)("workloadPublicData",e)]:[2,null];case 1:return[2,n.sent()||null]}}))}))}},CDuu:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("MJsD"),o=n("B5kz"),i=n("gCKw"),s=n("mJgL"),a=n("W7wX"),c=n("s1V1"),u=n("ohjr"),l=n("8VPm");function d(e){var t=[e.key];return Object(o.c)(t,(function(){var t={featureGatesPromise:Object(i.a)(),featureSettingsPromise:Promise:Object(a.a)()};return Object(u.a)(t,e)}),l.a)}},CIBY:function(e,t,n){var r=n("V2ZB"),o=n("B4/L");e.exports=function(e,t){return r(e,o(e),t)}},CIUO:function(e,t,n){var r=n("s3t7"),o=n("T9Ud");e.exports=function(e){return o(e)&&"[object Map]"==r(e)}},CPLO:function(e,t,n){var r=n("zlak"),o=n("TsNJ"),i=n("DhoL"),s=i&&i.isSet,a=s?o(s):r;e.exports=a},CRHC:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("QjXU");function o(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,i,s,a;return Object(r.__generator)(this,(function(r){return o=e(),i=t(),s=i.then((function(e){return e?{result:e,fromPersistence:!0}:null}),(function(){return null}))turn n(e),{result:e,fromPersistence:!1}})),[2,Promise.race([s,a]).then((function(e){return e||a}),(function(){return s.then((function(e){return e||a}))}))]}))}))}},CU8J:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("NrNW"),o=n("B5kz"),i=n("CaQ9"),s=n("XcEc");function a(){var e=Object(r.a)().data,t=Object(i.a)().data;return Object(o.c)(["FeatureGates"],(function(){return Object(s.a)(t,e)}),{staleTime:1/0,cacheTime:1/0,enabled:e&&t})}},CaQ9:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("NrNW"),o=n("B5kz");function i(){var e=Object(r.a)().data;return Object(o.c)(["Identity"],(function(){return e.getIdentity()}),{cacheTime:1/0,staleTime:1/0,enabled:!!e})}},Cd0O:function(e){e.exports=JSON.parse('{"ig-ng":"en","qut-gt":"es","tg-cyrl-tj":"ru","ti-et":"am","wo-sn":"fr-ca","yo-ng":"fr","pt":"pt-br","ca-valencia":"ca-es-valencia","uz":"uz-latn-uz","zh-tw":"zh-hant","aa-dj":"ar","aa-er":"ar","aa-et":"am","af-za":"af","agq-cm":"fr","ak-gh":"en-gb","ak":"en-gb","sq":"en-gb","sq-al":"en-gb","sq-xk":"en-gb","sq-mk":"en-gb","gsw":"fr","gsw-fr":"fr","ast":"en-gb","ast-es":"en-gb","asa":"en-gb","asa-tz":"en-gb","ksf":"fr","ksf-cm":"fr","bm":"fr","bm-latn-ml":"fr","bn":"en-gb","bn-in":"en-gb","bas-cm":"fr","bas":"fr","ba-ru":"ru","ba":"ru","be":"ru","be-by":"ru","bem":"en-gb","bem-zm":"en-gb","bn-bd":"bn-in","byn":"ar","byn-er":"ar","brx":"as","brx-in":"as","br":"fr","br-fr":"fr","my-mm":"en-gb","my":"en-gb","tzm":"ar","tzm-arab-ma":"ar","tzm-latn-ma":"ar","tzm-latn-dz":"ar","tzm-tfng":"ar","tzm-tfng-ma":"ar","ku-arab":"ar","ku":"ar","ku-arab-iq":"ar","ce-ru":"ru","ce":"ru","cgg-ug":"en-gb","cgg":"en-gb","zh-hans-hk":"zh-hans","zh-hans-mo":"zh-hans","zh-cn":"zh-hans","zh-sg":"zh-hans","zh-hk":"zh-hant","zh-mo":"zh-hant","cu-ru":"ru","cu":"ru","ksh":"de","ksh-de":"de","kw":"en-gb","kw-gb":"en-gb","co":"fr","co-fr":"fr","dua":"fr","dua-cm":"fr","ee":"en-gb","ee-gh":"en-gb","ee-tg":"fr","ewo":"fr","ewo-cm":"fr","fo":"da","fo-dk":"da","fo-fo":"da","fi":"en-gb","fi-fl":"en-gb","fur":"it","fur-it":"it","ff":"fr","ff-latn-sn":"fr","gn":"es","gn-py":"es","ha":"fr","ha-latn-ne":"fr","ha-latn-ng":"fr","jv":"id","jv-latn-id":"id","dyo":"fr","dyo-sn":"fr","kea":"pt-pt","kea-cv":"pt-pt","kab":"fr","kab-dz":"fr","kl-gl":"da","kk":"ru","kk-kz":"ru","km":"km-kh","quc-latn-gt":"es","sw-cd":"fr","sw":"fr","sw-tz":"fr","sw-ug":"fr","khq-ml":"fr","khq":"fr","ses":"fr","ses-ml":"fr","nmg":"fr","nmg-cm":"fr","ky":"ru","ky-kg":"ru","ln":"pt-pt","ln-ao":"pt-pt","ln-cf":"fr","ln-cd":"fr","ln-cg":"fr","dsb":"de","dsb-de":"de","lu":"fr","lu-cd":"fr","mgh":"pt-pt","mgh-mz":"pt-pt","mg":"fr","mg-mg":"fr","arn-cl":"es","mzn-ir":"fa","mgo-cm":"fr","mgo":"fr","mn-mong-cn":"zh-hans","mn-mong-mn":"ru","mn":"ru","mfe":"fr","mfe-mu":"fr","nnh":"fr","nnh-cm":"fr","jgo":"fr","jgo-cm":"fr","nqo":"fr","nqo-gn":"fr","lrc-iq":"ar","no":"nb-no","nb":"nb-no","nn":"nn-no","om-et":"am","om":"am","om-ke":"am","os-ge":"ru","os":"ru","os-ru":"ru","pap":"nl","pt-cv":"pt-pt","pt-gw":"pt-pt","pt-mo":"pt-pt","pt-mz":"pt-pt","pt-st":"pt-pt","pt-tl":"pt-pt","quz":"es","quz-bo":"es","ssy":"ar","ssy-er":"ar","sah":"ru","sah-ru":"ru","se":"fi","smn-fl":"fi","smj-no":"nb-no","sma-no":"nb-no","sg-cf":"fr","seh-mz":"pt-pt","sr":"sr-latn-rs","sr-cyrl":"sr-cyrl-rs","sr-cyrl-xk":"sr-cyrl-rs","sr-cyrl-me":"sr-cyrl-rs","sr-latn":"sr-latn-rs","sr-latn-xk":"sr-latn-rs","sr-latn-me":"sr-latn-rs","st-za":"af","so-et":"am","so-so":"ar","zgh-tfng-ma":"ar","zgh-tfng":"ar","gsw-ch":"fr","shi":"ar","shi-latn-ma":"ar","shi-Latn":"ar","twq":"fr","twq-ne":"fr","bo":"zh-hans","bo-cn":"zh-hans","tig":"ar","tig-er":"ar","ti-er":"ar","tk":"ru","tk-tm":"ru","hsb":"de","hsb-de":"de","uz-cyrl":"uz-latn-uz","uz-cyrl-uz":"uz-latn-uz","ve-za":"en-gb","ve":"en-gb","wo":"fr","ts-za":"af","ts":"af","yav-cm":"fr","ii":"zh-hans","ii-cn":"zh-hans","yo":"fr","yo-bj":"fr","dje":"fr","dje-ne":"fr"}')},Chmn:function(e,t){e.exports=function(e){return this.__data__.get(e)}},Chyi:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n("P1B7"),o=n("m32Q"),i=n("lkvL"),s=n("8wW2"),a=n("a3FV"),c=n("Wa5Y"),u=n("zPk6"),l=n("fNDz"),d="oneDriveInfo";function h(e,t,n,h){var f={graphApiRoot:n.graphApiRoot,correlationId:e.correlationId,getAccessToken:e.getAccessToken,jwtAuthEnabled:e.jwtAuthEnabled,officeApiRoot:e.officeHomeApiRoot};return Object(r.a)((function(){return function(e,t){var n=Object(l.a)(e.graphApiRoot,"me/drive",!1);return t?Promise.resolve({driveId:"",driveUrl:""}):Object(c.a)(a.a.OneDriveGraphMyDriveInfoRequest,"OneDrive_Graph_MyDriveInfo",n,{method:"GET"},e.jwtAuthEnabled,e.getAccessToken,e.officeApiRoot,e.correlationId,"Graph",{populateRequestEvent:function(e,t){t.RequestId=Object(u.a)(e)||""}}).then((function(e){var t=e.data,n=t?t.id:"";return n?{driveId:n,driveUrl:t?t.webUrl:""}:null})).catch((function(e){return Object(s.a)().handleError(e,"m01Uz"),null}))}(f,e.inMockMode)}),(function(){return Object(o.a)({userId:t.puid,collectionName:d,collectionVersion:1,key:d})}),(function(e){return Object(i.a)({userId:t.puid,collectionName:d,collectionVersion:1,key:d,data:e})}),h)}},"Coo+":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}CaQ9"),s=n("+vVg"),a=n("bIL4");function c(){var e=Object(r.a)().data,t=Object(i.a)().data;return Object(o.c)(a.b,(function(){return Object(s.a)(t,e)}),{staleTime:1/0,cacheTime:1/0,enabled:e&&t})}},Cqxz:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("QjXU");function o(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,t()];case 1:return(o=r.sent())?[2,{result:o,fromPCzB4:fueTrial",e[e.NonActive=7]="NonActive",e[e.NotSubscribed=8]="NotSubscribed",e[e.NotDetected=9]="NotDetected",e[e.O365Basic=10]="O365Basic"}(r||(r={}))},D317:function(e,t,n){"uset";function r(e){return new Promise((t=>setTimeout((()=>t()),e)))}function o(e,t){const n=r(e).then((e=>!0)),o=t.map((e=>e.then((e=>!1)).catch((e=>!1))));return Promise.race([n,...o])}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}))},"DCX/":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("QjXU"),o=n("28zg"),i=n("ddw+");functionwnProntain,Dh2Ys,a=function(){try{return i&&i.require&&i.require("util").types||s&&s.binding&&s.binding("util")}catch(e){}}();e.exports=a}).call(this,n("RoC8")(e))},DvUI:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("4PWS"),o={office_calendar:"Calendar",office_create:"Create",office_excel:"ExcelOnline",office_cluid:"Fluid",office_forms:"OfficeForms",office_mail:"Mail",office_mycontent:"MyContent",office_feed:"Feed",office_ondrive:"Documents",office_onenote:"OneNoteOnline",office_outlook:"Mail",office_powerbi:"PowerBIv2",office_powerpoint:"PowerPointOnline",office_project:"Project",office_sharepoint:"Sites",office_skype:"Skype",office_sway:"Sway",office_teams:"SkypeTeams",office_visio:"VisioOnline",office_word:"WordOnline",park:"Park"};function i(e){if(!e)return"";var t=o[e];return null!=t?t:e}o[r.a.admin]="AdminPortal",o[r.a.appgallery]="AppGallery",o[r.a.calendar]="Calendar",o[r.a.clipchamp]="Clipchamp",o[r.a.create]="Create",o[r.a.excel]="ExcelOnline",o[r.a.familysafety]="FamilySafety",o[r.a.feed]="Feed",o[r.a.forms]="OfficeForms",o[r.a.home]="OfficeDotCom",o[r.a.lists]="Lists",o[r.a.mycontent]="MyContent",o[r.a.onedrive]="Documents",o[r.a.onenote]="OneNoteOnline",o[r.a.outlook]="Mail",o[r.a.people]="People",o[r.a.powerautomate]="LogicFlows",o[r.a.powerpoint]="PowerPointOnline",o[r.a.skype]="Skype",o[r.oDo",line"},E02R:function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},E7Xw:function(e,t){e.exports=function(){return[]}},E7ar:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("tjsK");function o(e){try{return function(e){var t=document.getElementById(e),n=t&&t.textContent;return n?JSON.parse(n):void 0}(e)}catch(t){throw new r.a("Failure to parse "+e+" from response",t)}}},ECCN:function(e,t,n){"use strict";n.dfunction o(){var e;return!("1"!==(null===(e=Object(r.a)())||void 0===e?void 0:e.FluidDebugger))}},EN0E:function(e,t,n){var r=n("/5e1")();e.exports=r},EXRb:function(e,t,n){"use strict";function r(e,t,n,r){if(void 0===t&&(t="officestartresources"),e&&t&&n&&r)return"https://".concat(e,"/").concat(t,"/").concat(n,".").concat(r)}n.d(t,"a",(function(){return r}))},Ea7i:function(e,t,n){"use strict";n.d(t,"a",(function(){return Be}));var r=n("QjXU"),o=n("DCX/"),i=n("MJsD"),s=n("QLkI"),a=n("6ib3"),c=n("OEfX"),u=n("B5kz"),l=n("W7wX"),d=n("P1B7"),h=n("m32Q"),f=n("lkvL"),p=n("8wW2"),m=n("a3FV"),g=n("Wa5Y"),v=n("zPk6"),b=n("fNDz"),y=/^https?:\/\/(.(?!\/))*.\//i,w="oneDriveRootUrl";function C(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t,n,o,a;return Object(r.__generator)(this,(function(c){switch(c.label){case 0:return[4,Promise.all([Object(i.a)(),Object(l.a)(),Object(s.a)()])];case 1:return e=r.__read.apply(void 0,[c.sent(),3]),t=e[0],n=e[1],[2,u.a.fetchQuery(a=["GraphMyDriveRootUrls"],(function(){return function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i;return Object(r.__generator)(this,(function(r){return i={graphApiRoot:n.graphApiRoot,correlationId:e.correlationId,getAccessToken:e.getAccessToken,jwtAuthEnabled:e.jwtAuthEnabled,officeApiRoot:e.officeHomeApiRoot},[2,Object(d.a)((function(){return function(e,t,n){var r=Object(b.a)(e.graphApiRoot,"me/drive/root",!1);return n?Promise.resolve({tenantRoot:"",userRoot:""}):Object(g.a)(m.a.OneDriveGraphMyDriveRootURLRequest,"OneDrive_Graph_MyDriveRootURL",r,{method:"GET"},e.jwtAuthEnabled,e.getAccessToken,e.officeApiRoot,e.correlationId,"Graph",{populateRequestEvent:function(e,t){t.RequestId=Object(v.a)(e)||""}}).then((function(e){var n=e.data,r=null,o=n?n.webUrl:null;if(!o)throw new Error((null==e?void 0:e.statusText)||"userOneDriveRootUrl empty");if(!t){var i=y.exec(o);i&&i.length&&(r=i[0])}return{tenantRoot:r,userRoot:o}})).catch((function(e){throw Object(p.a)().handleError(e,"m01Uz"),new Error("Failed to fetch graphDriveItem")}))}(i,t.isMsa,e.inMockMode)}),(function(){return Object(h.a)({userId:t.puid,collectionName:w,collectionVersion:1,key:w})}),(function(e){return Object(f.a)({userId:t.puid,collectionName:w,collectionVersion:1,key:w,data:e})}),o)]}))}))}(t,n,o,(function(e){return u.a.setQueryData(a,e)}))}),{staleTime:1/0,cacheTime:1/0,enabled:(o=e[2])&&o.graphApiRoot})]}}))}))}var O=n("YKlt"),T=n("Y/GB"),S=n("/Oio"),k=n("7LW7"),E=n("s1V1"),_=n("bb9Y"),j=[a.a.Excel,a.a.Visio],I=[a.a.Visio],N=n("RV7E"),A=function(e){switch(e.resultType){case"OpenNewDocFailed":Object(N.c)({category:"CreateFile",error:"OpenNewDocFailed",fileType:e.fileType,fallbackSiteUrl:e.documentWebUrl});break;case"OpenBlockedByPopupBlocker":Object(N.c)({category:"CreateFile",error:"OpenBlockedByPopupBlocker",fileType:e.fileType,fallbackSiteUrl:e.documentWebUrl});break;default:Object(N.c)({category:"CreateFile",error:"Generic",fileType:e.fileType})}},P=n("UDoG"),x=n("CMIS"),D=n("nLxx"),L=n("skfY"),M=n("z+rT");function R(e){return Object(x.a)({eventName:"Docaspx_Creation_Failure",debugInfo:e||"getDocAspxApiUrl failed"}),""}function F(e){var t=e.candidate,n=e.options,o=e.startTime,i=e.template,s=e.enterpriseDriveId;return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,a,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(!(t&&t.docAspxId&&n.componentContext&&n.userEntitlements))throw new P.a("Invalid docaspx params","Error");if(e=Object(D.a)(n.componentContext.workload,n.componentContext.router.getCurrentRoute(),t.createDocAspxEnabled,!!i),a=function(e,t,n,r,o,i){var s,a,c,u,l,d;if(!r.myDriveRootUrls||!r.myDriveRootUrls.userRoot)return R("Failed to get doclib url. myDriveRootUrls is undefined");var h=r.myDriveRootUrls.userRoot,f=h.lastIndexOf("/Documents");if(-1===f)return R("docliburl not in expected format");var p=h.substring(0,f),m="".concat(p,"/_layouts/15/doc.aspx?action=editnew&doctype=").concat(e,"&wdOrigin=").concat(t,"&docliburl=").concat(h,"&ct=").concat(n);o&&(m+=i?"&templateDriveId=".concat(i,"&templateItemId=").concat(o):"&wdTpl=".concat(o)),(o||(null===(s=r.templatesConfig)||void 0===s?void 0:s.createLcidEnabled))&&(m+="&wdlcid=".concat(null!==(c=null===(a=r.sharedContext)||void 0===a?void 0:a.officeMarketLcid)&&void 0!==c?c:""));var g=null===(u=r.capabilities)||void 0===u?void 0:u.scenarioId;return g&&(m+="&wdscenarioid=".concat(g)),(null===(l=r.capabilities)||void 0===l?void 0:l.outgoingLoginHintEnabled)&&(null===(d=r.identity)||void 0===d?void 0:d.loginHint)&&(m+="&login_hint=".concat(encodeURIComponent(r.identity.loginHint))),r.referralParams&&(m=Object(M.a)(m,r.referralParams)),m}(t.docAspxId,e,o,n,i?i.AssetId:void 0,s),!Object(L.a)(a))throw new P.a("Invalid docaspxApiUrl","Error");return[4,n.componentContext.getAccessToken("OneDrive",!1,n.userEntitlements.OneDriveResourceId)];case 1:if(!(c=r.sent())||!c.success)throw new P.a("Invalid accessToken","Error");return[2,{apiUrl:a,accessToken:c}]}}))}))}function B(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,o,i,s,a,c,u,l,d,h;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:t=e.startTime,n=e.instrumentCallback,o=e.options.targetTab,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,F(e)];case 2:if(i=r.sent(),s=i.apiUrl,a=i.accessToken,c=void 0,o?(o.document.write("<!doctype html>\n<html>\n<head>\n</head>\n<body>\n</body>\n</html>\n"),c=o.document):c=document,u='<form id="create-new-doc-form" method="post" action="APIURL" style="display: none;" target="_top"><input id="create-new-doc-token" name="access_token" value="ONEDRIVETOKEN" /></form>'.replace("APIURL",s).replace("ONEDRIVETOKEN",a.token),c.body.insertAdjacentHTML("beforeend",u),l=c.getElementById("create-new-doc-form"))return d=Date.now()-t,n&&n(d),l.submit(),[2,Promise.resolve({type:"GoToBlankDoc"})];throw new P.a("Form element not found","Error");case 3:return h=r.sent(),Object(x.a)({eventName:"Docaspx_Creation_Failure",debugInfo:(null==h?void 0:h.message)||"docaspx failed"}),[2,Promise.reject({type:"Error"})];case 4:return[2]}}))}))}var U=n("frjS");function W(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,i,s,a,c,u,l,d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return o=e.capabilities,s=e.componentContext,a=e.userEntitlements,c=e.targetTab,u=e.newDocLinkTarget,(i=e.identity)&&s&&a?((null==i?void 0:i.isOrgId)&&!n?(d=t?"&referrerScenario=".concat(t):"",l="".concat(a.OneDriveResourceId,"/_layouts/15/videoeditor.aspx?action=create&referrer=OfficeHome&cid=").concat(s.correlationId).concat(d),(null==o?void 0:o.outgoingLoginHintEnabled)&&(null==i?void 0:i.loginHint)&&(l+="&login_hint=".concat(encodeURIComponent(i.loginHint)))):n&&(null==i?void 0:i.isMsa)&&(l="https://app.clipchamp.com/login/microsoft?content=".concat(n.AssetId,"&utm_source=harmony")),l&&Object(L.a)(l)?[4,Object(U.a)(l,c,u)]:[2,{type:"Error"}]):[2,{type:"Error"}];case 1:return[2,r.sent()]}}))}))}var q=n("mgFK");function H(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(i.a)()];case 1:return e=t.sent(),[2,u.a.fetchQuery(["FormsConfig"],(function(){return function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(q.a)("formsConfig",e)];case 1:return[2,t.sent()]}}))}))}(e)}),{staleTime:1/0,cacheTime:1/0})]}}))}))}function z(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,H()];case 1:return n=r.sent(),e&&n&&t?[2,{componentContext:e,formsConfig:e(void 0)]}}))}))}var G=n("5ANk"),V=n("jwpY"),$=n("j7b/"),Q=n("Zmq1"),J=n("lbnC"),X=n("lwUs"),K=n("wYzw"),Y=n("0TX8");function Z(e,t){return e+"_"+t}function ee(){return[Object(X.a)(7*$.a)]}function te(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,s,a,c,p;return Object(r.__generator)(this,(function(v){switch(v.label){case 0:return[4,Promise.all([Object(i.a)(),Object(l.a)(),Object(k.a)()])];case 1:return o=r.__read.apply(void 0,[v.sent(),3]),a=o[1],c=o[2],[2,u.a.fetchQuery(p=["TemplateContentData",t,(s=o[0]).preferredCulture],(function(){return function(e,t,n,o,i,s,a){var c;return Object(r.__awaiter)(this,void 0,void 0,(function(){var u,l,p,v,b=this;return Object(r.__generator)(this,(function(y){switch(y.label){case 0:return[4,Object(E.a)()];case 1:return u=y.sent().result,l=Object(Q.a)(),p={correlationId:i.correlationId,getAccessToken:i.getAccessToken,getIdentity:function(){return Promise.resolve(o)},inMockMode:i.inMockMode,jwtAuthEnabled:i.jwtAuthEnabled,workload:i.workload,officeHomeApiRoot:i.officeHomeApiRoot,app:e,templateId:t,templateBinaryUrl:n,templatesApiEndpoint:s.templatesApiEndpoint,officeMarket:i.preferredCulture,show:s.numTemplates-1,browserName:l.browser.browserType,flights:(null===(c=i.flights)||void 0===c?void 0:c.replace(/,\s*$/,""))||"",isPremium:!1,isIw:(null==u?void 0:u.IsIw)||!1,isAdmin:(null==u?void 0:u.IsAdmin)||!1,isSmb:(null==u?void 0:u.IsSmb)||!1,isEdu:(null==u?void 0:u.IsEdu)||!1,isEduFaculty:(null==u?void 0:u.IsEduFaculty)||!1,isEduStudent:(null==u?void 0:u.IsEduStudent)||!1,authId:o.isMsa?1:2,firstVisitAgeInWeeks:Math.floor(Object(K.a)()/7),page:"Create",deploymentEnvironment:i.deploymentEnvironment||"",osName:l.platform.platformType,osVersion:Object(J.a)(l.platformVersion)},v="templates-content-api-rc-"+Z(t,p.officeMarket),[2,Object(d.a)((function(){return function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=function(e){var t="&".concat("browserName=").concat(e.browserName,"&").concat("flights=").concat(e.flights,"&").concat("isIw=").concat(e.isIw,"&").concat("isAdmin=").concat(e.isAdmin,"&").concat("isSmb=").concat(e.isSmb,"&").concat("isEduFaculty=").concat(e.isEduFaculty,"&").concat("isEduStudent=").concat(e.isEduStudent,"&").concat("authId=").concat(e.authId,"&").concat("firstVisitAgeInWeeks=").concat(e.firstVisitAgeInWeeks,"&").concat("page=").concat(e.page,"&").concat("deploymentEnvironment=").concat(e.deploymentEnvironment,"&").concat("osName=").concat(e.osName,"&").concat("osVersion=").concat(e.osVersion);return"".concat(e.officeHomeApiRoot,"/").concat(e.templatesApiEndpoint+"/content","?").concat("app=").concat(e.app,"&").concat("culture=").concat(e.officeMarket,"&").concat("show=").concat(e.show,"&").concat("id=").concat(e.templateId,"&").concat("templateBinaryUrl=").concat(e.templateBinaryUrl,"&").concat("isEdu=").concat(e.isEdu).concat(t)}(e),[4,Object(Y.a)({},e.inMockMode,e.workload,e.getIdentity)];case 1:return n=r.sent(),[2,Object(g.a)(m.a.TemplateContentRequest,"Template_Content",t,n,e.jwtAuthEnabled,e.getAccessToken,e.officeHomeApiRoot,e.correlationId,"OfficeHome",{populateRequestEvent:function(t,n){t.ok?(n.ElementId=e.templateId,n.ItemCategory=e.app):n.HttpCode=700..toString()}}).then((function(e){if(!e||!e.data||!e.ok)throw new Error((null==e?void 0:e.statusText)||"Null response");if(!e.data.Application||!e.data.Content||!e.data.Content.Value)throw new Error("Invalid response");return{Value:e.data.Content.Value,Application:e.data.Application}})).catch((function(e){Object(x.a)({eventName:"Form_Content_Fetch_Error",message:e})}))]}}))}))}(p)}),(function(){var e=ee(),n=Object(r.__spreadArray)([],Object(r.__read)(e),!1).reverse();return Object(h.a)({userId:o.puid,collectionName:v,collectionVersion:1,key:Z(t,p.officeMarket),plugins:n})}),(function(e){return Object(r.__awaiter)(b,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=ee(),[4,Object(f.a)({userId:o.puid,collectionName:v,collectionVersion:1,key:Z(t,p.officeMarket),data:e,plugins:n})];case 1:return r.sent(),[2]}}))}))}),a)]}}))}))}(e,t,n,a,s,c,(function(e){return u.a.setQueryData(p,e)}))}),{staleTime:1/0,cacheTime:1/0,enabled:s&&a&&c})]}}))}))}var ne=n("GeVZ");function re(e,t,n,r){if(!e||!t)return e;var o={},i=Object(ne.a)(e);if(!i)return e;var s=i.protocol,a=i.hostname,c=i.path,u=i.search,l=i.hash;for(var d in"?"===u[0]&&u.substring(1).split("&").forEach((function(e){var t=e.split("=");n?o[decodeURIComponent(t[0])]=decodeURIComponent(t[1]):o[t[0]]=t[1]})),t)o[d]=t[d];return Object(M.a)(s+"//"+a+c+l,o,r)}function oe(e,t,n,r){var o=e.router.getCurrentRoute();return re(t,{route:r||(o&&o.route?o.route:void 0)},null!=n&&n)}var ie,se=n("Rh0W"),ae=n("sLEy"),ce="/Pages/MobileDesignPage.aspx",ue="/Pages/DesignPage.aspx",le=n("3vWs"),de=n("zP6S"),he=n("Ot9e"),fe=n("5eS3");function pe(e,t){var n=e.componentContext,r="prodprv"===n.deploymentEnvironment&&"scu"===n.geoName;return re(function(e,t){var n;if(e.userPrincipalName&&e.authType){var r={};r.auth_pvr=e.authType===le.a.OrgId?"OrgId":"WindowsLiveId",r.auth_upn=e.userPrincipalName,n=Object(de.a)(r)}if(!t||!n)return t;var o,i=Object(ne.a)(t);return i&&(o=Object(he.a)(null==i?void 0:i.search)),(null==o?void 0:o.pvrQueryName)||(null==o?void 0:o.upnQueryName)?t:Object(fe.a)(t,n)}(e.identity,e.formsConfig.formsCdnPath+(t?"/Pages/DesignPageV2.aspx":Object(se.a)()?ce:ue)),{origin:r?ae.b:ae.a,lang:n.preferredCulture,sessionId:n.sessionId},!1,!0)}function me(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,s,c,u,l,d,h,f;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t.TemplateBinaryUrl?(i=e.componentContext,s=e.formsConfig,c=function(e){return"00000000-0000-0000-".concat(e.slice(0,4),"-",e.slice(4))}(e.identity.puid),u=s.formsMsaTenantId,l=o||c,[4,te(a.a.Forms,t.AssetId,t.TemplateBinaryUrl)]):[2,Promise.reject("Invalid TemplateBinaryUrl")];case 1:return(d=r.sent().result)?(h=s.formsApiPath+function(e,t,n){return"".concat("/formapi/api","/").concat(e,"/").concat(t,"/").concat(n,"/light/forms")}(u,n,l),f={method:"POST",headers:{"content-type":"application/json","x-ms-form-request-source":"ms-startpage","x-usersessionid":i.sessionId,"x-correlationid":Object(G.a)(),"x-anchormailbox":"".concat(c,"@").concat(u)}},[2,Object(V.a)(m.a.FormCreateFormFromTemp,h,d.Value,f,i.jwtAuthEnabled,i.getAccessToken,i.officeHomeApiRoot,i.correlationId,"Forms",{populateRequestEvent:function(e,n){n.ElementId=t.AssetId}}).then((function(t){if((null==t?void 0:t.ok)&&(null==t?void 0:t.data))return function(e,t){var n=pe(e,!1);return n=re(n,{Action:"CreateByTemplate",Fragmd);throw new Error((null==t?void 0:t.statusText)||"Form create failed")})).catch((function(e){Object(x.a)({eventName:"Form_Create_Error",message:e})}))]):[2,void 0]}}))}))}function ge(e,t,n,o,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var s,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e!==a.a.Forms&&e!==a.a.FormsQuiz?[3,6]:[4,z(n.componentContext,n.identity)];case 1:return(s=r.sent())?(c=void 0,i?[4,me(s,i,ie.Users,void 0)]:[3,3]):[2,{type:"Error"}];case 2:return c=r.sent(),[3,4];case 3:if(!t.newDocName)return[2,{type:"Error"}];c=function(e,t,n,r,o){return function(e,t,n,r,o){var i="Create",s="CreateQuiz",c=function(e,t,n){return"Action=".concat(t,"&Title=").concat(e).concat(n?"&GroupId="+n:"")},u=pe(e,!1),l={Action:null,Fragment:null};return t===a.a.Forms?(l.Fragment=c(n,i,r),l.Action=i):(u=u.replace(ce,ue),l.Fragment=c(n,s,r),l.Action=s),u=re(u,l,!0),oe(e.componentContext,u,!0,o)}(e,t,n,{type:ie.Users}.identifier,o)}(s,e,t.newDocName,0,o),r.label=4;case 4:return c?[4,Object(U.a)(c,n.targetTab,n.newDocLinkTarget)]:[2,{type:"Error"}];case 5:return[2,r.sent()];case 6:return[2,{type:"Error"}]}}))}))}function ve(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t.componentContext&&t.userEntitlements&&t.userEntitlements.OneDriveResourceId?(o=n?"&referrerScenario=".concat(n):"",i="".concat(t.userEntitlements.OneDriveResourceId,"/_layouts/15/stream.aspx?action=create&referrer=OfficeHome&cid=").concat(t.componentContext.correlationId).concat(o),e===a.a.ScreenRecording&&(i+="&captureMode=screenrecorder"),Object(L.a)(i)?[4,Object(U.a)(i,t.targetTab,t.newDocLinkTarget)]:[2,{type:"Error"}]):[2,{type:"Error"}];case 1:return[2,r.sent()]}}))}))}function be(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(i.a)()];case 1:return e=t.sent(),[2,u.a.fetchQuery(["SwayConfig"],(function(){return function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(q.a)("swayConfig",e)];case 1:return[2,t.sent()]}}))}))}(e)}),{staleTime:1/0,cacheTime:1/0})]}}))}))}function ye(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,be()];case 1:return n=r.sent(),e&&n&&t?[2,{apiUrl:n.apiUrl,correlationId:null==e?void 0:e.correlationId,userPrincipalName:t.userPrincipalName||"",authType:t.authType,jwtAuthEnabled:e.jwtAuthEnabled,getAccessToken:e.getAccessToken,officeHomeApiRoot:e.officeHomeApiRoot}]:[2,Promise.resolve(void 0)]}}))}))}function we(e){var t="".concat(e.apiUrl,"/json/createStory"),n={headers:{"X-UserSessionId":e.correlationId,"X-OHP-CorrelationId":e.correlationId}};return Object(V.a)(m.a.SwayCreateRequest,"Sway_Create",t,{},n,e.jwtAuthEnabled,e.getAccessToken,e.officeHomeApiRoot,e.correlationId,"Sway").then((function(t){if(t&&t.data)return function(e,t){var n,r=t.authType,o=t.userPrincipalName;if(o&&r){var i={};i.auth_pvr=1===r?"OrgId":"WindowsLiveId",i.auth_upn=o,n=Object(de.a)(i)}if(!e||!n)return e;var s,a=Object(ne.a)(e);return a&&(s=Object(he.a)(null==a?void 0:a.search)),(null==s?void 0:s.pvrQueryName)||(null==s?void 0:s.upnQueryName)?e:Object(fe.a)(e,n)}(t.data.url,e);throw new Error((null==t?void 0:t.statusText)||"Could not parse Sway creation response")})).catch((function(e){throw Object(x.a)({eventName:"Sway_Create_Error",errorType:"Sway_Create_Error",message:e}),e}))}function Ce(e,t,n){var o;return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,s,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i="",s=!1,e.canCreateBlankDocument?[4,ye(t.componentContext,t.identity)]:[3,4];case 1:return(a=r.sent())?[4,we(a)]:[3,3];case 2:return i=r.sent(),[3,4];case 3:s=e.canFallbackToLandingPage,r.label=4;case 4:if((null===(o=t.identity)||void 0===o?void 0:o.isMsa)||s){if(!n||!n.url)return[2,{type:"Error"}];i=Object(fe.a)(n.url,"campaign=OHPCreateNew")}return i?[2,Object(U.a)(i,t.targetTab,t.newDocLinkTarget)]:[2,{type:"Error"}]}}))}))}!function(e){e.Users="users",e.Groups="groups"}(ie||(ie={}));var Oe=n("i+uS"),Te=n("fhoW"),Se=n("Tqea"),ke=n("O/XG");function Ee(e,t,n,o,i,s){var a,c,u,l;return Object(r.__awaiter)(this,void 0,void 0,(function(){var d,h,f,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),t?(d=Object(Se.a)(e.fileType),h={canonicalUrl:t.canonicalUrl,webUrl:t.webUrl,app:d,attribution:t.canonicalUrl,url:t.canonicalUrl,extension:null!==(a=e.fileExtension)&&void 0!==a?a:"",title:null!==(c=t.fileName)&&void 0!==c?c:"",id:t.docId||"",fileType:e.fileType,isRedeemed:!0},[4,Object(ke.a)({action:"OpenDocument",document:h,useWebUrl:!0,wdOriginType:"NEW",newContentParams:i?{templateItemId:i.AssetId,templateDriveId:s,templateBinaryUrl:i.TemplateBinaryUrl}:void 0,linkTarget:n?"_top":o,targetTab:null!=n?n:void 0})]):[3,2];case 1:if(!(f=r.sent()).result||"OpenNull"===f.result||"OpenUndefined"===f.result)throw new P.a("Open blocked by pop-up blocker for the newly created ".concat(d," file."),"OpenBlockedByPopupBlocker");if(!f.success)throw new P.a(null!==(u=f.message)&&void 0!==u?u:"Failed to launch newly created ".concat(d," file."),"OpenNewDocFailed");r.label=2;case 2:return[3,4];case 3:return p=r.sent(),[2,Promise.resolve({type:null!==(l=p.type)&&void 0!==l?l:"OpenNewDocFailed",documentWebUrl:t.webUrl,fileType:e.fileType})];case 4:return[2,Promise.resolve({type:"GoToBlankDoc"})]}}))}))}function _e(e,t,n,o,i,s,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var c,u,l,d;return Object(r.__generator)(this,(function(r){switch(r.labction(e){return{correlationId:e.correlationId,getAccessToken:e.getAccessToken,jwtAuthEnabled:e.jwtAuthEnabled,officeHomeApiRoot:e.officeHomeApiRoot}}(n.componentContext),r.label=1;case 1:return r.trys.push([1,5,,6]),[4,Object(Te.a)(u,c,!1,e)];case 2:return!(l=r.sent())||function(e){return void 0!==e.links}(l)?[2,{type:"Error"}]:[4,Object(Oe.b)(l,o,n.componentContext,n.sharedContext,i?i.AssetId:"",n.templatesConfig,n.capabilities,n.referralParams)];case 3:return d=r.sent(),a&&l.parentReference&&(d.docId=l.id,d.driveId=l.parentReference.driveId,d.fileName=l.name),[4,Ee(t,d,n.targetTab,n.newDocLsent(),[3,6];case 6:return[2,{type:"Error"}]}}))}))}var je=n("qyk8");function Ie(e,t){var n=function(e){return"LicenseStatus_"+e.toLocaleLowerCase()}(e);return u.a.fetchQuery(n,(function(){return function(e,t){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var n,o,s,a,c,u,d;return Object(r.__generator)(this,(function(h){switch(h.label){case 0:return e&&t?[4,Promise.all([Object(i.a)(),Object(l.a)()])]:[2,Promise.resolve(void 0)];case 1:return n=r.__read.apply(void 0,[h.sent(),2]),o=n[0],s=n[1],a=Object(je.a)("{0}/api/license/data?app={1}&scenarioId={2}",o.officeHomeApiRoot,e,t),c={method:"GET",responseType:"json",url:a},[4,Object(Y.a)(c,o.inMockMode,o.workload,(function(){return Promise.resolve(s)}))];case 2:h.sent(),h.label=3;case 3:return h.trys.push([3,5,,6]),[4,Object(g.a)(m.a.OfficeLicensesFetch,"Office_Licenses_Fetch",c.url,c,o.jwtAuthEnabled,o.getAccessToken,o.officeHomeApiRoot,o.correlationId,"OfficeHome",{})];case 4:return u=h.sent(),[3,6];case 5:return h.sent(),[3,6];case 6:return u&&u.ok&&u.data?[2,u.data]:(d="Failed to get license status for app: ".concat(e,", scenarioId: ").concat(t),Object(x.a)({eventName:m.a.OfficeLicensesFetch,errorType:"Office_Licenses_Fetch_Error",message:"Failed to fetch license status",debugInfo:d}),[2,void 0])}}))}))}(e,t)}),{staleTime:1/0,cacheTime:1/0})}var Ne=function(e,t,n){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var o,i;return Object(r.__generator)(this,(function(s){switch(s.label){case 0:return I.includes(e)?t&&Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(t.coreAndSegmentApps),!1),Object(r.__read)(t.nonCoreAndSegmentApps),!1).find((function(t){return t.FileType===e}))?[2,!0]:n?[4,Ie(e,n)]:[2,!1]:[2,!0];case 1:return o=s.sent(),[2,null!==(i=null==o?void 0:o.IsLicensed)&&void 0!==i&&i]}}))}))},Ae=n("ZsNf");function Pe(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Object(Ae.a)({action:"OpenAppTile",appName:Object(Se.a)(e),url:""})];case 1:if(!(t=n.sent()).success)throw Error(t.message);return[3,3];case 2:return n.sent(),[2,Promise.resolve({type:"OpenNewDocFailed"})];case 3:return[2,Promise.resolve({type:"GoToLanding"})]}}))}))}var xe=n("mJu7"),De=n("gI4v"),Le=n("MgoT");function Me(e){return new Promise((function(t){Object(Le.c)({onResult:function(e,n){(function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o,i,s,c;return Object(r.__generator)(this,(function(r){return e?(n="".concat(De.b),o={displayName:t},i=e.inMockMode?e.officeHomeApiRoot:e.graphApiRoot,s=Object(b.a)(i,n,!1),c={headers:{category:"CreateFile",fileType:a.a.OneNote}},[2,Object(V.a)(m.a.OneNoteGraphCreateNoteBookRequest,"OneNote_Graph_Create_NoteBook",s,o,c,e.jwtAuthEnabled,e.getAccessToken,e.oationId,"Graph",{populateRequestEvent:function(e,t){t.RequestId=Object(v.a)(e)||""}}).then((function(t){if(t&&t.data&&!function(e){return"error"in e}(t)){var n=t.data;if(n&&n.links&&n.links.oneNoteWebUrl&&e.loginHint)return Object(xe.a)(n.links.oneNoteWebUrl.href,e.loginHint,e.loginHintEnabled);throw new Error(e.loginHint?"Invalid Notebook item returned":"Invalid loginHint provided in notebook creation")}throw new Error((null==t?void 0:t.statusText)||"Could not parse notebook item from Graph response")})).catch((function(e){return Object(x.a)({eventName:"OneNote_Graph_Create_NoteBook_Error",errorType:"OneNote_Notebook_Create_Error",message:e}),Promise.reject({clientError:"createNewNotebook Error: ".concat(e)})}))]):[2,Promise.reject({clientError:"Invalid createNewNotebookOptions"})]}))}))})(n,e).then((function(e){if(!e)return t({type:"Error"});Object(U.a)(e).then((function(e){return t(e)}))}))},lastFocusedHtmlElement:e})}))}var Re=n("rZux");function Fe(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:e&&t||Promise.resolve("Error"),r.label=1;case 1:return r.trys.push([1,3,,4]),n=Object(Se.a)(e),[4,Object(Re.a)(n,t)];case 2:if(!r.sent())throw new Error("Failed to launch newly created ".concat(n," file with template."));return[3,4];case 3:return r.sent(),[2,Promise.resolve({type:"OpenNewDocFailed"})];case 4:return[2,Promise.resolve({type:"GoToBlankDoc"})]}}))}))}function Be(e){var t,n=e.app,u=e.candidate,d=e.getOrUpdatePendingCreates,h=e.createLink,f=void 0===h?void 0:h,p=e.template,m=void 0===p?void 0:p,g=e.instrumentClick,v=void 0===g?void 0:g,b=e.errorCallback,y=void 0===b?A:b,w=e.enterpriseDriveId,I=void 0===w?void 0:w,N=e.linkTarget,P=void 0===N?void 0:N,x=e.area,D=void 0===x?void 0:x,L=e.lastFocusedHtmlElement;return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,h,p,g,b,w,N,A,x,M,R,F,q,H,z,G,V,$,Q,J,X;return Object(r.__generator)(this,(function(K){switch(K.label){case 0:return[4,Object(o.a)()];case 1:return e=K.sent(),h=null,e?(p=e.wacHostEnabled&&e.wacHostApps&&e.wacHostApps.has(n)&&(!I||e.wacHostOrgTemplatesEnabled),g=function(e,t,n){return e===a.a.Fluid||e===a.a.FluidActivityBlueprint||(null!=n?n:t)?"_self":"_blank"}(n,p,P),p||e.pwaEnabled||n===a.a.OneNote||(h=window.open("",g)),[4,Promise.all([Object(i.a)(),Object(k.a)(),Object(s.a)(),Object(l.a)(),C(),Object(_.a)()]).then()]):(v&&v("Error",f,m,0),[2,"Error"]);case 2:return b=r.__read.apply(void 0,[K.sent(),6]),w=b[0],N=b[1],A=b[2],x=b[3],M=b[4],R=b[5],[4,Object(E.a)()];case 3:return F=K.sent().result,n&&u&&A&&w?(q={},Object(c.b)(n)&&((q={})[T.b]=Object(O.a)(w.workload),q[T.a]=w.sessionId),H={getOrUpdatePendingCreates:d,componentContext:w,capabilities:e,templatesConfig:N,sharedContext:A,identity:x,myDriveRootUrls:null==M?void 0:M.result,referralParams:q,userEntitlements:F,targetTab:h,newDocLinkTarget:g},z=u.createDocAspxEnabled&&!p&&(w.workload===S.a.OfficeHome||w.workload===S.a.OfficeHomeReact),[4,Ne(n,R,e.scenarioId)]):(v&&v("Error",f,m,0),[2,"Error"]);case 4:if(G=K.sent(),"_self"===g&&d()>0)return[2,"CreatePending"];switch(V=Date.now(),$=!1,Q={type:"CreatePending"},d(1),n){case a.a.Excel:case a.a.Word:case a.a.PowerPoint:case a.a.Visio:return[3,5];case a.a.OneNote:return[3,17];case a.a.OneNotePage:return[3,19];case a.a.Sway:return[3,20];case a.a.Forms:case a.a.FormsQuiz:return[3,22];case a.a.Fluid:case a.a.FluidActivityBlueprint:return[3,24];case a.a.Stream:case a.a.ScreenRecording:return[3,25];case a.a.PlayLists:case a.a.PlayList:return[3,27];case a.a.Clipchamp:return[3,28];case a.a.Designer:return[3,30]}return[3,32];case 5:return G?e.pwaEnabled?m||!j.includes(n)?[3,7]:[4,Pe(n)]:[3,10]:[3,15];case 6:return Q=K.sent(),[3,9];case 7:return m?[4,Fe(n,null!==(t=null==m?void 0:m.TemplateBinaryUrl)&&void 0!==t?t:"")]:[3,9];case 8:Q=K.sent(),K.label=9;case 9:return[3,12];case 10:return z?[4,B({candidate:u,options:H,startTime:V,template:m,instrumentCallback:function(e){v&&v("GoToBlankDocInstant",f,m,e)},enterpriseDriveId:I})]:[3,12];case 11:"Error"!==(Q=K.sent()).type&&($=!0),K.label=12;case 12:return"CreatePending"!==Q.type&&"OpenNewDocFailed"!==Q.type&&"Error"!==Q.type?[3,14]:[4,_e(n,u,H,V,m,I,p)];case 13:Q=K.sent(),K.label=14;case 14:return[3,16];case 15:Q={type:"Error"},K.label=16;case 16:return[3,33];case 17:return[4,Me(L)];case 18:return Q=K.sent(),[3,33];case 19:return[3,33];case 20:return[4,Ce(u,H,f)];case 21:return Q=K.sent(),[3,33];case 22:return[4,ge(n,u,H,D,m)];case 23:return Q=K.sent(),[3,33];case 24:return[3,33];case 25:return[4,ve(n,H,D)];case 26:return Q=K.sent(),[3,33];case 27:return[3,33];case 28:return[4,W(H,D,m)];case 29:return Q=K.sent(),[3,33];case 30:return m?(J="https://designer.microsoft.com/?templateId=".concat(m.AssetId,"&correlationId=").concat(w.correlationId,"&referrer=harmony&utm_source=harmony&utm_medium=").concat(w.workload,"&utm_campaign=template"),[4,Object(U.a)(J,h,g)]):[3,32];case 31:Q=K.sent(),K.label=32;case 32:return[3,33];case 33:return d(-1),!$&&v&&v(Q.type,f,m),(X="Error"===(Q="CreatePending"!==Q.type?Q:{type:"Error"}).type||"OpenNewDocFailed"===Q.type||"OpenBlockedByPopupBlocker"===Q.type)&&function(e,t){e&&"_blank"===t&&e.close()}(h,P),y&&X&&y({resultType:Q.type,fileType:n,documentWebUrl:Q.documentWebUrl}),[2,Q.type]}}))}))}},"Eac/":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n("QjXU");function o(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return[2,window.crypto.getRandomValues(new Uint8Array(12))]}))}))}function i(e){return[e.slice(0,12),e.slice(12,e.byteLength)]}},Etsp:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Success="Success",e.Error="Error",e.InProgress="InProgress"}(r||(r={}))},Ez9J:function(e,t,n){"use strict";n.d(t,"f",(function(){return o})),n.d(t,"l",(function(){return a})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return h})),n.d(t,"e",(function(){return f})),n.d(t,"g",(function(){return p})),n.d(t,"h",(function(){return m})),n.d(t,"j",(function(){return g})),n.d(t,"i",(function(){return v})),n.d(t,"k",(function(){return b}));var r,o,i=n("pkel"),s=n("rUkc");function a(){return"object"==typeof navigator&&null!==navigator&&"boolean"==typeof navigator.onLine?navigator.onLine?o.Online:o.Offline:o.Unknown}!function(e){e[e.Offline=0]="Offline",e[e.Online=1]="Online",e[e.Unknown=2]="Unknown"}(o||(o={}));class c extends s.a{constructor(e,t,n){super(e,n),this.canRetry=t,this.errorType=i.a.genericNetworkError}}class u extends s.a{constructor(e,t){super(e,Object.assign(Object.assign({},t),{statusCode:400})),this.errorType=u.errorType,this.canRetry=!1}}u.errorType=null!==(r=i.a.deltaStreamConnectionForbidden)&&void 0!==r?r:"deltaStreamConnectionForbidden";class l extends s.a{constructor(e,t,n,r){super(e,r,new Set(["claims","tenantId"])),this.claims=t,this.tenantId=n,this.errorType=i.a.authorizationError,this.canRetry=!1}}class d extends s.a{constructor(e,t,n){super(e,n,new Set(["redirectUrl"])),this.redirectUrl=t,this.errorType=i.a.locationRedirection,this.canRetry=!1}}class h extends s.a{constructor(e,t,n,r){super(e,r),this.errorType=t,this.canRetry=n}}class f extends h{constructor(e,t,n){super(e,t,!1,n),this.errorType=t}}class p extends h{constructor(e,t,n){super(e,t,!0,n),this.errorType=t}}class m extends s.a{constructor(e,t,n){super(e,n),this.retryAfterSeconds=t,this.errorType=i.a.throtn g(e,t,n){return void 0!==t.retryAfterMs&&t.canRetry?new m(e,t.retryAfterMs/1e3,n):new  r=n(s=fun&e.deof wipCvA"))},FQMq:function(e,t,n){var r=n("QDPn"),o=n("LBQr"),i=n("jL4t");e.exports=function(e){return"function"!=typeof e.constructor||i(e)?{}:r(o(e))}},FR7j:function(e,t,n){"use stricteturn ):(a=rgumes)}n.d(t,"a",(function(){return r}))},FfeU:function(e,t,n){(function(t){e.exports="object"==typeof t&&t&&t.Object===Object&&t}).call(this,n("pCvA"))},Fjh8:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r=n("z1nA");function o(e,t){switch(e){case r.a.fixedByHost:t.style.height="100%",t.style.width="100%";break;case r.a.growHeight:t.style.width="100%";break;case r.a.grow:break;default:throw new Error(`Invalid layout mode "${e}"`)}}async function i(e,t,n,o){const i=t.style;if(e.document.documentElement.style.overflow="hidden",n===r.a.fixedByHost)i.position="absolute",i.top="0",i.bottom="0",i.left="0",i.right="0";else{n===r.a.growHeight&&(i.maxWidth="100%");const c=50;let u,l=!1,d=!1;const h=new ResizeObserver(s);function s(){const e=n===r.a.growHeight?{h:t.clientHeight}:{h:t.clientHeight,w:t.clientWidth};e.h>arTimeout(u),osafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,r=a?a(n):new e.constructor(n);return e.copy(r),r}}).call(this,n("RoC8")(e))},Fpy5:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n("Htdc");const o=e=>r.a.from(e,"base64").toString("utf-8"),i=e=>r.a.from(e,"utf8").toString("base64")},FumO:function(e,t,n){"us"}(r||(r={}))},G9gt:function(e,t,n){var r=n("jgJv"),o=r?r.prototype:void 0,i=o?o.valueOf:void 0;e.exports=function(e){return i?Object(i.call(e)):{}}},GE1V:function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var r=n("OWAy"),o=n("fzCA"),i=n("Cq/H"),s=n("/aKR"),a=n("x3xY"),c=n("g9AS"),u=n("6ib3"),l=n("YTdI"),d=n("t6yz"),h=n("qyk8"),f=n("mXGw"),p=n.n(f);function m(e){return e.split(/(<b0>.*?<\/b0>)/g).map((function(e){if(e.startsWith("<b0>")&&e.endsWith("</b0>")){var t=e.slice(4,-5);return p.a.createElement("strong",null,t)}return e}))}var g=n("QjXU"),v=n("p/uK"),b=n("sLnE"),y=Object(v.a)({container:Object(g.__assign)({},b.a.margin("12px","0px"))}),w=function(e){var t=e.firstDraftResources,n=e.showError,g=e.errorType,v=e.handleDismissClick,b=e.handleRAIErrorActionClick,w=e.handleCopyAndCreateFallback,C=e.errorLocation,O=e.createdDocType,T=e.domainUrl,S=e.handlePopUpBlockerCreationFallback,k=e.openPopUpBlockerHelpLink,E=y(),_=C==l.c.CreationError,j=C==l.c.RefinerError,I=g&&d.a.has(g),N=g&&d.b.has(g),A=g&&d.e.has(g),P=Object(f.useMemo)((function(){var e,n,r,o,i,s,a,c=O==u.a.Word?t.firstDraftWordDocumentType:O==u.a.Excel?t.firstDraftExcelDocumentType:O==u.a.PowerPoint?t.firstDraftPowerPointDocumentType:"";return I?_?{errorText:null!==(e=null==t?void 0:t.errorTextRAIduringCreate)&&void 0!==e?e:"",actionText:null!==(n=null==t?void 0:t.errorActionTextRAIduringCreateCopyAndCreate)&&void 0!==n?n:"",onActionClick:w}:{actionText:j?null==t?void 0:t.errorActionTextRAI:void 0,errorText:null==t?void 0:t.errorTextRAI,onActionClick:j?b:void 0}:N?{errorText:null!==(r=null==t?void 0:t.errorTextUnsupportedLanguage)&&void 0!==r?r:""}:g==d.d.PopUpBlockedByBrowser&&c&&T?{errorText:null!==(o=m(Object(h.a)(null==t?void 0:t.popUpBlockerErrorText,c,T)))&&void 0!==o?o:"",actionText:Object(h.a)(null==t?void 0:t.popUpBlockerErrorActionText,c),onActionClick:S}:g==d.d.DependencyError?{errorText:null!==(i=null==t?void 0:t.errorTextALCreate)&&void 0!==i?i:"",actionText:null!==(s=null==t?void 0:t.errorActionTextRAIduringCreateCopyAndCreate)&&void 0!==s?s:"",onActionClick:w}:A?{errorText:null==t?void 0:t.hmcThrottledErrorText}:{errorText:null!==(a=null==t?void 0:t.errorTextGeneric)&&void 0!==a?a:""}}),[O,t.firstDraftWordDocumentType,t.firstDraftExcelDocumentType,t.firstDraftPowerPointDocumentType,null==t?void 0:t.errorTextGeneric,null==t?void 0:t.errorTextRAIduringCreate,null==t?void 0:t.errorActionTextRAIduringCreateCopyAndCreate,null==t?void 0:t.errorActionTextRAI,null==t?void 0:t.errorTextRAI,null==t?void 0:t.errorTextUnsupportedLanguage,null==t?void 0:t.popUpBlockerErrorText,null==t?void 0:t.popUpBlockerErrorActionText,null==t?void 0:t.errorTextALCreate,null==t?void 0:t.hmcThrottledErrorText,I,N,g,T,A,_,w,j,b,S]);return n&&P.errorText?p.a.createElement(r.a,{className:E.container},p.a.createElement(o.a,{intent:"warning"},p.a.createElement(i.a,null,P.errorText),p.a.createElement(s.a,{containerAction:p.a.createElement(a.a,{"aria-label":null==t?void 0:t.errorActionTextGeneric,appearance:"transparent",onClick:v,icon:p.a.createElement(c.j,null)})},g==d.d.PopUpBlockedByBrowser&&p.a.createElement(a.a,{onClick:k},null==t?vn("HLVI"),s=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":s&&s in Object(e)?o(e):i(e)}},GeVZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=new RegExp(["^(https?:)//","(([^:/?#]*)(?::([0-9]+))?)","(/{0,1}[^?#]*)","(\\?[^#]*|)","(#.*|)$"].join(""));function o(e){if(e&&e.length){var t=e.mat[5],search:t"color:>{"%%"!emoveItem("d+)/)&&parsigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366rts=n("AqD5")(t);const{formatm7J")(n==t(e,t)rotott,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Small=0]="Small",e[e.Default=1]="Default",e[e.Large=2]="Large"}(r||(r={}))},HeHW:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("FPnS"),o=n("io1X");function i(){return Object(o.a)()==r.a.dark}},Hebw:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));const r="https://my.microsoftpersonalcontent.com",o="https://1drv.ms"},Hhhn:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return s}));var r=n("A3AF");function o(e,t,n){e.headers instanceof Headers?e.headers.set(t,n):e.headers={...e.headers,[t]:n}}const i="Bearer";function s(e,t,n,i){let s=!1;const a=new URL(e);i.queryParam&&(a.searchParams.set(i.queryParam,n),s=!i.doNotExceedQueryParamsLength||a.search.length<=i.doNotExceedQueryParamsLength,s||a.searchParams.delete(i.queryParam));let c=t;if(!s){c={...t};let e=!1;const s=null!=t&&t.method?t.method.toUpperCase():"GET";if(i.preferAuthorizationInMultipartFormBody&&["GET","POST"].includes(s)){c.method="POST";const u=Object(r.a)(),l=[];l.push(`--${u}`),l.push(`Authorization: ${i.scheme} ${n}`),l.push(`X-HTTP-Method-Override: ${s}`),l.push("_post: 1"),null!=t&&t.body&&l.push(`\r\n${t.body}\r\n`),l.push(`\r\n--${u}--`);const d=l.join("\r\n");e=!i.doNotExceedMultipartFormBodyLength||d.length<=i.doNotExceedMultipartFormBodyLength,e&&(c.body=d,o(c,"Content-Type",`multipart/form-data;boundary=${u}`),a.searchParams.set("ump","1"))}e||o(c,"Authorization",i.scheme?`${i.scheme} ${n}`:n)}return{url:a.href,request:c}}},Htdc:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n("KlUR"),o=n("3tC7");function i(e,t){switch(t){case"base64":return r.fromByteArray(e);case"utf8":case"utf-8":case void 0:return(new TextDecoder).decode(e);default:throw new Error("invalid/unsupported encoding")}}const s=(e,t)=>c.from(e,t).buffer;function a(e){return e instanceof ArrayBuffer||"object"==typeof e&&null!==e&&"number"==typeof e.byteLength&&"function"==typeof e.slice&&void 0===e.byteOffset&&void 0===e.buffer}class c extends Uint8Array{toString(e){return i(this,e)}static from(e,t,n){if("string"==typeof e)return c.fromString(e,t);if(null!==e&&"object"==typeof e&&a(e.buffer))return Object(o.a)(0===e.byteOffset,0),Object(o.a)(e.byteLength===e.buffer.byteLength,1),c.fromArrayBuffer(e.buffer,t,n);if(a(e))return c.fromArrayBuffer(e,t,n);throw new TypeError}static fromArrayBuffer(e,t,n){const r=null!=t?t:0,o=null!=n?n:e.byteLength-r;if(r<0||r>e.byteLength||o<0||o+r>e.byteLength)throw new RangeError;return new c(e,r,o)}static fromString(e,t){switch(t){case"base64":{const t=this.sanitizeBase64(e),n=r.toByteArray(t);return new c(n.buffer)}case"utf8":case"utf-8":case void 0:{const t=(new TextEncoder).encode(e);return new c(t.buffer)}default:throw new Error("invalid/unsupported encoding")}}static isBuffer(e){throw new Error("unimplemented")}static sanitizeBase64(e){let t=e;return t=t.split("=")[0],t=t.replace(/[^\w+-/]/g,""),t.length%4!=0&&(t+=["","===","==","="][t.length%4]),t}}},Hyok:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("QjXU"),o=n("am3b"),i=n("LsEq"),s=n("gd1C");function a(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a,c,u,l,d,h;return Object(r.__generator)(this,(function(f){return n=e.appId,a=e.entityId,c=e.subPageId,u=new URLSearchParams(location.search),l=Object(r.__assign)({},u),d={route:"M365Apps",type:o.a.Mos,appId:n,entityId:a,subPageId:c},h=Object(i.a)(t,void 0,a),[2,Object(s.a)(d,{action:"OpenInBrowser"},h,l)]}))}))}},Hyop:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("QjXU"),o=n("MJsD"),i=n("QLkI"),s=n("B5kz"),a=n("W7wX"),c=n("Chyi");function u(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t,n,u,l;return Object(r.__generator)(this,(function(d){switch(d.label){case 0:return[4,Promise.all([Object(o.a)(),Object(a.a)(),Object(i.a)()])];case 1:return e=r.__[1],(u=e[2])&&u.graphApiRoot?[2,s.a.fetchQuery(l=["GraphMyDriveInfo"],(function(){return Object(c.a)(t,n,u,(function(e){return s.a.setQueryData(l,e)}))}),{staleTime:1/0,cacheTime:1/0})]:[2,void 0]}}))}))}},I0st:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("CDuu"),o=n("gy05");function i(){return Object(r.a)(o.a)}},I18q:function(e,t,n){"use strict";n.d(t,"a",;n.d(t,"a",(function(){return r})),function(e){e.themePropertiesChanged="themePropertiesChanged",e.textStylesChanged="textStylesChanged"}(r||(r={}))},"Ito+":function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return h}));var r=n("Hhhn"),o=n("graM"),i=n("I18q");function s(e){const t=e.get("www-authenticate");if(!t)return;let n,r=!1;return t.split(",").map((e=>{const t=e.split("=");if(t.length>=2)if(r||"error"!==t[0].trim().toLowerCase()){if(!n&&"claims"===t[0].trim().toLowerCase()){const t=Object(i.a)(e.substring(e.indexOf("=")+1).trim());t&&(n=atob(t))}}else r="insufficient_claims"===Object(i.a)(t[1].trim().toLowerCase())})),r?n:void 0}function a(e){const t=e.get("www-authenticate");if(!t)return;let n,r=!1;for(const e of t.split(",")){const t=e.split("=");t.length>=2&&(r||"error"!==t[0].trim().toLowerCase()?void 0===n&&"error_description"===t[0].trim().toLowerCase()&&(n=Object(i.a)(t[1].trim())):r="invalid_token"===Object(i.a)(t[1].trim().toLowerCase()))}return r?{errorDescription:n}:void 0}var c=n("Qr0m"),u=n("OSNm");const l={scheme:r.b};function d(e){let t;return e.tenantId&&(t={tenantId:e.tenantId}),f(e,t)}function h(e){let t;return e.tenantId&&(t={tenantId:e.tenantId}),f(e,t)}async function f(e,t){var n,i,u;let d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const h=null!==(n=null===(i=e.retryPolicy)||void 0===i?void 0:i.maxAuthRetries)&&void 0!==n?n:3,m=(await e.getToken(t)).token,{url:g,requestInit:v,retryPolicy:b,timeoutMs:y}=e,w=null!==(u=e.tokenPolicy)&&void 0!==u?u:l,{url:C,request:O}=Object(r.a)(g,v,m,w),T=e=>401===e.status&&s(e.headers)||void 0,S=e=>401===e.status&&void 0!==a(e.headers)||void 0,k=e=>{if(401===e.status){const n=Object(c.a)(e.headers);if(n&&n!==(null==t?void 0:t.tenantId))return n}},E=e=>(null==b?void 0:b.retry401WithNewToken)&&401===e.status;let _;b&&(_={...b,filter:e=>!T(e)&&!S(e)&&!k(e)&&!E(e)&&b.filter(e)});const j="logger"in e&&"nameForLogging"in e?await Object(o.b)(C,O,e.nameForLogging,e.logger,e.doNotLogOnSuccess,_,y,e.getAdditionalProps):await Object(o.a)(C,O,_,y);if(d<=h){const n=d===h,r=T(j.result);if(r)return p(e,"InsufficientClaims",d,n),f(e,{...t,claims:r},d+1);if(S(j.result))return p(e,"InvalidToken",d,n),f(e,{...t,forceRefresh:!0},d+1);const o=k(j.result);if(o)return p(e,"SpecificTenant",d,n),f(e,{...t,tenantId:o},d+1);if(E(j.result))return p(e,"Generic401",d,n),f(e,{...t,forceRefresh:!0},d+1)}return j}function p(e,t,n,r){"logger"in e&&"nameForLogging"in e&&Object(u.b)(e.logger,{eventName:`Retry${e.nameForLogging}OnAuthError`,subCategory:t,attempt:n,isFinalAttempt:r})}},Iz5H:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("OSNm");const o=["https://cdn.dev.fluidpreview.office.net","https://cdn.fluidpreview.office.net","https://res-sdf.cdn.office.net","https://res.cdn.office.net","https://dev.loop.microsoft.com","https://df.loop.microsoft.com","https://preview.loop.microsoft.com","https://loop.microsoft.com","https://dev.ch5.fluidpreview.office.net","https://ch5.fluidpreview.office.net","https://blobs.officehome.msocdn.com","https://app.int.whiteboard.microsoft.com","https://app.whiteboard.microsoft.com","https://whiteboard.microsoft.com","https://whiteboard.office.com","https://cdn.forms.office.net"],i=["https://res-gcch.cdn.office.net","https://whiteboard.office365.us"],s=["https://res-dod.cdn.office.net"],a=[...o,...i,...s],c=(e,t,n)=>{var c;if(null===(c=null==t?void 0:t.getSetting("bohemiaCodeLoader.environmentSpecificCDNs",!0))||void 0===c||c){const t="DoD"===e?s:"GccHigh"===e?i:o;return n&&(Object(r.b)(n,{eventName:"DefaultAllowedCodeOrigins",environment:e}),0===t.length&&Object(r.a)(n,{eventName:"DefaultAllowedCodeOriginsEmptyEnvironment"},"{message: ${deploymentRing} environment does not have any default code origins}")),t}return a}},"J9+k":function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n("QjXU"),o=n("MJsD"),i=n("B5kz"),s=n("W7wX"),a=n("QLkI"),c=n("j7b/"),u=n("6y6H"),l=n("Cqxz"),d=n("wRjz"),h=n("lwUs"),f=n("m32Q"),p=n("lkvL"),m=n("a3FV"),g=n("Wa5Y"),v=n("fNDz"),b="graph-person-picture-api";function y(e,t){return void 0===t&&(t="96x96"),Object(r.__awaiter)(this,void 0,void 0,(function(){var n,y,w;return Object(r.__generator)(this,(function(C){switch(C.label){case 0:return[4,Promise.all([Object(o.a)(),Object(s.a)()])];case 1:return n=r.__read.apply(void 0,[C.sent(),2]),y=n[0],w=n[1],[2,i.a.fetchQuery(["GraphPersonPicture",e,t],(function(){return function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,s,y,w,C,O,T,S,k,E,_=this;return Object(r.__generator)(this,(function(j){switch(j.label){case 0:return i=e.officeHomeApiRoot,s=e.jwtAuthEnabled,y=e.correlationId,w=e.getAccessToken,[4,Promise.all([Object(a.a)(),Object(u.a)()])];case 1:return C=r.__read.apply(void 0,[j.sent(),2]),T=C[1],(O=C[0])?(S=[],(null==T?void 0:T.key)&&S.push(Object(d.a)(T.key)),S.push(Object(h.a)(4*c.d)),k={officeApiRoot:i,jwtAuthEnabled:s,correlationId:y,getAccessToken:w,graphApiRoot:O.graphApiRoot,pictureId:n,size:o},E="".concat(n,"-").concat(o),[2,Object(l.a)((function(){return function(e){var t=e.correlationId,n=e.jwtAuthEnabled,o=e.getAccessToken,i=e.graphApiRoot,s=e.officeApiRoot,a=e.pictureId,c=e.size;return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,u,l,d;return Object(r.__generator)(this,(function(r){return e={method:"GET",responseType:"blob"},a?(u=void 0===c?"users/".concat(a,"/photo/$value"):"users/".concat(a,"/photos/").concat(c,"/$value"),l=Object(v.a)(i,u),d=new FileReader,[2,new Promise((function(r){Object(g.a)(m.a.OneDriveGraphPeoplePictureRequest,"OneDrive_Graph_People_Picture",l,e,n,o,s,t,"Graph").then((function(e){e&&e.ok&&e.data?(d.onloadend=funcg"==typeof d.result&&d.result.split(",")||[]; 0)},d.onerror=function(){return r(void 0)},d.onabort=function(){return r(void 0)},d.readAsDataURL(e.data)):r(void 0)})).catch((function(){r(void 0)}))}))]):[2,void 0]}))}))}(k)}),(function(){var e=Object(r.__spreadArray)([],Object(r.__read)(S),!1).reverse();return Object(f.a)({userId:t.puid,collectionName:b,collectionVersion:2,key:E,hashKey:!0,plugins:e})}),(function(e){return Object(r.__awaiter)(_,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(p.a)({userId:t.puid,collectionName:b,collectionVersion:2,key:E,hashKey:!0,data:e,plugins:S,writeBehavior:"sync"})]}))}))}(y,w,e,t)}),{staleTime:1/0,cacheTime:1/0})]}}))}))}},J9xP:function(e,t,n){var r=n("cm7J");e.exports=function(e){return r(this.__data__,e)>-1}},JGoI:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("mgFK"),o=n("aADZ"),i={key:"SharedContext",isGetClientGeneratedConfigEnabled:function(e){var t;return!!(null===(t=e.sharedContextNorthStarGates)||void 0===t?void 0:t.sharedContextNorthStarEnabled)},getClientGeneratedConfig:function(e){var t,n,r,i,s,a,c,u,l,d,h,f,p=e.featureSettings,m=e.userEntitlements,g=e.componentContext,v=null!==(n=null===(t=p.resources)||void 0===t?void 0:t.graph)&&void 0!==n?n:"",b=Object(o.a)(null!==(i=null===(r=p.sharedContext)||void 0===r?void 0:r.iceApplicationId)&&void 0!==i?i:"-1"),y=Object(o.a)(null!==(a=null===(s=p.authModel)||void 0===s?void 0:s.recommendedIceApplicationId)&&void 0!==a?a:"-1"),w=null!==(u=null===(c=p.sharedContext)||void 0===c?void 0:c.supportDocsUrl)&&void 0!==u?u:"",C=null!==(d=null===(l=p.sharedContext)||void 0===l?void 0:l.teamsUrl)&&void 0!==d?d:"";return{graphApiRoot:v,iceApplicationId:b,officeMarketLcid:g.officeMarketLcid,oneDriveResourceId:null!==(h=null==m?void 0:m.OneDriveResourceId)&&void 0!==h?h:"",recommendedIceApplicationId:y,sharePointRurceId)&&void 0!==f?f:"",supportDocsUrl:w,teamsUrl:C}},getServerGeneratedConfig:function(e){return function(e){return Object(r.a)("sharedContext",e)}(e)}}},JIAX:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return i}));const r=["spreadsheet","document","slidedeck","loop","forms","whiteboard","visio drawing","onenote notebooknown=-1]="Unknown",e[e.NotLikely=1]="NotLikely",e[e.SomewhatLikely=2]="SomewhatLikely",e[e.VeryLikely=3]="VeryLikely",e[e.MostLikely=4]="MostLikely"}(i||(i={}))},JLWT:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return l}));var r,o=n("QjXU"),i=n("mXGw"),s=n.n(i);!function(e){e.setHarmonyThemeData="setHarmonyThemeData"}(r||(r={}));var a=function(e,t){switch(t.type){case r.setHarmonyThemeData:return Obn)(Object(o.__assign)({},e),t.harmonyThemeData);default:return e}},c=s.a.createContext(void 0),u=s.a.createContext({setHarmonyThemeData:functict(o.__read)(Object(i.useRe(i.useCallback)((function(e){n({o)((function(){return{setHarmonyThemeData:s}}),[s]);return Object(i.useMemo)((function(){return{harmonyThemeData:t,harmonyThemeDataActionCreators:c}}),[t,c])}();return s.a.createElement(u.Provider,{value:n.harmonyThemeDataActionCreato,t,n){"use strict";n.d(t,"a",(functassign)(Object(r.__assign)({},e),t):e||t}},JYsJ:function(e,t,n){"use strict";function r(e){return new URLSearchParams(window.location.search).get(e)}n.d(t,"a",(function(){return r}))},JfaO:function(e,t,n){"use strict";n.d(t,"a",(function(){return I}));var r,o=n("p43c"),i=n("+0a/"),s=n("mXGw"),a=n.n(s),c=n("QjXU"),u=n("p/uK"),l=n("sLnE"),d=Object(u.a)({popOver:Object(c.__assign)({},l.a.padding("2px")),menuItemsNoOutline:{"& div":{":hover":{outlineStyle:"none"},":active:hover":{outlineStyle:"none"},":focus-visible":{outlineStyle:"none"}}}}),h=n("4Zdx"),f=n("Ip3P"),p=n("U4aE"),m=n("varT"),g=n("xwQ8"),v=n("BPR0"),b=n("d+i3"),y=n("7l51"),w=n("l/ot"),C=n("DU/N"),O=n("DG+G"),T=Object(u.a)({badge:Object(c.__assign)(Object(c.__assign)({},l.a.padding("0 2px")),{fontSize:C.a.fontSizeBase100,fontWeight:C.a.fontWeightBold,height:"16px",minWidth:"32px"}),badgeContainer:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingRight:"2px"},icon:{alignItems:"center",display:"flex",height:"100%",justifyContent:"center",width:"20px"},menuItem:{backgroundColor:C.a.colorNeutralBackground1,":hover":(r={backgroundColor:C.a.colorNeutralBackground1Hover},r["& .".concat(O.a)]={color:C.a.colorNeutralForeground2BrandPressed},r),":active":{backgroundColor:C.a.colorNeutralBackground1Pressed},":focus-visible":{outlineColor:C.a.colorStrokeFocus2,outlineStyle:"solid",outlineWidth:"2px",outlineOffset:"-1px"}},menuDivider:{backgroundColor:C.a.colorNeutralStroke2,height:C.a.strokeWidthThin}}),S=function(e){var t,n,r=[];try{for(var o=Object(c.__values)(e),i=o.next();!i.done;i=o.next()){var s=i.value;r.push(a.a.createElement(_,{key:"acti{error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r},k=function(e){e.preventDefault(),e.stopPropagation()},E=function(e,t){var n,r,o;if(e.renderMenu)return e.renderMenu();var i=e.subMenus&&e.subMenus.length>0,s=(null===(n=e.contentActionOptions)||void 0===n?void 0:n.badgeText)?a.a.createElement("div",{className:t.badgeContainer},a.a.createElement("span",null,e.title),a.a.createElement(h.a,{color:"brand",className:t.badge},e.contentActionOptions.badgeText)):e.title,c=a.a.createElement(f.a,{role:"menuitem","aria-label":e.ariaLabel,className:t.menuItem,icon:a.a.createElement(w.a,{className:t.icon,icon:null===(r=e.contentActionOptions)||void 0===r?void 0:r.icon,isDisabled:e.disabled}),key:e.id,onClick:function(t){k(t),e.executeAction&&!e.disabled&&e.executeAction(t)},hasSubmenu:i&&!(null===(o=e.contentActionOptions)||void 0===o?void 0:o.split),disabled:e.disabled},s);return e.tooltipString?a.a.createElement(p.a,{content:e.tooltipString,relationship:"description"},c):c},_=function(e){var t,n,r=e.menuItem,s=T();if((null===(t=r.contentActionOptions)||void 0===t?void 0:t.itemType)===y.b.Divider)return a.a.createElement(m.a,{className:s.menuDivider,key:r.id});if(r.subMenus&&r.subMenus.length>0&&!r.disabled){var c=S(r.subMenus),u=a.a.createElement(g.a,null,E(r,s));return(null===(n=r.contentActionOptions)||void 0===n?void 0:n.split)&&(u=a.a.createElement(v.a,null,E(r,s),a.a.createElement(g.a,null,a.a.createElement(f.a,{"aria-label":r.ariaLabel,role:"menuitem",onClick:k})))),a.a.createElement(b.a,null,u,a.a.createElement(o.a,null,a.a.createElement(i.a,null,c)))}return E(r,s)},j=n("zkbx"),I=function(e){var t=e.groupInfo,n=e.items,r=e.hidden,s=d();return a.a.createElement(o.a,{className:s.popOver,hidden:null!=r&&r},a.a.ccat_Wac_AiSummarize",e[e.msoulscat_Wac_CopilotCompose=3048]="msoulscat_Wac_CopilotCompose",e[e.msoulscat_Wac_Skittles=3049]="msoulscat_Wac_Skittles"}(r||(r={}))},K7tG:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("mXGw"),o=n("T8eN"),i=n("I0st");function s(){var e=Object(i.a)().data;return Object(r.useMemo)((function(){if(e)return Object(o.a)(e)}),[e])}},KQ1A:function(e,tig",isGetClientGeneratedConfigEnabled:function(e){var t;return!!(null===(t=e.resolveConfigGates)||void 0===t?void 0:t.resolveConfigTemplatesEnabled)},getClientGeneratedConfig:function(e){var t,n,r,o,s,a,c,u,l,d,h,f,p,m,g,v,b,y,w,C,O,T,S,k,E=e.featureGates,_=e.featureSettings,j=e.userEntitlements;if(null===j)throw new Error("UserEntitlements is null");var I=j.isConsumerUser,N=j.IsOfficeProPlus,A=null!==(n=null===(t=E.wacStartPageGates)||void 0===t?void 0:t.wacStartPageCreateLcidEnabled)&&void 0!==n&&n,P=null!==(o=null===(r=E.templatesGates)||void 0===r?void 0:r.templatesTemplatesFormsEnabled)&&void 0!==o&&o,x=null!==(a=null===(s=E.wacStartPageGates)||void 0===s?void 0:s.wacStartPageTemplatesEnabled)&&void 0!==a&&a,D=null!==(u=null===(c=E.wacStartPageGates)||void 0===c?void 0:c.wacStartPageEnterpriseTemplatesEnabled)&&void 0!==u&&u,L=Object(i.a)(null===(l=_.wacStartPage)||void 0===l?void 0:l.numTemplates),M=Object(i.a)(null===(d=_.wacStartPage)||void 0===d?void 0:d.numVisioTemplates),R=null!==(f=null===(h=_.wacStartPage)||void 0===h?void 0:h.templatesApiEndpoint)&&void 0!==f?f:"",F=null!==(m=null===(p=_.templates)||void 0===p?void 0:p.templatesCollectionsCommercial)&&void 0!==m?m:"",B=null!==(v=null===(g=_.templates)||void 0===g?void 0:g.templatesCollectionsConsumer)&&void 0!==v?v:"",U=null!==(y=null===(b=_.templates)||void 0===b?void 0:b.templatesCollectionsEdu)&&void 0!==y?y:"",W={};return W.excel=null!==(C=null===(w=_.consumerExcelStartPageTemplateCollection)||void 0===w?void 0:w.value)&&void 0!==C?C:"",W.word=null!==(T=null===(O=_.consumerWordStartPageTemplateCollection)||void 0===O?void 0:O.value)&&void 0!==T?T:"",W.powerpoint=null!==(k=null===(S=_.consumerPowerPointStartPageTemplateCollection)||void 0===S?void 0:S.value)&&void 0!==k?k:"",{createLcidEnabled:A,enterpriseTemplatesEnabled:x&&D&&N,numTemplates:L,numVisioTemplates:M,templatesApiEndpoint:R,templatesFormsEnabled:P||I,templatesCollectionsCommercial:F.split(","),templatesCollectionsConsumer:B.split(","),templatesCollectionsEdu:U.split(","),startPagesConsumerTemplatesCollectionIds:W}},getServerGeneratedConfig:function(e){return function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(o.a)("templatesPageConfig",e)];case 1:return[2,t.sent()]}}))}))}(e)}}},KSsg:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("lOFt"),o=n("V9hE"),i=n("iPRk"),s=n("HQCr"),a=n("Dn7E"),c=n("CMIS"),u=n("GMuP"),l={AppBar:"AppBar",AppList:"AppGallery",AppsNotificationDialog:"AppsNotificationDialog",Edgeworth:"Edgeworth",Recommended:"Recommended",QuickAccess:"QuickAccess",MyContent:"MyContent",MyContentOdspView:"MyContent",MyContentPeopleView:"MyContent",MyContentPeopleViewDetailed:"MyContent",TuiCallout:"TeachingUi",GettingToKnowYou:"GettingToKnowYou"};function d(e){if(!e)return"Other";var t=l[e];return null!=t?t:"Other"}var h=n("KbiU"),f=n("rTyw"),p=function(e){var t,n=e.launchInstrumentationParams,l=e.success,p=e.platform,m=e.uiHost;if(n){var g=n.area,v=n.dataSecurityLevel,b=n.eventName,y=n.elementId,w=n.renderTimingInstrumentationParams,C=n.referral,O=n.isScdType,T=n.pageName,S=n.clickParams;if(!n.isLogged){if(n.isLogged=!0,S||(S={}),S.ClickDestination=m?"ContentPage":"ExternalPage",Object(r.a)(b,y,g,l?C:"",p,S,[],v),l)Object(s.a)(y,g,C,void 0,void 0,b,O,T),Object(a.a)({featureName:d(g),eventName:b,params:Object(h.a)(S),area:g});else{var k=C?Object(f.a)(C):"Other",E="Error: \nelementId: ".concat(y,"\n referral: ").concat(k,"}"),_=((t={}).DebugInfo=E,t);Object(c.a)({eventName:b,debugInfo:E}),Object(u.a)({eventName:b,params:_,area:g}),Object(o.a)(b,_,[],v)}if(w){var j=w.clickMarker,I=w.paintMarker;Object(i.a)(j,I)}}}}},KbiU:function(e,t,n){"use strict";function r(e){var t,n={};if(!e)return n;for(var r in e){var o=e[r],i="";if("object"==typeof o){if("value"in o&&(i=o.value),"defaultValue"in olse i=null!==(t=o)&&void 0!==t?t:"";n[r]=i}retuon(e,t,n){var e.charCodeAt(n+1+s>c?c:a+s));return 1===o?i.push(r[(t=e[n-1])>>2]+r[t<<4&63]+"=="):2===o&&i.push(r[(t=(e[n-2]<<8)+e[n-1])>>10]+r[t>>4&63]+r[t<<2&63]+"="),i.join("")};for(var r=[],o=[],i="undefined"!=typeof U63]+r[e>>6&63]+r[63&e]}function d(e,t,n){for(var r=[],o=t;o<n;o+=3)r.push(l((e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2])));reject.getPrototypeOf,Object);e.exports=r},LSEb:function(e,t,n){var r=n("Yzgk"),o=n("X/0h");e.exports=function(e,t){var n=o(e,t);return r(n)?n:void 0}},LVqF:function(e,t,n){"use strict";var r,o,i;n.d(t,"e",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return c})),function(e){e.IframeLoadFailed="IframeLoadFailed",e.ContainerUpgradeRequired="ContainerUpgradeRequired",e.ComponentNotFound="ComponentNotFound"}(r||(r={})),function(e){e.RootComponentCreateFailed="RootComponentCreateFailed"}(o||(o={}));class s extends Error{constructor(e,t,n,r){if(super(e),this.internalError=n,this.name=t,r)try{this.stack=r}catch(e){}}}class a extends s{constructor(e,t,n){super(e,r.IframeLoadFailed,t),this.errorCode=n}}!function(e){e.UndefinedInitializeIframeMethod="UndefinedInitializeIframeMethod"}(i||(i={}));class c extends s{constructor(e,t,n,o){super(e,r.ComponentNotFound,t,o),this.code=n}}},LYe0:function(e,t,n){"use strict";function r(e){var t="__copyClipboard-input",n=document.getElementById(t);n||((n=document.createElement("input")).id=t,n.type="hidden",ototype.hasOwnProperty;e.exports=function(e){if(!r(e))return o(e);var t=[];for(var n in Object(e))i.call(e,n)&&"constructor"!=n&&t.push(n);return t}},LlSO:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}))this,e)}static getTyp"}static getBaseTypes(){return[]}static getTypeNameFor(e){return e&&e.H_?e.H_.T_:void 0}static getBaseTypesFor(e){return e&&e.H_&&e.H_.B_?e.H_.B_:[]}static getAllTypesFor(e){const t=r.getTypeNameFor(e);return t?[t,...r.getBaseTypesFor(e)]:[]}static matchesTypesFor(e,t){if(!Array.isArray(t)||0===t.length)return!0;const n=r.getTypeNameFor(e),o=r.getBaseTypesFor(e);for(const e of t){if(e===n)return!0;if(o.indexOf(e)>=0)return!0}return!1}static assign(e,t,n){if(n)for(const e of Object.keys(n))t[e]=n[e];return t.H_=e.H_,t}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},LpbE:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return u}));var r=n("Hhhn"),o=n("aFvx"),i=n("graM");const s={maxRetries:2,backoffFn:Object(o.b)(500),filter:Object(i.c)([408,409,429,503]),respectRetryAfterHeader:!0},a={scheme:r.b,queryParam:"access_token",doNotExceedQueryParamsLength:2048,preferAuthorizationInMultipartFormBody:!0,doNotExceedMultipartFormBodyLength:81920},c={scheme:r.b,preferAuthorizationInMultipartFormBody:!0,doNotExceedMultipartFormBodyLength:81920};function u(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n="Consumer"===e.identityType?c:a;return{...n,preferAuthorizationInMultipartFormBody:t}}},LsEq:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("8/lW"),o=n("DvUI");function i(e,t,n,i){var s=Object(o.a)(n),a={};return a.Area=e,a.Action=null!=t?t:"",a.Referral=null!=s?s:"",a.TabState=i?"New":"Current",{area:e,clickParams:a,dataSecurityLevel:r.a.Security,eventName:e+"_Click",elementId:null!=n?n:"",referral:null!=s?s:""}}},LzJX:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("mXGw");function o(e,t,n){var o=this,i=Object(r.useRef)(null),s=Object(r.useRef)(0),a=Object(r.useRef)(null),c=Object(r.useRef)([]),u=Object(r.useRef)(),l=Object(r.useRef)(),d=Object(r.useRef)(e),h=Object(r.useRef)(!0);d.current=e;var f=!t&&0!==t&&"undefined"!=typeof window;if("function"!=typeof e)throw new TypeError("Expected a function|!!n.trailing,g="maxWait"in n,v=g?Math.maje,snti.current;return!i.current||n>=t||n<0||g&&e-s.current>=v},b=function(t){return a.current=null,m&&c.current?e(t):(c.current=u.curren(!a.current&&h.c w.cancel=funimation,c.current=i.current=u.curre(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(o)}},M21c:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("QjXU"),o=n("qA3t"),i=n("GPOo"),s=n("nO8S"),a=n("+sqR"),c=n("7p/x"),u=n("io1X"),l=n("JSHo"),d=n("jbqF"),h=n("mXGw"),f=n.n(h),p=function(e){var t=Object(a.a)(),n=Object(c.a)(),p=Object(h.useContext)(s.a),m=Object(u.a)(),g=Object(h.useMemo)((function(){return p?e.theme:Object(l.a)(t,e.theme)}),[t,p,e.theme]),v=e.themeMode||m||n,b=e.dir||document.dir||void 0;return f.a.createElement(o.a,{value:"ohp-"},f.a.createElement(i.a,Object(r.__assign)({},e,{theme:g,dir:b}),f.a.createElement(d.a.Provider,{value:v},e.children)))}},MDpc:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return a}));var r=n("rwSX"),o=n("pJE1"),i=n("0EWy");function s(e){!function(e){document.documentElement.setAttribute("dir",e||Object(o.b)(r.a))}(null==e?void 0:e.dir),document.documentElement.setAttribute("lang",(null==e?void 0:e.lang)||r.a)}function a(){let e=Object(o.b)(r.a),t=r.a;return Object(i.a)()&&(e=document.documentElement.getAttribute("dir")||e,t=document.documentElement.getAttribute("lang")||t),{dir:e,lang:t}}},MJsD:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("QjXU"),o=n("B5kz"),i=n("zPZ9");function s(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return[2,o.a.fetchQuery(["OfficeComponentContext"],(function(){return i.a}),{cacheTime:1/0,staleTime:1/0})]}))}))}},MLvN:function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));var r,o,i=n("gzKm"),s=n("duEa"),a=n("85o7"),c=n("jJrO"),u=n("OeRt"),l=n("XxaS"),d=n("pUzp"),h=n("XrJr"),f=n("+9uq"),p=n("U4Iz"),m=n("PmtM"),g=n("YGV3"),v=n("iTb/"),b=n("cipv"),y=n("jH7j"),w=n("mXGw"),C=n.n(w),O=n("p/uK"),T=n("DG+G"),S=Object(O.a)({filled:(r={},r["&.".concat(T.a)]={display:"inline-block"},r["&.".concat(T.b)]={display:"none"},r),regular:(o={},o["&.".concat(T.a)]={display:"none"},o["&.".concat(T.b)]={display:"inline-block"},o)}),k=function(e){var t=e.iconName,n=e.filled,r=S(),o=void 0;switch(t){case"ArrowLeftIcon":var w=Object(i.a)(s.J,s.K);o=C.a.createElement(w,{filled:!0,className:n?r.filled:r.regular});break;case"ArrowRightIcon":var O=Object(i.a)(s.R,s.S);o=C.a.createElement(O,{filled:!0,className:n?r.filled:r.regular});break;case"ArrowSortDownIcon":o=C.a.createElement(s.C,null);break;case"ArrowSortUpIcon":o=C.a.createElement(a.g,null);break;case"AttachIcon":var T=Object(i.a)(a.n,a.o);o=C.a.createElement(T,{filled:!0,className:n?r.filled:r.regular});break;case"BackToTopIcon":o=C.a.createElement(a.h,null);break;case"CalendarEmptyIcon":var k=Object(i.a)(c.c,c.d);o=C.a.createElement(k,{filled:!0,className:n?r.filled:r.regular});break;case"CalendarIcon":var E=Object(i.a)(c.g,c.h);o=C.a.createElement(E,{filled:!0,className:n?r.filled:r.regular});break;case"ChevronDownIcon":o=C.a.createElement(u.n,null);break;case"ChevronUpIcon":o=C.a.createElement(u.D,null);break;case"ClockIcon":var _=Object(i.a)(u.E,u.F);o=C.a.createElement(_,{filled:!0,className:n?r.filled:r.regular});break;case"CloudIcon":var j=Object(i.a)(u.G,u.H);o=C.a.createElement(j,{filled:!0,className:n?r.filled:r.regular});break;case"CommentIcon":var I=Object(i.a)(u.L,u.M);o=C.a.createElement(I,{filled:!0,className:n?r.filled:r.regular});break;case"CompassIcon":o=C.a.createElement(l.a,null);break;case"DesktopIcon":var N=Object(i.a)(l.o,l.p);o=C.a.createElement(N,{filled:!0,className:n?r.filled:r.regular});break;case"DismissIcon":var A=Object(i.a)(l.w,l.x);o=C.a.createElement(A,{filled:!0,className:n?r.filled:r.regular});break;case"DocumentIcon":var P=Object(i.a)(l.E,l.F);o=C.a.createElement(P,{filled:!0,className:n?r.filled:r.regular});break;case"EditIcon":var x=Object(i.a)(d.f,d.g);o=C.a.createElement(x,{filled:!0,className:n?r.filled:r.regular});break;case"EyeHideIcon":var D=Object(i.a)(d.l,d.m);o=C.a.createElement(D,{filled:!0,className:n?r.filled:r.regular});break;case"FilterIcon":var L=Object(i.a)(d.p,d.q);o=C.a.createElement(L,{filled:!0,className:n?r.filled:r.regular});break;case"FluidIcon":var M=Object(i.a)(h.a,h.b);o=C.a.createElement(M,{filled:!0,className:n?r.filled:r.regular});break;case"GlobeIcon":var R=Object(i.a)(h.o,h.p);o=C.a.createElement(R,{filled:!0,className:n?r.filled:r.regular});break;case"ImageIcon":var F=Object(i.a)(f.d,f.e);o=C.a.createElement(F,{filled:!0,className:n?r.filled:r.regular});break;case"LayerIcon":var B=Object(i.a)(f.p,f.q);o=C.a.createElement(B,{filled:!0,className:n?r.filled:r.regular});break;case"MentionIcon":var U=Object(i.a)(p.e,p.f);o=C.a.createElement(U,{filled:!0,className:n?r.filled:r.regular});break;case"NavigationIcon":var W=Object(i.a)(p.o,p.p);o=C.a.createElement(W,{filled:!0,className:n?r.filled:r.regular});break;case"NewsIcon":o=C.a.createElement(p.q,null);break;case"NotepadIcon":var q=Object(i.a)(p.r,p.s);o=C.a.createElement(q,{filled:!0,className:n?r.filled:r.regular});break;case"OpenIcon":o=C.a.createElement(p.x,null);break;case"PdfIcon":var H=Object(i.a)(d.c,d.d);o=C.a.createElement(H,{filled:!0,className:n?r.filled:r.regular});break;case"PeopleCommunityIcon":var z=Object(i.a)(m.f,m.g);o=C.a.createElement(z,{filled:!0,className:n?r.filled:r.regular});break;case"PeopleIcon":var G=Object(i.a)(m.a,m.b);o=C.a.createElement(G,{filled:!0,className:n?r.filled:r.regular});break;case"PersonIcon":var V=Object(i.a)(m.k,m.l);o=C.a.createElement(V,{filled:!0,className:n?r.filled:r.regular});break;case"PinIcon":o=C.a.createElement(m.u,null);break;case"PinOffIcon":o=C.a.createElement(m.w,null);break;case"ContentListIcon":var $=Object(i.a)(g.T,g.U);o=C.a.createElement($,{filled:!0,className:n?r.filled:r.regular});break;case"SearchIcon":o=C.a.createElement(g.Z,null);break;case"SmallDismissIcon":var Q=Object(i.a)(l.s,l.t);o=C.a.createElement(Q,{filled:!0,className:n?r.filled:r.regular});break;case"SnoozeExpiryIcon":o=C.a.createElement(s.m,null);break;case"StarIcon":var J=Object(i.a)(v.o,v.p);o=C.a.createElement(J,{filled:!0,className:n?r.filled:r.regular});break;case"SyncIcon":o=C.a.createElement(a.a,null);break;case"TaskIcon":var X=Object(i.a)(b.j,b.i);o=C.a.createElement(X,{filled:!0,className:n?r.filled:r.regular});break;case"TrendingIcon":o=C.a.createElement(a.e,null);break;case"VideoIcon":var K=Object(i.a)(y.f,y.e);o=C.a.createElement(K,{filled:!0,className:n?r.filled:r.regular});break;case"VideoClipMultipleIcon":o=C.a.createElement(y.g,null);break;case"WindowNewIcon":o=C.a.createElement(y.m,null);break;case"WhiteboardIcon":var Y=Object(i.a)(y.k,y.l)}return o?C.a.createElement("span",null,o):null}},MNOf:function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,i){n=n||"=";var s={};if("string"!=typeof e||0===e.length)return s;var a=/\+/g;e=e.split(t=t||"&");var c=1e3;i&&"number"==typeof i.maxKeys&&(c=i.maxKeys);var u=e.length;c>0&&u>c&&(u=c);for(var l=0;l<u;++l){var d,h,f,p,m=e[l].replace(a,"%20"),g=m.indexOf(n);g>=0?(d=m.substr(0,g),h=m.sus,f)?oArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},MQuF:function(e,t,n){var r=n("SHde")(Object.keys,Object);e.exports=r},MgoT:function(e,t,n){"use strict";n.d(t,(function(){return a})),n.d(t,"a",(function(){return c}));var r=n("a3FV"),o=n("lUkk"),i=new(n("AlWG").a)(null);function s(){return i.asObservable()}function a(e){i.next(e),Object(oteNewNotebookDialog,id:"OneNoteNotebookCreateLink",area:"InputDialog",subArea:"CreateLinks",result:"Open",target:"Other"})}function c(){i.next(null)}},MpdP:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t,n)=>{let r=3;return function i(){return o(e,t,n).catch((()=>(r-=1,0===r?o(e,t,n):i())))}()};async function o(e,t,n){return new Promise(((r,o)=>{var i,s;const a=e.document,c=a.createElement("script"),u=null!==(i=null==n||null===(s=n.trustedTypesPolicy)||void 0===s?void 0:s.createScriptURL(t,{allowedScriptOrigins:n.allowedOrigins}))&&void 0!==i?i:t;c.src=u,c.async=!1,c.charset="utf-8",c.crossOrigin="anonymous",c.onload=r,c.onerror=()=>o(new Error(`Failed to download the script at url: ${t}, isUserDefinitelyOffline: ${!e.navigator.onLine}`)),a.head.appendChild(c)}))}},MqQ1:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n("QjXU"),o=n("MLvN"),i=n("wK4g"),s=n("8Jek"),a=n.n(s),c=n("mXGw"),u=n.n(c),l="PillControl-module__pill__u3Iap",d="PillControl-module__pill--active__nrKxv",h="PillControl-module__pill--dropdown__2Swcx",f="PillControl-module__pill--static__19F_f",p="PillControl-module__pill--dropdown--active__1telc",m="PillControl-module__icon__18HZK",g="PillControl-module__icon--active__1IDIf",v=Object(c.forwardRef)((function(e,t){var n,s,v,b=e.id,y=e.title,w=e.onClick,C=e.isActive,O=e.iconName,T=e.iconElement,S=e.iconElementActive,k=e.isDropdown,E=e.isRemovable,_=e.isStatic,j=e.onRemoveClick,I=e.disableFocus,N=e.style,A=e.pillTextStyle,P=e.ariaLabel,x=e.ariaDescribedbyId,D=e.removePillAriaLabel,L=e.onKeyDown,M=e.disableRemoveFocus,R=Object(c.useCallback)((function(e){null==e||e.stopPropagation(),j&&j()}),[j]),F=Object(r.__read)(Object(c.useState)(),2),B=F[0],U=F[1],W=Object(r.__read)(Object(c.useState)(),2),q=W[0],H=W[1];Object(c.useEffect)((function(){T&&Promise.resolve(T).then(U)}),[T]),Object(c.useEffect)((function(){S&&Promise.resolve(S).then(H)}),[S]);var z=k&&O,G=Object(c.useMemo)((function(){var e,t,n;return q&&C?u.a.createElement("div",{className:a()(m,(e={},e[g]=!z,e))},q):B?u.a.createElement("div",{className:a()(m,(t={},t[g]=C&&!z,t))},B):O?u.a.createElement(i.a,{className:a()(m,(n={},n[g]=C&&!z,n)),iconName:"".concat(O).concat(C?"Active":"")}):null}),[O,C,z,B,q]),V=Object(c.useMemo)((function(){var e;return u.a.createElement("span",{className:a()("PillControl-module__pill-text__1FOSO",(e={},e["PillControl-module__pill-text--active__3IPFs"]=C&&!z,e["PillControl-module__pill-text--static__2_3G-"]=_,e))},u.a.createElement("div",{className:"PillControl-module__pill-text--fake__2kBQW",title:y,style:A},y))}),[C,z,_,A,y]),$=Object(c.useMemo)((function(){return u.a.createElement(i.a,{className:"PillControl-modwnActive":"ChevronDown"})}),[C]);return w||j||L?u.a.createElement("button",{id:b,ref:t,onClick:w,onKeyDown:function(e){e.stopPropagation(),L&&L(e,b)},className:a()(l,(s={},s[d]=C,s[f]=_,s[h]=z,s[p]=z&&C,s)),tabIndex:I?-1:0,"data-clicklog":"custom",style:N,"aria-label":P,"aria-describedby":x},G,V,k&&$,E?u.a.createElement("div",{className:a()("PillControl-module__remove__3Os5v",(v={},v["PillControl-module__remove--active__3eMa0"]=C,v["PillControl-module__remove--static__2QV10"]=_,v)),onClick:R,onKeyDown:function(e){e.stopPropagation(),"Enter"!==e.key&&"Space"!==e.key||(e.preventDefault(),R(e))},"aria-hidden":!1,"aria-label":D,role:M?"none":"button",tabIndex:M?-1:0},u.a.createElement(o.a,{iconName:"SmallDismissIcon"})):null):u.a.createElement("span",{id:b,className:a()(l,(n={},n[d]=C,n[f]=_,n[h]=z,n[p]=z&&C,n)),"data-clicklog":"custom",style:N,"aria-label":P,tabIndex:I?void 0:0,"aria-hiting=25]="InvalidFormatting",e[e.WorkflowQuotaLimitExceeded=26]="WorkflowQuotaLimitExceeded",e[e.UnsupportedRequirement=27]="UnsupportedRequirement"}(r||(r={})),function(e){e.System="system",ent:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:o};return n.PropTyluidNotEnabled="fluidNotEnabled",e.fetchTokenError="fetchTokenError",e.cannotCatchUp="cannotCatchUp",e.serviceReadOnly="serviceReadOnly"}(r||(r={}))},NeQC:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("QjXU"),o=n("DCX/"),i=n("MJsD");function s(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t,n,s,a,c,u,l,d,h,f,p,m;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(i.a)()];case 1:return e=r.sent(),t=e.correlationId,n=e.defaultLinkTarget,s=e.getAccessToken,a=e.inMockMode,c=e.jwtAuthEnabled,u=e.officeHomeApiRoot,l=e.router,d=e.preferredCulture,h=e.sessionId,f=e.uiContext,p=e.workload,[4,Object(o.a)()];case 2:if(!(m=r.sent()))throw new Error("Capabilities not available");return[2,{capabilities:m,context:e,correlationId:t,defaultLinkTarger(e))return!1;var t=o(e);if(null===t)return!0;var n=a.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&s.call(n)==c}},NkqM:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("QjXU"),o=["^.*[\0- ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:.*","^.*[\0- ]*d[\r\n\t]*a[\r\n\t]*t[\r\n\t]*a[\r\n\t]*:.*"];function i(e){var t,n;if(e)try{for(var i=Object(r.__values)(o),s=i.next();!s.done;s=i.next()){var a=new RegExp(s.value);if(e.match(a))return e.replace(a,"")}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return e}},NrNW:fict";n.d(t,"a",(function(){return i}));var r=n("B5kz"),o=n("zPZ9");function i(){return Object(r.c)(["OfficeComponentContext"],(function(){return o.a}),{cacheTime:1/0,staleTime:1/0})}},NsUA:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));class r{constructor(){this.completed=!1,this.p=new Promise(((e,t)=>{this.res=e,this.rej=t}))}get isCompleted(){return this.completed}get promisid 0!==this.res&&(thiss.rej&&(this.completed=!0,this.rej(e))}}class o{constructor(e){this.execute=e}get[Symbol.toStringTag](){return this.getPromise()[Symbol.toStringTag]}async then(e,t){return this.getProc finally(e){return this.getPromise().finally(...arguments)}async getPromise(){return void 0===this.result&&(this.result=this.execute()),this.result}}},"O/XG":function(e,t,n){"use strict";n.d(t,"a",(function(){return re}));var r=n("QjXU"),o=n("MJsD"),i=n("u1BN"),s=function(){var e;return function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return void 0!==e?[2,e]:[4,Object(o.a)()];case 1:return t=n.sent(),[2,e=Object(i.a)(t)]}}))}))}}(),a=n("4CZh"),c=n("V9hE"),u=n("8/lW"),l=n("CMIS"),d=n("Dn7E"),h=n("GMuP"),f=n("wuzB"),p=n("NeQC"),m=n("gCKw"),g=n("TImb"),v=n("+gb4"),b=n("6ib3"),y=n("s1V1");function w(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,s,a,c,u,l,h,f;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(i=n&&e.fileType&&!e.isLocalFile&&!e.isEmailAttachment&&n.wacHostApps.has(e.fileType),s=n&&n.fluidSupportEnabled&&e.fileType===b.a.Fluid,a=o&&(o.ctrlKey||1===o.button),!n.wacHostEnabled||!i||a)return[2,{fluidHostFile:s,oneDriveToken:void 0,shouldHandleWacContent:!1}];c=!1,r.label=1;case 1:return r.trys.push([1,6,,7]),[4,t.getIdentity()];case 2:return(l=r.sent()).isMsa?[3,5]:[4,Object(y.a)()];case 3:return h=r.sent().result,[4,t.getAccessToken("OneDrive",!1,null==h?void 0:h.OneDriveResourceId)];case 4:u=r.sent(),r.label=5;case 5:return f=u&&!!u.token,c=(!e.isOnPremOrVanity||l.isMsa)&&f||t.inMockMode,[3,7];case 6:return r.sent(),Object(d.a)({featureName:"LauncherService",eventName:"LaunchInlineParamsException",params:{Message:"Unable to fetch identity or access token",DebugInfo:"identity:".concat(!!l,",oneDriveToken:").concat(!!u)}}),[3,7];case 7:return[2,{fluidHostFile:s,oneDriveToken:u,shouldHandleWacContent:c}]}}))}))}var C,O=n("gDky"),T=n("OEfX"),S=n("5ANk"),k=n("YKlt"),E=n("Y/GB");function _(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,o,i,s,a,c,u,l,d,h,f,m,v,y,w;return Object(r.__generator)(this,(function(C){switch(C.label){case 0:return[4,Object(p.a)()];case 1:return t=C.sent(),n=t.capabilities,i=t.correlationId,s=t.defaultLinkTarget,a=t.getAccessToken,c=t.inMockMode,u=t.jwtAuthEnabled,l=t.officeHomeApiRoot,d=t.preferredCulture,h=t.router,f=t.sessionId,m=t.uiContext,v=t.workload,[4,(o=t.context).getIdentity()];case 2:return y=C.sent(),w=Object(r.__read)(function(e,t,n,r,o,i,s){var a,c=e.document,u=e.wdOriginType,l=new URL(e.useWebUrl&&c.webUrl||e.useDeeplinkUrl&&c.deepLinkUrl||c.url);if(i&&Object(O.a)(c)&&l.searchParams.set("login_hint",i),Object(T.a)(c)){var d=Date.now();a=Object(S.a)();var h=t(),f=Object(g.a)(n,h,u);l.searchParams.set("ct",d.toString()),l.searchParams.set("wdOrigin",f),s||l.searchParams.set("cid",a),l.searchParams.set(E.b,Object(k.a)(n)),l.searchParams.set(E.a,o)}else c.fileType===b.a.Forms?(h=t(),l.searchParams.set("lang",r),l.searchParams.set("origin","OfficeDotCom"),l.searchParams.set("route",h&&h.route||""),l.searchParams.set("sessionId",o)):c.fileType===b.a.Stream||c.fileType===b.a.Audio?(l.searchParams.set("web","1"),l.searchParams.set("referrer","OfficeHome.Web"),l.searchParams.set("referrerScenario",u)):c.fileType===b.a.Clipchamp&&(l.searchParams.set("referrer","OfficeHome"),l.searchParams.set("referrerScenario",u));return[l.toString(),a]}(e,h.getCurrentRoute,v,d,f,n.outgoingLoginHintEnabled?o.loginHint:void 0,y.isMsa),2),[2,{context:o,correlationId:i,defaultLinkTarget:s,getAccessToken:a,inMockMode:c,jwtAuthEnabled:u,officeHomeApiRoot:l,router:h,preferredCulture:d,sessionId:f,uiContext:m,workload:v,capabilities:n,webUrl:w[0],clickId:w[1]}]}}))}))}function j(e){var t,n=null!lateDriveId;return o&&r?{templateDriveId:o,templateItemId:r}:r?{wdTpl:r}:void 0}!function(e){e.Fluid="fluid",e.Draft="draft",e.MOS="mos",e.WAC="wac"}(C||(C={}));var I,N=n("KSsg");function A(e,t,n,o,i,s,a){return void 0===a&&(a={}),Object(r.__awaiter)(this,void 0,void 0,(function(){var c,u;return Object(r.__generator)(this,(function(l){switch(l.label){case 0:return c=Date.now(),n.shouldHandleWacContent&&t.router.openHostedDocument?[4,t.router.openHostedDocument(e,c,Object(g.a)(t.workload,t.router.getCurrentRoute(),null!=o?o:"OTHER"),n.fluidHostFile,"DocumentClick",s&&e.navId?Object(r.__assign)({actinoid:e.navId},a):a)]:[3,2];case 1:return u=l.sent(),Object(N.a)({launchInstrumentationParams:i,success:u,platform:"Web"}),[2,{success:u,result:"Inline",message:"launchAppWacContent:openHostedDocument"}];case 2:return[2,Promise.resolve({success:!1,message:"launchAppWacContent:fallThrough"})]}}))}))}})[I.DriveId]=e,i[I.ItemId]=t,i[I.DocUrl]=n,i))}!function(e){e.DriveId="drive",e.ItemId="item",e.DocUrl="file",e.ContentUri="contenturi",e.Nav="nav"}(I||(I={}));var x=n("am3b"),D=n("LsEq"),L=n("gd1C");function M(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o,i,s,a,c,u;return Object(r.__generator)(this,(function(r){return n=e.canonicalUrl,o=e.docId,s=e.sharepointIds,(i=e.driveId)&&o&&n?(a={route:"MyContent",type:x.a.Base,entityId:"drafts",subEntityId:"content"},c=P(i,o,n,(null==s?void 0:s.siteUrl)?{siteUrl:s.siteUrl}:{}),(u=Object(D.a)(t,void 0,"Draft")).clickParams["".concat("DocumentId")]=e.id,[2,Object(L.a)(a,{action:"OpenInBrowser"},u,c)]):[2,{success:!1}]}))}))}var R=n("maX/"),F=n("W7wX"),B=n("/Oio"),U=n("iPRk"),W=n("VV8N");function q(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,s,a,c,u,l,d,h,f;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i=Date.now(),[4,Object(F.a)()];case 1:return s=r.sent(),a=new R.a(n,s,"DocumentClick"),function(e,t){var n,r=((n={}).ResourceId=e,n),o=Object(U.a)("FluidContentPerformanceMarker.DocumentLoadStart.".concat(t),0,void 0,r);o&&W.a.set(t,{clickTimeMarker:o,instrumentationParams:r})}(n.correlationId,a.getBootId()),a.hostScenarioName="DocumentClick",a.hostScenarioStartTime=i,c=e.siteUrl,u={route:"Content",type:x.a.Base,app:e.fileType},l=P(e.driveId,e.docId,e.docUrl,t?{siteUrl:c}:{}),d=Object(D.a)(o,void 0,"Fluid"),h="OpenInBrowser",n.workload!==B.a.OfficeHomeReact?(f=n.router.getUrlForRoute(u,l)||"",[2,Object(L.a)(f,{action:h},d,l)]):[2,Object(L.a)(u,{action:h},d,l)]}}))}))}var H=n("Hyok");function z(e,t,n,o){var i;return Object(r.__awaiter)(this,void 0,void 0,(function(){var s,a,c,u,l,d,h,f,p,v;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(s=n.capabilities,a=n.context,c=n.webUrl,l=e.useDeeplinkUrl,d=e.wdOriginType,h=(u=e.document).fileType===b.a.ThirdParty,f=Object(g.a)(a.workload,a.router.getCurrentRoute(),null!=d?d:"OTHER"),!(p=function(e,t,n,r,o,i){var s,a=void 0;if(!i)return a;var c=t.fluidSupportEnabled&&i===b.a.Fluid,u=t.wacHostApps,l=t.wacHostApps&&!!u&&i&&u.has(i)&&!e.isLocalFile;if(i===b.a.ThirdParty)a={type:C.MOS,fileType:i,appId:e.app,entityId:e.extension,subPageId:e.id,launchAction:"OpenMruItem",event:event};else if(c)a={type:C.Fluid,fileType:i,siteUrl:null==(d=e.sharepointIds)?void 0:d.siteUrl,driveId:null!=(h=e.driveId)?h:"",docId:null!=(f=e.docId)?f:"",docUrl:e.canonicalUrl||"",launchAction:"OpenMruItem",event:event};else if(i===b.a.Draft){var d;a={type:C.Draft,siteUrl:null==(d=e.sharepointIds)?void 0:d.siteUrl,driveId:null!=(h=e.driveId)?h:"",docId:null!=(f=e.docId)?f:"",docUrl:e.canonicalUrl||"",launchAction:"OpenMruItem",fileType:i,event:event}}else if(l){var h,f;a={appName:e.app,type:C.WAC,fileType:i,isLocalFile:e.isLocalFile,isOnPremOrVanity:e.isOnPremOrVanity,driveId:h=e.driveId,docId:f=e.docId,docUrl:e.canonicalUrl||"",fileName:e.fileName,event:event,isConsumer:!1,wdOrigin:r,launchUrl:o,launchAction:"OpenMruItem",siteUrl:null===(s=e.sharepointIds)||void 0===s?void 0:s.siteUrl}}return a}(u,s,0,f,c,u.fileType)))return[3,6];switch(p.type){case C.WAC:return[3,1];case C.Fluid:return[3,2];case C.MOS:return[3,4];case C.Draft:return[3,5]}return[3,6];case 1:return[2,A(u,a,t,d,o,l,j(e))];case 2:return[4,Object(m.a)()];case 3:return v=r.sent(),(null===(i=v.result.fluidConfigGates)||void 0===i?void 0:i.fluidConfigOpenExternallyEnabled)?[3,6]:[2,q(p,t.fluidHostFile,a,o?o.area:"Other")];case 4:if(h)return[2,Object(H.a)(p,o?o.area:"Other")];r.label=5;case 5:return[2,M(u,o?o.area:"Other")];case 6:return[2,Promise.resolve({success:!1,message:"launchCustomContent:fallThrough"})]}}))}))}function G(e,t,n,o,i){var s;return Object(r.__awaiter)(this,void 0,void 0,(function(){var a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,,2,3]),[4,Object(L.a)(t,{action:e,linkTarget:o,targetTab:null!=i?i:void 0})];case 1:return a=r.sent(),[3,3];case 2:return Object(N.a)({launchInstrumentationParams:n,success:null!==(s=null==a?void 0:a.success)&&void 0!==s&&s,platform:"Web"}),[7];case 3:return[2,a]}}))}))}function V(e,t,n,o,i){var s,a;return Object(r.__awaiter)(this,void 0,void 0,(function(){var c,u,l,d;return Object(r.__generator)(this,(function(h){switch(h.label){case 0:if(c={},!t.router.getUrlForRoute)return[2,{success:!1,message:"getUrlForRoute is undefined"}];if(o&&(c.siteUrl=null===(s=e.sharepointIds)||void 0===s?void 0:s.siteUrl),i&&e.navId&&(c.nav=e.navId),!(u=t.router.getUrlForRoute({route:"Content",type:x.a.Base,app:e.fileType},function(e,t){return void 0===t&&(t={}),Object(r.__assign)(Object(r.__assign)({},t),{drive:e.driveId,item:e.docId,file:e.canonicalUrl})}(e,c))))return[3,4];h.label=1;case 1:return h.trys.push([1,3,,4]),[4,Object(L.a)(u,{action:"OpenDocument",linkTarget:"_blank"})];case 2:return l=h.sent(),Object(N.a)({launchInstrumentationParams:n,success:l.success,platform:"Web"}),[2,l];case 3:return d=h.sent(),Object(N.a)({launchInstrumentationParams:n,success:!1}),[2,{success:!1,message:d instanceof Error?null!==(a=d.stack)&&void 0!==a?a:d.message:void 0}];case 4:return[2,{success:!1,message:"launchUrlWithDocument:fallthrough"}]}}))}))}function $(e,t){var n,o,i,s,a,c,l,h;return Object(r.__awaiter)(this,void 0,void 0,(function(){var f,p,b,y,C,O,T,S,k,E,j,I,A,P;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return f=null!==(n=e.linkTarget)&&void 0!==n?n:Object(v.a)(e.event,e.inAppNavFileType,e.isPwaInUwp),Object(d.a)({featureName:"LauncherService",eventName:"launchDocument",params:{debugInfo:"link target parameter for launcher service",inAppNavFileType:null!==(i=null===(o=e.inAppNavFileType)||void 0===o?void 0:o.toString())&&void 0!==i?i:"",isPwa:null!==(a=null===(s=e.isPwaInUwp)||void 0===s?void 0:s.toString())&&void 0!==a?a:"",linkTarget:f,linkTargetSource:e.linkTarget?"contentLaunchParams":"getContentTarget",wdOriginType:null!==(l=null===(c=e.wdOriginType)||void 0===c?void 0:c.toString())&&void 0!==l?l:""},area:"AppLauncher",subArea:"Document"}),[4,_(e)];case 1:return p=r.sent(),t&&(p.clickId&&(t.clickParams.RequestId=p.clickId),t.dataSecurityLevel=e.document.isLocalFile?u.a.Enhanced:u.a.Security,"_blank"!==f&&Object(N.a)({launchInstrumentationParams:t,success:!0,platform:"Web"})),b=p.context,C=e.useDeeplinkUrl,O=e.wdOriginType,[4,w(y=e.document,p.context,p.capabilities,e.event)];case 2:return(T=r.sent()).fluidHostFile&&t&&e&&"_blank"==e.linkTarget?[4,V(y,b,t,T.fluidHostFile)]:[3,4];case 3:return S=r.sent(),Object(N.a)({launchInstrumentationParams:t,success:S.success,platform:"Web"}),S.result="NewTab",[2,S];case 4:return[4,z(e,T,p,t)];case 5:return(null==(k=r.sent())?void 0:k.success)?[2,k]:[3,6];case 6:return T.fluidHostFile?[4,Object(m.a)()]:[3,8];case 7:return j=r.sent(),[3,9];case 8:j=void 0,r.label=9;case 9:return E=j,I=T.fluidHostFile&&!(null===(h=null==E?void 0:E.result.fluidConfigGates)||void 0===h?void 0:h.fluidConfigOpenExternallyEnabled),(T.shouldHandleWacContent||I)&&b.router.openHostedDocument?(A=Date.now(),[4,b.router.openHostedDocument(y,A,Object(g.a)(b.workload,b.router.getCurrentRoute(),O),T.fluidHostFile,"DocumentClick",C&&y.navId?{actnavid:y.navId}:{})]):[3,11];case 10:return P=r.sent(),Object(N.a)({launchInstrumentationParams:t,success:P,platform:"Web",uiHost:!0}),[2,{success:P,result:"Inline",message:"launchDocument:openHostedDocument"}];case 11:return p.webUrl?[4,G("OpenDocument",p.webUrl,t,f,e.targetTab)]:[3,13];case 12:return[2,r.sent()];case 13:return[2,{success:!1,message:"launchDocument:fallThrough"}]}}))}))}var Q,J=n("uZ+0");function X(e){return Object(r.__awaiter)(this,void 0,void 0,(fu0:return e!==B.a.Embed?[3,2]:[4,n.e(670).then(n.bind(null,"YcLN")).then((function(e){return{getContentLaunchPreference:e.getContentLaunchPreference}}))];case 1:Q=t.sent(),t.label=2;case 2:return[2,Q]}}))}))}var K=n("C2Jl");function Y(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){return[2,G("OpenNativeDocument",null!=(n=Object(K.a)(e))?n:"",t,"_blank")]}))}))}function Z(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,_(e)];case 1:return n=r.sent(),[4,w(e.document,n.context,n.capabilities)];case 2:return o=r.sent(),[2,z(e,o,n,t)]}}))}))}function ee(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,_(e)];case 1:return(n=r.sent()).webUrl?[2,G("OpenDocument",n.webUrl,t,e.document.fileType===b.a.FormsQuiz?"_self":void 0)]:[2,{success:!1,result:"Web"}]}}))}))}function te(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(p.a)()];case 1:return[4,X(r.sent().workload)];case 2:return[4,null==(n=r.sent())?void 0:n.getContentLaunchPreference()];case 3:switch(r.sent()){case J.a.Desktop:return[3,4];case J.a.Inline:return[3,6];case J.a.Web:return[3,8]}return[3,10];case 4:return[4,Y(e.document,t)];case 5:return o=r.sent(),[3,11];case 6:return[4,Z(e,t)];case 7:return o=r.sent(),[3,11];case 8:return[4,ee(e,t)];case 9:return o=r.sent(),[3,11];case 10:o={success:!1},r.label=11;case 11:return[2,o]}}))}))}var ne=n("+k3c"),re=function(e,t){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var n,o,i,m,g,v,b,y,w,C,O,T,S,k,E,_,j,I,A,P,x,D,L,M,R,F,B,U;return Object(r.__generator)(this,(function(W){switch(W.label){case 0:n={success:!1},o="launchContent",i=(null===(I=e.document)||void 0===I?void 0:I.isLocalFile)?u.a.Enhanced:u.a.Security,m={},g="",W.label=1;case 1:return W.trys.push([1,20,21,22]),v=e.document,[4,Object(p.a)()];case 2:return b=W.sent().capabilities,[4,s()];case 3:return g=W.sent(),e.isPwaInUwp=null==b?void 0:b.isPwaInUwp,b.userPreferenceEnabled&&e.document?[4,te(e,t)]:[3,8];case 4:return(null==(y=W.sent())?void 0:y.success)?(n=y,[3,7]):[3,5];case 5:return[4,$(e,t)];case 6:n=W.sent(),W.label=7;case 7:return[3,19];case 8:if(v.isEmaLinkUrl)return[3,17];w=e.disableDefaultLinkBehavior,O=!(C=e.event)||C.defaultPrevented||w?void 0:function(){return null==C?void 0:C.preventDefault()},T=e.newContentParams,S=void 0,W.label=9;case 9:return W.trys.push([9,14,,16]),[4,Object(ne.a)({appName:v.app,filePath:v.canonicalUrl,fileType:v.fileType,prelaunchCallback:O,webUrl:v.webUrl,templateBinaryUrl:null==T?void 0:T.templateBinaryUrl})];case 10:return S=W.sent(),Object(N.a)({launchInstrumentationParams:t,success:S.success}),S.success?(n=Object(r.__assign)(Object(r.__assign)({},S),{result:"Native"}),[3,13]):[3,11];case 11:return[4,$(e,t)];case 12:n=W.sent(),W.label=13;case 13:return[3,16];case 14:return W.sent(),[4,$(e,t)];case 15:return n=W.sent(),[3,16];case 16:return[3,19];case 17:return[4,$(e,t)];case 18:n=W.sent(),W.label=19;case 19:return[3,22];case 20:return k=W.sent(),E=Object(f.a)(k),_=E.debugInfo,j=E.message,Object(l.a)({debugInfo:_,errorType:"LaunchContent_Error",eventName:o,message:j}),m.Error=j,m.DebugInfo=_,[3,22];case 21:return Object(d.a)({eventName:o,featureName:"LauncherService",params:{AppLaunchResult:null!==(A=n.result)&&void 0!==A?A:"",BuildId:g,DocumentType:null!==(x=null===(P=e.document)||void 0===P?void 0:P.fileType)&&void 0!==x?x:"",ErrorCode:null!==(D=n.errorCode)&&void 0!==D?D:"",Message:null!==(L=n.message)&&void 0!==L?L:"",Success:n.success}}),n.success||(Object(a.c)()>=u.a.Enhanced&&(m.ReferralPlatform=e.document?e.document.isLocalFile?"Native":"Web":" Unknown"),m.AdditionalInfo=null!==(M=n.additionalInfo)&&void 0!==M?M:"",m.BuildId=g,m.ErrorCode=null!==(R=n.errorCode)&&void 0!==R?R:"",m.ErrorCodeMessage=null!==(F=n.errorMessage)&&void 0!==F?F:"",m.Message=null!==(B=n.message)&&void 0!==B?B:"",m.DocumentType=null===(U=e.document)||void 0===U?void 0:U.fileType,Object(h.a)({eventName:o,params:m},i),Object(c.a)(o,m,[],i)),[7];case 22:return[2,n]}}))}))}},O4Uw:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("k9HR");function o(e){if("string"!=typeof e.package&&Object(r.b)(e.package))return e.package.name}},O7VI:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("QUcg");function o(e,t){return[`<!DOCTYPE ${a}>`,`<${a}>`,`<${c}>`,'<meta charset="utf-8" />',...s(t),...i(e),`</${c}>`,`</${u}>`,`</${a}>`].join("\n")}fuap((e=>`<${l} crossorigin="anonymous" src="${e}"${t}></${l}>`))}function s(e){return(e||[]).map((e=>`<${h} rel="preconnect" href="${e}" crossose strict";n.d(t,"a",(function(){return r}));class r{constructor(e){this.valueGenerator=e,this._evaluated=!1}._value=this.valueGenerator()),this._value}}},OBDY:function(e,t,n){"use strict";e.exports=function(e){return"object"==typeof e&&!0===e.isAxiosError}},OEfX:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return s}));var r=n("6ib3"),o=new Set([r.a.Word,r.a.Excel,r.a.PowerPoint,r.a.VhrowI(E=!1,k=o(T,!0)):I?(E=!1,k=i(T,!0)):k=[]:p(T)||c(T)?(k=O,c(O)?k=v(O):f(O)&&!h(O)||(k=a(T))):E=!1}E&&(C.set(T,k),y(k,T,b,w,C),C.delete(T)),r(e,n,k)}}},ORuF:function(e){e.exports=JSON.parse('{"af/office-start-resources":"af/office-start-resources-21eb30073d.json","af/search-me-control-resources":"af/search-me-control-resources-c8028289e6.json","am/office-start-resources":"am/office-start-resources-38f68171de.json","am/search-me-control-resources":"am/search-me-control-resources-9993738eec.json","ar/office-start-resources":"ar/office-start-resources-4d14360356.json","ar/search-me-control-resources":"ar/search-me-control-resources-d8a7daa3eb.json","as/office-start-resources":"as/office-start-resources-2e2fb4f2c7.json","as/search-me-control-resources":"as/search-me-control-resources-c3e22c05fc.json","az/office-start-resources":"az/office-start-resources-1fc1551471.json","az/search-me-control-resources":"az/search-me-control-resources-fecfe732f7.json","bg/office-start-resources":"bg/office-start-resources-4eb14dc63d.json","bg/search-me-control-resources":"bg/search-me-control-resources-fe4e0ffeb1.json","bn-in/office-start-resources":"bn-in/office-start-resources-315f409910.json","bn-in/search-me-control-resources":"bn-in/search-me-control-resources-961da04af6.json","bs/office-start-resources":"bs/office-start-resources-adbacbd25b.json","bs/search-me-control-resources":"bs/search-me-control-resources-c4cfce428c.json","ca-es-valencia/office-start-resources":"ca-es-valencia/office-start-resources-5e922fce83.json","ca-es-valencia/search-me-control-resources":"ca-es-valencia/search-me-control-resources-b6d81df6ef.json","ca/office-start-resources":"ca/office-start-resources-2b0072a72e.json","ca/search-me-control-resources":"ca/search-me-control-resources-285ac1fa74.json","cs/office-start-resources":"cs/office-start-resources-24275413d2.json","cs/search-me-control-resources":"cs/search-me-control-resources-090a8848f3.json","cy/office-start-resources":"cy/office-start-resources-ddc6586ccb.json","cy/search-me-control-resources":"cy/search-me-control-resources-9579ad01b9.json","da/office-start-resources":"da/office-start-resources-7c69ae37bb.json","da/search-me-control-resources":"da/search-me-control-resources-2f53398e9d.json","de/office-start-resources":"de/office-start-resources-6499dc1f7d.json","de/search-me-control-resources":"de/search-me-control-resources-1376b1850e.json","el/office-start-resources":"el/office-start-resources-7a852f08f3.json","el/search-me-control-resources":"el/search-me-control-resources-da69800d57.json","en-gb/office-start-resources":"en-gb/office-start-resources-f592cd3228.json","en-gb/search-me-control-resources":"en-gb/search-me-control-resources-a7588fcdc9.json","es-mx/office-start-resources":"es-mx/office-start-resources-c28a7d2d4f.json","es-mx/search-me-control-resources":"es-mx/search-me-control-resources-362f44f771.json","es/office-start-resources":"es/office-start-resources-0cf403aa36.json","es/search-me-control-resources":"es/search-me-control-resources-3b79806506.json","et/office-start-resources":"et/office-start-resources-6b16618c9e.json","et/search-me-control-resources":"et/search-me-control-resources-a4d4149061.json","eu/office-start-resources":"eu/office-start-resources-e29695fb3a.json","eu/search-me-control-resources":"eu/search-me-control-resources-796bb4a379.json","fa/office-start-resources":"fa/office-start-resources-3020bcfd2f.json","fa/search-me-control-resources":"fa/search-me-control-resources-327ba3f149.json","fi/office-start-resources":"fi/office-start-resources-7e2c8be34c.json","fi/search-me-control-resources":"fi/search-me-control-resources-821a45203e.json","fil/office-start-resources":"fil/office-start-resources-d70593afac.json","fil/search-me-control-resources":"fil/search-me-control-resources-43cf9478fe.json","fr-ca/office-start-resources":"fr-ca/office-start-resources-1f1a968fdf.json","fr-ca/search-me-control-resources":"fr-ca/search-me-control-resources-e5f06dc12c.json","fr/office-start-resources":"fr/office-start-resources-f044050dff.json","fr/search-me-control-resources":"fr/search-me-control-resources-36d8e21c24.json","ga/office-start-resources":"ga/office-start-resources-c276811aac.json","ga/search-me-control-resources":"ga/search-me-control-resources-7942ccb3f1.json","gd/office-start-resources":"gd/office-start-resources-d638c7a446.json","gd/search-me-control-resources":"gd/search-me-control-resources-f98c714f77.json","gl/office-start-resources":"gl/office-start-resources-ed7ef6dad7.json","gl/search-me-control-resources":"gl/search-me-control-resources-4122d5eb25.json","gu/office-start-resources":"gu/office-start-resources-1466516223.json","gu/search-me-control-resources":"gu/search-me-control-resources-c9bd590306.json","he/office-start-resources":"he/office-start-resources-08e17a8141.json","he/search-me-control-resources":"he/search-me-control-resources-1d6156fdcc.json","hi/office-start-resources":"hi/office-start-resources-812f51b836.json","hi/search-me-control-resources":"hi/search-me-control-resources-9c8034488f.json","hr/office-start-resources":"hr/office-start-resources-00c51c7831.json","hr/search-me-control-resources":"hr/search-me-control-resources-0720fa1500.json","hu/office-start-resources":"hu/office-start-resources-d24e8076f3.json","hu/search-me-control-resources":"hu/search-me-control-resources-65e30b77a1.json","hy/office-start-resources":"hy/office-start-resources-5b469e431c.json","hy/search-me-control-resources":"hy/search-me-control-resources-55534b096d.json","id/office-start-resources":"id/office-start-resources-800bd593a3.json","id/search-me-control-resources":"id/search-me-control-resources-11eb90ff74.json","is/office-start-resources":"is/office-start-resources-b44a4d6b0c.json","is/search-me-control-resources":"is/search-me-control-resources-19a44b44d1.json","it/office-start-resources":"it/office-start-resources-260201136f.json","it/search-me-control-resources":"it/search-me-control-resources-a8f124c052.json","ja/office-start-resources":"ja/office-start-resources-7c0f110061.json","ja/search-me-control-resources":"ja/search-me-control-resources-affd172420.json","ka/office-start-resources":"ka/office-start-resources-e3402fc59b.json","ka/search-me-control-resources":"ka/search-me-control-resources-58d1f4104a.json","kk/office-start-resources":"kk/office-start-resources-f1e4d73413.json","kk/search-me-control-resources":"kk/search-me-control-resources-c720f747dc.json","km-kh/office-start-resources":"km-kh/office-start-resources-500a092e48.json","km-kh/search-me-control-resources":"km-kh/search-me-control-resources-356566e869.json","kn/office-start-resources":"kn/office-start-resources-147c752e65.json","kn/search-me-control-resources":"kn/search-me-control-resources-57618c4c91.json","ko/office-start-resources":"ko/office-start-resources-e665b67a68.json","ko/search-me-control-resources":"ko/search-me-control-resources-45a8fc6279.json","kok/office-start-resources":"kok/office-start-resources-da11a9f4cd.json","kok/search-me-control-resources":"kok/search-me-control-resources-80f02e6fa4.json","lb/office-start-resources":"lb/office-start-resources-153d328115.json","lb/search-me-control-resources":"lb/search-me-control-resources-66d5eebdcb.json","lo/office-start-resources":"lo/office-start-resources-66bb452c48.json","lo/search-me-control-resources":"lo/search-me-control-resources-514fcc8e7b.json","lt/office-start-resources":"lt/office-start-resources-5b22e181dc.json","lt/search-me-control-resources":"lt/search-me-control-resources-846d9a66fe.json","lv/office-start-resources":"lv/office-start-resources-d84eeed661.json","lv/search-me-control-resources":"lv/search-me-control-resources-cfbef68d6c.json","mi/office-start-resources":"mi/office-start-resources-e632ba9c3e.json","mi/search-me-control-resources":"mi/search-me-control-resources-28da62231a.json","mk/office-start-resources":"mk/office-start-resources-6f80080a63.json","mk/search-me-control-resources":"mk/search-me-control-resources-03d885d51b.json","ml/office-start-resources":"ml/office-start-resources-60953423ba.json","ml/search-me-control-resources":"ml/search-me-control-resources-eaf522c8ab.json","mr/office-start-resources":"mr/office-start-resources-04441b3a6d.json","mr/search-me-control-resources":"mr/search-me-control-resources-33b56b9876.json","ms/office-start-resources":"ms/office-start-resources-d85d18b2dc.json","ms/search-me-control-resources":"ms/search-me-control-resources-45770c79f9.json","mt/office-start-resources":"mt/office-start-resources-ae7551630d.json","mt/search-me-control-resources":"mt/search-me-control-resources-11d7afdbce.json","nb-no/office-start-resources":"nb-no/office-start-resources-8ee32147bc.json","nb-no/search-me-control-resources":"nb-no/search-me-control-resources-207119e3c0.json","ne/office-start-resources":"ne/office-start-resources-aad6e8be5e.json","ne/search-me-control-resources":"ne/search-me-control-resources-dbcb1821ad.json","nl/office-start-resources":"nl/office-start-resources-ef2c4d4ff9.json","nl/search-me-control-resources":"nl/search-me-control-resources-835defbb8f.json","nn-no/office-start-resources":"nn-no/office-start-resources-936287b691.json","nn-no/search-me-control-resources":"nn-no/search-me-control-resources-0d9fa7348c.json","or/office-start-resources":"or/office-start-resources-b48ee4783e.json","or/search-me-control-resources":"or/search-me-control-resources-6e657c318a.json","pa/office-start-resources":"pa/office-start-resources-56e5fd0568.json","pa/search-me-control-resources":"pa/search-me-control-resources-14083a3d53.json","pl/office-start-resources":"pl/office-start-resources-86f114d6d7.json","pl/search-me-control-resources":"pl/search-me-control-resources-44278bd246.json","pt-br/office-start-resources":"pt-br/office-start-resources-22fad791a9.json","pt-br/search-me-control-resources":"pt-br/search-me-control-resources-ac363febbb.json","pt-pt/office-start-resources":"pt-pt/office-start-resources-db5bf04b97.json","pt-pt/search-me-control-resources":"pt-pt/search-me-control-resources-487254e0b4.json","quz/office-start-resources":"quz/office-start-resources-f67dcdbcfb.json","quz/search-me-control-resources":"quz/search-me-control-resources-742178dbed.json","ro/office-start-resources":"ro/office-start-resources-797ac16eda.json","ro/search-me-control-resources":"ro/search-me-control-resources-2ba8e3e62d.json","ru/office-start-resources":"ru/office-start-resources-f9a906c018.json","ru/search-me-control-resources":"ru/search-me-control-resources-e86d48cab1.json","sk/office-start-resources":"sk/office-start-resources-a5b36c4bd9.json","sk/search-me-control-resources":"sk/search-me-control-resources-591c50e0bb.json","sl/office-start-resources":"sl/office-start-resources-4720999b11.json","sl/search-me-control-resources":"sl/search-me-control-resources-def5ae0dce.json","sq/office-start-resources":"sq/office-start-resources-902b8ad542.json","sq/search-me-control-resources":"sq/search-me-control-resources-f142459356.json","sr-cyrl-ba/office-start-resources":"sr-cyrl-ba/office-start-resources-77c3e008f1.json","sr-cyrl-ba/search-me-control-resources":"sr-cyrl-ba/search-me-control-resources-fca230cd09.json","sr-cyrl-rs/office-start-resources":"sr-cyrl-rs/office-start-resources-591742481a.json","sr-cyrl-rs/search-me-control-resources":"sr-cyrl-rs/search-me-control-resources-fd760c6e4c.json","sr-latn-rs/office-start-resources":"sr-latn-rs/office-start-resources-770fea8fea.json","sr-latn-rs/search-me-control-resources":"sr-latn-rs/search-me-control-resources-46cf035e4d.json","sv/office-start-resources":"sv/office-start-resources-40657de19b.json","sv/search-me-control-resources":"sv/search-me-control-resources-422305af0b.json","ta/office-start-resources":"ta/office-start-resources-0f377dba17.json","ta/search-me-control-resources":"ta/search-me-control-resources-27239afbd7.json","te/office-start-resources":"te/office-start-resources-ddc9ceb238.json","te/search-me-control-resources":"te/search-me-control-resources-7016e3e2d4.json","th/office-start-resources":"th/office-start-resources-d18484a251.json","th/search-me-control-resources":"th/search-me-control-resources-93d10ae3cd.json","tr/office-start-resources":"tr/office-start-resources-9ad1c06c0d.json","tr/search-me-control-resources":"tr/search-me-control-resources-dc37f42a6d.json","tt/office-start-resources":"tt/office-start-resources-7fc81c459b.json","tt/search-me-control-resources":"tt/search-me-control-resources-21f8499422.json","ug/office-start-resources":"ug/office-start-resources-8c9989eb78.json","ug/search-me-control-resources":"ug/search-me-control-resources-d45641ff75.json","uk/office-start-resources":"uk/office-start-resources-976501c3b3.json","uk/search-me-control-resources":"uk/search-me-control-resources-2e1bdd16e5.json","ur/office-start-resources":"ur/office-start-resources-1fb4118733.json","ur/search-me-control-resources":"ur/search-me-control-resources-485089f2ee.json","uz-latn-uz/office-start-resources":"uz-latn-uz/office-start-resources-e6daed73cb.json","uz-latn-uz/search-me-control-resources":"uz-latn-uz/search-me-control-resources-8328fb040d.json","vi/office-start-resources":"vi/office-start-resources-0e04f54bf5.json","vi/search-me-control-resources":"vi/search-me-control-resources-41cfa4ab5b.json","zh-hans/office-start-resources":"zh-hans/office-start-resources-fcc644e7a2.json","zh-hans/search-me-control-resources":"zh-hans/search-me-control-resources-d2e855a9bd.json","zh-hant/office-start-resources":"zh-hant/office-start-resources-b482699a80.json","zh-hant/search-me-control-resources":"zh-hant/search-me-controloint.com)/,"(redacted)").replace(/(https:\/\/)(dev.loop.microsoft.com|df.loop.microsoft.com|loop.microsoft.com)(\/p\/)([a-zA-Z0-9%]+)/,"(redacted)")}function i(e,t){e.send({...t,category:r.b.Generic})}function s(e,t,n){n&&function(e,t){!function(e,t){var n;const r="object"==typeof e&&null!==e;function o(t){if(!r)return;const n=e[t];return"string"==typeof n?n:void 0}t.errorMessage=null!==(n=o("message"))&&void 0!==n?n:String(e),t.errorName=o("name"),t.stack=o("stack"),t.errorType=o("errorType"),t.errorInstanceId=o("errorInstanceId")}(t,e),e.message=e.message?`${e.message}\n${e.errorMessage}`:e.errorMessage,void 0===e.stack&&(e.stack=function(){let e=(new Error).stack;if(!e)try{throw new Error}catch(t){e=t.stack}return e}()),e.errorMessage&&(e.errorMessage=o(e.errorMessage.toString())),e.message&&(e.message=o(e.message.toString())),e.stack&&(e.stack=o(e.stack.toString())),e.error&&(e.error=o(e.error.toString())),e.responseMessage&&(e.responseMessage=o(e.responseMessage.toString()))}(t,n),e.send({...t,category:r.b.Error})}new Set,new Set,new Map([["Automation",1],["SyntheticTraffic",1],["Local",1],["Staging",1],["Dogfood",.1],["Preview",.1],["Microsoft",.01],["Production",.001],["GCC",0],["GCC-High",0],["DoD",0]])},OfNt:function(e,t,n){"use strict";let r,o;n.d(t,"a",(function(){return i}));try{r=localStorage}catch(e){}r||(r=void 0);try{o=sessionStorage}catch(e){}function i(){return r}o||(o=void 0)},OhPl:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("ZaV9");function o(e){const t=Object(r.b)(e);if(!t)return;let n;try{(null==t?void 0:t.siteUrl)&&(n=new URL(null==t?void 0:t.siteUrl).origin)}catch(e){}return{codeDetailsHint:null==t?void 0:t.containerPackageName,criticalBootDomains:n?[n]:void 0}}},Ohvh:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("6ib3"),o={none:r.a.None,excel:r.a.Excel,onenote:r.a.OneNote,pdf:r.a.Pdf,powerpoint:r.a.PowerPoint,audio:r.a.Audio,video:r.a.Video,visio:r.a.Visio,word:r.a.Word,photos:r.a.Photos,text:r.a.Text,outlook:r.a.Outlook,sway:r.a.Sway,forms:r.a.Forms,formsquiz:r.a.FormsQuiz,project:r.a.Project,projectoperations:r.a.ProjectOperations,portfolio:r.a.Portfolio,news:r.a.NewsArticle,newsarticle:r.a.NewsArticle,onedrive:r.a.OneDrive,sharepoint:r.a.SharePoint,bohemia:r.a.Fluid,fluid:r.a.Fluid,powerbi:r.a.PowerBI,streamsvideo:r.a.StreamsVideo,yammer:r.a.Yammer,mindmeister:r.a.MindMeister,stream:r.a.Stream,monday:r.a.Monday,trello:r.a.Trello,platform:r.a.Platform,image:r.a.Image,media:r.a.Media,whigNotesthis.;0!=o--;)if(!Object.prototype.hasOwnProperty.call(n,i[o]))return!1;for(o=r;0!=o--;){var s=i[o];if(!e(t[s],n[s]))return!1}return!0}return t!=t&&n!=n}},Ot9e:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("QjXU");function o(e,t){var n,o;void 0===t&&(t=!0);var i={},s=e.length>0&&"?"===e[0]&&t?e.slice(1):e;if(s){var a=s.split("&");try{for(var c=Object(r.__values)(a),u=c.next();!u.done;u=c.next()){var l=u.value,d=Object(r.__read)(l.split("="),2);i[d[0]]=d[1]}}catch(e){n={error:e}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}}return i}},P1B7:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r=n("QjXU");function o(e,t,n,o,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var s,a,c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:s=e(),a=t(),c=null,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,a];case 2:return c=r.sent(),[3,4];case 3:return r.sent(),[3,4];case 4:return u=s.then((function(e){var t=i(e);return c&&o({result:t,fromPersistence:!1}),n(e),{result:t,fromPersistence:!1}})),c?[2,{result:i(c),fromPersistence:!0}]:[2,u]}}))}))}function i(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){return[2,o(e,t,n,i,(function(e){return e}))]}))}))}},P8ZZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("NrNW"),o=n("B5kz"),i=n("CaQ9"),s=n("CDFH");function a(){var e=Object(r.a)().data,t=Object(i.a)}},PHxc:function(e,t,n){var r=n("cm7J");e.exports=function(e,t){var n=this.__data__,o=r(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this}},PT5P:function(e,t,n){"use strict";nr: "+e),Object.setPrototypeOf(this,r.prototype)}}},PYDc:function(e,t,n){var r=n("FEiO");e.exports=function(){this.__data__=r?r(null):{},this.size=0}},PnKM:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return a}));var r=n("kxAM");function o(e){return[`${Object(r.a)(ell`]}const i=["https://pushchannel.1drv.ms/pushchannel.readwrite.all"];function s(){return i}async function a(e,t){const n=t.map((t=>e.getToken(o(t))));return n.push(e.getToken(s())),Promise.all(n)}},PqlX:function(e,t){e.exports=Array.isArray},"Ptfunction(){function e(){}return function(t){if(!r(t))return{};if(o)return o(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();e.exports=i},QLkI:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("QjXU"),o=n("28zg"),i=n("JGoI");function s(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return[2,Object(o.a)(i.a)]}))}))}},QMGX:function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var r=n("QjXU"),o=n("JIAX"),i=n("ovpI"),s=n("GBVN"),a=n("c+Fk"),c=n("iTb/"),u=n("U4Iz"),l=n("6ib3");function d(e){switch(e){case l.a.Designer:return"ms-ohp-svg-Icon ms-ohp-Icon--designerLogo";case l.a.Excel:return"ms-Icon ms-Icon--ExcelLogo ms-svg-Icon";case l.a.Fluid:return"ms-ohp-svg-Icon ms-ohp-Icon--fluidLogo";case l.a.Forms:return"ms-Icon ms-Icon--OfficeFormsLogo ms-svg-Icon";case l.a.PowerPoint:return"ms-Icon ms-Icon--PowerPointLogo ms-svg-Icon";case l.a.Word:return"ms-Icon ms-Icon--WordLogo ms-svg-Icon";case l.a.Visio:return"ms-Icon ms-Icon--VisioLogo ms-svg-Icon";case l.a.OneNote:return"ms-Icon ms-Icon--OneNoteLogo ms-svg-Icon";case l.a.PowerBI:return"ms-Icon ms-Icon--PowerBILogo ms-svg-Icon";case l.a.Sway:return"ms-Icon ms-Icon--SwayLogo32 ms-svg-Icon";case l.a.Stream:return"ms-Icon ms-Icon--StreamLogo ms-svg-Icon";case l.a.Whiteboard:return"ms-Icon ms-Icon--WhiteboardLogo ms-svg-Icon";case l.a.List:return"ms-Icon ms-Icon--ListsLogo ms-svg-Icon";case l.a.Yammer:return"ms-Icon ms-Icon--VivaEngageLogo ms-svg-Icon";case l.a.Clipchamp:return"ms-Icon ms-Icon--ClipchampLogo ms-svg-Icon";default:return null}}var h=n("GE1V"),f=n("YTdI"),p=n("vnUm"),m=n("AcOL"),g=n("5DIn"),v=n("43jW"),b=n("mXGw"),y=n.n(b),w=n("p/uK"),C=n("sLnE"),O=n("DU/N"),T=Object(w.a)({container:Object(r.__assign)({display:"flex",flexDirection:"column"},C.a.margin("0px","60px")),singleColumnContainer:Object(r.__assign)({},C.a.margin("0px","40px")),appIconWrapper:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},pillAppIcon:{fontSize:"20px"},header:{height:"112px",display:"flex"},singleColumnHeader:{height:"72px"},headerTitle:{marginTop:"48px",marginBottom:"40px",position:"relative",height:"24px",fontFamily:O.a.fontFamilyBase,fontWeight:O.a.fontWeightSemibold,fontSize:O.a.fontSizeBase400,lineHeight:O.a.lineHeightBase400},containerContent:{display:"flex",flexDirection:"column",marginBottom:"40px",rowGap:"8px"},headerSubTitle:{height:"16px",fontFamily:O.a.fontFamilyBase,fontWeight:O.a.fontWeightSemibold,fontSize:O.a.fontSizeBase200,lineHeight:O.a.lineHeightBase200,color:O.a.colorNeutralForeground3},singleColumnHeaderTitle:{marginTop:"28px",marginBottom:"20px"},seeAllAppsLink:Object(r.__assign)(Object(r.__assign)({display:"flex"},C.a.gap("4px")),{justifyContent:"flex-end"})}),S=n("iijs"),k=n("vtYf"),E=n("x3xY"),_=n("f6UF"),j=Object(w.a)({suggestionCardContainer:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({display:"flex",flexDirection:"column"},C.a.border("1px","solid",O.a.colorTransparentStroke)),{boxShadow:O.a.shadow4}),C.a.borderRadius("8px")),suggestionCard:{display:"flex",flexDirection:"row",backgroundColor:O.a.colorNeutralBackground1,outlineStyle:"none"},latencyLoader:{height:O.a.spacingVerticalXS},previewBox:Object(r.__assign)(Object(r.__assign)({width:"50%"},C.a.margin("8px","0px","8px","8px")),C.a.border("1px","solid",O.a.colorTransparentStroke)),appContent:Object(r.__assign)({width:"50%",minHeight:"280px",display:"flex",flexDirection:"column"},C.a.margin("12px","16px","12px","16px")),reasonMarkerContainer:{marginBottom:"8px",outlineStyle:"none",display:"flex",flexDirection:"row",flexWrap:"nowrap",fontFamily:O.a.fontFamilyBase,fontWeight:O.a.fontWeightRegular,fontSize:O.a.fontSizeBase200,lineHeight:O.a.lineHeightBase200},reasonMarkerText:{color:O.a.colorNeutralForeground3},reasonMarkerIcon:{color:O.a.colorCompoundBrandForeground1,paddingRight:"4px"},appIconWrapper:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},appIcon:{fontSize:"72px"},appTitle:{marginBottom:"8px",color:O.a.colorNeutralForeground1,fontFamily:O.a.fontFamilyBase,fontWeight:O.a.fontWeightSemibold,fontSize:O.a.fontSizeBase400,lineHeight:O.a.lineHeightBase400},appDescription:{color:O.a.colorNeutralForeground3,fontFamily:O.a.fontFamilyBase,fontWeight:O.a.fontWeightRegular,fontSize:O.a.fontSizeBase200,lineHeight:O.a.lineHeightBase200},gap:Object(r.__assign)({},C.a.flex(1,0,"32px")),actionInformation:{marginTop:"32px",fontFamily:O.a.fontFamilyBase,fontWeight:O.a.fontWeightRegular,fontSize:O.a.fontSizeBase100,lineHeight:O.a.lineHeightBase100},appActionButtonContainer:Object(r.__assign)(Object(r.__assign)({display:"flex",flexDirection:"row",justifyContent:"flex-end"},C.a.gap("16px","0px")),{flexWrap:"wrap"}),appActionBtn:Object(r.__assign)({alignSelf:"end",marginTop:"12px"},C.a.borderRadius("4px"))}),I=function(e){var t,n=e.dialogState,r=e.disabled,a=e.firstDraftResources,u=e.handleCopyContentClick,l=e.handleCreateWithContentClickWrapper,h=e.handleCreateBlankDocClickWrapper,v=e.suggestedDocumentCardItem,w=e.textAreaRef,C=e.isCreationError,O=e.showLatencyLoading,T=j(),I=v.app,N=v.fileType,A=v.likelihood,P=v.description,x=v.showCopyButton,D=v.creationType,L=Object(b.useCallback)((function(e,t){if(Object(m.a)(e)===g.a.Enter){switch(t){case"copy":u&&u();break;case"createWithContent":l&&l(N,A,w);break;case"createBlank":h&&h(N,A)}e.preventDefault()}}),[N,u,h,l,A,w]),M=Object(b.useMemo)((function(){return D===p.e.CreateWithContent&&n!==f.b.AppOnlyResult?a.createButton:D===p.e.OpenApp?Object(_.format)(a.openAppButtonText,I):a.createNewButton}),[I,D,n,a.createButton,a.createNewButton,a.openAppButtonText]),R=Object(b.useMemo)((function(){switch(A){case o.a.MostLikely:case o.a.VeryLikely:return y.a.createElement("div",{className:T.reasonMarkerContainer},y.a.createElement(c.o,{className:T.reasonMarkerIcon,"aria-hidden":!1}),y.a.createElement("div",{className:T.reasonMarkerText},a.topSuggestionTitle));default:return null}}),[a.topSuggestionTitle,A,T.reasonMarkerContainer,T.reasonMarkerIcon,T.reasonMarkerText]),F=r;return D===p.e.CreateWithContent&&(F=r||C),y.a.createElement("div",{className:T.suggestionCardContainer},y.a.createElement("div",{className:T.suggestionCard},y.a.createElement("div",{className:T.previewBox},y.a.createElement("div",{className:Object(s.a)("o365cs-base",T.appIconWrapper)},y.a.createElement(i.a,{"aria-hidden":!0,className:Object(s.a)(null!==(t=d(N))&&void 0!==t?t:"",T.appIcon)}))),y.a.createElement("div",{className:T.appContent},R,y.a.createElement("div",{className:T.appTitle},I),y.a.createElement("div",{className:T.appDescription},P),y.a.createElement("div",{className:T.gap}),x&&w?y.a.createElement("div",{className:T.actionInformation},Object(_.format)(a.copyTextDiscllement("diButtonContainer},x?y.a.createElement(E.a,{size:"medium",className:T.appActionBtn,onClick:function(){return u&&u()},onKeyDown:function(e){L(e,"copy")},disabled:r,"aria-label":a.copyTextButton},a.copyTextButton):null,y.a.createElement(E.a,{appearance:"primary",size:"medium",className:T.appActionBtn,onClick:function(){D===p.e.CreateWithContent&&n!==f.b.AppOnlyResult?l&&l(N,A,w):h&&h(N,A)},onKeyDown:function(e){L(e,D===p.e.CreateWithContent&&n!==f.b.AppOnlyResult?"createWithContent":"createBlank")},disabled:F,"aria-label":M},M)))),O?y.a.createElement(S.a,null,y.a.createElement(k.a,{className:T.latencyLoader,header:{children:y.a.createElement("div",null)}})):null)},N=Object(w.a)({light_bg:{backgroundColor:"#FFFFFF",":hover":{backgroundColor:"#F5F5F5"},":active":{backgroundColor:"#E0E0E0"},":focus":{backgroundColor:"#FFFFFF"}},dark_bg:{backgroundColor:"#292929",":hover":{backgroundColor:"#3D3D3D"},":active":{backgroundColor:"#1F1F1F"},":focus":{backgroundColor:"#292929"}}}),A=function(e){return e.explanation},P=n("Y0sh"),x=function(e){var t=e.disabled,n=e.dialogState,w=e.textAreaRef,C=e.documentTypeRecommendations,O=e.firstDraftResources,S=e.handleCopyContentClick,k=e.handleCreateWithContentClickWrapper,E=e.handleCreateBlankDocClickWrapper,_=e.handleSeeAllAppsClick,j=e.isDarkMode,x=e.errorProps,D=e.handleCopyAndCreateFallback,L=e.showLatencyLoading,M=e.displayTitle,R=void 0===M||M,F=T(),B=Object(b.useMemo)((function(){return Object(s.a)(F.container,n===f.b.AppOnlyResult?F.singleColumnContainer:"")}),[n,F]),U=Object(b.useMemo)((function(){return Object(s.a)(F.header,n===f.b.AppOnlyResult?F.singleColumnHeader:"")}),[n,F]),W=Object(b.useMemo)((fub.AppOnlyResult?F.singleColumnHeaderTitle:"")}),[n,F]),q=Object(b.useMemo)((function(){return C.sort((function(e,t){return t.likelihood-e.likelihood}))}),[C]),H=function(e,t){var n=N(),r=Object(b.useCallback)((function(){return n["".concat(e?"dark":"light","_bg")]}),[e,n]),o=Object(b.useCallback)((function(e){return e===l.a.Fluid?"Loop":e===l.a.Yammer?"Engage":e}),[]),i=Object(b.useCallback)((function(e){return-1!==p.f.indexOf(e)?p.e.OpenApp:-1!==p.d.indexOf(e)?p.e.CreateWithContent:p.e.CreateNew}),[]);return Object(b.useCallback)((function(e){var n=Object(P.a)(e.app),s=i(n);return{id:l.a[n],app:o(n),fileType:n,brandColor:r(),description:A(e),likelihood:e.lie.CreateWithContent&&-1!==p.c.indexOf(n),creationType:s}}),[o,r,t,i])}(j,n),z=Object(b.useMemo)((function(){return q.map((function(e){return H(e)}))}),[q,H]),G=Object(r.__read)(Object(b.useState)(z.length?z[0].id:""),2),V=G[0],$=G[1],Q=Object(r.__read)(Object(b.useState)(z.length?z[0]:void 0),2),J=Q[0],X=Q[1],K=Object(b.useCallback)((function(e){var t;return y.a.createElement("div",{className:Object(s.a)("o365cs-base",F.appIconWrapper)},y.a.createElement(i.a,{"aria-hidden":!0,className:Object(s.a)(null!==(t=d(e))&&void 0!==t?t:"",F.pillAppIcon)}))}),[F.appIconWrapper,F.pillAppIcon]),Y=Object(b.useCallback)((function(e){if(e===o.a.MostLikely||e===o.a.VeryLikely)return y.a.createElement(c.n,{"aria-hidden":!1})}),[]),Z=Object(b.useCallback)((function(e){tabs:z.map((function(e){return{id:e.fileType,title:e.app,iconElement:K(e.fileType),iconElementActive:K(e.fileType),iconElementRight:Y(e.likelihood)}})),onSelectTab:Z,showPills:!0,activeTabId:V,pivotsOverflow:v.b.Dropdown,persistTabOrder:!0,dropdownButtonText:O.suggestedAppsDropdownOverflowText,isFluentPill:!0}}),[z,O.suggestedAppsDropdownOverflowText,K,Y,V,Z]),te=Object(b.useCallback)((function(){J&&(null==D||D(J.fileType,J.likelihood))}),[D,J]),ne=Object(r.__read)(Object(b.useState)(z.length?z[0].creationType:void 0),2),re=ne[1],oe=(null==x?void 0:x.createdDocType)==(null==J?void 0:J.fileType)&&(null==x?void 0:x.showError)&&(null==x?void 0:x.errorLocation)==f.c.CreationError&&ne[0]===p.e.CreateWithContent;return C?y.a.createElement("div",{className:B},R?y.a.createElement("div",{className:U},y.a.createElement("div",{className:W},O.appSuggestionTitle)):null,y.a.createElement("div",{className:F.containerContent},y.a.createElement("div",{className:F.headerSubTitle},O.suggestedAppsText),y.a.createElement(v.a,Object(r.__assign)({},ee)),J?y.a.createElement(y.a.Fragment,null,y.a.createElement(I,{dialogState:n,disabled:t,textAreaRef:w,suggestedDocumentCardItem:J,firstDraftResources:O,handleCopyContentClick:S,handleCreateWithContentClickWrapper:k,handleCreateBlankDocClickWrapper:E,isCreationError:oe,showLatencyLoading:L}),oe&&y.a.createElement(h.a,Object(r.__assign)({},x,{handleCopyAndCreateFallback:te}))):null,n!==f.b.AppOnlyResult?y.a.createElement(a.a,{onClick:function(){_&&_()},onKeyDown:function(e){Object(m.a)(e)===g.a.Enter&&(_&&_(),e.preventDefault())},tabIndex:0,className:F.seeAllAppsLink},O.seeAllAppsLink,y.a.(s=e.length>3&&"function"==typeof s?(i--,s):void 0,a&&o(n[0],n[1],a)&&(s=i<3?void 0:s,i=1),t=Object(t);++r<i;){var c=n[r];c&&e(t,c,r,s)}return t}))}},Qr0m:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("Hhhn");function o(e){const t=e.get("www-authenticate");if(!t)return;const n=t.indexOf(r.b);if(n<0)return;let o;return t.substring(n+r.b.length).split(",").map((e=>{if(!o){const t=e.split("=");t.length>=2&&"realm"===t[0].trim().toLowerCase()&&(o=JSON.parse(t[1].trim()))}})),o}},RAG2:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("QjXU"),o=n("mgFK"),i=n("aADZ"),s={key:"MruConfig",isGetClientGeneratedConfigEnabled:function(e){var t;return!!(null===(t=e.resolveConfigGates)||void 0===t?void 0:t.resolveConfigMruEnabled)},getClientGeneratedConfig:function(e){var t,n,r,o,s,a,c,u,l,d,h,f,p,m,g,v,b,y=e.featureGates,w=e.featureSettings,C=e.userEntitlements;if(null===C)throw new Error("UserEntitlements is null");var O=C.isCommercialUser,T=y.mruGates,S=w.mru,k=null!==(t=null==T?void 0:T.mruOfficeFeedEnabled)&&void 0!==t&&t,E=null!==(n=null==T?void 0:T.mruOfficeFeedFlightEnabled)&&void 0!==n&&n,_=null!==(r=null==T?void 0:T.mruRecommendedVisioEnabled)&&void 0!==r&&r,j=null!==(o=null==T?void 0:T.mruUpcomingMeetingEnabled)&&void 0!==o&&o,I=null!==(s=null==T?void 0:T.mruPdfEnabled)&&void 0!==s&&s,N=null!==(a=null==S?void 0:S.recommendedApiDismissedDocumentsPath)&&void 0!==a?a:"",A=null!==(c=null==S?void 0:S.recommendedB2ApiFilesPath)&&void 0!==c?c:"",P=null!==(u=null==S?void 0:S.recommendedB2ApiRootPath)&&void 0!==u?u:"",x=Object(i.a)(null!==(l=null==S?void 0:S.numRecommendedToRequest)&&void 0!==l?l:"0"),D=null!==(d=null==S?void 0:S.mruServiceRoot)&&void 0!==d?d:"",L=null!==(h=null==S?void 0:S.shareApiEndpoint)&&void 0!==h?h:"",M=null!==(p=null===(f=null==w?void 0:w.resources)||void 0===f?void 0:f.substrate)&&void 0!==p?p:"";return{mruServiceRoot:D,numRecommendedToRequest:x,officeFeedApiRootPath:null!==(m=null==S?void 0:S.officeFeedApiRootPath)&&void 0!==m?m:"",officeFeedControlEnabled:O&&k,officeFeedFlightEnabled:O&&E,recommendedApiDismissedDocumentsPath:N,recommendedB2ApiFilesPath:A,recommendedB2ApiRootPath:P,recommendedPdfEnabled:I&&O,recommendedVisioEnabled:_,shareApiEndpoint:L,substrateApiEndpoint:M,upcomingMeetingEnabled:j,threeSRecommendationsRootPath:null!==(g=null==S?void 0:S.threeSRecommendationsRootPath)&&void 0!==g?g:"",threeSRecommendedDocumentsPath:null!==(v=null==S?void 0:S.threeSRecommendedDocumentsPath)&&void 0!==v?v:"",threeSRecommendedDocumentsDismissPath:null!==(b=null==S?void 0:S.threeSRecommendedDocumentsDismissPath)&&void 0!==b?b:""}},getServerGeneratedConfig:function(e){return function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(o.a)("mruConfig",e)];case 1:return[2,t.sent()]}}))}))}(e)}}},Rect(r.a)(e);return t&&t.hostname||""}},RJ4T:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Log="Log"}(r||(r={}))},RV7E:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return s}));var r=new(n("AlWG").a)(null);function o(){return r.asObservable()}function i(e){r.next(e)}function s(){r.next(null)}},"RW/s":function(e,t,n){var r=n("iOq2"),o=n("HE1N"),i=n("VZJX"),s=n("J9xP"),a=n("PHxc");function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=s,c.prototype.set=a,e.exports=c},Rh0W:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("Zmq1"),o=nloadeion(e){if(!o(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},Ry7x:function(e,t,n){"use strict";n.d(t,"c",(function(){return C})),n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return T}));var r=n("QjXU"),o=n("uReB"),i=n("NZpx"),s=n("NrNW"),a=n("ynVX"),c=n("B5kz"),u=n("CaQ9"),l=n("Chyi"),d=n("h8qh"),h=n("ZjeS"),f=n("HeHW"),p=n("Coo+"),m=n("K7tG"),g=n("mXGw"),v=n("jwKD"),b=n("zpal"),y=n("CU8J"),w=function(){var e=Object(y.a)().data;return Object(g.useMemo)((function(){if(e)return Object(v.b)(e.result)}),[e])},C=function(){var e,t,n=Object(s.a)().data,r=Object(i.a)().data,o=Object(d.a)().data,h=Object(p.a)().data,f=function(){var e=Object(s.a)().data,t=Object(u.a)().data,n=Object(a.a)().data,r=["GraphMyDriveInfo"];return Object(c.c)(r,(function(){return Object(l.a)(e,t,n,(function(e){return c.a.setQueryData(r,e)}))}),{staleTime:1/0,cacheTime:1/0,enabled:e&&t&&n})}(),m=w();return Object(g.useMemo)((function(){var e,t;if(!n||!m||!r||!o||!(null==h?void 0:h.result)||f.isLoading||f.isInitialData)return[void 0,void 0,void 0,void 0];var i=Object(v.d)({actionsGates:m,capabilities:r,componentContext:n,userDriveId:null===(t=null===(e=f.data)||void 0===e?void 0:e.result)||void 0===t?void 0:t.driveId,userEntitlements:h.result});return[o.documentActionsMenuResources,o.documentActionsToastResources,o.actionsInContextDialogResources,i]}),[n,m,r,o,null==h?void 0:h.result,f.isLoading,f.isInitialData,null===(t=null===(e=f.data)||void 0===e?void 0:e.result)||void 0===t?void 0:t.driveId])},O=function(){var e=Object(r.__read)(C(),4),t=e[0],n=e[1],o=e[2],i=e[3],c=function(){var e=Object(s.a)().data,t=Object(u.a)().data,n=w(),r=Object(h.a)().data,o=Object(aa)(),c=Object(m.a)();return Object(g.useMemo)((function(){if(n&&r&&e&&t&&o&&c)return Object(b.b)({componentContext:e,isDarkMode:function(){return!!i},isRecommendedFilesActionsApiEnabled:function(){return!!n.actionActivityEnabled},identity:t,odspShareApiEndPointBase:r.shareApiEndpoint,sharedContext:o,workloads:c,useCompliantShareApi:n.compliantShareApiEnabled,shareUIPosition:"officehomereact"==(null==e?void 0:e.workload)?"absolute":"fixed",tokenProviderEnabled:n.shareTokenClaimsEnabled,odspFluentDialogEnabled:n.shareFluentDialogEnabled&&"officehomereact"==(null==e?void 0:e.workload)})}),[n,e,t,r,o,i,c])}();return Object(g.useMemo)((function(){if(t&&n&&o&&i&&c){var e=Object(v.a)(o,t,n,i,c);if(e&&e.actionManager&&e.actionExecutor)return e}}),[t,n,o,i,c])},T=function(){var e=w(),t=O(),n=null==t?void 0:t.actionManager,i=null==t?void 0:t.actionExecutor,s=function(e){var t=Object(r.__read)(Object(g.useState)(),2),n=t[0],i=t[1],s=Object(g.useCallback)((function(){e&&i(Object(r.__spreadAr),!1))}),[e]);return Object(g.useEffect)((function(){return e&&(e.on(o.b.ActionsUpdated,s),s()),function(){e&&e.removeListener(o.b.ActionsUpdated,s)}}),[e,s]),n}(n);return Object(g.useMemo)((function(){return void 0==onExecutor:i,contentActions:s}}),[i,n,e,s])}},Rzld:function(e,t,n){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},Snctiourn e(t(n))}}},SN9N:function(e,t,n){var r=n("Dh2Y"),o=n("dIZa");e.exports=function(e,t,n){(void 0!==n&&!o(e[t],n)||void 0===n&&!(t in e))&&r(e,t,n)}},SVRA:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("ywfh"),o=n("GeVZ");function i(e){if("Consumer"===e.type)return{accessTokenConsumer:"Graph",resourceUrl:"",webAbsoluteUrl:e.url};var t=Object(o.a)(e.url);return{accessTokenConsumer:"Documents"===Object(r.a)(e.url)?"OneDrive":"SharePoint",resourceUrl:t?"".concat(t.protocol,"//").concat(t.hostname):"",webAbsoluteUrl:e.siteUrl}}},SZNz:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("QjXU"),o=n("d+i3"),i=n("mXGw"),s=n.n(i),a=n("JfaO"),c=n("a5Wk"),u=function(e){var t=e.defaultOpen,narget,d=e.onActionMenuToggled,h=e.open,f=e.triggerOptions,p=e.registerTuiElement;t&&d&&d(!0);var m=Object(i.useCallback)((function(e,t){d&&d(t.open)}),[d]),g=Object(i.useMemo)((function(){if(l instanceof MouseEvent){var e=l.clientX,t=l.clientY,n=e+1,r=t+1;return{target:{getBoundingClientRect:function(){return{left:e,top:t,right:n,bottom:r,height:1,width:1}},contextElement:void 0}}}if(l instanceof HTMLElement)return{target:{getBoundingClientRect:l.getBoundingClientRect.bind(l),contextElement:l}}}),[l]);return s.a.createElement(o.a,{defaultOpen:t,onOpenChange:m,open:h,positioning:g},s.a.createElement(c.a,Object(r.__assign)({},f,{registerTuiElement:p})),s.a.createElement(a.a,{items:u,groupInfo:n}))}},SdyY:function(e,t,n){"use strict";n.d(t,"a",(function(){return K}));var r=n("Wx5u");class o{get NamespaceLogger(){return this}get PersistedProperties(){return this}get Disposable(){return this.disposable}addPersistedProperties(e){this.persistedProperties={...this.persistedProperties,...e}}getPersistedProperties(){var e,t,n;return{...null===(e=this.logger)||void 0===e||null===(t=e.PersistedProperties)||void 0===t||null===(n=t.getPersistedProperties)||void 0===n?void 0:n.call(t),...this.persistedProperties}}send(e){this.sendWithNamespace(e,this.namespace)}sendWithNamespace(e,t){var n;null===(n=this.logger)||void 0===n||n.sendWithNamespace({...this.persistedProperties,...e},t)}dispose(){this.logger=null}getNamespace(){return this.namespace}constructor(e,t,n){if(this.namespace=e,this.disposable={get Disposable(){return this},dispose:async()=>{this.logger=null}},t instanceof o){const e={...t.persistedProperties,...n};this.logger=t.logger,this.persistedProperties=e}else this.logger=t,this.persistedProperties=n}}const i=["facetCodes","statusCode","innerMostErrorCode","sprequestguid"];function s(e){const t=/[A-Z0-9._%`'+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}/gi;return Object.getOwnPropertyNames(e).map((n=>{if(-1===n.toLowerCase().indexOf("message")&&-1===n.toLowerCase().indexOf("error")&&-1===n.toLowerCase().indexOf("stack")&&!1===i.includes(n))return;let r=e[n];void 0!==r&&"string"==typeof r&&(r=r.toString().replace(t,"scrubbed_email"),e[n]=function(e){return e.replace(/(https:\/\/)(\w)+(.sharepoint.com|-my.sharepoint.com|.sharepoint-df.com)/,"(redacted)").replace(/(https:\/\/)(dev.loop.microsoft.com|df.loop.microsoft.com|loop.microsoft.com|preview.loop.microsoft.com|loop.cloud.microsoft|loop.cloud-dev.microsoft)(\/p\/)([a-zA-Z0-9%]+)/,"(redacted)")}(r.toString()))})),e}function a(e,t){const n=s(t);e.send({...n,category:r.b.Generic})}function c(e,t){var n,i;let s=e;const a=`${null===(n=(i=s).getNamespace)||void 0===n?void 0: o("ContainerSession",e),s.send({...t,errorAction:a,category:r.b.Error})}function u(e,t){!function(e,t){var n;const r=e=>"object"==typeof e&&null!==e;function o(t){if(!r(e))return;const n=e[t];return"string"==typeof n?n:void 0}t.errorMessage=null!==(n=o("message"))&&void 0!==n?n:String(e),t.errorName=o("name"),t.stack=o("stack"),t.errorType=o("errorType"),t.errorInstanceId=o("errorInstanceId"),i.forEach((n=>{if(r(e)){const r=e[n];"boolean"!=typeof r&&"number"!=typeof r&&"string"!=typeof r&&void 0!==r||(t[n]=r),"object"==typeof r&&(t[n]=JSON.stringify(r))}}))}(t,e),e.message=e.message?`${e.message}\n${e.errorMessage}`:e.errorMessage,void 0===e.stack&&(e.stack=function(){let e=(new Error).stack;if(!e)try{throw new Error}catch(t){e=t.stack}return e}())}new Set,new Set,new Map([["Automation",1],["SyntheticTraffic",1],["Local",1],["Staging",1],["Dogfood",.1],["Preview",.1],["Microsoft",.01],["Production",.001],["GCC",0],["GCC-High",0],["DoD",0]]);var l=n("OfNt"),d=n("Iz5H");const h="@ms/office-fluid-container",f="@ms/onenote-meetings",p="@ms/whiteboard-container",m="@fluidx/loop-page-container";var g=n("Xd2i"),v=n("k8nI"),b=n("rwSX"),y=n("graM"),w=n("aFvx"),C=n("obr3");const O="codeLoaderStorage";function,"de loader cache DB since it is blocked by an older client that has the DB open")}})}function S(e){return`${e.packageName}_${e.containerEnvironment}`}var k=n("A3AF");const E=new Set;class _{static start(e,t,n){const r=new _(e,t,n);return E.add(r),r}markSubActivityStart(e){this.subActivities[e]={startTime:performance.now(),startTimeSinceEpoch:Date.now()},this.addUserTiming&&performance.mark(this.getSubActivityName(e,"start"))}markSubActivityEnd(e,t){const n=this.subActivities[e];if(!n)return;if(this.addUserTiming){const t=this.getSubActivityName(e,"end");performance.mark(t),performance.measure(e,this.getSubActivityName(e,"start"),t)}const r={[`durationMs_${e}`]:Math.round(performance.now()-n.startTime)};this.logSubactivityStartTimes&&(r[`startTime_${e}`]=n.startTimeSinceEpoch),this.additionalPropsToLog={...r,...this.additionalPropsToLog,...t}}setResult(e,t,n,r){this.logActivityResult(e,t,n,null==r?void 0:r.skipLogging,void 0,null==r?void 0:r.sampleEvent)}cancel(e,t,n){this.logActivityResult(e,t,n,!1,!0)}addAdditionalProps(e){this.additionalPropsToLog={...this.additionalPropsToLog,...e}}dispose(){this.cancel();const e=e=>performance.clearMarks(e),t=e=>performance.clearMeasures(e);if(this.addUserTiming){e(this.activityStartName),e(this.activityEndName),this.cachedMeasureName&&t(this.cachedMeasureName);for(const n in this.subActivities)e(this.getSubActivityName(n,"start")),e(this.getSubActivityName(n,"end")),t(n)}}logActivityResult(e,t,n,o,i,a){if(this.hasAlreadyResolved)return;this.hasAlreadyResolved=!0,this.addUserTiming&&performance.mark(this.activityEndName);const l=performance.now(),d=Math.round(l-this.startTime);if(this.isAPerformanceMetric&&((function(){return window._pageTimings||(window._pageTimings={})}())[this.activityName]=d),this.logger&&!o){const o={eventName:this.activityName,startTime:this.startTimeSinceEpoch,durationMs:d,succeeded:e,sampleEvent:a,resultType:i?r.a.Cancelled:e?r.a.Success:r.a.Failure,...this.additionalPropsToLog,...t};!function(e,t,n){n&&u(t,n),t.resultType||void 0===t.succeeded||(t.resultType=t.succeeded?r.a.Success:r.a.Failure);const o=s(t);e.send({...o,category:r.b.Activity}),t.resultType===r.a.Failure&&t.isUserImpacting&&c(e,o)}(this.logger,o,n)}this.logger=void 0,E.delete(this),this.addUserTiming&&performance.measure(this.generateMeasureName(e),this.activityStartName,this.activityEndName)}generateMeasureName(e){return this.cachedMeasureName=`${this.activityName}${!1===e?"-FAILED":""}-${this.identifier}`,this.cachedMeasureName}getSubActivityName(e,t){return`${e}-${t}-${this.identifier}`}constructor(e,t,n){var r;this.activityName=e,this.logger=t,this.isAPerformanceMetric=!1,this.additionalPropsToLog=null==n?void 0:n.additionalPropsToLog,this.addUserTiming=null==n?void 0:n.addUserTiming,this.isAPerformanceMetric=(null==n?void 0:n.isAPerformanceMetric)||!1,this.logSubactivityStartTimes=null===(r=null==n?void 0:n.logSubactivityStartTimes)||void 0===r||r,this.subActivities={},this.identifier=Object(k.a)(),this.activityStartName=`${this.activityName}-start-${this.identifier}`,this.activityEndName=`${this.activityName}-end-${this.identifier}`,this.addUserTiming&&performance.mark(this.activityStartName),this.startTime=performance.now(),this.startTimeSinceEpoch=Date.now()}}var j=n("dP86");function I(e,t){return void 0===e.find((e=>!function(e,t){const n=new URL(e);return t.includes(n.origin)}(e,t)))}async function N(e,t){try{const n=await T();await n.delete(O,S({packageName:e,containerEnvironment:t})),n.close()}catch(e){}}function A(e,t,n,r,o){const{getLatestContainerCodeDetails:i,upgradeNeeded:s,preCacheContainerCode:a}=n,c=n=>function(e,t,n,r,o,i){const s=r(n),a=s.then((async r=>{const s=await T(),a=S({packageName:t,containerEnvironment:n}),c=await s.get(O,a);c&&c.codeDetailsPackage.version===r.fluidCodeDetailsOverride.package.version||o(e,r,i),await s.put(O,{codeDetailsPackage:r.fluidCodeDetailsOverride.package,lastUpdatedTime:Date.now()},a),s.close()})).catch((()=>{}));return{codePackagePromise:s.then((e=>({...e.fluidCodeDetailsOverride.package,maxUnsupportedVersion:e.maxUnsupportedContainerScriptVersion}))),cacheUpdatePromise:a}}(e,t,n,i,a,o);return{getCodeDetailsPackage:(e,n)=>async function(e,t,n,r,o){const i=Object(j.b)(),s=_.start("GetCodeDetailsPackage",o,{addUserTiming:!0}),a=async function(e,t,n){try{const r=await T(),o=await r.get(O,S({packageName:e,containerEnvironment:t}));if(r.close(),o){const r=Date.now()-o.lastUpdatedTime;return r>6048e5?{metadata:{cacheStatus:"expired",cacheAge:r},codeDetails:void 0}:I(o.codeDetailsPackage.fluid.browser.umd.files,n)?{metadata:{cacheStatus:"hit",cacheAge:r},codeDetails:o.codeDetailsPackage}:(N(e,t).catch((()=>{})),{metadata:{cacheStatus:"unsafe"},codeDetails:void 0})}}catch(e){}return{metadata:{cacheStatus:"miss"},codeDetails:void 0}}(e,t,n).then((e=>({method:"cache",cacheDetails:e}))),u=(e=>c(e).codePackagePromise)(t).then((e=>({method:"network",codeDetails:e}))),l=await Promise.race([a,u]);let d={documentEverHidden:Object(j.a)(i,!0)>-1};if("cache"===l.method){const{cacheDetails:e}=l;if(d={...d,...e.metadata},e.codeDetails)return s.setResult(!0,{method:"cache",...d}),e.codeDetails}return u.then((e=>(s.setResult(!0,{method:"network",...d}),e.codeDetails)))}(t,e,n,0,r),upgradeNeeded:async(e,n)=>{if(!s)return!1;const r=await s(e,n);return r&&(await N(t,e),c(e)),r},preCacheLatestContainerCode:async e=>await c(e).cacheUpdatePromise}}function P(e,t){const n=e.document,r=n.createDocumentFragment();t.forEach((e=>{const t=n.createElement("link");t.rel="prefetch",t.href=e,e.endsWith(".js")?(t.as="script",t.crossOrigin="anonymous",r.appendChild(t)):e.endsWith(".css")&&(t.as="style",r.appendChild(t))})),n.head.appendChild(r)}functiifest,o=[...r.assets];if(r.localizedAssets){const e=Object(b.c)(n),t=r.localizedAssets[e];t&&o.push(...t)}P(e,o.map((e=>`${t.preload.jsBaseUrl}/${e}`)))}async function D(e,t){const n=await(t?Object(y.b)(e,{method:"GET"},"GetCodeLoadDetailsFromNetwork",t,!1,{maxRetries:3,filter:Object(y.c)([709,710]),backoffFn:Object(w.b)(500)}):Object(y.a)(e,{method:"GET"},{maxRetries:3,filter:Object(y.c)([709,710]),backoffFn:Object(w.b)(5;throw new Error(`getCodeLoadDetailsFromNetwork: Failed to fetch: ${e} ; StatusCode: ${n.result.status}`)}function L(e){return!isNaN(e)&&isFinite(e)}const M=(e,t,n,r,o)=>A(e,t,{getLatestContainerCodeDetails:n,preCacheContainerCode:x,upgradeNeeded:async(e,t)=>{try{const r=await n(e);return function(e,t,n){const r=parseFloat(e);if(!L(r))return!1;const o=parseFloat(t);if(!L(o))return!1;const i=parseFloat(n);return!!(L(i)&&r>i)||r<=o}(t,r.maxUnsupportedContainerScriptVersion,r.fluidCodeDetailsOverride.package.version)}catch(e){return!1}}},r,o),R=e=>{var t,n,r,o,i,s;return(e=>"object"==typeof e&&"string"==typeof(null==e?void 0:e.name)&&"object"==typeof(null==e?void 0:e.fluid))(e)&&"string"==typeof(null==e||null===(t=e.fluid)||void 0===t||null===(n=t.browser)||void 0===n||null===(r=n.umd)||void 0===r?void 0:r.library)&&Array.isArray(null==e||null===(o=e.fluid)||void 0===o||null===(i=o.browser)||void 0===i||null===(s=i.umd)||void 0===s?void 0:s.files)};var F=n("MpdP");const B=e=>{switch(e){case f:case h:case"@msstream/experiences-fluid-embed":case"@office-start/space-container":case p:case m:return e;default:return"(redacted)"}};fe,t){return new Promise(((n,r)=>{const o=e.document,i=o.createElement("link");return i.rel="stylesheet",i.type="text/css",i.href=t,i.onload=()=>{n()},i.onerror=()=>r(new Error(`Failed to download the style sheet at url: ${t}, isUserDefinithead.appendChild(i),i}))}const W=new Map,q=e=>"string"==typeof e.package?e.package:e.package.name,H="0.0.1",z=e=>!Number.isNaN(e)&&Number.isFinite(e),G=e=>"string"!=typeof e.package&&(e=>!!R(e)&&(e.version===H||z(Number(e.version))))(e.package)?{name:e.package.name,version:e.package.version===H?H:Number(e.package.version)}:void 0;class V{get IRuntimeFactory(){return this}instantiateRuntime(e,t){return this.wrappedFactory.configure(this.config),this.wrappedFactory.instantiateRuntime(e,t)}constructor(e,t){this.wrappedFactory=e,this.config=t}}class ${get IFluidCodeDetailsComparer(){return this}tryFormActualCodeDetailsMapKey(e){const t=G(e);if(void 0!==t)return`${t.version}|${t.name}`}getActualCodeDetails(e){const t=this.tryFormActualCodeDetailsMapKey(e);return void 0===t?void 0:this.actualCodeDetailsMap.get(t)}async load(e,t){var n;const o=q(e),i=e.config,{windowContext:u,getBundledPackageFactoryOverride:l,disableCdnCodeLoadingFallback:d}=this.config;let h=W.get(u);const f=null===(n=h)||void 0===n?void 0:n.get(o);if(void 0!==f){const t=await f,n=t.fluidExport.ConfigurableRuntimeFactory;return void 0!==n?{module:{fluidExport:new V(n,i)},details:e}:{module:t,details:e}}let p=null==l?void 0:l(o);if(p)p.then((e=>{var n,r;const i=null===(n=e.fluidExport.CodeVersionDetailsProvider)||void 0===n||null===(r=n.codeVersionDetails)||void 0===r?void 0:r.version;Q(t,{packageName:o,deliveryType:"NPM",codeVersion:i})})).catch((()=>{t&&function(e,t,n){const o=s(t);e.send({...o,category:r.b.Error}),t.isUserImpacting&&c(e,o)}(t,{eventName:"NpmCodeLoaderOverrideFailed",packageName:B(o)})}));else{if(d)throw new Error(`CDN code loading fallback set to false but no factory provided by host for container named ${B(o)}`);t&&a(toaderFallbackToCDN",containerType:B(o)}),p=this.loadInternal(e,t)}h||(h=new Map,W.set(u,h),u!==window&&u.addEventListener("unload",(()=>{W.delete(u)}))),h.set(o,p),p.catch((()=>h.delete(o)));const m=await p,g=m.fluidExport.ConfigurableRuntimeFactory;return void 0!==g?{module:{fluidExport:new V(g,i)},details:e}:{module:m,details:e}}async loadInternal(e,t){const{windowContext:n,trustedTypesPolicy:r,allowedCodeOrigins:o,getFluidCodeVersionDetails:i,scriptLoadPriority:s}=this.config,a=await this.getEffectiveFluidCodeDetailsPackage(e);if(Q(t,{packageName:q(e),deliveryType:"CDN",codeVersion:a.version}),void 0===a)throw new Error(`Failed to get Fluid Package. Trying to load ContainerType: ${B(e.package.name)}`);const c=a.fluid.browser.umd;if(!this.shouldLoad(c.files))throw new Error("Unsupported container files, check that CDN is on allow list");const u=this.tryFormActualCodeDetailsMapKey(e);if(void 0!==u&&"string"!=typeof e.package){const t={...e,package:{...e.package,...a}};this.actualCodeDetailsMap.set(u,t)}const l=r&&{trustedTypesPolicy:await r,allowedOrigins:o};await Promise.all(c.files.map((e=>{const t=e.toLowerCase();if(t.endsWith(".js"))return Object(F.a)(n,e,l,s);if(t.endsWith(".css"))return((e,t)=>{let n=3;return function r(){return U(e,t).catch((()=>(n-=1,0===n?U(e,t):r())))}()})(n,e);throw new Error(`Codeloader does not know how to load: ${e}`)})));const d=n[c.library];if(void 0===d)throw new Error(`Entry point of loaded package not a Fluid module. Trying to load ContainerType: ${B(e.package.name)}`);const{CodeVersionDetailsProvider:h}=d.fluidExport;if(h){const e=null==i?void 0:i(a);e&&h.setCodeVersionDetails(e)}return d}async preCache(e){const{getFluidCodeDetailsPackageOverride:t,windowContext:n}=this.config;if(t){const r=await t(e);if(r){const e=r.fluid.browser.umd;if(!this.shouldLoad(e.files))throw new Error("Unsupported container files, check that CDN is on allow list");P(n,e.files)}}}async getEffectiveFluidCodeDetailsPackage(e){var t,n;const r="string"==typeof e.package?e.package:e.package.name,o=await(null===(t=(n=this.config).getFluidCodeDetailsPackageOverride)||void 0===t?void 0:t.call(n,r))||e.package;if("string"==typeof o)throw new Error("Codeloader does not know how to l===e.version)throw new Error("Codeloader does not know how to load from this source")}(o),o}shouldLoad(e){return I(e,this.config.allowedCodeOrigins)}async satisfies(e,t){const n=this.getActualCodeDetails(e);if(void 0===n)return!0;if("string"==typeof t.package||"string"==typeof n.package)return!0;const r=(e=>{const t=Number(e.maxUnsupportedVersion);return z(t)?t:void 0})(t.package);if(void 0!==r){var o;const e=null===(o=G(n))||void 0===o?void 0:o.version;if(void 0!==e)return e===H||e>r}return!0}async compare(e,t){const n=G(e);if(e?n.version===r.version?0:n.version===H?-1:r.version===H?1:n.version-r.version:void 0}constructor(e){this.config=e,this.actualCodeDetailsMap=new Map}}function Q(e,t){let{packageName:n,deliveryType:r,codeVersion:o}=t;if(!e)return;const i={eventName:"FluidCodeDetails",subCategory:"FluidCodeDetails",containerType:B(n),deliveryType:r};o&&(i.codeVersion=o),a(e,i)}function J(e){var t;const n=null===(t=Object(l.a)())||void 0===t?void 0:t.AllowListOverride;return n?(e&&a(e,{eventName:"CodeLoaderAllowListOverwritten",subCategory:"LocalStorageOverride"}),JSON.parse(n)):[]}class X{get IFluidCodeDetailsComparer(){return this.simpleCodeLoader}getActualCodeDetails(e){return this.simpleCodeLoader.getActualCodeDetails(e)}async preCache(e){var t;if(null!==(t=this.config.locallyBundledPackageFactories)&&void 0!==t&&t.has(e))return;const n=this.containerCodeDetailsProviderMap.gtestContainerCode(this.config.containerEnvironment):this.simpleCodeLoader.preCache(e)}async load(e){return this.simpleCodeLoader.load(e,this.logger)}constructor(e){var t,n;this.config=e;const r=null!==(t=e.additionalAllowedCodeOrigins)&&void 0!==t?t:[],{windowContext:i,logger:s,localeHint:a,sdpEnabled:c}=this.config,u=null!=s&&s.NamespaceLogger?new o("OfficeWebHost",s.NamespaceLogger):s;this.logger=u,this.settingsProvider=e.settingsProvider;const l=((e,t,n,r)=>M(e,h,(e=>async function(e,t,n){return D(n?`${Object(g.getSdpCdnBaseUrl)(e)}/container/versionless/_1cdn_bucketedcontent/officeContainerCodeLoadDetails.json`:`${Object(v.a)(e)}/container/versionless/officeContainerCodeLoadDetails.json`,t)}(e,t,r)),t,n))(i,u,a,c),b=((e,t,n)=>M(e,m,(e=>async function(e,t){return D(`${Object(v.b)(e)}/loop-page-container/versionless/loopPageContainerCodeLoadDetails.json`,t)}(e,t)),t,n))(i,u,a),y=((e,t,n)=>({getCodeDetailsPackage:(e,t)=>{const n=(e=>{const t="https://whiteboard.office.com";switch(e){case"Development":return"https://dev.whiteboard.microsoft.com";case"Staging":return"https://app.int.whiteboard.microsoft.com";case"Dogfood":case"Gcc":return t;case"GccHigh":return"https://whiteboard.office365.us";case"DoD":return"https://whiteboard.apps.mil";case"USNat":return"https://whiteboard.eaglex.ic.gov";case"USSec":return"https://whiteboard.microsoft.scloud";default:return t}})(e);return Promise.resolve({name:p,version:"0.0.1",fluid:{browser:{umd:{files:[`${n}/root/index.fluid.js`],library:"microsoftWhiteboard"}}}})}}))();this.containerCodeDetailsProviderMap=new Map([[h,l],[f,l],[m,b],[p,y]]),null===(n=e.additionalCodeDetailsProviders)||void 0===n||n.forEach((e=>{let[t,n]=e;return this.containerCodeDetailsProviderMap.set(t,n)}));const w=[...Object(d.a)(this.config.containerEnvironment,this.settingsProvider,u),...J(u),...r];this.simpleCodeLoader=new $({windowContext:e.windowContext,trustedTypesPolicy:e.trustedTypesPolicy,getBundledPackageFactoryOverride:t=>{var n;const r=null===(n=e.locallyBundledPackageFactories)||void 0===n?void 0:n.get(t);return r?Promise.resolve(r):void 0},disableCdnCodeLoadingFallback:e.disableCdnCodeLoadingFallback,getFluidCodeDetailsPackageOverride:async t=>{const n=this.containerCodeDetailsProviderMap.get(t);if(n)return n.getCodeDetailsPackage(e.containerEnvironment,w)},allowedCodeOrigins:w,getFluidCodeVersionDetails:t=>{var n;const{containerEnvironment:r}=e,o=t.version,i=null===(ainerCodeDetailsProviderMap.get(t.name))||void 0===n?void 0:n.upgradeNeeded;return{version:o,containerEnvironment:r||"Local",needUpgrade:i?()=>i(r,o):async()=>!1}},scriptLoadPriority:e.scriptLoadPriority})}}class K{get FluidCodeLoaderFactory(){return this}get Disposable(){return this}dispose(){}constructor(e){this.bohemiaConfig=e,this.instantiateFluidCodeLoader=async e=>{const t=e.dependencySynthesizer.synthesize({LoopTrustedTypesPolicy:"LoopTrustedTypesPolicy",NamespaceLogger:"NamespaceLogger",SettingsProvider:"SettingsProvider"},void 0),[n,r,o]=await Promise.all([t.LoopTrustedTypesPolicy,t.SettingsProvider,t.NamespaceLogger]);return new X({...this.bohemiaConfig,windowCon.Trending="Trending12",e.Unfavorite="Unfavorite",e.Upload="Upload",e.Video="Video",e.ViewAll="ViewAll",e.VisioLogo="VisioLogo",e.WordLogo="WordLogo"}(r||(r={}))},SnJU:function(e,t,n){"use strict";n.d(t,"a",(function(){return N}));var r=n("QjXU"),o=n("6ib3"),i=n("l+H3"),s=n("K7tG"),a=n("mXGw"),c=n("Ea7i"),u=n("DCX/"),l=n("MJsD"),d=n("5eS3"),h=n("frjS"),f=n("Ohvh"),p=new Set([o.a.Clipchamp,o.a.Designer,o.a.Excel,o.a.Forms,o.a.FormsQuiz,o.a.OneNote,o.a.OneNotePage,o.a.PowerBI,o.a.PowerPoint,o.a.List,o.a.NewsArticle,o.a.SharePoint,o.a.Sway,o.a.Visio,o.a.Whiteboard,o.a.Word,o.a.Yammer,o.a.Stream,o.a.ScreenRecording]);function m(e){var t=o.a[e]+"_ButtonBackground";return p.has(e)?t:void 0}var g=n("a3FV"),v=n("lUkk"),b=n("Dn7E"),y=n("rTyw"),w=n("1aUa"),C=n("hu41"),O=n("NZpx"),T=n("NrNW"),S=n("ynVX"),k=n("CU8J"),E=n("CaQ9"),_=n("h8qh"),j=n("BhFD"),I=n("ijiB");function N(e,t,n,p){var N=Object(s.a)(),A=Object(C.a)(),P=function(){var e,t,n,r,i,s,c,u,l=Object(_.a)().data,d=Object(O.a)().data,h=Object(E.a)().data,f=Object(k.a)().data,p=Object(T.a)().data,m=Object(S.a)().data,g=null==f?void 0:f.result,v=(null===(e=null==g?void 0:g.createFluidLoopGates)||void 0===e?void 0:e.createFluidLoopEnabled)||!1,b=(null===(t=null==g?void 0:g.firstDraftGates)||void 0===t?void 0:t.firstDraftEnabled)||!1,y=(null===(n=null==g?void 0:g.listsCreateGates)||void 0===n?void 0:n.listsCreateEnabled)||!1,w=(null===(r=null==g?void 0:g.createDesignerGates)||void 0===r?void 0:r.createDesignerEnabled)||!1,C=(null===(i=null==g?void 0:g.powerBiCreateGates)||void 0===i?void 0:i.powerBiCreateEnabled)||!1,I=(null===(s=null==g?void 0:g.whiteboardCreateGates)||void 0===s?void 0:s.whiteboardCreateEnabled)||!1,N=(null===(c=null==g?void 0:g.yammerCreateGates)||void 0===c?void 0:c.yammerCreateEnabled)||!1,A=(null===(u=null==g?void 0:g.createClipchampGates)||void 0===u?void 0:u.createClipchampEnabled)&&!(null==h?void 0:h.isOrgId)||!1,P=function(e,t,n){var r=Object(a.useMemo)((function(){return e&&t&&n&&n.isOrgId?{correlationId:null==e?void 0:e.correlationId,getAccessToken:null==e?void 0:e.getAccessToken,inMockMode:null==e?void 0:e.inMockMode,jwtAuthEnabled:null==e?void 0:e.jwtAuthEnabled,officeHomeApiRoot:e.officeHomeApiRoot,sharePointResourceId:null==t?void 0:t.sharePointResourceId,userId:null==n?void 0:n.puid}:void 0}),[n,e,t]),o=Object(j.a)(r).data;return null==o?void 0:o.result}(p,m,h);return Object(a.useMemo)((function(){if(l&&d&&g){var e=new Map;return y&&e.set(o.a.List,{name:l.linkCandidateResources.listsName,creationFileType:o.a[o.a.List],fileTypeNameLocalized:l.linkCandidateResources.createFileTypeNameListsList,id:"ListsAppId",showLoadingIndicator:!0,staticTabs:[{entityId:"1",name:l.linkCandidateResources.createMenuLinkListsTitle,contentUrl:(null==h?void 0:h.isMsa)?"openCreate=true&workload=Office&ocid=OfficeConsumerWebCreate":"openCreate=true&workload=Office&ocid=OfficeWebCreate",websiteUrl:"",scopes:[]}],version:"1.0.0."}),N&&e.set(o.a.Yammer,{name:l.linkCandidateResources.yammerName,creationFileType:o.a[o.a.Yammer],fileTypeNameLocalized:l.linkCandidateResources.createFileTypeNameYammerPost,id:"YammerAppId",showLoadingIndicator:!0,staticTabs:[{entityId:"1",name:l.linkCandidateResources.createMenuLinkYammerPostTitle,contentUrl:"",websiteUrl:"",scopes:[]}],version:"1.0.0."}),C&&e.set(o.a.PowerBI,{name:l.linkCandidateResources.powerBiName,creationFileType:o.a[o.a.PowerBI],fileTypeNameLocalized:l.linkCandidateResources.createFileTypeNamePowerBiReport,id:"PowerBIAppId",showLoadingIndicator:!0,staticTabs:[{entityId:"1",name:l.linkCandidateResources.createMenuLinkPowerBiTitle,contentUrl:"",websiteUrl:"groups/me/quickcreate",scopes:[]}],version:"1.0.0."}),I&&P&&e.set(o.a.Whiteboard,{name:l.linkCandidateResources.whiteboardName,creationFileType:o.a[o.a.Whiteboard],fileTypeNameLocalized:l.linkCandidateResources.createFileTypeNameWhiteboardWhiteboards,id:"WhiteboardAppId",showLoadingIndicator:!0,staticTabs:[{entityId:"1",name:l.linkCandidateResources.createMenuLinkWhiteboardTitle,contentUrl:"openCreate=true",websiteUrl:"",scopes:[]}],version:"1.0.0."}),w&&(null==h?void 0:h.isMsa)&&"en-US"===(null==p?void 0:p.preferredCulture)&&e.set(o.a.Designer,{name:l.linkCandidateResources.designerName,creationFileType:o.a[o.a.Designer],fileTypeNameLocalized:l.linkCandidateResources.createFileTypeNameDesignerDesign,id:"DesignerAppId",showLoadingIndicator:!0,staticTabs:[{entityId:"1",name:l.linkCandidateResources.createMenuLinkDesignerTitle,contentUrl:"",websiteUrl:"https://designer.microsoft.com/new?referrer=harmony",scopes:[]}],version:"1.0.0."}),b&&v&&e.set(o.a.Fluid,{name:l.linkCandidateResources.loopName,creationFileType:o.a[o.a.Fluid],fileTypeNameLocalized:l.linkCandidateResources.createFileTypeNameLoopFluid,id:"LoopAppId",showLoadingIndicator:!0,staticTabs:[{entityId:"1",name:l.linkCandidateResources.createMenuLinkLoopFluidTitle,contentUrl:"",websiteUrl:"",scopes:[]}],version:"1.0.0."}),A&&e.set(o.a.Clipchamp,{name:l.linkCandidateResources.clipchampName,creationFileType:o.a[o.a.Clipchamp],fileTypeNameLocalized:l.linkCandidateResources.createFileTypeNameClipchampVideo,id:"ClipchampAppId",showLoadingIndicator:!0,staticTabs:[{entityId:"1",name:l.linkCandidateResources.createMenuLinkClipchampTitle,contentUrl:"",websiteUrl:"",scopes:[]}],version:"1.0.0"}),e}}),[d,A,null==p?void 0:p.preferredCulture,w,g,b,null==h?void 0:h.isMsa,y,l,v,C,I,P,N])}(),x=function(e){return Object(a.useCallback)((function(t,n,r,i){if(n&&n.id&&n.workload&&n.workload.referral){var s=n.workload.referral;Object(v.a)({id:n.id,area:e,result:s&&Object(w.a)(t)?"Refer":"Navigate",target:s&&Object(w.a)(t)?Object(y.a)(s):"Other",eventName:g.a.CreateLinkClick})}n&&n.id&&n.creationFileType&&Object(b.a)({featureName:"Create",eventName:g.a.CreateLinkClickResult,area:e,params:{ElementId:n.id,Action:t,DocumentType:o.a[n.creationFileType].toLowerCase(),ProcessTime:i||-1}})}),[e])}(e),D=Object(r.__read)(Object(i.a)(),2),L=D[0],M=D[1],R=Object(I.a)(),F=Object(a.useCallback)((function(){if(t){var e=[];return null==t||t.forEach((function(t){var n;if(n=null==N?void 0:N.find((function(e){return e.FileType===t||t===o.a.FormsQuiz&&e.FileType===o.a.Forms||t===o.a.ScreenRecording&&e.FileType===o.a.Stream}))){var r=t===o.a.FormsQuiz?o.a.FormsQuiz:t===o.a.ScreenRecording?o.a.ScreenRecording:n.FileType,i=r&&A.get(r);if(r&&i){var s=function(e,t,n){var r=e.Id;return n===o.a.FormsQuiz&&(r=e.Id+"Quiz"),n===o.a.ScreenRecording&&(r=e.Id+"ScreenRecording"),{ariaLabel:t.title,title:t.title,fileTypeNameLocalized:t.fileTypeName,appName:t.appName,creationFileType:n,icon:(n===o.a.Clipchamp?"ms-Icon--ClipchampLogo ms-svg-Icon":void 0)||"",workload:{id:r,app:e.Text,text:e.Text,title:e.Title,url:e.Url,color:e.Color,referral:e.Referral},url:e.Url,svgButtonBackground:m(n),id:r}}(n,i,r);s&&e.push(s)}}})),e}}),[A,t,N]),B=Object(a.useCallback)((function(){if(p){var e=[];return null==p||p.forEach((function(t){var n=null==P?void 0:P.get(t);if(n){var r=null==N?void 0:N.find((function(e){var t;return(null==e?void 0:e.AppId)===n.name||(null===(t=e.AppId)||void 0===t?void 0:t.includes(n.name.replace(/\s/g,"")))})),i=function(e,t){var n=Object(f.a)(e.creationFileType);if(n){if(e.creationFileType===o.a[o.a.Designer])return function(e){var t=Object(f.a)(e.creationFileType);if(t){var n="https://designer.microsoft.com/new?referrer=harmony",r=e.name,o=e.staticTabs&&e.staticTabs[0].name||e.name;return{id:r,ariaLabel:o,title:o,fileTypeNameLocalized:e.fileTypeNameLocalized||"",creationFileType:t,appName:e.name,icon:"Designer_AppIcon",workload:{id:r,app:e.name,color:"#593EF2",text:e.name,title:o,url:n,referral:r},url:n,svgButtonBackground:m(t),createFromManifest:!0}}}(e);if(e.creationFileType===o.a[o.a.Clipchamp])return function(e){var t=Object(f.a)(e.creationFileType);if(t){var n="https://app.clipchamp.com/editor/new?context=microsoft&utm_source=m365createblank",r=e.name,o=e.staticTabs&&e.staticTabs[0].name||e.name;return{id:r,ariaLabel:o,title:o,fileTypeNameLocalized:e.fileTypeNameLocalized||"",creationFileType:t,appName:e.name,icon:"ms-Icon--ClipchampLogo ms-svg-Icon",workload:{id:r,app:e.name,color:"#0C9D8C",text:e.name,title:o,url:n,referral:r},url:n,svgButtonBackground:m(t),createFromManifest:!0}}}(e);if(t){var r=function(e,t){var n,r=null===(n=t.Url)||void 0===n?void 0:n.split("?"),o="".concat(r[0]).concat(r[0].endsWith("/")?"":"/").concat(e.staticTabs&&e.staticTabs[0]&&e.staticTabs[0].websiteUrl?e.staticTabs[0].websiteUrl:""),i="".concat(r[1]?r[1]+"&":"").concat(e.staticTabs&&e.staticTabs[0]&&e.staticTabs[0].contentUrl?e.staticTabs[0].contentUrl:"");return"".concat(o,"?").concat(i)}(e,t),i=e.name.replace(/\s/g,""),s=e.staticTabs&&e.staticTabs[0].name||e.name;return{id:i,ariaLabel:s,title:s,fileTypeNameLocalized:e.fileTypeNameLocalized||"",creationFileType:n,appName:t.Text,icon:t.FileType===o.a.List?void 0:t.IconUnicodeCodepointCssClass,workload:{id:i,app:e.name,color:t.Color,text:e.name,title:s,url:r,referral:i},url:r,svgButtonBackground:m(n),createFromManifest:!0}}}}(n,r);i&&e.push(i)}})),e}}),[P,p,N]);return Object(a.useMemo)((function(){var t=F();null==t||t.forEach((function(t){var r=A&&t&&A.get(t.creationFileType);r&&(t.onClick=function(){M&&M(null==t?void 0:t.appName)?L({workloadId:t.id,area:e,subArea:"CreateLinks"}):Object(c.a)({app:t.creationFileType,candidate:r,getOrUpdatePendingCreates:R,createLink:t,instrumentClick:x,errorCallback:n,area:e,lastFocusedHtmlElement:document.activeElement})})}));var o=B();return null==o||o.forEach((function(t){P&&t&&P.get(t.creationFileType)&&(t.onClick=function(){M&&M(null==t?void 0:t.appName)?L({workloadId:t.id,area:"CreateOnStart"===e?"Templates":"CreateGallery",subArea:"CreateLinks"}):function(e,t,n){Object(r.__awaiter)(this,void 0,void 0,(function(){var o,i,s,a,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(u.a)()];case 1:return o=r.sent(),[4,Object(l.a)()];case 2:return i=r.sent(),s={type:"CreatePending"},o&&e&&e.workload&&e.workload.url?(a=Object(d.a)(e.workload.url,"cid=".concat(i.correlationId)),[4,Object(h.a)(a)]):[3,4];case 3:s=r.sent(),r.label=4;case 4:return t&&t(s.type,e),c="Error"===(s="CreatePending"!==s.type?s:{type:"Error"}).type||"OpenNewDocFailed"===s.type||"OpenBlockedByPopupBlocker"===s.type,n&&c&&n({resultType:s.type,fileType:e.creationFileType}),[2,s]}}))}))}(t,x,n)})})),Objl!=o?o:[]),!1)}),[F,B,A,M,L,e,R,x,n,P])}},SyCk:function(e,t,n){var r=n("RqPZ"),o=n("ckUF");e.exports=function(e){return null!=e&&o(e.length)&&!r(e)}},T68q:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("lYt+"),o=function(e){return e.actionCreators},i=function(){return Object(r.a)(o)}},T8eN:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r="Shell",o=r.length,i=n("kwav"),s=function(e){var t=e.coreAndSegmentApps.concat(e.nonCoreAndSegmentApps);!function(e){null==e||e.forEach((function(e){e.id=e.Id,e.Referral=e.e){return e&&e.length&&0===e.lastIndexOf(r,o)?e.substring(o):""}(e.Id),e.FileType=Object(i.a)(e.Id)}))}(t);var n=t.filteIsThirdParty||(e.AppId=e.Id.slice(5),e.CollectorId="FirstParty")})),n}},T9Ud:function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},TA9V:function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return v})),n.d(t,"c",(function(){return b})),n.d(t,"e",(function(){return y})),n.d(t,"d",(function(){return C})),n.d(t,"f",(function(){return O}));var r,o=n("QjXU");!function(e){e.ConvertToPdf="convertToPdf",e.ViewPdfExternal="viewPdfExternal",e.CopyLink="copyLink",e.CreateTodo="createTodo",e.ViewTodoExternal="viewTodoExternal",e.Download="download",e.LocalCopyLink="localCopyLink",e.OpenInNative="openInNative",e.OpenInBrowser="openInBrowser",e.OpenFileLocation="openFileLocation",e.Schedule="schedule",e.Share="share",e.ShareToTeams="shareToTeams"}(r||(r={}));var i=n("Tqea"),s=n("lOFt"),a=n("cenr"),c=(n("yOLj"),n("1rn/")),u=n("V9hE"),l=n("a3FV"),d=n("HQCr"),h=n("lUkk"),f=n("Dn7E"),p=(n("tyUq"),n("Cin9")),m=n("GMuP");function g(e,t,n,r,o){var s,a;void 0===o&&(o="ContentActionsMenuItem");var c={};return"content"==e&&(c.DocumentId=t.id,c.DocumentType=Object(i.a)(t.fileType),c.ItemCategory=r,c.Pinned=(null===(s=t.isPinned)||void 0===s?void 0:s.toString())||"",c.ActivityCollaboration=(null===(a=t.isCollab)||void 0===a?void 0:a.toString())||""),{sourceUXComponent:n,params:c,actionMenuSource:o}}var v=function(e){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){return e&&e.actionId?(e.params.AppId=e.appId,Object(s.a)(l.a.ContentActionsMenuItemClick,r[e.actionId]||e.actionId,e.sourceUXComponent,e.referral,e.referralPlatform,e.params),e.referral?Object(d.a)(r[e.actionId]||e.actionId,e.sourceUXComponent,e.referral,e.actionMenuSource,void 0,l.a.ContentActionsMenuItemClick):Object(h.a)({id:r[e.actionId]||e.actionId,area:e.sourceUXComponent,subArea:e.actionMenuSource,result:"Navigate",target:"ContentActions",eventName:l.a.ContentActionsMenuItemClick}),[2]):[2]}))}))},b=function(e,t){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var n,i,s,c,u,d,h,p;return Object(o.__generator)(this,(function(m){return e&&e.actionId&&t?(e.params.ElementId=n=r[e.actionId]||e.actionId,e.params.AppId=e.appId,e.params.Area=e.sourceUXComponent,(null==t?void 0:t.additionalParams)&&(e.params=Object(o.__assign)(Object(o.__assign)({},e.params),t.additionalParams)),t.success?e.params.State="Success":(i=t.error?"".concat(null===(u=t.error)||void 0===u?void 0:u.errorCode," : ").concat(null===(d=t.error)||void 0===d?void 0:d.errorMessage):"",e.params.State="Error",e.params.Error=i,(s="".concat((null===(h=null==t?void 0:t.error)||void 0===h?void 0:h.additionalMessage)?"".concat(null===(p=null==t?void 0:t.error)||void 0===p?void 0:p.additionalMessage,"; "):"").concat((null==t?void 0:t.additionalParams)&&(null==t?void 0:t.additionalParams.DebugInfo)?t.additionalParams.DebugInfo:""))&&""!==s&&w(n,s,e)),Object(a.a)(t.success?l.a.ContentActionSuccess:l.a.ContentActionError,e.params),Object(f.a)({featureName:"ContentActions",eventName:l.a.ContentActionCompleted,params:Object(o.__assign)(Object(o.__assign)({},t.additionalParams),(c={State:t.success?"Success":"Error",Message:i||"",Action:n},c["".concat("DocumentId")]=e.params.DocumentId||"",c["".concat("DocumentType")]=e.params.DocumentType||"",c)),area:"ContentActions",subArea:e.actionMenuSource}),[2]):[2]}))}))},y=function(e,t,n){if(e&&e.actionId&&t&&n){var o="Content_Action_".concat(r[e.actionId]||e.actionId,"_complete");Object(c.a)(o,n-t),Object(p.a)({eventName:o,latency:n-t,area:e.sourceUXComponent,subArea:e.actionMenuSource})}},w=function(e,t,n){var o;if(e&&t){var i="Content_Action_Error_".concat(r[e]||e),s=((o={}).DebugInfo=t,o);Object(u.a)(i,s),Object(m.a)({eventName:i,params:s,area:null==n?void 0:n.sourceUXComponent,subArea:null==n?void 0:n.actionMenuSource})}},C=function(e,t,n){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var r,i;return Object(o.__generator)(this,(function(o){return(i={}).ElementId=e,r=i,t?r.Error=null!=n?n:"Unable to initialize":n&&(r.DebugInfo=n),Object(a.a)(l.a.ContentActionInitialization,r),Object(f.a)({featureName:"ContentActions",eventName:l.a.ContentActionInitialization,params:{State:t?"Error":"Success",Message:null!=n?n:t?"Unable to initialize":"",Action:e},area:"ContentActions"}),[2]}))}))},O=function(e,t){var n,o=t.reduce((function(e,t){return"".concat(e," ").concat(r[t.metadata.id]||t.metadata.id,";")}),""),i=((n={}).IsCalendarEnabled=e.calendarEnabled.toString(),n.IsExchangeEnabled=e.exchangeEnabled.toString(),n.IsOneDriveEnabled=e.oneDriveEnabled.toString(),n.ActionsConfig=o,n);Object(f.a)({=n("Or++)n.push(t(e[r],r));return n}var s=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},TImb:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("/Oio");function o(e,t,n){return"OFFICECOM-".concat(function(e){switch(e){case r.a.Antp:return"NTP";case r.a.Hwa:return"HWA"}return"WEB"}(e),".").concat(function(e){if(e)switch(e.route){case"Start":return"START";case"Templates":return"TEMPLATES";case"Content":return"CONTENT";case"Search":return"SEARCH";default:return"MAIN"}return"MAIN"}(t),".").concat(n)}},TVWn:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));const r=[{headerName:"sprequestguid",logName:"spRequestGuid"},{headerName:"request-id",logName:"requestId"},{headerName:"client-request-id",logName:"clientRequestId"},{headerName:"x-msedge-ref",logName:Browser",e.openFileLocation="openFileLocation",e.share="share",e.tag="tag",e.unfavorite="unfavorite",e.unhide="unhide",e.moveTo="moveTo"}(r||(r={}))},Tqea:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("6ib3");function o(e){switch(e){case r.a.Word:return"Word";case r.a.Excel:return"Excel";case r.a.PowerPoint:return"PowerPoint";case r.a.OneNote:case r.a.OneNoteClassNoteBook:case r.a.OneNotePage:return"OneNote";case r.a.Pdf:return"PDF";case r.a.Visio:return"Visio";case r.a.Audio:return"Audio";case r.a.Video:return"Video";case r.a.Photos:return"Photos";case r.a.Outlook:return"Outlook";case r.a.Text:return"Text";case r.a.Sway:return"Sway";case r.a.Forms:case r.a.FormsQuiz:return"Forms";case r.a.Project:return"Project";case r.a.ProjectOperations:return"ProjectOperations";case r.a.Portfolio:return"Portfolio";case r.a.NewsArticle:return"NewsArticle";case r.a.Fluid:case r.a.MeetingNotes:return"Loop";case r.a.PowerBI:return"PowerBI";case r.a.StreamsVideo:return"Streams";case r.a.Stream:return"Stream";case r.a.ScreenRecording:return"ScreenRecording";case r.a.UpcomingMeeting:return"UpcomingMeeting";case r.a.Link:return"Link";case r.a.List:return"List";case r.a.PlayLists:return"PlayLists";case r.a.PlayList:return"PlayList";case r.a.MindMeister:return"MindMeister";case r.a.Monday:return"monday.com";case r.a.Trello:return"Trello";case r.a.Platform:return"Platform";case r.a.Whiteboard:return"Whiteboard";case r.a.MeetingObject:return"MeetingObject";case r.a.ThirdParty:return"Custom";case r.a.MyAnalytics:return"MyAnalytics";case r.a.Designer:return"Designer";case r.a.ner:return"Planner";case r.a.ToDo:return"ToDo";default:return"Document"}}},TsNJ:function(e,t){e.exports=function(e){return function(t){return e(t)}}},Ttqn:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("GMuP"),o=n("CMIS"),i=n("Dn7E"),s=n("Gstq"),a=n.n(s),c=function(){var e="harmony",t=a()(e),n=new Map;return function(){return{getLogger:function(r){void 0===r&&(r=e);var o=n.get(r);if(void 0!==o)return o;var i=t.extend(r);return n.set(r,i),i},deleteLogger:function(e){void 0!==n.get(e)&&n.delete(e)}}}}(),u=function(e){return void 0===e?[]:e},l=function(e){var t=e.name,n=e.area,s=e.subArea,a=c().getLogger(t);return n&&(a=a.extend(n)),s&&(a=a.extend(s)),{log:a,diagnostic:function(e){var t=e.properties;a(e.message,u(e.args)),Object(r.a)(t)},error:function(e){var t=e.properties;a(e.message,u(e.args)),Object(o.a)(t)},feature:function((function(){rrn r.type=n,r}return Object(r.__extends)(t,e),t}(Error)},UKnr:function(e,t,n){"use strict";t.decode=t.parse=n("MNOf"),t.encode=t.stringify=n("THQi")},UVG0:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"loadStyles",(function(){return l})),n.d(t,"configureLoadStyles",(function(){return d})),n.d(t,"configureRunMode",(function(){return h})),n.d(t,"flush",(function(){return f})),n.d(t,"loadTheme",(function()t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o="undefined"==typeof window?e:window,i=o&&o.CSPSettings&&o.CSPSettings.nonce,s=function(){var e=o.__themeState__||{theme:void 0,lastStyleElement:void 0,registeredStyles:[]};return e.runState||(e=r(r({},e),{perf:{count:0,duration:0},runState:{flushTimer:0,mode:0,buffer:[]}})),e.registeredThemableStyles||(e=r(r({},e),{registeredThemableStylon(){return"undefined"!=typeof performance&&performance.now?performance.now():Date.now()};function u(e){var t=c();e();var n=c();s.perf.duration+=n-t}function l(e,t){void 0===t&&(t=!1),u((functionState,o=r.flushTfunction(){ret hs={newStyle:n},document.dispatchEvent(c);var u={styleElement:n,themableStyle:e};a?s.registeredThemableStyles.push(u):s.registeredStyles.push(u)}}(e)}function m(e){s.theme=e,function(){if(s.theme){for(var e=[],t=0,n=s.registeredThemableStyles;t<n.length;t++)e.push(n[t].themableStyle);e.length>0&&(g(1),p([].concat.apply([],e)))}}()}function g(e){voids),s.registeredThemableStyles=[])}function v(e){e=r.index;o>n&&t.push({rawSt)})}return t}}.call(this,n("pCvA"))},UgeB:function(e,t,n){var r=n("GI0s"),o=n("T9Ud");e.exports=function(e){return o(e)&&"[object Arguments]"==r(e)}},V1Qu:function(e,t,n){"use strict";n.d(t,"l",(function(){return c})),n.d(t,"f",(function(){return h})),n.d(t,"k",(function(){return f})),n.d(t,"c",(function(){return p})),n.d(t,"g",(function(){return b})),n.d(t,"b",(function(){return y})),n.d(t,"e",(function(){return w})),n.d(t,"d",(function(){return C})),n.d(t,"h",(function(){return O})),n.d(t,"a",(function(){return T})),n.d(t,"i",(function(){return S})),n.d(t,"m",(function(){return k})),n.d(t,"j",(function(){return E}));var r=n("QjXU"),o=n("Jxb/"),i=n("lpeV"),s=n("amPu"),a=n("i3m/"),c="https://graph./\/[\S]*?-my\.sharepoint[\S]*?\.com/,d=/http[s]?:\/\/d\.docs\.livee?e.officeHomeApiRoot:e.oneDriveConsumerApi},f=function(e){return e&&e.length?"$select="+e.join(","):void 0},ction(e){return e?"WacDataCenter=".concat(e):void 0},g=function(e){return e?"usid=".concat(e):void 0},v=function(e){return e?"hid=".concat(e):void 0},b=function(e){return(null==e?void 0:e.isESSEnabled)&&(null==e?void 0:e.wacDataCenter)?[m(null==e?void 0:e.wacDataCenter),g(null==e?void 0:e.sessionId),v(null==e?void 0:e.hostCorrelationId)]:[]};function y(e){if(e&&e.length){if(e.match(l)||e.match(d))return"OneDrive";if(e.match(u))return"SharePoint";if(e.startsWith(c))return"Graph"}}function w(e,t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!1),"".concat(t.inMockMode?t.officeHomeApiRoot:e,n?"/_api":r?"/_api/v2.1":"/_api/v2.0")}function C(e,t,n){var r,s=t.isConsumer,a=t.oneDriveResourceId,c=new URL(e);if(c&&c.protocol&&c.host){var u=s?a:"".concat(c.protocol,"//").concat(c.host),l=s?h(t):w(u||"",t),d=s?"OneDrive":null!==(r=y(u||""))&&void 0!==r?r:"None";if(u&&l&&d)return{baseUrl:l,tokenType:d,resourceUrl:u,hostname:c.hostname};null==n||n.ULS.sendTraceTag(542492316,o.a.msoulscat_Wac_UnifiedUiHost,i.a.Error,"GetApiInfo failed. [InvalidResourceUrl: ".concat(!u,"][InvalidBaseUrl: ").concat(!l,"][InvalidTokenType: ").concat(!d,"]"))}else null==n||n.ULS.sendTraceTag(542492315,o.a.msoulscat_Wac_UnifiedUiHost,i.a.Error,"GetApiInfo failed. [InvalidParsedUrl: ".concat(!c,"][InvalidProtocol: ").concat(!(null==c?void 0:c.protocol),"][Invalidhost: ").concat(!(null==c?void 0:c.host),"]"))}function O(e,t,n,r){return void 0===r&&(r=!1),"".concat(n?e:c,"/").concat(r?"beta":"v1.0","/").concat(t)}functioromise((function(r,o){var i,s=!1,a=!1;e.then((function(e){i=e,!s&&n||(r(e),a=!0)}),(function(e){s&&(o(e),a=!0),s=!0})),t.then((function(e){r(e),a=!0}),(function(e){s?(o(e),a=!0):i&&!a&&(r(i),a=!0),s=!0}))}))}function S(e){return Object(s.a)(e,{accept:"application/json",prefer:"allow-zerobyte"})}function k(e){return!!e.match(l)||!!e.match(d)||!!e.match(u)}function E(e,t,n,o,i){void 0===o&&(o=""),void 0===i&&(i="open");var s=t?Object(r.__spreadArray)([],Object(r.__read)(new Set(e.concat(a.a))),!1):e,c=s.length?"$select,n,i){var s=!n;n||(n={});for(var a=-1,c=t.length;++a<c;){var u=t[a],l=i?i(n[u],e[u],u,n,e):void 0;void 0===l&&(l=e[u]),s?o(n,u,l):r(n,u,l)}return n}},V2nY:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e){r.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_SchemaObject"}static getBaseTypes(){return[]}static getTypeNameFor(e){return e&&e.H_?e.H_.T_:void 0}static getBaseTypesFor(e){return e&&e.H_&&e.H_.B_?e.H_.B_:[]}static getAllTypesFor(e){const t=r.getTypeNameFor(e);return t?[t,...r.getBaseTypesFor(e)]:[]}static matchesTypesFor(e,t){if(!Array.isArray(t)||0===t.length)return!0;const n=r.getTypeNameFor(e),o=r.getBaseTypesFor(e);for(const e of t){if(e===n)return!0;if(o.indexOf(e)>=0)return!0}return!1}static assign(e,t,n){if(n)for(const e of Object.keys(n))t[e]=n[e];return t.H_=e.H_,t}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},V678:function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return h}));const r=new class{constructor(e){this.valueGenerator=e,this._evaluatealuated(){return this._evaluated}get value(){return this._evaluated||(this._evaluated=!0,this._value=this.valueGenerator()),this._value}}((()=>i(c()))),o={getRawConfig:()=>{}},i=e=>n0!==n?n:void 0))||void 0===r?void 0:r.raw}catch(e){}}}):o;function s(e){switch(e){case"boolean":case"number":case"string":return!0;default:return!1}}function a(e){let t,n=e;if("string"==typeof e)try{n=JSON.parse(e),t={raw:e,string:e}}catch(e){}if(void 0===n)return t;const r=typeof n;if(s(r))return Object.assign(Object.assign({},t),{raw:e,[r]:n});if(Array.isArray(n)){const r=typeof n[0];if(!s(r))return t;for(const e of n)if(typeof e!==r)return t;return Object.assign(Object.assign({},t),{raw:e,[`${r}[]`]:n})}return t}const c=()=>{try{return null!==sessionStorage?sessionStorage:void 0}catch(e){return}};class u{constructor(){this.configCache=new Map,this.orderedBaseProviders=[];const e=new Set;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];const o=[...n];for(;o.length>0;){const t=o.shift();void 0!==t&&f(t)&&!e.has(t)&&(e.add(t),t instanceof u?o.push(...t.orderedBaseProviders):this.orderedBaseProviders.push(t))}}getBoolean(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.boolean}getNumber(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.number}getString(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.string}getBooleanArray(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t["boolean[]"]}getNumberArray(e){var t;return null===(t=thi===(t=this.getCacheEntry(e))||void 0===t?void 0:t["string[]"]}getRawConfig(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.raw}getCacheEntry(e){if(!this.configCache.has(e)){for(const t of this.orderedBaseProviders){const n=a(null==t?void 0:t.getRawConfig(e));if(void 0!==n)return this.configCache.set(e,n),n}this.configCache.set(e,{raw:void 0})}return this.configCache.get(e)}}function l(e){const t=e;return f(null==t?void 0:t.config)&&void 0!==(null==t?void 0:t.logger)}function d(e){return l(e)?e:h(e,r.value)}function h(e){if(l(e))throw new Error("Logger is already a moni-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return t.config=new u(...r),t.logger=e,t}function f(e){return"function"==typeof(null==e?void 0:e.getRawConfig)}},VDyW:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("QjXU"),o=n("nX9G"),i=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(o.a)()];case 1:return[2,(0,t.sent().openFileInExplorer)(e)]}}))}))}},VNQV:function(e,t,n){var r=n("LSEb")(n("s3UK"),"DataView");e.exports=r},VOWq:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("QjXU"),o=n("Eac/");function i(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(i){switch(i.label){case 0:return n=Objecase 1:return[2,i.sent()]}}))}))}},VZJX:function(e,t,n){var r=n("cm7J");e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},VbEw:function(e,t,n){"use strict";functiot),n}:function(e,t,n){var r=n("6iN7"),o=n("lgYy"),i=n("SyCk");e.exports=function(e){return i(e)?r(e,!0):o(e)}},W0B4:function(e,t,n){e.exports=n("NS33")()},W3qw:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("PnKM");function o(e,t){"UnauthenticatedGuest"!==e.identityType&&Object(r.c)(e,[t.documentUrl]).catch((()=>{}))}},W7wX:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("QjXU"),o=n("MJsD"),i=n("B5kz");function s(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Objectime:1t=this.__data__=new r(e);this.size=t.size}u.prototype.clear=o,u.prototype.delete=i,u.p){"use strict";n.d(t,"a",(function(){return u}));var r=n("mXGw"),o=()=>r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner.current,i=new WeakSet;function s(e,t){const n=o();r.useEffect((()=>i.has(n)?e():(i.add(n),void e())),t)}var a=new WeakSet;function c(e,t){return r.useMemo((()=>{const t=o();return a.):(a.add(t),null)}),t)}function u(e,t){var n;const o=(()=>!1)()&&!1,i=o?c:r.useMemo,a=o?s:r.useEffect,[u,l]=null!=(n=i((()=>e()),t))?n:[null,()=>null];return a((()=>l),t),u}},Wa5Y:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("QjXU"),o=n("kb6k"),i=n("lAHu");function s(e,t,n,s,a,c,u,l,d,h,f,p){void 0===h&&(h={});var m="cache-only"===f;m&&(d="None");var g=Object(r.__assign)(Object(r.__assign)({},s),{url:n,method:"GET"});return Object(o.a)((function(n){return Object(i.a)(e,t,n,u,l,f,h.populateRequestEvent,h.onUploadProgress,h.onDownloadProgress,h.cancellationToken,h.timeoutInMs)}),e,t,g,a,cAuth,m,h.silent,h.capDialogData,p)}},WjON:function(e,t,n){var r=n("zcvR");e.exports=function(e){var t=r(this,e).delete(e);return size-=t?1:0,t}},Wux9:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o}));var r=n("01JL");class o{static deserialize(t,n=(e=>e)){if(t[0]!==o.IDENTIFIERBYTE)throw new Error("Invalid Binary: Incorrect Identifier");let r=1;const i=[],s=new DataView(t.buffer,t.byteOffset,t.byteLength);for(;r<t.byteLength;){if(r+4>t.byteLength)throw new Error("Invalid Binary: Error reading fragment length");const n=s.getUint32(r);if(r+n+4>t.byteLength)throw new Error("Invalid Binary: Fragment out of range");i.push(void 0!==e&&e.from?e.from(t.buffer,t.byteOffset+r+4,n):new Uint8Array(t.buffer,t.byteOffset+r+4,n)),r+=4+n}if(i.length<1)throw new Error("Invalid Binary: No fragments found");const a=o.textDecoder.decode(i[0]);return JSON.parse(a,((e,t)=>{if("string"==typeof t){if(t.substring(0,o.BINARYKEYWORD.length)===o.BINARYKEYWORD){const e=parseInt(t.substring(o.BINARYKEYWORD.length),10);if("number"!=typeof e||e>=i.length-1)throw new Error("Invalid Binary: Binary index out of range");return n(i[e+1])}if(t.substring(0,o.ESCAPEKEYWORD.length)===o.ESCAPEKEYWORD)return t.substring(o.ESCAPEKEYWORD.length)}return t}))}static serialize(e){const t=[void 0],n=JSON.stringify(e,((e,n)=>ArrayBuffer.isView(n)?(t.push(n),`${o.BINARYKEYWORD}${t.length-2}`):n&&"Buffer"===n.type&&Array.isArray(n.data)?(t.push(new Uint8Array(n.data)),`${o.BINARYKEYWORD}${t.length-&n.substring(0,o.ESCAPEKEYWORD.length)===o.ESCAPEKEYWORD?o.ESCAPEKEYWORD+n:n));t[0]=o.textEncoder.encode(n);const r=t.reduce(((e,t)=>e+4+t.byteLength),0),i=new Uint8Array(r+1);i[0]=o.IDENTIFIERBYTE;let s=1;const a=new DataView(i.buffer,i.byteOffset,i.byteLength);for(const e of t)a.setUint32(s,e.byteLength),i.set(e,s+4),s+=4+e.byteLength;,e.User.Succion(e,t){return null==e?void 0:e[t]}},XXCu:function(e,t){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},XcEc:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("QjXU"),o=n("mgFK"),i=n("CRHC"),s=n("m32Q"),a=n("lkvL"),c=n("a3FV"),u=n("0TX8"),l=n("Wa5Y");function d(e,t,n,o,i,s,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var d,h,f;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:d={},h={method:"GET",responseType:"json",url:"".concat(o,"/api/featureGates")},r.label=1;case 1:return r.trys.push([1,4,,5]),[4,Object(u.a)(h,n,i,t)];case 2:return r.sent(),[4,Object(l.a)(c.a.FeatureGatesRequest,"FeatureGates",h.url,h,a,s,o,e,"OfficeHome",{})];case 3:return(f=r.sent().data)?[2,f]:[3,5];case 4:return r.sent(),[3,5];case 5:return[2,d]}}))}))}var h="featureGates";function f(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(o.a)(h,e)];case 1:return[2,t.sent()]}}))}))}function p(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){return[2,Object(i.a)((function(){return function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,f(t)];case 1:return void 0!==(n=r.sent())?[3,3]:[4,d(t.correlationId,(function(){return Promise.resolve(e)}),t.inMockMode,t.officeHomeApiRoot,t.workload,t.getAccessToken,t.jwtAuthEnabled)];case 2:n=r.sent(),r.label=3;case 3:return[2,n]}}))}))}(e,t)}),(function(){return Object(s.a)({userId:e.puid,collectionName:h,collectionVersion:1,key:h})turn Object(a.a)({userId:e.puid,collectionName:h,collectionVersion:1,key:h,data:0===Object.keys(t).length?null:t})}))]}))}))}},Xd2i:function(e,t,n){},XlCq:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var r="https://go.microsoft.com/fwlink/?linkid=2228772",o="login_hint"},Xou4:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return c}));var r=n("KlUR");function o(e,t){switch(t){case"base64":return r.fromByteArray(e);case"utf8":c(new TextDecoder).decode(e);default:throw new Error("invalid/unsupported encoding")}}const i=(e,t)=>c.from(e,t).buffer,s=(e,t)=>c.from(e).toString(t);function a(e){return e instanceof ArrayBuffer||"object"==typeof e.byteLength&&"function"==typeof e.slice&&void 0===e.byteOffset&&void 0===e.buffer}class c extends Uint8Array{toString(e){return o(this,e)}static from(e,t,n){if("string"==typeof e)return c.fromString(e,t);if(null!==e&&"object"==typeof e&&a(e.buffer))return c.fromArrayBuffer(e.buffer,e.byteOffset,e.byteLength);if(a(e))return c.fromArrayBuffer(e,t,n);throw new TypeError}static fromArrayBuffer(e,t,n){const r=null!=t?t:0,o=null!=n?n:e.byteLength-r;if(r<0||r>e.byteLength||o<0||o+r>e.byteLength)throw new RangeError;return new c(e,r,o)}static fromString(e,t){switch(t){case"base64":{const t=this.sanitizeBase64(e),n=r.toByteArray(t);return new c(n.buffer)}case"utf8":case"utf-8":case void 0:{const t=(new TextEncoder).encode(e);return new c(t.buffer)}default:throw new Error("invalid/unsupported encoding")}}static isBuffer(e){throw new Error("unimplemented")}static sanitizeBase64(e){let t=e;return t=t.split("=")[0],t=t.replace(/[^\w+-/]/g,""),t.length%4!=0&&(t+=["","===","==","="][t.length%4]),t}}},Xq91:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t)=>{if(void 0!==e&&void 0!==t)return e-t}},"Y/GB":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r="wdPreviousSession",o="wdPreviousSessionSrc"},Y0sh:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("6ib3"),o=n("vnUm"),i=function(e){var t;return null!==(t=o.a.get(e.toLowerCase()))&&void 0!==t?t:r.a.None}},YBAc:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("QjXU"),o=n("eEiw"),i=n("kAXT"),s=n("NkqM"),a="_blank",c=function(e,t,n){return{type:e,payload:Object(r.__assign)(Object(r.__assign)({},t),n)}},u={createContentUrlAction:function(e,t,n,r){return void 0===n&&(n=a),c(o.a.contentUrl,{url:Object(s.a)(e),launchAction:t?"OpenAttachment":"OpenFile",target:n},r)},createContentDownloadAction:function(e,t,n,r,i,u,l){return void 0===i&&(i=a),c(o.a.contentDownload,{url:Object(s.a)(e),launchAction:"Download",target:i,driveId:t,itemId:n,sharePointIds:r,tooltipString:u},l)},createContentNativeDownloadAction:function(e,t,n){return void 0===t&&(t=a),c(o.a.contentNative,{url:Object(s.a)(e),launchAction:"OpenInApp",target:t},n)},createContentLocationAction:function(e,t,n,r){return void 0===t&&(t=a),c(o.a.contentLocation,{url:Object(s.a)(e),launchAction:"OpenFileLocation",target:t,tooltipString:n},r)},createContentLocationLocalAction:function(e,t){return c(o.a.contentLocationLocal,{url:Object(s.a)(e)},t)},createContentOpenAction:function(e,t){return c(o.a.contentOpen,{content:e},t)},createConvertDriveItemAction:function(e,t,n,r,i,s,a,u,l){return c(o.a.convertDriveItem,{driveId:e,format:i,isRedeemed:a,itemId:t,originalFileExtension:r,originalFileNameWithoutExtension:n,sharePointIds:s,url:u},l)},createCopyToClipboardAction:function(e,t){return c(o.a.copyToClipboard,{data:e},t)},createDeleteAction:function(e){var t=e.content;return c(o.a.delete,{attributionUrl:t.attributionUrl,content:t,contentSource:e.contentSource,driveId:e.driveId,itemId:e.itemId,sharePointIds:e.sharePointIds,tooltipString:e.tooltipString},e.options)},createDeleteRestoreAction:function(e){return c(o.a.deleteRestore,{content:e.content},e.options)},createLaunchAppInContextAction:function(e,t,n,r,i){return c(o.a.contentAppInContext,{appId:e,entityId:t,subEntityId:n,target:"_self",queryParams:i},r)},createLaunchUrlAction:function(e,t,n){return void 0===t&&(t=a),c(o.a.externalUrl,{url:Object(s.a)(e),launchAction:"OpenInBrowser",target:t},n)},createLaunchExternalUrlInContextAction:function(e,t){return c(o.a.externalUrlInContext,{props:e,nextAction:null==t?void 0:t.nextAction},t)},createLinkContentOpenAction:function(e,t){return c(o.a.linkContentOpen,{content:e},t)},createNavigateToApp:function(e,t,n,r,i){return c(o.a.deepLinkToApp,{appId:e,entityId:t,subEntityId:n,target:"_self",queryParams:i},r)},createNavigateToAppExternal:function(e,t,n,r,i,s){return void 0===n&&(n="_blank"),c(o.a.deepLinkToAppExternal,{appId:e,entityId:t,subEntityId:r,target:n,queryParams:s},i)},createOpenTaskModuleAction:function(e,t,n,r,i,s){return c(o.a.openTaskModule,{appId:e,url:t,height:n,width:r,additionalParams:i},s)},createShareOrCopyAction:function(e,t,n,r,s,a,u,l,d,h,f){return void 0===r&&(r=i.a.Share),c(o.a.contentShareInContext,{companyDisplayName:e,elementId:s,containerStyles:a,name:t,fileType:u,fileName:t,mode:r,odspShareInfo:n,tooltipString:l,shareUIPositionOverride:h,ariaLabel:f},d)},createContentShareToTeamsAction:function(e,t,n,r,i,s,a,u,l,d,h){return c(o.a.openShareToTeams,{createSharingLinkApiEnabled:i,driveId:a,shouldOpenExternal:r,itemId:u,siteId:l,title:t,url:e,dialogStrings:n,companyDisplayName:s,isRedeemed:d},h)},createTodoAction:function(e,t,n,r,i){return c(o.a.createTodo,{applicationName:r,listId:n,title:e,url:Object(s.a)(t)},i)},createScheduleAction:function(e,t,n,r){return c(o.a.schedule,{title:e,url:t,isRedeemed:n},r)}}},YIvB:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));const r=new Map([["Automation",0],["Local",1],["Staging",2],["Dogfood",3],["Preview",4],["Microsoft",5],["SyntheticTraffic",5],["Production",6],["GCC",7],["GCC-High",8],["DoD",8]]);function o(e,t){let n=t;void 0===n&&(n="Production");const o=r.get(e),i=r.get(n);return void 0!==o&&void 0!==i&&i<=o}},YKlt:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("/Oio");function o(e){switch(e){case r.a.Antp:return"unknown";case r.a.Hwa:return"HarmonyDesktop";case r.a.OfficeHome:case r.a.OfficeHomeReact:return"HarmonyWeb";case r.a.Embed:return"HarmonyEmbed"}}},YQN1:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("fFwu");function o(e,t){return Object(r.initializeFluentTheme)(t.fluentThemeSubscription),e.bootstrapOfficeStart()}},YTdI:function(e,t,n){"use strict";var r;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),function(e){e.Init="Init",e.EditResult="EditResult",e.AppOnlyResult="AppOnlyResult"}(r||(r={}));var o,i={contentLoading:!1,dialogState:r.Init,responseLoading:!1,versionHistory:[],currentWorkingContentIndex:-1,hasError:!1,errorType:void 0,errorLocation:void 0,createdDocType:void 0,createContentInSuggestedAppLoading:!1,createdDocWebUrl:void 0};!function(e){e.InitError="InitError",e.RefinerError="RefinerError",e.CreationErro)}function o(e){return e.replace(/(https:\/\/)(dev.loop.microsoft.com|df.){return o}))},YaJL:function(e,t,n){var r=n("LSEb"),o=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=o},Yk0T:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o}));var r=n("9Rh3");function o(t,n,o){void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===o&&(o="res.cdn.office.net/officehub"),Object(r.a)(t?e.env.PUBLIC_URL+"/fonts/":"https://"+o+"/officestarticons/qT:function(e,t,n){"use strict";n.r(t),n.d(t,"DraftContentModuleNgFactory",(function(){return vu}));var r=n("keVe"),o=function(){return function(){}}(),i=n("fYis"),s=n("g/dT"),a=n("W3Zz"),c=n("hhzZ"),u=n("QjXU"),l=n("GBVN"),d=n("i+S2"),h=n("mXGw"),f=n.n(h),p=n("p/uK"),m=n("DU/N"),g=n("sLnE"),v=Object(p.a)({flexContainer:{boxSizing:"border-box",display:"flex",position:"relative",alignItems:"stretch",height:"100%",width:"100%",backgroundColor:m.a.colorNeutralBackground1},flexContainerColumn:{flexDirection:"column"},flexContainerRow:{flexDirection:"row"},canvasContainer:Object(u.__assign)({backgroundColor:m.a.colorNeutralBackground3,justifyContent:"center",height:"calc(100% - 64px)"},g.a.padding("32px","0")),subCanvasContainer:{justifyContent:"center",maxWidth:"1024px"}}),b=n("qxHO"),y=n("86XU"),w=n("Z84d"),C=n("xOOG"),O=n("XzT5"),T=n("kYT1"),S=n("d+i3"),k=n("xwQ8"),E=n("x3xY"),_=n("p43c"),j=n("+0a/"),I=n("Ip3P"),N=n("hP5u"),A=n("rcDG"),P=n("rt0l"),x=n("QRGu"),D=n("Kpgc"),L=n("X7Ji"),M=n("AUof"),R=n("gzKm"),F=n("SMJs"),B=n("9GDl"),U=n("b87O"),W=n("AcOL"),q=n("5DIn"),H=Object(p.a)({header:Object(u.__assign)(Object(u.__assign)(Object(u.__assign)({display:"flex",flexDirection:"row",flexWrap:"nowrap",alignItems:"stretch",height:"54px"},g.a.padding("4px","12px","4px","12px")),{justifyContent:"space-between",boxShadow:m.a.shadow4,backgroundColor:m.a.colorNeutralBackground1}),g.a.borderBottom(m.a.strokeWidthThin,"solid",m.a.colorNeutralStroke1)),breadcrumb:{alignSelf:"center"},subHeader:{alignSelf:"center",display:"flex",flexDirection:"row",flexWrap:"nowrap",alignItems:"stretch",justifyContent:"space-between"},renameButton:{fontWeight:m.a.fontWeightSemibold,backgroundColor:m.a.colorNeutralBackground1},breadcrumbCommon:{fontFamily:m.a.fontFamilyBase,lineHeight:m.a.lineHeightBase300,fontSize:m.a.fontSizeBase300},breadcrumbItem:{fontWeight:m.a.fontWeightRegular,color:m.a.colorNeutralForeground2},title:{fontWeight:m.a.fontWeightSemibold,color:m.a.colorNeutralForeground2},subTitle:{fontWeight:m.a.fontWeightRegular,color:m.a.colorNeutralForeground4},renameInput:{color:m.a.colorNeutralForeground1},icon:{paddingTop:"2px",paddingLeft:"4px"},sharedState:{marginLeft:"20px",fontFamily:m.a.fontFamilyBase,lineHeight:m.a.lineHeightBase200,fontSize:m.a.fontSizeBase200,fontWeight:m.a.fontWeightRegular,color:m.a.colorNeutralForeground3},menu:{backgroundColor:m.a.colorNeutralBackground1},menuButton:{alignSelf:"center"}}),z=n("Skyl"),G=n("OPvK"),V=n("Qm6i"),$=n("nvMe"),Q=new Map([["#C239B3","lilac"],["#CA5010","pumpkin"],["#E3008C","magenta"],["#A4262C","cranberry"],["#498205","forest"],["#69797E","platinum"],["#881798","grape"],["#D13438","red"],["#0078D4","blue"],["#038387","teal"],["#750B1C","dark-red"],["#986F0B","brass"],["#4F6BED","cornflower"],["#8764B8","lavender"],["#0B6A0B","dark-green"],["#7A7574","mink"],["#5C2E91","purple"],["#005B70","steel"],["#8E562E","brown"]]),J=n("kTxb"),X=function(e){var t=e.logDraftsFeatureCallback,n=e.name,r=e.presenceColorProvider,o=e.userPrincipalName,i=function(e){var t=this,n=e.fetchPersonPictureDataCallback,r=e.logDraftsFeatureCallback,o=e.userPrincipalName,i=Object(u.__read)(Object(h.useState)(),2),s=i[0],a=i[1];return Object(h.useEffect)((function(){void 0===s&&o&&function(e){Object(u.__awaiter)(t,void 0,void 0,(function(){var t,o,i;return Object(u.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,n(e)];case 1:return(t=s.sent().result)&&(o=Object(J.a)("image/png",t),a(o)),[3,3];case 2:return i=s.sent(),r({eventName:"AvatarImageError",status:"Error",error:i}),[3,3];case 3:return[2]}}))}))}(o)}),[s,n,r,o]),s}({fetchPersonPictureDataCallback:e.fetchPersonPictureDataCallback,logDraftsFeatureCallback:t,userPrincipalName:o}),s=function(e){var t=this,n=e.logDraftsFeatureCallback,r=e.presenceColorProvider,o=e.userPrincipalName,i=Object(u.__read)(Object(h.useState)(void 0),2),s=i[0],a=i[1];return Object(h.useEffect)((function(){!function(){Object(u.__awaiter)(t,void 0,void 0,(function(){var e,t,i;return Object(u.__generator)(this,(function(c){switch(c.label){case 0:if(!(rreturn[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),[4,r.getPresenceColorForUser(o)];case 2:return(e=c.sent())&&(t=function(e){return Q.get(e)}(e),a(t)),[3,4];case 3:return i=c.sent(),n({eventName:"AvatarColorError",status:"Error",error:i}),[3,4];case 4:return[2]}}))}))}()}),[s,n,r,o]),s}({presenceColorProvider:r,userPrincipalName:o,logDraftsFeatureCallback:t});return h.createElement($.a,{name:n,key:o,activeAppearance:"ring",active:"active",color:null!=s?s:"colorful",image:i?{src:i}:void 0})},K=Object(p.a)({avatarGroup:{display:"flex",alignItems:"center",marginRight:"4px"}}),Y=function(e){var t=e.fetchPersonPictureDataCallback,n=e.logDraftsFeatureCallback,r=e.members,o=K(),i=Object(h.useMemo)((function(){return Object(u.__spreadArray)([],Object(u.__read)(r.values()),!1)}),[r]),s=Object(z.a)({items:i,maxInlineItems:5}),a=s.overflowItems;return f.a.createElement("div",{className:o.avatarGroup},f.a.createElement(G.a,{layout:"stack",size:24},s.inlineItems.map((function(e){return f.a.createElement(X,{name:e.name,userPrincipalName:e.email,key:e.email,presenceColorProvider:e.presenceColorProvider,logDraftsFeatureCallback:n,fetchPersonPictureDataCallback:t})})),a&&f.a.createElement(V.a,null,a.map((function(e){return f.a.createElement(X,{name:e.name,userPrincipalName:e.email,key:e.email,presenceColorProvider:e.presenceColorProvider,logDraftsFeatureCallback:n,fetchPersonPictureDataCallback:t})})))))},Z=function(e){var t=e.draftTitle,n=e.isReadOnly,r=e.renameDraftCallback,o=e.changeRouteCallback,i=e.isCompact,s=e.draftStrings,a=e.actionsProps,c=e.transformEnabled,d=e.showTransformPane,p=e.toggleTransformPaneCallback,m=e.members,g=e.logDraftsFeatureCallback,v=e.fetchPersonPictureDataCallback,z=H(),G=Object(u.__read)(Object(h.useState)(t),2),V=G[0],$=G[1],Q=Object(u.__read)(Object(h.useState)(t),2),J=Q[0],X=Q[1],K=Object(u.__read)(Object(h.useState)(""),2),Z=K[0],ee=K[1],te=Object(T.a)().ref,ne=Object(R.a)(F.c,F.d),re=Object(R.a)(B.h,B.i),oe=Object(h.useMemo)((function(){return Object(l.a)(z.breadcrumbCommon,z.breadcrumbItem)}),[z]),ie=Object(h.useMemo)((function(){return Object(l.a)(z.breadcrumbCommon,z.breadcrumb)}),[z]),se=Object(h.useMemo)((function(){return Object(l.a)(z.breadcrumbCommon,z.breadcrumb,z.menuButton)}),[z]),ae=Object(h.useMemo)((function(){return Object(l,z.title)}),[z]),ce=Object(h.useMemo)((function(){return Object(l.a)(z.breadcrumbCommon,z.subTitle)}),[z]);Object(h.useEffect)((function(){$(t),X(t)}),[t]);var ue=Object(u.__read)(Object(h.useState)(!1),2),le=ue[0],de=ue[1],he=Object(h.useCallback)((function(){return Object(u.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(u.__generator)(this,(function(t){switch(t.label){case 0:return ee(s.renameSaving),$(J),[4,r(J)];case 1:return e=t.sent(),ee(e?s.renameSaved:s.renameUnsaved),[2]}}))}))}),[s,J,r]),fe=Object(h.useCallback)((function(e,t){return Object(u.__awaiter)(void 0,void 0,void 0,(function(){var n;return Object(u.__generator)(this,(function(r){switch(r.label){case 0:return n=e,t.open||V===J?[3,3]:n.key&&Object(W.a)(n)===q.a.Escape?[3,2]:[4,he()];case 1:return r.sent(),[3,3];case 2:X(V),r.label=3;case 3:return de(!!t.open),e.preventDefault(),e.stopPropagation(),[2]}}))}))}),[V,J,he]);return f.a.createElement("div",{className:z.header},f.a.createElement(b.a,{focusMode:"tab",dividerType:"chevron",size:"medium",className:z.breadcrumb},i?f.a.createElement(f.a.Fragment,null,f.a.createElement(S.a,{hasIcons:!0},f.a.createElement(k.a,{disableButtonEnhancement:!0},f.a.createElement(E.a,{appearance:"transparent",className:se,ref:te,icon:f.a.createElement(ne,null),role:"tab"})),f.a.createElement(_.a,null,f.a.createElement(j.a,{className:z.menu},f.a.createElement(I.a,{className:ie,onClick:function(){return o(!1)}},s.myContentBreadcrumb),f.a.createElement(I.a,{className:ie,onClick:function(){return o(!0)}},s.draftsPivotBreadcrumb))))):f.a.createElement(f.a.Fragment,null,f.a.createElement(y.a,null,f.a.createElement(w.a,{className:oe,as:"a",appearance:"transparent",onClick:function(){return o(!1)}},s.myCeateElement(C.a,null),f.a.createElement(y.a,null,f.a.createElement(w.a,{className:ie,as:"a",appearance:"transparent",onClick:function(){return o(!0)}},s.draftsPivotBreadcrumb))),f.a.createElement(C.a,null),f.a.createElement(y.a,{current:!0},f.a.createElement(N.a,{withArrow:!0,trapFocus:!0,open:le,onOpenChange:fe},f.a.createElement(A.a,{disableButtonEnhancement:!0},f.a.createElement(P.a,{className:z.renameButton,appearance:"subtle",disabled:n},f.a.createElement("span",{className:ae},i?Object(O.a)(V):V),Z?f.a.createElement("span",{className:ce},"",Z):null)),f.a.createElement(x.a,null,f.a.createEf.a.createElement(L.a,{className:z.renameInput,defaultValue:V,value:J,type:"text",name:s.draftRenameTitle,onChange:function(e){return X(e.target.value)},onKeyDown:function(e){return Object(u.__awaiter)(void 0,void 0,void 0,(function(){return Object(u.__generator)(this,(function(t){switch(t.label){case 0:return Object(W.a)(e)!==q.a.Enter?[3,2]:(de(!1),[4,he()]);case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}})))))),f.a.createElement("div",{className:z.subHeader},m.size>0&&f.a.createElement(Y,{members:m,logDraftsFeatureCallback:g,fetchPersonPictureDataCallback:v}),a&&f.a.createElement("div",{id:"draftShare"},f.a.createElement(U.a,Object(u.__assign)({},a))),c&&f.a.createElement("div",{id:"draftTransform"},f.a.createElement(M.a,{icon:f.a.createElement(re,null),checked:d,onClick:function(){return p()}},s.transform))))},ee=n("hF3S"),te=n("YuTw"),ne=n("n+k3"),re=n("jnRf"),oe=n("XxaS"),ie=n("/mqz"),se=n("QMGX"),ae=n("Ahos"),ce=n("YTdI"),ue=n("szsK"),le=n("HeHW"),de=Object(p.a)({drawer:Object(u.__assign)({minWidth:"592px",height:"auto"},g.a.overflow("hidden")),drawerBody:Object(u.__assign)(Object(u.__assign)({backgroundColor:"transparent",backgroundImage:"none"},g.a.padding("0px")),g.a.overflow("hidden")),header:Object(u.__assign)({height:"68px"},g.a.padding("0px","0px","24px","0px")),headerTitle:Object(u.__assign)(Object(u.__assign)({},g.a.padding("24px","16px","12px","24px")),g.a.gap("8px"))}),he=function(e){var t=e.showTransformPane,n=e.toggleTransformPaneCallback,r=e.draftStrings,o=e.firstDraftResources,i=e.handleCopyContentClick,s=e.handleCreateWithContentClickWrapper,a=e.handleCreateBlankDocClickWrapper,c=e.handleSeeAllAppsClick,l=e.handleCopyAndCreateFallback,d=e.showLatencyLoading,p=e.getAndSetDocumentTypeRecommendations,m=Object(u.__read)(Object(h.useState)([]),2),g=m[0],v=m[1],b=Object(u.__read)(Object(h.useState)(!0),2),y=b[0],w=b[1],C=de(),O=Object(le.a)(),T=Object(h.useMemo)((function(){return O?{background:ae.a}:{background:ae.b}}),[O]),S=Object(h.useCallback)((function(e){return p&&(t?p(e,v,w):e()&&!y&&(v([]),w(!0))),function(){}}),[p,t]);return Object(ue.a)(S),f.a.createElement(ee.a,{type:"inline",position:"end",size:"medium",separator:!0,open:t,style:T,className:C.drawer},f.a.createElement(te.a,{className:C.header},f.a.creame:C.headerTitle,action:f.a.createElement(E.a,{appearance:"subtle","aria-label":"Close",icon:f.a.createElement(oe.y,null),onClick:function(){return n()}})},r.transformDialogTitle)),f.a.createElement(re.a,{className:C.drawerBody},y?f.a.createElement(ie.a,{headerTitle:o.appsloadingText,cancelButtonText:o.loadingCancelText,stopGeneratingCallback:function(){}}):f.a.createElement(se.a,{isDarkMode:O,dialogState:ce.b.EditResult,disabled:!1,displayTitle:!1,documentTypeRecommendations:g,firstDraftResources:o,handleCopyContentClick:i,handleCreateWithContentClickWrapper:s,handleCreateBlankDocClickWrapper:a,handleSeeAllAppsClick:c,handleCopyAndCreateFallback:l,showLatencyLoading:d})))},fe=n("+9uq"),pe=Object(p.a)({readOnlyBanner:Object(u.__assign)(Object(u.__assign)(Object(u.__assign)(Object(u.__assign)({alignItems:"center",backgroundColor:m.a.colorNeutralBackground3,color:m.a.colorNeutralForeground1},g.a.borderBottom("1px","solid")),g.a.borderColor(m.a.colorNeutralStroke1)),{display:"flex",height:"36px"}),g.a.padding("0","18px")),readOnlyIcon:{color:m.a.colorNeutralForeground3,fontSize:m.a.fontSizeBase400,marginRight:"8px"},readOnlyLabel:{fontSize:m.a.fontSizeBase200,fontWeight:m.a.fontWeightSemibold,marginRight:"8px"},readOnlyText:{color:m.a.colorNeutralForeground3,fontSize:m.a.fontSizeBase200}}),me=function(e){var t=e.draftStrings,n=pe();return f.a.createElement("div",{className:n.readOnlyBanner},f.a.createElement(fe.l,{className:n.readOnlyIcon}),f.a.createElement("span",{className:n.readOnlyLabel},t.readOnly),f.a.createElement("span",{className:n.readOnlyText},t.readOnlyDescription))},ge=function(e){var t=e.isReadOnly,n=e.renderDraftCallback,r=e.renderContainerCallback,o=e.draftTitle,i=e.renameDraftCallback,s=e.changeRouteCallback,a=e.actionsProps,c=e.draftStrings,p=e.transformEnabled,m=e.firstDraftResources,g=e.handleCopyContentClick,b=e.handleCreateWithContentClickWrapper,y=e.handleCreateBlankDocClickWrapper,w=e.handleSeeAllAppsClick,C=e.handleCopyAndCreateFallback,O=e.showLatencyLoading,T=e.getAndSetDocumentTypeRecommendations,S=e.members,k=e.logDraftsFeatureCallback,E=e.fetchPersonPictureDataCallback,_=Object(d.a)("(max-width: 1024px)"),j=v(),I=Object(h.useRef)(null),N=Object(h.useMemo)((function(){return Object(l.a)(j.flexContainer,j.flexContainerColumn)}),[j]),A=Object(h.useMemo)((function(){return Object(l.a)(j.flexContainer,j.flexContainerRow,j.canvasC(j.flexContainer,j.flexContainerRow,j.subCanvasContainer)}),[j]),x=Object(h.useMemo)((funcct(l.a)(j.flexContainer,j.flexContaiject(h.useState)(!1),2),L=D(h.useCallback)((function(){M(!L)}),[M,L]);return Object(h.useEffect)((function(){I.current&&r(I.current)}),[r]),Object(h.useEffect)((function(){n&&n()}),[n]),f.a.createElement("div",{className:N},f.a.createElement(Z,{draftTitle:o,isReadOnly:t,renameDraftCallback:i,changeRouteCallback:s,actionsProps:a,isCompact:_,draftStrings:c,transformEnabled:p,showTransformPane:L,toggleTransformPaneCallback:R,members:S,logDraftsFeatureCallback:k,fetchPersonPictureDataCallback:E}),t&&f.a.createElement(me,{draftStrings:c}),f.a.createElement("div",{className:A},f.a.createElement("div",{className:P},f.a.createElement("div",{ref:I,className:x})),f.a.createElement(he,{showTransformPane:L,showLatencyLoading:O,draftStrings:c,firstDraftResources:m,toggleTransformPaneCallback:R,handleCopyContentClick:g,handleCreateBlankDocClickWrapper:y,handleCreateWithContentClickWrapper:b,handleSeeAllAppsClick:w,handleCopyAndCreateFallback:C,getAndSetDocumentTypeRecommendations:T})))},ve=n("CU8J"),be=n("J9+k"),ye=n("fv+d"),we=n("cvOW"),Ce=n("NrNW"),Oe=n("ynVX"),Te=n("6ib3"),Se=n("RtYo"),ke=n("rjBA"),Ee=n("lw5l"),_e=n("luPg"),je=n("CaQ9"),Ie=n("gd1C"),Ne=n("h8qh"),Ae=n("MJsD"),Pe=n("QLkI"),xe=n("a3FV"),De=n("vn4N"),Le=n("jwpY"),Me=n("am3b"),Re=n("gB6C"),Fe=n("pdjy"),Be=n("Dn7E"),Ue=function(e){var t=e.eventName,n=e.status,r=e.documentId,o=e.documentType,i=e.subArea,s=e.error,a=e.isCustomContainer;Object(Be.a)({featureName:"Drafts",eventName:t,area:"Drafts",subArea:i,params:{DocumentId:null!=r?r:"",Status:n,Error:null!=s?s:"",IsCustomContainer:a?"True":"False",DocumentType:null!=o?o:"Draft"}})},We=n("KlUR");function qe(e){return e instanceof ArrayBuffer||"object"==typeof e&&null!==e&&"number"==typeof e.byteLength&&"function"==typeof e.slice&&void 0===e.byteOffset&&void 0===e.buffer}class He extends Uint8Array{toString(e){return function(e,t){switch(t){case"base64":return We.fromByteArray(e);case"utf8":case"utf-8":case void 0:return(new TextDecoder).decode(e);default:throw new Error("invalid/unsupported encoding")}}(this,e)}static from(e,t,n){if("string"==typeof e)return He.fromString(e,t);if(null!==e&&"object"==typeof e&&qe(e.buffer))return He.fromArrayBuffer(e.buffer,e.byteOffset,e.byteLength);if(qe(e))return He.fromArrayBuffer(e,t,n);throw new TypeError}static fromArrayBuffer(e,t,n){const r=null!=t?t:0,o=null!=n?n:e.byteLength-r;if(r<0||r>e.byteLength||o<0||o+r>e.byteLength)throw new RangeError;return new He(e,r,o)}static fromString(e,t){switch(t){case"base64":{const t=this.sanitizeBase64(e),n=We.toByteArray(t);return new He(n.buffer)}Encoder).encode(e);return new He(t.buffer)}default:throw new Error("invalid/unsupported encoding")}}static isBuffer(e){throw new Error("unimplemented")}static sanitizeBase64(e){let t=e;return t=t.split("=")[0],t=t.replace(/[^\w+-/]/g,""),t.length%4!=0&&(t+=["","===","==","="][t.length%4]),t}}function ze(e){const t=new URL(e.siteUrl);let n=`s=${encodeURIComponent(t.pathname)}&d=${encodeURIComponent(e.driveId)}&f=${encodeURIComponent(e.itemId)}&c=${encodeURIComponent(e.dataStorePath)}&fluid=1`;return e.appName&&(n+=`&a=${encodeURIComponent(e.appName)}`),e.containerPackageName&&(n+=`&p=${encodeURICleVersion&&(n+=`&v=${encodeURIComponent(e.fileVersion)}`),e.context&&(n+=`&x=${encodeURIComponent(e.context)}`),(e=>He.from(e,"utf8").toString("base64"))(n)}var Ge=n("uIjv");function Ve(e){return n.e(664).then(n.bind(null,"VrTk")).then((t=>new t.SharepointNotificationService({...e,logger:e.logger?new Ge.a("NotificationService",e.logger):void 0})))}var $e,Qe,Je,Xe=n("k9HR"),Ke=n("uAd/"),Ye=n("ef5c"),Ze=n("3tC7"),et=n("FumO"),tt=n("pkel");!ftion(e){e.organization="organization",e.users="users",e.anonymous="anonymous",e.default="default"}(Qe||(Qe={})),function(e){e.view="view",e.edit="edit"}(Je||(Je={}));var nt=n("Ez9J");function rt(e){let t=`${e.siteUrl}?driveId=${encodeURIComponent(e.driveId)}&itemId=${encodeURIComponent(e.itemId)}&path=${encodeURIComponent(e.dataStorePath)}`;return e.containerPackageNa,t}function ot(e){return e.includes("onedrive.com")||e.includes("storage.live.com")||e.includes("storage.live-int.com")||e.includes("onedrive-tst.com")}function it(e){let t="_an("3MpG"),ut=n("60TO");!function(e){e.isSharingLinkToRedeem="isSharingLinkToRedeem"}(st||(st={})),function(e){e.isClpCompliantApp="X-CLP-Compliant-App"}(at||(at={}));var lt=n("AtPS");function dt(e,t,n,r){const o=r?`versions/${r}/`:"";return`${it(new URL(e).origin)}/drives/${t}/items/${n}/${o}`}function ht(e,t,n,r){return`${dt(e,t,n,r)}opStream/snapshots`}function ft(e,t,n,r){return`${dt(e,attachment`}function pt(e,t,n,r){return`${dt(e,t,n,r)}opStream/attachments`}function mt(e,t,n,r){return`${dt(e,t,n,r)}opStream`}class gt{constructor(){}async resolve(e){var t,n,r,o;if(null===(t=e.headers)||void 0===t?void 0:t[et.a.createNew]){const[t,r]=e.url.split("?"),o=new URLSearchParams(r),i=e.headers[et.a.createNew].fileName,s=o.get("driveId"),a=o.get("path"),c=o.get("containerPackageName"),u=o.get("createLinkType");if(!(i&&t&&s&&null!=a))throw new nt.e("Proper new file params should be there!!",tt.a.genericError,{driverVersion:lt.a});let l;return u&&u in $e&&(l={createLink:{type:$e[u]}}),{endpoints:{snapshotStorageUrl:"",attachmentGETStorageUrl:"",attachmentPOSTStorageUrl:"",deltaStorageUrl:""},tokens:{},type:"fluid",odspResolvedUrl:!0,id:"odspCreateNew",url:`fluid-odsp://${t}?${r}&version=null`,siteUrl:t,hashedDocumentId:"",driveId:s,itemId:"",fileName:i,summarizer:!1,codeHint:{containerPackageName:null!=c?c:void 0},fileVersion:void 0,shareLinkInfo:l,isClpCompliantApp:null===(n=e.headers)||void 0===n?void 0:n[at.isClpCompliantApp]}}const{siteUrl:i,driveId:s,itemId:a,path:c,containerPackageName:u,fileVersion:l}=function(e){const[t,n]=e.split("?"),r=new URLSearchParams(n),o=r.get("driveId"),i=r.get("itemId"),s=r.get("path"),a=r.get("containerPackageName"),c=r.get("fileVersion");if(null===o)throw new Error("ODSP URL did not contain a drive id");if(null===i)throw new Error("ODSP Url did not contain an item id");if(null===s)throw new Error("ODSP Url did not contain a path");return{siteUrl:t,driveId:decodeURIComponent(o),itemId:decodeURIComponent(i),path:decodeURIComponent(s),containerPackageName:a?decodeURIComponent(a):void 0,fileVersionect(ut.a)(s,a);Object(Ze.a)(!d.includes("/"),168);let h=`fluid-odsp://placeholder/placeholder/${d}/${function(e){return e.startsWith("/")?e.substr(1):e}(c)}`;if(e.url.length>0){const t=new URL(e.url).search;t&&(h+=t)}const f=!!(null===(r=e.headers)||void 0===r?void 0:r[et.a.summarizingClient]);return{type:"fluid",odspResolvedUrl:!0,endpoints:{snapshotStorageUrl:ht(i,s,a,l),attachmentPOSTStorageUrl:ft(i,s,a,l),attachmentGETStorageUrl:pt(i,s,a,l),deltaStorageUrl:mt(i,s,a,l)},id:d,tokens:{},url:h,hashedDocumentId:d,siteUrl:i,driveId:s,itemId:a,fileName:"",summarizer:f,codeHint:{containerPackageName:u},fileVersion:l,isClpCompliantApp:null===(o=e.headers)||void 0===o?void 0:o[at.isClpCompliantApp]}}async getAbsoluteUrl(e,t,n){var r,o,i,s;let a=t;a.startsWith("/")&&(a=a.substr(1));const c=Object(ct.g)(e);let u;return u=n&&"name"in n?n.name:(e=>"object"==typeof e&&"string"==typeof(null==e?void 0:e.name)&&"object"==typeof(null==e?void 0:e.fluid))(null===(r=n)||void 0===r?void 0:r.package)?null===(o=n)||void 0===o?void 0:o.package.name:null===(i=n)||void 0===i?void 0:i.package,u=null!=u?u:nt.assign(Object.assign({},c),{containerPackageName:u,dataStorePath:a}))}}class v.cleanup=t,this.gcTimeouts=new Map}schedule(e){"indefinite"!==this.expiry.policy&&this.gcTimeouts.set(e,setTimeout((()=>{this.cleanup(e),this.cancel(e)}),this.expiry.durationMs))}cancel(e){const t=this.gcTimeouts.get(e);void 0!==t&&(clearTimeout(t),this.gcTimeouts.delete(e))(e){"sliding"===this.expiry.policy&&(this.cancel(e),this.schedule(e))}}class bt{constructor(){let{expiry:e={policy:"innError:t=(()=>!0)}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.cache=new Map,this.re}has(e){return this.cache.has(e)}get(e){return this.has(e)&&this.gc.update(e),this.cache.get(e)}remove(e)(e)}async addOrGet(e,t){let n=this.get(e);return void 0===n&&(n=(async()=>t())(),this.ct(e,n),n.catch((t=>{this.removeOnError(t)&&this.remove(e)})),this.gc.schedule(e)),n}add(e,t){const n);return this.addOrGet(e,t).catch((()=>{})),!n}async addValueOrGet(e,t){return this.addOrGet(e,(async()=>t))}addValue(e,t){return this.add(e,(async()=>t))}}var yt=n("ZaV9"),wt=n("eQkK");function Ct(e,t,n){if(!t||0===t.length)return{url:e,headers:{}};if(!n){const n=new URL(e);if(n.searchParams{headers:{},url:n.href}}return{headers:=>setTimeout((()=>t()),e)));var St=n("hPT0"),kt=n("A3AF");class Et{constructor(){this.completed=!1,this.p=new Promise(((e,t)=>{this.res=e,this.rej=t}))}get isCompleted(){return this.completed}get promise(){return this.p}resolve(e){void 0!==this.res&&(this.completed=!0,this.res(e))}reject(e){void 0!==this.rej&&(this.completed=!0,this.rej(e))}}Symbol;class _t{construlease=()=>{const e=this.tasks.shift();if(void 0!==e)return ebject(Ze.a)(e>0,174)}get waitQueueLength(){return this.tasks.length}async acquire(){if(!(this.maxRequests>0))return new Promise((e=>{this.tasks.push(e)}));this.maxRequests--}async schedule(e){return await this.acquire(),e().finally(this.release)}}var jt=n("Z4SR"),It=n("V678"),Nt=n("tEMn"),At=n("rUkc");const Pt=1728e5;class xt extends class{constructor(e,t,n,r){this.cache=e,this.fileEntry=t,this.logger=n,this.clientIsSummarizer=r,this.driverId=Object(kt.a)(),this.networkCallNumber=1,this.rateLimiter=new _t(24),this.snapshotCacheExpiryTimeoutMs=Object(It.c)(n).config.getBoolean("Fluid.Driver.Odsp.TestOverride.DisableSnapshotCache")?0:Pt}setEpoch(e,t,n){Object(Ze.a)(void 0===this._fluidEpoch,475),this._fluidEpoch=e,this.logger.sendTelemetryEvent({eventName:"EpochLearnedFirstTime",epoch:e,fetchType:n,fromCache:t})}async get(e){var t;try{const n=await this.cache.get(this.fileEntryFromEntry(e));if(void 0===n||3!==n.version)return;if(Object(Ze.a)(void 0!==n.fluidEpoch,476),void 0===this._fluidEpoch)this.setEpoch(n.fluidEpoch,!0,"cache");else if(this._fluidEpoch!==n.fluidEpoch)return;if(e.type===jt.a){const e=null===(t=n.value)||void 0===t?void 0:t.cacheEntryTime,r=Date.now();if(void 0===e||r-e>=this.snapshotCacheExpiryTimeoutMs)return this.logger.sendTelemetryEvent({eventName:"odspVersionsCacheExpired",duration:r-e,maxCacheAgeMs:this.snapshotCacheExpiryTimeoutMs}),void await this.removeEntries()}return n.value}catch(t){return void this.logger.sendErrorEvent({eventName:"cacheFetchError",type:e.type},t)}}async put(e,t){var n;Object(Ze.a)(void 0!==this._fluidEpoch,477),e.type===jt.a&&(t.cacheEntryTime=null!==(n=t.cacheEntryTime)&&void 0!==n?n:Date.now());const r={value:t,version:3,fluidEpoch:this._fluidEpoch};return this.cache.put(this.fileEntryFromEntry(e),r).catch((t=>{throw this.logger.sendErrorEvent({eventName:"cachePutError",type:e.type},t),t}))}async removeEntries(){try{return await this.cache.removeEntries(this.fileEntry)}catch(e){this.logger.sendErrorEvent({eventName:"removeCacheEntries"},e)}}get fluidEpoch(){return this._fluidEpoch}async validateEpochFromPush(e){const t=e.epoch;Object(Ze.a)(void 0!==t,157);try{this.validateEpochFromResponse(t,"push")}catch(e){throw await this.checkForEpochError(e,t,"push"),e}}async fetchAndParseAsJSON(e,t,n){return this.fetchCore(e,t,ct.d,n,arguments.length>3&&void 0!==arguments[3]&&arguments[3],arguments.length>4?arguments[4]:void 0)}async fetch(e,t,n){return this.fetchCore(e,t,ct.f,n,arguments.length>3&&void 0!==arguments[3]&&arguments[3],arguments.length>4?arguments[4]:void 0)}async fetchCore(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const i=this.formatClientCorrelationId(arguments.length>5?arguments[5]:void 0);let s;return this.addEpochInRequest(t,o,i),this.rateLimiter.schedule((async()=>n(e,t))).then((e=>(s=e.headers.get("x-fluid-epoch"),this.validateEpochFromResponse(s,r),e.propsToLog.XRequestStatsHeader=i,e))).catch((async e=>{throw void 0===s&&(s=e.serverEpoch),await this.checkForEpochError(e,s,r),e})).catch((e=>{if(Object(Nt.b)(e)&&e.errorType===tt.a.fileNotFoundOrAccessDeniedError){const t=e.redirectLocation;if(void 0!==t){const n=function(e,t){const n=Object.assign({},Object(ct.g)(e)),r=`${new URL(t).origin}${new URL(n.siteUrl).pathname}`;return n.siteUrl=r,n}(this.fileEntry.resolvedUrl,t),r=new nt.c(e.message,n,{driverVersion:lt.a,redirectLocation:t});throw r.addTelemetryProperties(e.getTelemetryProperties()),r}}throw e})).catch((e=>{throw Object(At.h)(e,{props:{XRequestStatsHeader:i}})}))}async fetchArray(e,t,n){return this.fetchCore(e,t,ct.e,n,arguments.length>3&&void 0!==arguments[3]&&arguments[3],arguments.length>4?arguments[4]:void 0)}addEpochInRequest(e,t,n){const r=Object(ct.g)(this.fileEntry.resolvedUrl).isClpCompliantApp;if(t){const t={};t["X-RequestStats"]=n,void 0!==this.fluidEpoch&&(t["x-fluid-epoch"]=this.fluidEpoch),r&&(t[at.isClpCompliantApp]=r.toString()),this.addParamInBody(e,t)}else{const t=(t,n)=>{e.headers=Object.assign({},e.headers),Object(Ze.a)(void 0!==e.headers,642),e.headers[t]=n};t("X-RequestStats",n),void 0!==this.fluidEpoch&&t("x-fluid-epoch",this.fluidEpoch),r&&t(at.isClpCompliantApp,r.toString())}}addParamInBody(e,t){const n=e.body;Object(Ze.a)("string"==typeof n,541);const r=n.split("\r\n"),o=r.shift();Object(Ze.a)(!0===(null==o?void 0:o.startsWith("--")),542);const i=[o];Object.entries(t).forEach((e=>{let[t,n]=e;i.push(`${t}: ${n}`)})),r.forEach((e=>{i.push(e)})),e.body=i.join("\r\n")}formatClientCorrelationId(e){const t=[`driverId=${this.driverId}`,"RequestNumber="+this.networkCallNumber++,`driverVersion=${lt.a}`,`isSummarizer=${this.clientIsSummarizer}`];return void 0!==e&&t.push(`fetchReason=${e}`),t.join(", ")}validateEpochFromResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=this.checkForEpochErrorCore(e);if(void 0!==r)throw r;void 0!==e&&void 0===this._fluidEpoch&&this.setEpoch(e,n,t)}async checkForEpochError(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(Object(Nt.b)(e)&&e.errorType===tt.a.fileOverwrittenInStorage){const o=this.checkForEpochErrorCore(t);if(void 0!==o)throw o.addTelemetryProperties({fromCache:r,clientEpoch:this.fluidEpoch,fetchType:n}),this.logger.sendErrorEvent({eventName:"fileOverwrittenInStorage"},o),await this.removeEntries(),o;throw new nt.h(`Coherency 409: ${e.message}`,1,{Odsp409Error:!0,driverVersion:lt.a})}}checkForEpochErrorCore(e){if(this.fluidEpoch&&e&&this.fluidEpoch!==e)return new nt.e("Epoch mismatch",tt.a.fileOverwrittenInStorage,{driverVersion:lt.a})}fileEntryFromEntry(e){return Object.assign(Object.assign({},e),{file:this.fileEntry})}}{constructor(){super(...arguments),this.treesLatestDeferral=new Et}validateEpochFromResponse(e,t){super.validateEpochFromResponse(e,t,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.treesr.get(e);return e.type===jt.a&&(t=t.then((e=>(void 0!==e&&this.treesLatestDeferral.resolve(),e))).catch((e=>{throw this.treesLatestDeferral.reject(e),e}))),t}async fetchAndParseAsJSON(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4?arguments[4]:void 0;const i=this.treesLatestDeferral.isCompleted;try{return await super.fetchAndParseAsJSON(e,t,n,r,o)}catch(e){if("treesLatest"===n&&this.treesLatestDeferral.reject(e),"joinSession"!==n||e.statusCode<401||e.statusCorow e}return await wt.c.timedExecAsync(this.logger,{eventName:"JoinSessionSyncWait"},(async e=>{let t;const n=new Promise((e=>{t=setTimeout((()=>{e(51)}),15e3)}));51===await Promise.race([n,this.treesLatestDeferral.promise.finally((()=>clearTimeout(t)))])&&e.cancel()}),{start:!0,end:!0,cancel:"generic"}),super.fetchAndParseAsJSON(e,t,n,r)}}function Dt(e,t,n,r,o){const i=new xt(e,n,r,o);return{cache:Object.assign(Object.assign({},t),{persistedCache:i}),epochTracker:i}}async function Lt(e,t,n,r){var o;let i=1e3;const s=Ot.a.now();let a;for(let c=1;;c++){void 0!==r&&r();try{const r=await e();return c>1&&n.sendTelemetryEvent({eventName:"MultipleRetries",callName:t,attempts:c,duration:Ot.a.now()-s},a),r}catch(e){const r=Object(nt.i)(e),u=!0===(null==e?void 0:e.Odsp409Error),l=(null==e?void 0:e.errorType)===St.a.serviceReadOnly;if(!u&&!l||!r)throw e;if(5===c)throw n.sendErrorEvent({eventName:u?"CoherencyErrorTooManyRetries":"ServiceReadonlyErrorTooManyRetries",callName:t,attempts:c,duration:Ot.a.now()-s},e),e.canRetry=!1,e;i=null!==(o=Object(nt.k)(e))&&void 0!==o?o:i,await Tt(Math.floor(i)),i+=i/4*(1+Math.random()),a=e}}}const Mt=new Map;class Rt{constructor(e,t,n,r){this.appName=n,this.getContext=r,this.sharingLinkCache=new bt,this.logger=Object(ct.c)(t),e&&(this.shareLinkFetcherProps=Object.assign(Object.assign({},e),{tokenFetcher:e.tokenFetcher}))}appendDataStorePath(e,t){const n=Object(yt.b)(e);if(!n)return;const r=new URL(n.dataStorePath,`${e.protocol}//${e.hostname}`);return t.startsWith("/?")||t.startsWith("?")?(new URLSearchParams(t).forEach(((e,t)=>{r.searchParams.append(t,e)})),n.dataStorePath=`${r.pathname}${r.search}`):n.dataStorePath=`${r.pathname}${r.pathname.endsWith("/")||t.startsWith("/")?"":"/"}${t}/${r.search}`,Object(yt.d)(e,n),e.href}getKey(e){return`${e.siteUrl},${e.driveId},${e.itemId}`}async resolve(e){var t,n;const r={headers:e.headers,url:e.url},o=null===(t=r.headers)||void 0===t?void 0:t[st.isSharingLinkToRedeem];try{const t=new URL(e.url),n=Object(yt.b)(t);n&&(r.url=rt(n))}catch(e){}const i=await(new gt).resolve(r);return o&&(i.shareLinkInfo=Object.assign(null!==(n=i.shareLinkInfo)&&void 0!==n?n:{},{sharingLinkToRedeem:this.removeNavParam(e.url)})),i.itemId&&this.getShareLinkPromise(i).catch((()=>{})),i}removeNavParam(e){const t=new URL(e),n=new URLSearchParams(t.search);return n.delete(yt.c),t.search=n.toString(),t.href}async getShareLinkPromise(e){if(void 0===this.shareLinkFetcherProps)throw new Error("Failed to get share link because share link fetcher props are missing");if(!(e.siteUrl&&e.driveId&&e.itemId))throw new Error("Failed to get share link because necessary information is missing (e.g. siteUrl, driveId or itemId)");const t=this.getKey(e),n=this.sharingLinkCache.get(t);if(n)return n;const r=async function(e,t,n){const r=`${t.siteUrl}_${t.driveId}_${t.itemId}`,o=Mt.get(r);if(void 0!==o)return o;const i=async function(){let o;try{o=await Lt((async()=>async function(e,t,n){const r=await async function(e,t,n,r){return wt.c.timedExecAsync(n,{eventName:"odspFileLink",requestName:"getFileItemLite"},(async r=>{let o,i=0;const s=await Object(ct.i)((async r=>{i++;const{siteUrl:s,driveId:a,itemId:c}=t,u=Object(ct.l)(n,t,e,!0),l=await u(r,"GetFileItemLite");Object(Ze.a)(null!==l,700);const{url:d,headers:h}=Ct(`${s}/_api/v2.0/drive"GET",headers:h},p=await Object(ct.f)(d,f);o=p.propsToLog;const m=await p.content.json();if(!(e=>"string"==typeof e.webUrl&&"string"==typeof e.webDavUrl)(m))throw new nt.e("Malformed getFileItemLite response",tt.a.incorrectServerResponse,{driverVersion:lt.a});return m}));return r.end(Object.assign(Object.assign({},o),{attempts:i})),s}))}(e,t,n);return wt.c.timedExecAsync(n,{eventName:"odspFileLink",requestName:"getSharingInformation"},(async o=>{let i,s=0;const a=await Object(ct.i)((async o=>{var a;s++;const c=Object(ct.l)(n,t,e,!0),u=await c(o,"GetFileLinkCore");Object(Ze.a)(null!==u,699);const{url:l,headers:d}=Ct(`${t.siteUrl}/_api/web/GetFileByUrl(@a1)/ListItemAllFields/GetSharingInformation?@a1=${encodeURIComponent(`'${r.webDavUrl}'`)}`,u,!0),h={method:"POST",headers:Object.assign({"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose"},d)},f=await Object(ct.f)(l,h);i=f.propsToLog;const p=await f.content.json(),m=null===(a=null==p?void 0:p.d)||void 0===a?void 0:a.directUrl;if("string"!=typeof m)throw new nt.e("Malformed GetSharingInformation response",tt.a.incorrectServerResponse,{driverVersion:lt.a});return m}));return o.end(Object.assign(Object.assign({},i),{attempts:s})),a}))}(e,t,n)),"getFileLinkCore",n)}catch(e){throw Object(nt.i)(e)||Mt.delete(r),e}return Object(Ze.a)(void 0!==o,658),o}();return Mt.set(r,i),i}(this.shareLinkFetcherProps.tokenFetcher,e,this.logger).catch((e=>{throw this.logger.sendErrorEvent({eventName:"FluidFileUrlError"},e),this.sharingLinkCache.remove(t),e}));return this.sharingLinkCache.add(t,(async()=>r)),r}async getAbsoluteUrl(e,t,n){var r,o,i,s,a;const c=Object(ct.g)(e),u=await this.getShareLinkPromise(c),l=new URL(u);let d;d=n&&"name"in n?n.name:(e=>"object"==typeof e&&"string"==typeof(null==e?void 0:e.name)&&"object"==typeof(null==e?void 0:e.fluid))(null===(r=n)||void 0===r?void 0:r.package)?null===(o=n)||void 0===o?void 0:o.package.name:null===(i=n)||void 0===i?void 0:i.package,d=null!=d?d:null===(s=c.codeHint)||void 0===s?void 0:s.containerPackageName;const h=await(null===(a=this.getContext)||void 0===a?void 0:a.call(this,c,t));return Object(yt.d)(l,{siteUrl:c.siteUrl,driveId:c.driveId,itemId:c.itemId,dataStorePath:t,appName:this.appNion,context:h}),l.href}static createDocumentUrl(e,t){const n=new URL(e);return Object(yt.d)(n,t),n.href}static createNavParam(e){return Object(yt.a)(e)}}var Ft=n("OhPl"),Bt=n("ms7G"),Ut=n("zuGz"),Wt=n("dP86"),qt=n("B43N"),Ht=n("ECCN"),zt=n("6vom"),Gt=n("hKA3"),Vt=n("xg6W"),$t=n("OSNm"),Qt=n("ccbu");function Jt(e){var t;const n=null===(t=navigator)||void 0===t?void 0:t.connection;Object($t.b)(e,{eventName:"Metadata",subCategory:"browserMetadata",doNotTrack:navigator.doNotTrack?navigator.doNotTrack:"false",documentHidden:document.hidden,networkType:null==n?void 0:n.effectiveType,networkRoundTripTime:null==n?void 0:n.rtt,cpuCoreCount:navigator.hardwareConcurrency,isMobile:Object(Qt.b)(),timeStamp:Date.now()})}var Xt,Kt=n("rwSX"),Yt=n("Xq91");!function(e){e.Detached="Detached",e.Attaching="Attaching",e.Attached="Attached"}(Xt||(Xt={}));var Zt=n("D317"),en=n("aWgL");const tn=(e,t,n)=>{Object(Zt.b)(6e4,[n]).then((n=>{if(n&&!e.closed){const e="ContainerConnectedTimeout";t&&Object(en.a)(t,"ContainerPostBootError","PostBoot","ContainerConnectFailed",e,{},{message:"Timed out while connecting the container",errorType:e})}})).catch((()=>{}))},nn=(e,t)=>{var n;let r={};const o=e.resolvedUrl;o&&"id"in o&&(r.docId=o.id),null===(n=t.PersistedProperties)||void 0===n||n.addPersistedProperties(r)},rn=(e,t)=>{const n=new Vt.a;e.attachState!==Xt.Attached?e.once("attached",(()=>{nn(e,t),tn(e,t,n)})):(nn(e,t),tn(e,t,n)),e.once("closed",(e=>{e&&t&&Object(en.a)(t,"ContainerPostBootError","PostBoot","PostBootContainerClosed",e.errorType,{},e)})),e.once("connected",(()=>{n.resolve()}))};var on=n("YY01");class sn{constructor(e,t,n){this.perfMetadata=t,this.documentHiddenTrackerId=n,this.runtimeLogger=new Ut.a("FluidRuntime",e)}sendWithNamespace(e,t){this.runtimeLogger.sendWithNamespace(e,t)}send(e){let t=e;if("performance"===e.category){const n=e.duration,r=Date.now();t={...this.perfMetadata,startTime:"number"==typeof n?r-n:void 0,documentEverHidden:this.documentHiddenTrackerId&&Object(Wt.a)(this.documentHiddenTrackerId)>-1,...t}}void 0===t.opMessageAgeMs&&"number"==typeof t.messageTimestamp&&(t={opMessageAgeMs:Date.now()-t.messageTimestamp,...t}),t.message&&(t.message=Object(on.b)(t.message.toString())),t.stack&&(t.stack=Object(on.b)(t.stack.toString())),t.error&&(t.error=Object(on.b)(t.error.toString())),this.runtimeLogger.send(t)}}function an(e){e.closed||e.attachState!==Xt.Attached&&void 0!==e.attachState||e.connect()}var cn,un=n("LVqF");async function ln(e,t,n,r,o,i,s){var a,c;const u=Ke.a.start("LoadComponentFromContainer",r,{addUserTiming:!0,isAPerformanceMetric:!0}),l=Object(Wt.b)();let d;try{d=await async function(e,t,n,r,o){const i=Ke.a.start("RequestComponent",r,{addUserTiming:!0});let s;if(o){const r={...null==n?void 0:n.headers,wait:!1,externalRequest:!1};if(s=n?await t.request({url:n.url,headers:{headersWithoutWait:r}}):await e.request({url:"/",headers:{headersWithoutWait:r}}),404===s.status){an(e);const r={...null==n?void 0:n.headers,externalRequest:!1};s=n?await t.request({url:n.url,headers:{headersWithWait:r}}):await e.request({url:"/",headers:{headersWithWait:r}})}}else{const r={...null==n?void 0:n.headers,externalRequest:!1};s=n?await t.request({url:n.url,headers:{headersWithWait:r}}):await e.request({url:"/",headers:{headersWithWait:r}})}if(200!==s.status||"fluid/component"!==s.mimeType&&"fluid/object"!==s.mimeType||!s.value){const e=new un.a(`Component not found: status=${s.status}, value=${s.value}`,void 0,s.status,s.stack);throw i.setResult(!1,{externalRequest:!1,mimeType:s.mimeType},e),e}const a=s.value;return i.setResult(!0),a}(e,t,n,r,s)}catch(e){return function(e){Object(Wt.c)(l),u.setResult(!1,void 0,e)}(e),Promise.reject(e)}const h=await(null===(a=d.ComponentCanvasProvider)||void 0===a?void 0:a.getCanvasComponent())||d,f=d.ComponentMetadata||h.ComponentMetadata,p=await(null==f?void 0:f.packageName),m=null===(c=d.IFluidLoadable)||void 0===c?void 0:c.handle.absolut!0),v=Object(Wt.a)(i);return u.setResult(!0,{...o,componentType:p,componentUrl:m,documentEverHidden:v>-1,documentHidden:g>-1}),s&&function(e,t,n){an(e)}(e),d}!function(e){e.cache="fluid-cache",e.clientDetails="fluid-client-details",e.loadMode="loadMode",e.reconnect="fluid-reconnect",e.sequenceNumber="fluid-sequence-number",e.version="version"}(cn||(cn={}));var dn=n("ywi1"),hn=n("Gstq");class fn extends wt.e{constructor(e,t,n){super(void 0,n),this.debug=e,this.debugErr=t}static create(e,t){const n=Object(hn.debug)(e),r=Object(hn.debug)(e);return r.log=console.error.bind(console),r.enabled=!0,new fn(n,r,t)}static mixinDebugLogger(e,t,n){if(!t)return fn.create(e,er(fn.create(e,this.tryGetBaseLoggerProps(t))),r.addLogger(wt.a.create(t,e)),r}static tryGetBaseLoggerProps(e){if(e instanceof wt.e)return e.properties}send(e){const t=this.prepareEvent(e),n="error"===t.category;let r=n?this.debugErr:this.debug;const o=e.eventName.lastIndexOf(wt.e.eventNamespaceSeparator),i=e.eventName.substring(o+1);o>0&&(r=r.extend(e.eventName.substring(0,o))),t.eventName=void 0;let s="";s=`tick=${wt.e.formatTick(dn.a.now())}`;const a=t.stack?t.stack:"";let c;t.stack=void 0;try{c=JSON.stringify(t)}catch(e){t.error=void 0,c=JSON.stringify(t)}"{}"===c&&(c=""),n&&(r.enabled=!0),r(`${i} ${c} ${s} ${a}`)}}const pn=e=>"fluid"===(null==e?void 0:e.type);function mn(e){if(!pn(e))throw new Error(`resolved is not a Fluid url. Type: ${null==e?void 0:e.type}`)}class gn{constructor(e){this.urlResolvers=e}static create(e){return Array.isArray(e)?1===e.length?e[0]:new gn(e):e}async resolve(e){return async function(e,t){let n;for(const r of e)if(n=await r.resolve(Object.assign({},t)),void 0!==n)return n}(this.urlResolvers,e)}async getAbsoluteUrl(e,t){thnstructor(e){this.protocolName="none:",this.protocolToDocumentFactoryMap=new Map,e.forEach((e=>{this.protocolToDocumentFactoryMap.set(e.protocolName,e)}))}static create(e){if(Array.isArray(e)){const t=[];return e.forEach((e=>{void 0!==e.protocolToDocumentFactoryMap?t.push(...e.protocolToDocumentFactoryMap.values()):t.push(e)})),1===t.length?t[0]:new bn(t)}return e}async createDocumentService(e,t,n){mn(e);const r=Object(vn.parse)(e.url);if(null==r.protocol)throw new Error("No protocol provided");const o=this.protocolToDocumentFactoryMap.get(r.protocol);if(void 0===o)throw new Error("Unknown Fluid protocol");return o.createDocumentService(e,t,n)}async createContainer(e,t,n,r){mn(t);const o=Object(vn.parse)(t.url);if(null==o.protocol)throw new Error("No protocol provided");const i=this.protocolToDocumentFactoryMap.get(o.protocol);if(void 0===i)throw new Error("Unknown Fluid protocol");return i.createContainer(e,t,n,r)}}var yn=n("HVn3"),wn=n.n(yn);function Cn(e,t){if(!e)throw new Error("number"==typeof t?`0x${t.toString(16).padStart(3,"0")}`:ror="dataCorruptionError",e.dataProcessingError="dataProcessingError",e.usageError="usageError",e.clientSessionExpiredError="clientSessionExpiredError"}(Sn||(Sn={}));class kn extends At.a{constructor(e,t,n){super(e,n,new Set(["error"])),this.error=t,this.errorType=Sn.genericError}}class En extends At.a{constructor(e,t,n){super(e,n),this.retryAfterSeconds=t,this.errorType=Sn.throttlingError}static wrap(e,t,n){return Object(At.j)(e,(e=>new En(e,t)),n)}}class _n extends At.a{constructor(e){super(e,{usageError:!0}),this.errorType="usageError"}}class jn extends At.a{constructor(e,t){super(e,Object.assign(Object.assign({},t),{dataProcessingError:1})),this.errorType=Sn.dataCorruptionError,this.canRetry=!1}}class In extends At.a{constructor(e){super(e),this.errorType=Sn.dataProcessingError,this.canRetry=!1}static create(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const o=In.wrapIfUnrecognized(e,t,n);return o.addTelemetryProperties(r),o}static wrapIfUnrecognized(e,t,n){const r=Object.assign({dataProcessingError:1,dataProcessingCodepath:t},void 0===n?void 0:Nn(n)),o=Object(At.h)(e,{props:r});if(ObjeuenceNumber,messageReferenceSequenceNumber:e.referenceSequenceNumber,messageMinimumSequenceNumber:e.minimumSequenceNumber,messageTimestamp:e.timestamp});var An;function Pn(e,t){return{type:An.Tree,tree:{".protocol":t,".app":e}}}!function(e){e.Tree=1,e.Blob=2,e.Handle=3,e.Attachment=4}(An||(An={}));const xn=async e=>new Promise((t=>setTimeout((()=>t()),e)));var Dn,Ln;function Mn(){return"object"==typeof navigator&&null!==navigator&&"boolean"==typeof navigator.onLine?navigator.onLine?Ln.Online:Ln.Offline:Ln.Unknown}!function(e){e[e.Offline=0]="Offline",e[e.Online=1]="Online",e[e.Unknown=2]="Unknown"}(Ln||(Ln={}));class Rn extends At.a{constructor(e,t,n){super(e,n),this.canRetry=t,this.errorType=tt.a.genericNetworkError}}class Fn extends At.a{constructor(e,t){super(e,Object.assign(Object.assign({},t),{statusCode:400})),this.errorType=Fn.errorType,this.canRetry=!1}}Fn.errorType=null!==(Dn=tt.a.deltaStreamConnectionForbidden)&&void 0!==Dn?Dn:"deltaStreamConnectionForbidden";class Bn extends At.a{constructor(e,t,n,r){super(e,r),this.errorType=t,this.canRetry=n}}class Un extends Bn{constructor(e,t,n){super(e,t,!1,n),this.errorType=t}}class Wn extends At.a{constructor(e,t,n){super(e,n),this.retryAfterSeconds=t,this.errorType=tt.a.throttlingError,this.canRetry=!0}}const qn=e=>!0===(null==e?void 0:e.canRetry),Hn=e=>void 0!==(null==e?void 0:e.retryAfterSeconds)?1e3*e.retryAfterSeconds:void 0;async function zn(e,t,n,r){var o,i;let s,a=!1,c=1e3,u=0;const l=On.now();let d;do{try{s=await e(r.cancel),a=!0}catch(e){if(!qn(e))throw n.sendTelemetryEvent({eventName:`${t}_cancel`,retry:u,duration:On.now()-l,fetchCallName:t},e),e;if(!0===(null===(o=r.cancel)||void 0===o?void 0:o.aborted))throw n.sendTelemetryEvent({eventName:`${t}_runWithRetryAborted`,retry:u,duration:On.now()-l,fetchCallName:t},e),new Un("runWithRetry was Aborted",tt.a.genericError,{driverVersion:"2.0.0-internal.1.4.6",fetchCallName:t});u++,d=e,c=null!==(i=Hn(e))&&void 0!==i?i:Math.min(2*c,8e3),r.onRetry&&r.onRetry(c,e),await xn(c)}}while(!a);return u>0&&n.sendTelemetryEvent({eventName:`${t}_lastError`,retry:u,duration:On.now()-l,fetchCallName:t},d),s}const Gn=(e,t)=>$n.from(e,t).buffer;function Vn(e){return e instanceof ArrayBuffer||"object"==typeof e&&null!==e&&"number"==typeof e.byteLength&&"function"==typeof e.slice&&void 0===e.byteOffset&&void 0===e.buffer}class $n extends Uint8Array{toString(e){return function(e,t){switch(t){case"base64":return We.fromByteArray(e);case"utf8":case"utf-8":case void 0:return(new TextDecoder).decode(e);default:throw new Error("invalid/unsupported encoding")}}(this,e)}static from(e,t,n){if("string"==typeof e)return $n.fromString(e,t);if(null!==e&&"object"==typeof e&&Vn(e.buffer))return Cn(0===e.byteOffset,0),Cn(e.byteLength===e.buffer.byteLength,1),$n.fromArrayBuffer(e.buffer,t,n);if(Vn(e))return $n.fromArrayBuffer(e,t,n);throw new TypeError}static fromArrayBuffer(e,t,n){const r=null!=t?t:0,o=null!=n?n:e.byteLength-r;if(r<0||r>e.byteLength||o<0||o+r>e.byteLength)throw new RangeError;return new $n(e,r,o)}static fromString(e,t){switch(t){case"base64":{const t=this.sanitizeBase64(e),n=We.toByteArray(t);return new $n(n.buffer)}case"utf8":case"utf-8":case void 0:{const t=(new TextEncoder).encode(e);return new $n(t.buffer)}default:throw new Error("invalid/unsupported encoding")}}static isBuffer(e){throw new Error("unimplemented")}static sanitizeBase60],t=t.replace(/[^\w+-/]/g,""),t.length%4!=0&&(t+=["","===","==","="][t.length%4]),t}}async function Qn(e,t){const n=((e,t)=>$n.from(e).toString("utf8"))(await e.readBlob(t));return JSON.parse(n)}var Jn,Xn,Kn;!function(e){e.NoOp="noop",e.ClientJoin="join",e.ClientLeave="leave",e.Propose="propose",e.Reject="reject",e.Accept="accept",e.Summarize="summarize",e.SummaryAck="summaryAck",e.SummaryNack="summaryNack",e.Operation="op",e.RemoteHelp="remoteHelp",e.NoClient="noClient",e.RoundTrip="tripComplete",e.Control="control"}(Jn||(Jn={})),function(e){e.ClientJoin="join",e.ClientLeave="leave"}(Xn||(Xn={})),function(e){e.ThrottlingError="ThrottlingError",e.InvalidScopeError="InvalidScopeError",e.BadRequestError="BadRequestError",e.LimitExceededError="LimitExceededError"}(Kn||(Kn={}));const Yn="connected",Zn="disconnected";var er,tr=n("hBZP");class nr extends tr.EventEmitter{constructor(){super(),this.addListener=super.addListener.bind(this),this.on=super.on.bind(this),this.once=super.once.bind(this),this.prependListener=super.prependListener.bind(this),this.prependOnceListener=super.prependOnceListener.bind(this),this.removeListener=super.removeListener.bind(this),this.off=super.off.bind(this)}}class rr extends nr{constructor(e){super(),this.errorHandler=e}emit(e){try{for(var t=arguments.length,n=neweturn tter{constructor(){super(...arguments),this.members=new Map}on(e,t){return super.on(e,t)}addMember(e,t){this.members.set(e,t),this.emit("addMember",e,t)}removeMember(e){const t=this.members.get(e);return void 0!==t&&(this.members.delete(e),this.emit("removeMember",e,t),!0)}getMembers(){return new Map(this.members)}getMember(e){return this.members.get(e)}clear(){const e=this.members.keys();for(const t of e)this.removeMember(t)}}class ir{constructor(e){this.execute=e}get[Symbol.toStringTag](){return this.getPromise()[Symbol.toStringTag]}async then(e,t){return this.getPromise().then(...arguments)}async catch(e){return this.getPromise().catch(...arguments)}async finally(e){return this.getPromise().finally(...arguments)}async getPromise(){return void 0===this.result&&(this.result=this.execute()),this.result}}class sr{constructor(e,t,n,r,o,i,s,a,c,u,l,d,h,f,p,m,g){this.container=e,this.scope=t,this.codeLoader=n,this._codeDetails=r,this._baseSnapshot=o,this.deltaManager=i,this.loader=a,this.submitFn=c,this.submitSummaryFn=u,this.submitBatchFn=l,this.submitSignalFn=d,this.closeFn=h,this.version=f,this.updateDirtyContainerState=p,this.existing=m,thiosed=!1,this._connected=this.container.connected,this._quorum=s,this.taggedLogger=e.subLogger,this._fluidModuleP=new ir((async()=>this.loadCodeModule(r))),this.attachListener()}static async createOrLoad(e,t,n,r,o,i,s,a,c,u,l,d,h,f,p,m,g){const v=new sr(e,t,n,r,o,i,s,a,c,u,l,d,h,f,p,m,g);return await v.instantiateRuntime(m),v}get clientId(){return this.container.clientId}get id(d:""}get clientDetails(){return this.container.clientDetails}get connected(){return this._connected}get canSummarize(){return"summarize"in this.runtime}get serviceConfiguration(){return this.container.serviceConfiguration}get audience(){return this.container.audience}get options(){return this.container.options}get baseSnapshot(){return this._baseSnapshot}get storage(){return this.container.storage}get runtime(){if(void 0===this._runtime)throw new Error("Attempted to access runtime before it was defined");return this._runtime}get disposed(){return this._disposed}get codeDetails(){return this._codeDetails}get quorum(){return this._quorum}getSpecifiedCodeDetails(){var e;return null!==(e=this._quorum.get("code"))&&void 0!==e?e:this._quorum.get("code2")}dispose(e){this._disposed||(this._disposed=!0,this.runtime.dispose(e),this._quorum.dispose(),this.deltaManager.dispose())}getLoadedFromVersion(){return this.container.loadedFromVersion}get attachState(){return this.container.atme.createSummary(e)}setConnectionState(e,t){const n=this.runtime;this._connected=e,n.setConnectionState(e,t)}process(e,t,n){this.runtime.process(e,t,n)}processSignal(e,t){this.runtime.processSignal(e,t)}async request(e){return this.runtime.request(e)}async getAbsoluteUrl(e){return this.container.getAbsoluteUrl(e)}getPendingLocalState(){return this.runtime.getPendingLocalState()}async satisfies(e){var t;const n=[],r=this.codeLoader;void 0!==r.IFluidCodeDetailsComparer&&n.push(r.IFluidCodeDetailsComparer);const o=await this._fluidModuleP,i=null===(t=o.module)||void 0===t?void 0:t.fluidExport;if(void 0!==(null==i?void 0:i.IFluidCodeDetailsComparer)&&n.push(i.IFluidCodeDetailsComparer),0===n.length)return!1;for(const t of n)if(!1===await t.satisfies(o.details,e))return!1;return!0}notifyAttaching(e){var t,n;this._baseSnapshot=e,null===(n=(t=this.runtime).notifyAttaching)||void 0===n||n.call(t,e),this.runtime.setAttachState(Xt.Attaching)}async getRuntimeFactory(){var e;const t=null===(e=(await this._fluidModuleP).module)||void 0===e?void 0:e.fluidExport,n=null==t?void 0:t.IRuntimeFactory;if(void 0===n)throw new Error("Code package does not implement IRuntimeFactory");return n}async instanctory();this._runtime=await t.instantiateRuntime(this,e)}attachListener(){this.container.once("attached",(()=>{this.runtime.setAttachState(Xt.Attached)}))}async loadCodeModule(e){const t=await wt.c.timedExecAsync(this.taggedLogger,{eventName:"CodeLoad"},(async()=>this.codeLoader.load(e)));if("module"in t){const{module:n,details:r}=t;return{module:n,details:null!=r?r:e}}return this.taggedLogger.sendTelemetryEvent({eventName:"LegacyCodeLoader"}),t}}!function(e){e.Never="Never",e.Disabled="Disabled",e.Enabled="Enabled"}(er||(er={}));var ar,cr,ur=n("vqXW"),lr=n.n(ur);class dr extends tr.EventEmitter{constructor(){super(),this.addListener=super.addListener.bind(this),this.on=super.on.bind(this),this.once=super.once.bind(this),this.prependListener=super.prependListener.bindOnceListener.bind(this),this.removeListener=super.removeListener.bind(this),this.off=super.off.bind(this)}}function hr(e){return e.type===Jn.Operation}!function(e){e.FluidDataStoreOp="component",e.Attach="attach",e.ChunkedOp="chunkedOp",e.BlobAttach="blobAttach",e.Rejoin="rejoin",e.Alias="alias",e.Operation="op"}(ar||(ar={})),function(e){e.Accept="accept"}(cr||(cr={}));var fr=n("3YFW"),pr=n.nuper(),this.worker=e,this.isDisposed=!1,this.q=new pr.a,this.pauseCount=1}get disposed(){return this.isDisposed}get paused(){return 0!==this.pauseCount}get length(){return this.q.length}get idle(){return void 0===this.processingPromise&&0===this.q.length}async waitTillProcessingDone(){var e;return null!==(e=this.processingPromise)&&void 0!==e?e:{count:0,duration:0}}dispose(){throw new Error("Not implemented.")}clear(){this.q.clear()}peek(){return this.q.peekFront()}toArray(){return this.q.toArray()}push(e){try{this.q.push(e),this.emit("push",e),this.ensureProcessing()}catch(e){this.emit("error",e)}}async pause(){this.pauseCount++,await this.waitTillProcessingDone()}resume(){Cn(this.pauseCount>0,244),this.pauseCount--,this.ensureProcessing()}ensureProcessing(){this.anythingToProcess()&&void 0===this.processingPromise&&(this.processingPromise=Promise.resolve().then((()=>{Cn(void 0!==this.processingPromise,895);const e=this.processDeltas();return Cn(void 0!==this.processingPromise,896),this.processingPromise=void 0,e})).catch((e=>(this.error=e,this.processingPromise=void 0,this.emit("error",e),{count:0,duration:0}))),Cn(void 0!==this.processingPromise,897))}anythingToProcess(){return 0!==this.q.length&&!this.paused&&void 0===this.error}processDeltas(){const e=On.now();let t=0;for(;this.anythingToProcess();){const e=this.q.shift();t++,this.worker(e),this.emit("op",e)}const n=On.now()-e;return 0===this.q.length&&this.emit("idle",t,n),{count:t,duration:n}}}class gr extends dr{constructor(e,t,n,r){super(),this.serviceProvider=e,this.logger=t,this._active=n,this.pending=[],this.currentlyProcessingOps=!1,this.preventConcurrentOpSend=!0,this.minSequenceNumber=0,this.lastQueuedSequenceNumber=0,this.lastObservedSeqNumber=0,this.lastProcessedSequenceNumber=0,this.baseTerm=0,this.opsSize=0,this.initSequenceNumber=0,this.closed=!1,this.throttlingIdSet=new Set,this.timeTillThrottling=0,this.closeAbortController=new lr.a,this.deltaStorageDelayId=Object(kt.a)(),this.deltaStreamDelayId=Object(kt.a)(),this.messageBuffer=[],this.connectionManager=r({incomingOpHandler:(e,t)=>{atch(e){this.logger.sendEis.close(Object(At.h)(e))}},signalHandler:e=>this._inboundSignal.push(e),reconnectionDelayHandler:(e,t)=>this.emitDelayInfo(this.deltaStreamDelayId,e,t),closeHandler:e=>this.close(e),disconnectHandler:e=>this.disconnectHandler(e),connectHandler:e=>this.connectHandler(e),pongHandler:e=>this.emit("pong",e),readonlyChangeHandler:e=>function(e,t,n){try{for(var r=arguments.length,o=new Array(r>3?r-3:0),i=3;i<r;i++)o[i-3]=arguments[i];e.emit(n,...o)}catch(e){t.sendErrorEvent({eventName:"RaiseEventError",event:n},e)}}(this,this.logger,"readonly",e)}),this.mc=Object(It.c)(t),this.preventConcurrentOpSend=!0===this.mc.config.getBoolean("Fluid.Container.ConcurrentOpSend"),this._inbound=new mr((e=>{this.processInboundMessage(e)})),this._inbound.on("error",(e=>{this.close(In.wrapIfUnrecognized(e,"deltaManagerInboundErrorHandler",this.lastMessage))})),this._inboundSignal=new mr((e=>{if(void 0===this.handler)throw new Error("Attempted to process an inbound signal without a handler attached");this.handler.processSignal({clientId:e.clientId,content:JSON.parse(e.content)})})),this._inboundSignal.on("error",(e=>{this.close(Object(At.h)(e))}))}get active(){return this._active()}get disposed(){return this.closed}get IDeltaSender(){return this}get inbound(){return this._inbound}get inboundSignal(){return this._inboundSignal}get initialSequenceNumber(){return this.initSequenceNumber}get lastSequenceNumber(){return this.lastProcessedSequenceNumber}get lastMessage(){return this.lastProcessedMessage}get lastKnownSeqNumber(){return this.lastObservedSeqNumber}get referenceTerm(){return this.baseTerm}get minimumSequenceNumber(){return this.minSequenceNumber}get hasCheckpointSequenceNumber(){return Cn(this.connectionManager.connected,223),void 0!==this._checkpointSequenceNumber}get maxMessageSize(){return this.connectionManager.maxMessageSize}get version(){return this.connectionManager.version}get serviceConfiguration(){return this.connectionManager.serviceConfiguration}get outbound(){return this.connectionManager.outbound}get readOnlyInfo(){return this.connectionManager.readOnlyInfo}get clientDetails(){return this.connectionManager.clientDetails}submit(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0;this.currentlyProcessingOps&&this.preventConcurrentOpSend&&this.close(new _n("Making changes to data model is disallowed while processing ops."));const o={contents:t,metadata:r,referenceSequenceNumber:this.lastProcessedSequenceNumber,type:e};n||this.flush();const i=this.connectionManager.prepareMessageToSend(o);return void 0===i?-1:(null!=t&&(this.opsSize+=t.length),this.messageBuffer.push(i),this.emit("submitOp",i),n||this.flush(),i.clientSequenceNumber)}submitSignal(e){return this.connectionManager.submitSignal(e)}flush(){var e,t,n;const r=this.messageBuffer;0!==r.length&&(this.messageBuffer=[],this.emit("prepareSend",r),1===r.length?Cn(void 0===(null===(e=r[0].metadata)||void 0===e?void 0:e.batch),969):(Cn(!0===(null===(t=r[0].metadata)||void 0===t?void 0:t.batch),970),Cn(!1===(null===(n=r[r.length-1].metadata)||void 0===n?void 0:n.batch),971)),this.connectionManager.sendMessages(r),Cn(0===this.messageBuffer.length,972))}get connectionProps(){return Object.assign({sequenceNumber:this.lastSequenceNumber,opsSize:this.opsSize>0?this.opsSize:void 0},this.connectionManager.connectionProps)}logConnectionIssue(e){var t;Cn(this.connectionManager.connected,568);const n=this.pending.sort(((e,t)=>e.sequenceNumber-t.sequenceNumber));this.logger.sendErrorEvent(Object.assign(Object.assign(Object.assign(Object.assign({},e),{fetchReason:this.fetchReason,lastQueuedSequenceNumber:this.lastQueuedSequenceNumber,lastProcessedSequenceNumber:this.lastProcessedSequenceNumber,lastObserved:this.lastObservedSeqNumber}),this.connectionManager.connectionVerboseProps),{pendingOps:this.pending.length,pendingFirst:null===(t=n[0])||void 0===t?void 0:t.sequenceNumber,haveHandler:void 0!==this.handler,inboundLength:this.inbound.length,inboundPaused:this.inbound.paused}))}connectHandler(e){this.refreshDelayInfo(this.deltaStreamDelayId);const t=this.connectionManager.connectionVerboseProps;t.connectionLastQueuedSequenceNumber=this.lastQueuedSequenceNumber,t.connectionLastObservedSeqNumber=this.lastObservedSeqNumber;const n=e.checkpointSequenceNumber;this._checkpointSequenceNumber=n,void 0!==n&&this.updateLatestKnownOpSeqNumber(n),Cn(0===this.messageBuffer.length,233),this.opsSize=0,this.emit("connect",e,void 0!==n?this.lastObservedSeqNumber-this.lastSequenceNumber:void 0),void 0!==n?n>this.lastQueuedSequenceNumber&&this.fetchMissingDeltas("AfterConnection"):"read"===e.mode&&this.fetchMissingDeltas("AfterReadConnection")}dispose(){throw new Error("Not implemented.")}async attachOpHandler(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"none";if(this.initSequenceNumber=t,this.lastProcessedSequenceNumber=t,this.baseTerm=n,this.minSequenceNumber=e,this.lastQueuedSequenceNumber=t,this.lastObservedSeqNumber=t,Cn(void 0===this.handler,226),this.handler=r,Cn(!!this.handler,227),Cn(void 0===this.fetchReason,616),!this.closed){if(this._inbound.resume(),this._inboundSignal.resume(),"none"!==o){const e="cached"===o;await this.fetchMissingDeltasCore(`DocumentOpen_${o}`,e),e&&this.fetchMissingDeltas("PostDocumentOpen")}Cn(void 0!==this.fetchReason||0===this.pending.length,617)}}connect(e){var t;const n=null===(t=e.fetchOpsFromStorage)||void 0===t||t;!function(e,t,n){if(e)return!0;t.send({eventName:"CantFetchWithoutBaseline",category:"error"})}(void 0!==this.handler||!n,this.logger),n&&this.fetchMissingDeltas(e.reason),this.connectionManager.connect(e.mode)}async getDeltas(e,t,n,r,o){const i=this.serviceProvider();if(void 0===i)throw new Error("Delta manager is not attached");let s;if(void 0===this.deltaStorage&&(this.deltaStorage=await i.connectToDeltaStorage()),void 0!==t){const r=t-1;if(this.lastQueuedSequenceNumber>=r)return void this.vent(Obl",early:!0,from:e,to:t},this.connectionManager.connectionVerboseProps));s=e=>e.sequenceNumber>=r}else s=e=>e.sequenceNumber>=this.lastObservedSeqNumber;const a=new lr.a;let c=!1;const u=e=>{Cn(e.sequenceNumber===this.lastQueuedSequenceNumber,570),!c&&s(e)&&(a.abort(),this._inbound.off("push",u))};try{this._inbound.on("push",u),Cn(null===this.closeAbortController.signal.onabort,488),this.closeAbortController.signal.onabort=()=>a.abort();const i=this.deltaStorage.fetchMessages(e,t,a.signal,o,n);for(;;){const e=await i.read();if(e.done)break;try{c=!0,r(e.value)}finally{c=!1}}}finally{this.closeAbortController.signal.onabort=null,this._inbound.off("push",u),Cn(!c,649)}}close(e){this.closed||(this.closed=!0,this.connectionManager.dispose(e),this.closeAbortController.abort(),this._inbound.clear(),this._inboundSignal.clear(),this._inbound.pause(),this._inboundSignal.pause(),this.pending=[],this.emit("closed",e),this.removeAllListeners())}refreshDelayInfo(e){this.throttlingIdSet.delete(e),0===this.throttlingIdSet.size&&(this.timeTillThrottling=0)}disconnectHandler(e){this.messageBuffer.length=0,this.emit("disconnect",e)}emitDelayInfo(e,t,n){const r=Date.now();if(this.throttlingIdSet.addemit("throttled",e)}}comparableMessagePayload(e){return`${e.clientId}-${e.type}-${e.minimumSequenceNumber}-${e.referenceSequenceNumber}-${e.timestamp}`}enqueueMessages(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];var r,o;if(void 0===this.handler)return void(this.pending=this.pending.concat(e));if(Cn(0===this.pending.length||void 0!==this.fetchReason,489),0===e.length)return;const i=e[0].sequenceNumber,s=e[e.length-1].sequenceNumber;if(s>this.lastQueuedSequenceNumber){let r=i-1;const o=r-this.lastQueuedSequenceNumber;let a,c,u=0,l=0;for(const t of e)t.sequenceNumber===r?u++:t.sequenceNumber!==r+1&&(l++,void 0===a&&(a=r+1)),r=t.sequenceNumber;0!==u||0!==l&&!n||o>0&&void 0===this.fetchReason?c="enqueueMessages":void 0!==this.fetchReason&&this.fetchReason!==t&&i<=this.lastQueuedSequenceNumber+1&&s>this.lastQueuedSequenceNumber&&(c="enqueueMessagesExtraFetch"),void 0!==c&&this.logger.sendPerformanceEvent(Object.assign({eventName:c,reason:t,previousReason:this.prevEnqueueMessagesReason,from:i,to:s+1,length:e.length,fetchReason:this.fetchReason,duplicate:u>0?u:void 0,initialGap:0!==o?o:void 0,gap:l>0?l:void 0,firstMissing:a,dmInitialSeqNumber:this.initialSequenceNumber},this.connectionManager.connectionVerboseProps))}this.updateLatestKnownOpSeqNumber(e[e.length-1].sequenceNumber);const a=null===(r=this.previouslyProcessedMessage)||void 0===r?void 0:r.sequenceNumber;Cn(void 0===a||a===this.lastQueuedSequenceNumber,236);for(const n of e)if(n.sequenceNumber<=this.lastQueuedSequenceNumber){if((null===(o=this.previouslyProcessedMessage)||void 0===o?void 0:o.sequenceNumber)===n.sequenceNumber){const e=this.comparableMessagePayload(this.previouslyProcessedMessage),t=this.comparableMessagePayload(n);if(e!==t){const r=new Un("Found two messages with the same sequenceNumber but different payloads. Likely to be a service issue",tt.a.fileOverwrittenInStorage,{clientId:this.connectionManager.clientId,sequenceNumber:n.sequenceNumber,message1:e,message2:t,driverVersion:void 0});this.close(r)}}}else n.sequenceNumber!==this.lastQueuedSequenceNumber+1?(this.pending.push(n),this.fetchMissingDeltas(t,n.sequenceNumber)):(this.lastQueuedSequenceNumber=n.sequenceNumber,this.previouslyProcessedMessage=n,this._inbound.push(n));this.prevEnqueueMessagesReason=this.pending.length>0?"unknown":t}processInboundMessage(e){const t=Date.now();if(Cn(!this.currentlyProcessingOps,943),this.currentlyProcessingOps=!0,this.lastProcessedMessage=e,Cn(void 0!==e.clientId||!function(e){if(hr(e))return!0;switch(e.type){case Jn.Propose:case Jn.Reject:case Jn.NoOp:case cr.Accept:case Jn.Summarize:return!0;default:return!1}}(e),237),"string"==typeof e.contents&&""!==e.contents&&e.type!==Jn.ClientLeave&&(e.contents=JSON.parse(e.contents)),this.connectionManager.beforeProcessingIncomingOp(e),this.minSequenceNumber>e.minimumSequenceNumber)throw new jn("Found a lower minimumSequenceNumber (msn) than previously recorded",Object.assign(Object.assign({},Nn(e)),{clientId:this.connectionManager.clientId}));if(this.minSequenceNumber=e.minimumSequenceNumber,e.sequenceNumber!==this.lastProcessedSequenceNumber+1)throw new jn("Found a non-Sequential sequenceNumber",Object.assign(Object.assign({},Nn(e)),{clientId:this.connectionManager.clientId}));if(this.lastProcessedSequenceNumber=e.sequenceNumber,Cn(this.lastProcessedSequenceNumber<=this.lastObservedSeqNumber,615),void 0===e.term&&(e.term=1),this.baseTerm=e.term,void 0===this.handler)throw new Error("Attempted to process an inbound message without a handler attached");this.handler.process(e),this.currentlyProcessingOps=!1;const n=Date.now();this.emit("op",e,n-t)}fetchMissingDeltas(e,t){this.fetchMissingDeltasCore(e,!1,t).catch((e=>{this.logger.sendErrorEvent({eventName:"fetchMissingDeltasException"},e)}))}async fetchMissingDeltasCore(e,t,n){var r;if(void 0===this.fetchReason)if(this.closed)this.logger.sendTelemetryEvent({eventName:"fetchMissingDeltasClosedConnection",reason:e});else if(void 0!==this.handler)try{let o=this.lastQueuedSequenceNumber+1;const i=null===(r=this.previouslyProcessedMessage)||void 0===r?void 0:r.sequenceNumber;void 0!==i&&(Cn(i===this.lastQueuedSequenceNumber,242),Cn(o>1,243),o--);const s=`${e}_fetch`;this.fetchReason=s,await this.getDeltas(o,n,s,(e=>{this.refreshDelayInfo(this.deltaStorageDelayId),this.enqueueMessages(e,s)}),t)}catch(e){this.logger.sendErrorEvent({eventName:"GetDeltas_Exception"},e),this.close(Object(At.h)(e))}finally{this.refreshDelayInfo(this.deltaStorageDelayId),this.fetchReason=void 0,this.processPendingOps(e)}else Cn(0===this.lastQueuedSequenceNumber,619)}processPendingOps(e){if(this.closed)return;Cn(void 0!==this.handler,620);const t=this.pending.sort(((e,t)=>e.sequenceNumber-t.sequenceNumber));this.pending=[],this.enqueueMessages(t,`${e}_pending`,!0),void 0===this.fetchReason&&this.lastQueuedSequenceNumber<this.lastObservedSeqNumber&&this.fetchMissingDeltas("OpsBehind")}updateLatestKnownOpSeqNumber(e){this.lastObservedSeqNumber<e&&(this.lastObservedSeqNumber=e)}}class vr extends dr{is.isDisposed=!1,this.forwardingEvvent,(t=>this.unforwardEvent(e,t))),this.on(vr.newListenerEvent,t)}}static isEmitterEvent(e){return e===vr.newListenerEvent||e===vr.removeListenerEvent}get disposed(){return this.isDisposed}dispose(){this.isDisposed=!0;for(const e of this.forwardingEvents.values())for(const t of e.values())try{t()}catch(e){}this.removeAllListeners(),this.forwardingEvents.clear()}forwardEvent(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];for(const n of r)if(void 0.forwardir)),!r.has(e)){const o=function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return t.emit(n,...r)};r.set(e,(()=>e.off(n,o))),e.on(n,o)}}}unforwardEvent(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(const t of n)if(void 0!==t&&!vr.isEmitterEvent(t)){const n=this.forwardingEvents.get(t);if(!0===(null==n?void 0:n.has(e))&&0===this.listenerCount(t)){const r=n.get(e);void 0!==r&&r(),gEvents.delete(t)}}}}vr.newListenerEvent="newListener",vr.removeListenerEvent="removeListener";class br extends vr{constructor(e){super(e),this.queue=e}get paused(){return this.queue.paused}get length(){return this.queue.length}get idle(){return this.queue.idle}peek(){return this.queue.peek()}toArray(){return this.queue.toArray()}async systemPause(){return this.pause()}async pause(){return this.queue.pause()}async systemResume(){return this.resume()}async resume(){this.queue.resume()}async waitTillProcessingDone(){return this.queue.waitTillProcessingDone()}}class yr extends vr{constructor(e){super(e),this.deltaManager=e,this.inbound=new br(e.inbound),this.outbound=new br(e.outbound),this.inboundSignal=new br(e.inboundSignal)}get IDeltaSender(){return this}get minimumSequenceNumber(){return this.deltaManager.minimumSequenceNumber}get lastSequenceNumber(){return this.deltaManager.lastSequenceNumber}get lastMessage(){return this.deltaManager.lastMessage}get lastKnownSeqNumber(){return this.deltaManager.lastKnownSeqNumber}get initialSequenceNumber(){return this.deltaManager.initialSequenceNumber}get hasCheckpointSequenceNumber(){return this.deltaManager.hasCheckpointSequenceNumber}get clientDetails(){return this.deltaManager.clientDetails}get version(){return this.deltaManager.version}get maxMessageSize(){return this.deltaManager.maxMessageSize}get serviceConfiguration(){return this.deltaManager.serviceConfiguration}get active(){return this.deltaManager.active}get readOnlyInfo(){return this.deltaManager.readOnlyInfo}dispose(){this.inbound.dispose(),this.outbound.dispose(),this.inboundSignal.dispose(),super.dispose()}submitSignal(e){return this.deltaManager.submitSignal(e)}flush(){return this.deltaManager.flush()}}class wr extends At.a{constructor(e){super(e,{usageError:!0}),this.errorType="usageError"}}class Cr{constructor(e,t){this.internalStorageService=e,this.generateProtocolTree=t,this.getSnapshotTree=this.internalStorageService.getSnapshotTree.bind(this.internalStorageService),this.getVersions=this.internalStorageService.getVersions.bind(this.internalStorageService),this.createBlob=this.internalStorageService.createBlob.bind(this.internalStorageService),this.readBlob=this.internalStorageService.readBlob.bind(this.internalStorageService),this.downloadSummary=this.internalStorageService.downloadSummary.bind(this.internalStorageService),this.dispose=this.internalStorageService.dispose.bind(this.internalStorageService)}get policies(){return this.internalStorageService.policies}get repositoryUrl(){return this.internalStorageService.repositoryUrl}get disposed(){return this.internalStorageService.disposed}async uploadSummaryWithContext(e,t){return this.internalStorageService.uploadSummaryWithContext(Pn(e,this.generateProtocolTree()),t)}}class Or{constructor(e,t){this.internalStorageService=e,this.logger=t,this._disposed=!1}get policies(){return this.internalStorageService.policies}get disposed(){return this._disposed}dispose(){this._disposed=!0}get repositoryUrl(){return this.internalStorageService.repositoryUrl}async getSnapshotTree(e,t){return this.runWithRetry((async()=>this.internalStorageService.getSnapshotTree(e,t)),"storage_getSnapshotTree")}async readBlobeService.readBlob(e)),"storage_readBlob")}async getVersions(e,t,n,r){return this.runWithRetry((async()=>this.internalStorageService.getVersions(e,t,n,r)),"storage_getVersions")}async uploadSummaryWithContext(e,t){return Cn(0===t.referenceSequenceNumber==(void 0===t.ackHandle),593),0!==t.referenceSequenceNumber?this.internalStorageService.uploadSummaryWithContext(e,t):this.runWithRetry((async()=>this.internalStorageService.uploadSummaryWithContext(e,t)),"storage_uploadSummaryWithContext")}async downloadSummary(e){return this.runWithRetry((async()=>this.internalStorageService.downloadSummary(e)),"storage_downloadSummary")}async createBlob(e){return this.runWithRetry((async()=>this.internalStorageService.createBlob(e)),"storage_createBlob")}checkStorageDisposed(){if(this._disposed)throw new kn("Storage Service is disposed. Cannot retry",{canRetry:!1})}async runWithRetry(e,t){return zn(e,t,this.logger,{onRetry:()=>this.checkStorageDisposed()})}}class Tr{constructor(e,t,n){this.logger=t,this.captureProtocolSummary=n,this.blobContents={},this.disposed=!1,this._storageService=new Sr(e,t)}dispose(e){var t,n;null===(n=null===(t=this._storageService)||void 0===t?void 0:t.dispose)||void 0===n||n.call(t,e),this.disposed=!0}async connectToService(e){var t,n;if(!(this._storageService instanceof Sr))return;const r=await e.connectToStorage(),o=this._storageService=new Or(r,this.logger);void 0!==this.captureProtocolSummary&&(this.logger.sendTelemetryEvent({eventName:"summarizeProtocolTreeEnabled"}),this._storageService=new Cr(o,this.captureProtocolSize)===(null===(n=this._storageService.policies)||void 0===n?void 0:n.minBlobSize),224)}loadSnapshotForRehydratingContainer(e){this.getBlobContents(e)}getBlobContentss.blobContents[t]=n;for(const[t,n]of Object.entries(e.trees))this.getBlobContents(n)}get policies(){try{return this._storageService.policies}catch(e){}}get repositoryUrl(){return this._storageService.repositoryUrl}async getSnapshotTree(et=this.blobContents[e];return void 0!==t?t:this._storageService.readBlob(e)}async getVersions(e,t,n,r){return this._storageService.getVersions(e,t,n,r)}async uploadSummaryWithContext(e,t){return this._storageService.uploadSummaryWithContext(e,t)}async downloadSummary(e){return this._storageService.downloadSummary(e)}async createBlob(e){return this._storageService.createBlob(e)}}class Sr{constructor(e,t){this.detachedStorage=e,this.logger=t,this.getSnapshotTree=this.notCalled,this.getVersions=this.notCalled,this.write=this.e)}verifyStorage(){if(void 0===this.dls not allowed in Unattached container");return this.detachedStorage}get policies(){return this.notCalled()}get repositoryUrl(){return this.notCalled()}notCalled(){this.verifyStorage();try{throw new Error("BlobOnlyStorage not implemented method used")}catch(e){throw tdErrorEvent({eventName:"BlobOnlyStorageWrongCall"},e),e}}}const kr=2147483647;function Er(e,t,n){let r;if(t>kr){const o=t-kr;r=setTimeout((()=>Er(e,o,n)),kr)}else r=setTimeout((()=>e()),t);return null==n||n(r),r}class _r{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>Date.now();this.defaultTimeout=e,this.defaultHandler=t,this.getCurrentTick=n}get hasTimer(){return!!this.runningState}start(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.defaultTimeout;this.startCore(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultHandler,e)}clear(){this.runningState&&(clearTimeout(this.runningState.timeout),this.runningState=void 0)}restart(e,t){var n,r;if(this.runningState){const o=null!=e?e:this.runningState.intendedDuration,i=null!==(r=null!=t?t:null===(n=this.runningState.restart)||void 0===n?void 0:n.handler)&&void 0!==r?r:this.runningState.handler,s=this.calculateRemainingTime(this.runningState);o<s?this.start(o,i):o===s?(this.runningState.handler=i,this.runningState.restart=void 0,this.runningState.intendedDuration=o):this.runningState.restart={startTick:this.getCurrentTick(),duration:o,handler:i}}else this.start(e,t)}startCore(e,t,n){this.clear(),this.runningState={startTick:this.getCurrentTick(),duration:e,intendedDuration:n,handler:t,timeout:Er((()=>this.handler()),e,(e=>{void 0!==this.runningState&&(this.runningState.timeout=e)}))}}handler(){Cn(!!this.runningState,10);const e=this.runningState.restart;if(void 0!==e){const t=this.calculateRemainingTime(e);this.startCore(t,(()=>e.handler()),e.duration)}else{const e=this.runningState.handler;this.clear(),e()}}calculateRemainingTime(e){const t=this.getCurrentTick()-e.startTick;return e.duration-t}}var jr;!function(e){e[e.Disconnected=0]="Disconnected",e[e.EstablishingConnection=3]="EstablishingConnection",e[e.CatchingUp=1]="CatchingUp",e[e.Connected=2]="Connected"}(jr||(jr={}));class Ir{constructor(e,t){this.deltaManager=e,this.listener=t,this.caughtUp=!1,this.opHandler=e=>{!this.caughtUp&&e.sequenceNumber>=this.targetSeqNumber&&(this.caughtUp=!0,this.listener())},this.disposed=!1,this.targetSeqNumber=this.deltaManager.lastKnownSeqNumber,Cn(this.targetSeqNumber>=this.deltaManager.lastSequenceNumber,892),this.deltaManager.on("op",this.opHandler),this.opHandler({sequenceNumber:this.deltaManager.lastSequenceNumber})}dispose(){this.disposed||(this.disposed=!0,this.deltaManager.off("op",this.opHandler))}}class Nr extends class{constructor(e,t){this.inputs=e,this.pimpl=t(this)}get connectionState(){return this.pimpl.connectionState}get pendingClientId(){return this.pimpl.pendingClientId}containerSaved(){return this.pimpl.containerSaved()}dispose(){return this.pimpl.dispose()}initProtocol(e){return this.pimpl.initProtocol(e)}receivedDisconnectEvent(e){rs.pimpl.receivedConnectEvent(e,t)}get logger(){return this.inputs.logger}connectionStateChanged(e,t,n){return this.inputs.connectionStateChanged(e,t,n)}shouldClientJoinWrite(){return this.inputs.shouldClientJoinWrite()}get maxClientLeaveWaitTime(){return this.inputs.maxClientLeaveWaitTime}logConnectionIssue(e,t){return this.inputs.logConnectionIssue(e,t)}}{constructor(e,t,n){super(e,t),this.deltaManager=n,this.transitionToConnectedState=()=>{Cn(this.pimpl.connectionState===jr.Connected,997),Cn(this._connectionState===jr.CatchingUp,998),this._connectionState=jr.Connected,this.inputs.connectionStateChanged(jr.Connected,jr.CatchingUp,"caught up")},this._connectionState=this.pimpl.connectionState}get connectionState(){return this._connectionState}connectionStateChanged(e,t,n){var r;switch(e){case jr.Connected:return Cn(this._connectionState===jr.CatchingUp,993),Cn(void 0===this.catchUpMonitor,1003),void(this.catchUpMonitor=new Ir(this.deltaManager,this.transitionToConnectedState));case jr.Disconnected:null===(r=this.catchUpMonitor)||void 0===r||r.dispose(),this.catchUpMonitor=void 0;break;case jr.CatchingUp:Cn(this._connectionState===jr.Disconnected,995)}this._connectionState=e,this.inputs.connectionStateChanged(e,t,n)}}class Ar{constructor(e,t){var n;this.handler=e,this._clientId=t,this._connectionState=jr.Disconnected,this.prevClientLeftTimer=new _r(null!==(n=this.handler.maxClientLeaveWaitTime)&&void 0!==n?n:3e5,(()=>{Cn(this.connectionState!==jr.Connected,684),this.applyForConnectedState("timeout")})),this.joinOpTimer=new _r(45e3,(()=>{if(this.connectionState!==jr.CatchingUp)return;const e={protocolInitialized:void 0!==this.protocol,pendingClientId:this.pendingClientId,clientJoined:this.hasMember(this.pendingClientId),waitingForLeaveOp:this.waitingForLeaveOp};this.handler.logConnectionIssue("NoJoinOp",e)}))}get connectionState(){return this._connectionState}get clientId(){return this._clientId}get pendingClientId(){return this._pendingClientId}startJoinOpTimer(){Cn(!this.joinOpTimer.hasTimer,564),this.joinOpTimer.start()}stopJoinOpTimer(){Cn(this.joinOpTimer.hasTimer,565),this.joinOpTimer.clear()}get s.prevClientLeftTimer.clear()}containerSaved(){this.waitingForLeaveOp&&(this.prevClientLeftTimer.clear(),this.applyForConnectedState("containerSaved"))}receivedAddMemberEvent(e){e===this.pendingClientId&&(this.joinOpTimer.hasTimer?this.stopJoinOpTimer():this.handler.logConnectionIssue("ReceivedJoinOp"),this.waitingForLeaveOp&&(this.waitEvent=wt.c.start(this.handler.logger,{eventName:"WaitBeforeClientLeave",details:JSON.stringify({waitOnClientId:this._clientId,hadOutstandingOps:this.handler.shouldClientJoinWrite()})})),this.applyForConnectedState("addMemberEvent"))}applyForConnectedState(e){var t;Cn(void 0!==this.protocol,566),Cn(!this.waitingForLeaveOp||this.hasMember(this.clientId),738),this.pendingClientId!==this.clientId&&this.hasMember(this.pendingClientId)&&!this.waitingForLeaveOp?(null===(t=this.waitEvent)||void 0===t||t.end({source:e}),this.setConnectionState(jr.Connected)):this.handler.logger.sendTelemetryEvent({eventName:"connectedStateRejected",category:"timeout"===e?"error":"generic",details:JSON.stringify({source:e,pendingClientId:this.pendingClientId,clientId:this.clientId,waitingForLeaveOp:this.waitingForLeaveOp,clientJoined:this.hasMember(this.his.prevClientLeftTimer.clear(),this.applyForConnectedState("removeMemberEvent"))}receivedDisconnectEvent(e){this.setConnectionState(jr.Disconnected,e)}receivedConnectEvent(e,t){const n=this._connectionState;this._connectionState=jr.CatchingUp;const r="write"===e;this._pendingClientId=t.clientId,this.handler.connectionStateChanged(jr.CatchingUp,n),r&&!this.hasMember(this._pendingClientId)?this.startJoinOpTimer():this.waitingForLeaveOp||this.setConnectionState(jr.Connected)}setConnectionState(e,t){var n,r;if(this.connectionState===e)return void this.handler.logger.sendErrorEvent({eventName:"setConnectionStateSame",value:e});const o=this._connectionState;let i;this._connectionState=e,void 0!==this._clientId&&(i=null===(r=null===(n=this.protocol)||void 0===n?void 0:n.quorum)||void 0===r?void 0:r.getMember(this._clientId)),e===jr.Connected?(Cn(o===jr.CatchingUp,472),void 0!==i&&(i.shouldHaveLeft=!0),this._clientId=this.pendingClientId):e===jr.Disconnected&&(this._pendingClientId=void 0,this.joinOpTimer.hasTimer&&this.stopJoinOpTimer(),void 0!==i&&this.handler.shouldClientJoinWrite()&&!this.waitingForLeaveOp?this.prevClientLeftTimer.restart():this.handler.logger.sendTelemetryEvent({eventName:"noWaitOnDisconnected",details:JSON.stringify({clientId:this._clientId,inQuorum:void 0!==i,waitingForLeaveOp:this.waitingForLeaveOp,hadOutstandingOps:this.handler.shouldClientJoinWrite()})})),this.handler.connectionStateChanged(this._connectionState,o,t)}get membership(){var e;return null===(e=this.protocol)||void 0===e?void 0:e.quorum}initProtocol(e){var t,n;this.protocol=e,nulln("addMember",(e=>{this.receivedAddMemberEvent(e)})),null===(n=this.membership)||void 0===n||n.on("removeMember",(e=>{this.receivedRemoveMemberEvent(e)})),this.hasMember(this.pendingClientId)&&this.receivedAddMemberEvent(this.pendingClientId),void 0!==this.clientId&&this.hasMember(this.clientId)&&this.prevClientLeftTimer.restart()}hasMember(e){var t;return void 0!==(null===(t=this.membership)||void 0===t?void 0:t.getMember(null!=e?e:""))}}function Pr(e){return 0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}function xr(e){var t;const n=Object(vn.parse)(e,!0);if("string"!=typeof n.pathname)throw new At.a("Failed to parse pathname");const r=null!==(t=n.search)&&void 0!==t?t:"",o=/^\/([^/]*\/[^/]*)(\/?.*)$/.exec(n.pathname);return 3===(null==o?void 0:o.length)?{id:o[1],path:o[2],query:r,version:n.query.version}:void 0}function Dr(e){const t={blobs:{},blobsContents:{},trees:{},id:Object(kt.a)(),unreferenced:e.unreferenced},n=Object.keys(e.tree);for(const r of n){const n=e.tree[r];switch(n.type){case An.Tree:t.trees[r]=Dr(n);break;case An.Attachment:t.blobs[r]=n.id;break;case An.Blob:{const e=Object(kt.a)();t.blobs[r]=e;const o="string"==typeof n.content?Gn(n.content,"utf8"):Pr(n.content);t.blobsContents[e]=o;break}case An.Handle:throw new At.a("No handles should be there in summary in detached container!!");default:Tn(n,`Unknown tree type ${n.type}`)}}return t}function Lr(e,t){const n={type:An.Tree,tree:Object.assign({},t.tree)};return n.tree[".protocol"]=e,Dr(n)}const Mr=e=>{const t=e.tree[".protocol"],n=e.tree[".app"];return Cn(void 0!==t&&void 0!==n,480),Lr(t,n)};function Rr(e){return".protocol"in e.trees?e.trees[".protocol"]:e}function Fr(e,t){return function(){if(e.disposed)throw new Error("Already disposed");return t(...arguments)}}class Br extends vr{constructor(e){super(e),super.setMaxListeners(50),this.propose=Fr(this,e.propose.bind(e)),this.has=Fr(this,e.has.bind(e)),this.get=Fr(this,e.get.bind(e)),this.getMembers=Fr(this,e.getMembers.bind(e)),this.getMember=Fr(this,e.getMember.bind(e))}}function Ur(e){return[["code",{key:"code",value:e,approvalSequenceNumber:0,commitSequenceNumber:0,sequenceNumber:0}]]}class Wr{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;this.submit=e,this.NoopCountFrequency=n,this.opsCountSinceNoop=0,t!==1/0&&(this.timer=new _r(t,(()=>{0!==this.opsCountSinceNoop&&this.submitNoop(!1)})))}scheduleSequenceNumberUpdate(e,t){t?this.submitNoop(!0):hr(e)&&(this.opsCountSinceNoop++,this.opsCountSinceNoop===this.NoopCountFrequency&&Promise.resolve().then((()=>{Cn(this.opsCountSinceNoop>=this.NoopCountFrequency,942),this.submitNoop(!1),this.opsCountSinceNoop=0})),void 0!==this.timer&&(1===this.opsCountSinceNoop&&this.timer.restart(),Cn(this.timer.hasTimer,578)))}submitNoop(e){this.submit(e?cr.Accept:Jn.NoOp),Cn(0===this.opsCountSinceNoop,579)}stopSequenceNumberUpdate(){this.opsCountSinceNoop=0}}function qr(e,t,n){var r,o;const i=Object.assign({},t),s=n.online;if(i.online="string"==typeof s?s:Ln[Mn()],"object"==typeof navigator&&null!==navigator){const e=navigator,t=null!==(o=null!==(r=e.connection)&&void 0!==r?r:e.mozConnection)&&void 0!==o?o:e.webkitConnection;null!==t&&"object"==typeof t&&(i.connectionType=t.type)}i.category=qn(n)?"generic":"error",e.sendTelemetryEventn=t,r=e;Mn()===Ln.Offline&&void 0!==(null===window||void 0===window?void 0:window.addEventListener)&&(n=()=>{t(),window.removeEventListener("online",n)},window.addEventListener("online",n,!1),r=Math.max(e,3e4)),setTimeout(n,r)}))}var zr;!function(e){e.DocRead="doc:read",e.DocWrite="doc:write",e.SummaryWrite="summary:write"}(zr||(zr={}));const Gr={fatalConnectError:!0};class Vr extends dr{constructor(){super(...arguments),this.clientId="storage-only client",this.claims={scopes:[zr.DocRead]},this.mode="read",this.existing=!0,this.maxMessageSize=0,this.version="",this.initialMessages=[],this.initialSignals=[],this.initialClients=[],this.serviceConfiguration={maxMessageSize:0,blockSize:0},this.checkpointSequenceNumber=void 0,this._disposed=!1}submit(e){this.emit("nack",this.clientId,e.map((e=>({operation:e,content:{message:"Cannot submit with storage-only connection",code:403}}))))}submitSignal(e){this.emit("nack",this.clientId,{operation:e,content:{message:"Cannot submit signal with storage-only connection",code:403}})}get disposed(){return this._disposed}dispose(){this._disposed=!0}}class $r{constructor(e,t,n,r,o){this.serviceProvider=e,this.client=t,this.logger=r,this.props=o,this._forceReadonly=!1,this.pendingReconnect=!1,this.clientSequenceNumber=0,this.clientSequenceNumberObserved=0,this.localOpsToIgnore=0,this.connectFirstConnection=!0,this._connectionVerboseProps={},this._connectionProps={},this.closed=!1,this.opHandler=(e,t)=>{const n=Array.isArray(t)?t:[t];this.props.incomingOpHandler(n,"opHandler")},this.nackHandler=(e,t)=>{const n=t[0];if(!0===this._readonlyPermissions)return void this.props.closeHandler(((e,t)=>new Un("writeOnReadOnlyDocument",tt.a.writeError,{driverVersion:void 0}))());const r=function(e){return function(e,t,n){return void 0!==t.retryAfterMs&&t.canRetry?new Wn(e,t.retryAfterMs/1e3,n):new Rn(e,t.canRetry,n)}(`Nack (${e.type}): ${e.message}`,{canRetry:403!==e.code,retryAfterMs:void 0!==e.retryAfter?1e3*e.retryAfter:void 0},{statusCode:e.code,driverVersion:void 0})}(n.content);r.canRetry?this.reconnectOntHandlerInternal=e=>{this.reconnectOnError(this.defaultReconnectionMode,e)},this.errorHandler=e=>{this.reconnectOnError(this.defaultReconnectionMode,e)},this.clientDetails=this.client.details,this.defaultReconnectionMode=this.client.mode,this._reconnectMode=n?er.Enabled:er.Never,this._outbound=new mr((e=>{if(void 0===this.connection)throw new Error("Attempted to submit an outbound message without connection");this.connection.(){var e,t;return null!==(t=null===(e=this.connection)||void 0===e?void 0:e.mode)&&void 0!==t?t:"read"}get connected(){return voidturn null!==(n=null===(t=null===(e=this.connection)||void 0===e?void 0:e.serviceConfiguration)||void 0===t?void 0:t.maxMessageSize)&&=(e=this.connection)||void 0===e?void 0:e.serviceConfiguration}get scopes(){var e;return null===(e=this.connection)||void 0===e?void 0:e.claims.scopes}get outbound(){return this._outbound}get connectionProps(){return void 0!==this.connection?this._connectionProps:Object.assign(Object.assign({},this._connectithis.clientSequenceNumberObserved<this.clientSequenceNumber-this.localOpsToIgnore}get readonly(){return!!this._forceReadonly||this._readonlyPermissions}get readOnlyInfo(){const e=void 0!==this.connection&&this.connection instanceof Vr;return e||this._forceReadonly||!0===this._readonlyPermissions?{readonly:!0,forced:this._forceReadonly,permissions:this._readonlyPermissions,storageOnly:e}:{readonly:this._readonlyPermissions}}static detailsFromConnection(e){return{claims:e.claims,clientId:e.clientId,existing:e.existing,checkpointSequenceNumber:e.checkpointSequenceNumber,get initialClients(){return e.initialClients},mode:e.mode,serviceConfiguration:e.serviceConfiguration,version:e.version}}dispose(e){this.closed||(this.closed=!0,this.pendingConnection=void 0,this._reconnectMode=er.Never,this._outbound.clear(),this.disconnectFromDeltaStream(void 0!==e?`Closing DeltaManager (${e.message})`:"Closing DeltaManager"),this.set_readonlyPermissions(!0))}setAutoReconnect(e){Cn(e!==er.Never&&this._reconnectMode!==er.Never,632),this._reconnectMode=e,e!==er.Enabled&&this.disconnectFromDeltaStream("setAutoReconnect")}forceReadonly(e){e!==this._forceReadonly&&this.logger.sendTelemetryEvent({eventName:"ForceReadOnly",value:e});const t=this.readonly;if(this._forceReadonly=e,t!==this.readonly){if(this._reconnectMode===er.Never)throw new _n("API is not supported for non-connecting or closed container");let e=!1;!0===this.readonly&&(this.shouldJoinWrite()&&this.logger.sendErrorEvent({eventName:"ForceReadonlyPendingChanged"}),e=this.disconnectFromDeltaStream("Force readonly")),this.props.readonlyChangeHandler(this.readonly),e&&this.triggerConnect("read")}}set_readonlyPermissions(e){const t=this.readonly;this._readonlyPermissions=e,t!==this.readonly&&this.props.readonlyChangeHandler(this.readonly)}connect(e){this.connectCore(e).catch((e=>{const t=Object(At.h)(e,{props:Gr});this.props.closeHandler(t)}))}async connectCore(e){var t,n;if(Cn(!this.closed,618),void 0!==this.connection)return;let r;void 0!==this.pendingConnection&&(r=this.pendingConnection.connectionMode,this.cancelConnection(),Cn(void 0===this.pendingConnection,836));let o=null!==(t=null!=e?e:r)&&void 0!==t?t:this.defaultReconnectionMode;this.shouldJoinWrite()&&(o="write");const i=this.serviceProvider();let s;if(Cn(void 0!==i,679),!0===(null===(n=i.policies)||void 0===n?void 0:n.storageOnly))return s=new Vr,this.setupNewSuccessfulConnection(s,"read"),void Cn(void 0===this.pendingConnection,691);let a=1e3,c=0;const u=On.now();let l;const d=new lr.a,h=d.signal;for(this.pendingConnection={abort:()=>{d.abort()},connectionMode:o};void 0===s;){if(this.closed)throw new Error("Attempting to connect a closed DeltaManager");if(!0===h.aborted)return void this.logger.sendTelemetryEvent({eventName:"ConnectionAttemptCancelled",attempts:c,duration:wt.e.formatTick(On.now()-u),connectionEstablished:!1});c++;try{this.client.mode=o,s=await i.connectToDeltaStream(Object.assign(Object.assign({},this.client),{mode:o})),s.disposed&&(this.logger.sendTelemetryEvent({eventName:"ReceivedClosedConnection"}),s=void 0)}catch(e){if("object"==typeof e&&null!==e&&(null==e?void 0:e.errorType)===Fn.errorType){s=new Vr,o="read";break}if(!qn(e)){const t=Object(At.h)(e,{props:Gr});throw this.props.closeHandler(t),t}qr(this.logger,{attempts:c,delay:a,eventName:"DeltaConnectionFailureToConnect",duration:wt.e.formatTick(On.now()-u)},e),l=e;const t=Hn(e);a=null!=t?t:Math.min(2*a,8e3),void 0!==t&&this.props.reconnectionDelayHandler(t,e),await Hr(a)}}if(c>1&&qr(this.logger,{eventName:"MultipleDeltaConnectionFailures",attempts:c,duration:wt.e.formatTick(On.now()-u)},l),!0===h.aborted)return s.dispose(),void this.logger.sendTelemetryEvent({eventName:"ConnectionAttemptCancelled",attempts:c,duration:wt.e.formatTick(On.now()-u),connectionEstablished:!0});this.setupNewSuccessfulConnection(s,o)}triggerConnect(e){Cn(void 0===this.connection,569),this.reconnectMode===er.Enabled&&this.connect(e)}disconnectFromDeltaStream(e){if(this.pendingReconnect=!1,void 0===this.connection)return void 0!==this.pendingConnection&&(this.cancelConnection(),!0);Cn(void 0===this.pendingConnection,635);const t=this.connection;return this.connection=void 0,t.off("op",this.opHandler),t.off("signal",this.props.signalHandler),t.off("nack",this.nackHandler),t.off("disconnect",this.disconnectHandlerInternal),t.off("error",this.errorHandler),t.off("pong",this.props.pongHandler),this._outbound.pause(),this._outbound.clear(),this.props.disconnectHandler(e),t.dispose(),this._connectionVerboseProps={},!0}cancelConnection(){Cn(void 0!==this.pendingConnection,837),this.pendingConnection.abort(),this.pendingConnection=void 0,this.logger.sendTelemetryEvent({eventName:"ConnectionCancelReceived"})}setupNewSuccessfulConnection(e,t){Cn(void 0===this.connection,230),Cn(!e.disposed,650),this.pendingConnection=void 0,this.connection=e;const n=!e.claims.scopes.includes(zr.DocWrite);if(Cn("read"===t||n===("read"===this.connectionMode),231),Cn(!n||"read"===this.connectionMode,232),this.set_readonlyPermissions(n),this.closed)return void this.disconnectFromDeltaStream("ConnectionManager already closed");this._outbound.resume(),e.on("op",this.opHandler),e.on("signal",this.props.signalHandler),e.on("nack",this.nackHandler),e.on("disconnect",this.disconnectHandlerInternal),e.on("error",this.errorHandler),e.on("pong",this.props.pongHandler);const r=e.initialMessages.sort(((e,t)=>e.sequenceNumber-t.sequenceNumber));let o=e.checkpointSequenceNumber;this._connectionVerboseProps={clientId:e.clientId,mode:e.mode},this._connectionProps={},void 0!==e.relayServiceAgent&&(this._connectionVerboseProps.relayServiceAgent=e.relayServiceAgent,this._connectionProps.relayServiceAgent=e.relayServiceAgent),this._connectionProps.socketDocumentId=e.claims.documentId,this._connectionProps.connectionMode=e.mode;let i=-1;if(0!==r.length&&(this._connectionVerboseProps.connectionInitialOpsFrom=r[0].sequenceNumber,i=r[r.length-1].sequenceNumber,this._connectionVerboseProps.connectionInitialOpsTo=i+1,(void 0===o||o<i)&&(o=i)),this.props.incomingOpHandler(r,this.connectFirstConnection?"InitialOps":"ReconnectOps"),void 0!==e.initialSignals)for(const t of e.initialSignals)this.props.signalHandler(t);const s=$r.detailsFromConnection(e);s.checkpointSequenceNumber=o,this.props.connectHandler(s),this.connectFirstConnection=!1}reconnectOnError(e,t){this.reconnect(e,t.message,t).catch(this.props.closeHandler)}async reconnect(e,t,n){if(Cn(void 0!==this.connection,235),this.disconnectFromDeltaStream(t),void 0===n||n.canRetry||this.logger.sendTelemetryEvent({eventName:"reconnectingDespiteFatalError",reconnectMode:this.reconnectMode},n),this.reconnectMode===er.Never&&this.props.closeHandler(),this.closed||this.reconnectMode!==er.Enabled)return;const r=Hn(n);void 0!==n&&void 0!==r&&(this.props.reconnectionDelayHandler(r,n),await Hr(r)),this.triggerConnect(e)}prepareMessageToSend(e){var t,n;if(!0!==this.readonly)return Cn(!!this.connection,228),this.lastSubmittedClientId!==(null===(t=this.connection)||void 0===t?void 0:t.clientId)&&(this.lastSubmittedClientId=null===(n=this.connection)||void 0===n?void 0:n.clientId,this.clientSequenceNumber=0,this.clientSequenceNumberObserved=0),hr(e)?this.localOpsToIgnore=0:this.localOpsToIgnore++,Object.assign(Object.assign({},e),{clientSequenceNumber:++this.clientSequenceNumber});{Cn(!0===this.readOnlyInfo.readonly,496);const e=new kn("deltaManagerReadonlySubmit",void 0,{readonly:this.readOnlyInfo.readonly,forcedReadonly:this.readOnlyInfo.forced,readonlyPermissions:this.readOnlyInfo.permissions,storageOnly:this.readOnlyInfo.storageOnly});this.props.closeHandler(e)}}submitSignal(e){void 0!==this.connection?this.connection.submitSignal(e):this.logger.sendErrorEvent({eventName:"submitSignalDisconnected"})}sendMessages(e){Cn(this.connected,692),"read"!==this.connectionMode?(Cn(!this.pendingReconnect,693),this._outbound.push(e)):this.pendingReconnect||(this.pendingReconnect=!0,Promise.resolve().then((async()=>{this.pendingReconnect&&await this.reconnect("write","Switch to write")})).catch((()=>{})))}beforeProcessingIncomingOp(e){if(Cn(this.clientId!==e.clientId||this.lastSubmittedClientId===e.clientId,238),void 0!==this.lastSubmittedClientId&&this.lastSubmittedClientId===e.clientId){const t=e.clientSequenceNumber;Cn(this.clientSequenceNumberObserved<t,239),Cn(t<=this.clientSequenceNumber,240),this.clientSequenceNumberObserved=t}e.type===Jn.ClientLeave&&JSON.parse(e.data)===this.clientId&&(this.logger.sendPerformanceEvent({eventName:"ReadConnectionTransition"}"SwitchToReadConnection"},e)})))}}var Qr=n("yEOx"),Jr=n.n(Qr);class Xr{constructor(e,t,n,r){this.sequenceNumber=e,this.key=t,this.value=n,this.local=r}}class Kr extends dr{constructor(e){super(),this.isDisposed=!1,this.members=new Map(e),this.snapshotCache=e}get disposed(){return this.isDisposed}snapshot(){var e;return null!==(e=this.snapshotCache)&&void 0!==e||(this.snapshotCache=Jr()(Array.from(this.members))),this.snapshotCache}addMember(e,t){Cn(!this.members.has(e),462),this.members.set(e,t),this.emit("addMember"r(e){Cn(this.members.has(e),463),this.mmoveMember",e),this.snapshotCache=void 0}getMembers(){return new Map(this.members)}getMember(e){return this.members.get(e)}dispose(){this.isDisposed=!0}}class Yr extends dr{constructor(e,t){super(),this.sendProposal=t,this.isDisposed=!1,this.stateEvents=new tr.EventEmitter,this.proposals=new Map(e.proposals.map((e=>{let[,t]=e;return[t.sequenceNumber,new Xr(t.sequenceNumber,t.key,t.value,!1)]}))),this.values=new Map(e.values),this.proposalsSnapshotCache=e.proposals,this.valuesSnapshotCache=e.values}get disposed(){return this.isDisposed}snapshot(){var e,t;return null!==(e=this.proposalsSnapshotCache)&&void 0!==e||(this.proposalsSnapshotCache=Array.from(this.proposals).map((e=>{let[t,n]=e;return[t,{sequenceNumber:t,key:n.key,value:n.value},[]]}))),null!==(t=this.valuesSnapshotCache)&&void 0!==t||(this.valhotCache,values:this.valuesSnapshotCache}}has(e){return this.values.has(e)}get(e){var t;return null===(t=this.values.get(e))||void 0===t?void 0:t.value}getApprovalData(e){const t=this.values.get(e);return t?Jr()(t):void 0}async propose(e,t){const n=this.sendProposal(e,t);if(n<0)throw this.emit("error",{eventName:"ProposalInDisconnectedState",key:e}),new Error("Can't propose in disconnected state");return new Promise(((e,t)=>{let r;const o=(e,t)=>{e===n&&(r=t,this.stateEvents.off("localProposalSequenced",o),this.stateEvents.off("disconnected",s),this.stateEvents.on("localProposalApproved",i))},i=t=>{t===r&&(e(),c())},s=()=>{void 0===r&&this.stateEvents.once("connected",(()=>{vof("localProposalSequenced",o),this.stateEvents.off("localProposalApproved",i),this.stateEvents.off("disconnected",s),this.stateEvents.off("disposed",a)};this.stateEvents.on("localProposalSequenced",o),this.stateEvents.on("disconnected",s),this.stateEvents.on("disposed",a)}))}addProposal(e,t,n,r,o){Cn(!this.proposals.has(n),464);const i=new Xr(n,e,t,r);this.proposals.set(n,i),this.emit("addProposal",i),r&&this.stateEvents.emit("localProposalSequenced",o,n),this.pmSequenceNumber(e){const t=e.minimumSequenceNumber,n=[];for(const[e,r]of this.proposals)e<=t&&n.push(r);n.sort(((e,t)=>e.sequenceNumber-t.sequenceNumber));for(const t of n){const n={approvalSequenceNumber:e.sequenceNumber,commitSequenceNumber:-1,key:t.key,sequenceNumber:t.sequenceNumber,value:t.value};this.values.set(n.key,n),this.valuesSnapshotCache=void 0,this.emit("approveProposal",n.sequenceNumber,n.key,n.value,n.approvalSequenceNumbuenceNumber)}}setConnectionState(e){this.stateEvents.emit(e?"connected":"disconnected")}dispose(){this.isDisposed=!0,this.stateEvens dr{constructor(e,t,n,r){super(),this.isDisposed=!1,this.quorumClients=new Kr(e),this.quorumClients.on("addMember",((e,t)=>{this.emit("addMember",e,t)})),this.quorumCls.emit("removeMember",e)})),this.quorumProposals=new Yr({proposals:t,values:n},r),this.quorumProposals.on("addProposal",(e=>{this.emit(osals.on("approveProposal",((e,t,n,r)=>{this.emit("approveProposal",e,t,n,r)}))}get disposed(){return this.isDisposed}close(){this.removeAllListeners()}snapshot(){const e=this.quorumClients.snapshot(),{proposals:t,values:n}=this.quorumProposals.snapshot();return{members:e,proposals:t,values:n}}has(e){return this.quorumProposals.has(e)}get(e){return this.quorumProposals.get(e)}getApprovalData(e){return this.quorumProposals.getApprovalData(e)}addMember(e,t){this.quorumClients.addMember(e,t)}removeMember(e){this.quorumClients.removeMember(e)}getMembers(sals.updateMinimumSequenceNumber(e)}setConnectionState(e,t){this.quorumProposals.setConnectionState(e)}dispose(){throw new Error("Not implemented.")}}class eo extends class{constructuorum(){return this._quorum}get attributes(){return{minimumSer,term:this.term}}setConnectionState(e,t){this._quorum.setConnectionState(e,t)}snapshot(){return this._quorum.snapshot()}close(){this._quorum.close()}processMessage(e,t){if(e.sequenceNumber!==this.sequenceNumber+1)throw new Error(`Protocol state is not moving sequentially. Current is ${this.sequenceNumber}. Next is ${e.sequenceNumber}`);this.sequenceNumber=e.sequenceNumber,this.minimumSequenceNumber=e.minimumSequenceNumber;let n=!1;switch(e.type){case Jn.ClientJoin:const r=e,o=JSON.parse(r.data);this._quorum.addMember(o.clientId,{client:o.detail,sequenceNumber:r.sequenceNumber});break;case Jn.ClientLeave:const i=JSON.parse(e.data);this._quorum.removeMember(i);break;case Jn.Propose:"string"==typeof e.contents&&(e.contents=JSON.parse(e.contents));const s=e.contents;this._quorum.addProposal(s.key,s.value,e.sequenceNumber,t,e.clientSequenceNumber),n=!0;break;case Jn.Reject:throw new Error("Quorum rejection is removed.")}return this._quorum.updateMinimumSequenceNumber(e),{immediateNoOp:n}}getProtocolState(){return Object.assign({sequenceNumber:this.sequenceNumber,minimumSequenceNumber:this.minimumSequenceNumber},this._quorum.snapshot())}}{constructor(e,t,n,r,o){super(e.minimumSequenceNumber,e.sequenceNumber,e.term,t.members,t.proposals,t.values,n),this.audience=o;for(const e of r)this.audience.addMember(e.clientId,e.client)}processMessage(e,t){const n=this.quorum.getMember(e.clientId);if(null!=e.clientId){iote message's clientId is missing from the quorum");if(!0===(null==n?void 0:n.shouldHaveLeft)&&!function(e){return e.type===Jn.NoOp||e.type===cr.Accept}(e))throw new Error("Remote message's clientId already should have left")}return super.processMessage(e,t)}processSignal(e){const t=e.content;switch(t.type){case Jn.ClientJoin:{const e=t.content;this.audience.addMember(e.clientId,e.client);break}case Jn.ClientLeave:this.audience.removeMember(t.content)}}}const to="dirty",no="saved";async function ro(e,t,n){const r=wt.c.start(e,{eventName:t}),o=await n();r.duration>1e3&&r.end(o)}const oo="summarizer";class io extends rr{constructor(e,t,n){var r,o;super(((e,t)=>{this.mc.logger.sendErrorEvent({eventName:"ContainerEventHandlerException",name:"string"==typeof e?e:void 0},t)})),this.loader=e,this.protocolHandlerBuilder=n,this._canReconnect=!0,this._lifecycleState="loading",this._attachState=Xt.Detached,this.inboundQueuePausedFromInit=!0,this.firstConnection=!0,this.connectionTransitionTimes=[],this.messageCountAfterDisconnection=0,this.attachStarted=!1,this._dirtyContainer=!1,this.setAutoReconnectTime=On.now(),this.clientDetailsOverride=t.clientDetailsOverride,this._resolvedUrl=t.resolvedUrl,void 0!==t.canReconnect&&(this._canReconnect=t.canReconnect);const i=this.client.details.type;this.subLogger=wt.a.create(e.services.subLogger,void 0,{all:{clientType:`${this.client.details.capabilities.interactive?"interactive":"noninteractive"}${void 0!==i&&""!==i?`/${i}`:""}`,containerId:Object(kt.a)(),docId:()=>{var e,t;return _resolvedUrl)||void 0===e?void 0:e.id)&&void 0!==t?t:void 0},containerAttachState:()=>this._attachState,containerLifecycleState:()=>this._lifecycleState,containerConnectionState:()=>jr[this.connectionState],serializedContainer:void 0!==t.serializedContainerState},error:{dmInitialSeqNumber:()=>{var e;return null===(e=this._deltaManager)||void 0===e?void 0:e.initialSequenceNumber},dmLastProcessedSeqNumber:()=>{var e;return null===(e=this._deltaManager)||void 0===e?void 0:e.lastSequenceNumber},dmLastKnownSeqNumber:()=>{var e;return null===(e=this._deltaManager)||void 0===e?void 0:e.lastoadedFromVersion)||void 0===e?void 0:e.id},containerLoadedFromVersionDate:()=>{var e;return null===(e=this.loadedFromVersion)||void 0===e?void 0:e.date},dmLastMsqSeqNumber:()=>{var e,t;return null===(t=null===(e=this.deltaManager)||void 0===e?void 0:e.lastMessage)||void 0===t?void 0:t.sequenceNumber},dmLastMsqSeqTimestamp:()=>{var e,t;return null===(t=null===(e=this.deltaManager)||void 0===e?void 0:e.lastMessage)||void 0===t?void 0:t.timestamp},dmLastMsqSeqClientId:()=>{var e,t;return null===(t=null===(e=this.deltaManager)||void 0===e?void 0:e.lastMessage)||void 0===t?void 0:t.clientId},connectionStateDuration:()=>On.now()-this.connectionTransitionTimes[this.connectionState]}}),this.mc=Object(It.c)(wt.a.create(this.subLogger,"Container"));const s=null!==(r=this.mc.config.getBoolean("Fluid.Container.summarizeProtocolTree"))&&void 0!==r?r:this.loader.services.options.summarizeProtocolTree;this.options=Object.assign(Object.assign({},this.loader.services.options),{summarizeProtocolTree:s}),this._deltaManager=this.createDeltaManager(),this._clientId=nulizedContainerState)||void 0===o?void 0:o.clientId,this.connectionStateHandler=function(e,t,n){return function(e,t,n,r){return e?new Nr(t,(e=>new Ar(e,r)),n):new Ar(t,r)}(!0===Object(It.c)(e.logger).config.getBoolean("Fluid.Container.CatchUpBeforeDeclaringConnected"),e,t,n)}({logger:this.mc.logger,connectionStateChanged:(e,t,n)=>{e===jr.Connected&&(this._clientId=this.connectionStateHandler.,n),"loaded"===this._lifecycleState&&this.propagateConnectionState(!1)},shouldClientJoinWrite:()=>this._deltaManager.connectionManager.shouldJoinWrite(),maxClientLeaveWaitTime:this.loader.services.options.maxClientLeaveWaitTime,logConnectionIssue:(e,t)=>{this._deltaManager.logConnectionIssue(Object.assign({eventName:e,durachingUp]},void 0===t?{}:{details:JSON.stringify(t)}))}},this.deltaManager,this._clientId),this.on(no,(()=>{this.connectionSta.storageService=new Tr(this.loader.services.detachedBlobStorage,this.mc.logger,!0===this.options.summarizeProtocolTree?()=>this.captureProtocolSummary():void 0),"object"==typeof document&&null!==document&&"function"==typeof document.addEventListener&&null!==document.adble=document.hidden?On.now():void 0,this.visibilityEventHandler=()=>{document.hidden?this.lastVisible=On.now():setTimeout((()=>{this.lastVisible=void 0}),0)},document.addEventListener("visibilitychange",this.visibilityEventHandler)),this.on("newListener",((e,t)=>{Promise.resolve().then((()=>{switch(e){case to:this._dirtyContainer&&t();break;case no:this._dirtyContainer||t();break;case Yn:this.connected&&t(this.clientId);break;case Zn:this.connected||t()}})).catch((e=>{this.mc.logger.sendErrorEvent({eventName:"RaiseConnectedEventError"},e)}))}))}static async load(e,t,n,r){const o=new io(e,{clientDetailsOverride:t.clientDetailsOverride,resolvedUrl:t.resolvedUrl,canReconnect:t.canReconnect,serializedContainerState:n},r);return wt.c.timedExecAsync(o.mc.logger,{eventName:"Load"},(async e=>new Promise(((r,i)=>{var s,a;const c=t.version,u={opsBeforeReturn:"cached"},l=n?Object.assign(Object.assign({},null!==(s=t.loadMode)&&void 0!==s?s:u),{opsBeforeReturn:void 0}?a:u,d=e=>{i(null!=e?e:new kn("Container closed without error during load"))};o.on("closed",d),o.load(c,l,n).finally((()=>{o.removeListener("closed",d)})).then((n=>{e.end(Object.assign(Object.assign({},n),t.loadMode)),r(o)}),(e=>{const t=Object(At.h)(e);o.close(t),d(t)}))}))),{start:!0,end:!0,cancel:"generic"})}static async createDetached(e,t,n){const r=new io(e,{},n);return wt.c.timedExecAsync(r.mc.logger,{eventName:"CreateDetached"},(async e=>(await r.createDetached(t),r)),{start:!0,end:!0,cancel:"generic"})}static async rehydrateDetachedFromSnapshot(e,t,n){const r=new io(e,{},n);return wt.c.timedExecAsync(r.mc.logger,{eventName:"RehydrateDetachedFromSnapshot"},(async e=>{const n=JSON.parse(t);return await r.rehydrateDetachedFromSnapshot(n)&(this.propagateConnectionState(!0),this._lifecycleState="loaded")}get closed(){return"closing"===this._lifecycleState||"closed"===this._lifecycleState}get storage(){return this.storageService}get context(){if(void 0===this._context)throw new kn("Attempted to access context before it was defined");return this._context}get protocolHandler(){if(void 0===this._protocolHandler)throw new Error("Attempted to access protocolHandler before it was defined");return this._protocolHandler}get connectionMode(){return this._deltaManager.connectionManager.connectionMode}get IFluidRouter(){return this}get resolvedUrl(){return this._resolvedUrl}get loadedFromVersion(){return tOnlyInfo}get closeSignal(){return this._deltaManager.closeAbortController.signal}forceReadonly(e){this._deltaManager. connectionState(){return this.connectionStateHandler.connectionState}get connected(){return this.connectionStateHandler.connectionState===jr.Connected}get serviceConfiguration(){return this._deltaManager.serviceConfiguration}get clientId(){return this._clientId}get scopes(){return this._deltaManager.connectionManager.scopes}get clientDetails(){return this._deltaManager.clientDetails}getSpecifiedCodeDetails(){return this.getCodeDetailsFromQuorum()}getLoadedCodeDetails(){var e;return null===(e=this._context)||void 0===e?void 0:e.codeDetails}get audience(){return this.protocolHandler.audience}get isDirty(){return this._dirtyContainer}get serviceFactory(){return this.loader.services.documentServiceFactory}get urlResolver(){return this.loader.services.urlResolver}get scope(){return this.loader.services.scope}get codeLoader(){return this.loader.services.codeLoader}getQuorum(){return this.protocolHandler.quorum}close(e){this._deltaManager.close(e),Cn(this.connectionState===jr.Disconnected,207),Cn("closed"===this._lifecycleState,788)}closeCore(e){var t,n,r;Cn(!this.closed,789);try{try{this.mc.logger.sendTelemetryEvent({eventName:"ContainerClose",category:void 0===e?"generic":"error"},e),this._lifecycleState="closing",null===(t=this._protocolHandler)||void 0===t||t.close(),this.connectionStateHandler.dispose(),null===(n=this._context)||void 0===n||n.dispose(void 0!==e?new Error(e.message):void 0),this.storageService.dispose(),null===(r=this.service)||void 0===r||r.dispose(e)}catch(e){this.mc.logger.sendErrorEvent({eventName:"ContainerCloseException"},e)}this.emit("closed",e),this.removeAllListeners(),void 0!==this.visibilityEventHandler&&document.removeEventListener("visibilitychange",this.visibilityEventHandler)}finally{this._lifecycleState="closed"}}closeAndGetPendingLocalState(){Cn(this.attachState===Xt.Attached,209),Cn(void 0!==this.resolvedUrl&&"fluid"===this.resolvedUrl.type,210),Cn(!!this._protocolHandler,739),Cn(void 0!==this._protocolHandler.attributes.term,894);const e={pendingRuntimeState:this.context.getPendingLocalState(),url:this.resolvedUrl.url,protocol:this.protocolHandler.getProtocolState(),term:this._protocolHandler.attributes.term,clientId:this.clientId};return this.mc.logger.sendTelemetryEvent({eventName:"CloseAndGetPendingLocalState"}),this.close(),JSON.stringify(e)}get attachState(){return this._attachState}serialize(){Cn(this.attachState===Xt.Detached,211);const e=Pn(this.context.createSummary(),this.captureProtocolSummary());return this.loader.services.detachedBlobStorage&&this.loader.services.detachedBlobStorage.size>0&&(e.tree[".hasAttachmentBlobs"]={type:An.Blob,content:"true"}),JSON.stringify(e)}async attach(e){await wt.c.timedExecAsync(this.mc.logger,{eventName:"Attach"},(async()=>{if("loaded"!==this._lifecycleState)throw new _n(`The Container is not in a valid state for attach [${this._lifecycleState}]`);Cn(this._attachState===Xt.Detached&&!this.attachStarted,517),this.attachStarted=!0;const t=void 0!==this.loader.services.detachedBlobStorage&&this.loader.services.detachedBlobStorage.size>0;try{let n;if(Cn(0===this.deltaManager.inbound.length,214),!t){const e=this.context.createSummary(),t=this.captureProtocolSummary();n=Pn(e,t),this._attachState=Xt.Attaching,this.context.notifyAttaching(Mr(n))}const r=await this.urlResolver.resolve(e);mn(r),void 0===this.service&&(Cn(this.client.details.type!==oo,708),this.service=await zn((async()=>this.serviceFactory.createContainer(n,r,this.subLogger,!1)),"containerAttach",this.mc.logger,{cancel:this.closeSignal}));const o=this.service.resolvedUrl;if(mn(o),this._resolvedUrl=o,await this.storageService.connectToService(this.service),t){Cn(!!this.loader.services.detachedBlobStorage=new Map;for(;e.size<this.loader.services.detachedBlobStorage.size;){const t=this.loader.services.detachedBlobStorage.getBlobIds().filter((t=>!e.has(t)));for(const n of t){const t=await this.loader.services.detachedBlobStorage.readBlob(n),r=await this.storageService.createBlob(t);e.set(n,r.id)}}const t=this.context.createSummary(e),r=this.captureProtocolSummary();n=Pn(t,r),this._attachState=Xt.Attaching,this.context.notifyAttaching(Mr(n)),await this.storageService.uploadSummaryWithContext(n,{referenceSequenceNumber:0,ackHandle:void 0,proposalHandle:void 0})}this._attachState=Xt.Attached,this.emit("attached"),this.closed||this.resumeInternal({fetchOpsFromStorage:!1,reason:"createDetached"})}catch(e){const t=Object(At.h)(e),n=this.resolvedUrl;throw pn(n)&&t.addTelemetryProperties({resolvedUrl:n.url}),this.close(t),t}}),{start:!0,end:!0,cancel:"generic"})}async request(e){return wt.c.timedExecAsync(this.mc.logger,{eventName:"Request"},(async()=>this.context.request(e)),{end:!0,cancel:"error"})}setAutoReconnectInternal(e){if(this._deltaManager.connectionManager.reconnectMode===e)return;const t=On.now(),n=t-this.setAutoReconnectTime;this.setAutoReconnectTime=t,this.mc.logger.sendTelemetryEvent({eventName:e===er.Enabled?"AutoReconnectEnabled":"AutoReconnectDisabled",connectionMode:this.connectionMode,connectionState:jr[this.connectionState],duration:n}),this._deltaManager.connectionManager.setAutoReconnect(e)}connect(){if(this.closed)throw new _n("The Container is closed and cannot be connected");if(this._attachState!==Xt.Attached)throw new _n("The Container is not attached and cannot be connected");this.connected||this.connectInternal({reason:"DocumentConnect",fetchOpsFromStorage:!1})}cooReconnectInternal(er.Enabled)}disconnect(){if(this.closed)throw new _n("The Container is closed and cannot be disconnected");this.disconnectInternal()}disconnectInternal(){Cn(!this.closed,711),this.setAutoReconnectInternal(er.Disabled)}resumeInternal(e){Cn(!this.closed,217),this.inboundQueuePausedFromInit&&(this.inboundQueuePausedFromInit=!1,this._deltaManager.inbound.resume(),this._deltaManager.inboundSignal.resume()),this.connectToDeltaStream(e)}async getAbsoluteUrl(e){var t;if(void 0!==this.resolvedUrl)return this.urlResolver.getAbsoluteUrl(this.resolvedUrl,e,(e=>{let t;return t=e&&"name"in e?e:Object(Xe.b)(null==e?void 0:e.package)?null==e?void 0:e.package.name:null==e?void 0:e.package,{name:t}})(null===(t=this._context)||void 0===t?void 0:t.codeDetails))}async proposeCodeDetails(e){if(!Object(Xe.a)(e))throw new Error("Provided codeDetails are not IFluidCodeDetails");if(this.codeLoader.IFluidCodeDetailsComparer){const t=await this.codeLoader.IFluidCodeDetailsComparer.compare(e,this.getCodeDetailsFromQuorum());if(void 0!==t&&t<=0)throw new Error("Proposed code details should be greater than the current")}return this.protocolHandler.quorum.propose("code",e).then((()=>!0)).catch((()=>!1))}async processCodeProposal(){const e=this.getCodeDetailsFromQuorum();if(await Promise.all([this.deltaManager.inbound.pause(),this.deltaManager.inboundSignal.pause()]),!0===await this.context.satisfies(e))return this.deltaManager.inbound.resume(),void this.deltaManager.inboundSignal.resume();this.close(new kn("Existing context does not satisfy incoming proposal"))}async getVersion(e){return(await this.storageService.getVersions(e,1))[0]}recordConnectStartTime(){void 0===this.connectionTransitionTimes[jr.Disconnected]&&(this.connectionTransitionTimes[jr.Disconnected]=On.now())}connectToDeltaStream(e){this.recordConnectStartTime(),this._canReconnect&&this.client.details.capabilities.interactive||(e.mode="write"),this._deltaManager.connect(e)}async load(e,t,n){if(void 0===this._resolvedUrl)throw new Error("Attempting to load without a resolved url");this.service=await this.serviceFactory.createDocumentService(this._resolvedUrl,this.subLogger,this.client.details.type===oo),void 0===t.deltaConnection&&this.connectToDeltaStream({reason:"DocumentOpen",mode:"write",fetchOpsFromStorage:!1}),n?this.storageService.connectToService(this.service).catch((e=>this.close(e))):await this.storageService.connectToService(this.service),this._attachState=Xt.Attached;const{snapshot:r,versionId:o}=void 0===n?await this.fetchSnapshotTree(e):{snapshot:void 0,versionId:void 0};Cn(void 0!==r||void 0!==n,567);const i=void 0===n?await this.getDocumentAttributes(this.storageService,r):{sequenceNumber:n.protocol.sequenceNumber,minimumSequenceNumber:n.protocol.minimumSequenceNumber,term:n.term};let s;switch(t.opsBeforeReturn){case void 0:this.attachDeltaManagerOpHandler(i,"none"!==t.deltaConnection?"all":"none");break;case"cached":s=this.attachDeltaManagerOpHandler(i,"cached");break;case"all":s=this.attachDeltaManagerOpHandler(i,"all");break;default:Tn(t.opsBeforeReturn)}void 0===n?await this.initializeProtocolStateFromSnapshot(i,this.storageService,r):this.initializeProtocolState(i,{members:n.protocol.members,proposals:n.protocol.proposals,values:n.protocol.values});const a=this.getCodeDetailsFromQuorum();if(await this.instantiateContext(!0,a,r,null==n?void 0:n.pendingRuntimeState),!this.closed)switch(void 0!==s&&(this._deltaManager.inbound.resume(),await ro(this.mc.logger,"WaitOps",(async()=>(await s,{}))),await ro(this.mc.logger,"WaitOpProcessing",(async()=>this._deltaManager.inbound.waitTillProcessingDone())),this._deltaManager.inbound.pause()),t.deltaConnection){case void 0:case"delayed":Cn(this.inboundQueuePausedFromInit,838),this.inboundQueuePausedFromInit=!1,this._deltaManager.inbound.resume(),this._deltaManager.inboundSignal.resume();break;case"none":break;default:Tn(t.deltaConnection)}if(this.closed)throw new Error("Container was closed while load()");return this.setLoaded(),{sequenceNumber:i.sequenceNumber,version:o,dmLastProcessedSeqNumber:this._deltaManager.lastSequenceNumber,dmLastKnownSeqNumber:this._deltaManager.lastKnownSeqNumber}}async createDetached(e){const t={sequenceNumber:0,term:1,minimumSequenceNumber:0};await this.attachDeltaManagerOpHandler(t);const n=Ur(e);this.initializeProtocolState(t,{members:[],proposals:[],values:n}),await this.instantiateContextDetached(!1),this.setLoaded()}async rehydrateDetachedFromSnapshot(e){void 0!==e.tree[".hasAttachmentBlobs"]&&(Cn(!!this.loader.services.detachedBlobStorage&&this.loader.services.detachedBlobStorage.size>0,592),delete e.tree[".hasAttachmentBlobs"]);const t=Mr(e);this.storageService.loadSnapshotForRehydratingContainer(t);const n=await this.getDocumentAttributes(this.storageService,t);await this.attachDeltaManagerOpHandler(n);const r=Rr(t),o=function(e){const t=new Map(e).get("code");return Cn(void 0!==t,732),null==t?void 0:t.value}(await Qn(this.storageService,r.blobs.quorumValues));this.initializeProtocolState(n,{members:[],proposals:[],values:void 0!==o?Ur(o):[]}),await this.instantiateContextDetached(!0,t),this.setLoaded()}async getDocumentAttributes(e,t){if(void 0===t)return{minimumSequenceNumber:0,sequenceNumber:0,term:1};const n=".protocol"in t.trees?t.trees[".protocol"].blobs.attributes:t.blobs[".attributes"],r=await Qn(e,n);return void 0===r.term&&(r.term=1),r}async initializeProtocolStateFromSnapshot(e,t,n){const r={members:[],proposals:[],values:[]};if(void 0!==n){const e=Rr(n);[r.members,r.proposals,r.values]=await Promise.all([Qn(t,e.blobs.quorumMembers),Qn(t,e.blobs.quorumProposals),Qn(t,e.blobs.quorumValues)])}this.initializeProtocolState(e,r)}initializeProtocolState(e,t){var n,r;const o=(null!==(n=this.protocolHandlerBuilder)&&void 0!==n?n:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new eo(...t,new or)})(e,t,((e,t)=>this.submitMessage(Jn.Propose,JSON.stringify({key:e,value:t}))),ients)&&void 0!==r?r:[]);this._initialClients=void 0;const i=wt.a.create(this.subLogger,"ProtocolHandler");o.quorum.on("error",(e=>{i.sendErrorEvent(e)})),this.connectionStateHandler.initProtocol(o),o.quorum.on("addProposal",(e=>{"code"!==e.key&&"code2"!==e.key||this.emit("codeDetailsProposed",e.value,e)})),o.quorum.on("approveProposal",((e,t,n)=>{"code"!==t&&"code2"!==t||(Object(Xe.a)(n)||this.mc.logger.sendErrorEvent({eventName:"CodeProposalNotIFluidCodeDetails"}),this.processCodeProposal().catch((e=>{throw this.close(Object(At.h)(e)),e})))})),this._protocolHandler=o}captureProtocolSummary(){const e=this.protocolHandler.snapshot();return{tree:{attributes:{content:JSON.stringify(this.protocolHandler.attributes),type:An.Blob},quorumMembers:{content:JSON.stringify(e.members),type:An.Blob},quorumProposals:{content:JSON.stringify(e.proposals),type:An.Blob},quorumValues:{content:JSON.stringify(e.values),type:An.Blob}},type:An.Tree}}getCodeDetailsFromQuorum(){return(e=>{var t;return null!==(t=e.get("code"))&&void 0!==t?t:e.get("code2")})(this.protocolHandler.quorum)}get client(){var e;const t=void 0!==(null===(e=this.options)||void 0===e?void 0:e.client)?this.options.client:{details:{capabilities:{interactive:!0}},mode:"read",permission:[],scopes:[],user:{id:""}};return void 0!==this.clientDetailsOverride&&wn()(t.details,this.clientDetailsOverride),t.details.environment=[t.details.environment," loaderVersion:2.0.0-internal.1.4.6"].join(";"),t}activeConnection(){return this.connectionState===jr.Connected&&"write"===this.connectionMode}createDeltaManager(){const e=()=>this.service,t=new gr(e,wt.a.create(this.subLogger,"DeltaManager"),(()=>this.activeConnection()),(t=>new $r(e,this.client,this._canReconnect,wt.a.create(this.subLogger,"ConnectionManager"),t)));return t.inbound.pause(),t.inboundSignal.pause(),t.on("connect",((e,t)=>{var n;if(void 0===this._protocolHandler)this._initialClients=e.initialClients;else{this._protocolHandler.audience.clear();for(const t of null!==(n=e.initialClients)&&void 0!==n?n:[])this._protocolHandler.audience.addMember(t.clientId,t.client)}this.connectionStateHandler.receivedConnectEvent(this.connectionMode,e)})),t.on("disconnect",(e=>{var t;null===(t=this.collabWindowTracker)||void 0===t||t.stopSequenceNumberUpdate(),this.connectionStateHandler.receivedDisconnectEvent(e)})),t.on("throttled",(e=>{const t=e;!0!==t.logged&&this.logContainerError(t),this.emit("warning",t)})),t.on("readonly",(e=>{this.setContextConnectedState(this.connectionState===jr.Connected,e),this.emit("readonly",e)})),t.on("closed",(e=>{this.closeCore(e)})),t}async attachDeltaManagerOpHandler(e,t){var n;return this._deltaManager.attachOpHandler(e.minimumSequenceNumber,e.sequenceNumber,null!==(n=e.term)&&void 0!==n?n:1,{process:e=>this.processRemoteMessage(e),processSignal:e=>{this.processSignal(e)}},t)}logConnectionStateChangeTelemetry(e,t,n){var r;const o=On.now();this.connectionTransitionTimes[e]=o;const i=o-this.connectionTransitionTimes[t];let s,a,c,u,l;e===jr.Disconnected?c=this._deltaManager.connectionManager.reconnectMode:(e===jr.Connected?(s=o-this.connectionTransitionTimes[jr.Disconnected],s=wt.e.formatTick(s)):(u=this.deltaManager.lastKnownSeqNumber,this.deltaManager.hasCheckpointSequenceNumber&&(l=u-this.deltaManager.lastSequenceNumber)),a=this.firstConnection?"InitialConnect":"AutoReconnect"),this.mc.logger.sendPerformanceEvent(Object.assign({eventName:`ConnectionStateChange_${jr[e]}`,from:jr[t],duration:i,durationFromDisconnected:s,reason:n,connectionInitiationReason:a,pendingClientId:this.connectionStateHandler.pendingClientId,clientId:this.clientId,autoReconnect:c,opsBehind:l,online:Ln[Mn()],lastVisible:void 0!==this.lastVisible?On.now()-this.lastVisible:void 0,checkpointSequenceNumber:u,quorumSize:null===(r=this._protocolHandler)||void 0===r?void 0:r.quorum.getMembers().size},this._deltaManager.connectionProps)),e===jr.Connected&&(this.firstConnection=!1)}propagateConnectionState(e){var t;if(!e&&this.connectionState!==jr.Connected&&this.connectionState!==jr.Disconnected)return;const n=this.connectionState===jr.Connected,r=this.connectionState===jr.Connected&&!this.firstConnection&&"write"===this.connectionMode;r&&(this.messageCountAfterDisconnection=0),this.setContextConnectedState(n,null!==(t=this._deltaManager.connectionManager.readOnlyInfo.readonly)&&void 0!==t&&t),this.protocolHandler.setConnectionState(n,this.clientId),function(e,t,n,r){try{n?t.emit(Yn,r):t.emit(Zn)}catch(t){e.sendErrorEvent({eventName:"RaiseConnectedEventError"},t)}}(this.mc.logger,this,n,this.clientId),r&&this.mc.logger.sendTelemetryEvent({eventName:"OpsSentOnReconnect",count:this.messageCountAfterDisconnection})}submitContainerMessage(e,t,n,r){switch(e){case Jn.Operation:return this.submitMessage(e,JSON.stringify(t),n,r);case Jn.Summarize:return this.submitSummaryMessage(t);default:return this.close(new kn("invalidContainerSubmitOpType",void 0,{messageType:e})),-1}}submitBatch(e){let t=-1;for(const n of e)t=this.submitMessage(Jn.Operation,n.contents,!0,n.metadata);return this._deltaManager.flush(),t}submitSummaryMessage(e){return void 0===e.details&&(e.details={}),e.details.includesProtocolTree=!0===this.options.summarizeProtocolTree,this.submitMessage(Jn.Summarize,JSON.stringify(e),!1)}submitMessage(e,t,n,r){var o;return this.connectionState!==jr.Connected?(this.mc.logger.sendErrorEvent({eventName:"SubmitMessageWithNoConnection",type:e}),-1):(this.messageCountAfterDisconnection+=1,null===(o=this.collabWindowTracker)||void 0===o||o.stopSequenceNumberUpdate(),this._deltaManager.submit(e,t,n,r))}processRemoteMessage(e){const t=this.clientId===e.clientId,n=this.protocolHandler.processMessage(e,t);this.context.process(e,t,void 0),this.activeConnection()&&(void 0===this.collabWindowTracker&&(Cn(void 0!==this.serviceConfiguration,740),this.collabWindowTracker=new Wr((e=>{Cn(this.activeConnection(),577),this.submitMessage(e,null)}),this.serviceConfiguration.noopTimeFindowTracker.scheduleSequenceNumberUpdate(e,!0===n.immediateNoOp)),this.emit("op",e)}submitSignal(e){this._deltaManager.submitSignal(JSON.stringify(e))}processSignal(e){null===e.clientId?this.protocolHandler.processSignal(e):this.context.processSignal(e,this.clientId===e.clientId)}async fetchSnapshotTree(e){var t;const n=await this.getVersion(null!=e?e:null);void 0===n&&void 0!==e&&this.mc.logger.sendErrorEvent({eventName:"NoVersionFoundWhenSpecified",id:e}),this._loadedFromVersion=n;const r=null!==(t=await this.storageService.getSnapshotTree(n))&&void 0!==t?t:void 0;return void 0===r&&void 0!==n&&this.mc.logger.sendErrorEvent({eventName:"getSnapshotTreeFailed",id:n.id}),{snapshot:r,versionId:null==n?void 0:n.id}}async instantiateContextDetached(e,t){const n=this.getCodeDetailsFromQuorum();if(void 0===n)throw new Error("pkg should be provided in create flow!!");await this.instantiateContext(e,n,t)}async instantiateContext(e,t,n,r){var o;Cn(!1!==(null===(o=this._context)||void 0===o?void 0:o.disposed),221);const i=new ao(thiad(this,this.scope,this.codeLoader,t,n,new yr(this._deltaManager),new Br(this.protocolHandler.quorum),i,((e,t,n,r)=>this.submitContainerMessage(e,t,n,r)),(e=>this.submitSummaryMessage(e)),(e=>this.submitBatch(e)),(e=>this.submitSignal(e)),(e=>this.close(e)),io.version,(e=>this.updateDirtyContainerState(e)),e,r),this.emit("contextChanged",t)}updateDirtyContainerState(e){this._dirtyContainer!==e&&(this._dirtyContainer=e,this.emit(e?to:no))}logContainerError(e){this.mc.logger.sendErrorEvent({eventName:"ContainerWarning"},e)}setContextConnectedState(e,t){var n;!1===(null===(n=this._context)||void 0===n?void 0:n.disposed)&&this.context.setConnectionState(e&&!t,this.clientId)}}function so(e){return void 0===e.headers||!1!==e.headers[cn.cache]}io.version="^0.1.0";class ao{constructor(e,t){this.container=e,this.loader=t}get IFluidRouter(){return this}async resolve(e){var t,n,r,o,i;if(e.url.startsWith("/")){if(so(e))return this.container;{const s=this.container.resolvedUrl;return mn(s),await io.load(this.loader,{canReconnect:null===(t=e.headers)||void 0===t?void 0:t[cn.reconnect],clientDetailsOverride:null===(n=e.headers)||void 0===n?void 0:n[cn.clientDetails],resolvedUrl:Object.assign({},s),version:null!==(o=null===(r=e.headers)||void 0===r?void 0:r[cn.version])&&void 0!==o?o:void 0,loadMode:null===(i=e.headers)||void 0===i?void 0:i[cn.loadMode]})}}if(void 0===this.loader)throw new Error("Cannot resolve external containers");return this.loader.resolve(e)}async request(e){return e.url.startsWith("/")?(await this.resolve(e)).request(e):void 0===this.loader?{status:404,value:"Cannot request external containers",mimeType:"plain/text"}:this.loader.request(e)}}function co(e){const t=Object.create(e),n=new Map;return t.resolve=async t=>so(t)?(n.has(t.url)||n.set(t.url,e.resolve(t)),n.get(t.url)):e.resolve(t),t}class uo{constructor(e){var t,n;this.containers=new Map;const r=Object.assign({},e.scope);!1!==(null===(t=e.options)||void 0===t?void 0:t.provideScopeLoader)&&(r.ILoader=this);const o={loaderId:Object(kt.a)(),loaderVersion:"2.0.0-internal.1.4.6"},i=Object(It.d)(fn.mixinDebugLogger("fluid:telemetry",e.logger,{all:o}),It.e.value,e.configProvider);this.services={urlResolver:co(gn.create(e.urlResolver)),documentServiceFactory:bn.create(e.documentServiceFactory),codeLoader:e.codeLoader,options:null!==(n=e.options)&&void 0!==n?n:{},scope:r,subLogger:i.logger,detachedBlobStorage:e.detachedBlobStorage},this.mc=Object(It.c)(wt.a.create(this.services.subLogger,"Loader")),this.protocolHandlerBuilder=e.protocolHandlerBuilder}get IFluidRouter(){return this}async createDetachedContainer(e){const t=await io.createDetached(this,e,this.protocolHandlerBuilder);return this.caid,Promise.resolve(t))})),t}async rehydrateDetachedContainerFromSnapshot(e){return io.rehydrateDetachedFromSnapshot(this,e,this.protocolHandlerBuilder)}async resolve(e,t){return wt.c.timedExecAsync(this.mc.logger,{eventName:void 0===t?"Resolve":"ResolveWithPendingState"},(async()=>(await this.resolveCore(e,void 0!==t?JSON.parse(t):void 0)).container))}async request(e){return wt.c.timedExecAsync(this.mc.logger,{eventName:"Request"},(async()=>{const t=await this.resolveCore(e);return t.container.request(Object.assign(Object.assign({},e),{url:`${t.parsed.path}${t.parsed.query}`}))}))}getKeyForContainerCache(e,t){var n;return void 0!==(null===(n=e.headers)||void 0===n?void 0:n[cn.version])?``:t.id}addToContainerCache(e,t){this.containers.set(e,t),t.then((t=>{t.closed?this.containers.delete(e):t.once("closed",(()=>{this.containers.delete(e)}))})).catch((e=>{}))}async resolveCore(e,t){const n=await this.services.urlResolver.resolve(e);mn(n);const r=xr(n.url);if(void 0===r)throw new Error(`Invalid URL ${n.url}`);if(void 0!==t){const e=xr(t.url);if((null==e?void 0:e.id)!==r.id||(null==e?void 0:e.path.replace(/\/$/,""))!==r.path.replace(/\/$/,""))throw new Error(`URL ${n.url} does not match pending state URL ${t.url}`)}const{canCache:o,fromSequenceNumber:i}=this.parseHeader(r,e);let s;if(void 0===t&&o){const t=this.getKeyForContainerCache(e,r),o=await this.containers.get(t);if(void 0!==o)s=o;else{const r=this.loadContainer(e,n);this.addToContainerCache(t,r),s=await r}}else s=await this.loadContainer(e,n,t);return s.deltaManager.lastSequenceNumber<=nction t(n){n.sequenceNumber>i&&(e(),s.removeListener("op",t))}))})),{container:s,parsed:r}}get cachingEnabled(){return!1!==this.services.options.cache}canCacheForRequest(e){return this.cachingEnabled&&!1!==e[cn.cache]}parseHeader(e,t){var n,r;let o=-1;t.headers=null!==(n=t.headers)&&void 0!==n?n:{};const i=t.headers[cn.sequenceNumber];return void 0!==i&&(o=i),t.headers[cn.version]=null!==(r=e.version)&&void 0!==r?r:t.headers[cn.version],{canCache:this.canCacheForRequest(t.headers),fromSequenceNumber:o}}async loadContainer(e,t,n){var r,o,i,s,a;return io.load(this,{canReconnect:null===(r=e.headers)||void 0===r?void 0:r[cn.reconnect],clientDetailsOverride:null===(o=e.headers)||void 0===o?void 0:o[cn.clientDetails],resolvedUrl:t,version:null!==(s=null===(i=e.headers)||void 0===i?void 0:i[cn.version])&&void 0!==s?s:void 0,loadMode:null===(a=e.headers)||void 0===a?void 0:a[cn.loadMode]},n,this.protocolHandlerBuilder)}}var lo=n("tSac"),ho=n("OfNt"),fo=n("Iz5H"),po=n("n/4l"),mo=n("DgHk"),go=n("k8nI"),vo=n("graM"),bo=n("aFvx"),yo=n("obr3");const wo="codeLoaderStorage";function Co(){return Object(yo.b)("fluidCodeLoaderCache",1,{async upgrade(e,t){e.createObjectStore(wo).createIndex("lastUpdatedTime","lastUpdatedTime")},blocked:()=>{throw new Error("Could not open code loader cache DB since it is blocked by an older client that has the DB open")}})}function Oo(e){return`${e.packageName}_${e.containerEnvironment}`}function To(e,t){return void 0===e.find((e=>!function(e,t){const n=new URL(e);return t.includes(n.origin)}(e,t)))}async function So(e,t){try{const n=await Co();await n.delete(wo,Oo({packageName:e,containerEnvironment:t})),n.close()}catch(e){}}function ko(e,t,n,r,o){const{getLatestContainerCodeDetails:i,upgradeNeeded:s,preCacheContainerCode:a}=n,c=n=>function(e,t,n,r,o,i){const s=r(n),a=s.then((async r=>{const s=await Co(),a=Oo({packageName:t,containerEnvironment:n}),c=await s.get(wo,a);c&&c.codeDetailsPackage.version===r.fluidCodeDetailsOverride.package.version||o(e,r,i),await s.put(wo,{codeDetailsPackage:r.fluidCodeDetailsOverride.package,lastUpdatedTime:Date.now()},a),s.close()})).catch((()=>{}));return{codePackagePromise:s.then((e=>({...e.fluidCodeDetailsOverride.package,maxUnsupportedVersion:e.maxUnsupportedContainerScriptVersion}))),cacheUpdatePromise:a}}(e,t,n,i,a,o);return{getCodeDetailsPackage:(e,n)=>async function(e,t,n,r,o){const i=Object(Wt.b)(),s=Ke.a.start("GetCodeDetailsPackage",o,{addUserTiming:!0}),a=async function(e,t,n){try{const r=await Co(),o=await r.get(wo,Oo({packageName:e,containerEnvironment:t}));if(r.close(),o){const r=Date.now()-o.lastUpdatedTime;return r>6048e5?{metadata:{cacheStatus:"expired",cacheAge:r},codeDetails:void 0}:To(o.codeDetailsPackage.fluid.browser.umd.files,n)?{metadata:{cacheStatus:"hit",cacheAge:r},codeDetails:o.codeDetailsPackage}:(So(e,t).catch((()=>{})),{metadata:{cacheStatus:"unsafe"},codeDetails:void 0})}}catch(e){}return{metadata:{cacheStatus:"miss"},codeDetails:void 0}}(e,t,n).then((e=>({method:"cache",cacheDetails:e}))),u=(e=>c(e).codePackagePromise)(t).then((e=>({method:"network",codeDetails:e}))),l=await Promise.race([a,u]);let d={documentEverHidden:Object(Wt.a)(i,!0)>-1};if("cache"===l.method){const{cacheDetails:e}=l;if(d={...d,...e.metadata},e.codeDetails)return s.setResult(!0,{method:"cache",...d}),e.codeDetails}return u.then((e=>(s.setResult(!0,{method:"network",...d}),e.codeDetails)))}(t,e,n,0,r),upgradeNeeded:async(e,n)=>{if(!s)return!1;const r=await s(e,n);return r&&(await So(t,e),c(e)),r},preCacheLatestContainerCode:async e=>await c(e).cacheUpdatePromise}}function Eo(e,t){const n=e.document,r=n.createDocumentFragment();t.forEach((e=>{const t=n.createElement("link");t.rel="prefetch",t.href=e,e.endsWith(".js")?(t.as="script",t.crossOrigin="anonymous",r.appendChild(t)):e.endsWith(".css")&&(t.as="style",r.appendChild(t))})),n.head.appendChild(r)}function _o(e,t,n){let r=t.preload.manifest;const o=[...r.assets];if(r.localizedAssets){const e=Object(Kt.c)(n),t=r.localizedAssets[e];t&&o.push(...t)}Eo(e,o.map((e=>`${t.preload.jsBaseUrl}/${e}`)))}async function jo(e){const t=await Object(vo.a)(e,{method:"GET",cache:"reload"},{maxRetries:3,filter:Object(vo.c)([709,710]),backoffFn:Object(bo.b)(500)});if(t.result.ok)return t.result.json();throw new Error(`getCodeLoadDetailsFromNetwork: Failed to fetch: ${e} ; StatusCode: ${t.result.status}`)}function Io(e){return!isNaN(e)&&isFinite(e)}const No=(e,t,n,r,o)=>ko(e,t,{getLatestContainerCodeDetails:n,preCacheContainerCode:_o,upgradeNeeded:async(e,t)=>{try{const r=await n(e);return function(e,t,n){const r=parseFloat(e);if(!Io(r))return!1;const o=parseFloat(t);if(!Io(o))return!1;const i=parseFloat(n);return!!(Io(i)&&r>i)||r<=o}(t,r.maxUnsupportedContainerScriptVersion,r.fluidCodeDetailsOverride.package.version)}catch(e){return!1}}},r,o),Ao=e=>{var t,n,r,o,i,s;return Object(Xe.b)(e)&&"string"==typeof(null===(r=null===(n=null===(t=null==e?void 0:e.fluid)||void 0===t?void 0:t.browser)||void 0===n?void 0:n.umd)||void 0===r?void 0:r.library)&&Array.isArray(null===(s=null===(i=null===(o=null==e?void 0:e.fluid)||void 0===o?void 0:o.browser)||void 0===i?void 0:i.umd)||void 0===s?void 0:s.files)};var Po=n("MpdP");const xo=e=>{switch(e){case mo.e:case mo.d:case"@msstream/experiences-fluid-embed":case"@office-start/space-container":case mo.f:case mo.c:case mo.a:case mo.b:return e;default:return"(redacted)"}},Do=new Map,Lo="0.0.1",Mo=e=>!Number.isNaN(e)&&Number.isFinite(e),Ro=e=>"string"!=typeof e.package&&(e=>!!Ao(e)&&(e.version===Lo||Mo(Number(e.version))))(e.package)?{name:e.package.name,version:e.package.version===Lo?Lo:Number(e.package.version)}:void 0;class Fo{constructor(e,t){this.wrappedFactory=e,this.config=t}get IRuntimeFactory(){return this}instantiateRuntime(e,t){return this.wrappedFactory.configure(this.config),this.wrappedFactory.instantiateRuntime(e,t)}}class Bo{constructor(e){this.config=e,this.actualCodeDetailsMap=new Map}get IFluidCodeDetailsComparer(){return this}tryFormActualCodeDetailsMapKey(e){const t=Ro(e);if(void 0!==t)return`${t.version}|${t.name}`}getActualCodeDetails(e){const t=this.tryFormActualCodeDetailsMapKey(e);return void 0===t?void 0:this.actualCodeDetailsMap.get(t)}async load(e,t){var n;const r=(e=>"string"==typeof e.package?e.package:e.package.name)(e),o=e.config,{windowContext:i,getBundledPackageFactoryOverride:s,disableCdnCodeLoadingFallback:a}=this.config;let c=Do.get(i);const u=null===(n=c)||void 0===n?void 0:n.get(r);if(void 0!==u){const t=await u,n=t.fluidExport.ConfigurableRuntimeFactory;return void 0!==n?{module:{fluidExport:new Fo(n,o)},details:e}:{module:t,details:e}}let l=null==s?void 0:s(r);if(!l){if(a)throw new Error(`CDN code loading fallback set to false but no factory provided by host for container named ${xo(r)}`);t&&Object(Ye.c)(t,{eventName:"CodeLoaderFallbackToCDN",containerType:xo(r)}),l=this.loadInternal(e,t)}c||(c=new Map,Do.set(i,c),i!==window&&i.addEventListener("unload",(()=>{Do.delete(i)}))),c.set(r,l),l.catch((()=>c.delete(r)));const d=await l,h=d.fluidExport.ConfigurableRuntimeFactory;return void 0!==h?{module:{fluidExport:new Fo(h,o)},details:e}:{module:d,details:e}}async loadInternal(e,t){const{windowContext:n,trustedTypesPolicy:r,allowedCodeOrigins:o,getFluidCodeVersionDetails:i}=this.config,s=await this.getEffectiveFluidCodeDetailsPackage(e);if(t&&Object(Ye.c)(t,{eventName:"FluidCodeDetails",subCategory:"FluidCodeDetails",containerType:xo(s.name),codeVersion:s.version}),void 0===s)throw new Error(`Failed to get Fluid Package. Trying to load ContainerType: ${xo(e.package.name)}`);const a=s.fluid.browser.umd;if(!this.shouldLoad(a.files))throw new Error("Unsupported container files, check that CDN is on allow list");const c=this.tryFormActualCodeDetailsMapKey(e);if(void 0!==c&&"string"!=typeof e.package){const t={...e...s}};this.actualCodeDetailsMap.set(c,t)}const u=r&&{trustedTypesPolicy:await r,allowedOrigins:o};await Promise.all(a.files.map((e=>Object(Po.a)(n,e,u))));const l=n[a.library];if(void 0===l)throw new Error(`Entry point of loaded package not a Fluid module. Trying to load ContainerType: ${xo(e.package.name)}`);const{CodeVersionDetailsProvider:d}=l.fluidExport;if(d){const e=null==i?void 0:i(s);e&&d.setCodeVersionDetails(e)}return l}async preCache(e){const{getFluidCodeDetailsPackageOverride:t,windowContext:n}=this.config;if(t){const r=await t(e);if(r){const e=r.fluid.browser.umd;if(!this.shouldLoad(e.files))throw new Error("Unsupported container files, check that CDN is on allow list");Eo(n,e.files)}}}async getEffectiveFluidCodeDetailsPackage(e){var t,n;const r="string"==typeof e.package?e.package:e.package.name,o=await(null===(t=(n=this.config).getFluidCodeDetailsPackageOverride)||void 0===t?void 0:t.call(n,r))||e.package;if("string"==typeof o)throw new Error("Codeloader does not know how to load from this source");return function(e){if(!Ao(e)||void 0===e.version)throw new Error("Codeloader does not know how to load from this source")}(o),o}shouldLoad(e){return To(e,this.config.allowedCodeOrigins)}async satisfies(e,t){const n=this.getActualCodeDetails(e);if(void 0===n)return!0;if("string"==typeof t.package||"string"==typeof n.package)return!0;const r=(e=>{const t=Number(e.maxUnsupportedVersion);return Mo(t)?t:void 0})(t.package);if(void 0!==r){var o;const e=null===(o=Ro(n))||void 0===o?void 0:o.version;if(void 0!==e)return e===Lo||e>r}return!0}async compare(e,t){const n=Ro(e);if(void 0===n)return;const r=Ro(t);return void 0!==r&&n.name===r.name?n.version===r.version?0:n.version===Lo?-1:r.version===Lo?1:n.version-r.version:void 0}}function Uo(e){var t;const n=null===(t=Object(ho.a)())||void 0===t?void 0:t.AllowListOverride;return n?(e&&Object(Ye.c)(e,{eventName:"CodeLoaderAllowListOverwritten",subCategory:"LocalStorageOverride"}),JSON.parse(n)):[]}class Wo{constructor(e){var t,n;this.config=e;const r=null!==(t=e.additionalAllowedCodeOrigins)&&void 0!==t?t:[],{windowContext:o,logger:i,localeHint:s}=this.config;this.settingsProvider=e.settingsProvider;const a=((e,t,n)=>No(e,mo.d,(e=>async function(e){return jo(`${Object(go.a)(e)}/container/versionless/officeContainerCodeLoadDetails.json`)}(e)),t,n))(o,i,s),c=((e,t,n)=>No(e,mo.c,(e=>async function(e){return jo(`${Object(go.b)(e)}/loop-page-container/versionless/loopPageContainerCodeLoadDetails.json`)}(e)),t,n))(o,i,s),u=((e,t,n)=>No(e,mo.a,(e=>async function(e){const t=e;return jo(`${Object(go.b)(t)}/catalog-container/versionless/catalogContainerCodeLoadDetails.json`)}(e)),t,n))(o,i,s),l=((e,t,n)=>{const r={name:mo.f,versionmd:{files:["https://whiteboard.office.com/root/index.fluid.js"],library:"microsoftWhiteboard"}}}};return{getCodeDetailsPackage:(e,t)=>Promise.resolve(r)}})(),d=((e,t,n)=>No(e,mo.b,(e=>async function(e){const t="https://cdn.forms.office.net/forms/fluid";let n;switch(e){case po.a.Staging:n=`${t}/formsContainerCodeDetails-staging.json?r=${Object(kt.a)()}`;break;case po.a.Local:case po.a.Dogfood:n=`${t}/formsContainerCodeDetails-df.json?r=${Object(kt.a)()}`;break;default:n=`${t}/formsContainerCodeDetails-prod.json?r=${Object(kt.a)()}`}return jo(n)}(e)),t,n))(o,i,s);this.containerCodeDetailsProviderMap=new Map([[mo.d,a],[mo.e,a],[mo.c,c],[mo.a,u],[mo.f,l],[mo.b,d]]),null===(n=e.additionalCodeDetailsProviders)||void 0===n||n.forEach((e=>{let[t,n]=e;return this.containerCodeDetailsProviderMap.set(t,n)}));const h=[...Object(fo.a)(this.config.containerEnvironment,this.settingsProvider,this.config.logger),...Uo(e.logger),...r];this.simpleCodeLoader=new Bo({windowContext:e.windowContext,trustedTypesPolicy:e.trustedTypesPolicy,getBundledPackageFactoryOverride:t=>{var n;const r=null===(n=e.locallyBundledPackageFactories)||void 0===n?void 0:n.get(t);return r?Promise.resolve(r):void 0},disableCdnCodeLoadingFallback:e.disableCdnCodeLoadingFallback,getFluidCodeDetailsPackageOverride:async t=>{const n=this.containerCodeDetailsProviderMap.get(t);if(n)return n.getCodeDetailsPackage(e.containerEnvironment,h)},allowedCodeOrigins:h,getFluidCodeVersionDetails:t=>{var n;const{containerEnvironment:r}=e,o=t.version,i=null===(n=this.containerCodeDetailsProviderMap.get(t.name))||void 0===n?void 0:n.upgradeNeeded;return{version:o,containerEnvironment:r,needUpgrade:i?()=>i(r,o):async()=>!1}}})}get IFluidCodeDetailsComparer(){return this.simpleCodeLoader}getActualCodeDetails(e){return this.simpleCodeLoader.getActualCodeDetails(e)}async preCache(e){const t=this.containerCodeDetailsProviderMaContainerCode(this.config.containerEnvironment):this.simpleCodeLoader.preCache(e)}async load(e){return this.simpleCodeLoader.load(e,this.config.logger)}}var qo=n("5+n6");class Ho{constructor(e){this.settingsProvider=e}getRawConfig(e){const t=Object(qo.a)(e,null,this.settingsProvider);return null===t?void 0:t}}var zo=n("O4Uw");function Go(e,t){(async()=>{const n=function(e){var t;if(void 0!==e.getSpecifiedCodeDetails)return e.getSpecifiedCodeDetails();const n=e.getQuorum();return null!==(t=n.getMember("code"))&&void 0!==t?t:n.getMember("code2")}(e);if(n){var r;const o=null===(r=t.getActualCodeDetails)||void 0===r?void 0:r.call(t,n);if(o&&t.IFluidCodeDetailsComparer){const r=await t.IFluidCodeDetailsComparer.compare(n,o);void 0!==r&&r<0&&await e.proposeCodeDetails(o)}}})().catch((()=>{}))}async function Vo(e,t,r,o,i,s,a,c,u){var l,d;const h=new Gt.a(i);h.register("HostContext",s);const f=h.synthesize({SettingsProvider:"SettingsProvider"},void 0),p=h.synthesize({LoopTrustedTypesPolicy:"LoopTrustedTypesPolicy"},void 0),m=await p.LoopTrustedTypesPolicy,g=await f.SettingsProvider,v=Object(lo.b)(r.environment),b=(null===(l=r.codeLoader)||void 0===l?void 0:l.call(r,e))||new Wo({windowContext:e,trustedTypesPolicy:m,containerEnvironment:v||"Prod",logger:c,localeHint:null===(d=s.hostLocaleContext)||void 0===d?void 0:d.uiLanguage,sctory;let w,C;if(Object(Ht.a)()&&(o.documentServiceFactory=await n.e(647).then(n.bind(null,"VNjx")).then((e=>e.FluidDebugger.createFromServiceFactory(y)))),"Existing"===t.type&&(w=t.containerCodeHint),w)if(c&&Object(Ye.c)(c,{eventName:"CodeHintExists"}),r.loadCodeFromHint){ciming:!0});b.load({package:w}).then((()=>{e.setResult(!0)})).catch((t=>{e.setResult(!1,void 0,t)}))}else(function(e){return"preCache"in e&&!!e.preCache})(b)&&(null==u||u.addAdditionalProps({precachedContainerPackageName:xo(w)}),b.preCache(w).catch((e=>{c&&Object(Ye.b)(c,{eventName:"ContainerPackagePreCacheError"},e)})));g&&(C=new Ho(g));const O=await o.urlResolver;return new uo({urlResolver:O,documentServiceFactory:y,options:r.loaderOptions,scope:{IFluidDependencySynthesizer:h},codeLoader:b,detachedBlobStorage:r.detachedBlobStorage,logger:a,configProvider:C})}async function $o(e,t,n,r,o){const i={[cn.loadMode]:{opsBeforeReturn:"cached",deltaConnection:n.startContainerInPausedState?"none":"delayed"}};let s,a;const c=e.services.codeLoader;switch(t.type){case"Existing":{const r=t.containerRequest,o={url:r.url,headers:{...i,...r.headers}};a=t.containerCodeHint,s=e.resolve(o,n.pendingLocalState);break}case"DetachedFromCode":{const n=function(){const e=Object(Bt.b)();if(void 0!==e)return JSON.parse(e)}()||t.codeDetails;s=e.createDetachedContainer(n);break}case"DetachedFromSnapshot":s=e.rehydrateDetachedContainerFromSnapshot(t.snapshot);break;default:throw new Error("loadContainerProps type is invalid")}return s.then((async e=>{var t;n.startContainerInPausedState||an(e);const i=null===(t=e.getSpecifiedCodeDetails)||void 0===t?void 0:t.call(e),s=i&&Object(zo.a)(i),u=s?xo(s):"Unknown";if(o){var l;const e=o;let t={};t.containerCodeDetailsName=u,null===(l=e.PersistedProperties)||void 0===l||l.addPersistedProperties(t)}if(null==r||r.addAdditionalProps({loadedContainerPackageName:u,codeHintPackageName:a,containerPackageMatchedCodeHint:a===s}),e.deltaManager.active)Go(e,c);else{const t=()=>{e.deltaManager.active&&(Go(e,c),e.off("connected",t))};e.on("connected",t)}})),s}var Qo=n("wUi7");function Jo(e){var t;let{windowContextForLoader:n,driverFetcher:r,dependencySynthesizer:o,hostContext:i,hostConfig:s,logger:a,perfMetadata:c,documentEverHiddenTrackerID:u,containerRequest:l,driver:d,preCheckInfo:h}=e;ei(d,r,s);const f=Object(Qo.a)(i,{audience:(null===(t=s.environment)||void 0===t?void 0:t.audience)||"Production"}),p=new Gt.a(o);p.register("HostContext",f);const m={type:"Existing",containerRequest:l,containerCodeHint:null==h?void 0:h.codeDetailsHint},{containerPromise:g,componentPromise:v}=d?Yo(n,m,d,l,p,f,s,a,c,u,void 0):Ko(n,m,r,l,p,f,s,a,c,u,void 0);return{container:g,component:v}}function Xo(e,t,n,r,o,i,s,a){ei(n,r,o);const{componentPromise:c,containerPromise:u}=n?Yo(e,{type:"DetachedFromCode",codeDetails:t.codeDetails},n,void 0,t.dependencySynthesizer,t.hostContext,o,i,s,a,t.loadTemplateProps):Ko(e,{type:"DetachedFromCode",codeDetails:t.codeDetails},r,void 0,t.dependencySynthesizer,t.hostContext,o,i,s,a,t.loadTemplateProps);return{component:c,container:u}}function Ko(e,t,n,r,o,i,s,a,c,u,l){const d=new Vt.a,h=new Vt.a;return async function(){const t=Ke.a.start("GetDriver",a,{addUserTiming:!0}),r={...c,documentEverHidden:Object(Wt.a)(u)>-1},{driverImplementationOverride:l}=s;if(l)return t.setResult(!0,{...r,driverType:"Override"}),l;if(n){const{type:c,impl:u}=await n(e,o,i,s,a);return t.setResult(!0,{...r,driverType:c}),u}const d=new Error("Driver unavailable"}().then((async n=>{const f=Yo(e,t,n,r,o,i,s,a,c,u,l);d.resolve(f.containerPromise),h.resolve(f.componentPromise)})).catch((e=>{d.reject(e),h.reject(e)})),{containerPromise:d,componentPromise:h}}function Yo(e,t,n,r,o,i,s,a,c,u,l){var d;const h=c.fluidBootstrapperStartTime,f=c.hostScenarioStartTime,p="Existing"!==t.type&&{createNew:"DetachedFromCode"===t.type?"DetachedContainer":t.type},m=p&&{additionalPropsToLog:p}||void 0,g=i.hostPerformanceData;g&&a&&Object.entries(g).forEach((e=>{let[t,n]=e;Object(Ye.c)(a,{eventName:t,subCategory:"HostPerformanceData",startTime:n.startTime,duration:n.duration,...c})}));const v=Ke.a.start("LoadComponentInDiv",a,{addUserTiming:!0,...m});a&&Jt(a),a&&Object(Ye.c)(a,{eventName:"HostLocaleContext",subCategory:"HostLocaleContext",uiLanguage:(null===(d=i.hostLocaleContext)||void 0===d?void 0:d.uiLanguage)||Kt.a});const b=a&&new sn(a,c,u),y=Ketainer",a,{addUserTiming:!0,additionalPropsToLog:{LoadContainerType:t.type},isAPerformanceMetric:!0}),w=Vo(e,t,s,n,o,i,b,a,y),C=w.then((e=>$o(e,t,s,y,a)));C.then((e=>{a&&rn(e,a);const t=Object(Wt.a)(u),n=y.startTimeSinceEpoch;y.setResult(!0,{...c,offsetFromHostScenarioStartTime:Object(Yt.a)(n,f),offsetFromFluidBootstrapperStartTime:Object(Yt.a)(n,h),documentEverHidden:t>-1})})).catch((e=>{y.setResult(!1,{errorType:e.errorType},e),v.setResult(!1,{errorType:e.errorType},e),a&&Object(en.a)(a,"LoadComponentInDiv","Open","FileOpenFailed",e.errorType||"ComponentLoadError",{},e)}));const O=C.then((e=>{if(!e)throw v.setResult(!1),a&&Object(en.a)(a,"LoadComponentInDiv","Open","FileOoadError"),new Error("Failed to Load Container");const t=w.then((t=>ln(e,t,r,a,c,u,s.startContainerInPausedState)));return t.then((()=>{v.setResult(!0)})).catch((t=>{e.close(),v.setResult(!1,{errorType:t.errorType},t),a&&Object(en.a)(a,"LoadComponentInDiv","Open","FileOpenFailed",t.errorType||"ComponentLoadError",{},t)})),t}));if(null!=l&&l.fromExistingTemplateUrl){const e=async function(e,t,n,r,o,i){const s=Ke.a.start("GetTemplateContent",r,{addUserTiming:!0});return t.then((async t=>{s.markSubActivityStart("TemplateLoadContainer");const a=await $o(t,{type:"Existing",containerRequest:{url:e.fromExistingTemplateUrl,headers:e.loadTemplateRequestHeaders}},n,void 0,r);return s.markSubActivityEnd("TemplateLoadContainer"),await async function(e){if(e.closed)throw new _n("waitContainerToCatchUp: Container closed");retuconst r=e.deltaManager,o=t=>{e.off("closed",o);const r="Container closed while waiting to catch up";n(void 0!==t?Object(At.i)(t,(e=>new kn(`${r}: ${e}`))):new kn(r))};e.on("closed",o);const i=()=>{Cn(e.connectionState===jr.CatchingUp||e.connectionState===jr.Connected,205);const n=r.hasCheckpointSequenceNumber,i=r.lastKnownSeqNumber;if(Cn(r.lastSequenceNumber<=i,614),r.lastSequenceNumber===i)return e.off("closed",o),void.sequenceNumber&&(e.off("closed",o),t(n),r.off("op",s))};r.on("op",s)};if(e.connectionState===jr.Connected)return void i();const s=()=>{e.off(Yn,s),i()};e.on(Yn,s),e.connectionState===jr.Disconnected&&e.connect()}))}(a),s.markSubActivityStart("TemplateLoadComponent"),ln(a,t,{url:e.fromExistingTemplateUrl},r,o,i,n.startContainerInPausedState).then((async e=>{if(s.markSubActivityEnd("TemplateLoadComponent"),null==e||!e.ComponentSerializable)throw new Error("ComponentNotSerializableError");const t=await e.ComponentSerializable.serialize();return s.setResult(!0),t}))})).catch((e=>{throw s.setResult(!1,void 0,e),e.name="GetTemplateContentError",e}))}(l,w,s,a,c,u);return{containerPromise:C,componentPromise:O.then((t=>{const n=t.ComponentSerializable;if(!n)throw new Error("ComponentNotSerializableError");let r;return e.then((async e=>{if(r=Ke.a.start("RehydrateFromTemplateContent",a,{addUserTiming:!0}),void 0===e)throw new Error("UndefinedTemplateContentError");return await n.rehydrate(e),r.setResult(!0),t})).catch((e=>{var t;throw null===(t=r)||void 0===t||t.setResult(!1,void 0,e),e}))}))}}return{containerPromise:C,componentPromise:O}}const Zo=new Error("Invalid configuration for driver. Please provide either a driver, driverFetcher, or driverImplementationOverride.");function ei(e,t,n){if(!(e||t||n.driverImplementationOverride))throw Zo}class ti{constructor(e){this.props=e,e.logger&&(this.logger=new Ut.a("LoopLoader",e.logger))}async instantiateLoopComponent(e){const{loopCodeLoader:t,dependencySynthesizer:n}=this.props,r=function(e){switch(e.type){case"Registry":return e.registrationId||e.loopType;case"Data":return e.registrationId||"catalog"}}(e);let o;try{o=await t.load({packageName:r})}catch(e){throw this.logger&&Object(Ye.b)(this.logger,{eventName:"LoopCodeLoaderModuleLoadFailure",loopRegistrationId:r},e),new Error(`Failed to load loop module from loopCodeLoader for id ${r}. Error: ${e}`)}const i=new Gt.a(n);return this.logger&&i.register("NamespaceLogger",this.logger),o.module.loopExport.instantiateLoopComponent("Data"===e.type?{creationData:e,manifestData:e.manifestData}:e,i)}}const ni="CreateLoopLoader",ri="InstantiateLoopComponent";function oi(e){let{loopComponentRouterInput:t,dependencySynthesizer:n,hostContext:r,documentServiceFactory:o,urlResolver:i,config:s,fluidRequestHeaders:a,loopCodeLoaderFactory:c}=e;const{logger:u,newConfig:l,perfMetadata:d,documentHiddenTrackerId:h}=function(e,t){const n=Date.now(),r=Object(Wt.b)(),{logger:o,...i}=e;return{logger:o&&new Ut.a(zt.a,o,{isReplay:Object(Ht.a)()||void 0,owhVersion:qt.a}),newConfig:i,perfMetadata:{fluidBootstrapperStartTime:n,hostScenarioStartTime:null==t?void 0:t.hostScenarioStartTime},documentHiddenTrackerId:r}}(s||{},r);return function(e){let{windowContextForLoader:t,loopComponentRouterInput:n,dependencySynthesizer:r,hostContext:o,documentServiceFactory:i,urlResolver:s,config:a,logger:c,perfMetadata:u,documentHiddenTrackerId:l,fluidRequestHeaders:d,loopCodeLoaderFactory:h}=e;const f={documentServiceFactory:i,urlResolver:s},p={...a,driverImplementationOverride:f},m=Ke.a.start("GetLoopComponentCore",c,{addUserTiming:!0,additionalPropsToLog:{routerInputType:n.type,glV2:void 0!==h}});if("Fluid"===n.type){null!=c&&c.PersistedProperties&&c.PersistedProperties.addPersistedProperties({isFluid:!0});const e=Object(Xe.b)(n.codeDetails.package)?n.codeDetails.package.name:n.codeDetails.package;try{const a=Xo(t,{dependencySynthesizer:r,hostContext:o,codeDetails:n.codeDetails,loadTemplateProps:n.templateProps},{documentServiceFactory:i,urlResolver:s},void 0,p,c,u,l);return m.setResult(!0,{packageName:e}),a}catch(t){throw m.setResult(!1,{packageName:e},t),t}}m.markSubActivityStart("CheckFluidUrl");const g=async function(e,t){if("Data"!==e.type||"URL"!==e.dataType)return;const n=e.data.url,r="then"in t?await t:t;if(r instanceof gt||r instanceof Rt)return Object(Ft.a)(n);try{const e=await r.resolve({url:n.href});if("fluid"===(null==e?void 0:e.type))return{}}catch(e){}}(n,s).then((e=>{let i;return m.markSubActivityEnd("CheckFluidUrl"),e&&"Data"===n.type&&"URL"===n.dataType?(null!=c&&c.PersistedProperties&&c.PersistedProperties.addPersistedProperties({isFluid:!0}),i=Jo({windowContextForLoader:t,driverFetcher:void 0,dependencySynthesizer:r,hostContext:o,hostConfig:p,logger:c,perfMetadata:u,documentEverHiddenTrackerID:l,containerRequest:{url:n.data.url.href,headers:d},driver:f,preCheckInfo:e})):(null!=c&&c.PersistedProperties&&c.PersistedProperties.addPersistedProperties({isFluid:!1,loopRegistrationId:n.registrationId}),i=function(e,t,n,r,o,i,s,a,c,u){var l;const d=i.fluidBootstrapperStartTime,h=i.hostScenarioStartTime,f=o.hostPerformanceData;if(f&&a&&Object.entries(f).forEach((e=>{let[t,n]=e;Object(Ye.c)(a,{eventName:t,subCategory:"HostPerformanceData",startTime:n.startTime,duration:n.duration,...i})})),a&&Jt(a),a&&Object(Ye.c)(a,{eventName:"HostLocaleContext",subCategory:"HostLocaleContext",uiLanguage:(null===(l=o.hostLocaleContext)||void 0===l?void 0:l.uiLanguage)||Kt.a}),u)return function(e,t,n,r,o,i,s){return{component:async function(e,t,n,r,o,i,s,a){try{a.markSubActivityStart(ni);const c=await async function(e,t,n,r,o,i){var s;const{environment:a}=e,c=new Gt.a(n);c.register("HostContext",r);const u=c.synthesize({SettingsProvider:"SettingsProvider",TokenProvider:"TokenProvider",LoopTrustedTypesPolicy:"LoopTrustedTypesPolicy"},void 0),[l,d,h]=await Promise.all([u.SettingsProvider,u.TokenProvider,u.LoopTrustedTypesPolicy]),f={audience:(null==a?void 0:a.audience)||"Production",localeHint:null===(s=r.hostLocaleContext)||void 0===s?void 0:s.uiLanguage,settingsProvider:l,windowContext:t,trustedTypesPolicy:h,tokenProvider:d,logger:o},p=await i.instantiateLoopCodeLoader(f);return new ti({loopCodeLoader:p,dependencySynthesizer:c,logger:o})}(e,t,n,r,o,i);a.markSubActivityEnd(ni),a.markSubActivityStart(ri);const u=await c.instantiateLoopComponent(s);return a.markSubActivityEnd(ri),a.setResult(!0),u}catch(e){let t;throw"object"==typeof e&&e&&(t=Object(e).errorType),a.setResult(!1,{errorType:t},e),new Error(`GetLoopComponentFromLoopFactory failed to resolve component with id ${s.registrationId}.`)}}(o,t,n,r,i,s,e,Ke.a.start("GetLoopComponentFromLoopFactory",i,{addUserTiming:!0})),container:Promise.resolve(void 0)}}(t,e,r,o,c,a,u);const p=Ke.a.start("GetLoopComponentFromCatalogContainer",a,{addUserTiming:!0}),m=a&&new sn(a,i,s),g={type:"DetachedFromCode",codeDetails:Object(Bt.a)()},v=Ke.a.start("LoadContainer",a,{addUserTiming:!0,additionalPropsToLog:{LoadContainerType:g.type}}),b=Vo(e,g,c,n,r,o,m,a,v),y=b.then((e=>$o(e,g,c,v,a)));y.then((e=>{a&&rn(e,a);const t=Object(Wt.a)(s),n=v.startTimeSinceEpoch;v.setResult(!0,{...i,offsetFromHostScenarioStartTime:Object(Yt.a)(n,h),offsetFromFluidBootstrapperStartTime:Object(Yt.a)(n,d),documentEverHidden:t>-1})})).catch((e=>{v.setResult(!1,{errorType:e.errorType},e),p.setResult(!1,{errorType:e.errorType},e),a&&Object(en.a)(a,"GetLoopComponentFromCatalogContainer","Open","FileOpenFailed",e.errorType||"ComponentLoadError",{},e)}));const w=y.then((e=>{if(!e)throw p.setResult(!1),a&&Object(en.a)(a,"GetLoopComponentFromCatalogContainer","Open","FileOpenFailed","ContainerLoadError"),new Error("Failed to Load Container");const n=b.then((t=>ln(e,t,void 0,a,i,s,c.startContainerInPausedState))).then((async e=>{var n;const r=await(null===(n=e.LoopComponentRouter)||void 0===n?void 0:n.getLoopComponent(t));if(!r)throw new Error("Loop component could not be created.");return r}));return n.then((()=>{p.setResult(!0)})).catch((e=>(e=>{let t;"object"==typeof e&&e&&(t=Object(e).errorType),p.setResult(!1,{errorType:t},e),a&&Object(en.a)(a,"GetLoopComponentFromCatalogContainer","Open","FileOpenFailed",t||"ComponentLoadError",{},e)})(e))),n}));return{container:y,component:w}}(t,n,f,r,o,u,l,c,p,h)),i})).catch((e=>{throw m.setResult(!1,void 0,e),e}));return{component:g.then((e=>e.component)).then((e=>(m.setResult(!0),c&&function(e,t,n){var r,o;null===(r=e.ComponentMetadata)||void 0===r||null===(o=r.identityName)||void 0===o||o.then((e=>{Object(Ye.c)(n,{eventName:"LoadComponentMetadata",identityName:e,source:"owh-getLoopComponentInternal"})})).catch((e=>{Object(Ye.b)(n,{eventName:"LoadComponentMetadataLogError"},e)}))}(e,0,c),e))).catch((e=>{throw m.setResult(!1,void 0,e),e})),container:g.then((e=>e.container))}}({windowContextForLoader:window,loopComponentRouterInput:t,dependencySynthesizer:n,hostContext:r,documentServiceFactory:o,urlResolver:i,config:l,logger:u,perfMetadata:d,documentHiddenTrackerId:h,fluidRequestHeaders:a,loopCodeLoaderFactory:c})}var ii=n("r5l9"),si=n("MDpc"),ai=n("YIvB"),ci=n("z1nA"),ui=n("PT5P"),li=n("qCYp"),di=n("Fjh8"),hi=n("VbEw"),fi=n("W3qw"),pi=n("QUcg"),mi=n("O7VI"),gi=n("qZ6x");const vi=["ResizeObserver loop limit exceeded","ResizeObserver loop completed with undelivered notifications."],bi=100;function yi(e,t){e.then((e=>t.resolve(e))).catch((e=>t.reject(e)))}function wi(e){return function(e,t){var n;let{initializeConfig:r,iframeHostingElement:o,dependencySynthesizer:i,hostContext:s,config:a,documentServiceFactory:c,urlResolver:u,driverPrecacheResult:l,options:d,additionalInfo:h,createOrLoadCallback:f}=e;const{logger:p,...m}=a,g=p&&new Ut.a(zt.a,p,{iframe:"sourcelessV2",isReplay:Object(Ht.a)()||void 0,owhVersion:qt.a}),v={...m,logger:g},b=Object(Qo.a)(s,{audience:(null===(n=m.environment)||void 0===n?void 0:n.audience)||"Production"}),y=new Gt.a(i);return y.register("HostContext",b),function(e,t){let{initializeConfig:n,iframeHostingElement:r,dependencySynthesizer:o,hostContext:i,config:s,documentServiceFactory:a,driverPrecacheResult:c,urlResolver:u,options:l,additionalInfo:d,createOrLoadCallback:h}=e;if("Load"===n.type){const e=o.synthesize({TokenProvider:"TokenProvider"},void 0);Promise.resolve(e.TokenProvider).then((e=>{e&&Object(fi.a)(e,n.driverInfo)})).catch((()=>{}))}const{logger:f}=s,p=Ke.a.start("LoadComponentInIframe",f,{addUserTiming:!0}),m=Ke.a.start("IFrameBoot",f,{addUserTiming:!0}),g=Date.now();let v,b=!0,y=!1;const w=()=>{if(y)return;b=!1,y=!0,p.dispose(),m.dispose();const e=l.onDispose;var t;null==e||e(),f&&(Object(Ye.c)(f,{eventName:"IframeDisposed",subCategory:"IframeDisposed"}),null===(t=f.dispose)||void 0===t||t.call(f)),v=null};let C,O;return{loadedInfo:new Promise((async(e,y)=>{var S;const k=Object(si.a)(),E=l.layoutMode||Object(ci.b)(r);v=Object(hi.a)(document,l.iframeTitle),Object(di.b)(E,v);const _=async()=>{if(!b)return;const r=Ke.a.start("IFrameInitialize",f,{addUserTiming:!0});try{m.setResult(!0);const c=v.contentWindow;Object(gi.a)(c);const f="function"==typeof a?a(c):a,b={iframe:v,initializeConfig:n,documentServiceFactory:f,urlResolver:u,dependencySynthesizer:o,hostContext:i,config:s,options:lframeLoadStartTime:g,localization:k,bootstrapperStartTime:d.bootstrapperStartTime,resumeLoadTime:O,onDispose:w,cancellationErrorGenerator:e=>new ui.a(e),createOrLoadCallbackInternal:h},y=await t(b,p);T((e=>e.codeToInject),(e=>function(e,t){const n=e.createElement("script");n.appendChild(e.createTextNode(t)),e.head.appendChild(n)}(c.document,e))),e(y),r.setResult(!0(e){r.setResult(!1,{errorCode:e.errorCode},e),y(e)}};if(l.partialLoadOnly){const e=new Promise((e=>{v.onload=()=>{e(),T((e=>e.afterIframeOnload),(e=>e()))}}));C=()=>{O||(O=Date.now(),e.then((()=>_())))}}else v.onload=_;const j=[],I="Load"===n.type?n.driverInfo.preconnectDomains:void 0;let N;if(I&&j.push(...I),"Load"===n.type?N=n.driverInfo.containerCodeHint:"CreateFromCode"===n.type&&(N=Object(zo.a)(n.codeDetails)),N){const e=Object(lo.b)(s.environment);j.push(...Object(li.a)(N,e))}const A=o.synthesize({LoopTrustedTypesPolicy:"LoopTrustedTypesPolicy"},void 0),P=await A.LoopTrustedTypesPolicy,x=await async function(e,t){return t&&"function"==typeof e?(await t).mainBundleUrls:[]}(a,c),D=Object(mi.a)(x,j),L=null!==(S=null==P?void 0:P.createHTML(D,{allowedTags:["script"]}))&&void 0!==S?S:D;v.srcdoc=L,r.appendChild(v)})),resumeLoad:C,getIframe:()=>v||void 0,getRenderHostingElement:()=>{var e,t,n,r;const o=null===(e=(null===(t=v)||void 0===t?void 0:t.contentDocument)||(null===(n=v)||void 0===n||null===(r=n.contentWindow)||void 0===r?void 0:r.document))||void 0===e?void 0:e.getElementById(pi.a);if(!o)throw new Error("Could not get iframe render hosting element");return o}};function T(e,t){if(Object(ai.a)("Automation",i.audience)){const n=l._DoNotUse_ForTestingOnly;if(n){const r=e(n);r&&t(r)}}}}({initializeConfig:r,iframeHostingElement:o,dependencySynthesizer:y,hostContext:b,config:v,documentServiceFactory:c,urlResolver:u,driverPrecacheResult:l,options:d,additionalInfo:h,createOrLoadCallback:f},(async(e,t)=>{const n=await async function(e){const t={containerPromise:new Vt.a,componentPromise:new Vt.a},n=Object(Wt.b)();return await async function(e,t,n,r){const o=Date.now(),{iframe:i,hostContext:s,dependencySynthesizer:a,config:c,layoutMode:u,bootstrapperStartTime:l,iframeLoadStartTime:d,resumeLoadTime:h,localization:f,onDispose:p,cancellationErrorGenerator:m}=e,g=i.contentWindow,{logger:v}=c;null!=c&&c.informationProtectionActions&&function(e,t){const n=e.document;if(t.disableCopy){const e=e=>{var t,n;e.preventDefault(),null===(t=e.clipboardData)||void 0===t||t.setData("text/plain",""),null===(n=e.clipboardDatpagation()};n.addEventListener("copy",e,!0),n.addEventListener("cut",e,!0)}if(t.disablePrint){const t=e=>{n.body.style.display=e.matches?"none":"block"};n.body.style.display="block",e.matchMedia("print").addEventListionProtectionActions),function(e,t){if(!t)return;let n=0,r=0,o=0;e.onerror=async(e,o,i,s,a)=>{const c=JSON.stringify(e);(e=>vi.some((t=>e.includes(t))))(c)?r<=100&&(Object(Ye.c)(t,{eventName:"NonBreakingUnhandledError",subCategory:"GlobalError",subErrorName:c}),r+=1,100===r&&Object(Ye.c)(t,{eventName:"MaxUnhandledNonBreakingErrorCountReached",subCategory:"GlobalError"})):n<=bi&&(Object(en.a)(t,"UnhandledError","Interruptions","UnhandledError","UnhandledError",{message:c},a),n+=1,n===bi&&Object(Ye.c)(t,{eventName:"MaxUnhandledErrorCountReached",subCategory:"GlobalError"}))},e.addEventListener("unhandledrejection",(async e=>{const n=e.reason||new Error("Rejected promise did not provide error");o<=bi&&(Object(en.a)(t,"UnhandledRejection","Interruptions","UnhandledRejection","UnhandledRejection",{},n),o+=1,o===bi&&Object(Ye.c)(t,{eventName:"MaxUnhandledRejectionCountReached"}))}))}(g,v),g.addEventListener("unload",(()=>{const e=m("Iframe disposed");Object.values(t).forEach((t=>t.reject(e))),p()}));const b={fluidBootstrapperStartTime:l,hostScenarioStartTime:s.hostScenarioStartTime};!function(e,t){let{perfMetadata:n,iframeLoadStartTime:r,iframeLoadAndInitializeDuration:o,documentEverHiddenTrackerId:i,additionalTelemetry:s}=t;e&&Object(Ye.c)(e,{eventName:"iframeLoadAndInitialize",subCategory:"IframePerformanceData",startTime:r,duration:o,offsetFromFluidBootstrapperStartTime:Object(Yt.a)(r,n.fluidBootstrapperStartTime),documentEverHidden:Object(Wt.a)(i)>-1,...n,...s})}(v,{perfMetadata:b,iframeLoadStartTime:d,iframeLoadAndInitializeDuration:o-d,documentEverHiddenTrackerId:r,additionalTelemetry:{resumeLoadTime:h}}),Object(si.b)(f);const y=a.synthesize({LoopTrustedTypesPolicy:"LoopTrustedTypesPolicy"},void 0),w=await y.LoopTrustedTypesPolicy,C=Object(lo.b)(c.environment),O={...c,logger:v,codeLoader:c.codeLoader||(e=>new Wo({windowContext:e,trustedTypesPolicy:w,containerEnvironment:C||"Prod",logger:v}))},T=g.document.getElementById(pi.a);return await Object(di.a)(g,T,u,(e=>{void 0!==e.w&&(i.width=`${e.w}`),i.height=`${e.h}`})),await n(e,O,b)}(e,t,(function(e,r,o){return async function(e,t,n,r,o){const{dependencySynthesizer:i,hostContext:s,config:a,iframe:c,createOrLoadCallbackInternal:u,documentServiceFactory:l,urlResolver:d}=e,{logger:h}=a,f=u({windowContextForLoader:e.iframe.contentWindow,hostConfig:n,perfMetadata:r,documentEverHiddenTrackerId:o,dependencySynthesizer:i,hostContext:s,logger:h,documentServiceFactory:l,urlResolver:d}),{containerPromise:p,componentPromise:m}=t,g=f.container,v=f.component;return yi(g,p),yi(v,m),function(e,t){t.then((t=>{t&&e.addEventListener("unload",((tch((()=>{}))}(c.contentWindow,g),{container:p,component:m}}(e,t,r,o,n)}),n)}(e);return Promise.all([n.component,n.container]).then((()=>t.setResult(!0))).catch((e=>t.setResult(!1,{},e))),n}))}(e)}function Ci(e,t){return n=>{const{windowContextForLoader:r,hostConfig:o,logger:i,perfMetadata:s,documentEverHiddenTrackerId:a,dependencySynthesizer:c,hostContext:u,documentServiceFactory:l,urlResolver:d}=n;return Jo({windowContextForLoader:r,driverFetcher:void 0,dependencySynthesizer:c,hostContext:u,hostConfig:o,logger:i,perfMetadata:s,documentEverHiddenTrackerID:a,containerRequest:{url:e.documentUrl,headers:e.headers},driver:{documentServiceFactory:l,urlResolver:d},preCheckInfo:t})}}var Oi=n("+4M4");class Ti{constructor(e){this.execute=e}get[Symbol.toStringTag](){return this.getPromise()[Symbol.toStringTag]}async then(e,t){return this.getPromise().then(...arguments)}async catch(e){return this.getPromise().catch(...arguments)}async finally(e){return this.getPromise().finally(...arguments)}async getPromise(){return void 0===this.result&&(this.result=this.execute()),this.result}}class Si{constructor(){this.providers=new Map;for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.parents=t.filter((e=>void 0!==e))}get IFluidDependencySynthesizer(){return this}register(e,t){if(this.providers.has(e))throw new Error(`Attempting to register a provider of type ${String(e)} that already exists`);this.providers.set(e,t)}unregister(e){this.providers.has(e)&&this.providers.delete(e)}synthesize(e,t){const n={};return this.generateRequired(n,t),this.generateOptional(n,e),Object.defineProperty(n,"IFluidDependencySynthesizer",{get:()=>this}),n}has(e,t){return!!this.providers.has(e)||!0!==t&&this.parents.some((t=>t.has(e)))}getProvider(e){if(this.has(e)){if(this.providers.has(e))return this.providers.get(e);for(const t of this.parents){if(t instanceof Si)return t.getProvider(e);{const n=t;if(void 0!==(null==n?void 0:n.getProvider))return n.getProvider(e)}}}}generateRequired(e,t){if(void 0!==t)for(const n of Object.keys(t)){const t=this.resolveProvider(n);if(void 0===t)throw new Error(`Object attempted to be created without registered required provider ${String(n)}`);Object.defineProperty(e,n,t)}}generateOptional(e,t){if(void 0!==t)for(const r of Object.keys(t)){var n;const t=null!==(n=this.resolveProvider(r))&&void 0!==n?n:{get:async()=>{}};Object.defineProperty(e,r,t)}}resolveProvider(e){const t=this.providers.get(e);if(void 0!==t)return"function"==typeof t?{get(){if(t&&"function"==typeof t)return Promise.resolve(this.IFluidDependencySynthesizer).then((async e=>t(e))).then((t=>null==t?void 0:t[e]))}}:{get(){if(t)return new Ti((async()=>Promise.resolve(t).then((t=>{if(t)return t[e]}))))}};for(const t of this.parents){const n=t.synthesize({[e]:e},{}),r=Object.getOwnPropertyDescriptor(n,e);if(void 0!==r)return r}}}const ki=["#C239B3","#CA5010","#E3008C","#A4262C","#498205","#69797E","#881798","#D13438","#0078D4","#038387","#750B1C","#986F0B","#4F6BED","#8764B8","#0B6A0B","#7A7574","#5C2E91","#005B70","#8E562E"],Ei=["#DC8990","#DA846B","#ECC26E","#B5CC99","#78C9A0","#85ACB8","#7FA3D0","#CC87B1","#E47CA1","#BF9D8C"];class _i{get PresenceColorProvider(){return this}get Disposable(){return this.disposable}getColorPaletteForTheme(){var e,t,n,r;return"dark"===(null!==(e=null===(t=this.theming)||void 0===t?void 0:t.themeName)&&void 0!==e?e:null===(n=this.theming)||void 0===n||null===(r=n.themeProperties)||void 0===r?void 0:r.get("--ms-themeColorThemeName"))?Ei:ki}dispose(){this.Disposable.dispose()}asyncgnedColors.get(e);if(t)return Promise.resolve(t);if(this.colorAssignmentInFlight.has(e))return new Promise((t=>{this.deferredColorAssignment[e].push(t)}));this.colorAssignmentInFlight.add(e);const n=this.colorPalette[this.nextColorToAssignIndex];if(this.nextColorToAssignIndex=(this.nextColorToAssignIndex+1)%this.colorPalette.length,this.assignedColors.set(e,n),this.colorAssignmentInFlight.delete(e),void 0!==this.deferredColorAssignment[e])for(const t of this.deferredColorAssignment[e])t(n);return delete this.deferredColorAssignment[e],Promise.resolve(n)}constructor(e){var t;this.theming=e,this.nextColorToAssignIndex=0,this.colorAssignmentInFlight=new Set,this.deferredColorAssignment={},this.assignedColors=new Map,this.colorPalette=ki,this.disposable={get Disposable(){return this},dispose:()=>{this.theming&&this.theming.off("themePropertiesChanged",this.themePropertiesChangedListener),this.colorAssignmentInFlight.clear(),this.assignedColors.clear()}},this.themePropertiesChangedListener=()=>{const e=this.getColorPaletteForTheme();e!==this.colorPalette&&(this.colorPalette=e,this.assignedColors.clear(),this.nextColorToAssignIndex=0)},null===(t=this.theming)||void 0===t||t.on("themePropertiesChanged",this.themePropertiesChangedListener),this.colorPalette=this.getColorPaletteForTheme()}}function ji(oid 0===n||n.setItem(Ii(t),JSON.stringify(r))}function Ii(e){return"fluidOdspDriverManifestCache_"+(e||"Prod")}function Ni(e){return Ii(e)+"_prefetch"}n("u79n");var Ai=n("3+PR");const Pi="odspDriverManifestUrl",xi="/odsp-driver/versionless/deploymentManifestOdspDriver.json";function Di(e){try{const t=function(e){var t;const n=null===(t=Object(ho.a)())||void 0===t?void 0:t.getItem(Ii(e));return n?JSON.parse(n):null}(e);return t?Date.now()-t.lastUpdatedTime>6048e5?null:t:null}catch(e){return null}}async function Li(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"high";const n=Object(Ai.a)(Pi),r=n||Object(go.a)(e)+xi,o={method:"GET"},i=await fetch(r,{...o,priority:t});if(i.ok){const t=await i.json();return ji(t,e),t}throw new Error("Error fetching ODSP Driver manifest")}function Mi(e,t){const n=t.v1,r={mainBundleUrls:[t.jsBaseUrl+"/"+n.index]},o=document,i=function(e){v=Object(ho.a)())||void 0===t?void 0:t.getItem(Ni(e)))||null}(e);if(!i||i!==n.index){const r=[n.index,...n.additionalFiles||[]].map((e=>t.jsBaseUrl+"/"+e)),i=o.createDocumentFragment();r.forEach((e=>{const t=o.createElement("link");t.rel="prefetch",t.href=e,t.as="script",t.crossOrigin="anonymous",i.appendChild(t)})),o.head.appendChild(i),function(e,t){var n;Object(ho.a)()&&(null===(n=Object(ho.a)())||void 0===n||n.setItem(Ni(t),e))}(n.index,e)}return r}var Ri=n("Wx5u");class Fi{get NamespaceLogger(){return this}get PersistedProperties(){return this}get Disposable(){return this.disposable}addPersistedProperties(e){this.persistedProperties={...this.persistedProperties,...e}}getPersistedProperties(){var e,t,n;return{...null===(e=this.logger)||void 0===e||null===(t=e.PersistedProperties)||void 0===t||null===(n=t.getPersistedProperties)||void 0===n?void 0:n.call(t),...this.persistedProperties}}send(e){this.sendWithNamespace(e,this.namespace)}sendWithNamespace(e,t){var n;null===(n=this.logger)||void 0===n||n.sendWithNamespace({...this.persistedProperties,...e},t)}dispose(){this.logger=null}getNamespace(){return this.namespace}constructor(e,t,n){if(this.namespace=e,this.disposable={get Disposable(){return this},dispose:async()=>{this.logger=null}},t instanceof Fi){const e={...t.persistedProperties,...n};this.logger=t.logger,this.persistedProperties=e}else this.logger=t,this.persistedProperties=n}}const Bi=["facetCodes","statusCode","innerMostErrorCode","sprequestguid"];function Ui(e){const t=/[A-Z0-9._%`'+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}/gi;return Object.getOwnPropertyNames(e).map((n=>{if(-1===n.toLowerCase().indexOf("message")&&-1===n.toLowerCase().indexOf("error")&&-1===n.toLowerCase().indexOf("stack")&&!1===Bi.includes(n))return;let r=e[n];void 0!==r&&"string"==typeof r&&(r=r.toString().replace(t,"scrubbed_email"),e[n]=function(e){return e.replace(/(https:\/\/)(\w)+(.sharepoint.com|-my.sharepoint.com|.sharepoint-df.com)/,"(redacted)").replace(/(https:\/\/)(dev.loop.microsoft.com|df.loop.microsoft.com|loop.microsoft.com|preview.loop.microsoft.com|loop.cloud.microsoft|loop.cloud-dev.microsoft)(\/p\/)([a-zA-Z0-9%]+)/,"(redacted)")}(r.toString()))})),e}function Wi(e,t,n){n&&Hi(t,n);const r=Ui(t);e.send({...r,category:Ri.b.Error}),n&&n.isUserImpacting&&qi(e,r)}function qi(e,t){var n,r;let o=e;const i=`${null===(n=(r=o).getNamespace)||void 0===n?void 0:n.call(r)}_${t.eventName}`;o=new Fi("ContainerSession",e),o.send({...t,errorAction:i,category:Ri.b.Error})}function Hi(e,t){!function(e,t){var n;const r="object"==typeof e&&null!==e;function o(t){if(!r)return;const n=e[t];return"string"==typeof n?n:void 0}t.errorMessage=null!==(n=o("message"))&&void 0!==n?n:String(e),t.errorName=o("name"),t.stack=o("stack"),t.errorType=o("errorType"),t.errorInstanceId=o("errorInstanceId"),t.isUserImpacting=function(t){if(!r)return;const n=e.isUserImpacting;return"boolean"==typeof n?n:void 0}(),Bi.forEach((n=>{const r=e[n];r&&(t[n]="object"==typeof r?JSON.stringify(r):r)}))}(t,e),e.message=e.message?`${e.message}\n${e.errorMessage}`:e.errorMessage,void 0===e.stack&&(e.stack=function(){let e=(new Error).stack;if(!e)try{throw new Error}catch(t){e=t.stack}return e}())}new Set,new Set,new Map([["Automation",1],["SyntheticTraffic",1],["Local",1],["Staging",1],["Dogfood",.1],["Preview",.1],["Microsoft",.01],["Production",.001],["GCC",0],["GCC-High",0],["DoD",0]]);const zi=new Set;class Gi{static start(e,t,n){const r=new Gi(e,t,n);return zi.add(r),r}markSubActivityStart(e){this.subActivities[e]={startTime:performance.now(),startTimeSinceEpoch:Date.now()},this.addUserTiming&&performance.mark(this.getSubActivityName(e,"start"))}markSubActivityEnd(e,t){const n=this.subActivities[e];if(!n)return;if(this.addUserTiming){const t=this.getSubActivityName(e,"end");performance.mark(t),performance.measure(e,this.getSubActivityName(e,"start"),t)}const r={[`durationMs_${e}`]:Math.round(performance.now()-n.startTime)};this.logSubactivityStartTimes&&(r[`startTime_${e}`]=n.startTimeSinceEpoch),this.additionalPropsToLog={...r,...this.additionalPropsToLog,...t}}setResult(e,t,n,r){this.logActivityResult(e,t,n,null==r?void 0:r.skipLogging,void 0,null==r?void 0:r.sampleEvent)}cancel(e,t,n){this.logActivityResult(e,t,n,!1,!0)}addAdditionalProps(e){this.additionalPropsToLog={...this.additionalPropsToLog,...e}}dispose(){this.cancel();const e=e=>performance.clearMarks(e),t=e=>performance.clearMeasures(e);if(this.addUserTiming){e(this.activityStartName),e(this.activityEndName),this.cachedMeasureName&&t(this.cachedMeasureName);for(const n in this.subActivities)e(this.getSubActivityName(n,"start")),e(this.getSubActivityName(n,"end")),t(n)}}logActivityResult(e,t,n,r,o,i){if(this.hasAlreadyResolved)return;this.hasAlreadyResolved=!0,this.addUserTiming&&performance.mark(this.activityEndName);const s=performance.now(),a=Math.round(s-this.startTime);if(this.isAPerformanceMetric&&((function(){return window._pageTimings||(window._pageTimings={})}())[this.activityName]=a),this.logger&&!r){const r={eventName:this.activityName,startTime:this.startTimeSinceEpoch,durationMs:a,succeeded:e,sampleEvent:i,resultType:o?Ri.a.Cancelled:e?Ri.a.Success:Ri.a.Failure,...this.additionalPropsToLog,...t};!function(e,t,n){n&&Hi(t,n),t.resultType||void 0===t.succeeded||(t.resultType=t.succeeded?Ri.a.Success:Ri.a.Failure);const r=Ui(t);e.send({...r,category:Ri.b.Activity}),t.resultType===Ri.a.Failure&&n&&n.isUserImpacting&&qi(e,r)}(this.logger,r,n)}this.logger=void 0,zi.delete(this),this.addUserTiming&&performance.measure(this.generateMeasureName(e),this.activityStartName,this.activityEndName)}generateMeasureName(e){return this.cachedMeasureName=`${this.activityName}${!1===e?"-FAILED":""}-${this.identifier}`,this.cachedMeasureName}getSubActivityName(e,t){return`${e}-${t}-${this.identifier}`}constructor(e,t,n){var r;this.activityName=e,this.logger=t,this.isAPerformanceMetric=!1,this.additionalPropsToLog=null==n?void 0:n.additionalPropsToLog,this.addUserTiming=null==n?void 0:n.addUserTiming,this.isAPerformanceMetric=(null==n?void 0:n.isAPerformanceMetric)||!1,this.logSubactivityStartTimes=null===(r=null==n?void 0:n.logSubactivityStartTimes)||void 0===r||r,this.subActivities={},this.identifier=Object(kt.a)(),this.activityStartName=`${this.activityName}-start-${this.identifier}`,this.activityEndName=`${this.activityName}-end-${this.identifier}`,this.addUserTiming&&performance.mark(this.activityStartName),this.startTime=performance.now(),this.startTimeSinceEpoch=Date.now()}}var Vi=n("PtL/");const $i={maxRetries:3,filter:Object(vo.c)([429,500,503]),backoffFn:Object(bo.c)(500)},Qi=/.+\S\([^\(\)]+\)$/;function Ji(e){const t=Vi.a.get(e);if(null!=t)return Yi(t)}function Xi(e){var t;const n=null===(t=Object(ho.a)())||void 0===t?void 0:t.getItem(e);if(null!=n)return Yi(n)}function Ki(e){return 2===(e.cacheVersion||0)&&void 0!==e.expires&&e.expires.valueOf()>Date.now()}function Yi(e){if(null!=e){let t;try{t=JSON.parse(e)}catch(e){}const n=void 0!==t?t:e;return"on"===n||"off"===n?"on"===n:n}}class Zi{get settingsFetchedFromEcs(){return this._settingsFetchedFromEcs}async fetch(){if(this.ecsClientConfiguration.alwaysFetchNewSettings||void 0===this.ecsResponseFromCache||!Ki(this.ecsResponseFromCache)||this.ecsResponseFromCache.sessionId!==this.ecsClientConfiguration.sessionId){const e=function(e){const t=new URLSearchParams;if(t.append("agents",e.teamNames.join(",")),e.guestAgents){const n={};for(let t=0;t<e.guestAgents.length;t+=1){const r=e.guestAgents[t].substring(e.guestAgents[t].indexOf("(")+1,e.guestAgents[t].indexOf(")")),o=e.guestAgents[t].substring(0,e.guestAgents[t].indexOf("("));n[r]=n[r]?`${n[r]},${o}`:o}Object.entries(n).forEach((e=>{let[n,r]=e;t.append("guestAgents",`${r}(${n})`)}))}Object.entries(e.filters).forEach((e=>{let[n,r]=e;void 0!==r&&t.append(n,r)}));const n=t.toString();return`${e.host}/config/v1/${e.clientName}/${e.clientVersion}${""!==n?`?${n}`:""}`}(this.ecsClientConfiguration);return this.ecsResponsePromise||(this.ecsResponsePromise=this.fetthen((e=>{e&&this.cacheEcsResponse(e),this._settingsFetey(e,t){return`${e}_${t}`}getSetting(e,t,n){return this.getSettingInternal(e,t,n)}async getLiveSetting(e,t,n){return this.getLiveSettingInternal(e,t,n)}getSettingInternal(e,t,n){let r;const o=this.getSettingKey(e,n);return void 0!==(r=this.previouslyAccessedEcsSettings.get(o))||(void 0!==(r=Ji(e))||void 0!==(r=Xi(e))||void 0!==(r=this.getSettingFromCachedEcsResponse(e,n))||(r=t),this.previouslyAccessedEcsSettings.set(o,r)),r}async getLiveSettingInternal(e,t,n){var r,o;let i;const s=this.getSettingKey(e,n);if(void 0!==(i=this.previouslyAccessedEcsSettings.get(s)))return i;if(void 0!==(i=Ji(e))||(i=Xi(e)),void 0!==i)return this.previouslyAccessedEcsSettings.set(s,i),i;const a=this._settingsFetchedFromEcs?null===(r=this.getAllCachedEcsResponses())||void 0===r?void 0:r[this.ecsClientConfiguration.cacheKey]:await this.fetch();return void 0!==(i=null==a||null===(o=a.ecsTeamsSettings[n])||void 0===o?void 0:o[e])||(i=t),this.previouslyAccessedEcsSettings.set(s,i),i}getSettingFromCachedEcsResponse(e,t){var n;return(null===(n=this.ecsResponseFromCache)||void 0===n?void 0:n.ecsTeamsSettings[t])&&this.ecsResponseFromCache.ecsTeamsSettings[t][e]}async fetchAndParse(e){const t=Gi.start("EcsFetch",this.logger,{addUserTiming:!0});let n;try{n=await Object(vo.a)(e,void 0,$i)}catch(e){return void t.setResult(!1,{},e)}if(200!==n.result.status){const e=new Error("Failed to Fetch from ECS. Response is not 200");return void t.setResult(!1,{status:n.result.status,statusText:n.result.statusText},e)}const r=this.parseResponseToEcsResponse(n);return r.then((n=>{let r;performance.getEntriesByName(e).map((e=>{e.name.includes(this.ecsClientConfiguration.host)&&(r=e.duration)})),t.setResult(!0,{eTag:n.eTag,networkDurationMs:r,configIds:JSON.stringify(n.configIDs)})})).catch((e=>{t.setResult(!1,{},e)})),r}async parseResponseToEcsResponse(e){var t;const n=await e.result.json(),r=[...this.ecsClientConfiguration.teamNames],o={};null===(t=this.ecsClientConfiguration.guestAgents)||void 0===t||t.forEach((e=>{if(Qi.test(e)){const t=e.substring(0,e.indexOf("("));r.push(t)}else this.logger&&Wi(this.logger,{eventName:"ecsTeamFormat"},new Error(`${e} doesn't match the format <EcsTeam>(<EcsClient>)`))}));for(let e=0;e<r.length;e+=1)n[r[e]]&&(o[r[e]]=n[r[e]]);const i=e.result.headers.get("ETag")||"",s=n.ConfigIDs||{};let a;if(this.ecsClientConfiguration.cacheExpiresDurationOverrideInMin)a=new Date(Date.now()+6e4*this.ecsClientConfiguration.cacheExpiresDurationOverrideInMin);else{const t=e.result.headers.get("Expires");a=t?new Date(t):void 0}return{ecsTeamsSettings:o,eTag:i,configIDs:s,expires:a,cacheVersion:2,sessionId:this.ecsClientConfiguration.sessionId}}cacheEcsResponse(e){const t=Object(ho.a)();if(t)try{const n=this.getAllCachedEcsResponses()||{};n[this.ecsClientConfiguration.cacheKey]=e,t.setItem(this.ecsClientConfiguration.responsesCacheKey,JSON.stringify(n))}catch(e){this.logger&&Wi(this.logger,{eventName:"cacheEcsResponse"},e)}}getAllCachedEcsResponses(){try{const e=Object(ho.a)(),t=null==e?void 0:e.getItem(this.ecsClientConfiguration.responsesCacheKey),n=t&&JSON.parse(t);if(!n||0===Object.keys(n).length)return;return Object.entries(n).forEach((e=>{let[t,n]=e;"string"==typeof n.expires&&(n.expires=new Date(n.expires))})),n}catch(e){this.logger&&Wi(this.logger,{eventName:"getAllCachedEcsResponses"},e)}}loadAndClearCache(){const e=this.getAllCachedEcsResponses();if(e){const t=e[this.ecsClientConfiguration.cacheKey];t&&(this.ecsResponseFromCache=t,this.logger&&function(e,t){const n=Ui(t);e.send({...n,category:Ri.b.Generic})}(this.logger,{eventName:"loadedEcsResponseFromCache",settings:JSON.stringify(this.ecsResponseFromCache.ecsTeamsSettings),eTag:this.ecsResponseFromCache.eTag,configIds:JSON.stringify(this.ecsResponseFromCache.configIDs)})),this.clearExpiredEcsResponsesFromCache(e)}}clearExpiredEcsResponsesFromCache(e){try{const t=Object(ho.a)();if(!t)return;const n={};Object.entries(e).forEach((e=>{let[t,r]=e;(Ki(r)||t===this.ecsClientConfiguration.cacheKey)&&(n[t]=r)})),t.setItem(this.ecsClientConfiguration.responsesCacheKey,JSON.stringify(n))}catch(e){this.logger&&Wi(this.logger,{eventName:"clearExpiredEcsResponsesFromCache"},e)}}constructor(e,t){this.ecsClientConfiguration=e,this.previouslyAccessedEcsSettings=new Map,this._settingsFetchedFromEcs=!1,this.logger=t&&new Fi("EcsClient",t),this.loadAndClearCache()}}function es(e){switch(e){case"Automation":case"SyntheticTraffic":case"Local":case"Staging":case"Dogfood":case"Preview":case"Microsoft":case"Production":case"GCC":return"https://ecs.office.com";case"GCC-High":return"https://config.ecs.gov.teams.microsoft.us";case"DoD":return"https://config.ecs.dod.teams.microsoft.us";case"USNat":return"https://config.ecs.teams.eaglex.ic.gov";case"USSec":return"https://config.ecs.teams.microsoft.scloud";default:throw new Error("Unexpected audience value provided")}}classetchedFromEcs(){return this.ecsClient.settingsFetchedFromEcs}get Disposable(){return this}dispose(){}async fetchSettings(){await this.ecsClient.fetch()}getSetting(e,t,n){return this.ecsClient.getSetting(e,t,n)}async getLiveSetting(e,t,n){return this.ecsClient.getLiveSetting(e,t,n)}constructor(e,t){this.ecsClient=new Zi(function(e){var t,n,r;const{ecsFilters:o,hostName:i,sessionId:s,responsesCacheKeyOverride:a,cacheExpiresDurationOverrideInMin:c,fetchFluidExperiencesSettings:u=!0,fetchHostExperiencesSettings:l=!0,fetchSegmentationSettings:d=!0,alwaysFetchNewSettings:h}=e,{userContext:f,audience:p}=o,m=(null===(t=f.user)||void 0===t?void 0:t.id)||(null===(n=f.user)||void 0===n?void 0:n.oid),g={audience:p,userId:m,tenantId:null===(r=f.user)||void 0===r?void 0:r.tenantId,hostName:i},v=`${m}${i}${p}`,b=a||"FluidEcsClientResponses",y=[];return u&&y.push("FluidExperiences"),l&&y.push("HostExperiences"),d&&y.push("Segmentation"),{host:es(p),clientName:"Fluid",clientVersion:"0.0.0.1",teamNames:y,filters:g,cacheKey:v,responsesCacheKey:b,cacheExpiresDurationOverrideInMin:c,sessionId:s,alwaysFetchNewSettings:h}}(e),t),this.audience=e.ecsFilters.audience,this.fetchSettings().catch((e=>{}))}}var ns;function rs(e){var t;const n=JSON.parse(e.tree.attributes.content);return n.term=null!==(t=n.term)&&void 0!==t?t:1,n}!function(e){e.Tree=1,e.Blob=2,e.Handle=3,e.Attachment=4}(ns||(ns={}));class o!==arguments[0]?arguments[0]:36e5,this.cache=new Map,this.docIdExpirationMap=new Map}async get(e){const st n=this.keyFromEntry(e);this.cache.set(n,t),this.updateExpirationEntry(e.file.docId)}async removeEntries(e){this.removeDocIdEntriesFromCache(e.docId)}removeDocIdEntriesFromCache(e){return this.removeExpirationEntry(e),Array.from(this.cache).filter((t=>{let[n]=t;if(n.split("_")[0]===e)return!0})).map((e=>{let[t]=e;this.cache.delete(t)}))}removeExpirationEntry(e){const t=this.docIdExpirationMap.get(e);void 0!==t&&(clearTimeout(t),this.docIdExpirationMap.delete(e))}updateExpirationEntry(e){this.removeExpirationEntry(e),this.docIdExpirationxpiryPolicy))}keyFromEntry(e){return`${e.file.docId}_${e.type}_${e.key}`}}class is{constructor(){this.sessionJoinCache=new bt,this.fileUrlCache=new bt}}var ss,as=n("25GD");function cs(e,t,n){var r,o;const i=Object.assign({},t),s=n.online;if(i.online="string"==typeof s?s:nt.f[Object(nt.l)()],"object"==typeof navigator&&null!==navigator){const e=navigator,t=null!==(o=null!==(r=e.connection)&&void 0!==r?r:e.mozConnection)&&void 0!==o?o:e.webkitConnection;null!==t&&"object"==typeof t&&(i.connectionType=t.type)}i.category=Object(nt.i)(n)?"generic":"error",e.sendTelemetryEvent(i,n)}function us(e){return new Promise((t=>{let n=t,r=e;Object(nt.l)()===nt.f.Offline&&void 0!==(null===window||void 0===window?void 0:window.addEventListener)&&(n=()=>{t(),window.removeEventListener("online",n)},window.addEventListener("online",n,!1),r=Math.max(e,3e4)),setTimeout(n,r)}))}class ls{constructor(e,t,n,r,o,i){this.to=t,this.payloadSize=n,this.logger=r,this.requestCallback=o,this.responseCallback=i,this.results=new Map,this.workingState="working",this.requestsInFlight=0,tted=e"===this.workingState}get canceled(){return"canceled"===this.workingState}cancel(){this.working&&(this.workingState="canceled",this.endEvent.resolve())}async run(e){Object(Ze.a)(e>0,258),Object(Ze.a)(this.working,259);let t=e;for(;t>0;)t--,this.addRequest();return this.dispatch(),this.endEvent.promise}done(){Object(Ze.a)(void 0!==this.to,260),Object(Ze.a)(this.nextToDeliver>=this.to,261),this.working&&(this.workingState="done",this.endEvent.resolve())}fail(e){this.working&&(this.workingState="done",this.endEvent.reject(e))}dispatch(){for(;this.working;){const e=this.results.get(this.nextToDeliver);if(void 0===e)break;this.results.delete(this.nextToDeliver),Object(Ze.a)(e.length<=this.payloadSize,473),this.nextToDeliver+=e.length,this.responseCallback(e)}this.working&&(0===this.requestsInFlight?(Object(Ze.a)(0===this.results.size,263),this.done()):void 0!==this.to&&this.nextToDeliver>=this.to&&(Object(Ze.a)(!this.knewTo,264),this.done()))}getNextChunk(){if(!this.working)return;const e=this.latestRequested;return void 0!==this.to&&this.to<=e?void 0:(this.latestRequested+=this.payloadSize,void 0!==this.to&&(this.latestRequested=Math.min(this.to,this.latestRequested)),Object(Ze.a)(e<this.latestRequested,265),{from:e,to:this.latestRequested})}addRequest(){const e=this.getNextChunk();void 0!==e&&this.addRequestCore(e.from,e.to).catch(this.fail.bind(this))}async addRequestCore(e,t){Object(Ze.a)(this.working,266);let n=e,r=t;for(this.requestsInFlight++;this.working;){const e=r-n;Object(Ze.a)(e>0,267),void 0!==this.to&&(Object(Ze.a)(n<this.to,268),Object(Ze.a)(r<=this.to,269)),this.requests++;const t=this.requestCallback(this.requests,n,r,void 0!==this.to,{});this.dispatch();const{payload:o,cancel:i,partial:s}=await t;if(i&&this.cancel(),void 0!==this.to&&n>=this.to){Object(Ze.a)(!this.knewTo,270),0!==o.length&&this.logger.sendErrorEvent({eventName:"ParallelRequests_GotExtra",from:n,to:r,end:this.to,length:o.length});break}if(this.working){const t=n,i=o.length;let a=e<=i;if(0!==i){e<i&&this.logger.sendTelemetryEvent({eventName:"ParallelRequests_Over",from:n,to:r,length:i});const t=o.splice(0,e);this.results.set(n,t),n+=t.length}else Object(Ze.a)(!s,271),Object(Ze.a)(!this.knewTo,272);if(!s&&!a){if(!this.knewTo){(void 0===this.to||this.to>n)&&(this.to=n);break}this.logger.sendPerformanceEvent({eventName:"ParallelRequests_Partial",from:t,to:r,length:i})}if(r===this.latestRequested&&(0!==o.length&&(this.results.set(n,o),n+=o.len e=this.getNextChunk();if(void 0===e)break;n=e.from,r=e.to}}}this.requestsInFlight--,this.dispatch()}}class ds{constructor(){this.queue=[],this.done=!1}pushValue(e){this.pushCore(Promise.resolve({done:!1,value:e}))}pushError(e){this.pushCore(Promise.reject(e)),this.done=!0}pushDone(){this.pushCore(Promise.resolve({done:!0})),this.done=!0}pushCore(e){Object(Ze.a)(!this.done,274),this.deferred?(Object(Ze.a)(0===this.queue.length,275),this.deferred.resolve(e),this.deferred=void 0):this.queue.push(e)}async read(){Object(Ze.a)(void 0===this.deferred,276);const e=this.queue.shift();return void 0!==e?e:(Object(Ze.a)(!this.done,277),this.deferred=new Et,this.deferred.promise)}}class hs{constructor(e,t,n,r){this.deltaFeedUrl=e,this.getStorageToken=t,this.epochTracker=n,this.logger=r}async get(e,t,n,r){return Object(ct.i)((async o=>{const i=this.buildUrl(e,t),s=await this.getStorageToken(o,"DeltaStorage"),a=Object(kt.a)();let c=`--${a}\r\n`;c+=`Authorization: Bearer ${s}\r\n`,c+="X-HTTP-Method-Override: GET\r\n",c+="_post: 1\r\n",c+=`\r\n--${a}--`;const u={"Content-Type":`multipart/form-data;boundary=${a}`},l=new lr.a,d=setTimeout((()=>l.abort()),3e4),h=await this.epochTracker.fetchAndParseAsJSON(i,{headers:u,body:c,method:"POST",signal:l.signal},"ops",!0,r);clearTimeout(d);const f=h.content,p=f.value.length>0&&"op"in f.value[0]?f.value.map((e=>e.op)):f.value;return this.logger.sendPerformanceEvent(Object.assign(Object.assign(Object.assign(Object.assign({eventName:"OpsFetch",headers:0!==Object.keys(u).length||void 0,length:p.length,duration:h.duration},h.propsToLog),{attempts:o.refresh?2:1,from:e,to:t}),n),{reason:r})),{messages:p,partialResult:!1}}))}buildUrl(e,t){const n=encodeURIComponent(`sequenceNumber ge ${e} and sequenceNumber le ${t-1}`);return`${this.deltaFeedUrl}?ump=1&filter=${n}`}}class fs{constructor(e,t,n,r,o,i,s,a){this.snapshotOps=e,this.logger=t,this.batchSize=n,this.concurrency=r,this.getFromStorage=o,this.getCached=i,this.requestFromSocket=s,this.opsReceived=a,this.firstCacheMiss=Number.MAX_SAFE_INTEGER}validateMessages(e,t,n){if(0!==t.length){const r=t[0].sequenceNumber,o=t.length,i=t[o-1].sequenceNumber;r!==n&&(this.logger.sendErrorEvent({eventName:"OpsFetchViolation",reason:e,from:n,start:r,last:i,length:o}),t.length=0),i+1!==n+o&&(this.logger.sendErrorEvent({eventName:"OpsFetchViolation",reason:e,from:n,start:r,last:i,length:o}),t.length=0)}}fetchMessages(e,t,n,r,o){Object(Ze.a c=async(e,t,n)=>{if(void 0!==this.snapshotOps&&0!==this.snapshotOps.length){const n=this.snapshotOps.filter((n=>n.sequenceNumber>=e&&n.sequenceNumber<t));if(this.validateMessages("cached",n,e),n.length>0&&n[0].sequenceNumber===e)return this.snapshotOps=this.snapshotOps.filter((e=>e.sequenceNumber>=t)),i=n.length,{messages:n,partialResult:!0};this.snapshotOps=void 0}if(this.requestFromSocket(e,t),e<this.firstCacheMiss){const n=await this.getCached(e,t);if(this.validateMessages("cached",n,e),0!==n.length)return s+=n.length,{messages:n,partialResult:!0};this.firstCacheMiss=Math.min(this.firstCacheMiss,e)}if(r)return{messages:[],partialResult:!1};const c=await this.getFromStorage(e,t,n,o);return this.validateMessages("storage",c.messages,e),a+=c.messages.length,this.opsReceived(c.messages),c};return function(e,t){return{read:async()=>{const n=await e.read();return t(n),n}}}(function(e,t,n,r,o,i,s,a){let c,u=0,l=0;const d=new ds,h={fromTotal:n,toTotal:r},f=wt.c.start(i,Object.assign(Object.assign({eventName:"GetDeltas"},h),{reason:a})),p=new ls(n,r,o,i,(async(t,n,r,o,c)=>(u++,async function(e,t,n,r,o,i){let s,a=0;const c=[];for(;!0!==(null==o?void 0:o.aborted);){a++;let o=Math.min(1e4,100*Math.pow(2,a));const u=Ot.a.now();try{const r=e(Object.assign(Object.assign({},t),{retry:a})),{messages:o,partialResult:i}=await r;if(c.push(...o),0!==o.length||!n)return{payload:c,cancel:!1,partial:i};if(void 0===s)s=Ot.a.now();else if(Ot.a.now()-s>3e4)throw Object(nt.j)("Failed to retrieve ops from storage (Too Many Retries)",{canRetry:!1},Object.assign({retry:a,driverVersion:"2.0.0-internal.1.4.6"},t))}catch(e){const n=Object(nt.i)(e);s=void 0;const c=Object(nt.k)(e);if(cs(r,Object.assign(Object.assign({eventName:"GetDeltas_Erroration:Ot.a.now()-u,retryAfter:c,reason:i}),e),!n)throw e;void 0!==c&&c>=0&&(o=c)}await us(o)}return{partial:!1,cancel:!0,payload:[]}}((async t=>e(n,r,t)),Object.assign(Object.assign({request:t,from:n,to:r},h),c),o,i,s,a))),(e=>{void 0===c?Object(Ze.a)(e[0].sequenceNumber===n,621):Object(nceNumber===c+1,622),c=e[e.length-1].sequenceNumber,Object(Ze.a)(c-.pushValue(e)})),m=e=>{p.cancel()};return void 0!==s&&s.addEventListener("abort",m),p.run(t).finally((()=>{void 0!==s&&s.removeEventListener("abort",m)})).then((()=>{const e={lastFetch:c,length:l,requests:u};p.canceled?f.cancel(Object.assign(Object.assign({},e),{error:"ops request cancelled by client"})):(Object(Ze.a)(void 0===r||void 0!==c&&c>=r-1,624),f.end(e)),d.pushDone()})).catch((e=>{f.cancel({lastFetch:c,length:l,requests:u},e),d.pushError(e)})),d}((async(e,t,n)=>{const r=await c(e,t,n);return this.validateMessages("catch all",r.messages,e),r}),this.concurrency,e,t,this.batchSize,this.logger,n,o),(e=>{e.done&&i+s+a!==0&&this.logger.sendPerformanceEvent({eventName:"CacheOpsRetrieved",opsFromSnapshot:i,opsFromCache:s,opsFromStorage:a})}))}}class ps extends tr.EventEmitter{constructor(){super(),this.addListener=super.addListener.bind(this),this.on=super.on.bind(this),this.once=super.once.bind(this),this.prependListener=super.prependListener.bind(this),this.prependOnceListener=super.prependOnceListener.bind(this),this.removeListener=super.removeListener.bind(this),this.off=super.off.bind(this)}}!function(e){e.DocRead="doc:read",e.DocWrite="doc:write",e.SummaryWrite="summary:write"}(ss||(ss={}));const ms="2.0.0-internal.1.4.6";class gs extends rr{constructor(e,t,n){var r;let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];super(((e,t)=>{n.sendErrorEvent({eventName:"DeltaConnection:EventException",name:e},t)})),r=this,this.socket=e,this.documentId=t,this.enableLongPollingDowngrades=o,this.queuedMessages=[],this.queuedSignals=[],this.earlyOpHandlerAttached=!1,this.connectionListeners=new Map,this.trackedListeners=new Map,this._disposed=!1,this.earlyOpHandler=(e,t)=>{this.queuedMessages.push(...t)},this.earlySignalHandler=e=>{this.queuedSignals.push(e)},this.mc=Object(It.c)(wt.a.create(n,"DeltaConnection")),this.on("newListener",((e,t)=>{if(Object(Ze.a)(!this.disposed,522),gs.eventsAlwaysForwarded.includes(e))Object(Ze.a)(this.trackedListeners.has(e),581);else{if(!gs.eventsToForward.includes(e))throw new Error(`DocumentDeltaConnection: Registering for unkns.trackedListeners.has(e)||this.addTrackedListener(e,(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];r.emit(e,...n)}))}}))}get hasDetailsn this.mc.logger}get details(){if(!this._details)throw new Error("Internal error: calling method before _details is initialized!");return this._details}get clientIs(){return this.details.claims}get existing(){return this.details.existing}get maxMessageSize(){return this.details.serviceConfiguration.maxMessageSize}get version(){return this.details.version}get serviceConfiguration(){return this.details.serviceConfiguration}checkNotClosed(){Object(Ze.a)(!this.disposed,524)}get initialMessages(){return this.checkNotClosed(),Object(Ze.a)(this.earlyOpHandlerAttached,142),Object(Ze.a)(0!==this.listeners("op").length,143),this.removeEarlyOpHandler(),this.queuedMessages.length>0&&(this.details.initialMessages.push(...this.queuedMessages),this.details.initialMessages.sort(((e,t)=>e.sequenceNumber-t.sequenceNumber)),this.queuedMessages.length=0),this.details.initialMessages}get initialSignals(){return this.checkNotClosed(),Object(Ze.a)(0!==this.listeners("signal").length,144),this.removeEarlySignals.queuedSignals),this.queuedSignals.length=0),this.details.initialSickNotis.disposed||this.socket.emit(e,this.clientId,t)}submitCore(e,t){this.emitMessages(e,[t])}submit(e){this.checkNotClosed(),this.submitCore("submitOp",e)}submitSignal(e){this.checkNotClosed(),this.submitCore("submitSignal",[e])}dispose(){this.disposeCore(!1,Object(nt.j)("Client closing delta connecti:ms}))}disposeCore(e,t){this._disposed||(this._disposed=!0,this.removeTrackedListeners(),this.disconnect(e,t))}disconnect(e,t){this.socket.disconnect()}async initialize(e,t){this.socket.on("op",this.earlyOpHandler),this.socket.on("signal",this.earlySignalHandler),this.earlyOpHandlerAttached=!0;let n=0;const r=()=>this.socket.io.reconnection(),o=()=>r()?this.socket.io.reconnectionAttempts():0;this._details=await new Promise(((i,s)=>{const a=(e,t)=>{this.disposeCore(e,t),s(t)};this.addConnectionListener("connect_error",(e=>{var t;n++;let i=!1;try{const t=null==e?void 0:e.description;t&&"object"==typeof t&&("TransportError"===e.type&&(i=!0),t.target=void 0)}catch(e){}i&&this.enableLongPollingDowngrades&&"polling"!==(null===(t=this.socket.io.opts.transports)||void 0===t?void(this.socket.io.opts.transports=["polling","websocket"],r()||(this.socket.io.reconnection(!0),this.socket.io.reconnectionAttempts(1))),r()&&n<(()=>o()+1)()||a(!0,this.createErrorObject("connect_error",e))})),this.addConnectionListener("connect_timeout",(()=>{a(!0,this.createErrorObject("connect_timeout"))})),this.addConnectionListener("connect_document_success",(t=>{if(void 0!==e.nonce&&void 0!==t.nonce&&t.nonce!==e.nonce)return;const n=e.mode,r=t.mode;if(t.claims.scopes.includes(ss.DocWrite)){if(r!==n)return void a(!1,this.createErrorObject("connect_document_success","Connected in a different mode than was requested",!1))}else if("write"===r)return void a(!1,this.createErrorObject("connect_document_success","Connected in write mode without write permissions",!1));this.checkpointSequenceNumber=t.checkpointSequenceNumber,this.removeConnectionListeners(),i(t)})),this.addTrackedListener("disconnect",(e=>{const t=this.createErrorObject("disconnect",e);this.emit("disconnect",t),a(!0,t)})),this.addTrackedListener("error",(e=>{const t=this.createErrorObject("error",e,"Invalid namespace"!==e);this.emit("error",t),a(!0,t)})),this.addConnectionListener("connect_document_error",(t=>{void 0!==e.nonce&&void 0!==t.nonce&&t.nonce!==e.nonce||a(!1,this.createErrorObject("connect_document_error",t))})),this.socket.emit("connect_document",e),thtener("op",this.earlyOpHandler),this.earlyOpHandlerAttached=!1}removeEarlySignalHandler(){this.socket.removeListener("signal",this.earlySignalHandler)}addConnectionListener(e,t){Object(Ze.a)(!gs.eventsAlwaysForwarded.includes(e),583),Object(Ze.a)(!gs.eventsToForward.includes(e),584),this.socket.on(e,t),Object(Ze.a)(!this.connectionListeners.has(e),525),this.connectionListeners.set(e,t)}addTrackedListener(e,t){this.socket.on(e,t),Object(Ze.a)(!this.trackedListeners.has(e),526),this.trackedListeners.set(e,t)}removeTrackedListeners(){for(const[e,t]of this.trackedListeners.entries())this.socket.off(e,t);this.removeConnectionListeners(),this.removeEarlyOpHandler(),this.removeEarlySignalHandler(),this.trackedListeners.clear()}removeConnectionListeners(){void 0!==this.socketConnectionTimeout&&clearTimeout(this.socketConnectionTimeout);for(const[e,t]of this.connectionListeners.entries())this.socket.off(e,t);this.connectionListeners.clear()}createErrorObject(e,t){let n,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return n="TransportError"===(null==t?void 0:t.type)?`${void 0!==(null==t?void 0:t.message)?`${t.message}: `:""}${JSON.stringify(t,Object(At.e)())}`:Object(At.c)(t,!0).message,Object(nt.j)(`socket.io (${e}): ${n}`,{canRetry:r},{driverVersion:ms})}}function vs(e,t){try{const n=`ODSP socket error (${t}): ${e.message}`,r=Object(as.a)(n,e.code,e.retryAfter);return r.addTelemetryProperties({odspError:!0,relayServiceError:!0}),r}catch(e){return new nt.e("Internal error: errorObjectFromSocketError",tt.a.fileNotFoundOrAccessDeniedError,{driverVersion:lt.a})}}gs.eventsToForward=["nack","op","signal","pong"],gs.eventsAlwaysForwarded=["disconnect","error"];const bs=["^0.4.0","^0.3.0","^0.2.0","^0.1.0"];class ys extends ps{constructor(e,t){super(),this.key=e,this.references=1,this.isPendingInitialConnection=!0,this._socket=t,Object(Ze.a)(!ys.socketIoSockets.has(e),544),ys.socketIoSockets.set(e,this),t.on("server_disconnect",(e=>{const t=vs(e,"server_disconnect");t.canRetry=!0,this.isPendingInitialConnection=!1,this.emit("server_disconnect",t),this.closeSocket()}))}static find(e,t){const n=ys.socketIoSockets.get(e);if(!(null==n?void 0:n.disconnected))return n&&(n.clearTimer(),n.references++),n;n.closeSocket()}removeSocketIoReference(e){Object(Ze.a)(this.references>0,159),this.references--,this.isPendingInitialConnection=!1,e||this.disconnected?this.closeSocket():0===this.references&&void 0===this.delayDeleteTimeout&&(this.delayDeleteTimeout=setTimeout((()=>{Object(Ze.a)(0===this.references,160),this.closeSocket()}),2e3))}get socket(){if(!this._socket)throw new Error(`Invalid socket for key "${this.key}`);return this._socket}clearTimer(){void 0!==this.delayDeleteTimeout&&(clearTimeout(this.delayDeleteTimeout),this.delayDeleteTimeout=void 0)}closeSocket(){if(!this._socket)return;this.clearTimer(),Object(Ze.a)(ys.socketIoSockets.get(this.key)===this,161),ys.socketIoSockets.delete(this.key);const e=this._socket;this._socket=void 0,Promise.resolve().then((()=>{e.disconnect()}))}get disconnected(){return void 0===this._socket||!this.socket.connected&&!this.isPendingInitialConnection}}ys.socketIoSockets=new Map;class ws extends gs{constructor(e,t,n,r,o){super(e,t,r),this.enableMultiplexing=o,this.pushCallCounter=0,this.getOpsMap=new Map,this.serverDisconnectHandler=e=>{this.logger.sendTelemetryEvent({eventName:"ServerDisconnect",clientId:this.clientId},e),this.disposeCore(!0,e)},this.socketReference=n,this.requestOpsNoncePrefix=`${Object(kt.a)()}-`}static async create(e,t,n,r,o,i,s,a,c,u){const l=Object(It.c)(s),d=new URL(i),h=!d.searchParams.has("documentId")&&!d.searchParams.has("tenantId"),f=u?`${u},${i}`:i,p=ws.getOrCreateSocketIoReference(r,a,h?f:`${f},${e},${t}`,i,h,e,t,s),m=p.socket,g={client:o,id:t,mode:o.mode,tenantId:e,token:n,versions:bs,nonce:Object(kt.a)(),epoch:c.fluidEpoch,relayUserAgent:[o.details.environment,` driverVersion:${lt.a}`].join(";"),supportedFeatures:{}};!1!==l.config.getBoolean("Fluid.Driver.Odsp.GetOpsEnabled")&&(g.supportedFeatures.api_get_ops=!0);const v=new ws(m,t,p,s,h);try{await v.initialize(g,a),await c.validateEpochFromPush(v.details)}catch(e){throw null!==e&&"object"==typeof e&&(400!==e.statusCode&&404!==e.statusCode||(e.canRetry=!0)),e}return v}createErrorObject(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return n&&Number.isInteger(null==t?void 0:t.code)&&"string"==typeof(null==t?void 0:t.message)?vs(t,e):super.createErrorObject(e,t,n)}static getOrCreateSocketIoReference(e,t,n,r,o,i,s,a){const c=ys.find(n,a);if(c)return c;const u=e(r,{multiplex:!1,query:o?void 0:{documentId:s,tenantId:i},reconnection:!1,transports:["websocket"],timeout:t});return new ys(n,u)}requestOps(e,t){var n;if(Object(Ze.a)(t>e,626),!0!==(null===(n=this.details.supportedFeatures)||void 0===n?void 0:n.api_get_ops))return;this.pushCallCounter++;const r=`${this.requestOpsNoncePrefix}${this.pushCallCounter}`,o=Ot.a.now();if(this.getOpsMap.size>=5){let e,t=o;for(const[n,r]of this.getOpsMap.entries())(r.start<=t||void 0===e)&&(t=r.start,e=n);const n=this.getOpsMap.get(e);this.logger.sendErrorEvent({eventName:"GetOpsTooMany",nonce:r,from:n.from,to:n.to,length:n.to-n.from,duration:Ot.a.now()-n.start}),this.getOpsMap.delete(e)}this.getOpsMap.set(r,{start:o,from:e,to:t}),this.socket.emit("get_ops",this.clientId,{nonce:r,from:e,to:t-1})}async flush(){var e;if(!0!==(null===(e=this.details.supportedFeatures)||void 0===e?void 0:e.api_flush_ops))throw this.logger.sendErrorEvent({eventName:"FlushOpsNotSupported"}),new Error("flush() API is not supported by PUSH, required for single-commit summaries");this.pushCallCounter++;const t=`${this.requestOpsNoncePrefix}${this.pushCallCounter}`;return void 0!==this.flushDeferred&&(this.logger.sendErrorEvent({eventName:"FlushOpsTooMany"}),this.flushDeferred.reject("process involving flush() was cancelled OR unsupported concurrency")),this.socket.emit("flush_ops",this.clientId,{nonce:t}),this.flushOpNonce=t,this.flushDeferred=new Et,this.flushDeferred.promise}async initialize(e,t){this.enableMultiplexing&&(this.earlyOpHandler=(e,t)=>{this.documentId===e&&this.queuedMessages.push(...t)},this.earlySignalHandler=(e,t)=>{void 0!==t&&t!==this.documentId||this.queuedSignals.push(e)}),this.socketReference.on("server_disconnect",this.serverDisconnectHandler),this.socket.on("get_ops_response",(e=>{const t=e.messages,n=this.getOpsMap.get(e.nonce);if(void 0!==n||0===e.nonce.indexOf(this.requestOpsNoncePrefix)){this.getOpsMap.delete(e.nonce);const r={eventName:"GetOps",nonce:void 0===n?e.nonce:void 0,code:e.code,from:null==n?void 0:n.from,to:null==n?void 0:n.to,duration:void 0===n?void 0:Ot.a.now()-n.start};void 0!==t&&t.length>0?(this.logger.sendPerformanceEvent(Object.assign(Object.assign({},r),{first:t[0].sequenceNumber,last:t[t.length-1].sequenceNumber,length:t.length})),this.emit("op",this.documentId,t)):this.logger.sendPerformanceEvent(Object.assign(Object.assign({},r),{length:0}))}})),this.socket.on("flush_ops_response",(e=>{if(this.flushOpNonce===e.nonce){const t=e.lastPersistedSequenceNumber;let n="generic";if(void 0===e.lastPersistedSequenceNumber||200!==e.code)switch(e.code){case 409:case 429:n="error";break;case 204:break;default:n="error"}this.logger.sendTelemetryEvent({eventName:"FlushResult",code:e.code,sequenceNumber:t,category:n}),this.flushDeferred.resolve(e),this.flushDeferred=void 0,this.flushOpNonce=void 0}})),await super.initialize(e,t)}addTrackedListener(e,t){switch(e){case"op":super.addTrackedListener(e,((e,n)=>{this.enableMultiplexing&&this.documentId!==e||t(e,n)}));break;case"signal":super.addTrackedListener(e,((e,n)=>{this.enableMultiplexing&&n&&n!==this.documentId||t(e,n)}));break;case"nack":super.addTrackedListener(e,((e,t)=>{var n,r;const o=0===e.length||e===this.documentId||e===this.clientId,{code:i,type:s,message:a,retryAfter:c}=null!==(r=null===(n=t[0])||void 0===n?void 0:n.content)&&void 0!==r?r:{};this.logger.sendTelemetryEvent({eventName:"ServerNack",code:i,type:s,message:a,retryAfterSeconds:c,clientId:this.clientId,handle:o}),o&&this.emit("nack",e,t)}));break;default:super.addTrackedListener(e,t)}}disconnect(e,t){var n;const r=this.socketReference;Object(Ze.a)(void 0!==r,162),null===(n=this.socketReference)||void 0===n||n.off("server_disconnect",this.serverDisconnectHandler),this.socketReference=void 0,!e&&this.hasDetails&&this.socket.emit("disconnect_document",this.clientId,this.documentId),r.removeSocketIoReference(e),this.emit("disconnect",t)}}var Cs,Os;!function(e){e[e.NoCaching=0]summaryAck",e.SummaryNack="summaryNack",e.Operation="op",e.RemoteHelp="remoteHelp",e.NoClient="noClient",e.RoundTrip="tripComplete",e.Control="control"}(Ts||(Ts={})),function(e){e.ClientJoin="join",e.ClientLeave="leave"}(Ss||(Ss={})),function(e){e.ThrottlingError="ThrottlingError",e.InvalidScopeError="InvalidScopeError",e.BadRequestError="BadRequestError",e.LimitExceededError="LimitExceededError"}(ks||(ks={})),function(e){e.FluidDataStoreOp="component",e.Attach="attach",e.ChunkedOp="chunkedOp",e.BlobAttach="blobAttach",e.Rejoin="rejoin",e.Alias="alias",e.Operation="op"}(Es||(Es={})),function(e){e.Accept="accept"}(_s||(_s={}));var Is,Ns,As,Ps=n("Htdc");function xs(e){const t={},n={id:e.id,blobs:{},trees:{}};t[""]=n;for(const n of e.entries){const e=n.path.lastIndexOf("/"),r=n.path.slice(0,Math.max(0,e)),o=n.path.slice(e+1),i=t[r];if("tree"===n.type){const e={blobs:{},trees:{},unreferenced:n.unreferenced};i.trees[decodeURIComponent(o)]=e,t[n.path]=e}else"blob"===n.type&&(i.blobs[decodeURIComponent(o)]=n.id)}return n}function Ds(e){var t,n;const r=new Map;e.blobs&&e.blobs.forEach((e=>{var t;Object(Ze.a)("base64"===e.encoding||void 0===e.encoding,164),r.set(e.id,Object(Ps.c)(e.content,null!==(t=e.encoding)&&void 0!==t?t:"utf8"))}));const o=null==e?void 0:e.trees[0].sequenceNumber;return{blobs:r,ops:null!==(n=null===(t=e.ops)||void 0===t?void 0:t.map((e=>e.op)))&&void 0!==n?n:[],sequenceNumber:o,snapshotTree:xs(e.trees[0]),latestSequenceNumber:e.ops&&e.ops}}class Ls{constructor(e){this.data=e,this.index=0,Object.freeze(e.buffer)}get buffer(){return this.data}get eof(){return this.index===this.data.length}get pos(){return this.index}get length(){return this.data.length}slice(e,t){return this.data.slice(e,t)}reset(){this.index=0}read(){let e=0,t=1,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;for(;n>0;)Object(Ze.a)(!this.eof,547),enarySingle8=33]="BinarySingle8",e[e.BinarySingle16=34]="BinarySingle16",e[e.BinarySingle32=35]="BinarySingle32",e[e.BinarySingle64=36]="BinarySingle64"}(Is||(Is={})),function(e){e[e.list=49]="list",e[e.set=51]="set"}(Ns||(Ns={})),function(e){e[e.list=50]="list",e[e.set=52]="set"}(As||(As={}));const Ms={1:0,2:1,3:1,4:2,5:2,6:4,7:4,8:8,9:8,13:0,14:1,15:2,16:4,17:1,18:2,19:4,20:1,21:4,32:0,33:1,34:2,35:4,36:8};function Rs(e,t){const nvoid 0!==n,647),n}f,r]of e.iteratePairs())t[zs(n,"keynode should be a string")]=r;return t}class Bs{constructor(){}}class Us extends Bs{constructor(e){super(),this.data=e}get buffer(){return this.data}get arrayBuffer(){return function(e){return 0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e. Us(r)}}class Ws extends Bs{constructor(e,t,n){super(),this.data=e,this.start=t,this.end=n}get buffer(){return this.data.subarray(this.start,this.end)}get arrayBuffer(){const e=this.data.byteOffset;return this.data.buffer.slice(this.start+e,this.end+e)}static read(e,t){const n=e.read(t),r=e.pos;return e.skip(n),new Ws(e.buffer&void 0!==arguments[0]?arguments[0]:"set",this.children=[]}get nodes(){return this.children}[Symbol.iterator](){return this.children[Symbol.iterator]()}iteratePairs(){return Object(Ze.a)(this.length%2==0,556),function(e){const t={next:()=>{const t=e.next();if(t.done)retu;return Object(Ze.a)(!0!==n.done,555),{value:[t.mbol.iterator]:()=>t};return t}(function(e){return e[Symbol.iterator]()}(this))}get length(){retur[e]}getString(e){return zs(this.children[e],"getString should return string")}getMaybeString(e){return function(e){if(e._stringElement)return e.content}(this.children[e])}getBlob(e){const t=this.children[e];return Gs(t,"getBlob should return a blob"),t}getNode(e){const t=this.children[e];return Vs(t,"getNode should return a node"),t}getNumber(e){const t;return Qs(t,"getBool should return a boolean"),t}addNode(e){const t=new qs(e);return this.children.push(t),t}addBlob(e){this.children.push(new Us(e))}addDictionaryString(e){this.children.push({content:e,dictionary:!0,_stringElement:!0})}addString(e){this.children.push({content:e,dictionary:!1,_stringElement:!0})}addNumber(e){Object(Ze.a)(Number.isInteger(e),561),Object(Ze.a)(void 0!==e&&e>=0,562),this.children.push(e)}addBool(e){this.children.push(e)}static readString(e,t,n){const r=Rs(Ms,t),o=e.read(r),i=e.pos;return e.skip(o),{dictionary:n,_stringElement:!0,startPos:i,endPos:e.pos}}load(e,t){const n=[],r=[],o=[];let i=this.children;for(;!e.eof;){const t=e.read();switch(t){case Ns.list:case Ns.set:{const e=new qs(t===Ns.set?"set":"list");i.push(e),n.push(i),i=e.children;continue}case Is.ConstStringDeclare:case Is.ConstStringDeclareBig:{const n=e.read(Rs(Ms,t)),i=qs.readString(e,t,!0);r.push(i),o[n]=i;continue}case Is.ConstString8Id:case Is.ConstString16Id:case Is.ConstString32Id:{const n=o[e.read(Rs(Ms,t))];Object(Ze.a)(void 0!==n,990),i.push(n);continue}case Is.StringEmpty:case Is.String8Length:case Is.String16Length:case Is.String32Length:{const n=qs.readString(e,t,!1);r.push(n),i.push(n);continue}case Is.BinaryEmpty:case Is.BinarySingle8:case Is.BinarySingle16:case Is.BinarySingle32:case Is.BinarySingle64:i.push(Ws.read(e,Rs(Ms,t)));continue;case Is.Int0:i.push(0);continue;case Is.UInt8:case Is.UInt16:case Is.UInt32:case Is.UInt64:case Is.Int8:case Is.Int16:case Is.Int32:case Is.Int64:i.push(e.read(Rs(Ms,t)));continue;case Is.BoolTrue:i.push(!0);continue;case Is.BoolFalse:i.push(!1);continue;case As.list:case As.set:i=n.pop();continue;default:throw new Error(`Invalid code: ${t}`)}}Object(Ze.a)(i===this.children,999);let s=0;for(const e of r)s+=e.endPos-e.startPos+1;const a=new Uint8Array(s);s=0;const c=e.buffer;Object(Ze.a)(0===c.byteOffset,1e3);for(const e of r){for(let t=e.startPos;t<e.endPos;t++)a[s]=c[t],s++;a[s]=0,s++}if(s===a.length){const e=Object(Ps.b)(a,"utf-8").split(String.fromCharCode(0));Object(Ze.a)(e.length===r.length+1,1001);for(let t=0;t<r.length;t++)r[t].content=e[t]}else{t.sendErrorEvent({eventName:"StringParsingError"});for(const e of r)Object(Ze.a)(e.content===Object(Ps.b)(c.subarray(e.startPos,e.endPos),"utf-8"),1002)}}}class Hs extends qs{static load(e,t){const n=new Hs;return n.load(e,t),Object(Ze.a)(e.eof,563),n}}function zs(e,t){if(e._stringElement)return e.content;Js(e,"BlobCore",t)}function Gs(e,t){e instanceof Bs||Js(e,"BlobCore",t)}function Vs(e,t){e instanceof qs||Js(e,"NodeCore",t)}function $s(e,t){"number"!=typeof e&&Js(e,"Number",t)}function Qs(e,t){"boolean"!=typeof e&&Js(e,"Boolean",t)}function Js(e,t,n){throw new nt.e(`Buffer parsing exception: ${n}`,tt.a.incorrectServerResponse,{nodeType:Xs(e),expectedNodeType:t,driverVersion:lt.a})}function Xs(e){return"number"==typeof e?"Number":e instanceof Bs?"BlobCore":e instanceof qs?"NodeCore":"boolean"==typeof e?"Boolean":e._stringElement?"String":"UnknownType"}function Ks(e){Vs(e,"TreeBlobs should be of type NodeCore");const t=new Map;for(const n of e){if(Vs(n,"blob should be node"),4===n.length&&"id"===n.getMaybeString(0)&&"data"===n.getMaybeString(2)){t.set(n.getString(1),n.getBlob(3).arrayBuffer);continue}const e=Fs(n);Gs(e.data,"data should be of BlobCore type");const r=zs(e.id,"blob id should be string");t.set(r,e.data.arrayBuffer)}return t}function Ys(e){Vs(e,"Deltas should be of type NodeCore");const t=[],n=Fs(e);$s(n.firstSequenceNumber,"Seq number should be a number"),Vs(n.deltas,"Deltas should be a Node");for(let e=0;e<n.deltas.length;++e)t.push(JSON.parse(n.deltas.getString(e)));return Object(Ze.a)(n.firstSequenceNumber.valueOf()===t[0].sequenceNumber,640),t}function Zs(e){const t={},n={blobs:{},trees:t};for(const r of e){Vs(r,"tree nodes should be nodes");const e=r.length;if(e>0&&"name"===r.getMaybeString(0)){if(4===e){const e=r.getMaybeString(2);if("children"===e){t[r.getString(1)]=Zs(r.getNode(3));continue}if("value"===e){n.blobs[r.getString(1)]=r.getString(3);continue}}if(6===e&&"nodeType"===r.getMaybeString(2)&&"value"===r.getMaybeString(4)){n.blobs[r.getString(1)]=r.getString(5);continue}if(6===e&&"unreferenced"===r.getMaybeString(2)&&"children"===r.getMaybeString(4)){t[r.getString(1)]=Zs(r.getNode(5)),Object(Ze.a)(r.getBool(3),987),n.unreferenced=!0;continue}}const o=Fs(r);void 0!==o.unreferenced&&(Qs(o.unreferenced,"Unreferenced flag should be bool"),Object(Ze.a)(o.unreferenced,641),n.unreferenced=!0);const i=zs(o.name,"Path name should be string");void 0!==o.value?n.blobs[i]=zs(o.value,"Blob value should be string"):void 0!==o.children?(Vs(o.children,"Trees should be of type NodeCore"),t[i]=Zs(o.children)):t[i]={blobs:{},trees:{}}}return n}function ea(e){Vs(e,"Snapshot should be of type NodeCore");const t=Fs(e);Vs(t.treeNodes,"TreeNodes should be of type NodeCore"),$s(t.sequenceNumber,"sequenceNumber should be of type number");const n=Zs(t.treeNodes);return n.id=zs(t.id,"snapshotId should be string"),{sequenceNumber:t.sequenceNumber.valueOf(),snapshotTree:n}}var ta,na,ra;async function oa(e,t,n,r,o,i,s,a,c){const u=e.sharingLinkToRedeem;return u&&(e.shareLinkInfo=Object.assign(Object.assign({},e.shareLinkInfo),{sharingLinkToRedeem:u})),ia(e,t,n,o,i,s,c).catch((async a=>{if(c&&function(e,t){var n;return void 0!==(null===(n=e.shareLinkInfo)||void 0===n?void 0:n.sharingLinkToRedeem)&&"object"==typeof t&&null!==t&&(t.errorType===tt.a.authorizationError||t.errorType===tt.a.fileNotFoundOrAccessDeniedError)}(e,a))return o.sendErrorEvent({eventName:"RedeemFallback",errorType:a.errorType},a),await async function(e,t,n,r){return wt.c.timedExecAsync(n,{eventName:"RedeemShareLink"},(async()=>Object(ct.i)((async n=>{var o,i;Object(Ze.a)(!!(null===(o=e.shareLinkInfo)||void 0===o?void 0:o.sharingLinkToRedeem),493);const s=await t(n,"RedeemShareLink"),a=function(e){let t=Object(js.b)(encodeURI(e));return t=t.replace(/=+$/g,"").replace(/\//g,"_").replace(/\+/g,"-"),t="u!".concat(t),t}(null===(i=e.shareLinkInfo)||void 0===i?void 0:i.sharingLinkToRedeem),c=`${e.siteUrl}/_api/v2.0/shares/${a}`,{url:u,headers:l}=Ct(c,s,r);return l.prefer="redeemSharingLink",Object(ct.d)(u,{headers:l})}))))}(e,t,o,r),ia(Object.assign(Object.assign({},e),{shareLinkInfo:Object.assign(Object.assign({},e.shareLinkInfo),{sharingLinkToRedeem:void 0})}),t,n,o,i,s);throw a})).catch((async e=>{throw("object"==typeof e&&null!==e&&e.errorType===tt.a.authorizationError||e.errorType===tt.a.fileNotFoundOrAccessDeniedError)&&await a(),e}))}async function ia(e,t,n,r,o,i,s){return Object(ct.i)((async a=>{var c;const u=await t(a,"TreesLatest",!0);let l;Object(Ze.a)(null!==u,485),void 0!==(null==n?void 0:n.timeout)&&(l=new lr.a,setTimeout((()=>l.abort()),n.timeout));const d={eventName:"TreesLatest",attempts:a.refresh?2:1,shareLinkPresent:void 0!==(null===(c=e.shareLinkInfo)||void 0===c?void 0:c.sharingLinkToRedeem),isSummarizer:e.summarizer,redeemFallbackEnabled:s};return void 0!==n&&Object.entries(n).forEach((e=>{let[t,n]=e;void 0!==n&&(d[`snapshotOption_${t}`]=n)})),wt.c.timedExecAsync(r,d,(async t=>{var s,a,c,d,h,f,p,m,g;const v=await o(e,u,n,l),b=v.odspResponse,y=b.headers.get("content-type"),w=Object.assign(Object.assign({},b.propsToLog),{contentType:y,accept:v.requestHeaders.accept,driverVersion:lt.a}),C=wt.c.start(r,Object.assign({eventName:"SnapshotParse"},w));let O,T;(null==y?void 0:y.includes("application/ms-fluid"))?T="application/ms-fluid":(null==y?void 0:y.includes("application/json"))&&(T="application/json");try{switch(T){case"application/json":{const e=await b.content.text();w.bodySize=e.length;const t=JSON.parse(e);!function(e){Object(Ze.a)(void 0!==e.trees,512),Object(Ze.a)(void 0!==e.blobs,513)}(t);const n=Ds(t);O=Object.assign(Object.assign({},b),{content:n});break}case"application/ms-fluid":{const e=await b.content.arrayBuffer();w.bodySize=e.byteLength;const t=function(e,t){const n=Hs.load(new Ls(e),t);Object(Ze.a)(1===n.length,537);const r=Fs(n.getNode(0)),o=zs(r.mrv,"minReadVersion should be string"),i=zs(r.cv,"createVersion should be string");return void 0!==r.lsn&&$s(r.lsn,"lsn should be a number"),Object(Ze.a)(parseFloat("1.0")>=parseFloat(o),527),Object(Ze.a)(parseFloat(i)>=parseFloat("1.0"),528),Object(Ze.a)("1.0"===i,706),Object.assign(Object.assign({},ea(r.snapshot)),{blobs:Ks(r.blobs),ops:void 0!==r.deltas?Ys(r.deltas):[],latestSequenceNumber:r.lsn})}(new Uint8Array(e),r);if(void 0===t.snapshotTree.trees||void 0===t.snapshotTree.blobs)throw new nt.e("Returned odsp snapshot is malformed. No trees or blobs!",tt.a.incorrectServerResponse,w);O=Object.assign(Object.assign({},b),{content:t});break}default:throw new nt.e("Unknown snapshot content type",tt.a.incorrectServerResponse,w)}}catch(e){if(Object(Nt.b)(e))throw e.addTelemetryProperties(w),e;throw Object(At.i)(e,(e=>new nt.e(`Error parsing snapshot response: ${e}`,tt.a.genericError,w)))}Object(Ze.a)(void 0!==O,786);const S=O.content,{trees:k,numBlobs:E,encodedBlobsSize:_}=function(e){const t=sa(e.snapshotTree),n=e.blobs.size;let r=0;for(const[t,n]of e.blobs)r+=n.byteLength;return{trees:t,numBlobs:n,encodedBlobsSize:r}}(S);let j,I,N,A,P,x,D,L;const M=b.headers.get("sprequestduration"),R=null!==(a=null===(s=Ot.a.getEntriesByType)||void 0===s?void 0:s.call(Ot.a,"resource"))&&void 0!==a?a:[];for(let e=R.length-1;e>0;e--){const t=R[e],n=t.name;if(0===t.initiatorType.localeCompare("fetch")&&0===n.localeCompare(v.requestUrl)){I=t.redirectEnd-t.redirectStart,j=t.domainLookupEnd-t.domainLookupStart,N=t.connectEnd-t.connectStart,A=t.secureConnectionStart>0?t.connectEnd-t.secureConnectionStart:void 0,P=t.responseStart>0?t.responseEnd-t.responseStart:void 0,x=t.fetchStart>0?t.responseEnd-t.fetchStart:void 0,D=t.requestStart>0?t.responseEnd-t.requestStart:void 0,L=t.startTime>0?t.responseEnd-t.fetchStart:void 0,void 0!==M&&void 0!==L&&(L-=parseInt(M,10));break}}const F="true"!==b.headers.get("disablebrowsercachingofusercontent"),B=null!==(c=S.sequenceNumber)&&void 0!==c?c:0,U=S.ops&&S.ops.length>0?S.ops[0].sequenceNumber-1:void 0;if(!Number.isInteger(B)||void 0!==U&&U!==B)r.sendErrorEvent({eventName:"fetchSnapshotError",sequenceNumber:B,seqNumberFromOps:U}),S.sequenceNumber=void 0;else if(F){const e=b.headers.get("x-fluid-epoch");Object(Ze.a)(void 0!==e,486);const t=Object.assign(Object.assign({},S),{cacheEntryTime:Date.now()});i({value:t,fluidEpoch:e,version:3})}return C.end(),t.end(Object.assign({trees:k,blobs:null!==(h=null===(d=S.blobs)||void 0===d?void 0:d.size)&&void 0!==h?h:0,leafNodes:E,encodedBlobsSize:_,sequencvoid 0===f?void 0:f.length)&&void 0!==p?p:0,userOps:null!==(g=null===(m=S.ops)||void 0===m?void 0:m.filter((e=>function(e){return e.type===Ts.Operation}(e))).length)&&void 0!==g?g:0,headers:0!==Object.keys(v.requestHeaders).length||void 0,redirectTime:I,dnsLookupTime:j,responseNetworkTime:P,tcpHandshakeTime:N,secureConnectionTime:A,fetchStartToResponseEndTime:x,reqStartToResponseEndTime:D,networkTime:L,sltelemetry:b.headers.get("x-fluid-sltelemetry")},w)),S})).catch((e=>{throw"object"!=typeof e||null===e||e.errorType!==tt.a.fetchFailure&&e.errorType!==St.a.fetchTimeout||(e[ct.j]=!0),e}))}))}function sa(e){let t=0;for(const[n,r]of Object.entries(e.trees))t+=1,t+=sa(r);return t}function aa(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Unreachable Case";throw new Error(t)}function ca(e){const t=e.type===ns.Handle?e.handleType:e.type;switch(t){case ns.Blob:case ns.Attachment:return"blob";case ns.Tree:return"tree";default:aa(t,`Unknown type: ${t}`)}}!function(e){e[e.Json=0]="Json",e[e.Binary=1]="Binary",e[e.JsonAndBinary=2]="JsonAndBinary"}(ta||(ta={})),function(e){e.File="100644",e.Executable="100755",e.Directory="040000",e.Symlink="120000"}(na||(na={})),function(e){e.Blob="Blob",e.Tree="Tree",e.Attachment="Attachment"}(ra||(ra={}));class ua{constructor(e,t,n,r,o,i){this.snapshotUrl=e,this.getStorageToken=t,this.epochTracker=r,this.forceAccessTokenViaAuthorizationHeader=o,this.relayServiceTenantAndSessionId=i,this.mc=Object(It.c)(n)}async writeSummaryTree(e,t){void 0!==this.lastSummaryProposalHandle&&this.lastSummaryProposalHandle!==t.proposalHandle&&this.mc.logger.sendTelemetryEvent({eventName:"LastSummaryProposedHandleMismatch",ackedSummaryProposedHandle:t.proposalHandle,lastSummaryProposalHandle:this.lastSummaryProposalHandle});const n=await this.writeSummaryTreeCore(t.ackHandle,t.referenceSequenceNumber,e),r=n?n.id:void 0;if(!n||!r)throw new Error("Failed to write summary tree");return this.lastSummaryProposalHandle=r,r}async writeSummaryTreeCore(e,t,n){const r=Object.keys(n.tree).includes(".protocol"),{snapshotTree:o,blobs:i}=await this.convertSummaryToSnapshotTree(e,n,".app"),s={entries:o.entries,message:"app",sequenceNumber:t,type:r||void 0===e?"container":"channel"};return Object(ct.i)((async n=>{const r=await this.getStorageToken(n,"WriteSummaryTree"),{url:o,headers:a}=Ct(`${this.snapshotUrl}/snapshot`,r,this.forceAccessTokenViaAuthorizationHeader);a["Content-Type"]="application/json";const c=this.relayServiceTenantAndSessionId();void 0!==c&&(a["If-Match"]=`fluid:sessionid=${c}${e?`;containerid=${e}`:""}`);const u=JSON.stringify(s);return wt.c.timedExecAsync(this.mc.logger,{eventName:"uploadSummary",attempt:n.refresh?2:1,hasClaims:!!n.claims,hasTenantId:!!n.tenantId,headers:0!==Object.keys(a).length||void 0,blobs:i,size:u.length,referenceSequenceNumber:t,type:s.type},(async()=>(await this.epochTracker.fetchAndParseAsJSON(o,{body:u,headers:a,method:"POST"},"uploadSummary")).content))}))}async convertSummaryToSnapshotTree(e,t,n,r){var o;void 0===r&&(r=null===(o=this.mc.config.getBoolean("Fluid.Driver.Odsp.MarkUnreferencedNodes"))||void 0===o||o);const i={type:"tree",entries:[]};let s=0;const a=Object.keys(t.tree);for(const o of a){const a=t.tree[o];let c,u,l;switch(a.type){case ns.Tree:{const t=await this.convertSummaryToSnapshotTree(e,a,n);u=t.snapshotTree,l=r?a.unreferenced:void 0,s+=t.blobs;break}case ns.Blob:u="string"==typeof a.content?{type:"blob",content:a.content,encoding:"utf-8"}:{type:"blob",content:Object(Ps.b)(a.content,"base64"),encoding:"base64"},s++;break;case ns.Handle:{if(!e)throw Error("Parent summary does not exist to reference by handle.");let t=a.handle;t.length>0&&!t.startsWith("/")&&(t=`/${t}`),c=`${e}/${n}${t}`;break}case ns.Attachment:c=a.id;break;default:aa(a,`Unknown type: ${a.type}`)}const d={path:encodeURIComponent(o),type:ca(a)};let h;if(u)Object(Ze.a)(void 0===c,173),h=Object.assign(Object.assign({value:u},d),{unreferenced:l});else{if(!c)throw new Error(`Invalid tree entry for ${a.type}`);h=Object.assign(Object.assign({},d),{id:c})}i.entries.push(h)}return{snapshotTree:i,blobs:s}}}class la{constructor(){this.deferBlobCacheClear=!1,this._blobC Set,this.blobCacheTimeoutDuration=12e4,this.purgeEnabled=!1}get value(){return this._blobCache}addBlobs(e){e.forEach(((e,t)=>{this._blobCache.set(t,e)})),this.scheduleClearBlobsCache()}scheduleClearBlobsCache(){void 0!==this.blobCacheTimeout?this.deferBlobCacheClear=!0:this.purgeEnabled&&(this.blobCacheTimeout=setTit=void 0,this.deferBlobCacheClear?(this.deferBlobCacheClear=!1,this.scheduleClearBlobsCache()):(this._blobCache.forEach(((e,t)=>this.blobsEvicted.add(t))),this._blobCache.clear())}),this.blobCacheTimeoutDuration),this.blobCacheTimeoutDuration=1e4)}getBlob(e){return this.scheduleClearBlobsCache(),{blobContent:this._blobCache.get(e),evicted:this.blobsEvicted.has(e)}}setBlob(e,t){if(t.byteLength<262144)return this.scheduleClearBlobsCache(),this._blobCache.set(e,t);this.blobsEvicted.add(e)}}class da extends class{constructor(){this.policies={caching:Cs.NoCaching,minBlobSize:2048,maximumCacheDurationMs:Pt},this.commitCache=new Map,this.attributesBlobHandles=new Set,this.blobCache=new la}set ops(e){Object(Ze.a)(void 0===this._ops,165),this._ops=e}get ops(){return this._ops}get snapshotSequenceNumber(){return this._snapshotSequenceNumber}get{const{blobContent:t,evicted:n}=this.blobCache.getBlob(e);return null!=t?t:this.fetchBlobFromStorage(e,n)}async readBlob(e){return this.readBlobCore(e)}async getSnapshotTree(e,t){let n;if(e&&e.id)n=e.id;else{const e=await this.getVersions(null,1,t);if(!e||0===e.length)return null;n=e[0].id}const r=await this.readTree(n,t);if(!r)return null;if(r.blobs){const e=r.blobs.attributes;e&&this.attributesBlobHandles.add(e)}return this.combineProtocolAndAppSnapshotTree(r.trees[".app"],r.trees[".protocol"])}async downloadSummary(e){throw new Error("Not implemented yet")}setRootTree(e,t){this.commitCache.set(e,t)}initBlobsCache(e){this.blobCache.addBlobs(e)}async readTree(e,t){let n=this.commitCache.get(e);return n||(n=await this.fetchTreeFromSnapshot(e,t)),null!=n?n:null}combineProtocolAndAppSnapshotTree(e,t){return{blobs:Object.assign({},e.blobs),trees:Object.assign(Object.assign({},e.trees),{".protocol":t})}}initializeFromSnapshot(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._snapshotSequenceNumber=e.sequenceNumber;const{snapshotTree:n,blobs:r,ops:o}=e;let i;return n&&(i=n.id,Object(Ze.a)(void 0!==i,545),this.setRootTree(i,n)),r&&this.initBlobsCache(r),t&&(this.ops=o),i}}{constructor(e,t,n,r,o,i,s,a,c,u){var l;super(),this.odspResolvedUrl=e,this.getStorageToken=t,this.logger=n,this.fetchFullSnapshot=r,this.cache=o,this.hostPolicy=i,this.epochTracker=s,this.flushCallback=a,this.relayServiceTenantAndSessionId=c,this.snapshotFormatFetchType=u,this.firstVersionCall=!0,this.maxSnapshotSizeLimit=5e8,this.maxSnapshotFetchTimeout=12e4,this.createBlobRateLimiter=new _t(1),this.documentId=this.odspResolvedUrl.hashedDocumentId,this.snapshotUrl=this.odspResolvedUrl.endpoints.snapshotStorageUrl,this.attachmentPOSTUrl=this.odspResolvedUrl.endpoints.attachmentPOSTStorageUrl,this.attachmentGETUrl=this.odspResolvedUrl.endpoints.attachmentGETStorageUrl,this.odspSummaryUploadManager=new ua(this.snapshotUrl,t,n,s,!!(null===(l=this.hostPolicy.sessionOptions)||void 0===l?void 0:l.forceAccessTokenViaAuthorizationHeader),this.relayServiceTenantAndSessionId)}async createBlob(e){return this.checkAttachmentPOSTUrl(),(await Object(ct.i)((async t=>{var n;const r=await this.getStorageToken(t,"CreateBlob"),{url:o,headers:i}=Ct(`${this.attachmentPOSTUrl}/content`,r,!!(null===(n=this.hostPolicy.sessionOptions)||void 0===n?void 0:n.forceAccessTokenViaAuthorizationHeader));return i["Content-Type"]="application/octet-stream",wt.c.timedExecAsync(this.logger,{eventName:"createBlob",size:e.byteLength,waitQueueLength:this.createBlobRateLimiter.waitQueueLength},(async t=>{const n=await this.createBlobRateLimiter.schedule((async()=>this.epochTracker.fetchAndParseAsJSON(o,{body:e,headers:i,method:"POST"},"createBlob")));return t.end(Object.assign({blobId:n.content.id},n.propsToLog)),n}))}))).content}async fetchBlobFromStorage(e,t){this.checkAttachmentGETUrl();const n=await Object(ct.i)((async n=>{var r;const o=await this.getStorageToken(n,"GetBlob"),i=`${this.attachmentGETUrl}/${encodeURIComponent(e)}/content`,{url:s,headers:a}=Ct(i,o,!!(null===(r=this.hostPolicy.sessionOptions)||void 0===r?void 0:r.forceAccessTokenViaAuthorizationHeader));return wt.c.timedExecAsync(this.logger,{eventName:"readDataBlob",blobId:e,evicted:t,headers:0!==Object.keys(a).length||void 0,waitQueueLength:this.epochTracker.rateLimiter.waitQueueLength},(async t=>{const r=await this.epochTracker.fetchArray(s,{headers:a},"blob");t.end(Object.assign(Object.assign({waitQueueLength:this.epochTracker.rateLimiter.waitQueueLength},r.propsToLog),{attempts:n.refresh?2:1}));const o=r.headers.get("cache-control");return void 0!==o&&(o.includes("private")||o.includes("public"))||this.logger.sendErrorEvent(Object.assign({eventName:"NonCacheableBlob",cacheControl:o,blobId:e},r.propsToLog)),r.content}))}));return this.blobCache.setBlob(e,n),n}async getSnapshotTree(e,t){return this.snapshotUrl?super.getSnapshotTree(e,t):null}async getVersions(e,t,n,r){if(e!==this.documentId&&e)return[{id:e,treeId:void 0}];if(!this.snapshotUrl)return[];if(1===t&&(null===e||e===this.documentId)){const e=this.hostPolicy.snapshotOptions,t=await wt.c.timedExecAsync(this.logger,{eventName:"ObtainSnapshot",fetchSource:r},(async t=>{const o={};let i,s;if(r===Os.noCache)i=await this.fetchSnapshot(e,n),s="networkOnly";else{const t=this.epochTracker.get(Object(ct.b)(this.odspResolvedUrl)).then((async e=>{var t;if(void 0!==e){const n=Date.now()-(null!==(t=e.cacheEntryTime)&&void 0!==t?t:Date.now()-2592e6);if(this.hostPolicy.summarizerClient){if(n>6e4)return void(o.cacheSummarizerExpired=!0);o.cacheSummarizerExpired=!1}o.cacheEntryAge=n}return e}));if(this.firstVersionCall&&this.hostPolicy.concurrentSnapshotFemmarizerClient){const r=this.fetchSnapshot(e,n),o=await async function(e){return new Promise(((t,n)=>{e.forEach(((e,r)=>{e.then((e=>t({index:r,value:e}))).catch(n)}))}))}([t.catch((()=>{})),r.catch((()=>{}))]);i=o.value,s=0===o.index?"cache":"network",void 0===i&&(1===o.index&&(i=await t,s="cache"),void 0===i&&(i=await r,s="network"))}else i=await t,s=void 0!==i?"cache":"network",void 0===i&&(i=await this.fetchSnapshot(e,n))}return"network"===s&&(o.cacheEntryAge=void 0),t.end(Object.assign(Object.assign({},o),{method:s})),i})),o=this.initializeFromSnapshot(t,this.firstVersionCall);return this.firstVersionCall=!1,o?[{id:o,treeId:void 0}]:[]}return Object(ct.i)((async e=>{var r;const o=await this.getStorageToken(e,"GetVersions"),{url:i,headers:s}=Ct(`${this.snapshotUrl}/versions?top=${t}`,o,!!(null===(r=this.hostPolicy.sessionOptions)||void 0===r?void 0:r.forceAccessTokenViaAuthorizationHeader)),a=(await wt.c.timedExecAsync(this.logger,{eventName:"getVersions",headers:0!==Object.keys(s).length||void 0},(async()=>this.epochTracker.fetchAndParseAsJSON(i,{headers:s},"versions",void 0,n)))).content;if(!a)throw new nt.e("No response from /versions endpoint",tt.a.genericNetworkError,{driverVersion:lt.a});if(!Array.isArray(a.value))throw new nt.e("Incorrect response from /versions endpoint, expected an array",tt.a.genericNetworkError,{driverVersion:lt.a});return a.value.map((e=>({id:e.id,treeId:void 0})))}))}async fetchSnapshot(e,t){return this.fetchSnapshotCore(e,t).catch((e=>{throw"object"==typeof e&&null!==e&&(e.canRetry=!1),e}))}async fetchSnapshotCore(e,t){var n,r;const o=Object.assign(Object.assign({mds:this.maxSnapshotSizeLimit},e),{timeout:(null==e?void 0:e.timeout)?Math.min(e.timeout,this.maxSnapshotFetchTimeout):this.maxSnapshotFetchTimeout});this.hostPolicy.summarizerClient&&(o.mds=void 0,o.timeout=void 0);const i=async(e,n,r,o)=>async function(e,t,n,r,o,i,s,a){var c;const u=e.sharingLinkToRedeem;u&&(e.shareLinkInfo=Object.assign(Object.assign({},e.shareLinkInfo),{sharingLinkToRedeem:u}));const l=`${e.endpoints.snapshotStorageUrl}/trees/latest?ump=1`,{body:d,headers:h}=function(e,t,n,r){var o,i;const s=Object(kt.a)(),a=[];return a.push(`--${s}`),a.push(`Authorization: Bearer ${t}`),a.push("X-HTTP-Method-Override: GET"),void 0!==n&&Object.entries(n).forEach((e=>{let[t,n]=e;void 0!==n&&a.push(`${t}: ${n}`)})),void 0!==r&&Object.entries(r).forEach((e=>{let[t,n]=e;void 0!==n&&a.push(`${t}: ${n}`)})),(null===(o=e.shareLinkInfo)||void 0===o?void 0:o.sharingLinkToRedeem)&&a.push(`sl: ${null===(i=e.shareLinkInfo)||void 0===i?void 0:i.sharingLinkToRedeem}`),a.push("_post: 1"),a.push(`\r\n--${s}--`),{body:a.join("\r\n"),headers:{"Content-Type":`multipart/form-data;boundary=${s}`}}}(e,t,r,{prefer:"manualredirect"}),f={body:d,headers:h,signal:null==i?void 0:i.signal,method:"POST"};switch(o){case ta.Binary:h.accept="application/ms-fluid; v=1.0";break;default:h.accept="application/json, application/ms-fluid; v=1.0"}return{odspResponse:await(null!==(c=null==s?void 0:s.fetch(l,f,"treesLatest",!0,a))&&void 0!==c?c:Object(ct.f)(l,f)),requestHeaders:h,requestUrl:l}}(e,n,0,r,this.snapshotFormatFetchType,o,this.epochTracker,t),s=async e=>this.cache.persistedCache.put(Object(ct.b)(this.odspResolvedUrl),e.value),a=async()=>this.cache.persistedCache.removeEntries();try{return await oa(this.odspResolvedUrl,this.getStorageToken,o,!!(null===(n=this.hostPolicy.sessionOptions)||void 0===n?void 0:n.forceAccessTokenViaAuthorizationHeader),this.logger,i,s,a,this.hostPolicy.enableRedeemFallback)}catch(t){const n=t.errorType;if(n===St.a.snapshotTooBig&&void 0!==(null==e?void 0:e.mds)&&!0!==this.hostPolicy.summarizerClient)throw t;if((n===St.a.snapshotTooBig||n===St.a.fetchTimeout)&&o.blobs){this.logger.sendErrorEvent({eventName:"TreeLatest_SecondCall",errorType:n});const e=Object.assign(Object.assign({},o),{blobs:0,mds:void 0,timeout:void 0});return await oa(this.odspResolvedUrl,this.getStorageToken,e,!!(null===(r=this.hostPolicy.sessionOptions)||void 0===r?void 0:r.forceAccessTokenViaAuthorizationHeader),this.logger,i,s,a,this.hostPolicy.enableRedeemFallback)}throw t}}async uploadSummaryWithContext(e,t){var n;if(this.checkSnapshotUrl(),".protocol"in e.tree&&void 0!==t.ackHandle){let e=1;for(;;){const r=await this.flushCallback(),o=r.lastPersistedSequenceNumber;if(void 0!==o&&o>=t.referenceSequenceNumber)break;if(e>3){this.logger.sendErrorEvent(Object.assign(Object.assign({eventName:"FlushFailure"},r),{retry:e,referenceSequenceNumber:t.referenceSequenceNumber}));break}this.logger.sendPerformanceEvent(Object.assign(Object.assign({eventName:"FlushExtraCall"},r),{retry:e,referenceSequenceNumber:t.referenceSequenceNumber})),e++,await Tt(1e3*(null!==(n=r.retryAfter)&&void 0!==n?n:1))}}return await this.odspSummaryUploadManager.writeSummaryTree(e,t)}checkSnapshotUrl(){if(!this.snapshotUrl)throw new nt.e("Method failed because no snapshot url was available",tt.a.genericError,{driverVersion:lt.a})}checkAttachmentPOSTUrl(){if(!this.attachmentPOSTUrl)throw new nt.e("Method failed because no attachment POST url was available",tt.a.genericError,{driverVersion:lt.a})}checkAttachmentGETUrl(){if(!this.attachmentGETUrl)throw new nt.e("Method failed because no attachment GET url was available",tt.a.genericError,{driverVersion:lt.a})}async fetchTreeFromSnapshot(e,t){return Object(ct.i)((async n=>{var r,o;const i=await this.getStorageToken(n,"ReadCommit"),s=await async function(e,t,n,r,o,i,s){const a=`/trees/${n}`;let c={};r&&(c="latest"!==n?{blobs:2}:{deltas:1,blobs:2});const u=function(e){let t="";for(const n of Object.keys(e))void 0!==e[n]&&(t+=`${""===t?"?":"&"}${n}=${encodeURIComponent(e[n])}`);return t}(ce}${a}${u}`,t,o);return Ds((await wt.c.timedExecAsync(i,{eventName:"fetchSnapshot",headers:0!==Object.keys(d).length||void 0},(async()=>s(l,{headers:d})))).content)}(this.snapshotUrl,i,e,this.fetchFullSnapshot,!!(null===(r=this.hostPolicy.sessionOptions)||void 0===r?void 0:r.forceAccessTokenViaAuthorizationHeader),this.logger,(async(e,n)=>this.epochTracker.fetchAndParseAsJSON(e,n,"snapshotTree",void 0,t)));let a="";return s.snapshotTree&&(Object(Ze.a)(void 0!==s.snapshotTree.id,546),a=s.snapshotTree.id,this.setRootTree(a,s.snapshotTree)),s.blobs&&this.initBlobsCache(s.blobs),null!==(o=this.commitCache.get(e))&&void 0!==o?o:this.commitCache.get(a)}))}}class ha{constructor(e,t,n,r,o,i){this.logger=t,this.cache=n,this.batchSize=r,this.timerGranularity=o,this.totalOpsToCache=i,this.batches=new Map;const s=this.batchSize-this.getPositionInBatchArray(e)-1;0!==s&&this.batches.set(this.getBatchNumber(e),{remainingSlots:s,batchData:this.initializeNewBatchDataArray(),dirty:!1})}dispose(){this.batches.clear(),void 0!==this.timer&&(clearTimeout(this.timer),this.timer=void 0)}flushOps(){for(const[e,t]of this.batches)null!==t&&t.dirty&&(t.dirty=!1,this.write(e,t))}addOps(e){if(!(this.totalOpsToCache<=0))for(const t of e){const e=this.getBatchNumber(t.sequenceNumber),n=this.getPositionInBatchArray(t.sequenceNumber);let r=this.batches.get(e);if(void 0===r)r={remainingSlots:this.batchSize-1,batchData:this.initializeNewBatchDataArray(),dirty:!0},r.batchData[n]=t,this.batches.set(e,r);else{if(null===r||void 0!==r.batchData[n])return;r.batchData[n]=t,r.remainingSlots--,r.dirty=!0}if(0===r.remainingSlots?(this.write(e,r),this.batches.set(e,null)):this.scheduleTimer(),this.totalOpsToCache--,0===this.totalOpsToCache){this.logger.sendPerformanceEvent({eventName:"CacheOpsLimitHit"}),this.cache.remove(),this.dispose();break}}}async getCore(e,t){const n=[];let r=this.getBatchNumber(e);for(;;){const o=await this.cache.read(`${this.batchSize}_${r}`);if(void 0===o)return n;const i=JSON.parse(o);for(const r of i)if(r){if(void 0!==t&&r.sequenceNumber>=t)return n;if(0===n.length){if(r.sequenceNumber>e)return n;if(r.sequenceNumber<e)continue}n.push(r)}else if(0!==n.length)return n;r++}}async get(e,t){const n=Ot.a.now(),r=await this.getCore(e,t),o=Ot.a.now()-n;return(r.length>0||o>1e3)&&this.logger.sendPerformanceEvent({eventName:"CacheOpsUsed",from:e,to:t,length:r.length,duration:o}),r}write(e,t){this.cache.write(`${this.batchSizech((()=>{this.totalOpsToCarity>0&&(this.timer=sid 0,this.flushOps()}),this.timerGranularity))}getBatchNumber(e){return Math.floor(ewBatchDataArray(){const e=[];return e.length=this.batchSize,e}}class fa{constructor(e,t){this.internalStorageService=e,this.logger=t,this._disposed=!1}get policies(){return this.internalStorageService.policies}get disposed(){return this._disposed}dispose(){this._disposed=!0}get repositoryUrl(){return this.internalStorageService.repositoryUrl}async getSnapshotTree(e){return this.runWithRetry((async()=>this.internalStorageService.getSnapshotTree(e)),"storage_getSnapshotTree")}async readBlob(e){return this.runWithRetry((async()=>this.internalStorageService.readBlob(e)),"storage_readBlob")}async getVersions(e,t){return this.r,"storage_getVersions")}async uploadSummaryWithContext(e,t){return this.runWithRetry((async()=>this.internalStorageService.uploadSummaryWithContext(e,t)),"storage_uploadSum(e)),"storage_downloadSummary")}async createBlob(e){return this.runWithRetry((async()=>this.internalStorageService.createBlob(e)),"storage_createBlob")}checkStorageDisposed(){if(this._disposed)throw new At.a("Storage Service is disposed. Cannot retry",{canRetry:!1})}async runWithRetry(e,t){return Lt(e,t,this.logger,(()=>this.checkStorageDisposed()))}}class pa{constructor(e,t,n,r,o,i,s,a,c,u){this.odspResolvedUrl=e,this.getStorageToken=t,this.getWebsocketToken=n,this.socketIoClientFactory=o,this.cache=i,this.epochTracker=a,this.socketReferenceKeyPrefix=c,this.clientIsSummarizer=u,this._policies={storageOnly:void 0!==e.fileVersion},this.joinSessionKey=`${this.odspResolvedUrl.hashedDocumentId}/joinsession`,this.mc=Object(It.c)(wt.a.create(r,void 0,{all:{odc:ot(new URL(this.odspResolvedUrl.endpoints.snapshotStorageUrl).origin)}})),this.hostPolicy=s,this.clientIsSummarizer&&(this.hostPolicy=Object.assign(Object.assign({},this.hostPolicy),{summarizerClient:!0}))}static async create(e,t,n,r,o,i,s,a,c,u){return new pa(Object(ct.g)(e),t,n,r,o,i,s,a,c,u)}get resolvedUrl(){return this.odspResolvedUrl}get policies(){return this._policies}async connectToStorage(){return this.storageManager||(this.storageManager=new da(this.odspResolvedUrl,this.getStorageToken,this.mc.logger,!0,this.cache,this.hostPolicy,this.epochTracker,(async()=>{if(void 0!==this.currentConnection&&!this.currentConnection.disposed)return this.currentConnection.flush();throw new Error("Disconnected while uploading summary (attempt to perform flush())")}),(()=>this.relayServiceTenantAndSessionId),this.mc.config.getNumber("Fluid.Driver.Odsp.snapshotFormatFetchType"))),new fa(this.storageManager,this.mc.logger)}async connectToDeltaStorage(){var e,t,n,r;const o=null!==(t=null===(e=this.storageManager)||void 0===e?void 0:e.ops)&&void 0!==t?t:[],i=new hs(this.odspResolvedUrl.endpoints.deltaStorageUrl,this.getStorageToken,this.epochTracker,this.mc.logger),s=null!==)&&void 0!==n?n:5e3,a=null!==(r=this.hostPolicy.concurrentOpsBatches)&&void 0!==r?r:1;return new fs(o,this.mc.logger,s,a,(async(e,t,n,r)=>i.get(e,t,n,r)),(async(e,t)=>{var n,r;return null!==(r=await(null===(n=this.opsCache)||void 0===n?void 0:n.get(e,t)))&&void 0!==r?r:[]}),((e,t)=>{void 0===this.currentConnection||this.currentConnection.disposed||this.currentConnection.requestOps(e,t)}),(e=>this.opsReceived(e)))}annotateConnectionError(e,t,n){return Object(At.h)(e,{props:{failedConnectionStep:t,separateTokenRequest:n}})}async connectToDeltaStream(e){return Object(ct.i)((async t=>{var n;const r=void 0===this.getWebsocketToken,o=r?Promise.resolve(null):this.getWebsocketToken(t),i=e=>t=>{throw this.annotateConnectionError(t,e,!r)},s=this.joinSession(r,t),[a,c,u]=await Promise.all([s.catch(i("joinSession")),o.catch(i("getWebsocketToken")),this.socketIoClientFactory().catch(i("socketIoClientFactory"))]),l=null!=c?c:null!==(n=a.socketToken)&&void 0!==n?n:null;if(null===l)throw this.annotateConnectionError(new nt.e("Websocket token is null",St.a.fetchTokenError,{dcketToken",!r);try{const t=await this.createDeltaConnection(a.tenantId,a.id,l,u,e,a.deltaStreamSocketUrl);return t.on("op",((e,t)=>{this.opsReceived(t)})),t.on("disconnect",(e=>{this.clearJoinSessionTimer(),"object"==typeof e&&null!==e&&e.errorType===tt.a.authorizationError&&this.cache.sessionJoinCache.remove(this.joinSessionKey)})),this.currentConnection=t,t}catch(e){this.cache.sessionJoinCache.remove(this.joinSessionKey);const),t}}))}clearJoinSessionTimer(){void 0!==this.joinSessionRefreshTimer&&(clearTimeout(this.joinSessionRefreshTimer),this.joinSessionRefreshTimer=void 0)}async scheduleJoinSessionRefresh(e){await new Promise(((t,n)=>{this.joinSessionRefreshTimer=setTimeout((()=>{Object(ct.i)((async e=>{await this.joinSession(!1,e),t()})).catch((e=>{n(e)}))}),e)}))}async joinSession(e,t){const n=await this.joinSessionCore(e,t).catch((e=>{if(Object(as.d)(e)&&void 0!==e.facetCodes)for(const t of e.facetCodes)switch(t){case"sessionForbiddenOnPreservedFiles":case"sessionForbiddenOnModerationEnabledLibrary":case"sessionForbiddenOnRequireCheckout":throw this._policies=Object.assign(Object.assign({},this._policies),{storageOnly:!0}),new nt.b(t,{driverVersion:lt.a});default:continue}throw e}));return this.relayServiceTenantAndSessionId=`${n.tenantId}/${n.id}`,n}async joinSessionCore(e,t){const n=this.mc.config.getBoolean("Fluid.Driver.Odsp.disableJoinSessionRefresh"),r=async()=>{var r;const o=await async function(e,t,n,r,o,i,s,a,c,u){const l=await o(a,"JoinSession"),d=a.refresh?{hasClaims:!!a.claims,hasTenantId:!!a.tenantId}:{},h=Object.assign({refreshedToken:a.refresh,requestSocketToken:s},d);return wt.c.timedExecAsync(r,Object.assign({eventName:"JoinSession",attempts:a.refresh?2:1,details:JSON.stringify(h)},d),(async t=>{const n=Object(ct.h)(e.siteUrl),o=Object(kt.a)();let a=`--${o}\r\n`;a+=`Authorization: Bearer ${l}\r\n`,a+="X-HTTP-Method-Override: POST\r\n",a+="Content-Type: application/json\r\n",c||(a+="prefer: FluidRemoveCheckAccess\r\n"),a+="_post: 1\r\n",s&&void 0!==u&&(a+=`\r\n${JSON.stringify({requestSocketToken:!0,guestDisplayName:u})}\r\n`),a+=`\r\n--${o}--`;const d={"Content-Type":`multipart/form-data;boundary=${o}`},h=await Lt((async()=>i.fetchAndParseAsJSON(`${it(n)}/drives/${e.driveId}/items/${e.itemId}/opStream/joinSession?ump=1`,{method:"POST",headers:d,body:a},"joinSession",!0)),"joinSession",r),f=h.content.deltaStreamSocketUrl,p=f.split("/")[2];return t.end(Object.assign(Object.assign({},h.propsToLog),{pushv2:f.includes("pushf"),webSocketHostName:p,refreshSessionDurationSeconds:h.content.refreshSessionDurationSeconds})),h.content.runtimeTenantId&&!h.content.tenantId&&(h.content.tenantId=h.content.runtimeTenantId),h.content}))}(this.odspResolvedUrl,0,0,this.mc.logger,this.getStorageToken,this.epochTracker,e,t,n,null===(r=this.hostPolicy.sessionOptions)||void 0===r?void 0:r.unauthenticatedUserDisplayName);return{entryTime:Date.now(),joinSessionResponse:o}},o=async()=>{var e;const t=await this.cache.sessionJoinCache.addOrGet(this.joinSessionKey,r);return t.joinSessionResponse.refreshSessionDurationSeconds=null!==(e=t.joinSessionResponse.refreshSessionDurationSeconds)&&void 0!==e?e:3600,Object.assign(Object.assign({},t),{refreshAfterDeltaMs:this.calculateJoinSessionRefreshDelta(t.entryTime,t.joinSessionResponse.refreshSessionDurationSeconds)})};let i=await o();if(i.refreshAfterDeltaMs<=0&&(this.cache.sessionJoinCache.remove(this.joinSessionKey),i=await o()),!n){const e={entryTime:i.entryTime,refreshSessionDurationSeconds:i.joinSessionResponse.refreshSessionDurationSeconds,refreshAfterDeltaMs:i.refreshAfterDeltaMs};i.refreshAfterDeltaMs>0?this.scheduleJoinSessionRefresh(i.refreshAfterDeltaMs).catch((t=>{Object(nt.i)(t)||this.mc.logger.sendErrorEvent({eventName:"JoinSessionRefreshError",details:JSON.stringify(e)},t)})):this.mc.logger.sendTelemetryEvent({eventName:"JoinSessionRefreshNotScheduled",details:JSON.stringify(e)})}return i.joinSessionResponse}calculateJoinSessionRefreshDelta(e,t){return e+(1e3*t-3e4)-Date.now()}async createDeltaConnection(e,t,n,r,o,i){const s=Ot.a.now(),a=await ws.create(e,t,n,r,o,i,this.mc.logger,6e4,this.epochTracker,this.socketReferenceKeyPrefix),c=Ot.a.now()-s;return c>=2e3&&this.mc.logger.sendPerformanceEvent({eventName:"ConnectionSuccess",duration:c}),a}dispose(e){var t,n;void 0!==e?this.epochTracker.removeEntries().catch((()=>{})):null===(t=this._opsCache)||void 0===t||t.flushOps(),null===(n=this._opsCache)||void 0===n||n.dispose()}get opsCache(){var e,t,n,r,o,i,s;if(this._opsCache)return this._opsCache;const a=null===(e=this.storageManager)||void 0===e?void 0:e.snapshotSequenceNumber,c=null!==(n=null===(t=this.hostPolicy.opsCaching)||void 0===t?void 0:t.batchSize)&&void 0!==n?n:100;if(void 0===a||c<1)return;const u={type:"ops"};return this._opsCache=new ha(a,this.mc.logger,{write:async(e,t)=>this.cache.persistedCache.put(Object.assign(Object.assign({},u),{key:e}),t),read:async e=>this.cache.persistedCache.get(Object.assign(Object.assign({},u),{key:e})),remove:()=>{this.cache.persistedCache.removeEntries().catch((()=>{}))}},c,null!==(o=null===(r=this.hostPolicy.opsCaching)||void 0===r?void 0:r.timerGranularity)&&void 0!==o?o:5e3,null!==(s=null===(i=this.hostPolicy.opsCaching)||void 0===i?void 0:i.totalOpsToCache)&&void 0!==s?s:5e3),this._opsCache}opsReceived(e){var t;0===e.length||this.odspResolvedUrl.summarizer||null===(t=this.opsCache)||void 0===t||t.addOps(e)}}function ma(e,t){const n=rs(e.tree[".protocol"]).sequenceNumber,r=new Map,o=ga(e,r);return o.id=t,{snapshotTree:o,blobs:r,ops:[],sequenceNumber:n,latestSequenceNumber:n}}function ga(e,t){const n={blobs:{},trees:{},unreferenced:e.unreferenced},r=Object.keys(e.tree);for(const o of r){const r=e.tree[o];switch(r.type){case ns.Tree:n.trees[o]=ga(r,t);break;case ns.Blob:{const e="string"==typeof r.content?Object(Ps.c)(r.content,"utf8"):r.content,i=Object(kt.a)();n.blobs[o]=i,t.set(i,e);break}case ns.Handle:case ns.Attachment:throw new Error(`No ${r.type} should be present for detached summary!`);default:aa(r,`Unknown tree type ${r.type}`)}}return n}function va(e){var t;const n={type:"tree",entries:[]},r=Object.keys(e.tree);for(const o of r){const r=e.tree[o];let i,s;switch(r.type){case ns.Tree:i=va(r),s=r.unreferenced;break;case ns.Blob:i={type:"blob",content:"string"==typeof r.content?r.content:Object(Ps.b)(r.content,"base64"),encoding:"string"==typeof r.content?"utf-8":"base64"};break;case ns.Handle:throw new Error("No handle should be present for first summary!!");default:throw new Error(`Unknown tree type ${r.type}`)}const a={path:encodeURIComponent(o),type:ca(r),value:i,unreferenced:s};null===(t=n.entries)||void 0===t||t.push(a)}return n}class ba extends class{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new os,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};var i;this.getStorageToken=e,this.getWebsocketToken=t,this.getSocketIOClient=n,this.persistedCache=r,this.hostPolicy=o,this.protocolName="fluid-odsp:",this.nonPersistentCache=new is,!0===this.hostPolicy.isolateSocketCache&&(this.socketReferenceKeyPrefix=Object(kt.a)()),this.hostPolicy.enableRedeemFallback=null===(i=this.hostPolicy.enableRedeemFallback)||void 0===i||i,this.hostPolicy.sessTokenViaAuthorizationHeader:!0},this.hostPolicy.sessionOptions)}async createContainer(e,t,n,r){!function(e){if(!(e=>"fluid"===(null==e?void 0:e.type))(e))throw new Error(`resolved is not a Fluid url. Type: ${null==e?void 0:e.type}`)}(t);let o=Object(ct.g)(t);const i={siteUrl:o.siteUrl,driveId:o.driveId,itemId:o.itemId},[,s]=o.url.split("?"),a=new URLSearchParams(s),c=a.get("path");if(null==c)throw new Error("File path should be provided!!");const u=null==e?void 0:e.tree[".protocol"];if(u){const e=rs(u);if(0!==(null==e?void 0:e.sequenceNumber))throw new Error("Seq number in detached ODSP container should be 0")}const l=function(e,t){let n;if(e.enableSingleRequestForShareLinkWithCreate){const e=t.get("createLinkScope"),r=t.get("createLinkRole");e&&Qe[e]&&(n=Object.assign({scope:Qe[e]},r&&Je[r]?{role:Je[r]}:{}))}else if(e.enableShareLinkWithCreate){const e=t.get("createLinkType");e&&$e[e]&&(n=$e[e||""])}return n}(this.hostPolicy,a),d={driveId:o.driveId,siteUrl:o.siteUrl,filePath:c,filename:o.fileName,createLinkType:l},h=Object(ct.c)(n),f={resolvedUrl:o,docId:o.hashedDocumentId},p=Dt(this.persistedCache,this.nonPersistentCache,f,h,r);return wt.c.timedExecAsync(h,{eventName:"CreateNew",isWithSummaryUpload:!0,createShareLinkParam:JSON.stringify(l),enableShareLinkWithCreate:this.hostPolicy.enableShareLinkWithCreate,enableSingleRequeostPolicy.enableSingleRequestForShareLinkWithCreate},(async t=>{var n,s;o=await async function(e,t,n,r,o,i,s,a,c,u,l){if((e=>!!e.match(/["*/:<>?\\|]+/g))(t.filename))throw new nt.e("Invalid filename for createNew",St.a.invalidFileNameError,{driverVersion:lt.a});let d,h,f="";if(void 0===r)d=await async function(e,t,n,r,o){const i=t.filePath?encodeURIComponent(`/${t.filePath}`):"",s=encodeURIComponent(`${t.filename}.tmp`),a=`${it(Object(ct.h)(t.siteUrl))}/drives/${t.driveId}/items/root:/${i}/${s}:/content?@name.conflictBehavior=rename&select=id,name,parentReference`;return Object(ct.i)((async t=>{const i=await e(t,"CreateNewFile");return wt.c.timedExecAsync(n,{eventName:"createNewEmptyFile"},(async e=>{const{url:t,headers:s}=Ct(a,i,o);s["Content-Type"]="application/json";const c=await Lt((async()=>r.fetchAndParseAsJSON(t,{body:void 0,headers:s,method:"PUT"},"createFile")),"createFile",n),u=c.content;if(!u||!u.id)throw new nt.e("ODSP CreateFile call returned no item ID (for empty file)",tt.a.incorrectServerResponse,{driverVersion:lt.a});return e.end(Object.assign({headers:0!==Object.keys(s).length||void 0},c.propsToLog)),u.id}),{end:!0,cancel:"error"})}))}(e,t,n,o,a);else{const i=await async function(e,t,n,r,o,i){const s=t.filePath?encodeURIComponent(`/${t.filePath}`):"",a=encodeURIComponent(t.filename),c=`${it(Object(ct.h)(t.siteUrl))}/drives/${t.driveId}/items/root:${s}/${a}`,u=function(e){var t;const n=e.tree[".app"],r=e.tree[".protocol"];if(!n||!r)throw new Error("App and protocol summary required for create new path!!");const o=rs(r),i={type:ns.Blob,content:JSON.stringify(o)};return r.tree.attributes=i,{entries:null!==(t=va({type:ns.Tree,tree:{".protocol":r,".app":n}}).entries)&&void 0!==t?t:[],message:"app",sequenceNumber:o.sequenceNumber,type:"container"}}(r),l=Object(ct.a)(t.createLinkType),d=`${c}:/opStream/snapshots/snapshot${l?`?${l}`:""}`;return Object(ct.i)((async t=>{const r=await e(t,"CreateNewFile");return wt.c.timedExecAsync(n,{eventName:"createNewFile"},(async e=>{const s=JSON.stringify(u);let a,c,l=!1;const h=Object(kt.a)();let f=`--${h}\r\n`;if(f+=`Authorization: Bearer ${r}\r\n`,f+="X-HTTP-Method-Override: POST\r\n",f+="Content-Type: application/json\r\n",f+="_post: 1\r\n",f+=`\r\n${s}\r\n`,f+=`\r\n--${h}--`,f.length<=ct.k){const e=new URL(d);e.searchParams.set("ump","1"),a=e.href,c={"Content-Type":`multipart/form-data;boundary=${h}`},l=!0}else{const e=Ct(d,r,i);a=e.url,c=Object.assign(Object.assign({},e.headers),{"Content-Type":"application/json"}),f=s}const p=await Lt((async()=>o.fetchAndParseAsJSON(a,{body:f,headers:c,method:"POST"},"createFile",l)),"createFile",n),m=p.content;if(!m||!m.itemId)throw new nt.e("ODSP CreateFile call returned no item ID",tt.a.incorrectServerResponse,{driverVersion:lt.a});return e.end(Object.assign({headers:0!==Object.keys(c).length||void 0,attempts:t.refresh?2:1},p.propsToLog)),m}))}))}(e,t,n,r,o,a);d=i.itemId,f=i.id,h=function(e,t,n,r){if(!e)return;let o;if(n){const{sharing:n}=t;if(!n)return;o={createLink:{type:e,link:n.sharingLink?Object.assign({scope:n.sharingLink.scope,role:n.sharingLink.type,webUrl:n.sharingLink.webUrl},n.sharingLink):void 0,error:n.error,shareId:n.shareId}}}else if(r){const{sharing:n,sharingLink:r,sharingLinkErrorReason:i}=t;if(!r&&!i)return;o={createLink:{type:e,link:r,error:i,shareId:null==n?void 0:n.shareId}}}return o}(t.createLinkType,i,u,l)}const p=rt(Object.assign(Object.assign({},t),{itemId:d,dataStorePath:"/"})),m=new gt,g=await m.resolve({url:p,headers:{[at.isClpCompliantApp]:c}});if(i.docId=g.hashedDocumentId,i.resolvedUrl=g,g.shareLinkInfo=h,void 0!==r&&s){Object(Ze.a)(void 0!==f,515);const e=ma(r,f);await o.put(Object(ct.b)(g),e)}return g}(Object(ct.l)(h,i,this.getStorageToken,!0),d,h,e,p.epochTracker,f,null===(n=this.hostPolicy.cacheCreateNewSummary)||void 0===n||n,!!(null===(s=this.hostPolicy.sessionOptions)||void 0===s?void 0:s.forceAccessTokenViaAuthorizationHeader),o.isClpCompliantApp,this.hostPolicy.enableSingleRequestForShareLinkWithCreate,this.hostPolicy.enableShareLinkWithCreate);const a=this.createDocumentServiceCore(o,h,p,r);return t.end({docId:o.hashedDocumentId}),a}))}async createDocumentService(e,t,n){return this.createDocumentServiceCore(e,Object(ct.c)(t),void 0,n)}async createDocumentServiceCore(e,t,n,r){const o=Object(ct.g)(e),i={siteUrl:o.siteUrl,driveId:o.driveId,itemId:o.itemId},s=null!=n?n:Dt(this.persistedCache,this.nonPersistentCache,{resolvedUrl:o,docId:o.hashedDocumentId},t,r),a=Object(ct.l)(t,i,this.getStorageToken,!0);return pa.create(e,a,void 0===this.getWebsocketToken?void 0:async e=>Object(ct.l)(t,i,this.getWebsocketToken,!1)(e,"GetWebsocketToken"),t,this.getSocketIOClient,s.cache,this.hostPolicy,s.ecketReferenceKeyPrefix,r)}}{constructor(e,t,r,o){super(e,t,(async()=>Promise.all([n.e(110),n.e(995)]).then(n.bind(null,"iV19")).then((e=>e.getSocketIo()))),r,o)}}var ya=n("ki/R");function wa(e,t){const n=t&&new Ut.a(zt.a,t);return{claims:e.claims,forceRefresh:e.refresh,siteUrl:e.siteUrl,driveId:e.driveId,itemId:e.itemId,tenantId:e.tenantId||Object(ya.b)(e.siteUrl,n)}}var Ca=n("PnKM");function Oa(e,t,n,r,o){const i={...r,enableShareLinkWithCreate:Object(qo.a)("odspDriver.enableShareLinkWithCreate",!1,o)};return!1!==i.concurrentSnapshotFetch&&(i.concurrentSnapshotFetch=!0),new ba(Ta((n=>e.getToken(Object(Ca.b)(n.siteUrl),wa(n,t)))),e.identityType&&["Consumer","Unauthenticatncludes(e.identityType)?void 0:Ta((n=>e.getToken(Object(Ca.a)(),wa(n,t)))),n,i)}function Ta(e){return function(){return e(...arguments).then((e=>e||null))}}class Sa{constructor(e,t){this.expiry=e,this.cleanup=t,this.gcTimeouts=new Map}schedule(e){"indefinite"!==this.expiry.policy&&this.gcTimeouts.set(e,setTimeout((()=>{this.cleanup(e),this.cancel(e)}),this.expiry.durationMs))}cancel(e){const t=this.gcTimeouts.get(e);void 0!==t&&(clearTimeout(t),this.gcTimeouts.delete(e))}update(e){"sliding"===this.expiry.policy&&(this.cancel(e),this.schedule(e))}}class ka{constructor(){let{expiry:e={policy:"indefinite"},removeOnError:t=(()=>!0)}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.cache=new Map,this.removeOnError=t,this.gc=new Sa(e,(e=>this.remove(e)))}has(e){return this.cache.has(e)}get(e){return this.has(e)&&this.gc.update(e),this.cache.get(e)}remove(e){return this.gc.cancel(e),this.cache.delete(e)}async addOrGet(e,t){let n=this.get(e);return void 0===n&&(n=(async()=>t())(),this.cache.set(e,n),n.catch((t=>{this.removeOnError(t)&&this.remove(e)})),this.gc.schedule(e)),n}add(e,t){const n=this.has(e);return this.addOrGet(e,t).catch((()=>{})),!n}async addValueOrGet(e,t){return this.addOrGet(e,(async()=>t))}addValue(e,t){return this.add(e,(async()=>t))}}var Ea=n("a9wj"),_a=n("LpbE"),ja=n("Ito+"),Ia=n("TVWn");class Na extends Rt{constructor(e,t,n,r,o){super(t,n,r,o),this.tokenProvider=e,this.shareLinkFetcherPropsLocal=t,this.loggerLocal=n,this.appNameLocal=r,this.getContextLocal=o,this.sharingLinkCacheLocal=new ka}async resolve(e){var t;const n=await super.resolve(e);return n.itemId&&"Consumer"===(null===(t=this.shareLinkFetcherPropsLocal)||void 0===t?void 0:t.identityType)&&this.getShareLinkPromiseLocal(n).catch((()=>{})),n}async getAbsoluteUrl(e,t,n){var r,o,i,s;if("Consumer"!==(null===(r=this.shareLinkFetcherPropsLocal)||void 0===r?void 0:r.identityType))return await super.getAbsoluteUrl(e,t,n);if(!Object(Ea.e)(e))throw new Error("Expected resolved url to be of OdspResolvedUrl type");const a=await this.getShareLinkPromiseLocal(e),c=new URL(a);let u;u=n&&"name"in n?n.name:(e=>"object"==typeof e&&"string"==typeof(null==e?void 0:e.name)&&"object"==typeof(null==e?void 0:e.fluid))(null==n?void 0:n.package)?null==n?void 0:n.package.name:null==n?void 0:n.package,u=null!==(o=u)&&void 0!==o?o:null===(i=e.codeHint)||void 0===i?void 0:i.containerPackageName;const l=await(null===(s=this.getContextLocal)||void 0===s?void 0:s.call(this,e,t));return Object(yt.d)(c,{siteUrl:e.siteUrl,driveId:e.driveId,itemId:e.itemId,dataStorePath:t,appName:this.appNameLocal,containerPackageName:u,fileVersion:e.fileVersion,context:l}),c.href}async getShareLinkPromiseLocal(e){var t;if("Consumer"!==(null===(t=this.shareLinkFetcherPropsLocal)||void 0===t?void 0:t.identityType))throw new Error("Failed to get share link because share link fetcher props are missing or not for Consumer user");if(!(e.siteUrl&&e.driveId&&e.itemId))throw new Error("Failed to get share link because necessary information is missing");const n=`${e.siteUrl},${e.driveId},${e.itemId}`,r=this.sharingLinkCacheLocal.get(n);if(r)return r;const o=this.getFileLink(this.shareLinkFetcherPropsLocal.tokenFetcher,e).catch((e=>{throw this.loggerLocal&&Object(Ye.b)(this.loggerLocal,{eventName:"FluidFileUrlError"},e),this.sharingLinkCacheLocal.remove(n),e}));return this.sharingLinkCacheLocal.add(n,(async()=>o)),o}async getFileLink(e,t){var n;const r=await Object(Ea.a)(this.tokenProvider,t.siteUrl,t.driveId,t.itemId,this.loggerLocal);if(!r)throw new Error("Failed to fetch file info");const o={getToken:async n=>await e({...n,...t,refresh:!(null==n||!n.forceRefresh)}),url:`${t.siteUrl}/_api/web/GetFileById(@a1)/ListItemAllFields/GetSharingInformation?@a1=guid${encodeURIComponent(`'${r.sharepointIds.listItemUniqueId}'`)}`,requestInit:{method:"POST",headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose"}},retryPolicy:_a.b,tokenPolicy:Object(_a.a)(this.tokenPral?Object(ja.b)({...o,logger:this.loggerLocal,nameForLogging:"GetSharingInformation",doNotLogOnSuccess:!0,getAdditionalProps:async(e,t)=>Object(Ia.a)(e)}):Object(ja.a)(o),s=await(await i).result.json();if(null===(n=s.d)||void 0===n||!n.directUrl)throw new Error("Unexpected response: missing sharing information");return s.d.directUrl}}function Aa(e,t,n,r){const o=t&&new Ut.a("OdspUrlResolver",t);return new Na(e,"UnauthenticatedGuest"===e.identityType?void 0:{tokenFetcher:n=>e.getToken(Object(Ca.b)(n.siteUrl),wa(n,t)),ideContext(e,t):Promise.resolve(void 0)))}var Pa=n("ywfh"),xa=function(e){function t(t,n,r){var o=e.call(this,t)||this;return o.errorCode=n,o.canRetry=r,o}return Object(u.__extends)(t,e),t}(Error),Da=function(){function e(e){this.accessTokenResponseFunction=e}return Object.defineProperty(e.prototype,"TokenProvider",{get:function(){return this},enumerable:!1,configurable:!0}),e.prototype.getToken=function(e,t){var n,r,o;return Object(u.__awaiter)(this,void 0,void 0,(function(){var i,s,a,c,l;return Object(u.__generator)(this,(function(u){switch(u.label){case 0:return(s=this.getResourceUrl(e))?"Documents"!==(a=Object(Pa.a)(s))?[3,2]:[4,this.accessTokenResponseFunction("OneDrive",null==t?void 0:t.forceRefresh,s)]:[3,12];case 1:return i=u.sent(),[3,11];case 2:return"Sites"!==a?[3,4]:[4,this.accessTokenResponseFunction("SharePoint",null==t?void 0:t.forceRefresh,s)];case 3:return i=u.sent(),[3,11];case 4:return s.toLowerCase().indexOf("pushchannel.1drv.ms")>0?[4,this.accessTokenResponseFunction("FluidPushChannel",null==t?void 0:t.forceRefresh)]:[3,6];case 5:return i=u.sent(),[3,11];case 6:return s.toLowerCase().indexOf("graph.microsoft.com")>0?[4,this.accessTokenResponseFunction("Graph",null==t?void 0:t.forceRefresh)]:[3,8];case 7:return i=u.sent(),[3,11];case 8:return s.toLowerCase().indexOf("office.com")>0?[4,this.accessTokenResponseFunction("OfficeHome",null==t?void 0:t.forceRefresh)]:[3,10];case 9:return i=u.sent(),[3,11];case 10:throw new xa("Fetching ".concat(a," token is not supported"),"unsupported_token_resource",!1);case 11:return[3,13];case 12:throw new xa("Unknown token type","unsupported_token_resource",!1);case 13:if(i&&i.success)return[2,{token:i.token}];throw c=null===(n=i.error)||void 0===n?void 0:n.statusCode,l=c&&(c<400||c>=500),new xa("Failed to acquire auth token for ".concat(a),(null===(o=null===(r=i.error)||void 0===r?void 0:r.statusCode)||void 0===o?void 0:o.toString())||"undefined",l)}}))}))},e.prototype.getResourceUrl=function(e){var t,n;if(0!==e.length){var r=e[0].lastIndexOf("/"),o=r>-1?e[0].substring(0,r):"";try{for(var i=Object(u.__values)(e),s=i.next();!s.done;s=i.next()){var a=s.value;if(((r=a.lastIndexOf("/"))>-1?a.substring(0,r):"")!==o)return}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return""!==o?o:"https://graph.microsoft.com"}},e}(),La=n("maX/"),Ma=function(){function e(e){this.user={id:e.puid,tenantId:e.tenantId,userIdSpace:e.isOrgId?"OrgIdPuid":"MSAPUID"}}return Object.defineProperty(e.prototype,"UserContext",{get:function(){return this},enumerable:!1,configurable:!0}),e}(),Ra=function(){function e(e){this.uiLocale=Object(Kt.c)(e.preferredCulture)}return Object.defineProperty(e.prototype,"InternationalizationContext",{getr e=Object(Fa.a)();return Object(h.useMemo)((function(){if(e&&function(e){return"MyContent"===e.route&&"drafts"===e.entityId&&"content"===e.subEntityId}(e)){var t=new URLSearchParams(window.location.search),n=t.get("siteUrl"),r=t.get("drive"),o=t.get("item"),i=t.get("file");return r&&o&&i&&n?{type:"Edit",params:{driveId:r,docId:o,docUrl:i,siteUrl:n}}:{type:"New"}}}),[e])}var Ua=n("Ishu");const Wa="--ms-themeColorHeadingText",qa={neutralPrimary:"var(--ms-themeColorPaletteNeutralPrimary, #323130)"},Ha="--ms-themeColorBodyBackground",za="Segoe UI, Segoe UI Emoji, sans-serif",Ga=`var(--ms-themeColorBodyTextChecked, var(--ms-themeColorBodyText, ${qa.neutralPrimary}))`,Va=[["Heading 1",[{name:"fontFamily",cssPropertyName:"font-family",value:{customPropertyName:"--ms-themeFontFamilyHeading1",fallbackValue:za}},{name:"fontSize",cssPropertyName:"font-size",value:{customPropertyName:"--ms-themeFontSizeHeading1",fallbackValue:"24px"}},{name:"fontWeight",cssPropertyName:"font-weight",value:{customPropertyName:"--ms-themeFontWeightHeading1",fallbackValue:"700"}},{name:"color",cssPropertyName:"color",value:{customPropertyName:Wa,fallbackValue:Ga}},{name:"marginTop",cssPropertyName:"margin-top",value:{customPropertyName:"--ms-themeMarginTopHeading1",fallbackValue:"24px"}},{name:"lineHeight",cssPropertyName:"line-height",value:{customPropertyName:"--ms-themeLineHeightHeading1",fallbackValue:"normal"}},{name:"role",cssPropertyName:"role",value:"heading"},{name:"ariaLevel",cssPropertyName:"aria-level",value:"1"},{name:"outline",cssPropertyName:"outline",value:{customPropertyName:"--ms-themeOutlineHeading1"}},{name:"backgroundColor",cssPropertyName:"background-color",value:{customPropertyName:Ha,fallbackValue:"transparent"}}]],["Heading 2",[{name:"fontFamily",cssPropertyName:"font-family",value:{customPropertyName:"--ms-themeFontFamilyHeading2",fallbackValue:za}},{name:"fontSize",cssPropertyName:"font-size",value:{customPropertyName:"--ms-themeFontSizeHeading2",fallbackValue:"20px"}},{name:"fontWeight",cssPropertyName:"font-weight",value:{customPropertyName:"--ms-themeFontWeightHeading2",fallbackValue:"700"}},{name:"color",cssPropertyName:"color",value:{customPropertyName:Wa,fallbackValue:Ga}},{name:"marginTop",cssPropertyName:"margin-top",value:{customPropertyName:"--ms-themeMarginTopHeading2",fallbackValue:"20px"}},{name:"lineHeight",cssPropertyName:"line-height",value:{customPropertyName:"--ms-themeLineHeightHeading2",fallbackValue:"normal"}},{name:"role",cssPropertyName:"role",value:"heading"},{name:"ariaLevel",cssPropertyName:"aria-level",value:"2"},{name:"outline",cssPropertyName:"outline",value:{customPropertyName:"--ms-themeOutlineHeading2"}},{name:"backgroundColor",cssPropertyName:"background-color",value:{customPropertyName:Ha,fallbackValue:"transparent"}}]],["Heading 3",[{name:"fontFamily",cssPropertyName:"font-family",value:{customPropertyName:"--ms-themeFontFamilyHeading3",fallbackValue:za}},{name:"fontSize",cssPropertyName:"font-size",value:{customPropertyName:"--ms-themeFontSizeHeading3",fallbackValue:"14px"}},{name:"fontWeight",cssPropertyName:"font-weight",value:{customPropertyName:"--ms-themeFontWeightHeading3",fallbackValue:"700"}},{name:"color",cssPropertyName:"color",value:{customPropertyName:Wa,fallbackValue:Ga}},{name:"marginTop",cssPropertyName:"margin-top",value:{customPropertyName:"--ms-themeMarginTopHeading3",fallbackValue:"16px"}},{name:"lineHeight",cssPropertyName:"line-height",value:{customPropertyName:"--ms-themeLineHeightHeading3",fallbackValue:"normal"}},{name:"role",cssPropertyName:"role",value:"heading"},{name:"ariaLevel",cssPropertyName:"aria-level",value:"3"},{name:"outline",cssPropertyName:"outline",value:{customPropertyName:"--ms-themeOutlineHeading3"}},{name:"backgroundColor",cssPropertyName:"background-color",value:{customPropertyName:Ha,fallbackValue:"transparent"}}]],["Body",[{name:"fontFamily",cssPropertyName:"font-family",value:{customPropertyName:"--ms-themeFontFamilyBody",fallbackValue:za}},{name:"fontSize",cssPropertyName:"font-size",value:{customPropertyName:"--ms-themeFontSizeBody",fallbackValue:"14px"}},{name:"fontWeight",cssPropertyName:"font-weight",value:{customPropertyName:"--ms-themeFontWeightBody"}},{name:"color",cssPropertyName:"color",value:{customPropertyName:"--ms-themeColorBodyText",fallbackValue:qa.neutralPrimary}},{name:"lineHeight",cssPropertyName:"line-height",value:{customPropertyName:"--ms-themeLineHeightBody",fallbackValue:"normal"}},{name:"outline",cssPropertyName:"outline",value:{customPropertyName:"--ms-themeOutlineBody"}},{name:"backgroundColor",cssPropertyNaclass $a extends tr.EventEmitter{get Disposable(){return this}diame}set themeName(e){e!==this._themeName&&(this._themeName=e,this.emit("themeNameChanged"))}set themeProperties(e){this.setThemeProperties(new Map(e))}get StylingProvider(){return this}get themeProperties(){return this.appThemeProperties}get textStyles(){return this.appTextStyles}setThemeProperties(e){const t=this.appThemeProperties?new Map(this.appThemeProperties):void 0;this.appThemeProperties=e,this.emit(Ua.a.themePropertiesChanged,t)}setTextStyles(e){const t=this.appTextStyles?new Map(this.appTextStyles):void 0;this.appTextStyles=e,this.emit(Ua.a.textStylesChanged,t)}constructor(){super(),this.setMaxListeners(0),this.appTextStyles=new Map(Va)}}var Qa,Ja=n("FR7j"),Xa=n("+sqR"),Ka=n("Hyop");!function(e){e.summarizingClient="fluid-client-summarizer",e.createNew="createNew"}(Qa||(Qa={}));const{dataCorruptionError:Ya,dataProcessingError:Za,...ec}={genericError:"genericError",throttlingError:"throttlingError",dataCorruptionError:"dataCorruptionError",dataProcessingError:"dataProcessingError",usageError:"usageError"};var tc;!function(e){e.genericError="genericError",e.genericNetworkError="genericNetworkError",e.authorizationError="authorizationError",e.fileNotFoundOrAccessDeniedError="fileNotFoundOrAccessDeniedError",e.throttlingError="throttlingError",e.offlineError="offlineError",e.unsupportedClientProtocolVersion="unsupportedClientProtocolVersion",e.writeError="writeError",e.fetchFailure="fetchFailure",e.fetchTokenError="fetchTokenError",e.incorrectServerResponse="incorrectServerResponse",e.fileOverwrittenInStorage="fileOverwrittenInStorage",e.deltaStreamConnectionForbidden="deltaStreamConnectionForbidden",e.locationRedirection="locationRedirection",e.fluidInvalidSchema="fluidInvalidSchema",e.usageError="usageError",e.fileIsLocked="fileIsLo(crypto),!rc))throw new Error("crypto.getRandomValues() not supported. See http[e[t+4]]+sc[e[t+5]]+"-"+sc[e[t+6]]+sc[e[t+7]]+"-"+sc[e[t+8]]+sc[e[t+9]]+"-"+sc[e[t+10]]+sc[e[t+11]]+sc[e[t+12]]+sc[e[t+13]]+sc[e[t+14]]+sc[e[t+15]]}(r)};let cc;function uc(e){return"string"==typeof(null==e?void 0:e.tag)}function lc(e,t){return Array.isArray(e)&&e.every((e=>dc(e)))?JSON.stringify(e):dc(e)?e:(console.error(`UnSupported Format of Logging Error Property for key ${t}:`,e),"REDACTED (arbitrary object)")}function dc(e){switch(typeof e){case"string":case"number":case"boolean":case"undefined":return!0;default:return!1}}class hc extends Error{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;super(e),this.omitPropsFromLogging=n,this._errorInstanceId=ac(),this.fluidErrorCode="-",n.add("omitPropsFromLogging"),n.add("_errorInstanceId"),t&&this.addTelemetryProperties(t)}get errorInstanceId(){return this._errorInstanceId}overwriteErrorInstanceId(e){this._errorInstanceId=e}static typeCheck(e){return"object"==typeof e&&null!==e&&"function"==typeof e.addTelemetryProperties&&"function"==typeof e.getTelemetryProperties&&"string"==typeof e.errorInstanceId}addTelemetryProperties(e){!function(e,t){for(const n of Object.keys(t))void 0===e[n]&&(e[n]=t[n])}(this,e)}getTelemetryProperties(){return{...function(e,t){const n={};for(const r of Object.keys(e)){if(t.has(r))continue;const o=e[r];n[r]=uc(o)?{value:lc(o.value,r),tag:o.tag}:lc(o,r)}return n}(this,this.omitPropsFromLogging),stack:this.stack,message:this.message,errorInstanceId:this._errorInstanceId}}}var fc;!function(e){e[e.Offline=0]="Offline",e[e.Online=1]="Online",e[e.Unknown=2]="Unknown"}(fc||(fc={}));class pc extends hc{constructor(e,t,n){super(e,{...t,statusCode:400}),this.errorType=pc.errorType,this.canRetry=!1,this.storageOnlyReason=n}}pc.errorType=tc.deltaStreamConnectionForbidden,globalThis,Symbol,new class{constructor(e){this.valueGenerator=e,this._evaluated=!1}get evaluated(){return this._evaluated}get value(){return this._evaluated||(this._evaluated=!0,this._value=this.valueGenerator()),this._value}}((()=>gc(yc())));const mc={getRawConfig:()=>{}},gc=e=>null!=e?new wc(void 0,{getRawConfig:t=>{try{var n,r;return null===(n=bc(null!==(r=e.getItem(t))&&void 0!==r?r:void 0))||void 0===n?void 0:n.raw}catch(e){return}}}):mc;function vc(e){switch(e){case"boolean":case"number":case"string":return!0;default:return!1}}function bc(e){let t,n=e;if("string"==typeof e)try{n=JSON.parse(e),t={raw:e,string:e}}catch(e){}if(void 0===n)return t;const r=typeof n;if(vc(r))return{...t,raw:e,[r]:n};if(Array.isArray(n)){const r=typeof n[0];if(!vc(r))return t;for(const e of n)if(typeof e!==r)return t;return{...t,raw:e,[`${r}[]`]:n}}return t}const yc=()=>{try{var e;return null!==(e=globalThis.sessionStorage)&&void 0!==e?e:void 0}catch(e){return}};class wc{constructor(e){this.logger=e,this.configCache=new Map,this.orderedBaseProviders=[];const t=new Set;for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];const i=[...r];for(;i.length>0;){const e=i.shift();void 0!==e&&Cc(e)&&!t.has(e)&&(t.add(e),e instanceof wc?i.push(...e.orderedBaseProviders):this.orderedBaseProviders.push(e))}}getBoolean(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.boolean}getNumber(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.number}getString(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.string}getBooleanArray(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t["boolean[]"]}getNumberArray(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t["number[]"]}getStringArray(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t["string[]"]}getRawConfig(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.raw}getCacheEntry(e){if(!this.configCache.has(e)){for(const n of this.orderedBaseProviders){const r=bc(null==n?void 0:n.getRawConfig(e));var t;if(void 0!==r)return this.configCache.set(e,r),null===(t=this.logger)||void 0===t||t.send({category:"generic",eventName:"ConfigRead",...Ec({configName:e,configValue:JSON.stringify(r)})}),r}this.configCache.set(e,{raw:void 0})}return this.configCache.get(e)}}function Cc(e){return"function"==typeof(null==e?void 0:e.getRawConfig)}var Oc;!function(e){e.CodeArtifact="CodeArtifact",e.UserData="UserData"}(Oc||(Oc={}));class Tc{constructor(e,t){this.namespace=e,this.properties=t}static sanitizePkgName(e){return e.replace("@","").replace("/","-")}static prepareErrorObject(e,t,n){const{message:r,errorType:o,stack:i}=function(e,t){const n={message:"string"==typeof(null==e?void 0:e.message)?e.message:String(e)};if((e=>null!==e&&!Array.isArray(e)&&"object"==typeof e)(e)){const{errorType:t,stack:r,name:o}=e;"string"==typeof t&&(n.errorType=t),"string"==typeof r&&(n.stack=((e,t)=>{const n=e.split("\n");return n.shift(),void 0!==t&&n.unshift(t),n.join("\n")})(r,"string"==typeof o?o:void 0))}return n}(t);if(e.stack=i,e.error=r,e.errorType=o,(e=>"function"==typeof(null==e?void 0:e.getTelemetryProperties))(t)){const n=t.getTelemetryProperties();for(const t of Object.keys(n))void 0===e[t]&&(e[t]=n[t])}void 0===e.stack&&n&&(e.stack=function(){return function(){const e=new Error("<<generated stack>>");if(void 0===cc&&(cc=void 0!==e.stack),cc)return e;try{throw e}catch(e){return e}}().stack}())}sendTelemetryEvent(e,t){var n;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20;this.sendTelemetryEventCore({...e,category:null!==(n=e.category)&&void 0!==n?n:"generic"},t,"error"===e.category?30:r)}sendTelemetryEventCore(e,t,n){const r=function(e){let{category:t,eventName:n,...r}=e;const o={category:t,eventName:n};for(const e of Object.keys(r))o[e]=Sc(r[e]);return o}(e);void 0!==t&&Tc.prepareErrorObject(r,t,!1),"number"==typeof r.duration&&(r.duration=function(e){return Math.floor(e)}(r.duration)),this.send(r,n)}sendErrorEvent(e,t){this.sendTelemetryEventCore({error:e.eventName,...e,category:"error"},t,30)}sendPerformanceEvent(e,t){var n;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20;const o={...e,category:null!==(n=e.category)&&void 0!==n?n:"performance"};this.sendTelemetryEventCore(o,t,"error"===o.category?30:r)}prepareEvent(e){const t="error"===e.category||void 0!==e.error,n={...e};return void 0!==this.namespace&&(n.eventName=`${this.namespace}${Tc.eventNamespaceSeparator}${n.eventName}`),this.extendProperties(n,t)}extendProperties(e,t){const n=e;if(this.properties){const e=[];e.push(this.properties.all),t&&e.push(this.properties.error);for(const t of e)if(void 0!==t)for(const e of Object.keys(t)){if(void 0!==n[e])continue;const r=t[e],o="function"==typeof r?r():r;void 0!==o&&(n[e]=o)}}return e}}function Sc(e){return uc(e)?{value:kc(e.value),tag:e.tag}:kc(e)}function kc(e){switch(typeof e){case"string":case"number":case"boolean":case"undefined":return e;case"object":return JSON.stringify(e);default:return console.error(`convertToBasePropertyTypeUntagged: INVALID P ${typeof e})`),`INVALID PROPERTY (typed as ${typeof e})`}}Tc.eventNamespaceSeparator=":";const Ec=e=>((e,t)=>Object.entries(t).filter((e=>void 0!==e[1])).reduce(((t,n)=>(t[n[0]]={tag:e,value:n[1]},t)),{}))(Oc.CodeArtifact,e);var _c;!function(e){e.outOfStorageError="outOfStorageError",e.invalidFileNameError="invalidFileNameError",e.snapshotTooBig="snapshotTooBig",e.fetchTimeout="fetchTimeout",e.fluidNotEnabled="fluidNotEnabled",e.fetchTokenError="fetchTokenError",e.cannotCatchUp="cannotCatchUp",e.serviceReadOnly="serviceReadOnly"}(_c||(_c={})),Uint8Array,n("2rXV");var jc=function(e){var t=e.container,n=e.fileName,r=void 0===n?"Untitled.fluid":n,o=e.filePath,i=void 0===o?"":o,s=e.siteUrl,a=e.driveId;return Object(u.__awaiter)(void 0,void 0,void 0,(function(){var e,n;return Object(u.__generator)(this,(function(o){switch(o.label){case 0:return e=function(e,t,n,r,o){return{url:`$onent(t)}&path=${encodeURIComponent(n)}`,headers:{[Qa.createNew]:{fileName:r}}}}(s,a,i,r),n={success:!1},[4,t.attach(e).then((function(){n={success:!0}})).catch((function(e){t.close(),n={success:!1,errorMessage:e.toString()}}))];case 1:return o.sent(),[2,n]}}))}))},Ic=function(e){var t=e.container,n=e.fileName,r=void 0===n?"Draft.fluid":n,o=e.filePath,i=void 0===o?"Drafts":o,s=e.siteUrl,a=e.driveId;return Object(u.__awaiter)(void 0,void 0,void 0,(function(){return Object(u.__generator)(this,(function(e){switch(e.label){case 0:return[4,jc({container:t,fileName:r,filePath:i,siteUrl:s,driveId:a})];case 1:return[2,e.sent()]}}))}))},Nc=n("SdyY"),Ac=n("EXRb");function Pc(e,t){return Object(u.__awaiter)(this,void 0,void 0,(function(){var n,r,o,i;return Object(u.__generator)(this,(function(s){if(!(n=Object(Ac.a)(e,"draftsbundles","rootContainer.".concat(t),"js")))throw"rootContainerURL undefined";return o={package:r={name:"@office-start/draft-fluid-container",version:"0.0.0",fluid:{browser:{umd:{files:[n],library:"rootContainer"}}}}},i={windowContext:window,trustedTypesPolicy:void 0,containerEnvironment:void 0,additionalAllowedCodeOrigins:["https://".concat(e.split("/")[0])],additionalCodeDetailsProviders:[["@office-start/draft-fluid-container",{getCodeDetailsPackage:function(){return Promise.resolve(r)}}]]},[2,{codeLoaderFactory:new Nc.a(i),codeDetails:o}]}))}))}function xc(e,t){var n,r=this,o=Object(Ne.a)().data,i=function(){var e=this;return Object(h.useCallback)((function(t,n,r,o){return Object(u.__awaiter)(e,void 0,void 0,(function(){var e,i,s,a,c,l;return Object(u.__generator)(this,(function(u){switch(u.label){case 0:return u.trys.push([0,3,,4]),[4,Object(Ka.a)()];case 1:if(!(e=u.sent())||!e.result)throw"Invalid myDrive info";return[4,Ic({container:t,driveId:e.result.driveId,siteUrl:e.result.driveUrl,fileName:o?"Draft.draft":"Draft.fluid"})];case 2:if(!(i=u.sent()).success)throw null!==(c=i.errorMessage)&&void 0!==c?c:"Container not attached";if(!(s=t.resolvedUrl))throw"Undefined resolvedUrl";return n.resolve(Ve({tokenProvider:r,fileId:s.itemId,driveId:e.result.driveId,siteUrl:e.result.driveUrl})),Ue({eventName:"CreateNew",status:"Success",documentId:null!==(l=s.itemId)&&void 0!==l?l:"",isCustomContainer:o}),[2,{success:!0,urlParams:{docId:s.itemId,driveId:e.result.driveId,siteUrl:e.result.driveUrl}}];case 3:return a=u.sent(),Ue({eventName:"CreateNew",status:"Error",error:a,isCustomContainer:o}),[2,{success:!1}];case 4:return[2]}}))}))}),[])}(),s=function(){var e=Ba(),t=Object(Ce.a)().data,n=Object(je.a)().data,r=function(){var e=Object(Ja.a)(),t=Object(Xa.a)(),n=Object(h.useMemo)((function(){return new $a}),[]);return Object(h.useEffect)((function(){if(n&&e){var r=new Map([["--ms-themeColorPaletteThemeDarker",e.colors.Darker],["--ms-themeColorPaletteThemeDark",e.colors.Dark],["--ms-themeColorPaletteThemeDarkAlt",e.colors.DarkAlt],["--ms-themeColorPaletteThemePrimary",e.colors.Primary],["--ms-themeColorPaletteThemeSecondary",e.colors.Secondary],["--ms-themeColorPaletteThemeTertiary",e.colors.Tertiary],["--ms-themeColorPaletteThemeLight",e.colors.Light],["--ms-themeColorPaletteThemeLighter",e.colors.Lighter],["--ms-themeColorPaletteThemeLightAlt",e.colors.LighterAlt],["--ms-themeColorBodyText",t.colorNeutralForeground1],["--ms-themeColorBodyBackground",t.colorNeutralBackground1],["--ms-themeColorInputPlaceholderText",t.colorNeutralperties(r)}}),[n,e,t]),n}(),o=Object(h.useMemo)((function(){if(t)return new Da(t.getAccessToken)}),[t]),i=Object(h.useMemo)((function(){return new Vt.a}),[]),s=Object(h.useMemo)((function(){var s,a;if(t&&n&&e&&o){var c=new _i(r),u=new La.a(t,n,"Canvas"),l={environment:u.environment,persistentCacheConfig:{enabled:!0,maxCacheItemAge:2592e5,partitionKey:null!==(a=null===(s=u.userContext.user)||void 0===s?void 0:s.id)&&void 0!==a?a:nullon(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=Object(lo.b)(e.environment),n=Di(t);return n?Mi(t,n):Li(t).then((e=>Mi(t,e)))}({environment:l.environment}),h=new ts({ecsFilters:{userContext:u.userContext,audience:u.audience},hostName:"Office.com"}),f=new Ma(n),p=new Ra(t),m=new Si;m.register("HostContext",u),m.register("TokenProvider",o),m.register("SettingsProvider",h),m.register("StylingProvider",r),m.register("PresenceColorProvider",c),m.register("UserContext",f),m.register("InternationalizationContext",p),m.register("NotificationService",i);var g={iframeTitle:"Draft Canvas",onDispose:function(){return null==c?void 0:c.dispose()}},v=function(e,t,n,r,o,i,s){return{documentServiceFactory:Oa(e,t,void 0,void 0,i),urlResolver:Aa(e,t,o,void 0)}}(o,void 0,0,0,{appName:u.hostAppName},h);return{dependencySynthesizer:m,hostContext:u,options:g,config:l,documentServiceFactory:v.documentServiceFactory,urlResolver:v.urlResolver,driverPrecacheResult:d}}}),[t,e,n,i,r,o]);return Object(h.useMemo)((function(){if(o&&s&&i)return{tokenProvider:o,fluidContainerConfig:s,notificationServiceDeferredPromise:i}}),[o,s,i])}(),a=Object(Ce.a)().data,c=Object(Oi.a)().data,l=Object(u.__read)(Object(h.useState)(),2),d=l[0],f=l[1],p=Object(u.__read)(Object(h.useState)(),2),m=p[0],g=p[1],v=Object(u.__read)(Object(h.useState)(null!==(n=null==t?void 0:t.params)&&void 0!==n?n:void 0),2),b=v[0],y=v[1],w=Object(h.useMemo)((function(){return"New"===(null==t?void 0:t.type)?"RenderNew":"RenderExisting"}),[t]),C=Object(u.__read)(Object(h.useState)(new Map),2),O=C[0],T=C[1],S=Object(h.useCallback)((function(n){return Object(u.__awaiter)(r,void 0,void 0,(function(){var r,l,d,h,p,m,v,b,C,O,T,S,k,E,_,j,I,N,A,P,x,D,L,M,R,F,B,U,W,q;return Object(u.__generator)(this,(function(H){switch(H.label){case 0:if(!(s&&n&&t&&(null==a?void 0:a.cdnDomain)&&(null===(L=null==c?void 0:c.result)||void 0===L?void 0:L.drafts)))return[2];H.label=1;case 1:return H.trys.push([1,16,,17]),e&&c.result.drafts.rootContainerHash?[4,Pc("localhost:3000"===a.cdnDomain?"res.cdn.office.net/officehub":a.cdnDomain,c.result.drafts.rootContainerHash)]:[3,9];case 2:return l=H.sent(),_=l.codeDetails,h=(d=s.fluidContainerConfig.dependencySynthesizer).register,p=["FluidCodeLoaderFactory"],[4,l.codeLoaderFactory];case 3:return h.apply(d,p.concat([H.sent()])),m=function(e,t){var n;if("Edit"===e.type&&e.params){var r=function(e){let t=`${e.siteUrl}?driveId=${encodeURIComponent(e.driveId)}&itemId=${encodeURIComponent(e.itemId)}&path=${encodeURIComponent(e.dataStorePath)}`;return e.containerPackageName&&(t+=`&containerPackageName=${encodeURIComponent(e.containerPackageName)}`),e.fileVersion&&(t+=`&fileVersion=${encodeURIComponent(e.fileVersion)}`),t}({siteUrl:e.params.siteUrl,driveId:e.params.driveId,itemId:e.params.docId,dataStorePath:"draft"}),o=ze({siteUrl:e.params.siteUrl,driveId:e.params.driveId,itemId:e.params.docId,dataStorePath:"draft"});n={type:"Data",data:{url:new URL("".concat(r,"&nav=").concat(o))},dataType:"URL",registrationId:"fluid-odsp"}}else n={type:"Fluid",codeDetails:t};return n}(t,_),[4,(j=oi(Object(u.__assign)(Object(u.__assign)({},s.fluidContainerConfig),{loopComponentRouterInput:m}))).container];case 4:if(!(r=H.sent()))throw"Container not rendered";return f(r),[4,r.request({url:"/"})];case 5:return v=H.sent(),[4,null===(M=v.value.RootContainer)||void 0===M?void 0:M.getDraftComponent(t.type)];case 6:if(!(A=H.sent()))throw"Draft Component not found";return g(A),[4,A.getView()];case 7:return[4,null==(P=H.sent())?void 0:P.render(n,null==o?void 0:o.draftResources.documentPlaceholderText)];case 8:return H.sent(),[3,13];case 9:if(b=void 0,"Edit"===t.type&&t.params){if(O=(C=t.params).siteUrl,T=C.driveId,S=C.docId,function(e,t){const n=ze(t);e.searchParams.set("nav",n)}(k=new URL(t.params.docUrl),{driveId:T,siteUrl:O,itemId:S,dataStorePath:"/",fileVersion:void 0}),!(E=function(e){const t=function(e){const t=e.searchParams.get("nav");if(t)return function(e,t){var n,r,o,i;const s=new URLSearchParams((e=>He.from(e,"base64").toString("utf-8"))(e));if("1"!==s.get("fluid"))return;const a=s.get("s"),c=s.get("d"),u=s.get("f"),l=s.get("c"),d=null!==(n=s.get("a"))&&void 0!==n?n:void 0,h=null!==(r=s.get("p"))&&void 0!==r?r:void 0,f=null!==(o=s.get("v"))&&void 0!==o?o:void 0,p=null!==(i=s.get("x"))&&void 0!==i?i:void 0;if(!a||!c||!u||null===l)return;let m;try{m=new URL(a,t)}catch(e){}return m?{siteUrl:m.href,driveId:c,itemId:u,dataStorePath:l,appName:d,containerPackageName:h,fileVersion:f,context:p}:void 0}(t,"https://1drv.ms"===e.origin.toLowerCase()?"https://my.microsoftpersonalcontent.com":e.origin)}(e);if(!t)return;let n;try{null!=t&&t.siteUrl&&(n=new URL(null==t?void 0:t.siteUrl).origin)}catch(e){}return{codeDetailsHint:null==t?void 0:t.containerPackageName,criticalBootDomains:n?[n]:void 0}}(k)))throw"Invalid PreCheckInfo";s.notificationServiceDeferredPromise.resolve(Ve({tokenProvider:s.tokenProvider,fileId:S,driveId:T,siteUrl:O})),b=function(e){let{dependencySynthesizer:t,hostContext:n,containerRequest:r,preCheckInfo:o,options:i,documentServiceFactory:s,driverPrecacheResult:a,urlResolver:c,iframeHostingElement:u,config:l}=e;const d=Date.now(),h={type:ii.a.Custom,documentUrl:r.url,headers:r.headers,containerCodeHint:o.codeDetailsHint,preconnectDomains:o.criticalBootDomains,componentId:"/"};return wi({initializeConfig:{type:"Load",driverInfo:h},iframeHostingElement:u,dependencySynthesizer:t,hostContext:n,config:l,documentServiceFactory:s,urlResolver:c,driverPrecacheResult:a,options:i,additionalInfo:{bootstrapperStartTime:d},createOrLoadCallback:Ci(h,o)})}(Object(u.__assign)(Object(u.__assign)({},s.fluidContainerConfig),{containerRequest:{url:k.href},preCheckInfo:E,iframeHostingElement:n}))}else _=Object(Bt.c)(),b=function(e){var t;return function(e,t,n,r,o){let{dependencySynthesizer:i,hostContext:s,config:a,iframeHostingElement:c,documentServiceFactory:u,urlResolver:l,driverPrecacheResult:d}=e;return wi({iframeHostingElement:c,initializeConfig:r,documentServiceFactory:u,urlResolver:l,driverPrecacheResult:d,dependencySynthesizer:i,hostContext:s,config:null!=a?a:{},options:t,additionalInfo:{bootstrapperStartTime:o},createOrLoadCallback:n})}(e,e.options,function(e){let{codeDetails:t,heroComponentConfiguration:n,loadTemplateProps:r}=e;return e=>{const{windowContextForLoader:o,hostConfig:i,logger:s,dependencySynthesizer:a,hostContext:c,perfMetadata:u,documentEverHiddenTrackerId:l,documentServiceFactory:d,urlResolver:h}=e;return Xo(o,{codeDetails:t,heroComponentConfiguration:n,dependencySynthesizer:a,hostContext:c,loadTemplateProps:r},{documentServiceFactory:d,urlResolver:h},void 0,i,s,u,l)}}(e),{type:"CreateFromCode",driverType:null!==(t=e.config)&&void 0!==t&&t.driverImplementationOverride?ii.a.Custom:ii.a.SPO,codeDetails:e.codeDetails,heroComponentConfiguration:e.heroComponentConfiguration,loadTemplateProps:e.loadTemplateProps},Date.now())}(Object(u.__assign)(Object(u.__assign)({},s.fluidContainerConfig),{iframeHostingElement:n,codeDetails:_}));return[4,b.loadedInfo];case 10:return j=H.sent(),[4,Promise.all([j.container,j.component])];case 11:return I=u.__read.apply(void 0,[H.sent(),2]),A=I[1],f(N=I[0]),r=N,[4,null===(R=A.HTMLViewable)||void 0===R?void 0:R.getView()];case 12:if(null==(P=null===(F=H.sent())||void 0===F?void 0:F.HTMLView)||P.render(b.getRenderHostingElement()),!N||!P)throw"Container not rendered";H.label=13;case 13:return Ue({eventName:w,status:"Success",documentId:null!==(U=null===(B=null==t?void 0:t.params)||void 0===B?void 0:B.docId)&&void 0!==U?U:"",isCustomContainer:e}),"New"!==t.type?[3,15]:[4,i(r,s.notificationServiceDeferredPromise,s.tokenProvider,e)];case 14:(x=H.sent()).success&&x.urlParams&&y(x.urlParams),H.label=15;case 15:return[3,17];case 16:return D=H.sent(),Ue({eventName:w,status:"Error",error:D.toString(),documentId:null!==(q=null===(W=null==t?void 0:t.params)||void 0===W?void 0:W.docId)&&void 0!==q?q:"",isCustomContainer:e}),[3,17];case 17:return[2]}}))}))}),[s,a,t,w,c,e,null==o?void 0:o.draftResources.documentPlaceholderText,i]),k=Object(h.useCallback)((function(){return Object(u.__awaiter)(r,void 0,void 0,(function(){var e,t;return Object(u.__generator)(this,(function(n){switch(n.label){case 0:return m?(e="",[4,m.getAllText()]):[2,""];case 1:return t=n.sent(),[2,e.concat.apply(e,Object(u.__spreadArray)([],Object(u.__read)(t),!1))]}}))}))}),[m]);return Object(h.useEffect)((function(){if(d&&m)return d.audience.on("addMember",(function(e,t){var n=t.user;if(e!==d.clientId&&n.email){var r={id:e,name:n.name,email:n.email,presenceColorProvider:m.presaudience.on("removeMember",(function(e,t){if(e!==d.clientId){var n=new Map(O);n.delete(e),T(n)}})),function(){d.audience.removeAllListeners(),d.close()}}),[d,m,O]),Object(h.useMemo)((function(){if(S)return{renderContainerCallback:S,driveParams:b,getDraftContentCallback:k,members:O}}),[S,b,k,O])}var Dc=n("kNhz"),Lc=n("SnJU"),Mc=n("LYe0"),Rc=n("FZB6"),Fc=n("vnUm"),Bc=n("t6yz"),Uc=n("LsEq"),Wc=n("T68q"),qc=[{app:"document",likelihood:3,explanation:"A document can be used to create a sales presentation, but a Slidedeck is more effective in capturing your audiences attention. Use Word to write and format your content, and insert images and tables. However, a document is better for detailed reports or handouts, not presentations."},{app:"loop",likelihood:3,explanation:"Use Loop to create interactive and collaborative sales presentations with markdown. Add text, images, tables, and lists, and share with your team. However, Loop may not have the same features as a Slidedeck, like transitions and animations. Its great for brainstorming and co-creating, but not for presenting."},{app:"slidedeck",likelihood:3,explanation:"Use a Slidedeck to create a sales presentation for a new innovative toaster, design your slides with PowerPoint, adding transitions, animations, and multimedia. Rehearse with notes and timings."},{app:"spreadsheet",likelihood:3,explanation:"Use Excel to create a spreadsheet that lists common expenses for a hotel, including categories, amounts, and descriptions. You can also use Excels built-in functions to calculate totals and averages."}],Hc=new Map([[Te.a.Word,"document"],[Te.a.Excel,"spreadsheet"],[Te.a.PowerPoint,"slidedeck"]]),zc=n("JIAX"),Gc=n("CMIS"),Vc=function(e){var t=e.errorCategory,n=e.errorType,r=e.message,o=e.subArea;Object(Gc.a)({eventName:"DraftsError",area:"Drafts",errorCategory:t,errorType:n,message:r,subArea:o})};function $c(){var e,t,n,r,o,i,s,a,c,l=Object(ve.a)().data,d=Ba(),f=xc(!!(null===(t=null===(e=null==l?void 0:l.result)||void 0===e?void 0:e.draftGates)||void 0===t?void 0:t.draftCustomContainerEnabled),d),p=function(e,t){var n=this,r=Object(Ne.a)().data,o=Object(Ce.a)().data,i=Object(je.a)().data,s=Object(Oe.a)().data,a=Object(we.a)(),c=Object(u.__read)(Object(h.useState)("OnlyYou"),2),l=c[0],d=c[1],f=Object(u.__read)(Object(h.useState)(),2),p=f[0],m=f[1],g=Object(u.__read)(Object(h.useState)(),2),v=g[0],b=g[1],y=Object(u.__read)(Object(h.useState)(),2),w=y[0],C=y[1],O=Object(h.useCallback)((function(t,n){e&&Object(Re.a)((function(){!function(e){Object(u.__awaiter)(this,void 0,void 0,(function(){var t,n,r,o,i,s;return Object(u.__generator)(this,(function(a){switch(a.label){case 0:return[4,Promise.all([Object(De.a)(),Object(Ae.a)(),Object(Pe.a)()])];case 1:if(t=u.__read.apply(void 0,[a.sent(),3]),r=t[1],o=t[2],!(n=t[0]))throw new Error("MruConfig");if(!r)throw new Error("OfficeComponentContext");if(!o)throw new Error("SharedContext");return i="".concat(n.mruServiceRoot,"/v2/recent"),s={method:"POST",headers:{"Content-Type":"application/json","X-Office-Platform":"Web","X-Office-Application":o.iceApplicationId.toString(),"X-Office-Version":r.buildVersion,"X-CorrelationId":r.correlationId}},[2,Object(Le.a)(xe.a.MruWrite,"Mru_Write",i,e,s,r.jwtAuthEnabled,r.getAccessToken,r.officeHomeApiRoot,r.correlationId,"MruPlusPlus",{populateRequestEvent:function(e,t){t.RequestId=e.headers&&e.headers["X-CorrelationId"]||""}}).then((function(e){if(!e||!e.ok||void 0===e.data)throw new Error((null==e?void 0:e.statusText)||"Graph API error");return e.data}))]}}))}))}({app:"Fluid",category:"Document",extension:"fluid",title:t,type:"DocumentUrl",url:n,onedrive_info:{drive_id:e.driveId,item_id:e.docId}})}),Fe.c)}),[e]);Object(h.useEffect)((function(){e&&o&&s&&i&&function(){Object(u.__awaiter)(n,void 0,void 0,(function(){var t,n,r,a,c,l;return Object(u.__generator)(this,(function(u){switch(u.label){case 0:return[4,Object(Ee.a)({driveId:e.driveId,itemId:e.docId,graphXhrOptions:{correlationId:o.correlationId,getAccessToken:o.getAccessToken,jwtAuthEnabled:o.jwtAuthEnabled,officeApiRoot:o.officeHomeApiRoot,graphApiRoot:s.graphApiRoot},queryParams:{select:["createdBy","currentUserRole","id","name","shared","sharePointIds","webDavUrl","webUrl"].join(",")}})];case 1:return(t=u.sent())&&(d(t.shared?"Shared":"OnlyYou"),m(Object(ke.a)(t.name)),b(t.webDavUrl),n={app:"Office",attribution:null!==(a=null===(r=t.createdBy)||void 0===r?void 0:r.user.displayName)&&void 0!==a?a:"",docId:e.docId,driveId:e.driveId,extension:"draft",fileType:Te.a.Draft,id:t.id,isReadOnly:t.currentUserRole.readOnly,title:null!==(c=t.name)&&void 0!==c?c:"",url:t.webDavUrl,webUrl:t.webUrl,sharepointIds:null!==(l=t.sharepointIds)&&void 0!==l?l:void 0,actionInfo:{odspShareInfo:i.isMsa?{enabled:!0,type:"Consumer",driveId:e.driveId,itemId:e.docId,url:t.webUrl,isManageAccessEnabled:!0}:{enabled:!0,type:"Commercial",sharePointIds:t.sharepointIds,url:t.webUrl,isManageAccessEnabled:!0}}},C(n)),[2]}}))}))}()}),[o,e,i,s]);var T=Object(h.useCallback)((function(r){return Object(u.__awaiter)(n,void 0,void 0,(function(){var n,i,a;return Object(u.__generator)(this,(function(c){switch(c.label){case 0:if(r===p)return[2,!1];if(!e||!o||!s)return Ue({eventName:"RenameFile",status:"Error",error:"Invalid params",isCustomContainer:t}),[2,!1];c.label=1;case 1:return c.trys.push([1,3,,4]),[4,Object(_e.a)({driveId:e.driveId,itemId:e.docId,graphXhrOptions:{correlationId:o.correlationId,getAccessToken:o.getAccessToken,jwtAuthEnabled:o.jwtAuthEnabled,officeApiRoot:o.officeHomeApiRoot,graphApiRoot:s.graphApiRoot},patchedItem:{name:"".concat(r,".").concat(t?"draft":"fluid")}})];case 2:return c.sent(),m(r),Ue({eventName:"RenameFile",status:"Success",documentId:e.docId,isCustomContainer:t}),[2,!0];case 3:return n=c.sent(),Ue({eventName:"RenameFile",status:"Error",error:"".concat(n.clientError,": ").concat(null===(a=null===(i=n.httpResponse.data)||void 0===i?void 0:i.error)||void 0===a?void 0:a.message),documentId:e.docId,isCustomContainer:t}),[2,!1];case 4:return[2]}}))}))}),[o,p,e,t,s]),S=Objec(e){Object(Ie.a)({route:"MyContent",type:Me.a.Base,entityId:e?"drafts":void 0})}),[]),k=Object(h.useMemo)((function(){if(p&&v)return function(){return O(p,v)}}),[p,v,O]),E=Object(h.useMemo)((function(){return"Shared"===l?{icon:"PeopleIcon",title:null==r?void 0:r.draftResources.sharedSharingState,tooltip:null==r?void 0:r.draftResources.sharedSharingStateTooltip}:{icon:"LockClosedIcon",title:null==r?void 0:r.draftResources.privateSharingState,tooltip:null==r?void 0:r.draftResources.privateSharingStfunction(e){if(!r)return[];var t=[ye.b.Share,ye.b.CopyLink,ye.b.ShareToTeams,ye.b.ManageAccess];return e.filter((function(e){return t.includes(e.metadata.id)})).map((function(e){var t=Object(u.__assign)(Object(u.__assign)({},e),{metadata:Object(u.__assign)({},e.metadata)});return t.metadata.id==ye.b.Share?(t.metadata.name=r.documentActionsMenuResources.shareActionTitle,t.metadata.icon={type:Se.a.ActionContextMenuIcon,iconName:"ShareIcon"}):t.metadata.id==ye.b.ShareToTeams&&(t.metadata.name=r.documentActionsMenuResources.shareToTeamsDraftActionTitle),t}))}),[r]),j=Object(h.useMemo)((function(){if(a&&w&&(null==r?void 0:r.draftResources)&&E)return{actions:a.createSpecificActions(w,{targetElementId:"draftShare"},"Drafts","Drafts","DraftShareMenu",_),item:w,contentActionsEnabled:!0,ariaLabel:r.draftResources.sharedSharingState,triggerOptions:{appearance:"subtle",size:"medium",name:E.title,buttonType:"MenuButton",icon:{type:Se.a.ActionContextMenuIcon,iconName:E.icon},tooltip:E.tooltip}}}),[a,w,r,E,_]);return Object(h.useMemo)((function(){var e;if((null==r?void 0:r.draftResources)&&(null==r?void 0:r.firstDraftResources))return{draftTitle:null!=p?p:"Untitled",isReadOnly:null!==(e=null==w?void 0:w.isReadOnly)&&void 0!==e&&e,renameDraftCallback:T,changeRouteCallback:S,actionsProps:j,renderDraftCallback:k,draftStrings:r.draftResources,firstDraftResources:r.firstDraftResources}}),[p,null==w?void 0:w.isReadOnly,T,S,k,j,r])}(null!==(n=null==f?void 0:f.driveParams)&&void 0!==n?n:void 0,!!(null===(o=null===(r=null==l?void 0:l.result)||void 0===r?void 0:r.draftGates)||void 0===o?void 0:o.draftCustomContainerEnabled)),m=function(e,t,n){var r,o,i,s,a=this,c=Object(ve.a)().data,l=Object(Dc.a)(),d=Object(Wc.a)().createSuccessNotification,f=Object(u.__read)(Object(h.useState)(!1),2),p=f[0],m=f[1],g=Object(Lc.a)("Drafts",Fc.h,void 0,[Te.a.Fluid]),v=Object(h.useCallback)((function(t){var n=g.find((function(e){return e.creationFileType===t}));(null==n?void 0:n.onClick)&&n.onClick(),Ue({eventName:"CreateBlankDoc",status:"Success",documentId:null!=e?e:"",subArea:"DraftTransform",isCustomContainer:!0})}),[g,e]),b=Object(h.useCallback)((function(){return Object(u.__awaiter)(a,void 0,void 0,(function(){var r,o;return Object(u.__generator)(this,(function(i){switch(i.label){case 0:return n&&t?[4,t()]:[2];case 1:return r=i.sent(),Object(Mc.a)(r),d(null==n?void 0:n.copiedToastText),null==(o=window.getSelection())||o.removeAllRanges(),Ue({eventName:"CopyContentClick",status:"Success",documentId:null!=e?e:"",subArea:"DraftTransform",isCustomContainer:!0}),[2]}}))}))}),[d,e,n,t]),y=Object(h.useCallback)((function(e){-1!==Fc.c.indexOf(e)&&b(),v(e)}),[b,v]),w=Object(h.useCallback)((function(n,r){return Object(u.__awaiter)(a,void 0,void 0,(function(){var r,o,i,s,a,d,h;return Object(u.__generator)(this,(function(u){switch(u.label){case 0:m(!0),u.label=1;case 1:return u.trys.push([1,,5,6]),t?(o=-1!==Fc.d.indexOf(n),[4,t()]):[2];case 2:return i=u.sent(),l&&(null===(h=null===(d=null==c?void 0:c.result)||void 0===d?void 0:d.firstDraftGates)||void 0===h?void 0:h.firstDraftDocumentCreationThroughALEnabled)&&o&&i&&(s=Hc.get(n))?[4,new Promise((function(e){return null==l?void 0:l.createDocument({content:i,initialAsk:"Create file with content",documentType:s},(function(t){var n;e({error:t.error,errorType:t.errorType,webUrl:null===(n=t.response)||void 0===n?void 0:n.webUrl,logFirstDraftError:function(e,t){Vc({errorCategory:"React",errorType:"Draft_Error",message:"".concat(e,"_").concat(t||"Create document error"),subArea:"DraftTransform"})}})}))}))]:[3,4];case 3:r=u.sent(),u.label=4;case 4:return r&&r.webUrl?r.error?(a=r.errorType&&Bc.a.has(null==r?void 0:r.errorType)?"Encountered RAI error on create document":"".concat(r.errorType," error encountered on create document"),Vc({errorCategory:"React",errorType:"Draft_Error",message:"CreateDocumentCopilot_".concat(a||"Create document error"),subArea:"DraftTransform"})):window.open(r.webUrl)||Vc({errorCategory:"React",errorType:"Draft_Error",message:"OpenDocumentTab_Create document error",subArea:"DraftTransform"}):v(n),[3,6];case 5:return m(!1),Ue({eventName:"CreateItemClick",status:r?"Success":"Error",documentId:null!=e?e:"",documentType:Object(Rc.a)(n),subArea:"DraftTransform",isCustomContainer:!0}),[7];case 6:return[2,r]}}))}))}),[e,null===(o=null===(r=null==c?void 0:c.result)||void 0===r?void 0:r.firstDraftGates)||void 0===o?void 0:o.firstDraftDocumentCreationThroughALEnabled,l,t,v]),C=Object(h.useCallback)((function(){var t={route:"AppGallery",type:Me.a.Base},n=Object(Uc.a)("Drafts");Object(Ie.a)(t,{action:"OpenAllApps",linkTarget:"_blank"},n),Ue({eventName:"SeeAllAppsClick",status:"Success",documentId:null!=e?e:"",subArea:"DraftTransform",isCustomContainer:!0})}),[e]),O=function(e){var t=function(){var e=Object(je.a)().data,t=Object(Lc.a)("FirstDraft",Fc.h,void 0,[Te.a.Fluid,Te.a.Whiteboard,Te.a.List,Te.a.PowerBI,Te.a.Yammer].concat((null==e?void 0:e.isOrgId)?[]:[Te.a.Clipchamp]));return((null==e?void 0:e.isMsa)?zc.c:zc.b).filter((function(e){return t.some((function(t){return function(e){var t,n;try{for(var r=Object(u.__values)(Fc.a),o=r.next();!o.done;o=r.next()){var i=Object(u.__read)(o.value,2);if(i[1]===e)return i[0]}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return"other"}(t.creationFileType)===e}))}))}(),n=Object(Dc.a)(),r=Object(h.useCallback)((function(e,r,o){n&&n.submitInitialIntent("<|prompt|>Recommend five to ten apps that could be used to create a file with the following content."+e,t,(function(e){var t=e.response;r(null==t?void 0:t.documentTypeRecommendations,e.error,e.errorType)}),(function(e){var t=e.response;return o(null==t?void 0:t.content,e.error,e.errorType)}))}),[n,t]);return Object(h.useCallback)((function(t,n,o){return Object(u.__awaiter)(void 0,void 0,void 0,(function(){var i;return Object(u.__generator)(this,(function(s){switch(s.label){case 0:return e?[4,e()]:[2];case 1:return(i=s.sent())?(r(i,(function(e,r,i){var s=e&&e.filter((function(e){var t=function(e){var t;return null!==(t=Fc.a.get(e.toLowerCase()))&&void 0!==t?t:Te.a.None}(e.app);return e.likelihood>zc.a.Unknown&&t!==Te.a.None}));t()&&(!r&&s?s.length>0?n(s):(console.log("No filtered recommendations: "+i+". Setting default recommendations"),n(qc)):(console.log("Error getting document type recommendations: "+i),n(qc)),o(!1))}),(function(e,t,n){var r;t?console.log("contentCallErrorType: "+n):console.log(null!==(r="ontent: "+e)&&void 0!==r?r:"Error")})),[2]):[2]}}))}))}),[e,r])}(t);return Object(h.useMemo)((function(){var e,t;if((null===(t=null===(e=null==c?void 0:c.result)||void 0===e?void 0:e.draftGates)||void 0===t?void 0:t.draftTransformEnabled)&&l&&b&&w&&y&&O)return{getAndSetDocumentTypeRecommendations:O,handleCreateItemClick:w,handleCopyContentClick:b,handleSeeAllAppsClick:C,handleCopyAndCreateFallback:y,showLatencyLoading:p}}),[null===(s=null===(i=null==c?void 0:c.result)||void 0===i?void 0:i.draftGates)||void 0===s?void 0:s.draftTransformEnabled,l,b,w,y,O,C,p])}(null!==(s=null===(i=null==f?void 0:f.driveParams)||void 0===i?void 0:i.docId)&&void 0!==s?s:void 0,null==f?void 0:f.getDraftContentCallback,null==p?void 0:p.firstDraftResources);return Object(h.useMemo)((function(){var e,t;if(f&&p){var n=f.members,r=f.renderContainerCallback;return Object(u.__assign)(Object(u.__assign)(Object(u.__assign)(Object(u.__assign)({renderContainerCallback:r},p),{transformEnabled:!!(null===(t=null===(e=null==l?void 0:l.result)||void 0==void 0:t.draftTransformEnabled)}),m),{members:n,logDraftsFeatureCallback:function(e){Ue(e)},fetchPersonPictureDataCallback:function(e){return Object(be.a)(e)}})}}),[f,p,null===(c=null===(a=null==l?void 0:l.result)||void 0===a?void 0:a.draftGates)||void 0===c?void 0:c.draftTransformEnabled,m])}var Qc=n("laSs"),Jc=function(){var e,t,n=Object(ve.a)().data,r=$c(),o=(null===(t=null===(e=null==n?void 0:n.result)||void 0===e?void 0:e.draftGates)||void 0===t?void 0:t.draftEnabled)&&r;return Object(h.useEffect)((function(){o&&function(e){Object(Qc.a)({eventName:"Drafts",area:"Drafts",subArea:void 0})}()}),[o]),o?f.a.createElement(ge,Object(u.__assign)({},r)):(Object(Ie.a)({route:"OfficeHome",type:Me.a.Base}),null)},Xc=n("M21c"),Kc=n("YQN1"),Yc=n("oRCi"),Zc=n("9WrL"),eu=n("bmzq"),tu=n("JLWT"),nu=n("2UBZ"),ru=n("fFwu"),ou=n("Z0U4"),iu=n("w1PR"),su=n("4/We"),au=n("cgnd"),cu=n("/I02"),uu=function(e){function t(t,n,r,o,i,s,a){var c=e.call(this,t)||this;return c.capabilitiesService=n,c.clientStartupConfigService=r,c.contextService=o,c.officeRouteService=i,c.officeStartBootstrapperService=s,c.themingService=a,c}return Object(u.__extends)(t,e),t.prototype.ngOnInit=function(){Object(Kc.a)(this.officeStartBootstrapperService,this.themie,this.contextService,this.clientStartupConfigService),e.prototype.ngOnInit.call(this)},t.prototype.ngOnDestroy=function(){e.prototype.ngOnDestroy.call(this)},t.prototype.getReactElement=function(){return Object(u.__awaiter)(this,void 0,void 0,(function(){var e;return Object(u.__generator)(this,(function(t){return e=function(e){return function(t){var n=function(e){return function(t){var n=Object(Ja.b)();return Object(h.useEffect)((function(){var e=!0,t=Object(ru.getOfficeStartThemeObservable)(),r=null==t?void 0:t.subscribe((function(t){if(e&&t){var r=t.darkBrandColors?{Dark:t.darkBrandColors.themeDark,Darker:t.darkBrandColors.themeDarker,DarkAlt:t.darkBrandColors.themeDarkAlt,Light:t.darkBrandColors.themeLight,Lighter:t.darkBrandColors.themeLighter,LighterAlt:t.darkBrandColors.themeLighterAlt,Primary:t.darkBrandColors.themePrimary,Secondary:t.darkBrandColors.themeSecondary,Tertiary:t.darkBrandColors.themeTertiary}:void 0;n({id:t.themeId,type:nu.b.Harmony,mode:t.mode,colors:"dark"===t.mode?Object(u.__assign)(Object(u.__assign)({},r),{DarkTheme:r}):{Dark:t.lightBrandColors.themeDark,Darker:t.lightBrandColors.themeDarker,DarkAlt:t.lightBrandColors.themeDarkAlt,Light:t.lightBrandColors.themeLight,Lighter:t.lightBrandColors.themeLighter,LighterAlt:t.lightBrandColors.themeLighterAlt,Primary:t.lightBrandColors.themePrimary,Secondary:t.lightBrandColors.themeSecondary,Tertiary:t.lightBrandColors.themeTertiary,DarkTheme:r}})}}));return function(){e=!1,null==r||r.unsubscribe()}}),[]),f.a.createElement(e,Object(u.__assign)({},t))}}(e);return f.a.createElement(tu.c,null,f.a.createElement(n,Object(u.__assign)({},t)))}}(Jc),[2,React.createElement(Xc.a,{style:{height:"100%",backgroundColor:"transparent"}},React.createElement(e,null))]}))}))},t}(eu.a),lu=function(){return function(){}}(),du=r.Fb({encapsulation:2,styles:[],data:{}});function hu(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,3,"div",[["class","draft-content-react-container"],["ohpInstrumentPageView","DraftContent_PageView"],["style","height: 100%;"]],null,null,null,null,null)),r.Gb(1,81920,null,0,s.a,[a.c,c.a],{pageName:[0,"pageName"]},null],null,null,null,null,null)),r.Gb(3,212992,null,0,uu,[r.o,su.a,au.b,cu.a,ou.a,Zc.a,iu.b],null,null)],(function(e,t){e(t,1,0,"DraftContent_PageView"),e(t,3,0)}),null)}var fu=r.Db("ohp-draft-content",lu,(function(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"ohp-draft-content",[["style","height: 100%;"]],null,null,null,hu,du)),r.Gb(1,49152,null,0,lu,[],null,null)],null,null)}),{},{},[]),pu=n("TOqr"),mu=n("X+PR"),gu=n("+P5Z"),vu=r.Eb(o,[],(function(e){return r.Tb([r.Ub(512,r.k,r.hb,[[8,[i.a,fu]],[3,r.k],r.D]),r.Ub(4608,pu.m,u],[2,mu.n]]),r.]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!i(e)||o(e))&&(r(e)?c:a).test(s(e))}},Z4SR:function(e,t,n){"use s;const r="snapshot"},ZSEI:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("sYiP"),o=n("lYt+"),i=function(learNotification:function(nction(e,t){i(Object(r.a)(e,t))},createLoadingNotification:function(e,t){i(Object(r.b)(e,t))},createSuccessNotification:function(e,t,n){i(Object(r.c)(e,t,n))}}},ZaV9:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return a}));var r=n("Fpy5");function o(e){const t=new URL(e.siteUrl);let n=`s=${encodeURIComponent(t.pathname)}&d=${encodeURIComponent(e.driveId)}&f=${encodeURIComponent(e.itemId)}&c=${encodeURIComponent(e.dataStorePath)}&fluid=1`;return e.appName&&(n+=`&a=${encodeURIComponent(e.appName)}`),e.containerPackageName&&(n+=`&p=${encodeURIComponent(e.containerPackageName)}`),e.fileVersion&&(n+=`&v=${encodeURIComponent(e.fileVersion)}`),e.context&&(n+=`&x=${encodeURIComponent(e.context)}`),Object(r.b)(n)}const i="nav";function s(e,t){const n=o(t);e.searchParams.set(i,n)}function a(e){const t=e.searchParams.get(i);if(t)return function(e,t){var n,o,i,s;const a=new URLSearchParams(Object(r.a)(e));if("1"!==a.get("fluid"))return;const c=a.get("s"),u=a.get("d"),l=a.get("f"),d=a.get("c"),h=null!==(n=a.get("a"))&&void 0!==n?n:void 0,f=null!==(o=a.get("p"))&&void 0!==o?o:void 0,p=null!==(i=a.get("v"))&&void 0!==i?i:void 0,m=null!==(s=a.get("x"))&&void 0!==s?s:void 0;if(!c||!u||!l||null===d)return;let g;try{g=new URL(c,t)}catch(e){}return g?{siteUrl:g.href,driveId:u,itemId:l,dataStorePath:d,appName:h,containerPackageName:f,fileVersion:p,context:m}:void 0}(t,"https://1drv.ms"===e.origin.toLowerCase()?"https://my.microsoftpersonalcontent.com":e.origin)}},ZcZ3:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("6ib3"),o=n("Tqea");function i(e){switch(e){case r.a.Word:return"WordOnline";case r.a.Excel:return"ExcelOnline";case r.a.PowerPoint:return"PowerPointOnline";case r.a.OneNote:return"OneNoteOnline";case r.a.Sway:return"Sway";case r.a.Visio:return"VisioOnline";case r.a.Project:case r.a.ProjectOperations:case r.a.Portfolio:return"Project";case r.a.PowerBI:return"PowerBIv2";default:return Object(o.a)(e)}}},ZjeS:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("CDuu"),o=n("RAG2");function i(){return Object(r.a)(o.a)}},ZrMS:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("faS/"),o=n("pKjf"),i=n("mXGw"),s=function(){var e=Object(r.a)({area:"WelcomeBadge",logFullQuota:!0});returnr]))}));var l=o.concat(i).concat(s).concat(a),d=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===l.indexOf(e)}));return r.forEach(d,u),n}},ZsNf:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n("QjXU"),o=n("MJsD"),i=n("V9hE"),s=n("/Oio"),a=n("CMIS"),c=n("GMuP"),u=n("Dn7E"),l=n("+k3c"),d=n("gd1C"),h=function(e,t,n){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(!t.disableDefaultLinkBehavior&&event&&!event.defaultPrevented)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),o=t.action,[4,Object(d.a)(e,{action:o},n)];case 2:return[2,r.sent()];case 3:return r.sent(),[2,{success:!1,message:"launchWebApp:launchUrlException"}];case 4:return[2,{success:!1,message:"launchWebApp:fallThrough"}]}}))}))},f=n("KSsg"),p=n("5HQQ"),m=function(e,t){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var n,m,g,v,b,y,w,C,O,T,S,k,E,_,j,I,N;return Object(r.__generator)(this,(function(A){switch(A.label){case 0:n={success:!1},m="launchApp",A.label=1;case 1:return A.trys.push([1,14,15,16]),[4,Object(o.a)()];case 2:return g=A.sent(),v=e.appName,b=e.url,(y=g.workload==s.a.Hwa&&v)?[4,Object(p.a)(v)]:[3,4];case 3:y=A.sent(),A.label=4;case 4:if(!y)return[3,11];w=e.disableDefaultLinkBehavior,O=!(C=e.event)||C.defaultPrevented||w?void 0:function(){return null==C?void 0:C.preventDefault()},T=void 0,A.label=5;case 5:return A.trys.push([5,7,,8]),[4,Object(l.a)({appName:v,filePath:e.useUrl?b:"",prelaunchCallback:O})];case 6:return T=A.sent(),Object(f.a)({launchInstrumentationParams:t,success:T.success}),T.success&&(n=Object(r.__assign)(Object(r.__assign)({},T),{result:"Native"})),[3,8];case 7:return A.sent(),[3,8];case 8:return(null==T?void 0:T.success)?[3,10]:[4,h(b,e,t)];case 9:n=A.sent(),A.label=10;case 10:return[3,13];case 11:return S=e.targetTab,[4,Object(d.a)(b,{action:"OpenInApp",targetTab:S},t)];case 12:n=A.sent(),A.label=13;case 13:return[3,16];case 14:return k=A.sent(),E=void 0,_=void 0,k instanceof Error?(E=k.stack,_=k.message):"string"==typeof k?_=k:"object"==typeof k&&(_=null==k?void 0:k.toString()),Object(a.a)({debugInfo:E,errorType:"LaunchApp_Error",eventName:m,message:_}),E&&(j={DebugInfo:E,Message:null!=_?_:""},Object(c.a)({eventName:m,params:j}),Object(i.a)(m,j,[])),[3,16];case 15:return j={Success:n.success,Message:null!==(I=n.message)&&void 0!==I?I:"",AppLaunchResult:null!==(N=n.result)&&void 0!==N?N:""},Object(u.a)({eventName:m,featureName:"LauncherService",params:j}),[7];case 16:return[2,n]}}))}))}},a5Wk:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n("xwQ8"),o=n("rt0l"),i=n("x3xY"),s=n("U4aE"),a=n("mXGw"),c=n.n(a),u=n("l/ot"),l=n("QjXU"),d=n("p/uK"),h=n("DU/N"),f=n("sLnE"),p="20px",m=Object(d.a)({button:Object(l.__assign)(Object(l.__assign)({backgroundColor:h.a.colorTransparentBackground,maxHeight:"32px"},f.a.borderRadius(h.a.borderRadiusMedium)),{marginRight:"4px",":focus-visible":{outlineWidth:"2px",outlineStyle:"solid",outlineColor:h.a.colorStrokeFocus2,outlineOffset:"0px"}}),icon:{height:p,maxHeight:p,width:p,maxWidth:p}}),g=function(e){var t=e.ariaLabel,n=e.icon,l=earance,p=e.size,g=e.name,v=e.buttonType,b=e.registerTuiElement,y=Object(a.useRef)(null);Object(a.useEffect)((function(){b&&b("ActionsMenu_Tagging",y.current)}),[b]);var w=m();if(!n&&!l&&!t)return null;var C=function(e){e.stopPropagation(),e.preventDefault(),h&&!d&&h()},O=c.a.createElement(u.a,{icon:n,className:w.icon,isDisabled:d}),T=c.a.createElement(r.a,null,"MenuButton"===v?c.a.createElement(o.a,{"aria-label":t,appearance:null!=f?f:"transparent",className:w.button,icon:O,onClick:C,size:null!=p?p:"small",ref:y},g||""):c.a.createElement(i.a,{"aria-label":t,appearance:null!=f?f:"transparent",className:w.button,icon:O,onClick:C,size:null!=p?p:"small",ref:y}));return l?c.a.createElement(s.a,{content:l,relationship:"description"},T):T}},a9wj:function(e,t,n){"use strict";n.d(t,"b",(function(){return vt})),n.d(t,"a",(function(){return bt})),n.d(t,"c",(function(){return yt})),n.d(t,"e",(function(){return wt})),n.d(t,"d",(function(){return Ct}));var r=n("kxAM"),o=n("5+n6"),i=n("Ito+"),s=n("aFvx"),a=n("graM"),c=n("TVWn"),u=n("+DV+"),l=n("nCVa"),d=n("Hebw");function h(e){const t=new URL(e.siteUrl);let n=`s=${encodeURIComponent(t.pathname)}&d=${encodeURIComponent(e.driveId)}&f=${encodeURIComponent(e.itemId)}&c=${encodeURIComponent(e.dataStorePath)}&fluid=1`;return e.appName&&(n+=`&a=${encodeURIComponent(e.appName)}`),e.containerPackageName&&(n+=`&p=${encodeURIComponent(e.containerPackageName)}`),e.fileVersion&&(n+=`&v=${encodeURIComponent(e.fileVersion)}`),e.context&&(n+=`&x=${encodeURIComponent(e.context)}`),Object(l.b)(n)}const f="nav";function p(e,t){const n=h(t);e.searchParams.set(f,n)}function m(e){const t=e.searchParams.get(f);if(t)return function(e,t){var n,r,o,i;const s=new URLSearchParams(Object(l.a)(e));if("1"!==s.get("fluid"))return;const a=s.get("s"),c=s.get("d"),u=s.get("f"),d=s.get("c"),h=null!==(n=s.get("a"))&&void 0!==n?n:void 0,f=null!==(r=s.get("p"))&&void 0!==r?r:void 0,p=null!==(o=s.get("v"))&&void 0!==o?o:void 0,m=null!==(i=s.get("x"))&&void 0!==i?i:void 0;if(!a||!c||!u||null===d)return;let g;try{g=new URL(a,t)}catch(e){}return g?{siteUrl:g.href,driveId:c,itemId:u,dataStorePath:d,appName:h,containerPackageName:f,fileVersion:p,context:m}:void 0}(t,e.origin.toLowerCase()===d.b?d.a:e.origin)}var g,v;function b(e){let t=`${e.siteUrl}?driveId=${encodeURIComponent(e.driveId)}&itemId=${encodeURIComponent(e.itemId)}&path=${encodeURIComponent(e.dataStorePath)}`;return e.containerPackageName&&(t+=`&containerPackageName=${encodeURIComponent(e.containerPackageName)}`),e.fileVersion&&(t+=`&fileVersion=${encodeURIComponent(e.fileVersion)}`),t}!function(e){e.isSharingLinkToRedeem="isSharingLinkToRedeem"}(g||(g={})),function(e){e.isClpCompliantApp="X-CLP-Compliant-App"}(v||(v={}));var y,w=n("he5V");!function(e){e.summarizingClient="fluid-client-summarizer",e.createNew="createNew"}(y||(y={}));var C,O,T,S=n("B8wW");!function(e){e.csl="csl"}(C||(C={})),function(e){e.organization="organization",e.users="users",e.anonymous="anonymous",e.default="default"}(O||(O={})),function(e){e.view="view",e.edit="edit"}(T||(T={}));var k=n("A3AF");function E(e,t){const n={message:"string"==typeof(null==e?void 0:e.message)?e.message:String(e)};if((e=>null!==e&&!Array.isArray(e)&&"object"==typeof e)(e)){const{errorType:r,stack:o,name:i}=e;"string"==typeof r&&(n.errorType=r),"string"==typeof o&&(n.stack=((e,n)=>{if(!t)return e;const r=e.split("\n");return r.shift(),void 0!==n&&r.unshift(n),r.join("\n")})(o,"string"==typeof i?i:void 0))}return n}const _=e=>"function"==typeof(null==e?void 0:e.getTelemetryProperties);let j;function I(e,t){const{message:n,stack:r}=E(e,!1),o=t(n);return void 0!==r&&function(e,t){try{Object.assign(e,{stack:t})}catch(n){e.addTelemetryProperties({stack2:t})}}(o,r),function(e){return x.typeCheck(e)?e.errorType===D&&1===e.getTelemetryProperties().untrustedOrigin:!function(e){return"string"==typeof(null==e?void 0:e.errorType)&&"string"==typeof(null==e?void 0:e.message)&&(e=>"function"==typeof(null==e?void 0:e.getTelemetryProperties)&&"function"==typeof(null==e?void 0:e.addTelemetryProperties))(e)}(e)}(e)&&o.addTelemetryProperties({untrustedOrigin:1}),(e=>"string"==typeof(null==e?void 0:e.errorInstanceId))(e)&&(o.overwriteErrorInstanceId(e.errorInstanceId),o.addTelemetryProperties({innerErrorInstanceId:e.errorInstanceId})),_(e)&&o.addTelemetryProperties(e.getTelemetryProperties()),o}function N(e){var t;return"string"==typeof(null===(t=e)||void 0===t?void 0:t.tag)}function A(e,t){return Array.isArray(e)&&e.every((e=>P(e)))?JSON.stringify(e):P(e)?e:(console.error(`UnSupported Format of Logging Error Property for key ${t}:`,e),"REDACTED (arbitrary object)")}function P(e){switch(typeof e){case"string":case"number":case"boolean":case"undefined":return!0;default:return!1}}class x extends Error{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;super(e),this.omitPropsFromLogging=n,this._errorInstanceId=Object(k.a)(),this.fluidErrorCode="-",n.add("omitPropsFromLogging"),n.add("_errorInstanceId"),t&&this.addTelemetryProperties(t)}get errorInstanceId(){return this._errorInstanceId}overwriteErrorInstanceId(e){this._errorInstanceId=e}static typeCheck(e){return"object"==typeof e&&null!==e&&"function"==typeof e.addTelemetryProperties&&"function"==typeof e.getTelemetryProperties&&"string"==typeof e.errorInstanceId}addTelemetryProperties(e){!function(e,t){for(const n of Object.keys(t))void 0===e[n]&&(e[n]=t[n])}(this,e)}getTelemetryProperties(){const e=function(e,t){const n={};for(const r of Object.keys(e)){if(t.has(r))continue;const o=e[r];n[r]=N(o)?{value:A(o.value,r),tag:o.tag}:A(o,r)}return n}(this,this.omitPropsFromLogging);return Object.assign(Object.assign({},e),{stack:this.stack,message:this.message,errorInstanceId:this._errorInstanceId})}}const D="genericError";var L;!function(e){e[e.Offline=0]="Offline",e[e.Online=1]="Online",e[e.Unknown=2]="Unknown"}(L||(L={}));class M extends x{constructor(e,t){super(e,Object.assign(Object.assign({},t),{statusCode:400})),this.errorType=M.errorType,this.canRetry=!1}}M.errorType=S.a.deltaStreamConnectionForbidden;class R extends x{constructor(e,t,n,r){super(e,r),this.errorType=t,this.canRetry=n}}class F extends R{constructor(e,t,n){super(e,t,!1,n),this.errorType=t}}class B extends R{constructor(e,t,n){super(e,t,!0,n),this.errorType=t}}const U=e=>!0===(null==e?void 0:e.canRetry),W=e=>void 0!==(null==e?void 0:e.retryAfterSeconds)?1e3*e.retryAfterSeconds:void 0;var q=n("rK/e"),H=n("O9x+");new H.a((()=>G(Q())));const z={getRawConfig:()=>{}},G=e=>null!=e?new J(void 0,{getRawConfig:t=>{var n,r;try{return null===(r=$(null!==(n=e.getItem(t))&&void 0!==n?n:void 0))||void 0===r?void 0:r.raw}catch(e){}}}):z;function V(e){switch(e){case"boolean":case"number":case"string":return!0;default:return!1}}function $(e){let t,n=e;if("string"==typeof e)try{n=JSON.parse(e),t={raw:e,string:e}}catch(e){}if(void 0===n)return t;const r=typeof n;if(V(r))return Object.assign(Object.assign({},t),{raw:e,[r]:n});if(Array.isArray(n)){const r=typeof n[0];if(!V(r))return t;for(const e of n)if(typeof e!==r)return t;return Object.assign(Object.assign({},t),{raw:e,[`${r}[]`]:n})}return t}const Q=()=>{var e;try{return null!==(e=globalThis.sessionStorage)&&void 0!==e?e:void 0}catch(e){return}};class J{constructor(e){this.logger=e,this.configCache=new Map,this.orderedBaseProviders=[];const t=new Set;for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];const i=[...r];for(;i.length>0;){const e=i.shift();void 0!==e&&K(e)&&!t.has(e)&&(t.add(e),e instanceof J?i.push(...e.orderedBaseProviders):this.orderedBaseProviders.push(e))}}getBoolean(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.boolean}getNumber(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.number}getString(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.string}getBooleanArray(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t["boolean[]"]}getNumberArray(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t["number[]"]}getStringArray(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t["string[]"]}getRawConfig(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.raw}getCacheEntry(e){var t;if(!this.configCache.has(e)){for(const n of this.orderedBaseProviders){const r=$(null==n?void 0:n.getRawConfig(e));if(void 0!==r)return this.configCache.set(e,r),null===(t=this.logger)||void 0===t||t.send({category:"generic",eventName:"ConfigRead",configName:{tag:Y.CodeArtifact,value:e},configValue:{tag:Y.CodeArtifact,value:JSON.stringify(r)}}),r}this.configCache.set(e,{raw:void 0})}return this.configCache.get(e)}}function X(e){const t=e;return K(null==t?void 0:t.config)&&void 0!==(null==t?void 0:t.logger)}function K(e){return"function"==typeof(null==e?void 0:e.getRawConfig)}var Y,Z;!function(e){e.CodeArtifact="CodeArtifact",e.UserData="UserData"}(Y||(Y={}));class ee{constructor(e,t){this.namespace=e,this.properties=t}static formatTick(e){return Math.floor(e)}static numberFromString(e){if(null==e)return;const t=Number(e);return Number.isNaN(t)?e:t}static sanitizePkgName(e){return e.replace("@","").replace("/","-")}static prepareErrorObject(e,t,n){const{message:r,errorType:o,stack:i}=E(t,!0);if(e.stack=i,e.error=r,e.errorType=o,_(t)){const n=t.getTelemetryProperties();for(const t of Object.keys(n))void 0===e[t]&&(e[t]=n[t])}void 0===e.stack&&n&&(e.stack=function(){return function(){const e=new Error("<<generated stack>>");if(void 0===j&&(j=void 0!==e.stack),j)return e;try{throw e}catch(e){return e}}().stack}())}sendTelemetryEvent(e,t){var n;this.sendTelemetryEventCore(Object.assign(Object.assign({},e),{category:null!==(n=e.category)&&void 0!==n?n:"generic"}),t)}sendTelemetryEventCore(e,t){const n=function(e){var{category:t,eventName:n}=e,r=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(e,["category","eventName"]);const o={category:t,eventName:n};for(const e of Object.keys(r))o[e]=oe(r[e]);return o}(e);void 0!==t&&ee.prepareErrorObject(n,t,!1),"number"==typeof n.duration&&(n.duration=ee.formatTick(n.duration)),this.send(n)}sendErrorEvent(e,t){this.sendTelemetryEventCore(Object.assign(Object.assign({error:e.eventName},e),{category:"error"}),t)}sendPerformanceEvent(e,t){var n;const r=Object.assign(Object.assign({},e),{category:null!==(n=e.category)&&void 0!==n?n:"performance"});this.sendTelemetryEventCore(r,t)}prepareEvent(e){const t="error"===e.category||void 0!==e.error,n=Object.assign({},e);if(void 0!==this.namespace&&(n.eventName=`${this.namespace}${ee.eventNamespaceSeparator}${n.eventName}`),this.properties){const r=[];r.push(this.properties.all),t&&r.push(this.properties.error);for(const t of r)if(void 0!==t)for(const r of Object.keys(t)){if(void 0!==e[r])continue;const o=t[r],i="function"==typeof o?o():o;void 0!==i&&(n[r]=i)}}return n}}ee.eventNamespaceSeparator=":";class te extends ee{constructor(e,t,n){super(t,n),this.baseLogger=e,X(e)&&function(e){if(X(e))throw new Error("Logger is already a monitoring context");const t=e;for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];t.config=new J(e,...r),t.logger=e}(this,new J(this,e.config))}static create(e,t,n){if(e instanceof te){const r={};for(const t of[e.properties,n])void 0!==t&&(void 0!==t.all&&(r.all=Object.assign(Object.assign({},r.all),t.all)),void 0!==t.error&&(r.error=Object.assign(Object.assign({},r.error),t.errort:void 0===t?e.namespace:`${e.namespace}${ee.eventNamespaceSeparator}${t}`,r)}return new te(e||new re,t,n)}send(e){this.baseLogger.send(this.prepareEvent(e))}}class ne{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{end:!0,cancel:"generic"};var r;this.logger=e,this.markers=n,this.startTime=q.a.now(),this.event=Object.assign({},t),this.markers.start&&this.reportEvent("start"),"object"==typeof wiormance)||void 0===r?void 0:r.mark)&&(this.startMark=`${t.eventName}-start`,window.performance.mark(this.startMark))}static start(e,t,n){return new ne(e,t,n)}static timedExec(e,t,n,r){const o=ne.start(e,t,r);try{const e=n(o);return o.autoEnd(),e}catch(e){throw o.can,n,r){const o=ne.start(e,t,r);try{const e=await n(o);return o.autoEnd(),e}catch(e){throw o.cancel(void 0,e),e}}get duration(){return q.a.now()-this.startTime}reportProgress(e){this.reportEvent(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"update",e)}autoEnd(){this.event&&this.markers.end&&this.reportEvent("end"),this.performanceEndMark(),this.event=void 0}end(e){this.reportEvent("end",e),this.performanceEndMark(),this.event=void 0}performanceEndMark(){if(this.startMark&&this.event){const e=`${this.event.eventName}-end`;window.performance.mark(e),window.performance.measure(`${this.event.eventName}`,this.startMark,e),this.startMark=void 0}}cancel(e,t){void 0!==this.markers.cancel&&this.reportEvent("cancel",Object.assign({category:this.markers.cancel},e),t),this.event=void 0}reportEvent(e,t,n){if(!this.event)return;const r=.assign({},this.event),t);r.eventName=`${r.eventName}_${e}`,"start"!==e&&(r.duration=this.duration),this.logger.sendPerformanceEvent(r,n)}}class re{send(e){}}function oe(e){return N(e)?{value:ie(e.value),tag:e.tag}:ie(e)}function ie(e){switch(typeof e){case"string":case"number":case"boolean":case"undefined":return e;case"object":return JSON.strinctionForbidden",e.locationRedirection="locationRedirection",e.fluidInvalidSchema="fluidInvalidSchema",e.usageError="usageError",e.fileIsLocked="fileIsLocked"}(Z||(Z={})),new H.a((()=>ae(le())));const se={getRawConfig:()=>{}},ae=e=>null!=e?new de(void 0,{getRawConfig:t=>{var n,r;try{return null===(r=ue(null!==(n=e.getItem(t))&&void 0!==n?n:void 0))||void 0===r?void 0:r.raw}catch(e){}}}):se;function ce(e){switch(e){case"boolean":case"number":case"string":return!0;default:return!1}}function ue(e){let t,n=e;if("string"==typeof e)try{n=JSON.parse(e),t={raw:e,string:e}}catch(e){}if(void 0===n)return t;const r=typeof n;if(ce(r))return Object.assign(Object.assign({},t),{raw:e,[r]:n});if(Array.isArray(n)){const r=typeof n[0];if(!ce(r))return t;for(const e of n)if(typeof e!==r)return t;return Object.assign(Object.assign({},t),{raw:e,[`${r}[]`]:n})}return t}const le=()=>{var e;try{return null!==(e=globalThis.sessionStorage)&&void 0!==e?e:void 0}catch(e){return}};class de{constructor(e){this.logger=e,this.configCache=new Map,this.orderedBaseProviders=[];const t=new Set;for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];const i=[...r];for(;i.length>0;){const e=i.shift();void 0!==e&&he(e)&&!t.has(e)&&(t.add(e),e instanceof de?i.push(...e.orderedBaseProviders):this.orderedBaseProviders.push(e))}}getBoolean(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.boolean}getNumber(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.number}getString(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.string}getBooleanArray(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t["boolean[]"]}getNumberArray(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t["number[]"]}getStringArray(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t["string[]"]}getRawConfig(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.raw}getCacheEntry(e){var t;if(!this.configCache.has(e)){for(const n of this.orderedBaseProviders){const r=ue(null==n?void 0:n.getRawConfig(e));if(void 0!==r)return this.configCache.set(e,r),null===(t=this.logger)||void 0===t||t.send({category:"generic",eventName:"ConfigRead",configName:{tag:be.CodeArtifact,value:e},configValue:{tag:be.CodeArtifact,value:JSON.stringify(r)}}),r}this.configCache.set(e,{raw:void 0})}return this.configCache.get(e)}}function he(e){return"function"==typeof(null==e?void 0:e.getRawConfig)}let fe;function pe(e){var t;return"string"==typeof(null===(t=e)||void 0===t?void 0:t.tag)}function me(e,t){return Array.isArray(e)&&e.every((e=>ge(e)))?JSON.stringify(e):ge(e)?e:(console.error(`UnSupported Format of Logging Error Property for key ${t}:`,e),"REDACTED (arbitrary object)")}function ge(e){switch(typeof e){case"string":case"number":case"boolean":case"undefined":return!0;default:return!1}}class ve extends Error{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;super(e),this.omitPropsFromLogging=n,this._errorInstanceId=Object(k.a)(),this.fluidErrorCode="-",n.add("omitPropsFromLogging"),n.add("_errorInstanceId"),t&&this.addTelemetryProperties(t)}get errorInstanceId(){return this._errorInstanceId}overwriteErrorInstanceId(e){this._errorInstanceId=e}static typeCheck(e){return"object"==typeof e&&null!==e&&"function"==typeof e.addTelemetryProperties&&"function"==typeof e.getTelemetryProperties&&"string"==typeof e.errorInstanceId}addTelemetryProperties(e){!function(e,t){for(const n of Object.keys(t))void 0===e[n]&&(e[n]=t[n])}(this,e)}getTelemetryProperties(){const e=function(e,t){const n={};for(const r of Object.keys(e)){if(t.has(r))continue;const o=e[r];n[r]=pe(o)?{value:me(o.value,r),tag:o.tag}:me(o,r)}return n}(this,this.omitPropsFromLogging);return Object.assign(Object.assign({},e),{stack:this.stack,messd})}}var be,ye,we;!function(e){e.CodeArtifact="CodeArtifact",e.UserData="UserData"}(be||(be={}));class Ce{constructor(e,t){this.namstatic numberFromString(e){if(null==e)return;const t=Number(e);return Number.isNaN(t)?e:t}static sanitizePkgName(e){return e.replace("@","").replace("/","-")}static prepareErrorObject(e,t,n){const{message:r,errorType:o,stack:i}=function(e,t){const n={message:"string"==typeof(null==e?void 0:e.message)?e.message:String(e)};if((e=>null!==e&&!Array.isArray(e)&&"object"==typeof e)(e)){const{errorType:t,stack:r,name:o}=e;"string"==typeof t&&(n.errorType=t),"string"==typeof r&&(n.stack=((e,t)=>{const n=e.split("\n");return n.shift(),void 0!==t&&n.unshift(t),n.join("\n")})(r,"string"==typeof o?o:void 0))}return n}(t);if(e.stack=i,e.error=r,e.errorType=o,(e=>"function"==typeof(null==e?void 0:e.getTelemetryProperties))(t)){const n=t.getTelemetryProperties();for(const t of Object.keys(n))void 0===e[t]&&(e[t]=n[t])}void 0===e.stack&&n&&(e.stack=function(){return function(){const e=new Error("<<generated stack>>");if(void 0===fe&&(fe=void 0!==e.stack),fe)return e;try{throw e}catch(e){return e}}().stack}())}sendTelemetryEvent(e,t){var n;this.sendTelemetryEventCore(Object.assign(Obar o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(e,["category","eventName"]);const o={category:t,eventName:n};for(const e of Object.keys(r))o[e]=Oe(r[e]);return o}(e);void 0!==t&&Ce.prepareErrorObject(n,t,!1),"number"==typeof n.duration&&(n.duration=Ce.formatTick(n.duration)),this.send(n)}sendErrorEvent(e,t){this.sendTelemetryEventCore(Object.assign(Object.assign({error:e.eventName},e),{category:"error"}),t)}sendPerformanceEvent(e,t){var n;const r=Object.assign(Object.assign({},e),{category:null!==(n=e.category)&&void 0!==n?n:"performance"});this.sendTelemetryEventCore(r,t)}prepareEvent(e){const t="error"===e.category||void 0!==e.error,n=Object.assign({},e);if(void 0!==this.namespace&&(n.eventName=`${this.namespace}${Ce.eventNamespaceSeparator}${n.eventName}`),this.properties){const r=[];r.push(this.properties.all),t&&r.push(this.properties.error);for(const t of r)if(void 0!==t)for(const r of Object.keys(t)){if(void 0!==e[r])continue;const o=t[r],i="function"==typeof o?o():o;void 0!==i&&(n[r]=i)}}return n}}function Oe(e){return pe(e)?{value:Te(e.value),tag:e.tag}:Te(e)}function Te(e){switch(typeof e){case"string":case"number":case"boolean":case"undefined":return e;case"object":return JSON.stringify(e);default:return console.error(`convertToBasePropertyTypeUntagged: INVALID PROPERTY (typed as ${typeof e})`),`INVALID PROPERTY (typed as ${typeof e})`}}function Se(){return"object"==typeof navigator&&null!==navigator&&"boolean"==typeof navigator.onLine?navigator.onLine?ye.Online:ye.Offline:yeine=1]="Online",e[e.Unknown=2]="Unknown"}(ye||(ye={}));class ke extends ve{constructor(e,t,n){super(e,n),this.canRetry=t,this.errorType=Z.genericNetworkError}}class Ee extends ve{constructor(e,t){super(e,t),this.errorType=Z.fluidInvalidSchema,this.canRetry=!1}}class _e extends ve{constructor(e,t){super(e,Object.assign(Object.assign({},t),{statusCode:400})),this.errorType=_e.errorType,this.canRetry=!1}}_e.errorType=Z.deltaStreamConnectionForbidden;class je extends ve{construc=t,this.tenantId=n,this.errorType=Z.authorizationError,this.canRetry=!1}}class Ie extends ve{constructor(e,t,n,r){super(e,r),this.errorType=t,this.canRetry=n}}class Ne extends Ie{constructor(e,t,n){super(e,t,!1,n),this.errorType=t}}class Ae extends Ie{constructor(e,t,n){super(e,t,!0,n),this.errorType=t}}class Pe extends ve{constructor(e,t,n){super(e,n),this.retryAfterSeconds=t,this.errorType=Z.throttlingError,this.canRetry=!0}}function xe(e,t,n){return void 0!==t.retryAfterMs&&t.canRetry?new Pe(e,t.retryAfterMs/1e3,n):new ke(e,t.canRetry,n)}function De(e){const t=e.get("www-authenticate");if(!t)return;let n,r=!1;return t.split(",").map((e=>{const t=e.split("=");t.length>=2&&(r||"error"!==t[0].trim().toLowerCase()?n||"claims"!==t[0].trim().toLowerCase()||(n=Object(l.a)(JSON.parse(e.substring(e.indexOf("=")+1).trim()))):r="insufficient_claims"===JSON.parse(t[1].trim().toLowerCase()))})),r?n:void 0}!function(e){e.outOfStorageError="outOfStorageError",e.invalidFileNameError="invalidFileNameError",e.snapshotTooBig="snapshotTooBig",e.fetchTimeout="fetchTimeout",e.fluidNotEnabled="fluidNotEnabled",e.fetchTokenError="fetchTokenError",e.cannotCatchUp="cannotCatchUp",e.serviceReadOnly="serviceReadOnly"}(we||(we={}));const Le="Bearer";function Me(e){const t=e.get("www-authenticate");if(!t)return;const n=t.indexOf(Le);if(n<0)return;let r;return t.substring(n+Le.length).split(",").map((e=>{if(!r){const t=e.split("=");t.length>=2&&"realm"===t[0].trim().toLowerCase()&&(r=JSON.parse(t[1].trim()))}})),r}const Re="2.0.0-internal.4.1.0",Fe="serviceReadOnly";function Be(e){const t={sprequestduration:Ce.numberFromString(e.get("sprequestduration")),contentsize:Ce.numberFromString(e.get("content-length"))};[{headerName:"sprequestguid",logName:"sprequestguid"},{headerName:"request-id",logName:"requestId"},{headerName:"client-request-id",logName:"clientRequestId"},{headerName:"x-msedge-ref",logName:"xMsedgeRef"},{headerName:"X-Fluid-Retries",logName:"serverRetries"},{headerName:"content-encoding",logName:"contentEncoding"},{headerName:"content-type",logName:"contentType"}].forE=e.get(n.headerName);null!=r&&(t[n.logName]=r)}));const n=e.get("x-fluid-telemetry");if(null!=n){t.xFluidTelemetry=n;const e=n.split(",").map((e=>e.split("=")));for(const[n,r]of e)if("Origin"===n.trim()){let e;switch(null==r?void 0:r.trim()){case"c":e="cache";break;case"g":e="graph";break;default:e=null==r?void 0:r.trim()}t.responseOrigin=e;break}}return t}class Ue extends ve{constructor(e,t,n){super(e,n,new Set(["redirectLocation"])),this.redirectLocation=t,this.errorType=Z.fileNotFoundOrAccessDeniedError,this.canRetry=!1}}function We(e){try{if(void 0!==e){const t=JSON.parse(e);if(function(e){const t=null==e?void 0:e.error;return"string"==typeof(null==t?void 0:t.message)&&(void 0===(null==t?void 0:t.code)||"string"==typeof(null==t?void 0:t.code))}(t))return{success:!0,errorResponse:t}}}catch(e){}return{success:!1}}function qe(e){const t=[];let n=e.error;for(;"object"==typeof n&&null!==n;)void 0!==n.code&&t.unshift(n.code),n=n.innerError;return t}function He(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var o;if(e.online=ye[Se()],void 0!==n&&(e.facetCodes=n),t&&(r.responseType=t.type,t.headers)){const n=Be(t.headers);for(const e of Object.keys(n))r[e]=n[e];e.serverEpoch=null!==(o=t.headers.get("x-fluid-epoch"))&&void 0!==o?o:void 0}return e.addTelemetryProperties(r),e}var ze=n("Ndaf");const Ge=e=>null===e||"string"==typeof e?e:void 0===e?null:e.token,Ve=e=>null===e||"string"==typeof e?void 0:e.fromCache;var $e=n("2rXV"),Qe=n.n($e);const Je="2.0.0-internal.4.1.0";async function Xe(e){return e({refresh:!1}).catch((async t=>{const n={refresh:!0,previousError:t};switch(t.errorType){case S.a.authorizationError:return e(Object.assign(Object.assign({},n),{claims:t.claims,tenantId:t.tenantId}));case S.a.incorrectServerResponse:cas:return e(n);default:if(!0===t.getWithRetryForTokenRefreshRepeat)return e(n);throw t}}))}async function Ke(e,t){const n=q.a.now();return(async(e,t)=>Qe()(e,t))(e,t).then((async e=>{const t=e;if(!t)throw new F("No response from ODSP fetch call",S.a.incorrectServerResponse,{driverVersion:Je});(!t.ok||t.status<200||t.status>=300)&&function(e,t,n,r,o){const i=function(e,t,n,r,o){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};var s;let a;const c=We(o);let u,l,d;if(c.success){const e=c.errorResponse;i.responseMessage=e.error.message,u=qe(e),void 0!==u&&(l=u[0],i.innerMostErrorCode=l)}const h=Object.assign({driverVersion:Re,statusCode:t},i);switch(t){case 400:if("fluidInvalidSchema"===l){a=new Ee(e,h);break}a=new Ne(e,Z.genericNetworkError,h);break;case 401:case 403:if(l===Fe)a=new Ae(e,we.serviceReadOnly,h);else{const t=(null==r?void 0:r.headers)?De(r.headers):void 0,n=(null==r?void 0:r.headers)?Me(r.headers):void 0;a=new je(e,t,n,h)}break;case 404:if(c.success){const t=null===(s=null==c?void 0:c.errorResponse)||void 0===s?void 0:s.error;if(d=null==t?void 0:t["@error.redirectLocation"],void 0!==d){a=new Ue(e,d,h);break}}a=new Ne(e,Z.fileNotFoundOrAccessDeniedError,h);break;case 406:a=new Ne(e,Z.unsupportedClientProtocolVersion,h);break;case 410:a=new Ne(e,we.cannotCatchUp,h);break;case 409:a=new Ne(e,Z.fileOverwrittenInStorage,h);break;case 412:a=new Ne(e,Z.genericNetworkError,h);break;case 413:a=new Ne(e,we.snapshotTooBig,h);break;case 414:a=new Ne(e,we.invalidFileNameError,h);break;case 423:if("resourceLocked"===l){a=new Ne(e,Z.fileIsLocked,h);break}case 500:a=new Ae(e,Z.genericNetworkError,h);break;case 501:a=new Ne(e,we.fluidNotEnabled,h);break;case 507:a=new Ne(e,we.outOfStorageError,h);break;case 712:a=new Ne(e,Z.incorrectServerResponse,h);break;default:a=xe(e,{canRetry:!0,retryAfterMs:void 0!==n?1e3*n:void 0},h)}return He(a,r,u,void 0),a}(e,t,function(e){if(null===e)return;const t=Number(e);return Number.isNaN(t)?void 0:t}(n.headers.get("retry-after")),n,r,void 0);throw i.addTelemetryProperties({odspError:!0,storageServiceError:!0}),i}(`ODSP fetch error [${t.status}]`,t.status,t,await t.text());const r=function(e){const t=new Map;for(const[n,r]of e.entries())t.set(n,r);return t}(t.headers);return{content:t,headers:r,propsToLog:Be(r),duration:q.a.now()-n}}),(e=>{const t=function(){return"object"==typeof navigator&&null!==navigator&&"boolean"==typeof navigator.onLine?navigator.onLine?L.Online:L.Offline:L.Unknown}(),n=`${e}`,r=n.replace(/((http|https):\/\/(\S*))/i,"REDACTED_URL");if("AbortError"===e.name)throw new B("Fetch Timeout (AbortError)",ze.a.fetchTimeout,{driverVersion:Je});if(n.includes("ETIMEDOUT"))throw new B("Fetch Timeout (ETIMEDOUT)",ze.a.fetchTimeout,{driverVersion:Je});throw t===L.Offline?new B(`ODSP fetch failure (Offline): ${r}`,S.a.offlineError,{driverVersion:Je,rawErrorMessage:{value:n,tag:Y.UserData}}):new B(`ODSP fetch failure: ${r}`,S.a.fetchFailure,{driverVersion:Je,rawErrorMessage:{value:n,tag:Y.UserData}})}))}function Ye(e){return Object(w.a)(!0===e.odspResolvedUrl,478),e}function Ze(e,t,n,r){return async function(o,i){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return ne.timedExecAsync(e,{eventName:`${i}_GetToken`,attempts:o.refresh?2:1,hasClaims:!!o.claims,hasTenantId:!!o.tenantId},(async e=>n(Object.assign(Object.assign({},o),t)).then((t=>{const n=Ge(t);if((s||e.duration>=32)&&e.end({fromCache:Ve(t),isNull:null===n}),null===n&&r)throw new F("The Host-provided token fetcher returned null",ze.a.fetchTokenError,{method:i,driverVersion:Je});return n}),(e=>{const t=null==e?void 0:e.canRetry;throw I(e,(e=>new R("The Host-provided token fetcher threw an error",ze.a.fetchTokenError,"boolean"==typeof t&&t,{method:i,errorMessage:e,driverVerspi/";return function(e){return e.includes("onedrive.com")||e.includes("storage.live.com")||e.includes("storage.live-int.com")||e.includes("onedrive-tst.com")}(e)&&(t=""),`${e}/${t}v2.1`}(new URL(e).origin)}/drives/${t}/items/${n}/${o}`}function rt(e,t,n,r){return`${nt(e,t,n,r)}opStream/snapshots`}function ot(e,t,n,r){return`${nt(e,t,n,r)}opStream/attachment`}function it(e,t,n,r){return`${nt(e,t,n,r)}opStream/attachments`}function st(e,t,n,r){return`${nt(e,t,n,r)}opStream`}class at{constructor(){}async resolve(e){var t,n,r,o;if(null===(t=e.headers)||void 0===t?void 0:t[y.createNew]){const[t,r]=e.url.split("?"),o=new URLSearchParams(r),i=e.headers[y.createNew].fileName,s=o.get("driveId"),a=o.get("path"),c=o.get("containerPackageName"),u=o.get("createLinkType");if(!(i&&t&&s&&null!=a))throw new F("Proper new file params should be there!!",S.a.genericError,{driverVersion:Je});let l;return u&&u in C&&(l={createLink:{type:C[u]}}),{endpoints:{snapshotStorageUrl:"",attachmentGETStorageUrl:"",attachmentPOSTStorageUrl:"",deltaStorageUrl:""},tokens:{},type:"fluid",odspResolvedUrl:!0,id:"odspCreateNew",url:`fluid-odsp://${t}?${r}&version=null`,siteUrl:t,hashedDocumentId:"",driveId:s,itemId:"",fileName:i,summarizer:!1,codeHint:{containerPackageName:null!=c?c:void 0},fileVersion:void 0,shareLinkInfo:l,isClpCompliantApp:null===(n=e.headers)||void 0===n?void 0:n[v.isClpCompliantApp]}}const{siteUrl:i,driveId:s,itemId:a,path:c,containerPackageName:u,fileVersion:l}=function(e){const[t,n]=e.split("?"),r=new URLSearchParams(n),o=r.get("driveId"),i=r.get("itemId"),s=r.get("path"),a=r.get("containerPackageName"),c=r.get("fileVersion");if(null===o)throw new Error("ODSP URL did not contain a drive id");if(null===i)throw new Error("ODSP Url did not contain an item id");if(null===s)throw new Error("ODSP Url did not contain a path");return{siteUrl:t,driveId:decodeURIComponent(o),itemId:decodeURIComponent(i),path:decodeURIComponent(s),containerPackageName:a?decodeURIComponent(a):void 0,fileVersion:c?decodeURIComponent(c):void 0}}(e.url),d=await async function(e,t){const n=et.a.from(`${e}_${t}`);return encodeURIComponent(await Object(tt.b)(n,"SHA-256","base64"))}(s,a);Object(w.a)(!d.includes("/"),168);const h=`fluid-odsp://placeholder/placeholder/${d}/${function(e){return e.startsWith("/")?e.substr(1):e}(c)}`,f=!!(null===(r=e.headers)||void 0===r?void 0:r[y.summarizingClient]);return{type:"fluid",odspResolvedUrl:!0,endpoints:{snapshotStorageUrl:rt(i,s,a,l),attachmentPOSTStorageUrl:ot(i,s,a,l),attachmentGETStorageUrl:it(i,s,a,l),deltaStorageUrl:st(i,s,a,l)},id:d,tokens:{},url:h,hashedDocumentId:d,siteUrl:i,driveId:s,itemId:a,dataStorePath:c,fileName:"",summarizer:f,codeHint:{containerPackageName:u},fileVersion:l,isClpCompliantApp:null===(o=e.headers)||void 0===o?void 0:o[v.isClpCompliantApp]}}async getAbsoluteUrl(e,t,n){var r,o,i,s;const a=Ye(e);let c,u=t;return""===t&&void 0!==a.dataStorePath&&(u=a.dataStorePath),u.startsWith("/")&&(u=u.substr(1)),c=n&&"name"in n?n.name:(e=>"object"==typeof e&&"string"==typeof(null==e?void 0:e.name)&&"object"==typeof(null==e?void 0:e.fluid))(null===(r=n)||void 0===r?void 0:r.package)?null===(o=n)||void 0===o?void 0:o.package.name:null===(i=n)||void 0===i?void 0:i.package,c=null!=c?c:null===(s=a.codeHint)||void 0===s?void 0:s.containerPackageName,b(Object.assign(Object.assign({},a),{containerPackageName:c,dataStorePath:u}))}}function ct(e,t,n){if(!t||0===t.length)return{url:e,headers:{}};if(!n){const n=new URL(e);if(n.searchParams.set("access_token",t),n.search.length<=2048)return{headers:{},url:n.href}}return{headers:{Authorization:`Bearer ${t}`},url:e}}var ut=n("gaGA");n("NsUA");const lt=new Map;class dt{constructor(e,t,n,r){this.appName=n,this.getContext=r,this.sharingLinkCache=new u.a,this.logger=(e=>te.create(e,"OdspDriver",{all:{driverVersion:Je}}))(t),e&&(this.shareLinkFetcherProps=Object.assign(Object.assign({},e),{tokenFetcher:e.tokenFetcher}))}appendDataStorePath(e,t){const n=mataStorePath,`${e.protocol}//${e.hostname}`);return t.startsWith("/?")||t.startsWith("?")?(new URLSearchParams(t).forEach(((e,t)=>{r.searchParams.append(t,e)})),th=`${r.pathname}${r.pathname.endsWith("/")||t.startsWith("/")?"":"/"}${t}/${r.search}`,p(e,n),e.href}getKey(e){return`${e.siteUrl},${e.driveId},${e.itemId}`}async resolve(e){var t,n;const r={headers:e.headers,url:e.url},o=null===(t=r.headers)||void 0===t?void 0:t[g.isSharingLinkToRedeem];try{const t=m(new URL(e.url));t&&(r.url=b(t))}catch(e){}const i=await(new at).resolve(r);return o&&(i.shareLinkInfo=Object.assign(null!==(n=i.shareLinkInfo)&&void 0!==n?n:{},{sharingLinkToRedeem:this.removeNavParam(e.url)})),i.itemId&&this.getShareLinkPromise(i).catch((()=>{})),i}removeNavParam(e){const t=new URL(e),n=new URLSearchParams(t.search);return n.delete(f),t.search=n.toString(),t.href}async getShareLinkPromise(e){if(void 0===this.shareLinkFetcherProps)throw new Error("Failed to get share link because share link fetcher props are missing");if(!(e.siteUrl&&e.driveId&&e.itemId))throw new Error("Failed to get share link because necessary information is missing (e.g. siteUrl, driveId or itemId)");const t=this.getKey(e),n=this.sharingLinkCache.get(t);if(n)return n;const r=async function(e,t,n){const r=`${t.siteUrl}_${t.driveId}_${t.itemId}`,o=lt.get(r);if(void 0!==o)return o;const i=async function(){let o;try{o=await async function(e,t,n,r){var o;let i=1e3;const s=q.a.now();let a;for(let r=1;;r++)try{const o=await e();return r>1&&n.sendTelemetryEvent({eventName:"MultipleRetries",callName:t,attempts:r,duration:q.a.now()-s},a),o}catch(e){const c=U(e),u=!0===(null==e?void 0:e.Odsp409Error),l=(null==e?void 0:e.errorType)===ze.a.serviceReadOnly;if(1===r&&n.sendTelemetryEvent({eventName:`${t}_firstFailed`,callName:t,attempts:r,duration:q.a.now()-s},e),!u&&!l||!c)throw e;if(5===r)throw n.sendErrorEvent({eventName:u?"CoherencyErrorTooManyRetries":"ServiceReadonlyErrorTooManyRetries",callName:t,attempts:r,duration:q.a.now()-s},e),e.canRetry=!1,e;i=null!==(o=W(e))&&void 0!==o?o:i,await Object(ut.a)(Math.floor(i)),i+=i/4*(1+Math.random()),a=e}}((async()=>async function(e,t,n){const r=await async function(e,t,n,r){return ne.timedExecAsync(n,{eventName:"odspFileLink",requestName:"getFileItemLite"},(async r=>{let o,i=0;const s=await Xe((async r=>{i++;const{siteUrl:s,driveId:a,itemId:c}=t,u=Ze(n,t,e,!0),l=await u(r,"GetFileItemLite");Object(w.a)(null!==l,700);const{url:d,headers:h}=ct(`${s}/_api/v2.0/drives/${a}/items/${c}?select=webUrl,webDavUrl,sharepointIds`,l,!0),f={method:"GET",headers:h},p=await Ke(d,f);o=p.propsToLog;const m=await p.content.json();if(!(e=>"string"==typeof e.webUrl&&"string"==typeof e.webDavUrl&&"object"==typeof e.sharepointIds)(m))throw new F("Malformed getFileItemLite response",S.a.incorrectServerResponse,{driverVersion:Je});return m}));return r.end(Object.assign(Object.assign({},o),{attempts:i})),s}))}(e,t,n);return ne.timedExecAsync(n,{eventName:"odspFileLink",requestName:"getSharingInformation"},(async o=>{let i,s=0;const a=await Xe((async o=>{var a;s++;const c=Ze(n,t,e,!0),u=await c(o,"GetFileLinkCore");Object(w.a)(null!==u,699);const{url:l,headers:d}=ct(`${t.siteUrl}/_api/web/GetFileById(@a1)/ListItemAllFields/GetSharingInformation?@a1=guid${encodeURIComponent(`'${r.sharepointIds.listItemUniqueId}'`)}`,u,!0),h={method:"POST",headers:Object.assign({"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose"},d)},f=await Ke(l,h);i=f.propsToLog;const p=await f.content.json(),m=null===(a=null==p?void 0:p.d)||void 0===a?void 0:a.directUrl;if("string"!=typeof m)throw new F("Malformed GetSharingInformation response",S.a.incorrectServerResponse,{driverVersion:Je});return m}));return o.end(Object.assign(Object.assign({},i),{attempts:s})),a}))}(e,t,n)),"getFileLinkCore",n)}catch(e){throw U(e)||lt.delete(r),e}return Object(w.a)(void 0!==o,658),o}();return lt.set(r,i),i}(this.shareLinkFetcherProps.tokenFetcher,e,this.logger).catch((e=>{throw this.logger.sendErrorEvent({eventName:"FluidFileUrlError"},e),this.sharingLinkCache.remove(t),e}));return this.sharingLinkCache.add(t,(async()=>r)),r}async getAbsoluteUrl(e,t,n){var r,o,i,s,a;const c=Ye(e),u=await this.getShareLinkPromise(c),l=new URL(u);let d,h=t;""===t&&void 0!==c.dataStorePath&&(h=c.dataStorePath),d=n&&"name"in n?n.name:(e=>"object"==typeof e&&"string"==typeof(null==e?void 0:e.name)&&"object"==typeof(null==e?void 0:e.fluid))(null===(r=n)||void 0===r?void 0:r.package)?null===(o=n)||void 0===o?void 0:o.package.name:null===(i=n)||void 0===i?void 0:i.package,d=null!=d?d:null===(s=c.codeHint)||void 0===s?void 0:s.containerPackageName;const f=await(null===(a=this.getContext)||void 0===a?void 0:a.call(this,c,h));return p(l,{siteUrl:c.siteUrl,driveId:c.driveId,itemId:c.itemId,dataStorePath:h,ame:d,fileVersion:c.fileVersion,context:f}),l.href}static createDocumentUrl(e,t){const n=new URL(e);return p(n,t),n.href}static createNavParam(e){return h(e)}}var ht=n("LpbE"),ft=n("OSNm");const pt=new Map;function mt(){return Object(o.a)("attributionUX.retryOn710",!1,o.b)}const gt={maxRetries:2,backoffFn:Object(s.b)(500),filter:Object(a.c)([408,409,429,503,710]),respectRetryAfterHeader:!0};function vt(e,t,n,o,s,a){const u=Object(r.a)(t),l=`${u}_${n}_${o}`;if(!pt.has(l)){const r=async()=>{var r,d;const h={getToken:r=>{const i={...r,siteUrl:t,driveId:n,itemId:o};return e.getToken([`${u}/files.readwrite.all`],i)},url:`${u}/_api/v2.0/drives/${n}/items/${o}?select=sharepointIds`,tenantId:a,requestInit:{method:"GET"},retryPolicy:mt()?gt:ht.b,tokenPolicy:Object(ht.a)(e)},f=s?Object(i.b)({...h,logger:s,nameForLogging:"GetFileSharepointIds",doNotLogOnSuccess:!0,getAdditionalProps:async(e,t)=>Object(c.a)(e)}):Object(i.a)(h);let p;try{p=(await f).result}catch(e){}if(null!==(r=p)&&void 0!==r&&r.ok){var m;let e;try{e=await p.json()}catch(e){s&&Object(ft.a)(s,{eventName:"GetFileSharepointIdsResponseParseError"},e)}if(null!==(m=e)&&void 0!==m&&m.sharepointIds)return e.sharepointIds;s&&Object(ft.a)(s,{eventName:"GetFileSharepointIdsUnexpectedResponse"},new Error("sharepointIds is missing from response body"))}404!==(null===(d=p)||void 0===d?void 0:d.status)&&pt.delete(l)};pt.set(l,r())}return pt.get(l).then()}async function bt(e,t,n,o,s,a){var u;const l=Object(r.a)(t),d={getToken:r=>{const i={...r,siteUrl:t,driveId:n,itemId:o};return e.getToken([`${l}/files.readwrite.all`],i)},url:`${l}/_api/v2.0/drives/${n}/items/${o}?select=webUrl,webDavUrl,name,sharepointIds`,tenantId:a,requestInit:{method:"GET"},retryPolicy:mt()?gt:ht.b,tokenPolicy:Object(ht.a)(e)},h=s?Object(i.b)({...d,logger:s,nameForLogging:"GetFileItemLite",doNotLogOnSuccess:!0,getAdditionalProps:async(e,t)=>Object(c.a)(e)}):Object(i.a)(d);let f;try{f=(await h).result}catch(e){}if(null!==(u=f)&&void 0!==u&&u.ok)try{return await f.json()}catch(e){s&&Object(ft.a)(s,{eventName:"GetFileItemLiteResponseParseError"},e)}}const yt=async(e,t,n,r)=>{if(wt(e))return bt(t,e.siteUrl,e.driven((e=>{const t=null==e?void 0:e.webDavUrl.lastIndexOf("/");if(void 0!==t&&t>0)return null==e?void 0:e.webDavUrl.substring(0,t)}))},wt=e=>(e=>"fluid"===e.type)(e)&&"driveId"in e&&"siteUrl"in e&&"itemId"in e,Ct=async e=>{try{const t=new dt;return await t.resolve({url:e})}catch(e){return Promise.resolve(void 0)}}},aADZ:function(e,t,n){"use strict";function r(e){if(void 0===e)return NaN;var t=parseInrts=function(e,t,n){var o=n.config.validateStatus;n.status&&o&&!o(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n.request,n)):{"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return s}));var r=n("D317o(e){return()=>e}function i(e){return t=>Math.pow(2,t)*e}function s(e,t,n){return a(e,[],t,n)}function a(e,t,n,o){let i;const s=[e(t.length).then((e=>(i=e,!1)))];return o&&o.timeoutMs>0&&s.push(Object(r.a)(o.timeoutMs).then((()=>!0))),Promise.race(s).then((s=>(s&&(i=o.onTimeout()),null==n||!n.filter(i)||t.length>=n.maxRetries?{result:i,tries:t}:Object(r.a)(n.backoffFn(t.length,i)).then((()=>(t.push(i),a(e,t,n,o)))))))}},aWgL:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("pkel"),o=n("hPT0"),i=n("zuGz"),s=n("ef5c");function a(e,t,n,r,o,a,u){const l=new i.a("QoS",e);Object(s.b)(l,{eventName:t,pillar:n,veto:r,errorType:o,isAce:!c(u),...a},u)}function c(e){return!(!e||!(e.errorType&&[r.a.offlineError,r.a.fileNotFoundOrAccessDeniedError,r.a.authorizationError,o.a.snapshotTooBig,o.a.invalidFileNameError,r.a.fileOverst(e.message)))}},am3b:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Base="Base",e.Mos="Mos",e.Space="Space"}(r||(r={}))},amPu:function(e,t,n){"use strict";function r(e,t,n){return e&&e.succes?n||"":"Bearer ").concat(e.token).trim(),t):null!=t?t:{}}n.d(t,"a",(function(){return r}))},b2OE:function(e,t,n){var r=n("LSEb")(n("s3UK"),"Set");e.exports=r},b87O:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n("QjXU"),o=n("ovpI"),i=n("SZNz"),s=n("9Q+N"),a=n("RtYo"),c=n("8Jek"),u=n.n(c),l=n("mXGw"),d=n.n(l),h=function(e){var t=Object(l.useRef)(null),n=Object(l.useRef)(null),c=Object(r.__read)(Object(l.useState)(!1),2),h=c[0],f=c[1],p=e.actions,m=e.ariaLabel,g=e.buttonClasses,v=e.iconClasses,b=e.item,y=Object(l.useCallback)((function(t){if(t.preventDefault(),t.currentTarget){var r=t.ingClientRect();n.current={left:r.left,top:r.top+r.height}}!e.contentActionsEnabled&&e.onActionMenuToggled&&e.onActionMenuToggled(!h),f((function(e){return!e}))}),[e,h]),w=Object(l.useCallback)((function(){!e.contentActionsEnabled&&e.onActionMenuToggled&&e.onActionMenuToggled(!1),f(!1)}),[e]);return e.contentActionsEnabled?d.a.createElement(i.a,{items:p,groupInfo:e.groupInfo,onActionMenuToggled:e.onActionMenuToggled,triggerOptions:Object(r.__assign)({ariaLabel:m,disabled:b.isReadOnly,icon:{type:a.a.ActionContextMenuIcon,iconName:"MoreIcon"},tooltip:m},e.triggerOptions),registerTuiElement:e.registerTuiElement}):d.a.createElement(d.a.Fragment,null,d.a.createElement("span",{"aria-label":m,ref:t,onClick:y,className:u()(g)},d.a.createElement(o.a,{className:u()(v),iconName:"MoreVertical"})),function(){return h?d.a.createElement(s.a,{menu:{items:p,id:"context-menu-".concat(b.id)},target:n.current||t,hidden:!1,onItemClick:w,onDismiss:w}):null}())}},b8Ug:function(e,t,n){"use strict";n.d(t,"a",(function(){return qr}));var r=n("QjXU"),o=n("mXGw"),i={Test:"https://augloop-test.officeppe.com",Int:"https://augloop-int.officeppe.com",Dogfood:"https://augloop-dogfood.officeppe.com",Prod:"https://augloop.office.com"},s="Int",a=n("fW/M"),c={util:{},roots:{default:{}}},u=(c.roots.default||(c.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.count=0,e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.durationMs=0,e.prototype.success=!1,e.prototype.resultDescription="",e.prototype.resultJSON="",e.prototype.resultSignature="",e.prototype.operationName="",e.prototype.resourceId="",e.prototype.dimension0="",e.prototype.dimension1="",e.prototype.dimension2="",e.prototype.dimension3="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientDeviceId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.joinContextId="",e.prototype.ariaTenant="",e.prototype.ariaNamespace="",e.prototype.dataFields="",e}()),l=n("hs6A");class d extends u{constructor(e,t){super(e),this.eventName="Operation",this.options=t,this.durationMs=null==e?void 0:e.durationMs,e&&null!=e.count||(this.count=1)}setClientMetadata(e){return e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,this.clientFlights=e.flights,this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientReleaseChannel=e.releaseChannel,this.clientReleaseFork=e.releaseFork,this.clientRuntimeVersion=e.runtimeVersion,this.clientSessionId=e.sessionId,this.clientDocSessionId=e.docSessionId,this.clientDeviceId=e.deviceId,this.clientUserAgent=e.userAgent),this}setUserContext(e){return e&&(this.userId=e.puid||e.oid,this.userType=e.userType&&e.userType.toString(),this.userTenantId=e.tid),this}setMetricCustomDimensions(e,t){if(!this.options)throw new Error(`Attempting to set custom dimensions ${e} to operation ${this.operationName} without activating MetricCount or MetricDuration`);this.options.metricCustomDimensions=this.options.metricCustomDimensions||{},this.options.metricCustomDimensions[e]=t}setDataField(e,t){const n=this.dataFields?JSON.parse(this.dataFields):{};n[e]=t,this.dataFields=JSON.stringify(n)}setDataFields(e){this.dataFields=this.dataFields?JSON.stringify(Object.assign(Object.assign({},JSON.parse(this.dataFields)),e)):JSON.stringify(e)}start(){return this.startTime=Object(l.a)(),this}stop(){const e=Object(l.a)();return this.durationMs=Math.round(e-this.startTime),this}getMetrics(e){var t,n;const r={};if(this.operationName)switch(this.operationName){case"SessionHealthOrphanedEventsWithoutProperSessionKey":case"SessionHealthOrphanedSessions":case"WorkflowActivationState":r[this.operationName+".CountV2"]={dimensionNames:d.getOrphanedSessionHealthDimensionNames.bind(d),dimensionValues:this.getOrphanedSessionHealthDimensionValues(),value:this.count};break;case"MarkUnhealthySession":case"MarkHealthWarningSession":r[this.operationName+".Reason"]={dimensionNames:d.getSessionHealthDimensionNames.bind(d),dimensionValues:this.getSessionHealthDimensionValues(),value:1};break;default:if("matchmaker_timer"===this.operationName&&(r["Workflow.DurationMs"]={dimensionNames:d.getWorkflowDimensionNames.bind(d),dimensionValues:this.getWorkflowDimensionValues(),value:this.durationMs||0},r["Workflow.Count"]={dimensionNames:d.getWorkflowDimensionNames.bind(d),dimensionValues:this.getWorkflowDimensionValues(),value:1}),void 0!==this.durationMs){const n=`${this.operationName}.DurationMsV2`;((null===(t=this.options)||void 0===t?void 0:t.metricDuration)||e.indexOf(n)>=0)&&(r[n]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.durationMs})}{const t=`${this.operationName}.CountV2`;((null===(n=this.options)||void 0===n?void 0:n.metricCount)||e.indexOf(t)>=0)&&(r[t]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.count})}}return r}getDimensionNames(){var e,t;let n=d.dimensionNames;if(null===(e=this.options)||void 0===e?void 0:e.metricCustomDimensions){n=n.slice();for(const e in null===(t=this.options)||void 0===t?void 0:t.metricCustomDimensions)n.push(e)}return n}getDimensionValues(){var e,t;const n=[this.success,this.clientAppName,this.clientAppPlatform,this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3];if(null===(e=this.options)||void 0===e?void 0:e.metricCustomDimensions)for(const e in null===(t=this.options)||void 0===t?void 0:t.metricCustomDimensions)n.push(this.options.metricCustomss,this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,th{return[this.resultSignature,this.clientAppName,this.clientAppPlatforlowDimensionNames(){return this.workflowDimensionNames}getWorkflowDimensionValues(){return[this.resultSignature,this.resourceId,this.resourceId,this.success]}}d.dimensionNames=["Success","ClientAppName","ClientAppPlatform","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"],d.orphanedSessionHealthDimensionNames=["Success","ClientAppName","ClientAppPlatform","ClientReleaseAudienceGroup","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"],d.sessionHealthDimensionNames=["Reason","ClientAppName","ClientAppPlatform","ClientAppVersion","Dimension0","Dimension1","Dimension2","Dimension3"],d.workflowDimensionNames=["ResultSignature","WorkflowId","ResourceId","Success"];var h,f,p=n("7Owc");!function(e){e[e.ProductServiceUsage=2]="ProductServiceUsage",e[e.ProductServicePerformance=4]="ProductServicePerformance"}(h||(h={})),function(e){e[e.Basi",e[e.RequiredServiceDataEvent=110]="RequiredServiceDataEvent"st m="n~",g=/\|\~/g;class v{constructor(){this.count=0,this.measureSums=new Map}}class b{constructor(e,t,n,r,o){this.buckets=new Map,this.init=e=>{this.log=e},this.add=(e,t=!0)=>{if(!this.condition||!this.condition(e))return!0===t&&this.log(e,!1),!1;const n=[];for(const t of this.dimensions)if(null==e[t])n.push(null);else{let r="";"boolean"==typeof e[t]?r="b~":"number"==typeof e[t]&&(r=m),n.push(`${r}${e[t].toString().replace(g,"_")}`)}const r=n.join("|");let o=this.buckets.get(r);if(!o){o=new v,o.traceLevel=e.traceLevel;for(const e of this.avgMeasures)o.measureSums.set(e,0);this.buckets.set(r,o)}o.count++;for(const t of this.avgMeasures)e[t]&&o.measureSums.set(t,o.measureSums.get(t)+e[t]);return!0},this.flush=(e=!1)=>{this.buckets.forEach(((e,t)=>{const n={traceLevel:e.traceLevel,eventName:this.eventName,count:e.count},r=t.split("|");for(let e=0;e<this.dimensions.length;e++){const t=r[e];n[this.dimensions[e]]=0===t.indexOf("b~")?"b~true"===t:0===t.indexOf(m)?parseInt(t.slice(m.length),10):t}for(const t of this.avgMeasures)n[t]=Math.round(e.measureSums.get(t)/e.count);this.log(n,!0)})),this.buckets.clear(),e&&(this.condition=null,clearInterval(this.interval))},this.eventName=e,this.condition=t,this.dimensions=n,this.avgMeasures=r,o>0&&(this.interval=setInterval(this.flush,1e3*o))}}const y=(e,t,n,r)=>new b(e,(e=>e.success&&n.ind","clientDocSessionId","dimension0","dimension1","dimension2","dimension3"],["durationMs"],r);class w{constructor(e){this.level=a.a.info,this.hostCallbacks=e}log(e){if(null==this.hostCallbacks||null==this.hostCallbacks.sendTelemetryEvent)return;const t=(e,t,n,r,o)=>{let i=t.charAt(0).toUpperCase()+t.slice(1),s={DocSessionId:e.clientDocSessionId,ResourceId:e.resourceId,ResultDescription:e.resultDescription,ResultSignature:e.resultSignature,Dimension0:e.dimension0,Dimension1:e.dimension1,Dimension2:e.dimension2,Dimension3:e.dimension3,JoinContextId:e.joinContextId};n&&(s=Object.assign(Object.assign({},s),JSON.parse(n)));const a=r||w.augLoopAriaTenantToken,c=o||a!=w.augLoopAriaTenantToken?o:w.augLoopAriaNamespace;i=i||w.operationNamePlaceholder,this.hostCallbacks.sendTelemetryEvent(a,c?`${c}_${i}`:i,s,"Office.System.Activity",{CV:e.cv,Duration:1e3*(e.durationMs||0),Count:e.count,AggMode:2,Success:e.success},!1,h.ProductServiceUsage|h.ProductServicePerformance,f.RequiredServiceDataEvent)};"Workflow.MetricsOnly"==e.category||("Operation"===e.eventName?t(e,e.operationName,e.dataFields):"SessionHealth"===e.eventName?t(e,e.sessionHealthEventName):"WorkflowOperation"===e.eventName?t(e,e.operationName,e.dataFields,e.ariaTenant,e.ariaNamespace):"Log"===e.eventName&&((e,t,n)=>{this.hostCallbacks.sendDiagnosticTrace&&this.hostCallbacks.sendDiagnosticTrace(e,t,n)})(e.tagId,e.traceLevel,e.message))}}w.augLoopAriaTenantToken="3de4087d4de34817b1c376e3d1e6e293-983c4292-5ba9]="Undefined",e[e.Schema=1]="Schema",e[e.Boolean=2]="Boolean",e[e.Number=3]="Number",e[e.String=4]="String",e[e.Buffer=5]="Buffer",e[e.Function=6]="Function"}(C||(C={}));class S{constructor(e){S.assign(S,this,e)}static getTypeName(){return"AugLoop_Core_SchemaObject"}static getBaseTypes(){return[]}static getTypeNameFor(e){return e&&e.H_?e.H_.T_:void 0}static getBaseTypesFor(e){return e&&e.H_&&e.H_.B_?e.H_.B_:[]}static getAllTypesFor(e){const t=S.getTypeNameFor(e);return t?[t,...S.getBaseTypesFor(e)]:[]}static matchesTypesFor(e,t){if(!Array.isArray(t)||0===t.length)return!0;const n=S.getTypeNameFor(e),r=S.getBaseTypesFor(e);for(const e of t){if(e===n)return!0;if(r.indexOf(e)>=0)return!0}return!1}static assign(e,t,n){if(n)for(const e of Object.keys(n))t[e]=n[e];return t.H_=e.H_,t}}S.H_={T_:S.getTypeName(),B_:S.getBaseTypes()};class k{constructor(e){S.assign(k,this,e)}get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_Core_Annotation"}static getBaseTypes(){return[]}static typeGuard(e){return S.matchesTypesFor(e,[k.getTypeName()])}}k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()};class E{constructor(e){S.assign(E,this,e)}get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_Core_BinaryClassificationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return S.matchesTypesFor(e,[E.getTypeName()])}}E.H_={T_:E.getTypeName(),B_:E.getBaseTypes()};class _{constructor(e){S.assign(_,this,e)}static getTypeName(){return"AugLoop_Signals_Signal"}static getBaseTypes(){return[]}static typeGuard(e){return S.matchesTypesFor(e,[_.getTypeName()])}}_.H_={T_:_.getTypeName(),B_:_.getBaseTypes()};class j{constructor(e){S.assign(j,this,e)}static getTypeName(){return"AugLoop_Core_ItemDelta"}static getBaseTypes(){return[]}static typeGuard(e){return S.matchesTypesFor(e,[j.getTypeName()])}}j.H_={T_:j.getTypeName(),B_:j.getBaseTypes()};class I{constructor(e){S.assign(I,this,e)}static getTypeName(){return"AugLoop_Core_ItemChangesDelta"}static getBaseTypes(){return["AugLoop_Core_ItemDelta"]}static typeGuard(e){return S.matchesTypesFor(e,[tTypeName(),B_:I.getBaseTypes()};class N{constructor(e){S.assign(N,this,e)}static getTypeName(){return"AugLoop_Core_Operation"}static getBaseTypes(){return[]}static typeGuard(e){return S.matchesTypesFor(e,[N.getTypeName()])}}N.H_={T_:N.getTypeName(),B_:N.getBaseTypes()};class A{constructor(e){S.assign(A,this,e)}static getTypeName(){return"AugLoop_Core_OperationWithSiblingContext"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return S.matchesTypesFor(e,[A.getTypeName()])}}A.H_={T_:A.getTypeName(),B_:A.getBaseTypes()};class P{constructor(e){S.assign(P,this,e)}static getTypeName(){return"AugLoop_Core_AddOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(e){return S.matchesTypesFor(e,[P.getTypeName()])}}P.H_={T_:P.getTypeName(),B_:P.getBaseTypes()};class x{constructor(e){S.assign(x,this,e)}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(e){return S.matchesTypesFor(e,[x.getTypeName()])}}x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()};class D{constructor(e){S.assign(D,this,e)}static getTypeName(){return"AugLoop_Core_UpdateAnnotationMetaDataOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return S.matchesTypesFor(e,[D.getTypeName()])}}D.H_={T_:D.getTypeName(),B_:D.getBaseTypes()};class L{constructor(e){S.assign(L,this,e)}static getTypeName(){return"AugLoop_Core_UpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return S.matchesTypesFor(e,[L.getTypeName()])}}L.H_={T_:L.getTypeName(),B_:L.getBaseTypes()};class M{constructor(e){S.assign(M,this,e)}static getTypeName(){return"AugLoop_Core_DeleteOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return S.matchesTypesFor(e,[M.getTypeName()])}}M.H_={T_:M.getTypeName(),B_:M.getBaseTypes()};class R{constructor(e){S.assign(R,this,e)}static getTypeName(){return"AugLoop_Core_PurgeOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return S.matchesTypesFor(e,[R.getTypeName()])}}R.H_={T_:R.getTypeName(),B_:R.getBaseTypes()};class F{constructor(e){S.assign(F,this,e)}static getTypeName(){return"AugLoop_Core_FocusOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return S.matchesTypesFor(e,[F.getTypeName()])}}F.H_={T_:F.getTypeName(),B_:F.getBaseTypes()};class B{constructor(e){S.assign(B,this,e)}static getTypeName(){return"AugLoop_Core_VisibilityOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return S.matchesTypesFor(e,[B.getTypeName()])}}B.H_={T_:B.getTypeName(),B_:B.getBaseTypes()};class U{constructor(e){S.assign(U,this,e)}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return S.matchesTypesFor(e,[U.getTypeName()])}}U.H_={T_:U.getTypeName(),B_:U.getBaseTypes()};class W{constructor(e){S.assign(W,this,e)}static getTypeName(){return"AugLoop_Core_MicroSyncOperation"}static getBaseTypes(){returnass q{constructor(e){S.assign(q,this,e)}static getTypeName(){return"AugLoop_Signals_SignalOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return S.matchesTypesFor(e,[q.getTypeName()])}}q.H_={T_:q.getTypeName(),B_:q.getBaseTypes()};class H{static createHealthCheckRequest(e){return{payload:{},payloadSchema:{category:C.Schema,schema:{name:"HealthCheckRequest"}},requestedSchema:{category:C.Schema,schema:{name:"HealthCheckRea:e}}static isFeatureEnabled(e,t,n=!1,r="None"){return e&&e.isFeatureEnabled?e.isFeatu(n))):Promise.resolve(n)}static convertWebSocketUrlToHttp(e){return this.convertUrl(e,!1)}static convertServiceUrlToWebSocket(e){return this.convertUrl(e,!0)}static convertUrl(e,t){if(!e)return e;const n=e.splitdexOf(t?,n.join(":")):e}}H.getCurrentTimeMs=()=>Date.now?Date.now():(new Date).getTime();class z{constructor(e){this.maxNumberOfLogs=40,this.numberOfLogs=0,this.id=e}log(e){if(this.numberOfLogs<this.maxNumberOfLogs&&(this.numberOfLogs++,e(),this.numberOfLogs===this.maxNumberOfLogs)){const e=new d({operationName:"OnLastLog",success:!0,resourceId:this.id,resultDescription:`Limit for number of logs for id: ${this.id} reached - all next logs will be dropped`});p.a.warn(572838107,p.b.CoreDefault,e)}}}S.getTypeName(),k.getTypeName(),_.getTypeName();const G=(e,t=0)=>Number.isFinite(e)?e:t;class V{constructor(){this.hasBeenOpened=!1,this.hadEgressError=!1,this.lastEgressTime=0,this.lastPongTime=0,this.remainingPingFailures=3,this.egressMessageCount=0,this.egressByteCount=0,this.pendingEgress=[]}init(e,t,n,r,o){this.ws=new T.a(e),this.logOp=new d({operationName:V.className,success:!0}).start(),this.egressTimer=Date.now(),this.egressMessageCountOp=new d({operationName:"WSEgressMessageCount",success:!0}),this.egressByteCountOp=new d({operationName:"WSEgressByteOrderOfMagnitude",success:!0}),this.ingressByteCountOp=new d({operationName:"WSIngressByteOrderOfMagnitude",success:!0}),this.improvedWebSocketEnabled=o;const i=e=>{this.logPingLatencyOp&&(this.logPingLatencyOp.success=e,p.a.info(572838091,p.b.CoreDefault,this.logPingLatencyOp.stop()),this.logPingLatencyOp=void 0)};this.ws.addEventListener("open",(e=>{n(),V.logCountLimiter.log((()=>{this.logOp.resourceId="OnOpen",this.logOp.resultDescription="",this.logOp.success=!0,this.logOp.dimension0=this.pendingEgress.length.toString(),p.a.info(572838092,p.b.CoreDefault,this.logOp.stop())})),this.improvedWebSocketEnabled||(this.hasBeenOpened=!0,this.pendingEgress.forEach((e=>{this.egress(e)})),this.pendingEgress=[],this.pingInterval=setInterval((()=>{this.logPingLatencyOp&&(--this.remainingPingFailures,i(!1)),this.remainingPingFailures>0&&this.hasBeenOpened&&this.lastPongTime<this.lastEgressTime&&(this.logPingLatencyOp=new d({operationName:"Ping",success:!0,dimension0:this.ws.bufferedAmount>=0?this.ws.bufferedAmount.toString().length.toString():void 0}).start(),this.ws.send(V.pingPongMessage,(e=>{e&&(--this.remainingPingFailures,i(!1))})))}),3e4))})),this.ws.addEventListener("message",(e=>{!this.improvedWebSocketEnabled&&this.logPingLatencyOp&&"string"==typeof e.data&&1===e.data.length&&e.data[0]===V.pingPongMessage?(i(!0),this.lastPongTime=Date.now()):(this.logIngressCount(e.data),t(e.data))})),this.ws.addEventListener("error",(e=>{this.errorMessage=e.message,V.logCountLimiter.log((()=>{this.logOp.resourceId="OnError",this.logOp.resultDescription=this.errorMessage,this.logOp.success=!1,p.a.info(572838093,p.b.CoreDefault,this.logOp.stop())})),this.ws.close()})),this.ws.addEventListener("close",(e=>{V.logCountLimiter.log((()=>{this.logOp.resourceId="OnClose",this.logOp.resultDescription=e?`code: ${e.code}. reason: ${e.reason}`:"",this.logOp.success=!0,p.a.info(572838094,p.b.CoreDefault,this.logOp.stop())})),!this.improvedWebSocketEnabled&&this.pingInterval&&(clearInterval(this.pingInterval),this.pingInterval=void 0),r(this.errorMessage)}))}egress(e){this.improvedWebSocketEnabled?this.ws.send(e,(e=>{e&&!this.hadEgressError&&(this.hadEgressError=!0,V.logCountLimiter.log((()=>{this.logOp.resourceId="OnEgressError",this.logOp.resultDescription=e.message,this.logOp.success=!1,p.a.info(509370640,p.b.CoreDefault,this.logOp.stop())})))})):(this.logEgressCount(e instanceof ArrayBuffer?e.byteLength:e.length),this.lastEgressTime=Date.now(),this.hasBeenOpened?this.ws.send(e,(e=>{e&&!this.hadEgressError&&(this.hadEgressError=!0,V.logCountLimiter.log((()=>{this.logOp.resourceId="OnFirstEgressError",this.logOp.resultDescription=e.message,this.logOp.success=!1,p.a.info(572838095,p.b.CoreDefault,this.logOp.stop())})))})):this.pendingEgress.push(e))}close(){!this.improvedWebSocketEnabled&&this.pingInterval&&(clearInterval(this.pingInterval),this.pingInterval=void 0),this.ws.close()}logEgressCount(e){const t=Date.now(),n=t-this.egressTimer;n>1e3&&(this.egressMessageCount>50&&(this.egressMessageCountOp.start(),this.egressMessageCountOp.resultDescription="Egress message count: "+this.egressMessageCount.toString()+", Buffered amount: "+(this.ws.bufferedAmount>=0?this.ws.bufferedAmount.toString():"-")+", Time elapsed: "+n.toString(),p.a.info(512234761,p.b.CoreDefault,this.egressMessageCountOp.stop())),this.egressByteCount>1e5&&(this.egressByteCountOp.start(),this.egressByteCountOp.dimension2=this.egressByteCount.toString().length.toString(),this.egressMessageCountOp.resultDescription="Buffered amount: "+(this.ws.bufferedAmount>=0?this.ws.bufferedAmount.toString():"-")+", Time elapsed: "+n.toString(),p.a.info(512234760,p.b.CoreDefault,this.egressByteCountOp.stop())),this.egressTimer=t,this.egressMessageCount=0,this.egressByteCount=0),this.egressMessageCount++,this.egressByteCount+=null!=e?e:0}logIngressCount(e){const t=e.length;t>1e5&&(this.ingressByteCountOp.start(),this.ingressByteCountOp.dimension2=t.toString().length.toString(),p.a.info(508957778,p.b.CoreDefault,this.ingressByteCountOp.stop()))}}V.className="WebSocketWorker",V.logCountLimiter=new z(V.className),V.pingPongMessage="~";class ${constructor(e){this.childCount=0,this.id=e||function(){for(let e=0;e<22;e++)J[e]=Q[Math.floor(Math.random()*Q.length)];return J.join("")}()}static fromString(e,t){if(!e)throw new Error("Received invalid correlation vector string");let n;return n=e.endsWith(,n}newChild(){return++this.childCount,new $(this.id+"."+this.childCount.toString())}toString(){return this.id.length>127?this.id.substring(0,127)+"!":this.id}}const Q=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],J=new Array(22);var X,K,Y,Z,ee,te={util:{},roots:{default:{}}},ne=(te.roots.default||(te.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientDeviceId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.sessionHealthEventName="",e.prototype.source="",e.prototype.reason="",e.prototype.reasonDependency="",e.prototype.subReason="",e.prototype.impact="",e.prototype.success=!1,e.prototype.durationMs=0,e.prototype.count=0,e.prototype.message="",e.prototype.affectedWorkflows="",e.prototype.resourceId="",e.prototype.dimension0="",e.prototype.dimension1="",e.prototype.dimension2="",e.prototype.dimension3="",e.prototype.resultDescription="",e.prototype.resultSignature="",e.prototype.joinContextId="",e}());!function(e){e[e.Unknown=0]="Unknown",e[nt",e[e.Network=5]="Network",e[e.AugLoopDependency=6]="AugLoopDependency",e[e.WorkflowDependency=7]="WorkflowDependency",e[e.ClientRuntime=8]="ClientRuntime"}(K||(K={})),function(e){e[e.Unknown=0]="Unknown",e[e.None=1]="None",e[e.MissingInput=2]="MissingInput",e[e.MissingOutput=3]="MissingOutput"}(Y||(Y={}));class re extends ne{constructor(e,t){var n,r;super({source:X[e.source],reason:K[e.reason],reasonDependency:e.reasonDependency,subReason:e.subReason,sessionHealthEventName:e.sessionHealthEventName,impact:Y[e.impact],success:e.success,durationMs:null!==(n=e.durationMs)&&void 0!==n?n:0,count:"number"==typeof e.count?e.count:1,message:e.message,affectedWorkflows:(null!==(r=e.affectedWorkflows)&&void 0!==r?r:[]).join(","),resourceId:e.resourceId,dimension0:e.dimension0,dimension1:e.dimension1,dimension2:e.dimension2,dimension3:e.dimension3,cv:e.cv,resultSignature:e.resultSignature,resultDescription:e.resultDescription,joinContextId:e.joinContextId}),this.eventName="SessionHealth",t&&this.setClientMetadata(t),this.metricCount=e.metricCount,this.metricDuration=e.metricDuration}getMetrics(){const e={};return(void 0===this.metricCount||this.metricCount)&&(e[`${this.sessionHealthEventName}.CountV2`]={dimensionNames:()=>re.dimensionNames,dimensionValues:this.alue:this.count}),(void 0===this.metricDuration||this.metricDuration)&&(e[`${this.sessionHealthEventName}.DurationMsV2`]={dimensionNames:()=>re.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.durationMs}),e}setClientMetadata(e){return e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,this.clientFlights=e.flights,this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientReleaseChannel=e.releaseChannel,this.clientReleaseFork=e.releaseFork,this.clientRuntimeVersion=e.runtimeVersion,this.clientSessionId=e.sessionId,this.clientDocSessionId=e.docSessiclientDeviceId=e.deviceId),this}setReason(e){return this.reason=K[e],this}setSourceY[e],this}setAffectedWorkflows(e){return this.affectedWorkflows=(null!=e?e:[]).join(","),this}getAffectedWorkflows(){return this.affectedWorkflows.split(",")}start(){return this.startTime=Object(l.a)(),this}stop(){const e=Object(l.a)();return this.durationMs=Math.round(e-this.startTime),this}getDimensionValues(){var e;return[this.clientAppName,this.clientAppPlatform,this.clientAppVersion,this.success?"1":"0",`${this.reason}_${this.reasonDependency}`,this.impact,null!==(e=this.getAffectedWorkflows()[0])&&void 0!==e?e:"",this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}}re.dimensionNames=["ClientAppName","ClientAppPlatform","ClientAppVersion","Success","Reason","Impact","FirstAffectedWorkflow","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"];class oe{constructor(e){S.assign(oe,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Message"}static getBaseTypes(){return[]}static typeGuard(e){return S.matchesTypesFor(e,[oe.getTypeName()])}}oe.H_={T_:oe.getTypeName(),B_:oe.getBaseTypes()};class ie{constructor(e){S.assign(ie,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Response"}static getBaseTypes(){return[]}static typeGuard(e){return S.matchesTypesFor(e,[ie.getTypeName()])}}ie.H_={T_:ie.getTypeName(),B_:ie.getBaseTypes()};class se{constructor(e){S.assign(se,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return S.matchesTypesFor(e,[se.getTypeName()])}}se.H_={T_:se.getTypeName(),B_:se.getBaseTypes()};class ae{constructor(e){S.assign(ae,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TimeoutErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_ErrorResponse","AugLoop_Session_Protocol_Response"]}static typeGuard(e){return S.matchesTypesFor(e,[ae.getTypeName()])}}ae.H_={T_:ae.getTypeName(),B_:ae.getBaseTypes()};class ce{constructor(e){S.assign(ce,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return S.matchesTypesFor(e,[ce.getTypeName()])}}ce.H_={T_:ce.getTypeName(),B_:ce.getBaseTypes()};class ue{constructor(e){S.assign(ue,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return S.matchesTypesFor(e,[ue.getTypeName()])}}ue.H_={T_:ue.getTypeName(),B_:ue.getBaseTypes()};class le{constructor(e){S.assign(le,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionCloseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return S.matchesTypesFor(e,[le.getTypeName()])}}le.H_={T_:le.getTypeName(),B_:le.getBaseTypes()};class de{constructor(e){S.assign(de,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_CacheDumpRequestMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return S.matchesTypesFor(e,[de.getTypeName()])}}de.H_={T_:de.getTypeName(),B_:de.getBaseTypes()};class he{constructor(e){S.assign(he,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_CacheDumpRequestResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return S.matchesTypesFor(e,[he.getTypeName()])}}he.H_={T_:he.getTypeName(),B_:he.getBaseTypes()};class fe{constructor(e){S.assign(fe,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationActivationMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return S.matchesTypesFor(e,[fe.getTypeName()])}}fe.H_={T_:fe.getTypeName(),B_:fe.getBaseTypes()};class pe{constructor(e){S.assign(pe,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationActivationResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return S.matchesTypesFor(e,[pe.getTypeName()])}}pe.H_={T_:pe.getTypeName(),B_:pe.getBaseTypes()};class me{constructor(e){S.assign(me,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationResultStateMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return S.matchesTypesFor(e,[me.getTypeName()])}}me.H_={T_:me.getTypeName(),B_:me.getBaseTypes()};class ge{constructor(e){S.assign(ge,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationReleaseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return S.matchesTypesFor(e,[ge.getTypeName()])}}ge.H_={T_:ge.getTypeName(),B_:ge.getBaseTypes()};class ve{constructor(e){S.assign(ve,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationReleaseResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return S.matchesTypesFor(e,[ve.getTypeName()])}}ve.H_={T_:ve.getTypeName(),B_:ve.getBaseTypes()};class be{constructor(e){S.assign(be,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return S.matchesTypesFor(e,[be.getTypeName()])}}be.H_={T_:be.getTypeName(),B_:be.getBaseTypes()};class ye{constructor(e){S.assign(ye,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return S.matchesTypesFor(e,[ye.getTypeName()])}}ye.H_={T_:ye.getTypeName(),B_:ye.getBaseTypes()};class we{constructor(e){S.assign(we,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SyncMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return S.matchesTypesFor(e,[we.getTypeName()])}}we.H_={T_:we.getTypeName(),B_:we.getBaseTypes()};class Ce{constructor(e){S.assign(Ce,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_MicroSyncMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return S.matchesTypesFor(e,[Ce.getTypeName()])}}Ce.H_={T_:Ce.getTypeName(),B_:Ce.getBaseTypes()};class Oe{constructor(e){S.assign(Oe,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SyncResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return S.matchesTypesFor(e,[Oe.getTypeName()])}}Oe.H_={T_:Oe.getTypeName(),B_:Oe.getBaseTypes()};class Te{constructor(e){S.assign(Te,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionDeleteMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return S.matchesTypesFor(e,[Te.getTypeName()])}}Te.H_={T_:Te.getTypeName(),B_:Te.getBaseTypes()};class Se{constructor(e){S.assign(Se,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationResultsMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SyncMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return S.matchesTypesFor(e,[Se.getTypeName()])}}Se.H_={T_:Se.getTypeName(),B_:Se.getBaseTypes()};class ke{constructor(e){S.assign(ke,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TokenProvisionMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return S.matchesTypesFor(e,[ke.getTypeName()])}}ke.H_={T_:ke.getTypeName(),B_:ke.getBaseTypes()};class Ee{constructor(e){S.assign(Ee,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TokenProvisionResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return S.matchesTypesFor(e,[Ee.getTypeName()])}}Ee.H_={T_:Ee.getTypeName(),B_:Ee.getBaseTypes()};class _e{constructor(e){S.assign(_e,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_KeepAlive"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return S.matchesTypesFor(e,[_e.getTypeName()])}}_e.H_={T_:_e.getTypeName(),B_:_e.getBaseTypes()};class je{constructor(e){S.assign(je,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowGraphInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return S.matchesTypesFor(e,[je.getTypeName()])}}je.H_={T_:je.getTypeName(),B_:je.getBaseTypes()};class Ie{constructor(e){S.assign(Ie,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowGraphInitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return S.matchesTypesFor(e,[Ie.getTypeName()])}}Ie.H_={T_:Ie.getTypeName(),B_:Ie.getBaseTypes()};class Ne{constructor(e){S.assign(Ne,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionCompleteMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SyncMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return S.matchesTypesFor(e,[Ne.getTypeName()])}}Ne.H_={T_:Ne.getTypeName(),B_:Ne.getBaseTypes()};class Ae{constructor(e){S.assign(Ae,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return S.matchesTypesFor(e,[Ae.getTypeName()])}}Ae.H_={T_:Ae.getTypeName(),B_:Ae.getBaseTypes()};class Pe{constructor(e){S.assign(Pe,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return S.matchesTypesFor(e,[Pe.getTypeName()])}}Pe.H_={T_:Pe.getTypeName(),B_:Pe.getBaseTypes()};class xe{constructor(e){S.assign(xe,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2CallbackMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return S.matchesTypesFor(e,[xe.getTypeName()])}}xe.H_={T_:xe.getTypeName(),B_:xe.getBaseTypes()};class De{constructor(e){S.assign(De,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_BridgeMessage"}static getBaseTypes(){return[]}static typeGuard(e){return S.matchesTypesFor(e,[De.getTypeName()])}}De.H_={T_:De.getTypeName(),B_:De.getBaseTypes()};class Le{constructor(e){if(this.cache=new Map,this.options=e||{sweepInterval:100},null!=this.options.idleDurationMs&&this.options.idleDurationMs<=0)throw new Error("Idle duration must be positive");if(this.interval=this.options.sweepInterval||100,this.interval<=0)throw new Error("Sweep interval must be a positive number")}put(e,t,n,r,o,i,s){if(null==n||n<=0)throw new Error("Cache timeout must be a positive number");(null==o||o<=0)&&(o=this.options.idleDurationMs);const a={value:t,lastUsed:o?Date.now():void 0,expire:n+Date.now(),idleDurationMs:o,expireCallback:r,expiringTriggerTime:i+Date.now(),expiringCallback:s};return this.cache.set(e,a),this.timeout||(this.timeout=setInterval(this.onInterval.bind(this),this.interval),this.timeout.unref&&this.timeout.unref()),t}del(e){if(this.onst t=this.cache.delete(e);return 0===this.size()&&this.clear(),t}clear(){this.timeout&&(clearInterval(this.timeout),this.timeout=void 0),this.cache.clear()}get(e){con;if(t)return this.options.idleDurationMs&&(t.lastUsed=Date.now()),t.value}keys(){return this.cache.keys()}forEach(e){this.cache.forEach(((t,n)=>{e(t.value,n)}))}size(){return this.cache.size}updateExpireTime(e,t){return!!(this.cache.has(e)&&t>=0)&&(this.cache.get(e).expire=t+Date.now(),!0)}onInterval(){const e=Date.now();this.cache.forEach(((t,n)=>{if(t.idleDurationMs&&t.lastUsed<e-t.idleDurationMs)return this.del(n),void(this.options.idleCallback&&this.options.idleCallback(n,t.value));t.expire<e&&(this.del(n),t.expireCallback&&t.expireCallback(n,t.value)),t.expiringTriggerTime<e&&t.expiringCallback&&(t.expiringCallback(n,t.value),t.expiringCallback=void 0)}))}}function Me(e){const t=["AugLoop_Excel_Session_Protocol_","AugLoop_Powerpoint_Session_Protocol_","AugLoop_Session_Protocol_"];let n;for(const r of t)if(0===e.indexOf(r)){n=r;break}if(!n)return"MalformedMessageName";const r="Message",o=e.indexOf(r,e.length-r.length)===e.length-r.length;return e.slice(n.length,o?-r.length:void 0)}!function(e){e.ClientDisconnected="Client disconnected.",e.UnsupportedSyncMessage="SyncMessages with seq = -1 are not supported anymore.",e.UnexpectedSeedMessage="Unexpected seed message",e.SyncMessageUnsupportedBatch="SyncMessage with unsupported batching.",e.AnnotationTokenNotFound="Token not found"}(Z||(Z={})),function(e){e.ProvisionTokenValidationError="Token provision message didn't pass token validation.",e.ProvisionTokenDecryptAndTransformError="Token provision message didn't pass token decrypt and transform."}(ee||(ee={}));class Re{constructor(e){this.nextMessageId=1,this.pendingResponseCallbacks=new Le({sweepInterval:5e3}),this.pendingMessageCallbacks=new Le({sweepInterval:5e3}),this.messageCallbacks=new Map,this.messageIdPrefix=e,this.source="c"===e?X.ClientRuntime:X.Core,this.stats={sendMessageCount:0,sendMessageClientDisconnectedErrors:0,sendMessageErrors:0,sendMessageDurationMsMax:0,processMessageCount:0,processMessageProvisionTokenErrors:0,processMessageErrors:0,processMessageDurationMsMax:0}}setClientMetadata(e){this.clientMetadata=e}setEgress(e){this.egress=e}ingress(e,t){const n=S.getBaseTypesFor(e),r=S.getTypeNameFor(e);r===ie.getTypeName()||n&&n.indexOf(ie.getTypeName())>=0?(this.processResponse(e),t()):this.processMessage(e,t),r!==le.getTypeName()||e.reconnectAllowed||this.clearAllPendingResponses()}sendMessage(e,t,n,r=0){const o=new re({sessionHealthEventName:"SendMessage",source:this.source,reason:K.Client,impact:this.source===X.ClientRuntime?Y.MissingInput:Y.MissingOutput,success:!0,message:"",affectedWorkflows:["All"],cv:e.cv,resourceId:Me(S.getTypeNameFor(e)),dimension0:r.toString()}).start(),i=()=>{o.setClientMetadata(this.clientMetadata),o.success?p.a.info(572836e3,p.b.CoreDefault,o.stop()):(o.message=JSON.stringify({errorNotPropagatedToDoneCallback:"ErrorWithoutPendingResponse"===o.resultSignature||"ResponseCallbackException"===o.resultSignature||"We called into done callback"!==o.message}),p.a.error(572836001,p.b.CoreDefault,o.stop()))};e.messageId=`${this.messageIdPrefix}${this.nextMessageId++}`;const s=S.getTypeNameFor(e)===le.getTypeName();if(!n&&!s){const n=(n,r)=>{var s;if(n?(o.success=!1,o.resultSignature=n.error,o.resultDescription=`Error for ${S.getTypeNameFor(e)} message ${e.messageId}: ${n.error}`):o.resultSignature="Success",t)try{o.message="We called into done callback",t(n,r)}catch(e){o.success=!1,o.resultSignature="ResponseCallbackException",o.resultDescription="Web"===(null===(s=this.clientMetadata)||void 0===s?void 0:s.appPlatform)?JSON.stringify({message:e.message,stack:e.stack}):JSON.stringify({message:e.message})}this.pendingMessageCallbacks.del(e.messageId),i(),this.updateSendMessageStats(o.success,o.durationMs,n?new Error(n.error):void 0)},r=()=>{n(new ae({error:"Timeout waiting for response"}),void 0)};this.pendingResponseCallbacks.put(e.messageId,n,3e4,r)}this.egress(e,(t=>{var n,r;if(t){const a=this.pendingResponseCallbacks.get(e.messageId);a?(this.pendingResponseCallbacks.del(e.messageId),a(new se({messageId:e.messageId,error:t.message}))):s?(o.success=null!==(r=null===(n=t.message)||void 0===n?void 0:n.endsWith("Client disconnected."))&&void 0!==r&&r,o.resultSignature="ErrorSendingSessionCloseMessage",o.resultDescription=`Error for ${S.getTypeNameFor(e)} message ${e.messageId}: ${t.message}`,i()):(o.success=!1,o.resultSignature="ErrorWithoutPendingResponse",o.resultDescription=`Error for ${S.getTypeNameFor(e)} message ${e.messageId}: ${t.message}`,i())}}))}onMessage(e,t){this.messageCallbacks.set(e,t)}getStats(){return this.stats}hasMessageCallback(e){return this.messageCallbacks.has(e)}cancelPendingResponseCallbacks(){this.pendingResponseCallbacks.forEach(((e,t)=>{e&&(this.pendingResponseCallbacks.del(t),e(new se({messageId:t,error:"Cancelled"})))}))}clearAllPendingResponses(){if(0==this.pendingResponseCallbacks.size())return;const e=new d({operationName:"PurgePendingResponses",resultDescription:this.pendingResponseCallbacks.size().toString(),success:!0});p.a.info(572836002,p.b.CoreDefault,e),this.pendingResponseCallbacks.clear()}processMessage(e,t){var n;const r=new re({sessionHealthEventName:"ProcessMessage",source:this.source,reason:K.Client,impact:this.source===X.ClientRuntime?Y.MissingOutput:Y.MissingInput,success:!0,message:"",affectedWorkflows:["All"],cv:e.cv}).start(),o=()=>{r.setClientMetadata(this.clientMetadata),r.success?p.a.info(572836003,p.b.CoreDefault,r.stop()):(r.message=JSON.stringify({errorHappenedOutsideRegisteredMessageCallback:"UnsupportedMessage"===r.resourceId||"Timeout"===r.resultSignature||"OnResponseInvokedMoreThanOnce"===r.resultSignature||"MessageCallbackException"===r.resultSignature||"We called into messageCallback"!==r.message}),p.a.error(572836032,p.b.CoreDefault,r.stop()))};let i=this.messageCallbacks.get(S.getTypeNameFor(e));i?r.resourceId=Me(S.getTypeNameFor(e)):i=(e,t)=>{r.resourceId=Me(S.getTypeNameFor(e)),"MalformedMessageName"!==r.resourceId&&(r.resourceId="UnsupportedMessage"),t(new se({messageId:e.messageId,error:`Message type ${S.getTypeNameFor(e)} is not supported`}))},this.pendingMessageCallbacks.put(e.messageId,void 0,1e4,(()=>{r.success=!1,r.resultSignature="Timeout",r.resultDescription="Timeout processing message callback",o(),p.a.error(572836033,p.b.CoreDefault,`Timeout processing ${r.resourceId}`),this.updateProcessMessageStats(!1,r.durationMs,new Error("timeout"))}));let s=!1;const a=(n,i)=>{this.pendingMessageCallbacks.del(e.messageId),s?(r.success=!1,r.resultSignature="OnResponseInvokedMoreThanOnce",r.resultDescription=`Invoked onResponse for ${S.getTypeNameFor(e)} message ${e.messageId} more than once`):n?(r.success=!1,r.resultSignature=n.error,r.resultDescription=`Error for ${S.getTypeNameFor(e)} message ${e.messageId}: ${n.error}`):r.resultSignature="Success",s=!0,o(),n&&!S.matchesTypesFor(n,[se.getTypeName()])&&(n=new se({error:"Internal Server Error"})),this.updateProcessMessageStats(r.success,r.durationMs,n?new Error(n.error):void 0),n?(n.messageId=e.messageId,t(n)):i?(i.messageId=e.messageId,t(void 0,i)):t()};try{r.message="We called into messageCallback",i(e,a)}catch(i){this.pendingMessageCallbacks.del(e.messageId),r.success=!1,r.resultSignature="MessageCallbackException",r.resultDescription="Web"===(null===(n=this.clientMetadata)||void 0===n?void 0:n.appPlatform)?JSON.stringify({message:i.message,stack:i.stack}):JSON.stringify({message:i.message}),o(),this.updateProcessMessageStats(!1,r.durationMs,i),t()}}processResponse(e){var t;const n=new d({operationName:"ProcessResponse"});if(n.success=!0,n.setClientMetadata(this.clientMetadata),n.start(),e.messageId){const t=this.pendingResponseCallbacks.get(e.messageId);t?(this.pendingResponseCallbacks.del(e.messageId),S.matchesTypesFor(e,[se.getTypeName()])?t(e):t(void 0,e)):(n.resultSignature="NoPendingMessage",n.resultDescription=`${e.messageId}`,n.success=!1)}else n.resultSignature="NoMessageIdSetInResponse",n.resultDescription=se.typeGuard(e)?e.error:"MessageId is not available",n.success=!1;"Production"!==(null===(t=this.clientMetadata)||void 0===t?void 0:t.releaseAudienceGroup)&&(n.resourceId=Me(S.getTypeNameFor(e)),p.a.info(572836034,p.b.CoreDefault,n.stop()))}updateSendMessageStats(e,t,n){this.stats.sendMessageCount++,this.stats.sendMessageDurationMsMax=Math.max(t,this.stats.sendMessageDurationMsMax),e||n?e&&n&&p.a.warn(572836036,p.b.CoreDefault,"Succeeded send message provided error object."):p.a.warn(572836035,p.b.CoreDefault,"Failed send message did not provide error object."),e||(n&&n.message===Z.ClientDisconnected?this.stats.sendMessageClientDisconnectedErrors++:this.stats.sendMessageErrors++)}updateProcessMessageStats(e,t,n){this.stats.processMessageCount++,this.stats.processMessageDurationMsMax=Math.max(t,this.stats.processMessageDurationMsMax),e||n?e&&n&&p.a.warn(572836038,p.b.CoreDefault,"Succeeded process message provided error object."):p.a.warn(572836037,p.b.CoreDefault,"Failed process message did not provide error object."),e||(n&&n.message===ee.ProvisionTokenValidationError?this.stats.processMessageProvisionTokenErrors++:this.stats.processMessageErrors++)}}var Fe,Be,Ue=n("/ieh"),We=n("3YFW"),qe=n.n(We);!function(e){e.ArrivedBeforeReseeding="Message is dropped from queue since it arrived before reseeding is started",e.DroppedAsOldestInQueue="Message is dropped as oldest in full queue",e.DroppedBecauseClientDisconnected="Message is dropped because client is disconnected from server"}(Fe||(Fe={}));class He{constructor(e){this.logOp=new d({operationName:"MessageQueue",success:!0}),this.messageQueueLogCountLimiter=new z("MessageQueue"),this.queue=new qe.a(1e3),this.callbacks=e}clear(){this.queue.clear()}size(){return this.queue.length}push(e,t,n){const r=this.queue;if(1e3===r.length){this.messageQueueLogCountLimiter.log((()=>{this.logOp.resourceId="QueueFull",this.logOp.durationMs=0,p.a.warn(573187741,p.b.CoreDefault,this.logOp)}));const e=r.shift();e.onResponse&&e.onResponse(new se({error:Fe.DroppedAsOldestInQueue}))}r.push({message:e,onResponse:t,timeQueued:H.getCurrentTimeMs(),attemptNumber:n})}sendOnSessionInitialized(e){const t=this.queue.length;let n=0;if(t>0){const r=H.getCurrentTimeMs()-this.queue.get(0).timeQueued;for(;this.queue.length>0&&this.callbacks.canSendMessage();){const t=this.queue.shift();e&&t.message instanceof we&&S.matchesTypesFor(t.message,[we.getTypeName()])&&(!this.callbacks.dropOnlySequencedSyncsOnReseed||t.message.seq>=0)?(n++,t.onResponse&&t.onResponse(new se({error:Fe.ArrivedBeforeReseeding}))):t.message instanceof Uint8Array?this.callbacks.sendBytes(t.message):this.callbacks.sendMessage(t.message,t.onResponse,t.attemptNumber)}this.messageQueueLogCountLimiter.log((()=>{this.logOp.resourceId="SendOnSessionInitialized",this.logOp.resultDescription=`Queue size before: ${t}, after: ${this.queue.length}. droppedSyncMessages: ${n}`,this.logOp.durationMs=r,p.a.warn(573187742,p.b.CoreDefault,this.logOp)}))}}}!function(e){e[e.Initing=0]="Initing",e[e.Running=1]="Running",e[e.Disconnected=2]="Disconnected",e[e.Closed=3]="Closed"}(Be||(Be={}));const ze=(e,t,n,r)=>{t&&(t.cv||(t.cv=e.cvParent.newChild().toString()),e.messageEndpoint.sendMessage(t,((t,r)=>{t||S.getTypeNameFor(r)!==Oe.getTypeName()||(e.stats.lastSyncMessage=Date.now()),n&&n(t,r)}),void 0,r))},Ge=(e,t,n,r)=>{t&&(e.messageQueue.push(t,n,r),e.webSocketWorkerManager.init(void 0,e.customInitPromise).catch((e=>{const t=new d({operationName:"WorkerManagerInit",success:!1,resultDescription:`${e}`});p.a.error(509674973,p.b.CoreDefault,t)})))},Ve=(e,t)=>{t&&(e.messageQueue.push(t),e.webSocketWorkerManagenitPromise).catch((e=>{p.a.error(509674972,p.b.CoreDefault,`Init failed: ${e}`)})))};class $e{constructor(e){this.context=e}onEnter(e){}sendMessage(e,t,n,r){}sendBytes(e){}canSendMessage(){return!1}onConnectionClose(){}}class Qe extends $e{constructor(){super(...arguments),this.stateName=Be.Initing,this.possibleNextStates=[Be.Running,Be.Disconnected,Be.Closed]}sendMessage(e,t,n){S.matchesTypesFor(e,[ce.getTypeName()])?ze(this.context,e,t,n):Ge(this.context,e,t)}sendBytes(e){Ve(this.context,e)}onConnectionClose(){this.context.setState(Be.Disconnected)}}class Je extends $e{constructor(){super(...arguments),this.stateName=Be.Running,this.possibleNextStates=[Be.Disconnected,Be.Closed]}onEnter(e){e&&e.isSessionReseedingStarted&&this.context.res,n)}sendBytes(e){e&&this.context.webSocketWorkerManager.egressBytes(e)}canSendMessage(){return!0}onConnectionClose(){this.context.setState(Be.Disconnected)}}class Xe extends $e{constructor(){super(...arguments),this.stateName=Be.Disconnected,this.possibleNextStates=[Be.Initing,Be.Closed]}onEnter(e){this.context.messageEndpoint.cancelPendingResponseCallbacks()}sendMessage(e,t,n,r){if(S.matchesTypesFor(e,[ce.getTypeName()]))this.context.setState(Be.Initing),ze(this.context,e,t,n);else if(S.matchesTypesFor(e,[le.getTypeName()]))tlse{if(!r)return void Ge(this.context,e,t,n);t&&t(new se({messageId:e.messageId,error:Fe.DroppedBecauseClionstructor(){super(...arguments),this.stateName=Be.Closed,this.possibleNextStates=[]}onEnter(e){this.context.messageEndpoint.cancelPendingResponseCallbacks()}}var Ye=n("Wux9"),Ze=n("5f5u");const et=new class{constructor(e,t,n){if(this.requestInProgress=!1,this.queuedRequests=[],null==e)throw new Error("No request.");this.fetch=e,this.fetchTimeout=t,this.queueTimeout=n}tryProcessNextRequest(){if(this.requestInProgress=!1,this.queuedRequests.length>0){const[e,t,n]=this.queuedRequests.shift();clearTimeout(n),this.add(e,t)}}add(e,t){if(this.requestInProgress){const n=setTimeout((()=>{t(new Error("Timed out waiting in queue"),null),this.;this.queuedRequests.push([e,t,n])}else this.requestInProgress=!0,new Promise(((out((()=>{r=!0,n(new Error("Fetch timed out"))}),this.fetchTimeout);this.fetch(e).then((e=>{r||(clearTimeout(o),t(e))})).catch((e=>{r||(clearTimeout(o),n(e))}))})).then((e=>{t(null,e),this.tryProcessNextRequest()})).catch((e=>{t(e,null),this.tryProcessNextRequest()}))}}(Ze.fetch,2e4,12e4),tt=1e5;class nt{constructor(e){var t,n,r,o,i;this.logCountLimiter=new z(nt.className),this.hasBeenOpened=!1,this.lastPingTime=0,this.lastPongTime=0,this.lastEgressTime=0,this.emptyMessageId=0,this.egressMessageCount=0,this.egressByteCount=0,this.prevSeq=-1,this.remainingPingFailures=3,this.pendingQueue=[],this.egressBytesTotal=0,this.egressRateLogOp=new d({operationName:"WSEgressRate",success:!0}),this.egressLogOp=new d({operationName:"WSEgressControl",success:!0}).start(),this.egressedCache=new Map,this.rpsThreshold=null!==(t=null==e?void 0:e.rpsThreshold)&&void 0!==t?t:150,this.bpsThreshold=null!==(n=null==e?void 0:e.bpsThreshold)&&void 0!==n?n:5e8,this.pendingMaxSize=null!==(r=null==e?void 0:e.pendingMaxSize)&&void 0!==r?r:1e4,this.egressedMaxSize=null!==(o=null==e?void 0:e.egressedMaxSize)&&void 0!==o?o:1e4,this.egressedBytesMaxSize=null!==(i=null==e?void 0:e.egressedBytesMaxSize)&&void 0!==i?i:1e7}init(e,t,n){this.worker=e,this.ingress=t,this.clientMetadata=n,this.egressRateControlTimer=setInterval((()=>this.flush()),1e3)}ingressFromWebSocket(e){1===e.length&&e===nt.pingPongMessage?this.lastPongTime=Date.now():this.ingress(e,this.updateEgressedCache.bind(this))}open(){this.collectTelemetry(!0,"OnOpen"),this.hasBeenOpened=!0,this.egressRateControlIntervalStart=Date.now(),this.ping(),this.collectTelemetry(!0,"ping","initial ping"),this.flush(),this.pingInterval=setInterval((()=>{if(this.hasBeenOpened=this.lastPongTime>=this.lastPingTime&&this.lastPongTime-this.lastPingTime<=3e4,this.lastPongTime>this.lastEgressTime)return;const e=this.lastPongTime-this.lastPingTime;this.hasBeenOpened?(this.remainingPingFailures=3,this.collectTelemetry(!0,"ping","WebSocket channel active",[`${e}`,`${this.remainingPingFailures}`]),this.ping()):this.remainingPingFailures>0?(--this.remainingPingFailures,this.collectTelemetry(!0,"ping","Pong not received within 30000 ms",[`${e}`,`${this.remainingPingFailures}`]),this.ping()):(this.collectTelemetry(!1,"ping","Pong still not received after all retry attempts",[`${e}`,`${this.remainingPingFailures}`]),this.close())}),3e4)}close(){this..hasBeenOpened=!1,thisval(this.pingInterval),this.pingInterval=void 0),this.egressRateControlTimer&&(clearInterval(this.egressRateControlTimer),this.egressRateControlTimer=void 0)}ping(){this.lastPingTime=Date.now(),this.worker&&this.worker.egress(nt.pingPongMessage)}updateEgressedCache(e){this.egressedCache.has(e)&&(this.egressBytesTotal-=this.egressedCache.get(e),this.egressedCache.delete(e))}collectTelemetry(e,t,n,r){var o,i,s,a;this.egressLogOp.start(),this.egressLogOp.resultSignature=null!=t?t:"",this.egressLogOp.resultDescription=null!=n?n:"",this.egressLogOp.success=e,r?(this.egressLogOp.dimension0=null!==(o=r[0])&&void 0!==o?o:"",this.egressLogOp.dimension1=null!==(i=r[1])&&void 0!==i?i:"",this.egressLogOp.dimension2=null!==(s=r[2])&&void 0!==s?s:"",this.egressLogOp.dimension3=null!==(a=r[3])&&void 0!==a?a:""):(this.egressLogOp.dimension0="",this.egressLogOp.dimension1="",this.egressLogOp.dimension2="",this.egressLogOp.dimension3=""),this.logCountLimiter.log((()=>p.a.info(508954211,p.b.CoreDefault,this.egressLogOp.stop())))}egress(e,t,n){if(e instanceof ArrayBuffer&&this.worker)return void this.worker.egress(e);this.validateSyncMessage(t,n);const r=this.egressMessageCount>=this.rpsThreshold||this.egressByteCount>=this.bpsThreshold,o=this.egressBytesTotal>this.egressedBytesMaxSize||this.pendingQueue.length>this.pendingMaxSize||this.egressedCache.size>this.egressedMaxSize;if(r||o){let e="";e+=this.pendingQueue.length>=this.pendingMaxSize?"Pending queue max exceeded. ":"",e+=this.egressedCache.size>=this.egressedMaxSize?"Egressed cache max exceeded. ":"",e+=this.egressBytesTotal>this.egressedBytesMaxSize?"Egressed bytes max exceeded. ":"",e+=this.egressMessageCount>=this.rpsThreshold?"RPS exceeded. ":"",e+=this.egressByteCount>=this.bpsThreshold?"BPS exceeded. ":"",this.collectTelemetry(!1,e,`pendingQueueSize: ${this.pendingQueue.length} | egressedCacheSize: ${this.egressedCache.size} | egressedBytesTotal: ${this.egressBytesTotal} | rpsThreshold: ${this.rpsThreshold} | bpsThreshold: ${this.bpsThreshold}`)}else!this.hasBeenOpened||r||this.pendingQueue.length>0||o?this.pendingQueue.push({messageId:null!=t?t:"id"+this.emptyMessageId++,message:e}):this.sendToWebSocket(e,t)}sendToWebSocket(e,t){try{this.worker.egress(e);const n=e instanceof ArrayBuffer?e.byteLength:e.length;this.logEgressCount(n),this.lastEgressTime=Date.now(),t&&t.startsWith("c")&&(this.egressBytesTotal+=n,this.egressedCache.set(t,n))}catch(e){this.collectTelemetry(!1,"sendToWebSocket")}}flush(){for(;this.hasBeenOpened&&this.pendingQueue.length>0&&this.pendingQueue.length<this.pendingMaxSize&&this.egressedCache.size<this.egressedMaxSize&&this.egressMessageCount<this.rpsThreshold&&this.egressByteCount<this.bpsThreshold&&this.egressBytesTotal<this.egressedBytesMaxSize;){const{message:e,messageId:t}=this.pendingQueue.shift();this.sendToWebSocket(e,t)}}validateSyncMessage(e,t){void 0===t||void 0===e||t<=this.prevSeq||(t&&t!==this.prevSeq+1&&this.collectTelemetry(!0,"abandonedSyncMessage","Gap in sync message",[`${this.prevSeq}`,`${t}`,""+(t-this.prevSeq)]),this.prevSeq=t)}logEgressCount(e){var t;const n=Date.now();n-this.egressRateControlIntervalStart>1e3&&((this.egressMessageCount>50||this.egressByteCount>tt)&&(this.egressRateLogOp.start(),this.egressRateLogOp.resultDescription=this.egressMessageCount>50?"rps limit exceeded":"",this.egressRateLogOp.resultDescription=this.egressByteCount>tt?"bps limit exceeded":"",this.egressRateLogOp.dimension0=(n-this.egressRateControlIntervalStart).toString(),this.egressRateLogOp.dimension1=`${this.egressMessageCount}`,this.egressRateLogOp.dimension2=`${this.egressByteCount}`,p.a.info(509370642,p.b.CoreDefault,this.egressRateLogOp.stop())),"Production"!==(null===(t=this.clientMetadata)||void 0===t?void 0:t.releaseAudienceGroup)&&this.collectTelemetry(!0,"","egress",[`${0===this.pendingQueue.length?"0":this.pendingQueue.length.toString().length}`,`${0===this.egressedCache.size?"0":this.egressedCache.size.toString().length}`,`${0===this.egressBytesTotal?"0":this.egressBytesTotal.toString().length}`,`${this.rpsThreshold} | ${this.bpsThreshold}`]),this.egressRateControlIntervalStart=n,this.egressMessageCount=0,this.egressByteCount=0),this.egressMessageCount++,this.egressByteCount+=null!=e?e:0}}nt.pingPongMessage="~",nt.className="WebSocketRateController";class rt{constructor(e,t,n,r,o,i,s,a,c){this.logCountLimiter=new z(rt.className),this.isWorkerReady=!1,this.permanentlyClosed=!1,this.currentReconnectAttempt=0,this.lastInitializationAttemptTimeMs=0,this.offlineInterval=void 0,this.alreadyLoggedReconnectAttempt=!1,this.httpTestsLeft=5,this.httpTestsSuccessCount=0,this.wsOpenCount=0,this.testHttpConnection=e=>{const t=H.convertWebSocketUrlToHttp(this.globalUrl),n=!e,r=null!=e?e:new d({operationName:"HttpsTest",resourceId:t,success:!1,resultDescription:"",resultSignature:"HttpResponse:"}).start();!function(e,t,n){const r=new Ze.Request(e,t);et.add(r,n)}(t,{method:"POST",headers:{"content-type":"application/json","X-CorrelationId":r.cv},body:JSON.stringify(H.createHealthCheckRequest(this.clientMetadata))},((e,t)=>{e?(r.dimension1="HttpErr",r.resultDescription+=`HttpErr: ${e.message}`):t&&t.ok?(r.dimension1="HttpOK",this.leaveOfflineMode(),this.httpTestsSuccessCount++,n&&(r.success=!0)):(r.dimension1="HttpNoResp",r.resultDescription+=`HttpStatus: ${null==t?void 0:t.status}`),n&&r.stop(),this.logCountLimiter.log((()=>{p.a.info(558445283,p.b.CoreDefault,r)}))}))},this.globalUrl=e,this.clientMetadata=t,this.workerFactory=n,this.sessionInitializer=r,this.ingress=o,this.onConnectionClose=i,this.onDetectedWSBlock=s,this.closeWSBlockedSession=a.closeWSBlockedSessionEnabled,this.sessionOfflineModeEnabled=a.sessionOfflineModeEnabled,this.improvedWebSocketEnabled=a.improvedWebSocketEnabled,this.improvedWebSocketEnabled&&(this.websocketSettings=c)}init(e,t,n=!1){if(this.permanentlyClosed)return Promise.reject(new Error("permanentlyClosed"));if(this.isWorkerReady||this.pendingInitPromise)return this.pendingInitPromise?this.pendingInitPromise:Promise.resolve();this.extensionConfigs=e||this.extensionConfigs;const r=()=>{if(n||!this.alreadyLoggedReconnectAttempt){const e=n?rt.initialAttemptTimeout:rt.reconnectAttemptTimeout;this.connTimeout=setTimeout((()=>{const t=new d({operationName:"ConnectionFailingOrSlow",dimension0:n?"Initial":"Reconnect",dimension1:e.toString(),dimension2:this.currentReconnectAttempt.toString()});p.a.info(572838096,p.b.CoreDefault,t),this.alreadyLoggedReconnectAttempt=!n,this.connTimeout=void 0}),e)}};return t?this.pendingInitPromid({operationName:"WorkerManagerCustomInit",success:!1,resultDescription:`${e}`});p.a.error(572838097,p.b.CoreDefault,t)})).then((()=>{r(),this.initInternal()})):(this.pendingInitPromise=Promise.resolve(),r(),this.initInternal()),this.pendingInitPromise}egress(e){return!this.isWorkerReady&&this.pendingInitPromise?this.pendingInitPromise.then((()=>{this.eternal(e),Promise.resolve())}egressBytes(e){return!this.isWorkerReady&&this.pendingInitPromise?this.pendingInitPromise.then((()=>{this.egressBytesInternal(e)})):(this.egressBytesInternal(e),Promise.resolve())}close(e){this.isWorkerReady=!1,this.worker&&(this.worker.close(),this.worker=null),this.improvedWebSocketEnabled&&(this.websocketRateController&&this.getWebSocketRateController().close(),this.websocketRateController=null),this.permanentlyClosed=e||this.permanentlyClosed,this.permanentlyClosed&&(this.leaveOfflineMode(),clearTimeout(this.connTimeout))}initInternal(){if(this.isWorkerReady=!1,this.permanentlyClosed||this.isOffline()){const e=new d({operationName:"WorkerManagerInitOffline",success:!0,resultSignature:this.permanentlyClosed?"PermanentlyClosed":"Offline"});p.a.info(509134870,p.b.CoreDefault,e)}else this.currentReconnectAttempt>0?setTimeout((()=>{this.tryToConnectAndInitializeSession()}),((e,t)=>{let n=0;const r=H.getCurrentTimeMs()?H.getCurrentTimeMs()-t:0,o=[1e3,2e3,5e3,1e4,6e4];return n=o[Math.max(0,Math.min(o.length-1,e-1))],n=Math.max(n-r,1e3),n})(this.currentReconnectAttempt,this.lastInitializationAttemptTimeMs)):this.tryToConnectAndInitializeSession()}egressInternal(e){if(!this.isWorkerReady&&!S.matchesTypesFor(e,[ce.getTypeName()]))return void(S.matchesTypesFor(e,[ie.getTypeName()])||p.a.error(572838098,p.b.CoreDefault,new d({operationName:"UnexpectedEgressCall",resultDescription:`isWorkerReady: ${this.isWorkerReady}`})));let t;if(S.matchesTypesFor(e,[Ce.getTypeName()])?(this.castBinaryData(e),t=Ye.a.serialize(e)):t=JSON.stringify(e),this.improvedWebSocketEnabled){let n;we.typeGuard(e)&&(n=e.seq),this.getWebSocketRateController().egress(t,e.messageId,n)}else this.worker.egress(t)}egressBytesInternal(e){this.isWorkerReady?this.improvedWebSocketEnabled?this.getWebSocketRateController().egress(e):this.worker.egress(e):p.a.error(572838099,p.b.CoreDefault,new d({operationName:"UnexpectedEgressBytesCall",resultDescription:`isWorkerReady: ${this.isWorkerReady}`}))}tryToConnectAndInitializeSession(){this.currentReconnectAttempt++,this.lastInitializationAttemptTimeMs=H.getCurrentTimeMs();const e=t=>{this.permanentlyClosed||this.isOffline()||(this.connect(this.sliceUrl?this.sliceUrl:this.globalUrl),this.sessionInitializer.initSession({isTokenRefresh:!1,isReconnectOnSameSlice:!!this.sliceUrl,extensionConfigs:this.extensionConfigs,onResponse:(n,r)=>{if(t.success=!n,t.resultDescription=n?`WS Error: ${n.error}`:"",t.resourceId=r?r.sliceUrl:"",t.dimension0=t.success?"WSOK":"WSFail",n||!this.worker)return this.sliceUrl=void 0,this.close(),this.httpTestsLeft>0?(this.httpTestsLeft--,this.testHttpConnection(t.stop())):(this.closeWSBlockedSession&&0===this.wsOpenCount&&this.httpTestsSuccessCount>=5?(this.permanentlyClosed=!0,t.dimension1="WSBlocked",this.onDetectedWSBlock()):this.sessionOfflineModeEnabled&&0===this.httpTestsSuccessCount&&(this.startOfflineMode(),t.dimension1="WSOffline"),this.logCountLimiter.log((()=>{p.a.info(572838100,p.b.CoreDefault,t.stop())}))),void this.initInternal();if(this.logCountLimiter.log((()=>{p.a.info(555823373,p.b.CoreDefault,t.stop())})),r.forceReconnect){this.close();const t=new d({operationName:"ForcedReconnect"}).start();t.resultSignature=`globalUrl: ${this.globalUrl}. sliceUrl: ${this.sliceUrl}`,this.sliceUrl=void 0,setTimeout((()=>{e(t)}),1e3)}else clearTimeout(this.connTimeout),this.sliceUrl=r.sliceUrl,this.ready();this.resetHttpTestsC}getWebSocketRateController(){return this.websocketRateController||(this.websocketRateController=new nt(this.websocketSettings)),this.websocketRateController}connect(e){this.worker=this.workerFactory(),this.worker.init(e,this.improvedWebSocketEnabled?this.getWebSocketRateController().ingressFromWebSocket.bind(this.webs.wsOpenCount++,this.improvedWebSocketEnabled&&this.getWebSocketRateController().open(),this.leaveOfflineMode()}),(e=>{this.close(),this.onConnectionClosteController().init(this.worker,this.ingress,this.clientMetadata)}ready(){this.isWorkerReady=!0,this.pendingInitPromise=void 0,this.currentReconnectAttempt=0}castBinaryData(e){if(e){if(Array.isArray(e.__binaryMembers__))for(const t of e.__binaryMembers__)ArrayBuffer.isView(e[t])||(e[his.castBinaryData(e[t])}}isOffline(){return!!this.offlineInterval}startOfflineMode(){this.offlineInterval=setInterval((()=>{this.testHttpConnection()}),6e4)}leaveOfflineMterval=void 0,this.resetHttpTestsCounter(),this.tryToConnectAndInitializeSession())}resetHttpTestsCounter(){this.httpTestsLeft=5,this.httpTestsSuccessCount=0}}rt.initialAttemptTimeout=1e5,rt.reconnectAttemptTimeout=2e4,rt.className="WebSocketWorkerManager";class ot extends Ue.EventEmitter{constructor(e,t,n,r,o,i,s,a){super(),this.cvParent=new $,this.logOp=new d({operationName:"SessionState",success:!0}).start(),this.sessionStateChangeLogCountLimiter=new z("SessionState"),this.stats=t,this.allStates={[Be.Initing]:new Qe(this),[Be.Running]:new Je(this),[Be.Disconnected]:new Xe(this),[Be.Closed]:new Ke(this)},this.setState(Be.Initing),this.improvedWebSocketEnabled=s.improvedWebSocketEnabled,this.messageEndpointntMetadata(o),this.messageEndpoint.setEgress(this.egress.bind(this)),this.messageEndpoint.onMessage(le.getTypeName(),((e,t)=>{this.onSessionCloseMessage(e,t)})),this.webSocketWorkerManager=new rt(e,o,n,r,this.ingress.bind(this),this.onConnectionClose.bind(this),(()=>{this.onSessionClose(void messageQueue=new He({sendMessage:(e,t,n,r)=>this.state.sendMessage(e,t,n,r),sendBytes:this.sendBytes.bind(this),canSendMessage:()=>this.state.canSendMessage(),dropOnlySequencedSyncsOnReseed:s.dropOnlySequencedSyncsOnReseedEnabled}),r.on("connect",((e,t,n,r,o,i)=>{this.setState(Be.Runningonnect",e,n,r,o,i)})),r.on("recn("serverAuthenticationStateChange",(e=>this.emit("serverAuthenticationStateChange",e))),this.resetNextSyncSequenceId=()=>this.emit("resetNextSyncSequenceId"),this.tokenRefreshManager=i}setState(e,t,n){if(this.state&&e===this.state.stateName)return;const r=this.state?Be[this.state.stateName]:"undefined",o=this.state?this.state.possibleNextStates.indexOf(e)>=0:e===Be.Initing;this.sessionStateChangeLogCountLimiter.log((()=>{this.logOp.stop(),this.logOp.resourceId=`New state: ${o?Be[e]:r}`,this.logOp.resultDescription=`Previous state: ${r}`,this.logOp.dimension0=`Attempted state: ${Be[e]||"undefined"}`,this.logOp.resultSignature=t+(this.state&&!o?"Unexpected state change":""),this.logOp.success=o,p.a.info(573167323,p.b.CoreDefault,this.logOp)})),o&&(this.state=this.allStates[e],this.logOp.start(),this.state.onEnter(n))}InitPromise=t,this.webSocketWorkerManager.init(this.extensionConfigs,this.customInitPromise,!0)}sendMessage(e,t,n){this.retrySendMessage(e,t,ot.maxRetries,n)}sendBytes(e){this.state.sendBytes(e)}onMessage(e,t){this.messageEndpoint.onMessage(e,t)}getCorrelationVector(){return this.cvParent}forceReconnect(e){return this.extensionConfigs=e||this.extensionConfigs,this.webSocketWorkerManager.close(!1),new Promise((e=>setTimeout((()=>{e(this.webSocketWorkerManager.init(this.extensionConfigs))}),100)))}closeSession(){this.sendMessage(new le),this.webSocketWorkerManager.close(!0),this.onSessionClose(void 0,"ClientRequested")}ingress(e,t){let n;try{n=JSON.parse(e)}catch(e){p.a.error(573167324,p.b.CoreDefault,new re({sessionHealthEventName:"ProcessMessage",resourceId:"Unknown",success:!1,resultSignature:"ParseError",resultDescription:e.message,durationMs:0,source:X.ClientRuntime,reason:K.Client,impact:Y.MissingOutput,affectedWorkflows:["All"],message:""}))}this.improvedWebSocketEnabled&&t&&ie.typeGuard(n)&&t(n.messageId),n&&this.messageEndpoint.ingress(n,((e,t)=>this.egress(e||t,(()=>{}))))}egress(e,t){e&&this.webSocketWorkerManager.egress(e).then((()=>t())).catch((e=>t(e)))}onSessionCloseMessage(e,t){e.reconnectAllowed?this.webSocketWorkerManager.close():this.onSessionClose(e,"CloseMessageReceived"),t()}onSessionClose(e,t){this.setState(Be.Closed,t),this.tokenRefreshManager.clearAllTimeouts(),this.onConnectionClose(void 0),e&&this.emit("sessionClose",e)}onConnectionClose(e){this.state.onConnectionClose(),this.stats.lastConnectionClose=H.getCurrentTimeMs(),this.emit("disconnect",e)}retrySendMessage(e,t,n,r){this.state.sendMessage(e,((o,i)=>{o&&n>0&&this.canBeRetried(e)&&this.isTransientError(o)?this.retrySendMessage(e,t,n-1,r):t&&t(o,i)}),ot.maxRetries-n,r)}canBeRetried(e){return!S.matchesTypesFor(e,[ce.getTypeName(),Ce.getTypeName()])}isTransientError(e){const t=e.error;return t!==Z.SyncMessageUnsupportedBatch&&t!==Z.UnexpectedSeedMessage&&t!==Z.UnsupportedSyncMessage&&t!==Z.AnnotationTokenNotFound&&t!==Fe.ArrivedBeforeReseeding&&t!==Fe.DroppedAsOldestInQueue&&t!==Fe.DroppedBecauseClientDisconnected}}var it,st,at,ct,ut,lt,dt,ht,ft;ot.maxRetries=2,function(e){e[e.Idle=0]="Idle",e[e.Pending=1]="Pending"}(it||(it={}));class pt{constructor(e){S.assign(pt,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_WorkflowRegistrationMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return S.matchesTypesFor(e,[pt.getTypeName()])}}pt.H_={T_:pt.getTypeName(),B_:pt.getBaseTypes()};class mt{constructor(e){S.assign(mt,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionRequest"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return S.matchesTypesFor(e,[mt.getTypeName()])}}mt.H_={T_:mt.getTypeName(),B_:mt.getBaseTypes()};class gt{constructor(e){S.assign(gt,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return S.matchesTypesFor(e,[gt.getTypeName()])}}gt.H_={T_:gt.getTypeName(),B_:gt.getBaseTypes()};class vt{constructor(e){S.assign(vt,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_RuntimeInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return S.matchesTypesFor(e,[vt.getTypeName()])}}vt.H_={T_:vt.getTypeName(),B_:vt.getBaseTypes()};class bt{constructor(e){S.assign(bt,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_DiagnosticTraceMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return S.matchesTypesFor(e,[bt.getTypeName()])}}bt.H_={T_:bt.getTypeName(),B_:bt.getBaseTypes()};class yt{constructor(e){S.assign(yt,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_TelemetryMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return S.matchesTypesFor(e,[yt.getTypeName()])}}yt.H_={T_:yt.getTypeName(),B_:yt.getBaseTypes()};class wt{constructor(e){S.assign(wt,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_TelemetryFlushMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return S.matchesTypesFor(e,[wt.getTypeName()])}}wt.H_={T_:wt.getTypeName(),B_:wt.getBaseTypes()};class Ct{constructor(e){S.assign(Ct,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_SessionCloseResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return S.matchesTypesFor(e,[Ct.getTypeName()])}}Ct.H_={T_:Ct.getTypeName(),B_:Ct.getBaseTypes()};class Ot{constructor(e){S.assign(Ot,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_WorkflowDefinitionOverrideMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return S.matchesTypesFor(e,[Ot.getTypeName()])}}Ot.H_={T_:Ot.getTypeName(),B_:Ot.getBaseTypes()},function(e){e[e.JSWebSockets=0]="JSWebSockets",e[e.LocalWorkflowsOnly=1]="LocalWorkflowsOnly",e[e.HostWebSockets=2]="HostWebSockets"}(st||(st={})),function(e){e[e.None=0]="None",e[e.HttpsGetDownloadUrl=1]="HttpsGetDownloadUrl",e[e.AlCodedLocation=2]="AlCodedLocation"}(at||(at={})),function(e){e[e.NewDocument=0]="NewDocument",e[e.EditDocument=1]="EditDocument",e[e.ViewOnlyDocument=2]="ViewOnlyDocument"}(ct||(ct={}));class Tt{}Tt.lowerIndexBound=1,Tt.maxNumberOfRows=1048576,Tt.maxNumberOfColumns=16384,Tt.firstColumnName="A",Tt.lastColumnName="XFD",function(e){e[e.Unknown=0]="Unknown",e[e.LiveId=1]="LiveId",e[e.OrgId=2]="OrgId",e[e.ActiveDirectory=3]="ActiveDirectory",e[e.ADAL=4]="ADAL",e[e.SSPI=5]="SSPI",e[e.OAuth2=6]="OAuth2",e[e.Badger=7]="Badger"}(ut||(ut={})),function(e){e[e.Augloop=0]="Augloop",e[e.Substrate=1]="Substrate"}(lt||(lt={}));class St{constructor(e,t,n){this.sendMessage=e,this.annotationType=t,this.options=n,this.token=`${t}-${St.nextActivationResultBatchId++}`}activate(e,t){return new Promise(((n,r)=>{this.sendMessage(new fe({annotationType:this.annotationType,token:this.token,config:this.options?this.options.config:void 0,ignoreExistingAnnotations:e,sendStateUpdates:this.options?!!this.options.stateUpdateCallback:void 0}),((e,t)=>{e?r(new Error(e.error)):n({token:this.token})}),t)}))}release(){return new Promise(((e,t)=>{this.sendMessage(new ge({token:this.token}),((n,r)=>{n?t(new Error(n.error)):e(r.lastRelease)}))}))}}St.nextActivationResultBatchId=1,function(e){e[e.Input=0]="Input",e[e.Exception=1]="Exception",e[e.WaitOn=2]="WaitOn",e[e.StopAndFilterWorkflow=3]="StopAndFilterWorkflow"}(dt||(dt={})),function(e){e[e.Unknown=0]="Unknown",e[e.NoOutput=1]="NoOutput",e[e.Authentication=2]="Authentication",e[e.JoinTimedOut=3]="JoinTimedOut",e[e.LambdaThrow=4]="LambdaThrow",e[e.LambdaErrorCallback=5]="LambdaErrorCallback"}(ht||(ht={})),functio",e[e.BatchIntervalElapsed=2]="BatchIntervalElapsed"}(ft||(ft={}));class kt{constructor(e,t){this.batchesByGroupingKey=new Map,this.submit=e,this.onSummary=t}addBatchItem(e,t,n,r,o,i){const{delayMs:s,maxInputSize:a,estimateSize:c,groupingKeyExtractor:u}=t,l=c(e),d=u(e);if(t.split&&l>a){let s;try{s=t.split(e)}catch(e){const t=new Error("Split error: "+e.message);return void(i?i(t):p.a.error(573366352,p.b.CoreDefault,t))}if(s&&Array.isArray(s.inputs)&&s.inputs.length>1){let e;const a=[],c=i?(t,n)=>{if(e=e||t,a.push(n),a.length===s.inputs.length){let n;try{n=s.join(a)}catch(t){return void i(new Error("Join error: "+t.message))}i(e,n)}}:void 0;for(let e=0;e<s.inputs.length;e++)this.addBatchItem(s.inputs[e],t,n,r,o&&e===s.inputs.length-1,c);return}}let h=this.batchesByGroupingKey.get(d);h&&h.size+l>a&&(clearTimeout(h.timeout),this.executeBatch(d,h,t,ft.ExceedingMaxSize),h=void 0),h||(h={items:[],size:0,hasItemsWithCallbacks:!1,context:n},this.batchesByGroupingKey.set(d,h)),h.items.push({input:e,size:l,callback:i}),h.size+=l,h.hasItemsWithCallbacks=h.hasItemsWithCallbacks||!!i,h.cv=r,h.groupComplete=o,clearTimeout(h.timeout),h.groupComplete?this.executeBatch(d,h,t(()=>{this.executeBatch(d,h,t,ft.BatchIntervalElapsed)}),s)}removeAllBatchedItems(){this.batchesByGroupingKey.forEach((e=>{e.timeout&&clearTimeout(e.timeout)})),this.batchesByGroupingKey.clear()}executeBatch(e,t,n,r){this.batchesByGroupingKey.delete(e);const o=t.items,i=e=>e<0?"Negative":0===e?"0":1===e?"1":`Magnitude ${e.toString().length}`,s=new d({operationName:"ExecuteBatch",cv:t.cv,resourceId:t.context.name,dimension0:`Count ${i(o.length)}`,dimension1:`Size ${i(t.size)}`,dimension2:r.toString()}).start(),a=(e,n,r)=>{let i;if(n&&n.exceptionType===ht.NoOutput)s.success=!0,p.a.info(573366353,p.b.CoreDefault,s.stop());else{const r=`${e} error: ${n?n.message||n:"Unknown error"}`;i=n||new Error(r),s.success=!1,s.resultDescription=`Batch of ${o.length} items of size ${t.size} with ${r}`,s.resultSignature=`${e} Error`,p.a.error(573366354,p.b.CoreDefault,s.stop())}if(t.hasItemsWithCallbacks)for(const e of o)e.callback&&e.callback(i,r)};let c;try{c=n.multiplex(o.map((e=>e.input)))}catch(e){return void a("Multiplex",e)}this.submit(c.input,t,((e,r)=>{if(e||r&&("exceptionType"in r||r instanceof Error))a("Submit",e||r,r);else if(t.hasItemsWithCallbacks||n.summaryExtractor){let i,u,l;if(t.hasItemsWithCallbacks)try{if(i=c.demultiplex(r),i.length!==o.length)throw new Error("Mismatched output length")}catch(e){return void a("Demultiplex",e)}if(n.summaryExtractor)try{[l,u]=n.summaryExtractor(r)}catch(e){return void a("SummaryExtractor",e)}if(s.success=!0,p.a.info(573366342,p.b.CoreDefault,s.stop()),t.hasItemsWithCallbacks)for(let e=0;e<o.lenck(void 0,i[e]);u&&this.onSummary(l,u,t.context)}else s.success=!0,p.a.info(573366343,p.b.CoreDefault,s.stop())}))}}const Et=e=>_t(e,Number.POSITIVE_INFINITY),_t=(e,t)=>{let n=0;const r=[],o=[e];for(;o.length>0;){const e=o.pop(),i=typeof e;if("boolean"===i)n+=4;else if("string"===i)n+=2*e.length;else if("number"===i)n+=8;else if("object"===i&&e&&-1===r.indexOf(e))if(e instanceof Uint8Array)n+=e.length;else{r.push(e);for(const t in e)o.push(e[t])}if(n>t)return n}return n};var jt,It,Nt,At,Pt,ndle=30]="AmazonKindle",e[e.ShredderApp=31]="ShredderApp",e[e.FormsLowPrivilege=32]="FormsLowPrivilege",e[e.VivaSalesLowPrivilege=33]="VivaSalesLowPrivilege"}(It||(It={})),function(e){e[e.Unknown=0]="Unknown",e[e.Consumer=1]="Consumer",e[e.Enterprise=2]="Enterprise"}(Nt||(Nt={})),function(e){e.AuthorizationCode="authorization_code",e.ClientCredentials="client_credentials",e.RefreshToken="refresh_token"}(At||(At={})),function(e){e[e.SingleItem=0]="SingleItem",e[e.Reduce=1]="Reduce",e[e.Grid=2]="Grid",e[e.DynamicText=3]="DynamicText",e[e.Join=4]="Join",e[e.Generic=5]="Generic"}(Pt||(Pt={})),function(e){e[e.Default=0]="Default",e[e.LocalOnly=1]="LocalOnly",e[e.Exclusive=2]="Exclusive"}(xt||(xt={}))",e[e.DelayActivate=1]="DelayActivate",e[e.NeverActivate=2]="NeverActivate"}(Dt||(Dt={})),function(e){e[e.Required=-3]="Required",e[e.Optional=-1]="Optional"}(Lt||(Lt={})),function(e){e[e.Never=0]="Never",e[e.Always=1]="Always"}(Mt||(Mt={})),function(e){e[e.PreSeed=1]="PreSeed",e[e.OnSeed=2]="OnSeed",e[e.PostSeed=4]="PostSeed",e[e.All=5]="All"}(Rt||(Rt={})),function(e){e[e.UpstreamWorkflowsReady=0]="UpstreamWorkflowsReady",e[e.AnnotationMetadataUpdated=1]="AnnotationMetadataUpdated",e[e.DeltaUpdate=2]="DeltaUpdate",e[e.NonExclusiveTriggerSignals=3]="NonExclusiveTriggerSignals"}(Ft||(Ft={})),function(e){e[e.Character=1]="Character",e[e.Paragraph=2]="Paragraph"}(Bt||(Bt={})),function(e){e.Input="Input",e.Delta="Delta",e.UILanguage="UILanguage",e.MaxInputCount="MaxInputCount"}(Ut||(Ut={})),function(e){e.SetPredefinedAnnotation="SetPredefinedAnnotation",e.ClearAnnotations="ClearAnnotations"}(Wt||(Wt={}));const qt=(e,t)=>{concardinality)for(const e of r.contextTypes)n.push([e,r.cardinality,r.producerWaitPolicy]);return n},Ht=(e,t)=>Object.assign(Object.assign({},t),{parentPath:e}),zt=e=>Array.isArray(e)?5===e.length?`${e[0]}\\${e[1]}\\${e[2]}\\${e[3]}\\${e[4]}`:4===e.length?`${e[0]}\\${e[1]}\\${e[2]}\\${e[3]}`:3===e.length?`${e[0]}\\${e[1]}\\${e[2]}`:2===e.length?`path)";var Gt;!function(e){e[e.Local=0]="Local",e[e.External=1]="External"}(Gt||(Gt={}));class Vt{constructor(){this.graphNodeByLocationAndWorkflowId=new Map}getWorkflow(e,t){var n;const r=this.getLocation(t);return null===(n=this.graphNodeByLocationAndWorkflowId.get(r))||void 0===n?void 0:n.get(e)}addWorkflow(e,t=!1){if(this.getWorkflow(e.id,t)){const n=new d({operationName:"AddWorkflowToGraphFailure",success:!1,resourceId:e.id,resultDescription:`Adding a new with workflow with a duplicated workflowId: ${t}`}).start();return void p.a.error(524300630,p.b.CoreDefault,n.stop())}const n=this.getLocation(t),r=new $t(e,n);this.addWorkflowAsDependency(r);let o=this.graphNodeByLocationAndWorkflowId.get(n);o||(o=new Map,this.graphNodeByLocationAndWorkflowId.set(n,o)),o.set(e.id,r)}getUpstreamRuntimeVisibleWorkflows(){const e=[];for(const t of this.graphNodeByLocationAndWorkflowId.values()||[])for(const n of t.values()||[]){const t=this.createWorkflowDefinition(n.workflow);n.workflow.visibility===xt.LocalOnly?this.compressDownstreamWorkflows(t,n):t.outputTypes.push(...n.workflow.outputTypes),0!==t.inputTypes.length&&e.push(t)}return e}removeWorkflows(e){const t=this.getLocation(e),n=this.graphNodeByLocationAndWorkflowId.get(t),r=Array.from((null==n?void 0:n.values())||[]);for(const e of r){for(const t of e.upstreamWorkflows.values())t.downstreamWorkflows.delete(e);for(const t of e.downstreamWorkflows.values())t.upstreamWorkflows.delete(e);n.delete(e.workflow.id)}}getWorkflowsDefinitions(){const e=[];for(const t of this.graphNodeByLocationAndWorkflowId.values()||[])for(const n of t.values()||[])e.push(n.workflow) t=[];for(const e of this.graphNodeByLocationAndWorkflowId.values())for(const n of e.values())t.push(n);return t}getLocation(e){return e?Gt.External:Gt.Local}createWorkflowDefinition(e){return Object.assign(Object.assign({},e),{outputTypes:[]})}compressDownstreamWorkflows(e,t){for(const n of t.downstreamWorkflows)if(n.workflow.visibility!==xt.LocalOnly){if(n.workflow.kind!==Pt.Join||-1!==e.inputTypes.indexOf(n.workflow.collectionScopeType))for(const t of n.workflow.outputTypes)-1===e.outputTypes.indexOf(t)&&e.outputTypes.push(t)}else this.compressDownstreamWorkflows(e,n)}addWorkflowAsDependency(e){for(const t of this.graphNodeByLocationAndWorkflowId.values())for(const n of t.values()){for(const t of n.workflow.inputTypes)-1!==e.workflow.outputTypes.i.outputTypes)-1!==e.workflow.inputTypes.indexOf(t)&&this.addWorkflowChain(n,e)}}addWorkflowChain(e,t){e.downstreamWorkflows.add(t),t.upstreamWorkflows.add(e)}}class $t{constructor(e,t){this.upstreamWorkflows=new Set,this.downstreamWorkflows=new Set,this.location=t,this.workflow=Ond,visibility:e.visibility,collectionScopeType:e.collectionScopeType,inputTypes:e.inputTypes,outputTy&(e===t||0===t.indexOf(e)&&"."===t.charAt(e.length));class Xt{constructor(){this.workflowDefByWorkflowAndContextId=new Map,this.workflowDefByWorkflow=new Map}static mergeDefinitions(e,t,n){return Object.assign(Object.assign(Object.assign({},e),t),n)}mergeWorkflowDefinition(e,t,n){if(n){const r=((e,t,n)=>{let r=e.get(t);return r||(r=(()=>new Map)(),e.set(t,r)),r})(this.workflowDefByWorkflowAndContextId,e.id);r.set(n,Xt.mergeDefinitions(e,r.get(n),t))}else this.workflowDefByWorkflow.set(e.id,Xt.mergeDefinitions(e,this.workflowDefByWorkflow.get(e.id),t))}getWorkflowDefinition(e,t){var n;let r;return t&&(r=null===(n=this.workflowDefByWorkflowAndContextId.get(e.id))||void 0===n?void 0:n.get(t)),r||(r=this.workflowDefByWorkflow.get(e.id)),r||(r=e),r}deleteWorkflowDefinition(e,t){const n=this.workflowDefByWorkflowAndContextId.get(e.id);n&&(n.delete(t),getTypeName(),U.getTypeName()]);class Yt{constructor(e,t){this.nextId=1,this.runtimeKind=e,this.workflowGraph=t}static isParentContextId(e,t){return Jt(e,t)}applyContextIdOnOperations(e){for(const t of e){const e=S.getTypeNameFor(t);if(this.isSupportedOperation(e))for(const e of t.items)e.contextId?e.source&&this.workflowGraph.getWorkflow(e.source,!1)?e.contextId=this.addNewContextId(e.contextId):this.tryLogMessage(new d({operationName:"ApplyContextIdOnOperations",success:!0}).start(),"Item with a contextId but wixtId=this.addNewContextId()}}addNewContextId(e){const t=`${this.runtimeKind}${this.nextId++}`;return e?`${e}.${t}`:t}isSupported8633,p.b.CoreDefault,e"Executed"}(Zt||(Zt={}));class rn{constructor(e){this.scopeItemsByContextId=new Map,this.itemsByWorkflowAndContextId=new Map,this.workflowDefinitionManager=e}setScopeItem(e,t){var n;const r=e.contextId;if(r)if(this.itemsByWorkflowAndContextId.has(t.id)||this.itemsByWorkflowAndContextId.set(t.id,new Map),this.itemsByWorkflowAndContextId.get(t.id).set(r,[]),this.scopeItemsByContextId.has(r)){if(null===(n=this.itemsByWorkflowAndContextId.get(t.id))||void 0===n?void 0:n.has(r)){const n=new d({resultDescription:`Trying to set new scope item: ${e.id} with already existing contextId ${r} for workflow ${t.id}`,operationName:"WIS.setScopeItem",resourceId:t.id,success:!0}).start();p.a.verbose(527291288,p.b.CoreDefault,n.stop())}}else this.scopeItemsByContextId.set(r,e)}getScopeItem(e,t){var n;for(const r of(null===(n=this.itemsByWorkflowAndContextId.get(t.id))||void 0===n?void 0:n.keys())||[])if(Jt(r,e))return this.scopeItemsByContextId.get(r)}addItemToWorkflowList(e,t){const n=e.contextId;if(!n)return;const r=this.itemsByWorkflowAndContextId.get(t.id);if(r)for(const[o,i]of r)if(Jt(o,n)){i.push(e);const n=new d({resultDescription:`Items for contextId ${o}: [${i.map((e=>e.id)).join(",")}]`,operationName:"WIS.addItemOnContextIdList",resourceId:t.id,success:!0}).start();p.a.info(526403808,p.b.CoreDefault,n.stop())}}isWorkflowReady(e,t){const n=this.workflowDefinitionManager.getWorkflowDefinition(t,e).maxAnnotations;return this.getGeneratedItems(e,t).length>=n}getItemsToExecute(e,t){const n=this.getGeneratedItems(e,t);return this.itemsByWorkflowAndContextId.get(t.id).delete(e),n}onWorkflowExecuted(e,t){const n=e.contextId,r=this.itemsByWorkflowAndContextId.get(t.id);r&&(r.delete(n),0===r.size&&this.itemsByWorkflowAndContextId.delete(t.id)),this.hasWorkflowsAwaitingExecution(n)||this.scopeItemsByContextId.delete(n)}getGeneratedItems(e,t){var n;if(!(null===(n=this.itemsByWorkflowAndContextId.get(t.id))||void 0===n?void 0:n.get(e)))return[];const r=this.workflowDefinitionManager.getWorkflowDefinition(t,e).maxAnnotations;return this.itemsByWorkflowAndContextId.get(t.id).get(e).slice(0,r)}hasWorkflowsAwaitingExecution(e){for(const t of this.itemsByWorkflowAndContextId.values())for(const n of t.keys())if(n===e)return!0;return!1}}!function(e){e.JsClient="C",e.Server="S"}(en||(en={}));class on{constructor(e){S.assign(on,this,e)}static getTypeName(){return"AugLoop_Text_TextTile"}static getBaseTypes(){return[]}static typeGuard(e){return S.matchesTypesFor(e,[on.getTypeName()])}}on.H_={T_:on.getTypeName(),B_:on.getBaseTypes()};class sn{constructor(e){S.assign(sn,this,e)}static getTypeName(){return"AugLoop_Text_FormattedTextTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(e){return S.matchesTypesFor(e,[sn.getTypeName()])}}sn.H_={T_:sn.getTypeName(),B_:sn.getBaseTypes()};class an{constructor(e){S.assign(an,this,e)}static getTypeName(){return"AugLoop_Text_DynamicTextContext"}static getBaseTypes(){return["AugLoop_Core_DynamicContext"]}static typeGuard(e){return S.matchesTypesFor(e,[an.getTypeName()])}}an.H_={T_:an.getTypeName(),B_:an.getBaseTypes()};class cn{constructor(e){S.assign(cn,this,e)}static getTypeName(){return"AugLoop_Text_TaskTile"}static getBaseTypes(){return["AugLoop_Text_FormattedTextTile","AugLoop_Text_TextTile"]}static typeGuard(e){return S.matchesTypesFor(e,[cn.getTypeName()])}}cn.H_={T_:cn.getTypeName(),B_:cn.getBaseTypes()};class un{constructor(e){S.assign(un,this,e)}static getTypeName(){return"AugLoop_Text_PersonTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(e){return S.matchesTypesFor(e,[un.getTypeName()])}}un.H_={T_:un.getTypeName(),B_:un.getBaseTypes()};class ln{constructor(e){S.assign(ln,this,e)}static getTypeName(){return"AugLoop_Text_DateTile"}static getBate",e[e.Updat(tn={})),function(e){e[e.Chars=0]="Chars",e[e.Word=1]="Word",e[e.PartialSentence=2]="PartialSentence",e[e.Sentence=3]="Sentence",e[e.Paragraph=4]="Paragraph"}(nn||(nn={}));class dn{constructor(e){S.assign(dn,this,e)}static getTypeName(){return"AugLoop_Text_TextTileDelta"}static getBaseTypes(){return["AugLoop_Core_ItemDelta"]}static typeGuard(e){return S.matchesTypesFor(e,[dn.getTypeName()])},this,e)}static getTypeName(){return"AugLoop_Text_FormattedTextTileDelta"}static getBaseTypes(){return["AugLoop_Text_TextTileDelta","AugLoop_Core_ItemDelta"]}static typeGuard(e){return S.matchesTypesFor(e,[hn.getTypeName()])}}function fn(e,t=!1){switch(e){case 12288:case 8197:case 32:case 11:case 9:case 160:return!0;case 13:case 10:case 65532:return!t}return!1}function pn(e,t){return e.charCodeAt(t)>=56320&&e.charCodeAt(t)<=57343}hn.H_={T_:hn.getTypeName(),B_:hn.getBaseTypes()};var mn=n("OoM2"),gn=n.n(mn);const vn=/[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]/g,bn=/[.!?]/g;function yn(e,t){const n=[],r=Cn(e,t);return r&&n.push(r),n}function wn(e,t){const n=[],r=Cn(e,t);r&&n.push(r);const o=function(e,t,n){var r,o,i,s,a,c;if((null==e?void 0:e.ipPosition)!==(null==t?void 0:t.ipPosition)||(null==e?void 0:e.isColdIp)!==(null==t?void 0:t.isColdIp)){if((null==e?void 0:e.isColdIp)===(null==t?void 0:t.isColdIp)&&n)if(n.deltaType===tn.Add){if((null==t?void 0:t.ipPosition)===(null!==(r=n.position)&&void 0!==r?r:0)+(null!==(o=n.length)&&void 0!==o?o:0))return}else if(n.deltaType===tn.Update){if((null==t?void 0:t.ipPosition)===(null!==(i=n.position)&&void 0!==i?i:0)+(null!==(a=null===(s=n.content)||void 0===s?void 0:s.length)&&void 0!==a?a:0))return}else if(n.deltaType===tn.Delete&&(null==t?void 0:t.ipPosition)===(null!==(c=n.position)&&void 0!==c?c:0))return;return new hn({deltaType:tn.CursorUpdate,cursorData:{ipPosition:null==t?void 0:t.ipPosition,isColdIp:null==t?void 0:t.isColdIp}})}}(e,t,r);o&&n.push(o);const i=function(e,t,n){var r,o,i,s,a,c,u;const l=e,d=t;if((null===(r=d.formattedRanges)||void 0===r?void 0:r.length)<=(null===(o=l.formattedRangeh))if(n){let e=l.formattedRanges?[...l.formattedRanges]:[];const t=function(e,t,n){if(e){if(t.deltaType===tn.Add){const t=e.find((e=>e.start===n&&0===e.length));if(t)return t;n=Math.max(n-1,0)}return e.find((e=>0===e.length?e.start===n:e.start<=n&&n<e.start+e.length))}}(l.formattedRanges,n,n.position),r=t?e.indexOf(t):-1;if(-1!==r&&(n.position+(n.length||0)>t.start+t.length?t.length=n.position+(null!==(i=n.content)&&void 0!==i?i:"").length-t.start:t.length+=(null!==(s=n.content)&&void 0!==s?s:"").length-(n.length||0),e[r]=t),e.length>0){for(const t of e.slice(r+1))t.start<n.position||(n.position+(n.length||0)>t.start?(t.length=t.start+t.length-(n.position+(n.lenrt=n.position+(null!==(a=n.content)&&void 0!==a?a:"").length):t.start+=(null!==(c=n.content)&&void 0!==c?c:"").length-(n.length||0));e=e.filter((e=>e.length>0))}const o=null!==(u=null==d?void 0:d.formattedRanges)&&void 0!==u?u:[];if(gn()(e,o)||0===e.length&&0===o.length)return}else if(gn()(null==l?void 0:l.formattedRanges,null==d?void 0:d.formattedRanges))return;return new hn({deltaType:tn.FormattingUpdate,formattedRanges:null==d?void 0:d.formattedRanges})}(e,t,r);i&&n.push(i);const s=function(e,t){const n=e,r=t;let o;const i={};let s=!1;for(o in r)-1===["ipPosition","isColdIp","content","formattedRanges"].indexOf(o)&&(gn()(r[o],n[o])||(s=!0,i[o]=r[o]));if(s)return new hn({deltaType:tn.OtherNonContentUpdate,otherNonContentData:i})}(e,t);return s&&n.push(s),n}function Cn(e,t){const n=e.content,r=t.content,o=function(e,t,n=!1){let r,o,i={firstDiffLeft:0,firstDiffRight:t.length};return e.length<t.length?(r=e,o=t):(r=t,o=e),0===o.indexOf(r)?(i.firstDiffLeft=r.length,i.firstDiffRight=0):o.endsWith(r)?(i.firstDiffLeft=0,i.firstDiffRight=r.length):(i=function(e,t,n=!1){const r={firstDiffLeft:0,firstDiffRight:t.length};let o;for(o=0;o<e.length&&o<t.length;o+=1){const r=e.charCodeAt(o),i=t.charCodeAt(o);if(!(r===i||fn(r,n)&&fn(i,n)))break}for(r.firstDiffLeft=o,o=0;o<e.length&&o<t.length;o+=1){const r=e.charCodeAt(e.length-o-1),i=t.charCodeAt(t.length-o-1);if(!(r===i||fn(r,n)&&fn(i,n)))break}return r.firstDiffRight=o,r}(e,t,n),i.firstDiffLeft+i.firstDiffRight>r.length&&(i.firstDiffRight=r.length-i.firstDiffLeft)),function(e,t,n){if(e.firstDiffLeft>0){const r=e.firstDiffLeft<t.length&&pn(t,e.firstDiffLeft),o=e.firstDiffLeft<n.length&&pn(n,e.firstDiffLeft);(r||o)&&(e.firstDiffLeft-=1)}if(e.firstDiffRight>1){const r=e.firstDiffRight<t.length&&pn(t,t.length-e.firstDiffRight),o=e.firstDiffRight<n.length&&pn(n,n.length-e.firstDiffRight);(r||o)&&(e.firstDiffRight-=1)}}(i,e,t),i}(n,r),i=o.firstDiffLeft,s=n.length-o.firstDiffRight,a=r.length-o.firstDiffRight;let c,u=tn.Update;if(n.length!==r.length)s===i?(u=tn.Add,c=n[n.length-1]):a===i&&(u=tn.Delete,c=r[r.length-1]);else if(n===r)return;let l,d=0;switch(u){case tn.Update:d=s-i,l=r.substring(i,a);break;case tn.Add:l=r.substring(i,a);break;case tn.Delete:d=s-i,l=n.substring(i,s)}const h=function(e,t){const n=Array.from(e.matchAll(vn));if(vn.lastIndex=0,0===n.length)return nn.Chars;if(1===n.length){if(0===n[0].index)return t&&bn.test(t)?nn.Sentence:t&&!vn.test(t)?nn.Word:nn.Chars;if(n[0].index+1===e.length)return bn.test(e[n[0].index-1])?nn.Sentence:vn.test(e[n[0].index-1])?nn.Chars:nn.Word;if(e[n[0].index-1]){const t=e[n[0].index-1];if(bn.test(t))return nn.Sentence;if(vn.test(t))return nn.Chars}return nn.Word}const r=Array.from(e.matchAll(bn));return bn.lastIndex=0,0===r.length?nn.PartialSentence:r.length>1?nn.Paragraph:r[0].index+1<=e.length?vn.test(e[r[0].index+1])?nn.Sentence:nn.Paragraph:void 0}(l,c);if(void 0!==h)return new hn({content:u!==tn.Delete?l:void 0,deltaType:u,unit:h,position:i,length:u!==tn.Add?d:0})}class BuilderHandler(on.getTypeName(),yn),this.registerDeltaBuilderHandler(sn.getTypeName(),wn)}registerDeltaBuilderHandler(e,t){this.deltaBuilderHandlers.set(e,t)}executeDeltaBuilderHandler(e,t,n){const r=this.deltaBuilderHandlers.get(e);return r?r(t,n):[]}}const Tn=(e,t)=>t?`${t.join("\\")}-${e}`:e;class Sn{constructor(){this.createTextTileDeltasFromItem=(e,t)=>{var n;const r=new d({operationName:"CreateTextTileDeltaFromItem",success:!0}).start();try{if(!e)return r.success=!1,r.resultDescription="Unable to create text tile delta, parent item is undefined",void p.a.info(524883085,p.b.CoreDefault,r.stop());if(!e.body)return r.success=!1,r.resultDescription="Unable to create text tile delta, parent item has undefined body",void p.a.info(524883086,p.b.CoreDefault,r.stop());const o=e.body;if(!on.typeGuard(o))return r.success=!1,void(r.resultDescription=`Unable to create text tile delta, parent item body is not proper type: expected ${on.getTypeName()}, received ${S.getTypeNameFor(o)}`);const i=Tn(e.id,t),s=null!==(n=this.lastSeenTileByTileId.get(i))&&void 0!==n?n:new on({content:""}),a=this.createDeltas(s,o);return a&&0!==a.length?(r.dimension0=a.length.toString(),this.lastSeenTileByTileId.set(i,o)):(r.dimension0="0",r.resultDescription="No delta differences found"),p.a.info(524883087,p.b.CoreDefault,r.stop()),a}catch(e){return r.success=!1,r.resultDescription=`Error creating text tile delta: ${e}`,void p.a.info(524883088,p.b.CoreDefault,r.stop())}},this.lastSeenTileByTileId=new Map,this.deltaBuilder=new On}addItemToLocalMap(e,t){const n=Tn(e.id,t),r=e.body;on.typeGuard(r)&&!this.lastSeenTileByTileId.has(n)&&this.lastSeenTileByTileId.set(n,r)}deleteItemFromLocalMap(e,t){const n=Tn(e.id,t);this.lar(t),e,t)}===e?t:3&t|8)Workflow",e[e.ServerWorkflow=1]="ServerWorkflow",e[e.Submitted=2]="Submitted"}(En||(En={})),function(e){e[e.Internal=0]="Internal",e[e.External=1]="External"}(_n||(_n={}));const jn=(e,t)=>{t?(e.resultDescription=t,e.success=!1,p.a.error(509203144,p.b.CoreDefault,e.stop())):p.a.info(509203143,p.b.CoreDefault,e.stop())};class In{constructor(e){var t;this.annotationActivationTrackers=new Map,this.annotationCallbacks=new Map,this.annotationResultStates=new Map,this.tokensByAnnotationType=new Map,this.registeredContextTypes=new Set,this.availableContexts=new Map,this.nextSyncSequenceId=1,this.allowSeed=!0,this.allowGroupSeed=!0,this.seedGroupSize=0,this.hasSessionConnected=!1,this.isSessionClosed=!1,this.serverAuthenticationState=jt.NotAuthenticated,this.workflowGraph=new Vt,this.workflowDefinitionManager=new Xt,this.contextIdManager=new Yt(en.JsClient,this.workflowGraph),this.workflowItemStorage=new rn(this.workflowDefinitionManager),this.graphInitMessageTimer=!1,this.pendingConnectCallbacks=[],this.hostCallbacks=e.hostCallbacks,this.sessionManager=e.sessionManager,this.operationBatchConfig=e.batchOptions?this.getOperationBatchConfig(e.batchOptions):void 0,this.extensionConfigs=e.extensionConfigs,this.clientMetadata=e.clientMetadata,this.userContext=e.userContext,this.localWorkflowManager=e.localWorkflowManager,this.annotationResultsProcessor=e.annotationResultsProcessor,e.workflowRuntimeFactory&&(this.workflowRuntime=e.workflowRuntimeFactory(this.sessionManager)),this.localRegisteredWorkflows=e.localRegisteredWorkflows||[],this.skipGraphInitOnWorkflowRegistration=e.skipGraphInitOnWorkflowRegistration,this.enableRemoteExecutionNotification=e.enableRemoteExecutionNotification||!1,this.networkMode=e.networkMode,this.egress=e.egress,this.serverAuthenticationStateChangeCallback=[],this.sessionManager.on("sessionClose",this.onSessionClose.bind(this)),this.sessionManager.on("reconnect",this.onReconnect.bind(this)),this.sessionManager.on("connect",this.onConnect.bind(this)),this.sessionManager.on("disconnect",this.onDisconnect.bind(this)),this.sessionManager.on("resetNextSyncSequenceId",this.resetNextSyncSequenceId.bind(this)),this.sessionManager.on("serverAuthenticationStateChange",this.onServerAuthenticationStateChange.bind(this)),this.sessionManager.onMessage(Se.getTypeName(),this.workflowRuntime?this.onAnnotationResultsFromLocal.bind(this):this.onAnnotationResultsFromServer.bind(this)),this.sessionManager.onMessage(me.getTypeName(),this.onAnnotationResultStateMessage.bind(this)),this.sessionManager.onMessage(Ne.getTypeName(),this.onWorkflowExecutionCompleteMessage.bind(this)),e.isDeltaGeneratorEnabled&&(this.enableSyncDeltaSending=!e.disableSyncDeltaSending,this.syncDeltaTimeout=null!==(t=e.syncDeltaTimeout)&&void 0!==t?t:700,this.enableDeltaGenerator())}initialize(){return this.localWorkflowManager&&this.localWorkflowManager.addSession(this),this.registerLocalWorkflows(this.localRegisteredWorkflows),this.sessionManager.init(this.extensionConfigs,this.hostCallbacks.onInitSession?this.hostCall()=>(this.localWorkflowManager&&this.localWorkflowManager.setTokenCallback(this.getAuthToken.bind(this)),this)))}get isConnected(){return!!this.connectParams}get hasConnected(){return this.hasSessionConnected}get isClosed(){return this.isSessionClosed}getServerAuthenticationState(){return this.serverAuthenticationState}getContextIdManager(){return this.contextIdManager}getWorkflowItemStorage(){return this.workflowItemStorage}getWorkflowDefinition(e,t){return this.workflowDefinitionManager.getWorkflowDefinition(e,t)}registerLocalWorkflows(e){if(e.length){if(this.workflowRuntime)for(const t of e)this.workflowRuntime.registerWorkflow(t),this.sendMessageToSession(new pt({workflowDefinition:t}));if(this.localWorkflowManager)for(const t of e)this.localWorkflowManager.registerLocalWorkflow(t,this);this.trySendWorkflowGraphInitMessage()}}registerLocalWorkflow(e){this.registerLocalWorkflows([e]);const t=new d({operationName:"SessionRegisterLocalWorkflow",resourceId:e.id,success:!0}).setClientMetadata(this.clientMetadata).start();jn(t)}activateAnnotation(e,t){var n;const r=new St(this.sendMessageToSession.bind(this),e,t);if(t&&t.callback){let n=this.annotationCallbacks.get(e);n||(n=new Map,this.annotationCallbacks.set(e,n)),n.set(r.token,t.callback)}const o=null!==(n=this.tokensByAnnotationType.get(e))&&void 0!==n?n:[];return-1===o.indexOf(r.token)&&o.push(r.token),this.tokensByAnnotationType.set(e,o),this.annotationActivationTrackers.set(r.token,r),this.activateAnnotationForTracker(r,{ignoreExistingAnnotations:!1,sendOnlyIfConnected:!1})}activateAnnotationForTracker(e,t){const n=new d({operationName:"ActivateAnnotation",resourceId:e.annotationType,success:!0}).setClientMetadata(this.clientMetadata).start();return e.activate(t.ignoreExistingAnnotations,t.sendOnlyIfConnected).then((r=>(n.resultSignature="Ok",n.resultDescription=`Activated annotation ${e.annotationType} with token ${e.token}; sendOnlyIfConnected: ${t.sendOnlyIfConnected}`,jn(n),r))).catch((r=>{throw jn(n,`error on activate annotation type ${e.annotationType}: ${r}; sendOnlyIfConnected: ${t.sendOnlyIfConnected}`),r}))}updateAnnotationConfig(e,t){const n=new be({token:e,config:t});this.sendMessageToSession(n);const r=this.annotationActivationTrackers.get(e);r&&r.options&&(r.options.config=t)}releaseAnnotation(e){const t=this.annotationActivationTrackers.get(e);if(t){this.annotationActivationTrackers.delete(e);const n=this.annotationCallbacks.get(t.annotationType);return n&&(n.delete(e),0==n.size&&this.annotationCallbacks.delete(t.annotationType)),t.release()}return Promise.resolve(!1)}setAnnotationState(e,t,n){this.submitOperation(_:{state:n}}))}setAnnotationMetadata(e,t,n){this.submitOperation(new D({parentPath:e,items:[{id:t}],M_:n}))}submitOperation(e,t){this.submitOperations([e],t)}submitOperations(e,t){this.contextIdManager.applyContextIdOnOperations(e),this.updateWorkflowExecutionStates(e);const n=e.filter(this.filterOperationsForSession.bind(this));if(this.workflowRuntime)return void this.submitOperationsToSession(n,t);const r=[];if(this.deltaGenerator){const e=new d({operationName:"ExecuteDeltaGenerator",success:!0}).setClientMetadata(this.clientMetadata).start();for(const e of n)if(L.typeGuard(e))r.push(...this.createDeltasFromUpdateOperation(e));else{const t=e;for(const n of t.items)P.typeGuard(e)?this.deltaGenerator.addItemToLocalMap(n,t.parentPath):M.typeGuard(e)&&this.deltaGenerator.deleteItemFromLocalMap(n,t.parentPath);r.push(e)}jn(e)}this.submitOperationsToSession(r.length?r:n,t),this.localWorkflowManager&&this.localWorkflowManager.runLocalWorkflows(e,this,!0)}submitSeedOperations(e,t){if(!this.allowSeed)throw new Error("Cannot submit seed operations more than once per session");this.networkMode===st.LocalWorkflowsOnly&&this.localWorkflowManager?this.localWorkflowManager.runLocalWorkflows(e,this):(this.allowSeed=!1,this.allowGroupSeed=!1,this.operationBatchConfig?this.sendSeedMessagesViaBatchManager(e,!0,t):this.sendMessageToSession(new we({cv:t,seq:0,ops:e})))}submitSeedGroupOperations(e,t,n){if(!this.allowGroupSeed)throw new Error("Seed operations are not allowed for this session");this.networkMode===st.LocalWorkflowsOnly&&this.localWorkflowManager?this.localWorkflowManager.runLocalWorkflows(e,this):(t&&(this.allowGroupSeed=!1),this.allowSeed=!1,this.operationBatchConfig?this.sendSeedMessagesViaBatchManager(e,!!t,n):(this.seedGroupSize++,this.sendMessageToSession(new we({cv:n,seq:0,ops:e,groupId:"Seed",groupSize:t?this.seedGroupSize:void 0,groupComplete:t||void 0}))))}submitCustomMessage(e){return new Promise(((t,n)=>{this.sendMessageToSession(e,((e,r)=>{e?n(new Error(e.error)):t(r)}))}))}submitLargeBinaryDataMessage(e){return new Promise(((t,n)=>{this.sendMessageToSessionPostEndpoint(e,((e,r)=>{e?n(new Error(e.error)):t(r)}))}))}requestBinaryDataForBlob(e){return e(e.data):e.dataPointer&&e.dataPointer.refType!==at.None?new Promise(((t,n)=>{this.requestBinaryDataFromSessionBlobEndpoint(e.dataPointer,((e,r)=>{e?n(e):t(re){if(e)throw new Error("NYI");return this.submitCustomMessage(new de)}forceReconnect(e){return this.extensionConfigs=e,this.sessionManager.forceReconnect(e)}close(){this.isSessionClosed=!0,this.sessionManager.closeSession(),this.workflowRuntime&&this.workflowRuntime.close(),this.localWorkflowManager&&this.localWorkflowManager.closeSession(this)}getClientMetadata(){return this.clientMetadata}getUserContext(){return this.userContext}setSessionCloseCallback(e){this.sessionCloseCallback=e}setConnectCallback(e){this.cthis.reconnectCallback=e}setServerAuthenticationStateChangeCallback(e){this.serverAuthenticationStateChangeCallback.push(e),e(this.serverAuthenticationState)}onAnnotationResults(e,t,n){p.a.info(508916486,p.b.CoreDefault,new d({operationName:"OnAnnotationResultsEgress",dimension0:null==e?void 0:e.annotationType,success:!0})),n(void 0,new ie),t===En.LocalWorkflow&&this.contextIdManagteWorkflowExecutionStates(e.ops),this.egress&&this.egress(e,(()=>{})),this.annotationResultsProcessor.process(e,((e,n)=>{this.applyOperationForContext(e,n,t)}),(t=>{if(this.callAnnotationCallbacks(t,e.annotationType),this.hostCallbacks.onAnnotationResult)try{this.hostCallbacks.onAnnotationResult(t)}catch(e){p.a.error(540301151,p.b.CoreDefault,`onAnnotationResult error: ${e}`)}}),(e=>{if(t!==En.ServerWorkflow){const t=e.ops.filter(this.filterOperationsForSession.bind(this));this.submitOperationsToSession(t,e.cv)}this.localWorkflowManager&&this.localWorkflowManager.runLocalWorkflows(e.ops,this)}))}onAnnotationResultStateMessage(e,t){var n;t(void 0,new ie);for(const t of e.updates){const{annotationType:e,state:r}=t;if(!this.tokensByAnnotationType.has(e))continue;let o;o=this.annotationResultStates.has(e)?this.annotationResultStates.get(e):r===it.Idle?it.Pending:it.Idle;for(const t of this.tokensByAnnotationType.get(e)){const e=this.annotationActivationTrackers.get(t);(null===(n=e.options)||void 0===n?void 0:n.stateUpdateCallback)&&e.options.stateUpdateCallback(o,r)}}}submitOperationsToSession(e,t){const n=e.filter((e=>q.typeGuard(e))),r=e.filter((e=>!q.typeGuard(e)));n.length>0&&this.sendMessageToSession(new we({cv:t,ops:n})),r.length>0&&(this.operationBatchConfig?(this.batchedOperationsManager||(this.batchedOperationsManager=new kt(((e,t,n)=>{this.sendMessageToSession(new we({cv:t.cv,seq:this.nextSyncSequenceId++,ops:e}),(e=>{n(e?new Error(e.error):void 0)}))}))),this.batchedOperationsManager.addBatchItem(r,this.operationBatchConfig,{name:"SubmitOperations"},t)):this.sendMessageToSession(new we({cv:t,seq:this.nextSyncSequenceId++,ops:r})))}sendMessageToSession(e,t){this.sessionManager.sendMessage(e,t),le.typeGuard(e)&&this.close()}sendMessageToSessionPostEndpoint(e,t){if(this.connectParams)this.sendLargeBinaryDataMessage(this.connectParams,e,t);else{const n=(n=>this.sendLargeBinaryDataMessage(n,e,t)).bind(this);this.penuestBinaryDataFromSessionBlobEndpoint(e,t){if(this.connectParams)this.requestBinaryData(this.connectParams,e,t);else{const n=(n=>this.requestBinaryData(n,e,t)).bind(this);this.pendingConnectCallbacks.push(n)}}registerContextTypes(e){for(const t of e)this.activateAnnotation(t),this.registeredContextTypes.add(t)}applyOperationForContext(e,t,n){let r=S.getTypeNameFor(e);if(r!=P.getTypeName()&&r!=N.getTypeName()&&r!=L.getTypeName()&&r!=M.getTypeName())return;r==N.getTypeName()&&(r=P.getTypeName());const o=Ht(this.resolvePlaceholdersInOperationParentPath(e.parentPath),t),i=zt(o.parentPath);if(r==P.getTypeName()||r==L.getTypeName()){if(!o.body)return;const e=S.getTypeNameFor(o.body);if(!this.registeredContextTypes.has(e))return;let t=this.availableContexts.get(e);t||(t=new Map,this.availableContexts.set(e,t));let s=t.get(n);if(s||(s=[],t.set(n,s)),!o.id){if(this.workflowRuntime)throw new Error("Expected item to have id already");this.localWorkflowManager&&(o.id=this.localWorkflowManager.getNextClientAnnotationId())}if(r==P.getTypeName())0==s.filter((e=>zt(e.parentPath)==i&&e.id==o.id)).length?s.push(o):p.a.info(540848911,p.b.CoreDefault,`AddOperation for (${n}, ${o.id}, ${o.source}) can't be applied as the context item with matching path and ID already exists. Use UpdateOperation instead.`);else for(let e=0;e<s.length;e++)if(s[e].id==o.id&&zt(s[e].parentPath)==i){if(s[e].source==o.source){s[e]=o;break}p.a.warn(540848912,p.b.CoreDefault,`UpdateOperation for (${n}, ${o.id}, ${o.source}) can't be applied as the context item with provided path and ID has different source: ${s[e].source}`)}else p.a.warn(540848913,p.b.CoreDefault,`UpdateOperation for (${n}, ${o.id}, ${o.source}) can't be applied as the context item with matching path and ID was not found. AddOperation should be used instead`)}else if(r==M.getTypeName()){if(!o.id)return;this.availableContexts.forEach(((e,t)=>{let r=e.get(n);r&&(r=r.filter((e=>!(zt(e.parentPath)==i&&e.id==o.id))),0==r.length?e.delete(n):e.set(n,r),0==e.size?this.availableContexts.delete(t):this.availableContexts.set(t,e))}))}}updateWorkflowExecutionStates(e){if(this.localWorkflowManager){const t=this.enableRemoteExecutionNotification?this.workflowGraph.getWorkflowNodes().map((e=>e.workflow)):this.localWorkflowManager.getAllRegisteredWorkflowsFromSession(this);for(const n of e)if(Kt.has(S.getTypeNameFor(n)))for(const e of n.items)for(const n of t||[])this.localWorkflowManager.preProcessItemToWorkflow(n,e,this)}}resolveRequestedContexts(e){const t=[];for(const[n,r,o]of qt(e.requestedContextTypesRules)){if(!this.availableContexts.has(n)){if(r==Lt.Required)return[!1,[]];continue}const e=Array.from(this.availableContexts.get(n).values()).reduce(((e,t)=>e.concat(t)),[]);if(0==e.length)throw new Error(`Assert: availableContexts have the entry for ${n} which does not contain any context annotation.`);t.push(...e)}return[!0,t]}getContextAnnotations(e,t,n,r){var o,i;const s=n?zt(n):void 0;return null===(i=null===(o=this.availableContexts.get(e))||void 0===o?void 0:o.get(t))||void 0===i?void 0:i.filter((e=>!(s&&zt(e.parentPath)!=s||r&&e.source!=r)))}onWorkflowDefinitionOverrideMessage(e){const t=new d({operationName:"WorkflowDefinitionOverride",success:!0}).setClientMetadata(this.clientMetadata).start(),n=e=>{throw jn(t,e),Error(`WorkflowDefinitionOverride: ${e}`)};if(!this.localWorkflowManager)return void n("Not supported by this local SessionProxy instance.");const r=this.localWorkflowManager.getWorkflowDefinitionsByName(this),o=r.get(e.sourceWorkflowId);if(!o)return void n(`Workflow registration for source workflow '${e.targetWorkflowId}' was not found.`);t.resourceId=o.id;const i=r.get(e.targetWorkflowId);i&&(i.allowDefinitionOverride?o.definitionOverrideTargetWorkflows&&-1!==o.definitionOverrideTargetWorkflows.indexOf(i.id)?(this.workflowDefinitionManager.mergeWorkflowDefinition(i,e.definition,e.contextId),t.resultDescription=`Updated config for workflow: ${e.targetWorkflowId}, context id: ${e.contextId}`,jn(t)):n(`Workflow '${o.id}' does not allow workflow definition for workflow '${i.iations(e){this.contextIdManager.applyContextIdOnOperations(e)}attachToWorkflowGraph(e){this.addToWorkflowGraph(e),this.attachExecutionTrackerToEachWorkflow()}attachExecutionTrackerToEachWorkflow(){this.localWorkflowManager&&this.localWorkflowManager.attachExecutionTrackerToEachWorkflow(this.workflowGraph,this,this.onWorkflowExecutionComplete.bind(this))}onWorkflowExecutionCompleteMessage(e,t){t(void 0,new ie),this.localWorkflowManager&&this.localWorkflowManager.onExternalWorkflowExecuted(e.contextId,e.workflowId,this)}onWorkflowExecutionComplete(e,t){}enableDeltaGenerator(){var e,t;this.deltaGenerator=null!==(e=this.deltaGenerator)&&void 0!==e?e:new Sn,this.syncDeltaTimers=null!==(t=this.syncDeltaTimers)&&void 0!==t?t:new Map}createDeltasFromUpdateOperation(e){var t,n;const r=[];p.a.info(523776396,p.b.CoreDefault,`Calling delta create for UpdateOperation under parent path [${e.parentPath}] (${null===(t=e.items)||void 0===t?void 0:t.length} item(s), first item id: ${(null===(n=e.items)||void 0===n?void 0:n.length)>0?e.items[0].id:"(no items)"})`);let o=[...e.parentPath];for(const t of e.items){const n=[],i=this.deltaGenerator.createTextTileDeltasFromItem(t,e.parentPath);if(null==i?void 0:i.length){for(const r of i){const i=kn();o=[...e.parentPath,t.id],n.push({id:i,revId:t.revId,body:r,contextId:t.contextId,source:t.source})}n.length>0&&(r.push(new U({parentPath:o,items:n})),this.enableSyncDeltaSending&&this.setupSyncDeltaAfterDelay(t,o,n))}else p.a.info(523329632,p.b.CoreDefault,`Failed to create delta on item ${t.id}`)}reers.get(e.id);s&&(clearTimeout(s),this.syncDeltaTimers.delete(e.id));const a=n.find((e=>{var t;return(null===(t=e.body)||void 0===t?void 0:t.unit)===nn.Chars}));if(a){const n=a.body,s={content:"",deltaType:tn.Update,length:0,position:(null!==(r=null==n?void 0:n.position)&&void 0!==r?r:0)+(null!==(i=null===(o=null==n?void 0:n.content)||void 0===o?void 0:o.length)&&void 0!==i?i:0),unit:nn.Sentence},c=sn.typeGuard(e.body)?new hn(s):new dn(s),u={id:kn(),revId:e.revId,body:c,contextId:e.contextId,source:e.source},l=new U({parentPat,this.syncDeltaTimers.delete(t)}),this.syncDeltaTimeout,l,e.id);this.syncDeltaTimers.set(e.id,d)}}addToWorkflowGraph(e){this.workflowGraph.addWorkflow(Qt(e))}getAuthToken(e,t){const n={Tickets:[]};this.clientMetadata.docSessionId&&(n.DocSessionId=this.clientMetadata.docSessionId);const r=(e=>{if(e===It.Substrate)return lt.Substrate})(e);r&&(n.TokenType=r),this.hostCallbacks.requestAuthToken(n).then((n=>{var r;n?t(void 0,n.Token,{returnedTokenType:e,timeToLiveSec:null===(r=n.TokenProperties)||void 0===r?void 0:r.timeToLiveSec}):t(new Error("Missing AuthTokenResponse from requestAuthToken"))})).catch((e=>t(e)))}resetNextSyncSequenceId(){this.nextSyncSequenceId=1}onReconnect(){if(this.annotationActivationTrackers.forEach((e=>{this.activateAnnotationForTracker(e,{ignoreExistingAnnotations:!0,sendOnlyIfConnected:!0}).catch((()=>{}))})),this.reconnectCallback&&this.reconnectCallback(),!this.connectParams)throw new Error("Expected onConnect before onReconnect")}onSessionClose(e){this.isSessionClosed=!0,this.connectParams=void 0,this.sessionCloseCallback&&this.sessionCloseCallback(e)}onConnect(e,t,n,r,o){this.hasSessionConnected?e&&(this.allowSeed=!0,this.allowGroupSeed=!0,this.seedGroupSize=0,this.seedBatchedOperationsManager&&(this.seedBatchedOperationsManager.removeAllBatchedItems(),this.seedBatchedOperationsManager=void 0),this.batchedOperationsManager&&(this.batchedOperationsManager.removeAllBatchedItems(),this.batchedOperationsManager=void 0)):this.sendWorkflowGraphInitMessage(),this.connectParams={isSeedingRequired:e,sessionUrl:t,origin:n,authToken:r},this.hasSessionConnected=!0;for(const e of this.pendingConnectCallbacks)e(this.connectParams);this.connectCallback&&this.connectCallback(e,t,n,r),this.serverInputTypes=o}onDisconnect(e){this.connectParams=void 0,this.disconnectCallback&&this.disconnectCallback(e)}onServerAuthenticationStateChange(e){if(e!=this.serverAuthenticationState){if(this.serverAuthenticationState==jt.Authenticated&&e==jt.Pending)return;this.serverAuthenticationState=e;for(const e of this.serverAuthenticationStateChangeCallback)e(this.serverAuthenticationState)}}callAnnotationCallbacks(e,t){if(0===this.annotationCallbacks.size)return;const n=this.annotationCallbacks.get(t);n&&n.forEach((t=>{t(e)}))}getOperationBatchConfig(e){return{delayMs:e.delayMs,maxInputSizeutSize,estimateSize:Et,groupingKeyExtractor:()=>"operations",multiplex:e=>({input:e.fil>e.length)).reduce(((e,t)=>e.concat(t)),[]),demultiplex:()=>[[]]}),split:e=>{if(!(e.length<=1))return{inputs:e.reduce(((e,t)=>(e.push([t]),e)),[]),join:()=>[]}}}}sendSeedMessagesViaBatchManager(e,t,n){this.seedBatchedOperationsManager||(this.seedBatchedOperationsManager=new kt(((e,t,n)=>{this.seedGroupSize++,this.sendMessageToSession(new we({cv:t.cv,seq:0,ops:e,groupId:"Seed",groupSize:t.groupComplete?this.seedGroupSize:void 0,groupComplete:t.groupComplete?t.groupComplete:void 0}),(e=>{n(e?new Error(e.error):void 0)}))}))),this.seedBatchedOperationsManager.addBatchItem(e,this.operatiotationResultsFromServer(e,t){this.onAnnotationResults(e,En.ServerWorkflow,t)}onAnnotationResultsFromLocal(e,t){this.onAnnotationResults(e,En.LocalWorkflow,t)}getLocalRegisteredWorkflows(){return this.workflowRuntime?this.workflowRuntime.getRegisteredWorkflows():this.localWorkflowManager?this.localWorkflowManager.getAllRegisteredWorkflowsFromSession(this).map((e=>Qt(e))):[]}sendWorkflowGraphInitMessage(){const e=this.getLocalRegisteredWorkflows(),t=new d({operationName:"WorkflowGraphInit",success:!0}).setClientMetadata(this.clientMetadata).start(),n=new je({upstreamRuntimeWorkflows:e});this.sendMessageToSession(n,((n,r)=>{n?jn(t,n.error):(t.resultDescription=`local workflows: ${e.map((e=>e.id))}, remote workflows: ${r.downstreamRuntimeWorkflows.map((e=>e.id))}`,jn(t),this.onWorkflowGraphInitResp||this.skipGraphInitOnWorkflowRegistration||(this.graphInitMessageTimer=!0,setTimeout((()=>{this.graphInitMessageTimer=!1,this.sendWorkflowGraphInitMessage()}),500))}onWorkflowGraphInitResponse(e){this.workflowGraph.removeWorkflows(!0);for(const t of e.downstreamRuntimeWorkflows||[])this.workflowGraph.addWorkflow(t,!0);this.workflowRuntime||this.attachExecutionTrackerToEachWorkflow()}resolvePlaceholdersInOperationParentPath(e){let t=e;return 3==t.length&&"session"==t[0]&&"user"==t[1]&&t[2].startsWith("user_")&&(p.a.info(540848914,p.b.CoreDefault,`Replacing user context placeholder for: ${zt(e)}.`),t=["session","#userContext#"]),3==t.length&&"session"==t[0]&&"user"==t[1]&&t[2].startsWith("tenant_")&&(p.a.info(540848915,p.b.CoreDefault,`Replacing tenant context placeholder for: ${zt(e)}.`),t=["session","#tenantContext#"]),t}filterOperationsForSession(e){return!!this.workflowRuntime||((e,t)=>{if(!Array.isArray(t)||0===t.length)return!0;if(U.typeGuard(e)||D.typeGuard(e))return!0;for(const n of e.items)if(!n.body||S.matchesTypesFor(n.body,t))return!0;return!1})(e,this.serverInputTypes)}makeRequestForConnectParams(e,t){const{authToken:n,origin:r,sessionUrl:o}=e,{body:i,cv:s,method:a,requestUrl:c}=t;return Object(Ze.fetch)(c||o,{method:a,headers:{Authorization:`Bearer ${n}`,"x-origin":r,"x-correlationid":s},body:i}).then((e=>{if(200!==e.status)throw new Error(`Unexpected status code: ${e.status}`);return e}))}sendLargeBinaryDataMessage(e,t,n){const r=new d({operationName:"SendLargeBinaryDataMessage",success:!0,cv:t.cv}).setClientMetadata(this.clientMetadata).start();let o;this.makeRequestForConnectParams(e,{body:Ye.a.serialize(t),cv:r.cv,method:"POST"}).then((e=>e.json())).catch((e=>{o=new se({messageId:t.messageId,error:e.message})})).then((e=>{jn(r,o?o.error:void 0),n(o,e)}))}requestBinaryData(e,t,n){const r=new d({operationName:"RequestBinaryData",success:!0,cv:(new $).toString()}).setClientMetadata(this.clientMetadata).start(),{sessionUrl:o}=e;let i;this.makeRequestForConnectParams(e,{cv:r.cv,method:"GET",requestUrl:t.refType===at.AlCodedLocation?`${o}/blob/${t.value}`:t.value}).then((e=>e.arrayBuffer())).then((e=>new Uint8Array(e))).catch((e=>{i=e})).then((e=>{jn(r,i?i.message:void 0),n(i,e)}))}}class Nn{}var An,Pn,xn;!function(e){e[e.Anonymous=0]="Anonymous",e[e.Host=1]="Host"}(An||(An={}));class Dn{constructor(){this.timers=new Map}scheduleRefresh(e,t,n,r){let o=this.timers.get(e);o||(o={numberOfAttempts:0},this.timers.set(e,o)),o.refreshTimeoutId&&(clearTimeout(o.refreshTimeoutId),o.refreshTimeoutId=void 0),o.expiredTimeoutId&&(clearTimeout(o.expiredTimeoutId),o.expiredTimeoutId=void 0);let i=1e3*t-Dn.tokenRefreshBufferMs,s=1e3*t-Dn.tokenExpirationBufferMs;i>0?o.numberOfAttempts=0:(++o.numberOfAttempts,i=Dn.tokenRefreshBackoffIntervalMs,s=Dn.tokenExpirationBufferMs),o.numberOfAttempts<=Dn.tokenRefreshMout((()=>{n()}),i)),r&&(o.expiredTimeoutId=setTimeout((()=>{r()}),s))}clearRefreshTimeouts(){this.clearTimeouts(!1)}clearAllTimeouts(){this.clearTimeouts(!0)}clearTimeouts(e){this.timers.forEach(((t,n)=>{t.refreshTimeoutId&&(clearTimeout(t.refreshTimeoutId),t.refreshTimeoutId=void 0),e&&t.expiredTimeoutId&&(clearTimeout(t.expiredTimeoutId),t.expiredTimeoutId=void 0),t.expiredTimeoutId||this.timers.delete(n)}))}}Dn.tokenRefreshBufferMs=24e4,Dn.tokenExpirationBufferMs=12e4,Dn.tokenRefreshBackoffIntervalMs=3e4,Dn.tokenRefreshMaximumAttempts=3;class Ln extends Ue.EventEmitter{constructor(e,t,n,r,o){super(),this.getSessionStats=e,this.clientMetadata=t,this.tokenRefreshManager=n,this.sendMessage=r,this.options=o||{},this.options.overrideSessionInitMessage=this.options.overrideSessionInitMessage||(e=>e)}initSession(e){e.onResponse=e.onResponse||(()=>{});const t=H.getCurrentTimeMs(),n=this.getSessionStats().lastConnectionClose&&t-this.getSessionStats().lastConnectionClose,r=this.getSessionStats().lastSyncMessage&&t-this.getSessionStats().lastSyncMessage,o=new d({operationName:"SessionInit"}).start(),i={sessionKey:this.sessionKey,sessionId:this.clientMetadata.sessionId,timeSinceLastConnectionClose:n,timeSinceLastSyncMessage:r,isTokenRefresh:e.isTokenRefresh,enableRemoteExecutionNotification:this.options.enableRemoteExecutionNotification,error:void 0},s=this.options.overrideSessionInitMessage(new ce({protocolVersion:2,clientMetadata:this.clientMetadata,sessionKey:this.sessionKey,origin:this.origin,authToken:this.anonymousToken,extensionConfigs:e.extensionConfigs,returnWorkflowInputTypes:!0,enableRemoteExecutionNotification:this.options.enableRemoteExecutionNotification}));this.sendMessage(s,((t,n)=>{if(o.success=!t,o.resultSignature=this.getSessionStats().lastConnectionClose?"Reconnect":"FirstConnect",o.resourceId=null==n?void 0:n.sliceUrl,o.setClientMetadata(this.clientMetadata),(null==n?void 0:n.sessionKey)&&i.sessionKey!==n.sessionKey&&(i.sessionKey=n.sessionKey),t&&(i.error=t.error),o.resultDescription=JSON.stringify(i),p.a.info(572838103,p.b.CoreDefault,o.stop()),e.onResponse(t,n),t)this.emit("serverAuthenticationStateChange",jt.NotAuthenticated);else if(e.isReconnectOnSameSlice&&n.forceReconnect)this.emit("serverAuthenticationStateChange",jt.NotAuthenticated);else{if(!n.anonymousToken||!n.tokenExpirationSeconds)return this.emit("serverAuthenticationStateChange",jt.NotAuthenticated),void p.a.error(572838104,p.b.CoreDefault,"AL Anonymous token was not generated for the session");this.anonymousToken=n.anonymousToken,this.onSuccessfulSessionInitOnServerSide(n)}}))}onSuccessfulSessionInitOnServerSide(e){this.tokenRefreshManager.scheduleRefresh(An.Anonymous,e.tokenExpirationSeconds,this.initSession.bind(this,{isTokenRefresh:!0}),(()=>{this.anonymousToken=void 0})),this.initHostAuthToken();const t=!!this.sessionKey,n=this.sessionKey!==e.sessionKey;this.sessionKey=e.sessionKey,this.origin=e.origin,this.emit("connect",n,t,`${e.sessionUrlBase}/${e.sessionKey}`,e.origin,this.anonymousToken,e.workflowInputTypes),t&&this.emit("reconnect")}initHostAuthToken(){if(this.options.getAuthToken){const e=new d({operationName:"RefreshAuthToken",success:!0}).setClientMetadata(this.clientMetadata).start();this.options.getAuthToken().then((t=>{if(!t)return this.emit("serverAuthenticationStateChange",jt.NotAuthenticated),e.success=!1,e.resultDescription="Host auth token provision failed",void p.a.info(572838105,p.b.CoreDefault,e.stop());p.a.info(509162971,p.b.CoreDefault,e.stop()),this.sendTokenProvisionMessage(t)})).catch((t=>{this.emit("serverAuthenticationStateChange",jt.NotAuthenticated),e.success=!1,e.resultDescription=`Error happened while attempting to fetch host token: ${t}`,p.a.error(572838106,p.b.CoreDefault,e.stop())}))}}sendTokenProvisionMessage(e){const t=new ke({authToken:e});this.emit("serverAuthenticationStateChange",jt.Pending),this.sendMessage(t,this.onTokenProvisionResponse.bind(this),!0)}onTokenProvisionResponse(e,t){!e&&t&&t.tokenExpirationSeconds?(this.emit("serverAuthenticationStateChange",jt.Authenticated),this.tokenRefreshManager.scheduleRefresh(An.Host,t.tokenExpirationSeconds,this.initHostAuthToken.bind(this))):this.emit("serverAuthenticationStateChange",jt.NotAuthenticated)}}class Mn{constructor(e){S.assign(Mn,this,e)}static getTypeName(){return"AugLoop_Core_Blob"}static getBaseTypes(){return[]}static typeGuard(e){return S.matchesTypesFor(e,[Mn.getTypeName()])}}Mn.H_={T_:Mn.getTypeName(),B_:Mn.getBaseTypes()};class Rn{constructor(e){S.assign(Rn,this,e)}static getTypeName(){return"AugLoop_Core_Binary"}static getBaseTypes(){return[]}static typeGuard(e){return S.matchesTypesFor(e,[Rn.getTypeName()])}}Rn.H_={T_:Rn.getTypeName(),B_:Rn.getBaseTypes()};class Fn{constructor(e){S.assign(Fn,this,e)}static getTypeName(){return"AugLoop_Core_TileGroup"}static getBaseTypes(){return[]}static typeGuard(e){return S.matchesTypesFor(e,[Fn.getTypeName()])}}Fn.H_={T_:Fn.getTypeName(),B_:Fn.getBaseTypes()};class Bn{constructor(e){S.assign(Bn,this,e)}static getTypeName(){return"AugLoop_Core_Session"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return S.matchesTypesFor(e,[Bn.getTypeName()])}}Bn.H_={T_:Bn.getTypeName(),B_:Bn.getBaseTypes()};class Un{constructor(e){S.assign(Un,this,e)}static getTypeName(){return"AugLoop_Core_Document"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return S.matchesTypesFor(e,[Un.getTypeName()])}}Un.H_={T_:Un.getTypeName(),B_:Un.getBaseTypes()};class Wn{constructor(e){S.assign(Wn,this,e)}static getTypeName(){return"AugLoop_Core_SubDocument"}static getBaseTypes(){return[]}static typeGuard(e){return S.matchesTypesFor(e,[Wn.getTypeName()])}}Wn.H_={T_:Wn.getTypeName(),B_:Wn.getBaseTypes()};class qn{constructor(e){S.assign(qn,this,e)}static getTypeName(){return"AugLoop_Core_GridCell"}static getBaseTypes(){return[]}static typeGuard(e){return S.matchesTypesFor(e,[qn.getTypeName()])}}qn.H_={T_:qn.getTypeName(),B_:qn.getBaseTypes()};class Hn{constructor(e){S.assign(Hn,this,e)}static getTypeName(){return"AugLoop_Core_GridNeighborhoodContext"}static getBaseTypes(){return[]}static typeGuard(e){return S.matchesTypesFor(e,[Hn.getTypeName()])}}Hn.H_={T_:Hn.getTypeName(),B_:Hn.getBaseTypes()};class zn{constructor(e){S.assign(zn,this,e)}static getTypeName(){return"AugLoop_Core_ItemFilter"}static getBaseTypes(){return[]}static typeGuard(e){return S.matchesTypesFor(e,[zn.getTypeName()])}}zn.H_={T_:zn.getTypeName(),B_:zn.getBaseTypes()};class Gn{constructor(e){S.assign(Gn,this,e)}static getTypeName(){return"AugLoop_Core_DynamicContext"}static getBaseTypes(){return[]}static typeGuard(e){return S.matchesTypesFor(e,[Gn.getTypeName()])}}Gn.H_={T_:Gn.getTypeName(),B_:Gn.getBaseTypes()};class Vn{constructor(e){S.assign(Vn,this,e)}static getTypeName(){return"AugLoop_Core_ContextHolder"}static getBaseTypes(){return[]}static typeGuard(e){return S.matchesTypesFor(e,[Vn.getTypeName()])}}Vn.H_={T_:Vn.getTypeName(),B_:Vn.getBaseTypes()};class $n{constructor(e){S.assign($n,this,e)}static getTypeName(){return"AugLoop_Core_UserContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(e){return S.matchesTypesFor(e,[$n.getTypeName()])}}$n.H_={T_:$n.getTypeName(),B_:$n.getBaseTypes()};class Qn{constructor(e){S.assign(Qn,this,e)}static getTypeName(){return"AugLoop_Core_TenantContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(e){return S.matchesTypesFor(e,[Qn.getTypeName()])}}Qn.H_={T_:Qn.getTypeName(),B_:Qn.getBaseTypes()};class Jn{constructor(e){S.assign(Jn,this,e)}static getTypeName(){return"AugLoop_Core_EventsHolder"}static getBaseTypes(){return[]}static typeGuard(e){return S.matchesTypesFor(e,[Jn.getTypeName()])}}Jn.H_={T_:Jn.getTypeName(),B_:Jn.getBaseTypes()};class Xn{constructor(e){S.assign(Xn,this,e)}static getTypeName(){return"AugLoop_Core_UserCommandsHolder"}static getBaseTypes(){return["AugLoop_Core_EventsHolder"]}static typeGuard(e){return S.matchesTypesFor(e,[Xn.getTypeName()])}}Xn.H_={T_:Xn.getTypeName(),B_:Xn.getBaseTypes()},function(e){e[e.Undefined=0]="Undefined",e[e.Created=10]="Created",e[e.Sent=20]="Sent",e[e.Duplicated=30]="Duplicated",e[e.Seen=40]="Seen",e[e.Tried=50]="Tried",e[e.Kept=60]="Kept",e[e.Rejected=70]="Rejected"}(Pn||(Pn={})),function(e){e[e.JoinContext=0]="JoinContext",e[e.Session=1]="Session"}(xn||(xn={})),Error;var Kn={util:{},roots:{default:{}}},Yn=(Kn.roots.default||(Kn.roots.default={}),function(){function e(e){if(e)for(var nType="",e.prototype.annotationState=0,e.prototype.workflowId="",e}());class Zn extends Yn{constructor(e){super(e),this.eventName="AnnotationMetaDataChange"}}class er{constructor(e){this.item=e,this.operation=e.op,this.delta=e.delta,this.deltas=e.deltas,this.id=zt(this.itemPath),this.revId=e.revId}get itemPath(){return[...this.item.parentPath,this.item.id]}getModelIterator(){throw new Error("Method not implemented.")}getBody(){return this.item.body}getItemReference(){throw new Error("Method not implemented.")}getParentItem(e){throw new Error("Method not implemented.")}getParentItemBody(e){throw new Error("Method not implemented.")}getPrevItem(e,t){throw new Error("Method not implemented.")}getPrevItemBody(e,t){throw new Error("Method not implemented.")}getNextItem(e,t){throw new Error("Method not implemented.")}getNextItemBody(e,t){throw new Error("Method not implemented.")}getChildItem(e){throw new Error("Method not implemented.")}getChildItemBody(e){throw new Error("Method not implemented.")}getChildItems(e){throw new Error("Method not implemented.")}getChildItemBodies(e){throw new Error("Method not implemented.")}getSubtreeItem(e){throw new Error("Method not implemented.")}getSubtreeItemBody(e){throw new Error("Method not implemented.")}getSubtreeItems(e){throw new Error("Method not implemented.")}getSubtreeItemBodies(e){throw new Error("Method not implemented.")}getContextItem(e){throw new Error("Method not implemented.")}getContextItemBody(e){throw new Error("Method not implemented.")}getContextItems(e){throw new Errror("Method not implemented.")}addAnnotation(e,t){throw new Error("Method not implemented.")}updateAnnotation(e,t){throw new Error("Method not implemented.")}deleteAnnotation(e){throw new Error("Method not implemented.")}loadSubtree(e){throw new Error("Method not implemented.")}getSourceTimestamp(){return this.item.sourceTimestamp}getContextId(){return this.item.contextId}}class tr{constructor(e,t=[]){this.scopeItem=void 0,this.rootItem=void 0,this.normalizeFilter=e=>{if(!e)return e=>void 0!==e;if("function"==typeof e)throw new Error("Not implemented yet");if((e.id?1:0)+(e.ids?1:0)+(e.itemType?1:0)+(e.itemTypes?1:0)!=1)throw new Error("Exactly one condition expected on IItemFilter");if(e.itemType)return t=>t&&S.matchesTypesFor(t.body,[e.itemType]);if(e.itemTypes)return t=>t&&S.matchesTypesFor(t.body,e.itemTypes);throw new Error("Not implemented ye)}getItem(e){throw new Error("Method not implemented.")}getItems(e){throw new Error("Method not implemented.")}getItemBody(e){return this.getItemBodies(e)[0]}getItemBodies(e){const t=this.normalizeFilter(e);return this.items.filter(t).map((e=>e.body))}getItemByReference(e){throw new Error("Method not implemented.")}getItemBodyByReference(e){throw new Error("Method not implemented.")}}const nr=[tn.CursorUpdate,tn.FormattingUpdate,tn.OtherNonContentUpdate];function rr(e,t,n){const r=new d({operationName:"ApplyTextTileDeltaForLocalWorkflows",dimension0:"0",success:!0}).start();try{if(!t)return r.success=!1,r.resultDescription="Unable to apply text tile delta, parent tile is undefined",void p.a.info(538798173,p.b.CoreDefault,r.stop());if(S.getTypeNameFor(t)!==on.getTypeName())return r.success=!1,r.resultDescription=`Unable to apply text tile delta, parent tile is not proper type: expected ${dn.getTypeName()}, received ${S.getTypeNameFor(t)}`,void p.a.info(538798174,p.b.CoreDefault,r.stop());const n=e,o=t.content;let i="";if(void 0===n.position||n.position<0)return r.success=!1,r.resultDescription="Unable to apply text tile delta, invalid text tile position",void p.a.info(538798175,p.b.CoreDefault,r.stop());switch(n.deltaType){case tn.Add:i=n.position<o.length?`${o.slice(0,n.position)}${n.content}${o.slice(n.position,o.length)}`:o+n.content;break;case tn.Update:n.content||n.unit!==nn.Sentence||(r.dimension0="1"),i=`${o.slice(0,n.position)}${n.content}${o.slice(n.position+(n.length||0),o.length)}`;break;case tn.Delete:i=`${o.slice(0,n.position)}${o.slice(n.position+(n.length||0),o.length)}`}return p.a.info(538837071,p.b.CoreDefault,r.stop()),new on({content:i})}catch(e){return r.success=!1,r.resultDescription=`Error applying text tile delta: ${e}`,void p.a.info(538798176,p.b.CoreDefault,r.stop())}}function or(e,t,n){var r,o,i,s,a,c,u,l;const h=new d({operationName:"ApplyFormattedTextTileDeltaForLocalWorkflows",dimension0:"0",success:!0}).start();h.clientFlights=n;try{if(!t)return h.success=!1,h.resultDescription="Unable to apply formatted text tile delta, parent tile is undefined",void p.a.info(538798177,p.b.CoreDefault,h.stop());if(S.getTypeNameFor(t)!==sn.getTypeName())return h.success=!1,h.resultDescription=`Unable to apply formatted text tile delta, parent tile is not proper type: expected ${sn.getTypeName()}, received ${S.getTypeNameFor(t)}`,void p.a.info(538798178,p.b.CoreDefault,h.stop());const n=t,f=e,m=n.content;let g="";if((void 0===f.position||f.position<0)&&!sr(f.deltaType))return h.success=!1,h.resultDescription="Unable to apply formatted text tile delta, invalid text tile position",void p.a.info(538798179,p.b.CoreDefault,h.stop());if(void 0===f.content&&!sr(f.deltaType))return h.success=!1,h.resultDescription="Unable to apply formatted text tile delta, non-delete, non-formatting, non-other-non-content-update and non-cursor-update operation without content defined",void p.a.info(538798208,p.b.CoreDefault,h.stop());if(f.deltaType===tn.Add&&0!==f.length?p.a.info(538798209,p.b.CoreDefault,new d({operationName:"ApplyDeltaChecks",resultDescription:"Received formatted text tile delta add operation with delta length, expected length 0",success:!0})):sr(f.deltaType)&&void 0!==f.content&&p.a.info(538798210,p.b.CoreDefault,new d({operationName:"ApplyDeltaChecks",resultDescription:"Received formatted text tile delta delete or non-content related operation with content defined, expected undefined",success:!0})),!ir(f.deltaType)){const e=function(e,t,n){const r=new d({operationName:"FindRangeForDelta",success:!0});if(r.start(),!e)return r.resultDescription="No formatted ranges found within the tile, skipping.",void p.a.info(538798212,p.b.CoreDefault,r.stop());if(t===tn.Add){const t=e.find((e=>e.start===n&&0===e.length));if(t)return r.resultDescription=`Found a zero-length formatted range for add operation with start ${t.start}.`,p.a.info(538798213,p.b.CoreDefault,r.stop()),t;n=Math.max(n-1,0)}const o=e.find((e=>0===e.length?e.start===n:e.start<=n&&n<e.start+e.length));return o?(r.resultDescription=`Updating formatted range for operation with start: ${o.start} and length: ${o.length}`,p.a.info(538798214,p.b.CoreDefault,r.stop())):(r.resultDescription=`Unable to find formatted range for operation at position ${n}, skipping.`,p.a.info(538798215,p.b.CoreDefault,r.stop())),o}(n.formattedRanges,f.deltaType,f.position);let t=n.formattedRanges?[...n.formattedRanges]:[];const u=e?t.indexOf(e):-1;-1!==u&&(f.position+(f.length||0)>e.start+e.length?e.length=f.position+(null!==(r=f.content)&&void 0!==r?r:"").length-e.start:e.length+=(null!==(o=f.content)&&void 0!==o?o:"").length-(f.length||0),t[u]=e);let l=n.ipPosition;switch(f.deltaType){case tn.Add:g=f.position<m.length?`${m.slice(0,f.position)}${f.content}${m.slice(f.position,m.length)}`:m+f.content,l=f.position+f.length;break;case tn.Update:f.content||f.unit!==nn.Sentence||(h.dimension0="1"),g=`${m.slice(0,f.position)}${f.content}${m.slice(f.position+(null!==(i=f.length)&&void 0!==i?i:0),m.length)}`,l=f.position+f.content.length;break;case tn.Delete:g=`${m.slice(0,f.position)}${m.slice(f.position+(null!==(s=f.length)&&void 0!==s?s:0),m.length)}`,l=f.position}for(const e of t.slice(u+1))e.start<f.position||(f.position+(f.length||0)>e.start?(e.length=e.start+e.length-(f.position+(f.length||0)),e.start=f.position+(null!==(a=f.content)&&void 0!==a?a:"").length):e.start+=(null!==(c=f.content)&&void 0!==c?c:"").length-(f.length||0));t=t.filter((e=>e.length>0));const v=new sn(Object.assign(Object.assign({},n),{ipPosition:l,content:g,formattedRanges:t,queryRange:f.queryRange}));return p.a.info(538837073,p.b.CoreDefault,h.stop()),v}if(f.deltaType===tn.CursorUpdate)return new sn(Object.assign(Object.assign({},n),{ipPosition:null===(u=f.cursorData)||void 0===u?void 0:u.ipPosition,isColdIp:null===(l=f.cursorData)||void 0===l?void 0:l.isColdIp}));if(f.deltaType===tn.FormattingUpdate)return new sn(Object.assign(Object.assign({},n),{formattedRanges:f.formattedRanges}));if(f.deltaType===tn.OtherNonContentUpdate){let e;const t={};for(e in f.otherNonContentData)t[e]=f.otherNonContentData[e];return new sn(Object.assign(Object.assign({},n),tresultDescription=`Error applying formatted text tile delta: ${e}`,void p.a.info(538798211,p.b.CoreDefault,h.stop())}}function ir(e){return-1!==nr.indexOf(e)}function sr(e){return ir(e)||tn.Delete===e}function ar(e){if(!e)return new cr([],new Set,new Map);const t=e.split(";"),n=new Set,r=new Map;for(const e r{constructor(e,t,n){this.originalFlights=e,this.normalizedFlights=t,this.keyValueFlightsMap=n}static normalizeName(e){return null==e?void 0:e.toLowerCase()}hasFlight(e){const t=cr.normalizeName(e),n=this.normalizedFlights.has(t),r=this.keyValueFlightsMap.has(t);return n||r}getBooleanValue(e,t){var n;switch(null===(n=this.getStringValue(e))||void 0===n?void 0:n.toLowerCase()){case"true":return!0;case"false":return!1;default:return t}}getIntValue(e,t){const n=this.getStringValue(e),r=Number.parseInt(n,10);return Number.isNaN(r)?t:r}getStringValue(e,t){var n;return null!==(n=this.keyValueFlightsMap.get(cr.normalizeName(e)))&&void 0!==n?n:t}getAll(){return this.originalFlights}getAllParsed(){const e=[];return this.keyValueFlightsMap.forEach(((t,n)=>{const r=null==t?void 0:t.toLowerCase();switch(r){case"true":e.push({name:n,value:!0});break;case"fass ur{constructor(e){this.model=e.model,this.clientMetadata=e.clientMetadata,this.userContext=e.userContext,this.site=e.site,tts(){var e;return null!==(e=this._flights)&&void 0!==e||(this._flights=ar(this.clientMetadata.flights)),this._flights}getToken(e,t){return this.getToken(e,t)}}class lr{constructor(e,t,n){this.itemsContextId=new Set,this.executionState=new Map,this.graphNode=e,this.onContextIdWorkflowExecutionComplete=t,n&&(this.itemsContextId=n.itemsContextId,this.executionState=n.executionState)}addInputItemToProcess(e){this.itemsContextId.add(e)}removeProcessedInputItem(e){this.itemsContextId.delete(e)}countItemsToProcess(e){let t=0;for(const n of this.itemsContextId)0===n.indexOf(e)&&(t+=1);return t}getExecutionState(){return this.executionState}setExecutionState(e,t){e?this.executionState.set(e,t):p.a.warn(520217546,p.b.CoreDefault,new d({operationName:"WorkflowExecutionTracker",resourceId:this.graphNode.workflow.id,resultDescription:`Trying to set state ${t} for a undefined contextId (setExecutionState)`}))}beforeWorkflowExecution(e){e?this.executionState.set(e,Zt.Pending):p.a.warn(520217545,p.b.CoreDefault,new d({operationName:"WorkflowExecutionTracker",resourceId:this.graphNode.workflow.id,resultDescription:`Trying to set state ${Zt.Idle} for a undefined contextId (beforeWorkflowExecution)`}))}afterWorkflowExecution(e){e?(this.executionState.set(e,Zt.Executed),this.tryToCompleteWorkflowExecution(e)):p.a.warn(520217544,p.b.CoreDefault,new d({operationName:"WorkflowExecutionTracker",resourceId:this.graphNode.workflow.id,resultDescription:`Trying to set state ${Zt.Executed} for a undefined contextId (afterWorkflowExecution)`}))}tryToCompleteWorkflowExecution(e){if(this.executionState.get(e)===Zt.Executed&&this.canCompleteExecution(e)){this.executionState.delete(e),this.onContextIdWorkflowExecutionComplete&&this.onContextIdWorkflowExecutionComplete(this.graphNode.workflow.id,e);for(const t of this.downstreamWorkflowExecutionTrackers)for(const[n,r]of t.getExecutionState())r===Zt.Executed&&Yt.isParentContextId(e,n)&&t.tryToCompleteWorkflowExecution(n)}}canCompleteExecution(e){for(const t of this.upstreamWorkflowExecutionTrackers)for(const n of t.getExecutionState().keys())if(Yt.isParentContextId(n,e))return!1;return!0}}var dr;!function(e){e.Unknown="",e.InputReceived="input",e.JoinMaxAnnnotation="maxAnnotation",e.JoinMaxTimeout="maxTimeout",e.JoinEarlyCompletion="earlyCompletion"}(dr||(dr={}));class hr{constructor(e,t,n){this.executionTrackersByWorkflowNameBySession=new Map,this.workflowsWithSessionAffinity=new Map,this.workflowDefinitionsWithSessionAffinity=[],this.workflowsWithoutSessionAffinity=[],this.pendingScopeExecutionNotificationsByWorkflow=new Map,this.sweepIntervalMs=200,this.sweepTimers=new Map,this.getResourceAsArrayBuffer=(e,t,n)=>this.modelDownloader?this.modelDownloader.getResourceAsArrayBuffer(e,t,n):Promise.reject(new Error("Resource Downloader never created")),this.getResourceAsURL=(e,t,n)=>this.modelDownloader?this.modelDownloader.getResourceAsURL(e,t,n):Promise.reject(new Error("Resource Downloader never created")),this.createModel=e=>(!this.inferenceService&&this.inferenceServiceFactory&&(this.inferenceService=this.inferenceServiceFactory()),this.inferenceService?this.inferenceService.then((t=>t.createModel(e))):Promise.reject(new Error("Inference Service never created"))),this.createModelInputs=()=>{if(!this.inferenceService&&this.inferenceServiceFactory&&(this.inferenceService=this.inferenceServiceFactory()),this.inferenceService)return this.inferenceService.then((e=>e.createInputs()));throw new Error("Inference Service never created")},this.nextAnnotationId=1,this.nextSignalId=1,this.modelDownloader=e,this.inferenceServiceFactory=t,n.enableDeltas&&(this.deltaHandlers=(new Map).set(S.getTypeNameFor(dn),rr).set(S.getTypeNameFor(hn),or),this.deltaItems=new Map),this.enableEarlyJoin=n.enableEarlyJoin||!1,this.site={getResourceAsArrayBuffer:this.getResourceAsArrayBuffer,getResourceAsURteModelInputs:this.createModelInputs}}getNextClientAnnotationId(){return"#AC"+this.nextAnnotationId++}getNextClientSignalId(){return"#SC"+this.nextSignalId++}registerLocalWorkflow(e,t){const n=new d({operationName:"WorkflowRegistration",resourceId:e.id}).start();if(0===e.inputTypes.length)throw new Error("Invalid workflow params");t?(this.workflowsWithSessionAffinity.get(t).push(this.createWorkflowImplementation(e,t)),t.registerContextTypes(qt(e.requestedContextTypesRules).map((([e,t])=>e))),t.attachToWorkflowGrapateful?(this.workflowDefinitionsWithSessionAffinity.push(e),this.workflowsWithSessionAffinity.forEach(((t,n)=>{t.push(this.createWorkflowImplementation(e,n))}))):this.workflowsWithoutSessionAffinis.createWorkflowImplementation(e)),this.workflowsWithSessionAffinity.forEach(((t,n)=>{n.registerContextTypes(qt(e.requestedContextTypesRules).map((([e,t])=>e))),n.attachToWorkflowGraph(e)}))),n.success=!0,p.a.info(572838110,p.b.CoreDefault,n.stop())}getAllRegisteredWorkflowsFromSession(e){const t=[];return t.push(...this.workflowsWithoutSessionAffinity||[]),t.push(...this.workflowsWithSessionAffinity.get(e)||[]),tfinitionsByName(e){var t;const n=new Map;return null===(t=this.workflowsWithSessionAffinity.get(e))||void 0===t||t.forEach((e=>n.set(e.workflow.id,e.workflow))),n}getWorkflowDefinitionsWithSessionAffinity(){return this.workflowDefinitionsWithSessionAffinity}attachExecutionTrackerToEachWorkflow(e,t,n){const r=e.getWorkflowNodes(),o=this.executionTrackersByWorkflowNameBySession.get(t),i=(e,r)=>{n&&n(e,r),this.enableEarlyJoin&&(()=>{for(const e of this.executionTrackersByWorkflowNameBySession.get(t).values())if(e.graphNode.workflow.kind===Pt.Join)for(const t of e.getExecutionState().keys())if(Yt.isParentContextId(t,r))return!0;return!1})()&&(this.cancelSweepTimer(t),this.ensureSweepTimer(t),this.sweepScopeExecutionNotifications())};for(const e of r){const t=o.get(e.workflow.id),n=new lr(e,i.bind(this),t);o.set(e.workflow.id,n)}for(const e of o.values())this.setDownstreamWorkflowExecutionTrackers(e,o),this.setUpstreamWorkflowExecutionTrackers(e,o)}setDownstreamWorkflowExecutionTrackers(e,t){if(void 0!==e.downstreamWorkflowExecutionTrackers)return;e.downstreamWorkflowExecutionTrackers=new Set;const{graphNode:n}=e;for(const r of n.downstreamWorkflows||[]){const n=t.get(r.workflow.id);this.setDownstreamWorkflowExecutionTrackers(n,t),e.downstreamWorkflowExecutionTrackers.add(n)}}setUpstreamWorkflowExecutionTrackers(e,t){if(void 0!==e.upstreamWorkflowExecutionTrackers)return;e.upstreamWorkflowExecutionTrackers=new Set;const{graphNode:n}=e;for(const r of n.upstreamWorkflows||[]){const n=t.get(r.workflow.id);this.setUpstreamWorkflowExecutionTrackers(n,t),e.upstreamWorkflowExecutionTrackers.add(n)}}addSession(e){this.executionTrackersByWorkflowNameBySession.set(e,new Map);const t=[];for(const n of this.workflowDefinitionsWithSessionAffinity)t.push(this.createWorkflowImplementation(n)),e.attachToWorkflowGraph(n);this.workflowsWithSessionAffinity.set(e,t);for(const t of this.workflowsWithoutSessionAffinity)e.attachToWorkflowGraph(t.workflow)}closeSession(e){this.cancelSweepTimer(e);for(const t of this.workflowsWithSessionAffinity.get(e)||[])t.workflowLambda.dispose();this.workflowsWithSessionAffinity.delete(e)}setTokenCallback(e){this.getAuthTokenCallback=e}preProcessItemToWorkflow(e,t,n){const r=this.executionTrackersByWorkflowNameBySession.get(n).get(e.id);e.kind===Pt.Join&&S.matchesTypesFor(t.body,e.inputTypes)&&r.addInputItemToProcess(t.contextId),(e.kind===Pt.SingleItem&&S.matchesTypesFor(t.body,e.inputTypes)||e.kind===Pt.Join&&S.matchesTypesFor(t.body,[e.collectionScopeType]))&&r.beforeWorkflowExecution(t.contextId)}isReadyToEarlyJoin(e,t,n){const r=r=>{var o;const i=Array.from(null!==(o=r.states)&&void 0!==o?o:[]).map((e=>`${e[0]}: ${e[1].map((e=>e.join()))}`)).join(),s=new d({operationName:"EarlyJoinCompletion",resourceId:e.graphNode.workflow.id,joinContextId:t,success:!0}).start();s.setClientMetadata(n),s.resultDescription=`isReadyToEarlyJoin (${this.enableEarlyJoin}) -> hasProcessedAllInputItems: ${r.hasProcessedAllInputItems}, allUpstreamComplete: ${r.allUpstreamComplete}, states: ${i}`,p.a.info(512550800,p.b.CoreDefault,s.stop())},o=0===e.countItemsToProcess(t);if(!o)return this.enableEarlyJoin||r({hasProcessedAllInputItems:o}),!1;const{allUpstreamComplete:i,states:s}=this.areAllUpstreamWorkflowComplete(e,t);return this.enableEarlyJoin?i:(r({hasProcessedAllInputItems:o,allUpstreamComplete:i,states:s}),!1)}areAllUpstreamWorkflowComplete(e,t){const n=new Map;for(const r of e.upstreamWorkflowExecutionTrackers){const e=[];for(const[o,i]of r.getExecutionState())if(e.push([o,i]),Yt.isParentContextId(t,o))return n.set(r.graphNode.workflow.id,e),{allUpstreamComplete:!1,states:n};e.length>0&&n.set(r.graphNode.workflow.id,e)}return{allUpstreamComplete:!0,states:n}}runLocalWorkflows(e,t,n=!1){var r,o,i;const s=(e,n,r)=>{var o,i;const s=t.getWorkflowItemStorage(),{workflow:a}=e,c=null===(o=this.executionTrackersByWorkflowNameBySession.get(t))||void 0===o?void 0:o.get(a.id),u=a.inputTypes.concat(a.kind===Pt.Join?a.collectionScopeType:[]),l=new d({operationName:"RunLocalWorkflows",success:!0,resourceId:a.id,joinContextId:n.contextId}).start();if(l.setClientMetadata(t.getClientMetadata()),S.matchesTypesFor(n.body,u)){const o=Ht(r.parentPath,n);if(a.kind===Pt.Join){if(S.matchesTypesFor(o.body,[a.collectionScopeType]))return s.setScopeItem(o,a),l.resultDescription=`Scope item: ${n.id} (${S.getTypeNameFor(n.body)})`,p.a.info(524126153,p.b.CoreDefault,l.stop()),void this.setScopeExecutionNotification(t,e,o,_n.Internal);{c.removeProcessedInputItem(o.contextId);const e=s.getScopeItem(o.contextId,a);if(!e)return l.resultDescription=`Filtered out join invalidation: out of scope type (${a.collectionScopeType}), item id: ${o.id}`,void p.a.info(541173894,p.b.CoreDefault,l.stop());s.addItemToWorkflowList(o,a),l.joinContextId=e.contextId,l.resultDescription=`Input item: ${n.id} (${S.getTypeNameFor(n.body)})`}}if(S.getBaseTypesFor(o.body).indexOf(Vn.getTypeName())>=0){const e=[...o.parentPath,o.id];let n=!0;for(const r of null!==(i=a.outputTypes)&&void 0!==i?i:[])if(!t.getContextAnnotations(r,En.LocalWorkflow,e,a.id)){n=!1;break}if(n)return}const u=()=>{var r;const[i,d]=t.resolveRequestedContexts(a);if(!i)return l.resultDescription=`Required contexts are not ready for ${a.id}. Retrying execution in 500 milliseconds...`,p.a.info(545837259,p.b.CoreDefault,l.stop()),void setTimeout(u,500);if(a.kind===Pt.SingleItem)this.queueWorkflow({workflowInfo:e,scopeItem:o,inputItems:[o],requestedContexts:d,session:t,orchestrationMode:_n.Internal,triggerReason:dr.InputReceived,onCompleteCallback:this.onWorkflowExecuted.bind(this,o,a,t)}).then((e=>{p.a.info(509154263,p.b.WorkflowDefault,l.stop())})).catch((e=>{l.resultDescription=e,p.a.error(572838111,p.b.CoreDefault,l.stop())}));else if(a.kind===Pt.Join){const o=n.contextId,i=s.getScopeItem(o,e.workflow);if(!i)return l.resultDescription=`No scope item for ${a.id} workflow from contextId ${o}`,void p.a.info(526758475,p.b.CoreDefault,l.stop());const u=this.isReadyToEarlyJoin(c,i.contextId,t.getClientMetadata()),h=u?dr.JoinEarlyCompletion:dr.JoinMaxAnnnotation;if(s.isWorkflowReady(i.contextId,a)||u){if(!(null===(r=this.pendingScopeExecutionNotificationsByWorkflow.get(a.id))||void 0===r?void 0:r.get(i.contextId)))return l.resultDescription=`Workflow ${a.id}, contextId ${i.contextId}, already queued, skipping new scope execution`,void p.a.info(528048977,p.b.CoreDefault,l.stop());const n=s.getItemsToExecute(i.contextId,a);this.queueWorkflow({workflowInfo:e,scopeItem:i,inputItems:n,requestedContexts:d,session:t,orchestrationMode:_n.Internal,triggerReason:h,onCompleteCallback:this.onWorkflowExecuted.bind(this,i,a,t)}).then((e=>{p.a.info(509154262,p.b.WorkflowDefault,l.stop())})).catch((e=>{l.resultDescription=e,p.a.error(541173895,p.b.CoreDefault,l.stop())})),this.pendingScopeExecutionNotificationsByWorkflow.get(a.id).delete(i.contextId),0===this.pendingScopeExecutionNotificationsByWorkflow.get(a.id).size&&this.pendingScopeExecutionNotificationsByWorkflow.delete(a.id)}}};u()}};let a=e;n&&(a=[new P({parentPath:["session"],items:[{id:"#userContext#",body:new $n}]}),new P({parentPath:["session"],items:[{id:"#tenantContext#",body:new Qn}]})],t.getContextIdManager().applyContextIdOnOperations(a),a=a.concat(e));for(const e of a){const n=S.getTypeNameFor(e);for(const a of e.items)if(t.applyOperationForContext(e,a,En.Submitted),n!==M.getTypeName()){if(a.body)if(n===U.getTypeName()&&this.deltaHandlers&&this.deltaItems)this.handleLocalDeltaUpdate(a,e,t);else{null===(o=this.deltaItems)||void 0===o||o.set(a.id,a.body);for(const t of this.workflowsWithoutSessionAffinity)s(t,a,e);for(const n of null!==(i=this.workflowsWithSessionAffinity.get(t))&&void 0!==i?i:[])s(n,a,e)}}else null===(r=this.deltaItems)||void 0===r||r.delete(a.id)}}handleLocalDeltaUpdate(e,t,n){const r=new d({operationName:"LocalDeltaUpdate",dimension0:S.getTypeNameFor(e.body),success:!0});r.start();try{const o=this.deltaHandlers.get(S.getTypeNameFor(e.body)),i=this.deltaItems.get(t.parentPath[t.parentPath.length-1]);if(o&&i){const s=o(e.body,i);if(s){const o={id:e.id,revId:e.revId,body:s,parentPath:t.parentPath,delta:e.body,contextId:e.contextId},i=new N({parentPath:o.parentPath,items:[o]});p.a.info(539637591,p.b.CoreDefault,r.stop()),this.runLocalWorkflows([i],n)}else r.success=!1,r.resultDescription="Failed because the handler did not produce valid updated item",p.a.info(539637592,p.b.CoreDefault,r.stop())}else r.success=!1,r.resultDescription="Failed due to lack of handler or parent item",p.a.info(539637593,p.b.CoreDefault,r.stop())}catch(e){r.success=!1,r.resultDescription=`Failed to apply delta, error: ${e}`,p.a.info(539637594,p.b.CoreDefault,r.stop())}}createWorkflowImplementation(e,t){const n=e.factory();return{workflow:e,workflowLambda:n,initPromise:this.initWorkflow(e.kind,n,t)}}initWorkflow(e,t,n){var r;const o=new ur({model:void 0,clientMetadata:n?n.getClientMetadata():void 0,userContext:n?n.getUserContext():void 0,site:this.site,getTokenCallback:null===(r=this.getAuthTokenCallback)||void 0===r?void 0:r.bind(this)});return e===Pt.SingleItem||e===Pt.Join?t.init(this.site,o):Promise.resolve()}queueWorkflow(e){var t,n;const r=e.session.getClientMetadata();let o;return r&&"outlook"==(null===(t=r.appName)||void 0===t?void 0:t.toLowerCase())&&"web"==(null===(n=r.appPlatform)||void 0===n?void 0:n.toLowerCase())&&"Production"!=r.releaseAudienceGroup&&(o=new d({operationName:"QueueLocalWorkflows",success:!0,resourceId:e.workflowInfo.workflow.id,joinContextId:e.scopeItem.contextId,dimension0:e.triggerReason}).start().setClientMetadata(r)),new Promise(((t,n)=>{setTimeout((()=>{o&&p.a.info(509154261,p.b.CoreDefault,o.stop()),this.executionTrackersByWorkflowNameBySession.get(e.session).get(e.workflowInfo.workflow.id).setExecutionState(e.scopeItem.contextId,Zt.Running),this.executeLocalWorkfinputItems,e.session,e.requestedContexts,e.orchestrationMode,e.triggerReason).then((n=>{e.onCompleteCallback(),t(n)})).catch((t=>{e.onCompleteCallback(),n(t)}))}),0)}))}executeLocalWorkflow(e,t,n,r,o,i,s){return new Promise(((a,c)=>{var u,l,h;const f={annotations:[]},m=[],g=e.workflow,v=new d({operationName:"ExecuteWorkflow",resourceId:g.id,joinContextId:null!==(u=null==t?void 0:t.contextId)&&void 0!==u?u:"",resultDescription:null!=s?s:"",success:!0}).setClientMetadata(r.getClientMetadata());v.start();const b=null!==(l=null==t?void 0:t.contextId)&&void 0!==l?l:n[0].contextId,y=null!==(h=null==t?void 0:t.revId)&&void 0!==h?h:n[0].revId,w=(()=>{const e=new Map;if(t&&(t.parentPath||p.a.error(525382231,p.b.CoreDefault,`Missing scope item parent. Workflow: ${g.id}. Type: ${S.getTypeNameFor(t.body)}`),e.set(t.body,t)),Array.isArray(n))for(const t of n)t&&t.body&&(t.parentPath||p.a.error(525382232,p.b.CoreDefault,`Missing parent. Workflow: ${g.id}. Type: ${S.getTypeNameFor(t.body)}`),e.set(t.body,t));return e})(),C=(e,t=v)=>{if(e)return t.success=!1,t.resultDescription+="string"==typeof e?e:e.message,t.resultSignature="Exception",p.a.error(572838112,p.b.CoreDefault,t.stop()),"string"==typeof e?new Error(e):e;p.a.info(572838113,p.b.CoreDefault,t.stop())},O=new ur({model:new tr(n[0],o),clientMetadata:r.getClientMetadata(),userContext:r.getUserContext(),site:this.site,getTokenCallback:this.getAuthTokenCallback.bind(this)}),T=e=>{if(C(e?e.message:void 0),e)c(e);else{for(const e of m)r.onAnnotationResults(e,En.LocalWorkflow,(()=>{}));a(f)}},E={setAnnotations:(o,s,a,u)=>{var l;const h=new d({operationName:"SetAnnotations",resourceId:s,joinContextId:null!==(l=null==t?void 0:t.contextId)&&void 0!==l?l:"",success:!0}).setClientMetadata(r.getClientMetadata());h.start();const v=t=>{p.a.info(555866112,p.b.CoreDefault,new Zn({annotationType:s,annotationState:t,workflowId:e.workflow.id}))};for(const e of a)e.metadata=Object.assign(Object.assign({},e.metadata),{state:Pn.Created}),v(Pn.Created);const O=w.get(o),T=S.getTypeNameFor(O.body),E=(()=>{var e;if(g.kind===Pt.SingleItem&&n[0].body!==o){const e=`Expected obj to be ${n[0].body} but instead it was ${o}`;return C(e,h),void c(C(e))}let t,l;if(Array.isArray(a))if(!g.outputTypes||g.outputTypes.indexOf(s)<0)t=`Workflow said it would output one of [${g.outputTypes}] but instead output ${s}`;else if(O)for(const e of a)S.matchesTypesFor(e,[k.getTypeName()])?S.getTypeNameFor(e)!==s&&(t=`Workflow produced inconsistent annotation types in setAnnotations call (${S.getTypeNameFor(e)} did not match expected ${s})`):t=`Workflow produced an output that is not an annotation ${S.getTypeNameFor(e)}`;else t="No item provided";else t="Workflow produced an invalid annotation array";if(t)return C(t,h),void c(C(t));if(l=u&&u.isSessionAnnotation?["session"]:u&&u.ancestorType?O.parentPath:O.parentPath.concat(O.id),f.annotations.push({path:l,annotationType:s,annotations:a}),i===_n.External)return;const d=[],m=[];for(const t of a){t.metadata=Object.assign(Object.assign({},t.metadata),{state:Pn.Sent}),v(Pn.Sent);const n=t.id,o=n?null===(e=r.getContextAnnotations(s,En.LocalWorkflow,l,g.id))||void 0===e?void 0:e.filter((e=>{var t;return(null===(t=e.body)||void 0===t?void 0:t.id)==n})):void 0;1==(null==o?void 0:o.length)?1==o.length?m.push({id:o[0].id,source:g.id,revId:y,body:t,contextId:b}):p.a.error(545837260,p.b.CoreDefault,`Assert: Multiple existing context annotations with body id ${n} found for ${s} and local workflow ${g.id}).`):d.push({id:this.getNextClientAnnotationId(),source:g.id,revId:y,body:t,contextId:b})}const w=[];return d.length>0&&w.push(new P({parentPath:l,items:d,parentRevId:y})),m.length>0&&w.push(new L({parentPath:l,items:m,parentRevId:y})),new Se({annotationType:s,ops:w})})();E?(u&&u.immediate?r.onAnnotationResults(E,En.LocalWorkflow,(()=>{})):m.push(E),(T==$n.getTypeName()||T==Qn.getTypeName()||S.matchesTypesFor(O.body,[Un.getTypeName(),Wn.getTypeName()]))&&r.submitOperationsToSession(E.ops),p.a.info(509644822,p.b.CoreDefault,h.stop())):p.a.info(509644823,p.b.CoreDefault,h.stop())},submitSignals:e=>{if(i===_n.External)return void c(C("NYI"));const t=new d({operationName:"submitSignalsAction",resourceId:g.id,success:!0}).setClientMetadata(r.getClientMetadata());for(const n of e){const e=S.getTypeNameFor(n);S.matchesTypesFor(n,[_.getTypeName()])||(t.resultDescription=`Workflow produced an output that is not an signal (${S.getTypeNameFor(n)})`,p.a.info(521413954,p.b.CoreDefault,t)),g.outputTypes&&-1!==g.outputTypes.indexOf(e)||(t.resultDescription=`Workflow said it would output one of [${g.outputTypes}] but instead output ${e}`,p.a.info(521413953,p.b.CoreDefault,t)),n.timestamp&&(hr.logTimestampUsageByWorkflowId.has(g.id)||(hr.logTimestampUsageByWorkflowId.add(g.id),t.resultDescription=`Workflow "${g.id}" sets signal.timeStamp`,p.a.info(509212803,p.b.CoreDefault,t)))}const n=e.map((e=>({id:this.getNextClientSignalId(),source:g.id,revId:y,body:e,contextId:b}))),o=new q({parentPath:["session"],parentRevId:y,items:n});r.submitOperations([o])},done:T,overrideWorkflowDefinition:(e,n,o)=>{let i;switch(o){case xn.JoinContext:if(!t.contextId){const e="ContextId is not defined for this scope item.";throw p.a.error(527472289,p.b.CoreDefault,e),new Error(e)}i=t.contextId;break;case xn.Session:i=void 0;break;default:{const e="Defined scope is not supported. "+o;throw p.a.error(527472290,p.b.CoreDefault,e),new Error(e)}}const s=new Ot({definition:n,contextId:i,sourceWorkflowId:g.id,targetWorkflowId:e});r.onWorkflowDefinitionOverrideMessage(s)}},j=e.workflowLambda;if(g.kind===Pt.SingleItem){1!==n.length&&T(new Error("Single item workflows expect a single input")),O.delta=n[0].delta,O.deltas=n[0].deltas;try{const t=j;e.initPromise||(e.initPromise=t.init(this.site,O)),e.initPromise.then((()=>{t.execute(n[0].body,O,E)})).catch((e=>{C(e)}))}catch(e){C(e)}}else if(g.kind===Pt.Join){0===n.length&&T(new Error("Join workflows expect an inputs array")),O.delta=t.delta,O.deltas=t.deltas;try{const r=j;e.initPromise||(e.initPromise=r.init(this.site,O)),e.initPromise.then((()=>{r.execute(t.body,n.map((e=>e.body)),O,E)})).catch((e=>{C(e)}))}catch(e){C(e)}}else C(`Workflow kind ${g.kind} not supported`)}))}ensureSweepTimer(e){if(!this.sweepTimers.get(e)){const t=setInterval(this.onSweep.bind(this),this.sweepIntervalMs);this.sweepTimers.set(e,t)}}cancelSweepTimer(e){const t=this.sweepTimers.get(e);this.sweepTimers.get(e)&&(clearInterval(t),this.sweepTimers.delete(e))}onSweep(){this.sweepScopeExecutionNotifications()}setScopeExecutionNotification(e,t,n,r){var o,i;const s=Date.now(),a={session:e,workflowImplementation:t,scopeItem:n,startTime:s,minTime:s+G(t.workflow.minDelayMs,1e3),maxTime:s+G(t.workflow.maxDelayMs,5e3),orchestrationMode:r},c=t.workflow.kind===Pt.Join?n.contextId:a.scopeItem.parentPath.concat(n.id).join("\\");if(this.pendingScopeExecutionNotificationsByWorkflow.get(t.workflow.id)||this.pendingScopeExecutionNotificationsByWorkflow.set(t.workflow.id,new Map),this.pendingScopeExecutionNotificationsByWorkflow.get(t.workflow.id).get(c)){const r=new d({resultDescription:`Duplicated pending scope execution for ${t.workflow.id} at ${c}`,operationName:"LocalScopeExecutionNotification",resourceId:t.workflow.id,joinContextId:null!==(i=null==n?void 0:n.contextId)&&void 0!==i?i:"",success:!0}).setClientMetadata(e.getClientMetadata()).start();p.a.info(509727899,p.b.CoreDefault,r.stop())}else{const r=new d({resultDescription:`New pending scope execution for ${t.workflow.id} at ${c}`,operationName:"LocalScopeExecutionNotification",resourceId:t.workflow.id,joinContextId:null!==(o=null==n?void 0:n.contextId)&&void 0!==o?o:"",success:!0}).setClientMetadata(e.getClientMetadata()).start();p.a.info(539883075,p.b.CoreDefault,r.stop()),this.pendingScopeExecutionNotificationsByWorkflow.get(t.workflow.id).set(c,a)}this.ensureSweepTimer(e)}sweepScopeExecutionNotifications(){var e,t;const n=new Set(Array.from(this.sweepTimers.keys()));for(const[r,o]of Array.from(this.pendingScopeExecutionNotificationsByWorkflow.entries()))for(const[i,s]of Array.from(o.entries())){const{session:o,workflowImplementation:{workflow:a},orchestrationMode:c}=s,u=o.getWorkflowItemStorage(),l=new d({operationName:"LocalScopeExecutionNotification",resourceId:a.id,joinContextId:null!==(t=null===(e=s.scopeItem)||void 0===e?void 0:e.contextId)&&void 0!==t?t:"",success:!0}).setClientMetadata(o.getClientMetadata()).start(),h=()=>{if(a.kind===Pt.Join){const e=Date.now(),{workflow:t}=s.workflowImplementation,n=s.scopeItem.contextId,r=o.getWorkflowDefinition(t,n).maxDelayMs;return u.isWorkflowReady(n,t)?(l.resultDescription=`Join Workflow: ${t.id} queuing by maxAnnotation, contextId: ${n}`,p.a.info(528048978,p.b.CoreDefault,l.stop()),{isValid:!0,triggerReason:dr.JoinMaxAnnnotation}):s.startTime+r<e?(l.resultDescription=`Join Workflow: ${t.id} queuing by maxTimeout, contextId: ${n}`,p.a.info(528048979,p.b.CoreDefault,l.stop()),{isValid:!0,triggerReason:dr.JoinMaxTimeout}):this.isReadyToEarlyJoin(this.executionTrackersByWorkflowNameBySession.get(o).get(t.id),n,o.getClientMetadata())?(p.a.info(512550856,p.b.CoreDefault,`Workflow: ${t.id} queuing by early completion, contextId: ${n}, timeout: ${r}`),{isValid:!0,triggerReason:dr.JoinEarlyCompletion}):{isValid:!1,triggerReason:dr.Unknown}}return{isValid:!0,triggerReason:dr.Unknown}};(()=>{const{isValid:e,triggerReason:t}=h();if(!e)return!1;const[n,r]=o.resolveRequestedContexts(a);if(!n)return!1;try{if(a.kind===Pt.Join){const e=s.scopeItem.contextId,n=u.getScopeItem(e,a);if(n){const i=u.getItemsToExecute(n.contextId,a);if(0===i.length)return l.resultDescription=`Failed to retrieve items for workflow: ${a.id}, contextId: ${e}, skipping execution`,p.a.info(527472291,p.b.CoreDefault,l.stop()),this.onWorkflowExecuted(n,a,o),!0;this.queueWorkflow({workflowInfo:s.workflowImplementation,scopeItem:n,inputItems:i,requestedContexts:r,session:o,orchestrationMode:c,triggerReason:t,onCompleteCallback:this.onWorkflowExecuted.bind(this,n,a,o)}).catch((e=>{l.success=!1,l.resultDescription=e.message,p.a.error(509092189,p.b.CoreDefault,l.stop())}))}else l.resultDescription="ContextId no longer exists, skipping workflow execution",p.a.info(539883076,p.b.CoreDefault,l.stop())}else l.resultDescription=`Workflow in type ${a.kind} is not supported`,p.a.error(539883077,p.b.CoreDefault,l.stop())}catch(e){l.resultDescription=`Trying to execute ${a.id} caused an exception: ${e}`,p.a.warn(539883078,p.b.CoreDefault,l.stop())}return!0})()?(this.pendingScopeExecutionNotificationsByWorkflow.get(r).delete(i),0===this.pendingScopeExecutionNotificationsByWorkflow.get(r).size&&this.pendingScopeExecutionNotificationsByWorkflow.delete(r)):n.delete(o)}if(0!==n.size)for(const e of Array.from(n)){const t=new d({resultDescription:"No pending scope notifications left, cancelling sweep timer",operationName:"LocalScopeExecutionNotification",success:!0}).start();p.a.debug(539883079,p.b.CoreDefault,t.stop()),this.cancelSweepTimer(e)}}onExternalWorkflowExecuted(e,t,n){this.onWorkflowExecuted({id:"",parentPath:[],contextId:e},{id:t},n,!1)}onWorkflowExecuted(e,t,n,r=!0){var o;null===(o=this.executionTrackersByWorkflowNameBySession.get(n).get(t.id))||void 0===o||o.afterWorkflowExecution(e.contextId),r&&t.kind===Pt.Join&&n.getWorkflowItemStorage().onWorkflowExecuted(e,t)}}class fr{constructor(e=500,t=!1){this.prevSeq=-1,this.bufferingTimeMs=e,this.rejectOutdatedSequenceNumbers=t}sequence(e){return new Promise(((t,n)=>{if(e<this.prevSeq){if(this.rejectOutdatedSequenceNumbers){const t=new Error(`BufferingSequencer: Item out of order. Expecting seqId > ${this.prevSeq}. Actual seqId ${e}`);return t.name=fr.Rejected,void n(t)}this.prevSeq=-1}e!=this.prevSeq+1&&p.a.warn(542712385,p.b.CoreDefault,`BufferingSequencer: got out of order sequence number. Got ${e}, expected ${this.prevSeq+1}`);const r={seq:e,resolve:t};this.insertItem(r),this.runInOrder(r,!0,!1)}))}insertItem(e){if(!this.firstQueueItem)return this.firstQueueItem=e,void(this.lastQueueItem=e);let t=this.lastQueueItem,n=null;do{if(e.seq>t.seq)return e.prev=t,t.next=e,void(n?n.prev=e:this.lastQueueItem=e);n=t,t=t.prev}while(t);n&&(n.prev=e),e.next=n,this.firstQueueItem=e}runInOrder(e,t,n){let r=this.prevSeq,o=!1;const i=[];for(;this.firstQueueItem;){const t=this.firstQueueItem;if(r+1!=t.seq&&(!n||t.seq>e.seq))break;r=t.seq,t.timeout&&clearTimeos.firstQueueItem=this.firstQueueItem.next,this.fitem.prev=null)}i.length>0&&setTimeout((()=>{for(const e of i)e.resolve(e.seq)}),0),this.prevSeq=r,!o&&t&&(e.timeout=setTimeout((()=>{this.runInOrder(e,!1,!0)}),this.bufferingTimeMs))}}fr.Rejected="SequenceItemRejected";class pr{constructor(e=500){this.bufferingTimeMs=500,this.workflowIdToSequencersMap=new Map,this.bufferingTimeMs=e}create(e){if(!e.ownerId)return null;let t=this.workflowIdToSequencersMap.get(e.ownerId);return t||(t=new fr(this.bufferingTimeMs),this.workflowIdToSequencersMap.set(e.ownerId,t)),t}}class mr{constructor(e=500,t){this.sequencerion s(e){try{a(r.throw(e))}catch(e){o(e)}}function a(e){e.done?t(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(i,s)}a((r=r.apply(e,[])).next())}))}(this,0,void 0,(function*(){if(null==(null===(t=null==e?void 0:e.metadata)||void 0===t?void 0:t.seq))return;const n=this.sequencerFactory.create(e);n&&(yield n.sequence(e.metadata.seq))}))}}class gr{constructor(e){this.annotationSequencer=null!=e?e:new mr}process(t o=[];for(const r of e.ops){const e=[];void 0:r.items)for(consttems){const o=this.annotationSequencer.sequence(n.body).then((()=>{t(r,n)}));e.push(o)}o.push(Promise.all(e).then((()=>{n(r)})))}Promise.all(o).then((()=>r(e)))}}class vr{process(e,t,n,r){for(const r of e.ops){if(null==r?void 0:r.items)for(const e of r.items)t(r,e);n(r)}r(e)}}class br{constructor(e,t,n){this.isOrderingEnabled=e,this.orderedAnnotationResultsProcessor=null!=t?t:new gr,this.unorderedAnnotationResultsProcessor=null!=n?n:new vr}process(e,t,n,r){this.isOrderingEnabled()?this.orderedAnnotatioss(e,t,n,r)}}class yr extensendMessage(e,t,n){}onMessage(e,t){}forceReconnect(){return Promise.resolve()}closeSession(){}sendBytes(e){}getCorrelationVector(){return new $}setState(e){}}class wr{constructor(e,t,n){this.sessionsByDocSessionId=new Map,this.isDeltaGeneratorEnabled=!1,this.disableSyncDeltaSending=!1,this.hasBeenInitialized=!1,this.settings={dropOnlySequencedSyncsOnReseedEnabled:!0,closeWSBlockedSessionEnabled:!0,sessionOfflineModeEnabled:!0,annotationsOrderingEnabled:!1,deltaOperationsEnabled:!1,checkIdbByFeatures:!1,improvedWebSocketEnabled:!1,defaultBatchingEnabled:!0,batchingWith20msIntervalEnabled:!0},this.isDownloaderCompatible=()=>{if(this.settings.checkIdbByFeatures)return"undefined"!=typeof Array&&void 0!==Array.from&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL;if("undefined"!=typeof navigator&&navigator.userAgent){const e=navigator.userAgent;return!(!e.indexOf||e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0)}return!1},this.workerFactoryV);const r=this.createDefaultSessionManagerFactory();this.sessionManagerFactory=(...e)=>(null==t?void 0:t(...e))||r(...e),this.sessionFactory=n||(e=>new In(e))}init(e,t,r,o){var i,s,c,u,l,h;const f=new d({operationName:"InitRuntime",resourceId:e,dimension1:this.hasBeenInitialized.toString()});f.start(),this.hasBeenInitialized=!0,this.hostCallbacks=r,this.shouldAddLogger(f)?(p.a.addLogger(new w(this.hostCallbacks)),this.addLoggingAggregator(o)):(p.a.clearLoggers(),p.a.addLogger(new w(this.hworkMode===st.LocalWorkflowsOnly&&(this.sessionManagerFactory=()=>new yr),this.annotationResultsProcessor=new br((()=>this.settings.annot),this.inferenceServiceFactory=o.inferenceServiceFactory,this.clientMetadata=t,this.clientMetadata&&(this.clientMetadata.runtimeVersion=(()=>n("9u6N").version)()),this.websocketSettings=o.websocketSettings,f.dimension2=Object(p.c)(a.a.info).toString();const m=[];e&&(this.defaultServiceUrl=H.convertServiceUrlToWebSocket(e),this.serviceProtocol=this.defaultServiceUrl.split(":")[0].toLowerCase()),m.push(this.isFeatureEnabled("CheckIdbByFeatures",!1).then((e=>{this.settings.checkIdbByFeatures=e}))),m.push(this.isFeatureEnabled("DropOnlySequencedSyncsOnReseedDisabled").then((e=>{this.settings.dropOnlySequencedSyncsOnReseedEnabled=!e}))),m.push(this.isFeatureEnabled.settings.closeWSBlockedSessionEnabled=!e}))),m.push(this.isFeatureEnab.settings.sessionOfflineModeEnabled=!e}))),m.push(this.isFeatureEnabled("AnnotationsOrderingEnabled",!1).then((e=>{this.settings.annotationsOrderingEnabled=e}))),m.push(this.isFeatureEnabled("ImprovedWebsocketEnabled").then((e=>{var t;(t=this.settings).improvedWebSocketEnabled||(t.improvedWebSocketEnabled=e)}))),m.push(this.isFeatureEnabled("DefaultBatchingDisabled").then((e=>{var t;(t=this.settings).defaultBatchingEnabled&&(t.defaultBatchingEnabled=!e)}))),m.push(this.isFeatureEnabled("BatchingWith20msIntervalDisabled").then((e=>{var t;(t=this.settings).batchingWith20msIntervalEnabled&&(t.batchingWith20msIntervalEnabled=!e)})));const g={enableDeltas:!1,enableEarlyJoin:!1};m.push(Promise.all([this.iperationsleDeltas=e)).catch((()=>g.enableDeltas=!1)),this.isFeatureEnabled("EarlyJoinCompletionEnabled").then((e=>g.enableEarlyJoin=e)).catch((()=>g.enableEarlyJoin=!1))]).then((()=>{this.localWorkflowManager=new hr(o.modelDownloader&&this.isDownloaderCompatible()?o.modelDownloader:void 0,this.inferenceServiceFactory,g)})));const v=ar(null!==(i=t.flights)&&void 0!==i?i:"");return this.isDeltaGeneratorEnabled=v.getBooleanValue("Microsoft.Office.WordOnline.AugloopDeltas",null!==(s=o.isDeltaGeneratorEnabled)&&void 0!==s&&s),this.disableSyncDeltaSending=v.getBooleanValue("Microsoft.Office.WordOnline.DisableSyncDeltaSending",null!==(c=o.disableSyncDeltaSending)&&void 0!==c&&c),this.syncDeltaTimeout=v.getIntValue("Microsoft.Office.WordOnline.SyncDeltaTimeout",o.syncDeltaTimeout),(u=this.settings).improvedWebSocketEnabled||(u.improvedWebSocketEnabled=v.getBooleanValue("Microsoft.Office.WordOnline.Augloop.ImprovedWebsocketEnabled",!1)),(l=this.settings).defaultBatchingEnabled&&(l.defaultBatchingEnabled=!v.getBooleanValue("Microsoft.Office.WordOnline.Augloop.DefaultBatchingDisabled",!1)),(h=this.settings).batchingWith20msIntervalEnabled&&(h.batchingWith20msIntervalEnabled=!v.getBooleanValue("Microsoft.Office.WordOnline.Augloop.BatchingWith20msIntervalDisabled",!1)),Promise.all(m).then((()=>{this.batchOptions=o.batchOptions,!this.batchOptions&&this.settings.defaultBatchingEnabled&&(this.batchOptions={delayMs:1,maxInputSize:1e6},this.settings.batchingWith20msIntervalEnabled&&(this.batchOptions.delayMs=20)),f.dimension0=JSON.stringify(this.batchOptions),this.logOperation(f,!0)})).catch((e=>{this.logOperation(f,!1,"EreProtocol(){return this.serviceProtocol}registerLocalWorkflow(e){this.localWorkflowManager.registerLocalWorkflow(e)}flushTelemetry(e){p.a.flushAggregators(e)}createSession(e){var t;const n=e&&e.docSessionId?e.docSessionId:kn(),r=this.sessionsByDocSessionId.get(n);if(r&&!1===r.isClosed)throw new Error("docSessionId already exists");let o=e&&null!==(t=e.serviceUrl)&&void 0!==t?t:this.defaultServiceUrl;o=H.convertServiceUrlToWebSocket(o),o||(e.networkMode=st.LocalWorkflowsOnly);const i=Object.assign({},this.clientMetadata);i.docSessionId=n,e&&e.flights&&(i.flights=i.flights?i.flights+";"+e.flights:e.flights);const s=this.sessionFactory({hostCallbacks:this.hostCallbacks,sessionManager:this.sessionManagerFactory(i,o,e,this.websocketSettings),batchOptions:this.batchOptions,extensionConfigs:(null==e?void 0:e.extensionConfigs)||[],clientMetadata:i,userContext:e?e.userContext:void 0,localWorkflowManager:e&&e.enableComplexLocalWorkflows?void 0:this.localWorkflowManager,annotationResultsProcessor:this.annotationResultsProcessor,localRegisteredWorkflows:(null==e?void 0:e.localRegisteredWorkflows)||[],enableRemoteExecutionNotification:(null==e?void 0:e.enableRemoteExecutionNotification)||!1,networkMode:e&&void 0!==e.networkMode?e.networkMode:void 0,egress:e?e.egress:void 0,isDeltaGeneratorEnabled:this.isDeltaGeneratorEnabled,disableSyncDeltaSending:this.disableSyncDeltaSending,syncDeltaTimeout:this.syncDeltaTimeout});return this.sessionsByDocSessionId.set(n,s),e&&e.onSessionConnect&&s.setConnectCallback(e.onSessionConnect),e&&e.onSessionDisconnect&&s.setDisconnectCallback(e.onSessionDisconnect),e&&e.onSessionReconnect&&s.setReconnectCallback(e.onSessionReconnect),e&&e.onSessionClose&&s.setSessionCloseCallback(e.onSessionClose),e&&e.onServerAuthenticationStateChangeCallback&&s.setServerAuthenticationStateChangeCallback(e.onServerAuthenticationStateChangeCallback),s.initialize?s.initialize():Promise.resolve(s)}getSessionManagerFactory(){return this.sessionManagerFactory}shouldAddLogger(e){if(wr.haveCalledInit){const t=new Error("Runtime already initialized");return e.dimension3=t.stack,e.dimension2=Object(p.c)(a.a.info).toString(),this.logOperation(e,!1,"Error",t.message),!1}return!0}createDefaultSessionManagerFactory(){return(e,t,n)=>{if(n&&n.enableComplexLocalWorkflows)throw new Error("NYI");if(n&&n.networkMode==st.LocalWorkfyr;const r=new Dn,o=new Nn;let i=()=>{p.a.error(573321615,p.b.CoreDefault,"Unexpectedly not set sendMessage")};const s=new Ln((()=>o),e,r,((e,t,n)=>{i(e,t,n)}),{getAuthToken:this.getAuthToken.bind(this,e.docSessionId),overrideSessionInitMessage:this.hostCallbacks.overrideSessionInitMessage,enableRemoteExecutionNotification:(null==n?void 0:n.enableRemoteExecutionNotification)||!1})ToWebSocket(t),o,this.workerFactory,s,e,r,this.settings,this.websocketSettings);return i=a.sendMessage.bind(a),a.on("disconnect",(()=>r.clearRefreshTimeouts())),a.on("connect",((e,t,n,r)=>{e&&this.hostCallbacks.setSessionData&ssionData(t,n,r)})),a}}getAuthToken(e){const t={Tickets:[]};return e&&(t.DocSessionId=e),this.hostCallbacks.requestAuthToken(t).then((e=>{if(e)return e.Token})).catch((()=>{}))}isFeatureEnabled(e,t=!1,n="None"){return H.isFeatureEnabled(this.hostCallbacks,e,t,n)}logOperation(e,t,n,r){e.stop(),e.success=t,e.resultSignature=n,e.resultDescription=r,p.a.info(573321622,p.b.CoreDefault,e)}addLoggingAggregator(e){var t,n,r;p.a.addAggregator(y("Operation","operationName",["ExecuteBatch","ProcessResponse","LocalDeltaUpdate","ApplyFormattedTextTileDeltaForLocalWorkflows","ApplyTextTileDeltaForLocalWorkflows","FindRangeForDelta","RunModelForInferencing","GetResource","CreateTextTileDeltaFromItem","WSEgressControl","OnAnnotationResultsEgress"],null!==(t=e.telemetryAggregationIntervalSec)&&void 0!==t?t:30)),p.a.addAggregator(y("Operation","operationName",["ExecuteWorkflow","ExecuteLambda","RunLocalWorkflows"],null!==(n=e.telemetryAggregationIntervalSec)&&void 0!==n?n:60)),p.a.addAggregator(y("SessionHealth","sessionHealthEventName",["SendMessage","ProcessMessage"],null!==(r=e.telemetryAggregationIntervalSec)&&void 0!==r?r:60))}uninitialize(){this.flushTelemetry(!0),this.hostCallbacks=null,this.hasBeenInitialized=!1,wr.haveCalledInit=!1,p.a.clearAggregators(),p.a.clearLoggers()}}new wr;var Cr=n("5Q+G"),Or=n("V2nY");class Tr{constructor(e){Or.a.assign(Tr,this,e)}static getTypeName(){return"AugLoop_Core_Blob"}static getBaseTypes(){return[]}static typeGuard(e){return Or.a.matchesTypesFor(e,[Tr.getTypeName()])}}Tr.H_={T_:Tr.getTypeName(),B_:Tr.getBaseTypes()};class Sr{constructor(e){Or.a.assign(Sr,this,e)}static getTypeName(){return"AugLoop_Core_Binary"}static getBaseTypes(){return[]}static typeGuard(e){return Or.a.matchesTypesFor(e,[Sr.getTypeName()])}}Sr.H_={T_:Sr.getTypeName(),B_:Sr.getBaseTypes()};class kr{constructor(e){Or.a.assign(kr,this,e)}static getTypeName(){return"AugLoop_Core_TileGroup"}static getBaseTypes(){return[]}static typeGuard(e){return Or.a.matchesTypesFor(e,[kr.getTypeName()])}}kr.H_={T_:kr.getTypeName(),B_:kr.getBaseTypes()};class Er{constructor(e){Or.a.assign(Er,this,e)}static getTypeName(){return"AugLoop_Core_Session"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return Or.a.matchesTypesFor(e,[Er.getTypeName()])}}Er.H_={T_:Er.getTypeName(),B_:Er.getBaseTypes()};class _r{constructor(e){Or.a.assign(_r,this,e)}static getTypeName(){return"AugLoop_Core_Document"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return Or.a.matchesTypesFor(e,[_r.getTypeName()])}}_r.H_={T_:_r.getTypeName(),B_:_r.getBaseTypes()};class jr{constructor(e){Or.a.assign(jr,this,e)}static getTypeName(){return"AugLoop_Core_SubDocument"}static getBaseTypes(){return[]}static typeGuard(e){return Or.a.matchesTypesFor(e,[jr.getTypeName()])}}jr.H_={T_:jr.getTypeName(),B_:jr.getBaseTypes()};class Ir{constructor(e){Or.a.assign(Ir,this,e)}static getTypeName(){return"AugLoop_Core_GridCell"}static getBaseTypes(){return[]}static typeGuard(e){return Or.a.matchesTypesFor(e,[Ir.getTypeName()])}}Ir.H_={T_:Ir.getTypeName(),B_:Ir.getBaseTypes()};class Nr{constructor(e){Or.a.assign(Nr,this,e)}static getTypeName(){return"AugLoop_Core_GridNeighborhoodContext"}static getBaseTypes(){return[]}static typeGuard(e){return Or.a.matchesTypesFor(e,[Nr.getTypeName()])}}Nr.H_={T_:Nr.getTypeName(),B_:Nr.getBaseTypes()};class Ar{constructor(e){Or.a.assign(Ar,this,e)}static getTypeName(){return"AugLoop_Core_ItemFilter"}static getBaseTypes(){return[]}static typeGuard(e){return Or.a.matchesTypesFor(e,[Ar.getTypeName()])}}Ar.H_={T_:Ar.getTypeName(),B_:Ar.getBaseTypes()};class Pr{constructor(e){Or.a.assign(Pr,this,e)}static getTypeName(){return"AugLoop_Core_DynamicContext"}static getBaseTypes(){return[]}static typeGuard(e){return Or.a.matchesTypesFor(e,[Pr.getTypeName()])}}Pr.H_={T_:Pr.getTypeName(),B_:Pr.getBaseTypes()};class xr{constructor(e){Or.a.assign(xr,this,e)}static getTypeName(){return"AugLoop_Core_ContextHolder"}static getBaseTypes(){return[]}static typeGuard(e){return Or.a.matchesTypesFor(e,[xr.getTypeName()])}}xr.H_={T_:xr.getTypeName(),B_:xr.getBaseTypes()};class Dr{constructor(e){Or.a.assign(Dr,this,e)}static getTypeName(){return"AugLoop_Core_UserContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(e){return Or.a.matchesTypesFor(e,[Dr.getTypeName()])}}Dr.H_={T_:Dr.getTypeName(),B_:Dr.getBaseTypes()};class Lr{constructor(e){Or.a.assign(Lr,this,e)}static getTypeName(){return"AugLoop_Core_TenantContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(e){return Or.a.matchesTypesFor(e,[Lr.getTypeName()])}}Lr.H_={T_:Lr.getTypeName(),B_:Lr.getBaseTypes()};class Mr{constructor(e){Or.a.assign(Mr,this,e)}static getTypeName(){return"AugLoop_Core_EventsHolder"}static getBapeGuard(e){return Or.a.matchesTypesFor(e,[Mr.getTypeName()])}}Mr.H_={T_:Mr.getTypeName(),B_:Mr.getBaseTypes()};class Rr{constructor(e){Or.a.assign(Rr,this,e)}static getTypeName(){return"AugLoop_Core_UserCommandsHolder"}static getBaseTypes(){return["AugLoop_Core_EventsHolder"]}static typeGuard(e){return Or.a.matchesTypesFor(e,[Rr.getTypeName()])}}Rr.H_={T_:Rr.getTypeName(),B_:Rr.getBaseTypes()};var Fr=n("MJsD"),Br=n("gCKw"),Ur=n("elnK"),Wr=n.n(tion(e,t){return{runtimeInitPromises:new Map,getRuntime:function(n){void 0===n&&(n=s);var o=t().runtimeInitPromises,a=o.get(n);if(a)return a;var c=(()=>new wr)(),u=new Promise((function(e,t){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var o,s,a,u,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(Fr.a)()];case 1:return o=r.sent(),s=function(e){var t=1===e.TokenType?"Substrate":"AugLoop";return o.getAccessToken(t,!1,"AugLoop"===t&&"Int"===n?"https://augloop-int.officeppe.com/v2":void 0).then((function(t){return{Token:t.token,TokenProperties:{returnedTokenType:1===e.TokenType?1:0,timeToLiveSec:t.expiryMs}}}))},[4,Object(Br.a)()];case 2:return a=r.sent(),u=(null===(l=a.result.magicGroupingGates)||void 0===l?void 0:l.magicGroupingLLMWorkflowEnabled)?"magicGroupingLLMWorkflowEnabled":"",c.init(i[n],{appN:"Microsoft",sessuthToken:s,sendTelemetryEvents.length;t++)e[t]=arguments[t]},isFeatureEurn PromisEnabled:function(){return Promise.resolve(!0)}},{telemetryAggregationIntervalSec:30}).then((function(){return e(c)})).catch((function(e)return e({runtimeInitPromises:o.set(n,u)}),u},createSession:function(e){return void 0===e&&(e=s),t().getRuntime(e).then((function(e){return e.createSession()})).then((function(e){return e.setConnectCallback((function(t){if(t){var n=new Cr.a({parentPath:["session"],items:[{id:"doc",revId:"0",body:new _r({isReadonly:!1})}]});e.submitSeedOperations([n])}})),e}))}}}));function qr(e,t,n){var i=this;void 0===n&&(n=s);var a=Wr(),c=function(e,t){var n=Object(r.__read)(Object(o.useState)(void 0),2),i=n[0],s=n[1],a=Object(o.useRef)(),c=Object(o.u(o.useRef)(t);return Object(o.useEffect)((fua.current)&&void 0!==e?e:c.current();a.current||(a.current=t),t.then((function(e){s(e)}));var n=u.current;return function(){t.then((function(e){null==n||n(e)}))}}),[]),i}(Object(o.useCallback)((function(){return Object(r.__awaiter)(i,void 0,void 0,(function(){var t,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,a.createSession(n)];case 1:return t=r.sent(),[4,e(t)];case 2:return o=r.sent(),[2,[t,o]]}}))}))}),[a,e,n]),Object(o.}},bEtion(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return s}));var r="UserEntitlements",o="userEntitlements",i="userEni=n("OmE2"),s={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!r.isUndefi:!1},adapter:function/json"),function(e,forcedJSONParsing&&r.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(n){if("SyntaxError"===e.name)throw i(e,th e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBonction(e){return e>=200&&e<300},head, text/plain, */*"}}};r.forEach(["delete","get","head"],(function(e){c.headers[e]={}})),r.forEach(["post","put","patch"],(function(e){c.headers[e]=r.merge(s)})),e.exports=c}).call(this,n("5IsQ"))},bb9Y:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("QjXU"),o=n("28zg"),i=n("gy05");function s(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return[2,Object(o.a)(i.a)]}))}))}},bcUD:function(e,t,n){"use strict";n.d(t,"a",(function(){return A}));var r=n("QjXU"),o=n("CaQ9"),i=n("wVmX"),s=n("Coo+"),a=n("mXGw"),c=n("S6Pj"),u=n("a3FV"),l=n("MJsD"),d=n("B5kz"),h=n("CMIS"),f=n("Wa5Y"),p={dime:void 0,dimeDisabled:!1,dimeLoadPromise:void 0},m=n("W7wX"),g=n("cenr"),v=n("Dn7E"),b=function(e){var t=e.eventName,n=e.dimeExperience,o=e.result,i=void 0===o?"":o,s=e.metaData,a=void 0===s?"":s,c=e.extraInfo,u=void 0===c?"":c;return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e,o,s,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:e="",r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(m.a)()];case 2:return(null==(o=r.sent())?void 0:o.userCountryCode)&&(e=null==o?void 0:o.userCountryCode),[3,4];case 3:return r.sent(),[3,4];case 4:if((s={}).DimeExperience=n,s.State=i,s.UserCountryCode=e,c=u?u+";":"","string"==typeof a&&a)c+=a;else try{c+=JSON.stringify(a)}catch(e){}return s.DebugInfo=c,Object(g.a)(t,s),Object(v.a)({featureName:"Upsell",eventName:t,area:"Other",params:{DimeExperience:n,State:i,DebugInfo:c,UserCountryCode:e}}),[2]}}))}))},y=n("GeVZ"),w=n("Ot9e"),C=n("6MXh"),O=function(e){var t=e.dimeJSUrl,n=e.puid,o=e.upn,i=e.pwaEnabled,s=e.preferredCulture,a=e.sessionId;return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return p.dimeLoadPromise||(performance.mark("LoadDimeScript_Started"),p.dimeLoadPromise=new Promise((function(e){Object(C.a)(t,(function(){b({eventName:u.a.DimeLoadScript,dimeExperience:"",result:"Succeeded"}),performance.mark("LoadDimeScript_Completed"),function(e,t,n,o,i){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var s;return Object(r.__generator)(this,(function(r){if(p.dime)return[2,1];if(p.dimeDisabled)return[2,2];if("undefined"==typeof Dime)throw p.dimeDisabled=!0,b({eventName:u.a.DimeInitialize,dimeExperience:"",result:"Failed",metaData:"Dime Undefined"}),new Error("Unable to initialize. Dime is undefined.");performance.mark("DimeInitialize_Start"),s={partnerId:n?"officepwa":"officedotcom",language:o,sessionId:i,authHint:n?e:t,userInfo:{puid:e}};try{return p.dime=new Dime(s),performance.mark("DimeInitialize_Complete"),b({eventName:u.a.DimeInitialize,dimeExperience:"",result:"Succeeded"}),[2,1]}catch(e){throw p.dimeDisabled=!0,b({eventName:u.a.DimeInitialize,dimeExperience:"",result:"Failed",metaData:e&&"object"==typeof e?e:void 0}),new Error("Error encountered while initializing Dime.")}return[2]}))}))}(n,o,i,s,a).then((function(){e(1)})).catch((function(){e(2)}))}),(function(){b({eventName:u.a.DimeLoadScript,dimeExperience:"",result:"Failed"}),e(2)}),!1,"dimeScriptReact")}))),[2,p.dimeLoadPromise]}))}))},T=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Promise.all([n.e(4),n.e(105)]).then(n.bind(null,"DZQ9"))];case 1:return t.sent().launchUrl(e,{action:"Upsell"}),[2]}}))}))};var S=n("gB6C"),k=n("pdjy"),E=(n("DCX/"),n("m118"),[]),_=n("rbGx"),j=n("NZpx"),I=n("NrNW"),N=n("kPR3"),A=function(e){var t,n=e.experiences,m=e.disableSubscriptionCheck,g=void 0!==m&&m,v=e.disableWarmup,C=void 0!==v&&v,A=function(){var e=Object(I.a)().data,t=Object(N.a)().data,n=Object(j.a)().data,r=Object(o.a)().data;return Object(a.useMemo)((function(){if(e&&t&&n&&r)return{dimeJSUrl:t.dimeJSUrl,dimeTimeoutMs:t.dimeTimeoutMs,preferredCulture:e.preferredCulture,puid:r.puid,pwaEnabled:n.pwaEnabled,sessionId:e.sessionId,upn:r.userPrincipalName||""}}),[n,e,t,r])}(),P=Object(a.useContext)(_.a),x=Object(s.a)().data,D=Object(o.a)().data,L=Object(i.a)(),M=Object(a.useCallback)((function(e,t){A&&function(e){var t,n=e.dimeActionCreators,o=e.dimeExperience,i=e.dimeJSUrl,s=e.dimeTimeoutMs,a=e.preferredCulture,m=e.puid,g=e.pwaEnabled,v=e.sessionId,C=e.targetUrl,S=e.upn;Object(r.__awaiter)(this,void 0,void 0,(function(){var e,k,E,_,j,I,N;return Object(r.__generator)(this,(function(A){switch(A.label){case 0:return p.dimeDisabled?(b({eventName:u.a.DimeLaunch,dimeExperience:o,result:"Failed",metaData:"Redireled"}),T(C),[2]):(e=null,k=O({dimeJSUrl:i,puid:m,upn:S,pwaEnabled:g,preferredCulture:a,sessionId:v}),E=new Promise((function(t){e=setTimeout((function(){t(0)}),s)})),[4,Promise.race([k,E])]);case 1:if(_=A.sent(),e&&clearTimeout(e),1!==_)return p.dimeDisabled=!0,b({eventName:u.a.DimeLaunch,dimeExperience:o,result:"Failed",metaData:"TimeOut"}),[2];try{j=function(e){if(e&&e.indexOf("ocid=")>0){var t=Object(y.a)(e);if(t){var n=Object(w.a)(t.search);return""!==n.ocid?n.ocid:"PROD_OfficeCom"}}return"PROD_OfficeCom"}(C),I={experience:o,campaignId:j},b({eventName:u.a.DimeLaunch,dimeExperience:o,result:"Start"}),null==n||n.setDialogState("Open"),N=document.activeElement,null===(t=p.dime)||void 0===t||t.launch(I,(function(){b({eventName:u.a.DimeTransactionCompleted,dimeExperience:o}),null==n||n.setConvertedToPaid(!0),function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t,n,o,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(l.a)()];case 1:return[4,(e=r.sent()).getIdentity()];case 2:return t=r.sent(),n={headers:(i={accept:"application/json"},i["X-OfficeHome-UserId"]=t.puid,i["X-OfficeHome-TenantId"]=t.tenantId,i)},o="".concat(e.officeHomeApiRoot,"/api/workloadpublicdata/consumer"),o="".concat(o,"?forceRefresh=true"),[2,Object(f.a)(u.a.OfficeConsumerWorkloadPublicDataFetch,"Office_Consumer_Workload_Public_Data_Fetch",o,n,e.jwtAuthEnabled,e.getAccessToken,e.officeHomeApiRoot,e.correlationId,"OfficeHome").then((function(e){if(!e.data)throw new Error("No data returned from Consumer workload public data endpoint");return function(e){var t=["WorkloadPublicDataConfig"];d.a.cancelQueries(t),d.a.setQueryData(t,e)}(e.data),e.data})).catch((function(e){Object(h.a)({eventName:u.a.OfficeConsumerWorkloadPublicDataFetch,message:"Failed to get consumer workload public data with error: ".concat(e)})}))]}}))}))}().then((function(e){b(e?{eventName:u.a.DimeForceRefreshWorkloadPublicData,dimeExperience:o,result:"",metaData:{hasBusinessLicense:e.hasBusinessLicense}}:{eventName:u.a.DimeForceRefreshWorkloadPublicData,dimeExperience:o,result:"Failed",metaData:"NoResponse"})})).catch((function(e){b({eventName:u.a.DimeForceRefreshWorkloadPublicData,dimeExperience:o,result:"Failed",metaData:e})}))})).then((function(e){b({eventName:u.a.DimeCompleted,dimeExperience:o,result:null==e?void 0:e.status,metaData:null==e?void 0:e.metaData}),null==n||n.setDialogState("Closed"),Object(c.a)(N)&&(null==N||N.focus())}))}catch(e){p.dimeDisabled=!0,b({eventName:u.a.DimeLaunch,dimeExperience:o,result:"Failed",metaData:e&&"object"==typeof e?e:void 0,extraInfo:"RedirectToPOC;LaunchException"}),T(C)}return[2]}}))}))}(Object(r.__assign)(Object(r.__assign)({},A),{dimeActionCreators:P,dimeExperience:e,targetUrl:t}))}),[A,P]);return Object(a.useMemo)((function(){var e;if((null==D?void 0:D.isMsa)&&(!L||g)&&!(null==D?void 0:D.isPipl)&&(null===(e=null==x?void 0:x.result)||void 0===e?void 0:e.ShowConsumerUpsell))return C||function(e,t){t&&(t.pwaEnabled&&(null===window||void 0===window?void 0:window.prelaunchmode)||e.forEach((function(e){!function(e,t){-1===E.indexOf(e)&&(E.push(e),b({eventName:u.a.DimeWarmup,dimeExperience:e}),function(e,t){Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){return Object(S.a)((function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,O(t)];case 1:return 1===n.sent()&&function(e){if(p.dime){performance.mark("DimePreload_Start");var t=e.experiences.toString();b({eventName:u.a.DimePreload,dimeExperience:t,result:"Start"}),p.dime.preload(e).catch((function(e){b({eventName:u.a.DimePreload,dimeExperience:t,result:"Failed",metaData:e&&"object"==typeof e?e:void 0})}))}}(e),[2]}}))}))}),k.d),[2]}))}))}({experiences:[e]},t))}(e,t)lt)||void 0===t?void 0:t.ShowConsumerUpsell])}},bim0:function(e,t,n){var r= i(o(e,t,r),e+"")}},bmzq:function(e,t,n){"use strict";var r=n("mXGw"),o=n("xARA"),i=function(){function e(e){this.target=e,this.rendered=!1,this.destroyed=!1}return e.prototype.ngOnInit=function(){this.render()},e.prototype.render=function(){var e=this;return this.onRenderPromise=new Promise((function(t){r&&o?e.getReactElement().then((function(n){return!e.destroyed&&(e.rendered=!0,o.render(n,e.getTargetElementRef().nativeElement,t))})):t()})),this.onRenderPromise},e.prototype.ngOnDestroy=function(){r&&o&&(this.destroyed=!0,this.rendered&&o.unmountComponentAtNode(this.target.nativeElement))},e.prototype.getTargetElementRef=function(){return this.target},e}();t.a=i},"c/bn":function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n("QjXU"),o=n("ntFm"),i=n("VKX6"),s=n("EH+r"),a=n("czhI"),c=n.n(a),u=c.a.create(),l=function(e,t){return"cache-only"===t?Promise.reject("Cache unsupported"):Promise.resolve(e)},d="NotAvailable";function h(e,t,n){return{data:void 0,status:e,headers:{},ok:!1,statusText:n&&"string"==typeof n?n:e.toString(),fromCache:t}}function f(e,t,n,a,f,p,m,g,v){var b=Object(i.a)(),y="cache-only"===a,w=function(e,t,n,o,i,s){var a=this;return new Promise((function(d,f){return Object(r.__awaiter)(a,void 0,void 0,(function(){var a,p,m,g;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(a="cache-only"===n,p={url:e.url,method:e.method,headers:e.headers,params:e.params,data:e.body,timeout:t,responseType:e.responseType,onUploadProgress:o,onDownloadProgress:i},s&&(m=c.a.CancelToken.source(),p.cancelToken=m.token,s.onCancel((function(){return m.cancel()}))),!l)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,l(p,n||"network-only")];case 2:return r.sent(),[3,4];case 3:return g=r.sent(),f(h(501,a,g)),[2];case 4:return u.request(p).then((function(e){d({data:e.data,status:e.status,headers:e.headers,ok:!0,statusText:e.statusText,fromCache:a})}),(function(e){c.a.isCancel(e)?f(h(705,a)):"ECONNABORTED"===e.code?f(h(707,a)):e.response?f({data:e.response.data,status:e.response.status,headers:e.response.headers,ok:!1,statusText:e.response.statusText,fromCache:!1}):window.navigator&&"boolean"==typeof window.navigator.onLine&&!tor.onLine?f(h(706,a)):f(h(-1,a))})),[2]}}))}))}))}(n,v||3e5,a,p,m,g),C=g?g.onCancel((function(){return Promise.resolve(h(705,y))})):new Promise((function(){})),O=function(n){!function(e,t,n,r,a){if(!e.fromCache||e.ok||501!==e.status){var c=Math.ceil(Object(i.a)()-r),u=e.status;null==u&&(u=-2);var l,h=e.statusText,f=h;null==h?(l=d,f=d):l="ok"===h.toLowerCase()?h:{value:h,kind:2};var p={};a&&a(e,p),p.hasOwnProperty("HttpCode")&&(u=p.HttpCode,delete p.HttpCode),Object(s.a)({eventName:n,httpCode:u,error:f,fro=o(window.location.href),function(t){var n=r.isString(t)?o(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return function(){return!0}}()},ccbu:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c}));var r=n("0EWy");let o,i,s;const a=function(){return void 0===o&&(o=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document),o},c=function(){return!Object(r.b)()&&(void 0===s&&(s=/Android|BlackBerry|Windows Phone|IEMobile|Opera Mini|iPhone|iPad|iPod/i.test(navigator.userAgent)||a()||function(){return void 0===i&&(i=navigator.userAgent.indexOf("Android")>=0),i}()),s)}},chxZ:function(e,t,n){"use strict";n.d(ar r=n("QjXU"),o=no.use&&e>-1&&e%1==0&&e<=9007199254740991}},cm7J:function(e,t,n){var r=n("dIZa");e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},cvOW:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n("NrNW"),o=n("7l51"),i=n("CaQ9"),s=n("h8qh"),a=n("HeHW"),c=n("mXGw"),u=n("TA9V"),l=n("1blO"),d=n("jwKD"),h=n("Ry7x"),f=function(){var e=Object(s.a)().data,t=Object(r.a)().data,n=Object(i.a)().data,f=Object(a.a)(),p=Object(h.b)(),m=p.actionExecutor,g=p.actionsEnabled,v=p.actionManager,b=p.contentActions;return Object(c.useMemo)((function(){if(t&&n&&e&&v)return{actionExecutor:g?m:void 0,createDocumentActions:function(r,o,i,s,a){if(!g)return v.createDefaultDocumentActions({document:r,index:o,targetElementId:i.targetElementId,menuResources:e.documentActionsMenuResources,componentContext:t,identity:n,isDarkMode:f});if(!b||!m)return[];var c=Objecturn Object(l.a)(b,m,r,c,i,s)},createCommandActions:function(e,t,n,r,i){return g&&b&&m?Object(l.a)(b.filter((function(e){return e.metadata.groupId===o.a.Share})),m,e,Object(u.a)("content",e,r,i,"ContentActionsCommandMenuItem"),n,r):[]},createSpecificActions:function(e,t,n,r,o,i){return g&&b&conteturn ports=n("TDIH")},d6Vr:function(e,t,n){var r=n("s3UK");e.exports=r["__core-js_shared__"]},dIZa:function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},dP86:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u})),n.s(){if(document.hidden){const e=Date.now();r.forEach(((t,n)=>{-1===ner("visibilitychange",s)}function c(){return i+=1,function(e){document.hidden?r.set(e,0):(o||function(){o=!0,document.addEventListener("visibilitychange",s)}(),r.set(e,-1))}(i),i}function u(e,t){const n=r.get(e);return t&&l(e),n}function l(e){r.delete(e),0===r.size&&o&&a()}},"ddw+":function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n("QjXU"),o=n("mgFK"),i=n("vb0f"),s=n("Ohvh");function a(e){return new Set(e.reduce((function(e,t){var n=Object(s.a)(t);return n?e.concat(n):e}),[]))}function c(e){if(Object(i.a)()){if(void 0!==window.Office){var t=Windows.ApplicationModel.Package.current.id.version;return t.minor>e.minor||t.minor===e.minor&&t.build>=e.build}return!0}return!1}var u=n("11nE"),l=n("Rh0W"),d=n("6ib3"),h=n("Ot9e"),f={key:"CapabilitiesConfig",isGetClientGeneratedConfigEnabled:function(e){var t;return!!(null===(t=e.resolveConfigGates)||void 0===t?void 0:t.resolveConfigCapabilitiesEnabled)},getClientGeneratedConfig:function(e){var t,n,r,o,i,s,f,p,m,g,v,b,y,w,C,O,T,S,k,E,_,j,I,N,A,P,x,D,L,M,R,F,B,U,W,q,H,z,G,V,$,Q,J,X,K,Y,Z,ee,te,ne,re,oe,ie,se,ae,ce,ue,le,de,he,fe,pe,me,ge,ve,be,ye,we,Ce,Oe,Te,Se,ke,Ee,_e,je,Ie,Ne,Ae,Pe,xe,De,Le,Me,Re,Fe,Be,Ue,We,qe,He,ze,Ge,Ve,$e,Qe,Je,Xe,Ke,Ye,Ze,et,tt,nt,rt,ot,it,st,at,ct,ut,lt,dt,ht,ft,pt,mt,gt,vt,bt,yt,wt,Ct,Ot,Tt=e.featureGates,St=e.featureSettings,kt=e.userEntitlements;if(null===kt)throw new Error("UserEntitlements is null");var Et=kt.CreateDocAspxEnabled,_t=kt.HasTeams,jt=kt.HasExchange,It=kt.isConsumerUser,Nt=kt.isCommercialUser,At=kt.IsGovernment,Pt=kt.isPwa,xt=kt.isPwaInUwp,Dt=kt.IsSmb,Lt=kt.OneDriveApisEnabled,Mt=kt.ShowSearch,Rt=Object(u.a)(),Ft=Object(l.a)(),Bt=Object(h.a)(location.search),Ut=null!==(n=null===(t=Tt.abtGates)||void 0===t?void 0:t.abtActivityBasedTimeoutEnabled)&&void 0!==n&&n,Wt=null!==(o=null===(r=Tt.appBarGates)||void 0===r?void 0:r.appBarEnabled)&&void 0!==o&&o,qt=null!==(s=null===(i=Tt.appBarDragDropGates)||void 0===i?void 0:i.appBarDragDropEnabled)&&void 0!==s&&s,Ht=null!==(p=null===(f=Tt.appBarMicaStylesGates)||void 0===f?void 0:f.appBarMicaStylesEnabled)&&void 0!==p&&p,zt=null!==(g=null===(m=Tt.appBarOverflowOnlyGates)||void 0===m?void 0:m.appBarOverflowOnlyEnabled)&&void 0!==g&&g,Gt=null!==(b=null===(v=Tt.appBarPinningGates)||void 0===v?void 0:v.appBarPinningEnabled)&&void 0!==b&&b,Vt=null!==(w=null===(y=Tt.appGalleryGates)||void 0===y?void 0:y.appGalleryShowBusinessApps)&&void 0!==w&&w,$t=null!==(O=null===(C=Tt.authModelGates)||void 0===C?void 0:C.authModelDarkModeEnabled)&&void 0!==O&&O,Qt=null!==(S=null===(T=Tt.authModelGates)||void 0===T?void 0:T.authModelDarkModeOverride)&&void 0!==S&&S,Jt=null!==(E=null===(k=Tt.contentActionsGates)||void 0===k?void 0:k.contentActionsEnabled)&&void 0!==E&&E,Xt=null!==(j=null===(_=Tt.createDocAspxExcelGates)||void 0===_?void 0:_.createDocAspxExcelEnabled)&&void 0!==j&&j,Kt=null!==(N=null===(I=Tt.mruGates)||void 0===I?void 0:I.mruCreateNewDocAspxPowerPointEnabled)&&void 0!==N&&N,Yt=null!==(P=null===(A=Tt.mruGates)||void 0===A?void 0:A.mruCreateNewDocAspxVisioEnabled)&&void 0!==P&&P,Zt=null!==(D=null===(x=Tt.mruGates)||void 0===x?void 0:x.mruCreateNewDocAspxWordEnabled)&&void 0!==D&&D,en=null!==(M=null===(L=Tt.createStreamPlaylistGates)||void 0===L?void 0:L.createStreamPlaylistEnabled)&&void 0!==M&&M,tn=null!==(F=null===(R=Tt.defaultHeaderLayoutGates)||void 0===R?void 0:R.defaultHeaderLayoutEnabled)&&void 0!==F&&F,nn=null!==(U=null===(B=Tt.edgeworthReactGates)||void 0===B?void 0:B.edgeworthReactEnabled)&&void 0!==U&&U,rn=null!==(q=null===(W=Tt.feedGates)||void 0===W?void 0:W.feedEnabled)&&void 0!==q&&q,on=null!==(z=null===(H=Tt.fluentRefreshGates)||void 0===H?void 0:H.fluentRefreshEnabled)&&void 0!==z&&z,sn=null!==(V=null===(G=Tt.fluidConfigGates)||void 0===G?void 0:G.fluidConfigFluidCreateNewEnabled)&&void 0!==V&&V,an=null!==(Q=null===($=Tt.fluidConfigGates)||void 0===$?void 0:$.fluidConfigFluidGCCSupportEnabled)&&void 0!==Q&&Q,cn=null!==(X=null===(J=Tt.fluidConfigGates)||void 0===J?void 0:J.fluidConfigFluidSupportEnabled)&&void 0!==X&&X,un=null!==(Y=null===(K=Tt.lorByDefaultGates)||void 0===K?void 0:K.lorByDefaultEnabled)&&void 0!==Y&&Y,ln=null!==(ee=null===(Z=Tt.m365AppsGates)||void 0===Z?void 0:Z.m365AppsEnabled)&&void 0!==ee&&ee,dn=null!==(ne=null===(te=Tt.m365AppsAboutGates)||void 0===te?void 0:te.m365AppsAboutEnabled)&&void 0!==ne&&ne,hn=null!==(oe=null===(re=Tt.m365TestAppGates)||void 0===re?void 0:re.m365TestAppEnabled)&&void 0!==oe&&oe,fn=null!==(se=null===(ie=Tt.memoryProfilingGates)||void 0===ie?void 0:ie.memoryProfilingEnabled)&&void 0!==se&&se,pn=null!==(ce=null===(ae=Tt.mruGates)||void 0===ae?void 0:ae.mruAddLoginHintToDocUrls)&&void 0!==ce&&ce,mn=null!==(le=null===(ue=Tt.myContentGates)||void 0===ue?void 0:ue.myContentEnabled)&&void 0!==le&&le,gn=null!==(he=null===(de=Tt.myContentGridViewGates)||void 0===de?void 0:de.myContentGridViewEnabled)&&void 0!==he&&he,vn=null!==(pe=null===(fe=Tt.parkGates)||void 0===fe?void 0:fe.parkEnabled)&&void 0!==pe&&pe,bn=null!==(ge=null===(me=Tt.peopleListViewGates)||void 0===me?void 0:me.peopleListViewEnabled)&&void 0!==ge&&ge,yn=null!==(be=null===(ve=Tt.pinningPeopleGates)||void 0===ve?void 0:ve.pinningPeopleEnabled)&&void 0!==be&&be,wn=null!==(we=null===(ye=Tt.quickAccessV1Gates)||void 0===ye?void 0:ye.quickAccessV1Enabled)&&void 0!==we&&we,Cn=null!==(Oe=null===(Ce=Tt.quickAccessV1CustomPivotGates)||void 0===Ce?void 0:Ce.quickAccessV1CustomPivotEnabled)&&void 0!==Oe&&Oe,On=null!==(Se=null===(Te=Tt.quickAccessV1GridViewGates)||void 0===Te?void 0:Te.quickAccessV1GridViewEnabled)&&void 0!==Se&&Se,Tn=null!==(Ee=null===(ke=Tt.remoteModulesGates)||void 0===ke?void 0:ke.remoteModulesEnabled)&&void 0!==Ee&&Ee,Sn=null!==(je=null===(_e=Tt.sharedServicesGates)||void 0===_e?void 0:_e.sharedServicesEnabled)&&void 0!==je&&je,kn=null!==(Ne=null===(Ie=Tt.sideloadAppButtonGates)||void 0===Ie?void 0:Ie.sideloadAppButtonEnabled)&&void 0!==Ne&&Ne,En=null!==(Pe=null===(Ae=Tt.shellGates)||void 0===Ae?void 0:Ae.shellAccountSwitchingEnabled)&&void 0!==Pe&&Pe,_n=null!==(De=null===(xe=Tt.shellGates)||void 0===xe?void 0:xe.shellShellDocumentTitleInFluidEnabled)&&void 0!==De&&De,jn=null!==(Me=null===(Le=Tt.shellGates)||void 0===Le?void 0:Le.shellShellPinEnabled)&&void 0!==Me&&Me,In=null!==(Fe=null===(Re=Tt.spfxAppGates)||void 0===Re?void 0:Re.spfxAppEnabled)&&void 0!==Fe&&Fe,Nn=null!==(Ue=null===(Be=Tt.storeAppGates)||void 0===Be?void 0:Be.storeAppEnabled)&&void 0!==Ue&&Ue,An=null!==(qe=null===(We=Tt.storeAppGates)||void 0===We?void 0:We.storeAppWithoutTeamsLicenseEnabled)&&void 0!==qe&&qe,Pn=null!==(ze=null===(He=Tt.toDoM365AppGates)||void 0===He?void 0:He.toDoM365AppEnabled)&&void 0!==ze&&ze,xn=null!==(Ve=null===(Ge=Tt.unityGates)||void 0===Ge?void 0:Ge.unityEnabled)&&void 0!==Ve&&Ve,Dn=null!==(Qe=null===($e=Tt.universalMeControlSafetyFlightGates)||void 0===$e?void 0:$e.universalMeControlSafetyFlightEnabled)&&void 0!==Qe&&Qe,Ln=null!==(Xe=null===(Je=Tt.universalMeControlPWAGates)||void 0===Je?void 0:Je.universalMeControlPWAEnabled)&&void 0!==Xe&&Xe,Mn=null!==(Ye=null===(Ke=Tt.userPreferenceGates)||void 0===Ke?void 0:Ke.userPreferenceEnabled)&&void 0!==Ye&&Ye,Rn=null!==(et=null===(Ze=Tt.wacHostGates)||void 0===Ze?void 0:Ze.wacHostVisioWacHostEnabled)&&void 0!==et&&et,Fn=null!==(nt=null===(tt=Tt.wacHostGates)||void 0===tt?void 0:tt.wacHostEnabled)&&void 0!==nt&&nt,Bn=null!==(ot=null===(rt=Tt.webVitalsGates)||void 0===rt?void 0:rt.webVitalsEnabled)&&void 0!==ot&&ot,Un=null!==(st=null===(it=Tt.yammerM365AppGates)||void 0===it?void 0:it.yammerM365AppEnabled)&&void 0!==st&&st,Wn=null!==(ct=null===(at=St.appBarDefaultPinSet)||void 0===at?void 0:at.value)&&void 0!==ct?ct:"",qn=null!==(lt=null===(ut=St.wacStartPageConfig)||void 0===ut?void 0:ut.commercialStartPageApps)&&void 0!==lt?lt:"",Hn=null!==(ht=null===(dt=St.wacStartPageConfig)||void 0===dt?void 0:dt.consumerStartPageApps)&&void 0!==ht?ht:"",zn=null!==(pt=null===(ft=St.wacHost)||void 0===ft?void 0:ft.wacHostApps)&&void 0!==pt?pt:"",Gn=null!==(gt=null===(mt=St.wacHost)||void 0===mt?void 0:mt.wacHostAppsConsumer)&&void 0!==gt?gt:"",Vn=En||"1"===Bt.acctsw,$n=Qt&&"1"===Bt.darkmodeoverride,Qn=function(e){return null!=e&&"allotments"==e.toLowerCase()?e:""}(Bt.scenarioid),Jn=function(e){var t,n,r,o,i,s,a=e.isCommercialUser,c=e.featureGates,u=(a?e.commercialStartPageApps:e.consumerStartPageApps).split(",");if(a){var l=null!==(n=null===(t=c.wacStartPageConfigGates)||void 0===t?void 0:t.wacStartPageConfigVisioStartPageEnabled)&&void 0!==n&&n,h=null!==(o=null===(r=c.modernWhiteboardStartGates)||void 0===r?void 0:r.modernWhiteboardStartEnabled)&&void 0!==o&&o,f=null!==(s=null===(i=c.modernClipChampStartGates)||void 0===i?void 0:i.modernClipChampStartEnabled)&&void 0!==s&&s;l&&!u.includes(d.a.Visio.toLowerCase())&&u.push(d.a.Visio.toLowerCase()),h&&!u.includes(d.a.Whiteboard.toLowerCase())&&u.push(d.a.Whiteboard.toLowerCase()),f&&!u.includes(d.a.Clipchamp.toLowerCase())&&u.push(d.a.Clipchamp.toLowerCase())}return u}({isCommercialUser:Nt,featureGates:Tt,commercialStartPageApps:qn,consumerStartPageApps:Hn}),Xn=function(e){var t=e.isConsumerUser,n=e.visioWacHostEnabled,r=e.wacHostApps,o=e.wacHostAppsConsumer;if(e.isCommercialUser){var i=""===r?[]:r.split(",");return n&&i.push("visio"),i}return t?""===o?[]:o.split(","):[]}({isCommercialUser:Nt,isConsumerUser:It,visioWacHostEnabled:Rn,wacHostApps:zn,wacHostAppsConsumer:Gn}),Kn=a(Jn),Yn=Wt&&!Rt,Zn=Nt&&Gt||It&&!Pt&&Gt,er=on&&!Ft,tr=cn&&Nt&&(!At||an),nr=mn&&!Ft,rr=wn&&!Ft,or=It||Dt,ir=Lt&&(Nt||!0),sr=Mt&&(!Nt||!Rt||tn);return(Nn=Nn&&ln&&(An?_t||jt:_t))&&xt&&(Nn=!!(null===(vt=null===Windows||void 0===Windows?void 0:Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager)||void 0===vt?void 0:vt.findAllAccountsAsync)&&null!==(Ot=null===(Ct=null===(wt=null===(yt=null===(bt=Windows.Foundation)||void 0===bt?void 0:bt.Metadata)||void 0===yt?void 0:yt.ApiInformation)||void 0===wt?void 0:wt.isMethodPresent)||void 0===Ct?void 0:Ct.call(wt,"Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager","FindAllAccountsAsync"))&&void 0!==Ot&&Ot&&c({build:1091,major:18,minor:2205,revision:0})),{accountSwitchingEnabled:Vn,activityBasedTimeoutEnabled:Ut&&Nt,altaBrandingChangesEnabled:or,appBarDefaultPinSet:Wn,appBarDragDropEnabled:qt,appBarEnabled:Yn,appBarMicaStylesEnabled:Ht,appBarOverflowOnlyEnabled:zt,appBarPinningEnabled:Zn,bottomTrayEnabled:Rt&&Nt,contentActionsEnabled:Jt,createDocAspxExcelEnabled:Xt&&Et,createDocAspxPowerPointEnabled:Kt&&Et,createDocAspxVisioEnabled:Yt&&Et,createDocAspxWordEnabled:Zt&&Et,createOneDriveDocApiEnabled:ir,createStreamPlaylistEnabled:en,createVisioEnabled:Nt,darkModeEnabled:$t,darkModeOverride:$n,defaultHeaderLayoutEnabled:tn,feedEnabled:rn,fluentHeader:er||Yn,fluidCreateAbpEnabled:!1,fluidCreateNewEnabled:sn&&tr,fluidSupportEnabled:tr,isConsumerUser:It,isPwaInUwp:xt,lorByDefaultEnabled:un,m365AppsAboutEnabled:dn,m365AppsEnabled:ln,m365TestAppEnabled:hn&&ln,memoryProfilingEnabled:fn,myContentEnabled:nr,myContentGridViewEnabled:gn&&nr,nativeSearchInHeaderEnabled:sr,outgoingLoginHintEnabled:pn&&Vn,parkEnabled:vn&&nn&&ln,peopleListViewEnabled:bn&&nr,pinningPeopleEnabled:yn&&nr,pwaEnabled:Pt,quickAccessV1CustomPivotEnabled:rr&&Cn,quickAccessV1Enabled:rr,quickAccessV1GridViewEnabled:rr&&On,remoteModulesEnabled:Tn,scenarioId:Qn,sharedServicesEnabled:Sn,shellDocumentTitleEnabledInFluid:_n||tn,shellPinEnabled:jn,showBusinessApps:Vt&&Nt,sideloadAppButtonEnabled:kn&&ln,spfxAppEnabled:In,startPageApps:Kn,startPageAppsArray:Jn,storeAppEnabled:Nn,swayCreateNewEnabled:Kn.has(d.a.Sway),toDoM365AppEnabled:Pn&&ln,unityEnabled:xn,universalMeControlPWAEnabled:Ln&&Dn,userPreferenceEnabled:Mn,wacHostApps:a(Xn),wacHostAppsArray:Xn,wacHostEnabled:Fn&&!Rt&&Xn.length>0,wacHostOrgTemplatesEnabled:!1,webVitalsEnabled:Bn,yammerM365AppEnabled:Un&&ln}},getServerGeneratedConfig:function(e){return function(e){var t,n,s,u,l,d;return Object(r.__awaiter)(this,void 0,void 0,(function(){var h,f;return Object(r.__generator)(this,(function(p){switch(p.label){case 0:return[4,Object(o.a)("capabilities",e)];case 1:if(!(h=p.sent()))throw new Error("Cannot parse CapabilitiesConfig");return h.storeAppEnabled&&h.pwaEnabled&&Object(i.a)()&&(f=null===(t=null===Windows||void 0===Windows?void 0:Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager)||void 0===t?void 0:t.findAllAccountsAsync,h.storeAppEnabled=!!f&&null!==(d=null===(l=null===(u=null===(s=null===(n=Windows.Foundation)||void 0===n?void 0:n.Metadata)||void 0===s?void 0:s.ApiInformation)||void 0===u?void 0:u.isMethodPresent)||void 0===l?void 0:l.call(u,"Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager","FindAllAccountsAsync"))&&void 0!==d&&d&&c({build:1091,major:18,minor:2205,revision:0})),[2,Object(r.__assign)({8}-[00000n){vaxportem="convertDriveItem",e.openShareToTeams="openShareToTeams",e.openTaskModule="openTaskModule",e.schedule="schedule",e.unregistered="unregistered"}(r||(r={}))},eQkK:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return d}));class r{send(e){}}var o,i=n("ywi1"),s=n("V678"),a=n("rUkc");!function(e){e.CodeArtifact="CodeArtifact",e.UserData="UserData"}(o||(o={}));class c{constructor(e,t){this.namespace=e,this.properties=t}static formatTick(e){return Math.floor(e)}static numberFromString(e){if(null==e)return;const t=Number(e);return Number.isNaN(t)?e:t}static sanitizePkgName(e){return e.replace("@","").replace("/","-")}static prepareErrorObject(e,t,n){const{message:r,errorType:o,stack:i}=Object(a.c)(t,!0);if(e.stack=i,e.error=r,e.errorType=o,Object(a.g)(t)){const n=t.getTelemetryProperties();for(const t of Object.keys(n))void 0===e[t]&&(e[t]=n[t])}void 0===e.stack&&n&&(e.stack=Object(a.d)())}sendTelemetryEvent(e,t){var n;this.sendTelemetryEventCore(Object.assign(Object.assign({},e),{category:null!==(n=e.category)&&void 0!==n?n:"generic"}),t)}sendTelemetryEventCore(e,t){const n=Object.assign({},e);void 0!==t&&c.prepareErrorObject(n,t,!1),"number"==typeof n.duration&&(n.duration=c.formatTick(n.duration)),this.send(n)}sendErrorEvent(e,t){this.sendTelemetryEventCore(Object.assign(Object.assign({error:e.eventName},e),{category:"error"}),t)}sendPerformanceEvent(e,t){var n;const r=Object.assign(Object.assign({},e),{category:null!==(n=e.category)&&void 0!==n?n:"performance"});this.sendTelemetryEventCore(r,t)}prepareEvent(e){const t="error"===e.category||void 0!==e.error,n=Object.assign({},e);if(void 0!==this.namespace&&(n.eventName=`${this.namespace}${c.eventNamespaceSeparator}${n.eventName}`),this.properties){const r=[];r.push(this.properties.all),t&&r.push(this.properties.error);for(const t of r)if(void 0!==t)for(const r of Object.keys(t)){if(void 0!==e[r])continue;const o=t[r],i="function"==typeof o?o():o;void 0!==i&&(n[r]=i)}}return n}}c.eventNamespaceSeparator=":";class u extends c{constructor(e,t,n){super(t,n),this.baseLogger=e,Object(s.b)(e)&&Object(s.d)(this,new s.a(e.config))}static create(e,t,n){if(e instanceof u){const r={};for(const t of[e.properties,n])void 0!==t&&(void 0!==t.all&&(r.all=Object.assign(Object.assign({},r.all),t.all)),void 0!==t.error&&(r.error=Object.assign(Object.assign({},r.error),t.error)));return new u(e.baseLogger,void 0===e.namespace?t:void 0===t?e.namespace:`${e.namespace}${c.eventNamespaceS}send(e){this.baseLogger.send(this.prepareEvent(e))}}class l extends c{constructor(e,t){super(e,t),this.loggers=[]}addLogger(e){null!=e&&this.loggers.push(e)}send(e){const t=this.prepareEvent(e);this.loggers.forEach((e=>{e.send(t)}))}}class d{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{end:!0,cancel:"generic"};this.logger=e,this.markers=n,this.startTime=i.a.now(),this.event=Object.assign({},t),this.markers.start&&this.reportEvent("start"),"object"==typeof window&&null!=window&&window.performance&&(this.startMark=`${t.eventName}-start`,window.performance.mark(this.startMark))}static start(e,t,n){return new d(e,t,n)}static timedExec(e,t,n,r){const o=d.start(e,t,r);try{const e=n(o);return o.autoEnd(),e}catch(e){throw o.cancel(void 0,e),e}}static async timedExecAsync(e,t,n,r){const o=d.start(e,t,r);try{const e=await n(o);return o.autoEnd(),e}catch(e){throw o.cancel(void 0,e),e}}get duration(){return i.a.now()-this.startTime}reportProgress(e){this.reportEvent(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"update",e)}autoEnd(){this.event&&this.markers.end&&this.reportEvent("end"),this.performanceEndMark(),this.event=void 0}end(e){this.reportEvent("end",e),this.performanceEndMark(),this.event=void 0}performanceEndMark(){if(this.startMark&&this.event){const e=`${this.event.eventName}-end`;window.performance.mark(e),window.performance.measure(`${this.event.eventName}`,this.startMark,e),this.startMark=void 0}}cancel(e,t){void 0!==this.markers.cancel&&this.reportEvent("cancel",Object.assign({category:this.markers.cancel},e),t),this.event=void 0}reportEvent(e,t,n){if(!this.event)return;const r=Object.assign(Object.assign({},this.event),t);r.eventName=`${r.eventName}_${e}`,"start"!==e&&(r.duration=this.duration),this.logger.sendPerformanceEvent(r,n)}}},ef5c:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return c}));var r=n("Wx5u"),o=(n("zuGz"),n("YY01"));function i(e,t){e.send({...t,category:r.b.Generic})}function s(e,t,n){n&&u(t,n),e.send({...t,category:r.b.Error})}function a(e,t,n){n&&u(t,n),t.resultType||void 0===t.succeeded||(t.resultType=t.succeeded?r.a.Success:r.a.Failure),e.send({...t,category:r.b.Activity})}function c(e,t){e.send({...t,category:r.b.UserAction})}function u(e,t){!function(e,t){var n;const r="object"==typeof e&&null!==e;function o(t){if(!r)return;const n=e[t];return"string"==typeof n?n:void 0}t.errorMessage=null!==(n=o("message"))&&void 0!==n?n:String(e),t.errorName=o("name"),t.stack=o("stack"),t.errorType=o("errorType"),t.errorInstanceId=o("errorInstanceId")}(t,e),e.message=e.message?`${e.message}\n${e.errorMessage}`:e.errorMessage,void 0===e.stack&&(e.stack=function(){let e=(new Error).stack;if(!e)try{throw new Error}catch(t){e=t.stack}return e}()),e.message&&(e.message=Object(o.b)(e.message.toString())),e.stack&&(e.stack=Object(o.b)(e.stack.toString()),e.stack=Object(o.a)(e.stack.toString())),e.error&&(e.erroalStoreWithSelector;function s(e,t,n){void 0===t&&(t=e.getState);e.getServerState||e.getState,t,n);return o.useDebugValue(r),r}var a=function(e){var t="function"==typeof e?r.createStore(e):e,n=function(e,n){r},t.useStore=s,Object.keys(r).forEach((function(e){"default"===et:function(){return r[e]}})})),e.exports=t&&t.default||{},Object.assign(e.exports,t)},"f/Xo":function(e,t){e.exports=function(e){return function(){return e}}},f1XI:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return r})),n.d(t,"f",(function(){return a})),n.d(t,"g",(function(){return l})),n.d(t,"h",(function(){return i})),n.d(t,"i",(function(){return w})),n.d(t,"j",(function(){return k})),n.d(t,"k",(function(){return J})),n.d(t,"l",(function(){return x})),n.d(t,"m",(function(){return m})),n.d(t,"n",(function(){return y})),n.d(t,"o",(function(){return v})),n.d(t,"p",(function(){return ne})),n.d(t,"q",(function(){return b})),n.d(t,"r",(function(){return re})),n.d(t,"s",(function(){return ee})),n.d(t,"t",(function(){return te})),n.d(t,"u",(function(){return O})),n.d(t,"v",(function(){rfunction m(e,t){return 45^w(e,0)?(((t}function b(e,t,n){return ereturn e.slice(t,n)}functi},t)}function D()ase 93:return 1}return 0}function U(e){return E=_=1,j=O(A=e),I=0,[]}function W(e){return A="",e}function q(e){return g(F(I-1,V(91===e?e+=0,w=0,O=0;y<r;++y)for(var S=0,k=C(e,p+1,p=h(w=s[y])),E=e;S<v;++S)(E=ge,2,-2),0,r)}function Z(e,t,n,r,o){return P(e,t,n,c,C(e,0,r),C(e,r+1,-1),r,o)}function ee(e,t){for(var n="",r=0;r<e.length;r++)n+=t(e[r],r,e,t)||"";return n}function te(e,t,n,r){switch(e.type){case d:if(e.children.length)break;case"@import":case c:return e.return=e.return||e.value;case s:return"";case"@keyframese){var t=T(e);return function(n,r,o,i){for(var s="",a=0;a<t;a++)s+=e[a](n,r,o,i)||"";return s}}function re(e){return function(t){t.root||(t=t.return)&&e(t)}}},f6UF:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("mXGw");function o(e,t,n){var o=[];return e.forEach((function(e){if("string"==typeof e){var i=new RegExp("\\{"+n+"\\}","gi");if("string"==typeof t||"number"==typeof t)o.push(e.replace(i,""+t));else{var s=e.split(i);s.forEach((function(e,n){e&&function(e){var t=[],n=!1,o=!1;return e.match(/^\s+/gi)&&(e=e.replace(/^\s+/gi,""),n=!0),e.match(/\s+$/gi)&&(e=e.replace(/\s+$/gi,""),o=!0),n&&t.push(r.createElement(r.Fragment,null,"")),t.push(e),o&&t.push(r.createElement(r.Fragment,null,"")),t}(e).forEach((function(e){return o.push(e)})),n+1<s.length&&o.push(tt.WhiteSpaceChar="&nbsp;",t.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=argu)})),0===i.length?"":1===i.length&&"string"==typeof i[0]?i[0]:r.createElement(r.Fragment,null,i.map((function(e,t){return r.createElement(r.Fragment,{key:t},e)})))}},fFwu:function(e,t,n){"use strict";n.r(t),n.d(t,"initializeFluentTheme",(function(){return a})),n.d(t,"getOfficeStartThemeObservable",(function(){return c}));var r,o=n("+fvi"),i=n("dpyN"),s=!1;function a(e){s||(s=!0,(r=e.withScope(0).pipe(Object(i.a)((function(e,t){return e.mode===t.mode&&e.overridePaletteMapping===t.overridePaletteMapping&&e.overrideTokenMapping===t.overrideTokenMapping&&e.themeId===t.themeId&&u(e.lightBrandColors,t.lightBrandColors)&&u(e.darkBrandColors,t.darkBrandColors)})))).subscribe((function(e){Object(o.d)(e,!1,!1)})))}function c(){return r}function u(e,t){return e===t||!(!e||!t)&&e.themeDark===t.themeDark&&e.themeDarkAlt===t.themeDarkAlt&&e.themeDarker===t.themeDarker&&e.themeLight===t.themeLight&&e.themeLighter===t.themeLighter&&e.themeLighterAlt===t.themeLighterAlt&&e.themePrimary===t.themePrimary&&e.themeSecondary===t.themeSecondary&&e.themeTertiary===t.themeTertiary}},fNDz:function(e,t,n){"use strict";n.d(t,"a",(function(){return ch(n.leor=0]="error",e[e.warn=1]="warn",e[e.info=3]="info",e[e.metric=4]="metric",e[e.verbose=5]="verbose",e[e.debug=6]="debug",e[e.disabled=7]="disabled"}(r||(r={}))},"faO/":function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.BuyButton="buybutton",e.InstallGoPremiumButton="installbutton",e.ShellGoPremiumButton="gopremium",e.PaidConsumerBenefitsButton="paidconsumer-unity",e.PremiumTemplates="templates",e.Fre="fre",e.WelcomeBadge="welcomebadge",e.Resubscribe="renew"}(r||(r={}))},"faS/":function(e,t,n){"use strict";n.d(t,"a",(function(){return B}));var r=n("NrNW"),o=n("CU8J"),i=n("ynVX"),s=n("B5kz"),a=n("CaQ9"),c=n("QjXU"),u=n("j7b/"),l=n("6y6H"),d=n("P1B7"),h=n("wRjz"),f=n("lwUs"),p=n("m32Q"),m=n("lkvL"),g=n("Ot9e"),v=n("8wW2"),b=n("a3FV"),y=n("Wa5Y"),w=n("fNDz"),C="graph-unified-storage-api",O=n("gd1C"),T=n("h8qh"),S=n("wVmX"),k=n("laSs"),E=n("lUkk"),_=n("5eS3"),j=n("pKjf"),I=n("mXGw"),N=n("i1Ej"),A=/\.?0+$/;function P(e,t,n){if(void 0===n&&(n={}),"number"!=typeof t||isNaN(t)||n.ignoreZero&&0===t||t<0)return"";var r=n.trimDecimal||!1;return 1===t?e.get("fileSizeBytesSingular")||"":t<1024?x(e.get("fileSizeBytesPlural")||"",t,r):t<1024e3?x(e.get("fileSizeKB")||"",t/1024,r):t<1048576e3?x(e.get("fileSizeMB")||"",t/1048576,r):t<0xfa00000000?x(e.get("fileSizeGB")||"",t/1073741824,r):x(e.get("fileSizeTB")||"",t/1099511627776,r)}function x(e,t,n){return e.replace("{0}",function(e,t){if(e>=100||e===Math.floor(e))return e.toFixed(0);var n=e.toFixed(1);return t?n.replace(A,""):n}(t,n))}var D=n("bcUD"),L=n("faO/"),M=n("u9fO"),R=n("/Oio"),F=function(e){var t=e.disableSubscriptionCheck,n=void 0!==t&&t,o=function(e,t){var n=function(e){var t=Object(r.a)().data,n={web:"cmmrvb0fezi",desktop:"cmm97cde5ll"}g0",n.desktop="cmmapwu43rs"}return(null==t?void 0:t.workload)===R.a.Hwa?n.desktop:n.web}(t);return Object(I.useMemo)((function(,n])}(e.baseUrl,e.area),i=Object(Deck:n,experiences:[L.a.WelcomeBadge]}),s=Object(I.useCallback)((function(){i&&i(L.a.WelcomeBadge,o)}),[i,o]);return Object(I.useMemo)((function(){if(i)return s}),[i,s])};function B(e){var t,n,A=e.area,x=e.showEnforcement,D=e.logFullQuota,L=void 0!==D&&D,M=Object(a.a)().data,R=Object(r.a)().data,B=Object(T.a)().data,U=Object(o.a)().data,W=null==B?void 0:B.welcomeBadgeResources,q=null==B?void 0:B.edgeworthResources,H=Object(I.useMemo)((function(){var e,t;return(null===(t=null===(e=null==U?void 0:U.result)||void 0===e?void 0:e.useUSQGates)||void 0===t?void 0:t.useUSQEnabled)||!1}),[U]),z=Object(I.useMemo)((function(){var e,t;return(null===(t=null===(e=null==U?void 0:U.result)||void 0===e?void 0:e.welcomeBadgeV2Gates)||void 0===t?void 0:t.welcomeBadgeV2Enabled)||!1}),[U]),G=F({baseUrl:N.c,area:A}),V=F({area:A,baseUrl:N.c,disableSubscriptionCheck:!0}),$=Object(I.useMemo)((function(){var e,t;return(null===(t=null===(e=null==U?void 0:U.result)||void 0===e?void 0:e.wbShowStoragePercentageGates)||void 0===t?void 0:t.wbShowStoragePercentageEnabled)||!1}),[U]),Q=Object(I.useMemo)((function(){var e,t;return(null===(t=null===(e=null==U?void 0:U.result)||void 0===e?void 0:e.myContentUsqGates)||void 0===t?void 0:t.myContentUsqEnabled)||!1}),[U]),J=null===(n=null===(t=function(e){var t=Object(r.a)().data,n=Object(a.a)().data,o=Object(i.a)().data,O=[e?"GraphUnifiedStorageQuota":"OneDriveGraphStorageQuota"];return Object(s.c)(O,(function(){return e&&t&&n&&o&&(null==n?void 0:n.isMsa)?function(e,t,n,r){return Object(c.__awaiter)(this,void 0,void 0,(function(){var o,i,s,a,O,T,S,k,E,_,j,I=this;return Object(c.__generator)(this,(function(N){switch(N.label){case 0:return o=e.officeHomeApiRoot,i=e.jwtAuthEnabled,s=e.correlationId,a=e.getAccessToken,O=e.inMockMode,[4,Object(l.a)()];case 1:return T=N.sent(),S=[],k=Object(g.a)(location.search),E="1"===k.mockauth,(null==T?void 0:T.key)&&S.push(Object(h.a)(T.key)),S.push(Object(f.a)(O||E?-1:4*u.b)),j="".concat((_={officeApiRoot:o,jwtAuthEnabled:i,correlationId:s,getAccessToken:a,graphApiRoot:n.graphApiRoot,userId:O?t.puid:t.userPrincipalName,inMockMode:O}).userId),[2,Object(d.a)((function(){return function(e){var t=e.correlationId,n=e.jwtAuthEnabled,r=e.getAccessToken,o=e.graphApiRoot,i=e.officeApiRoot,s=e.inMockMode;return Object(c.__awaiter)(this,void 0,void 0,(function(){var e,a,u,l,d;return Object(c.__generator)(this,(function(c){return e={method:"GET"},a=Object(g.a)(location.search),u="1"===a.mockauth,l=s?"".concat(i,"/api"):o,d=Object(w.a)(l,"users/me/settings/storage/quota",!0),u?[2,Promise.resolve({total:+a.total,used:+a.used})]:[2,Object(y.a)(b.a.UnifiedStorageRequest,"Unified_Storage_Request",d,e,n,r,i,t,"Graph").then((function(e){if(!e||!e.ok||void 0===e.data)throw new Error((null==e?void 0:e.statusText)||"Graph API error");return e.data})).catch((function(e){Object(v.a)().handleError(e,"WBFtm")}))]}))}))}(_)}),(function(){var e=Object(c.__spreadArray)([],Object(c.__read)(S),!1).reverse();return Object(p.a)({userId:t.puid,collectionName:C,collectionVersion:1,key:j,plugins:e})}),(function(e){return Object(c.__awaiter)(I,void 0,void 0,(function(){return Object(c.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(m.a)({userId:t.puid,collectionName:C,collectionVersion:1,key:j,data:e,plugins:S,writeBehavior:"sync"})];case 1:return n.sent(),[2]}}))}))}),r)]}}))}))}(t,n,o,(function(e){return s.a.setQueryData(O,e)})):void 0}),{staleTime:1/0,cacheTime:1/0,enabled:t&&n&&o})}(H))||void 0===t?void 0:t.data)||void 0===n?void 0:n.result,X=Object(I.useMemo)((function(){return(null==J?void 0:J.used)||0}),[null==J?void 0:J.used]),K=Object(I.useMemo)((function(){return(null==J?void 0:J.total)||0}),[null==J?void 0:J.total]),Y=function(e,t){var n,r,o,i={state:e?e.toLowerCase():"empty",toolTip:null!==(n=null==t?void 0:t.manageStorage)&&void 0!==n?n:""};switch(e.toLowerCase()){case"empty":case"normal":return i;case"nearing":case"critical":return Object(c.__assign)(Object(c.__assign)({},i),{toolTip:null!==(r=null==t?void 0:t.criticalStateTooltip)&&void 0!==r?r:""});case"full":case"over":case"ove({},i),{toolTip:null!==(o=null==t?void 0:t.fullStateTooltip)&&void 0!==o?o:""})}return i}(Object(I.useMemo)((function(){return(null==J?void 0:J.state)||"empty"}),[null==J?void 0:J.state]),q),Z=Object(I.useMemo)((function(){return J&&J.used<=0}),[J]),ee=Object(S.a)(),te=Object(I.useMemo)((function(){return!!G&&!ee&&X>=K*N.d&&!(null==M?void 0:M.isPipl)}),[null==M?void 0:M.isPipl,ee,G,K,X]),ne="MyContent"===A,re=Object(I.useMemo)((function(){return ne?Q:"WelcomeBadge"===A&&z&&!!W}),[A,ne,Q,W,z]),oe=Object(I.useMemo)((function(){return!!(R&&J&&K>0&&re)}),[re,R,J,K]),ie=Object(I.useMemo)((function(){var e=N.c;return R&&(e=R.loginHint?Object(_.a)(N.c,"".concat(N.b,"=").concat(R.loginHint)):N.c),e}),[R]),se=Object(I.useMemo)((function(){return new Map([["fileSizeBytesSingular",null==W?void 0:W.storageSingularByte],["fileSizeBytesPlural",null==W?void 0:W.storageBytes],["fileSizeKB",null==W?void 0:W.storageKB],["fileSizeMB",null==W?void 0:W.storageMB],["fileSizeGB",null==W?void 0:W.storageGB],["fileSizeTB",null==W?void 0:W.storageTB]])}),[null==W?void 0:W.storageBytes,null==W?void 0:W.storageGB,null==W?void 0:W.storageKB,null==W?void 0:W.storageMB,null==W?void 0:W.storageSingularByte,null==W?void 0:W.storageTB]),ae=Object(I.useMemo)((function(){return Z?null==W?void 0:W.firstTimeAvailableStorage:P(se,+X,{trimDecimal:!0})}),[Z,se,X,null==W?void 0:W.firstTimeAvailableStorage]),ce=Object(I.useMemo)((function(){return P(se,+K,{trimDecimal:!0})}),[se,K]),ue=Object(I.useMemo)((function(){return function(e,t){var n=e/t*100;return n>0&&n<1?Number(n.toFixed(2)):Math.floor(n)}(X,K)}),[K,X]);Object(I.useEffect)((function(){oe&&Object(k.a)({eventName:"WelcomeBadgeV2_Impression",area:A,subArea:"StorageQuota",distribution:te?"StorageQuotaDimeExperience":"StorageQuotaDefaultExperience"})}),[A,oe,te]);var le=Object(I.useCallback)((function(){Object(E.a)({id:"StorageQuota_Dime",area:A,subArea:"StorageQuota",result:"Navigate",target:"Other",eventName:"StorageQuota_Dime"})}),[A]),de=Object(I.useCallback)((function(){te&&!ne?(le(),G&&G()):(Object(E.a)({id:"StorageQuota_OneDrive",area:A,subArea:"StorageQuota",result:"Navigate",target:"Other",eventName:"StorageQuota_OneDrive"}),Object(O.a)(ie,{action:"OpenFileLocation",linkTarget:"_blank"}))}),[A,te,ne,le,ie,G]),he=Object(I.useMemo)((function(){return Z?j.a.None:X>K?j.a.Over:X===K?j.a.Full:!H&&X>K*N.d?j.a.Warning:H&&X>=K*N.d&&X<K*N.e?j.a.WarningUSQ:H&&X>=K*N.e?j.a.CriticalUSQ:j.a.Default}),[Z,K,H,X]),fe=he===j.a.Full||he===j.aOver_Impression",area:A})}),[A,fe,oe,L]);var pe=Object(I.useMemo)((function(){return Z?null==W?void 0:W.firstTimeStorageMessage:null==W?void 0:W.storageMessage}),[Z,null==W?void 0:W.firstTimeStorageMessage,null==W?void 0:W.storageMessage]),me=Object(I.useCallback)((function(e){return e===j.a.Over?null==W?void 0:W.paidUserStorageOverTooltip:e===j.a.Full?null==W?void 0:W.storageFullWarningTooltip:e===j.a.Warning?null==W?void 0:W.paidUserStorageWarningTooltip:null==W?void 0:W.defaultStorageTooltip}),[null==W?void 0:W.defaultStorageTooltip,null==W?void 0:W.paidUserStorageOverTooltip,null==W?void 0:W.paidUserStorageWarningTooltip,null==W?void 0:W.storageFullWarningTooltip]),ge=Object(I.useCallback)((function(e){return e===j.a.Over?null==W?void 0:W.usqUserStorageOverTooltip:e===j.a.Full?null==W?void 0:W.usqUserStorageFullTooltip:e===j.a.WarningUSQ?null==W?void 0:W.usqUserStorageWarningTooltip:e===j.a.CriticalUSQ?null==W?void 0:W.usqUserStorageCriticalTooltip:null==W?void 0:W.defaultStorageTooltip}),[null==W?void 0:W.defaultStorageTooltip,null==W?void 0:W.usqUserStorageCriticalTooltip,null==W?void 0:W.usqUserStorageFullTooltip,null==W?void 0:W.usqUserStorageOverTooltip,null==W?void 0:W.usqUserStorageWarningTooltip]),ve=Object(I.useCallback)((function(e){return te&&j.a.Over?null==W?void 0:W.freeUserStorageOverTooltipWithDime:te&&j.a.Full?null==W?void 0:W.storageFullWarningTooltipWithDime:e===j.a.Over?null==W?void 0:W.freeUserStorageOverTooltip:e===j.a.Full?null==W?void 0:W.storageFullWarningTooltip:e===j.a.Warning?null==W?void 0:W.freeUserStorageWarningTooltip:null==W?void 0:W.defaultStorageTooltip}),[te,null==W?void 0:W.defaultStorageTooltip,null==W?void 0:W.freeUserStorageOverTooltip,null==W?void 0:W.freeUserStorageOverTooltipWithDime,null==W?void 0:W.freeUserStorageWarningTooltip,null==W?void 0:W.storageFullWarningTooltip,null==W?void 0:W.storageFullWarningTooltipWithDime]),be=Object(I.useCallback)((function(e){return e===j.a.Over?null==W?void 0:W.usqUserStorageOverTooltip:e===j.a.Full?null==W?void 0:W.usqUserStorageFullTooltip:e===j.a.WarningUSQ?null==W?void 0:W.usqUserStorageWarningTooltip:e===j.a.CriticalUSQ?null==W?void 0:W.usqUserStorageCriticalTooltip:null==W?void 0:W.defaultStorageTooltip}),[null==W?void 0:W.defaultStorageTooltip,null==W?void 0:W.usqUserStorageCriticalTooltip,null==W?void 0:W.usqUserStorageFullTooltip,null==W?void 0:W.usqUserStorageOverTooltip,null==W?vfunction(){return ee?H?ge(he):me(he):H?be(he):ve(he)}),[ve,me,be,ge,ee,he,H]),we=Object(I.useMemo)((function(){return null==W?void 0:W.usqPreEnforcementTooltip}),[null==W?void 0:W.usqPreEnforcementTooltip]),Ce=x&&(he==j.a.Warning||he==j.a.WarningUSQ||he==j.a.CriticalUSQ||he==j.a.Full||he==j.a.Over);Object(I.useEffect)((function(){Ce&&we&&Object(k.a)({eventName:"USQ_Pre_Enforcement_Tooltip_Impression",area:"WelcomeBadge",subArea:"StorageQuota"})}),[we,Ce]);var Oe=Object(I.useMemo)((function(){rTe=Object(I.useCallback)((function(){return Oe&&$?Oe<1?" (0%)":" (".concat(Math.floor(Oe),"%)"):""}),[Oe,$]),Se=Object(I.useCallback)((function(){V&&(le(),V())}),[le,V]);return Object(I.useMemo)((function(){return oe?{enforcementToolTip:null!=we?we:"",storageAlertLevel:he,storageDisabled:N.f,storageLabel:null!=pe?pe:"",storageStateNameProps:Y,storageToolTip:null!=ye?ye:"",storageUsedOrAvailableLabel:null!=ae?ae:"",totalStorageQuotaLabel:null!=ce?ce:"",usedStorageBarWidth:ue,onStorageClick:de,storagePercentage:function(){return Te()},onGetMoreStorageClick:Se}:void 0}),[oe,we,he,pe,Y,ye,ae,ce,Te,ue,de,Se])}},fhoW:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("6ib3"),o=n("muUJ"),i=n("a3FV"),s=n("Jxb/"),a=n("lpeV"),c=n("jwpY"),u=n("zPk6"),l="me/drive/";function d(e,t,n,d,h,f){var p=e.jwtAuthEnabled,m=e.getAccessToken,g=e.officeHomeApiRoot,v=e.correlationId;if(d===r.a.OneNote){var b="https://graph.microsoft.com/v1.0/".concat("me/onenote/","notebooks"),y={displayName:t},w={headers:{"Content-Type":"application/json"}};return Object(c.a)(i.a.OneDriveGraphCreateFileRequest,"OneDrive_Graph_Create_File",b,JSON.stringify(y),w,null!=p&&p,m,g,v,"Graph",{populateRequestEvent:function(e,t){t.RequestId=Object(u.a)(e)||""}}).then((function(e){var t=e.data;if(t&&t.links&&t.links.oneNoteWebUrl&&t.links.oneNoteWebUrl.href)return t;throw Object(o.a)("Could not parse drive item from Graph response")}),(function(e){var t,n=((t={}).ResourceId=v,t.Error=e,t);Object(o.a)(i.a.WacDocumentVroomError,n)}))}return b=void 0,b=h&&h.length?"https://graph.microsoft.com/v1.0/".concat(l,"root/children?").concat("select="+h.join(","),",*"):"https://graph.microsoft.com/v1.0/".concat(l,"root/children?select=webDavUrl,").concat(n?"openwith,":"","*"),y={name:t,file:{},"@microsoft.graph.conflictBehavior":"rename"},w={headers:{"Content-Type":"application/json",Prefer:"allow-zerobyte"}},Object(c.a)(i.a.OneDriveGraphCreateFileRequest,"OneDrive_Graph_Create_File",b,JSON.stringify(y),w,null!=p&&p,m,g,v,"Graph",{populateRequestEvent:function(e,t){t.RequestId=Object(u.a)(e)||""}}).then((function(e){null==f||f.ULS.sendTraceTag(512553950,s.a.msoulscat_Wac_UnifiedUiHost,a.a.Info,"Create new fileType: ".concat(d,", httpStatus: ").concat(e.status,", httpResponse: ").concat(e));var t=e.data;if(t&&t.id&&t.webUrl)return t;throw Object(o.a)("Could not parse drive item from Graph response")}),(function(e){var t;null==f||f.ULS.sendTraceTag(512550538,s.a.msoulscat_Wac_UnifiedUiHost,a.a.Info,"Create new fileType: ".concat(d,", error: ").concat(e));var n=((t={}).ResourceId=v,t.Error=e,t);Object(o.a)(i.a.WacDocumentVroomError,n)}))}},frjS:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("QjXU"),o=n("UDoG"),i=n("gd1C");function s(e,t,n){var s,a;return Object(r.__awaiter)(this,void 0,void 0,(function(){var c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Object(i.a)(e,{action:"OpenFile",targetTab:null!=t?t:void 0,linkTarget:t?"_top":n})];case 1:if(!(c=r.sent()).result||"OpenNull"===c.result||"OpenUndefined"===c.result)throw new o.a("Open blocked by pop-up blocker for the newly created file.","OpenBlockedByPopupBlocker");if(!c.success)throw new o.a(null!==(s=c.message)&&void 0!==s?s:"Failed to launch newly created file.","OpenNewDocFailed");return[3,3];case 2:return u=r.sent(),[2,Promise.resolve({type:null!==(a=u.type)&&void 0!==a?a:"OpenNewDocFailed",documentWebUrl:e})];case 3:return[Recommended="RemoveFromRecommended",e.Sch=JSON.stringify(e)),s.push(o(t)+"="+o(e))})))})),i=s.join("&")}if(i){var a=e.indexOf("#");-1!==a&&(e=e.slice(0,a)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e}},fxeQ:function(e,t,n){var r=n("LSEb")(n("s3UK"),"WeakMap");e.exports=r},gCKw:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("QjXU"),o=n("MJsD"),i=n("B5kz"),s=n("W7wX"),a=n("XcEc");function c(){var e=this;return i.a.fetchQuery(["FeatureGates"],(function(){return Object(r.__awaiter)(e,void 0,void 0,(function(){var e,t,n;return Object(r.__generator)(this,(function(i){switch(i.label){case 0:return[4,Promise.all([Object(o.a)(),Object(s.a)()])];case 1:return e=r.__read.apply(void 0,[i.sent(),2]),t=e[0],n=e[1],[2,Object(a.a)(n,t)]}}))}))}),{staleTime:1/0,cacheTime:1/0})}},gCUk:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("mXGw"),o=n.n(r),i=function(){return o.a.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.a.createElement("path",{d:"M14.1437 3.34932C13.9101 2.54966 13.177 2 12.3439 2L11.7427 2C10.8467 2 10.0758 2.634 9.90296 3.51321L8.85352 8.85006L9.15094 7.89102C9.39431 7.1063 10.1202 6.57143 10.9418 6.57143L14.2351 6.57143L15.6352 7.74347L16.8818 6.57143H16.4905C15.6574 6.57143 14.9242 6.02177 14.6907 5.22211L14.1437 3.34932Z",fill:"url(#paint0_radial_56201_15523)"}),o.a.createElement("path",{d:"M6.0492 16.643C6.28017 17.4465 7.01519 18 7.85121 18H9.07497C10.0844 18 10.9126 17.2009 10.9488 16.1921L11.1295 11.1429L10.842 12.0954C10.6031 12.887 9.87385 13.4286 9.04701 13.4286L5.73383 13.4286L4.34959 12.5434L3.32812 13.4286H3.71324C4.54926 13.4286 5.28427 13.9821 5.51524 14.7855L6.0492 16.643Z",fill:"url(#paint1_radial_56201_15523)"}),o.a.createElement("path",{d:"M12.2503 2H5.68785C3.81286 2 2.68787 4.39748 1.93788 6.79497C1.04933 9.63537 -0.113354 13.4342 3.25037 13.4342H6.11145C6.9435 13.4342 7.67548 12.8878 7.91125 12.0899C8.40466 10.4199 9.26493 7.52162 9.94109 5.31373C10.2857 4.18837 10.5728 3.22188 11.0134 2.62001C11.2604 2.28258 11.6721 2 12.2503 2Z",fill:"url(#paint2_linear_56201_15523)"}),o.a.createElement("path",{d:"M12.2503 2H5.68785C3.81286 2 2.68787 4.39748 1.93788 6.79497C1.04933 9.63537 -0.113354 13.4342 3.25037 13.4342H6.11145C6.9435 13.4342 7.67548 12.8878 7.91125 12.0899C8.40466 10.4199 9.26493 7.52162 9.94109 5.31373C10.2857 4.18837 10.5728 3.22188 11.0134 2.62001C11.2604 2.28258 11.6721 2 12.2503 2Z",fill:"url(#paint3_linear_56201_15523)"}),o.a.createElement("path",{d:"M7.74902 18H14.3115C16.1865 18 17.3114 15.6033 18.0614 13.2067C18.95 10.3672 20.1127 6.5697 16.7489 6.5697H13.8877C13.0557 6.5697 12.3238 7.11596 12.088 7.91383C11.5946 9.58325 10.7343 12.4804 10.0582 14.6874C9.71358 15.8124 9.42651 16.7786 8.98593 17.3802C8.73893 17.7175 8.32725 18 7.74902 18Z",fill:"url(#paint4_radial_56201_15523)"}),o.a.createElement("path",{d:"M7.74902 18H14.3115C16.1865 18 17.3114 15.6033 18.0614 13.2067C18.95 10.3672 20.1127 6.5697 16.7489 6.5697H13.8877C13.0557 6.5697 12.3238 7.11596 12.088 7.91383C11.5946 9.58325 10.7343 12.4804 10.0582 14.6874C9.71358 15.8124 9.42651 16.7786 8.98593 17.3802C8.73893 17.7175 8.32725 18 7.74902 18Z",fill:"url(#paint5_linear_56201_15523)"}),o.a.createElement("defs",null,o.a.createElement("radialGradient",{id:"paint0_radial_56201_15523",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(15.7128 8.89484) rotate(-129.141) scale(7.20751 6.76953)"},o.a.createElement("stop",{offset:"0.0955758",stopColor:"#00AEFF"}),o.a.createElement("stop",{offset:"0.773185",stopColor:"#2253CE"}),o.a.createElement("stop",{offset:"1",stopColor:"#0736C4"})),o.a.createElement("radialGradient",{id:"paint1_radial_56201_15523",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(4.74347 13.4008) rotate(51.7328) scale(6.58647 6.39483)"},o.a.createElement("stop",{stopColor:"#FFB657"}),o.a.createElement("stop",{offset:"0.633728",stopColor:"#FF5F3D"}),o.a.createElement("stop",{offset:"0.923392",stopColor:"#C02B3C"})),o.a.createElement("linearGradient",{id:"paint2_linear_56201_15523",x1:"5.29507",y1:"3.38547",x2:"6.17192",y2:"13.8705",gradientUnits:"userSpaceOnUse"},o.a.createElement("stop",{offset:"0.156162",stopColor:"#0D91E1"}),o.a.createElement("stop",{offset:"0.487484",stopColor:"#52B471"}),o.a.createElement("stop",{offset:"0.652394",stopColor:"#98BD42"}),o.a.createElement("stop",{offset:"0.937361",stopColor:"#FFC800"})),o.a.createElement("linearGradient",{id:"paint3_linear_56201_15523",x1:"6.11337",y1:"2",x2:"6.59201",y2:"13.4355",gradientUnits:"userSpaceOnUse"},o.a.createElement("stop",{stopColor:"#3DCBFF"}),o.a.createElement("stop",{offset:"0.246674",stopColor:"#0588F7",stopOpacity:"0"})),o.a.createElement("radialGradient",{id:"paint4_radial_56201_15523",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(17.0861 5.45059) rotate(109.881) scale(15.2451 18.7446)"},o.a.createElement("stop",{offset:"0.0661714",stopColor:"#8C48FF"}),o.a.createElement("stop",{offset:"0.5",stopColor:"#F2598A"}),o.a.createElement("stop",{offset:"0.895833",stopColor:"#FFB152"})),o.a.createElement("linearGradient",{id:"paint5_linear_56201_15523",x1:"17.6045",y1:"5.87186",x2:"17.5982",y2:"8.98507",gradientUnits:"userSpaceOnUse"},o.a.createElement("stop",{offset:"0.0581535",stopColor:"#F8ADFA"}),o.a.createElement("stop",{offset:"0.708063",stopColor:"#A86EDD",stopOpacity:"0"}))))}},gDky:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("6ib3");function o(e){return!e.isLocalFile&&!e.isOnPremOrVanity&&(e.isOneDriveForBusinessFile||e.isSharePointFile||e.isEmailAttachment||e.fileType!==r.a.Sway&&e.fileType!==r.a.Forms&&e.fileType!==r.a.PowerBI&&e.fileType!==r.a.MeetingObject)}},gI4v:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r="me/drive/",o="me/onenote/notebooks"},gYHC:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("QjXU"),o=n("mgFK"),i=n("aADZ"),s={key:"InstallConfig",isGetClientGeneratedConfigEnabled:function(e){var t;return!!(null===(t=e.resolveConfigGates)||void 0===t?void 0:t.resolveConfigInstallEnabled)},getClientGeneratedConfig:function(e){var t,n,r,o,s,a,c,u,l,d,h,f,p,m,g=e.featureGates,v=e.featureSettings,b=e.componentContext.preferredCulture,y=v.install,w=null!==(n=null===(t=g.ecsInstallNoLicenseOptionsGates)||void 0===t?void 0:t.ecsInstallNoLicenseOptionsEnabled)&&void 0!==n&&n,C=null!==(o=null===(r=g.installGates)||void 0===r?void 0:r.installPwaInstallMoveEnabled)&&void 0!==o&&o,O=null!==(s=null==y?void 0:y.buyOffice365Url)&&void 0!==s?s:"",T=null!==(a=null==y?void 0:y.consumerDirectInstallUrl)&&void 0!==a?a:"",S=null!==(c=null==y?void 0:y.consumerInstallLink)&&void 0!==c?c:"",k=null!==(u=null==y?void 0:y.consumerSSUInstallLink)&&void 0!==u?u:"",E=null!==(l=null==y?void 0:y.dimeJSUrl)&&void 0!==l?l:"",_=Object(i.a)(null!==(d=null==y?void 0:y.dimeTimeoutMs)&&void 0!==d?d:"5000"),j=null!==(h=null==y?void 0:y.goPremiumUrl)&&void 0!==h?h:"",I=null!==(f=null==y?void 0:y.haveOfficeProductKeyUrl)&&void 0!==f?f:"",N=null!==(p=null==y?void 0:y.installApiRoot)&&void 0!==p?p:"",A=null!==(m=null==y?void 0:y.needHelpInstallingOfficeUrl)&&void 0!==m?m:"";return{buyOffice365Url:O,commercialMySoftwarePageUrl:function(e){var t,n=null===(t=e.resources)||void 0===t?void 0:t.adminPortalRootUrl;return n?"".concat(n,"/account#installs"):""}(v),consumerDirectInstallUrl:T,consumerInstallLink:S,consumerSSUInstallLink:k.replace("{0}",b),dimeJSUrl:E,dimeTimeoutMs:_,ecsInstallNoLicenseOptionsEnabled:w,goPremiumUrl:j,haveOfficeProductKeyUrl:I,installApiRoot:N,needHelpInstallingOfficeUrl:A,pwaInstallMoveEnabled:C}},getServerGeneratedConfig:function(e){return function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(o.a)("installConfig",e)];case 1:return[2,t.sent()]}}))}))}(e)}}},gaGA:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=async e=>new Promise((t=>setTimeout((()=>t()),e)))},gd1C:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r,o=n("QjXU"),i=n("MJsD"),s=n("yQST"),a=n("gCKw"),c=n("mJgL"),u=n("/Oio"),l=n("dSKW"),d=n("NkqM"),h=n("KSsg"),f=function(e){var t,n=e.left,r=e.top,o=e.width,i=e.height;return n&&r&&(t="left=".concat(n,",top=").concat(r)),o&&i&&(t=(t?"".concat(t,","):"")+"width=".concat(o,",height=").concat(i)),t},p=function(e,t,n,r){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var s,a,c,u,p,m,g,v;return Object(o.__generator)(this,(function(b){switch(b.label){case 0:return s=!1,c="defaultLaunchUrl",e?function(e){return void 0!==e.route}(e)?[4,Object(i.a)()]:[3,3]:[2,{message:c,result:a,success:s}];case 1:return u=b.sent().router,n&&(n.pageName=Object(l.a)(u.getCurrentPageForLogging())),[4,u.navigateTo(e,!1,r)];case 2:return s=b.sent(),a="Inline",c+=".navigateTo:".concat(s),[3,4];case 3:p=Object(o.__read)(function(e,t){if(void 0===t&&(t="_blank"),!e)return[void 0,t,window];var n=e.linkTarget,r=e.targetTab;return[f(e),null!=n?n:t,null!=r?r:window]}(t),3),m=p[0],g=p[1],v=p[2].open(Object(d.a)(e),g,m),c+=".open:".concat(s=!!v),a=function(e,t){return null===e?"OpenNull":void 0===e?"OpenUndefined":"_blank"===t?"NewTab":"Inline"}(v,g),b.label=4;case 4:return null!==s&&Object(h.a)({launchInstrumentationParams:n,success:s,platform:"Web"}),[2,{message:c,result:a,success:s}]}}))}))},m={chat:"d870f6cd-4aa5-4d42-9626-ab690c041429",testapp:"07b75f22-72b5-4063-b7fc-0ed5ea8ff3ff",onedrive:"377c982d-9686-450e-9a7c-22aeaf1bc162"},g=function(e,t,n){if(e&&t&&t.length){var r="";if(-1===e.indexOf("/"))r=e;else{var o=e.replace("/pwa","").replace("/embed","").replace("/v2",""),i=o.indexOf("/m365apps")>-1?o.split("/m365apps")[1].split("/"):o.split("/");i.length>=2&&i[1]&&(r=i[1])}if(r){if(t.includes(r))return n?r:m[r];var s=Object.keys(m).find((function(e){return m[e]===r}));if(s&&t.includes(s))return n?s:r}}},v=function(e,t,l,d){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var h,f;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return r?[3,4]:[4,Object(i.a)()];case 1:return o.sent().workload===u.a.Hwa||Object(s.a)()?[4,Promise.all([n.e(3),n.e(476)]).then(n.bind(null,"rYv4")).then((function(e){return e.hwaLaunchUrl}))]:[3,3];case 2:return r=o.sent(),[3,4];case 3:r=p,o.label=4;case 4:return"string"!=typeof e?[3,7]:[4,Object(a.a)()];case 5:return h=o.sent(),[4,Object(c.a)()];case 6:f=o.sent(),e=function(e,t,n){var r,o,i;if((null===(r=null==t?void 0:t.mosAppHostedAtRootGates)||void 0===r?void 0:r.mosAppHostedAtRootEnabled)&&e.indexOf("/m365apps")>-1){var s=null===(i=null===(o=null==n?void 0:n.routing)||void 0===o?void 0:o.mosAppsHostedAtRoot)||void 0===i?void 0:i.split(","),a=g(e,s,!0);if(a){var c=g(e,s,!1);e=e.replace("/m365apps","").replace("/".concat(c),"/".concat(a))}}return e}(e,null==h?void 0:h.result,null==f?void 0:f.result),o.label=7;case 7:return[2,r(e,t,l,d)]}}))}))}},graM:function(e,t,n){"uson(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c}));var r=n("OSNm"),o=n("aFvx");function i(e){return t=>t&&e.includes(t.status)}function s(e,t){return e===(null==t?void 0:t.reason)||"object"==typeof e&&null!==e&&("AbortError"===e.name||20===e.code)}function a(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=n;return null!=n&&n.respectRetryAfterHeader&&(i={...n},i.backoffFn=(e,t)=>{if(429===t.status||503===t.status){const e=t.headers.get("Retry-After");if(e){const t=parseInt(e,10);if(!isNaN(t))return 1e3*t}}return n.backoffFn(e,t)}),Object(o.a)((()=>{const n=performance.now();return fetch(e,t).then((e=>{const t=e;return t.durationMs=Math.round(performance.now()-n),t})).catch((e=>{if(s(e,null==t?void 0:t.signal))throw e;let r="Error does not provide a message";return e.name&&e.message?r=`Error type: ${e.name}, ${e.message}`:e.name?r=`Error type: ${e.name}`:e.message&&(r=`Error message: ${e.message}`),{status:window.navigator.onLine?710:709,ok:!1,durationMs:Math.round(performance.now()-n),statusText:r}}))}),i,{timeoutMs:r,onTimeout:()=>({status:707,ok:!1,durationMs:r})})}function c(e,t,n,r,o,i){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,c=arguments.length>7?arguments[7]:void 0;return a(e,t,i,s).then((e=>r&&n?((!o&&e.result.ok||!e.result.ok)&&u(n,!0,e.result,e.tries.length+1,r,c),e.tries.forEach(((e,t)=>{u(n,!1,e,t+1,r,c)})),e):e))}async function u(e,t,n,o,i,s){var a;const c=s&&await s(n,t);Object(r.b)(i,{subCategory:"Request",eventNae),t}eaders,e.transformResponse))),Promise.reject(t)}))}},gwRl:function(e,t){e.exports=function(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}},gy05:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("QjXU"),o=n("mgFK"),i={key:"Workloads",getServerGeneratedConfig:function(e){return function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switannot);e.exports=function(e){return i(e)?r(e):o(e)}},h1Um:function(e,t,n){"use strict";var r=n("Rzld"),o=n("hUM7");e.exports=function(e,t){return e&&!r(t)?o(e,t):t}},h8qh:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("NrNW"),o=n("B5kz"),i=n("CU8J"),s=n("2y7E");function a(e){var t,n;void 0===e&&(e="office-start-resources");var a=Object(r.a)().data,c=Object(i.a)().data,u=["LocStrings",e,(null===(n=null===(t=null==c?void 0:c.result)||void 0===t?void 0:t.m365StringLogoGates)||void 0===n?void 0:n.m365StringLogoEnabled)||!1];return Object(o.c)(u,(function(){return Object(s.b)(a.cdnDomain,a.preferredCulture,a.stringsContainerName,e,c)}),{sta{"use strict";var r,o="object"==typeof Reflect?Reflect:null,i=o&&"functioo&&"function"==typeof o.ownKeys?o.ownKeys:Object.getOwnPropertySymbolsObject.getOwnPropertySymboemoveListener("error",o),n([].slice.call(arguments))}v(e,t,i,{once:!0}),"error"!==t&&function(e,t,n){"function"==itter" argument must be of type EventEmitter. Received type '+typeof e);e.addEven"number"!vents&&this._events!==Objectypeof e||e<0||s(e))throw newn" is out of rang;throw a.context=s,a}var c=o[e];if(void 0===c)return!1;if("function"==typeof c)i(c,this,t);else{var u=c.],this,t)}return!0},a.prototype.on=a.prototype.addListener=function(e,t){return d(this,e,t,!1)},a.protot.once=function(e,t){return u(t),this.on(e,fnction(e,t){for(;t+1<e.length;t_eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else =0;r--)this.remoa.prototype.rawListeners=function(e){return p(this,eof e.listenerCount?e.listenerCount(t):m.call(e,t)},a.prototype.listenerCount=m,a.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},hKA3:function(e,t,n){"use strict";n.d(t,"a",(fun r}));class r{constructor(){this.providers=new Map;for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.parents=t.filter((e=>void 0!==e))}get IFluidDependencySynthesizer(){ror(`Attempting to register a provider of type ${e} that already exists`);this.providers.set(e,t)}unregister(e){this.providers.has(e)&&this.provide(e)}synthesize(e,t){const n={};return this.generateRequired(n,t),this.generateOptional(n,e),Object.defineProperty(n,"IFluidDependencySynthesizer",{get:()=>this}),n}has(e,t){return!!this.providers.has(e)||!0!==t&&this.parents.some((t=>t.has(e)))}getProvider(e){if(this.has(e)){if(this.providers.has(e))return this.providers.get(e);for(const t of this.parents){if(t instanceof r)return t.getProvider(e);{const n=t;if(void 0!==(null==n?void 0:n.getProvider))return n.getProvider(e)}}}}generateRequired(e,t){if(void 0!==t)for(const n of Object.keys(t)){const t=this.resolveProvider(n);if(void 0===t)throw new Error(`Object attempted to be created without registered required provider ${n}`);Object.defineProperty(e,n,t)}}generateOptional(e,t){var n;if(void 0!==t)for(const r of Object.keys(t)){const t=null!==(n=this.resolveProvider(r))&&void 0!==n?n:{get:async()=>{}};Object.defineProperty(e,r,t)}}resolveProvider(e){const t=this.providers.get(e)unction"==typeof t?{get(){if(t&&"function"==typeof t)return Promise.resolve(this.IFluidDependencySynthesizer).then((async e=>t(e))).then((t=>null==t?void 0:t[e]))}}:{get(){if(t)return Promise.resolve(t).then((t=>{if(t)return t[e]}))}};for(const t of this.parents){const n=t.synthesize({[e]:e},{}),r=Object.getOwnPropertyDescriptor(n,e);if(void 0!==r)return r}}}},hPT0:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.outOfStorageError="outOfStorageError",e.invalidFileNameError="invalidFileNameError",e.snapshotTooBig="snapshotTooBig",e.fetchTimeout="fetchTimeouviceReadOnly="serviceReadOnly"}(r||(r={}))},hUM7:function(e,t,n){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},he5V:function(e,t,n){"use strict";function r(e,t){if(!e)throw new Error("number"==typeof t?`0x${t.toString(16).padStart(3,"0")}`:t)}n.d(t,"a",(function(){return r}))},hs6A:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return r}));const r=(()=>void 0!==e&&e.hrtime?()=>{const t=e.hrtime();return 1e3*t[0]+t[1]/1e6}:"undefined"!=typeof performance&&performance.now?()=>performance.now():()=>Date.now())()}).call(this,n("5IsQ"))},hu41:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n("NZpx"),o=n("NrNW"),i=n("6ib3"),s=n("CU8J"),a=n("CaQ9"),c=n("h8qh"),u=n("mXGw"),l=n("B5kz"),d=n("QjXU"),h=n("mgFK");function f(){var e,t,n,f,p=Object(c.a)().data,m=Object(r.a)().data,g=Object(a.a)().data,v=Object(s.a)().data,b=null==v?void 0:v.result,y=Object(o.a)().data,w=(null==g?void 0:g.isOrgId)||!1,C=(null===(e=null==b?void 0:b.createStreamDocumentGates)||void 0===e?void 0:e.createStreamDocumentEnabled)||!1,O=(null===(t=null==b?void 0:b.createScreenRecordingDocumentGates)||void 0===t?void 0:t.createScreenRecordingDocumentEnabled)||!1,T=(null===(n=null==b?void 0:b.createClipchampAadGates)||void 0===n?void 0:n.createClipchampAadEnabled)&&w||!1,S=(null===(f=null==b?void 0:b.templatesCollectionsV2Gates)||void 0===f?void 0:f.templatesCollectionsV2Enabled)&&!w,k=function(e){return function(e){return Object(l.c)(["OneNoteConfig"],(function(){return function(e){return Object(d.__awaiter)(this,void 0,void 0,(function(){return Object(d.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(h.a)("oneNoteConfig",e)];case 1:return[2,t.sent()]}}))}))}(e)}),{staleTime:1/0,cacheTime:1/0,enabled:!!e})}(e).data}(y);return Object(u.useMemo)((function(){var e=new Map;return p&&m&&(e.set(i.a.Word,{title:p.linkCandidateResources.createMenuLinkWordTitle,fileTypeName:p.linkCandidateResources.createModalLinkWordTitle,appName:p.linkCandidateResources.wordName,fileType:i.a.Word,newDocName:p.linkCandidateResources.newWordDocumentFileName,fileExtension:"docx",workloadOnlineName:p.linkCandidateResources.wordName,canCreateBlankDocument:m.createOneDriveDocApiEnabled,canOpenBlankDocInNativeApp:!0,canFallbackToLandingPage:!m.startPageApps.has(i.a.Word),createDocAspxEnabled:m.createDocAspxWordEnabled,docAspxId:1}),e.set(i.a.Excel,{title:p.linkCandidateResources.createMenuLinkExcelTitle,fileTypeName:p.linkCandidateResources.createModalLinkExcelTitle,appName:p.linkCandidateResources.excelName,fileType:i.a.Excel,newDocName:p.linkCandidateResources.newExcelWorkbookFileName,fileExtension:"xlsx",workloadOnlineName:p.linkCandidateResources.excelName,canCreateBlankDocument:m.createOneDriveDocApiEnabled,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!m.startPageApps.has(i.a.Excel),createDocAspxEnabled:m.createDocAspxExcelEnabled,docAspxId:2}),e.set(i.a.PowerPoint,{title:p.linkCandidateResources.createMenuLinkPowerPointTitle,fileTypeName:p.linkCandidateResources.createModalLinkPowerPointTitle,appName:p.linkCandidateResources.powerpointName,fileType:i.a.PowerPoint,newDocName:p.linkCandidateResources.newPowerPointPresentationFileName,fileExtension:"pptx",workloadOnlineName:p.linkCandidateResources.powerpointName,canCreateBlankDocument:m.createOneDriveDocApiEnabled,canOpenBlankDocInNativeApp:!0,canFallbackToLandingPage:!m.startPageApps.has(i.a.PowerPoint),createDocAspxEnabled:m.createDocAspxPowerPointEnabled,docAspxId:3}),e.set(i.a.Sway,{title:p.linkCandidateResources.createMenuLinkSwayTitle,fileTypeName:p.linkCandidateResources.createModalLinkSwayTitle,appName:p.linkCandidateResources.swayName,fileType:i.a.Sway,workloadOnlineName:p.linkCandidateResources.microsoftSwayName,canCreateBlankDocument:m.swayCreateNewEnabled,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!m.startPageApps.has(i.a.Sway),createDocAspxEnabled:!1}),m.fluidCreateNewEnabled&&e.set(i.a.Fluid,{title:p.linkCandidateResources.createMenuLinkFluidTitle,fileTypeName:p.linkCandidateResources.createModalLinkFluidTitle,appName:p.linkCandidateResources.fluidName,fileType:i.a.Fluid,canCreateBlankDocument:m.fluidSupportEnabled,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:!1}),m.fluidCreateAbpEnabled&&e.set(i.a.FluidActivityBlueprint,{title:p.linkCandidateResources.createMenuLinkFluidAbpTitle,fileTypeName:p.linkCandidateResources.createModalLinkFluidAbpTitle,appName:p.linkCandidateResources.fluidName,fileType:i.a.FluidActivityBlueprint,canCreateBlankDocument:m.fluidSupportEnabled,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:!1}),m.startPageApps.has(i.a.Forms)&&(e.set(i.a.Forms,{appName:p.linkCandidateResources.formsName,title:p.linkCandidateResources.createMenuLinkFormsTitle,fileTypeName:p.linkCandidateResources.createModalLinkFormsFormTitle,workloadOnlineName:p.linkCandidateResources.formsName,fileType:i.a.Forms,canCreateBlankDocument:!0,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:!1,newDocName:p.linkCandidateResources.newFormsSurveyFileName}),e.set(i.a.FormsQuiz,{appName:p.linkCandidateResources.formsName,title:p.linkCandidateResources.createMenuLinkFormsQuizTitle,fileTypeName:p.linkCandidateResources.createModalLinkFormsQuizTitle,workloadOnlineName:p.linkCandidateResources.formsName,fileType:i.a.FormsQuiz,canCreateBlankDocument:!0,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:!1,newDocName:p.linkCandidateResources.newFormsQuizFileName})),m.startPageApps.has(i.a.OneNote)&&(null==k?void 0:k.enableOneNoteApis)&&e.set(i.a.OneNote,{title:p.linkCandidateResources.createMenuLinkOneNoteTitle,fileTypeName:p.linkCandidateResources.createModalLinkOneNoteTitle,appName:p.linkCandidateResources.onenoteName,fileType:i.a.OneNote,workloadOnlineName:p.linkCandidateResources.onenoteName,canCreateBlankDocument:m.createOneDriveDocApiEnabled,canOpenBlankDocInNativeApp:!0,canFallbackToLandingPage:!1,createDocAspxEnabled:!1}),m.startPageApps.has(i.a.Visio)?e.set(i.a.Visio,{title:p.linkCandidateResources.createMenuLinkVisioTitle,fileTypeName:p.linkCandidateResources.createModalLinkVisioTitle,appName:p.linkCandidateResources.visioName,fileType:i.a.Visio,newDocName:p.linkCandidateResources.newVisioDrawingFileName,fileExtension:"vsdx",workloadOnlineName:p.linkCandidateResources.visioName,canCreateBlankDocument:m.createOneDriveDocApiEnabled,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!1,createDocAspxEnabled:m.createDocAspxVisioEnabled,docAspxId:8}):m.createVisioEnabled&&e.set(i.a.Visio,{title:p.linkCandidateResources.createMenuLinkVisioTitle,fileTypeName:p.linkCandidateResources.createModalLinkVisioTitle,appName:p.linkCandidateResources.visioName,fileType:i.a.Visio,newDocName:p.linkCandidateResources.newVisioDrawingFileName,fileExtension:"vsdx",workloadOnlineName:p.linkCandidateResources.visioName,canCreateBlankDocument:m.createOneDriveDocApiEnabled&&m.createDocAspxVisioEnabled,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:m.createDocAspxVisioEnabled,docAspxId:8}),C&&m.startPageApps.has(i.a.Stream)&&(e.set(i.a.Stream,{title:p.linkCandidateResources.createMenuLinkStreamTitle,fileTypeName:p.linkCandidateResources.createModalLinkStreamTitle,appName:p.linkCandidateResources.streamName,fileType:i.a.Stream,fileExtension:"webm",workloadOnlineName:p.linkCandidateResources.streamName,canCreateBlankDocument:m.createOneDriveDocApiEnabled,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:!1}),O&&e.set(i.a.ScreenRecording,{title:p.linkCandidateResources.createMenuLinkScreenRecordingTitle,fileTypeName:p.linkCandidateResources.createModalLinkScreenRecordingTitle,appName:p.linkCandidateResources.streamName,fileType:i.a.ScreenRecording,fileExtension:"webm",workloadOnlineName:p.linkCandidateResources.streamName,canCreateBlankDocument:m.createOneDriveDocApiEnabled,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:!1})),T&&e.set(i.a.Clipchamp,{title:p.linkCandidateResources.createMenuLinkClipchampTitle,fileTypeName:p.linkCandidateResources.createModalLinkClipchampTitle,appName:p.linkCandidateResources.clipchampName,fileType:i.a.Clipchamp,canCreateBlankDocument:!0,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:!1}),S&&(e.set(i.a.Designer,{title:p.linkCandidateResources.designerName,fileTypeName:p.linkCandidateResources.designerName,appName:p.linkCandidateResources.designerName,createDocAspxEnabled:!1,fileType:i.a.Designer,canCreateBlankDocument:!0,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0}),e.set(i.a.Clipchamp,{title:p.linkCandidateResources.clipchampName,fileTypeName:p.linkCandidateResources.clipchampName,appName:p.linkCandidateResources.clipchampName,createDocAspxEnabled:!1,fileType:i.a.Clipchamp,canCreateBlankDocument:!0,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0}))),e}),[p,m,null==k?void 0:k.enableOneNoteApis,C,T,S,O])}},huqQ:function(e,t,n){"use strict";e.exports=n("y8H0")},"hv/+":function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n("QjXU"),o=n("5DIn"),i=n("otd6"),s=n("S6Pj"),a=n("kAXT");function c(){return{palette:{themePrimary:"#3A96DD",themeLighterAlt:"#eff6fc",themeLighter:"#deecf9",themeLight:"#c7e0f4",themeTertiary:"#71afe5",themeSecondary:"#2b88d8",themeDarkAlt:"#106ebe",themeDark:"#004578",themeDarker:"#34365c",neutralLighterAlt:"#292827",neutralLighter:"#323130",neutralLight:"#3B3A39",neutralQuaternaryAlt:"#484644",neutralQuaternary:"#605E5C",neutralTertiaryAlt:"#484644",neutralTertiary:"#A19F9D",neutralSecondary:"#BEBBB8",neutralPrimaryAlt:"#E1DFDD",neutralPrimary:"#F3F2F1",neutralDark:"#FAF9F8",redDark:"#FF4343",black:"#FFFFFF",white:"#252423",primaryBackground:"#f9f8f7",primaryText:"#252423",bodyBackground:"#252423",bodyText:"#252423",disabledBackground:"#3B3A39",disabledText:"#c8c8c8"}}}var u="share-control-close-event",l=function(e){switch(e.key){case o.a.Escape:e.preventDefault(),e.stopPropagation(),function(){document.dispatchEvent(new CustomEvent(u)),d()}()}},d=function(){document.removeEventListener("keydown",l)};function h(e,t,n,o){var d,h=document.createElement("iframe"),f=document.createElement("div");f.appendChild(h),n.appendChild(f);var p=Object.entries(null!=o?o:{left:"50%",position:t.shareUIPosition,top:t.shareUITop}).map((function(e){var t=Object(r.__read)(e,2),n=t[1];return"".concat(t[0],": ").concat(n)})).join(";");h.setAttribute("style",p),h.setAttribute("role","dialog"),h.setAttribute("aria-label",null!==(d=null==t?void 0:t.ariaLabel)&&void 0!==d?d:"Share"),h.className="shareStyles-module__share-control__QO7pm";var m=function(e){return Object(i.a)(e,["click",u])}(f);return function(e,t,n){var o=t.item,i=t.fetchAccessToken,u=t.shareApiUrl,l=t.iframeElement,d=t.isMsa,h=t.tenantId,f=t.mode,p=t.organizationName,m=t.correlationId,g=t.onError,v=t.setStyle,b=t.onGrantAccessComplete,y=t.navId,w=t.scenarioId,C=t.defaultRecipients,O=t.darkMode,T=t.onOpen,S=t.onClose,k=t.onShareCompleted,E=t.onShareReady,_=t.tokenProviderEnabled,j=n.listenForClose,I=n.closeControl;Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,N,A,P,x,D,L,M,R,F,B,U,W,q;return Object(r.__generator)(this,(function(H){switch(H.label){case 0:t=e.getShareTokenInfo(o),n=t.accessTokenConsumer,N=t.resourceUrl,A=t.webAbsoluteUrl,H.label=1;case 1:return H.trys.push([1,3,,4]),[4,i(n,!1,N)];case 2:return P=H.sent(),[3,4];case 3:return x=H.sent(),g(x),[2];case 4:return P&&P.token?(v(function(e,t){var n="320px";switch(e){case a.a.Share:return{width:n,height:"400px"};case a.a.CopyLink:case a.a.AtMention:return{width:n,height:"238px"};default:return{width:n,height:"150px"}}}(f)),D=P.token.trim(),L=Object(r.__assign)(Object(r.__assign)({},e.getShareControlIdentifier(o)),{authToken:D,clientId:"officecom",correlationId:m,defaultRecipients:C,isODB:!d&&"OneDrive"===n,itemName:o.name,mode:f,navId:y,scenarioId:w,organizationName:p,siteSubscriptionId:h,theme:O?c():void 0,webAbsoluteUrl:A,hasTokenProvider:_}),M=JSON.stringify(L).replace(/"/g,"&quot;"),R='<!DOCTYPE html><html><head></head><body><form id="shareform" action="SHAREAPIENDPOINT" method="post"><input type="text" name="context" value="POSTJSON" style="display: none"/><input type="text" name="access_token" value="TOKENVALUE" style="display: none"/></form></body></html>'.replace("SHAREAPIENDPOINT",u).replace("POSTJSON",(function(){return M})).replace("TOKENVALUE",(function(){return D})),(F=l.contentDocument)&&(F.body.innerHTML=R,F.getElementById("shareform").submit()),B=setTimeout((function(){g("Timed out on load")}),15e3),U=!1,W=document.activeElement,T&&T(),q=function(e){var t,r,o=e.origin;if(u.startsWith(o)){var a=JSON.parse(e.data);switch(a.name){case"share_completed":k&&a.shareType&&k(a.shareType);break;case"share_ready":setTimeout((function(){return l.focus()}),0),clearTimeout(B),E&&E(Date.now());break;case"share_error":clearTimeout(B),g(a.errorMessage||"error not provided",a),null==b||b.call(!1,!1,!0);break;case"share_resize":var c=a.width,d=a.height;0!==c&&0!==d&&v({width:"".concat(c,"px"),height:"".concat(d,"px")});break;case"share_dismiss":I(),Object(s.a)(W)&&W.focus();break;case"share_grantAccessCompleted":var h=a.successful;h&&b&&(b(h),U=!0);break;case"share_getToken":if(!_)break;try{P=i(n,!1,N,void 0,void 0,null===(t=a.claimsChallenge)||void 0===t?void 0:t.claims).then((function(e){var t,n;if(!e)return g("Unable to get token for share control"),void(null===(t=null==l?void 0:l.contentWindow)||void 0===t||t.postMessage(JSON.stringify({name:"share_newToken",error:"Unable to get token for share control"}),o));null===(n=null==l?void 0:l.contentWindow)||void 0===n||n.postMessage(JSON.stringify({name:"share_newToken",token:e.token.trim()}),o)}))}catch(e){return void(null===(r=null==l?void 0:l.contentWindow)||void 0===r||r.postMessage(JSON.stringify({name:"share_newToken",error:"Error while fetching token for share control"}),o))}}}},window.addEventListener("message",q),j().subscribe((function(){S&&S(),q&&window.removeEventListener("mess shart(r.__assign)({},t),{iframeElement:h,setStyle:function(e){h.style.width=e.width,h.style.height=e.height}}),m),function(){document.addEventListener("keydown",l)}(),m}},"i+S2":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("QjXU"),o=n("mXGw"=Object(o.useCallback)((function(){var t=i.get(e);return t||(t=window.matchMedia(e),i.set(e,t),t)}),[e]),n=Object(o.useCallback)((function(){return t().matches}),[t]),s=Object(r.__read)(Object(o.uurn Object(o.useEffect)((function(){var e=t();e.matches!==a&&c(e.matches);var n=function(){c(e.matches)};return e.addListener(n),function(){e.removeListener(n)}}),[t,a]),a}},"i+uS":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c}));var r=n("QjXU"),o=n("nLxx"),i=n("5eS3"),s=n("z+rT");function a(e,t,n){return t&&t.loginHint&&n&&n.outgoingLoginHintEnabled&&Object(i.a)(e,"login_hint=".concat(t.loginHint)),e}function c(e,t,n,c,u,l,d,h){return Object(r.__awaiter)(this,void 0,void 0,(function(){var f,p,m,g;return Object(r.__generator)(this,(function(r){return f={},e.webDavUrl&&(f.canonicalUrl=a(e.webDavUrl,n,d)),p=a(e.webUrl,n,d),m="action=editnew",-1===(p=p.replace(new RegExp("([?&])action[^&]*"),"$1action=editnew")).lastIndexOf(m)&&(p=Object(i.a)(p,m)),u&&(p=Object(i.a)(p,"wdTpl=".concat(u))),(u||l&&l.createLcidEnabled)&&(p=Object(i.a)(p,"wdlcid=".concat(c.officeMarketLcid))),d&&d.scenarioId&&(p=Object(i.a)(p,"wdscenarioid=".concat(d.scenarioId))),g=Object(o.a)(n.workload,n.router.getCject=exports=o},i0JV:function(e,t,n){var r=n("FEiO"),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:o.call(t,e)}},i1Ej:function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return c}));var r=!1,o=.8,i=.9,s="https://account.microsoft.com/services/microsoft365/renew?fref=Office-value-banner-renew",a="https://go.microsoft.com/fwlink/?linkid=2228772",c="login_hint"},"i3m/":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var r="drive/",o=["id","openWith","officebundle","currentUserRole","eTag","name","size","content.downloadUrl","file","sharepointIds","sensitivityLabel","webUrl"]},"i8/d":function(e,t,n){var r={"./af/office-start-resources-21eb30073d.json":["YlUq",776],"./af/search-me-control-resources-c8028289e6.json":["6FF/",777],"./am/office-start-resources-38f68171de.json":["Yr4V",778],"./am/search-me-control-resources-9993738eec.json":["r0EK",779],"./ar/office-start-resources-4d14360356.json":["Eb4O",780],"./ar/search-me-control-resources-d8a7daa3eb.json":["yGao",781],"./as/office-start-resources-2e2fb4f2c7.json":["LwNl",782],"./as/search-me-control-resources-c3e22c05fc.json":["oWN9",783],"./az/office-start-resources-1fc1551471.json":["p573",784],"./az/search-me-control-resources-fecfe732f7.json":["719R",785],"./bg/office-start-resources-4eb14dc63d.json":["P8uq",786],"./bg/search-me-control-resources-fe4e0ffeb1.json":["i76P",787],"./bn-in/office-start-resources-315f409910.json":["QZlV",788],"./bn-in/search-me-control-resources-961da04af6.json":["daMm",789],"./bs/office-start-resources-adbacbd25b.json":["J+mC",790],"./bs/search-me-control-resources-c4cfce428c.json":["wpLW",791],"./ca-es-valencia/office-start-resources-5e922fce83.json":["G1xU",792],"./ca-es-valencia/search-me-control-resources-b6d81df6ef.json":["YgkS",793],"./ca/office-start-resources-2b0072a72e.json":["EEpc",794],"./ca/search-me-control-resources-285ac1fa74.json":["gTi9",795],"./combined-resources-properties.json":["R6J4",796],"./cs/office-start-resources-24275413d2.json":["3Uvx",797],"./cs/search-me-control-resources-090a8848f3.json":["dmDR",798],"./cy/office-start-resources-ddc6586ccb.json":["/hz1",799],"./cy/search-me-control-resources-9579ad01b9.json":["j2Io",800],"./da/office-start-resources-7c69ae37bb.json":["S+3d",801],"./da/search-me-control-resources-2f53398e9d.json":["xvdM",802],"./de/office-start-resources-6499dc1f7d.json":["Y1aZ",803],"./de/search-me-control-resources-1376b1850e.json":["ziFx",804],"./el/office-start-resources-7a852f08f3.json":["cVsB",805],"./el/search-me-control-resources-da69800d57.json":["RucZ",806],"./en-gb/office-start-resources-f592cd3228.json":["ivzg",807],"./en-gb/search-me-control-resources-a7588fcdc9.json":["SIP4",808],"./es-mx/office-start-resources-c28a7d2d4f.json":["azxh",809],"./es-mx/search-me-control-resources-362f44f771.json":["hpcB",810],"./es/office-start-resources-0cf403aa36.json":["HnS5",811],"./es/search-me-control-resources-3b79806506.json":["pRDb",812],"./et/office-start-resources-6b16618c9e.json":["aw7A",813],"./et/search-me-control-resources-a4d4149061.json":["4NR0",814],"./eu/office-start-resources-e29695fb3a.json":["FzE9",815],"./eu/search-me-control-resources-796bb4a379.json":["Nc+w",816],"./fa/office-start-resources-3020bcfd2f.json":["pH0t",817],"./fa/search-me-control-resources-327ba3f149.json":["PDCa",818],"./fi/office-start-resources-7e2c8be34c.json":["GAzF",819],"./fi/search-me-control-resources-821a45203e.json":["Lm0Z",820],"./fil/office-start-resources-d70593afac.json":["+J+d",821],"./fil/search-me-control-resources-43cf9478fe.json":["Yobf",822],"./fr-ca/office-start-resources-1f1a968fdf.json":["6Oql",823],"./fr-ca/search-me-control-resources-e5f06dc12c.json":["SYlE",824],"./fr/office-start-resources-f044050dff.json":["P+mY",825],"./fr/search-me-control-resources-36d8e21c24.json":["a2t9",826],"./ga/office-start-resources-c276811aac.json":["IO7G",827],"./ga/search-me-control-resources-7942ccb3f1.json":["kCWo",828],"./gd/office-start-resources-d638c7a446.json":["RFNY",829],"./gd/search-me-control-resources-f98c714f77.json":["BiyT",830],"./gl/office-start-resources-ed7ef6dad7.json":["rHbG",831],"./gl/search-me-control-resources-4122d5eb25.json":["Hx4l",832],"./gu/office-start-resources-1466516223.json":["kI9m",833],"./gu/search-me-control-resources-c9bd590306.json":["SW6F",834],"./he/office-start-resources-08e17a8141.json":["y1y1",835],"./he/search-me-control-resources-1d6156fdcc.json":["FY0o",836],"./hi/office-start-resources-812f51b836.json":["ztSr",837],"./hi/search-me-control-resources-9c8034488f.json":["wZ74",838],"./hr/office-start-resources-00c51c7831.json":["bo8y",839],"./hr/search-me-control-resources-0720fa1500.json":["Y6HY",840],"./hu/office-start-resources-d24e8076f3.json":["71fn",841],"./hu/search-me-control-resources-65e30b77a1.json":["6KTF",842],"./hy/office-start-resources-5b469e431c.json":["WcGA",843],"./hy/search-me-control-resources-55534b096d.json":["0/6u",844],"./id/office-start-resources-800bd593a3.json":["MGsh",845],"./id/search-me-control-resources-11eb90ff74.json":["sNwL",846],"./is/office-start-resources-b44a4d6b0c.json":["AglW",847],"./is/search-me-control-resources-19a44b44d1.json":["6ABh",848],"./it/office-start-resources-260201136f.json":["TK3b",849],"./it/search-me-control-resources-a8f124c052.json":["KLj9",850],"./ja/office-start-resources-7c0f110061.json":["ijhy",851],"./ja/search-me-control-resources-affd172420.json":["Z42Q",852],"./ka/office-start-resources-e3402fc59b.json":["QW73",853],"./ka/search-me-control-resources-58d1f4104a.json":["MnQG",854],"./kk/office-start-resources-f1e4d73413.json":["0qdi",855],"./kk/search-me-control-resources-c720f747dc.json":["vuJ1",856],"./km-kh/office-start-resources-500a092e48.json":["tAGH",857],"./km-kh/search-me-control-resources-356566e869.json":["usgt",858],"./kn/office-start-resources-147c752e65.json":["MtNu",859],"./kn/search-me-control-resources-57618c4c91.json":["B+Bq",860],"./ko/office-start-resources-e665b67a68.json":["et5x",861],"./ko/search-me-control-resources-45a8fc6279.json":["ILzz",862],"./kok/office-start-resources-da11a9f4cd.json":["mgzv",863],"./kok/search-me-control-resources-80f02e6fa4.json":["n+Cv",864],"./lb/office-start-resources-153d328115.json":["qGX2",865],"./lb/search-me-control-resources-66d5eebdcb.json":["pRkz",866],"./lo/office-start-resources-66bb452c48.json":["B0vv",867],"./lo/search-me-control-resources-514fcc8e7b.json":["nR97",868],"./lt/office-start-resources-5b22e181dc.json":["1kwa",869],"./lt/search-me-control-resources-846d9a66fe.json":["DtAD",870],"./lv/office-start-resources-d84eeed661.json":["ZhTC",871],"./lv/search-me-control-resources-cfbef68d6c.json":["YqTU",872],"./mi/office-start-resources-e632ba9c3e.json":["BPKi",873],"./mi/search-me-control-resources-28da62231a.json":["OVrk",874],"./mk/office-start-resources-6f80080a63.json":["qx+b",875],"./mk/search-me-control-resources-03d885d51b.json":["SPbp",876],"./ml/office-start-resources-60953423ba.json":["s0xr",877],"./ml/search-me-control-resources-eaf522c8ab.json":["s5vO",878],"./mr/office-start-resources-04441b3a6d.json":["i0yH",879],"./mr/search-me-control-resources-33b56b9876.json":["YkD2",880],"./ms/office-start-resources-d85d18b2dc.json":["QSl5",881],"./ms/search-me-control-resources-45770c79f9.json":["VX/o",882],"./mt/office-start-resources-ae7551630d.json":["c/fw",883],"./mt/search-me-control-resources-11d7afdbce.json":["/TOy",884],"./nb-no/office-start-resources-8ee32147bc.json":["NYw1",885],"./nb-no/search-me-control-resources-207119e3c0.json":["oxxt",886],"./ne/office-start-resources-aad6e8be5e.json":["9nHq",887],"./ne/search-me-control-resources-dbcb1821ad.json":["GYhb",888],"./nl/office-start-resources-ef2c4d4ff9.json":["yoQN",889],"./nl/search-me-control-resources-835defbb8f.json":["IkL1",890],"./nn-no/office-start-resources-936287b691.json":["jecO",891],"./nn-no/search-me-control-resources-0d9fa7348c.json":["w5Q2",892],"./office-start-fallbackloc-manifest.json":["K5H/",893],"./office-start-resources.json":["+6d6",894],"./office-start-strings-manifest.json":["ORuF"],"./or/office-start-resources-b48ee4783e.json":["ekW3",895],"./or/search-me-control-resources-6e657c318a.json":["nkRD",896],"./pa/office-start-resources-56e5fd0568.json":["stf3",897],"./pa/search-me-control-resources-14083a3d53.json":["7W+9",898],"./pl/office-start-resources-86f114d6d7.json":["wrvu",899],"./pl/search-me-control-resources-44278bd246.json":["nOEp",900],"./pt-br/office-start-resources-22fad791a9.json":["1sbx",901],"./pt-br/search-me-control-resources-ac363febbb.json":["ztMz",902],"./pt-pt/office-start-resources-db5bf04b97.json":["74mE",903],"./pt-pt/search-me-control-resources-487254e0b4.json":["9k9v",904],"./quz/office-start-resources-f67dcdbcfb.json":["e4c1",905],"./quz/search-me-control-resources-742178dbed.json":["2BM2",906],"./ro/office-start-resources-797ac16eda.json":["2Jpl",907],"./ro/search-me-control-resources-2ba8e3e62d.json":["d7t8",908],"./ru/office-start-resources-f9a906c018.json":["FFym",909],"./ru/search-me-control-resources-e86d48cab1.json":["AHMd",910],"./search-me-control-resources.json":["CwOr",911],"./sk/office-start-resources-a5b36c4bd9.json":["bRFc",912],"./sk/search-me-control-resources-591c50e0bb.json":["3RZ1",913],"./sl/office-start-resources-4720999b11.json":["H7sE",914],"./sl/search-me-control-resources-def5ae0dce.json":["EtLx",915],"./sq/office-start-resources-902b8ad542.json":["1mAB",916],"./sq/search-me-control-resources-f142459356.json":["Oo3E",917],"./sr-cyrl-ba/office-start-resources-77c3e008f1.json":["MaOz",918],"./sr-cyrl-ba/search-me-control-resources-fca230cd09.json":["GEj1",919],"./sr-cyrl-rs/office-start-resources-591742481a.json":["kihj",920],"./sr-cyrl-rs/search-me-control-resources-fd760c6e4c.json":["tq4U",921],"./sr-latn-rs/office-start-resources-770fea8fea.json":["/5rQ",922],"./sr-latn-rs/search-me-control-resources-46cf035e4d.json":["1frp",923],"./sv/office-start-resources-40657de19b.json":["L+Mf",924],"./sv/search-me-control-resources-422305af0b.json":["8DIp",925],"./ta/office-start-resources-0f377dba17.json":["fiR7",926],"./ta/search-me-control-resources-27239afbd7.json":["XxC5",927],"./te/office-start-resources-ddc9ceb238.json":["KaPF",928],"./te/search-me-control-resources-7016e3e2d4.json":["SooI",929],"./th/office-start-resources-d18484a251.json":["NbhH",930],"./th/search-me-control-resources-93d10ae3cd.json":["8Zf6",931],"./tr/office-start-resources-9ad1c06c0d.json":["Z35B",932],"./tr/search-me-control-resources-dc37f42a6d.json":["K9D8",933],"./tt/office-start-resources-7fc81c459b.json":["qJb7",934],"./tt/search-me-control-resources-21f8499422.json":["c3Ch",935],"./ug/office-start-resources-8c9989eb78.json":["qV1A",936],"./ug/search-me-control-resources-d45641ff75.json":["MJ7n",937],"./uk/office-start-resources-976501c3b3.json":["m5An",938],"./uk/search-me-control-resources-2e1bdd16e5.json":["Rf50",939],"./ur/office-start-resources-1fb4118733.json":["G657",940],"./ur/search-me-control-resources-485089f2ee.json":["s+wC",941],"./uz-latn-uz/office-start-resources-e6daed73cb.json":["pWVS",942],"./uz-latn-uz/search-me-control-resources-8328fb040d.json":["3g2F",943],"./vi/office-start-resources-0e04f54bf5.json":["723k",944],"./vi/search-me-control-resources-41cfa4ab5b.json":["aVJi",945],"./zh-hans/office-start-resources-fcc644e7a2.json":["TaT0",946],"./zh-hans/search-me-control-resources-d2eCannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var on(){se"[object Number]":case"[object String]":return new c(e);case"[object RegExp]":return i(e);case"[object Set]":return new c;case"[object Symbol]":return s(e)}}},iijs:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("mXGw"),o=n("8LaP"),i=n("9qdX"),s=n("GBVN");const a=Object(i.a)({root:{mc9l5x:"f22iagw",Beiy3e4:"f1vx9l62",Bbmb7ep:["fnivh3a","fc7yr5o"],Beyfa6y:["fc7yr5o","fnivh3a"],B7oj6ja:["f1el4m67","f8yange"],Btl43ni:["f8yange","f1el4m67"],B9xav0g:"f1aperda",Eqx8gd:["f1n6gb5g","f15yvnhg"],B1piin3:["f15yvnhg","f1n6gb5g"],oetu4i:"f1xwbbk2",wmxk5l:"f195f1q4",Bi904bx:"fzoepzj"},small:{z8tnut:"f5yzyt",z189sj:["fw5db7e","f1uw59to"],Byoj8tv:"fdxej3c",uwmqm3:["f1uw59to","fw5db7e"]},medium:{z8tnut:"f5yzyt",z189sj:["fq3vbzb","ftciz5z"],Byoj8tv:"fx3omr",uwmqm3:["ftciz5z","fq3vbzb"]},large:{z8tnut:"f1kwiid1",z189sj:["fcgl2c4","f1anj20m"],Byoj8tv:"f5b47ha",uwmqm3:["f1anj20m","fcgl2c4"]},textarea:{z8tnut:"f1g0x7ka",z189sj:["fhxju0i","f1cnd47f"],Byoj8tv:"f1qch9an",uwmqm3:["f1cnd47f","fhxju0i"]}},{d:[".f22iagw{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}",".f1vx9l62{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}",".fnivh3a{border-bottom-right-radius:var(--borderRadiusXLarge);}",".fc7yr5o{border-bottom-left-radius:var(--borderRadiusXLarge);}",".f1el4m67{border-top-right-radius:var(--borderRadiusXLarge);}",".f8yange{border-top-left-radius:var(--borderRadiusXLarge);}",".f1aperda{border-bottom-color:var(--colorNeutralStroke1);}",".f1n6gb5g::after{left:0;}",".f15yvnhg::after{right:0;}",".f5yzyt{padding-top:var(--spacingVerticalM);}",".fw5db7e{padding-right:var(--spacingHorizontalM);}",".f1uw59to{padding-left:var(--spacingHorizontalM);}",".fdxej3c{padding-bottom:var(--spacingVerticalL);}",".fq3vbzb{padding-right:var(--spacingHorizontalXL);}",".ftciz5z{padding-left:var(--spacingHorizontalXL);}",".fx3omr{padding-bottom:var(--spacingVerticalM);}",".f1kwiid1{padding-top:var(--spacingVerticalS);}",".fcgl2c4{padding-right:calc(var(--spacingHorizontalM) + var(--spacingHorizontalXXS));}",".f1anj20m{padding-left:calc(var(--spacingHorizontalM) + var(--spacingHorizontalXXS));}",".f5b47ha{padding-bottom:var(--spacingVerticalS);}",".f1g0x7ka{padding-top:0;}",".fhxju0i{padding-right:0;}",".f1cnd47f{padding-left:0;}",".f1qch9an{padding-bottom:0;}"],h:[".f1xwbbk2:hover{border-bottom-color:var(--colorNeutralStroke1);}"],a:[".f195f1q4:active{border-bottom-color:var(--colorNeutralStroke1);}"],w:[".fzoepzj:focus-within:has(button:focus):after{display:none;}"]}),c=e=>{const t=a(),n=e,{size:r}=n;n.textarea.className=Object(s.a)(n.textarea.className,t.textarea),n.root.className=Object(s.a)(n.root.className,t.root,t[r])},u=Object(i.a)({root:{Bbmb7ep:["fnivh3a","fc7yr5o"],Beyfa6y:["fc7yr5o","fnivh3a"],B7oj6ja:["f1el4m67","f8yange"],Btl43ni:["f8yange","f1el4m67"]}},{d:[".fnivh3a{border-bottom-right-radius:var(--borderRadiusXLarge);}",".fc7yr5o{border-bottom-left-radius:var(--borderRadiusXLarge);}",".f1el4m67{border-top-right-radius:var(--borderRadiusXLarge);}",".f8yange{border-top-left-radius:var(--borderRadiusXLarge);}"]}),l=e=>{const t=u(),n=e;n.root.className=Object(s.a)(n.root.className,t.root)},d=e=>{const t={useTextareaStyles_unstable:c,useCardStyles_unstable:l},{copilotTheme:n,mode:i,includeLegacyCustomStyles:s=!0}=e;var a,u,d;const f={"--fai-colorBrandFlair1":null!==(a=null==n?void 0:n.colorBrandFlair1)&&void 0!==a?a:"#464FEB","--fai-colorBrandFlair2":null!==(u=null==n?void 0:n.colorBrandFlair2)&&void 0!==u?u:"#47CFFA","--fai-colorBrandFlair3":null!==(d=null==n?void 0:n.colorBrandFlair3)&&void 0!==d?d:"#B47CF8"};return r.createElement("div",{style:f,className:e.className},r.createElement(h.Provider,{value:{mode:null!=i?i:"canvas"}},r.createElement(o.a,{value:s?t:{}},e.children)))},h=r.createContext({mode:"canvas"});d.displayName="CopilotProvider"},ijiB:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("mXGw");function o(){var e=Object(r.useRef)(0);return Object(r.useCallback)((function(t){var n=e.currt--),no.a.useContext(i.a)}},jL4t:function(e,t){var n=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},jbqF:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("mXGw"),o=n.n(r).a.createContext(void 0)},jgJv:function(e,t,n){var r=n("s3UK");e.exports=r.Symbol},jwKD:function(e,t,n){"use strict";n.d(t,"d",(function(){return $})),n.d(t,"b",(function(){return Q})),n.d(t,"a",(function(){return J})),n.d(t,"c",(function(){return X}));var r=n("QjXU"),o=n("Rh0W"),i=n("Zmq1"),s=n("7l51"),a=n("RtYo"),c=n("/Oio"),u=n("zpal"),l=n("uReB"),d=n("sDzn"),h=n("TiPK"),f=n("Sn4U"),p=n("kAXT"),m=n("qyk8"),g=n("QLkI"),v=n("6ib3"),b=new Set([v.a.Fluid,v.a.FluidActivityBlueprint,v.a.Forms,v.a.List,v.a.MyAnalytics,v.a.NewsArticle,v.a.None,v.a.OneNote,v.a.PlayList,v.a.PlayLists,v.a.Portfolio,v.a.PowerBI,v.a.Project,v.a.ProjectOperations,v.a.Sway,v.a.UpcomingMeeting]);function y(e){return!(!e.fileType||e.isLocalFile||e.isEmailAttachment||b.has(e.fileType))}var w=n("lw5l"),C=n("cenr"),O=n("a3FV"),T=n("gd1C"),S=n("CMIS"),k=n("BaIZ"),E=new Set([v.a.PowerBI,v.a.Sway,v.a.OneNote,v.a.Forms,v.a.PlayList,v.a.PlayLists,v.a.Project,v.a.ProjectOperations,v.a.Portfolio,v.a.StreamsVideo,v.a.UpcomingMeeting,v.a.None,v.a.List]);function _(e){return e.fileType===v.a.UpcomingMeeting||e.isEmailAttachment?e.url:e.attributionUrl}var j=n("VDyW"),I=n("slmW"),N=n("Tqea"),A=n("ywfh"),P=n("15s9"),x=n("vn4N"),D=n("hv/+"),L=n("r6rC"),M=n("SVRA"),R=n("s1V1");function F(e,t,n,o,i,s,a){var c=this;if(void 0===a&&(a=p.a.Share),!e.isEmailAttachment)return function(){return Object(r.__awaiter)(c,void 0,void 0,(function(){var c,u,l,d,h;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(x.a)()];case 1:return c=r.sent(),[4,Object(R.a)()];case 2:return u=r.sent().result,l={item:{url:e.url,name:e.fileName||"",siteUrl:e.sharepointIds?e.sharepointIds.siteUrl:"",type:"Commercial",listItemUniqueId:e.sharepointIds?e.sharepointIds.listItemUniqueId:""},fetchAccessToken:n.getAccessToken,shareApiUrl:(null==c?void 0:c.shareApiEndpoint)||"",market:n.preferredCulture,isMsa:o.isMsa,tenantId:o.tenantId,mode:a,organizationName:(null==u?void 0:u.CompanyDisplayName)||"",correlationId:n.correlationId,shareUIPosition:"officehomereact"==(null==n?void 0:n.workload)?"absolute":"fixed",onError:function(n){var r=function(e,t){var n={};n.Index=t.toString(),n.DocumentType=Object(N.a)(e.fileType),n.ShareControlMode=p.a.Share.toString();var r=Object(A.a)(e.url)||"";return!r&&Object(P.a)(e.url)?r="Consumer":"Documents"===r?r="OneDrive":"Sites"===r&&(r="SharePoint"),n.StorageType=r,n}(e,t);r.Error=n,Object(C.a)(O.a.ShareControlError,r)},darkMode:s},d=document.getElementById(i),h={getShareControlIdentifier:L.a,getShareTokenInfo:M.a},d&&Object(D.a)(h,l,d),[2]}}))}))}}var B=n("YBAc"),U=function(e,t){var n;return e.nextAction&&(n={nextAction:e.nextAction,content:t}),Object(r.__assign)(Object(r.__assign)({},n),{notificationOptions:e.metadata.notificationOptions})},W=n("fv+d"),q=n("ZcZ3"),H=n("C2Jl"),z=n("TA9V"),G=function(e,t,n,r,o,i,s,a){var c,u;if((null===(u=null===(c=t.actionInfo)||void 0===c?void 0:c.odspShareInfo)||void 0===u?void 0:u.enabled)&&void 0!==t.actionInfo.odspShareInfo.type)return B.a.createShareOrCopyAction(e,t.fileName||"",t.actionInfo.odspShareInfo,n,null==r?void 0:r.targetElementId,null==r?void 0:r.style,t.fileType,i,{disabled:o},s,a)},V=function(){var e;return function(t,n,c,u){return void 0===e&&function(e,t,n,o){void 0===o&&(o=W.a);var i=n.documentActionsMenuResources,c=n.documentActionsToastResources,u=n.actionsInContextDialogResources,l=i.copyLinkActionTitle,h=i.downloadActionTitle,f=i.manageAccessActionTitle,m=i.openFileLocationActionTitleSentence,g=i.openMenuTitle,b=i.openInAppActionTitle,w=i.openInBrowserActionTitleSentence,C=i.openInDesktopActionTitleSentence,O=i.scheduleActionTitle,T=i.shareActionTitle,S=i.shareToEmailActionTitle,k=i.shareToTeamsActionTitle,E=i.disabledDownloadActionTooltip,j=i.disabledShareActionTooltip,I=i.disabledOpenFileLocationActionTooltip,N=t.deviceInfo,P=N.isPlatformMobileOrTablet,x=N.isHwa,D=N.isEmbed,L=N.browserType,M=t.exchangeEnabled,R=t.featureGates,F=t.oneDriveEnabled,U=t.userType,V="Consumer"===U&&R.graphApiForV2ConsumerEnabled,$={error:{message:c.copyLinkFailed,actionText:c.closeButtonText},loading:{showLoadingIndicator:!0},success:{message:c.linkCopied,actionText:c.openButtonText}},Q=[{intent:d.b.ContentView,entities:[{type:d.a.Content}],metadata:{appId:o,groupId:s.a.OpenMenu,name:g,description:g,id:W.b.Open,icon:x?{type:a.a.Brand,fileType:v.a.None}:{type:a.a.ActionContextMenuIcon,iconName:"OpenIcon"}},officeActionCreator:function(e){var t={referral:Object(q.a)(e.fileType),referralPlatform:x?"Native":"Web"};return R.linksEnabled&&e.fileType===v.a.Link&&e.driveId&&e.docId?(t.notificationOptions={loading:{showLoadingIndicator:!1},error:{message:"Failed to open link."}},B.a.createLinkContentOpenAction(e,t)):B.a.createContentOpenAction(e,t)}},x?{intent:d.b.ContentView,entities:[{type:d.a.Content}],metadata:{appId:o,groupId:s.a.Open,name:w,description:w,id:W.b.OpenInBrowser,icon:{type:a.a.ActionContextMenuIcon,iconName:"OpenIcon"}},officeActionCreator:function(e){var t;if(e.webUrl)return B.a.createContentUrlAction(e.webUrl,null!==(t=e.isEmailAttachment)&&void 0!==t&&t,"_blank",{referral:Object(q.a)(e.fileType),referralPlatform:"Web"})}}:{intent:d.b.ContentView,entities:[{type:d.a.Content}],metadata:{appId:o,groupId:s.a.Open,name:P?b:C,description:P?b:C,id:W.b.OpenInApp,icon:{type:a.a.Brand,fileType:v.a.None}},officeActionCreator:function(e){if(e.url){var t=Object(H.a)(e);if(t)return B.a.createContentNativeDownloadAction(t,"_blank",{referral:Object(q.a)(e.fileType),referralPlatform:"Native"})}}},{intent:d.b.ContentView,entities:[{type:d.a.Content}],metadata:{appId:o,groupId:s.a.OpenHero,name:m,description:m,id:W.b.OpenFileLocation,icon:{type:a.a.ActionContextMenuIcon,iconName:"FolderIcon"}},officeActionCreator:function(e){var t,n;if(e.attributionUrl){try{new URL(e.attributionUrl)}catch(e){return}var r=e.webUrl?Object(A.a)(e.webUrl):void 0,o=e.isLocalFile?"Native":"Web";if(e.isLocalFile)return B.a.createContentLocationLocalAction(e.attributionUrl,{referral:r,referralPlatform:o});var i=(null===(n=null===(t=e.actionInfo)||void 0===t?void 0:t.openFileLocationActionInfo)||void 0===n?void 0:n.disabled)||!1;return B.a.createContentLocationAction(e.attributionUrl,"_blank",i?I:void 0,{referral:r,referralPlatform:o,disabled:i})}}},{intent:d.b.ContentView,entities:[{type:d.a.Content}],metadata:{appId:o,groupId:s.a.Share,name:l,description:l,id:W.b.LocalCopyLink,icon:{type:a.a.ActionContextMenuIcon,iconName:"LinkIcon"},notificationOptions:$},officeActionCreator:function(e){if(e.isLocalFile){var t=_(e);if(t)return B.a.createCopyToClipboardAction(t,{notificationOptions:$})}}}];if(R.downloadActionEnabled&&Q.push({intent:d.b.ContentView,entities:[{type:d.a.Content}],metadata:{appId:o,groupId:s.a.None,name:h,description:h,id:W.b.Download,icon:{type:a.a.ActionContextMenuIcon,iconName:"DownloadIcon"}},officeActionCreator:function(e){var n,r,o;if(e.driveId&&e.docId&&!e.isEmailAttachment&&!e.isLocalFile&&e.downloadUrl&&((null===(n=t.userDriveId)||void 0===n?void 0:n.toLowerCase())===e.driveId.toLowerCase()||e.downloadUrl!=e.webUrl)){var i=(null===(o=null===(r=e.actionInfo)||void 0===r?void 0:r.downloadActionInfo)||void 0===o?void 0:o.disabled)||!1;if(i||y(e))return B.a.createContentDownloadAction(e.downloadUrl,e.driveId,e.docId,e.sharepointIds,"_blank",i?E:void 0,{disabled:i})}}}),R.odspShareLinkEnabled&&Q.push({intent:d.b.ContentView,entities:[{type:d.a.Content}],metadata:{appId:o,groupId:s.a.Share,name:S,description:S,id:W.b.Share,icon:{type:a.a.ActionContextMenuIcon,iconName:"MailIcon"}},officeActionCreator:function(e,n,r){var o,i,s=(null===(i=null===(o=e.actionInfo)||void 0===o?void 0:o.shareActionInfo)||void 0===i?void 0:i.disabled)||!1;return G(t.companyDisplayName,e,p.a.Share,n,s,s?j:void 0,r,T)}}),R.deleteActionEnabled&&Q.push.apply(Q,Object(r.__spreadArray)([],Object(r.__read)(function(e){var t=e.appId,n=e.hubActionStrings,r=e.systemUserConfig,o=n.documentActionsMenuResources,i=o.deleteActionTitle,c=o.disabledDeleteActionTooltip,u={nextAction:{appId:t,id:W.b.DeleteRestore,mode:d.d.Notification},actionDefinition:{intent:d.b.ContentEdit,entities:[],metadata:{appId:t,name:n.documentActionsMenuResources.deleteRestoreActionTitle,description:n.documentActionsMenuResources.deleteRestoreActionTitle,id:W.b.DeleteRestore,notificationOptions:{loading:{showLoadingIndicator:!1ailed,actionText:n.documentActionsToastResources.deleteUndo},success:void 0}},officeActionCreator:function(e){return B.a.createDeleteRestoreAction({content:e})}}};return[u.actionDefinition,{intent:d.b.ContentView,entities:[{type:d.a.Content}],metadata:{appId:t,badgeText:n.documentActionsMenuResources.newBadgeText,groupId:s.a.None,name:i,description:i,id:W.b.Delete,icon:{type:a.a.ActionContextMenuIcon,iconName:"DeleteIcon"}},officeActionCreator:function(e){var t,o;if(e.driveId&&e.docId){var i,s=e.isOneDriveForBusinessFile?"OneDriveForBusiness":e.isSharePointFile?"SharePoint":"Consumer"===(null===(o=null===(t=e.actionInfo)||void 0===t?void 0:t.odspShareInfo)||void 0===o?void 0:o.type)?"OneDriveConsumer":"Unknown";return i=(!r.userDriveId||"OneDriveConsumer"!==s&&"OneDriveForBusiness"!==s||r.userDriveId.toLowerCase()!==e.driveId.toLowerCase())&&!e.isSharePointFile,B.a.createDeleteAction({content:e,contentSource:s,driveId:e.driveId,itemId:e.docId,sharePointIds:e.sharepointIds,tooltipString:i?c:void 0,options:{content:e,disabled:i,nextAction:u.nextAction,notificationOptions:{loading:{showLoadingIndicator:!1},success:{actionText:"Consumer"===r.userType?n.documentActionsToastResources.deleteUndo:void 0,link:{text:n.documentActionsMenuResources.deleteRestoreActionTitle},message:n.documentActionsToastResources.deleteSuccess}}}})}}}]}({appId:o,hubActionStrings:n,systemUserConfig:t})),!1)),R.odspCopyLinkEnabled&&Q.push({intent:d.b.ContentView,entities:[{type:d.a.Content}],metadata:{appId:o,groupId:s.a.Share,name:l,description:l,id:W.b.CopyLink,icon:{type:a.a.ActionContextMenuIcon,iconName:"LinkIcon"}},officeActionCreator:function(e,n,r){if(!e.isLocalFile)return G(t.companyDisplayName,e,p.a.CopyLink,n,void 0,void 0,r,T)}}),!R.shareToTeamsEnabled||"Enterprise"!=U||t.isGovernment||!x&&"Chrome"!=L&&"Edge"!=L&&"EdgeLegacy"!=L||Q.push({intent:d.b.ContentView,entities:[{type:d.a.Content}],metadata:{appId:o,groupId:s.a.Share,name:k,description:k,id:W.b.ShareToTeams,icon:{type:a.a.Svg,iconName:"TeamsSvgIcon"}},officeActionCreator:function(e){if(e.webUrl&&!e.isLocalFile){var n=e.sharepointIds;return B.a.createContentShareToTeamsAction(e.webUrl,k,u,!0,R.createSharingLinkApiEnabled,t.companyDisplayName,e.driveId,e.docId,e.isSharePointFile?null==n?void 0:n.siteId:void 0,e.isRedeemed)}}}),R.scheduleEnabled&&("Consumer"==U||t.calendarEnabled)&&Q.push({intent:d.b.ContentView,entities:[{type:d.a.Content}],metadata:{appId:o,groupId:s.a.AddTo,name:O,description:O,id:W.b.Schedule,icon:{type:a.a.Svg,iconName:"OutlookSvgIcon"},notificationOptions:{loading:{showLoadingIndicator:!1}}},officeActionCreator:function(e){if((e.title||e.fileName)&&e.webUrl&&e.fileType!==v.a.MeetingObject){var t=e.title;return B.a.createScheduleAction(null!=t?t:e.fileName,e.webUrl,e.isRedeemed)}}}),D&&R.addToDoEnabled&&("Enterprise"===U&&M||V)){var J=function(e,t,n){var r=t.documentActionsMenuResources,o=t.documentActionsToastResources,i={error:{message:o.addedToToDoFailed,actionText:o.closeButtonText},loading:{showLoadingIndicator:!1,loadingText:o.addingToDo},success:{message:o.addedToToDo,actionText:o.openButtonText}},c=[];return c.push({intent:d.b.ContentEdit,entities:[{type:d.a.Content}],metadata:{appId:e,groupId:s.a.AddTo,name:r.createToDoActionTitle,description:r.createToDoActionTitle,id:W.b.CreateTodo,icon:{type:a.a.Svg,iconName:"ToDoSvgIcon"},notificationOptions:i},officeActionCreator:function(t){if(t.webUrl){var n=t.webUrl;return B.a.createTodoAction(t.title||t.fileName||n,n,"Tasks",t.app||r.officeApplicationName,{content:t,nextAction:{appId:e,id:W.b.ViewTodoExternal,mode:d.d.Notification},notificationOptions:i})}}},{intent:d.b.ContentView,entities:[],metadata:{appId:e,name:r.viewInToDoActionTitle,description:r.viewInToDoActionTitle,id:W.b.ViewTodoExternal,notificationOptions:{loading:{showLoadingIndicator:!1},error:{message:o.viewToDoFailed,actionText:o.openButtonText}}},officeActionCreator:function(e){if(e.webUrl)return B.a.createLaunchUrlAction(e.webUrl,"_blank",{referral:"ToDo",referralPlatform:n?"Native":"Web"})}}),c}(W.a,n,x);J&&J.length&&Q.push.apply(Q,Object(r.__spreadArray)([],Object(r.__read)(J),!1))}if(R.convertToPdfEnabled&&F&&(D&&"Enterprise"===U||!D&&V)){var X=function(e,t,n,r){var o=t.documentActionsMenuResources,i=t.documentActionsToastResources;if(o&&i){var c=[],u={nextAction:{appId:e,id:W.b.ViewPdfExternal,mode:d.d.Notification},actionDefinition:{intent:d.b.ContentView,entities:[],metadata:{appId:e,name:o.viewPdfExternalActionTitle,description:o.viewPdfExternalActionTitle,id:W.b.ViewPdfExternal,notificationOptions:{loading:{showLoadingIndicator:!1},error:{message:i.viewPdfFailed,actionText:i.openButtonText}}},officeActionCreator:function(e){if(e.fileType===v.a.Pdf&&void 0!==e.webUrl)return B.a.createLaunchUrlAction(e.webUrl,"_blank",{referral:Object(q.a)(e.fileType),referralPlatform:n?"Native":"Web"})}}};c.push(u.actionDefinition);var l={error:{message:i.convertToPdfFailed,actionText:i.closeButtonText},loading:{showLoadingIndicator:!0,loadingText:i.convertingToPdf},success:{message:i.convertedToPdfSuccess,actionText:i.openButtonText}};return c.push({intent:d.b.ContentEdit,entities:[{type:d.a.Content}],metadata:{appId:e,groupId:s.a.MosApp,name:o.convertToPdfActionTitle,description:o.convertToPdfActionTitle,id:W.b.ConvertToPdf,icon:{type:a.a.Svg,iconName:"PdfWorksSvgIcon"},notificationOptions:l},officeActionCreator:function(e){var t,n;if(("Consumer"===r&&"Consumer"===(null===(n=null===(t=e.actionInfo)||void 0===t?void 0:t.odspShareInfo)||void 0===n?void 0:n.type)||"Enterprise"===r&&(e.isOneDriveForBusinessFile||e.isSharePointFile))&&e.driveId&&e.docId&&e.fileName&&e.fileType&&(e.fileType===v.a.Word||e.fileType===v.a.Excel||e.fileType===v.a.PowerPoint)){var o=e.isSharePointFile,i=e.sharepointIds;if(!o||i)return B.a.createConvertDriveItemAction(e.driveId,e.docId,e.fileName,e.extension,"pdf",o?i:void 0,e.isRedeemed,e.webUrl,{content:e,nextAction:u.nextAction,notificationOptions:l})}}}),c}}(W.a,n,x,U);X&&X.length&&Q.push.apply(Q,Object(r.__spreadArray)([],Object(r.__read)(X),!1))}Q.push({intent:d.b.ContentView,entities:[{type:d.a.Content}],metadata:{appId:o,groupId:s.a.None,name:f,description:f,id:W.b.ManageAccess,icon:{type:a.a.ActionContextMenuIcon,iconName:"SettingsIcon"}},officeActionCreator:function(e,n,r){var o,i;if(null===(i=null===(o=e.actionInfo)||void 0===o?void 0:o.odspShareInfo)||void 0===i?void 0:i.isManageAccessEnabless,n,void 0,void 0,r,T)}}),e.registerResolvedActions(Q),Object(z.f)(t,Q)}(e=function(){var e=new l.a,t=new Map,n=function(e,t){runction(e){var r=n(e.metadata.appId,e.metadata.id);t.set(r,e)};return Object.assign(e,{getActionByAppId:function(e,r){ion(){return Object(r.__spreadArray)([],Object(r.__read)(t.values()),!1).filter((function(e){return e.entities.some((function(e){return e.type===d.a.Content}))}))},createDefaultDocumentActions:function(e){return function(e,t,n,s,a,c,u){var l=Object(o.a)(),d=s.openInBrowserActionTitleSentence,v=s.openInDesktopActionTitleSentence,b=s.shareActionTitle,N=s.copyLinkActionTitle,A=s.downloadActionTitle,P=s.openFileLocationActionTitleSentence,x=s.openInAppActionTitle,D=[],L=function(e){var t=this;return function(){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return e.webUrl?(t=e.isEmailAttachment?"OpenAttachment":"OpenFile",[4,Object(T.a)(e.webUrl,{action:t})]):[2];case 1:return n.sent(),[2]}}))}))}}(e);L&&D.push({title:d,ariaLabel:d,id:"".concat(h.a.openInBrowser).concat(e.app),extension:e.extension,executeAction:L});var M=function(e){var t=this;if(e.fileType&&!e.isEmailAttachment&&e.canonicalUrl){var n=Object(I.a)(e.fileType);if(n){var o=e.canonicalUrl,i=o.lastIndexOf("?");return i>0&&(o=o.substring(0,i)),function(){return Object(r.__awaiter)(t,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Object(T.a)("".concat(n).concat(o),{action:"OpenInApp",linkTarget:"_self"})];case 1:return e.sent(),[2]}}))}))}}}}(e);if(M){var R=l?Object(m.a)(x,e.app):v;D.push({title:R,ariaLabel:R,id:"".concat(h.a.openInApp).concat(e.app),extension:e.extension,executeAction:M})}var B=F(e,t,a,c,n,u);B&&D.push({title:b,icon:f.a.Share,iconCssClass:"ms-fcl-nd",ariaLabel:b,id:h.a.share,executeAction:B});var U=F(e,t,a,c,n,u,p.a.CopyLink);if(U&&D.push({title:N,icon:f.a.Link,ariaLabel:N,id:h.a.copyLink,executeAction:U}),"Edge"!==Object(i.a)().browser.browserType){var W=function(e,t){var n=this;if(y(e)&&e.downloadUrl&&t){var o=e.downloadUrl;return function(){return Object(r.__awaiter)(n,void 0,void 0,(function(){var n,i,s,a,c,u,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(n="Download",!e.driveId||!e.docId)return[3,5];i=e.driveId,s=e.docId,r.label=1;case 1:return r.trys.push([1,4,,5]),[4,Object(g.a)()];case 2:if(!(a=r.sent()))throw new Error("Invalid sharedContext");return[4,Object(w.a)({driveId:i,itemId:s,graphXhrOptions:{correlationId:t.correlationId,getAccessToken:t.getAccessToken,jwtAuthEnabled:t.jwtAuthEnabled,officeApiRoot:t.officeHomeApiRoot,graphApiRoot:a.graphApiRoot},queryParams:{select:["id","content.downloadUrl"].join(",")}})];case 3:if(!(c=r.sent())["@microsoft.graph.downloadUrl"])throw new Error("Missing downloadUrl");return o=Object(k.a)(c["@microsoft.graph.downloadUrl"],["tempAuth","ApiVersion"]),[3,5];case 4:return u=r.sent(),Object(C.a)(O.a.GetDownloadUrlError,((l={}).Error=(null==u?void 0:u.toString())||"",l)),Object(S.a)({eventName:"Get_DownloadUrl_Error",message:(null==u?void 0:u.toString())||""}),[3,5];case 5:return[4,Object(T.a)(o,{action:n})];case 6:return r.sent(),[2]}}))}))}}}(e,a);W&&D.push({title:A,icon:f.a.Download,ariaLabel:A,id:h.a.download,executeAction:W})}var q=function(e){var t=this;if(function(e){return!(!e.fileType||e.isEmailAttachment||E.has(e.fileType))}(e)){var n=_(e);if(n)return function(){return Object(r.__awaiter)(t,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return e.isLocalFile?[4,Object(j.a)(n)]:[3,2];case 1:return t.sent(),[3,4];case 2:return[4,Object(T.a)(n,{action:"OpenFileLocation"})];case 3:t.sent(),t.label=4;case 4:return[2]}}))}))}}}(e);return q&&D.push({title:P,icon:f.a.OpenFile,ariaLabel:P,id:h.a.openFileLocation,executeAction:q}),D}(e.document,e.index,e.targetElementId,e.menuResources,e.componentContext,e.identity,e.isDarkMode)},registerActions:function(t){var n,o,i=function(e){var t=e.metadata,n=Object(r.__rest)(e,["executionInfo","metadata"]),o=Object(r.__assign)(Object(r.__assign)({},n),{metadata:Object(r.__assign)(Object(r.__assign)({},t),{icon:t.imageSrc?{type:a.a.Url,iconUrl:t.imageSrc}:void 0}),officeActionCreator:function(t){ret o=void 0;if(r&&(o=JSON.stringify(function(e){return{documentId:e.docId,driveId:e.driveId,fileName:e.fileName,fileType:e.fileType,objectUrl:e.webUrl,url:e.url}}(e))),function(e){return void 0!==e.target}(n))return B.a.createNavigateToAppExternal(n.appId,n.entityId,n.target,o,U(t,e));if(function(e){return void 0!==e.appId}(n))return B.a.createNavigateToApp(n.appId,n.entityId,o,U(t,e));break;case d.c.OpenExternal:if(function(e){return void 0!==e.url}(n))return B.a.createLaunchUrlAction(n.urlit:case d.c.InContextUx:if(function(e){return void 0!==e.url}(n))return B.a.createLaunchUrlAction(n.url,"_blank",U(t,e));if(function(e){return void 0!==e.appId}(n))return B.a.createLaunchAppInContextAction(n.appId,n.entityId,o,U(t,e))}}(t,e)}});s(o)};try{for(var c=Object(r.__values)(t),u=c.next();!u.done;u=c.next())i(u.value)}catch(e){n={error:e}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}e.emit(l.b.ActionsUpdated)},registerResolvedActions:function(t){var n,o;try{for(var i=Object(r.__values)(t),a=i.next();!a.done;a=i.next())s(a.value)}catch(e){n={error:e}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}e.emit(l.b.ActionsUpdated)}})}(),u,{actionsInContextDialogResources:t,documentActionsMenuResources:n,documentActionsToastResources:c}),e}}(),$=function(e){var t=e.actionsGates,n=e.capabilities,r=e.componentContext,s=e.userEntitlements,a=e.userDriveId;return{calendarEnabled:s.HasCalendar,companyDisplayName:s.CompanyDisplayName||"",deviceInfo:{isPlatformMobileOrTablet:Object(o.a)(),isHwa:r.workload===c.a.Hwa,isEmbed:r.workload===c.a.Embed,browserType:Object(i.a)().browser.browserType},exchangeEnabled:s.HasExchange,featureGates:t,oneDriveEnabled:s.HasOneDrive,userDriveId:a,userType:n.isConsumerUser?"Consumer":"Enterprise",isGovernment:s.IsGovernment}},Q=function(e){var t,n,r,o,i,s,a,c,u,l,d,h,f,p,m,g,v,b,y;return{actionActivityEnabled:(null===(t=e.actionActivityGates)||void 0===t?void 0:t.actionActivityEnabled)||!1,addToDoEnabled:(null===(n=null==e?void 0:e.addToDoGates)||void 0===n?void 0:n.addToDoEnabled)||!1,contentActionsEnabled:(null===(r=null==e?void 0:e.contentActionsGates)||void 0===r?void 0:r.contentActionsEnabled)||!1,contextMenu20Enabled:(null===(o=null==e?void 0:e.contextMenu20Gates)||void 0===o?void 0:o.contextMenu20Enabled)||!1,compliantShareApiEnabled:(null===(i=null==e?void 0:e.compliantShareApiGates)||void 0===i?void 0:i.compliantShareApiEnabled)||!1,convertToPdfEnabled:(null===(s=null==e?void 0:e.convertToPdfGates)||void 0===s?void 0:s.convertToPdfEnabled)||!1,createSharingLinkApiEnabled:(null===(a=null==e?void 0:e.createSharingLinkApiGates)||void 0===a?void 0:a.createSharingLinkApiEnabled)||!1,downloadActionEnabled:(null===(c=null==e?void 0:e.downloadActionGates)||void 0===c?void 0:c.downloadActionEnabled)||!1,deleteActionEnabled:(null===(u=null==e?void 0:e.deleteActionGates)||void 0===u?void 0:u.deleteActionEnabled)||!1,linksEnabled:(null===(l=null==e?void 0:e.edgeworthConfigGates)||void 0===l?void 0:l.edgeworthConfigLinksEnabled)||!1,mosContentActionEnabled:(null===(d=null==e?void 0:e.mosContentActionGates)||void 0===d?void 0:d.mosContentActionEnabled)||!1,graphApiForV2ConsumerEnabled:(null===(h=e.graphApiForV2ConsumerGates)||void 0===h?void 0:h.graphApiForV2ConsumerEnabled)||!1,odspCopyLinkEnabled:(null===(f=e.odspCopyLinkGates)||void 0===f?void 0:f.odspCopyLinkEnabled)||!1,odspShareLinkEnabled:(null===(p=e.odspShareLinkGates)||void 0===p?void 0:p.odspShareLinkEnabled)||!1,scheduleEnabled:(null===(m=null==e?void 0:e.scheduleGates)||void 0===m?void 0:m.scheduleEnabled)||!1,shareToTeamsEnabled:(null===(g=null==e?void 0:e.shareToTeamsGates)||void 0===g?void 0:g.shareToTeamsEnabled)||!1,shareTokenClaimsEnabled:(null===(v=null==e?void 0:e.shareTokenClaimsGates)||void 0===v?void 0:v.shareTokenClaimsEnabled)||!1,shareFluentDialogEnabled:(null===(b=null==e?void 0:e.shareFluentDialogGates)||void 0===b?void 0:b.shareFluentDialogEnabled)||!1,testAppActionEnabled:(null===(y=null==e?void 0:e.testAppActionGates)||void 0===y?void 0:y.testAppActionEnabled)||!1}},J=function(e,t,n,o,i){var s=V(e,t,n,o);if(s){var a=Object(u.a)(Object(r.__assign)(Object(r.__assign)({},i),{actionManager:s}));if(a)return{actionManager:s,actionExecutor:a}}},X=function(e){var t;return(t={})[s.a.AddTo]={ariaLabel:e.documentActionsMenuResources.addToMenuTitle,icon:{type:a.a.ActionContextMenuIcon,iconName:"AddIcon"},id:s.a.AddTo,title:e.documentActionsMenuResources.addToMenuTitle},t[s.a.Share]={ariaLabel:e.documentActionsMenuResources.shareActionTitle,icon:{type:a.a.ActionContextMenuIcon,iconName:"ShareIcon"},id:s.a.Share,title:e.documentActionsMenuResources.shareActionTitle},t}},jwpY:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("QjXU"),o=n("kb6k"),i=n("lAHu");function s(e,t,n,s,a,c,u,l,d,h,f,p,m){void 0===f&&(f={});var g="cache-only"===p;g&&(h="None");var v=Object(r.__assign)(Object(r.__assign)({},a),{url:n,method:"POST",body:s});return Object(o.a)((function(n){return Object(i.a)(e,t,n,l,d,p,f.populateRequestEvent,f.onUploadProgress,f.onDownloadProgress,f.cancellationToken,f.timeoutInMs)}),e,t,v,c,u,h,f.moop.microsoft.com/fluid/stg";case"Dogfood":return"https://ch5.fluidpreview.office.net/fluid/df";default:return"https://ch5.fluidpreview.office.net/fluid/prod"}}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}))},k9HR:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));const r=e=>"object"==typeof e&&"string"==typeof(null==e?void 0:e.name)&&"object"==typeof(null==e?void 0:e.fluid),o=e=>{const t=e;return"object"==typeof t&&("string"==typeof(null==t?void 0:t.package)||r(null==t?void 0:t.package))&&(void 0===(null==t?void 0:t.config)||"object"==typeof(null==t?void 0:t.config))}},kAGr:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("QjXU"),o=n("yoRs"),i=n("ob/S"),s=n("/LVV"),a=n("FtiY"),c=n("FPnS"),u=[],l=new Map;function d(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=function(e){return"M".concat(e.mode,"L").concat(h(e.lightBrandColors),"D").concat(h(e.darkBrandColors))}(e),(n=function(e){var t=l.get(e);if(t){var n=u.indexOf(e);u.splice(n,1),u.push(e)}return t}(t))?[2,n]:[4,f(e)];case 1:return o=r.sent(),function(e,t){if(!l.has(e)&&(u.push(e),l.set(e,t),u.length>10)){var n=u.shift();n&&l.delete(n)}}(t,o),[2,o]}}))}))}function h(e){return e?e.themeDark+e.themeDarkAlt+e.themeDarker+e.themeLight+e.themeLight+e.themeLighter+e.themeLighterAlt+e.themePrimary+e.themeSecondary+e.themeTertiary:""}function f(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,u,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:switch(u=function(e){if(e.lightBrandColors){if(!e.darkBrandColors){if(e.mode===c.a.dark)return;return{10:e.lightBrandColors.themeDarker,20:e.lightBrandColors.themeDarker,30:e.lightBrandColors.themeDarker,40:e.lightBrandColors.themeDarker,50:e.lightBrandColors.themeDarker,60:e.lightBrandColors.themeDark,70:e.lightBrandColors.themeDarkAlt,80:e.lightBrandColors.themePrimary,90:e.lightBrandColors.themeSecondary,100:e.lightBrandColors.themeSecondary,110:e.lightBrandColors.themeTertiary,120:e.lightBrandColors.themeTertiary,130:e.lightBrandColors.themeTertiary,140:e.lightBrandColors.themeTertiary,150:e.lightBrandColors.themeLight,160:e.lightBrandColors.themeLighter}}return{10:e.darkBrandColors.themeLighter,20:e.darkBrandColors.themeLight,30:e.lightBrandColors.themeDarker,40:e.darkBrandColors.themeTertiary,50:e.lightBrandColors.themeDark,60:e.lightBrandColors.themeDarkAlt,70:e.overridePaletteMapping?e.lightBrandColors.themeSecondary:e.darkBrandColors.themeSecondary,80:e.lightBrandColors.themePrimary,90:e.overridePaletteMapping?e.darkBrandColors.themeSecondary:e.lightBrandColors.themeSecondary,100:e.darkBrandColors.themePrimary,110:e.darkBrandColors.themeDarkAlt,120:e.darkBrandColors.themeDark,130:e.lightBrandColors.themeTertiary,140:e.darkBrandColors.themeDarker,150:e.lightBrandColors.themeLight,160:e.lightBrandColors.themeLighter}}}(e),e.mode){case c.a.dark:return[3,1];case c.a.highContrast:return[3,2]}return[3,4];case 1:return t=u?Object(o.a)(u):i.a,[3,5];case 2:return[4,n.e(994).then(n.bind(null,"mTTy"))];case 3:return l=r.sent().createHighContrastTheme,t=l(),[3,5];case 4:return t=u?Object(s.a)(u):a.a,[3,5];case 5:return[2,p(t,u,e)]}}))}))}function p(e,t,n){if(!n.overrideTokenMapping||!t)return e;if("harmony"===n.themeId){switch(e.colorBrandBackgroundInvertedPressed=t[130],e.colorBrandForegroundOnLightPressed=t[40],n.mode){case c.a.dark:e.colorBrandBackground2=t[20],e.colorBrandBackgroundHover=t[100],e.colorBrandForeground2=t[120],e.colorBrandForegroundInverted=t[100],e.colorBrandForegroundInvertedPressed=t[40],e.colorBrandForegroundLinkHover=t[120],e.colorBrandForegroundLinkSelected=t[110],e.colorBrandForegroundOnLight=t[100],e.colorCompoundBrandBackgroundHover=t[120],e.colorCompoundBrandForeground1Hover=t[120],e.colorCompoundBrandStrokeHover=t[120];break;case c.a.default:e.colorBrandForegroundInvertedPressed=t[90],e.colorBrandStroke2=t[140],e.colorCompoundBrandBackgroundPressed=t[40],e.colorCompoundBrandStrokePressed=t[40]}return e}switch(n.mode){case c.a.dark:e.colorBrandForegroundOnLightHover=t[60],e.colorBrandForegroundOnLightPressed=t[30],e.colorBrandForegroundOnLightSelected=t[50],e.colorBrandBackground=t[60],e.colorBrandBackgroundPressed=t[30],e.colorBrandBackgroundSelected=t[50],e.colorBrandBackground2=t[30];break;case c.a.default:e.colorNeutralForeground2BrandPressed=t[60],e.colorNeutralForeground3BrandPressed=t[60],e.colorBrandForegroundLink=t[60],e.colorBrandForegroundLinkHover=t[50],e.colorBrandForegroundLinkPressed=t[30],e.colorBrandForegroundLinkSelected=t[60],e.colorCompoundBrandForeground1Hover=t[60],e.colorCompoundBrandForeground1Pressed=t[50],e.colorBrandForeground2=t[60],e.colorBrandForegroundOnLightHover=t[60],e.colorBrandForegroundOnLightPressed=t[30],e.colorBrandForegroundOnLightSelected=t[50],e.colorBrandBackgroundHover=t[60],e.colorBrandBackgroundPressed=t[30],e.colorBrandBackgroundSelected=t[50],e.colorCompoundBrandBackgroundHover=t[60],e.colorCompoundBrandBackgroundPressed=t[50],e.colorCompoundBrandStrokeHover=t[60],e.colorCompoundBrandStrokePressed=t[50]}return e}},kAXT:function(e,t,n){"use strict";var r,o,i,s;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),function(e){e[e.Share=1]="Share",e[e.CopyLink=2]="CopyLink",e[e[e.invalidWebAbsoluteUrl=4]="invalidWebAbsoluteUrl",e[e.generic=5]="generic",e[e.objectNotSupported=6]="objectNotSupported",e[e.invalidEmail=7]="invalidEmail"}(o||(o={})),function(e){e[e.share=0]="share",e[e.copy=1]="copy",e[e.outlook=2]="outlook",e[e.nonOutlook=3]="nonOutlook",e[e.moreApps=4]="moreApps",e[e.teams=5]="teastanceof r){var s=n.__data__;if(!o||s.length<199)rn.set(e,t/o)+"h":t>=r?Math.round(e/r)+"m":t>=n?Math.round(e/n)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},kNhz:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var r=n("QjXU"),o=n("5Q+G"),i=n("MwDM"),s=n("p0jh"),a=n("LlSO");class c{constructor(e){a.a.assign(c,this,e)}static getTypeName(){return"AugLoop_HarmonyCopilot_HarmonyFirstDraftSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return a.a.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{constructor(e){a.a.assign(u,this,e)}static getTypeName(){return"AugLoop_HarmonyCopilot_HarmonyFirstDraftInitialAskSignal"}static getBaseTypes(){return["AugLoop_HarmonyCopilot_HarmonyFirstDraftSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return a.a.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class l{constructor(e){a.a.assign(l,this,e)}static getTypeName(){return"AugLoop_HarmonyCopilot_HarmonyFirstDraftRefinerAskSignal"}static getBaseTypes(){return["AugLoop_HarmonyCopilot_HarmonyFirstDraftSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return a.a.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class d{constructor(e){a.a.assign(d,this,e)}static getTypeName(){return"AugLoop_HarmonyCopilot_HarmonyFirstDraftCreateDocumentSignal"}static getBaseTypes(){return["AugLoop_HarmonyCopilot_HarmonyFirstDraftSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return a.a.matchesTypesFor(e,[d.getTypeName()])}}d.H_={Tilot_HarmonyCopilotInputSignal"}static getBaseTypes(){return["AugLoop_Copilot_CopilotInputSignal","AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return a.a.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class f{constructor(e){a.a.assign(f,this,e)}static getTypeName(){return"AugLoop_HarmonyCopilot_HarmonyCopilotProgramResponseSignal"}static getBaseTypes(){return["AugLoop_Copilot_CopilotProgramResponseSignal","AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return a.a.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};var p=n("NrNW"),m=n("CU8J"),g=n("+4M4"),v=n("t6yz"),b=n("mXGw"),y=n("Ttqn"),w=n("Dn7E"),C=n("b8Ug"),O=["session","firstdraft"];function T(e){var t=e.session,n=e.typeName,o=e.logger,s=e.correlationId,a=e.timeoutInMs,c=void 0===a?6e4:a;return Object(r.__awaiter)(this,void 0,void 0,(function()t.activateAnnotation(n,{callback:function(e){var t,c;if(function(e,t){if(e.length<t.length)return!1;for(var n=0;n<t.length;n++)if(e[n]!==t[n])return!1;return!0}(e.parentPath,O))try{for(var u=Object(r.__values)(e.items),l=u.next();!l.done;l=u.next()){var d=l.value,h=Math.min(2,e.parentPath.length-1),f=e.parentPath[h],p=a.get(f);if(null==p?void 0:p.callback){var m=d.body,g=m.status!==i.a.Success;Object(w.a)({area:"FirstDraft",eventName:"FirstDraftResponse",featureName:"FirstDraft",params:{State:g?"Failed":"Success",Error:i.a[m.status],Message:n}}),null==o||o.log({item:d,Message:i.a[m.status],SessionId:s}),p.callback({response:m,error:g,errorType:m.status}),a.delete(f)}}}catch(e){t={error:e}}finally{try{l&&!l.done&&(c=u.return)&&c.call(u)}finally{if(t)throw t.error}}}})];case 1:return u=l.sent().token,[2,{registerCallbac(e++),o=setTimeout((function(){a.has(r)&&(t({error:!0,errorType:v.c.ClientTimeout}),a.delete(r))}),c);return a.set(r,{callback:function(e){clearTimeout(o),t(e)}}),r},close:function(){t.releaseAnnotation(u)}}]}}))}))}function S(){var e,t,n,i,a,c,h,f,v,w=this,S=Object(g.a)().data,k=Object(m.a)().data,E=Object(p.a)().data,_=null!==(n=null===(t=null===(e=null==S?void 0:S.result)||void 0===e?void 0:e.firstDraft)||void 0===t?void 0:t.environment)&&void 0!==n?n:"Dogfood",j=null==S?void 0:S.result.firstDraft,I=null!==(i=null==j?void 0:j.documentTypePromptId)&&void 0!==i?i:"",N=null!==(a=null==j?void 0:j.initialContentPromptId)&&void 0!==a?a:"",A=null!==(c=null==j?void 0:j.refinerAskPromptId)&&void 0!==c?c:"",P=null!==(h=null==j?void 0:j.createDocumstDraftGates)||void 0===f?void 0:f.firstDraftRawResponseEnabled)&&void 0!==v&&v,D=function(e){return Object(b.useMemo)((function(){return Object(y.a)(e)}),[e])}(Object(b.useMemo)((function(){return{name:"copilot",area:"FirstDraft"}}),[]));return Object(C.a)((function(e){return Object(r.__awaiter)(w,void 0,void 0,(function(){var t,n,i,a;return Object(r.__generator)(this,(function(c){switch(c.label){case 0:return t=null==E?void 0:E.correlationId,[4,T({session:e,typeName:s.d.getTypeName(),logger:D,correlationId:t})];case 1:return n=c.sent(),[4,T({session:e,typeName:s.b.getTypeName(),logger:D,correlationId:t})];case 2:return i=c.sent(),[4,T({session:e,typeName:s.c.getTypeName(),logger:D,correlationId:t})];case 3:return a=c.sent(),[2,{refineContent:function(n,s){var a,c=i.registerCallback(s),u=new o.b({parentPath:O,items:[{id:c,body:new l(Object(r.__assign)(Object(r.__assign)({},n),{promptSettings:{refinerAskPromptId:A},raw:x}))}]});D.log({item:null===(a=null==u?void 0:u.items[0])||void 0===a?void 0:a.body,SessionId:t}),e.submitOperation(u)},submitInitialIntent:function(s,a,c,l){var d,h=n.registerCallback((function(e){var t,n=e.response,o=e.error;if(!n||o)c({response:void 0,error:!0,errorType:e.errorType});else{var i=null!==(t=n.documentTypeRecommendations)&&void 0!==t?t:[],s=Object(r.__assign)(Object(r.__assign)({},n),{documentTypeRecommendations:i});c({response:s,error:o})}}));i.registerCallback(l,h);var f=new o.a({parentPath:O,items:[{id:h,body:new u({initialAsk:s,promptSettings:{documentTypePromptId:I,initialContentPromptId:N,licensedDocumentTypes:a},raw:x})}]});D.log({item:null===(d=null==f?void 0:f.items[0])||void 0===d?void 0:d.body,SessionId:t}),e.submitOperation(f)},createDocument:function(n,i){var s,c=a.registerCallback(i),u=new o.b({parentPath:O,items:[{id:c,body:new d(Object(r.__assign)(Object(r.__assign)({},n),{promptSettings:{createDocumentPromptId:P},raw:x}))}]});D.log({item:null===(s=null==u?void 0:u.items[0])||void 0===s?void 0:s.body,SessionId:t}),e.submitOperation(u)},close:function(){n.close(),i.close()}}]}}))}))}),(function(e){e.close()}),_)}},kPR3:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("CDuu"),o=n("gYHC");function i(){return Object(r.a)(o.a)}},kTxb:function(e,t,n){"use strict";function r(e,t,n){var r="data:".concat(e,";"),o=n?"charset=".concat(n,";"):"";return"".concat(r).concat(o,"base64,").concat(t)}n.d(t,"a",(function(){return r}))},kb6k:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("QjXU"),o=n("yOLj"),i=n("tyUq"),s=n("GMuP"),a=n("JYsJ"),c=n("amPu"),u=[0,11,22,33];function l(e,t,n,r){e&&(e.headers=Object(c.a)(t,e.headers,n),r&&r(e,t))}function d(e,t,n,c,d,h,f,p,m,g,v,b,y,w,C,O,T){return void 0===w&&(w=!1),new Promise((function(S,k){var E=f||"None",_="None"===E||"OfficeHome"===E&&!d,j=v||new Set;j.add(401);var I=function(e){var r=e.status,s=Number.NaN;!_&&j.has(r)?s=701:b&&b(r)&&(s=703),s!==Number.NaN&&(Object(o.a)(t,s,-1,"",w),Object(i.a)({eventName:n,fromCache:w,httpCode:s,latency:-1,error:""})),k({httpResponse:e})};if(p){var N=Object(a.a)(p);N&&(c.headers||(c.headers={}),c.headers["ohp-mock"]=N)}(_?Promise.resolve(void 0):h(E,!1,m,T,void 0,void 0,C,O)).then((function(a){if(!_){if(!a||!a.success){var d=a?a.error:"";return Object(o.a)(t,702,-1,"string"==typeof d?d:"",w),Object(i.a)({eventName:n,fromCache:w,httpCode:702,latency:-1,error:"string"==typeof d?d:""}),void k({httpResponse:{data:"CAP_Error"===d?d:null,status:702,headers:{},ok:!1,statusText:"Failed to fetch access token",fromCache:!1}})}l(c,a,g,y)}e(c).then(S,(function(t){if(!_&&j.has(t.status)){var n=function(e){var t,n,o=null===(n=Object.entries(e).find((function(e){return"www-authenticate"===Object(r.__read)(e,1)[0].toLowerCase()})))||void 0===n?void 0:n[1];if(null==o?void 0:o.includes("insufficient_claims")){var i=o.match(/claims=\"(\S+)\"/);if(i)return i[1];Object(s.a)({eventName:"Extract_ClaimsChallenge_Error",params:(t={},t.Error="Failed to extract insufficient claims value",t)})}return"id 0,void 0,n).then((function(n){n.success?(l(c,n,g,y),e(c).then(S,I)):I(t)}))}else b&&b(t.status)?function(t,n){var r=function(e,t){retueaders),o=function(){var e=Math.floor(1e3*Mathr;n.df(s){var a=e[i],c=void 0===a||s(a,i,e);if(!0!==c)throw new TypeError("option "+i+" must be "+c)}else if(!0!==n)throw Error("Unknown option "+i)}},validators:o}},"ki/R":function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return m}));var r=n("Hebw"),o=n("OSNm"),i=n("graM"),s=n("kxAM");const a="https://home.microsoftpersonalcontent.com";var c=n("Qr0m"),u=n("u79n"),l=n("OfNt");const d="-my",h="-admin",f=".sharnction m(e,t){const n=new URL(e);if([r.a,a].includes(n.origin.toLowerCase()))return"consumers";const o=n.hostname.toLowerCase(),i=function(e){return w().get(e)}(o);if(i)return i.guid?i.guid:(v(e,o,i.hostname,t),i.hostname);let s=o.substring(0,o.indexOf(".")),c=o.substring(s.length),u=!1;0===c.indexOf(f)?c=`.onmicrosoft.${c.substring(f.length)}`:0===c.indexOf(p)?c=`.onmicrosoft.${c.substring(p.length)}`:u=!0,s.endsWith(d)?s=s.substring(0,s.length-d.length):s.endsWith(h)&&(s=s.substring(0,s.length-h.length));const l=u?void 0:`${s}${c}`;return C(o,{hostname:l}),v(e,o,l,t),l}const g=new Set;function v(e,t,n,r){g.has(t)||(g.add(t),Object(u.a)((async()=>{let a;try{const r=`${Object(s.a)(e)}/_api/v2.0/drives`;let o;try{o=await Object(i.a)(r,{method:"GET",headers:{Authorization:"Bearer"},credentials:"omit"})}catch(e){a="Server did not respond"}if(o){const e=Object(c.a)(o.result.headers);e?C(t,{hostname:n,guid:e}):a=`ODSP did not return tenant id in headers. Response status code: ${o.result.status}`}}catch(e){a="Unexpected error"}finally{g.delete(t)}a&&r&&Object(o.b)(r,{eventName:"AadTenantNotFound",message:a})}),{ensureExecution:!1}))}let b;const y="FluidSiteToAadTenantMapping";function w(){if(!b){let e;const t=Object(l.a)(),n=null==t?void 0:t.getItem(y);if(n)try{e=JSON.parse(n)}catch(e){null==t||t.removeItem(y)}b=new Map(e)}return b}function C(e,t){w().set(e,t),function(){O||(O=!0,Object(u.a)((()=>{var e;b&&(null===(e=Object(l.a)())||void 0===e||e.setItem(y,JSON.stringify(Array.from(b.entries())))),O=!1}),{ensureExecution:!0}))}()}let O=!1},kwav:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("6ib3"),o=new Map([["ShellWordOnline",r.a.Word],["ShellExcelOnline",r.a.Excel],["ShellPowerPointOnline",r.a.PowerPoint],["ShellOneNoteOnline",r.a.OneNote],["ShellClassNotebook",r.a.OneNoteClassNoteBook],["ShellVisioOnline",r.a.Visio],["ShellSway",r.a.Sway],["ShellOfficeForms",r.a.Forms],["ShellDocuments",r.a.OneDrive],["ShellSites",r.a.SharePointtream],["ShellLists",r.a.List],["Shoject",r.a.Project],["ShellClipchamp",r.a.Clipchamp]]);function i(e){return o.get(e)}},kxAM:function(e,t,n){"use strict";function r(e){return new URL(e).origin}n.d(t,"a",(function(){return r}))},"l+H3":function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n("faO/"),o=n("RV7E"),i=n("a3FV"),s=n("lUkk"),a=n("mXGw"),c=n("ZrMS"),u=n("CU8J"),l=n("3+RV"),d=n("B7gc"),h=function(){var e=function(){var e=Object(c.a)(),t=function(){var e=Object(u.a)().data;return Object(a.useMemo)((function(){var t,n;return(null===(n=nu.result)||void 0===t?void 0:t.storageErrorGates)||void 0===n?void 0:n.storageErrurn e&&t}),[e,t])}(),t=Object(l.a)(),n=Object(d.a)(r.a.WelcomeBadge),h=Object(a.useMemo)((function(){return{category:"CreateFile",error:"UserStorageQuotaFull"}}),[]),f=Object(a.useMemo)((function(){return["useMemo)((function(){var e=Object.assign({},h);return n&&n.showDime&&n.onClick&&(e=Object.assign(e,{onActionClicked:function(){return n.onClick("StorageQuota")}})),t&&t.link&&(e=Object.assign(e,{fallbackSiteUrl:t.link})),e}),[h,t,n]),m=Object(a.useCallback)((function(e){var n=e.workloadId,r=e.area,a=e.subArea,c=e.isTemplate;t&&t.link&&n&&(Object(s.a)({eventName:c?i.a.TemplateClick:i.a.CreateLinkClick,id:n,area:r,subArea:a,result:"Navigate",target:"Other"}),Object(s.a)({eventName:i.a.ShowStorageErrorDialog,id:n,area:r,subArea:"Other"}),Object(o.c)(p))}),[p,t]),g=Object(a.useCallback)((function(t){return!!t&&e&&f.indexOf(t)>=0}),[e,f]);return Object(a.useMemo)((function(){return[m,g]}),[g,m])}},"l/ot":function(e,t,n){"use strict";n.d(t,"a",(function(){return L}));var r,o,i=n("gzKm"),s=n("duEa"),a=n("jJrO"),c=n("OeRt"),u=n("XxaS"),l=n("pUzp"),d=n("XrJr"),h=n("+9uq"),f=n("U4Iz"),p=n("PmtM"),m=n("YGV3"),g=n("iTb/"),v=n("cipv"),b=n("85o7"),y=n("jH7j"),w=n("mXGw"),C=n.n(w),O=n("p/uK"),T=n("DG+G"),S=Object(O.a)({regularIcon:(r={},r["& .".concat(T.a)]={display:"none"},r["& .".concat(T.b)]={display:"inline"},r),filledIcon:(o={},o["& .".concat(T.a)]={display:"inline"},o["& .".concat(T.b)]={display:"none"},o)}),k=function(e){var t=e.filledIcon,n=e.regularIcon,r=e.fluentIconProps,o=S(),s=Object(i.a)(t,n);return C.a.createElement("span",{clasent(s,{filled:r.filled,primaryFill:r.primaryFill,title:r.title}))},E=function(e,t,n){return C.a.createElement(k,{filledIcon:e,regularIcon:t,fluentIconProps:n})},_={AddIcon:function(e){return E(s.b,s.c,e)},AppsAddInIcon:function(e){return E(s.t,s.u,e)},CalendarIcon:function(e){return E(a.c,a.d,e)},CheckmarkCircleIcon:function(e){return E(c.h,c.i,e)},CheckmarkIcon:function(e){return E(c.d,c.e,e)},ChevronLeftIcon:function(e){return E(c.r,c.s,e)},ChevronRightIcon:function(e){return E(c.y,c.z,e)},CopyIcon:function(e){return E(u.g,u.h,e)},DeleteIcon:function(e){return E(u.m,u.n,e)},DismissIcon:function(e){return E(u.w,u.x,e)},DocumentIcon:function(e){return E(u.E,u.F,e)},DocumentPdfIcon:function(e){return E(l.c,l.d,e)},DownloadIcon:function(e){return E(s.D,s.E,e)},EditIcon:function(e){return E(l.f,l.g,e)},FolderIcon:function(e){return E(d.d,d.e,e)},HideIcon:function(e){return E(l.l,l.m,e)},LinkIcon:function(e){return E(h.r,h.s,e)},LockClosedIcon:function(e){return E(h.x,h.y,e)},MailIcon:function(e){return E(h.z,h.A,e)},MoreIcon:function(e){return E(f.j,f.k,e)},MoveFolderIcon:function(e){return E(d.h,d.i,e)},MoveIcon:function(e){return E(s.M,s.N,e)},OpenIcon:function(e){return E(f.w,f.x,e)},PeopleIcon:function(e){return E(p.a,p.b,e)},PinIcon:function(e){return E(p.u,p.v,e)},RestoreIcon:function(e){return E(s.H,s.I,e)},SaveIcon:function(e){return E(m.X,m.Y,e)},SearchIcon:function(e){return E(m.ab,m.bb,e)},SettingsIcon:function(e){return E(m.cb,m.db,e)},ShareIcon:function(e){return E(g.b,g.c,e)},StarIcon:function(e){return E(g.o,g.p,e)},StarOffIcon:function(e){returtion(e){return E(v.a,v.b,e)},UnpinIcon:function(e){return E(p.w,p.x,e)},UploadIcon:function(e){return E(b.k,b.l,e)},WarningIcon:function(e){return E(y.i,y.j,e)}},j=n("6ib3"),I=n("2X5l"),N=n("RtYo"),A=n("DU/N"),P=Object(O.a)({iconContainer:{alignItems:"center",display:"flex",width:"20px",height:"100%"},urlIconSize:{width:"20px",height:"20px"},icon:{backgroundColor:A.a.colorTransparentBackground,color:A.a.colorNeutralForeground2,":hover":{backgroundColor:A.a.colorTransparentBackground,color:A.a.colorNeutralForeground2BrandPressed}},disabledIcon:{backgroundColor:A.a.colorTransparentBackground,color:A.a.colorNeutralForegroundDisabled}}),x=function(e){var t=e.icon,n=e.className,r=e.isDisabled,o=P(),i=Object(w.useMemo)((function(){return _[t.iconName]({className:n,primaryFill:void 0})}),[n,t]);return C.a.createElement("span",{className:"".concat(o.iconContainer," ").concat(r?o.disabledIcon:o.icon)},i)},D=function(e){var t=e.iconUrl,n=P();return C.a.createElement("img",{className:n.urlIconSize,src:t,alt:"Action Context Menu Icon"})},L=function(e){return function(e){var t,n=e.icon,r=e.className,o=e.brandStyles,i=void 0===o?{size:"16"}:o,s=e.isDisabled,a=e.svgStyles,c=void 0===a?{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none"}:a;if(!n)return null;if(n.type===N.a.RenderIcon)return n.renderIcon();if(!r)return null;switch(n.type){case N.a.ActionContextMenuIcon:return C.a.createElement(x,{icon:n,className:r,isDisabled:s});case N.a.Brand:return null!==(t=function(e){var t=function(e){switch(e){case j.a.Word:return"word";case j.a.Excel:return"excel";case j.a.Visio:return"visio";case j.a.PowerPoint:return"powerpoint";case j.a.OneNote:return"onenote"}}(e.fileType);if(t){var n="".concat("https://static2.sharepointonline.com/files/fabric/assets/brand-icons/product/svg/").concat(t,"_").concat(e.size,"x1.svg");return C.a.createElement("img",{src:n,width:e.size,height:e.size,alt:"".concat(t," icon"),className:e.className,"aria-hidden":"true"})}}({size:i.size,fileType:n.fileType,className:"".concat(r," ").concat(i.className)}))&&void 0!==t?t:C.a.createElement(x,{icon:{iconName:"OpenIcon",type:N.a.ActionContextMenuIcon},className:r});case N.a.Svg:return I.a[n.iconName]({viewBoction e(t,n,l,d,h){t!==n&&i(n,(function(i,c){if(h||(h=new r),a(i))s(t,n,c,l,e,d,h);else{var f=d?d(u(t,c),i,c+"",t,n,h):void 0;void 0===f&&(f=i),o(t,c,f)}}),c)}},lAHu:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("c/bn"),o=n("JYsJ");function i(e,t,n,i,s,a,c,u,l,d,h){var f="".concat(i,"/");return n.url.startsWith("http")&&!f.startsWith("http")&&(f="".concat(window.location.origin,"/").concat(f)),0===n.url.lastIndexOf(f,0)&&function(e,t){e.headers||(e.headers={}),e.headers["X-OfficeHome-CorrelationId"]=t;var n=Object(o.a)("testtraffic");n&&(e.headers["X-OfficeHome-TestTraffic"]=n)}(n,s),Object(r.a)(e,t,n,a,c,u,l,d,h)}},lJoY:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("QjXU"),o=n("OoM2"),i=n.n(o),s=n("mXGw"),a=n("NrNW"),c=function(){var e=Object(a.a)().data,t=Object(r.__read)(Object(s.useState)(null==e?void 0:e.router.getCurrentObject(s.use=e?void 0:e.router.getRouteObservable(),n=null==t?void 0:t.sction(e,t,n){var r=n("f/Xo"),o=n("YaJL"),i=n("yoW1");e.exports=o?function(e,t){return o(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:i},lOFt:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("8/lW"),o=n("a3FV"),i=n("rTyw"),s=n("4CZh");function a(e,t,n,a,c,u,l,d){if(void 0===u&&(u={}),void 0===l&&(l=[]),void 0===d&&(d=r.a.Security),l=l||[],n&&t&&"Unknown"!==t&&l.push("".concat(e,".").concat(n,".").concat(t)),t&&(u.ElementId=t),a){var h=Object(i.a)(a);u.Referral=h,l.push("Referral.".concat(s=i.hasOwnProperty,a=i.propertyIsEnumerable,c=r(function(){return arguments}())?r:function(e){return o(e)&&s.call(e,"callee")&&!a.call(e,"callee")};e.exports=c},"lYt+":function(e,unction(){return a}));var r=n("QjXU"),o=n("elnK"),i=n.n(o),s=n("sYiP"),a=i()((function(e){return{actionCreators:{clearNotification:function(){e({toast:void 0})},createErrorNotification:function(t,n){e({toast:Object(s.a)(t,n)})},createLoadingNotification:function(t,n){e({toast:Object(s.b)(t,n)})},createSuccessNotification:function(t,n){reoid 0,void 0,(function(){return Object(r.__generator)(this,(function(r){return e({toast:Object(s.c)(t,n)}),[2]}))}))}},setToast:function(t){return e({toast:t})},toast:void 0}}))},lbnCect.p){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(r||(r={}))},lphy:function(e,t,n){(function(e,r){var o;!function(r){var i,s=2147483647,a=36,c=/^xn--/,u=/[^\x20-\x7E]/,l=/[\x2E\u3002\uFF0E\uFF61]/g,d={overflow:"Overflow: input nO+26?26:u-O));u+=a)c>h(s/(f=a-d))&&p("overflow"),c*=f;O=C(v-i,t=m.length+1,0==i),h(v/t)>s-w&&p("overflow"),w+=h(v/t),v%=t,m.splice(v++,0,w)}return b(m)}function T(e){var t,n,r,o,i,c,u,l,d,m,g,b,y,O,T,S=[];for(b=(e=v(e)).length,t=128,n=0,i=72,c=0;c<b;++c)(g=e[c])<128&&S.push(f(g));for(r=o=S.length,o&&S.push("-");r<b;){for(u=s,c=0;c<b;++c)(g=e[c])>=t&&g<u&&(u=g);for(u-t>h((s-n)/(y=r+1))&&p("overflow"),n+=(u-t)*y,t=u,c=0;c<b;++c)if((g=e[c])<t&&++n>s&&p("overflow"),g==t){for(l=n,d=a;!(l<(m=d<=i?1:d>=i+26?26:d-i));d+=a)S.push(f(w(m+(T=l-t}return Sn(e){return g(e,(function(e){return u.test(e)?"xn--"+T(e):e}))},toUnicode:function(e){return g(e,(function(e){return c.test(e)?O(e.slice(4).toLowerCase()):e}))}},void 0===(o=function(){return i}.call(t,n,t,e))||(e.exports=o)}()}).call(this,n("RoC8")(e),n("pCvA"))},luPg:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("QjXU"),o=n("a3FV"),i=n("kb6k"),s=n("lAHu");function a(e,t,n,o,a,c,u,l,d,h,f,p){void 0===f&&(f={});var m=Object(r.__assign)(Object(r.__assign)({},a),{url:n,method:"PATCH",body:o});return Object(i.a)((function(n){return Object(s.a)(e,t,n,l,d,void 0,f.populateRequestEvent,f.onUploadProgress,f.onDownloadProgress,f.cancellationToken,f.timeoutInMs)}),e,t,m,c,u,h,f.mockParam,f.resourceUrl,f.rpsHeaderPrefix,f.additionalAuthErrors,f.isRetriableError,f.updateRequestWithAuth,void 0,void 0,void 0,p)}var c=n("zPk6"),u=n("fNDz");function l(e){var t=e.driveId,n=e.itemId,i=e.graphXhrOptions,s=e.patchedItem,l=e.queryParams;return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,d;return Object(r.__generator)(this,(function(h){return e="drives/".concat(t,"/items/").concat(n),d=Object(u.a)(i.graphApiRoot,e,!1,l),[2,a(o.a.OneDriveGraphPatchItemRequest,"OneDrive_Graph_Patch_Item",d,s,{method:"PATCH",headers:{"Content-Type":"application/json"}},i.jwtAuthEnabled,i.getAccessToken,i.officeApiRoot,i.correlationId,"Graph",{populateRequestEvent:function(e,t){t.RequestId=Object(c.a)(e)||""}}).then((function(e){if(!e||!e.ok||void 0===e.data)throw new Error((null==e?void 0:e.statusText)||"Graph API error");return e.data})).catch((function(e){var t,n;throw Object(r.__assign)(Object(r.__assign)({},e),{clientError:null===(n=null===(t=e.httpResponse.data)||void 0===t?void 0:t.error)||void 0===n?void 0:n.code})}))]}))}))}},lw5l:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("QjXU"),o=n("a3FV"),i=n("Wa5Y"),s=n("zPk6"),a=n("fNDz");function c(e){var t=e.driveId,n=e.isContentRequest,c=e.itemId,u=e.graphXhrOptions,l=e.queryParams,d=e.contentResponseType,h=e.sharePointIds;return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,f,p;return Object(r.__generator)(this,(function(r){return t&&c?u?(e="drives/".concat(t,"/items/").concat(c),h&&(e="sites/".concat(h.siteId,"/drive/items/").concat(c)),n&&(e+="/content"),f=Object(a.a)(u.graphApiRoot,e,!1,l),p={method:"GET",responseType:d},[2,Object(i.a)(o.a.OneDriveGraphItemRequest,"OneDrive_Graph_Item",f,p,u.jwtAuthEnabled,u.getAccessToken,u.officeApiRoot,u.correlationId,"Graph",{populateRequestEvent:function(e,t){t.RequestId=Object(s.a)(e)||""}}).then((function(e){if(!e||!e.ok||void 0===e.data)throw new Error((null==e?void 0:e.statusText)||"Graph API error");return e.data}))]):[2,Promise.reject("Invalid graphXhrOptions")]:[2,Promise.reject("Invalid ids")]}))}))}},m118:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("QjXU"),o=n("28zg"),i=n("gYHC");function s(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return[2,Object(o.a)(i.a)]}))}))}},mJgL:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("QjXU"),o=n("MJsD"),i=n("B5kz"),s=n("W7wX"),a=n("yNE0");function c(){var e=this;return i.a.fetchQuery(["FeatureSettings"],(function(){return Object(r.__awaiter)(e,void 0,void 0,(function(){var e,t,n;return Object(r.__generator)(this,(function(i){switch(i.label){case 0:return[4,Promise.all([Object(o.a)(),Object(s.a)()])];case 1:return e=r.__read.apply(void 0,[i.sent(),2]),t=e[0],n=e[1],[2,Object(a.a)(n,t)]}}))}))}),{staleTime:1/0,cacheTime:1/0})}},mJu7:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("u9fO");function o(e,t,n){return n?Object(r.a)(e,"login_hint",t):e}},"maX/":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=0,o=function(){function e(e,t,n){void 0===n&&(n=""),this.componentContext=e,this.identity=t,this.hostScenarioName=n,this.bootId=r++}return Object.defineProperty(e.prototype,"HostContext",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"audience",{get:function(){var e;return(null===(e=new URL(window.location.href).searchParams.get("flight"))||void 0===e?void 0:e.includes("localbundles"))?"Local":function(e){switch(e){case"bfprod":case"tbprod":case"pfprod":case"prodprv":case"prod":return"Production";case"ppe":case"ppeprv":return"Staging";case"sdf":return"Dogfood";case"dev":case"developer":case"test":default:return"Local"}}(this.componentContext.deploymentEnvironment)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"environment",{get:function(){return function(e){switch(e){case"Automation":case"SyntheticTraffic":case"Local":return{audience:e,ring:"Prod"};default:return{audience:e}}}(this.audience)},enumerable:!1,configurable:!0}),Object.defice.com"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hostAppVersion",{get:function(){return"".concat(this.componentContext.buildVersion)},enumerable:!1,configurable:!0}),Object.defigurable:!0}),Object.defineProperty(e.prototype,"hostCorrelationId",{get:function(){return"".concat(this.componentContext.correlationId,".").urn this.bootId},Object.defineProperty(e.prototype,"hostSessionId",{get:function(){var e;return null!==(e=this.componentContext.correlationId)&&void 0!==e?e:""},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hostName",{get:function(){return"Office.com"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userContext",{get:function(){var e,t,n;return{user:{oid:null===(e=this.identity)||void 0===e?void 0:e.puid,tenantId:null!==(n=null===(t=this.identity)||void 0===t?void 0:t.tenantId)&&void 0!==n?n:""}}},enumerable:!1,configurable:!0}),e}()},mgFK:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("QjXU"),o=n("E7ar"),i=n("8wW2"),s=n("a3FV"),a=n("0TX8"),c=n("Wa5Y"),u=new Map;function l(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o,u,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t.disableLegacyNetworkConfigs?[2,void 0]:(n=new URL("".concat(t.officeHomeApiRoot,"/api/config/").concat(e),window.location.origin),o={},[4,Object(a.a)(o,t.inMockMode,t.workloation.search&&(u=new URLSearchParams(window.location.search),o.params||(o.params={}),t.inMockMode?u.forEach((function(e,t){void 0===o.params[t]&&(o.params[t]=e)})):u.has("scenarioid")&&(l=u.get("scenarioid"),o.params.scenarioid=null!=l?l:"")),[st,"Config",n.toString(),o,t.jwtAuthEnabled,t.getAccessToken,t.officeHomeApiRoot,t.correlationId,"OfficeHome",{populateRequestEvent:function(t,n){n.ElementId=e}}).then((function(e){return e.data})).catch((function(e){Object(i.a)().handleError(e)}))]}}))}))}function d(e,t){var n=this;if(u.has(e))return u.get(e);var i=new Promise((function(i){return Object(r.__awaiter)(n,void 0,void 0,(function(){var n,s,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:n=void 0,r.label=1;case 1:return r.trys.push([1,5,,6]),(s=window.shellAndConfigResponse)?[4,s]:[3,3];case 2:if((a=r.sent())&&a[e]){try{i(JSON.parse(a[e]))}catch(t){i(a[e])}return[2]}return[3,4];case 3:if(n=Object(o.a)(e))return i(n),[2];r.label=4;case 4:return[3,6];case 5:return r.sent(),[3,6];case 6:return[4,l(e,t)];case 7:return n=r.sent(),i(n),[2]}}))}))}));return u.set(e,i),i}},mpo9:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return h}));var r,o,i,s=n("E7ar"),a=n("8wW2"),c=!1;function u(){if(!c){c=!0;var e=void 0;try{e=Object(s.a)("userStoraga)().handleError(e)}r=e?e.content:{},o=!!e&&e.firstUse,i=e?e.firstUseTimestamp:0}}function l(){return u(),r}function d(){return u(),o}function h(){return u(),i}},ms7G:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return s}));var r=n("OfNt");function o(){return{package:{name:"@fluidx/catalog-container",version:"0.0.1",fluid:{browser:{umd:{files:[],library:""}}}}}}function i(){var e;return null===(e=Object(r.a)())||void 0===e?void 0:e.FluidCodeDetailsOverride}function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{package:{name:"@ms/office-fluid-container",version:"0.0.1",fluid:{browser:{umd:{files:["https://officefluiddev.blob.core.windows.net/staticcontent/versionless/container/codeLoader.js"],library:"codeLoader"}}}},config:e}}n("uAd/"),n("graM"),n("LpbE"),n("rwSX"),n("tSac"),n("k8nI"),n("zuGz"),n("6vom")},"n/4l":function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Prod="Prod",e.Dogfood="Dogfood",e.Staging="Staging",e.Development="Development",e.Gcc="Gcc",e.GccHigh="GccHigh",e.DoD="DoD",e.Local="Local"}(r||(r={}))},nCVa:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return s}));var r=n("Xou4");const o=e=>r.a.from(e,"base64").toString("utf-8"),i=e=>r.a.from(e,"utf8").toString("base64"),s=(e,t)=>{switch(t){case"utf8":case"utf-8":return e;default:return r.a.from(e,t).toString()}}},nLxx:function(e,t,n){"use strict";n.d(t,-"+o[e[t+10]]+o[e[t+11]]+o[e[t+12]]+o[e[t+13]]+o[e[t+14]]+o[e[t+15]]).toLowerCase();if(!Object(r.a)(n))throw TypeError("Stringified UUID is invalid");return n}},nX9G:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("QjXU"),o=n("MJsD"),i=n("yQST"),s=n("/Oio"),a=void 0;function c(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return a?[3,4]:[4,Object(o.a)()];case 1:return(e=t.sent()).workload===s.a.Hwa||Object(i.a)()?[4,Promise.all([n.e(50),n.e(650)]).then(n.bind(null,"N3Xl")).then((function(t){return{launchFile:t.getLaunchFileFunc(e),launchInDesktopApps:t.launchInDesktopApps,launchTemplate:t.launchTemplate,openFileInExplorer:t.openFileInExplorer}}))]:[3,3];case 2:return a=t.sent(),[3,4];case 3:a={launchFile:function(){return Promise.reject()},launchInDesktopApps:function(){return Promise4;case 4:return[2,a]}}))}))}},naAV||[]).length;return r.parensDepth>0?n[n.length-1]=n[n.length-1]+" "+t:n.push(t),r.parensDepth+=o-i,{list:n,state:r}}),{list:[],state:{parensDepth:0}}).list}function c(e[t[0],t[3],t[2],t[1]].join(" "=!1;r<e.length;)o||","!==e[r]?"("===e[r]?(o=!0,r++):")"===e[r]?(o=!1,r++):r++:(t.push(e.substring(n,r).trim()),n=++r);return n!=r&&t.push(e.substring(n,r+1)),t}(e.value).map((function(e){return e.replace(/(^|\s)(-*)([.|\d]+)/,(function(e,t,n,r){return"0"===r?e:t+(""===n?"-":"")+r}))})).join(",")},borderColor:function(e){return c(e.value)},borderRadius:function(e){var t=e.value;if(o(t))return t;if(i(t,"/")){var n=t.split("/"),r=n[1];return u.borderRadius({value:n[0].trim()})+" / "+u.borderRadreplace(a,u.backar t=e.value,n=e.valuesToConvert,r=e.bgImgDirectionRegex;return i(t,"url(")||i(t,"linear-gradient(")?t.replace(r,(function(e,t,r){rettion(e,t){return function(e){var t=e.indexOf(".");if(-1===t)er t=e.value,n=e.valuesToConvert,r=e.isRtl,i=e.bgPosDirectionRegex;return o(t)?t:u.backi})},transition:function(e){var t=e.propertiesToConvert;return e.value.split(/,\s*/g).map((function(e){var n=e.split(" ");return n[0]=t[n[0]]||n[0],n.join(" ")}(?:\\s*,\\s*"+r+"){0,2}\\s*\\))","gi"),c=new RegExp("(rotate[ZY]?\\s*\\(\\s*)"+r+"(\\s*\\))","gi");return t.replace(o,s).replace(i,s).replace(a,s).replace(c,s)}};u.objectPosition=u.backgroundPosition,u.margin=u.padding,u.borderWidth=u.padding,u.boxShadow=u.textShadow,u.webkitBoxShadow=u.boxShadow,u.mozBoxShadow=u.boxShadow,u.WebkitBoxShadow=u.boxShadow,u.MozBoxShadow=u.boxShadow,u.borderStyle=u.borderColor,u.webkitTransform=u.transform,u.mozTransform=u.transform,u.WebkitTransform=u.transform,u.MozTransform=u.transform,u.transformOrigin=u.backgroundPosition,u.webkitTransformOrigin=u.transformOrigin,u.mozTransformOrigin=u.transformOrigin,u.WebkitTransformOrigin=u.transformOrigin,u.MozTransformOrigin=u.transformOrigin,u.webkitTransition=u.transition,u.mozTransition=u.transition,u.WebkitTransition=u.transition,u.MozTransition=u.transition,u.webkitTransitionProperty=u.transitionProperty,u.mozTransitionProperty=u.transitionProperty,u.WebkitTransitionProperty=u.transitionProperty,u.MozTransitionProperty=u.transitionProperty,u["text-shadow"]=u.textShadow,u["border-color"]=u.borderColor,u["border-radius"]=u.borderRadius,u["background-image"]=u.backgroundImage,u["background-position"]=u.backgroundPosition,u["background-position-x"]=u.backgroundPositionX,u["object-position"]=u.objectPosition,u["border-width"]=u.padding,u["box-shadow"]=u.textShadow,u["-webkit-box-shadow"]=u.textShadow,u["-moz-box-shadow"]=u.textShadow,u["border-style"]=u.borderColor,u["-webkit-transform"]=u.transform,u["-moz-transform"]=u.transform,u["transform-origin"]=u.transformOrigin,u["-webkit-transform-origin"]=u.transformOrigin,u["-moz-transform-origin"]=u.transformOrigin,u["-webkit-transition"]=u.transition,u["-moz-transition"]=u.transition,u["transition-property"]=u.transitionProperty,u["-webkit-transition-property"]=u.transitionProperty,u["-moz-transition-property"]=u.transitionProperty;var l=r([["paddingLeft","paddingRight"],["marginLeft","marginRight"],["left","right"],["borderLeft","borderRight"],["borderLeftColor","borderRightColor"],["borderLeftStyle","borderRightStyle"],["borderLeftWidth","borderRightWidth"],["borderTopLeftRadius","borderTopRightRadius"],["borderBottomLeftRadius","borderBottomRightRadius"],["padding-left","padding-right"],["margin-left","margin-right"],["border-left","border-right"],["border-left-color","border-right-color"],["border-left-style","border-right-style"],["border-left-width","border-right-width"],["border-top-left-radius","border-top-right-radius"],["border-bottom-left-radius","border-bottom-right-radius"]]),d=["content"],h=r([["ltr","rtl"],["left","right"],["w-resize","e-resize"],["sw-resize","se-resize"],["nw-resize","ne-resize"]]),f=new RegExp("(^|\\W|_)((ltr)|(rtl)|(left)|(right))(\\W|_|$)","g"),p=new RegExp("(left)|(right)");function m(e){return Object.keys(e).reduce((function(t,n){var r=e[n];if(function(e){return"string"==typeof e}(r)&&[n]=r,t;var o=g(n,r);return t[o.key]=o.value,t}),Array.isArray(e)?[]:{})}function g(e,t){var n=/\/\*\s?@noflip\s?\*\//.test(t),r=n?e:function(e){return l[e,t){if(!function(e){return!function(e){return"boolean"==typeof e}(e)&&!function(e){return null==e}(e)}(t))return t;if(function(e){return e&&"object"==typeof e}(t))return m(t);var n,r=o(t),i=function(e){return"function"==typeof e}(t),s=r||i?t:t.replace(/ !important.*?$/,""),a=!r&&s.length!==t.length,c=u[e];return n=c?c({value:s,valuesToConvert:h,propertiesToConvert:l,ivar o="function"==typeof e?e(t):e;if(!Object.is(o,t)){var ,n.forEach((function(e){return e(t,i)}))}},o=function(State:o,subscribe:function(e){return n.add(e),function(){return n.delete(e)}},destroy:function(){n.clear()}};return t=e(r,o,i),i},o=function(e){return e?r(e):r};t.createStore=o,t.default=function(e){return o(e)},e.exports=t&&t.default||{},Object.assign(e.exports,t)},ntFm:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("8/lW"),o=n("a3FV"),i=n("4CZh");function s(e,t,n,s,a,c,u,l){return void 0===a&&(a=!1),void 0===c&&(c={}),void 0===u&&(u=[]),void 0===l&&(l=a.toString(),s&&(c.Error=s),Object(i.b)(e,o.a.GenericRequest,l,c,u)}},nxZd:function(e,t,n){var r=n("SyCk"),o=n("T9Ud");e.exports=function(e){return o(e)&&r(e)}},oRCi:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("Yk0T"),o=n("CuzD");function i(e,t,n){Object(r.a)(!1,e.capabilities.fluentIconFontEnabled,t.sharedContext.inMockMode?void 0:n.config.officeStartCdnDomain),Object(o.a)()}},oYCi:function(e,t,n){"use strict";e.exports=n("FIKz")},ohjr:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("QjXU"),o=n("iPRk"),i=n("Crror;return d?(o=d instanceof Error?d.message:d,function(e){Object(i.a)({eventName:"ValidateConfigEquality_Error",errorType:"NorthStarConfig_Error",message:e})}("Error occurred while validating config equality:\n\n".concat(o)),!1):!(l.length>0&&(function(e){Object(s.a)({featureName:"ConfigQueryWrapper",eventName:"ValidateConfigEquality",params:e},a.a.Security,!1)}({QueryKey:n,Mismatches:l.join(",")}),1))}function u(e,t,n){var o,i,s,a,c=[],l=function(e){var t,n,r=e.key,o=e.mismatchType,i=e.val1,s=e.val2,a="string"==typeof i&&"SubLvl"!==o?"StrLen:".concat(i.length.toString()):null!==(t=null==i?void 0:i.toString())&&void 0!==t?t:"undefined",u="string"==typeof s&&"SubLvl"!==o?"StrLen:".concat(s.length.toString()):null!==(n=null==s?void 0:s.toString())&&void 0!==n?n:"undefined",l="".concat(r,":[").concat(o,"(").concat(a);void 0!==s&&(l+="|".concat(u)),c.push(l+=")]")};try{if(n<=0)return{detectedMismatches:c};try{for(var d=Object(r.__values)(Object.keys(t)),h=d.next();!h.done;h=d.next()){var f=h.value,p=t[f],m=e[f];if(void 0!==m)if("object"==typeof p&&null!==p)if(p instanceof Set){if(p.size!==m.size){l({key:f,mismatchType:"SetLen",val1:m.size,val2:p.size});continue}try{for(var g=(s=void 0,Object(r.__values)(p)),v=g.next();!v.done;v=g.next()){var b=v.value;m.has(b)||l({key:f,mismatchType:"SetMis",val1:b})}}catch(e){s={error:e}}finally{try{v&&!v.done&&(a=g.return)&&a.call(g)}finally{if(s)throw s.error}}}else{if(p instanceof Array&&p.length!==m.length){l({key:f,mismatchType:"ArrLen",val1:m.length,val2:p.length});continue}var y=u(m,p,n-1).detectedMismatches;y.length>0&&l({key:f,mismatchType:"SubLvl",val1:y.join(",")})}else p!==m&&l({key:f,mismatchType:"KeyMis",val1:m,val2:p})}}catch(e){o={error:e}}finally{try{h&&!h.done&&(i=d.return)&&i.call(d)}finally{if(o)throw o.error}}return{detectedMismatches:c}}catch(e){return{detectedMismatches:c,error:e}}}function l(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,u,l,p,m,g,v;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return p={ConfigKey:l=t.key,Completed:!1,Status:"Undefined"},[4,e.featureGatesPromise];case 1:return m=r.sent(),function(e){return void 0!==e.getServerGeneratedConfig}(t=function(e,t){var n,r;return(null===(r=null===(n=e.result)||void 0===n?void 0:n.clientConfigStandaloneGates)||void 0===r?void 0:r.clientConfigStandaloneEnabled)&&f(t)&&(t={key:t.key,gete 3:return f(t)?(g=!0,function(e){return void 0!==e.isGetClientGeneratedConfigEnabled&&void 0!==e.getServerGeneratedConfig&&void 0!==e.getClientGeneratedConfig}(t)&&(g=t.isGetClientGeneratedConfigEnabled(m.result)),g?[4,d(e,{key:l,getClientGeneratedConfig:t.getClientGeneratedConfig})]:[3,5]):[3,5];case 4:v=r.sent(),i=v.data,p.Completed=p.Completed||v.success,r.label=5;case 5:return p.Completed&&(void 0!==n&&void 0!==i?c(n,i,l)?(p.Status="Client",u=i):(p.Status="Mismatch",u=n):void 0!==i?(p.Status="Client",u=i):void 0!==n&&(p.Status="Server",u=n)),Object(o.a)("Fetch_".concat(l,"_").concat(p.Status)),function(e){Object(s.a)({featureName:"ConfigQueryWrapper",eventName:"FetchConfigInternalFinished",params:e},a.a.Security,!0)}(p),[2,u]}}))}))}function d(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o,s,a,c,u,l,d,h,f;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:n=t.getClientGeneratedConfig,o=t.key,r.label=1;case 1:return r.trys.push([1,7,,8]),[4,e.featureGatesPromise];case 2:return s=r.sent(),[4,e.featureSettingsPromise];case 3:return a=r.sent(),[4,e.userEntitlementsPromise];case 4:return c=r.sent(),[4,e.contextPromise];case 5:return u=r.sent(),[4,e.identityPromise];case 6:return l=r.sent(),[2,{data:n({featureGates:s.result,featureSettings:a.result,userEntitlements:c.result,componentContext:u,identity:l}),success:!0}];case 7:return d=r.sent(),h="".concat(o,"_ClientGenerated_Error"),f="Fetching client generated ".concat(o,", but encountered an error: ").concat(d),Object(i.a)({eventName:h,errorType:"FetchConfigInternal_Error",message:f}),[3,8];case 8:return[2,{data:void 0,success:!1}]}}))}))}function h(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o,s,a,c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:n=t.getServerGeneratedConfig,o=t.key,r.label=1;case 1:return r.trys.push([1,4,,5]),[4,e.contextPromise];case 2:return s=r.sent(),[4,n(s)];case 3:return[2,{data:r.sent(),success:!0}];case 4:return a=r.sent(),c="".concat(o,"_ServerGenerated_Error"),u="Fetching server generated ".concat(o,", but encororType:"FetchConfigInternal_Error",message:u}),[3,5];case 5:return[2,{data:void 0,success:!1}]}}))}))}function f(e){return void 0!6:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("2dXW");function o(e,t){var n=new r.a,o={closeControl:function(){n.next(),n.complete()},lervable()}};return function(e,t,n){void 0===n&&(n=["click","touchend","keyup"]);var r=t.closeControl,o=t.listenForClose,i=function(e){e&&e.preventDefault(),r()};n.forEach((function(e){retuof t?r(t,n):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},p0jh:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return c}));var r=n("LlSO");class o{constructor(e){r.a.assign(o,this,e)}get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_HarmonyCopilot_HarmonyFirstDraftDocumentTypeResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return r.a.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{constructor(e){r.a.assign(i,this,e)}get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_HarmonyCopilot_HarmonyFirstDraftContentGenerationAskAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return r.a.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class s{constructor(e){r.a.assign(s,this,e)}get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_HarmonyCopilot_HarmonyFirstDraftContentResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return r.a.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class a{constructor(e){r.a.assign(a,this,e)}get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_HarmonyCopilot_HarmonyFirstDraftCreateDocumentResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return r.a.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class c{constructor(e){r.a.assign(c,this,e)}get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_HarmonyCopilot_HarmonyFileSuggestions"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return r.a.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{constructor(e){r.a.assign(u,this,e)}get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_HarmonyCopilot_HarmonyCopilotOutputAnnotation"}static getBaseTypes(){return["AugLoop_Copilot_CopilotOutputAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){returturn n||t||i(e)}function o(e){return i(e)}function i(e){switch(e){case"afunctnInStorr n=/function(){return i}));var r=/http[s]?:\/\/[\S]*?-my\.sharepoint[\S]*?\.com/,o=/http[s]?:\/\/[\S]*?\.sharepoint[\S]*?\.com/,i=/http[s]?:\/\/d\.docs\.live\.net/},qCYp:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("n/4l"),o=n("k8nI"),i=n("DgHk");function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.a.Prod;switch(e){case i.d:case i.e:return[Object(o.a)(t)];case i.c:case i.a:return[Object(o.b)(t)];default:return[]}}},qZ6x:function(e,t,n){"use strict";function r(e){const t=e.window;t.console.dir=()=>{};const n=t.console.warn;t.console.warn=function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];const i=r.filter((e=>!(e instanceof t.Error&&"MaxListenersExceededWarning"===e.name)));i.length>0&&n(...i)}}n.d(t,"a",(function(){return r}))},qyk8:function(e,t,n){"use strict";function r(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!e)return e;for(var r=e,o=funnction(){return r}))},r5l9:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.SPO=0]="SPO",e[e.Custom=1]="Custom"}(r||(r={}))},r6rC:function(e,t,n){"use strict";function r(e){return"Consumer"===e.type?{listItemId:e.listItemId}:!e.listId||e.listItemId||e.listItemUniqueId&&"00000000-0000-0000-0000-000000000000"!==e.listItemUniqueId?e.listId&&e.listItemId?{listId:e.listId,listItemId:e.listItemId}:e.listItemUniqueId&&e.listId?{uniqueId:e.listItemUniqueId,listId:e.listId}:e.listItemUniqueId?{uniqueId:e.listItemUniqueId,isFolder:!1}:{itemUrl:decodeURIComponent(e.url)}:{listId:e.listId,isListSharing:!0}}n.d(t,"a",(function(){return r}))},"rK/e":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=globalThis.performance},rUkc:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"g",(function(){return s})),n.d(t,"h",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"i",(function(){return d})),n.d(t,"j",(function(){return h})),n.d(t,"f",(function(){return p})),n.d(t,"e",(function(){return b})),n.d(t,"a",(function(){return y})),n.d(t,"b",(function(){return w}));var r=n("A3AF"),o=n("tEMn");function i(e,t){const n={message:"string"==typeof(null==e?void 0:e.message)?e.message:String(e)};if((e=>null!==e&&!Array.isArray(e)&&"object"==typeof e)(e)){const{errorType:r,stack:o,name:i}=e;"string"==typeof r&&(n.errorType=r),"string"==typeof o&&(n.stack=((e,n)=>{if(!t)return e;const r=e.split("\n");return r.shift(),void 0!==n&&r.unshift(n),r.join("\n")})(o,"string"==typeof i?i:void 0))}return n}const s=e=>"function"==typeof(null==e?void 0:e.getTelemetryProperties);function a(e){void 0===e.errorInstanceId&&(e.errorInstanceId=Object(r.a)())}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;if(Object(o.c)(e)&&a(e),Object(o.b)(e))return e.addTelemetryProperties(null!==(n=t.props)&&void 0!==n?n:{}),e;const{message:r,stack:s}=i(e,!1),u=new C({message:r,stack:s});if("object"==typeof e&&null!==e){const{canRetry:t,retryAfterSeconds:n}=e;Object.assign(c,{canRetry:t,retryAfterSeconds:n})}"object"!=typeof e&&u.addTelemetryProperties({typeofError:typeof e});const l=y.typeCheck(e)?e.getTelemetryProperties():{untrustedOrigin:1};return u.addTelemetryProperties(Object.assign(Object.assign({},l),t.props)),u}let u;function l(){return function(){const e=new Error("<<generated stack>>");if(void 0===u&&(u=void 0!==e.stack),u)return e;try{throw e}catch(e){return e}}().stack}function d(e,t){const{message:n,stack:r}=i(e,!1),a=t(n);return void 0!==r&&f(a,r),p(e)&&a.addTelemetryProperties({untrustedOrigin:1}),Object(o.a)(e)&&(a.overwriteErrorInstanceId(e.errorInstanceId),a.addTelemetryProperties({innerErrorInstanceId:e.errorInstanceId})),s(e)&&a.addTelemetryProperties(e.getTelemetryProperties()),a}function h(e,t,n){const r=d(e,t),o=r.errorInstanceId;return n.sendTelemetryEvent({eventName:"WrapError",errorInstanceId:o,wrappedByErrorInstanceId:o},e),r}function f(e,t){try{Object.assign(e,{stack:t})}catch(n){e.addTelemetryProperties({stack2:t})}}function p(e){return y.typeCheck(e)?e.errorType===w&&1===e.getTeroperties().untrustedOrigin:!Object(o.c)(e)}function m(e){return"string"==typeof(null==e?void 0:e.tag)}function g(e,t){return Array.isArray(e)&&e.every((e=>v(e)))?JSON.stringify(e):v(e)?e:(console.error(`UnSupported Format of Logging Error Property for key ${t}:`,e),"REDACTED (arbitrary object)")}function v(e){switch(typeof e){case"string":case"number":case"boolean":case"undefined":return!0;default:return!1}}const b=()=>{const e=new WeakSet;return(t,n)=>{if("object"==typeof n&&null!==n){if(e.has(n))return"<removed/circular>";e.add(n)}return n}};class y extends Error{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;super(e),this.omitPropsFromLogging=n,this._errorInstanceId=Object(r.a)(),this.fluidErrorCode="-",n.add("omitPropsFromLogging"),n.add("_errorInstanceId"),t&&this.addTelemetryProperties(t)}get errorInstanceId(){return this._errorInstanceId}overwriteErrorInstanceId(e){this._errorInstanceId=e}static typeCheck(e){return"object"==typeof e&&null!==e&&"function"==typeof e.addTelemetryProperties&&"function"==typeof e.getTelemetryProperties&&"string"==typeof e.errorInstanceId}addTelemetryProperties(e){!function(e,t){for(const n of Object.keys(t))void 0===e[n]&&(e[n]=t[n])}(this,e)}getTelemetryProperties(){const e=function(e,t){const n={};for(const r of Object.keys(e)){if(t.has(r))continue;const o=e[r];n[r]=m(o)?{value:g(o.value,r),tag:o.tag}:g(o,r)}return n}(this,this.omitPropsFromLogging);return Object.assign(Object.assign({},e),{stack:this.stack,message:this.message,errorInstanceId:this._errorInstanceId})}}const w="genericError";class C extends y{constructor(e){super(e.message),this.errorType=w,void 0!==e.stack&&f(this,e.stack)}}},rV0Y:function(e,t,n){var r=n("LSEb")(n("s3UK"),"Promise");e.exports=r},rZux:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("QjXU"),o=n("nX9G"),i=function(e,t){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(o.a)()];case 1:return[2,(0,n.sent().launchTemplate)(e,t)]}}))}))}},rbGx:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r=n("mXGw"),o=Object(r.createContext)({dialogState:void 0,convertedToPaid:void 0}),i=Object(r.createContext)({setDialogState:function(e){},setConvertedToPaid:function(e){}})},rjBA:function(e,t,n){"use strict";function r(e){if(!e)return e;var t=e.lastIndexOf(".");return-1===t?e:e.substring(0,t)}n.d(t,"a",(function(){return r}))},rwSX:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return c}));const r={afZa:"af-za",amEt:"am-et",arSa:"ar-sa",asIn:"as-in",azLatnAz:"az-latn-az",bgBg:"bg-bg",bnIn:"bn-in",bsLatnBa:"bs-latn-ba",caEs:"ca-es",caEsValencia:"ca-es-valencia",csCz:"cs-cz",cyGb:"cy-gb",daDk:"da-dk",deDe:"de-de",elGr:"el-gr",enGb:"en-gb",enUs:"en-us",esEs:"es-es",esMx:"es-mx",etEe:"et-ee",euEs:"eu-es",faIr:"fa-ir",fiFi:"fi-fi",filPh:"fil-ph",frCa:"fr-ca",frFr:"fr-fr",gaIe:"ga-ie",gdGb:"gd-gb",glEs:"gl-es",guIn:"gu-in",heIl:"he-il",hiIn:"hi-in",hrHr:"hr-hr",huHu:"hu-hu",hyAm:"hy-am",idId:"id-id",isIs:"is-is",itIt:"it-it",jaJp:"ja-jp",kaGe:"ka-ge",kkKz:"kk-kz",kmKh:"km-kh",knIn:"kn-in",kokIn:"kok-in",koKr:"ko-kr",lbLu:"lb-lu",loLa:"lo-la",ltLt:"lt-lt",lvLv:"lv-lv",miNz:"mi-nz",mkMk:"mk-mk",mlIn:"ml-in",mrIn:"mr-in",msMy:"ms-my",mtMt:"mt-mt",nbNo:"nb-no",neNp:"ne-np",nlNl:"nl-nl",nnNo:"nn-no",orIn:"or-in",paIn:"pa-in",plPl:"pl-pl",ptBr:"pt-br",ptPt:"pt-pt",quzPe:"quz-pe",roRo:"ro-ro",ruRu:"ru-ru",skSk:"sk-sk",slSi:"sl-si",sqAl:"sq-al",srCyrlBa:"sr-cyrl-ba",srCyrlRs:"sr-cyrl-rs",srLatnRs:"sr-latn-rs",svSe:"sv-se",taIn:"ta-in",teIn:"te-in",thTh:"th-th",trTr:"tr-tr",ttRu:"tt-ru",ugCn:"ug-cn",ukUa:"uk-ua",urPk:"ur-pk",viVn:"vi-vn",zhCn:"zh-cn",zhTw:"zh-tw"},o={af:r.afZa,am:r.amEt,ar:r.arSa,as:r.asIn,az:r.azLatnAz,bg:r.bgBg,bn:r.enGb,bs:r.bsLatnBa,"bs-cyrl-ba":r.enGb,ca:r.caEs,cs:r.csCz,cy:r.cyGb,da:r.daDk,de:r.deDe,el:r.elGr,"el-cy":r.enGb,en:r.enUs,es:r.esEs,et:r.etEe,eu:r.euEs,fa:r.faIr,fi:r.fiFi,fil:r.filPh,fr:r.frFr,ga:r.gaIe,gd:r.gdGb,gl:r.glEs,gu:r.guIn,he:r.heIl,hi:r.hiIn,hr:r.hrHr,hu:r.huHu,hy:r.hyAm,id:r.idId,is:r.isIs,it:r.itIt,iw:r.heIl,"iw-il":r.heIl,ja:r.jaJp,ka:r.kaGe,kk:r.kkKz,km:r.kmKh,kn:r.knIn,ko:r.koKr,kok:r.kokIn,lb:r.lbLu,lo:r.loLa,lt:r.ltLt,lv:r.lvLv,mi:r.miNz,mk:r.mkMk,ml:r.mlIn,mr:r.mrIn,ms:r.msMy,mt:r.mtMt,nb:r.nbNo,ne:r.neNp,nl:r.nlNl,nn:r.nnNo,or:r.orIn,pa:r.paIn,pl:r.plPl,pt:r.ptBr,quz:r.quzPe,ro:r.roRo,ru:r.ruRu,sk:r.skSk,sl:r.slSi,sq:r.sqAl,sv:r.svSe,ta:r.taIn,te:r.teIn,th:r.thTh,tr:r.trTr,"tr-cy":r.enGb,tt:r.ttRu,ug:r.ugCn,uk:r.ukUa,ur:r.urPk,uz:r.enUs,vi:r.viVn,zh:r.enUs,"zh-hans-tw":r.zhTw},i=r.enUs,s=/^([^-]+)-.+/;function a(e){if(null==e)return!1;const t=e.toLowerCase();return Object.values(r).includes(t)||void 0!==o[t]}function c(e){if(null==e)return i;const t=e.toLowerCase();if(Object.values(r).includes(t))return t;const n=o[t];if(void 0!==n)return n;const a=function(e){const t=s.exec(e.trim().toLowerCase());if(null!==t&&t.length>1)return t[1]}(t);if(void 0!==a){const e=o[a];if(void 0!==e)return e}return i}},s1V1:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("QjXU"),o=n("MJsD"),i=n("B5kz"),s=n("W7wX"),a=n("+vVg"),c=n("bIL4");function u(){var e=this;return i.a.fetchQuery(c.b,(function(){return Object(r.__awaiter)(e,void 0,void 0,(function(){var e,t,n;return Object(r.__generator)(this,(function(i){switch(i.label){case 0:return[4,Promise.all([Obje,cachect]"==t?e.constructor:void 0,r=n?u(n):"";if(r)switch(r){case m:return p;case g:return l;case v:return d;case b:return h;case y:return f}return t}),e.exports=w},sDzn:function(e,t,n){"use strict";var r,o,i,s;n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return s})),function(e){e.OpenExternal="open-external",e.InContextUx="open-in-context",e.DeepLinkToApp="deep-link-to-app",e.Submit="submit-action"}(r||(r={})),function(e){e.App="app",e.Content="content",e.Mail="mail",e.Message="message"}(o||(o={})),function(e){e.ContentEdit="content-edit",e.ContentCreate="content-create",e.ContentView="content-view"}(i||(i={})),function(e){e.Background="Background",e.Notification="Notification"}(s||(s={}))},sLEy:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r="OfficeDotCom",o="OfficeDotComPrv"},sYGy:function(e,t,n){"use strict";e.exports=n("9Yx+")},sYiP:function(e,t,n){"use strict";n.d(t,"a",(function(){){pe:r.a.Error}},i=function(e,t){return{message:e,actionInfo:t,type:r.a.InProinkInfo:n,type:r.a.Success}}},skfY:function(e,t,n){"use strict";n.d(t,"a",(function().a.Exceli.prototype.parseHost=function(){var e=this.host,t=a.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},szsK:function(t,"a",(function(){return o}));var r=n("mXGw");function o(e){Object(r.useEffect)((function(){var t=!0,n=e((function(){return t}));return function(){t=!1,n&&n()}}),[e])}},t6yz:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return c}));var r,o=n("MwDM");!function(e){e.ClientTimeout="ClientTimeout",e.EmptyResponse="EmptyResponse",e.EmptyInitialAsk="EmptyInitialAsk",e.EmptyRefinerAsk="EmptyRefinerAsk",e.InvalidErrorDialogState="InvalidErrorDialogState"}(r||(r={}));var i,s=new Set([o.a.ModelContentFilter,o.a.OffensiveContentInput,o.a.OffensiveContentOutput,o.a.InputBlockedByDynamicGuardList,o.a.OutputBlockedByDynamicGuardList,o.a.BadRequest]),a=new Set([o.a.RaiUnsupportedLanguageInContentInput,o.a.RaiUnsupportedLanguageInContentOutput]);!function(e){e.PopUpBlockedByBrowser="PopUpBlockedByBrowser",e.OpenBlankDocFailed="OpenBlankDocFailed",e.DependencyError="DependencyError"}(i||(i={}));var c=new Set([o.a.UserThrottled,o.a.ScenarioThrottled,o.a.WorkflowQuotaLimitExceeded])},tEMn:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"of(null==e?void 0:e.getTelemetryProperties)&&"function"==typeof(null==e?void 0:e.addTelemetryProperties),o=e=>"string"==typeof(null==e?void 0:e.errorInstanceId);function i(e){return"string"==typeof(null==e?void 0:e.errorType)&&"string"==typeof strict";function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,e.exports=r},tSac:function(e,t,n){"use strict";function r(e){return o(null==e?void 0:e.audience)||(null!=e&&e.ring?e.ring:"Prod")}function o(e){switch(e){case"Development":return"Development";case"Staging":return"Staging";case"Dogfood":return"Dogfood";case"Preview":case"Microsoft":case"Production":return"Prod";case"GCC":return"Gcc";case"GCC-High":return"GccHigh";case"DoD":return"DoD";default:return}}function i(e){switch(e){case"Development":return{audience:"Development"};case"Staging":return{audience:"Staging"};case"Dogfood":return{audience:"Dogfood"};case"Gcc":return{audience:"GCC"};case"GccHigh":return{audience:"GCC-High"};case"DoD":return{audience:"DoD"};case"Prod":default:return{audience:"Production"}}}n.d(t,"b",(function(){return r})),n.d("),o=n("Eac/");function i(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer}function s(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(o.a)(totyp,i=t&&!t.nodeType&&t,s=i&&"object"==typeof e&&e&&!e.nodeType&&e,a=s&&s.exports===i?r.Buffer:void 0;e.exports=(a?a.isBuffer:void 0)||o}).call(this,n("RoC8")(e))},u1BN:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e){if(!e)return"";var t=e.wrapperVersion,n=e.buildVersion,r=t?"".concat(t.major,".").concat(t.minor,".").concat(t.build,".").concat(t.revision,"|"):"";return"".concat(r).concat(n)}},u79n:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));let r=[],o=!1,i=!1;function s(e,t){r.push({ensureExecution:!0===(null==t?void 0:t.:e}),null!=t&&t.ensureExecution&&!i&&(document.addEventListener("visibilitychange",(()=>{"hidden"===document.visibilityState&&function(){c((e=>e.ensureExecution))}()})),i=!0),a()}function a(){if(!o){if(window.requestIdleCallback)window.requestIdleCallback(u);else{const e=Date.now()+50;window.setTimeout((()=>u({timeRemaining:()=>Math.max(e-Date.now(),0),didTimeout:!1})),0)}o=!0}}funcr(let o=0;o<r.length;o+=1){if(.exports=function(e){var t=0,r=0;return function(){var o=n(),i=16-(o-r);if(r=o,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},u9fO:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("z+rT");function o(e,t,n){if(!e||!t)return e;var o={};return o[t]=n,Object(r.a)(e,o)}},"uAd/":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("Wx5u"),o=n("A3AF"),i=n("ef5c");let s=new Set;class a{constructor(e,t,n){this.activityName=e,this.logger=t,this.isAPerformanceMetric=!1,this.additionalPropsToLog=null==n?void 0:n.additionalPropsToLog,this.addUserTiming=null==n?void 0:n.addUserTiming,this.isAPerformanceMetric=(null==n?void 0:n.isAPerformanceMetric)||!1,this.subActivities={},this.identifier=Object(o.a)(),this.activityStartName=`${this.activityName}-start-${this.identifier}`,this.activityEndName=`${this.activityName}-end-${this.identifier}`,this.addUserTiming&&performance.mark(this.activityStartName),this.startTime=performance.now(),this.startTimeSinceEpoch=Date.now()}static start(e,t,n){const r=new a(e,t,n);return s.add(r),r}markSubActivityStart(e){this.subActivities[e]={startTime:performance.now(),startTimeSinceEpoch:Date.now()},this.addUserTiming&&performance.mark(this.getSubActivityName(e,"start"))}markSubActivityEnd(e,t){if(this.subActivities[e]){if(this.addUserTiming){const t=this.getSubActivityName(e,"end");performance.mark(t),performance.measure(e,this.getSubActivityName(e,"start"),t)}this.additionalPropsToLog={[`startTime_${e}`]:this.subActivities[e].startTimeSinceEpoch,[`durationMs_${e}`]:Math.round(perfhis.additionalPropsToLog,...t}}}setResult(e,t,n,r){this.logActivityResult(e,t,n,null==r?void 0:r.skipLogging)}cancel(e,t,n){this.logActivityResult(e){this.additionalPropsToLog={...this.additionalPropsToLog,...e}}dispose(){this.cancel();const e=e=>performance.clearMarks(e),t=e=>performance.clearMeasures(e);if(this.addUserTiming){e(this.activityStartName),e(this.activityEndName),this.cachedMeasureName&&t(this.cachedMeasureName);for(const n in this.subActivities)e(this.getSubActivityName(n,"start")),e(this.getSubActivityName(n,"end")),t(n)}}logActivityResult(e,t,n,o,a){if(this.hasAlreadyResolved)return;this.hasAlreadyResolved=!0,this.addUserTiming&&performance.mark(this.activityEndName);const c=performance.now(),u=Math.round(c-this.startTime);if(this.isAPerformanceMetric&&((function(){return window._pageTimings||(window._pageTimings={})}())[this.activityName]=u),this.logger&&!o){const o={eventName:this.activityName,startTime:this.startTimeSinceEpoch,durationMs:u,succeeded:e,resultType:a?r.a.Cancelled:e?r.a.Success:r.a.Failure,...this.additionalPropsToLog,...t};Object(i.a)(this.logger,o,n)}this.logger=void 0,s.delete(this),this.addUserTiming&&performance.measure(this.generateMeasureName(e),this.activityStartName,tMeasureName=`${this.activityName}${!1===e?"-FAILED":""}-${this.identifier}`,this.cachedMeasureName}getSubActivittifier}`}}},uIjv:function(e,t,n){"use sPersistedProperties(){return this}get Disposable(){return this.disposable}addPersistedProperties(e){this.persistedProperties={...this.persistedProperties,...e}}getPersistedProperties(){var e,t,n;return{...null===(e=this.es)||void 0===t||null===(n=t.getPersistedProperties)||void 0===n?void 0:n.call(t),...this.persistedProperties}}send(e){thiamespace)}sendWithNamespace(e,t){var n;null===(n=this.logger)||void 0===n||n.sendWithNamespace({...this.pes,...e},l}getNamespace(){return this.namespace}constructor(e,t,n){if(this.namespace=e,this.disposable={get Disposable(){return this},dispose:async()=>{this.logger=null}},t instanceof r){const e={...t.persistedProperties,...n};this.logger=t.logger,this.persistedProperties=e}else this.logger=t,this.persistedProperties=n}}},uReB:function(e,t,n){"use strict";n.d(t,"b",(funcn("QjXU"),i=n("hBZP");!function(e){e.ActionsUpdated="actions-updated"}(r||(r={}));var s=function(e){function t(){reject(o.__extends)ype.on.call(this,t,n)},t.prction(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Desktop="Desktop",e.Inline="Inline",e.Web="Wevh1"),o=n("fwl+"),i{var h=n.shift(),f=ngth;)o=o.then(i.shift(),i.shift());return o}?/,"")},r.forEach(["delete","get","h:t,data:(n||{}).datareturt[3]),a=r?r.toStringTag:void 0;e.exports=function(e){var t=i.call(e,a),n=e[a];try{e[a]=void 0;var r=!0}catch(e){}var o=s.call(e);return r&&(t?e[a]=n:delete e[a]),o}},vaZn:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("h8qh"),o=function(){var e=Object(r.a)().data,t=null==e?void 0:e.storageErrorResources;if(e&&t)return t}},vb0f:function(e,t,n){"use strict";function r(){return window.navigator.userAgent.toLowerCase().indexOf("msapphost/")>-1&&!!window.Windows}n.d(t,"a",(function(){return r}))},vn4N:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("QjXU"),o=n("28zg"),i=n("RAG2");function s(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return[2,Object(o.a)(i.a)]}))}))}},vnUm:function(e,t,n){"use strict";n.d(t,"h",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"f",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"e",(function(){return r})),n.d(t,"a",(function(){return l})),n.d(t,"g",(function(){return d}));var r,o=n("6ib3"),i=[o.a.Excel,o.a.PowerPoint,o.a.Word,o.a.Forms,o.a.Whiteboard,o.a.Visio,o.a.OneNote,o.a.List,o.a.PowerBI,o.a.Sway,o.a.Stream,o.a.Clipchamp,o.a.Fluid,o.a.Yammer],s=[o.a.Excel,o.a.PowerPoint,o.a.Word],a=[o.a.Fluid,o.a.Yammer],c=[o.a.Excel,o.a.PowerPoint,o.a.Word,o.a.Forms,o.a.OneNote,o.a.List,o.a.Sway,o.a.Fluid,o.a.Yammer],u=[o.a.Whiteboard,o.a.Visio,o.a.List,o.a.PowerBI,o.a.Stream,o.a.Clipchamp];!function(e){e.CreateWithContent="CreateWithContent",e.CreateNew="CreateNew",e.OpenApp="OpenApp"}(r||(r={}));var l=new Map([["loop",o.a.Fluid],["forms",o.a.Forms],["spreadsheet",o.a.Excel],["slidedeck",o.a.PowerPoint],["document",o.a.Word],["whiteboard",o.a.Whiteboard],["visio drawing",o.a.Visio],["onenote notebook",o.a.OneNote],["lists",o.a.List],["powerbi report",o.a.PAbortController:r,AbortSignal:o}="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0;e.exports=r,e.exports.AbortSignal=o,e.exports.default=r},vtYf:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("mXGw"),o=n("UMh4"),i=n("1D46"),s=n("TpfW"),a=n("yKdX"),c=n("9qdX"),u=n("GBVN");const l=Object(c.a)({root:{mc9l5x:"f22iagw",Beiy3e4:"f1vx9l62",Bbmb7ep:["fnivh3a","fc7yr5o"],Beyfa6y:["fc7yr5o","fnivh3a"],B7oj6ja:["f1el4m67","f8yange"],Btl43ni:["f8yange","f1el4m67"],z8tnut:"f1nbblvp",z189sj:["f1njcayn","f1k4q41u"],Byoj8tv:"f1ov4xf1",uwmqm3:["f1k4q41u","f1njcayn"],E5pizo:"f1whvlc6",qhf8xq:"f10pi13n",B68tc82:"f1p9o1ba",Bmxbyg5:"f1sil6mw",Bpd4iqm:"fpvhumw",oeaueh:"f1yog68k",Bw0xxkn:"fadg8gl"},rootWithChildren:{Byoj8tv:"fdxej3c"},progressRoot:{a9b677:"fly5x3f",qhf8xq:"f1euv43f",B5kzvoi:"f1yab3r1",oyh7mz:["f1vgc2s3","f1e31b4d"],j35jbq:["f1e31b4d","f1vgc2s3"],Bqenvij:"f6ywr7j",Beyfa6y:["f1deotkl","f1krrbdw"],Btl43ni:["f1ozlkrg","f10ostut"]},regularProgressBarStyles:{Bqenvij:"f1l02sjl",Bcmaq0h:"fx7worf"},indeterminateProgressBarStyles:{Bqenvij:"f1l02sjl",De3pzq:"f1c21dwh",Bcmaq0h:"f1hxqsn5"}},{d:[".f22iagw{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}",".f1vx9l62{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}",".fnivh3a{border-bottom-right-radius:var(--borderRadiusXLarge);}",".fc7yr5o{border-bottom-left-radius:var(--borderRadiusXLarge);}",".f1el4m67{border-top-right-radius:var(--borderRadiusXLarge);}",".f8yange{border-top-left-radius:var(--borderRadiusXLarge);}",".f1nbblvp{padding-top:0px;}",".f1njcayn{padding-right:var(--spacingVerticalL);}",".f1k4q41u{padding-left:var(--spacingVerticalL);}",".f1ov4xf1{padding-bottom:0px;}",".f1whvlc6{box-shadow:var(--shadow4);}",".f10pi13n{position:relative;}",".f1p9o1ba{overflow-x:hidden;}",".f1sil6mw{overflow-y:hidden;}",".fpvhumw{outline-width:1px;}",".f1yog68k{outline-style:solid;}",".fadg8gl{outline-color:var(--colorTransparentBackground);}",".fdxej3c{padding-bottom:var(--spacingVerticalL);}",".fly5x3f{width:100%;}",".f1euv43f{position:absolute;}",".f1yab3r1{bottom:0;}",".f1vgc2s3{left:0;}",".f1e31b4d{right:0;}",".f6ywr7j{height:4px;}",".f1deotkl{border-bottom-left-radius:0;}",".f1krrbdw{border-bottom-right-radius:0;}",".f1ozlkrg{border-top-left-radius:0;}",".f10ostut{border-top-right-radius:0;}",".f1l02sjl{height:100%;}",".fx7worf{background-image:linear-gradient(90deg, var(--fai-colorBrandFlair1) 35%, var(--fai-colorBrandFlair2) 70%, var(--fai-colorBrandFlair3) 92%);}",".f1c21dwh{background-color:var(--colorTransparentBackground);}",".f1hxqsn5{background-image:linear-gradient(90deg, rgba(0,0,0,0) 0%, var(--fai-colorBrandFlair1) 35%, var(--fai-colorBrandFlair2) 70%, var(--fai-colorBrandFlair3) 92%,  rgba(0,0,0,0));}"]}),d=r.forwardRef(((e,t)=>{const n=((e,t)=>{const{header:n,progress:r}=e;return{components:{root:"div",header:"h3",progress:o.a},root:Object(i.a)("div",{ref:t,...e}),header:Object(s.a)(n,{required:!0}),progress:Object(s.a)(r,{defaultProps:{shape:"rounded",thickness:"large"},required:!0})}})(e,t);return(e=>{const t=l(),{root:n}=e;if(e.root.className=Object(u.a)("fai-LatencyLoader",t.root,n.children?t.rootWithChildren:void 0,e.root.className),e.header&&(e.header.className=Object(u.a)("fai-LatencyLoader__header",e.header.className)),e.progress){e.progress.className=Object(u.a)("fai-LatencyLoader__progress",t.progressRoot,e.progress.className);const n=Object(s.a)(e.progress.bar,{required:!0});n&&(n.className=void 0===e.progress.value?Object(u.a)(t.indeterminateProgressBarStyles,n.className):Object(u.a)(t.regularProgressBarStyles,n.className),e.progress.bar=n)}})(n),(e=>{const{slots:t,slotProps:n}=Object(a.a)(e);return r.createElement(e="LatencyLoader"},vvBr:function(e,t,n){var r=n("naAV");e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}},vz6o:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("D/tM"),o=function(e){var t=e.consumerInstallConfig,n=e.workloadPublicDataConfig;return!!(null==n?void 0:n.hasBusinessLicense)||!!t&&function(e){return e!==r.a.NotSubscribed&&e!==r.a.NotDetected&&e!==r.a.NonActive&&e!==r.a.Perpetual&&e!==r.a.Perpetual2019}(t.currentSkuInfo.skuType)}},w5ta:function(e,t,n){var r=n("PYDc"),o=n("XXCu"),i=n("DZMJ"),s=n("i0JV"),a=n("xKNE");function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=s,c.prototype.set=a,e.exports=c},wK4g:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("mXGw"),o=n.n(r),i=n("+9uq"),s=n("XrJr"),a=n("85o7"),c=n("duEa"),u=n("XxaS"),l=n("OeRt"),d=n("PmtM"),h=n("iTb/"),f=n("cipv"),p=function(e){var t=e.className,n=e.primaryFill,r=function(e){switch(e){case"List":return i.u;case"ListActive":return i.t;case"Grid":return s.r;case"GridActive":return s.q;case"UpArrow":return a.l;case"ArrowRight":return c.U;case"CubeShape":return u.j;case"CubeShapeActive":return u.i;case"Clock":return l.F;case"ClockActive":return l.E;case"People":return d.b;case"PeopleActive":return d.a;case"FavoriteStar":return h.p;case"FavoriteStarActive":return h.o;case"Document":return u.F;case"DocumentActive":return u.E;case"Folder":return s.e;case"FolderActive":return s.d;case"Person":return d.l;case"PersonActive":return d.k;case"ChevronDown":return l.k;case"ChevronDownActive":return l.j;case"Add":return c.c;case"AddActive":return c.b;case"Dismiss":return u.v;case"DismissActive":return u.u;case"Tag":return f.h;case"TagActive":return f.g;case"Layer":return i.q;case"LayerActive":return i.p;case"Board":return a.s;case"BoardActive":return a.r;default:return h.p}}(e.iconName);return o.a.createElement("span",{className:t},o.a.createElement(r,{primaryFill:n}))}},wRjz:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("QjXU"),o=n("tUM7"),i=n("VOWq"),s=n("HZp7");function a(e){var t=this;return{onBeforeWriteValue:function(n){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t,i,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n?n instanceof ArrayBuffer?(t=n,i="rawbytes",[3,3]):[3,1]:[2,n];case 1:return[4,Object(s.b)(JSON.stringify(n))];case 2:a=r.sent(),t=a.buffer,i="utf8-encoded-string",r.label=3;case 3:return[4,Object(o.a)(t,e)];case 4:return[2,{buffer:r.sent(),payloadType:i}]}}))}))},onAfterReadValue:function(n){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n?[4,Object(i.a)(new Uint8Array(n.buffer),e)]:[2,n];case 1:return t=r.sent(),"rawbytes"!==n.payloadType?[3,2]:[2,t];case 2:return[4,Object(s.a)(new Uint8Array(t))];case 3:return o=r.sent(),[2,JSON.parse(o)]}}))}))}}}},wUi7:funon r(e,t){const n=[...Object.keys(e),...Object.keys(Object.getOwnPropertyDescriptors(Object.getPrototypeOf(e)))],r={};n.forEach((n=>{void 0===t[n]&&(r[n]=e[n])}));for(const e in t)r[e]=t[e];return r}n.d(t,"a",(function(){return r}))},wVmX:function(e,t,n){"use strict";n.d(t,"a",n(){var e=Object(r.a)().data,t=Object(o.a)().data;return Object(i.useMemo)((function(){return Object(s.a)({consumerInstallConfig:e,workloadPublicDataConfig:t})}),[e,t])}},wYzw:function(e,t,n){"use strict";n.d(t,"a",(function("strieturn null===e},isNullOrUndefined:function(e){return null==e}}},wnk4:function(e,t,n){var r=n("V2ZB"),o=n("h0av");e.exports=function(e,t){return e&&r(t,o(t),e)}},wuzB:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e){var t,n;return e instanceion(esh_untr(0,t]&&o.indexOf(t)>=0)return;s[t]="set-cookie"===t?(s[t]?s[t]:[]).concat([n]):s[t]?son(e,t,n){"use strict";e.exports=n("9K2m")},xg6W:function(e,t,n){"use sto}));class o{then(e,t){return tp.catch(e)}resolve(e){this.isPending=!1,this.res(e)}reject(e){this.isP{rete){returnthis.on(){),n};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:l},yEOx:function(e,t,n){var r=n("0711");e.exports=function(e){return r(e,5)}},yEz2:function(e,t,n){"use strict";function r(e){return(Date.now()-e)/864e5}n.d(t,"a",(function(){return r}))},yNE0:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("QjXU"),o=n("mgFK"),i=n("CRHC"),s=n("m32Q"),a=n("lkvL"),c=n("a3FV"),u=n("0TX8"),l=n("Wa5Y");function d(e,t,n,o,i,s,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var d,h,f;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:d={},h={method:"GET",responseType:"json",url:"".concat(o,"/api/featureSettings")},r.label=1;case 1:return r.trys.push([1,4,,5]),[4,Object(u.a)(h,n,i,t)];case 2:return r.sent(),[4,Object(l.a)(c.a.FeatureSettingsRequest,"FeatureSettings",h.url,h,a,s,o,e,"OfficeHome",{})];case 3:return(f=r.sent().data)?[2,f]:[3,5];case 4:return r.sent(),[3,5];case 5:return[2,d]}}))}))}var h="featureSettings";function f(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(o.a)(h,e)];case 1:return[2,t.sent()]}}))}))}function p(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){return[2,Object(i.a)((function(){return function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(functr)(this,(function(r){switch(r.label){case 0:return[4,f(t)];case 1:return void 0!==(n=r.sent())?[3,3]:[4,d(t.correlationId,(function(){return Promise.resolve(e)}),t.inMockMode,t.officeHomeApiRoot,t.workload,t.getAccessToken,t.jwtAuthEnabled)];case 2:n=r.sent(),r.label=3;case 3:return[2,n]}}))}))}(e,t)}),(function(){return Object(s.a)({userId:e.puid,collectionName:h,collectionVersion:1,key:h})}),(function(t){return Object(a.a)({userId:e.puid,collectionName:h,collectionVersion:1,key:h,data:0===Object.keys(t).length?null:t})}))]}))}))}},yOLj:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("8/lW"),o=n("ntFm");function i(e,t,n,i,s,a,c,u){void 0===s&&(s=!1),void 0===a&&(a={}),void 0===c&&(c=[]),void 0===u&&(u=r.a.Security),Object(o.a)(e,t,n,i,s,a,c,u).record()}b0f")returstricoI");function i(){return Object(r.a)(o.a)}},yoW1:function(e,t){e.exports=function(e){return e}},yqAG:function(e,t,n){var r=n("lLPU"),o=n("u7St")(r);e.exports=o},ywfh:function(e,t,n){"use strict";n.d(t|e.match(r.b))return"Documents";if(e.match(r.c))return"Sites"}}},ywi1:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=window.performance},"z+rT":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("5eS3"),o=n("zP6S");function i(e,t,n){return e?Object(r.a)(e,Object(o.a)(t,n)):e}},z1nA:function(e,t,n){"use strict";var r;function o(e){const tfixedByHost}n.d(tost",r t=this.__data__,n=t.delete(e);return this.size=t.size,n}},zIph:function(e,t,n){var r=n("6TGQ"),o=n("B4/L"),i=n("Vujp");e.exports=function(e){return r(e,i,o)}},zP6S:function(e,t,n){"use strict";function r(e,t){if(!e)return"";var n="";for(var r in e){var o,i=n?"&":"";o=t?e[r]?"".concat(e[r]):"":e[r]?"".co).concat(rn n}n.d(,n){vn(e){.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){p&&(p.abort(),n(e),p=null)})),d||(d=null),p.send(d)}))}},zkTx:function(e,t,n){"use strict==typeof Symbol&&"function"==typeof Symbol;if(t<=_)return Stnew Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.definePro){if(c.isBuffer(this))retroperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffseypeOf(c,Uint8Array),c.alloc=function(e,t,n){return function(e,t,n){return l(e),e<=0?a(e):void,n)},c.alluffer or Uinte"hex":caUint8Array.prototype.set.call(r,t,o);else{if(!c.isBuffer(t)wap16=function(){co{const e=this.lengthrow new RangeError("Buffer size must be a multin this},c.prototypeapply(this,arguments=function(){let e="";const n=t.INSPECT_MAX_BYTES;return e=th>>>=0),s=(n>>>=0)-(t>e.slice(t,n);for(let e=0;e<a;++e)if(u[e]!==l[e]){i=u[e],s=l[e];break}return i<s?-1:s<i?1:0},c.prototype.includes=function(e,t,n){return-1!==this;case"ucs2":case"ucor("Unknown es,s>>=8,e[n]=s,n+8}function M(e,t,n,r,o,i){if(n+r>e.length)throw new Rannction R(e,t,n,r,e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)otype.readUintLE=c.prototype.readUIntLE=functiotype.readUintBE=c.prototype.readUIntBE=funce+--t],o=1;for(;t>0&&(o*=256);)r+=this[e+--t]*o;re e>>>=0,t||P(e,1,this.length),this[e]},c.prototypee,2,this.length),this[e]|this[e+1]<<8},c.prototype1]},c.prototype.readUint32LE=c.prototype.readUInt33]},c.prototype.readUint32BE=c.is.length-8);const r=t+256*this[+his.length-8);const r=t*IntLE=function(e,t,n){E=function(e,t,n){e>>-r]*o;return o*=128,i>=ois[e]?-1*(255-this[e]+1)<8;return 32768&n?429490e]<<8;return 32768&n?429e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return e>>>=0,t||P(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readBigInt64LE=Y((function(e){H(e>>>=0,"offset");const t=this[e],n=this[e+7];return void 0!==t&&void 0!==n||z(e,this.length-8(e,this.length-8);const r=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(r)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+n)})),c.prototype.readFloatLE=function(e,t){return e>>>=0,t||P(e,4,this.length),o.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return e>>>=0,t||P(e,4,){return e>>>=0,t||P(e,8,this.length),o.read(thiiteUIntLE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,rntBE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||x*=256);)this[t+o]=e/i&255;return t+n},c.prototype.wrt]=255&e,t+1},c.prototype.writeUint16LE=c.prototype.1]=e>>>8,t+2},c.prototype.writeUint16BE=c.prototype.=c.prototype.writeUInt32LE=function(e,t,n){return e==c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||x(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,tD(this,e,t,BigInt(0),BigIath.pow(2,8*n-1);x(thisow(2,8*n-1);x(this,e,ts=1),this[t+o]=(e/i>>0)-se<0&&(e=255+e+1),this[t]=,this[t]=255&e,this[t+1]=ype.writeInt32LE=functionn(e,t,n){return e=+e,t>>>=0,n||x(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4),BigInt("0x7fffffffffffffff"))})),c.prototype.writeBigInt64BE=Y((function(e,t=0){return L(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeFloatLE=function(e,t,n){return R(this,e,t,!0,n)){return R(this,e;const o=r-n;retuer(e)?e:c.from(e,r),s=i.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<n-t;++o)this[o+t]=i[o%s]}return this};const B={};function U(e,t,n){B[e]=class extends n{construc_OUT_OF_RANGE(n||"offset"${n?1:0} and <= ${t}`,e)}U("ERR_BUFFER_mory outside buffer bounds"}),Rang?o=W(String(n)):"bigint"==typeof n&&(o=Stture)16*n;for(let o=0;o<16;++o)t[r+o]=e[n]+e[o]}return t}();function Y(e){return"undefined"==typeof BigInt?Z:e}function Z(){throw new Error("BigInt not supported")}},zkbx:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("QjXU"),o=n("7l51"),i=function(e,t){return void 0===t&&(t=""),{id:e,title:t,ariaLabel:t,contentActionOptions:{itemType:o.b.Divider}}},s=function(e,t,n,o){void 0===o&&(o=""),Array.isArray(t)?e.push.apply(e,Object(r.__spreadArray)([i(n,o)],Object(r.__read)(t),!1)):e.push(i(n,o),t)},a=function(e,t){e.length>0&&t.push.apply(t,Object(r.__spreadArray)([],Object(r.__read)(e),!1))},c=function(e,t,n,r){if(0!==e[n].length){var o=t[n];r.push({ariaLabel:o.ariaLabel,id:o.id,title:o.title,contentActionOptions:{icon:o.icon},subMenus:e[n]})}},u=function(e,t){var n,o,u;if(!t)return e;var l={AddTo:[],MosApp:[],None:[],Open:[],OpenHero:[],OpenMenu:[],Hero:[],Share:[],Unknown:[]};try{for(var d=Object(r.__values)(e),h=d.next();!h.done;h=d.next()){var f=h.value;l[(null===(u=f.contentActionOptions)||void 0===u?void 0:u.groupId)||"Unknown"].push(f)}}catch(e){n={error:e}}finally{try{h&&!h.done&&(o=d.return)&&o.call(d)}finally{if(n)throw n.error}}var p=[];if(1===l.OpenMenu.length){var m=l.OpenMenu[0],g=Object(r.__spreadArray)([],Object(r.__read)(l.Open),!1);1===l.OpenHero.length&&(g.length>0?s(g,l.OpenHero[0],"openHeroDivider"):g.push(l.OpenHero[0]));var v=g.length>0;m.contentActionOptions=Object(r.__assign)(Object(r.__assign)({},m.contentActionOptions),{split:v}),m.subMenus=v?g:void 0,p.push(m)}return c(l,t,"Share",p),p.length>0&&p.push(i("openShareDivider")),c(l,t,"AddTo",p),a(l.Unknown,p),a(l.None,p),l.MosApp.length>0&&s(p,l.MosApp,"mosAppDivider"),1===l.Hero.length&&s(p,l.Hero[0],"heroDivider"),p}},zlak:function(e,t,n){var r=n("s3t7"),o=n("T9Ud");e.exports=function(e){return o(e)&&"[object Set]"==r(e)}},zpal:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c}));var r=n("QjXU"),o=n("5X7G"),i=n("TA9V"),s=n("ZSEI"),a=function(e){var t=new o.c,a={executeActionAsync:function(o,s){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var a,c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return a=Date.now(),[4,Promise.all([n.e(7),n.e(6),n.e(9),n.e(11),n.e(12),n.e(13),n.e(17),n.e(19),n.e(22),n.e(24),n.e(69),n.e(15),n.e(4),n.e(44),n.e(68)]).then(n.bind(null,"jGeK"))];case 1:return[4,(0,r.sent().execute)(o,e,t)];case 2:return c=r.sent(),Object(i.e)(s,a,null!==(u=c.actionLoadedTS)&&void 0!==u?u:Date.now()),Object(i.b)(s),Object(i.c)(s,c),[2,c]}}))}))}};return function(e,t,n){e.on(o.d.RunNext,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var o,i,a,c,u,l,d,h,f,p,m,g,v,b,y;return Object(r.__generator)(this,(function(w){switch(w.label){case 0:return o=s.a.createErrorNotification,i=s.a.createSuccessNotification,c=n.getActionByAppId((a=e.nextAction).appId,a.id),(u=e.payload)?(l=null==c?void 0:c.officeActionCreator(u))&&c?(d={actionId:c.metadata.id,appId:c.metadata.appId,sourceUXComponent:"ContentActions",params:{},actionMenuSource:"ContentActionsNext",referral:l.payload.referral,referralPlatform:l.payload.referralPlatform},e.nextActionNotification?(i(e.nextActionNotification.message,e.nextActionNotification.actionText?{label:e.nextActionNotification.actionText,onClick:function(){t.executeActionAsync(l,Object(r.__assign)(Object(r.__assign)({},d),{sourceUXComponent:"Toast",actionMenuSource:"ContentActionsToast"}))}}:void 0,e.nextActionNotification.link&&e.nextActionNotification.link.url?{label:e.nextActionNotification.link.text,url:e.nextActionNotification.link.url}:void 0),[3,3]):[3,1]):((null===(v=null===(g=null==c?void 0:c.metadata.notificationOptions)||void 0===g?void 0:g.error)||void 0===v?void 0:v.message)&&o(null===(y=null===(b=null==c?void 0:c.metadata.notificationOptions)||void 0===b?void 0:b.error)||void 0===y?void 0:y.message),[2]):((null===(f=null===(h=null==c?void 0:c.metadata.notificationOptions)||void 0===h?void 0:h.error)||void 0===f?void 0:f.message)&&o(null===(m=null===(p=null==c?void 0:c.metadata.notificationOptions)||void 0===p?void 0:p.error)||void 0===m?void 0:m.message),[2]);case 1:return[4,t.executeActionAsync(l,d)];case 2:w.sent(),w.label=3;case 3:return[2]}}))}))}))}(t,a,e.actionManager),a},c=function(e){var t,o,i=e.componentContext,s=e.isDarkMode,a=e.isRecommendedFilesActionsApiEnabled,c=e.identity,u=e.odspShareApiEndPointBase,l=e.sharedContext,d=e.workloads,h=e.useCompliantShareApi,f=e.shareUIPosition,p=e.tokenProviderEnabled,m=e.odspFluentDialogEnabled,g=l.graphApiRoot,v="v1.0",b=d.find((function(e){return"ShellMail&&(null==b?void 0:b.Url)?{title:b.Title,url:b.Url}:void 0,w=d.find((function(e){return"ShellDocuments"===e.Id})),C=d.find((function(e){return"ShellToDo"===e.Id}));return{getMicrosoftGraphOptions:function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e,o,s,a,c,u,l,d,h;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t?[2,t]:[4,Promise.all([n.e(7),n.e(6),n.e(9),n.e(11),n.e(12),n.e(13),n.e(17),n.e(19),n.e(22),n.e(24),n.e(69),n.e(15),n.e(4),n.e(44),n.e(68)]).then(n.bind(null,"jGeK"))];case 1:return e=r.sent(),o=e.createLink,s=e.downloadContentAsBlob,a=e.getDriveItem,c=e.getGraphItem,u=e.getSharesAPIItem,l=e.getUrlFileInfo,d=e.tasksReadWriteAuthenticationHandlerOptions,h=e.uploadFile,[2,t={graphBaseUrl:g,graphVersion:v,xhrOperationParameters:{correlationId:i.correlationId,getAccessToken:i.getAccessToken,jwtAuthEnabled:i.jwtAuthEnabled,officeApiRoot:i.officeHomeApiRoot,graphApiRoot:g},wrapper:{client:(0,e.createMicrosoftGraphClient)(i.getAccessToken,g,v),createLink:o,downloadContentAsBlob:s,getDriveItem:a,getGraphItem:c,getSharesAPIItem:u,getUrlFileInfo:l,tasksReadWriteAuthenticationHandlerOptions:d,uploadFile:h}}]}}))}))},getRecommendedProviderOptions:function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return o?[2,o]:(e=a())?[4,Promise.all([n.e(7),n.e(6),n.e(9),n.e(11),n.e(12),n.e(13),n.e(17),n.e(19),n.e(22),n.e(24),n.e(69),n.e(15),n.e(4),n.e(44),n.e(68)]).then(n.bind(null,"jGeK"))]:[2,{fileActionsApiEnabled:e,recommendedWrapper:void 0}];case 1:return[4,(0,r.sent().createRecommendedWrapper)()];case 2:return t=r.sent(),[2,o={fileActionsApiEnabled:e,recommendedWrapper:t}]}}))}))},odspShareOptions:{correlationId:i.correlationId,getAccessToken:i.getAccessToken,market:i.preferredCulture,shareApiEndPointBase:u,useCompliantShareApi:h,shareUIPosition:f,tokenProviderEnabled:p,odspFluentDialogEnabled:m},workloadOptions:{outlook:y,oneDrive:w&&w.Title&&w.Url?{title:w.Title,url:w.Url}:void 0,todo:(null==C?void 0:C.Title)&&(null==C?void 0:C.Url)?{title:C.Title,url:C.Url}:void 0,teams:(null==l?void 0:l.teamsUrl)?{url:l.teamsUrl}:void 0,supportDocs:(null==l?void 0:l.supportDocsUrl)?{url:l.supportDocsUrl}:void 0},userIdentityOptions:{isMsa:c.isMsa,tenantId:c.tenantId,userPrincipalName:c.userPrincipalName},isDarkMode:s}}},zsD3:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("NrNW"),o=n("B5kz"),i=n("CaQ9"),s=n("/5so");function a(){var e=Object(r.a)().data,t=Object(i.a)().data;return Object(o.c)(["ConsumerInstallInfoConfig"],(function(){return Object(s.a)(e,t)}),{cacheTime:1/0,staleTime:1/0,enabled:!!e&&!!t})}},zuGz:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e,t,n){this.namespace=e,this.persistedProperties=n,this.logger=t}get NamespaceLogger(){return this}get PersistedProperties(){return this}addPersistedProperties(e){this.persistedProperties={...this.persistedProperties,...e}}send(e){this.sendWithNamespace(e,this.namespace)}sendWithNamespace(e,t){var n;null===(n=this.logger)||void 0===n||n.sendWithNamespace({...e,...this.persistedProperties},t)}dispose(){this.logger=null}}},zvGb:function(e,t,n){"use strict";n.d(t,"a",(function.d(t,"d",(function(){return a}));const r="undefined"!=typeof WeakRef;class o{constructor(e){r&&"object"==typeof e?this._weakRef=new WeakRef(e):this._instance=e}deref(){var e,t,n;let r;return this._weakRef?(r=null===(e=this._weakRef)||void 0===e?void 0:e.deref(),r||delete this._weakRef):(r=thit))&&delete thi__keyborgCoreRefs[t]=new o(e))}remove(e){delete this.__keyborgCoreRefs[e],0===Object.keys(this.__keyborgCoreRefs).length&&(this._isNavigatingWithKeyboard=!1)}setVal(e){if(this._isNavigatingWithKeyboard!==e){this._isNavigatingWithKeyboard=e;for(const t of Object.keys(this.__keyborgCoreRefs)){const n=this.__keyborgCoreRefs[t].deref();n?n.update(e):this.remove(t)}}}getVal(){return this._isNavigatingWithKeyboard}}const l=new u;class d{constructor(e,t){this._isMouseUsed=!1,this._onFocusIn=e=>{if(this._isMouseUsed)return void(this._isMouseUsed=!1);if(l.getVal())return;const t=e.details;t.relatedTarget&&(t.isFocusedProgrammatically||void 0===t.isFocusedProgrammatically||l.setVal(!0))},this._onMouseDown=e=>{0===e.buttons||0===e.clientX&&0===e.clientY&&0===e.screenX&&0===e.screenY||(this._isMouseUsed=!0,l.setVal(!1))},this._onKeyDown=e=>{var t;const n=l.getVal(),r=e.keyCode,o=this._triggerKeys;n||o&&!o.has(r)?n&&(null===(t=this._dismissKeys)||void 0===t?void 0:t.has(r))&&this._scheduleDismiss():l.setVal(!0)},this.id="c"+ ++c,this._win=e;const n=e.document;if(t){const e=t.triggerKeys,n=t.dismissKeys;(null==e?void 0:e.length)&&(this._triggerKeys=new Set(e)),(null==n?void 0:n.length)&&(this._dismissKeys=new Set(n))}n.addEventListener(i,this._onFocusIn,!0),n.addEventListener("mousedown",this._onMouseDown,!0),e.adeydown",this._onKeyDown,!0),function(e){const t=e;s||(s=function(e){const t=e.HTMLElement,n=t.prototype.focus;let r=!1;return t.prototype.focus=function(){r=!0},e.document.createElement("button").focus(),t.prototyolly=void 0),o.details=a,n.dispatchEvent(o)}};function a(){const e=t.__keyborgData;return e&&(e.lastFocusedProgrammatical._onFocusIn,!0),t.removeEventL t=e.document.activeElement;this._dismissTimer=e.setTimeout((()=>{this._dismissTimer=void 0;const n=e.document.activeElement;t&&n&&t===n&&l.setVal(!1)}),500)}}}class h{constructor(e,t){this._cb=[],this._id="id])&&(delete t.refs[this._id],0===Object.keys(t.refs).length&&(t.core.}unsubscribe(e){const t=this._cb.indexOf(e);t>=0&&this._cb.splice(t,1)}setVal(e){l.setVal(e)}}function f(e,t){return h.create(e,t)}function p(e){h.dispose(e)}}}]);
//# sourceMappingURL=draft-cnt.0168cbdccdfeb7c4843d.chunk.v7.js.map