"use strict";(self.webpackChunkheifetz=self.webpackChunkheifetz||[]).push([[430],{23717:function(t,e,n){n.r(e),n.d(e,{default:);var a=n(94009),o=n(87363),s=n.n(o),i=n(85456),l=n.n(i),c=n(25628),r=n.n(c),d=n(87462),u=n(41402),m=function(t){var e=t.width,n=t.height;return(0,u.tZ)("svg",(0,d.Z)({width:void 0===e?"10":e,height:void 0===n?"10":n,viewBox:"0 0 10 10",fill:"none"},t),(0,u.tZ)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5 0C7.76142 0 10 2.23858 10 5C10 7.76142 7.76142 10 5 10C2.23858 10 0 7.76142 0 5C0 2.23858 2.23858 0 5 0ZM5 1C2.79086 1 1 2.79086 1 5C1 7.20914 2.79086 9 5 9C7.20914 9 9 7.20914 9 5C9 2.79086 7.20914 1 5 1ZM5 2C5.27614 2 5.5 2.22386 5.5 2.5V4.21902C5.5 4.54533 5.65921 4.85112 5.92654 5.03825L7.37712 6.05365C7.60334 6.21201 7.65836 6.52378 7.5 6.75C7.34164 6.97622 7.02988 7.03124 6.80365 6.87288L4.92654 5.5589C4.65921 5.37178 4.5 5.06599 4.5 4.73967V2.5C4.5 2.22386 4.72386 2 5 2Z",fill:"white"}))},v=n(56270),p="GoodsItemCardPromo",f=function(t){var e=t.countdown,n=(0,a._)((0,o.useState)(e),2),i=n[0],l=n[1],c=(0,o.useRef)();(0,o.useEffect)(function(){if(i<=0){clearInterval(c.current),l(0);return}return c.current=setInterval(1e3),,[i]);var r=(0,v.c5)(i),d=r.d,f=r.h,g=r.m,Z=r.s,C="".concat(d?d+"天":""," ").concat(f,":").concat(g,":").concat(Z);return(0,u.tZ)("div",{className:p},(0,u.tZ)("div",{className:"".concat(p,"-left")},(0,u.tZ)(m,{className:"".concat(p,"-icon")}),(0,u.tZ)("span",null,"限时秒杀")),(0,u.tZ)("div",{className:"".concat(p,"-right")},i?(0,u.tZ)(s().Fragment,null,(0,u.tZ)("span",null,"距结束还剩 "),(0,u.tZ)("span",{className:"".concat(p,"-rightText")},C)):(0,u.tZ)("span",null,"活动已结束")))},g=n(14168),Z=n.n(g),C=n(69383),h=n(99878),k=n(16544),N=n(74135),b=function(t){var e=t.className,n=t.style,a=t.id,s=t.skuId,i=t.imgUrl,l=t.title,c=t.price,d=void 0===c?0:c,m=t.source,v=t.productType,p=t.subtitle,g=t.tags,Z=void 0===g?[]:g,b=t.promoInfo,y=void 0===b?{}:b,I=t.showBottomLine,S=t.zaData,w=void 0===S?{}:S,L=t.promoType,G=t.onClick,_=Number((null==y?void 0:y.countdown)||0)>0,T=_&&"tag"===L,z=_&&"tag"!==L;return(0,o.useEffect)(function(){(null==w?void 0:w.showId)&&C.Z.trackCardShow(null,{id:null==w?void 0:w.showId,path:[{module_name:"".concat(a,"_").concat(s,"_").concat(m,"_").concat(v)}]})},[]),(0,u.tZ)("div",{className:r()("GoodsItemCard",{"GoodsItemCard-promo":z},e),style:n,onClick:function(){(null==w?void 0:w.clickId)&&C.Z.trackEvent(null,{id:null==w?void 0:w.clickId,action:"OpenUrl",path:[{module_name:"".concat(a,"_").concat(s,"_").concat(m,"_").concat(v)}]}),"function"==typeof G&&G()}},z&&(0,u.tZ)(f,{countdown:(null==y?void 0:y.countdown)||0}),(0,u.tZ)("div",{className:"GoodsItemCard-main"},(0,u.tZ)("div",{className:"GoodsItemCard-left"},(0,u.tZ)("div",{className:"GoodsItemCard-imgLayer"}),(0,u.tZ)("img",{className:"GoodsItemCard-imgUrl",src:i,alt:""})),(0,u.tZ)("div",{className:"GoodsItemCard-right"},(0,u.tZ)("div",{className:"GoodsItemCard-title"},l),(0,u.tZ)(k.Z,{className:"GoodsItemCard-tags",isPromo:_,promoTagShow:T,countdown:(null==y?void 0:y.countdown)||0,tags:(0,N.camelizeKeys)(Z||[])}),(0,u.tZ)("div",{className:"GoodsItemCard-footer"},(0,u.tZ)("div",{className:"GoodsItemCard-priceBox"},(0,u.tZ)("span",{className:"GoodsItemCard-price"},"\xa5".concat(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.trimZero,a=String(t).padStart(2,"0").slice(-2);return void 0!==n&&n&&"00"===a?"".concat(Math.floor(t/100)):"".concat(Math.floor(t/100),".").concat(a)}(d)))),(0,u.tZ)("div",{className:"GoodsItemCard-source"},p,(0,u.tZ)(h.N,{size:20,center:!0})))),(0,u.tZ)("div",{className:"GoodsItemCard-bottomLine",style:{display:void 0!==I&&I?"block":"none"}})))};b.prototype={className:Z().string,style:Z().object,id:Z().string,skuId:Z().string,promoType:Z().string,imgUrl:Z().string.isRequired,title:Z().string.isRequired,subtitle:Z().string,price:Z().number,source:Z().string.isRequired,showBottomLine:Z().bool,tags:Z().array,zaData:Z().object,promoInfo:Z().object,onClick:Z().func};var y=function(){return(0,u.tZ)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,u.tZ)("circle",{opacity:"0.45",cx:"10.5",cy:"9.5",r:"9",stroke:"#444444"}),(0,u.tZ)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.0902 5.40973L7.19188 8.30802C6.93425 8.56261 6.93422 8.96569 7.20772 9.23616C7.43803 9.46345 7.84338 9.54449 8.13586 9.25201L9.86195 7.52591C9.85274 9.20642 9.86308 12.9266 9.86308 12.9266C9.863 14.0797 11.2306 14.0789 11.2261 12.9257C11.2239 11.9915 11.2234 8.8631 11.2265 7.52354L12.9433 9.24029C13.1948 9.48879 13.6017 9.488 13.8699 9.2228C14.1055 8.99018 14.1056 8.5871 13.8874 8.29617L11.0009 5.40967C10.7494 5.15965 10.3425 5.16044 10.0902 5.40973V5.40973Z",fill:"#444444"}))},I=n(51924),S=n(87320),w=function(){return(0,u.tZ)(s().Fragment,null)},L={SkeletonH01:function(t){var e=t.lineClass;return(0,u.tZ)(s().Fragment,null,(0,u.tZ)("div",{className:e}),(0,u.tZ)("div",{className:e}))},SkeletonP01:function(t){var e=t.lineClass,n=t.blockClass;return(0,u.tZ)(s().Fragment,null,(0,u.tZ)("div",{className:n}),(0,u.tZ)("div",null,(0,u.tZ)("div",{className:e}),(0,u.tZ)("div",{className:e})))},SkeletonT01:function(t){var e=t.lineClass;return(0,u.tZ)(s().Fragment,null,(0,u.tZ)("div",{className:e}),(0,u.tZ)("div",{className:e}),(0,u.tZ)("div",{className:e}),(0,u.tZ)("div",{className:e}))},SkeletonT02:function(t){var e=t.lineClass;return(0,u.tZ)(s().Fragment,null,(0,u.tZ)("div",{className:e}),(0,u.tZ)("div",{className:e}),(0,u.tZ)("div",{className:e}))},SkeletonC01:function(t){var e=t.lineClass,n=t.blockClass;return(0,u.tZ)(s().Fragment,null,(0,u.tZ)("div",{className:n}),(0,u.tZ)("div",null,(0,u.tZ)("div",{className:e}),(0,u.tZ)("div",{className:e})))},SkeletonC02:function(t){var e=t.lineClass,n=t.blockClass;return(0,u.tZ)(s().Fragment,null,(0,u.tZ)("div",null,(0,u.tZ)("div",{className:e}),(0,u.tZ)("div",{className:e})),(0,u.tZ)("div",{className:n}))},SkeletonC03:function(t){var e=t.lineClass,n=t.blockClass;return(0,u.tZ)(s().Fragment,null,(0,u.tZ)("div",{className:n}),(0,u.tZ)("div",{style:{width:"100%"}},(0,u.tZ)("div",{className:e}),(0,u.tZ)("div",{className:e})))},SkeletonC04:function(t){var e=t.lineClass,n=t.blockClass;return(0,u.tZ)(s().Fragment,null,(0,u.tZ)("div",{className:"".concat(n,"-1")}),(0,u.tZ)("div",{className:n}),(0,u.tZ)("div",{style:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center"}},(0,u.tZ)("div",{className:e}),(0,u.tZ)("div",{className:e})))},SkeletonI01:function(t){var e=t.blockClass;return(0,u.tZ)(s().Fragment,null,(0,u.tZ)("div",{className:e}))},SkeletonSpacing:w,SkeletonFill:w},G=s().memo(function(t){var e,n=t.variant,a=void 0===n?"H01":n,o=t.height,s=t.width,i=t.animation,l="skeleton__line--".concat(a.toLowerCase()),c="skeleton--".concat(a.toLowerCase()),d=r()((0,S._)({skeleton__block:!0},"skeleton__block--".concat(a.toLowerCase()),!0)),m=r()((0,S._)({skeleton__line:!0},l,!0)),v=r()((e={skeleton:!0},(0,S._)(e,c,!0),(0,S._)(e,"skeleton--ease-in","ease-in"===(void 0===i?"ease-in":i)),e)),p={width:void 0===s?"auto":s};o&&["Spacing","Fill"].includes(a)&&(p.height="number"==typeof o?"".concat(o,"px"):o);var f=L["Skeleton".concat(a)];return(0,u.tZ)("section",{className:v,style:p},(0,u.tZ)(f,{variant:a,lineClass:m,blockClass:d}))});G.propTypes={variant:Z().string,height:Z().oneOfType([Z().string,Z().number]),width:Z().oneOfType([Z().string,Z().number]),animation:Z().oneOfType([Z().bool,Z().string])};var _=s().memo(function(t){var e,n=t.content,o=("string"==typeof(e=void 0===n?"T01":n)?e.split(","):e).map(function(t){var e=(0,a._)(t.split("-"),2),n=e[0],o=e[1];return["Spacing","Fill"].includes(n)?{type:n,height:+o}:{type:n,count:+o||1}});return(0,u.tZ)(s().Fragment,null,o.map(function(t,e){var n=t.type,a=t.count,o=t.height;return a?Array.from({length:a}).map(function(t,a){return(0,u.tZ)(G,{variant:n,key:"".concat(e,"-").concat(a)})}):(0,u.tZ)(G,{variant:n,height:o,key:"".concat(e,"-").concat(o)})}))});_.prototype={content:(0,g.oneOfType)([(0,g.arrayOf)(g.string),g.string])};var T=n(43384),z=n(82267),F=n(5655),R={tabId:"",tabName:"",isGetDataDirect:!0,tabData:[]},D=function(t){var e=t.id,n=t.url,s=t.scenes,i=t.fetcherOptions,l=(0,a._)((0,o.useState)(0),2),c=l[0],r=l[1],d=(0,a._)((0,o.useState)(!1),2),u=d[0],m=d[1],v=(0,a._)((0,o.useState)([]),2),p=v[0],f=v[1],g=(0,a._)((0,o.useState)([]),2),Z=g[0],C=g[1],h=(0,a._)((0,o.useState)([]),2),k=h[0],b=h[1],y=(0,a._)((0,o.useState)(!1),2),I=y[0],S=y[1],w=(0,a._)((0,o.useState)(R),2),L=w[0],G=w[1],_=(0,a._)((0,o.useState)(!1),2),T=_[0],z=_[1];(0,o.useEffect)(function(){m(!0);var t=n||"/api/v4/mcn/linkcard/".concat(e,"/goods?scenes=").concat(s);(0,F._)(t,i).then(function(t){var e=(0,N.camelizeKeys)((null==t?void 0:t.data)||{}),n=e.goods,a=e.tabs,o=e.similarGoods,s=(null==a?void 0:a[0])||R;s.tabId&&D(s),f(n||[]),C(o||[]),b(a||[]),S(!1)}).catmeout(function(){m(!1)},500)})},[e,c]);var D=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};G(Object.assign({},t)),t.isGetDataDirect||(z(!0),(0,F._)(t.tabDataUrl).then(function(e){var n,a=(0,N.camelizeKeys)((null==e?void 0:null===(n=e.data)||void 0===n?void 0:n.goods)||[]);b(function(e){return e.map(function(e){return e.tabId===t.tabId?Object.assign({},e,{isGetDataDirect:!0,tabData:a||[]}):e})}),G(function(t){return Object.assign({},t,{tabData:a||[],isGetDaatch(function(){return z(!1)}))};return{refresh:c,setRefresh:r,isFailure:I,sameList:p,similarList:Z,activeTabMap:L,setActiveTabMap:G,loading:u,tabs:k,seckillLoading:T,setIsFailure:S,handleChangeTab:D}},B=function(t){var e=t.className,n=t.style,s=t.showModal,i=void 0===s||s,c=t.withModal,d=t.modalTitle,m=t.id,v=t.url,p=t.fetcherOptions,f=t.scenes,g=void 0===f?0:f,Z=t.onClose,h=(0,z._)(),k=D({url:void 0===v?"":v,id:m,fetcherOptions:void 0===p?{}:p,scenes:g}),S=k.refresh,w=k.setRefresh,L=k.loading,G=k.sameList,F=k.similarList,R=k.tabs,B=k.isFailure,O=k.activeTabMap,M=k.handleChangeTab,x=k.seckillLoading,E=(0,o.useRef)(),P=(0,o.useRef)(),U=(0,o.useRef)(0),j=(0,a._)((0,o.useState)(!0),2),A=j[0],V=j[1],K=l()(function(){var t=P.current.getClientRects()[0]||{top:0};t.top<U.cion(){return U.current=t.top})},16);(0,o.useEffect)(function(){C.Z.trackCardShow(null,{id:10331,path:[{module_name:m}]})},[]),(0,o.useEffect)(function(){if(E.current=document.getElementsByClassName("ModalWindow-inner")[0],E.current&&P.current)return E.currentoveEventListener("scroll",K)}},[K]);var W=function(t){var e=(0,N.camelizeKeys)(t),n=e.id,a=e.goods||{},o=a.goodsUrl,s=a.source;h({id:n,url:o.url,source:s,scenes:g,appSchemaIos:o.iosSchema,appSchemaAndroid:o.androidSchema})},q=function(t,e){return(null==t?void 0:t.length)?(0,u.tZ)("div",{className:"PopupSelectList-list"},t.map(function(t){return(null==t?void 0:t.length)?t:[]}).map(function(t,n){return t.length?(0,u.tZ)(o.Fragment,{key:n},t.map(function(t,a){var s=t.id,i=t.goods,l=t.tags,c=t.promoInfo,d=t.attachedInfoBytes,m=i||{},v=m.skuId,p=m.title,f=m.subtitle,g=m.goodsImg,Z=m.goodsUrl,C=m.price,h=m.source,k=m.productType,N=(C||{}).price,y=Number((null==c?void 0:c.countdown)||0)>0;return(0,u.tZ)(o.Fragment,{key:"".concat(v,"-").concat(n,"-").concat(a)},1===n&&0===a&&(0,u.tZ)("div",{className:"PopupSelectList-similarTitle"},"相似商品"),(0,u.tZ)(T.eV,{content:{type:"GoodsRecommend",id:String(v),token:String(s)},extra:{attachedInfoBytes:d,link:{url:null==Z?void 0:Z.url}}},(0,u.tZ)(T.Wi,{shouldTrackClick:!0,zaBlock:"goodsRecommend_polymericPopupCard",className:r()({"GoodsCardList-listItem":y&&"tag"!==e}),zaType:"Card",zaAction:"OpenUrl",zaEventType:"Click"},(0,u.tZ)(b,{className:"GoodsPopupList-cardItem",id:s,skuId:v,title:p,imgUrl:null==g?void 0:g.imgUrl,price:N,source:h,subtitle:f,productType:k,showBottomLine:!1,zaData:{showId:10371,clickId:10372},tags:l,promoInfo:c,promoType:e,onClick:function(){return W(t)}}))))})):null})):null},H=(0,u.tZ)(T.eV,{content:{type:"GoodsRecommend",id:String(m),token:String(m)}},(0,u.tZ)(T.Wi,{zaBlock:"goodsRecommend_polymericPopupPage",zaType:"Page",as:"div",className:"GoodsCardList-container",ref:P},(0,u.tZ)("div",{className:"GoodsCardList-titleContainer"},(0,u.tZ)("div",{className:"GoodsCardList-title"},"当前商品购买渠道")),L&&!B?(0,u.tZ)(_,{content:"C03,Spacing-26,C03",height:72}):q([G,F]),!!(null==R?void 0:R.length)&&(0,u.tZ)("div",{className:"GoodsCardList-tabs"},R.map(function(t){return(0,u.tZ)(T.Wi,{zaBlock:"goodsRecommend_tabButton",zaType:k:!0,zaText:t.tabName,onClick:function(){return M(t)},className:r()("GoodsCardList-tab",{"GoodsCardList-tabAvtive":t.tabId===O.tabId}),key:t.tabId,content:{type:"GoodsRecommend",id:t.tabId}},t.tabName)})),!B&&(0,u.tZ)("div",null,x?(0,u.tZ)("div",{style:{width:"100%"}},(0,u.tZ)(_,{content:"C03,Spacing-26,C03",height:72})):q([O.tabData],"tag")),B&&(0,u.tZ)("div",{className:"GoodsCardList-error"},(0,u.tZ)("div",{className:"GoodsCardList-errorDesc"},"Oops~ 出错了")assName:"GoodsCardList-errorBtn",onClick:function(){w(S+1)}},"刷新重试")),(0,u.tZ)("div",{className:r()("GoodsCardList-backContainer",{"GoodsCardList-backContainerShow":!Aunction(){E.current&&E.current.scrollTo({top:0,behavior:"smooth"})}},(0,u.tZ)("div",{className:"GoodsCardList-backContent"},(0,u.tZ)(y,null),(0,u.tZ)("span",{className:"GoodsCardList-backText"},"返回顶部购买商品")))));return void 0===c||c?(0,u.tZ)(I.Z,{className:r()("GoodsCardList",e),style:n,size:"large",title:void 0===d?"":d,onClose:Z},i&&H):H};B.prototype={className:Z().string,style:Z().object,showModal:Z().bool,withModal:Z().bool,modalTitle:Z().string,id:Z().string,url:Z().string,fetcherOptions:Z().object,scenes:Z().number,onClose:Z().func,onSelectCard:Z().func};var O=B}}]);
//# sourceMappingURL=GoodsRecommendGoodsCardList.29fcd47c432236fd8b83.js.map