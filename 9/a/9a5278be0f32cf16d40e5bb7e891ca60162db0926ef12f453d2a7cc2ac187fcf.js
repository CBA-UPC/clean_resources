"use strict";(()=>{(self.webpackChunkms_script_service=self.webpackChunkms_script_service||[]).push([[646],{8977:(Q,h,m)=>{m.r(h),m.d(h,{initializeSourcepointCMP:()=>B,showConsentManager:()=>M});var _=m(3631),l=m(9977);const y={RESTRICTED:898206,WU:969704,PIPL:954319},M=({regime:o="restrictive"})=>{var e,t;const a=(0,l.V4)();let n=0;switch(!0){case a:n=y.WU;break;case o===_.V3:n=y.PIPL;break;default:n=y.RESTRICTED}l.kg.info(`managerId - ${n}`),(t=(e=window==null?void 0:window._sp_)==null?void 0:e.gdpr)==null||t.loadPrivacyManagerModal(n)};var L=m(8048);const p=(0,L.createLogger)("script-loader"),P="loaded",S="complete",b="failure",C="success",D=o=>o.readyState?o.readyState===P||o.readyState===S:!0,O=(o,e={},t="head")=>new Promise((a,n)=>{const c=document.querySelector(t);c||n(new Error(`${t} not found in document`));const s=document.createElement("script");s.type="text/javascript",s.src=o,Object.keys(e).forEach(r=>{s[r]=e[r]}),s.onerror=()=>{e.onerror&&(p.debug(e.onerror,`Calling onerror attribute for script ${o}`),e.onerror()),p.error(`Error occurred loading script ${o}`),a(b)},s.onload=()=>{D(s)&&(e.onload&&(p.debug(e.onload,`Calling onload attribute for script ${o}`),e.onload()),p.debug(`Successfully loaded script ${o}`),a(C))},s.readyState&&(s.onreadystatechange=()=>{(s.readyState===P||s.readyState===S)&&(e.onreadystatechange&&(p.debug(e.onreadystatechange,`Calling onreadystatechange attribute for script ${o}`),e.onreadystatechange()),a(C))}),document.getElementById(e==null?void 0:e.id)?(p.debug(`Avoiding recalling script with the same id attribute ${e.id} for script ${o}`),a(b)):(p.debug(`Loading script ${o}`),c.appendChild(s))}),X=(o,e)=>new Promise(t=>{const a=`jsonp_callback_${Math.round(1e5*Math.random())}`,n=document.createElement("script"),c=o.replace(/=\?/,`=${a}`);window[a]=s=>{window[a]=null,p.debug(`Successful callback for ${c}`),t(s)},n.async=e,n.src=c,n.onerror=()=>{p.error(`Error occurred loading script ${c}`),t(b)},p.debug(`Loading script ${c}`),document.getElementsByTagName("head")[0].appendChild(n)});function T(){"use strict";function o(e){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}(function(){var e=function(){for(var t,a,n=[],c=window,s=c;s;){try{if(s.frames.__tcfapiLocator){t=s;break}}catch{}if(s===c.top)break;s=s.parent}t||(function r(){var d=c.document,i=!!c.frames.__tcfapiLocator;if(!i)if(d.body){var u=d.createElement("iframe");u.style.cssText="display:none",u.name="__tcfapiLocator",d.body.appendChild(u)}else setTimeout(r,5);return!i}(),c.__tcfapi=function(){for(var r=arguments.length,d=new Array(r),i=0;i<r;i++)d[i]=arguments[i];if(!d.length)return n;d[0]==="setGdprApplies"?d.length>3&&parseInt(d[1],10)===2&&typeof d[3]=="boolean"&&(a=d[3],typeof d[2]=="function"&&d[2]("set",!0)):d[0]==="ping"?typeof d[2]=="function"&&d[2]({gdprApplies:a,cmpLoaded:!1,cmpStatus:"stub"}):n.push(d)},c.addEventListener("message",function(r){var d=typeof r.data=="string",i={};if(d)try{i=JSON.parse(r.data)}catch{}else i=r.data;var u=o(i)==="object"&&i!==null?i.__tcfapiCall:null;u&&window.__tcfapi(u.command,u.version,function(w,v){var k={__tcfapiReturn:{returnValue:w,success:v,callId:u.callId}};r&&r.source&&r.source.postMessage&&r.source.postMessage(d?JSON.stringify(k):k,"*")},u.parameter)},!1))};e()})(),l.kg.info("tcfapi stub file - window.__tcfapi ready:",window.__tcfapi)}const g={RESTRICTED:"https://restricted.weather.com",WU:"https://restricted.wunderground.com",DE_DE:"https://germany.weather.com",PIPL:"https://china.weather.com"},E=["stage.weather.com","weather.com","stage.wunderground.com","www.wunderground.com"],R=({regime:o,countryCode:e,isWu:t})=>{var a,n,c,s,r,d;let i="",u="-stage";const{host:w}=window.location,v=((a=document==null?void 0:document.documentElement)==null?void 0:a.lang)==="de-DE";switch(!0){case t:i=g.WU;break;case!!((c=g)!=null&&c[(n=o==null?void 0:o.toUpperCase)==null?void 0:n.call(o)]):i=g[(s=o==null?void 0:o.toUpperCase)==null?void 0:s.call(o)];break;case!!g[(r=e==null?void 0:e.toUpperCase)==null?void 0:r.call(e)]:i=g[(d=e==null?void 0:e.toUpperCase)==null?void 0:d.call(e)];break;case v:i=g.DE_DE;break;default:i=g.RESTRICTED}return E.includes(w),u="-prod",i+u},$=()=>{let o="stage";const{host:e}=window.location;return E.includes(e)&&(o="prod"),o},F=()=>{var o,e,t,a;let n=((a=(t=(e=(o=document==null?void 0:document.documentElement)==null?void 0:o.lang)==null?void 0:e.split)==null?void 0:t.call(e,"-"))==null?void 0:a[0])||"en";return n==="tk"&&(n="tr"),n},V=({isUserLoggedIn:o,userId:e})=>o?e:null;var f=m(6850);const U={"652413fca7e32b05a6b2fb27":f.ML,"651db58f8a9751048162c9af":f.ML,"65243b7ecb8c5d06d8d58d13":f.ML,"654e4f6ace6aa40650cb97be":f.GN,"6554ee7522726d0495b4e7b6":f.hy,"6554ef2e475ea206af4b3bbe":f.hy,"654e4f6ace6aa40650cb97c4":f.hy,"6554ef5132bde905465d5a2b":f.hy,"6554eec6a4ff2f054d6655cb":f.G,"6554ef2e475ea206af4b3bc3":f.G,"6554ef5132bde905465d5a30":f.G},W="5ec515cab8e05c6bd70f42a3",G="6554f1f21284d5065e9e21ce",j=async({consentCallback:o,isWu:e})=>{const t=await N({isWu:e}),a=e?"WU":"TWC";l.kg.info(`proccessed ${a} custom purposes`,t),t&&await o(t)},N=async({isWu:o})=>new Promise(e=>{window.__tcfapi("getCustomVendorConsents",2,t=>{var a;l.kg.info("processing getCustomVendorConsents data",t);const{grants:n}=t,c=o?G:W,s=(a=n==null?void 0:n[c])==null?void 0:a.purposeGrants;if(s){const r=A(s);e(r)}else l.kg.warn("No custom purposes consents to get from vendor grants."),e({})})}),A=o=>Object.keys(o).reduce((a,n)=>{const c=U[n];return c&&(a[c]=o[n]),a},{}),I={amplitudeFullMetrics:{id:"6061aec5b5389c56c59ea31e",name:"Amplitude"},facebookWxNode:{id:"5e716fc09a0b5040d575080f",name:"Facebook, Inc."},youtubeWxNode:{id:"5e7e1298b8e05c4854221be9",name:"Google Inc."},instagramWxNode:{id:"5e7e5243b8e05c1c467daa57",name:"Instagram, Inc"},medallia:{id:"5e7e5243b8e05c1c467daa57",name:"Medallia"},mParticleFullMetrics:{id:"62470f577e1e3605d5bc0b8a",name:"mParticle"},rubicon:{id:"5e542b3a4cd8884eb41b5a81",name:"The Rubicon Project, Inc."},twitterWxNode:{id:"5fab0c31a22863611c5f8764",name:"Twitter"}},H=async({vendorsCallback:o})=>{const e=await x();l.kg.info("proccessed custom vendor grants feature flags",e),e&&await o(e)},x=async()=>new Promise(o=>{window.__tcfapi("getCustomVendorConsents",2,e=>{const{grants:t}=e;if(Object.keys(t).length){const a=z(t);o(a)}else l.kg.warn("No custom vendor grants to set granular feature flags from."),o({})})}),z=o=>Object.keys(I).reduce((a,n)=>{const{id:c}=I[n],s=o==null?void 0:o[c];if(s){const{vendorGrant:r}=s;typeof r!="boolean"?l.kg.warn(`Missing vendorGrant for ${n} with id: ${c}.`):a[n]=r}return a},{}),J=async({consentCallback:o,vendorsCallback:e,isWu:t})=>new Promise(a=>{var n;(n=window==null?void 0:window.__tcfapi)==null||n.call(window,"addEventListener",2,async(c,s)=>{if(l.kg.info(`__tcfapi event listener: ${c.listenerId} tcdata`,c),s){const{eventStatus:r}=c;if((r==="tcloaded"||r==="useractioncomplete")&&(await j({consentCallback:o,isWu:t}),await H({vendorsCallback:e})),r==="useractioncomplete"){window.location.reload();return}a(!0)}})});async function B({regime:o,countryCode:e,consentCallback:t,vendorsCallback:a,userId:n,isUserLoggedIn:c}){o!==_.V3&&T(),await K({regime:o,countryCode:e,consentCallback:t,vendorsCallback:a,userId:n,isUserLoggedIn:c})}async function K({regime:o,countryCode:e,consentCallback:t,vendorsCallback:a,userId:n,isUserLoggedIn:c}){const s=(0,l.V4)();let r;const d=new Promise(i=>{r=i});window._sp_queue=[],window._sp_={config:{accountId:1763,campaignEnv:$(),baseEndpoint:"https://cdn.privacy-mgmt.com",propertyHref:R({regime:o,countryCode:e,isWu:s}),joinHref:!0,authId:V({isUserLoggedIn:c,userId:n}),consentLanguage:F(),gdpr:{},events:{onMessageReceiveData(...i){l.kg.info("[event] onMessageReceiveData",i)},async onSPPMObjectReady(...i){l.kg.info("[event] onSPPMObjectReady",i),await J({consentCallback:t,vendorsCallback:a,isWu:s}),r()},onError(...i){l.kg.info("[event] onError",i)}}}},l.kg.info("initializing SP Config",window._sp_.config),l.kg.info(`vendor list propertyHref - ${window._sp_.config.propertyHref}`),await Y(),await d}async function Y(){l.kg.info("requesting wrapperMessagingWithoutDetection.js"),await O("https://cdn.privacy-mgmt.com/unified/wrapperMessagingWithoutDetection.js",{async:!0})}}}]);})();

//# sourceMappingURL=SourcePoint.278649f0592559db07cf.js.map