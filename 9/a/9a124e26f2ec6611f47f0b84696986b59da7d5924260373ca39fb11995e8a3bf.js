/*! For license information please see vendors~task-dialog-rc.9306f3ffa5e238991e3e.chunk.v7.js.LICENSE.txt */
(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[668,91],{"+4M4":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("NrNW"),i=n("B5kz"),o=n("CaQ9"),a=n("yNE0");function s(){var e=Object(r.a)().data,t=Object(o.a)().data;return Object(i.c)(["FeatureSettings"],(function(){return Object(a.a)(t,e)}),{staleTime:1/0,cacheTime:1/0,enabled:e&&t})}},"+Ltg":"+fbL":function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n("QjXU"),i=n("g7aC"),o=n("YcJm"),a=n("Sn4U"),s=n("9qA2"),l=n("+sqR"),c=n("q3UB"),u=n("8Jek"),p=n.n(u),d=n("mXGw"),h=n.n(d),f=n("xctO");function g(e,t){return t<.2*e?.2*e-36:t>.8*e?.8*e-36:t}var m=function(e,t){if(!t)return f.b.Medium;if("number"==typeof t)return g(e,t);switch(t){case f.b.Small:return.2*e;case f.b.Medium:return.5*e;case f.b.Large:return.66*e}},v=function(e,t){if(!t)return f.b.Medium;if("number"==typeof t)return g(e,t);switch(t){case f.b.Small:return.2*e;case f.b.Medium:return.5*e;case f.b.Large:return.6*e}},y=Object(d.forwardRef)((function(e,t){var n=e.children,u=e.taskInfo,f=e.onCancel,g=e.appName,y=e.icon,b=e.hideHeader,S=e.locStrings,C=Object(c.a)(),_=C.height,A=C.width,w=Object(r.__read)(Object(d.useState)({height:m(_,u.height),width:v(A,u.width)}),2),E=w[0],I=w[1],P=y||"https://static2.sharepointonline.com/files/fabric-cdn-prod_20200430.002/assets/brand-icons/product/png/office_48x2.png",O=Object(l.a)().fontSizeHero900,T=Object(d.useRef)(null);return Object(d.useImperativeHandle)(t,(function(){return{set:function(e){var t=e.height,n=e.width;t=m(_,t),n=v(A,n),I({height:t,width:n})}}})),Object(d.useEffect)((function(){I({height:m(_,u.height),width:v(A,u.width)})}),[_,A,u.height,u.width]),u&&0!==E.height&&0!==E.width?h.a.createElement(i.a,null,h.a.createElement("div",{className:"TaskModuleDialogControl-module__task-module-page-overlay__XSR56"},h.a.createElement("div",{className:p()("ms-bgc-nd","TaskModuleDialogControl-module__task-module-page-overlay__background__FdmG7")}),h.a.createElement("div",{ref:T,style:{minWidth:E.width,minHeight:E.height},className:p()("ms-bgc-w",b?"TaskModuleDialogControl-module__task-module-dialog-no-header__3fbcP":"TaskModuleDialogControl-module__task-module-dialog__2c5nq"),"data-testid":b?"task-module-dialog-no-header":"task-module-dialog",role:"dialog","aria-label":u.title},h.a.createElement("div",{className:p()("ms-fcl-nd","TaskModuleDialogControl-module__task-module-dialog-dismiss-x__3b7SM")},h.a.createElement(s.a,{iconName:a.a.ChromeClose,onClick:f,tabIndex:0,title:S.closeIconText,iconClass:"ms-fcl-nd"})),!b&&h.a.createElement(h.a.Fragment,null,h.a.createElement("div",{className:p()("TaskModuleDialogControl-module__task-module-dialog-header__1H_us")},h.a.createElement(o.a,{className:p()("TaskModuleDialogControl-module__task-module-dialog__header-icon__jj4NT"),src:P,alt:S.applicationLogoAlt,height:O,width:O}),h.a.createElement("span",{id:"task-module-dialog__header-text",className:p()("ms-fcl-ns","TaskModuleDialogControl-module__task-module-dialog__header-text__3npLq")},h.a.createElement("h3",{id:"task-module-dialog__app-name",className:p()("ms-fcl-ns","TaskModuleDialogControl-module__task-module-dialog__app-name__1SRqa")},g),h.a.createElement("span",{id:"task-module-dialog__task-title",className:p()("ms-fcl-ns","TaskModuleDialogControl-module__task-module-dialog__task-title__mOR9H")},u.title)))),h.a.createElement("div",{className:p()("ms-fcl-nd",b?"TaskModuleDialogControl-module__task-module-dialog-content-no-header__3rbdz":"TaskModuleDialogControl-module__task-module-dialog-content__3QIqi")},h.a.createElement("div",{className:"TaskModuleDialogControl-module__task-module-mos-app-container-extender__11BdS"},n))))):null}));y.displayName="TaskModuleDialogControl"},"+fvi":function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return h})),n.d(t,"b",(function(){return f})),n.d(t,"g",(function(){return g})),n.d(t,"f",(function(){return m})),n.d(t,"e",(function(){return v})),n.d(t,"d",(function(){return y}));var r=n("QjXU"),i=n("FtiY"),o=n("FPnS"),a=n("AlWG"),s=n("dpyN"),l=n("kAGr"),c=new a.a(i.a),u=new a.a(o.a.default),p=new a.a(void 0),d=c.asObservable(),h=u.asObservable().pipe(Object(s.a)()),f=p.asObservable().pipe(Object(s.a)()),g=i.a,m=o.a.default,v=void 0;function y(e,t,i){return void 0===t&&(t=!1),void 0===i&&(i=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){var o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(l.a)(e)];case 1:return o=r.sent(),t?[4,Promise.all([n.e(10),n.e(176)]).then(n.bind(null,"EBLj")).then((function(t){return t.loadLegacyFabricTheme(e)}))]:[3,3];case 2:r.sent(),r.label=3;case 3:return i?[4,n.e(586).then(n.bind(null,"LPeS")).then((function(t){return t.loadLegacyOfficeTheme(e)}))]:[3,5];case 4:r.sent(),r.label=5;case 5:return g=o,c.next(o),m=e.mode,u.next(e.mode),v=e.themeId,p.next(e.themeId),[2,o]}}))}))}},"+sqR":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("QjXU"),i=n("mXGw"),o=n("+fvi");function a(){var e=Object(r.__read)(Object(i.useState)(o.g),2),t=e[0],n=e[1];return Object(i.useEffect)((function(){var e=o.a.subscribe(n);return ),[]),t}},"0bKW":"163P":"1ceF":function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.formatText=void 0;var i=),o=i),a=i);t.formatText=function(e,t){for(var n=t,r=0,i=[new o(/\{{2}DATE\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))(?:, ?(COMPACT|LONG|SHORT))?\)\}{2}/g),new a(/\{{2}TIME\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))\)\}{2}/g)];r<i.length;r++)n=i[r].format(e,n);return n}},"2lF6":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelAdapter=void 0;var r=);t.ChannelAdapter=r},"2y7E":function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u}));var r=n("QjXU"),i=n("a3FV"),o=n("ORuF"),a=n("Cd0O"),s=n("CMIS"),l=n("c/bn");function c(e,t,a,c,h){void 0===c&&(c="office-start-resources");var f=null==t?void 0:t.toLowerCase(),g=f&&o,m=function(e){return void 0===e&&(e="office-start-resources"),Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i,o,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:i=0,o=3,r.label=1;case 1:if(!(i<o))return[3,6];r.label=2;case 2:return r.trys.push([2,4,,5]),i++,[4,n("i8/d")("./".concat(e,".json"))];case 3:return[2,r.sent().default];case 4:return a=r.sent(),i>=o&&(t="Failed to import ".concat(e," after ").concat(o," attempts.\n\nError: ").concat(a)),[3,5];case 5:return[3,1];case 6:throw Object(s.a)({eventName:"GetDefaultResources_Error",errorType:"LocStrings_Error",message:t}),new Error(t)}}))}))}(c).then((function(e){var t,n;return(null===(n=null===(t=null==h?void 0:h.result)||void 0===t?void 0:t.m365StringLogoGates)||void 0===n?void 0:n.m365StringLogoEnabled)?p(e):e}));if(!g)return Promise.resolve(m);if("en"===(f=function(e,t){if(e=u(e),o[d(t,e)])return e;var n=Object(r.__read)(e.split("-"),1)[0];return o[d(t,n)]?n:"default"}(f,c))||"default"===f)return Promise.resolve(m);var v={method:"GET",responseType:"json",url:"https://".concat(e,"/").concat(a,"/").concat(o[d(c,f)])};return Object(l.a)(i.a.ResourceStringsFetch,"Resource_Strings_Fetch",v).then((function(e){var t,n,r=e.data;return(null===(n=null===(t=null==h?void 0:h.result)||void 0===t?void 0:t.m365StringLogoGates)||void 0===n?void 0:n.m365StringLogoEnabled)?Promise.resolve(p(r)):r})).catch(()}function u(e){return a&&a[e]&&(e=a[e]),e}function p(e){var t={},n=function(n){if(e.hasOwnProperty(n)){var i=e[n],o=Object(r.__assign)({},i);Object.keys(i).filter(().forEach((),t[n]=o}};for(var i in e)n(i);return t},"4l53":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("QjXU"),i=n("n41H"),o=n("JX2s"),a=n("ihDz"),s=l=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return e?[4,Object(o.a)()]:[2,void 0];case 1:return n.sent(),(t=s(e))?[3,3]:[4,Object(i.b)()];case 2:n.sent(),t=s(e),n.label=3;case 3:return[2,t]}}))}))}},"5ANk":function(e,t,n){"use strict";.d(t,"a",(function(){return r}))},"5RAF":function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__decorate||o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,s)}l((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.ContainerWithActions=t.ColumnSet=t.Column=t.Container=t.BackgroundImage=t.ContainerBase=t.StylableCardElementContainer=t.ContainerStyleProperty=t.ActionSet=t.ShowCardAction=t.HttpAction=t.HttpHeader=t.ToggleVisibilityAction=t.OpenUrlAction=t.ExecuteAction=t.SubmitAction=t.SubmitActionBase=t.Action=t.TimeInput=t.TimeProperty=t.DateInput=t.NumberInput=t.ChoiceSetInput=t.Choice=t.ToggleInput=t.TextInput=t.Input=t.Media=t.YouTubePlayer=t.DailymotionPlayer=t.VimeoPlayer=t.IFrameMediaMediaPlayer=t.CustomMediaPlayer=t.HTML5MediaPlayer=t.MediaPlayer=t.MediaSource=t.CaptionSource=t.ContentSource=t.ImageSet=t.CardElementContainer=t.Image=t.FactSet=t.Fact=t.RichTextBlock=t.TextRun=t.TextBlock=t.BaseTextBlock=t.ActionProperty=t.CardElement=t.renderSeparation=void 0,t.SerializationContext=t.AdaptiveCard=t.Authentication=t.TokenExchangeResource=t.AuthCardButton=t.RefreshDefinition=t.RefreshActionProperty=void 0;var s=n("oZqk"),l=n("oxya"),c=n("D7YB"),u=n("Y59c"),p=n("1ceF"),d=n("amm4"),h=n("IpoZ"),f=n("uv1U"),g=n("vh9v"),m=n("qmTf");renderSeparation=y;var b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._truncatedDueToOverflow=!1,t}return r(t,e),Object.defineProperty(t.prototype,"lang",{get:function(){return this.getValue(t.langProperty)||(this.parent?this.parent.lang:void 0)},set:function(e){this.setValue(t.langProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isVisible",{get:function(){return this.getValue(t.isVisibleProperty)},set:enumerable:!1,configurable:!0}),t.prototype.internalRenderSeparator=t.prototype.updateRenderedElementVisibility=t.prototype.hideElementDueToOverflow=t.prototype.showElementHiddenDueToOverflow=t.prototype.handleOverflow=t.prototype.resetOverflow=t.prototype.getDefaultSerializationContext=function(){return new Te},t.prototype.createPlaceholderElement=t.prototype.adjustRenderedElementSize=function(e){e.style.flex="auto"===this.height?"0 0 auto":"1 1 auto"},t.prototype.isDisplayed=t.prototype.overrideInternalRender=function(){return this.internalRender()},t.prototype.applyPadding=t.prototype.truncateOverflow=function(e){return!1},t.prototype.undoOverflowTruncation=function(){},t.prototype.getDefaultPadding=t.prototype.getHasBackground=t.prototype.getHasBorder=function(){return!1},t.prototype.getPadding=function(){return this._padding},t.prototype.setPadding=function(e){this._padding=e},t.prototype.shouldSerialize=function(e){return void 0!==e.elementRegistry.findByName(this.getJsonTypeName())},Object.defineProperty(t.prototype,"useDefaultSizing",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"separatorOrientation",{get:function(){return s.Orientation.Horizontal},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"defaultStyle",{get:function(){return s.ContainerStyle.Default},enumerable:!1,configurable:!0}),t.prototype.parse=t.prototype.asString=function(){return""},t.prototype.isBleeding=function(){return!1},t.prototype.getEffectiveStyle=t.prototype.getEffectiveStyleDefinition=t.prototype.getEffectiveTextStyleDefinition=t.prototype.getForbiddenActionTypes=function(){return[]},t.prototype.getImmediateSurroundingPadding=t.prototype.getActionCount=function(){return 0},t.prototype.getActionAt=t.prototype.indexOfAction=t.prototype.remove=t.prototype.render=t.prototype.updateLayout=t.prototype.updateActionsEnabledState=function(){for(var e=0,t=this.getRootElement().getAllActions();e<t.length;e++)t[e].updateEnabledState()},t.prototype.indexOf=t.prototype.isDesignMode=t.prototype.isFirstElement=function(e){return!0},t.prototype.isLastElement=function(e){return!0},t.prototype.isAtTheVeryLeft=function(){return!this.parent||this.parent.isLeftMostElement(this)&&this.parent.isAtTheVeryLeft()},t.prototype.isAtTheVeryRight=function(){return!this.parent||this.parent.isRightMostElement(this)&&this.parent.isAtTheVeryRight()},t.prototype.isAtTheVeryTop=function(){return!this.parent||this.parent.isFirstElement(this)&&this.parent.isAtTheVeryTop()},t.prototype.isAtTheVeryBottom=t.prototype.isBleedingAtTop=function(){return!1},t.prototype.isBleedingAtBottom=function(){return!1},t.prototype.isLeftMostElement=function(e){return!0},t.prototype.isRightMostElement=function(e){return!0},t.prototype.isTopElement=function(e){return this.isFirstElement(e)},t.prototype.isBottomElement=t.prototype.isHiddenDueToOverflow=t.prototype.getRootElement=function(){return this.getRootObject()},t.prototype.getParentContainer=t.prototype.getAllInputs=t.prototype.getAllActions=t.prototype.getResourceInformation=function(){return[]},t.prototype.getElementById=t.prototype.getActionById=function(e){},t.prototype.getEffectivePadding=t.prototype.getEffectiveHorizontalAlignment=Object.defineProperty(t.prototype,"hostConfig",{get:set:function(e){this._hostConfig=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"index",{get:enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInteractive",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInline",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return!(!this.parent||!this.separatorElement)&&!this.parent.isFirstElement(this)&&(this.isVisible||this.isDesignMode())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"separatorElement",{get:function(){return this._separatorElement},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),t.prototype.getElementSingletonBehavior=t.langProperty=new h.StringProperty(h.Versions.v1_1,"lang",!0,/^[a-z]{2,3}$/gi),t.isVisibleProperty=new h.BoolProperty(h.Versions.v1_2,"isVisible",!0),t.separatorProperty=new h.BoolProperty(h.Versions.v1_0,"separator",!1),t.heightProperty=new h.ValueSetProperty(h.Versions.v1_1,"height",[{value:"auto"},{value:"stretch"}],"auto"),t.horizontalAlignmentProperty=new h.EnumProperty(h.Versions.v1_0,"horizontalAlignment",s.HorizontalAlignment),t.spacingProperty=new h.EnumProperty(h.Versions.v1_0,"spacing",s.Spacing,s.Spacing.Default),i([(0,h.property)(t.horizontalAlignmentProperty)],t.prototype,"horizontalAlignment",void 0),i([(0,h.property)(t.spacingProperty)],t.prototype,"spacing",void 0),i([(0,h.property)(t.separatorProperty)],t.prototype,"separator",void 0),i([(0,h.property)(t.heightProperty)],t.prototype,"height",void 0),i([(0,h.property)(t.langProperty)],t.prototype,"lang",null),i([(0,h.property)(t.isVisibleProperty)],t.prototype,"isVisible",null),t}(d.CardObject);t.CardElement=b;var S=function(e){eturn r(t,e),t.prototype.parse=function(e,t,n){return n.parseAction(e,t[this.name],this.forbiddenActionTypes,e.isDesignMode())},t.prototype.toJSON=t}(h.PropertyDefinition);t.ActionProperty=S;var C=b);t.BaseTextBlock=C;var _=function(e){ar n,o;return r(t,e),t.prototype.restoreOriginalContent=t.prototype.truncateIfSupported=function(e){if(void 0!==this.renderedElement){var t=this.renderedElement.children,n=!t.length;if(n||1===t.length&&"p"===t[0].tagName.toLowerCase()&&!t[0].children.length)return c.truncateText(n?this.renderedElement:t[0],e,this._computedLineHeight),!0}return!1},t.prototype.setText=t.prototype.internalRender=function(){var e,n,r=this;if(this._processedText=void 0,this.text){var i=this.preProcessPropertyValue(C.textProperty),o=this.hostConfig,a=void 0;if(this.forElementId){var s=document.createElement("label");s.htmlFor=this.forElementId,a=s}else a=document.createElement("div");if(a.classList.add(o.makeCssClassName("ac-textBlock")),a.style.overflow="hidden",this.applyStylesTo(a),"heading"===this.style){a.setAttribute("role","heading");var u=this.hostConfig.textBlock.headingLevel;void 0!==u&&u>0&&a.setAttribute("aria-level",u.toString())}if(this.selectAction&&o.supportsInteractivity&&(a.onclick=function(e){r.selectAction&&r.selectAction.isEffectivelyEnabled()&&(e.preventDefault(),e.cancelBubble=!0,r.selectAction.execute())},this.selectAction.setupElementForAccessibility(a),this.selectAction.isEffectivelyEnabled()&&a.classList.add(o.makeCssClassName("ac-selectable"))),!this._processedText){this._treatAsPlainText=!0;var d=p.formatText(this.lang,i);if(this.useMarkdown&&d){l.GlobalSettings.allowMarkForTextHighlighting&&(d=d.replace(/<mark>/g,"===").replace(/<\/mark>/g,"/==/"));var h=Pe.applyMarkdown(d);if(h.didProcess&&h.outputHtml){if(this._processedText=h.outputHtml,this._treatAsPlainText=!1,l.GlobalSettings.allowMarkForTextHighlighting&&this._processedText){var f="",g=this.getEffectiveStyleDefinition();g.highlightBackgroundColor&&(f+="background-color: "+g.highlightBackgroundColor+";"),g.highlightForegroundColor&&(f+="color: "+g.highlightForegroundColor+";"),f&&(f='style="'+f+'"'),this._processedText=this._processedText.replace(/===/g,"<mark "+f+">").replace(/\/==\//g,"</mark>")}}else this._processedText=d,this._treatAsPlainText=!0}else this._processedText=d,this._treatAsPlainText=!0}if(this._processedText||(this._processedText=""),this._treatAsPlainText)a.innerText=this._processedText;else{var m=null!==(n=null===(e=t._ttMarkdownPolicy)||void 0===e?void 0:e.createHTML(this._processedText))&&void 0!==n?n:this._processedText;a.innerHTML=m}if(a.firstElementChild instanceof HTMLElement){var v=a.firstElementChild;v.style.marginTop="0px",v.style.width="100%",this.wrap||(v.style.overflow="hidden",v.style.textOverflow="ellipsis")}a.lastElementChild instanceof HTMLElement&&(a.lastElementChild.style.marginBottom="0px");for(var y=a.getElementsByTagName("a"),b=S=0,_=Array.from(y);S<_.length;S++)b(_[S]);return this.wrap?(a.style.wordWrap="break-word",this.maxLines&&this.maxLines>0&&(a.style.overflow="hidden",c.isInternetExplorer()||!l.GlobalSettings.useWebkitLineClamp?a.style.maxHeight=this._computedLineHeight*this.maxLines+"px":(a.style.removeProperty("line-height"),a.style.display="-webkit-box",a.style.webkitBoxOrient="vertical",a.style.webkitLineClamp=this.maxLines.toString()))):(a.style.whiteSpace="nowrap",a.style.textOverflow="ellipsis"),(l.GlobalSettings.useAdvancedTextBlockTruncation||l.GlobalSettings.useAdvancedCardBottomTruncation)&&(this._originalInnerHtml=a.innerHTML),a}},t.prototype.truncateOverflow=t.prototype.undoOverflowTruncation=function(){this.restoreOriginalContent(),l.GlobalSettings.useAdvancedTextBlockTruncation&&this.maxLines&&this.truncateIfSupported(this._computedLineHeight*this.maxLines)},t.prototype.applyStylesTo=t.prototype.getJsonTypeName=function(){return"TextBlock"},t.prototype.getEffectiveTextStyleDefinition=t.prototype.updateLayout=t.wrapProperty=new h.BoolProperty(h.Versions.v1_0,"wrap",!1),t.maxLinesProperty=new h.NumProperty(h.Versions.v1_0,"maxLines"),t.styleProperty=new h.ValueSetProperty(h.Versions.v1_5,"style",[{value:"default"},{value:"columnHeader"},{value:"heading"}]),t._ttMarkdownPolicy="undefined"==typeof window||null===(n=window.trustedTypes)||void 0===n?void 0:n.createPolicy("adaptivecards#markdownPassthroughPolicy",{createHTML:function(e){return e}}),t._ttRoundtripPolicy="undefined"==typeof window||null===(o=window.trustedTypes)||void 0===o?void 0:o.createPolicy("adaptivecards#restoreContentsPolicy",{createHTML:),i([(0,h.property)(t.wrapProperty)],t.prototype,"wrap",void 0),i([(0,h.property)(t.maxLinesProperty)],t.prototype,"maxLines",void 0),i([(0,h.property)(t.styleProperty)],t.prototype,"style",void 0),t}(C);t.TextBlock=_;var A=C);t.TextRun=A;var w=function(e){eturn r(t,e),t.prototype.internalAddInline=function(e,t){if(void 0===t&&(t=!1),!e.isInline)throw new Error(g.Strings.errors.elementCannotBeUsedAsInline());if(void 0!==e.parent&&!t&&e.parent!==this)throw new Error(g.Strings.errors.inlineAlreadyParented());e.setParent(this),this._inlines.push(e)},t.prototype.internalParse=t.prototype.internalToJSON=function(t,n){if(e.prototype.internalToJSON.call(this,t,n),this._inlines.length>0){for(var r=[],i=0,o=this._inlines;i<o.length;i++)r.push(o[i].toJSON(n));n.serializeValue(t,"inlines",r)}},t.prototype.internalRender=t.prototype.asString=t.prototype.getJsonTypeName=function(){return"RichTextBlock"},t.prototype.getInlineCount=function(){return this._inlines.length},t.prototype.getInlineAt=t.prototype.addInline=function(e){this.internalAddInline("string"==typeof e?new A(e):e)},t.prototype.removeInline=t}(b);t.RichTextBlock=w;var E=function(e){function t(t,n){var r=e.call(this)||this;return r.name=t,r.value=n,r}return r(t,e),t.prototype.getSchemaKey=function(){return"Fact"},t.titleProperty=new h.StringProperty(h.Versions.v1_0,"title"),t.valueProperty=new h.StringProperty(h.Versions.v1_0,"value"),i([(0,h.property)(t.titleProperty)],t.prototype,"name",void 0),i([(0,h.property)(t.valueProperty)],t.prototype,"value",void 0),t}(h.SerializableObject);t.Fact=E;var I=b);t.FactSet=I;var P=h.PropertyDefinition),O=function(e){eturn r(t,e),t.prototype.populateSchema=t.prototype.applySize=Object.defineProperty(t.prototype,"useDefaultSizing",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.internalRender=function(){var e=this,n=void 0;if(this.url){(n=document.createElement("div")).style.display="flex",n.style.alignItems="flex-start";var r=this.hostConfig;switch(this.getEffectiveHorizontalAlignment()){case s.HorizontalAlignment.Center:n.style.justifyContent="center";break;case s.HorizontalAlignment.Right:n.style.justifyContent="flex-end";break;default:n.style.justifyContent="flex-start"}var i=document.createElement("img");i.onload=function(t){ve(e)},i.onerror=function(t){if(e.renderedElement){var n=e.getRootElement();if(n&&n.designMode){var r=document.createElement("div");r.style.display="flex",r.style.alignItems="center",r.style.justifyContent="center",r.style.backgroundColor="#EEEEEE",r.style.color="black",r.innerText=":-(",r.style.padding="10px",e.applySize(r),e.renderedElement.appendChild(r)}}ve(e)},i.style.minWidth="0",i.classList.add(r.makeCssClassName("ac-image")),this.selectAction&&r.supportsInteractivity&&(i.onkeypress=function(t){e.selectAction&&e.selectAction.isEffectivelyEnabled()&&("Enter"===t.code||"Space"===t.code)&&(t.preventDefault(),t.cancelBubble=!0,e.selectAction.execute())},i.onclick=function(t){e.selectAction&&e.selectAction.isEffectivelyEnabled()&&(t.preventDefault(),t.cancelBubble=!0,e.selectAction.execute())},this.selectAction.setupElementForAccessibility(i),this.selectAction.isEffectivelyEnabled()&&i.classList.add(r.makeCssClassName("ac-selectable"))),this.applySize(i),this.style===s.ImageStyle.Person&&(i.style.borderRadius="50%",i.style.backgroundPosition="50% 50%",i.style.backgroundRepeat="no-repeat");var o=c.stringToCssColor(this.backgroundColor);o&&(i.style.backgroundColor=o),i.src=this.preProcessPropertyValue(t.urlProperty);var a=this.preProcessPropertyValue(t.altTextProperty);a&&(i.alt=a),n.appendChild(i)}return n},t.prototype.getJsonTypeName=function(){return"Image"},t.prototype.getAllActions=function(){var t=e.prototype.getAllActions.call(this);return this.selectAction&&t.push(this.selectAction),t},t.prototype.getActionById=function(t){var n=e.prototype.getActionById.call(this,t);return!n&&this.selectAction&&(n=this.selectAction.getActionById(t)),n},t.prototype.getResourceInformation=t.urlProperty=new h.StringProperty(h.Versions.v1_0,"url"),t.altTextProperty=new h.StringProperty(h.Versions.v1_0,"altText"),t.backgroundColorProperty=new h.StringProperty(h.Versions.v1_1,"backgroundColor"),t.styleProperty=new h.EnumProperty(h.Versions.v1_0,"style",s.ImageStyle,s.ImageStyle.Default),t.sizeProperty=new h.EnumProperty(h.Versions.v1_0,"size",s.Size,s.Size.Auto),t.pixelWidthProperty=new P(h.Versions.v1_1,"width","pixelWidth"),t.pixelHeightProperty=new P(h.Versions.v1_1,"height","pixelHeight",b.heightProperty),t.selectActionProperty=new S(h.Versions.v1_1,"selectAction",["Action.ShowCard"]),i([(0,h.property)(t.urlProperty)],t.prototype,"url",void 0),i([(0,h.property)(t.altTextProperty)],t.prototype,"altText",void 0),i([(0,h.property)(t.backgroundColorProperty)],t.prototype,"backgroundColor",void 0),i([(0,h.property)(t.sizeProperty)],t.prototype,"size",void 0),i([(0,h.property)(t.styleProperty)],t.prototype,"style",void 0),i([(0,h.property)(t.pixelWidthProperty)],t.prototype,"pixelWidth",void 0),i([(0,h.property)(t.pixelHeightProperty)],t.prototype,"pixelHeight",void 0),i([(0,h.property)(t.selectActionProperty)],t.prototype,"selectAction",void 0),t}(b);t.Image=O;var T=b);t.CardElementContainer=T;var k=T);t.ImageSet=k;var x=h.SerializableObject);t.ContentSource=x;var j=x);t.CaptionSource=j;var D=x);t.MediaSource=D;var R=);t.MediaPlayer=R;var H=function(e){eturn r(t,e),t.prototype.processSources=t.prototype.canPlay=t.prototype.fetchVideoDetails=t.prototype.render=function(){this._mediaElement="video"===this._selectedMediaType?document.createElement("video"):document.createElement("audio"),this._mediaElement.setAttribute("aria-label",this.owner.altText?this.owner.altText:g.Strings.defaults.mediaPlayerAriaLabel()),this._mediaElement.setAttribute("webkit-playsinline",""),this._mediaElement.setAttribute("playsinline",""),this._mediaElement.setAttribute("crossorigin",""),this._mediaElement.autoplay=!0,this._mediaElement.controls=!0,c.isMobileOS()&&(this._mediaElement.muted=!0),this._mediaElement.preload="none",this._mediaElement.style.width="100%";for(var e=0,t=this.owner.sources;e<t.length;e++){var n=t[e].render();c.appendChild(this._mediaElement,n)}for(var r=0,i=this.owner.captionSources;r<i.length;r++){var o=i[r];if("vtt"==o.mimeType){var a=o.render();c.appendChild(this._mediaElement,a)}}return this._mediaElement},t.prototype.play=function(){this._mediaElement&&this._mediaElement.play()},Object.defineProperty(t.prototype,"selectedMediaType",{get:function(){return this._selectedMediaType},enumerable:!1,configurable:!0}),t.supportedMediaTypes=["audio","video"],t}(R);t.HTML5MediaPlayer=H;var N=R);t.CustomMediaPlayer=N;var V=N);t.IFrameMediaMediaPlayer=V;var L=V);t.VimeoPlayer=L;var M=V);t.DailymotionPlayer=M;var F=V);t.YouTubePlayer=F;var B=function(e){eturn r(t,e),t.prototype.createMediaPlayer=t.prototype.handlePlayButtonInvoke=t.prototype.displayPoster=function(){return o(this,void 0,void 0,(function(){var e,t,n,r,i,o,s=this;return a(this,(function(a){return this.renderedElement&&((e=document.createElement("div")).className=this.hostConfig.makeCssClassName("ac-media-poster"),e.setAttribute("role","contentinfo"),e.setAttribute("aria-label",this.altText?this.altText:g.Strings.defaults.mediaPlayerAriaLabel()),e.style.position="relative",e.style.display="flex",(t=this.poster?this.poster:this._mediaPlayer.posterUrl)||(t=this.hostConfig.media.defaultPoster),t?((n=document.createElement("img")).style.width="100%",n.style.height="100%",n.setAttribute("role","presentation"),n.onerror=n.src=t,e.appendChild(n)):(e.classList.add("empty"),e.style.minHeight="150px"),this.hostConfig.supportsInteractivity&&this._mediaPlayer.canPlay()&&((r=document.createElement("div")).tabIndex=0,r.setAttribute("role","button"),r.setAttribute("aria-label",g.Strings.defaults.mediaPlayerPlayMedia()),r.className=this.hostConfig.makeCssClassName("ac-media-playButton"),r.style.display="flex",r.style.alignItems="center",r.style.justifyContent="center",r.onclick=r.onkeypress=(i=document.createElement("div")).className=this.hostConfig.makeCssClassName("ac-media-playButton-arrow"),i.style.width="12px",i.style.height="15px",i.style.borderTopWidth="7.5px",i.style.borderBottomWidth="7.5px",i.style.borderLeftWidth="12px",i.style.borderRightWidth="0",i.style.borderStyle="solid",i.style.borderTopColor="transparent",i.style.borderRightColor="transparent",i.style.borderBottomColor="transparent",i.style.transform="translate(1.2px,0px)",r.appendChild(i),(o=document.createElement("div")).style.position="absolute",o.style.left="0",o.style.top="0",o.style.width="100%",o.style.height="100%",o.style.display="flex",o.style.justifyContent="center",o.style.alignItems="center",o.appendChild(r),e.appendChild(o)),v(this.renderedElement),this.renderedElement.appendChild(e)),[2]}))}))},t.prototype.internalRender=t.prototype.render=t.prototype.releaseDOMResources=t.prototype.getJsonTypeName=function(){return"Media"},t.prototype.getResourceInformation=Object.defineProperty(t.prototype,"selectedMediaType",{get:function(){return this._mediaPlayer.selectedMediaType},enumerable:!1,configurable:!0}),t.customMediaPlayers=[{urlPatterns:[/^(?:https?:\/\/)?(?:www.)?youtube.com\/watch\?(?=.*v=([\w\d-_]+))(?=(?:.*t=(\d+))?).*/gi,/^(?:https?:\/\/)?youtu.be\/([\w\d-_]+)(?:\?t=(\d+))?/gi],createMediaPlayer:function(e){return new F(e,g.Strings.defaults.youTubeVideoPlayer())}},{urlPatterns:[/^(?:https?:\/\/)?vimeo.com\/([\w\d-_]+).*/gi],createMediaPlayer:function(e){return new L(e,g.Strings.defaults.vimeoVideoPlayer())}},{urlPatterns:[/^(?:https?:\/\/)?(?:www.)?dailymotion.com\/video\/([\w\d-_]+).*/gi],createMediaPlayer:],t.sourcesProperty=new h.SerializableObjectCollectionProperty(h.Versions.v1_1,"sources",D),t.captionSourcesProperty=new h.SerializableObjectCollectionProperty(h.Versions.v1_6,"captionSources",j),t.posterProperty=new h.StringProperty(h.Versions.v1_1,"poster"),t.altTextProperty=new h.StringProperty(h.Versions.v1_1,"altText"),i([(0,h.property)(t.sourcesProperty)],t.prototype,"sources",void 0),i([(0,h.property)(t.captionSourcesProperty)],t.prototype,"captionSources",void 0),i([(0,h.property)(t.posterProperty)],t.prototype,"poster",void 0),i([(0,h.property)(t.altTextProperty)],t.prototype,"altText",void 0),t}(b);t.Media=B;var z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getAllLabelIds=t.prototype.updateInputControlAriaLabelledBy=Object.defineProperty(t.prototype,"isNullable",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderedInputControlElement",{get:function(){return this._renderedInputControlElement},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inputControlContainerElement",{get:function(){return this._inputControlContainerElement},enumerable:!1,configurable:!0}),t.prototype.overrideInternalRender=t.prototype.valueChanged=function(){this.getRootElement().updateActionsEnabledState(),this.isValid()&&this.resetValidationFailureCue(),this.onValueChanged&&this.onValueChanged(this),function(e){var t=e.getRootElement(),n=t&&t.onInputValueChanged?t.onInputValueChanged:Pe.onInputValueChanged;n&&n(e)}(this)},t.prototype.resetValidationFailureCue=t.prototype.showValidationErrorMessage=t.prototype.focus=function(){this._renderedInputControlElement&&this._renderedInputControlElement.focus()},t.prototype.isValid=function(){return!0},t.prototype.isDirty=t.prototype.resetDirtyState=t.prototype.internalValidateProperties=t.prototype.validateValue=t.prototype.getAllInputs=t.prototype.render=Object.defineProperty(t.prototype,"isInteractive",{get:function(){return!0},enumerable:!1,configurable:!0}),t.labelProperty=new h.StringProperty(h.Versions.v1_3,"label",!0),t.isRequiredProperty=new h.BoolProperty(h.Versions.v1_3,"isRequired",!1),t.errorMessageProperty=new h.StringProperty(h.Versions.v1_3,"errorMessage",!0),i([(0,h.property)(t.labelProperty)],t.prototype,"label",void 0),i([(0,h.property)(t.isRequiredProperty)],t.prototype,"isRequired",void 0),i([(0,h.property)(t.errorMessageProperty)],t.prototype,"errorMessage",void 0),t}(b);t.Input=z;var U=function(e){eturn r(t,e),t.prototype.setupInput=t.prototype.internalRender=t.prototype.overrideInternalRender=t.prototype.getJsonTypeName=function(){return"Input.Text"},t.prototype.getAllActions=t.prototype.getActionById=t.prototype.isSet=function(){return!!this.value},t.prototype.isValid=function(){return!this.value||!this.regex||new RegExp(this.regex,"g").test(this.value)},Object.defineProperty(t.prototype,"value",{get:function(){return this.renderedInputControlElement?this.renderedInputControlElement.value:void 0},enumerable:!1,configurable:!0}),t.valueProperty=new h.StringProperty(h.Versions.v1_0,"value"),t.maxLengthProperty=new h.NumProperty(h.Versions.v1_0,"maxLength"),t.isMultilineProperty=new h.BoolProperty(h.Versions.v1_0,"isMultiline",!1),t.placeholderProperty=new h.StringProperty(h.Versions.v1_0,"placeholder"),t.styleProperty=new h.EnumProperty(h.Versions.v1_0,"style",s.InputTextStyle,s.InputTextStyle.Text,[{value:s.InputTextStyle.Text},{value:s.InputTextStyle.Tel},{value:s.InputTextStyle.Url},{value:s.InputTextStyle.Email},{value:s.InputTextStyle.Password,targetVersion:h.Versions.v1_5}]),t.inlineActionProperty=new S(h.Versions.v1_0,"inlineAction",["Action.ShowCard"]),t.regexProperty=new h.StringProperty(h.Versions.v1_3,"regex",!0),i([(0,h.property)(t.valueProperty)],t.prototype,"defaultValue",void 0),i([(0,h.property)(t.maxLengthProperty)],t.prototype,"maxLength",void 0),i([(0,h.property)(t.isMultilineProperty)],t.prototype,"isMultiline",void 0),i([(0,h.property)(t.placeholderProperty)],t.prototype,"placeholder",void 0),i([(0,h.property)(t.styleProperty)],t.prototype,"style",void 0),i([(0,h.property)(t.inlineActionProperty)],t.prototype,"inlineAction",void 0),i([(0,h.property)(t.regexProperty)],t.prototype,"regex",void 0),t}(z);t.TextInput=U;var W=z);t.ToggleInput=W;var q=h.SerializableObject);t.Choice=q;var G=function(e){eturn r(t,e),Object.defineProperty(t.prototype,"isCompact",{get:set:enumerable:!1,configurable:!0}),t.getUniqueCategoryName=t.prototype.internalApplyAriaCurrent=t.prototype.renderCompoundInput=t.prototype.updateInputControlAriaLabelledBy=t.prototype.internalRender=function(){var e=this;if(this._uniqueCategoryName=t.getUniqueCategoryName(),this.isMultiSelect)return this.renderCompoundInput("ac-choiceSetInput-multiSelect","checkbox",this.defaultValue?this.defaultValue.split(this.hostConfig.choiceSetInputValueSeparator):void 0);if("expanded"===this.style)return this.renderCompoundInput("ac-choiceSetInput-expanded","radio",this.defaultValue?[this.defaultValue]:void 0);if("filtered"===this.style){var n=document.createElement("div");n.style.width="100%",this._textInput=document.createElement("input"),this._textInput.className=this.hostConfig.makeCssClassName("ac-input","ac-multichoiceInput","ac-choiceSetInput-filtered"),this._textInput.type="text",this._textInput.style.width="100%",this._textInput.oninput=this.defaultValue&&(this._textInput.value=this.defaultValue),this.placeholder&&!this._textInput.value&&(this._textInput.placeholder=this.placeholder,this._textInput.setAttribute("aria-label",this.placeholder)),this._textInput.tabIndex=this.isDesignMode()?-1:0;var r=document.createElement("datalist");r.id=c.generateUniqueId();for(var i=0,o=this.choices;i<o.length;i++){var a=o[i],s=document.createElement("option");a.title&&(s.value=a.title,s.setAttribute("aria-label",a.title)),s.tabIndex=this.isDesignMode()?-1:0,r.appendChild(s)}return this._textInput.setAttribute("list",r.id),n.append(this._textInput,r),n}this._selectElement=document.createElement("select"),this._selectElement.className=this.hostConfig.makeCssClassName("ac-input","ac-multichoiceInput","ac-choiceSetInput-compact"),this._selectElement.style.width="100%",this._selectElement.tabIndex=this.isDesignMode()?-1:0;var l=document.createElement("option");l.selected=!0,l.disabled=!0,l.hidden=!0,l.value="",this.placeholder&&(l.text=this.placeholder),c.appendChild(this._selectElement,l);for(var u=0,p=this.choices;u<p.length;u++)a=p[u],(s=document.createElement("option")).value=a.value,a.title&&(s.text=a.title,s.setAttribute("aria-label",a.title)),s.tabIndex=this.isDesignMode()?-1:0,a.value===this.defaultValue&&(s.selected=!0),c.appendChild(this._selectElement,s);return this._selectElement.onchange=this.internalApplyAriaCurrent(),this._selectElement},t.prototype.getJsonTypeName=function(){return"Input.ChoiceSet"},t.prototype.focus=t.prototype.internalValidateProperties=t.prototype.isSet=function(){return!!this.value},t.prototype.isValid=function(){if(this._textInput){if(""===this.value||this.value===this.placeholder)return!0;for(var t=0,n=this.choices;t<n.length;t++)if(this.value===n[t].value)return!0;return!1}return e.prototype.isValid.call(this)},Object.defineProperty(t.prototype,"value",{get:function(){if(this.isMultiSelect){if(!this._toggleInputs||0===this._toggleInputs.length)return;for(var e="",t=0,n=this._toggleInputs;t<n.length;t++)(l=n[t]).checked&&(""!==e&&(e+=this.hostConfig.choiceSetInputValueSeparator),e+=l.value);return e||void 0}if(this._selectElement)return this._selectElement.selectedIndex>0?this._selectElement.value:void 0;if(this._textInput){for(var r=0,i=this.choices;r<i.length;r++){var o=i[r];if(o.title&&this._textInput.value===o.title)return o.value}return this._textInput.value}if(this._toggleInputs&&this._toggleInputs.length>0)for(var a=0,s=this._toggleInputs;a<s.length;a++){var l;if((l=s[a]).checked)return l.value}},enumerable:!1,configurable:!0}),t.valueProperty=new h.StringProperty(h.Versions.v1_0,"value"),t.choicesProperty=new h.SerializableObjectCollectionProperty(h.Versions.v1_0,"choices",q),t.styleProperty=new h.ValueSetProperty(h.Versions.v1_0,"style",[{value:"compact"},{value:"expanded"},{value:"filtered",targetVersion:h.Versions.v1_5}],"compact"),t.isMultiSelectProperty=new h.BoolProperty(h.Versions.v1_0,"isMultiSelect",!1),t.placeholderProperty=new h.StringProperty(h.Versions.v1_0,"placeholder"),t.wrapProperty=new h.BoolProperty(h.Versions.v1_2,"wrap",!1),t._uniqueCategoryCounter=0,i([(0,h.property)(t.valueProperty)],t.prototype,"defaultValue",void 0),i([(0,h.property)(t.styleProperty)],t.prototype,"style",void 0),i([(0,h.property)(t.isMultiSelectProperty)],t.prototype,"isMultiSelect",void 0),i([(0,h.property)(t.placeholderProperty)],t.prototype,"placeholder",void 0),i([(0,h.property)(t.wrapProperty)],t.prototype,"wrap",void 0),i([(0,h.property)(t.choicesProperty)],t.prototype,"choices",void 0),t}(z);t.ChoiceSetInput=G;var J=z);t.NumberInput=J;var X=z);t.DateInput=X;var Z=h.CustomProperty);t.TimeProperty=Z;var K=z);t.TimeInput=K;var Y=function(e){eturn r(t,e),t.prototype.renderButtonContent=t.prototype.getParentContainer=t.prototype.isDesignMode=t.prototype.updateCssClasses=t.prototype.getDefaultSerializationContext=t.prototype.internalGetReferencedInputs=t.prototype.internalPrepareForExecution=t.prototype.internalValidateInputs=t.prototype.shouldSerialize=t.prototype.raiseExecuteActionEvent=function(){this.onExecute&&this.onExecute(this),function(e){var t=e.parent?e.parent.getRootElement():void 0,n=t&&t.onExecuteAction?t.onExecuteAction:Pe.onExecuteAction;e.prepareForExecution()&&n&&n(e)}(this)},t.prototype.internalAfterExecute=t.prototype.getHref=function(){return""},t.prototype.getAriaRole=t.prototype.setupElementForAccessibility=function(e,t){void 0===t&&(t=!1),e.tabIndex=this.isEffectivelyEnabled()&&!this.isDesignMode()?0:-1,e.setAttribute("role",this.getAriaRole()),e instanceof HTMLButtonElement&&(e.disabled=!this.isEffectivelyEnabled()),this.isEffectivelyEnabled()?(e.removeAttribute("aria-disabled"),e.classList.add(this.hostConfig.makeCssClassName("ac-selectable"))):e.setAttribute("aria-disabled","true"),this.title?(e.setAttribute("aria-label",this.title),e.title=this.title):(e.removeAttribute("aria-label"),e.removeAttribute("title")),this.tooltip&&(e.setAttribute(t?this.title?"aria-description":"aria-label":"aria-description",this.tooltip),e.title=this.tooltip)},t.prototype.parse=t.prototype.render=t.prototype.execute=t.prototype.prepareForExecution=t.prototype.remove=t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),[]},t.prototype.getAllActions=t.prototype.getResourceInformation=function(){return this.iconUrl?[{url:this.iconUrl,mimeType:"image"}]:[]},t.prototype.getActionById=function(e){return this.id===e?this:void 0},t.prototype.getReferencedInputs=function(){return this.internalGetReferencedInputs()},t.prototype.validateInputs=t.prototype.updateEnabledState=function(){},t.prototype.isEffectivelyEnabled=function(){return this.isEnabled},Object.defineProperty(t.prototype,"isPrimary",{get:set:enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hostConfig",{get:enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},set:function(e){this._state!==e&&(this._state=e,this.updateCssClasses())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFocusable",{get:function(){return this._isFocusable},set:function(e){this._isFocusable!==e&&(this._isFocusable=e,this.updateCssClasses())},enumerable:!1,configurable:!0}),t.titleProperty=new h.StringProperty(h.Versions.v1_0,"title"),t.iconUrlProperty=new h.StringProperty(h.Versions.v1_1,"iconUrl"),t.styleProperty=new h.ValueSetProperty(h.Versions.v1_2,"style",[{value:s.ActionStyle.Default},{value:s.ActionStyle.Positive},{value:s.ActionStyle.Destructive}],s.ActionStyle.Default),t.modeProperty=new h.ValueSetProperty(h.Versions.v1_5,"mode",[{value:s.ActionMode.Primary},{value:s.ActionMode.Secondary}],s.ActionMode.Primary),t.tooltipProperty=new h.StringProperty(h.Versions.v1_5,"tooltip"),t.isEnabledProperty=new h.BoolProperty(h.Versions.v1_5,"isEnabled",!0),i([(0,h.property)(t.titleProperty)],t.prototype,"title",void 0),i([(0,h.property)(t.iconUrlProperty)],t.prototype,"iconUrl",void 0),i([(0,h.property)(t.styleProperty)],t.prototype,"style",void 0),i([(0,h.property)(t.modeProperty)],t.prototype,"mode",void 0),i([(0,h.property)(t.tooltipProperty)],t.prototype,"tooltip",void 0),i([(0,h.property)(t.isEnabledProperty)],t.prototype,"isEnabled",void 0),t}(d.CardObject);t.Action=Y;var $=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.disabledUnlessAssociatedInputsChange=!1,t._isPrepared=!1,t._areReferencedInputsDirty=!1,t}return r(t,e),t.prototype.internalGetReferencedInputs=t.prototype.internalPrepareForExecution=function(e){if(this._processedData=this._originalData?JSON.parse(JSON.stringify(this._originalData)):{},this._processedData&&e)for(var t=0,n=Object.keys(e);t<n.length;t++){var r=e[n[t]];r.id&&r.isSet()&&(this._processedData[r.id]="string"==typeof r.value?r.value:r.value.toString())}this._isPrepared=!0},t.prototype.internalAfterExecute=t.prototype.resetReferencedInputsDirtyState=function(){var e=this.getReferencedInputs();if(this._areReferencedInputsDirty=!1,e)for(var t=0,n=Object.keys(e);t<n.length;t++)e[n[t]].resetDirtyState()},t.prototype.updateEnabledState=function(){this._areReferencedInputsDirty=!1;var e=this.getReferencedInputs();if(e)for(var t=0,n=Object.keys(e);t<n.length;t++)if(e[n[t]].isDirty()){this._areReferencedInputsDirty=!0;break}this.updateCssClasses(),this._renderedElement&&this.setupElementForAccessibility(this._renderedElement)},t.prototype.isEffectivelyEnabled=Object.defineProperty(t.prototype,"data",{get:function(){return this._isPrepared?this._processedData:this._originalData},set:function(e){this._originalData=e,this._isPrepared=!1},enumerable:!1,configurable:!0}),t.dataProperty=new h.PropertyDefinition(h.Versions.v1_0,"data"),t.associatedInputsProperty=new h.CustomProperty(h.Versions.v1_3,"associatedInputs",(,(function(e,t,n,r,i){i.serializeValue(n,t.name,r)})),t.disabledUnlessAssociatedInputsChangeProperty=new h.BoolProperty(h.Versions.v1_6,"disabledUnlessAssociatedInputsChange",!1),i([(0,h.property)(t.dataProperty)],t.prototype,"_originalData",void 0),i([(0,h.property)(t.associatedInputsProperty)],t.prototype,"associatedInputs",void 0),i([(0,h.property)(t.disabledUnlessAssociatedInputsChangeProperty)],t.prototype,"disabledUnlessAssociatedInputsChange",void 0),t}(Y);t.SubmitActionBase=$;var Q=$);t.SubmitAction=Q;var ee=$);t.ExecuteAction=ee;var te=Y);t.OpenUrlAction=te;var ne=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.targetElements={},t}return r(t,e),t.prototype.updateAriaControlsAttribute=t.prototype.internalValidateProperties=t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.prototype.render=function(){e.prototype.render.call(this),this.updateAriaControlsAttribute()},t.prototype.execute=function(){if(e.prototype.execute.call(this),this.parent)for(var t=0,n=Object.keys(this.targetElements);t<n.length;t++){var r=n[t],i=this.parent.getRootElement().getElementById(r);i&&(i.isVisible="boolean"==typeof this.targetElements[r]?this.targetElements[r]:!i.isVisible)}},t.prototype.addTargetElement=t.prototype.removeTargetElement=t.targetElementsProperty=new h.CustomProperty(h.Versions.v1_2,"targetElements",(,(function(e,t,n,r,i){for(var o=[],a=0,s=Object.keys(r);a<s.length;a++){var l=s[a];o.push("boolean"==typeof r[l]?{elementId:l,isVisible:r[l]}:l)}i.serializeArray(n,t.name,o)}),{},(),t.JsonTypeName="Action.ToggleVisibility",i([(0,h.property)(t.targetElementsProperty)],t.prototype,"targetElements",void 0),t}(Y);t.ToggleVisibilityAction=ne;var re=h.PropertyDefinition),ie=h.SerializableObject);t.HttpHeader=ie;var oe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._ignoreInputValidation=!1,t}return r(t,e),t.prototype.internalGetReferencedInputs=function(){var e=this.parent?this.parent.getRootElement().getAllInputs():[],t={};this._url.getReferencedInputs(e,t);for(var n=0,r=this.headers;n<r.length;n++)r[n].getReferencedInputs(e,t);return this._body.getReferencedInputs(e,t),t},t.prototype.internalPrepareForExecution=t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.prototype.internalValidateProperties=function(t){if(e.prototype.internalValidateProperties.call(this,t),this.url||t.addFailure(this,s.ValidationEvent.PropertyCantBeNull,g.Strings.errors.propertyMustBeSet("url")),this.headers.length>0)for(var n=0,r=this.headers;n<r.length;n++)r[n].name||t.addFailure(this,s.ValidationEvent.PropertyCantBeNull,g.Strings.errors.actionHttpHeadersMustHaveNameAndValue())},Object.defineProperty(t.prototype,"ignoreInputValidation",{get:function(){return this._ignoreInputValidation},set:function(e){this._ignoreInputValidation=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"url",{get:function(){return this._url.get()},set:function(e){this._url.set(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"body",{get:function(){return this._body.get()},set:function(e){this._body.set(e)},enumerable:!1,configurable:!0}),t.urlProperty=new re(h.Versions.v1_0,"url"),t.bodyProperty=new re(h.Versions.v1_0,"body"),t.methodProperty=new h.StringProperty(h.Versions.v1_0,"method"),t.headersProperty=new h.SerializableObjectCollectionProperty(h.Versions.v1_0,"headers",ie),t.ignoreInputValidationProperty=new h.BoolProperty(h.Versions.v1_3,"ignoreInputValidation",!1),t.JsonTypeName="Action.Http",i([(0,h.property)(t.urlProperty)],t.prototype,"_url",void 0),i([(0,h.property)(t.bodyProperty)],t.prototype,"_body",void 0),i([(0,h.property)(t.methodProperty)],t.prototype,"method",void 0),i([(0,h.property)(t.headersProperty)],t.prototype,"headers",void 0),i([(0,h.property)(t.ignoreInputValidationProperty)],t.prototype,"_ignoreInputValidation",void 0),t}(Y);t.HttpAction=oe;var ae=function(e){eturn r(t,e),t.prototype.updateCssClasses=function(){e.prototype.updateCssClasses.call(this),this.renderedElement&&(this.renderedElement.classList.add((this.parent?this.parent.hostConfig:u.defaultHostConfig).makeCssClassName("expandable")),this.renderedElement.setAttribute("aria-expanded",(1===this.state).toString()))},t.prototype.internalParse=t.prototype.internalToJSON=t.prototype.raiseExecuteActionEvent=t.prototype.releaseDOMResources=function(){e.prototype.releaseDOMResources.call(this),this.card.releaseDOMResources()},t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this.card.internalValidateProperties(t)},t.prototype.setParent=function(t){e.prototype.setParent.call(this,t),this.card.setParent(t)},t.prototype.getAllInputs=t.prototype.getAllActions=function(){var t=e.prototype.getAllActions.call(this);return t.push.apply(t,this.card.getAllActions()),t},t.prototype.getResourceInformation=function(){var t=e.prototype.getResourceInformation.call(this);return t.push.apply(t,this.card.getResourceInformation()),t},t.prototype.getActionById=t.JsonTypeName="Action.ShowCard",t}(Y);t.ShowCardAction=ae;var se=function(e){eturn r(t,e),t.prototype.getActions=function(){return this._actions},t.prototype.getAllActions=t.prototype.getJsonTypeName=function(){return ae.JsonTypeName},t.prototype.execute=function(){var e,t=this;if(!function(e,t){var n=e.parent?e.parent.getRootElement():void 0,r=n&&n.onDisplayOverflowActionMenu?n.onDisplayOverflowActionMenu:Pe.onDisplayOverflowActionMenu;return void 0!==r&&r(e.getActions(),t)}(this,this.renderedElement)&&this.renderedElement){var n=new m.PopupMenu;n.hostConfig=this.hostConfig;for(var r=i=this,o=0;o<this._actions.length;o++)r(o);n.popup(this.renderedElement)}},t.JsonTypeName="Action.Overflow",t}(Y),le=function(){eturn e.prototype.isActionAllowed=function(e){var t=this._owner.getForbiddenActionTypes();if(t)for(var n=0,r=t;n<r.length;n++)if(e.constructor===r[n])return!1;return!0},e.prototype.refreshContainer=e.prototype.layoutChanged=e.prototype.showActionCard=e.prototype.collapseExpandedAction=function(){for(var e=0,t=this._renderedActions;e<t.length;e++)t[e].state=0;var n=this._expandedAction;this._expandedAction=void 0,this._actionCard=void 0,this.refreshContainer(),n&&(this.layoutChanged(),be(n,!1))},e.prototype.expandShowCardAction=function(e,t){for(var n=this,r=!1,i=0,o=this._renderedActions;i<o.length;i++){var a=o[i];this._owner.hostConfig.actions.actionsOrientation==s.Orientation.Horizontal&&r&&(a.isFocusable=!1),a!==e?a.state=2:(a.state=1,r=!0,a.renderedElement&&(a.renderedElement.onblur=function(e){for(var t=0,r=n._renderedActions;t<r.length;t++)r[t].isFocusable=!0}))}this.showActionCard(e,!(this._owner.isAtTheVeryLeft()&&this._owner.isAtTheVeryRight()),t)},e.prototype.releaseDOMResources=function(){for(var e=0,t=this._renderedActions;e<t.length;e++)t[e].releaseDOMResources()},e.prototype.actionExecuted=e.prototype.parse=e.prototype.toJSON=e.prototype.getActionAt=function(e){return this._items[e]},e.prototype.getActionCount=function(){return this._items.length},e.prototype.getActionById=function(e){for(var t=void 0,n=0,r=this._items;n<r.length&&!(t=r[n].getActionById(e));n++);return t},e.prototype.validateProperties=e.prototype.render=function(e){var t=this._owner.hostConfig;if(t.supportsInteractivity){var n=document.createElement("div"),r=t.actions.maxActions?Math.min(t.actions.maxActions,this._items.length):this._items.length;if(this._actionCardContainer=document.createElement("div"),this._renderedActions=[],t.actions.preExpandSingleShowCardAction&&1===r&&this._items[0]instanceof ae&&this.isActionAllowed(this._items[0]))this.showActionCard(this._items[0],!0),this._renderedActions.push(this._items[0]);else{var i=document.createElement("div");if(i.className=t.makeCssClassName("ac-actionSet"),i.style.display="flex",e===s.Orientation.Horizontal)if(i.style.flexDirection="row",this._owner.horizontalAlignment&&t.actions.actionAlignment!==s.ActionAlignment.Stretch)switch(this._owner.horizontalAlignment){case s.HorizontalAlignment.Center:i.style.justifyContent="center";break;case s.HorizontalAlignment.Right:i.style.justifyContent="flex-end";break;default:i.style.justifyContent="flex-start"}else switch(t.actions.actionAlignment){case s.ActionAlignment.Center:i.style.justifyContent="center";break;case s.ActionAlignment.Right:i.style.justifyContent="flex-end";break;default:i.style.justifyContent="flex-start"}else if(i.style.flexDirection="column",this._owner.horizontalAlignment&&t.actions.actionAlignment!==s.ActionAlignment.Stretch)switch(this._owner.horizontalAlignment){case s.HorizontalAlignment.Center:i.style.alignItems="center";break;case s.HorizontalAlignment.Right:i.style.alignItems="flex-end";break;default:i.style.alignItems="flex-start"}else switch(t.actions.actionAlignment){case s.ActionAlignment.Center:i.style.alignItems="center";break;case s.ActionAlignment.Right:i.style.alignItems="flex-end";break;case s.ActionAlignment.Stretch:i.style.alignItems="stretch";break;default:i.style.alignItems="flex-start"}var o=this._items.filter(this.isActionAllowed.bind(this)),a=[],u=[];if(this._owner.isDesignMode())a=o;else{o.forEach(();var p=a.splice(t.actions.maxActions);l.GlobalSettings.allowMoreThanMaxActionsInOverflowMenu&&u.push.apply(u,p);var d=!0;u.length>0&&(this._overflowAction||(this._overflowAction=new se(u),this._overflowAction.setParent(this._owner),this._overflowAction._actionCollection=this),d=!this._overflowAction,this._owner instanceof Pe&&!this._owner.parent)),this._overflowAction&&d&&a.push(this._overflowAction)}for(var h=0;h<a.length;h++){var f=a[h];if(f.render(),f.renderedElement&&(f.renderedElement.style.flex=t.actions.actionsOrientation===s.Orientation.Horizontal&&t.actions.actionAlignment===s.ActionAlignment.Stretch?"0 1 100%":"0 1 auto",i.appendChild(f.renderedElement),this._renderedActions.push(f),h<a.length-1&&t.actions.buttonSpacing>0)){var g=document.createElement("div");e===s.Orientation.Horizontal?(g.style.flex="0 0 auto",g.style.width=t.actions.buttonSpacing+"px"):g.style.height=t.actions.buttonSpacing+"px",c.appendChild(i,g)}}var m=document.createElement("div");m.style.overflow="hidden",m.appendChild(i),c.appendChild(n,m)}c.appendChild(n,this._actionCardContainer);for(var v=0,y=this._renderedActions;v<y.length;v++){var b=y[v];if(1===b.state){this.expandShowCardAction(b,!1);break}}return this._renderedActions.length>0?n:void 0}},e.prototype.addAction=e.prototype.removeAction=e.prototype.clear=e.prototype.getAllInputs=function(e){void 0===e&&(e=!0);var t=[];if(e)for(var n=0,r=this._items;n<r.length;n++)t.push.apply(t,r[n].getAllInputs());return t},e.prototype.getResourceInformation=function(){for(var e=[],t=0,n=this._items;t<n.length;t++)e.push.apply(e,n[t].getResourceInformation());return e},Object.defineProperty(e.prototype,"renderedActionCount",{get:function(){return this._renderedActions.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"expandedAction",{get:function(){return this._expandedAction},enumerable:!1,configurable:!0}),e}(),ce=function(e){function t(){var t=e.call(this)||this;return t._actionCollection=new le(t),t}return r(t,e),t.prototype.internalParse=t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n),this._actionCollection.toJSON(t,"actions",n)},t.prototype.internalRender=t.prototype.releaseDOMResources=function(){e.prototype.releaseDOMResources.call(this),this._actionCollection.releaseDOMResources()},t.prototype.isBleedingAtBottom=function(){return 0===this._actionCollection.renderedActionCount?e.prototype.isBleedingAtBottom.call(this):1===this._actionCollection.getActionCount()?void 0!==this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:void 0!==this._actionCollection.expandedAction},t.prototype.getJsonTypeName=function(){return"ActionSet"},t.prototype.getActionCount=function(){return this._actionCollection.getActionCount()},t.prototype.getActionAt=function(t){return t>=0&&t<this.getActionCount()?this._actionCollection.getActionAt(t):e.prototype.getActionAt.call(this,t)},t.prototype.getActionById=function(t){return this._actionCollection.getActionById(t)||e.prototype.getActionById.call(this,t)},t.prototype.getAllActions=t.prototype.internalValidateProperties=t.prototype.addAction=function(e){this._actionCollection.addAction(e)},t.prototype.getAllInputs=t.prototype.getResourceInformation=function(){return this._actionCollection.getResourceInformation()},t.prototype.findDOMNodeOwner=Object.defineProperty(t.prototype,"isInteractive",{get:function(){return!0},enumerable:!1,configurable:!0}),t.orientationProperty=new h.EnumProperty(h.Versions.v1_1,"orientation",s.Orientation),i([(0,h.property)(t.orientationProperty)],t.prototype,"orientation",void 0),t}(b);t.ActionSet=ce;var ue=h.ValueSetProperty);t.ContainerStyleProperty=ue;var pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),Object.defineProperty(t.prototype,"style",{get:set:function(e){this.setValue(t.styleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowCustomStyle",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasExplicitStyle",{get:enumerable:!1,configurable:!0}),t.prototype.applyBorder=function(){},t.prototype.applyBackground=t.prototype.applyPadding=t.prototype.getHasBackground=function(e){void 0===e&&(e=!1);for(var n=this.parent;n;){var r;if(r=!e&&n instanceof fe&&n.backgroundImage.isValid(),n instanceof t&&this.hasExplicitStyle&&(n.getEffectiveStyle()!==this.getEffectiveStyle()||r))return!0;n=n.parent}return!1},t.prototype.getDefaultPadding=function(){return this.getHasBackground()||this.getHasBorder()?new l.PaddingDefinition(s.Spacing.Padding,s.Spacing.Padding,s.Spacing.Padding,s.Spacing.Padding):e.prototype.getDefaultPadding.call(this)},t.prototype.internalValidateProperties=t.prototype.render=t.prototype.getEffectiveStyle=t.styleProperty=new ue(h.Versions.v1_0,"style"),i([(0,h.property)(t.styleProperty)],t.prototype,"style",null),t}(T);t.StylableCardElementContainer=pe;var de=pe);t.ContainerBase=de;var he=h.SerializableObject);t.BackgroundImage=he;var fe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._items=[],t._renderedItems=[],t}return r(t,e),Object.defineProperty(t.prototype,"backgroundImage",{get:function(){return this.getValue(t.backgroundImageProperty)},enumerable:!1,configurable:!0}),t.prototype.insertItemAt=t.prototype.getItemsCollectionPropertyName=function(){return"items"},t.prototype.applyBackground=t.prototype.applyRTL=t.prototype.internalRender=t.prototype.truncateOverflow=function(e){if(this.renderedElement){for(var t=this.renderedElement.offsetTop+e+1,n=function(e){var r=e.renderedElement;if(r)switch(c.getFitStatus(r,t)){case s.ContainerFitStatus.FullyInContainer:e.resetOverflow()&&n(e);break;case s.ContainerFitStatus.Overflowing:e.handleOverflow(t-r.offsetTop);break;case s.ContainerFitStatus.FullyOutOfContainer:e.handleOverflow(0)}},r=0,i=this._items;r<i.length;r++)n(i[r]);return!0}return!1},t.prototype.undoOverflowTruncation=function(){for(var e=0,t=this._items;e<t.length;e++)t[e].resetOverflow()},t.prototype.getHasBackground=t.prototype.canHostSingletons=function(){return!1},t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this.clear(),this.setShouldFallback(!1);var r=t[this.getItemsCollectionPropertyName()];if(!Array.isArray(r)&&"object"==typeof r&&this.canHostSingletons()){var i=c.parseString(r.type);if(i){var o=n.elementRegistry.findByName(i);(null==o?void 0:o.singletonBehavior)!==f.ElementSingletonBehavior.NotAllowed&&(l=n.parseElement(this,r,[],!this.isDesignMode(),!0))&&this.insertItemAt(l,-1,!0)}}else if(Array.isArray(r))for(var a=0,s=r;a<s.length;a++){var l;(l=n.parseElement(this,s[a],this.forbiddenChildElements(),!this.isDesignMode()))&&this.insertItemAt(l,-1,!0)}},t.prototype.internalToJSON=Object.defineProperty(t.prototype,"isSelectable",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.getEffectivePadding=t.prototype.getEffectiveVerticalContentAlignment=t.prototype.getItemCount=function(){return this._items.length},t.prototype.getItemAt=function(e){return this._items[e]},t.prototype.getFirstVisibleRenderedItem=t.prototype.getLastVisibleRenderedItem=t.prototype.getJsonTypeName=function(){return"Container"},t.prototype.isFirstElement=t.prototype.isLastElement=t.prototype.isRtl=t.prototype.isBleedingAtTop=t.prototype.isBleedingAtBottom=function(){var e=this.getLastVisibleRenderedItem();return this.isBleeding()||!!e&&e.isBleedingAtBottom()&&e.getEffectiveStyle()===this.getEffectiveStyle()},t.prototype.indexOf=function(e){return this._items.indexOf(e)},t.prototype.addItem=t.prototype.insertItemBefore=t.prototype.insertItemAfter=t.prototype.removeItem=function(e){var t=this._items.indexOf(e);return t>=0&&(this._items.splice(t,1),e.setParent(void 0),this.updateLayout(),!0)},t.prototype.clear=t.prototype.getResourceInformation=t.prototype.getActionById=function(t){var n=e.prototype.getActionById.call(this,t);if(!n&&(this.selectAction&&(n=this.selectAction.getActionById(t)),!n))for(var r=0,i=this._items;r<i.length&&!(n=i[r].getActionById(t));r++);return n},Object.defineProperty(t.prototype,"padding",{get:function(){return this.getPadding()},set:function(e){this.setPadding(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectAction",{get:function(){return this._selectAction},set:function(e){this._selectAction=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bleed",{get:function(){return this.getBleed()},set:function(e){this.setBleed(e)},enumerable:!1,configurable:!0}),t.backgroundImageProperty=new h.SerializableObjectProperty(h.Versions.v1_0,"backgroundImage",he),t.verticalContentAlignmentProperty=new h.EnumProperty(h.Versions.v1_1,"verticalContentAlignment",s.VerticalAlignment),t.rtlProperty=new h.BoolProperty(h.Versions.v1_0,"rtl"),i([(0,h.property)(t.backgroundImageProperty)],t.prototype,"backgroundImage",null),i([(0,h.property)(t.verticalContentAlignmentProperty)],t.prototype,"verticalContentAlignment",void 0),i([(0,h.property)(t.rtlProperty)],t.prototype,"rtl",void 0),t}(de);t.Container=fe;var ge=function(e){eturn r(t,e),t.prototype.adjustRenderedElementSize=t.prototype.shouldSerialize=function(e){return!0},Object.defineProperty(t.prototype,"separatorOrientation",{get:function(){return s.Orientation.Vertical},enumerable:!1,configurable:!0}),t.prototype.getJsonTypeName=function(){return"Column"},Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return!!(this.parent&&this.parent instanceof me)&&void 0!==this.separatorElement&&!this.parent.isLeftMostElement(this)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),t.widthProperty=new h.CustomProperty(h.Versions.v1_0,"width",(,(,"stretch"),i([(0,h.property)(t.widthProperty)],t.prototype,"width",void 0),t}(fe);t.Column=ge;var me=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._columns=[],t}return r(t,e),t.prototype.createColumnInstance=t.prototype.internalRender=function(){if(this._renderedColumns=[],this._columns.length>0){var e=this.hostConfig,t=document.createElement("div");switch(t.className=e.makeCssClassName("ac-columnSet"),t.style.display="flex",l.GlobalSettings.useAdvancedCardBottomTruncation&&(t.style.minHeight="-webkit-min-content"),this.getEffectiveHorizontalAlignment()){case s.HorizontalAlignment.Center:t.style.justifyContent="center";break;case s.HorizontalAlignment.Right:t.style.justifyContent="flex-end";break;default:t.style.justifyContent="flex-start"}for(var n=0,r=0,i=this._columns;r<i.length;r++)(u=i[r]).width instanceof l.SizeAndUnit&&u.width.unit===s.SizeUnit.Weight&&(n+=u.width.physicalSize);for(var o=0,a=this._columns;o<a.length;o++){var u;(u=a[o]).width instanceof l.SizeAndUnit&&u.width.unit===s.SizeUnit.Weight&&n>0&&(u._computedWeight=100/n*u.width.physicalSize);var p=u.render();p&&(this._renderedColumns.length>0&&u.separatorElement&&(u.separatorElement.style.flex="0 0 auto",c.appendChild(t,u.separatorElement)),c.appendChild(t,p),this._renderedColumns.push(u))}return this._renderedColumns.length>0?t:void 0}},t.prototype.truncateOverflow=function(e){for(var t=0,n=this._columns;t<n.length;t++)n[t].handleOverflow(e);return!0},t.prototype.undoOverflowTruncation=Object.defineProperty(t.prototype,"isSelectable",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this._columns=[],this._renderedColumns=[];var r=t.columns;if(Array.isArray(r))for(var i=0,o=r;i<o.length;i++){var a=this.createColumnInstance(o[i],n);a&&this._columns.push(a)}},t.prototype.internalToJSON=t.prototype.isFirstElement=t.prototype.isBleedingAtTop=function(){if(this.isBleeding())return!0;if(this._renderedColumns&&this._renderedColumns.length>0)for(var e=0,t=this._columns;e<t.length;e++)if(t[e].isBleedingAtTop())return!0;return!1},t.prototype.isBleedingAtBottom=function(){if(this.isBleeding())return!0;if(this._renderedColumns&&this._renderedColumns.length>0)for(var e=0,t=this._columns;e<t.length;e++)if(t[e].isBleedingAtBottom())return!0;return!1},t.prototype.getItemCount=function(){return this._columns.length},t.prototype.getFirstVisibleRenderedItem=t.prototype.getLastVisibleRenderedItem=t.prototype.getColumnAt=function(e){return this._columns[e]},t.prototype.getItemAt=function(e){return this.getColumnAt(e)},t.prototype.getJsonTypeName=function(){return"ColumnSet"},t.prototype.internalValidateProperties=t.prototype.addColumn=function(e){if(e.parent)throw new Error(g.Strings.errors.columnAlreadyBelongsToAnotherSet());this._columns.push(e),e.setParent(this)},t.prototype.removeItem=function(e){if(e instanceof ge){var t=this._columns.indexOf(e);if(t>=0)return this._columns.splice(t,1),e.setParent(void 0),this.updateLayout(),!0}return!1},t.prototype.indexOf=function(e){return e instanceof ge?this._columns.indexOf(e):-1},t.prototype.isLeftMostElement=t.prototype.isRightMostElement=t.prototype.isTopElement=function(e){return this._columns.indexOf(e)>=0},t.prototype.isBottomElement=t.prototype.getActionById=function(e){for(var t=void 0,n=0,r=this._columns;n<r.length&&!(t=r[n].getActionById(e));n++);return t},Object.defineProperty(t.prototype,"bleed",{get:function(){return this.getBleed()},set:function(e){this.setBleed(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"padding",{get:function(){return this.getPadding()},set:function(e){this.setPadding(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectAction",{get:function(){return this._selectAction},set:function(e){this._selectAction=e},enumerable:!1,configurable:!0}),t}(de);ction Se(e,t){void 0===t&&(t=!0);var n=e.getRootElement();t&&n.updateLayout();var r=n&&n.onElementVisibilityChanged?n.onElementVisibilityChanged:Pe.onElementVisibilityChanged;void 0!==r&&r(e)}t.ColumnSet=me;var Ce=function(e){eturn r(t,e),t.prototype.internalParse=t.prototype.parseActions=t.prototype.internalToJSON=t.prototype.internalRender=t.prototype.getHasExpandedAction=Object.defineProperty(t.prototype,"renderedActionCount",{get:function(){return this._actionCollection.renderedActionCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderIfEmpty",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.releaseDOMResources=function(){e.prototype.releaseDOMResources.call(this),this._actionCollection.releaseDOMResources()},t.prototype.getActionCount=function(){return this._actionCollection.getActionCount()},t.prototype.getActionAt=t.prototype.getActionById=function(t){return this._actionCollection.getActionById(t)||e.prototype.getActionById.call(this,t)},t.prototype.internalValidateProperties=t.prototype.isLastElement=t.prototype.addAction=function(e){this._actionCollection.addAction(e)},t.prototype.clear=t.prototype.getAllInputs=t.prototype.getResourceInformation=t.prototype.isBleedingAtBottom=t.prototype.getForbiddenActionNames=function(){return[]},Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),t}(fe);t.ContainerWithActions=Ce;var _e=h.PropertyDefinition);t.RefreshActionProperty=_e;var Ae=h.SerializableObject);t.RefreshDefinition=Ae;var we=h.SerializableObject);t.AuthCardButton=we;var Ee=h.SerializableObject);t.TokenExchangeResource=Ee;var Ie=h.SerializableObject);t.Authentication=Ie;var Pe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.designMode=!1,t}return r(t,e),Object.defineProperty(t.prototype,"refresh",{get:function(){return this.getValue(t.refreshProperty)},set:enumerable:!1,configurable:!0}),Object.defineProperty(t,"processMarkdown",{get:set:enumerable:!1,configurable:!0}),t.applyMarkdown=t.prototype.isVersionSupported=t.prototype.getDefaultSerializationContext=t.prototype.getItemsCollectionPropertyName=function(){return"body"},t.prototype.canHostSingletons=function(){return!0},t.prototype.internalParse=t.prototype.internalToJSON=t.prototype.internalRender=t.prototype.getHasBackground=function(e){return void 0===e&&(e=!1),!0},t.prototype.getDefaultPadding=function(){return new l.PaddingDefinition(s.Spacing.Padding,s.Spacing.Padding,s.Spacing.Padding,s.Spacing.Padding)},t.prototype.shouldSerialize=function(e){return!0},Object.defineProperty(t.prototype,"renderIfEmpty",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bypassVersionCheck",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowCustomStyle",{get:enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasBackground",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.getJsonTypeName=function(){return"AdaptiveCard"},t.prototype.internalValidateProperties=t.prototype.render=t.prototype.updateLayout=t.prototype.shouldFallback=Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return!1},enumerable:!1,configurable:!0}),t.schemaUrl="http://adaptivecards.io/schemas/adaptive-card.json",t.$schemaProperty=new h.CustomProperty(h.Versions.v1_0,"$schema",(,(),t.versionProperty=new h.CustomProperty(h.Versions.v1_0,"version",(function(e,t,n,r){var i=h.Version.parse(n[t.name],r);return void 0===i&&r.logParseEvent(e,s.ValidationEvent.InvalidPropertyValue,g.Strings.errors.invalidCardVersion((i=h.Versions.latest).toString())),i}),(,h.Versions.v1_0),t.fallbackTextProperty=new h.StringProperty(h.Versions.v1_0,"fallbackText"),t.speakProperty=new h.StringProperty(h.Versions.v1_0,"speak"),t.refreshProperty=new h.SerializableObjectProperty(h.Versions.v1_4,"refresh",Ae,!0),t.authenticationProperty=new h.SerializableObjectProperty(h.Versions.v1_4,"authentication",Ie,!0),t._haveWarnedAboutNoMarkdownProcessing=!1,i([(0,h.property)(t.versionProperty)],t.prototype,"version",void 0),i([(0,h.property)(t.fallbackTextProperty)],t.prototype,"fallbackText",void 0),i([(0,h.property)(t.speakProperty)],t.prototype,"speak",void 0),i([(0,h.property)(t.refreshProperty)],t.prototype,"refresh",null),i([(0,h.property)(t.authenticationProperty)],t.prototype,"authentication",void 0),t}(Ce);t.AdaptiveCard=Pe;var Oe=Pe),Te=h.BaseSerializationContext);t.SerializationContext=Te,f.GlobalRegistry.defaultElements.register("Container",fe),f.GlobalRegistry.defaultElements.register("TextBlock",_),f.GlobalRegistry.defaultElements.register("RichTextBlock",w,h.Versions.v1_2),f.GlobalRegistry.defaultElements.register("TextRun",A,h.Versions.v1_2),f.GlobalRegistry.defaultElements.register("Image",O),f.GlobalRegistry.defaultElements.register("ImageSet",k),f.GlobalRegistry.defaultElements.register("Media",B,h.Versions.v1_1),f.GlobalRegistry.defaultElements.register("FactSet",I),f.GlobalRegistry.defaultElements.register("ColumnSet",me),f.GlobalRegistry.defaultElements.register("ActionSet",ce,h.Versions.v1_2),f.GlobalRegistry.defaultElements.register("Input.Text",U),f.GlobalRegistry.defaultElements.register("Input.Date",X),f.GlobalRegistry.defaultElements.register("Input.Time",K),f.GlobalRegistry.defaultElements.register("Input.Number",J),f.GlobalRegistry.defaultElements.register("Input.ChoiceSet",G),f.GlobalRegistry.defaultElements.register("Input.Toggle",W),f.GlobalRegistry.defaultActions.register(te.JsonTypeName,te),f.GlobalRegistry.defaultActions.register(Q.JsonTypeName,Q),f.GlobalRegistry.defaultActions.register(ae.JsonTypeName,ae),f.GlobalRegistry.defaultActions.register(ne.JsonTypeName,ne,h.Versions.v1_2),f.GlobalRegistry.defaultActions.register(ee.JsonTypeName,ee,h.Versions.v1_4)},"5hZV":"6FUk":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return l}));var r=n("AlWG"),i=n("weFd"),o=new r.a(null),a=function(){return o.asObservable()},s=function(e){return Object(i.a)("Click","Show_Task_Module_Dialog","Open","card"===e.taskInfo.type?"ADAPTIVECARD":e.dialogType,e.appId),o.next(e),null==e?void 0:e.submitHandler},l=,"72kp":function(e,t,n){"use strict";n.d(t,"a",(function(){return Dr}));var r,i,o=n("QjXU"),a=n("mXGw"),s=function(){eturn e.prototype.addListener=function(e,t){this.element&&(this.removeListener(e),this.element.addEventListener(e,t),this.listeners[e]=t)},e.prototype.removeListener=function(e){this.element&&this.listeners[e]&&(this.element.removeEventListener(e,this.listeners[e]),delete this.listeners[e])},e.prototype.removeAllListeners=function(){for(var e=0,t=Object.keys(this.listeners);e<t.length;e++)this.removeListener(t[e])},e}(),l="appInstallDialog.openAppInstallDialog",c="authentication.getAuthToken",u="authentication.getUser",p="authentication.authenticate.success",d="authentication.authenticate.failure",h="appEntity.selectAppEntity",f="media.scanBarCode",g="calendar.composeMeeting",m="calendar.openCalendarItem",v="call.startCall",y="chat.openChat",b="conversations.openConversation",S="conversations.closeConversation",C="getChatMembers",_="tasks.startTask",A="tasks.completeTask",w="tasks.updateTask",E="files.addCloudStorageFolder",I="files.copyMoveFiles",P="files.deleteCloudStorageFolder",O="files.getCloudStorageFolders",T="openFilePreview",k="files.getExternalProviders",x="files.openCloudStorageFile",j="files.getCloudStorageFolderContents",D="initialize",R="location.getLocation",H="location.showLocation",N="interactive.getFluidTenantInfo",V="interactive.getFluidToken",L="interactive.getFluidContainerId",M="interactive.setFluidContainerId",F="interactive.getNtpTime",B="interactive.registerClientId",z="interactive.getClientRoles",U="interactive.getClientInfo",W="executeDeepLink",q="mail.composeMail",G="mail.openMailItem",J="captureImage",X="getMedia",Z="selectMedia",K="viewImages",Y="meeting.getAppContentStageSharingCapabilities",$="meeting.getAppContentStageSharingState",Q="meeting.getAuthenticationTokenForAnonymousUser",ee="getIncomingClientAudioState",te="meeting.getLiveStreamState",ne="meeting.getMeetingDetails",re="meeting.appShareButton.setOptions",ie="meeting.requestStartLiveStreaming",oe="meeting.requestStopLiveStreaming",ae="meeting.shareAppContentToStage",se="meeting.stopSharingAppContentToStage",le="toggleIncomingClientAudio",ce="meeting.requestAppAudioHandling",ue="meeting.updateMicState",pe="meetingRoom.getPairedMeetingRoomInfo",de="meetingRoom.sendCommandToPairedMeetingRoom",he="monetization.openPurchaseExperience",fe="notifications.showNotification",ge="settings.getSettings",me="navigateCrossDomain",ve="pages.navigateToApp",ye="returnFocus",be="setFrameContext",Se="shareDeepLink",Ce="navigateBack",_e="pages.currentApp.navigateTo",Ae="pages.currentApp.navigateToDefaultPage",we="getTabInstances",Ee="getMruTabInstances",Ie="navigateToTab",Pe="settings.setSettings",Oe="settings.setValidityState",Te={success:"settings.save.success",failure:"settings.save.failure"},ke={success:"settings.remove.success",failure:"settings.remove.failure"},xe="enterFullscreen",je="exitFullscreen",De="people.selectPeople",Re="permissions.has",He="permissions.request",Ne="profile.showProfile",Ve="remoteCamera.getCapableParticipants",Le="remoteCamera.requestControl",Me="remoteCamera.sendControlCommand",Fe="remoteCamera.terminateSession",Be="sharing.shareWebContent",ze="stageView.open",Ue="teams.getTeamChannels",We="teams.refreshSiteUrl",qe="getConfigSetting",Ge={getUserJoinedTeams:"getUserJoinedTeams"};!function(e){e.AuthFailed="AuthFailed",e.Timeout="Timeout",e.Other="Other",e.AppInitTimeout="AppInitTimeout",e.Validation="Validation",e.Validation_InvalidDomains="Validation_InvalidDomains"}(r||(r={})),function(e){e.PermissionError="PermissionError",e.NotFound="NotFound",e.Throttling="Throttling",e.Offline="Offline",e.Other="Other"}(i||(i={}));var Je,Xe={resourceDomainParameter:"{resourceDomain}",validResourcePattern:"^((https|api)://{resourceDomain}([:/].*)?)$"},Ze=/^(\*\.)*[^*]+$/i,Ke=["com.example.microsoftteamstabs.test","com.example.metaostestapp.test"],Ye="Url is invalid",$e="There is at least one improperly formatted domain in the provided app definition's validDomains field",Qe=n("szkd");!function(e){e.Debug="Debug",e.Info="Info",e.Warn="Warn",e.Error="Error"}(Je||(Je={}));var et=n("dlqR"),tt=function(){return function(){var e=this;this.items=new Map,this.add=function(t){if(t){var n=t.toLowerCase();if(!e.items.has(n))return e.items.set(n,t),!0}return!1},this.values=}(),nt={wildcardValidDomainRuleDetection:!0,extendedAppLoadTimeoutInMillis:void 0};ar it=function(e){return e&&new URL(e).host},ot=function(e,t,n,r){try{var i=new URL(ct(e,r));return void 0!==n&&dt(i,st(n,r),t)}catch(e){return t.log(Je.Error,"isValidUrlForApp","Invalid url",null),!1}},at=function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];i.match(Ze)||t.push(i)}return t},st=function(e,t){var n,r,i=new tt;return e.validDomains&&e.validDomains.forEach(i.add),null===(n=e.pages.configurable)||void 0===n||n.forEach((function(e){return i.add(it(ct(e.configurationUrl,t)))})),null===(r=e.pages.static)||void 0===r||r.forEach((function(e){e.contentUrl&&i.add(it(ct(e.contentUrl,t)))})),Array.from(i.values())},lt=function(e,t,n,r,i){var o;if((n.name===et.c.teams||n.name===et.c.teamsModern)&&t&&t.length>0&&(!r||r.isFullTrust||function(e){return e&&-1!==Ke.indexOf(e.toLowerCase())}(r.id)))return Promise.resolve(t);if(null===(o=null==r?void 0:r.webApplicationInfo)||void 0===o?void 0:o.resource){var a=ut(r,i);return a&&pt(a,e)?Promise.resolve([a]):Promise.reject("App resource defined in manifest and iframe origin do not match")}return Promise.reject("App webApplicationInfo or resource not defined in manifest")},ct=function(e,t){var n,r,i,o,a,s,l,c,u,p,d,h;if(!t)return e;var f={teamSiteDomain:(null===(n=t.sharePointSite)||void 0===n?void 0:n.teamSiteDomain)||"",teamSitePath:(null===(r=t.sharePointSite)||void 0===r?void 0:r.teamSitePath)||"",teamSiteUrl:(null===(i=t.sharePointSite)||void 0===i?void 0:i.teamSiteUrl)||"",mySiteDomain:(null===(o=t.sharePointSite)||void 0===o?void 0:o.mySiteDomain)||"",mySitePath:(null===(a=t.sharePointSite)||void 0===a?void 0:a.mySitePath)||"",channelRelativeUrl:(null===(s=t.channel)||void 0===s?void 0:s.relativeUrl)||"",sharePointSite:{teamSiteDomain:(null===(l=t.sharePointSite)||void 0===l?void 0:l.teamSiteDomain)||"",teamSitePath:(null===(c=t.sharePointSite)||void 0===c?void 0:c.teamSitePath)||"",teamSiteUrl:(null===(u=t.sharePointSite)||void 0===u?void 0:u.teamSiteUrl)||"",mySiteDomain:(null===(p=t.sharePointSite)||void 0===p?void 0:p.mySiteDomain)||"",mySitePath:(null===(d=t.sharePointSite)||void 0===d?void 0:d.mySitePath)||""},channel:{relativeUrl:(null===(h=t.channel)||void 0===h?void 0:h.relativeUrl)||""}};return gt(e,f)},ut=function(e,t){var n,r;return(null===(n=e.webApplicationInfo)||void 0===n?void 0:n.resource)&&ct(null===(r=e.webApplicationInfo)||void 0===r?void 0:r.resource,t)},pt=function(e,t){if(e&&t){if(e===t)return!0;var n=it(t),r=Xe.validResourcePattern.replace(Xe.resourceDomainParameter,n);return new RegExp(r,"i").test(e)}return!1},dt=function(e,t,n){var r=ft(e),i=new tt,a=Object(o.__spreadArray)([],t,!0),s=at(Object(o.__spreadArray)([],t,!0));s.length>0&&(n.log(Je.Debug,"isUrlInDomainList","Invalid domain detected with ".concat(s,"}")),rt().wildcardValidDomainRuleDetection&&(a=a.filter(()));for(var l=0,c=a;l<c.length;l++){var u=c[l];if(i.add(u)){var p=ht(u),d=new RegExp("^https://".concat(p,"((/|\\?).*)?$"),"i");if(r.match(d))return!0}}return!1},ht=function(e){if(!0===rt().wildcardValidDomainRuleDetection&&at([e]).length>0)throw new Error("The wildcardValidDomainRuleDetection flag is enabled and an improper wildcard domain segment was detected: "+e);for(var t=e.split("."),n="",r=0;r<t.length;r++){var i=t[r],o=i.indexOf("*");n+=r>0?"[.]":"",n+=o>-1?i.slice(0,o)+"[^/^.]+"+i.slice(o+1):i}return n},ft=gt=function(e,t,n){void 0===n&&(n=[]);var r=e.indexOf("?"),i="",o="";return r>0?(i=e.substring(0,r),o=e.substring(r)):i=e,i&&(i=mt(i,t,n,(function(e){return encodeURI(e)}))),o&&(o=mt(o,t,n,(function(e){return encodeURIComponent(e)}))),i+o},mt=function(e,t,n,r){if(void 0===n&&(n=[]),void 0!==t)if("object"==typeof t)for(var i in t)e=mt(e,t[i],n.concat(i),r);else{var o=n.join("."),a=new RegExp("{".concat(o.replace(".","\\."),"}"),"g");e=e.replace(a,r(t))}return e};function vt(e){var t,n;return{actionInfo:e.actionInfo,locale:e.app.locale,appSessionId:e.app.sessionId||"",appLaunchId:e.app.launchId||"",theme:e.app.theme,appIconPosition:e.app.iconPositionVertical||0,osLocaleInfo:e.app.osLocaleInfo,parentMessageId:e.app.parentMessageId||"",userClickTime:e.app.userClickTime||0,userFileOpenPreference:e.app.userFileOpenPreference||Qe.f.Inline,hostName:e.app.host.name,hostClientType:e.app.host.clientType,sessionId:e.app.host.sessionId||"",ringId:e.app.host.ringId,entityId:e.page.id||"",frameContext:e.page.frameContext,subEntityId:e.page.subPageId||"",isFullScreen:e.page.isFullScreen||!1,isMultiWindow:e.page.isMultiWindow||!1,sourceOrigin:e.page.sourceOrigin||"",userObjectId:void 0!==e.user?e.user.id:void 0,isCallingAllowed:void 0!==e.user?e.user.isCallingAllowed:void 0,isPSTNCallingAllowed:void 0!==e.user?e.user.isPSTNCallingAllowed:void 0,userLicenseType:void 0!==e.user?e.user.licenseType:"",loginHint:void 0!==e.user?e.user.loginHint:void 0,userPrincipalName:void 0!==e.user?e.user.userPrincipalName:void 0,upn:void 0!==e.user?e.user.userPrincipalName:void 0,userDisplayName:void 0!==e.user?e.user.displayName:void 0,tid:void 0!==e.user&&void 0!==e.user.tenant?e.user.tenant.id:void 0,tenantSKU:(null===(n=null===(t=null==e?void 0:e.user)||void 0===t?void 0:t.tenant)||void 0===n?void 0:n.sku)||"",channelId:void 0!==e.channel?e.channel.id:void 0,channelName:void 0!==e.channel?e.channel.displayName:void 0,channelRelativeUrl:void 0!==e.channel?e.channel.relativeUrl:void 0,channelType:void 0!==e.channel?e.channel.membershipType:void 0,defaultOneNoteSectionId:void 0!==e.channel?e.channel.defaultOneNoteSectionId:void 0,hostTeamGroupId:void 0!==e.channel?e.channel.ownerGroupId:void 0,hostTeamTenantId:void 0!==e.channel?e.channel.ownerTenantId:void 0,chatId:void 0!==e.chat?e.chat.id:"",meetingId:void 0!==e.meeting?e.meeting.id:"",sharepoint:e.sharepoint,teamId:void 0!==e.team?e.team.internalId:void 0,teamName:void 0!==e.team?e.team.displayName:void 0,teamType:void 0!==e.team?e.team.type:void 0,groupId:void 0!==e.team?e.team.groupId:void 0,teamTemplateId:void 0!==e.team?e.team.templateId:void 0,isTeamArchived:void 0!==e.team?e.team.isArchived:void 0,userTeamRole:void 0!==e.team?e.team.userRole:void 0,teamSiteId:void 0!==e.sharePointSite?e.sharePointSite.teamSiteId:void 0,teamSiteUrl:void 0!==e.sharePointSite?e.sharePointSite.teamSiteUrl:void 0,teamSiteDomain:void 0!==e.sharePointSite?e.sharePointSite.teamSiteDomain:void 0,teamSitePath:void 0!==e.sharePointSite?e.sharePointSite.teamSitePath:void 0,mySiteDomain:void 0!==e.sharePointSite?e.sharePointSite.mySiteDomain:void 0,mySitePath:void 0!==e.sharePointSite?e.sharePointSite.mySitePath:void 0}}var yt=function(){function e(e){var t=this;this.logger=e,this.getOrigin=function(){return t.origin}}return e.prototype.setOrigin=function(e){this.origin=e},e.prototype.onSdkInitialized=function(e){this.hostEventListener=new s(e),this.hostEventListener.addListener("message",this.onMessageReceived.bind(this))},e.prototype.onSetFrameAndLoadOrigin=function(e,t,n,r,i){this.frame=e,this.setOrigin(t),this.appDefinition=n,this.appContext=r,this.handleMessageCallbackIframe=i},e.prototype.postMessage=function(e,t){var n=this.getOrigin();n&&e.contentWindow&&e.contentWindow.postMessage(t,n)},e.prototype.onMessageReceived=function(e){if(this.frame&&this.frame.contentWindow===e.source){var t=e.origin;t&&t!==this.getOrigin()&&ot(t,this.logger,this.appDefinition,this.appContext)&&this.setOrigin(t),this.getOrigin()===t&&this.handleMessageCallbackIframe&&this.handleMessageCallbackIframe(e)}},e.prototype.dispose=e}(),bt=St=Ct={media:["camera","microphone"],geolocation:["geolocation"],midi:["midi"]},_t=function(e){var t=e.sdkHost,n=e.contentUrl,r=e.frameContext,i=e.appDefinition,s=e.title,l=e.isLoading,c=e.userClickTime,u=e.getRequiredPermissions,p=a.useRef(null),d=At(u);return a.useEffect((function(){d&&function(){Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return[4,t.setFrameAndLoadOrigin(p.current,n,i,c)];case 1:return e.sent(),[2]}}))}))}()}),[t,p,n,r,i,d]),a.createElement("iframe",{"data-tid":"app-host-iframe",ref:p,style:l?Object(o.__assign)({},St()):Object(o.__assign)({},bt()),sandbox:"allow-forms allow-popups allow-popups-to-escape-sandbox allow-pointer-lock allow-scripts allow-same-origin allow-modals allow-downloads allow-top-navigation-to-custom-protocols",title:s,allow:d})},At=function(e){var t=a.useState(void 0),n=t[0],r=t[1];return function(){Object(o.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return[4,e()];case 1:return t=o.sent(),n=t.map(().flat(),i=n.concat(["autoplay"]).join("; "),r(i),[2]}}))}))}(),n},wt=new RegExp("[a-zA-Z0-9_\\-\\.]+(@|%40|%2540)[a-zA-Z0-9_\\-\\.]+\\.[a-zA-Z]{2,5}","g"),Et="https://teams.microsoft.com",It=function(e,t){var n,r,i=null===(r=null===(n=e.pages)||void 0===n?void 0:n.static)||void 0===r?void 0:r.find((function(e){return e.entityId===t}));return null==i?void 0:i.name},Pt=Ot=function(e){return!!e&&void 0!==e.user.id};function Tt(){return"".concat(1,".").concat(5)}function kt(e){return e.majorVersion<1||1==e.majorVersion&&e.minorVersion<5}var xt,jt,Dt,Rt,Ht,Nt,Vt,Lt,Mt=Ft=((xt={})["appInstallDialog.openAppInstallDialog"]="api.appInstallDialog.openAppInstallDialog",xt["authentication.getAuthToken"]="api.getAuthToken",xt["authentication.getUser"]="api.getUser",xt["authentication.authenticate.failure"]="api.authentication.notifyFailure",xt["authentication.authenticate.success"]="api.authentication.notifySuccess",xt["appEntity.selectAppEntity"]="api.appEntity.selectAppEntity",xt["media.scanBarCode"]="api.barCode.scanBarCode",xt["calendar.composeMeeting"]="api.calendar.composeMeeting",xt["calendar.openCalendarItem"]="api.calendar.openCalendarItem",xt["call.startCall"]="api.call.startCall",xt["chat.openChat"]="api.chat.openChat",xt["conversations.openConversation"]="api.conversations.openConversation",xt["conversations.closeConversation"]="api.conversations.closeConversation",xt.getChatMembers="api.conversations.getChatMembers",xt["tasks.startTask"]="api.dialogs.open",xt["tasks.completeTask"]="api.dialogs.submit",xt[w]="api.dialogs.update.resize",xt.openFilePreview="api.files.openFilePreview",xt["files.getCloudStorageFolders"]="api.files.getCloudStorageFolders",xt["files.addCloudStorageFolder"]="api.files.addCloudStorageFolder",xt["files.deleteCloudStorageFolder"]="api.files.deleteCloudStorageFolder",xt["files.copyMoveFiles"]="api.files.copyMoveFiles",xt["files.getExternalProviders"]="api.files.getExternalProviders",xt["files.getCloudStorageFolderContents"]="api.files.getCloudStorageFolderContents",xt.getContext="api.getContext",xt["interactive.getFluidTenantInfo"]="api.interactive.getFluidTenantInfo",xt["interactive.getFluidToken"]="api.interactive.getFluidToken",xt["interactive.getFluidContainerId"]="api.interactive.getFluidContainerId",xt["interactive.setFluidContainerId"]="api.interactive.setFluidContainerId",xt["interactive.getNtpTime"]="api.interactive.getNtpTime",xt["interactive.registerClientId"]="api.interactive.registerClientId",xt["interactive.getClientRoles"]="api.interactive.getClientRoles",xt["interactive.getClientInfo"]="api.interactive.getClientInfo",xt.executeDeepLink="api.links.openLink",xt["location.getLocation"]="api.location.getCurrentLocation",xt[H]="api.location.map.showLocation",xt["mail.openMailItem"]="api.mail.openMailItem",xt["mail.composeMail"]="api.mail.composeMail",xt.captureImage="api.media.captureImage",xt.getMedia="api.media.getMedia",xt.selectMedia="api.media.selectMedia",xt.viewImages="api.media.viewImages",xt["meeting.getAppContentStageSharingCapabilities"]="api.meeting.getAppContentStageSharingCapabilities",xt["meeting.getAppContentStageSharingState"]="api.meeting.getAppContentStageSharingState",xt["meeting.getAuthenticationTokenForAnonymousUser"]="api.meeting.getAuthenticationTokenForAnonymousUser",xt.getIncomingClientAudioState="api.meeting.getIncomingClientAudioState",xt["meeting.getLiveStreamState"]="api.meeting.getLiveStreamState",xt["meeting.getMeetingDetails"]="api.meeting.getMeetingDetails",xt["meeting.requestStartLiveStreaming"]="api.meeting.requestStartLiveStreaming",xt["meeting.requestStopLiveStreaming"]="api.meeting.requestStopLiveStreaming",xt["meeting.shareAppContentToStage"]="api.meeting.shareAppContentToStage",xt["meeting.stopSharingAppContentToStage"]="api.meeting.stopSharingAppContentToStage",xt[re]="api.meeting.appShareButton.setOptions",xt.toggleIncomingClientAudio="api.meeting.toggleIncomingClientAudio",xt["meeting.requestAppAudioHandling"]="api.meeting.requestAppAudioHandling",xt["meeting.updateMicState"]="api.meeting.updateMicState",xt["monetization.openPurchaseExperience"]="api.monetization.openPurchaseExperience",xt["meetingRoom.getPairedMeetingRoomInfo"]="api.meetingRoom.getPairedMeetingRoomInfo",xt["meetingRoom.sendCommandToPairedMeetingRoom"]="api.meetingRoom.sendCommandToPairedMeetingRoom",xt["notifications.showNotification"]="api.notifications.showNotification",xt[Pe]="api.pages.config.setConfig",xt[ke.failure]="api.pages.config.remove.failure",xt[ke.success]="api.pages.config.remove.success",xt[Te.failure]="api.pages.config.save.failure",xt[Te.success]="api.pages.config.save.success",xt[Oe]="api.pages.config.setValidityState",xt[_e]="api.pages.currentApp.navigateTo",xt[Ae]="api.pages.currentApp.navigateToDefaultPage",xt[Ce]="api.pages.backStack.navigateBack",xt[xe]="api.pages.fullTrust.enterFullscreen",xt[je]="api.pages.fullTrust.exitFullscreen",xt["settings.getSettings"]="api.pages.getConfig",xt.navigateCrossDomain="api.pages.navigateCrossDomain",xt["pages.navigateToApp"]="api.pages.navigateToApp",xt.returnFocus="api.pages.returnFocus",xt.shareDeepLink="api.pages.shareDeepLink",xt.setFrameContext="api.pages.setCurrentFrame",xt[Ee]="api.pages.tabs.getMruTabInstances",xt[we]="api.pages.tabs.getTabInstances",xt[Ie]="api.pages.tabs.navigateToTab",xt["people.selectPeople"]="api.people.selectPeople",xt[Re]="api.permissions.storageService.getPermissionStatus",xt["permissions.request"]="api.permissions.requestUserConsentForPermission",xt["profile.showProfile"]="api.profile.showProfile",xt["remoteCamera.getCapableParticipants"]="api.remoteCamera.getCapableParticipants",xt["remoteCamera.requestControl"]="api.remoteCamera.requestControl",xt["remoteCamera.sendControlCommand"]="api.remoteCamera.sendControlCommand",xt["remoteCamera.terminateSession"]="api.remoteCamera.terminateSession",xt.registerHandler="api.registerHandler",xt["search.unregister"]="api.search.unregister",xt["stageView.open"]="api.stageView.open",xt["teams.getTeamChannels"]="api.teams.getTeamChannels",xt["teams.refreshSiteUrl"]="api.teams.refreshSiteUrl",xt[Ge.getUserJoinedTeams]="api.teams.fullTrust.joinedTeams.getUserJoinedTeams",xt[qe]="api.teams.fullTrust.getConfigSetting",xt),Bt="App does not have the required permissions for this operation",zt=function(){function e(e,t){this.appSdkHost=e,this.telemetryService=t,this.handlers={},this.appDefinition=this.appSdkHost.getAppDefinition()}return e.prototype.registerHandler=function(e,t,n){var r;this.handlers[e]={callback:t,scenarioName:null!==(r=null==n?void 0:n.scenarioName)&&void 0!==r?r:Ft[e],errorCallback:null==n?void 0:n.errorCallback,isRestrictedToFullTrustApps:null==n?void 0:n.isRestrictedToFullTrustApps,isRestrictedToFullTrustOrLobApps:null==n?void 0:n.isRestrictedToFullTrustOrLobApps}},e.prototype.deleteMessageHandling=function(e){delete this.handlers[e]},e.prototype.canHandleMessage=function(e){return this.validateInitialization(e)&&void 0!==this.handlers[e]},e.prototype.handleMessage=function(e,t,n){var r,i,a,s;return Object(o.__awaiter)(this,void 0,void 0,(function(){var l,c,u,p;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:if(!this.validateInitialization(e))return[2,Promise.reject("SDK context is not initialized")];if(!this.canHandleMessage(e))return[2,Promise.reject("Handler cannot handle message: ".concat(e))];(l=this.handlers[e]).scenarioName&&this.telemetryService&&(c=this.telemetryService.createScenario(l.scenarioName,null===(r=this.appDefinition)||void 0===r?void 0:r.id,n),n&&c.markPhase("MessageDelay")),o.label=1;case 1:if(o.trys.push([1,3,,4]),l.isRestrictedToFullTrustApps&&!(null===(i=this.appSdkHost.getAppDefinition())||void 0===i?void 0:i.isFullTrust))throw Bt;if(l.isRestrictedToFullTrustOrLobApps&&!(null===(a=this.appSdkHost.getAppDefinition())||void 0===a?void 0:a.isFullTrust)&&!(null===(s=this.appSdkHost.getAppDefinition())||void 0===s?void 0:s.isLOB))throw Bt;if(!this.appSdkHost.checkIfCachedAndRequestAllowed(e))throw"Request not allowed when cached";return this.validateDependencies(e),[4,l.callback.apply(this,t)];case 2:return u=o.sent(),null==c||c.stop(),[2,u];case 3:return p=o.sent(),this.appSdkHost.getLogger().log(Je.Error,"handleMessage","Error in handling message",p),l.errorCallback?[2,l.errorCallback(p,c)]:(null==c||c.fail(p),[2,Promise.reject(p)]);case 4:return[2]}}))}))},e.prototype.validateInitialization=function(e){return e===D||this.appSdkHost.isInitialized()},e.prototype.validateDependencies=function(e){},e.prototype.cleanup=function(){},e}(),Ut=[{versionToDowngradeFrom:2,downgradeToPreviousVersion:function(e){var t,n,r,i,a;return{apiVersion:1,supports:Object(o.__assign)(Object(o.__assign)({},e.supports),{dialog:e.supports.dialog?{bot:null===(r=null===(n=null===(t=e.supports)||void 0===t?void 0:t.dialog)||void 0===n?void 0:n.url)||void 0===r?void 0:r.bot,card:null===(i=e.supports.dialog)||void 0===i?void 0:i.card,update:null===(a=e.supports.dialog)||void 0===a?void 0:a.update}:void 0})}}}],Wt=n("5hZV"),qt={errorCode:Qe.e.INTERNAL_ERROR,message:"An internal error occurred"},Gt=function(e,t,n){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(r){return null==n||n.fail("".concat(e," Api failed ").concat(t)),Kt(t)?[2,Yt(t)]:[2,Yt(qt)]}))}))},Jt=function(e,t,n){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(r){return null==n||n.fail("".concat(e," Api failed ").concat(t)),[2,Yt([!1,t])]}))}))},Xt=Zt=function(e,t,n,r){return void 0===r&&(r=!1),Object(o.__awaiter)(void 0,void 0,void 0,(function(){var i,a;return Object(o.__generator)(this,(function(s){switch(s.label){case 0:return[4,t(e)];case 1:return i=s.sent(),Kt(i)?[2,Promise.reject(i)]:(a=n?n(i):i,r&&Array.isArray(a)?[2,Yt(Object(o.__spreadArray)([null],a,!0))]:[2,Yt([null,a])])}}))}))},Kt=Yt=function(e){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){return null!=e?[2,{kind:"appResponse",data:e}]:[2,{kind:"appResponse"}]}))}))},$t=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var n;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return[4,e.apply(void 0,t)];case 1:return n=r.sent(),[2,Yt(n)]}}))}))},Qt={kind:"logResponse"},en=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return[4,e.apply(void 0,t)];case 1:return n.sent(),[2,Qt]}}))}))},tn=function(e,t){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var n,r;return Object(o.__generator)(this,(function(i){switch(i.label){case 0:if(!e)throw Xt(Qe.e.INTERNAL_ERROR,"PermissionService is not provided");i.label=1;case 1:return i.trys.push([1,3,,4]),[4,e.storageService.getPermissionStatus(t)];case 2:return n=i.sent(),[3,4];case 3:throw r=i.sent(),JSON.stringify(r);case 4:if(n==Wt.b.NeverAsked)throw Xt(Qe.e.INTERNAL_ERROR,"The app must specify "+t+" permission in its manifest and must be granted by the user. (the user has not been asked to grant permission).");if(n==Wt.b.Revoked)throw Xt(Qe.e.PERMISSION_DENIED,"user has explicitly not consented for device permission");if(n!==Wt.b.Consented)throw Xt(Qe.e.INTERNAL_ERROR,"Unrecognized device permission state: ".concat(n));return[2]}}))}))},nn=function(e){function t(t,n,i,o){var a,s,l,c,u=this;return(u=e.call(this,t,i)||this).appSdkHost=t,u.hubServices=n,u.telemetryService=i,u.hostVersionsInfo=o,u.initializationStatusReported=!1,u.setupAppLoadTimer=function(){var e,t=null!==(e=rt().extendedAppLoadTimeoutInMillis)&&void 0!==e?e:3e4;return u.registerAppInitMessageHandlers?window.setTimeout((function(){u.appSdkHost.setAppInitInfo({state:Qe.b.Failed,reason:r.AppInitTimeout}),u.failAppInitializationScenario("App Load timed out")}),t):window.setTimeout((,15e3)},u.stopAppInitializationScenario=u.failAppInitializationScenario=u.clearTimeoutTimer=function(){window.clearTimeout(u.appLoadTimerId)},u.appSdkHost.startAppInitializationScenario(),u.appInitializationScenario=null===(a=u.appSdkHost)||void 0===a?void 0:a.getAppInitializationScenario(),null===(s=u.appInitializationScenario)||void 0===s||s.markPhase("ClickToBeginLoad"),u.registerAppInitMessageHandlers=(null===(l=t.getAppDefinition())||void 0===l?void 0:l.showLoadingIndicator)||!1,(null==i?void 0:i.enableExtendedInitializationTracking)&&(u.extendedAppInitializationScenario=null===(c=u.telemetryService)||void 0===c?void 0:c.createScenario("appInitializationExtended")),u.appLoadTimerId=u.setupAppLoadTimer(),u}return Object(o.__extends)(t,e),t.prototype.initHandlers=function(){this.registerHandler(D,this.initialize),this.registerHandler("getContext",this.getContext,{errorCallback:this.onGetContextError}),this.registerHandler("readyToUnload",this.readyToUnload),this.registerHandler("appInitialization.appLoaded",this.handleAppLoaded),this.registerHandler("appInitialization.success",this.handleSuccess),this.registerHandler("appInitialization.failure",this.handleFailure),this.registerHandler("appInitialization.expectedFailure",this.handleExpectedFailure)},t.prototype.initialize=function(e,t,n){var r,i,o,a,s,l,c,u,p,d,h;n||(n=1),null===(r=this.appInitializationScenario)||void 0===r||r.markPhase("BeginLoadToInitialized"),null===(i=this.extendedAppInitializationScenario)||void 0===i||i.markPhase("BeginLoadToInitialized"),null===(o=this.telemetryService)||void 0===o||o.setAppSdkVersion(t),this.registerAppInitMessageHandlers||(this.appSdkHost.setAppInitInfo({state:Qe.b.Loaded}),this.stopAppInitializationScenario()),this.appSdkHost.setInitialized(!0);var f,g={apiVersion:2,hostVersionsInfo:this.hostVersionsInfo,supports:{app:{},appInstallDialog:this.hubServices.appInstallDialogService?{}:void 0,appEntity:this.hubServices.appEntityService?{}:void 0,barCode:this.hubServices.barCodeService?{}:void 0,calendar:this.hubServices.calendarService?{}:void 0,call:this.hubServices.callService?{}:void 0,chat:this.hubServices.chatService?{}:void 0,conversations:this.hubServices.conversationsService?{}:void 0,dialog:this.hubServices.dialogService?{url:this.hubServices.dialogService.urlService?{}:void 0,card:this.hubServices.dialogService.cardService&&this.hostVersionsInfo&&this.hostVersionsInfo.adaptiveCardSchemaVersion&&!kt(this.hostVersionsInfo.adaptiveCardSchemaVersion)?{}:void 0,update:this.hubServices.dialogService.updateService?{}:void 0}:void 0,files:this.hubServices.filesService?{}:void 0,interactive:this.hubServices.interactiveService?{}:void 0,mail:this.hubServices.mailService?{}:void 0,media:this.hubServices.mediaService?{}:void 0,meeting:this.hubServices.meetingService?{appShareButton:this.hubServices.meetingService.appShareButton?{}:void 0}:void 0,meetingRoom:this.hubServices.meetingRoomService?{}:void 0,notifications:this.hubServices.notificationService?{}:void 0,location:this.hubServices.locationService&&this.hubServices.locationService.mapService?{}:void 0,geoLocation:this.hubServices.locationService?{map:this.hubServices.locationService.mapService?{}:void 0}:void 0,logs:this.hubServices.logService?{}:void 0,pages:{appButton:(null===(a=this.hubServices.pageService)||void 0===a?void 0:a.appButtonService)?{}:void 0,tabs:(null===(s=this.hubServices.pageService)||void 0===s?void 0:s.tabsService)?{}:void 0,config:(null===(l=this.hubServices.pageService)||void 0===l?void 0:l.configService)?{}:void 0,backStack:(null===(c=this.hubServices.pageService)||void 0===c?void 0:c.backStackService)?{}:void 0,fullTrust:(null===(u=this.hubServices.pageService)||void 0===u?void 0:u.fullTrustService)?{}:void 0,currentApp:{}},people:this.hubServices.peopleService?{}:void 0,permissions:this.hubServices.devicePermissionService?{}:void 0,profile:this.hubServices.profileService?{}:void 0,remoteCamera:this.hubServices.remoteCameraService?{}:void 0,monetization:this.hubServices.monetizationService?{}:void 0,search:this.hubServices.searchService?{}:void 0,sharing:this.hubServices.sharingService?{}:void 0,stageView:this.hubServices.stageViewService?{}:void 0,teams:this.hubServices.teamsService?{fullTrust:(null===(p=this.hubServices.teamsService)||void 0===p?void 0:p.fullTrustService)?{joinedTeams:(null===(h=null===(d=this.hubServices.teamsService)||void 0===d?void 0:d.fullTrustService)||void 0===h?void 0:h.joinedTeamsService)?{}:void 0}:void 0}:void 0,teamsCore:this.hubServices.cacheManagementService?{}:void 0}};f=n<g.apiVersion?function(e,t,n){if(void 0===n&&(n=Ut),e.apiVersion<=t)return e;for(var r=e,i=0,o=n;i<o.length;i++){var a=o[i];if(r.apiVersion===a.versionToDowngradeFrom&&(r=a.downgradeToPreviousVersion(r)),r.apiVersion<=t)break}return r}(g,n):g;var m=[this.appSdkHost.getFrameContext(),this.appSdkHost.getHubInfo().clientType,"2.0.0",JSON.stringify(f)];return Yt(m)},t.prototype.getContext=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return t=vt,[4,this.appSdkHost.getAppContext()];case 1:return e=t.apply(void 0,[n.sent()]),[2,Yt(e)]}}))}))},t.prototype.onGetContextError=function(e,t){return null==t||t.fail(e),Yt({})},t.prototype.handleAppLoaded=function(){var e;return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){return null===(e=this.appInitializationScenario)||void 0===e||e.markPhase("InitializedToAppLoadedInvoked"),this.appSdkHost.setAppInitInfo({state:Qe.b.Loaded}),[2,Qt]}))}))},t.prototype.handleSuccess=function(){var e;return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){return this.markInitializationStatusAsReported()?(this.appSdkHost.setAppInitInfo({state:Qe.b.Loaded}),this.registerAppInitMessageHandlers&&this.stopAppInitializationScenario(),null===(e=this.extendedAppInitializationScenario)||void 0===e||e.stop(),[2,Qt]):[2,Qt]}))}))},t.prototype.handleFailure=function(e,t){var n;return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return this.markInitializationStatusAsReported()?(this.appSdkHost.setAppInitInfo({state:Qe.b.Failed,reason:t}),this.registerAppInitMessageHandlers&&this.failAppInitializationScenario(t),null===(n=this.extendedAppInitializationScenario)||void 0===n||n.fail(t),[2,Qt]):[2,Qt]}))}))},t.prototype.handleExpectedFailure=function(e,t){var n;return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return this.markInitializationStatusAsReported()?(this.appSdkHost.setAppInitInfo({state:Qe.b.Loaded}),this.registerAppInitMessageHandlers&&this.failAppInitializationScenario("Expected."+t),null===(n=this.extendedAppInitializationScenario)||void 0===n||n.fail("Expected."+t),[2,Qt]):[2,Qt]}))}))},t.prototype.markInitializationStatusAsReported=t.prototype.readyToUnload=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return this.appSdkHost.setAppInitInfo({state:Qe.b.Unloaded}),[2,Qt]}))}))},t.prototype.cleanup=t}(zt),rn=function(e){function t(t,n,r){var i=e.call(this,t,r)||this;return i.appSdkHost=t,i.appEntityService=n,i.telemetryService=r,i}return Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;this.registerHandler(h,(function(t,n,r,i){return Object(o.__awaiter)(e,void 0,void 0,(function(){var e;return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.appEntityService.selectAppEntity(n,r,i)];case 1:return e=t.sent(),[2,Yt([null,e])]}}))}))}),{errorCallback:function(e,t){return Gt(h,e,t)},isRestrictedToFullTrustApps:!0})},t.prototype.validateDependencies=function(){if(!this.appEntityService)throw"No appEntityService provided"},t}(zt),on=function(e){function t(t,n,r){var i=e.call(this,t,r)||this;return i.appInstallDialogService=n,i}return Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;this.registerHandler(l,(function(t,n){return en(e.appInstallDialogService.openAppInstallDialog,n)}),{errorCallback:function(e,t){return Gt(l,e,t)}})},t.prototype.validateDependencies=function(){if(!this.appInstallDialogService)throw"No appInstallDialogService provided"},t}(zt),an=function(){function e(e){this.appInstallDialogService=e}return e.prototype.tryGetDataFromLink=function(t){if(!this.appInstallDialogService)return null;if(t.origin!=Et)return null;var n=t.pathname.match(e.APP_INSTALL_DIALOG_URL_REGEX);return n?{appId:n[1]}:null},e.prototype.executeData=function(e){return this.appInstallDialogService.openAppInstallDialog(e)},e.APP_INSTALL_DIALOG_URL_REGEX=/^\/l\/app\/([^\/]+)\/?$/,e}(),sn=n("A3AF"),ln="Authorization code exceeds max length of 2048 characters",cn="Authorization code contains unexpected characters. Allowed characters are a-z, A-Z, 0-9, ., _, +, /, =, ~, and -",un="{authId}",pn="authId",dn="result",hn=function(){var e={};return{startAuth:function(t,n,r){var i=function(e){var t=new URL(e).searchParams.get(pn);return t&&t!==un?t:Object(sn.a)()}(t);return t=t.replace("{oauthRedirectMethod}","deeplink").replace(un,i).replace("{hostRedirectUrl}",r?function(e,t){var n=new URL(e);n.searchParams.delete(pn),n.searchParams.delete(dn);var r=decodeURIComponent(n.searchParams.toString()),i=""===r.trim();n.search="";var o="".concat(r).concat(i?"":"&");return encodeURIComponent("".concat(n.toString(),"?").concat(o).concat(pn,"=").concat(t,"&").concat(dn,"=").concat("{result}"))}(r,i):""),e[i]={handler:n,url:t,timeoutId:window.setTimeout((function(){n(!1,"OAuth session timeout"),delete e[i]}),12e4)},t},completeAuth:function(t,n){if("string"==typeof t&&"string"==typeof n){var r=e[t];if(r){window.clearTimeout(r.timeoutId);var i=RegExp("^[-a-zA-Z0-9._~+/=]+$");n.length>2048?r.handler(!1,ln):i.test(n)?r.handler(!0,n):r.handler(!1,cn),delete e[t]}}}}}(),fn=function(e){function t(t,n,r){var i=e.call(this,t,r)||this;return i.appSdkHost=t,i.authenticationService=n,i.telemetryService=r,i}return Object(o.__extends)(t,e),t.prototype.initHandlers=function(){this.registerHandler(u,this.handleGetUser,{errorCallback:this.onGetUserError,isRestrictedToFullTrustApps:!0}),this.registerHandler(c,this.handleGetAuthToken,{errorCallback:this.onGetAuthTokenError})},t.prototype.validateDependencies=function(){if(!this.authenticationService)throw"No authentication service is available"},t.prototype.handleGetUser=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.authenticationService.getUser()];case 1:return(e=r.sent())?[4,this.appSdkHost.getAppContext()]:[3,3];case 2:return t=r.sent(),n=Object(o.__assign)(Object(o.__assign)({},e.profile),{dataResidency:Mt(t.user.dataResidency)}),[2,Yt([!0,n])];case 3:return[2,Promise.reject("Failed to fetch the user profile")]}}))}))},t.prototype.onGetUserError=function(e,t){return null==t||t.fail("GetUser failed ".concat(e)),Yt([!1,e])},t.prototype.handleGetAuthToken=function(e,t,n,r){return Object(o.__awaiter)(this,void 0,void 0,(function(){var i,a,s;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return[4,this.appSdkHost.getAppContext()];case 1:return i=o.sent(),[4,lt(e.origin,t,this.appSdkHost.getHubInfo(),this.appDefinition,i)];case 2:return a=o.sent(),[4,this.authenticationService.acquireToken(a[0],n,r)];case 3:return s=o.sent(),[2,Yt([!0,s.token])]}}))}))},t.prototype.onGetAuthTokenError=function(e,t){return null==t||t.fail("GetAuthToken failed ".concat(e)),Yt([!1,e])},t}(zt),gn=function(e){eturn Object(o.__extends)(t,e),t.prototype.initHandlers=function(){e.prototype.initHandlers.call(this),this.registerHandler(p,this.handleNotifySuccess),this.registerHandler(d,this.handleNotifyFailure)},t.prototype.handleNotifySuccess=function(e,t){return this.appAuthSdkHost.closeWindow(),this.appAuthSdkHost.stopAuthWindowMonitor(),en(this.authenticationService.notifySuccess,t)},t.prototype.handleNotifyFailure=function(e,t){return this.appAuthSdkHost.closeWindow(),this.appAuthSdkHost.stopAuthWindowMonitor(),en(this.authenticationService.notifyFailure,t,Rn.Other)},t}(fn),mn=function(e){if(null==e||null===typeof e||"string"==typeof e||"boolean"==typeof e||"number"==typeof e)return e;if(Array.isArray(e))return e.map((function(e){return mn(e)}));if(e instanceof Date)return new Date(e.getTime());if("object"==typeof e){for(var t={},n=0,r=Object.getOwnPropertyNames(e);n<r.length;n++){var i=r[n];t[i]=mn(e[i])}return t}throw Error("Provided type '"+typeof e+"' ("+Object.prototype.toString.call(e)+") can't be cloned using deepCopy.")},vn=function(){eturn e.prototype.process=function(e){var t;return Object(o.__awaiter)(this,void 0,void 0,(function(){var n,r,i,a;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),r=(n=e.data).args,(r=n.args&&Array.isArray(n.args)?n.args.map(():[]).unshift(e),[4,this.callMessageHandler(n.func,r,n.timestamp)];case 1:return"appResponse"===(i=o.sent()).kind?(this.processHandlerResultHelper(n,i),this.appSdkHost.getLogger().log(Je.Info,this.TAG,"Function name: ".concat(e.data.func)),[2,Promise.resolve(!0)]):[3,3];case 2:return a=o.sent(),this.appSdkHost.getLogger().log(Je.Error,this.TAG,"Error in processing request: ".concat(null===(t=e.data)||void 0===t?void 0:t.func),a),[3,3];case 3:return[2,Promise.resolve(!1)]}}))}))},e.prototype.callMessageHandler=function(e,t,n){for(var r=0,i=this.messageHandlers;r<i.length;r++){var o=i[r];if(o.canHandleMessage(e))return o.handleMessage(e,t,n)}return Promise.reject("Unhandled message")},e.prototype.processHandlerResultHelper=function(e,t){var n=e.id,r=[];t.data&&(r=Array.isArray(t.data)?t.data:[t.data]),this.appSdkHost.postResponseToApp(n,r)},e.prototype.cleanup=e}(),yn=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.appSdkHost=t,i.authService=n,i.telemetryService=r,i.messageHandlers.push(new gn(t,n,r)),i.messageHandlers.push(new nn(t,{},r)),i.messageHandlers.forEach((function(e){return e.initHandlers()})),i}return Object(o.__extends)(t,e),t}(vn),bn=n("aCzR"),Sn=n("3M/p");!function(e){e.getFields=function(e,t){var n=[];return n.push(Object(Sn.c)("".concat(e,".Code"),t.code)),void 0!==t.type&&n.push(Object(Sn.d)("".concat(e,".Type"),t.type)),void 0!==t.tag&&n.push(Object(Sn.c)("".concat(e,".Tag"),t.tag)),void 0!==t.isExpected&&n.push(Object(Sn.a)("".concat(e,".IsExpected"),t.isExpected)),n.push(Object(Sn.d)("zC.Activity.Result","Office.System.Result")),n}}(jt||(jt={})),function(e){e.contractName="Office.System.Activity",e.getFields=function(t){var n="Activity",r=[];return void 0!==t.cV&&r.push(Object(Sn.d)("".concat(n,".CV"),t.cV)),r.push(Object(Sn.c)("".concat(n,".Duration"),t.duration)),r.push(Object(Sn.c)("".concat(n,".Count"),t.count)),r.push(Object(Sn.c)("".concat(n,".AggMode"),t.aggMode)),void 0!==t.success&&r.push(Object(Sn.a)("".concat(n,".Success"),t.success)),void 0!==t.result&&r.push.apply(r,jt.getFields("".concat(n,".Result"),t.result)),r.push(Object(Sn.d)("zC.Activity",e.contractName)),r}}(Dt||(Dt={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(Object(Sn.d)("".concat(e,".Id"),t.id)),void 0!==t.version&&n.push(Object(Sn.d)("".concat(e,".Version"),t.version)),void 0!==t.sessionId&&n.push(Object(Sn.d)("".concat(e,".SessionId"),t.sessionId)),n}}(Rt||(Rt={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.alias&&n.push(Object(Sn.d)("".concat(e,".Alias"),t.alias)),void 0!==t.primaryIdentityHash&&n.push(Object(Sn.d)("".concat(e,".PrimaryIdentityHash"),t.primaryIdentityHash)),void 0!==t.primaryIdentitySpace&&n.push(Object(Sn.d)("".concat(e,".PrimaryIdentitySpace"),t.primaryIdentitySpace)),void 0!==t.tenantId&&n.push(Object(Sn.d)("".concat(e,".TenantId"),t.tenantId)),void 0!==t.tenantGroup&&n.push(Object(Sn.d)("".concat(e,".TenantGroup"),t.tenantGroup)),void 0!==t.isAnonymous&&n.push(Object(Sn.a)("".concat(e,".IsAnonymous"),t.isAnonymous)),n}}(Ht||(Ht={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.name&&n.push(Object(Sn.d)("".concat(e,".Name"),t.name)),void 0!==t.state&&n.push(Object(Sn.d)("".concat(e,".State"),t.state)),n}}(Nt||(Nt={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(Object(Sn.c)("".concat(e,".Id"),t.id)),void 0!==t.name&&n.push(Object(Sn.d)("".concat(e,".Name"),t.name)),void 0!==t.commandSurface&&n.push(Object(Sn.d)("".concat(e,".CommandSurface"),t.commandSurface)),void 0!==t.parentName&&n.push(Object(Sn.d)("".concat(e,".ParentName"),t.parentName)),void 0!==t.triggerMethod&&n.push(Object(Sn.d)("".concat(e,".TriggerMethod"),t.triggerMethod)),void 0!==t.timeOffsetMs&&n.push(Object(Sn.c)("".concat(e,".TimeOffsetMs"),t.timeOffsetMs)),n}}(Vt||(Vt={})),function(e){e.getFields=function(e,t){var n=[];return n.push(Object(Sn.d)("".concat(e,".ErrorGroup"),t.errorGroup)),n.push(Object(Sn.c)("".concat(e,".Tag"),t.tag)),void 0!==t.code&&n.push(Object(Sn.c)("".concat(e,".Code"),t.code)),void 0!==t.id&&n.push(Object(Sn.c)("".concat(e,".Id"),t.id)),void 0!==t.count&&n.push(Object(Sn.c)("".concat(e,".Count"),t.count)),n}}(Lt||(Lt={}));var Cn,_n=Dt,An=jt,wn=Lt,En=Nt,In=Rt,Pn=Vt,On=Ht;!function(e){!function(e){!function(e){e.Activity=_n,e.Result=An,e.Error=wn,e.Funnel=En,e.Host=In,e.User=On,e.UserAction=Pn}(e.System||(e.System={}))}(e.Office||(e.Office={}))}(Cn||(Cn={}));var Tn=n("J78o"),kn=n("av1u"),xn=n("3qFY"),jn=n("svub"),Dn="object"==typeof window&&"object"==typeof window.performance&&"now"in window.performance&&(Dn=function(){return 1e3*Math.floor(window.performance.now())});var Rn,Hn=function(){function e(e,t,n){this.hubInfo=e,this.customTelemetryService=n,this.letterRegex=/[a-zA-Z]/,this.consumerTid="9188040d-6c67-4c5b-b112-36a304b66dad",this.telemetrySource="AppHostSdk",this.namespace="Office.AppHostingSdk",this.eventFieldPrefix="AppHost",this.ariaTenantToken="7ada8d16f9234e2093f080920f21dd7d-41cee27e-93c2-4a6b-a7aa-2001e852d387-7123",this.nexusTenantToken=bn.b,this.anonymousDataFields=Object(o.__spreadArray)([],Cn.Office.System.User.getFields("User",{isAnonymous:!0}),!0);var r=[Object(Sn.d)("".concat(this.eventFieldPrefix,".HostName"),this.hubInfo.name),Object(Sn.d)("".concat(this.eventFieldPrefix,".HostVersion"),this.hubInfo.version),Object(Sn.d)("".concat(this.eventFieldPrefix,".HostSdkVersion"),"2.0.0"),Object(Sn.d)("".concat(this.eventFieldPrefix,".HostSessionId"),this.hubInfo.sessionId),Object(Sn.d)("".concat(this.eventFieldPrefix,".TelemetrySource"),this.telemetrySource),Object(Sn.d)("".concat(this.eventFieldPrefix,".Platform"),t.app.host.clientType===et.b.web?"Web":"Desktop")];this.telemetryLogger=new Tn.a,this.telemetryLogger.setTenantToken(this.namespace,this.ariaTenantToken,this.nexusTenantToken);var i=Vn(t.user.dataResidency);i&&(this.oneDsSink=new xn.a(r,{endpointUrl:i}),this.telemetryLogger.telemetrySinks=[this.oneDsSink]),this.setAppContext(t),this.isTest=function(){try{return!1}catch(e){return!!window.Cypress}}(),this.enableExtendedInitializationTracking=(null==n?void 0:n.enableExtendedInitializationTracking)||!1}return e.prototype.createScenario=function(e,t,n){var r,i;void 0===n&&(n=Date.now()),t=null!=t?t:null===(r=this.appDefinition)||void 0===r?void 0:r.id;var o=this.isTest?void 0:this.telemetryLogger.createActivity(this.createTelemetryEvent(e,n,t)),a=null===(i=this.customTelemetryService)||void 0===i?void 0:i.createScenario(e,t,n),s=this.shouldLogToAria(e);return new Nn(this,s,n,a,o)},e.prototype.setAppSdkVersion=function(e){this.appSdkVersion=e},e.prototype.setAppContext=function(e){var t,n,r,i,o,a,s,l=this.appContext;if(this.appContext=e,this.oneDsSink){if(Ot(e)&&(!Ot(l)||e.user.id!==l.user.id)){var c=!e.user.id,u=void 0;if(c)u=this.anonymousDataFields;else{var p=(null===(n=null===(t=this.appContext.user)||void 0===t?void 0:t.tenant)||void 0===n?void 0:n.id)!==this.consumerTid;u=kn.f.getFields({primaryIdentityHash:null===(r=e.user)||void 0===r?void 0:r.id,primaryIdentitySpace:p?"UserObjectId":"MSAPuid",tenantId:null===(o=null===(i=this.appContext.user)||void 0===i?void 0:i.tenant)||void 0===o?void 0:o.id,tenantGroup:p?"Commercial":"Consumer",isAnonymous:c})}this.oneDsSink.addPersistentDataFields(u)}if(this.appContext.app.sessionId!==(null==l?void 0:l.app.sessionId)){var d=kn.e.getFields({id:null!==(a=this.appContext.app.sessionId)&&void 0!==a?a:""});this.oneDsSink.addPersistentDataFields(d)}if(this.appContext.app.locale!==(null==l?void 0:l.app.locale)){var h=Object(Sn.d)("Culture.UiLanguage",null!==(s=this.appContext.app.locale)&&void 0!==s?s:"");this.oneDsSink.addPersistentDataFields([h])}}},e.prototype.setAppDefinition=function(e){this.appDefinition=e},e.prototype.isSessionIdSet=e.prototype.createTelemetryEvent=function(e,t,n){var r,i,o,a,s,l,c;return{eventName:"".concat(this.namespace,".").concat(this.sanitizeScenarioName(e)),eventFlags:{dataCategories:2,diagnosticLevel:110},dataFields:[Object(Sn.d)("HostedAppId",null!=n?n:""),Object(Sn.d)("HostedAppEntityId",null!==(i=null===(r=this.appContext)||void 0===r?void 0:r.page.id)&&void 0!==i?i:""),Object(Sn.d)("HostedAppSdkVersion",null!==(o=this.appSdkVersion)&&void 0!==o?o:""),Object(Sn.d)("HostedAppFrameContext",null!==(s=null===(a=this.appContext)||void 0===a?void 0:a.page.frameContext)&&void 0!==s?s:""),Object(Sn.d)("HostedAppSessionId",null!==(c=null===(l=this.appContext)||void 0===l?void 0:l.app.sessionId)&&void 0!==c?c:"")],timestamp:t}},e.prototype.sanitizeScenarioName=function(e){for(var t="",n=!0,r=0;r<e.length;r++){var i=e.charAt(r);"."===i&&0!==r&&"."!==t.charAt(t.length-1)?(t+=i,n=!0):this.letterRegex.test(i)?n?(n=!1,t+=i.toUpperCase()):t+=i:n=!0}return t},e.prototype.shouldLogToAria=e}(),Nn=function(){function e(e,t,n,r,i){this.logger=e,this.shouldLogToAria=t,this.clientTimestamp=n,this.customScenario=r,this.activity=i,this.lastMark=function(e){var t=Date.now();return Dn()-1e3*(t-e)}(n)}return e.prototype.markPhase=function(e){var t,n,r,i=Dn(),o=i-this.lastMark;this.lastMark=i,null===(n=null===(t=this.activity)||void 0===t?void 0:t.dataFields)||void 0===n||n.push(Object(Sn.c)("Activity.Phase.".concat(e),o)),null===(r=this.customScenario)||void 0===r||r.markPhase(e)},e.prototype.stop=e.prototype.fail=function(e){var t,n,r;null===(n=null===(t=this.activity)||void 0===t?void 0:t.dataFields)||void 0===n||n.push(Object(Sn.d)("ErrorMessage",function(e){return e?function(e){return e&&(e=e.replace(wt,"email_removed")),e}(e):""}(e))),this.endActivity(!1),null===(r=this.customScenario)||void 0===r||r.fail(e)},e.prototype.endActivity=function(e){this.shouldLogToAria&&this.activity&&this.logger.isSessionIdSet()&&(this.activity.success=e,this.activity.endNow())},e}(),Vn=Ln=function(){function e(e,t,n,r,i,a){var s=this;this.hostWindow=e,this.context=t,this.authenticationService=n,this.logger=r,this.customTelemetryService=i,this.onAppInitStateChanged=a,this.initialized=!1,this.initializeAuthenticationContext=function(e){var t;s.context=e,s.contextPromise=null===(t=s.authenticationService)||void 0===t?void 0:t.getUser().then((function(e){var t,n,r,i,a,l,c,u,p,d=Object(o.__assign)(Object(o.__assign)({},null===(t=s.context)||void 0===t?void 0:t.user),{id:(null===(n=null==e?void 0:e.profile)||void 0===n?void 0:n.oid)||"",displayName:(null===(r=null==e?void 0:e.profile)||void 0===r?void 0:r.displayName)||"",loginHint:(null===(i=null==e?void 0:e.profile)||void 0===i?void 0:i.loginHint)||"",userPrincipalName:(null===(a=null==e?void 0:e.profile)||void 0===a?void 0:a.upn)||"",tenant:{id:(null===(l=null==e?void 0:e.profile)||void 0===l?void 0:l.tid)||"",sku:null===(p=null===(u=null===(c=s.context)||void 0===c?void 0:c.user)||void 0===u?void 0:u.tenant)||void 0===p?void 0:p.sku}}),h=Object(o.__assign)(Object(o.__assign)({},s.context.app),{userClickTime:s.getUserClickTime()}),f=Object(o.__assign)(Object(o.__assign)({},s.context),{app:h,user:d});return s.telemetryService.setAppContext(f),f}))},this.getContext=function(){return s.context},this.getAppContext=function(){return s.contextPromise?s.contextPromise.then((function(e){return e})).catch((function(){return s.context})):Promise.resolve(s.context)},this.getAppDefinition=function(){return s.appDefinition},this.checkIfCachedAndRequestAllowed=function(e){return!0},this.setAppInitInfo=this.getLogger=function(){return s.logger},this.telemetryService=new Hn(this.getHubInfo(),t,this.customTelemetryService),this.context.app.userClickTime&&(this.userClickTime=this.context.app.userClickTime)}return e.prototype.isInitialized=function(){return this.initialized},e.prototype.setInitialized=function(e){this.initialized=e},e.prototype.getHubInfo=function(){return{name:this.context.app.host.name,version:this.context.app.host.version,clientType:this.context.app.host.clientType,sessionId:this.context.app.host.sessionId}},e.prototype.unloadApp=function(e){this.telemetryService.createScenario("appTermination",e.id).stop()},e.prototype.getHostWindow=function(){return this.hostWindow},e.prototype.getFrameContext=function(){return this.context.page.frameContext},e.prototype.getUserClickTime=function(){return this.userClickTime},e.prototype.setUserClickTime=function(e){this.userClickTime=e},e.prototype.startAppInitializationScenario=function(){var e;this.appInitializationScenario=null===(e=this.telemetryService)||void 0===e?void 0:e.createScenario("appInitialization",void 0,this.getUserClickTime())},e.prototype.getAppInitializationScenario=function(){return this.appInitializationScenario},e}();!Rn||(Rn={}));var Mn,Fn=function(e){function t(t,n,r,i,a,l,c,u){var p,d=this;if((d=e.call(this,t,a,i,l,c,void 0)||this).hostWindow=t,d.openWindowInfo=n,d.appDefinition=r,d.authenticationService=i,d.context=a,d.logger=l,d.onAuthMessageReceived=function(e){return Object(o.__awaiter)(d,void 0,void 0,(function(){var t;return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return this.authWindow&&this.authWindow===e.source?((t=e.origin)!==this.origin&&ot(t,this.logger,this.appDefinition)&&(this.origin=e.origin),this.origin===t&&this.messageProcessor?[4,this.messageProcessor.process(e)]:[3,2]):[2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},d.setupAuthMessageHandlers=function(){d.authenticationService&&(d.messageProcessor=new yn(d,d.authenticationService,d.telemetryService))},d.context.page.frameContext!==et.a.authentication&&d.HandleError("Invalid frame context for scenario",Rn.InvalidFrameContext),d.appDefinition||d.HandleError("App definition not available",Rn.AppDefinitionUnavailable),ot(n.url,d.logger,r)&&d.hostWindow){var h=d.hostWindow,f="";n.width&&n.height&&(f="width=".concat(n.width,",height=").concat(n.height),null!=n.left&&null!=n.top&&(f="".concat(f,",left=").concat(n.left,",top=").concat(n.top))),u?d.hostWindow.open(hn.startAuth(n.url,(function(e,t){e?i.notifySuccess(t):(t!==ln&&t!==cn||l.log(Je.Error,"HostedWebContentAuthSdkService",t),i.notifyFailure(t))}),i.externalAuthRedirectUrl)):(d.authWindow=h.open(n.url,"appAuthWindow",f),d.authWindow?(d.origin=n.url,d.setUserClickTime(null!==(p=a.app.userClickTime)&&void 0!==p?p:Date.now()),d.setupAuthMessageHandlers(),d.globalWindowEventListener=new s(h),d.globalWindowEventListener.addListener("message",d.onAuthMessageReceived),d.startAuthWindowMonitor(),d.initializeAuthenticationContext(a)):d.HandleError("browser is blocking the url to open",Rn.BlockedByBrowser))}else d.HandleError("Auth url is not valid",Rn.InvalidAuthUrl);return d}return Object(o.__extends)(t,e),t.prototype.getHostWindow=t.prototype.postResponseToApp=t.prototype.isWindowOpen=t.prototype.closeWindow=t.prototype.sendResponseMessage=function(e,t){this.origin&&this.postMessage({id:e,args:t,origin:this.origin})},t.prototype.sendRequestMessage=t.prototype.startAuthWindowMonitor=function(){var e=this;this.stopAuthWindowMonitor(),this.authWindowMonitor=this.hostWindow.setInterval((function(){e.authWindowInterval()}),100)},t.prototype.authWindowInterval=function(){this.isWindowOpen()?this.sendRequestMessage("ping"):(this.HandleError("CancelledByUser",Rn.CancelledByUser),this.closeWindow(),this.stopAuthWindowMonitor())},t.prototype.stopAuthWindowMonitor=t.prototype.unloadApp=function(e){var t;this.unloadSDK(),null===(t=this.authWindow)||void 0===t||t.close()},t.prototype.unloadSDK=t.prototype.postMessage=function(e){var t;this.origin&&(null===(t=this.authWindow)||void 0===t||t.postMessage(e,this.origin))},t.prototype.HandleError=t}(Ln),Bn=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this;return i.appSdkHost=t,i.authenticationService=n,i.telemetryService=r,i.TAG="AuthenticationMessageHandler",i}return Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var t;e.prototype.initHandlers.call(this),this.registerHandler("authentication.authenticate",this.handleAuthenticate,{errorCallback:this.onAuthenticateError}),null===(t=this.authenticationService)||void 0===t||t.addEventListener("onExternalAuthDeeplink",()},t.prototype.handleAuthenticate=function(e,t,n,r,i){return Object(o.__awaiter)(this,void 0,void 0,(function(){var a,s,l,c=this;return Object(o.__generator)(this,(function(u){return this.appDefinition&&(a=e.data.id,s={getUser:function(){return c.authenticationService.getUser()},acquireToken:notifySuccess:function(e){return Object(o.__awaiter)(c,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){return this.appSdkHost.postResponseToApp(a,[!0,e]),this.appSdkHost.getLogger().log(Je.Debug,this.TAG,"notifySuccess func: ".concat(a)),[2]}))}))},notifyFailure:function(e){return Object(o.__awaiter)(c,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){return this.appSdkHost.postResponseToApp(a,[!1,e]),this.appSdkHost.getLogger().log(Je.Debug,this.TAG,"notifyFailure func: ".concat(a)),[2]}))}))},externalAuthRedirectUrl:this.authenticationService.externalAuthRedirectUrl,addEventListener:function(){},clearListeners:function(){}},l=Object(o.__assign)(Object(o.__assign)({},this.appSdkHost.getContext()),{app:Object(o.__assign)(Object(o.__assign)({},this.appSdkHost.getContext().app),{sessionId:Object(sn.a)(),userClickTime:Date.now()}),page:Object(o.__assign)(Object(o.__assign)({},this.appSdkHost.getContext().page),{frameContext:et.a.authentication})}),new Fn(this.appSdkHost.getHostWindow(),{url:t,width:n,height:r},this.appDefinition,s,l,this.appSdkHost.getLogger(),void 0,i)),[2,Qt]}))}))},t.prototype.onAuthenticateError=function(e,t){return null==t||t.fail("Authenticate failed ".concat(e)),Yt([!1,e])},t}(fn),zn=function(e){function t(t,n,r,i){var o=e.call(this,t,i)||this;return o.permissionsService=n,o.barCodeService=r,o}return Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;this.registerHandler(f,(function(t,n){return e.checkPermissionsAndCallScanBarCode(n)}),{errorCallback:function(e,t){return Gt(f,e,t)}})},t.prototype.checkPermissionsAndCallScanBarCode=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return[4,tn(this.permissionsService,Wt.a.Media)];case 1:return t.sent(),[2,Zt(e,this.barCodeService.scanBarCode)]}}))}))},t.prototype.validateDependencies=function(){if(!this.barCodeService)throw"No barCodeService provided";if(!this.permissionsService)throw"BarCode is provided but no permissionsService is provided"},t}(zt),Un=function(e){function t(t,n,r){var i=e.call(this,t,r)||this;return i.calendarService=n,i}return Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;this.registerHandler(m,(function(t,n){return Object(o.__awaiter)(e,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.calendarService.openCalendarItem(n)];case 1:return e.sent(),[2,Yt([!0])]}}))}))}),{errorCallback:function(e,t){return Jt(m,e,t)}}),this.registerHandler(g,(function(t,n){return Object(o.__awaiter)(e,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.calendarService.composeMeeting(n)];case 1:return e.sent(),[2,Yt([!0])]}}))}))}),{errorCallback:function(e,t){return Jt(g,e,t)}})},t.prototype.validateDependencies=function(){if(!this.calendarService)throw"No calendarService provided"},t}(zt),Wn=function(){function e(e){this.calendarService=e}return e.prototype.tryGetDataFromLink=function(e){var t;return this.calendarService?e.origin!=Et||"/l/meeting/new"!=e.pathname?null:{attendees:null===(t=e.searchParams.get("attendees"))||void 0===t?void 0:t.split(","),startTime:e.searchParams.get("startTime")||void 0,endTime:e.searchParams.get("endTime")||void 0,subject:e.searchParams.get("subject")||void 0,content:e.searchParams.get("content")||void 0}:null},e.prototype.executeData=function(e){return this.calendarService.composeMeeting(e)},e}();!Mn||(Mn={}));var qn=function(e){function t(t,n,r){var i=e.call(this,t,r)||this;return i.callService=n,i}return Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;this.registerHandler(v,(function(t,n){return $t(e.callService.startCall,n)}),{errorCallback:function(e,t){return Gt(v,e,t)}})},t.prototype.validateDependencies=function(){if(!this.callService)throw"No callService provided"},t}(zt),Gn=function(){function e(e){this.callService=e}return e.prototype.tryGetDataFromLink=function(e){var t;if(!this.callService)return null;if(e.origin!=Et||"/l/call/0/0"!=e.pathname)return null;var n=null===(t=e.searchParams.get("users"))||void 0===t?void 0:t.split(","),r="true"==e.searchParams.get("withVideo"),i=e.searchParams.get("source")||void 0;return n?{targets:n,requestedModalities:r?[Mn.Audio,Mn.Video]:[Mn.Audio],source:i}:null},e.prototype.executeData=function(e){return this.callService.startCall(e).then((function(){}))},e}(),Jn=function(e){function t(t,n,r){var i=e.call(this,t,r)||this;return i.appSdkHost=t,i.chatService=n,i}return Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;this.registerHandler(y,(function(t,n){return Object(o.__awaiter)(e,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.chatService.openChat(n)];case 1:return e.sent(),[2,Yt(!0)]}}))}))}),{errorCallback:function(e,t){return Jt(y,e,t)}})},t.prototype.validateDependencies=function(){if(!this.chatService)throw"No ChatService provided"},t}(zt),Xn=function(){function e(e){this.chatService=e}return e.prototype.tryGetDataFromLink=function(e){var t;if(!this.chatService)return null;if(e.origin!=Et||"/l/chat/0/0"!=e.pathname)return null;var n=null===(t=e.searchParams.get("users"))||void 0===t?void 0:t.split(",");return n?{members:n,topic:e.searchParams.get("topicName")||void 0,message:e.searchParams.get("message")||void 0}:null},e.prototype.executeData=function(e){return this.chatService.openChat(e)},e}(),Zn=function(e){function t(t,n,r){var i=e.call(this,t,r)||this;return i.appSdkHost=t,i.conversationsService=n,i}return Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;this.registerHandler(b,(function(t,n){return e.conversationsService.clearListeners(),e.conversationsService.addEventListener("startConversation",(function(t){return e.appSdkHost.sendRequestMessage("startConversation",t.data?[t.data.subEntityId,t.data.conversationId,t.data.channelId,t.data.entityId]:[])})),e.conversationsService.addEventListener("closeConversation",(function(t){return e.appSdkHost.sendRequestMessage("closeConversation",t.data?[t.data.subEntityId,t.data.conversationId,t.data.channelId,t.data.entityId]:[])})),$t(e.conversationsService.openConversation,n)}),{errorCallback:function(e,t){return Jt(W,e,t)}}),this.registerHandler(S,(function(t){return e.conversationsService.clearListeners(),en(e.conversationsService.closeConversation)}),{}),this.registerHandler(C,(,{isRestrictedToFullTrustApps:!0})},t.prototype.validateDependencies=function(){if(!this.conversationsService)throw"No ConversationsService provided"},t}(zt),Kn=n("xctO"),Yn="User cancelled/closed the task module.",$n=function(e){eturn Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;if(this.appSdkHost.getFrameContext()===et.a.task&&!this.dialogService)throw new Error("DialogService needs to be provided for FrameContexts.task");this.registerHandler(A,(function(t,n,r){return en(e.dialogService.urlService.submit,n,r)})),this.appSdkHost.getFrameContext()===et.a.task&&this.dialogService.urlService.addEventListener("onMessageForChild",(function(t){var n,r=null===(n=e.telemetryService)||void 0===n?void 0:n.createScenario("eventDispatch.onMessageForChild");null==r||r.stop(),Array.isArray(t.data)||(t.data=[t.data]),e.appSdkHost.sendRequestMessage("messageForChild",t.data?t.data:[])})),this.registerHandler(_,(function(t,n){if(n.card&&n.url)return Yt(["Values for both card and url were specified. One or the other, but not both, are allowed."]);var r;if(n.card)return"completionBotId"in(r=Object(o.__assign)(Object(o.__assign)({},n),{card:n.card,type:Kn.a.Card}))?e.callDialogWithBotAndAdaptiveCard(r):e.callDialogWithCardService(r);if(n.url){var i=e.appSdkHost.getContext();return ot(n.url,e.appSdkHost.getLogger(),e.appDefinition,i)?"completionBotId"in(r=Object(o.__assign)(Object(o.__assign)({},n),{url:n.url,type:Kn.a.Url}))?e.callDialogWithUrlAndBotService(r):e.callDialogWithJustUrlService(r):Yt(["Invalid dialog URL"])}return Yt(["You must specify a value for either card or url."])})),this.registerHandler("messageForParent",(function(t,n){return en(e.dialogService.urlService.messageForParent,n)})),this.registerHandler("messageForChild",()},t.prototype.validateDependencies=function(){if(!this.dialogService)throw"No dialogService provided";if(this.dialogService.cardService&&(!this.hostVersionsInfo||!this.hostVersionsInfo.adaptiveCardSchemaVersion||kt(this.hostVersionsInfo.adaptiveCardSchemaVersion)))throw"dialogService.cardService requires that the host specifies an adaptive card version of at least ".concat(Tt())},t.prototype.callDialogWithBotAndAdaptiveCard=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t;return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),this.dialogService.cardService.cardBotService?[4,this.dialogService.cardService.cardBotService.open(e)]:[3,2];case 1:return t=n.sent(),[2,Yt([null,t])];case 2:return[2,Yt(["Bot Adaptive Card based Dialogs are not supported"])];case 3:return[3,5];case 4:return n.sent(),[2,Yt([Yn])];case 5:return[2]}}))}))},t.prototype.callDialogWithCardService=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t;return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),this.dialogService.cardService?[4,this.dialogService.cardService.open(e)]:[3,2];case 1:return t=n.sent(),[2,Yt([null,t])];case 2:return[2,Yt(["Adaptive Card based Dialogs are not supported"])];case 3:return[3,5];case 4:return n.sent(),[2,Yt([Yn])];case 5:return[2]}}))}))},t.prototype.callDialogWithUrlAndBotService=function(e){return this.dialogService.urlService.urlBotService?this.addRemoveEventListenerAndCreateSDKResponse(this.dialogService.urlService.urlBotService.open,e):Yt(["Dialogs with completionBotId are not supported"])},t.prototype.callDialogWithJustUrlService=t.prototype.addRemoveEventListenerAndCreateSDKResponse=function(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function(){var n,r=this;return Object(o.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,3,4]),this.dialogService.urlService.clearListeners(),this.dialogService.urlService.addEventListener("onMessageForParent",(function(e){var t,n=null===(t=r.telemetryService)||void 0===t?void 0:t.createScenario("eventDispatch.onMessageForParent");null==n||n.stop(),Array.isArray(e.data)||(e.data=[e.data]),r.appSdkHost.sendRequestMessage("messageForParent",e.data?e.data:[])})),[4,e(t)];case 1:return n=i.sent(),[2,Yt([null,n])];case 2:return i.sent(),[2,Yt([Yn])];case 3:return this.dialogService.urlService.clearListeners(),[7];case 4:return[2]}}))}))},t}(zt),Qn=function(e){function t(t,n,r){var i=e.call(this,t,r)||this;return i.appSdkHost=t,i.dialogUpdateService=n,i}return Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;this.registerHandler(w,(function(t,n){return en(e.dialogUpdateService.resize,n)}))},t.prototype.validateDependencies=function(){if(!this.dialogUpdateService)throw"No dialogUpdateService provided"},t}(zt),er=function(e){eturn Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;this.registerHandler(T,(function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i={entityId:n[0],title:n[1],description:n[2],type:n[3],objectUrl:n[4],downloadUrl:n[5],webPreviewUrl:n[6],webEditUrl:n[7],baseUrl:n[8],editFile:n[9],subEntityId:n[10],viewerAction:n[11],fileOpenPreference:n[12]};return i.type&&i.objectUrl?en(e.filesService.openFilePreview,i):Promise.reject("Invalid File Preview Parameters")}),{isRestrictedToFullTrustOrLobApps:!0}),this.registerHandler(O,(function(t,n){return Zt(n,e.filesService.getCloudStorageFolders)}),{errorCallback:function(e,t){return Gt(O,e,t)},isRestrictedToFullTrustApps:!0}),this.registerHandler(E,(function(t,n){return Zt(n,e.filesService.addCloudStorageFolder,(,!0)}),{errorCallback:function(e,t){return Gt(E,e,t)},isRestrictedToFullTrustApps:!0}),this.registerHandler(P,(function(t,n,r){return Zt({channelId:n,folderToDelete:r},e.filesService.deleteCloudStorageFolder)}),{errorCallback:function(e,t){return Gt(P,e,t)},isRestrictedToFullTrustApps:!0}),this.registerHandler(I,(function(t,n,r,i,o,a){return Zt({selectedFiles:n,providerCode:r,destinationFolder:i,destinationProviderCode:o,isMove:a},e.filesService.copyMoveFiles)}),{errorCallback:function(e,t){return Gt(I,e,t)},isRestrictedToFullTrustApps:!0}),this.registerHandler(k,(function(t,n){return void 0===n&&(n=!1),Zt(n,e.filesService.getExternalProviders)}),{errorCallback:function(e,t){return Gt(k,e,t)},isRestrictedToFullTrustApps:!0}),this.registerHandler(j,(function(t,n,r){return Zt({folder:n,providerCode:r},e.filesService.getCloudStorageFolderContents)}),{errorCallback:function(e,t){return Gt(j,e,t)},isRestrictedToFullTrustApps:!0}),this.registerHandler(x,(function(t,n,r,i){return Zt({file:n,providerCode:r,fileOpenPreference:i},e.filesService.openCloudStorageFile)}),{errorCallback:function(e,t){return Gt(x,e,t)},isRestrictedToFullTrustApps:!0})},t.prototype.validateDependencies=function(){if(!this.filesService)throw"No FilesService provided"},t}(zt),tr=function(e){function t(t,n,r){var i=e.call(this,t,r)||this;return i.appSdkHost=t,i.interactiveService=n,i.telemetryService=r,i}return Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;this.registerHandler(N,(function(){return Zt(e.getParamsWithOrigin({}),e.interactiveService.getFluidTenantInfo)}),{errorCallback:function(e,t){return Gt(N,e,t)}}),this.registerHandler(V,(function(t,n){return Zt(e.getParamsWithOrigin({containerId:n}),e.interactiveService.getFluidToken)}),{errorCallback:function(e,t){return Gt(V,e,t)}}),this.registerHandler(L,(function(){return Zt(e.getParamsWithOrigin({}),e.interactiveService.getFluidContainerId)}),{errorCallback:function(e,t){return Gt(L,e,t)}}),this.registerHandler(M,(function(t,n){return Zt(e.getParamsWithOrigin({containerId:n}),e.interactiveService.setFluidContainerId)}),{errorCallback:function(e,t){return Gt(M,e,t)}}),this.registerHandler(F,(function(){return Zt(e.getParamsWithOrigin({}),e.interactiveService.getNtpTime)}),{errorCallback:function(e,t){return Gt(F,e,t)}}),this.registerHandler(B,(function(t,n){return Zt(e.getParamsWithOrigin({clientId:n}),e.interactiveService.registerClientId)}),{errorCallback:function(e,t){return Gt(B,e,t)}}),this.registerHandler(z,(function(t,n){return Zt(e.getParamsWithOrigin({clientId:n}),e.interactiveService.getClientRoles)}),{errorCallback:function(e,t){return Gt(z,e,t)}}),this.registerHandler(U,(function(t,n){return Zt(e.getParamsWithOrigin({clientId:n}),e.interactiveService.getClientInfo)}),{errorCallback:function(e,t){return Gt(U,e,t)}})},t.prototype.getParamsWithOrigin=function(e){var t=this.appSdkHost.getOrigin();if(!t)throw"Origin not set of AppSdkHost";return Object(o.__assign)(Object(o.__assign)({},e),{origin:t})},t.prototype.validateDependencies=function(){if(!this.interactiveService)throw"No interactiveService provided"},t}(zt),nr=function(){function e(e){this.linkHandlers=e}return e.prototype.tryGetDataFromLink=function(e){for(var t=0,n=this.linkHandlers;t<n.length;t++){var r=n[t],i=r.tryGetDataFromLink(e);if(null!=i)return[r,i]}return null},e.prototype.executeData=e}(),rr=function(e){eturn Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;this.registerHandler(W,(function(t,n){return Object(o.__awaiter)(e,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.executeLink(n)];case 1:return e.sent(),[2,Yt(!0)]}}))}))}),{errorCallback:function(e,t){return Jt(W,e,t)}})},t.prototype.executeLink=function(e){try{var t=new URL(e);if(this.appSdkHost.getHubInfo().name!==et.c.teams&&this.appSdkHost.getHubInfo().name!==et.c.teamsModern&&this.linkHandler){var n=this.linkHandler.tryGetDataFromLink(t);if(null!=n)return this.linkHandler.executeData(n)}}catch(e){this.appSdkHost.getLogger().log(Je.Error,"LinkMessageHandler","There is an error parsing the URL",e)}return this.linkService.openLink(e)},t.prototype.validateDependencies=function(){if(!this.linkService)throw"No linkService provided"},t}(zt),ir=function(){eturn e.prototype.tryGetDataFromLink=function(e){if(!this.pageService)return null;if("https:"!==e.protocol)return null;if(e.origin!=Et)return null;var t="/l/entity/";if(!e.pathname.startsWith(t))return null;var n=e.pathname.substring(t.length).split("/");if(2!==n.length)return null;var r,i,o,a=n[0],s=n[1],l=e.searchParams.get("webUrl")||void 0,c=e.searchParams.get("context");if(c)try{var u=JSON.parse(c);u&&"object"==typeof u&&(r=u.subEntityId,i=u.channelId,o=u.chatId)}catch(e){}return{appId:a,pageId:s,webUrl:l,subPageId:r,channelId:i,chatId:o}},e.prototype.executeData=e}(),or="location.map is not supported on this host.",ar=function(e){eturn Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;this.registerHandler(R,(function(t,n){return e.handleGetCurrentLocation(n)}),{errorCallback:function(e,t){return Gt(R,e,t)}}),this.registerHandler(H,(,{errorCallback:function(e,t){return Gt(H,e,t)}})},t.prototype.handleShowLocation=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){if(this.locationService.mapService)return[2,Zt(e,this.locationService.mapService.showLocation)];throw Xt(Qe.e.INTERNAL_ERROR,or)}))}))},t.prototype.handleGetCurrentLocation=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return[4,tn(this.permissionsService,Wt.a.GeoLocation)];case 1:if(t.sent(),!e.allowChooseLocation&&!e.showMap)return[2,Zt(e,this.locationService.getCurrentLocation)];if(this.locationService.mapService)return[2,this.handleGetLocationServiceInMap(e)];throw Xt(Qe.e.INTERNAL_ERROR,or)}}))}))},t.prototype.validateDependencies=function(){if(!this.locationService)throw"No locationService provided";if(!this.permissionsService)throw"LocationService is provided but no permissionsService is provided"},t.prototype.handleGetLocationServiceInMap=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){return!e.allowChooseLocation&&e.showMap?[2,Zt(null,this.locationService.mapService.getCurrentLocationOnMap)]:[2,Zt(null,this.locationService.mapService.chooseLocation)]}))}))},t}(zt),sr=function(e){function t(t,n,r){var i=e.call(this,t,r)||this;return i.logService=n,i}return Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;this.registerHandler("log.receive",(function(t,n){return en(e.logService.handleAppLog,n)}))},t.prototype.validateDependencies=function(){if(!this.logService)throw"No logService provided"},t}(zt),lr=function(e){function t(t,n,r){var i=e.call(this,t,r)||this;return i.appSdkHost=t,i.mailService=n,i.telemetryService=r,i}return Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;this.registerHandler(G,(function(t,n){return Object(o.__awaiter)(e,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.mailService.openMailItem(n)];case 1:return e.sent(),[2,Yt([!0])]}}))}))}),{errorCallback:function(e,t){return Jt(G,e,t)}}),this.registerHandler(q,(function(t,n){return Object(o.__awaiter)(e,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.mailService.composeMail(n)];case 1:return e.sent(),[2,Yt([!0])]}}))}))}),{errorCallback:function(e,t){return Jt(q,e,t)}})},t.prototype.validateDependencies=function(){if(!this.mailService)throw"No mailService provided"},t}(zt),cr=function(e){eturn Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;this.registerHandler(Z,(,{errorCallback:function(e,t){return Gt(Z,e,t)}}),this.registerHandler(J,(,{errorCallback:function(e,t){return Gt(Z,e,t)}}),this.registerHandler(X,(function(t,n){return Object(o.__awaiter)(e,void 0,void 0,(function(){var e=this;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.mediaService.getMedia(n,()];case 1:return r.sent(),[2,Qt]}}))}))}),{errorCallback:this.onGetMediaError}),this.registerHandler(K,(,{errorCallback:)},t.prototype.validateDependencies=t.prototype.onGetMediaError=function(e,t){return null==t||t.fail("GetMedia failed ".concat(e)),Yt({error:qt})},t.prototype.postMediaResult=function(e,t){return t.mediaChunk?(this.appSdkHost.postResponseToApp(e.id,[t],t.mediaChunk.chunkSequence>0),Promise.resolve()):Promise.reject("empty media chunk")},t}(zt),ur={mediaType:1,maxMediaCount:1,imageProps:{sources:[1,2],startMode:1,ink:!0,cameraSwitcher:!0,textSticker:!0,enableFilter:!1}},pr=function(e){eturn Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;this.registerHandler(ee,(,{errorCallback:function(e,t){return Gt(ee,e,t)}}),this.registerHandler(le,(function(){return Zt(null,e.meetingService.toggleIncomingClientAudio)}),{errorCallback:function(e,t){return Gt(le,e,t)}}),this.registerHandler(ne,(function(){return Zt(null,e.meetingService.getMeetingDetails)}),{errorCallback:function(e,t){return Gt(ne,e,t)}}),this.registerHandler(Q,(function(){return Zt(null,e.meetingService.getAuthenticationTokenForAnonymousUser)}),{errorCallback:function(e,t){return Gt(Q,e,t)},isRestrictedToFullTrustApps:!0}),this.registerHandler(te,(function(){return Zt(null,e.meetingService.getLiveStreamState)}),{errorCallback:function(e,t){return Gt(te,e,t)}}),this.registerHandler(ie,(function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return $t.apply(void 0,Object(o.__spreadArray)([e.meetingService.requestStartLiveStreaming],n,!1))}),{errorCallback:function(e,t){return Gt(ie,e,t)}}),this.registerHandler(oe,(function(){return Zt(null,e.meetingService.requestStopLiveStreaming)}),{errorCallback:function(e,t){return Gt(oe,e,t)}}),this.registerHandler(ae,(function(t,n){return Zt(n,e.meetingService.shareAppContentToStage)}),{errorCallback:function(e,t){return Gt(ae,e,t)}}),this.registerHandler(re,(,{errorCallback:function(e,t){return Gt(re,e,t)}}),this.registerHandler(Y,(function(){return Zt(null,e.meetingService.getAppContentStageSharingCapabilities)}),{errorCallback:function(e,t){return Gt(Y,e,t)}}),this.registerHandler(se,(function(){return Zt(null,e.meetingService.stopSharingAppContentToStage)}),{errorCallback:function(e,t){return Gt(se,e,t)}}),this.registerHandler($,(function(){return Zt(null,e.meetingService.getAppContentStageSharingState)}),{errorCallback:function(e,t){return Gt($,e,t)}}),this.registerHandler(ce,(function(t,n){return Zt(n,e.meetingService.requestAppAudioHandling)}),{errorCallback:function(e,t){return Gt(ce,e,t)}}),this.registerHandler(ue,(function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return $t.apply(void 0,Object(o.__spreadArray)([e.meetingService.updateMicState],n,!1))}),{errorCallback:function(e,t){return Gt(ue,e,t)}})},t.prototype.validateDependencies=function(){if(!this.meetingService)throw"No meetingService provided"},t}(zt),dr=function(e){function t(t,n,r){var i=e.call(this,t,r)||this;return i.appSdkHost=t,i.meetingRoomService=n,i.telemetryService=r,i}return Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;this.registerHandler(pe,(function(){return Zt(null,e.meetingRoomService.getPairedMeetingRoomInfo)}),{errorCallback:function(e,t){return Gt(pe,e,t)}}),this.registerHandler(de,(function(t,n){return Zt(n,e.meetingRoomService.sendCommandToPairedMeetingRoom)}),{errorCallback:function(e,t){return Gt(de,e,t)}})},t.prototype.validateDependencies=function(){if(!this.meetingRoomService)throw"No meetingRoomService provided"},t}(zt),hr=function(e){function t(t,n,r){var i=e.call(this,t,r)||this;return i.monetizationService=n,i}return Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;this.registerHandler(he,(function(t,n){return $t(e.monetizationService.openPurchaseExperience,n)}),{errorCallback:function(e,t){return Gt(he,e,t)}})},t.prototype.validateDependencies=function(){if(!this.monetizationService)throw"No monetizationService provided"},t}(zt),fr=function(e){function t(t,n,r){var i=e.call(this,t,r)||this;return i.appSdkHost=t,i.notificationService=n,i}return Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;this.registerHandler(fe,(function(t,n){return en(e.notificationService.showNotification,n)}),{isRestrictedToFullTrustApps:!0})},t.prototype.validateDependencies=function(){if(!this.notificationService)throw"No NotificationService provided"},t}(zt),gr=function(e){function t(t,n,r){var i=e.call(this,t,r)||this;return i.appSdkHost=t,i.configService=n,i.telemetryService=r,i}return Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;if(this.appSdkHost.getFrameContext()===et.a.settings&&!this.configService)throw new Error("Config Service needs to be implemented when in settings frame context");this.registerHandler(Pe,(function(t,n){return $t(e.configService.setConfig,n)}),{errorCallback:function(e,t){return Jt(Pe,e,t)}}),this.registerHandler(Oe,(function(t,n){return en(e.configService.setValidityState,n)})),this.registerHandler(Te.success,(function(t){return en(e.configService.onSaveSuccess)})),this.registerHandler(Te.failure,(function(t,n){return en(e.configService.onSaveFailure,n)})),this.registerHandler(ke.success,(function(t){return en(e.configService.onRemoveSuccess)})),this.registerHandler(ke.failure,(function(t,n){return en(e.configService.onRemoveFailure,n)}))},t.prototype.validateDependencies=function(){if(!this.configService)throw"No configService provided"},t}(zt),mr=function(e){function t(t,n,r){var i=e.call(this,t,r)||this;return i.appSdkHost=t,i.pageService=n,i.telemetryService=r,i.getConfig=function(){return Object(o.__awaiter)(i,void 0,void 0,(function(){var e;return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return this.pageService&&this.pageService.getConfig?[4,this.pageService.getConfig()]:[3,2];case 1:return e=t.sent(),[3,3];case 2:e=this.getDefaultConfig(),t.label=3;case 3:return[2,Yt(e)]}}))}))},i}return Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;this.registerHandler(ge,this.getConfig),this.registerHandler(ye,(function(t,n){return en(e.pageService.returnFocus,n)})),this.registerHandler(be,this.handleSetCurrentFrame),this.registerHandler(me,this.handleLoadCrossDomainUrl,{errorCallback:function(e,t){return Jt(me,e,t)}}),this.registerHandler(ve,(function(t,n){return Object(o.__awaiter)(e,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.pageService.navigateToApp(n)];case 1:return e.sent(),[2,Yt(!0)]}}))}))}),{errorCallback:function(e,t){return Jt(ve,e,t)}}),this.registerHandler(Se,(function(t,n,r,i){return en(e.pageService.shareDeepLink,{subEntityId:n,subEntityLabel:r,subEntityWebUrl:i})})),this.registerHandler(_e,this.buildParamsAndCallNavigateToApp,{errorCallback:function(e,t){return Gt(_e,e,t)}}),this.registerHandler(Ae,this.buildParamsAndCallNavigateToApp,{errorCallback:function(e,t){return Gt(Ae,e,t)}})},t.prototype.validateDependencies=function(e){if(!this.pageService&&e!==ge)throw"No pageService provided"},t.prototype.getDefaultConfig=function(){var e=this.appSdkHost.getOrigin();if(!e)throw new Error("Origin not set of AppSdkHost");var t=this.appSdkHost.getContext(),n=this.appSdkHost.getAppDefinition(),r=n&&It(n,t.page.id);return{contentUrl:e,entityId:t.page.id,suggestedDisplayName:r}},t.prototype.handleSetCurrentFrame=function(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e;return Object(o.__generator)(this,(function(n){return e=this.appSdkHost.getContext(),ot(t.contentUrl,this.appSdkHost.getLogger(),this.appDefinition,e)&&ot(t.websiteUrl,this.appSdkHost.getLogger(),this.appDefinition,e)&&this.pageService.setCurrentFrame(t),[2,Qt]}))}))},t.prototype.handleLoadCrossDomainUrl=function(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e,n,r,i,a;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return e=ot,n=[t,this.appSdkHost.getLogger(),this.appDefinition],[4,this.appSdkHost.getAppContext()];case 1:return e.apply(void 0,n.concat([o.sent()]))?(i=(r=this.appSdkHost).load,a=[t],[4,this.appSdkHost.getAppContext()]):[3,4];case 2:return[4,i.apply(r,a.concat([o.sent()]))];case 3:return o.sent(),[2,Yt(!0)];case 4:throw Ye}}))}))},t.prototype.buildParamsAndCallNavigateToApp=function(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e,n,r;return Object(o.__generator)(this,(function(i){if(!(null==(n=this.appSdkHost.getAppDefinition())?void 0:n.id))throw Xt(Qe.e.INTERNAL_ERROR,"An error ocured while locating application ID");e=t?{appId:null==n?void 0:n.id,pageId:t.pageId,subPageId:t.subPageId}:{appId:null==n?void 0:n.id,pageId:(null==n?void 0:n.pages.static[0].entityId)?n.pages.static[0].entityId:""};try{r=Zt(e,this.pageService.navigateToApp)}catch(e){throw Xt(Qe.e.INTERNAL_ERROR,e)}return[2,r]}))}))},t}(zt),vr=function(e){function t(t,n,r){var i=e.call(this,t,r)||this;return i.appSdkHost=t,i.pageTabsService=n,i.telemetryService=r,i}return Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;this.registerHandler(Ie,(function(t,n){return $t(e.pageTabsService.navigateToTab,n)}),{errorCallback:function(e,t){return Jt(Ie,e,t)}}),this.registerHandler(we,(function(t,n){return $t(e.pageTabsService.getTabInstances,n)}),{errorCallback:function(t,n){return e.onGetTabsError(we,t,n)}}),this.registerHandler(Ee,(function(t,n){return $t(e.pageTabsService.getMruTabInstances,n)}),{errorCallback:)},t.prototype.validateDependencies=function(){if(!this.pageTabsService)throw"No pageTabsService provided"},t.prototype.onGetTabsError=function(e,t,n){return null==n||n.fail("".concat(e," failed ").concat(t)),Yt({teamTabs:[]})},t}(zt),yr=function(e){function t(t,n,r){var i=e.call(this,t,r)||this;return i.appSdkHost=t,i.backStackService=n,i.telemetryService=r,i}return Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;this.registerHandler(Ce,(function(t){return $t(e.backStackService.navigateBack)}),{errorCallback:function(e,t){return Jt(Ce,e,t)}})},t.prototype.validateDependencies=function(){if(!this.backStackService)throw"No backStackService provided"},t}(zt),br=function(e){function t(t,n,r){var i=e.call(this,t,r)||this;return i.appSdkHost=t,i.fullTrustService=n,i}return Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;this.registerHandler(xe,(function(t){return en(e.fullTrustService.enterFullscreen)}),{isRestrictedToFullTrustApps:!0}),this.registerHandler(je,(function(t){return en(e.fullTrustService.exitFullscreen)}),{isRestrictedToFullTrustApps:!0})},t.prototype.validateDependencies=function(){if(!this.fullTrustService)throw"No fullTrustService provided"},t}(zt),Sr=function(e){function t(t,n,r){var i=e.call(this,t,r)||this;return i.peopleService=n,i}return Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;this.registerHandler(De,(function(t,n){return Zt(n,e.peopleService.selectPeople)}),{errorCallback:function(e,t){return Gt(De,e,t)}})},t.prototype.validateDependencies=function(){if(!this.peopleService)throw"No peopleService provided"},t}(zt),Cr=function(e){function t(t,n,r){var i=e.call(this,t,r)||this;return i.permissionsService=n,i}return Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;this.registerHandler(He,(function(t,n){return e.handleRequestUserConsentAndStorePermissions(n)}),{errorCallback:function(e,t){return Gt(He,e,t)}}),this.registerHandler(Re,(function(t,n){return Zt(n,e.permissionsService.storageService.getPermissionStatus,()}),{errorCallback:function(e,t){return Gt(Re,e,t)}})},t.prototype.handleRequestUserConsentAndStorePermissions=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return this.verifyPermisionsInManifest(e),[4,this.checkPermissionsInStorage(e)];case 1:return(t=r.sent())!==Wt.b.NeverAsked?[2,Yt([null,t==Wt.b.Consented])]:[4,this.requestUserConsent(e)];case 2:return n=r.sent(),[4,this.storePermissions(n)];case 3:return r.sent(),[2,Yt([null,n.status==Wt.b.Consented])]}}))}))},t.prototype.verifyPermisionsInManifest=function(e){if(!this.appDefinition.devicePermissions.includes(e))throw Xt(Qe.e.INTERNAL_ERROR,"permission does not exist in the app manifest")},t.prototype.checkPermissionsInStorage=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.permissionsService.storageService.getPermissionStatus(e)];case 1:return[2,t.sent()]}}))}))},t.prototype.requestUserConsent=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t;return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.permissionsService.requestUserConsentForPermission(e)];case 1:return t=n.sent(),[3,3];case 2:throw n.sent(),Xt(Qe.e.INTERNAL_ERROR,"An error ocured while requesting the user consent for permissions");case 3:return[2,t]}}))}))},t.prototype.storePermissions=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.permissionsService.storageService.storePermissionConsent(e)];case 1:return t.sent(),[2]}}))}))},t.prototype.validateDependencies=function(){if(!this.permissionsService)throw"No permissionsService provided"},t}(zt),_r=function(e){function t(t,n,r){var i=e.call(this,t,r)||this;return i.appSdkHost=t,i.profileService=n,i}return Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;this.registerHandler(Ne,(function(t,n){var r=e.appSdkHost.getFrame(),i=r?r.getBoundingClientRect():{x:0,y:0},o=DOMRect.fromRect({x:n.targetRectangle.x+i.x,y:n.targetRectangle.y+i.y,width:n.targetRectangle.width,height:n.targetRectangle.height});return Zt({modality:n.modality,persona:n.persona,targetElementBoundingRect:o,triggerType:n.triggerType},e.profileService.showProfile)}),{errorCallback:function(e,t){return Gt(Ne,e,t)}})},t.prototype.validateDependencies=function(){if(!this.profileService)throw"No profileService provided"},t}(zt),Ar=function(e){function t(t,n,r,i,o,a,s,l,c){var u=e.call(this,t,l)||this;if(u.appSdkHost=t,u.bootstrapRegistrationState=c,u.registeredHandlers=new Map,u.userSettings=[],u.registerHandlerImpl("themeChange",(function(e){return t.onThemeChanged=function(t){return e({data:[t]})}}),"eventDispatch.themeChange"),u.registerHandlerImpl("userSettingsChange",(function(e){return t.onUserSettingsChanged=function(t,n){return u.userSettings.includes(t)&&e({data:[t,n]})}}),"eventDispatch.userSettingsChange"),r&&(r.clearListeners(),u.registerHandlerImpl("log.request",(function(e){return r.addEventListener("log.request",e)}),"eventDispatch.log.request",{isRestrictedToFullTrustApps:!0})),i&&(i.clearListeners(),u.registerHandlerImpl("meeting.liveStreamChanged",(function(e){return i.addEventListener("liveStreamChanged",e)}),"eventDispatch.meeting.liveStreamChanged"),u.registerHandlerImpl("meeting.raiseHandStateChanged",(function(e){return i.addEventListener("raiseHandStateChanged",e)}),"eventDispatch.meeting.raiseHandStateChanged"),u.registerHandlerImpl("meeting.speakingStateChanged",(function(e){return i.addEventListener("speakingStateChanged",e)}),"eventDispatch.meeting.speakingStateChanged"),u.registerHandlerImpl("meeting.meetingReactionReceived",(function(e){return i.addEventListener("meetingReactionReceived",e)}),"eventDispatch.meeting.meetingReactionReceived"),u.registerHandlerImpl("meeting.micStateChanged",(function(e){return i.addEventListener("micStateChanged",e)}),"eventDispatch.meeting.micStateChanged")),o&&(o.clearListeners(),u.registerHandlerImpl("meetingRoom.meetingRoomCapabilitiesUpdate",(function(e){return o.addEventListener("meetingRoomCapabilitiesUpdate",e)}),"eventDispatch.meetingRoomCapabilitiesUpdate"),u.registerHandlerImpl("meetingRoom.meetingRoomStatesUpdate",(function(e){return o.addEventListener("meetingRoomStatesUpdate",e)}),"eventDispatch.meetingRoomStatesUpdate")),s&&(s.clearListeners(),u.registerHandlerImpl("search.queryChange",(function(e){return s.addEventListener("queryChange",e)}),"eventDispatch.search.queryChange"),u.registerHandlerImpl("search.queryClose",(function(e){return s.addEventListener("queryClose",e)}),"eventDispatch.search.queryClose"),u.registerHandlerImpl("search.queryExecute",(function(e){return s.addEventListener("queryExecute",e)}),"eventDispatch.search.queryExecute")),n){if(n.clearListeners(),u.registerHandlerImpl("fullScreenChange",(function(e){return n.addEventListener("fullScreenChange",e)}),"eventDispatch.fullScreenChange"),u.registerHandlerImpl("focusEnter",(function(e){return n.addEventListener("focusEnter",e)}),"eventDispatch.focusEnter"),n.appButtonService){var p=n.appButtonService;p.clearListeners(),u.registerHandlerImpl("appButtonClick",(function(e){return p.addEventListener("click",e)}),"eventDispatch.appButtonClick"),u.registerHandlerImpl("appButtonHoverEnter",(function(e){return p.addEventListener("hoverEnter",e)}),"eventDispatch.appButtonHoverEnter"),u.registerHandlerImpl("appButtonHoverLeave",(function(e){return p.addEventListener("hoverLeave",e)}),"eventDispatch.appButtonHoverLeave")}if(n.configService){var d=n.configService;d.clearListeners(),u.registerHandlerImpl("changeSettings",(function(e){return d.addEventListener("changeSettings",e)}),"eventDispatch.changeSettings"),d.addEventListener("settings.save",(function(e){u.logEventDispatchScenario("eventDispatch.settings.save"),u.appSdkHost.sendRequestMessage("settings.save",e.data?[e.data]:[])})),d.addEventListener("settings.remove",(function(e){u.logEventDispatchScenario("eventDispatch.settings.remove"),u.appSdkHost.sendRequestMessage("settings.remove",e.data?[e.data]:[])}))}if(n.backStackService){var h=n.backStackService;h.clearListeners(),u.registerHandlerImpl("backButton",(function(e){return h.addEventListener("backButton",e)}),"eventDispatch.backButtonPress",{eventRaiseType:"backButtonPress"})}}return a&&(a.clearListeners(),u.registerHandlerImpl("remoteCamera.capableParticipantsChange",(function(e){return a.addEventListener("capableParticipantsChange",e)}),"eventDispatch.remoteCamera.capableParticipantsChange"),u.registerHandlerImpl("remoteCamera.handlerError",(function(e){return a.addEventListener("handlerError",e)}),"eventDispatch.remoteCamera.handlerError"),u.registerHandlerImpl("remoteCamera.deviceStateChange",(function(e){return a.addEventListener("deviceStateChange",e)}),"eventDispatch.remoteCamera.deviceStateChange"),u.registerHandlerImpl("remoteCamera.sessionStatusChange",(,"eventDispatch.remoteCamera.sessionStatusChange")),u.registerHandlerImpl("load",(function(e){}),"eventDispatch.load"),u.registerHandlerImpl("beforeUnload",(function(e){}),"eventDispatch.beforeUnload"),u}return Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;this.registerHandler("registerHandler",(function(t,n,r){return Object(o.__awaiter)(e,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return r&&(this.userSettings=r),this.isValidRegistrationType(n)&&(this.registeredHandlers.get(n)(),this.appSdkHost.saveCacheableRegistrationState(n,this.userSettings)),[2,Qt]}))}))})),this.bootstrapRegistrationState&&this.runRegisteredHandlers(this.bootstrapRegistrationState)},t.prototype.isValidRegistrationType=function(e){return this.registeredHandlers.has(e)},t.prototype.runRegisteredHandlers=function(e){var t,n,r;try{for(r in e)this.registeredHandlers.has(r)&&(Pt(r)&&(null===(t=e.userSettingsChange)||void 0===t?void 0:t.userSettingTypes)&&(this.userSettings=e.userSettingsChange.userSettingTypes),null===(n=this.registeredHandlers.get(r))||void 0===n||n())}catch(e){this.appSdkHost.getLogger().log(Je.Error,"RegisterHandlerMessageHandler","failed to run registered handlers")}},t.prototype.registerHandlerImpl=function(e,t,n,r){var i=this;if(this.registeredHandlers.has(e))throw new Error("handler already registered");this.registeredHandlers.set(e,(function(){var o;if((null==r?void 0:r.isRestrictedToFullTrustApps)&&!(null===(o=i.appSdkHost.getAppDefinition())||void 0===o?void 0:o.isFullTrust))throw new Error(Bt);t((function(t){var o;i.logEventDispatchScenario(n),Array.isArray(t.data)||(t.data=[t.data]),i.appSdkHost.sendRequestMessage(null!==(o=null==r?void 0:r.eventRaiseType)&&void 0!==o?o:e,t.data?t.data:[])}))}))},t.prototype.logEventDispatchScenario=function(e){var t,n=null===(t=this.telemetryService)||void 0===t?void 0:t.createScenario(e);null==n||n.stop()},t}(zt),wr=function(e){function t(t,n,r){var i=e.call(this,t,r)||this;return i.appSdkHost=t,i.remoteCameraService=n,i.telemetryService=r,i}return Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;this.registerHandler(Ve,(function(){return Zt(null,e.remoteCameraService.getCapableParticipants)}),{errorCallback:function(e,t){return Gt(Ve,e,t)}}),this.registerHandler(Le,(function(t,n){return Zt(n,e.remoteCameraService.requestControl)}),{errorCallback:function(e,t){return Gt(Le,e,t)}}),this.registerHandler(Me,(function(t,n){return $t(e.remoteCameraService.sendControlCommand,n)}),{errorCallback:function(e,t){return Gt(Me,e,t)}}),this.registerHandler(Fe,(function(){return $t(e.remoteCameraService.terminateSession)}),{errorCallback:function(e,t){return Gt(Fe,e,t)}})},t.prototype.validateDependencies=function(){if(!this.remoteCameraService)throw"No remoteCameraService provided"},t}(zt),Er=function(e){function t(t,n,r){var i=e.call(this,t,r)||this;return i.sharingService=n,i}return Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;this.registerHandler(Be,(function(t,n){return $t(e.sharingService.shareWebContent,n)}),{errorCallback:function(e,t){return Gt(Be,e,t)}})},t.prototype.validateDependencies=function(){if(!this.sharingService)throw"No sharingService provided"},t}(zt),Ir=function(e){function t(t,n,r){var i=e.call(this,t,r)||this;return i.appSdkHost=t,i.stageViewService=n,i.telemetryService=r,i}return Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;this.registerHandler(ze,(function(t,n){return Zt(n,e.stageViewService.open)}),{errorCallback:function(e,t){return Gt(ze,e,t)}})},t.prototype.validateDependencies=function(){if(!this.stageViewService)throw"No stageViewService provided"},t}(zt),Pr=function(){function e(e,t){this.stageViewService=e,this.logger=t}return e.prototype.tryGetDataFromLink=function(t){var n;if(!this.stageViewService)return null;if(t.origin!=Et)return null;var r=t.pathname.match(e.STAGE_VIEW_URL_REGEX);if(!r)return null;var i,o=r[1],a=t.searchParams.get("context");if(!a)return null;try{i=JSON.parse(a)}catch(e){return null===(n=this.logger)||void 0===n||n.log(Je.Error,"StageViewLegacyLinkHandler","There is an error parsing the URL",e),null}var s=i.contentUrl;return s?{appId:o,contentUrl:s,threadId:i.threadId||void 0,title:i.title||void 0,websiteUrl:i.websiteUrl||void 0,entityId:i.entityId||void 0}:null},e.prototype.executeData=function(e){return this.stageViewService.open(e)},e.STAGE_VIEW_URL_REGEX=/^\/l\/stage\/([^\/]+)\/?0$/,e}(),Or=function(e){function t(t,n,r){var i=e.call(this,t,r)||this;return i.appSdkHost=t,i.joinedTeamsService=n,i}return Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;this.registerHandler(Ge.getUserJoinedTeams,(function(t,n){return $t(e.joinedTeamsService.getUserJoinedTeams,n)}),{isRestrictedToFullTrustApps:!0})},t.prototype.validateDependencies=function(){if(!this.joinedTeamsService)throw"No joinedTeamsService provided"},t}(zt),Tr=function(e){function t(t,n,r){var i=e.call(this,t,r)||this;return i.appSdkHost=t,i.fullTrustService=n,i}return Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;this.registerHandler(qe,(function(t,n){return $t(e.fullTrustService.getConfigSetting,n)}),{isRestrictedToFullTrustApps:!0})},t.prototype.validateDependencies=function(){if(!this.fullTrustService)throw"No fullTrustService provided"},t}(zt),kr=function(e){function t(t,n,r){var i=e.call(this,t,r)||this;return i.appSdkHost=t,i.teamsService=n,i}return Object(o.__extends)(t,e),t.prototype.initHandlers=function(){var e=this;this.registerHandler(Ue,(function(t,n){return Zt(n,e.teamsService.getTeamChannels)}),{errorCallback:function(e,t){return Gt(Ue,e,t)},isRestrictedToFullTrustApps:!1}),this.registerHandler(We,(function(t,n){return Zt(n,e.teamsService.refreshSiteUrl)}),{errorCallback:function(e,t){return Gt(We,e,t)},isRestrictedToFullTrustApps:!1})},t.prototype.validateDependencies=function(){if(!this.teamsService)throw"No TeamsService provided"},t}(zt),xr=function(e){function t(t,n,r,i,o){var a,s,l,c,u,p,d,h,f=this;(f=e.call(this,t)||this).appSdkHost=t,f.hubServices=n,f.telemetryService=r,f.messageHandlers=[];var g=new nr([new an(n.appInstallDialogService),new ir(n.pageService),new Wn(n.calendarService),new Gn(n.callService),new Xn(n.chatService),new Pr(n.stageViewService,t.getLogger())]);return f.messageHandlers.push(new on(t,n.appInstallDialogService,r)),f.messageHandlers.push(new Bn(t,n.authenticationService,r)),f.messageHandlers.push(new rr(t,n.linkService,g,r)),f.messageHandlers.push(new nn(t,n,r,o)),f.messageHandlers.push(new zn(t,n.devicePermissionService,n.barCodeService,r)),f.messageHandlers.push(new Un(t,n.calendarService,r)),f.messageHandlers.push(new ar(t,n.devicePermissionService,n.locationService,r)),f.messageHandlers.push(new Ar(t,n.pageService,n.logService,n.meetingService,n.meetingRoomService,n.remoteCameraService,n.searchService,r,i)),f.messageHandlers.push(new lr(t,n.mailService,r)),f.messageHandlers.push(new pr(t,n.meetingService,r)),f.messageHandlers.push(new fr(t,n.notificationService,r)),f.messageHandlers.push(new mr(t,n.pageService,r)),f.messageHandlers.push(new vr(t,null===(a=n.pageService)||void 0===a?void 0:a.tabsService,r)),f.messageHandlers.push(new gr(t,null===(s=n.pageService)||void 0===s?void 0:s.configService,r)),f.messageHandlers.push(new cr(t,n.mediaService,r)),f.messageHandlers.push(new Jn(t,n.chatService,r)),f.messageHandlers.push(new Zn(t,n.conversationsService,r)),f.messageHandlers.push(new br(t,null===(l=n.pageService)||void 0===l?void 0:l.fullTrustService,r)),f.messageHandlers.push(new yr(t,null===(c=n.pageService)||void 0===c?void 0:c.backStackService)),f.messageHandlers.push(new Tr(t,null===(u=n.teamsService)||void 0===u?void 0:u.fullTrustService,r)),f.messageHandlers.push(new Or(t,null===(d=null===(p=n.teamsService)||void 0===p?void 0:p.fullTrustService)||void 0===d?void 0:d.joinedTeamsService,r)),f.messageHandlers.push(new kr(t,n.teamsService,r)),f.messageHandlers.push(new $n(t,n.dialogService,r,o)),f.messageHandlers.push(new Qn(t,null===(h=n.dialogService)||void 0===h?void 0:h.updateService,r)),f.messageHandlers.push(new er(t,n.filesService,r)),f.messageHandlers.push(new sr(t,n.logService,r)),f.messageHandlers.push(new Sr(t,n.peopleService,r)),f.messageHandlers.push(new Cr(t,n.devicePermissionService,r)),f.messageHandlers.push(new _r(t,n.profileService,r)),f.messageHandlers.push(new wr(t,n.remoteCameraService,r)),f.messageHandlers.push(new hr(t,n.monetizationService,r)),f.messageHandlers.push(new qn(t,n.callService,r)),f.messageHandlers.push(new rn(t,n.appEntityService,r)),f.messageHandlers.push(new Er(t,n.sharingService,r)),f.messageHandlers.push(new dr(t,n.meetingRoomService,r)),f.messageHandlers.push(new tr(t,n.interactiveService,r)),f.messageHandlers.push(new Ir(t,n.stageViewService,r)),f.messageHandlers.forEach((),f}return Object(o.__extends)(t,e),t}(vn),jr=function(e){function t(t,n,r,i,a,s){var l=e.call(this,t,r,i.authenticationService,i.logger,i.telemetryService,a)||this;return l.hostWindow=t,l.communicationBridge=n,l.context=r,l.hubServices=i,l.onAppInitStateChanged=a,l.hostVersionsInfo=s,l.isMetaOSMounted=!1,l.isCachedLaunch=!1,l.getAppDefinition=function(){return l.appDefinition},l.getOrigin=l.getDisplayName=function(){var e,t;return(null===(e=l.context.page.config)||void 0===e?void 0:e.instanceId)?null===(t=l.context.page.config)||void 0===t?void 0:t.displayName:l.appDefinition&&It(l.appDefinition,l.context.page.id)},l.prefetchAuthToken=function(e,t){return Object(o.__awaiter)(l,void 0,void 0,(function(){var n,r,i,a,s;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:if(n=null===(s=this.telemetryService)||void 0===s?void 0:s.createScenario("preFetchAuthToken",null==t?void 0:t.id),!this.hubServices.authenticationService)return[3,6];o.label=1;case 1:return o.trys.push([1,4,,5]),(r=ut(t,e))&&r)?[4,this.hubServices.authenticationService.acquireToken(r,void 0,!0)]:[3,3];case 2:return o.sent(),null==n||n.stop(),[2,!0];case 3:return[3,5];case 4:return i=o.sent(),a="Unable to prefetch token via authentication service: "+i,this.getLogger().log(Je.Error,"prefetchAuthToken",a,i),null==n||n.fail(a),[3,5];case 5:return[3,7];case 6:a="Cancelled since authenticationService is not available",this.getLogger().log(Je.Error,"prefetchAuthToken",a),null==n||n.fail(a),o.label=7;case 7:return[2,!1]}}))}))},l.urlToLoad=function(e){return e},l.setAppInitInfo=function(e){l.checkIfCacheableAndInvoke((function(t){var n;null===(n=l.hubServices.cacheManagementService)||void 0===n||n.setAppState(t,e)})),l.onAppInitStateChanged&&l.onAppInitStateChanged(e)},l.loadCacheableRegistrationState=function(){if(l.hubServices.cacheManagementService){var e=l.getCacheablePageInfo();return e&&l.hubServices.cacheManagementService.loadBootstrapRegistrationState(e)}},l.saveCacheableRegistrationState=function(e,t){l.checkIfCacheableAndInvoke((function(n){var r;null===(r=l.hubServices.cacheManagementService)||void 0===r||r.saveBootstrapRegistrationState(n,function(e,t){var n;return Pt(e)?{userSettingsChange:{userSettingTypes:t}}:((n={})["".concat(e)]=!0,n)}(e,t))}))},l.checkIfCachedAndRequestAllowed=function(e){if(!l.hubServices.cacheManagementService||!l.hubServices.cacheManagementService.isCachedAndAllowRequest)return!0;var t=l.getCacheablePageInfo();return!t||l.hubServices.cacheManagementService.isCachedAndAllowRequest(t,e)},l.unloadCachedApp=function(e){var t=l.hubServices.cacheManagementService;(null==t?void 0:t.shouldTriggerUnload(e))?(null==t||t.setAppState(e,{state:Qe.b.Unloading}),l.sendRequestMessage("beforeUnload")):null==t||t.setAppState(e,{state:Qe.b.Unloaded})},l.disposeBridge=l.checkIfCacheableAndInvoke=function(e,t){if(l.hubServices.cacheManagementService){var n=l.getCacheablePageInfo();n?e(n):null==t||t()}else null==t||t()},l.getCacheablePageInfo=function(){var e;return l.appDefinition?{appId:l.appDefinition.id,entityId:l.context.page.id,displayName:l.getDisplayName(),instanceId:null===(e=l.context.page.config)||void 0===e?void 0:e.instanceId,contentUrl:l.getOrigin()}:void 0},l.isMetaOSMounted=!0,l.initializeAuthenticationContext(r),n.onSdkInitialized&&n.onSdkInitialized(t),l}return Object(o.__extends)(t,e),t.prototype.setFrameAndLoadOrigin=function(e,t,n,r,i){return Object(o.__awaiter)(this,void 0,void 0,(function(){var a,s,l;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),this.isCachedLaunch=i||!1,this.appDefinition=n,this.setAppInitInfo({state:Qe.b.Loading}),this.setInitialized(!!i),this.telemetryService.setAppDefinition(n),this.frame=e,this.setUserClickTime(r),this.messageProcessor&&this.messageProcessor.cleanup(),a=void 0,i&&(a=this.loadCacheableRegistrationState()),[4,this.getAppContext()];case 1:return s=o.sent(),this.prefetchAuthToken(s,n),this.messageProcessor=new xr(this,this.hubServices,this.telemetryService,a,this.hostVersionsInfo),this.load(t,s,i),[3,3];case 2:return l=o.sent(),this.getLogger().log(Je.Error,"setFrameAndLoadOrigin","An error occurred while loading URL",l),this.handleAppLoadFailure(l),[3,3];case 3:return[2]}}))}))},t.prototype.handleAppLoadFailure=function(e){var t,n,i;this.setAppInitInfo({state:Qe.b.Failed,reason:i=e===$e?r.Validation_InvalidDomains:r.Validation}),null===(t=this.getAppInitializationScenario())||void 0===t||t.fail(i),null===(n=this.messageProcessor)||void 0===n||n.cleanup()},t.prototype.sendRequestMessage=function(e,t){this.getOrigin()&&this.frame&&this.communicationBridge.postMessage(this.frame,{func:e,args:t})},t.prototype.sendResponseMessage=function(e,t,n,r){if(this.getOrigin()){var i={id:t,args:n,isPartialResponse:r,origin:this.getOrigin()};this.communicationBridge.postMessage(e,i)}},t.prototype.setOrigin=t.prototype.postResponseToApp=t.prototype.handleMessage=t.prototype.load=function(e,t,n){if(void 0===n&&(n=!1),this.isMetaOSMounted){if(this.frame&&this.appDefinition&&this.communicationBridge.onSetFrameAndLoadOrigin(this.frame,e,this.appDefinition,t,this.handleMessage.bind(this)),!ot(e,this.getLogger(),this.getAppDefinition(),t)||!this.frame)throw rt().wildcardValidDomainRuleDetection&&this.getAppDefinition()&&at(st(this.getAppDefinition(),t)).length>0?$e:Ye;var r=function(e,t,n){var r=gt(e,function(e){var t,n,r,i,a;return{actionInfo:{actionId:(null===(t=e.actionInfo)||void 0===t?void 0:t.actionId)||"",actionObjects:(null===(n=e.actionInfo)||void 0===n?void 0:n.actionObjects)||[]},user:Object(o.__assign)(Object(o.__assign)({id:"",licenseType:""},e.user),{tenant:Object(o.__assign)({id:"",sku:""},null===(r=e.user)||void 0===r?void 0:r.tenant)}),app:Object(o.__assign)({iconPositionVertical:0,parentMessageId:"",userFileOpenPreference:Qe.f.Inline,userClickTime:0},e.app),page:Object(o.__assign)({isFullScreen:!1,subPageId:"",isMultiWindow:!1,sourceOrigin:""},e.page),meeting:{id:(null===(i=e.meeting)||void 0===i?void 0:i.id)||""},chat:{id:(null===(a=e.chat)||void 0===a?void 0:a.id)||""},channel:e.channel,sharePointSite:e.sharePointSite,sharepoint:e.sharepoint,team:e.team}}(t));return gt(r,n)}(e,t,vt(t));if(this.getLogger().log(Je.Debug,"load","origin: ".concat(r)),this.setOrigin(r),this.setAppInitInfo({state:Qe.b.WaitingForAppLoad}),n)this.sendRequestMessage("load",[{entityId:t.page.id,contentUrl:this.getOrigin()}]);else{var i=new URL(r);this.frame.src=ft(this.urlToLoad(i))}}},t.prototype.supportsLoad=function(){var e=this;this.checkIfCacheableAndInvoke((function(t){var n;return null===(n=e.hubServices.cacheManagementService)||void 0===n?void 0:n.supportsLoad(t)}))},t.prototype.supportsBeforeUnload=function(){var e=this;this.checkIfCacheableAndInvoke(()},t.prototype.unloadApp=function(t){var n;e.prototype.unloadApp.call(this,t),null===(n=this.messageProcessor)||void 0===n||n.cleanup()},t.prototype.unloadSDK=function(){var e;if(null===(e=this.messageProcessor)||void 0===e||e.cleanup(),this.isMetaOSMounted=!1,this.onAppInitStateChanged=void 0,this.hubServices.cacheManagementService){var t=this.getCacheablePageInfo();t&&this.unloadCachedApp(t)}else this.disposeBridge()},t.prototype.getFrame=function(){return this.frame},t}(Ln),Dr=function(e){var t,n,i,s,l=e.context.page.frameContext,c=null!==(n=null===(t=e.isolationProvider)||void 0===t?void 0:t.communicationBridge)&&void 0!==n?n:Rr(e.hubServices.logger);if(e.hostVersionsInfo&&e.hostVersionsInfo.adaptiveCardSchemaVersion&&kt(e.hostVersionsInfo.adaptiveCardSchemaVersion))throw new Error("dialogService.cardService requires that the host specifies an adaptive card version of at least ".concat(Tt()));if((e.hubServices.locationService||e.hubServices.barCodeService)&&!e.hubServices.devicePermissionService)throw new Error("devicePermissionService needs to be provided if any of following services is provided: locationService, barCodeService");e.featureFlags&&function(e){!Object(o.__assign)(Object(o.__assign)({},nt),e))}(e.featureFlags);var u=function(e,t,n,r,i,o){var s=a.useState({state:Qe.b.Unknown}),l=s[0],c=s[1];return a.useEffect((function(){l.state===Qe.b.Failed&&c({state:Qe.b.Unknown})}),[r]),{appHostSdk:a.useMemo((,[e,t.page.frameContext,c,t.app.host.clientType,o]),appInitInfo:l}}(e.hostWindow,e.context,e.hubServices,e.appDefinition,c,e.hostVersionsInfo),p=u.appHostSdk,d=u.appInitInfo,h=e.context.app.theme;a.useEffect((function(){h&&(p.onThemeChanged&&p.onThemeChanged(h),p.onUserSettingsChanged&&p.onUserSettingsChanged(et.e.theme,h))}),[h]);var f=e.context.app.userFileOpenPreference;if(a.useEffect((function(){f&&p.onUserSettingsChanged&&p.onUserSettingsChanged(et.e.fileOpenPreference,f)}),[f]),a.useEffect((function(){p.initializeAuthenticationContext(e.context)}),[e.context]),a.useEffect((,[e.appDefinition]),a.useEffect((,[]),function(e,t){return e.state===Qe.b.Failed&&(t.showLoadingIndicator||!t.showLoadingIndicator&&e.reason===r.AppInitTimeout)}(d,e.appDefinition))return(null===(i=e.hubServices.hubUiService)||void 0===i?void 0:i.getErrorUi)&&(null===(s=e.hubServices.hubUiService)||void 0===s?void 0:s.getErrorUi(d.reason))||a.createElement("div",null);var g=Hr(e.appDefinition.showLoadingIndicator,e.hubServices,d,p.isCachedLaunch,p.getCacheablePageInfo());return a.createElement(a.Fragment,null,g&&e.hubServices.hubUiService.getLoadingUi(),function(){var t,n=Object(o.__assign)(Object(o.__assign)({},e),{sdkHost:p,isLoading:g,frameContext:l,userClickTime:null!==(t=e.context.app.userClickTime)&&void 0!==t?t:Date.now(),communicationBridge:c,getRequiredPermissions:);return e.isolationProvider?e.isolationProvider.renderHost(n):a.createElement(_t,Object(o.__assign)({},n))}())},Rr=Hr=function(e,t,n,r,i){return t.cacheManagementService?t.cacheManagementService.getIsLoading(n,e,r,i):e&&(n.state===Qe.b.Loading||n.state===Qe.b.WaitingForAppLoad)},Nr=function(e){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return e?[4,e.storageService.getPermissions()]:[3,2];case 1:return t=n.sent(),[3,3];case 2:t=[],n.label=3;case 3:return[2,t.filter(()]}}))}))}},"7Sj9":function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.HostCapabilities=void 0;var i=n("IpoZ"),o=i.SerializableObject);t.HostCapabilities=o},"7p/x":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("QjXU"),i=n("mXGw"),o=n("+fvi");function a(){var e=Object(r.__read)(Object(i.useState)(o.f),2),t=e[0],n=e[1];return Object(i.useEffect)((function(){var e=o.c.subscribe(n);return function(){null==e||e.unsubscribe()}}),[]),t}},"8Jek":"8eSj":function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n("CXgZ"),i=n("M21c"),o=n("8Jek"),a=n.n(o),s=n("mXGw"),l=n.n(s),c=n("Cgy6"),u=n("p/uK"),p=n("DU/N"),d=Object(u.a)({foreground:{color:p.a.colorBrandForeground1}}),h={strokeWidthThicker:"1.5px",colorNeutralForeground1:p.a.colorBrandForeground1},f=function(e){var t=e.label,n=d();return l.a.createElement(i.a,{className:a()(c.a.container,c.a.transparentBackground),theme:h},l.a.createElement(r.a,{label:t,size:"small",labelPosition:"below",className:n.foreground}))}},"9K2m":"9qA2":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("ovpI"),i=n("8Jek"),o=n.n(i),a=n("mXGw"),s=n.n(a),l=Object(a.forwardRef)((function(e,t){var n=e.iconClass,i=e.iconName,a=e.url,l=e.label,c=e.iconImageUrl,u=e.iconColor,p=e.children,d=e.iconControl;return s.a.createElement("a",{id:e.id,href:a||"javascript:void(0);",rel:"noopener","aria-label":e.ariaLabel,className:"IconButtonControl-module__button__3Vp_G",onClick:e.onClick||void 0,target:a?e.target:void 0,"aria-pressed":e.ariaPressedState,role:e.ariaRole||"button",onKeyDown:e.keyDown,ref:t,tabIndex:e.tabIndex,title:e.title,"data-clicklog":e.defaultLogging?"":"custom","data-testid":e.dataTestId},s.a.createElement("div",{className:o()("IconButtonControl-module__icon__3HPEx","o365cs-base"),style:{color:"".concat(u)}},c?s.a.createElement("img",{src:c,className:"IconButtonControl-module__icon__img__ZNUKF"}):!d&&s.a.createElement(r.a,{className:n,iconName:i})||s.a.createElement("div",{className:n},d),p,s.a.createElement("div",{className:o()("IconButtonControl-module__label__1PXyv","ms-fcl-bl")},l)))}));l.displayName="IconButtonControl"},A3AF:A6pZ:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.Table=t.TableRow=t.TableCell=t.StylableContainer=t.TableColumnDefinition=void 0;var o=n("5RAF"),a=n("oZqk"),s=n("uv1U"),l=n("IpoZ"),c=n("oxya"),u=n("vh9v"),p=n("D7YB"),d=l.SerializableObject);t.TableColumnDefinition=d;var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._items=[],t}return r(t,e),t.prototype.parseItem=t.prototype.internalAddItem=t.prototype.internalRemoveItem=t.prototype.internalIndexOf=function(e){return this._items.indexOf(e)},t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this._items=[];var r=t[this.getCollectionPropertyName()];if(Array.isArray(r))for(var i=0,o=r;i<o.length;i++){var a=this.parseItem(o[i],n);a&&this._items.push(a)}},t.prototype.internalToJSON=t.prototype.removeItem=function(e){return this.internalRemoveItem(e)},t.prototype.getItemCount=function(){return this._items.length},t.prototype.getItemAt=function(e){return this._items[e]},t.prototype.getFirstVisibleRenderedItem=t.prototype.getLastVisibleRenderedItem=t}(o.StylableCardElementContainer);t.StylableContainer=h;var f=o.Container);t.TableCell=f;var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getDefaultPadding=t.prototype.applyBackground=t.prototype.getCollectionPropertyName=function(){return"cells"},t.prototype.createItemInstance=function(e){return e&&"TableCell"!==e?void 0:new f},t.prototype.internalRender=function(){var e=this.getIsFirstRow(),t=this.hostConfig.table.cellSpacing,n=document.createElement("div");n.setAttribute("role","row"),n.style.display="flex",n.style.flexDirection="row";for(var r=0;r<Math.min(this.getItemCount(),this.parentTable.getColumnCount());r++){var i=this.getItemAt(r);i._columnIndex=r,i._cellType=this.parentTable.firstRowAsHeaders&&e?"header":"data";var o=i.render();if(o){var s=this.parentTable.getColumnAt(r);o.style.flex=s.computedWidth.unit===a.SizeUnit.Pixel?"0 0 "+s.computedWidth.physicalSize+"px":"1 1 "+s.computedWidth.physicalSize+"%",r>0&&!this.parentTable.showGridLines&&t>0&&(o.style.marginLeft=t+"px"),n.appendChild(o)}}return n.children.length>0?n:void 0},t.prototype.shouldSerialize=function(e){return!0},t.prototype.addCell=function(e){this.internalAddItem(e)},t.prototype.removeCellAt=t.prototype.indexOf=function(e){return e instanceof f?this.internalIndexOf(e):-1},t.prototype.ensureHasEnoughCells=t.prototype.getJsonTypeName=function(){return"TableRow"},t.prototype.getIsFirstRow=Object.defineProperty(t.prototype,"parentTable",{get:function(){return this.parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),t.styleProperty=new o.ContainerStyleProperty(l.Versions.v1_5,"style"),t.horizontalCellContentAlignmentProperty=new l.EnumProperty(l.Versions.v1_5,"horizontalCellContentAlignment",a.HorizontalAlignment),t.verticalCellContentAlignmentProperty=new l.EnumProperty(l.Versions.v1_5,"verticalCellContentAlignment",a.VerticalAlignment),i([(0,l.property)(t.horizontalCellContentAlignmentProperty)],t.prototype,"horizontalCellContentAlignment",void 0),i([(0,l.property)(t.verticalCellContentAlignmentProperty)],t.prototype,"verticalCellContentAlignment",void 0),t}(h);t.TableRow=g;var m=function(e){eturn r(t,e),Object.defineProperty(t.prototype,"gridStyle",{get:set:function(e){this.setValue(t.gridStyleProperty,e)},enumerable:!1,configurable:!0}),t.prototype.ensureRowsHaveEnoughCells=t.prototype.removeCellsFromColumn=t.prototype.getCollectionPropertyName=function(){return"rows"},t.prototype.createItemInstance=t.prototype.internalParse=t.prototype.internalRender=function(){if(this.getItemCount()>0){for(var e=0,t=0,n=this._columns;t<n.length;t++)(o=n[t]).width.unit===a.SizeUnit.Weight&&(e+=o.width.physicalSize);for(var r=0,i=this._columns;r<i.length;r++){var o;(o=i[r]).computedWidth=o.width.unit===a.SizeUnit.Pixel?new c.SizeAndUnit(o.width.physicalSize,a.SizeUnit.Pixel):new c.SizeAndUnit(100/e*o.width.physicalSize,a.SizeUnit.Weight)}var s=document.createElement("div");if(s.setAttribute("role","table"),s.style.display="flex",s.style.flexDirection="column",this.showGridLines){var l=this.hostConfig.containerStyles.getStyleByName(this.gridStyle);if(l.borderColor){var u=(0,p.stringToCssColor)(l.borderColor);u&&(s.style.borderTop="1px solid "+u,s.style.borderLeft="1px solid "+u)}}for(var d=this.hostConfig.table.cellSpacing,h=0;h<this.getItemCount();h++){var f=this.getItemAt(h).render();if(f){if(h>0&&!this.showGridLines&&d>0){var g=document.createElement("div");g.setAttribute("aria-hidden","true"),g.style.height=d+"px",s.appendChild(g)}s.appendChild(f)}}return s}},t.prototype.addColumn=t.prototype.removeColumn=t.prototype.getColumnCount=function(){return this._columns.length},t.prototype.getColumnAt=function(e){return this._columns[e]},t.prototype.addRow=t.prototype.indexOf=t.prototype.getJsonTypeName=function(){return"Table"},t._columnsProperty=new l.SerializableObjectCollectionProperty(l.Versions.v1_5,"columns",d),t.firstRowAsHeadersProperty=new l.BoolProperty(l.Versions.v1_5,"firstRowAsHeaders",!0),t.showGridLinesProperty=new l.BoolProperty(l.Versions.v1_5,"showGridLines",!0),t.gridStyleProperty=new o.ContainerStyleProperty(l.Versions.v1_5,"gridStyle"),t.horizontalCellContentAlignmentProperty=new l.EnumProperty(l.Versions.v1_5,"horizontalCellContentAlignment",a.HorizontalAlignment),t.verticalCellContentAlignmentProperty=new l.EnumProperty(l.Versions.v1_5,"verticalCellContentAlignment",a.VerticalAlignment),i([(0,l.property)(t._columnsProperty)],t.prototype,"_columns",void 0),i([(0,l.property)(t.firstRowAsHeadersProperty)],t.prototype,"firstRowAsHeaders",void 0),i([(0,l.property)(t.showGridLinesProperty)],t.prototype,"showGridLines",void 0),i([(0,l.property)(t.gridStyleProperty)],t.prototype,"gridStyle",null),i([(0,l.property)(t.horizontalCellContentAlignmentProperty)],t.prototype,"horizontalCellContentAlignment",void 0),i([(0,l.property)(t.verticalCellContentAlignmentProperty)],t.prototype,"verticalCellContentAlignment",void 0),t}(h);t.Table=m,s.GlobalRegistry.defaultElements.register("Table",m,l.Versions.v1_5)},AYKV:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Constants=void 0;var r=);t.Constants=r},BULU:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("QjXU"),i=n("MJsD"),o=n("B5kz"),a=n("gCKw"),s=n("2y7E");function l(e){var t,n;return void 0===e&&(e="office-start-resources"),Object(r.__awaiter)(this,void 0,void 0,(function(){var l,c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(i.a)()];case 1:return l=r.sent(),[4,Object(a.a)()];case 2:return c=r.sent(),u=["LocStrings",e,(null===(n=null===(t=null==c?void 0:c.result)||void 0===t?void 0:t.m365StringLogoGates)||void 0===n?void 0:n.m365StringLogoEnabled)||!1],[2,o.a.fetchQuery(u,(function(){return Object(s.b)(l.cdnDomain,l.preferredCulture,l.stringsContainerName,e,c)}),{cacheTime:1/0,staleTime:1/0})]}}))}))}},Cd0O:function(e){e.exports=JSON.parse('{"ig-ng":"en","qut-gt":"es","tg-cyrl-tj":"ru","ti-et":"am","wo-sn":"fr-ca","yo-ng":"fr","pt":"pt-br","ca-valencia":"ca-es-valencia","uz":"uz-latn-uz","zh-tw":"zh-hant","aa-dj":"ar","aa-er":"ar","aa-et":"am","af-za":"af","agq-cm":"fr","ak-gh":"en-gb","ak":"en-gb","sq":"en-gb","sq-al":"en-gb","sq-xk":"en-gb","sq-mk":"en-gb","gsw":"fr","gsw-fr":"fr","ast":"en-gb","ast-es":"en-gb","asa":"en-gb","asa-tz":"en-gb","ksf":"fr","ksf-cm":"fr","bm":"fr","bm-latn-ml":"fr","bn":"en-gb","bn-in":"en-gb","bas-cm":"fr","bas":"fr","ba-ru":"ru","ba":"ru","be":"ru","be-by":"ru","bem":"en-gb","bem-zm":"en-gb","bn-bd":"bn-in","byn":"ar","byn-er":"ar","brx":"as","brx-in":"as","br":"fr","br-fr":"fr","my-mm":"en-gb","my":"en-gb","tzm":"ar","tzm-arab-ma":"ar","tzm-latn-ma":"ar","tzm-latn-dz":"ar","tzm-tfng":"ar","tzm-tfng-ma":"ar","ku-arab":"ar","ku":"ar","ku-arab-iq":"ar","ce-ru":"ru","ce":"ru","cgg-ug":"en-gb","cgg":"en-gb","zh-hans-hk":"zh-hans","zh-hans-mo":"zh-hans","zh-cn":"zh-hans","zh-sg":"zh-hans","zh-hk":"zh-hant","zh-mo":"zh-hant","cu-ru":"ru","cu":"ru","ksh":"de","ksh-de":"de","kw":"en-gb","kw-gb":"en-gb","co":"fr","co-fr":"fr","dua":"fr","dua-cm":"fr","ee":"en-gb","ee-gh":"en-gb","ee-tg":"fr","ewo":"fr","ewo-cm":"fr","fo":"da","fo-dk":"da","fo-fo":"da","fi":"en-gb","fi-fl":"en-gb","fur":"it","fur-it":"it","ff":"fr","ff-latn-sn":"fr","gn":"es","gn-py":"es","ha":"fr","ha-latn-ne":"fr","ha-latn-ng":"fr","jv":"id","jv-latn-id":"id","dyo":"fr","dyo-sn":"fr","kea":"pt-pt","kea-cv":"pt-pt","kab":"fr","kab-dz":"fr","kl-gl":"da","kk":"ru","kk-kz":"ru","km":"km-kh","quc-latn-gt":"es","sw-cd":"fr","sw":"fr","sw-tz":"fr","sw-ug":"fr","khq-ml":"fr","khq":"fr","ses":"fr","ses-ml":"fr","nmg":"fr","nmg-cm":"fr","ky":"ru","ky-kg":"ru","ln":"pt-pt","ln-ao":"pt-pt","ln-cf":"fr","ln-cd":"fr","ln-cg":"fr","dsb":"de","dsb-de":"de","lu":"fr","lu-cd":"fr","mgh":"pt-pt","mgh-mz":"pt-pt","mg":"fr","mg-mg":"fr","arn-cl":"es","mzn-ir":"fa","mgo-cm":"fr","mgo":"fr","mn-mong-cn":"zh-hans","mn-mong-mn":"ru","mn":"ru","mfe":"fr","mfe-mu":"fr","nnh":"fr","nnh-cm":"fr","jgo":"fr","jgo-cm":"fr","nqo":"fr","nqo-gn":"fr","lrc-iq":"ar","no":"nb-no","nb":"nb-no","nn":"nn-no","om-et":"am","om":"am","om-ke":"am","os-ge":"ru","os":"ru","os-ru":"ru","pap":"nl","pt-cv":"pt-pt","pt-gw":"pt-pt","pt-mo":"pt-pt","pt-mz":"pt-pt","pt-st":"pt-pt","pt-tl":"pt-pt","quz":"es","quz-bo":"es","ssy":"ar","ssy-er":"ar","sah":"ru","sah-ru":"ru","se":"fi","smn-fl":"fi","smj-no":"nb-no","sma-no":"nb-no","sg-cf":"fr","seh-mz":"pt-pt","sr":"sr-latn-rs","sr-cyrl":"sr-cyrl-rs","sr-cyrl-xk":"sr-cyrl-rs","sr-cyrl-me":"sr-cyrl-rs","sr-latn":"sr-latn-rs","sr-latn-xk":"sr-latn-rs","sr-latn-me":"sr-latn-rs","st-za":"af","so-et":"am","so-so":"ar","zgh-tfng-ma":"ar","zgh-tfng":"ar","gsw-ch":"fr","shi":"ar","shi-latn-ma":"ar","shi-Latn":"ar","twq":"fr","twq-ne":"fr","bo":"zh-hans","bo-cn":"zh-hans","tig":"ar","tig-er":"ar","ti-er":"ar","tk":"ru","tk-tm":"ru","hsb":"de","hsb-de":"de","uz-cyrl":"uz-latn-uz","uz-cyrl-uz":"uz-latn-uz","ve-za":"en-gb","ve":"en-gb","wo":"fr","ts-za":"af","ts":"af","yav-cm":"fr","ii":"zh-hans","ii-cn":"zh-hans","yo":"fr","yo-bj":"fr","dje":"fr","dje-ne":"fr"}')},Cgy6:function(e,t,n){"use strict";t.a={"flex-col-container":"CommonAppHostControlStyles-module__flex-col-container__3KgiU",container:"CommonAppHostControlStyles-module__container__3Aq7s","container-no-grow":"CommonAppHostControlStyles-module__container-no-grow__vyqSW",transparentBackground:"CommonAppHostControlStyles-module__transparentBackground__h3X-e"}},"Coo+":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("NrNW"),i=n("B5kz"),o=n("CaQ9"),a=n("+vVg"),s=n("bIL4");function l(){var e=Object(r.a)().data,t=Object(o.a)().data;return Object(i.c)(s.b,(,{staleTime:1/0,cacheTime:1/0,enabled:e&&t})}},D7YB:function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.clearElementChildren=t.getScrollY=t.getScrollX=t.getFitStatus=t.truncate=t.truncateText=t.stringToCssColor=t.parseEnum=t.getEnumValueByName=t.parseBool=t.parseNumber=t.parseString=t.appendChild=t.generateUniqueId=t.isMobileOS=t.isInternetExplorer=void 0;var i=n("oZqk"),o=n("oxya");unction s(e,t,n,r,i){var o=if(!o()){for(var a=function(e){for(var t=[],n=c(e,-1);n<e.length;)" "===e[n]&&t.push(n),n=c(e,n);return t}(n),s=0,l=a.length,u=0;s<l;){var p=Math.floor((s+l)/2);r(n,a[p]),o()?(u=a[p],s=p+1):l=p}if(r(n,u),i&&t-e.scrollHeight>=i-1){for(var d=c(n,u);d<n.length&&(r(n,d),o());)u=d,d=c(n,d);r(n,u)}}}t.isInternetExplorer=t.isMobileOS=t.generateUniqueId=t.appendChild=t.parseString=function(e,t){return"string"==typeof e?e:t},t.parseNumber=t.parseBool=t.getEnumValueByName=a,t.parseEnum=t.stringToCssColor=t.truncateText=var l="undefined"==typeof window||null===(r=window.trustedTypes)||void 0===r?void 0:r.createPolicy("adaptivecards#deprecatedExportedFunctionPolicy",{createHTML:function(e){return e}});.truncate=t.getFitStatus=t.getScrollX=function(){return window.pageXOffset},t.getScrollY=function(){return window.pageYOffset},t.clearElementChildren=,DvUI:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("4PWS"),i={office_calendar:"Calendar",office_create:"Create",office_excel:"ExcelOnline",office_cluid:"Fluid",office_forms:"OfficeForms",office_mail:"Mail",office_mycontent:"MyContent",office_feed:"Feed",office_ondrive:"Documents",office_onenote:"OneNoteOnline",office_outlook:"Mail",office_powerbi:"PowerBIv2",office_powerpoint:"PowerPointOnline",office_project:"Project",office_sharepoint:"Sites",office_skype:"Skype",office_sway:"Sway",office_teams:"SkypeTeams",office_visio:"VisioOnline",office_word:"WordOnline",park:"Park"};function o(e){if(!e)return"";var t=i[e];return null!=t?t:e}i[r.a.admin]="AdminPortal",i[r.a.appgallery]="AppGallery",i[r.a.calendar]="Calendar",i[r.a.clipchamp]="Clipchamp",i[r.a.create]="Create",i[r.a.excel]="ExcelOnline",i[r.a.familysafety]="FamilySafety",i[r.a.feed]="Feed",i[r.a.forms]="OfficeForms",i[r.a.home]="OfficeDotCom",i[r.a.lists]="Lists",i[r.a.mycontent]="MyContent",i[r.a.onedrive]="Documents",i[r.a.onenote]="OneNoteOnline",i[r.a.outlook]="Mail",i[r.a.people]="People",i[r.a.powerautomate]="LogicFlows",i[r.a.powerpoint]="PowerPointOnline",i[r.a.skype]="Skype",i[r.a.stream]="MicrosoftStream",i[r.a.sway]="Sway",i[r.a.teams]="SkypeTeams",i[r.a.todo]="ToDo",i[r.a.visio]="VisioOnline",i[r.a.word]="WordOnline"},EZgZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("QjXU"),i=n("H2n2").a),o=n("ORIk"),a=function(){function e(){this.appButtonService=new i,this.currentAppIconPositionSubject=new o.a(1)}return Object.defineProperty(e.prototype,"userClickTime",{get:function(){return this._userClickTime},enumerable:!1,configurable:!0}),e.prototype.focusOnAppbar=e.prototype.setOnReturnFocus=function(e){this.onReturnFocus=e},e.prototype.setGetAppIconPositionRect=function(e){this.getAppIconPositionRect=e},e.prototype.setGetAppIconElementRef=function(e){this.getAppIconElementRef=e},e.prototype.setInteractiveFunctions=function(e){this.setOnReturnFocus((),this.setGetAppIconPositionRect((function(t){return null==e?void 0:e.getAppIconPositionRect(t)})),this.setGetAppIconElementRef(()},e.prototype.onAppButtonClick=function(e,t){this._userClickTime=e,t&&this.appButtonService.dispatchEvent("click",{})},e.prototype.onAppButtonHoverEnter=function(){this.appButtonService.dispatchEvent("hoverEnter",{})},e.prototype.onAppButtonHoverLeave=e.prototype.getAppButtonService=function(){return this.appButtonService},e.prototype.updateCurrentAppVerticalPosition=function(){var e,t,n=null===(t=null===(e=this.getAppIconPositionRect)||void 0===e?void 0:e.call(this))||void 0===t?void 0:t.top;n&&this.currentAppIconPositionSubject.next(n)},e.prototype.getCurrentAppIconPositionObservable=e}()},FIKz:H2n2:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){eturn e.prototype.addEventListener=e.prototype.dispatchEvent=function(e,t){this.registrations.has(e)&&this.registrations.get(e)(t)},e.prototype.clearListeners=e}()},HMCg:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("QjXU"),i=n("mXGw"),o=n("4l53"),a=function(e){var t=Object(r.__read)(Object(i.useState)(void 0),2),n=t[0],a=t[1],s=Object(r.__read)(Object(i.useState)(!1),2),l=s[0],c=s[1];return Object(i.useEffect)((function(){var t=!0;return function(){Object(r.__awaiter)(void 0,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e?[4,Object(o.a)(e)]:[2];case 1:return n=r.sent(),t&&(n?a(n):c(!0)),[2]}}))}))}(),),[e]),{appDefinition:n,missingAppDefinition:l}}},HeHW:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("FPnS"),i=n("io1X");function o(){return Object(i.a)()==r.a.dark}},Hyok:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("QjXU"),i=n("am3b"),o=n("LsEq"),a=n("gd1C");function s(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,s,l,c,u,p,d;return Object(r.__generator)(this,(function(h){return n=e.appId,s=e.entityId,l=e.subPageId,c=new URLSearchParams(location.search),u=Object(r.__assign)({},c),p={route:"M365Apps",type:i.a.Mos,appId:n,entityId:s,subPageId:l},d=Object(o.a)(t,void 0,s),[2,Object(a.a)(p,{action:"OpenInBrowser"},d,u)]}))}))}},IpoZ:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.SerializableObject=t.property=t.SerializableObjectSchema=t.CustomProperty=t.SerializableObjectCollectionProperty=t.SerializableObjectProperty=t.EnumProperty=t.ValueSetProperty=t.StringArrayProperty=t.PixelSizeProperty=t.NumProperty=t.BoolProperty=t.StringProperty=t.PropertyDefinition=t.BaseSerializationContext=t.isVersionLessOrEqual=t.Versions=t.Version=void 0;var i=n("oxya"),o=n("D7YB"),a=n("oZqk"),s=n("vh9v"),l=);t.Version=l;var c=);t.Versions=c,t.isVersionLessOrEqual=function(e,t){return!(e instanceof l)||!(t instanceof l)||t.compareTo(e)>=0};var u=function(){eturn e.prototype.serializeValue=e.prototype.serializeString=function(e,t,n,r){null==n||n===r?i.GlobalSettings.enableFullJsonRoundTrip||delete e[t]:e[t]=n},e.prototype.serializeBool=e.prototype.serializeNumber=e.prototype.serializeEnum=e.prototype.serializeArray=function(e,t,n){var r=[];if(n)for(var i=0,o=n;i<o.length;i++){var a,s=o[i];void 0!==(a=s instanceof w?s.toJSON(this):s.toJSON?s.toJSON():s)&&r.push(a)}0===r.length?e.hasOwnProperty(t)&&Array.isArray(e[t])&&delete e[t]:this.serializeValue(e,t,r)},e.prototype.clearEvents=e.prototype.logEvent=e.prototype.logParseEvent=e.prototype.getEventAt=function(e){return this._validationEvents[e]},Object.defineProperty(e.prototype,"eventCount",{get:function(){return this._validationEvents.length},enumerable:!1,configurable:!0}),e}();t.BaseSerializationContext=u;var p=u),d=);t.PropertyDefinition=d;var h=function(e){eturn r(t,e),t.prototype.parse=function(e,t,n){var r=o.parseString(t[this.name],this.defaultValue);if(void 0===r||""===r&&this.treatEmptyAsUndefined||void 0===this.regEx||this.regEx.exec(r))return r;n.logParseEvent(e,a.ValidationEvent.InvalidPropertyValue,s.Strings.errors.invalidPropertyValue(r,this.name))},t.prototype.toJSON=t}(d);t.StringProperty=h;var f=function(e){function t(t,n,r,i){var o=e.call(this,t,n,r,i)||this;return o.targetVersion=t,o.name=n,o.defaultValue=r,o.onGetInitialValue=i,o}return r(t,e),t.prototype.parse=function(e,t,n){return o.parseBool(t[this.name],this.defaultValue)},t.prototype.toJSON=function(e,t,n,r){r.serializeBool(t,this.name,n,this.defaultValue)},t}(d);t.BoolProperty=f;var g=d);t.NumProperty=g;var m=d);t.PixelSizeProperty=m;var v=d);t.StringArrayProperty=v;var y=d);t.ValueSetProperty=y;var b=d);t.EnumProperty=b;var S=d);t.SerializableObjectProperty=S;var C=d);t.SerializableObjectCollectionProperty=C;var _=d);t.CustomProperty=_;var A=);t.SerializableObjectSchema=A,t.property=var w=function(){eturn e.prototype.getDefaultSerializationContext=function(){return new p},e.prototype.populateSchema=e.prototype.getValue=e.prototype.setValue=e.prototype.internalParse=e.prototype.internalToJSON=e.prototype.shouldSerialize=e.prototype.parse=e.prototype.toJSON=function(e){var t,n;if(e&&e instanceof u?t=e:(t=this.getDefaultSerializationContext()).toJSONOriginalParam=e,this.shouldSerialize(t))return this.internalToJSON(n=i.GlobalSettings.enableFullJsonRoundTrip&&this._rawProperties&&"object"==typeof this._rawProperties?this._rawProperties:{},t),n},e.prototype.hasDefaultValue=e.prototype.hasAllDefaultValues=e.prototype.resetDefaultValues=e.prototype.setCustomProperty=e.prototype.getCustomProperty=e.prototype.getSchema=e.defaultMaxVersion=c.latest,e._schemaCache={},e}();t.SerializableObject=w},JSHo:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("QjXU");,LsEq:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("8/lW"),i=n("DvUI");function o(e,t,n,o){var a=Object(i.a)(n),s={};return s.Area=e,s.Action=null!=t?t:"",s.Referral=null!=a?a:"",s.TabState=o?"New":"Current",{area:e,clickParams:s,dataSecurityLevel:r.a.Security,eventName:e+"_Click",elementId:null!=n?n:"",referral:null!=a?a:""}}},"M/ko":M21c:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n("QjXU"),i=n("qA3t"),o=n("GPOo"),a=n("nO8S"),s=n("+sqR"),l=n("7p/x"),c=n("io1X"),u=n("JSHo"),p=n("jbqF"),d=n("mXGw"),h=n.n(d),f=function(e){var t=Object(s.a)(),n=Object(l.a)(),f=Object(d.useContext)(a.a),g=Object(c.a)(),m=Object(d.useMemo)((function(){return f?e.theme:Object(u.a)(t,e.theme)}),[t,f,e.theme]),v=e.themeMode||g||n,y=e.dir||document.dir||void 0;return h.a.createElement(i.a,{value:"ohp-"},h.a.createElement(o.a,Object(r.__assign)({},e,{theme:m,dir:y}),h.a.createElement(p.a.Provider,{value:v},e.children)))}},Mdxb:function(e,t,n){"use strict";var r=this&&this.__awaiter||i=this&&this.__generator||Object.defineProperty(t,"__esModule",{value:!0}),t.AdaptiveApplet=void 0;var o=n("oZqk"),a=n("D7YB"),s=n("oxya"),l=n("QRIx"),c=n("vh9v"),u=n("5RAF"),p=n("IpoZ");ar h=),f=function(){eturn e.prototype.displayCard=e.prototype.showManualRefreshButton=e.prototype.createActivityRequest=function(e,t,n){var r=this;if(this.card){var i=new h(e,t,n);return i.onSend=this.onPrepareActivityRequest&&!this.onPrepareActivityRequest(this,i,e)?void 0:i}throw new Error("createActivityRequest: no card has been set.")},e.prototype.createMagicCodeInputCard=e.prototype.cancelAutomaticRefresh=e.prototype.createSerializationContext=e.prototype.internalSetCard=e.prototype.internalExecuteAction=e.prototype.createProgressOverlay=e.prototype.removeProgressOverlay=e.prototype.activityRequestSucceeded=e.prototype.activityRequestFailed=e.prototype.showAuthCodeInputDialog=e.prototype.internalSendActivityRequestAsync=function(e){return r(this,void 0,void 0,(function(){var t,n,r,a;return i(this,(function(u){switch(u.label){case 0:if(!this.channelAdapter)throw new Error("internalSendActivityRequestAsync: channelAdapter is not set.");void 0!==(t=this.createProgressOverlay(e))&&this.renderedElement.appendChild(t),n=!1,r=function(){var t,r,u,p,h,f,g;return i(this,(function(i){switch(i.label){case 0:t=void 0,d(o.LogLevel.Info,1===e.attemptNumber?"Sending activity request to channel (attempt "+e.attemptNumber+")":"Re-sending activity request to channel (attempt "+e.attemptNumber+")"),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,a.channelAdapter.sendRequestAsync(e)];case 2:return t=i.sent(),[3,4];case 3:return r=i.sent(),d(o.LogLevel.Error,"Activity request failed: "+r),a.removeProgressOverlay(e),n=!0,[3,4];case 4:if(!t)return[3,10];if(!(t instanceof l.SuccessResponse))return[3,5];if(a.removeProgressOverlay(e),void 0===t.rawContent)throw new Error("internalSendActivityRequestAsync: Action.Execute result is undefined");u=t.rawContent;try{u=JSON.parse(t.rawContent)}catch(e){}if("string"==typeof u)d(o.LogLevel.Info,"The activity request returned a string after "+e.attemptNumber+" attempt(s)."),a.activityRequestSucceeded(t,u);else{if("object"!=typeof u||"AdaptiveCard"!==u.type)throw new Error("internalSendActivityRequestAsync: Action.Execute result is of unsupported type ("+typeof t.rawContent+")");d(o.LogLevel.Info,"The activity request returned an Adaptive Card after "+e.attemptNumber+" attempt(s)."),a.internalSetCard(u,e.consecutiveRefreshes),a.activityRequestSucceeded(t,a.card)}return n=!0,[3,10];case 5:return t instanceof l.ErrorResponse?(p=a.activityRequestFailed(t))>=0&&e.attemptNumber<s.GlobalSettings.applets.maximumRetryAttempts?(d(o.LogLevel.Warning,"Activity request failed: ".concat(t.error.message,". Retrying in ").concat(p,"ms")),e.attemptNumber++,[4,new Promise(()]):[3,7]:[3,9];case 6:return i.sent(),[3,8];case 7:d(o.LogLevel.Error,"Activity request failed: ".concat(t.error.message,". Giving up after ").concat(e.attemptNumber," attempt(s)")),a.removeProgressOverlay(e),n=!0,i.label=8;case 8:return[3,10];case 9:if(t instanceof l.LoginRequestResponse){if(d(o.LogLevel.Info,"The activity request returned a LoginRequestResponse after "+e.attemptNumber+" attempt(s)."),e.attemptNumber<=s.GlobalSettings.applets.maximumRetryAttempts){if(h=!0,t.tokenExchangeResource&&a.onSSOTokenNeeded&&(h=!a.onSSOTokenNeeded(a,e,t.tokenExchangeResource)),h){if(a.removeProgressOverlay(e),void 0===t.signinButton)throw new Error("internalSendActivityRequestAsync: the login request doesn't contain a valid signin URL.");d(o.LogLevel.Info,"Login required at "+t.signinButton.value),a.onShowSigninPrompt?a.onShowSigninPrompt(a,e,t.signinButton):(a.showAuthCodeInputDialog(e),f=window.screenX+(window.outerWidth-s.GlobalSettings.applets.authPromptWidth)/2,g=window.screenY+(window.outerHeight-s.GlobalSettings.applets.authPromptHeight)/2,window.open(t.signinButton.value,t.signinButton.title?t.signinButton.title:"Sign in","width=".concat(s.GlobalSettings.applets.authPromptWidth,",height=").concat(s.GlobalSettings.applets.authPromptHeight,",left=").concat(f,",top=").concat(g)))}}else d(o.LogLevel.Error,"Authentication failed. Giving up after "+e.attemptNumber+" attempt(s)"),alert(c.Strings.magicCodeInputCard.authenticationFailed());return[2,"break"]}throw new Error("Unhandled response type: "+JSON.stringify(t));case 10:return[2]}}))},a=this,u.label=1;case 1:return n?[3,3]:[5,r()];case 2:return"break"===u.sent()?[3,3]:[3,1];case 3:return[2]}}))}))},e.prototype.refreshCard=e.prototype.setCard=Object.defineProperty(e.prototype,"card",{get:function(){return this._card},enumerable:!1,configurable:!0}),e._submitMagicCodeActionId="submitMagicCode",e._cancelMagicCodeAuthActionId="cancelMagicCodeAuth",e}();t.AdaptiveApplet=f},NruO:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n("mXGw"),i=n("R+QZ"),o=n("eeH7"),a=n("+Ltg"),s=n.n(a),l=Object(r.createContext)(null),c=({children:e,eventing:t,reactEventMapper:n})=>{const a=Object(r.useMemo)((()=>({bubble:e=>{const r=n?n(e):Object(o.a)(e);return t.bubble(r)},generateEvent:e=>{var n;const r={event:e.event,source:{inputType:i.a.programmatic,timeStamp:null!=(n=e.timeStampOverride)?n:Date.now()}};return t.bubble(r)}})),[t,n]);return Object(r.createElement)(l.Provider,{value:a},e)};c.displayName="NovaEventingProvider";var u=()=>{const e=Object(r.useContext)(l);return s()(e,"Nova Eventing provider must be initialized prior to consumption!"),e}},ORuF:QRIx:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.LoginRequestResponse=t.ErrorResponse=t.SuccessResponse=t.ActivityResponse=t.ActivityRequestError=t.ActivityRequestTrigger=void 0,t.ActivityRequestTrigger||(t.ActivityRequestTrigger={}));var i=);t.ActivityRequestError=i;var o=);t.ActivityResponse=o;var a=function(e){function t(t,n){var r=e.call(this,t)||this;return r.request=t,r.rawContent=n,r}return r(t,e),t}(o);t.SuccessResponse=a;var s=o);t.ErrorResponse=s;var l=o);t.LoginRequestResponse=l},"R+QZ":S1fv:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PopupControl=void 0;var r=n("AYKV"),i=n("D7YB"),o=n("Y59c"),a=function(){eturn e.prototype.keyDown=function(e){switch(e.key){case r.Constants.keys.escape:this.closePopup(!0)}},e.prototype.render=e.prototype.focus=e.prototype.popup=e.prototype.closePopup=Object.defineProperty(e.prototype,"hostConfig",{get:set:enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isOpen",{get:function(){return this._isOpen},enumerable:!1,configurable:!0}),e}();t.PopupControl=a},SLRu:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.PopupMenu=void 0;var i=n("AYKV"),o=n("cep7"),a=n("S1fv").PopupControl);t.PopupMenu=a},Sn4U:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),r||(r={}))},UVG0:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"loadStyles",(function(){return u})),n.d(t,"configureLoadStyles",(function(){return p})),n.d(t,"configureRunMode",(function(){return d})),n.d(t,"flush",(function(){return h})),n.d(t,"loadTheme",(function(){return g})),n.d(t,"clearStyles",(function(){return m})),n.d(t,"detokenize",(function(){return y})),n.d(t,"splitStyles",(function(){return S}));var r=i="undefined"==typeof window?e:window,o=i&&i.CSPSettings&&i.CSPSettings.nonce,a=function(){var e=i.__themeState__||{theme:void 0,lastStyleElement:void 0,registeredStyles:[]};return e.runState||(e=r(r({},e),{perf:{count:0,duration:0},runState:{flushTimer:0,mode:0,buffer:[]}})),e.registeredThemableStyles||(e=r(r({},e),{registeredThemableStyles:[]})),i.__themeState__=e,e}(),s=/[\'\"]\[theme:\s*(\w+)\s*(?:\,\s*default:\s*([\\"\']?[\.\,\(\)\#\-\s\w]*[\.\,\(\)\#\-\w][\"\']?))?\s*\][\'\"]/g,l=unction u(e,t){void 0===t&&(t=!1),c((function(){var n=Array.isArray(e)?e:S(e),r=a.runState,i=r.flushTimer;t||1===r.mode?(r.buffer.push(n),i||(a.runState.flushTimer=function(){return setTimeout((,0)}())):f(n)}))}nction h(){c(()}unction g(e){a.theme=e,function(){if(a.theme){for(var e=[],t=0,n=a.registeredThemableStyles;t<n.length;t++)e.push(n[t].themableStyle);e.length>0&&(m(1),f([].concat.apply([],e)))}}()}function m(e){void 0===e&&(e=3),3!==e&&2!==e||(v(a.registeredStyles),a.registeredStyles=[]),3!==e&&1!==e||(v(a.registeredThemableStyles),a.registeredThemableStyles=[])}unction y(e){return e&&(e=b(S(e)).styleString),e}call(this,n("pCvA"))},"VCg/":function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("QjXU"),i=n("6FUk"),o=n("xctO"),a=n("163P"),s=function(e,t){return{height:a.a.height,type:o.a.Url,url:e,width:a.a.width,title:t}},l=n("5ANk"),c=n("Dn7E"),u=function(e,t){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){return n=Object(l.a)(),[2,{appId:a.b,appHostSessionId:n,dialogType:t,taskInfo:e,submitHandler:function(){!function(e){Object(c.a)({featureName:"MOSHub",eventName:"MOS_Task_Module_Dialog",area:"MOSAppHost",params:{DebugInfo:e},subArea:"MOSTaskModuleDialog"})}("User invoked a ".concat(t," task module dialog"))}}]}))}))},p=function(e,t,n,o){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,u(s(n,t),o)];case 1:return(e=r.sent())?[2,Object(i.b)(e)]:[2,void 0]}}))}))}},"Xxc+":Y59c:function(e,t,n){"use strict";var r=this&&this.__extends||);Object.defineProperty(t,"__esModule",{value:!0}),t.defaultHostConfig=t.HostConfig=t.FontTypeSet=t.FontTypeDefinition=t.ContainerStyleSet=t.ContainerStyleDefinition=t.ColorSetDefinition=t.ActionsConfig=t.ShowCardActionConfig=t.FactSetConfig=t.FactTitleDefinition=t.FactTextDefinition=t.InputConfig=t.InputLabelConfig=t.RequiredInputLabelTextDefinition=t.TextBlockConfig=t.TextStyleSet=t.TextStyleDefinition=t.BaseTextDefinition=t.TableConfig=t.MediaConfig=t.ImageSetConfig=t.AdaptiveCardConfig=t.TextColorDefinition=t.ColorDefinition=void 0;var i=n("oZqk"),o=n("D7YB"),a=n("oxya"),s=n("7Sj9");ar c=);t.ColorDefinition=c;var u=c);t.TextColorDefinition=u;var p=function(){return ();t.AdaptiveCardConfig=p;var d=);t.ImageSetConfig=d;var h=);t.MediaConfig=h;var f=);t.TableConfig=f;var g=);t.BaseTextDefinition=g;var m=g);t.TextStyleDefinition=m;var v=);t.TextStyleSet=v;var y=function(){return ();t.TextBlockConfig=y;var b=g);t.RequiredInputLabelTextDefinition=b;var S=function(){return ();t.InputLabelConfig=S;var C=function(){return ();t.InputConfig=C;var _=g);t.FactTextDefinition=_;var A=_);t.FactTitleDefinition=A;var w=function(){return ();t.FactSetConfig=w;var E=);t.ShowCardActionConfig=E;var I=);t.ActionsConfig=I;var P=);t.ColorSetDefinition=P;var O=);t.ContainerStyleDefinition=O;var T=O),k=);t.ContainerStyleSet=k;var x=);t.FontTypeDefinition=x;var j=);t.FontTypeSet=j;var D=);t.HostConfig=D,t.defaultHostConfig=new D({supportsInteractivity:!0,spacing:{small:10,default:20,medium:30,large:40,extraLarge:50,padding:20},separator:{lineThickness:1,lineColor:"#EEEEEE"},fontTypes:{default:{fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}},monospace:{fontFamily:"'Courier New', Courier, monospace",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}}},imageSizes:{small:40,medium:80,large:160},containerStyles:{default:{backgroundColor:"#FFFFFF",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},emphasis:{backgroundColor:"#08000000",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},accent:{backgroundColor:"#C7DEF9",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},good:{backgroundColor:"#CCFFCC",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},attention:{backgroundColor:"#FFC5B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},warning:{backgroundColor:"#FFE2B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}}},inputs:{label:{requiredInputs:{weight:i.TextWeight.Bolder,suffix:" *",suffixColor:i.TextColor.Attention},optionalInputs:{weight:i.TextWeight.Bolder}},errorMessage:{color:i.TextColor.Attention,weight:i.TextWeight.Bolder}},actions:{maxActions:5,spacing:i.Spacing.Default,buttonSpacing:10,showCard:{actionMode:i.ShowCardActionMode.Inline,inlineTopMargin:16},actionsOrientation:i.Orientation.Horizontal,actionAlignment:i.ActionAlignment.Left},adaptiveCard:{allowCustomStyle:!1},imageSet:{imageSize:i.Size.Medium,maxImageHeight:100},factSet:{title:{color:i.TextColor.Default,size:i.TextSize.Default,isSubtle:!1,weight:i.TextWeight.Bolder,wrap:!0,maxWidth:150},value:{color:i.TextColor.Default,size:i.TextSize.Default,isSubtle:!1,weight:i.TextWeight.Default,wrap:!0},spacing:10}})},Zt7Y:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var r,i=n("QjXU"),o=n("H2n2"),a=function(e){function t(t){var n=e.call(this)||this;return n.dialogHandlers=t,n.urlService=new l(n.dialogHandlers),n.updateService=new s(n.dialogHandlers),n.cardService=new c(n.dialogHandlers),n}return Object(i.__extends)(t,e),t}(o.a),s=function(){return function(e){var t=this;this.dialogHandlers=e,this.resize=function(e){return void 0===t.dialogHandlers?Promise.reject("Missing dialog handlers"):(t.dialogHandlers.updateTask(e),Promise.resolve())}}}(),l=function(e){function t(t){var n=e.call(this)||this;return n.dialogHandlers=t,n.open=function(e){if(void 0===e)return Promise.reject("Missing dialog payload");if(void 0===n.dialogHandlers||!n.dialogHandlers.startTask)return Promise.reject("Missing dialog handlers");var t=new Promise((function(e,t){r={externalResolver:e,externalRejector:t}}));return n.dialogHandlers.startTask(e),t},n.submit=function(e){return void 0===n.dialogHandlers?Promise.reject("Missing dialog handlers"):(n.dialogHandlers.submitTask(e),r.externalResolver(e),Promise.resolve())},n.messageForParent=function(e){return n.dispatchEvent("onMessageForParent",{data:e}),Promise.resolve()},n.messageForChild=function(e){return n.dispatchEvent("onMessageForChild",{data:e}),Promise.resolve()},n}return Object(i.__extends)(t,e),t}(o.a),c=function(){return function(e){var t=this;this.dialogHandlers=e,this.open=function(e){if(void 0===e)return Promise.reject("Missing dialog payload");if(void 0===t.dialogHandlers||!t.dialogHandlers.startTask)return Promise.reject("Missing dialog handlers");var n=new Promise(();return t.dialogHandlers.startTask(e),n}}}()},aJMp:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("QjXU"),i=n("NZpx"),o=n("mXGw"),a=n.n(o);function s(e,t){var n=Object(r.__read)(a.a.useState(null),2),o=n[0],s=n[1],l=Object(i.a)().data;return a.a.useEffect((function(){var n=null==l?void 0:l.remoteModulesEnabled;null!=n&&(n?function(){Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return t=s,[4,e()];case 1:return t.apply(void 0,[n.sent()]),[2]}}))}))}():s((function(){return t})))}),[null==l?void 0:l.remoteModulesEnabled,e,t]),o}},am3b:amm4:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.CardObject=t.ValidationResults=void 0;var o=n("oZqk"),a=n("vh9v"),s=n("oxya"),l=n("7Sj9"),c=n("IpoZ"),u=);t.ValidationResults=u;var p=c.SerializableObject);t.CardObject=p},cep7:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Collection=void 0;var r=);t.Collection=r},dlqR:function(e,t,n){"use strict";var r,i,o,a,s,l;n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return l})),function(e){e.office="Office",e.orange="Orange",e.outlook="Outlook",e.outlookWin32="OutlookWin32",e.teams="Teams",e.teamsModern="TeamsModern"}(r||(r={})),function(e){e.windows="windows",e.macOs="macos"}(i||(i={})),function(e){e.default="default",e.dark="dark",e.highContrast="contrast"}(o||(o={})),function(e){e.fileOpenPreference="fileOpenPreference",e.theme="theme"}(a||(a={})),function(e){e.web="web",e.desktop="desktop"}(s||(s={})),l||(l={}))},due6:eeH7:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("R+QZ"),i={dblclick:r.a.mouse,keydown:r.a.keyboard,keyup:r.a.keyboard,keypress:r.a.keyboard,mousedown:r.a.mouse,mouseenter:r.a.mouse,mouseleave:r.a.mouse,mousemove:r.a.mouse,mouseover:r.a.mouse,mouseout:r.a.mouse,mouseup:r.a.mouse,touchcancel:r.a.touch,touchend:r.a.touch,touchmove:r.a.touch,touchstart:r.a.touch,wheel:r.a.mouse},o={"":r.a.keyboard,mouse:r.a.mouse,pen:r.a.pen,touch:r.a.touch},a=e=>{const{event:t,reactEvent:n}=e,a="click"===n.type?(e=>{const t=o[e];return null!=t?t:r.a.unknown})(n.nativeEvent.pointerType):i[n.type];return{event:t,source:{inputType:null!=a?a:r.a.unknown,timeStamp:n.timeStamp}}}},h8qh:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("NrNW"),i=n("B5kz"),o=n("CU8J"),a=n("2y7E");function s(e){var t,n;void 0===e&&(e="office-start-resources");var s=Object(r.a)().data,l=Object(o.a)().data,c=["LocStrings",e,(null===(n=null===(t=null==l?void 0:l.result)||void 0===t?void 0:t.m365StringLogoGates)||void 0===n?void 0:n.m365StringLogoEnabled)||!1];return Object(i.c)(c,(function(){return Object(a.b)(s.cdnDomain,s.preferredCulture,s.stringsContainerName,e,l)}),{staleTime:1/0,cacheTime:1/0,enabled:!!s})}},hSma:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("QjXU"),i=n("MJsD"),o=n("BULU"),a=n("Dn7E"),s=n("VCg/"),l=n("kKFt"),c=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(a.a)({featureName:"MOSHub",eventName:"AppInstallDialog",params:{AppId:e,AppCapabilities:"OpenAppUpgradeDialog",DebugInfo:"Open app upgrade dialog",Service:"AppUpgradeDialogService"},area:"MOSAppHost",subArea:"UpgradeDialog"}),[4,Object(i.a)()];case 1:return t=r.sent(),n=Object(l.a)(t,e),[4,Object(o.a)()];case 2:return c=r.sent(),[2,Object(s.a)(e,c.metaOSHubResources.dialogAboutAppTitle,n,"UPGRADE")]}}))}))}},iFjN:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("GBVN"),i=n("x3xY"),o=n("HeHW"),a=n("mXGw"),s=n.n(a),l=n("Cgy6"),c={"error-header-text":"AppHostErrorControl-module__error-header-text__1e7FJ","error-header-textdark":"AppHostErrorControl-module__error-header-textdark__34vm3","error-header-textdefault":"AppHostErrorControl-module__error-header-textdefault__2x6oX","text-container":"AppHostErrorControl-module__text-container__5nNRS","error-secondary-text":"AppHostErrorControl-module__error-secondary-text__8d4bu","error-secondary-textdark":"AppHostErrorControl-module__error-secondary-textdark__3BK_S","error-secondary-textdefault":"AppHostErrorControl-module__error-secondary-textdefault__DAaDY"},u=function(e){return s.a.createElement("svg",{width:e.width,height:e.height,viewBox:e.viewBox,xmlns:"http://www.w3.org/2000/svg"},s.a.createElement("path",{d:"M234.341 107.56c-.71-.29-1.36-.7-1.91-1.23a6.124 6.124 0 01-1.36-1.9 5.55 5.55 0 01-.52-2.34c-.02-.83.15-1.65.48-2.41.32-.72.77-1.37 1.33-1.92a6.06 6.06 0 011.9-1.26c2.22-.91 4.77-.43 6.5 1.23a5.769 5.769 0 011.78 4.27 5.69 5.69 0 01-1.71 4.29 5.919 5.919 0 01-4.24 1.75c-.77-.01-1.54-.18-2.25-.48zm-2.83-22.69l-1.13-29.15c-.11-2.83 2.15-5.2 4.98-5.22l1.83-.01a5.021 5.021 0 015.06 5.14l-.71 29.16a5.023 5.023 0 01-4.98 4.9 5.002 5.002 0 01-5.05-4.82z",fill:"#CCC"}),s.a.createElement("path",{d:"M236.461 122.12c-23.74 0-43.06-19.32-43.06-43.06 0-23.74 19.32-43.06 43.06-43.06 23.74 0 43.06 19.32 43.06 43.06 0 23.74-19.32 43.06-43.06 43.06zm0-77.23c-18.84 0-34.17 15.33-34.17 34.17 0 18.84 15.33 34.17 34.17 34.17 18.84 0 34.17-15.33 34.17-34.17 0-18.84-15.33-34.17-34.17-34.17z",fill:"#CCC"}),s.a.createElement("path",{d:"M179.702 152.03c-3.69-16.59-3.88-26.94-6.95-42.62l-5.37-24.38-12.82 6.42c-2.93-.77-6.18-.91-9.77-.26-1.86.34-5.92 1.89-5.92 1.89l-12.64-3.23s1.78 13.26 2.23 23.54c.77 17.81-3.48 31.06-7.78 43.11-6.41 17.95-21.79 32.69-24.19 45.43-2.77 14.75 4.34 35.47 18.78 38.81 7.61 1.76 27.45.62 38.94-.32 12.86-1.05 20.52-2.15 28.96-3.12 7.89-.91 20.1-17.62 11.87-41.66-3.65-10.64-10.6-22.28-15.34-43.61z",fill:"#E1DFDD"}),s.a.createElement("path",{d:"M156.832 118.85c-.6 0-1.13-.45-1.22-1.06l-.73-5.32c-.09-.67.38-1.29 1.05-1.39.67-.09 1.29.38 1.39 1.05l.73 5.32c.09.67-.38 1.29-1.05 1.39-.06.01-.11.01-.17.01z",fill:"#B2AEAA"}),s.a.createElement("path",{d:"M151.642 109.91c-.14-1.47 1.75-1.94 3.57-2.1 1.81-.17 3.65-.29 3.78 1.18.13 1.47-1.48 3.99-3.29 4.15-1.81.16-3.92-1.76-4.06-3.23zM164.094 106.431c1.45-.197 2.444-1.7 2.219-3.359-.225-1.658-1.583-2.843-3.033-2.646-1.45.196-2.444 1.7-2.219 3.358.225 1.658 1.583 2.843 3.033 2.647zM144.595 109.071c1.45-.196 2.444-1.7 2.219-3.358-.225-1.658-1.583-2.843-3.033-2.646-1.45.196-2.444 1.7-2.219 3.358.225 1.658 1.583 2.843 3.033 2.646z",fill:"#B2AEAA"}),s.a.createElement("path",{d:"M200.952 243.39H91.562c-3.18 0-5.75-2.57-5.75-5.75v-90.07c0-3.18 2.57-5.75 5.75-5.75h109.39c3.18 0 5.75 2.57 5.75 5.75v90.07c0 3.18-2.57 5.75-5.75 5.75z",fill:"#CCC"}),s.a.createElement("path",{d:"M173.452 195.35h-54.39c-2.21 0-3.99-1.79-3.99-3.99v-12.03c0-2.21 1.79-3.99 3.99-3.99h54.39c2.21 0 3.99 1.79 3.99 3.99v12.03c.01 2.2-1.78 3.99-3.99 3.99z",fill:"#FAF9F8"}),s.a.createElement("path",{d:"M22.642 242.68L3.102 231.4c-2.97-1.71-3.98-5.5-2.27-8.47l64.99-112.57c1.71-2.97 5.5-3.98 8.47-2.27l19.54 11.28c2.97 1.71 3.98 5.5 2.27 8.47l-64.99 112.57c-1.71 2.97-5.5 3.98-8.47 2.27z",fill:"#CCC"}),s.a.createElement("path",{d:"M127.851 59.93l3.04 7.35c.36.87 1.36 1.28 2.23.92.17-.07.32-.16.45-.27.55-.47.76-1.25.47-1.95l-3.04-7.36a1.706 1.706 0 00-2.23-.92c-.86.36-1.28 1.36-.92 2.23zM121.502 77.46a1.7 1.7 0 00-.95-2.21l-6.12-2.44a1.7 1.7 0 00-2.21.95 1.7 1.7 0 00.95 2.21l6.12 2.44c.61.24 1.27.11 1.73-.28.21-.17.38-.4.48-.67zM147.752 63.98c-.37.86.03 1.87.89 2.24.61.26 1.3.14 1.78-.26.2-.16.36-.38.46-.63l2.67-6.2a1.71 1.71 0 00-.89-2.24 1.71 1.71 0 00-2.24.89l-2.67 6.2z",fill:"#E1DFDD"}))},p=function(e){return s.a.createElement("svg",{width:e.width,height:e.height,viewBox:e.viewBox,xmlns:"http://www.w3.org/2000/svg"},s.a.createElement("path",{d:"M234.341 107.56C233.631 107.27 232.981 106.86 232.431 106.33C231.861 105.79 231.401 105.15 231.071 104.43C230.731 103.7 230.551 102.9 230.551 102.09C230.531 101.26 230.701 100.44 231.031 99.68C231.351 98.96 231.801 98.31 232.361 97.76C232.911 97.22 233.551 96.8 234.261 96.5C236.481 95.59 239.031 96.07 240.761 97.73C241.921 98.84 242.571 100.39 242.541 102C242.601 103.61 241.981 105.17 240.831 106.29C239.711 107.42 238.181 108.05 236.591 108.04C235.821 108.03 235.051 107.86 234.341 107.56ZM231.511 84.87L230.381 55.72C230.271 52.89 232.531 50.52 235.361 50.5L237.191 50.49C240.031 50.47 242.321 52.8 242.251 55.63L241.541 84.79C241.471 87.5 239.271 89.67 236.561 89.69C233.851 89.72 231.611 87.58 231.511 84.87Z",fill:"#797673"}),s.a.createElement("path",{d:"M236.461 122.12C212.721 122.12 193.401 102.8 193.401 79.06C193.401 55.32 212.721 36 236.461 36C260.201 36 279.521 55.32 279.521 79.06C279.521 102.8 260.201 122.12 236.461 122.12ZM236.461 44.89C217.621 44.89 202.291 60.22 202.291 79.06C202.291 97.9 217.621 113.23 236.461 113.23C255.301 113.23 270.631 97.9 270.631 79.06C270.631 60.22 255.301 44.89 236.461 44.89Z",fill:"#797673"}),s.a.createElement("path",{d:"M179.702 152.03C176.012 135.44 175.822 125.09 172.752 109.41L167.382 85.0299L154.562 91.4499C151.632 90.6799 148.382 90.5399 144.792 91.1899C142.932 91.5299 138.872 93.0799 138.872 93.0799L126.232 89.8499C126.232 89.8499 128.012 103.11 128.462 113.39C129.232 131.2 124.982 144.45 120.682 156.5C114.272 174.45 98.8916 189.19 96.4916 201.93C93.7216 216.68 100.832 237.4 115.272 240.74C122.882 242.5 142.722 241.36 154.212 240.42C167.072 239.37 174.732 238.27 183.172 237.3C191.062 236.39 203.272 219.68 195.042 195.64C191.392 185 184.442 173.36 179.702 152.03Z",fill:"#797673"}),s.a.createElement("path",{d:"M156.832 118.85C156.232 118.85 155.702 118.4 155.612 117.79L154.882 112.47C154.792 111.8 155.262 111.18 155.932 111.08C156.602 110.99 157.222 111.46 157.322 112.13L158.052 117.45C158.142 118.12 157.672 118.74 157.002 118.84C156.942 118.85 156.892 118.85 156.832 118.85Z",fill:"#141414"}),s.a.createElement("path",{d:"M151.642 109.91C151.502 108.44 153.392 107.97 155.212 107.81C157.022 107.64 158.862 107.52 158.992 108.99C159.122 110.46 157.512 112.98 155.702 113.14C153.892 113.3 151.782 111.38 151.642 109.91Z",fill:"#141414"}),s.a.createElement("path",{d:"M164.094 106.431C165.544 106.234 166.538 104.731 166.313 103.072C166.088 101.414 164.731 100.229 163.28 100.426C161.83 100.622 160.837 102.126 161.061 103.784C161.286 105.442 162.644 106.627 164.094 106.431Z",fill:"#141414"}),s.a.createElement("path",{d:"M144.595 109.071C146.045 108.875 147.039 107.371 146.814 105.713C146.589 104.055 145.231 102.87 143.781 103.067C142.331 103.263 141.337 104.767 141.562 106.425C141.787 108.083 143.145 109.268 144.595 109.071Z",fill:"#141414"}),s.a.createElement("path",{d:"M200.952 243.39H91.5616C88.3816 243.39 85.8116 240.82 85.8116 237.64V147.57C85.8116 144.39 88.3816 141.82 91.5616 141.82H200.952C204.132 141.82 206.702 144.39 206.702 147.57V237.64C206.702 240.82 204.132 243.39 200.952 243.39Z",fill:"#605D5A"}),s.a.createElement("path",{d:"M173.452 195.35H119.062C116.852 195.35 115.072 193.56 115.072 191.36V179.33C115.072 177.12 116.862 175.34 119.062 175.34H173.452C175.662 175.34 177.442 177.13 177.442 179.33V191.36C177.452 193.56 175.662 195.35 173.452 195.35Z",fill:"#33312D"}),s.a.createElement("path",{d:"M22.6416 242.68L3.10159 231.4C0.13159 229.69 -0.87841 225.9 0.83159 222.93L65.8216 110.36C67.5316 107.39 71.3216 106.38 74.2916 108.09L93.8316 119.37C96.8016 121.08 97.8116 124.87 96.1016 127.84L31.1116 240.41C29.4016 243.38 25.6116 244.39 22.6416 242.68Z",fill:"#605D5A"}),s.a.createElement("path",{d:"M127.852 59.93L130.892 67.28C131.252 68.15 132.252 68.56 133.122 68.2C133.292 68.13 133.442 68.04 133.572 67.93C134.122 67.46 134.332 66.68 134.042 65.98L131.002 58.62C130.642 57.75 129.642 57.34 128.772 57.7C127.912 58.06 127.492 59.06 127.852 59.93Z",fill:"#33312D"}),s.a.createElement("path",{d:"M121.502 77.4599C121.852 76.5899 121.422 75.5899 120.552 75.2499L114.432 72.8099C113.562 72.4599 112.562 72.8899 112.222 73.7599C111.872 74.6299 112.302 75.6299 113.172 75.9699L119.292 78.4099C119.902 78.6499 120.562 78.5199 121.022 78.1299C121.232 77.9599 121.402 77.7299 121.502 77.4599Z",fill:"#33312D"}),s.a.createElement("path",{d:"M147.752 63.9799C147.382 64.8399 147.782 65.8499 148.642 66.2199C149.252 66.4799 149.942 66.3599 150.422 65.9599C150.622 65.7999 150.782 65.5799 150.882 65.3299L153.552 59.1299C153.922 58.2699 153.522 57.2599 152.662 56.8899C151.802 56.5199 150.792 56.9199 150.422 57.7799L147.752 63.9799Z",fill:"#33312D"}))},d=function(e){var t=e.correlationId,n=e.refreshCallBack,a=e.errorStrings,d=Object(o.a)(),h=d?"dark":"default";return s.a.createElement("div",{className:l.a.container,style:{textAlign:"center"}},s.a.createElement(d?p:u,{width:"280",height:"280",viewBox:"0 0 280 280"}),s.a.createElement("div",{className:Object(r.a)(c["text-container"],l.a["container-no-grow"])},s.a.createElement("span",{className:c["error-header-text".concat(h)]},a.errorUiHeaderText),s.a.createElement("span",{className:c["error-secondary-text".concat(h)]},a.errorUiSecondaryText),s.a.createElement("span",{className:c["error-secondary-text".concat(h)]},a.correlationIdLabel," ",t)),s.a.createElement(i.a,{appearance:"primary",onClick:n,size:"medium"},a.retryButtonText))}},io1X:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("mXGw"),i=n.n(r),o=n("jbqF"),a=,jbqF:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("mXGw"),i=n.n(r).a.createContext(void 0)},k0Ee:function(e,t,n){"use strict";n.d(t,"b",(function(){return U})),n.d(t,"a",(function(){return q}));var r,i,o=n("QjXU"),a=n("dlqR"),s=n("xctO"),l=n("72kp"),c=n("NruO"),u=n("eeH7"),p="AdaptiveCard",d="submitEvent",h="openUrlEvent",f=function(e){return{originator:p,type:d,data:e}},g=m=n("wpzn"),v=n("mXGw"),y=n.n(v),b=function(e,t){return t&&t(),y.a.createElement(y.a.Fragment,null,e)},S=C=function(e){var t=e.payload,n=e.cardActionsHandler,r=e.errorFallbackHandler,i=e.hostConfig,a=Object(o.__read)(Object(v.useState)(y.a.createElement(y.a.Fragment,null)),2),s=a[0],l=a[1],c=new m.AdaptiveCard;return Object(v.useEffect)((function(){var e=S(t);if(i){var o=S(i);o||l(b("⚠ Can not parse Host Config JSON.",r)),c.hostConfig=new m.HostConfig(o)}if(e){c.parse(e),c.onExecuteAction=function(e){return n(e)};var a=function(e){var t;return null!==(t=e.render())&&void 0!==t?t:void 0}(c);l(a?y.a.createElement("div",{ref:function(e){!(null==e?void 0:e.hasChildNodes())&&(null==e||e.appendChild(a))}}):b("⚠ Can not render unsupported content type.",r))}else l(b("⚠ Can not parse Adaptive Card JSON.",r));return function(){}}),[t,n]),s},_=function(e){var t=Object(c.b)(),n=e.card,r=e.errorFallbackHandler,i=e.hostConfig,o=function(e){e instanceof m.SubmitAction&&t.generateEvent({event:f((function(){return{data:e.data}}))}),e instanceof m.OpenUrlAction&&t.generateEvent({eveurl}}))})};return Object(v.useM:i})}),[n,t,i])},A=n("Zt7Y"),w=n("gd1C"),E=n("6FUk"),I=((r={}).AdaptiveCard=function(e){return function(e,t){var n,r,i=e&&e;if(i.type===h&&i.data)(o=i.data()).url&&(null===(n=t.openUrlEvent)||void 0===n||n.call(t,o.url));else if(i.type===d&&i.data){var o;(o=i.data()).data&&(null===(r=t.submitEvent)||void 0===r||r.call(t,o.data),Object(E.c)())}}(e.event,{submitr(e)},openUrlr"})}})},r),P=function(e){var t=e.card,n=e.errorFallbackHandler,r=e.hostConfig,i=function(){return{bubble:function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){if(I[e.event.originator])return[2,I[e.event.originator](e)];throw new Error("No such ".concat(e.event.originator," event exist"))}))}))}}}();return y.a.createElement(c.a,{eventing:i,reactEventMapper:u.a},y.a.createElement(_,{card:t,errorFallbackHandler:n,hostConfig:r}))},O=n("sc41"),T=n("o4R2"),k=n("Xxc+"),x=n("NrNW"),j=n("CaQ9"),D=n("h8qh"),R=n("HMCg"),H=n("aJMp"),N=n("+fbL"),V=n("+4M4");!function(e){e[e.TaosDogfood=0]="TaosDogfood",e[e.Dogfood=1]="Dogfood",e[e.Microsoft=2]="Microsoft",e[e.TargetedRelease=3]="TargetedRelease",e[e.WorldWide=4]="WorldWide"}(i||(i={}));var L=n("lUkk"),M=function(e){switch(e){case"ABOUT":return"MOSAboutDialog";case"INSTALL":return"MOSInstallDialog";case"UPGRADE":return"MOSUpgradeDialog";case"ADAPTIVECARD":return"MOSAdaptiveCardDialog";case"TASKMODULE":default:return"MOSTaskModuleDialog"}},F=function(e,t,n,r,i){Object(L.a)({type:e,id:t,area:"MOSTaskModuleDialog",result:n,target:"MOSTaskModuleDialog",eventName:"MOS_Task_Module_Dialog",subArea:M(r),targetId:i})},B=n("qyk8"),z=Object(v.createRef)(),U=function(e){var t;F("Resize","Update_Task_Module_Dialog","Edit"),null===(t=z.current)||void 0===t||t.set({height:e.height,width:e.width})},W=function(){A.b&&(F("Click","Cancel_Task_Module_Dialog","Cancel"),A.b.externalRejector("User cancelled/closed the task module.")),Object(E.c)()},q=function(){var e,t,r,c,u,p,d,h=Object(H.a)((function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(701).then(n.bind(null,"PhR8"))];case 1:return[2,e.sent().RemotableTaskModuleDialogControl]}}))}))}),N.a),f=Object(x.a)().data,g=Object(j.a)().data,m=Object(D.a)().data,b=function(){var e,t,n=Object(V.a)().data,r=null===(t=null===(e=null==n?void 0:n.result)||void 0===e?void 0:e.ring)||void 0===t?void 0:t.value,o=r&&r in i?r:i[i.TaosDogfood];return Object(v.useMemo)((function(){return{ringId:"Ring"+i[o]}}),[o])}(),S=Object(o.__read)(Object(v.useState)(),2),C=S[0],_=S[1],A=Object(o.__read)(Object(v.useState)(null),2),I=A[0],L=A[1];Object(v.useEffect)((function(){var e=Object(E.a)().subscribe(L);return function(){e.unsubscribe()}}),[]);var M=Object(v.useCallbc)()}),[]),F=Object(v.useCallback)((function(e){U(e)}),[]),q=Object(R.a)(null!==(e=null==I?void 0:I.appId)&&void 0!==e?e:"").appDefinition,G=Object(O.a)({appHostSessionId:null!==(t=null==I?void 0:I.appHostSessionId)&&void 0!==t?t:"",appId:null!==(r=null==I?void 0:I.appId)&&void 0!==r?r:"",entityId:null!==(p=null===(u=null===(c=null==q?void 0:q.staticTabs)||void 0===c?void 0:c[0])||void 0===u?void 0:u.entityId)&&void 0!==p?p:"",frameContext:a.a.task,isFullScreen:!1,ringId:b.ringId,additionalParams:null==I?void 0:I.additionalParams});if(Object(v.useEffect)((function(){var e=!0;return function(){Object(o.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r;return Object(o.__generator)(this,(function(i){switch(i.label){case 0:return I&&q?[4,Object(T.a)({appId:I.appId,appHostSessionId:null!==(n=I.appHostSessionId)&&void 0!==n?n:"",frameContext:a.a.task,userId:null!==(r=null==g?void 0:g.puid)&&void 0!==r?r:"",dialogHandlers:{submitTask:M,updateTask:F}})]:[2];case 1:return t=i.sent(),e&&t&&_(t),[2]}}))}))}(),function(){e=!1}}),[I,null==I?void 0:I.appId,null==I?void 0:I.appHostSessionId,null==g?void 0:g.puid,M,F,q]),!(I&&m&&q&&G&&C))return null;var J=I.taskInfo,X=I.dialogType;J.title=function(e,t,n){if(!e)switch(n){case"UPGRADE":case"ABOUT":return Object(B.a)(e,t);default:return e}}(null!==(d=J.title)&&void 0!==d?d:"",q.name,X);var Z,K="TASKMODULE"!==X;if(G.page.subPageId=K?JSON.stringify(function(e){return{supportedElementInfo:{staticTabs:[{scopes:["personal"]}]},isUpgrade:"UPGRADE"===e,allowInstall:"INSTALL"===e}}(X)):G.page.subPageId,J.type==s.a.Card)Z=y.a.createElement(P,{card:J.card,errorFallbackHandler:function(){J.fallbackUrl&&Object(w.a)(J.fallbackUrl,{action:"OpenInBrowser",linkTarget:"_blank"})}});else if(J.type==s.a.Url&&f&&g){var Y={hostWindow:window,hubServices:C,appDefinition:q.hubSdkAppDefinition,contentUrl:J.url,title:J.title,context:G,hostVersionsInfo:k.a};Z=y.a.createElement(l.a,Object(o.__assign)({},Y))}return h&&y.a.createElement(h,{taskInfo:I.taskInfo,onCancel:W,appName:q.name,locStrings:m.metaOSHubResources,icon:q.largeImageUrl,hideHeader:K,ref:z},Z)}},kAGr:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("QjXU"),i=n("yoRs"),o=n("ob/S"),a=n("/LVV"),s=n("FtiY"),l=n("FPnS"),c=[],u=new Map;function p(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=function(e){return"M".concat(e.mode,"L").concat(d(e.lightBrandColors),"D").concat(d(e.darkBrandColors))}(e),(n=function(e){var t=u.get(e);if(t){var n=c.indexOf(e);c.splice(n,1),c.push(e)}return t}(t))?[2,n]:[4,h(e)];case 1:return i=r.sent(),function(e,t){if(!u.has(e)&&(c.push(e),u.set(e,t),c.length>10)){var n=c.shift();n&&u.delete(n)}}(t,i),[2,i]}}))}))}function d(e){return e?e.themeDark+e.themeDarkAlt+e.themeDarker+e.themeLight+e.themeLight+e.themeLighter+e.themeLighterAlt+e.themePrimary+e.themeSecondary+e.themeTertiary:""}function h(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:switch(c=function(e){if(e.lightBrandColors){if(!e.darkBrandColors){if(e.mode===l.a.dark)return;return{10:e.lightBrandColors.themeDarker,20:e.lightBrandColors.themeDarker,30:e.lightBrandColors.themeDarker,40:e.lightBrandColors.themeDarker,50:e.lightBrandColors.themeDarker,60:e.lightBrandColors.themeDark,70:e.lightBrandColors.themeDarkAlt,80:e.lightBrandColors.themePrimary,90:e.lightBrandColors.themeSecondary,100:e.lightBrandColors.themeSecondary,110:e.lightBrandColors.themeTertiary,120:e.lightBrandColors.themeTertiary,130:e.lightBrandColors.themeTertiary,140:e.lightBrandColors.themeTertiary,150:e.lightBrandColors.themeLight,160:e.lightBrandColors.themeLighter}}return{10:e.darkBrandColors.themeLighter,20:e.darkBrandColors.themeLight,30:e.lightBrandColors.themeDarker,40:e.darkBrandColors.themeTertiary,50:e.lightBrandColors.themeDark,60:e.lightBrandColors.themeDarkAlt,70:e.overridePaletteMapping?e.lightBrandColors.themeSecondary:e.darkBrandColors.themeSecondary,80:e.lightBrandColors.themePrimary,90:e.overridePaletteMapping?e.darkBrandColors.themeSecondary:e.lightBrandColors.themeSecondary,100:e.darkBrandColors.themePrimary,110:e.darkBrandColors.themeDarkAlt,120:e.darkBrandColors.themeDark,130:e.lightBrandColors.themeTertiary,140:e.darkBrandColors.themeDarker,150:e.lightBrandColors.themeLight,160:e.lightBrandColors.themeLighter}}}(e),e.mode){case l.a.dark:return[3,1];case l.a.highContrast:return[3,2]}return[3,4];case 1:return t=c?Object(i.a)(c):o.a,[3,5];case 2:return[4,n.e(994).then(n.bind(null,"mTTy"))];case 3:return u=r.sent().createHighContrastTheme,t=u(),[3,5];case 4:return t=c?Object(a.a)(c):s.a,[3,5];case 5:return[2,f(t,c,e)]}}))}))}function f(e,t,n){if(!n.overrideTokenMapping||!t)return e;if("harmony"===n.themeId){switch(e.colorBrandBackgroundInvertedPressed=t[130],e.colorBrandForegroundOnLightPressed=t[40],n.mode){case l.a.dark:e.colorBrandBackground2=t[20],e.colorBrandBackgroundHover=t[100],e.colorBrandForeground2=t[120],e.colorBrandForegroundInverted=t[100],e.colorBrandForegroundInvertedPressed=t[40],e.colorBrandForegroundLinkHover=t[120],e.colorBrandForegroundLinkSelected=t[110],e.colorBrandForegroundOnLight=t[100],e.colorCompoundBrandBackgroundHover=t[120],e.colorCompoundBrandForeground1Hover=t[120],e.colorCompoundBrandStrokeHover=t[120];break;case l.a.default:e.colorBrandForegroundInvertedPressed=t[90],e.colorBrandStroke2=t[140],e.colorCompoundBrandBackgroundPressed=t[40],e.colorCompoundBrandStrokePressed=t[40]}return e}switch(n.mode){case l.a.dark:e.colorBrandForegroundOnLightHover=t[60],e.colorBrandForegroundOnLightPressed=t[30],e.colorBrandForegroundOnLightSelected=t[50],e.colorBrandBackground=t[60],e.colorBrandBackgroundPressed=t[30],e.colorBrandBackgroundSelected=t[50],e.colorBrandBackground2=t[30];break;case l.a.default:e.colorNeutralForeground2BrandPressed=t[60],e.colorNeutralForeground3BrandPressed=t[60],e.colorBrandForegroundLink=t[60],e.colorBrandForegroundLinkHover=t[50],e.colorBrandForegroundLinkPressed=t[30],e.colorBrandForegroundLinkSelected=t[60],e.colorCompoundBrandForeground1Hover=t[60],e.colorCompoundBrandForeground1Pressed=t[50],e.colorBrandForeground2=t[60],e.colorBrandForegroundOnLightHover=t[60],e.colorBrandForegroundOnLightPressed=t[30],e.colorBrandForegroundOnLightSelected=t[50],e.colorBrandBackgroundHover=t[60],e.colorBrandBackgroundPressed=t[30],e.colorBrandBackgroundSelected=t[50],e.colorCompoundBrandBackgroundHover=t[60],e.colorCompoundBrandBackgroundPressed=t[50],e.colorCompoundBrandStrokeHover=t[60],e.colorCompoundBrandStrokePressed=t[50]}return e}},kKFt:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("qyk8"),i=n("163P"),o=function(e,t){return Object(r.a)(i.c,t,e.preferredCulture)}}n n}},o4R2:function(e,t,n){"use strict";n.d(t,"a",(function(){return Q}));var r,i,o,a=n("QjXU"),s=n("5hZV"),l=["www.office.com","www.officeppe.com","www.office365.us","scuprodprv.www.office.com","neuprodprv.www.office.com","ohome.microsoft.scloud","ohome.eaglex.ic.gov","www.ohome.apps.mil","localhost:5000"],c=n("EZgZ"),u=n("MJsD"),p=n("Hyok"),d=n("BULU"),h=n("Dn7E"),f=n("CMIt"})},m=n("W7wX"),v=n("qyk8"),y=function(e){function t(t,n,r){var i=e.call(this)||this;return i.acquireToken=function(e,t,n){return Object(a.__awaiter)(i,void 0,void 0,(function(){var r;return Object(a.__generator)(this,(function(i){switch(i.label){case 0:if(!e)throw new Error("Resource URL not provided");return[4,this.accessTokenResponseFunction("MetaOS",!1,e,void 0,void 0,t,n,{category:"MetaOSApp"})];case 1:if((r=i.sent()).success&&r.token)return[2,{token:r.token}];throw Object(f.a)({eventName:"Access_Token_Response",errorType:"GetOfficeToken_Error",message:"Unable to get access token. Access token response error",debugInfo:"acquireToken for resource: ".concat(e," failed for MOSAppHost. claims: ").concat(t,", isSilent: ").concat(n)}),new Error("Unable to get access token")}}))}))},i.getUser=function(){return Object(a.__awaiter)(i,void 0,void 0,(function(){return Object(a.__generator)(this,(function(e){return[2,Object(a.__assign)({},this.user)]}))}))},i.accessTokenResponseFunction=t,i.user=n,i.authRedirectUrl=r,i}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"externalAuthRedirectUrl",{get:function(){return this.authRedirectUrl},enumerable:!1,configurable:!0}),t}(n("H2n2").a),b="0ec893e0-5785-4de6-99da-4ed124e5296c";!function(e){e.MSA="consumers",e.AAD="organizations"}(r||(r={})),function(e){e.CurrentUserProviderId="CurrentUserProviderId",e.CurrentAuthority="CurrentAuthority",e.CurrentAccountId="CurrentAccountId"}(i||(i={})),function(e){e.Local="https://login.windows.local",e.MsaAad="https://login.microsoft.com"}(o||(o={}));var S=window.chrome&&window.chrome.webview,C=function(){var e,t,n,r,i;return S?null===(i=null===(r=null===(n=null===(t=null===(e=window.Windows)||void 0===e?void 0:e.Security)||void 0===t?void 0:t.Authentication)||void 0===n?void 0:n.Web)||void 0===r?void 0:r.Core)||void 0===i?void 0:i.WebAuthenticationCoreManager:null}(),_=function(){var e,t,n,r;return S?null===(r=null===(n=null===(t=null===(e=window.Windows)||void 0===e?void 0:e.Storage)||void 0===t?void 0:t.ApplicationData)||void 0===n?void 0:n.current)||void 0===r?void 0:r.localSettings.values:null|!_)}();function w(e,t){return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(a.__generator)(this,(function(i){switch(i.label){case 0:return A?[4,E.getAccountProvider(t)]:[2,Promise.reject("WebCoreManager or LocalSettings not defined")];case 1:return(n=i.sent())?[4,E.getWebAccount(n)]:[2,Promise.reject("unable to get WebAccountProvider")];case 2:return(r=i.sent())&&I(t,r)?[2,E.getToken(n,r,e)]:[2,Promise.reject("unable to get WebAccount with provider: ".concat(n.id))]}}))}))}var E=function(){function e(){}return e.saveProvider=function(e){_&&(e.id&&e.authority||Object(f.a)({eventName:"HWA_Auth",errorType:"Data_Error",message:"Provider missing id or authority"}),_.insert(i.CurrentUserProviderId,e.id),_.insert(i.CurrentAuthority,e.authority))},e.saveWebAccount=function(t){if(_){e.currentUserAccount=t;var n=t.webAccountProvider;!t||n?(t?_.insert(i.CurrentAccountId,t.id):_.remove(i.CurrentAccountId),e.saveProvider(n)):Object(f.a)({eventName:"HWA_Auth",errorType:"Data_Error",message:"Account missing provider"})}},e.createWebTokenRequest=function(e,t){var n=e.authority===r.AAD,i=new Windows.Security.Authentication.Web.Core.WebTokenRequest(e,n?"openid":t||"wl.basic",n?b:"none");return n&&i.properties.insert("resource",t||"4345a7b9-9a63-4910-a426-35363201d503"),i||Object(f.a)({eventName:"HWA_Auth",errorType:"Request_Failed",message:"Failed to create WebTokenRequest"}),i},e.findAccount=function(e,t){return Object(a.__awaiter)(this,void 0,void 0,(function(){var n;return Object(a.__generator)(this,(function(r){switch(r.label){case 0:if(!C||!e||!(null==t?void 0:t.length))return[2,n];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,C.findAccountAsync(e,t)];case 2:return n=r.sent(),[3,4];case 3:return r.sent(),[3,4];case 4:return[2,n]}}))}))},e.isUsersAccountProvider=function(t,n){var r,i,o,s,l;return Object(a.__awaiter)(this,void 0,void 0,(function(){var c,u,p,d,h,f,g;return Object(a.__generator)(this,(function(m){switch(m.label){case 0:return C&&t&&(null===(r=null==n?void 0:n.profile)||void 0===r?void 0:r.oid)?[4,e.findAccount(t,n.profile.oid)]:[2];case 1:return(c=m.sent())?[2,c]:C.findAllAccountsAsync&&(null===(l=null===(s=null===(o=null===(i=Windows.Foundation)||void 0===i?void 0:i.Metadata)||void 0===o?void 0:o.ApiInformation)||void 0===s?void 0:s.isMethodPresent)||void 0===l?void 0:l.call(s,"Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager","FindAllAccountsAsync"))?[4,C.findAllAccountsAsync(t,b)]:[2];case 2:u=m.sent();try{for(p=Object(a.__values)(u.accounts),d=p.next();!d.done;d=p.next())if(I(n,h=d.value))return[2,h]}catch(e){f={error:e}}finally{try{d&&!d.done&&(g=p.return)&&g.call(p)}finally{if(f)throw f.error}}return[2]}}))}))},e.getAccountProviderForId=function(e,t){return void 0===e&&(e=o.Local),void 0===t&&(t=null),Object(a.__awaiter)(this,void 0,void 0,(function(){var n;return Object(a.__generator)(this,(function(r){switch(r.label){case 0:return C?[4,t?C.findAccountProviderAsync(e,t):C.findAccountProviderAsync(e)]:[2];case 1:return(null==(n=r.sent())?void 0:n.id)!==o.Local?[3,3]:[4,null==C?void 0:C.findAccountProviderAsync(o.MsaAad,n.authority)];case 2:n=r.sent(),r.label=3;case 3:return[2,n]}}))}))},e.getAccountProvider=function(t){var n,s;return void 0===t&&(t=null),Object(a.__awaiter)(this,void 0,void 0,(function(){var l,c,u,p,d;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:if(!C)return[2];if((null===(n=e.currentUserAccount)||void 0===n?void 0:n.webAccountProvider)&&I(t,e.currentUserAccount))return[2,null===(s=e.currentUserAccount)||void 0===s?void 0:s.webAccountProvider];l=null==_?void 0:_[i.CurrentAuthority],c=(null==_?void 0:_[i.CurrentUserProviderId])||o.Local,u=[r.AAD,r.MSA],a.label=1;case 1:return(null==l?void 0:l.length)||u.length?((null==l?void 0:l.length)&&(c=o.MsaAad),[4,e.getAccountProviderForId(c,l)]):[3,4];case 2:return(p=a.sent())&&!t?[2,p]:[4,e.isUsersAccountProvider(p,t)];case 3:return(d=a.sent())?(e.saveWebAccount(d),[2,p]):(p&&(u=u.filter((function(e){return e!=(null==p?void 0:p.authority)}))),l=u.shift(),[3,1]);case 4:return[2]}}))}))},e.getWebAccount=function(t,n){var r,o,s,l;return void 0===n&&(n=null),Object(a.__awaiter)(this,void 0,void 0,(function(){var c,u,p;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return C?(n||(n=null==_?void 0:_[i.CurrentAccountId]),(null===(r=e.currentUserAccount)||void 0===r?void 0:r.id)===n?[2,e.currentUserAccount]:t?n?[4,e.findAccount(t,n)]:[3,2]:[2]):[2];case 1:if(c=a.sent())return[2,c];a.label=2;case 2:return u=e.createWebTokenRequest(t),[4,C.getTokenSilentlyAsync(u)];case 3:return(null==(p=a.sent())?void 0:p.responseStatus)!==Windows.Security.Authentication.Web.Core.WebTokenRequestStatus.success?(Object(f.a)({eventName:"HWA_Auth",errorType:"Authentication_Failed",message:(null===(o=null==p?void 0:p.responseError)||void 0===o?void 0:o.errorMessage)||(null===(s=null==p?void 0:p.responseStatus)||void 0===s?void 0:s.toString())}),[2,c]):(c=null===(l=null==p?void 0:p.responseData)||void 0===l?void 0:l[0].webAccount,e.saveWebAccount(c),[2,c])}}))}))},e.getToken=function(t,n,r){var i;return Object(a.__awaiter)(this,void 0,void 0,(function(){var o,s,l;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return o=e.createWebTokenRequest(t,r),[4,n?null==C?void 0:C.getTokenSilentlyAsync(o,n):null==C?void 0:C.getTokenSilentlyAsync(o)];case 1:return(null==(s=a.sent())?void 0:s.responseStatus)!==Windows.Security.Authentication.Web.Core.WebTokenRequestStatus.success?(l="failed to get auth token: ".concat(null!==(i=null==s?void 0:s.responseError)&&void 0!==i?i:"null result"),console.warn(l),[2,Promise.reject(l)]):[2,s]}}))}))},e}();function I(e,t){var n,r;return e&&t&&(null===(n=t.properties)||void 0===n?void 0:n.OID)===(null===(r=e.profile)||void 0===r?void 0:r.oid)}function P(e,t){var n=1e3*parseInt(null==e?void 0:e.lookup("exp"));return n||!t?n:(new Date).getTime()+36e5}var O,T=function(e){return Object(a.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i,o,s,l,c;return Object(a.__generator)(this,(function(p){switch(p.label){case 0:return[4,Object(u.a)()];case 1:return t=p.sent(),[4,Object(m.a)()];case 2:return n=p.sent(),t&&n?(i=function(e){return new URL(Object(v.a)("ms-getoffice:authcallback?appId={0}",e))}(e),o={profile:{upn:null!==(l=n.userPrincipalName)&&void 0!==l?l:"",tid:n.tenantId,oid:n.objectId,loginHint:null!==(c=null==n?void 0:n.loginHint)&&void 0!==c?c:""}},s=A?function(e){return function(t,n,i){return Object(a.__awaiter)(void 0,void 0,void 0,(function(){var t,n,o,s,l,c;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),A?i?[4,w(i,e)]:(Object(f.a)({eventName:"Access_Token_Response",errorType:"GetOfficeToken_Error",message:"Resource not provided"}),[2,Promise.reject("Resource not provided")]):(Object(f.a)({eventName:"Access_Token_Response",errorType:"GetOfficeToken_Error",message:"Windows auth not available"}),[2,Promise.reject("Windows auth not available")]);case 1:return t=a.sent(),n=null===(c=null==t?void 0:t.responseData)||void 0===c?void 0:c[0],s=(null==(o=null==n?void 0:n.webAccount)?void 0:o.webAccountProvider.authority)===r.AAD,(null==n?void 0:n.token)&&(null==t?void 0:t.responseStatus)===Windows.Security.Authentication.Web.Core.WebTokenRequestStatus.success?[2,{success:!0,token:n.token,format:s?"JWT":"RPSCompact",source:"WAM",expiryMs:P(null==n?void 0:n.properties,s),error:null==t?void 0:t.responseError,clientId:b}]:(Object(f.a)({eventName:"Access_Token_Response",errorType:"GetOfficeToken_Error",message:"unable to acquire token from WebTokenRequestResult",debugInfo:" wamAccessTokenResponseFunction"}),[2,Promise.reject("unable to acquire token from WebTokenRequestResult")]);case 2:return l=a.sent(),Object(f.a)({eventName:"Access_Token_Response",errorType:"GetOfficeToken_Error",message:"wamAccessTokenResponseFunction failed: ".concat(l),debugInfo:"format: JWT, source: WAM"}),[2,{success:!1,format:"JWT",source:"WAM",token:"",error:l}];case 3:return[2]}}))}))}}(o):t.getAccessToken,[2,new y(s,o,i)]):[2,void 0]}}))}))},k=function(){function e(e,t){this._appHostSessionId=e,this._frameContext=t}return e.prototype.createScenario=function(e,t,n){return new x(e,t,this._appHostSessionId,this._frameContext,n)},e}(),x=function(){return function(e,t,n,r,i){var o=this;this.scenarioName=e,this.appId=t,this.appHostSessionId=n,this.frameContext=r,this.clientTimestamp=i,this.markg())},thisme))},this.fail=function(e){return o.logTelemetryEvent("fail ".concat(o.scenarioName),e)},this.logTelemetryEvent=function(e,t){var n=(new Date).getTime();!function(e){e.error&&Object(f.a)({eventName:"MOS_Hub_SDK_Error",errorType:"MOS_Hub_SDK_Request_Error",message:e.error,area:"MOSAppHost",subArea:e.scenarioName,debugInfo:"Error for appID: ".concat(e.appId,", ClientTimeStamp: ").concat(e.clientTimestamp)}),function(e){var t,n,r;Object(h.a)({featureName:"MOSHub",eventName:"MOS_Hub_SDK_Request",params:{AppHostSessionId:e.appHostSessionId,AppId:e.appId,Error:null!==(t=e.error)&&void 0!==t?t:"",ClientTimeStamp:null!==(n=e.clientTimestamp)&&void 0!==n?n:0,FrameContext:e.frameContext,MessageDelayMs:null!==(r=e.messageDelayMs)&&void 0!==r?r:0,MOSHubScenarioName:e.scenarioName},area:"MOSAppHost",subArea:e.scenarioName})}(e)}({appHostSessionId:o.appHostSessionId,appId:o.appId,clientTimestamp:o.clientTimestamp,error:t,frameContext:o.frameContext,messageDelayMs:o.clientTimestamp?n-o.clientTimestamp:0,scenarioName:e})},this.logTelemetryEvent(e)}}(),j=n("ofrw"),D=function(){function e(e,t,n){this.storageService=new j.a(e,t),this.askForConsentCallback=n}return e.prototype.requestUserConsentForPermission=function(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t;return Object(a.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.storageService.getPermissionStatus(e)];case 1:return(t=n.sent())!==s.b.NeverAsked?[3,3]:[4,this.askForConsentCallback(e)];case 2:t=n.sent(),n.label=3;case 3:return[2,Promise.resolve({permission:e,status:t})]}}))}))},e}(),R=n("Zt7Y"),H=n("8eSj"),N=n("iFjN"),V=n("mXGw"),L=n.n(V),M=function(){return function(e,t,n,r,i){var o=this;this.getLoadingUi=function(){return o.scenario.stop(),L.a.createElement(H.a,{label:o.locStrings.loadingLabel})},this.getErrorUi=function(e){return o.scenario.fail("App failure reason: ".concat(e)),L.a.createElement(N.a,{correlationId:o.correlationId,refreshCallBack:o.refreshCallBack,errorStrings:{errorUiHeaderText:o.locStrings.errorUiTitle,errorUiSecondaryText:o.locStrings.errorUiLabel,correlationIdLabel:o.locStrings.correlationId,retryButtonText:o.locStrings.retryButtonTitle}})},this.correlationId=e,this.refreshCallBack=t,this.locStrings=n,this.telemetry=r,this.appId=i,this.scenario=this.telemetry.createScenario("appInitialization",this.appId)}}(),F=n("hSma"),B=n("VCg/"),z=n("kKFt"),U=function(e){return Object(a.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r;return Object(a.__generator)(this,(function(i){switch(i.label){case 0:return Object(h.a)({featureName:"MOSHub",eventName:"AppInstallDialog",params:{AppId:e,AppCapabilities:"OpenAppInstallDialog",DebugInfo:"Open app install dialog",Service:"AppInstallDialogService"},area:"MOSAppHost",subArea:"InstallDialog"}),[4,Object(u.a)()];case 1:return t=i.sent(),n=Object(z.a)(t,e),[4,Object(d.a)()];case 2:return r=i.sent(),[2,Object(B.a)(e,r.metaOSHubResources.dialogInstallAppTitle,n,"INSTALL")]}}))}))},W=n("4l53"),q=function(e){var t=e.appId;return Object(a.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(a.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(W.a)(t)];case 1:return"NeedsConsentForUpgrade"===(null==(e=n.sent())?void 0:e.acquisitionState)?[2,"UPGRADE"]:[2,"INSTALL"]}}))}))},G=function(){function e(){}return e.prototype.openAppInstallDialog=function(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(t){switch(t.label){case 0:return e.appId?[4,q({appId:e.appId})]:[3,2];case 1:return"UPGRADE"===t.sent()?(null==F.a||Object(F.a)("params.appId"),[2,Promise.resolve()]):(null==U||U(e.appId),[2,Promise.resolve()]);case 2:return g("Open_App_Install_Dialog_Error"),[2,Promise.reject()]}}))}))},e}(),J=n("gd1C"),X=n("NkqM"),Z=function(){function e(e){this.domain=e}return e.prototype.openLink=function(e){return Object(h.a)({featureName:"MOSHub",eventName:"ExecuteDeepLink",params:{AppCapabilities:"OpenLink",DebugInfo:"ExecuteDeepLink/OpenLink service",Service:"AppHostLinkService"},area:"MOSAppHost",subArea:"AppHostLinkService"}),function(e,t){try{var n=Object(X.a)(e),r=new URL(n).origin===t?"_self":"_blank";return Object(J.a)(n,{action:"OpenInBrowser",linkTarget:r}),!0}catch(e){return g("Invalid_Open_Link_Url"),!1}}(e,this.domain)?Promise.resolve():Promise.reject()},e}();!function(e){e[e.PERMISSION_DENIED=1]="PERMISSION_DENIED",e[e.POSITION_UNAVAILABLE=2]="POSITION_UNAVAILABLE",e[e.TIMEOUT=3]="TIMEOUT"}(O||(O={}));var K=function(){function e(){}return e.prototype.getCurrentLocation=function(){return new Promise((function(e,t){window.navigator.geolocation?window.navigator.geolocation.getCurrentPosition((function(t){return e({accuracy:t.coords.accuracy,latitude:t.coords.latitude,longitude:t.coords.longitude,timestamp:t.timestampde])})):t(O.POSITION_UNAVAILABLE)}))},e.prototype.withLocationMapSethis},e}(),Y=function(){function e(e,t,n,r,i,o){var a,s,l=this;this.navigateForwardCallback=e,this.navigateToAppCallback=t,this.setShareLinkCallback=n,this.setFrameInfoCallback=r,this.addEventListenerCallback=i,this.returnFocus=function(e){var t;return e?Promise.resolve(l.navigateForwardCallback()):(Object(h.a)({featureName:"MOSHub",eventName:"ReturnFocus",params:{AppCapabilities:"FocusOnAppBar",DebugInfo:"focus set to app tile in App Bar",Service:"ReturnFocusPageService"},area:"MOSAppHost",subArea:"AppHostPageService"}),Promise.resolve(null===(t=l.appbarConnectorService)||void 0===t?void 0:t.focusOnAppbar()))},this.setCurrentFrame=function(e){return Promise.resolve(l.setFrameInfoCallback(e))},this.navigate(e))},this.shareDeeve()},this.clearListeners=function(){},this.appLinkDomains=null!==(a=null==o?void 0:o.appLinkDomains)&&void 0!==a?a:[],this.appbarConnectorService=null==o?void 0:o.appbarConnectorService,this.appButtonService=null===(s=this.appbarConnectorService)||void 0===s?void 0:s.getAppButtonService(),this.tabsService=null==o?void 0:o.tabsService,this.configService=null==o?void 0:o.configService,this.backStackService=null==o?void 0:o.backStackService,this.fullTrustService=null==o?void 0:o.fullTrustService}return e.prototype.addEventLise,t)},e}();function $(e){var t=e.addEventListenerCallback,n=e.appbarConnectorService,r=e.appId,i=e.appLinkDomains,o=e.appLinkRootPath,a=e.authenticationService,s=e.capabilitiesFeatureGates,l=e.dialogHandlers,c=e.navigateForwardCallback,u=e.navigateToAppCallback,p=e.officeComponentContext,d=e.setFrameInfoCallback,h=e.setShareLinkCallback,f=e.showConsentDialogCallback,g=e.telemetryService,m=e.userId,v=new M(p.correlationId,e.retryCallback,e.locStrings,g,r),y=new Y(c,u,h,d,t,{appLinkDomains:i,appLinkRootPath:o,appbarConnectorService:n}),b=new Z(p.officeHomeApiRoot),S=new G,C="apps"===r||!m,_=C?void 0:new D(r,m,f),A=C?void 0:new K,w=s.dialogServiceEnabled?new R.a(l):void 0,E={appInstallDialogService:S,authenticationService:a,devicePermissionService:_,hubUiService:v,linkService:b,locationService:A,pageService:y,telemetryService:g,logger,r){}}};return E.dialogService=w,E}var Q=function(e){var t=e.appId,n=e.appHostSessionId,r=e.frameContext,i=e.appbarConnectorService,o=e.dialogHandlers,f=e.retryCallback,m=e.setFrameInfoCallback,v=e.setShareLinkCallback,y=e.showConsentDialogCallback,b=e.userId;return Object(a.__awaiter)(void 0,void 0,void 0,(function(){var e,S,C,_,A;return Object(a.__generator)(this,(function(w){switch(w.label){case 0:return[4,Promise.all([T(t),Object(u.a)(),Object(d.a)()])];case 1:return e=a.__read.apply(void 0,[w.sent(),3]),S=e[0],_=e[2],(C=e[1])&&S&&_?(A=function(){},[2,$({appId:t,appLinkDomains:l,appLinkRootPath:"m365apps",appbarConnectorService:null!=i?i:new c.a,authenticationService:S,capabilitiesFeatureGates:{deepLinkServiceEnabled:!0,dialogServiceEnabled:!0},dialogHandlers:o,locStrings:_.metaOSHubResources,navigateForwardCallback:function(){var e,n;Object(h.a)({featureName:"MOSHub",eventName:"ReturnFocus",params:{AppId:t,AppCapabilities:"NavigateForward",DebugInfo:"focus set to search box",Service:"NavigateForwardPageService"},area:"MOSAppHost",subArea:"AppHostPageService"}),null===(n=null===(e=window.O365Shell)||void 0===e?void 0:e.Search)||void 0===n||n.FocusSearchBox()},navigateToAppCallback:function(e){var t={appId:e.appId,entityId:e.pageId,subPageId:e.subPageId?e.subPageId:""};Object(h.a)({featureName:"MOSHub",eventName:"NavigateToApp",params:{AppId:e.appId,AppCapabilities:"NavigateToApp",DebugInfo:"NavigateToApp",Service:"NavigateToAppPageService"},area:"MOSAppHost",subArea:"AppHostPageService"}),Object(p.a)(t,"MOSAppHost").then((function(e){e.success||g("Navigate_App_Service_Error",e.message)}))},officeComponentContext:C,retryCallback:null!=f?f:A,setFrameInfoCallback:null!=m?m:A,setShareLinkCallback:null!=v?v:A,telemetryService:new k(n,r),showConsentDialogCallback:null!=y?y:function(e){return console.log("NoOp consent callback"),Promise.resolve(s.b.NeverAsked)},userId:b})]):[2,void 0]}}))}))}}em=o},oYCi:function(e,t,n){"use strict";e.exports=n("FIKz")},oZqk:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogLevel=t.RefreshMode=t.TypeErrorType=t.ContainerFitStatus=t.ValidationEvent=t.ValidationPhase=t.InputTextStyle=t.ActionIconPlacement=t.FillMode=t.Orientation=t.ShowCardActionMode=t.ImageStyle=t.ActionAlignment=t.VerticalAlignment=t.HorizontalAlignment=t.TextColor=t.Spacing=t.FontType=t.TextWeight=t.TextSize=t.SizeUnit=t.ImageSize=t.Size=t.ActionMode=t.ActionStyle=t.ContainerStyle=void 0;g",e}();t.ContainerStyle=r;e",e}();t.ActionStyle=i;y",e}();t.ActionMode=o,function(e){e[e.Auto=0]="Auto",e[e.Stretch=1]="Stretch",e[e.Small=2]="Small",e[e.Medium=3]="Medium",e[e.Large=4]="Large"}(t.Size||(t.Size={})),function(e){e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Large=2]="Large"}(t.ImageSize||(t.ImageSize={})),function(e){e[e.Weight=0]="Weight",e[e.Pixel=1]="Pixel"}(t.SizeUnit||(t.SizeUnit={})),function(e){e[e.Small=0]="Small",e[e.Default=1]="Default",e[e.Medium=2]="Medium",e[e.Large=3]="Large",e[e.ExtraLarge=4]="ExtraLarge"}(t.TextSize||(t.TextSize={})),function(e){e[e.Lighter=0]="Lighter",e[e.Default=1]="Default",e[e.Bolder=2]="Bolder"}(t.TextWeight||(t.TextWeight={})),function(e){e[e.Default=0]="Default",e[e.Monospace=1]="Monospace"}(t.FontType||(t.FontType={})),function(e){e[e.None=0]="None",e[e.Small=1]="Small",e[e.Default=2]="Default",e[e.Medium=3]="Medium",e[e.Large=4]="Large",e[e.ExtraLarge=5]="ExtraLarge",e[e.Padding=6]="Padding"}(t.Spacing||(t.Spacingion"}(t.TextColor||(t.TextColor={})),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right"}(t.HorizontalAlignment||(t.HorizontalAlignment={})),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Bottom=2]="Bottom"}(t.VerticalAlignment||(t.VerticalAlignment={})),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right",e[e.Stretch=3]="Stretch"}(t.ActionAlignment||(t.ActionAlignment={})),function(e){e[e.Default=0]="Default",e[e.Person=1]="Person"}(t.ImageStyle||(t.ImageStyle={})),function(e){e[e.Inline=0]="Inline",e[e.Popup=1]="Popup"}(t.ShowCardActionMode||(t.ShowCardActionMode={})),function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(t.Orientation||(t.Orientation={})),function(e){e[e.Cover=0]="Cover",e[e.RepeatHorizontally=1]="RepeatHorizontally",e[e.RepeatVertically=2]="RepeatVertically",e[e.Repeat=3]="Repeat"}(t.FillMode||(t.FillMode={})),function(e){e[e.LeftOfTitle=0]="LeftOfTitle",e[e.AboveTitle=1]="AboveTitle"}(t.ActionIconPlacement||(t.ActionIconPlacement={})),function(e){e[e.Text=0]="Text",e[e.Tel=1]="Tel",e[e.Url=2]="Url",e[e.Email=3]="Email",e[e.Password=4]="Password"}(t.InputTextStyle||(t.InputTextStyle={})),function(e){e[e.Parse=0]="Parse",e[e.ToJSON=1]="ToJSON",e[e.Validation=2]="Validation"}(t.ValidationPhase||(t.ValidationPhaseher"}(t.ValidationEvent||(t.ValidationEvent={})),function(e){e[e.FullyInContainer=0]="FullyInContainer",e[e.Overflowing=1]="Overflowing",e[e.FullyOutOfContainer=2]="FullyOutOfContainer"}(t.ContainerFitStatus||(t.ContainerFitStatusype"}(t.TypeErrorType||(t.TypeErrorType={})),function(e){e[e.Disabled=0]="Disabled",e[e.Manual=1]="Manual",e[e.Automatic=2]="Automatic"}(t.RefreshMode||(t.RefreshMode={})),function(e){e[e.Info=0]="Info",e[e.Warning=1]="Warning",e[e.Error=2]="Error"}(t.LogLevel||(t.LogLevel={}))},ofrw:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r,i=n("QjXU"),o=n("5hZV"),a=n("due6");!function(e){varKED"}(t=e.ErrorCode||(e.ErrorCode={})),function(e){e.APPID_AND_USERID_INDEX="appID_and_userID",e.APPID_INDEX="appID",e.USERID_INDEX="userID"}(n=e.indexID||(e.indexID={}));var r="apps",s="appsPermissionsDB";function l(e,i){return new Promise((function(o,a){var l=indexedDB.open(s,1);l.onbl."})},l.onupgradeneeded=function(){var e=l.result;if(!e.objectStoreNames.contains(r)){var t=e.createObjectStore(r,{keyPath:["appID","userID"],autoIncrement:!1});t.createIndex(n.APPID_AND_USERID_INDEX,["appID","userID"],{unique:!0}),t.createIndex(n.APPID_INDEX,"appID",{unique:!1}),t.createIndex(n.USERID_INDEX,"userID",{unique:!1})}},l.onerror=function(e){a({errorCode:t.INDEXEDDB_INTERNAL_ERROR,message:e.type})},l.onsuccess=function(){var s=l.result,c=s.transaction(r,"readwrite").objectStore(r),u=c.index(n.APPID_AND_USERID_INDEX).get([e,i]);u.onsuccess=function(){o([c,u.result])},u.onerror=function(e){a({errorCode:t.INDEXEDDB_INTERNAL_ERROR,message:e.type})},s.close()}}))}function c(e,n){var r=this;return new Promise((function(o,s){return Object(i.__awaiter)(r,void 0,void 0,(function(){var r;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return Object(a.a)(e)||s({errorCode:t.INDEXEDDB_INTERNAL_ERROR,message:"AppID is not valid. Must be GUID format"}),n||s({errorCode:t.INDEXEDDB_INTERNAL_ERROR,message:"UserID should not be null/empty."}),[4,l(e,n)];case 1:r=i.sent();try{o(void 0!==r[1])}catch(e){s({errorCode:t.INDEXEDDB_INTERNAL_ERROR,message:e.type})}return[2]}}))}))}))}function u(e,n){var r=this;return new Promise((function(s,c){return Object(i.__awaiter)(r,void 0,void 0,(function(){var r,u,p,d;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return Object(a.a)(e)||c({errorCode:t.INDEXEDDB_INTERNAL_ERROR,message:"AppID is not valid. Must be GUID format"}),n||c({errorCode:t.INDEXEDDB_INTERNAL_ERROR,message:"UserID should not be null/empty."}),[4,l(e,n)];case 1:r=i.sent(),u=r[0],p=r[1],d={appID:e,userID:n,permissions:{geolocation:o.b.NeverAsked,media:o.b.NeverAsked,midi:o.b.NeverAsked,notifications:o.b.NeverAsked,openExternal:o.b.NeverAsked}};try{void 0===p&&(u.put(d).onsuccess=function(){s()})}catch(e){c({errorCode:t.INDEXEDDB_INTERNAL_ERROR,message:e.type})}return[2]}}))}))}))}e.doesRecordExist=c,e.createRecord=u,e.updatePermission=function(e,n,r,o){var s=this;return new Promise((function(p,d){return Object(i.__awaiter)(s,void 0,void 0,(function(){var s,h,f,g,m;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),Object(a.a)(e)||d({errorCode:t.INDEXEDDB_INTERNAL_ERROR,message:"AppID is not valid. Must be GUID format"}),n||d({errorCode:t.INDEXEDDB_INTERNAL_ERROR,message:"UserID should not be null/empty."}),[4,c(e,n)];case 1:return i.sent()||u(e,n),[4,l(e,n)];case 2:return s=i.sent(),h=s[0],void 0!==(f=s[1]).permissions[r]&&(f.permissions[r]=o,(g=h.put(f)).onsuult)},g.onerror=function(e){d({errorCode:t.INDEXEDDB_INTERNAL_ERROR,message:e.type})}),[3,4];case 3:return m=i.sent(),d({errorCode:t.INDEXEDDB_INTERNAL_ERROR,message:m.type}),[3,4];case 4:return[2]}}))}))}))},e.deleteSingleRecord=function(e,r){var o=this;return new Promise((function(s,c){return Object(i.__awaiter)(o,void 0,void 0,(function(){var o,u,p;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),Object(a.a)(e)||c({errorCode:t.INDEXEDDB_INTERNAL_ERROR,message:"AppID is not valid. Must be GUID format"}),r||c({errorCode:t.INDEXEDDB_INTERNAL_ERROR,message:"UserID should not be null/empty."}),[4,l(e,r)];case 1:return o=i.sent(),(u=o[0].index(n.APPID_AND_USERID_INDEX).openKeyCursor(IDBKeyRange.only([e,r]))).onsuccess=function(){var e=u.result;e?(o[0].delete(e.primaryKey),s()):c({errorCode:t.RECORD_DOESNT_EXIST,message:"Record doesn't exists."})},u.onpe})},[3,3];case 2:return p=i.sent(),c({errorCode:t.INDEXEDDB_INTERNAL_ERROR,message:p.type}),[3,3];case 3:return[2]}}))}))}))},e.searchRecord=function(e,r,o){var s=this;return new Promise((function(c,u){return Object(i.__awaiter)(s,void 0,void 0,(function(){var s,p,d,h;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(!Object.values(n).includes(o))return[3,5];i.label=1;case 1:return i.trys.push([1,3,,4]),Object(a.a)(e)||u(p={errorCode:t.INDEXEDDB_INTERNAL_ERROR,message:"AppID is not valid. Must be GUID format"}),r||u(p={errorCode:t.INDEXEDDB_INTERNAL_ERROR,message:"UserID should not be null/empty."}),[4,l(e,r)];case 2:return d=i.sent(),(s=o===n.APPID_AND_USERID_INDEX?d[0].index(n.APPID_AND_USERID_INDEX).getAll([e,r]):o===n.APPID_INDEX?d[0].index(n.APPID_INDEX).getAll(e):d[0].index(n.USERID_INDEX).getAll(r)).onsuccess=function(){var e=s.result;e?c(e):u(p={errorCode:t.RECORD_DOESNT_EXIST,message:"Record doesn't exists."})},s.onerror=function(e){u(p={errorCode:t.INDEXEDDB_INTERNAL_ERROR,message:e.type})},[3,4];case 3:return h=i.sent(),u(p={errorCode:t.INDEXEDDB_INTERNAL_ERROR,message:h.type}),[3,4];case 4:return[3,6];case 5:p={errorCode:t.INVALID_SEARCH_PARAMETERS,message:"searchByIndex parameter should be one of these ".concat([n.APPID_AND_USERID_INDEX,n.APPID_INDEX,n.USERID_INDEX])},u(p),i.label=6;case 6:return[2]}}))}))}))},e.deleteObjectStore=function(){return new Promise((function(e,t){var n=indexedDB.deleteDatabase(s);n.onsuccess=function(){e()},n.onerror=function(e){t(e)}}))}}(r||(r={}));var s=function(){return function(e,t){var n=this;this.appID=e,this.userID=t,this.getPermissions=function(){return Object(i.__awaiter)(n,void 0,void 0,(function(){var e;return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,r.doesRecordExist(this.appID,this.userID)];case 1:return t.sent()?[3,3]:[4,r.createRecord(this.appID,this.userID)];case 2:t.sent(),t.label=3;case 3:return[4,r.searchRecord(this.appID,this.userID,r.indexID.APPID_AND_USERID_INDEX)];case 4:return e=t.sent(),[2,Object.entries(e[0].permissions)[1]}}))]}}))}))},this.getPermissionStatus=function(e){return Object(i.__awaiter)(n,void 0,void 0,(function(){var t,n;return Object(i.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.getPermissions()];case 1:return t=r.sent(),void 0!==(n=t.find((function(t){return t.permission===e})))?[2,n.status]:[2,o.b.NeverAsked]}}))}))},this.storePermissionConsent=function(e){return Object(i.__awaiter)(n,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,r.updatePermission(this.appID,this.userID,e.permission,e.status)];case 1:return t.sent(),[2]}}))}))}}}()},oxya:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UUID=t.SizeAndUnit=t.PaddingDefinition=t.SpacingDefinition=t.StringWithSubstitutions=t.ContentTypes=t.GlobalSettings=void 0;var r=n("oZq}},e}();t.GlobalSettings=i,t.ContentTypes={applicationJson:"application/json",applicationXWwwFormUrlencoded:"application/x-www-form-urlencoded"};1},e}();t.StringWithSubstitutions=o;var a=function(){rft=r}}();t.SpacingDefinition=a;var s=function(){rft=i}}();t.PaddingDefinition=s;var l=functit=t}return e.parse=function(t,n){void 0===n&&(n=!1);var i=new e(0,r.SizeUnit.Weight);if("number"==typeof t)return i.physicalSize=t,i;if("string"==typeof t){var o=/^([0-9]+)(px|\*)?$/g.exec(t);if(o&&o.length>=(n?3:2))return i.physicalSize=parseInt(o[1]),3===o.length&&"px"===o[2]&&(i.unit=r.SizeUnit.Pixel),i}throw new Error("Invalid size: "+t)},e}();t.SizeAndUnit=l;[],e}();t.UUID=c,c.initialize()},q3UB:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("mXGw"),i=n("elnK"),o=n.n(i)()((function(e){return{windowSize:{width:0,height:0},setWindo:t})}}})),a=function(){var e=o();return Object(r.useEffect)((function(){ht})};return window.addEventListener("resize",t",t)}}),[]),Object(r.useMemo)((function(){return e.windowSize}),[e.windowSize])}}),t)},sc41:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r,i=n("dlqR"),o=n("szkd"),a=n("NZpx"),s=n("NrNW"),l=n("CaQ9"),c=n("io1X"),u=n("FPnS"),p=n("Coo+"),d=n("mXGw"),h=function(){return window.chrome&&window.chrome.webview?i.b.desktop:i.b.web}();function f(e){var t,n;void 0===e&&(e=null);tion}(),i=function(t){return e?{locale:e,type:t}:t};return{platform:null===(t=navigator.userAgentData)||void 0===t?void 0:t.platform,regionalFormat:null!==(n=null==r?void 0:r.getLocaleInfo(i("name")))&&void 0!==n?n:navigator.language,shortDate:null==r?void 0:r.getLocaleInfo(i("shortdate")),longDate:null==r?void 0:r.getLocaleInfo(i("longdate")),shortTime:null==r?void 0:r.getLocaleInfo(i("shorttime")),longTime:null==r?void 0:r.getLocaleInfo(i("longtime"))}}var g=((r={})[u.a.dark]=i.d.dark,r[u.a.default]=i.d.default,r[u.a.highContrast]=i.d.highContrast,r);function m(e){var t,n,r=Object(s.a)().data,m=Object(l.a)().data,v=Object(a.a)().data,y=g[Object(c.a)()||u.a.default],b=e.additionalParams,S=Object(p.a)().data,C=null===(t=null==S?void 0:S.result)||void 0===t?void 0:t.SharePointResourceId,_=null===(n=null==S?void 0:S.result)||void 0===n?void 0:n.OneDriveResourceId,A=function(){var e,t=Object(p.a)().data,n=null===(e=null==t?void 0:t.result)||void 0===e?void 0:e.OneDriveUrl;return Object(d.useMemo)((function(){try{return new URL(n||"").pathname}catch(e){return}}),[n])}();return Object(d.useMemo)((function(){if(r&&m&&e.appId)return{app:{host:{clientType:h,name:i.c.office,ringId:e.ringId,sessionId:r.sessionId,version:r.buildVersion},iconPositionVertical:e.iconPositionVertical,locale:r.preferredCulture,osLocaleInfo:f(r.preferredCulture),sessionId:e.appHostSessionId,theme:y,userClickTime:e.userClickTime},page:{frameContext:e.frameContext,id:e.entityId,isFullScreen:e.isFullScreen,isMultiWindow:!1,subPageId:"apps"===e.appId&&(null==v?void 0:v.sharedServicesEnabled)?JSON.stringify({supportedElementInfo:{staticTabs:[{scopes:["personal"]}]}}):e.subPageId,sourceOrigin:r.officeHomeApiRoot},user:{tenant:{id:m.tenantId,sku:void 0},licenseType:void 0,dataResidency:"EU"===r.dataBoundary?o.c.EUDB:o.c.Public},sharePointSite:C&&_?{teamSiteDomain:C.replace(/^https?:\/\//,""),teamSitePath:"",mySiteDomain:_.replace(/^https?:\/\//,""),mySitePath:A}:void 0,actionInfo:b&&b.actionId?{actionId:b.actionId,actionObjects:[{type:o.a.M365Content,itemId:b.itemId,secondaryId:{name:o.g.DriveId,value:b[o.g.DriveId]}}]}:void 0}}),[b,null==v?void 0:v.sharedServicesEnabled,_,r,m,e.appHostSessionId,e.appId,e.entityId,e.frameContext,e.iconPositionVertical,e.isFullScreen,e.ringId,e.subPageId,e.userClickTime,C,y])}},szkd:function(e,t,n){"use strict";var r,i,o,a,s,l,c,u,p,d;n.d(t,"b",(function(){return r})),n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return l})),n.d(t,"a",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){returnhed"}(r||(rDED"}(i||(iaff"}(o||(o={})),function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared"}(a||(a={})),function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"}(s||(s={})),function(e){e.Inline="inline",e.Desktop="desktop",e.Web="web"}(l||(lent"}(c||(c={})),function(e){e.DriveId="driveId",e.GroupId="groupId",e.SiteId="siteId",e.UserId="userId"}(u||(udoj"}(p||(p={})),function(e){e.Public="public",e.EUDB="eudb",e.Other="other"}(d||(d={}))},uv1U:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalRegistry=t.CardObjectRegistry=t.ElementSingletonBehavior=void 0;var r,i=n("Ipwed"}(r=t.ElementSingletonBehavior||(t.ElementSingletonBehavior={}));var o=functs={}}return e.prototype.findBid 0},e.prototype.s={}},e.prototype.copyTo=function(e){for(var t=0,n=Object.keys(this._items);t<n.length;t++){var r=this._items[n[t]];e.register(r.typeName,r.objectType,r.schemaVersion,r.singletonBehavior)}},e.prototype.rege]=a},e.prototype.unregs[e]},e.prototype.createInsid 0},e.prototype.getItemngth},e.prototype.getI)[e]},e}();t.CardObjectRegistry=o; o,e}();t.GlobalRegistry=a},vh9v:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Strings=void 0;}},e}();t.Strings=r},weFd:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("lUkog"}},o=function(e,t,n,o,a){Object(r.a)({type:e,id:t,area:"MOSTaskModuleDialog",result:n,target:"MOSTaskModuleDialog",eventName:"MOS_Task_Module_Dialog",subArea:i(o),targetId:a})}}),t)}2m")}{}))}}]);
//# sourceMappingURL=vendors~task-dialog-rc.9306f3ffa5e238991e3e.chunk.v7.js.map