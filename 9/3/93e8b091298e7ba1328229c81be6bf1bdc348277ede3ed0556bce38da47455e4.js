function Logger(){this.enabled=!1;this.setEnabled=function(a){this.enabled=a};this.log=function(a){this._log("log",arguments)};this.debug=this.error=this._log=function(a,b,c){if(this.enabled||c){b=this._addPrefixToArguments(b);try{this._writeToConsole(a,b)}catch(e){}}};this._writeToConsole=function(a,b){var c="log";void 0!==console[a]&&(c=a);console[c].apply(console,b)};this._addPrefixToArguments=function(a){a=
this._convertArgumentsToArray(a);a.unshift("postToServer (origin: "+location.origin+"):");return a};this._convertArgumentsToArray=;var PersistentStorage=function(){function a(){var a=b()?e().getItem("PSConfiguration"):!1;logger.debug("Persistent storage configuration: "+a);if(!a||"localStorage"!==a&&"cookie"!==a){var a=!1,d=window.location.href;try{window.localStorage&&-1!=d.indexOf("clientHosted=true")&&(localStorage.setItem("inqPc",2),a=!0,logger.debug("Testing localStorage, inqPc=2 has been set"))}catch(f){logger.log("WARNING window.localStorage is not supported and chat may not be offered. "+f.message)}logger.debug("isClientHostedLS: "+
a+".");if(a)k="localStorage";else if(b())k="cookie";else{a=!1;if(/firefox/i.test(window.navigator.userAgent))try{window.localStorage&&(localStorage.setItem("inqPc",2),a=!0,logger.debug("Testing localStorage, inqPc=2 has been set"))}catch(f){logger.log("WARNING window.localStorage is not supported and chat may not be offered. "+f.message)}logger.debug("isLSSupported: "+a);a?k="localStorage":(null==n&&(n=b()||""===document.cookie?!1:!0),logger.debug("isCookieReadOnlyEnabled: "+n),n&&(k="cookie"))}}else k=
a;return"cookie"===k?e():"localStorage"===k?c():null}function b(){if("undefined"==typeof l){var a=(new Date((new Date).getTime()+316224E5)).toUTCString(),b="inqPc="+(Math.floor(9E6*Math.random())+1E6).toString(16),c=-1!==window.location.href.indexOf(m)?"domain="+m+";":"";logger.debug("Writing cookie inqPc to check if cookies are supported");document.cookie=b+"; SameSite=None; Secure; path=/; expires="+a+";"+c;l=-1!==document.cookie.indexOf(b);document.cookie="inqPc=; SameSite=None; Secure; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT; "+
c;logger.debug("Deleting cookie inqPc. cookiesEnabled: "+l)}return l}function c(a){var b=localStorage;a=a||"localStorage";"sessionStorage"==a&&(b=sessionStorage);var c={setValue:function(c,d,e){function f(c,d){b.setItem(c,d);var e=b.getItem(c);d.toString()!==e&&logger.debug(a+": Expected "+c+" to equal "+d+", but instead received: "+e)}logger.debug(a+": setValue("+c+", "+decodeURIComponent(d)+", "+e+")");f("LSCACHE-"+c,e);f(c,d)}};return{getAllCookies:function(c){var d="",e,f;try{for(var g in b)b.hasOwnProperty(g)&&
0!==g.indexOf("LSCACHE-")&&(e=this.getItem(g),0===g.indexOf("inqCA")&&(f=sessionStorage.getItem("sinqCA"),logger.debug("sessionStorage: getAllCookies() sessionCA: "+f),!isNaN(f)&&0<f&&(e=0)),d+=""+g+"="+e+";")}catch(p){logger.log("ERROR: Storage is not available. Can't get all data.")}logger.debug(a+": getAllCookies() returns: "+decodeURIComponent(d));c&&c(d);return d},get:function(c){var d={};try{for(var e in b)b.hasOwnProperty(e)&&0!==e.indexOf("LSCACHE-")&&(d[e]=b.getItem(e))}catch(f){logger.log("ERROR: Storage is not available. Can't get item for Safari.")}logger.debug(a+
": get() returns: "+JSON.stringify(d));c&&c(d);return d},getItem:function(c,d){var e=new Date;try{var f=b.getItem("LSCACHE-"+c);if(null!==f&&"session"!==f&&(f=parseInt(f,10),!isNaN(f)&&f<e.getTime()))return logger.debug(a+": expired and call removeItem("+c+")"),this.removeItem("LSCACHE-"+c),this.removeItem(c),d&&d(null),null;var g=b.getItem(c);logger.debug(a+": getItem("+c+") returns: "+decodeURIComponent(g));d&&d(g);return g}catch(p){logger.log("ERROR: Storage is not available. Can't get item.")}},
setItem:function(a,b,d,e){if("string"!==typeof a)throw new TypeError("key must be of type 'string'");if("undefined"!==typeof d&&""!==d){var f=new Date,g=parseInt(d,10);isNaN(g)?(d=Date.parse(d),isNaN(d)?logger.log("ERROR: PersistentStorage.cookieInstance: lifetime has to be a number or a date string"):d>f.getTime()?c.setValue(a,b,d):this.removeItem(a)):0<g?c.setValue(a,b,f.getTime()+g):this.removeItem(a)}else c.setValue(a,b,"session");e&&e()},removeItem:function(c,d){try{var e=function(c){b.removeItem(c);
var d=b.getItem(c);null!==d&&logger.log(a+": removeItem(): Expected "+c+" to equal null, but instead received: "+d)};logger.debug(a+": removeItem("+c+")");e("LSCACHE-"+c);e(c);d&&d()}catch(f){logger.log("ERROR: Storage is not available. Can't remove item.")}},clear:function(a){try{logger.debug("LOCALSTORAGE: clear()"),b.clear(),a&&a()}catch(c){logger.log("ERROR: Storage is not available. Can't clear.")}},cleanNuanceCookies:onUnload:function(c){var d=(new Date).getTime()+6E5;logger.debug(a+
": setSessionStorageTimeout(): SESSION_TIMEOUT="+d+"");for(var e in localStorage)0===e.indexOf("LSCACHE-")&&"session"===localStorage.getItem(e)&&b.setItem(e,d);c&&c()},version:"localStorage.0.0.3"}}function e(){return{getAllCookies:function(a){var b=document.cookie;logger.debug("getAllCookies(): "+b);a&&a(b);return b},get:function(a){var b=this.getAllCookies(),c=null;if(""!==b)for(var c={},b=b.split(";"),d=0;d<b.length;d++){var e=b[d],e=e.replace(/^\s+|\s+$/g,""),e=e.split("=");c[e[0]]=e[1]}a&&a(c);
logger.debug("cookie get(): "+JSON.stringify(c));return c},getItem:function(a,b){var c=this.get(),d=null;null!==c&&(d=c[a]);b&&b(d);logger.debug("cookie getItem(): "+a+"="+d);return d},setItem:function(a,b,c,d){var e="";if("undefined"===typeof c||""===c)e="";else if(e=parseInt(c,10),isNaN(e)){e=Date.parse(c);if(isNaN(e)){logger.log("ERROR: PersistentStorage.cookieInstance: days has to be a number or a date string");return}e=";expires="+c}else 0<e?(c=new Date,c.setTime(c.getTime()+e),e=";expires="+
c.toUTCString()):e=";expires=Thu, 01 Jan 1970 00:00:01 GMT";a=a+"="+b+e+"; SameSite=None; Secure; path=/"+(-1!=window.location.href.indexOf(m)?";domain="+m:"");this._setDocumentCookie(a);logger.debug("cookie setItem(): "+a);d&&d()},removeItem:function(a,b){logger.debug("cookie removeItem(): "+a);this.setItem(a,"",-1,b)},clear:function(a){logger.debug("cookie clear()");var b=this.get();if(null!==b)for(var b=Object.keys(b),c=0;c<b.length;c++){var d=b[c];this.removeItem(d,null,!0);this.removeItem(d,
null,!1)}a&&a()},onUnload:cleanNuanceCookies:function(){var a=this.get();if(null!==a)for(var a=Object.keys(a),b=0;b<a.length;b++){var c=a[b];/(inq|tc)[^_]*_\d*/.test(c)&&(this.removeItem(c,null,!0),this.removeItem(c,null,!1))}},_setDocumentCookie:version:"cookie.0.0.3"}}var d,f,g,h,k=null,l,n=null,m;return{setRootDomain:getInstance:function(b){if("localStorage"==b)return g||(g=c("localStorage")),g;if("sessionStorage"==b)return h||
(h=c("sessionStorage")),h;if("cookie"==b)return f||(f=e()),f;d||(d=a());return d},getDefaultUsedStorageType:_testHook:{getCookieInstance:e,getLocalStorageInstance:c}}}();var hasStringSupport=!1,xHRsInProgress={},caUnloadController,beaconUnloadController,targetOrigin,logger=new Logger;function simpleChatPost(a){var b=a.indexOf("?");if(-1!=b){var c=a.substring(0,b);a=a.substring(b+1);b=getXMLHttpRequest();b.open("POST",c,!0);b.setRequestHeader("Content-type","application/x-www-form-urlencoded");b.send(a)}}
function doCommandsInClientDomain(a,b){var c=[];"string"==typeof a?(c[0]=b,c[1]=a):c=a;hasStringSupport?parent.postMessage(convertArrToString(c),targetOrigin):parent.postMessage(c,targetOrigin);logger.debug("posted cross-window message: ",{command:c,targetOrigin:targetOrigin})}function assignCookieRootDomains(a){if(a){a=a.split(",");for(var b=0;b<a.length;b++)if(-1!==window.location.href.indexOf(a[b])){PersistentStorage.setRootDomain(a[b]);break}}}function _executeCommandFromItems(a){if(a&&0<a.length)try{if(checkDataForSimplePost(a))simpleChatPost(a[0]);else try{doCommands(a)}catch(b){handleError(a[1],b)}}catch(b){logger.error(b.message)}}function handleError(a,b){doCommandsInClientDomain({id:a,error:b},a)}
unction whenLoaded(){if(-1!==location.search.indexOf("?CLEAR"))clearAllData();else try{window.addEventListener?window.addEventListener("message",whenPosted,!1):window.attachEvent?window.attachEvent("onmessage",whenPosted):window.onmessage=whenPosted}catch(a){logger.error(a.message)}}
function doBeaconCommand(a){function b(a,b,c){beaconUnloadController.activate();beaconUnloadController.set(a);beaconUnloadController.url=b;beaconUnloadController.complete=c}if("undefined"===typeof window.v3Lander){var c=a[1];beaconUnloadController||(beaconUnloadController=new UnloadController(function(a){beaconUnloadController.complete||(sendBeacon(beaconUnloadController.url,beaconUnloadController.get()),beaconUnloadController.complete=!0)}));"ACTIVATE"==c?b(a[2],a[3],!1):"DEACTIVATE"==c?beaconUnloadController.deactivate():
c&&-1<c.indexOf("activeWindowUnload")?b(a[5],a[4],!1):"DATA"==c&&beaconUnloadController.set(a[2])}}
function doCommands(a){var b=a[0];switch(b){case "ONLOAD":doOnloadCommand(a);break;case "ABORT":doAbortCommand(a);break;case "POSTCHAT":doPostChatCommand(a);break;case "SCBR3_PM":doSCBR3PMCommand(a);break;case "GCBR3":doGCBR3Command(a);break;case "COMMITPOINT":doCommitPointCommand(a);break;case "DUMP":doDumpCommand(a);break;case "POSTBR30":doPOSTBR30Command(a);break;case "POSTJSON":doPOSTJSONCommand(a);break;case "COBROWSE":doCobrowseCommand(a);break;case "CBAUTH":doCBAUTHCommand(a);break;case "CBCHECK":doCBCheckCommand(a);
break;case "CHATACTIVE":doChatActiveCommand(a);break;case "CHATDEACTIVATE":chatDeactivate(a);break;case "BEACON":doBeaconCommand(a);break;case "POSTSYNC":doPostSyncCommand(a);break;case "CLEARSTORAGE":doClearStorageCommand(a);break;default:3<a.length&&(a=a[1],b=Error("Undefined Request for ["+b+"] command"),b.name="Syntax Error",handleError(a,b))}}
function doOnloadCommand(a){a=a[1];logger.setEnabled(!1===a.JSLoggingDisabled);a.rootDomainsList&&assignCookieRootDomains(a.rootDomainsList);a.id&&doCommandsInClientDomain([a.id])};var xhrTimeoutController={},trustedDomain,COOKIE_COBROWSE="cobrowse";
function validateDomain(a,b,c){var e=getLocation().pathname;if(0===e.indexOf("/chatrouter")||0===e.indexOf("/cobrowse"))c(!0,a);else{var d;if(window.v3Lander){if("function"===typeof getV3LanderConfigProperty&&(d=getV3LanderConfigProperty("vanityDomain",v3Lander.vanityDomain)),!d){c(!0,a);return}}else d="https://"+getLocation().host;var f=getXMLHttpRequest(),e="origin="+encodeURIComponent(a);"undefined"!==typeof b&&(e+="&siteID="+encodeURIComponent(b));f.open("POST",d+"/tagserver/init/isTrustedDomain");
f.setRequestHeader("Content-Type","application/x-www-form-urlencoded");f.onreadystatechange=function(){4===f.readyState&&(406===f.status?c(!1):c(!0,a))};f.send(e)}}
function whenPosted(a){var b=a?a:event;logger.debug("received cross-window message: ",{data:b.data,origin:b.origin});if(b.source===window)logger.error("Source window is equal to current window, command won't be executed.");else{var c=b.data;c&&0<c.length?("string"===typeof c?(hasStringSupport=!0,c=c.split("||")):hasStringSupport=!1,void 0===trustedDomain?validateDomain(b.origin,c[2],function(a,d){trustedDomain=a;targetOrigin=d;a?_executeCommandFromItems(c):logger.log("not executing command: untrusted domain origin: "+
b.origin)}):trustedDomain&&targetOrigin===b.origin?_executeCommandFromItems(c):logger.log("not executing command: untrusted domain origin: "+b.origin)):logger.debug("There is no data in the message: ",{data:b.data,origin:b.origin})}}function setChatActiveFlag(a,b,c){caUnloadController&&caUnloadController.set(b);PersistentStorage.getInstance().setItem(a,b,c,}
function getChatActiveFlag(a,b){if("function"!==typeof b)throw Error("Callback is required parameter for getChatActiveFlag function");PersistentStorage.getInstance().getItem(a,function(a){a=parseInt(a);isNaN(a)&&(a=0);b(a)})}
function setSessionChatActiveFlagPS(a){if("undefined"===typeof a||isNaN(a))logger.log("In setSessionChatActiveFlagPS(); requires one argument as a number");else try{"localStorage"===PersistentStorage.getDefaultUsedStorageType()&&sessionStorage.setItem("sinqCA",a)}catch(b){logger.log("Error while set sinqCA",b)}}function checkSameProtocolOrigin(a){return-1===a.indexOf(window.location.protocol)?a.replace(/^http:/i,window.location.protocol):a}
function pepareResponseData(a,b){var c=[];"unknown"!=typeof b.status?(c[0]=a,c[1]=b.responseText,c[2]=b.status,c[3]=b.getResponseHeader("Cache-Control")||"",c[4]=b.getResponseHeader("Content-Type")||""):c=[a,"","","",""];return c}function doAbortCommand(a){if("undefined"===typeof window.v3Lander&&(a=a[1],xHRsInProgress&&xHRsInProgress[a])){var b=xHRsInProgress[a];delete xHRsInProgress[a];b.abort()}}
function doPostChatCommand(a){var b=a[1],c=a[4],e=a[5],d=parseInt(a[6])||0;a=a[7];try{var f=getXMLHttpRequest();xHRsInProgress[b]=f;f.open(e?"POST":"GET",c,!0);void 0!=f.timeout?f.timeout=d:xhrTimeoutController[b]=setTimeoutXHR(d,b,xHRsInProgress);f.onreadystatechange=function(){4==f.readyState&&(xhrTimeoutController[b]&&(clearTimeout(xhrTimeoutController[b]),delete xhrTimeoutController[b]),xHRsInProgress[b]&&(doCommandsInClientDomain(pepareResponseData(b,f),b),delete xHRsInProgress[b]))};a&&f.setRequestHeader("X-Protection-Id",
encodeURIComponent(a));e?(f.setRequestHeader("Content-type","application/x-www-form-urlencoded"),f.send(decodeURIComponent(e))):f.send()}catch(g){handleError(b,g)}}function doSCBR3PMCommand(a){var b,c=a[1],e=a[2];try{var d=a[4],f=a[5];PersistentStorage.getInstance(a[6]).setItem(d+"_"+e,f,a[7]);b={action:"3rdPCQ"};doCommandsInClientDomain(JSON.stringify(b),c)}catch(g){handleError(c,g)}}
function doGCBR3Command(a){var b="",c=a[1],e=a[2];if(a=PersistentStorage.getInstance())try{e?a.getItem(e,function(a){b=e+"="+a;doCommandsInClientDomain(b,c)}):getAllData(function(a){""===a&&(a="inqPc=1");b=a;doCommandsInClientDomain(b,c)})}catch(d){handleError(c,d)}else doCommandsInClientDomain("no-cookie",c)}
function doCommitPointCommand(a){var b,c=a[1];a=a[2];var e=PersistentStorage.getInstance();try{e.getItem("inqVital_"+a,function(a){a=unescape(a);var e=/\bvcnt:([0-9]+)/.exec(a);e||(e=/\bvcnt":([0-9]+)/.exec(a));b={action:"W3rdCC",resp:2==e.length?e[1]:0};doCommandsInClientDomain(JSON.stringify(b),c)})}catch(d){handleError(c,d)}}
function doDumpCommand(a){if("undefined"===typeof window.v3Lander){var b=a[1];try{var c=decodeURIComponent(a[4]),e="_rand="+Math.round(0xe8d4a51001*Math.random()).toString(36)+"&level=info&line=document.cookie: "+encodeURIComponent("REMOVED FROM LOG FOR SECURITY REASONS"),d=getXMLHttpRequest();xHRsInProgress[b]=d;d.open("POST",c,!0);d.onreadystatechange=function(){4==d.readyState&&(delete xHRsInProgress[b],doCommandsInClientDomain("",b))};d.setRequestHeader("Content-type","application/x-www-form-urlencoded");
d.send(e)}catch(f){handleError(b,f)}}}
function doPOSTBR30Command(a){var b=a[1];try{var c=decodeURIComponent(a[4]),e=c.indexOf("?"),d=c.substring(0,e),d=checkSameProtocolOrigin(d),f=c.substring(e+1),g=getXMLHttpRequest();xHRsInProgress[b]=g;g.open("POST",d,!0);g.onreadystatechange=function(){4==g.readyState&&(delete xHRsInProgress[b],doCommandsInClientDomain(pepareResponseData(b,g),b))};var h;try{h=JSON.parse(a[5])}catch(l){}if(h&&"object"===typeof h)for(var k in h)g.setRequestHeader(k,h[k]);g.setRequestHeader("Content-type","application/x-www-form-urlencoded");
g.send(f)}catch(l){handleError(b,l)}}function doPOSTJSONCommand(a){var b=a[1];try{var c=decodeURIComponent(a[4]),e=c.indexOf("?"),d=c.substring(0,e),d=checkSameProtocolOrigin(d),f=c.substring(e+1),g=getXMLHttpRequest();xHRsInProgress[b]=g;g.open("POST",d,!0);g.onreadystatechange=function(){4==g.readyState&&(delete xHRsInProgress[b],doCommandsInClientDomain(pepareResponseData(b,g),b))};g.setRequestHeader("Content-type","application/json;charset=UTF-8");g.send(f)}catch(h){handleError(b,h)}}
function doCBAUTHCommand(a){var b,c=a[0],e=a[1],d=a[2],f=PersistentStorage.getInstance();try{var g=COOKIE_COBROWSE,h=parseInt(a[5]);if(isNaN(h))logger.log("Wrong value for cbAuth cookie");else{var k=a[7];f.setItem(g+"_"+d,JSON.stringify({auth:h}),k,function(){f.getItem(g+"_"+d,function(a){b={resp:a,id:e,action:"auth"};doCommandsInClientDomain(JSON.stringify(b),e)})})}}catch(l){a="Response: "+c+", Id: "+e+'", Log: "'+catchJsFormatter(l,c),handleError(e,a)}}
function doCBCheckCommand(a){var b,c=a[0],e=a[1];a=a[2];var d=PersistentStorage.getInstance();try{d.getItem("cobrowse_"+a,function(a){b={resp:a,id:e,action:"auth"};doCommandsInClientDomain(JSON.stringify(b),e)})}catch(f){c="Response: "+c+", Id: "+e+'", Log: "'+catchJsFormatter(f,c),handleError(e,c)}}
function doChatActiveCommand(a){var b=PersistentStorage.getInstance();try{var c=a[2],e=parseStringToBoolean(a[3]),d=1E3*parseInt(a[4]);b.setItem("v3TO",d);var f="inqCA_"+c;a=e?2:1;setChatActiveFlag(f,a,"");caUnloadController||(caUnloadController=new UnloadController(function(a){getChatActiveFlag(f,function(a){var b=caUnloadController.get();0!=b&&a==b&&(setChatActiveFlag(f,0,""),updateCookieLastTouched(c,d))})},null,a));caUnloadController.activate();onPageHidden(}catch(g){}}function updateCookieLastTouched(a,b){var c=PersistentStorage.getInstance(),e=c.getItem("v3TO")||b,d="inqLT_"+a,f=""+(new Date).getTime();c.setItem(d,f,e,}function onPageHidden(a){_addEventListener(document,"visibilitychange",}function chatDeactivate(a){var b=a[1];a="inqCA_"+a[2];caUnloadController&&caUnloadController.deactivate();if("UNLOAD_HANDLER"!==b)try{setChatActiveFlag(a,0,"")}catch(c){}}
function doPostSyncCommand(a){var b=a[1];try{var c=decodeURIComponent(a[4]),e=c.indexOf("?"),d=c.substring(0,e),d=checkSameProtocolOrigin(d),f=c.substring(e+1),g=getXMLHttpRequest();xHRsInProgress[b]=g;g.open("POST",d,!1);g.setRequestHeader("Content-type","application/x-www-form-urlencoded");var h;try{h=JSON.parse(a[5])}catch(l){}if(h&&"object"===typeof h)for(var k in h)g.setRequestHeader(k,h[k]);g.send(f);delete xHRsInProgress[b];doCommandsInClientDomain(pepareResponseData(b,g),b)}catch(l){handleError(b,
l)}}function getAllData(a){if("function"!==typeof a)throw Error("Callback is required parameter for getAllData function");var b=PersistentStorage.getInstance("cookie"),c=b.getAllCookies().concat("; "),b=PersistentStorage.getInstance("localStorage"),c=c+b.getAllCookies(),b=PersistentStorage.getInstance("sessionStorage"),c=c+b.getAllCookies();a(c)}
function clearAllData(){var a=PersistentStorage.getInstance("cookie");a.clear();a=PersistentStorage.getInstance("localStorage");a.clear();a=PersistentStorage.getInstance("sessionStorage");a.clear()}function doClearStorageCommand(){"localStorage"===PersistentStorage.getDefaultUsedStorageType()&&PersistentStorage.getInstance("cookie").cleanNuanceCookies()}whenLoaded();function getXMLHttpRequest(){if(window.XMLHttpRequest)return new XMLHttpRequest;if(window.ActiveXObject)return new ActiveXObject("Microsoft.XMLHTTP");throw Error("Impossible to create XMLHttpRequest object.");}function setTimeoutXHR(a,b,c){if(0<a&&c)return setTimeout(a)}function catchJsFormatter(a,b){try{return"ERROR while processing "+b+": "+a.name+" - "+a.message+" . Stack "+a.stack}catch(c){return""}}
function parseStringToBoolean(a){return"string"==typeof a?"true"==a:a}function _addEventListener(a,b,c,e){e||(e=!1);window.addEventListener?a.addEventListener(b,c,e):window.attachEvent&&a.attachEvent("on"+b,c)}unction sendBeacon(a,b){a+="&timestamp="+(new Date).getTime();navigator.sendBeacon?navigator.sendBeacon(a,b):sendBeaconByXHR(a,b)}
function sendBeaconByXHR(a,b){var c=new XMLHttpRequest;c.open("POST",a,!1);c.setRequestHeader("Content-Type","text/plain;charset=UTF-8");c.send(b)};function UnloadController(a,b,c){this.active=!1;this.handler=a;this._value=c||null;if(b)for(var e in b)this[e]=b[e]}UnloadController.prototype.activate=function(){if(!this.onunload){this.onunload=function(a){this.isActive()&&(this.handler(a),this.deactivate())};var a=this;this._addUnloadHandler(}this.active=!0};UnloadController.prototype.deactivate=UnloadController.prototype.isActive=function(){return this.active};
UnloadController.prototype.set=UnloadController.prototype.get=UnloadController.prototype._addUnloadHandler=
