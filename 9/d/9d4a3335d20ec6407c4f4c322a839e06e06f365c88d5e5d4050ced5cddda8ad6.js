(self.webpackChunkreportEmbed=self.webpackChunkreportEmbed||[]).push([["slicer"],{48105:function(it,ke){var L;void 0!==(L=function(){"use strict";var p="14.6.2";s,V){if(V>=l.slice(-1)[0])return 100;var R=Ge(V,l),ue=s[R-1],b=s[R];return ue+[l[R-1],l[R]],V)/ge(ue,b)}nction St(l,s,V){if(s){if(V.xVal[l]===V.xVal[l+1])return void(V.xSteps[l]=V.xHighestCompleteStep[l]=V.xVal[l]);V.xSteps[l]=De([V.xVal[l],V.xVal[l+1]],s,0)/ge(V.xPct[l],V.xPct[l+1]);var oe=Math.ceil(Number(((V.xVal[l+1]-V.xVal[l])/V.xNumSteps[l]).toFixed(3))-1);V.xHighestCompleteStep[l]=V.xVal[l]+V.xNumSteps[l]*oe}}e.prototype.getDistance=We.prototype.getAbsoluteDistance=function(l,s,V){var R=0;if(l<this.xPct[this.xPct.length-1])for(;l>this.xPct[R+1];)R++;else l===this.xPct[this.xPct.length-1]&&(R=this.xPct.length-2);!V&&l===this.xPct[R+1]&&R++;var oe,me=1,ue=s[R],b=0,m=0,w=0,O=0;for(oe=V?(l-this.xPct[R])/(this.xPct[R+1]-this.xPct[R]):(this.xPct[R+1]-l)/(this.xPct[R+1]-this.xPct[R]);ue>0;)b=this.xPct[R+1+O]-this.xPct[R+O],s[R+O]*me+100-100*oe>100?(m=b*oe,me=(ue-100*oe)/s[R+O],oe=1):(m=s[R+O]*b/100*me,me=0),V?(w-=m,this.xPct.length+O>=1&&O--):(w+=m,this.xPct.length-O>=1&&O++),ue=s[R+O]*me;return l+w},We.prototype.toStepping=We.prototype.fromStepping=We.prototype.getStep=We.prototype.getDefaultStep=We.prototype.getNearbySteps=We.prototype.countStepDecimals=We.prototype.convert=var rt={to:from:Number},yt={target:"target",base:"base",origin:"origin",handle:"handle",handleLower:"handle-lower",handleUpper:"handle-upper",touchArea:"touch-area",horizontal:"horizontal",vertical:"vertical",background:"background",connect:"connect",connects:"connects",ltr:"ltr",rtl:"rtl",textDirectionLtr:"txt-dir-ltr",textDirectionRtl:"txt-dir-rtl",draggable:"draggable",drag:"state-drag",tap:"state-tap",active:"active",tooltip:"tooltip",pips:"pips",pipsHorizontal:"pips-horizontal",pipsVertical:"pips-vertical",marker:"marker",markerHorizontal:"marker-horizontal",markerVertical:"marker-vertical",markerNormal:"marker-normal",markerLarge:"marker-large",markerSub:"marker-sub",value:"value",valueHorizontal:"value-horizontal",valueVertical:"value-vertical",valueNormal:"value-normal",valueLarge:"value-large",valueSub:"value-sub"};unction Mt(l,s){if(!U(s))throw new Error("noUiSlider ("+p+"): 'step' is not numeric.");l.singleStep=s}function Pt(l,s){if(!U(s))throw new Error("noUiSlider ("+p+"): 'keyboardPageMultiplier' is not numeric.");l.keyboardPageMultiplier=s}ction lt(l,s){if(l.snap=s,"boolean"!=typeof s)throw new Error("noUiSlider ("+p+"): 'snap' option must be a boolean.")}function Ct(l,s){if(l.animate=s,"boolean"!=typeof s)throw new Error("noUiSlider ("+p+"): 'animate' option must be a boolean.")}function qe(l,s){if(l.animationDuration=s,"number"!=typeof s)throw new Error("noUiSlider ("+p+"): 'animationDuration' option must be a number.")}unction et(l,s){switch(s){case"horizontal":l.ort=0;break;case"vertical":l.ort=1;break;default:throw new Error("noUiSlider ("+p+"): 'orientation' option is invalid.")}}nction wt(l,s){var V;if(!U(s)&&!Array.isArray(s))throw new Error("noUiSlider ("+p+"): 'padding' option must be numeric or array of exactly 2 numbers.");if(Array.isArray(s)&&2!==s.length&&!U(s[0])&&!U(s[1]))throw new Error("noUiSlider ("+p+"): 'padding' option must be numeric or array of exactly 2 numbers.");if(0!==s){for(Array.isArray(s)||(s=[s,s]),l.padding=[l.spectrum.getDistance(s[0]),l.spectrum.getDistance(s[1])],V=0;V<l.spectrum.xNumSteps.length-1;V++)if(l.padding[0][V]<0||l.padding[1][V]<0)throw new Error("noUiSlider ("+p+"): 'padding' option must be a positive number(s).");if((s[0]+s[1])/(l.spectrum.xVal[l.spectrum.xVal.length-1]-l.spectrum.xVal[0])>1)throw new Error("noUiSlider ("+p+"): 'padding' option must not exceed 100% of the range.")}}ction x(l,s){l.ariaFormat=s,J(s)}ion Se(l){var s={margin:0,limit:0,padding:0,animate:!0,animationDuration:300,ariaFormat:rt,format:rt},V={step:{r:!1,t:Mt},keyboardPageMultiplier:{r:!1,t:Pt},keyboardDefaultStep:{r:!1,t:nt},start:{r:!0,t:Ze},connect:{r:!0,t:bt},direction:{r:!0,t:Rt},snap:{r:!1,t:lt},animate:{r:!1,t:Ct},animationDuration:{r:!1,t:qe},range:{r:!0,t:Te},orientation:{r:!1,t:et},margin:{r:!1,t:ht},limit:{r:!1,t:pt},padding:{r:!1,t:wt},behaviour:{r:!0,t:ut},ariaFormat:{r:!1,t:x},format:{r:!1,t:N},tooltips:{r:!1,t:T},keyboardSupport:{r:!0,t:M},documentElement:{r:!1,t:k},cssPrefix:{r:!0,t:se},cssClasses:{r:!0,t:he}},R={connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal",keyboardSupport:!0,cssPrefix:"noUi-",cssClasses:yt,keyboardPageMultiplier:5,keyboardDefaultStep:10};l.format&&!l.ariaFormat&&(l.ariaFormat=l.format),Object.keys(V).forEach(,s.pips=l.pips;var oe=document.createElement("div");return s.transformRule=void 0!==oe.style.transform?"transform":void 0!==oe.style.msTransform?"msTransform":"webkitTransform",s.style=[["left","top"],["right","bottom"]][s.dir][s.ort],s}function pe(l,s,V){var b,m,w,O,Z,Pe,h,R=window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"},me=window.CSS&&CSS.supports&&CSS.supports("touch-action","none")&&),ue=l,A=s.spectrum,K=[],W=[],xe=[],Be=0,Ne={},Ce=l.ownerDocument,Ue=s.documentElement||Ce.documentElement,Xe=Ce.body,xt="rtl"===Ce.dir||1===s.ort?0:100;unction kt(h,v){var I=tt(h,s.cssClasses.origin),F=tt(I,s.cssClasses.handle);return tt(F,s.cssClasses.touchArea),F.setAttribute("data-handle",v),s.keyboardSupport&&(F.setAttribute("tabindex","0"),F.addEventListener("keydown",function(Q){return function(h,v){if(ni()||Wt(v))return!1;var I=["Left","Right"],F=["Down","Up"],Q=["PageDown","PageUp"],Y=["Home","End"];s.dir&&!s.ort?I.reverse():s.ort&&!s.dir&&(F.reverse(),Q.reverse());var Le,re=h.key.replace("Arrow",""),we=re===Q[0],Ee=re===Q[1],Fe=re===F[0]||re===I[0]||we,He=re===F[1]||re===I[1]||Ee,Ae=re===Y[1];if(!(Fe||He||re===Y[0]||Ae))return!0;if(h.preventDefault(),He||Fe){var ct=s.keyboardPageMultiplier,Dt=Fe?0:1,Qe=gi(v)[Dt];if(null===Qe)return!1;!1===Qe&&(Qe=A.getDefaultStep(W[v],Fe,s.keyboardDefaultStep)),(Ee||we)&&(Qe*=ct),Qe=Math.max(Qe,1e-7),Le=K[v]+(Qe*=Fe?-1:1)}else Le=Ae?s.spectrum.xVal[s.spectrum.xVal.length-1]:s.spectrum.xVal[0];return It(v,A.toStepping(Le),!0,!0),je("slide",v),je("update",v),je("change",v),je("set",v),!1}(Q,v)})),F.setAttribute("role","slider"),F.setAttribute("aria-orientation",s.ort?"vertical":"horizontal"),0===v?f(F,s.cssClasses.handleLower):v===s.handles-1&&f(F,s.cssClasses.handleUpper),I}on jt(h,v,I){var F=Ce.createElement("div"),Q=[];Q[0]=s.cssClasses.valueNormal,Q[1]=s.cssClasses.valueLarge,Q[2]=s.cssClasses.valueSub;var Y=[];Y[0]=s.cssClasses.markerNormal,Y[1]=s.cssClasses.markerLarge,Y[2]=s.cssClasses.markerSub;var re=[s.cssClasses.valueHorizontal,s.cssClasses.valueVertical],we=[s.cssClasses.markerHorizontal,s.cssClasses.markerVertical];eturn f(F,s.cssClasses.pips),f(F,0===s.ort?s.cssClasses.pipsHorizontal:s.cssClasses.pipsVertical),Object.keys(h).forEach(,F}unction _t(h){Nt();var v=h.mode,F=h.filter||!1,we=function(h,v,I){ar Q={},Y=A.xVal[0],re=A.xVal[A.xVal.length-1],we=!1,Ee=!1,Fe=0;return(I=I.slice().sort(function(He,Ke){return He-Ke})))[0]!==Y&&(I.unshift(Y),we=!0),I[I.length-1]!==re&&(I.push(re),Ee=!0),I.forEach(function(He,Ke){var Ae,Le,ct,Qe,Xt,Zt,qt,ei,mi,Dt=He,st=I[Ke+1],Si="steps"===v;if(Si&&(Ae=A.xNumSteps[Ke]),Ae||(Ae=st-Dt),!1!==Dt)for(void 0===st&&(st=Dt),Ae=Math.max(Ae,1e-7),Le=Dt;Le<=st;Le=F(Le,Ae)){for(mi=(Xt=(Qe=A.toStepping(Le))-Fe)/(ei=Math.round(Xt/h)),ct=1;ct<=ei;ct+=1)Q[(Zt=Fe+ct*mi).toFixed(5)]=[A.fromStepping(Zt),0];qt=I.indexOf(Le)>-1?1:Si?2:0,!Ke&&we&&Le!==st&&(qt=0),Le===st&&Ee||(Q[Qe.toFixed(5)]=[Le,qt]),Fe=Qe}}),Q}(h.density||1,v,v,h.values||!1,h.stepped||!1)),Ee=h.format||{to:Math.round};return O=ue.appendChild(jt(we,F,Ee))}unction vt(h,v,I,F){var Q=function(we){if(!(we=we,F.pageOffset,F.target||v))||ni()&&!F.doNotReject||ue,s.cssClasses.tap)&&!F.doNotReject||h===R.start&&void 0!==we.buttons&&we.buttons>1||F.hover&&we.buttons)return!1;me||we.preventDefault(),we.calcPoint=we.points[s.ort],I(we,F)},Y=[];return h.split(" ").forEach(function(re){var we=!!me&&{passive:!0};v.addEventListener(re,Q,we),Y.push([re,Q,we])}),Y}ction At(h,v){v.handle&&(C(v.handle,s.cssClasses.active),Be-=1),v.listeners.forEach(,0===Be&&(C(ue,s.cssClasses.drag),Bt(),h.cursor&&(Xe.style.cursor="",Xe.removeEventListener("selectstart",D))),v.handleNumbers.forEach(}function Kt(h,v){if(v.handleNumbers.some(Wt))return!1;var I;1===v.handleNumbers.length&&(Be+=1,f(I=m[v.handleNumbers[0]].children[0],s.cssClasses.active)),h.stopPropagation();var Q=[],Y=vt(R.move,Ue,ui,{target:h.target,handle:I,listeners:Q,startCalcPoint:h.calcPoint,baseSize:si(),pageOffset:h.pageOffset,handleNumbers:v.handleNumbers,buttonsProperty:h.buttons,locations:W.slice()}),re=vt(R.end,Ue,At,{target:h.target,handle:I,listeners:Q,doNotReject:!0,handleNumbers:v.handleNumbers}),we=vt("mouseout",Ue,Ii,{target:h.target,handle:I,listeners:Q,doNotReject:!0,handleNumbers:v.handleNumbers});Q.push.apply(Q,Y.concat(re,we)),h.cursor&&(Xe.style.cursor=getComputedStyle(h.target).cursor,m.length>1&&f(ue,s.cssClasses.drag),Xe.addEventListener("selectstart",D,!1)),v.handleNumbers.forEach(}h,v){return null===h||!1===h||void 0===h||("number"==typeof h&&(h=String(h)),h=s.format.from(h),!1===(h=A.toStepping(h))||isNaN(h))?W[v]:h}function Ot(h,v,I){var F=o(h);v=void 0===v||!!v,s.animate&&!(void 0===W[0])&&y(ue,s.cssClasses.tap,s.animationDuration),xe.forEach(;for(var Y=1===xe.length?0:1;Y<xe.length;++Y)xe.forEach(;Bt(),xe.forEach(}turn f(h=ue,s.cssClasses.target),f(h,0===s.dir?s.cssClasses.ltr:s.cssClasses.rtl),f(h,0===s.ort?s.cssClasses.horizontal:s.cssClasses.vertical),f(h,"rtl"===getComputedStyle(h).direction?s.cssClasses.textDirectionRtl:s.cssClasses.textDirectionLtr),b=tt(h,s.cssClasses.base),s.connect,b),s.events),Ot(s.start),s.pips&&_t(s.pips),s.tooltips&&ai(),$t("update",function(h,v,I,F,Q){xe.forEach(function(Y){var re=m[Y],we=Vt(W,Y,0,!0,!0,!0),Ee=Vt(W,Y,100,!0,!0,!0),Fe=Q[Y];s.ariaFormat.to(I[Y]),we=A.fromStepping(we).toFixed(0),Ee=A.fromStepping(Ee).toFixed(0),Fe=A.fromStepping(Fe).toFixed(0),re.children[0].setAttribute("aria-valuemin",we),re.children[0].setAttribute("aria-valuemax",Ee),re.children[0].setAttribute("aria-valuenow",Fe)})}),Pe={destroy:steps:on:$t,off:di,get:vi,set:Ot,setHandle:function(h,v,I,F){if(!((h=Number(h))>=0&&h<xe.length))throw new Error("noUiSlider ("+p+"): invalid handle number, got: "+h);It(h,Qt(v,h),!0,!0,F),je("update",h),I&&je("set",h)},reset:__moveHandles:options:V,updateOptions:target:ue,removePips:Nt,removeTooltips:Ut,getTooltips:function(){return Z},getOrigins:function(){return m},pips:_t}}return{__spectrum:We,version:p,cssClasses:yt,create:}.apply(ke,[]))&&(it.exports=L)},13999:function(it,ke,S){"use strict";S.d(ke,{VT:function(){return J},OQ:function(){return Mt}});var ee=S(26514),L=S(84282),p=S(98801),ve=S(87810),te=S(44883),ye=S(66683),D=S(51467),q=S(87941),de=S(3018),z=S(65146),U=S(61374),y=S(98129),u=S(19632),o=S(48711),d=S(61414),f=S(88222),C=S(13106),B=S(24356),j=S(16170),ae=S(59317),be=S(79752),ne=function(){function T(x,N,M){this.columns=N,this.selectedDataPoints=M,this.column=x&&!_.isEmpty(x.categories)?x.categories[0]:null,this.column&&(this.objects=this.column.objects),this.count=this.column&&this.column.values?this.column.values.length:0,this.isImage=(0,be.pt)(this.columns[0])}return T.prototype.getDataPointsCount=function(){return this.count},T.prototype.getMetadataColumn=function(){return this.column&&this.column.source||this.columns[0]},T.prototype.getDataViewDataPoint=function(x){var M,N=this;return q.fF.assert(".getDataViewDataPoint index is out of bounds"),this.objects&&(M=(0,y.NA)(this.objects[x],L.gO.general.count,M)),{scopeId:this.column.identity[x],count:M,value:this.column.values[x]}},T.prototype.isImageData=function(){return this.isImage},T.prototype.getLevel=function(){return 0},T.prototype.hasCount=function(){return!_.isEmpty(this.objects)},T.prototype.getSelectedNodes=function(){return this.selectedDataPoints},T.prototype.getMetadataColumns=function(){return this.column&&[this.column.source]},T.prototype.getIdentityExprs=function(){return this.column&&this.column.identityFields&&[this.column.identityFields]},T}(),ge=S(32799),De=S(80187),Ve=function(){function T(x,N,M,k){this.matrix=x,this.metadataColumns=N,this.root=M,this.selectedDataPoints=k,this.root=M,this.level=M&&M.level+1||0,this.root||(this.root=x&&x.rows&&x.rows.root,!this.root||_.isEmpty(x.rows.levels))||(this.metadata=x.rows.levels[this.level].sources[0],this.metadata&&(this.isImageUrlColumn=(0,be.pt)(this.metadata))),this.valueSources=null==x?void 0:x.valueSources,this.count=this.root&&this.root.children&&this.root.children.length||0}return T.prototype.getDataPointsCount=function(){return this.count},T.prototype.getMetadataColumn=T.prototype.getDataViewDataPoint=function(x){var N=this;q.fF.assert(function(){return x<N.count&&x>=0},".getDataViewDataPoint index is out of bounds");var M,k=this.root.children[x];if(!k.isSubtotal){var he;if(q.fF.assert(".getDataViewDataPoint does not expect levelValues to have more than one value."),_.some(k.children,function(l){return!l.isSubtotal})){var Se=_.find(this.selectedDataPoints,;he=new T(this.matrix,this.metadataColumns,k,Se&&Se.children)}M=k.levelValues[0].value;var pe=this.readImageUrl(k.objects);this.isImage=_.isEmpty(pe)&&1===this.metadataColumns.length&&this.isImageUrlColumn,this.isImage&&(pe=(0,o.WU)(M));var Me=this.readTooltipInfo(k);return{scopeId:k.identity,isCollapsed:k.isCollapsed,value:M,childrenReader:he,tooltipInfo:Me,imageUrl:pe,label:this.readLabelValue(k.objects),objects:k.objects}}},T.prototype.isImageData=function(){return this.isImage},T.prototype.getLevel=function(){return this.level},T.prototype.hasCount=function(){return!1},T.prototype.getSelectedNodes=function(){return this.selectedDataPoints},T.prototype.getMetadataColumns=function(){},T.prototype.getIdentityExprs=function(){return this.metadataColumns&&_.map(this.metadataColumns,function(x){return x.identityExprs})},T.prototype.readImageUrl=function(x){if(x)return(0,y.NA)(x,ge.yD.image.image)},T.prototype.readLabelValue=function(x){if(x)return(0,y.NA)(x,De.OV.label.field)},T.prototype.readTooltipInfo=function(x){var N,M;if(!_.isEmpty(x.values))for(var k in x.values){var se=x.values[k],he=null!==(N=se.valueSourceIndex)&&void 0!==N?N:0,Se=(0,y.NA)(se.objects,ge.yD.general.formatString),pe=this.valueSources[he];(M=M||[]).push({displayName:pe.displayName,value:(0,be.xq)(se.value,pe,ge.yD.general.formatString,!1,Se)})}return M},T}(),Re=function(){function T(x,N,M){this.dataView=x,this.listJoinSeparator=N,this.initMetadataColumns(),this.reader=x.categorical?new ne(x.categorical,this.columns,M):new Ve(x.matrix,this.columns,void 0,M)}return T.prototype.getIdentityFields=function(){var x=this.getMetadataColumns();return this.reader.getIdentityExprs()||_.map(x,function(N){return N.identityExprs})},T.prototype.getDataPointsReader=function(){return this.reader},T.prototype.getQueryNamePerLevel=function(){var x=this.getMetadataColumns();return _.map(x,function(N){return N.queryName})},T.prototype.getDisplayNamePerLevel=function(){var x=this.getMetadataColumns();return _.map(x,function(N){return N.displayName})},T.prototype.getDisplayName=function(){var x=this.getDisplayNamePerLevel();return _.join(x,this.listJoinSeparator)},T.prototype.getColumns=function(){return this.columns},T.prototype.getMetadataColumnByLevel=T.prototype.getMetadataColumns=T.prototype.initMetadataColumns=function(){this.columns=(0,ae.zJ)(this.dataView.metadata.columns)},T}(),Ge=S(56535),Je=S(31115),Oe=S(44119),ie=S(52614),dt=function(){function T(x,N){this.hasMappedColumn=!1,this.filter=x.filter,this.isNotFilter=!1,this.analyze(x,N)}return T.prototype.analyze=function(x,N){var M=this;if(this.hasMappedColumn=(0,ae.R6)({columns:x.columns}),this.isAnyFilter=C.yl.isAnyFilter(this.filter),!this.isAnyFilter){var k=x.fieldSQExprs;if(this.filter){var se=(0,f.Gl)(this.filter,k);if(se){if(this.isNotFilter=_.some(se,,this.hasMappedColumn){var he=_.some(se,function(s){return M.isSQExprBlank(s)});(this.isNotFilter||he)&&(this.isNotFilter=!1,this.filter=void 0)}this.selectedIdentities=se,this.isDefaultFilter=1===this.selectedIdentities.length&&(0,Oe.F)(this.selectedIdentities[0].identity.expr)}}if(this.defaultValueByLevel=this.getDataViewDefaultValuePerLevel(x.columns,x.defaultValuePropertyId),!_.isEmpty(_.compact(this.defaultValueByLevel))&&!N&&(this.filter||(this.filter=ie.N.buildDefaultValueFilter(x.columns),this.selectedIdentities=(0,f.Gl)(this.filter,k),this.isDefaultFilter=!0),this.isDefaultFilter&&!_.isEmpty(this.selectedIdentities)))for(var Se=this.selectedIdentities[0],pe=0;Se;){var l=(0,u.TZ)((0,Je.R)(k[pe],this.defaultValueByLevel[pe].identityFieldsValues));this.isNotFilter=!1,Se.identity=l,q.fF.assert(function(){return _.isEmpty(Se.children)||1===Se.children.length},"Default value filter can not have more than single node per level"),Se=_.isEmpty(Se.children)?void 0:Se.children[0],pe++}}},T.prototype.isSQExprBlank=function(x){var N=x.identity.expr;return!!(0,Ge.$Q)(N)&&(0,Ge.WC)(N)},T.prototype.getDataViewDefaultValuePerLevel=function(x,N){if(!_.isEmpty(x))return _.map(x,},T}();function J(T){return{general:{outlineWeight:1,outlineColor:p.v.getThemeColor(T,"foregroundNeutralSecondaryAlt2")},slicerText:{color:p.v.getThemeColor(T,"foregroundNeutralSecondary"),outlineStyle:0,outline:ye.YP,textSize:10,fontFamily:de.Wn.regular.css,labelBold:!1,labelItalic:!1,labelUnderline:!1},selection:{selectAllCheckboxEnabled:!1,singleSelect:!0,strictSingleSelect:!1},search:{enabled:!1,outlineStyle:4,outline:ye.wI,borderColor:"#C8C8C8",background:"#ffffff"},expandCollapse:{indentation:15,visible:!0,toggleType:0},items:{padding:void 0,accessibilityContrastProperties:!1}}}function Mt(T){var x=T.dataView,N=T.hostServices,M=T.selectionHandler;if(q.fF.assertValue(N,"hostServices"),x&&x.metadata&&!_.isEmpty(x.metadata.columns)){var k=N.getLocalizedString("ListJoin_Separator"),se=new Re(x,N.getLocalizedString("ListJoin_Separator")),he=se.getIdentityFields();if(!_.isEmpty(he)){var Se=x.metadata&&x.metadata.objects&&(0,y.NA)(x.metadata.objects,L.gO.general.filter),pe=se.getColumns(),l=new dt({columns:pe,defaultValuePropertyId:L.gO.general.defaultValue,filter:Se,fieldSQExprs:he},N.ignoreDefaultFilter());_.isEmpty(l.selectedIdentities)||(se=new Re(x,k,l.selectedIdentities));var s=l.hasMappedColumn&&!(0,ae.Wm)({columns:pe});(function(T,x,N,M,k){var se=x.filter,he=N.isSelectionModeInverted();if(se&&!C.yl.isSameFilter(se,T)){N.handleClearSelection();var Se=L.gO.general.filter,pe={};pe[Se.propertyName]=x.filter,M.persistProperties({merge:[{objectName:Se.objectName,selector:void 0,properties:pe}]})}k&&(he||!C.yl.isSameFilter(se,T))&&(0,ae.K5)(N,!1)})(Se,l,M,N,s),M.setColumns(se.getColumns()),M.setQueryNameByLevel(se.getQueryNamePerLevel());var V=function(T,x,N,M,k){var se=M.hostServices,he=M.selectionHandler,Se=M.style,pe=M.localizedSelectAllText,Me=M.localizedDeselectAllText,l=null!=M.isSlicer&&M.isSlicer,s=null!=he&&he.isSelectionModeInverted();s=T.filter?T.isAnyFilter?(0,y.NA)(x.objects,L.gO.data.isInvertedSelectionMode,s):T.isNotFilter:!T.hasMappedColumn&&(0,y.NA)(x.objects,L.gO.data.isInvertedSelectionMode,s);var V=function(T,x,N){var M=J(x),k=T.objects,se=p.v.create(x);if(k){M.items.accessibilityContrastProperties=(0,y.NA)(k,L.gO.items.accessibilityContrastProperties,!1);var he="lightLabel",Se="foregroundNeutralSecondary";M.items.accessibilityContrastProperties&&0===N&&(Se="foreground",he="largeLightLabel");var pe=(0,ve.Zi)((0,y.RK)(k,"items"),{color:"fontColor",family:"fontFamily",size:"textSize"},se,x,Se,he,{color:M.slicerText.color,family:M.slicerText.fontFamily,size:te.B.createFromPt(M.slicerText.textSize)},!0);M.slicerText.color=pe.color,M.slicerText.fontFamily=pe.family,M.slicerText.textSize=pe.size.pt,M.items.accessibilityContrastProperties&&1===N&&(M.slicerText.outline=ye.Wi,M.slicerText.outlineStyle=15),M.slicerText.outline=(0,y.NA)(k,L.gO.items.outline,M.slicerText.outline),M.slicerText.outlineStyle=(0,y.NA)(k,L.gO.items.outlineStyle,M.slicerText.outlineStyle);var Me=se.getColorForProperty(k,L.gO.items.background,void 0);Me&&(M.slicerText.background=Me),M.search.enabled=(0,y.NA)(k,L.gO.general.selfFilterEnabled,M.search.enabled),M.search.outlineStyle=(0,y.NA)(k,L.gO.searchBox.outlineStyle,M.search.outlineStyle),M.search.outline=(0,y.NA)(k,L.gO.searchBox.outline,M.search.outline),M.search.borderColor=se.getColorForPropertyWithDefaultColor(k,L.gO.searchBox.borderColor,M.search.borderColor);var l=se.getColorForProperty(k,L.gO.searchBox.background,void 0);M.search.background=l||M.slicerText.background||M.search.background,M.expandCollapse.toggleType=(0,y.NA)(k,L.gO.items.expandCollapseToggleType,M.expandCollapse.toggleType),M.expandCollapse.indentation=(0,y.NA)(k,L.gO.items.steppedLayoutIndentation,M.expandCollapse.indentation),M.general.outlineWeight=(0,y.NA)(k,L.gO.general.outlineWeight,M.general.outlineWeight),M.general.outlineColor=se.getColorForPropertyWithDefaultColor(k,L.gO.general.outlineColor,M.general.outlineColor),M.selection.selectAllCheckboxEnabled=(0,y.NA)(k,L.gO.selection.selectAllCheckboxEnabled,M.selection.selectAllCheckboxEnabled),M.selection.singleSelect=(0,y.NA)(k,L.gO.selection.singleSelect,M.selection.singleSelect),M.selection.strictSingleSelect=(0,y.NA)(k,L.gO.selection.strictSingleSelect,M.selection.strictSingleSelect),M.slicerText.labelBold=(0,y.NA)(k,L.gO.items.bold,!1),M.slicerText.labelItalic=(0,y.NA)(k,L.gO.items.italic,!1),M.slicerText.labelUnderline=(0,y.NA)(k,L.gO.items.underline,!1),M.items.padding=(0,y.NA)(k,L.gO.items.padding,void 0)}return M}(x,Se,M.slicerType);he&&(he.setSelectionModeInverted(s),he.setDefaultValueMode(C.yl.isDefaultFilter(T.filter)));var R=N.getQueryNamePerLevel(),oe=se.getFilterExpressionMetadata(),ue=[],b=[],m=Te(N,N.getDataPointsReader(),ue,b,se,R,oe,{calculatedIndex:0},void 0,T,M.featureSwitches,M.valueSettings,M.hideRetainedDataPoints);if(b.length>0){var w=_.chain(b).sort(wt).map(function(Be){return Be.dataPoint}).value();ue=ue.concat(w)}var O=he.toFilterExpressionMetadata(ue);se.setFilterExpressionMetadata(O);var Z=function(T){var x=(0,y.NA)(T.objects,L.gO.general.selfFilter,void 0);if(!x)return"";var N=x.conditions();q.fF.assert(function(){return 1===N.length},"There should be exactly 1 filter expression.");var M=N[0];if(M){var k=new Rt;return M.accept(k),k.getValueForField()}}(x),A=V.selection,K=A.strictSingleSelect;if(!K&&l&&he.isDisableMultipleSelectForMappedColumn()&&(K=!0,V.selection.strictSingleSelect=!0),A.selectAllCheckboxEnabled&&!K&&_.isEmpty(Z)){var W=k?se.getLocalizedString("DQP_Disabled_SelectAll"):pe;m.unshift({value:s&&Me?Me:pe,tooltip:W,identity:d.l0.createWithMeasure(pe),selected:!1,isSelectAllDataPoint:!0,partially:ue.length>0,count:void 0,disabled:k,levelIndex:0,index:0,id:"0:0"})}return he&&he.setStrictSingleSelect(K,_.isEmpty(ue)?m:ue),{categorySourceName:N.getDisplayName(),slicerSettings:V,slicerDataPoints:m,defaultValueByLevel:T.defaultValueByLevel,searchKey:Z,restatement:bt(se,ue,s,N.getColumns()),warnings:new D.tb,retainedDataPoints:ue,queryNameByLevel:R}}(l,x.metadata,se,T,s);return V.hasImages=_.some(V.slicerDataPoints,function(R){return R.isImage}),V}}}function Te(T,x,N,M,k,se,he,Se,pe,Me,l,s,V){for(var R=x.getSelectedNodes(),oe=x.getDataPointsCount(),me=[],ue=x.getMetadataColumn(),b=l&&l.fieldParameters&&ue.parameter&&2===ue.parameter.kind,m=(0,o.EO)(ue,L.gO.general.formatString),w=x.getLevel(),O=0,Z=0;Z<oe;Z++){var A=x.getDataViewDataPoint(Z);if(A){O++,Se.calculatedIndex++;var W,K=(0,ae.X$)(A.scopeId,R);W=s?ut(A.value,s,ue):(0,o.WU)(A.value,m);var xe=x.isImageData()&&(0,z.gU)(W),Be=W,Ne=!1,Pe=w+":"+O;null!=Me&&Me.hasMappedColumn&&null==A.value&&(Ne=!0,Be=k.getLocalizedString("DQP_Disabled_Blank"));var Ce={value:W,tooltip:Be,identity:null,selected:null!=K&&K.checked,partially:K&&!_.isEmpty(K.children),count:A.count,isImage:xe,level:w,parent:pe,isCollapsed:A.isCollapsed,scopeIdentity:A.scopeId,levelIndex:O,disabled:Ne,index:Se.calculatedIndex,id:pe?pe.id+","+Pe:Pe,tooltipInfo:A.tooltipInfo,imageUrl:A.imageUrl,label:A.label,objects:A.objects};if(K&&K.checked&&(b?M.push({dataPoint:Ce,selectionIndex:K.index}):N.push(Ce)),me.push(Ce),pe&&pe.children.push(Ce),qe(Ce,se),!A.isCollapsed&&A.childrenReader)Ce.children=[],me.push.apply(me,Te(T,A.childrenReader,N,M,k,se,he,Se,Ce,void 0,l,void 0,V)||[]);else if(K&&!_.isEmpty(K.children)){var Xe=w+1,at=T.getMetadataColumnByLevel(Xe);Ze(Xe,Me,K.children,se,he&&he.cachedValueItems,at,T,x,Ce,me,N,M,!1,Se,l)}}}return _.isEmpty(R)||Ze(w,Me,R,se,he&&he.cachedValueItems,ue,T,x,pe,me,N,M,!(V||pe&&!1!==pe.isCollapsed),Se,l),me}function Ze(T,x,N,M,k,se,he,Se,pe,Me,l,s,V,R,oe){var me=oe&&oe.fieldParameters&&se.parameter&&2===se.parameter.kind,ue=(0,o.EO)(se,L.gO.general.formatString);pe&&(pe.children=[]);for(var b=0,m=N;b<m.length;b++){var w=m[b],O=void 0,Z=void 0;x&&x.isDefaultFilter&&!_.isEmpty(x.defaultValueByLevel)&&x.defaultValueByLevel[T]?O=B.jz.getTextValue(x.defaultValueByLevel[T].value):(Z=Ct(T,w,k),O=_.isEmpty(Z)?(0,f.Xz)(w.identity):Z[0].valueMap[T]),R.calculatedIndex++;var A=(0,o.WU)(O,ue),K=lt(w.checked,A,Se.hasCount(),Se.isImageData(),T,w.identity,pe,!_.isEmpty(w.children),M,R.calculatedIndex);if(V&&Me.push(K),K.selected&&(me?s.push({dataPoint:K,selectionIndex:w.index}):l.push(K)),!_.isEmpty(w.children)){var xe=T+1,Be=he.getMetadataColumnByLevel(xe);Ze(xe,x,w.children,M,Z,Be,he,Se,K,Me,l,s,V,R,oe)}}}function lt(T,x,N,M,k,se,he,Se,pe,Me){var l={value:x,tooltip:x,identity:null,selected:T,count:N?0:void 0,isImage:M,level:k,parent:he,scopeIdentity:se,partially:Se,disabled:!1,index:Me};return qe(l,pe),he&&he.children.push(l),l}function Ct(T,x,N){if(!_.isEmpty(N)){for(var M=[],k=0,se=N;k<se.length;k++){var he=se[k];(0,u.fS)(he.identities[T],x.identity)&&M.push(he)}return M}}function qe(T,x){for(var N=d.dw.builder(),M=T;M;)N.withColumnIdentity(M.scopeIdentity,x[T.level]),M=M.parent;T.identity=N.createSelectionId()}function bt(T,x,N,M){if(_.isEmpty(x))return T.getLocalizedString("All");if(1===x.length&&!N){var k=x[0];if(null==k.parent)return k.value;for(var se=[],he=T.getLocalizedString("MultiColumn_Join_Separator"),Se=T.getLocalizedString("NamePattern_Bracket");k;)se.unshift((0,U.W)(Se,k.value,M[k.level].displayName)),k=k.parent;return se.join(he)}return T.getLocalizedString("Slicer_Restatement_Multiple")}function wt(T,x){q.fF.assert(function(){return null!=T.dataPoint.level&&null!=x.dataPoint.level},"level should not be nullish"),q.fF.assert("selectionIndex should not be nullish");var N=T.dataPoint.level-x.dataPoint.level;return 0!==N?N:(q.fF.assert(,T.selectionIndex-x.selectionIndex)}var Rt=function(T){eturn(0,ee.ZT)(x,T),x.prototype.visitConstant=function(N){N.type&&N.type.text&&(this.value=N.value)},x.prototype.visitContains=function(N){N.left.accept(this),N.right.accept(this)},x.prototype.visitOr=x.prototype.visitColumnRef=function(N){this.fieldExpr=N},x.prototype.visitHierarchyLevel=function(N){this.fieldExpr=N},x.prototype.visitDefault=function(N){this.value=void 0,this.fieldExpr=void 0},x.prototype.getValueForField=x}(j.vq);function ut(T,x,N){if(null==T&&!_.isEmpty(x.showBlankAs))return x.showBlankAs;var M=x.labelDisplayUnits,k=-1===M,he=void 0;k&&!_.isEmpty(x.customFormatString)&&(he=x.customFormatString);var pe={};return null!=he&&(pe={general:{formatString:he}}),new o.g({column:N,formatStringPropId:L.gO.general.formatString,nullsAreBlank:!0,precision:k?void 0:x.labelPrecision,formatSingleValues:0===M,defaultPrecisionForScaledValues:!0}).format(T,pe)}},17174:function(it,ke,S){"use strict";S.r(ke),S.d(ke,{ContainerClass:function(){return Ki},ContentWrapperClass:function(){return $i},Slicer:function(){return Mr}});var ee=S(26514),L=S(84120),p=S(84282),ve=S(25474),te=S(49064),ye=S(60990),D=S(59510),q=S(51467),de=S(23342),z=S(87941),U=S(6266),y=S(51220),u=S(45315),o=S(98129),d=S(48887);function C(r,e){var g=Math.abs(r.valueOf()-e.valueOf());return Math.floor(g/864e5)}var B=S(89135),j=function(){function r(e,t,i,a){z.fF.assert(function(){return t>=e},"Requires max date to be bigger than min date."),z.fF.assert(function(){return(!i||i>=e)&&(!a||a<=t)},"Specified date is out of boundaries"),this.rangeMaxValue=C(t,e),this.scale=d3.scaleTime().domain([e,t]).range([0,this.rangeMaxValue]),this.value={min:i||e,max:a||t},this.setValue(this.value)}return r.prototype.getScaledValue=function(){return this.scaledValue},r.prototype.setValue=function(e){z.fF.assert("Value can't be null"),z.fF.assert(function(){return null!=e.min},"Min can't be null"),z.fF.assert("Max can't be null"),this.value=e,this.scaledValue={min:this.scale(e.min),max:this.scale(e.max)}},r.prototype.getValue=function(){return this.value},r.prototype.setScaledValue=function(e){var t=this;z.fF.assert(function(){return e.min<=t.rangeMaxValue&&e.min>=0&&e.max>=0&&e.max<=t.rangeMaxValue&&e.max>=e.min},"Value is out of range"),this.scaledValue=e,this.value={min:(0,B.Fg)(this.scale.invert(e.min)),max:(0,B.Fg)(this.scale.invert(e.max))}},r}(),ae=function(){function r(e,t,i,a){z.fF.assert(function(){return t>=e},"Requires max to be bigger than or equal to min."),z.fF.assert(function(){return(!i||i>=e)&&(!a||a<=t)},"Specified value is out of boundaries"),this.rangeMaxValue=t,this.scale=d3.scaleLinear().domain([e,t]).range([e,this.rangeMaxValue]),this.value={min:void 0===i?e:i,max:void 0===a?t:a},this.setValue(this.value)}return r.prototype.getScaledValue=function(){return this.scaledValue},r.prototype.setValue=function(e){z.fF.assertValue(e,"Value can't be null"),z.fF.assertValue(e.min,"Min can't be null"),z.fF.assertValue(e.max,"Max can't be null"),this.value=e,this.scaledValue={min:this.scale(e.min),max:this.scale(e.max)}},r.prototype.getValue=function(){return this.value},r.prototype.setScaledValue=function(e){var t=this;z.fF.assert(function(){return e.min<=t.rangeMaxValue&&e.min>=0&&e.max>=0&&e.max<=t.rangeMaxValue&&e.max>=e.min},"Value is out of range"),this.scaledValue=e,this.value={min:this.scale.invert(e.min),max:this.scale.invert(e.max)}},r}(),be=function(){function r(e,t,i,a){z.fF.assert("Requires max to be bigger than or equal to min."),z.fF.assert(function(){return(!i||i>=e)&&(!a||a<=t)},"Specified value is out of boundaries"),this.value={min:void 0===i?e:i,max:void 0===a?t:a}}return r.prototype.getScaledValue=function(){return this.value},r.prototype.setValue=function(e){z.fF.assertValue(e,"Value can't be null"),z.fF.assertValue(e.min,"Min can't be null"),z.fF.assertValue(e.max,"Max can't be null"),this.value=e},r.prototype.getValue=function(){return this.value},r.prototype.setScaledValue=r}(),ne=S(20907),ge_rangeSlicer={iconBreakpoints:[{height:1/0,width:75},{height:28,width:1/0},{height:63,width:162}],hideHeaderHeightNoSlider:48,hideHeaderHeightSlider:88},ge_horizontalSlicer={iconBreakpoints:[{height:1/0,width:75},{height:15,width:1/0}],hideHeaderHeight:48,fontSize:[{breakpoint:360,applyWidth:!0,applyHeight:!1,maxFontSizePt:9},{breakpoint:540,applyWidth:!0,applyHeight:!1,maxFontSizePt:16}]},ge_slicerHeader_fontSize=[{breakpoint:140,applyWidth:!0,applyHeight:!0,maxFontSizePt:9},{breakpoint:220,applyWidth:!0,applyHeight:!0,maxFontSizePt:16},{breakpoint:320,applyWidth:!0,applyHeight:!1,maxFontSizePt:24},{breakpoint:460,applyWidth:!0,applyHeight:!1,maxFontSizePt:32}],De=function(){function r(){}return r.fixWidgetPosition=function(e,t,i,a,n){if(void 0===i&&(i=null),void 0===a&&(a=!1),void 0===n&&(n=null),e&&t){var c="",g="",E="",P="",H="",G=r.getScale(t),le=t.get(0),X=e.offsetParent(),ce=r.getScale(X);a&&e.css({transform:"scale(".concat(G,")")});var fe=le.getBoundingClientRect();if(null==n&&(n=r.getWidgetPosition(fe)),1==(1&n)?(c=(fe.top+fe.height)/ce,H="top"):(E=(window.innerHeight-fe.top)/ce,c="auto",H="bottom"),2==(2&n))r.isWidgetPositionExceedsBoundaries(e,G,P=fe.left/ce)&&(P=window.innerWidth-e.innerWidth()*G),H="left ".concat(H);else{var Et=window.innerWidth-fe.left-fe.width;P="auto",r.isWidgetPositionExceedsBoundaries(e,G,g=Et/ce)&&(g=window.innerWidth-e.innerWidth()*G),H="right ".concat(H)}var mt={left:P,top:c,right:g,bottom:E,"transform-origin":H};i&&("auto"!==mt.top?mt.top+=i.top*G:mt.bottom+=i.top*G,"auto"!==mt.left?mt.left+=i.left*G:mt.right+=i.left*G),e.css(mt)}},r.getScale=function(e){if(!e)return 1;var t=e.outerWidth();return 0===t?1:e.get(0).getBoundingClientRect().width/t},r.isWidgetPositionExceedsBoundaries=function(e,t,i){return e.innerWidth()*t+i>window.innerWidth},r.getWidgetPosition=function(e){var t=3,i=window.innerHeight,a=window.innerWidth;return i-e.top<i/2&&(t&=-2,t|=0),a-e.left<a/2&&(t&=-3,t|=4),t},r}();function Ve(r,e){for(var t=ne.PR,i=0,a=e;i<a.length;i++){var n=a[i];if(r.width<n.breakpoint&&n.applyWidth||r.height<n.breakpoint&&n.applyHeight){t=n.maxFontSizePt;break}}return t}var Re=S(61374),Ge=S(63446),Je=S(24356),Oe=S(26621),ie=S(29925),We=((0,ie.CH)("date-slicer-datepicker"),(0,ie.CH)("date-slicer-datepicker-wrapper"),(0,ie.CH)("date-slicer-input")),rt="drag-resize-disabled",yt=[D.e4,D.bb,D.vX],J=S(59317),Mt=function(){function r(e){e&&(this.preventVirtualKeyboardOnTheFirstTap=e.preventVirtualKeyboardOnTheFirstTap,this.featureSwitches=e.featureSwitches),this.culture=Oe.dx.getCurrentCulture(),this.inputElements=[],this.eventsHelper=new J.PB;var t=this.hostServices=e.hostServices;this.startInputLabel=t.getLocalizedString("Slicer_StartLabel"),this.endInputLabel=t.getLocalizedString("Slicer_EndLabel")}return r.prototype.createRange=function(e){return new j(e.bounds.min,e.bounds.max,e.value.min,e.value.max)},r.prototype.getSliderOptions=function(e,t){return{min:0,max:C(e.bounds.max,e.bounds.min),step:1}},r.prototype.areEqual=function(e,t){return function(r,e){return null==r&&null==e||null!=r&&null!=e&&r.getTime()===e.getTime()}(e,t)},r.prototype.defaultValue=r.prototype.startProperty=function(){return p.gO.data.startDate},r.prototype.endProperty=function(){return p.gO.data.endDate},r.prototype.formatValue=r.prototype.parseSingleSliderValue=function(e,t){return null},r.prototype.inputStyleProperties=function(){return{background:p.gO.date.background,fontColor:p.gO.date.fontColor,textSize:p.gO.date.textSize,fontFamily:p.gO.date.fontFamily,bold:p.gO.date.bold,italic:p.gO.date.italic,underline:p.gO.date.underline}},r.prototype.parseInput=r.prototype.isInputValid=function(e,t,i,a){return!(null==e||0===i&&e>t.max||1===i&&e<t.min)},r.prototype.setRange=function(e,t,i,a,n,c){null==n?(this.featureSwitches.useModernDatePickerSlicer||(i.val(Oe.dx.formatValue(e.min,"d")),a.val(Oe.dx.formatValue(e.max,"d"))),i.attr("aria-label",(0,Re.W)(this.startInputLabel,Oe.dx.formatValue(c.min,"d"),Oe.dx.formatValue(e.max,"d"))),a.attr("aria-label",(0,Re.W)(this.endInputLabel,Oe.dx.formatValue(e.min,"d"),Oe.dx.formatValue(c.max,"d")))):0===n?(this.featureSwitches.useModernDatePickerSlicer||i.val(Oe.dx.formatValue(e.min,"d")),i.attr("aria-label",(0,Re.W)(this.startInputLabel,Oe.dx.formatValue(c.min,"d"),Oe.dx.formatValue(c.max,"d")))):1===n&&(this.featureSwitches.useModernDatePickerSlicer||a.val(Oe.dx.formatValue(e.max,"d")),a.attr("aria-label",(0,Re.W)(this.endInputLabel,Oe.dx.formatValue(c.min,"d"),Oe.dx.formatValue(c.max,"d"))))},r.prototype.enumerateObjectInstances=function(e,t,i){var a;if("date"===e.objectName&&t&&t.inputStyle){var n=p.gO.date;return[{selector:null,objectName:"date",properties:(a={fontColor:t.inputStyle.fontColor,background:t.inputStyle.background,textSize:t.inputStyle.textSize,fontFamily:t.inputStyle.fontFamily},a[n.bold.propertyName]=t.inputStyle.labelBold,a[n.italic.propertyName]=t.inputStyle.labelItalic,a[n.underline.propertyName]=t.inputStyle.labelUnderline,a)}]}},r.prototype.getValuesCard=function(e,t){var i=this,a=p.gO.date,n=new U.CQ(new U.lg("values"),"Role_DisplayName_Values",[a.fontFamily,a.textSize,a.fontColor,a.background,a.bold,a.italic,a.underline],function(E){return i.hostServices.getLocalizedString(E)}),g=(new U.UN).withFontFamily({descriptor:a.fontFamily,value:e.inputStyle.fontFamily}).withFontSizeProperties({descriptor:a.textSize,value:e.inputStyle.textSize}).withBold({descriptor:a.bold,value:e.inputStyle.labelBold}).withItalic({descriptor:a.italic,value:e.inputStyle.labelItalic}).withUnderline({descriptor:a.underline,value:e.inputStyle.labelUnderline}).build();return n.addGroup("values",function(E){E.withDisplayName("Role_DisplayName_Values"),E.addCompositeSlice("fontselector","Font",g),E.addSimpleSlice("color",function(){return new U.BT({descriptor:a.fontColor,value:{value:e.inputStyle.fontColor}}).build()})}).addGroup("background",function(E){E.withDisplayName("Visual_Background").addSimpleSlice("color",function(){return new U.BT({descriptor:a.background,value:{value:e.inputStyle.background}}).build()})}),n.build()},r.prototype.getDataPointsForSingleValueRange=r.prototype.createInputElement=function(e,t){var i=this,a=this.culture.calendar.patterns.d,n=(0,de.ze)().attr("type","text").attr(rt,"true").prop("readonly",!!this.preventVirtualKeyboardOnTheFirstTap).attr("placeholder",a).addClass(We.class).appendTo(e);e.attr("tabindex","0"),e.keydown(,n.datepicker({showOtherMonths:!0,selectOtherMonths:!0,changeMonth:!0,changeYear:!0,nextText:"",prevText:"",firstDay:this.culture.calendar.firstDay,dayNamesMin:this.culture.calendar.days.namesAbbr,dateFormat:this.culture.calendar.patterns.d.replace("yyyy","yy").toLowerCase(),monthNamesShort:this.culture.calendar.months.names,onClose:),n.on("click",function(g){i.preventVirtualKeyboardOnTheFirstTap&&n.is("[readonly]")&&(n.prop("readonly",!1),n.blur()),n.datepicker("show")}),this.preventVirtualKeyboardOnTheFirstTap&&n.on("touchstart",function(g){!n.is("[readonly]")&&!n.is(":focus")&&n.focus()});var c=n.datepicker("widget");return c.attr("prevent-focus-loss","false"),n.attr("prevent-focus-loss","false"),n.datepicker("option","beforeShow",function(){c.addClass("themeableElement"),i.unregisterPopupHideEvents=i.eventsHelper.onPopupHideEvent(function(g,E){i.onPopupHideEvent(g,E)},e.get(0)),i.fixLayout(c,n,1e3)}),this.inputElements.push(n),n},r.prototype.onPopupHideEvent=function(e,t){if("resize"!==e){var i=$(t);!i.hasClass("hasDatepicker")&&!i.hasClass("ui-datepicker")&&!i.hasClass("ui-icon")&&!$(i).closest(".ui-datepicker").length&&this.hideDatepicker()}else this.hideDatepicker()},r.prototype.hideDatepicker=function(){this.unbindPopupHideEventHandlers();for(var e=0,t=this.inputElements;e<t.length;e++){var i=t[e];i.datepicker("widget").is(":visible")&&i.datepicker("hide").blur()}},r.prototype.onDestroy=r.prototype.unbindPopupHideEventHandlers=r.prototype.fixLayout=function(e,t,i){var a=this;setTimeout(function(){e.is(":visible")?(De.fixWidgetPosition(e,t,null,!0),e.find(".ui-datepicker-current-day").addClass("backgroundToForegroundColor")):i>0&&a.fixLayout(e,t,i-20)},20)},r.prototype.filterExpr=function(e){var t=(0,Ge.VM)(e);return{lower:(0,Je.CQ)(t.min),upper:(0,Je.CQ)(t.max)}},r.prototype.comparisonKind=function(){return{lower:2,upper:3}},r.prototype.addAriaDescription=function(e){var t=this.culture.calendar.patterns.d,i=Oe.dx.format(this.hostServices.getLocalizedString("DateSlicer_InputTextHint"),[t]);e.attr("aria-description",i)},r}(),Pt=S(21464),nt=S(30326),Te=S(98801),Ze=S(87810),lt=S(44883),Ct=S(51912),qe=S(3018),bt=S(32178),et=S(90016),pt="aria-expanded",wt="focused",Rt=function(){function r(e,t){var i=this;this.DefaultRestatementColorName="foregroundDark",this.verticalSlicerRenderer=e,this.popup=$("<div ></div>").addClass("slicer-dropdown-popup"),bt.M.isIOSWebView()&&this.popup.addClass(J.M7.class),this.popup.on("slicer.dataPointSelected",,this.content=$("<div ></div>").addClass("slicer-dropdown-content"),this.loader=$("<div ></div>").addClass("slicer-dropdown-loader"),this.hostServices=t.hostServices,this.controlId="slicer-dropdown-popup-".concat(et.b$.generateGuid()),this.popup.addClass("visual").addClass("themeableElement").attr("focus-nav-mode","Group").attr("id",this.controlId).keydown(function(a){27!==a.keyCode||i.popup.is(":hidden")?9===a.keyCode&&!i.popup.is(":hidden")&&(i.hidePopup(),nt.IK.focus(Pt.m.getFocusNextElement(!0,i.menu.get(0))),a.preventDefault(),a.stopPropagation()):(i.hidePopup(),i.menu.focus(),a.preventDefault(),a.stopPropagation())}),$("body").append(this.popup),this.popup.append(this.content),this.popup.append(this.loader),this.featureSwitches=t.featureSwitches,this.eventsHelper=new J.PB}return r.prototype.onClear=function(e){this.verticalSlicerRenderer.onClear(e)},r.prototype.onModeChange=r.prototype.onDataViewObjectChanged=function(e,t){var i=(0,J.tm)(e,t);return z.fF.assertNonEmpty(i,"There should be at least one save object"),i},r.prototype.hasSlider=function(){return!1},r.prototype.supportsOrientation=function(){return!1},r.prototype.enumerateObjectInstances=r.prototype.getValuesCard=r.prototype.getSlicerSettingsCardOptions=r.prototype.getAdditionalCards=function(){return this.verticalSlicerRenderer.getAdditionalCards()},r.prototype.init=function(e,t){return this.container=t,this.style=e.visualInitOptions.style,this.slicerSelectionHandler=this.verticalSlicerRenderer.init(e,this.content),this.slicerSelectionHandler},r.prototype.onDestroy=function(){this.verticalSlicerRenderer&&this.verticalSlicerRenderer.onDestroy(),this.unbindPopupHideEventHandlers(),this.popup.remove()},r.prototype.render=function(e){this.options=e,this.data=this.verticalSlicerRenderer.converter(this.options.dataView,this.options.isSlicer),this.slicerSelectionHandler.setSelected(this.data.retainedDataPoints),this.renderMenu(this.data.restatement),this.isExpanded?this.showPopup(this.setFocus,!0):this.hidePopup()},r.prototype.renderMenu=function(e){var t,i=this;if(this.menu||(this.menu=(0,de.hi)(),this.menu.addClass("slicer-dropdown-menu"),this.menu.attr(((t={role:"combobox","aria-haspopup":"listbox",tabindex:"0","aria-controls":this.controlId})[pt]="false",t[rt]="true",t)),this.container.append(this.menu),this.menu.on("click touchstart keydown",function(g){i.focusEventType=g.type,g.preventDefault(),("click"===g.type||"touchstart"===g.type||40===g.keyCode&&!g.ctrlKey||38===g.keyCode&&!g.ctrlKey||32===g.keyCode||13===g.keyCode)&&i.onRenderMenuClick(g,!0)}),this.restatement=(0,de.hi)(),this.restatement.addClass("slicer-restatement"),this.menu.append(this.restatement),this.icon=$("<i ></i>").addClass("dropdown-chevron"),this.icon.appendTo(this.menu)),this.menu.attr({"aria-label":this.options.restatement}),this.icon.addClass("powervisuals-glyph"),this.icon.addClass("chevron-down"),this.settings=this.defaultRestatementSetting(),this.options.dataView.metadata&&this.options.dataView.metadata.objects){var a=this.options.dataView.metadata.objects,n=Te.v.create(this.style),c=(0,Ze.Zi)((0,o.RK)(a,"items"),{color:"fontColor",family:"fontFamily",size:"textSize"},n,this.style,"foregroundNeutralSecondary","lightLabel",{color:this.settings.fontColor,family:this.settings.fontFamily,size:lt.B.createFromPt(this.settings.textSize)});this.settings.fontColor=c.color,this.settings.fontFamily=c.family,this.settings.textSize=c.size.pt,this.settings.background=n.getColorForPropertyWithDefaultColor(a,p.gO.items.background,this.settings.background),this.strictSingleSelect=(0,o.NA)(a,p.gO.selection.strictSingleSelect,this.strictSingleSelect)}this.restatement.text(e),this.menu.css({"background-color":this.settings.background||"",color:this.settings.fontColor,"font-size":ne.FP.fromPointToPixel(this.settings.textSize),"font-family":this.settings.fontFamily}),this.popup.css({"background-color":this.settings.background||""})},r.prototype.onRenderMenuClick=function(e,t){if(e.stopPropagation(),this.popup.is(":hidden"))return this.isExpanded=!0,this.setFocus=t,this.hostServices.setShouldDeferData(!1),this.loader.css({"background-color":this.settings.background||""}),this.loader.show(),this.popup.addClass(wt),void this.showPopup(!1,!1);this.popup.removeClass(wt),this.hidePopup()},r.prototype.showPopup=function(e,t){var i=this;window.requestAnimationFrame(function(){if(i.popup){i.unbindPopupHideEventHandlers();var a=i.menu.width()+10;i.popup.css({width:a}),i.menu.attr(pt,"true"),i.icon.removeClass("chevron-down"),i.icon.addClass("chevron-up"),De.fixWidgetPosition(i.popup,i.menu,null,!0),t&&i.verticalSlicerRenderer.renderVerticalSlicer(i.data,i.options,function(){i.loader.hide(),i.focusCallbackTimeout&&window.clearTimeout(i.focusCallbackTimeout),i.focusCallbackTimeout=window.setTimeout(function(){e&&nt.IK.focusChildInGroup(i.popup.get(0),"keydown"===i.focusEventType),i.focusCallbackTimeout=void 0,i.setFocus=!1,i.focusEventType=void 0},0)}),i.unregisterPopupHideEvents=i.eventsHelper.onPopupHideEvent(function(c,g){i.onPopupHideEvent(c,g)},i.menu.get(0),i.popup.get(0),!0),i.popup.show()}})},r.prototype.hidePopup=function(){this.popup&&(this.isResize=!1,this.isExpanded=!1,this.popup.hide(),this.hostServices.setShouldDeferData(!0),this.menu.attr(pt,"false"),this.icon.removeClass("chevron-up"),this.icon.addClass("chevron-down"),this.unbindPopupHideEventHandlers())},r.prototype.onPopupHideEvent=function(e,t){if("resize"!==e){"focusin"===e&&(this.isResize=!1);var i=$(t);if(!(i.parents(".slicer-dropdown-popup").length||i.is(this.menu)||this.menu.find(i).length)){if("scroll"===e)return void De.fixWidgetPosition(this.popup,this.menu,null,!0);this.isResize||this.hidePopup()}}else this.isResize=!0},r.prototype.unbindPopupHideEventHandlers=r.prototype.defaultRestatementSetting=function(){return{textSize:10,fontFamily:qe.Wn.regular.css,fontColor:Te.v.getThemeColor(this.style,this.DefaultRestatementColorName),background:this.style.isHighContrast?Te.v.getThemeColor(this.style,Ct.U):void 0}},r}(),ut=S(14253),T=S(40849),x=(0,ie.CH)("horizontalSlicerContainer"),N=(0,ie.CH)("slicerItemsContainer"),M=(0,ie.CH)("navigationArrow"),k=(0,ie.CH)("left"),se=(0,ie.CH)("right"),he=(0,ie.CH)("isMultiSelectEnabled"),Se=(0,ie.CH)("flexDisplay"),pe=(0,ie.CH)("canScrollRight"),Me=(0,ie.CH)("canScrollLeft"),l=(0,ie.CH)("individualItemContainer"),s=(0,ie.CH)("horizontalImageContainer"),V=(0,ie.CH)("horizontalSlicerImage"),R=(0,ie.CH)("slicerCheckbox"),oe=S(13999),me=S(63718),ue=S(52614),b=S(96102),K_label_marginRight=2,K_label_paddingLeft=8,K_label_paddingRight=8,Be=function(){function r(e,t){this.viewModelAdapter=t,this.textProperties={fontFamily:qe.Wn.regular.css,fontSize:"14px"},e&&(this.horizontalSlicerLayout=e.horizontalSlicerLayout,this.featureSwitches=e.featureSwitches),this.behavior=new me.wV,this.horizontalSlicerLayout||(this.horizontalSlicerLayout=new Ne),this.domHelper=new J.gy,this.dataStartIndex=0,this.searchComponent=new b.v(null==e?void 0:e.hostServices)}return r.prototype.hasSlider=function(){return!1},r.prototype.getDefaultValue=function(){if(this.data&&!_.isEmpty(this.data.defaultValueByLevel))return this.data.defaultValueByLevel[0].value},r.prototype.getIdentityFields=r.prototype.supportsOrientation=function(){return!0},r.prototype.getSlicerSettings=function(e){var t=e&&e.slicerSettings;return t||(t=(0,oe.VT)(this.style)),t},r.prototype.enumerateObjectInstances=function(e){var t=this.originalData,i=this.getSlicerSettings(t);return(0,J.qo)(e,t,i,this.dataView,this.featureSwitches)},r.prototype.getValuesCard=function(){var e=this.originalData,t=this.getSlicerSettings(e);return(0,J.s9)(this.hostServices,e,t,this.featureSwitches)},r.prototype.getSlicerSettingsCardOptions=function(e,t,i,a){var n=this.originalData,c=n?n.slicerSettings:void 0;return c||(c=(0,oe.VT)(this.style)),(0,J.nD)({cardUidBuilder:e,currentSlicerSettings:c,data:n,dataView:this.dataView,hostServices:this.hostServices,orientation:t,activeMode:i,slicerModes:a,featureSwitches:this.featureSwitches})},r.prototype.getAdditionalCards=function(){var e=this.originalData,t=e?e.slicerSettings:void 0;return t||(t=(0,oe.VT)(this.style)),(0,J.oE)(this.hostServices,e,t,this.dataView)},r.prototype.onModeChange=function(e){(0,J.VD)(this.hostServices,e)},r.prototype.onDataViewObjectChanged=function(e,t){var i=(0,J.tm)(e,t);return z.fF.assertNonEmpty(i,"There should be at least one save object"),i},r.prototype.getRestatement=function(){return this.data&&this.data.restatement},r.prototype.onClear=function(e){(0,J.K5)(this.selectionHandler,e)},r.prototype.init=function(e,t){var i=this;this.element=t,this.currentViewport=e.visualInitOptions.viewport;var a=this.hostServices=e.visualInitOptions.host;this.style=e.visualInitOptions.style,this.behavior&&(this.selectionHandler=new ue.N(a,this.behavior)),this.loadMoreData=function(){return e.loadMoreData()};var n=document.createElement("div");n.className=x.class;var c=this.container=d3.select(n);this.searchComponent.create(c);var g=this.body=c.append("div").classed(J.uT.class+" "+Se.class,!0),E={color:Te.v.getThemeColor(this.style,"foregroundNeutralSecondary")},P={color:Te.v.getThemeColor(this.style,"foreground")};this.leftNavigationArrow=g.append("button").call(this.horizontalSlicerLayout.getNavigationArrowsClass,!0).attr("aria-label",this.hostServices.getLocalizedString("Previous_ButtonText")).attr("tabindex",-1).styles(E).on("pointerover",function(){return i.leftNavigationArrow.styles(P)}).on("pointerleave",function(){return i.leftNavigationArrow.styles(E)});var H=this.data&&this.data.slicerSettings.selection.strictSingleSelect;this.itemsContainer=g.append("div").classed(N.class+" "+Se.class,!0).attr("tabindex","0").attr("role","listbox").attr("aria-multiselectable",!H);var G=this.itemsContainer.node();return $(G).on("keydown",function(le){var X=le.keyCode,ce=39===X||40===X;!ce&&37!==X&&38!==X||(i.focusNextElement(ce),le.stopPropagation())}),this.rightNavigationArrow=g.append("button").call(this.horizontalSlicerLayout.getNavigationArrowsClass,!1).attr("aria-label",this.hostServices.getLocalizedString("Next_ButtonText")).attr("tabindex",-1).styles(E).on("pointerover",function(){return i.rightNavigationArrow.styles(P)}).on("pointerleave",,this.element.get(0).appendChild(n),this.bindNavigationEvents(),this.selectionHandler},r.prototype.render=function(e){this.hasSearchableData=e.hasSearchableData;var t=this.hostServices.getLocalizedString(J.vx),i=e.dataView;if(this.originalData=this.data=(0,oe.OQ)({dataView:i,localizedSelectAllText:t,selectionHandler:this.selectionHandler,hostServices:this.hostServices,style:this.style,isSlicer:e.isSlicer,featureSwitches:this.featureSwitches,slicerType:1}),this.viewModelAdapter&&(this.data=this.viewModelAdapter.applyChanges(e.viewport,this.originalData,i)),this.updateItemsContainerLabel(),this.updateStyle(this.hasSearchableData),!i||!this.data||_.isEmpty(this.data.slicerDataPoints))return this.itemsContainer.selectAll("*").remove(),void(this.itemsToDisplay=0);this.dataView=i,(!(this.currentViewport&&e.viewport&&(this.currentViewport.height!==e.viewport.height||this.currentViewport.width!==e.viewport.width))||this.isMaxDimensionsNeedsReCalculate())&&this.calculateAndSetMaxItemDimensions(),this.currentViewport=e.viewport,this.itemsToDisplay=this.horizontalSlicerLayout.calculateNumberOfItemsToDisplay(this.element,this.totalItemWidth,this.totalItemHeight,this.getDataPointsCount()),0!==this.itemsToDisplay&&this.renderCore()},r.prototype.renderCore=function(){this.horizontalSlicerLayout.renderCore&&this.horizontalSlicerLayout.renderCore(this.container);var e=this.data;if(e&&e.slicerDataPoints){this.normalizePosition();var t=this.getDataPointsCount(),i=this.itemsToDisplay,a=this.dataStartIndex,n=a+this.itemsToDisplay<=t-1,c=a>0,g=this.container.classed(pe.class)&&!n&&document.activeElement===this.rightNavigationArrow.node(),E=this.container.classed(Me.class)&&!c&&document.activeElement===this.leftNavigationArrow.node();(g||E)&&this.itemsContainer.node().focus(),this.container.classed(pe.class,n),this.container.classed(Me.class,c),this.renderItems(e.slicerSettings),this.bindInteractivityService(),a+i>=.8*t&&this.loadMoreData()}},r.prototype.updateStyle=function(e){var t=this.data,i=t&&t.slicerSettings,n=b.v.fromSlicerSettings(i,null==t?void 0:t.searchKey,e&&i.search.enabled,!1,this.featureSwitches);this.searchComponent.update(n),i&&this.container.classed(he.class,!i.selection.singleSelect)},r.prototype.renderItems=function(e){var t=this,i=this.itemsToDisplay;z.fF.assert("items to display should be greater than zero");var a=this.dataStartIndex,n=this.data.slicerDataPoints.slice(a,a+i),c=this.horizontalSlicerLayout.bindData(n,this.data,this.itemsContainer),g=c.enter().append("div").classed(l.class,!0).classed("containerBackground",!e.items.accessibilityContrastProperties).classed("containerBackgroundContrast",e.items.accessibilityContrastProperties).attr("role","option").attr("tabindex",0).each(function(H){var G=d3.select(this);if(H.isImage){var le=G.append("div").classed(s.class,!0);le.append("div").classed(R.class,!0).append("input").attr("type","checkbox"),le.append("img").classed(V.class,!0)}else G.append("div").classed(J.NV.class,!0).classed(Se.class,!0)}).merge(c),E=this;g.each(function(H){var G=d3.select(this);(0,J.hx)(G,H),G.attr("aria-label",(0,J.rX)(E.hostServices,H.tooltip)).attr("aria-setsize",-1).attr("aria-posinset",H.levelIndex?H.levelIndex:1)}),g.attr("aria-selected",,g.order(),g.select(J.NV.selector).styles({"padding-left":ne.FP.toString(K_label_paddingLeft),"padding-right":ne.FP.toString(K_label_paddingRight)}),g.styles({"margin-right":),this.domHelper.setSlicerTextStyle(g,e,this.featureSwitches),c.exit().remove(),this.animationFrameId&&window.cancelAnimationFrame(this.animationFrameId),this.animationFrameId=window.requestAnimationFrame(function(){g.select("img").attr("title",function(ce){return(0,J.rX)(t.hostServices,ce.tooltip)}).attr("src",function(ce){return ce.value}),g.select(J.NV.selector).attr("title",function(ce){return(0,J.rX)(t.hostServices,ce.tooltip)}).text(function(ce){return ce.value});var H=t.element.find(J.NV.selector),G=H.first(),le=G.height(),X=G.width();H.each(})},r.prototype.bindInteractivityService=function(){if(this.selectionHandler&&this.body){var i=this.body.selectAll(l.selector),a=this.data,n=this.searchComponent.input;if(!n.empty()){var c=n.node();(_.isEmpty(c.value)||_.isEmpty(a.searchKey))&&n.property("value",a.searchKey)}this.selectionHandler.bind(a.retainedDataPoints,{behaviorOptions:{slicerContainer:this.container,itemsContainer:i,settings:a.slicerSettings,searchInput:n,style:this.style},orientation:1})}this.behavior.renderSelection()},r.prototype.normalizePosition=function(){var e=this.getDataPointsCount(),t=this.horizontalSlicerLayout.getLastStartIndex(this.itemsToDisplay,e);this.dataStartIndex=et.b$.clampValue(this.dataStartIndex,0,t)},r.prototype.bindNavigationEvents=r.prototype.registerMouseClickEvents=function(){var e=this,t=this.container.selectAll(se.selector),i=this.container.selectAll(k.selector);t.on("click",function(){e.scrollRight()}),i.on("click",},r.prototype.registerMouseWheelScrollEvents=function(){var e=this,t=this.body.node();t.addEventListener("mousewheel",function(i){e.onMouseWheel(i.wheelDelta)}),t.addEventListener("DOMMouseScroll",},r.prototype.onMouseWheel=function(e){e<0?this.scrollRight():e>0&&this.scrollLeft()},r.prototype.scrollRight=function(){var e=this.horizontalSlicerLayout.getLastStartIndex(this.itemsToDisplay,this.getDataPointsCount());this.dataStartIndex!==e&&(this.dataStartIndex+=this.horizontalSlicerLayout.getScrollSize(this.itemsToDisplay),this.dataStartIndex=Math.min(this.dataStartIndex,e),this.renderCore())},r.prototype.scrollLeft=function(){0!==this.dataStartIndex&&(this.dataStartIndex-=this.horizontalSlicerLayout.getScrollSize(this.itemsToDisplay),this.dataStartIndex=Math.max(this.dataStartIndex,0),this.renderCore())},r.prototype.getScaledTextWidth=r.prototype.isMaxDimensionsNeedsReCalculate=function(){if(!this.lastCalculatedProperties)return!0;var e=this.data.slicerSettings,i=e.slicerText,E=this.lastCalculatedProperties;return E.textSize!==i.textSize||E.fontFamily!==i.fontFamily||E.outline!==i.outline||E.outlineStyle!==i.outlineStyle||E.outlineWeight!==e.general.outlineWeight||E.hasImage!==this.data.hasImages},r.prototype.calculateAndSetMaxItemDimensions=function(){var P,H,e=this.data,t=this.data.slicerSettings,i=this.getDataPointsCount(),a=0,n=0,c=t.slicerText.outline,g=t.slicerText.outlineStyle,E=t.general.outlineWeight;if(0===i)a=0,n=0;else if(e.hasImages)a=100,n=100;else{var G=e.slicerDataPoints,le=Math.min(i,50),X=jQuery.extend(!0,{},this.textProperties);H=t.slicerText.fontFamily,X.fontSize=ne.FP.fromPoint(P=t.slicerText.textSize),X.fontFamily=H,X.text="Sample";for(var ce=T.bY,fe=ut.b.measureSvgTextHeight(X),ze=0;ze<le;ze++){var $e=G[ze].value;X.text=$e,a=Math.max(a,ce($e,ut.b.measureSvgTextWidth,X));var Ye=Math.min(2,(0,T.iD)($e));n=Math.max(n,fe*Ye)}a=Math.min(a,this.getScaledTextWidth(P))}var Et=K_label_paddingLeft+K_label_paddingRight+K_label_marginRight,Gi=this.domHelper.getRowsOutlineWidth(this.featureSwitches.outlineDropdownToCheckboxes?g:c,E);this.totalItemWidth=a+Et+Gi,this.totalItemHeight=n+Et+Gi;var Ji=this.horizontalSlicerLayout.calculateTotalItemDimensions(this.totalItemWidth,this.totalItemHeight);this.totalItemWidth=Ji.width,this.totalItemHeight=Ji.height,this.lastCalculatedProperties={outline:c,outlineStyle:g,outlineWeight:E,textSize:P,fontFamily:H,hasImage:e.hasImages}},r.prototype.focusNextElement=function(e){var t=this.horizontalSlicerLayout.findNextElement(document.activeElement,e);if(!t){e?this.scrollRight():this.scrollLeft();var i=this.itemsContainer.node(),a=document.activeElement;i.contains(a)||(a=i),t=this.horizontalSlicerLayout.findNextElement(a,e)}t&&t.focus()},r.prototype.updateItemsContainerLabel=function(){var e;null!==(e=this.data)&&void 0!==e&&e.categorySourceName&&this.itemsContainer.attr("aria-label",this.data.categorySourceName),this.itemsContainer.attr("aria-multiselectable",!(this.data&&this.data.slicerSettings.selection.strictSingleSelect))},r.prototype.getDataPointsCount=r.prototype.addWarnings=function(e){(0,J.td)(this.data.warnings,e)},r}(),Ne=function(){function r(){}return r.prototype.bindData=function(e,t,i){return i.selectAll(l.selector).data(e,function(n){return(0,J.fz)(n)})},r.prototype.calculateTotalItemDimensions=r.prototype.calculateNumberOfItemsToDisplay=function(e,t,i,a){var c=e.find(J.uT.selector).width()-2*r.NavigationArrowWidth;if(0===t)return 0;var g=Math.round(c/t);return et.b$.clampValue(g,1,a)},r.prototype.findNextElement=function(e,t){return $(e).hasClass(N.class)?t?e.firstElementChild:void 0:t?e.nextElementSibling:e.previousElementSibling},r.prototype.getNavigationArrowsClass=function(e,t){t?e.classed(M.class,!0).classed(k.class,!0):e.classed(M.class,!0).classed(se.class,!0)},r.prototype.getScrollSize=r.prototype.getLastStartIndex=r.prototype.getDataPointRightMargin=function(e,t){return this.isLastRowItem(e,t)?"0px":ne.FP.toString(K_label_marginRight)},r.prototype.isLastRowItem=r.NavigationArrowWidth=19,r}(),Xe=function(){eturn r.prototype.execute=function(e){if(this.$select.selectmenu("instance"))return this.$select.selectmenu(e)},r}(),at=function(){function r(e){this.isOpened=!1,z.fF.assertValue(e.container,"container"),this.settings=e,this.init(),this.applyStyles(),this.setValue(this.settings.selectedValue)}return r.prototype.destroy=function(){this.selectMenu.execute("destroy")},r.prototype.update=function(e){_.extend(this.settings,e),r.populateOptions(this.$select,this.settings.options),null!=this.settings.selectedValue&&this.setValue(this.settings.selectedValue),this.refresh(),this.applyStyles(),this.applyState()},r.prototype.disableOption=function(e){for(var t=this.$select.find("option"),i=0;i<t.length;i++){var a=t[i];a.getAttribute("value")===e&&a.setAttribute("disabled","true")}this.refresh()},r.prototype.enableOption=function(e){for(var t=this.$select.find("option"),i=0;i<t.length;i++){var a=t[i];a.getAttribute("value")===e&&a.setAttribute("disabled","false")}this.refresh()},r.prototype.close=r.prototype.setValue=r.prototype.init=function(){var t,i,e=this;this.$select=(0,de.Ys)(),this.$select.attr("drag-resize-disabled","true").appendTo(this.settings.container),r.populateOptions(this.$select,this.settings.options),this.$select.selectmenu({open:function(){e.isOpened=!0,De.fixWidgetPosition(e.menuWidget,e.widget,{left:-0,top:0},!0)},select:function(n){n.stopPropagation()},width:"auto",close:function(n){e.isOpened=!1,27===n.keyCode&&(n.stopPropagation(),n.preventDefault())}}),this.selectMenu=new Xe(this.$select),this.settings.onChange&&this.$select.on("selectmenuchange",,this.applyState(),this.widget=this.selectMenu.execute("widget"),this.settings.title&&this.widget.attr("aria-label",this.settings.title),this.widget.attr("role","combobox").removeAttr("aria-autocomplete"),this.widget.on("keydown",function(a){(40===a.keyCode||38===a.keyCode||37===a.keyCode||39===a.keyCode)&&(e.isOpened||e.selectMenu.execute("open"),a.stopPropagation()),a.preventDefault()}),this.menuWidget=null===(t=this.selectMenu.execute("menuWidget"))||void 0===t?void 0:t.parent(),null===(i=this.menuWidget)||void 0===i||i.addClass(this.settings.className+" themeableElement highContrastBorder")},r.prototype.applyState=function(){this.selectMenu.execute(this.settings.disabled?"disable":"enable")},r.prototype.applyStyles=r.prototype.refresh=r.prototype.updateAria=function(){var e=this;setTimeout(function(){if(e.settings.title)e.widget.removeAttr("aria-labelledby");else{var t=e.widget.attr("id"),i=e.widget.attr("aria-labelledby").replace(t,"").trim();e.widget.attr("aria-labelledby",i+" "+t)}var a=e.widget.attr("aria-owns");null!=a&&(e.widget.attr("aria-controls",a),e.widget.removeAttr("aria-owns")),e.widget.attr("aria-haspopup")&&e.widget.attr("aria-haspopup","listbox"),e.widget.removeAttr("title"),e.widget.find(".ui-selectmenu-icon").attr("aria-hidden","true"),e.updateMenuItemAria()})},r.prototype.updateMenuItemAria=function(){var e=this;this.menuWidget.find(".ui-menu-item").each(function(i,a){var n=$(a);n.attr("role","none");var c=n.find(".ui-menu-item-wrapper");n.hasClass("ui-state-disabled")&&(c.attr("aria-disabled","true"),n.removeAttr("aria-disabled"));var g=e.menuWidget.find(".ui-menu").attr("aria-activedescendant");c.attr("aria-selected",function(){return c.attr("id")===g?"true":"false"})})},r.populateOptions=function(e,t){e.find("option").remove();for(var i=0,a=t;i<a.length;i++){var n=a[i];$("<option ></option>").attr("value",n.value).text(n.text).appendTo(e)}},r}(),Ie=S(25377),_e=S(5328),Tt=S(11763),xt=S(13106),tt=function(){function r(){}return r.prototype.getVisualObjectInstance=r.prototype.appendVisualSlices=function(e,t){null!=t.includeToday&&e.addSimpleSlice("includeToday",function(){return new U.bd({descriptor:p.gO.dateRange.includeToday,value:t.includeToday}).build()}),e.addSimpleSlice("anchorDate",function(){return new U.hz({descriptor:p.gO.dateRange.anchorDate,value:t.anchorDate,placeholder:""}).build()})},r.prototype.getMode=function(){return D.K8},r.prototype.getRelativePropertyId=function(){return p.gO.data.relativePeriod},r.prototype.getListOfOptions=function(){return Ie.GA.members()},r.prototype.getSelectedPeriodOption=function(e){return z.fF.assert(function(){return!(0,Re.g)(e.period)},"The period should be defined"),Ie.GA.members([e.period])[0]},r.prototype.getPeriods=function(e){var t=e.range!==_e.Vk?Ie.GA.members():Ie.J6.members();if(e.range===_e.Vk)switch(e.period){case Ie.qQ:e.period=Ie.P4;break;case Ie.ks:e.period=Ie.e7;break;case Ie.$G:e.period=Ie.gQ}return t},r}(),kt=function(){function r(){}return r.prototype.getVisualObjectInstance=function(e){},r.prototype.appendVisualSlices=r.prototype.getMode=r.prototype.getRelativePropertyId=function(){return p.gO.data.relativeTimePeriod},r.prototype.getListOfOptions=function(){return Ie._k.members()},r.prototype.getSelectedPeriodOption=function(e){return z.fF.assert("The period should be defined"),Ie._k.members([e.period])[0]},r.prototype.getPeriods=function(e){return e.range!==_e.Vk?Ie._k.members():Ie.PN.members()},r}();function ft(r){return z.fF.assertValue(r,"data"),{duration:r.duration,includeToday:r.includeToday,relativeUnit:ii(r.period),relativeQualifier:ri(r.range),anchorDate:r.anchorDate}}function ii(r){switch(r){case Ie.LK:return d.hU.Minute;case Ie.i4:return d.hU.Hour;case Ie.an:return d.hU.Day;case Ie.P4:return d.hU.Week;case Ie.qQ:return d.hU.CalendarWeek;case Ie.e7:return d.hU.Month;case Ie.ks:return d.hU.CalendarMonth;case Ie.gQ:return d.hU.Year;case Ie.$G:return d.hU.CalendarYear;default:return void z.fF.assertFail("Unsupported timePeriod: "+r)}}function ri(r){switch(r){case _e.Z$:return d.KO.Last;case _e.Vk:return d.KO.Current;case _e.lp:return d.KO.Next;default:return void z.fF.assertFail("Unsupported qualifier: "+r)}}var Ht="slicer-select-menu",Nt=".ui-selectmenu-button";function oi(r){return{textSize:9,fontFamily:qe.Wn.regular.css,fontColor:Te.v.getThemeColor(r,"foregroundDark"),background:null,labelBold:!1,labelItalic:!1,labelUnderline:!1}}var li=function(){function r(e,t){this.isRendered=!1,this.hostServices=e.hostServices,this.relativeSlicerComponent=function(r){switch(r){case d.wj.Time:return new kt;case d.wj.Date:return new tt;default:return void z.fF.assertFail("Unsupported RelativeFilterType")}}(t)}return r.prototype.init=function(e,t){this.host=t,this.isRendered=!1,this.style=e.visualInitOptions.style,this.eventsHelper=new J.PB},r.prototype.onDestroy=function(){this.unregisterSelectMenuCloseEvents&&this.unregisterSelectMenuCloseEvents(),this.rangeSelectMenu&&this.rangeSelectMenu.destroy(),this.periodSelectMenu&&this.periodSelectMenu.destroy()},r.prototype.hasSlider=function(){return!1},r.prototype.supportsOrientation=function(){return!1},r.prototype.onClear=function(){this.data.range=_e.Z$,this.data.period=Ie.YP,this.data.duration=1,this.data.filter=null,this.renderInternal(),(0,J.VD)(this.hostServices,this.data.mode)},r.prototype.enumerateObjectInstances=function(e,t){var i,a=this.relativeSlicerComponent.getVisualObjectInstance(this.data);if("dateRange"===e.objectName&&a)return[a];if("numericInputStyle"===e.objectName){var n=p.gO.numericInputStyle;return[{selector:null,objectName:"numericInputStyle",properties:(i={fontColor:this.data.inputStyle.fontColor,background:this.data.inputStyle.background,textSize:this.data.inputStyle.textSize,fontFamily:this.data.inputStyle.fontFamily},i[n.bold.propertyName]=this.data.inputStyle.labelBold,i[n.italic.propertyName]=this.data.inputStyle.labelItalic,i[n.underline.propertyName]=this.data.inputStyle.labelUnderline,i)}]}},r.prototype.getValuesCard=function(e){var t=this,i=p.gO.numericInputStyle,a=new U.CQ(new U.lg("values"),"Role_DisplayName_Values",[i.fontFamily,i.textSize,i.fontColor,i.background,i.bold,i.italic,i.underline,p.gO.dateRange.includeToday,p.gO.dateRange.anchorDate],function(g){return t.hostServices.getLocalizedString(g)}),c=(new U.UN).withFontFamily({descriptor:i.fontFamily,value:this.data.inputStyle.fontFamily}).withFontSizeProperties({descriptor:i.textSize,value:this.data.inputStyle.textSize}).withBold({descriptor:i.bold,value:this.data.inputStyle.labelBold}).withItalic({descriptor:i.italic,value:this.data.inputStyle.labelItalic}).withUnderline({descriptor:i.underline,value:this.data.inputStyle.labelUnderline}).build();return a.addGroup("values",function(g){g.withDisplayName("Role_DisplayName_Values"),g.addCompositeSlice("fontselector","Font",c),g.addSimpleSlice("color",function(){return new U.BT({descriptor:i.fontColor,value:{value:t.data.inputStyle.fontColor}}).build()}),t.relativeSlicerComponent.appendVisualSlices(g,t.data)}).addGroup("background",function(g){g.withDisplayName("Visual_Background").addSimpleSlice("color",function(){return new U.BT({descriptor:i.background,value:{value:t.data.inputStyle.background}}).build()})}),a.build()},r.prototype.getSlicerSettingsCardOptions=function(e,t,i,a,n){return(0,J.nD)({cardUidBuilder:e,currentSlicerSettings:void 0,data:void 0,dataView:void 0,hostServices:this.hostServices,orientation:t,activeMode:i,slicerModes:a,featureSwitches:n})},r.prototype.getAdditionalCards=r.prototype.onModeChange=function(e){(0,J.VD)(this.hostServices,e)},r.prototype.onDataViewObjectChanged=function(e,t){var i=(0,J.tm)(e,t);return z.fF.assertNonEmpty(i,"There should be at least one save object"),i},r.converter=function(e,t,i,a){var n={mode:i,range:_e.Z$,period:Ie.YP,duration:1,includeToday:!0,identity:null,anchorDate:void 0,filter:null,inputStyle:oi(t)},c=e.columns.getMetadataColumns(p.CT.value);z.fF.assert("expect to have a metadataColumn"),n.identity=c[0].expr;var E=e.objects.getStaticObjects();if(E){var P=Te.v.create(t);n.filter=(0,o.NA)(E,p.gO.general.filter,n.filter),n.range=(0,o.NA)(E,p.gO.data.relativeRange,n.range),n.period=(0,o.NA)(E,a,n.period),n.duration=Math.abs((0,o.NA)(E,p.gO.data.relativeDuration,n.duration)),n.includeToday=(0,o.NA)(E,p.gO.dateRange.includeToday,n.includeToday),n.anchorDate=(0,o.NA)(E,p.gO.dateRange.anchorDate,n.anchorDate);var H=(0,Ze.Zi)((0,o.RK)(E,"numericInputStyle"),{color:"fontColor",family:"fontFamily",size:"textSize"},P,t,"foregroundDark","smallLabel",{color:n.inputStyle.fontColor,family:n.inputStyle.fontFamily,size:lt.B.createFromPt(n.inputStyle.textSize)});n.inputStyle.fontColor=H.color,n.inputStyle.fontFamily=H.family,n.inputStyle.textSize=H.size.pt,n.inputStyle.background=P.getColorForPropertyWithDefaultColor(E,p.gO.numericInputStyle.background,n.inputStyle.background),n.inputStyle.labelBold=(0,o.NA)(E,p.gO.numericInputStyle.bold,n.inputStyle.labelBold),n.inputStyle.labelItalic=(0,o.NA)(E,p.gO.numericInputStyle.italic,n.inputStyle.labelItalic),n.inputStyle.labelUnderline=(0,o.NA)(E,p.gO.numericInputStyle.underline,n.inputStyle.labelUnderline)}return n},r.prototype.render=function(e){var t=this,i=(0,ye.G)(e.dataView);this.data=r.converter(i,this.style,this.relativeSlicerComponent.getMode(),this.relativeSlicerComponent.getRelativePropertyId()),this.isRendered||(this.initControls(),this.unregisterSelectMenuCloseEvents=this.eventsHelper.onPopupHideEvent(this.selectionContainer.get(0))),this.updateProperties(this.data.range,this.data.period,this.data.duration),this.renderInternal()},r.prototype.onSelectMenuClose=function(e,t){!$(t).hasClass(Ht)&&!$(t).closest(".".concat(Ht)).length&&(this.rangeSelectMenu.close(),this.periodSelectMenu.close())},r.prototype.initControls=function(){var e=this;this.isRendered=!0,this.container=(0,de.hi)().addClass("relative-slicer").appendTo(this.host),this.selectionContainer=(0,de.hi)().addClass("selection-container").appendTo(this.container),this.selectionContainer.on("keyup keydown",function(n){9!==n.keyCode&&27!==n.keyCode&&n.stopPropagation()}),this.rangeSelectMenuContainer=(0,de.hi)().addClass("range-menu").appendTo(this.selectionContainer);var t={onChange:function(c){e.rangeChanged(c)},container:this.rangeSelectMenuContainer,options:this.getSelectMenuOptions(_e.dt.members()),className:Ht,selectedValue:"Select",title:this.hostServices.getLocalizedString("Visual_Axis_Range")};this.rangeSelectMenu=new at(t),this.rangeSelectMenu.update({selectedValue:_e.Z$}),this.durationInput=(0,de.ze)().attr("type","number").attr("min","1").attr("drag-resize-disabled","true").addClass("duration-input").attr("aria-label",this.hostServices.getLocalizedString("Duration")).appendTo(this.selectionContainer),this.durationInput.val(this.data.duration.toString()),this.durationInput.on("change",_.debounce(function(n){e.durationChanged()},100)),this.periodSelectMenuContainer=(0,de.hi)().addClass("period-menu").appendTo(this.selectionContainer);var i=this.relativeSlicerComponent.getListOfOptions(),a={onChange:function(c){e.periodChanged(c)},container:this.periodSelectMenuContainer,options:this.getSelectMenuOptions(i),className:Ht,title:this.hostServices.getLocalizedString("DaxTemplates_PeriodField")};this.periodSelectMenu=new at(a),this.periodSelectMenu.disableOption(Ie.YP),this.updatePeriod(),this.restatementContainer=(0,de.hi)().addClass("restatement-container").appendTo(this.container),this.restatementIcon=$("<i ></i>").addClass("restatement-icon").addClass("pbi-glyph-datetime").appendTo(this.restatementContainer),this.restatement=(0,de.hi)().addClass("restatement").appendTo(this.restatementContainer),this.restatement.text(this.hostServices.getLocalizedString("ExportData_NoAppliedFiltersText"))},r.prototype.updatePeriod=function(){var e=this.relativeSlicerComponent.getPeriods(this.data);this.periodSelectMenu.update({options:this.getSelectMenuOptions(e),selectedValue:this.data.period})},r.prototype.rangeChanged=function(e){this.data.range=e,this.data.range===_e.Vk?(this.durationInput.attr("type","text"),this.durationInput.val("-"),this.durationInput.prop("disabled",!0),this.data.duration=0):("-"===this.durationInput.val()?(this.durationInput.attr("type","number"),this.durationInput.val("1"),this.data.duration=1):this.updateDuration(),this.durationInput.prop("disabled",!1)),this.updatePeriod();var t=this.updateProperties(this.data.range,this.data.period,this.data.duration);this.hostServices.persistProperties(t),this.renderInternal()},r.prototype.periodChanged=function(e){this.updateDuration();var t=this.updateProperties(this.data.range,e,this.data.duration);this.hostServices.persistProperties(t),this.renderInternal()},r.prototype.durationChanged=function(){this.updateDuration();var e=this.updateProperties(this.data.range,this.data.period,this.data.duration);this.hostServices.persistProperties(e),this.renderInternal()},r.prototype.renderInternal=function(){var e=this.relativeSlicerComponent.getSelectedPeriodOption(this.data),t=ne.FP.fromPointToPixel(this.data.inputStyle.textSize),i={"font-size":t,"font-family":this.data.inputStyle.fontFamily,color:this.data.inputStyle.fontColor,"background-color":this.data.inputStyle.background?this.data.inputStyle.background:"","font-weight":this.data.inputStyle.labelBold?ie.en:ie.AI,"font-style":this.data.inputStyle.labelItalic?ie.BF:ie.AI,"text-decoration":this.data.inputStyle.labelUnderline?ie.f0:ie.zu};this.durationInput.css(i),i["font-size"]=t-1,this.restatement.css(i);var a=this.rangeSelectMenuContainer.find(Nt);a.css(i);var c=_e.dt.members([this.data.range])[0].displayName({get:this.hostServices.getLocalizedString.bind(this.hostServices)});a.attr("title",c);var g=this.periodSelectMenuContainer.find(Nt);g.css(i);var E=e.displayName({get:this.hostServices.getLocalizedString.bind(this.hostServices)});g.attr("title",E),this.rangeSelectMenu.update({selectedValue:this.data.range}),this.updatePeriod(),this.periodSelectMenu.disableOption(Ie.YP),0===this.data.duration?(this.durationInput.attr("type","text"),this.durationInput.val("-"),this.durationInput.prop("disabled",!0)):(this.durationInput.attr("type","number"),this.durationInput.prop("disabled",!1),this.durationInput.val(Math.abs(this.data.duration).toString())),this.setRestatement()},r.prototype.updateProperties=function(e,t,i){this.data.range=e;var a=this.data.period!==t;this.data.period=t,this.data.duration=i;var n,c=null;if(this.data.period!==Ie.YP&&(c=this.createFilter()),null!==c||!this.data.filter){var g=c?xt.yl.fromSQExpr(c):null;return(!xt.yl.isSameFilter(g,this.data.filter)||a)&&(n=this.createProperties(g),this.setRestatement()),n}this.onClear()},r.prototype.updateDuration=function(){this.data.range===_e.Vk?this.data.duration=0:this.isDurationValid()&&(this.data.duration=Math.min(parseInt(this.durationInput.val(),10),this.getDurationMax()))},r.prototype.isDurationValid=function(){var e=parseInt(this.durationInput.val(),10);return $.isNumeric(e)&&e>0},r.prototype.getDurationMax=function(){var e=this.data.period!==Ie.YP?this.data.period:Ie.an;return d.t0.getDurationMax(ri(this.data.range),ii(e))},r.prototype.createFilter=function(){var e;if(this.data.identity){var t=ft(this.data);e=(0,Tt.kW)({field:this.data.identity,options:t})}return e},r.prototype.getRelativePropertyName=r.prototype.createProperties=function(e){var t={merge:[],replace:[],remove:[]},i={objectName:"general",selector:null,properties:{}};null!==e?(i.properties[p.gO.general.filter.propertyName]=e,t.merge.push(i)):(i.properties[p.gO.general.filter.propertyName]=!0,t.remove.push(i));var a={objectName:"data",selector:null,properties:{}};if(null!=this.data.mode&&(a.properties[p.gO.data.mode.propertyName]=this.data.mode),null!=this.data.range&&(a.properties[p.gO.data.relativeRange.propertyName]=this.data.range),null!=this.data.duration&&(a.properties[p.gO.data.relativeDuration.propertyName]=this.data.duration),null!=this.data.period){var n=this.getRelativePropertyName();a.properties[n]=this.data.period}t.replace.push(a);var c={objectName:"dateRange",selector:null,properties:{}};return null!=this.data.includeToday&&(c.properties[p.gO.dateRange.includeToday.propertyName]=this.data.includeToday),this.data.anchorDate&&(c.properties[p.gO.dateRange.anchorDate.propertyName]=this.data.anchorDate),t.replace.push(c),this.hostServices.onSelect({type:0,visualObjects:[]}),t},r.prototype.setRestatement=function(){var t,i,a,e=this;if(this.data.period===Ie.YP)this.restatement.text(this.hostServices.getLocalizedString("ExportData_NoAppliedFiltersText"));else{var n=ft(this.data),g=null===(i=null===(t=this.hostServices)||void 0===t?void 0:t.networkAvailability())||void 0===i?void 0:i.isNetworkAvailable();this.restatement.text(d.t0.getRestatement(n,g,null===(a=this.hostServices.visualTimeSynchronization())||void 0===a?void 0:a.getAnchorTime()))}},r.prototype.getSelectMenuOptions=function(e){for(var t=[],i=0,a=e;i<a.length;i++){var n=a[i],c=n.displayName({get:this.hostServices.getLocalizedString.bind(this.hostServices)});t.push({text:c,value:n.value})}return t},r}(),ui=(0,S(49362).i)([{value:D.vX,displayName:function(e){return e.get("Visual_SliderMode_Between")}},{value:D.bb,displayName:function(e){return e.get("Visual_SliderMode_LessThanEqualLabel")}},{value:D.e4,displayName:function(e){return e.get("Visual_SliderMode_GreaterThanEqualLabel")}},{value:D.RB,displayName:function(e){return e.get("Visual_SliderMode_Basic")}},{value:D.j6,displayName:function(e){return e.get("Visual_SliderMode_Dropdown")}},{value:D.Zr,displayName:function(e){return e.get("Visual_SliderMode_SingleVal")}},{value:D.Ih,displayName:function(e){return e.get("Visual_SliderMode_VerticalList")}},{value:D.of,displayName:function(e){return e.get("Tile_Generic")}}]),At=function(){function r(e){this.hostServices=e.hostServices,this.startInputLabel=this.hostServices.getLocalizedString("Slicer_StartLabel"),this.endInputLabel=this.hostServices.getLocalizedString("Slicer_EndLabel")}return r.prototype.createRange=function(e){return e.isSourceInteger?new be(e.bounds.min,e.bounds.max,e.value.min,e.value.max):new ae(e.bounds.min,e.bounds.max,e.value.min,e.value.max)},r.prototype.areEqual=function(e,t){return e===t},r.prototype.defaultValue=function(){return 0},r.prototype.startProperty=function(){return p.gO.data.numericStart},r.prototype.endProperty=r.prototype.parseSingleSliderValue=r.prototype.formatValue=function(e,t){return z.fF.assertValue(e,"value"),t?t.format(e):e.toString()},r.prototype.getSliderOptions=function(e,t){return t?{min:0,max:e.dataPoints.length-1,step:1}:e.isSourceInteger?{min:e.bounds.min,max:e.bounds.max,step:1}:{min:e.bounds.min,max:e.bounds.max,step:null}},r.prototype.inputStyleProperties=function(){return{background:p.gO.numericInputStyle.background,fontColor:p.gO.numericInputStyle.fontColor,textSize:p.gO.numericInputStyle.textSize,fontFamily:p.gO.numericInputStyle.fontFamily,bold:p.gO.numericInputStyle.bold,italic:p.gO.numericInputStyle.italic,underline:p.gO.numericInputStyle.underline}},r.prototype.parseInput=function(e,t,i){var a=parseFloat(e);return i&&$.isNumeric(a)?_.indexOf(t,a)>-1?a:this.findClosestPoint(a,t):a},r.prototype.findClosestPoint=function(e,t){for(var i=_.head(t),a=Math.abs(i-e),n=1;n<t.length;n++){var c=Math.abs(t[n]-e);c<a&&(a=c,i=t[n])}return i},r.prototype.isInputValid=function(e,t,i,a){return!(!$.isNumeric(e)||0===i&&e>t.max||1===i&&e<t.min||a&&e===t.min)},r.prototype.setRange=function(e,t,i,a,n,c){z.fF.assertValue(e.min,"value.min"),z.fF.assertValue(e.max,"value.max"),null==n?(i.val(t.format(e.min)),i.attr("aria-label",(0,Re.W)(this.startInputLabel,t.format(c.min),t.format(e.max))),a.val(t.format(e.max)),a.attr("aria-label",(0,Re.W)(this.endInputLabel,t.format(e.min),t.format(c.max)))):0===n?(i.val(t.format(e.min)),i.attr("aria-label",(0,Re.W)(this.startInputLabel,t.format(c.min),t.format(c.max)))):1===n&&(a.val(t.format(e.max)),a.attr("aria-label",(0,Re.W)(this.endInputLabel,t.format(c.min),t.format(c.max))))},r.prototype.createInputElement=function(e,t){return(0,de.ze)().attr("type","text").attr(rt,"true").addClass(We.class).appendTo(e)},r.prototype.enumerateObjectInstances=function(e,t,i){var a;if("numericInputStyle"===e.objectName&&t&&t.inputStyle){var n=p.gO.numericInputStyle;return[{selector:null,objectName:"numericInputStyle",properties:(a={fontColor:t.inputStyle.fontColor,background:t.inputStyle.background,textSize:t.inputStyle.textSize,fontFamily:t.inputStyle.fontFamily},a[n.bold.propertyName]=t.inputStyle.labelBold,a[n.italic.propertyName]=t.inputStyle.labelItalic,a[n.underline.propertyName]=t.inputStyle.labelUnderline,a)}]}},r.prototype.getValuesCard=function(e,t){var i=this,a=p.gO.numericInputStyle,n=new U.CQ(new U.lg("values"),"Role_DisplayName_Values",[a.fontFamily,a.textSize,a.fontColor,a.background,a.bold,a.italic,a.underline],function(E){return i.hostServices.getLocalizedString(E)}),g=(new U.UN).withFontFamily({descriptor:a.fontFamily,value:e.inputStyle.fontFamily}).withFontSizeProperties({descriptor:a.textSize,value:e.inputStyle.textSize}).withBold({descriptor:a.bold,value:e.inputStyle.labelBold}).withItalic({descriptor:a.italic,value:e.inputStyle.labelItalic}).withUnderline({descriptor:a.underline,value:e.inputStyle.labelUnderline}).build();return n.addGroup("values",function(E){E.withDisplayName("Role_DisplayName_Values"),E.addCompositeSlice("fontselector","Font",g),E.addSimpleSlice("color",function(){return new U.BT({descriptor:a.fontColor,value:{value:e.inputStyle.fontColor}}).build()})}).addGroup("background",function(E){E.withDisplayName("Visual_Background").addSimpleSlice("color",function(){return new U.BT({descriptor:a.background,value:{value:e.inputStyle.background}}).build()})}),n.build()},r.prototype.getDataPointsForSingleValueRange=function(e){var t=e.categorical.categories[0],a=_.filter(t&&t.values||[],function(n){return $.isNumeric(n)});return a=_.sortBy(a,function(n){return n}),_.uniq(a)},r.prototype.filterExpr=r.prototype.comparisonKind=r}(),Kt=S(48105),Di=S(38094),gt=S(77497),ci=S(48711),Vt="Segoe UI,wf_segoe-ui_normal,helvetica,arial,sans-serif",Gt=(0,ie.CH)("date-slicer-range"),hi=(0,ie.CH)("date-slicer"),Jt=(0,ie.CH)("date-slicer-head"),Mi=(0,ie.CH)("date-slicer-slider"),Bt=(0,ie.CH)("date-slicer-control"),It=(0,ie.CH)("roundHandles"),pi=(0,ie.CH)("wrap"),Qt=(0,ie.CH)("date-slicer-datepicker"),Ot=(0,ie.CH)("date-slicer-datepicker-wrapper"),fi=(0,ie.CH)("noUi-connect"),Pi=(0,ie.CH)("noUi-connects"),vi=(0,ie.CH)("noUi-background"),Lt=(0,ie.CH)("noUi-handle"),Yt="foregroundNeutralSecondary";function Ri(r){return{textSize:9,fontFamily:qe.Wn.regular.css,fontColor:Te.v.getThemeColor(r,"foregroundDark"),background:null,labelBold:!1,labelItalic:!1,labelUnderline:!1}}function Ti(r){return{color:Te.v.getThemeColor(r,Yt),show:!0,drawRoundSliderHandles:!1,minSliderVisibilityHeight:0,minSliderVisibilityWidth:150,handleFillColor:Te.v.getThemeColor(r,"background"),handleBorderColor:Te.v.getThemeColor(r,Yt),primaryLineColor:Te.v.getThemeColor(r,Yt),secondaryLineColor:Te.v.getThemeColor(r,"foregroundNeutralLight")}}var h=function(){function r(e,t,i,a,n){this.viewModelAdapter=n,this.isRendered=!1,e&&(this.hostServices=e.hostServices,this.preventTextSelection=e.preventTextSelection,this.featureSwitches=e.featureSwitches),this.rangeSlicerRenderer=t,this.singleValue=i,this.isCategorySourceNumeric=a,this.useModernDatePicker=!this.isCategorySourceNumeric&&this.featureSwitches.useModernDatePickerSlicer}return Object.defineProperty(r.prototype,"defaultSliderMode",{get:enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"activeMode",{get:enumerable:!1,configurable:!0}),r.prototype.init=function(e,t){this.host=t,this.style=e.visualInitOptions.style,this.featureSwitches=e.visualInitOptions.featureSwitches},r.prototype.onModeChange=function(e){if(_.indexOf(yt,e)>-1){if(!this.data)return;this.updateMode(e)}else(0,J.VD)(this.hostServices,e)},r.prototype.onDataViewObjectChanged=function(e,t){if(0===t&&1===e.length&&e[0].objectName===p.gO.data.mode.objectName&&e[0].propertyName===p.gO.data.mode.propertyName){var a=e[0].propertyValue;return _.indexOf(yt,a)>-1?this.buildUpdatedPropertySaveObjects(a):(0,J.tm)(e,t)}return e},r.prototype.buildUpdatedPropertySaveObjects=function(e){var t=[];this.updateRangeSlicerState(e);var i=this.buildRangeSlicerProperties();this.data.properties.filter=i.filter,this.data.properties.bounds=i.bounds;var a=this.createFilter(i,e,this.data.state,this.data.identity);t.push({objectName:p.gO.general.filter.objectName,propertyName:p.gO.general.filter.propertyName,propertyValue:a,propertyType:{filter:{}}});var c=this.isCategorySourceNumeric?{numeric:!0}:{dateTime:!0},g=null;1&this.data.state&&null!==i.start&&(g=i.start);var E={objectName:this.rangeSlicerRenderer.startProperty().objectName,propertyName:this.rangeSlicerRenderer.startProperty().propertyName,propertyValue:g,propertyType:c};t.push(E);var P=null;2&this.data.state&&null!==i.end&&(P=i.end);var H={objectName:this.rangeSlicerRenderer.endProperty().objectName,propertyName:this.rangeSlicerRenderer.endProperty().propertyName,propertyValue:P,propertyType:c};return t.push(H),t.push({objectName:p.gO.data.mode.objectName,propertyName:p.gO.data.mode.propertyName,propertyValue:e,propertyType:{enumeration:D.dt}}),t},r.prototype.buildRangeSlicerProperties=function(){return{start:1&this.data.state?this.data.value.min:null,end:2&this.data.state?this.data.value.max:null,mode:this.data.mode,filter:{min:this.data.value.min,max:this.data.value.max},bounds:{min:this.data.bounds.min,max:this.data.bounds.max}}},r.prototype.onClear=function(){if(this.data&&this.data.initialValue){this.data.value=this.data.initialValue,this.data.state=0,this.updateProperties(),this.hostServices.triggerUpdate();var e=this.hostServices.getLocalizedString("Slicer_ClearSelectionsCleared");this.hostServices.alertWithDebounce("announce-clear-selection",e)}},r.prototype.render=function(e){if(_.isEmpty(e.dataView))this.hostServices.setWarnings([new q.L$]);else{if(this.dataView=e.dataView,this.reader=(0,ye.G)(this.dataView),this.originalData=this.data=this.converter(this.reader,e),!this.isMetaColumnsValid(this.reader))return this.hostServices.setWarnings([new q.L$]),void(this.isRendered&&this.disableSlicer());this.isRendered&&this.enableSlicer(),this.viewModelAdapter&&(this.data=this.viewModelAdapter.applyChanges(e.viewport,this.originalData,this.dataView)),this.isRendered||this.initControls(),this.rangeSlicerRenderer.setRange(this.data.value,this.data.formatter,this.start,this.end,null,this.data.bounds),this.range=this.rangeSlicerRenderer.createRange(this.data),this.updateInputControls(),this.updateSlider(this.activeMode),this.updateProperties(),this.isDataColumnsValid(this.reader)||(this.hostServices.setWarnings([new q.L$]),this.isRendered&&this.disableSlicer())}},r.prototype.hasSlider=r.prototype.supportsOrientation=function(){return!1},r.prototype.enumerateObjectInstances=function(e){var t=this.originalData;return"date"===e.objectName||"numericInputStyle"===e.objectName?this.rangeSlicerRenderer.enumerateObjectInstances(e,t,this.featureSwitches):"slider"===e.objectName&&t?[{selector:null,objectName:"slider",properties:{show:t.sliderSettings.show,color:t.sliderSettings.color},propertyInstanceKind:{color:3}}]:void 0},r.prototype.getSlicerSettingsCardOptions=function(e,t,i,a){return(0,J.nD)({cardUidBuilder:e,currentSlicerSettings:void 0,data:void 0,dataView:this.dataView,hostServices:this.hostServices,orientation:t,activeMode:i,slicerModes:a,featureSwitches:this.featureSwitches})},r.prototype.getValuesCard=function(){var e=this.originalData;if(e)return this.rangeSlicerRenderer.getValuesCard(e,this.featureSwitches)},r.prototype.getAdditionalCards=function(){var t,e=this,i=this.originalData;if(i){var a=p.gO.slider,n=[a.show,a.color,a.handleFillColor,a.handleBorderColor,a.secondaryLineColor],c=new U.CQ(new U.lg("slider"),"Slicer_Slider",n,function(g){return e.hostServices.getLocalizedString(g)});return c.addTopLevelToggle("show",function(){return new U.bd({descriptor:a.show,value:i.sliderSettings.show}).build()}),null!==(t=this.featureSwitches)&&void 0!==t&&t.slicerSliderColors?c.addGroup("handles",function(g){g.withDisplayName("Slicer_Handles"),e.data.sliderSettings.drawRoundSliderHandles?g.addSimpleSlice("fill",function(){return new U.BT({descriptor:a.handleFillColor,value:{value:i.sliderSettings.handleFillColor}}).build()}).addSimpleSlice("border",function(){return new U.BT({descriptor:a.handleBorderColor,value:{value:i.sliderSettings.handleBorderColor}}).build()}):g.addSimpleSlice("color",function(){return new U.BT({descriptor:a.handleBorderColor,value:{value:i.sliderSettings.handleBorderColor}}).build()},function(E){return E.withCustomDisplayName("Generic_Color")})}).addGroup("primaryLine",function(g){g.withDisplayName("Primary_Line").addSimpleSlice("primaryLineColor",function(){return new U.BT({descriptor:a.color,value:{value:i.sliderSettings.primaryLineColor}}).build()},function(E){return E.withCustomDisplayName("Visual_LegendTitleColor")})}).addGroup("secondaryLine",function(g){g.withDisplayName("Visual_Secondary_Line").addSimpleSlice("secondaryLineColor",function(){return new U.BT({descriptor:a.secondaryLineColor,value:{value:i.sliderSettings.secondaryLineColor}}).build()})}):c.addGroup("colors",function(g){g.withDisplayName("Generic_Color").addSimpleSlice("color",function(){return new U.BT({descriptor:a.color,value:{value:i.sliderSettings.color}}).build()})}),[c.build()]}},r.prototype.isDataColumnsValid=function(e){if(this.singleValue)return e.columns.getCategoryCount()>0;var t=e.columns.getMetadataColumns(p.CT.value);if(!_.isEmpty(t)){var i=t[0];if(i.aggregates&&null!=i.aggregates.min&&null!=i.aggregates.max)return!0}return!1},r.prototype.isMetaColumnsValid=function(e){var t=e.columns.getMetadataColumns(p.CT.value);return!_.isEmpty(t)},r.prototype.converter=function(e,t){var i,a,n={state:0,mode:null,formatter:null,identity:null,value:null,initialValue:null,bounds:null,filter:null,properties:{filter:null},sliderSettings:Ti(this.style),inputStyle:Ri(this.style),dataPoints:null,wrapRangeBoxes:!1,isSourceInteger:!1,hideDatePickerButton:!0},g=e.columns.getMetadataColumns(p.CT.value)[0],E=(0,ci.EO)(g,p.gO.general.formatString);n.isSourceInteger=!0===g.type.integer,n.formatter=(0,ci.E3)(E),n.identity=g.expr;var P=this.rangeSlicerRenderer.defaultValue(),H=this.rangeSlicerRenderer.defaultValue();if(this.singleValue)n.dataPoints=this.rangeSlicerRenderer.getDataPointsForSingleValueRange(this.dataView),n.dataPoints.length>0&&(P=n.dataPoints[0],H=n.dataPoints[n.dataPoints.length-1]);else{var G=g.aggregates;null!=G.min&&(P=G.min),null!=G.max&&(H=G.max)}n.value={min:P,max:H},n.initialValue={min:P,max:H},n.bounds={min:n.value.min,max:n.value.max};var le=e.objects.getStaticObjects();if(le){n.filter=(0,o.NA)(le,p.gO.general.filter),n.properties.start=n.filter?(0,o.NA)(le,this.rangeSlicerRenderer.startProperty(),null):null,n.properties.end=n.filter?(0,o.NA)(le,this.rangeSlicerRenderer.endProperty(),null):null,n.properties.mode=(0,o.NA)(le,p.gO.data.mode,null),n.hideDatePickerButton=(0,o.NA)(le,p.gO.date.hideDatePickerButton,!0);var X=this.rangeSlicerRenderer.inputStyleProperties(),ce=Te.v.create(this.style),fe=(0,o.RK)(le,this.rangeSlicerRenderer instanceof At?"numericInputStyle":"date"),ze=(0,Ze.Zi)(fe,{color:"fontColor",family:"fontFamily",size:"textSize"},ce,this.style,"foregroundDark","smallLabel",{color:n.inputStyle.fontColor,family:n.inputStyle.fontFamily,size:lt.B.createFromPt(n.inputStyle.textSize)});n.inputStyle.fontColor=ze.color,n.inputStyle.fontFamily=ze.family,n.inputStyle.textSize=ze.size.pt,n.inputStyle.background=ce.getColorForPropertyWithDefaultColor(le,X.background,n.inputStyle.background),n.inputStyle.labelBold=(0,o.NA)(le,X.bold,n.inputStyle.labelBold),n.inputStyle.labelItalic=(0,o.NA)(le,X.italic,n.inputStyle.labelItalic),n.inputStyle.labelUnderline=(0,o.NA)(le,X.underline,n.inputStyle.labelUnderline),n.sliderSettings.color=ce.getColorForPropertyWithDefaultColor(le,p.gO.slider.color,n.sliderSettings.color),n.sliderSettings.show=(0,o.NA)(le,p.gO.slider.show,n.sliderSettings.show),!(null===(i=this.featureSwitches)||void 0===i)&&i.slicerSliderColors&&(n.sliderSettings.handleFillColor=ce.getColorForPropertyWithDefaultColor(le,p.gO.slider.handleFillColor,n.sliderSettings.handleFillColor),n.sliderSettings.primaryLineColor=ce.getColorForPropertyWithDefaultColor(le,p.gO.slider.color,n.sliderSettings.color),n.sliderSettings.handleBorderColor=ce.getColorForPropertyWithDefaultColor(le,p.gO.slider.handleBorderColor,n.sliderSettings.primaryLineColor),n.sliderSettings.secondaryLineColor=ce.getColorForPropertyWithDefaultColor(le,p.gO.slider.secondaryLineColor,n.sliderSettings.secondaryLineColor)),null!==n.properties.start&&(n.state|=1,n.value.min=n.properties.start,n.properties.start<n.bounds.min&&(n.bounds.min=n.properties.start)),null!==n.properties.end&&(n.state=n.state|=2,n.value.max=n.properties.end,n.properties.end>n.bounds.max&&(n.bounds.max=n.properties.end)),n.value.min>n.bounds.max&&(n.value.max=n.bounds.max=n.value.min),n.value.max<n.bounds.min&&(n.value.min=n.bounds.min=n.value.max),null!=n.properties.mode&&(n.mode=n.properties.mode),n.filter&&(n.properties.filter={min:n.value.min,max:n.value.max})}else n.state=0,n.properties.start=null,n.properties.end=null,n.properties.mode=null;var $e=(0,gt.WV)(null!==(a=this.featureSwitches)&&void 0!==a&&a.slicerSliderColors?n.sliderSettings.handleBorderColor:n.sliderSettings.color);return n.sliderSettings.activeColor=(0,gt.jd)($e,.5,.2),n.sliderSettings.hoverColor=(0,gt.Bx)((0,gt._j)($e,100)),n.sliderSettings.label=t.restatement,n.properties.bounds={min:n.bounds.min,max:n.bounds.max},n},r.prototype.initControls=function(){this.isRendered=!0,this.createHtmlControls(),this.updateMode(this.data.mode)},r.prototype.createHtmlControls=function(){var e=this;this.container=(0,de.hi)().addClass(hi.class).appendTo(this.host),this.container.on("keyup keydown",function(n){9!==n.keyCode&&27!==n.keyCode&&n.stopPropagation()});var t=(0,de.hi)().addClass(Jt.class).css(this.getFontStyles()).appendTo(this.container),i=(0,de.hi)().addClass(Gt.class).appendTo(t);if(this.startContainer=(0,de.hi)().addClass(Bt.class).appendTo(i),this.endContainer=(0,de.hi)().addClass(Bt.class).appendTo(i),this.useModernDatePicker?(z.fF.assert(function(){return e.data.value.min instanceof Date},"Date required"),z.fF.assert(function(){return e.data.value.max instanceof Date},"Date required"),z.fF.assert(function(){return e.data.bounds.min instanceof Date},"Date required"),z.fF.assert(function(){return e.data.bounds.max instanceof Date},"Date required"),this.startComponentRef=this.hostServices.getUIComponentFactory().createDatePicker(this.startContainer.get(0),this.data.value.min,function(n){null!==n&&e.onRangeChange(0)},et.b$.generateGuid(),this.data.bounds.min,this.data.bounds.max,this.data.hideDatePickerButton),this.endComponentRef=this.hostServices.getUIComponentFactory().createDatePicker(this.endContainer.get(0),this.data.value.max,et.b$.generateGuid(),this.data.bounds.min,this.data.bounds.max,this.data.hideDatePickerButton),this.start=this.startComponentRef.datePickerElement.find(":input").first(),this.end=this.endComponentRef.datePickerElement.find(":input").first(),this.startButton=this.startComponentRef.datePickerElement.find(":button"),this.endButton=this.endComponentRef.datePickerElement.find(":button"),this.data.hideDatePickerButton?(this.start.addClass(We.class),this.end.addClass(We.class)):(this.start.addClass(Qt.class),this.startComponentRef.datePickerElement.addClass(Ot.class),this.end.addClass(Qt.class),this.endComponentRef.datePickerElement.addClass(Ot.class))):(this.start=this.rangeSlicerRenderer.createInputElement(this.startContainer,0),this.end=this.rangeSlicerRenderer.createInputElement(this.endContainer,1)),this.rangeSlicerRenderer.addAriaDescription&&(this.rangeSlicerRenderer.addAriaDescription(this.start),this.rangeSlicerRenderer.addAriaDescription(this.end)),(0,J.Id)()){var a=J.hY.class;this.start.addClass(a),this.end.addClass(a)}this.bindEventHandlersToInputElements(),this.sliderContainer=(0,de.hi)().addClass(Mi.class).appendTo(this.container)},r.prototype.bindEventHandlersToInputElements=function(){var e=this;this.start.on("click touchend contextmenu",function(t){t.stopPropagation()}),this.end.on("click touchend contextmenu",,this.start.on("change",function(t){e.onRangeChange(0)}),this.start.on("keyup",function(t){13===t.which&&(e.start.blur(),e.start.focus())}),this.start.on("focus",function(t){(!e.singleValue||e.data.filter)&&(e.useModernDatePicker?(z.fF.assert(function(){return e.data.value.min instanceof Date},"Date required"),e.startComponentRef.writeValue(e.data.value.min)):e.start.val(e.rangeSlicerRenderer.formatValue(e.data.value.min,null))),e.preventTextSelection||e.start.select()}),this.start.on("blur",function(t){(!e.singleValue||e.data.filter)&&(e.useModernDatePicker?(z.fF.assert(function(){return e.data.value.min instanceof Date},"Date required"),e.startComponentRef.writeValue(e.data.value.min)):e.start.val(e.rangeSlicerRenderer.formatValue(e.data.value.min,e.data.formatter)))}),this.end.on("change",,this.end.on("keyup",function(t){13===t.which&&(e.end.blur(),e.end.focus())}),this.end.on("focus",function(t){e.useModernDatePicker?(z.fF.assert(function(){return e.data.value.max instanceof Date},"Date required"),e.endComponentRef.writeValue(e.data.value.max)):e.end.val(e.rangeSlicerRenderer.formatValue(e.data.value.max,null)),e.preventTextSelection||e.end.select()}),this.end.on("blur",function(t){e.useModernDatePicker?(z.fF.assert(function(){return e.data.value.max instanceof Date},"Date required"),e.endComponentRef.writeValue(e.data.value.max)):e.end.val(e.rangeSlicerRenderer.formatValue(e.data.value.max,e.data.formatter))})},r.prototype.onRangeChange=function(e){var t=this,i=0===e?this.start.val():this.end.val(),a=this.rangeSlicerRenderer.parseInput(i,this.data.dataPoints,this.singleValue);this.rangeSlicerRenderer.isInputValid(a,this.data.value,e,this.singleValue)?this.updateRange({min:a,max:a},e):(this.rangeSlicerRenderer.setRange(this.data.value,this.data.formatter,this.start,this.end,e,this.data.bounds),this.useModernDatePicker&&(z.fF.assert(function(){return t.data.value.min instanceof Date},"Date required"),z.fF.assert(function(){return t.data.value.max instanceof Date},"Date required"),this.startComponentRef.writeValue(this.data.value.min),this.endComponentRef.writeValue(this.data.value.max)))},r.prototype.onDestroy=r.prototype.getFontStyles=function(){var e;return(e={})["font-size"]=ne.FP.fromPointToPixel(9),e["font-family"]=Vt,e["font-weight"]=Di.JP.weight,e},r.prototype.updateSliderControl=function(){var t,i,e=this,a=this.createSliderOptions();if(this.slider){this.slider.updateOptions(a);var n=[];if(this.singleValue){var c=_.indexOf(this.data.dataPoints,this.data.value.min);n.push(c)}else{var g=this.range.getScaledValue();this.activeMode!==D.bb&&n.push(g.min),this.activeMode!==D.e4&&n.push(g.max)}this.slider.set(n)}else this.sliderOptions=a,this.slider&&(this.slider.destroy(),this.sliderContainer.empty()),this.sliderElement=(0,de.hi)().attr(rt,"true").attr("rtl",("rtl"===document.dir).toString()).appendTo(this.sliderContainer),(0,Kt.create)(this.sliderElement.get(0),this.sliderOptions),this.slider=this.sliderElement.get(0).noUiSlider,this.slider.on("slide",function(G,le,X){window.requestAnimationFrame(function(){var ce=e.parseSliderValue(X);e.rangeSlicerRenderer.setRange(ce,e.data.formatter,e.start,e.end,null,e.data.bounds),e.useModernDatePicker&&(z.fF.assert(function(){return ce.min instanceof Date},"Date required"),z.fF.assert(function(){return ce.max instanceof Date},"Date required"),e.startComponentRef.writeValue(ce.min),e.endComponentRef.writeValue(ce.max))})}),this.slider.on("change",_.debounce(function(G,le,X){var ce=e.parseSliderValue(X),fe=e.getChangeType(e.activeMode,le);e.updateRange(ce,fe)},100)),this.applyHandlesHoverState(this.sliderContainer.find(Lt.selector));this.updateAccessibilityAttributes(this.data,this.sliderContainer.find(Lt.selector),this.activeMode);var E=null!==(t=this.featureSwitches)&&void 0!==t&&t.slicerSliderColors?this.data.sliderSettings.handleBorderColor:this.data.sliderSettings.color,P=null!==(i=this.featureSwitches)&&void 0!==i&&i.slicerSliderColors?this.data.sliderSettings.primaryLineColor:this.data.sliderSettings.color;this.sliderContainer.find(fi.selector).css({"background-color":P}),this.sliderContainer.find(Pi.selector).css({"background-color":this.data.sliderSettings.secondaryLineColor}),this.sliderContainer.find(Lt.selector).each(function(G,le){var X=$(le),ce=X.is(":hover")?e.data.sliderSettings.activeColor:E;e.setSliderHandleColor(X,ce)}),this.sliderContainer.find(fi.selector).addClass("backgroundToSelectedBackgroundColor"),this.sliderContainer.find(vi.selector).addClass("backgroundToForegroundColor");var H=this.sliderContainer.find(Lt.selector);this.data.sliderSettings.drawRoundSliderHandles?(H.addClass("backgroundToSolidBackgroundColor"),H.addClass("highContrastSelectedBorderColor")):H.addClass("backgroundToSelectedBackgroundColor")},r.prototype.setSliderHandleColor=function(e,t){var i={"border-color":"","background-color":""};this.data.sliderSettings.drawRoundSliderHandles&&(i["background-color"]=this.data.sliderSettings.handleFillColor),i[this.data.sliderSettings.drawRoundSliderHandles?"border-color":"background-color"]=t,e.css(i)},r.prototype.disableSlicer=function(){this.disableSlider(),1&this.data.state||(this.useModernDatePicker?this.startComponentRef.writeValue():this.start.val(""),this.start.prop("disabled",!0),this.disableInput(this.start,this.data.inputStyle.fontColor)),2&this.data.state||(this.useModernDatePicker?this.endComponentRef.writeValue():this.end.val(""),this.end.prop("disabled",!0),this.disableInput(this.end,this.data.inputStyle.fontColor)),this.data.bounds.min=this.data.bounds.max=null,this.updateProperties()},r.prototype.disableSlider=function(){this.sliderElement&&this.sliderElement.get(0).setAttribute("disabled","true"),this.sliderContainer.css("opacity","0.1"),this.slider&&this.slider.set([0,100])},r.prototype.enableSlicer=function(){this.sliderElement&&!this.rangeSlicerRenderer.areEqual(this.data.bounds.min,this.data.bounds.max)&&this.sliderElement.get(0).removeAttribute("disabled"),this.sliderContainer.css("opacity","1.0"),this.start.prop("disabled",!1),this.end.prop("disabled",!1)},r.prototype.applyHandlesHoverState=function(e){var t,i=!1,a=!1,n=this,c=null===(t=this.featureSwitches)||void 0===t?void 0:t.slicerSliderColors;e.on("mouseenter",function(){a=!0,!i&&n.setSliderHandleColor($(this),n.data.sliderSettings.hoverColor)}).on("mouseleave",function(){a=!1,!i&&n.setSliderHandleColor($(this),c?n.data.sliderSettings.handleBorderColor:n.data.sliderSettings.color)}).on("mousedown touchstart",function(){var g=this;i=!0,n.setSliderHandleColor($(this),n.data.sliderSettings.activeColor),$(document).on("mouseup touchEnd",function P(){$(document).off("mouseup touchEnd",P),i&&(i=!1,n.setSliderHandleColor($(g),c?n.data.sliderSettings.handleBorderColor:n.data.sliderSettings.color))})}).on("mouseup touchend",function(){i=!1,n.setSliderHandleColor($(this),a?n.data.sliderSettings.hoverColor:c?n.data.sliderSettings.handleBorderColor:n.data.sliderSettings.color)})},r.prototype.updateInputControls=function(){var e=this;this.singleValue&&!this.data.filter&&(this.useModernDatePicker?this.startComponentRef.writeValue():this.start.val(""));var t={fontSize:ne.FP.fromPoint(this.data.inputStyle.textSize),fontFamily:this.data.inputStyle.fontFamily||Vt,fontWeight:this.data.inputStyle.labelBold?ie.en:ie.AI,fontStyle:this.data.inputStyle.labelItalic?ie.BF:ie.AI},i={"font-size":t.fontSize,"font-family":t.fontFamily,"font-weight":t.fontWeight,"font-style":t.fontStyle,"text-decoration":this.data.inputStyle.labelUnderline?ie.f0:ie.zu};this.start.parent().css(i),this.end.parent().css(i);var a={color:this.data.inputStyle.fontColor,"background-color":this.data.inputStyle.background?this.data.inputStyle.background:"","text-decoration":this.data.inputStyle.labelUnderline?ie.f0:ie.zu};this.start.css(a),this.end.css(a),this.startButton&&this.startButton.css(a),this.endButton&&this.endButton.css(a),this.useModernDatePicker&&(z.fF.assert(function(){return e.data.value.min instanceof Date},"Date required"),z.fF.assert(function(){return e.data.value.max instanceof Date},"Date required"),z.fF.assert(function(){return e.data.bounds.min instanceof Date},"Date required"),z.fF.assert(function(){return e.data.bounds.max instanceof Date},"Date required"),this.startComponentRef.updateDateRange(this.data.bounds.min,this.data.bounds.max),this.endComponentRef.updateDateRange(this.data.bounds.min,this.data.bounds.max),this.startComponentRef.writeValue(this.data.value.min),this.endComponentRef.writeValue(this.data.value.max)),!this.isCategorySourceNumeric&&this.useModernDatePicker?(this.setInputWidth(this.start,t,this.data.value.min),this.setInputWidth(this.end,t,this.data.value.max)):(this.setInputWidth(this.start,t),this.setInputWidth(this.end,t))},r.prototype.setInputWidth=function(e,t,i){e.css("width","");var a=e.val();if(i&&i instanceof Date&&(a=Oe.dx.formatValue(i,"d")),a){var n=a.toString(),c=ut.b.measureSvgTextWidth(t,n),g=parseFloat(e.css("padding-left"))+parseFloat(e.css("padding-right")),E=2*parseFloat(e.css("border-width"));c=Math.ceil(c+g+E),e.outerWidth(!1)<c&&e.css({width:c})}},r.prototype.disableInput=function(e,t){var i=(0,gt.WV)(t);i.A=.3,e.css({color:(0,gt.U8)(i)})},r.prototype.createSliderOptions=function(){var i,a,e=this.rangeSlicerRenderer.getSliderOptions(this.data,this.singleValue),t=this.range.getScaledValue();switch(this.activeMode){case D.bb:i=t.max,a=[!0,!1];break;case D.e4:i=t.min,a=[!1,!0];break;case D.vX:i=[t.min,t.max],a=!0;break;case D.Zr:i=_.indexOf(this.data.dataPoints,this.data.value.min),a=!1}return{connect:a,behaviour:"tap",range:{min:e.min===e.max?0:e.min,max:e.min===e.max?1:e.max},start:i,step:e.step}},r.prototype.parseSliderValue=function(e){if((this.data.isSourceInteger||this.singleValue)&&(e=_.map(e,function(i){return Math.round(i)})),this.singleValue)return this.rangeSlicerRenderer.parseSingleSliderValue(e[0],this.data.dataPoints);var t=this.range.getScaledValue();switch(this.activeMode){case D.bb:t.max=e[0];break;case D.e4:t.min=e[0];break;case D.vX:t.min=e[0],t.max=e[1]}return this.range.setScaledValue(t),this.range.getValue()},r.prototype.updateSlider=function(e){e===D.e4?(this.end.prop("disabled",!0),this.disableInput(this.end,this.data.inputStyle.fontColor),this.start.prop("disabled",!1)):e===D.bb?(this.end.prop("disabled",!1),this.start.prop("disabled",!0),this.disableInput(this.start,this.data.inputStyle.fontColor)):(this.end.prop("disabled",!1),this.start.prop("disabled",!1)),e===D.Zr?this.endContainer.hide():this.endContainer.show(),!this.data.sliderSettings.show||this.shouldHideSmallSlider()?this.sliderContainer.hide():(this.sliderContainer.show(),this.updateSliderControl()),this.sliderContainer.toggleClass(It.class,!!this.data.sliderSettings.drawRoundSliderHandles),this.container.find(Jt.selector).toggleClass(pi.class,!!this.data.wrapRangeBoxes),this.rangeSlicerRenderer.areEqual(this.data.bounds.min,this.data.bounds.max)&&this.disableSlider()},r.prototype.updateMode=r.prototype.updateProperties=function(){var e=this.buildRangeSlicerProperties();if(this.requireToUpdate(e)){this.data.properties.filter=e.filter,this.data.properties.bounds=e.bounds;var t=this.createPersistProperties(e,this.data.identity,this.data.state);this.hostServices.persistProperties(t),this.hostServices.onSelect({type:0,visualObjects:[]})}},r.prototype.updateRangeSlicerState=function(e){var t=this.data.mode;null==e?e=this.defaultSliderMode:this.data.mode=e,e===D.bb?(t===D.e4&&1&this.data.state&&(this.data.value.max=this.data.value.min,this.data.value.min=this.data.bounds.min,this.data.state=2),this.data.state&=-2):e===D.e4&&(t===D.bb&&2&this.data.state&&(this.data.value.min=this.data.value.max,this.data.state=1),this.data.state&=-3)},r.prototype.getChangeType=function(e,t){var i=null;switch(e){case D.e4:case D.Zr:i=0;break;case D.bb:i=1;break;default:i=0===t?0:1}return i},r.prototype.createPersistProperties=function(e,t,i){var n=this.createFilter(e,null==e.mode?this.defaultSliderMode:e.mode,i,t),c={merge:[{objectName:"general",selector:void 0,properties:{}}],replace:[{objectName:"data",selector:void 0,properties:{}}],remove:[{objectName:"data",selector:void 0,properties:{}},{objectName:"general",selector:void 0,properties:{}}]};return null!==n?c.merge[0].properties[p.gO.general.filter.propertyName]=n:c.remove[1].properties[p.gO.general.filter.propertyName]=!0,1&i&&null!==e.start?c.replace[0].properties[this.rangeSlicerRenderer.startProperty().propertyName]=e.start:null==e.start&&(c.remove[0].properties[this.rangeSlicerRenderer.startProperty().propertyName]=!0),2&i&&null!==e.end?c.replace[0].properties[this.rangeSlicerRenderer.endProperty().propertyName]=e.end:null==e.end&&(c.remove[0].properties[this.rangeSlicerRenderer.endProperty().propertyName]=!0),null!=e.mode&&(c.replace[0].properties[p.gO.data.mode.propertyName]=e.mode),c},r.prototype.updateRange=function(e,t){null==t?(this.data.value.min=e.min,this.data.value.max=e.max):0===t?(this.data.value.min=e.min,null===this.data.bounds.min||this.singleValue||!this.rangeSlicerRenderer.areEqual(this.data.value.min,this.data.bounds.min)||this.useModernDatePicker?this.data.state|=1:this.data.state&=-2):1===t&&(this.data.value.max=e.max,null!==this.data.bounds.max&&this.rangeSlicerRenderer.areEqual(this.data.value.max,this.data.bounds.max)&&!this.useModernDatePicker?this.data.state&=-3:this.data.state|=2),this.updateProperties()},r.prototype.createFilter=function(e,t,i,a){var n=null,g=null,E=this.rangeSlicerRenderer.filterExpr(e.filter);if(t===D.Zr)n=1&i?(0,Je.qu)(0,a,E.lower):null;else{var P=this.rangeSlicerRenderer.comparisonKind();if(1&i&&2&i){var H=(0,Je.qu)(P.lower,a,E.lower),G=(0,Je.qu)(P.upper,a,E.upper);n=(0,Je.xD)(H,G)}else 1&i?n=(0,Je.qu)(P.lower,a,E.lower):2&i&&(n=(0,Je.qu)(P.upper,a,E.upper))}return null!==n&&(g=xt.yl.fromSQExpr(n)),g},r.prototype.requireToUpdate=function(e){return!(null===this.data.properties.filter&&0===this.data.state&&(e.mode===this.data.properties.mode||e.mode===this.defaultSliderMode&&null===this.data.properties.mode)||null!=this.data.properties.filter&&e.mode===this.data.properties.mode&&this.rangeSlicerRenderer.areEqual(e.start,this.data.properties.start)&&this.rangeSlicerRenderer.areEqual(e.end,this.data.properties.end)&&this.rangeSlicerRenderer.areEqual(e.filter.min,this.data.properties.filter.min)&&this.rangeSlicerRenderer.areEqual(e.filter.max,this.data.properties.filter.max)&&this.rangeSlicerRenderer.areEqual(e.bounds.min,this.data.properties.bounds.min)&&this.rangeSlicerRenderer.areEqual(e.bounds.max,this.data.properties.bounds.max))},r.prototype.shouldHideSmallSlider=function(){var e=this.data.sliderSettings;if((this.container.width()||0)<=e.minSliderVisibilityWidth)return!0;if(e.minSliderVisibilityHeight>0){var t=this.endContainer.position().top+this.endContainer.outerHeight();if(this.container.parent().outerHeight()-t<e.minSliderVisibilityHeight)return!0}return!1},r.prototype.updateAccessibilityAttributes=function(e,t,i){var c,a=e.value.min,n=e.value.max;switch(i){case D.bb:c=this.hostServices.getLocalizedString("End_Date")+" "+this.getRangeText(e.bounds.min,e.bounds.max),this.addAccessibilityAttributesToSliderHandle(t,c,n);break;case D.e4:c=this.hostServices.getLocalizedString("Start_Date")+" "+this.getRangeText(e.bounds.min,e.bounds.max),this.addAccessibilityAttributesToSliderHandle(t,c,a);break;case D.vX:c=this.hostServices.getLocalizedString("Start_Date")+" "+this.getRangeText(e.bounds.min,e.value.max),this.addAccessibilityAttributesToSliderHandle(t.first(),c,a),c=this.hostServices.getLocalizedString("End_Date")+" "+this.getRangeText(e.value.min,e.bounds.max),this.addAccessibilityAttributesToSliderHandle(t.last(),c,n)}t.attr("aria-label",e.sliderSettings.label)},r.prototype.addAccessibilityAttributesToSliderHandle=function(e,t,i){e.attr("aria-valuetext",this.rangeSlicerRenderer.formatValue(i,this.data.formatter)).attr("aria-description",t)},r.prototype.getRangeText=function(e,t){return Oe.dx.format(this.hostServices.getLocalizedString("Slicer_Range_Hint"),this.isCategorySourceNumeric?[e,t]:[Oe.dx.formatValue(e,"d"),Oe.dx.formatValue(t,"d")])},r}(),v=S(41455),I=S(97628),F=S(28643),Q=S(66683),He="slicer-header-pending-icon",Ke="slicer-header-pending-icon-path",st="slicer-header-selectmenu",zt="foregroundNeutralSecondary",mi='<svg width="17" height="16" viewBox="0 0 17 16" class='.concat(He,' xmlns="http://www.w3.org/2000/svg">\n        <path class=\'').concat(Ke,' OfficeIconColors_HighContrast\' d="M8.00781 0C12.4261 0 16.0078 3.58172 16.0078 8C16.0078 12.4183 12.4261 \n        16 8.00781 16C3.58953 16 0.0078125 12.4183 0.0078125 8C0.0078125 3.58172 3.58953 0 8.00781 0ZM7.50781 3C7.23167 3 7.00781 3.22386 \n        7.00781 3.5V8.5L7.01587 8.58988C7.0582 8.82312 7.26235 9 7.50781 9H10.5078L10.5977 8.99194C10.8309 8.94961 11.0078 8.74546 11.0078 \n        8.5C11.0078 8.22386 10.784 8 10.5078 8H8.00781V3.5L7.99976 3.41012C7.95742 3.17688 7.75327 3 7.50781 3Z" /></svg>'),Yi=function(){function r(e,t,i,a){this.services=t,this.settings=e,this.style=i,this.originalData=this.data=r.DefaultData(this.style,e.text,this.services),this.featureSwitches=a,this.render()}return r.DefaultData=function(e,t,i){return{borderStyle:"solid",borderBottomWidth:1,show:!0,outline:Q.YP,outlineStyle:0,fontColor:Te.v.getThemeColor(e,"foregroundDark"),textSize:9,fontFamily:qe.Wn.regular.css,iconColor:Te.v.getThemeColor(e,zt),iconHoverColor:Te.v.getThemeColor(e,"foreground"),outlineColor:Te.v.getThemeColor(e,"foregroundNeutralSecondaryAlt2"),outlineWeight:1,searchEnabled:!1,background:null,showRestatement:!1,menu:{fontColor:Te.v.getThemeColor(e,zt)},warnings:new q.tb,text:t,labelBold:!1,labelItalic:!1,labelUnderline:!1,pendingChangesIcon:{show:!0,color:Te.v.getThemeColor(e,zt),transparency:0,position:"right",size:12,showTooltip:!0,tooltipText:"",tooltipLabel:i.localize("Not_Yet_Applied_With_Parentheses")}}},r.InFocusModeData=function(e,t,i){var a=r.DefaultData(e,t,i);return a.borderStyle="none",a.background=Te.v.getThemeColor(e,"foregroundNeutralLight"),a.textSize=ne.FP.toPoint(13),a.fontColor=Te.v.getThemeColor(e,"foregroundNeutralDark"),a.fontFamily=qe.Wn.regular.css,a},r.prototype.destroy=function(){this.selectMenu&&this.selectMenu.destroy()},r.prototype.enumerateObjectInstances=function(e){var t=this.originalData;if(t){if("header"===e.objectName){var i={selector:null,objectName:"header",properties:{text:t.text,show:t.show,fontColor:t.fontColor,background:t.background,textSize:t.textSize,fontFamily:t.fontFamily,bold:t.labelBold,italic:t.labelItalic,underline:t.labelUnderline,outlineColor:t.outlineColor,outlineWeight:t.outlineWeight},propertyInstanceKind:{text:3,fontColor:3,background:3}};return this.featureSwitches.outlineDropdownToCheckboxes?i.properties.outlineStyle=t.outlineStyle:i.properties.outline=t.outline,this.settings.supportsRestatement&&(i.properties.showRestatement=t.showRestatement),[i]}if("general"===e.objectName)return[{selector:null,objectName:"general",properties:{outlineColor:t.outlineColor,outlineWeight:t.outlineWeight}}]}},r.prototype.getSlicerHeaderCard=function(e){var t=this,i=this.originalData;if(i){var a=p.gO.header,n=p.gO.pendingChangesIcon,c=new U.CQ(new U.lg("slicerHeader"),"Slicer_Header",[a.text,a.fontFamily,a.textSize,a.bold,a.italic,a.underline,a.fontColor,a.showRestatement,a.outlineStyle,a.outline,p.gO.general.outlineColor,p.gO.general.outlineWeight,a.background,a.show,n.show,n.color,n.position,n.transparency,n.size,n.showTooltip,n.tooltipText,n.tooltipLabel],function(P){return e.getLocalizedString(P)}),E=(new U.UN).withFontFamily({descriptor:a.fontFamily,value:i.fontFamily}).withFontSizeProperties({descriptor:a.textSize,value:i.textSize}).withBold({descriptor:a.bold,value:i.labelBold}).withItalic({descriptor:a.italic,value:i.labelItalic}).withUnderline({descriptor:a.underline,value:i.labelUnderline}).build();return c.addTopLevelToggle("show",.addGroup("text",function(P){P.withDisplayName("Text").addSimpleSlice("title",new U.fq({descriptor:(0,ee.pi)((0,ee.pi)({},a.text),{instanceKind:3}),value:i.text,placeholder:""}).build()).addCompositeSlice("fontselector","Font",E).addSimpleSlice("color",function(){var H={value:i.fontColor};return new U.BT({descriptor:(0,ee.pi)((0,ee.pi)({},a.fontColor),{instanceKind:3}),value:H}).build()}),t.settings.supportsRestatement&&P.addSimpleSlice("labelContents",new U.bd({descriptor:a.showRestatement,value:i.showRestatement}).build())}).addGroup("border",function(P){P.withDisplayName("Visual_Border"),P.addSimpleSlice("border position",t.featureSwitches.outlineDropdownToCheckboxes?new U.oM({descriptor:a.outlineStyle,value:i.outlineStyle}).build():new U.uY({descriptor:a.outline,value:i.outline}).build(),function(H){return H.withCustomDisplayName("Visual_Border_Position")}),P.addSimpleSlice("color",function(){var H={value:i.outlineColor};return new U.BT({descriptor:(0,ee.pi)((0,ee.pi)({},p.gO.general.outlineColor),{instanceKind:3}),value:H}).build()},function(H){return H.withCustomDisplayName("Visual_Background_Color")}).addSimpleSlice("lineWidth",new U.JN({descriptor:p.gO.general.outlineWeight,value:i.outlineWeight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:10}},localize:function(G){return e.getLocalizedString(G)}}).build(),function(H){return H.withCustomDisplayName("Visual_Line_Width")})}).addGroup("background",function(P){P.withDisplayName("Visual_Background").addSimpleSlice("color",function(){var H={value:i.background};return new U.BT({descriptor:(0,ee.pi)((0,ee.pi)({},a.background),{instanceKind:3}),value:H}).build()},}),this.featureSwitches.applyAllSlicersButton&&c.addGroup("pendingChangesIcon",function(P){P.withDisplayName("PendingIcon").addTopLevelToggle("show",function(){return new U.bd({descriptor:n.show,value:i.pendingChangesIcon.show}).build()}).addSimpleSlice("pendingIconColor",function(){return new U.BT({descriptor:n.color,value:{value:i.pendingChangesIcon.color}}).build()}).addSimpleSlice("pendingIconTransparency",U.JN.getTransparencySliderBuilder({descriptor:n.transparency,value:i.pendingChangesIcon.transparency,localize:function(G){return e.getLocalizedString(G)}}).build()).addSimpleSlice("pendingIconPosition",new U.uY({descriptor:n.position,value:i.pendingChangesIcon.position,filterValues:[F.t$,F.F2]}).build()).addSimpleSlice("pendingIconSize",function(){return new U.mu({descriptor:n.size,value:i.pendingChangesIcon.size,options:{minValue:{type:0,value:1},maxValue:{type:1,value:999},unitSymbol:I.e_}}).build()}).addSimpleSlice("pendingIconTooltip",function(){return new U.bd({descriptor:n.showTooltip,value:i.pendingChangesIcon.showTooltip}).build()}).addSimpleSlice("pendingIconTooltipText",function(){return new U.Jr({descriptor:n.tooltipText,placeholder:"Slicer_PendingChanges",value:i.pendingChangesIcon.tooltipText,localize:function(G){return e.getLocalizedString(G)}}).build()}).addSimpleSlice("pendingIconLabelText",function(){return new U.Jr({descriptor:n.tooltipLabel,placeholder:"  ",value:i.pendingChangesIcon.tooltipLabel,localize:).build()})}),c.build()}},r.prototype.update=function(e,t){z.fF.assertValue(e,"Reader"),$.extend(this.settings,t),this.settings.enableInFocusRenderers&&this.settings.isInFocus?this.data=r.InFocusModeData(this.style,t.text,this.services):(this.originalData=r.converter(e,this.style,t.text,this.services),this.data=this.services.applySlicerHeaderChanges(this.originalData)),this.addSlicerHelperTooltip(),this.maintainSelectMenu(),this.updateTitle()},r.prototype.setFilterRestatement=r.converter=function(e,t,i,a){z.fF.assertValue(e,"Reader");var n=r.DefaultData(t,i,a),c=e.objects.getStaticObjects(),g=Te.v.create(t);if(c){var E=(0,Ze.Zi)((0,o.RK)(c,"header"),{color:"fontColor",family:"fontFamily",size:"textSize"},g,t,"foregroundDark","title",{color:n.fontColor,family:n.fontFamily,size:lt.B.createFromPt(n.textSize)});n.fontColor=E.color,n.fontFamily=E.family,n.textSize=E.size.pt,n.show=(0,o.NA)(c,p.gO.header.show,n.show),n.text=(0,o.NA)(c,p.gO.header.text,n.text),n.menu.fontColor=g.getColorForPropertyWithDefaultColor(c,p.gO.header.fontColor,n.menu.fontColor),n.background=g.getColorForPropertyWithDefaultColor(c,p.gO.header.background,n.background),n.outlineColor=g.getColorForPropertyWithDefaultColor(c,p.gO.general.outlineColor,n.outlineColor),n.outlineWeight=(0,o.NA)(c,p.gO.general.outlineWeight,n.outlineWeight),n.outlineStyle=(0,o.NA)(c,p.gO.header.outlineStyle,n.outlineStyle),n.outline=(0,o.NA)(c,p.gO.header.outline,n.outline),n.searchEnabled=(0,o.NA)(c,p.gO.general.selfFilterEnabled,n.searchEnabled),n.showRestatement=(0,o.NA)(c,p.gO.header.showRestatement,n.showRestatement),n.labelBold=(0,o.NA)(c,p.gO.header.bold,n.labelBold),n.labelItalic=(0,o.NA)(c,p.gO.header.italic,n.labelItalic),n.labelUnderline=(0,o.NA)(c,p.gO.header.underline,n.labelUnderline),n.pendingChangesIcon.show=(0,o.NA)(c,p.gO.pendingChangesIcon.show,n.pendingChangesIcon.show),n.pendingChangesIcon.color=g.getColorForPropertyWithDefaultColor(c,p.gO.pendingChangesIcon.color,n.pendingChangesIcon.color),n.pendingChangesIcon.transparency=(0,o.NA)(c,p.gO.pendingChangesIcon.transparency,n.pendingChangesIcon.transparency),n.pendingChangesIcon.position=(0,o.NA)(c,p.gO.pendingChangesIcon.position,n.pendingChangesIcon.position),n.pendingChangesIcon.size=(0,o.NA)(c,p.gO.pendingChangesIcon.size,n.pendingChangesIcon.size),n.pendingChangesIcon.showTooltip=(0,o.NA)(c,p.gO.pendingChangesIcon.showTooltip,n.pendingChangesIcon.showTooltip),n.pendingChangesIcon.tooltipText=(0,o.NA)(c,p.gO.pendingChangesIcon.tooltipText,(0,et.HZ)(n.pendingChangesIcon.tooltipText)),n.pendingChangesIcon.tooltipLabel=(0,o.NA)(c,p.gO.pendingChangesIcon.tooltipLabel,n.pendingChangesIcon.tooltipLabel)}return n},r.prototype.render=function(){this.header=(0,de.hi)().addClass("slicer-header").appendTo(this.settings.host),this.addTitle(),this.addSlicerHelperTooltip(),this.maintainSelectMenu()},r.prototype.maintainSelectMenu=function(){if((!this.featureSwitches.updateFormattingPaneObjects||!this.featureSwitches.moveSlicerTypeSelection)&&(this.selectMenu||0===this.services.getViewMode()?this.updateSelectMenu():this.addSelectMenu(),this.selectMenuContainer)){var e=this.data;this.selectMenuContainer.find("span.ui-icon").css("color",this.data.iconColor).hover(function(){$(this).css("color",e.iconHoverColor)},function(){$(this).css("color",e.iconColor)})}},r.prototype.addSelectMenu=function(){var e=this,t=this.services.localize("Slicer_SelectMenu_Tooltip");this.selectMenuContainer=(0,de.hi)().addClass(st).toggleClass(J.hY.class,(0,J.Id)()).appendTo(this.title),this.applyTooltip(this.selectMenuContainer,t,this.services.onRenderTooltip);var i={onChange:container:this.selectMenuContainer,options:this.getSelectMenuOptions(),selectedValue:this.settings.selectedValue,className:"slicer-select-menu",disabled:2===this.settings.visibilityState,title:t};this.selectMenu=new at(i),r.addHoverInOut(this.settings.hoverContainer,function(){0!==e.services.getViewMode()&&(e.selectMenuContainer.css("visibility","visible"),e.selectMenuContainer.css("display","flex"))},function(){e.settings.areControlButtonsAlwaysVisible||(_.isEmpty(e.data.text)?e.selectMenuContainer.css("visibility","hidden"):e.selectMenuContainer.css("display","none"))})},r.prototype.addSlicerHelperTooltip=function(){var e=this;if(this.featureSwitches.updateFormattingPaneObjects&&this.featureSwitches.moveSlicerTypeSelection)if(0!==this.services.getViewMode())if(this.selectMenuContainer)this.selectMenuContainer.show();else{var t=this.services.localize("Slicer_Helper_Tooltip");this.selectMenuContainer=(0,de.hi)().addClass(st).toggleClass(J.hY.class,(0,J.Id)()).appendTo(this.title),this.helperTooltipButton=(0,de.yP)().addClass("slicer-helper-tooltip-button").attr("aria-label",t).attr("role","button").attr("tabindex","0"),this.applyTooltip(this.helperTooltipButton,t,this.services.onRenderTooltip),this.helperTooltipButton.appendTo(this.selectMenuContainer);var i=this.data;this.helperButtonIcon=(0,de.yP)().addClass("ui-icon").css("color",this.data.iconColor).hover(function(){$(this).css("color",i.iconHoverColor)},function(){$(this).css("color",i.iconColor)}),this.helperButtonIcon.appendTo(this.helperTooltipButton),r.addHoverInOut(this.settings.hoverContainer,function(){0!==e.services.getViewMode()&&(e.selectMenuContainer.css("visibility","visible"),e.selectMenuContainer.css("display","flex"))},function(){e.settings.areControlButtonsAlwaysVisible||(_.isEmpty(e.data.text)?e.selectMenuContainer.css("visibility","hidden"):e.selectMenuContainer.css("display","none"))})}else this.selectMenuContainer&&this.selectMenuContainer.hide()},r.prototype.addPendingChangesIcon=function(){this.pendingChangesIcon=$(mi).addClass(He).appendTo(this.title)},r.prototype.addPendingChangesText=function(){this.pendingChangesText=(0,de.hi)().append(this.data.pendingChangesIcon.tooltipLabel).addClass("slicer-header-pending-text").appendTo(this.title)},r.prototype.updatePendingChangesIcon=function(){var e=this.data.pendingChangesIcon;e.show&&this.settings.hasUnappliedFilters&&this.featureSwitches.applyAllSlicersButton?(this.pendingChangesIcon.css("display","block"),this.pendingChangesText.css("display","block")):(this.pendingChangesIcon.css("display","none"),this.pendingChangesText.css("display","none")),this.pendingChangesIcon.css("opacity","".concat((0,gt.TD)(this.data.pendingChangesIcon.transparency)));var t=e.size.toString();this.pendingChangesIcon.attr("height","".concat(t)),this.pendingChangesIcon.attr("width","".concat(t)),this.pendingChangesIcon.attr("viewbox","0 0 ".concat(t," ").concat(t)),this.pendingChangesIcon.children(".".concat(Ke)).attr("fill",e.color),e.tooltipText&&this.applyTooltip(this.pendingChangesIcon,e.tooltipText,this.services.onRenderTooltip,e.showTooltip),this.pendingChangesText.text(e.tooltipLabel),e.tooltipLabel||this.pendingChangesText.css("display","none"),"left"===e.position?(this.pendingChangesIcon.css("order","1"),this.pendingChangesText.css("order","2"),this.textElement.css("order","3")):(this.pendingChangesText.css("order","1"),this.pendingChangesIcon.css("order","3"),this.textElement.css("order","2"))},r.prototype.addSpacer=function(){this.spacer=(0,de.hi)(),this.spacer.addClass("slicer-header-spacer").appendTo(this.title)},r.prototype.addTitle=function(){var e=this;this.title=(0,de.hi)(),this.title.addClass("slicer-header-title").appendTo(this.header);var t=this.services.localize("Slicer_Clear");this.clearButton=(0,de.yP)().addClass("slicer-header-clear").toggleClass(J.hY.class,(0,J.Id)()).attr("aria-label",t).attr("role","button").attr("tabindex","0").on("keydown",function(i){("Space"===i.key||"Enter"===i.key)&&e.settings.onClear&&(e.settings.onClear(),i.stopPropagation())}).appendTo(this.title),this.applyTooltip(this.clearButton,t,this.services.onRenderTooltip),this.clearButton.click(,r.addHoverInOut(this.settings.hoverContainer,function(){e.settings.strictSingleSelect||(e.clearButton.css("visibility","visible"),e.clearButton.css("display","block"))},function(){e.settings.areControlButtonsAlwaysVisible||(_.isEmpty(e.data.text)?e.clearButton.css("visibility","hidden"):e.clearButton.css("display","none"))}),this.textElement=$("<h3></h3>").addClass("slicer-header-text").appendTo(this.title),this.addPendingChangesText(),this.addPendingChangesIcon(),this.addSpacer()},r.prototype.applyTooltip=function(e,t,i,a){void 0===a&&(a=!0);var n=null;if(!a)return null==n||n.close(),void e.off("focus mouseenter blur mouseleave keydown");e.on("focus mouseenter",function(){n=i(e.get(0),t)}),e.on("blur mouseleave",,e.on("keydown",function(c){null!==n&&"Escape"===c.key&&(c.stopPropagation(),c.preventDefault(),n.close(),n=null)})},r.prototype.updateTitle=function(){if(this.data.show){var e=ne.FP.fromPoint(this.data.textSize),t=!1;if(this.settings.areControlButtonsAlwaysVisible&&(this.settings.strictSingleSelect||(this.clearButton.css("visibility","visible"),this.clearButton.css("display","block")),0!==this.services.getViewMode()&&this.selectMenuContainer&&(this.selectMenuContainer.css("visibility","visible"),this.selectMenuContainer.css("display","flex"))),this.data.searchEnabled){var i=r.DefaultData(this.style,this.settings.text,this.services);t=(this.featureSwitches.outlineDropdownToCheckboxes?this.data.outlineStyle===i.outlineStyle:this.data.outline===i.outline)&&this.data.outlineWeight===i.outlineWeight&&this.data.outlineColor===i.outlineColor}this.title.show(),this.title.css({"border-style":t?"none":this.data.borderStyle,"border-color":this.data.outlineColor,"border-width":(0,v.$b)(this.featureSwitches.outlineDropdownToCheckboxes?this.data.outlineStyle:this.data.outline,this.data.outlineWeight),"background-color":_.isEmpty(this.data.background)?"":this.data.background,"font-size":e}),this.clearButton.css({"font-size":e}),this.updateTextElementStyle(this.textElement),this.updateTextElementStyle(this.pendingChangesText),this.updateTitleText();var c=this.data;this.clearButton.css("color",this.data.iconColor).hover(function(){$(this).css("color",c.iconHoverColor)},,this.updatePendingChangesIcon()}else this.title.hide()},r.prototype.updateTextElementStyle=function(e){null==e||e.css({"font-size":ne.FP.fromPoint(this.data.textSize),"font-family":this.data.fontFamily,color:this.data.fontColor,"font-weight":this.data.labelBold?ie.en:ie.AI,"font-style":this.data.labelItalic?ie.BF:ie.AI,"text-decoration":this.data.labelUnderline?ie.f0:ie.zu})},r.prototype.updateTitleText=function(){var e=this.data.text;if(this.data.showRestatement&&this.settings.restatement){var t=this.services.localize("NamePattern_Colon");e=(0,Re.W)(t,e,this.settings.restatement)}this.textElement.text(e).attr("title",e).attr("aria-label",e)},r.prototype.updateSelectMenu=function(){this.selectMenu&&0===this.services.getViewMode()?this.selectMenuContainer.hide():this.selectMenu&&(this.selectMenuContainer.show(),this.selectMenu.update({options:this.getSelectMenuOptions(),selectedValue:this.settings.selectedValue,disabled:2===this.settings.visibilityState}))},r.prototype.getSelectMenuOptions=function(){for(var e=[],i=0,a=this.settings.slicerModeOptions;i<a.length;i++){var n=a[i],c=n.displayName({get:this.services.localize});e.push({text:c,value:n.value})}return e},r.prototype.addWarnings=r.addHoverInOut=function(e,t,i){(0,J.Id)()&&e.hover(t,i)},r}(),Xi=S(64365),Zi=function(){function r(){}return r.prototype.renderCore=r.prototype.bindData=function(e,t,i){return this.renderColumns(e,i).selectAll(l.selector).data(function(n){return n},function(n){return(0,J.fz)(n)})},r.prototype.renderColumns=function(e,t){var i=this.numberOfRows,a=_.chunk(e,i),n=t.selectAll(Vi.selector).style("height",null).data(a);n.exit().remove();var c=n.enter().append("div").classed(Vi.class,!0).merge(n);return this.scaleLastColumnIfNeeded(i,a,t),c},r.prototype.scaleLastColumnIfNeeded=function(e,t,i){if(t&&_.last(t)){var n=_.last(t).length;if(n<e){var c=i.select(Vi.selector+":last-child"),g=(0,Xi.W0)(100*n/e,.01);c.style("height",g+"%")}}},r.prototype.findNextElement=function(e,t){return $(e).hasClass(N.class)?t?e.firstElementChild.firstElementChild:e.lastElementChild.lastElementChild:t?!(a=e.nextElementSibling)&&(n=e.parentElement).nextElementSibling?n.nextElementSibling.firstElementChild:a:!(a=e.previousElementSibling)&&(n=e.parentElement).previousElementSibling?n.previousElementSibling.lastElementChild:a;var a,n},r.prototype.getScrollSize=r.prototype.getLastStartIndex=function(e,t){if(t<=e)return 0;var i=0,a=this.numberOfRows,n=t%a;return n>0&&(i=a-n),Math.max(t-e+i,0)},r.prototype.calculateTotalItemDimensions=function(e,t){return e=Math.max(e,r.MinItemWidth),t=Math.max(t,r.MinItemHeight),{width:e+=2*r.TabularMargin,height:t+=2*r.TabularMargin}},r.prototype.calculateNumberOfItemsToDisplay=function(e,t,i,a){var n=e.find(J.uT.selector),c=n.width()-2*r.NavigationArrowWidth,g=n.height();return this.calculateTableDimensions({height:g,width:c},{height:i,width:t},a)},r.prototype.calculateTableDimensions=function(e,t,i){var a=t.width,n=t.height,g=e.height;if(0===a)return 0;var E=Math.floor(e.width/a);this.numberOfRows=0===n?1:Math.floor(g/n),this.numberOfRows=et.b$.clampValue(this.numberOfRows,1,i);var P=Math.ceil(Math.sqrt(i));return E>=P&&this.numberOfRows>=P?this.numberOfRows=E=P:this.numberOfRows>=i&&E>1&&(this.numberOfRows=Math.ceil(this.numberOfRows/E)),et.b$.clampValue(this.numberOfRows*E,this.numberOfRows,i)},r.prototype.getNavigationArrowsClass=function(e,t){t?e.classed(Li.class,!0).classed(k.class,!0).classed(Bi.class,!0).classed(er.class,!0):e.classed(Li.class,!0).classed(se.class,!0).classed(Bi.class,!0).classed(tr.class,!0)},r.prototype.getDataPointRightMargin=r.MinItemWidth=40,r.MinItemHeight=40,r.TabularMargin=2,r.NavigationArrowWidth=19,r}(),qi=(0,ie.CH)("tabular"),Vi=(0,ie.CH)("columnItemContainer"),Bi=(0,ie.CH)("powervisuals-glyph"),Li=(0,ie.CH)("tabularNavigationArrow"),er=(0,ie.CH)("left-nav-arrow"),tr=(0,ie.CH)("right-nav-arrow"),ir=S(72881),zi=S(53543),rr=S(46854),ki=S(83863),nr=S(21157),ot=S(44900),ar=S(69071),sr=S(83427),or=S(74147),Oi=function(){function r(e,t,i){void 0===i&&(i=!0),this.lockKeyboardNavigation=i,this.hasSearchableData=!1,this.scrollPositionStack=[],this.defaultMinWidth=50,this.shouldResetScrollPosition=!1,this.isCollapse=!1,this.expandable=!1,this.pendingFocusCall=!1,this.focusCallback=null,this.verticalSlicerStrategy=e,this.behavior=new me.wV,this.domHelper=new J.gy,this.hostServices=t.hostServices,t&&(this.featureSwitches=t.featureSwitches),this.factory=(0,nr.p)(),this.searchComponent=new b.v(this.hostServices)}return r.prototype.hasSlider=function(){return!1},r.prototype.supportsOrientation=function(){return!this.dataView||!this.data||_.isEmpty(this.data.queryNameByLevel)||1===this.data.queryNameByLevel.length},r.prototype.enumerateObjectInstances=function(e){return(0,J.qo)(e,this.data,this.settings,this.dataView,this.featureSwitches)},r.prototype.getValuesCard=function(){return(0,J.s9)(this.hostServices,this.data,this.settings,this.featureSwitches)},r.prototype.getSlicerSettingsCardOptions=function(e,t,i,a){return(0,J.nD)({cardUidBuilder:e,currentSlicerSettings:this.settings,data:this.data,dataView:this.dataView,hostServices:this.hostServices,orientation:t,activeMode:i,slicerModes:a,featureSwitches:this.featureSwitches})},r.prototype.getAdditionalCards=r.prototype.onModeChange=r.prototype.onDataViewObjectChanged=function(e,t){var i=(0,J.tm)(e,t);return z.fF.assertNonEmpty(i,"There should be at least one save object"),i},r.prototype.getRestatement=r.prototype.onClear=function(e){(0,J.dq)(this.selectionHandler),(0,J.K5)(this.selectionHandler,e),this.searchComponent&&(this.searchComponent.input.node().value="")},r.prototype.init=function(e,t){var i=this;this.element=t,this.currentViewport=e.visualInitOptions.viewport;var n,a=this.hostServices=e.visualInitOptions.host;this.style=e.visualInitOptions.style,this.settings=(0,oe.VT)(this.style),this.behavior&&(n=new ue.N(a,this.behavior));var c=document.createElement("div");c.className=mr.class;var g=this.container=d3.select(c);return this.searchComponent.create(g),this.verticalSlicerStrategy.hasClearSearchButton()&&this.searchComponent.addClearButton(),this.createBodyElement(),this.listView=(0,rr.P)({rowHeight:void 0,enter:update:loadMoreData:function(){return e.loadMoreData()},scrollEnabled:!0,viewport:this.currentViewport,baseContainer:this.body,isReadMode:scrollToFrame:e.enableMultiElementRows?void 0}),this.element.get(0).appendChild(c),this.selectionHandler=n,n},r.prototype.onDestroy=function(){this.listView&&this.listView.destroy()},r.prototype.render=function(e){this.renderVerticalSlicer(this.converter(e.dataView,e.isSlicer),e)},r.prototype.renderVerticalSlicer=function(e,t,i){this.focusCallback&&(ir.M.contains(this.container.node(),document.activeElement)||(this.focusCallback=void 0,this.listView&&this.listView.resetCallBacks())),this.currentViewport=t.viewport,this.hasSearchableData=t.hasSearchableData;var a=t.dataView,n=b.v.fromSlicerSettings(this.settings,null==e?void 0:e.searchKey,this.verticalSlicerStrategy.shouldShowSearchHeader(this.settings,this.hasSearchableData),this.verticalSlicerStrategy.hasClearSearchButton(),this.featureSwitches);if(this.searchComponent.update(n),this.container.node().querySelector("input.searchInput")===document.activeElement&&t.isSearchMode&&this.announceSearchResults(e.slicerDataPoints.length),this.body.select(ji.selector).remove(),a&&this.data&&!_.isEmpty(this.data.slicerDataPoints))this.expandable=this.data.queryNameByLevel.length>1,this.setBodyRole(),this.setBodyAriaLabel(),this.updateSelectionStyle(),this.listView.viewport(this.currentViewport).data(this.data.slicerDataPoints,function(P){return(0,J.fz)(P)},t.resetScrollbarPosition&&this.shouldResetScrollPosition,i);else{if(this.listView&&(this.listView.empty(),this.verticalSlicerStrategy.shouldShowSearchHeader(this.settings,this.hasSearchableData))){var E=this.body.insert("p",".scroll-wrapper").classed(ji.class,!0).text(this.hostServices.getLocalizedString("ContentList_EmptySearchResults"));this.domHelper.setSlicerTextStyle(E,this.settings,this.featureSwitches)}i&&i()}},r.prototype.converter=function(e,t){void 0===t&&(t=!1);var i=this.hostServices.getLocalizedString(J.vx),a=(0,oe.OQ)({dataView:e,localizedSelectAllText:i,selectionHandler:this.selectionHandler,hostServices:this.hostServices,style:this.style,isSlicer:t,featureSwitches:this.featureSwitches,slicerType:0});return this.shouldResetScrollPosition=this.getShouldResetScrollPosition(e,a),this.data=a,this.isCollapse=!1,e&&this.data&&(this.settings=a.slicerSettings,this.dataView=e),a},r.prototype.hasSearchEnabled=r.prototype.updateSelectionStyle=function(){var e=this.settings;this.container.classed("isMultiSelectEnabled",e&&e.selection&&!e.selection.singleSelect)},r.prototype.createDataPoints=function(e){var t=this,i=this,a=this.settings,n=e.append("div").classed(Fi.class,!0),c=n.append("div").classed(yi.class,!0).attr("aria-hidden",!0);this.verticalSlicerStrategy.customizeInputElement(c,a);var g=this.selectionHandler.isSelectionModeInverted();n.on("contextmenu",function(P,H){d3.event.stopPropagation(),d3.event.preventDefault(),t.onContextMenu(P,{x:d3.event.clientX,y:d3.event.clientY})}),n.call(r.updateTabIndex);var E=this.getOptionRole();n.each(function(P,H){var G=this,le=d3.select(this);this.addEventListener("keydown",function(X){var ce=le.data();if(!_.isEmpty(ce)){var fe=ce[0],ze=if(39===X.keyCode&&!0===fe.isCollapsed||37===X.keyCode&&!1===fe.isCollapsed){var $e=document.activeElement;X.stopPropagation(),i.expandCollapseNode(fe),ze(function(){return(0,ee.mG)(G,void 0,ot.J,function(){return(0,ee.Jh)(this,function(Ye){return[2,i.focusRowAtIndex($e,i.getCurrentRowDataIndex($e),!1,!1,!1,!1,!1,!0)]})})})}else 39===X.keyCode&&fe.children?ze(function(){return(0,ee.mG)(G,void 0,ot.J,function(){return(0,ee.Jh)(this,function(Ye){return[2,i.focusRowAtIndex(document.activeElement,fe.children[0].index,!1,!0,!1,!1,!0,!1)]})})}):37===X.keyCode&&fe.parent?ze(function(){return(0,ee.mG)(G,void 0,ot.J,function(){return(0,ee.Jh)(this,function(Ye){return[2,i.focusRowAtIndex(document.activeElement,fe.parent.index,!1,!1,!0,!1,!0,!1)]})})}):39===X.keyCode||37===X.keyCode?X.stopPropagation():56===X.keyCode&&(X.stopPropagation(),i.expandCollapseAllNodesOnSameLevel(fe))}}),i.updateItemState(le,P),i.setAccessibilityAttributes(P,le,E,g),le.attr("data-row-index",P.index).attr("data-row-id",P.id),null!=P.count&&le.append("span").classed(J.HR.class,!0).styles({"font-size":ne.FP.fromPoint(a.slicerText.textSize),"font-family":a.slicerText.fontFamily})})},r.prototype.getUnusedAriaStatus=r.prototype.setAccessibilityAttributes=function(e,t,i,a){t.attr("role",i.role).attr(i.selected,(0,J.OO)(e,a)).attr("aria-setsize","-1").attr("title",(0,J.rX)(this.hostServices,e.tooltip)).attr("aria-posinset",e.levelIndex?e.levelIndex:1)},r.updateTabIndex=function(e){var t,i=!1;e.each(function(a,n){var c=d3.select(this);0===n&&(t=c),i||"0"!==c.attr("tabindex")?i&&"0"===c.attr("tabindex")&&c.attr("tabindex",null):i=!0}),t&&!i&&t.attr("tabindex","0")},r.prototype.updateItemType=function(e,t){var i=e.select(J.Iy.selector),a=e.select(J.NV.selector);if(t.isImage)return a.remove(),i.empty()&&(i=e.append("img").classed(J.Iy.class,!0)),i.attr("src",t.value),void i.attr("role","none");a.empty()&&(i.remove(),a.empty()&&(a=e.append("span").classed(J.NV.class,!0))),a.text(t.value)},r.prototype.getOptionRole=function(){return{role:this.expandable?"treeitem":"option",selected:"aria-selected"}},r.prototype.updateDataPoints=function(e,t){var i=this.settings,a=this.data;if(a&&i){var n=this.domHelper,c=this.selectionHandler.isSelectionModeInverted();e.select(Fi.selector),e.select(yi.selector),e.select(Hi.selector),this.verticalSlicerStrategy.updateInputElement(e.selectAll(yi.selector),i);var g=e.selectAll(J.HR.selector);if(!g.empty()&&this.verticalSlicerStrategy.shouldShowCount()&&(e.select(Sr.selector),g.text(function(ze){return ze.count}),n.setSlicerTextStyle(g,i,this.featureSwitches)),t&&this.body){var E=this,P=this.body.attr("width",this.currentViewport.width),H=this.getOptionRole(),G=this.body.selectAll(Fi.selector);G.each(function(ze,$e){var Ye=d3.select(this);E.updateItemState(Ye,ze),Ye.node().hasAttribute("role")&&Ye.attr(E.getUnusedAriaStatus(),null),E.setAccessibilityAttributes(ze,Ye,H,c),null!=i.items.padding&&(Ye.style("padding-top","".concat(i.items.padding,"px")),Ye.style("padding-bottom","".concat(i.items.padding,"px")))});var le=e.selectAll(J.NV.selector);this.verticalSlicerStrategy.setLabelTextStyle(n,le,i,this.style,this.featureSwitches),r.updateTabIndex(G);var X=P.selectAll(yi.selector);t.bind(a.retainedDataPoints,{behaviorOptions:{slicerContainer:this.container,itemContainers:G,itemInputs:X,settings:a.slicerSettings,searchInput:this.searchComponent.input,clearSearchTextButton:this.searchComponent.clear,style:this.style},orientation:0})}this.behavior.renderSelection()}},r.prototype.announceSearchResults=function(e){var t;t=0===e?this.hostServices.getLocalizedString("ContentList_EmptySearchResults"):1===e?this.hostServices.getLocalizedString("Count_SearchBox_Result_One"):this.hostServices.getLocalizedString("Count_SearchBox_Results").replace("{0}",e.toString()),this.hostServices.alertWithDebounce("announce-search",t)},r.prototype.getExpandParameters=function(e){z.fF.assert(".expandCollapseNode should not be called with un-expandable node"),this.isCollapse=!1===e.isCollapsed;var t=(0,J.No)(e,this.data.queryNameByLevel);return{dataRoles:[p.CT.value],data:t.selector,isCollapse:!e.isCollapsed,nodeIndex:t.path}},r.prototype.expandCollapseNode=function(e){var t=this.getExpandParameters(e);this.hostServices.setNodeExpansionState({dataRoles:t.dataRoles,data:t.data,isCollapse:t.isCollapse,nodeIndex:t.nodeIndex})},r.prototype.expandCollapseAllNodesOnSameLevel=function(e){var t=this.getExpandParameters(e);this.hostServices.setLevelExpansionState({dataRoles:t.dataRoles,data:t.data,isCollapse:t.isCollapse,nodeIndex:t.nodeIndex})},r.prototype.onContextMenu=function(e,t){var i=(0,J.No)(e,this.data.queryNameByLevel),n={nodeIndex:i.path,dataRoles:[p.CT.value],position:{x:d3.event.clientX,y:d3.event.clientY},data:[i.selector]};this.hostServices.onContextMenu(n)},r.prototype.getShouldResetScrollPosition=function(e,t){if(!this.dataView||!this.data||!e||!t||this.isCollapse)return!1;if(1===this.data.queryNameByLevel.length)return!(0,sr.ih)(e,this.dataView);if((0,ki.s_)(this.data.queryNameByLevel,t.queryNameByLevel,){if(!_.isEmpty(this.data.slicerDataPoints)&&!_.isEmpty(t.slicerDataPoints)&&this.data.slicerDataPoints.length>t.slicerDataPoints.length&&!this.isCollapse){var i=this.listView.getFirstVisibleRow();return!i||void 0!==i.levelIndex&&!_.some(t.slicerDataPoints,}return!1}if(this.dataView.matrix&&this.dataView.matrix.rows&&e.matrix&&e.matrix.rows){var a=_.map(this.dataView.matrix.rows.levels,function(c){return c.sources[0].expr}),n=_.map(e.matrix.rows.levels,;return!(0,ki.s_)(a,n,or.fS)}return!0},r.prototype.updateExpansionState=function(e,t){var i=0;t.level>0&&(i=t.level*ne.FP.fromPointToPixel(this.data.slicerSettings.expandCollapse.indentation)),e.styles({"margin-left":"".concat(i,"px")}),this.updateExpandButton(e,t)},r.prototype.updateExpandButton=function(e,t){var i=e.select(Hi.selector);this.expandable&&(i.empty()&&(i=this.createExpandButton(e)),e.attr("aria-expanded",void 0===t.isCollapsed?null:!t.isCollapsed),void 0!==t.level&&e.attr("aria-level",t.level+1));var n=ne.FP.fromPoint(this.data.slicerSettings.slicerText.textSize);if(i.styles({"font-size":n,width:n}),i.attr("aria-hidden","true"),void 0!==t.isCollapsed){var c=this.data.slicerSettings.expandCollapse.toggleType;i.classed(Ui.class,!1),i.selectAll(".glyphicon").classed("pbi-glyph-chevrondownsmall",t.isCollapsed&&0===c).classed("pbi-glyph-chevronupsmall",!t.isCollapsed&&0===c).classed("pbi-glyph-explore-content-single",t.isCollapsed&&1===c).classed("pbi-glyph-collapse-content-single",!t.isCollapsed&&1===c).classed("pbi-glyph-caretright",t.isCollapsed&&2===c).classed("pbi-glyph-caretdownright",!t.isCollapsed&&2===c)}else this.expandable||i.empty()?i.classed(Ui.class,!0):i.remove()},r.prototype.createExpandButton=function(e){var t=this,i=e.insert("div",":first-child").classed(Hi.class,!0).on("click",;return i.append("i").classed("glyphicon",!0),i},r.prototype.scrollToFrameForMultiElementRow=function(e){var t=e.listView,i=e.loadMoreData,a=e.rowHeight,n=e.scrollTop,c=e.totalRows,g=e.visibleGroupContainer,E=e.baseContainer,P=0===n?0:Math.floor(n/a);if(!(this.currentRowPosition&&P===this.currentRowPosition||P<0)){var H=(0,ar.O7)(0,P*a);g.styles({transform:"-webkit-transform":H});var G=g.selectAll(".row").filter(;return void 0===this.currentRowPosition?(this.currentPosition=this.getInitialPosition(c,E),G&&G.node()&&(this.currentRowPosition=P)):(this.updateCurrentPosition(P,c,E,g,G),this.currentRowPosition=P),t.performScrollToFrame(this.currentPosition.startIndex,this.currentPosition.endIndex,c,this.currentPosition.endIndex-this.currentPosition.startIndex,i)}},r.prototype.getInitialPosition=function(e,t){var i=e,a=Math.ceil($(t.node()).outerHeight()/this.listView.getRowHeight())*Math.floor($(t.node()).outerWidth()/this.defaultMinWidth);return a>0&&(i=Math.min(e,a)),{startIndex:0,endIndex:i}},r.prototype.updateCurrentPosition=function(e,t,i,a,n){var c=Math.abs(e-this.currentRowPosition);if(e===this.currentRowPosition)this.currentPosition=this.scrollPositionStack.pop()||this.getInitialPosition(t,i);else if(e<this.currentRowPosition)for(;c>0;)this.currentPosition=this.scrollPositionStack.pop()||this.currentPosition,c--;else for(;c>0;){var g=Math.ceil($(i.node()).outerHeight()/$(n.node()).outerHeight());if(this.currentPosition.startIndex>=t-1)return;this.scrollPositionStack.push(this.currentPosition);var E=this.getElementsPerRow(a,g,n),P=this.currentPosition.startIndex+E[0];this.currentPosition={startIndex:P,endIndex:Math.min(t,P+_.sum(E)+this.getMaxElementsInRow(a,n))},c--}},r.prototype.getElementsPerRow=function(e,t,i){for(var a=[],n=i.node(),c=0;c<t&&null!==n;c++){a.push(0);for(var g=$(n).position().top;null!==n&&$(n).position().top<=g+5;)a[c]++,n=n.nextElementSibling}return a},r.prototype.getMaxElementsInRow=function(e,t){var i=t.node().getAttribute("min-width");return i?$(e.node()).outerWidth()/+i:Math.floor($(e.node()).outerWidth()/this.defaultMinWidth)},r.prototype.createBodyElement=function(){var e=this;this.body=this.container.append("div").classed(J.uT.class,!0);var t=this.searchComponent.input.node();this.body.on("wheel",function(){e.focusCallback=void 0,e.listView.resetCallBacks(),e.listView.onScroll()}),t.addEventListener("keydown",function(i){40===i.keyCode?(e.searchBarFocusNextElement(),i.preventDefault(),i.stopPropagation()):70===i.keyCode&&i.ctrlKey&&(e.searchBarFocusNextElement(),e.enableSearch(),i.preventDefault(),i.stopPropagation())}),this.body.on("keydown",function(){var i=d3.event,a=function(le){i.preventDefault(),i.stopPropagation(),e.pendingFocusCall||le()};if(40===i.keyCode){var n=document.activeElement,c=i.shiftKey;a(function(){return(0,ee.mG)(e,void 0,ot.J,function(){return(0,ee.Jh)(this,function(G){return[2,this.focusRowAtIndex(n,this.getCurrentRowDataIndex(document.activeElement)+2,!1,!0,!0,c,!1,!1)]})})})}else if(38===i.keyCode){var g=document.activeElement,E=i.shiftKey;e.settings.search.enabled&&0===e.getCurrentRowDataIndex(g)||e.settings.search.enabled&&1===e.getCurrentRowDataIndex(g)&&!e.settings.selection.selectAllCheckboxEnabled?(e.focusForJumpRow(t),a(function(){return(0,ee.mG)(e,void 0,ot.J,})):a(function(){return(0,ee.mG)(e,void 0,ot.J,function(){return(0,ee.Jh)(this,function(G){return[2,this.focusRowAtIndex(g,this.getCurrentRowDataIndex(document.activeElement)-3,!1,!1,!0,E,!1,!1)]})})})}else if(9===i.keyCode)e.lockKeyboardNavigation&&e.body.node().focus();else if(35===i.keyCode)a(function(){return(0,ee.mG)(e,void 0,ot.J,function(){return(0,ee.Jh)(this,function(G){return[2,this.focusRowAtIndex(document.activeElement,this.data.slicerDataPoints.length,!1,!0,!1,!1,!1,!1)]})})});else if(36===i.keyCode)a(function(){return(0,ee.mG)(e,void 0,ot.J,function(){return(0,ee.Jh)(this,function(G){return[2,this.focusRowAtIndex(document.activeElement,1,!1,!1,!1,!1,!1,!1)]})})});else if(34===i.keyCode){var P=document.activeElement;a(function(){return(0,ee.mG)(e,void 0,ot.J,function(){return(0,ee.Jh)(this,function(G){return[2,this.focusRowAtIndex(P,this.getCurrentRowDataIndex(document.activeElement)+this.getRowsPerPage(),!0,!0,!1,!1,!1,!1)]})})})}else if(33===i.keyCode){var H=document.activeElement;a(function(){return(0,ee.mG)(e,void 0,ot.J,function(){return(0,ee.Jh)(this,function(G){return[2,this.focusRowAtIndex(H,Math.max(this.getCurrentRowDataIndex(document.activeElement)-this.getRowsPerPage(),1),!1,!1,!1,!1,!1,!1)]})})})}else 70===i.keyCode&&i.ctrlKey&&a(function(){return(0,ee.mG)(e,void 0,ot.J,})})},r.prototype.setBodyRole=function(){this.body.attr("role",this.expandable?"tree":"listbox"),this.body.attr("aria-multiselectable",!(this.data&&this.data.slicerSettings.selection.strictSingleSelect))},r.prototype.setBodyAriaLabel=r.prototype.enableSearch=function(){var e;if(this.settings.search){this.settings.search.enabled=!this.settings.search.enabled;var t=b.v.fromSlicerSettings(this.settings,null===(e=this.data)||void 0===e?void 0:e.searchKey,this.verticalSlicerStrategy.shouldShowSearchHeader(this.settings,this.hasSearchableData),this.verticalSlicerStrategy.hasClearSearchButton(),this.featureSwitches);this.searchComponent.update(t)}},r.prototype.focusRowAtIndex=function(e,t,i,a,n,c,g,E){var P=this,H=this.factory.defer(),G=e.getAttribute("data-row-id"),le=d3.event;return this.focusCallback=void 0,this.listView.resetCallBacks(),this.pendingFocusCall?H.resolve(1):(this.pendingFocusCall=!0,this.focusCallback=function(){var X,ce,fe=$(P.container.node()).find(".visibleGroup").get(0),ze=$(fe).find("[data-row-id='"+G+"']").get(0);if(ze?ce=(e=ze).parentElement:X=void 0,e&&P.removeFocusForJumpRow(e),E)e?P.focusForJumpRow(e):a||ce.previousElementSibling||e.addEventListener("blur",;else if(n||g||!fe?n&&!g&&ce?!X&&a&&ce.nextElementSibling?X=ce.nextElementSibling.firstElementChild:!X&&!a&&ce.previousElementSibling&&(X=ce.previousElementSibling.firstElementChild):g&&fe&&(a?(X=P.selectItemFromRowId(d3.select(e).data()[0].children[0].id,fe),X=P.adjustBottomRowToInViewRow(X,fe)):(X=P.selectItemFromRowId(d3.select(e).data()[0].parent.id,fe),X=P.adjustTopRowToInViewRow(X,fe))):!X&&a?X=P.adjustBottomRowToInViewRow(X=fe.lastElementChild.firstElementChild,fe):!X&&!a&&(X=P.adjustTopRowToInViewRow(X=fe.firstElementChild.firstElementChild,fe)),X){if(P.focusForJumpRow(X),c&&P.pendingFocusCall){var $e=P.settings;$e.selection.singleSelect=$e.selection.strictSingleSelect,me.wV.toggleItemSelectionFromExternal(le,d3.select(X).data()[0],P.selectionHandler,$e),P.setAccessibilityAttributes(d3.select(X).data()[0],d3.select(X),P.getOptionRole(),P.selectionHandler.isSelectionModeInverted())}}else e&&P.focusForJumpRow(e);P.pendingFocusCall=!1,H.resolve(0)},this.listView.scrollRowIntoView(t-1,this.focusCallback)),H.promise},r.prototype.getCurrentRowDataIndex=function(e){if(e){var t=d3.select(e).data()[0];if(t)return t.index}return 1},r.prototype.adjustBottomRowToInViewRow=function(e,t){return e.getBoundingClientRect().y+e.getBoundingClientRect().height>this.container.node().getBoundingClientRect().y+this.container.node().getBoundingClientRect().height&&(e=t.lastElementChild.previousElementSibling.firstElementChild),e},r.prototype.adjustTopRowToInViewRow=function(e,t){return e.getBoundingClientRect().y<=t.getBoundingClientRect().y&&this.listView.canScrollTop()&&(e=t.firstElementChild.nextElementSibling.firstElementChild),e},r.prototype.getRowsPerPage=function(){return this.listView.getVisibleRowsWithoutPadding()},r.prototype.selectItemFromRowId=function(e,t){return d3.select(t).select("[data-row-id='"+e+"']").node()},r.prototype.searchBarFocusNextElement=function(){var e=$(this.container.node()).find(".visibleGroup").get(0);this.focusForJumpRow(e.firstElementChild.firstElementChild)},r.prototype.focusForJumpRow=function(e){e.setAttribute("tabindex","0"),e.setAttribute("focusable","true"),e.classList.add(zi.Pg),bt.M.focus(e,{preventScroll:!0})},r.prototype.removeFocusForJumpRow=function(e){e.setAttribute("tabindex","-1"),e.removeAttribute("focusable"),e.classList.remove(zi.Pg)},r.prototype.updateItemState=function(e,t){this.updateExpansionState(e,t),this.updateItemType(e,t),(0,J.hx)(e,t)},r}(),Wi=function(){function r(){}return r.prototype.canShowSearchHeader=r.prototype.hasClearSearchButton=function(){return!1},r.prototype.setLabelTextStyle=r.prototype.shouldShowSearchHeader=function(e,t){return this.strictSingleSelect=e.selection.strictSingleSelect,e.search.enabled&&this.canShowSearchHeader(e,t)},r.prototype.shouldShowCount=function(){return!0},r.prototype.updateInputElement=function(e,t){e.selectAll("span").style("font-size",ne.FP.fromPoint(t.slicerText.textSize)).classed(this.strictSingleSelect?"radiobutton":"checkbox",!0).classed(this.strictSingleSelect?"checkbox":"radiobutton",!1)},r.prototype.customizeInputElement=function(e,t){e.append("span").style("font-size",ne.FP.fromPoint(t.slicerText.textSize)).classed("glyphicon",!0).classed(this.strictSingleSelect?"radiobutton":"checkbox",!0).classed(t.items.accessibilityContrastProperties?"checkboxOutlineContrast":"checkboxOutline",!0)},r}(),vr=qe.Wn.regular.css,gr=function(){function r(){}return r.prototype.hasClearSearchButton=function(){return!0},r.prototype.setLabelTextStyle=function(e,t,i,a,n){var c=(0,oe.VT)(a);c.slicerText.textSize=ne.FP.toPoint(13),c.slicerText.fontFamily=vr,c.slicerText.color=Te.v.getThemeColor(a,Ct.fA),e.setSlicerTextStyle(t,c,n)},r.prototype.canShowSearchHeader=r.prototype.shouldShowSearchHeader=r.prototype.updateInputElement=r.prototype.shouldShowCount=r.prototype.customizeInputElement=r}(),mr=(0,ie.CH)("slicerContainer"),Fi=(0,ie.CH)("slicerItemContainer"),yi=(0,ie.CH)("slicerCheckbox"),Hi=(0,ie.CH)("expandButton"),Ui=(0,ie.CH)("hidden"),Sr=(0,ie.CH)("slicerCountText"),ji=(0,ie.CH)("slicerEmptyResult"),Ft=S(9540),ti=S(99747),yr=function(){function r(){}return r.prototype.applyChanges=function(e,t,i){var a=t;return Ft.a.shouldApplyResponsiveChanges(i,p.gO)&&(a=this.applyResponsiveSlicerChanges(e,a),this.updateWarnings(a,t)),a},r.prototype.applyResponsiveSlicerChanges=function(e,t){var i=(0,ti.ED)(t);return this.applyFontSizeChanges(e,i),i},r.prototype.applyFontSizeChanges=function(e,t){var i=Ve(e,ge_horizontalSlicer.fontSize);t.slicerSettings.slicerText.textSize>i&&(t.slicerSettings=(0,ti.ED)(t.slicerSettings),t.slicerSettings.slicerText=(0,ti.ED)(t.slicerSettings.slicerText),t.slicerSettings.slicerText.textSize=i)},r.prototype.updateWarnings=function(e,t){if(e.slicerSettings.slicerText.textSize!==t.slicerSettings.slicerText.textSize){var i=new q.Yx;e.warnings.addForVisualObject("items",{selector:null,warnings:[i]})}},r}(),_i=function(){function r(){}return r.prototype.applyChanges=function(e,t,i){return Ft.a.shouldApplyResponsiveChanges(i,p.gO)&&(t=this.applyResponsiveRangeSlicerChanges(e,t)),t},r.prototype.applyResponsiveRangeSlicerChanges=function(e,t){var i=(0,ti.ED)(t);return this.applyRangeSlicerDataChanges(i),this.applySliderChanges(i),i},r.prototype.applySliderChanges=function(e){e.sliderSettings=(0,ti.ED)(e.sliderSettings),e.sliderSettings.drawRoundSliderHandles=!0,e.sliderSettings.minSliderVisibilityHeight=r.MinSliderVisibilityHeight,e.sliderSettings.minSliderVisibilityWidth=r.MinSliderVisibilityWidth},r.prototype.applyRangeSlicerDataChanges=r.MinSliderVisibilityHeight=35,r.MinSliderVisibilityWidth=0,r}(),Cr=function(){function r(){}return r.prototype.applySlicerChanges=function(e,t,i){return this.shouldApplyResponsiveChanges(i,t.mode,t.orientation)&&(t=this.applyResponsiveSlicerChanges(e,t)),t},r.prototype.applySlicerHeaderChanges=function(e,t,i,a,n){return t.show&&this.shouldApplyResponsiveChanges(i,a.mode,a.orientation)&&(t=this.applyResponsiveSlicerHeaderChanges(e,t,a,n)),t},r.prototype.enumerateObjectInstances=function(e,t,i,a,n){this.doesSlicerModeSupportsResponsive(a,n)&&"general"===e.objectName&&this.enumerateGeneral(i,t)},r.prototype.enumerateGeneral=function(e,t){z.fF.assert(function(){return null===t[0].selector},"objects[0].selector === null");var i=Ft.a.getResponsiveVisualProperties(e,p.gO);_.merge(t[0],{selector:null,properties:{responsive:i.responsive},objectName:"general"})},r.prototype.getResponsiveSlice=function(e,t,i,a){if(this.doesSlicerModeSupportsResponsive(t,i)){var c=p.gO.general,g=Ft.a.getResponsiveVisualProperties(e,p.gO);return{item:new U.vi({uidBuilder:new U.IN(new U.SS(new U.lg("visualPlaceholderCard"),"visualPlaceholderGroup"),"responsive"),control:new U.bd({descriptor:c.responsive,value:g.responsive}).build(),localize:a}).build(),revertToDefaultDescriptors:[c.responsive]}}},r.prototype.shouldApplyResponsiveChanges=function(e,t,i){return this.doesSlicerModeSupportsResponsive(t,i)&&Ft.a.shouldApplyResponsiveChanges(e,p.gO)},r.prototype.doesSlicerModeSupportsResponsive=r.prototype.applyResponsiveSlicerChanges=function(e,t){var i=Ft.a.cloneData(t);return this.applyIconResponsiveChanges(e,i),this.applyResponsiveSlicerHorizontalChanges(i),i},r.prototype.applyResponsiveSlicerHeaderChanges=function(e,t,i,a){var n=Ft.a.cloneData(t);return this.applyHeaderChanges(e,i,n,a),this.updateResponsiveHeaderWarnings(n,t),n},r.prototype.applyIconResponsiveChanges=function(e,t){var i;r.isRangeSlicerMode(t.mode)?i=ge_rangeSlicer.iconBreakpoints:r.isHorizontalSlicer(t.mode,t.orientation)?i=ge_horizontalSlicer.iconBreakpoints:z.fF.assertFail("not supported slicer (mode: ".concat(t.mode,", orientation: ").concat(t.orientation,") should never arrive this function.")),_.some(i,&&(t.showIcon=!0)},r.prototype.applyResponsiveSlicerHorizontalChanges=function(e){r.isHorizontalSlicer(e.mode,e.orientation)&&(e.showTabularSlicer=!0)},r.prototype.applyHeaderChanges=function(e,t,i,a){if(r.isRangeSlicerMode(t.mode)){var n=ge_rangeSlicer;i.show=a?e.height>=n.hideHeaderHeightSlider:e.height>=n.hideHeaderHeightNoSlider}else r.isHorizontalSlicer(t.mode,t.orientation)?i.show=e.height>=(n=ge_horizontalSlicer).hideHeaderHeight:z.fF.assertFail("not supported slicer (mode: ".concat(t.mode,", orientation: ").concat(t.orientation,") should never arrive this function."));var c=Ve(e,ge_slicerHeader_fontSize);i.textSize=Math.min(i.textSize,c)},r.prototype.updateResponsiveHeaderWarnings=function(e,t){var i;e.show!==t.show?i=new q.C_:e.textSize!==t.textSize&&(i=new q.Fy),i&&e.warnings.addForVisualObject("header",{selector:null,warnings:[i]})},r.isRangeSlicerMode=r.isHorizontalSlicer=function(e,t){return e===D.RB&&1===t},r}(),Ki="slicer-container",$i="slicer-content-wrapper",Ni="full-screen";function Ai(r){return D.dt.members(r?[D.Ih,D.of,D.j6]:[D.RB,D.j6])}var Mr=function(){function r(e){this.areControlButtonsAlwaysVisible=!1,this.tooltip=null,this.enableInFocusRenderers=!1,this.enableMultiElementRows=!1,this.preventVirtualKeyboardOnTheFirstTap=!1,this.isInFocus=!1,this.hasSearchableData=!1,this.lockKeyboardNavigation=!0,this.isSlicer=!1,this.hasUnappliedFilters=!1,e&&(this.enableInFocusRenderers=e.enableInFocusRenderers,this.enableMultiElementRows=e.enableMultiElementRows,this.preventVirtualKeyboardOnTheFirstTap=e.preventVirtualKeyboardOnTheFirstTap,this.lockKeyboardNavigation=!1!==e.lockKeyboardNavigation,this.featureSwitches=e.featureSwitches,this.isSlicer=e.isSlicer),this.activeMode=D.RB,this.slicerOrientation=0,this.viewModelAdapter=new Cr}return r.prototype.init=function(e){var t=this;this.initOptions=e,this.element=e.element,this.style=e.style,this.visibilityHelper=(0,te.q)().visibilityHelper(this.element,"slicerResponsiveIcon"),this.currentViewport=e.viewport,this.hostServices=e.host,this.loadMoreHandler=new y.J(this.hostServices),this.container=(0,de.hi)().addClass(Ki).appendTo(this.element),this.alert=(0,de.yP)().appendTo(this.container).attr("aria-live","polite").attr("role","status").hide(),this.headerContainer=(0,de.hi)().appendTo(this.container).addClass("slicer-header-wrapper"),this.slicerContainer=(0,de.hi)().appendTo(this.container).addClass($i),this.initializeSlicerRenderer(),this.container.on(L.BZ,function(){t.areControlButtonsAlwaysVisible=!0,t.container.addClass("focused"),t.alert.text(t.activeMode);var i=!!t.slicerRenderer&&t.slicerRenderer.hasSlider();t.updateSlicerHeader(i)}),this.container.on("focusin",},r.prototype.destroy=function(){this.slicerRenderer.onDestroy&&this.slicerRenderer.onDestroy(),this.slicerHeader&&this.slicerHeader.destroy()},r.prototype.update=function(e){z.fF.assertValue(e,"options"),this.isInFocus=!!e.isInFocus,e.type&u.EP.Resize&&this.resizing(e.viewport),e.type&u.EP.FilterOptionsChange&&(this.hasUnappliedFilters=e.pendingChanges[0],this.updateSlicerHeader(this.slicerRenderer.hasSlider())),(!e.type||e.type&u.EP.Data)&&(z.fF.assertValue(e,"options"),this.dataChanged(e.dataViews,e.operationKind))},r.prototype.dataChanged=function(e,t){z.fF.assertValue(e,"dataViews"),_.isEmpty(e)||(this.dataView=e[0],this.render(t!==u.su.Append,!0))},r.prototype.resizing=r.prototype.enumerateObjectInstances=function(e){if(this.dataView)switch(e.objectName){case"header":case"modeSelection":return this.slicerHeader.enumerateObjectInstances(e);case"general":var t=this.slicerHeader.enumerateObjectInstances(e);return this.slicerRenderer&&this.slicerRenderer.supportsOrientation()&&(t[0].properties.orientation=this.data?this.data.orientation:0),this.viewModelAdapter&&this.viewModelAdapter.enumerateObjectInstances(e,t,this.dataView,this.activeMode,this.slicerOrientation),t;default:return this.slicerRenderer.enumerateObjectInstances(e,this.featureSwitches)}},r.prototype.onDataViewObjectChanged=function(e,t){if(this.featureSwitches.updateFormattingPaneObjects&&this.featureSwitches.moveSlicerTypeSelection){var i=this.slicerRenderer.onDataViewObjectChanged(e,t);return z.fF.assertNonEmpty(i,"There should be at least one object property to save"),i}return e},r.prototype.getFormattingModel=function(){var e=this;if(this.dataView)return new U.Nq(function(){return e.getSlicerSettingsCard()},function(){return e.slicerHeader.getSlicerHeaderCard(e.hostServices)},.build()},r.prototype.getSlicerSettingsCard=function(){var e=this;if((0,D.Ek)(this.activeMode)||this.featureSwitches.updateFormattingPaneObjects||this.featureSwitches.moveSlicerTypeSelection){var i,t=new U.lg("slicerSettings");this.slicerRenderer&&this.slicerRenderer.supportsOrientation()&&(i=this.data?this.data.orientation:0);var a=this.data?this.data.activeOptions:Ai(this.featureSwitches.updateFormattingPaneObjects&&this.featureSwitches.moveSlicerTypeSelection);if(this.data.isCategorySourceNumeric){for(var n=[],c=0,g=this.data.activeOptions;c<g.length;c++)n.push(ui.members([g[c].value])[0]);a=(0,ee.ev)([],n,!0)}var P=this.slicerRenderer.getSlicerSettingsCardOptions(t,i,this.activeMode,a,this.featureSwitches);if(P){var H=P.groups;return new U.CQ(t,"Slicer_Settings",P.revertToDefaultDescriptors,function(X){return e.hostServices.getLocalizedString(X)}).withGroups(H).build()}}},r.prototype.resolveFormattingPlaceholder=function(e){if((0,U.n$)(e)&&"responsive"===e.name)return this.getResponsiveSlice()},r.prototype.getResponsiveSlice=function(){var e=this;if(this.dataView&&this.viewModelAdapter)return this.viewModelAdapter.getResponsiveSlice(this.dataView,this.activeMode,this.slicerOrientation,},r.prototype.loadMoreData=r.prototype.onClearSelection=r.converter=function(e,t,i){if(e){var E,a=t.updateFormattingPaneObjects&&t.moveSlicerTypeSelection,n=null,c=0,g=!1,P=!1,H=Ai(a),G=1,le=!1;if(e.metadata&&e.metadata.objects){var X=e.metadata.objects;c=(0,o.NA)(X,p.gO.general.orientation,c),g=(0,o.NA)(X,p.gO.selection.strictSingleSelect,g),n=(0,o.NA)(X,p.gO.data.mode,n)}if(e.metadata&&e.metadata.columns){var ce=(0,J.zJ)(e.metadata.columns);if(!_.isEmpty(ce)){var fe=ce[0];n=(0,ve.D_)(ce,n),E=_.join(_.map(ce,function($e){return $e.displayName}),i),le=!_.some(ce,,1===ce.length?(le=!0===fe.type.text,P=!0===fe.type.numeric,fe.parameter&&1===fe.parameter.kind?(H=_.union(Ai(a),D.dt.members([n])),g=g||!fe.parameter.supportsMultipleValues):!0===fe.type.dateTime?H=function(r){return D.dt.members(r?[D.Ih,D.of,D.j6,D.bb,D.e4,D.vX,D.K8,D.GV]:[D.RB,D.j6,D.bb,D.e4,D.vX,D.K8,D.GV])}(a):P&&(H=_.union(H,function(r){return D.dt.members(r?[D.Ih,D.of,D.j6,D.bb,D.e4,D.vX]:[D.RB,D.j6,D.bb,D.e4,D.vX])}(a)),fe.parameter&&(H=_.union(H,D.dt.members([D.Zr]))))):(c=0,a&&(H=D.dt.members([D.Ih,D.j6]))),(0,D.Lw)(n)&&1===ce.length&&(G=fe.aggregates&&null!=fe.aggregates.min&&null!=fe.aggregates.max?G:2)}}return{orientation:c,categorySourceName:E,isCategorySourceNumeric:P,mode:n||D.RB,switchMode:G,hasSearchableData:le,activeOptions:H,showIcon:!1,showTabularSlicer:!1,warningObjectCollection:new q.tb,strictSingleSelect:g}}},r.prototype.render=function(e,t){this.updateViewport(),this.previousData=this.data,this.data=this.originalData=r.converter(this.dataView,this.featureSwitches,this.hostServices.getLocalizedString("ListJoin_Separator")),this.featureSwitches.updateFormattingPaneObjects&&this.featureSwitches.moveSlicerTypeSelection&&this.clearSelectionIfNeeded(),this.viewModelAdapter&&this.dataView&&(this.data=this.viewModelAdapter.applySlicerChanges(this.currentViewport,this.originalData,this.dataView)),this.data&&(this.hasSearchableData=this.data.hasSearchableData),this.renderSlicer(e,t),this.visibilityHelper.updateVisibility(this.data&&this.data.showIcon?{showIcon:!0,viewport:this.currentViewport}:{showIcon:!1})},r.prototype.renderSlicer=function(e,t){this.updateSlicerRendererIfNeeded(),this.slicerRenderer.render({dataView:this.dataView,viewport:this.currentViewport,resetScrollbarPosition:e,hasSearchableData:this.hasSearchableData,restatement:this.data&&this.data.categorySourceName,isSlicer:this.isSlicer,isSearchMode:!!this.selectionHandler&&this.selectionHandler.isSearchMode()}),this.updateSlicerHeader(this.slicerRenderer.hasSlider());var i=null!=this.slicerRenderer.getRestatement;this.slicerHeader&&this.slicerHeader.setFilterRestatement(i?this.slicerRenderer.getRestatement():void 0,i),t&&this.loadMoreHandler.onLoadMoreDataCompleted(),this.updateWarnings()},r.prototype.updateSlicerRendererIfNeeded=function(){if(this.enableInFocusRenderers&&this.container.hasClass(Ni)!==this.isInFocus)return this.isInFocus?this.container.addClass(Ni):this.container.removeClass(Ni),void this.initializeSlicerRenderer();if(this.data){var t=this.data.mode||D.RB;this.activeMode!==t||(0,D.l6)(this.activeMode)&&this.previousData&&this.previousData.isCategorySourceNumeric!==this.data.isCategorySourceNumeric?(this.activeMode=t,this.initializeSlicerRenderer()):(this.slicerOrientation!==(this.data.orientation||0)||this.previousData&&this.previousData.showTabularSlicer!==this.data.showTabularSlicer)&&this.initializeSlicerRenderer()}},r.prototype.clearSelectionIfNeeded=function(){if(this.previousData&&this.data){var e=this.data.mode||D.RB;if(this.previousData.mode!==e||(0,D.l6)(e)&&this.previousData&&this.previousData.isCategorySourceNumeric!==this.data.isCategorySourceNumeric){this.hostServices.onSelect({type:0,visualObjects:[]});var t=this.hostServices.getLocalizedString("Slicer_ClearSelectionsCleared");this.hostServices.alertWithDebounce("announce-clear-selection",t)}}},r.prototype.updateViewport=r.prototype.updateSlicerHeader=function(e){var t=this;if(this.dataView){var i=(0,ye.y)(this.dataView);if(!this.slicerHeader){var a={onClear:onChange:function(g){t.slicerRenderer&&!t.featureSwitches.updateFormattingPaneObjects&&!t.featureSwitches.moveSlicerTypeSelection&&t.slicerRenderer.onModeChange(g)},host:this.headerContainer,visibilityState:this.data.switchMode,selectedValue:this.activeMode,hoverContainer:this.element,enableInFocusRenderers:this.enableInFocusRenderers,slicerModeOptions:this.slicerActiveOptions()},n={localize:this.hostServices.getLocalizedString.bind(this.hostServices),getViewMode:this.hostServices.getViewMode.bind(this.hostServices),applySlicerHeaderChanges:function(g){var E=g;return t.viewModelAdapter&&t.dataView&&t.data&&(E=t.viewModelAdapter.applySlicerHeaderChanges(t.currentViewport,g,t.dataView,t.data,e)),E},onRenderTooltip:;this.slicerHeader=new Yi(a,n,this.style,this.featureSwitches)}this.slicerHeader.update(i,{text:this.data.categorySourceName,restatement:this.slicerRenderer.getRestatement?this.slicerRenderer.getRestatement():void 0,selectedValue:this.activeMode,visibilityState:this.data.switchMode,isInFocus:this.isInFocus,slicerModeOptions:this.slicerActiveOptions(),areControlButtonsAlwaysVisible:this.areControlButtonsAlwaysVisible,strictSingleSelect:this.data.strictSingleSelect,hasUnappliedFilters:this.hasUnappliedFilters})}},r.prototype.getTooltipComponent=function(e,t){var i;return null!==this.tooltip&&this.tooltip.close(),this.tooltip=null===(i=this.hostServices.getUIComponentFactory())||void 0===i?void 0:i.createTooltip(e,t),this.tooltip},r.prototype.slicerActiveOptions=function(){if(this.data.isCategorySourceNumeric){for(var e=[],t=0,i=this.data.activeOptions;t<i.length;t++)e.push(ui.members([i[t].value])[0]);return e}return this.data.activeOptions},r.prototype.initializeSlicerRenderer=function(){switch(this.slicerRenderer&&this.slicerRenderer.onDestroy&&this.slicerRenderer.onDestroy(),this.slicerOrientation=this.data&&this.data.orientation||0,this.slicerContainer.empty(),this.activeMode){case D.RB:return void this.initializeBasicSlicer();case D.j6:return void this.initializeDropdownSlicer();case D.K8:return void this.initializeRelativeSlicer(d.wj.Date);case D.GV:return void this.initializeRelativeSlicer(d.wj.Time);case D.vX:case D.bb:case D.e4:return void this.initializeRangeSlicer(!1);case D.Zr:return void this.initializeRangeSlicer(!0);default:return z.fF.assertFail("initializeSlicerRenderer - Unexpected activeMode: "+this.activeMode),void this.initializeVerticalSlicer()}},r.prototype.initializeBasicSlicer=function(){if(this.enableInFocusRenderers&&this.isInFocus)this.initializeInFocusVerticalSlicer();else switch(this.slicerOrientation){case 1:this.initializeHorizontalOrTabularSlicer();break;case 0:this.initializeVerticalSlicer()}},r.prototype.initializeInFocusVerticalSlicer=function(){this.hostServices.setShouldDeferData(!1);var e=this.slicerRenderer=new Oi(new gr,{hostServices:this.hostServices,featureSwitches:this.featureSwitches},this.lockKeyboardNavigation),t=this.createInitOptions();this.selectionHandler=e.init(t,this.slicerContainer)},r.prototype.initializeVerticalSlicer=function(){var e=this.slicerRenderer=new Oi(new Wi,{hostServices:this.hostServices,featureSwitches:this.featureSwitches},this.lockKeyboardNavigation),t=this.createInitOptions();this.selectionHandler=e.init(t,this.slicerContainer)},r.prototype.initializeRangeSlicer=function(e){if(this.data.isCategorySourceNumeric){var t=new _i,i=new At({hostServices:this.hostServices});this.slicerRenderer=new h({hostServices:this.hostServices,featureSwitches:this.featureSwitches},i,e,this.data.isCategorySourceNumeric,t)}else t=new _i,i=new Mt({preventVirtualKeyboardOnTheFirstTap:this.preventVirtualKeyboardOnTheFirstTap,hostServices:this.hostServices,featureSwitches:this.featureSwitches}),this.slicerRenderer=new h({preventTextSelection:this.preventVirtualKeyboardOnTheFirstTap,hostServices:this.hostServices,featureSwitches:this.featureSwitches},i,e,this.data.isCategorySourceNumeric,t);var a=this.createInitOptions();this.selectionHandler=this.slicerRenderer.init(a,this.slicerContainer)},r.prototype.initializeHorizontalOrTabularSlicer=function(){var e;e=this.data&&this.data.showTabularSlicer?new Zi:new Ne;var i=new yr,a=this.slicerRenderer=new Be({hostServices:this.hostServices,horizontalSlicerLayout:e,featureSwitches:this.featureSwitches},i),n=this.createInitOptions();this.selectionHandler=a.init(n,this.slicerContainer)},r.prototype.initializeRelativeSlicer=function(e){var i=this.slicerRenderer=function(r,e){switch(r){case d.wj.Time:return new li(e,d.wj.Time);case d.wj.Date:return new li(e,d.wj.Date);default:return void z.fF.assertFail("Unsupported RelativeFilterType")}}(e,{hostServices:this.hostServices}),a=this.createInitOptions();this.selectionHandler=i.init(a,this.slicerContainer)},r.prototype.initializeDropdownSlicer=function(){if(this.enableInFocusRenderers&&this.isInFocus)this.initializeInFocusVerticalSlicer();else{var e={hostServices:this.hostServices,featureSwitches:this.featureSwitches},t=new Oi(new Wi,e);this.slicerRenderer=new Rt(t,e);var i=this.createInitOptions();this.selectionHandler=this.slicerRenderer.init(i,this.slicerContainer)}},r.prototype.createInitOptions=function(){var e=this;return{visualInitOptions:this.initOptions,loadMoreData:enableMultiElementRows:this.enableMultiElementRows}},r.prototype.updateWarnings=function(){this.data&&(this.slicerHeader.addWarnings(this.data.warningObjectCollection),this.slicerRenderer.addWarnings&&this.slicerRenderer.addWarnings(this.data.warningObjectCollection),this.hostServices.setWarnings(this.data.warningObjectCollection.complete()))},r}()},63718:function(it,ke,S){"use strict";S.d(ke,{wV:function(){return de}});var ee=S(84282),L=S(98801),p=S(8014),ve=S(32178),te=S(59138),ye=S(59317),de=function(){function y(){}return y.prototype.bindEvents=function(u,o){this.behavior=this.createWebBehavior(u),this.behavior.bindEvents(u.behaviorOptions,o)},y.prototype.renderSelection=y.bindSlicerEvents=function(u,o,d,f){y.bindSlicerItemSelectionEvent(o,d,f),u.searchInput&&y.bindSlicerSearchEvent(u.searchInput,u.clearSearchTextButton,d)},y.setSelectionOnSlicerItems=function(u,o,d){var f=o.isSelectionModeInverted(),C=o.hasSelection();u.each(function(B,j){var be=!!B.partially||B.isSelectAllDataPoint&&C,ne=!C&&f||C&&!be&&(0,ye.OO)(B,f);if($(this).toggleClass("selected",ne),$(this).toggleClass("partiallySelected",!!be),d.isHighContrast){var ge=this.getElementsByTagName("span")[0];if(ne){var De=L.v.getThemeColor(d,"foregroundSelected");ge&&(ge.style.backgroundColor=De,ge.style.borderColor=De)}else{var Ve=L.v.getThemeColor(d,"foreground");ge&&(ge.style.backgroundColor="",ge.style.borderColor=Ve,ge.style.boxShadow="none")}}var Re=this.getElementsByTagName("input")[0];Re&&(Re.checked=ne)})},y.bindSlicerItemSelectionEvent=function(u,o,d){var f=this;u.on("keydown",function(C){var B=d3.event,j=B.keyCode;32!==j&&13!==j||(32===j&&B.preventDefault(),f.toggleItemSelection(C,o,d))}).on("click",function(C){$(d3.event.target).trigger("slicer.dataPointSelected"),f.toggleItemSelection(C,o,d)})},y.toggleItemSelection=function(u,o,d,f){if(!u.disabled){var C=f||d3.event;if(u.isSelectAllDataPoint)o.toggleSelectionModeInversion(),o.persistSelectionFilter(ee.gO.general.filter);else{var B=y.isMultiSelect(u,C,d,o)?3:0;o.handleSelection(u,B,{x:C.clientX,y:C.clientY})&&o.persistSelectionFilter(ee.gO.general.filter)}}},y.toggleItemSelectionFromExternal=y.bindSlicerSearchEvent=function(u,o,d){var f=this;u.empty()||(u.on(p.n,function(){var C=d3.event;ve.M.isCtrlOrMeta(C)&&(0,te.iZ)(C.keyCode)||(0,te.Wl)(C.keyCode)||(0,te.rH)(C.keyCode)?C.stopPropagation():27===C.keyCode?(f.clearSearch(d,u),C.preventDefault()):13===C.keyCode&&(y.startSearch(u,d),C.stopPropagation())}).on(p.cp,function(){var C=d3.event;_.debounce(function(){9===C.keyCode||16===C.keyCode||y.startSearch(u,d)},y.searchInputTimeoutDuration)()}),o&&!o.empty()&&o.on(p.G6,)},y.clearSearch=function(u,o){u.setSearchMode(!0),u.persistSelfFilter(ee.gO.general.selfFilter,null),o.property("value","");var d=d3.select(ye.s8.selector);(new ye.gy).configureSearchBoxIcon(d,void 0)},y.startSearch=function(u,o){var d=u.node(),f=d&&d.value;f=_.trim(f),o.setSearchMode(!0),o.persistSelfFilter(ee.gO.general.selfFilter,f)},y.isMultiSelect=function(u,o,d,f){return!d.selection.strictSingleSelect&&!f.isDisableMultipleSelectForMappedColumn()&&(f.isSelectionModeInverted()||!d.selection.singleSelect||ve.M.isCtrlOrMeta(o)||1===f.getDataMultiSelectMode()||y.hasParentSelected(u))},y.hasParentSelected=function(u){for(;u.parent;){if(u.parent.selected)return!0;u=u.parent}},y.prototype.createWebBehavior=function(u){return 1===u.orientation?new z:new U},y.searchInputTimeoutDuration=500,y}(),z=function(){function y(){}return y.prototype.bindEvents=function(u,o){this.selectionHandler=o,this.slicerSettings=u.settings,this.style=u.style,this.items=u.itemsContainer,de.bindSlicerEvents(u,this.items,o,this.slicerSettings)},y.prototype.renderSelection=function(){de.setSelectionOnSlicerItems(this.items,this.selectionHandler,this.style)},y}(),U=function(){eturn y.prototype.bindEvents=function(u,o){this.itemContainers=u.itemContainers,this.itemInputs=u.itemInputs,this.selectionHandler=o,this.settings=u.settings,this.style=u.style,de.bindSlicerEvents(u,this.itemContainers,o,this.settings)},y.prototype.renderSelection=y}()},96102:function(it,ke,S){"use strict";S.d(ke,{v:function(){return p}});var ee=S(20907),L=S(59317),p=function(){eturn ve.fromSlicerSettings=function(te,ye,D,q,de){var z,U,y,u,o,d,f;if(te)return{isVisible:D,hasClearSearchButton:q,searchKey:ye,style:{borderStyle:null!=de&&de.outlineDropdownToCheckboxes?null===(z=te.search)||void 0===z?void 0:z.outlineStyle:null===(U=te.search)||void 0===U?void 0:U.outline,borderColor:null===(y=te.search)||void 0===y?void 0:y.borderColor,background:null===(u=te.search)||void 0===u?void 0:u.background,color:null===(o=te.slicerText)||void 0===o?void 0:o.color,textSize:null===(d=te.slicerText)||void 0===d?void 0:d.textSize,fontFamily:null===(f=te.slicerText)||void 0===f?void 0:f.fontFamily}}},ve.prototype.create=function(te){this.container=this.domHelper.addSearch(this.hostServices,te),this.input=this.container.select(L.Mj.selector)},ve.prototype.addClearButton=ve.prototype.clearSearchText=function(){this.container.select(L.Mj.selector).property("value","")},ve.prototype.getHeight=function(te){var ye=this.container.node();return $(ye).outerHeight(!0)},ve.prototype.update=function(te){if(!te||!te.isVisible)return this.container.classed(L.pD.class,!1),void this.container.classed(L.AM.class,!0);void 0!==te.bottomMargin&&this.container.style("margin-bottom",te.bottomMargin+"px");var ye=this.container.classed(L.pD.class);this.container.classed(L.pD.class,te.isVisible),this.container.classed(L.AM.class,!te.isVisible);var D=te.style,q=this.container.select(L.Mj.selector),de=this.container.select(L.uN.selector);if(q.empty())te.hasClearSearchButton&&this.domHelper.configureSearchBoxIcon(this.container,void 0);else{var z=q.node(),U=z&&z.value;te.hasClearSearchButton&&this.domHelper.configureSearchBoxIcon(this.container,U),(_.isEmpty(U)||_.isEmpty(te.searchKey)&&te.isVisible!==ye)&&q.property("value",te.searchKey);var y=Math.ceil(ee.FP.fromPointToPixel(D.textSize));this.height=y,this.container.styles({color:D.color,"border-style":D.borderStyle,"border-color":D.borderColor,background:D.background,height:y+"px"}),q.styles({background:D.background,color:D.color,"font-size":ee.FP.fromPoint(D.textSize),"font-family":D.fontFamily}),de.styles({color:D.color})}},ve}()},52614:function(it,ke,S){"use strict";S.d(ke,{N:function(){return U}});var ee=S(84282),L=S(15552),p=S(87941),ve=S(89516),te=S(98129),ye=S(17926),D=S(13106),q=S(24356),de=S(31115),z=S(59317),U=function(){function y(u,o){this.hostService=u,this.behavior=o,this.isInvertedSelectionMode=!1,this.isSearchUpdateMode=!1,this.selected=[]}return y.buildDefaultValueFilter=function(u,o){var d,f;void 0===o&&(o=!1),p.fF.assertNonEmpty(u,".buildDefaultValueFilter columns should not be empty");for(var C=[],B=[],j=o?C:B,ae=0,be=u;ae<be.length;ae++){var ne=be[ae],ge=1===(null===(d=ne.parameter)||void 0===d?void 0:d.kind),De=!(null===(f=ne.parameter)||void 0===f||!f.supportsSelectAll),Ve=null!=(0,te.NA)(ne.objects,ee.gO.general.defaultValue);ge&&De||Ve?j.push.apply(j,y.getMetadataColumnIdentityExprs(ne)):j=C}if(!_.isEmpty(C)||!_.isEmpty(B))return D.yl.getDefaultAnyValueFilter(B,C)},y.getMetadataColumnIdentityExprs=function(u){return _.isEmpty(u.identityExprs)?[u.expr]:u.identityExprs},y.prototype.setDefaultValueMode=function(u){this.useDefaultValue=u},y.prototype.bind=function(u,o){this.selected=_.filter(u,function(d){return d.selected}),this.behavior.bindEvents(o,this),this.behavior.renderSelection()},y.prototype.setSelected=function(u){_.isEmpty(u)||(this.selected=_.filter(u,function(o){return o.selected}))},y.prototype.setSelectionModeInverted=y.prototype.setColumns=function(u){this.columns=u,this.columnExprs=_.map(u,function(o){return o.expr}),this.supportsDefaultValueByLevel=_.map(u,function(o){return null!=(0,te.NA)(o.objects,ee.gO.general.defaultValue)})},y.prototype.hasSelection=y.prototype.isSelectionModeInverted=function(){return this.isInvertedSelectionMode},y.prototype.setQueryNameByLevel=function(u){this.queryNameByLevel=u},y.prototype.persistSelfFilter=function(u,o){var d=(0,z.H4)(this.columnExprs,o);this.hostService.persistProperties(y.createChangeForProperty(u,d))},y.prototype.setSearchMode=y.prototype.isSearchMode=y.prototype.handleClearSelection=function(){if(this.previouslySelected=this.selected.slice(),this.previousInversionMode=this.isInvertedSelectionMode,this.isInvertedSelectionMode=!1,!(1===this.selected.length&&this.isStrictSingleSelect||this.hasDefaultValue()&&this.useDefaultValue)){var u=this.hostService.getLocalizedString("Slicer_ClearSelectionsCleared");this.hostService.alertWithDebounce("announce-clear-selection",u),this.useDefaultValue=!0,this.resetSelected(),this.behavior.renderSelection()}},y.prototype.persistSelectionFilter=function(u,o,d,f){void 0===o&&(o=!1),void 0===f&&(f=!1);var C=this.getFilterFromDataPoints();if(C&&!_.isEmpty(this.selected)){var B=this.toFilterExpressionMetadata(this.selected);this.hostService.setFilterExpressionMetadata(B)}var j=y.createChangeForProperty(u,C),be=y.createChangeForProperty(ee.gO.data.isInvertedSelectionMode,!(o||!this.isInvertedSelectionMode)||null);if(f){var ne=y.createChangeForProperty(ee.gO.general.selfFilter,null);this.mergeObjectInstancesToPersist(j,ne)}j=this.mergeObjectInstancesToPersist(j,be),this.hostService.persistProperties(j,d),this.sendSelectionToHost()},y.prototype.getDataMultiSelectMode=y.prototype.sendSelectionToHost=function(){if(this.hostService.onSelect){var u=_.isEmpty(this.selected)?[]:_.map(this.selected,function(B){return B.identity}),o=L.Bt.createSelectEventArgs(u,0),d=_.isEmpty(this.previouslySelected)?[]:_.map(this.previouslySelected,function(B){return B.identity}),f=L.Bt.createSelectEventArgs(d,0),C=_.size(o.visualObjects)!==_.size(f.visualObjects)||_.some(o.visualObjects,function(B,j){return!(0,ve.Ic)(B.selectorsByColumn,f.visualObjects[j].selectorsByColumn)});o.fireDataSelectedEvent=C||this.isInvertedSelectionMode!==this.previousInversionMode,this.hostService.onSelect(o)}},y.prototype.handleSelection=function(u,o,d){if(this.onSelecting(u,d))return!1;var f=u.partially,C=u.selected;this.useDefaultValue=!1,this.previouslySelected=this.selected.slice(),0===o||this.isStrictSingleSelect?this.resetSelected():this.clearDataPointState(u);var B=this.getDataPointSelectedState(u,o,f,C);return this.updateSelectedState(u,B),this.behavior.renderSelection(),!0},y.prototype.getDataPointSelectedState=function(u,o,d,f){return d?(0,z.OO)(u,this.isInvertedSelectionMode)?u.selected:!u.selected:!!this.isStrictSingleSelect||(0===o?!f||this.selected.length>1:!f)},y.prototype.onSelecting=function(u,o){var d=(0,z.No)(u,this.queryNameByLevel),f={type:0,visualObjects:[{objectName:L.Bt.dataPointObjectName,selectorsByColumn:d.selector}],position:o};return this.hostService.onSelecting(f),0!==f.action&&null!=f.action},y.prototype.updateSelectedState=function(u,o){var d=u.selected;u.selected=o,d!==o&&(this.clearDataPointState(u,!0),this.updateParentState(u)),u.selected?this.selected.push(u):d&&!u.selected&&_.remove(this.selected,u)},y.prototype.setStrictSingleSelect=y.prototype.resetSelected=function(){_.isEmpty(this.selected)||_.each(this.selected,,this.selected=[]},y.prototype.clearDataPointState=function(u,o){if(void 0===o&&(o=!1),o||(u.selected&&_.remove(this.selected,u),u.selected=!1),!_.isEmpty(u.children)&&u.partially){u.partially=!1;for(var d=0,f=u.children;d<f.length;d++)this.clearDataPointState(f[d])}},y.prototype.updateParentState=function(u){if(u.parent)for(var o=u.parent;o;)o.partially=!!u.selected||_.some(o.children,function(d){return d.selected}),o=o.parent},y.prototype.mergeObjectInstancesToPersist=function(u,o){var d,f,C={};return C.merge=u.merge,C.remove=u.remove,_.isEmpty(o.merge)||(C.merge=C.merge||[],(d=C.merge).push.apply(d,o.merge||[])),_.isEmpty(o.remove)||(C.remove=C.remove||[],(f=C.remove).push.apply(f,o.remove||[])),C},y.prototype.toFilterExpressionMetadata=function(u){if(!_.isEmpty(u)){for(var o={expressions:this.columnExprs,cachedValueItems:[]},d=0,f=0,C=u;f<C.length;f++){for(var j=C[f],ae={identities:[],valueMap:{}};j;)ae.identities.unshift(j.scopeIdentity),ae.valueMap[j.level]=j.value,d=Math.max(d,j.level),j=j.parent;o.cachedValueItems.push(ae)}return o.expressions=this.columnExprs.slice(0,d+1),o}},y.prototype.isDisableMultipleSelectForMappedColumn=function(){return _.some(this.columns,function(o){var d,f;return 1===(null===(d=o.parameter)||void 0===d?void 0:d.kind)&&!(null!==(f=o.parameter)&&void 0!==f&&f.supportsMultipleValues)})},y.prototype.toggleSelectionModeInversion=function(u){return void 0===u&&(u=!1),this.previouslySelected=this.selected.slice(),this.useDefaultValue=!1,this.previousInversionMode=this.isInvertedSelectionMode,this.isInvertedSelectionMode=!this.isInvertedSelectionMode,this.resetSelected(),u&&this.hostService.persistProperties(y.createChangeForProperty(ee.gO.data.isInvertedSelectionMode,!!this.isInvertedSelectionMode||null)),this.behavior.renderSelection(),this.isInvertedSelectionMode},y.prototype.getFilterFromDataPoints=function(){var u=(0,z.R6)({columns:this.columns});if(_.isEmpty(this.selected)&&(this.hasDefaultValue()||this.isInvertedSelectionMode&&u))return y.buildDefaultValueFilter(this.columns,!this.useDefaultValue||u);var d=this.buildSelectorsByLevel();if(d){var f=y.buildExprForSlicerSelection(d.selected,d.unselected,u);return f=this.ensureAnyFilter(f,d.maxLevel),D.yl.fromSQExpr(f)}},y.buildExprForSlicerSelection=function(u,o,d){var f=y.buildExprsFromSelectorsByLevel(u),C=y.buildExprForUnselectedState(o,!d);return f&&C?f=(0,q.xD)(f,C):C&&(f=C),f},y.prototype.ensureAnyFilter=function(u,o){var d=o+1;if(d<this.columns.length){for(var f=(0,q.n7)(),C=[],B=d;B<this.columns.length;B++)this.supportsDefaultValueByLevel[B]&&C.push.apply(C,y.getMetadataColumnIdentityExprs(this.columns[B]));if(!_.isEmpty(C)){var j=Array.apply(null,Array(C.length)).map(function(){return f});u=(0,q.xD)(u,(0,de.R)(C,j))}}return u},y.getInExprByLevel=function(u){for(var d,f=0,C=(0,ve.Li)(u);f<C.length;f++){var B=C[f],j=(0,ye.FD)(B);d=d?(0,q.or)(d,j):j||B}return d},y.prototype.hasDefaultValue=function(){if(!_.isEmpty(this.columns))return null!=(0,te.NA)(this.columns[0].objects,ee.gO.general.defaultValue)},y.buildExprsFromSelectorsByLevel=function(u,o){var d;for(var f in void 0===o&&(o=!1),u){var C=y.getInExprByLevel(u[f]);d=d?(0,q.or)(d,C):C}return o&&d&&(d=(0,q.ff)(d)),d},y.prototype.buildSelectorsByLevel=function(){if(!_.isEmpty(this.selected)){for(var u={},o={},d={},f=0,C=0,B=this.selected;C<B.length;C++){for(var j=B[C],ae=-1,be=j,ne={data:[]};be;)ne.data.unshift(be.scopeIdentity),be=be.parent,ae++;if(f=Math.max(f,ae),(0,z.OO)(j,this.isInvertedSelectionMode)){var ge=this.getFirstUnselectedParent(j,this.isInvertedSelectionMode),De=u;ge&&(De=(Ve=this.ensureState(ge,d)).selectedChildren),De[ae]=De[ae]||[],De[ae].push(ne)}else{var Ve;(Ve=this.ensureState(j,d)).selector=ne,o[ae]=o[ae]||[],o[ae].push(Ve)}}return{selected:u,unselected:o,maxLevel:f}}},y.buildExprForUnselectedState=function(u,o){var d,f={};for(var C in u){for(var j=[],ae=[],be=0,ne=u[C];be<ne.length;be++){var ge=ne[be];_.isEmpty(ge.selectedChildren)?ae.push(ge.selector):j.push(ge)}if(_.isEmpty(ae)||(f[C]=ae),!_.isEmpty(j)){var De=y.getExprForUnselectedStateWithSelection(j);d=d?(0,q.xD)(De,d):De}}var Ve=y.buildExprsFromSelectorsByLevel(f,o);return d?(0,q.xD)(Ve,d):Ve},y.getExprForUnselectedStateWithSelection=function(u){for(var o,d=0,f=u;d<f.length;d++){var C=f[d],B=y.buildExprsFromSelectorsByLevel(C.selectedChildren),j=(0,q.ff)(y.getInExprByLevel([C.selector])),ae=(0,q.or)(B,j);o=o?(0,q.xD)(ae,o):ae}return o},y.prototype.ensureState=function(u,o){var d=o[u.identity.getKey()];return d||(d={selector:{},selectedChildren:{}},o[u.identity.getKey()]=d),d},y.prototype.getFirstUnselectedParent=function(u,o){for(;u;){if(u.selected&&!(0,z.OO)(u,o))return u;u=u.parent}},y.createChangeForProperty=y.prototype.adjustStrictSingleSelectSelection=function(u){if(this.isStrictSingleSelect&&!_.isEmpty(u)&&(1!==_.filter(u,.length||this.isInvertedSelectionMode)){var d;if(u.length>1){for(var f=0,C=u;f<C.length;f++){var B=C[f];if(B.selected&&!this.isInvertedSelectionMode||!B.selected&&this.isInvertedSelectionMode){d=B;break}}if(!d)if((0,z.R6)({columns:this.columns}))for(var ae=0,be=u;ae<be.length;ae++){var ne=be[ae];if(!ne.disabled){d=ne;break}}else d=u[0]}this.isInvertedSelectionMode&&this.toggleSelectionModeInversion(null==d),d&&(d.selected=!0,this.selected=[d],this.persistSelectionFilter(ee.gO.general.filter,void 0,!0))}},y}()},59317:function(it,ke,S){"use strict";S.d(ke,{AM:function(){return We},H4:function(){return qe},HR:function(){return Oe},Id:function(){return pe},Iy:function(){return Je},K5:function(){return ut},M7:function(){return Mt},Mj:function(){return St},NV:function(){return Ge},No:function(){return Ct},OO:function(){return ht},PB:function(){return he},PG:function(){return ue},Qi:function(){return Te},R6:function(){return x},VD:function(){return pt},Wm:function(){return M},X$:function(){return et},dq:function(){return T},fz:function(){return Rt},gy:function(){return Se},hY:function(){return J},hx:nD:function(){return me},nQ:function(){return bt},oE:function(){return oe},pD:function(){return rt},qo:function(){return l},rX:function(){return se},s8:function(){return ie},s9:function(){return R},td:function(){return wt},tm:function(){return Me},uN:function(){return dt},uT:function(){return Ve},vx:function(){return Pt},zJ:function(){return lt}});var ee=S(26514),L=S(84282),p=S(41455),ve=S(66683),te=S(59510),ye=S(91980),D=S(77497),q=S(29925),de=S(87941),z=S(14253),U=S(32178),y=S(6266),u=S(20907),o=S(25182),d=S(19632),f=S(13106),C=S(24356),B=(0,q.CH)("clearSearchTextButton"),be=((0,q.CH)("headerContainer"),(0,q.CH)("slicerHeader"),(0,q.CH)("hidden")),ne=(0,q.CH)("icon"),Ve=((0,q.CH)("titleHeader"),(0,q.CH)("headerText"),(0,q.CH)("slicerBody")),Ge=((0,q.CH)("slicerLabel"),(0,q.CH)("slicerText")),Je=(0,q.CH)("slicerImage"),Oe=(0,q.CH)("slicerCountText"),ie=(0,q.CH)("searchHeader"),dt=(0,q.CH)("searchIcon"),St=(0,q.CH)("searchInput"),We=(0,q.CH)("collapsed"),rt=(0,q.CH)("show"),J=((0,q.CH)("isMultiSelectEnabled"),(0,q.CH)("enable-hover")),Mt=(0,q.CH)("disableScrollHover"),Pt="SelectAll",nt="SearchBox_Text",Te="DeselectAll";unction lt(b){if(!_.isEmpty(b)){for(var m=[],w=!0,O=0,Z=b;O<Z.length;O++){var A=Z[O];if(A.roles&&A.roles[L.CT.value]&&void 0!==A.index)if(A.rolesIndex&&A.rolesIndex[L.CT.value]){de.fF.assert(".initMetadataColumns if any of the columns has roleIndex all of them are supposed to have it.");for(var W=0,xe=A.rolesIndex[L.CT.value];W<xe.length;W++)m[xe[W]]=A}else w=!1,m.push(A)}return m}}function Ct(b,m){var O={dataMap:{},metadata:[m[b.level]]},Z=[],A=[],K=b;for(Z.push(b),A.push(b.levelIndex);K.parent;)Z.unshift(K=K.parent),A.unshift(K.levelIndex);for(var W=0,xe=Z;W<xe.length;W++){var Be=xe[W];O.dataMap[m[Be.level]]=[Be.scopeIdentity]}return{selector:O,path:A}}function qe(b,m){var w;if(!_.isEmpty(m)&&!_.isEmpty(b)){for(var O=(0,C.fL)(m),Z=void 0,A=0,K=b;A<K.length;A++){var xe=(0,C.r3)(K[A],O);Z=Z?(0,C.or)(Z,xe):xe}w=f.yl.fromSQExpr(Z)}return w}function bt(b){if(b){var m=b.categorical;if(m&&!_.isEmpty(m.categories))return m.categories[0].identityFields}}function et(b,m,w){if(b&&!_.isEmpty(m))for(var O=0,Z=m.length;O<Z;O++)if((0,d.fS)(b,m[O].identity,w))return m.splice(O,1)[0]}function ht(b,m){var w=b.parent?ht(b.parent,m):m;return b.selected?!w:w}function pt(b,m){var w,O={remove:[{objectName:"general",selector:null,properties:{filter:!0}}],replace:[{objectName:"data",selector:null,properties:(w={},w[L.gO.data.mode.propertyName]=m,w)}]};b.persistProperties(O),b.onSelect({type:0,visualObjects:[]});var Z=b.getLocalizedString("Slicer_ClearSelectionsCleared");b.alertWithDebounce("announce-clear-selection",Z)}function wt(b,m){var w=b.complete(),O=w?w.visualObjectWarnings:void 0;for(var Z in O)m.addForVisualObject.apply(m,(0,ee.ev)([Z],O[Z]||[],!1))}unction ut(b,m,w){void 0===w&&(w=!1),b.handleClearSelection(),w&&b.setSearchMode(!0),b.persistSelectionFilter(L.gO.general.filter,null,!0!==m,w)}function T(b){b.setSearchMode(!0),b.persistSelfFilter(L.gO.general.selfFilter,null)}function x(b){return _.some(b.columns,}function N(b){return _.some(b.columns,function(m){var w;return null===(w=m.parameter)||void 0===w?void 0:w.supportsMultipleValues})}function M(b){return _.some(b.columns,}function k(b,m){b.attr("disabled",!!m.disabled||void 0)}function se(b,m){return""!==m?m:b.getLocalizedString("NullValue")}var he=function(){function b(){}return b.prototype.onPopupHideEvent=function(m,w,O,Z){var A=this;return this.popup=O,this.popupHideEventHandler=m,this.boundBox=w,this.originalOffset=$(w).offset(),this.scrollEventHandler=function(K){return A.scrollEventReceived(K)},this.focusEventHandler=function(K){return A.focusInEventReceived(K,Z)},this.popupHideEvent=function(K){return A.popupHideEventReceived(K)},this.mouseEventHandler=this.bindPopupHideHandlers(),$.proxy(this.unbindPopupHideHandlers,this)},b.prototype.popupHideEventReceived=b.prototype.scrollEventReceived=function(m){if(this.boundBox){var w=$(this.boundBox).offset();(w.left!==this.originalOffset.left||w.top!==this.originalOffset.top)&&(this.originalOffset=w,this.popupHideEventHandler(m.type,m.target))}},b.prototype.focusInEventReceived=function(m,w){!this.popup||this.popup.contains(m.target)||w&&this.isContextMenuElement(m.target)||this.popupHideEventHandler(m.type,m.target)},b.prototype.onMouseDown=function(m,w){2===m.button&&w&&(!this.popup||this.popup.contains(m.target)||this.isContextMenuElement(m.target))||this.popupHideEventHandler(m.type,m.target)},b.prototype.bindPopupHideHandlers=function(){document.addEventListener("mousedown",this.mouseEventHandler,!0),document.addEventListener("pointerdown",this.mouseEventHandler,!0),document.addEventListener("touchstart",this.popupHideEvent,!0),$(window).on("resize",$.proxy(this.popupHideEventReceived,this)),$(this.boundBox).on("destroy",$.proxy(this.popupHideEventReceived,this)),document.addEventListener("scroll",this.scrollEventHandler,!0),document.addEventListener("focusin",this.focusEventHandler,!0)},b.prototype.unbindPopupHideHandlers=function(){document.removeEventListener("mousedown",this.mouseEventHandler,!0),document.removeEventListener("pointerdown",this.mouseEventHandler,!0),document.removeEventListener("touchstart",this.popupHideEvent,!0),$(window).off("resize",this.popupHideEventReceived),document.removeEventListener("scroll",this.scrollEventHandler,!0),$(this.boundBox).off("destroy",this.popupHideEventReceived),document.removeEventListener("focusin",this.focusEventHandler,!0)},b.prototype.isContextMenuElement=b}(),Se=function(){function b(){}return b.prototype.addSearch=function(m,w){var O=w.append("div").classed(ie.class,!0).classed(We.class,!0);return O.append("span").classed("powervisuals-glyph search",!0).classed(ne.class,!0).classed(dt.class,!0).attr("title",m.getLocalizedString(nt)),O.append("input").attr("type","text").attr("aria-label",m.getLocalizedString(nt)).attr("placeholder",m.getLocalizedString(nt)).attr("spellcheck",!1).classed(St.class,!0).attr("drag-resize-disabled","true"),O},b.prototype.addClearSearchButton=function(m,w){var O=w.append("span").classed("powervisuals-glyph x",!0).classed(ne.class,!0).classed(B.class,!0);return w.select(St.selector).attr("placeholder",m.getLocalizedString(nt)),O},b.prototype.configureSearchBoxIcon=function(m,w){var O=_.isEmpty(w);m.select(dt.selector).classed(be.class,!O),m.select(B.selector).classed(be.class,O)},b.prototype.getRowHeight=function(m,w,O){var Z=O.outlineDropdownToCheckboxes?m.slicerText.outlineStyle:m.slicerText.outline;return z.b.estimateSvgTextHeight(this.getTextProperties(m.slicerText.textSize,m.slicerText.fontFamily,w))+this.getRowsOutlineWidth(Z,m.general.outlineWeight)},b.prototype.setSlicerTextStyle=function(m,w,O){m.styles({color:w.slicerText.color,"background-color":w.slicerText.background,"border-style":"solid","border-color":w.general.outlineColor,"border-width":(0,p.$b)(O.outlineDropdownToCheckboxes?w.slicerText.outlineStyle:w.slicerText.outline,w.general.outlineWeight),"font-size":u.FP.fromPoint(w.slicerText.textSize),"font-family":w.slicerText.fontFamily,"line-height":Math.floor(1.79*w.slicerText.textSize)+"px","font-weight":w.slicerText.labelBold?q.en:q.AI,"font-style":w.slicerText.labelItalic?q.BF:q.AI,"text-decoration":w.slicerText.labelUnderline?q.f0:q.zu});var K=this.calculateSlicerTextHighlightColor(w.slicerText.color);m.on("mouseover",function(W){d3.select(this).styles({color:K})}),m.on("mouseout",function(W){d3.select(this).styles({color:w.slicerText.color})})},b.prototype.getRowsOutlineWidth=function(m,w){if("number"==typeof m){var O=(0,o.yE)(m,1),Z=(0,o.yE)(m,4);return O&&Z?2*w:O||Z?w:0}switch(m){case ve.YP:case ve.v3:return 0;case ve.wI:case ve.j0:return w;case ve.b_:case ve.Wi:return 2*w;default:return 0}},b.prototype.calculateSlicerTextHighlightColor=function(m){var w=(0,D.WV)(m);return w&&255===w.R&&255===w.G&&255===w.B?"#C8C8C8":(0,D.jd)(w,.8,.2)},b.prototype.getTextProperties=b}();function pe(){return!U.M.isIOSWebView()&&!U.M.isAndroidWebView()}function Me(b,m){if(0===m&&1===b.length&&b[0].objectName===L.gO.data.mode.objectName&&b[0].propertyName===L.gO.data.mode.propertyName){var w=[],O=b[0].propertyValue;return(w=O===te.Ih||O===te.of?[{objectName:L.gO.data.mode.objectName,propertyName:L.gO.data.mode.propertyName,propertyValue:te.RB,propertyType:{enumeration:te.dt}},{objectName:L.gO.general.orientation.objectName,propertyName:L.gO.general.orientation.propertyName,propertyValue:O===te.of?1:0,propertyType:{enumeration:ye.d}}]:(0,ee.ev)([],b,!0)).push({objectName:L.gO.general.filter.objectName,propertyName:L.gO.general.filter.propertyName,propertyValue:null,propertyType:{filter:{}}}),w}return b}function l(b,m,w,O,Z){if(m)switch(b.objectName){case"items":return function(b,m,w){var O=m,Z=Ze(b)&&b.slicerSettings.slicerText,W={fontColor:Z&&b.slicerSettings.slicerText.color?b.slicerSettings.slicerText.color:O.slicerText.color,background:Z&&b.slicerSettings.slicerText.background?b.slicerSettings.slicerText.background:O.slicerText.background,textSize:O.slicerText.textSize,fontFamily:O.slicerText.fontFamily,bold:O.slicerText.labelBold,italic:O.slicerText.labelItalic,underline:O.slicerText.labelUnderline};return w.outlineDropdownToCheckboxes?W.outlineStyle=O.slicerText.outlineStyle:W.outline=O.slicerText.outline,!_.isEmpty(b.queryNameByLevel)&&b.queryNameByLevel.length>1&&(W.steppedLayoutIndentation=O.expandCollapse.indentation,W.expandCollapseToggleType=O.expandCollapse.toggleType),[{selector:null,objectName:"items",properties:W}]}(m,w,Z);case"selection":return function(b,m,w){var O=Ze(b)&&b.slicerSettings.selection,Z=O&&b.slicerSettings.selection.selectAllCheckboxEnabled?b.slicerSettings.selection.selectAllCheckboxEnabled:m.selection.selectAllCheckboxEnabled,A=O&&void 0!==b.slicerSettings.selection.singleSelect?b.slicerSettings.selection.singleSelect:m.selection.singleSelect,K=O&&void 0!==b.slicerSettings.selection.strictSingleSelect?b.slicerSettings.selection.strictSingleSelect:m.selection.strictSingleSelect;!K&&x(w.metadata)&&!N(w.metadata)&&(K=!0);var W={selector:null,objectName:"selection",properties:{strictSingleSelect:K}};return K||(W.properties.singleSelect=A,W.properties.selectAllCheckboxEnabled=Z),[W]}(m,w,O)}}function R(b,m,w,O){if(m){var Z=Ze(m)&&m.slicerSettings.slicerText,A=Z&&m.slicerSettings.slicerText.color?m.slicerSettings.slicerText.color:w.slicerText.color,K=Z&&m.slicerSettings.slicerText.background?m.slicerSettings.slicerText.background:w.slicerText.background,W=L.gO.items,xe=new y.CQ(new y.lg("values"),"Role_DisplayName_Values",[W.fontFamily,W.textSize,W.bold,W.italic,W.underline,W.fontColor,W.padding,W.outline,W.outlineStyle,L.gO.general.outlineColor,L.gO.general.outlineWeight,W.background],function(Pe){return b.getLocalizedString(Pe)}),Ne=(new y.UN).withFontFamily({descriptor:W.fontFamily,value:w.slicerText.fontFamily}).withFontSizeProperties({descriptor:W.textSize,value:w.slicerText.textSize}).withBold({descriptor:W.bold,value:w.slicerText.labelBold}).withItalic({descriptor:W.italic,value:w.slicerText.labelItalic}).withUnderline({descriptor:W.underline,value:w.slicerText.labelUnderline}).build();return xe.addGroup("values",function(Pe){Pe.withDisplayName("Role_DisplayName_Values").addCompositeSlice("fontselector","Font",Ne).addSimpleSlice("color",function(){return new y.BT({descriptor:W.fontColor,value:{value:A}}).build()}),O&&O.slicerAccessibility&&Pe.addSimpleSlice("padding",function(){return new y.mu({descriptor:W.padding,value:w.items.padding,options:{minValue:{type:0,value:0},maxValue:{type:1,value:999},unitSymbol:"Numeric_Pixel"}}).build()})}).addGroup("border",function(Pe){Pe.withDisplayName("Visual_Border"),Pe.addSimpleSlice("border position",O.outlineDropdownToCheckboxes?new y.oM({descriptor:W.outlineStyle,value:w.slicerText.outlineStyle}).build():new y.uY({descriptor:W.outline,value:w.slicerText.outline}).build(),function(Ce){return Ce.withCustomDisplayName("Visual_Border_Position")}),Pe.addSimpleSlice("color",function(){var Ce={value:w.general.outlineColor};return new y.BT({descriptor:(0,ee.pi)((0,ee.pi)({},L.gO.general.outlineColor),{instanceKind:3}),value:Ce}).build()},function(Ce){return Ce.withCustomDisplayName("Visual_Background_Color")}).addSimpleSlice("lineWidth",new y.JN({descriptor:L.gO.general.outlineWeight,value:w.general.outlineWeight,options:{minValue:{type:0,value:1},maxValue:{type:1,value:10}},localize:function(Ue){return b.getLocalizedString(Ue)}}).build(),function(Ce){return Ce.withCustomDisplayName("Visual_Line_Width")})}).addGroup("background",function(Pe){Pe.withDisplayName("Visual_Background").addSimpleSlice("color",function(){return new y.BT({descriptor:W.background,value:{value:K}}).build()},function(Ce){return Ce.withCustomDisplayName("Visual_Background_Color")})}),xe.build()}}function oe(b,m,w,O){if(m){var Z=L.gO.items,A=new y.CQ(new y.lg("hierarchy"),"Hierarchy",[Z.steppedLayoutIndentation,Z.expandCollapseToggleType],function(K){return b.getLocalizedString(K)});if(!_.isEmpty(m.queryNameByLevel)&&m.queryNameByLevel.length>1)return A.addGroup("levels",function(K){K.withDisplayName("Slicer_Hierarchy_Levels").addSimpleSlice("steppedIndentation",function(){return new y.JN({descriptor:Z.steppedLayoutIndentation,value:w.expandCollapse.indentation,options:{minValue:{type:0,value:0},maxValue:{type:1,value:40}},localize:function(xe){return b.getLocalizedString(xe)}}).build()})}).addGroup("expandCollapseButtons",function(K){K.withDisplayName("Slicer_ExpandCollapse").addSimpleSlice("expand/collapseIcon",function(){return new y.uY({descriptor:Z.expandCollapseToggleType,value:w.expandCollapse.toggleType}).build()})}),[A.build()]}}function me(b){var m=b.cardUidBuilder,w=b.currentSlicerSettings,O=b.data,Z=b.dataView,A=b.hostServices,K=b.orientation,W=b.slicerModes,xe=b.featureSwitches,Be=b.activeMode;if(O||!(0,te.Ek)(Be)){var Ne=[],Pe=[],Ce=O&&O.slicerSettings,Ue=new y.mQ(new y.SS(m,"options"),function(ft){return A.getLocalizedString(ft)});if(Pe.push(L.gO.general.selfFilterEnabled),Ue.withDisplayName("Desktop_FileMenu_Options"),xe.updateFormattingPaneObjects&&xe.moveSlicerTypeSelection){Be===te.RB&&(Be=K&&1===K?te.of:te.Ih);for(var Xe=[],at=0,Ie=W;at<Ie.length;at++){var _e=Ie[at],Tt=_e.displayName({get:A.getLocalizedString});Xe.push({value:_e.value,displayName:Tt})}var xt=Xe.filter(;Ue.addSimpleSlice("style",new y.uY({descriptor:L.gO.data.mode,value:xt&&xt[0],items:Xe}).build()),Pe.push(L.gO.data.mode)}else null!=K&&(Ue.addSimpleSlice("orientation",new y.uY({descriptor:L.gO.general.orientation,value:K}).build()),Pe.push(L.gO.general.orientation));var tt=Ue.build();if(tt.slices.length>0&&Ne.push(tt),O&&w&&Z){var kt=ue(Ce,Z,w,A,m,Pe);Ne.push(kt)}return{groups:Ne,revertToDefaultDescriptors:Pe}}}function ue(b,m,w,O,Z,A,K){void 0===K&&(K=!0);var W=b&&b.selection,xe=w.selection,Be=W&&W.selectAllCheckboxEnabled?W.selectAllCheckboxEnabled:xe.selectAllCheckboxEnabled,Ne=W&&void 0!==W.singleSelect?W.singleSelect:xe.singleSelect,Pe=W&&void 0!==W.strictSingleSelect?W.strictSingleSelect:xe.strictSingleSelect;!Pe&&x(m.metadata)&&!N(m.metadata)&&(Pe=!0);var Ce=L.gO.selection,Ue=new y.mQ(new y.SS(Z,"selection"),function(Xe){return O.getLocalizedString(Xe)});return A.push(L.gO.general.selfFilterEnabled,Ce.strictSingleSelect,Ce.singleSelect,Ce.selectAllCheckboxEnabled),K||Ue.addSimpleSlice("singleSelect",function(){return new y.bd({descriptor:Ce.singleSelect,value:Ne}).build()}),(Ne||K)&&Ue.withDisplayName("ExpandCollapseNode").addSimpleSlice("strictSingleSelect",function(){return new y.bd({descriptor:Ce.strictSingleSelect,value:Pe}).build()}),Pe||(K&&Ue.addSimpleSlice("singleSelect",function(){return new y.bd({descriptor:Ce.singleSelect,value:Ne}).build()}),Ue.addSimpleSlice("selectAllCheckboxEnabled",function(){return new y.bd({descriptor:Ce.selectAllCheckboxEnabled,value:Be}).build()})),Ue.build()}},51220:function(it,ke,S){"use strict";S.d(ke,{G:function(){return ee},J:function(){return L}});var ee={}),L=function(){eturn p.prototype.shouldLoadMoreData=p.prototype.isLoadingMoreData=function(){return this.waitingForData},p.prototype.updateDataView=function(ve){this.dataView=ve},p.prototype.loadMoreData=function(){var ve=this.shouldLoadMoreDataInternal();return ve===ee.TriggeredLoadMore&&(this.hostServices.loadMoreData(),this.waitingForData=!0),ve},p.prototype.onLoadMoreDataCompleted=p.prototype.shouldLoadMoreDataInternal=function(){if(!this.dataView)return ee.NoOperation;var ve=this.dataView.metadata;return this.waitingForData?ee.WaitingForData:ve&&ve.segment?ee.TriggeredLoadMore:ee.NoOperation},p}()},46854:function(it,ke,S){"use strict";S.d(ke,{P:function(){return q}});var ee=S(26514),L=S(87941),p=S(21157),ve=S(26691),te=S(51220),ye=S(44900),D=S(69071);ar U=function(){function u(o){var d=this;this._data=[],this.scrollTop=0,this.scrollLeft=0,this.prevWheelTime=0,this.factory=(0,p.p)(),o=this.options=$.extend(!0,{},o),L.fF.assert(function(){return!d.options.paddingBetween&&!d.options.paddingOuter||d.options.doNotRenderToCalculateRowHeight}),this.scrollbarInner=o.baseContainer.append("div").classed("scrollbar-inner",!0).attr("role","none").on("scroll",function(){return d.onScroll()}),this.scrollContainer=this.scrollbarInner.append("div").classed("scrollRegion",!0).attr("role","none").on("touchstart",function(){return d.stopTouchPropagation()}).on("touchmove",function(){return d.stopTouchPropagation()}).style("overflow","hidden"),this.visibleGroupContainer=this.scrollContainer.append("div").classed("visibleGroup",!0).attr("role","none"),this.scrollInner=$(this.scrollbarInner.node()),this.scrollInner.scrollbar({ignoreOverlay:!1,ignoreMobile:!1,onDestroy:);var f=$(o.baseContainer.node()),C=f.find(".scroll-element");C.attr("drag-resize-disabled","true"),o.scrollEnabled&&C.css("pointer-events","auto"),f.find(".scroll-wrapper").attr("role","none"),this.scrollToFrame=this.options.scrollToFrame||this.defaultScrollToFrame,u.setDefaultOptions(o)}return u.prototype.orientation=function(o){var d=this;return this.isHorizontal=o,o?(this.visibleGroupContainer.style("display","flex"),this.visibleGroupContainer.style("flex-direction","row"),this.scrollbarInner.on("wheel",function(){var f;performance.now()-d.prevWheelTime>100&&(d.propagateWheel=void 0);var C=d3.event,B=Math.abs(C.deltaX)>=Math.abs(C.deltaY);if(d.propagateWheel||B)d.prevWheelTime=performance.now();else{var j=d.scrollbarInner.node().scrollLeft;d.scrollbarInner.node().scrollBy({left:C.deltaY});var ae=d.scrollbarInner.node().scrollLeft;null!==(f=d.propagateWheel)&&void 0!==f||(d.propagateWheel=ae===j),d.propagateWheel||(C.stopPropagation(),C.preventDefault()),d.prevWheelTime=performance.now()}})):(this.visibleGroupContainer.style("display",null),this.visibleGroupContainer.style("flex-direction",null),this.scrollbarInner.on("wheel",null)),this},u.prototype.scrollTo=function(o){this.scrollInner.scrollTop(o)},u.prototype.scrollRowIntoView=function(o,d){var f=this,C=this.options,B=C.rowHeight,j=C.paddingBetween,ae=C.paddingOuter,be=Math.min(Math.max(o,0),this._totalRows-1),ne=this.scrollTop,ge=this.getContainerHeight(),De=this.getRowStartPosition(be,B,j,ae),Ve=this.getTotalRowHeight(be,B,j,ae),Re=this.getNeededScrollChange(De,Ve,ne,ge);this.setFocusCallback=d,0!==Re?(this.scrollTo(ne+Re),this.pendingFocusCallback=function(Ge){Ge?f.pendingScrollCallback=f.setFocusCallback&&f.setFocusCallback()}):this.setFocusCallback&&this.setFocusCallback()},u.prototype.getTotalRowHeight=function(o,d,f,C){var B=d;return 0===o&&(B+=C),o===this._totalRows&&(B+=C),o>0&&(B+=f),B},u.prototype.getNeededScrollChange=function(o,d,f,C){if(o<f)return Math.floor(o-f);var B=o+d,j=f+C;return B>j?Math.floor(B-j):0},u.prototype.onScroll=function(){var o=this;this.scrollTop=this.scrollbarInner.node().scrollTop,this.scrollLeft=this.scrollbarInner.node().scrollLeft,void 0===this.scrollTimeoutId&&(this.scrollTimeoutId=window.requestAnimationFrame(function(){var d=o.renderImpl(o.options.rowHeight,o.options.paddingBetween,o.options.paddingOuter);o.scrollTimeoutId=void 0,o.pendingFocusCallback&&(o.pendingFocusCallback(d.loadedMore),o.pendingFocusCallback=void 0)}))},u.prototype.resetCallBacks=u.prototype.destroy=function(){this.scrollInner&&this.scrollInner.scrollbar("destroy"),this.resetCallBacks(),this.clearRenderingTimeout()},u.prototype.getContainerHeight=function(){if(this.options.getContainerHeight){var o=this.options.getContainerHeight();if(null!=o)return o}var d=$(this.options.baseContainer.node());return this.isHorizontal?d.outerWidth():d.outerHeight()},u.setDefaultOptions=function(o){o.rowHeight=u.valueOrDefault(o.rowHeight,u.defaultRowHeight),o.paddingBetween=u.valueOrDefault(o.paddingBetween,u.defaultPaddingBetween),o.paddingOuter=u.valueOrDefault(o.paddingOuter,u.defaultPaddingOuter)},u.valueOrDefault=u.prototype.getRowHeight=function(){return this.options.rowHeight},u.prototype.rowHeight=function(o){return this.options.rowHeight=o,this},u.prototype.paddingBetween=function(o){return this.options.paddingBetween=o,this},u.prototype.paddingOuter=u.prototype.data=function(o,d,f,C){return void 0===f&&(f=!1),this._data=o,this.getDatumIndex=d,this.setTotalRows(),f&&($(this.scrollbarInner.node()).scrollTop(0),this.resetCallBacks()),this.render(C).catch(function(B){return ve.f.error(B)}),this},u.prototype.viewport=function(o){return this.render().catch(function(d){return ve.f.error(d)}),this},u.prototype.empty=function(){this._data=[],this.resetCallBacks(),this.render().catch(function(o){return ve.f.error(o)})},u.prototype.clearRenderingTimeout=function(){void 0!==this.renderDelay&&(this.renderDelay.cancel(),this.renderDelay=void 0),void 0!==this.scrollTimeoutId&&(window.cancelAnimationFrame(this.scrollTimeoutId),this.scrollTimeoutId=void 0)},u.prototype.render=function(o){return(0,ee.mG)(this,void 0,ye.J,function(){var d;return(0,ee.Jh)(this,function(f){switch(f.label){case 0:return this.clearRenderingTimeout(),[4,this.delay()];case 1:return f.sent()?[2]:(this.renderDelay=void 0,[4,this.getRowHeightInternal()]);case 2:return d=f.sent(),this.renderImpl(d.rowHeight,d.paddingBetween,d.paddingOuter),o&&o(),this.pendingScrollCallback&&(this.pendingScrollCallback(),this.pendingScrollCallback=void 0),[2]}})})},u.prototype.delay=function(){return this.renderDelay=new y,this.renderDelay.promise},u.prototype.canScrollTop=function(){return 0!==this.scrollTop},u.prototype.getScroll=function(){return new(function(){function o(d){this.self=d}return Object.defineProperty(o.prototype,"scrollHeight",{get:function(){return this.self.getTotalHeight(this.self.options.rowHeight,this.self.options.paddingBetween,this.self.options.paddingOuter)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"visibleHeight",{get:function(){return this.self.getContainerHeight()},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"scrollTop",{get:enumerable:!1,configurable:!0}),o}())(this)},u.prototype.getTotalHeight=function(o,d,f){var C=u.valueOrDefault(d,u.defaultPaddingBetween),B=u.valueOrDefault(f,u.defaultPaddingOuter);return this.options.scrollEnabled?Math.max(0,this._totalRows*o+(this._totalRows-1)*C+2*B):this.getContainerHeight()},u.prototype.renderImpl=function(o,d,f){var C=this.getTotalHeight(o,d,f);return this.scrollContainer.style("width",this.isHorizontal?"".concat(C,"px"):null).style("height",this.isHorizontal?null:"".concat(C,"px")),this.scrollToFrame({listView:this,loadMoreData:!0,rowHeight:this.options.rowHeight||u.defaultRowHeight,paddingBetween:this.options.paddingBetween||u.defaultPaddingBetween,paddingOuter:this.options.paddingOuter||u.defaultPaddingOuter,scrollTop:this.scrollTop,scrollLeft:this.scrollLeft,totalRows:this._totalRows,visibleGroupContainer:this.visibleGroupContainer,baseContainer:this.options.baseContainer})},u.prototype.stopTouchPropagation=function(){var o=d3.event;this.options.isReadMode()&&("touchstart"===o.type&&o.touches&&1===o.touches.length&&o.stopPropagation(),"touchmove"===o.type&&o.stopPropagation())},u.prototype.defaultScrollToFrame=function(o){var ne,ge,De,d=o.loadMoreData,f=o.rowHeight,C=o.paddingBetween,B=o.paddingOuter,j=this.isHorizontal?o.scrollLeft:o.scrollTop,ae=o.totalRows,be=o.visibleGroupContainer;if(C||B)!this._totalRows||!this.options.rowHeight||f<1?(ge=0,De=(0,D.O7)(0,0),ne=1):(ge=this.getRowIndex(j,f,C,B,!1),Ve=j>0?this.getRowStartPosition(ge,f,C,B):0,De=(0,D.O7)(this.isHorizontal?Ve:0,this.isHorizontal?0:Ve),ne=this.getRowIndex(j+this.getContainerHeight(),f,C,B,!0)-ge+1);else{ne=this.getVisibleRowsWithoutPadding();var Ve=(ge=Math.max(0,Math.min(Math.floor(j/f),ae-ne+1)))*f;De=(0,D.O7)(this.isHorizontal?Ve:0,this.isHorizontal?0:Ve)}be.styles({transform:function(dt){return De},"-webkit-transform":De});var Oe=ge+ne;return this.currentScrollPosition={startIndex:ge,endIndex:Oe},this.performScrollToFrame(ge,Oe,ae,ne,d)},u.prototype.getFirstVisibleRow=function(){if(!_.isEmpty(this.visibleData))return this.visibleData[0]},u.prototype.reachedLastRowContent=function(){if(this._totalRows>0){var o=this.options,f=o.paddingBetween,C=o.paddingOuter,B=this.isHorizontal?this.scrollLeft:this.scrollTop,j=this._totalRows-1;return this.getRowStartPosition(j,o.rowHeight,f,C)+(0===j?C:f)<B+this.getContainerHeight()}return!1},u.prototype.performScrollToFrame=function(o,d,f,C,B){var j=this.options,ae=this.visibleGroupContainer;this.visibleData=this._data.slice(o,Math.min(d,f));var be=!1,ne=ae.selectAll(".row").data(this.visibleData,this.getDatumIndex);if(ne.exit().remove(),ne.enter().append("div").classed("row",!0).attr("role","none").call(function(Re){return j.enter(Re)}).merge(ne).order(),ae.selectAll(".row:not(.transitioning)").call(function(Re){return j.update(Re)}),B){var Ve=j.customLoadMoreCheck?j.customLoadMoreCheck():function(u,o,d){return d!==o&&u>=.8*o}(d,f,C);Ve&&(be=j.loadMoreData()===te.G.TriggeredLoadMore)}return j.afterScroll&&j.afterScroll(),this.setFocusCallback&&this.setFocusCallback(),{loadedMore:be}},u.prototype.getCurrentPosition=function(){return this.currentScrollPosition},u.prototype.setTotalRows=function(){var o=this._data;this._totalRows=o?o.length:0},u.prototype.getVisibleRowsWithoutPadding=function(){var d=this.options,f=d.rowHeight,C=d.scrollEnabled,B=this.getContainerHeight();if(!f||f<1)return 1;var j=B/f;return C?Math.min(Math.ceil(j)+1,this._totalRows)||1:Math.min(Math.floor(j),this._totalRows)||1},u.prototype.getRowIndex=function(o,d,f,C,B){var j=Math.min(o<d+C?0:Math.floor((o-d-C)/(d+f))+1,this._totalRows-1);return this.getRowStartPosition(j,d,f,C)===o&&(j=B?Math.max(j-1,0):j),j},u.prototype.getRowStartPosition=function(o,d,f,C){return o*d+Math.max(0,o-1)*f+(o>0?C:0)},u.prototype.getRowHeightInternal=function(){var o=this,d=this.factory.defer(),f=this,C=f.options;if(this.cancelMeasurePass&&this.cancelMeasurePass(),!(this._data&&this._data.length&&C))return f.rowHeight(u.defaultRowHeight),f.paddingBetween(u.defaultPaddingBetween),f.paddingOuter(u.defaultPaddingOuter),d.resolve({rowHeight:C.rowHeight,paddingBetween:C.paddingBetween,paddingOuter:C.paddingOuter}),d.promise;if(C&&C.doNotRenderToCalculateRowHeight)return d.resolve({rowHeight:C.rowHeight,paddingBetween:C.paddingBetween,paddingOuter:C.paddingOuter}),d.promise;var B={listView:this,loadMoreData:!1,rowHeight:this.options.rowHeight||u.defaultRowHeight,paddingBetween:u.defaultPaddingBetween,paddingOuter:u.defaultPaddingOuter,scrollTop:this.scrollbarInner.node().scrollTop,scrollLeft:this.scrollbarInner.node().scrollLeft,totalRows:this._totalRows,visibleGroupContainer:this.visibleGroupContainer,baseContainer:this.options.baseContainer};this.scrollToFrame(B);var j=window.requestAnimationFrame(function(){var ae=f.visibleGroupContainer.selectAll(".row").filter(function(){return""!==this.textContent||null!==this.querySelector("img")});if(ae.empty()&&(ae=f.visibleGroupContainer.select(".row")),!ae.empty()){var be=ae.nodes(),ne=o.calculateRowHeight(be);f.rowHeight(ne),d.resolve({rowHeight:ne,paddingBetween:u.defaultPaddingBetween,paddingOuter:u.defaultPaddingOuter})}f.cancelMeasurePass=void 0});return this.cancelMeasurePass=function(){window.cancelAnimationFrame(j),d.reject({code:"cancelMeasurePass",ignorable:!0})},d.promise},u.prototype.calculateRowHeight=function(o){for(var f=2>o.length?o.length:2,C=0,B=0;B<f;B++)C=Math.max(C,this.measureElementHeight(o[B]));return C},u.prototype.measureElementHeight=function(o){var d=$(o);return Math.ceil(Math.max(d.outerHeight(!0),d.children().first().outerHeight(!0)))},u.defaultRowHeight=1,u.defaultPaddingBetween=0,u.defaultPaddingOuter=0,u}(),y=function(){function u(){var o=this;this.promise=new ye.J(,this.timeoutId=setTimeout(this.complete.bind(this))}return u.prototype.complete=u.prototype.cancel=function(){window.clearTimeout(this.timeoutId),this.resolve(!0)},u}()},49064:function(it,ke,S){"use strict";S.d(ke,{q:function(){return p}});var ee=S(23342),L=S(87941);function p(){var ve=function(){eturn te.prototype.updateVisibility=function(ye){ye.showIcon?(this.hideVisual(),L.fF.assertValue(ye.viewport,"viewport"),this.renderResponsiveIcon(ye.viewport)):(this.removeResponsiveIcon(),this.showVisual())},te.prototype.renderResponsiveIcon=function(ye){this.responsiveIcon||(this.responsiveIcon=(0,ee.hi)().addClass(this.iconClassName).appendTo(this.visualElement)),this.responsiveIcon.css({width:ye.width,height:ye.height})},te.prototype.removeResponsiveIcon=te.prototype.hideVisual=function(){this.isVisualVisible&&(this.visualElement.children().hide(),this.isVisualVisible=!1)},te.prototype.showVisual=function(){this.isVisualVisible||(this.visualElement.children().show(),this.isVisualVisible=!0)},te}();return{visibilityHelper:}},9540:function(it,ke,S){"use strict";S.d(ke,{a:function(){return p}});var ee=S(99747),L=S(98129),p=function(){function ve(){}return ve.getResponsiveVisualProperties=function(te,ye){var D={responsive:!1,responsiveLegacy:!1};if(!te||!te.metadata)return D;var q=te.metadata.objects;return q&&(D.responsive=(0,L.NA)(q,ye.general.responsive,D.responsive),ye.general.responsiveLegacy&&(D.responsiveLegacy=(0,L.NA)(q,ye.general.responsiveLegacy,D.responsiveLegacy))),D},ve.cloneData=function(te){var ye=_.cloneDeep(te);return(0,ee.Zx)(te,ye),ye},ve.shouldApplyResponsiveChanges=ve}()}}]);