(()({1:[function(require,module,exports){var objectCreate=Object.create||objectCreatePolyfill;var objectKeys=Object.keys||objectKeysPolyfill;var bind=Function.prototype.bind||functionBindPolyfill;function EventEmitter(){if(!this._events||!Object.prototype.hasOwnProperty.call(this,"_events")){this._events=objectCreate(null);this._eventsCount=0}this._maxListeners=this._maxListeners||undefined}module.exports=EventEmitter;EventEmitter.EventEmitter=EventEmitter;EventEmitter.prototype._events=undefined;EventEmitter.prototype._maxListeners=undefined;var defaultMaxListeners=10;var hasDefineProperty;try{var o={};if(Object.defineProperty)Object.defineProperty(o,"x",{value:0});hasDefineProperty=o.x===0}catch(err){hasDefineProperty=false}if(hasDefineProperty){Object.defineProperty(EventEmitter,"defaultMaxListeners",{enumerable:true,get:function(){return defaultMaxListeners},set:function(arg){if(typeof arg!=="number"||arg<0||arg!==arg)throw new TypeError('"defaultMaxListeners" must be a positive number');defaultMaxListeners=arg}})}else{EventEmitter.defaultMaxListeners=defaultMaxListeners}EventEmitter.prototype.setMaxListeners=ventEmitter.prototype.getMaxListeners=function emitNone(handler,isFn,self){if(isFn)handler.call(self);else{var len=handler.length;var listeners=arrayClone(handler,len);for(var i=0;i<len;++i)listeners[i].call(self)}}function emitOne(handler,isFn,self,arg1){if(isFn)handler.call(self,arg1);else{var len=handler.length;var listeners=arrayClone(handler,len);for(var i=0;i<len;++i)listeners[i].call(self,arg1)}}function emitTwo(handler,isFn,self,arg1,arg2){if(isFn)handler.call(self,arg1,arg2);else{var len=handler.length;var listeners=arrayClone(handler,len);for(var i=0;i<len;++i)listeners[i].call(self,arg1,arg2)}}function emitThree(handler,isFn,self,arg1,arg2,arg3){if(isFn)handler.call(self,arg1,arg2,arg3);else{var len=handler.length;var listeners=arrayClone(handler,len);for(var i=0;i<len;++i)listeners[i].call(self,arg1,arg2,arg3)}}function emitMany(handler,isFn,self,args){if(isFn)handler.apply(self,args);else{var len=handler.length;var listeners=arrayClone(handler,len);for(var i=0;i<len;++i)listeners[i].apply(self,args)}}EventEmitter.prototype.emit=function emit(type){var er,handler,len,args,i,events;var doError=type==="error";events=this._events;if(events)doError=doError&&events.error==null;else if(!doError)return false;if(doError){if(arguments.length>1)er=arguments[1];if(er instanceof Error){throw er}else{var err=new Error('Unhandled "error" event. ('+er+")");err.context=er;throw err}return false}handler=events[type];if(!handler)return false;var isFn=typeof handler==="function";len=arguments.length;switch(len){case 1:emitNone(handler,isFn,this);break;case 2:emitOne(handler,isFn,this,arguments[1]);break;case 3:emitTwo(handler,isFn,this,arguments[1],arguments[2]);break;case 4:emitThree(handler,isFn,this,arguments[1],arguments[2],arguments[3]);break;default:args=new Array(len-1);for(i=1;i<len;i++)args[i-1]=arguments[i];emitMany(handler,isFn,this,args)}return true};function _addListener(target,type,listener,prepend){var m;var events;var existing;if(typeof listener!=="function")throw new TypeError('"listener" argument must be a function');events=target._events;if(!events){events=target._events=objectCreate(null);target._eventsCount=0}else{if(events.newListener){target.emit("newListener",type,listener.listener?listener.listener:listener);events=target._events}existing=events[type]}if(!existing){existing=events[type]=listener;++target._eventsCount}else{if(typeof existing==="function"){existing=events[type]=prepend?[listener,existing]:[existing,listener]}else{if(prepend){existing.unshift(listener)}else{existing.push(listener)}}if(!existing.warned){m=$getMaxListeners(target);if(m&&m>0&&existing.length>m){existing.warned=true;var w=new Error("Possible EventEmitter memory leak detected. "+existing.length+' "'+String(type)+'" listeners '+"added. Use emitter.setMaxListeners() to "+"increase limit.");w.name="MaxListenersExceededWarning";w.emitter=target;w.type=type;w.count=existing.length;if(typeof console==="object"&&console.warn){console.warn("%s: %s",w.name,w.message)}}}}return target}EventEmitter.prototype.addListener=function addListener(type,listener){return _addListener(this,type,listener,false)};EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.prependListener=function onceWrapper(){if(!this.fired){this.target.removeListener(this.type,this.wrapFn);this.fired=true;switch(arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:var args=new Array(arguments.length);for(var i=0;i<args.length;++i)args[i]=arguments[i];this.listener.apply(this.target,args)}}}function _onceWrap(target,type,listener){var state={fired:false,wrapFn:undefined,target:target,type:type,listener:listener};var wrapped=bind.call(onceWrapper,state);wrapped.listener=listener;state.wrapFn=wrapped;return wrapped}EventEmitter.prototype.once=function once(type,listener){if(typeof listener!=="function")throw new TypeError('"listener" argument must be a function');this.on(type,_onceWrap(this,type,listener));return this};EventEmitter.prototype.prependOnceListener=EventEmitter.prototype.removeListener=function removeListener(type,listener){var list,events,position,i,originalListener;if(typeof listener!=="function")throw new TypeError('"listener" argument must be a function');events=this._events;if(!events)return this;list=events[type];if(!list)return this;if(list===listener||list.listener===listener){if(--this._eventsCount===0)this._events=objectCreate(null);else{delete events[type];if(events.removeListener)this.emit("removeListener",type,list.listener||listener)}}else if(typeof list!=="function"){position=-1;for(i=list.length-1;i>=0;i--){if(list[i]===listener||list[i].listener===listener){originalListener=list[i].listener;position=i;break}}if(position<0)return this;if(position===0)list.shift();else spliceOne(list,position);if(list.length===1)events[type]=list[0];if(events.removeListener)this.emit("removeListener",type,originalListener||listener)}return this};EventEmitter.prototype.removeAllListeners=function removeAllListeners(type){var listeners,events,i;events=this._events;if(!events)return this;if(!events.removeListener){if(arguments.length===0){this._events=objectCreate(null);this._eventsCount=0}else if(events[type]){if(--this._eventsCount===0)this._events=objectCreate(null);else delete events[type]}return this}if(arguments.length===0){var keys=objectKeys(events);var key;for(i=0;i<keys.length;++i){key=keys[i];if(key==="removeListener")continue;this.removeAllListeners(key)}this.removeAllListeners("removeListener");this._events=objectCreate(null);this._eventsCount=0;return this}listeners=events[type];if(typeof listeners==="function"){this.removeListener(type,listeners)}else if(listeners){for(i=listeners.length-1;i>=0;i--){this.removeListener(type,listeners[i])}}return this};function _listeners(target,type,unwrap){var events=target._events;if(!events)return[];var evlistener=events[type];if(!evlistener)return[];if(typeof evlistener==="function")return unwrap?[evlistener.listener||evlistener]:[evlistener];return unwrap?unwrapListeners(evlistener):arrayClone(evlistener,evlistener.length)}EventEmitter.prototype.listeners=function listeners(type){return _listeners(this,type,true)};EventEmitter.prototype.rawListeners=EventEmitter.listenerCount=EventEmitter.prototype.listenerCount=listenerCount;ventEmitter.prototype.eventNames=tion objectKeysPolyfill(obj){var keys=[];for(var k in obj)if(Object.prototype.hasOwnProperty.call(obj,k)){keys.push(k)}return k},{}],2:[{}],3:[function(require,module,exports){"use strict";var inherits=require("util").inherits;function Backoff(opts){opts=opts||{};var min=parseInt(opts.min,10),max=parseInt(opts.max,10),jitter=parseFloat(opts.jitter);this.min=!isNaN(min)?min:10;this.max=!isNaN(max)?max:10*1e3;this.jitter=!isNaN(jitter)&&jitter>0&&jitter<=1?jitter:0;this.reset()}Backoff.prototype.next=function(){if(this.jitter){var spread=this._spread()*this.jitter;this.cur+=Math.random()*spread-spread/2}this.cur=Math.max(0,Math.min(this.max,Math.floor(this.cur)));var cur=this.cur;this._step();return cur};Backoff.prototype.reset=function LinearBackoff(opts){opts=opts||{};Backoff.call(this,opts);var step=parseInt(opts.step,10);this.step=!isNaN(step)&&step>0?step:50}inherits(LinearBackoff,Backoff);LinearBackoff.prototype._spread=LinearBackoff.prototype._step=LinearBackoff.prototype._reset=function(){this.cur=this.min};function FibonacciBackoff(opts){opts=opts||{};Backoff.call(this,opts);this.last=0}inherits(FibonacciBackoff,Backoff);FibonacciBackoff.prototype._spread=function(){return this.cur===this.last?this.cur:this.cur-this.last};FibonacciBackoff.prototype._step=function(){var next=this.last+this.cur;if(next===0){next=1}this.last=this.cur;this.cur=next};FibonacciBackoff.prototype._reset=function ExponentialBackoff(opts){opts=opts||{};Backoff.call(this,opts);var factor=parseFloat(opts.factor);this.factor=!isNaN(factor)&&factor>1?factor:2}inherits(ExponentialBackoff,Backoff);ExponentialBackoff.prototype._spread=function(){return this.cur-this.cur/this.factor};ExponentialBackoff.prototype._step=function(){if(this.cur===0){this.cur=1}else{this.cur*=this.factor}};ExponentialBackoff.prototype._reset=var SEQUENCE_ERROR="FixedBackoff: `sequence` is required, and must be an array of one or more integers >= 0";function FixedBackoff(opts){opts=opts||{};var sequence=opts.sequence;if(!sequence||!Array.isArray(sequence)||sequence.length===0){throw new Error(SEQUENCE_ERROR)}sequence.forEach(function(num){var parsed=parseInt(num,10);if(isNaN(parsed)||parsed<0||parsed!==num){throw new Error(SEQUENCE_ERROR)}});if(opts.hasOwnProperty("min")){throw new Error("FixedBackoff: `min` is invalid for this strategy")}if(opts.hasOwnProperty("max")){throw new Error("FixedBackoff: `max` is invalid for this strategy")}this.idx=0;this.lastIdx=sequence.length-1;this.sequence=sequence;Backoff.call(this,opts)}inherits(FixedBackoff,Backoff);FixedBackoff.prototype._spread=function(){return this.idx===0?this.sequence[this.idx]:Math.abs(this.sequence[this.idx]-this.sequence[this.idx-1])};FixedBackoff.prototype._step=function(){this.idx=Math.min(this.idx+1,this.lastIdx);this.cur=this.sequence[this.idx]};FixedBackoff.prototype._reset=function(){this.idx=0;this.cur=this.sequence[this.idx]};module.exports={Backoff:Backoff,LinearBackoff:LinearBackoff,FibonacciBackoff:FibonacciBackoff,ExponentialBackoff:ExponentialBackoff,FixedBackoff:FixedBackoff}},{util:10}],4:[function(require,module,exports){(function(root,factory){"use strict";if(typeof module==="object"&&module.exports){module.exports=factory()}else if(typeof define==="function"&&define.amd){define(factory)}else{root.IPv6=factory(root)}})(this,},{}],5:[function(require,module,exports){(function(root,factory){"use strict";if(typeof module==="object"&&module.exports){module.exports=factory()}else if(typeof define==="function"&&define.amd){define(factory)}else{root.SecondLevelDomains=factory(root)}})(this,},{}],6:[function(require,module,exports){(function(root,factory){"use strict";if(typeof module==="object"&&module.exports){module.exports=factory(require("./punycode"),require("./IPv6"),require("./SecondLevelDomains"))}else if(typeof define==="function"&&define.amd){define(["./punycode","./IPv6","./SecondLevelDomains"],factory)}else{root.URI=factory(root.punycode,root.IPv6,root.SecondLevelDomains,root)}})(this,function(punycode,IPv6,SLD,root){"use strict";var _URI=root&&root.URI;I.version="1.19.1";var p=URI.prototype;var hasOwn=Object.prototype.hasOwnProperty;rts=URI.preventInvalidHostname=false;URI.duplicateQueryParameters=false;URI.escapeQuerySpace=true;URI.protocol_expression=/^[a-z][a-z0-9.+-]*$/i;URI.idn_expression=/[^a-z0-9\._-]/i;URI.punycode_expression=/(xn--)/i;URI.ip4_expression=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/;URI.ip6_expression=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/;URI.find_uri_expression=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/gi;URI.findUri={start:/\b(?:([a-z][a-z0-9.+-]*:\/\/)|www\.)/gi,end:/[\s\r\n]|$/,trim:/[`!()\[\]{};:'".,<>?«»“”„‘’]+$/,parens:/(\([^\)]*\)|\[[^\]]*\]|\{[^}]*\}|<[^>]*>)/g};URI.defaultPorts={http:"80",https:"443",ftp:"21",gopher:"70",ws:"80",wss:"443"};URI.hostProtocols=["http","https"];URI.invalid_hostname_characters=/[^a-zA-Z0-9\.\-:_]/;URI.domAttributes={a:"href",blockquote:"cite",link:"href",base:"href",script:"src",form:"action",img:"src",area:"href",iframe:"src",embed:"src",source:"src",track:"src",input:"src",audio:"src",video:"src"eplace(/\*/g,"%2A")}URI.encode=strictEncodeURIComponent;URI.decode=decodeURIComponent;URI.iso8859=function(){URI.encode=escape;URI.decode=e=decodeURIComponent};URI.characters={pathname:{encode:{expression:/%(24|26|2B|2C|3B|3D|3A|40)/gi,map:{"%24":"$","%26":"&","%2B":"+","%2C":",","%3B":";","%3D":"=","%3A":":","%40":"@"}},decode:{expression:/[\/\?#]/g,map:{"/":"%2F","?":"%3F","#":"%23"}}},reserved:{encode:{expression:/%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/gi,map:{"%3A":":","%2F":"/","%3F":"?","%23":"#","%5B":"[","%5D":"]","%40":"@","%21":"!","%24":"$","%26":"&","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"="}}},urnpath:{encode:{expression:/%(21|24|27|28|29|2A|2B|2C|3B|3D|40)/gi,map:{"%21":"!","%24":"$","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"=","%40":"@"}},decode:{expression:/[\/\?#:]/g,map:{"/":"%2F","?":"%3F","#":"%23",":":"%3A(/%20/g,"+"):escch(e){return string}};var _parts={encode:"encode",decode:"decode"};var _parth(e){return string}}};for(_part in _parts){URI[_part+"PathSegment"]=generateAccessor("pathname",_parts[_part]);URI[_part+"UrnPathSegment"]=generateAccessor("urnpath",_parts[_part])}var generatesegments.join(_sep)}};URI.decodePath=generateSegmentedPathFunction("/","decodePathSegment");URI.decodeUrnPath=generateSegmentedPathFunction(":","decodeUrnPathSegment");URI.recodePath=generateSegmentedPathFunction("/","encodePathSegment","decode");URI.recodeUrnPath=generateSegmentedPathFunction(":","encodeUrnPathSegment","decode");URI.encodeReserved=generateAccessor("reserved","encode");URI.parse=function(string,parts){var pos;if(!parts){parts={preventInvalidHostname:URI.preventInvalidHostname}}pos=string.indexOf("#");if(pos>-1){parts.fragment=string.substring(pos+1)||null;string=string.substring(0,pos)}pos=string.indexOf("?");if(pos>-1){parts.query=string.substring(pos+1)||null;string=string.substring(0,pos)}if(string.substring(0,2)==="//"){parts.protocol=null;string=string.substring(2);string=URI.parseAuthority(string,parts)}else{pos=string.indexOf(":");if(pos>-1){parts.protocol=string.substring(0,pos)||null;if(parts.protocol&&!parts.protocol.match(URI.protocol_expression)){parts.protocol=undefined}else if(string.substring(pos+1,pos+3)==="//"){string=string.substring(pos+3);string=URI.parseAuthority(string,parts)}else{string=string.substring(pos+1);parts.urn=true}}}parts.path=string;return.substring(pos)||"/seHost(string,partd=null}return string};URI.parseQuery=function(string,escapeQuerySpace){if(!string){return{}}string=string.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,"");if(!string){return{}}var items={};var splits=string.split("&");var length=splits.length;var v,name,value;for(var i=0;i<length;i++){v=splits[i].split("=");name=URI.decodeQuery(v.shift(),escapeQuerySpace);value=v.length?URI.decodeQuery(v.join("="),escapeQuerySpace):null;if(hasOwn.call(items,name)){if(typeof items[name]==="string"||items[name]===null){items[name]=[items[name]]}items[name].push(value)}else{items[name]=value}}rets.fragment}re+parts.port}return URI.buildHost(partf(t){t+="@"}reteturn t.substring(1)};URscapeQuerySpahe name paramhe name parametee first parame value parameturn uri.normale.substring(0,posndex=0;return string};URhan [A-Z0-9.-:_]')}}s not a valid pURI=_URIld=falsereturn new URI(this)}uild);return this}}}p.protocol=generateSimpleAccessor("protocol");p.username=generateSimpleAccessor("username");p.password=generateSimpleAccessor("password");p.hostname=generateSimpleAccessor("hostname");p.port=generateSimpleAccessor("port");p.query=generatePrefixAccessor("query","?");p.fragment=generatePrefixAccessor("fragment","#");p.search=function(v,build){var t=this.query(v,build);return typeof t==="string"&&t.lg"&&t.lengt!build);return this}};p.p(!buipunycode}return null};var _protocol=p.protocol;var _port=p.port;var _hostname=l.call(this,v,build)};p.scht.call(thise.call(th!build);return this}};p.host=function(v,build){if(this._parts.urn){return v===undefined?"":this}if(v===undefined){return this._parts.hostname?URI.buildHost(this._parts):""}else{var res=URI.parseHost(v,this._parts);if(res!=="/"){throw new TypeError('Hostname "'+v+'" contains characters other than [A-Z0-9.-]')}this.build(!build);retu!build);ret!build);ret(!build);ret!build);r!build!build);retu!build);ret!build)}r!build);rein(separator),bent(segment,v,build)};.call(this,(!build);re(!build);retur(!build);ree,value,withinArray)};p.setSearch=p.setQuery;p.addSearch=p.addQuery;p.removeSearch=p.removeQuery;p.hasSearch=pgment(false).build()(!build)}return this(!build)}return (!build)}return (!build);return this};p.normalizePathname=p.normalize(!build)}return this(!build)}return this};p.normalizeSearch=p.normalizeQuery;p.normalizeHash=p.normalizeFragment;p.iso8859=function(){var e=URI.encode;var d=URI.decode;URI.encode=escape;URI.decode=decodeURIComponent;try{this.normalize()}finally{URI.encode=e;URI.decode=d}rdecode=d}reash(),true);rld();return rurn relat false}}}return true};p.preventInvalidHostname=function(v){this._parts.preventInvalidHostname=!!v;return this};p.duplicateQueryParameters=function(v){this._parts.duplicateQueryParameters=!!v;return thipace=!!v;return this};return URI})},{"./IPv6":4,"./SecondLevelDomains":5,"./punycode":7}],7:[function(require,module,exports){(function(global){(function(root){var freeExports=typeof exports=="object"&&exports&&!exports.nodeType&&exports;var freeModule=typeof module=="object"&&module&&!module.nodeType&&module;var freeGlobal=typeof global=="object"&&global;if(freeGlobal.global===freeGlobal||freeGlobal.window===freeGlobal||freeGlobal.self===freeGlobal){root=freeGlobal}var punycode,maxInt=2147483647,base=36,tMin=1,tMax=26,skew=38,damp=700,initialBias=72,initialN=128,delimiter="-",regexPunycode=/^xn--/,regexNonASCII=/[^\x20-\x7E]/,regexSeparators=/[\x2E\u3002\uFF0E\uFF61]/g,errors={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},baseMinusTMin=base-tMin,floor=Math.floor,stringFromCharCode=St:string})}punycode={version:"1.3.2",ucs2:{decode:ucs2decode,encode:ucs2encode},decode:decode,encode:encode,toASCII:toASCII,toUnicode:toUnicode};if(typeof define=="function"&&typeof define.amd=="object"&&define.aon(){return punycode})}else if(freeExports&&freeModule){if(module.exports==freeExports){freeModule.exports=punycode}else{for(key in punycode){punycode.hasOwnProperty(key)&&(freeExports[key]=punycode[key])}}}else{root.punycode=punycode}})(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefinee.constdUInt8==="function"}},{}],10:[function(require,module,exports){(function(process,global){var formatRegExp=/%[sspect(x)}}return ss)}return deprecated};var debugs={};var debugEnve(ctx,obj,ctx.depth)}exports.inspect=inspect;inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};inspect.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"misArray(ar)}exports.isArray=isArray;function isBoolean(arg){return typeof arg==="boolean"}exportg){return arg===null}rg){return arg==null}exports.isNullOrUndefined=isNullOrUndefined;function isNumber(arg){return typeof arg==="number"}exports.isNumber=isNumber;function isString(arg){return typeof arg==="string"}exports.isString=isString;function isSymbol(arg){return typeof arg==="symbol"}expo{return arg===void 0}exports.isUndefined=isUndefined;function isRegExp(re){return isObject(re)&&objectToString(re)==="[object RegExp]"}expo"object"&&arg!==null}expod)==="[object Date]"}|e instanceof Error)}exeof arg==="function"}exports.of arg==="undefined"}exports.isPrimitive=isPrimitive;exports.isBuffer=require((10):n.toString(10)}var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Seh()],time].(exports,arguments))};exports.inherits=require("inherperty.call(obj,prop)}}).call(this,require("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./support/isBuffer":9,_process:2,inherits:8}],11:[function(require,module,exports){(function(global){const Player=require("../player");const TextControl=require("../text-control");let statusElement;const statusClasses={status:"player-status",noFooter:"player-status--no-footer",connected:["fa","fa-check"],warning:["fa","fa-exclamation-triangle"],error:["fa","fa-exclamation-circle"]};function createStatusIndicator(settings){statusElement=document.createElement("i");statusElement.classList.add(statusClasses.status);if(settings.noFooter)statusElement.classList.add(statusClasses.noFooter);settings.contentElement.appendChild(statusElement)}function updateStatus(event){if(sList.remove(name)})}if(event.connected===true){removeClasses(statusClasses.warning.concat(statusClasses.error));statusClasses.connected.forEach(function(value){statusElement.classList.add(value)})}else{if(event.level==="warning"){removeClasses(statusClasses.connected.concat(statusClasses.error));statusClasses.warning.forEach(function(value){statusElement.classList.add(value)})}else{removeClasses(statusClasses.connected.concat(statusClasses.warning));statusclassList.add(value)})}}statusElement.title=event.message}function StreamText(settings){let self=this;if(settings.statusIndicator!==false)createStatusIndicator(settings);let textControl=new TextControl(settings);settings.onContentChange=settings.onContentChange||textControl.onTextChange;settings.wholeWords=settings.wholeWords||textControl.wholeWords;let player=new Player(settings);player.on("conn;updateStatus(event)});self.getOptions=textControl.getOptions;self.setOptions=textControl.setOptions;self.showAnnotations=showAnnotations;self.hideAnnotations=removeAnnotations;self.getTranscript=getTranscript;function removeAnnotations(){$(settings.contentElement.querySelectorAll(".notes-wrapper")).remove()}function showAnnotations(){$(settings.contentElement.querySelectorAll(".annotator-hl")).after(function(){return"<span class='notes-wrapper'>{".concat($(this).data("annotation").text,"}</span>")})}function getTranscript(){let accumulator=[];accumulateTextAndAnnotations(settings.contentElement,accumulator);return accumulator}let spanEx=/^span$/i;let iEx=/^i$/i;function accumulateTextAndAnnotations(node,accumulator){Array.prototype.forEach.call(node.childNodes,function(child){switch(child.nodeType){case Node.ELEMENT_NODE:if(iEx.test(child.tagName))return;if(spanEx.test(child.tagName)&&child.classList.contains("annotator-hl")){accumulator.push({text:child.innerHTML,annotation:$(child).data("annotation").text});break}accumulateTextAndAnnotations(child,accumulator);break;case Node.TEXT_NODE:if(child.parentNode===settings.contentElement)break;accumulator.push({text:child.wholeText});break;default:break}})}player.start()}global.StreamText=StreamText;module.exports=StreamText}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../player":13,"../text-control":22}],12:[function(require,module,exports){const URI=require("urijs");const useBodyForMethod={GET:false,DELETE:false,PUT:true,POST:true};const defaultRetrievalMethod="GET";function httpTransfer(url,options,cb){options=options||{};let method=options.method||defaultRetrievalMethod;let body=options.body;if(body&&useBodyForMethod[method]===false){let queryComponent=body.data.toString();url=URI(url).query(queryComponent).toString()}function createResult(xhr){let result={location:url,options:options};if(xhr){result.status=xhr.status;result.data=xhr.responseText;result.type=xhr.getResponseHeader("contentb(createResult(xhr))}function handleTimeout(evt){console.log("XHR-TIMEOUT-EVENT",evt);cb(createResult(),new Error("HTTP Timeout"))}function handleError(err){console.log("XHR-ERROR-EVENT",err);cb(createResult(),new Error("HTTP Error"))}let xhr=new XMLHttpRequest;xhr.addEventListener("load",handleResponse);xhr.addEventListener("timeout",handleTimeout);xhr.addEventListener("error",handleError);try{xhr.open(method,url,true);xhr.timeout=options.timeout||2e4;xhr.withCredentials=options.withCredentials||false;if("responseType"in xhr)xhr.responseType="text";if(options.headers){for(let requestHeader in options.headers){if(!options.headers.hasOwnProperty(requestHeader))continue;xhr.setRequestHeader(requestHeader,options.headers[requestHeader])}}if(body&&useBodyForMethod[method])xhr.setRequestHeader("content-type",body.type);if(body&&useBodyForMethod[method])xhr.send(body.data);else xhr.send()}catch(err){console.log("XHR-OPENSEND-ERROR",err);cb(createResult(),err)}}module.exports=exports=httpTransfer},{urijs:6}],13:[function(require,module,exports){const util=require("util");const events=require("events");const Polling=require("./polling.js");const Router=require("./routing").Router;function Player(settings){let self=this;events.EventEmitter.call(self);let contentElement=settings.contentElement;let pollingError={};let reconnectMessage="There is no need to refresh your browser. We are attempting to reconnect.";let polling=new Polling(settings);let router=new Router(contentElement,settings.allowLegalDisplay,settings.annotatorActive,settings.wholeWords);function processEntries(entemit("error",error)}});if(settings.onContentChange)settings.onContentChange()}polling.on("entries",function(entries){if(pollingError){self.emit("connection-statusElement",{connected:true,message:"Connected. Everything is good!"});pollingError=null}processEntries(entries)});polling.on("error",function(error){self.emit("connection-statusElement",{connected:false,level:"error",message:error.message.concat(reconnectMessage),error:error});pollingError=error});polling.on("warning",function(error){self.emit("connection-statusElement",{connected:false,level:"warning",message:error.message.concat(reconnectMessage),error:error});pollingError=error});self.start=function(){if(settings.entries){self.emit("connection-statusElement",{connected:true,message:"Connected. Everything is good!"});processEntries(settings.entries)}if(!settings.eventName)return;polling.start()}}util.inherits(Player,events.EventEmitter);module.exports=Player},{"./polling.js":14,"./routing":17,events:1,util:10}],14:[function(require,module,exports){const events=require("events");const http=require("../http");const util=require("util");const Backoff=require("simple-backoff").LinearBackoff;const warnings=[404,502,503,504];const maintainP value===comparison}}function Polling(settings){let self=this;events.EventEmitter.call(self);settings.interval=settings.interval||500;self.delay=settings.delay||0;self.authority=settings.authority||document.location.host;self.eventName=settings.eventName;self.language=settings.language;self.accessToken=settings.accessToken;self.position=settings.start===undefined?-1:settings.start;self.backoff=new Backoff({min:settings.interval,max:1e4,step:100,n start(){poll(self)};self.interval=function(){return backurn self.backoff.cur};self.emit=function(event,e){try{events.EventEmitter.prototype.emit.call(this,event,e)}catch(error){if(event!=="error")return self.emit("error",error);console.log("Unhandled error while emmitting event. ",event,error)}}}util.inherits(Polling,events.EventEmitter);function queueNextPoll(pollition(){poll(polling)},polling.backoff.next())}function createResponseError(result){let error;switch(result.status){case 404:error=new Error("Event is not active. ");break;case 403:error=new Error("You are not authorized to view this event. ");break;default:error=new Error("Server returned an error. ")}error.response=result;return error}function poll(polling){let location="//".concat(polling.authority,"/text-data.ashx?event=",polling.eventName,"&last=",polling.position);if(polling.language)location=location.concat("&language=",polling.language);if(polling.accessToken)location=location.concat("&access-token=",polling.accessToken);function handleResult(result,error){if(error)return handleError(result,error);if(result.status!==200){error=createResponseError(result);if(warnings.some(equals(result.status)))polling.emit("warning",error);else polling.emit("error",error);if(!maintainPosition.some(equals(result.status)))polling.position=-1}else{polling.backoff.reset();let data=JSON.parse(result.data);polling.position=data.lastPosition;setTimeout(function(){try{polling.emit("entries",data.i)}catch(e){handleError(result,e)}},polling.delay)}queueNextPoll(polling)}function handleError(result,error){error.message="Error occurred requesting data. ".concat(error.message,". Review 'result' on error object for more details.");error.result=result;polling.emit("error",error);queueNextPoll(polling)}let options={method:"GET",withCredentials:false,timeout:5e3};http(location,options,handleResult)}module.exports=Polling},{"../http":12,events:1,"simple-backoff":3,util:10}],15:[function(require,module,exports){const textHelper=require("../textHelper.js");const formatNames=["basic","caseview"];const breaker=RegExp("[^a-zA-Z_0-9'-]","g");let annotatorActive;let playerElement;let wholeWords;let cartElement;let currentPaleWords=wholeWordsFn}function ensureCartPlayerElement(){if(!cartElement||playerElement.lastChild!=cartElement){cartElement=document.createElement("div");cartElement.classList.add("streamtext-cart-player");cartElement.classList.add("streamtext-pre-display");playerElement.appendChild(cartElement);currentParagraph=null}}function removeCharacters(count){if(count<=0||!currentParagraph)return;while(count>0){let node=currentParagraph.lastChild;if(node===null){cartElement.removeChild(currentParagraph);currentParagraph=cartElement.lastChild;return removeCharacters(count)}if(node.length>=count){node.deleteData(node.length-count,count);count=0}else{count-=node.length;currentParagraph.removeChild(node)}}}function createParagraph(){currentParagraph=document.createElement("p");cartElement.appendChild(currentParagraph);return currentParagraph}function writeValue(value){if(!currentParagraph)createParagraph();currentParagraph.appendChild(document.createTextNode(value));if(!annotatorActive())currentParagraph.normalize()}function processImmediately(content){if(buffer){content=buffer+=content;buffer=""}let applied=textHelper.applyDeletes(content);removeCharacters(applied.remaining);if(applied.result)writeValue(applied.result)}function processByWord(content){buffer+=content;let applied=textHelper.applyDeletes(buffer);removeCharacters(applied.remaining);if(applied.result){let index=0;while(breaker.exec(applied.result)!==null){let display=applied.result.substring(index,breaker.lastIndex);writeValue(display);buffer=applied.result.substring(breaker.lastIndex);index=breaker.lastIndex}if(index===0)buffer=applied.result}else buffer=""}function processEntry(entry)ormat===entry.format}))return false;ensureCartPlayerElement();let content=decodeURIComponent(entry.d);if(wholeWords())processByWord(content);else processImmediately(content);return true}exports.init=init;exports.processEntry=processEntry},{"../textHelper.js":20}],16:[function(require,module,exports){let isAnnotatorActive;let playerElement;let cPrint;let doc;const formatName="cprint";const commands={new:"NEW",insert:"INSERT",remove:"REMOVE"};const keys={command:"TYPE",index:"OFFSET",text:"INSERT_STRING",length:"LENGTH",styles:{italic:"ITALIC",subscript:"SUBSCRIPT",superscript:"SUPERSCRIPT",underline:"UNDERLINE",bold:"BOLD"}};function init(contentElement,annotatorActive){playerElement=contentElement;isAnnotatorActive=annotatorActive}function ensureCprintDisplayElement(){if(!cPrint||playerElement.lastChild!=cPrint){cPrint=document.createElement("div");cPrint.classList.add("streamtext-pre-display");cPrint.classList.add("streamtext-cprint-display");playerElement.appendChild(cPrint);doc=null}}function createCPrintDoc(){doc=document.createElement("div");cPrint.appendChild(doc)}function stylesMatch(entry,element){for(let p in keys.styles){if(!keys.styles.hasOwnProperty(p))continue;let value=entry[keys.styles[p]];if(value==="true"&&!element.classList.contains(p))return false;if(value==="false"&&element.classList.contains(p))return false}return true}function applyClasses(entry,element){for(let p in keys.styles){if(!keys.styles.hasOwnProperty(p))continue;if(entry[keys.styles[p]]==="true")element.classList.add(p)}}function findElementByIndex(index){let childNodes=doc.childNodes;if(childNodes.length===0)return null;let element=childNodes[childNodes.length-1];if(element.cprint.index+element.cprint.length<index)return null;for(let i=childNodes.length-1;i>=0;i--){element=childNodes[i];if(element.cprint.index<=index&&element.cprint.index+element.cprint.length>=index)return element}return null}function shiftIndexes(element,value){let childNodes=doc.childNodes;if(childNodes.length===0)return;for(let i=childNodes.length-1;i>=0;i--){let child=childNodes[i];if(element===child)return;child.cprint.index+=value}}function insertContent(entry){let index=parseInt(entry[keys.index]);let text=entry[keys.text];let length=text.length;let element=findElementByIndex(index);if(element===null||!stylesMatch(entry,element)){element=document.createElement("span");element.appendChild(document.createTextNode(""));element.cprint={index:index,length:0};doc.appendChild(element)}let textNode=element.lastChild;textNode.insertData(index-element.cprint.index,text);element.cprint.length+=length;if(!isAnnotatorActive())element.normalize();applyClasses(entry,element);shiftIndexes(element,length)}function removeContent(entry,count){if(count<=0||!doc)return;let index=parseInt(entry[keys.index]);if(!count)count=parseInt(entry[keys.length]);let element=findElementByIndex(index);if(!element)return;let textNode=element.lastChild;while(count>0){if(textNode.length>count){textNode.deleteData(index-element.cprint.index,count);element.cprint.length-=count;shiftIndexes(element,count);count=0}else{shiftIndexes(element,textNode.length);count-=textNode.length;element.parentNode.removeChild(element);removeContent(entry,count)}}}function processEntry(entry){if(entry.format!==formatName)return false;ensureCprintDisplayElement();if(!doc&&entry[keys.command]!==commands.new){createCPrintDoc()}switch(entry[keys.command]){case commands.new:createCPrintDoc();break;case commands.insert:insertContent(entry);break;case commands.remove:removeContent(entry);break;default:console.log("unexpected entry",entry);break}return true}exports.init=init;exports.processEntry=processEntry},{}],17:[function(require,module,exports){const basicCartDisplay=require("./basic-cart-display.js");const legalDisplay=require("./legal-display.js");const cPrintDisplay=require("./cprint-display.js");const typeWellDisplay=require("./typewell-display.js");function Router(contentElement,allowLegalDisplay,annotatorActive,wholeWords){let self=this;let handlers=[typeWellDisplay,cPrintDisplay,legalDisplay,basicCartDisplay];annotatorActive=annotatorActive||function(){return false};wction(){return false};if(allowLegalDisplay===false){handlers.splice(handlers.indexOf(legalDisplayorActive,wholeWords)});self.route=function(entry){let Entry(entry)!==false});if(handled===false){console.log("unhandled entry",entry)}}}exports.Router=Router},{"./basic-cart-display.js":15,"./cprint-display.js":16,"./legal-display.js":18,"./typewell-display.js":19}],18:[function(require,module,exports){const textHelper=require("../textHelper.js");let isAnnotatorActive;let playerElement;let legalElement;let current;const formatName="caseview";function init(contentElement,annotatorActive){playerElement=contentElement;isAnnotatorActive=annotatorActive}function ensureLegalDisplayElement(){if(!legalElement||playerElement.lastChild!=legalElement){legalElement=document.createElement("table");legalElement.classList.add("streamtext-legal-display");playerElement.appendChild(legalElement)}}function removeCurrentLine(){legalElement.removeChild(current.line);current.line=legalElement.lastChild;if(!current.line){current=null;return}current.page=current.line&&current.line.childNodes[0];current.text=current.line&&current.line.childNodes[1];current.time=current.line&&current.line.childNodes[2]}function removeCharacters(count,hasTimestamp){if(count<=0)return;while(count>0&&current){let node=current.text.lastChild;if(node===null){removeCurrentLine();return removeCharacters(count)}if(node.length>=count){node.deleteData(node.length-count,count);if(node.length===0&&hasTimestamp)removeCurrentLine();count=0}else{count-=node.length;removeCurrentLine()}}}function getCurrentNumbers(){if(!current)return{page:0,line:0};let pageNumber=current.line.dataset.pageNumber;let lineNumber=current.line.dataset.lineNumber;return{page:parseInt(pageNumber,10),line:parseInt(lineNumber,10)}}function createLine(entry){let numbers=getCurrentNumbers();let entryPage=parseInt(entry.p);if(!current)current={};current.line=document.createElement("tr");legalElement.appendChild(current.line);current.page=document.createElement("td");current.line.appendChild(current.page);current.text=document.createElement("td");current.line.appendChild(current.text);current.time=document.createElement("td");current.line.appendChild(current.time);if(numbers.page!==entryPage){numbers.page=entryPage;numbers.line=1}else numbers.line++;let pageNumber=textHelper.padLeft(numbers.page,3);current.line.dataset.pageNumber=pageNumber;let lineNumber=textHelper.padLeft(numbers.line,2);current.line.dataset.lineNumber=lineNumber;current.page.appendChild(document.createTextNode(pageNumber.concat(" / ",lineNumber)));return current}function writeValue(value){current.text.appendChild(document.createTextNode(value));if(!isAnnotatorActive())current.text.normalize()}function processEntry(entry){if(entry.format!==formatName)return false;ensureLegalDisplayElement();let hasTimestamp=entry.m&&entry.m.length>0;let pageNumber=parseInt(entry.p);let text=decodeURIComponent(entry.d);let applied=textHelper.applyDeletes(text);removeCharacters(applied.remaining,hasTimestamp);let restarted=current&&pageNumber===1&&getCurrentNumbers().page!==pageNumber;if(!current||restarted)createLine(entry);if(applied.result.length>0){applied.result=textHelper.makeSpacesNonBreaking(applied.result);writeValue(applied.result,entry)}if(hasTimestamp){current.time.textContent=entry.m;createLine(entry)}return true}exports.init=init;exports.processEntry=processEntry},{"../textHelper.js":20}],19:[function(require,module,exports){const formatName="typewell";let isAnnotatorActive;let playerElement;let typeWell;let position=0;let currentStyle;const commands={insert:"insert",select:"select",style:"style"};const keys={command:"cmd",text:"text",seek:"seek",count:"count",styles:{bold:"bold",italic:"italic",underline:"underline",math:"math",subscript:"sub",superscript:"super","subscript-subscript":"subSub","subscript-superscript":"subSuper","superscript-subscript":"superSub","superscript-superstive=annotatorActive}function appendTypeWellDisplayElement(){typeWell=document.createElement("div");typeWell.classList.add("streamtext-pre-display");typeWell.classList.add("streamtext-typewell-display");playerElement.appendChild(typeWell);position=0;currentStyle=null}function ensureTypeWellDisplayElement(){if(!typeWell||playerElement.lastChild!=typeWell)appendTypeWellDisplayElement()}function elementMatchesCurrentStyle(element){if(!currentStyle)return true;let styles=keys.styles;for(let p in styles){if(!styles.hasOwnProperty(p))continue;let value=currentStyle[styles[p]];if(value==="true"&&!element.classList.contains(p))return false;if(value==="false"&&element.classList.contains(p))return false}return true}function applyCurrentStyle(element){if(!currentStyle)return;let styles=keys.styles;for(let p in styles){if(!styles.hasOwnProperty(p))continue;if(currentStyle[styles[p]]==="true")element.classList.add(p);else element.classList.remove(p)}}function getCurrentElement(){let childNodes=typeWell.childNodes;if(childNodes.length===0)return null;for(let i=childNodes.length-1;i>=0;i--){let element=childNodes[i];if(element.typewell.index<=position&&element.typewell.index+element.typewell.length>=position)return element}return null}function shiftIndexes(element,value){let childNodes=typeWell.childNodes;if(childNodes.length===0)return;for(let i=childNodes.length-1;i>=0;i--){let child=childNodes[i];if(element===child)return;child.typewell.index+=value}}function deleteSelection(selection){if(!selection)return;if(position+selection.seek<0){if(typeWell.childNodes.length>0)appendTypeWellDisplayElement();position=0}else position+=selection.seek;if(selection.count===0)return;let element=getCurrentElement();if(!element)return;let textNode=element.lastChild;let start=position-element.typewell.index;let available=element.typewell.index+element.typewell.length-position;let remove=available>=selection.count?selection.count:available;if(remove===0)return;textNode.deleteData(start,remove);element.typewell.length-=remove;shiftIndexes(element,-remove);if(textNode.length===0)element.parentNode.removeChild(element);selection.count-=remove;selection.seek=0;if(selection.count>0)deleteSelection(selection)}function insertContent(entry){let text=entry[keys.text];let length=text.length;let element=getCurrentElement();if(element===null){element=createTextElement();element.typewell={index:position,length:0};typeWell.appendChild(element)}else if(!elementMatchesCurrentStyle(element)){element=splitElement(element)}let textNode=element.lastChild;textNode.insertData(position-element.typewell.index,text);if(!isAnnotatorActive())element.normalize();element.typewell.length+=length;position+=length;shiftIndexes(element,length)}function createTextElement(){let element=document.createElement("span");applyCurrentStyle(element);element.appendChild(document.createTextNode(""));return element}function selectAndDelete(entry){let selection={seek:parseInt(entry.seek,10),count:parseInt(entry.count,10)};deletnt,referenceElement)}function insertAfter(referenceElement,newElement){let next=referenceElement.nextSibling;if(next)referenceElement.parentElement.insertBefore(newElement,next);else referenceElement.parentElement.appendChild(newElement)}function splitElement(element){let newElement=createTextElement();newElement.typewell={index:position,length:0};let splitIndex=position-element.typewell.index;if(splitIndex===0){insertBefore(element,newElement);return newElement}if(splitIndex===element.typewell.length){insertAfter(element,newElement);return newElement}let textNode=element.lastChild;let after=textNode.substringData(splitIndex,textNode.length-splitIndex);textNode.deleteData(splitIndex,textNode.length-splitIndex);element.typewell.length=splitIndex;let afterElement=element.cloneNode(false);afterElement.appendChild(document.createTextNode(after));afterElement.typewell={index:position,length:after.length};insertAfter(element,afterElement);insertAfter(element,newEleme){currentStyle=entry}function processEntry(entry){if(entry.format!==formatName)return false;ensureTypeWellDisplayElement();switch(entry[keys.command]){case commands.insert:insertContent(entry);break;case commands.select:selectAndDelete(entry);break;case commands.style:applyStyle(entry);break;default:console.log("unexpected entry",entry);break}return true}exports.init=init;exports.processEntry=processEntry},{}],20:[function(require,module,exports){const util=require("util");let matchSpace=/ /g;function applyDeletes(value){if(value===undefined||value===null)return{remaining:0,result:""};let chars=typeof value==="string"?value.split(""):value;let deletes=0;for(let i=chars.length-1;i>=0;i--){if(chars[i]==="\b"){chars.splice(i,1);deletes++}else if(deletes>0){chars.splice(i,1);deletes--}}return{remaining:deletes,result:chars.join("")}}function makeSpacesNonBreaking(value){if(!value||value.length===0)return value;return value.replace(matchSpace,Stri+1).join(char)+value}exports.applyDeletes=applyDeletes;exports.padLeft=padLeft;exports.makeSpacesNonBreaking=makeSpacesNonBreaking},{util:10}],21:[function(require,module,exports){va|^.*$"),"$1"))||null},setItem:function setItem(sKey,sValue,vEnd,sPath,sDomain,bSecure){if(!sKey||/^(?:expires|max\-age|path|domain|secure)$/i.test(sKey)){return false}var sExpires="";if(vEnd){switch(vEnd.constructor){case Number:sExpires=vEnd===Infinity?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+vEnd;break;case String:sExpires="; expires="+vEnd;break;case Date:sExpires="; expires="+vEnd.toUTCString();break}}document.cookie=encodeURIComponent(sKey)+"="+encodeURIComponent(sValue)+sExpires+(sDomain?"; domain="+sDomain:"")+(sPath?"; path="+sPath:"")+(bSecure?"; secure":"");return true},removeItem:function removeItem(sKey,sPath,sDomain){if(!this.hasItem(sKey)){return false}document.cookie=encodeURIComponent(sKey)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(sDomain?"; domain="+sDomain:"")+(sPath?"; path="+sPath:"");return true},hasItem:function hasItem(sKey){if(!sKey){return false}return new RegExp("(?:^|;\\s*)"+encodeURIComponent(sKey).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},keys:function keys(){var aKeys=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/);for(var nLen=aKeys.length,nIdx=0;nIdx<nLen;nIdx++){aKeys[nIdx]=decodeURIComponent(aKeys[nIdx])}return aKeys}};module.exports=docCookies},{}],22:[function(require,module,exports){const cookies=require("./cookies.js");const uri=require("urijs");function TextControl(settings){let self=this;settings=settings||{};settings.spacing=settings.spacing||1.5;settings.scroll=settings.scroll===undefined?true:settings.scroll;settings.words=settings.words===undefined?false:settings.words;let content=settings.contentElement;let background=document.getElementById(settings.parentId||"")||content;let scroll=document.getElementById(settings.scrollId||"scroll");let theme=document.getElementById(settings.themeId||"theme");let language=document.getElementById(settings.languageId||"language");let fontFamily=document.getElementById(settings.fontFamilyId||"fontFamily");let fontSize=document.getElementById(settings.fontSizeId||"fontSize");let foreColor=document.getElementById(settings.foreColorId||"foreColor");let backColor=document.getElementById(settings.backColorId||"backColor");let words=document.getElementById(settings.wordsId||"words");let changeLock=null;let themeChanging=false;function getStyle(settings){let keys=["fontFamily","fontSize","foreColor","backColor"];function mergeStyles(destinationion[key]=source[key]})}let result={fontFamily:fontFamily&&fontFamily.value,fontSize:fontSize&&fontSize.value,foreColor:foreColor&&foreColor.value,backColor:backColor&&backColor.value,scroll:settings.scroll,languages:settings.languages,language:settings.language};let userStyle=cookies.getItem("tps");if(userStyle){userStyle=JSON.parse(userStyle);mergeStyles(result,userStyle)}mergeStyles(result,settings);return result}let style=getStyle(settspacing;return style};self.setOptions=function setOptions(value){applyStyle(value);saveStyle();if(value.language!==undefined)setLanguage(value.language);if(value.scroll!==undefined)setScroll(value.scroll)};self.onTextChange=function onTextChange(){if(settings.scroll===true){if(content.scrollTop===undefined)window.scrollTo(0,content.offsetHeight);else content.scrollTop=content.scrollHeight-content.clientHeiettings.scroll=value}function onScrollChange(){setScroll(scroll.checked.words=words.checked}function checkColors(){if(themeChanging===true||foreColor.value!==backColor.value)return;alert("Back color and font color are now the same.  You will have to change one or the other to see the text.")}function checkTheme(){if(themeChanging===true||!theme)return;let value=backColor.value.concat(";",foreColor.value);let filtered=Array.prototype.filter.call(theme.options,function(option){option.selected=false;return option.value===value});if(filtered.length>0)filtered[0].selected=true;else theme.value=""}function onThemeChange(){if(!theme.value)return;themeChanging=true;let values=theme.value.split(";");if(backColor){backColor.value=values[0];onBackColorChange()}if(foreColor){foreColor.value=values[1];onForeColorChange()}themeChanging=false}function createOutline(){background.style.color=style.backColor;background.style.textShadow="-1px -1px 0 "+style.foreColor+", 1px -1px 0 "+style.foreColor+", -1px 1px 0 "+style.foreColor+", 1px 1px 0 "+style.foreColor}function onBackColorChange(){if(!acquireChangeLock(backColor))return;setBackgroundColor(backColor.value);releaseChangeLock(backColor);checkColors();checkTheme();saveStyle()}function setBackgroundColor(value){background.style.backgroundColor=value;style.backColor=value;if(settings.outline===true)createOutline()}function onForeColorChange(){if(!acquireChangeLock(foreColor))return;setForeColor(foreColor.value);releaseChangeLock(foreColor);checkColors();checkTheme();saveStyle()}function setForeColor(value){background.style.color=value;style.foreColor=value;if(settings.outline===true)createOutline()}function onFontFamilyChange(){if(!acquireChangeLock(fontFamily))return;setFontFamily(fontFamily.value);releaseChangeLock(fontFamily);self.onTextChange();saveStyle()}function setFontFamily(value){content.style.fontFamily=value;style.fontFamily=value}function onFontSizeChange(){if(!acquireChangeLock(fontSize))return;setFontSize(fontSize.value);releaseChangeLock(fontSize);self.onTextChange();saveStyle()}function setFontSize(value){content.style.fontSize=value;style.fontSize=value;let regex=/\D/gi;let size=parseInt(value.replace(regex,""))*settings.spacing;content.styleuage(language.value)}function setLanguage(value){let location=new uri(document.location.href);let query=location.query(true);query.language=value;location.query(query);window.location.replace(location.href())}function saveStyle(){cookies.setItem("tps",JSON.stringify(style),2592e3)}function acquireChangeLock(element){if(changeLock!==null&&changeLock!==element)return false;changeLock=element;return true}function releaseChangeLock(element){if(changeLock===element){changeLock=null;return true}return false}function applyStyle(value){if(value.foreColor){setForeColor(value.foreColor);if(foreColor)foreColor.value=value.foreColor}if(value.backColor){setBackgroundColor(value.backColor);if(backColor)backColor.value=value.backColor}if(value.fontFamily){setFontFamily(value.fontFamily);if(fontFamily)fontFamily.value=value.fontFamily}if(value.fontSize){setFontSize(value.fontSize);if(fontSize)fontSize.value=value.fontSize}checkTheme()}applyStyle(style);if(theme)theme.addEventListener("change",onThemeChange);if(backColor)backColor.addEventListener("change",onBackColorChange);if(foreColor)foreColor.addEventListener("change",onForeColorChange);if(fontFamily)fontFamily.addEventListener("change",onFontFamilyChange);if(fontSize)fontSize.addEventListener("change",onFontSizeChange);if(language)language.addEventListener("change",onLanguageChange);if(scroll)scroll.addEventListener("change",onScrollChange);if(words)words.addEventListener("change",onWordsChange)}module.exports=TextControl},{"./cookies.js":21,urijs:6}]},{},[11]);
