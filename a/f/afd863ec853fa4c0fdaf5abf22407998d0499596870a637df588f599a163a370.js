define(["jquery","underscore"],(function(e,t){"use strict";var n=e(".generic-blog"),i=n.find(".sticky-banner-wrap"),o=i.find(".sticky-banner"),r=n.find(".generic-blog-sticky-header-wrapper"),a=r.find(".generic-blog-sticky-header"),s=n.find(".kpn-top-navigation__primary"),c=a.find(".generic-blog-filter-button"),l=a.find(".generic-blog-filter-menu"),f=l.find("#filter-options-form .checkbox input"),d=[],u=e(".kpn-top-navigation, .tsg-generic-navigation"),g=window.matchMedia("(max-width: 767px)"),h=window.matchMedia("(max-width: 991px)"),p=0,v=e(u).outerHeight(),b=e(s).outerHeight(),k=i.outerHeight(),m=void 0,C=function(){e(r).height(e(a).height()),e(i).height(e(o).height())},w=y=function(){p=h.matches?e(u).outerHeight():n.find(".header-top-bar").outerHeight()},x=function(){w()},H=t.debounce((function(){y(),x(),v=e(u).outerHeight(),b=e(s).outerHeight(),k=i.outerHeight(),C(),void 0!==m&&m()}),25);window.addEventListener("resize",H);var O=function(){u.hasClass("is-up")||u.hasClass("kpn-top-navigation--scrolling-down")?e(".generic-blog-sticky-header,.sticky-banner").css("transform","translateY("+-p+"px)"):e(".generic-blog-sticky-header,.sticky-banner").css("transform","translateY(0)")},D=function(){l.toggleClass("filter-open"),E(),n.find(".blog-filter-backdrop").toggleClass("is-active")},E=T=function(){var e=t.escape(l.data("genericblog-filter"));t.isEmpty(e)||(d.length?M(d):L(e).then(())},L=M=function(n){var i=_(f),o=Y(i,n);t.each(f,(function(n){var i=e(n),r=i.val(),a=e(l).find('[for="filter-'+r+'"]').children(".filter-count"),s=0;t.each(o,(function(e){t.each(e,()})),a.html("("+s+")"),i.attr("disabled",!s).parent().toggleClass("disabled",!s)}))},Y=function(n,i){return t.each(e(n),(function(e){i=t.filter(i,()})),i},_=function(n){var i=[];return t.chain(n).filter(().each(().value(),i};return{init:function(){var i,r;(i=document.createElement("div")).classList.add("blog-filter-backdrop"),document.body.appendChild(i),n.on("paginationDone",(),C(),y(),x(),r=u,new MutationObserver(O).observe(r[0],{attributes:!0,attributeOldValue:!0,attributeFilter:["class"]}),T(),w(),c.on("click",(function(t){e(t.currentTarget).toggleClass("active").data("toggle"),D()})),f.on("change",(function(t){e(t.currentTarget).toggleClass("active"),T()})),n.find("#reset-filter-options").on("click",(function(e){e.preventDefault(),n.find("#filter-options-form input:checked").prop("checked",!1).removeClass("active"),T()})),n.find(".filter-submit").on("click",(function(e){e.preventDefault(),c.removeClass("active"),D()})),n.find(".blog-filter-backdrop").on("click",(function(e){e.preventDefault(),l.hasClass("filter-open")&&(n.find(".blog-filter-backdrop").removeClass("is-active"),l.removeClass("filter-open"),c.removeClass("active"))})),o.hasClass("unstick-banner-on-scroll")&&(m=()=>{window.scrollY>=k?(a.css("position","fixed"),u.hasClass("kpn-top-navigation--scrolling-down")?a.css("top",b):a.css("top",v)):(a.css("position","relative"),a.css("top",0))},e(window).on("scroll",t.throttle(m)))}}}));