ï}function TriggerAd(e,t,r){function n(e,t){return Math.floor(ldgf.rnd*(t-e+1))+}function i(e){var t=I.InvalidStrategies;return null==t||0==t.length||!o(e,t)}function o(e,t){if(0==t.length)return!0;for(var r=0;r<t.length;r++)if(l(e,t[r]))return!0;return!1}function l(e,t){function r(e){var t=new Date(parseInt(e.replace("/Date(","").replace(")/",""),10));return new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds())}function n(e,t){for(var r=t.split("\\"),n=!1,a=0;a<r.length&&!(n=r[a]==e);a++);return n}function a(e,t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var r="[\\?&]"+t+"=([^&#]*)",n=new RegExp(r),a=n.exec(e);return null==a?"":decodeURIComponent(a[1].replace(/\+/g," "))}var i=new Date;if(i.addHours(i.getTimezoneOffset()/60),0!=t.Timezone){var o=new Date;o=new Date(o.valueOf()+6e4*(o.getTimezoneOffset()+t.TimeZoneOffsetMinutes)),o.dst()&&o.addHours(1);var l=new Date(o.getFullYear(),o.getMonth(),o.getDate()),s=o.getHours()+o.getMinutes()/60;if(null!=t.BeginDate&&!(r(t.BeginDate)<=l))return!1;if(null!=t.EndDate&&!(r(t.EndDate)>=l))return!1;if(null!=t.DaysOfWeek&&t.DaysOfWeek.length>0&&!d(p.getDay(),t.DaysOfWeek))return!1;if(null!=t.StartTime&&s<t.StartTime)return!1;if(null!=t.EndTime&&s>t.EndTime)return!1}if(null!=t.Locations&&0!=t.Locations.length){var u=!1;if(""==e.Country){var g=JSON.parse(f(geoURL));e.Country=g.Country,e.Region=g.Region,e.City=g.City}for(var h=0;h<t.Locations.length;h++){var D=t.Locations[h];if(!(0!=D.DmaID&&parseInt(e.DmaID)!=D.DmaID||0!=D.RegionID&&parseInt(e.RegionID)!=D.RegionID||0!=D.CountryID&&!n(e.Country,D.Country)||0!=D.StateID&&!n(e.Region,D.Region)||0!=D.CityID&&!n(e.City,D.City))){u=!0;break}}if(!u)return!1}if(!d(parseInt(e.br),t.Browser))return!1;if(!d(parseInt(e.l),t.Languages))return!1;if(0!=t.AffiliateGroups.length){for(var I=!1,y=0;y<t.AffiliateGroups.length;y++)if(d(t.AffiliateGroups[y],c)){I=!0;break}if(!I)return!1}if(!d(e.os,t.OperatingSystem))return!1;if(0!=t.ContentKeywords.length){var m=!1,v=e.ReferralUrl;if(v=v.slice(v.indexOf("?")+1).split("&"),null!=e.gKeywords&&e.gKeywords.length>0)for(var M=decodeURI(a(e.gKeywords,"q")).split("+"),h=0;h<M.length;h++)v[v.length]=M[h];for(var w=0;w<t.ContentKeywords.length;w++)for(var A=0;A<v.length;A++){if(v[A].toLowerCase().indexOf(t.ContentKeywords[w].toLowerCase())>=0){m=!0;break}if(m)break}if(!m)return!1}if(0!=t.ReferralStrategies.length){var C=!1,R=e.ReferralUrl.toLowerCase();if(null==R||""==R)return!1;for(var T=0;T<t.ReferralStrategies.length;T++){var O=t.ReferralStrategies[T],S=O.Url.toLowerCase(),k=O.MustMatch;if(k&&R==S){C=!0;break}if(!k&&(S.indexOf(R)>=0||R.indexOf(O.Url.toLowerCase())>=0)){C=!0;break}}if(!C)return!1}try{var b=t.RetargetingConditions.length,P=!(b>0);null==e.retargetIngProf&&(e.retargetIngProf=JSON.parse(f(e.u+"/AdServingData/ProfileData.ashx",{a:e.AdID,m:e.ParentMerchantID})));for(var x=0;b>x;x++){var U=t.RetargetingConditions[x];if(parseInt(U.PlayerState)==parseInt(e.retargetIngProf.r)){var H=1==U.Activity?e.retargetIngProf.fc:e.retargetIngProf.lc;if(null!=H&&H>=parseInt(U.BaseValue)&&H<=parseInt(U.RoofValue)){P=!0;break}}}if(!P)return!1}catch(L){}return!0}function f(e,t,r){var n=null;if(window.XMLHttpRequest){n=new XMLHttpRequest;try{n.overrideMimeType("text/plain")}catch(a){}}else n=window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest;if(null==r&&(r=!1),n.open("POST",e,r),null!=t){var i="";for(var o in t)t.hasOwnProperty(o)&&(i+=o+"="+g(t[o])+"&");n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.send(i)}else n.send();return 200==n.status?n.responseText:void 0}function s(e,t){var r=1e4*(new Date).getTime()+621355968e9,n=e.br+e.s+e.l+e.s+e.os+e.s+g(e.City)+e.s+g(e.Region)+e.s+g(e.Country)+e.s+0+e.s+0+e.s+e.s,a=e.ts+"&t="+r+"&MediaID="+e.MediaID+"&MediaIndex="+e.i+"&"+e.C_USER+"="+g(n);document.write("<iframe style='display:none;' src='"+a+"'></iframe>")}function u(e,t){return e.addParams.length>0&&"?"==e.addParams[0]&&(e.addParams=e.addParams.substring(1)),e.addParams.length>0&&(e.addParams="&"+e.addParams),t=t.rA("[bannerid]",I.AdID).rA("[affsiteid]",e.sd).rA("[memid]",e.sd).rA("[siteid]",e.sd).rA("[mediaid]",h.MediaID).rA("[btag]",e.btag).rA("[affiliateid]",e.af).rA("[curday]",p.getDay()).rA("[curmonth]",p.getMonth()).rA("[curyear]",p.getYear())}function d(e,t){for(var r=0;r<t.length;r++)if(t[r]==e)return!0;return t=0==t.length}function g(e){var t=encodeURIComponent(e);return t==e&&(t=t.rA("%","%25").rA("&","%26").rA("=","%3D")),t.replace(/'/g,"%27")}var c,h,p=new Date,D=null,I=theAd;I.DefaultMediaItem={MediaID:I.MediaID,HtmlMarkup:I.HtmlMarkup};var y,m=ldgf,v=ga();if(m.Country=a(m.Country),m.Region=a(m.Region),m.City=a(m.City),c=m.AffiliateGroups,h=I.DefaultMediaItem,m.ReferralUrl=m.referrer,m.AdID=I.AdID,m.MediaID=h.MediaID,m.MerchantID=I.MerchantID,m.ParentMerchantID=I.ParentMerchantID,i(m)){for(var M=I.MediaStrategies,w=0;w<M.length;w++)if(o(m,M[w].Strategies)&&M[w].SelectedMedia.length>0){if(v=M[w].SelectedMedia,"0"==M[w].Rotation)m.i=n(0,v.length-1);else if("1"==M[w].Rotation)null==m.i||void 0==m.i||"undefined"==m.i?m.i=0:(m.i=parseInt(m.i)+1,m.i>=v.length&&(m.i=0));else if("2"==M[w].Rotation){for(var A,C=0,R=0,T=0;T<v.length;T++)C+=v[T].Weight;A=n(1,C);for(var T=0;T<v.length;T++){if(A<=R+v[T].Weight){m.i=T;break}R+=v[T].Weight}}h=v[m.i];break}if(v.length>0?D=v:(D=ga(),D.push(h)),m.MediaID=h.MediaID,null!=h.TheMedia&&void 0!=h.TheMedia){var O=h.TheMedia;y=""==O.HtmlMarkup?O.TextMarkup:O.HtmlMarkup}else y=h.HtmlMarkup;if(m.cl=m.cl+"&MediaID="+m.MediaID+"&IsAd=1",!Boolean("true"==m.IsScript)){var S=g(m.ReferralUrl);-1!=y.indexOf("[clickthroughurlencoded]")&&(S=S.rA("%3D","%253D").rA("%26","%2526")),m.cl=m.cl+"&IAref="+S}y=y.rA("[clickthroughurl]",m.cl),y=y.rA("[clickthroughurlflash]",g(m.cl)),y=y.rA("[clickthroughurlencoded]",g(m.cl).rA("%3D","%253D").rA("%26","%2526")),y=u(m,y),1!=m.AutoRedirect?(1!=r&&document.write(m.IsScript?y:"<body style='padding: 0px; margin: 0px; border: 0px;'>"+y+"</body>"),s(ldgf,!0)):s(m,!1)}else document.write("Sorry, you cannot be advertised to."),D=ga()}String.prototype.rA=function(e,t,r){return null==r&&(r=!0),this.replace(new RegExp(e.replace(/([\/\,\!\\\^\$\{\}\[\]\(\)\.\*\+\?\|\<\>\-\&])/g,"\\$&"),r?"gi":"g"),"string"==typeof t?t.replace(/\$/g,"$$$$"):t)},Date.prototype.addHour},Date.prototype.stdTimezoneOffse},Date.prototype.ds};