"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2331],{21439:function(e,t,i){let s;i.d(t,{BI:function(){return getDeloser},GL:function(){return disposeTabster},GX:function(){return getMover},V0:function(){return getModalizer},Yk:function(){return m},ox:function(){return createTabster},yS:);var o=i(21956);i(13158);/*!
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */let r="data-tabster",n="data-tabster-dummy",l="tabster:deloser",a="tabster:modalizer",u="tabster:mover",d={History:0,DeloserDefault:1,RootDefault:2,DeloserFirst:3,RootFirst:4},h={Invisible:0,PartiallyVisible:1,Visible:2},c={Both:0,Vertical:1,Horizontal:2,Grid:3};var m=Object.freeze({__proto__:null,TabsterAttributeName:r,TabsterDummyInputAttributeName:n,DeloserEventName:l,ModalizerEventName:a,MoverEventName:u,ObservedElementAccesibilities:{Any:0,Accessible:1,Focusable:2},RestoreFocusOrders:d,Visibilities:h,MoverDirections:c,GroupperTabbabilities:{Unlimited:0,Limited:1,LimitedTrapFocus:2}});/*!
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */unction updateTabsterByAttribute(e,t,i){var s,o;let n;let l=i||e._noop?void 0:t.getAttribute(r),a=e.storageEntry(t);if(l){if(l===(null===(s=null==a?void 0:a.attr)||void 0===s?void 0:s.string))return;try{let e=JSON.parse(l);if("object"!=typeof e)throw Error(`Value is not a JSON object, got '${l}'.`);n={string:l,object:e}}catch(e){}}else if(!a)return;a||(a=e.storageEntry(t,!0)),a.tabster||(a.tabster={});let u=a.tabster||{},d=(null===(o=a.attr)||void 0===o?void 0:o.object)||{},h=(null==n?void 0:n.object)||{};for(let i of Object.keys(d))if(!h[i]){if("root"===i){let t=u[i];t&&e.root.onRoot(t,!0)}else if("modalizer"===i){let t=u.modalizer;e.modalizer&&t&&e.modalizer.updateModalizer(t,!0)}switch(i){case"deloser":case"root":case"groupper":case"modalizer":case"mover":let s=u[i];s&&(s.dispose(),delete u[i]);break;case"observed":delete u[i],e.observedElement&&e.observedElement.onObservedElementUpdate(t);break;case"focusable":case"outline":case"uncontrolled":delete u[i]}}for(let i of Object.keys(h))switch(i){case"deloser":u.deloser?u.deloser.setProps(h.deloser):e.deloser&&(u.deloser=e.deloser.createDeloser(t,h.deloser));break;case"root":u.root?u.root.setProps(h.root):u.root=e.root.createRoot(t,h.root),e.root.onRoot(u.root);break;case"modalizer":u.modalizer?u.modalizer.setProps(h.modalizer):e.modalizer&&(u.modalizer=e.modalizer.createModalizer(t,h.modalizer));break;case"focusable":u.focusable=h.focusable;break;case"groupper":u.groupper?u.groupper.setProps(h.groupper):e.groupper&&(u.groupper=e.groupper.createGroupper(t,h.groupper));break;case"mover":u.mover?u.mover.setProps(h.mover):e.mover&&(u.mover=e.mover.createMover(t,h.mover));break;case"observed":e.observedElement&&(u.observed=h.observed,e.observedElement.onObservedElementUpdate(t));break;case"uncontrolled":u.uncontrolled=h.uncontrolled;break;case"outline":e.outline&&(u.outline=h.outline);break;default:console.error(`Unknown key '${i}' in data-tabster attribute value.`)}n?a.attr=n:(0===Object.keys(u).length&&(delete a.tabster,delete a.attr),e.storageEntry(t,!1))}let _="undefined"!=typeof DOMRect?DOMRect:class{constructor(e,t,i,s){this.left=e||0,this.top=t||0,this.right=(e||0)+(i||0),this.bottom=(t||0)+(s||0)}},f=0;try{document.createTreeWalker(document,NodeFilter.SHOW_ELEMENT),s=!1}catch(e){s=!0}et FakeWeakRef=class FakeWeakRef{constructor(e){this._target=e}deref(){return this._target}static cleanup(e,t){return!e._target||(!!t||!documentContains(e._target.ownerDocument,e._target))&&(delete e._target,!0)}};let WeakHTMLElement=class WeakHTMLElement{constructor(e,t,i){let s;let o=getInstanceContext(e);o.WeakRef?s=new o.WeakRef(t):(s=new FakeWeakRef(t),o.fakeWeakRefs.push(s)),this._ref=s,this._data=i}get(){let e;let t=this._ref;return!t||(e=t.deref())||delete this._ref,e}getData(){return this._data}};function cleanupFakeWeakRefs(e,t){let i=getInstanceContext(e);i.fakeWeakRefs=i.fakeWeakRefs.filter(}function createElementTreeWalker(e,t,i){if(t.nodeType!==Node.ELEMENT_NODE)return;let o=s?i:{acceptNode:i};return e.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,o,!1)}function getBoundingRect(e,t){let i=t.__tabsterCacheId,s=getInstanceContext(e),o=i?s.containerBoundingRectCache[i]:void 0;if(o)return o.rect;let r=t.ownerDocument&&t.ownerDocument.documentElement;if(!r)return new _;let n=0,l=0,a=r.clientWidth,u=r.clientHeight;if(t!==r){let e=t.getBoundingClientRect();n=Math.max(n,e.left),l=Math.max(l,e.top),a=Math.min(a,e.right),u=Math.min(u,e.bottom)}let d=new _(n<a?n:-1,l<u?l:-1,n<a?a-n:0,l<u?u-l:0);return i||(i="r-"+ ++s.lastContainerBoundingRectCacheId,t.__tabsterCacheId=i),s.containerBoundingRectCache[i]={rect:d,element:t},s.containerBoundingRectCacheTimer||(s.containerBoundingRectCacheTimer=window.setTimeout(()=>{for(let e of(s.containerBoundingRectCacheTimer=void 0,Object.keys(s.containerBoundingRectCache)))delete s.containerBoundingRectCache[e].element.__tabsterCacheId;s.containerBoundingRectCache={}},50)),d}function isElementVerticallyVisibleInContainer(e,t){let i=getScrollableContainer(t);if(i){let s=getBoundingRect(e,i),o=t.getBoundingClientRect();return o.top>=s.top&&o.bottom<=s.bottom}return!1}function scrollIntoView(e,t,i){let s=getScrollableContainer(t);if(s){let o=getBoundingRect(e,s),r=t.getBoundingClientRect();i?s.scrollTop+=r.top-o.top:s.scrollTop+=r.bottom-o.bottom}}nction getElementUId(e,t){let i=getInstanceContext(e),s=t.__tabsterElementUID;return s||(s=t.__tabsterElementUID=function(e){let t=new Uint32Array(4);if(e.crypto&&e.crypto.getRandomValues)e.crypto.getRandomValues(t);else if(e.msCrypto&&e.msCrypto.getRandomValues)e.msCrypto.getRandomValues(t);else for(let e=0;e<t.length;e++)t[e]=4294967295*Math.random();let i=[];for(let e=0;e<t.length;e++)i.push(t[e].toString(36));return i.push("|"),i.push((++f).toString(36)),i.push("|"),i.push(Date.now().toString(36)),i.join("")}(e())),!i.elementByUId[s]&&documentContains(t.ownerDocument,t)&&(i.elementByUId[s]=new WeakHTMLElement(e,t)),s}function clearElementCache(e,t){let i=getInstanceContext(e);for(let e of Object.keys(i.elementByUId)){let s=i.elementByUId[e],o=s&&s.get();(!o||!t||t.contains(o))&&delete i.elementByUId[e]}}function documentContains(e,t){var i;return!!(null===(i=null==e?void 0:e.body)||void 0===i?void 0:i.contains(t))}unction getPromise(e){let t=getInstanceContext(e);if(t.basics.Promise)return t.basics.Promise;throw Error("No Promise defined.")}let b=0;let TabsterPart=class TabsterPart{constructor(e,t,i){let s=e.getWindow;this._tabster=e,this._element=new WeakHTMLElement(s,t),this._props={...i},this.id="i"+ ++b}etProps(){return this._props};let DummyInput=class DummyInput{constructor(e,t,i,s){var o;this._focusIn=e=>{let t=this.input;if(this.onFocusIn&&t){let i=DummyInputManager.getLastPhantomFrom()||e.relatedTarget;this.onFocusIn(this,this._isBackward(!0,t,i),i)}},this._focusOut=e=>{this.shouldMoveOut=!1;let t=this.input;if(this.onFocusOut&&t){let i=e.relatedTarget;this.onFocusOut(this,this._isBackward(!1,t,i),i)}};let r=e(),l=r.document.createElement("i");l.tabIndex=0,l.setAttribute("role","none"),l.setAttribute(n,""),l.setAttribute("aria-hidden","true");let a=l.style;a.position="fixed",a.width=a.height="1px",a.opacity="0.001",a.zIndex="-1",a.setProperty("content-visibility","hidden"),l.__shouldIgnoreFocus=!0,this.input=l,this.isFirst=i.isFirst,this.isOutside=t,this._isPhantom=null!==(o=i.isPhantom)&&void 0!==o&&o,l.addEventListener("focusin",this._focusIn),l.addEventListener("focusout",this._focusOut),l.__tabsterDummyContainer=s,this._isPhantom&&(this._disposeTimer=r.setTimeout(()=>{delete this._disposeTimer,this.dispose()},0),this._clearDisposeTimeout=()=>{this._disposeTimer&&(r.clearTimeout(this._disposeTimer),delete this._disposeTimer),delete this._clearDisposeTimeout})}disposeetTopLeft(e,t){var i;let s=null===(i=this.input)||void 0===i?void 0:i.style;s&&(s.top=`${e}px`,s.left=`${t}px`)}_isBackward;let DummyInputManager=class DummyInputManager{constructor(e,t,i,s){this._element=t,this._instance=new DummyInputManagerCore(e,t,this,i,s),this.moveOutWithDefaultAction=_setHandlers(e,t){this._onFocusIn=e,this._onFocusOut=t}sposetatic getLastPhantomFromtatic moveWithPhantomDummy(e,t,i,s){let r=new DummyInput(e.getWindow,!0,{isPhantom:!0,isFirst:!0}),n=r.input;if(n){let r=t.parentElement;if(r){let l=i&&!s||!i&&s?t.nextElementSibling:t;if(l){if(s){let e=l.previousElementSibling;e&&e.__tabsterDummyContainer&&(l=e)}else l.__tabsterDummyContainer&&(l=l.nextElementSibling)}r.insertBefore(n,l),DummyInputManager._lastPhantomFrom=t,e.getWindow().setTimeout(0),(0,o.ev)(n)}}}};let DummyInputManagerCore=class DummyInputManagerCore{constructor(e,t,i,s,o){var r;this._wrappers=[],this._isOutside=!1,this._transformElements=[],this._onFocusIn=(e,t,i)=>{this._onFocus(!0,e,t,i)},this._onFocusOut=(e,t,i)=>{this._onFocus(!1,e,t,i)},this.moveOutWithDefaultAction=e=>{let t=this._firstDummy,i=this._lastDummy;(null==t?void 0:t.input)&&(null==i?void 0:i.input)&&(e?(t.shouldMoveOut=!0,t.input.tabIndex=0,t.input.focus()):(i.shouldMoveOut=!0,i.input.tabIndex=0,i.input.focus()))},this.setTabbable=(e,t)=>{var i,s;for(let i of this._wrappers)if(i.manager===e){i.tabbable=t;break}let o=this._getCurrent();if(o){let e=o.tabbable?0:-1,t=null===(i=this._firstDummy)||void 0===i?void 0:i.input;t&&(t.tabIndex=e),(t=null===(s=this._lastDummy)||void 0===s?void 0:s.input)&&(t.tabIndex=e)}},this._addTransformOffsets=()=>{let e=this._getWindow();this._scrollTimer&&e.clearTimeout(this._scrollTimer),this._scrollTimer=e.setTimeout(100)};let n=t.get();if(!n)throw Error("No element");this._getWindow=e.getWindow;let l=n.__tabsterDummy;if((l||this)._wrappers.push({manager:i,priority:s,tabbable:!0}),l)return l;n.__tabsterDummy=this,this._firstDummy=new DummyInput(this._getWindow,this._isOutside,{isFirst:!0},t),this._lastDummy=new DummyInput(this._getWindow,this._isOutside,{isFirst:!1},t),this._firstDummy.onFocusIn=this._onFocusIn,this._firstDummy.onFocusOut=this._onFocusOut,this._lastDummy.onFocusIn=this._onFocusIn,this._lastDummy.onFocusOut=this._onFocusOut,this._element=t,this._addDummyInputs();let a=null===(r=t.get())||void 0===r?void 0:r.tagName;this._isOutside=(o||"UL"===a||"OL"===a||"TABLE"===a)&&!("LI"===a||"TD"===a||"TH"===a),this._observeMutations()}dispose(e,t){var i,s,o;let r=this._wrappers=this._wrappers.filter(i=>i.manager!==e&&!t);if(0===r.length){for(let e of(delete(null===(i=this._element)||void 0===i?void 0:i.get()).__tabsterDummy,this._unobserve&&(this._unobserve(),delete this._unobserve),this._transformElements))e.removeEventListener("scroll",this._addTransformOffsets);this._transformElements=[];let e=this._getWindow();this._scrollTimer&&(e.clearTimeout(this._scrollTimer),delete this._scrollTimer),this._addTimer&&(e.clearTimeout(this._addTimer),delete this._addTimer),null===(s=this._firstDummy)||void 0===s||s.dispose(),null===(o=this._lastDummy)||void 0===o||o.dispose()}}_onFocus(e,t,i,s){var o;let r=this._getCurrent();r&&(null===(o=r.manager.getHandler(e))||void 0===o||o(t,i,s))}_getCurrent(){return this._wrappers.sort((e,t)=>e.tabbable!==t.tabbable?e.tabbable?-1:1:e.priority-t.priority),this._wrappers[0]}_addDummyInputs(){this._addTimer||(this._addTimer=this._getWindow().setTimeout(()=>{var e,t,i;delete this._addTimer;let s=null===(e=this._element)||void 0===e?void 0:e.get(),o=null===(t=this._firstDummy)||void 0===t?void 0:t.input,r=null===(i=this._lastDummy)||void 0===i?void 0:i.input;if(s&&o&&r){if(this._isOutside){let e=s.parentElement;if(e){let t=s.nextElementSibling;t!==r&&e.insertBefore(r,t),s.previousElementSibling!==o&&e.insertBefore(o,s)}}else{s.lastElementChild!==r&&s.appendChild(r);let e=s.firstElementChild;e&&e!==o&&s.insertBefore(o,e)}this._addTransformOffsets()}},0))}_observeMutations(){var e;if(this._unobserve)return;let t=new MutationObserver(,i=null===(e=this._element)||void 0===e?void 0:e.get(),s=this._isOutside?null==i?void 0:i.parentElement:i;s&&(t.observe(s,{childList:!0}),this._unobserve=()=>{t.disconnect()})}_reallyAddTransformOffsets(){var e,t,i,s;let o=(null===(e=this._firstDummy)||void 0===e?void 0:e.input)||(null===(t=this._lastDummy)||void 0===t?void 0:t.input),r=this._transformElements,n=[],l=new WeakMap,a=new WeakMap,u=0,d=0;for(let e of r)l.set(e,e);let h=this._getWindow();for(let e=o;e;e=e.parentElement){let t=h.getComputedStyle(e).transform;if(t&&"none"!==t){let t=l.get(e);t||(t=e).addEventListener("scroll",this._addTransformOffsets),n.push(t),a.set(t,t),u+=t.scrollTop,d+=t.scrollLeft}}for(let e of r)a.get(e)||e.removeEventListener("scroll",this._addTransformOffsets);this._transformElements=n,null===(i=this._firstDummy)||void 0===i||i.setTopLeft(u,d),null===(s=this._lastDummy)||void 0===s||s.setTopLeft(u,d)}};function getLastChild(e){let t=null;for(let i=e.lastElementChild;i;i=i.lastElementChild)t=i;return t||void 0}function getAdjacentElement(e,t){let i=e,s=null;for(;i&&!s;)s=t?i.previousElementSibling:i.nextElementSibling,i=i.parentElement;return s||void 0}et RootDummyManager=class RootDummyManager extends DummyInputManager{constructor(e,t,i){super(e,t,1),this._onDummyInputFocus=e=>{var t;if(e.shouldMoveOut)this._setFocused(!1,!0);else{this._tabster.keyboardNavigation.setNavigatingWithKeyboard(!0);let i=this._element.get();if(i){this._setFocused(!0,!0);let t=e.isFirst?this._tabster.focusedElement.focusFirst({container:i}):this._tabster.focusedElement.focusLast({container:i});if(t)return}null===(t=e.input)||void 0===t||t.blur()}},this._setHandlers(this._onDummyInputFocus),this._tabster=e,this._setFocused=i}};let Root=class Root extends TabsterPart{constructor(e,t,i,s){super(e,t,s),this._isFocused=!1,this._setFocused=(e,t)=>{if(this._setFocusedTimer&&(this._tabster.getWindow().clearTimeout(this._setFocusedTimer),delete this._setFocusedTimer),this._isFocused===e)return;let i=this._element.get();i&&(e?(this._isFocused=!0,triggerEvent(this._tabster.root.eventTarget,"focus",{element:i,fromAdjacent:t})):this._setFocusedTimer=this._tabster.getWindow().setTimeout(()=>{delete this._setFocusedTimer,this._isFocused=!1,triggerEvent(this._tabster.root.eventTarget,"blur",{element:i,fromAdjacent:t})},0))},this._onFocus=e=>{var t;let i=this._tabster.getWindow();if(this._setTabbableTimer&&(i.clearTimeout(this._setTabbableTimer),delete this._setTabbableTimer),e){let i=RootAPI.getTabsterContext(this._tabster,e);if(i&&this._setFocused(i.root.getElement()===this._element.get()),!i||i.uncontrolled||this._tabster.rootDummyInputs){null===(t=this._dummyManager)||void 0===t||t.setTabbable(!1);return}}else this._setFocused(!1);this._setTabbableTimer=i.setTimeout(()=>{var e;delete this._setTabbableTimer,null===(e=this._dummyManager)||void 0===e||e.setTabbable(!0)},0)},this._onDispose=i;let o=e.getWindow;this.uid=getElementUId(o,t),(e.controlTab||e.rootDummyInputs)&&(this._dummyManager=new RootDummyManager(e,this._element,this._setFocused)),e.focusedElement.subscribe(this._onFocus),this._add()}disposeoveOutWithDefaultActionadd(){}_remove(){}};let RootAPI=class RootAPI{constructor(e,t){this._roots={},this.rootById={},this._init=this._onRootDispose=e=>{delete this._roots[e.id]},this._tabster=e,this._win=e.getWindow,this._initTimer=this._win().setTimeout(this._init,0),this._autoRoot=t,this.eventTarget=/*!
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */function(e){let t=e();return t.EventTarget?new t.EventTarget:t.document.createElement("div")}(this._win)}dispose(){let e=this._win();this._autoRootInstance&&(this._autoRootInstance.dispose(),delete this._autoRootInstance,delete this._autoRoot),this._initTimer&&(e.clearTimeout(this._initTimer),this._initTimer=void 0),Object.keys(this._roots).forEach(e=>{this._roots[e]&&(this._roots[e].dispose(),delete this._roots[e])}),this.rootById={}}createRoot(e,t){let i=new Root(this._tabster,e,this._onRootDispose,t);return this._roots[i.id]=i,i}static getRootByUIdtatic getTabsterContext(e,t,i){var s,o,r;let n,l,a,u,d,h,c;if(void 0===i&&(i={}),!t.ownerDocument)return;let m=i.checkRtl,_=!1,f=t,b={};for(;f&&(!n||m);){let t=getTabsterOnElement(e,f);if(m&&void 0===h){let e=f.dir;e&&(h="rtl"===e.toLowerCase())}if(!t){f=f.parentElement;continue}t.uncontrolled&&(c=f),!u&&(null===(s=t.focusable)||void 0===s?void 0:s.excludeFromMover)&&!a&&(_=!0);let i=t.groupper,r=t.mover;!a&&i&&(a=i),!u&&r&&(u=r,d=!!a),!l&&t.modalizer&&(l=t.modalizer),t.root&&(n=t.root),(null===(o=t.focusable)||void 0===o?void 0:o.ignoreKeydown)&&Object.assign(b,t.focusable.ignoreKeydown),f=f.parentElement}if(!n){let i=e.root,s=i._autoRoot;if(s&&!i._autoRootInstance){let e=null===(r=t.ownerDocument)||void 0===r?void 0:r.body;e&&(i._autoRootInstance=new Root(i._tabster,e,i._onRootDispose,s))}n=i._autoRootInstance}return a&&!u&&(d=!0),n?{root:n,modalizer:l,groupper:a,mover:u,isGroupperFirst:d,isRtl:m?!!h:void 0,uncontrolled:c,isExcludedFromMover:_,ignoreKeydown:b}:void 0}onRoot;let DeloserItemBase=let DeloserItem=class DeloserItem extends DeloserItemBase{constructor(e,t){super(),this.uid=t.uid,this._tabster=e,this._deloser=t}ync focusAvailable(){let e=this._deloser.findAvailable();return!!e&&this._tabster.focusedElement.focus(e)}async resetFocus(){let e=this._tabster.getWindow;return getPromise(e).resolve(this._deloser.resetFocus())}};let DeloserHistoryByRootBase=class DeloserHistoryByRootBase{t DeloserHistoryByRoot=class DeloserHistoryByRoot extends DeloserHistoryByRootBase{unshiftToDeloser(e,t){let i;for(let t=0;t<this._history.length;t++)if(this._history[t].belongsTo(e)){i=this._history[t],this._history.splice(t,1);break}i||(i=new DeloserItem(this._tabster,e)),i.unshift(t),this._history.unshift(i),this._history.splice(10,this._history.length-10)}async focusAvailable(e){let t=!!e;for(let i of this._history)if(e&&i.belongsTo(e)&&(t=!1),!t&&await i.focusAvailable())return!0;return!1}async resetFocus(e){let t=!!e,i={};for(let s of this._history)e&&s.belongsTo(e)&&(t=!1),t||i[s.uid]||(i[s.uid]=s);for(let e of Object.keys(i))if(await i[e].resetFocus())return!0;return!1}};let DeloserHistory=class DeloserHistory{ispose(){this._history=[]}process(e){var t;let i=RootAPI.getTabsterContext(this._tabster,e),s=i&&i.root.uid,o=DeloserAPI.getDeloser(this._tabster,e);if(!s||!o)return;let r=this.make(s,()=>new DeloserHistoryByRoot(this._tabster,s));return(!i||!i.modalizer||(null===(t=i.modalizer)||void 0===t?void 0:t.isActive()))&&r.unshiftToDeloser(o,e),o}make(e,t){let i;for(let t=0;t<this._history.length;t++){let s=this._history[t];if(s.rootUId===e){i=s,this._history.splice(t,1);break}}return i||(i=t()),this._history.unshift(i),this._history.splice(10,this._history.length-10),i}removeDeloser(e){this._history.forEach(,this._history=this._history.filter(}async focusAvailable(e){let t=!!e;for(let i of this._history)if(e&&i.hasDeloser(e)&&(t=!1),!t&&await i.focusAvailable(e))return!0;return!1}async resetFocus(e){let t=!!e;for(let i of this._history)if(e&&i.hasDeloser(e)&&(t=!1),!t&&await i.resetFocus(e))return!0;return!1}};function buildElementSelector(e,t,i){let s;let o=[],r=/(:|\.|\[|\]|,|=|@)/g;e.id&&o.push("#"+e.id.replace(r,"\\$1")),!1!==t&&e.className&&e.className.split(" ").forEach(e=>{(e=e.trim())&&o.push("."+e.replace(r,"\\$1"))});let n=0;if(!1!==i&&0===o.length){for(s=e;s;)n++,s=s.previousElementSibling;o.unshift(":nth-child("+n+")")}return o.unshift(e.tagName.toLowerCase()),o.join("")}let Deloser=class Deloser extends TabsterPart{constructor(e,t,i,s){super(e,t,s),this._isActive=!1,this._history=[[]],this._snapshotIndex=0,this.isActive=this.setSnapshot=e=>{this._snapshotIndex=e,this._history.length>e+1&&this._history.splice(e+1,this._history.length-e-1),this._history[e]||(this._history[e]=[])},this.focusFirst=()=>{let e=this._element.get();return!!e&&this._tabster.focusedElement.focusFirst({container:e})},this.focusDefault=()=>{let e=this._element.get();return!!e&&this._tabster.focusedElement.focusDefault(e)},this.resetFocus=()=>{let e=this._element.get();return!!e&&this._tabster.focusedElement.resetFocus(e)},this.clearHistory=e=>{let t=this._element.get();if(!t){this._history[this._snapshotIndex]=[];return}this._history[this._snapshotIndex]=this._history[this._snapshotIndex].filter(i=>{let s=i.get();return!!s&&!!e&&t.contains(s)})},this.uid=getElementUId(e.getWindow,t),this._onDispose=i}dispose(){this._remove(),this._onDispose(this),this._isActive=!1,this._snapshotIndex=0,this._props={},this._history=[]}shift(e){let t=this._history[this._snapshotIndex];for((t=this._history[this._snapshotIndex]=t.filter(t=>{let i=t.get();return i&&i!==e})).unshift(new WeakHTMLElement(this._tabster.getWindow,e,function(e){if(!documentContains(e.ownerDocument,e))return;let t=[buildElementSelector(e)],i=e.parentElement;for(;i;){let e="BODY"===i.tagName;if(t.unshift(buildElementSelector(i,!1,!e)),e)break;i=i.parentElement}return t.join(" ")}(e)));t.length>10;)t.pop()}findAvailable(){let e=this._element.get();if(!e||!this._tabster.focusable.isVisible(e))return null;let t=this._props.restoreFocusOrder,i=null,s=RootAPI.getTabsterContext(this._tabster,e);if(!s)return null;let o=s.root,r=o.getElement();if(!r)return null;if(void 0===t&&(t=o.getProps().restoreFocusOrder),t===d.RootDefault&&(i=this._tabster.focusable.findDefault({container:r})),i||t!==d.RootFirst||(i=this._findFirst(r)),i)return i;let n=this._findInHistory(),l=this._tabster.focusable.findDefault({container:e}),a=this._findFirst(e);return n&&t===d.History?n:l&&t===d.DeloserDefault?l:a&&t===d.DeloserFirst?a:l||n||a||null}customFocusLostHandler(e){return triggerEvent(e,l,this.getActions())}_findInHistory(){let e=this._history[this._snapshotIndex].slice(0);this.clearHistory(!0);for(let t=0;t<e.length;t++){let i=e[t],s=i.get(),o=this._element.get();if(s&&o&&o.contains(s)){if(this._tabster.focusable.isFocusable(s))return s}else if(!this._props.noSelectorCheck){let e=i.getData();if(e&&o){let t;try{t=o.ownerDocument.querySelectorAll(e)}catch(e){continue}for(let e=0;e<t.length;e++){let i=t[e];if(i&&this._tabster.focusable.isFocusable(i))return i}}}}return null}_findFirst(e){if(this._tabster.keyboardNavigation.isNavigatingWithKeyboard()){let t=this._tabster.focusable.findFirst({container:e});if(t)return t}return null}_remove(){}};let DeloserAPI=class DeloserAPI{constructor(e,t){this._inDeloser=!1,this._isRestoringFocus=!1,this._isPaused=!1,this._init=()=>{this._initTimer=void 0,this._tabster.focusedElement.subscribe(this._onFocus)},this._onFocus=e=>{if(this._restoreFocusTimer&&(this._win().clearTimeout(this._restoreFocusTimer),this._restoreFocusTimer=void 0),!e){this._scheduleRestoreFocus();return}let t=this._history.process(e);t?this._activate(t):this._deactivate()},this._onDeloserDispose=e=>{this._history.removeDeloser(e),e.isActive()&&this._scheduleRestoreFocus()},this._tabster=e,this._win=e.getWindow,this._history=new DeloserHistory(e),this._initTimer=this._win().setTimeout(this._init,0);let i=null==t?void 0:t.autoDeloser;i&&(this._autoDeloser=i)}dispose(){let e=this._win();this._initTimer&&(e.clearTimeout(this._initTimer),this._initTimer=void 0),this._restoreFocusTimer&&(e.clearTimeout(this._restoreFocusTimer),this._restoreFocusTimer=void 0),this._autoDeloserInstance&&(this._autoDeloserInstance.dispose(),delete this._autoDeloserInstance,delete this._autoDeloser),this._tabster.focusedElement.unsubscribe(this._onFocus),this._history.dispose(),delete this._curDeloser}createDeloser(e,t){var i;let s=new Deloser(this._tabster,e,this._onDeloserDispose,t);return e.contains(null!==(i=this._tabster.focusedElement.getFocusedElement())&&void 0!==i?i:null)&&this._activate(s),s}getActions(e){for(let t=e;t;t=t.parentElement){let e=getTabsterOnElement(this._tabster,t);if(e&&e.deloser)return e.deloser.getActions()}}pause(){this._isPaused=!0,this._restoreFocusTimer&&(this._win().clearTimeout(this._restoreFocusTimer),this._restoreFocusTimer=void 0)}resume(e){this._isPaused=!1,e&&this._scheduleRestoreFocus()}_activate(e){let t=this._curDeloser;t!==e&&(this._inDeloser=!0,null==t||t.setActive(!1),e.setActive(!0),this._curDeloser=e)}_deactivate(){var e;this._inDeloser=!1,null===(e=this._curDeloser)||void 0===e||e.setActive(!1),this._curDeloser=void 0}_scheduleRestoreFocus(e){if(this._isPaused||this._isRestoringFocus)return;let restoreFocus=async()=>{this._restoreFocusTimer=void 0;let t=this._tabster.focusedElement.getLastFocusedElement();if(!e&&(this._isRestoringFocus||!this._inDeloser||(null==t?void 0:t.offsetParent)))return;let i=this._curDeloser;if(i){if(t&&i.customFocusLostHandler(t))return;let e=i.findAvailable();if(e&&this._tabster.focusedElement.focus(e))return}this._deactivate(),this._isRestoringFocus=!0,await this._history.focusAvailable(null)||await this._history.resetFocus(null),this._isRestoringFocus=!1};e?restoreFocus():this._restoreFocusTimer=this._win().setTimeout(restoreFocus,100)}static getDeloser(e,t){var i;for(let i=t;i;i=i.parentElement){let t=getTabsterOnElement(e,i);if(t&&t.deloser)return t.deloser}let s=e.deloser&&e.deloser;if(s){if(s._autoDeloserInstance)return s._autoDeloserInstance;let o=s._autoDeloser;if(!s._autoDeloserInstance&&o){let r=null===(i=t.ownerDocument)||void 0===i?void 0:i.body;r&&(s._autoDeloserInstance=new Deloser(e,r,e.deloser._onDeloserDispose,o))}return s._autoDeloserInstance}}tatic forceRestoreFocus;/*!
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */let Subscribable=class Subscribable{isposeubscribe(e){let t=this._callbacks.indexOf(e);t<0&&this._callbacks.push(e)}etValt FocusableAPI=class FocusableAPI{ispose(){}_getBody(){let e=this._tabster.focusedElement.getLastFocusedElement();return e&&e.ownerDocument?e.ownerDocument.body:this._win().document.body}getPropssFocusable(e,t,i,s){return!!matchesSelector(e,"a[href], button:not([disabled]), input:not([disabled]), select:not([disabled]), textarea:not([disabled]), *[tabindex], *[contenteditable]")&&(!!t||-1!==e.tabIndex)&&(i||this.isVisible(e))&&(s||this.isAccessible(e))}isVisible(e){if(!e.ownerDocument||null===e.offsetParent&&e.ownerDocument.body!==e)return!1;let t=e.ownerDocument.defaultView;if(!t)return!1;let i=e.ownerDocument.body.getBoundingClientRect();if(0===i.width&&0===i.height)return!1;let s=t.getComputedStyle(e);return"hidden"!==s.visibility}isAccessible(e){var t;for(let i=e;i;i=i.parentElement){let e=getTabsterOnElement(this._tabster,i);if(this._isHidden(i))return!1;let s=null===(t=null==e?void 0:e.focusable)||void 0===t?void 0:t.ignoreAriaDisabled;if(!s&&this._isDisabled(i))return!1}return!0}isHidden(e){let t=e.getAttribute("aria-hidden");return!!t&&"true"===t.toLowerCase()}findFirst(e){return this.findElement({container:this._getBody(),...e})}findLast(e){return this.findElement({container:this._getBody(),isBackward:!0,...e})}findNext(e){return this.findElement({container:this._getBody(),...e})}findPrev(e){return this.findElement({container:this._getBody(),isBackward:!0,...e})}findDefault(e){return this.findElement({...e,acceptCondition:t=>this._tabster.focusable.isFocusable(t,e.includeProgrammaticallyFocusable)&&!!this.getProps(t).isDefault})||null}findAllindElementfindElements(e,t){let i;let{container:s,currentElement:o=null,includeProgrammaticallyFocusable:r,ignoreUncontrolled:n,ignoreAccessibiliy:l,isBackward:a,onUncontrolled:u,onElement:d}=t,h=[],{acceptCondition:c}=t;if(!s)return null;c||(c=e=>this._tabster.focusable.isFocusable(e,r,l,l));let m={container:s,from:o||s,isBackward:a,acceptCondition:c,includeProgrammaticallyFocusable:r,ignoreUncontrolled:n,ignoreAccessibiliy:l,cachedGrouppers:{}},_=createElementTreeWalker(s.ownerDocument,s,;if(!_)return null;let prepareForNextElement=t=>{let i=m.foundElement;return(i&&h.push(i),e)?(!i||(m.found=!1,delete m.foundElement,delete m.fromCtx,m.from=i,!d||!!d(i)))&&!!(i||t):!!(t&&!i)};if(o)_.currentNode=o;else if(a){let e=getLastChild(s);if(!e)return null;if(this._acceptElement(e,m)===NodeFilter.FILTER_ACCEPT&&!prepareForNextElement(!0))return h;_.currentNode=e}do i=(a?_.previousNode():_.nextNode())||void 0;while(prepareForNextElement());if(!e){let e=m.nextUncontrolled;if(e){if(u&&u(e),i)return;return null}}return h.length?h:null}_acceptElement(e,t){let i;if(t.found)return NodeFilter.FILTER_ACCEPT;let s=t.container;if(e===s)return NodeFilter.FILTER_SKIP;if(!s.contains(e)||e.__tabsterDummyContainer)return NodeFilter.FILTER_REJECT;let o=t.lastToIgnore;if(o){if(o.contains(e))return NodeFilter.FILTER_REJECT;o=t.lastToIgnore=void 0}let r=t.currentCtx=RootAPI.getTabsterContext(this._tabster,e);if(!r)return NodeFilter.FILTER_SKIP;if(t.ignoreUncontrolled){if(shouldIgnoreFocus(e))return NodeFilter.FILTER_SKIP}else if(r.uncontrolled&&!t.nextUncontrolled&&this._tabster.focusable.isFocusable(e,void 0,!0,!0)&&!r.groupper&&!r.mover)return t.nextUncontrolled=r.uncontrolled,NodeFilter.FILTER_REJECT;if("IFRAME"===e.tagName||"WEBVIEW"===e.tagName)return t.found=!0,t.lastToIgnore=t.foundElement=e,NodeFilter.FILTER_ACCEPT;if(!t.ignoreAccessibiliy&&!this.isAccessible(e))return NodeFilter.FILTER_REJECT;let n=t.fromCtx;n||(n=t.fromCtx=RootAPI.getTabsterContext(this._tabster,t.from));let l=null==n?void 0:n.mover,a=r.groupper,u=r.mover;if(a||u||l){let o=null==a?void 0:a.getElement(),r=null==l?void 0:l.getElement(),n=null==u?void 0:u.getElement();n&&r&&s.contains(r)&&(!o||!u||r.contains(o))&&(u=l,n=r),o&&(o===s||!s.contains(o))&&(a=void 0),n&&!s.contains(n)&&(u=void 0),a&&u&&(n&&o&&!o.contains(n)?u=void 0:a=void 0),a&&(i=a.acceptElement(e,t)),u&&(i=u.acceptElement(e,t))}return void 0===i&&(i=t.acceptCondition(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP),i!==NodeFilter.FILTER_ACCEPT||t.found||(t.found=!0,t.foundElement=e),i}};/*!
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */let v={Tab:9,PageUp:33,PageDown:34,End:35,Home:36,Left:37,Up:38,Right:39,Down:40};/*!
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */let FocusedElementState=class FocusedElementState extends Subscribable{constructor(e,t){super(),this._init=()=>{this._initTimer=void 0;let e=this._win();e.document.addEventListener(o.PW,this._onFocusIn,!0),e.document.addEventListener("focusout",this._onFocusOut,!0),e.addEventListener("keydown",this._onKeyDown,!0)},this._onFocusIn=e=>{this._setFocusedElement(e.target,e.details.relatedTarget,e.details.isFocusedProgrammatically)},this._onFocusOut=e=>{this._setFocusedElement(void 0,e.relatedTarget)},this._validateFocusedElement=this._onKeyDown=e=>{var t,i,s,r;let n;if(e.keyCode!==v.Tab||e.ctrlKey)return;let l=this.getVal();if(!l||!l.ownerDocument||"true"===l.contentEditable)return;let a=this._tabster,u=a.controlTab,d=RootAPI.getTabsterContext(a,l);if(!d||!u&&!d.groupper&&!d.mover||d.ignoreKeydown[e.key])return;let h=e.shiftKey,c=FocusedElementState.findNextTabbable(a,d,void 0,l,h);if((!c||!u&&!c.element)&&!u){let e=null==c?void 0:c.lastMoverOrGroupper;if(e){null===(t=e.dummyManager)||void 0===t||t.moveOutWithDefaultAction(h);return}}if(c){let t=c.uncontrolled;if(t){let e=d.isGroupperFirst,o=!1;if(void 0!==e){let r;let n=null===(i=d.groupper)||void 0===i?void 0:i.getElement(),l=null===(s=d.mover)||void 0===s?void 0:s.getElement();e&&n&&t.contains(n)?r=n:!e&&l&&t.contains(l)&&(r=l),r&&(t=r,o=!0)}t&&d.uncontrolled!==t&&DummyInputManager.moveWithPhantomDummy(this._tabster,t,o,h);return}if(n=c.element,d.modalizer){let t=n&&RootAPI.getTabsterContext(a,n);if((!t||d.root.uid!==t.root.uid||!(null===(r=t.modalizer)||void 0===r?void 0:r.isActive()))&&d.modalizer.onBeforeFocusOut()){e.preventDefault();return}if(!n&&d.modalizer.isActive()&&d.modalizer.getProps().isTrapped){let e=h?"findLast":"findFirst";n=a.focusable[e]({container:d.modalizer.getElement()})}}}n?"IFRAME"!==n.tagName&&(e.preventDefault(),e.stopImmediatePropagation(),(0,o.ev)(n)):d.root.moveOutWithDefaultAction(h)},this._tabster=e,this._win=t,this._initTimer=t().setTimeout(this._init,0)}dispose(){super.dispose();let e=this._win();this._initTimer&&(e.clearTimeout(this._initTimer),this._initTimer=void 0),e.document.removeEventListener(o.PW,this._onFocusIn,!0),e.document.removeEventListener("focusout",this._onFocusOut,!0),e.removeEventListener("keydown",this._onKeyDown,!0),delete FocusedElementState._lastResetElement,delete this._nextVal,delete this._lastVal}static forgetMemorized(e,t){var i,s;let o=FocusedElementState._lastResetElement,r=o&&o.get();r&&t.contains(r)&&delete FocusedElementState._lastResetElement,(r=null===(s=null===(i=e._nextVal)||void 0===i?void 0:i.element)||void 0===s?void 0:s.get())&&t.contains(r)&&delete e._nextVal,(r=(o=e._lastVal)&&o.get())&&t.contains(r)&&delete e._lastVal}etLastFocusedElement(){var e;let t=null===(e=this._lastVal)||void 0===e?void 0:e.get();return t&&(!t||documentContains(t.ownerDocument,t))||(this._lastVal=t=void 0),t}focusocusDefaultfocusFirstOrLast(e,t){let i,s;let o=this._tabster.focusable,r=t.container;if(r){let t=RootAPI.getTabsterContext(this._tabster,r);if(t){let n=FocusedElementState.findNextTabbable(this._tabster,t,r,void 0,!e);if(n)for(s=n.element,i=n.uncontrolled;!s&&i;)!(s=o.isFocusable(i,!1,!0,!0)?i:o[e?"findFirst":"findLast"]({container:i,ignoreUncontrolled:!0,ignoreAccessibiliy:!0}))&&(n=FocusedElementState.findNextTabbable(this._tabster,t,i,void 0,!e))&&(s=n.element,i=n.uncontrolled)}}return!s||(null==r?void 0:r.contains(s))||(s=void 0),!!s&&(this.focus(s,!1,!0),!0)}focusFirst(e){return this._focusFirstOrLast(!0,e)}esetFocussetOrRemoveAttributesetFocusedElement(e,t,i){var s;if(this._tabster._noop)return;let o={relatedTarget:t};if(e){let t=null===(s=FocusedElementState._lastResetElement)||void 0===s?void 0:s.get();if(FocusedElementState._lastResetElement=void 0,t===e||shouldIgnoreFocus(e))return;o.isFocusedProgrammatically=i}let r=this._nextVal={element:e?new WeakHTMLElement(this._win,e):void 0,details:o};e&&e!==this._val&&this._validateFocusedElement(e),this._nextVal===r&&this.setVal(e,o),this._nextVal=void 0}setVal(e,t){super.setVal(e,t),e&&(this._lastVal=new WeakHTMLElement(this._win,e))}static findNextTabbable(e,t,i,s,o){var r;let n=i||t.root.getElement();if(!n)return null;let l=null,a=FocusedElementState._isTabbingTimer,u=e.getWindow();a&&u.clearTimeout(a),FocusedElementState.isTabbing=!0,FocusedElementState._isTabbingTimer=u.setTimeout(()=>{delete FocusedElementState._isTabbingTimer,FocusedElementState.isTabbing=!1},0);let callFindNext=if(t.groupper&&t.mover){let i=t.isGroupperFirst;if(i&&s){let o=RootAPI.getTabsterContext(e,s);(null==o?void 0:o.groupper)!==t.groupper&&(i=!1)}callFindNext(i?t.groupper:t.mover)}else if(t.groupper)callFindNext(t.groupper);else if(t.mover)callFindNext(t.mover);else{let t;let onUncontrolled=e=>{t=e},i=o?e.focusable.findPrev({container:n,currentElement:s,onUncontrolled}):e.focusable.findNext({container:n,currentElement:s,onUncontrolled});l={element:t?void 0:i,uncontrolled:t}}let d=null===(r=null==l?void 0:l.lastMoverOrGroupper)||void 0===r?void 0:r.getElement();if(d){l=null;let t=getAdjacentElement(d,o);if(t){let i=RootAPI.getTabsterContext(e,t,{checkRtl:!0});if(i){let s=getAdjacentElement(t,!o);s&&(o||(s=getLastChild(s)),l=FocusedElementState.findNextTabbable(e,i,n,s,o))}}}return l}};FocusedElementState.isTabbing=!1;/*!
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */let KeyboardNavigationState=class KeyboardNavigationState extends Subscribable{constructor(e){super(),this._onChange=e=>{this.setVal(e,void 0)},this._keyborg=(0,o.Vm)(e()),this._keyborg.subscribe(this._onChange)}dispose(){super.dispose(),this._keyborg&&(this._keyborg.unsubscribe(this._onChange),(0,o.ub)(this._keyborg),delete this._keyborg)}/*!
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */let g=0;let Modalizer=class Modalizer extends TabsterPart{constructor(e,t,i,s,r,n){super(e,t,n),this._isFocused=!1,this._onKeyDown=e=>{let t;let i=e.keyCode,s=e.shiftKey;if(i!==v.Tab)return;let r=this._tabster.focusedElement.getFocusedElement(),n=this.getElement(),l=s?"findPrev":"findNext";r&&(null==n?void 0:n.contains(r))&&(t=this._tabster.focusable[l]({container:this.getElement(),currentElement:r})),!t&&this._props.isTrapped&&(l=s?"findLast":"findFirst",t=this._tabster.focusable[l]({container:this.getElement()})),t?(e.preventDefault(),e.stopImmediatePropagation(),(0,o.ev)(t)):this._props.isOthersAccessible||this._moveOutWithDefault(s)},this.internalId="ml"+ ++g,this.userId=n.id,this._onDispose=i,this._moveOutWithDefault=s,this._onActiveChange=r,e.controlTab||t.addEventListener("keydown",this._onKeyDown);let l=t.parentElement;l?this._modalizerParent=new WeakHTMLElement(e.getWindow,l):this._modalizerParent=null,this._setAccessibilityProps()}setProps(e){e.id&&(this.userId=e.id),this._props={...e},this._setAccessibilityProps()}disposeetActive(e){var t,i,s;if(e===this._isActive)return;this._isActive=e,this._onActiveChange(e);let o=(null===(t=this._element.get())||void 0===t?void 0:t.ownerDocument)||(null===(s=null===(i=this._modalizerParent)||void 0===i?void 0:i.get())||void 0===s?void 0:s.ownerDocument);o||(o=this._tabster.getWindow().document);let r=o.body,n=createElementTreeWalker(o,r,t=>{var i;if(this._props.isOthersAccessible)return NodeFilter.FILTER_REJECT;let s=this._element.get(),o=null===(i=this._modalizerParent)||void 0===i?void 0:i.get(),r=s===t,n=!!t.contains(s||null),l=!!t.contains(o||null);if(r)return NodeFilter.FILTER_REJECT;if(n||l)return NodeFilter.FILTER_SKIP;!function(e,t,i,s){let o=e.storageEntry(t,!0);if(!o.aug){if(void 0===s)return;o.aug={}}if(void 0===s){if(i in o.aug){let e=o.aug[i];delete o.aug[i],null===e?t.removeAttribute(i):t.setAttribute(i,e)}}else i in o.aug||(o.aug[i]=t.getAttribute(i)),null===s?t.removeAttribute(i):t.setAttribute(i,s);void 0===s&&0===Object.keys(o.aug).length&&(delete o.aug,e.storageEntry(t,!1))}(this._tabster,t,"aria-hidden",e?"true":void 0);let a=s!==(null==s?void 0:s.ownerDocument.body)&&(null==s?void 0:s.ownerDocument.body.contains(s)),u=o!==(null==o?void 0:o.ownerDocument.body)&&(null==o?void 0:o.ownerDocument.body.contains(o));return u||a?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_SKIP});if(n)for(;n.nextNode(););}ontainsnBeforeFocusOut(){let e=this.getElement();return!!e&&!triggerEvent(e,a,{eventName:"beforefocusout"})}_remove(){}_setAccessibilityProps(){}};let ModalizerAPIDummyManager=class ModalizerAPIDummyManager extends DummyInputManager{constructor(e,t,i){super(t,i,2),this._onFocusDummyInput=e=>{let t=this._modalizerAPI.activeModalizer;if(!t||e.shouldMoveOut)return;let i=e.isFirst?"findFirst":"findLast",s=this._tabster.focusable[i]({container:t.getElement()});s&&this._tabster.focusedElement.focus(s)},this._modalizerAPI=e,this._tabster=t,this.setTabbable(!1),this._setHandlers(this._onFocusDummyInput)}};let ModalizerAPI=class ModalizerAPI{constructor(e){if(this._init=()=>{this._initTimer=void 0,this._tabster.focusedElement.subscribe(this._onFocus)},this._onModalizerDispose=e=>{e.setActive(!1),this.activeModalizer===e&&(this.activeModalizer=void 0),delete this._modalizers[e.userId]},this._onFocus=(e,t)=>{var i,s,o;let r=e&&RootAPI.getTabsterContext(this._tabster,e);if(!r||!e)return;this._focusOutTimer&&(this._win().clearTimeout(this._focusOutTimer),this._focusOutTimer=void 0);let n=null==r?void 0:r.modalizer;if(n!==this.activeModalizer){if(!t.isFocusedProgrammatically||(null===(i=this.activeModalizer)||void 0===i?void 0:i.contains(e))){if(!(null===(o=this.activeModalizer)||void 0===o?void 0:o.getProps().isOthersAccessible)){let t=this._win();t.clearTimeout(this._restoreModalizerFocusTimer),this._restoreModalizerFocusTimer=t.setTimeout(100)}}else null===(s=this.activeModalizer)||void 0===s||s.setActive(!1),this.activeModalizer=void 0,n&&(this.activeModalizer=n,this.activeModalizer.setActive(!0))}},this._tabster=e,this._win=e.getWindow,this._initTimer=this._win().setTimeout(this._init,0),this._modalizers={},!e.controlTab){let t=this._win().document.body;this._dummyManager=new ModalizerAPIDummyManager(this,e,new WeakHTMLElement(this._win,t))}}dispose(){var e;let t=this._win();null===(e=this._dummyManager)||void 0===e||e.dispose(),this._initTimer&&(t.clearTimeout(this._initTimer),this._initTimer=void 0),t.clearTimeout(this._restoreModalizerFocusTimer),t.clearTimeout(this._focusOutTimer),Object.keys(this._modalizers).forEach(e=>{this._modalizers[e]&&(this._modalizers[e].dispose(),delete this._modalizers[e])}),this._tabster.focusedElement.unsubscribe(this._onFocus),delete this.activeModalizer}createModalizer(e,t){var i,s,o,r,n;let l=new Modalizer(this._tabster,e,this._onModalizerDispose,null!==(s=null===(i=this._dummyManager)||void 0===i?void 0:i.moveOutWithDefaultAction)&&void 0!==s?s:()=>null,null!==(r=null===(o=this._dummyManager)||void 0===o?void 0:o.setTabbable)&&void 0!==r?r:t);if(this._modalizers[t.id]=l,e.contains(null!==(n=this._tabster.focusedElement.getFocusedElement())&&void 0!==n?n:null)){let e=this.activeModalizer;e&&e.setActive(!1),this.activeModalizer=l,this.activeModalizer.setActive(!0)}return l}focus(e,t,i){let s=RootAPI.getTabsterContext(this._tabster,e);if(s&&s.modalizer){this.activeModalizer=s.modalizer,this.activeModalizer.setActive(!0);let e=this.activeModalizer.getProps(),o=this.activeModalizer.getElement();if(o){if(void 0===t&&(t=e.isNoFocusFirst),!t&&this._tabster.keyboardNavigation.isNavigatingWithKeyboard()&&this._tabster.focusedElement.focusFirst({container:o})||(void 0===i&&(i=e.isNoFocusDefault),!i&&this._tabster.focusedElement.focusDefault(o)))return!0;this._tabster.focusedElement.resetFocus(o)}}return!1}updateModalizer(e,t){t&&(e.isActive()&&e.setActive(!1),delete this._modalizers[e.userId],this.activeModalizer===e&&(this.activeModalizer=void 0))}_restoreModalizerFocus(e){if(!(null==e?void 0:e.ownerDocument)||!this.activeModalizer)return;let t=this._tabster.focusable.findFirst({container:this.activeModalizer.getElement()});if(t){if(e.compareDocumentPosition(t)&document.DOCUMENT_POSITION_PRECEDING&&!(t=this._tabster.focusable.findLast({container:e.ownerDocument.body})))throw Error("Something went wrong.");this._tabster.focusedElement.focus(t)}else e.blur()}};let MoverDummyManager=class MoverDummyManager extends DummyInputManager{constructor(e,t,i){super(t,e,3),this._onFocusDummyInput=e=>{var t,i;let s=this._element.get(),r=e.input;if(s&&!e.shouldMoveOut&&r){let n;let l=RootAPI.getTabsterContext(this._tabster,s);l&&(n=null===(t=FocusedElementState.findNextTabbable(this._tabster,l,void 0,r,!e.isFirst))||void 0===t?void 0:t.element);let a=null===(i=this._getMemorized())||void 0===i?void 0:i.get();a&&(n=a),n&&(0,o.ev)(n)}},this._tabster=t,this._getMemorized=i,this._setHandlers(this._onFocusDummyInput)}};let Mover=class Mover extends TabsterPart{constructor(e,t,i,s){super(e,t,s),this._visible={},this._onIntersection=e=>{for(let t of e){let e;let i=t.target,s=getElementUId(this._win,i),o=this._fullyVisible;if(t.intersectionRatio>=.25&&(e=t.intersectionRatio>=.75?h.Visible:h.PartiallyVisible)===h.Visible&&(o=s),this._visible[s]!==e){void 0===e?(delete this._visible[s],o===s&&delete this._fullyVisible):(this._visible[s]=e,this._fullyVisible=o);let t=this.getState(i);t&&triggerEvent(i,u,t)}}},this._win=e.getWindow,(this._props.trackState||this._props.visibilityAware)&&(this._intersectionObserver=new IntersectionObserver(this._onIntersection,{threshold:[0,.25,.5,.75,1]}),this._observeState()),this._onDispose=i,e.controlTab||(this.dummyManager=new MoverDummyManager(this._element,e,()=>s.memorizeCurrent?this._current:void 0))}dispose(){var e;this._onDispose(this),this._intersectionObserver&&(this._intersectionObserver.disconnect(),delete this._intersectionObserver),delete this._current,delete this._fullyVisible,delete this._allElements,delete this._updateQueue,this._unobserve&&(this._unobserve(),delete this._unobserve);let t=this._win();this._setCurrentTimer&&(t.clearTimeout(this._setCurrentTimer),delete this._setCurrentTimer),this._updateTimer&&(t.clearTimeout(this._updateTimer),delete this._updateTimer),null===(e=this.dummyManager)||void 0===e||e.dispose()}setCurrent(e){e?this._current=new WeakHTMLElement(this._win,e):this._current=void 0,(this._props.trackState||this._props.visibilityAware)&&!this._setCurrentTimer&&(this._setCurrentTimer=this._win().setTimeout(()=>{var e;delete this._setCurrentTimer;let t=[];for(let i of(this._current!==this._prevCurrent&&(t.push(this._current),t.push(this._prevCurrent),this._prevCurrent=this._current),t)){let t=null==i?void 0:i.get();if(t&&(null===(e=this._allElements)||void 0===e?void 0:e.get(t))===this){let e=this._props;if(t&&(void 0!==e.visibilityAware||e.trackState)){let e=this.getState(t);e&&triggerEvent(t,u,e)}}}}))}indNextTabbable(e,t){var i;let s;let o=this.getElement(),r=o&&(null===(i=null==e?void 0:e.__tabsterDummyContainer)||void 0===i?void 0:i.get())===o;if(!o)return null;let n=this._tabster,l=n.focusable,a=null,onUncontrolled=return(this._props.tabbable||r||e&&!o.contains(e))&&(a=t?l.findPrev({currentElement:e,container:o,onUncontrolled}):l.findNext({currentElement:e,container:o,onUncontrolled})),{element:a,uncontrolled:s,lastMoverOrGroupper:a||s?void 0:this}}acceptElement(e,t){var i,s,o;if(!FocusedElementState.isTabbing)return(null===(i=t.currentCtx)||void 0===i?void 0:i.isExcludedFromMover)?NodeFilter.FILTER_REJECT:void 0;let{memorizeCurrent:r,visibilityAware:n}=this._props,l=this.getElement();if(l&&(r||n)&&(!l.contains(t.from)||(null===(s=t.from.__tabsterDummyContainer)||void 0===s?void 0:s.get())===l)){if(r){let e=null===(o=this._current)||void 0===o?void 0:o.get();if(e&&t.acceptCondition(e))return t.found=!0,t.foundElement=e,t.lastToIgnore=l,NodeFilter.FILTER_ACCEPT}if(n){let e=this._tabster.focusable.findElement({container:l,ignoreUncontrolled:!0,isBackward:t.isBackward,acceptCondition:e=>{var i;let s=getElementUId(this._win,e),o=this._visible[s];return l!==e&&!!(null===(i=this._allElements)||void 0===i?void 0:i.get(e))&&t.acceptCondition(e)&&(o===h.Visible||o===h.PartiallyVisible&&(n===h.PartiallyVisible||!this._fullyVisible))}});if(e)return t.found=!0,t.foundElement=e,t.lastToIgnore=l,NodeFilter.FILTER_ACCEPT}}}_observeState(){let e=this.getElement();if(this._unobserve||!e||"undefined"==typeof MutationObserver)return;let t=this._win(),i=this._allElements=new WeakMap,s=this._tabster.focusable,o=this._updateQueue=[],r=new MutationObserver(e=>{for(let t of e){let e=t.target,i=t.removedNodes,s=t.addedNodes;if("attributes"===t.type)"tabindex"===t.attributeName&&o.push({element:e,type:2});else{for(let e=0;e<i.length;e++)o.push({element:i[e],type:3});for(let e=0;e<s.length;e++)o.push({element:s[e],type:1})}}requestUpdate()}),setElement=(e,t)=>{var s,o;let r=i.get(e);r&&t&&(null===(s=this._intersectionObserver)||void 0===s||s.unobserve(e),i.delete(e)),r||t||(i.set(e,this),null===(o=this._intersectionObserver)||void 0===o||o.observe(e))},updateElement=e=>{let t=s.isFocusable(e),o=i.get(e);o?t||setElement(e,!0):t&&setElement(e)},addNewElements=e=>{let{mover:i}=getMoverGroupper(e);if(i&&i!==this){if(!(i.getElement()===e&&s.isFocusable(e)))return;setElement(e)}let o=createElementTreeWalker(t.document,e,e=>{let{mover:t,groupper:i}=getMoverGroupper(e);if(t&&t!==this)return NodeFilter.FILTER_REJECT;let o=null==i?void 0:i.getFirst(!0);return i&&i.getElement()!==e&&o&&o!==e?NodeFilter.FILTER_REJECT:(s.isFocusable(e)&&setElement(e),NodeFilter.FILTER_SKIP)});if(o)for(o.currentNode=e;o.nextNode(););},removeWalk=e=>{let t=i.get(e);t&&setElement(e,!0);for(let t=e.firstElementChild;t;t=t.nextElementSibling)removeWalk(t)},requestUpdate=()=>{!this._updateTimer&&o.length&&(this._updateTimer=t.setTimeout(()=>{for(let{element:e,type:t}of(delete this._updateTimer,o))switch(t){case 2:updateElement(e);break;case 1:addNewElements(e);break;case 3:removeWalk(e)}o=this._updateQueue=[]},0))},getMoverGroupper=e=>{let t={};for(let i=e;i;i=i.parentElement){let e=getTabsterOnElement(this._tabster,i);if(e&&(e.groupper&&!t.groupper&&(t.groupper=e.groupper),e.mover)){t.mover=e.mover;break}}return t};o.push({element:e,type:1}),requestUpdate(),r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["tabindex"]}),this._unobserve=()=>{r.disconnect()}}getState(e){let t=getElementUId(this._win,e);if(t in this._visible){let i=this._visible[t]||h.Invisible,s=this._current?this._current.get()===e:void 0;return{isCurrent:s,visibility:i}}}};let MoverAPI=class MoverAPI{constructor(e,t){this._init=()=>{this._initTimer=void 0;let e=this._win();e.addEventListener("keydown",this._onKeyDown,!0)},this._onMoverDispose=e=>{delete this._movers[e.id]},this._onFocus=e=>{var t;for(let i=e;i;i=i.parentElement){let s=null===(t=getTabsterOnElement(this._tabster,i))||void 0===t?void 0:t.mover;if(s){s.setCurrent(e);break}}},this._onKeyDown=async e=>{var t;let i,s;this._ignoredInputTimer&&(this._win().clearTimeout(this._ignoredInputTimer),delete this._ignoredInputTimer),null===(t=this._ignoredInputResolve)||void 0===t||t.call(this,!1);let r=e.keyCode;switch(r){case v.Down:case v.Right:case v.Up:case v.Left:case v.PageDown:case v.PageUp:case v.Home:case v.End:break;default:return}let n=this._tabster,l=n.focusedElement.getFocusedElement();if(!l||await this._isIgnoredInput(l,r))return;let a=RootAPI.getTabsterContext(n,l,{checkRtl:!0});if(!a||!a.mover||a.isExcludedFromMover||a.isGroupperFirst&&a.groupper&&a.groupper.isActive(!0))return;let u=a.mover,d=u.getElement();if(!d)return;let h=n.focusable,m=u.getProps(),_=m.direction||c.Both,f=_===c.Both,b=f||_===c.Vertical,g=f||_===c.Horizontal,p=_===c.Grid,E=m.cyclic,T=0,y=0;if(p&&(T=Math.ceil((s=l.getBoundingClientRect()).left),y=Math.floor(s.right)),!m.disableHomeEndKeys||r!==v.Home&&r!==v.End){if(a.isRtl&&(r===v.Right?r=v.Left:r===v.Left&&(r=v.Right)),r===v.Down&&b||r===v.Right&&(g||p)){if((i=h.findNext({currentElement:l,container:d}))&&p){let e=Math.ceil(i.getBoundingClientRect().left);y>e&&(i=void 0)}else!i&&E&&(i=h.findFirst({container:d}))}else if(r===v.Up&&b||r===v.Left&&(g||p)){if((i=h.findPrev({currentElement:l,container:d}))&&p){let e=Math.floor(i.getBoundingClientRect().right);e>T&&(i=void 0)}else!i&&E&&(i=h.findLast({container:d}))}else if(r===v.Home)i=h.findFirst({container:d});else if(r===v.End)i=h.findLast({container:d});else if(r===v.PageUp){let e=h.findPrev({currentElement:l,container:d}),t=null;for(;e;)t=e,e=isElementVerticallyVisibleInContainer(this._win,e)?h.findPrev({currentElement:e,container:d}):null;(i=t)&&scrollIntoView(this._win,i,!1)}else if(r===v.PageDown){let e=h.findNext({currentElement:l,container:d}),t=null;for(;e;)t=e,e=isElementVerticallyVisibleInContainer(this._win,e)?h.findNext({currentElement:e,container:d}):null;(i=t)&&scrollIntoView(this._win,i,!0)}else if(p){let e,t;let o=r===v.Up,n=T,a=Math.ceil(s.top),u=y,c=Math.floor(s.bottom),m=0;h.findAll({container:d,currentElement:l,isBackward:o,onElement:i=>{let s=i.getBoundingClientRect(),r=Math.ceil(s.left),l=Math.ceil(s.top),d=Math.floor(s.right),h=Math.floor(s.bottom);if(o&&a<h||!o&&c>l)return!0;let _=Math.ceil(Math.min(u,d))-Math.floor(Math.max(n,r)),f=Math.ceil(Math.min(u-n,d-r));if(_>0&&f>=_){let t=_/f;t>m&&(e=i,m=t)}else if(0===m){let s=function(e,t,i,s,o,r,n,l){let a=i<o?o-i:n<e?e-n:0,u=s<r?r-s:l<t?t-l:0;return 0===a?u:0===u?a:Math.sqrt(a*a+u*u)}(n,a,u,c,r,l,d,h);(void 0===t||s<t)&&(t=s,e=i)}else if(m>0)return!1;return!0}}),i=e}i&&(e.preventDefault(),e.stopImmediatePropagation(),(0,o.ev)(i))}},this._tabster=e,this._win=t,this._initTimer=t().setTimeout(this._init,0),this._movers={},e.focusedElement.subscribe(this._onFocus)}dispose(){var e;let t=this._win();this._tabster.focusedElement.unsubscribe(this._onFocus),this._initTimer&&(t.clearTimeout(this._initTimer),delete this._initTimer),null===(e=this._ignoredInputResolve)||void 0===e||e.call(this,!1),this._ignoredInputTimer&&(t.clearTimeout(this._ignoredInputTimer),delete this._ignoredInputTimer),t.removeEventListener("keydown",this._onKeyDown,!0),Object.keys(this._movers).forEach(e=>{this._movers[e]&&(this._movers[e].dispose(),delete this._movers[e])})}createMover(e,t){let i=new Mover(this._tabster,e,this._onMoverDispose,t);return this._movers[i.id]=i,i}async _isIgnoredInput(e,t){var i;if("true"===e.getAttribute("aria-expanded"))return!0;if(matchesSelector(e,"input, textarea, *[contenteditable]")){let s,o=0,r=0,n=0;if("INPUT"===e.tagName||"TEXTAREA"===e.tagName){let s=e.type,l=e.value;if(n=(l||"").length,"email"===s||"number"===s){if(n){let s=null===(i=e.ownerDocument.defaultView)||void 0===i?void 0:i.getSelection();if(s){let e=s.toString().length,i=t===v.Left||t===v.Up;if(s.modify("extend",i?"backward":"forward","character"),e!==s.toString().length)return s.modify("extend",i?"forward":"backward","character"),!0;n=0}}}else{let t=e.selectionStart;if(null===t)return"hidden"===s;o=t||0,r=e.selectionEnd||0}}else"true"===e.contentEditable&&(s=new(getPromise(this._win))(t=>{this._ignoredInputResolve=e=>{delete this._ignoredInputResolve,t(e)};let i=this._win();this._ignoredInputTimer&&i.clearTimeout(this._ignoredInputTimer);let{anchorNode:s,focusNode:l,anchorOffset:a,focusOffset:u}=i.getSelection()||{};this._ignoredInputTimer=i.setTimeout(()=>{var t,d,h;delete this._ignoredInputTimer;let{anchorNode:c,focusNode:m,anchorOffset:_,focusOffset:f}=i.getSelection()||{};if(c!==s||m!==l||_!==a||f!==u){null===(t=this._ignoredInputResolve)||void 0===t||t.call(this,!1);return}if(o=_||0,r=f||0,n=(null===(d=e.textContent)||void 0===d?void 0:d.length)||0,c&&m&&e.contains(c)&&e.contains(m)&&c!==e){let t=!1,addOffsets=e=>{if(e===c)t=!0;else if(e===m)return!0;let i=e.textContent;if(i&&!e.firstChild){let e=i.length;t?m!==c&&(r+=e):(o+=e,r+=e)}let s=!1;for(let t=e.firstChild;t&&!s;t=t.nextSibling)s=addOffsets(t);return s};addOffsets(e)}null===(h=this._ignoredInputResolve)||void 0===h||h.call(this,!0)},0)}));if(s&&!await s||o!==r||o>0&&(t===v.Left||t===v.Up||t===v.Home)||o<n&&(t===v.Right||t===v.Down||t===v.End))return!0}return!1}};/*!
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */let UncontrolledAPI=/*!
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */let Tabster=class Tabster{constructor(e){this.keyboardNavigation=e.keyboardNavigation,this.focusedElement=e.focusedElement,this.focusable=e.focusable,this.root=e.root,this.uncontrolled=e.uncontrolled,this.core=e}};let TabsterCore=class TabsterCore{constructor(e,t){var i;this._forgetMemorizedElements=[],this._wrappers=new Set,this._version="3.0.8",this._noop=!1,this.getWindow=()=>{if(!this._win)throw Error("Using disposed Tabster.");return this._win},this._storage=function(e){let t=e.__tabsterInstanceContext;return new((null==t?void 0:t.basics.WeakMap)||WeakMap)}(e),this._win=e;let s=this.getWindow;this.keyboardNavigation=new KeyboardNavigationState(s),this.focusedElement=new FocusedElementState(this,s),this.focusable=new FocusableAPI(this,s),this.root=new RootAPI(this,null==t?void 0:t.autoRoot),this.uncontrolled=new UncontrolledAPI,this.controlTab=null===(i=null==t?void 0:t.controlTab)||void 0===i||i,this.rootDummyInputs=!!(null==t?void 0:t.rootDummyInputs),this.internal={stopObserver:()=>{this._unobserve&&(this._unobserve(),delete this._unobserve)},resumeObserver:e=>{if(!this._unobserve){let t=s().document;this._unobserve=/*!
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */function(e,t,i,s){let o;if("undefined"==typeof MutationObserver)returnlet n=t.getWindow;function updateTabsterElements(t,i){o||(o=getInstanceContext(n).elementByUId),processNode(t,i);let s=createElementTreeWalker(e,t,;if(s)for(;s.nextNode(););}et l=new MutationObserver(e=>{for(let s of e){let e=s.target,o=s.removedNodes,n=s.addedNodes;if("attributes"===s.type)s.attributeName===r&&i(t,e);else{for(let e=0;e<o.length;e++)updateTabsterElements(o[e],!0);for(let e=0;e<n.length;e++)updateTabsterElements(n[e])}}});return s&&updateTabsterElements(n().document.body),l.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:[r]}),(t,this,updateTabsterByAttribute,e)}}},this.internal.resumeObserver(!1),function startFakeWeakRefsCleanup(e){let t=getInstanceContext(e);t.fakeWeakRefsStarted||(t.fakeWeakRefsStarted=!0,t.WeakRef=t.basics.WeakRef),t.fakeWeakRefsTimer||(t.fakeWeakRefsTimer=e().setTimeout(()=>{t.fakeWeakRefsTimer=void 0,cleanupFakeWeakRefs(e),startFakeWeakRefsCleanup(e)},12e4))}(s)}createTabsterisposeTabsterispose(){var e,t,i,s,o,r,n;this.internal.stopObserver();let l=this._win;this._forgetMemorizedElements=[],l&&this._forgetMemorizedTimer&&(l.clearTimeout(this._forgetMemorizedTimer),delete this._forgetMemorizedTimer),null===(e=this.outline)||void 0===e||e.dispose(),null===(t=this.crossOrigin)||void 0===t||t.dispose(),null===(i=this.deloser)||void 0===i||i.dispose(),null===(s=this.groupper)||void 0===s||s.dispose(),null===(o=this.mover)||void 0===o||o.dispose(),null===(r=this.modalizer)||void 0===r||r.dispose(),null===(n=this.observedElement)||void 0===n||n.dispose(),this.keyboardNavigation.dispose(),this.focusable.dispose(),this.focusedElement.dispose(),this.root.dispose(),this.getWindow),clearElementCache(this.getWindow),this._storage=new WeakMap,this._wrappers.clear(),l&&(l),delete l.__tabsterInstance,delete this._win)}storageEntryorceCleanup(){this._win&&(this._forgetMemorizedElements.push(this._win.document.body),this._forgetMemorizedTimer||(this._forgetMemorizedTimer=this._win.setTimeout(()=>{delete this._forgetMemorizedTimer;for(let e=this._forgetMemorizedElements.shift();e;e=this._forgetMemorizedElements.shift())clearElementCache(this.getWindow,e),FocusedElementState.forgetMemorized(this.focusedElement,e)},0),cleanupFakeWeakRefs(this.getWindow,!0)))}};function createTabster(e,t){let i=e.__tabsterInstance;return i||(i=new TabsterCore(e,t),e.__tabsterInstance=i),i.createTabster()}unction getDeloser(e,t){let i=e.core;return i.deloser||(i.deloser=new DeloserAPI(i,t)),i.deloser}function getModalizer(e){let t=e.core;return t.modalizer||(t.modalizer=new ModalizerAPI(t)),t.modalizer}unction getTabsterAttribute(e,t){let i=JSON.stringify(e);return!0===t?i:{[r]:i}}}}]);