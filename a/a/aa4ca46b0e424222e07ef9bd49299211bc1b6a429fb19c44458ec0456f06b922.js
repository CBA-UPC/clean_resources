(function(){nction i(){return i=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ui:fi,i.apply(null,arguments)}tion u(n,t,i){var f,r,e,u;for(t=t||[],i=i||[],f=n.className.split(/\s+/),r=0;r<t.length;r+=1){for(e=!1,u=0;u<f.length;u+=1)if(t[r]===f[u]){e=!0;break}e||f.push(t[r])}for(t=[],r=0;r<f.length;r+=1){for(e=!1,u=0;u<i.length;u+=1)if(f[r]===i[u]){e=!0;break}e||t.push(f[r])}n.className=t.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}tion b(n,t,i,r){var e=n.c.getElementsByTagName("head")[0],u,f;return e?(u=p(n,"script",{src:t}),f=!1,u.onload=u.onreadystatechange=e.appendChild(u),setTimeout(r||5e3),u):null}unction rt(n){return n.a++,ion ot(n){var r=[],i,t;for(n=n.split(/,\s*/),i=0;i<n.length;i++)t=n[i].replace(/['"]/g,""),-1!=t.indexOf(" ")||/^\d/.test(t)?r.push("'"+t+"'"):r.push(t);return r.join(",")} yi(n,t,i){var f=[],r,u;for(r in t)t.hasOwnProperty(r)&&(u=n.c[r],u&&f.push(u(t[r],i)));return f},r,e,o,s){var h=0==--t.h;(t.f||t.g)&&setTimeout(function(){var w=s||null,b=o||null||{},t,a;if(0===e.length&&h)ht(r.a);else{for(r.f+=e.length,h&&(r.j=h),a=[],t=0;t<e.length;t++){var y=e[t],p=b[y.c],c=r.a,l=y;c.g&&u(c.f,[c.a.c("wf",l.c,n(l).toString(),"loading")]);f(c,"fontloading",l);c=null;null===v&&(v=window.FontFace?(l=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent))?42<parseInt(l[1],10):!0:!1);c=v?new ct(i(r.g,r),i(r.h,r),r.c,y,r.s,p):new lt(i(r.g,r),i(r.h,r),r.c,y,r.s,w,p);a.push(c)}for(t=0;t<a.length;t++)a[t].start()}},0)}function bi(n,t,i){var r=[],f=i.timeout,u;for(ai(t),r=yi(n.a,i,n.c),u=new d(n.c,t,f),n.h=r.length,t=0,i=r.length;t<i;t++)r[t].load(}function bt(n,t){this.c=n;this.a=t}unction kt(n,t){this.c=n;this.a=t}unction gi(n,t){for(var i,u,f=t.length,r=0;r<f;r++)i=t[r].split(":"),3==i.length&&n.f.push(i.pop()),u="",2==i.length&&""!=i[1]&&(u=":"),n.a.push(i.join(u))}nction fr(n){for(var f,o,r,l,u,a=n.f.length,s=0;s<a;s++){var i=n.f[s].split(":"),e=i[0].replace(/\+/g," "),h=["n4"];if(2<=i.length){if(o=i[1],f=[],o)for(var o=o.split(","),v=o.length,c=0;c<v;c++)r=o[c],r.match(/^[\w-]+$/)?(u=ur.exec(r.toLowerCase()),null==u?r="":(r=u[2],r=null==r||""==r?"n":rr[r],u=u[1],null==u||""==u?u="4":(l=ir[u],u=l?l:isNaN(u)?"4":u.substr(0,1)),r=[r,u].join(""))):r="",r&&f.push(r);0<f.length&&(h=f);3==i.length&&(i=i[2],f=[],i=i?i.split(","):f,0<i.length&&(i=gt[i[0]])&&(n.c[e]=i))}for(n.c[e]||(i=gt[e])&&(n.c[e]=i),i=0;i<h.length;i+=1)n.a.push(new t(e,h[i]))}}function ni(n,t){this.c=n;this.a=t}r o=Date.now||oi=!!window.FontFace,e,a,v,dt,ti,r,y;et.prototype.c=function(){for(var t=[],n=0;n<arguments.length;n++)t.push(arguments[n].replace(/[\W_]+/g,"").toLowerCase());return t.join(this.a)};ct.prototype.start=e={D:"serif",C:"sans-serif"};a=null;lt.prototype.start=v=null;d.prototype.g=d.prototype.h=wt.prototype.load=bt.prototype.load=function(n){function f(){var r,o,h,e,s;if(u["__mti_fntLst"+i]){if(r=u["__mti_fntLst"+i](),o=[],r)for(e=0;e<r.length;e++)s=r[e].fontfamily,void 0!=r[e].fontStyle&&void 0!=r[e].fontWeight?(h=r[e].fontStyle+r[e].fontWeight,o.push(new t(s,h))):o.push(new t(s));n(o)}else setTimeout(50)}var r=this,i=r.a.projectId,e=r.a.version,u;i?(u=r.c.m,b(this.c,ki(r,i,e),.id="__MonotypeAPIScript__"+i):n([])};kt.prototype.load=function(n){for(var r=this.a.urls||[],s=this.a.families||[],c=this.a.testStrings||{},h=new it,f,o,e,i=0,u=r.length;i<u;i++)tt(this.c,r[i],rt(h));for(f=[],i=0,u=s.length;i<u;i++)if(r=s[i].split(":"),r[1])for(o=r[1].split(","),e=0;e<o.length;e+=1)f.push(new t(r[0],o[e]));else f.push(new t(r[0]));ut(h,function(){n(f,c)})};dt="//fonts.googleapis.com/css";var gt={latin:"BESbswy","latin-ext":"çöüğş",cyrillic:"йяЖ",greek:"αβΣ",khmer:"កខគ",Hanuman:"កខគ"},ir={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},rr={i:"i",italic:"i",n:"n",normal:"n"},ur=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;ti={Arimo:!0,Cousine:!0,Tinos:!0};ni.prototype.load=function(n){var i=new it,r=this.c,u=new di(this.a.api,w(r),this.a.text),f=this.a.families,t;gi(u,f);t=new tr(f);fr(t);ction(){n(t.a,t.c,ti)})};ii.prototype.load=function(n){var r=this.a.id,i=this.c.m;r?b(this.c,(this.a.api||"https://use.typekit.net")+"/"+r+".js",function(r){var f,u;if(r)n([]);else if(i.Typekit&&i.Typekit.config&&i.Typekit.config.fn){for(r=i.Typekit.config.fn,f=[],u=0;u<r.length;u+=2)for(var s=r[u],o=r[u+1],e=0;e<o.length;e++)f.push(new t(s,o[e]));try{i.Typekit.load({events:!1,classes:!1,"async":!0})}catch(h){}n(f)}},2e3):n([])};ri.prototype.load=function(n){var i=this.f.id,r=this.c.m,u=this;i?(r.__webfontfontdeckmodule__||(r.__webfontfontdeckmodule__={}),r.__webfontfontdeckmodule__[i]=function(i,r){for(var e,f=0,o=r.fonts.length;f<o;++f)e=r.fonts[f],u.a.push(new t(e.name,ci("font-weight:"+e.weight+";font-style:"+e.style)));n(u.a)},b(this.c,w(this.c)+(this.f.api||"//f.fontdeck.com/s/css/js/")+,function(t){t&&n([])})):n([])};r=new wt(window);r.a.c.custom=function(n,t){return new kt(t,n)};r.a.c.fontdeck=function(n,t){return new ri(t,n)};r.a.c.monotype=function(n,t){return new bt(t,n)};r.a.c.typekit=function(n,t){return newt){return new ni(t,n)};y={load:i(r.load,r)};"function"==typeof define&&define.amd?define(function(){return y}):"undefined"!=typeof module&&module.exports?module.exports=y:(window.ShWebFont=y,window.ShWebFontConfig&&r.load(window.ShWebFontConfig))})();
/*! Browser bundle of nunjucks 3.2.0 (slim, only works with preco t.shNunjucks = n(); }("undefined" != typeof self ? self : thisr}([function (t, n) { }, function (t, n, r) { "use strict"; var i = Array.prototype, e = Object.prototype, u = { "&": "&amp;", '"': "&quot;", "'": "&#39;", "<": "&lt;", ">": "&gdate = !1, this }, i } function a(t) { return "[object Function]" === e.toString.call(t) } function h(t) { return "[object Array]" === e.toString.call(t) } function v(t) { return "[object String]" == n.push(r); return n } (n = t.exports = {}) = e.name } return i }, Object.setPrototypeOf ? Object.setPrototypeOf(s.prototype, Error.prototype) : s.prototype = Object.create(Error.prototype, { constructor: { value: s } }), n.TemplateError = s, n.escape = function (t) { return t.replace(o, c) }, n.isFunction = a, n.isArray = h, n.isString = v, n.isObject = l, n.groupBy = function (t, n) { for (var r = {}, i = a(n) ? n : function (t) { return t[n] }, e = 0; e < t.length; e++) { var u = t[e], o = i(u, e); (r[o] || (r[o] = [])).push(u) } return r }, n.topush(t[e]); i++)r += t.call(r, ength = t.lengt, i, e, r) : r, u, e, o) : r() }() }, n.indexOf  return(n) { return t[n]  { t[r] = n[r] } un ex:ileString : void 0 } }, function (t,= t, t.__proto__ = n } var e = r(8), u = r(11), o = r(1), f = r(0), c = r(12), s = r(3), a = s.FileSystemLoader, h = s.WebLoader, v = s.PrecompiledLoader, l = r(14), d = r(15), p = r(5), y = p.Obj, b = p.EmitterObj, w = r(2), m = w.handleError, gtion () { t(n, r) }) } var O = { type(m(t, nulturn u(t t.ctx[r] }), n }, n }(, arguments) || this } i(n, t); var r = n.prote this.compiled = !1 }, r.render = function (t, n, r) { var i = this; "function" == typeof t ? (r = t, t = {}) : "function" == typeof n && (r = n, n = null); var e = !n; try { this.compile() } catch (t) { var u = o.t(this.path, this.env.opts.dev, t); if (r) return E(r, u); throw u } var f = new A(t || {}, this.blocks, this.env), c = n ? n.push(!0) : new g; c.topLevel = !0; var s = null, a = !1; return this.rootRenderFunc(this.env, f, c, w, function (t, n) { if (a) { if (r) return; throw t } if (t && (t = o.t(i.path, i.env.opts.dev, t), a = !0), r) e ? E(r, t, n) : r(t, n); else { if (t) throw t; s = n } }) e.getExportecompile, this.ce(2)] = t[r]) }), n }, n }(y); t.exports = { Environmeneod (t.exports = i) }() }, function (t, n, r) { "use strict"; ve(/^\s*|\s*$/g, "")) } (n = t.exports = {}).abse.push(u) } return e }, n.capifeness(t, o +void 0 !== t ?=== o ? 0 tringify(t, cape(t.toSkSafe(t.toSon (t) { return tscape(t.toStrturn i.groupBy(t, n) }, n.indent = function (t, n, r) { if ("" === (t = u(t, ""))) return ""; n = n || 4; var o = t.split("\n"), f = i.repeat(" ", n), c = o.map(function (t, n) { return 0 !== n || r ? "" + f + t + "\n" : t + "\n" }).join(""); return e.copySafe t[r] })),turn t[t.leni.keys(n).length : 0 }, n.list = c, n.lower = function (t) { return (t = u(t, "")).toLon|\n/g, "<brandom() * t.lengt) { return !t[n) { return !!e.copySafeness(t, n.jointh.round)(tu.push(a){ return t + n }, 0) }, n.sort = e.makeMacro(["value", "reverse", "case_sensitin ? -1 : 1 : e.copySafeness(e.copySafenness(t, n.join(" ")) }, n.e.copySafen, "")).toUpperC + n(i) }).join("&") }; var a = /^(?:\(|<|&lt;)?(.*?)(?:\.|,|\)|\n|&gt;)?$/, h = /^[\w.!#$%&'*+\-\/=?\^`{|}~]+@[a-z\d\-]+(\.[a-z\d\-]+)+$/i, v = /^https?:\/\/.*$/, l = /^www\./, d = /\.(?:org|net|com)(?/a>" : t }).joi n ? n.leng return o return o(r) ? n : r }, n.d = n.default, n.e = n.escape }, function (t, n, r) { "use strict"; var i, e = "object" == typeof Reflect ? Reflect : null, u = e && "function" == type.apply.call(t, n, r) }; i = e && "function" == typeof e.ownKeys ? e.ownKeys : Object.gnPtOwnPropertyNames(t) }; v  { f.init.call(this) } t.exports = f, f.EventEmitter = f, f.prototype.y = void 0, f.prototype.b = 0, f.prototype.wltMaxListeners : t.w } function a(t, n, r, i) { var e, u, o; if ("function" != typeof r) throw new TypeError('The "listener" argument must be of type Function. Received type ' + typeof r); if (void 0 === (u = t.y) ? (u = t.y = Object.create(null), t.b = 0) : (void 0 !== u.newListener && (t.emit("newListener", n, r.listener ? r.listener : r), u = t.y), o = u[n]), void 0 === o) o = u[n] = r, ++t.b; else if ("function" == typeof o ? o = u[n] = i ? [r, o] : [o, r] : i ? o.unshift(r) : o.push(r), (e = s(t)) > 0 && o.length > e && !o.warned) { o.warned = !0; var f = Error("Possible EventEmitter memory leak detected. " + o.length + " " + n + " listeners added. Use emitter.setMaxListeners() to increase limit"); f.name = "MaxListenersExceededWarning", f.emitter = t, f.type = n, f.count = o.length, console && console.warn && consol[i] = t[i]; return r } Object.defineProperty(f, "defaultMaxListeners", { enumerable: !0, get: function ' + t + ".")w = this.w || void 0 }, f.protourn this.w = t, this }, f.proto () { return s(this) }, f.prototype.emit = function (t) { for (var n = [], r = 1; r < arguments.length; r++)n.push(arguments[r]); var i = "error" === t, e = this.y; if (void 0 !== e) i = i && void 0 === e.error; else if (!i) return !1; if (i) { var o; if (n.length > 0 && (o = n[0]), o instanceof Error) throw o; var f = Error("Unhandled error." + (o ? " (" + o.message + ")" : "")); throw f.context = o, f } var c = e[t]; if (void 0 === c) return !1; if ("function" == typeof c) u(c, this, n); else { var s = c.length, a = d(c, s); for (r = 0; r < s; ++r)u(a[r], this, n) } return !0 }, f.prototype.addListener = function (t, n) { return a(this, t, n, !1) }, f.prototype.on = f.prototype.addListener, f.protorn a(this, t, n, !0) }, f.prototype.once = function (t, n) { if ("function" != typeof n) throw new TypeError('The "listener" argument must be of type Function. Received type ' + typeof n); return this.on(t, h(this, t, n)), this }, f.prototypeh(this, t, n)), this }, f.prot || n) } return this }, f.prototype.off = f.prototype.removeListener, f.prototyp, n[i]); return this }, f.prototype.listeners = function (t) { return v(this, t, !0) }, f.preturn v(this, t, !1nt(n) : l.call(t, n) }, f.prototype.listenerCount = l, f.> 0n=useAggregate = n) } } }]) });

(function(n,t,i){"use strict";function c(n,t){if(h[n])for(var i=0;i<h[n]se(JSON.stringify(n))}function p(n){for(var t,i=Object.keys(n),r=i.length,u={};r--;)t=i[r],u[t.toLoweturn i.toString(16)})}function oi(){var n,t;try{return(n="shmktpl:sessionId",sessionStorage.getItem(n))?sessionStorage.getItem(n):(t=a(),sessionStorage.setItem(n,t),t)}catch(i){return a()}}function si(n){var t,i;try{return(t="shmktpl:sessionWidgetInstanceId",!n&&sessionStorage.getItem(t))?sessionStorage.getItem(t):(i=nt(),sessionStorage.setItem(t,i),i)}catch(r){returandom()*u));return t}return n(16)}function hi(){var n,t;try{return(n="shmktpl:widgetUserId",localStorage.getItem(n))?localStorage.getItem(n):(t=a(),localStorage.setItem(n,t),t)}catch(i){return console.log(i),a()}}function ci(n,t){try{var i="shmktpl:"+n;localStorage.setItem(i,t)}catch(r){console.log(r)}}function tt(n){try{var t="shmktpl:"+n;return localStorage.getItem(t)}catch(i){return console.log(i),null}}function li(n){l&&console.log.apply(console,n)}function ai(n){l&&consolerror.apply(console,n)}function o(n){return n===null||typeof n=="undefined"?!0:Array.isArray(n)?n.length===0:typeof n=="object"?Object.keys(n).length===0:typeof n=="string"?n.length===0:!1}function it(n){return"?"+Object.keys(n).map(function(t){if(typeof n[t]!="object"&&typeof n[t]!="undefined")return encodeURIComponent(t)+"="+encodeURIComponent(n[t])}).join("&")}function dt(n){var u,i,f,e;if(n.preventDefault(),u=n.currentTarget,i=p(u.dataset),!i.shsrc||!i.shinventorytype||!i.shtarget){console.error("invalid link configuration %o",u);return}f={src:i.shsrc,inventorytype:i.shinventorytype,var1:i.shvar1,zipcode:i.shzipcode,trn_id:i.shtrnId,targetBuyer:i.shtarget,primaryColor:i.primarycolor,buttonHoverColor:i.buttonhovercolor,buttonFontcolor:i.buttonfontcolor};e=rt(f,yi(t.body));r.getWidgetFromServer(e)}function yi(n){var i=gt(),r=t.createElement("div");return r.id=i,n.appendChild(r),i}function gt(){return"__sh__"+Math.floor(Math.random()*1e9)}function ni(n){var f=t.querySelector("#"+n),i,u;if(f)return f.innerHTML="",n;if(i=pi(),i)return u=gt(),i.insertAdjacentHTML("beforebegin",'<div id="'+u+'"><\/div>'),u;r.consoleError("could not find legacy loader to inject widget into")}function pi(){var r=t.getElementById("shmktpl_retrieve"),n,i;if(r!==null)return r;for(n=t.getElementsByTagName("script"),i=0;i<n.length;i++)if(n[i].src.match(/\/loader\/js/gi)||n[i].src.match(/\/retrieve/gi))return n[i];return n[n.length-1]}function wi(){var n,t;typeof r.currentPageLoadId!="undefined"&&(n=new Image,n.alt="",n.style="width:0px; height:0px",n.classList.add("shmktpl-rlcdn"),wt?n.src="https://id.rlcdn.com/712363.gif?cparams=wplId%3D"+r.currentPageLoadId:(t=bt?"XY2685sGHpdGV5I-qoDYo7Pe1ufxFxCOTnbQ9sH0UaoXmsQBY":"DemoRampID",n.src=yt+"?wplId="+r.currentPageLoadId+"&RampID="+t))}function rt(e,s){var l=nt(),h,w;r.groupStart("%ccreateNewWidget : instanceId %s, session %s, widgetUserId %s, pageLoadId %s",v,l,r.currentSessionId,r.currentWidgetUserId,r.currentPageLoadId);h={src:e.src,instanceId:l,originwidgetinstanceid:l,idx:ft,domContainer:s,matchingConfig:bi(e),sessionId:r.currentSessionId,widgetUserId:r.currentWidgetUserId,pageLoadId:r.currentPageLoadId,ref:r.currentPageUrl,frm:r.currentPageReferrer,widgetSearchCount:0,listingLoadCount:0,lightBoxCleared:!1,widgetLoadEventId:a(),options:e.options||{}};e.hasOwnProperty("widgetType")&&(h.widgetType=e.widgetType);e.hasOwnProperty("widgetId")&&(h.widgetId=e.widgetId);e.hasOwnProperty("widget")&&(h.widget=e.widget);e.hasOwnProperty("abTestVersion")&&(h.abTestVersion=e.abTestVersion);e.hasOwnProperty("widgetfile")&&(h.widgetFile=e.widgetfile);e.hasOwnProperty("inventorytype")&&(h.inventorytype=e.inventorytype);e.hasOwnProperty("originwidgetinstanceid")&&(h.originwidgetinstanceid=e.originwidgetinstanceid);e.hasOwnProperty("originsessionid")&&(h.sessionId=e.originsessionid);e.hasOwnProperty("devDomain")&&(h.devDomain=e.devDomain);e.hasOwnProperty("position")?h.widgetposition=e.position:e.hasOwnProperty("widgetposition")&&(h.widgetposition=e.widgetposition);e.hasOwnProperty("extraClickParams")&&typeof e.extraClickParams=="object"&&(h.extraClickParams=e.extraClickParams);try{sessionStorage.getItem("shmktpl:priorAbTest")&&(w=JSON.parse(sessionStorage.getItem("shmktpl:priorAbTest")),e.hasOwnProperty("abTestVersion")&&h.abTestVersion.widgetAbTestId===w.widgetAbTestId||(h.priorAbTestVersionFlag=w.flag))}catch(d){}re)&&this.isFormValid(ns("listingindexOf(" "+n+" ")>-1},h.finalize=function(){var n=this,t;if(r.groupStart("currentWidget.finalize %s",n.instanceId),n.loadFont(),t=Object.keys(n.hiddenInputs),t.length>0)for(u=0;u<t.length;u++)n.createHiddenInput(t[u],n.hiddenInputs[t[u]]);n.checkSpecificOptions();n.options.hasOwnProperty("defaultUserAttributes")&&typeof n.options.defaultUserAttributes=="object"&&(r.groupStart("updateMatchingDtoWithPublisherDefaults"),r.log("widget default options: %o",n.options.defaultUserAttributes),n.updateMatchingDtoWithPublisherDefaults(n.options.defaultUserAttributes),r.groupEnd());n.updateFormSelectionsWithAttributeValues(n.matchingConfig);n.autoFillZipCode();n.updateDynamicContent(n.options);n.updateDynamicContent(n.matchingConfig);n.addEventListeners();r.groupEnd()},h.loadFont=function(){var t=this,u=!1,i;if(t.options.hasOwnProperty("disablefonts")&&t.options.disablefonts?u=!0:t.matchingConfig.hasOwnProperty("disablefontload")&&t.matchingConfig.disablefontload&&(u=!0),u)r.warn("disabled font loading");else{if(t.options.hasOwnProperty("customfonts")&&Array.isArray(t.options.customfonts))for(i=0;i<t.options.customfonts.length;i++)t.options.customfonts[i]!==""&&(r.log("adding "+t.options.customfonts[i]),n[t.instanceId+"_fonts"].push(t.options.customfonts[i]));r.loadFont(n[t.instanceId+"_fonts"])}},h.checkSpecificOptions=function(){if(r.groupStart("checkSpecificOptions"),this.options.hasOwnProperty("features"))for(var n=0;n<this.options.features.length;n++)this.addRootCssClass(this.options.features[n]);this.addRootCssClass(this.inventorytype);this.addRootCssClass(this.baseinventorytype);this.addRootCssClass(this.widgetposition);this.addRootCssClass(this.pagingConfig.pagingEnabled?"pagingEnabled":"pagingDisabled");this.addDeviceClass();this.checkBrowser();this.checkDeviceSpecificOptions();this.checkCategorySpecificOptions();this.checkFeatureSpecificOptions()},h.addDeviceClass=function(){var t,n;if(this.addRootCssClass("device-"+this.deviceClass),this.domContainerWidth()>0&&(n=50*Math.round(this.domContainerWidth()/50,0),this.addRootCssClass("box"+n.toString()),t=this.narrowSettingMaxWidth||650,this.deviceClass==="desktop"&&this.domContainerWidth()<t&&this.addRootCssClass("desktop-narrow"),this.domContainerWidth()>=300&&this.domContainerWidth()<=1e3))for(n=50*parseInt(this.domContainerWidth()/50),u=n;u<=1e3;u+=50)this.addRootCssClass("sh-box"+u.toString())},h.addRootCssClass=function(n){o(n)||this.root.classList.contains(n)||(r.log("%cadding css class to widget root: %c%s","color:red","font-weight:bold",n),this.root.classList.add(n))},h.checkDeviceSpecificOptions=function(){r.groupStart("checking device specific options...");var n=this;r.gather("#"+n.instanceId+" .device-specific").forEach(function(t){t.classList.contains(n.deviceClass)||(r.log("missing required device class - detaching element %o",t),r.detachElement(t))})},h.checkBrowser=function(){/MSIE|Trident/.test(n.navigator.userAgent)&&this.addRootCssClass("msie")},h.checkCategorySpecificOptions=function(){var n=this;r.groupStart("checking category specific options...");r.gather("#"+n.instanceId+" .categoryt)||r.detachElement(t)});r.gather("#"+n.instanceId+" .category-specific").forEach(function(t){t.classList.contains(n.widgetCategory)||(r.log("missing required category class - detaching element %o",t),r.detachElement(t))});r.groupEnd()},h.checkFeatureSpecindexOf(" "+t+" ")>-1}var t,n;r.groupStart("checking feature specific options...");t=this;n=t.options.features||[];r.gather("#"+t.instanceId+" .feature-specific").forEach(function(t){for(var f=!1,u=0,e=n.length;u<e;u++)if(i(t,n[u])){f=!0;break}f||(r.log("missing required feature class %o- detaching element %o",n,t),r.detachElement(t))});r.groupEnd()},h.bindAttributesToElement=function(n,t){var f=this,u=n.dataset.shmktplBind,i,e,o,s;typeof t[u.toLowerCase()]!="undefined"&&t[u.toLowerCase()]!==""&&(i=decodeURIComponent(t[u.toLowerCase()]),u.toLowerCase()==="coveragetype"&&i.toLowerCase()==="homeowners"&&(i="home"),typeof n.dataset.shmktplBindFormat!="undefined"?n.dataset.shmktplBindFormat==="money"&&(i=r.formatMoney(i,0)):typeof n.dataset.shmktplBindToInputOption!="undefined"&&n.dataset.shmktplBindToInputOption==="1"&&(e=f.root.querySelector('.shmktpl-input-option[data-attribute-name="'+u+'"][data-checked-value="'+i+'"]'),e?i=e.textContent:(o=f.root.querySelector('select.shmktpl-form-input[data-attribute-name="'+u+'"]'),o&&(s=f.getSelectedDropdownOption(o),s&&(i=s.textContent)))),n.innerHTML=i,r.gather("[data-shmktpl-bind]",n).forEach(function(n){f.bindAttributesToElement(n,t)}))},h.updateDynamicContent=function(n){var t=this,i;r.groupStart("currentWidget.updateDynamicContent for instance %s",t.instanceId);i=p(n);r.log("with attribute values = %o",i);r.gather("#"+t.instanceId+" [data-sributesToElement(n,i)});r.groupEnd()},h.isFormValid=function(){var t=this,n;return(r.groupStart("Validating form for widget %s",t.instanceId),n=[],r.gather("#"+t.instanceId+' .shmktpl-form-input[data-shmktpl-required="true"]').forEach(function(t){if(r.log("validating form element %o",t),typeof t.dataset.attributeName!="undefined"){var i=t.dataset.attributeName.toLowerCase();i.indexOf("zipcode")>-1&&t.value.length<5?n.push(t):i.indexOf("age")>-1&&(t.value.length<2||parseInt(t.value,10)<16)?n.push(t):t.value===""&&n.push(t)}else r.consoleError("error validating form element %o, no data-attribute-name property assigned",t)}),r.groupEnd(),n.length>0)?(r.displayErrors(n),!1):!0},h.updateMatchingDtoWithFormSelections=function(){var n=this;r.groupStart("currentWidget.updateMatchingDtoWithFormSelections for instance %s",n.instanceId);r.gather("#"+n.instanceId+" .shmktpl-form-input").forEach(function(t){var f=t.tagName,u=t.type,e=t.dataset.attributeName,i,o;typeof e!="undefined"&&(f==="SELECT"?(o=n.getSelectedDropdownOption(t),i=o?o.value:""):f==="INPUT"?u==="radio"?t.checked&&(i=typeof t.dataset.checkedValue!="undefined"?t.dataset.checkedValue:t.value):u==="checkbox"?t.checked?i=typeof t.dataset.checkedValue!="undefined"?t.dataset.checkedValue:t.value:typeof t.dataset.uncheckedValue!="undefined"&&(i=t.dataset.uncheckedValue):u==="text"||u==="tel"||u==="hidden"||u==="number"||u==="range"?i=t.value:r.consoleError("can't update matching variable from form input: %s-%s, tagName=%s, inputType=%s",n.instanceId,e,f,u):typeof t.dataset.checkedValue!="undefined"?t.classList.contains("active")?i=t.dataset.checkedValue:typeof t.dataset.uncheckedValue!="undefined"&&(i=t.dataset.uncheckedValue):r.warn("can't update matching variable from form input: %o",t),typeof i!="undefined"&&n.updateMatchingDtoAttributeValue(e,i))});r.groupEnd()},h.autoFillZipCode=function(){var n=this,t=n.root.querySelector('input[data-attribute-name="zipcode"][data-geo-detect="true"]');t&&(t.value===""?r.loadGeo(function(t){n.updateMatchingDtoAttributeValue("zipcode",t.zipcode);n.updateFormSelectionsWithAttributeValues(t);n.updateDynamicContent(t);typeof n.autoFillZipCodeComplete=="function"?(r.log("%ccurrentWidget has autoFillZipCodeComplete handler, executing it",v),n.autoFillZipCodeComplete()):r.log("%ccurrentWidget does not have autoFillZipCodeComplete handler",v)}):typeof n.autoFillZipCodeComplete=="function"?(r.warn("currentWidget %s has zip code filled already, and has autoFillZipCodeComplete handler, executing it",n.instanceId),n.autoFillZipCodeComplete()):r.warn("currentWidget %s does not have autoFillZipCodeComplete handler",n.instanceId))},h.createHiddenInput=function(n,i){var f=this,u;f.root.querySelector('.shmktpl-form-input[data-attribute-name="'+n+'"]')||(r.warn("currentWidget %s, createHiddenInput name='%s', value='%s'",f.instanceId,n,i),u=t.createElement("input"),u.type="hidden",u.classList.add("shmktpl-form-input"),u.dataset.attributeName=n,u.value=i.toString(),f.root.appendChild(u))},h.showSingleBuyerRedirect=function(n){function i(){var i=4,u=setInterval(function(){i<=0?(clearInterval(u),t.root.querySelector("#countdown").style.display="none",t.root.querySelector("#showMeOtherOptions").style.display="none",t.root.querySelector("#loader").style.display="block",tt("singleBuyerRedirectDisabled")&&tt("singleBuyerRedirectDisabled")!=="0"||r.click(1,n.listing[0].clickurl,{openInSameWindow:!0})):t.root.querySelector("#countdown").innerHTML="Redirecting in "+i+" seconds";i-=1},1e3)}var t=this;n.widgetUserAttributes.hasOwnProperty("singlebuyerredirectmarkup")?(t.root.innerHTML=n.widgetUserAttributes.singlebuyerred;r.fadeInElement(n,i)},500)):r.click(1,n.listing[0].clickurl,{openInSameWindow:!0})},h.showListings=function(){function e(){var u,t,i;if(!o(n.currentMatchingResult.listingset.listing)){for(u={sdt:n.currentMatchingResult.listingset.sdt,sid:n.currentMatchingResult.listingset.searchid,ref:r.currentPageUrl,frm:r.currentPageReferrer,widgetPage:n.currentPage,widgetUserId:r.currentWidgetUserId,imps:[]},t=0;t<n.currentMatchingResult.listingset.listing.length;t++)for(u.imps.push({i:n.currentMatchingResult.listingset.listing[t].impressionid,r:n.currentMatchingResult.listingset.listing[t].rank,s:n.currentMatchingResult.listingset.listing[t].has_been_seen,px:n.currentMatchingResult.listingset.listing[t].client_imp_pixel}),i=0;i<n.originalMatchingResult.listingset.listing.length;i++)n.originalMatchingResult.listingset.listing[i].impressionid===n.currentMatchingResult.listingset.listing[t].impressionid&&(n.originalMatchingResult.listingset.listing[i].has_been_seen=!0);return r.log("impsShownDto = %o",u),u}}var n=this,t,f,u;if(r.log("final listings to bind: %o",n.currentMatchingResult),n.insideContainer.innerHTML=i.render(n.templateName+".njk",n.currentMatchingResult),!o(n.currentMatchingResult.listingset.listing)){for(t=e(),f=!1,u=0;u<t.imps.length;u++)t.imps[u].s||(f=!0,n.addPixel(t.imps[u].px));f&&(r.log("%cimpression pixels = %o","color:blue",t),k(ui,t,null,!0))}c("sh.listingsRendered",n.currentMatchingResult)},h.addPixel=function(n){var i=this,t;i.root&&typeof n!="undefined"&&n!==""&&(t=new Image,t.alt="",t.style="display:none;",t.classList.add("shmktpl-client-px"),t.src=n,i.root.appendChild(t))},h.showPage=function(n){r.warn("show '%s'",n);var t=this,i=!1;n==="next"&&t.currentPage<t.currentMatchingResult.listingset.numPages?(i=!0,t.currentPage+=1):n==="prev"&&t.currentPage>1?(i=!0,t.currentPage-=1):n==="first"&&(i=!0,t.currentPage=1);i?(t.pageListings(),t.showListings()):r.warn("cannot page")},h.renderListings=function(n,f,e,o){var s=this,v,p,h,w,l,a;if(r.groupStart("%ccurrentWidget.renderListings","color:blue"),r.log("%clistingCount = %s","color:blue",n.listingset.listing.length),typeof s.extraClickParams=="object"&&(v=it(s.extraClickParams),v.length>1))for(u=0;u<n.listingset.listing.length;u++)p=n.listingset.listing[u].clickurl,n.listingset.listing[u].clickurl=p+(p.indexOf("?")>0?"&"+v.substring(1):v),r.log("modifiying click url to: %s",n.listingset.listing[u].clickurl);if(s.originalMatchingResult=n,s.currentSearchStatusId=n.listingset.searchStatusId||y,s.baseSearchStatusId=n.listingset.baseSearchStatusId||y,bt&&(n.listingset.additional_tracking="%7B%22searchStatusId%22%3A%225%22%2C%22baseSearchStatusId%22%3A%225%22%2C%22sdt%22%3A%22637821630338923617%22%2C%22publisherAdditionalTracking%22%3A%22%257B%2522searchStatusId%2522%253A%252239%2522%252C%2522baseSearchStatusId%2522%253A%25221%2522%252C%2522publisherAdditionalTracking%2522%253A%2522%25257B%252522widgetUserId%252522%25253A%2525225e43830c-ae90-45f8-bb11-97adcbe0ad71%252522%25252C%252522js_session%252522%25253A%25252272b841ba-9781-4e5e-8a88-1edaf018eaab%252522%25252C%252522widgetId%252522%25253A373%25252C%252522widgetConfigurationId%252522%25253A24671%25252C%252522widgetInstanceId%252522%25253A%252522foikKXIn%252522%25252C%252522widgetContainerId%252522%25253A%252522qsWidgetContainer%252522%25252C%252522widgetContainerWidth%252522%25253A1140%25252C%252522widgetDefaultSearchStatusId%252522%25253A39%25252C%252522originWidgetInstanceId%252522%25253A%252522ECxeYaCj%252522%25252C%252522widgetSearchCount%252522%25253A0%25252C%252522widgetInventoryType%252522%25253A%252522experian-nodatapass-standalone%252522%25252C%252522abTestVersion%252522%25253A%25257B%252522widgetAbTestWidgetId%252522%25253A2294%25252C%252522widgetAbTestId%252522%25253A2106%25252C%252522widgetId%252522%25253A373%25252C%252522frequency%252522%25253A75%25252C%252522flag%252522%25253A%252522A%252522%25252C%252522expires%252522%25253A1646670872547%25257D%25257D%2522%257D%22%7D"),n.listingset.hasOwnProperty("additional_tracking")&&typeof n.listingset.additional_tracking=="string")try{if(h=JSON.parse(decodeURIComponent(n.listingset.additional_tracking)),r.warn("%cadditionalTrackingObj = %o","color:blue",h),typeof h=="object"&&(h.hasOwnProperty("searchStatusId")&&(s.currentSearchStatusId=h.searchStatusId),h.hasOwnProperty("baseSearchStatusId")&&(s.baseSearchStatusId=h.baseSearchStatusId),h.hasOwnProperty("sdt")&&(s.originalMatchingResult.listingset.sdt=h.sdt),h.hasOwnProperty("publisherAdditionalTracking")&&typeof h.publisherAdditionalTracking=="string"))try{s.publisherAdditionalTracking=h.publisherAdditionalTracking;s.publisherAdditionalTrackingObj=JSON.parse(decodeURIComponent(h.publisherAdditionalTracking))}catch(b){s.publisherAdditionalTracking="";s.publisherAdditionalTrackingObj={}}}catch(k){}if(s.originalMatchingResult.listingset.hasOwnProperty("singleBuyerRedirect")&&s.originalMatchingResult.listingset.singleBuyerRedirect)s.showSingleBuyerRedirect(s.originalMatchingResult.listingset),c("sh.listingsRendered",s.originalMatchingResult);else if(s.templateName=e||s.instanceId,typeof window.nunjucksPrecompiled[s.templateName+".njk"]=="object")if(s.insideContainer=f||t.querySelector("#"+s.instanceId+" .listings-layout-container"),s.insideContainer){if(w=i.configure({autoescape:!1}),typeof o=="object")for(l=Object.keys(o),u=0;u<l.length;u++)r.log("Adding Nunjucks Global variable %s = %s",l[u],o[l[u]]),w.addGlobal(l[u],o[l[u]]);s.showPage("first");r.gather("#"+s.instanceId+" .hide-until-listil-listings-loaded")})}else console.error("no container defined to render listings to for instance %s.  You should have an dom element with css class 'listings-layout-container' defined in your widget html markup",this.instanceId);else console.error("No precompiled nunjucks template named %s.njk",templateName);s.currentSearchStatusId!==g&&s.updateSearchStatus(t.hidden?kt:s.baseSearchStatusId);try{for(a=s.root.querySelectorAll("[onclick]"),u=0;u<a.length;u++)/sh.click\(\d{1,2}\s*\,\s*\'\'/.test(a[u].attributes.onclick.value)&&(r.log("removing onclick from element %o",a[u]),a[u].removeAttribute("onclick"))}catch(k){}r.groupEnd()},h.pageListings=function(){var n=this,t;if(r.groupStart("%ccurrentWidget.pageListings","color:blue"),t=b(n.originalMatchingResult),t.listingset.pagingEnabled=n.pagingConfig.pagingEnabled,t.listingset.repeatImpressionEnabled=n.pagingConfig.repeatImpressionEnabled,t.listingset.currentPage=n.currentPage,t.listingset.canShowNext=n.pagingConfig.pagingEnabled&&n.currentPage<t.listingset.numPages,t.listingset.canShowPrev=n.pagingConfig.pagingEnabled&&n.currentPage>1,n.pagingConfig.pagingEnabled)if(r.log("%cpaging enabled","color:blue;"),t.listingset.listing=[],n.pagingConfig.pageBehavior.toLowerCase()==="append")for(u=0;u<n.originalMatchingResult.listingset.listing.length;u++)n.originalMatchingResult.listingset.listing[u].widgetpage<=n.currentPage&&t.listingset.listing.push(n.originalMatchingResult.listingset.listing[u]);else for(u=0;u<n.originalMatchingResult.listingset.listing.length;u++)n.originalMatchingResult.listingset.listing[u].widgetpage===n.currentPage&&t.listingset.listing.push(n.originalMatchingResult.listingset.listing[u]);else r.log("%cpaging disabled","color:red;");return n.currentMatchingResult=t},h.updateFormSelectionsWithAttributeValues=function(n){var t=this,i=p(n);r.groupStart("updateFormSelectionsWithAttributeValues for instance %s",t.instanceId);r.log("Values to bind to Form %o",i);r.gather("#"+t.instanceId+" .shmktpl-form-input").forEach(function(n){var e=n.dataset.attributeName,o,f,u;typeof e!="undefined"&&typeof i[e]!="undefined"&&(o=n.tagName,f=i[e].toString(),r.log("updating input %o with value '%s'",n,f),o==="SELECT"?t.setSelectedDropdownValue(n,f):o==="INPUT"&&typeof n.type!="undefined"?(u=n.type,u==="radio"?t.setCheckedStateForRadioGroupInputAttribute(e,f):u==="checkbox"?typeof n.dataset.checkedValue!="undefined"&&(n.checked=n.dataset.checkedValue.toLowerCase()===f.toLowerCase()):u==="text"||u==="tel"||u==="number"||u==="hidden"||u==="range"?n.value=f:r.consoleError("can't handle form input %o",n)):n.classList.contains("shmktpl-has-active-state")?t.setActiveStateForToggleInputAttribute(e,f):r.consoleError("can't handle form input %o",n),n.classList.remove("error"))});r.groupEnd()},h.updateMatchingDtoAttributeValue=function(n,t,i){var e=this,u,f;if(i=typeof i!="undefined"?i:!1,typeof t!="undefined")if(u=e.matchingConfig,typeof t!="string"&&(t=t.toString()),n=n.toLowerCase(),r.log("updating matching attribute '%s' to '%s'",n,t),f=!0,u.hasOwnProperty("tracking")){u.contact=u.contact||{};u.current_insurance=u.current_insurance||{};u.requested_coverage=u.requested_coverage||{};u.pet_coverage=u.pet_coverage||{};u.business_info=u.business_info||{};u.hasOwnProperty("drivers")&&(u.individuals=u.drivers,delete u.drivers);u.individuals=u.individuals||[];u.individuals.length===0&&u.individuals.push({});switch(n){case"age":case"agebucket":i&&(u.contact.age||u.individuals[0].age)&&(f=!1);f&&(u.contact.age=t,u.individuals[0].age=t,delete u.individuals[0].birthdate);break;case"algowidgetid":i&&typeof u.tracking.algoWidgetId!="undefined"&&(f=!1);f&&(u.tracking.algoWidgetId=t);break;case"bundleinsurance":i&&typeof u.requested_coverage.bundle_insurance!="undefined"&&(f=!1);f&&(u.requested_coverage.bundle_insurance=t);break;case"buyer":u.tracking.buyer=t;break;case"carrier":i&&typeof u.current_insurance.currently_insured!="undefined"&&(f=!1);f&&(t!==""&&(u.current_insurance.currently_insured=t!=="Not Currently Insured"),u.current_insurance.carrier=t);break;case"coveragetype":i&&typeof u.requested_coverage.coverage_type!="undefined"&&(f=!1);f&&(u.requested_coverage.coverage_type=t);break;case"coverageamount":i&&typeof u.requested_coverage.coverage_amount!="undefined"&&(f=!1);f&&(u.requested_coverage.coverage_amount=t);break;case"creditrating":i&&typeof u.individuals[0].self_credit_rating!="undefined"&&(f=!1);f&&(u.individuals[0].self_credit_rating=t);break;case"currentlyinsured":i&&typeof u.current_insurance.currently_insured!="undefined"&&(f=!1);f&&(u.current_insurance.currently_insured=t);break;case"drivercount":i&&typeof u.requested_coverage.driver_count!="undefined"&&(f=!1);f&&(u.requested_coverage.driver_count=t,delete u.vehicles);break;case"dui":i&&typeof u.individuals[0].has_had_dui!="undefined"&&(f=!1);f&&(u.individuals[0].has_had_dui=t);break;case"education":case"edu":i&&typeof u.individuals[0].education!="undefined"&&(f=!1);f&&(u.individuals[0].education=t);break;case"frm":i&&typeof u.tracking.ni_frm_ref!="undefined"&&(f=!1);f&&(u.tracking.ni_frm_ref=t);break;case"ft":i&&typeof u.tracking.feed_type_id!="undefined"&&(f=!1);f&&(u.tracking.feed_type_id=t);break;case"fulltimeemps":i&&typeof u.business_info.full_time_emps!="undefined"&&(f=!1);f&&(u.business_info.full_time_emps=t);break;case"gender":i&&typeof u.individuals[0].gender!="undefined"&&(f=!1);f&&(u.individuals[0].gender=t);break;case"hazardousoccupation":i&&typeof u.individuals[0].high_risk!="undefined"&&(f=!1);f&&(u.individuals[0].high_risk=t);break;case"homeowner":i&&typeof u.contact.homeowner!="undefined"&&(f=!1);f&&(u.contact.homeowner=t);break;case"household_income":i&&typeof u.contact.household_income!="undefined"&&(f=!1);f&&(u.contact.household_income=t);break;case"inventorytype":i&&typeof u.tracking.inventory_type!="undefined"&&(f=!1);f&&(u.tracking.inventory_type=t);break;case"widgetposition":i&&typeof u.tracking.widgetposition!="undefined"&&(f=!1);f&&(u.tracking.widgetposition=t);break;case"displaytypename":i&&typeof u.tracking.displaytypename!="undefined"&&(f=!1);f&&(u.tracking.displaytypename=t);break;case"js_session":u.tracking.js_session=t;break;case"pageLoadId":u.tracking.pageLoadId=t;break;case"jsev":u.tracking.engine_version=t;break;case"married":i&&(typeof u.individuals[0].marital_status!="undefined"||typeof u.contact.married!="undefined")&&(f=!1);f&&(u.contact.married=t,delete u.individuals[0].marital_status);break;case"max":i&&typeof u.tracking.ni_max_display!="undefined"&&(f=!1);f&&(u.tracking.ni_max_display=t);break;case"medicalcondition":i&&typeof u.individuals[0].hc_other!="undefined"&&(f=!1);f&&(u.individuals[0].hc_other=t);break;case"military":i&&typeof u.contact.military_affiliation!="undefined"&&(f=!1);f&&(u.contact.military_affiliation=t);break;case"residencetype":i&&typeof u.contact.residence_type!="undefined"&&(f=!1);f&&(u.contact.residence_type=t);break;case"occupation":i&&typeof u.individuals[0].occupation!="undefined"&&(f=!1);f&&(u.individuals[0].occupation=t);break;case"originwidgetinstanceid":u.tracking.originWidgetInstanceId=t;break;case"petage":i&&typeof u.pet_coverage.pet_age!="undefined"&&(f=!1);f&&(u.pet_coverage.pet_age=t);break;case"petgender":i&&typeof u.pet_coverage.pet_gender!="undefined"&&(f=!1);f&&(u.pet_coverage.pet_gender=t);break;case"petcount":i&&typeof u.pet_coverage.pet_count!="undefined"&&(f=!1);f&&(u.pet_coverage.pet_count=t);break;case"pettype":i&&typeof u.pet_coverage.pet_type!="undefined"&&(f=!1);f&&(u.pet_coverage.pet_type=t);break;case"petbreed":i&&typeof u.pet_coverage.pet_breed!="undefined"&&(f=!1);f&&(u.pet_coverage.pet_breed=t);break;case"priorabtestversionflag":u.tracking.prior_ab_test_version_flag=t;break;case"recentincidentcount":i&&typeof u.individuals[0].num_recent_incidents!="undefined"&&(f=!1);f&&(u.individuals[0].num_recent_incidents=t,delete u.incidents);break;case"ref":u.tracking.ni_ref=t;break;case"rootsearchid":u.tracking.orig_srch_id=t;break;case"sicindustrydivision":i&&typeof u.business_info.sic_industry_division!="undefined"&&(f=!1);f&&(u.business_info.sic_industry_division=t);break;case"single_buyer_redirect":i&&typeof u.tracking.single_buyer_redirect!="undefined"&&(f=!1);f&&(u.tracking.single_buyer_redirect=t);break;case"single_buyer_redirect_optout":i&&typeof u.tracking.single_buyer_redirect_optout!="undefined"&&(f=!1);f&&(u.tracking.single_buyer_redirect_optout=t);break;case"sr22":i&&typeof u.individuals[0].requires_sr22!="undefined"&&(f=!1);f&&(u.individuals[0].requires_sr22=t);break;case"standard_industry_code":i&&typeof u.business_info.standard_industry_code!="undefined"&&(f=!1);f&&(u.business_info.standard_industry_code=t);break;case"suspension":i&&typeof u.individuals[0].has_had_suspension!="undefined"&&(f=!1);f&&(u.individuals[0].has_had_suspension=t);break;case"tobacco":i&&typeof u.individuals[0].tobacco_use!="undefined"&&(f=!1);f&&(u.individuals[0].tobacco_use=t);break;case"vehiclecount":i&&typeof u.requested_coverage.vehicle_count!="undefined"&&(f=!1);f&&(u.requested_coverage.vehicle_count=t,delete u.vehicles);break;case"widgetid":u.tracking.widgetId=t;break;case"widgetconfigurationid":u.tracking.widgetConfigurationId=t;break;case"widgetsearchcount":u.tracking.widgetSearchCount=t;break;case"widgetcontainerid":u.tracking.widgetContainerId=t;break;case"widgetcontainerwidth":u.tracking.widgetContainerWidth=t;break;case"widgetinstanceid":u.tracking.widgetInstanceId=t;break;case"widgetuserid":u.tracking.widgetUserId=t;break;case"wdst":u.tracking.widgetDefaultSearchStatusId=t;break;case"zipcode":i&&(u.tracking.ni_zc||u.contact.zip)&&(f=!1);f&&(u.tracking.ni_zc=t,u.contact.zip=t);break;default:r.warn("no match in switch statement to update variable %s",n)}}else{switch(n){case"agebucket":i&&(u.age||u.agebucket)&&(f=!1);f&&delete u.age;break;case"ficobucket":i&&(u.fico||u.ficobucket)&&(f=!1);f&&delete u.fico;break;default:i&&u.hasOwnProperty(n)&&(f=!1)}f&&(u[n]=encodeURIComponent(t))}},h.getMatchingDtoAttributeValue=function(n){var t=this,i="";switch(n.toLowerCase()){case"var1":t.matchingConfig.hasOwnProperty("tracking")&&t.matchingConfig.tracking.hasOwnProperty("ni_var1")?i=t.matchingConfig.tracking.ni_var1:t.matchingConfig.hasOwnProperty("var1")&&(i=t.matchingConfig.var1);break;case"var2":t.matchingConfig.hasOwnProperty("tracking")&&t.matchingConfig.tracking.hasOwnProperty("ni_var2")?i=t.matchingConfig.tracking.ni_var2:t.matchingConfig.hasOwnProperty("var2")&&(i=t.matchingConfig.var2);break;case"var3":t.matchingConfig.hasOwnProperty("tracking")&&t.matchingConfig.tracking.hasOwnProperty("ni_var3")?i=t.matchingConfig.tracking.ni_var3:t.matchingConfig.hasOwnProperty("var3")&&(i=t.matchingConfig.var3);break;case"trn_id":t.matchingConfig.hasOwnProperty("tracking")&&t.matchingConfig.tracking.hasOwnProperty("ni_trn_id")?i=t.matchingConfig.tracking.ni_trn_id:t.matchingConfig.hasOwnProperty("ni_trn_id")?i=t.matchingConfig.ni_trn_id:t.matchingConfig.hasOwnProperty("trn_id")&&(i=t.matchingConfig.trn_id);break;case"single_buyer_redirect":t.matchingConfig.hasOwnProperty("tracking")&&t.matchingConfig.tracking.hasOwnProperty("single_buyer_redirect")?i=t.matchingConfig.tracking.single_buyer_redirect:t.matchingConfig.hasOwnProperty("single_buyer_redirect")&&(i=t.matchingConfig.single_buyer_redirect);break;case"quad_url":t.matchingConfig.hasOwnProperty("tracking")&&t.matchingConfig.tracking.hasOwnProperty("ni_quad_url")?i=t.matchingConfig.tracking.ni_quad_url:t.matchingConfig.hasOwnProperty("ni_quad_url")?i=t.matchingConfig.ni_quad_url:t.matchingConfig.hasOwnProperty("quad_url")&&(i=t.matchingConfig.quad_url);break;case"ext_click_id":t.matchingConfig.hasOwnProperty("tracking")&&t.matchingConfig.tracking.hasOwnProperty("ext_click_id")?i=t.matchingConfig.tracking.ext_click_id:t.matchingConfig.hasOwnProperty("ext_click_id")&&(i=t.matchingConfig.ext_click_id)}return i},h.finalizeMatchingConfig=function(){r.groupStart("finalizing matching configuration for widget instance %s",this.instanceId);var n=0;tt("singleBuyerRedirectDisabled")==="1"&&(n=1);this.widgetSearchCount+=1;this.initialSearchStatusId!==g||this.lightBoxCleared||this.listingLoadCount!==1||(this.widgetSearchCount=1,this.lightBoxCleared=!0);this.updateMatchingDtoAttributeValue("widgetid",this.widgetId);this.updateMatchingDtoAttributeValue("widgetconfigurationid",this.widgetconfigurationid);this.updateMatchingDtoAttributeValue("algoWidgetId",this.algoWidgetId);this.updateMatchingDtoAttributeValue("widgetcontainerid",this.domContainer);this.updateMatchingDtoAttributeValue("widgetinstanceid",this.instanceId);this.updateMatchingDtoAttributeValue("originwidgetinstanceid",this.originwidgetinstanceid);this.updateMatchingDtoAttributeValue("inventorytype",this.inventorytype);this.updateMatchingDtoAttributeValue("widgetposition",this.widgetposition);this.updateMatchingDtoAttributeValue("displaytypename",this.displaytypename);this.updateMatchingDtoAttributeValue("js_session",this.sessionId);this.updateMatchingDtoAttributeValue("pageLoadId",this.pageLoadId);this.updateMatchingDtoAttributeValue("single_buyer_redirect_optout",n);this.updateMatchingDtoAttributeValue("widgetUserId",this.widgetUserId);this.updateMatchingDtoAttributeValue("jsev",ii);this.updateMatchingDtoAttributeValue("ref",this.ref);this.updateMatchingDtoAttributeValue("frm",this.frm);this.updateMatchingDtoAttributeValue("wdst",this.listingLoadCount===0?this.initialSearchStatusId:y);this.updateMatchingDtoAttributeValue("widgetsearchcount",this.widgetSearchCount);this.updateMatchingDtoAttributeValue("priorabtestversionflag",this.priorAbTestVersionFlag);this.originalMatchingResult&&this.originalMatchingResult.listingset&&this.updateMatchingDtoAttributeValue("rootsearchid",this.originalMatchingResult.listingset.rootsearchid);this.domContainerWidth()>0&&this.updateMatchingDtoAttributeValue("widgetcontainerwidth",this.domContainerWidth());this.matchingConfig.hasOwnProperty("tracking")&&(delete this.matchingConfig.tracking.ip,delete this.matchingConfig.tracking.ua);r.groupEnd()},h.addEventListeners=function(){function f(n){n.target.value=n.target.value.replace(/\D/gi,"")}function u(n){var u=n.target,e,f;if(!u.classList.contains("prevent-submit")&&(r.warn("checkToggle on %o",u),u.classList.contains("shmktpl-has-active-state")&&(e=u.classList.contains("active")?u.dataset.uncheckedValue:u.dataset.checkedValue,r.log("setActiveStateForToggleInputAttribute attributeName=%s, value=%s",u.dataset.attributeName,e),i.setActiveStateForToggleInputAttribute(u.dataset.attributeName,e),typeof u.dataset.shmktplSetActiveStateFor!="undefined"&&(f=t.getElementById(u.dataset.shmktplSetActiveStateFor),f&&(e===""||f.classList.contains("active")?f.classList.remove("active"):f.classList.add("active")))),u.classList.contains("shmktpl-submit")||u.parentElement&&u.parentElement.classList.contains("shmktpl-submit")))i.onFormSubmit(n)}r.groupStart("addEventListeners");var i=this;typeof i.onFormSubmit=="function"?r.gather("#"+i.instanceId+" .shmktpl-submit").forEach(function(n){n.tagName==="SELECT"||n.tagName==="INPUT"&&typeof n.type!="undefined"&&n.type!=="button"?(r.log("adding onChange (will submit form) event listener to %o",n),n.addEventListener("change",function(t){if(n.classList.contains("prevent-submit"))r.log("blocking submit handler on %o",n);else i.onFormSubmit(t)})):(r.log("adding submit onClick (will submit form) event listener to %o",n),n.addEventListener("click",function(n){u(n)}),n.classList.contains("shmktpl-has-active-state")&&(n.addEventListener("touchmove",function(){n.dataset.touchMoveActive="1"}),n.addEventListener("touchend",function(t){if(t.preventDefault(),t.stopPropagation(),n.dataset.touchMoveActive==="1"){n.dataset.touchMoveActive="0";return}u(t)})))}):r.warn("%cwidget does not have onFormSubmit handler defined",v);r.gather("#"+i.instanceId+" .shmktpl-has-active-state").forEach(function(n){n.classList.contains("shmktpl-submit")||(r.log("adding click event listener to %o",n),n.adick",function(n){u(n)}),n.addEvtopPropagation();u(n)}))});r.gather("#"+i.instanceId+" ntListener("input",f)});n.setTimeout(function(){var n=i.root.querySelector("#"+i.instanceId+" .js-autofocus");n&&(r.log("auto focusing element %o",n),n.focus())},10);r.groupEnd()},h.setCheckedStateForRadioGroupInputAttribute=function(n,t){for(var u=this,r=u.root.querySelectorAll('[data-attribute-name="'+n+'"]'),i=0;i<r.length;i++)typeof r[i].dataset.checkedValue!="undefined"&&r[i].dataset.checkedValue.toLowerCase()===t.toLowerCase()?r[i].checked=!0:r[i].value.toLowerCase()===t.toLowerCase()&&(r[i].checked=!0)},h.getSelectedDropdownOption=function(n){for(var t,i=0,r=n.options.length;i<r;i++)if(t=n.options[i],t.selected)return t;return null},h.setSelectedDropdownValue=function(n,t){var r,i,u;for(t=unescape(t),i=0,u=n.options.length;i<u;i++)if(r=n.options[i],r.value.toLowerCase()===t.toLowerCase()){r.selected=!0;break}},h.setActiveStateForToggleInputAttribute=function(n,t){var f,r,i;if(typeof n!="undefined"&&typeof t!="undefined")for(f=this,r=f.root.querySelectorAll('[data-attribute-name="'+n+'"]'),u=0;u<r.length;u++)i=r[u],i.dataset.checkedValue.toLowerCase()===t.toLowerCase()?i.classList.add("active"):i.classList.remove("active")},h.updateMatchingDtoWithPublisherDefaults=function(n){var i=this,t=Object.keys(n);for(u=0;u<t.length;u++)i.matchingConfig.hasOwnProperty(t[u])?r.log("matchingConfig already has attribute %s, do not apply default value",t[u]):i.updateMatchingDtoAttributeValue(t[u],n[t[u]],!0)}xtraClickPurn n.self!==n.parenElement.clientWidth:0},h.updateSearchStatus=function(n){var t=this,i;n=n||t.baseSearchStatusId;r.warn("currentWidget.currentSearchStatusId %s",t.currentSearchStatusId);r.warn("currentWidget.newSearchStatusId %s",n);t.currentSearchStatusId!==n&&(r.groupStart("currentWidget.updateSearchStatus"),t.hasOwnProperty("originalMatchingResult")&&t.originalMatchingResult.hasOwnProperty("listingset")&&(r.warn("updating search status to %s",n),i=ri,i=i+"?st="+n+"&si="+t.originalMatchingResult.listingset.searchid+"&sdt="+t.originalMatchingResult.listingset.sdt,r.jsonp(i,function(){t.currentSearchStatusId=n;t.initialSearchStatusId!==g||t.lightBoxCleared||(t.lightBoxCleared=!0)})),r.groupEnd())},h.loadComplete=function(){var n=this;pt.indexOf(n.instanceId)<0?(pt.push(n.instanceId),r.hasOwnProperty("disableWidgetLoadedEvent")&&r.disableWidgetLoadedEvent||(c("sh.widgetLoadComplete"),r.track("widget_load",{widget:n}))):r.warn("event already tracked!!!")},h.logWidgetLoadTime=function(){var n=this,t={metricName:"widget_load_time",type:"timing"},i;o(n.widgetCategory)||(t.categoryName=n.widgetCategory.replace("_ins",""));t.timeTaken=parseInt(performance.now()-et);t.sourceId=n.src;t.inventoryType=n.inventorytype;t.widgetId=n.widgetId;t.deviceType=n.deviceClass;t.instanceId=n.instanceId;t.refUrl=n.ref.indexOf("https")!==-1?n.ref:typeof window.parent.location.href!="undefined"?window.parent.location.href:"";i=new XMLHttpRequest;i.open("POST",fi,!0);i.setRequestHeader("Content-Type","application/json");i.send(JSON.stringify(t))},h.getAdditionalTrackingForPartnerProxyRequest=function(n){var t=this,i={widgetUserId:t.widgetUserId,js_session:t.sessionId,widgetId:t.widgetId,widgetConfigurationId:t.widgetconfigurationid,widgetInstanceId:t.instanceId,widgetContainerId:t.domContainer,widgetContainerWidth:t.domContainerWidth(),widgetDefaultSearchStatusId:t.listingLoadCount===0?t.initialSearchStatusId:y,originWidgetInstanceId:t.originwidgetinstanceid,widgetSearchCount:t.widgetSearchCount,widgetInventoryType:t.inventorytype,pageLoadId:t.pageLoadId,displayTypeName:t.displaytypename};return t.hasOwnProperty("abTestVersion")?i.abTestVersion=t.abTestVersion:t.original_cfg&&t.original_cfg.abTestVersion&&(i.abTestVersion=t.original_cfg.abTestVersion),t.hasOwnProperty("algoWidgetId")&&(i.algoWidgetId=t.algoWidgetId),t.originalMatchingResult&&t.originalMatchingResult.listingset&&t.originalMatchingResult.listingset.rootsearchid?i.rootSearchId=t.originalMatchingResult.listingset.rootsearchid:t.matchingConfig&&t.matchingConfig.rootsearchid&&(i.rootSearchId=t.matchingConfig.rootsearchid),t.options.hasOwnProperty("featuredBuyerId")&&(i.featuredBuyerId=t.options.featuredBuyerId),t.options.hasOwnProperty("featuredBuyerBehavior")&&(i.featuredBuyerBehavior=t.options.featuredBuyerBehavior),n?encodeURIComponent(JSON.stringify(i)):i},ft=f.push(h),r.log("widgetCreated = %o",h),r.groupEnd(),h}function bi(n){var i,u,t,e,f;if(r.groupStart("createMatchingDataFromConfig"),r.log("config passed to function: %o",n),i={},n.hasOwnProperty("data"))i=n.data,n.hasOwnProperty("abTestVersion")&&i.hasOwnProperty("tracking")&&(i.tracking.abTestVersion=n.abTestVersion);else for(u=Object.keys(n),t=0;t<u.length;t++)if(u[t]==="abTestVersion")for(e=Object.keys(n.abTestVersion),f=0;f<e.length;f++)i[e[f].toLowerCase()]=n.abTestVersion[e[f]];else typeof n[u[t]]!="object"&&typeof n[u[t]]!="undefined"&&n[u[t]]!==null&&(i[u[t].toLowerCase()]=n[u[t]]);return r.log("matchingData created: %o",i),r.groupEnd(),i}function k(n,t,i,u,f){var e=new XMLHttpRequest,o,s;e.open("POST",n,!0);o=u?"application/json; charset=UTF-8":"application/x-www-form-urlencoded; charset=UTF-8";e.setRequestHeader("Content-Type",o);e.withCredeeader(n.name,n.value)});s=u?JSON.stringify(t):t;typeof i=="function"&&(e.onreadystatechange=function(){var t,u;e.readyState===XMLHttpRequest.DONE&&(t=e.status,t===0||t>=200&&t<400?i(e.responseText):(u={data:{failedRequestEndpoint:n,statusCode:t}},r.track("http request failed",u),c("sh.listingApiRequestFailed",{})))});e.send(s)}function ki(n,t,i,u){r.groupStart("handleListingsResult");r.log("result = %o",t);typeof i=="function"&&(i(t),di(n,t.response.listingset.widgetUserAttributes));u&&n.addRootCssClass("filtered");n.root.classList.remove("listingsLoading");n.addRootCssClass("listingsLoaded");c("sh.listingsLoaded",t);n.listingLoadCount+=1;r.groupEnd()}function di(n,t){t&&t.widgetinstanceid?(n.responseWidgetUserAttributes=t,n.updateFormSelectionsWithAttributeValues(t),n.updateDynamicContent(n.options),n.updateDynamicContent(t)):n.updateDynamicContent(n.options)}function gi(n){var r=document.createElement("div"),e=document.createElement("div"),i=document.createElement("iframe"),u=document.createElement("div"),o=document.createElement("style"),f;i.src=n;i.width="600";i.height="346";i.id="sh-agency-popup";u.id="sh-agency-close";r.id="sh-agency-wrapper";e.id="sh-agency-container";document.querySelector("body").appendChild(r);document.querySelector("#sh-agency-wrapper").appendChild(e);document.querySelector("#sh-agency-container").appendChild(u);document.querySelector("#sh-agency-container").appendChild(i);document.querySelector("#sh-agency-close").setAttribute("onclick","document.querySelector('#sh-agency-wrapper').remove()");o.innerHTML="#sh-agency-popup{border:0px;overflow: hidden;} #sh-agency-wrapper{position: fixed;top: 0;bottom: 0;right: 0;left: 0;background-color: #2C2C2C67;z-index:10000} #sh-agency-container{height:350px;width:600px;position: absolute;top: 50%;left: 50%;transform: translate(-50%, -50%);background-color: rgb(255, 255, 255);} #sh-agency-close{background-image: url(data:image/svg+xml;base64,PHN2ZyBpZD0iZXJyb3JfMV8iIGRhdGEtbmFtZT0iZXJyb3IgKDEpIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgdmlld0JveD0iMCAwIDIwIDIwIj4KICA8cGF0aCBpZD0iUGF0aF80NjYiIGRhdGEtbmFtZT0iUGF0aCA0NjYiIGQ9Ik0xNy4wNzQsMi45MjVhMTAsMTAsMCwxLDAsMCwxNC4xNDlBMTAuMDE2LDEwLjAxNiwwLDAsMCwxNy4wNzQsMi45MjVabS0zLjEyOSwxMS4wMmEuNzY5Ljc2OSwwLDAsMS0xLjA4OCwwTDEwLDExLjA4OCw3LjAwNywxNC4wODFhLjc2OS43NjksMCwwLDEtMS4wODgtMS4wODhMOC45MTIsMTAsNi4wNTUsNy4xNDNBLjc2OS43NjksMCwwLDEsNy4xNDMsNi4wNTVMMTAsOC45MTJsMi43MjEtMi43MjFhLjc2OS43NjksMCwxLDEsMS4wODgsMS4wODhMMTEuMDg4LDEwbDIuODU3LDIuODU3QS43NjkuNzY5LDAsMCwxLDEzLjk0NSwxMy45NDVaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIDApIi8+Cjwvc3ZnPgo=);height: 20px;width: 20px;z-index: 1;position: absolute;top: -4px;right: -4px;display: none;cursor:pointer;} @media all and (max-width:767px) {#sh-agency-container{width:90%;height:375px;max-width:350px;} #sh-agency-popup{width:100%;height:375px;max-width:350px}}";f=t.getElementsByTagName("head")[0]||t.documentElement;f.insertBefore(o,f.firstChild);nr(u);tr(r)}funstyleon(){n.remove()},1e4)}function ir(){if(!t.hidden)for(u=0;u<f.length;u++)f[u].hasOwnProperty("currentSearchStatusId")&&f[u].currentSearchStatusId===kt&&f[u].updateSearchStatus(f[u].baseSearchStatusId)}var u,ti;if(!n.sh){var r={},h={},ut=0,ft=0,w=!1,ii=3,f=[],et,e="https://www.nextinsure.com",s="/ListingDisplay/",d="",ot=e+s+"handlers/geo.ashx",ri=e+s+"handlers/su.ashx",st=e+s+"handlers/browserinfo.ashx",ht=e+s+"display/",ct=e+s+"handlers/ev.ashx",ui=e+s+"handlers/imp_px.ashx",lt=e+s+"display/PhoneApi.aspx",at=e+s+"widget",vt=e+s+"listings",fi=e+s+"handlers/telemetry.ashx",yt=e+s+"lr/rtis",pt=[],v="background-color:yellow; color:#000; font-weight:bold; padding:5px 0;",l=/localhost|test-nextinsure|nextinsure.test|nextinsure.quinstage/gi.test(e)||/shdebug/gi.test(n.location.href),wt=!/localhost|test-nextinsure|nextinsure.test|nextinsure.quinstage/gi.test(e),bt=/qaTest/gi.test(n.location.href),ei=/shdebug/gi.test(n.location.href),y=1,kt=38,g=39;if(n.document.documentMode&&(l=!1),r.triggerEvent=function(n,t){var i=new Event(n);i.data=t;window.dispatchEvent(i)},r.gather=function(n,i){return i?[].slice.call(i.querySelectorAll(n)):[].slice.call(t.querySelectorAll(n))},r.log=function(){li(arguments)},r.warn=function(){ai(arguction(){vi(arguments)},r.groupStart=function(){l&&console.hasOwnProperty("group")&&typeof console.group=="function"&&console.group.apply(this,arguments)},r.groupEnd=function(){l&&console.hasOwnProperty("groupEnd")&&typeof console.groupEnd=="function"&&console.groupEnd()},r.loadFont=function(n){if(!Array.isArray(n)||n.length===0){r.warn("no fonts to load");return}(r.groupStart("sh.loadFont"),r.log("fonts = %o",n),w)||(typeof ShWebFont=="object"&&(w=!0,ShWebFont.load({google:{families:n},active:functive:function(){w=!1}})),r.groupEnd())},r.displayErrors=function(n){r.warn("form errors: %o",n);n.forEach(function(n){n.classList.add("error");n.tagName==="SELECT"?n.addEventListener("change",function t(){n.classList.remove("error");n.removeEventListener("change",t)}):n.addEventListener("input",function t(){n.classList.remove("error");n.removeEventListener("input",t)})});n.length>0&&n[0].focus()},r.showPage=function(n,t){var i=r.getCurrentWidget(n),u=t>0?"next":t<0?"prev":"first";i.showPage(u)updateSearchStatus(t)},r.getCurrentWidget=function(n){r.groupStart("getCurrentWidget for instanceId %s",n);for(var i=0;i<f.length;i++)if(f[i].instanceId===n)return f[i].root||(r.log("setting widget root"),f[i].root=t.querySelector("#"+n)),r.log("current widget instance %s %o",n,f[i]),r.groupEnd(),f[i];return r.groupEnd(),{}},r.track=function(n,t){var e,h;if(!o(n)){r.groupStart("sh.track");var i=t||{},f={},s=undefined;if(i.hasOwnProperty("widget")&&typeof i.widget=="object"&&!o(i.widget)?(s=i.widget.src,f={TransactionId:i.widget.getMatchingDtoAttributeValue("trn_id"),WidgetInstanceId:i.widget.instanceId,OriginWidgetInstanceId:i.widget.originwidgetinstanceid,DomContainer:i.widget.domContainer,WidgetId:i.widget.widgetId,ListingStyleId:i.widget.widgetId+1e3,DomContainerWidth:i.widget.domContainerWidth(),InventoryType:i.widget.inventorytype,WidgetPosition:i.widget.widgetposition,var1:i.widget.getMatchingDtoAttributeValue("var1"),var2:i.widget.getMatchingDtoAttributeValue("var2"),var3:i.widget.getMatchingDtoAttributeValue("var3"),QuadUrl:i.widget.getMatchingDtoAttributeValue("quad_url"),ExtClickId:i.widget.getMatchingDtoAttributeValue("ext_click_id")},i.widget.hasOwnProperty("abTestVersion")&&(f.WidgetAbTestWidgetId=i.widget.abTestVersion.widgetAbTestWidgetId,f.WidgetAbTestId=i.widget.abTestVersion.widgetAbTestId,f.WidgetAbTestFrequency=i.widget.abTestVersion.frequency,f.WidgetAbTestVersionFlag=i.widget.abTestVersion.flag),n==="widget_load"&&(f.EventId=i.widget.widgetLoadEventId)):i.hasOwnProperty("src")&&typeof i.src!="undefined"&&(s=i.src),i.hasOwnProperty("data")&&typeof i.data=="object")for(e=Object.keys(i.data),u=0;u<e.length;u++)r.log("Adding extra property to event Info %s = %s",e[u],i.data[e[u]]),f[e[u]]=i.data[e[u]];n==="user_visit"&&i.hasOwnProperty("sessionWidgetInstanceId")&&!o(i.sessionWidgetInstanceId)&&(f.WidgetInstanceId=i.sessionWidgetInstanceId);h={event_name:n,session_id:r.currentSessionId,widgetUserId:r.currentWidgetUserId,ref:r.currentPageUrl,frm:r.currentPageReferrer,event_data:p(f)};typeof s!="undefined"&&(h.source_id=s);r.warn("event = %o",h);k(ct,h,null,!0);r.groupEnd()}},r.error=function(n){try{typeof r.errorCallback=="function"&&r.errorCallback(n);console.error(n)}catch(t){console.error(t);return}console.log(n);r.track("js_error",{data:{errObj:n}})},r.enableDirectLinks=function(){var n=r.gather(".shmktpl-direct-link");n.forEach(function(n){n.removeEventListener("click",dt);var t=p(n.dataset),i={src:t.shsrc,data:{widgetId:537,InventoryType:t.shinventorytype,targetBuyer:t.shtarget,var1:t.shvar1,trn_id:t.shtrnid}};r.trackUstListener("click",dt)})},r.getWidgetFromServer=function(n){var i,u,f,e;r.groupStart("sh.getWidgetFromServer");i={src:n.src,idx:n.idx};typeof n.inventorytype!="undefined"&&(i.it=n.inventorytype);typeof n.widgetposition!="undefined"&&(i.wp=n.widgetposition.toLowerCase());typeof n.widgetType!="undefined"&&(i.widgetType=n.widgetType);typeof n.widgetId!="undefined"&&(i.widgetId=n.widgetId);typeof n.widgetFile!="undefined"&&(i.widgetFile=n.widgetFile);typeof n.abTestVersion=="object"&&(i.widgetAbTestWidgetId=n.abTestVersion.widgetAbTestWidgetId,i.widgetId=n.abTestVersion.widgetId,typeof n.abTestVersion.algoWidgetId!="undefined"&&(i.algoWidgetId=n.abTestVersion.algoWidgetId));typeof n.widget!="undefined"&&(i.widget=n.widget);typeof n.devDomain!="undefined"&&(i.devDomain=n.devDomain);o(d)||(i.ak_dc=d);r.log("widgetToLoad %o",n);u=at+it(i);r.log("widget request: %s",u);f=t.scripts[0];e=t.createElement("script");e.src=u;et=performance.now();f.parentNode.insertBefore(e,f);r.groupEnd()},r.processServerWidgetResponse=functin[t],n[t]=n[i],n[i]=r}var p=n[0].widgetAbTestId,t="shmktpl:widgetAbTest:"+p,f,o,c,i,e,s,a,h,v,u;try{if(!ei&&sessionStorage.getItem(t)&&(f=!1,o=JSON.parse(sessionStorage.getItem(t)),o.hasOwnProperty("expires")?(c=Number(o.expires),f=Date.now()>c):f=!0,!f))return r.warn("returning sticky ab test for %s",t),JSON.parse(sessionStorage.getItem(t))}catch(l){r.warn("error accessing sessionStorage: %o",l)}for(i=[],e=0;e<n.length;e++)for(s=n[e],a=s.frequency,h=0;h<a;h++)i.push(s);y(i);v=Math.floor(Math.random()*i.length);u=i[v];u.expires=Date.now()+864e5;r.log("selected test version= %o",u);try{sessionStorage.setItem(t,JSON.stringify(u))}catch(l){r.warn("error accessing sessionStorage: %o",l)}return u}function it(n){function i(n){var f=u[n];if(f){var s=f.text||f.textContent||f.innerHTML||"",e=t.getElementsByTagName("head")[0]||t.documentElement,r=t.createElement("script"),o=f.getAttribute("src");if(o)r.setAttrioad=function(){i(n+1)};else{r.setAttribute("type","text/javascript");try{r.appendChild(t.createTextNode(s))}catch(h){r.text=s}}e.insertBefore(r,e.firstChild);e.removeChild(r);o||i(n+1)}}for(var u=[],f=n.getElementsByTagName("script"),r=0;r<f.length;r++)u.push(f[r]);i(0)}var e,l,k,d,s,g,v,a,p,w,c,b,nt,h;for(r.groupStart("sh.processServerWidgetResponse"),r.log("widgetResponse %o",i),e={},l=0;l<f.length;l++)if(f[l].idx===u){e=f[l];break}if(Array.isArray(i.test_versions)&&i.test_versions.length>0){r.log("Current AB Tests: %o",i.test_versions);k=tt(i.test_versions);sessionStorage.getItem("shmktpl:priorAbTest")||sessionStorage.setItem("shmktpl:priorAbTest",JSON.stringify(k));d=e.original_cfg;d.abTestVersion=k;r.initialize(d,e.domContainer);return}try{if(e.widgetId=i.widgetId,e.currentPage=1,e.inventorytype=i.inventorytype,e.baseinventorytype=i.baseinventorytype,e.widgetposition=i.widgetposition,e.widgetconfigurationid=i.widgetconfigurationid,e.blocks=i.blocks||[],e.pagingConfig=i.pagingConfig||{},e.hiddenInputs=i.hiddeninputs||{},e.initialSearchStatusId=i.initialsearchstatus||y,e.displaytypename=i.displaytypename,s=JSON.parse(i.defaultOptions),r.groupStart("handling widget default options"),r.log("defaultWidgetOptions returned from server %o",s),s)for(g=Object.keys(s),v=0;v<g.length;v++)if(a=g[v],a==="defaultUserAttributes"&&e.options.hasOwnProperty("defaultUserAttributes")){if(p=Object.keys(s.defaultUserAttributes),p)for(w=0;w<p.length;w++)c=p[w],e.options.defaultUserAttributes.hasOwnProperty(c)||(r.log("updating defaultUserAttribute %s to %s",c,s.defaultUserAttributes[c]),e.options.defaultUserAttributes[c]=s.defaultUserAttributes[c])}else e.options.hasOwnProperty(a)||(e.options[a]=s[a]);r.log("final widget options %o",e.options);r.groupEnd();b=t.getElementById(e.domContainer);b&&(nt=i.markup.replace(/randomId/gi,e.instanceId),b.innerHTML=nt,h=t.getElementById(e.instanceId),h&&(o(i.widgetcategory)||(h.classList.add(i.widgetcategory),h.dataset.category=i.widgetcategory,e.widgetCategory=i.widgetcategory),o(i.widgetcategorytype)||(h.classList.add(i.widgetcategorytype),h.dataset.categorytype=i.widgetcategorytype,e.widgetCategoryType=i.widgetcategorytype),e.deviceClass=typeof i.searchtype!="undefined"?i.searchtype===1?"desktop":"mobile":n.outerWidth<600?"mobile":"desktop",typeof i.algoWidgetId!="undefined"&&(e.algoWidgetId=i.algoWidgetId),h.dataset.widgetId=e.widgetId),it(b));e.loadComplete();e.logWidgetLoadTime()}catch(rt){r.error(rt)}r.groupEnd()},r.loadListingsForWidget=function(n,t,i){r.groupStart("calling matching for widget instance %s, isFormSubmission = %s",n.instanceId,i);n.addRootCssClass("listingsLoading");n.finalizeMatchingConfig();i&&n.updateMatchingDtoWithFormSelections();var f=null,u=n.matchingConfig.hasOwnProperty("tracking"),e=u?vt:ht,o=u?n.matchingConfig:it(n.matchingConfig).substr(1);n.apiEndPoint&&(u=!0,e=n.apiEndPoint,o=n.matchingConfig,n.requestHeaders&&(f=n.requestHeaders));r.log("%cmatching data = %o",v,n.matchingConfig);k(e,o,function(r){try{var u=JSON.parse(r);ki(n,u,t,i)}catch(f){}},u,f);r.groupEnd()},r.jsonp=function(i,u){r.groupStart("sh.jsonp");r.log("endpoint = %s",i);var f="sh_jsonp_cb_"+ut,o=t.scripts[0],e=t.createElement("script");e.src=i+(~i.indexOf("?")?"&":"?")+"cb="+f;o.parentNode.insertBefore(e,o);n[f]=function(t){e.parentNode.removeChild(e);u(t);n[f]=undefined;try{delete n[f]}catch(i){return}};ut+=1;r.groupEnd()},r.loadGeo=function(n,t){r.groupStart("sh.loadGeo");var i=ot;typeof t=="string"&&(i=i+"?zc="+t);r.jsonp(i,function(t){typeof n=="function"&&n(t);c("sh.geoLoaded",t)});r.groupEnd()},r.validateZip=function(n,t){r.loadGeo(function(n){t(n&&!n.geotargeted)},n)},r.loadBrowserInfo=function(n){r.groupStart("sh.loadBrowserInfo");r.jsonp(st,function(t){typeof n=="function"&&n(t);c("sh.browserInfoLoaded",t)});r.groupEnd()},r.click=function(t,i,u){var f,e,s;if(!o(i))if(u=u||{},f={adPosition:t,clickUrl:i,data:u},f.data.hasOwnProperty("evt")&&typeof f.data.evt!="undefined"&&typeof f.data.evt.preventDefault=="function"&&(r.log("stopping propogation of click event..."),f.data.evt.preventDefault(),f.data.evt.stopPropagation()),r.log("click occurred: %o",f),c("sh.clickOccurred",f),i.includes("triggerInterstitial=1"))gi(i);else{if(e=navigator.userAgent||navigator.vendor||n.opera,s=u.hasOwnProperty("openInSameWindow")&&u.openInSameWindow,/\[FB(AN|_IAB).*FBAV\/(\d+)/.test(e)||s){n.location.href=i;return}n.open(i)||(n.location.href=i)}},r.callDataPass=function(n,t,i){i=i||{};var u={adPosition:n,clickUrl:t,data:i};r.log("click to call occurred: %o",u);c("sh.clickToCallOccurred",u);k(t)},r.trackUserVisit=function(n){var t=n||{},i=si(!0);t.sessionWidgetInstanceId=i;r.log(t);r.track("user_visit",t)},r.clicktocall=function(i,u,f){c("sh.clicktocallRequest",{adPosition:i});var e=lt+"?"+u;r.jsonp(e,function(i){if(i!==null&&typeof i=="object")if(i.launchCall){var r=i.ccPhoneNum;i.hasOwnProperty("extn")&&!o(i.extn)&&(r=r+","+i.extn.toString());n.location="tel:1"+r}else t.getElementById("ctc-button-"+f).style.display="none",t.getElementById("ctc-result-"+f).style.display="block",t.getElementById("ctc-result-number-"+f).innerHTML=i.formattedNumber})},r.listen=function(n,t){typeof h[n]=="undefined"&&(h[n]=[]);h[n].push(t)},r.unlisten=function(n,t){if(h[n])for(var i=0;i<h[n].length;i++)if(h[n][i]===t){h[n].splice(i,1);break}},r.initialize=function(n,i){var u,f;r.groupStart("sh.initialize");o(i)&&(i=ni(),r.warn("created default container %s",i));typeof i!="undefined"&&(r.log("initializing with widgetConfiguration = %o, domContainer = %s",n,i),t.querySelector("#"+i)?(u=b(n),delete u.abTestVersion,!n.hasOwnProperty("src")&&n.hasOwnProperty("ni_ad_client")&&(n.src=n.ni_ad_client,delete n.ni_ad_client),n.hasOwnProperty("data")&&n.data.hasOwnProperty("tracking")&&typeof n.data.tracking.ni_ad_client!="undefined"&&(n.src=n.data.tracking.ni_ad_client),!n.hasOwnProperty("widgetId")&&n.hasOwnProperty("widgetid")&&(n.widgetId=n.widgetid,delete n.widgetid),f=rt(n,i),f.original_cfg=u,r.getWidgetFromServer(f)):r.warn("domContainer "+i+" does not exist!!!!"),r.groupEnd())},r.initializeWithCustomWidget=function(n,i){if(n.hasOwnProperty("widgetMarkupTagId")&&(r.groupStart("sh.initializeWithCustomWidget"),(typeof i=="undefined"||i===""||i===null)&&(i=ni()),typeof i!="undefined")){var u=b(n),f=rt(n,i);f.original_cfg=u;r.loadBrowserInfo(function(i){r.processServerWidgetResponse({markup:t.getElementById(n.widgetMarkupTagId).innerHTML,widgetId:"99999",widgetcategory:n.widgetcategory||"",widgetcategorytype:n.widgetcategorytype||"",searchtype:i.searchTypeId,defaultOptions:n.defaultOptions||"{}"},0)});r.groupEnd()}},r.formatMoney=function(n,t){if(typeof Intl.NumberFormat=="undefined")return n.toString();var i=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:t});return i.format(n)},r.fadeInElement=function(n,t){n.style.opacity=0;var i=0,r=setInterval(function(){i<1?(i=i+.05,n.style.opacity=i):(clearInterval(r),typeof t=="function"&&t())lement.remoaddEventListener(t,i)},r.optOutOfSingleBuyerRedirect=function(n,t){t.stopPropagation();t.preventDefault();ci("singleBuyerRedirectDisabled","1");r.reloadWidget(n)},r.reloadWidget=function(n){var i=r.getCurrentWidget(n),t=b(i.original_cfg);t.hasOwnProperty("data")&&t.data.hasOwnProperty("tracking")?(delete t.data.tracking.single_buyer_redirect,delete t.data.tracking.buyer):(delete t.single_buyer_redirect,delete t.buyer);r.initialize(t,i.domContaineturn n+" = "+t+"\r\n"}var i=t("host",e);i+=t("ak_dc",d);i+=t("appPath",s);i+=t("geoEndpoint",ot);i+=t("browserInfoEndpoint",st);i+=t("listingsEndpoint",ht);i+=t("eventLogEndpoint",ct);i+=t("clickToCallEndpoint",lt);i+=t("widgetEndpoint",at);i+=t("listingsPostEndpoint",vt);i+=t("localRtisEndpoint",yt);i+=t("rtisEnabled",wt);console.log("%c%s","line-height:2em;",i);for(n in f)console.log("%cwidget instance %s, %o","font-weight:bold; color:blue",f[n].instanceId,fs=function(){return f},r.listen("sh.clickOccurred",function(){typeof dataLayer!="undefined"&&dataLayer.push({event:"shclick"})}),t.addEventListener("visibilitychange",ir),r.currentHost=e,r.currentSessionId=oi(),r.currentWidgetUserId=hi(),r.currentPageUrl=n.location.href,r.currentPageReferrer=t.referrer,r.currentPageLoadId=a(),n.sh=r,wi(),typeof n.sh_ready=="function")n.sh_ready();else if(typeof n.sh_ready=="object"&&Array.isArray(n.sh_ready))for(u=0;u<n.sh_ready.length;u++)ti=n.sh_ready[u],ti()}})(this,this.document,shNunjucks);
typeof Object.assign!="function"&&Object.defineProperty(Object,"assign",{value:function(n){"use strict";var u,i,t,r;if(n===null)throw new TypeError("Cannot convert undefined or null to object");for(u=Object(n),i=1;i<arguments.length;i++)if(t=arguments[i],t!==null)for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(u[r]=t[r]);return u},writable:!0,configurable:!0});
