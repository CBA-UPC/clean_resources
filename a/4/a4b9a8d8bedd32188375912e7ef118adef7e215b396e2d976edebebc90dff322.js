__smjsonp__([5],{355:function(t,n,e){(function(n){function i(){var t=this,n=null;t.get=function(){return t.requestPromise&&!f.isSPA()?t.requestPromise:t.requestPromise=new Promise(function(e,i){if(t.config&&!f.isSPA())return e(t.config);var l=c.urls.war_config,h=c.war_endpoint,p=a.getContactId();(new r).withEndpoint(h).withPath(l).ap("s",o.get("_smapp")+o.get("_smid")).ap("u",p.smuuid).ap("d",window.location.host+window.location.pathname).ap("c",p.smclient).ajaxGet().then(function(i){n&&(clearTimeout(n),n=null,t.config=u.from(i),e(t.config))}).catch(function(){i()}),n=setTimeout(function(){i()},s.WAR_CONFIG_REQUEST_TIMEOUT)})}}var r=e(5),o=e(3),c=e(2),u=e(7),a=e(6),s=e(61),f=e(14);t.exports=new i}).call(n,e(0))},356:function(t,n,e){(function(n){function i(){var t=this,n=null;t.report=function(e){return new Promise(function(i,f){var l=c.urls.war_report,h=c.war_endpoint,p=u.getContactId(),d={s:o.get("_smapp")+o.get("_smid"),id:e.id,smuuid:p.smuuid,smclient:p.smclient};return d.rr=e.rr,t.request=(new r).withEndpoint(h).withPath(l).apo(d).ajaxPost().then(function(t){n&&(clearTimeout(n),n=null,s.add(s.MODULE_KEYS.WAR,e.id),i(t))}).catch(function(){f()}),n=setTimeout(function(){f()},a.WAR_REPORT_REQUEST_TIMEOUT),t.request})}}var r=e(5),o=e(3),c=e(2),u=e(6),a=e(61),s=e(4);t.exports=new i}).call(n,e(0))},361:function(t,n,e){(function(n){var i=e(355),r=e(84),o=e(1),c=e(61),u=e(4),a=function(t,n){var e=JSON.parse(JSON.stringify(t));e.rr=n.rr,e.rrId=n.id;var i="AFTER_X_SECONDS"==n.cfg.st?1e3*n.cfg.v:0;switch(e.warAction=n.cfg,n.cfg.at){case"sp":e.cfg.exit=n.cfg.onExit,e.cfg.delay=i,"BASIC"!==e.type&&(e.exit=!1,e.delayValue=0,e.delay=!1);break;case"scf":case"scc":case"sci":e.delayValue=i}return e},s=function(t,n,e,i){n&&t.war[e]&&n.forEach(function(n){var r=(i||t.war[e]).filter([0];r&&(r=a(r,n),t[e].unshift(r),u.add(u.MODULE_KEYS.WAR,r.id))})};t.exports=function(){var t,n=!1;return{getRunner:initRunner:function(){var e,a=new Promise(function(t){e=setTimeout(function(){t()},c.WAR_PROCESSING_TIMEOUT)}),f={},l=new Promise(function(t){if(n)return t(n);a.then(,f.run=function(r){o.isNotNull(r.war)?(i.get().then(function(i){n||(r.war&&(u.clear(u.MODULE_KEYS.WAR),s(r,i.sp,"p",r.war.p.concat(r.war.pp).concat(r.war.ap).concat(r.war.ip)),s(r,i.scc.concat(i.sci),"c",r.c),s(r,i.scf,"f")),n=r,t(n),clearTimeout(e))},,a.then():t(r)}});return f.processed=l,t=f}}}()}).call(n,e(0))},362:function(t,n,e){var i=e(363);t.exports={isWarAction:function(t){return t.rr},modifyPopupConfig:function(t,n){n.rr=t.rr,n.rrId=t.rrId,"BASIC"!==t.type&&"IMAGE"!==t.type&&"ADVANCED"!==t.type&&(n.popupCfg=t)},scheduleChatActions:getChatToDisplayImmediately:},363:function(t,n,e){var i=e(356),r=function(){var t=this;t.enabled=!0,t.ACTION_INTERVAL=1e4};r.prototype.enqueue=function(t,n){var e=this;return new Promise(function(i,r){e.enabled&&(0===n.delayValue?c(t,n).then(function(){i()},function(){r()}):setTimeout(function(){e.enabled&&c(t,n).then(function(){i()},},n.delayValue))})},r.prototype.setOnStateChange=function(t,n){this.enabled=!t||"fake-conversation"==t};var o=c=function(t,n){return new Promise(function(e,i){switch(n.warAction.at){case"scc":t.showWithMessage(o(n.warAction.content)).then(function(t){!0===t&&e(),!1===t&&i()});break;case"sci":var r=t.setBanner({html:o(n.warAction.content)});!0===r&&e(),!1===r&&i()}})},u=function(){var t=this;t.scheduler=new r,t.setOnStateChange=this.scheduler.setOnStateChange};u.prototype.scheduleChatActions=function(t,n,e){var r=this,o=!1;e.setOnStateChange=r.setOnStateChange,r.scheduler.enabled=!e.state.enabled,setTimeout(function(){n.c.filter(function(t){return t&&t.warAction&&e.chatId==t.id}).forEach(function(t){o=!0,r.scheduler.enqueue(e,t).then(function(){i.report({rr:t.rr,id:t.rrId})})}),o||("EXPANDED"===e.config.display&&e.config.welcomeMessage.show?e.showWithMessage(e.config.welcomeMessage.content.text):"EXPANDED"===e.config.display?e.vm.toggleChat():"WIDGET"===e.config.display&&e.setBanner())})},u.prototype.getChatToDisplayImmediately=t.exports=new u},364:function(t,n,e){var i=e(365),r=e(355),o=e(356),c=e(4);t.exports={run:function(){r.get().then(function(t){t.ecs.forEach(function(t){c.has(c.MODULE_KEYS.WAR,t.id)||i.schedule(t.cfg.scr,{delay:"IMMEDIATELY"!==t.cfg.st?1e3*t.cfg.v:0}).then(})}).catch(function(){})}}},365:function(module,exports){var CustomScriptExecutor=CustomScriptExecutor.prototype.execute=CustomScriptExecutor.prototype.schedule=function(t,n){var e=this;return new Promise(function(i){"number"==typeof n.delay&&n.delay>0?setTimeout(n.delay):(i(),e.execute(t))})},module.exports=new CustomScriptExecutor},83:function(t,n,e){t.exports=new function(){this.Config=e(355),this.Properties=e(61),this.QueueModifier=e(361),this.Reporter=e(356),this.Utils=e(362),this.WarCSExecutor=e(364)}}});