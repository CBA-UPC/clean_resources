(function(){"use strict";var z={1281:function(v,h){Object.defineProperty(h,"__esModule",{value:!0});function s(g,m){var f=Object.prototype.toString.call(m).slice(8,-1);return m!=null&&f===g}h.default=s},130:function(v,h,s){var g;g={value:!0};var m=s(7504),f=s(9166),l=s(9667),_=s(5279);function b(L,w){if(!(0,_.default)(L))return w;var O=(0,l.default)(L);if(O.length===0)return w;w=(0,f.default)(O,w);var C=(0,m.default)(L);return w+=/(\?|&)$/.test(w)?""+C:/\?/.test(w)?"&"+C:"?"+C,w}h.Z=b},9667:function(v,h,s){Object.defineProperty(h,"__esModule",{value:!0});var g=s(8807),m=s(5279);function f(l){if(!(0,m.default)(l))return[];var _=[];return(0,g.default)(l,,_}h.default=f},4986:function(v,h){var s;s={value:!0};var g={get:set:function(m,f,l){l===void 0&&(l={});var _=new Date,b=l.domain==="*"?"":l.domain||"pay.qq.com",L=l.path||"/",w=31536e7,O=l.time||w;_.setTime(_.getTime()+O);var C=m+"="+f+"; path="+L;b&&(C+="; domain="+b),!l.ignoreTime&&(C+="; expires="+_.toUTCString()),document.cookie=C},del:function(m,f){f===void 0&&(f={}),f.time=-new Date,g.set(m,"",f)}};h.Z=g},9166:function(v,h,s){Object.defineProperty(h,"__esModule",{value:!0});var g=s(8807);function m(f,l){return l===void 0&&(l=location.href),f instanceof Array||(f=[f]),l=l.replace(/[\r\n]/g,""),(0,g.default)(f,function(_){l=l.replace(new RegExp("(?:&"+_+"=[^&]*)","g"),""),l=l.replace(new RegExp("(?:\\?"+_+"=[^&]*&?)","g"),"?")}),l}h.default=m},8807:function(v,h,s){Object.defineProperty(h,"__esModule",{value:!0});var g=s(6961);function m(f,l){var _,b=0;if((0,g.default)(f)){var L=f.length;for(_=f[0];b<L&&l.call(_,_,b,f)!==!1;_=f[++b]);}else for(var w in f)if(l.call(f[w],f[w],w,f)===!1)break;return f}h.default=m},5974:function(v,h,s){var g;g={value:!0};var m=s(7411);function f(l,_){return(0,m.default)(_)[l]}h.Z=f},7411:function(v,h){Object.defineProperty(h,"__esModule",{value:!0});var s={};function g(m,f,l){m===void 0&&(m=location.href),f===void 0&&(f="&"),l===void 0&&(l="=");var _=m.replace(/.+?\?/,"").replace(/#.*/,""),b=_.split(f);return s[_]||(s[_]=b.reduce(function(L,w){var O=w.indexOf(l);if(O>-1){var C=w.substr(0,O);if(C){var x=w.substr(O+1);try{L[C]=decodeURIComponent(x)}catch(E){L[C]=x}}}return L},{})),s[_]}h.default=g},6961:function(v,h,s){Object.defineProperty(h,"__esModule",{value:!0});var g=s(1281);function m(f){return(0,g.default)("Array",f)}h.default=m},9837:function(v,h,s){Object.defineProperty(h,"__esModule",{value:!0});var g=s(1281);.default=m},5279:function(v,h,s){Object.defineProperty(h,"__esModule",{value:!0});var g=s(1281);function m(f){return(0,g.default)("Object",f)&&f!==null}h.default=m},5926:function(v,h,s){var g;g={value:!0};var m=s(9345);function f(l,_,b,L){var w=document.getElementsByTagName("head")[0],O=document.createElement("script"),C=null,x=function(){U(),(0,m.default)(_,!0)},E=function(){U(),(0,m.default)(_,!1)},U=function(){if(!!O){try{O.src=""}catch(M){}O.removeEventListener("load",x),O.removeEventListener("error",E),w.removeChild(O),O=null,C&&(clearTimeout(C),C=null)}};return O.addEventListener("load",x),O.addEventListener("error",E),O.charset=b||"utf-8",O.src=l,w.insertBefore(O,w.firstChild),L&&(C=window.setTimeout(function(){U(),(0,m.default)(_,null)},L*1e3)),O}h.Z=f},2564:function(v,h,s){var g;g={value:!0};var m=s(8807),f=s(5279);function l(_,b){if(!(0,f.default)(_))return _;var L={};return(0,m.default)(_,,L}h.Z=l},9345:function(v,h,s){Object.defineProperty(h,"__esModule",{value:!0});var g=s(655),m=s(6961),f=s(9837);function l(_){for(var b=[],L=1;L<arguments.length;L++)b[L-1]=arguments[L];return(0,f.default)(_)?(0,m.default)(b[0])?_.call.apply(_,(0,g.__spreadArray)([null],b[0],!1)):_.call.apply(_,(0,g.__spreadArray)([null],b,!1)):null}h.default=l},7504:function(v,h,s){Object.defineProperty(h,"__esModule",{value:!0});var g=s(5279);function m(f,l){if(l===void 0&&(l=!0),!(0,g.default)(f))return"";var _=[];for(var b in f)if(Object.prototype.hasOwnProperty.call(f,b)&&typeof f[b]!="undefined"&&f[b]!==null){var L=l?encodeURIComponent(b):b,w=l?encodeURIComponent(f[b]):f[b];_.push(L+"="+w)}return _.join("&")}h.default=m},655:function(v,h,s){s.r(h),s.d(h,{__extends:function(){return m},__assign:function(){return f},__rest:function(){return l},__decorate:function(){return _},__param:function(){return b},__metadata:function(){return L},__awaiter:function(){return w},__generator:function(){return O},__createBinding:function(){return C},__exportStar:function(){return x},__values:function(){return E},__read:function(){return U},__spread:function(){return M},__spreadArrays:function(){return W},__spreadArray:function(){return R},__await:function(){return B},__asyncGenerator:function(){return N},__asyncDelegator:function(){return X},__asyncValues:function(){return ee},__makeTemplateObject:function(){return J},__importStar:function(){return Z},__importDefault:function(){return V},__classPrivateFieldGet:function(){return q},__classPrivateFieldSet:function(){return Y}});/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var g=ar f=function(){return f=Object.assign||function(c){for(var r,e=1,t=arguments.length;e<t;e++){r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(c[n]=r[n])}return c},f.apply(this,arguments)};Object.create?t.create?={};.m=z,),),),),function(){S.miniCssF=(),),),),function(){var v={},h={};S.f.remotes=function(s,g){S.o(v,s)&&v[s].forEach(function(m){var f=S.R;f||(f=[]);var l=h[m];if(!(f.indexOf(l)>=0)){if(f.push(l),l.p)return g.push(l.p);var _=function(C){C||(C=new Error("Container missing")),typeof C.message=="string"&&(C.message+=`
while loading "`+l[1]+'" from '+l[2]),z[m]=l.p=0},b=function(C,x,E,U,M,W){try{var R=C(x,E);if(R&&R.then){var B=R.then(_);if(W)g.push(l.p=B);else return B}else return M(R,U,W)}catch(N){_(N)}},L=w=O=function(C){l.p=1,z[m]=;b(S,l[2],0,0,L,1)}})}}(),function(){S.S={};var v={},h={};S.I=function(s,g){g||(g=[]);var m=h[s];if(m||(m=h[s]={}),!(g.indexOf(m)>=0)){if(g.push(m),v[s])return v[s];S.o(S.S,s)||(S.S[s]={});var f=S.S[s],l=function(O){return typeof console!="undefined"&&console.warn&&console.warn(O)},_="web",b=L=function(O){var C=try{var x=S(O);if(!x)return;var E=if(x.then)return w.push(x.then(E,C));var U=E(x);if(U&&U.then)return w.push(U.catch(C))}catch(M){C(M)}},w=[];switch(s){}return w.length?v[s]=Promise.all(w).then(:v[s]=1}}}(),),function(){var v={175:0};S.f.j=function(g,m){var f=S.o(v,g)?v[g]:void 0;if(f!==0)if(f)m.push(f[2]);else{var l=new Promise(;m.push(f[2]=l);var _=S.p+S.u(g),b=new Error,L=S.l(_,L,"chunk-"+g,g)}};var h=function(g,m){var f=m[0],l=m[1],_=m[2],b,L,w=0;if(f.some(){for(b in l)S.o(l,b)&&(S.m[b]=l[b]);if(_)var O=_(S)}for(g&&g(m);w<f.length;w++)L=f[w],S.o(v,L)&&v[L]&&v[L][0](),v[f[w]]=0},s=self.webpackChunkweb=self.webpackChunkweb||[];s.forEach(h.bind(null,0)),s.push=h.bind(null,s.push.bind(s))}();var re={};(function(){var v=S(130),h=S(5974),s=S(5926),g=S(2564),m=function(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),i,a=[],d;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(u){d={error:u}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(d)throw d.error}}return a},f=function l(r){var e=Date.now(),t=r(),n=Date.now()-e;return{times:n,result:t}}function _(r){return btoa(String.fromCharCode.apply(String,f([],m(r.match(/../g).map(),!1)))}var b=function(r,e){var t=window.report;if(t&&typeof t.custom=="function")return t.custom(r,e);if(typeof t=="function")return t("midasbuy.custom."+r,e)};function L(){var r,e=(r=document.getElementById("xMidasToken"))===null||r===void 0?void 0:r.value;if(!e)return b("xmidas.no.token");try{var t=l(function(){return window.xMidas()}),n=t.result||[];b("xmidas.init",{times:t.times}),n.length>0&&b("xmidas.init.result",{result:n.join(",")})}catch(i){}}function w(r,e){var t=e==="goServer"?JSON.stringify(r):JSON.stringify((0,g.Z)(r,function(d){return typeof d!="undefined"&&typeof d!="object"?String(d):d})),n=document.getElementById("xMidasToken").value;if(!n)return r;var i=document.getElementById("xMidasVersion").value,a=l(function(){try{return window.xMidas({d:t})}catch(d){return r}});return a.result?(b("xmidas.encrypt",{times:a.times}),{encrypt_msg:_(a.result),ctoken_ver:i,ctoken:n}):(b("xmidas.error",{times:a.times}),r)}var O=S(7504),C="lipassTempToken";function x(){var r="";try{r=sessionStorage.getItem(C)}catch(e){}return r?{"IN-FRAME":window.self===window.top?"0":"1","LI-PASS-TOKEN":r}:null}var E=x,U=function M(r){var e=r===void 0?{}:r,t=e.method,n=t===void 0?"GET":t,i=e.url,a=e.param,d=a===void 0?{}:a,u=e.headers,P=u===void 0?{}:u,p=e.timeout,k=e.dataType,y=new XMLHttpRequest;n==="GET"?(i=(0,v.Z)(d,i),y.open(n,i,!0)):(y.open(n,i,!0),k==="json"?y.setRequestHeader("Content-Type","application/json"):y.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));var I=E();I&&(P=Object.assign({},P,I)),Object.entries(P).forEach(;var F;return new Promise(function(D,j){var A=!1;y.onreadystatechange=function(){if(y.readyState===4){if(clearTimeout(F),A)return;if(y.status>=200&&y.status<300)try{return D(JSON.parse(y.responseText))}catch($){return j({ret:-9995,path:i,msg:"System busy, please try again later\uFF01(-9995)"})}else y.status>=300?j({ret:-9994,path:i,msg:"System busy, please try again later\uFF01(-9994-"+y.status+")"}):j({ret:-9993,path:i,msg:"System busy, please try again later\uFF01(-9993)"})}},p&&(F=setTimeout(function(){A=!0;try{y.abort()}catch($){}return j({ret:-9997,path:i,msg:"\u5BF9\u4E0D\u8D77\uFF0C\u8BF7\u6C42\u8D85\u65F6\uFF01"})},p*1e3));var H;n==="POST"&&(H=k==="json"?JSON.stringify(d):(0,O.default)(d)),y.send(H)})}var W=R=W,B=S(4986),N=window.report;function X(){var r=B.Z.get("UUID")||window.__Report_INFO.tid||"",e=navigator.platform.toLowerCase(),t=!!window.navigator.cookieEnabled,n=navigator.userAgent,i=B.Z.get("device_id")||"",a=window.fingerprint||"",d=[r,e,t,"",n,i,window.currentLang||"en",a];return d.map(.join(",")}function ee(r,e){return new Promise(function(t){if(window.___Kepler_WebTicket){var n="KeplerTicket="+fixedEncodeURIComponent(window.___Kepler_WebTicket);r[e]=r[e]||"",r[e]+=r[e]?"&"+n:""+n,t(r)}else window.TencentKepler?(window.TencentKepler.predict(function(i){var a="KeplerTicket="+fixedEncodeURIComponent(i);r[e]=r[e]||"",r[e]+=r[e]?"&"+a:""+a,t(r)}),N==null||N.custom("async.kepler",{})):t(r)})}function J(r){return r.browser_info=X(),new Promise(function(e){window.___Kepler_WebTicket?(r.rc_extra=R("KeplerTicket="+R(window.___Kepler_WebTicket)),e(r)):window.TencentKepler?(window.TencentKepler.predict(function(t){r.rc_extra=R("KeplerTicket="+R(t)),e(r)}),N==null||N.custom("async.kepler",{})):e(r)})}var T=Z=V=q={},Y=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform),o=function(){function r(){this.preOverflow="",this.prePosition="",this.preWidth="",this.preTop="",this.params={country:"ot",pageConfig:q,hash:"#login",host:location.hostname,goServerUrl:"",user:null,preload:!1,hasInit:!1,hasLoaded:!1,lang:""},this.loginConfig={loginKey:"",enabledSig:!0,goVersion:""},this.csrftoken="",this.initParams={},this.callback={loginSuccessCallback:function(){},facebookLoginSuccessCallback:function(){},lipassLoginSuccessCallback:function(){},registerSuccessCallback:function(){},resetSuccessCallback:function(){},loginedCallback:function(){},closeIframeCallback:function(){},loginFailCallback:function(){},initFailCallback:function(){},checkCsrfFailCallback:function(){},iframeLoadedCallback:function(){},initLoginSuccessCallback:function(){}},this.loginInterface={getLoginInfo:"/interface/getLoginInfoV2"},this.initMidasLogin()}return r.prototype.showLoginIframe=function(){this.params.preload?this.toggleIframe("visible"):this.loadHtml()},r.prototype.handleCallback=function(e){var t=e.user,n=e.action,i=this.handleUserData(t),a=["loginSuccess","facebookLoginSuccess","lipassLoginSuccess","registerSuccess","resetSuccess","activeSuccess","linkSuccess","tofLoginSuccess","googleLoginSuccess","lipassLoginSuccess"],d=["loginFail","confirmLinkFail","linkFail","checkCsrfFail"],u=this.callback[n+"Callback"];a.indexOf(n)!==-1&&(u=this.callback.loginSuccessCallback),d.indexOf(n)!==-1&&(u=this.callback.loginFailCallback),u&&u(T(T({},e),{user:i,from:this.params.pageConfig.from}))},r.prototype.handleBindOpenidParams=function(){var e=(0,h.Z)("appid");!this.params.pageConfig.appid&&e&&(this.params.pageConfig.appid=e),this.params.lang&&(this.params.pageConfig.lang=this.params.lang)},r.prototype.handleInitParams=function(e){!e||(this.initParams=T({},e),this.params=T(T(T({},this.params),e),{pageConfig:T(T({},q),e.pageConfig)}),this.handleBindOpenidParams())},r.prototype.handleLoginParams=function(e){if(!e){this.params.hash="#login";return}e.preload===!0&&delete e.preload,e.hash||(e.hash="#login"),this.params=T(T(T({},this.params),e),{pageConfig:T(T(T({},q),this.params.hasInit&&this.initParams.pageConfig?this.initParams.pageConfig:{}),e.pageConfig)}),this.handleBindOpenidParams()},r.prototype.getIframe=r.prototype.waitForIframeLoad=function(e){var t=this,n=setInterval(function(){t.params.hasLoaded&&(e(),clearInterval(n))},50)},r.prototype.toggleLockBackground=function(e){var t,n,i,a,d,u,P;if(!!((t=document.body)===null||t===void 0?void 0:t.style))if(e==="lock")this.preOverflow=((i=(n=document.body)===null||n===void 0?void 0:n.style)===null||i===void 0?void 0:i.overflow)||"",this.prePosition=((d=(a=document.body)===null||a===void 0?void 0:a.style)===null||d===void 0?void 0:d.position)||"",this.preWidth=((P=(u=document.body)===null||u===void 0?void 0:u.style)===null||P===void 0?void 0:P.width)||"",this.preTop=document.body.style.top||"",Y&&(document.body.style.top="-"+window.scrollY+"px",document.body.style.position="fixed",document.body.style.width="100%"),document.body.style.overflow="hidden";else{var p=document.body.style.top;document.body.style.position=this.prePosition,document.body.style.width=this.preWidth,document.body.style.top=this.preTop,document.body.style.overflow=this.preOverflow,window.scrollTo(0,parseInt(p||"0",10)*-1)}},r.prototype.toggleIframe=function(e){var t=this;e===void 0&&(e="visible");var n=this.getIframe();if(!!n){var i=function(){var a;t.params.pageConfig.report=e==="visible",e==="visible"&&(n.src=""+n.src.replace(/#.+/,t.params.hash)),(a=n.contentWindow)===null||a===void 0||a.postMessage(JSON.stringify({action:"changePageConfig",pageConfig:t.params.pageConfig}),"*"),n.style.visibility=e,n.style.left=e==="visible"?0:"-5000px",t.toggleLockBackground(e==="visible"?"lock":"unlock")};e==="visible"?this.waitForIframeLoad(i):i()}},r.prototype.loadScriptPromise=function(e){return new Promise(function(t,n){(0,s.Z)(e,function(i){i?t(i):n(new Error("loadScript "+e+" fail: "+i))})})},r.prototype.waitForXMidas=function(){var e=this;return new Promise(function(t,n){var i=!1,a=setInterval(function(){return Z(e,void 0,void 0,function(){return V(this,function(d){return"xMidas"in window&&(clearInterval(a),i=!0,L(),t()),[2]})})},50);setTimeout(function(){i||(console.error("window.xMidas function is not loaded"),clearInterval(a),n())},5e3)})},r.prototype.loginInfoRequest=function(e){var t=this;e===void 0&&(e={});var n=this.params.host||location.host,i=document.getElementById("xMidasToken"),a=i?this.waitForXMidas().catch(:this.loadScriptPromise("/xmidas-sdk.js").then(.catch(;return a.then(function(){return M({url:"https://"+n+t.loginInterface.getLoginInfo,method:"GET",timeout:5,param:T(T({},w(T(T({},e),{appid:t.params.pageConfig.appid,ts:Date.now()}))),{_r:Math.random()})}).then(function(d){if(d&&d.ret===0)return d.data;throw d}).catch(})},r.prototype.setStyle=r.prototype.createElement=function(e){var t=this,n=e.tag,i=e.attr,a=e.children,d=document.createElement(n);return Object.keys(i).forEach(function(u){var P=typeof i[u];u==="style"?t.setStyle(d,i.style):P==="function"?d.addEventListener(u,i[u]):d.setAttribute(u,i[u])}),a&&a.length?a.forEach(function(u){d.appendChild(t.createElement(u))}):typeof a=="string"&&(d.innerHTML=a),d},r.prototype.createDocument=function(e){var t=this,n=document.createDocumentFragment();return e.forEach(,n},r.prototype.getDomTree=function(){var e,t={width:"100%",height:"100%",visibility:"hidden",position:"fixed",left:"-5000px",top:0,zIndex:1e16,overflow:"hidden",border:"medium none"},n=this.params.pageConfig||{},i=this.params.host||location.host,a=(0,v.Z)(n,"https://"+i+"/apps/login/home/"+(((e=this.params.country)===null||e===void 0?void 0:e.toLowerCase())||"ot"));return this.params.hash&&(a+=this.params.hash),[{tag:"iframe",attr:{name:"iframe-window",id:"login-iframe",style:t,src:a}}]},r.prototype.loadHtml=function(){var e=this.getIframe();if(e){this.toggleIframe("visible");return}var t=document.getElementsByTagName("body")[0],n=this.getDomTree();t.appendChild(this.createDocument(n))},r.prototype.registerMessageEvent=function(){var e=this;window.addEventListener("message",function(t){var n=t.origin,i=t.data,a;try{a=JSON.parse(i)}catch(I){}var d=/(\.midasbuy\.com|\.360mobi\.vn|\.zing\.vn)$/;if(!(!d.test(n)&&location.origin!==n||!a)){var u=a.status,P=a.user,p=a.action,k=a.msg,y=a.errorCode;switch(p){case"iframeLoad":e.handleCallback({status:u,action:p}),!e.params.preload&&!e.params.hasLoaded&&e.toggleIframe("visible"),e.params.hasLoaded=!0;break;case"closeIframe":e.handleCallback({status:u,action:p}),e.hideLoginIframe();break;case"linkFail":case"confirmLinkFail":case"otherFail":e.handleFail({status:u,action:p,errorCode:y,msg:k});break;case"oauthSuccess":case"oauthCancel":e.handleCallback({status:u,action:p,errorCode:y,msg:k});break;case"loginSuccess":e.handleSuccess({status:u,action:p,user:P},"login");break;case"facebookLoginSuccess":e.handleSuccess({status:u,action:p,user:P},"fbLogin");break;case"lipassLoginSuccess":case"googleLoginSuccess":case"tofLoginSuccess":case"lipassLoginSuccess":e.handleSuccess({status:u,action:p,user:P});break;case"linkSuccess":e.handleSuccess({status:u,action:p,user:P},"linkSuccess");break;case"activeSuccess":e.handleSuccess({status:u,action:p,user:P},"activeSuccess");break;case"loginFail":e.handleFail({status:u,action:p,msg:k});break;case"registerSuccess":e.handleSuccess({status:u,action:p},"register");break;case"resetSuccess":e.handleSuccess({status:u,action:p},"reset");break;case"checkCsrfFail":e.handleFail({status:u,action:p,msg:k});break;default:break}}})},r.prototype.handleUserData=function(e){if(!e)return null;var t={email:e.email||e.Email,userName:e.userName||e.UserName,avatar:e.avatarUrl||e.Avatar,uid:e.uid||e.Uid},n=T(T({},e),t);return n.Token&&delete n.Token,n},r.prototype.handleFail=function(e){var t=e.action;this.handleCallback(e),(t==="confirmLinkFail"||t==="otherFail")&&this.hideLoginIframe()},r.prototype.handleSuccess=function(e,t){var n=this;t===void 0&&(t="login"),this.loginInfoRequest().then(function(i){var a=i.user,d=i.goServerUrl;n.params.user=a,n.params.goServerUrl=n.params.goServerUrl||d,n.handleCallback(T(T({},e),{user:a})),n.hideLoginIframe()}).catch(function(i){var a={login:{status:1003,action:"loginFail"},register:{status:1004,action:"registerFail"},reset:{status:1005,action:"resetFail"},fbLogin:{status:1006,action:"fbLoginFail"},linkAccount:{status:1010,action:"linkAccountFail"},activeAccount:{status:1011,action:"linkAccountFail"}};n.handleCallback({status:a[t].status,action:a[t].action,msg:"handleSuccess.error: "+i})})},r.prototype.initMidasLogin=function(){var e=this;this.registerMessageEvent(),this.loginInfoRequest().then(function(t){e.params.goServerUrl=t.goServerUrl,e.params.user=t.user,e.loginConfig=t.loginConfig,e.csrftoken=t.csrftoken||"",e.params.pageConfig.appid||(e.params.pageConfig.appid=t.gameAppid),e.handleCallback({status:200,action:"initLoginSuccess"})}).catch(function(t){e.handleCallback({status:1001,action:"initFail",msg:"initMidasLogin.error: "+t})})},r.prototype.getGoHeaders=function(e){var t,n;return Z(this,void 0,void 0,function(){var i,a,d,u,P,p,k,y,I;return V(this,function(F){switch(F.label){case 0:return i={},a=this.loginConfig||{},d=a.goVersion,u=a.enabledSig,P=a.loginKey,d&&(i.versions=d),u?(p=Math.floor(Date.now()/1e3),i.Csrftokentime=p,[4,S.e(153).then(S.t.bind(S,2153,23))]):[3,2];case 1:k=F.sent(),y=""+JSON.stringify(e)+P+p,I=(n=(t=k==null?void 0:k.default)===null||t===void 0?void 0:t.call(k,y))===null||n===void 0?void 0:n.toString(),i.Csrftokenv2=I,F.label=2;case 2:return[2,i]}})})},r.prototype.on=function(e,t){!e||!t||(this.callback[e+"Callback"]=t)},r.prototype.login=function(e){var t=this;this.handleLoginParams(e),this.loginInfoRequest().then(function(n){var i,a,d=n.user,u=n.goServerUrl,P=n.loginConfig;if(t.loginConfig=P,t.params.user=d,t.params.goServerUrl=t.params.goServerUrl||u,t.params.pageConfig.appid||(t.params.pageConfig.appid=n.gameAppid),!d)return t.showLoginIframe();if(!d.currentBindUser&&t.params.pageConfig.appid){var p=(a=(i=P==null?void 0:P.bindOpenidReferrerRegExpList)===null||i===void 0?void 0:i.some)===null||a===void 0?void 0:a.call(i,,k=!t.params.pageConfig.noBindAfterLogin&&(p||t.params.pageConfig.bindAfterLogin);if(k)return t.params.hash="#bind-openid",t.showLoginIframe()}if(t.params.hash==="#bind-openid")return t.showLoginIframe();var y=t.params.hash,I=["#third-party-add-info","#confirm-link-account","#complete-email-account","#authorize-confirm","#result-page","#application-login","#lipass-login","#login"];return I.indexOf(y)!==-1?t.showLoginIframe():t.handleCallback({status:201,action:"logined",msg:"login.error: user has login",user:t.params.user})}).catch(function(n){t.handleCallback({status:1002,action:"loginFail",msg:"login.error: "+n})})},r.prototype.logout=function(e,t,n){if(!this.params.goServerUrl){n&&n({status:1009,action:"logoutFail",msg:"get goServerUrl.error"});return}var i=this.params.goServerUrl+"/logout";M({url:i,method:"POST",timeout:5,dataType:"json",param:{endpoint_type:"browser"}}).then(function(){t&&t({status:200,action:"logoutSuccess",msg:"logout.success"})}).catch(function(a){n&&n({status:1007,action:"logoutFail",msg:"logout.error: "+a})})},r.prototype.hideLoginIframe=r.prototype.checkLogin=function(e,t){this.loginInfoRequest().then(function(n){var i=n.user;e&&e({status:200,action:"checkLoginSuccess",user:i})}).catch(function(n){t&&t({status:1008,action:"checkLoginFail",msg:"checkLogin.error: "+n})})},r.prototype.init=function(e){this.params.hasInit||(this.params.hasInit=!0,this.handleInitParams(e),this.params.preload&&this.loadHtml())},r.prototype.thirdPartyLogin=function(e){var t,n=e.thirdPartyType,i=n===void 0?"facebook":n,a=e.loginCallback,d=e.country,u=d===void 0?"ot":d,P=e.pageConfig,p=P===void 0?{}:P,k=if(i==="lipass")return this.login({hash:"#lipass-login",country:u,pageConfig:p});var y=location.href;(p==null?void 0:p.from)==="bind-pop-easy-login"&&(y=((t=parent==null?void 0:parent.location)===null||t===void 0?void 0:t.href)||"https://www.midasbuy.com"),window.__ThirdPartyLoginCallback=a||k;var I="https://"+location.hostname+"/apps/login/callback/login-callback-new?success=thirdPartyLogin&thirdPartyType="+i+"&redirect="+encodeURIComponent(y)+"&country="+u.toLowerCase()+"&pageFrom="+((p==null?void 0:p.from)||"");window.open(I)},r.prototype.signUp=function(){var e,t=this.getIframe();(e=t==null?void 0:t.contentWindow)===null||e===void 0||e.switchModule("sign-up"),this.login()},r.prototype.createMidasbuyUser=function(e){return Z(this,void 0,void 0,function(){var t,n,i,a,d,u,P,p,k,y,I,F,D,j,A,H,$,te,ne,K;return V(this,function(G){switch(G.label){case 0:if(typeof window.xMidas!="function")throw new Error("xMidas-sdk is needed");G.label=1;case 1:return G.trys.push([1,5,,6]),this.params.goServerUrl?(t=e||{},n=t.openid,i=t.token,a=t.gameId,d=t.channelId,!n||!i||!a||!d?[2,{ret:1,msg:"createMidasbuyUser.error: openid or token is invalid"}]:(u={type:"toweroffantasy",intlgame_open_id:n,intlgame_token:i,csrftoken:this.csrftoken,intlgame_game_id:a,intlgame_channel_id:d},P=this.params.goServerUrl+"/login",[4,J(u)])):[2,{ret:1,msg:"createMidasbuyUser.error: goServerUrl is invalid"}];case 2:return p=G.sent(),[4,this.getGoHeaders(p)];case 3:return k=G.sent(),[4,M({url:P,method:"POST",timeout:5,dataType:"json",headers:k,param:T({},p)})];case 4:return y=G.sent(),(y==null?void 0:y.ret)===0?(I=(y==null?void 0:y.data)||{},F=I.Uid,D=I.Platform,j=I.PlatformOpenId,A=I.UserName,H=I.ErrorCode,$=I.Email,te=I.Token,ne={uid:F,providerType:D,other:{"toweroffantasy-openid":j},userName:A,email:$,ErrorCode:H,token:te},[2,{ret:0,data:ne}]):[2,{ret:1,msg:"createMidasbuyUser.error: "+(y==null?void 0:y.msg)}];case 5:return K=G.sent(),[2,{ret:1,msg:"createMidasbuyUser.error: "+((K==null?void 0:K.msg)||(K==null?void 0:K.message)||K)}];case 6:return[2]}})})},r.prototype.createMidasbuyUserByLipass=function(e){return Z(this,void 0,void 0,function(){var t,n,i,a,d,u,P,p,k,y,I,F,D,j;return V(this,function(A){switch(A.label){case 0:if(typeof window.xMidas!="function")throw new Error("xMidas-sdk is needed");A.label=1;case 1:return A.trys.push([1,5,,6]),this.params.goServerUrl?(t=e||{},n=t.openId,i=t.token,a=t.iframeUrl,d=t.endpointType,n&&i&&a&&d?(u={lip_open_id:n,lip_token:i,iframe_url:a,endpoint_type:d,csrftoken:this.csrftoken},P=this.params.goServerUrl+"/lipLogin",[4,J(u)]):[2,{ret:1,msg:"createMidasbuyUserByLipass.error: params is invalid"}]):[2,{ret:1,msg:"createMidasbuyUserByLipass.error: goServerUrl is invalid"}];case 2:return p=A.sent(),[4,this.getGoHeaders(p)];case 3:return k=A.sent(),[4,M({url:P,method:"POST",timeout:5,dataType:"json",headers:k,param:T({},p)})];case 4:return y=A.sent(),(y==null?void 0:y.ret)===0?(I=(y==null?void 0:y.data)||{},F=I.action,D=I.token,[2,{ret:0,data:{action:F,token:D}}]):[2,{ret:1,msg:"createMidasbuyUserByLipass.error: "+(y==null?void 0:y.msg)}];case 5:return j=A.sent(),[2,{ret:1,msg:"createMidasbuyUserByLipass.error: "+((j==null?void 0:j.msg)||(j==null?void 0:j.message)||j)}];case 6:return[2]}})})},r}(),c=new o;window.midasLogin||(window.midasLogin=c)})()})();
