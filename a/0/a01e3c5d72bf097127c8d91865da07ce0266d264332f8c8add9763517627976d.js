"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[2685],{29982:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(20771),a=n(19565);const i=(0,o.Q_)("transcription",{state:getters:{canZoomIn:canZoomOut:,actions:{zoomIn:zoomOut:})},19833:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49458),a={class:"a-countdown"};const i={name:"CountDownTimer",props:{initialCountDown:{type:Number,required:!1,default:10}},data:function(){return{interval:void 0,countDown:this.initialCountDown}},unmounted:mounted:methods:{countDownTimer:function(){var e=this;this.interval=setInterval((,1e3)}}};const r=(0,n(83744).Z)(i,[["render",function(e,t,n,i,r,l){return(0,o.openBlock)(),(0,o.createElementBlock)("div",a,(0,o.toDisplayString)(e.$translate("autoload.panel.continues_in").replace("%number%",r.countDown)),1)}]])},42685:(e,t,n)=>{n.r(t),n.d(t,{default:);var o=n(49458),a={key:0,class:"a-circle-loader"},i=[(0,o.createElementVNode)("div",{class:"a-circle-loader__bg-circle"},null,-1),(0,o.createElementVNode)("div",{class:"a-circle-loader__main-circle"},null,-1)],r=["aria-label"],l=[(0,o.createElementVNode)("span",{class:"a-svg a-svg--picto-chevron-bottom"},null,-1)],s={class:"o-player-panel__label"},c=["innerHTML"],u=["href","innerHTML"],d=(0,o.createElementVNode)("span",{class:"a-svg a-svg--picto-synchro"},null,-1),p=["innerHTML"],m={key:1,ref:"contentWrapper",class:"o-player-panel__content-wrapper"},h={class:"o-player-panel__label"},f=["innerHTML"],y=["href","innerHTML"];var b=n(19327);var g=n(27641),v=n(20771),w=n(29982),S=n(58045),T=["id","data-start-time","data-end-time"];const k={name:"TranscriptionPart",props:{partId:{type:String,required:!0},partStart:{type:String,required:!0},partDuration:{type:String,required:!0},partWord:{type:String,required:!0},currentTime:{type:String,required:!0}},emits:["word-tap"],computed:{isReadingPart:function(){return Number(this.currentTime)>=Number(this.partStart)/25}},methods:{getDecodeWord:function(e){var t=document.createElement("textarea");return t.innerHTML=e,"".concat(t.value.trim()," ")},wordTap:};var _=n(83744);const C=(0,_.Z)(k,[["render",function(e,t,n,a,i,r){return(0,o.openBlock)(),(0,o.createElementBlock)("span",{id:n.partId,class:(0,o.normalizeClass)(["a-transcript-item",{"a-transcript-item--reading":r.isReadingPart}]),"data-start-time":n.partStart,"data-end-time":Number(n.partStart)+Number(n.partDuration),onClick:t[0]||(t[0]=(0,o.withModifiers)((function(){return r.wordTap&&r.wordTap.apply(r,arguments)}),["stop"]))},(0,o.toDisplayString)(r.getDecodeWord(n.partWord)),11,T)}]]);var P={key:0,class:"m-autoload-panel"},E={key:0,ref:"wrapper",class:"m-autoload-panel__wrapper"},A={key:0,class:"m-autoload-panel__timer"},B={class:"m-autoload-panel__podcast"},O=["innerHTML"],M=["innerHTML"],N=["innerHTML"],V={class:"m-autoload-panel__podcast__actions"},D={class:"m-cta__label"},z={class:"a-audio-player-btn__label"};var x=n(56712),L=n(76366),H=n(3658),I=n(40395),R=n(56585),j=n(19833),Z={class:"m-figure__img-wrapper"},W=["srcset","sizes"],$=["width","height","src","srcset","sizes","alt","loading"],F=["src"];const q={name:"FovImage",props:{figureClass:{type:String,default:""},imgClasse:{type:String,default:""},width:{type:Number,default:void 0},loading:{type:String,default:void 0},sizes:{type:String,default:void 0},image:{type:Object,default:void 0},ratio:{type:String,default:"16x9"},isWebp:{type:Boolean,default:!1},widthAuthorized:{type:Array,default:void 0,required:!0}},data:computed:{height:function(){return this.width&&"1x1"===this.ratio?this.width:""},originalExt:srcset:function(){var e=this;if(this.image){var t=new Set(this.widthAuthorized.map(Number)),n=this.image.formats.filter((),o=[],a=[],i=new RegExp(".".concat(this.originalExt,"$"),"g");if(n.forEach((function(e){t.has(Number(e.width))&&(o.push("".concat(e.url," ").concat(e.width,"w")),a.push("".concat(e.url.replace(i,".webp")," ").concat(e.width,"w")))})),o.length>0)return{src:o.join(", "),webp:a.join(", ")}}return{src:"",webp:""}}}},U=(0,_.Z)(q,[["render",function(e,t,n,a,i,r){return(0,o.openBlock)(),(0,o.createElementBlock)("figure",{class:(0,o.normalizeClass)("article__figure-wrapper m-figure m-figure--".concat(n.ratio," ").concat(n.figureClass))},[(0,o.createElementVNode)("picture",Z,[n.isWebp&&n.image?((0,o.openBlock)(),(0,o.createElementBlock)("source",{key:0,type:"image/webp",srcset:r.srcset.webp,sizes:n.sizes},null,8,W)):(0,o.createCommentVNode)("",!0),n.image?((0,o.openBlock)(),(0,o.createElementBlock)("img",{key:1,width:n.width,height:r.height,src:i.src,srcset:r.srcset.src,sizes:n.sizes,alt:n.image.alt,class:(0,o.normalizeClass)(["m-figure__img",n.imgClasse]),loading:n.loading?n.loading:"lazy"},null,10,$)):((0,o.openBlock)(),(0,o.createElementBlock)("img",{key:2,class:(0,o.normalizeClass)(["m-figure__img",n.imgClasse]),src:i.src},null,10,F))]),(0,o.renderSlot)(e.$slots,"default")],2)}]]);function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(Object(n),!0).forEach((function(t){(0,g.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var X=(0,H.Z)();const G={name:"AutoloadPanel",components:{FovImage:U,PlayMedia:R.default,CountDownTimer:j.Z},mixins:[(0,I.Z)(X,"",!1)],emits:["show-autoload-panel"],data:computed:Q(Q({},(0,v.Kc)(x.Z,L.Z)),{},{getClasses:getTheEnd:function(){return this.currentMediaStore.isTheEnd},getInitialCountDown:nextMedia:function(){if(this.currentMediaStore.isTheEnd&&this.playlistStore.playlist.length>0){var e=this.playlistStore.playlist[0];return this.updateTitleNextMedia(null==e?void 0:e.title),e}return[]}}),watch:{getTheEnd:,methods:Q(Q({},(0,v.nv)(x.Z,["updateLoadNextMedia","updateTitleNextMedia"])),{},{play:function(){this.cancelAutoload(),this.playOrPause({newMedia:this.nextMedia.mediaId})},cancelAutoload:function(){this.closeAutoload=!1,this.updateLoadNextMedia(!1),clearTimeout(this.currentMediaStore.timeoutId)},emitShowAutoloadPanel:function(){var e=this;this.$nextTick(()},setMargin:function(){var e=document.querySelector(".o-player-panel"),t=getComputedStyle(e),n=t.paddingTop,o=t.paddingBottom,a=(e.clientHeight-Number.parseInt(n,10)-Number.parseInt(o,10))/2-this.$refs.wrapper.clientHeight/2;this.$refs.wrapper.style.marginBottom="".concat(a,"px")}})},J=(0,_.Z)(G,[["render",function(e,t,n,a,i,r){var l=(0,o.resolveComponent)("count-down-timer"),s=(0,o.resolveComponent)("fov-image"),c=(0,o.resolveComponent)("play-media");return r.nextMedia?((0,o.openBlock)(),(0,o.createElementBlock)("div",P,[(0,o.createVNode)(o.Transition,{name:"autoload"},{default:(0,o.withCtx)((function(){var n,a,u,d,p,m,h,f;return[r.getTheEnd?((0,o.openBlock)(),(0,o.createElementBlock)("div",E,[i.closeAutoload?((0,o.openBlock)(),(0,o.createElementBlock)("div",A,[(0,o.createVNode)(l,{"initial-count-down":r.getInitialCountDown},null,8,["initial-count-down"])])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(s,{image:null===(n=r.nextMedia)||void 0===n||null===(a=n.diffusion)||void 0===a?void 0:a.image,"is-webp":!0,"width-authorized":i.imageWidth},null,8,["image","width-authorized"]),(0,o.createElementVNode)("div",B,[(0,o.createElementVNode)("div",{class:"m-autoload-panel__podcast__program",innerHTML:null===(u=r.nextMedia)||void 0===u||null===(d=u.emission)||void 0===d?void 0:d.title},null,8,O),(0,o.createElementVNode)("div",{class:"m-autoload-panel__podcast__date",innerHTML:null===(p=r.nextMedia)||void 0===p||null===(m=p.diffusion)||void 0===m?void 0:m.pubdate},null,8,M),(0,o.createElementVNode)("div",{class:"m-autoload-panel__podcast__edition",innerHTML:null===(h=r.nextMedia)||void 0===h?void 0:h.title},null,8,N),(0,o.createElementVNode)("div",V,[i.closeAutoload?((0,o.openBlock)(),(0,o.createElementBlock)("button",{key:0,class:"m-cta m-cta--rounded",type:"button","aria-label":"Annuler",onClick:t[0]||(t[0]=function(){return r.cancelAutoload&&r.cancelAutoload.apply(r,arguments)})},[(0,o.createElementVNode)("span",D,(0,o.toDisplayString)(e.$translate("autoload.panel.cancel")),1)])):(0,o.createCommentVNode)("",!0),null!==(f=r.nextMedia)&&void 0!==f&&f.mediaId?((0,o.openBlock)(),(0,o.createBlock)(c,{key:1,"media-id":r.nextMedia.mediaId,classes:"m-cta m-cta--rounded m-cta--play-pause a-picto-play-pause--play","play-class":"a-picto-play-pause--play","pause-class":"a-picto-play-pause--pause",onClick:r.play},{label:(0,o.withCtx)((function(){var t;return[(0,o.createElementVNode)("p",z,(0,o.toDisplayString)(e.$translate("podcasts.play_button.label"))+" - "+(0,o.toDisplayString)(null===(t=r.nextMedia.diffusion)||void 0===t?void 0:t.duration),1)]})),_:1},8,["media-id","onClick"])):(0,o.createCommentVNode)("",!0)])])],512)):(0,o.createCommentVNode)("",!0)]})),_:1})])):(0,o.createCommentVNode)("",!0)}]]);r te={"-2":"m-audio-transcription--font-xs","-1":"m-audio-transcription--font-s",1:"m-audio-transcription--font-l",2:"m-audio-transcription--font-xl"};const ne={name:"TranscriptionContainer",components:{TranscriptionPart:C,AutoloadPanel:J},props:{transcriptions:{type:Array,required:!1,default:void 0},panelOpened:{type:Boolean,default:!0},enableAutomaticPlaylist:{type:Boolean,default:!1}},emits:["sync-change"],data:function(){return{scrollTimer:void 0,container:void 0,scrollable:void 0,currentTime:0,hasScrollbar:!1,isSynchronized:!0,autoScrollHalt:!1,currentAutoscrollValue:0,scrollTopPosition:0,classes:{container:"m-audio-transcription__content",item:"a-transcript-item",itemReading:"a-transcript-item--reading",itemHovered:"a-transcript-item--hovered",hideScrollDown:"u-audio-transcription-hide-scroll-down"},timeout:void 0}},computed:ee(ee({},(0,v.Kc)(w.Z)),{},{resizeHandler:function(){return this.debounce(this.detectScrollbar,400,!0)},getCurrentTime:getZoomClass:function(){var e;return null!==(e=te[this.transcriptionStore.zoomValue])&&void 0!==e?e:""}}),watch:{isSynchronized:panelOpened:,created:unmounted:function(){window.removeEventListener("resize",this.resizeHandler),this.RFCorePlayer.removeEventListener("TIME_IS_UPDATED",this.onTimeUpdated),window.PubSub.clearSubscriptions("TIME_UPDATED_FROM_TRACKBAR"),this.removeScrollDownClass()},mounted:function(){var e=this;this.RFCorePlayer.addEventListener("TIME_IS_UPDATED",this.onTimeUpdated),window.PubSub.subscribe("TIME_UPDATED_FROM_TRACKBAR",this.reSync),this.container=this.$refs.content,this.scrollable=this.$refs.scrollable,this.$nextTick((function(){e.detectScrollbar()}))},methods:{removeScrollDownClass:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];S.Z.toggleBodyClass([this.classes.hideScrollDown],e)},manualScroll:function(){if(!this.isSynchronized&&window.IS_MOBILE){var e=this.scrollTopPosition<this.scrollable.scrollTop;this.removeScrollDownClass(e)}return this.scrollTopPosition=this.scrollable.scrollTop,this.debounce(this.shouldScroll,400,!0)},debounce:function(e,t,n){var o=this;return function(){for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];n&&!o.timeout&&e(i),clearTimeout(o.timeout),o.timeout=setTimeout((function(){o.timeout=void 0,n||e(i)}),t)}},emitSynchChange:onTimeUpdated:function(){this.currentTime=this.RFCorePlayer.getCurrentTime().toFixed(2),this.isSynchronized&&this.hasScrollbar&&this.autoScroll()},reSync:deSync:function(){this.isSynchronized=!1},autoScroll:function(){var e=this;this.autoScrollHalt||this.$nextTick((function(){var t,n=e.container.querySelectorAll(".".concat(e.classes.itemReading));n.length>0&&(t=n.item(n.length-1)),e.scrollToReadingWord(t)}))},scrollToReadingWord:function(e){var t=this,n=0;if(void 0!==e&&(n=e.offsetTop<this.scrollable.offsetTop+this.scrollable.offsetHeight/2?0:e.offsetTop-this.scrollable.offsetTop-this.scrollable.offsetHeight/2),this.scrollable.scrollTop!==n){var o=Math.abs(n-this.scrollable.scrollTop)<100?"smooth":"auto";this.currentAutoscrollValue=n,e&&e.scrollIntoView({behavior:"smooth",block:"center"}),"STATE_PAUSED"===this.RFCorePlayer.getStatus().state&&this.$nextTick((function(){t.scrollable.scrollTo(0,t.currentAutoscrollValue),setTimeout((function(){t.scrollable.scrollTo({top:t.currentAutoscrollValue+1,behavior:o})}),500)}))}},shouldScroll:function(){this.autoScrollHalt&&Math.abs(this.scrollable.scrollTop-this.currentAutoscrollValue)>0&&this.deSync()},scrollReset:function(){this.autoScrollHalt=!1},detectScrollbar:wordTap:function(e){this.RFCorePlayer.setCurrentTime(Number(e.partStart)/25),this.isSynchronized=!0},scrollbarClick:function(e){e.clientX>this.scrollable.offsetLeft+this.scrollable.offsetWidth-16&&e.clientX<this.scrollable.offsetLeft+this.scrollable.offsetWidth&&(this.autoScrollHalt=!0)},showAutoloadPanel:};var oe={"1x1":255,"16x9":388},ae="1x1",ie=255;const re={name:"PlayerAudioPanel",components:{FovImage:U,TranscriptionContainer:(0,_.Z)(ne,[["render",function(e,t,n,a,i,r){var l=(0,o.resolveComponent)("transcription-part"),s=(0,o.resolveComponent)("autoload-panel");return(0,o.openBlock)(),(0,o.createElementBlock)("div",{ref:"scrollable",class:(0,o.normalizeClass)(["m-audio-transcription",r.getZoomClass]),onScroll:t[0]||(t[0]=function(){return r.manualScroll&&r.manualScroll.apply(r,arguments)}),onWheel:t[1]||(t[1]=function(){return r.deSync&&r.deSync.apply(r,arguments)}),onMousedown:t[2]||(t[2]=function(){return r.scrollbarClick&&r.scrollbarClick.apply(r,arguments)}),onMouseup:t[3]||(t[3]=function(){return r.scrollReset&&r.scrollReset.apply(r,arguments)}),onTouchmove:t[4]||(t[4]=function(){return r.deSync&&r.deSync.apply(r,arguments)})},[(0,o.createElementVNode)("div",{ref:"content",class:(0,o.normalizeClass)(i.classes.container)},[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(n.transcriptions,(function(e,t){return(0,o.openBlock)(),(0,o.createElementBlock)("p",{key:t},[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(e.description.parts,(function(e,n){return(0,o.openBlock)(),(0,o.createBlock)(l,{key:"".concat(t,"-").concat(n,"-").concat(e.start),"part-id":"part-".concat(e.start,"-").concat(e.duration,"-").concat(n),"part-start":e.start,"part-duration":e.duration,"part-word":e.word,"current-time":r.getCurrentTime,onWordTap:r.wordTap},null,8,["part-id","part-start","part-duration","part-word","current-time","onWordTap"])})),128))])})),128))],2),n.enableAutomaticPlaylist?((0,o.openBlock)(),(0,o.createBlock)(s,{key:0,onShowAutoloadPanel:r.showAutoloadPanel},null,8,["onShowAutoloadPanel"])):(0,o.createCommentVNode)("",!0)],34)}]]),AutoloadPanel:J},props:{enableAutomaticPlaylist:{type:Boolean,default:!1}},data:function(){return{transcriptions:[],panelOpened:!1,transcriptionEnabled:!1,synchroBtnLabel:"",isSync:!0,diffusion:"",emissionTitle:"",emissionUrl:"",image:void 0,loading:!1,imageWidth:0,imageRatio:"",imageFigureClass:"",bodyClassPanelOpened:"u-player-panel-visible"}},computed:{hasTranscriptions:setClasses:function(){var e="o-player-panel";return this.panelOpened?(e+=" o-player-panel--opened",document.documentElement.classList.add("u-disable-scroll"),document.body.classList.contains(this.bodyClassPanelOpened)||document.body.classList.add(this.bodyClassPanelOpened)):(window.PubSub.publish("player.panel.hide"),document.documentElement.classList.remove("u-disable-scroll"),document.body.classList.contains(this.bodyClassPanelOpened)&&document.body.classList.remove(this.bodyClassPanelOpened)),this.transcriptionEnabled&&this.hasTranscriptions&&(e+=" o-player-panel--with-transcription"),e}},mounted:function(){var e,t,n,o=this;this.transcriptionEnabled=(null===(e=window.contextlayer.player)||void 0===e?void 0:e.enableTranscription)||"",this.synchroBtnLabel=(null===(t=window.contextlayer.player_audio)||void 0===t?void 0:t.synchro_btn_label)||"";var a=null===(n=window.contextlayer.player)||void 0===n?void 0:n.panelImage;this.imageRatio=(null==a?void 0:a.ratio)||ae,this.imageWidth=oe[this.imageRatio]||ie,this.imageFigureClass="1x1"===this.imageRatio?"m-figure--rounded":"",window.PubSub.subscribe("player.panel.show",(function(){o.showPanel()})),window.PubSub.subscribe("player.panel.request.hide",(),window.PubSub.subscribe("player.panel.loading",(),b.Z.subscribe("navigation.request.finished.success",(),window.PubSub.subscribe("player.data_fetched",(function(e,t){var n,a;t&&t.content&&(o.image="fle"===window.contextlayer.site_nav.site_brand?t.content.image:t.content.program.podcast_square_image||t.content.program.image,o.diffusion=t.content.title,o.emissionUrl=(null===(n=t.content.program)||void 0===n?void 0:n.url)||"",o.emissionTitle=(null===(a=t.content.program)||void 0===a?void 0:a.title)||"",o.transcriptions=t.content.sound.transcriptions)}))},unmounted:methods:{showPanel:function(){this.panelOpened=!0},closePanel:updateSync:reSync:showAutoloadPanel:function(){this.$refs.contentWrapper.scrollTo({top:this.$refs.contentWrapper.scrollHeight,behavior:"smooth"})}}},le=(0,_.Z)(re,[["render",function(e,t,n,b,g,v){var w=(0,o.resolveComponent)("transcription-container"),S=(0,o.resolveComponent)("fov-image"),T=(0,o.resolveComponent)("autoload-panel");return(0,o.openBlock)(),(0,o.createElementBlock)("div",{class:(0,o.normalizeClass)(v.setClasses)},[g.loading?((0,o.openBlock)(),(0,o.createElementBlock)("div",a,i)):((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:1},[(0,o.createElementVNode)("button",{type:"button",class:"o-player-panel__close-btn","aria-label":e.$translate("modal.close.label"),onClick:t[0]||(t[0]=function(){return v.closePanel&&v.closePanel.apply(v,arguments)})},l,8,r),g.transcriptionEnabled&&v.hasTranscriptions?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:0},[(0,o.createElementVNode)("div",s,[g.diffusion?((0,o.openBlock)(),(0,o.createElementBlock)("span",{key:0,class:"o-player-panel__label__edition",innerHTML:g.diffusion},null,8,c)):(0,o.createCommentVNode)("",!0),g.emissionTitle?((0,o.openBlock)(),(0,o.createElementBlock)("a",{key:1,href:g.emissionUrl,class:"o-player-panel__label__program",onClick:t[1]||(t[1]=function(){return v.closePanel&&v.closePanel.apply(v,arguments)}),innerHTML:g.emissionTitle},null,8,u)):(0,o.createCommentVNode)("",!0)]),(0,o.createVNode)(w,{ref:"transcriptionObj",transcriptions:g.transcriptions,"panel-opened":g.panelOpened,"enable-automatic-playlist":n.enableAutomaticPlaylist,onSyncChange:v.updateSync},null,8,["transcriptions","panel-opened","enable-automatic-playlist","onSyncChange"]),g.isSync?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createElementBlock)("button",{key:0,type:"button",class:"o-player-panel__synchro-btn",onClick:t[2]||(t[2]=function(){return v.reSync&&v.reSync.apply(v,arguments)})},[d,(0,o.createElementVNode)("span",{class:"o-player-panel__synchro-btn__label",innerHTML:g.synchroBtnLabel},null,8,p)]))],64)):g.panelOpened?((0,o.openBlock)(),(0,o.createElementBlock)("div",m,[(0,o.createElementVNode)("div",h,[g.diffusion?((0,o.openBlock)(),(0,o.createElementBlock)("span",{key:0,class:"o-player-panel__label__edition",innerHTML:g.diffusion},null,8,f)):(0,o.createCommentVNode)("",!0),g.emissionTitle?((0,o.openBlock)(),(0,o.createElementBlock)("a",{key:1,href:g.emissionUrl,class:"o-player-panel__label__program",onClick:t[3]||(t[3]=,innerHTML:g.emissionTitle},null,8,y)):(0,o.createCommentVNode)("",!0)]),(0,o.createVNode)(S,{image:g.image,"figure-class":g.imageFigureClass,ratio:g.imageRatio,"is-webp":!0,"width-authorized":[g.imageWidth]},null,8,["image","figure-class","ratio","width-authorized"]),n.enableAutomaticPlaylist?((0,o.openBlock)(),(0,o.createBlock)(T,{key:0,onShowAutoloadPanel:v.showAutoloadPanel},null,8,["onShowAutoloadPanel"])):(0,o.createCommentVNode)("",!0)],512)):(0,o.createCommentVNode)("",!0)],64))],2)}]])}}]);