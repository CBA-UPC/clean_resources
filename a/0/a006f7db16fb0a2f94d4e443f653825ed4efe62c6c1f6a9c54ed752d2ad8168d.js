/*! For license information please see async-optimistic-feature-e0c03be6ae7c36ed9bb1.js.LICENSE.txt */
"use strict";(globalThis.webpackChunktinderweb=globalThis.webpackChunktinderweb||[]).push([[85907],{912573:(e,t,a)=>{a.d(t,{Lz:()=>n,SW:()=>s,cP:()=>o});const s="sending",n="success",o="failure"},189634:(e,t,a)=>{a.r(t),a.d(t,{reducer:()=>D});var s=a(454936),n=a(343599),o=a(604577),c=a.n(o),r=a(351843),i=a(494601),l=a(907379),_=a(213100);const d=(0,n.ZP)(((e,t)=>{switch(t.type){case l.FETCH_INITIAL_MATCHES_SUCCESS:case l.FETCH_MATCHES_SUCCESS:case l.FETCH_UPDATES_SUCCESS:{const{matches:a}=t.payload?.entities||{};if(!a||c()(a))return;Object.keys(a).forEach((t=>{delete e[t]}));break}case i.SET_MATCH_SEEN:{const{matchId:a}=t.payload;a&&(e[a]={...e[a],seen:{match_seen:!0}});break}case i.SET_LAST_SEEN_MATCH_MESSAGE:{const{matchId:a,messageId:s,from:n,otherUserId:o}=t.payload;e[a]={...e[a],seen:{...e[a]?.seen,match_seen:!0,last_seen_msg_id:s},person:o,messages:[{...e[a]?.messages?.[0],_id:s,from:n}]};break}case(0,r.dh)(t.type):return _.default}}),_.default);var S=a(112954),E=a.n(S),m=a(912573),u=a(750402);function g(e,t,a){const{matchId:s,tempMessageId:n}=t,o=e[s]?.find((e=>e._id===n));Object.assign(o,t,a)}function p(e,t,a){return g(e,t,{state:a})}const f=(0,n.ZP)(((e,t)=>{switch(t.type){case l.FETCH_UPDATES_SUCCESS:!function(e,t){const{matches:a}=t?.result||{};a&&a.forEach((a=>{const s=e[a];if(!s?.length)return;const n=new Set(t.entities?.matches?.[a]?.messages),o=s.filter((e=>e.state!==m.Lz||!n?.has(e._id)));E()(e,[a],o)}))}(e,t.payload);break;case i.SEND_MESSAGE:{const{messageData:a}=t.payload,{matchId:s}=a,n=new Date,o={_id:a.tempMessageId,match_id:s,to:"",from:a.userId,message:a.message,sent_date:n.toISOString(),created_date:n.toISOString(),timestamp:n.getTime(),state:m.SW,type:a.type,...a.gif_id?{gif_id:a.gif_id,fixed_height:a.fixed_height}:{},..."song"===a.type?{song:a.song}:{},..."contact_card"===a.type?{contact_card:a.contact_card}:{}};e[s]?e[s].push(o):E()(e,[s],[o]);break}case i.SEND_MESSAGE_RETRY:{const{messageData:a}=t.payload;p(e,a,m.SW);break}case i.SEND_MESSAGE_SUCCESS:{const{messageData:a,response:s}=t.payload;g(e,a,{state:m.Lz,_id:s._id});break}case i.SEND_MESSAGE_FAILURE:{const{messageData:a}=t.payload;p(e,a,m.cP);break}case i.DELETE_TEMP_MESSAGE:{const{matchId:a,tempMessageId:s}=t.payload;e[a]=e[a]?.filter((e=>e._id!==s));break}case(0,r.dh)(t.type):return u.default}}),u.default);var h=a(237451),T=a(179978),y=a(954995),C=a(479564);const b=(0,n.ZP)(((e,t)=>{switch(t.type){case h.RESET_LOCATION:e.is_traveling=!1;break;case h.SET_TRAVEL_LOCATION_OPTIMISTIC:{const{location:a,info:s}=t.payload;e.is_traveling=!0,e.travel_pos=a,e.travel_location_info=s;break}case y.FETCH_PROFILE_SUCCESS:{const{travel:a}=t.payload?.data||{};if(a){const{travel_pos:t}=a;if(!e.travel_pos||!t)return;const s=a.is_traveling===e.is_traveling;if((0,T.Qw)(t,e.travel_pos)&&s)return C.default}}}}),C.default);var I=a(740359),A=a.n(I),v=a(533444),k=a(388761);const U=(0,n.ZP)(((e,t)=>{switch(t.type){case v.UPDATE_SETTING:A()(e,t.payload);break;case v.CLEAR_SETTINGS_CHANGES:return k.default}}),k.default);var M=a(382483);const N=(0,n.ZP)(((e,t)=>{switch(t.type){case l.FETCH_UPDATES_SUCCESS:{const{blocks:a}=t.payload?.result||{};if(a)return e.filter((e=>!a.includes(e)));break}case i.UNMATCH_FAILURE:{const{matchId:a}=t.payload||{};if(a)return e.filter((e=>e!==a));break}case i.UNMATCH:{const{matchId:a}=t.payload||{};a&&!e.includes(a)&&e.push(a);break}case(0,r.dh)(t.type):return M.default}}),M.default),D=(0,s.UY)({matches:d,messages:f,unmatchedIds:N,settings:U,passport:b})},179978:(e,t,a)=>{a.d(t,{Bv:()=>r,OJ:()=>_,Qb:()=>i,Qw:()=>l});var s=a(142896),n=a(991931),o=a.n(n),c=a(981413);const r=(0,s.Z)((e=>e.map((e=>({location:(0,c.TR)({lat:e?.lat,lon:e?.lon}),info:{title:o()(e,["locality","long_name"],""),subtitle:o()(e,["country","long_name"],"")}}))))),i=(0,s.Z)((e=>e&&e.length?e.map((e=>({info:{title:o()(e,["structured_formatting","main_text"],o()(e,["terms",0,"value"],"")),subtitle:o()(e,["structured_formatting","secondary_text"],"")},placeId:e?.place_id,location:e}))):[])),l=(e,t)=>!(!e||!t)&&(e.lat===t.lat&&e.lon===t.lon),_=(0,s.Z)((e=>{let t="";if(!e)return{subtitle:"Loading ..."};const{country:a}=e;e.route&&(t+=e.route?.long_name),e.street_number&&(""!==t&&(t+=", "),t+=e.street_number?.long_name),e.postal_code&&(""!==t&&(t+=", "),t+=e.postal_code?.long_name),e.locality&&(""!==t&&(t+=", "),t+=e.locality?.long_name),a&&(""!==t&&(t+=", "),t+=a.long_name);const s="US"===a?.short_name;return{title:e.locality?.long_name||e.administrative_area_level_2?.long_name,subtitle:t,region:s?e.administrative_area_level_1?.short_name||"":a?.long_name}}),{serializer:(...e)=>JSON.stringify(e)})}}]);