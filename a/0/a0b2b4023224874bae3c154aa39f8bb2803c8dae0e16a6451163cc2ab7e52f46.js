"use strict";(self.webpackChunkWPS_Drive=self.webpackChunkWPS_Drive||[]).push([[4919],{90802:function(e,t,i){i.r(t),i.d(t,{default:);var r=i(81045),n=i(4942),s=i(15861),o=i(87757),a=i.n(o),c=i(21628),l=i(79835),u=i(89602),d=i(27060),p=i(90336),f=i(62006),m=i(22399),h=i(85956),_=i(33958),v={name:"DriveCreateFile",componentName:"DriveCreateFile",props:{file:{type:Object,required:!0}},data:function(){var e,t=this.getNameExt(this.file.fname||this.file.name,this.file.ftype)||"",i=(0,_.qR)(this.file);e=i||""===t?this.file.fname||this.file.name:this.getNameAddon(this.file.fname||this.file.name,this.file.ftype);var n=i?0:t.length+1;return{ext:t,renameFile:{name:e},rules:{name:[{pattern:/^[^/\\:*?"<>|]+$/,message:(0,c.exception)("illegalFname"),trigger:"change"},{max:240-n,message:(0,c.exception)("fileNameLengthExceed"),trigger:"change"}]},cancelBtnTxt:(0,r.GH)("file_new_File3"),confirmBtnTxt:(0,r.GH)("file_new_File4")}},computed:{isFolder:placeholder:function(){return this.isFolder?(0,r.GH)("file_new_Folder1"):(0,r.GH)("file_new_File1")},btnStatus:function(){var e=this.file.fname||this.file.name;return(this.isFolder?this.renameFile.name.trim():this.renameFile.name.trim()+"."+this.ext)===e||""===this.renameFile.name.trim()}},methods:{submitForm:function(e){var t=this;return this.$refs[e].validate(function(){var e=(0,s.Z)(a().mark((function e(i){var s,o,c,m,_,v;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i||t.btnStatus){e.next=20;break}return e.prev=1,s=t.renameFile.name.trim(),!t.isFolder&&t.ext&&(s=s+"."+t.ext,"link"===t.file.ftype&&(0,l.isShortcutFileByName)(t.file.fname)&&(s="".concat(s,".link"))),o=t.file.id||t.file.fileid,e.next=7,t.$store.dispatch(u.E_G,{fileid:o,fname:s,groupid:t.file.groupid});case 7:t.$store.dispatch(u.xeZ,{id:o}),t.isFolder&&(t.$store.commit(u.NRF,(0,n.Z)({},"".concat(d.bg.folder).concat(o),{text:s})),t.$ua.wpsTeamApp&&t.$store.dispatch(u.DEO,(0,n.Z)({},"".concat(d.bg.folder).concat(o),{text:s}))),t.$message.success((0,r.GH)("file_new_File12")),t.$emit("close"),t.$eventBus.emit(p.IL,{command:f.bv.command,params:{fileid:t.file.id||t.file.fileid,fname:s}}),t.$ua.wpsDocumentEmbed&&(c=t.file,m=c.id,_=c.fileid,v=c.groupid,(0,h.Jd)("itemRenamed",{fileId:m||_,groupId:v,itemName:s})),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),t._error(e.t0.response.data.msg);case 18:e.next=21;break;case 20:return e.abrupt("return",!1);case 21:case"end":return e.stop()}}),e,null,[[1,15]])})));return function(t){return e.apply(this,arguments)}}()),!1},handleClose:function(){this.$emit("close")},getNameAddon:function(e,t){var i=e.split(".");return"link"===t&&(0,l.isShortcutFileByName)(e)&&i.pop(),i.pop(),i.join(".")},getNameExt:function(e,t){var i=e.split("."),r=i.length;return"link"===t&&(0,l.isShortcutFileByName)(e)?i[r-2]||"":r>1?i.pop():""}},directives:{focus:m.Z}},g=v,y=i(51900),x=(0,y.Z)(g,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-form",{ref:"renameFile",attrs:{model:e.renameFile,labelPosition:"top",prop:"name",rules:e.rules},nativeOn:{submit:function(t){return t.preventDefault(),e.submitForm("renameFile")}}},[i("el-form-item",{attrs:{prop:"name"}},[i("kd-input",{directives:[{name:"focus",rawName:"v-focus"},{name:"pad-focus",rawName:"v-pad-focus"}],attrs:{placeholder:e.placeholder},model:{value:e.renameFile.name,callback:function(t){e.$set(e.renameFile,"name",t)},expression:"renameFile.name"}},[!e.isFolder&&e.ext?i("template",{slot:"append"},[e._v("."+e._s(e.ext))]):e._e()],2)],1),i("div",{staticClass:"footer"},[i("kd-button",{attrs:{type:"secondary"},on:{click:e.handleClose}},[e._v(e._s(e.cancelBtnTxt))]),i("kd-button",{attrs:{type:"primary",disabled:e.btnStatus},on:{click:function(t){return e.submitForm("renameFile")}}},[e._v(e._s(e.confirmBtnTxt))])],1)],1)],1)}),[],!1,null,"6825642f",null).exports,b=i(42982),k=i(69034),w=i(39201),$=i(83677);function C(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function S(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?C(Object(i),!0).forEach((function(t){(0,n.Z)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):C(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var F={name:"DriveRecoverFiles",componentName:"DriveRecoverFiles",mixins:[w.Z],props:{file:{type:[Object,Array]},position:{type:String},selected:{type:Array},selectedGroups:{type:Array},selectedFiles:{type:Array},title:{type:String},onCommit:{type:Function,default:function(){return Promise.resolve(!0)}}},data:computed:{selectIds:function(){var e=this.file.fileid||this.file.id;return e?[e]:this.selected},isMulit:function(){return this.selectIds&&this.selectIds.length>1},realFile:content:function(){var e="",t=this.realFile,i="";return t&&(i=(0,l.subFileName)(t.fname||t.name,t.type||t.ftype)),e=this.isMulit?this.$t("components_dialog_file_recover_txt3",{type:this.typeText,name:this.getNameStr(i),num:this.selectIds.length}):"".concat(this.$t("components_dialog_file_recover_txt4")).concat(this.typeText," ").concat(this.getNameStr(i)),e},isFolder:function(){return[].concat(this.file).every(()},isGroup:function(){return[].concat(this.file).some((function(e){var t=e.ftype,i=e.isTeam;return["delgroup"].includes(t)||i}))}},activated:function(){this.setTitle()},created:function(){this.setTitle(),this.$on("ok",(0,s.Z)(a().mark((function e(){var t,i,r,n,s,o,c,l,u,d,p;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={fileids:this.selectIds},this.selectedGroups&&(t={fileids:this.selectedFiles,groupids:this.selectedGroups}),this.$emit("process",!0),e.prev=3,this.$emit("close"),this.$toast||(this.$toast=this.$message({message:this.$t("components_dialog_file_recover_team_tips2"),iconClass:"el-icon-loading",duration:0})),!this.isGroup){e.next=11;break}return e.next=9,this.recoverTeam();case 9:e.next=13;break;case 11:return e.next=13,this.recoverFiles(t);case 13:e.next=23;break;case 15:e.prev=15,e.t0=e.catch(3),(i=e.t0.response&&e.t0.response.data)&&(e.t0.response.data.full_position="spacelimit_recovery",e.t0.response.data.full_component="web_lefttab",e.t0.response.data.groupid=this.realFile.groupid,r=this.realFile||{},n=r.corpid,s=void 0===n?0:n,o=r.fname,c=void 0===o?"":o,l=r.fsize,u=void 0===l?"":l,d=r.ftype,p=void 0===d?"file":d,this.realFile.corpid&&(e.t0.response.data.companyID=s,e.t0.response.data.action="move",e.t0.response.data.fname=c,e.t0.response.data.size=u,e.t0.response.data.count=this.file.length||1,e.t0.response.data.path=this.$t("constant_TRASH"),e.t0.response.data.isFolder=Boolean(~p.indexOf("folder")))),this.trashDW("fail",{error:e.t0.response&&e.t0.response.data&&e.t0.response.data.result||0}),this.$emit("close"),this.$toast&&this.$toast.close&&this.$toast.close(),this.file.length>1&&i&&"SpaceFull"===e.t0.response.data.result?this.$message.error(this.$t("components_dialog_file_recover_space_full")):this.handleSpaceFull(e.t0);case 23:case"end":return e.stop()}}),e,this,[[3,15]])}))))},methods:{setTitle:function(){this.typeText=this.$t("components_dialog_file_recover_txt5"),this.isFolder&&(this.typeText=this.$t("components_dialog_file_recover_txt6")),this.isGroup&&(this.typeText=this.$t("components_dialog_file_recover_txt2")),this.$emit("propsChange",{title:"".concat(this.$t("components_dialog_file_recover_txt1")).concat(this.typeText)})},recoverTeam:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r,n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i={},t.prev=1,!e.isMulit){t.next=8;break}return t.next=5,e.$store.dispatch(u.L2i,{ids:e.selected});case 5:i=t.sent,t.next=10;break;case 8:return t.next=10,e.$store.dispatch(u.YeM,{id:e.realFile.groupid});case 10:return t.prev=10,e.$toast&&e.$toast.close&&e.$toast.close(),t.finish(10);case 13:return i.faillist&&i.faillist.length>0?e.$message.error(e.$t("components_dialog_file_recover_muti_fail"),{num:i.faillist.length}):(r=e.$createElement,n=e.$message({message:r("p",{class:"message-delete-success"},[r("span",e.$t("components_dialog_file_recover_team_tips_new_layout")),r("a",{on:{click:function(){e.isMulit?e.$router.replace({name:"Groups"}):e.$router.replace({name:"Group",params:{tid:e.realFile.id}}),n.close()}}},e.$t("components_dialog_file_recover_show"))]),type:"success"})),e.$store.dispatch(u.vcH,{key:d.Dt.myGroup.key}),t.next=17,e.onCommit();case 17:case"end":return t.stop()}}),t,null,[[1,,10,13]])})))()},getNameStr:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return'<b title="'.concat(e,'"> ').concat((0,$.cutOffString)(e,8,16)," </b>")},trashDW:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};["Trash","EntTrash","TeamTrash"].includes(this.$route.name)&&k.Z.onEvent("multiselect_restore",{result:e,errorcode:"success"===e?0:t.error,entrance:"trash",position:this.position,number:t.number||this.selectIds.length})},batchRecover:function(){var e=arguments,t=this;return(0,s.Z)(a().mark((function i(){var r,n,s,o,c,l,d,p,f,m,h,_,v,g;return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:r=e.length>0&&void 0!==e[0]?e[0]:{},n=e.length>1&&void 0!==e[1]?e[1]:20,s=r.fileids,o=void 0===s?[]:s,c={faillist:[]},l=0;case 5:if(!(l<=o.length)){i.next=26;break}if(0!==(d=o.slice(l,l+n)).length){i.next=9;break}return i.abrupt("continue",23);case 9:return i.next=11,t.$store.dispatch(u.lu$,S(S({},r),{},{fileids:d}));case 11:p=i.sent,f=p.data,m=f.faillist,h=f.dest,_=f.groupid,v=f.group_type,g=f.parentid,m&&m.length&&(c.faillist=c.faillist.concat(m)),c.dest!==h&&(c.dest=h),c.groupid!==_&&(c.groupid=_),c.groupType!==v&&(c.groupType=v),c.parentid!==g&&(c.parentid=g);case 23:l+=n,i.next=5;break;case 26:return t.$toast&&t.$toast.close&&t.$toast.close(),i.abrupt("return",c);case 28:case"end":return i.stop()}}),i)})))()},recoverFiles:function(e){var t=this;return(0,s.Z)(a().mark((function i(){var r,n,s,o,c,p,f,m,h,_,v,g,y,x;return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,t.batchRecover(e);case 2:return r=i.sent,n=r.faillist,s=r.dest,o=r.groupid,c=r.groupType,p=r.parentid,n&&n.length?(t.$emit("process",!1),m=n[0].msg,t.file.length>1&&1===n.length&&(h=t.file.find((function(e){return e.fileid===n[0].fileid}))||{},m=t.$t("components_dialog_file_recover_one_fail",{name:(0,l.subFileName)(h.fname||h.name,h.ftype)||"",msg:n[0].msg})),n.length>1&&(m=t.$t("components_dialog_file_recover_muti_fail",{num:n.length}),(_=t.selectIds.length-n.length)>0&&t.trashDW("success",{number:_}),t.trashDW("fail",{number:n.length,error:(0,b.Z)(new Set(n.map((function(e){return e.result})))).join(",")})),t.$message.error(m)):(v=t.$createElement,g="原路径",s&&(g=s,"special"===c?g=t.$t("components_dialog_file_recover_txt10"):"corpspecial"===c?(g=t.$t("constant_MY_CLOUD_NEW_LAYOUT"),f="EntSpace"):"corptmp"===c?f="Backup":"tmp"===c?(g=t.$t("components_dialog_file_recover_txt12"),f="Devices"):"corpnormal"!==c&&"corpdep"!==c||(f="Enterprise"),g.length>12&&(g="".concat(g.substr(0,5),"...").concat(g.substr(-5)))),y=t.$message({message:v("p",{class:"message-delete-success"},[v("span","".concat(t.$t("components_dialog_file_recover_team")).concat(s?"「".concat(g,"」"):g)),s&&v("a",{on:{click:function(){if("special"!==c||p){var e=t.$route.params.cid||null;t.$router.replace({name:f||"Team",params:{cid:e,tid:o,fid:p}})}else t.$router.push({name:"All"});y.close()}}},t.$t("components_dialog_file_recover_txt9"))]),type:"success"}),t.trashDW("success")),x="".concat(d.bg.folder).concat(p),o!==t.$store.state.team.myCloud.id||p||(x=d.Dt.myDocument.key),t.$store.dispatch(u.vcH,{key:x}),i.next=14,t.onCommit(e);case 14:case"end":return i.stop()}}),i)})))()}}},T=F,P=(0,y.Z)(T,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"drive-recover-files"},[i("p",{directives:[{name:"dompurify-html",rawName:"v-dompurify-html",value:e.content,expression:"content"}]})])}),[],!1,null,null,null).exports,N=i(14500),E=i(78684),I=i(76043),D=i(92250),Z={name:"YunRecoverFile",componentName:"YunRecoverFile",mixins:[E.Z,D.Z],props:{groupid:{type:Number},fileid:{type:Number},historyid:{type:Number},mtime:{type:Number},modifier:{type:String},editedName:{type:String},fver:{type:[Number,String]},onRecover:{type:Function,default:function(){return Promise.resolve(!0)}}},data:function(){return{isNewHistoryPanel:!1}},computed:{isSecretExpired:function(){var e=this.$store.state,t=e.team,i=e.user;return"Secret"===e.route.name&&t.mySecret&&!(i.privileges&&i.privileges.secret_folder)}},created:function(){var e=this;this.$on("ok",(0,s.Z)(a().mark((function t(){var i,r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isSecretExpired){t.next=4;break}e.dialog("preventUpload",{backprev:!0,useNewLayout:e.$store.state.ui.useNewLayout}),t.next=20;break;case 4:return t.prev=4,e.$emit("process",!0),t.next=8,N.drive.post("/api/v3/files/".concat(e.fileid,"/histories/").concat(e.historyid,"/recover"),{groupid:e.groupid});case 8:i=t.sent,r=i.data,e.$emit("process",!1),e.$emit("close"),e.$message.success("恢复成功"),e.onRecover(r),t.next=20;break;case 16:t.prev=16,t.t0=t.catch(4),e._error(t.t0),e.$emit("process",!1);case 20:case"end":return t.stop()}}),t,null,[[4,16]])})))),this.isNewHistoryPanel=this.$store.state.switchCof.isNewHistoryPanel,this.isNewHistoryPanel&&this.$on("cancelClose",(function(){var t=e.fileid,i=e.fver;(0,I.Z)({operation:"recover_cancel",history_num:i,fileid:t},{position:e.$store.state.file.position})}))}},H=Z,O=(0,y.Z)(H,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.isNewHistoryPanel?i("div",[i("p",{attrs:{tabindex:"0"}},[e._v(e._s(e.$t("components_dialog_file_recover_txt7_new",{desc:e.$options.filters.date(e.$t("components_dialog_file_recover_txt13"),e.mtime)})))])]):i("div",[i("p",{attrs:{tabindex:"0"}},[e._v(e._s(e.$t("components_dialog_file_recover_txt7",{desc:e.$options.filters.date("Y/m/d l H:i",e.mtime)})))]),i("p",{staticClass:"editedName",attrs:{tabindex:"0"}},[e._v(e._s(e.editedName))])])}),[],!1,null,null,null).exports,L=i(5448),G=i(52477),M={},R={mixins:[G.default],methods:{deleteMessage:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=this.$createElement;M=this&&this.powerConfig.get&&this.powerConfig.get("CloudDeletedToastRestore")&&!this.$ua.wpsDocumentEmbed&&!this.$ua.eduWorkbench?this.$message({message:i("p",{class:"message-delete-success"},[i("span",(0,r.GH)("mixins_deleteMessage0")),i("a",{on:{click:function(){t&&t.cid?e.$router.push({name:"EntTrash",params:{cid:t.cid}}):e.$router.push({name:"EntTrash",params:{cid:0}}),M.close(),e.$eventBus.emit(p.kx)}}},(0,r.GH)("mixins_deleteMessage1"))])}):this.$message.success((0,r.GH)("mixins_deleteMessage0"))}}},B=i(36992),A=i(423),j=i(86081),W=i(7685),V={name:"DriveDeleteFiles",componentName:"DriveDeleteFiles",mixins:[L.Z,R],props:{file:{type:Object},selected:{type:Array},selFiles:{type:Array},selectedGroups:{type:Array},selectedFiles:{type:Array},isEntTeamFile:{type:Boolean},alias:{type:String},title:{type:String},position:{type:String,default:"menu"},showClearRecord:{type:Boolean,default:!1},onCommit:{type:Function,default:function(){return Promise.resolve(!0)}},onFail:{type:Function,default:function(){}},from:{type:String,default:""}},data:function(){return{user_role:"",corpId:null,groupName:"",groupType:"",fCreator:{},deleteShare:!1,canManageRecycle:!1,check:!1,realIds:[],hasOtherFilesInFolder:!1}},computed:{isEntTrash:function(){return"EntTrash"===this.$route=this.file.ftype},isEnt:function(){return"Enterprise"===this.$route.name}rivileges.delete},company:function(){return this.$store.state.company.current},user:function(){return this.$store.staare&&!this.check},selectIds:function(){var e=this.file.fileid||this.file.id;return e?[e]:this.selected},recordFiles:function(){var e=this,t=[];return this.$store.getters.selectedFiles.forEach((function(i){var r=i.fileid,n=i.sid;i.file_src===e.$t("file_delete_Index6")&&(n||t.push(r))})),t},thorough:function(){return"destory"===this.alias?this.$t("file_delete_IndlectIds.length>1},isFolder:function(){return!this.isMulit&&this.file&&["sharefolder","folder"].includes(this.file.ftype)},isMultiple:function(){return this.$store.state.file.multiple},hasDeletePerm:function(){var e=this.file.creator&&this.file.creator.id||this.fCreator.id,t=this.file.file_perms_acl||{},i=!this.isMulit&&e==this.user.id;return t.delete||/(creator|admin)/.test(this.user_role)||!/(normal|corpnormal)/.test(this.groupType)||i},content:function(){var e,t=this.$ua.wpsTeamApp,i=this.$ua.eduWorkbench;if(this.isMulit)if(this.deleteShare)e="".concat(this.$t("file_delete_Index8")," <b>").concat(this.$t("file_delete_Index9"),"</b> </br></br>").concat(this.$t("file_delete_Index10"));else if(this.title)e=this.$t("file_delete_Index11");else{var r=this.selFiles[0]||{};e=this.$t("file_delete_thorough_multi",{thorough:this.thorough,fname:this.getNameStr((0,l.subFileName)(r.fname||r.name,r.type||r.ftype)),num:this.selectIds.length,type:this.getTypeText(this.selectIds.length)}),t?e+="，".concat(this.$t("team_app_file_delete_recoverTip")):i?e+="":"remove_secret"===this.alias?e+="，".concat(this.$t("file_delete_Index24")):e+=this.thorough?this.$t("file_delete_Index25"):this.$t("file_delete_Index22")}else{var n=this.file.fname||this.file.name;n=(0,l.subFileName)(n,this.file.ftype);var s=this.getNameStr(n),o=this.isEntTeamFile&&this.banCreatorDelete?this.$t("file_delete_Index15"):this.$t("file_delete_Index16"),a=this.groupName&&/(normal|corpnormal)/.test(this.groupType)?"".concat(this.$t("file_delete_Index17")).concat(this.isFolder?this.$t("file_delete_Index18"):this.$t("file_delete_Index18_1")).concat(this.$t("file_delete_Index19")," ").concat(this.getNameStr(this.groupName)).concat(this.$t("file_delete_Index20")).concat(this.hasDeletePerm?this.$t("file_delete_Index21"):o):this.$t("file_delete_Index22");t?a="，".concat(this.$t("team_app_file_delete_recoverTip")):i&&(a="");var c=this.hasDeletePerm?"".concat(this.$t("file_delete_comfirm_single",{thorough:this.thorough,fnameStr:s})):"".concat(this.$t("file_delete_Index23")," ").concat(s);if(this.isLinkFile)e=this.$t("file_delete_file_link_text");else if(this.showClearRecord)e=this.thorough?"".concat(this.$t("file_delete_comfirm_single",{thorough:this.thorough,fnameStr:s})):"".concat(c).concat(a);else if("remove_secret"===this.alias)e="".concat(this.$t("file_delete_comfirm_single",{thorough:this.thorough,fnameStr:s})," </br></br>").concat(this.$t("file_delete_Index24"));else if(this.deleteShare)e="".concat(this.$t("file_delete_Index8")," <b>").concat(this.$t("file_delete_Index9"),"</b> </br></br>").concat(this.$t("file_delete_Index10"));else{var u=this.hasDeletePerm?"".concat(this.$t("file_delete_comfirm_single",{thorough:this.thorough,fnameStr:s})):"".concat(this.$t("file_delete_Index23")," ").concat(s);e=this.thorough?"".concat(this.$t("file_delete_comfirm_single",{thorough:this.thorough,fnameStr:s})).concat(this.$t("file_delete_Index25"),"<p><p>"):"".concat(u).concat(a)}}return e},broadcast:function(){return(this.isMulit||this.isFolder)&&new j.Z}},created:function(){var e=this;return(0,s.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.checkFolder();case 2:e.isEntTrash&&e.checkRecyclesManage(),e.$on:return t.stop()}}),t)}))));case 4:case"end":return t.stop()}}),t)})))()},methods:{handleKeyUp:function(){var e=this,t=function(t){13===(t.keyCode||t.which||t.charCode)&&e.$emit("ok")};document.addEventListener("keyup",t),this.$on("hook:beforeDestroy",(function(){document.removeEventListener("keyup",t)}))},toWork:function(){window.open("".concat(A.V1,"/docs/sub-recyle-bin")),this.recycleDw("click")},getTypeText:function(e){var t=this.selFiles.some((function(e){return e.isTeam||"delgroup"===e.ftype}))er"].includes(e.ftype)}));return!i&&!t?this.$tc("file_delete_Index32",e):i?this.$tc("file_delete_Index31",e):t?this.$tc("file_delete_Index33",e):void 0},getFileComapnyId:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r,n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,"Latest"!==e.$route.name&&"Tags"!==e.$route.name){t.next=12;break}return i=e.file,i.fileid||i.id||(i=e.$store.getters.firstSelectedFile),t.next=7,N.drive.get("/api/v5/files/".concat(i.fileid||i.id,"/companyid"));case 7:return r=t.sent,n=r.data,t.abrupt("return",n.companyid);case 12:if(!e.file.corpid){t.next=14;break}return t.abrupt("return",e.file.corpid);case 14:return t.abrupt("return",!1);case 17:return t.prev=17,t.t0=t.catch(0),t.abrupt("return",!1);case 20:case"end":return t.stop()}}),t,null,[[0,17]])})))()},deleteFile:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r,n,s,o,c,p,f,m,h,v,g,y,x,k,w,$,C,S,F,T,P,E,I,D,Z,H,O,L,G,M;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.$emit("close","ok"),i=null,r={alias:e.alias,isMulit:e.isMulit,removeFileAndRecord:[],sid:""},n=[],t.prev=4,t.next=7,e.getFileComapnyId();case 7:if(o=t.sent,"destory"!==e.alias){t.next=24;bre||"delgroup"===e.ftype}))){t.next=16;break}return i=e.$message({message:e.$t("file_delete_Completely_Delete_Team_Tips"),iconClass:"el-icon-loading",duration:0}),t.next=13,e.$store.dispatch(u.$X2,{id:e.file.groupid});case 13:s=t.sent,t.next=22;break;case 16:return i=e.$message({message:e.$t("yun_views_deleting"),iconClass:"el-icon-loading",duration:0}),n=r.selected=e.selectIds,e.selectedGroups&&(r.selectedGroups=e.selectedGroups,r.selected=e.selectedFiles),t.next=21,e.$store.dispatch(u.zym,r);case 21:s=t.sent;case 22:t.next=58;break;case 24:if("remove_file_and_record"!==e.alias){t.next=32;break}for(i=e.$message({message:e.$t("yun_views_deleting"),iconClass:"el-icon-loading",duration:0}),c=0;c<e.selected.length;c++)p=e.$store.getters.findFile(e.selected[c]),f=p.groupid,m=p.sid,h=p.file_src,r.removeFileAndRecord.push({groupid:f,fileid:parseInt(e.selected[c]),sid:m,file_src:h});return t.next=29,e.$store.dispatch(u.Mc8,r);case 29:s=t.sent,t.next=58;break;case 32:if(i=!e.isMulit&&!e.isFolder&&e.$message({message:e.$t("yun_views_deleting"),iconClass:"el-icon-loading",duration:0}),!e.isMulit){t.next=52;break}if(v={},g=[],e.selFiles.forEach((function(e){g.includes(e.groupid)?v[e.groupid].files.push(e.folderid||e.fileid||e.id||0):(v[e.groupid]={groupid:e.groupid,files:[e.folderid||e.fileid||e.id||0]},g.push(e.groupid))})),1!==g.length){t.next=46;break}return r.groupid=g[0],r.selected=v[g[0]]&&v[g[0]].files||[],n=e.selected,t.next=43,e.$store.dispatch(u.zym,r);case 43:s=t.sent,t.next=50;break;case 46:return r=e.selFiles,t.next=49,e.$store.dispatch(u.hs6,r);case 49:s=t.sent;case 50:t.next=58;break;case 52:return r.groupid=e.file.groupid,r.parentid=e.file.parentid,e.isMulit?(r.selected=e.realIds,n=e.selected):(r.fileid=e.realIds[0],n=[e.file.id||e.file.fileid]),t.next=57,e.$store.dispatch(u.zym,r);case 57:s=t.sent;case 58:if(!s||"failtask"!==s){t.next=63;break}i.close(),e.$message.error(e.$t("file_delete_Index35")),t.next=99;break;case 63:if(y=e.$store.state.route.name,!s||!s.taskid){t.next=68;break}return t.next=67,(0,W.Wp)(s.taskid,e.broadcast,e.$store,{taskid:s.taskid,type:"del",selFiles:e.selFiles,isSecret:"Secret"===e.$store.state.route.name});case 67:e.$store.commit(u.aFD,{ids:n});case 68:if("destory"!==e.alias&&(x=e.isMulit?e.selFiles.find(_.qR):e.file,k=(0,_.O)(x||{}),e.isMulit?e.selFiles.forEach((function(t){(0,_.qR)(t)&&e.$store.dispatch(u.vcH,{childKey:"".concat(d.bg.folder).concat((0,_.O)(t))})})):k&&e.$store.dispatch(u.vcH,{childKey:"".concat(d.bg.folder).concat(k)}),["EntTrash","TeamTrash"].includes(y)&&e.$store.commit(u._P6)),w=(s||{}).faillist,$=!0,(void 0===w?[]:w).length>0&&($=!1),!e.$ua.yun&&!e.$ua.wps18and19||~["Trash","EntTrash","TeamTrash"].indexOf(y)&&"search"!==e.from||!$){t.next=94;break}if(F=e.$store.state.team||{},(T=F.current).user_role||e.user_role){t.next=87;break}return t.prev=75,t.next=78,N.drive.get("/api/v3/groups/".concat(e.file.groupid));case 78:E=t.sent,I=E.data,P=I.user_role,t.next=85;break;case 83:t.prev=83,t.t0=t.catch(75);case 85:t.next=88;break;case 87:P=e.user_role||T.user_role||"member";case 88:i&&i.close(),D=!((0,_.hZ)(e.file.ftype)||"remove_secret"===e.alias&&void 0!==e.file.labelObjType||e.$ua.wpsTeamApp||e.$ua.smallTeamDocument),null!==(C=e.file)&&void 0!==C&&null!==(S=C.rawData)&&void 0!==S&&S.deleted?e.$message.success(e.$t("file_delete_Index36")):D&&(~["member","creator","admin"].indexOf(P)&&"Secret"!==y||"search"===e.from)?["Enterprise","EntSpace","Backup"].includes(y)?!e.isMulit&&!e.isFolder&&e.deleteMessage({cid:e.$store.state.route.params.cid}):!e.isMulit&&!e.isFolder&&e.deleteMessage(o?{cid:o}:""):e.$message.success(e.$t("file_delete_Index36")),e.trackDW("success"),t.next=97;break;case 94:i&&i.close(),Z=(s||{}).faillist,(H=void 0===Z?[]:Z).length>0?(O=H[0].msg,e.selectedFiles.length>1&&1===H.lenge.fileid===H[0].fileid}))||{},O=e.$t("file_delete_thorough_one_fail",{name:(0,l.subFileName)(L.fname||L.name,L.ftype)||"",msg:H[0].msg})),H.length>1&&(O=e.$tc("file_delete_Index40",H.length,{num:H.length}),(G=e.selectedFiles.length-H.length)>0&&e.trashDW("success",{number:G}),e.trashDW("fail",{number:H.length,error:(0,b.Z)(new Set(H.map((function(e){return e.result})))).join(",")})),e._error(O)):(e.$message.success(e.$t("file_delete_Index36")),e.trashDW("success"));case 97:return t.next=99,e.onCommit({ids:n});case 99:t.next=107;break;case 101:t.prev=101,t.t1=t.catch(4),i&&i.close(),M=t.t1.response&&t.t1.response.data&&t.t1.response.data.result||0,(e.$ua.yun||e.$ua.wps18and19)&&(e.trackDW("fail",{error:M}),e.trashDW("fail",{error:M})),"successtask"===s?e.$message.success(e.$t("file_delete_Index36")):"notGroupMember"===M?(e.$message.error(e.$t("file_delete_cannot_delete_other")),e.onFail()):(e._error(t.t1),e.onFail());case 107:case"end":return t.stop()}}),t,null,[[4,101],[75,83]])})))()},checkRecyclesManage:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r,n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i={permissions:["recycles.manage.edit"]},t.next=4,N.plussvr.post("/plusadmin/api/v1/companies/".concat(e.company.id,"/users/").concat(e.user.id,"/permissions-check"),i);case 4:r=t.sent,n=r.data,e.canManageRecycle=n.is_has,e.canManageRecycle&&e.recycleDw("show"),t.next=12;break;case 10:t.prev=10,t.t0=t.catch(0);case 12:case"end":return t.stop()}}),t,null,[[0,10]])})))()},checkFolder:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r,n,s,o,c,l,u,d;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=[],e.selFiles.forEach((function(t){var r=t.id||t.fileid;"linkfolder"===t.ftype?(r=t.folderid,e.deleteShare=!0):"folder"===t.ftype&&i.push(r),e.realIds.push(r)})),!i.length||"Team"===e.$route.name){t.next=15;break}return t.prev=3,t.next=6,N.drive.get("/api/v5/groups/special/folders/share?fileids=".concat(i.join(",")));case 6:r=t.sent,n=r.data.folderids,e.deleteShare=e.deleteShare||n.length>0,t.next=15;break;case 11:t.prev=11,t.t0=t.catch(3),e._error(t.t0),e.$emit("close");case 15:if(!e.file.groupid||e.isMulit||"remove_secret"===e.alias){t.next=29;break}return t.prev=16,t.next=19,N.drive.get("/api/v3/groups/".concat(e.file.groupid));case 19:s=t.sent,o=s.data,e.corpId=parseInt(o.corpid),e.groupName=o.name,e.groupType=o.group_type,e.user_role=o.user_role,t.next=29;break;case 27:t.prev=27,t.t1=t.catch(16);case 29:if(c=e.file.creator&&e.file.creator.id,l=e.file.id||e.file.fileid,c||!l){t.next=42;break}return t.prev=32,t.next=35,N.drive.get("/api/v5/files/".concat(l,"/metadata?from=preview"));case 35:u=t.sent,d=u.data,e.fCreator=d.fileinfo.creator,t.next=42;break;case 40:t.prev=40,t.t2=t.catch(32);case 42:case"end":return t.stop()}}),t,null,[[3,11],[16,27],[32,40]])})))()},onRemoveRecord:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r,n,s;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:re(e){return parseInt(e)})),r=i.length>1,n="file",r||k.Z.onEvent("delete_record_click",{type:n}),t.prev=4,t.next=7,e.$store.dispatch(u.CG9,{ids:i});case 7:e.$message.success(e.$t("file_delete_Index37")),e.$store.dispatch(u.DJg),e.$emit("close"),r?k.Z.onEvent("multiselect_record",{result:"success",number:i.length,errorcode:0}):k.Z.onEvent("delete_record_success",{type:n}),t.next=19;break;case 13:t.prev=13,t.t0=t.catch(4),e._error(t.t0),s=-1,t.t0.response&&t.t0.response.data&&t.t0.response.data.result&&(s=t.t0.response.data.result),r?k.Z.onEvent("multiselect_record",{result:"fail",number:i.length,errorcode:s}):k.Z.onEvent("delete_record_fail",{type:n,errorcode:s});case 19:case"end":return t.stop()}}),t,null,[[4,13]])})))()},getNameStr:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return'<b title="'.concat(e,'"> ').concat((0,$.cutOffString)(e,8,16)," </b>")},trackDW:function(e,t){var i,r;switch(this.alias){case"remove_file_and_record":r="file";break;case"remove":case"destory":r=~["delfolder","folder"].indexOf(this.file.ftype)?"folder":"delgroup"===this.file.ftype?"shared_folder":"file"}if(i=~["remove_file_and_record","remove"].indexOf(this.alias)?"success"===e?"delete_success":"delete_fail":"success"===e?"shiftdelete_fail_success":"shiftdelete_fail_fail",this.isMultiple){var n=((this.$store.state.route||{}).name||"").toLowerCase();r=this.selectedFiles.length===this.recordFiles.length?"record":"entity",k.Z.onEvent("multiselect_delete",{type:r,result:e,errorcode:"success"===e?0:t.error,entrance:n,position:this.position,number:this.selectIds.length})}else"success"===e?k.Z.onEvent(i,{type:r}):k.Z.onEvent(i,{type:r,errorcode:t.error})},trashDW:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.$store.state.route.name;"destory"===this.alias&&["Trash","EntTrash","TeamTrash"].includes(i)&&k.Z.onEvent("multiselect_empty",{result:e,errorcode:"success"===e?0:t.error,entrance:"trash",position:this.position,number:t.number||this.selectedFiles.length})},recycleDw:function(e){k.Z.onEvent("recyclebin_confirm_tip",{operation:e,company_id:this.company.id,user_id:this.user.id,role:{1:"superadm",2:"admin",3:"member"}[parseInt(this.company.userRole)]||"member",source:(0,B.x_)()})},checkHasOtherFilesInFolder:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r,n,s;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=e.file.id,t.next=4,N.drive.get("/api/files/".concat(i));case 4:r=t.sent,n=r.data.files,s=void 0===n?[]:n,e.hasOtherFilesInFolder=s.length>0,t.next=12;break;case 10:t.prev=10,t.t0=t.catch(0);case 12:case"end":return t.stop()}}),t,null,[[0,10]])})))()}},mounted:function(){var e=this;return(0,s.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.handleKeyUp(),!e.isFolder){t.next=4;break}return t.next=4,e.checkHasOtherFilesInFolder();case 4:case"end":return t.stop()}}),t)})))()}},U=V,z=(0,y.Z)(U,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"drive-delete-files"},[i("p",{directives:[{name:"dompurify-html",rawName:"v-dompurify-html",value:e.content,expression:"content"}],attrs:{tabindex:"0"}}),e.canManageRecycle&&e.isEntTrash?i("p",{staticClass:"drive-delete-files-recycle"},[e._v(e._s(e.$t("file_delete_Index41"))),i("a",{staticClass:"drive-delete-files-recycle-link",on:{click:e.toWork}},[e._v(e._s(e.$t("file_delete_Index42")))]),e._v(e._s(e.$t("file_delete_Index43")))]):e._e(),e.showClearRecord?i("div",{staticClass:"delete"},[e._v(" "+e._s(e.$t("file_delete_Index0"))+" "),i("icon",{attrs:{type:"clear-trash"}}),i("a",{attrs:{tabindex:"0"},on:{click:e.onRemoveRecord}},[e._v(e._s(e.$t("file_delete_Index1")))])],1):e._e(),e.hasDeletePerm?i("div",{staticClass:"footer"},[i("kd-button",{attrs:{type:"secondary"},on:{click:function(t){return e.$emit("close")}}},[e._v(e._s(e.$t("file_delete_Index2")))]),i("kd-button",{attrs:{type:"primary",danger:"",disabled:e.disabled},on:{click:function(t){return e.$emit("ok")}}},[e._v(e._s(e.$t("file_delete_Index3")))])],1):i("div",{staticClass:"footer"},[i("kd-button",{attrs:{type:"primary"},on:{click:function(t){return e.$emit("close")}}},[e._v(e._s(e.$t("file_delete_Index4")))])],1),e.deleteShare?i("div",{staticClass:"checkbox"},[i("kd-checkbox",{model:{value:e.check,callback:function(t){e.check=t},expression:"check"}},[e._v(e._s(e.$t("file_delete_Index5")))])],1):e._e()])}),[],!1,null,null,null).exports,q=i(94476),K={name:"DriveRemoveFileFromRecord",componentName:"DriveRmoveFileFromRecord",mixins:[R],props:{user:{type:Object,default:function(){}},file:{type:Object,default:function(){}},files:{type:Array,default:function(){return[]}},skipFlush:{type:Boolean,default:!1},onCommit:{type:Function,default:function(){return Promise.resolve(!0)}}},data:function(){return{isCheck:!1,user_acl:{},loading:!0rn this.files.length>1},hasDeletePerm:function(){return this.user_acl.delete},onlyName:function(){return(0,l.subFileName)(this.file.fname||this.file.name)},cutName:function(){return(0,$.cutOffString)(this.onlyName,8,16)},isShareFile:function(){var e=this.file,t=e.ftype,i=e.link,r=e.path,n=e.sid,s=e.isshare;return("sharefile"===t||i)&&r===q.p_||n||s}},watch:{loading:function(e){this.$ua.isTablet&&(e||this.$nextTick((function(){var e=document.querySelectorAll(".remove-file-from-record-checkbox");if(e&&e.length>0)for(var t=0;t<e.length;t++){var i=e[t].querySelector(".el-checkbox__inner");i&&i.classList.add("needsclick")}})))}},created:function(){this.isMultiple?this.loading=!1:this.checkFile(),this.$on("ok",this.handleOk)},methods:{checkFile:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r,n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(i=e.file.id||e.file.fileid)){t.next=12;break}return t.prev=2,t.next=5,N.drive.get("/api/v5/files/".concat(i,"/metadata?from=preview"));case 5:r=t.sent,n=r.data,e.user_acl=n.user_acl,t.next=12;break;case 10:t.prev=10,t.t0=t.catch(2);case 12:e.loading=!1;case 13:case"end":return t.stop()}}),t,null,[[2,10]])})))()},handleRemoveRecord:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r,n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i="shared_file",k.Z.onEvent("delete_record_click",{type:i}),t(t.fileid||e.file.id)})).filter((function(e){return e})),t.next=6,e.$store.dispatch(u.CG9,{ids:r});case 6:e.$store.dispatch(u.DJg),e.$message.success(e.$t("file_delete_fromRecord7")),e.$emit("close"),k.Z.onEvent("delete_record_success",{type:i}),t.next=19;break;case 12:t.prev=12,t.t0=t.catch(2),console.log(t.t0),e._error(t.t0),n=-1,t.t0.response&&t.t0.response.data&&t.t0.response.data.result&&(n=t.t0.response.data.result),k.Z.onEvent("delete_record_fail",{type:i,errorcode:n});case 19:case"end":return t.stop()}}),t,null,[[2,12]])})))()},handleExitShare:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r,n,s,o,c,l,d,p,f,m,h,_;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=e.file,r=i.roamingid,n=i.sid,s=i.id,o=i.fileid,c=i.link,l=i.isshare,s=parseInt(s||o),!c){t.next=6;break}n=c.sid,t.next=23;break;case 6:if(!l){t.next=23;break}return t.prev=7,t.next=10,N.drive.get("/api/v5/links/".concat(s));case 10:d=t.sent,p=d.data,n=p.linkinfo.sid,t.next=23;break;case 15:if(t.prev=15,t.t0=t.catch(7),f=t.t0||{},m=f.response,h=(m||{}).data,"permissionDenied"===(_=(h||{}).result)||"linkClosed"===_){t.next=23;break}return e._error(t.t0),t.abrupt("return");case 23:if(t.prev=23,!n){t.next=29;break}return t.next=27,e.$store.dispatch(u.iDL,{skipFlush:e.skipFlush,sid:n,ids:[s]});case 27:t.next=32;break;case 29:if(!r){t.next=32;break}return t.next=32,e.$store.dispatch(u.Mc8,{skipFlush:e.skipFlush,removeFileAndRecord:[e.file]});case 32:return t.next=34,e.onCommit({ids:[s],sync:!0});case 34:e.$message.success(e.$t("file_delete_fromRecord8")),e.$emit("close"),t.next=42;break;case 38:t.prev=38,t.t1=t.catch(23),console.log(t.t1),e._error(t.t1);case 42:case"end":return t.stop()}}),t,null,[[7,15],[23,38]])})))()},getFileComapnyId:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,"Latest"!==e.$route.name&&"Tags"!==e.$route.name){t.next=7;break}return t.next=4,N.drive.get("/api/v5/files/".concat(e.file.fileid||e.file.id,"/companyid"));case 4:return i=t.sent,r=i.data,t.abrupt("return",r.companyid);case 7:return t.abrupt("return",!1);case 10:return t.prev=10,t.t0=t.catch(0),t.abrupt("return",!1);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))()},handleDeleteFile:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getFileComapnyId();case 2:return i=t.sent,t.next=5,e.$store.dispatch(u.Mc8,{skipFlush:e.skipFlush,removeFileAndRecord:[e.file]});case 5:return t.next=7,e.onCommit({ids:[e.file.id],sync:!0});case 7:e.deleteMessage(i?{cid:i}:""),e.$emit("close");case 9:case"end":return t.stop()}}),t)})))()},handleOk:function(){this.isCheck?this.isShareFile?this.handleExitShare():this.handleDeleteFile():this.handleRemoveRecord()}}},Q=K,Y=(0,y.Z)(Q,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.loading?i("loading"):i("div",{staticClass:"remove-file-from-record"},[i("div",{staticClass:"remove-file-from-record-content",attrs:{tabindex:"0"}},[i("span",[e._v(e._s(e.$t("file_delete_fromRecord0")))]),i("strong",{attrs:{title:e.onlyName}},[e._v("「"+e._s(e.cutName)+"」")]),i("span",[e._v(e._s(e.isMultiple?e.$t("file_delete_fromRecord_num",[e.files.length]):""))]),i("span",[e._v(e._s(e.$t("file_delete_fromRecord1")))])]),e.isShareFile?[i("kd-checkbox",{staticClass:"remove-file-from-record-checkbox",class:{needsclick:e.$ua.isTablet},model:{value:e.isCheck,callback:function(t){e.isCheck=t},expression:"isCheck"}},[e._v(e._s(e.$t("file_delete_fromRecord2")))]),e.isCheck?i("p",{staticClass:"remove-file-from-record-tips",staticStyle:{"margin-top":"3px"},attrs:{tabindex:"0"}},[e._v(e._s(e.$t("file_delete_fromRecord3")))]):e._e()]:e.hasDeletePerm?[i("kd-checkbox",{staticClass:"remove-file-from-record-checkbox",model:{value:e.isCheck,callback:function(t){e.isCheck=t},expression:"isCheck"}},[e._v(e._s(e.$t("file_delete_fromRecord4")))]),e.isCheck?[i("p",{staticClass:"remove-file-from-record-tips",staticStyle:{"margin-top":"3px"}},[e._v(e._s(e.$t("file_delete_fromRecord5")))]),i("p",{staticClass:"remove-file-from-record-tips"},[e._v(e._s(e.$t("file_delete_fromRecord6")))])]:e._e()]:e._e()],2)}),[],!1,null,"7e2ef605",null).exports,J={name:"DriveClearTrash",componentName:"DriveClearTrash",computed:{contentTips:function(){return"TeamTrash"===this.$store.state.route.name?this.$t("file_delete_ClearTeamTrash"):this.$t("file_delete_ClearTrash0")}},mounted:function(){var e=this;this.$on("ok",(0,s.Z)(a().mark((function t(){var i,r,n,s;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,i=e.$store.state,r=i.route,n=i.user,"EntTrash"!==r.name){t.next=7;break}return t.next=5,e.$store.dispatch(u.oaB,{corpid:r.params.cid});case 5:t.next=19;break;case 7:if("TeamTrash"!==r.name){t.next=17;break}return s=e.$message({message:e.$t("file_delete_ClearTeamTrashTips"),iconClass:"el-icon-loading",duration:0}),t.prev=9,t.next=12,e.$store.dispatch(u.uin);case 12:return t.prev=12,s.close(),t.finish(12);case 15:t.next=19;break;case 17:return t.next=19,e.$store.dispatch(u.XRW,{isPlus:n.is_plus});case 19:e.$message.success(e.$t("file_delete_ClearTrash1")),e.$emit("close"),t.next=26;break;case 23:t.prev=23,t.t0=t.catch(0),e._error(t.t0);case 26:case"end":return t.stop()}}),t,null,[[0,23],[9,,12,15]e._s(e.contentTips)+" ")])}),[],!1,null,null,null).exports,te=function(){},ie=null,re={mixroute;this.listenerLock(e)},beforeRouteUpdate:function(e,t,i){"Secret"!==e.name?(this.$el.removeEventListener("mousedown",te),this.$el.removeEventListener("scroll",te)):this.listenerLock(e),i()},methods:{listenerLock:function(e){var t=this;"Secret"===e.name&&(te=function(){t.lockCountDown()},this.$el.addEventListener("mousedown",te,!0),this.$el.addEventListener("scroll",te,!0))},insertPassword:function(e){var t=this;return(0,s.Z)(a().mark((function i(){var r,n;return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,N.drive.put("/api/v3/groups/secret/unlock",{password:e});case 3:t.setSecretLockStatus(!1),t.lockCountDown(),i.next=12;break;case 7:return i.prev=7,i.t0=i.catch(0),(r=i.t0.response.data)&&-1!==r.result.indexOf("SecretGroupPasswordError")?(n=parseInt(r.result.split(":")[1]),i.t0.errorText=n<=5?"密码不正确，你今天还可以尝试".concat(n,"次"):"密码不正确"):r&&"SecretGroupPasswordRetriesLimitError"===r.result?i.t0.errorText="密码输入错误达到上限，请明天再试":i.t0.errorText=r&&r.msg||"",i.abrupt("return",Promise.reject(i.t0));case 12:case"end":return i.stop()}}),i,null,[[0,7]])})))()},lockSecret:function(){var e=this;return(0,s.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,N.drive.put("/api/v3/groups/secret/lock");case 3:e.setSecretLockStatus(!0),clearTimeout(ie),ie=null,t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),e.error(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},lockCountDown:function(){var e=this;clearTimeout(ie),ie=setTimeout((0,s.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return  t.stop()}}),t)}))),6e5)},setMySecret:function(){this.setSecretLockStatus(!1),this.lockCountDown()},beforeCloseBindPhone:function(){this.dialog("giveUpBindPhone",{back:!1,beforeCloseFun:this.beforeCloseGiveUp,setMySecret:this.setMySecret})},openBindPhoneDialog:function(){this.dialog("bindPhone",:this.setMySecret})},beforeCloseGiveUp:function(){this.setMySecret(),this.$message.success("开启成功")},setSecretLockStatus:function(e){this.$store.commit(u.WF0,e)}}},ne={name:"DriveSetSecretPassword",componentName:"DriveSetSecretPassword",mixins:[E.Z,G.default,re],data:function(){var e=this;return{setSecretPassword:{password:"",repeatPassword:""},rules:{password:[{validator:function(t,i,r){if(""===i)r(new Error(e.$t("file_secret_SetPassword6")));else{i=i.trim();/^[\x00-\x19\x21-\x7F]{8,16}$/.test(i)||r(new Error(e.$t("file_secret_SetPassword1")+"8-16"+e.$t("file_secret_SetPassword2"))),r()}},trigger:"blur"}],repeatPassword:[{validator:function(t,i,r){""===(i=i.trim())?r(new Error(e.$t("file_secret_SetPassword7"))):i!==e.setSecretPassword.password.trim()?r(new Error(e.$t("file_secret_SetPassword8"))):r()},trigger:"blur"}]},loading:!1}},computed:{btnStatus:function(){return!(this.setSecretPassword.password.trim().length>0&&this.setSecretPassword.repeatPassword.trim().length>0)}},methods:{submitForm:function(){var e=this;return this.$refs.setSecretPassword.validate(function(){var t=(0,s.Z)(a().mark((function t(i){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!i){t.next=6;break}return e.loading=!0,t.next=4,e.setPassword();case 4:t.next=7;break;case 6:return t.abrupt("return",!1);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),!1},handleClose:function(){this.$emit("close")},setPassword:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,N.drive.post("/api/v3/groups/secret",{password:e.setSecretPassword.password.trim()});case 3:i=t.sent,r=i.data,e.loading=!1,e.$store.commit(u.uez,r),e.afterSuccessSetPwd(),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(0),e.loading=!1,e._error(t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,10]])})))()},afterSuccessSetPwd:function(){this.$emit("close"),this.$message.success(this.$t("file_secret_SetPassword9")),this.setMySecret()},gotoBindPhone:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$store.dispatch(u.kU9);case 3:(i=e.$store.state.user.bindstatus).phone||i.email?(e.$emit("close"),e.$message.success(e.$t("file_secret_SetPassword9")),e.setMySecret()):e.openBindPhoneDialog(),t.next=9;break;case 7:t.prev=7,t.t0=t.catch(0);case 9:case"end":return t.stop()}}),t,null,[[0,7]])})))()}},mounted:function(){var e=document.querySelector("#inputFocus input");e&&e.focus()}},se=ne,oe=(0,y.Z)(se,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-form",{ref:"setSecretPassword",attrs:{model:e.setSecretPassword,labelPosition:"top",rules:e.rules}},[i("el-form-item",[e._v(" "+e._s(e.$t("file_secret_SetPassword0"))+" ")]),i("el-form-item",{attrs:{prop:"password"}},[i("el-input",{attrs:{id:"inputFocus",autoComplete:"off",type:"password",placeholder:e.$t("file_secret_SetPassword1")+"8-16"+e.$t("file_secret_SetPassword2")},model:{value:e.setSecretPassword.password,callback:function(t){e.$set(e.setSecretPassword,"password",t)},expression:"setSecretPassword.password"}})],1),i("el-form-item",{attrs:{prop:"repeatPassword"}},[i("el-inpurn!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitForm.apply(null,arguments)}},model:{value:e.setSecretPassword.repeatPassword,callback:function(t){e.$set(e.setSecretPassword,"repeatPassword",t)},expression:"setSecretPassword.repeatPassword"}})],1),i("div",{staticClass:"footer"},[i("el-button",{on:{click:e.handleClose}},[e._v(e._s(e.$t("file_secret_SetPassword4")))]),i("el-button",{attrs:{type:"primary",disabled:e.btnStatus,loading:e.loading},on:{click:e.submitForm}},[e._v(e._s(e.$t("file_secret_SetPassword5"))+" ")])],1)],1)],1)}),[],!1,null,"d364edf6",null),ae=oe.exports,ce={name:"CountDown",props:{send},btnText:{type:String,default:"发送验证码"}},data:function(){return{count:0,timer:null,countText:this.btnText}},methods:{handleResend:function(){var e=this;return(0,s.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.sendCode();case 3:e.handleCountDown(),t.next=8;break;case 6:t.prev=6,t.t0=t.catch(0);case 8:case"end":return t.stop()}}),t,null,[[0,6]])})))()},handleCountDown:function(e){var t=this,i=e||this.eventName;this.timer||(this.count=60,window[i]=setInterval((function(){t.count>0&&t.count<=60?(t.count--,t.countText="重新发送(".concat(t.count,")")):(clearInterval(t.timer),t.timer=),this.timer=window[i])},reset:function(e){clearInterval(window[e]),this.timer=null}},destroyed:function(){clearInterval(this.timer)}},le=ce,ue=(0,y.Z)(le,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-button",{staticClass:"count-down",attrs:{disabled:!!e.timer,type:e.btnType},on:{click:e.handleResend}},[i("span",[e._v(e._s(e.countText))])])}),[],!1,null,"73450f56",null).exports,de=void 0,pe={name:"SecretBindPhone",componentName:"SecretBindPhone",components:{CountDown:ue},mixins:[D.Z],props:{afterSuccessBindPhone:{type:Function,default:function(){de.$emit("close"),de.$message.success(de.$t("file_secret_BindPhone7"))}}},data:function(){var e=this,t={firstOpen:this.$t("file_secret_BindPhone5"),hadOpen:this.$t("file_secret_BindPhone6")};return{promptText:t,phoneForm:{phone:"",code:""},phoneRules:{phone:[{validator:function(t,i,r){""===i?r(new Error(e.$t("file_secret_BindPhone8"))):/^(0086|086|86)?(1[3-9]\d{9})$/.test(i)?r():r(new Error(e.$t("file_secret_BindPhone9")))},trigger:"blur"}],code:[{required:!0,message:this.$t("file_secret_BindPhone10"),trigger:"blur"}]},loading:!1,codeLabel:"",promptBodyText:t.firstOpen}},computed:{btnStatus:function(){return!(this.phoneForm.phone.trim().length>0&&this.phoneForm.code.trim(store.state.user}},methods:{submitForm:function(){var e=this;this.$refs.phoneForm.validate((function(t){if(!t)return!1;e.bindPhone()}))},handleCode:function(){var e=this,t=this;this.$refs.phoneForm.validateField("phone",function(){var i=(0,s.Z)(a().mark((function i(r){return a().wrap((function(i){ext=5;break}return i.next=3,e.sendCode();case 3:i.next=7;break;case 5:return setTimeout((function(){t.$refs.countDown.reset("phone")}),50),i.abrupt("return",!1);case 7:case"end":return i.stop()}}),i)})));return function(e){return i.apply(this,arguments)}}())},sendCode:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r,n,s,o;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$store.dispatch(u.IHk,{phone:e.phoneForm.phone,action:"bind",CHECK_JUMP:!0});case 3:e.$message.success(e.$t("file_secret_BindPhone11")),e.showCode=!0,t.next=15;break;case 7:t.prev=7,t.t0=t.catch(0),e.showCode=!1,e.$refs.countDown.reset("phone"),i=t.t0||{},r=i.response,n=(r||{}).data,"CellPhoneBind"===(n||{}).result?(s=e.$createElement,o=e.$message({type:"error",message:s("p",{style:{color:"#3C414B",fontaddingLeft:"12px",color:"#417FF9",cursor:"pointer"},on:{click:function(){o.close(),window.open("".concat(A.yV,"/help#phone_unbind"))}}},e.$t("file_secret_BindPhone13"))])})):e._error(t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,7]])})))()},bindPhone:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i={action:"bind",phone:e.phoneForm.phone,smscode:e.phoneForm.code,CHECK_JUMP:!0},t.prev=1,t.next=4,N.account.put("/p/bind/phone",i);case 4:e.$store.commit(u.uCz,{bindstatus:Object.assign({},e.bindstatus,{phone:{value:i.phone}})}),e.showCode=!1,e.$refs.phoneForm.resetFields(),e.afterSuccessBindPhone(e),k.Z.onEvent("binding_mobile_succes",{entrance:"Secret",vip:e.user.vip_level}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),e._error(t.t0);case 14:case"end":return t.stop()}}),t,null,[[1,11]])})))()}},created:function(){var e=this.$store.state,t=e.team,i=e.user,r=t.mySecret.id&&i.privileges&&i.privileges.secret_folder;this.promptBodyTexmobile_show",{entrance:"Secret",vip:i.vip_level})},mounted:function(){var e=document.querySelector("#inputFocus input");e&&e.focus()}},fe=pe,me=(0,y.Z)(fe,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-form",{ref:"phoneForm",attrs:{model:e.phoneForm,rules:e.phoneRules}},[i("el-form-item",[e._v(e._s(e.promptBodyText))]),i("el-form-item",{attrs:{prop:"phone"}},[i("el-input",{attrs:{id:"inputFocus",autoComplete:"off",placeholder:e.$t("file_secret_BindPhone0")},model:{value:e.phoneForm.phone,callback:function(t){e.$set(e.phoneForm,"phone",t)},expression:"phoneForm.phone"}})],1),i("el-form-item",{ref:"code",attrs:{prop:"code"}},[i("el-input",{attrs:{placeholder:e.$t("file_secret_BindPhone1")},model:{value:e.phoneForm.code,callback:function(t){e.$set(e.phoneForm,"code",t)},expression:"phoneForm.code"}},[i("template",{slot:"append"},[i("count-down",{ref:"countDown",attrs:{btnText:e.$t("file_secret_BindPhone2"),eventName:"phone",sendCode:e.handleCode}})],1)],2)],1),i("div",{staticClass:"footer"},[i("el-button",{on:{click:function(t){return e.$emit("close")}}},[e._v(e._s(e.$t("file_secret_BindPhone3")))]),i("el-button",{attrs:{type:"primary",disabled:e.btnStatus,loading:e.loading},on:{click:e.submitForm}},[e._v(e._s(e.$t("file_secret_BindPhone4"))+" ")])],1)],1)],1)}),[],!1,null,"0a649104",null).exports,he=i(48916),_e={name:"SecretGiveUpBindPhone",props:{insistBindPone:{tit("close","ok")}}},componentName:"SecretGiveUpBindPhone",mixins:[E.Z,he.Z],methods:{insistBind:function(){this.insistBindPone(this)}}},ve=(0,y.Z)(_e,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"secret-give-up-bind-phone"},[i("p",[e._v(e._s(e.$t("file_secret_GiveUpBindPhone0")))]),i("div",{staticClass:"footer"},[i("el-button",{on:{click:function(t){return e.$emit("close","ok")}}},[e._v(e._s(e.$t("file_secret_GiveUpBindPhone1")))]),i("el-button",{attrs:{type:"primary"},on:{click:e.insistBind}},[e._v(e._s(e.$t("file_secret_GiveUpBindPhone2")))])],1)])}),[],!1,null,"06c7826c",null).exports,ge=i(47763),ye={name:"DriveUnlockSecretDialog",componentName:"DriveUnlockSecretDialog",mixins:[he.Z],props:{changeLock:Function},data:function(){var e=this;return{insertSecretPassword:{password:""},rules:{password:[{validator:function(t,i,r){(i=i.trim())||r(new Error(e.$t("file_secret_UnlockSecret5"))),r()},trigger:"blur"}]},loading:!1,errorText:""}},computed:{btnStatus:function(){return!this.insertSecretPassword.password.trim().length}},methods:{submitForm:function(){var e=this;return this.$refs.insertSecretPassword.validate((function(t){if(!t)return!1;e.loading=!0,e.setPassword()})),!1},handleClose:function(){this.$emit("close")},setPassword:function(){var e=this;return(0,s.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.errorText="",t.prev=1,t.next=4,e.insertPassword(e.insertSecretPassword.password.trim());case 4:e.loading=!1,e.changeLock(!1),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),e.loading=!1,t.t0.errorText?e.errorText=t.t0.errorText:e._error(t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,8]])})))()},forgetPwd:function(){(0,ge.onEvent("secret_forget_password",{type:this.secretUserType})}},mounted:function(){document.querySelector("#inputPwd input").focus()}},xe=ye,be=(0,y.Z)(xe,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-form",{ref:"insertSecretPassword",staticClass:"unlock-secret-dialog",attrs:{model:e.insertSecretPassword,labelPosition:"top",rules:e.rules},nativeOn:{submit:function(t){return t.preventDefault(),e.submitForm("newFile")}}},[i("el-form-item",[e._v(e._s(e.$t("file_secret_UnlockSecret0")))]),i("el-form-item",{ref:"password",attrs:{prop:"password",error:e.errorText}},[i("el-input",{attrs:{id:"inputPwd",autofocus:!0,autoComplete:"off",type:"password",placeholder:e.$t("file_secret_UnlockSecret1")},model:{value:e.insertSecretPassword.password,callback:function(t){e.$set(e.insertSecretPassword,"password",t)},expression:"insertSecretPassword.password"}})],1),i("div",{staticClass:"footer"},[i("a",{staticClass:"forget",on:{click:e.forgetPwd}},[e._v(e._s(e.$t("file_secret_UnlockSecret2")))]),i("el-button",{on:{click:e.handleClose}},[e._v(e._s(e.$t("file_secret_UnlockSecret3")))]),i("el-button",{attrs:{type:"primary",disabled:e.btnStatus,loading:e.loading},on:{click:function(t){return e.submitForm()}}},[e._v(e._s(e.$t("file_secret_UnlockSecret4"))+" ")])],1)],1)],1)}),[],!1,null,"4653f69c",null).exports,ke={name:"SecretExpireUpload",computed:{updateMemberUrl:function(){var e;return this.$ua.yun&&(e=this.$ua.docs?"docs_pc":"docs_web"),"//".concat(A.E7.VIP,"/pay/member/20?csource=pc_kdocs_secret&payconfig=svip&position=secret_dialog&component=").concat(e,"&sku_key=vip_pro_plus")}},methods:{cancel:function(){this.$emit("close","ok")}}},we=ke,$e=(0,y.Z)(we,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"secret-expire-upload"},[i("p",[e._v(e._s(e.$t("file_secret_PreventUpload0")))]),i("div",{staticClass:"footer"},[i("cloud-button",{on:{click:e.cancel}},[e._v(e._s(e.$t("file_secret_PreventUpload1")))]),i("drive-link",{attrs:{href:e.updateMemberUrl}},[i("cloud-button",{attrs:{type:"primary"}},[e._v(e._s(e.$t("file_secret_PreventUpload2")))])],1)],1)])}),[],!1,null,"dccafb96",null).exports,Ce={name:"SecretRegister",componentName:"SecretRegister",mounted:function(){var e=this;this.$on("ok",(0,s.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.$router.replace({name:"Lock"}),e.$emit("close");case 2:case"end":return t.stop()}}),t)}))))}},Se=Ce,Fe=(0,y.Z)(Se,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{staticClass:"secret-dialog-body"},[e._v(e._s(e.$t("secret_dialog_register_body")))])}),[],!1,null,null,null).exports,Te={name:"SecretVipRenew",componentName:"SecretVipRenew",mixins:[i(45767).Z],props:{onRenew:{type:Function,default:function(){}},type:{type:String,default:"file"}},mounted:function(){var e=this;this.$on("ok",(0,s.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.gotoPayPage("secret","renew",e.type),e.$emit("close");case 2:case"end":return t.stop()}}),t)}))))}},Pe=Te,Ne=(0,y.Z)(Pe,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{staticClass:"secret-dialog-body"},[e._v(e._s(e.$t("secret_dialog_vip_body")))])}),[],!1,null,null,null).exports,Ee=i(83436),Ie={mixins:[G.default],props:{ftype:String,url:String,linkType:String,fileid:String||Number,entrance:String,position:String,id:Number,tail:String},computed:{showMoreInviteTypes:function(){return"Release"===this.linkType},copyText:function(){return"".concat(this.url,"\n").concat(this.showMoreInviteTypes?this.$t("link_v1_InviteWrite4"):this.$t("link_v1_InviteWrite5"),"「").concat(this.tail,"」")}},data:function(){return{showDialog:!1,show:"image",base64Image:"",imageUrl:"",loading:!0,formLogo:Ee}},created:function(){var e=this;return(0,s.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.powerConfig.get("formInviteWan t.next=3,e.getMiniCord();case 3:return t.next=5,e.generatorShareImagePrint(e.tail,e.base64Image,(function(t){e.imageUrl=t,e.loading=!1}));case 5:case"end":return t.stop()}}),t)})))()},methods:{getMiniCord:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r,n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,N.form.get("/api/drive/form/".concat(e.fileid||e.id,"/qrcode"));case 3:i=t.sent,r=i.data,n=r.data.image,e.base64Image="data:image/png;base64,"+tion(e){var t="";switch(e){case"miniProgramCode":t="wechat";break;case"downloadImage":t="picture";break;case"qrCode":t="QRcode"}return t},toSave:function(e){k.Z.onEvent("share_file_settings",{action:this.getDwType(e),entrance:this.entrance,position:this.position,filetype:this.showMoreInviteTypes?"form":"formtemplate"});var t={keeplive:!0,title:this.$t("link_v1_InviteWrite0"),size:"small",eventName:"inviteWriteQrcode",url:this.url,text:this.tail,backprev:!0,imageUrl:this.imageUrl,base64Image:this.base64Image,inviteType:e,fname:this.fname};this.$eventBus.emit(p.B5,{event:t})},handleCopySuccess:function(){k.Z.onEvent("share_file_settings",{action:"copy",entrance:this.entrance,position:this.position,filetype:this.showMoreInviteTypes?"form":"formtemplate"}),this.$message.success(this.$t("link_v1_InviteWrite6"))},handleCopyError:function(){k.Z.onEvent("share_file_settings",{action:"copy",entrance:this.entrance,position:this.position,filetype:this.showMoreInviteTypes?"form":"formtemplate"}),this.$message.error(this.$t("link_v1_InviteWrite7"))},getTextArr:function(e,t,i){for(var r=t.split(""),n="",s=[],o=0;o<r.length;o++){var a=n+r[o];e.measureText(a).width>i&&o>=0?(s.push(n),n=r[o]):n=a}return s.push(n),s},generatorShareImagePrint:function(e,t,i){var r=this,n=document.createElement("canvas"),s=595;n.setAttribute("width","".concat(s)),n.setAttribute("height","".concat(842));var o=n.getContext("2d"),a='-apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "Helvetica Neue", Helvetica, Arial, sans-serif';o.fillStyle="#fff",o.fillRect(0,0,s,842),o.textBaseline="middle";var c=new Image;c.onload=function(){var t=117;o.fillStyle="#3D4757",o.textAlign="center",o.font="bold 30px ".concat(a),r.getTextArr(o,e,475).forEach((function(e){o.fillText(e,297.5,t),t+=50})),t=260;o.drawImage(c,161.5,t,272,272),t+=332,o.fillStyle="#767C85",o.font="30px ".concat(a),o.fillText(r.$t("link_v1_InviteWrite8"),297.5,t)},c.src=t;var l=new Image;l.setAttribute("crossOrigin","anonymous"),l.onload=function(){var e=742;o.beginPath(),o.moveTo(60,e),o.lineTo(535,e),o.strokeStyle="#E2E6ED",o.stroke(),e+=30,o.font="28px ".concat(a);var t=r.$t("link_v1_InviteWrite9"),c=s-c)/2;o.drawImage(l,u,e,30,30),o.textAlign="left",o.fillStyle="#3D4757",o.fillText(t,u+50,e+14),setTimeout((function(){i(n.toDataURL())}),500)},l.src=Ee}}},De=Ie,Ze=(0,y.Z)(De,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"invite-write-container"},[e.loading?i("Loading"):i("div",[e.showMoreInviteTypes?i("p",{staticClass:"invite-title"},[e._v(e._s(e.$t("link_v1_InviteWrite0")))]):i("p",{staticClass:"invite-tips"},[e._v(e._s(e.$t("link_v1_InviteWrite1")))]),i("div",{staticClass:"invite-link-box"},[i("input",{staticClass:"invite-link",attrs:{type:"text",id:"copy",readonly:""},domProps:{value:e.url}}),i("el-button",{directives:[{name:"clipboard",rawName:"v-clipboard",value:e.copyText,expression:"copyText"}],staticClass:"copy",attrs:{type:"primary"},on:{success:e.handleCopySuccess,error:e.handleCopyError}},[e._v(e._s(e.$t("link_v1_InviteWrite2")))])],1),e.showMoreInviteTypes?i("div",{staticClass:"invite-types"},[i("span",[e._v(e._s(e.$t("link_v1_InviteWrite3")))]),e.powerConfig.get("formInviteWayMiniprogamCode")?i("img",{attrs:{src:e.$cdn+"/kdocs/kso_ui/common/wechat_v1.svg",alt:""},on:{click:function(t){return e.toSave("miniProgramCode")}}}):e._e(),e.powerConfig.get("formInviteWayDownloadImg")?i("img",{staticClass:"invite-image-btn",attrs:{src:e.$cdn+"/kdocs/kso_ui/common/picture_v1.svg"},on:{click:function(t){return e.toSave("downloadImage")}}}):e._e(),i("img",{staticClass:"invite-qrcode-btn",attrs:{src:e.$cdn+"/kdocs/kso_ui/common/qrcode_v1.svg"},on:{click:function(t){return e.toSave("qrCode")}}})]):e._e()])],1)}),[],!1,null,null,null).exports,He=i(92592),Oe={props:{logo:{type:String,default:""},value:{type:String,required:!0,default:""},wdator:function(e){return!0!==isNaN(Number(e))}},height:{type:Number|String,default:100,validator:function(e){return!0!==isNaN(Number(e))}},format:{type:String,default:""},quality:{type:String,default:""},isBlob:{type:Boolean,default:!1}},data:function(){return{imgSrc:""}},mounted:function(){var e={width:this.width,height:this.height};this.renderQrcode(this.value,this.logo,e)},methods:{renderQrcode:function(e,t,i,r,n){var s=this;He.toCanvas(e,i,(function(e,i){if(e&&console.log(e),t){var r=i.getContext("2d"),n=new Image;return n.setAttribute("crossOrigin","anonymous"),n.src=t,void(n.onload=function(){r.drawImage(n,i.width/5*2,i.height/5*2,i.width/5,i.height/5),s.setImg(i)})}s.setImg(i)}))},setImg:function(e){if(this.isBlob){var t=this.canvas2dataurl(e,this.format,this.quality),i=this.dataurl2blbo(t);return this.imgSrc=URL.createObjectURL(i),void this.success()}this.imgSrc=e.toDataURL(),this.success()},suplit(","),i=t[0].match(/:(.*?);/)[1],r=atob(t[1]),n=r.length,s=new Uint8Array(n);n--;)s[n]=r.charCodeAt(n);return new Blob([s],{type:i})}}},Le=Oe,Ge=(0,y.Z)(Le,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"qr-code-container"},[i("img",{attrs:{src:e.imgSrc,alt:""}})])}),[],!1,null,null,null).exports,Me=i(19963),Re=i(83436),Be={name:"InviteWriteQrcode",components:{QRcode:Ge},props:{text:{type:String,require:!0,default:""},url:{type:String,require:!0,default:""},base64Image:{type:String,require:!0,default:""},inviteType:{type:String,require:!0,default:""},imageUrl:{type:String,default:""}},computed:{copyText:function(){return"".concat(this.url,"\n").concat(this.$t("link_v1_InviteWriteQrcode11"),"「").concat(this.text,"」")},isQrCode:function(){return"qrCode"===this.inviteType},isDownloadImage:function(){return"downloadImage"===this.inviteType},isMiniProgramCode:function(){return"miniProgramCode"===this.inviteType},btnText:function(){var e="";switch(this.inviteType){case"qrCode":e=this.$t("link_v1_InviteWriteQrcode12");break;casese"miniProgramCode":e=this.$t("link_v1_InviteWriteQrcode14")}return e}},data:function(){return{formLogo:Re,qrcodeUrl:"",formHost:"f.wps.cn"}},methods:{handleCopySuccess:function(){this.$message.success(this.$t("link_v1_InviteWriteQrcode15"))},handleCopyError:function(){this.$message.error(this.$t("link_v1_InviteWriteQrcode16"))},success:function(e){this.qrcodeUrl=e},downloadBase64Img:function(e,t){if(this.$ua.isTabletClient)(0,Me.mP)({link:e,fname:t,action:1});else if(window.navigator.msSaveBlob){for(var i=atob(e.split(",")[1]),r=i.length,n=new Uint8Array(r);r--;)n[r]=i.charCodeAt(r);var s=new Blob([n]);window.navigator.msSaveBlob(s,t)}else{var o=document.createElement("a");o.href=e,o.download=this.text+".png",o.click()}},save:function(){try{var e=this.isDownloadImage?this.imageUrl:this.base64Image;e=this.isQrCode?this.qrcodeUrl:e,this.downloadBase64Img(e,this.text+".png")}catch(e){console.log(e)}}}},Ae=(0,y.Z)(Be,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"invite-write-qrcode-container"},[e.isDownloadImage?[i("img",{staticClass:"invite-write-image",attrs:{width:"222",height:"315",src:e.imageUrl}}),i("p",{staticClass:"a4"},[e._v("A4"+e._s(e.$t("link_v1_InviteWriteQrcode0")))])]:e.isQrCode?[i("QRcode",{attrs:{value:e.url,logo:e.formLogo,width:150,height:150},on:{success:e.success}}),i("p",{staticClass:"title"},[e._v(e._s(e.text))]),i("p",{staticClass:"tips"},[e._v(e._s(e.$t("link_v1_InviteWriteQrcode1"))+"「"+e._s(e.$t("link_v1_InviteWriteQrcode2"))+"」"+e._s(e.$t("link_v1_InviteWriteQrcode3")))])]:e.isMiniProgramCode?[i("img",{attrs:{src:e.base64Image,width:"150",height:"150"}}),i("p",{staticClass:"title"},[e._v(e._s(e.text))]),i("p",{staticClass:"tips"},[e._v(e._s(e.$t("link_v1_InviteWriteQrcode1"))+"「"+e._s(e.$t("link_v1_InviteWriteQrcode2"))+"」"+e._s(e.$t("link_v1_InviteWriteQrcode3")))])]:e._e(),i("el-button",{staticClass:"download-btn",attrs:{disabled:e.$ua.wxmacpcmini||e.$ua.WPS,type:"primary"},on:{click:e.save}},[e._v(e._s(e.btnText))]),e.$ua.wxmacpcmini?i("p",{staticClass:"text"},[i("span",[e._v("Mac"+e._s(e.$t("link_v1_InviteWriteQrcode4")))]),i("el-button",{directives:[{name:"clipboard",rawName:"v-clipboard",value:e.copyText,expression:"copyText"}],staticClass:"copy",attrs:{type:"text"},on:{success:e.handleCopySuccess,error:e.handleCopyError}},[e._v(e._s(e.$t("link_v1_InviteWriteQrcode5")))]),i("span",[e._v(e._s(e.$t("link_v1_InviteWriteQrcode6")))])],1):e.$ua.WPS?i("p",{staticClass:"text"},[e._v(e._s(e.$t("link_v1_InviteWriteQrcode7"))+e._s(e.formHost)+e._s(e.$t("link_v1_InviteWriteQrcode8")))]):e._e(),e.$ua.wxmacpcmini||e.$ua.WPS||!e.isMiniProgramCode?e._e():i("p",{staticClass:"text"},[i("span",[e._v(e._s(e.$t("link_v1_InviteWriteQrcode9")))]),i("el-button",{directives:[{name:"clipboard",rawName:"v-clipboard",value:e.copyText,expression:"copyText"}],staticClass:"copy",attrs:{type:"text"},on:{success:e.handleCopySuccess,error:e.handleCopyError}},[e._v(e._s(e.$t("link_v1_InviteWriteQrcode5")))]),i("span",[e._v(e._s(e.$t("link_v1_InviteWriteQrcode10")))])],1)],2)}),[],!1,null,null,null).exports,je={name:"DriveRenameSharefolder",mixins:[E.Z],components:{},props:{id:{type:Number,required:!0},fileId:Number,name:String,isGroup:{type:Boolean,default:!1}},data:function(){return{shareFolder:{name:""},presetNames:[this.$t("link_v1_RenameShareFolder3"),this.$t("link_v1_RenameShareFolder4"),this.$t("link_v1_RenameShareFolder5")],rules:{name:[{pattern:/^[^/\\:*?"<>|]+$/,message:(0,c.exception)("illegalFname"),trigger:"change"},{max:240,message:(0,c.exception)("groupLengthTooLong"),trigger:"change"}]},loading:!1,committing:!1}},created:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.name){t.next=4;break}e.setName(e.name),t.next=11;break;case 4:return e.loading=!0,t.next=7,N.drive.get("/api/v3/groups/".concat(e.id));case 7:i=t.sent,r=i.data,e.setName(r.name),e.loadi()}}),t)})))()},computed:{btnStatus:function(){return!(this.shareFolder.name.trim().length>0)}},methods:{setName:function(e){this.shareFolder.name=e},submitForm:function(e){var t=this;return this.$refs[e].validate(function(){var e=(0,s.Z)(a().mark((function e(i){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i){e.next=16;break}return e.prev=1,t.committing=!0,e.next=5,t.$store.dispatch(u.klq,{params:{tid:t.id},name:t.shareFolder.name});case 5:t.fileId&&!t.isGroup?(t.$store.dispatch(u.xeZ,{id:t.fileId}),t.$store.dispatch(u.vcH,{childKey:"".concat(d.bg.folder).concat(t.fileId)})):(t.$store.dispatch(u.xeZ,{type:"team",id:t.id}),t.$eventBus.emit(p.aW,"MyGroup")),t.$message.success(t.$t("link_v1_RenameShareFolder6")),t.handleClose(),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),t.committing=!1,t._error(e.t0);case 14:e.next=17;break;case 16:return e.abrupt("return",!1);case 17:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}()),!1},handleClose:function(){this.$emit("close")}},directives:{focus:m.Z}},We=je,Ve=(0,y.Z)(We,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.loading?i("Loading"):i("div",{staticClass:"drive-remove-sharefolder"},[i("div",{class:{"drive-remove-sharefolder-inner":!0}},[i("el-form",{ref:"shareFolder",attrs:{model:e.shareFolder,rules:e.rules,labelWidth:"100px",labelPosition:"top",prop:"name"},nativeOn:{submit:function(t){return t.preventDefault(),e.submitForm("shareFolder")}}},[i("el-form-item",{attrs:{label:"",prop:"name"}},[i("el-input",{directives:[{name:"focus",rawName:"v-focus"},{name:"pad-focus",rawName:"v-pad-focus"}],attrs:{placeholder:e.$t("link_v1_RenameShareFolder0"),disabled:e.committing},model:{value:e.shareFolder.name,callback:function(t){e.$set(e.shareFolder,"name",t)},expression:"shareFolder.name"}})],1),i("div",{staticClass:"footer"},[i("el-button",{on:{click:e.handleClose}},[e._v(e._s(e.$t("link_v1_RenameShareFolder1")))]),i("el-button",{attrs:{type:"primary",disabled:e.btnStatus,loading:e.committing},on:{click:function(t){return e.submitForm("shareFolder")}}},[e._v(e._s(e.$t("link_v1_RenameShareFolder2")))])],1)],1)],1)])}),[],!1,null,null,null).exports,Ue={id:0,name:"",creator:"",members:{},membersCount:0,role:"member"},ze={name:"DriveDeleteSharefolder",mixins:[L.Z,R],props:{source:{type:Object,validator:function(e){return!(!e.id||!~["admin","creator","read_member","manager","member"].indexOf(e.user_role))},default:Object.assign({},Ue)},onCommit:{type:Functdata:function(){return Object.assign({loading:!1,commimputed:{disabled:function(){return"creator"===this.role&&!this.check},avatarMemebers:function(){return this.members.filter((function(e,t){return t<4}))}},created:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.source.name&&e.source.user_role){t.next=14;break}return e.loading=!0,t.next=4,N.drive.get("/api/v3/groups/".concat(e.source.id),{params:{include:"recent_members"}});case 4:i=t.sent,r=i.data,e.name=r.name,e.role=r.user_role,e.creator=r.creator.name,e.members=r.recent_members||{},e.membersCount=r.member_count,e.loading=!1,t.next=19;break;case 14:e.name=e.source.name,e.creator=e.source.creator.name,e.members=e.source.recent_members||{},e.membersCount=e.source.member_count,e.role=e.source.user_role||"member";case 19:case"end":return t.stop()}}),t)})))()},methods:{handleClose:function(){this.$emit("close")},onCommitDelete:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.committing=!0,t.prev=1,t.next=4,e.onCommit(Object.assign({},e.source,{user_role:e.role}));case 4:if(i=t.sent,e.handleClose(),!(i&&i.data&&i.data.taskid)){t.next=10;break}return r="creator"===e.role?"false":"true",t.next=10,e.asyncMessage("delete",e.source.id,i.data.taskid,!!r);case 10:"creator"===e.role&&e.$store.state.user.is_plus?e.deleteMessage():e.$message.success(e.$t("link_v1_RemoveShareFolder8")),k.Z.onEvent("delete_success",{type:"shared_folder",identity:e.role||0}),t.next=18;break;case 14:t.prev=14,t.t0=t.catch(1),e._error(t.t0),k.Z.onEvent("delete_fail",{type:"shared_folder",errorcore:t.t0.response&&t.t0.response.data&&t.t0.response.data.result||0});case 18:e.committing=!1;case 19:case"end":return t.stop()}}),t,null,[[1,14]])})))()}}},qe=ze,Ke=(0,y.Z)(qe,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.loading?i("Loading"):i("div",{staticClass:"drive-delete-sharefolder",attrs:{tabindex:"0"}},[i("p",{attrs:{tabindex:"0"}},[e._v(e._s(e.$t("link_v1_RemoveShareFolder0"))+" "),i("b",[e._v(e._s(e.name))])]),"creator"===e.role?i("div",{staticClass:"creator-content"},[i("p",{attrs:{tabindex:"0"}},[e._v(e._s(e.$t("link_v1_RemoveShareFolder1")))]),i("div",[i("div",{staticClass:"avatars",class:"avatar"+e.members.length},[e._l(e.avatarMemebers,(function(e){return i("Avatar",{key:e.id,attrs:{size:"36",avatarSrc:e.avatar}})})),e.members.length>4?i("div",{staticClass:"avatar"},[i("Icon",{staticClass:"avatar-more",attrs:{type:"more"}})],1):e._e(),i("span",{staticClass:"members-num"},[e._v(e._s(e.membersCount)+e._s(e.$t("link_v1_RemoveShareFolder2")))])],2)]),i("div",{staticClass:"checkbox"},[i("el-checkbox",{model:{value:e.check,callback:function(t){e.check=t},expression:"check"}},[e._v(e._s(e.$t("link_v1_RemoveShareFolder3")))])],1)]):i("p",{attrs:{tabindex:"0"}},[e._v(" "+e._s(e.$t("link_v1_RemoveShareFolder4"))+" "),i("b",[e._v(e._s(e.creator))]),e._v(e._s(e.$t("link_v1_RemoveShareFolder5"))+" ")]),i("div",{staticClass:"footer"},[i("el-button",{on:{click:e.handleClose}},[e._v(e._s(e.$t("link_v1_RemoveShareFolder6")))]),i("el-button",{attrs:{type:"danger",loading:e.committing,disabled:e.disabled},on:{click:e.onCommitDelete}},[e._v(e._s(e.$t("link_v1_RemoveShareFolder7")))])],1)])}),[],!1,null,null,null).exports,Qe={name:"ModifyPermissionInfo",componentName:"ModifyPermissionInfo",mixins:[E.Z],props:erText:function(){return this.upFolder?this.getText(this.upFolder):""},appendText:function(){return this.downFolder?this.getText(this.downFolder):""}},created:function(){this.$on("ok",this.ok)},methods:{getText:function(e){return e.map((function(e){return e.name})).join(this.$t("file_permission_ModifyPermissionInfo3"))},ok:function(){this.okCallBack&&this.okCallBack()}}},Ye=(0,y.Z)(Qe,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.centerText?i("p",[e._v(e._s(e.$t("file_permission_ModifyPermissionInfo0"))+" "),i("span",[e._v(e._s(e.centerText))]),e._v(" "+e._s(e.$t("file_permission_ModifyPermissionInfo1")))]):e._e(),e.appendText?i("p",[e._v(e._s(e.$t("file_permission_ModifyPermissionInfo2")))]):e._e(),e.appendText?i("p",[i("span",[e._v(e._s(e.appendText))])]):e._e()])}),[],!1,null,"133584a3",null).exports,Je={name:"ModifyPermissionInfoSub",componentName:"ModifyPermissionInfoSub",components:{KModifyPermissionInfoSub:function(){return i.e(9378).then(i.bind(i,99378))}},props:{memberList:Array,downFile:Array,isSeeMode:Boolean,isAllMode:Boolean,okCallBack:Function},mixins:[E.Z],created:function(){this.$on("ok",this.ok)},methods:{onToast:function(e){this.$message.error(e)},onClose:function(){this.$emit("close")},onSubmit:function(){var e=this;return(0,s.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.okCallBack();case 2:e.$emit("close");case 3:case"end":return t.stop()}}),t)})))()}}},Xe=Je,et=(0,y.Z)(Xe,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("KModifyPermissionInfoSub",{attrs:{memberList:e.memberList,downFile:e.downFile,isSeeMode:e.isSeeMode,isAllMode:e.isAllMode,on],components:{KModifyFilePermission:function(){return Promise.all([i.e(1820),i.e(1897),i.e(6788),i.e(667),i.e(4633),i.e(427)]).then(i.bind(i,20427))}},props:{source:{type:Object,required:!0},onError:Function},computed:{isLinkGroup:function(){return"Team"===this.$route.name},isEnt:function(){return"Enterprise"===this.$route.name},tid:function(){var e=this.source.groupid||this.$store.state.route.params.tid;return+e},pid:function(){var e=/PrivateOld|Private/.test(this.$store.state.route.name)?this.$store.getters.file.parentid:this.$store.state.route.params.fid,t=this.source.parentid||e||0;return+t},team:function(){return this.$store.state.team.current.id?this.$store.state.team.current:{id:this.source.groupid,:functioObject.assign(function(e){this.$emit("propsChange",{title:e})},onToast:function(e){this.$message.success(e)},updateSetting:function(e){this.$store.commit(u.BE8,e)},toFilePerSetting:function(){var e=this,t=this,i=this.$store.state.team.filePerSetting,r=i.ban_download,n=i.ban_share,s=i.ban_delete,o=i.ban_creator_delete;this.dialog("ModifyFilePerSetting",{groupid:+this.$route.params.tid,banDownLoad:r,banShare:n,banDelete:s,banCreatorDelete:o,updateSetting:function(i){e.$store.commit(u.BE8,i);var r=t.$refs.modifyFilePermission,n=i.ban_download,s=i.ban_share,o=i.ban_delete,a=i.ban_creator_delete;r.filePerSetting=Object.assign({},r.filePerSetting,{banDownLoad:n,banShare:s,banDelete:o,banCreatorDelete:a})},beforeCloseFun:function(e){var t=e.current;return("DriveOpenShare"===t||"DriveModifyFilePermission"===t)&&(e.onChange("DriveClinkFile",e.source),!0)},backprev:!0})}}},it=tt,rt=(0,y.Z)(it,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("KModifyFilePermission",{ref:"modifyFilePermission",attrs:{groupid:e.tid,pid:e.pid,selectedFile:e.source,team:e.team,updateAcl:e.updateAcl,changeTitle:e.changeTitle,isLinkGroup:e.isLinkGroup,isShowSetting:e.isEnt,updateSetting:e.updateSetting,toast:e.onToast,onError:e}),[],!1,null,null,null).exports,nt={name:"ModifyFilePermission",components:{KModifyFilePerSetting:function(){return i.e(3723).then(i.bind(i,73723))}},props:{groupid:{type:Number,required:!0},updateSetting:{type:Function,default:function(){}},banDownLoad:{type:Boolean,default:!1},banShare:{type:Boolean,default:!1},banDelete:{type:Boolean,default:!1},banCreatorDelete:{type:Boolean,default:!1}}},st=(0,y.Z)(nt,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("KModifyFilePerSetting",{staticClass:"drive-file-per-setting",attrs:{groupid:e.groupid,updateSetting:e.updateSetting,banDownLoad:e.banDownLoad,banShare:e.banShare,banDelete:e.banDelete,banCreatorDelete:e.banCreatorDelete}})],1)}),[],!1,null,null,null).exports,ot={name:"DriveExitShare",componentName:"DriveExitShare",props:{file:{type:Object,required:!0},skipFlush:{type:Boolean,default:!1},showClearRecord:{type:Boolean,default:!1},onCommit:{type:Function,default:function(){return Promise.resolve(!0)}}},computed:{onlyName:function(){return(0,l.subFileName)(this.file.fname||this.file.name)}},methods:{onRemoveRecord:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r,n,s;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i="shared_file",k.Z.onEvent("delete_record_click",{type:i}),t.prev=2,r=[],(n=e.file.fileid||e.file.id)&&(r=[parseInt(n)]),t.next=8,e.$store.dispatch(u.CG9,{ids:r});case 8:e.$store.dispatch(u.DJg),e.$message.success(e.$t("link_v1_Exit5")),e.$emit("close"),k.Z.onEvent("delete_record_success",{type:i}),t.next=20;break;case 14:t.prev=14,t.t0=t.catch(2),e._error(t.t0),s=-1,t.t0.response&&t.t0.response.data&&t.t0.response.data.result&&(s=t.t0.response.data.result),k.Z.onEvent("delete_record_fail",{type:i,errorcode:s});case 20:case"end":return t.stop()}}),t,null,[[2,14]])})))()}},created:function(){this.$on("ok",(0,s.Z)(a().mark((function e(){var t,i,r,n,s,o,c,l,d,p,f,m,h,_;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.file,i=t.roamingid,r=t.sid,n=t.id,s=t.fileid,o=t.link,c=t.isshare,l=t.link_id,n=parseInt(n||s),!l){e.next=6;break}r=l,e.next=27;break;case 6:if(!o){e.next=10;break}r=o.sid,e.next=27;break;case 10:if(!c){e.next=27;break}return e.prev=11,e.next=14,N.drive.get("/api/v5/links/".concat(n));case 14:d=e.sent,p=d.data,r=p.linkinfo.sid,e.next=27;break;case 19:if(e.prev=19,e.t0=e.catch(11),f=e.t0||{},m=f.response,h=(m||{}).data,"permissionDenied"===(_=(h||{}).result)||"linkClosed"===_){e.next=27;break}return this._error(e.t0),e.abrupt("return");case 27:if(e.prev=27,!r){e.next=33;break}return e.next=31,this.$store.dispatch(u.iDL,{skipFlush:this.skipFlush,sid:r,ids:[n]});case 31:e.next=36;break;case 33:if(!i){e.next=36;break}return e.next=36,this.$store.dispatch(u.Mc8,{skipFlush:this.skipFlush,removeFileAndRecord:[this.file]});case 36:return e.next=38,this.onCommit({ids:[n],sync:!0});case 38:this.$message.success(this.$t("link_v1_Exit6")),this.$emit("close"),e.next=45;break;case 42:e.prev=42,e.t1=e.catch(27),this._error(e.t1);case 45:case"end":return e.stop()}}),e,this,[[11,19],[27,42]])}))))}},at=ot,ct=(0,y.Z)(at,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.showClearRecord?i("div",[e._v(" "+e._s(e.$t("link_v1_Exit0"))),i("b",{staticClass:"delname"},[e._v("「"+e._s(e.onlyName)+"」")]),i("div",{staticClass:"delete"},[e._v(" "+e._s(e.$t("link_v1_Exit1"))+" "),i("icon",{attrs:{type:"clear-trash"}}),i("a",{on:{click:e.onRemoveRecord}},[e._v(e._s(e.$t("link_v1_Exit2")))])],1)]):i("div",{staticClass:"delname"},[e._v(" "+e._s(e.$t("link_v1_Exit3"))+" "),i("b",[e._v("「"+e._s(e.onlyName)+"」")]),i("p",[e._v(e._s(e.$t("link_v1_Exit4")))])])])}),[],!1,null,null,null).exports,lt=i(80129),ut=i.n(lt);function dt(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function pt(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?dt(Object(i),!0).forEach((function(t){(0,n.Z)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):dt(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var ft={methods:{createLink:function(e){var t=arguments;return(0,s.Z)(a().mark((function i(){var r,n;return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return r=t.length>1&&void 0!==t[1]?t[1]:{},i.prev=1,i.next=4,N.drive.post("/api/v5/links",ut().stringify(pt(pt({},r),{},{fileid:e})));case 4:return n=i.sent,i.abrupt("return",n);case 8:return i.prev=8,i.t0=i.catch(1),i.abrupt("return",i.t0.response);case 11:case"end":return i.stop()}}),i,null,[[1,8]])})))()},createEditLink:function(e,t){return(0,s.Z)(a().mark((function i(){var r;return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,N.drive.post("/api/v5/links/create_invite_edit_link",ut().stringify({groupid:t,fileid:e}));case 3:return r=i.sent,i.abrupt("return",r);case 7:return i.prev=7,i.t0=i.catch(0),i.abrupt("return",i.t0.response);case 10:case"end":return i.stop()}}),i,null,[[0,7]])})))()},reOpenEditLink:function(e){var t=arguments;return(0,s.Z)(a().mark((function i(){var r,n;return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return r=t.length>1&&void 0!==t[1]?t[1]:{},i.prev=1,i.next=4,N.drive.put("/api/v5/links/reset_invite_edit_link/".concat(e),pt(pt({},r),{},{fileid:e}));case 4:return n=i.sent,i.abrupt("return",n);case 8:return i.prev=8,i.t0=i.catch(1),i.abrupt("return",i.t0.response);case 11:case"end":return i.stop()}}),i,null,[[1,8]])})))()},onDelLink:function(e,t){return(0,s.Z)(a().mark((function i(){var r;return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,N.drive.delete("/api/v5/groups/".concat(t,"/files/").concat(e,"/share"));case 3:return r=i.sent,i.abrupt("return",r);case 7:return i.prev=7,i.t0=i.catch(0),i.abrupt("return",i.t0.response);case 10:case"end":return i.stop()}}),i,null,[[0,7]])})))()},onDelCoopLink:function(e){return(0,s.Z)(a().mark((function t(){var i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,N.drive.put("/api/v5/links/".concat(e),{ext_perm_list:["collaboration_off"]});case 3:return i=t.sent,t.abrupt("return",i);case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",t.t0.response);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},updateLink:function(e){var t=arguments;return(0,s.Z)(a().mark((function i(){var r,n;return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return r=t.length>1&&void 0!==t[1]?t[1]:{},i.prev=1,i.next=4,N.drive.put("/api/v3/links/".concat(e),pt(pt({},r),{},{sid:e}));case 4:return n=i.sent,i.abrupt("return",n);case 8:return i.prev=8,i.t0=i.catch(1),i.abrupt("return",i.t0.response);case 11:case"end":return i.stop()}}),i,null,[[1,8]])})))()}}},mt=i(32839),ht=i(73673),_t={name:"YunDelLink",componentName:"YunDelLink",props:{members:Array,fid:Number,gid:Number,sid:String,fname:String,team:String,isFolderLink:{type:Boolean,default:!1},position:String,entrance:String,supportCoop:Boolean,cid:String},mixins:[ft],data:function(){return{loading:!1,committing:!1,count:"0",defaultGroupSvg:"".concat(this.$cdn,"/kdocs/kso_ui/common/default_group.svg")}},computed:{user:function(){return this.$store.state.user}},created:function(){var e=this;return(0,s.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=!e.isFolderLink,!t.t0){t.next=4;break}return t.next=4,e.getCount();case 4:e.$on("ok",(0,s.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.committing=!0,e.next=4,this.delLink(this.fid,this.gid);case 4:200===(t=e.sent).status?(this.$message.success(this.$t("link_v1_DelLink10")),"Sharing"===this.$store.state.route.name?(this.$store.commit(u.aFD,{ids:[this.fid]}),this.$store.dispatch(u.xgE)):"Share"===this.$store.state.route.name&&"mine"===(0,mt.mi)(this.$store.state.ui.listColumnTypes.Share,ht.oQ.name).value&&this.$store.commit(u.aFD,{ids:[this.fid]}),this.$emit("close","ok")):403===t.status&&(this.committing=!1,this.$message.error(t.data.msg)),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),this.committing=!1,this._error(e.t0.response.data.msg);case 12:case"end":return e.stop()}}),e,this,[[0,8]])}))));case 5:case"end":return t.stop()}}),t)})))()},methods:{getCount:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!e.sid){t.next=7;break}return t.next=4,N.drive.get("/api/v5/links/".concat(e.sid,"/collaborators/count?with_team_member=true"));case 4:i=t.sent,r=i.data,e.count=101===r.count?"100+":r.count+"";case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),t.t0.response&&t.t0.response.data&&e.$message.error(t.t0.response.data.msg);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()},delLink:function(e,t){var i=this;return(0,s.Z)(a().mark((function r(){return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!i.isFolderLink){r.next=6;break}return r.next=3,N.drive.delete("/api/v5/folder_links/".concat(e));case 3:return r.abrupt("return",r.sent);case 6:if(k.Z.onEvent("share_file_settings",{type:"share",entrance:i.entrance,position:i.position,groupid:i.gid||0,fileid:i.fid||0,action:"permission_closelink_sure"}),!i.supportCoop){r.next=13;break}return r.next=10,i.onDelCoopLink(i.cid);case 10:r.t0=r.sent,r.next=16;break;case 13:return r.next=15,i.onDelLink(e,t);case 15:r.t0=r.sent;case 16:return r.abrupt("return",r.t0);case 17:case"end":return r.stop()}}),r)})))()}}},vt=_t,gt=(0,y.Z)(vt,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.loading?i("Loading"):i("div",{staticClass:"yun-del-link"},[i("p",[e._v(e._s(e.$t(e.supportCoop?"link_v1_DelLink11":"link_v1_DelLink0"))),i("b",[e._v("「"+e._s(e.fname)+"」")])]),"0"!==e.count?i("div",{staticClass:"content"},[i("p",[e._v(e._s(e.$t(e.supportCoop?"link_v1_DelLink12":"link_v1_DelLink1"))+e._s(e.team?"「"+e.team+"」"+e.$t("link_v1_DelLink2"):e.$t("link_v1_DelLink3"))+e._s(e.$t("link_v1_DelLink4")))]),i("div",{staticClass:"avatars",class:"avatar"+e.members.length},[e._l(e.members.slice(0,4),(function(t){return i("Avatar",{key:t.id,attrs:{size:"36",avatarSrc:t.team_id?e.defaultGroupSvg:t.avatar}})})),e.members.length>4?i("div",{staticClass:"avatar"},[i("Icon",{staticClass:"avatar-more",attrs:{type:"more"}})],1):e._e(),i("span",{staticClass:"members-num"},[e._v(e._s(e.count)+e._s(e.$t("link_v1_DelLink5")))])],2)]):i("div",{staticClass:"content"},[e.team?i("p",[e._v(e._s(e.$t(e.supportCoop?"link_v1_DelLink12":"link_v1_DelLink1"))+"「"+e._s(e.team)+"」"+e._s(e.$t("link_v1_DelLink6")))]):i("p",[e._v(e._s(e.$t(e.supportCoop?"link_v1_DelLink13":"link_v1_DelLink7")))])])])}),[],!1,null,null,null).exports,yt={name:"DriveCancelFileLink",componentName:"DriveExitShare",props:{file:{type:Object,required:!0}},computed:{onlyName:function(){return(0,l.subFileName)(this.file.fname||this.file.name)}},created:function(){this.$on("ok",(0,s.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=this.file.roamingid,!this.file.link){e.next=7;break}return e.next=5,this.$store.dispatch(u.LUM,{gid:this.file.link.groupid,fid:this.file.link.fileid});case 5:e.next=10;break;case 7:if(!t){e.next=10;break}return e.next=10,this.$store.dispatch(u.Mc8,{removeFileAndRecord:[this.file]});case 10:this.$message.success(this.$t("link_v1_CancelFileLink1")),this.$emit("close"),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),this._error(e.t0);case 17:case"end":return e.stop()}}),e,this,[[0,14]])}))))}},xt=(0,y.Z)(yt,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"delname"},[e._v(e._s(e.$t("link_v1_CancelFileLink0")))])])}),[],!1,null,null,null).exports,bt={name:"DriveConfirmTransfer",componentName:"DriveConfirmTransfer",props:{fname:String,newOwner:{type:Object,default:function(){return{}}},okCallBack:Function},computed:{},methods:{onOk:function(){this.okCallBack&&this.okCallBack()}},created:function(){},mounted:function(){this.$on("ok",this.onOk)},beforeDestroy:function(){}},kt=(0,y.Z)(bt,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"confirm-transfer-container"},[i("div",{staticClass:"tips-box"},[i("p",[e._v(e._s(e.$t("link_v1_ConfirmTransfer0"))+" "),i("strong",[e._v(e._s(e.fname))]),e._v(" "+e._s(e.$t("link_v1_ConfirmTransfer1"))+" "),i("strong",[e._v(e._s(e.newOwner.name))])]),i("ul",[i("li",[e._v(e._s(e.$t("link_v1_ConfirmTransfer2")))]),i("li",[e._v(e._s(e.$t("link_v1_ConfirmTransfer3"))+" "),i("strong",[e._v(e._s(e.$t("link_v1_ConfirmTransfer4")))]),e._v(" "+e._s(e.$t("link_v1_ConfirmTranss,wt={name:"DriveBeforeTransfe",props:{okCallBack:Function},computed:{},methods:{onOk:function(){this.okCallBack&&this.okCallBack()}},created:function(){},mounted:function(){this.$on("ok",this.onOk)},beforeDestroy:function(){}},$t=(0,y.Z)(wt,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"before-transfer-container"},[i("div",{staticClass:"tips-box"},[i("p",[e._v(e._s(e.$t("link_v1_BeforeTransfer0")))])])])}),[],!1,null,null,null).exports,Ct=void 0,St={name:"DriveTransferMember",componentName:"DriveTransferMember",props:{entrance:{type:Object,default:function(){return{}}},memberRoleType:{type:String,default:"creator,admin,manager,member,read_member"},emptySearchInfo:{type:String,default:function(){Ct.$t("link_v1_TransferMember0")}},emptyInfo:{type:String,default:function(){Ct.$t("link_v1_TransferMember0")}},righk_v1_TransferMember1")}},hiddenIds:Array,okCallBack:Function},methods:{onCancel:function(){this.$emit("close")},onSubmit:function(e){this.okCallBack&&this.okCallBack(e)}},created:function(){},beforeDestroy:function(){}},Ft=(0,y.Z)(St,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"transfer-member-container"},[i("KMemberSelector",{ref:"memberSelector",attrs:{onSubmit:e.onSubmit,hiddenIds:e.hiddenIds,entrance:e.entrance,onCancel:e.onCancel,rightTitle:e.rightTitle,emptyInfo:e.emptyInfo,emptySearchInfo:e.emptySearchInfo,memberRoleType:e.memberRoleType,showNextHeader:!1,showInfoCard:!1,single:!0}})],1)}),[],!1,null,null,null).exports,Tt=i(20296),Pt=i.n(Tt);function Nt(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(eriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}var Et=!1,It={name:"SearchInput",inheritAttrs:!1,data:function(){return{keyword:"",inputKeyword:"",lastKeyword:""}},props:{delay:{type:Number,default:200},clearIcon:{type:Boolean,default:!1},resetKeyword:{type:Boolean},mt.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Nt(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPr,t))}))}return e}({},this.$listeners)}},methods:{getI18nText:r.GH,compositionStart:function(){Et=!0},compositionUpdate:function(){Et=!0},compositionEnd:function(){Et=!1},handleInput:function(){var e=this;setTimeout((function(){Et|)}),0)},handleClose:function(){this.keyword="",this.inputKeyword="",this.lastKeyword="",this.$emit("clearKeyword")},trim:function(e,t){return e.length>t?e.substr(0,t):e},querySearch:function(){this.keyword?this.doSearch():(this.lastKeyword="",this.$emit("clearKeyword"))},doSearch:function(){}},mounted:function(){this.doSearch=Pt()((function(){this.keyword=this.trim(this.keyword,this.maxlength),this.keyword!==this.lastKeyword&&(this.lastKeyword=this.keyword,this.keyword&&this.keyw"search",this.keyword))}),this.delay)},directives:{focus:{inserted:function(e){var t=e.getElementsByClassName("kdv-input__inner")[0];setTimeout((function(){t&&t.focus()}),50)}}}},Dt=It,Zt=(0,y.Z)(Dt,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-input",e._g(e._b({directives:[{name:"focus",rawName:"v-focus"},{name:"pad-focus",rawName:"v-pad-focus"}],staticClass:"search-input",attrs:{maxlength:e.maxlength},nativeOn:{input:function(t){return e.handleInput.apply(null,arguments)},compositionstart:function(t){return e.compositionStart.apply(null,arguments)},compositionupdate:function(t){return e.compositionUpdate.apply(null,arguments)},compositionend:function(t){return e.compositionEnd.apply(null,arguments)}},model:{value:e.inputKeyword,callback:function(t){e.inputKeyword=t},expression:"inputKeyword"}},"el-input",e.$attrs,!1),e.listeners),[i("template",{slot:"prepend"},[i("Icon",{attrs:{type:"search"}})],1),this.inputKeyword?i("template",{slot:"append"},[i("a",{attrs:{href:"javascript:;"},on:{click:function(t){return t.stopPropagation(),e.handleClose.apply(null,arguments)}}},[e.clearIcon?[i("Icon",{attrs:{type:"close"}})]:[e._v(" "+e._s(e.getI18nText("c_search_SearchInput0"))+" ")]],2)]):e._e()],2)}),[],!1,null,"72198b8e",null),Ht=Zt.exports,Ot=i(90972),Lt=i(50276),Gt=i(48005),Mt=i(13218),Rt=i.n(Mt),Bt=1),Wt=iocess",props:{status:{validator:function(e){return!("string"!=typeof e&&!Rt()(e))}},data:{validator:function(e){return At()(e)}}},data:function(){return{accountInfo:""}},mixins:[Ot.Z],computed:{showExtraAction:function(){var e=this.status.message;return 404===this.state||500===this.state||502===this.state||503===this.state||504===this.state||"Network Error"===e},fileList:function(){return this.$stturn this.$store.state.team.hasBackupList&&this.isEntSpace&&0===this.fileList.length&&!this.$route.params.fid},isEntSpace:function(){return"EntSpace"===this.$route.name},showError:function(){if(403===this.state){try{if("userNotLogin"===this.status.response.data.result&&this.$ua.wps18and19)return!1}catch(e){}return!0}return this.state>=0},isChangeErrorUI:function(){var e=this.status.response||{},t=e.status,i=e.data,r=void 0===i?{}:i;return 500===t&&"string"==typeof r||403===t&&["permissionDenied","notGroupMember"].includes(r.result)},errorText:function(){var e=(0,r.GH)("c_file_Process1");if(this.state>=0){var t=(this.status.response||{}).data,i=void 0===t?{}:t,n=i.result,s=i.msg;if(this.isChangeErrorUI)return(0,r.GH)("c_file_Process8");e=this.showExtraAction?(0,r.GH)("c_file_Process_Error"):~["groupNotExist","InvalidGroupId"].indexOf(n)?(0,r.GH)("c_file_Process5"):"invalidDeviceId"===n?(0,r.GH)("c_file_Process6"):Lt.Z[n]||s||e}return e},state:function(){return~[Gt.H$,Gt.jP,Gt.d0,Gt.Ti].indexOf(this.status)?this.status:Rt()(this.status)&&(this.status.response||{}).status||0},icon:function(){return"file"}},methods:{getI18nText:r.GH,refresh:function(){this.$emit("reload")},onCommand:function(){var e=this.$emit;e.apply(this,["command"].concat((0,b.Z)(Array.from(arguments))))},reload:function(){(0,Vt.Y)({command:"refresh",params:"fromNav"},this)}},watch:{status:function(e){var t=Wt()(e,"response.data.result");["tagNotExists"].includes(t)&&this.$router.push({name:"Latest"})},isChangeErrorUI:function(e){e&&(this.accountInfo="".concat((0,r.GH)("c_file_Process9")," ").concat(this.$store.state.user.name," （").concat(this.$store.state.company.currentView.companyname||(0,r.GH)("c_file_Process10"),"）"))}}},zt=Ut,qt=(0,y.Z)(zt,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{height:"100%"}},[0!==e.data.length||e.hasBackupList||"done"!==e.state&&"translating"!==e.state?"entering"!==e.state?i("div",{staticClass:"components-list-process new-list-component-process",class:{"wps-list-process":e.$ua.WPS&&!e.$ua.wps18and19,"yun-list-process":e.$ua.yun||e.$ua.wps18and19}},["loading"===e.state?e._t("loading"):e.showError?i("div",{staticClass:"components-list-process-innerblock"},[i("div",{staticClass:"components-list-process-icon"},[e.$ua.yun||e.$ua.wps18and19?i("div",{staticClass:"yun-error"}):i("div",{class:e.icon})]),i("div",{staticClass:"components-list-process-title"},[i("div",{class:e.isChangeErrorUI?"errorText":"error-text"},[e._v(" "+e._s(e.errorText)+" "),e.showExtraAction&&!e.isChangeErrorUI?i("a",{staticClass:"extra-action",attrs:{href:"javascript:;"},on:{click:e.refresh}},[e._v(e._s(e.getI18nText("c_file_Process0")))]):e._e(),e.isChangeErrorUI?i("p",{staticClass:"account_info"},[e._v(e._s(e.accountInfo))]):e._e()])])]):e._e()],2):"entering"===e.state&&""!==e.$store.state.file.checkPerErrMsg&&e.powerConfig.get("isOem")?i("div",{staticClass:"components-list-process new-list-component-process",class:{"wps-list-process":e.$ua.WPS&&!e.$ua.wps18and19,"yun-list-process":e.$ua.yun||e.$ua.wps18and19},staticStyle:{"flex-direction":"column"}},[i("div",{staticClass:"components-list-process-icon"},[e.$ua.yun||e.$ua.wps18and19?i("div",{staticClass:"yun-error"}):i("div",{class:e.icon})]),i("div",{staticClass:"components-list-process-title"},[i("div",{staticClass:"error-text"},[e._v(" "+e._s(e.$store.state.file.checkPerErrMsg)+" ")])])]):e._e():i("div",{staticClass:"file-empty-container",class:{entspace:e.isEntSpace}},[e._t("empty")],2)])}),[],!1,null,"7d55ca30",null).exports,Kt={name:"FileEmpty",mixins:[G.default],props:{emptyType:{type:Object,required:!1}},data:function(){return{MAPPING:{searchFile:{title:this.$t("finder_processes_Empty0")+"<%=placehander%>"+this.$t("finder_pr,content:""}}}},computed:{type:function(){return this.emptyType&&this.emptyType.type||"search"},placehander:function(){return this.emptyType&&this.emptyType.placehander||""},icon:function(){var e=this;return Object.keys(this.MAPPING).find((function(t){return t===e.type}))||"file"},yunIconType:function(){return this.MAPPING[this.type]&&this.MAPPING[this.type].yunIconType},titcehander?this.MAPPING[this.type].title.replace("<%=placehander%>",this.placehander):this.MAPPING[this.type].title},content:function(){return this.MAPPING[this.icon].content}}},Qt=Kt,Yt=(0,y.Z)(Qt,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"components-listempty"},[i("div",{staticClass:"components-listempty-innerblock"},[i("div",{staticClass:"components-listempty-icon"},[i("div",{class:e.yunIconType})]),i("h3",{staticClass:"components-listempty-title",attrs:{tabindex:"0"}},[e._v(e._s(e.title))]),e._t("default")],2)])})"FinderProcess",mixins:[G.default],components:{DriveFileProcess:qt,Eable",validator:function(){return["table","thumbnail"]}},state:{type:Object,default:function(){return{}}}},computed:{status:function(){var e=this.state.file.status;return e},isEmpty:function(){var e=0===the)&&e},emptyType:function(){return{type:"searchFile",placehander:this.state.route.params.keyword}}},methods:{onReload:function(){this.dispatch("DriveFileFinder","onReload")}}},Xt=(0,y.Z)(Jt,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.isEmpty?i("drive-file-process",{attrs:{status:e.status,data:e.state.file.list},on:{reload:e.onReload}},[i("empty-root",{attrs:{slo1}}();return function(){var i,r=(0,ni.Z)(e);if(t){var n=(0,ni.Z)(this).constructor;its);return(0,ri.Z)(this,i)}}var ci,li,ui,di=i.n(oi)().CancelToken,pi=function(e){(0,ii.Z)(o,e);var t,i,r,n=ai(o);function o(){return(0,ei.Z)(this,o),n.apply(this,arguments)}return(0,ti.Z)(o,[{key:"prefetchHook",value:function(){}},{key:"_status_",value:(r=(0,s.Z)(a().mark((function e(){var t,i,r,n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=N.drive.get("/api/v3/search/index/status",Object.assign({cancelToken:new di((function(e){t=e}))},{noCatch:!0})),r=new Promise(function(){var e=(0,s.Z)(a().mark((function e(t,r){var s,o,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i;case 3:s=e.sent,o=s.data,c=o.status,n.$context.commit(u.dWO,c),t(c),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),r(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,i){return e.apply(this,arguments)}}()),this.updateExt("status",t),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"_open_",value:(i=(0,s.Z)(a().mark((functio=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=N.drive.get("/api/v3/search/files/switch",Object.assign({cancelToken:new di((function(e){t=e}))},{noCatch:!0})),r=new Promise(function(){var e=(0,s.Z)(a().mark((function e(t,r){var s,o,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i;case 3:s=e.sent,o=s.data,(c=o.user.status)>0&&n.$context.commit(u.dWO,c),t(c),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),r(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,i){return e.apply(this,arguments)}}()),this.updathis,arguments)})},{key:"checkTags",value:(t=(0,s.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}]),o}(si.o),fi=i(13690),mi={move:"move",copy:"copy",found_folder:"found_folder"},hi={name:"DriveFileFinder",componentName:"DriveFileFinder",components:{SearchInput:Ht,FinderProcess:Xt},mixins:[E.Z,w.Z,D.Z],data:function(){return{loading:!0,visibility:"hidden",display:"block",props:{label:"name",children:"children"},lock:!0,lockStatus:!0,isCreator:!0,isSearch:!1,context:{rootState:{ua:null,file:{list:[],query:{pagination:{offset:0,count:100},sort:{order:"DESC",orderby:"default"},ext:{include_exts:"folder",include_file:!1,include_folder:!0,search_operator_name:!1,include_secret:!0}},selected:[],status:"ENTERING",total:0},user:{search_content_status:2},route:{name:"Search",params:{keyword:"",tabName:"file"}}},commit:function(){},dispatch:function(){}}}},props:{onCommit:{type:Function,default:function(){return Promise.resolve(!0)}},beforeClose:{type:Function,default:function(){return Promise.resolve(!0)}},exclude:{type:Array,validator:function(e){var t=e.ft=e.id,i=e.fileid,r=e.type,n=e.ftype,s=~["file","folder","sharefile"].indexOf(n);return!((t=t||i)&&(s||"normal"===r))}));return 0===e.length||t},default:function(){return[]}},secretLocked:Boolean,type:{type:String,default:""},cancelClose:{type:Function,default:function(){return Promise.resolve(!0)}},groupid:{type:Number,default:0},from:{type:String,default:""},dwFinder:Object},computed:{updateMemberUrl:function(){var e;return this.$ua.yun&&(e=this.$ua.docs?"docs?csource=pc_kdocs_secret&payconfig=svip&position=ey=vip_pro_plus")},myCloudId:function(){return this.$store.state.team.myCloud.id},excludeTeams:function(){return this.exclude.map((function(e){return"normal"===e.type&&e.id})).filter((function(e){rders:function(){return this.exclude.map((function(e){var t=e.id||parharefile"].index){return e}))},mySecret:function(){return this.$store.state.team.mySecret},user:function(){return this.$store.state.user},hasSecretFolder:function(){return this.mySecret.id},isSecretExpired:function(){return this.hasSecretFolder&&!(this.user.privileges&&this.user.privileges.secret_folder)}},created:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r,n,s,o,c,l,u,d,p,f,m,h,_,v,g;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.(t){e.lockStatus=t})),e.$on("ok",(function(){return e.commit()})),e.$on("cancelClose",(function(){return e.cancelClose()})),e.$on("onReload",(function(){return e.onReload()})),e.selectedNode=null,i=e.$store.state.team,r=i.list,n=i.myCloud,s=i.mySecret,o=i.current,c=o.user_role,!(l="move"===e.type)||!e.groupid){t.next=15;break}return t.next=11,N.drive.get("/api/v3/groups/".concat(e.groupid),{params:{include:"recent_members"}});case 11:u=t.sent,(d=u.data)&&(c=d.user_role),r&&(o=r.find((function(t){return t.id===e.groupid})));case 15:return e.isCreator=!l||("creator"===c||"admin"===c),e.context.rootState.ua=Object.assign({},e.$ua),e.context.rootState.team=Object.assign({},e.$store.state.team),e.context.rootState.user=Object.assign({},e.$store.state.user),e.context.rootState.company=Object.assign({},e.$store.state.company),e.context.commit=function(t,i){t===Gt.OD&&(e.context.rootState.file.status=i)},l&&!e.isCreator&&(e.context.rootState.file.query.ext.path={groupid:e.groupid,id:0,name:"1"}),ci=new pi({context:e.context,to:e.context.rootState.route,searchSource:l?"move":"copy",from:e.$route.name.toLowerCase()}),e.isSearch=!0,t.next=26,e.formatInitData({list:r,myCloud:n,mySecret:s,current:o});case 26:if(p=t.sent,f=p._myTeam_,m=p._joinTeam_,h=p._secret_,_=p._cloud_,v=p._current_,g=[],!_[0]||!_[0].groupid){t.next=37;break}return t.next=36,e.fetchFolderNode(_[0]);case 36:g=t.sent;case 37:e.root=e.isCreator?[].concat((0,b.Z)(e.powerConfig.get("UIFinderMyDocs")?_:[]),(0,b.Z)(m)):(0,b.Z)(v),e.rootItem="found_folder"===e.type?[].concat((0,b.Z)(g),(0,b.Z)(f)):[].concat((0,b.Z)(h),(0,b.Z)(g),(0,b.Z)(f)),e.isSearch=!1,e.loading=!1,e.lockStatus=e.secretLocked;case 42:case"end":return t.stop()}}),t)})))()},m.filter((function(e){return"sharefolder"===e.type&&-1===t.excludeTeams.indexOf(e.id)})),r=e.filter((function(e){return"folder"===e.type&&-1===t.excludeFolders.indexOf(e.id)}));return[].concat((0,b.Z)(i),(0,b.Z)(r))}return e},fetchFolderNode:function(e){return(0,s.Z)(a().mark((function t(){var i,r,n,s,o,c;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.groupid,r=e.id,n=e.type,s={offset:0,count:100,oderby:"mtime",filter:"folder",grxt=5,N.=t.sent,c=o.data,t.abrupt("return",c.files.filter((function(e){return"linkfolder"!==e.ftype})).map((function(e){return{name:e.fname,id:e.id,groupid:e.groupid,type:"folder"}})));case 8:case"end":return t.stop()}}),t)})))()},commit:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r,n,s,o,c,l,u;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.$emit("process",!0),i=Date.now(),!e.selectedNode){t.next=27;break}if(r=e.selectedNode,n=r.groupid,s=r.id,o=r.type,c=r.name,"secret"!==o){t.next=11;break}if(l="",e.isSecretExpired?l=e.$t("file_finder_Finder1"):e.lockStatus&&(l=e.$t("file_finder_Finder2")),!l){t.next=11;break}return e.$message.error(l),e.$emit("process",!1),t.abrupt("return");case 11:return t.prev=11,u="sharefolder"===o||"secret"===o?0:s,0===s&&(u=0),t.next=16,e.onCommit({groupid:n,id:u,name:c,type:o});case 16:e.beforeClose(),e.$emit("close"),["copy","move","saveas"].includes(e.type)&&e.dwFinder&&k.Z.onEvent("fileselect_execute",{type:e.dwFinder.type,time:Date.now()-i,number:e.dwFinder.number}),t.next=25;break;case 21:t.prev=21,t.t0=t.catch(11),e.handleSpaceFull(t.t0),e.$emit("process",!1);case 25:t.next=28;break;case 27:e.$emit("close");case 28:case"end":return t.stop()}}),t,null,[[11,21]])})))()},selectChange:function(e){this.selectedNode=e},renderNode:function(e,t){var i,r=this,n=t.node,s=n.data,o=s.id,a=s.name,c=s.type;if(n.data.highlight&&(i=this.fileNameHl(n.data)),!this.mySecret.id||o!==this.mySecret.id){var l=e(fi.Z,{class:"tree-custom-label",props:{text:a}},a);return i&&(l=e("span",{class:"tree-custom-label search",attrs:{title:a},domProps:{innerHTML:i}})),e("span",[e("Icon",{props:{type:"sharefolder"===c?"dialog-team-folder-s":"folder-s-selected"}}),l])}if(this.mySecret.id&&o===this.mySecret.id){if(this.isSecretExpired){n.loading&&this.$set(n,"loading",!1);var u=e(fi.Z,{class:"tree-custom-label secret-disable-style",props:{text:a}},a);return i&&(u=e("span",{class:"tree-custom-label search secret-disable-style",domProps:{innerHTML:i}})),e("span",[e("Icon",{props:{type:"secret-folder-s"}}),u,e("span",{class:"secret-member-label"},[e("drive-link",{attrs:{href:this.updateMemberUrl},nativeOn:{click:function(){k.Z.onEvent("secret_window_renew",{entrance:mi[r.type]})}}},this.$t("file_finder_Finder3"))])])}if(this.secretLocked){n.loading&&this.$set(n,"loading",!1);var d=e(fi.Z,{class:"tree-custom-label",props:{text:a}},a);return i&&(d=e("span",{class:"tree-custom-label search",domProps:{innerHTML:i}})),e("span",[e("Icon",{props:{type:"secret-folder-s"}}),d,e("a",{class:{"unlock-secret":!0,"hide-unlock-entrance":!this.lock},on:{click:function(){r.$emit("changeLockStatus",!1),r.dialog("unlockSecret",{changeLock:r.changeLock,backprev:!0})}}},this.$t("file_finder_Finder4"))])}var p=e(fi.Z,{class:"tree-custom-label",props:{text:a}},a);return i&&(p=e("span",{class:"tree-custom-label search",domProps:{innerHTML:i}})),e("span",[e("Icon",{props:{type:"secret-folder-s"}}),p])}},loadmore:function(e,t){var i=this;return(0,s.Z)(a().mark((function r(){var n,s,o,c;return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.data,s=e.level,o=n&&n.id,r.prev=2,!i.lock||!o||o!==i.mySecret.id||!i.isSecretExpired&&!i.secretLocked){r.next=5;break}return r.abrupt("return");case 5:if(0!==s){r.next=9;break}i.isSearch?(t(i.context.rootState.file.list),i.visibility="visible"):(t(i.root),i.visibility="visible"),r.next=17;break;case 9:if(0!==o){r.next=13;break}t(i.rootItem),r.next=17;break;case 13:return r.next=15,i.fetchFolderNode(n);case 15:c=r.sent,t(i.excludeNode(c));case 17:r.next=23;break;case 19:r.prev=19,r.t0=r.catch(2),i.$set(e,"expanded",!1),i.$set(e,"loading",!1);case 23:case"end":return r.stop()}}),r,null,[[2,19]])})))()},changeLock:function(e){this.lock=e},formatInitData:function(e){var t=this;return(0,s.Z)(a().mark((function i(){var r,n,s,o,c,l,u,d,p,f,m,h,_,v;return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(r=e.list,n=e.myCloud,s=e.mySecret,o=e.current,i.prev=1,c=r||[],l=[],u=[],d=n||[],p=s||[],f=o||[],!(m={NOT_LIST:!0,NOT_CLOUD:!n||!n.id,NOT_SECRET:!s||!s.id,NOT_CURRENT:!o||!o.id}).NOT_LIST){i.next=18;break}return i.next=12,N.drive.gee 12:h=i.sent,_=h.data,v=_&&_.groups||[],m.NOT_LIST&&(c=v.filter((function(e){return"normal"===e.type}))||[]),m.NOT_CLOUD&&(d=v.filter((function(e){return"special"===e.type}))||[]),m.NOT_CURRENT&&(o=v.find((function(e){return e.id===t.groupid}))||{})&&o.id&&(f=[{name:o.name,id:o.id,groupid:o.id,type:"sharefolder"}]);case 18:return c.forEach((function(e){var t="creator"===e.user_role,i={name:e.name,id:e.id,groupid:e.id,type:"sharefolder"};t?l.push(i):u.push(i)})),d=[{name:t.$t("file_finder_Finder5"),id:0,groupid:d.id,type:"folder"}],m.NOT_SECRET||(p=[{name:s.name,id:s.id,groupid:s.id,type:"secret"}]),m.NOT_CURRENT||(f=[{name:o.name,id:o.id,groupid:o.id,type:"sharefolder"}]),i.abrupt("return",{_teams_:c,_myTeam_:l,_joinTeam_:u,_cloud_:d,_secret_:p,_current_:f});case 25:i.prev=25,i.t0=i.catch(1),t._error(i.t0);case 28:case"end":return i.stop()}}),i,null,[[1,25]])})))()},search:function(e){var t=this;return(0,s.Z)(a().mark((function i(){var r,n;return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return t.isSearch=!0,t.loading=!0,r={name:"Search",params:{keyword:e,tabName:"file"}},t.context.rootState.route.params.keyword=e,t.selectChange(null),i.next=7,ci.fetch(r);case 7:n=i.sent,t.context.rootState.file.list=[],n.forEach((function(e){var i=e.type,r=e.ftype,n=e.groupid,s=e.id,o=e.fname,a=e.name,c=e.highlight;"folder"===r&&t.context.rootState.file.list.push({groupid:n,id:s,type:r,name:o,highlight:c}),"normal"===i&&t.context.rootState.file.list.push({groupid:s,id:s,type:"sharefolder",name:a,highlight:c}),"secret"===i&&t.context.rootState.file.list.push({groupid:s,id:s,type:"secret",name:a,highlight:c})})),0===n.length?t.display="none":t.display="block",t.loading=!1;case 12:case"end":return i.stop()}}),i)})))()},onReload:funroute.params.keyword)},clearKeyword:function(){var e=this;this.isSearch=!1,this.selectChange(null),this.loading=!0,this.$nextTick((function(){e.loading=!1,e.display="block"}))},fileNameHl:function(e){var t=e.name,i=e.highlight;if(i){var r=i.file_name,n=i.group_name;if(r&&r.length)return this.fileContentHl(r[0]);if(n&&n.length)return this.fileContentHl(n[0])}return this.key t=this.searchKeyword&&this.searchKeyword.replace(/[-\\/^$*+?.()|[\]{}]/g,"\\$&")||"";return e.replace(new RegExp("".concatleContentHl:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.replace(/<\/?[\s\S]+?>/gi,(function(e){return/<\/?\s*em\s*[\s\S]*>/i.test(e)?e:""})).replace(/<\/em><em>/gi,"").replace(/<em>$/gi,"");return t}},mounted:function(){["copy","move","saveas"].includes(this.type)&&this.dwFinder&&k.Z.onEvent("fileselect_request",{type:this.dwFinder.type,position:this.dwFinder.position,time:Date.now()-this.dwFinder.handleStartTime})}},_i=hi,vi=(0,y.Z)(_i,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"file-finder-container"},[i("search-input",{staticClass:"file-finder-search-input",attrs:{placeholder:e.$t("file_finder_Finder0"),delay:500},on:{search:e.search,clearKeyword:e.clearKeyword}}),i("div",{staticClass:"file-finder-content"},[i("div",{style:{visibility:e.visibility,display:e.display}},[e.loading?e._e():i("el-tree",{ref:"tree",attrs:{lazy:"",props:e.props,load:e.loadmore,highlightCurrent:!0,renderContent:e.renderNode},on:{"current-change":e.selectChange}})],1),i("loading",{directives:[{name:"show",rawName:"v-show",value:e.loading&&e.isSearch,expression:"loading && isSearch"}]}),e.isSearch&&!e.loading?i("finder-process",{attrs:{state:e.context.rootState,layout:"table"}}):e._e()],1)],1)])}),[],!1,null,null,null).exports,gi=i(52966),yi=i(16739),xi=i(23493),bi=i.n(xi),ki=i(10928),wi=i.n(ki),$i=i(65856),Ci=i(44072),Si=i(80706),Fi=i(26743),Ti=i(1602),Pi=i(8409),Ni=i(27484),Ei=i.n(Ni),Ii=i(85476),Di=i(94602),Zi=i(81553),Hi=i(41164),Oi=i(30675),Li=i(59499),Gi=i(22941),Mi=i(3330),Ri=i(28356),Bi=i(5559),Ai={name:"HistoryFilter",componentName:"HistoryFilter",directives:{Clickoutside:Si.Z},components:{IangleUpIcon:Bi.Z},props:{file:{type:Object,required:!0},panelConfig:{type:Object,required:!0,default:function(){return{time:!0,updater:!0,size:!0,fverSource:!0,fverName:!0}}},type:{type:String,default:""}},mixins:[G.default,D.Z,E.Z],data:function(){var e=[{key:"time",label:(0,r.GH)("components_dialog_file_history_txt44"),style:{width:"9%"}},{key:"updater",label:(0,r.GH)("components_dialog_file_history_txt45"),style:{width:"12.36%"}},{key:"size",label:(0,r.GH)("components_dialog_file_history_txt46"),style:{width:"8.33%"}},{key:"fverSource",label:(0,r.GH)("components_dialog_file_history_txt47"),style:{width:"12.36%"}},{key:"fverName",label:(0,r.GH)("components_dialog_file_history_txt48"),style:{width:"26%"},contextmenuVisible:!1,filterValue:-1,filters:[{name:(0,r.GH)("components_dialog_file_history_txt49"),value:-1},{name:(0,r.GH)("components_dialog_file_history_txt50"),value:0}]}];return{config:this.panelConfig,filterFverName:-1,panelArr:e,showSettingContextmenu:!1,visiblePopover:!1}},computed:{isSecretExpired:function(){var e=this.$store.state,t=e.team,i=e.user;return"Secret"===e.route.name&&t.mySecret&&!(i.privileges&&i.privileges.secret_folder)},canUpload:function(){var e=this.type,t=yi.ET.indexOf((0,l.getExtName)(this.file.fname))>-1,i="ksheet"===(0,l.getExtName)his.$ua.wps2018beta||t||i||"o"===e)},hasPerm:function(){return this.file.file_acl&&this.file.file_acl.modify}},watch:{panelConfig:{deep:!0,handler:function(e){this.config=e}}},mounted:function(){var e=this;this.showDefaultTooltipReg(),this.$on("hideToolTip",Pt()((function(){e.visiblePopover=!1}),300,!0))},methods:{getI18nText:r.GH,historyDw2:I.Z,filterName:function(e){if(!e)return"";var t=e.filterValue;return e.filters.find((function(e){return e.value===t})).name},handleFilterClick:function(e)nuVisible=!e.contextmenuVisible,this.currentPanel=e},handleFilterClickoutside:function(){this.currentPanel&&(this.currentPanel.contextmenuVisible=!1,this.currentPanel=null)},onChangeFilter:function(e,t){e.contextmenuVisible=!1,e.filterValue!==t.value&&(e.filterValue=t.value,this.$emit("changeFilter",e.filterValue))},handleSecretExpired:function(e){return!!this.isSecretExpired&&(this.dialog("preventUpload",{backprev:!0,useNewLayout:this.$store.state.ui.useNewLayout}),e&&e.preventDefault(),!0)},handleUpload:function(e){var t=this;return(0,s.Z)(a().mark((function i(){var r,n,s,o;return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return r=t.$ua,n=r.WPS,s=r.IS_WPS_DRIVER,o=r.isTablet,i.next=3,t.handleSecretExpired(e);case 3:if(!i.sent){i.next=5;break}return i.abrupt("return");case 5:if(!(n&&!s||o)){i.next=9;break}return t.dispatch("ROOT",f.jR.command,[t.file.id||t.file.fileid,{filename:t.file.fname||t.file.name,groupid:t.file.groupid}]),t.$ua.isTablet&&setTimeout((function(){var e=t.$refs.uploutton");i&&i.classL;case 9:case"end":return i.stop()}}),i)})))()},handleClickoutside:function(){this.showSettingContextmenu=!1},onChangeListConfig:function(e,t){this.$emit("onPanelevent",t,e)},showDefaultTooltipReg:function(){var e=this,t="History_tip_first_start";(!window.localStorage||"true"!==window.localStorage.getItem(t))&&setTimeout((function(){e.visiblePopover=!0,window.localStorage&&window.localStorage.setItem(t,"true")}),1e3)},handleShowPopover:function(){this.historyDw2({operation:"tip",fileid:this.file.id||this.file.fileidtion(){var e=this;this.visiblePo(function(){e.visiblePopover=!0}),300))},handleTooltipHoverLeave:function(){this._tooltipHover_timer&&(clearTimeout(this._tooltipHover_timer),this._tooltipHover_timer=null)}}},ji=Ai,Wi=(0,y.Z)(ji,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"history-table-head"},[r("div",{staticClass:"container"},[e._l(e.panelArr,(function(t){var n;return[e.panelConfig[t.key]?r("div",{key:t.key,staticClass:"panel",class:(n={"has-filter":t.filters,"is-show":t.contextmenuVisible,"is-active":void 0!==t.filterValue&&-1!==t.filterValue},n["panel-"+t.key]=!0,n),style:t.style},[t.filters?[r("div",{staticClass:"filter-wrapper is-ellipsis",on:{click:function(i){return e.handleFilterClick(t,i)}}},[r("span",{staticClass:"panel__name",attrs:{title:t.label}},[e._v(e._s(-1===t.filterValue?t.label:e.filterName(t)))]),[t.contextmenuVisible?r("TriangleUpIcon",{attrs:{fill:"currentColor",size:"12"}}):r("TriangleDownIcon",{attrs:{fill:"currentColor",size:"12"}})]],2),r("div",{directives:[{name:"show",rawName:"v-show",value:t.contextmenuVisible,expression:"panel.contextmenuVisible"}],staticClass:"history-contextmenu is-selector"},[r("ul",{directives:[{name:"clickoutside",rawName:"v-clickoutside.history-contextmenu.has-filter",value:e.handleFilterClickoutside,expression:"handleFilterClickoutside",modifiers:{"history-contextmst"},e._l(t.filters,(function(n){return r("li",{key:n.value,staticClass:"list-item",class:{check:t.filterValue===n.value},on:{click:function(i){return e.onChangeFilter(t,n)}}},[r("span",{staticClass:"list-item__name"},[e._v(e._s(n.name))]),r("span",{staticClass:"list-item__icon"},[r("img",{attrs:{src:i(87399),alt:e.getI18nText("components_dialog_file_history_txt51")}})])])})),0)])]:r("div",{staticClass:"is-ellipsis"},[r("span",{staticClass:"panel__name",attrs:{title:t.label}},[e._v(e._s(t.label))])])],2):e._e()]})),r("div",{staticClass:"panel actions"},[e.canUpload?r("a",{directives:[{name:"enter-to-click",rawName:"v-enter-to-click"}],ref:"upload",staticClass:"action upload-action vertical-middle plupload-anchor needsclick ",attrs:{tabindex:"0",role:"button",title:e.getI18nText("components_dialog_file_history_txt56"),"area-label":e.getI18nText("components_dialog_file_history_txt6"),"data-fileid":e.file.id||e.file.fileid,"data-filename":e.file.fname,"data-groupid":e.file.groupid,"data-parentid":e.file.parentid,"data-corpid":e.file.corpid,"data-fileperm":e.hasPerm},on:{click:function(t){return t.stopPropagation(),e.handleUpload.apply(null,arguments)}}},[r("AutoBackupIcon",{staticClass:"icon",attrs:{size:"16"}})],1):e._e(),r("div",{staticClass:"action setting-action vertical-middle",class:{active:e.showSettingContextmenu},attrs:{title:e.getI18nText("components_dialog_file_history_txt57")},on:{click:function(t){e.showSettingContextmenu=!e.showSettingContextmenu}}},[r("SetupIcon",{staticClass:"icon",attrs:{size:"16"}})],1),r("div",{staticClass:"divider vertical-middle"}),r("kd-popover",{ref:story-tips",placement:"bottom-end",width:"320",offset:3,trigger:"click"},on:{show:e.handleShowPopover},model:{value:e.visiblePopover,callback:function(t){e.visiblePopover=t},expression:"visiblePopover"}},[r("div",{staticClass:"history-tips-content"},[r("p",[e._v("1、"+e._s(e.getI18nText("components_dialog_file_history_txt53")))]),r("p",[e._v("2、"+e._s(e.getI18nText("components_dialog_file_history_txt54")))]),r("p",[e._v("3、"+e._s(e.getI18nText("components_dialog_file_history_txt55")))])]),r("div",{staticClass:"action vertical-middle icon-tip",attrs:{slot:"reference"},on:{mouseenter:e.handleTooltipHoverEnter,mouseleave:e.handleTooltipHoverLeave},slot:"reference"},[r("InfoIcon",{staticClass:"icon",attrs:{size:"16"}})],1)]),r("div",{directives:[{name:"show",rawName:"v-show",value:e.showSettingContextmenu,expression:"showSettingContextmenu"}],staticClass:"history-contextmenu is-actions"},[r("span",{staticClass:"subtitle"},[e._v(e._s(e.getI18nText("components_dialog_file_history_txt52")))]),r("ul",{directives:[{name:"clickoutside",rawName:"v-clickoutside.is-actions.setting-action",value:e.handleClickoutside,expression:"handleClickoutside",modifiers:{"is-actions":!0,"setting-action":!0}}],staticClass:"list"},[r("li",{staticClass:"list-item",attrs:{"data-key":"size"}},[r("kd-checkbox",{on:{change:function(t){return e.onChangeListConfig(t,"updater")}},model:{value:e.config.updater,callback:function(t){e.$set(e.config,"updater",t)},expression:"config.updater"}},[r("span",[e._v(e._s(e.getI18nText("components_dialog_file_history_txt45")))])])],1),r("li",{staticClass:"list-item",attrs:{"data-key":"size"}},[r("kd-checkbox",{on:{change:function(t){return e.onChangeListConfig(t,"size")}},model:{value:e.config.size,callback:function(t){e.$set(e.config,"size",t)},expression:"config.size"}}le_history_txt46")))])])],1),r("li",{staticClass:"list-item",attrs:{"data-key":"fverSource"}},[r("kd-checkbox",{on:{change:function(t){return e.onChangeListConfig(t,"fverSource")}},model:{value:e.config.fverSource,callback:function(t){e.$set(e.config,"fverSource",t)},expression:"config.fverSource"}},[r("span",[e._v(e._s(e.getI18nText("components_dialog_file_history_txt47")))])])],1)])])],1)],2)])}),[],!1,null,null,null),Vi=Wi.exports,Ui={"pc-office":"WPS-PC","ios-office":"WPS-iOS","android-office":"WPS-".concat((0,r.GH)("components_dialog_file_history_txt30")),"mac-office":"WPS-MAC","wps-edu":"WPS".concat((0,r.GH)("components_dialog_file_history_txt32")),"wps-note_wx_app":"WPS".concat((0,r.GH)("components_dialog_file_history_txt33")),drive_wxlogin_demo:(0,r.GH)("components_dialog_file_history_txt31"),drive_wx_app:(0,r.GH)("components_dialog_file_history_txt31"),pc_wpsdocs:(0,r.GH)("components_dialog_file_history_txt31"),android_wpsdocs:(0,r.GH)("components_dialog_file_history_txt31"),ios_wpsdocs:(0,r.GH)("components_dialog_file_history_txt31"),resume_assistant:"WPS".concat((0,r.GH)("components_dialog_file_history_txt38")),weboffice:(0,r.GH)("components_dialog_file_history_txt31"),"android-wpsdocs":(0,r.GH)("components_dialog_file_history_txt31"),"ios-wpsdocs":(0,r.GH)("components_dialog_file_history_txt31"),wpsdocs_quick_app:(0,r.GH)("components_dialog_file_history_txt31"),wpsdocs_qq_app:(0,r.GH)("components_dialog_file_history_txt31"),wpsdocs_pc_app:(0,r.GH)("components_dialog_file_history_txt31"),wpsdocs_wx_app:(0,r.GH)("components_dialog_file_history_txt31"),"web-kdocs":(0,r.GH)("components_dialog_file_history_txt31"),wpsform:(0,r.GH)("components_dialog_file_history_txt39"),"pc-wpsdocs":(0,r.GH)("components_dialog_file_history_txt31"),"mobile-kdocs":(0,r.GH)("components_dialog_file_history_txt31"),synergy_calendar_wx_app:(0,r.GH)("components_dialog_file_history_txt40"),"android-fastapp":"WPS".concat((0,r.GH)("components_dialog_file_history_txt41")),ks_loan:(0,r.GH)("components_dialog_file_history_txt42"),ks_todo:(0,r.GH)("components_dialog_file_history_txt43"),ks_todo_wx_app:(0,r.GH)("components_dialog_file_history_txt43"),"ios-pdf":"iOS-PDF"},zi=function(e,t,i){return(0,r.GH)("history_tag_".concat(e,"_").concat(t),{name:i})},qi={1:{name:(0,r.GH)("history_tag_1_name"),hover:(0,r.GH)("history_tag_1_hover")},2:{name:(0,r.GH)("history_tag_2_name"),hover:(0,r.GH)("history_tag_2_hover")},3:{name:(0,r.GH)("history_tag_3_name"),hover:(0,r.GH)("history_tag_3_hover"),hide:!0},4:{name:(0,r.GH)("history_tag_4_name"),hover:(0,r.GH)("history_tag_4_hover")},5:{name:(0,r.GH)("history_tag_5_name"),hover:(0,r.GH)("history_tag_5_hover")},6:{name:(0,r.GH)("history_tag_6_name"),hover:(0,r.GH)("history_tag_6_hover")},7:{name:(0,r.GH)("history_tag_7_name"),hover:(0,r.GH)("history_tag_7_hover")},8:{name:(0,r.GH)("history_tag_8_name"),hover:(0,r.GH)("history_tag_8_hover")},9:{name:(0,r.GH)("history_tag_9_name"))},10:{name:function(e){return zi(10,"name",e)},hover:function(e){return zi(10,"hover",e)}},11:{name:function(e){return zi(11,"name",e)},hover:function(e){return zi(11,"hover",e)}},12:{name:(0,r.GH)("history_tag_12_name"),hover:(0,r.GH)("history_tag_12_hover")},13:{name:(0,r.GH)("history_tag_13_name"),hover:(0,r.GH)("history_tag_13_hover")},14:{name:(0,r.GH)("history_tag_14_name"),hover:(0,r.GH)("history_tag_14_hover")},15:{name:(0,r.GH)("history_tag_15_name"),hover:(0,r.GH)("history_tag_15_hover")},16:{name:(0,r.GH)("history_tag_16_name"),hover:(0,r.GH)("history_tag_16_hover")}},Ki=i(66594),Qi=i(54464),Yi=20,Ji={name:"DriveFileHistory",data:function(){return{items:"",groupHistories:[],scrollContent:{list:"",pagination:{count:Yi,offset:0}},lastFinishVersion:-1,contactList:!1,show:!0,selectedNum:-1,editedNum:-1,editedNameComm:"",historyFilter:!1,historyMenuShow:!1,timer:null,isTablet:!1,elSwitchStyle:{width:32,"active-color":"#417FF9","inactive-color":"#E6E6E6"},groupInfo0,fverSource:!0,fverName:!0},sourceTypes:Ui}},mixins:[G.default,E.Z,Ci.ZP,D.Z],props:{file:{type:Object,required:!0}},filters:{formatSize:function(e){return(0,l.convertUnit)(e,2)}},directives:{Clickoutside:Si.Z},watch:{flushTime:function(){var e=this;return(0,s.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.$store.state.file.status!==Gt.jP){t.next=8;break}return e.lastFinishVersion=-1,e.contactList=!1,t.next=6,e.loadHistoryList({offset:0,count:Yi});case 6:e.items=t.sent,e.historyGroup(e.items,!0);case 8:case"end":return t.stop()}}),t)})))()},historyMenuShow:function(e){var t=this;e&&this.$nextTick((function(){t.$refs.history_list_menu.focus()}))}},computed:{flushTime:function(){return this.$store.state.file.flushTime},isSecretExpired:function(){var e=this.$store.state,t=e.team,i=e.user;return"Secret"===e.route.name&&t.mySecret&&!(i.privileges&&i.privileges.secret_folder)},type:function(){var e=(0,l.getExtName)(this.file.fname),t=Object.keys(yi.Nz).find((function(t){return~yi.Nz[t].indexOf(e)||""}));return"ksheet"===t?"k":t},isKsheetFile:function(){return"ksheet"===(0,l.getExtName)(this.file.fname)},canHistoryPreview:function(){var e=this.file.fname?this.file.fname.split("."):"unknown",t=1===e.length?"unknown":wi()(e).toLowerCase(),i=-1!==(0,b.Z)(yi.Y_).indexOf(t);return["s","w","p","f","o"].includes(this.type)||this.isKsheetFile||i},isWord:function(){return"w"===this.type},needHide:function(){return!1},isVisiableHistoryMark:function(){return this.$store.state.switchCof.shieldSwitch.historyMarkSwitch&&("corpnormal"===this.groupInfo.group_type||"corpdep"===this.groupInfo.group_type)},isShowHistoryMark:function(){var e=yi.Nz.s,t=yi.Nz.w,i=yi.Nz.p,r=yi.Nz.o,n=yi.Nz.f,s=yi.Nz.ksheet;return[].concat((0,b.Z)(e),(0,b.Z)(t),(0,b.Z)(i),(0,b.Z)(r),(0,b.Z)(n),(0,b.Z)(s),(0,b.Z)(yi.ET),(0,b.Z)(yi.Y_),["img"]).includes((0,l.getExtName)(this.file.fname,this.file.ftype))}},components:{Scroll:gi.Z,HistoryFilterVue:Vi,TriangleDownIcon:Ri.Z,TriangleRightIcon:Ki.Z,MoreIcon:Qi.Z},mounted:function(){var e=this;(0,Di.XN)("eventName","HistoryRecoverSuccess",(function(){e.$store.commit(u._P6)})),this.bindKeyboardEvent(),this.selectedFolder.$on("handleFolder",this.handleFolder.bind(this))},created:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i={offset:0,count:Yi},e.contactList=!1,t.next=5,e.loadHistoryList(i);case 5:return e.items=t.sent,e.historyGroup(e.items),t.next=9,e.fetchGroupInfo(e.file.groupid);case 9:e.groupInfo=t.sent,e.panelConfig=e.getPanelsConfig()||e.panelConfig,t.next=17;break;case 13:t.prev=13,t.t0=t.catch(0),e._error(t.t0),e.handleClose();case 17:e.historyDw({action:"show",type:"panel",postion:"homepage"}),e.historyDw2({operation:"show",fileid:e.file.id||e.file.fileid});case 19:case"end":return t.stop()}}),t,null,[[0,13]])})))()},methods:{formatMtime:$i.Z.date,getFileMetadata:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,N.drive.get("/api/v5/files/".concat(e.file.id||e.file.fileid,"/metadata"));case 3:return i=t.sent,r=i.data,t.abrupt("return",r&&r.user_acl&&r.user_acl.download||0);case 8:return t.prev=8,t.t0=t.catch(0),e._error(t.t0),t.abrupt("return",null);case 12:case"end":return t.stop()}}),t,null,[[0,8]])})))()},fetchGroupInfo:function(e){var t=this;return(0,s.Z)(a().mark((function i(){var r;return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,!t.$store.state.switchCof.shieldSwitch.historyMarkSwitch){i.next=8;break}return i.next=4,N.drive.get("/api/v3/groups/".concat(e));case 4:return r=i.sent,i.abrupt("return",r.data);case 8:return i.abrupt("return",{});case 9:i.next=14;break;case 11:return i.prev=11,i.t0=i.catch(0),i.abrupt("return",{});case 14:case"end":return i.stop()}}),i,null,[[0,11]])})))()},fetchItems:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.contactList=!0,t.next=3,e.loadHistoryList({offset:e.items.length,count:Yi});case 3:return i=t.sent,e.items=[].concat((0,b.Z)(e.items),(0,b.Z)(i)),e.historyGroup(e.items,!1,!0),t.abrupt("return",{items:i,pagination:{count:Yi}});case 7:case"end":return t.stop()}}),t)})))()},loadHistoryList:(ui=(0,s.Z)(a().mark((function e(t){var i,r,n,s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.historyFilter){e.next=6;break}return i=[],e.next=4,this.loadHistoryListByScene(t);case 4:return i=e.sent,e.abrupt("return",i);case 6:return r=Object.assign({},t,{groupid:this.file.groupid}),e.prev=7,e.next=10,N.drive.get("/api/v3/files/".concat(this.file.id||this.file.fileid,"/histories"),{params:r});case 10:if(n=e.sent,s=n.data,!this.isVisiableHistoryMark){e.next=17;break}return e.next=15,(0,_.M5)(s.histories);case 15:o=e.sent,s.histories.forEach((function(e,t){e.historyTagList=o[t]}));case 17:return this.scrollContent=Object.assign({},this.scrollContent,{list:this.contactList?[].concat((0,b.Z)(this.items),(0,b.Z)(s.histories)):s.histories,pagination:{count:Yi,offset:t.offset+t.count}}),e.abrupt("return",s.histories);case 21:return e.prev=21,e.t0=e.catch(7),this._error(e.t0),e.abrupt("return",[]);case 25:case"end":return e.stop()}}),e,this,[[7,21]])}))),function(e){return ui.apply(this,arguments)}),loadHistoryListByScene:(li=(0,s.Z)(a().mark((function e(t){var i,r,n,s,o,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={count:Yi,fileId:this.file.id||this.file.fileid,scene:0},this.lastFinishVersion>=0&&(t.lastFinishVersion=this.lastFinishVersion),r=Object.assign(i,t,{groupId:this.file.groupid}),e.prev=3,e.next=6,N.drive.get("/api/v5/files/".concat(this.file.id||this.file.fileid,"/histories/scene/0"),{params:r});case 6:return n=e.sent,s=n.data,o=this.historyListFilter(s.histories),this.scrollContent=Object.assign({},this.scrollContent,{list:this.contactList?[].concat((0,b.Z)(this.items),(0,b.Z)(o)):o,pagination:{count:Yi,offset:t.offset+t.count}}),this.lastFinishVersion=s.lastFinishVersion,this.historyDw2({operation:"sift_tag",fileid:this.file.id||this.file.fileid,result:"success"}),e.abrupt("return",o);case 15:if(e.prev=15,e.t0=e.catch(3),!(c=e.t0.response)||!c.data||"notExist"!==c.data.result){e.next=22;break}return e.abrupt("return",[]);case 22:this._error(e.t0);case 23:return e.abrupt("return",[]);case 24:case"end":return e.stop()}}),e,this,[[3,15]])}))),function(e){return li.apply(this,arguments)}),historyGroup:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e;try{var s=(0,Fi.groupHistoriesByDay)(n,"-"),o=(0,Fi.groupHistoriesByMinute)(s,120);(o=this.groupHistoriesByBusiness(o)).forEach((function(e,n){var s=Ei()(e.key);e.key="".concat(t.formatMtime("Y-m-d l",s.toDate())),!t.groupHistories[n]||!t.groupHistories[n].isClose||i||r&&n===o.length-1?t.$set(e,"isClose",!1):t.$set(e,"isClose",!0);var a=t.groupHistories[n]?t.groupHistories[n].data:[];Array.isArray(e.data)&&e.data.forEach((function(e,i){var r=a&&a[i]&&void 0!==a[i][0].isClose;Array.isArray(e)&&e.length>1&&(r?t.$set(e[0],"isClose",a[i][0].isClose):t.$set(e[0],"isClose",!0))}))})),this.groupHistories=o}catch(e){console.log(e)}},groupHistoriesByBusiness:function(e){var t=this;return Array.isArray(e)&&0!==e.length?e.map((function(e){var i=e.data,r=[];return i.length>0&&i.forEach((function(e){if(e.length>0){r.push([]);for(var i=0;i<e.length;i++){var n=r[r.length-1],s=e[i];if(s&&0===n.length)n.push(s);else{var o=n[n.length-1],a=o.modifier&&s.modifier&&o.modifier.id!==s.modifier.id,c=t.sourceTypes[o.device]!==t.sourceTypes[s.device],l=o.tag_info&&s.tag_info&&(0===o.tag_info.tag_scene||o.tag_info.tag_scene!==s.tag_info.tag_scene);a||c||l?r.push([s]):n.push(s)}}}})),e.data=r,e})):e},historyListFilter:function(e){var t=this,i=[];return i=e,Array.isArray(i)&&this.historyFilter&&(i=i.filter((function(e){return!!t.getTagName(e)}))),i},init:function(){this.items="",this.scrollContent={list:"",pagination:{count:Yi,offset:0}},this.lastFinishVersion=-1,this.contactList=!1},handleHistoryFilter:function(e){var t=this;return(0,s.Z)(a().mark((function i(){var r;return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,(e||0===e)&&(t.historyFilter=0===e),t.selectedNum=-1,t.historyMenuShow=!1,t.init(),t.historyDw({action:"click",type:"show_rename",postion:"homepage"}),r={offset:0,count:Yi},t.$refs.historyScroll.reloadByParents(),i.next=10,t.loadHistoryList(r);case 10:t.items=i.sent,t.historyGroup(t.items,!0),i.next=16;break;case 14:i.prev=14,i.t0=i.catch(0);case 16:case"end":return i.stop()}}),i,null,[[0,14]])})))()},historyPopoverTouch:function(){var e=this;this.$ua.isTablet&&(this.$refs.historyPopover.doShow(),this.historyMenuShow=!1,this.timer&&clearTimeout(this.timer),this.timer=setTimeout((function(){e.historyPopoverHide()}),4e3))},historyPopoverHide:function(){this.$refs.historyPopover.doClose(),this.timer&&clearTimeout(this.timer)},handleMessage:function(e){try{"HistoryRecoverSuccess"===JSON.parse(e.data).eventName&&this.$store.commit(u._P6)}catch(e){}},handleClose:function(){this.$emit("close"),this.historyDw2({operation:"close",fileid:this.file.id||this.file.fileid})},handleEditedName:function(e,t,i){var r=this;this.selectedNum=t,this.editedNum=t;try{e.tag_info.tag&&e.tag_info.tag_name?this.editedNameComm=e.tag_info.tag_name:this.editedNameComm=""}catch(e){this.editedNameComm=""}this.$nextTick((function(){r.$refs["historyInput".concat(t)][0].focus(),r.$refs["historyInput".concat(t)][0].select()})),this.$ua.isTablet&&(this.historyMenuShow=!1),this.historyDw({action:"click",type:"rename",postion:"homepage"}),this.historyDw2({operation:"action"===i?"tag":"tag_list",history_num:e.fver,fileid:e.id||e.fileid,result:"success"})},editedNameFocus:function(e,t){this.selectedNum=t,this.editedNum=t;try{e.tag_info.tag&&e.tag_info.tag_name?this.editedNameComm=e.tag_info.tag_name:this.editedNameComm=""}catch(e){this.editedNameComm=""}},editedNameInput:function(e){var t=e.currentTarget,i=t.selectionStart,r=t.selectionEnd;/[/\\:*?"<>|]+/g.test(this.editedNameComm)&&(this.inputErrorHandler(),this.editedNameComm=this.editedNameComm.replace(/[/\\:*?"<>|]+/g,"")),this.editedNameComm.length>20&&(this.editedNameTooLong(),this.editedNameComm=this.editedNameComm.slice(0,20),this.$nextTick((function(){t.setSelectionRange(i,r)})))},editedNameTooLong:bi()((function(){this.$message.error(this.$t("components_dialog_file_history_txt27"))}),3e3),editedNameEnter:function(e){if(this.selectedNum=-1,this.editedNum=-1,this.$ua.isTablet&&this.getTagName(e)!==this.editedNameComm&&(this.getTagName(e)||this.editedNameComm)){if(this.isEmojiCharacter(this.editedNameComm))return void this.inputErrorHandler();e.tag_info||(e.tag_info={}),e.tag_info.tag_name=this.editedNameComm,this.rename(e,this.editedNameComm)}},editedNameBlur:function(e){if(this.selectedNum=-1,this.editedNum=-1,!this.$ua.isTablet&&this.getTagName(e)!==this.editedNameComm&&(this.getTagName(e)||this.editedNameComm)){if(this.isEmojiCharacter(this.editedNameComm))return void this.inputErrorHandler();e.tag_info||(e.tag_info={}),e.tag_info.tag_name=this.editedNameComm,this.rename(e,this.editedNameComm)}},rename:function(e,t){var i=this;return(0,s.Z)(a().mark((function r(){var n,s,o;return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n={file_id:e.fileid,file_ver:e.fver,scene:0,tag_name:t},r.prev=1,r.next=4,N.drive.post("/api/v5/files/".concat(e.fileid,"/histories/tag"),n);case 4:return s=r.sent,"ok"===s.data.result&&i.$message.success(i.$t("components_dialog_file_history_txt16")),o={offset:0,count:i.items.length+Yi},i.lastFinishVersion=-1,r.next=11,i.loadHistoryList(o);case 11:i.items=r.sent,i.historyGroup(i.items),r.next=18;break;case 15:r.prev=15,r.t0=r.catch(1),i._error(r.t0);case 18:case"end":return r.stop()}}),r,null,[[1,15]])})))()},handlePreview:function(e){(0,Oi.Eq)(e,{ua:this.$ua,route:this.$route,toastError:this._error,state:this.$store.state,message:this.$message,dialog:this.dialog,powerConfig:this.powerConfig}),this.historyDw({action:"click",type:"preview",postion:"homepage"}),this.historyDw2({operation:"preview",history_num:e.fver,fileid:e.id||e.fileid,result:"success"})},handleDownload:function(e){(0,Ti.fP)(e,{ua:this.$ua,toastError:this._error,state:this.$store.state,message:this.$message,dialog:this.dialog})},handleCover:function(){var e=this,t=this.selectedItem,i=this.getTagName(t);i=i?"[".concat(i,"]"):"",this.dialog("recoverHistoryFile",{csource:"YunCreateFolder",back:!0,backprev:!0,groupid:t.groupid,fileid:t.fileid,historyid:t.id,mtime:t.mtime,modifier:t.modifier.name,editedName:i,fver:t.fver,useNewLayout:!0,onRecover:function(t){var i=this;setTimeout((function(){e.historyFilter=!1,e.$refs.historyScroll.scrollToTop(),i.$store.commit(u._P6),e.historyDw2({operation:"recover_confirm",history_num:t.fver,fileid:t.id||t.fileid,result:"success"})}),500),this.$router.push({name:"Private",params:{fid:t.id||t.fileid}})}}),this.historyDw({action:"click",type:"recover",postion:"homepage"}),this.historyDw2({operation:"recover",history_num:t.fver,fileid:t.id||t.fileid,result:"success"})},upload:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r,n,s;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.$ua,r=i.WPS,n=i.IS_WPS_DRIVER,s=i.isTablet,t.next=3,e.handleSecretExpired();case 3:if(!t.sent){t.next=5;break}return t.abrupt("return");case 5:if(!(r&&!n||s)){t.next=10;break}return(0,Hi.U_)(),new Zi.Z((0,Vt.S)(e),{params:{filename:e.file.fname||e.file.name,groupid:e.file.groupid},previousId:e.file.id||e.file.fileid}).execute(),e.$ua.isTablet&&setTimeout((function(){var t=e.$refs.upload;if(t){var i=t.querySelector(".uploader-button");i&&i.classList.add("needsclick")}}),0),t.abrupt("return");case 10:case"end":return t.stop()}}),t)})))()},handleSecretExpired:function(){return!!this.isSecretExpired&&(this.dialog("preventUpload",{backprev:!0,useNewLayout:this.$store.state.ui.useNewLayout}),!0)},handleSaveas:function(){_.Jm.bind(this)(this.file.id||this.file.fileid,this.selectedItem,{back:!0})},handleHistoryMark:function(){var e=this;this.moreVisible="",Pi.Z.show({groupid:this.file.groupid-0,rolePermission:{role:{admin:"admin",creator:"owner",member:"member"}[this.groupInfo.user_role]},subTitle1:"当前版本：".concat(Ei()(1e3*this.selectedItem.mtime).format("MM-DD HH:mm")),subTitle2:this.selectedItem.tag_info&&this.selectedItem.tag_info.tag_name,subTitle3:this.selectedItem.modifier.name,historyVersion:{id:this.selectedItem.id,tag:this.selectedItem.historyTagList&&this.selectedItem.historyTagList.length?this.selectedItem.historyTagList:[]},isCurrentVersion:!this.selectedItem.id,currentVersion:[{fileid:this.file.id-0,tag:this.selectedItem.historyTagList&&this.selectedItem.historyTagList.length?this.selectedItem.historyTagList:[]}],onSuccess:function(){e.handleHistoryFilter()}})},handleFolder:function(e,t,i,r){e===this.gid&&t===this.pid||(this.pathchanged=!0),this.pid=t,this.gid=e,this.icontype="share"===i?"dialog-team-folder-s":"folder-s-selected",this.positionName=r},scrollEvent:function(){this.broadcast("HistoryFilter","hideToolTip"),-1!==this.selectedNum&&(this.selectedNum=-1,this.historyMenuShow=!1)},handleRowClick:function(e){-1!==this.selectedNum&&(this.selectedNum=-1),this.$ua.isTablet&&(this.isTablet=!0,this.selectedNum=e),this.historyMenuShow=!1},handleMoreClick:function(e,t,i){var r=this;this.selectedNum=t,this.selectedItem=i,this.historyMenuShow=!this.historyMenuShow,this.$nextTick((function(){r.setContextmenuPosition(e,t,0,0)}))},historyMenuHide:function(=!1},handleContextmenu:function(e,t,i){var r=this;e.preventDefault(),this.selectedNum=t,this.selectedItem=i,this.historyMenuShow=!0,this.$nextTick((function(){r.setContextmenuPosition(e,t)}))},setContextmenuPosition:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=this.$refs.history_list_menu,s=this.mousePosition(e,t);n.style.left=s.x+i+"px",n.style.top=s.y+r+"px"},mousePosition:function(e,t){var i=0,r=0,n=this.$refs["action-more"].find((function(e){return(e.dataset.id||e.getAttribute("data-id"))===t.toString()})),s=this.$refs.history_list_menu,o=this.$refs["history-content"],a=s.offsetWidth,c=s.offsetHeight;if(n){var l=n.getBoundingClientRect(),u=o.getBoundingClientRect();i=l.left+l.width-a-u.left;(r=l.top+l.height-u.top+4)+c+20>=u.height&&(r=l.top-u.top-c-4)}return{x:i,y:r}},handleDropdownmenu:function(e){e.preventDefault()},getTagName:_.f9,isFromWPS:function(e){return["pc-office","ios-office","android-office","mac-office"].includes(e)},listTitleClick:function(e){e.isClose=!e.isClose},listTitleClicklevel1:function(e){Array.isArray(e)&&e.length>1&&(e[0].isClose=!e[0].isClose)},foldBoxHover:function(e){this.$refs[e][0].style.background="#F9FAFD"},foldBoxLeave:function(e){this.$refs[e][0].style.background="#fff"},isEmojiCharacter:function(e){for(var t=0;t<e.length;t++){var i=e.charCodeAt(t);if(55296<=i&&i<=56319){if(e.length>1){var r=1024*(i-55296)+(e.charCodeAt(t+1)-56320)+65536;if(118784<=r&&r<=128895)return!0}}else if(e.length>1){if(8419==e.charCodeAt(t+1))return!0}else{if(8448<=i&&i<=10239)return!0;if(11013<=i&&i<=11015)return!0;if(10548<=i&&i<=10549)return!0;if(12951<=i&&i<=12953)return!0;if(169==i||174==i||12349==i||12336==i||11093==i||11036==i||11035==i||11088==i)return!0}}},historyDw:function(e){varid,a=n.fname;k.Z.onEvent("historyversion_action",{action:t,type:i,postion:r,fileid:s||o,filetype:(0,Ii.Li)(a)})},handlePanelevent:function(e,t){this.panelConfig[e]=t,this.setPanelsConfig()},formatTagName:function(e){var t="",i=0===e.id||!e.id,r=1===e.fver;i?t=this.$t("components_dialog_file_history_txt34"):r&&(t=this.$t("components_dialog_file_history_txt35"));var n=e.tag_info;if(!n||!n.tag)return t;var s=n.tag_name,o=n.tag_scene;return-1===o||!o&&0!==o||(0===o?t=s||t:(t=10===o||11===o?qi[o].name(s||""):qi[o].name,qi[o].hide&&(t=""))),t},formatTagHoverTxt:function(e){var t="",i=e.tag_info;if(!i||!i.tag)return t;var r=i.tag_name,n=i.tag_scene;return-1===n||!n&&0!==n?t:t=0===n?r:10===n||11===n?qi[n].hover(r||""):qi[n].hover},historyDw2:I.Z,getPanelsConfig:function(){var e="";if(window.localStorage){e=window.localStorage.getItem("history_panel_config");try{e=JSO.localStorage&&window.localStorage.setItem("history_panel_config",JSON.stringify(this.panelConfig))},inputErrorHandler:bi()((function(){this.$meme"))}),3e3),bindKeyboardEvent:function(){var e=this,t=function(t){var i=27===t.keyCode;if(i&&i){if(e.editedNum&&-1!==e.editedNum){var r=e.items.find((function(t){return t.id===e.editedNum}));return e.editedName=-1)}return t.stopPropagation&&t.stopPropagation(),void e.handleClose()}};window.addEventListener("keyup",t),this.$on("hook:beforeDestroy",(function(){window.removeEventListener("keyup",t)}))},hasCustomTag:function(e){try{return 0===e.tag_info.tag_scene&&e.tag_info.tag_name}catch(e){}return!1}}},Xi=Ji,er=(0,y.Z)(Xi,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{ref:"history-content",staticClass:"file-history-content"},[r("history-filter-vue",{attrs:{file:e.file,type:e.type,panelConfig:e.panelConfig},on:{changeFilter:e.handleHistoryFilter,onPanelevent:e.handlePanelevent}}),r("div",{staticClass:"history-list only_history_list touch-action"},[r("Scroll",{ref:"historyScroll",attrs:{scrollContent:e.scrollContent},on:{scrollEvent:function(t){return e.scrollEvent(e.selectedNum)}}},[e.show?[e._l(e.groupHistories,(function(t,i){return r("div",{key:i+"_root",staticClass:"history_list_tree"},[r("div",{staticClass:"title flexleft",class:{isnotipad:!e.isTablet}},[r("div",{staticClass:"datetime",attrs:{tabindex:"0"}},[e._v(e._s(t.key))])]),r("div",e._l(t.data,(function(n,s){return r("div",{directives:[{name:"show",rawName:"v-show",value:!t.isClose||0===s,expression:"!item.isClose || level1Index === 0"}],key:i+"_"+s+"_level1",staticClass:"history_list_tree_level1 flexlefttop"},[r("div",{staticClass:"history_list_tree_level1_fold flexright"},[n.length>1?r("div",{staticClass:"fold_box flexcenter",on:{click:function(t){return e.listTitleClicklevel1(n)}}},[n[0].isClose?r("TriangleRightIcon",{attrs:{size:"16",title:e.$t("components_dialog_file_history_txt23")}}):r("TriangleDownIcon",{attrs:{size:"16",title:e.$t("components_dialog_file_history_txt24")}})],1):e._e()]),r("div",{ref:i+"_"+s+"_level2",refInFor:!0,staticClass:"history_list_tree_level2"},e._l(n,(function(i,s){return r("div",{directives:[{name:"show",rawName:"v-show",value:!(0!==s&&n[0].isClose||t.isClose&&0!==s),expression:"(level2Index === 0 || !level1[0].isClose) && (!item.isClose || level2Index === 0)"}],key:i.id,staticClass:"row panel",class:{last_row:s+1===n.length,isSelected:e.selectedNum===i.id,row_isnotipad:!e.isTablet},attrs:{tabindex:"0"},on:{click:function(t){return e.handleRowClick(i.id)},touch:function(t){return e.handleRowClick(i.id)},contextmenu:function(t){return e.handleContextmenu(t,i.id,i)}}},[r("div",{staticClass:"panel-item time"},[r("span",[e._v(e._s(e.formatMtime(e.$t("components_dialog_file_history_txt12"),i.mtime)))])]),e.panelConfig.updater?r("div",{staticClass:"panel-item updater"},[r("div",{staticClass:"avatar_icon"},[r("img",{staticClass:"avatar_icon_img",attrs:{src:i.modifier.avatar}})]),r("span",{staticClass:"modifier_name",class:{modifier_name_withsuffix:e.isFromWPS(i.device)},attrs:{title:i.modifier.name}},[e._v(e._s(i.modifier.name))])]):e._e(),e.panelConfig.size?r("div",{staticClass:"panel-item size"},[e._v(e._s(e._f("formatSize")(i.fsize)))]):e._e(),e.panelConfig.fverSource?r("div",{staticClass:"panel-item fverSource"},[r("span",{staticClass:"modifier_name_suffix"},[e._v(e._s(e.sourceTypes[i.device]||e.$t("components_dialog_file_history_txt31")))])]):e._e(),r("div",{staticClass:"panel-item fverName"},[r("kd-tooltip",{directives:[{name:"show",rawName:"v-show",value:e.editedNum!==i.id&&!e.needHide&&e.formatTagHoverTxt(i),expression:"editedNum !== level2.id && !needHide && formatTagHoverTxt(level2)"}],attrs:{popperClass:"history-panel-tooltip",content:e.formatTagHoverTxt(i),placement:"bottom"}},[r("span",{staticClass:"editedName",class:{"has-custom-tag":e.hasCustomTag(i)},attrs:{tabindex:"0"},on:{click:function(t){return t.stopPropagation(),e.handleEditedName(i,i.id)}}},[e._v(e._s(e.formatTagName(i)))])]),r("span",{directives:[{name:"show",rawName:"v-show",value:e.editedNum!==i.id&&!e.needHide&&!e.formatTagHoverTxt(i),expression:"editedNum !== level2.id && !needHide && !formatTagHoverTxt(level2)"}],staticClass:"editedName",class:{"has-custom-tag":e.hasCustomTag(i)},attrs:{tabindex:"0"},on:{click:function(t){return t.stopPropagation(),e.handleEditedName(i,i.id)}}},[e._v(e._s(e.formatTagName(i)))]),r("span",{directives:[{name:"show",rawName:"v-show",value:e.editedNum===i.id,expression:"editedNum === level2.id"}],staticClass:"editedName_inputbox"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.editedNameComm,expression:"editedNameComm"}],ref:"historyInput"+i.id,refInFor:!0,staticClass:"editedName_input",attrs:{placeholder:e.$t("components_dialog_file_history_txt36"),spellcheck:!1,maxlength:21},domProps:{value:e.editedNameComm},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.editedNameEnter(i)},input:[function(t){t.target.composing||(e.editedNameComm=t.target.value)},function(t){return e.editedNameInput(t)}],blur:function(t){return e.editedNameBlur(i)},focus:function(t){return e.editedNameFocus(i,i.id)}}})])],1),r("div",{staticClass:"panel-item panel-actions"},[r("div",{staticClass:"actions-flex"},[r("a",{staticClass:"action action-button rename",class:{"is-editting":e.editedNum===i.id},attrs:{tabindex:"0"},on:{click:function(t){return t.stopPropagation(),e.handleEditedName(i,i.id,"action")}}},[e._v(e._s(e.$t("components_dialog_file_history_txt37")))]),r("a",{staticClass:"action action-button preview",class:{hidden:!e.canHistoryPreview&&0!==i.id},attrs:{tabindex:"0"},on:{click:function(t){return e.handlePreview(i)}}},[e._v(e._s(e.$t("components_dialog_file_history_txt1")))]),r("div",{directives:[{name:"show",rawName:"v-show",value:!e.needHide,expression:"!needHide"}],ref:"action-more",refInFor:!0,staticClass:"action action-icon vertical-middle more",attrs:{"data-id":i.id},on:{click:function(t){return t.stopPropagation(),e.handleMoreClick(t,i.id,i)}}},[r("MoreIcon",{attrs:{size:"16"}})],1)])])])})),0)])})),0)])})),r("div",{directives:[{name:"show",rawName:"v-show",value:0===e.groupHistories.length&&e.historyFilter,expression:"groupHistories.length === 0 && historyFilter"}],staticClass:"history_list_empty"},[r("img",{staticClass:"list_empty_img",attrs:{src:i(22908)}}),r("div",{attrs:{tabindex:"0"}},[e._v(e._s(e.$t("components_dialog_file_history_txt25")))])])]:e._e()],2)],1),r("ul",{directives:[{name:"show",rawName:"v-show",value:e.historyMenuShow,expression:"historyMenuShow"},{name:"clickoutside",rawName:"v-clickoutside",value:e.historyMenuHide,expression:"historyMenuHide"}],ref:"history_list_menu",staticClass:"history_list_menu kdv-menu",attrs:{tabindex:"0"},on:{contextmenu:e.handleDropdownmenu}},[r("li",{directives:[{name:"show",rawName:"v-show",value:e.selectedNum&&0!==e.selectedNum,expression:"selectedNum && selectedNum !== 0"}],class:["kdv-menu-item"]},[r("div",{staticClass:"history_list_menu__item-block",attrs:{tabindex:"0"},on:{click:function(t){return e.handleCover()}}},[r("a",[e._v(e._s(e.$t("components_dialog_file_history_txt5")))])])]),r("li",{class:["kdv-menu-item"]},[r("div",{staticClass:"history_list_menu__item-block",attrs:{tabindex:"0"},on:{click:function(t){return e.handleSaveas()}}},[r("a",[e._v(e._s(e.$t("components_dialog_file_history_txt14")))])])]),r("li",{directives:[{name:"show",rawName:"v-show",value:e.isVisiableHistoryMark&&e.isShowHistoryMark,expression:"isVisiableHistoryMark && isShowHistoryMark"}],class:["kdv-menu-item"]},[r("div",{staticClass:"history_list_menu__item-block",attrs:{tabindex:"0"},on:{click:function(t){return e.handleHistoryMark()}}},[r("a",[e._v(e._s(e.$t("components_dialog_file_history_txt29")))])])])])],1)}),[],!1,null,null,null).exports,tr=20,ir={name:"DriveFileHistory",data:function(){return{items:"",fetching:!1,noMoreItems:!1,scrollContent:{list:"",pagination:{count:tr,offset:0}},contactList:!1}},mixins:[G.default,E.Z,D.Z],props:{file:{type:Object,required:!0}},watch:{flushTime:function(){var e=this;return(0,s.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.contactList=!1,e.$store.state.file.status!==Gt.jP){t.next=6;break}return t.next=5,e.loadHistoryList({offset:0,count:tr});case 5:e.items=t.sent;case ),t)})))()}},computed:{flushTime:function(){return this.$store.state.file.flushTime},role:function(){var e=this.file.groupid,t=this.$store.state.team.list.find((function(t){return e===t.id}));return t&&t.user_role||""},isSecretExpired:function(){var e=this.$store.state,t=e.team,i=e.user;return"Secret"===e.route.name&&t.mySecret&&!(i.privileges&&i.privileges.secret_folder)}},components:{Scroll:gi.Z},created:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i={offset:0,count:tr},e.contactList=!1,t.next=5,e.loadHistoryList(i);case 5:e.items=t.sent,t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),e._error(t.t0),e.handleClose();case 12:case"end":return t.stop()}}),t,null,[[0,8]])})))()},methods:{fetchItems:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.contactList=!0,t.next=3,e.loadHistoryList({offset:e.items.length,count:tr});case 3:return i=t.sent,e.items=[].concat((0,b.Z)(e.items),(0,b.Z)(i)),t.abrupt("return",{items:i,pagination:{count:tr}});case 6:case"end":return t.stop()}}),t)})))()},loadHistoryList:function(){var e=(0,s.Z)(a().mark((function e(t){var i,r,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Object.assign({},t,{groupid:this.file.groupid}),e.next=3,N.drive.get("/api/v3/files/".concat(this.file.id||this.file.fileid,"/histories"),{params:i});case 3:return r=e.sent,n=r.data,this.scrollContent=Object.assign({},this.scrollContent,{list:this.contactList?[].concat((0,b.Z)(this.items),(0,b.Z)(n.histories)):n.histories,pagination:{count:tr,offset:t.offset+t.count}}),e.abrupt("return",n.histories);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),handleClose:function(){this.$emit("close")},handleDownload:function(e){(0,Ti.fP)(e,{ua:this.$ua,toastError:this._error,state:this.$store.state,message:this.$message,dialog:this.dialog})},handleCover:function(e){var t=this;return(0,s.Z)(a().mark((function i(){return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,t.handleSecretExpired();case 3:if(!i.sent){i.next=5;break}return i.abrupt("return");case 5:if(t.items[0].fver!==e.fver){i.next=10;break}return t.$message.success("恢复成功"),i.abrupt("return");case 10:return i.next=12,N.drive.post("/api/v3/files/".concat(e.fileid,"/histories/").concat(e.id,"/recover"),{groupid:e.groupid});case 12:t.fetching=!1,t.noMoreItems=!1,t.$store.commit(u._P6);case 15:t.$message.success("恢复成功"),i.next=21;break;case 18:i.prev=18,i.t0=i.catch(0),t._error(i.t0);case 21:case"end":return i.stop()}}),i,null,[[0,18]])})))()},upload:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r,n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.$ua,r=i.WPS,n=i.IS_WPS_DRIVER,t.next=3,e.handleSecretExpired();case 3:if(!t.sent){t.next=5;break}return t.abrupt("return");case 5:if(!r||n){t.next=9;break}return(0,Hi.U_)(),new Zi.Z({state:e.$store.state},{params:{filename:e.file.fname||e.file.name,groupid:e.file.groupid},previousId:e.file.id||e.file.fileid}).execute(),t.abrupt("return");case 9:case"end":return t.stop()}}),t)})))()},handleSecretExpired:function(){return!!this.isSecretExpired&&(this.dialog("preventUpload",{backprev:!0,useNewLayout:this.$store.state.ui.useNewLayout}),!0)}}},rr=ir,nr=(0,y.Z)(rr,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"file-history-content"},[i("div",{staticClass:"history-list"},[i("Scroll",{attrs:{scrollContent:e.scrollContent}},e._l(e.items,(function(t){return i("el-row",{key:t.id},[i("el-col",{attrs:{span:12}},[i("div",[e.$ua.yun||e.$ua.wps18and19?i("icon",{staticClass:"fileicon",attrs:{slot:"fileicon",type:e._f("yunIcon")(t.fname,t.ftype)},slot:"fileicon"}):e._e(),e._v(" "+e._s(e._f("relative")(t.mtime))+e._s(0===t.id?" (当前版本)":"")+" ")],1)]),i("el-col",{staticClass:"download",class:{hidedownload:0!==t.id},attrs:{span:6}},[i("div",{staticClass:"file-action",class:e.$ua.yun||e.$ua.wps18and19?"tc":""},[i("el-button",{class:e.$ua.yun||e.$ua.wps18and19?"f-color":"btn-border",on:{click:function(i){return e.handleDownload(t)}}},[e.$ua.yun||e.$ua.wps18and19?i("span",[e._v("下载")]):i("Icon",{attrs:{type:"download"}})],1)],1)]),i("el-col",{attrs:{span:6,offset:6}},["read_member"!==e.role&&0!==t.id?i("div",[i("div",{staticClass:"file-action cover"},[i("el-button",{class:e.$ua.yun||e.$ua.wps18and19?"f-color":"btn-border",on:{click:function(i){return e.handleCover(t)}}},[e.$ua.yun||e.$ua.wps18and19?i("span",[e._v("恢复版本")]):i("Icon",{attrs:{type:"clock"}})],1)],1)]):e._e()])],1)})),1)],1),i("div",{staticClass:"footer"},["read_member"===e.role||this.$ua.wps2018beta?e._e():i("a",{staticClass:"el-button el-button--default plupload-anchor",attrs:{"data-filename":e.file.fname,"data-groupid":e.file.groupid,"data-parentid":e.file.parentid,"data-corpid":e.file.corpid},on:{click:e.upload}},[e._v("上传新版本 ")]),i("el-button",{attrs:{type:"primary"},on:{click:e.handleClose}},[e._v("确定")])],1)])}),[],!1,null,null,null).exports,sr=20,or={name:"DriveFileHistory",data:function(){return{items:"",groupHistories:[],scrollContent:{list:"",pagination:{count:sr,offset:0}},lastFinishVersion:-1,contactList:!1,mark:"",show:!0,selectedNum:-1,editedNum:-1,editedNameComm:"",historyFilter:!1,historyMenuShow:!1,timer:null,isTablet:!1,elSwitchStyle:{width:32,"active-color":"#417FF9","inactive-color":"#E6E6E6"},groupInfo:{}}},mixins:[G.default,E.Z,Ci.ZP,D.Z],props:{file:{type:Object,required:!0}},directives:{Clickoutside:Si.Z},watch:{flushTime:function(){var e=this;return(0,s.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.$store.state.fi.loadHistoryList({offp(e.items,!0);case 8:case"end":return t.stop()}}),t)})))()},historyMenuShow:function(e){var t=this;e&&this.$nextTick((function(){t.$refs.history_list_menu.focus()}))}},computed:{flushTime:function(){return this.$store.state.file.flushTime},isSecretExpired:function(){var e=this.$store.state,t=e.team,i=e.user;return"Secret"===e.route.name&&t.mySecret&&!(i.privileges&&i.privileges.secret_folder)},type:function()ind((function(t){return~yi.Nz[t].indexOf(e)||""}));return"ksheet"===t?"k":t},isProcessonFile:function(){return yi.ET.indexOf((0,l.getExtName)(this.file.fname))>-1},isKsheetFile:function(){return"ksheet"===(0,l.getExtName)(this.file.fname)},canHistoryPreview:function(){var e=this.file.fname?this.file.fname.split("."):"unknown",t=1===e.length?"unknown":wi()(e).toLowerCase(),i=-1!==(0,b.Z)(yi.Y_).indexOf(t);return["s","w","p","f","o"].includes(this.type)||this.isKsheetFile||i},isWord:function(){return"w"===this.type},needHide:function(){return!1},isVisiableHistoryMark:function(){return this.$store.state.switchCof.shieldSwitch.historyMarkSwitch&&("corpnormal"===this.groupInfo.group_type||"corpdep"===this.groupInfo.group_type)},isShowHistoryMark:function(){var e=yi.Nz.s,t=yi.((0,b.Z)(e),(0,b.Z)(t),(0,b.Z)(i),(0,b.Z)(r),(0,b.Z)(n),(0,b.Z)(s),(0,b.Z)(yi.ET),(0,b.Z)(yi.Y_),["img"]).includes((0,l.getExtName)(this.file.fname,this.file.ftype))},hasPerm:function(){return this.file.file_acl&&this.file.file_acl.modify}},components:{Scroll:gi.Z},mounted:function(){var e=this;(0,Di.XN)("eventName","HistoryRecoverSuccess",(function(){e.$store.commit(u._P6)})),this.selectedFolder.$on("handleFolder",this.handleFolder.bind(this))},created:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i={offset:0,count:sr},e.contactList=!1,t.next=5,e.loadHistoryList(i);case 5:return e.items=t.sent,e.historyGroup(e.items),t.next=9,e.fetchGroupInfo(e.file.groupid);case 9:e.groupInfo=t.sent,t.next=16;break;case 12:t.prev=12,t.t0=t.catch(0),e._error(t.t0),e.handleClose();case 16:e.historyDw({action:"show",type:"panel",postion:"homepage"});case 17:case"end":return t.stop()}}),t,null,[[0,12]])})))()},methods:{formatMtime:$i.Z.date,getFileMetadata:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,N.drive.get("/api/v5/files/".concat(e.file.id||e.file.fileid,"/metadata"));case 3:return i=t.sent,r=i.data,t.abrupt("return",r&&r.user_acl&&r.user_acl.download||0);case 8:return t.prev=8,t.t0=t.catch(0),e._error(t.t0),t.abrupt("return",null);case 12:case"end":return t.stop()}}),t,null,[[0,8]])})))()},fetchGroupInfo:function(e){var t=this;return(0,s.Z)(a().mark((function i(){var r;return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,!t.$store.state.switchCof.shieldSwitch.historyMarkSwitch){i.next=8;break}return i.next=4,N.drive.get("/api/v3/groups/".concat(e));case 4:return r=i.sent,i.abrupt("return",r.data);case 8:return i.abrupt("return",{});case 9:i.next=14;break;case 11:return i.prev=11,i.t0=i.catch(0),i.abrupt("return",{});case 14:case"end":return i.stop()}}),i,null,[[0,11]])})))()},fetchItems:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.contactList=!0,t.next=3,e.loadHistoryList({offset:e.items.length,count:sr});case 3:return i=t.sent,e.items=[].concat((0,b.Z)(e.items),(0,b.Z)(i)),e.historyGroup(e.items,!1,!0),t.abrupt("return",{items:i,pagination:{count:sr}});case 7:case"end":return t.stop()}}),t)})))()},loadHistoryList:function(){var e=(0,s.Z)(a().mark((function e(t){var i,r,n,s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.historyFilter){e.next=6;break}return i=[],e.next=4,this.loadHistoryListByScene(t);case 4:return i=e.sent,e.abrupt("return",i);case 6:return r=Object.assign({},t,{groupid:this.file.groupid}),e.prev=7,e.next=10,N.drfile.id||this.file.fileid,"/histories"),{params:r});case 10:if(n=e.sent,s=n.data,!this.isVisiableHistoryMark){e.next=17;break}return e.next=15,(0,_.M5)(s.histories);case 15:o=e.sent,s.histories.forEach((function(e,t){e.historyTagList=o[t]}));case 17:return this.scrollContent=Object.assign({},this.scrollContent,{list:this.contactList?[].concat((0,b.Z)(this.items),(0,b.Z)(s.histories)):s.histories,pagination:{count:sr,offset:t.offset+t.count}}),e.abrupt("return",s.histories);case 21:return e.prev=21,e.t0=e.catch(7),this._error(e.t0),e.abrupt("return",[]);case 25:case"end":return e.stop()}}),e,this,[[7,21]])})));return function(t){return e.apply(this,arguments)}}(),loadHistoryListByScene:function(){var e=(0,s.Z)(a().mark((function e(t){var i,r,n,s,o,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={count:sr,fileId:this.file.id||this.file.fileid,scene:0},this.lastFinishVersion>=0&&(t.lastFinishVersion=this.lastFinishVersion),r=Object.assign(i,t,{groupId:this.file.groupid}),e.prev=3,e.next=6,N.drive.get("/api/v5/files/".concat(this.file.id||this.file.fileid,"/histories/scene/0"),{params:r});case 6:return n=e.sent,s=n.data,o=this.historyListFilter(s.histories),this.scrollContent=Object.assign({},this.scrollContent,{list:this.contactList?[].concat((0,b.Z)(this.items),(0,b.Z)(o)):o,pagination:{count:sr,offset:t.offset+t.count}}),this.lastFinishVersion=s.lastFinishVersion,e.abrupt("return",o);case 14:if(e.prev=14,e.t0=e.catch(3),!(c=e.t0.response)||!c.data||"notExist"!==c.data.result){e.next=21;break}return e.abrupt("return",[]);case 21:this._error(e.t0);case 22:return e.abrupt("return",[]);case 23:case"end":return e.stop()}}),e,this,[[3,14]])})));return function(t){return e.apply(this,arguments)}}(),historyGroup:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e;try{var s=(0,Fi.groupHistoriesByDay)(n,"-"),o=(0,Fi.groupHistoriesByMinute)(s);o.forEach((function(e,n){!t.groupHistories[n]||!t.groupHistories[n].isClose||i||r&&n===o.length-1?t.$set(e,"isClose",!1):t.$set(e,"isClose",!0),Array.isArray(e.data)&&e.data)&&e.length>1&&t.$set(e[0],"isClose",!1)}))})),this.groupHistories=o}catch(e){console.log(e)}},historyListFilter:function(e){var t=this,i=[];return i=e,Array.isArray(i)&&this.historyFilter&&(i=i.filter((function(e){return!!t.getTagName(e)}))),i},init:function(){this.items="",this.scrollContent={list:"",pagination:{count:sr,offset:0}},this.lastFinishVersion=-1,this.contactList=!1},handleHistoryFilter:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.historyFilter=!e.historyFilter,e.selectedNum=-1,e.historyMenuShow=!1,e.historyPopoverHide(),e.init(),e.historyDw({action:"click",type:"show_rename",postion:"homepage"}),i={offset:0,count:sr},e.$refs.historyScroll.reloadByParents(),t.next=11,e.loadHistoryList(i);case 11:e.items=t.sent,e.historyGroup(e.items,!0),t.next=17;break;case 15:t.prev=15,t.t0=t.catch(0);cat,null,[[0,15]])})))()},historyPopoverTouch:function(){var e=this;this.$ua.isTablet&&(this.$refs.historyPopover.doShow(),this.historyMenuShow=!1,this.timer&&clearTimeout(this.timer),this.timer=setTimeout((function(){e.historyPopoverHide()}),4e3))},historyPopoverHide:function(){this.$refs.historyPopover.doClose(),this.timer&&clearTimeout(this.timer)},handleClose:function(){this.$emit("close")},handleEditedName:function(e,t){var i=this;this.selectedNum=t,this.editedNum=t;try{e.tag_info.tag&&e.tag_info.tag_name?this.editedNameComm=e.tag_info.tag_name:this.editedNameComm=""}catch(e){this.editedNameComm=""}this.$nextTick((function(){i.$refs["historyInput".concat(t)][0].focus(),i.$refs["historyInput".concat(t)][0].select()})),this.$ua.isTablet&&(this.historyMenuShow=!1,this.historyPopoverHide()),this.historyDw({action:"click",type:"rename",postion:"homepage"})},editedNameFocus:function(e,t){this.selectedNum=t,this.editedNum=t;try{e.tag_info.tag&&e.tag_info.tag_name?this.editedNameComm=e.tag_info.tag_name:this.editedNameComm=""}catch(e){this.editedNameComm=""}},editedNameInput:function(){/[/\\:*?"<>|]+/g.test(this.editedNameComm)&&(this.$message.erroe(/[/\\:*?"<>|]+/g,"")),this.editedNameComm.length>20&&(this.editedNameTooLong(),this.editedNameComm=this.editedNameComm.slice(0,20))},editedNameTooLong:bi()((function(){this.$message.error(this.$t("components_dialog_file_history_txt27"))}),800),editedNameEnter:function(e){if(this.selectedNum=-1,this.editedNum=-1,this.$ua.isTablet&&this.getTagName(e)!==this.editedNameComm&&(this.getTagName(e)||this.editedNameComm)){if(this.isEmojiCharacter(this.editedNameComm))return void this.$message.error((0,c.exception)("illegalFname"));e.tag_info||(e.tag_info={}),e.tag_info.tag_name=this.editedNameComm,this.rename(e,this.editedNameComm)}},editedNameBlur:function(e){if(this.selectedNum=-1,this.editedNum=-1,!this.$ua.isTablet&&this.getTagName(e)!==this.editedNameComm&&(this.getTagName(e)||this.editedNameComm)){if(this.isEmojiCharacter(this.editedNameComm))return void this.$message.error((0,c.exception)("illegalFname"));e.tag_info||(e.tag_info={}),e.tag_info.tag_name=this.editedNameComm,this.rename(e,this.editedNameComm)}},rename:function(e,t){var i=this;return(0,s.Z)(a().mark((function r(){var n,s,o;return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n={file_id:e.fileid,file_ver:e.fver,scene:0,tag_name:t},r.prev=1,r.next=4,N.drive.post("/api/v5/files/".concat(e.fileid,"/histories/tag"),n);case 4:return s=r.sent,"ok"===s.data.result&&i.$message.success(i.$t("components_dialog_file_history_txt16")),o={offset:0,count:i.items.length+sr},i.lastFinishVersion=-1,r.next=11,i.loadHistoryList(o);case 11:i.items=r.sent,i.historyGroup(i.items),r.next=18;break;case 15:r.prev=15,r.t0=r.catch(1),i._error(r.t0);case 18:case"end":return r.stop()}}),r,null,[[1,15]])})))()},handlePreview:function(e){(0,Oi.Eq)(e,{ua:this.$ua,route:this.$route,toastError:this._error,state:this.$store.state,message:this.$message,dialog:this.dialog,powerConfig:this.powerConfig}),this.historyDw({action:"click",type:"preview",postion:"homepage"})},handleDownload:function(e){(0,Ti.fP)(e,{ua:this.$ua,toastError:this._error,state:this.$store.state,message:this.$message,dialog:this.dialog})},handleCover:function(){var e=this,t=this.selectedItem,i=this.getTagName(t);i=i?"[".concat(i,"]"):"",this.dialog("recoverHistoryFile",{csource:"YunCreateFolder",back:!0,backprev:!0,groupid:t.groupid,fileid:t.fileid,historyid:t.id,mtime:t.mtime,modifier:t.modifier.name,editedName:i,onRecover:function(t){var i=this;setTimeout((function(){e.historyFilter=!1,e.$refs.historyScroll.scrollToTop(),i.$store.commit(u._P6)}),500),this.$router.push({name:"Private",params:{fid:t.id||t.fileid}})}}),this.historyDw({action:"click",type:"recover",postion:"homepage"})},upload:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r,n,s;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.$ua,r=i.WPS,n=i.IS_WPS_DRIVER,s=i.isTablet,t.next=3,e.handleSecretExpired();case 3:if(!t.sent){t.next=5;break}return t.abrupt("return");case 5:if(!(r&&!n||s)){t.next=10;break}return(0,Hi.U_)(),new Zi.Z({state:e.$store.state},{params:{filename:e.file.fname||e.file.name,groupid:e.file.groupid},previousId:e.file.id||e.file.fileid}).execute(),e.$ua.isTablet&&setTimeout((function(){var t=e.$refs.upload;if(t){var i=t.querySelector(".uploader-button");i&&i.classList.add("needsclick")}}),0),t.abrupt("return");case 10:case"end":return t.stop()}}),t)})))()},handleSecretExpired:function(){return!!this.isSecretExpired&&(this.dialog("preventUpload",{backprev:!0,useNewLayout:this.$store.state.ui.useNewLayout}),!0)},handleSaveas:function(){_.Jm.bind(this)(this.file.id||this.file.fileid,this.selectedItem)},handleHistoryMark:function(){var e=this;this.moreVisible="",Pi.Z.show({groupid:this.file.groupid-0,rolePermission:{role:{admin:"admin",creator:"owner",member:"member"}[this.groupInfo.user_role]},subTitle1:"当前版本：".concat(Ei()(1e3*this.selectedItem.mtime).format("MM-DD HH:mm")),subTitle2:this.selectedItem.tag_info&&this.selectedItem.tag_info.tag_name,subTitle3:this.selectedItem.modifier.name,historyVersion:{id:this.selectedItem.id,tag:this.selectedItem.historyTagList&&this.selectedItem.historyTagLisselectedItem.id,currentVersion:[{fileid:this.file.id-0,tag:this.selectedItem.historyTagList&&this.selectedItem.historyTagList.length?this.selectedItem.historyTagList:[]}],onSuccess:function(){e.historyFilter=!e.historyFilter,e.handleHistoryFilter()}})},handleFolder:function(e,t,i,r){e===this.gid&&t===this.pid||(this.pathchanged=!0),this.pid=t,this.gid=e,this.icontype="share"===i?"dialog-team-folder-s":"folder-s-selected",this.positionName=r},scrollEvent:function(){this.historyPopoverHide(),-1!==this.selectedNum&&(this.selectedNum=-1,this.historyMenuShow=!1)},handleRowClick:function(e){-1!==this.selectedNum&&(this.selectedNum=-1),this.$ua.isTablet&&(this.historyPopoverHide(),this},handleMoreClick:function(e,t,i){this.selectedNum=t,this.selectedItem=i,this.setContextmenuPosition(e,0,4),this.historyMenuShow=!this.historyMenuShow,this.historyPopoverHide()},historyMenuHide:function(){this.selectedNum=-1,this.historyMenuShow=!1},handleContextmenu:function(e,t,i){e.preventDefault(),this.selectedNum=t,this.selectedItem=i,this.setContextmenuPosition(e),this.historyMenuShow=!0},setContextmenuPosition:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.$refs.history_list_menu,n=this.mousePosition(e);r.style.left=n.x+t-30+"px",r.style.top=n.y+i-77+"px"},mousePosition:function(e){var t=document.body.clientWidth,i=document.body.clientHeight,r=e.pageX-(t-600)/2,n=e.r=407),r<=0&&(r=0),n>=374&cument.body.cliscrollTop-document.body.clientTop}},handleDropdownmenu:function(e){e.preventDefault()},getTagName:_.f9,isFromWPS:function(e){return["pc-office","ios-office","android-office","mac-office"].includes(e)},listTitleClick:function(e){e.isClose=!e.isClose},listTitleClicklevel1:function(e){Array.isArray(e)&&e.length>1&&(e[0].isClose=!e[0].isClose)},foldBoxHover:function(e){this.$refs[e][0].style.background="#F9FAFD"},foldBoxLeave:function(e){this.$refs[e][0].style.background="#fff"},isEmojiCharacter:function(e){for(var t=0;t<e.length;t++){var i=e.charCodeAt(t);if(55296<=i&&i<=56319){if(e.length>1){var r=1024*(i-55296)+(e.charCodeAt(t+1)-56320)+65536;if(118784<=r&&r<=128895)return!0}}else if(e.length>1){if(8419==e.charCodeAt(t+1))return!0}else{if(8448<=i&&i<=10239)return!0;if(11013<=i&&i<=11015)return!0;if(10548<=i&&i<=10549)return!0;if(12951<=i&&i<=12953)return!0;if(169==i||174==i||12349==i||12336==i||11093==i||11036==i||11035==i||11088==i)return!0}}},historyDw:function(e){var t=e.action,i=e.type,r=e.postion,n=this.file,s=n.id,o=n.fileid,a=n.fname;k.Z.onEvent("historyversion_action",{action:t,type:i,postion:r,fileid:s||o,filetype:(0,Ii.Li)(a)})}}},ar=or,cr=(0,y.Z)(ar,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"file-history-content"},[r("div",{staticClass:"history_tips"},[r("span",{staticClass:"tips_name",attrs:{tabindex:"0"}},[e._v(e._s(e.$t("components_dialog_file_history_txt21")))]),r("span",{staticClass:"tips_icon"},[r("el-popover",{directives:[{name:"clickoutside",rawName:"v-clickoutside.history_tips_popover",value:e.historyPopoverHide,expression:"historyPopoverHide",modifiers:{history_tips_popover:!0}}],ref:"historyPopover",attrs:{popperClass:"history_tips_popover",visibleArrow:!1,trigger:"hover",placement:"right"}},[r("span",{staticClass:"tips_text"},[e._v(e._s(e.$t("components_dialog_file_history_txt15")))]),r("img",{staticClass:"icon_history_info",attrs:{slot:"reference",src:i(13428)},on:{click:e.historyPopoverTouch},slot:"reference"})])],1),r("div",{staticClass:"history_switnts_dialog_file_history_txt20")))]),r("div",{staticClass:"history_switch_btn",attrs:{tabindex:"0","aria-label":e.$t("components_dialog_file_history_txt20")},on:{click:function(t){return t.preventDefault(),e.handleHistoryFilter.apply(null,arguments)}}},[r("el-switch",e._b({attrs:{value:e.historyFilter,activeValue:!0,inactiveValue:!1}},"el-switch",e.elSwitchStyle,!1))],1)])]),r("div",{staticClass:"history-list only_history_list touch-action"},[r("Scroll",{ref:"historyScroll",attrs:{scrollContent:e.scrollContent},on:{scrollEvent:function(t){return e.scrollEvent(e.selectedNum)}}},[e.show?[e._l(e.groupHistories,(function(t,i){return r("div",{key:i+"_root",staticClass:"history_list_tree"},[r("div",{staticClass:"title flexleft",class:{isnotipad:!e.isTablet}},[r("i",{staticClass:"components-icons components-icons-tag_fold",class:{fold_open:!t.isClose,fold_close:t.isClose},attrs:{title:t.isClose?e.$t("components_dialog_file_history_txt23"):e.$t("components_dialog_file_history_txt24")},on:{click:function(i){return e.listTitleClick(t)}}}),r("div",{staticClass:"datetime",attrs:{tabindex:"0"},on:{click:function(i){return e.listTitleClick(t)}}},[e._v(e._s(t.key))])]),r("div",e._l(t.data,(function(n,s){return r("div",{directives:[{name:"show",rawName:"v-show",value:!t.isClose||0===s,expression:"!item.isClose || level1Index === 0"}],key:i+"_"+s+"_level1",staticClass:"history_list_tree_level1 flexlefttop"},[r("div",{staticClass:"history_list_tree_level1_fold flexright"},[(n.length,e._e())]),r("div",{ref:i+"_"+s+"_level2",refInFor:!0,staticClass:"history_list_tree_level2"},e._l(n,(function(i,s){return r("div",{directives:[{name:"show",rawName:"v-show",value:!(0!==s&&n[0].isClose||t.isClose&&0!==s),expression:"(level2Index === 0 || !level1[0]=== 0)"}],keength,isSelected:e.selectedNum===i.id,row_isnotipad:!e.isTablet},attrs:{tabindex:"0"},on:{click:function(t){return e.handleRowClick(i.id)},touch:function(t){return e.handleRowClick(i.id)},contextmenu:function(t){return e.handleContextmenu(t,i.id,i)}}},[r("span",{staticClass:"time"},[e._v(e._s(e.formatMtime(e.$t("components_dialog_file_history_txt12"),i.mtime)))]),r("div",{staticClass:"avatar_icon"},[r("img",{staticClass:"avatar_icon_img",attrs:{src:i.modifier.avatar}})]),r("span",{staticClass:"modifier_name",class:{modifier_name_withsuffix:e.isFromWPS(i.device)},attrs:{title:i.modifier.name}},[e._v(e._s(i.modifier.name))]),r("span",{directives:[{name:"show",rawName:"v-show",value:e.isFromWPS(i.device),expression:"isFromWPS(level2.device)"}],staticClass:"modifier_name_suffix"},[e._v(e._s("("+e.$t("components_dialog_file_history_txt19")+")"))]),r("span",{staticClass:"editedName editedName_margin hover_hidden"},[e._v(e._s(e.getTagName(i)||""))]),r("span",{directives:[{name:"show",rawName:"v-show",value:e.editedNum!==i.id&&!e.needHide,expresme editedName_margin action",class:{cursor_pointer:!e.getTagName(i)},attrs:{tabindex:"0"}},[r("span",{class:{hover_background:e.getTagName(i)},attrs:{title:e.getTagName(i)},on:{click:function(t){return t.stopPropagation(),e.handleEditedName(i,i.id)}}},[e._v(e._s(e.getTagName(i)||e.$t("components_dialog_file_history_txt18")))])]),r("span",{directives:[{name:"show",rawName:"v-show",value:e.editedNum===i.id,expression:"editedNum === level2.id"}],staticClass:"editedName_inputbox editedName_margin action"},[r("iistoryIheck:!1,maxlength:21},domProps:{value:e.editedNameComm},on:{keyup:funceyCode,"enter",13,t.key,"Enter")?null:e.editedNameEnter(i)},input:[function(t){t.target.composing||(e.editedNameComm=t.target.value)},e.editedNameInput],blur:function(t){return e.editedNameBlur(i)},focus:function(t){return e.editedName():r("a",{staticClass:"mark preview"},[e._v(e._s(e.$t("components_dialog_file_history_txt2")))]),r("a",{staticClass:"action preview",class:{hidden:!e.canHistoryPreview&&0!==i.id},attrs:{tabindex:"0"},on:{click:function(t){return e.handlePreview(i)}}},[e._v(e._s(e.$t("components_dialog_file_history_txt1")))]),r("div",{directives:[{name:"show",rawName:"v-show",value:!e.needHide,expression:"!needHide"}],staticClass:"history_dropdown"},[r("i",{staticClass:"el-icon-more action more",attrs:{tabindex:"0"},on:{click:function(t){return t.stopPropagation(),e.handleMoreClick(t,i.id,i)}}})])])})),0)])})),0)])})),r("div",{directives:[{name:"show",rawName:"v-show",value:0===e.groupHistories.length&&e.historyFilter,expression:"groupHistories.length === 0 && historyFilter"}],staticClass:"history_list_empty"},[r("img",{staticClass:"list_empty_img",attrs:{src:i(55010)}}),r("div",{attrs:{tabindex:"0"}},[e._v(e._s(e.$t("components_dialog_file_history_txt25")))])])]:e._e()],2),r("ul",{directives:[{name:"show",rawName:"v-show",value:e.historyMenuShow,expression:"historyMenuShow"},{name:"clickoutside",rawName:"v-clickoutside",value:e.historyMenuHide,expression:"historyMenuHide"}],ref:"history_list_menu",staticClass:"history_list_menu el-dropdown-menu",attrs:{tabindex:"0"},on:{contextmenu:e.handleDropdownmenu}},[r("li",{directives:[{name:"show",rawName:"v-show",value:e.selectedNum&&0!==e.selectedNum,expression:"selectedNum && selectedNum !== 0"}],staticClass:"el-dropdown-menu__item"},[r("div",{staticClass:"history_list_menu__item-block",attrs:{tabindex:"0"},on:{click:function(t){return e.handleCover()}}},[r("a",[e._v(e._s(e.$t("components_dialog_file_history_txt5")))])])]),r("li",{staticClass:"el-dropdown-menu__item"},[r("div",{staticClass:"history_list_menu__item-block",attrs:{tabindex:"0"},on:{click:function(t){return e.handleSaveas()}}},[r("a",[e._v(e._s(e.$t("components_dialog_file_history_txt14")))])])]),r("li",{directives:[{name:"show",rawName:"v-show",value:e.isVisiableHistoryMark&&e.isShowHistoryMark,expression:"isVisiableHistoryMark && isShowHistoryMark"}],staticClass:"el-dropdown-menu__item"},[r("div",{staticClass:"history_list_menu__item-block",attrs:{tabindex:"0"},on:{click:function(t){return e.handleHistoryMark()}}},[r("a",[e._v(e._s(e.$t("components_dialog_file_history_txt29")))])])])])],1),r("div",{staticClass:"upload_box"},[r("span",{staticClass:"upload_span"},[this.$ua.wps2018beta||e.isProcessonFile||e.isKsheetFile||"o"===e.type||e.needHide?e._e():r("a",{directives:[{name:"enter-to-click",rawName:"v-enter-to-click"}],ref:"upload",staticClass:"plupload-anchor needsclick tips_upload",attrs:{tabindex:"0",role:"button","area-label":e.$t("components_dialog_file_history_txt6"),"data-fileid":e.file.id||e.file.fileid,"data-filename":e.file.fname,"data-groupid":e.file.groupid,"data-parentid":e.file.parentid,"data-corpid":e.file.corpid,"data-fileperm":e.hasPerm},on:{click:e.upload}},[e._v(" "+e._s(e.$t("components_dialogcr.exports,ur=i(85116),dr={name:"YunFileHistory",componentName:"YunFileFinder",components:{FileHistory:er,FileHistoryOld:nr,FileHistoryOld2:lr},props:{file:{type:Object,required:!0}},data:function(){return{loading:!0,source:{},isNewHistoryPanel:!1}},created:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r,n,s,o,c,l,u,d,p,f,m,h;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=e.file,r=i.id,n=i.fileid,s=i.groupid,o=i.parentid,c=i.corpid,l=void 0===c?0:c,!((r||n)&&s&&o>=0)){t.next=19;break}e.source=e.file,t.next=16;break;case 8:u=t.sent,d=u.data,p=void 0===d?{}:d,e.source.userPermission=1!==p.user_acl.update?"read":"",t.next=16;break;case 14:t.prev=14,t.t0=t.catch(5);case 16:e.loading=!1,t.next=44;break;case 19:return t.prev=19,t.next=22,(0,ur.dc)(r||n,s);case 22:e.source=t.sent,e.source.corpid=l,t.next=37;break;case 29:f=t.sent,m=f.data,h=void 0===m?{}:m,e.source.userPermission=1!==h.user_acl.update?"read":"",t.next=37;break;case 35:t.prev=35,t.t1=t.catch(26);case 37:e.loading=!1,t.next=44;break;case 40:t.prev=40,t.t2=t.catch(19),e._error(t.t2),e.$emit("close");case 44:e.isNewHistoryPanel=e.$store.state.switchCof.isNewHistoryPanel;case 45:case"end":return t.stop()}}),t,null,[[5,14],[19,40],[26,35]])})))()}},pr=dr,fr=(0,y.Z)(pr,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"yun-history-container"},[e.loading||e.$ua.wps2018beta||!e.isNewHistoryPanel?e.loading||e.$ua.wps2018beta?!e.loading&&e.$ua.wps2018beta?source},on:{close:function(){return e.$emit("close")}}}):i("Loading"):i("file-history-old2",{attrs:{file:e.source},on:{c("file-history",{attrs:{file:e.source},on:{close:function(){return e.$emit("close")}}})],1)}),[],!1,null,null,null).exports,mr={name:"HistoryHead",components:{},props:{file:{type:Object,required:!0}},data:funcfo:null}},computed:{ftype:function(){var e=this.file;return"folder"===e.ftype?e.ftype:(0,c.yunIcon)(e.fname||e.name,e.ftype)},creatorName:function(){var e=this.fileInfo;return e&&e.creator?e.creator.name:"--"}},created:function(){this.getFileInfo()},methods:{close:function(){this.$emit("close")},getFileInfo:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r,n,s;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.file,r=i.id,n=i.fileid,s=i.groupid,t.prev=1,t.next=4,(0,ur.dc)(r||n,s);case 4:e.fileInfo=t.sent,e.loading=!1,t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[1,8]])})))()}}},hr=mr,_r=(0,y.Z)(hr,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.loading?e._e():i("div",{staticClass:"history-header"},[i("KIcon",{staticClass:"history-header__fileicon",attrs:{type:e.ftype}}),i("div",{staticClass:"history-header__fileinfo"},[i("kd-tooltip",{attrs:{popperClass:"history-header-filename-tooltip",content:e.fileInfo&&e.fileInfo.fname,placement:"bottom-start"}},[i("div",{staticClass:"history-header__filename",attrs:{tabindex:"0"}},[e._v(e._s(e.fileInfo&&e.fileInfo.fname))])]),i("div",{directives:[{name:"show",rawName:"v-show",value:e.creatorName,expression:"creatorName"}],staticClass:"secondary-content"},[i("span",{staticClass:"history-header__creatorname",attrs:{title:e.creatorName}},[e._v("创建者："+e._s(e.creatorName))])])],1)],1)}),[],!1,null,null,null).exports,vr=i(95241),gr={name:"YunCreateFolder",componentName:"YunCreateFolder",props:{ext:String},data:function(){return{newFile:{name:""},rules:{name:[{pattern:/^[^/\\:*?"<>|]+$/,message:(0,c.exception)("illegalFname"),trigger:"change"},{max:240-this.ext.length-1,message:(0,c.exception)("fileNameLengthExceed"),trigger:"change"}]},loading:!1,gid:"",pid:"",icontype:"Team"===this.$store.state.route.name&&3===this.$store.state.route.path.split("/").length?"dialog-team-folder-s":"folder-s-selected",positionName:""}},mixins:[E.Z,G.default],computed:{btnStatus:function(){return!(this.newFile.name.trim().length>0)},position:function(){var e=this.$store.state.route,t=e.name,i=e.params;if("Team"===t||"Mine"===t||"Secret"===t){var r=this.$store.state.file.path;return r[r.length-1].text}if("Enterprise"===t){if(i.fid){var n=this.$store.state.file.path;return n[n.length-1].text}return this.$store.state.team.current.name}return this.$t("file_new_File5")},isSecretFolder:function(){return"Secret"===this.$store.state.route.name}},methods:{submitForm:function(e){var t=this;return this.$refs[e].validate(function(){var e=(0,s.Z)(a().mark((function e(i){var r,n,s,o,c,l,d,p,f,m,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i){e.next=32;break}return e.prev=1,t.loading=!0,r=t.$store.state,n=r.route,s=r.team,o=s.myCloud,c=t.gid,"Auto"!==n.name&&"Devices"!==n.name&&"Device"!==n.name||c||!o||(c=o.id),e.next=9,t.$store.dispatch(u.vb$,{name:t.newFile.name+"."+t.ext,ext:t.ext,groupid:c,parentid:t.pid});case 9:if(l=e.sent,d=l.data,p="All",f={tid:t.gid,fid:t.pid||void 0},!t.gid){e.next=20;break}return e.next=16,N.drive.get("/api/v3/groups/".concat(t.gid));case 16:m=e.sent,h=m.data,"Enterprise"===(p=t.isSecretFolder?"Secret":h.corpid?"Enterprise":"Team")&&(f.cid=h.corpid);case 20:t.loading=!1,t.$emit("close"),t.$router.replace({name:p,params:f}),setTimeout((function(){t.$store.commit(u.JJp,[d.id])}),300),e.next=30;break;case 26:e.prev=26,e.t0=e.catch(1),t.loading=!1,t._error(e.t0);case 30:e.next=33;break;case 32:return e.abrupt("return",!1);case 33:case"end":return e.stop()}}),e,null,[[1,26]])})));return function(t){return e.apply(this,arguments)}}()),!1},handleClose:function(){this.$emit("close")},showFinder:function(){var e=this,t=this.$t("file_new_File6");this.dialog("Finder",{title:t,size:"small",exclude:[],type:"found_folder",onCommit:function(t){var i=t.groupid,r=t.id,n=t.type,s=t.name;e.selectedFolder.$emit("handleFolder",i,r,n,s),e.$emit("close","ok")}})},handleFolder:function(e,t,i,r){this.pid=t,this.gid=e,this.icontype="sharefolder"===i?"dialog-team-folder-s":"folder-s-selected",this.positionName=r}},watch:{"$store.state.route":{handler:function(e){if(["Team","Mine","Secret"].includes(e.name)){var t=this.$store.state.file.target.split("_");this.gid=t[0],this.pid=t[1]||"0"}else"Enterprise"===e.name&&(this.gid=e.params.tid,this.pid="0",e.params.fid&&(this.pid=e.params.fid))},immediate:!0}},mounted:function(){~vr.G3.doc.indexOf(this.ext)?this.newFile.name=this.$t("file_new_File7"):~vr.G3.xls.indexOf(this.ext)?this.newFile.name=this.$t("file_new_File8"):~vr.G3.ppt.indexOf(this.ext)?this.newFile.name=this.$t("file_new_File9"):~vr.G3.pom.indexOf(this.ext)?this.newFile.name=this.$t("file_new_File10"):~vr.G3.pof.indexOf(this.ext)&&(this.newFile.name=this.$t("file_new_File11")),this.selectedFolder.$on("handleFolder",this.handleFolder.bind(this))},directives:{focus:m.Z}},yr=gr,xr=(0,y.Z)(yr,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-form",{ref:"newFile",attrs:{model:e.newFile,labelPosition:"top",prop:"name",rules:e.rules},nativeOn:{submit:function(t){return t.preventDefault(),e.submitForm("newFile")}}},[i("el-form-item",{attrs:{prop:"name",label:e.$t("file_new_File0")}},[i("el-input",{directives:[{name:"focus",rawName:"v-focus"},{name:"pad-focus",rawName:"v-pad-focus"}],attrs:{placeholder:e.$t("file_new_File1"),disabled:e.loading},model:{value:e.newFile.name,callback:function(t){e.$set(e.newFile,"name",t)},expression:"newFile.name"}},[i("template",{slot:"append"},[e._v("."+e._s(e.ext))])],2)],1),i("div",{directives:[{name:"show",rawName:"v-show",value:!e.isSecretFolder,expression:"!isSecretFolder"}],staticClass:"select-foder"},[i("p",[e._v(e._s(e.$t("file_new_File2")))]),i("el-button",{staticClass:"folder-selected",on:{click:e.showFinder}},[i("KIcon",{staticClass:"folder-icon",attrs:{type:e.icontype}}),i("span",{staticClass:"position",attrs:{title:e.positionName||e.position}},[e._v(e._s(e.positionName||e.position)+" ")]),i("KIcon",{staticClass:"down-icon",attrs:{type:"down"}})],1)],1),i("div",{staticClass:"footer"},[i("el-button",{on:{click:e.handleClose}},[e._v(e._s(e.$t("file_new_File3")))]),i("el-button",{attrs:{type:"primary",disabled:e.btnStatus,loading:e.loading},om("newFile")}}},[e._v(e._s(e.$t("file_new_File4")))])],1)],1)],1)}),[],!1,null,null,null).exports,br={name:"YunCreateFilePosition",componentName:"YunCreateFilePosition",props:{ext:String,onCommit:{type:Function,default:function(){return Promise.resolve(!0)}}},data:function(){return{loading:!1,gid:"",pid:"",icontype:"Team"===this.$store.state.route.name&&3===this.$store.state.route.path.split("/").length?"dialog-team-folder-s":"folder-s-selected",positionName:"",pathchanged:!1}},mixins:[E.Z,G.default],computed:{position:function(){var e=this.$store.state,t=e.route,i=e.file,r=e.team,n=e.company.entspaceid,s=t.name;if(["Team","Mine","Secret","Enterprise","Device","Group"].indexOf(s)>-1||n){var o=i.path,a="",c=n&&["Latest","Tags","EntHelper","Trash","EntTrash","Latest"].includes(s);return o.length&&["Enterprise","Group"].includes(o[o.length-1].key)&&[this.$t("file_new_FilePosition3"),this.$t("file_new_FilePosition7")].includes(o[o.length-1].text)&&(a=r.current.name),0===o.length&&n||c||"Backups"===s?this.$t("file_new_FilePosition6"):a||o[o.length-1].text}return this.$t("file_new_FilePosition4")},isSecretFolder:function(){return"Secret"===this.$store.state.route.name}},methods:{handleCommit:function(){this.$emit("close"),this.onCommit(this.gid,this.pid,this.pathchanged)},handleClose:function(){this.$emit("close")},showFinder:function(){var e=this,t=this.$t("file_new_FilePosition5"),i={name:"MyDocs"};if(this.$store.state.company.currentView.isEnt){i.name="EnterpriseIndex";var r={cid:parseInt(this.$store.state.company.currentView.companyid)};i.params=r}""!==this.pid&&""!==this.gid&&(i={name:"TeamFiles",params:{fid:this.pid,tid:this.gid}});this.dialog("openFinderNew",{title:t,size:"large",backprev:!0,actionType:"create",action:"selectPath",dw:{_from:"kdocs",_function:"address"},path:i,onFinderConfirm:function(t){var i=t.path,r=i.groupid,n=i.id,s=i.text,o="normal";0===n&&(o="share"),"Device"===i.name&&(r=r||0,n="d".concat(n)),e.selectedFolder.$emit("handleFolder",r,n,o,s)}})},handleFolder:function(e,t,i,r){e===this.gid&&t===this.pid||(this.pathchanged=!0),this.pid=t,this.gid=e,this.icontype="share"===i?"dialog-team-folder-s":"folder-s-selected",this.positionName=r}},watch:{"$store.state.route":{handler:function(e){var t=this.$store.state,i=t.file,r=t.team,n=t.company;if(["Team","Mine","Secret","Enterprise","Device","Group"].includes(e.name)||n.entspaceid){var s=i.path,o=i.target.split("_"),a=parseInt(o[0]),c=parseInt(o[1]||0);"Device"===e.name&&(c="d".concat(c)),this.gid=a,this.pid=c,this.groupid=a,this.parentid=c;var l=n.entspaceid&&["Latest","Tags","EntHelper","Trash","EntTrash","Latest"].includes(e.name);(0===s.length&&n.entspaceid||l||"Backups"===e.name)&&(this.gid=n.entspaceid,this.pid=0,this.groupid=n.entspaceid,this.parentid=0)}else this.groupid=r.myCloud.id,this.parentid=0},immediate:!0}},mounted:function(){this.selectedFolder.$on("handleFolder",this.handleFolder.bind(this))}},kr=br,wr=(0,y.Z)(kr,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-form",{attrs:{labelPosition:"top"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:!e.isSecretFolder,expression:"!isSecretFolder"}],staticClass:"select-foder"},[i("p",[e._v(e._s(e.$t("file_new_FilePosition0")))]),i("el-button",{staticClass:"folder-selected",on:{click:e.showFinder}},[i("KIcon",{staticClass:"folder-icon",attrs:{type:e.icontype}}),i("span",{staticClass:"position",attrs:{title:e.positionName||e.position}},[e._v(e._s(e.positionName||e.position)icon",attrs:{type:"down"}})],1)],1),i("div",{staticClass:"footer"},[i("el-button",{on:{click:e.handleClose}},[e._v(e._s(e.$t("file_new_FilePosition1")))]),i("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(t){return e.handleCommit()}}},[e._v(e._s(e.$t("file_new_FilePosition2")))])],1)])],1)}),[],!1,null,null,null).exports,$r=i(2362),Cr={name:"YunCreateFolder",componentName:"YunCreateFolder",data:function(){return{newFolder:{name:""},rules:{name:[{pattern:/^[^/\\:*?"<>|]+$/,message:(0,c.exception)("illegalFname"),trigger:"change"},{max:240,message:(0,c.exception)("fileNameLengthExceed"),trigger:"change"}]},loading:!1,gid:"",pid:"",icontype:"Team"===this.$store.state.route.name&&3===this.$store.state.route.path.split("/").length?"dialog-team-folder-s":"folder-s-selected",positionName:""}},mixins:[E.Z,G.default],computed:{btnStatus:function(){return!(this.newFolder.name.trim().length>0)},position:function(){var e=this.$store.state,t=e.route,i=e.file,r=e.team,n=e.company,s=n.entspaceid,o=n.currentView.isEnt;if(this.$store.state.ui.useNewLayout&&"Latest"===t.name)return this.groupid=r.myCloud.id,this.parentid=0,this.gid=r.myCloud.id,this.pid=0,this.$t("file_new_Folder6");if(["Team","Group","Mine","Secret","Enterprise","EntSpace"].indexOf(t.name)>-1){var a=i.path,c=i.target.split("_"),l=parseInt(c[0]),u=parseInt(c[1]||0);this.gid=l,this.pid=u,this.groupid=l,this.parentid=u;var d="",p=a[a.length-1];return"Enterprise"!==p.key&&"Group"!==p.key||![this.$t((p.text)||(d=r.current.name),d||p.text}return s&&o?(this.groupid=s,this.parentid=0,this.$t("file_new_Folder9")):(this.groupid=r.myCloud.id,this.parentid=0,this.$t("file_new_Folder6"))},isSecretFolder:function(){return"Secret"===this.$store.state.route.name}},methods:{submitForm:function(e){var t=this;return this.$refs[e].validate(function(){var e=(0,s.Z)(a().mark((function e(i){var r,n,s,o,c,l,p,f,m,_,v,g,y,x,b,w,$,C,S,F;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i){e.next=48;break}return e.prev=1,t.loading=!0,r=t.$store.state,n=r.route,s=r.team,o=r.company,c=o.entspaceid,l=o.currentView,p=l.companyid,f=l.isEnt,m=s.myCloud,_=t.gid,c&&"Enterprise"!==n.name&&(_=_||c),v=t.pid||0,g="All",y={tid:_,fid:t.pid||void 0},("Auto"===n.name&&!_&&m||"Device"===n.name)&&(_=m.id),e.next=14,t.$store.dispatch(u.vb$,{name:t.newFolder.name,ext:"folder",groupid:_,parentid:v});case 14:if(x=e.sent,t.$store.commit(u._P6),x&&(b=x.data,t.$store.state.ui.useNewLayout&&(w="".concat(d.bg.folder).concat(b.parentid),b.groupid!==m.id||b.parentid?b.parentid||(w="".concat(d.bg.group).concat(b.groupid)):w=d.Dt.myDocument.key,t.$store.dispatch(u.vcH,{key:w}),t.$ua.wpsDocumentEmbed&&(0,h.Jd)("itemAdded",{parentFileId:v,parentGroupId:_})),k.Z.onEvent("newfolder_success",{type:"folder",linkgroupid:b.linkgroupid,folderid:b.id,groupid:b.groupid})),t.$message.success(t.$t("file_new_Folder7")),t.loading=!1,t.$emit("close"),!t.$store.state.ui.useNewLayout){e.next=24;break}return e.abrupt("return");case 24:if(t.groupid===_&&t.parentid===v&&"Enterprise"!==n.name){e.next=39;break}if(!t.gid||t.gid===m.id){e.next=35;break}return e.next=28,t.$store.dispatch("GET",{url:"/api/v3/groups/".concat(t.gid)});case 28:$=e.sent,C=$.data,"corpspecial"===(F=(S=void 0===C?{}:C).group_type)?(g="EntSpace",y.cid=S.corpid):"corpindex"===F||"corpnormal"===F||"corpdep"===F?(g="Enterprise",y.cid=n.params.cid||S.corpid):"normal"===F&&(g="Team",y.tid=t.gid),e.next=36;break;case 35:t.gid&&(g=t.isSecretFolder?"Secret":"Team");case 36:t.$router.push({name:g,params:y}),e.next=40;break;case 39:"EntSpace"!==n.name&&f&&c&&t.$router.push({name:"EntSpace",params:{cid:p,tid:c}});case 40:e.next=46;break;case 42:e.prev=42,e.t0=e.catch(1),t.loading=!1,t._error(e.t0);case 46:e.next=49;break;case 48:return e.abrupt("return",!1);case 49:case"end":return e.stop()}}),e,null,[[1,42]])})));return function(t){return e.apply(this,arguments)}}()),!1},handleClose:function(){this.$emit("close")},showFinder:function(){var e=this,t=this.$t("file_new_Folder8"),i={name:"MyDocs"};if(this.$store.state.company.currentView.isEnt){i.name="EnterpriseIndex";var r={cid:parseInt(this.$store.state.company.currentView.companyid)};i.params=r}""!==this.pid&&""!==this.gid&&(i={name:"TeamFiles",params:{fid:this.pid,tid:this.gid}});this.dialog("openFinderNew",{title:t,size:"large",backprev:!0,action:"selectPath",dw:{_from:"kdocs",_function:"address"},path:i,tabs:this.$ua.wpsTeamApp||this.$ua.smallTeamDocument?$r.K7:{},onFinderConfirm:function(t){var i=t.path,r=indleFolder",r,n,o,s)}})},handleFolder:function(e,t,i,r){this.pid=t,this.gid=e,this.icontype="share"===i?"dialog-team-folder-s":"folder-s-selected",this.positionName=r}},mounted:function(){this.selectedFolder.$on("handleFolder",this.hand,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-form",{ref:"newFolder",attrs:{model:e.newFolder,labelPosition:"top",prop:"name",rules:e.rules},nativeOn:{submit:function(t){return t.preventDefault(),e.submitForm("newFolder")}}},[i("el-form-item",older0")}},[i("el-input",{directives:[{name:"focus",rawName:"v-focus"},{name:"pad-focus",rawName:"v-pad-focus"}],attrs:{placeholder:e.$t("file_new_Folder1"),disabled:e.loading},model:{value:e.newFolder.name,callback:function(t){e.$set(e.newFolder,"name",t)},expression:"newFolder.name"}})],1),i("div",{directives:[{name:"show",rawName:"v-show",value:!e.isSecretFolder,expression:"!isSecretFolder"}],staticClass:"select-foder"},[i("p",[e._v(e._s(e.$t("file_new_Folder2")))]),i("el-button",{staticClass:"folder-selected",on:{click:e.showFinder}},[i("KIcon",{staticClass:"folder-icon",attrs:{type:e.icontype}}),i("span",{staticClass:"position",attrs:{title:e.positionName||e.position}},[e._v(e._s(e.$t(e.positionName||e.position))+" ")]),i("KIco}})],1)],1),i("div",{staticClass:"footer"},[i("el-button",{on:{click:e.handleClose}},[e._v(e._s(e.$t("file_new_Folder3")))]),i("el-button",{attrs:{type:"primary",disabled:e.btnStatus,loading:e.loading},on:{click:function(t){return e.submitForm("newFolder")}}},[e._v(e._s(e.$t("file_new_Folder4")))])],1)],1)],1)}),[],!1,null,null,null).exports,Tr=i(27495),Pr=(0,Fi.getCDN)(),Nr={name:"DriveRegisterVip",componentName:"DriveRegisterVip",props:{icon:{type:String,default:"download"},title:{type:String,default:""},tip:{type:String,default:""}},data:function(){var e=[{txt:"365G".concat(this.$t("dialog_file_RegisterVip2")),icon:"".concat(Pr,"/kdocs/cloud/yunhome/vip/365g-file-upload.svg")},{txt:"1G".concat(this.$t("dialog_file_RegisterVip3")),icon:"".concat(Pr,"/kdocs/cloud/yunhome/vip/1g-file-upload.svg")},{txt:"".concat(this.$t("dialog_file_RegisterVip4")),icon:"".concat(Pr,"/kdocs/cloud/yunhome/vip/bulk-download.svg")},{txt:"".concat(this.$t("dialog_file_RegisterVip5")),icon:"".concat(Pr,"/kdocs/cloud/yunhome/vip/full-textIndex.svg")},{txt:"PDF".concat(this.$t("dialog_file_RegisterVip6"),"Word"),icon:"".concat(Pr,"/kdocs/cloud/yunhome/vip/pdf2word.svg")},{txt:"".concat(this.$t("dialog_file_RegisterVip7")),icon:"".concat(Pr,"/kdocs/cloud/yunhome/vip/doc-recovery.svg")},{txt:"".concat(this.$t("dialog_file_Registoud/yunhome/vip/png2word.svg")},{txt:"".concat(this.$t("dialog_file_RegisterVip9")),icon:"".concat(Pr,"/kdocs/cloud/yunhome/vip/more.svg"),type:"more"}];return{vipHost:A.E7.VIP,icons:Object.freeze(e)}},computed:{isUnzip:function(){return"unzip"===this.icon},link:function(){var e;return this.$ua.yun&&(e=this.$ua.docs?"docs_pc":"docs_web"),this.powerConfig.get("customUserSpaceExpandLinkString")?this.powerConfig.get("customUserSpaceExpandLinkString"):this.isUnzip?"".concat(A.Y$,"/pay/member/20?csource=pc_kdocs_decompress&payconfig=svip&position=open_zip_dialog&component==").concat(e):"//".concat(A.E7.VIP,"/pay/member/20?csource=pc_kdocs_batch&payconfig=svip&position=batch_downloads&component==").concat(e)},privilegeLink:function(){return this.powerConfig.get("customUserSpaceExpandLinkString")?this.powerConfig.get("customUserSpaceExpandLinkString"):"".concat(A.Y$,"/privilege")}},methods:{isWpsMacClient:function(){var e=window&&window.wpsQuery,t=this.$ua.isMac;return e&&t},onMore:function(){!this.isUnzip&&k.Z.onEvent("multiselect_downloadpopup",{type:"more"}),!this.isUnzip&&k.Z.onEvent("download_file",{action:"click_more",popupid:"vipmember"})},onJoin:function(){var e=this;if(this.$emit("close","ok"),this.isWpsMacClient()){var t=this.link.split("?")[1]||"",i=t.ionent==docs_web")&&t.replace("component==docs_web","component=wpsoffice_mac");(0,ge.w3)(i)}else(0,Tr.default)({payParams:(0,Fi.getParams)(this.link),paySuccessCb:function(){Promise.all([e.$store.dispatch(u.CkE),e.$store.dispatch(u.Ith)]).catch((function(){}))}});this.isUnzip||k.Z.onEvent("multiselect_downloadpopup",{type:"join"})}}},Er=Nr,Ir=(0,y.Z)(Er,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"yun-upgrade"},[i("div",{staticClass:"yun-upgrade-header"},[i("div",{staticClass:"file-icon"},[i("span",{class:e.icon})]),i("div",{staticClass:"type-title"},[e._v(" "+e._s(e.title)+" ")]),i("div",{staticClass:"tip-text"},[e._v(e._s(e.tip))])])._v(e._s(e.$t("dialog_file_RegisterVip0")))]),i("ul",{staticClass:"server"},e._l(e.icons,(function(t){return i("li",{key:t.txt},["more"===t.type?[i("drive-link",{attrs:{href:e.privilegeLink},nativeOn:{click:function(t){return e.onMore.apply(null,arguments)}}},[i("img",{staticClass:"server-icon-img",attrs:{src:t.icon,alt:t.txt}}),i("div",[i("span",[e._v(e._s(t.txt))])])])]:[i("img",{staticClass:"server-icon-img",attrs:{src:t.icon,alt:t.txt}}),i("div",[i("span",[e._v(e._s(t.txt))])])]],2)})),0),i("div",{staticClass:"upgrade-btn"},[i("el-button",{attrs:{type:"primary"},on:{click:e.onJoin}},[e._v(e._s(e.$t("dialog_file_RegisterVip10")))])],1)])])}),[],!1,null,null,null),Dr=Ir.exports,Zr=i(70885),Hr=function(){function e(t){var i=this;(0,ei.Z)(this,e),this.message=t.message,this.title=t.title,this.queryStatusMethod=t.queryStatusMethod,this.extractPercent=t.extractPercent,this.successHandler=t.successHandler,this.errorHandler=t.errorHandler,this.messageElement=this.message({message:"".concat(this.title," 0%"),iconClass:"el-icon-loading",duration:0,onClose:function(e){var t=e.$el;t&&(e.$destroy(),t.parentNode.removeChild(t),i.messageElement=null)}}),this._timer=null}return(0,ti.Z)(e,[{key:"run",value:function(){var e=this;this._timer=setInterval((0,s.Z)(a().mark((function t(){var i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.t0=e,t.next=4,e.queryStatusMethod();case 4:t.t1=t.sent,i=t.t0.extractPercent.call(t.t0,t.t1),e.messageElement.message="".concat(e.tit0:t.prev=10,t.t2=t.catch(0),e.stop(),e.errorHandler&&e.errorHandler(t.t2);case 14:case"end":return t.stop()}}),t,null,[[0,10]])}))),1e3)}},{key:"stop",value:function(){this.messageElement&&this.messageElement.close(),this._timer&&clearInterval(this._timer)}}]),e}(),Or=function(){var e=(0,s.Z)(a().mark((function e(t,i){var r,n,s,o,c,l,u,d,p,f,m,h,_,v,g,y,x,b,k,w;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=i.route,n=i.state,s=n.team.myCloud.id,o=t.fileid||t.id,"Mine"!==(c=t.from&&"string"==typeof t.from&&"search"===t.from.toLowerCase()?"Search":r.name)){e.next=6;break}return e.abrupt("return",{routeName:"Team",groupid:s,id:r.params.fid});case 6:if("Team"!==c||!r.params.fid&&!r.query.folderid){e.next=8;break}return e.abrupt("return",{routeName:"Team",linkgroupid:!r.params.fid&&r.params.tid,groupid:r.params.fid?r.params.tid:s,id:r.params.fid||r.query.folderid});case 8:if("Group"!==c){e.next=10;break}return e.abrupt("return",{routeName:"Team",groupid:r.params.tid,id:r.params.fid});case 10:if(!["Enterprise","Backup"].includes(c)){e.next=12;break}return e.abrupt("return",{routeName:"Enterprise",groupid:r.params.tid,id:"topmore"===t.from?t.parentid:r.params.fid,corpid:parseInt(r.params.cid)});case 12:if("Device"!==c){e.next=14;break}return e.abrupt("return",{routeName:"Device",groupid:r.params.tid,id:r.params.did,ftype:"device"});case 14:if("Secret"!==c){e.next=16;break}return e.abrupt("return",{routeName:"Secret",groupid:r.params.tid||n.team.mySecret.id,id:r.params.fid});case 16:if(l=t.link||t.sid||t.isshare,u=Number(t.groupid),"All"!==c&&u!==n.team.mySecret.id&&u!==n.team.myUpload.id&&!l){e.next=20;break}return e.abrupt("return");case 20:if(d=0===t.parentid?void 0:t.parentid,p=o&&!d?t.folderid||o:void 0,f=t.corpid||void 0,!t.groupid||!p){e.next=35;break}return h=[],d?h.push(Promise.resolve({})):h.push(N.drive.get("/api/v3/groups/".concat(t.groupid,"/files/").concat(p))),!t.corpid&&n.user.companyid?h.push(N.drive.get("api/v3/groups/".concat(t.groupid))):h.push(Promise.resolve({})),e.next=29,Promise.all(h);case 29:_=e.sent,v=(0,Zr.Z)(_,2),g=v[0],y=v[1],g.data&&parseInt(g.data.parentid)&&(d=g.data.parentid,p=void 0),y.data&&(y.data.user_role&&(m=y.data.user_role),(x=parseInt(y.data.corpid))&&(f=x));case 35:if(!t.groupid||d||f){e.next=47;break}if("creator"!==m){e.next=44;break}return e.next=39,N.drive.get("/api/v5/groups/linkfolders?groupids=".concat(t.groupid));case 39:if(!((b=e.sent)&&b.data&&b.data.info&&b.data.info[t.groupid]>0)){e.next=42;break}return e.abrupt("return",{routeName:"Team",groupid:s,linkgroupid:t.groupid,id:b.data.info[t.groupid]});case 42:e.next=45;break;case 44:return e.abrupt("return",{routeName:"Team",groupid:t.groupid,ftype:"linkfolder"});case 45:e.next=57;break;case 47:if(!t.groupid||!d||"EntSpace"!==c){e.next=57;break}if(!r.params.cid){e.next=52;break}f=r.params.cid,e.next=57;break;case 52:return e.next=54,N.drive.get("api/v3/groups/".concat(t.groupid));case 54:k=e.sent,w=k.ds||d){e.next=59;break}return e.abrupt("return");case 59:return e.abrupt("return",{corpid:parseInt(f,10),routeName:f?"Enterprise":"Team",groupid:t.groupid,id:d});case 60:case"end":return e.stop()}}),e)})));return function(t,i){return e.apply(this,arguments)}}(),Lr=function(e){return{back:!1,title:e?(0,r.GH)("mixins_desktop_txt9"):(0,r.GH)("mixins_desktop_txt10"),upgradeType:e?"spaceFull":"noPermission"}},Gr={downloading:25,extracting:50,uploading:75},Mr="expectedError";function Rr(){return Rr=(0,s.Z)(a().mark((function e(t,i){var n,o,c,l,u,d,p,f;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.groupid,o=t.fileid,e.prev=1,c=i.state,l=c.team,u=c.user,d="40"===u.vip_level,e.next=6,Or(t,i);case 6:p=e.sent,f={name:"MyDocs"},i.state.company.currentView.isEnt&&(f.name="EnterpriseIndex",f.params={cid:parseInt(i.state.company.currentView.companyid)}),p&&p.routeName&&(["Secret","Team"].includes(p.routeName)&&(f.name="TeamFiles",f.params={tid:p.groupid,fid:p.id}),["Enterprise"].includes(p.routeName)&&p.corpid&&(f.name="TeamFiles",f.params={cid:p.corpid,tid:p.groupid,fid:p.id})),i.dialog("openFinderNew",{title:(0,r.GH)("mixins_desktop_txt2"),size:"large",back:!1,backprev:!1,okClose:!0,actionType:"create",action:"selectPath",dw:{_from:"kdocs",_function:"address"},path:f,tabs:i.ua.wpsTeamApp||i.ua.smallTeamDocument?$r.K7:{},onFinderConfirm:function(){var e=(0,s.Z)(a().mark((function e(t){var c,u,p,f,m,h,_,v,g;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=t.path,u=c.name,p=c.groupid,f=c.id,"Device"!==u){e.next=4;break}return i.message.error((0,r.GH)("mixins_dek((function e()(e.prev=e.next){case 0:return e.next=2,N.drive.get("/api/v3/groups/".concat(n,"/archives/").concat(o,"/extract"),{params:m});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),extractPercent:function(e){var t=e.data||{},r=t.code,n=t.status;if("finish"===n)return"spaceFull"!==r||d||i.dialog("DecompressVip",Lr(!0)),100;if("failed"===n)throw{type:Mr,code:r};return Gr[n]?Gr[n]:void 0},successHandler:function(){i.message.success((0,r.GH)("mixins_desktop_txt4")),i.successHandler&&i.successHandler(t.path)},errorHandler:function(e){if(e.type===Mr)switch(e.code){case"passwordError":return void i.toastError((0,r.GH)("mixins_desktop_txt5"));case"fileTooLarge":return void i.alert((0,r.GH)("mixins_desktop_txt6"));default:return void i.toastError((0,r.GH)("mixins_desktop_txt7"))}i.toastErrorrive.put("/api/v3/groups/".concat(n,"/archives/").concat(o,"/extract"),m);case 11:h.run(),e.next=19;break;case 14:e.prev=14,e.t0=e.catch(8),h.stop(),"SpaceFull"===(_=e.t0.response.data&&e.t0.response.data.result)?(v=l.list.find((function(e){return e.id===p})),g=v&&"creator"===v.user_role,d||v&&!g?i.toastError(e.t0):setTimeout((function(){i.dialog("DecompressVip",Lr(!0))}),300)):"TaskAlreadyExists"===_?i.toastError((0,r.GH)("mixins_desktop_txt3")):"extractFileNoPermission"===_?setTimeout((functionSecretGroupPermissionDenied"===_?i.dialog("secretVipRenew",{back:!1,backprev:!1,okClose:!0,useNewLayout:i.state.ui.useNewLayout}):i.toastError(e.t0);case 19:case"end":return e.stop()}}),e,null,[[8,14]])})));return function(t){return e.apply(thise.prev=13,e.t0=e.catch(1);case 15:case"end":return e.stop()}}),e,null,[[1,13]])}))),Rr.apply(this,arguments)}var Br={mixins:[E.Z,G.default],props:{groupid:{type:Number},fileid:{type:Number},title:{type:String}},data:function(){return{loading:!0,achives:[]}},created:function(){var e=this;return(0,s.Z)(a().mark((functio;)switch(t.prev=t.next){case 0:return t.prev=0,i=e.groupid,r=e.fileid,t.next=4,N.drive.get("/api/v3/groups/".concat(i,"/archives/").concat(r,"/namelist"));case 4:n=t.sent,s=n.data,e.achives=s.namelist.map((function(e){return{name:e,ext:(0,l.getExtName)(e)}})),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0data&&"PasswordError"===t.t0.response.data.result?e._error(e.$t("file_achive_Index2")):e._error(e.$t("file_achive_Index3"));case 13:e.loading=!1;case 14:case"end":return t.stop()}}),t,null,[[0,9]])})))()},methods:{eventCancel:function(){this.$emit("close")},ev$store.state.user.privileges;this.powerConfig.get("checkUserExtractPerm")&&t&&!t.extract_online?this.dialog("DecompressVip",{back:!1,icon:"unzip",title:this.$t("file_achive_Index4"),tip:this.$t(t){Rr.apply(this,arguments)}({fileid:this.fileid,groupid:this.groupid},{ua:this.$ua,route:this.$route,state:this.$store.state,dialog:this.dialog,message:this.$message,toastError:this._error,alert:this.$alert,successHandler:function(){e.$store.commit(u._P6)}})}}},Ar=Br,jr=(0,y.Z)(Ar,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"achive"},[i("div",{staticClass:"achive-list"},[e.loading?i("div",{staticClass:"loading-box"},[i("loading")],1):e._l(e.achives,(function(t,r){return i("div",{key:r,staticClass:"achive-list-item"},[e.$ua.yun||e.$ua.wps18and19?i("KIcon",{staticClass:"achive-list-item-icon",attrs:{formatSize:16,type:e._f("yunIcon")(t.name,t.ext)}}):i("file-icon",{staticClass:"achive-list-item-icon",attrs:{type:e._f("icon")(t.name,t.ext)}}),i("span",{staticClass:"achive-list-item-name",attrs:{title:t.name}},[e._v(e._s(t.name))])],1)}))],2),i("div",{staticClass:"footer"},[i("el-button",{on:{click:e.evei),!0).forEach((function(t){(0,n.Z)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):zr(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPreturn e}var Kr={onentName:"SpaceFull",props:{type:{type:String,default:"MySpaceFull"},creator:{type:String,default:""}ult:""}},mixins:[E.Z,G.default],computed:qr(qr({},(0,Wr.rn)({user:function(e){return e.user}})),{},{btnStatus:function(){return!0},vipLevel:function(){var e=parseInt((0,c.get)(this.$store.state,"user.vip_level"));return e},payconfig:function(){return"svip"},limitSize:function(){var e=this.$store.state.user.privileges;return Vr.Z[this.vipLevel]&&Vr.Z[this.vipLevel].fsize?Vr.Z[this.vipLevel].fsize:e&&e.filesize_limit&&e.filesize_limit.total?e.filesize_limit.total+"M":0}}),methods:{submitForm:function(e){var t=this;return(0,s.Z)(a().mark((function i(){var r,n;return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!e){i.next=22;break}if(r=t.$ua.docs&&"1.0"!==t.$ua.docs.v,n=(0,ge.ob)()&&!r,!t.$ua.WPS&&!n){i.next=13;break}return i.prev=4,i.next=7,(0,ge.c6)(decodeURIComponent(t.vipLink()));case 7:return i.abrupt("return");case 10:i.prev=10,i.t0=i.catch(4),window.open("".concat(A.Y$,"/pay/member/20/?")+t.vipLink(),"_blank");case 13:if(!r){i.next=22;break}return i.prev=14,i.next=17,(0,Ur.h)(decodeURIComponent(t.vipLink()));case 17:return i.abrupt("return");case 20:i.prev=20,i.t1=i.catch(14);case 22:!t.$ua.wxpcmini&&t.$emit("close");case 23:case"end":return i.stop()}}),i,null,[[4,10],[14,20]])})))()},handleClose:function(){"sizeLimit"===this.type&&k.Z.onEvent("upload_sizelimit",{type:this.limitSize,action:"cancel"}),this.$emit("close")},vipLink:function(){var e=this.$ua.docs?"docs_pc":"docs_web",t="pc_kdocs_cloudspace";return"sizeLimit"===this.type?(t="pc_kdocs_accessory",k.Z.onEvent("upload_sizelimit",{type:this.limitSize,action:"upgrade"})):k.Z.onEvent("spacefull_clickvip",{type:"svip"===this.payconfig?"vip":"svip"}),"csource=".concat(t,"&payconfig=").concat(this.payconfig,"&position=").concat({upload:"upload",new:"newbuilt",savetoedit:"readonly",saveas:"saveas",recover:"recovery",copy:"copy",move:"move"}[this.source],"&component=").concat(e)}},directives:{focus:m.Z},mounted:function(){"sizeLimit"===this.type&&k.Z.onEvent("upload_sizelimit",{type:this.limitSize,action:"show"})}},Qr=Kr,Yr=(0,y.Z)(Qr,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"space-full-box"},[i("el-form",{ref:"space-full",attrs:{labelPosition:"top",prop:"name"},nativeOn:{submit:function(t){return t.preventDefault(),e.submitForm("gotoVip")}}},["MySpaceFull"===e.type?[i("div",{staticClass:"content"},[e._v(" "+e._s(e.$t("file_space_SpaceFull0"))+e._s("svip"===e.payconfig?"WPS"+e.$t("file_space_SpaceFull1"):e.$t("file_space_SpaceFull2"))+e._s(e.$t("file_space_SpaceFull3"))+" ")]),i("div",{staticClass:"footer"},[i("el-button",{on:{click:e.handleClose}},[e._v(e._s(e.$t("file_space_SpaceFull4")))]),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("gotoVip")}}},[e._v(e._s(e.$t("file_space_SpaceFull5")))])],1)]:"sizeLimit"===e.type?[i("div",{staticClass:"content"},[e._v(" "+e._s(e.limitSize?e.$t("file_space_SpaceFull6")+e.limitSize+e.$t("file_space_SpaceFull7"):"")+e._s("20"===e.vipLevel?e.$t("file_space_SpaceFull8"):e.$t("file_space_SpaceFull9"))+e._s(e.$t("file_space_SpaceFull10"))+"2GB"+e._s(e.$t("file_space_SpaceFull11"))+" ")]),i("div",{staticClass:"footer"},[i("el-button",{on:{click:e.handleClose}},[e._v(e._s(e.$t("file_space_SpaceFull4")))]),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("gotoVip")}}},[e._v(e._s("20"===e.vipLevel?e.$t("file_space_SpaceFull12"):e.$t("file_space_SpaceFull5")))])],1)]:"GroupOwnerSpaceFull"===e.type?[i("div",{staticClass:"content"},[i("div",{staticClass:"tip"},[e._v(e._s(e.$t("file_space_SpaceFull13")))]),i("div",{staticClass:"tip2"},[e._v(" "+e._s(e.$t("file_space_SpaceFull14"))),i("span",{staticClass:"name"},[e._v("「"+e._s(e.creator)+"」")]),e._v(e._s(e.$t("file_space_SpaceFull15"))+" ")])]),i("div",{staticClass:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm()}}},[e._v(e._s(e.$t("file_space_SpaceFull16")))])],1)]:e._e()],2)],1)}),[],!1,null,null,null).exports,Jr={name:"CorpSpaceFull",componentName:"CorpSpaceFull",components:{KCorpSpaceFull:function(){return i.e(950).then(i.bind(i,950))}},props:{cid:{type:Number,required:!0},groupid:{type:Number,required:!0},isAdmin:Boolean,adminName:String},methods:{handleClose:function(){this.$emit("close")}}},Xr=(0,y.Z)(Jr,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("KCorpSpaceFull",{attrs:{cid:e.cid,groupid:e.groupid,adminName:e.adminName,isAdmin:e.isAdmin},on:{close:e.handleClose}})}),[],!1,null,null,null).exports,en=i(70485),tn={id:0,name:"",creator:"",members:{},membersCount:0,role:"member",folderid:0},rn={name:"DriveDeleteSharefolder",mixins:[L.Z,R],props:{source:{type:Object,default:Object.assign({},tn)},onCommit:{type:Function,default:function(){return Promise.resolve(!unction(){return Object.assign({loading:!1,committing:!1,check:!1},tn)},computed:{disabled:function(){return"creator"===this.role&&!this.check},isCreator:function(){return"creator"===this.role},isManager:function(){return["admin","manager"].includes(this.role)},isShareFolder:function(){var e=this.source,t=e.folderid,i=e.isShareFolder,r=e.teamInfo;return!!t||i||r&&r.isShareFolder},isCorpTeam:function(){return this.source.corpid>0||this.source.origin&&this.source.origin.corpid>0},getNameStr:function(){return this.name?(0,$.cutOffString)(this.name,8,16):this.name}},created:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.prev=1,t.next=4,N.drive.get("/api/v3/groups/".concat(e.source.id),{params:{include:"recent_members"}});case 4:i=t.sent,r=i.data,e.name=r.name,e.role=r.user_role,e.creator=r.creator.name,e.members=r.recent_members||{},e.membersCount=r.member_count,t.next=17;break;case 13:t.prev=13,t.t0=t.catch(1),e._error(t.t0),e.$emit("close");case 17:e.loading=!1;case 18:case"end":return t.stop()}}),t,null,[[1,13]])})))()},methods:{handleClose:function(){this.$emit("close")},onCommitDelete:function(){var e=this;return(0,s.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.committing=!0,t.prev=1,t.next=4,e.onCommit(Object.assign({},e.source,{user_role:e.role}));case 4:e.handleClose(),"creator"===e.role&&e.isShareFolder&&e.$store.state.user.is_plus?e.deleteMessage():e.$message.success(e.isCreator?e.$t("file_team_RemoveTeamFolder7"):e.$t("file_team_RemoveTeamFolder8")),e.$store.dispatch(u.DJg),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),e._error(t.t0);case 12:e.committing=!1;case 13:case"end":return t.stop()}}),t,null,[[1,9]])})))()}}},nn=rn,sn=(0,y.Z)(nn,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.loading?i("Loading"):i("div",{staticClass:"drive-delete-sharefolder",attrs:{tabindex:"0"}},[i("p",{staticClass:"break-all",attrs:{tabindex:"0"}},[e._v(" "+e._s(e.isCreator?e.isShareFolder?e.$t("file_team_RemoveTeamFolder13"):e.$t("file_team_RemoveTeamFolder0"):e.$t("file_team_RemoveTeamFolder1"))+" "),i("b",{attrs:{title:e.name}},[e._v("「"+e._s(e.getNameStr)+"」")])]),e.isCreator?i("div",{staticClass:"creator-content"},[e.isShareFolder?i("p",[e._v(e._s(e.$t("file_team_RemoveTeamFolder9")))]):e.isCorpTeam?[i("p",[e._v(e._s(e.$t("file_team_RemoveTeamFolder10")))]),i("ul",{staticClass:"tips"},[i("li",[e._v(e._s(e.$t("file_team_RemoveTeamFolder21")))]),i("li",[e._v(e._s(e.$t("file_team_RemoveTeamFolder22")))])]),i("p",{staticClass:"danger"},[e._v(e._s(e.$t("file_team_RemoveTeamFolder23")))])]:[i("KTeamDeleteExitTransferTips",{attrs:{title:e.$t("file_team_RemoveTeamFolder10"),tipsList:[e.$t("file_team_RemoveTeamFolder14"),e.$t("file_team_RemoveTeamFolder15"),e.$t("file_team_RemoveTeamFolder24")],warning:e.$t("file_team_RemoveTeamFolder16")}})]],2):[e.isCorpTeam||e.isShareFolder?i("p",{staticClass:"not-creator-content",attrs:{tabindex:"0"}},[e._v(e._s(e.$t("file_team_RemoveTeamFolder3")))]):[i("KTeamDeleteExitTransferTips",{attrs:{title:e.$t("file_team_RemoveTeamFolder17"),tipsList:e.isManager?[e.$t("file_team_RemoveTeamFolder19"),e.$t("file_team_RemoveTeamFolder20")]:[e.$t("file_team_RemoveTeamFolder18")],warning:e.$t("file_team_RemoveTeamFolder16")}})]],i("div",{staticClass:"footer"},[i("kd-button",{attrs:{type:"secondary"},on:{click:e.handleClose}},[e._v(e._s(e.$t("file_team_RemoveTeamFolder4")))]),i("kd-button",{attrs:{type:"primary",danger:"",loading:e.committing},on:{click:e.onCommitDelete}},[e._v(" "+e._s(e.isCreator?e.isShareFolder?e.$t("file_team_RemoveTeamFolder12"):e.$t("file_team_RemoveTeamFolder5"):e.$t("file_team_RemoveTeamFolder6"))+" ")])],1)],2)}),[],!1,null,null,null).exports,on={id:0,name:"",creator:"",members:{},membersCount:0,role:"member"},an={name:"DriveCancelSharefolder",mixins:[L.Z,R],props:{source:{type:Object,validator:function(e){return!(!e.id||!~["admin","creator","read_member","manager","member"].indexOf(e.user_role))},default:Object.assign({},on)},onCommit:{type:Function,default:function(){return Promise.resolve(!0)}}},data:function(){return Object.assign({loading:!1,committing:!1,check:!1},on)},computed:{currentFolderInfo:function(){var e=this.$store.state.file.supFolderPaths||[];return(e=e.filter((function(e){return e}))).length?e[e.length-1]:null},avatarMemebers:function(){return this.members.filter((function(e,t){return t<4}))}},created:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.prev=1,t.next=4,N.drive.get("/api/v3/groups/".concat(e.source.id),{params:{include:"recent_members"}});case 4:i=t.sent,r=i.data,e.name=r.name,e.role=r.user_role,e.creator=r.creator.name,e.members=r.recent_members||{},e.membersCount=r.member_count,t.next=17;break;case 13:t.prev=13,t.t0=t.catch(1),e._error(t.t0),e.$emit("close");case 17:e.loading=!1;case 18:case"end":return t.stop()}}),t,null,[[1,13]])})))()},methods:{onClose:function(){this.$emit("close")},onConfirm:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r,s,o,c;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.committing=!0,t.prev=1,i=e.source.folderid||e.$store.state.team.current.fileid,t.next=5,N.drive.delete("/api/v5/groups/special/folders/".concat(i,"/share"));case 5:if(!((r=t.sent)&&r.data&&r.data.taskid)){t.next=9;break}return t.next=9,e.asyncMessage("cancelShare",e.source.id,r.data.taskid,!1);case 9:return s=e.$store.state.team.myCloud.id,t.next=12,N.drive.get("/api/v3/groups/".concat(s,"/files/").concat(i));case 12:o=t.sent,c=o.data,e.$emit("close"),e.onCommit(c),e.$message.success(e.$t("file_team_CancelTeam5")),e.$store.dispatch(u.xgE),["Sharing","Share"].includes(e.$route.name)?e.$store.commit(u.aFD,{ids:[e.source.id]}):e.$store.dispatch(u.W5F,e.source.id),e.$store.commit(u.NRF,(0,n.Z)({},"".concat(d.bg.folder).concat(i),{icon:"FolderFormatIcon",groupId:e.source.groupid,isShareFolder:!1})),e.$nextTick((function(){if(parseInt(e.source.id)===parseInt(e.$route.params.tid)){var t=e.currentFolderInfo;t&&(t.ftype="folder",t.id=t.folderid,delete t.folderid,delete t.linkgroupid,delete t.type,e.$store.commit(u.JJp,[t.id]),e.$store.commit(u.zLI,t)),e.$router.push({name:"Mine",params:{fid:i}})}})),t.next=26;break;case 23:t.prev=23,t.t0=t.catch(1),e._error(t.t0);case 26:e.committing=!1;case 27:case"end":return t.stop()}}),t,null,[[1,23]])})))()}}},cn=an,ln=(0,y.Z)(cn,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.loading?i("Loading"):i("div",{staticClass:"drive-cancel-sharefolder",attrs:{tabindex:"0"}},[i("p",{staticClass:"break-all",attrs:{tabindex:"0"}},[e._v(e._s(e.$t("file_team_CancelTeam0"))),i("b",[e._v("「"+e._s(e.name)+"」")])]),i("div",{staticClass:"creator-content"},[i("p",{attrs:{tabindex:"0"}},[e._v(e._s(e.$t("file_team_CancelTeam1")))]),i("div",[i("div",{staticClass:"avatars",class:"avatar"+e.members.length},[e._l(e.avatarMemebers,(function(e){return i("Avatar",{key:e.id,attrs:{size:"36",avatarSrc:e.avatar}})})),e.members.length>4?i("div",{staticClass:"avatar"},[i("Icon",{staticClass:"avatar-more",attrs:{type:"more"}})],1):e._e(),i("span",{staticClass:"members-num"},[e._v(e._s(e.membersCount)+e._s(e.$t("file_team_CancelTeam2")))])],2)])]),i("div",{staticClass:"footer"},[i("kd-button",{attrs:{type:"secondary"},on:{click:e.onClose}},[e._v(e._s(e.$t("file_team_CancelTeam3")))]),i("kd-button",{attrs:{type:"primary",danger:"",loading:e.committing},on:{click:e.onConfirm}},[e._v(e._s(e.$t("file_team_CancelTeam4")))])],1)])}),[],!1,null,null,null).exports,un=i(70735),dn=i.n(un),pn={name:"IconCircle",props:{onClick:{type:Function,default:function(){}},size:{type:String,default:"32"},customStyle:{type:Object,default:function(){return{}}},iconType:{type:String,default:"add"},iconSize:{type:String,default:"12"}},computed:{style:function(){var e=this.customStyle,t=this.size;return Object.assign(e,{width:"".concat(t,"px"),height:"".concat(t,"px")})}}},fn=(0,y.Z)(pn,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"icon-add",style:e.style,on:{click:e.onClick}},[i("Icon",{attrs:{type:e.iconType,size:e.iconSize+"px"}})],1)}),[],!1,null,"6d17ea84",null).exports,mn=i(34222),hn=i(79984),_n=i(71129),vn=i.n(_n),gn=i(47189);function yn(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function xn(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?yn(Object(i),!0).forEach((function(t){(0,n.Z)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):yn(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var bn={name:"CreateShareFolder",componentName:"CreateShareFolder",components:{IconCircle:fn,UikitMemberSelector:function(){return Promise.all([i.e(4430),i.e(5953)]).then(i.bind(i,95953))}},props:{folderType:{type:String,default:""},dwEntrance:{type:String,default:""}},data:function(){return{newFolder:{name:this.$t("file_new_ShareFolder6")},rules:{name:[{pattern:/^[^/\\;:*?"%&<>|]+$/,message:(0,c.exception)("illegalLinkFolderName"),trigger:"change"},{max:240,message:(0,c.exception)("fileNameLengthExceed"),trigger:"change"}]},loading:!1,gid:"",membersWillJoin:[],selecting:!1,category:"",placeholder:this.$t("file_new_ShareFolder1")}},mixins:[E.Z,G.default,hn.Z,mn.Z,Ot.Z],computed:xn(xn({},(0,Wr.rn)({user:function(e){return e.user},company:function(e){return e.company}})),{},{btnStatus:function(){return!(this.newFolder.name.trim().length>0)},members:function(){var e=this.user,t=e.avatar;return[{id:e.id,avatar:t,name:e.nickname}].concat(this.membersWillJoin).slice(0,5)},entrance:function(){return this.user.companyid?this.company?this.company.joinedCompanies.map((function(e){rme},e)})):{eType:"company"}:{eType:"contacts"}},pid:function(){return"0"},selectorProps:function(){var e=this,t=dn()(this.members,this.membersWillJoin,"id").filter((function(e){return e.userid=e.id,e})),i=this.membersWillJoin.filter((function(e){return e.userid=e.id,e})),r=[{type:"latest"},{type:"contact"}];return this.company.currentView.isEnt&&this.company.currentView.companyid?r.splice(1,0,{type:"company",comp_id:Number(this.company.currentView.companyid)}):this.ny"}),{_from:"kdocs",_function:"addMemberToShareFolder",sources:r,disableItems:t,defaultSelectedItems:i,canConfirmAlways:!0,onAddContactClick:this.toAdd,onPhoneLeanClick:this.toAdd,onCancel:function(){e.toggleSelect()},onConfirm:function(t){var i=t.items;e.onSelect(i)}}}}),methods:{submitForm:function(e){var t=this;return this.$refs[e].validate(function(){var e=(0,s.Z)(a().mark((function e(i){var r,n,s,o,c,l,d,p,f,m,h,_,v,g;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i){e.next=45;break}return e.prev=1,k.Z.onEvent("sharefolder_source",{action:t.members.length>1?"click_members":"click_member",source:t.dwEntrance}),t.loading=!0,r=t.$store.state,n=r.route,s=r.team,o=s.myCloud,c=t.gid,l=t.pid,("Auto"===n.name&&!c&&o||"Device"===n.name)&&(c=o.id),e.next=11,t.$store.dispatcmbersWillJoin.length>0)){e.next=31;break}return e.prev=15,m=d.linkmembersWillJoin});case 19:h=e.sent,_=h.failMsg,v=h.failList,_&&(p=_,g=v.filter((function(e){return-1!==["notCompanyMember","notCompanyUser"].indexOf(e.result)})).map((function(e){return e.userid})),f=t.membersWillJoin.filter((function(e){return-1!==g.indexOf(e.userid)})),console.log(f)),p?t.$message.error(p):(k.Z.onEvent("newfolder_success",{type:"linkfolder",linkgroupid:d.linkgroupid,folderid:d.folderid,groupid:d.groupid}),t.$message.success(t.$t("file_new_ShareFolder8")),t.loading=!1,t.$emit("close"),t.category&&t.addShareGroupCategory(d.linkgroupid,t.category,!0),t.$router.push({name:"Team",params:{tid:d.linkgroupid},query:{folderid:d.folderid}})),e.next=29;break;case 26:e.prev=26,e.t0=e.catch(15),console.error(e.t0);case 29:e.next=37;break;case 31:k.Z.onEvent("newfolder_success",{type:"linkfolder",linkgroupid:d.linkgroupid,folderid:d.folderid,groupid:d.groupid}),t.$message.success(t.$t("file_new_ShareFolder8")),t.loading=!1,t.$emit("close"),t.category&&t.addShareGroupCategory(d.linkgroupid,t.category,!0),t.$router.push({name:"Team",params:{tid:d.linkgroupid},query:{folderid:d.folderid}});case 37:e.next=43;break;case 39:e.prev=39,e.t1=e.catch(1),t.loading=!1,t._error(e.t1);case 43:e.next=46;break;case 45:return e.abrupt("return",!1);case 46:case"end":return e.stop()}}),e,null,[[1,39],[15,26]])})));return function(t){return e.apply(this,arguments)}}()),!1},handleClose:function(){this.$emit("close")},toggleSelect:function(){!vn().folderNeedBindPhone||this.$store.getters.userBindedPhone||this.selecting?this.selecting=!this.selecting:this.dialog("sharePhoneBind",{back:!1,backprev:!1,keeplive:!1})},onSelect:function(e){var t=this;this.membersWillJoin=e.filter((function(e){if(e.userid!==t.user.id)return e.id=e.userid,e})),this.toggleSelect()},setFolderInfo:function(){var e="",t="",i="";switch(this.folderType){case"createClassShareFolder":e=this.$t("file_new_ShareFolder_class"),t=this.$t("file_new_ShareFolder_placeholder_class"),i="class";break;case"createWorkShareFolder":e=this.$t("file_new_ShareFolder_work"),t=this.$t("file_new_ShareFolder_placeholder_work"),i="work";break;case"createNormalShareFolder":e=this.$t("file_new_ShareFolder_normal"),t=this.$t("file_new_ShareFolder_placeholder_normal"),i="";break;case"createShareFolder":return}this.newFolder.name=e,this.placeholder=t,this.category=i}},mounted:function(){k.Z.onEvent("sharefolder_source",{action:"show",source:this.dwEntrance}),this.setFolderInfo()},directives:{focus:m.Z},watch:{selecting:function(e){e?this.$emit("propsChange",{size:"large"}):this.$emit("propsChange",{size:""})}}},kn=bn,wn=(0,y.Z)(kn,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.selecting?e.user.is_plus?i("div",[i("UikitMemberSelector",{attrs:{selectorProps:e.selectorProps}})],1):e._e():i("div",[i("div",{staticClass:"new-share-folder-box"},[i("el-form",{ref:"newFolder",attrs:{model:e.newFolder,labelPosition:"top",prop:"name",rules:e.rules},nativeOn:{submit:function(t){return t.preventDefault(),e.submitForm("newFolder")}}},[i("el-form-item",{attrs:{prop:"name",label:e.$t("file_new_ShareFolder0")}},[i("el-input",{directives:[{name:"focus",rawName:"v-focus"},{name:"pad-focus",rawName:"v-pad-focus"}],attrs:{placeholder:e.placeholder,disabled:e.loading},model:{value:e.newFolder.name,callback:function(t){e.$set(e.newFolder,"name",t)},expression:"newFolder.name"}})],1),i("div",{staticClass:"creatShareFolder-split"}),i("div",{staticClass:"creatShareFolder-invite"},[i("p",{staticClass:"pre-title"},[e._v(e._s(e.$t("file_new_ShareFolder2")))]),i("div",{staticClass:"creatShareFolder-invite-members"},[i("IconCircle",{attrs:{onClick:e.toggleSelect}}),e._l(e.members,(function(t){return i("Avatar",{key:t.id,attrs:{avatarSrc:t.avatar,size:"32",customStyle:{margin:0,cursor:"pointer"}},nativeOn:{click:function(t){return e.toggleSelect.apply(null,arguments)}}})})),e.membersWillJoin.length>4?i("IconCircle",{staticClass:"avatar-marginRight",attrs:{iconType:"more",iconSize:"13",onClick:e.toggleSelect}}):e._e(),i("p",[e._v(e._s(""+(e.membersWillJoin.length+1))+e._s(e.$t("file_new_ShareFolder3")))])],2)]),i("div",{staticClass:"footer"},[i("el-button",{on:{click:e.handleClose}},[e._v(e._s(e.$t("file_new_ShareFolder4")))]),i("el-button",{attrs:{type:"primary",disabled:e.btnStatus,loading:e.loading},on:{click:function(t){return e.submitForm("newFolder")}}},[e._v(e._s(e.$t("file_new_ShareFolder5")))])],1)],1)],1)])}),[],!1,null,null,null),$n=wn.exports,Cn=i(42313),Sn={name:"DriveDeleteSharefolder",props:{gid:{type:Number,default:NaN}},methods:{handleClose:function(){this.$emit("close")},onCommitDelete:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r,n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=e.gid,t.next=4,N.drive.delete("/api/v5/links/share_groups",{data:{share_group_id:i||0}});case 4:if(r=t.sent,n=r.data,e.$emit("close"),"ok"!==n.result){t.next=13;break}return e.$message.success(e.$t("file_cooperation_removeCooperation3")),t.next=11,e.$store.dispatch(u.V9B);case 11:t.next=14;break;case 13:e._error(n.msg);case 14:t.next=21;break;case 16:t.prev=16,t.t0=t.catch(0),console.log("e"),e.$emit("close"),e._error(t.t0);case 21:case"end":return t.stop()}}),t,null,[[0,16]])})))()}}},Fn=Sn,Tn=(0,y.Z)(Fn,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"drive-delete-sharefolder",attrs:{tabindex:"0"}},[i("p",{attrs:{tabindex:"0"}},[e._v(e._s(e.$t("file_cooperation_removeCooperation0")))]),i("div",{staticClass:"footer"},[i("el-button",{on:{click:e.handleClose}},[e._v(e._s(e.$t("file_cooperation_removeCooperation1")))]),i("el-button",{attrs:{type:"danger"},on:{click:e.onCommitDelete}},[e._v(e._s(e.$t("file_cooperation_removeCooperation2")))])],1)])}),[],!1,null,null,null).exports,Pn={props:["onSuccess","msg"],methods:{confirm:function(){this.onSuccess(),this.$emit("close")}}},Nn=(0,y.Z)(Pn,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",[e._v(e._s(e.msg))]),i("footer",[i("el-button",{on:{click:function(t){return e.$emit("close")}}},[e._v(e._s(e.$t("file_saveas_ReplaceTips0")))]),i("el-button",{attrs:{type:"danger"},on:{click:e.confirm}},[e._v(e._s(e.$t("file_saveas_ReplaceTips1")))])],1)])}),[],!1,null,"7b32284f",null).exports,En={name:"ImportFileTips",props:{onOpenSelector:{type:Function,required:!0}},methods:{onClose:function(){this.$emit("close")},onOpen:function(){this.onOpenSelector(),k.Z.onEvent("myspace_import_description_click",{company_id:this.$route.params.cid,account_id:this.$store.state.user.id+"",action:"choose_file"})}}},In=(0,y.Z)(En,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"dialog-import-file-tips"},[i("div",{staticClass:"import-tips"},[e._v(" "+e._s(e.$t("file_team_importTips0"))),i("span",[e._v(e._s(e.$t("file_team_importTips1")))])]),i("div",{staticClass:"footer"},[i("el-button",{on:{click:e.onClose}},[e._v(e._s(e.$t("file_team_importTips3")))]),i("el-button",{staticClass:"import-file",attrs:{type:"primary"},on:{click:e.onOpen}},[e._v(e._s(e.$t("file_team_importTips2")))])],1)])}),[],!1,null,"1f334fa9",null).exports,Dn={name:"SecureTeam",props:{onSecureCallback:{type:Function,default:function(){}},isTeamCreator:{type:Boolean,default:!0},actionType:{type:String,default:"copy"}},data:function(){return{radio:"1",btnText:this.$t("dialog_file_SecureTeam10"),text:""}},created:function(){this.btnText={copy:this.isTeamCreator?this.$t("dialog_file_SecureTeam11"):this.$t("dialog_file_SecureTeam12"),move:this.$t("dialog_file_SecureTeam13"),saveas:this.$t("dialog_file_SecureTeam14")}[this.actionType],this.text={copy:this.$t("dialog_file_SecureTeam12"),move:this.$t("dialog_file_SecureTeam13"),saveas:this.$t("dialog_file_SecureTeam14")}[this.actionType],this.$emit("propsChange",{title:this.isTeamCreator?this.$t("dialog_file_SecureTeam15"):"".concat(this.text).concat(this.$t("dialog_file_SecureTeam16"))})},methods:{cancel:function(){this.$emit("close")},submit:function(){this.onSecureCallback(!!this.isTeamCreator&&this.radio),this.cancel()}}},Zn=(0,y.Z)(Dn,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"secure-team-dialog"},[e.isTeamCreator?i("div",[i("p",{staticClass:"secure-team-dialog-tips"},[e._v(e._s(e.$t("dialog_file_SecureTeam0"))+e._s(e.text)+e._s(e.$t("dialog_file_SecureTeam1")))]),i("div",{staticClass:"secure-item first"},[i("el-radio",{attrs:{label:"1"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(e._s(e.$t("dialog_file_SecureTeam2"))+" "),i("el-popover",{attrs:{placement:"top",title:"",visibleArrow:!1,trigger:"hover",popperClass:"secure-team-popover",content:e.$t("dialog_file_SecureTeam3")}},[i("Icon",{staticClass:"question-icon",attrs:{slot:"reference",type:"question",size:"16px"},slot:"reference"})],1)],1),i("p",[e._v(e._s(e.$t("dialog_file_SecureTeam4")))])],1),i("div",{staticClass:"secure-item"},[i("el-radio",{attrs:{label:"0"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(e._s(e.$t("dialog_file_SecureTeam5")))]),i("p",[e._v(e._s(e.$t("dialog_file_SecureTeam6")))])],1)]):i("div",[i("p",[e._v(e._s(e.$t("dialog_file_SecureTeam7"))+"，"+e._s(e.text)+e._s(e.$t("dialog_file_SecureTeam8"))+e._s(e.text))])]),i("div",{staticClass:"footer"},[i("el-button",{on:{click:e.cancel}},[e._v(e._s(e.$t("dialog_file_SecureTeam9")))]),i("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v(e._s(e.btnText))])],1)])}),[],!1,null,null,null).exports,Hn={props:{msg:{type:String},onSave:{type:Function}},methods:{confirm:function(){k.Z.onEvent("mobanpush_pcsaveas",{source:"list",action:"click"}),this.onSave()},onCancel:function(){k.Z.onEvent("mobanpush_pcsaveas",{source:"list",action:"close"}),this.$emit("close")}}},On=(0,y.Z)(Hn,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",[e._v(e._s(e.msg))]),i("footer",[i("el-button",{on:{click:e.onCancel}},[e._v(e._s(e.$t("components_dialog_Index0")))]),i("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v(e._s(e.$t("components_dialog_saveas")))])],1)])}),[],!1,null,"e5ffe15e",null).exports,Ln={data:function(){return{notShowToday:!1}},props:{corpid:{type:String,defauln(){return Promise.resolve(!0)}}},methods:{handleGoTeamAuth:function(){var e=encodeURIComponent(location.href);location.href="".concat(A.V1,"/web/auth?returnURI=").concat(e,"&compid=").concat(this.corpid)},handleChange:function(){this.onCheckboxChange(this.notShowToday)}}},Gn=(0,y.Z)(Ln,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"team-auth"},[i("div",{staticClass:"logo"}),i("div",{staticClass:"title"},[e._v(e._s(e.$t("title")))]),i("div",[e._v(e._s(e.$t("dialogContent")))]),i("div",{staticClass:"checkbox-wrap"},[i("el-checkbox",{on:{change:e.handleChange},model:{value:e.notShowToday,callback:function(t){e.notShowToday=t},expression:"notShowToday"}},[e._v(e._s(e.$t("dialogCheckboxLabel")))])],1),i("el-button",{attrs:{type:"primary"},on:{click:e.handleGoTeamAuth}},[e._v(e._s(e.$t("dialogConfirmText")))])],1)}),[],!1,null,null,null).exports,Mn={name:"DriveCoverFiles",componentName:"DriveCoverFiles",components:{vueAbbr:fi.Z},mixins:[E.Z],props:{fname:{type:String},showRetain:{type:Boolean,default:!0},onRetain:{type:Function,default:function(){return Promise.resolve(!0)}},onCommit:{type:Function,default:function(){return Promise.resolve(!0)}},onClose:{type:Function,default:function(){return Promise.resolve(!0)}}},data:function(){return{loading:!1}},created:function(){var e=this;this.$on("ok",(0,s.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.okHander();case 2:case"end":return t.stop()}}),t)})))),this.$on("close",(function(t){e.closeHander(t)}))},methods:{closeHander:function(){var e=this;this.dispatch("DriveDialog","close"),this.$nextTick((function(){e.onClose()}))},okHander:function(){var e=this;return(0,s.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.onCommit();case 2:e.hideDialog("coverFile");case 3:case"end":return t.stop()}}),t)})))()},onRetainFiles:function(){var e=this;return(0,s.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.onRetain();case 2:e.hideDialog("coverFile");case 3:case"end":return t.stop()}}),t)})))()},subFileName:l.subFileName}},Rn=Mn,Bn=(0,y.Z)(Rn,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"drive-cover-files"},[i("p",{staticClass:"cover-file-title"},[i("span",[e._v(e._s(e.$t("cover_simple_name_cover_exist")))]),i("span",{staticClass:"cover-file-name",attrs:{title:e._f("subFileName")(e.fname)}},[e._v(" 「 "),i("vue-abbr",{attrs:{text:e._f("subFileName")(e.fname)}}),e._v(" 」 ")],1),i("span",[e._v(e._s(e.$t("cover_simple_name_cover_confirm")))])]),i("p",{staticClass:"recover-file-title"},[e._v(" "+e._s(e.$t("cover_simple_name_recover_title"))+" ")]),i("div",{staticClass:"footer cover-footer"},[i("kd-button",{attrs:{type:"secondary"},on:{click:function(t){return e.$emit("close","cancel")}}},[e._v(e._s(e.$t("cover_simple_name_cancel")))]),i("kd-button",{directives:[{name:"show",rawName:"v-show",value:e.showRetain,expression:"showRetain"}],attrs:{type:"secondary"},on:{click:e.onRetainFiles}},[e._v(e._s(e.$t("cover_simple_name_retain_file_v2")))]),i("kd-button",{attrs:{type:"primary"},on:{click:function(t){return e.$emit("ok")}}},[e._v(e._s(e.$t("cover_simple_name_cover")))])],1)])}),[],!1,null,null,null).exports,An={name:"CoverFileAll",componentName:ps:{nums:{type:Number},onConfirm:{type:Function,default:function(){return Promise.resolve(!0)}},onCommit:{type:Function,default:function(){return Promise.resolve(!0)}},onClose:{type:Function,default:function(){return Promise.resolve(!0)}}},data:function(){return{loading:!1}},created:fr(;;)switch(t.prev=t.next){case 0:return t.next=2,e.okHander();case 2:case"end":return t.stop()}}),t)})))),this.$on("close",(function(t){e.closeHander(t)}))},methods:{closeHander:function(){var e=this;this.hideDialog("coverFileAll"),this.$nextTick((function(){e.onClose()}))},okHander:function(){var e=this;return(0,s.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.onCommit();case 3:t.next=7;break;case 5:t.prev=5,t.t0=t.catch(0);case 7:e.hideDialog("coverFileAll");case 8:case"end":return t.stop()}}),t,null,[[0,5]])})))()},onRetainFiles:function(){var e=this;return(0,s.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.onConfirm();case 3:t.next=7;break;case 5:t.prev=5,t.t0=t.catch(0);case 7:e.hideDialog("coverFileAll");case 8:case"end":return t.stop()}}),t,null,[[0,5]])})))()}}},jn=An,Wn=(0,y.Z)(jn,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"drive-cover-files"},[i("p",{staticClass:"cover-file-title"},[i("span",[e._v_context",{nums:e.nums})))])]),i("div",{staticClass:"footer cover-footer"},[i("a",{staticClass:"retain-files",on:{click:e.onRetainFiles}},[e._v(e._s(e.$t("cover_multiple_simple_name_recover_decision")))]),i("el-button",{on:{click:function(t){return e.$emit("close","cancel")}}},[e._v(e._s(e.$t("cover_multiple_simple_name_cancel_all")))]),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.$emit("ok")}}},[e._v(e._s(e.$t("cover_multiple_simple).exports,Vn=i(81539),Un={name:"DriveMoveFailList",componentName:"DriveMoveFailList",props:{failList:{type:Array,default:function(){return[]}},anotherUserId:{type:[Number,String]},anotherComapnyId:{type:[Number,String]}},data:function(){return{fullPathMap:{},pathMetaMap:{}}},created:function(){this.getFullPath()},methods:{fileType:function(e){try{var t=e.type,i=e.ftype,r=e.name,n=e.fname;return i||t||!(0,l.isShortcutFileByName)(r||n)?i||t:"link"}catch(e){}},fileName:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,i=e.fname,r=e.ftype,n=e.type,s=Wt()(this.$store,"state.file.listShowSettings.extension"),o=i||t,a=(0,l.getExtName)(o,r),c=this.fileType(e);return"link"===c&&(o=(0,l.subFileName)(o,r||n),a=(0,l.getExtName)(o,"file")),s&&!vr.UI.includes(a)?o:(0,l.subFileName)(o,r||n)},getFullPath:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r,n,s,o,c,l,d,p,f,m;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=0;case 1:if(!(i<e.failList.length)){t.next=28;break}if(r=e.failList[i],n=r.id,s=r.fileid,o=r.groupid,(c=r.path)!==Vn.Xn){t.next=7;break}e.fullPathMap[s||n]=Vn.eV,t.next=25;break;case 7:return l="",t.prev=8,t.next=11,e.$store.dispatch(u.RdS,{fileid:s||n,groupid:o,anotherUserId:e.anotherUserId,anotherComapnyId:e.anotherComapnyId});case 11:d=t.sent,p=d.path,f=d.groupName,m=d.corpName,e.pathMetaMap[s]={groupName:f,corpName:m},l=p,t.next=22;break;case 19:t.prev=19,t.t0=t.catch(8),l=c;case 22:return t.prev=22,e.$set(e.fullPathMap,s,l),t.finish(22);case 25:i++,t.next=1;break;case 28:case"end":return t.stop()}}),t,null,[[8,19,22,25]])})))()},shortPath:function(e){var t=this.filePath(e);if(!t&&this.pathMetaMap[e.fileid||e.id]){var i=new RegExp("".concat((0,r.GH)("file_mixins_yunitem13"),"|").concat((0,r.GH)("file_mixins_yunitem12"))),n=this.pathMetaMap[e.fileid||e.id],s=n.groupName;t=n.corpName?s:s.replace(i,(0,r.GH)("file_mixins_yunitem10"))}return t},filePath:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.path,i=e.app_type,n=e.file_src,s=e.file_src_type,o=e.original_device_type,a=e.original_device_name,c=e.roaming_info;if(c)return c.path?(0,l.pathtxt)(c.path):(0,r.GH)("file_mixins_yunitem9");if(~["normal","corpnormal"].indexOf(e.type)&&"member"===e.role||"group"===e.source)return"kdocs"===e.groupSource?(0,r.GH)("file_mixins_yunitem_personteam"):"corpnormal"===e.type?(0,r.GH)("file_mixins_yunitem_corpteam"):(0,r.GH)("file_mixins_yunitem_sharefolder");if("normal"===e.type)return(0,r.GH)("file_mixins_yunitem10");if(n===Vn.P7||n===Vn.O6)return(0,r.GH)("file_mixins_yunitem_share2me");var u=(0,l.catalogtxt)(n,s,o,t,a,"yun",i);return n&&["group","normal","private"].includes(s)||n&&"roaming"===s&&["android","iOS","PC"].includes(o)&&["QQ","微信"].includes(u)?u:""},isSharefile:function(e){var t=e.ftype,i=void 0===tfile_mixins_yunitem1"),u=new RegExp(c),d=new RegExp(l);return!!e&&(("sharefile"===i||n)&&(u.test(s)||d.test(s))||o||a)},isMine:function(e){return"private"===e.file_src_type},isFromEntSpace:function(e){return["corpnormal","corpspecial","corpdep","corptmp"].includes(e.group_type)},latestDecsIconType:function(e){var t=e.file_src_type,i=e.group_type;if(!t&&!i)return"";return this.isSharefile(e)?"share-selected":this.isFromEntSpace(e)?"enterprise":this.isMine(e)?"all-s":"team-selected"}}},zn=Un,qn=(0,y.Z)(zn,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"drive-move-fail-list-body"},[i("ul",{staticClass:"list-wrap"},e._l(e.failList,(function(t){return i("li",{key:t.fileid,staticClass:"item"},[i("KIcon",{staticClass:"file-icon",attrs:{type:e._f("yunIcon")(t.name,e.fileType(t))}}),i("div",{staticClass:"file-info"},[i("p",{staticClass:"name",attrs:{title:e.fileName(t)}},[e._v(e._s(e.fileName(t)))]),i("p",{staticClass:"path",attrs:{title:e.fullPathMap[t.fileid]}},[e.latestDecsIconType(t)?i("span",{staticClass:"path-icon"},[i("icon",{attrs:{type:e.latestDecsIconType(t)}})],1):e._e(),i("span",[e._v(e._s(e.shortPath(t)))])])]),i("span",{staticClass:"reason"},[e._v(e._s(["batch_contains_program_file"].includes(t.result)?t.msg:t.failMsg))]),i("img",{staticClass:"icon",attrs:{src:e.$cdn+"/kdocs/cloud/icon/move_file_error.svg",alt:""}})],1)})),0)])}),[],!1,null,null,null),Kn=qn.exports,Qn={name:"DialogUnDecompress",componentName:"DialogUnDecompress",mixins:[G.default],props:{source:{type:Object,default:function(){return{}}}},computed:{ext:function(){var e=this.source,t=e.fname,i=e.name;return(0,l.getExtName)(t||i)}},mounted:function(){var e=this;this.$on("ok",(0,s.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,Ti.gC)(e.source,{state:e.$store.state,message:e.$message,dialog:e.dialog,createElement:e.$createElement,toastError:e._error,ua:e.$ua});case 2:e.$emit("close");case 3:case"end":return$createElement,i=e._self._c||t;retur+e._s(e.$t("file_achive_unsupport",{ext:e.ext}))+" ")])])}),[],!1,null,null,null).exports,Xn={data:function(){return{changedSource:"",radioValue:null,isTeamCreator:!1}},name:"FileMove",components:{KFinder:function(){return Promise.all([i.e(436),i.e(1319)]).then(i.bind(i,61974))}},mixins:[E.Z,w.Z,D.Z],props:{isMulti:{type:Boolean,default:!1},disableFileType:{type:Object,default:function(){return{}}},limitedTabs:{type:Array,default:function(){return[]}},limitedCompany:{type:Object,default:function(){return{}}},onCommit:{type:Function,default:function(){return Promise.resolve(!0)}},secretLocked:Boolean,actionType:String,hideSecretFolder:Boolean,ignoreWritePermission:Boolean,okText:String,isSelectFile:Boolean,canSelectFolder:Boolean,limitedExtArr:{type:Array,default:function(){return[]}},showNew:{type:Boolean,default:!0},showRename:{type:Boolean,default:!1},sendShareLink:Boolean,initSource:Object,secureParams:Object,sourceFiles:Array,dwFinder:Object},computed:{currentCompany:function(){return this.$store.state.company&&this.$store.state.company.current||this.$store.state.company.currentView||{}},source:function(){var e=this.changedSource||this.initSource||{},t=e.routeName;if(!this.powerConfig.get("UIFinderMyDocs")&&(void 0===t||"All"===t)&&this.currentCompany.id||this.currentCompany.companyid){var i=this.$route.params.cid||this.currentCompany.id||this.currentCompany.companyid;e={routeName:"Enterprise",name:this.currentCompany.name||this.currentCompany.companyname,corpid:Number(i)}}return e},secretFolderID:function(){return Number(this.$store.state.team.mySecret.id||0)},isSecretExpired:function(){var e=this.$store.state.user;return this.secretFolderID&&!(e.privileges&&e.privileges.secret_folder)}},methods:{onNewFolder:function(){["copy","move","saveas"].includes(this.actionType)&&k.Z.onEvent("choose_position",{type:"saveas"===this.actionType?"save":this.actionType,action:"creat_folder"})},onClose:function(){this.$emit("close")},onEnterPassword:function(){var e=this;this.isSecretExpired?this.dialog("secretVipRenew",{back:!1,useNewLayout:this.$store.state.ui.useNewLayout}):this.secretFolderID?this.dialog("unlockSecret",{changeLock:function(t){t||(e.changedSource={routeName:"Secret"})},backprev:!0}):this.dialog("secretRegister",{back:!1})},needSecure:function(e){var t=this;return(0,s.Z)(a().mark((function i(){var r;return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!(t.secureParams&&+t.secureParams.groupid!=+e.groupid||"All"===e.routeName)){i.next=13;break}return i.prev=1,i.next=4,N.drive.get("/api/v5/groups/".concat(t.secureParams.groupid,"/files/secure"),{params:{fileids:t.secureParams.fileids.join(",")}});case 4:if(r=i.sent,!(r.data.data.length>0)){i.next=8;break}return i.abrupt("return",!0);case 8:i.next=13;break;case 10:return i.prev=10,i.t0=i.catch(1),i.abrupt("return",!1);case 13:return i.abrupt("return",!1);case 14:case"end":return i.stop()}}),i,null,[[1,10]])})))()},secureInfo:function(e){return(0,s.Z)(a().mark((function t(){var i,r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,N.drive.get("/api/v5/groups/".concat(e,"/secure"));case 3:return i=t.sent,r=i.data,t.abrupt("return",r);case 8:return t.prev=8,t.t0=t.catch(0),t.abrupt("return",!1);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},onSubmit:function(e){var t=this;return(0,s.Z)(a().mark((function i(){var r,n,o,c,l;return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(r=Date.now(),"move"!==t.actionType&&"copy"!==t.actionType||t.$emit("close","ok"),n=function(){var e=(0,s.Z)(a().mark((function e(i,r){var n,s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.onCommit(i,t.actionType,r);case 3:i.extraData&&void 0!==i.extraData.duplicated_name_model&&delete i.extraData.duplicated_name_model,"move"===t.actionType&&"copy"===t.actionType||t.$emit("close","ok"),e.next=30;break;case 7:if(e.prev=7,e.t0=e.catch(0),e.t0.response&&e.t0.response.data&&(e.t0.response.data.cid=Array.isArray(i)?i&&i[0].corpid:i&&i.corpid,e.t0.response.data.groupid=Array.isArray(i)?i&&i[0].groupid:i&&i.groupid),n=e.t0.response&&e.t0.response.data||{},s=n.result,o=n.msg,"fileNameDuplicated"!==s){e.next=13;break}return e.abrupt("return",t.dialog("replaceTips",{msg:o,onSuccess:function(){i.extraData?i.extraData.duplicated_name_model=2:i.paramsextraData={duplicated_name_model:2},t.onSubmit(i)},backprev:"move"!==t.actionType}));case 13:if(!e.t0.response||!e.t0.response.data){e.next=26;break}e.t1=t.actionType,e.next="copy"===e.t1?17:"moveto"===e.t1?20:"saveas"===e.t1?23:26;break;case 17:return e.t0.response.data.full_position="spacelimit_copy",e.t0.response.data.full_component="web_clouddoc_rightlist",e.abrupt("break",26);case 20:return e.t0.response.data.full_position="spacelimit_move",e.t0.response.data.full_component="web_clouddoc_rightlist",e.abrupt("break",26);case 23:return e.t0.response.data.full_position="spacelimit_saveas",e.t0.response.data.full_component="web_clouddoc_rightlist",e.abrupt("break",26);case 26:if("SecretGroupPermissionDenied"!==s){e.next=28;break}return e.abrupt("return",t.dialog("secretVipRenew",{useNewLayout:t.$store.state.ui.useNewLayout}));case 28:return e.next=30,t.handleSpaceFull(e.t0);case 30:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,i){return e.apply(this,arguments)}}(),["copy","move","saveas"].includes(t.actionType)&&k.Z.onEvent("choose_position",{type:"saveas"===t.actionType?"save":t.actionType,action:"confirm"}),o=!1,!(t.secureParams&&t.secureParams.secure||"saveas"===t.actionType)){i.next=9;break}return i.next=8,t.needSecure(e);case 8:o=i.sent;case 9:if(c=!1,o||!t.secureParams||+t.secureParams.groupid==+e.groupid){i.next=15;break}return i.next=13,t.secureInfo(t.secureParams.groupid);case 13:(c=i.sent)&&0===parseInt(c.init_decode_status)&&(o=!0);case 15:if(l=!t.secureParams||+e.groupid===(t.secureParams&&t.secureParams.groupid),t.secureParams&&t.secureParams.secure&&t.secureParams.hasFolder&&!l&&(o=!0),!o){i.next=21;break}t.dialog("$$DialogSecureTeamConfirm",{ifSwitchBtnGroup:!0,groupid:t.secureParams.groupid,onSubmit:function(){var t=(0,s.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n(e,!0);case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),backprev:"move"!==t.actionType}),i.next=23;break;case 21:return i.next=23,n(e);case 23:["copy","move","saveas"].includes(t.actionType)&&t.dwFinder&&k.Z.onEvent("fileselect_execute",{type:t.dwFinder.type,time:Date.now()-r,number:t.dwFinder.number});case 24:case"end":return i.stop()}}),i)})))()}},mounted:function(){["copy","move","saveas"].includes(this.actionType)&&(this.dwFinder&&k.Z.onEvent("fileselect_request",{type:this.dwFinder.type,position:this.dwFinder.position,time:Date.now()-this.dwFinder.handleStartTime}),k.Z.onEvent("choose_position",{type:"saveas"===this.actionType?"save":this.actionType,action:"show"}))}},es=Xn,ts=(0,y.Z)(es,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("KFinder",{attrs:{showToast:!0,secretFolderID:e.secretFolderID,showNew:e.showNew,showRename:e.showRename,secretLocked:e.secretLocked,actionType:e.actionType,hideSecretFolder:e.hideSecretFolder,ignoreWritePermission:e.ignoreWritePermission,okText:e.okText,isMulti:e.isMulti,disableFileType:e.disableFileType,isSelectFile:e.isSelectFile,canSelectFolder:e.canSelectFolder,limitedExtArr:e.limitedExtArr,sendShareLink:e.sendShareLink,initSource:e.source,limitedTabs:e.limitedTabs,limitedCompany:e.limitedCompany,sourceFiles:e.sourceFiles,initUser:e.$store.state.user,initCloud:e.$store.state.team.myCloud,initUpload:e.$store.state.team.myUpload},on:{onEnterPassword:e.onEnterPassword,onClose:e.onClose,onSubmit:e.onSubmit,onNewFolder:e.onNewFolder}})}),[],!1,null,null,null).exports,is=i(16473),rs=i.n(is),ns={mixins:[E.Z,w.Z],name:"FileSelector",props:{action:{type:String,default:null},path:{type:Object,default:function(){return{}}},featrues:{type:Object,default:function(){return{}}},file:{type:Object,default:function(){return{}}},tabs:{type:Object,default:function(){return{}}},dw:{type:Object,default:function(){return{}}},okText:{type:String},cancelText:{type:String},actionType:{type:String,default:null},onFinderConfirm:{type:Function,default:function(){return Promise.resolve(!0)}},dwFinder:{type:Object},secureParams:{type:Object},showDefaultError:{type:Boolean,default:!1}},data:function(){return{component:null}},computed:{combineTabs:function(){return Object.assign({},this.tabs,{texts:this.$ua.wpsCloudDocumentEmbed?{EnterpriseIndex:UD"),EnterpriseTeams:(0,r.GH)("constant_PERSON_TEAMS_WPS_CLOUD")}:{}})}},mounted:function(){var e=this;Promise.all([i.e(7255),i.e(5835),i.e(6704),i.e(1626),i.e(2307),i.e(9765),i.e(6861),i.e(436),i.e(1648),i.e(3913)]).then(i.bind(i,21710)).then((function(t){e.component=t.default})),["copy","move","saveas"].includes(this.actionType)&&(this.dwFinder&&k.Z.onEvent("fileselect_request",{type:this.dwFinder.type,position:this.dwFinder.position,time:Date.now()-this.dwFinder.handleStartTime}),k.Z.onEvent("choose_position",{type:"saveas"===this.actionType?"save":this.actionType,action:"show"}))},methods:{needSecure:function(e){var t=this;return(0,s.Z)(a().mark((function i(){var r,n;return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(r=e.groupid,!(t.secureParams&&+t.secureParams.groupid!=+r||"All"===e.routeName)){i.next=14;break}return i.prev=2,i.next=5,N.drive.get("/api/v5/groups/".concat(t.secureParams.groupid,"/files/secure"),{params:{fileids:t.secureParams.fileids.join(",")}});case 5:if(n=i.sent,!(n.data.data.length>0)){i.next=9;break}return i.abrupt("return",!0);case 9:i.next=14;break;case 11:return i.prev=11,i.t0=i.catch(2),i.abrupt("return",!1);case 14:return i.abrupt("return",!1);case 15:case"end":return i.stop()}}),i,null,[[2,11]])})))()},secureInfo:function(e){return(0,s.Z)(a().mark((function t(){var i,r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,N.drive.get("/api/v5/groups/".concat(e,"/secure"));case 3:return i=t.sent,r=i.data,t.abrupt("return",r);case 8:return t.prev=8,t.t0=t.catch(0),t.abrupt("return",!1);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},checkTeamCreator:function(e){return(0,s.Z)(a().mark((function t(){var i,r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,N.drive.get("/api/v5/groups/".concat(e,"/members/check/owner"));case 3:return i=t.sent,r=i.data,t.abrupt("return",r);case 8:return t.prev=8,t.t0=t.catch(0),t.abrupt("return",!1);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},fetchTeamMembersByRoles:function(e,t){return(0,s.Z)(a().mark((function i(){var r,n;return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,N.drive.get("/api/v3/groups/".concat(e,"/role_members"),{params:t});case 2:return r=i.sent,n=r.data.members,i.abrupt("return",n);case 5:case"end":return i.stop()}}),i)})))()},isValidRolePermission:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,n,s;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.checkTeamCreator(e.secureParams.groupid);case 3:if(n=t.sent,!((null==n?void 0:n.result)||!1)){t.next=7;break}return t.abrupt("return",!0);case 7:return t.next=9,e.fetchTeamMembersByRoles(e.secureParams.groupid,{role:"creator"});case 9:if(t.t0=t.sent,t.t0){t.next=12;break}t.t0=[];case 12:return s=t.t0,rs()({type:"warning",message:(0,r.GH)("yun_views_crypt_docs_roleTip",[(null==s||null===(i=s[0])||void 0===i?void 0:i.name)||""]),iconClass:"icon-pc-warning",customClass:"decrypt-warning-wrapper"}),t.abrupt("return",!1);case 17:t.prev=17,t.t1=t.catch(0);case 19:case"end":return t.stop()}}),t,null,[[0,17]])})))()},getActionText:function(){var e=[{match:"copy"===this.actionType,text:"yun_views_Index44"},{match:"move"===this.actionType,text:"yun_views_Index41"},{match:"saveas"===this.actionType,text:"yun_views_Index44"}];return(0,r.GH)(e.find((function(e){return e.match})).text)},onConfirm:function(e){var t=arguments,i=this;return(0,s.Z)(a().mark((function n(){var o,c,l,u,d,p,f,m,h,_,v,g;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=t.length>1&&void 0!==t[1]&&t[1],c=Date.now(),l=null,l=0===e.files.length||e.path?e.path:1===e.files.length?e.files[0].sourceData||e.files[0]:e.files,u=null,u=0===e.files.length||e.path?e.path:e.files,["copy","move","saveas"].includes(i.actionType)&&i.$emit("close","ok"),d=function(){var t=(0,s.Z)(a().mark((function t(n,s){var o,c,l,d,p,f,m,h,_,v,g,y,x,b,k,w,$,C,S,F,T,P,N,E,I,D,Z,H,O;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i.onFinderConfirm(e,i.actionType,s);case 3:n.extraData&&void 0!==n.extraData.duplicated_name_model&&delete n.extraData.duplicated_name_model,"move"===i.actionType&&"copy"===i.actionType||i.$emit("close","ok"),t.next=32;break;case 7:if(t.prev=7,t.t0=t.catch(0),t.t0.response&&t.t0.response.data&&(t.t0.response.data.cid=Array.isArray(n)?n&&n[0].corpid:n&&n.corpid,t.t0.response.data.groupid=Array.isArray(n)?n&&n[0].groupid:n&&n.groupid),o=t.t0.response&&t.t0.response.data||{},c=o.result,l=o.msg,d=o.notOwnFile,p=o.cid,f=void 0===p?0:p,"SpaceFull"===c&&d&&(c="GroupOwnerSpaceFull"),"fileNameDuplicated"!==c){t.next=14;break}return t.abrupt("return",i.dialog("replaceTips",{msg:l,onSuccess:function(){e.files[0].duplicated_name_model=2,i.onConfirm(e,!0)},backprev:"move"!==i.actionType}));case 14:if(!t.t0.response||!t.t0.response.data){t.next=27;break}t.t1=i.actionType,t.next="copy"===t.t1?18:"moveto"===t.t1?21:"saveas"===t.t1?24:27;break;case 18:return t.t0.response.data.full_position="spacelimit_copy",t.t0.response.data.full_component="web_clouddoc_rightlist",t.abrupt("break",27);case 21:return t.t0.response.data.full_position="spacelimit_move",t.t0.response.data.full_component="web_clouddoc_rightlist",t.abrupt("break",27);case 24:return t.t0.response.data.full_position="spacelimit_saveas",t.t0.response.data.full_component="web_clouddoc_rightlist",t.abrupt("break",27);case 27:if("SecretGroupPermissionDenied"!==c){t.next=29;break}return t.abrupt("return",i.dialog("secretVipRenew",{useNewLayout:i.$store.state.ui.useNewLayout}));case 29:return["CorpSpaceFull","corpSpacesFull"].includes(c)&&(m=f||e.company&&e.company.id||0)&&(h=i.file.presets||[]).length&&(_=h[0],v=_.name,g=void 0===v?"":v,y=_.id,x=void 0===y?0:y,b=_.groupid,k=void 0===b?0:b,w=_.sourceData,$=(w=void 0===w?{}:w).fileinfo,C=$.fileid,S=void 0===C?0:C,F=$.fname,T=void 0===F?"":F,P=$.fsize,N=void 0===P?0:P,E=$.groupid,I=void 0===E?0:E,D=$.ftype,Z=void 0===D?"file":D,H=w.creator,O=void 0===H?{}:H,t.t0.response.data.companyID=m,t.t0.response.data.action=i.actionType,t.t0.response.data.fname=g||T,t.t0.response.data.size=N||"",t.t0.response.data.count=h.length||1,t.t0.response.data.fgroupid=k||I,t.t0.response.data.fileid=x||S,t.t0.response.data.isFolder=Boolean(~Z.indexOf("folder")),"sharefile"===Z&&O&&Number(i.$store.state.user.userid)!==Number(O.id)&&(t.t0.response.data.path=(0,r.GH)("yun_views_share_to_me_path"))),t.next=32,i.handleSpaceFull(t.t0,i.showDefaultError,i.actionType,u);case 32:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e,i){return t.apply(this,arguments)}}(),["copy","move","saveas"].includes(i.actionType)&&k.Z.onEvent("choose_position",{type:i.actionType,action:"confirm"}),p=!1,!(i.secureParams&&i.secureParams.groupid&&+i.secureParams.groupid>0)){n.next=23;break}if(!(i.secureParams&&i.secureParams.secure||"saveas"===i.actionType)){n.next=15;break}return n.next=14,i.needSecure(l);case 14:p=n.sent;case 15:if(f=!1,p||!i.secureParams||+i.secureParams.groupid==+l.groupid){n.next=21;break}return n.next=19,i.secureInfo(i.secureParams.groupid);case 19:(f=n.sent)&&0===parseInt(f.init_decode_status)&&(p=!0);case 21:m=!i.secureParams||+l.groupid===(i.secureParams&&i.secureParams.groupid),i.secureParams&&i.secureParams.secure&&i.secureParams.hasFolder&&!m&&(p=!0);case 23:if(!p||o){n.next=39;break}if(h=e.group.secure,_=e.group.name,v=JSON.parse(localStorage.getItem("secure_team_confirm2_".concat(i.$store.state.user.userid))||"false"),!h||!v){n.next=36;break}return n.next=30,i.isValidRolePermission();case 30:if(g=n.sent,n.t0=g,!n.t0){n.next=35;break}return n.next=35,d(l,!0);case 35:return n.abrupt("return");case 36:i.dialog("$$DialogSecureTeamConfirm",{ifSwitchBtnGroup:!0,groupid:i.secureParams.groupid,accountid:i.$store.state.user.userid,showSecureConfirmTwo:h,title:(0,r.GH)("yun_views_crypt_docs",[i.getActionText()]),targetGroupName:_,action:i.actionType,onSubmit:function(){var e=(0,s.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d(l,!0);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),backprev:"move"!==i.actionType}),n.next=41;break;case 39:return n.next=41,d(l);case 41:["copy","move","saveas"].includes(i.actionType)&&i.dwFinder&&k.Z.onEvent("fileselect_execute",{type:i.dwFinder.type,time:Date.now()-c,number:i.dwFinder.number});case 42:case"end":return n.stop()}}),n)})))()},onCancel:function(){this.$emit("close")}}},ss=ns,os=(0,y.Z)(ss,(function(){var e=this,t=e.$createElement;return(e._self._c||t)(e.component,{tag:"component",attrs:{action:e.action,path:e.path,featrues:e.featrues,file:e.file,dw:e.dw,okText:e.okText,cancelText:e.cances,as={name:"DriveStickyTopLabel",componentName:"DriveStickyTopLabel",props:{stickyTunction,default:function(){},required:!0}},data:function(){return{cancelBtnTxt:(0,r.GH)("file_new_File3"),confirmBtnTxt:(0,r.GH)("file_new_File4")}},methods:{getI18nText:r.GH,handleClose:function(){this.$emit("close")},handleCommit:function(){this.onCommit(),this.$emit("close")}}},cs=(0,y.Z)(as,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"content"},[e._v(" "+e._s(e.getI18nText("file_stickytop_index4",[e.stickyTagName]))+" ")]),i("div",{staticClass:"footer"},[i("kd-button",{attrs:{type:"secondary"},on:{click:e.handleClose}},[e._v(e._s(e.cancelBtnTxt))]),i("kd-button",{attrs:{type:"primary"},on:{click:e.handleCommit}},[e._v(e._s(e.confirmBtnTxt))])],1)])}),[],!1,null,"20c54d28",null).exports,ls={otl:{text:"".concat((0,r.GH)("mixins_destop_download22")).concat((0,r.GH)("mixins_destop_download24")),primaryBtn:"".concat((0,r.GH)("mixins_destop_download20")," Word"),primaryFormat:"docx",defaultBtn:"".concat((0,r.GH)("mixins_destop_download20")," PDF"),defaultFormat:"pdf"},ksheet:{text:"".concat((0,r.GH)("mixins_destop_download22")).concat((0,r.GH)("mixins_destop_download25")),primaryBtn:"".concat((0,r.GH)("mixins_destop_download20")," Excel"),primaryFormat:"xlsx",defaultBtn:"".concat((0,r.GH)("mixins_destop_download20")," PDF"),defaultFormat:"pdf"},dbt:{text:"".concat((0,r.GH)("mixins_destop_download22")).concat((0,r.GH)("mixins_destop_download26")),primaryBtn:"".concat((0,r.GH)("mixins_destop_download20")," Excel"),primaryFormat:"xlsx"},pof:{text:"".concat((0,r.GH)("mixins_destop_download27")),primaryBtn:"".concat((0,r.GH)("mixins_destop_download20")).concat((0,r.GH)("mixins_destop_download21")),primaryFormat:"png"},pom:{text:"".concat((0,r.GH)("mixins_destop_download27")),primaryBtn:"".concat((0,r.GH)("mixins_destop_download20")).concat((0,r.GH)("mixins_ng"}},us={name:"DriveSingleExportOnlineExt",componentName:"DriveSingleExportOnlineExt",mixins:[E.Z],props:{fileType:String},data:function(){return{format:""}},computed:{useNewLayout:function(){return this.$store.state.ui.useNewLayout},current:function(){return ls[this.fileType]},showPopover:function(){return!1}},methods:{submit:function(e){this.format=e,this.$emit("close","ok")}}},ds=(0,y.Z)(us,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"dialog-single-export-online-ext"},[i("div",[e._v(e._s(e.current.text))]),i("div",{staticClass:"single-export-online-ext-footer"},[e.showPopover?i("cloud-popover",{attrs:{visibleArrow:!1,trigger:"click",placement:"bottom-start"}},[i("cloud-button",{staticClass:"export-option-select is-popover",attrs:{slot:"reference",border:!1},slot:"reference"},[e._v(" "+e._s(e.$t("mixins_destop_download19"))+" "),e.useNewLayout?i("ArrowDownIcon",{attrs:{size:"14"}}):i("i",{staticClass:"el-icon-arrow-down"})],1),i("div",{staticClass:"export-popper-item",on:{click:function(t){return e.submit("pdf")}}},[e._v(" "+e._s(e.$t("mixins_destop_download20"))+" PDF ")]),i("div",{staticClass:"export-popper-item",on:{click:function(t){return e.submit("png")}}},[e._v(" "+e._s(e.$t("mixins_destop_download20"._e(),e.current.defaultBtn?i("cloud-button",{on:{click:function(t){return e.submit(e.current.defaultFormat)}}},[e._v(e._s(e.current.defaultBtn))]):e._e(),e.current.primaryBtn?i("cloud-button",{attrs:{type:"primary"},on:{click:function(t){return e.submit(e.current.primaryFormat)}}},[e._v(e._s(e.current.primaryBtn))]):e._e()],1)])}),[],!1,null,"2fe4b5cf",null).exports,ps=i(71002),fs={methods:{getSwitch:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i,r,n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=null,t.next=4,e.$store.dispatch("GET",{url:"/kdg/api/v1/params/baseOperation/sub_keys?subKeys=componentname_change",host:"docs"});case 4:if(r=t.sent,!((n=r.data)&&n.data&&n.data.componentname_change)){t.next=9;break}return i="object"!==(0,ps.Z)(n.data.componentname_change)?JSON.parse(n.data.componentname_change):n.data.componentname_change,t.abrupt("return",i);case 9:t.next=13;break;case 11:t.prev=11,t.t0=t.catch(0);case 13:case"end":return t.stop()}}),t,null,[[0,11]])})))()}}},ms=i(57397),hs={".otl":{current:"",icon:"otl",label:(0,r.GH)("config_dotview_i18_otl1"),options:[{label:"".concat((0,r.GH)("mixins_destop_download20")," Word"),value:".docx"},{label:"".concat((0,r.GH)("mixins_destop_download20")," PDF"),value:".pdf"}]},".ksheet":{current:"",icon:"ksheet",label:(0,r.GH)("config_dotview_i18_xls1"),options:[{label:"".concat((0,r.GH)("mixins_destop_download20")," Excel"),value:".xlsx"},{label:"".concat((0,r.GH)("mixins_destop_download20")," PDF"),value:".pdf"}]},".dbt":{current:"",icon:"dbt",label:(0,r.GH)("file_navigator_normal_DropdownFilter_dbt"),options:[{label:"".concat((0,r.GH)("mixins_destop_download20")," Excel"),value:".xlsx"}]},".pof":{current:"",icon:"pof",label:(0,r.GH)("file_navigator_normal_DropdownFilter_pof"),options:[{label:"".concat((0,r.GH)("mixins_destop_download20")).concat((0,r.GH)("mixins_destop_download21")),value:".png"}]},".pom":{current:"",icon:"pom",label:(0,r.GH)("file_navigator_normal_DropdownFilter_pom"),options:[{label:"".concat((0,r.GH)("mixins_destop_download20")).concat((0,r.GH)("mixins_destop_download21")),value:".png"}]}},_s={".xlsx":"click_export_Excel",".docx":"click_export_Word",".pdf":"click_export_PDF"},vs={name:"DriveBatchExportOnlineExt"s:[E.Z,fs],components:{FormatIcon:ms.Z},props:{onlineExtList:{type:Array}},data:function(){return{fileTypeMap:Object.assign({},hs)}},computed:{fileTypeList:function(){var e=this;return[".otl",".ksheet",".dbt",".pof",".pom"].filter((function(t){return e.onlineExtList.includes(t)}))}},created:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.getSwitch();case 3:(i=t.sent)&&Object.keys(i).forEach((function(t){e.fileTypeMap[".".concat(t)]&&(e.fileTypeMap[".".concat(t)].label=i[t])})),t.next=9;break;case 7:t.prev=7,t.t0=t.catch(0);case 9:Object.keys(e.fileTypeMap).forEach((function(t){e.fileTypeMap[t].current=e.fileTypeMap[t].options[0]}));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},methods:{onSh((function(i){e!==i&&(t.fileTypeMap[i].visible=!1)}))},selectCurrent:function(e,t){e.current=t,k.Z.onEvent("download_file",{action:_s[t.value]}),this.onShow()},cancel:function(){this.onShow(),this.$emit("close","cancel")},submit:function(){this.onShow(),this.$emit("close","ok")}}},gs=vs,ys=(0,y.Z)(gs,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"dialog-batch-export-online-ext"},[i("div",[e._v(" "+e._s(e.$t("mixins_destop_download23"))+" ")]),i("div",{staticClass:"batch-export-online-ext-options",class:{"is-single":e.fileTypeList&&1===e.fileTypeList.length}},e._l(e.fileTypeList,(function(t,r){return i("div",{key:r,staticClass:"export-option"},[i("div",{staticClass:"export-option-icon"},[i("FormatIcon",{attrs:{fileName:"."+e.fileTypeMap[t].icon}})],1),i("div",{staticClass:"export-option-fileType"},[e._v(e._s(e.fileTypion-format"},[e.fileTypeMap[t].options.length>1?i("cloud-popover",{attrs:{visibleArrow:!1,offset:-15,trigger:"click",placement:"bottom-end"},on:{show:function(i){return e.onShow(t)}},model:{value:e.fileTypeMap[t].visible,callback:function(i){e.$set(e.fileTypeMap[t],"visible",i)},expression:"fileTypeMap[item].visible"}},[i("cloud-button",{staticClass:"export-option-select is-popover",attrs:{slot:"reference",border:!1},slot:"reference"},[e._v(" "+e._el)+" "),i("ArrowDownIcon",{attrs:{size:"14"}})],1),e._l(e.fileTypeMap[t].options,(function(r,n){return i("div",{key:n,staticClass:"export-popper-item",class:{"is-checked":r.value===e.fileTypeMap[t].current.value},on:{click:function(i){return e.selectCurrent(e.fileTypeMap[t],r)}}},[i("div",[e._v(e._s(r.label))]),r.value===e.fileTypeMap[t].current.value?[i("CheckedIcon",{attrs:{strokeWidth:2}})]:e._e()],2)}))],2):i("cloud-button",{staticClass:"export-option-select is-default"},[e._v(" "+e._s(e.$t("mixins_destop_download31"))+e._s(e.fileTypeMap[t].current&&e.fileTypeMap[t].current.label)+" ")])],1)])})),0),i("div",{staticClass:"batch-export-online-ext-footer"},[i("cloud-button",{on:{click:function(t){return e.cancel()}}},[e._v(e._s(e.$t("mixins_destop_download28")))]),i("cloud-button",{attrs:{type:"primary"},on:{click:function(t){return e.submit()}}},[e._v(e._s(e.$t("mixins_destop_download29")))])],1)])}),[],!1,null,"13a6c2b6",null).exports,xs=[{icon:"otl",label:(0,r.GH)("config_dotview_i18_otl1")},{icon:"ksheet",label:(0,r.GH)("config_dotview_i18_xls1")},{icon:"dbt",label:(0,r.GH)("file_navigator_normal_Drop(0,r.GH)("file_navigator_normal_DropdownFilter_pof")},{icon:"pom",label:(0,r.GH)("file_navigator_normal_DropdownFilter_pom")}],bs={name:"DriveOnlineExtError",componentName:"DriveOnlineExtError",components:{Fo(){return{fileTypeList:xs}},created:function(){var e=this;return(0,s.Z)(a().mark((function t(){var i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.getSwitch();case 3:(i=t.sent)&&xs.forEach((function(e){i[e.icon]&&(e.label=i[e.icon])})),t.next=9;break;case 7:t.prev=7,t.t0=t.catch(0);case 9:e.$on("ok",e.ok);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},methods:{ok:function(){this.$emit("close","ok")}}},ks=bs,ws=(0,y.Z)(ks,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"dialog-online-ext-error"},[i("div",[e._v(" "+e._s(e.$t("mixins_destop_download33"))+" ")]),i("div",{staticClass:"dialog-online-ext-error-tips"},[e._v(e._s(e.$t("mixins_destop_download34")))]),i("div",{staticClass:"dialog-online-ext-error-options"},e._l(e.fileTypeList,(function(t,r){return i("div",{key:r,staticClass:"export-option"},[i("div",{staticClass:"export-option-icon"},[i("FormatIcon",{attrs:{fileName:"."+t.icon}})],1),i("div",{staticClass:"export-option-fileType"},[e._v(e._s(t.label))])])})),0)])}),[],!1,null,"b052fa42",null).exports,$s={name:"SerMultiEdit",proppe:Boolean,default:!1},handleConfirm:{type:Function,default:function(){}},groupIsOpenWithMultiEdit:{type:Boolean,default:!1},isAllow:{type:Boolean,default:!1}},components:{FormatIcon:ms.Z},computed:{iconConfig:function(){var e=this.file;return{fileName:e.fname,fileType:e.ftype}},fname:function(){var e=this.file,t=e.fname;return"link"===e.ftype?t.replace(".link",""):t},tips:function(){return this.isAllow?this.groupIsOpenWithMultiEdit?this.$t("set_multiedit_warn_tips"):this.selfIsOpenWithMultiEdit?this.$t("set_multiedit_close_tips"):this.$t("set_multiedit_open_tips"):this.$t("set_multiedit_permission_tips")}}},Cs=$s,Ss=(0,y.Z)(Cs,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"setMultiEdit_dialog"},[e.groupIsOpenWithMultiEdit?e._e():i("div",{staticClass:"setMultiEdit_dialog_content"},[i("FormatIcon",e._b({attrs:{size:30}},"FormatIcon"Edit_dialog_fname"},[e._v(e._s(e.fname))])],1),i("p",{staticClass:"setMultiEdit_dialog_tips"},[e._v(e._s(e.tips))]),i("footer",{staticClass:"setMultiEdit_dialog_footer"},[this.isAllow?[i("kd-button",{attrs:{type:"primary"},on:{click:function(){e.handleConfirm(),e.$emit("close")}ultiedit_confirm"))+" ")]),e.groupIsOpenWithMultiEdit?e._e():i("kd-button",{attrs:{type:"secondary"},on:{click:function(t){return e.$emit("close")}}},[e._v(" "+e._s(e.$t("set_multiedit_close"))+" ")])]:[i("kd-button",{attrs:{type:"primary"},on:{click:function(){e.$emit("close")}}},[e._v(" "+e._s(e.$t("set_multiedit_permission_btn"))+" ")])]],2)])}),[],!1,null,"575eb7da",null).exports,Fs=[{value:"ksheet",icon:"ksheet",title:(0,r.GH)("config_dotview_i18_xls1"),tag:(0,r.GH)("c_plupload_index11"),text:(0,r.GH)("c_plupload_index13")t:(0,r.GH)("c_plupload_index14")}],Ts={components:{VueAbbr:fi.Z,FormatIcon:ms.Z},props:{config:Object,excelList:{type:Array,default:function(){return[]}},fileList:{type:Array,default:function(){return[]}}},data:function(){return{current:"ksheet",popoverVisible:!1,extOptions:Fs}},beforeMount:function(){var e=localStorage.getItem("uploadExcelToAS");this.extOptions[0].tag="ksheet"===e?(0,r.GH)("c_plupload_index10"):(0,r.GH)("c_plupload_index11"),this.config&&(this.extOptions[0].title=this.config.selection1_title,this.extOptions[0].text=this.config.selection1_content,this.extOptions[1].title=this.config.selection2_title,this.extOptions[1].text=this.config.selection2_content)},mounted:function(){this.dwEvent("show")},computed:{useNewLayout:function(){return this.$store.state.ui.useNewLayout},excelLihis.fileList.length||0}},methods:{getI18nText:r.GH,convertUnit:l.convertUnit,subFileName:l.subFileName,handlePopoverOpen:function(){this.dwEvent("click_more")},onSelect:function(e){this.current=e.value},cancel:function(){this.dwEvent("click_cancel"),this.$emit("close","cancel")},submit:function(){this.dwEvent("click_confirm"),localStorage.setItem("uploadExcelToAS",this.current),this.$emit("close","ok")},dwEvent:function(e){k.Z.onEvent("upload_change_popup",{action:e,file_all_num:this.total,change_as_num:this.excelCount,label:this.extOptions[0].tag===(0,r.GH)("c_plupload_index10")?"last":"recommend",select_type_new:"ksheet"===this.current?"as":"et"})}}},Ps=(0,y.Z)(Ts,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"dialog-excel-to-as"},[i("div",{staticClass:"excel-to-as-tip"},[i("div",{staticClass:"excel-to-as-tiptext"},[e._v(e._s(e.$t("c_plupload_index15",[e.total,e.excelCount])))]),i("cloud-popover",{ref:"filesPopover",attrs:{trigger:"click",placement:"bottom-start",popperClass:"excel-to-as-popover",visibleArrow:""},on:{show:e.handlePopoverOpen},model:{value:e.popoverVisible,callback:function(t){e.popoverVisible=t},expression:"popoverVisible"}},[i("cloud-button",{directives:[{name:"popover",rawName:"v-popover:filesPopover",arg:"filesPopover"}],staticClass:"excel-to-as-tipbtn",attrs:{slot:"reference",menu:"",type:"light",size:"small",highlight:"",active:e.popoverVisible},slot:"reference"},[e._v(e._s(e.$t("c_plupload_index9")))]),[i("div",{staticClass:"excel-to-as-files"},e._l(e.excelList,(function(t,r){return i("div",{key:r,staticClass:"excel-to-as-file"},[i("div",{staticClass:"excel-to-as-ficon"},[i("FormatIcon",{attrs:{fileName:t.name,size:16}})],1),i("div",{staticClass:"excel-to-as-finfo"},[i("div",{staticClass:"excel-to-as-fname"},[i("vue-abbr",{attrs:{text:e._f("subFileName")(t.name),hasTips:""}})],1),i("div",{staticClass:"excel-to-as-fsize"},[e._v(" "+e._s(e.convertUnit(t.size))+" ")])])])})),0)]],2)],1),i("div",{staticClass:"excel-to-as-options"},e._l(e.extOptions,(function(t,r){return i("div",{key:r,staticClass:"excel-to-as-option",class:{"is-checked":e.current===t.value},on:{click:function(i){return e.onSelect(t)}}},[i("div",{staticClass:"excel-to-as-option-icon"},[i("FormatIcon",{attrs:{fileName:"."+t.icon,size:36}})],1),i("div",{staticClass:"excel-to-as-option-label"},[i("div",{staticClass:"excel-to-as-option-title"},[e._v(e._s(t.title))]),t.tag?i("kd-tag",{staticClass:"excel-to-as-option-tag",attrs:{size:"small",checked:""}},[e._v(e._s(t.tag))]):e._e()],1),i("div",{staticClass:"excel-to-as-option-text"},[e._v(e._s(t.text))])])})),0),i("div",{staticClass:"excel-to-as-footer"},[i("cloud-button",{on:{click:function(t){return e.cancel()}}},[e._v(e._s(e.$t("mixins_destop_download28")))]),i("cloud-button",{attrs:{type:"primary"},on:{click:function(t){return e.submit()}}},[e._v(e._s(e.$t("components_dialog_events21")))])],1)])}),[],!1,null,"4b27f762",null).exports,Ns={on,default:function(){return Promise.resolve(!0)}},onOpenVip:{web_upload&page_path=p/myPrivilege")}},created:function(){var e=this;this.$on("ok.prev=t.next){case 0:return t.next=2,e.okHandler();case 2:case"end":return t.stop()}}),t)})))),this.$on("close",(function(t){e.closeHandler(t)}))},mounted:function(){this.sendDw("show")},methods:{sendDw:function(e){k.Z.onEvent("upload_exceeds",{action:e,position:this.position})},closeHandler:function(){var e=this;this.sendDw("click_close"),this.dispatch("DriveDialog","close"),this.$nextTick((function(){e.onClose()}))},onShowPopover:function(){this.sendDw("click_privilege")},okHandler:function(){var e=this;return(0,s.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.sendDw("click_membership"),t.next=3,e.onOpenVip();case 3:e.hideDialog("privilegeCard");case 4:case"end":return t.stop()}}),t)})))()}}},Es=Ns,Is=(0,y.Z)(Es,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"dialog-privilege-card"},[i("div",{staticClass:"privilege-card-text"},[e._v(" "+e._s(e.$t("c_plupload_privilege_text"))+" ")]),i("div",{staticClass:"privilege-card-footer"},[i("kd-popover",{attrs:{popperClass:"popover-mini-code"},on:{show:e.onShowPopover}},[i("kd-button",{staticClass:"btn-invite",attrs:{slot:"reference",type:"light",highlight:""},slot:"reference"},[e._v(e._s(e.$t("c_plupload_privilege_invite")))]),i("div",{staticClass:"mini-code-container"},[i("div",{staticClass:"mini-code"},[i("img",{attrs:{src:e.miniCode,alt:"mini code"}})]),i("div",{staticClass:"mini-code-text"},[e._v(e._s(e.$t("c_plupload_privilege_scan")))])])],1),i("kd-button",{staticClass:"btn-open-vip",attrs:{type:"primary"},on:{click:function(t){return e.$emit("ok")}}},[e._v(e._s(e.$t("c_plupload_privilege_vip")))])],1)])}),[],!1,null,null,null).exports,Ds={name:"NewPDFCard",props:{icon:{type:String,default:""},title:{type:String,default:""},desc:{type:String,default:""},subMenu:{type:Boolean,default:!1}}},Zs=(0,y.Z)(Ds,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.subMenu?i("div",{staticClass:"newpdf-card-submenu"},[i("div",{staticClass:"submenu-hover"},[i("div",{staticClass:"submenu-wrapper"},[i("img",{staticClass:"icon",attrs:{src:e.icon}}),i("span",{staticClass:"newpdf-card-desc"},[e._v(" "+e._s(e.title)+" ")])])])]):i("div",{staticClass:"newpdf-card-wrapper"},[i("div",{staticClass:"newpdf-card-inner"},[i("div",{staticClass:"newpdf-card-hover"},[i("div",{staticClass:"newfile-icon-wrapper"},[i("img",{staticClass:"icon",attrs:{src:e.icon}}),i("span",{staticClass:"newpdf-card-info"},[i("div",{staticClass:"newpdf-card-title"},[e._v(" "+e._s(e.title)+" ")]),i("div",{staticClass:"newpdf-card-desc"},[e._v(" "+e._s(e.desc)+" ")])])])])])])}),[],!1,null,null,null).exports,Hs=i(56357),Os=i(51633),Ls=i(48941),Gs={name:"DocToPDF",components:{NewPDFCard:Zs},mixins:[Ls.Z],data:function(){return{icon:{DocTransSVG:"".concat(this.$cdn,"/kdocs/cloud/pdf/doc_transform_colorful.svg"),EquipmentSVG:"".concat(this.$cdn,"/kdocs/cloud/pdf/equipment_colorful.svg"),DocCloudSVG:"".concat(this.$cdn,"/kdocs/cloud/pdf/doc_cloud_colorful.svg")},showPopover:!1}},methods:{sendDW:function(e){(0,Ls.X)({action:e})},onClose:function(){this.$emit("close","ok")},createCloudFileToPDF:function(){var e=this;this.sendDW("click_file2pdf_cloud");var t=(0,Hs.Z)();if(t.transfering)this.$message.info(this.$t("file_dialog_DocToPDF4"));else{this.onClose();var i=this.$message;(0,Os.v)("openFinderNew",{title:this.$t("file_dialog_DocToPDF5"),size:"large",backprev:!1,action:"selectFile",file:{includes:t.getSupportExtList("office")},dw:{_from:"kdocs",_function:"newfile_pdf"},onFinderConfirm:function(r){setTimeout((0,s.Z)(a().mark((function n(){var s,o,c,l;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s=r.files[0],o=e.getPidGid(),c=o.gid,l=o.pid,s.groupid=c,s.parentid=l,s.corpid=e.$store.state.company.current.id,!(s.size>104857600)){n.next=10;break}return s.message=e.$t("file_dialog_DocToPDF6"),n.next=9,t.startTransfer({toast:i,status:"unsupport",file:s});case 9:return n.abrupt("return");case 10:return n.next=12,t.startTransfer({toast:i,status:"loading",file:s});case 12:return n.next=14,t.startTransfer({toast:i,status:"success",file:s});case 14:case"end":return n.stop()}}),n)}))))}})}}}},Ms=Gs,Rs=(0,y.Z)(Ms,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("kd-popover",{attrs:{placement:"right-start",trigger:"click",popperOptions:{removeOnDestroy:!0},maxWidth:418,offset:-10,popperClass:"doc_pdf_popover"},model:{value:e.showPopover,callback:function(t){e.showPopover=t},expression:"showPopover"}},[i("NewPDFCard",{class:{active:e.showPopover},attrs:{slot:"reference",icon:e.icon.DocTransSVG,title:e.$t("file_dialog_DocToPDF0"),desc:e.$t("file_dialog_DocToPDF1")},slot:"reference"}),i("div",{staticClass:"popover-wrapper"},[i("span",{staticClass:"popover-title"},[e._v(" "+e._s(e.$t("file_dialog_DocToPDF0"))+" ")]),i("div",{staticClass:"card-row"},[i("NewPDFCard",{staticClass:"plupload-anchor child",attrs:{"data-file2pdf":"true",icon:e.icon.EquipmentSVG,title:e.$t("file_dialog_DocToPDF2"),subMenu:""},nativeOn:{"~click":function(t){return e.sendDW("click_file2pdf_local")}}}),i("NewPDFCard",{attrs:{icon:e.icon.DocCloudSVG,title:e.$t("file_dialog_DocToPDF3"),subMenu:""},nativeOn:{click:function(t){return e.createCloudFileToPDF.apply(null,arguments)}}})],1)])],1)}),[],!1,null,"243dcb35",null),Bs=Rs.exports,As={name:"UploadPDF",components:{NewPDFCard:Zs},data:function(){return{icon:"".concat(this.$cdn,"/kdocs/cloud/pdf/uploading_colorful.svg")}}},js=(0,y.Z)(As,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("NewPDFCard",{staticClass:"plupload-anchor",attrs:{"data-pdf":"true",icon:e.icon,title:e.$t("file_pdf_UploadPDF0"),desc:e.$t("file_pdf_UploadPDF1")}})}),[],!1,null,null,null).exports,Ws={name:"PicToPDF",components:{NewPDFCard:Zs},data:function(){return{icon:"".concat(this.$cdn,"/kdocs/cloud/pdf/pic_colorful.svg")}}},Vs=(0,y.Z)(Ws,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("NewPDFCard",{staticClass:"plupload-anchor",attrs:{icon:e.icon,title:e.$t("file_pdf_PicToPDF0"),desc:e.$t("file_pdf_PicToPDF1"),"data-img2pdf":"true"}})}),[],!1,null,null,null).exports,Us=i(44112),zs=i(87905);function qs(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function Ks(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?qs(Object(i),!0).forEach((function(t){(0,n.Z)(e,t,i[t])})):Object.getOwnPropertyDescriptors?ObjecyDescriptors(i)):qs(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var Qs=(0,Hs.Zd:Zs},c}})),{},{groupId:function(){return this.$route.params.tid||this.$store.state.company.entspaceid||this.$store.state.team.current.id||0},parentId:function(){return this.$route.params.fid||0}}),data:function(){return{icon:"".concat(this.$cdn,"/kdocs/cloud/pdf/chain_colorful.svg")}},methods:{pageConvert:function(){var e=this;if(Qs.transfering)this.$message.info(this.$t("file_pdf_WebToPDF2"));else{var.$t("file_pdf_:!1,back:!1,params:{convertType:1,groupID:Number(this.groupId),parentID:Number(this.parentId),from:"pc_newbuilt_pdf"},openUrl:function(e){new Us.Z({$vm:{$ua:t.$ua}}).openWin(e)},openClear:function(){(0,zs.Vb)(e.currentCompanyId)},startCallback:function(e){e&&(Qs.transfering=!0)},currentCompanyId:this.currentCompanyId,finishCall){var i=e.icon.includes("success"),r=Ks(Ks({useNewLayout:!0},e),{},{titleText:i?this.$t("file_pdf_WebToPDF3"):this.$t("file_pdf_WebToPDF4")});i?(r.back=!1,r.backprev=!1,r.cancel=function(){t.pageConvert()}):(r.back=!0,r.backprev=!1,r.cancel=function(e){e.$emit("close","cancel")},r.beforeCloseFun=function(e,t){"cancel"===t?e.$emit("close","close"):"function"==typeof t?"ConvertPage"===e.$attrs.folderType?(e.customDialogClose((function(){})),t()):e.$emit("close","close"):"close"===t&&e.$emit("close","ok")}),(0,Os.v)("ConvertPageResult",r)}},beforeCloseFun:function(t,i){"function"==typeof i?(t.customDialogClose((function(){})),i()):e.$parent.$parent.hide()},onDwEvent:function(e){k.Z.onEvent("fileapp_savewxarticle",Ks(Ks({},e),{},{source:"pc_newbuilt_pdf"}))}})}}}},Js=Ys,Xs=(0,y.Z)(Js,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("NewPDFCard",{att:e.$t("file_pdf_bToPDF1")},nativeOn:{click:function(t){return e.pageConvert.apply(null,arguments)}}})}),[],!1,null,null,null),eo={name:"NewPDFCreate",components:{UploadPDF:js,DocToPDF:Bs,PicToPDF:Vs,WebToPDF:Xs.exports},data:function(){return{}},methods:{sendDW:function(e){(0,Ls.X)({action:e})}}},to=(0,y.Z)(eo,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"pdf-newfile-row"},[i("UploadPDF",{on:{close:function(t){return e.$emit("close")}},nativeOn:{"~click":function(t){return e.sendDW("click_upload")}}}),i("DocToPDF",{on:{close:function(t){return e.$emit("close")}},nativeOn:{click:function(t){return e.sendDW("click_file2pdf")}}}),i("PicToPDF",{nativeOn:{"~click":function(t){return e.sendDW("click_image2pdf")}}}),i("WebToPDF",{on:{close:function(t){return e.$emit("close")}},nativeOn:{click:function(t){return e.sendDW("click_web2pdf")}}})],1)}),[],!1,null,null,null).exports,io=i(69041),ro=i(29328),no={name:"ConvertResultHeader",props:{icon:{type:String,default:""},titleText:{type:String,default:""}}},so=(0,y.Z)(no,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{staticClass:"kdv-dialog__title",class:{"with-icon":e.icon}},[e.icon?[i("KIcon",{attrs:{type:e.icon}}),i("span",[e._v(e._s(e.titleText))])]:i("span",[e._v(e._s(e.titleText))])],2)}),[],!1,null,"1e47a83e",null).exports,oo={newFile:{title:(0,r.GH)("components_dialog_events3"),body:xr,footer:null},newFilePosition:{title:(0,r.GH)("components_dialog_events3"),body:wr,footer:null},newFolder:{title:(0,r.GH)("components_dialog_events4"),body:Fr,footer:null},renameFile:{title:(0,r.GH)("components_dialog_events5"),body:x,footer:null},inviteWrite:{title:"<% title %>",ftype:"<% ftype %>",body:Ze,footer:null,hideHeader:!1},inviteWriteQrcode:{title:"<% title %>",ftype:"<% ftype %>",body:Ae,footer:null,hideHeader:!1},fileHistory:{title:_r,ftype:"<% ftype %>",body:fr,footer:null,hideHeader:!1,closeOnPressEscape:!1},fileOldHistory:{title:"<% fname %>",ftype:"<% ftype %>",body:fr,footer:null},deleteFiles:{title:"<% title %>",body:z,footer:null},clearTrash:{title:(0,r.GH)("components_dialog_events7"),body:ee,footer:{mod:"confirm",okText:(0,r.GH)("components_dialog_events8")}},recoverFiles:{title:"<% title %>",body:P},exitShare:{title:(0,r.GH)("components_dialog_events9"),body:ct,footer:{mod:"confirm"}},removeFileFromRecord:{title:(0,r.GH)("components_dialog_events70"),body:Y,footer:{mod:"confirm",okText:(0,r.GH)("components_dialog_events71")}},registerVip:{title:"<% title %>",body:Dr,footer:null},Finder:{title:"<% tit %>",body:vi},AchiveList:{title:"<% title %>",body:jr,size:"small",footer:null},DecompressVip:{title:"<% title %>",body:Dr,footer:null},setSecretPassword:{title:(0,r.GH)("components_dialog_events17"),body:ae,footer:null},bindPhone:{title:(0,r.GH)("components_dialog_events17"),body:me,footer:null},corpSpaceFull:{title:(0,r.GH)("components_dialog_events19"),body:Xr,footer:null},spaceFull:{title:(0,r.GH)("components_dialog_events19"),body:Yr,footer:null},confirmTransfer:{title:(0,r.GH)("components_dialog_events20"),body:kt,footer:{okText:(0,r.GH)("components_dialog_events21")}},beforeTransfer:{title:(0,r.GH)("components_dialog_events20"),body:$t,footer:{okText:(0,r.GH)("components_dialog_events22")}},transferMember:{size:"large",body:Ft,footer:null,hideHeader:!0},sizeLimit:{title:(0,r.GH)("components_dialog_events23"),body:Yr,footer:null},spaceFullTeam:{title:(0,r.GH)("components_dialog_events24"),body:Yr,footer:null},giveUpBindPhone:{title:(0,r.GH)("components_dialog_events17"),body:ve,footer:null},unlockSecret:{title:(0,r.GH)("components_dialog_events25"),body:be,footer:null},preventUpload:{title:(0,r.GH)("components_dialog_events26"),body:$e,footer:null},secretRegister:{title:(0,r.GH)("secret_dialog_register_title"),body:Fe,footer:{okText:(0,r.GH)("secret_dialog_register_confrim")}},secretVipRenew:{title:(0,r.GH)("secret_dialog_vip_title"),body:Ne,footer:{okText:(0,r.GH)("secret_dialog_vip_confrim")}},removeShareFolder:{title:(0,r.GH)("components_dialog_events30"),body:Ke,footer:null},renameShareFolder:{title:(0,r.GH)("components_dialog_events5"),body:Ve,footer:null},modifyFilePermission:{title:"<% title %>",body:rt,footer:null,ftype:"<% ftype %>"},modifyPermissionInfoSup:{title:(0,r.GH)("components_dialog_events31"),body:Ye,footer:{okText:(0,r.GH)("components_dialog_events32")}},modifyPermissionInfoSub:{title:(0,r.GH)("components_dialog_events31"),body:Ye,footer:{okText:(0,r.GH)("components_dialog_events33")}},ModifyPermissionInfoTip:{title:(0,r.GH)("components_dialog_events31"),body:et,footer:null},ModifyFilePerSetting:{title:(0,r.GH)("components_dialog_events31"),body:st,footer:null},removeTeamFolder:{title:"<% title %>",body:sn,footer:null},cancelTeam:{title:(0,r.GH)("components_dialog_events35"),body:ln,footer:null},createShareFolder:{title:(0,r.GH)("components_dialog_events36"),body:$n,footer:null},createClassShareFolder:{title:(0,r.GH)("components_dialog_events_create_class_sharefolder"),body:$n,footer:null},createWorkShareFolder:{title:(0,r.GH)("components_dialog_events_create_work_sharefolder"),body:$n,footer:null},createNormalShareFolder:{title:(0,r.GH)("components_dialog_events_create_normal_sharefolder"),body:$n,footer:null},cancelFileLink:{title:(0,r.GH)("components_dialog_events35"),body:xt,footer:{mod:"confirm",okText:(0,r.GH)("components_dialog_events37")+" "+(0,r.GH)("components_dialog_events38")}},searchFile:{size:"large",body:Cn.default,footer:null,closeOnClickModal:!0},removeCooperation:{title:(0,r.GH)("components_dialog_events41"),body:Tn,footer:null},recoverHistoryFile:{title:(0,r.GH)("components_dialog_events42"),body:O,footer:{okText:(0,r.GH)("components_dialog_events43")}},delLink:{title:"<% title %>",body:gt,footer:{mod:"confirm"}},replaceTips:{title:(0,r.GH)("components_dialog_events72"),body:Nn,footer:null},saveFirstThenSend:{title:(0,r.GH)("components_dialog_sendastemp_forbidden"),body:On,footer:null},importTips:{title:(0,r.GH)("components_dialog_events73"),body:In,footer:null},secureTeam:{title:"<% title %>",body:Zn,footer:null},teamAuth:{body:Gn,footer:null},coverFile:{title:"<% title %>",body:Bn,footer:null},privilegeCard:{title:"<% title %>",body:Is,footer:null},coverFileAll:{title:"<% title %>",body:Wn,footer:null},moveFileFailList:{title:"<% title %>",body:Kn,footer:null},copyFileFailList:{title:"<% title %>",body:Kn,footer:null},UnDecompress:{title:(0,r.GH)("file_achive_title"),body:Jn,footer:{okText:(0,r.GH)("file_achive_download")}},openFinder:{title:"<% fname %>",ftype:"<% ftype %>",body:ts,footer:null},openFinderNew:{title:"<% fname %>",ftype:"<% ftype %>",body:os,footer:null},stickyTopLabel:{title:(0,r.GH)("tip"),body:cs,footer:null},singleExportOnlineExt:{title:(0,r.GH)("dialog_download_title"),body:ds,footer:null},batchExportOnlineExt:{title:(0,r.GH)("yun_views_Index20"),body:ys,footer:null},onlineExtError:{title:(0,r.GH)("yun_views_Index20"),body:ws,footer:{cancelText:"",okText:(0,r.GH)("dialog_download_okText")}},setMultiEdit:{title:"<% fname %>",body:Ss,footer:null},excelToAS:{title:(0,r.GH)("c_upload_index6"),body:Ps,footer:null},NewPDFCreate:{title:"<% title %>",body:to,footer:null},ConvertPage:{title:"<% title %>",body:io.Z,footer:null},ConvertPageResult:{title:so,body:ro.Z,footer:null}}},39201:function(e,t,i){var r=i(16473),n=i.n(r),s=i(71002),o=i(15861),a=i(87757),c=i.n(a),l=i(14500),u=i(78684),d=i(21628),p=i(81045),f=i(96490),m=i(70536),h=i(63040),_=i(5839),v=i(92250),g=i(63616);t.Z={mixins:[u.Z,v.Z],computed:{currentLevel:function(){return"svip"}},methods:{handleSpaceFull:function(e){var t=arguments,i=this;return(0,o.Z)(c().mark((function r(){var o,a,l,u,v,y,x,b,k,w,$,C,S,F,T,P,N,E,I,D,Z,H,O,L,G,M,R,B,A,j,W,V,U,z,q,K,Q,Y,J,X,ee,te;return c().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=!(t.length>1&&void 0!==t[1])||t[1],a=t.length>2?t[2]:void 0,l=t.length>3?t[3]:void 0,u={},e instanceof Error?u=(0,d.get)(e,"response.data"):"object"===(0,s.Z)(e)&&(u=e),(0,f.fV)(!0),v=(0,d.getSpaceFullType)((0,d.get)(u,"msg")),y=(0,d.get)(u,"result"),x=(0,d.get)(u,"code"),!("SpaceFull"===y&&v||"SpaceFull"===y&&11001===x)){r.next=18;break}return i.$emit("close","ok"),b=l&&l.groupid||u.groupid,k={position:u.full_position||"spacelimit_newbuilt",component:u.full_component||"web_lefttbab",payconfig:i.currentLevel},i.vipLessThan(i.$store.state.user.vip_level,"20")||i.vipEqualsTo("104")||(k.sku_key="vip_pro_plus"),r.next=16,(0,m.UK)("spaceFullModalShow",{groupId:b,payParams:k});case 16:r.next=58;break;case 18:if(!["CorpSpaceFull","corpSpacesFull","fileSizeLimit"].includes(y)){r.next=37;break}if(i.$emit("close","ok"),w=window.__INITIAL_STATE__?window.__INITIAL_STATE__.team.current.id:u.groupid,$=i.$route&&"Enterprise"===i.$route.name?w:u.groupid,S=(C=u||{}).companyID,F=void 0===S?0:S,T=C.fname,P=void 0===T?"":T,N=C.size,E=void 0===N?"":N,I=C.count,D=void 0===I?1:I,Z=C.path,H=void 0===Z?"":Z,O=C.action,L=void 0===O?"":O,G=C.fgroupid,M=void 0===G?0:G,R=C.fileid,B=void 0===R?0:R,A=C.isFolder,j=void 0!==A&&A,W=C.origId,V=void 0===W?0:W,U={groupId:$,payParams:{position:u.full_position||"spacelimit_upload_transfer",component:u.full_component||"web_lefttbab"}},F=Number(F)||0,"saveas"===(z=a||L)&&(z="save_as"),U.epSpaceLimitOptions={companyID:F,type:"fileSizeLimit"===y?"upload_limit":"space_limit",action:z,fileInfo:{name:P,size:E,count:D,location:H,groupID:Number(M)||0,fileID:Number(V)||Number(B)||0,isFolder:j}},!i.$ua.eduWorkbench){r.next=33;break}return n().error((0,p.GH)("fileSizeLimit"===y?"c_tooltips_Index20":"c_tooltips_Index14")),r.abrupt("return");case 33:return r.next=35,(0,m.UK)("spaceFullModalShow",U);case 35:r.next=58;break;case 37:if(!["groupNormalSpacesFull","groupSpecialSpacesFull"].includes(y)){r.next=52;break}if(!(q=+u.cid||+u.corpid||u.company&&+u.company.id)&&["Enterprise","EntSpace","EntTrash","Backup"].includes(i.$route.name)&&(q=i.$route.params.cid||0),q||!u.groupid){r.next=44;break}return r.next=43,(0,_.ZG)(u.groupid);case 43:q=r.sent;case 44:return K={cid:q,spaceFullType:y,title:"groupNormalSpacesFull"===y?(0,p.GH)("mixins_spaceFull1"):(0,p.GH)("mixins_spaceFull2")},r.next=47,i._getSuperAdmin(q);case 47:Q=r.sent,i.dialog("DialogCorpTeamSpaceFull",Object.assign({},K,Q)),(0,g.f)(Object.assign({},K,Q)),r.next=58;break;case 52:J=null!==(Y=e.response)&&void 0!==Y&&Y.data?e.response.data.result:-1,X=e,ee=(u||{}).faillist,te=void 0===ee?[]:ee,"ErrForbidDownloadLinkFile"===J?X=(0,p.GH)("mixins_spaceFull0==y?X=(0,p.GH)("file_space_SpaceFull13"):"defaultError"!==y&&x?X=y:te.length&&(J=te[0].result,X={groupNumLimit:"".concat((0,p.GH)("plugins_tips_team1")).concat(h.Z[40].team_number).concat((0,p.GH)("plugins_tips_team2"))}[J]||e),o&&i._error(X),setTimeout((function(){(0,f.fV)(!1)}),3e3);case 58:case"end":return r.stop()}}),r)})))()},_isSuperAdmin:function(e){return(0,o.Z)(c().mark((function t(){var i,r,n,s,o;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=!1,t.prev=1,t.next=4,l.plussvr.get("/api/user/userinfo?comp_id=".concat(e));case 4:r=t.sent,n=r.data,s=n.userinfo||{},o=s.roleid,i=1===(parseInt(o)||-1),t.next=12;break;case 10:t.prev=10,t.t0=t.catch(1);case 12:return t.abrupt("return",i);case 13:case"end":return t.stop()}}),t,null,[[1,10]])})))()},_getSuperAdminName:function(e){return(0,o.Z)(c().mark((function t(){var i,r,n;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i="",t.prev=1,t.next=4,l.plussvr.get("/svr/v1/companies/".concat(e,"/super-admin"));case 4:r=t.sent,n=r.data,i=n.name,t.next=11;break;case 9:t.prev=9,t.t0=t.catch(1);case 11:return t.abrupt("return",i);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})))()},_getSuperAdmin:function(e){var t=this;return(0,o.Z)(c().mark((function i(){var r;return c().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return r={},i.next=3,t._isSuperAdmin(e);case 3:if(r.isSuperAdmin=i.sent,r.isSuperAdmin){i.next=8;break}return i.next=7,t._getSuperAdminName(e);case 7:r.superAdminName=i.sent;case 8:return i.abrupt("return",r);case 9:case"end":return i.stop()}}),i)})))()}}}},83436:function(e,t,i){e.exports=i.p+"s1/static/imaic/images/b34d6066951e81500a74.svg"},22908:function(e,t,i){e.exports=i.p+"s1/static/images/cd9edf7d9732b738c534.svg"},55010:function(e,t,i){e.exports=i.p+"s1/static/images/6f1be4cc37fe287156c4.svg"},13428:function(e,t,i){e.exports=i.p+"s1/static/images/565065bfafe3daf36b48.png"}}]);
