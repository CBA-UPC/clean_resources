(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[739],{AOpP:function(e,r,t){"use strict";t.d(r,"a",(function(){return s}));var n=t("QjXU"),o=t("a3FV"),i=t("Wa5Y"),a=t("fNDz");function s(e){var r=e.webUrl,t=e.contentResponseType,s=e.redeemContent,l=e.graphXhrOptions,d=e.queryParams;return Object(n.__awaiter)(this,void 0,void 0,(function(){var e,u,c;return Object(n.__generator)(this,(function(n){if(!r||!t)throw new Error("Invalid params passed");if(!l)return[2,Promise.reject("Invalid graphXhrOptions")];if(!(e=function(e){try{var r=e.replace(/[,@+$#]/g,();r=(r=encodeURIComponent(r).replace(/%([0-9A-F]{2})/g,()).replace(/#/g,"%23");for(var t=window.btoa(r),n=t.length-1;"="===t.charAt(n);)--n;var o=t.slice(0,n+1).replace(/\+/g,"-").replace(/\//g,"_");return"shares/u!".concat(o,"/driveItem")}catch(e){return}}(r)))throw new Error("Invalid shares url");return u=Object(a.a)(l.graphApiRoot,"".concat(e).concat("blob"===t?"/content":""),!1,d),c={method:"GET",headers:{prefer:s?"redeemSharingLink":""},responseType:t||"json"},[2,Object(i.a)(o.a.OneDriveGraphSharesRequest,"OneDrive_Graph_Shares",u,c,l.jwtAuthEnabled,l.getAccessToken,l.officeApiRoot,l.correlationId,"Graph").then((function(e){if(!e||!e.ok||void 0===e.data)throw new Error((null==e?void 0:e.statusText)||"Graph Shares API error");return e.data}))]}))}))}},mXka:function(e,r,t){"use strict";t.r(r),t.d(r,"convertContentToPdf",();var n=t("QjXU"),o=t("So0z"),i=t("Ix9F"),a=t("g46F"),s=t("MJsD"),l=t("6ib3"),d=t("gCKw"),u=t("xvrq"),c=t("d1AP"),p=t("kRy3"),h=t("/DG8"),f=t("AOpP"),I=t("lw5l"),v=function(e){var r=e.driveId,t=e.format,o=e.shouldFetchSharesApiItem,i=e.itemId,a=e.graphXhrOptions,s=e.sharePointIds,l=e.webUrl;return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return l&&o?[4,Object(f.a)({webUrl:l,contentResponseType:"blob",redeemContent:!0,graphXhrOptions:a,queryParams:{format:t}})]:[3,2];case 1:return[2,n.sent()];case 2:return[4,Object(I.a)({contentResponseType:"blob",driveId:r,isContentRequest:!0,itemId:i,graphXhrOptions:a,queryParams:(e={},e.format=t,e),sharePointIds:s})];case 3:return[2,n.sent()]}}))}))},b=[l.a.Word,l.a.Excel,l.a.PowerPoint],m=function(e,r,f){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var I,m,w,g,y,U,O,E,j,P,T,_,C,F,S,x,A,R,M,X,k,q,G,D,N,W,B,J;return Object(n.__generator)(this,(function(z){switch(z.label){case 0:return[4,Object(s.a)()];case 1:return I=z.sent(),[4,Object(h.a)()];case 2:return m=z.sent(),w=void 0,e.useSelection?[4,Object(p.a)({id:"getSelectionConvertContentToPdfInternal",type:o.a.SelectFiles,payload:{target:i.b.Content}},r,f)]:[3,4];case 3:return g=z.sent(),(y=null===(D=g.resultEntity)||void 0===D?void 0:D.result)&&0!==y.length?(y=y.filter(())&&0!==y.length?(((U=y[0]).isSharePointFile||U.isOneDriveForBusinessFile)&&U.docId&&U.driveId&&U.extension&&U.fileName&&(w={driveId:U.driveId,format:"pdf",isRedeemed:!!U.url,originalFileExtension:U.extension,originalFileNameWithoutExtension:U.fileName,itemId:U.docId,url:U.webUrl,sharePointIds:U.isOneDriveForBusinessFile?void 0:U.sharepointIds?{listId:U.sharepointIds.listId,listItemId:U.sharepointIds.listItemId,siteUrl:U.sharepointIds.siteUrl,siteId:U.sharepointIds.siteId,listItemUniqueId:U.sharepointIds.listItemUniqueId,webId:U.sharepointIds.webId}:void 0}),[3,5]):[2,{result:a.a.Error,resultType:"errorInvalidPayload"}]:[2,{result:a.a.Error,resultType:"errorMissingSelection"}];case 4:w=e,z.label=5;case 5:if(!w)return[2,{result:a.a.Error,resultType:"errorInvalidPayload"}];if(O=w.driveId,E=w.isRedeemed,j=w.itemId,P=w.format,T=w.originalFileNameWithoutExtension,_=w.sharePointIds,!(C=w.url))return[2,{result:a.a.Error,resultType:"errorInvalidPayload"}];F=void 0,z.label=6;case 6:return z.trys.push([6,8,,9]),[4,v({driveId:O,itemId:j,webUrl:C,format:P,sharePointIds:_,shouldFetchSharesApiItem:!E,graphXhrOptions:m})];case 7:return F=z.sent(),[3,9];case 8:return z.sent(),[2,{result:a.a.Error,resultType:"errorExecution"}];case 9:return F?(S=P,x=new File([F],"".concat(T,".").concat(S),{type:F.type}),[4,t.e(730).then(t.bind(null,"/1bu"))]):[2,{result:a.a.Error,resultType:"errorExecution"}];case 10:return A=z.sent(),R=A.executeUploadFlow,M=A.fetchUploadConfig,[4,Object(d.a)()];case 11:return X=z.sent(),[4,M()];case 12:return(k=z.sent())?[4,R({componentContext:I,featureGates:X,fileUploadState:{sequenceNumber:0,file:x,uploadStatus:c.d.Started,cancellationToken:Object(u.a)(),telemetry:{area:"ContentActions",source:c.c.Unknown}},graphXhrOptions:m,uploadConfig:k})]:[2,{result:a.a.Error,resultType:"errorExecution"}];case 13:return(q=z.sent()).error?[2,{result:a.a.Error,resultType:"errorExecution"}]:(G=[],q.fileUrlModel&&G.push({app:"",attribution:null!==(N=q.fileUrlModel.createdByUserGivenName)&&void 0!==N?N:"",docId:null!==(W=q.fileUrlModel.docId)&&void 0!==W?W:"",downloadUrl:q.fileUrlModel.downloadUrl,driveId:q.fileUrlModel.driveId,extension:S,fileType:l.a.Pdf,id:null!==(B=q.fileUrlModel.docId)&&void 0!==B?B:"",title:null!==(J=q.fileUrlModel.name)&&void 0!==J?J:"",url:q.fileUrlModel.webUrl,webUrl:q.fileUrlModel.webUrl}),[2,{result:a.a.Success,resultType:"converted",resultEntity:Object(n.__assign)(Object(n.__assign)({},f),{entity:i.b.Content,result:G})}])}}))}))}}}]);
//# sourceMappingURL=739.53de7b661b96ccf47da3.chunk.v7.js.map