!this,function(ot){"use strict";try{!function(){ar t=e(ot),r=var f=,s="FirebaseError",a=(u,o=Error),u);ar c=(h.prototype.create=h);ar v=/\{\$([^}]+)}/g,g=(b.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},b.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},b.prototype.setServiceProps=function(e){return this.serviceProps=e,this},b.prototype.setInstanceCreatedCallback=b);n C(e){this._index=e}unction _(e){this._store=e}_index",["name","keyPath","multiEntry","unique"]),k(C,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),I(C,"_index",IDBIndex,["openCursor","openKeyCursor"]),m(T,"_cursor",["direction","key","primaryKey","value"]),k(T,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(,_.prototype.createIndex=function(){return new C(this._store.createIndex.apply(this._store,arguments))},_.prototype.index=function(){return new C(this._store.index.apply(this._store,arguments))},m(_,"_store",["name","keyPath","indexNames","autoIncrement"]),k(_,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),I(_,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),S(_,"_store",IDBObjectStore,["deleteIndex"]),P.prototype.objectStore=function(){return new _(this._tx.objectStore.apply(this._tx,arguments))},m(P,"_tx",["objectStoreNames","mode"]),S(P,"_tx",IDBTransaction,["abort"]),D.prototype.createObjectStore=function(){return new _(this._db.createObjectStore.apply(this._db,arguments))},m(D,"_db",["name","version","objectStoreNames"]),S(D,"_db",IDBDatabase,["deleteObjectStore","close"]),j.prototype.transaction=m(j,"_db",["name","version","objectStoreNames"]),S(j,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(,[C,_].forEach(;var M="0.4.28",K=1e4,x="w:"+M,N="FIS_v2",A="https://firebaseinstallations.googleapis.com/v1",q=36e5,R=((R={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',R["not-registered"]="Firebase Installation is not registered.",R["installation-not-found"]="Firebase Installation not found.",R["request-failed"]='{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',R["app-offline"]="Could not process request. Application offline.",R["delete-pending-registration"]="Can't delete installation while there is a pending registration request.",R),B=new c("installations","Installations",R);unction V(e){e=e.projectId;return A+"/projects/"+e+"/installations"}ion G(t){return new Promise(function(e){setTimeout(e,t)})}var z=/^[cdef][\w-]{21}$/,J="";function Y(){try{var e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;var t=function(e){return btoa(String.fromCharCode.apply(String,i([],n(e)))).replace(/\+/g,"-").replace(/\//g,"_")}(e).substr(0,22);return z.test(t)?t:J}catch(e){return J}}ar Q=new Map;r te=null;r ie,oe="firebase-installations-database",se=1,ae="firebase-installations-store",ue=null;function ce(){return ue=ue||O(oe,se,function(e){0===e.oldVersion&&e.createObjectStore(ae)})}ction de(i){return p(this,void 0,void 0,function(){var t,n,r;return d(this,function(e){switch(e.label){case 0:return[4,pe(i,function(e){e=ve(e||{fid:Y(),registrationStatus:0}),e=function(e,t){{if(0!==t.registrationStatus)return 1===t.registrationStatus?{installationEntry:t,registrationPromise:e)}:{installationEntry:t};if(!navigator.onLine){var n=Promise.reject(B.create("app-offline"));return{installationEntry:t,registrationPromise:n}}t={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},e=function(r,i){return p(this,void 0,void 0,function(){var t,n;return d(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,7]),[4,r,i)];case 1:return t=e.sent(),[2,le(r,t)];case 2:return L(n=e.sent())&&409===n.customData.serverCode?[4,fe(r)]:[3,4];case 3:return e.sent(),[3,6];case 4:return[4,le(r,{fid:i.fid,registrationStatus:0})];case 5:e.sent(),e.label=6;case 6:throw n;case 7:return[2]}})})}(e,t);return{installationEntry:t,registrationPromise:e}}}(i,e);return t=e.registrationPromise,e.installationEntry})];case 1:return(n=e.sent()).fid!==J?[3,3]:(r={},[4,t]);case 2:return[2,(r.installationEntry=e.sent(),r)];case 3:return[2,{installationEntry:n,registrationPromise:t}]}})})}ction be(i,o){return void 0===o&&(o=!1),p(this,void 0,void 0,function(){var r,t,n;return d(this,function(e){switch(e.label){case 0:return[4,pe(i.appConfig,function(e){if(!we(e))throw B.create("not-registered");var t,n=e.authToken;if(o||2!==(t=n).requestStatus||t)){if(1===n.requestStatus)return r=i,o),e;if(!navigator.onLine)throw B.create("app-offline");n=(t=e,n={requestStatus:1,requestTime:Date.now()},f(f({},t),{authToken:n}));return r=i,n),n}return e})];case 1:return t=e.sent(),r?[4,r]:[3,3];case 2:return n=e.sent(),[3,4];case 3:n=t.authToken,e.label=4;case 4:return[2,n]}})})}ion Ie(e){return B.create("missing-app-config-values",{valueName:e})}(ie=t.default).INTERNAL.registerComponent(new g("installations","PUBLIC")),ie.registerVersion("@firebase/installations",M);var Ce,R=((R={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',R["only-available-in-window"]="This method is available in a Window context.",R["only-available-in-sw"]="This method is available in a service worker context.",R["permission-default"]="The notification permission was not granted and dismissed instead.",R["permission-blocked"]="The notification permission was not granted and blocked instead.",R["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",R["failed-service-worker-registration"]="We are unable to register the default service worker. {$browserErrorMessage}",R["token-subscribe-failed"]="A problem occurred while subscribing the user to FCM: {$errorInfo}",R["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",R["token-unsubscribe-failed"]="A problem occurred while unsubscribing the user from FCM: {$errorInfo}",R["token-update-failed"]="A problem occurred while updating the user from FCM: {$errorInfo}",R["token-update-no-token"]="FCM returned no token when updating the user to push.",R["use-sw-after-get-token"]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",R["invalid-sw-registration"]="The input to useServiceWorker() must be a ServiceWorkerRegistration.",R["invalid-bg-handler"]="The input to setBackgroundMessageHandler() must be a function.",R["invalid-vapid-key"]="The public VAPID key must be a string.",R["use-vapid-key-after-get-token"]="The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used.",R),Te=new c("messaging","Messaging",R),_e="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Pe="https://fcmregistrations.googleapis.com/v1",De="FCM_MSG",je="google.c.a.c_id";function Oe(e){e=new Uint8Array(e);return btoa(String.fromCharCode.apply(String,i([],n(e)))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}(R=Ce=Ce||{}).PUSH_RECEIVED="push-received",R.NOTIFICATION_CLICKED="notification-clicked";var Ee="fcm_token_details_db",Me=5,Ke="fcm_token_object_Store";ar Ne="firebase-messaging-database",Ae=1,qe="firebase-messaging-store",Re=null; Ge(u,c,l){return p(this,void 0,void 0,function(){var o,s,a;return d(this,function(e){switch(e.label){case 0:if("granted"!==Notification.permission)throw Te.create("permission-blocked");return[4,c,l)];case 1:return a=e.sent(),[4,Le(u)];case 2:return o=e.sent(),s={vapidKey:l,swScope:c.scope,endpoint:a.endpoint,auth:Oe(a.getKey("auth")),p256dh:Oe(a.getKey("p256dh"))},o?[3,3]:[2,Je(u,s)];case 3:if(t=o.subscriptionOptions,n=s.vapidKey===t.vapidKey,r=s.endpoint===t.endpoint,i=s.auth===t.auth,t=s.p256dh===t.p256dh,n&&r&&i&&t)return[3,8];e.label=4;case 4:return e.trys.push([4,6,,7]),[4,Ue(u,o.token)];case 5:return e.sent(),[3,7];case 6:return a=e.sent(),console.warn(a),[3,7];case 7:return[2,Je(u,s)];case 8:return Date.now()>=o.createTime+6048e5?[2,{token:o.token,createTime:Date.now(),subscriptionOptions:s},u,c)]:[2,o.token];case 9:return[2]}var t,n,r,i})})}Qe=(Object.defineProperty(Xe.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),Xe.prototype.setBackgroundMessageHandler=Xe.prototype.onBackgroundMessage=Xe.prototype.getToken=Xe.prototype.deleteToken=Xe.prototype.requestPermission=function(){throw Te.create("only-available-in-window")},Xe.prototype.usePublicVapidKey=function(e){if(null!==this.vapidKey)throw Te.create("use-vapid-key-after-get-token");if("string"!=typeof e||0===e.length)throw Te.create("invalid-vapid-key");this.vapidKey=e},Xe.prototype.useServiceWorker=function(){throw Te.create("only-available-in-window")},Xe.prototype.onMessage=function(){throw Te.create("only-available-in-window")},Xe.prototype.onTokenRefresh=function(){throw Te.create("only-available-in-window")},Xe.prototype.onPush=function(c){return p(this,void 0,void 0,function(){var s,a,u;return d(this,function(e){switch(e.label){case 0:return(u=function(e){e=e.data;if(!e)return null;try{return e.json()}catch(e){return null}}(c))?[4,et()]:(console.debug("FirebaseMessaging: failed to get parsed MessagePayload from the PushEvent. Skip handling the push."),[2]);case 1:return(s=e.sent()).some(?[2,s,u)]:(a=!1,u.notification?[4,((o=f({},(r=u).notification)).data=((i={})[De]=r,i),o))]:[3,3]);case 2:e.sent(),a=!0,e.label=3;case 3:return!0===a&&!1===this.isOnBackgroundMessageUsed?[2]:(this.bgMessageHandler&&(n={from:(t=u).from,collapseKey:t.collapse_key},r=n,(i=t).notification&&(r.notification={},(o=i.notification.title)&&(r.notification.title=o),(o=i.notification.body)&&(r.notification.body=o),(i=i.notification.image)&&(r.notification.image=i)),r=n,(i=t).data&&(r.data=i.data),r=n,(i=t).fcmOptions&&(r.fcmOptions={},(t=i.fcmOptions.link)&&(r.fcmOptions.link=t),(i=i.fcmOptions.analytics_label)&&(r.fcmOptions.analyticsLabel=i)),u=n,"function"==typeof this.bgMessageHandler?this.bgMessageHandler(u):this.bgMessageHandler.next(u)),[4,Ze(1e3)]);case 4:return e.sent(),[2]}var t,n,r,i,o})})},Xe.prototype.onSubChange=Xe.prototype.onNotificationClick=function(s){var a;return p(this,void 0,void 0,function(){var t,n,r,i,o;return d(this,function(e){switch(e.label){case 0:return(t=null===(a=null===(a=s.notification)||void 0===a?void 0:a.data)||void 0===a?void 0:a[De])?s.action?[2]:(s.stopImmediatePropagation(),s.notification.close(),(n=t))?(r=new URL(n,self.location.href),i=new URL(self.location.origin),r.host!==i.host?[2]:[4,r)]):[2]):[2];case 1:return(o=e.sent())?[3,4]:[4,self.clients.openWindow(n)];case 2:return o=e.sent(),[4,Ze(3e3)];case 3:return e.sent(),[3,6];case 4:return[4,o.focus()];case 5:o=e.sent(),e.label=6;case 6:return o?(t.messageType=Ce.NOTIFICATION_CLICKED,t.isFirebaseMessaging=!0,[2,o.postMessage(t)]):[2]}})})},Xe);r tt=(Object.defineProperty(nt.prototype,"app",{get:enumerable:!1,configurable:!0}),nt.prototype.messageEventListener=nt.prototype.getVapidKey=function(){return this.vapidKey},nt.prototype.getSwReg=nt.prototype.getToken=nt.prototype.updateVapidKey=nt.prototype.updateSwReg=nt.prototype.registerDefaultSw=nt.prototype.deleteToken=nt.prototype.requestPermission=nt.prototype.usePublicVapidKey=nt.prototype.useServiceWorker=nt.prototype.onMessage=nt.prototype.setBackgroundMessageHandler=function(){throw Te.create("only-available-in-sw")},nt.prototype.onBackgroundMessage=nt.prototype.onTokenRefresh=nt.prototype.logEvent=nt);{isSupported:it};.default.INTERNAL.registerComponent(new g("messaging","PUBLIC").setServiceProps(R))}.apply(this,arguments)}catch(e){throw console.error(e),new Error("Cannot instantiate firebase-messaging.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-messaging.js.map
