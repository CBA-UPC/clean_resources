(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[164],{"EA+W":function(e,t,n){"use strict";n.r(t),n.d(t,"CreateMenuModuleNgFactory",(function(){return Se}));var l=n("keVe"),i=n("QjXU"),a=n("lUkk"),r=n("laSs"),o=n("Dn7E"),u=n("rTyw"),c=n("f0qX"),s=n("lrJm"),m=n("s+Eq"),p=n("hhzZ"),d=n("BaAg"),h=n("6Po3"),b=n("OWzB"),f=n("7Gwk"),g=n("Bc8L"),v=n("w1PR"),C=n("4/We"),I=n("/I02"),S=n("PBJH"),T=n("+YV+"),y=(n("6VqR"),function(){function e(e,t,n,l,i,a,r,o,u,c,s){this.capabilitiesService=e,this.contextService=t,this.createDocumentService=n,this.eventService=l,this.globalErrorHandler=i,this.instrumentationService=a,this.locService=r,this.localAppLauncherService=o,this.createMenuService=u,this.browserPaintService=c,this.themingService=s,this.createNotebookText=!1,this.createDocumentText=!1,this.componentArea=p.b.Documents,this.createButtonTextStringIndex=0,this.createButtonTextCharacterIndex=0,this.createButtonTextStopCount=0,this.isCreateButtonTextDeleting=!1,this.createButtonTextSet=[this.locService.CreateButtonText,this.locService.CreateButtonTextWord,this.locService.CreateButtonTextPowerPoint]}return e.prototype.ngOnInit=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:this.fluentRefresh=this.capabilitiesService.capabilities.fluentRefresh,this.contextService.isEdgeworth&&(this.componentArea=p.b.Edgeworth),this.createLinkText=this.locService.MruCreateLinkText,this.opened=!1,this.isTenantThemeEnabled=this.themingService.themeShades.pipe(Object(c.a)((function(e){return e.theme&&e.theme.themeType&&("tenant"===e.theme.themeType.toLowerCase()||"user"===e.theme.themeType.toLowerCase())}))),n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,this.createMenuService.createLinksPromise];case 2:return e=n.sent(),this.menuModel={id:"create-menu",items:e,linkAriaLabel:this.locService.MruCreateLinkText,linkAriaDescription:this.locService.MruCreateLinkAriaLabelDescription,linkCssClass:this.withAnimation?"create-button-animation":this.fluentRefresh?"generic-button--fluentvnext generic-button--fluentvnext--primary":"generic-button ms-bgc-tp ms-fcl-w generic-button--fluent generic-button--fluent--primary ms-bgc-w-h ms-bgc-w-a ms-fcl-tp-h ms-fcl-tp-a",openCssClass:this.withAnimation?"is-opened":"",themeCssClass:this.withAnimation?"is-theme-enabled ms-bgc-tp ms-bcl-tp":"",rightAligned:!this.withAnimation,centerAligned:this.withAnimation,hostComponentArea:this.componentArea},this.createLinks=e,this.createLinks&&this.createLinks.length&&this.instrumentCreateMenuImpression(),this.withAnimation&&this.registerAnimation(),[3,5];case 3:return t=n.sent(),this.globalErrorHandler.handleError(t,"n5stU"),[3,5];case 4:return this.signalReady(),[7];case 5:return[2]}}))}))},e.prototype.signalReady=function(){var e=this;this.browserPaintService.runAfterPaint((function(){e.eventService.broadcastEvent({name:"createButtonReady",args:[]})}))},e.prototype.onToggleMenu=function(e){this.eventService.broadcastEvent({name:"createButtonClick",args:[]}),this.instrumentCreateMenuToggle(e),this.opened!==e&&(this.opened=e,this.withAnimation&&!this.opened&&this.dropdownMenu.onCloseMenu(!0))},e.prototype.onSelectItem=e.prototype.createDocument=function(e,t){var l=this,i=d.b[e.workload.FileType].toLowerCase(),a=function(n){var a="_blank"===l.contextService.sharedContext.defaultLinkTarget;a||l.instrumentCreateMenuItemClick(e.getId(),e.workload.Referral,t.index,"Web",i),l.createDocumentService.createItem(e.creationFileType,e.url,null,(function(r){var o="Error"===r.type||"CreatePending"===r.type?"":e.workload.Referral;a&&l.instrumentCreateMenuItemClick(e.getId(),o,t.index,r.platform,i),l.instrumentCreateMenuItemClickResult(e.getId(),t.index,r,n,i)}))};if(this.capabilitiesService.capabilities.pwaEnabled&&e.workload.FileType===d.b.Excel)return this.capabilitiesService.capabilities.contentLauncherEnabled?void Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(n){n.launchApp({action:"OpenDocument",appName:d.b[d.b.Excel],url:""}).then((function(n){if(n.success)return l.instrumentCreateMenuItemClick(e.getId(),e.workload.Referral,t.index,"Native",i),void l.instrumentCreateMenuItemClickResult(e.getId(),t.index,{type:"GoToLanding",latency:0},2,i);a(2)}))})):void this.localAppLauncherService.launchOfficeApp(d.b[d.b.Excel],"",null,!0).then((function(n){if(n)return l.instrumentCreateMenuItemClick(e.getId(),e.workload.Referral,t.index,"Native",i),void l.instrumentCreateMenuItemClickResult(e.getId(),t.index,{type:"GoToLanding",latency:0},2,i);a(2)}));a(0)},e.prototype.instrumentCreateMenuToggle=function(e){var t=e?"Open":"Close",n=this.getInstrumentationParams("create-menu",t);this.instrumentationService.logClickEvent("Create_Menu_Toggle",n.ElementId,this.componentArea,null,null,n),Object(a.a)({eventName:"Create_Menu_Toggle",id:"create-modal",area:"CreateModal",subArea:"CreateToggle",result:t,target:"Other"})},e.prototype.instrumentCreateMenuImpression=function(){var e=this.getInstrumentationParams("create-menu");e.Distribution=this.createLinks?this.createLinks.map((function(e){return e.workload?e.workload.Id:e.getId()})).reduce((function(e,t,n){return e+(0===n?"":";")+t}),""):"",this.instrumentationService.logImpressionEvent("Create_Menu_Impression",e),Object(r.a)({eventName:"Create_Menu",area:"CreateModal",distribution:this.createLinks.map(().toString(),totalSize:this.createLinks.length})},e.prototype.instrumentCreateMenuItemClick=function(e,t,n,l,i){var r=this.getInstrumentationParams();r.Index=n.toString(),r.ItemId=this.getCreateMenuItemId(),r.DocumentType=i,this.instrumentationService.logClickEvent("Create_Link_Click",e,this.componentArea,t,l,r),Object(a.a)({eventName:"Create_Link_Click",id:e,area:this.componentArea,subArea:"CreateLinks",result:t?"Refer":"Navigate",target:t?Object(u.a)(t):"Other"})},e.prototype.instrumentCreateMenuItemClickResult=function(e,t,n,l,i){var a,r,u,c,s,m,p={};p.Index=t.toString(),p.ItemId=this.getCreateMenuItemId(),p.ElementId=e,p.Action=n.type,p.Latency=n.latency.toString(),p.Area=this.componentArea,p.DocumentType=i,p.DebugInfo=null!==(a=n.debugInfo)&&void 0!==a?a:"",p.Error=null!==(r=n.errorMsg)&&void 0!==r?r:"",p.HttpCode=null!==(u=n.httpCode)&&void 0!==u?u:"",this.instrumentationService.logGenericEvent("Create_Link_Click_Result",p,[],l),Object(o.a)({featureName:"Create",eventName:"CreateLinkClickResult",area:this.componentArea,params:{ElementId:e,Action:n.type,Latency:n.latency.toString(),DocumentType:i,Index:t.toString(),ItemId:this.getCreateMenuItemId(),SecurityThreshold:l,DebugInfo:null!==(c=n.debugInfo)&&void 0!==c?c:"",Error:null!==(s=n.errorMsg)&&void 0!==s?s:"",HttpCode:null!==(m=n.httpCode)&&void 0!==m?m:""}})},e.prototype.getInstrumentationParams=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null);var n={};return n.ItemCount=this.numDocuments?this.numDocuments.toString():"0",n.RenderSize=this.createLinks?this.createLinks.length.toString():"0",e&&(n.ElementId=this.buttonOrigin?e+"-"+this.buttonOrigin:e),t&&(n.Action=t),n},e.prototype.getCreateMenuItemId=function(){var e="create-menu-item";return this.buttonOrigin?e+"-"+this.buttonOrigin:e},e.prototype.registerAnimation=function(){var e=this;this.createButtonText="",this.contextService.sharedContext.createButtonTextTypingSpeed>0&&(this.timerId=setInterval((,this.contextService.sharedContext.createButtonTextTypingSpeed))},e.prototype.updateCreateButtonText=function(){var e=this.createButtonTextSet[this.createButtonTextStringIndex%this.createButtonTextSet.length],t=e.length;if(this.isCreateButtonTextDeleting)this.createButtonTextCharacterIndex--,this.createButtonText=e.slice(0,this.createButtonTextCharacterIndex),0===this.createButtonTextCharacterIndex&&(this.createButtonTextStopCount<this.contextService.sharedContext.createButtonTextEmptyStopCount?(this.createButtonTextStopCount++,this.createButtonTextCharacterIndex++):(this.createButtonTextStopCount=0,this.isCreateButtonTextDeleting=!1,this.createButtonTextStringIndex++));else if(this.createButtonTextCharacterIndex++,this.createButtonText=e.slice(0,this.createButtonTextCharacterIndex),this.createButtonTextCharacterIndex===t+1){if(this.createButtonTextStringIndex===this.createButtonTextSet.length)return void clearInterval(this.timerId);this.createButtonTextStopCount<this.contextService.sharedContext.createButtonTextCompleteStopCount?(this.createButtonTextStopCount++,this.createButtonTextCharacterIndex--):(this.createButtonTextStopCount=0,this.isCreateButtonTextDeleting=!0)}},e}()),k=y,x=),w=n("fYis"),_=n("pzhl"),B=n("PkQn"),L=n("TOqr"),A=n("tuJr"),E=n("5FMq"),M=function(){eturn e.prototype.ngOnInit=function(){this.documentIcon=d.a.documentIconFromType(this.handler.app,"20x20"),this.thumbnailFallbackIcon=d.a.documentIconFromType(this.handler.app,"64x64")},e.prototype.onTemplateClick=function(e){var t=this;null==e||e.preventDefault(),this.handler.handleClick((function(e){var n,l,i,r,c,s;!function(e,n){var l={};l.Index=t.index.toString(),l.DocumentType=t.handler.tileConfig.appName,l.TemplateType=t.handler.templateType;var i=e?d.a.referralFromFileType(t.handler.app):"";t.instrumentationService.logClickEvent("Template_Click",t.handler.assetId,p.b.CreateModal,i,n,l),Object(a.a)({eventName:"Template_Click",id:t.handler.assetId,area:p.b.CreateModal,subArea:"Templates",result:i?"Refer":"Navigate",target:i?Object(u.a)(i):"Other"})}("Error"!==e.type&&"CreatePending"!==e.type,e.platform);var m={};m.Action=e.type,m.Latency=e.latency.toString(),m.Index=t.index.toString(),m.DocumentType=t.handler.tileConfig.appName,m.ElementId=t.handler.assetId,m.TemplateType=t.handler.templateType,m.Area=p.b.CreateModal,m.DebugInfo=null!==(n=e.debugInfo)&&void 0!==n?n:"",m.Error=null!==(l=e.errorMsg)&&void 0!==l?l:"",m.HttpCode=null!==(i=e.httpCode)&&void 0!==i?i:"",t.instrumentationService.logGenericEvent("Template_Click_Result",m),Object(o.a)({featureName:"Create",eventName:"TemplateClickResult",area:"CreateModal",params:{ElementId:t.handler.assetId,Action:e.type,Latency:e.latency.toString(),DocumentType:t.handler.tileConfig.appName,TemplateType:t.handler.templateType,Index:t.index.toString(),DebugInfo:null!==(r=e.debugInfo)&&void 0!==r?r:"",Error:null!==(c=e.errorMsg)&&void 0!==c?c:"",HttpCode:null!==(s=e.httpCode)&&void 0!==s?s:""}})}))},e.prototype.onTemplateMouseEnter=function(){this.templateMouseEnter.emit(!0)},e.prototype.onTemplateKeydown=e}(),D=l.Fb({encapsulation:2,styles:[],data:{}});unction H(e){return l.jc(0,[(e()(),l.Hb(0,0,null,null,0,"img",[["class","document-card__thumbnail"]],[[8,"src",4],[8,"alt",0]],null,null,null,null))],null,(function(e,t){var n=t.component;e(t,0,0,n.handler.tileConfig.thumbnail,l.Ob(1,"",n.handler.tileConfig.title,""))}))}function N(e){return l.jc(0,[(e()(),l.Hb(0,0,null,null,2,"div",[["class","document-card__thumbnail-placeholder"]],null,null,null,null,null)),(e()(),l.Hb(1,0,null,null,1,"div",[],null,null,null,null,null)),l.Gb(2,278528,null,0,L.i,[l.x,l.y,l.o,l.K],{ngClass:[0,"ngClass"]},null)],(function(e,t){e(t,2,0,t.component.thumbnailFallbackIcon)}),null)}function U(e){return l.jc(0,[l.cc(671088640,1,{templateItem:0}),l.cc(671088640,2,{seeMoreLinkItem:0}),(e()(),l.Hb(2,0,null,null,14,"div",[["tabindex","-1"]],null,null,null,null,null)),(e()(),l.Hb(3,0,[[1,0],["templateItem",1]],null,13,"a",[["class","list-item--shadowed create-modal__template-item"],["data-clicklog","custom"],["href","#"],["tabindex","-1"]],[[8,"title",0],[1,"aria-label",0]],[[null,"click"],[null,"mouseenter"],[null,"keydown"]],(function(e,t,n){var l=!0,i=e.component;return"click"===t&&(l=!1!==i.onTemplateClick(n)&&l),"mouseenter"===t&&(l=!1!==i.onTemplateMouseEnter()&&l),"keydown"===t&&(l=!1!==i.onTemplateKeydown(n)&&l),l}),null,null)),(e()(),l.Hb(4,0,null,null,7,"div",[["class","document-card__thumbnail-container"]],null,null,null,null,null)),(e()(),l.qb(16777216,null,null,1,null,F)),l.Gb(6,16384,null,0,L.k,[l.W,l.S],{ngIf:[0,"ngIf"]},null),(e()(),l.Hb(7,0,null,null,4,"div",[["class","document-card__thumbnail-wrapper"]],null,null,null,null,null)),(e()(),l.qb(16777216,null,null,1,null,H)),l.Gb(9,16384,null,0,L.k,[l.W,l.S],{ngIf:[0,"ngIf"]},null),(e()(),l.qb(16777216,null,null,1,null,N)),l.Gb(11,16384,null,0,L.k,[l.W,l.S],{ngIf:[0,"ngIf"]},null),(e()(),l.Hb(12,0,null,null,4,"div",[["class","create-modal__template-item-bottom-wrapper"]],null,null,null,null,null)),(e()(),l.Hb(13,0,null,null,1,"div",[["class","create-modal__template-item-title"]],null,null,null,null,null)),(e()(),l.gc(14,null,["",""])),(e()(),l.Hb(15,0,null,null,1,"div",[["class","create-modal__template-item-icon"]],null,null,null,null,null)),l.Gb(16,278528,null,0,L.i,[l.x,l.y,l.o,l.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null)],(function(e,t){var n=t.component;e(t,6,0,n.handler.tileConfig.thumbnail),e(t,9,0,n.handler.tileConfig.thumbnail),e(t,11,0,!n.handler.tileConfig.thumbnail),e(t,16,0,"create-modal__template-item-icon",n.documentIcon)}),(function(e,t){var n=t.component;e(t,3,0,n.handler.tileConfig.title,n.handler.tileConfig.ariaLabel),e(t,14,0,n.handler.tileConfig.title)}))}l.Db("ohp-create-modal-template-item",M,(function(e){return l.jc(0,[(e()(),l.Hb(0,0,null,null,1,"ohp-create-modal-template-item",[],null,null,null,U,D)),l.Gb(1,114688,null,0,M,[p.a],null,null)],(function(e,t){e(t,1,0)}),null)}),{handler:"handler",index:"index"},{templateMouseEnter:"templateMouseEnter",templateKeydown:"templateKeydown"},[]);var G=n("zvoD"),O=n("hZW2"),j=n("vSbP"),P=n("idgT"),W=n("clUe"),R=n("24t9"),q=(n("0nFl"),function(){function e(e,t,n,i,a,r,o,u){var c=this;this.capabilitiesService=e,this.documentService=t,this.eventService=n,this.instrumentationService=i,this.locService=a,this.templateCreationHandlerFactory=r,this.templatesConfigService=o,this.templatesService=u,this.backgroundStyle={},this.selectItem=new l.q,this.closeModal=new l.q,this.createSectionHeader=this.locService.CreateModalCreateSectionHeader,this.templatesSectionHeader=this.locService.CreateModalTemplatesSectionHeader,this.closeButtonAriaLabel=this.locService.CreateModalCloseButtonAriaLabel,this.eventSubscription=this.eventService.events.withScope(1).pipe(Object(G.a)(()).subscribe(()}return e.prototype.ngOnInit=function(){var e=this;this.instrumentCreateModalImpression(this.createLinks),this.templatesConfigService.config.enterpriseTemplatesEnabled&&!this.capabilitiesService.capabilities.pwaEnabled&&this.templatesService.getEnterpriseTemplatesLibraries().then((function(t){(null==t?void 0:t.length)&&(e.driveId=t[0].DriveId,e.updateEnterpriseTemplates())})),this.isFluidEnabled=this.capabilitiesService.capabilities.fluidCreateNewEnabled||this.capabilitiesService.capabilities.fluidCreateAbpEnabled},e.prototype.ngOnDestroy=e.prototype.ngAfterViewInit=e.prototype.close=e.prototype.getIdForItem=e.prototype.handleKey=function(t,n){var l=R.a.getKey(t);if(-1!==e.expectedKeys.indexOf(l)){t.preventDefault();var i=this.createLinkItems.length+this.templateItems.length+1;switch(l){case 3:this.close();break;case 2:if(0===n&&this.close(),n<=this.createLinkItems.length){var a=n-1;this.onSelectItem(this.createLinks[a],a,t)}else if(n<=this.createLinkItems.length+this.templateItems.length){var r=n-1-this.createLinkItems.length;this.templateItems.toArray()[r].templateItem.nativeElement.onTemplateClick()}break;case 1:this.setActiveIndex(t.shiftKey?(n-1+i)%i:(n+1)%i);break;case 5:this.setActiveIndex((n+1)%i);break;case 4:this.setActiveIndex(n>0?n-1:i-1)}}},e.prototype.setActiveIndex=function(e){0===e?this.closeButton.nativeElement.focus():e<=this.createLinkItems.length?this.createLinkItems.toArray()[e-1].nativeElement.focus():e<=this.createLinkItems.length+this.templateItems.length&&this.templateItems.toArray()[e-1-this.createLinkItems.length].templateItem.nativeElement.focus()},e.prototype.trackById=e.prototype.isFluidItem=e.prototype.onSelectItem=function(e,t,n){this.selectItem.emit({item:e,index:t,nativeDomEvent:n}),n.preventDefault(),this.close()},e.prototype.trackTemplateByAssetId=e.prototype.instrumentCreateModalImpression=function(e){var t={};t.Distribution=e.map(().toString(),t.RenderSize=e.length.toString(),this.instrumentationService.logImpressionEvent("Create_Modal_Impression",t)},e.prototype.updateBackgroundHeight=function(){var e=this.documentService.nativeDocument.getElementById("officeHome__wrapper").getBoundingClientRect().height;this.backgroundStyle.height=e.toString()+"px"},e.prototype.updateEnterpriseTemplates=function(){var e=this;this.enterpriseTemplatesDataSubscription&&this.enterpriseTemplatesDataSubscription.unsubscribe();var t=this.templatesService.getEnterpriseTemplates(this.driveId,"",!0);this.enterpriseTemplatesDataSubscription=t.results.subscribe((function(t){e.displayTemplates=t.Template.filter((function(e){return d.a.fileTypeFromExtension(d.a.getFileExtension(e.Title))!==d.b.None})).map((function(t){var n=Object(i.__assign)({},t),l=d.a.fileTypeFromExtension(d.a.getFileExtension(n.Title));return n.Title=d.a.fileNameWithoutExtension(n.Title),e.createTemplateHandler(l,n,e.driveId)})).slice(0,6)}))},e.prototype.createTemplateHandler=function(e,t,n){return n?this.templateCreationHandlerFactory.createCreateNewFromEnterpriseTemplateCreationHandler(e,t,n):this.templateCreationHandlerFactory.createCreateNewFromTemplateCreationHandler(e,t)},e.expectedKeys=[1,2,3,4,5],e}()),z=l.Fb({encapsulation:2,styles:[],data:{}});function K(e){return l.jc(0,[(e()(),l.Hb(0,0,null,null,2,"ohp-icon-font",[],null,null,null,_.b,_.a)),l.Gb(1,638976,null,0,B.a,[C.a],{cssClass:[0,"cssClass"],iconFontCssClass:[1,"iconFontCssClass"],iconFontName:[2,"iconFontName"],size:[3,"size"],style:[4,"style"]},null),l.Zb(2,{color:0})],(function(e,t){var n=t.component,i=l.Ob(1,"create-modal__icon ",n.isFluidItem(t.parent.context.$implicit)?"create-modal__icon--fluid":"",""),a=t.parent.context.$implicit.workload.IconUnicodeCodepointCssClass,r=t.parent.context.$implicit.workload.IconFont,o=n.isFluidItem(t.parent.context.$implicit)?38:40,u=e(t,2,0,t.parent.context.$implicit.workload.Color);e(t,1,0,i,a,r,o,u)}),null)}function $(e){return l.jc(0,[(e()(),l.Hb(0,0,null,null,1,"div",[["class","create-modal__default-icon"]],null,null,null,null,null)),l.Gb(1,278528,null,0,L.i,[l.x,l.y,l.o,l.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null)],(,null)}function Z(e){return l.jc(0,[(e()(),l.Hb(0,0,[[2,0],["createLinkItem",1]],null,10,"li",[["class","create-modal__item"],["role","menuitem"],["tabindex","-1"]],[[1,"aria-label",0],[8,"id",0]],[[null,"click"],[null,"mouseenter"],[null,"keydown"]],(function(e,t,n){var l=!0,i=e.component;return"click"===t&&(l=!1!==i.onSelectItem(e.context.$implicit,e.context.index,n)&&l),"mouseenter"===t&&(l=!1!==i.setActiveIndex(e.context.index+1)&&l),"keydown"===t&&(l=!1!==i.handleKey(n,e.context.index+1)&&l),l}),null,null)),l.Gb(1,278528,null,0,L.i,[l.x,l.y,l.o,l.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),l.Zb(2,{"create-modal__item--fluid":0}),(e()(),l.qb(16777216,null,null,1,null,K)),l.Gb(4,16384,null,0,L.k,[l.W,l.S],{ngIf:[0,"ngIf"]},null),(e()(),l.qb(16777216,null,null,1,null,$)),l.Gb(6,16384,null,0,L.k,[l.W,l.S],{ngIf:[0,"ngIf"]},null),(e()(),l.Hb(7,0,null,null,1,"div",[["class","create-modal__item-title"]],null,null,null,null,null)),(e()(),l.gc(8,null,["",""])),(e()(),l.Hb(9,0,null,null,1,"div",[["class","create-modal__item-subtitle"]],null,null,null,null,null)),(e()(),l.gc(10,null,["",""]))],(function(e,t){var n=e(t,2,0,t.component.isFluidEnabled);e(t,1,0,"create-modal__item",n),e(t,4,0,t.context.$implicit.workload),e(t,6,0,!t.context.$implicit.workload)}),(function(e,t){e(t,0,0,t.context.$implicit.ariaLabel,t.component.getIdForItem(t.context.$implicit)),e(t,8,0,t.context.$implicit.fileTypeName),e(t,10,0,t.context.$implicit.appName)}))}function J(e){return l.jc(0,[(e()(),l.Hb(0,0,null,null,1,"ohp-create-modal-template-item",[["tabindex","-1"]],null,[[null,"templateMouseEnter"],[null,"templateKeydown"]],(function(e,t,n){var l=!0,i=e.component;return"templateMouseEnter"===t&&(l=!1!==i.setActiveIndex(e.context.index+i.createLinks.length+1)&&l),"templateKeydown"===t&&(l=!1!==i.handleKey(n,e.context.index+i.createLinks.length+1)&&l),l}),U,D)),l.Gb(1,114688,[[3,4]],0,M,[p.a],{handler:[0,"handler"],index:[1,"index"]},{templateMouseEnter:"templateMouseEnter",templateKeydown:"templateKeydown"})],(,null)}function Q(e){return l.jc(0,[(e()(),l.Hb(0,0,null,null,5,"div",[["class","create-modal__section"]],null,null,null,null,null)),(e()(),l.Hb(1,0,null,null,1,"h3",[["class","create-modal__section-title"]],null,null,null,null,null)),(e()(),l.gc(2,null,["",""])),(e()(),l.Hb(3,0,null,null,2,"div",[["class","create-modal__templates-container"]],null,null,null,null,null)),(e()(),l.qb(16777216,null,null,1,null,J)),l.Gb(5,278528,null,0,L.j,[l.W,l.S,l.x],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null)],(,(function(e,t){e(t,2,0,t.component.templatesSectionHeader)}))}function V(e){return l.jc(0,[l.cc(671088640,1,{closeButton:0}),l.cc(671088640,2,{createLinkItems:1}),l.cc(671088640,3,{templateItems:1}),(e()(),l.Hb(3,0,null,null,1,"div",[["class","create-modal__background"],["id","create-modal-background"]],null,[[null,"click"]],(,null,null)),l.Gb(4,278528,null,0,L.n,[l.o,l.y,l.K],{ngStyle:[0,"ngStyle"]},null),(e()(),l.Hb(5,0,null,null,13,"div",[["class","create-modal width-restrictor width-restrictor--responsive"],["id","create-modal"],["role","menu"]],null,null,null,null,null)),(e()(),l.Hb(6,0,[[1,0],["closeButton",1]],null,2,"span",[["class","create-modal__close"],["id","create-modal-close"],["role","button"],["tabindex","-1"]],[[1,"aria-label",0],[8,"title",0]],[[null,"click"],[null,"mouseenter"],[null,"keydown"]],(function(e,t,n){var l=!0,i=e.component;return"click"===t&&(l=!1!==i.close()&&l),"mouseenter"===t&&(l=!1!==i.setActiveIndex(0)&&l),"keydown"===t&&(l=!1!==i.handleKey(n,0)&&l),l}),null,null)),(e()(),l.Hb(7,0,null,null,1,"ohp-icon-font",[["iconFontName","X"]],null,null,null,_.b,_.a)),l.Gb(8,638976,null,0,B.a,[C.a],{iconFontName:[0,"iconFontName"]},null),(e()(),l.Hb(9,0,null,null,7,"div",[["class","create-modal__section"]],null,null,null,null,null)),(e()(),l.Hb(10,0,null,null,1,"h3",[["class","create-modal__section-title"]],null,null,null,null,null)),(e()(),l.gc(11,null,["",""])),(e()(),l.Hb(12,0,null,null,4,"ul",[],null,null,null,null,null)),l.Gb(13,278528,null,0,L.i,[l.x,l.y,l.o,l.K],{ngClass:[0,"ngClass"]},null),l.Zb(14,{"create-modal__list":0,"create-modal__list--fluid":1}),(e()(),l.qb(16777216,null,null,1,null,Z)),l.Gb(16,278528,null,0,L.j,[l.W,l.S,l.x],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null),(e()(),l.qb(16777216,null,null,1,null,Q)),l.Gb(18,16384,null,0,L.k,[l.W,l.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,4,0,n.backgroundStyle),e(t,8,0,"X");var l=e(t,14,0,!n.isFluidEnabled,n.isFluidEnabled);e(t,13,0,l),e(t,16,0,n.createLinks,n.trackById),e(t,18,0,null==n.displayTemplates?null:n.displayTemplates.length)}),()}l.Db("ohp-create-modal",q,(function(e){return l.jc(0,[(e()(),l.Hb(0,0,null,null,1,"ohp-create-modal",[],null,null,null,V,z)),l.Gb(1,4440064,null,0,q,[C.a,O.a,f.a,p.a,S.a,j.a,P.a,W.a],null,null)],(function(e,t){e(t,1,0)}),null)}),{createLinks:"createLinks"},{selectItem:"selectItem",closeModal:"closeModal"},[]);var X=l.Fb({encapsulation:2,styles:[],data:{}});function Y(e){return l.jc(0,[(e()(),l.Hb(0,0,null,null,1,"div",[["ohpMenuLinkContent",""]],null,null,null,null,null)),l.Gb(1,16384,null,0,m.c,[],null,null)],null,null)}function ee(e){return l.jc(0,[(e()(),l.Hb(0,0,null,null,1,"ohp-icon-font",[["cssClass","create-button__create-icon"],["iconFontName","Add"],["size","15"]],null,null,null,_.b,_.a)),l.Gb(1,638976,null,0,B.a,[C.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null)],(function(e,t){e(t,1,0,"create-button__create-icon","Add","15")}),null)}function te(e){return l.jc(0,[(e()(),l.Hb(0,0,null,null,1,"ohp-icon-font",[["cssClass","create-button__chevron-icon"],["iconFontName","ChevronDown"],["size","10"]],null,null,null,_.b,_.a)),l.Gb(1,638976,null,0,B.a,[C.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null)],(,null)}function ne(e){return l.jc(0,[(e()(),l.Hb(0,0,null,null,9,"div",[["ohpMenuLinkContent",""]],null,null,null,null,null)),l.Gb(1,16384,null,0,m.c,[],null,null),(e()(),l.qb(16777216,null,null,1,null,ee)),l.Gb(3,16384,null,0,L.k,[l.W,l.S],{ngIf:[0,"ngIf"]},null),(e()(),l.Hb(4,0,null,null,3,"span",[],null,null,null,null,null)),l.Gb(5,278528,null,0,L.i,[l.x,l.y,l.o,l.K],{ngClass:[0,"ngClass"]},null),l.Zb(6,{"generic-button__text":0,"generic-create-button__text--fluent":1}),(e()(),l.gc(7,null,["",""])),(e()(),l.qb(16777216,null,null,1,null,te)),l.Gb(9,16384,null,0,L.k,[l.W,l.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,3,0,n.showDropdown);var l=e(t,6,0,!n.fluentRefresh,n.fluentRefresh);e(t,5,0,l),e(t,9,0,n.showDropdown)}),(function(e,t){e(t,7,0,t.component.createLinkText)}))}function le(e){return l.jc(0,[(e()(),l.Hb(0,0,null,null,2,"ohp-icon-font",[["cssClass","menu-item__icon create-menu-item__icon--fluent"]],null,null,null,_.b,_.a)),l.Gb(1,638976,null,0,B.a,[C.a],{cssClass:[0,"cssClass"],iconFontCssClass:[1,"iconFontCssClass"],iconFontName:[2,"iconFontName"],size:[3,"size"],style:[4,"style"]},null),l.Zb(2,{color:0})],(function(e,t){var n=t.parent.context.item.workload.IconUnicodeCodepointCssClass,l=t.parent.context.item.workload.IconFont,i=e(t,2,0,t.parent.context.item.workload.Color);e(t,1,0,"menu-item__icon create-menu-item__icon--fluent",n,l,20,i)}),null)}function ie(e){return l.jc(0,[(e()(),l.Hb(0,0,null,null,1,"ohp-icon-font",[["cssClass","menu-item__icon create-menu-item__icon--fluent ms-fcl-tp"]],null,null,null,_.b,_.a)),l.Gb(1,638976,null,0,B.a,[C.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null)],(function(e,t){e(t,1,0,"menu-item__icon create-menu-item__icon--fluent ms-fcl-tp",t.parent.context.item.icon,20)}),null)}function ae(e){return l.jc(0,[(e()(),l.Hb(0,0,null,null,6,null,null,null,null,null,null,null)),(e()(),l.qb(16777216,null,null,1,null,le)),l.Gb(2,16384,null,0,L.k,[l.W,l.S],{ngIf:[0,"ngIf"]},null),(e()(),l.qb(16777216,null,null,1,null,ie)),l.Gb(4,16384,null,0,L.k,[l.W,l.S],{ngIf:[0,"ngIf"]},null),(e()(),l.Hb(5,0,null,null,1,"div",[["class","list-item__title menu-item__title ms-fcl-np"]],null,null,null,null,null)),(e()(),l.gc(6,null,["",""]))],(,()}function re(e){return l.jc(0,[(e()(),l.Hb(0,0,null,null,8,"ohp-dropdown-menu",[],null,[[null,"toggleMenu"],[null,"selectItem"]],(function(e,t,n){var l=!0,i=e.component;return"toggleMenu"===t&&(l=!1!==i.onToggleMenu(n)&&l),"selectItem"===t&&(l=!1!==i.onSelectItem(n)&&l),l}),A.b,A.a)),l.Gb(1,4440064,[[1,4]],1,m.a,[l.h,E.a],{menuModel:[0,"menuModel"],fullWidth:[1,"fullWidth"],toggleDisabled:[2,"toggleDisabled"],themeEnabled:[3,"themeEnabled"],hideContent:[4,"hideContent"]},{toggleMenu:"toggleMenu",selectItem:"selectItem"}),l.cc(603979776,2,{menuItems:1}),(e()(),l.qb(16777216,null,0,1,null,Y)),l.Gb(4,16384,null,0,L.k,[l.W,l.S],{ngIf:[0,"ngIf"]},null),(e()(),l.qb(16777216,null,0,1,null,ne)),l.Gb(6,16384,null,0,L.k,[l.W,l.S],{ngIf:[0,"ngIf"]},null),(e()(),l.qb(0,null,null,1,null,ae)),l.Gb(8,16384,[[2,4]],0,m.b,[l.S],null,null)],(function(e,t){var n=t.component;e(t,1,0,n.menuModel,n.withAnimation,!n.showDropdown,n.isTenantThemeEnabled,!n.showDropdown),e(t,4,0,n.withAnimation),e(t,6,0,!n.withAnimation)}),null)}function oe(e){return l.jc(0,[(e()(),l.Hb(0,0,null,null,1,"ohp-create-modal",[],null,[[null,"selectItem"],[null,"closeModal"]],(,V,z)),l.Gb(1,4440064,null,0,q,[C.a,O.a,f.a,p.a,S.a,j.a,P.a,W.a],{createLinks:[0,"createLinks"]},{selectItem:"selectItem",closeModal:"closeModal"})],(function(e,t){e(t,1,0,t.component.createLinks)}),null)}unction ce(e){return l.jc(0,[l.cc(671088640,1,{dropdownMenu:0}),(e()(),l.qb(16777216,null,null,1,null,re)),l.Gb(2,16384,null,0,L.k,[l.W,l.S],{ngIf:[0,"ngIf"]},null),(e()(),l.qb(16777216,null,null,1,null,oe)),l.Gb(4,16384,null,0,L.k,[l.W,l.S],{ngIf:[0,"ngIf"]},null),(e()(),l.qb(16777216,null,null,1,null,ue)),l.Gb(6,16384,null,0,L.k,[l.W,l.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,n.createLinks&&n.createLinks.length),e(t,4,0,n.opened&&!n.showDropdown),e(t,6,0,n.withAnimation)}),null)}var se=l.Db("ohp-create-menu",y,(function(e){return l.jc(0,[(e()(),l.Hb(0,0,null,null,1,"ohp-create-menu",[],null,null,null,ce,X)),l.Gb(1,114688,null,0,y,[C.a,I.a,b.a,f.a,s.b,p.a,S.a,g.a,T.a,h.a,v.b],null,null)],(,null)}),{buttonOrigin:"buttonOrigin",numDocuments:"numDocuments",isInFre:"isInFre",createNotebookText:"createNotebookText",createDocumentText:"createDocumentText",withAnimation:"withAnimation",componentArea:"componentArea",scaleTile:"scaleTile",showDropdown:"showDropdown"},{},[]),me=n("xIlw"),pe=n("+a0u"),de=n("lQwO"),he=n("+P5Z"),be=n("CfLe"),fe=n("ej7j"),ge=n("X+PR"),ve=n("VY7U"),Ce=n("izKO"),Ie=n("CCRL"),Se=l.Eb(x,[],(function(e){return l.Tb([l.Ub(512,l.k,l.hb,[[8,[w.a,se]],[3,l.k],l.D]),l.Ub(4608,L.m,L.l,[l.z]),l.Ub(1073742336,L.c,L.c,[]),l.Ub(1073742336,me.a,me.a,[]),l.Ub(1073742336,pe.a,pe.a,[]),l.Ub(1073742336,de.a,de.a,[]),l.Ub(1073742336,he.a,he.a,[]),l.Ub(1073742336,be.a,be.a,[]),l.Ub(1073742336,fe.a,fe.a,[]),l.Ub(1073742336,ge.o,ge.o,[[2,ge.u],[2,ge.n]]),l.Ub(1073742336,ve.a,ve.a,[]),l.Ub(1073742336,Ce.a,Ce.a,[]),l.Ub(1073742336,x,x,[]),l.Ub(256,Ie.a,k,[])])}))},vSbP:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",();var l,i=n("QjXU"),a=n("y3b+"),r=n("k+kJ"),o=n("JScD"),u=n("uG5N"),c=n("vSs+"),s=n("A/um"),m=n("BaAg"),p=n("OWzB"),d=n("hZW2"),h=n("m+UP"),b=n("BJbw"),f=n("TIi1"),g=n("4/We"),v=n("PBJH"),C=n("uUrA"),I=n("idgT"),S=n("keVe");!l||(l={}));var T=function(){function e(e,t,n,l){this.tileConfig=e,this.template=t,this.app=n,this.createDocumentService=l,this.categories=t?t.Categories:void 0}return e.prototype.handleClick=function(e){return this.createDocumentService.createItem(this.app,null,this.template,e,this.driveId)},e}(),y=function(e){function t(t,n,i,a){var r=this,o=n.resources(t);return(r=e.call(this,{title:o.CreateNewBlankText||o[""+l.CreateNewBlankText+m.b[t]],ariaLabel:o.CreateNewBlankAriaLabel||o[""+l.CreateNewBlankAriaLabel+m.b[t]],icon:a?null:s.a.Add,appName:A.getAppName(t)},void 0,t,i)||this).templateType="Blank",r}return Object(i.__extends)(t,e),t}(T),k=function(e){function t(t,n,l,i,a){var r,o=this,u=a.resources(t);return n&&!n.TemplateBinaryUrl&&n.Binaries&&n.Binaries.length>0&&(n.TemplateBinaryUrl=null===(r=n.Binaries.find((function(e){var t,n;return"wac"===(null===(t=e.Platform)||void 0===t?void 0:t.toLowerCase())||"online"===(null===(n=e.Platform)||void 0===n?void 0:n.toLowerCase())})))||void 0===r?void 0:r.Url),(o=e.call(this,{title:n.Title,ariaLabel:i.format(u.CreateFromTemplateAriaLabel,n.Title),thumbnail:A.getThumbnail(n.Thumbnails,n.Images),appName:A.getAppName(t),extension:m.a.getFileExtension(n.TemplateBinaryUrl),galleryThumbnail:A.getGalleryThumbnail(n.Thumbnails)},n,t,l)||this).assetId=n.AssetId,o.templateType=n.IsPremium?"Premium":"Standard",o}return Object(i.__extends)(t,e),t}(T),x=function(e){function t(t,n,l,i,a,r){var o,u=this,c=a.resources(t);return n&&!n.TemplateBinaryUrl&&n.Binaries&&n.Binaries.length>0&&(n.TemplateBinaryUrl=null===(o=n.Binaries.find((function(e){var t,n;return"wac"===(null===(t=e.Platform)||void 0===t?void 0:t.toLowerCase())||"online"===(null===(n=e.Platform)||void 0===n?void 0:n.toLowerCase())})))||void 0===o?void 0:o.Url),(u=e.call(this,{title:n.Title,ariaLabel:i.format(c.CreateFromTemplateAriaLabel,n.Title),thumbnail:A.getThumbnail(n.Thumbnails),appName:A.getAppName(t),extension:m.a.getFileExtension(n.TemplateBinaryUrl.slice(0,n.TemplateBinaryUrl.indexOf("&",n.TemplateBinaryUrl.lastIndexOf("."))))},n,t,l)||this).assetId=n.AssetId,u.driveId=r,u.templateType="Enterprise",u}return Object(i.__extends)(t,e),t}(T),w=function(){function e(e,t,n,l,i,a,r){this.capabilitiesService=t,this.urlLauncherService=l;var o=r.resources(e);this.tileConfig={title:n.Title,ariaLabel:a.format(o.CreateFromTemplateAriaLabel,n.Title),thumbnail:A.getThumbnail(n.Thumbnails),appName:A.getAppName(e),extension:m.a.getFileExtension(n.TemplateBinaryUrl)},this.assetId=n.AssetId,this.templateType="Standard",this.app=e,this.templateUrl=e===m.b.Sway?i.appendPvrAndUpnAuthParams(n.TemplateBinaryUrl):n.TemplateBinaryUrl}return e.prototype.handleClick=function(e){var t=this;return this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(n){return n.launchUrl(t.templateUrl,{action:"OpenTemplate"}).then((function(){e({type:"GoToBlankDoc",latency:0,platform:"Web"})}),(function(){e({type:"Error",latency:0})}))})):this.urlLauncherService.openUrl(this.templateUrl,"OpenTemplate").then((,(function(){e({type:"Error",latency:0})}))},e}(),_=function(){function e(e,t,n,l,i,a,r,o){this.capabilitiesService=t,this.documentService=l,this.uploadManagerService=i,this.swayService=a,this.urlLauncherService=r,this.uploadConfigService=o;var u=n.resources(e);this.tileConfig={title:u.CreateFromDocumentText,ariaLabel:u.CreateFromDocumentAriaLabel,icon:s.a.Upload,appName:A.getAppName(m.b.Sway)},this.assetId="_DocumentUpload",this.templateType="Standard",this.app=e}return e.prototype.handleClick=function(e){var t=this;return new Promise((function(l){var i=a=t.swayService.swayConfig.uploadSupportedExtensions.map(();t.documentService.selectFile(a).then((function(a){var o=t.uploadManagerService.upload(a[0],t.swayService,C.a.createGuid(),t.uploadConfigService.config.swayResources,r.d.Button);if(o)var u=o.subscribe((function(a){a.state===r.c.Completed?(e({type:"GoToBlankDoc",latency:0,platform:"Web"}),t.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5)]).then(n.bind(null,"DZQ9")).then((function(e){e.launchUrl(a.result.pollingUrl,{action:"CreateFromDocument",linkTarget:"_top"})})):t.urlLauncherService.openUrl(a.result.pollingUrl,"CreateFromDocument","_top"),u.unsubscribe(),l()):a.state!==r.c.Failed&&a.state!==r.c.Cancelled||(u.unsubscribe(),i({type:"Error",latency:0}))}));else i({type:"Error",latency:0})})).catch(()}))},e}(),B=function(){function e(e,t,n,l){this.upsellDataService=n,this.installConfigService=l;var i=t.resources(e),a=[{Size:"medium",Height:55,Width:55,Url:i.PremiumTemplatesUpsellThumbnail,ImageType:"MT"}];this.app=e,this.tileConfig={title:i.PremiumTemplatesHookTitle,ariaLabel:i.PremiumTemplatesHookTitle,thumbnail:A.getThumbnail(a),appName:A.getAppName(e),premiumDiamond:t.config.premiumTemplatesDiamondCorner},this.assetId="_PremiumTemplatesUpsellHook",this.templateType="Upsell",this.installConfigService.config.dimeEnabled&&this.upsellDataService.warmupDime("templates")}return e.prototype.handleClick=function(e){var t=this;return new Promise((function(n){if(t.installConfigService.config.dimeEnabled){var l=t.installConfigService.config.goPremiumUrlPremiumTemplates.replace("{OEM}",t.upsellDataService.getUpsellTrackingParam());t.upsellDataService.launchDime("templates",l)}e({type:"Upsell",latency:0}),n()}))},e}(),L=function(){eturn e.prototype.createCreateNewFromBlankTemplateCreationHandlers=function(e){var t=this;return e.map((function(e){return new y(e,t.templatesConfigService,t.documentCreateService,t.capabilitiesService.capabilities.fluentRefresh)}))},e.prototype.createCreateNewFromTemplateCreationHandler=e.prototype.createOpenTemplateCreationHandler=function(e,t){return new w(e,this.capabilitiesService,t,this.urlLauncherService,this.urlAuthenticatorService,this.locService,this.templatesConfigService)},e.prototype.createFileTemplateCreationHandler=function(e){return new _(e,this.capabilitiesService,this.templatesConfigService,this.documentService,this.uploadManagerService,this.swayService,this.urlLauncherService,this.uploadConfigService)},e.prototype.createPremiumLinkCreationHandler=e.prototype.createCreateNewFromEnterpriseTemplateCreationHandler=function(e,t,n){return new x(e,t,this.documentCreateService,this.locService,this.templatesConfigService,n)},e.ɵprov=S.kc({factory:function(){return new e(S.lc(g.a),S.lc(p.a),S.lc(f.a),S.lc(b.a),S.lc(I.a),S.lc(v.a),S.lc(h.a),S.lc(d.a),S.lc(u.a),S.lc(o.a),S.lc(a.a),S.lc(c.a))},token:e,providedIn:"root"}),e}(),A=function()return e.getAppName,e.getThumbnail=function(e,t){var n,l;if(e){var i=e.find((function(e){return"MT"===e.ImageType}));return i?i.Url:void 0}if(t){var a=null===(n=t.find((function(e){return"large"===e.ImageSize.toLowerCase()})))||void 0===n?void 0:n.Url,r=null===(l=t.find()))||void 0===l?void 0:l.Url;return a||r}},e.getGalleryThumbnail=function(e){if(e){var t=e.find((function(e){return"LT"===e.ImageType})),n=e.find());return t||n}},e}()}}]);
//# sourceMappingURL=create-menu.e12a7b363f82b423910d.chunk.v7.js.map