var APM=function(){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};ar n=r=n("object"==("undefined"==typeof globalThis?"undefined":t(globalThis))&&globalThis)||n("object"==("undefined"==typeof window?"undefined":t(window))&&window)||n("object"==("undefined"==typeof self?"undefined":t(self))&&self)||n("object"==t(e)&&e)||function(){return this}()||Function("return this")(),i={},o=a=!o((),s=!o((),c=Function.prototype.call,u=s?c.bind(c):function(){return c.apply(c,arguments)},l={},f={}.propertyIsEnumerable,h=Object.getOwnPropertyDescriptor,p=h&&!f.call({1:2},1);l.f=p?f;var d,v,g=m=s,y=Function.prototype,w=y.call,b=m&&y.bind.bind(w,w),_=m?x=_,k=x({}.toString),S=x("".slice),E=T=o,O=E,C=Object,I=_("".split),P=T(()?C,R=TypeError,A=j=P,D=A,M=function(e){return j(D(e))},N=B=N,L=F=r,H=N,q=z=U=_({}.isPrototypeOf),W=z("navigator","userAgent")||"",V=W,J=r.process,K=r.Deno,Q=J&&J.versions||K&&K.version,X=Q&&Q.v8;X&&(v=(d=X.split("."))[0]>0&&d[0]<4?1:+(d[0]+d[1])),!v&&V&&(!(d=V.match(/Edge\/(\d+)/))||d[1]>=74)&&(d=V.match(/Chrome\/(\d+)/))&&(v=+d[1]);var G=v,Y=G,$=!!Object.getOwnPropertySymbols&&!o((),Z=$&&!Symbol.sham&&"symbol"==t(Symbol.iterator),ee=z,te=N,ne=U,re=Object,ie=Z?oe=String,ae=se=N,ce=ae,ue=TypeError,le=function(e){if(se(e))return e;throw ue(ce(e)+" is not a function")},fe=le,he=pe=u,de=N,ve=L,ge=TypeError,me={exports:{}},ye=r,we=Object.defineProperty,be=_e="__core-js_shared__",xe=r[_e]||be(_e,{}),ke=xe;(me.exports=("versions",[]).push({version:"3.24.1",mode:"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.24.1/LICENSE",source:"https://github.com/zloirock/core-js"});var Se=A,Ee=Object,Te,Oe=Te,Ce=_({}.hasOwnProperty),Ie=Object.hasOwn|,Pe=_,Re=0,Ae=Math.random(),je=Pe(1..toString),De,Me=r,Ne=Ie,Be=De,Le=$,Fe=Z,He=(0,me.exports)("wks"),qe=Me.Symbol,ze=qe&&qe.for,Ue=Fe?qe:qe&&qe.withoutSetter||Be,We,Ve=u,Je=L,Ke=ie,Qe=he,Xe,Ge=TypeError,Ye=We("toPrimitive"),$e,Ze=ie,et,tt=L,nt=r.document,rt=tt(nt)&&tt(nt.createElement),it,ot=it,at=!a&&!o()),st=u,ct=l,ut=g,lt=M,ft=et,ht=Ie,pt=at,dt=Object.getOwnPropertyDescriptor;i.f=a?dt;var vt={},gt=a&&o()),mt=L,yt=String,wt=TypeError,bt=function(e){if(mt(e))return e;throw wt(yt(e)+" is not an object")},_t=at,xt=bt,kt=et,St=TypeError,Et=Object.defineProperty,Tt=Object.getOwnPropertyDescriptor,Ot="enumerable",Ct="configurable",It="writable";vt.f=a?gt:Et;var Pt=vt,Rt=g,At=a,jt={exports:{}},Dt=a,Mt=Function.prototype,Nt=Dt&&Object.getOwnPropertyDescriptor,Bt=Ie(Mt,"name"),Lt={EXISTS:Bt,PROPER:Bt&&"something"===function(){}.name,CONFIGURABLE:Bt&&(!Dt||Dt&&Nt(Mt,"name").configurable)},Ft=N,Ht=xe,qt=_(Function.toString);Ft(Ht.inspectSource)||(Ht.inspectSource);var zt,Ut,Wt,Vt=Ht.inspectSource,Jt=Vt,Kt=r.WeakMap,Qt=N(Kt)&&/native code/.test(Jt(Kt)),Xt=De,Gt=(0,me.exports)("keys"),Yt,$t={},Zt=_,en=L,tn=At,nn=Ie,rn=Yt,on=$t,an="Object already initialized",sn=r.TypeError;if(Qt||xe.state){var cn=xe.state||(xe.state=new(0,r.WeakMap)),un=Zt(cn.get),ln=Zt(cn.has),fn=Zt(cn.set);zt=function(e,t){if(ln(cn,e))throw new sn(an);return t.facade=e,fn(cn,e,t),t},Ut,Wt=function(e){return ln(cn,e)}}else{var hn=rn("state");on[hn]=!0,zt,Ut,Wt=function(e){return nn(e,hn)}}var pn={set:zt,get:Ut,has:Wt,enforce,getterFor},dn=N,vn=Ie,gn=a,mn=Lt.CONFIGURABLE,yn=Vt,wn=pn.enforce,bn=pn.get,_n=Object.defineProperty,xn=gn&&!o()),kn=String(String).split("String"),Sn=jt.exports;Function.prototype.toString=Sn(),"toString");var En=N,Tn=vt,On=jt.exports,Cn=be,In,Pn={},Rn=Math.ceil,An=Math.floor,jn=Math.trunc|,Dn,Mn=Dn,Nn=Math.max,Bn=Math.min,Ln,Fn=Dn,Hn=Math.min,qn,zn,Un=M,Wn=Ln,Vn=zn,Jn,Kn={includes:Jn(!0),indexOf:Jn(!1)},Qn=Ie,Xn=M,Gn=Kn.indexOf,Yn=$t,$n=_([].push),Zn,er=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],tr=Zn,nr=er.concat("length","prototype");Pn.f=Object.getOwnPropertyNames||function(e){return tr(e,nr)};var rr={};rr.f=Object.getOwnPropertySymbols;var ir=z,or=Pn,ar=rr,sr=bt,cr=_([].concat),ur=ir("Reflect","ownKeys")|,lr=Ie,fr=ur,hr=i,pr=vt,dr,vr=o,gr=N,mr=/#|\.prototype\./,yr,wr=yr.normalize,br=yr.data={},_r=yr.NATIVE="N",xr=yr.POLYFILL="P",kr=yr,Sr=r,Er=i.f,Tr=At,Or=In,Cr=be,Ir=dr,Pr=kr,Rr;Rr({global:!0},{globalThis:r});var Ar=!o()),jr=Ie,Dr=N,Mr=Te,Nr=Ar,Br=Yt("IE_PROTO"),Lr=Object,Fr=Lr.prototype,Hr=Nr?Lr.getPrototypeOf,qr=N,zr=String,Ur=TypeError,Wr=_,Vr=bt,Jr,Kr=Object.setPrototypeOf||("__proto__"in{}():void 0),Qr={},Xr=Zn,Gr=er,Yr=Object.keys|,$r=vt,Zr=bt,ei=M,ti=Yr;Qr.f=a&&!gt?Object.defineProperties;var ni,ri=z("document","documentElement"),ii=bt,oi=Qr,ai=er,si=$t,ci=ri,ui=it,li=Yt("IE_PROTO"),fi=function(){},hi,pi,di;si[li]=!0;var vi=Object.create|,gi=Error,mi=_("".replace),yi=String(gi("zxcasd").stack),wi=/\n\s*at [^:]*:[^\n]*/,bi=wi.test(yi),_i=L,xi=At,ki=le,Si=s,Ei=_(_.bind),Ti,Oi={},Ci=Oi,Ii=We("iterator"),Pi=Array.prototype,Ri,Ai={};Ai[We("toStringTag")]="z";var ji="[object z]"===String(Ai),Di=ji,Mi=N,Ni=E,Bi=We("toStringTag"),Li=Object,Fi="Arguments"==Ni(function(){return arguments}()),Hi=Di?Ni,qi=Hi,zi=he,Ui=Oi,Wi=We("iterator"),Vi,Ji=u,Ki=le,Qi=bt,Xi=ae,Gi=Vi,Yi=TypeError,$i,Zi=u,eo=bt,to=he,no,ro=Ti,io=u,oo=bt,ao=ae,so=Ri,co=zn,uo=U,lo=$i,fo=Vi,ho=no,po=TypeError,vo=function(e,t){this.stopped=e,this.result=t},go=vo.prototype,mo=function(e,n,r){var i,o,a,s,c,u,l,f=!(!r||!r.AS_ENTRIES),h=!(!r||!r.IS_RECORD),p=!(!r||!r.IS_ITERATOR),d=!(!r||!r.INTERRUPTED),v=ro(n,r&&r.that),g,m;if(h)i=e.iterator;else if(p)i=e;else{if(!(o=fo(e)))throw po(ao(e)+" is not iterable");if(so(o)){for(a=0,s=co(e);s>a;a++)if((c=m(e[a]))&&uo(go,c))return c;return new vo(!1)}i=lo(e,o)}for(u=h?e.next:i.next;!(l=io(u,i)).done;){try{c=m(l.value)}catch(y){ho(i,"throw",y)}if("object"==t(c)&&c&&uo(go,c))return c}return new vo(!1)},yo=Hi,wo=String,bo,_o=bo,xo=g,ko=!o()),So=Rr,Eo=U,To=Hr,Oo=Kr,Co=dr,Io=vi,Po=At,Ro=g,Ao,jo,Do=mo,Mo,No=ko,Bo=We("toStringTag"),Lo=Error,Fo=[].push,Ho;Oo?Oo(Ho,Lo):Co(Ho,Lo,{name:!0});var qo=Ho.prototype=Io(Lo.prototype,{constructor:Ro(1,Ho),message:Ro(1,""),name:Ro(1,"AggregateError")});So({global:!0,constructor:!0,arity:2},{AggregateError:Ho});var zo=vi,Uo=vt.f,Wo=We("unscopables"),Vo=Array.prototype;null==Vo[Wo]&&Uo(Vo,Wo,{configurable:!0,value:zo(null)});var Jo,Ko,Qo,Xo=o,Go=N,Yo=Hr,$o=In,Zo=We("iterator"),ea=!1;[].keys&&("next"in(Qo=[].keys())?(Ko=Yo(Yo(Qo)))!==Object.prototype&&(Jo=Ko):ea=!0);var ta=null==Jo||Xo());ta&&(Jo={}),Go(Jo[Zo])||$o(Jo,Zo,(function(){return this}));var na={IteratorPrototype:Jo,BUGGY_SAFARI_ITERATORS:ea},ra=vt.f,ia=Ie,oa=We("toStringTag"),aa,sa=na.IteratorPrototype,ca=vi,ua=g,la=aa,fa=Oi,ha=function(){return this},pa=Rr,da=u,va=N,ga,ma=Hr,ya=Kr,wa=aa,ba=At,_a=In,xa=Oi,ka=Lt.PROPER,Sa=Lt.CONFIGURABLE,Ea=na.IteratorPrototype,Ta=na.BUGGY_SAFARI_ITERATORS,Oa=We("iterator"),Ca="keys",Ia="values",Pa="entries",Ra=function(){return this},Aa,ja=M,Da,Ma=Oi,Na=vt.f,Ba=Aa,La=a,Fa="Array Iterator",Ha=pn.set,qa=pn.getterFor(Fa);Ba(Array,"Array",),),"values");var za=Ma.Arguments=Ma.Array;if(Da("keys"),Da("values"),Da("entries"),La&&"values"!==za.name)try{Na(za,"name",{value:"values"})}catch(om){}var Ua=Hi;ji||In(Object.prototype,"toString",ji?{}.toString,{unsafe:!0});var Wa="process"==E(r.process),Va=z,Ja=vt,Ka=a,Qa=We("species"),Xa,Ga=U,Ya=TypeError,$a,Za=_,es=o,ts=N,ns=Hi,rs=Vt,is=function(){},os=[],as=z("Reflect","construct"),ss=/^\s*(?:class|function)\b/,cs=Za(ss.exec),us=!ss.exec(is),ls,fs;fs.sham=!0;var hs,ps,ds,vs,gs=!as||es())?fs:ls,ms=gs,ys=ae,ws=TypeError,bs=bt,_s,xs=We("species"),ks,Ss=s,Es=Function.prototype,Ts=Es.apply,Os=Es.call,Cs="object"==("undefined"==typeof Reflect?"undefined":t(Reflect))&&Reflect.apply||(Ss?Os.bind(Ts)),Is=_([].slice),Ps=TypeError,Rs=/(?:ipad|iphone|ipod).*applewebkit/i.test(W),As=r,js=Cs,Ds=Ti,Ms=N,Ns=Ie,Bs=o,Ls=ri,Fs=Is,Hs=it,qs,zs=Rs,Us=Wa,Ws=As.setImmediate,Vs=As.clearImmediate,Js=As.process,Ks=As.Dispatch,Qs=As.Function,Xs=As.MessageChannel,Gs=As.String,Ys=0,$s={},Zs="onreadystatechange";try{hs=As.location}catch(om){}var ec,tc,nc,rc;Ws&&Vs||(Ws,Vs,Us?ps=function(e){Js.nextTick(tc(e))}:Ks&&Ks.now?ps:Xs&&!zs?(vs=(ds=new Xs).port2,ds.port1.onmessage=nc,ps=Ds(vs.postMessage,vs)):As.addEventListener&&Ms(As.postMessage)&&!As.importScripts&&hs&&"file:"!==hs.protocol&&!Bs(rc)?(ps=rc,As.addEventListener("message",nc,!1)):ps=Zs in Hs("script"));var ic,oc,ac,sc,cc,uc,lc,fc,hc={set:Ws,clear:Vs},pc=r,dc=/ipad|iphone|ipod/i.test(W)&&void 0!==pc.Pebble,vc=/web0s(?!.*chrome)/i.test(W),gc=r,mc=Ti,yc=hc.set,wc=Rs,bc=dc,_c=vc,xc=Wa,kc=gc.MutationObserver||gc.WebKitMutationObserver,Sc=gc.document,Ec=gc.process,Tc=gc.Promise,Oc=(0,i.f)(gc,"queueMicrotask"),Cc=Oc&&Oc.value;Cc||(ic,wc||xc||_c||!kc||!Sc?!bc&&Tc&&Tc.resolve?((lc=Tc.resolve(void 0)).constructor=Tc,fc=mc(lc.then,lc),sc=function(){fc(ic)}):xc?sc:(yc=mc(yc,gc),sc):(cc=!0,uc=Sc.createTextNode(""),new kc(ic).observe(uc,{characterData:!0}),sc));var Ic=Cc|,Pc=r,Rc,Ac;Ac.prototype={add,get};var jc=Ac,Dc=r.Promise,Mc="object"==("undefined"==typeof Deno?"undefined":t(Deno))&&Deno&&"object"==t(Deno.version),Nc=!Mc&&!Wa&&"object"==("undefined"==typeof window?"undefined":t(window))&&"object"==("undefined"==typeof document?"undefined":t(document)),Bc=r,Lc=Dc,Fc=N,Hc=kr,qc=Vt,zc=Nc,Uc=Mc,Wc=G,Vc=We("species"),Jc=!1,Kc=Fc(Bc.PromiseRejectionEvent),Qc=Hc("Promise",)),Xc={CONSTRUCTOR:Qc,REJECTION_EVENT:Kc,SUBCLASSING:Jc},Gc={},Yc=le,$c;Gc.f=function(e){return new $c(e)};var Zc,eu,tu,nu=Rr,ru=Wa,iu=r,ou=u,au=In,su=Kr,cu=aa,uu=Xa,lu=le,fu=N,hu=L,pu=$a,du=ks,vu=hc.set,gu=Ic,mu,yu=Rc,wu=jc,bu=pn,_u=Dc,xu=Gc,ku="Promise",Su=Xc.CONSTRUCTOR,Eu=Xc.REJECTION_EVENT,Tu=Xc.SUBCLASSING,Ou=bu.getterFor(ku),Cu=bu.set,Iu=_u&&_u.prototype,Pu=_u,Ru=Iu,Au=iu.TypeError,ju=iu.document,Du=iu.process,Mu=xu.f,Nu=Mu,Bu=!!(ju&&ju.createEvent&&iu.dispatchEvent),Lu="unhandledrejection",Fu,Hu,qu,zu,Uu,Wu,Vu,Ju,Ku,Qu;if(Su&&(Pu,(Zc).prototype=au(Ru=Pu.prototype,"then",)),eu,xu.f=Mu,fu(_u)&&Iu!==Object.prototype)){tu=Iu.then,Tu||au(Iu,"then",),{unsafe:!0});try{delete Iu.constructor}catch(om){}su&&su(Iu,Ru)}nu({global:!0,constructor:!0,wrap:!0,forced:Su},{Promise:Pu}),cu(Pu,ku,!1),uu(ku);var Xu=We("iterator"),Gu=!1;try{var Yu=0,$u={next,return};$u[Xu],Array.from($u,))}catch(om){}var Zu,el=Dc,tl=Xc.CONSTRUCTOR||!Zu()),nl=u,rl=le,il=Gc,ol=Rc,al=mo;Rr({target:"Promise",stat:!0,forced:tl},{all});var sl=Dc,cl=z,ul=N,ll=In,fl=sl&&sl.prototype;if(Rr({target:"Promise",proto:!0,forced:Xc.CONSTRUCTOR,real:!0},{catch}),ul(sl)){var hl=cl("Promise").prototype.catch;fl.catch!==hl&&ll(fl,"catch",hl,{unsafe:!0})}var pl=u,dl=le,vl=Gc,gl=Rc,ml=mo;Rr({target:"Promise",stat:!0,forced:tl},{race});var yl=u,wl=Gc;Rr({target:"Promise",stat:!0,forced:Xc.CONSTRUCTOR},{reject});var bl=bt,_l=L,xl=Gc,kl,Sl=kl;Rr({target:"Promise",stat:!0,forced:Xc.CONSTRUCTOR},{resolve});var El=u,Tl=le,Ol=Gc,Cl=Rc,Il=mo;Rr({target:"Promise",stat:!0},{allSettled});var Pl=u,Rl=le,Al=z,jl=Gc,Dl=Rc,Ml=mo,Nl="No one promise resolved";Rr({target:"Promise",stat:!0},{any});var Bl=Dc,Ll=z,Fl=N,Hl=ks,ql=kl,zl=In,Ul=Bl&&Bl.prototype;if(Rr({target:"Promise",proto:!0,real:!0,forced:!!Bl&&o())},{finally}),Fl(Bl)){var Wl=Ll("Promise").prototype.finally;Ul.finally!==Wl&&zl(Ul,"finally",Wl,{unsafe:!0})}var Vl=_,Jl=Dn,Kl=bo,Ql=A,Xl=Vl("".charAt),Gl=Vl("".charCodeAt),Yl=Vl("".slice),$l,Zl={codeAt:$l(!1),charAt:$l(!0)}.charAt,ef=bo,tf=Aa,nf="String Iterator",rf=pn.set,of=pn.getterFor(nf);tf(String,"String",),));var af={exports:{}},sf={},cf=et,uf=vt,lf=g,ff,hf=Ln,pf=zn,df=ff,vf=Array,gf=Math.max,mf=E,yf=M,wf=Pn.f,bf,_f="object"==("undefined"==typeof window?"undefined":t(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];sf.f;var xf=o()),kf=L,Sf=E,Ef=xf,Tf=Object.isExtensible,Of=o((function(){}))||Ef:Tf,Cf=!o()),If=Rr,Pf=_,Rf=$t,Af=L,jf=Ie,Df=vt.f,Mf=Pn,Nf=sf,Bf=Of,Lf=Cf,Ff=!1,Hf=De("meta"),qf=0,zf,Uf=af.exports={enable,fastKey,getWeakData,onFreeze};Rf[Hf]=!0;var Wf=N,Vf=L,Jf=Kr,Kf=Rr,Qf=r,Xf=_,Gf=kr,Yf=In,$f=af.exports,Zf=mo,eh=$a,th=N,nh=L,rh=o,ih=Zu,oh=aa,ah,sh,ch=In,uh=vt.f,lh=vi,fh,hh=Ti,ph=$a,dh=mo,vh=Aa,gh=Xa,mh=a,yh=af.exports.fastKey,wh=pn.set,bh=pn.getterFor,_h={getConstructor,setStrong};sh("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),_h),sh("Set",),_h);var xh=a,kh=u,Sh=o,Eh=Yr,Th=rr,Oh=l,Ch=Te,Ih=P,Ph=Object.assign,Rh=Object.defineProperty,Ah=_([].concat),jh=!Ph||Sh()):Ph;Rr({target:"Object",stat:!0,arity:2,forced:Object.assign!==jh},{assign:jh});var Dh=L,Mh=E,Nh=We("match"),Bh,Lh=TypeError,Fh=We("match"),Hh=Rr,qh,zh=A,Uh=bo,Wh,Vh=_("".indexOf);Hh({target:"String",proto:!0,forced:!Wh("includes")},{includes});var Jh=r,Kh=_,Qh;Qh("String","includes");var Xh=bt,Gh=no,Yh=Ti,$h=u,Zh=Te,ep,tp=Ri,np=gs,rp=zn,ip=ff,op=$i,ap=Vi,sp=Array,cp;Rr({target:"Array",stat:!0,forced:!Zu())},{from:cp});var up,lp,fp,hp=_,pp=le,dp=L,vp=Ie,gp=Is,mp=s,yp=Function,wp=hp([].concat),bp=hp([].join),_p={},xp,kp=mp?yp.bindt:"Function",proto:!0,forced:Function.bind!==kp},{bind:kp}),Qh("Function","bind"),function(e){e[e.crash=10]="crash",e[e.performance=11]="performance",e[e.request=12]="request",e[e.wpsAPI=13]="wpsAPI",e[e.businessLog=14]="businessLog",e[e.source=15]="source",e[e["source-performance"]=20]="source-performance"}(up||(up={})),function(e){e[e.browser=1]="browser",e[e["wps-pc"]=2]="wps-pc"}(lp||(lp={})),function(e){e[e.xhr=1]="xhr",e[e.fetch=2]="fetch"}(fp||(fp={}));var Dp,Mp=Tp((function e(){Sp(this,e),jp(this,"_aid",void 0),jp(this,"_did",void 0),jp(this,"_av",void 0),jp(this,"_ch",void 0),jp(this,"_at",void 0),jp(this,"_sv",void 0),jp(this,"_ut",void 0),jp(this,"_vgm",void 0),jp(this,"_traceid",void 0),jp(this,"_appid",""),jp(this,"_brand",void 0),jp(this,"_biz",void 0),jp(this,"_os",void 0),jp(this,"_ov",void 0),jp(this,"_screen",void 0),jp(this,"_network",void 0),jp(this,"_ua",void 0),jp(this,"_c",void 0),jp(this,"_ws",void 0),jp(this,"_uuid",void 0),jp(this,"_pn",void 0),jp(this,"_pv",void 0),jp(this,"_fv",void 0),this._aid="",this._did="",this._av="0.0.0.0",this._ch="xx00000",this._at="wps-web",this._sv="2.2.1",this._ut=Date.now(),this._vgm="",this._traceid="",this._brand="",this._biz="",this._os="",this._ov="",this._screen="",this._network="",this._ua="",this._c="",this._ws="",this._uuid="",this._pn="",this._pv="",this._fv=""})),Np=function(){function e(){Sp(this,e),jp(this,"_analy_type",void 0),jp(this,"_analy_branch",void 0),jp(this,"_sampling_rate",void 0),jp(this,"_ct",void 0),jp(this,"common_info",void 0),jp(this,"contents",void 0),this._ct=0,this.common_info={},this.contents=[]}return Tp(e,[{key:"wrap",value:function(){return Object.assign(Object.create(null),this)}}]),e}();function Bp(){}function Lp(){return Number(Math.random().toString().substr(3,3)+Date.now()).toString(36)}function Fp(e){return"[object ErrorEvent]"===Object.prototype.toString.call(e)}function Hp(e){return"[object DOMError]"===Object.prototype.toString.call(e)}function qp(e){return"[object Object]"===Object.prototype.toString.call(e)function Up(e){return"[object String]"===Object.prototype.toString.call(e)unction Jp(){return void 0===window.document||null==window.document.location?"":(document.location.origin||document.location.protocol+"//"+document.location.hostname+(document.location.port?":"+document.location.port:""))+document.location.pathname}function Kp(){return void 0===window.document||null==window.document.location?"":document.location.search.substring(1)+document.location.hashfunction Xp(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e4;if(!e||!t)return!1;var r=t.substr(-4),i=window.parseInt(r,16),o=i%n;return o<=n/efunction Yp(e,t,n,r){return JSON.stringify(e,function(e,t){var n=[],r=[];t||(t);return}(t,r),n)}function $p(e,n){if(null==n)return 0;for(var r=0,i=function(e){var t=[];for(var n in e)t.push(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);Array.prototype.push.apply(t,r)}return t}(n),o=0;o<i.length;o++){var a=i[o];if("object"===t(n[a])&&null!==n[a]){if(e.has(n[a]))continue;e.add(n[a])}r+=Zp(e)(a);try{r+=Zp(e)(n[a])}catch(s){s instanceof RangeError&&(r=0)}}return r}function Zp(e){return function(n){if(!n)return 0;switch(t(n)){case"string":return n.length*Dp.STRING;case"boolean":return Dp.BOOLEAN;case"number":return Dp.NUMBER;case"symbol":var r=Symbol.keyFor&&Symbol.keyFor(n);return r?r.length*Dp.STRING:(n.toString().length-8)*Dp.STRING;case"object":return Array.isArray(n)?n.map(Zp(e)).reduce(),0):$p(e,n);default:return 0}}}function ed(e){return"undefined"!=typeof WeakSet?Zp(new WeakSet)(e):0}function td(e,n){if(null!=e)if("object"!==t(e)&&(e=[e]),Array.isArray(e))for(var r=0,i=e.length;r<i;r++)n.call(null,r,e[r],e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&n.call(null,o,e[o],e)}function nd(e,t){var n={};function r(e,r,i){var o=t?t(n[e],r,"".concat(e),n,i):void 0;if(void 0!==o)return n[e]=o;n[e]=qp(n[e])&&qp(r)?nd([n[e],r],t):qp(r)?nd([{},r],t):Array.isArray(r)?r.slice():r}for(var i=0,o=e.length;i<o;i++)td(e[i],r);return n}function rd(e,t,n){return nd([e,t],n)Dp||(Dp={}));var ad={exports:{}},sd={exports:{}};(sd),function(e){var t=sd.exports.default;function n(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
e.exports=n=function(){return r},e.exports.__esModule=!0,e.exports.default=e.exports;var r={},i=Object.prototype,o=i.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag"try{l({},"")}catch(I){l}function f(e,t,n,r){var i=Object.create((t&&t.prototype instanceof d?t:d).prototype),o=new T(r||[]);return i._invoke(e,n,o),ir.wrap=f;var p={};function d(){}function v(){}function g(){}var m={};l(m,s,(function(){return this}));var y=Object.getPrototypeOf,w=y&&y(y(O([])));w&&w!==i&&o.call(w,s)&&(m=w);var b=g.prototype=d.prototype=Object.create(m)v.prototype=g,l(b,"constructor",g),l(g,"constructor",v),v.displayName=l(g,u,"GeneratorFunction"),r.isGeneratorFunction,r.mark,r.awrap,_(x.prototype),l(x.prototype,c,(function(){return this})),r.AsyncIterator=x,r.async,_(b),l(b,u,"Generator"),l(b,s,(function(){return this})),l(b,"toString",(function(){return"[object Generator]"})),r.keys,r.values=O,T.prototype={constructor:T,reset,stop,dispatchException,abrupt,complete,finish,catch,delegateYield},r}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports}(ad);var cd=ad.exports(),ud=cd;try{regeneratorRuntime=cd}catch(am){"object"===("undefined"==typeof globalThis?"undefined":t(globalThis))?globalThis.regeneratorRuntime=cd:Function("r","regeneratorRuntime = r")(cd)}var ld,fd,hd,pd=ud;(ld||(ld={}))(fd||(fd={})),function(e){e.Win="Win",e.MacOS="MacOS",e.Linux="Linux",e.unknown="unknown"}(hd||(hd={}));var dd=window.navigator.userAgent;function vd(){return/Android|webOS|iPhone|iPod|iPad|BlackBerry|windows phone/i.test(window.navigator.userAgent)?function(){var e=navigator.userAgent.toLowerCase(),t={android:/android|linux/i,iPhone:/iphone/i,iPad:/ipad/i,windows:/windows/i},n=fd.unknown;t.android.test(e)&&(n=fd.android);t.iPhone.test(e)&&(n=fd.iPhone);t.iPad.test(e)&&(n=fd.iPad);t.windows.test(e)&&(n=fd.windowsPhone);return n}():gd()}function gd(){var e=navigator.platform?navigator.platform.toLowerCase():"";if(e){if(/win/.test(e))return hd.Win;if(/mac/.test(e))return hd.MacOS;if(/linux/.test(e))return hd.Linux}return hd.unknown}function md(){var e=navigator.userAgent.toLowerCase(),t={ie:/msie/i,ie11:/rv:11.0/i,edge:/edge/i,chrome:/chrome|crios/i,safari:/safari|mac/i,qq:/qq/i,_2345:/2345/i,wechat:/micromessenger/i,firefox:/firefox|fxios/i,cheetah:/lbbrowser|liebao/i,opera:/opr/i,baidu:/bidubrowser|baidu/i,uc:/ubrowser|ucbrowser/i,sougou:/metasr|sogou/i,_360:/QihooBrowser|360EE|360SE/i},n=ld.unknown;return t.safari.test(e)&&(n=ld.safari),t.chrome.test(e)&&(n=ld.chrome),(t.ie.test(e)||t.ie11.test(e))&&(n=ld.ie),t.edge.test(e)&&(n=ld.edge),t.firefox.test(e)&&(n=ld.firefox),t.qq.test(e)&&(n=ld.qq),t.wechat.test(e)&&(n=ld.wechat),t._2345.test(e)&&(n=ld._2345),t.cheetah.test(e)&&(n=ld.cheetah),t.opera.test(e)&&(n=ld.opera),t.uc.test(e)&&(n=ld.uc),t.baidu.test(e)&&(n=ld.baidu),t.sougou.test(e)&&(n=ld.sougou),t._360.test(e)&&(n=ld._360),n}function yd(){var e=window.screen.width,t=window.screen.height;return e&&t?e+"*"+t:""}function wd(){var e=window.document.documentElement.clientWidth,t=window.document.documentElement.clientHeight;return e&&t?e+"*"+t:""}function bd(){var e;if(null!==(e=window.navigator.connection)&&void 0!==e&&e.effectiveType)return window.navigator.connection.effectiveType;var t="unkown",n=window.navigator.userAgent.match(/NetType\/\w+/);return n&&(t=n[0].toLowerCase().replace("nettype/","")),t}function _d(){return!(!window.qwebkit||!window.qwebkit.jsAsynCall)||!window.cefQuery&&window.external&&window.external.jsAsynCall}function xd(){return!(!window.cefQuery||"function wpsQuery() { [native code] }"!==window.cefQuery.toString()||window.Extention)var Sd="[WPS_APM_SDK]",Ed=function(){function e(){Sp(this,e),jp(this,"enabled",void 0),this.enabled=!1}return Tp(e,[{key:"disable",value:function(){this.enabled=!1}},{key:"enable",value},{key:"log",value:function(){var e;if(this.enabled){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=globalThis.console).log.apply(e,["".concat(Sd,":")].concat(n))}}},{key:"warn",value:function(){var e;if(this.enabled){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=globalThis.console).warn.apply(e,["".concat(Sd,":")].concat(n))}}},{key:"error",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=globalThis.console).error.apply(e,["".concat(Sd,":")].concat(n))}}]),e}(),Td=new Ed,Od=new(function()return Tp(e,[{key:"getItem",value:function(e){if(!window.localStorage||!e)return null;var t=window.localStorage.getItem(this.pref+e);if(t)try{var n=JSON.parse(t),r=n.value,i=n._expiresTime;return i&&"number"==typeof i?Date.now()>=i?(window.localStorage.removeItem(this.pref+e),null):r:n}catch(o){return t}return null}},{key:"setItem",value:function(e,n,r){if(window.localStorage&&e&&n){var i=n;r&&(i={value:n,_expiresTime:r}),window.localStorage.setItem(this.pref+e,"object"===t(i)?Yp(i):i)}}}]),e}()),Cd=function(){function e(){Sp(this,e),jp(this,"opts",{limit:10240,volume:10485760}),jp(this,"store",[])}return Tp(e,[{key:"insert",value:function(e){for(var t=0;t<=e.length-1;t++)if(ed(e[t])>=this.opts.limit)return void Td.warn("APM-SDK single data overage ".concat(this.opts.limit/1024,"kb"));ed(this.store)>=this.opts.volume?Td.warn("APM-SDK memory storage overage ".concat(this.opts.volume/1024,"kb")):this.store=this.store.concat(e)}},{key:"find",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.store.length-e;return this.store.splice(t=t<0?0:t,e)}},{key:"delete",value:function(){}}]),e}()var Pd,Rd={exports:{}},Ad={exports:{}};Ad.exports=(Pd=Pd||function(t,n){var r;if("undefined"!=typeof window&&window.crypto&&(r=window.crypto),"undefined"!=typeof self&&self.crypto&&(r=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(r=globalThis.crypto),!r&&"undefined"!=typeof window&&window.msCrypto&&(r=window.msCrypto),!r&&void 0!==e&&e.crypto&&(r=e.crypto),!r)try{r=require("crypto")}catch(g){}var i,o=Object.create|(),a={},s=a.lib={},c=s.Base={extend,create,init:function(){},mixIn,clone},u=s.WordArray=c.extend({init,toString,concat,clamp,clone,random}),l=a.enc={},f=l.Hex={stringify,parse},h=l.Latin1={stringify,parse},p=l.Utf8={stringify,parse},d=s.BufferedBlockAlgorithm=c.extend({reset,_append,_process,clone:function(){var e=c.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});s.Hasher=d.extend({cfg:c.extend(),init,reset:function(){d.reset.call(this),this._doReset()},update,finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper,_createHmacHelper});var v=a.algo={};return a}(Math),Pd);var jd={exports:{}};!function(e,t){e.exports=function(e){return function(){var t=e.lib.WordArraye.enc.Base64={stringify,parse,_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),e.enc.Base64}(Ad.exports)}(jd);var Dd=jd.exports,Md={exports:{}};!function(e,t){e.exports(Ad.exports)}(Md);var Nd={exports:{}},Bd={exports:{}};!function(e,t){e.exports=function(e){return r=(n=(t=e).lib).WordArray,o=[],a=t.algo.SHA1=(i=n.Hasher).extend({_doReset,_doProcessBlock,_doFinalize,clone}),t.SHA1=i._createHelper(a),t.HmacSHA1=i._createHmacHelper(a),e.SHA1;var t,n,r,i,o,a}(Ad.exports)}(Bd);var Ld={exports:{}};!function(e,t){e.exports=function(e){!function(){var t=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init,reset,update,finalize})}()}(Ad.exports)}(Ld),function(e,t){e.exports=function(e){return i=(n=(t=e).lib).WordArray,a=(o=t.algo).EvpKDF=(r=n.Base).extend({cfg:r.extend({keySize:4,hasher:o.MD5,iterations:1}),init,compute}),t.EvpKDF,e.EvpKDF;var t,n,r,i,o,a}(Ad.exports)}(Nd);var Fd={exports:{}};!function(e,t){e.exports=function(e){e.lib.Cipher||function(t){var n=e,r=n.lib,i=r.Base,o=r.WordArray,a=r.BufferedBlockAlgorithm,s=n.enc.Base64,c=n.algo.EvpKDF,u=r.Cipher=a.extend({cfg:i.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor,init,reset,process,finalize,keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper()});r.StreamCipher=u.extend({_doFinalize,blockSize:1});var l=n.mode={},f=r.BlockCipherMode=i.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor,init}),h=l.CBC(),p=(n.pad={}).Pkcs7={pad,unpad};r.BlockCipher=u.extend({cfg:u.cfg.extend({mode:h,padding:p}),reset,_doProcessBlock,_doFinalize,blockSize:4});var d=r.CipherParams=i.extend({init,toString}),v=(n.format={}).OpenSSL={stringify,parse},g=r.SerializableCipher=i.extend({cfg:i.extend({format:v}),encrypt,decrypt,_parse}),m=(n.kdf={}).OpenSSL={execute},y=r.PasswordBasedCipher=g.extend({cfg:g.cfg.extend({kdf:m}),encrypt,decrypt})}()}(Ad.exports)}(Fd),function(e,t){e.exports=function(e){return(),e.AES}(Ad.exports)}(Rd);var Hd=Rd.exports,qd={exports:{}};!function(e,t){e.exports=function(e){return e.enc.Utf8}(Ad.exports)}(qd);var zd=qd.exports,Ud={exports:{}};!function(e,t){e.exports(Ad.exports)}(Ud);var Wd=Ud.exports,Vd=function(){function e(t){Sp(this,e),jp(this,"domain","https://kbee.wps.cn"),jp(this,"token",void 0),jp(this,"netWorkService",void 0),jp(this,"reportData",void 0),jp(this,"baseInfo",void 0),jp(this,"secret",{originKey:"h#8n7Ih7zE9ay$a5",originIv:"Sc^8r%hp",key:"",iv:""}),this.netWorkService=t,this.reportData={enableSession:!0,busInfo:[]}}var t,n;return Tp(e,[{key:"setBaseUrl",value:function(e){this.domain=e}},{key:"setBaseInfo",value:function(e){this.baseInfo=e,delete this.reportData.sessionID}},{key:"getBaseInfo",value:function(){return this.baseInfo}},{key:"serverHandshake",value:(n=od(pd.mark((function e(){var t,n;return pd.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.baseInfo){e.next=3;break}return Td.error("serverHandshake baseInfo is null"),e.abrupt("return",null);case 3:return e.next=5,this.netWorkService.get(this.domain+"/api/v1/ask",{headers:{"Client-Type":this.baseInfo._at,"Client-Chan":this.baseInfo._ch,"Client-Ver":this.baseInfo._av},params:{appid:this.baseInfo._appid,secret:"v1"}}).catch((function(e){return e}));case 5:if(!((t=e.sent)&&t.data&&0===t.data.code&&t.data.data)){e.next=11;break}return this.token=(n=t.data.data).token,n.secret&&(this.secret.key=this.secret.originKey+Dd.parse(n.secret.key).toString(zd),this.secret.iv=this.secret.originIv+Dd.parse(n.secret.iv).toString(zd)),e.abrupt("return",n);case 11:return Td.error("APM-SDK server handshake fail",t),e.abrupt("return",null);case 13:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"report",value:(t=od(pd.mark((function e(t){var n,r,i,o,a,s;return pd.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.token&&!(t.length<=0)&&this.baseInfo){e.next=2;break}return e.abrupt("return",!1);case 2:if(this.reportData.baseInfo=this.reportData.sessionID?void 0:this.baseInfo,this.reportData.busInfo=t,n=this.reportData,e.prev=5,32===this.secret.key.length||16===this.secret.iv.length){e.next=8;break}throw"密钥异常";case 8:r=zd.parse(this.secret.iv),i=zd.parse(this.secret.key),o=Yp(n),n=Hd.encrypt(o,i,{iv:r,padding:Wd}).ciphertext.toString(Dd),e.next=18;break;case 14:return e.prev=14,e.t0=e.catch(5),Td.error("upload data encrypt fail",e.t0),e.abrupt("return",!1);case 18:return e.next=20,this.netWorkService.post(this.domain+"/api/v1/collect/data",n,{headers:{"Client-Type":this.baseInfo._at,"Client-Chan":this.baseInfo._ch,"Client-Ver":this.baseInfo._av,"x-m-token":this.token,"x-encrypt-version":" web-v1","Content-type":"text"}}).catch((function(e){return e}));case 20:if(!(a=e.sent)||!a.data){e.next=35;break}if(0!==(s=a.data).code||!s.data){e.next=27;break}return this.reportData.sessionID=s.data.session_id||this.reportData.sessionID,delete this.reportData.baseInfo,e.abrupt("return",!0);case 27:if(10140!==s.code&&10141!==s.code){e.next=31;break}return delete this.reportData.sessionID,this.serverHandshake(),e.abrupt("return",!1);case 31:if(10122!==s.code){e.next=35;break}return delete this.reportData.sessionID,Td.warn("APM-SDK upload key sessionID is expired",a),e.abrupt("return",!1);case 35:return delete this.reportData.sessionID,Td.error("APM-SDK upload data error",a),e.abrupt("return",!1);case 38:case"end":return e.stop()}}),e,this,[[5,14]])}))),function(e){return t.apply(this,arguments)}))}()}var Gd=function(){function e(){Sp(this,e),jp(this,"listeners",new Map),jp(this,"eventQueue",new Map)}return Tp(e,[{key:"clearEventCacheByName",value:function(e){var t=this.eventQueue.get(e);if(t){var n=this.listeners.get(e);n&&n!==Bp&&(Td.log("EventEmit-emit",e,t),n(t),this.eventQueue.delete(e))}}},{key:"emit",value:function(e,t){this.clearEventCacheByName(e);var n=this.listeners.get(e);if(!n){var r=this.eventQueue.get(e)||[];return t=Array.isArray(t)?t:[].concat(t),r.push.apply(r,Xd(t)),void this.eventQueue.set(e,r)}n!==Bp&&(Td.log("EventEmit-emit",e,t),n(t))}},{key:"on",value:function(e,t){var n=this.listeners.get(e);n&&n!==Bp||(Td.log("EventEmit-on",e),this.listeners.set(e,t)),this.clearEventCacheByName(e)}},{key:"remove",value:function(e){Td.log("EventEmit-reomve",e),this.eventQueue.delete(e),this.listeners.set(e,Bp)}}]),e}(),Ygi,"]")}function Zd(e,n,r){if(!n)return e;var i;if(r)i=r(n);else if("[object URLSearchParams]"===Object.prototype.toString.call(n))i=n.toString();else{var o=[];td(n,(function(e,n){null!=n&&(Array.isArray(n)?e+="[]":n=[n],td(n,(functical===t(e)}(r)&&(r=JSON.stringify(r)):r=r.toISOString(),o.push($d(String(e))+"="+$d(r))})))})),i=o.join("&")}if(i){var a=e.indexOf("#");-1!==a&&(e=e.slice(0,a)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e}var ev=function(){function e(t){Sp(this,e),jp(this,"config",void 0),this.config={url:(null==t?void 0:t.url)||"",method:"get",headers:{"Content-type":"application/json"},responseType:"json",params:{},paramsSerializer:null,data:{},timeout:1e4,withCredentials:!1,adapter:null,valida&&e<300}},this.config=rd(this.config,t)}return Tp(e,[{key:"get",value:function(e,t){return this.request(rd({method:"get",url:e},t))}},{key:"post",value:function(e,t,n){return this.request(rd({method:"post",url:e,data:t},n))}},{key:"request",value:function(e){return this.config.adapter?this.config.adapter(rd(this.config,e)):Promise.reject("请检查APM-SDK网络适配器配置!")}}],function(t){return new e(t)}}]),e}(128|t>>>6&63)+tv(128|63&t)},rv=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,iv=fu(e){return e.replace(rv,nv)}(e))},ov=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}.che){return window.atob(e).replac":"_"})"/"})).replace(/[^A-Za-z0-9\+\/]/g,""))}};var uv=function(){function e(t,n){Sp(this,e),this.encode=t||cv.encode.bind(cv),this.decode=n||cv.decode.bind(cv),this.queryKey="cefQuery"}return Tp(e,[{key:"setQueryKey",value:function(e){this.queryKey=e}},{key:"setEncode",value:function(e){this.encode=e}},{key:"setDecode",value:function(e){this.decode=e}},{key:"_exceptionHandler",value:function(e,t,n){return e.message="Client Api Exec Catch Error: \n          method: ".concat(t,", error: ").concat(e.message),n&&(e.message+=", response: ".concat(JSON.stringify(n)),e.response=n),e}},{key:"execJson",value:function(e,t){try{return e=this.encode(JSON.stringify(e)),window[this.queryKey]({request:'fromJSAsynCallBase64("'+e+'")',persistent:!1})}catch(n){t&&t(this._exceptionHandler(n,e.method))}}},{key:"exec",value:function(e,t,n){var r=this,i={method:e};if("function"==typeof t?n=t:void 0!==t&&(i.params=t),"function"==typeof n){var o=e+"_async_callback_"+setTimeout((function(){}),0);window[o]=function(t){delete window[o];var i=null;try{if(t=r.decode(t),"ok"!==(t=JSON.parse(t)).callstatus)throw new Error("execute api failed")}catch(a){i=r._exceptionHandler(a,e,t)}n(i,t)},i.callback='window["'.concat(o,'"]')}return this.execJson(i,n)}},{key:"execPromise",value:func.exec(e,t,(function(e,t){e?i(e):r(t)}))}))}}]),e}(),lv=new uv;function fv(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(t,n,r){var i=r.value;r.value=od(pd.mark((function t(){var r,o,a,s,c=arguments;return pd.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.api[e||n],t.next=3,this.checkClientAPI(r);case 3:if(!t.sent){t.next=6;break}for(o=c.length,a=new Array(o),s=0;s<o;s++)a[s]=c[s];return t.abrupt("return",null==i?void 0:i.apply(this,a));case 6:return Td.warn("client api ".concat(r," is not support")),t.abrupt("return",Promise.reject("client api ".concat(r," is not support")));case 8:case"end":return t.stop()}}),t,this)})))}}var hv=function(){function e(){Sp(this,e),jp(this,"api",{support:"common.util.support",getAppInfo:"common.wpsoffice.getAppInfo",writeLog:"common.util.writeLog",getPluginInfo:"common.plugin.getPluginInfo",getProfileInfo:"common.profile.getProfileInfo",httpRequest:"common.network.httpRequest",getBrowserTraceInfo:"common.profile.getBrowserTraceInfo",getBrowserTraceId:"common.profile.getBrowserTraceId",setBrowserTraceId:"common.profile.setBrowserTraceId"}),jp(this,"supportAPISet",new Set)}var t,n,r,i,o,a,s,c,u,l;return Tp(e,[{key:"execPromise",value:(l=od(t,n));caion(e,t){return l.apply(this,arguments)})},{key:"checkClientAPI",value:(u=od(pd.mark((function e(t){var n;return pd.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.supportAPISet.has(t)){e.next=2;break}return e.abrupt("return",!0);case 2:return e.next=4,this.execPromise(this.api.support,{api:t}).catch((function(e){return Td.error(e),null}));case 4:if(!(n=e.sent)||"ok"!==n.callstatus||!n.result){e.next=8;break}return this.supportAPISet.add(t),e.abrupt("return",!0);case 8:return e.abrupt("return",!1);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"getAppInfo",value:(c=od(pd.mark((function e(){var t;return pd.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.execPromise(this.api.getAppInfo).catch((function(e){return Td.error(e),null}));case 2:if(!(t=e.sent)||"ok"!==t.callstatus){e.next=5;break}return e.abrupt("return",t);case 5:return e.abrupt("return",null);case 6:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"writeLog",value:(s=od(pd.mark((function e(t){var n,r,i,o,a;return pd.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.level,r=t.module,i=t.data,a=void 0!==(o=t.dataRollback)&&o,e.next=3,this.execPromise(this.api.writeLog,{level:n,module:r,data:i,data_rollback:a}).catch((function(e){return Td.error(e),null}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"httpRequest",value:(a=od(pd.mark((function e(t){var n,r,i,o,a,s,c,u,l,f;return pd.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.url,r=t.type,i=t.data,a=void 0===(o=t.header)?{}:o,c=void 0===(s=t.cookie)?"":s,u=t.timeout,f=void 0===(l=t.toJson)||l,e.next=3,this.execPromise(this.api.httpRequest,{url:n,type:r,data:i,header:a,cookie:c,timeout:u,toJson:f}).catch((function(e){return Td.error(e),null}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"getProfileInfo",value:(o=od(pd.mark((function e(){return pd.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.execPromise(this.api.getProfileInfo).catch((function(e){return Td.error(e),null}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"getPluginInfo",value:(i=od(pd.mark((function e(t){return pd.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,this.execPromise(this.api.getPluginInfo,{pluginName:t}).catch((function(e){return Td.error(e),null}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"getBrowserTraceInfo",value:(r=od(pd.mark((function e(){return pd.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.execPromise(this.api.getBrowserTraceInfo).catch((function(e){return Td.error(e),null}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"getBrowserTraceId",value:(n=od(pd.mark((function e(){return pd.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.execPromise(this.api.getBrowserTraceId).catch((function(e){return Td.error(e),null}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"setBrowserTraceId",value:(t=od(pd.mark((function e(t){return pd.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.execPromise(this.apich((function(e){return Td.error(e),null}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}();Id([fv()],hv.prototype,"getAppInfo",null),Id([fv()],hv.prototype,"writeLog",null),Id([fv()],hv.prototype,"httpRequest",null),Id([fv()],hv.prototype,"getProfileInfo",null),Id([fv()],hv.prototype,"getPluginInfo",null),Id([fv()],hv.prototype,"getBrowserTraceInfo",null),Id([fv()],hv.prototype,"getBrowserTraceId",null),Id([fv()],hv.prototype,"setBrowserTraceId",null);var pv=new hv;var dv=ev.createInstance({adapter:function(e){return new Promise((function(t,n){var r=e.data,i=e.headers,o=e.responseType,a=new XMLHttpRequest;a.open(e.method,Zd(e.url,e.params,e.paramsSerializer),!0),a.onreadystatechange=function(){a&&4===a.readyState&&setTimeout((function(){if(a){var r,i,s,c=(r=a.getAllResponseHeaders(),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],s={},r?(r.split("\n").forEach((function(e){var t=e.indexOf(":"),n=e.substring(0,t).trim().toLowerCase(),r=e.substring(t+1).trim();if(n){if(s[n]&&i.indexOf(n)>=0)return;s[n]="set-cookie"===n?(s[n]||[]).concat([r]):s[n]?s[n]+", "+r:r}})),s):s),u={data:o&&"text"!==o&&"json"!==o?a.response:a.responseText,status:a.status,statusText:a.statusText,headers:c,config:e,request:a};try{u.data=JSON.parse(u.data)}catch(l){Td.error(l)}u.status&&e.validateStatus&&!e.validateStatus(uor=function(){n("Network Error"),a=null},a.timeout=e.timeout,a.ontimeout=function(){n(e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded"),a=null},Object.keys(i).forEach((function(e){void 0===r&&"content-type"===e.toLowerCase()?delete i[e]:a&&a.setRequestHeader(e,i[e].toString())})),a.withCredentials=e.withCredentials,"json"!==o&&(a.responseType=e.responseType),r||(r=null),a.send(r)}))}}),vv=function(){function e(){Sp(this,e)}var t;return Tp(e,null,[{key:"getConfig",value:function(){return this.config}},{key:"addConfigQueue",value:function(e){this.configQueue.concat(Array.isArray(e)?e:[e])}},{key:"flushConfigQueue",value:function(){for(;this.configQueue.length>0;)this.setConfig(this.configQueue.shift())}},{key:"setConfig",value:function(e){e&&(this.config=nd([this.config,e,this.serverConfig],(function(e,t,n){if("vue"===n&&(e&&!e.vue||t&&t.vue)||"app"===n)return e||t})),Td.log("client - SetConfig",this.config))}},{key:"fetchServerConfig",value:(t=od(pd.mark((function e(){var t;return pd.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,dv.get("https://fe-static.wpscdn.cn"+"/apm_sdk_proxy/config/".concat("client-common"),{params:{appId:this.config.appId,appName:this.config.appName,apppVersion}}).catch((function(e){return e}));case 2:(t=e.sent)&&t.data&&(this.serverConfig=t.data,this.setConfig({}));case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.applyhis.serverConfig={},this.configQueue=[]}}]),e}();jp(vv,"config",{}),jp(vv,"serverConfig",{}),jr gv=function(){function e(){Sp(this,e)}rction(){return Array.from(this.plugins)}},{key:"addPlugin",value:function(e){this.plugins.add(e)}},{key:"removePlugin",value:function(e){this.plugins.delete(e)}},{key:"registerConfigureHandler",value:function(e){this.configureHandlers.add(e)}},{key:"removeConfigureHandler",value:function(e){this.configureHandlers.delete(e)}},{key:"activeConfigurePlugin",value:function(){var e=this;this.plugins.forEach(function(){var t=od(pd.mark((function t(n){return pd.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.configureHandl;case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,(e){e.destroy()})),this.plugins.clear()}}]),e}();function mv(){return mv=od(pd.mark((function e(t){return pd.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isReady){e.next=21;break}if(!(this.retryTime>=this.MAX_RETRY_TIMES)){e.next=5;break}return Td.error("transfer server handshake overflow ".concat(this.MAX_RETRY_TIMES," times by retry")),this.transferQueue=[],e.abrupt("return",!1);case 5:if(this.transferQueue.push(t),!this.isHandshaking){e.next=8;break}return e.abrupt("return",!1);case 8:return e.next=10,this.serverHandshake();case 10:if(e.sent){e.next=14;break}return this.retryTime++,e.abrupt("return",!1);case 14:this.isReady=!0;case 15:if(!(this.transferQueue.length>0)){e.next=20;break}return e.next=18,this.apmService.report(this.transferQueue.pop());case 18:e.next=15;break;case 20:return e.abrupt("return",!1);case 21:return e.abrupt("return",!0);case 22:case"end":return e.stop()}}),e,this)}))),mv.apply(this,arguments)}jp(gv,"plugins",new Set),jp(gv,"configureHandlers",new Set);var yv=function(){function e(){Sp(this,e),jp(this,"MAX_RETRY_TIMES",3),jp(this,"isHandshaking",!1),jp(this,"isReady",!1),jp(this,"retryTime",0),jp(this,"transferQueue",[]),jp(this,"apmService",new Vd(dv))}var t,n,r,i;return Tp(e,[{key:"updateBaseInfo",value:(i=od(pd.mark((function e(t){var n,r,i,o;return pd.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=vv.getConfig(),(r=new Mp)._appid=n.appId||t||"",r._aid=n.accountId?String(n.accountId):"",r._biz=n.appName,r._fv=n.appVersion,r._ua=dd,r._os=vd(),(i=Od.getItem("DEVICEID"))||(i=Qp(),Od.setItem("DEVICEID",i)),r._did=i,(o=Od.getItem("UUID"))||(o=Qp(),Od.setItem("UUID",o)),r._uuid=o,r._c=_d()?"qt":xd()?"cef":"browser",r._brand=md(),r._network=bd(),r._screen=yd(),r._ws=wd(),this.apmService.setBaseInfo(r);case 20:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:";case 3:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"serverHandshake",value:(n=od(pd.mark((function e(){var t;return pd.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isHandshaking=!0,e.next=3,this.apmService.serverHandshake().catch((function(){return null}));case 3:return t=e.sent,this.isHandshaking=!1,e.abrupt("return",!!t);case 6:nction(){return n.apply(this,arguments)})},{key:"transfer",value:(t=osent);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}();Id([function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,r,i){var o=i.value;i.value=od(pd.mark((function n(){var r,i,a,s,c=arguments;return pd.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:for(r=c.length,i=new Array(r),a=0;a<r;a++)i[a]=c[a];return n.next=3,e.call.apply(e,[this].concat(i));case 3:if(s=n.sent,!(!t||t&&s)){n.next=9;break}return n.next=7,o.apply(this,i);case 7:return n.abrupt("return",n.sent);case 9:return n.abrupt("return");case 10:case"end":return n.stop()}}),n,this)})))}}((function(e){return mv.apply(this,arguments)}),!0)],yv.prototype,"transfer",null);var wv=function(){function e(t){Sp(this,e),jp(this,"db",void 0),jp(this,"transfer",void 0),jp(this,"list",[]),jp(this,"COMPOSE_LIMIT",10),jp(this,"DB_CONSUME_LIMIT",3),jp(this,"CONSUME_NORMAL",1e3),jp(this,"CONSUME_SLOW",3e3),jp(this,"DBConsumeTime",0),jp(this,"time",1e3),jp(this,"isCouldComposed",!1),jp(this,"isSlowConsume",!1),this.db=(null==t?void 0:t.db)||new Cd,this.transfer=(null==t?void 0:t.transfer)||new:function(){this.startDBConsumeThread()}},{key:"startDBConsumeThread",value:function(){var e=this;setTimeout(od(pd.mark((function t(){var n,r;return pd.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.db.find(e.COMPOSE_LIMIT)||[],e.DBConsumeTime++,e.isSlowConsume=e.DBConsumeTime>e.DB_CONSUME_LIMIT,e.time=e.isSlowConsume?e.CONSUME_SLOW:e.CONSUME_NORMAL,!((r=e.handleCompose(n)).length>0)){t.next=9;break}return t.next=8,e.handleTransfer(r);case 8:e.isCouldComposed&&(e.DBConsumeTime=0);case 9:e.startDBConsumeThread();case 10:case"end":return t.stop()}}),t)}))),this.time)}},{key:"handleCompose",value:function(e){if(this.list=this.list.concat(e),this.isCouldComposed=this.list.length>=this.COMPOSE_LIMIT,this.list.length>0&&(this.isCouldComposed||this.isSlowConsume)){Td.log("process - compose",this.list);var t=[],n=new Map;return this.list.forEach((function(e){var t="".concat(e._analy_type,"-").concat(e._ct,"-").concat(Yp(e.common_info)),r=n.get(t)||[];n.set(t,r.concat([e]))})),n.forEach((function(e){t=t.concat(e.reduce((function(e,t){return e._analy_type=t._analy_type,e._analy_branch=t._analy_branch,e._sampling_rate=t._sampling_rate,e._ct=t._ct,e.common_info=t.common_info,e.contents=e.contents.concat(t.contents),e}),new Np))})),this.list=[],t}return[]}},{key:"handleTransfer",value:(t=oer(t);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}(),bv=function(){function e(){var t=this;Sp(this,e),jp(this,"process",void 0),jp(this,"SAMPLING_RATE_LIMIT",[1,10,100,1e3]),jp(this,"isInit",!1),jp(this,"isReady",!1),jp(this,"isDestroyed",!1),jp(this,"proxy",void 0),this.process=new wv,this.proxy={on:Yd.on.bind(Yd),emit:Yd.emit.bind(Yd),remove:Yd.remove.bind(Yd),getPlugins:function(){return gv.getPlugins()},runHook:function(e){if(t[e]){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return t[e].apply(t,r)}}},gv.registerConfigureHandler(this.configurePlugin.bind(this))}var t,n,r;return Tp(e,[{key:"use",value:function(e){var t=this;e.forEach((function(e){gv.addPlugin(e),e.monit(t.proxy);var n=e.exportFuncs();for(var r in n)t[r]=n[r]}))}},{key:"configurePlugin",value:(r=od(pd.mark((function e(t){var n=this;return pd.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.setConfig(vv.getConfig());case 2:Yd.on(t.getName(),(function(e){var r;if(t.isEnabled()){var i=t.transform(e,n.process.transfer.apmService.getBaseInfo());null===(r=n.process.db)||void 0===r||r.insert(i)}else Yd.remove(t.getName())}));case 3:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"samplingRateValidator",value:function(e){return!(e&&this.SAMPLING_RATE_LIMIT.indexOf(e)<0)}},{key:"isEnabled",value:(n=od(pd.mark((function e(t){return pd.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}return Td.error("init config is empty"),e.abrupt("return",Promise.resolve(!1));case 3:if(t.appId){e.next=6;break}return Td.error("[appId] value is empty"),e.abrupt("return",Promise.resolve(!1));case 6:if(t.appName){e.next=9;break}return Td.error("[appName] value is empty"),e.abrupt("return",Promise.resolve(!1));case 9:if(t.appVersion){e.next=12;break}return Td.error("[appVersion] value is empty"),e.abrupt("return",Promise.resolve(!1));case 12:if(!t.samplingRate||this.samplingRateValidator(t.samplingRate)){e.next=15;break}return Td.error("[samplingRate] value is not one of ".concat(JSON.stringify(this.SAMPLING_RATE_LIMIT))),e.abrupt("return",!1);case 15:if(!t.domain||/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t.domain)){e.next=18;break}return Td.error("[domain] value format is invalid"),e.abrupt("return",!1);case 18:return e.abrupt("return",Promise.resolve(!0));case 19:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"setConfig",value:function(e){if(e&&!this.isDestroyed)if(!this.isInit||this.isReady){for(var t=nd([e],(function(e,t,n){if("vue"===n&&!t.vue||"app"===n)return t})),n=vv.getConfig(),r=0,i=["appId","appName","appVersion"];r<i.length;r++){var o=i[r];n[o]&&t[o]&&(delete t[o],Td.warn("[".concat(o,"] value is not allow repeated modification")))}this.triggerDebugMode(t.isDebug),t.samplingRate&&!this.samplingRateValidator(t.samplingRate)&&(delete t.samplingRate,Td.warn("[samplingRate] value is not one of ".concat(JSON.stringify(this.SAMPLING_RATE_LIMIT)))),t.pluginConfig&&Object.keys(t.pluginConfig).forEach((function(e){var n;null!==(n=t.pluginConfig[e])&&void 0!==n&&n.samplingRate&&delete t.pluginConfig[e].samplingRate})),vv.setConfig(t),this.isInit&&this.isReady&&gv.activeConfigurePlugin(),this.process.transfer.updateBaseInfo()}else vv.addConfigQueue(e)}},{key:"init",value:(t=od(pd.mark((function e(t){var n,r;return pd.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isInit){e.next=3;break}return Td.warn("please not repeat run init method"),e.abrupt("return");case 3:return this.isInit=!0,this.triggerDebugMode(t.isDebug),Td.log("client - init"),e.next=8,this.isEnabled(t).catch((function(){return!1}));case 8:if(e.sent){e.next=11;break}return this.destroy("init config invalid"),e.abrupt("return",!1);case 11:return vv.setConfig(t),e.next=14,vv.fetchServerConfig().catch((function(){return null}));case 14:return r=vv.getConfig(),e.next=17,this.process.transfer.updateBaseInfo(r.appId);case 17:if(Xp(r.samplingRate,null===(n=this.process.transfer.apmService.getBaseInfo())||void 0===n?void 0:n._uuid)){e.next=20;break}return this.destroy("user is not satisfy ".concat(r.samplingRate," samplingRate")),e.abrupt("return",!1);case 20:return this.triggerDebugMode(r.isDebug),r.domain&&this.process.transfer.apmService.setBaseUrl(r.domain),this.isReady=!0,gv.activeConfigurePlugin(),vv.flushConfigQueue(),this.process.init(),e.abrupt("return",!0);case 27:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"triggerDebugMode",value:function(e){"[object Boolean]"===Object.prototype.toString.call(e)&&(e?Td.enable():Td.disable())}},{key:"destroy",value:function(e){gv.destroyed(),vv.destroy(),this.isDestroyed=!0,Td.warn("SDK destroyed by ".concat(e," !!"))}}]),e}();function _v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Op(e);if(t){var i=Op(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ap(this,n)}}var xv=function(e){Rp(n,e);var t=_v(n);function n(){return Sp(this,n),t.apply(this,arguments)}return Tp(n,[{key:"isEnabled",value:function(e){return(null!==(t=window)&&void 0!==t&&t.ActiveXObject||"ActiveXObject"in window)&&function(){var e=window.navigator.userAgent,t=e.indexOf("Trident")>-1&&e.indexOf("rv:11.0")>-1,n=e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1;if(t)return 11;if(n){var r=new RegExp("MSIE (\\d+\\.\\d+);"),i=e.match(r);if(i&&i[1]){var o=parseFloat(i[1]);return window.isNaN(o)?-1:o}}return-1}()<10?(Td.error("APM sdk is not support IE<10"),Promise.resolve(!1)):Ip(Op(n.prototype),"isEnabled",this).call(this,e);var t}}]),n}(bv);function kv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Op(e);if(t){var i=Op(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ap(this,n)}}var Sv=function(e){Rp(r,e);var t,n=kv(r);function r(){return Sp(this,r),n.apply(this,arguments)}return Tp(r,[{key:"updateBaseInfo",value:(t=od(pd.mark((function e(t){var n,r,i,o,a,s,c,u,l;return pd.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=vv.getConfig(),(r=new Mp)._appid=n.appId||t||"",r._aid=n.accountId?String(n.accountId):"",r._biz=n.appName,r._fv=n.appVersion,e.next=8,pv.getAppInfo().catch((function(){return null}));case 8:return(i=e.sent)?(r._av=i.version,r._ch=i.channel,r._did=i.hdid3,r._uuid=i.uuid):((o=Od.getItem("UUID"))||(o=Qp(),Od.setItem("UUID",o)),r._uuid=o,(a=Od.getItem("DEVICEID"))||(a=Qp(),Od.setItem("DEVICEID",a)),r._did=a),e.next=12,pv.getBrowserTraceId().catch(od(pd.mark((function e(){return pd.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pv.getBrowserTraceInfo().catch((function(){return null}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));case 12:if(!(s=e.sent)||"ok"!==s.callstatus||!s.result){e.next=22;break}if(c=s.result,u=globalThis.sessionStorage.getItem("APM_SDK_SESSIONID")){e.next=21;break}return u=Qp(),globalThis.sessionStorage.setItem("APM_SDK_SESSIONID",u),e.next=21,pv.setBrowserTraceId(u).catch((function(){return null}));case 21:r._traceid="".concat(c.appid,"#").concat(c.pid,"#").concat(c.browserid,"#").concat(u);case 22:if(r._pn=n.pluginName||"",!r._pn){e.next=28;break}return fo(r._pn).catch((function(){return null}));case 26:r._pv=(null==(l=e.sent)?void 0:l.version)||"";case 28:r._ua=dd,r._os=gd(),r._c=_d()?"qt":xd()?"cef":"browser",r._brand=md(),r._network=bd(),r._screen=yd(),r._ws=wd(),this.apmService.setBaseInfo(r);case 36:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),r}(yv);function Ev(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Op(e);if(t){var i=Op(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ap(this,n)}}turn Sp(this,r),n.apply(this,arguments)}return Tp(r,[{key:"updateBaseInfo",value:(t=od(pd.mark((function e(t){var n,r,i,o,a,s,c,u,l,f,h,p,d,v,g,m,y,w,b;return pd.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=vv.getConfig(),(r=new Mp)._appid=n.appId||t||"",r._aid=n.accountId?String(n.accountId):"",r._biz=n.appName,r._fv=n.appVersion;try{o=null===(i=window.Extention)||void 0===i?void 0:i.Base.WpsOffice.getVersion(),r._av=o.code&&o.result.version||""}catch(_){Td.warn("[baseInfo._av] <window.Extention.Base.WpsOffice.getVersion> call error",_)}try{s=null===(a=window.Extention)||void 0===a?void 0:a.Base.WpsOffice.getChannel(),r._ch=s.code&&s.result.channel||""}catch(_){Td.warn("[baseInfo._ch] <window.Extention.Base.WpsOffice.getChannel()> call error",_)}try{u=null===(c=window.Extention)||void 0===c?void 0:c.Base.WpsOffice.getHdid(),r._did=u.code&&u.result.hdid3||""}catch(_){Td.warn("[baseInfo._did] <window.Extention.Base.WpsOffice.getHdid()> call error",_)}try{f=null===(l=window.Extention)||void 0===l?void 0:l.Base.WpsOffice.getUuid(),r._uuid=f.code&&f.result.uuid||""}catch(_){Td.warn("[baseInfo._uuid] <window.Extention.Base.WpsOffice.getUuid()> call error",_)}r._uuid||((h=Od.getItem("UUID"))||(h=Qp(),Od.setItem("UUID",h)),r._uuid=h),r._did||((p=Od.getItem("DEVICEID"))||(p=Qp(),Od.setItem("DEVICEID",p)),r._did=p);try{(v=null===(d=window.Extention)||void 0===d?void 0:d.Profile.getBrowserTraceId())&&v.code&&v.result&&(g=v.result,(m=globalThis.sessionStorage.getItem("APM_SDK_SESSIONID"))||(m=Qp(),globalThis.sessionStorage.setItem("APM_SDK_SESSIONID",m)),r._traceid="".concat(g.appid,"#").concat(g.pid,"#").concat(g.browserid,"#").concat(m))}catch(_){Td.warn("[baseInfo._traceid] <window.Extention.Profile.getBrowserTraceId()> call error",_)}r._pn=n.pluginName||"";try{(b=r._pn?null===(y=window.Extention)||void 0===y?void 0:y.PluginManager.getPluginInfo(r._pn):null===(w=window.Extention)||void 0===w?void 0:w.PluginManager.getPluginInfo()).code&&(r._pn=b.result.name||"",r._pv=b.result.version||"")}catch(_){Td.warn('[baseInfo._pv] <window.Extention.PluginManager.getPluginInfo("'.concat(r._pn,'")> call error'),_)}r._ua=dd,r._os=gd(),r._c=_d()?"qt":xd()?"cef":kd()?"web-plugin":"browser",r._brand=md(),r._network=bd(),r._screen=yd(),r._ws=wd(),this.apmService.setBaseInfo(r);case 23:case"end":return e.stop()}}),e,this)}))),function(e){repply(this,arguments);return Ap(this,n)}}var Cv=function(e){Rp(n,e);var t=Ov(n);function n(){var e;Sp(this,n),e=t.call(this);var r=new Sv;return kd()&&(r=new Tv),e.process=new wv({transfer:r}),e}return Tp(n,[{key:"isEnabled",value:function(e){return _d()?(Td.error("APM is not support QT"),Promise.resolve(!1)):_d()||xd()||kd()?Ip(Op(n.prototype),"isEnabled",this).call(this,e):(Td.error("please check is in [wps-pc] row i}}return o}}(e,t)||Qd(e,t)||Pv()}function Av(e,t){var n,r,i,o,a="",s="";if(Fp(e)&&e.error)s=(e=e.error).name,a=e.message;else if(Hp(e)||"[object DOMException]"===Object.prototype.toString.call(e)){var c=e.name||(Hp(e)?"DOMError"rn!0;default:return e instanceof Error}}(e)?qp(e)?(s="NonError",a="exception captured with keys: "+Object.keys(e).sort().join(", "),t=Object.assign(t,e)):(s="UnknownError",a="string"==typeof e?e:Yp(e)):(s=e.name,a=e.message);if(/_async_callback_[\d]+/i.test(a))return null;(s=null!==(n=null===(r=t)||void 0===r?void 0:r.type)&&void 0!==n?n:s,t.stack=e&&e.stack?("string"==typeof e.stack?e.stack:Yp(e.stack)).slice(0,1e3):"",null!==globalThis&&void 0!==globalThis&&globalThis._WSMP)&&(t.sourceMapProject=null!==(i=globalThis._WSMP.project)&&void 0!==i?i:"",t.sourceMapVersion=null!==(o=globalThis._WSMP.version)&&void 0!==o?o:"");return Object.assign({message:a,type:s,date:Date.now(),url:Jp(),params:Kp()},t)}function jv(e){if(e&&e.__apm_captured__)return!0;try{Object.defineProperty(e,"__apm_captured__",{enumerable:!1,value:!0,writable:!0,configurable:!0})}catch(t){}return!1}var Dv,Mv="PreCollect",Nv=function(){function e(){Sp(this,e),jp(this,"name","PreCollect"),jp(this,"config",{switch:!0,samplingRate:1}),jp(this,"proxy",null)}var t;return Tp(e,[{key:"getName",value:function(){return this.name}},{key:"monit",value:(t=od(pd.mark((function e(t){var n,r,i,o,a,s,c;return pd.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(n=globalThis.APM_PC)||!n.hook){e.next=15;break}case 2:if(!((null===(r=n.hook)||void 0===r?void 0:r.length)>0)){e.next=15;break}return i=n.hook.shift(),e.prev=4,o=i.shift(),e.next=8,t.runHook.apply(t,[o].concat(Xd(i)));case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(4),Td.error(e.t0);case 13:e.next=2;break;case 15:if(null!=n&&n.plugin)for(;(null===(a=n.plugin)||void 0===a?void 0:a.length)>0;){s=n.plugin.shift();try{c=s.shift(),t.emit(c,s)}catch(u){Td.error(u)}}if(null!=n&&n.listener&&Object.keys(n.listener).forEach((function(e){globalThis.removeEventListener(e,n.listener[e],!0)})),null!=n&&n.onReady)try{null==n||n.onReady()}catch(u){Td.error(u)}this.destroy();case 19:case"end"ction(e){return t.apply(this,arguments)})},{key:"exportFuncs",value:func{}}},{key:"setConfig",vay:"isEnabled",value:funcy:"transform",value:function(){return[]}},{key:"destroy",value:function(){var e;delete globalThis.APM_PC,null===(e=this.proxy)||void 0===e||e.remove(Mv)}}]),e}(),Bv=function(){function e(){Sp(this,e),jp(this,"name","WindowOnError"),jp(this,"config",{switch:!0}),jp(this,"proxy",null),jp(this,"oldOnErrorHandler",Bp)}return Tp(e,[{key:"getName",value:function(){return this.name}},{key:"monit",value:function(e){var t=this;this.proxy=e,e.on(Mv+this.name,(function(n){var r,i,o=Rv(n,6),a=o[4],s=o[5],c=t.errorEventHandler(o[0],o[1],o[2],o[3]);c&&(c.date=null!=a?a:c.date,c.url=null!==(r=null==s?void 0:s.split("?")[0])&&void 0!==r?r:c.url,c.params=null!==(i=null==s?void 0:s.split("?")[1])&&void 0!==i?i:c.params,e.emit(t.name,c))})),e.on("PreCollectCaptureException",(function(n){var r,i,o=Rv(n,4),a=o[2],s=o[3],c=t.errorEventHandler(o[1]);c&&(c.date=null!=a?a:c.date,c.url=null!==(r=null==s?void 0:s.split("?")[0])&&void 0!==r?r:c.url,c.params=null!==(i=null==s?void 0:s.split("?")[1])&&void 0!==i?i:c.params,e.emit(t.name,c))})),this.oldOnErrorHandler=globalThis.onerror||this.oldOnErrorHandler,globalThis.onerror=function(){var n=t.errorEventHandler.apply(t,arguments);return n&&e.emit(t.name,n),!1}}},{key:"exportFuncs",value:function(){return{captureException:this.captureException.bind(this)}}},{key:"setConfig",value:function(e){var t,n,r=null===(t=e.pluginConfig)||void 0===t?void 0:t.windowOnError;this.config.switch=null!==(n=null==r?void 0:r.switch)&&void 0!==n?n:this.config.switch,this.config.samplingRate=e.samplingRate}},{key:"isEnabled",value:function(){return this.config.switch}},{key:"transform",value:function(e,t){var n=this;return Xp(this.config.samplingRate,null==t?void 0:t._uuid)?(Array.isArray(e)?e:[e]).map((function(e){var t=new Np;return t._analy_type=up.crash,t._ct=e.date,delete e.date,t._sampling_rate=n.config.samplingRate,t.contents=[e],t.wrap()})):(Td.warn("plugin - ".concat(this.name," is not satisfy sampling rate [").concat(this.config.samplinobalThis.onerror=this.oldOnErrorHandler}},{key:"captureException",value:function(e){var t,n=this.errorEventHandler(e);n&&(null===(t=this.proxy)||void 0===t||t.emit(this.name,n))}},{key:"errorEventHandler",value:function(e,t,n,r,i){var o=null,a=Fp(i)?i.error:i,s=Fp(e)?e.error:e,c=(null==t?void 0:t.split("?")[0])||"unknown file",u=(null==t?void 0:t.split("?")[1])||"",l={file:c,fileParams:u,lineno:n,colno:r};return a&&jv(a)||jv(s)?null:(o=Av(a||s,l),this.oldOnErrorHandler&&this.oldOnErrorHandler.apply(this,arguments),o)}}]),e}(),Lv=["startTime","redirectStart","redirectEnd","fetchStart","domainLookupStart","domainLookupEnd","connectStart","secureConnectionStart","connectEnd","requestStart","responseStart","responseEnd"],Fv=function(){function e(){Sp(this,e),jp(this,"name","WindowSourceError"),jp(this,"config",{switch:!0}),jp(this,"handler",Bp)}return Tp(e,[{key:"getName",value:function(){return this.name}},{key:"monit",value:function(e){var t=this;this.handler=function(n,r,i){var o=t.errorEventHandler(n);if(o){var a,s;o.date=null!=r?r:o.date,o.url=null!==(a=null==i?void 0:i.split("?")[0])&&void 0!==a?a:o.url,o.params=null!==(s=null==i?void 0:i.split("?")[1])&&void 0!==s?s:o.params;var c=t.resolveRequestTiming(o.url+"?"+o.params);e.emit(t.name,Object.assign({},o,c))}return!0},e.on(Mv+this.name,(function(e){var n=Rv(e,3);t.handler(n[0],n[1],n[2])})),globalThis.addEventListener("error",this.handler,!0)}},{key:"exportFuncs",value:function(){return{}}},{key:"setConfig",value:function(e){var t,n,r=null===(t=e.pluginConfig)||void 0===t?void 0:t.windowSourceError;this.config.switch=null!==(n=null==r?void 0:r.switch)&&void 0!==n?n:this.config.switch,this.config.samplingRate=e.samplingRate}},{key:"isEnabled",value:function(){return this.config.switch}},{key:"transform",value:function(e,t){var n=this;return Xp(this.config.samplingRate,null==t?void 0:t._uuid)?(Array.isArray(e)?e:[e]).map((function(e){var t=new Np;return t._analy_type=up.source,t._ct=e.date,delete e.date,t._sampling_rate=n.config.samplingRate,t.contents=[e],t.wrap()})):(Td.warn("plugin - ".concat(this.name," is not satisfy sampling rate [").concat(this.config.samplingRate,"]"),e),[])}},{key:"destroy",value:function(){globalThis.removeEventListener("error",this.handler,!0)}},{key:"errorEventHandler",value:function(e){var t=this;if(!e.bubbles){var n=e.srcElement?e.srcElement:e.target;if(n instanceof HTMLElement){var r,i=n.tagName.toLowerCase(),o=n.currentSrc||n.src||n.href||"unknown";if(globalThis.location.href.indexOf(o)>=0)return null;var a=(e.path||(null===(r=e.composedPath)||void 0===r?void 0:r.call(e))||[]).map((function(e){var n=Object.prototype.toString.call(e);return"[object Window]"===n||"[object global]"===n||e instanceof HTMLDocument?"":t.parseDOM2CSSPath(e)}));a=a.reverse().join(" ").trim();var s=o.split("?")[0],c=o.split("?")[1]||"",u=new Error;return u.name="Source Error",u.message="".concat(i," src '").concat(s,"' load error"),Av(u,{type:i.charAt(0).toUpperCase()+i.substring(1),source:s,sourceParams:c,CSSPath:a})}}return null}},{key:"parseDOM2CSSPath",value:function(e){var t=e.id||"",n=e.className||"";return t&&(t=this.strPadStart(t,t.length+1,"#")),n&&(n=n.replace(/\s/g,"."),n=this.strPadStart(n,n.length+1,".")),e.nodeName.toLowerCase()+t+n}},{key:"strPadStart",value:function(e,t,n){return t>>=0,n=String(void 0!==n?n:" "),e.length>t?String(e):((t-=e.length)>n.length&&(n+=n.repeat(t/n.length)),n.slice(0,t)+String(e))}},{key:"resolveRequestTiming",value:function(e){if(e&&globalThis.PerformanceResourceTiming){var t=performance.getEntriesByName(e,educe((function(e,n){return e[n]=t[n],e}),Object.create(null))}return null}}]),e}(),Hv=function(){function e(){Sp(this,e),jp(this,"name","WindowUnhandledRejection"),jp(this,"config",{switch:!0}),jp(this,"handler",Bp)}return Tp(e,[{key:"getName",value:function(){return this.name}},{key:"monit",value:function(e){var t=this;this.handler=function(n,r,i){var o,a,s=Av(null==n?void 0:n.reason,{type:"PromiseRejectError"});s&&(s.date=null!=r?r:s.date,s.url=null!==(o=null==i?void 0:i.split("?")[0])&&void 0!==o?o:s.url,s.params=null!==(a=null==i?void 0:i.split("?")[1])&&void 0!==a?a:s.params,e.emit(t.name,s))},e.on(Mv+this.name,(function(e){var n=Rv(e,3);t.handler(n[0],n[1],n[2])})),globalThis.addEventListener("unhandledrejection",this.handler,!0)}},{key:"exportFuncs",value:function(){return{}}},{key:"setConfig",value:function(e){var t,n,r=null===(t=e.pluginConfig)||void 0===t?void 0:t.windowUnhandledRejection;this.config.switch=null!==(n=null==r?void 0:r.switch)&&void 0!==n?n:this.config.switch,this.config.samplingRate=e.samplingRate}},{key:"isEnabled",value:function(){return this.config.switch}},{key:"transform",value:function(e,t){var n=this;return Xp(this.config.samplingRate,null==t?void 0:t._uuid)?(Array.isArray(e)?e:[e]).map((function(e){var t=new Np;return t._analy_type=up.crash,t._ct=e.date,delete e.date,t._sampling_rate=n.config.samplingRate,t.contents=[e],t.wrap()})):(Td.warn("plugin - ".concat(this.name," is not satisfy sampling rate [").concat(this.config.samplinr("unhandledrejection",this.handler,!0)}}]),e}(),qv=function(){function e(){Sp(this,e),jp(this,"name","Vue"),jp(this,"config",{switch:!0,samplingRate:1e3}),jp(this,"proxy",null)}return Tp(e,[{key:"getName",value:function(){return this.name}},{key:"monit",value:function(e){var t=this;this.proxy=e,e.on(Mv+this.name,(function(e){var n,r,i,o=Rv(e,5),a=o[3],s=o[4],c=t.errorEventHandler(o[0],o[1],o[2]);c&&(c.date=null!=a?a:c.date,c.url=null!==(n=null==s?void 0:s.split("?")[0])&&void 0!==n?n:c.url,c.params=null!==(r=null==s?void 0:s.split("?")[1])&&void 0!==r?r:c.params,null===(i=t.proxy)||void 0===i||i.emit("exportFuncs",value:function(){return{}}},{key:"setConfig",value:function(e){var t,n,r=this,i=null===(t=e.pluginConfig)||void 0===t?void 0:t.vue;(this.config.switch=null!==(n=null==i?void 0:i.switch)&&void 0!==n?n:this.config.switch,this.config.samplingRate=e.samplingRate,this.config.app=null==i?void 0:i.app,this.config.vue=null==i?void 0:i.vue,this.config.switch)&&(this.config.app?(Array.isArray(this.config.app)?thition(e){return r.bindVueErrorHandler(e)})):this.config.vue&&this.bindVueErrorHandler(this.config.vue))}},{key:"isEnabled",value:function(){return!this.config.switch||this.config.vue||this.config.app?this.config.switch:(Td.error("vue plugin is need inject [vue|app] field"),!1)}},{key:"transform",value:function(e,t){var n=this;return Xp(this.config.samplingRate,null==t?void 0:t._uuid)?(Array.isArray(e)?e:[e]).map((function(e){var t=new Np;return t._analy_type=up.crash,t._ct=e.date,delete e.date,t._sampling_rate=n.config.samplingRate,t.contents=[e],t.wrap()})):(Td.warn("plugin - ".concat(this.name," is not satisfy sampling rate [").concat(this.config.samplingRate,"]"),e),[])}},{key:"destroy",value:function(){var e,t;(this.proxy=null,null!==(e=this.config)&&void 0!==e&&e.app)?((Array.isArray(this.config.app)?this.config.app:[this.config.app]).forEach((function(e){e.config.errorHandler=e.config._errorHandler,delete e.config._errorHandler})),delete this.config.app):null!==(t=this.config)&&void 0!==t&&t.vue&&(this.config.vue.config.errorHandler=this.config.vue.config._errorHandler,delete this.config.vue.config._errorHandler,delete this.config.vue)}},{key:"bindVueErrorHandler",value:function(e){var t=this;e.config||Td.error("vue plugin config field [vue|app] type error"),e.config._isBinding||(e.config._errorHandler||e.config._isPreCollect||(e.config._errorHandler=e.config.errorHandler),e.config.errorHandler=function(n,r,i){var o,a=t.errorEventHandler(n,r,i);a&&(null===(o=t.proxy)||void 0===o||o.emit(t.name,a));"function"==typeof e.config._errorHandler&&e.config._errorHandler!==e.config.errorHandler&&Yp(e.config._errorHandler)!==Yp(e.config.errorHandler)&&e.config._errorHandler.call(e,n,r,i)},e.config._isBinding=!0)}},{key:"errorEventHandler",value:function(e,t,n){var r={};return void 0!==fo="INFO",e.Warn="WARN",e.Error="ERROR"}(Dv||(Dv={}));var zv=function(){function e(t,n,r,i,o,a){var s,c;Sp(this,e),jp(this,"business",""),jp(this,"traceId",""),jp(this,"level",Dv.Info),jp(this,"namespace",""),jp(this,"timestamp",0),jp(this,"message",""),jp(this,"extendsData",null),jp(this,"url",""),jp(this,"params",""),Dv.Error===t&&(e.traceId=Lp()),this.level=t,this.namespace=n,this.message=r,this.extendsData=i,this.timestamp=null!=o?o:Date.now(),this.url=null!==(s=null==a?void 0:a.split("?")[0])&&void 0!==s?s:Jp(),this.params=null!==(c=null==a?void 0:a.split("?")[1])&&void 0!==c?c:Kp()}return Tp(e,[{key:"wrap",value:function(){return this.business=e.business,this.traceId=e.traceId,Object.assign(Object.create(null),this)}}],[{key:"setBusiness",value:function(t){e.business=t,e.traceId=Lp()}}]),e}();jp(zv,"business","")is,"table",new Map),jp(this,"limit",20)}return Tp(e,[{key:"setLimit",value:function(e){this.limit=e}},{key:"add",value:function(e,t){if(this.table.has(e))this.table.delete(e);else if(this.table.size===this.limit){var n=this.table.keys().next().value;this.table.delete(n)}this.table.set(e,t)}},{key:"get",value:function(e){if(this.table.has(e)){var t=this.table.get(e);return this.table.delete(e),thiar",value:function(){tler",void 0),this.name=t,this.handler=n}return Tp(e,[{key:"getName",value:function(){return this.name}},{key:"log",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var o=new zv(e,this.name,t,r);this.handler(o)}},{key:"debug",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.log.apply(this,[Dv.Debug,e].concat(n))}},{key:"info",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.log.apply(this,[Dv.Info,e].concat(n))}},{key:"warn",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.log.apply(this,[Dv.Warn,e].concat(n))}},{key:"error",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.log.apply(this,[Dv.Error,e].concat(n))}}]),e}(),Vv=function(){function e(){Sp(this,e),jp(this,"name","BusinessLoggerPlugin"),jp(this,"config",{switch:!1}),jp(this,"proxy",null),jp(this,"globalLoggerType","global"),jp(this,"loggerTable",new Uv),jp(this,"isReady",!1),jp(this,"cache",[]),jp(this,"handleName",value:function(){return this.name}},{key:"monit",value:function(e){var t=this;this.proxy=e,this.handler=function(n){t.isReady?e.emit(t.name,t.cache.length?[n].concat(t.cache.splice(0,t.cache.length)):n):t.cache.push(n)},e.on(Mv+this.name,(function(e){var n,r=Iv(n=e)||Kd(n)||Qd(n)||Pv(),i=r[0],o=r[1],a=r[2],s=r.slice(3),c=s.pop(),u=s.pop(),l=new zv(o.toUpperCase(),i,a,s,u,c);t.rn{getLogger:this.getLogger.bind(this)}}},{key:"setConfig",value:function(e){var t,n,r,i=null===(t=e.pluginConfig)||void 0===t?void 0:t.businessLogger;if((this.config.switch=null!==(n=null==i?void 0:i.switch)&&void 0!==n?n:this.config.switch,this.config.samplingRate=e.samplingRate,e.appName)&&(zv.setBusiness(e.appName),this.isReady=!0,this.cache.length))return void(null===(r=this.proxy)||void 0===r||r.emit(this.name,this.cache.splice(0,this.ue:function(){return this.config.switch}},{key:"transform",value:function(e,t){var n=this;return Xp(this.config.samplingRate,null==t?void 0:t._uuid)?(Array.isArray(e)?e:[e]).map((function(e){e=e.wrap();var t=new Np;return t._analy_type=up.businessLog,t._ct=e.timestamp,t.common_info={business:e.business,tranceId:e.traceId},delete e.business,delete e.traceId,delete e.timestamp,e.message=String(e.message).slice(0,1e3),e.extendsData=("string"==typeof e.extendsData?e.extendsData:Yp(e.extendsData)).slice(0,1e3),t._sampling_rate=n.config.samplingRate,t.contents=[e],t.wrap()})):(Td.warn("plugin - ".concat(this.name," is not satisfy sampling rate [").concat(this.config.samplingRate,"]"),e),[])}},{key:"destroy",value:function(){this.loggerTable.clear(),this.cache=[],this.handler=Bp}},{key:"getLogger",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.globalLoggerType,t=this.loggerTable.get(e);return t||(t=new Wv(e,this.handler.bind(this))),this.loggerTable.add(e,t),t}nction(e,Qv=function(){this.map={},this.rmap={}};Qv.prototype.waitFor=function(e,t){var n=this.map,r=this.rmap;"string"==typeof e&&(e=[e]);var i=(Jv++).toString(16);n[i]={waiting:e.slice(0),callback:t};for(var o=0,a=e.length;o<a;++o){var s=e[o];(r[s]||(r[s]=[])).push(i)}return this},Qv.prototype.trigger=function(e){if(!e)return this;var t=this.rmap;"string"==typeof e&&(e=[e]);for(var n=0,r=e.length;n<r;++n){var i=e[n];void 0!==t[i]&&(this._release(i,t[i]),delete t[i])}return this},Qv.prototype._release=function(e,t){for(var n=this.map,r=0,i=t.length;r<i;++r){var o=t[r],a=n[o],s=a.waiting,c=Array.prototype.indexOf.call(s,e);s.splice(c,1),0===s.length&&(Kv(a.callback),delete n[o]ull);function Yv(e){return e?Gv[e]:null}function $v(e,t){var n;return Gv=Object.assign(Gv,((n={})[e]=t,n))}var Zv=0;var eg=["img","script","iframe","link","audio","video","source"];function tg(e,t){for(var n in e){var r=e[n];if(t.includes(r.nodeName.toLowerCase())||tg(r.children,t))return!0}return!1}var ng=function(e)tion(t){setTimeout((function(){t()}),e)}))},rg=function(e){var t=e.nodeName.toLowerCase(),n=e.id||e.className;return n||(n=e.innerHTML.substr(0,64),"img"===t&&(n=e.currentSrc)),t+":"+n},ig=5e3,og=function(e,t){if(e.length>2)return performance.now();var n=[];for(var r in t){var i=t[r];n.push({timestamp:i.start,type:"requestStart"}),n.push({timestamp:i.end,type:"requestEnd"})}for(var o in e){n.push({timeion(e,t){return e.timestamp-t.timestamp}));for(var a=e.length,s=n.length-1;s>=0;s--){var c=n[s];switch(c.type){case"requestStart":a--;break;case"requestEnd":if(++a>2)return c.timestamp;break;default:throw Error("Internal Error: This should never happen")}}return 0},ag=function(e){void 0===e&&(e={}),this._useMutationObserver=!!e.useMutationObserver,this._minValue=e.minValue||null;var t=window.__tti&&window.__tti.e,n=window.__tti&e.startTime,end:e.startTime+e.duration}})):[],n&&n.disconnect(),this._networkRequests=[],this._incompleteJSInitiatedRequestStartTimes=new Map,this._timerId=null,this._timerActivationTime=-1/0,this._scheduleTimerTasks=!1,this._firstConsistentlyInteractiveResolver=null,this._performanceObserver=null,this._mutationObserver=null,this._registerListeners()},sg={_incompleteRequestStarts:{configurable:!0}};ag.prototype.getFirstConsistentlyInteractive=function(){var e=this;return new Promise((function(t,n){e._firstConsistentlyInteractiveResolver=t,"complete"==document.readyState?e.startSchedulingTimerTasks():window.addEventListener("load",(function(){e.startSchedulingTimerTasks()}))}))},ag.prototype.startSchedulingTimerTasks=function(){this._scheduleTimerTasks=!0;var e=this._longTasks.length>0?this._longTasks[this._longTasks.length-1].end:0,t=og(this._incompleteRequestStarts,this._networkRequests);this.rescheduleTimer(MatetMinValue=function(e){this._minValue=e},ag.prototype.rescheduleTimer=function(e){var t=this;this._scheduleTimerTasks&&(this._timerActivationTime>e||(clearTimeout(this._timerId),this._timerId=setTimeout((function(){t._checkTTI()}),e-performance.now()),this._timermerTasks=!1,this._unregisterListeners()},ag.prototype._registerPerformanceObserver=function(){var e=this;this._performanceObserver=new PerformanceObserver((function(t){var n=t.getEntries();for(var r in n){var i=n[r];"resource"===i.entryType&&e._networkRequestFinishedCallback(i),"longtask"===i.entryType&&e._longTaskFinishedCallback(i)}})),this._performanceObserver.observe({entryTypes:["longtask","resource"]})},ag.prototype._registerListeners=function(){var e,t,n,r,i,o,a,s,c;e=this._beforeJSInitiatedRequestCallback.bind(this),t=this._afterJSInitiatedRequestCallback.bind(this),n=XMLHttpRequest.prototype.send,r=Zv++,XMLHttpRequest.prototype.send=function(){for(var i=this,o=[],a=arguments.length;a--;)o[a]=arguments[a];return e(r),tnge",(function(){4===i.readyState&&t(r)})),n.apply(this,o)},i=this._beforeJSInitiatedRequestCallback.bind(this),o=this._afterJSInitiatedRequestCallback.bind(this),a=fetch,fetch=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new Promise((function(t,n){var r=Zv++;i(r),a.apply(n(e){o(r),t(e)}),(function(e){o(e),n(e)}))}))},this._registerPerformanceObserver(),this._useMutationObserver&&(this._mutationObserver=(s=this._mutationObserverCallback.bind(this),(c=new MutationObserver((function(e){for(var t in e){var n=e[t];("childList"==n.type&&tg(n.addedNodes,eg)||"attributes"==n.type&&eg.includes(n.target.tagName.toLowerCase()))&&s(n)}}))).observe(document,{attributes:!0,childList:!0,subtree:!0,attributeFilter:["href","src"]}er&&this._mutationObserver.disconnect()},ag.prouestStartTimes.set(e,performance.now())},ag.preJSInitiatedRequestStartTimes.delete(e)},ag.prototype._networkRequestFinishedCallback=function(e){this._networkRequests.push({start:e.fetchStart,end:e.responseEnd}),this.rescheduleTimer(og(this._incompleteRequestStarts,this._networkRequests)+ig)},ag.prototype._longTaskFinishedCallback=function(e){var t=e.startTime+e.duration;this._longTasks.push({start:e.startTime,end:t}),this.rescheduleTimer(t+ig)},ag.prototype._mutationObserverCallback=function(e){this.rescheduleTimer(performance.now()+ig)},ag.prototype._getMinValue=function(){if(this._minValue)return this._minValue;if(performance.timing.domContentLoadedEventEnd){var e=performance.timing;return e.domContentLoadedEventEnd-e.navigationStart}return null},sg._incompleteRequestStarts.get=function(){return[].concat(this._incompleteJSInitiatedRequestStartTimes.values())},ag.prototype._checkTTI=function(){var e=performance.timing.navigationStart,t=og(this._incompleteRequestStarts,this._networkRequests),n=(window.chrome&&window.chrome.loadTimes?1e3*window.chrome.loadTimes().firstPaintTime-e:0)||performance.timing.domContentLoadedEventEnd-e,r=this._getMinValue(),i=performance.now();null===r&&this.rescheduleTimer(Math.max(t+ig,i+1e3));var o=function(e,t,n,r,i){if(r-n<ig)return null;var o=0===i.length?e:i[i.length-1].end;return r-o<ig?null:Math.max(o,t)}(n,r,t,i,this._longTasks);o&&(this._firstConsistentlyInteractiveResolver(o),this.disable()),this.rescheduleTimer(performance.now()+1e3)},Object.defineProperties(ag.prototype,sg);function cg(){return(void 0===e&&(e={}),"PerformanceLongTaskTiming"in window?new ag(e).getFirstConsistentlyInteractive():Promise.resolve(-1)).then((function(e){return e<0?Xv.waitFor(["getTTI"],(function(){Xv.trigger("tti"),$v("tti",Number(e.toFixed(2)))})):(Xv.trigger("tti"),$v("tti",Number(e.toFixed(2)))),Number(e.toFixed(2))}));var e}function ug(e){var t=(e.includes("?")?e.split("?")[0]:e.includes("#")?e.split("#")[0]:e).split("/").pop().split(".");return t.length>=2?t.pop():""}var lg=0,fg=function(e){var t=(new Date).getTime();return setTimeout((function(){e(lg=n)}),n-t)},hg=function(e){var t=this;this.callbacks=[],this.isPaintBool=!1,this.isImage=!1,this.currentNode=null,this.target=e,this.now=(new Date).getTime(),Strin^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}),fg((function(){t.chechis.callbacks.push(e),this.tracePaint()},hg.prototype.tracePaint=function(){var e=this;thction(t){t(e.isPaintBool,e.currentNode)})),thted=function(e){return e.offsetHeight>0},hg.prototype.isImageCompleted=function(){var e=this;this.currentNode.complete&&this.isPainted(this.currentNode)?(th(function(){return e.isImageCompleted()}))},hg.prototype.checkPaint=function(){var e=this,t=document.createNodeIterator(this.target,NodeFilter.SHOW_ALL,(function(t){if(!t)return!1;if(t.nodeType===Node.TEXT_NODE&&!e.isPainted(t.parentNode))return!1;if(t.nodeType!==Node.TEXT_NODE&&!e.isPainted(t))return!1;var n=t.nodeType===Node.TEXT_NODE&&/[^s]/.test(t.nodeValue.trim());if(n)return n;var r=t instanceof HTMLImageElement&&""!==t.src;return!!r&&(e.isImage=!0,r)}),!1);if(this.currentNode=t.nextNode(),(new Date).getTime()-this.now>1e4)return!1;fg(null!==this.currentNode?this.tracePaint()}:function(){e.checkPaint()})};var pg,dg,vg,gg=["SCRIPT","STYLE","META","HEAD","LINK"],mg=/url\(\"(.*?)\"\)/,yg=window.innerWidth,wg=window.innerHeight,bg=function(e){this.mutationTimeCalculates=[],this.flag=!0,this.observer=null,this.callbackCount=1,this.mp={},this.lcpTiming=0,this.lcpEle="",this.lcpTimeStamp=0,this.runMutationObserver=!1,this.locked=!0,this.now=(new Date).getTime(),this.reWait=e};function _g(e){var t=0,n=!0,r="",i="",o=e;return new Promise((function(a){try{var s=new PerformanceObserver((function(e){var n=e.getEntries(),o=n[n.length-1],a=o.element;t=o.renderTime||o.loadTime,a&&(r=rg(a)),i=(new Date).getTime()})),c=function(){if(!n)return s.disconnect(),a({lcp:0});var e=0===t?-1:t;a({lcp:Number(e.toFixed(2))}),$v("lcp",{lcpEle:r,value:Number(e.toFixed(2)),lcpTimeStamp:i}),Xv.trigger("lcp"),s.disconnect()};ng(5e3).then((&&o?(o=!1,ng(5e3).then((function(e){c()}))):c()})),s.observe({type:"largest-contentful-paint",buffered:!0})}catch(u){n=!1,function(e){return new Promise((function(t){if(window.MutationObserver&&performance.getEntries){var n=new bg(e);n.iming"],(function(){}))}else ng(ig).then((function(e){t(-1)}))}))}(e).then((function(e){var t=e.rt,n=e.rEle,r=e.rts;a({lcp:t,lcpEle:n,lcpTimeStamp:r}),$v("lcp",{lcpEle:n,value:Number(t.toFixed(2)),lcpTimeStamp:r}),Xv.triggerrEle:this.lcpEle,rts:this.lcpTimeStamp}},bg.prototype.firstSnapshot=function(){var e=this,t=document.body;new hg(t).getPageIsPaint((function(){t&&e.doTag(t,e.callbackCount++),e.mutationTimeCalculates.push({t:performance.now(),ts:(new Date).getTime()}),e.locked=!1}))},bg.prototype.removeTag=function(e){var t=e.children?e.children.length:0;if(t>0)for(var n=e.children,r=t-1;r>=0;r--)null!==n[r].getAttribute("lcp_do_tag")&&n[r].removeAttribute("lcp_do_tag"),this.removeTag(n[r])},bg.prototype.initObserver=function(){var e=this;this.firstSnapshot(),this.observer=new MutationObserver((function(){e.locked||(e.runMutationObserver||(e.runMutationObserver=!0,e.callbackCount=1,e.mutationTimeCalculates=[],e.removeTag(document.body)),fg((function(){var t=performance.now(),n=document.body;n&&e.doTag(n,e.callbackCount++),e.mutationTimeCalculates.push({t:t,ts:(new Date).getTime()})})))})),this.observer.observe(document,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["style","href","src"]}),"complete"===document.readyState?this.calculateFinalScore():window.addEventListener("load",(function(){e.calculateFinalScore()}),!0)},bg.prototype.calculateResourceMap=function(){var (function(t){e.mp[t.name]=t.responseEnd}))},bg.prototype.doTag=function(e,t){if(-1===gg.indexOf(e.tagName)){var n=e.children?e.children.length:0;if(n>0)for(var r=e.children,i=n-1;i>=0;i--)null===r[i].getAttribute("lcp_do_tag")&&r[i].setAttribute("lcp_do_tag",t),this.doTag(r[i],t)}},bg.prototype.calculateFinalScore=function(){var e=this;if(MutationObserver&&this.flag)if(this.checkCanCalculateLcp()){var t=(new Date).getTime();this.observer.disconnect(),this.flag=!1;var n=this.deepTraversal(document.body),r={};n.dpss.forEach((function(e){r&&r.st?r.st<e.st&&(r=e):r=e})),this.calculateResourceMap();var i=this.filterTheResultSet(r.els||[]),o=this.calculateResult(i),a=o.rEle,s=o.rts;this.lcpTiming=o.rt,this.lcpEle=a,this.lcpTimeStamp=s,window.__lcp_required_time__=(new Date).getTime()-t,Xv.trigger("LCPTiming")}else setTimeout((function(){e.calculateFinalScore()}),500)},bg.prototype.calculateResult=function(e){var t=this,n=-1,r="",i=0;return e.forEach((function(e){var o,a,s=-1,c=0,u=rg(e.node),l=+e.node.getAttribute("lcp_do_tag")-1;if("IMG"===e.node.tagName)s=t.mp[e.node.src],t.mutationTimeCalculates[l]&&(c=t.mutationTimeCalculates[l].ts);else{var f=(o=e.node,a="background-image",window.getComputedStyle?window.getComputedStyle(o)[a]:o.currentStyle[a]).match(mg);if(f&&f[1]){var h=f[1];-1===h.indexOf("http")&&(h=location.protocol+f[1]),s=t.mp[h],t.mutationTimeCalculates[l]&&(c=t.mutationTimeCalculates[l].ts)}else t.mutationTimeCalculates[l]&&(s=t.mutationTimeCalculates[l].t,c=t.mutationTimeCalculates[l].ts)}n<s&&(n=s,r=u,i=c)})),{rt:n,rEle:r,rts:i}},bg.prototype.filterTheResultSet=function(e){if(e&&1===e.length)return e;var t=0;e.forEach((function(e){t+=eurn e.filter((function(e){return e.st>n}))},bg.prototype._hackNodeChildren=function(e){if(e.children)return e.children;for(var t=e.childNodes,n=[],r=null,i=0;r=t[i++];)1===r.nodeType&&n.push(r);return n},bg.prototype.deepTraversal=function(e){if(e){for(var t=[],n=0,r=void 0;r=this._hackNodeChildren(e)[n];n++){var i=this.deepTraversal(r);i.st&&t.push(i)}return this.calculateScore(e,t)}return{}},bg.prototype.calculateScore=function(e,t){var n=e.getBoundingClientRect(),r=n.width,i=n.height,o=1;(wg<n.t;var a=0;t.forEach((function(e){a+=e.st}));var s=r*i*o,c=[{node:e,st:s}],u=this.calculateAreaPercent(e);re.forEach((function(e){c=c.concat(e.els)}))),{dpss:t,st:s,els:c}},bg.prototype.checkCanCalculateLcp=function(){var e=(new Date).getTime()-this.now,t=e>ig;if(t){var n=this.getLcpTiming().rt<=0&&this.reWait;return this.reWait=!1,this.now=(new Date).getTime(),!n}return t||this.mutationTimeCalculates&&this.mutationTimeCalculates.length&&e-this.mutationTimeCalculates[this.mutationTimeCalculates.length-1].t>1e3},bg.prototype.calculateAreaPercent=function(e){var t=e.getBoundingClientRect(),n=t.left,r=t.right,i=t.top,o=t.bottom,a=t.width,s=t.height,c=wg,u=r-n+(yg-0)-(Math.max(r,yg)-Math.min(n,0));if(u<=0)return 0;var l=o-i+(c-0)-(Math.max(o,c)-Math.min(i,0));return l<=0?0:u*l/(a*s)};var xg=new Date,kg=[];function Sg(e,t){pg||(pg=t,dg=e,vg=new DforEach((function(e){e(dg,pg)})),kg=[])}var Tg={passive:!0,capture:!0},Og="pointerup",Cg="pointercancel",Ig=window.addEven"].forEach((function(t){e(t,Rg,Tg)}))}function jg(){return new Promise((function(e){Xv.waitFor(["getFID"],(function(){kg.push((function(t,n){var r={fid:Number(t.toFixed(2)),fidEventName:n.type||"UNKNOW"};for(var i in e(r),r)$v(i,r[i]);Xv.trigger("fid")})),Eg()}))}))}Ag(window.addEventListener);var Dg=String.fromCharCode,Mg=function(e){if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?Dg(192|t>>>6)+Dg(128|63&t):Dg(224|t>>>12&15)+Dg(128|t>>>6&63)+Dg(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return Dg(240|t>>>18&7)+Dg(128|t>>>12&63)+Dg(128|t>>>6&63)+Dg(128|63&t)},Ng=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,Bg=function(e){return window.btoa(function(e){return e.replace(Ng,Mg)}(e))},Lg=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),Fg=function(e){switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return Dg(55296+(t>>>10))+Dg(56320+(1023&t));case 3:return Dg((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return Dg((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},Hg=function(e){return window.atob(e).replace(Lg,Fg)},qg={VERSION:"wps.2.1.9",encode:function(e,t){return t?Bg(String(e)).replace(/[+\/]/g,(function(e){return"+"==e?"-":"_"})).replace(/=/g,""):Bg(String(e))},decode:function(e){return Hg(String(e).replace(/[-_]/g,(function(e){return"-"==e?"+":"/"})).replace(/[^A-Za-z0-9\+\/]/g,""))}};var zg=function(e,t){this.encode=e||qg.encode.bind(qg),this.decode=t||qg.decode.bind(qg),this.queryKey="cefQuery"};zg.prototype.setQueryKey=function(e){this.queryKey=e},zg.prototype.setEncode=function(e){this.encode=e},zg.prototype.setDecode=function(e){this.decode=e},zg.prototype._exceptionHandler=function(e,t,n){return e.message="Client Api Exec Catch Error: \n          method: "+t+", error: "+e.message,n&&(e.message+=", response: "+JSON.stringify(n),e.response=n),e},zg.prototype.execJson=function(e,t){try{return e=this.encode(JSON.stringify(e)),window[this.queryKey]({request:'fromJSAsynCallBase64("'+e+'")',persistent:!1})}catch(n){t&&t(this._exceptionHandler(n,e.method))}},zg.prototype.exec=function(e,t,n){var r=this,i={method:e};if("function"==typeof t?n=t:void 0!==t&&(i.params=t),"function"==typeof n){var o=e+"_async_callback_"+setTimeout((function(){}),0);window[o]=function(t){delete window[o];var i=null;try{if(t=r.decode(t),"ok"!==(t=JSON.parse(t)).callstatus)throw new Error("execute api failed")}catch(a){i=r._exceptionHandler(a,e,t)}n(i,t)},i.callback='window["'+o+'"]'}return this.execJson(i,n)},zg.prototype.execPromise=function(e,t){var n=this;return new Promise((function(r,i){n.exec(e,t,(function(e,t){e?i(e):r(t)}))}))};var Ug,Wg=new zg;Ug=function(){var e=window.qwebkit&&window.qwebkit.jsAsynCall||!window.cefQuery&&window.external&&window.external.jsAsynCall,t=window.cefQuery&&"function wpsQuery() { [native code] }"===window.cefQuery.toString();return e?"qt":t?"cef":"browser"}(),"qt"===Ug&&(Wg.execJson=function(e,t){try{if(e=this.encode(JSON.stringify(e)),window.external&&window.external.jsAsynCall)return window.external.jsAsynCall(e);if(window.qwebkit&&window.qwebkit.fromJSAsynCallBase64)return window.qwebkit.fromJSAsynCallBase64(e);var n="当前的Qt容器不支持使用`window.external.jsAsynCall`或`window.qwebkit.fromJSAsynCallBase64`方法调用客户端API";throw console.warn(n),n}catch(r){t&&t(this._exceptionHandler(r,e.method))}});vaeturn new Promise((function(t){Xv.waitFor(["load","DOMContentLoaded"],(function(){t(!0)}));var n=function(){};window.addEventListener("load",(function(){var t=function(e){e&&(new Promise((function(e){var t={};if(window.performance&&window.performance.getEntries){var n=window.performance.getEntries(),r=n.filter((function(e){return"script"===e.initiatorType||"js"===ug(e.name)})),i=n.filter((function(e){return"link"===e.initiatorType||"css"===ug(e.name)})),o=i.length?Math.max.apply(Math,i.map((function(e){return e.responseEnd})))-Math.min.apply(Math,i.map((function(e){return e.startTime}))):0,a=r.length?Man(e){return e.responseEnd})))-Math.min.apply(Math,r.map((function(e){return e.startTime}))):0;t={js:Number(a.toFixed(2)),css:Number(o.toFixed(2))}}else t={js:0,css:0,ttfb:0};Xv.waitFor(["getNecessaryResourceTiming"],(function(){e(t),$v("jsCss",t),Xv.trigger("js_css_timing")}))})),new Promise((function(e){if(!window.performance)return{};var t=window.performance.timing,n={};n.domReadyTime=t.domContentLoadedEventEnd-t.fetchStart,n.parseDomTime=t.domComplete-t.domInteractive,n.initDomTreeTime=t.domInteractive-t.responseEnd,n.readyStart=t.fetchStart-t.navigationStart,n.redirectTime=t.redirectEnd-t.redirectStart,n.appcacheTime=t.domainLookupStart-t.fetchStart,n.lookupDomainTime=t.domainLookupEnd-t.domainLookupStart,n.connectTime=t.connectEnd-t.connectStart,n.requestTime=t.responseEnd-t.requestStart,n.requestDocumentTime=t.responseStart-t.requestStart,n.responseDocumentTime=t.responseEnd-t.responseStart,n.TTFB=t.responseStart-t.navigationStart,Xv.waitFor(["getOtherResourceTiming"],(function(){e(n),$v("otherTime",n),Xv.trigger("other_timing")}))}))),Xv.trigger("load")};e?e().then(t).catch(n):t(!0)})),window.addEventListener("DOMContentLoaded",(function(){var t=function(e){e&&(cg(),new Promise((function(e){v{var n=(e.getEntries()||[]).filter((function(e){return"first-contentful-paint"===e.name}));t=n.length?n[0].startTime:0}));Xv.waitFor(["getFtEntries()||[]).forEach((function(e){"first-contentful-paint"===e.name&&(t=e.startTime)})),e(Number(t.toFixed(2))),$v("fcp",Number(t.toFixed(2))),Xv.trigger("fcp"),n.disconnect()}))})),n.observe({entryTypes:["paint"]})}catch(r){Xv.waitFor(["getFCP"],(function(){ng(ig).then((function(n){if(performance&&performance.timing&&"number"==typeof performance.timing.msFirstPaint){var r=performance.timing;t=r.msFirstPaint-r.navigationStart}e(Number(t.toFixed(2))),$v("fcp",Number(t.toFixed(2))),Xv.trigger("fcp")}))}))}})),_g(Yv("reWait")),jg()),Xv.trigger("DOMContentLoaded")};e?e().then(t).catch(n):t(!0)}))}))},Jg=function(){Xv.trigger("getTTI");return new Promise((function(e){Xv.waitFor(["tti"],(function(){e({tti:Yv("tti")})}))}))FCP");return new Promise((function(e){Xv.waitFor(["fcp"],(function(){e({fcp:Yv("fcp")})}))}))},Qg=function(){Xv.trigger("getLCP");return new Promise((function(e){Xv.waitFor(["lcp"],(function(){e({lcp:Yv("lcp").value,lcpEle:Yv("lcp").lcpEle,lcpTimeStamp:Yv("lcp").lcpTimeStamp})}))}))},Xg=function(){Xv.trigger("getNecessaryResourceTiming");return new Promise((function(e){Xv.waitFor(["js_css_timing"],(function(){e(Yv("jsCss"))}))}))},Gg=function(){Xv.trigger("getOtherResourceTiming");return new Promise((function(e){Xv.waitFor(["other_timing"],(function(){e(Yv("otherTime"))}))}))},Yg={fcp:"fcp",lcp:"lcp",tti:"tti",fid:"fid",js:"js",css:"css",fcpTimeStamp:"fcp_ts",lcpTimeStamp:"lcp_ts",ttiTimeStamp:"tti_ts",domReadyTime:"dom",parseDomTime:"parse_dom",redirectTime:"redirect",appcacheTime:"appcache",lookupDomainTime:"lookup_domain",connectTime:"connect",requestTime:"request",requestDocumentTime:"request_document",responseDocumentTime:"response_document",TTFB:"ttfb",initDomTreeTime:"init_dom_tree",readyStart:"ready_start",usedJSHeapSize:"used_js_heap_size",jsHeapSizeLimit:"js_heap_size_limit",totalJSHeapSize:"total_js_heap_size"};var $g=function(){};$g.prototype._normalize=function(e,t){for(var n={},r=Object.keys(e),i=0,o=r.length;i<o;i++){var a=r[i];t.hasOwnProperty(a)?n[t[a]]=e[a]:n[a]=e[a]}return n},$g.prototype._getMemoryUsage=function(){if(window.performance&&window.performance.memory){var e=window.performance.memory,t=e.totalJSHeapSize,n=e.usedJSHeapSize;return{jsHeapSizeLimit:Math.round(e.jsHeapSizeLimit/1048576),totalJSHeapSize:Math.round(t/1048576),usedJSHeapSize:Math.round(n/1048576)}}return null},$g.prototype._getPerformanceMetrics=func.trigger("gee((functi.then((function(e){t=e})).catch((function(e){console.error("[wps performance sdk]: ",e)}));romise.all(n).then((function(n){var r=n.reduce((function(e,t){return Object.assign(e,t)}),{});r.fid=t;var i=e._getMemoryUsage();if(i){var o=i.totalJSHeapSize,a=i.usedJSHeapSize;r.jsHeapSizeLimit=i.jsHeapSizeLimit,r.totalJSHeapSize=o,r.usedJSHeapSize=a}var s=r.tti,c=r.lcp,u=performance.timing.navigationStart;return r.fcpTimeStamp=parseInt(r.fcp+u),r.lcpTimeStamp=parseInt(c+u),r.ttiTimeStamp=parseInt(s+u),r=e._normalize(r,Yg)})).catch((function(e){return e}))},$g.prototype.collect=function(e,t){var n=this;Vg().then((function(r){n._getPerformanceMetrics().then((function(t){ction(e){"function"==typeof t&&t(e)}))})).catch((function(e){"function"==typeof t&&t(e)}))};var Zg,em=$g,tm=function(){function e(){Sp(this,e),jp(this,"name","Performance"),jp(this,"config",{switch:!0,extraFields:["fcp","fid","lcp","ttfb","tti","fcp_ts","lcp_ts","tti_ts","connect","css","dom","appcache","init_dom_tree","js","js_heap_size_limit","lookup_domain","parse_dom","ready_start","redirect","request","request_document","response_document","total_js_heap_size","used_js_heap_size","lcpEle","url","params"]}),jp(this,"url",Jp()),jp(this,"params",Kp())}return Tp(e,[{key:"getName",value:function(){return this.name}},{key:"monit",value:function(e){var t=this;(new em).collect((function(n){e.emit(t.name,Object.assign({},n,{date:Date.now()}))}))}},{key:"exportFuncs",value:function(){return{}}},{key:"setConfig",value:function(e){var t,n,r=null===(t=e.pluginConfig)||void 0===t?void 0:t.performance;this.config.switch=null!==(n=null==r?void 0:r.switch)&&void 0!==n?n:this.config.switch,this.config.samplingRate=e.samplingRate,null!=r&&r.extraFields&&(this.config.extraFields=this.config.extraFields.concat(null==r?void 0:r.extraFields),this.config.extraFields=Array.from(new Set(this.config.extraFields)))}},{key:"isEnabled",value:function(){return this.config.switch}},{key:"transform",value:function(e,t){var n=this;return Xp(this.config.samplingRate,null==t?void 0:t._uuid)?(Array.isArray(e)?e:[e]).map((function(e){var t=new Np;t._analy_type=up.performance,t._ct=e.date,t._analy_branch=lp.browser,delete e.date,e.url=n.url,e.params=n.params,t._sampling_rate=n.config.samplingRate;var r=n.config.extraFields.reduce((function(t,n){return t[n]=e[n],t}),Object.create(null));return t.contents=[r],t.wrap()})):(Td.warn("plugin - ".concat(this.name," is not satisfy sampling rate [").concat(this.config.samplingRate,"]"),e),[])}},{key:"destroy",value:function(){}}]),e}(),nm=function(){function e(){Sp(this,e),jp(this,"name","PerformanceWps"),jp(this,"config",{switch:!0,pluginName:"",extraFields:["all_time","fcp","fid","lcp","ttfb","tti","c_cb","c_l","c_l_rd","c_cb_ld","c_cb_ts","c_cbf_ts","c_l_ts","c_lf_ts","fcp_ts","lcp_ts","tti_ts","c_l_rd_ts","c_cb_ld_ts","connect","css","dom","appcache","init_dom_tree","is_local","js","js_heap_size_limit","lookup_domain","parse_dom","ready_start","redirect","request","request_document","response_document","total_js_heap_size","used_js_heap_size","lcpEle","url","params"]}),jp(this,"url",Jp()),jp(this,"params",Kp())}var t;return Tp(e,[{key:"getName",value:function(){return this.name}},{key:"monit",value:function(e){var t=this;(new em).collect(function(){var n=od(pd.mark((function n(r){return pd.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.getProfileData(r.tti).catch((function(){return null}));case 2:e.emit(t.name,Object.assign({},r,n.sent,{date:Date.now()}));case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}},{key:"exportFuncs",value:function(){return{}}},{key:"setConfig",value:function(e){var t,n,r,i=null===(t=e.pluginConfig)||void 0===t?void 0:t.performance;this.config.switch=null!==(n=null==i?void 0:i.switch)&&void 0!==n?n:this.config.switch,this.config.samplingRate=e.samplingRate,this.config.pluginName=null!==(r=null==i?void 0:i.pluginName)&&void 0!==r?r:this.config.pluginName,null!=i&&i.extraFields&&(this.config.extraFields=this.config.extraFields.concat(null==i?void 0:i.extraFields),this.config.extraFields=Array.from(new Set(this.config.extraFields)))}},{key:"isEnabled",value:function(){return this.config.switch}},{key:"transform",value:function(e,t){var n=this;return Xp(this.config.samplingRate,null==t?void 0:t._uuid)?(Array.isArray(e)?e:[e]).map((function(e){var t=new Np;t._analy_type=up.performance,t._ct=e.date,t._analy_branch=lp["wps-pc"],delete e.date,e.url=n.url,e.params=n.params,t._sampling_rate=n.config.samplingRate;var r=n.config.extraFields.reduce((function(t,n){return t[n]=e[n],t}),Object.create(null));return t.contents=[r],t.wrap()})):(Td.warn("plugin - ".concat(this.name," is not satisfy sampling rate [").concat(this.config.samplingRate,"]"),e),[])}},{key:"destroy",value:function(){}},{key:"getProfileData",value:(t=od(pd.mark((function e(t){var n,r,i,o,a,s,c,u;return pd.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={c_cb:0,c_cb_ts:0,c_cbf_ts:0,c_cb_ld:0,c_cb_ld_ts:0,c_l:0,c_l_ts:0,c_lf_ts:0,c_l_rd:0,c_l_rd_ts:0,all_time:0},r=null,!kd()){e.next=6;break}try{o=null===(i=window.Extention)||void 0===i?void 0:i.Profile.getBrowserTraceInfo(),r=o&&o.code&&o.result||null}catch(l){Td.warn("[performance-wps] <window.Extention?.Profile.getBrowserTraceInfo> call error",l)}e.next=10;break;case 6:return e.next=8,pv.getBrowserTraceInfo().catch(od(pd.mark((function e(){return pd.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pv.getProfileInfo().catch((function(){return null}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));case 8:r=(a=e.sent)&&"ok"===a.callstatus&&a.result||null;case 10:return r&&(s=globalThis.sessionStorage.getItem("APM_CLIENT_VITALS")||"{}",c=JSON.parse(s),r.c_cb_ts===c.c_cb_ts?(n.c_cb_ts=r.c_cb_ts,n.c_cbf_ts=r.c_cbf_ts,n.c_l_ts=r.c_l_ts,n.c_lf_ts=r.c_lf_ts):(n=r,globalThis.sessionStorage.setItem("APM_CLIENT_VITALS",JSON.stringify(n)))),n.all_time=t+n.c_cb,u=/^(file?:\/\/)/.test(globalThis.location.href),n.is_local=u,e.abrupt("return",n);case 15:chis,arguments)})}]),e}();!function(e){e[e.include=1]="include",e[e.exclude=2]="exclude"}(Zg||(Zg={}));var rm=function(){function e(){Sp(this,e),jp(this,"name","RequestPlugin"),jp(this,"defaultIgnoreUrls",["https://kbee.wps.cn","https://fe-static.wpscdn.cn/apm_sdk_proxy/"]),jp(this,"MIN_THRESHOLD",1e3),jp(this,"exceptionCode",400),jp(this,"config",{switch:!0,samplingRate:1,threshold:3e3,ignoreUrls:Array.prototype.concat(this.defaultIgnoreUrls)}),jp(this,"proxy",null),jp(this,"requestObserver",null),jp(this,"oldXhrPrototypeOpen",XMLHttpRequest.prototype.open),jp(this,"oldXhrPrototypeSend",XMLHttpRequest.prototype.send),jp(this,"oldFetch",globalThis.fetch)}return Tp(e,[{key:"getName",value:function(){return this.name}},{key:"monit",value:function(e){this.proxy=e,this.wrapXMLHttpRequest(),void 0!==globalThis.fetch&&this.wrapFetch()}},{key:"exportFuncs",value:function(){return{}}},{key:"setConfig",value:function(e){var t,n,r,i,o=null===(t=e.pluginConfig)||void 0===t?void 0:t.request;(this.config.switch=null!==(n=null==o?void 0:o.switch)&&void 0!==n?n:this.config.switch,this.config.samplingRate=null!==(r=null==o?void 0:o.samplingRate)&&void 0!==r?r:this.config.samplingRate,o&&!Vp(o.ignoreUrls)&&(Array.isArray(o.ignoreUrls)&&o.ignoreUrls.every((function(e){return Up(e)||Wp(e)}))?this.config.ignoreUrls=Array.prototype.concat(o.ignoreUrls,this.defaultIgnoreUrls):(Td.warn("[RequestPlugin - ignoreUrls] field type need Array and value need string or RegExp"),o.ignoreUrls=this.config.ignoreUrls.slice(0,-this.defaultIgnoreUrls.length))),o&&!Vp(o.threshold))&&(!zp(o.threshold)||o.threshold<this.MIN_THRESHOLD?(Td.warn("[RequestPlugin - threshold] filed type need number and minimum value is 1000ms"),o.threshold=this.config.threshold):this.config.threshold=null!==(i=null==o?void 0:o.threshold)&&void 0!==i?i:this.config.threshold)}},{key:"isEnabled",value:function(){return this.config.switch}},{key:"transform",value:function(e,t){var n=this;return Xp(this.config.samplingRate,null==t?void 0:t._uuid)?(Array.isArray(e)?e:[e]).map((function(e){var t=new Np;return t._analy_type=up.request,t._analy_branch=e.type,t._ct=e.date,t._sampling_rate=n.config.samplingRate,delete e.date,t.contents=[e],t.wrap()})):(Td.warn("plugin - ".concat(this.name," is not satisfy sampling rate [").concat(this.config.samplingRate,"]"),e),[])}},{key:"destroy",value:function(){var e;XMLHttpRequest.prototype.open=this.oldXhrPrototypeOpen,XMLHttpRequest.prototype.send=this.oldXhrPrototypeSend,globalThis.fetch=this.oldFetch,null===(e=this.requestObserver)||void 0===e||e.disconnect()}},{key:"checkRequestUrlValidate",value:function(e){return!!e&&!this.config.ignoreUrls.some((function(t){return t&&new RegExp(t).test(e)}))}},{key:"checkStatusValidate",value:function(e){return e>=this.exceptionCode||0===e}},{key:"resolveRequestTiming",value:function(e){if(e&&globalThis.PerformanceResourceTiming){var t=performance.getEntriesByName(e,"resource").pop();if(t)return Lv.reduce((function(e,n){return e[n]=t[n],e}),Object.create(null))}return null}},{key:"handleXHRRequest",value:function(e){var t=this,n={type:fp.xhr,url:e.responseURL||e.__apm__.url,method:e.__apm__.method,status:e.status,duration:e.__apm__.end-e.__apm__.start,threshold:this.config.threshold,date:Date.now()};n.url=n.url.split("?")[0],this.checkRequestUrlValidate(n.url)&&(!this.checkStatusValidate(n.status)&&n.duration<=this.config.threshold||setTimeout((function(){var e,r=t.resolveRequestTiming(n.url);null===(e=t.proxy)||void 0===e||e.emit(t.name,Object.assign({},n,r))}),20))}},{key:"wrapXMLHttpRequest",value:function(){var e=this.handleXHRRequest.bind(this),t=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(e,n){this.__apm__={url:n.toString(),method:e.toLocaleLowerCase(),start:Date.now(),end:Date.now()},t.apply(this,arguments)};var n=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.send=function(t){var r=this.onreadystatechange;return this.onreadystatechange=function(t){if(4===this.readyState){var n=t.target;n.__apm__.end=Date.now(),e(n)}return r&&r.apply(this,[t])},n.apply(this,[t])}}},{key:"handleFetchRequest",value:function(e,t,n){var r=this;e="[object URL]"===Object.prototype.toString.call(e)?e.toString():e;var i={type:fp.fetch,url:t.url,method:"string"==typeof e?"get":e.method.toLocaleLowerCase(),status:t.status,duration:t.__apm__.duration,threshold:this.config.threshold,date:Date.now(),stack:n};i.url=i.url.split("?")[0],this.checkRequestUrlValidate(i.url)&&(!this.checkStatusValidate(i.status)&&i.duration<=this.config.threshold||setTimeout((function(){var e,t=r.resolveRequestTiming(i.url);null===(e=r.proxy)||void 0===e||e.emit(r.name,Object.assign({},i,t))}),20))}},{key:"wrapFetch",value:function(){if(globalThis.fetch){var e=this.oldFetch,t=this.handleFetchRequest.bind(this);globalThis.fetch=function(n,r){var i=Date.now();return e.apply(this,[n,r]).then((function(e){var r=Date.now()-i;return e.__apm__={duration:r},t(n,e),e})).catch((function(e){var r=new Response(null,{status:400,statusText:""});return r.__apm__={duration:Date.now()-i},t(n,r,Yp(e).slice(0,1e3)),Promise.reject(e)}))}}}}]),e}(),im=function(){function e(){Sp(this,e),jp(this,"name","SourcePerformance"),jp(this,"ignoreType",["xmlhttprequest","fetch"]),jp(this,"MIN_THRESHOLD",1e3),jp(this,"defaultIgnoreUrls",["https://fe-static.wpscdn.cn/apm_sdk_proxy/"]),jp(this,"isPreCollected",!1),jp(this,"config",{switch:!0,samplingRate:1,threshold:3e3,ignoreUrls:Array.prototype.concat(this.defaultIgnoreUrls)}),jp(this,"proxy",null),jp(this,"sourceObserver",null)}return Tp(e,[{key:"getName",value:function(){return this.name}},{key:"monit",value:function(e){this.proxy=e,globalThis.PerformanceObserver&&(this.sourceObserver=new PerformanceObserver(this.handleObserver.bind(this)),this.sourceObserver.observe({entryTypes:["resource"]}))}},{key:"exportFuncs",value:function(){return{}}},{key:"setConfig",value:function(e){var t,n,r,i,o=null===(t=e.pluginConfig)||void 0===t?void 0:t.source;(this.config.switch=null!==(n=null==o?void 0:o.switch)&&void 0!==n?n:this.config.switch,this.config.samplingRate=null!==(r=null==o?void 0:o.samplingRate)&&void 0!==r?r:this.conrls)&&(Array.isArray(o.ignoreUrls)&&o.ignoreUrls.every((function(e){return Up(e)||Wp(e)}))?this.config.ignoreUrls=Array.prototype.concat(o.ignoreUrls,this.defaultIgnoreUrls):(Td.warn("[sourcePlugin - ignoreUrls] field type need Array and value need string or RegExp"),o.ignoreUrls=this.config.ignoreUrls.slice(0,-this.defaultIgnoreUrls.length))),o&&!Vp(o.threshold))&&(!zp(o.threshold)||o.threshold<this.MIN_THRESHOLD?(Td.warn("[sourcePlugin - threshold] filed type need number and minimum value is 1000ms"),o.threshold=this.config.threshold):this.config.threshold=null!==(i=null==o?void 0:o.threshold)&&void 0!==i?i:this.config.threshold);this.isPreCollected||(this.isPreCollected=!0,this.handlePageLoadSourceTiming())}},{key:"isEnabled",value:function(){return this.config.switch}},{key:"transform",value:function(e,t){var n=this;return Xp(this.config.samplingRate,null==t?void 0:t._uuid)?(Array.isArray(e)?e:[e]).map((function(e){var t=new Np;return t._analy_type=up["source-performance"],t._ct=e.date,t._sampling_rate=n.config.samplingRate,delete e.date,t.contents=[e],t.wrap()})):(Td.warn("plugin - ".concat(this.name," is not satitroy",value:function(){var e;null===(e=this.sourceObserver)||void 0===e||e.disconnect()}},{key:"checkSourceUrlValidate",value:function(e){return!!e&&!this.config.ignoreUrls.some((function(t){return t&&new RegExp(t).test(e)}))}},{key:"handlePerformanceData",value:function(e){var t=this;e.forEach((function(e){var n=e.name,r=e.duration;if(t.checkSourceUrlValidate(n)&&r>=t.config.threshold){var i=e;if(!t.ignoreType.includes(i.initiatorType)){var o,a=Lv.reduce((function(e,t){return e[t]=i[t],e}),Object.create(null));a.url=n,a.duration=r,a.date=Date.now(),a.initiatorType=i.initiatorType,a.threshold=t.config.threshold,null===var e=globalThis.performance.getEntriesByType("resource");this.handlePerformanceData(e)}},{key:"handleObserver",value:function(e){if(this.isPreCollected){var t=e.getEntries();this.handlePerformanceData(t)}}}]),e}();return vv.setConfig({samplingRate:1e3}),function(){if(_d()||xd()||kd()){var e=new Cv;return e.use([new Bv,new Fv,new Hv,new Vv,new nm,new qv,new rm,new im,new Nv]),e}var t=new xv;return t.use([new Bv,new Fv,new Hv,new Vv,new tm,new qv,new rm,new im,new Nv]),t}()}();
