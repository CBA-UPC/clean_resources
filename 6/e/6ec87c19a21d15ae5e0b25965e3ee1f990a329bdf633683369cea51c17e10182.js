import{f as h,p as U}from"./notificationStore.Dik4qyms.js";import{s as g,a as u,i as w}from"./videoPlayerStore.LmlbXoqk.js";import{w as p,d as A}from"./entry.Cu783cqS.js";import{l as F,T}from"./logger.rxQQzaAn.js";import{_ as Y}from"./preload-helper.0HuHagjb.js";import{g as G}from"./scheduler.6hyDou9G.js";import{s as H}from"./sourceOfPlaybackStore.zl-3pXWw.js";import{d as B}from"./devLog.vYr5EpRH.js";let N;g.subscribe(e=>{N=e});function be(e){window.dataLayer=window.dataLayer||[];const n=u.get("uid")??"",o=u.get("spid")??"",r=!!u.get("profileEmail");e.client_id=n,e.unique_id=n,e.streaming_profile_id=o,e.hasEmailProfile=r,e.activeFeatureFlags=h.getActiveFlags(),e.master_sitting_session_id=N??"",F.info(e,"analytics"),window.dataLayer.push(e)}const V=p(0),d=p([]),W=A([d,V],([e,n])=>e.map(o=>o.type==="POST"&&o.time===0&&o.streamDuration!==n&&n!==0?{...o,time:Math.floor(n)}:o)),R=p(!1);R.subscribe(e=>{e&&w.set(!1)});const ye=p(""),I=p({});d.subscribe(e=>{const n={};e.forEach(o=>{n[o.id]=o.watched}),I.set(n)});const Ae=A(W,e=>{var r,E;const n=(E=(r=e==null?void 0:e.filter(l=>!l.watched))==null?void 0:r.map(l=>({time:l.time,type:l.type})))==null?void 0:E.filter((l,P,_)=>{var k;return P===0||l.time!==((k=_==null?void 0:_[P-1])==null?void 0:k.time)});return n==null?void 0:n.sort((l,P)=>l.time-P.time)}),de=A([d,I],([e,n])=>{const o=e==null?void 0:e.filter(r=>r.type==="POST");return o==null?void 0:o.every(r=>n[r.id])});A([d,I],([e,n])=>{const o=e==null?void 0:e.filter(r=>r.type==="PRE");return o==null?void 0:o.every(r=>n[r.id])});var K=(e=>(e[e.AD_BREAK_READY=0]="AD_BREAK_READY",e[e.AD_CAN_PLAY=1]="AD_CAN_PLAY",e[e.AD_METADATA=2]="AD_METADATA",e[e.ALL_ADS_COMPLETED=3]="ALL_ADS_COMPLETED",e[e.CLICK=4]="CLICK",e[e.COMPLETE=5]="COMPLETE",e[e.CONTENT_PAUSE_REQUESTED=6]="CONTENT_PAUSE_REQUESTED",e[e.CONTENT_RESUME_REQUESTED=7]="CONTENT_RESUME_REQUESTED",e[e.DURATION_CHANGE=8]="DURATION_CHANGE",e[e.EXPANDED_CHANGED=9]="EXPANDED_CHANGED",e[e.FIRST_QUARTILE=10]="FIRST_QUARTILE",e[e.IMPRESSION=11]="IMPRESSION",e[e.INTERACTION=12]="INTERACTION",e[e.LINEAR_CHANGED=13]="LINEAR_CHANGED",e[e.LOADED=14]="LOADED",e[e.LOG=15]="LOG",e[e.MIDPOINT=16]="MIDPOINT",e[e.PAUSED=17]="PAUSED",e[e.RESUMED=18]="RESUMED",e[e.SKIPPABLE_STATE_CHANGED=19]="SKIPPABLE_STATE_CHANGED",e[e.SKIPPED=20]="SKIPPED",e[e.STARTED=21]="STARTED",e[e.THIRD_QUARTILE=22]="THIRD_QUARTILE",e[e.USER_CLOSE=23]="USER_CLOSE",e[e.VIEWABLE_IMPRESSION=24]="VIEWABLE_IMPRESSION",e[e.VOLUME_CHANGED=25]="VOLUME_CHANGED",e[e.VOLUME_MUTED=26]="VOLUME_MUTED",e[e.AD_LOAD=27]="AD_LOAD",e[e.AD_PLAY=28]="AD_PLAY",e[e.AD_BUFFERING=29]="AD_BUFFERING",e[e.AD_PROGRESS=30]="AD_PROGRESS",e))(K||{});const Q="",x="edf6ca3d6687cee29bf772b8b132bd1d7fbf5cb7";let s=null,i=null,a={},C={},b={},c={},y,S,t,f,D,m,O;R.subscribe(e=>{m=e});g.subscribe(e=>{O=e});const z=async()=>{t=(await Y(()=>import("./conviva-core-sdk.qQXfjgxP.js").then(e=>e.c),__vite__mapDeps([0,1]),import.meta.url)).default;{const e={};e[t.Constants.GATEWAY_URL]=Q,t.Analytics.init(x,null,e),t.Analytics.setDeviceMetadata(X())}},_e=()=>{s&&(s.reportPlaybackEnded(),s.release(),s=null),i&&(i.release(),i=null)},q=()=>{const e=G(U),n=e.url.href,o=e.url.search.split("?")[1],r=e.url.searchParams.keys();let E=!1;for(const l of r)if(l.includes("utm")){E=!0;break}return E?o:n},Se=async(e,n)=>{switch(a={},C={},D=n,H.subscribe(r=>{f=r}),B("Conviva Initialized - the source of playback is","=",f.sourceOfPlayback),await z(),e.memberOf){case"series":a["c3.cm.seriesName"]=e.seriesName;break;default:a["c3.cm.seriesName"]=e.title;break}S=e.isLiveVideo,a["c3.cm.affiliate"]="web",a.drm=e.hasDrm?"true":"false",a[t.Constants.PLAYER_NAME]="QxH-US-Website",a[t.Constants.ASSET_NAME]=e.isLiveVideo?e.channelCode===T.QvcNow?"QNOW":e.channelCode:e.title,a[t.Constants.STREAM_URL]=e.url,a[t.Constants.IS_LIVE]=e.isLiveVideo?t.Constants.StreamType.LIVE:t.Constants.StreamType.VOD,a[t.Constants.VIEWER_ID]=u.get("uid")??"",a.streaming_profile_id=u.get("spid")??"",a[t.Constants.DEFAULT_RESOURCE]="AKAMAI",a[t.Constants.ENCODED_FRAMERATE]=30,a["c3.app.version"]="v1",a["c3.cm.contentType"]=e.isLiveVideo?"SHOW":e.contentType,a["c3.cm.channel"]=e.isLiveVideo?e.channelCode===T.QvcNow?"QNOW":e.channelCode:"NULL",a["c3.cm.brand"]=Array.isArray(e.companyCode)?e.companyCode.length==2?"QXH":e.companyCode[0]:e.companyCode,f.sourceOfPlayback==="HOME PAGE"&&(a.ShelfStyle=e.shelfStyle?e.shelfStyle.toUpperCase():"NULL"),a["c3.cm.categoryType"]="NULL",a["c3.cm.name"]="Ediflo",a["c3.cm.id"]=e.id===T.QvcNow?"QNOW":e.id,a["c3.cm.seasonNumber"]="NULL",a["c3.cm.showTitle"]=e.title,a["c3.cm.episodeNumber"]="NULL",a["c3.cm.genre"]="NULL",a["c3.cm.genreList"]="NULL",a.SourceOfPlayback=f.sourceOfPlayback??"NULL";const o=q();a["c3.cm.utmTrackingUrl"]=o,f.sourceOfPlayback==="DEEPLINK"?a["c3.cm.referrer"]=document.referrer&&!document.referrer.includes(location.origin)?document.referrer:"NULL":a["c3.cm.referrer"]="NULL",a.SourceOfPlaybackDetails=f.sourceOfPlaybackDetails?f.sourceOfPlaybackDetails===T.QvcNow?"QNOW":f.sourceOfPlaybackDetails:"NULL",a.SourceOfPlaybackPosition=f.sourceOfPlaybackPosition??"NULL",S&&(a[t.Constants.DURATION]=" "),e!=null&&e.productItemID&&(a.ProductItemID=e.productItemID),a.MasterSittingSessionId=O??"NULL",s=t.Analytics.buildVideoAnalytics(),window.convivaVideoAnalytics=s,C[t.Constants.FRAMEWORK_NAME]=n?"HTML5":"hls.js",C[t.Constants.FRAMEWORK_VERSION]=n?"NaForHTML5":"1.1.5",s.setPlayerInfo(C),s.setContentInfo(a),s.reportPlaybackRequested(),s==null||s.setCallback(function(){s!==null&&(s.reportPlaybackMetric(t.Constants.Playback.PLAY_HEAD_TIME,y*1e3),s.reportPlaybackMetric(t.Constants.Playback.BUFFER_LENGTH,J()))}),re()},v=()=>{let e=!1;return function(n){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(n.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||(window==null?void 0:window.opera)),e},j=()=>{let e=!1;return function(n){/(ipad|tablet|(android(?!.*mobile))|(windows(?!.*phone)(.*touch))|kindle|playbook|silk|(puffin(?!.*(IP|AP|WP))))/.test(n)&&(e=!0)}(navigator.userAgent||navigator.vendor||(window==null?void 0:window.opera)),e},X=()=>{const e={};return v()?e[t.Constants.DeviceMetadata.TYPE]=t.Constants.DeviceType.MOBILE:j()?e[t.Constants.DeviceMetadata.TYPE]=t.Constants.DeviceType.TABLET:e[t.Constants.DeviceMetadata.TYPE]=t.Constants.DeviceType.DESKTOP,e[t.Constants.DeviceMetadata.CATEGORY]=t.Constants.DeviceCategory.WEB,e},J=()=>{const e=document.getElementById("main-video"),n=e==null?void 0:e.buffered;if(n===void 0)return;let o=0;for(let r=0;r<n.length;r++){const E=n.start(r),l=n.end(r);E<=y&&y<l&&(o+=l-y)}return o*1e3},De=e=>{if(s!==null){const n={};n["c3.cm.showTitle"]=e,n["c3.cm.seriesName"]=e,s.setContentInfo(n)}},Z=()=>{s!==null&&(m?L(18):s.reportPlaybackMetric(t.Constants.Playback.PLAYER_STATE,t.Constants.PlayerState.PLAYING))},$=()=>{s!==null&&(m?L(17):s.reportPlaybackMetric(t.Constants.Playback.PLAYER_STATE,t.Constants.PlayerState.PAUSED))},ee=()=>{s!==null&&(m||s.reportPlaybackMetric(t.Constants.Playback.PLAYER_STATE,t.Constants.PlayerState.BUFFERING))},te=()=>{s!==null&&(m?L(29):s.reportPlaybackMetric(t.Constants.Playback.PLAYER_STATE,t.Constants.PlayerState.BUFFERING))},se=()=>{s!==null&&(m?L(5):(s.reportPlaybackMetric(t.Constants.Playback.PLAYER_STATE,t.Constants.PlayerState.STOPPED),s.reportPlaybackEnded(),s.release(),s=null,t.Analytics.release()))},Ie=()=>{s!==null?m||s.reportPlaybackFailed("Fatal error occured"):(s=t.Analytics.buildVideoAnalytics(),s.reportPlaybackFailed("Fatal error occured")),s.release(),s=null,t.Analytics.release()},ne=()=>{s!==null&&(m||s.reportPlaybackMetric(t.Constants.Playback.SEEK_STARTED))},ae=()=>{s!==null&&(m||s.reportPlaybackMetric(t.Constants.Playback.SEEK_ENDED))},oe=()=>{if(s!==null&&!S){const e=document.getElementById("main-video"),n=e.duration;if(!isNaN(n)&&n!==1/0){const o={};o[t.Constants.DURATION]=parseInt(n.toString(),10),s.setContentInfo(o)}s.reportPlaybackMetric(t.Constants.Playback.RESOLUTION,e.videoWidth,e.videoHeight)}},ie=()=>{if(s!==null){const e=document.getElementById("main-video");s.reportPlaybackMetric(t.Constants.Playback.RESOLUTION,e==null?void 0:e.offsetWidth,e==null?void 0:e.offsetHeight)}},ke=e=>{s!==null&&s.reportPlaybackMetric(t.Constants.Playback.BITRATE,e)},M=()=>{s&&(m?L(5):(s.reportPlaybackEnded(),s.release(),s=null,window.removeEventListener("beforeunload",M)))},re=()=>{const e=document.getElementById("main-video");e==null||e.addEventListener("pause",$),e==null||e.addEventListener("playing",Z),e==null||e.addEventListener("emptied",ee),e==null||e.addEventListener("waiting",te),e==null||e.addEventListener("ended",se),e==null||e.addEventListener("loadedmetadata",oe),e==null||e.addEventListener("seeking",ne),e==null||e.addEventListener("seeked",ae),e==null||e.addEventListener("timeupdate",ie),window.addEventListener("beforeunload",M)},ce=()=>{b={},i===null&&(i=t.Analytics.buildAdAnalytics(s),b[t.Constants.FRAMEWORK_NAME]=D?"HTML5":"hls.js",b[t.Constants.FRAMEWORK_VERSION]=D?"NaForHTML5":"1.1.5",i.setAdPlayerInfo(b)),i!==null&&(i.reportAdLoaded(c),i.reportAdStarted(c))},le=()=>{s!==null&&s.reportAdBreakStarted(t.Constants.AdType.CLIENT_SIDE,t.Constants.AdPlayer.CONTENT)},me=()=>{s!==null&&s.reportAdBreakEnded()},L=(e,n)=>{s!==null&&(e===21?n&&(c={},c[t.Constants.ASSET_NAME]=n.title,c[t.Constants.STREAM_URL]=n.streamUri,c[t.Constants.PLAYER_NAME]="QxH-US-Website",c[t.Constants.VIEWER_ID]=u.get("uid")??"",c[t.Constants.DURATION]=n.streamDuration,c[t.Constants.IS_LIVE]=t.Constants.StreamType.VOD,c[t.Constants.ENCODED_FRAMERATE]=30,c[t.Constants.DEFAULT_RESOURCE]="AKAMAI",c["c3.ad.position"]=n.type==="PRE"?t.Constants.AdPosition.PREROLL:n.type==="MID"?t.Constants.AdPosition.MIDROLL:t.Constants.AdPosition.POSTROLL,c["c3.ad.technology"]=t.Constants.AdType.CLIENT_SIDE,c["c3.ad.id"]=n.id,c["c3.ad.system"]="NA",c["c3.ad.isSlate"]=!1,ce()):e===18?i!==null&&i.reportAdMetric(t.Constants.Playback.PLAYER_STATE,t.Constants.PlayerState.PLAYING):e===17?i!==null&&i.reportAdMetric(t.Constants.Playback.PLAYER_STATE,t.Constants.PlayerState.PAUSED):e===5?i!==null&&(i.reportAdMetric(t.Constants.Playback.PLAYER_STATE,t.Constants.PlayerState.STOPPED),i.reportAdEnded(),i.release(),i=null):e===20?i!==null&&(i.reportAdMetric(t.Constants.Playback.PLAYER_STATE,t.Constants.PlayerState.STOPPED),i.reportAdSkipped(),i.release(),i=null):e===6?le():e===7?me():e===29?i!==null&&i.reportAdMetric(t.Constants.Playback.PLAYER_STATE,t.Constants.PlayerState.BUFFERING):e===30&&i!==null&&i.reportAdMetric(t.Constants.Playback.PLAYER_STATE,t.Constants.PlayerState.PLAYING))};export{K as A,d as a,ye as b,Ae as c,de as d,De as e,Ie as f,_e as g,Se as h,R as i,L as j,V as m,ke as o,be as s,W as u};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./conviva-core-sdk.qQXfjgxP.js","./logger.rxQQzaAn.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
