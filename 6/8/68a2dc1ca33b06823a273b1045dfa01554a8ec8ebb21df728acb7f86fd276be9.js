!);var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"redpop@b474a6ad4354f4ba5fde672fa4e9c2c267684761"};"use strict";(self.webpackChunk_tumblr_redpop=self.webpackChunk_tumblr_redpop||[]).push([[7403],{93207:57125:76636:(e,r,t)=>{t.d(r,{Z:()=>v});var a=t(54138),s=t.n(a),n=t(54589),i=t.n(n),o=t(95004),l=t(93853),d=t(90127),c=t(43523),u=t(78667),h=t(6259),m=t(92209),p=t(92816),g=t(2629),b=["routeQueryProps","onClick"];let v=e=>{var r=e.routeQueryProps,t=e.onClick,a=i()(e,b),n=(0,u.bp)(),v=n._c,f=n.isLoggedIn,x=n.logEvent,y=(0,h._)().modalLocation,w=(0,o.useRef)(null),j=(0,m.Z)(r),k=()=>(0,d.TL)({},j);return(0,g.jsx)(l.ZP,{hotkey:{key:l.SV.c,command:,children:(0,g.jsx)(p.Z,s()(s()({},a),{},{getPath:k,onClick:e=>{x({eventName:c.J.PFComposePost}),null==t||t(e)},forwardedRef:w,isAlreadyOnPostFormPath:()=>!!y&&(0,d.Lv)(y.pathname),disableNavigation:!f},!f&&{"data-login-wall-type":"newTaggedPost","data-login-wall-title":v('Login wall: Title shown when user clicks on the "New tagged post" button, after exceeding click counter limit',"You were *this close* to a post…"),"data-login-wall-page":"floating","data-login-wall-tag-label":j.tags,"data-login-wall-redirect":"/dashboard","data-login-wall-destination":(0,d.fO)(j.tags||""),"data-login-wall-new-post-path":k()}))})}},93288:(e,r,t)=>{t.d(r,{Z:()=>l});var a=t(50209),s=t.n(a),n=t(95004),i=t(25200),o=t(2629);class l extends n.Component{constructor(){super(...arguments),s()(this,"state",{error:null}}componentDidCatch(e,r){var t,a,s=void 0;this.props.source&&(s={tags:{source:this.props.source}}),(0,i.Tb)(e,s),null===(t=(a=this.props).onError)||void 0===t||t.call(a)}render(){var e=this.state.error;return e?this.props.FallbackComponent?(0,o.jsx)(this.props.FallbackComponent,{error:e}):null:this.props.children}}},30862:(e,r,t)=>{t.d(r,{_:()=>eh,Z:()=>ep});var a=t(54138),s=t.n(a),n=t(5754),i=t.n(n),o=t(76636),l=t(2487),d=(0,t(36343).q)("coins");d.defaultProps={size:{width:20,height:21}};var c=t(7161),u=t(52870),h=t(69654),m=t(10689),p=t(70106),g=t(85768),b=t(63764),v=t(93390),f=t(25723),x=t(31872),y=t(73543),w=t(9358),j=t(34417),k=t(90127),T=t(32415),S=t(32468),C=t(51826),F=t(18046),H={light:"color",transparent:"color","transparent-dark":"transparent-dark"},P=t(43523),N=t(78667),M=t(21430),A=t(93099),B=t(63583),E=t.n(B),Z=t(57330),L=t(28886),$=t(55953),I=t(82449),D=t(80293),W=(0,D.Z),"AsyncAccountPopover");let z=(0,D.Z),"AsyncActivityPopover");var R=t(33970),_=t.n(R),O=t(44009),Y=t(23670),`,),U=t(44238),Q=t(95004),V=t(99708);let q={menuContainer:"KTRcB",menuTarget:"PK7qG",menuTargetWrapper:"B1L2M",activeButton:"cckUS",rounded:"ho0MD",sparkle:"Kz7JC",hidden:"YkYNc"};var X=t(2629);let K=e=>{var r=e.children,t=e.label,a=e.isActive,s=e.link,n=e.useRouter,o=e.notificationCount,l=void 0===o?0:o,d=e.notificationStatus,c=e.krakenEvent,u=e.featureExposedKey,h=e.isNew,m=(0,N.bp)(),p=m.logEvent,g=m.getCookie,b=m.setCookie;(0,Q.useEffect)(()=>{u&&p({eventName:P.J.FeatureExposed,eventDetails:{feature_key:u}})},[]);var v=J(t),f=(0,Q.useState)(h&&"1"===g(G(v))),x=_()(f,2),y=x[0],w=x[1],j=(0,X.jsx)("span",{className:i()(q.sparkle,{[q.hidden]:!h||h&&y}),children:(0,X.jsx)(V.Z,{})}),k=(0,X.jsxs)(X.Fragment,{children:[(0,X.jsxs)(O.Z,{wrapperClassName:q.menuTargetWrapper,className:i()(q.menuTarget,{[q.activeButton]:a}),label:t,"aria-current":!!a&&"page",onClick:()=>{c&&p({eventName:c}),h&&(w(!0),b(G(v),"1",{maxAge:24192e5}))},children:[r,j]}),l>0&&(0,X.jsx)(U.Z,{count:l,showNumber:!0}),d&&(0,X.jsx)(U.Z,{count:1,showNumber:!1,isCircle:!0,style:{top:-9,right:-9}})]});return(0,X.jsx)("div",{className:q.menuContainer,children:n?(0,X.jsx)(Y.Z,{to:s,tabIndex:-1,children:k}):(0,X.jsx)("a",{href:s,tabIndex:-1,children:k})})};var ee=t(50209),er=t.n(ee),et=t(8535),ea=t(93288),es=t(9557),en=t(53714),ei=t(43684),eo=(e,r)=>{var t=e.children,a=e.label,s=e.isActive,n=e.notificationCount;return(0,X.jsxs)(O.Z,{wrapperClassName:q.menuTargetWrapper,label:a,"aria-current":!!s&&"page",children:[(0,X.jsxs)("span",{className:i()(q.menuTarget,{[q.activeButton]:s}),children:[t,r]}),(0,X.jsx)(U.Z,{count:n})]})};let el=e=>{var r=(0,N.bp)(),t=r.logEvent,a=r.configRef,n=e.isNew,o=e.label,l=e.componentWidth,d=e.componentMaxHeight,c=e.component,u=e.showOverflowY,h=e.controlledPopoverProps,m=e.theme,p=e.onOpen,g=(0,N.bp)(),b=g.getCookie,v=g.setCookie,f=J(o),x=(0,Q.useState)((()=>{if(!n)return!1;if("shop-tumblrmart"===f){var e=null!=a&&a.tumblrmartLastUpdated?1e3*a.tumblrmartLastUpdated:0;return Number(b(G(f)))>e}return"1"===b(G(f))})()),y=_()(x,2),w=y[0],j=y[1],k={onOpen:()=>{null==p||p(),t({eventName:e.krakenEvent}),n&&(j(!0),v(G(f),"shop-tumblrmart"===f?new Date().getTime().toString():"1",{maxAge:24192e5}))},showOverflowY:u,component:(0,X.jsx)(ea.Z,{children:c},o),height:"auto",position:ei.I2.Bottom,width:l,isFlipEnabled:!1,maxHeight:d,closeForAllExternalClicks:!0,popoverWrapperClassName:q[void 0===m?"default":m]},T=(0,X.jsx)("span",{className:i()(q.sparkle,{[q.hidden]:!n||w}),children:(0,X.jsx)(V.Z,{})});return(0,X.jsx)("div",{className:q.menuContainer,children:h?(0,X.jsx)(en.ZP,s()(s()(s()({},k),h),{},{children:eo(e,T)})):(0,X.jsx)(es.Z,s()(s()({},k),{},{children:eo(e,T)}))})};class ed extends Q.Component{constructor(){super(...arguments),er()(this,"state",{isOpen:!1}),er()(this,"toggle))}render(){var e=this.props.popoverMenuItemProps,r=this.state.isOpen;return(0,X.jsx)(el,s()(s()({},e),{},{controlledPopoverProps:{isOpen:r,toggle:this.toggle},component:(0,X.jsx)("div",{className:"GcA7R",children:(0,X.jsx)(et.Z,{})})}))}}let ec={headerWrapper:"hlDot",headerWrapperTransparent:"C38Rc",backgroundTransparent:"hvZ5A",header:"_3kR_",menuLeft:"rllUD",searchBar:"nzmrE",menuLeftIsOnlyMenuPart:"BY8m2",loggedOutButtons:"yTPpj",menuRight:"uuWZ2",logo:"QOMh2",postIconButton:"xxqHJ"};var eu={width:22,height:22},eh=function(e){var r=e.isMobile,t=void 0!==r&&r,a=(0,N.bp)(),s=a._t,n=a.features.liveStreamingWebPayments,i=a.logEvent;return n?(0,X.jsx)(L.Z,{useRouter:!0,link:"/live/shop",startChild:!t&&(0,X.jsx)(d,{size:{width:20,height:21},colors:{primary:E().paletteGray65}}),theme:t?L.f.Mobile:L.f.Desktop,onClick:()=>i({eventName:P.J.CreditsNavClick}),children:(0,X.jsx)("div",{className:ec.liveStreamingCredits,children:(0,X.jsx)("span",{children:s("Live streaming credits")})})}):null},em=e=>{var r,t=e.activePage,a=e.headerTheme,n=e.showLimitedHeader,d=e.transparentBackground,B=e.hardLinkNavigation,L=e.blogName,D=e.inboxCount,R=e.unseenPostCount,_=e.notificationCount,O=e.unreadMessagesCount,Y=e.privateGroupBlogUnreadPostTotal,G=e.hideLoggedOutButtons,J=e.hideLoginButton,U=e.hideSignUpButton,Q=e.logoUrl,V=e.registrationSource,q=(0,N.bp)(),ee=q._t,er=q.isLoggedIn,et=q.features,ea=(0,M.N)(),es=ea.isLikeCountOutdated,en=ea.setIsLikeCountOutdated,ei=(0,T.Pc)().refetch,eo=(0,Z.H)(t),eh=!et.redpopUnreadNotificationsOnTab||!(0,S.fR)(t),em=!n&&(0,X.jsxs)("div",{className:ec.menuRight,children:[(0,X.jsx)(j.Z,{}),(0,X.jsx)(K,{link:k.o_.dashboard,useRouter:!0,krakenEvent:P.J.HomeNavClick,label:ee("Home"),isActive:(0,S.fR)(t),notificationCount:eh?R:0,children:(0,X.jsx)(h.Z,{size:{width:20,height:21}})}),et.liveStreamingWeb&&et.liveStreamingUserEnabled&&(0,X.jsx)(K,{link:k.o_.live,useRouter:!0,label:ee("Live"),isActive:(0,S.jl)(t),krakenEvent:P.J.TumblrLiveLiveAccessed,featureExposedKey:"liveStreaming",isNew:!0,children:(0,X.jsx)(p.Z,{size:{width:24,height:24}})}),(0,X.jsx)(K,{useRouter:!0,link:(0,A.Z)(k.o_.exploreByMode,{exploreMode:et.exploreTodayTab?F.Ru.Today:F.Ru.Recommended}),krakenEvent:P.J.ExploreNavClick,label:ee("Explore"),isActive:(0,S.J8)(t),children:(0,X.jsx)(u.Z,{size:eu})}),et.tumblrPatio?(0,X.jsx)(K,{useRouter:!0,isActive:!0,link:k.o_.patio,label:ee("Patio"),children:(0,X.jsx)(c.$,{colors:{primary:E().paletteTransparentWhite40}})}):null,(0,X.jsx)(el,{component:(0,X.jsx)(w.Z,{source:"desktop-header"}),componentWidth:w.B,componentMaxHeight:"90vh",label:ee("Shop TumblrMart"),krakenEvent:P.J.TumblrMartShopClick,theme:"rounded",isNew:!0,children:(0,X.jsx)(f.Z,{size:eu})}),(0,X.jsx)(K,{link:k.o_.inbox,useRouter:!0,krakenEvent:P.J.InboxNavClick,label:ee("Inbox"),isActive:(0,S.GT)(t),notificationCount:D,children:(0,X.jsx)(g.Z,{size:{width:23,height:21}})}),(0,X.jsx)(ed,{popoverMenuItemProps:{children:(0,X.jsx)(b.Z,{size:eu}),componentWidth:280,componentMaxHeight:490,label:ee("Messaging"),isActive:(0,S.ww)(t),showOverflowY:!0,notificationCount:O,krakenEvent:P.J.MessagesPopover}}),(0,X.jsx)(el,{component:(0,X.jsx)(z,{}),componentWidth:380,componentMaxHeight:"90vh",label:ee("Activity"),isActive:(0,S.fu)(t),notificationCount:_,showOverflowY:!0,krakenEvent:P.J.ActivityPopover,children:(0,X.jsx)(m.Z,{size:{width:14,height:21}})}),(0,X.jsx)(el,{component:(0,X.jsx)(W,{activePage:t}),componentWidth:240,componentMaxHeight:"90vh",label:ee("Account"),isActive:(0,S.G8)(t),notificationCount:Y,krakenEvent:P.J.AccountPopover,onOpe},children:(0,X.jsx)(x.Z,{size:{width:15,height:21}})}),(0,X.jsx)(o.Z,{label:ee("New post"),className:ec.postIconButton,routeQueryProps:{blogName:L,isPageBlogPage:(0,S.Sr)(t),composeSettings:(0,C.W)(t)},children:(0,X.jsx)(v.Z,{size:{height:22,width:22}})})]}),ep=!G&&(0,X.jsx)("div",{className:i()(ec.menuRight,ec.loggedOutButtons),children:(0,X.jsx)(I.Z,{theme:H[a],hideLoginButton:J,hideSignUpButton:t!==S.vS.landing||U,registrationSource:V,loginButtonStyle:{marginRight:10}})}),eg=er?em:ep,eb=d||"transparent"===a||"transparent-dark"===a;return r=Q?(0,X.jsx)(l.Z,{hardLinkHome:B,logoUrl:Q}):(0,X.jsx)($.Z,{theme:a,hardLinkHome:B,animatedGradientOnHover:!eb}),(0,X.jsx)("div",{className:i()({[ec.headerWrapperTransparent]:d,[ec.headerWrapper]:!d,[ec.backgroundTransparent]:eb}),children:(0,X.jsxs)("header",{className:ec.header,children:[(0,X.jsxs)("div",{className:i()(ec.menuLeft,{[ec.menuLeftIsOnlyMenuPart]:!eg}),children:[(0,X.jsx)("div",{className:ec.logo,children:r}),(0,X.jsx)(y.Z,s()({className:ec.searchBar,initialSearchTerm:eo,hardLinkToSearchPage:B},n&&{enableTypeahead:!0}))]}),eg]})})};em.defaultProps={headerTheme:"light",unseenPostCount:0,notificationCount:0,privateGroupBlogUnreadPostTotal:0,unreadMessagesCount:0,inboxCount:0,unreadCommunityPostTotal:0};let ep=em},28886:(e,r,t)=>{t.d(r,{Z:()=>g,f:()=>p});var a=t(54138),s=t.n(a),n=t(5754),i=t.n(n),o=t(95004),l=t(44009),d=t(23670),c=t(43523),u=t(78667),h=t(93207),m=t(2629),}({});let g=function(e){var r,t=e.children,a=e.startChild,n=e.endChild,g=e.link,b=e.isActive,v=void 0!==b&&b,f=e.isOpen,x=void 0!==f&&f,y=e.isExternalLink,w=void 0!==y&&y,j=e.onClick,k=e.buttonId,T=e.subNavId,S=e.theme,C=e.title,F=e.useRouter,H=e.childIsButton,P=e.featureExposedKey,N=e.forwardedRef,M=(0,u.bp)(),A=M.logEvent,B=M.features.redpopDesktopVerticalNav;(0,o.useEffect)(()=>{P&&A({eventName:c.J.FeatureExposed,eventDetails:{feature_key:P}})},[]);var E="string"==typeof t?t:null===(r=t.props)||void 0===r?void 0:r.children,Z=g?F?(0,m.jsx)(d.Z,s()(s()({},v&&{"aria-current":"page"}),{},{to:g,className:h.Z.navLink,target:w?"_blank":void 0,onClick:j})):(0,m.jsx)("a",s()(s()({},v&&{"aria-current":"page"}),{},{className:h.Z.navLink,href:g,target:w?"_blank":void 0})):H?(0,m.jsx)(o.Fragment,{}):(0,m.jsx)(l.Z,s()(s()({},k&&T&&{id:k,"aria-controls":T,"aria-expanded":x,"aria-haspopup":!0}),{},{wrapperClassName:h.Z.navLinkButtonWrapper,className:h.Z.navLink,label:E,onClick:j,forwardedRef:N})),L=(0,m.jsxs)(m.Fragment,{children:[a&&(0,m.jsx)("div",{className:h.Z.startChildWrapper,children:a}),(0,m.jsxs)("div",{className:H?h.Z.navButton:h.Z.navInfo,children:[(0,m.jsx)("span",{className:h.Z.childWrapper,children:t}),(0,m.jsx)("span",{className:h.Z.endChildWrapper,children:n})]})]});return(0,m.jsx)("li",{className:i()(h.Z.navItem,{[h.Z.activeButton]:v,[h.Z.desktop]:S===p.Desktop,[h.Z.open]:x,[h.Z.newDesktopLayout]:B}),title:C,children:(0,o.cloneElement)(Z,void 0,L)})}},2487:(e,r,t)=>{t.d(r,{Z:()=>n});var a=t(63255),s=t(2629);let n=function(e){var r=e.logoUrl,t=e.hardLinkHome,n=(0,s.jsx)("div",{children:(0,s.jsx)("img",{src:r,alt:"Logo"})});return(0,s.jsx)(a.x,{hardLinkHome:t,children:n})}},63255:(e,r,t)=>{t.d(r,{x:()=>l});var a=t(23670),s=t(95004),n=t(43523),i=t(78667),o=t(2629),l=e=>{var r=e.children,t=e.hardLinkHome,l=(0,i.bp)(),d=l.isLoggedIn,c=l._t,u=l.logEvent,h=c("Home"),m=t||!d?"/":"/dashboard",p=(0,s.useCallback)(()=>{u({eventName:n.J.LogoClick,eventDetails:{destination:m}})},[m]);return t||!d?(0,o.jsx)("a",{href:m,"aria-label":h,onClick:p,children:r}):(0,o.jsx)(a.Z,{to:m,"aria-label":h,onClick:p,children:r})}},55953:(e,r,t)=>{t.d(r,{Z:()=>b});var a,s=t(54138),n=t.n(s),i=t(5754),o=t.n(i),l=t(45216),d=t(33814),c=t(78667),u=t(63583),h=t.n(u),m=t(63255),p=t(2629),g=(null===(a=l.P.defaultProps)||void 0===a?void 0:a.size)||{width:0,height:0};let b=function(e){var r=e.size,t=e.theme,a=e.hardLinkHome,s=e.animatedGradientOnHover,i=e.showFullLogo,u=(0,c.bp)().features,b=void 0!==i&&i?d.Z:l.P,v=(0,p.jsxs)("div",{className:o()("FQkf4",{tSe6h:void 0!==s&&s,Ovlgo:u.prideMonthLogoAnimation}),style:{width:`${(null==r?void 0:r.width)||g.width}px`,height:`${(null==r?void 0:r.height)||g.height}px`},children:[(0,p.jsx)("div",{className:"FP6oS"}),(0,p.jsx)(b,n()({className:"GjGsN",colors:{primary:["light","transparent"].includes(t||"")?h().paletteWhiteOnDark:h().paletteBlack}},r&&{size:r}))]});return(0,p.jsx)(m.x,{hardLinkHome:a,children:v})}},82449:(e,r,t)=>{t.d(r,{Z:()=>y});var a=t(54138),s=t.n(a),n=t(18488),i=t(90127),o=t(95004),l=t(78994),d=t(42580),c=t(43523),u=t(78667),h=t(58849),m=t(89465),p=t(63583),g=t(32560),b=t(34438),v=t(71581),f=(e,r)=>!!e[v.T.LoginWall]&&("/"===r||(0,i.lc)(r)||(0,i.tc)(r)||(0,i.Uv)(r)||(0,b.HA)(r)||(0,g.pN)(r)),x=t(2629);let y=function(e){var r,t,a,g=e.theme,b=e.hardLinkNavigation,v=e.hideLoginButton,y=e.hideSignUpButton,w=e.registrationSource,j=e.loginButtonStyle,k=e.signUpButtonStyle,T=e.disableLoginWall,S=(0,u.bp)(),C=S._t,F=S.logEvent,H=S.features,P=S.wwwBaseUrl,N=(0,h.h)().openLoginWall,M=(0,l.TH)(),A=M.pathname,B=M.search,E=(0,o.useCallback)(()=>F({eventName:c.J.ClickSignup}),[]),Z=(0,o.useCallback),[]),L=(0,o.useCallback)(e=>{null==e||e.preventDefault(),N({form:d.c.Login,redirect:A})},[]),$=(0,o.useCallback)(e=>{null==e||e.preventDefault(),N({form:d.c.Register})},[]),I=!T&&f(H,A)?L:Z,D=!T&&f(H,A)?$:E,W=b&&"_blank",z=b?P:"",R=new URLSearchParams(B).get("redirect_to")||void 0;switch(w||(w=(0,m.k)(A,"register_button")),g){case"transparent-dark":t={backgroundColor:p.transparentBlack15,textColor:p.paletteBlack},a={backgroundColor:p.black,textColor:p.transparentWhite50},r={mixBlendMode:"hard-light"};break;case"greyscale":t={backgroundColor:p.paletteBlack,textColor:p.gray40},a={backgroundColor:p.gray40,textColor:p.paletteBlack};break;default:t={backgroundColor:p.glassGreen,textColor:"#000000"},a={backgroundColor:p.dreamcastBlue,textColor:"#000000"}}return(0,x.jsxs)(x.Fragment,{children:[!v&&(0,x.jsx)(n.Z,s()(s()(s()({href:`${z}${(0,i.gZ)({formToShow:d.c.Login},{redirect_to:R})}`,feature:!1,size:"small",onClick:I,style:j},W&&{target:W}),t),{},{children:C("Log in")})),!y&&(0,x.jsx)(n.Z,s()(s()(s()(s()({href:`${z}${(0,i.gZ)({formToShow:d.c.Register},{source:w,redirect_to:R})}`,feature:!1,size:"small",onClick:D,style:k},W&&{target:W}),a),r&&{style:r}),{},{children:C("Sign up")}))]})}},7161:(e,r,t)=>{t.d(r,{$:()=>a});var a=(0,t(36343).q)("deck");a.defaultProps={size:{width:20,height:20}}},52870:(e,r,t)=>{t.d(r,{Z:()=>s});var a=(0,t(36343).q)("explore");a.defaultProps={size:{width:22,height:24}};let s=a},69654:(e,r,t)=>{t.d(r,{Z:()=>s});var a=(0,t(36343).q)("home");a.defaultProps={size:{width:20,height:21}};let s=a},10689:(e,r,t)=>{t.d(r,{Z:()=>s});var a=(0,t(36343).q)("lightning");a.defaultProps={size:{width:24,height:24}};let s=a},70106:(e,r,t)=>{t.d(r,{Z:()=>s});var a=(0,t(36343).q)("live-video");a.defaultProps={size:{width:24,height:24},useAltIcon:!1};let s=a},85768:(e,r,t)=>{t.d(r,{Z:()=>s});var a=(0,t(36343).q)("mail");a.defaultProps={size:{width:23,height:24}};let s=a},63764:(e,r,t)=>{t.d(r,{Z:()=>p});var a=t(54138),s=t.n(a),n=t(54589),i=t.n(n),o=t(36343),l=t(66498),d=t(14544),c=t(2629),u=["forceVariant"],h={default:(0,o.q)("messaging"),ghost:(0,o.q)("messaging-ghost"),pumpkin:(0,o.q)("messaging-pumpkin"),vampire:(0,o.q)("messaging-vampire")},m=e=>{var r=e.forceVariant,t=i()(e,u),a=(0,d.M)(),n=r;n||(n=(null==a?void 0:a.name)===l.Z.ghost?"ghost":(null==a?void 0:a.name)===l.Z.vampire?"vampire":(null==a?void 0:a.name)===l.Z.pumpkin?"pumpkin":"default");var o=h[n];return(0,c.jsx)(o,s()({},t))};m.defaultProps={size:{width:21,height:21}};let p=m},93390:(e,r,t)=>{t.d(r,{Z:()=>s});var a=(0,t(36343).q)("post");a.defaultProps={size:{width:24,height:24}};let s=a},25723:(e,r,t)=>{t.d(r,{Z:()=>s});var a=(0,t(36343).q)("shop");a.defaultProps={size:{width:19,height:19}};let s=a},99708:(e,r,t)=>{t.d(r,{Z:()=>s});var a=t(2629);let s=e=>{var r=e.useViewBox;return(0,a.jsxs)("svg",{className:"JzQ6G",viewBox:r?"0 0 36 31":void 0,children:[(0,a.jsx)("path",{fill:"var(--icon-color-primary, #ffffff)",d:"M29.434 2.806c.125-.618 1.007-.618 1.132 0l.294 1.458a7.216 7.216 0 0 0 4.706 5.39l.864.3a.577.577 0 0 1 0 1.091l-.864.3a7.216 7.216 0 0 0-4.706 5.39l-.294 1.46c-.125.617-1.007.617-1.132 0l-.294-1.46a7.216 7.216 0 0 0-4.706-5.39l-.864-.3a.577.577 0 0 1 0-1.09l.864-.3a7.216 7.216 0 0 0 4.706-5.39l.294-1.46Z"}),(0,a.jsx)("path",{fill:"var(--icon-color-primary, #ffffff)",d:"M5.373 15.636c.11-.566.92-.566 1.03 0l.036.179a6.246 6.246 0 0 0 4.024 4.681.5.5 0 0 1 0 .94 6.246 6.246 0 0 0-4.024 4.682l-.035.18c-.11.566-.92.566-1.031 0l-.035-.18a6.246 6.246 0 0 0-4.024-4.681.5.5 0 0 1 0-.941 6.246 6.246 0 0 0 4.024-4.681l.035-.18Z"}),(0,a.jsx)("path",{fill:"var(--icon-color-primary, #ffffff)",d:"M26.27 25.604c.068-.344.56-.344.628 0l.021.11a3.802 3.802 0 0 0 2.45 2.849.304.304 0 0 1 0 .573 3.802 3.802 0 0 0-2.45 2.849l-.021.11c-.067.344-.56.344-.628 0l-.021-.11a3.802 3.802 0 0 0-2.45-2.85.304.304 0 0 1 0-.572 3.802 3.802 0 0 0 2.45-2.85l.021-.109Z"}),(0,a.jsx)("path",{fill:"var(--icon-color-primary, #ffffff)",d:"M9.719 1.595c.055-.315.507-.315.562 0l.021.116a3.36 3.36 0 0 0 2.069 2.54.268.268 0 0 1 0 .499 3.36 3.36 0 0 0-2.069 2.539l-.02.116c-.056.315-.508.315-.563 0l-.021-.116a3.36 3.36 0 0 0-2.069-2.54.269.269 0 0 1 0-.499 3.36 3.36 0 0 0 2.069-2.539l.02-.116Z"})]})}},8535:(e,r,t)=>{t.d(r,{Z:()=>a});let a=(0,t(80293).Z),"AsyncMessaging")},34417:(e,r,t)=>{t.d(r,{Z:()=>ed});var a=t(33970),s=t.n(a),n=t(5754),i=t.n(n),o=t(30646),l=t(25190),d=t(13194),c=t(54138),u=t.n(c),h=t(95004),m=t(54236),p=t(93853),g=t(85060),b=t(73465),v=t(61812),f=t(79153);let x=t.p+"src/assets/images/horse-friend/horse-icon-e9d24a6a.png";var y=t(44009),w=t(98478),j=t(43523),k=t(78667),T=t(49116),S=t(96467);let C=t.p+"src/assets/images/horse-friend/headstone-f059b08d.png";var F=t(54382),H=t(23779);let P={horseFriend:"HNmfZ",horseFriendContainer:"Tcv9q",buttonIcon:"alRCv",active:"yHUeZ",horse:"VpfQW",horseFriendExpanded:"lVYgD",controlButtons:"C9Tsj",minimizeButton:"MgKiV",shareButton:"pyw0l",horseFriendGame:"XeOtC",sprite:"NZfyq",infoBox:"rDO3F",stats:"BZ18Y",poosRemoved:"lBtW2",comfortBarContainer:"CmXCV",comfortBar:"lvJLA",deathButtons:"FDLE7",horseFriendButton:"DUbBR",cemetery:"t551P",header:"OhWKq",headStones:"kGL95",headStone:"XLm40",headStoneText:"KPNq5",hide:"JOCmG"};var N=t(2629);let M=e=>{var r=e.onHeadstoneClick,t=(0,k.bp)()._c,a=(0,H.Q1)(),n=a.state,i=a.dispatch,o=(0,h.useState)(S.horseFriendHeaderHeight),l=s()(o,2),d=l[0],c=l[1],u=(0,h.useState)(-1),m=s()(u,2),p=m[0],g=m[1];(0,h.useEffect)(()=>{if(n.cemetery.length>S.horseFriendHeadstonesInViewport){var e=S.horseFriendHeadstoneViewportHeight-n.cemetery.length*S.horseFriendHeadstoneSize;-1===p&&d<e&&g(1),1===p&&d>S.horseFriendHeaderHeight&&g(-1),c(d+.5*p)}},[n.tick]);var b=e=>{var t=S.horseFriendHeadstoneSize+S.horseFriendHeadstoneTopMargin,a=parseInt(e.currentTarget.getAttribute("data-index")||"0");r({x:S.horseFriendPadding+S.horseFriendHeadstoneSize/2,y:d+a*t+t/2,id:`heart${a}${n.tick}`,opacity:1})};return(0,N.jsxs)("div",{className:P.cemetery,children:[(0,N.jsx)("div",{className:P.header,style:{height:S.horseFriendHeaderHeight},children:(0,N.jsx)("button",{className:P.horseFriendButton,onClick:()=>{i({type:"setShouldShowCemetery",shouldShowCemetery:!1})},children:(0,N.jsx)(F.ZP,{comment:"[Tumblrmart] Label on a button that brings the user back to playing Horse Friend",children:"tend to your horse"})})}),(0,N.jsx)("div",{className:P.headStones,style:{top:d},children:n.cemetery.map((e,r)=>(0,N.jsxs)("div",{className:P.headStone,children:[(0,N.jsx)("button",{"aria-label":t("[Tumblrmart] Label on a Horse Friend tombstone button that when clicked, allows the player to remember their dead horse","remember your horse"),onClick:b,"data-index":r,children:(0,N.jsx)("img",{src:C,width:S.horseFriendHeadstoneSize,height:S.horseFriendHeadstoneSize,alt:""})}),(0,N.jsxs)("div",{className:P.headStoneText,children:[(0,N.jsxs)(F.M2,{comment:"[Tumblrmart] text in Horse Friend that list a horse's name and how many days they lived",number:e.horse.age,params:{name:e.horse.name,number:e.horse.age},components:{br:(0,N.jsx)("br",{})},children:[(0,N.jsx)(F.CJ,{children:"[name] [br /] lived for 1 day"}),(0,N.jsx)(F.CN,{children:"[name] [br /] lived for [number] days"})]})," - ",(0,N.jsx)(F.ZP,{comment:"[Tumblrmart] text in Horse Friend that lists the players numeric score",params:{scoreNumber:e.poosRemoved},children:"score: [scoreNumber]"})]})]},`headstone${e.horse.name}`))})]})},A=()=>{var e=(0,k.bp)().logEvent,r=(0,H.Q1)(),t=r.state,a=r.dispatch;return t.currentHorse.isAlive?null:(0,N.jsxs)("div",{className:P.deathButtons,children:[(0,N.jsx)("button",{className:P.horseFriendButton,onClick:()=>{e({eventName:j.J.HorseFriendHatched}),a({type:"hatchNewHorse"})},children:(0,N.jsx)(F.ZP,{comment:"[Tumblrmart] Label on a Horse Friend button that allows player to hatch a new horse",children:"hatch a new one"})}),(0,N.jsx)("button",{className:P.horseFriendButton,onCl})},children:(0,N.jsx)(F.ZP,{comment:"[Tumblrmart] Label on a Horse Friend button that brings player to the cemetery",children:"remember your dead"})})]})},B=t.p+"src/assets/images/horse-friend/heart-40ba85e3.png",E=e=>{var r=e.heart,t=(0,H.Q1)(),a=t.dispatch,n=t.state,i=(0,h.useState)(1),o=s()(i,2),l=o[0],d=o[1];(0,h.useEffe3)},[]),(0,h.useEffect)(()=>{n.tick%10==0&&d(-1*l),a({type:"updateHeart",heart:u()(u()({},r),{},{x:r.x+l*H.lw,y:r.y-H.lw,opacity:r.opacity-H.bW})})},[n.tick]);va})};return(0,N.jsx)("div",{className:P.sprite,style:{width:S.horseFriendHeartSize,height:S.horseFriendHeartSize,left:r.x,top:r.y,opacity:r.opacity},children:(0,N.jsx)("img",{src:B,alt:"",role:"img",width:S.horseFriendHeartSize,height:S.horseFriendHeartSize})})},Z=e=>{var r=e.onHorseClick,t=(0,h.useState)(0),a=s()(t,2),n=a[0],i=a[1],o=(0,h.useState)(0),l=s()(o,2),d=l[0],c=l[1],u=(0,h.useState)(!1),m=s()(u,2),p=m[0],g=m[1],b=(0,h.useState)(!0),v=s()(b,2),f=v[0],x=v[1],y=(0,h.useState)(!1),w=s()(y,2),j=w[0],k=w[1],T=(0,H.Q1)(),C=T.state,F=T.dispatch;(0,h.useEffect)(()=>{var e=M(),r=e.x,t=e.y;F({type:"setHorseX",x:r}),F({type:"setHorseY",y:t})},[]),(0,h.useEffect)(()=>{A(),(C.horseDesiredX||C.horseDesiredY)&&D(),p&&C.currentHorse.isAlive?C.tick%2==0?$():I():C.currentHorse.isAlive?(L(),W()):Z()},[C.tick]);var M=()=>({x:Math.floor(S.horseFriendCanvasWidth/2-S.horseFriendHorseWidth/2),y:C.currentHorse.isAlive?S.horseFriendCanvasHeight-S.horseFriendHorseHeight:S.horseFriendCanvasHeight/2+36}),A=(0,h.useCallback)(()=>{!p&&f&&C.currentHorse.isAlive&&(F({type:"setHorseDesiredX",x:Math.floor(Math.random()*(S.horseFriendCanvasWidth-S.horseFriendHorseWidth))}),x(!1))},[p,f,C.currentHorse,F]),B=()=>c(S.horseFriendHorseHeight+2*S.horseFriendHorsePadding),E=()=>c(S.horseFriendHorsePadding),Z=()=>i(3*S.horseFriendHorseWidth+6*S.horseFriendHorsePadding),L=()=>i(S.horseFriendHorsePadding),$=()=>i(S.horseFriendHorseWidth+3*S.horseFriendHorsePadding),I=()=>i(2*S.horseFriendHorseWidth+5*S.horseFriendHorsePadding),D=(0,h.useCallback)(()=>{C.horseDesiredX&&(C.horseDesiredX>C.horseX?(g(!0),C.currentHorse.isAlive&&(B(),F({type:"setHorseFacingLeft",facingLeft:!1})),F({type:"setHorseX",x:Math.floor(C.horseX+1)})):C.horseDesiredX<C.horseX?(g(!0),C.currentHorse.isAlive&&(E(),F({type:"setHorseFacingLeft",facingLeft:!0})),F({type:"setHorseX",x:Math.floor(C.horseX-1)})):(g(!1),F({type:"setHorseDesiredX",x:null}))),C.horseDesiredY&&(C.horseDesiredY>C.horseY?F({type:"setHorseY",y:C.horseY+1}):C.horseDesiredY<C.horseY?F({type:"setHorseY",y:C.horseY-1}):F({type:"setHorseDesiredY",y:null}))},[F,C.currentHorse,C.horseDesiredX,C.horseX,C.horseY,C.horseDesiredY]),W=(0,h.useCallback)(()=>{!j&&C.currentHorse.isAlive&&(k(!0),setTimeout(()=>{C.currentHorse.isAlive&&(x(!0),k(!1))},(Math.floor(3*Math.random())+1)*1e3))},[C.currentHorse,j]);return(0,N.jsx)("button",{className:P.sprite,style:{height:S.horseFriendHorseHeight,width:S.horseFriendHorseWidth,top:C.horseY,left:C.horseX},onClick:()=>{C.currentHorse.isAlive&&r({x:C.horseX+16,y:C.horseY,opacity:1,id:`heart${C.tick}${C.currentHorse.age}`})},children:(0,N.jsx)("div",{className:P.horse,style:{backgroundPositionX:-n,backgroundPositionY:-d}})})},L=()=>{var e=(0,k.bp)(),r=e._c,t=e._cn,a=(0,H.Q1)().state,n=a.currentHorse,i=n.name,o=n.age,l=n.isAlive,d=(0,h.useState)(0),c=s()(d,2),u=c[0],m=c[1];(0,h.useEffect)(()=>{m(a.horseComfortLevel/100*(S.horseFriendCanvasWidth/2-10))},[a.tick]);var p=l?"":r("[TumblrMart horse friend widget]: text indicating that the horse is dead. RIP is an acronym for rest in peace","(RIP)"),g=t("[TumblrMart horse friend widget]: text indicating the age of a horse in days","%1$s day old","%1$s days old",o);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("div",{className:P.infoBox,children:(0,N.jsxs)("p",{children:[i,(0,N.jsx)("br",{}),`${g} ${p}`]})}),(0,N.jsxs)("div",{className:P.stats,children:[(0,N.jsx)("div",{className:P.comfortBarContainer,children:(0,N.jsx)("div",{className:P.comfortBar,style:{width:u}})}),(0,N.jsx)("div",{className:P.poosRemoved,children:a.poosRemoved})]})]})},$=t.p+"src/assets/images/horse-friend/poo-4d6e296d.png",I=e=>{var r=e.poo,t=(0,k.bp)()._c,a=(0,H.Q1)(),s=a.state,n=a.dispatch,i=(0,h.useCallback)(()=>{s.currentHorse.isAlive&&(n({type:"setPoos",poos:s.poos.fil.id)}),n({type:"setPoosRemoved",poosRemoved:s.poosRemoved+1}))},[n,s.poos,s.currentHorse.isAlive,s.poosRemoved,r.id]);return(0,N.jsx)(y.Z,{className:P.sprite,style:{height:S.horseFriendPooHeight,width:S.horseFriendPooWidth,top:r.y,left:r.x},onClick:i,label:t("[TumblrMart horse friend widget]: Label for a button that will clean up a horse's poo, and increase the player's score","Click to remove poo"),children:(0,N.jsx)("img",{src:$,style:{top:0,left:0},alt:"",width:S.horseFriendPooWidth,height:S.horseFriendPooHeight})})},D=()=>{var e=(0,H.Q1)(),r=e.state,t=e.dispatch,a=(0,h.useRef)();(0,h.useEffect)(()=>(a.current=setInterval(()=>{var e=r.tick,a=r.currentHorse,s=r.poos,n=r.horseComfortLevel,i=r.cemetery,o=r.horseFacingLeft,l=r.horseX,d=r.horseDesiredX,c=r.horseDesiredY,h=r.poosRemoved,m=r.hearts,p=e+1,g=a,b=n,v=i,f=s,x=d,y=c;if(p>=H.n&&(p=0,g=a.isAlive?u()(u()({},g),{},{age:g.age+1}):g),a.isAlive){var w=.1*H.E$;0===s.length?b=n+1.5*w+m.length/25:0===m.length&&(b=n-s.length*w),(b=(0,H.uZ)(b,0,100))<=0&&(v=[{horse:g=u()(u()({},g),{},{isAlive:!1}),poosRemoved:h}].concat(i),x=Math.floor(S.horseFriendCanvasWidth/2-S.horseFriendHorseWidth/2),y=S.horseFriendCanvasHeight/2+36)}if(g.isAlive&&(p+1)%300==0&&s.length<3&&.8>Math.random()&&0===m.length){var j=o?l+S.horseFriendHorseWidth:l-S.horseFriendPooWidth,k={id:`poo${e}${g.age}`,x:(0,H.uZ)(j,0,S.horseFriendCanvasWidth-S.horseFriendPooWidth),y:S.horseFriendCanvasHeight-S.horseFriendPooHeight,opacity:1};f=s.concat([k])}t({type:"tick",gameState:{tick:p,cemetery:v,currentHorse:g,horseComfortLevel:b,poos:f,horseDesiredX:x,horseDesiredY:y}})},H.OX),()=>clearInterval(a.current)),[r]);var s=(0,h.useCallback)(e=>{r.hearts.length<H.U5&&t({type:"addHeart",heart:e})},[r.hearts]);return(0,N.jsxs)("div",{className:P.horseFriendGame,children:[r.hearts.map(e=>(0,N.jsx)(E,{heart:e},e.id)),r.shouldShowCemetery?(0,N.jsx)(M,{onHeadstoneClick:s}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(L,{}),(0,N.jsx)(A,{}),(0,N.jsx)(Z,{onHorseClick:s}),r.poos.id))]})]})};var W=t(78994);let z=t.p+"src/assets/images/horse-friend/headstone@2x-41d6c585.png",R=t.p+"src/assets/images/horse-friend/horse-for-screen-shot@4x-9b8d777b.png";var _=t(22790),O=t(6709),Y=t(90127),G=t(5700),J=t(85795),U=t(93613),Q=t(63583),V=t.n(Q);let q=()=>{var e=(0,U.V)().toggleToast,r=(0,k.bp)(),t=r._c,a=r._cn,n=r.apiFetch,i=r.logEvent,o=(0,W.s0)(),l=(0,H.Q1)(),d=l.state,c=l.dispatch,u=(0,h.useState)(!1),m=s()(u,2),p=m[0],g=m[1],b=(0,h.useRef)(null),v=(0,h.useRef)(null),f=(0,h.useRef)(null),x=(0,h.useRef)(null),w=(0,h.useRef)(null),T=()=>{b.current&&b.current.toBlob(r=>{var s=new File([r||""],"horsefriend.png",{type:"image/png"});(0,J.ZP)(n).preUploadImageForNpf(s).fetch().then(e=>{var r=e.response,s=a("[TumblrMart horse friend widget]: Title on a pre-filled post that details progress in Horse Friend game.","My beloved horse friend","My beloved horse friends",d.shouldShowCemetery?d.cemetery.length:1),n={content:[{type:G.kH.Title,text:s},{type:G.kH.Image,media:[r]},{type:G.kH.Text,text:t("[TumblrMart horse friend widget]: Text proceeds a number of how many horses were hatched while playing Horse Friend","Total horses hatched: %1$s",[(0,H.io)(d).toString()])},{type:G.kH.Text,text:t("[TumblrMart horse friend widget]: Text proceeds a number of how much poop was collected while playing Horse Friend","Total manure harvested: %1$s",[(0,H.Pi)(d).toString()])},...(0,O.E)([t("[TumblrMart horse friend widget]: Text on a link that will open tumblrmart. Gidy up is a command to a horse to make them go faster.","Horse Friend is a gift only available in TumblrMart 🐴"),t("[TumblrMart horse friend widget]: Text on a link that will open tumblrmart. Gidy up is a command to a horse to make them go faster.","Maybe your mutuals could use a Horse Friend right now ❤️ 🐴"),t("[TumblrMart horse friend widget]: Text on a link that will open tumblrmart. Gidy up is a command to a horse to make them go faster.","Find Horse Friend, a manure collecting game, in TumblrMart 🐴💩")])],isPrefilledPost:!0,disableBlogSelection:!1,tags:["horse friend"]};o((0,Y.TL)({postType:G.hQ.Text}),{state:{newPost:n}}),c({type:"setIsMinimized",isMinimized:!0})}).catch(()=>{e(t("[TumblrMart horse friend widget]: Error message when trying to share a Horse Friend post","Something went wrong. Try again"),"error")})})},C=e=>{if(e&&b.current){var r=Math.max(S.horseFriendCanvasHeight,d.cemetery.length*(S.horseFriendHeadstoneSize+S.horseFriendHeadstoneTopMargin)+S.horseFriendHeaderHeight);b.current.setAttribute("height",(r*H.sB).toString()),e.scale(H.sB,H.sB),e.fillStyle=V().gray25,e.fillRect(0,0,S.horseFriendCanvasWidth,r),e.fillStyle=V().black,e.font="12px monospace",e.textBaseline="top",e.textAlign="center",e.fillText(t("[TumblrMart horse friend widget]: text on a button that will take a user to their cemetary to remember their dead horses","remember your dead"),S.horseFriendCanvasWidth/2,10),e.fillRect(S.horseFriendPadding,S.horseFriendHeaderHeight,S.horseFriendCanvasWidth-2*S.horseFriendPadding,2),e.textAlign="start",d.cemetery.forEach((r,s)=>{if(s<20){var n=s*(S.horseFriendHeadstoneSize+4)+S.horseFriendHeaderHeight+4,i=S.horseFriendHeadstoneSize+2*S.horseFriendPadding,o=a("[TumblrMart horse friend widget]: text indicating how many days a horse lived","lived for %1$s day","lived for %1$s days",r.horse.age),l=t("[TumblrMart horse friend widget]: text preceeds a numerical score acheived while playing Horse Friend","Score: %1$s",[r.poosRemoved.toString()]);x.current&&e.drawImage(x.current,S.horseFriendPadding,n,S.horseFriendHeadstoneSize,S.horseFriendHeadstoneSize),e.fillText(r.horse.name,i,n+2),e.fillText(`${o}, ${l}`,i,n+18)}}),T()}},F=e=>{if(e&&v.current){var r=d.currentHorse.isAlive?"":t("[TumblrMart horse friend widget]: text indicating that the horse is dead. RIP is an acronym for rest in peace","(RIP)"),s=a("[TumblrMart horse friend widget]: text indicating the age of a horse in days","%1$s day old","%1$s days old",d.currentHorse.age),n=S.horseFriendInfoBoxHeight+4*S.horseFriendPadding;e.fillStyle=V().gray25,e.strokeStyle=V().black,e.scale(H.sB,H.sB),e.fillRect(0,0,S.horseFriendCanvasWidth,S.horseFriendCanvasHeight),e.font="12px monospace",e.textBaseline="top",d.poos.forEach(r=>{f.current&&e.drawImage(f.current,r.x,r.y,S.horseFriendPooWidth,S.horseFriendPooHeight)}),d.hearts.forEach(r=>{e.globalAlpha=r.opacity,w.current&&e.drawImage(w.current,r.x,r.y,S.horseFriendHeartSize,S.horseFriendHeartSize)}),e.globalAlpha=1,d.hearts,e.strokeRect(S.horseFriendPadding,S.horseFriendPadding,S.horseFriendCanvasWidth-2*S.horseFriendPadding,S.horseFriendInfoBoxHeight+2*S.horseFriendPadding),e.fillStyle=V().black,e.textAlign="start",e.fillText(d.currentHorse.name,2*S.horseFriendPadding,2*S.horseFriendPadding),e.fillText(`${s} ${r}`,2*S.horseFriendPadding,28),e.textAlign="end",e.fillText(d.poosRemoved.toString(),S.horseFriendCanvasWidth-S.horseFriendPadding,n),e.strokeRect(S.horseFriendPadding,n,S.horseFriendCanvasWidth/2-S.horseFriendPadding,2*S.horseFriendPadding),e.fillRect(S.horseFriendPadding+2,n+2,d.horseComfortLevel/100*(S.horseFriendCanvasWidth/2-10),2*S.horseFriendPadding-4),d.currentHorse.isAlive||(e.textAlign="center",e.fillText(t("[TumblrMart horse friend widget]: text on a button that will take a user to their cemetary to remember their dead horses","remember your dead"),S.horseFriendCanvasWidth/2,n+(d.horseY-n+12)/2-S.horseFriendPadding)),e.drawImage(v.current,d.currentHorse.isAlive?0:4*S.horseFriendHorseWidth,d.horseFacingLeft?0:4*S.horseFriendHorseHeight+4,4*S.horseFriendHorseWidth,4*S.horseFriendHorseHeight,d.horseX,d.horseY,S.horseFriendHorseWidth,S.horseFriendHorseHeight),T()}},M=(0,h.useCallback)(()=>{if(!p&&b.current){i({eventName:j.J.HorseFriendScoreboardShare}),g(!0);var e=b.current.getContext("2d");d.shouldShowCemetery?C(e):F(e)}},[d]);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(y.Z,{className:P.shareButton,onClick:M,label:t("[TumblrMart horse friend widget] Label on a button that create a pre-filled post detailing their progress in the Horse Friend game","Share your Horse Friend progress"),children:(0,N.jsx)(_.Z,{})}),(0,N.jsxs)("div",{className:P.hide,children:[(0,N.jsx)("canvas",{ref:b,className:P.hide,width:S.horseFriendCanvasWidth*H.sB,height:S.horseFriendCanvasHeight*H.sB}),(0,N.jsx)("img",{src:R,ref:v,crossOrigin:"anonymous",alt:""}),(0,N.jsx)("img",{src:$,ref:f,crossOrigin:"anonymous",alt:""}),(0,N.jsx)("img",{src:z,ref:x,crossOrigin:"anonymous",alt:""}),(0,N.jsx)("img",{src:B,ref:w,crossOrigin:"anonymous",alt:""})]})]})},X=()=>{var e,r=(0,k.bp)(),t=r._c,a=r.logEvent,n=(0,h.useReducer)(H._C,H.qP),o=s()(n,2),l=o[0],d=o[1];(0,h.useEffect)(()=>{var e=T.E.getItem(H.sF);e&&d({type:"loadStateFromStorage",gameState:JSON.parse(e)})},[]),(0,h.useEffect)(()=>{T.E.setItem(H.sF,JSON.stringify(l))},[l]);var c=()=>{d({type:"setIsMinimized",isMinimized:!l.isMinimized})};return(0,N.jsxs)("div",{className:P.horseFriend,children:[(0,N.jsx)(y.Z,{className:i()(P.buttonIcon,{[P.active]:l.isMinimized}),onClick:()=>{a({eventName:j.J.HorseFriendWindowOpened}),c()},label:t("[Tumblrmart] Label on a button that will open Horse Friend game","Play Horse Friend"),children:(0,N.jsx)("img",{src:x,width:"22px",alt:""})}),!l.isMinimized&&(0,f.createPortal)((0,N.jsx)("div",{className:P.horseFriendContainer,children:(0,N.jsx)(H.kG.Provider,{value:{state:l,dispatch:d},children:(0,N.jsxs)("div",{className:P.horseFriendExpanded,children:[(0,N.jsxs)("div",{className:P.controlButtons,children:[(0,N.jsx)(y.Z,{className:P.minimizeButton,onClick:c,label:t("[Tumblrmart] Label on a button that will minimize Horse Friend game","Close Horse Friend"),children:(0,N.jsx)(w.Z,{})}),(0,N.jsx)(q,{})]}),(0,N.jsx)(D,{})]})})}),null===(e=document)||void 0===e?void 0:e.body)]})};var K=t(17276),ee=t.n(K),er=t(77865),et=t(46244),ea=t(32415),es=()=>{var e=(0,k.bp)(),r=e._c,t=e.apiFetch,a=(0,U.V)().toggleToast,s=(0,er.NL)();return(0,et.D)({mutationFn:e=>ee()().async(function(r){for(;;)switch(r.prev=r.next){case 0:if(!("opened"!==e.status)){r.next=2;break}return r.abrupt("return");case 2:return r.abrupt("return",t("/v2/tumblrmart/orders/activate",{method:"POST",body:{uuid:e.uuid}}));case 3:case"end":return r.stop()}},null,null,null,Promise),onMutate:e=>{var r,t;return ee()().async(function(a){for(;;)switch(a.prev=a.next){case 0:if(!("opened"!==e.status)){a.next=2;break}return a.abrupt("return");case 2:return r=(0,ea.ZV)(!0),a.next=5,ee()().awrap(s.cancelQueries({queryKey:r}));case 5:return t=s.getQueryData(r),s.setQueryData(r,en(u()(u()({},e),{},{status:"active"}))),a.abrupt("return",t);case 8:case"end":return a.stop()}},null,null,null,Promise)},onError:(e,t,n)=>{n&&s.setQueryData((0,ea.ZV)(!0),n),a(r("error message when activating a tumblrmart gift fails","Oops. There was an error. Please reload the page and try again."),"error")},onSuccess:(e,t)=>{var n;if(e){switch(s.setQueryData((0,ea.ZV)(!0),en(e.response)),t.productSlug){case"tumblrmart-crabs-gift-day":n=r("[TumblrMart] Message that appears when a TumblrMart gift has been used for the first time","🦀 Your 24 hours of crabs has begun! 🦀");break;case"tumblrmart-horse-friend-month":n=r("[TumblrMart] Message that appears when a TumblrMart gift has been used for the first time","🐴 Your 30 days of horse friend has begun! 🐴");break;case"tumblrmart-horse-friend-day":n=r("[TumblrMart] Message that appears when a TumblrMart gift has been used for the first time","🐴 Your 24 hours of horse friend has begun! 🐴");break;default:n=r("[TumblrMart] Message that appears when a TumblrMart gift has been used for the first time","✨ Your TumblrMart order is activated! ✨")}a(n,"success")}},onSettled:()=>{s.invalidateQueries({queryKey:(0,ea.ZV)(!0)})}})},en=e=>r=>{if(r){if(!r.isLoggedIn)return r;var t=r.user.blogs.map(r=>r.tumblrmartOrders?u()(u()({},r),{}mblrmartOrders.map(r=>r.uuid!==e.uuid?r:e)}):r);return u()(u()({},r),{},{user:u()(u()({},r.user),{},{blogs:t})})}};let ei=e=>{var r=e.className,t=e.isMobile,a=e.order,n=e.type,i=(0,k.bp)()._c,o=es().mutate,l=(0,h.useState)(!1),d=s()(l,2),c=d[0],f=d[1];(0,)(()=>{var t)},5e3);rett]);var x=()=>{"active"!==a.status&&o(a)},y="crabs"===n?i("[TumblrMart] Tooltip text for when a user first sees the dashboard crab widget","Summon your crabs 🦀 Clack!"):i("[TumblrMart] Tooltip text for when a user first sees the horse friend widget","Play Horse Friend 🐴");return(0,N.jsxs)("div",{className:r,role:"link",onClickCapture:x,onKeyDown:e=>{(e.key===p.SV.Enter||e.nativeEvent.isComposing)&&x()},tabIndex:-1,children:[(null==a?void 0:a.gameAssets)&&(0,N.jsx)(N.Fragment,{children:Object.entries(a.gameAssets).map(e=>{var r=s()(e,2),t=r[0],a=r[1];return(0,N.jsx)(m.rU,{as:"image",href:a,imageSrcSet:`${a}, ${(0,b.LJ)(a)} 2x`,rel:"preload"},t)})}),(0,N.jsx)(g.Z,{isOpen:"opened"===a.status&&!c,content:y,children:(0,N.jsxs)(N.Fragment,{children:["crabs"===n&&(0,N.jsx)(v.ZP,u()({},a)),"horseFriend"===n&&(0,N.jsx)(X,{})]})})]})},eo={container:"aVu3s",vertical:"cQ0bC",widget:"_o6uV",isMobile:"Pfc8N"};var el={horseFriend:["tumblrmart-horse-friend-gift-day","tumblrmart-horse-friend-month"],crabs:["tumblrmart-crabs-gift-day"]};let ed=e=>{var r=e.className,t=e.vertical,a=(0,l.v$)().isMobile,n=(0,d.g)();if(!(null!=n&&n.length))return null;var c=n.find(e=>"completed"===e.status);if(c)return(0,N.jsx)(o.do,{uuid:c.uuid,type:c.productSlug});var u=n.filter(e=>{var r=e.status;return"active"===r||"opened"===r});return u.length?(0,N.jsx)("div",{className:i()(eo.container,r,{[eo.isMobile]:a,[eo.vertical]:t}),children:Object.entries(el).mar(e=>{var r=e.productSlug;return i.includes(r)});l;var l=null!==(r=o.find(e=>"active"===e.status))&&void 0!==r?r:o[0];return(0,N.jsx)(ei,{className:eo.widget,isMobile:a,order:l,type:n},n)})}):null}},30646:(e,r,t)=>{t.d(r,{Nz:()=>C,do:()=>U,Gl:()=>eg});var a=t(77865),s=t(95004),n=t(78994),i=t(6135),o=t(6233),l=t(18488),d=t(73465),c=t(17276),u=t.n(c),h=t(33590),m=t(91253),p=t(39377),g=t(78667),b=t(94833),v=b.z.object({productGroup:b.z.string(),imageUrls:b.z.object({avatar:p.IA.optional(),banner:p.IA}),title:b.z.string(),description:b.z.string(),button:b.z.object({label:b.z.string(),url:b.z.string()})}),f=(0,m.i)(v),x=(e,r)=>["unseen-badges",e,r],y=(e,r)=>{var t=(0,g.bp)().apiFetchWithSchema;return(0,h.a)({queryKey:x(e,r),queryFn:()=>{var a;return u()().async(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,u()().awrap(t("/v2/tumblrmart/earned_badges/modal",f,{method:"GET",queryParams:{tumblelog:e,product_group:r}}));case 2:return a=s.sent,s.abrupt("return",a.response);case 4:case"end":return s.stop()}},null,null,null,Promise)}})},w=t(33608),j=t(43523),k=t(93613);let T={wrapper:"tmwZ9",banner:"_7LoRz",bannerImage:"PSbZi",modalWrapper:"BMAgx",header:"GyLma",body:"x2z7r",actions:"E_rFJ",button:"SRvcI",loader:"DFvMP"};var S=t(2629);let C=e=>{var r,t,c=e.blogId,u=e.onClose,h=e.productGroup,m=(0,g.bp)(),p=m._c,b=m.isLoggedIn,v=m.logEvent,f=(0,n.s0)(),x=(0,k.V)().toggleToast,C=(0,a.NL)(),F=y(c,h),H=F.data,P=F.isError,N=F.isPending;if((0,s.useEffect)(()=>{v({eventName:j.J.BadgeEarnedClick,eventDetails:{product:h}})},[v,h]),(0,s.useEffect)(()=>{P&&x(p("[Badge Management] Error message for unseen badges","Something went wrong. Please try again."),"error")},[p,P,x]),P)return null;var M=()=>C.invalidateQueries({queryKey:(0,w.yQ)(b)});return(0,S.jsx)(o.Z,{headerIcon:N?void 0:(0,S.jsx)("span",{className:T.banner,children:(0,d.C6)(null==H||null===(r=H.imageUrls)||void 0===r?void 0:r.banner,p("[Badge Management] Banner image for unseen badge modal banner.","Badge banner image."),T.bannerImage)}),modalWrapperClass:ssname:T.wrapper,onClose:()=>{M(),null==u||u()},children:N?(0,S.jsx)("span",{className:T.loader,children:(0,S.jsx)(i.Z,{centerOrientation:"horizontalAndVertical"})}):(0,S.jsxs)("div",{className:T.modalWrapper,children:[(0,S.jsx)("div",{className:T.header,children:(0,S.jsx)("h1",{className:T.title,children:null==H?void 0:H.title})}),(0,S.jsx)("div",{className:T.body,children:(0,S.jsx)("p",{className:T.description,children:null==H?void 0:H.description})}),(0,S.jsx)("div",{className:T.actions,children:(0,S.jsx)(l.Z,{className:T.button,label:p("[Badge Management] Button label to trigger seeing an unseen badge.","Manage Badge"),theme:"border",size:"small",isRounded:!0,onClick:()=>{!N&&H&&(v({eventName:j.J.BadgeEarnedManageClick,eventDetails:{product:h}},{sendPayloadImmediately:!0}),M(),(0,d.XW)(H.button.url,f))},children:null==H||null===(t=H.button)||void 0===t?void 0:t.label})})]})})};var F=t(54138),H=t.n(F),P=t(46244),N=t(32415),M=()=>{var e=(0,g.bp)(),r=e._c,t=e.apiFetch,s=(0,k.V)().toggleToast,n=(0,a.NL)();return(0,P.D)({mutationFn:e=>{var r,a;return u()().async(function(s){for(;;)switch(s.prev=s.next){case 0:return r=e.uuid,a=e.status,s.abrupt("return",t(`/v2/tumblrmart/orders/${r}`,{method:"PATCH",body:{status:a}}));case 2:case"end":return s.stop()}},null,null,null,Promise)},onMutate:e=>{var r,t;return u()().async(function(a){for(;;)switch(a.prev=a.next){case 0:return r=(0,N.ZV)(!0),a.next=3,u()().awrap(n.cancelQueries({queryKey:r}));case 3:return t=n.getQueryData(r),n.setQueryData(r,A(e)),a.abrupt("return",t);case 6:case"end":return a.stop()}},null,null,null,Promise)},onError:(e,t,a)=>{a&&n.setQueryData((0,N.ZV)(!0),a),s(r("error message when activating a tumblrmart gift fails","Oops. There was an error. Please reload the page and try again."),"error")},onSuccess:e=>{e&&(n.setQueryData((0,N.ZV)(!0),A(e.response)),"active"===e.response.status&&s("tumblrmart-crabs-gift-day"===e.response.productSlug?r("[TumblrMart] Message that appears when a TumblrMart gift has been used for the first time","🦀 Your 24 hours of crabs has begun! 🦀"):r("[TumblrMart] Message that appears when a TumblrMart gift has been used for the first time","🐴 Your 24 hours of horse friend has begun! 🐴"),"success"))},onSettled:()=>{n.invalidateQueries({queryKey:(0,N.ZV)(!0)})}})},A=e=>r=>{if(r){if(!r.isLoggedIn)return r;var t=r.user.blogs.map(r=>r.tumblrmartOrders?H()(H()({},r),{},{tumblrmartOrders:r.tumblrmartOrders.map(r=>r.uuid!==e.uuid?r:H()(H()({},r),e))}):r);return H()(H()({},r),{},{user:H()(H()({},r.user),{},{blogs:t})})}},B=t(33970),E=t.n(B),Z=t(54382),L=t(61812),$=t(90127),I=t(5700),D=t(399),W=t(49116),z=t(63583);let R={text:"f5gD9"};var _=()=>W.E.removeItem(L.qL);let O=()=>{var e=(0,n.s0)(),r=(0,g.bp)(),t=r._c,a=r._cn,i=r.logEvent,o=(0,s.useState)(null),d=E()(o,2),c=d[0],u=d[1];(0,s.useEffect)(()=>{var e=W.E.getItem(L.qL);e&&u(JSON.parse(e))},[]),(0,s.useEffect)(()=>(window.addEventListener("beforeunload",_),()=>{_(),window.removeEventListener("beforeunload",_)}),[]);var h=c?a("[TumblrMart] Message that appears when a crab gift expires and crab counts are stored in local storage.","Your 24 hours of crabs is over. You summoned %1$s 🦀, captured %2$s 💰, befriended %3$s 🌼, and %4$s fell in love with you 💜 on the Tumblr web app. Share your time with crabs and we'll get this place cleaned up.","Your 24 hours of crabs is over. You summoned %1$s 🦀, captured %2$s 💰, befriended %3$s 🌼, and %4$s fell in love with you 💜 on the Tumblr web app. Share your time with crabs and we'll get this place cleaned up.",parseInt(c.summoned,10),[c.captured,c.befriended,c.beloved]):(0,S.jsx)(Z.ZP,{comment:"[TumblrMart] Message that appears when a crab gift expires and crab counts are not stored in local storage.",children:"Your 24 hours of crabs is over. Write a Tumblr post to say farewell to the glorious crustaceans, and we'll get to work cleaning this place up."});return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("p",{className:R.text,children:h}),(0,S.jsx)(l.Z,{textColor:z.paletteWhite,size:"entireWidth",onClick:()=>{i({eventName:j.J.CrabShareFarewell});var r=(0,D.ed)(t),a=c?{content:[{type:I.kH.Text,subtype:I.lr.Heading1,text:t("[TumblrMart] Pre-filled title of a Tumblr post when a user's crab gift has expired","Farewell Sweet Crabs 👋 🦀")},{type:I.kH.Text,text:t("[TumblrMart] Pre-filled text of a Tumblr post when a user's crab gift has expired and crab counts can be read from local storage.","I summoned %1$s 🦀, captured %2$s 💰, befriended %3$s 🌼, and %4$s fell in love with me 💜. I will miss you my sweet crabs.",[c.summoned,c.captured,c.befriended,c.beloved])}],isPrefilledPost:!0,tags:["time for crab"]}:{content:[{type:I.kH.Text,subtype:I.lr.Heading1,text:t("[TumblrMart] Pre-filled title of a Tumblr post when a user's crab gift has expired","Farewell Sweet Crabs 👋 🦀")},{type:I.kH.Text,text:t("[TumblrMart] Pre-filled text of a Tumblr post when a user's crab gift has expired and crab counts cannot be read from local storage.","When I remember my crab friends I'll think of:")},{type:I.kH.Text,text:r,formatting:[{type:I.TV.Italic,start:0,end:r.length-1}]}],isPrefilledPost:!0,disableBlogSelection:!1,tags:["time for crab"]};e((0,$.TL)({postType:I.hQ.Text},{redirect_to:"/dashboard"}),{replace:!0,state:{newPost:a}})},children:(0,S.jsx)(Z.ZP,{comment:"[TumblrMart] Text on  a Tumblr post sharing expired message.",children:"Share"})})]})};var Y=t(23779),G=()=>W.E.removeItem(Y.sF);let J=()=>{var e=(0,n.s0)(),r=(0,g.bp)(),t=r._c,a=r.logEvent,i=(0,s.useState)(null),o=E()(i,2),d=o[0],c=o[1];return(0,s.useEffect)(()=>{var e=W.E.getItem(Y.sF);e&&c((0,Y.Cz)(JSON.parse(e)))},[]),(0,s.useEffect)(()=>(window.addEventListener("beforeunload",G),()=>{G(),window.removeEventListener("beforeunload",G)}),[]),(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("p",{className:R.text,children:(0,S.jsx)(Z.ZP,{comment:"[TumblrMart] Text in a pop-up window shown when Horse Friend game expires.",children:"We at TumblrMart hope you enjoyed playing Horse Friend. Before you go, write a farewell post and we'll clean up any remaining poo."})}),(0,S.jsx)(l.Z,{textColor:z.paletteWhite,size:"entireWidth",onClick:()=>{a({eventName:j.J.HorseFriendShareFarewell});var r=(0,D.gz)(t),s={content:[{type:I.kH.Text,subtype:I.lr.Heading1,text:t("[TumblrMart] Pre-filled title of a Tumblr post when Horse Friend game has expired","Farewell Horse Friend 👋 🐴")},{type:I.kH.Text,text:t("[TumblrMart] Text preceeding a memory of playing Horse Friend game","When I remember my beloved horse, I will think of:")},{type:I.kH.Text,text:r,formatting:[{type:I.TV.Italic,start:0,end:r.length-1}]}],isPrefilledPost:!0,disableBlogSelection:!1,tags:["horse friend"]};d&&(s.content=s.content.concat([{type:I.kH.Text,text:t("[TumblrMart horse friend widget]: Text proceeds a number of how many horses were hatched while playing Horse Friend","Total horses hatched: %1$s",[(0,Y.io)(d).toString()])},{type:I.kH.Text,text:t("[TumblrMart horse friend widget]: Text proceeds a number of how much poop was collected while playing Horse Friend","Total manure harvested: %1$s",[(0,Y.Pi)(d).toString()])}])),e((0,$.TL)({postType:I.hQ.Text},{redirect_to:"/dashboard"}),{replace:!0,state:{newPost:s}})},children:(0,S.jsx)(Z.ZP,{comment:"[TumblrMart] Text on a button that will open the new post form with a pre-filled post that shares stats from playing Horse Friend",children:"Share"})})]})},U=e=>{var r=e.type,t=e.uuid,a=(0,g.bp)()._c,s=M().mutate;return(0,S.jsx)(o.Z,{compact:!0,onClose:()=>u()().async(function(e){for(;;)switch(e.prev=e.next){case 0:s({uuid:t,status:"expired"});case 1:case"end":return e.stop()}},null,null,null,Promise),title:(()=>{switch(r){case"tumblrmart-horse-friend-gift-day":return a("[TumblrMart] Title shown when the ability to play Horse Friend has expired","Time to say farewell to Horse Friend");case"tumblrmart-crabs-gift-day":return a("[TumblrMart] Title shown when the ability to use the crab widget has expired","Oh no! Crab time is up");default:return a("[TumblrMart] Title shown when a tumblrmart item is expired","Oh no! Your TumblrMart item has expired.")}})(),children:(()=>{switch(r){case"tumblrmart-crabs-gift-day":return(0,S.jsx)(O,{});case"tumblrmart-horse-friend-gift-day":return(0,S.jsx)(J,{});default:return(0,S.jsx)("p",{children:a("[TumblrMart] Default text shown when a tumblrmart item has expired.","Please visit Tumblrmart again real soon")})}})()})};var Q=t(5754),V=t.n(Q),q=t(55673),X=t(45222),K=t(34728),ee=t(20567),er=t(68757),et=t(37236),ea=t(67023),es=t(47211),en=t(53),ei=t(83932),eo=t(68144),el=t(53714),ed=t(51364),ec=t(59889),eu=t(43684);let eh={modalWrapper:"xv_s5",modalBody:"HbNGL",splashImage:"AmghW",avatarWrapperOuter:"lbarB",avatarWrapperInner:"TSfr_",avatar:"FhsWI",header:"AE6WV",giftTitle:"bpnO8",giftSubtitle:"_64hR",giftInfo:"rb92Y",info:"KVt3w",category:"K1c5K",actionDetails:"vzPt5",actionButtons:"WtbOv",actionButton:"ZQhIf",settingsWrapper:"fJ9Xt",settingsButton:"HQQhj",settingsInnerLabel:"PqBqd",settingsLabelText:"EQeW6"};function em(){var e=(0,ei.rV)(),r=e.refetch,t=e.settings,a=(0,s.useState)(null),n=E()(a,2),o=n[0],d=n[1],c=(0,s.useState)(!1),u=E()(c,2),h=u[0],m=u[1];(0,s.useEffect)(()=>l!=t&&t.showAdsAnyway?"showAdsAnyway":null!=t&&t.showBlazeAds?"showBlazeAds":"showNone")},[t]);var p=()=>m(e=>!e);return(0,S.jsx)(S.Fragment,{children:(0,S.jsx)(el.ZP,{width:320,height:"auto",position:eu.I2.BottomEnd,component:(0,S.jsx)("disWrapper,children:(0,S.jsx)(ed.Z,{name:"visibilityOptionModal",disableRefresh:!0,onUpdate:()=>{m(!1),d(null),r()}})}),isOpen:h,toggle:p,usePortals:!0,children:(0,S.jsx)(l.Z,{wrapperClassName:eh.settingsButton,isRounded:!0,size:"small",backgroundColor:z.paletteBlack,textColor:z.paletteWhite,borderColor:z.paletteWhite,onClick:p,children:(0,S.jsx)("div",{className:eh.settingsInnerLabel,children:o?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("span",{className:eh.settingsLabelText,children:ec.Z[ec.Z.findIndex(e=>e.value===o)].children}),h?(0,S.jsx)(eo.nT,{}):(0,S.jsx)(eo.Cq,{})]}):(0,S.jsx)(i.Z,{small:!0,centerOrientation:"horizontal"})})})})})}var ep=e=>{var r=e.gift,t=e.onClose,a=(0,g.bp)(),i=a._c,c=a._t,u=a._getLocaleDateString,h=a.logEvent,m=(0,en.h)().openConversationWindow,p=(0,n.s0)(),b=(0,k.V)().toggleToast,v=(0,q.lr)(),f=E()(v,2),x=f[0],y=f[1];(0,s.useEffect)(()=>{x.get("success")&&(b(i("[TumblrMart] Success message after publishing a share post from a received gift","The love has been shared!"),"success"),x.delete("success"),y(x),window.location.reload())},[i,x,y,b]);var w=r.actions,T=r.activatedTimestamp,C=r.askId,F=r.askTumblelog,H=r.askTumblelogName,P=r.availableUntilDate,N=r.displayStatus,M=r.imageUrls.banner,A=r.isAnonymous,B=r.message,L=r.postActionDetails,D=r.preActionDetails,W=r.productGroup,R=r.receivedTimestamp,_=r.senderAvatar,O=r.senderUsername,Y=r.subtitle,G=r.title,J=r.uuid,U=A?void 0:{name:O,avatar:_,url:`https://${O}.tumblr.com`},Q=(e,r)=>{var t=e.key,a=e.url;switch(t){case"share":h({eventName:j.J.TumblrMartReceiveGiftShare,eventDetails:{group:r}}),el();break;case"message":h({eventName:j.J.TumblrMartReceiveGiftReply,eventDetails:{group:r}}),H&&O?otherParticipantName:O}),ei()):el();break;case"close":ei();break;case"redirect":eo(a)}},ei=()=>null==t?void 0:t(),eo=e=>{e&&((0,d.XW)(e,p),ei())},el=()=>{C&&F&&H?p((0,$.s3)({blogName:H,postId:C},{redirect_to:"/dashboard"}),{state:{giftAsk:{askTumblelog:F,redirectUrl:`${(0,$.B9)({page:es.f.Gifts})}?success=true`,uuid:J}}}):p((0,$.TL)({postType:I.hQ.Text},{redirect_to:"/dashboard"}),{state:{newPost:{content:[{type:I.kH.Text,text:i("[TumblrMart] Pre-filled text of a Tumblr post when a user shares they received a gift and asks are disabled for their account.","%1$s gifted me %2$s.",[null!=O?O:c("anonymous"),G])}],isPrefilledPost:!0,disableBlogSelection:!1}}})},ed=(0,S.jsx)("img",{srcSet:`${M}, ${(0,d.LJ)(M)} 2x`,src:M,alt:i("[TumblrMart] Banner image for TumblrMart gift","TumblrMart gift banner"),className:V()(eh.splashImage)}),ec=A?c("anonymous"):O;return(0,S.jsx)(o.Z,{compact:!0,headerIcon:ed,onClose:ei,theme:o.L.Gradient,modalWrapperClass:"tumblrMartReceiveModalWrapper",children:(0,S.jsxs)("div",{className:eh.modalWrapper,children:[(0,S.jsxs)("div",{className:eh.modalHeader,children:[(0,S.jsx)("div",{className:eh.avatarWrapperOuter,children:(0,S.jsx)("div",{className:eh.avatarWrapperInner,children:(0,S.jsx)("div",{className:eh.avatar,children:(0,S.jsx)(X.Z,{imageResponse:_||void 0,dimension:72,avatarShape:et.o.Circle,isAnonymous:A})})})}),(0,S.jsxs)("div",{className:eh.header,children:[(0,S.jsx)("p",{className:eh.sender,children:(0,S.jsx)(Z.ZP,{params:{sender:ec},components:{strong:(0,S.jsx)("strong",{}),span:(0,S.jsx)("span",{}),br:(0,S.jsx)("br",{})},children:"[strong][sender][/strong][br /][span]gifted you:[/span]"})}),(0,S.jsx)("h1",{className:eh.giftTitle,children:G})]}),B&&U&&(0,S.jsx)("div",{className:eh.giftMessage,children:(0,S.jsx)(ee.Z,{blog:U,post:{isTumblrmartGiftAsk:!0},components:[(0,S.jsx)(K.ZP,{block:{text:B,type:I.kH.Text}},0)],isAsking:!0})})]}),(0,S.jsxs)("div",{className:eh.modalBody,children:[!(B&&U)&&Y&&(0,S.jsx)("div",{className:eh.giftSubtitle,children:(0,S.jsx)("p",{dangerouslySetInnerHTML:{__html:Y}})}),(0,S.jsxs)("div",{className:eh.giftInfo,children:[(0,S.jsxs)("div",{className:eh.info,children:[(0,S.jsx)("p",{className:eh.category,children:i("[TumblrMart] category title for when a gift was received","Received")}),(0,S.jsx)("p",{children:u(new Date(1e3*R),ea.C.Notes,!0)})]}),(0,S.jsxs)("div",{className:eh.info,children:[(0,S.jsx)("p",{className:eh.category,children:i("[TumblrMart] category title for the status of a gift","Status")}),(0,S.jsx)(er.Z,{status:N})]}),!!T&&(0,S.jsxs)("div",{className:eh.info,children:[(0,S.jsx)("p",{className:eh.category,children:i("[TumblrMart] category title for when when a gift was activated","Activated")}),(0,S.jsx)("p",{children:u(new Date(1e3*T),ea.C.Notes,!0)})]}),!!P&&"expired"===N&&(0,S.jsxs)("div",{className:eh.info,children:[(0,S.jsx)("p",{className:eh.category,children:i("[TumblrMart] category title for when a gift expired","Expired")}),(0,S.jsx)("p",{children:u(new Date(1e3*P),ea.C.Notes,!0)})]})]}),!!D&&(0,S.jsx)("div",{className:eh.actionDetails,children:(0,S.jsx)("p",{dangerouslySetInnerHTML:{__html:D}})}),(null==w?void 0:w.length)&&(0,S.jsx)("div",{className:eh.actionButtons,children:w.map(e=>"ad_free_settings"===e.key?(0,S.jsx)(em,{},e.key):(0,S.jsx)(l.Z,{className:eh.actionButton,label:e.label,theme:"border",sizackgroundColor:z.paletteWhite,textColor:z.paletteBlack,borderColor:z.paletteBlack,isRounded:!0,onClick:()=>Q(e,W),children:e.label},e.key))}),!!L&&(0,S.jsx)("div",{className:eh.actionDetails,children:(0,S.jsx)("p",{dangerouslySetInnerHTML:{__html:L}})})]})]})})};let eg=e=>(0,S.jsx)(ei.mu,{children:(0,S.jsx)(ep,H()({},e))})},85060:(e,r,t)=>{t.d(r,{Z:()=>d});var a=t(33970),s=t.n(a),n=t(95004),i=t(53714),o=t(43684),l=t(2629);let d=e=>{var r=e.children,t=e.content,a=e.isOpen,d=(0,n.useState)(!1),c=s()(d,2),u=c[0],h=c[1];return(0,n.useEffect)(()=>h(a),[a,h]),(0,l.jsx)(i.ZP,{arrowWrapperClassName:"qZEjf",component:(0,l.jsx)("div",{className:"H9EdA",onClick:()=>h(!1),onKeyDown:()=>h(!1),role:"button",tabIndex:0,children:t}),hasArrow:!0,isChromeless:!0,isOpen:u,position:o.I2.Bottom,strategy:"fixed",toggle:()=>h(!1),usePortals:!0,children:r})}},61812:(e,r,t)=>{t.d(r,{qL:()=>O,ZP:()=>q});var a=t(33970),s=t.n(a),n=t(5754),i=t.n(n),o=t(95004),l=t(79153),d=t(73465),c=t(43523),u=t(78667),h=t(63084),m=t(49116useState)({clientX:0,clientY:0}),r=s()(e,2),t=r[0],a=r[1],n=(0,g.Z)(e=>{a({clientX:e.clientX,clientY:e.clientY})},100);re",n,!1),()=>{document.removeEventListener("mousemove",n),document.removeEventListener("mouseenter",n),n.cancel()}),[]),t};var v=t(93853),f=t(98384);let x={scoreboard:"PMWro",scoreCategory:"M6jBU",expand:"ZtoPL",hidden:"t7fs2"};var y=t(2629);let w=function(e){var r=e.numSummoned,t=e.numF.numBeloved,n=e.numCaptured,l=(0,u.bp)()._c,d=(0,o.useState)(!0),c=s()(d,2),h=c[0],m=c[1],p=()=>m(!0),g=()=>m(!1);return r?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("div",{"aria-label":l("[TumblrMart] Crab widget scoreboard","Scoreboard"),className:i()(x.scoreboard,{[x.hidden]:!h}),onClick:g,onKeyDown:e=>{e.key===v.SV.Enter&&g()},role:"button",tabIndex:0,children:[(0,y.jsxs)("div",{className:x.scoreCategory,children:[(0,y.jsx)("p",{children:l("[TumblrMart crab widget]: Label for displaying total number of summoned crabs","summoned:")}),(0,y.jsx)("span",{className:x.score,children:r})]}),null!==n&&(0,y.jsxs)("div",{className:x.scoreCategory,children:[(0,y.jsx)("p",{children:l("[TumblrMart crab widget]: Label for displaying total number of captured crabs","captured:")}),(0,y.jsx)("span",{className:x.score,children:n})]}),null!==t&&(0,y.jsxs)("div",{className:x.scoreCategory,children:[(0,y.jsx)("p",{children:l("[TumblrMart crab widget]: Label for displaying total number of friend crabs","befriended:")}),(0,y.jsx)("span",{className:x.score,children:t})]}),null!==a&&(0,y.jsxs)("div",{className:x.scoreCategory,children:[(0,y.jsx)("p",{children:l("[TumblrMart crab widget]: Label for displaying total number of crabs that have fallen in love with the user","beloved:")}),(0,y.jsx)("span",{className:x.score,children:a})]})]}),(0,y.jsx)("div",{"aria-label":l("[Tumrd expand icon","Expand"),className:i()(x.expand,{[x.hidden]:h}),onClick:p,onKeyDown:e=>{e.key===v.SV.Enter&&p()},role:"button",tabIndex:0,children:(0,y.jsx)(f.$S,{size:{width:15,height:15}})})]}):null};var j=t(54589),k=t.n(j),T=t(54138),S=t.n(T),C=t(78994),F=t(44009),H=t(22790),P=t(6709),N=t(90127),M=t(5700),A=t(92677);let B={shareButton:"ZFczK"};var E=["className"],Z=["https://assets.tumblr.com/images/tumblrmart/crabs/90s_crabs_ad_v2.mp4","https://assets.tumblr.com/images/tumblrmart/crabs/crab_army_v2.mp4","https://assets.tumblr.com/images/tumblrmart/crabs/crab_tsd_v3.mp4","https://assets.tumblr.com/images/tumblrmart/crabs/space_crab_v2.mp4"];function L(e){return[{type:M.kH.Text,text:(0,p.U)(e)}]}function $(e,r){return Array(r>=0?r:0).fill(e).join(" ")}function I(e){var r=e._c,t=e.showTitle,a=e.numSummoned,s=e.numFriends,n=void 0===s?0:s,i=e.numBeloved,o=void 0===i?0:i,l=e.numCaptured,d=void 0===l?0:l,c=e.befriendedEmoji,u=e.belovedEmoji,h=e.capturedEmoji,m=$(`🦀${void 0===u?"💙":u}`,o),p=$(`🦀${void 0===c?"🌼":c}`,n),g=$("🦀",(void 0===a?0:a)-d-o-n),b=$(void 0===h?"💰":h,d),v=[];(void 0===t||t)&&v.push({type:M.kH.Text,subtype:M.lr.Quirky,text:r("[TumblrMart crab widget]: Share post group picture title. Must be a litle silly and excitable.","group picture!!!")});var f=[];return m&&f.push(m),p&&f.push(p),g&&f.push(g),b&&f.push(b),f.length&&v.push({type:M.kH.Text,subtype:M.lr.Quirky,text:f.join(" ")}),v}function D(e){var r=e.className,t=k()(e,E);return(0,y.jsx)(F.Z,S()(S()({},t),{},{wrapperClassName:i()(B.shareButton,r),children:(0,y.jsx)(H.Z,{})}))}let W=function(e){var r=e.numSummoned,t=e.numFriends,a=e.numBeloved,s=e.numCaptured,n=(0,u.bp)(),i=n._c,o=n._cn,l=n.features.halloweenCrabsSharing,d=n.logEvent,h=(0,C.s0)(),m=i("[TumblrMart crab widget]: Button that shares your crab scores as a new post","Share your crab counts!"),g=l?i("[TumblrMart crab widget]: Share post title during Halloween","🎃🦀 time for halloween crab 🦀🎃"):i("[TumblrMart crab widget]: Share post title","🦀 time for crab 🦀"),b=l?{befriendedEmoji:"🎃",belovedEmoji:"🖤",capturedEmoji:"👻"}:null,v=["time for crab","crab time","crustacean nation","crab","clack",...l?["halloween"]:[]];return(0,y.jsx)(D,{title:m,onClick:()=>{var e,n={content:[{type:M.kH.Text,subtype:M.lr.Heading1,text:g},...l?[]:L([i("[TumblrMart crab widget]: Share post copy. Intro content text.","Due to unforeseen circumstances, this post will be brought to you solely by crabs."),i("[TumblrMart crab widget]: Share post copy. Intro content text.","What’s that coming over the dash? Is it a monster? No. It’s just a crab 🦀"),i("[TumblrMart crab widget]: Share post copy. Intro content text.","*clack clack clack* It’s crab time *clack clack clack*")]),...function(e){var r=e._c,t=e._cn,a=e.numSummoned,s=e.numFriends,n=e.numBeloved,i=e.numCaptured,o=e.befriendedEmoji,l=void 0===o?"🌼":o,d=e.belovedEmoji,c=void 0===d?"💙":d,u=e.capturedEmoji,h=void 0===u?"💰":u,m=a&&!i&&!s&&!n,p=a&&i&&!s&&!n,g=a&&i&&i>=a,b=a&&s&&!i&&!n&&s>=a,v=a&&n&&!i&&!s&&n>=a;if(!a)return[{type:M.kH.Text,text:r("[TumblrMart crab widget]: Share post copy when no crabs summoned.","it is time for crab on tumblr, but not time for crab in my life. yet.")}];if(m)return[{type:M.kH.Text,text:t("[TumblrMart crab widget]: Share post copy when only summoned crabs.","today i summoned a crab! it is a good day","today i summoned %1$s crabs! look at them!",a)},...I({_c:r,showTitle:!1,numSummoned:a,befriendedEmoji:l,belovedEmoji:c,capturedEmoji:h})];if(p)return g?[{type:M.kH.Text,text:t("[TumblrMart crab widget]: Share post copy when user caught all summoned crabs. 1 is the number of summoned crabs. 2 is the emoji associated with being captured.","today i summoned one crab and then caught it %2$s","today i summoned %1$s crabs and then caught all of them %2$s what a harvest",a,[h])},...a>1?I({_c:r,showTitle:!1,numCaptured:i,befriendedEmoji:l,belovedEmoji:c,capturedEmoji:h}):[]]:[{type:M.kH.Text,text:r("[TumblrMart crab widget]: Share post copy when user caught some of summoned crabs. 1 is the number of summoned crabs. 2 is the number of captured crabs. 3 is the emoji associated with being captured.","today i summoned %1$s crabs and caught %2$s %3$s of them. look at them all!",[String(a),String(i),h])},...I({_c:r,showTitle:!1,numSummoned:a,numCaptured:i,befriendedEmoji:l,belovedEmoji:c,capturedEmoji:h})];if(b)return[{type:M.kH.Text,text:t("[TumblrMart crab widget]: Share post copy when user is friends with all summoned crabs. 1 is the number of crabs summoned. 2 is the emoji associated with friends.","today i summoned %1$s crab and became best friends with it. it's just me and my crab friend against the world! 🦀%2$s","today i summoned %1$s crabs and became friends with all of them 🦀%2$s look at my new friends!!",a,[l])},...a>1?I({_c:r,showTitle:!1,numFriends:s,befriendedEmoji:l,belovedEmoji:c,capturedEmoji:h}):[]];if(v)return[{type:M.kH.Text,text:t("[TumblrMart crab widget]: Share post copy when user summoned crabs and all of them fell in love with user. 1 is the number of summoned crabs. 2 is the emoji associated with love.","today i summoned one crab and then we fell in love 🦀%2$s crab my beloved","today i summoned %1$s crabs and they all fell in love with me 🦀%2$s i love them too.",a,[c])},...a>1?I({_c:r,showTitle:!1,numBeloved:n,befriendedEmoji:l,belovedEmoji:c,capturedEmoji:h}):[]];var f=[t("[Tumblrmart crab widget]: Share post copy. 1 is the number of summoned crabs.","today i summoned one crab!","today i summoned %1$s crabs!",a)];return i&&f.push(t("[TumblrMart crab widget]: Share post copy. 1 is the number of captured crabs. 2 is the emoji associated with being captured.","i caught one %2$s of them.","i caught %1$s %2$s of them.",i,[h])),s&&f.push(t("[TumblrMart crab widget]: Share post copy. 1 is the number of befriended crabs. 2 is the emoji associated with friends.","i became friends with one %2$s of them.","i became friends with %1$s %2$s of them.",s,[l])),n&&f.push(t("[TumblrMart crab widget]: Share post copy. 1 is the number of beloved crabs. 2 is the emoji associated with love.","one fell in love with me %2$s","%1$s fell in love with me %2$s",n,[c])),[{type:M.kH.Text,text:f.join(" ")},...I({_c:r,numSummoned:a,numFriends:s,numBeloved:n,numCaptured:i,befriendedEmoji:l,belovedEmoji:c,capturedEmoji:h})]}(S()({_c:i,_cn:o,numSummoned:r,numFriends:t,numBeloved:a,numCaptured:s},l&&b)),...l?[]:L([i("[TumblrMart crab widget]: Share post copy. Closing content text.","just me and my crab army *clack clack clack* 🦀"),i("[TumblrMart crab widget]: Share post copy. Closing content text.","i summoned some new orange friends 🦀")]),...l?[]:(e=(0,p.U)(Z),[{media:{height:1e3,type:A.w3.Mp4,url:e,width:1e3},provider:A.G6.Tumblr,type:M.kH.Video,url:e}]),...(0,P.E)([i("[TumblrMart crab widget]: Share post copy. TumblrMart link text.","Sharing is caring—and gifting your friends the crab army at TumblrMart…"),i("[TumblrMart crab widget]: Share post copy. TumblrMart link text.","Gift your friends the crab army!"),i("[TumblrMart crab widget]: Share post copy. TumblrMart link text.","Say it with the gift of the crab army—only at TumblrMart."),i("[TumblrMart crab widget]: Share post copy. TumblrMart link text.","Join us at crustacean nation, and buy your friends a gift…")])],isPrefilledPost:!0,disableBlogSelection:!1,tags:v};d({eventName:c.J.CrabsScoreboardShare}),h((0,N.TL)({postType:M.hQ.Text}),{state:{newPost:n}})},className:B.shareButton})},z={controlPanel:"n4ng3",buttonsWrapper:"o7Esz",summonButton:"rxrOL",wall:"y5_hQ",crabWrapper:"JljDF",isSpeaking:"vqBle",isCaptured:"ovjCT",isFriend:"GmAPq",isBeloved:"WxeRb",crab:"Acwsj",gameIcon:"PsGTl"};var R=0,_=[[-1,-1],[-1,0],[0,-1],[0,1],[1,0],[1,1],[-1,1],[1,-1]],O="crab_counts";function Y(e,r,t){var a=(0,h.Z)(-1,1);if(0!==a){var s=e+a*r;s<100?a=(0,h.Z)(0,1):s>=t&&(a=(0,h.Z)(-1,0))}return a}function G(e,r,t,a){var s=e+r*t;return s<100||s>=a}function J(e){return(null!=e?e:0)-1}function U(e){return(null!=e?e:0)+1}function Q(e){var r=e.bagIcon,t=e.crabIcon,a=e.id,n=e.onClick,l=e.onFriend,d=e.onLove,c=(0,u.bp)(),m=c._t,g=c._c,v=(0,o.useState)((0,h.Z)(400,1e3)),f=s()(v,1)[0],x=(0,o.useState)((0,h.Z)(20,79)),w=s()(x,1)[0],j=window.innerWidth-100,k=window.innerHeight-100,T=(0,o.useState)([(0,h.Z)(0,J(j)),(0,h.Z)(0,J(k))]),S=s()(T,2),C=S[0],F=S[1],H=b(),P=(0,p.U)(_),N=(0,o.useState)(P[0]),M=s()(N,2),A=M[0],B=M[1],E=(0,o.useState)(P[1]),Z=s()(E,2),L=Z[0],$=Z[1],I=(0,o.useState)(0),D=s()(I,2),W=D[0],R=D[1],O=(0,o.useState)(0),Q=s()(O,2),V=Q[0],q=Q[1],X=(0,o.useState)(!1),K=s()(X,2),ee=K[0],er=K[1],et=(0,o.useState)(!1),ea=s()(et,2),es=ea[0],en=ea[1],ei=(0,o.useState)(!1),eo=s()(ei,2),el=eo[0],ed=eo[1],ec=(0,o.useState)(""),eu=s()(ec,2),eh=eu[0],em=eu[1],ep=(0,o.useState)(!1),eg=s()(ep,2),eb=eg[0],ev=eg[1],ef=(0,o.useRef)(),ex=(0,o.useRef)();(0,o.useEffect)(()=>{if(!el&&!es)return ef.current=setInterval(()=>{var e=s()(C,2),r=e[0],t=e[1],a=A,n=L,i=W>5&&Math.random()>.5;(i||G(r,a,w,j))&&B(a=Y(r,w,j)),(i||G(t,n,w,k))&&$(n=Y(t,w,k)),F([r+A*w,t+L*w]),R(i?0:U(W))},f),()=>clearInterval(ef.current)},[C,A,L,V,w,W]),(0,o.useEffect)(()=>{var e,r,t,a=RegExp(m("Avatar"),"i"),s=null===(e=document)||void 0===e?void 0:e.elementFromPoint(...C),n=null==s?void 0:s.tagName.toLowerCase(),i=((null==s?void 0:s.getAttribute("data-crab-label"))||"").toLowerCase(),o=(null==s?void 0:s.getAttribute("data-crab-clickable"))||!1;if(i)em(i);else if("img"===n){var l=((null==s?void 0:s.getAttribute("alt"))||"").toLowerCase();l&&l.match(a)?em(g("[TumblrMart crab widget]: What a crab says when it walks on top of a blog name or avatar.","friend?")):l&&em(l)}else if("a"===n){var d=(null==s?void 0:s.getAttribute("href"))||"";if(d.match(/\/tagged\//)){var c=(null==s?void 0:s.textContent)||"";c.match(/\bc+r+a+b+\b/i)?em(g('[TumblrMart crab widget]: What a crab says when it walks on top of a tag link that contains "crab".',"about me?")):c.match(/🦀/i)?em(g("[TumblrMart crab widget]: What a crab says when it walks on top of a tag link that contains a crab emoji.","me??")):em(g("[TumblrMart crab widget]: What a crab says when it walks on top of a tag link.","tag"))}else d.match(/^https:\/\/.+\.tumblr.com\//)?em(g("[TumblrMart crab widget]: What a crab says when it walks on top of a blog name or avatar.","friend?")):em(g("[TumblrMart crab widget]: What a crab says when it walks on top of a link.","link"))}else"video"===n?em(g("[TumblrMart crab widget]: What a crab says when it walks on top of a video.","video")):em("");o&&(null==s||null===(r=(t=s).click)||void 0===r||r.call(t))},[C]),(0,o.useEffect)(()=>{if(!el&&es)return ef.current=setInterval(()=>{var e,r,t,a,n=H.clientX,i=H.clientY,o=s()(C,2),l=o[0],d=o[1];l+42<n-20?(e=1,t=n-20-l-42):l>n+20?(e=-1,t=l-n-20):(e=0,t=0),d+42<i-20?(r=1,i-20):(r=0,a=0),B(e),$(r),0===e&&0===r?em(g("[TumblrMart crab widget]: What a beloved crab says when it meets you","love <3")):F([l+e*Math.min(t,w),d+n(a,w)])},.75*f),()=>clearInterval(ef.current)},[C,A,L,V,w,H]);var ey=()=>{if(!eb){var e=U(V);!es&&e>=25?(er(!1),en(!0),d()):!(V>=10)&&e>=10&&(er(!0),l()),q(e)}},ew=()=>{eb||el||(ed(!0),setTimeout(()=>n(a),3e3)),ef.current&&clearInterval(ef.current)};return(0,y.jsx)("div",{className:i()(z.crabWrapper,{[z.isFriend]:ee&&!es,[z.isBeloved]:es,[z.isCaptured]:el,[z.isSpeaking]:!!eh}),"data-css-text-hand":g("[TumblrMart crab widget]: What a crab says when you hover over it","hand"),"data-css-text-friend":g("[TumblrMart crab widget]: What a friend crab says when you hover over it","friend <3"),"data-css-text-love":g("[TumblrMart crab widget]: What a beloved crab says when it meets you","love <3"),"data-speech":eh,"data-testid":"crab-wrapper",style:{transform:`translate(${C[0]}px, ${C[1]}px)`},children:(0,y.jsx)("button",{"aria-label":g("[Tget]: Label for interactive crab","Interactive crab"),className:z.crab,onClick:ew,onMouseEnter:ey,onTouchStart:()=>{if(eb)return clearTimeout(ex.current),ev(!1),ew();ex.current=setTimeout(()=>{ev(!1),ey()},300),ev(!0)},children:el?r:t})})}function V(e){var r,t=e.bagIcon,a=e.crabIcon,s=e.crabs,n=e.onFriendCrab,i=e.onLoveCrab,o=e.onDismissCrab;return"undefined"!=typeof window?(0,l.createPortal)((0,y.jsx)("div",{"data-testid":"crab-wall",className:z.wall,children:s.map(e=>(0,y.jsx)(Q,{id:e.id,bagIcon:t,crabIcon:a,onClick:o,onFriend:n,onLove:i},e.id))}),null===(r=document)||void 0===r?void 0:r.body):null}let q=function(e){var r=(0,u.bp)(),t=r._c,a=r.logEvent,n=(0,o.useState)([]),i=s()(n,2),l=i[0],h=i[1],p=(0,o.useState)(null),g=s()(p,2),b=g[0],v=g[1],f=(0,o.useState)(ns()(T,2),C=S[0],F=S[1],H=(0,o.useState)(null),P=s()(H,2),N=P[0],M=P[1],A=(0,o.useRef)();(0,o.useEffect)(()=>(window.addEventListener("beforeunload",B),()=>{B(),window.removeEventListener("beforeunload",B)}),[]),(0,o.useEffect)(()=>{A.current={numBefriended:null!=b?b:0,numBeloved:null!=j?j:0,numCaptured:null!=C?C:0,numSummoned:null!=N?N:0}},[b,j,C,N]);var B=()=>{var e;if(null!==(e=A.current)&&void 0!==e&&e.numSummoned){var r=m.E.getItem(O),t=r?JSON.parse(r):{befriended:0,beloved:0,captured:0,summoned:0},a=t.befriended,s=t.beloved,n=t.captured,i=t.summoned,o=A.current,l=o.numBefriended,d=o.numBeloved,c=o.numCaptured,u=o.numSummoned;m.E.setItem(O,JSON.stringify({befriended:a+l,beloved:s+d,captured:n+c,summoned:i+u}))}},E=t("[TumblrMart crab widget]: What the crab says when it steps on the Summon Crab button.","click please"),Z=null!=e&&e.gameAssets?(0,y.jsx)("img",{alt:t("[TumblrMart crab widget]: Label for a crab that has been caught","Crab in a bag"),srcSet:`${e.gameAssets.bag}, ${(0,d.LJ)(e.gameAssets.bag)} 2x`,src:e.gameAssets.bag,className:z.gameIcon}):(0,y.jsx)("span",{role:"img","aria-label":t("[TumblrMart crab widget]: Label for a crab that has been caught","Crab in a bag"),children:"'\uD83D\uDCB0'"}),L=null!=e&&e.gameAssets?(0,y.jsx)("img",{alt:t("[TumblrMart crab widget]: Label for a crab","Crab"),srcSet:`${e.gameAssets.crabs}, ${(0,d.LJ)(e.gameAssets.crabs)} 2x`,src:e.gameAssets.crabs,className:z.gameIcon}):(0,y.jsx)("span",{role:"img","aria-label":t("[TumblrMart crab widget]: Label for a crab","Crab"),children:"'\uD83E\uDD80'"});return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("div",{className:z.controlPanel,children:[(0,y.jsxs)("div",{className:z.buttonsWrapper,children:[(0,y.jsx)("button",{className:z.summonButton,onClick:()=>{h([...l,{id:R++}]),M(e=>U(e)),a({eventName:c.J.CrabSummoned})},"data-crab-label":E,children:t("[TumblrMart crab widget]: Button that produces a crab on click","Summon Crab!")}),N&&(0,y.jsx)(W,{numBeloved:null!=j?j:0,numCaptured:null!=C?C:0,numFriends:null!=b?b:0,numSummoney.jsx)(w,{numBeloved:j,numCaptured:C,numFriends:b,numSummoned:N})]}),(0,y.jsx)(V,{bagIcon:Z,crabIcon:L,crabs:l,sCrab:e=>{l.findIndex(r=>r.id===e)>-1&&(F(e=>U(e)),h(r=>{var t=r.findIndex(r=>r.id===e);return t>-1?[...r.slice(0,t),...r.slice(U(t))]:r}))},onFriendCrab:()=>v(e=>U(e)),Crab:()=>{v(e=>J(e)),k(e=>U(e))}})]})}},23779:(e,r,t)=>{t.d(r,{E$:()=>f,OX:()=>x,bW:()=>w,lw:()=>y,sF:()=>b,U5:()=>j,sB:()=>k,n:()=>v,Cz:()=>C,uZ:()=>A,qP:()=>S,io:()=>F,Pi:()=>H,kG:()=>N,_C:()=>P,Q1:()=>M});var a=t(54138),s=t.n(a),n=t(95004),i=t(96467),o=["$singleWord","$title of $placeName","$role of $placeName","$adjective $singleThing","$firstName","$complicatedName"],l={adjective:["Ruthless","Imperious","Unimpeachable","Sinister","Corporate","Sensitive","Exhausting","Scandalous","Harrowing","Foolish","Domestic","Steely","Hidden","Principled","Constant","Venetian","Baroque","Arboreal","Genuine","Lucky","Absolute","Terrestrial","Curious","Morbid","Abandoned","Aristotelian","Bohemian","Abstract","Admired","Agreeable","Alleged","Amiable","Angelic","Besieged","Unreasonable","Sizable","Unsupervised","Esoteric","Amorphous","Nauseous","Misshapen","Elastic","Confident","Indomitable","Ambivalent","Impulsive","Metallic","Floral","Threatening","Mirrored","Life-Size","Approachable","Tangible","Reliable","Pensive","False","True","Long","Fine","Illustrious","Solemn","Discerning","Euridite","Sun-eyed","Jade","Unsung"],townsperson:["Baker","Lighthouse Keeper","Butcher","Orphan","Helpmeet","Chanteuse","Friar","Falconer","Wizard","Witch","Sorcerer","Incubus","Succubus","Harpist","Dairymaid","Reaper","Goatherd","Artisan","Sculptor","Furrier","Girdler","Bandit","Juggler","Piper","Bard","Fiddler","Thatcher","Vicar","Dancer","Vagrant","Astrologer","Fletcher","Cobbler","Ambassador","Troubadour","Fool","Clown"],nameNoun:["Monarch","Pegasus","Fantasy","Orphan","Encounter","Spirit","Rhapsody","Orb","Sphere","Shape","Monstrosity","Sonata","Etude","Refrain","Fantasia","Apparition","Detritus","Flotsam","Rendezvous","Appointment","Erasure","Terror","Figure","Alibi","Feather","Number","Dog","Godhead","Decision","Bystander","Undergrowth","Dirt","Container","Flesh","Dream","Compromise","Pleasure","Passage","Threat","Diagnosis","River","Calliope","Fountain","Ripple","Pebble","Precipice","Oasis","Illusion","Fragment","Carnival","Pirouette","Masquerade","Tone"],title:["Earl","Duchess","Reverend","Chief","Archduke","Boy-King","Dowager Queen","Tsar","Marquess","Baron","Viscount","Empress","Emperor","President","Captain","Best Boy","Director","Vice President","Secretary","Prince","Princess","Mother Superior","Deacon","Prognosticator","Professor","Doctor"],familyRelation:["Son","Daughter","Father","Mother","Aunt","Uncle","Brother","Sister","Grandfather","Grandmother","Nephew","Niece","Cousin","Littermate","Sire","Damsire","Ex-Husband","Ex-Wife"],singleThing:["$nameNoun","$nameNoun","$nameNoun","$title"],singleWord:["$nameNoun","$nameNoun","$adjective","$adjective","$title"],role:["$title","$townsperson"],complicatedName:["$firstName | , $familyRelation of $firstName","$firstName | , $accomplishment","$firstName | , $role of $placeName"],placeName:["$britishPlace","$greekPlace"],britishPlace:["$britishPlaceBase | $britishPlaceSuffix","$britishPlaceBase | $britishPlaceSuffix","$britishPlaceBase | $britishPlaceSuffix","$britishPlaceBase | $britishPlaceSuffix","$britishPlaceBase | $britishPlaceSuffix | $britishPlaceFinisher"],greekPlace:["$greekPlaceStarter | $greekPlaceFinisher"],britishPlaceBase:["Avon","Ash","Old","Favers","Birming","Bucking","Wrex","Chat","Punk","Lyne","Maker","Bourne","Canter","Alde","Tewkes","Chep","Drum","Dun","Swin","Glod","Win","Sea"],britishPlaceSuffix:["ton","ington","dale","dean","ham","keth","leigh","field","brook","mouth","borough","bury","burgh","caster","chester","thorpe","thwaite","wick","worth"],britishPlaceFinisher:["-on- | $britishPlaceBase","-under- | $britishPlaceBase","-upon- | $britishPlaceBase","shire"],greekPlaceStarter:["Ab","Ach","Act","Aeg","Apoll","Arg","Herm","Her","Kall","Kam","Lam","Liss","Mant","Meg","Myk","Nax","Olymp","Pand","Sest","Strat","Thass","Therm","Zak"],greekPlaceFinisher:["ila","ydos","anthus","amae","ium","ae","onia","os","onassa","aclea","aptera","imera","ia","istria","astria","ipolis","opolis","eiros","annia","ascus","icea","ara","aria","apactus","eapoli","osia","ynthos"],timeAdjective:["Last","First"],firstName:["$scr | $u | $ngo | $s?"],scr:["Scr","Skr","Tr","Str","Gr","Gl","St","R","T","M","K","G","Y","Dr"],u:["u","oo","o","ee","i","ou","oa","u","a","oo","o","u","o'a","ø","ü"],ngo:["lgo","to","gu","po","mpo","ngu","ngo","lgo","lgo","mbe","mbu","g","t","d","st","sk","b","bu","cco"],s:["s","z"],accomplishment:["Who $mocks $powerfulThing","Who $conquered $placeName","$scourge of $placeName"],mocks:["Mocks","Laughs at","Refuses","Taunts","Harrasses","Provokes","Teases","Enrages","Incites","Offends","Derides","Scoffs at","Spits at","Betrays"],powerfulThing:["Hell","Death","God","Heaven","the Earth","Poseidon","Zeus","Athena","The Gods","Kings","Fate","Destiny","the Oracle","the Fates","Gaia","Hestia","Hades","Odin","Thor","Freyja","the internet","the economy","Reason itself"],conquered:["Conquered","Devastated","Annexed","Seized","Captured","Flattened","Quelled"],scourge:["Scourge","Terror","Bane","Torment","Hero","Voice","Heart","Savior","Salvation","Protector","Champion","Horror","Blight"]},d=(e,r)=>{if("$"!==e[0])return e;var t=e.slice(1),a=t.match(/([^?]+)(\?+)$/);if(a&&a[2].length){if(Math.randett)},c=(e,r)=>{if(r[e])return r[e];replace(urn r[e]=t,t},u=e=>{if(l[e])return h(l[e]);thkey: "+e},h=e=>e[Math.floor(Math.random()*e.length)],m=e=>e.replace(/\s*\|\s*/g,""),p=e=>{var r={},t=e.split(" ").map(e=>d(e,r)).filter(e=>e&&e.length).join(" ");return t.match(/\$/)?p(t):m(t)},g=()=>p(h(o)),b="EXTREME_HORSE_ZONE",v=1e3,f=1.2,x=50,y=2,w=.03,j=8,k=4,T=()=>({name:g(),age:0,isAlive:!0}),S={hearts:[],currentHorse:T(),poos:[],horseComfortLevel:100,cemetery:[],tick:-1,horseDesiredX:null,horseDesiredY:null,horseX:i.horseFriendCanvasWidth/2-i.horseFriendHorseWidth/2,horseY:i.horseFriendCanvasHeight-i.horseFriendHorseHeight,horseFacingLeft:!0,poosRemoved:0,shouldShowCemetery:!1,isMinimized:!0},C=e=>(e.hed 0===e.isMinimized&&(e.isMinimized=!0),e),F=e=>e.currentHorse.isAlive?e.cemetery.length+1:e.cemetery.length,H=e=>{var r=e.currentHorse.isAlive?e.poosRemoved:0;return e.cemetery.reduce((e,r)=>e+r.poosRemoved,r)},P=(e,r)=>{switch(r.type){case"loadStateFromStorage":return C(r.gameState);case"tick":return s()(s()({},e),r.gameState);case"setHorseX":return s()(s()({},e),{},{horseX:r.x});case"setHorseY":return s()(s()({},e),{},{horseY:r.y});case"setHorseDesiredX":return s()(s()({},e),{},{horseDesiredX:r.x});case"setHorseDesiredY":return s()(s()({},e),{},{horseDesiredY:r.y});case"setHorseFacingLeft":return s()(s()({},e),{},{horseFacingLefteturn s()(s()({},e),{},{poos:r.poos});case"addHeart":return s()(s()({rts.concat([r.heart])});case"updateHeart":return s()(s()({},e),{},{hearts:e.hearts.map(e=>e.id===r.heart.id?r.heart:e)});case"removeHeart":return s()(s()({},e),{},{hearts:e.hearts.filter(e=>e.id!==r.heart.id)});case"setPoosRemoved":return s()(s()({},e),{},{poosRemoved:r.poosRemoved});case"setShouldShowCemetery":return s()(s()({},e),{},{shouldShowCemetery:r.shouldShowCemetery});case"hatchNewHorse":return s()(s()({},S),{},{currentHorse:T(),horseDesiredY:i.horseFriendCanvasHeight-i.horseFriendHorseHeight,horseDesiredX:Math.floor(i.horseFriendCanvasWidth-2*i.horseFriendHorseWseX:,c;case"setIsMinimized":return s()(s()({},e),{},{isMinimized:r.isMinimized});default:return e}},N=(0,n.createContext)({state:S,dispatch:()=>null}),M=()=>(0,n.useContext)(N),A=(e,r,t)=>Math.max(Math.min(e,t),r)},6709:(e,r,t)=>{t.d(r,{E:()=>i});var a=t(5700),s=t(68782),n="https://tumblr.com/tumblrmart";function i(e){return[{description:(0,s.U)(e),displayUrl:n,type:a.kH.Link,url:n}]}},13194:(e,r,t)=>{t.d(r,{g:()=>s});var a=t(32415),s=()=>{var e,r=(0,a.Pc)().data;if(null!=r&&r.user)return null!==(e=r.user.blogs[0].tumblrmartOrders)&&void 0!===>{t.d(r,{Th:()=>m,yQ:()=>h});var a=t(17276),s=t.n(a),n=t(33590),i=t(73465),o=t(91253),l=t(39377),d=t(78667),c=t(94833),u=(0,o.i)(c.z.object({unseenItems:c.z.array(l.YY).optional()})),h=e=>["unseen-items",e];function m(){var e=(0,d.bp)(),r=e.apiFetchWithSchema,t=e.isLoggedIn;return(0,n.a)({queryKey:h(t),queryFn:()=>{var e,a;return s()().async(function(n){for(;;)switch(n.prev=n.next){case 0:if(t){n.next=2;break}return n.abrupt("return",null);case 2:return n.next=4,s()().awrap(r("/v2/tumblrmart/unseen_items",u,{method:"GET",schemaErrorPrintFullResponse:!0}));case 4:return a=n.sent.response,n.abrupt("return",(null==a||null===(e=a.unseenItems)||void 0===e?void 0:e.map(e=>{var r=e.backgroundColors,t=e.deeplink,a=e.imageUrl,s=e.productGroup,n=e.tumblelogUuid,o=e.type;return{backgroundColor:(0,i.aA)(r),deeplink:t,imageUrl:a,productGroup:s,tumblelogUuid:n,type:o}}))||[]);case 7:case"end":return n.stop()}},null,null,null,Promise)},refetchInterval:3e4,refetchIntervalInBackground:!0,staleTime:6e4})}},68757:(e,r,t)=>{t.d(r,{Z:()=>l});var a=t(5754),s=t.n(a),n=t(78667);let i={container:"uzQXY",icon:"QLnDj",active:"OnwDa",available:"nyE9Y",expired:"IBxfI",pending:"QeG5E",redeemed:"dCSsv",redeemedValid:"gMHJB"};var o=t(2629);let l=e=>{var r,t=e.status,a=(0,n.bp)()._c;switch(t){case"redeemed":case"redeemedValid":r=a("Label for a tumblrmart order that has been redeemed","Redeemed");break;case"active":r=a("Label for a tumblrmart order that is currently active","Active");break;case"available":r=a("Label for a tumblrmart order that is ready to be activated","Available");break;case"expired":r=a("Label for a tumblrmart order that is expired","Expired");break;case"pending":r=a("Label for a tumblrmart order that is still being processed","Pending");break;default:r=a("Label for an unknown order status for Tumblrmart","Unknown")}return(0,o.jsxs)("div",{className:i.container,children:[(0,o.jsx)("span",{"data-testid":"status-icon",className:s()(i.icon,i[t])}),r]})}},17447:(e,r,t)=>{t.d(r,{RT:()=>o,Rn:()=>n});var a=t(54589),s=t.n(a),n="Settings",i={accountActivityEmails:!0,asksSubmissionsHeaderBadges:!0,autoTruncatingPosts:!1,viewWithBlogTheme:!0,colorizedTags:!0,conversationalNotifications:!0,dashboardBestStuffFirst:!0,dashboardFollowedTagsPosts:!0,snoozeTmgLive:!0,dashboardInYourOrbit:!0,dashboardBasedOnYourLikes:!0,defaultPostFormat:0,email:"test@example.com",endlessScrolling:!0,filteredContent:[],filteredTags:[],improvedSearch:!0,language:"en_US",messagingSounds:!0,onlineStatusIndicator:!0,ccpaOptedOut:!1,permitMarketingEmails:!0,tfaAuthenticatorEnabled:!1,tfaSmsEnabled:!1,tfaSmsPhoneNo:"",timestamps:!1,hideSensitiveContent:!0,communityLabelVisibilitySetting:"warn",communityLabelCategories:{drugUse:"warn",violence:"warn",sexualThemes:"warn"},labsEnabled:!0,labsExperiments:[],connectedApps:{},disableAdminOnlyFeatures:!1,disableAdminTagButtons:!1,adminEnableDevboxRedpop:!1,tumblrPremium:!1,showAdsAnyway:!1,showBlazeAds:!1};i.email,i.tfaSmsEnabled,i.tfaSmsPhoneNo,i.tfaAuthenticatorEnabled,i.connectedApps;var o=s()(i,["email","tfaSmsEnabled","tfaSmsPhoneNo","tfaAuthenticatorEnabled","connectedApps"])},51364:(e,r,t)=>{t.d(r,{Z:()=>m});var a=t(33970),s=t.n(a),n=t(95004),i=t(36583),o=t(43523),l=t(78667),d=t(83932),c=t(59889),u=t(57125),h=t(2629);let m=e=>{var r=e.disableRefresh,t=e.disabled,a=e.onUpdate,m=e.name,p=(0,l.bp)(),g=p.logEvent,b=p._t,v=(0,d.rV)(),f=v.settings,x=v.set,y=0;f.showBlazeAds&&(y=c.Z.findIndex(e=>"showBlazeAds"===e.value)),(f.showAdsAnyway||t)&&(y=c.Z.findIndex(e=>"showAdsAnyway"===e.value));var w=(0,n.useState)(y),j=s()(w,2),k=j[0],T=j[1];return(0,h.jsx)(i.Z,{className:u.Z.radioGroup,groupLabel:b("Ad Visibility"),name:m,options:c.Z,selectedOptionIndex:k,onChange:e=>{var t=o.J.AdFreeBrowsingSettingsShowNone,s=c.Z[e].value;"showBlazeAds"===s?(t=o.J.AdFreeBrowsingSettingsShowBlaze,x("showAdsAnyway",!1,!1,()=>x("showBlazeAds",!0,!r,()=>null==a?void 0:a("showBlazeAJ.AdFreeBrowsingSettingsShowAll,x("showBlazeAds",!1,!1,()=>x("showAdsAnyway",!0,!r,()=>null==a?void 0:a("showAdsAnyway")))):x("showAdsAnyway",!1,!1,()=>x("showBlazeAds",!1,!r,()=>null==a?void 0:a("showNone"))),T(e),g({eventName:t})},disabled:t})}},59889:(e,r,t)=>{t.d(r,{Z:()=>i});var a=t(54382),s=t(57125),n=t(2629);let i=[{value:"showNone",children:(0,n.jsx)("span",{children:(0,n.jsx)(a.ZP,{components:{emoji:(0,n.jsx)("span",{role:"img","aria-label":"",className:s.Z.emoji})},children:"Hide all ads [emoji]\uD83D\uDE48[/emoji]"})})},{value:"showBlazeAds",children:(0,n.jsx)("span",{children:(0,n.jsx)(a.ZP,{components:{emoji:(0,n.jsx)("span",{role:"img","aria-label":"",className:s.Z.emoji})},children:"Only show user Blaze ads [emoji]\uD83D\uDE0E[/emoji]"})})},{value:"showAdsAnyway",children:(0,n.jsx)("span",{children:(0,n.jsx)(a.ZP,{components:{emoji:(0,n.jsx)("span",{role:"img","aria-label":"",className:s.Z.emoji})},children:"Show all ads [emoji]\uD83E\uDD11[/emoji]"})})}]},83932:(e,r,t)=>{t.d(r,{Am:()=>v,mu:()=>f,rV:()=>x});var a=t(54138),s=t.n(a),n=t(17276),i=t.n(n),o=t(33970),l=t.n(o),d=t(95004),c=t(17447),u=t(85795),h=t(24078),m=t(58546),p=t(78667),g=t(2629),b=(0,nction v(e,r,t){var a=(0,u.ZP)(e.apiFetch).getUserSettings().fetch();return r?Promise.all([a,r(e,t)]).then(e=>{var r=l()(e,2);return{settings:r[0].response,extraData:r[1]}}):a.then(e=>({settings:e.response}))}function f(e){var r=e.children,t=e.additionalDataFetcher,a=(0,p.bp)(),n=a.getBootstrap,o=a.apiFetch,f=a.apiFetchWithSchema,x=a.features,y=(0,d.useState)(!1),w=l()(y,2),j=w[0],k=w[1],T=(0,d.useState)(!1),S=l()(T,2),C=S[0],F=S[1],H=(0,d.useState)(null==n?void 0:n(c.Rn)),P=l()(H,2),N=P[0],M=P[1];(0,d.useEffect)(()=>{i()().async(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Object.keys(N).length>0)){e.next=2;break}return e.abrupt("return");case 2:return F(!0),e.t0=M,e.next=6,i()().awrap(v({apiFetch:o,apiFetchWithSchema:f},t,x));case 6:e.t1=e.sent,(0,e 9:case"end":return e.stop()}},null,null,null,Promise)},[]);var A=(e,r,t)=>{var a=N.extraData,n=N.settings,i=Object.keys(c.RT);M({settings:s()(s()({},n),e),extraData:a});var l=(0,h.c)(e,(e,r)=>i.includes(e));(0,m.Q)(l)||(0,u.ZP)(o).updateUserSettings(l).fetch().then(()=>{r&&(k(!0),window.location.reload()),null==t||t()})},B=(e,r,t,a)=>{var n=N.extraData,i=N.settings;M({extraData:s()(s()({},n),e),settings:i}),(0,m.Q)(e)||null==r||r.fetch().then(()=>{t&&window.location.reload(),null==a||a()})},E={settings:N.settings,extraData:N.extraData,isFetching:C,isForceReloading:j,merge:function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=arguments.length>2?arguments[2]:void 0;return A(e,r,t)},mergeExtraData:function(e,r){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3?arguments[3]:void 0;return B(e,r,t,a)},set:function(e,r){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3?arguments[3]:void 0;return A({[e]:r},t,a)},setExtraData:function(e,r,t){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4?arguments[4]:void 0;return B({[e]:r},t,a,s)},toggle:function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=arguments.length>2?arguments[2]:void 0;return()=>A({[e]:!N.settings[e]},r,t)},select:function(e){var r=e.target,t=r.id,a=r.value,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;return A({[t]:a},s,n)},refetch:()=>{i()().async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=M)}},null,null,null,Promise)}};return(0,gtion x(){var e=(0,d.useContext)(b);if(void 0===e)throw Error("useSettings must be used within a SettingsProvider");return e}},63084:(e,r,t)=>{t.d(r,{Z:()=>a});let a=(e,r)=>Math.floor(Math.random()*(r-e+1))+e},57330:(e,r,t)=>{t.d(r,{H:()=>s});var a=t(32468);function s(e){return(0,a.eh)(e)&&e.extraAttributes?e.extraAttributes.searchTerm:(0,a.$4)(e)&&e.extraAttributes?`#${null==e?void 0:e.extraAttributes.tagName}`:""}}}]);