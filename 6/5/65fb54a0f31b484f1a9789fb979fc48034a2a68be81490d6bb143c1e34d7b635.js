!);var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"redpop@b474a6ad4354f4ba5fde672fa4e9c2c267684761"};"use strict";(self.webpackChunk_tumblr_redpop=self.webpackChunk_tumblr_redpop||[]).push([[4741],{80518:(e,t,s)=>{s.d(t,{Z:()=>h});var a=s(5754),n=s.n(a),r=s(45222),i=s(44009),l=s(37236);let o={chatListItemWrapper:"_vFtf",chatListItem:"leMd5",avatar:"xCv4H",content:"GyW8v",header:"uX3_z",name:"pTvJc",unread:"lx_bn",new:"Y8xri",preview:"FZe6i",previewTwoLines:"sAY6a",previewOneLine:"iVhqZ",isMobile:"F1eQQ"};var c=s(2629);let h=e=>{var t=e.previewContent,s=e.otherParticipant,a=e.label,h=e.openConversationOnClick,d=e.isMobile,p=e.unread,g=e.isOnline,u=e.conversationId,v=n()(o.chatListItem,{[o.isMobile]:d}),m=d?38:34,b="string"==typeof t,x=n()(o.preview,{[o.previewOneLine]:b,[o.previewTwoLines]:!b}),f=n()(o.header,{[o.unread]:p});return(0,c.jsxs)(i.Z,{wrapperClassName:o.chatListItemWrapper,className:v,onClick:e=>h(e,{conversationId:u,otherParticipantName:s.name}),label:a,children:[(0,c.jsx)("div",{className:o.avatar,children:(0,c.jsx)(r.Z,{dimension:m,avatarShape:l.o.Circle,imageResponse:s.avatar,isOnline:g,isAdult:s.isAdult})}),(0,c.jsxs)("div",{className:o.content,children:[(0,c.jsxs)("div",{className:f,children:[(0,c.jsx)("div",{className:o.name,children:s.name}),p&&(0,c.jsx)("div",{className:o.new})]}),(0,c.jsx)("div",{className:x,children:t})]})]})}},73831:(e,t,s)=>{s.d(t,{Z:()=>C});var a=s(54138),n=s.n(a),r=s(50209),i=s.n(r),l=s(5754),o=s.n(l),c=s(95004),h=s(93853),d=s(37548),p=s(17144),g=s(85795),u=s(78667),v=s(42914),m=s(399),b=s(80518);let x={newMessage:"M34dz",searchWrapper:"glTqf",searchLoader:"P4xeq",suggestedResults:"n23S3",suggestedParticipantsTitle:"X_lFW",isMobile:"wSjVv",noResults:"oLgq2"};var f=s(2629);class w extends c.Component{constructor(){var e;super(...arguments),i()(this,"state",{blogSearchText:"",searchedParticipants:[]}),i()(this,"newMessageListItemLabel",this.props.appContext._t("New Message")),i()(this,"maxResultsToDisplay",5),i()(this,"apiHelper",(0,g.ZP)(this.props.appContext.apiFetch)),i()(this,"debounceGetSearchedParticipants",(0,v.Z)(null!==(e=this.props.debounceTime)&&void 0!==e?e:100)),i()(this,"placeholders",(0,m.Qe)(this.props.appContext._c)),i()(this,"openConversationOnFirstSearchResult",e=>{if(e.key===h.SV.Enter&&!e.nativeEvent.isComposing){var t=this.props.openConversationOnClick,s=this.state.searchedParticipants;s.length&&t(null,{otherParticipantName:s[0].name})}}),i()(this,"setInputRef",,i()(this,"handleTextChange",e=>{var t=e.target.value;t!==this.state.blogSearchText&&this.setState({blogSearchText:t,searchInProgress:!0},this.debounceGetSearchedParticipants)}),i()(this,"refreshSearchedParticipants",()=>{var e=this.state.blogSearchText,t=this.props.selectedBlog,s={searchInProgress:!1,noResultsPlaceholder:(0,p.I)(this.placeholders)};return e.length?this.apiHelper.getSuggestedParticipants(t.name,{limit:this.maxResultsToDisplay,q:e}).fetch().then(e=>{var t=e.response;this.setState(n()(n()({},s),{},{searchedParticipants:t.blogs}))}):Promise.resolve(this.setState(n()(n()({},s),{},{searchedParticipants:[]})))})}componentDidMount(){this.focusInput()}componentDidUpdate(){this.focusInput()}render(){var e=this.state,t=e.blogSearchText,s=e.searchedParticipants,a=e.searchInProgress;return this.props.inNewMessageMode&&(0,f.jsxs)("div",{className:x.newMessage,children:[(0,f.jsx)(h.ZP,{disable:[...h.z9]}),this.renderSearchbar(),a&&(0,f.jsx)(d.Z,{className:x.searchLoader}),!!t.length&&(s.length?this.renderSearchResults():this.renderNoSearchResults()),this.shouldShowSuggestedResults()&&this.renderSuggestedResults()]})}renderSearchbar(){var e=this.props.appContext._t;return(0,f.jsxs)("div",{className:x.searchWrapper,children:[(0,f.jsx)("span",{children:e("To:")})," ",(0,f.jsx)("input",{type:"text",value:this.state.blogSearchText,onChange:this.handleTextChange,onKeyDown:this.openConversationOnFirstSearchResult,ref:this.setInputRef})]})}shouldShowSuggestedResults(){var e=this.state,t=e.blogSearchText,s=e.searchedParticipants,a=this.props.suggestedParticipants;return!!a&&!!a.length&&(!t.length||!!t.length&&!!s.length)}enderSearchResults(){var e=this.state.searchedParticipants,t=this.props,s=t.isMobile,a=t.openConversationOnClick;return e.map(e=>(0,f.jsx)(b.Z,{otherParticipant:e,previewContent:e.title,label:this.newMessageListItemLabel,isMobile:s,openConversationOnClick:a},e.uuid))}renderNoSearchResults(){var e=this.state,t=e.searchInProgress,s=e.blogSearchText,a=e.noResultsPlaceholder;return(!t||t&&s.length>1)&&(0,f.jsx)("div",{className:x.noResults,children:a})}renderSuggestedResults(){var e=this.props,t=e.suggestedParticipants,s=e.openConversationOnClick,a=e.isMobile,n=e.appContext._t,r=this.state.searchedParticipants,i=this.maxResultsToDisplay-r.length;return i>0&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("div",{className:o()(x.suggestedParticipantsTitle,{[x.isMobile]:a}),children:n("Recently followed")}),(0,f.jsx)("div",{className:x.suggestedResults,children:t.map((e,t)=>t<i&&(0,f.jsx)(b.Z,{otherParticipant:e,previewContent:e.title,label:this.newMessageListItemLabel,isMobile:a,openConversationOnClick:s},e.uuid))})]})}}let C=(0,u.HJ)(w)},17144:(e,t,s)=>{s.d(t,{I:()=>n});var a=s(68782);,48352:(e,t,s)=>{s.d(t,{Z:()=>m});var a=s(54138),n=s.n(a),r=s(33970),i=s.n(r),l=s(95004),o=s(78994),c=s(55673),h=s(43523),d=s(22424),p=s(12736),g=s(14544),u=s(78667);let v=e=>{var t=(0,u.bp)().logEvent,s=(0,o.TH)().pathname,a=(0,c.lr)(),r=i()(a,1)[0];(0,l.useEffect)(()=>{"embed"===r.get("source")&&t({pathname:s,eventName:h.J.EmbedPostClick,eventDetails:n()(n()({},e),{},{refUrl:r.get("refUrl"),action:r.get("action")})})},[])},m=e=>{var t=e.page,s=e.eventDetails,a=(0,d.wL)().logEvent,r=(0,o.TH)().pathname,u=(0,c.lr)(),m=i()(u,1)[0],b=(0,g.M)().name,x=(0,p.z)(),f=x.isModalShowing,w=x.isPeeprShowing,C=(0,l.useRef)(f||w),P=m.get("source"),S=()=>a({page:t,pathname:r,eventName:h.J.ScreenView,eventDetails:n()(n()({pathname:r,referrer:document.referrer,color_palette:b},P&&{source:P}),s)});return(0,l.useEffect)([r,t]),(0,l.useEffect)(()=>{!C.current||f||w||S(),C.current=f||w},[C,f,w]),v(),null}},87832:(e,t,s)=>{s.r(t),s.d(t,{default:()=>f});var a=s(50209),n=s.n(a),r=s(45222),i=s(52980),l=s(44009),o=s(73831),c=s(48352),h=s(32468),d=s(71417),p=s(85795),g=s(59215),u=s(11384),v=s(93307);let m={newMessageMobile:"PQALG",header:"bX2aI",title:"r6DOj",cancel:"sEh_x",newMessageContent:"wJtk3",sender:"PXwUt",avatar:"tGqty",name:"tGnXm"};var b=s(2629);class x extends d.lb{constructor(){super(...arguments),n()(this,"state",this.props.appContext.getBootstrap(v.R,this.props.location.state)),n()(this,"apiHelper",(0,p.ZP)(this.props.appContext.apiFetch)),n()(this,"openConversationOnClick",(e,t)=>{var s=t.otherParticipantName,a=this.state.selectedBlog;(0,this.props.messagingContext.openConversationWindow)({otherParticipantName:s,selectedBlogName:a.name},{replace:!0})}),n()(this,"getPathnameToInbox",()=>{var e=this.state.selectedBlog;return`/messaging${e.primary?"":`/${e.name}`}`}),n()(this,"handleCancel",()=>{var e=this.props,t=e.location,s=e.navigate,a=e.navigationType;(0,u.Z)({location:t,navigate:s,navigationType:a,fallbackPath:this.getPathnameToInbox()})}),n()(this,"getSuggestedParticipants",()=>{var e=this.state.selectedBlog;e&&this.apiHelper.getSuggestedParticipants(e.name,{limit:8}).fetch().then(e=>{var t=e.response;this.setState({suggestedParticipants:t.blogs})})})}ender(){var e=this.state,t=e.selectedBlog,s=e.suggestedParticipants;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(c.Z,{page:v.H.analyticsPageName}),(0,b.jsx)(i.Z,{activePage:h.vS.messaging,children:!!t&&(0,b.jsxs)("div",{className:m.newMessageMobile,children:[this.renderHeader(),(0,b.jsxs)("div",{className:m.newMessageContent,children:[this.renderSubHeader(),(0,b.jsx)(o.Z,{selectedBlog:t,suggestedParticipants:s,inNewMessageMode:!0,isMobile:!0,openConversationOnClick:this.openConversationOnClick})]})]})})]})}renderHeader(){var e=this.props.appContext._t;return(0,b.jsxs)("div",{className:m.header,children:[(0,b.jsx)("span",{className:m.title,children:e("New message")}),(0,b.jsx)(l.Z,{className:m.cancel,onClick:this.handleCancel,children:e("Cancel")})]})}renderSubHeader(){var e,t=this.state.selectedBlog,s=null===(e=t.theme)||void 0===e?void 0:e.avatarShape;return(0,b.jsxs)("div",{className:m.sender,children:[(0,b.jsx)("div",{className:m.avatar,children:(0,b.jsx)(r.Z,{imageResponse:t.avatar,avatarShape:s,dimension:24})}),(0,b.jsx)("div",{className:m.name,children:t.name})]})}}let f=(0,g.Bg)(x,{appContext:!0,messagingContext:!0})},11384:(e,t,s)=>{s.d(t,{Z:()=>r});var a=s(68280),n=s(68859);function r(e){var t=e.location,s=e.navigate,r=e.navigationType,i=e.fallbackPath,l=(0,n.Z)(document.referrer),o="default"!==t.key;"production"===a.Z.Development&&"REPLACE"===r&&console.warn("Beware! This route was entered with REPLACE navigation type. Going back to a previous route might not result in what you expect. Please test it carefully!"),o||l?s(-1):s(void 0===i?"/dashboard":i,{replace:!0})}},68859:(e,t,s)=>{s.d(t,{Z:);let a=e=>{if(!e)return!1;try{t=new URL(e)}catch(e){return!1}var t,s=t.hostname;return"safe.txmblr.com"===s||/(?:^tumblr|\.tumblr)\.(?:com|net)$/.test(s)}}}]);