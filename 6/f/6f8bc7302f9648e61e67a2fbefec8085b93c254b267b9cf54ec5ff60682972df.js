(()=>{var e,t,i={316:84:999:974:207:503:853:234:832:777:386:72:249:120:,s={};.m=i,n.n=n.d=n.f={},n.e=n.u=n.miniCssF=n.g=),n.o=e={},t="adUnits:",n.l=n.r=((),((),(()=>{"use strict";var e=n(999),t=n.n(e),i=(n(84),n(316)),s=n.n(i),o=n(316);deepClone:r,isBasicObject:a,basicObjects:l,arrays:d,deepExtend:);const f=s().Model.extend({constructor:toJSON:get:set:clear:hasChanged:changedAttributes:previous:previousAttributes:);f.keyPathSeparator=".";const b=f;s().DeepModel=b;var y,_=n(974),S=n(503),A=n(84);function T(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function w(e,t,i){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?s:String(s))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var P=null,E=e.flatten;e.mixin({setConfigparseBool:el:loadJs:loadCss:loadJsArr:getUrlVars:firePixelConditional:firePixel:fireIframePixel:getViewabilityPercentisVisibleviewport:getVideoHeight(e){var t=parseInt(9/16*e);return isNaN(t)?0:t},getVideoWidthgetVideoBestSizegetVideoHeightByRatiogetVideoWidthByRatioisElementInHeadgetViewPercent:isViewable:getViewPercentageDeltas:getValidSelectorElementsfilterObjectassignWithoutUndefinedValuesstripObjectarrayToObjgetTopOfElgetParentNode:getLeftOfEl:PrefixedEventoneAnimationEndaddParametersToUrl(e,t,i){var s=e;return s+=i?"?":"&",A.each(t,(function(e,t){void 0!==t&&""!==t&&(s+=e+"="+t+"&")})),s},skipTransitionCssflushCssgetTopWindowisInIframe:isInFriendlyIframe:hideDFPIframe:onceDocReady:crc32:utf8Encode:isMouseOver:rollNumbers:isFactor:sendMail:isValidEmail:toCssObj:isLayerVisible:getOffsetflattencssObjToStringisModelgenerateGuidisObserverSupportedisHeightValid(e){var t=!0;return e||(t=!1),t},isWidthValidsetTrcObserverdispatchTRCdispatchTRCWithPayloadgetOffsetWithContainergetIframeDocumentDOMIteratorisBrowserIE11:forceElementRedrawWithBorderChangehasPassedPixelFromSelectorgetViewportHeight:calcViewportPositionInAppgetOrganicCardgetRootElementFontSize:convertRemflattenArray:offsetFromBottomOfViewPort:sendingEventToTaboolaBridgesetAnimationPlayStaterecoReelPlayStateAnimationtoggleRecoReelVideogetRandomFromList:isSendBeaconSupported:getSubUnitTypegetRecoReelSubUnitTypeisReadMoreOnPage:isMidArticleOnReadMorePageisReadMoreObserverNeededOnPage:trcPerformanceMeasurementisTRCPerformanceEnabled:copyCSSFromPlaceholdergetDeltaBetweenRectsbuildObserverThresholdListgetRequiredHeightgetFeedTitleHeightgetPlacementgetMarginToStartCardisPlacementWithScAdjacency:isLanguageRTLloadFromTRCisServiceValid:isServiceLoadedOnTRC:onServiceLoadedisSliderCutOffEnabled:clickThrudeferisZeptoCollection:log);var C=n(386),I=n(999);onst O=R;const N=var D=n(84),x=n(999),V=M=n(853),L=n(316);const F=var B=n(84),k=n(999);const U=const z=var H=n(999);const j=z(;var W=n(234),Z=n(999);const G=const q=const $=var Y=n(316),K=n(84);const Q=const X=var J=n(316);const ee=z(;var te=n(999),ie=n(84);ar ne=function(){var e;return function(t){return e||(e=new se(t)),e}}();const oe=ne;var re=n(999);const ae=const le=const de=var he=n(84);onst ue=ce;var pe=n(84),ge=n(999),me=n(316);const ve=var fe=n(316),be=n(999);const ye=z(;var _e=n(999);function Se(e,t,i){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?s:String(s))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var Ae=const Te=const we=ar Ee=n(999);const Ce=z(;var Ie=n(999);const Re=z(;const Oe=var Ne=n(207),De=n(999);onst Ve=xe;function Me(e,t,i){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?s:String(s))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Le=const Fe=var Be=ke=const Ue={KIBANA_URL:"vidanalytics.taboola.com/putes/units-ads-analytics",SERVICES:{UNIT:"unit",PLAYER:"player"},EXTRA_PARAMS_EXCEPTIONS:["vidCurrentTime"],OPPS_PARAMETERS_MAPING:{player:{pstn:"pstn",mob:"isMobile",unv:"unit_version",unit_type:"unit_type",pv:"playerVersion",fdScore:"fdScore",abt:"ab_test",agl:"preset.level",su:"subUnitType",awr:"performance.dtsvrRoundTripAverageDuration",pm:"performance.performanceMeasurment",dtsvrRoundTripAverageDuration:"performance.dtsvrRoundTripAverageDuration",mp:"modifiedPlacement",sts:"playerRepeatCount",ft:"frameType",be:"playerHasRvInQ",pt:"ab_test",width:"width",height:"height",cmDast:"auc_dast"},unit:{pstn:"pstn",mob:"isMobile",unv:"unit_version",unit_type:"unit_type",fdScore:"fdScore",abt:"abTest",agl:"preset.level",awr:"performance.dtsvrRoundTripAverageDuration",pm:"performance.performanceMeasurment",su:"subUnitType",ft:"frameType",mp:"modifiedPlacement",vstt:"isInTab",cmDast:"cmDast",be:"playerHasRvInQ",sts:"playerRepeatCount"}},MAX_ES_STRING_LENGTH:32766};var ze=n(999);nst We=ar Ge=function(){var e;return function(t){return e||(e=new Ze(t)),e}}();const qe=Ge;var $e=n(84),Ye=n(999),Ke=n(316);ar Xe=);const Je=Xe;var et={atr:{},platform:{Desktop:{atr:{}},Mobile:{atr:{secondsBW:20}}}},tt={demo:{strength:101,atr:{},1:{atr:{originId:15,"preroll.pubId":133128,"preroll.pubTagId":779408,"midroll.pubId":133128,"midroll.pubTagId":779408,"postroll.pubId":133128,"postroll.pubTagId":779408,pubId:133128,pubTagId:779408,player:{settings:{mprdct:0,cmbopps:!1,encwfrs:!1,mntmbtwfs:999,mintimwf:999e3,mxtmbtwfs:999,time_between_waterfall:999,frrst1aftrrst93:!1,rmvrvlwntwrk:!1}},onOutOfView:"pause",isPWOV:!1,noaop:1}},2:{atr:{isDebug:!0,originId:15,"preroll.pubId":133128,"preroll.pubTagId":779408,"midroll.pubId":133128,"midroll.pubTagId":779408,"postroll.pubId":133128,"postroll.pubTagId":779408,pubId:133128,pubTagId:779408,player:{settings:{mprdct:0,cmbopps:!1,encwfrs:!1}},onOutOfView:"pause"}},3:{atr:{isDebug:!0,originId:15,"preroll.pubId":133128,"preroll.pubTagId":1184655,"midroll.pubId":133128,"midroll.pubTagId":1184655,"postroll.pubId":133128,"postroll.pubTagId":1184655,pubId:133128,pubTagId:1184655,player:{settings:{mprdct:0,cmbopps:!1,encwfrs:!1}},isPWOV:!1}},4:{atr:{isDebug:!0,originId:15,"preroll.pubId":133128,"preroll.pubTagId":1046821,"midroll.pubId":133128,"midroll.pubTagId":1046821,"postroll.pubId":133128,"postroll.pubTagId":1046821,pubId:133128,pubTagId:1046821,player:{settings:{mprdct:0,cmbopps:!1,encwfrs:!1}},onOutOfView:"pause"}},5:{atr:{originId:15,"preroll.pubId":133128,"preroll.pubTagId":1633025,"midroll.pubId":133128,"midroll.pubTagId":1633025,"postroll.pubId":133128,"postroll.pubTagId":1633025,pubId:133128,pubTagId:1633025,player:{settings:{mprdct:0,cmbopps:!1,encwfrs:!1}},onOutOfView:"pause",isPWOV:!1}}},level:{strength:1,atr:{},101:{atr:{pubId:165757,pubTagId:946347,preroll:{pubId:165757,pubTagId:946347},midroll:{pubId:165757,pubTagId:946347},postroll:{pubId:165757,pubTagId:946347}}},2:{atr:{secondsToClose:120,secondsBW:20}},3:{atr:{secondsToClose:120,pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981},midroll:{pubId:208401,pubTagId:1047981},postroll:{pubId:208401,pubTagId:1047981}},units:{FEED_MANAGER:et,INLINE_INSTREAM_OLD:et,INLINE_INSTREAM_VFORCE:et,SLIDER_INSTREAM:et,SLIDER_OUTSTREAM:et,WIDGET_ITEM:et}},4:{atr:{pubId:292045,pubTagId:1565025,preroll:{pubId:292045,pubTagId:1565025},midroll:{pubId:292045,pubTagId:1565025},postroll:{pubId:292045,pubTagId:1565025}}},5:{atr:{pubId:383725,pubTagId:2077655,preroll:{pubId:383725,pubTagId:2077655},midroll:{pubId:383725,pubTagId:2077655},postroll:{pubId:383725,pubTagId:2077655}}}},isFireAllPixels:{strength:101,atr:{},1:{atr:{pixels:{startWithABT:{isFire:!0},getAdAny:{isFire:!0},getAdNoRV:{isFire:!0},getAd:{isFire:!0},secondsToCloseTimer:{isFire:!0},secondsToCloseGlobalTimer:{isFire:!0},midrollCollapseTimer:{isFire:!0}}}},2:{atr:{pixels:{getAdAny:{isFire:!0},getAdNoRV:{isFire:!0},getAd:{isFire:!0}}}}},predictorsPresets:{strength:101,1:{atr:{predictors:{multiAd:{isActive:!0,predictPoints:{any:{qState:"q1"}}},playerReady:{isActive:!0,predictPoint:0},distancePixels:{isActive:!0,predictPoints:{1:{pixelsFromSelectors:10}}}}}},2:{atr:{predictors:{multiAd:{isActive:!0,predictPoints:{any:{qState:"q0"}}},playerReady:{isActive:!1},distancePixels:{isActive:!0,predictPoints:{1:{pixelsFromSelectors:10}}},firstScroll:{isActive:!0,predictPoints:[0,0]}}}},3:{atr:{predictors:{multiAd:{isActive:!0,predictPoints:{any:{qState:"q0"}}},playerReady:{isActive:!0,predictPoint:0},distancePixels:{isActive:!1},firstScroll:{isActive:!1}}}},4:{atr:{predictors:{multiAd:{isActive:!0,predictPoints:{any:{qState:"q1"}}},playerReady:{isActive:!0,predictPoint:0},distancePixels:{isActive:!1},firstScroll:{isActive:!1}}}},5:{atr:{predictors:{multiAd:{isActive:!1},playerReady:{isActive:!0,predictPoint:0},distancePixels:{isActive:!1},firstScroll:{isActive:!1}}}},99:{atr:{predictors:{autoKill:{isActive:!1},getAdFail:{isActive:!1},multiAd:{isActive:!1},playerReady:{isActive:!1},distancePercent:{isActive:!1},distancePixels:{isActive:!1},firstScroll:{isActive:!1}}}},101:{atr:{predictors:{multiAd:{isActive:!0,predictPoints:{any:{qState:"q1"}}},playerReady:{isActive:!0,predictPoint:0},distancePixels:{isActive:!0,predictPoints:{1:{pixelsFromSelectors:10}}}}}}},isDebug:{strength:102,1:{atr:{player:{settings:{encwfrs:!1}}}}}},it=n(999);ar nt=null,ot=const rt=new const at=var lt=n(999),dt={init:;ar ct=n(316),ut=n(999);const pt=var gt=n(999);cmTag.multiUnitManager=cmTag.multiUnitManager||new const mt=cmTag.multiUnitManager;var vt=n(120);ar bt=n(999),yt=n(316),_t=n(84);ar At=n(832);const Tt=var wt=n(84),Pt=".tbl-read-more-box";onst Ct=Et;var It=n(999),Rt=n(316),Ot=n(84);onst Dt=Nt;var xt=n(777);var Vt=n(84),Mt=n(999),Lt=n(316),Ft={title:"._cm-ad-title",placeholder:"._cm-inline-video"},Bt="tbl-data-mutation-observer";class kt extends xt.Z{bindEvents(){var e=[{event:"playerState:error",funcName:"close",isListenOnce:!0},{event:"closeState:closeUnit",funcName:"close",isListenOnce:!0},{event:"videoSize",funcName:"resize"}];this.model.get("foundUnitDimensions")?setTimeout(this.render.bind(this),0):e.push({event:"foundUnitDimensions:true",funcName:"render",isListenOnce:!0}),this.createStateHandlers(e)}render(){this.renderTemplate(),this._customize(),this.el.id="_cm-css-reset",this.$el.addClass("_cm-container-msn"),Vt(this.container).append(this.el),this.elHight=this.model.get("isHomePage")?this.model.get("placeHolderHeight"):this.model.get("height"),this.$el.css({width:this.model.get("width")+"px",height:this.elHight+"px",background:"transparent",position:"absolute",top:0,left:0,visibility:"visible"}),this.model.set("containerViewEl",this.el),this.placeholder=this.ui.placeholder[0],this.model.get("isHomePage")&&(this.placeholder=Vt("".concat(this.model.get("videoContainerSelector")," ._cm-components-holder"))[0]),this.model.set("containerViewPlaceHolder",this.placeholder),this.model.set("containerViewState",W.Z.containerViewState.rendered),this._calcPlaceholderSize()}rerenderElementProps(){this.elHight=this.model.get("isHomePage")?this.model.get("placeHolderHeight"):this.model.get("height"),this.$el.css({width:"".concat(this.model.get("width"),"px"),height:"".concat(this.elHight,"px"),transitionDuration:"0s"})}_prepareForHomePge(){Vt("".concat(this.model.get("videoContainerSelector")," ._cm-components-holder"),this.el).css({width:this.model.get("width")+"px",height:this.model.get("height")+"px",background:"transparent",position:"absolute",top:0,left:0,"pointer-events":"none"});var e=this.model.get("isTitleOnTop")?0:this.model.get("height");Vt("".concat(this.model.get("videoContainerSelector")," ._cm-background-filler")).css({width:this.model.get("width")+"px",height:this.elHight-this.model.get("height")+"px",background:this.model.get("backgroundFillerColor"),position:"absolute",top:e+"px",left:0,"pointer-events":"all"})}lose(){this.$el.hide(),this.model.set("closeState",W.Z.closeState.containerViewClosed)}repositionUnit(){if(this.model.get("eligiblePlaceholder")){var e=this._getCurrentPlaceHolder();this.extractCardInfo(e);var t=Mt.getOffset(e,this.model.get("offsetGetterType"));this.$el.css({top:t.top,left:t.left})}else this.createStateHandlers([{event:"eligiblePlaceholder",funcName:"repositionUnit",isListenOnce:!0}])}_getCurrentPlaceHolder(){var e=this.model.get("eligiblePlaceholder");return this.model.get("isHomePage")&&(e=this.model.get("msnCardToHide")),e}terminate(e,t){e&&Math.abs(t.heightChange)<this.model.get("allowedHeightChange")&&0===t.widthChange||(this.stopListening(Lt,"window:scroll:change"),this.model.set("closeState",W.Z.closeState.terminate))}_customize(){var e=this.model.get("customization.unitContainer"),t=this.model.get("customization.placeHolder");this.$el.css(Mt.toCssObj(e)),this.$el.height("auto"),this.ui.placeholder.css(Mt.toCssObj(t));var i=this.model.get("additionalCss");this.$el.css(Mt.toCssObj(i))}resize(){if(this.model.get("containerViewState")===W.Z.containerViewState.detached){var e=this.model.get("videoSize");this.ui.placeholder.css(e)}else this._calcPlaceholderSize()}_calcPlaceholderSize(){var e=Mt.getVideoBestSize(this.model.get("width"),this.model.get("height"));this.model.set("videoPlaceholderSize",e,{silent:!0}),this.model.get("isHomePage")?this._prepareForHomePge():(this.ui.placeholder.css(e),this.$el.css(e)),this.model.set("width",e.width),this.model.set("height",e.height),this.model.trigger("change:videoPlaceholderSize",this.model.get("videoPlaceholderSize"))}_calcPlaceholderPosition(){if(this.model.get("eligiblePlaceholder")){var e=this._getCurrentPlaceHolder(),t=Mt.getOffset(e,this.model.get("offsetGetterType"));this.model.get("containerViewState")!==W.Z.containerViewState.detached&&this.$el.css({top:t.top,left:t.left,right:"auto",bottom:"auto"}),this.model.set("videoPlaceholderPosition",{top:t.top,left:t.left}),this.model.trigger("change:videoPlaceholderPosition",this.model,{top:t.top,left:t.left})}}_initMutationObserver(){var e=this.model.get("mutationSelectorsArray");if(e){var t=Vt(e.toString());Mt.forEach(t,this._setMutationObserver,this)}}_setMutationObserver(e){if(e&&!e.getAttribute(Bt)){var t=Mt.throttle(this._calcPlaceholderPosition.bind(this),100),i=new MutationObserver(t);e.setAttribute(Bt,!0),i.observe(e,{attributes:!0,childList:!0,characterData:!0,subtree:!0,attributeOldValue:!0})}}ractCardInfo(e){var t=0,i=0,s=0,n=Vt(this.model.get("msnSelector"));for(var o in n)if(i++,n[o]===e){t=i;break}if(t){var r=Vt(this.model.get("eligiblePlaceholder")).height()+this.model.get("MSNRowPadding"),a=Mt.convertRem(parseFloat(e.parentElement.style.top));s=parseInt(a/r)+1}else s=1;this.model.set("MSNCard.placementIndex",t),this.model.set("MSNCard.row",s)}}const Ut=kt;var zt=n(316),Ht=n(84),jt=n(999);onst Zt=Wt;var Gt=n(84),qt=n(316);const $t=class extends Zt{constructor(e){super(e.model,e.globalModel),this.model=e.model,this.log=new S.Z({unitType:"Service",className:this.constructor.name,version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.selector=e.selector,this.placeHolders=Gt(this.selector),this.bindEvent(),this._startObservation()}startObservation(){this.model.get("isUseObserver")?(this._initObserver(),this._registerObserverListeners(this.placeHolders)):this._initEligibilityListener()}_onTabEvent(){this.model.get("isInTab")?this._calculateEligibility():this.model.set("isEligibleToPlay",!1)}bserverCallback(e,t){this.inViewDiv=void 0;for(var i=0;i<e.length;i++)if(this.model.set("isViewable100",100*e[i].intersectionRatio>=this.model.get("100viewPercent")),e[i].intersectionRatio>=this.model.get("viewPercent")/100){this.inViewDiv=e[i];break}this._testEligibility()}_testEligibility(){this.inViewDiv?(this.model.set("isEligibleToPlay",!0),this.model.get("firstTimeEligibility")||this.model.set("firstTimeEligibility",!0)):this.model.set("isEligibleToPlay",!1)}pdateSelector(e){this.selector=e,this.placeHolders=Gt(this.selector)}};const Yt={"AR-EG":"إعلان","AR-AE":"إعلان","AR-SA":"إعلان","CS-CZ":"Reklama","DA-DK":"Annonce","DE-DE":"Anzeige","DE-AT":"Anzeige","DE-CH":"Anzeige","EL-GR":"Ad","EN-AE":"Ad","EN-AU":"Ad","EN-CA":"Ad","EN-GB":"Ad","EN-IE":"Ad","EN-IN":"Ad","EN-SG":"Ad","EN-PH":"Ad","EN-MY":"Ad","EN-NZ":"Ad","EN-US":"Ad","EN-ZA":"Ad","EN-XL":"Ad","ES-ES":"Publicidad","ES-AR":"Patrocinado","ES-CO":"Patrocinado","ES-CL":"Patrocinado","ES-PE":"Patrocinado","ES-MX":"Patrocinado","ES-US":"Patrocinado","ES-XL":"Patrocinado","ES-VE":"Patrocinado","EN-ID":"Ad","FI-FI":"Mainos","FR-FR":"Sponsorisé","FR-BE":"Sponsorisé","FR-CA":"Pub","FR-CH":"Sponsorisé","HE-IL":"מודעה","HI-IN":"एड","HU-HU":"Hird.","ID-ID":"Ad","IT-IT":"Ann.","JA-JP":"PR","KO-KR":"AD","NB-NO":"Annonse","NL-NL":"Adv","NL-BE":"Adv","PL-PL":"Reklama","PT-BR":"Publicidade","PT-PT":"Pub","RU-RU":"Реклама","SV-SE":"Annons","TH-TH":"Ad","TR-TR":"R","VI-VN":"Ad","ZH-CN":"广告 ","ZH-TW":"廣告","ZH-HK":"廣告"};var Kt=n(316),Qt=n(999),Xt=n(84);const Jt=Kt.View.extend({events:{click:"_openener&&this._setComponentsVisibilityListeignTitle(),sExpandEnded",ndow.setTimeout((function(lt:t={text:"",stylontent-sponsore._cm-ad-cho("componentsntainer).css("text-align",OICE_TYPE.TITLE&&thisW.Z.video;case _.zhis._show()}tTRC.aboutUar i=),thi),this._validateComponentVisibilitodel.set(this.componentsViD_CHOICE_TYPE.TITLE?this._hideViewState():this.er).removeClasYt[this.model.get("language").toUpperCase()])},_setComponentsVisibilityListener(){this.listenTo(this.model,"change:".concat(this.componentsVisibilityListener),this._onComponentsVisibilityChange.bind(this)),this.model.get(this.componentsVisibilityListener)||this._hide()},_onComponentsVisibilityChange(){this.model.get(this.componentsVisibilityListener)?this._show():this._hide()}});var ei=n(72);var ti=n(316),ii=n(999),si=n(84);const ni=ti.View.extend({className:"_cm-close-area",id:"_cm-close-area",events:{"click ":"_onClick"},initialize:function(e){this.log=new S.Z({unitType:e.unitType,className:"closeButtonView",version:e.model.get("version"),isDebug:e.model.get("isDebug")}),this.container=e.container,this._rendered=!1,this._bindEvents(),this.createStateHandlers=ei.L,this.componentsVisibilityListener=e.componentsVisibilityListener,this.componentsVisibilityListener&&t.get("videoViewState")?this.shose-area"),thge:videoVienderTimeoger("ad:stoppedYING&&t!==W.Z.adState.pld":this.show();break;case"attached":this.hide()}},_setComponentsVisibilityListener(){this.listenTo(this.model,"change:".concat(this.componentsVisibilityListener),this._onComponentsVisibilityChange.bind(this)),this.model.get(this.componentsVisibilityListener)||this.hide()},_onComponentsVisibilityChange(){this.model.get(this.componentsVisibilityListener)?this.show():this.hide()},hide:function(){this.$el.hide()},show:function(){this.$el.show()}});var oi=n(316),ri=n(999);const ai=oi.Vieistenerip-ad-area"}r.appendC,this.model.increaseCounter("ski(this.componentsVisibilityListener)||this.hide()},_onComponentsVisibilityChange(){this.model.get(this.componentsVisibilityListener)?this.show():tthis.$el.hide()},show:function(){this.$el.show()}});var li=n(316),di=n(999),hi=n(84),ci={display:"inline !important"},ui={display:"none !important"},pi={transition:"width 2000ms !important",width:"32px !important"},gi={width:"32px !important"};const mi=li.View.extend({className:"_cm-volume-area",id:"_cm-cser(),this.l"showVolumeButtonOnBackFromSwap"(this.this._checkIfdText}}</div> </.append(this.el)}),20isibilityListenel.get("volumeMuted")&&this.his._minimizeOnClick=dihis,pi))},_onzeOnClick(),this.currModel.set("volumeUserInteraction",!0)},_mute(){tute(){this._hideMute(),this._showUnmute(),this._isMuted=!1},_fireMute(){this.currModel.set("volumeMuted",!0),this.currModel.set("onUnMuteClicked",!1)},_fireUnmute(){this.currModel.set("volumeMuted",!s.currModel.get("vols._minimiinimized=!0,this.currModel.set("volumeMustBeMinimized",!0)},_hideMute(){hi("#_cm-css-reset._cm-volume-area > ._cm-volume-border > ._cm-volume-mute").css(ui)},_showMute(){hi("#_cm-css-reset._cm-volume-area > ._cm-volume-border > ._cm-volume-mute").css(ci)},_hideUnmute(){hi("#_cm-css-reset._cm-volume-area > ._e-area > ._crea-top"),this.("detachToSlideS.SLIDER_INSTREAM,thirea-bottom"),this.$order > ._cm-volu&this.currModel..FLOATING_VIEW_TOP_COMPONENT.video?this.show():this.hide()},hide(){this.$el.hide()},show(){this.$el.show()},_createStatesAction:function(){this.adStateActions={q0:this.show.bind(this),completed:this.hide.bind(this),repeating:this.show.bind(this)}},_onAdStateChange:function(e,t){var i=this.adStateActions[t];i&&i()},_onComponentsVisibilityChange(){this.currModel.get(this.componentsVisibilityListener)?this.show():this.hide()}});const vi={JP:!0};var fi=n(316),bi=n(84),yi=n(999);const _i=fi.View.eis._cre.append(this.r,s,e,t),this.repemodel,"change:adCli("language")&)]},_setButtonrepeang=!1e=!0,this.mostenTo(th",W.Z.repeatState.clomplete.bind(thisteChange:funconAdPlaying:functplete:function(){rl")),this.model.inonLearnMoreClick.bind(this)),this.learnMoreWrapper.show())},addAdditionalCss(e){bi(this.repeatEl).addClass(e)}});var Si=n(84),Ai=n(999),Ti="_cm-native-ad",wi={title:"._cm-native-ad-title",ctaButtone:"._cm-native-ad-cta-button",description:"._cm-native-ad-description",icon:"._cm-native-ad-icon",branding:"._cm-native-ad-branding",adChoice:"._cm-ad-choice",placeholder:"._cm-feed-urn this.UI?this.UI:this.UI=wi}setticalOrn function(t){return e||(e=erOptions:this.detachToSlider,isVerticalSlideOut:t,cb:i})}}const Vi=xi;const Mi=n(316).View.extendered=ponents.discodel,"change:videoViewStponents.disclosureText.isActive")?thisd(this.disclosur",(t=>{var i=this.reportingObserver.takeRecords();e(i)}))}}var Bi=function(){var e;return function(t){return [e]}stopObserlity100(){to||(this.cache[n]=o=new n({model:t,onViewability:s})),o}}var $i=n(999),Yi=$i.now().toString(),Ki=function(){this.activeAd&&(this.this.activeAd.mute(),this.c("post_repeat"),this.repeatingAd=null,this.activeAd=null)}}const es=Ji;var ts=n(999),is=n(84);const ss=class extends es{constructor(e){super(e,"RecoReelSubUnitVideoView",e.globalModel),this.activatedRecoReel=!1,this.waitingForStartDelay=!1,this.model=e.model,this.globalModel=e.globalModel,this.model.set("adsCount",0),this._startView()}_bindEvents(){this.createStateHandlers([{event:"videoPlaceholderSize",funcName:"resize",withBind:!1},{event:"videoPlaceholderPosition",funcName:"_onVideoPlaceholderPositionChange",withBind:!1},{event:"containerViewState:rendered",funcName:"render",isListenOnce:!0},{event:"adState:completed",funcName:"onAdComplete"},{event:"skipButtonClicked",funcName:"_skipButtonClicked"},{event:"repeatState:clicked",funcName:"_onLoadingClick"},{event:"adState:repeating",funcName:"playAd"}]);var e=this.model.get("isMultiAd")&&!this.model.get("isPlacementSingleAd");this.model.get("isForceSwapToRV")&&e&&(this.currModel.on("change:hasReadyAd",this.onGotRVAd.bind(this)),this.currModis.model.set("videoViewState",W.Z.videoViewState.rendered)}_startView(){this.subUnitId=this.model.get("subUnitId"),this.isFirstCickle=!0,this._getAd()}_getAd(){if(this.model.get("isEligibleToPlay")){if(this._prepareAd(),this.isMidRoll()&&!this.isAdjacencyAd()&&!this.activatedRecoReel)return this._activeRecoReel(),void this._waitForStartDelay();this.potentialAd?(this.isFirstCickle&&(this.isFirstCickle=!1,this._startAd()),this.model.get("isWaitForRcoReelStartEvent")||this.waitForRecoReel||this._startAd()):(this.model.set("waitingForAd",!0),this._startListenToNewAd())}else this._waitForEligibility()}_waitForStartDelay(){var e=this.globalModel.get("player.settings.startDelay");e>0?(this.waitingForStartDelay=!0,setTimeout(this._otartDelayDone(){this.waitingForStartDelay=!1,this._getAd()}isAdjacencyAd(){return!!this.model.get("isAdjacInFirstWF")||!!this.||(this.potentialAd=this.model.getReadyAd(this.subUnitId))}_waitForEligibility(e){this.createStateHandlers([{event:"isEligibleToPlay:true",funcName:"_getAd",isListenOnce:!0}])}_startAd(){this.globalModel.get("cardNumber")||this.globalModel.set("cardNumber",this.globalModel.get("recoReelIndex")+.5),this.waitForRecoReel=!0,ts.recoReelPlayStateAnimation(this.globalModel.get("recoReelContainer"),this.globalModel.get("recoReelIndex"),"paused"),this.model.set("recoReelPaused",!0),this.model.set("waitingForAd",!1),this.model.set("isAdActive",!1),this.globalModel.get("isReplayAd")&&this.model.get("isAdjacInFirstWF")?this.model.set("isReplayAd",!0):this.model.set("isReplayAd",!1),this.isViewed=!1,this.checkEligible(),this.show(),this.model.set("waitingForAd",!1),this.potentialAd&&this._setAd(this.potentialAd)}_setAd(e){var t;this.el=e.vpaidWrapper.adTarget,this.isCurrentAdRV=e.adData.requiredViewability,this.globalModel.get("volumeMuted")||"iOS"!==(null===(t=this.ua)||void 0===t?void 0:t.os.name)||this.globalModel.set("volumeMuted",!0),this.$el=is(this.el),this.activeAd=e,this.$el.addClass("_cm-video"),this._setVolumeEvents(),this.model.set("videoViewContainer",this.$el),this.activeAd.setSubModel(this.model),this.model.set("isAdActive",!0),this.model.increaseCounter("adsCount"),this.globalModel.increaseCounter("totalAdsUsed"),this._switchToActiveAd("set ad"),this.potentialAd=void 0}_switchToActiveAd(){if(this.$el.removeClass("_cm-ad"),this.$el.addClass("_cm-ad-active"),this.$el.addClass("_cm-video-reco-reel"),this.model.get("videoViewState")!==W.Z.videoViewState.detached){var e={width:this.globalModel.get("width"),height:this.globalModel.get("height")};this.resize(e),this._rePosition()}this.checkEligible()}_startListenToNewAd(){this.createStateHandlers([{event:["isEligibleToPlay:true","hasReadyAd:true","waitingForAd:true"],funcName:"_getAd",isListenOnce:!0}])}resize(e){this.log.info("resize sizeObj: ",e),this.$el.css(e),this.activeAd&&this.activeAd.vpaidWrapper&&this.activeAd.resize(e)}_rePosition(){this.model.get("eligiblePlaceholder&&this.$el.css(this.model.get("videoPlaceholderPosition"))}checkEligible(){this.isEligibleToPlay()?(this.activeAd||this.getReadyAd(),this.activeAd&&(this.hadPossibleRV&&(this.onGotRVAd(),this.hadPossibleRV=!1),this.log.info("Play Ad sub unit: ".concat(this.subUnitId,"  ad: ").concat(this.activeAd.adId,"  advType: ").concat(this.activeAd.adData.advType)),this._playAd(),this.model._updateCrossUnitCommunication({unit:this.model.get("unitType"),state:W.Z.externalUnit.playing}))):(this.pauseAd(_.z.PAUSE_REASONS.LOST_ELIGIBILITY),this.globalModel.get("isInTab")&&this.model._updateCrossUnitCommunication({unit:this.model.get("unitType"),state:W.Z.externalUnit.stopped}))}isEligibleToPlay(){return this.model.get("videoViewState")===W.Z.videoViewState.detached||this.model.get("isEligibleToPlay")}_playAd(){this.model.get("isToggleIframeContent")&&this.activeAd.vpaidWrapper.toggleIframeContentDisplay&&this.activeAd.vpbUnitId+" ad:"+this.activeAd.adId),this.activeAd.pause(e))}getReadyAd(){if(this.globalModel.get("hasReadyAd")){var e=this.globalModel.getNextAd();if(!e)return;this.globalModel.get("lastAdID")||this.globalModel.set("lastAdID",e.adId),this.log.info("Video View Got new ad of type : "+parseInt(e.adData.requiredViewability?"1":"0"),e),this._switchFromActiveAd("getReadyAd"),this._setAd(e),this.activeAd.setSubModel(this.model),this.postGetAd()}else this.log.warning("Could not find ad"),this.watingForAd=!0,this.globalModel.once("change:hasReadyAd",this.hasReadyAdChangeSubUnit.bind(this))}onAdComplete(){if(this.model.get("isReplayAd"))return this.setRepeatingAd(),void(this.activeAd=void 0);this._switchFromActiveAd(),this.activeAd=void 0,this.model.set("waitingForAd",!0),this.model.set("isAdActive",!1),this._activeRecoReel(),this.isPlayNextAd()&&!this.potentialAd&&(ctRatioNum",this.activeAd.aspectRatioNum),this.postGetAd()}_skipButtonClicked(){this.activeAd.skipAd(),this.model.set("isReplayAd",!1),this.onAdComplete()}_activeRecoReel(){var e=this.globalModel.get("recoReelIndex");this.activatedRecoReel=!0,this.$el.css({display:"none !important"}),this.model.increaseCounter("hideUnit"),ts.recoReelPlayStateAnimation(this.globalModel.get("recoReelContainer"),e,"running"),this.model.set("recoReelPaused",!1),this._registerRecoReelStartStoryEvent()}_registerRecoReelStartStoryEvent(){this.recoReelContainer||(this.recoReelContainer=this.model.get("recoReelContainer"),this.animationStartEvent=TRC.dom.detectAnimationEvent(this.recoReelContainer,"start"),TRC.dom.on(this.recoReelContainer,this.animationStartEvent,(e=>this._onRecoReelStartEvent(e))))}_onRecoReelStartEvent(e){if("tbl-animation-progress-bar"===e.animationName){this.model.get("isWaitForRcoReelStartEvent")||(this.waitForRecoReel=!1);var t=e.target.parentElement,i=Number(t.dataset.progressBarIndex);this.globalModel.set("recoReelIndex",i),this.globalModel.set("cardNumber",i+.5),this.potentialAd&&!this.waitingForStartDelay&&this._startAd()}}isMidRoll(){return this.globalModel.get("midrollRecoReel")}isPlayNextAd(){return(!this.globalModel.get("maxAds")||this.globalModel.get("totalAdsUsed")!==this.globalModel.get("maxAds"))&&(!this.model.get("maxAdsPerCard")||this.model.get("maxAdsPerCard")!==this.model.get("adsCount"))}terminate(){this.log.info("terminate sub unit subUnitId:",this.subUnitId),this.$el&&(this.activeAd&&(this.activeAd.pause(_.z.PAUSE_REASONS.UNIT_TERMINATED),this._switchFromActiveAd()),this.$el.remove(),this.close(),this.model.get("recoReelPaused")&&ts.recoReelPlayStateAnimation(this.globalModel.get("recoReelCol.addClass("_cm-ad"),this.$el.removeClass("_cm-ad-active")}close(){this.hide(),this.model.set("closeState",W.Z.closeState.videoViewClosed)}getEl(){return this.el}getSelectedEl(){return this.$el}_onLoadingClick(){this.$el[0].id=this.videoAdId,this.replayAd()}};var ns=n(84),os=n(999);const rs=class extends Vi{constructor(e){super(e),this.model=e.model,this.globalModel=e.globalModel,this.log=new S.Z({unitType:this.model.get("unitType"),className:this.constructor.name,version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.init()}init(){this.detachUtil=new oe(this.model),this.componentsConfig=this._getComponentConfiguration(),this._onSubUnitStart(),this._bindEvents()}_getComponentConfiguration(){return{CloseButtonView:{module:ni,options:this.baseOptions,isActive:this.model.get("closeButton.hasCloseButton"),isVisibleOnLoad:!1,afterLoad:()=>{this.components.CloseButtonView.render()}},SkipAdButtonView:{module:ai,options:this.baseOptions,isActive:this._should1,afterLoad:()=>{this.components.SkipAdButtonView.render()}},AdChoiceView:{module:Jt,options:this._cloneAndExtend(this.baseOptions,{type:_.z.AD_CHOICE_TYPE.VIDEO_AD}),isActive:this.model.get("components.adChoice.isActive"),isVisibleOnLoad:!1},VolumeButtonView:{module:mi,options:this._cloneAndExtend(this.baseOptions,{globalModel:this.globalModel}),isActive:this.model.get("components.volume.isActive"),isVisibleOnLoad:!1},NativeAdView:{module:Ei,options:this._cloneAndExtend(this.baseOptions,{globalModel:this.globalModel,model:this.model,container:"".concat(this.model.get("videoContainerSelector")," ._cm-background-filler")}),isActive:this.model.get("components.nativeAd.isActive"),isVisibleOnLoad:!1},RepeatView:{module:_i,options:this.baseOptions,isAct{event:"repeatState:clicked",funcName:"_onew=new ss({model:this.model,globalModel:this.globalModel})}terminate(){this.log.info("terminate"),this._hideLoadingView();var e=this.model.get("componentVisibility");for(var t in e)e[t]=!1;this.mocomponents.LoadingView&&this.components.LoadingView.hide()}_terminateVideoView(Out(),this.model.set("detachToSlider.isDetachToSlider",!1)}showCloseButton(){if(this.model.get("videoViewState")!==W.Z.videoViewState.detached&&!this.model.get("closeButton.hasCloseButton"))return!1;this.components.CloseButtonView?this.components.CloseButtonView.show():(this.components.CloseButtonView=new ni({model:this.model,container:this.container)===W.Z.videoViewState.detached&&this.checkVideoLocation()}checkVideoLoc.checkEligible()}canAttach(){return!1}canDetach(){return!1}_isDetachAvailable(){return!!this.videoView&&(this.model.get("msnCardToHide").getBoundingClientRect().top>0?this.model.get("detachToSlider.isDetachAbove"):this.model.get("detachToSlider.isDetachBelow"))}getIsDetached(){return this.isDetached}handleAttach(e){if(this.videoView){var t=this.model.get("videoPlaceholderPosition");if(!isNaN(t.top)){this.log.info("Attaching");var i=this.videoView.getSelectedEl();i.css({outlineStyle:"solid"}),this.attach(i,t,e),this.videoView.resize(this.model.get("videoPlaceholderSize")),this.model.set("videoViewState",W.Z.videoViewState.attached);var s=ns(this.model.get("containerViewEl"));this.attach(s,t,e),this.model.set("containerViewState",W.Z.containerViewState.attached),this.model.set("videoSize",this.model.get("videoPlaceholderSize")),this.isDetached=!1,this.model.get("closeButton.hasCloseButton")&&this.showCloseButton()}}}handleSlideOut(){if(this.isDetached){var e=this.videoView.getSelectedEl();this.slideOut(e,!1);var t=ns(this.model.get("containerViewEl"));this.slidethis.model.set("componentVisibility.SkipAdButtonView",!0)}_hideComponents(){this._hideActiveComponents(),ns("".concat(this.model.get("videoContainerSelector")," ._cm-background-filler")).hide(),this.model._updateCrossUnitCommunication({unit:oneAndExtend(e,t){var i=os.clone(e);return os.extend(i,t)}_onAdComplete(){this.model.get("isReplayAd")&&(this.components.RepeatView.show(),this._hideComponents(),ns("".concat(this.model.get("videoContainerSelector")," ._cm-background-filler")).show(),this.limitRepeatSliderByTimer=setTimeout(this._closeRepeatByTimer.bind(this),this.model.get("limitRepeatSliderTimerBySec")||5e3))}_closeRepeatByTimer(){this.components.RepeatVieSliderByTimer&&clearTimeout(this.limitRepeatSliderByTimer)}_shouldDisplaySkipAdButtonComponent(){return!this.model.isHipMode()&&this.model.get("components.skipAdButton.isActive")}};const as=class extends Dt{constructor(e){super(e),this.globalModel=e.globalModel,this.model=e.model,this.model.set("renderWasCalled",!1),this.container=e.container,this._init(e)}_init(e){this._createEligibility(e),this._bindEvents(),this.containerView=new Ut({model:this.model,container:this.container}),this._checkBelowTopOfViewPort(),this.containerView.repositionUnit(),this.model.get("isEligibleToPlay")&&this._updateGlobalSubUnitEligibility(),this.isSliderEnabled=this.model.get("detachToSlider.isDetachToSlider"),this.setSliderGlobalFlags(this.isSliderEnabled)}_createTimers(){if(this.model.get("midrollCollapse.isActive")&&this.model.get("isMultiAd")&&this.model.get("midrollTimeout")>0){this.getAdTimer=new Tt(this.model,{startCondition:{stateToListen:!1,state:"isAdActive"},stopCondition:{stateToListen:!0,state:"isAdActive"}},this.terminate.bind(this,!1,"midrollCollapse"),1e3*this.model.get("midrollTimeout"))}}_createEligibility(e){this.model.get("isHomePage")||this.model.get("msnCardToHide");this.eligibility=new $t({model:this.model,selector:this.model.get("msnCardToHide"),globalModel:e.globalModel})}_bindEvents(){this.createStateHandlers([{event:"containerViewPlaceHolder",funcName:"_initComponentsManager",isListenOnce:!0},{event:"progressLoaderTimerReached:true",funcName:"_stopByAdProgressTimer"},{event:"isEligibleToPlay",funcName:"_updateGlobalSubUnitEligibility"},{event:"closeState",funcName:"handleCloseState"},{eventerElementProps(),this.containerView._calcPlaceholderSize()}setSliderGlobalFlags(e){this.globalModel.set("subUnitSliderEnabled",e)}_initComponentsManager(){this.componentManager=new rs({model:this.model,container:this.model.getis.globalModel})}updateLocalModel(e,t){this.model.set(e,t)}_updateGlobalSubUnitEligibility(){this._checkBelowTopOfViewPort(),this.globalModel.set("subUnitIsEligibleToPlay",this.model.get("isEligibleToPlay"))}terminate(e,t){this.isTerminating||(this.setSliderGlobalFlags(!1),e&&this.componentManager.getIsDetached()?this.componentManager.terminateSlider():(this.isTerminating=!0,this._setTimerReason(t),this.componentManager.terminate(),this.containerView.terminate(),this.containerView.close(),this.globalModel.set("belowTopOfViewPort."+this.model.get("subUnitId"),!1),this.globalModel.set("subUnitIsEligibleToPlay",!1),this._stopListening(),this.globalModel.set("closedSubUnitId",this.model.get("subUnitId"))))}repositionSubUnit(e){this.model.set("msnCardToHide",e.cardToHide),this.model.set("additionalCard",e.additionalCard),this.model.set("eligiblePlaceholder",e.cardToHide),this.containerView.repositionUnit(),this.eligibility.updateSelector(e.cardToHide),this.model.set("Prog)}handleCloseState(){this.terminate(!1,"handleCloseState")}_stopListening(){this.model.off()}_checkBelowTopOfViewPort(){var e=this.model.get("msnCardToHide").getBoundingClientRect().top>0;this.globalModel.set("belowTopOfViewPoretPosifunction(){var e;return function(){retCurrCount")>=this.model.get("playPriority.loaILITY),this.model.fireCancelGetAdOnEligibilpixels.onMaxNonRvVimpsInQueue"),"ovaMediaPlayerLe){thition(){var e;return function(t){return e||(e=ne}),this.model.set("closeState",W.Z.closeStayer.updateWfParameter&&this.player.updateWfParamer(e),this._init()}_onPlayerReady(){super._onPlayerReady()}getTarget(){if(this.model.get("targetId"))return this.model.get("targetId").toString();if(this.model.get("isVpaidNoContainerMode"))return this.model.get("videoContainerSelector")?this.model.get("videoContainerSelector").toString():"body";var e=Hs.now().toString(),t=js("<div>");t.attr("id",e);var i=0,s=js("body");if(s.length>0&&this.model.get("isPlayerOutOfViewport")){var n=s[0].getBoundingClientRect();i=window.innerHeight+-1*n.top+100}this.model.set("topOffsetPosition",i),t.css({width:this.model.get("width")+"px",height:0,position:"absolute",top:i+"px",left:0}),t.addClass("_cm-ad-feed-msn");var o=this.model.get("additionalCss");if(o){var r=o["z-index"]||o.zIndex;r&&t.css({"z-index":r})}var a=this.model.get("videoContainerSelector")||"body";return t.appendTo(a),this.playerDiv=t,e}resize(e,t){var i=t||e;this.lastSize=this.lastSize||{},this.lastSize.width===i.width&&this.lastSize.height===i.height||this.player&&this.player.resize&&i&&i.width&&i.height&&(this.lastSize=Hs.extend({},i),this.player.resize(i.width,i.height),this.log.info("player was resize",i))}_canGetAdjacCard(){return!0}_onFirstAdPlay(){this._dropFromPlayer()}_onLostHipMode(){this._dropFromPlayer()}_dropFromPlayer(){this.alreadyDrop||(this._dropAdFromPlayer(fs.B.singleAd.playerType),this.log.info("dropping single ads from player Q"),this._dropAdFromPlayer(fs.B.adjacency.playerType),this.log.info("drop adjas.model.get("predictors.".concat(e,!!this.shouldConsiderBlurAsTabOut&&e===_.z.TubVideoInViewHook=this.model.get("isPubVideoInViewHook"))}}const sn=tn;var nn=n(84),on=n(999),rn=n(316);class an extends At.Z{constructor(e){super(e),this.model=e.model,this.model.set("isMultiActiveAds",!0),this.model.set("player.settings.isMultiVpaidUnit",!0),this.model.set("belowTopOfViewPort",{}),this._setSubUnitType(),this.log=new S.Z({unitType:this.model.get("unitType"),className:this.constructor.name,version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.initReasons={cardReturn:0,recoReelEvent:1},this.model.set("recoReelIndex",0),this._handleAboveFeedBehavior(),this._handleSelector(),this._registerRecoReelStartStoryEvent(),this._init()}_handleSelector(){var e=this.model.get("placement");e=e.replace(" - Video","");var t="[data-placement-name='".concat(e,"' ]"),i="".concat(t," ").concat(this.model.get("msnSelector"));this.model.set("msnSelector",i),this.recoReelContainer=document.querySelector("".concat(t," .story-widget")),this.model.set("recoReelContainer",this.recoReelContainer),this.isAboveFeed&&this.model.set("aboveFeedSelector",t)}_checkTextTermination(){return!(!this.model.get("enableRecoReelTextTermination")||!this._isTextExistInContainer())&&(this.terminate("SCTextTermination"),!0)}_isTextExistInContainer(){var e=this.model.get("recoReelTextTermination");if(e)return e.some((e=>this.recoReelContainer.innerText.toLowerCase().includes(e.toLowerCase())))}_init(){this.initialModel=nn.extend(!0,{},this.model),this.subUnitsControllers={},this.controllersIndex=0,this.model.set("subUnitIsEligibleToPlay",!1),this.windowEventManager=Je(),this._handleReporting(),this._checkTextTermination()||(this._bindEvents(),this._createTimers(),this._getUnitDimensions(),this._servicesLoader(),this.model.get("isHipMode")&&(this._bindHipEvents(),this._locAdjacMode()),this._handleMidArticleReadMore(),this._getCard("starting unit"),this._bindDetachAttachSliderEvents())}_handleAboveFeedBehavior(){this.model.get("isRecoReelAboveFeed")&&(this.model.set("parentSelector",this.model.get("aboveFeedSelector")}_handleReporting(){this.pixelsService=new Cs(this.model)}_bindEvents(){this.createStateHandlers([{event:"hasReadyAd",funcName:"_onHasReadyAdChange"},{event:"hasReadyAd:true",funcName:"_onHasReadyAdFirstTime",isListenOnce:!0},{event:"isInTab",funcName:"_onTabStateChange"},{event:"closeState",funcName:"handleCloseState"},{event:"closedSubUnitId",funcName:"_handleSubUnitClose"},{event:["playerState:ready","isEligibleToPlay:true","isHipsToCloseGlobalTimer(),this._createSecondsToPassbackTimer()}_createSecondsToCloseGlobalTimer(){this.secondsToCloseGlobalTimer&&this.secondsToCloseGlobalTimer.stop(this.model,void 0,{},!0);var e=this.model.get("secondsToCloseGlobal");if(e>0){this.secondsToCloseGlobalTimer=new Tt(this.model,{startCondition:{stateToListen:"",state:""}},this.terminate.bind(this,"secondsToCloseGlobal"),1e3*e),this.secondsToCloseGlobalTimer.start(this.model,"")}}_createSecondsToCloseTimer(){var e=this.model.get("secondsToClose");if(e>0){var t={startCondition:{stateToListen:!0,state:"firstGetAdFired"},stopCondition:{stateToListen:W.Z.adQState.impression,state:"adQState"},isStartOnce:!0};this.secondsToCloseTimer=new Tt(this.model,t,this.terminate.bind(this,"secondsToClose"),1e3*e)}}_createSecondsToPassbackTimer(){if(this.model.get("secondsToPassback")){this.passBackTimer=new Tt(this.model,{startCondition:{stateToListen:"",state:""},stopCondition:{stateToListen:!0,state:"isFirstAdLoaded"}},this._triggerPassback.bind(this,"Passback"),1e3*this.model.get("secondsToPassback")),this.passBackTimer.start(this.model,"")}}_calculateElementDimentions(e){if(!e)return this.pixelsService._onRecoReelNotFound(),void this._waitForMsnRiverToLoad();this.dimensions=this.positionAndSizeUtil.getSize(e),this.dimensions.width=Math.ceil(this.dimensions.width),this.dimensions.height=Math.ceil(this.dimensions.height),this.model.set("width",this.dimensions.width),this.model.set("placeHolderHeight",this.dimensions.height),this.model.get("isHomePage")?this.model.set("height",on.getVideoHeight(this.model.get("width"))):this.model.set("height",this.dimensions.height),this.initialModel.set("width",this.dimensions.width),this.initialModel.set("height",this.dimensions.height),this.initialModel.set("placeHolderHeight",this.dimensions.height),this._propagateStateToSubModels("width",this.dimensions.width),this._propagateStateToSubModels("height",this.dimensions.height),this._propagateStateToSubModels("initialModel",this.dimensions.height),this.model.set("foundUnitDimensions",!0),this.initialModel.set("foundUnitDimensions",!0),this._propagateStateToSubModels("foundUnitDimensions",!0)}_getUnitDimensions(){this.positionAndSizeUtil=new us;var e=document.querySelector(this.model.get("msnSelector"));this._calculateElementDimentions(e),this._createUnitContainer(e)}_waitForMsnRiverToLoad(){rn.once("winr=new Rs(this.model),this.playerService=new Ws(this.model)}_servicesLoader(){var e;this.eligibility=new $t({model:this.model,selector:null!==(e=this.model.get("aboveFeedSelector"))&&void 0!==e?e:this.model.get("msnSelector")}),this.tabStatusService=new Qs(this.model),this.model.get("isDetectPubVideo")?(this.pubVidDetector=new sn(this.model),!this._isDelaySeer()||this.model.get("isNoPubVideoInView")?this._startDelayedServices():this.createStateHandlers([{event:"isNoPubVideoInView",funcName:"_startDelayedServices",isListenOnce:!0}])):this._startDelayedServices()}_startDelayedServices(){this.adsManager||(this.adsManager=new As(this.model)),this.seerService||(this.seerService=new qs({model:this.model,onPredictCallback:this.adsManager.adPredict.bind(this.adsManager)}))}_isDelaySeer(){var e,t=nn(this.model.get("msnOrganicVidSelector"))[0],i=this.model.get("msnVideoAttribute");if(t){var s=JSON.parse(t.getAttribute(i));e=s&&s.sliderAttribute}return this.pubVidDetector.isPublisherVideoDetected()||e}_setSubUnitType(){var e=this.model.get("publisherModeConfig"),t={isRecoReelEnableRboxSlider:!!(e&&window.TRCImpl&&window.TRCImpl.modes&&window.TRCImpl.modes[e])&&window.TRCImpl.modes[e]["recommendationReel-enable-slider"],isRecoReelStartFromRboxSlider:!!(e&&window.TRCImpl&&window.TRCImpl.modes&&window.TRCImpl.modes[e])&&window.TRCImpl.modes[e]["recommendationReel-slider-start-from-slider"]};this.model.set("subUnitType",on.getRecoReelSubUnitType(t))}_createSubModel(){var e=nn.extend(!0,{},this.initialModel);return e.set("subUnitId",this.controllersIndex),e.set("subUnitType",this.model.get("subUnitType")),e.getReadyAd=this._getReadyAd.bind(this),e.set("unitType",e.get("unitType")+" "+e.get("subUnitId")),e}_onHasReadyAdChange(){this._bindOnResizeEvents(),this._propagateStateToSubModels("hasReadyAd",this.model.get("hasReadyAd"))}_onHasReadyAdFirstTime(){this._initNewSubUnit(this.initReasons.recoReelEvent),this.isAboveFeed&&on.dispatchTRC("showVideoRecoReel",this.model)}_bindDetachAttachSliderEvents(){TRC.listen("tbl-recommendation-reel-slider-open",this._onResizeRecoReelSlider.bind(this,!0)),TRC.listen("tbl-recommendation-ree(e){for(var t in e)this._propagateStateToSubModels(t,e[t])}_onResizeRecoReelSlider(e){this.model.set("tblRecoReelSliderToSlider",e),this._resetModelSizes(e);var t={width:this.model.get("width"),height:this.model.get("height"),placeHolderHeight:this.model.get("placeHolderHeight"),resizeRecoReelSlider:e};this._propagatePropsToSubModels(t)}_resetModelSizes(e){var t=e?this.model.get("detachToSlider.recoReelSliderSelector"):this.model.get("msnSelector"),i=document.querySelector(t);this._calculateElementDimentions(i)}_bindOnResizeEvents(){this.hasResizeListeners||(this.hasResizeListeners=!0,rn.listenTo(rn,"window:orientation:change",this._onResize.bind(this)),rn.listenTo(rn,"window:agateStateToSubModels("isInTab",this.model.get("isInTab"))}_propagateStateToSubModels(e,t){if(on.size(this.subUnitsControllers)>0)for(var i in this.subUnitsControllers)this.subUnitsControllers[i].updateLocalModel(e,t)}_createUnitContainer(e){var t=nn("<div>");t.addClass("_cm-reco-reel-unit-container");var i=Date.now();t.addClass("_".concat(i)),t.appendTo(e),this.unitContaineSelector="._cm-reco-reel-unit-container._".concat(i),this.model.set("videoContainerSelector",this.unitContaineSelector),this._handlePlayer()}_getCard(e){this.log.info("Get Card Reason:",e),this.tempCard=nn(this.model.get("msnSelector"))[0]}_initNewSubUnit(){var e=this._createSubModel();e.set("msnCardToHide",this.tempCard),e.set("additionalCard",this.tempCard.additionalCard),e.set("eligiblePlaceholder",this.tempCard),e.set("volumeMuted",this.model.get("volumeMuted")),e.set("videoContainerSelector",this.model.get("videoContainerSelector")),e.set("isInTab",this.model.get("isInTab")),this.subUnitsControllers[this.controllersIndex]=new as({globalModel:this.model,model:e,container:this.unitContaineSelector}),this.tempCard=void 0,this.controllersIndex++,this.isStartWithLoader=void 0,TRC.dom.off(this.recoReelContainer,this.animationStartEvent,this._onRecoReelStartEvent),this.model._updateCrossUnitCommunication({unit:this.model.get("unitType"),state:W.Z.externalUnit.playing})}_registerRecoReelStartStoryEvent(){this.animationStartEvent=TRC.dom.detectAnimationEvent(this.recoReelContainer,"start"),TRC.dom.on(this.recoReelContainer,this.animationStartEvent,(e=>this._onRecoReelStartEvent(e)))}_onRecoReelStartEvent(e){if("tbl-animation-progress-bar"===e.animationName&&!this.isRecoReel){this.isRecoReel=!0;var t=e.target.parentElement,i=Number(t.dataset.progressBarIndex);this.model.set("recoReelIndex",i),this.model.set("cardNumber"yAd(){return!!this._isHasReadyAd()&&this.model.getNextAd()}_onResize(e){Math.abs(e.heightChange)<this.model.get("allowedHeightChange")&&0===e.widthChange||(this.model.set("isTerminateOnResize",!0),this.terminate("onResize"))}terminate(e){for(var t in this.log.info("Terminate reason: "+e),this.subUnitsControllers)this.subUnitsControllers[t].terminate(!1,e);this.model.set("closeState",W.Z.closeState.terminate),this.subUnitsControllers={},this.closeReason=e,this.model._updateCrossUnitCommunication({unit:this.model.get("unitType"),state:W.Z.externalUnit.stopped})}_handleSubUnitClose(){delete this.subUnitsControllers[this.model.get("closedSubUnitId")],0===on.size(this.subUnitsControllers)&&this.model.get("maxCards")===this.controllersIndex&&this.terminate("LimitedCardsAllClosed")}handleCloseState(e,t){switch(this.log.info("handleCloseState",t),rn.trigger("global:closeState:changed"),t){case W.Z.closeState.terminate:this.adsManager?this.adsManager.close():this.model.set("closeState",W.Z.closeState.adManagerStop);break;case W.Z.closeState.adManagerStop:this.playerService&&(this.playerService.close(),this._stopListening())}}_stopListening(){this.model.off(),rn.off()}_triggerPassback(){this.model.get("isFirstAdLoaded")||(this.log.info("Passback timer done"),rn.trigger("global:passback",{isApiPassbackExist:this.model.get("isApiPassbackExisten&&TRC.listen("rBoxVisible",this._stopHipMode.bind(this))}_stopHipMode(){TRC.trcHipContainersShowing&&TRC.trcHipContainersShowing[this.model.get("rboxContainerId")]&&(this.playerService._onLostHipMode(),this.model.setPredictorsToNonHIP(),this.log.info("Stop Hip Mode Update Predictors"),this.seerService._createRequestedPredictors())}_locAdjacMode(){this.createStateHandlers([{event:"adState:playing",funcName:"_unHideRbox",isListenOnce:!0}])}_unHideRbox(){var e=this.model.get("rboxContail;t.forEach((t=>{nn(".trc_wrapper_".concat(e[1]),t)&&(i=t)})),i.classList.remove("tbl-invisible")}_dropAdjacentAds(){this.playerService._onLostHipMode()}_handleMidArticleReadMore(){on.isReadMoreObserverNeededOnPage(this.model.get("readMoreObserver.isActive"),this.model.get("isHip"))&&(this.readMoreObserver=new Ct({model:this.model}),this.model.set("readMoreObserver.isActive",!1))}}const ln=an;var dn=n(316),hn=n(999);const cn=dn.DeepModel.extend({STATE:{READY:0,GOT_AD:1,PLAYING:2,PAUSED:3,PAUSED_BY_USER:4,STOPPED_BY_USER:5,DETACHED:6,ATTACHED:7,DONE:8,PLAYER_READY:9,PLAYER_CLOSE:10,PLAYER_STOP:11,AD_STOPPED:12,OPT_OUT:13,OPEN_WITH_PAUSE:14,WAITING_FOR_EXPAND:15,REPEAT_STAND_BY:16,REPEAT_SPINNING:17,SKIP0),),t=t.replace(i[s],on(o,r);this.set(","\n").concat(t);reWith)}),t.id,timestampixelParameter("ordeis.get(e)||!1===this.get(e))&&(i+="&"+t+"="+this.get(e)),i},getImpressio.get("totalTimthis.getPixel("pixels.tLoadedWithFill"),et(i);n&&s.push(n);var&&(r+="_vG"):r+="_v&&s[t]&&(e=s[t].minVersion),i>=e&&this.set("vt){this.storage[e]=t},getStorage(e){return this.storage[e]},settSliderCutOffAd(e){thiderCutOffAd");return this.setNextSliderCutOffAd(void 0),e},peekNextSliderCutOffoid 0),setTStorage("nViewabilityEvents(){this.oget("placement"),)&&(t=t.sliendlyIframrThenSetByCon=hcreaseCounter(eCounter(e){var set("frameType",e),this.xOf("preset")?e.(t=!1)}else this.get(e[i].key)!==e[i].val&&(t=!1);return t},fireUnitDelayedPixel(){hn.firePixel(this.getPixel("pixels.unitDelayed"),"unit delayed")},fireUnitLoadAfterDelayPixel(){hn.firePixel(this.getPixel("Loadcomponeray(s)||(s=[]),i&&),this.log.info("Unitmation.detach",this.get("sdy").appendChild(e)}this._obseossUnitCommunicationObserver)t").setAttribute("das.get("unitType")&&this.set("crossUnitInfo",JSON.parse(i))},_stopCrossUnitCommunicationObserver(){this.crossUnitCommunietAdOnEligibilityLost"),"cans))})),this.set("predictors",{}),thisntsIfAny:e=>"strinomSlider")&&this.set("detacrcent.isStartWFdule("pre-roll"o/mp4"}),this),this.setaceholderSize.width"))<=thitors")),thrId")])&&(this.get("isors",{}),this.set("predictors",this.get("tempPredictors"))}}),gn=pn.extend({initialize:function(){pn.prototype.initialize.call(this),this.get("isAdjacInFirstWF")?this.set("isMultiAd",!1):this.get("midrollRecoReel")&his.get("midrollRecoReelisMobile:i=!1}=e;St(e,t,{model:i?mn:gn,unitController:ln})}})()})();