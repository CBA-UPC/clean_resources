import{b as d}from"./body.d7af3f33.js";import{f as g,C as w,ap as T,E as f,P as k,ad as C,aZ as P,aI as S,U as y,J as b}from"./index.47a70548.js";import{e as E,A as L}from"./address-event.0a54fb2b.js";import{c as x}from"./customer-location-mixin.d9a86a52.js";const R=()=>g(["static/js/address-module.min.fb997edd.js","static/js/index.47a70548.js","static/index.017ebbd9.css"]);let c=null;const l=()=>new Promise(e=>{if(c){e(c);return}R().then(s=>{c=s.default.createInstance(),e(c)})});function D(e,s,t,o,h,p,r,u,_,v){typeof r!="boolean"&&(_=u,u=r,r=!1);const n=typeof t=="function"?t.options:t;let i;if(e&&e.render&&(n.render=e.render,n.staticRenderFns=e.staticRenderFns,n._compiled=!0,h&&(n.functional=!0)),o&&(n._scopeId=o),p?(i=function(a){(a=a||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||typeof __VUE_SSR_CONTEXT__>"u"||(a=__VUE_SSR_CONTEXT__),s&&s.call(this,_(a)),a&&a._registeredComponents&&a._registeredComponents.add(p)},n._ssrRegister=i):s&&(i=r?,i)if(n.functional){const a=n.render;n.render=else{const a=n.beforeCreate;n.beforeCreate=a?[].concat(a,i):[i]}return t}var $=D({render:function(){var e=this.$createElement,s=this._self._c||e;return s("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",preserveAspectRatio:"xMidYMid meet",width:"24",height:"24",viewBox:"0 0 24 24"}},[s("path",{attrs:{d:"M12 2C7.31 2 3.5 5.81 3.5 10.5C3.5 17 11 22 12 22C13 22 20.5 17 20.5 10.5C20.5 5.81 16.69 2 12 2ZM12 13.52C10.07 13.52 8.5 11.95 8.5 10.02C8.5 8.09 10.07 6.52 12 6.52C13.93 6.52 15.5 8.09 15.5 10.02C15.5 11.95 13.93 13.52 12 13.52Z"}})])},staticRenderFns:[]},void 0,{name:"BliIconLocation"},void 0,!1,void 0,!1,void 0,void 0,void 0),B=$;const F=w(B),I={name:"CustomerLocation",props:{lightTheme:{type:Boolean,default:!1},isFestiveMode:{type:Boolean,default:!1},pageType:{type:String,default:"retail-header"},customElement:{type:Boolean,default:!1},finallyCallback:{type:Function,default:()=>{}},errorCallback:{type:Function,default:},components:{BliIconLocation:F,BliIconChevronDown:T},mixins:[x],computed:{...f(["isMobile","isLoggedIn","currentUser"]),...f("mainAddress",["addressData","addressDetail","addressGeoLocation","addressLabel","addressRecipient","addressResponse","addressText","existingAddress","fullAddress","geoLocationParam","hasAddress","hasPinpoint","isNotDefaultAddress","labelParam","manualAddress","recipientName","truncatedAddress"]),commonParams(){return{id:this.labelParam.id,currentUser:this.currentUser,pageType:"retail-header"}},addAddressParams(){return{geolocation:this.geoLocationParam.geolocation,currentUser:this.currentUser,pageType:"retail-header"}},labelTracker(){const e=this.hasAddress?"address":"noaddress",s=this.hasPinpoint&&this.hasAddress?"pinpoint":"nopinpoint";return"".concat(e,"Â£").concat(s)},iconClass(){return!this.lightTheme||this.isFestiveMode?"icon-white":"icon-grey"},themeClas},methods:{...k("mainAddress",["setAddress"]),showEditCustomerLocation(){l().then(e=>{e.showEdit(this.commonParams).then(s=>{this.handleResponse(s,this.onSuccessPickAddress)}).catch(()=>{this.setAddressNull(),this.errorCallback()}).finally(()=>{d.disableScrollLock(),this.finallyCallback()})})},showEditCustomerPinpoint(){l().then(e=>{const s={...this.commonParams,mapFocus:!0};e.showEdit(s).then(t=>{this.handleResponse(t,this.onSuccessPickAddress)}).catch(()=>{this.setAddressNull(),this.errorCallback()}).finally(()=>{d.disableScrollLock(),this.finallyCallback()})})},showCustomerAddressPicker(e){const s=C(e),t=C(s.detail);d.enableScrollLock(),l().then(o=>{o.showPicker({...this.commonParams,hideSearch:t.hideSearch,addNew:t.addNew}).then(h=>{this.handleResponse(h,this.onSuccessPickAddress)}).catch).finally)})},showSuccessChangeAddressToast(){this.showToast({message:this.lang("app.location.addressChanged")})},showSuccessFindAddressToast(){if(!this.isLoggedIn){this.showSuccessChangeAddressToast();return}if(this.isNotDefaultAddress){this.showSaveAddressToast();return}this.showErrorToast()},showSaveAddressToast(){this.showToast({message:this.lang("app.location.saveAddress"),hasAction:!0,action:{text:this.lang("app.location.saveButton"),click:this.onClickSaveAddress}})},showSuccessSaveAddressToast(){this.showToast({message:this.lang("app.location.saveAddressSuccess")})},showErrorToas,onClickSaveAddress(){l().then(e=>{e.showAdd(this.addAddressParams).then).catch(this.setAddressNull)})},onSuccessPickAddress(e){if(this.isErrorResponse(e)){this.showErrorToast();return}E({detail:e}),this.addressLabel?this.showSuccessChangeAddressToast():this.showSuccessFindAddressToast()},onSuccessSaveAddres,showToast({message:e,hasAction:s=!1,action:t={}}){this.$toast.open({duration:5e3,hasAction:s,message:e,action:t})},isErrorRespons,handleResponse(e,s){if(!e)return;const t={data:e};this.setAddress(t),s(e)},viewTracker(){const e=this.pageType,s="View Address",t=this.labelTracker;P({pageType:e,action:s,label:t})},clickTracker(){const e=this.pageType,s="Click Address",t=this.labelTracker;S({pageType:e,action:s,label:t})},lang:y},mounte};var N=function(){var s=this,t=s._self._c;return s._self._setupProxy,s.customElement?t("div",[s.$slots.add?t("div",{on:{click:function(o){return o.preventDefault(),s.showCustomerAddressPicker.apply(null,arguments)}}},[s._t("add")],2):s._e(),s.$slots.edit?t("div",{on:{click:function(o){return o.preventDefault(),s.showEditCustomerPinpoint.apply(null,arguments)}}},[s._t("edit")],2):s._e()]):t("div",{staticClass:"location",class:s.themeClass,on:{click}},[t("div",{staticClass:"location__address"},[t("BliIconLocation",{staticClass:"location__address__logo",class:s.iconClass}),s.hasAddress?[t("span",{staticClass:"location__address__prefix"},[s._v(" "+s._s(s.lang("app.location.shipTo"))+" ")]),t("span",{staticClass:"location__address__content",class:{"location__address__content--noPinpoint":!s.hasPinpoint}},[s._v(" "+s._s(s.addressText)+" ")])]:[t("span",{staticClass:"location__address__content"},[s._v(" "+s._s(s.$t("app.location.addAddress"))+" ")]),t("span",{staticClass:"location__address__suffix",class:{"location__address__suffix--noPinpoint":!s.hasPinpoint}},[s._v(" "+s._s(s.$t("app.location.forBetterExperience"))+" ")])]],2),!s.hasPinpoint&&s.hasAddress?t("div",{staticClass:"location__pinpoint",on:{click}},[s._v(" "+s._s(s.lang("app.location.setLocationPin"))+" ")]):s._e(),t("BliIconChevronDown",{staticClass:"location__arrow",class:s.iconClass})],1)},M=[],U=b(I,N,M,!1,null,"d4097f5c",null,null);const G=U.exports;export{G as default};
//# sourceMappingURL=CustomerLocation.c320aca9.js.map
