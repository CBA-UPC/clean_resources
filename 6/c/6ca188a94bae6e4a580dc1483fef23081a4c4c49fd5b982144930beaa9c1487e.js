
//# sourceMappingURL=loader.DividerHandler.873ae75a.js.mapcusTrap(n)}function closeRoutingCard(){var n=document.querySelector("#smcContactUsLandingPageRoutingCard"),t=document.querySelector(".smcContactUsLandingPageRoutingCard-inner");n.style.visibility="hidden";n.style.opacity=0;t.style.bottom="-100vw";t.style.right="-100vh";var i=document.querySelector(".smcContactUsLandingPageRoutingCardCloseSign"),u=i?i.getAttribute("data-focusBackLinkId"):"",r=document.querySelector("#"+u);r!=null&&r.focus()}function setRoutingCardStrings(n){var t=document.querySelector(".contactus_primaryPopUpButton"),i=document.querySelector(".contactus_secondaryPopUpLink"),r=document.querySelector(".optionIntro"),u=document.querySelector(".smcContactUsLandingPageRoutingCardOptionAltTextHome");!t||(t.onclick=null,t.href=n.getAttribute("data-primaryBtnUrl"),t.textContent=n.getAttribute("data-primaryBtnText"));!r||(r.innerHTML=n.getAttribute("data-primaryText"));!i||(i.onclick=null,i.href=n.getAttribute("data-secondaryBtnUrl"),i.textContent=n.getAttribute("data-secondaryBtnText"));!u||(u.innerHTML=n.getAttribute("data-secondaryText"));redirectToGetHelpApp()}function createFocusTrap(n){function t(i){const r=n.querySelectorAll('a[href], button, input, select, textarea, [tabindex]:not([tabindex="-1"])'),u=r[0],f=r[r.length-1],e=i.key==="Tab"||i.keyCode===9,o=i.key==="Escape"||i.keyCode===27;o&&(u.focus(),document.querySelectorAll("#smcContactUsLandingPageRoutingCardCloseButton").item(0).click(),n.removeEventListener("keydown",t));e&&(i.shiftKey?document.activeElement===u&&(i.preventDefault(),f.focus()):document.activeElement===f&&(i.preventDefault(),u.focus()))}n.addEventListener("keydown",t)}function enableRoutingCard(){var t=document.querySelectorAll(".supHomepageIcons"),n;for(anchor of t)anchor.onclick=function(n){var t,i,e;if(n.preventDefault(),t=n.target.closest(".contactUsRoutingIcon"),setRoutingCardStrings(t),i=t.getAttribute("href"),i!="#")window.open(i,"_self");else{var u=t.getAttribute("data-routingKey"),o=t.getAttribute("data-routingIcon"),s=t.getAttribute("data-routingBizLinkText"),h=t.getAttribute("data-routingBizLinkUrl"),r=t.getAttribute("data-routingId"),c=t.getAttribute("id"),l=r=="L_Microsoft_365"?"visible":"hidden",a=document.querySelector(".smcContactUsLandingPageRoutingCardNotice"),f=document.querySelector(".smcContactUsLandingPageRoutingCardCloseSign");document.querySelector("html").getAttribute("dir")=="rtl"&&f.classList.add("rtl");f.setAttribute("data-focusBackLinkId",c);a==null&&(document.querySelector("#productGroup").innerHTML=u,document.querySelector(".smcContactUsLandingPageRoutingCardTitle").setAttribute("aria-label",u),document.querySelector(".smcContactUsLandingPageRoutingCardPhoto img").src=o,e=document.querySelector(".smcContactUsRoutingBusinessOption"),e&&(document.querySelector(".smcContactUsRoutingBusinessMain").href=h,document.querySelector(".smcContactUsRoutingBusinessMain").parentElement.querySelector(".optionIntro").innerHTML=s,document.querySelector(".smcContactUsRoutingBusinessMain").id="smcContactUsRoutingBusinessMain_"+r,document.querySelector(".smcContactUsRoutingBusinessOption .smcContactUsLandingPageRoutingCardOptionAlt").style.visibility=l));setPrimaryBtnContentId(r);popupRoutingCard()}};n=document.querySelector(".smcContactUsLandingPageRoutingCardCloseSign");n.onclick=function(){closeRoutingCard()};openRoutingCardDeepLink()}function enableListOfProductsSwitch(){var n=document.querySelector("#showListOfProducts"),t=document.querySelector("#hideListOfProducts"),i=document.querySelector("#listOfProducts"),r;n&&t&&i&&(r=i.querySelector(".contactUsRoutingIcon"),n.onclick=function(){n.style.display!="none"&&(t.style.display="block",i.style.display="block",n.style.display="none",r.focus())},t.onclick=function(){t.style.display!="none"&&(t.style.display="none",i.style.display="none",n.style.display="block",n.focus())})}function setPrimaryBtnContentId(n){let t=document.querySelector(".smcContactUsRoutingEmeraldWeb");if(!!t)switch(n){case"L_SurfaceDevices":t.id="smcContactUsRoutingSurfaceDevices";break;default:t.id="smcContactUsRoutingEmeraldWeb"}}function openRoutingCardDeepLink(){const t=new Proxy(new URLSearchParams(window.location.search),{get:(n,t)=>n.get(t)});let i=document.querySelector("#DeepLinkAllowedProducts").value,n=t.routingCard;if(i.includes(n)){let t=document.querySelector(`[data-routingid="${n}" i]`);if(!!t){t.click();t.focus({focusVisible:!1});const n={content:{contentId:"deepLinkOpenRoutingCard_"+t.id,contentName:"deepLinkOpenRoutingCard_"+t.id,formnm:"maxFunnel",fileName:"smcContactUsLandingV2.js",methodName:"openRoutingCardQueryParam",areaName:"ContactUs_LandingPage_RoutingCard"},behavior:"KE"};window.analytics.capturePageAction(null,n)}}}function redirectToGetHelpApp(){var t=document.querySelector(".smcContactUsRoutingEmeraldWeb"),n;t&&t.getAttribute("href").includes("#!")&&(t.onclick=function(n){redirectToApp(n)});n=document.querySelector(".smcContactUsRoutingGetHelp");n&&n.getAttribute("href").includes("#!")&&(n.onclick=function(n){redirectToApp(n)})}function redirectToApp(n){var t=n.target.getAttribute("flights"),i=n.target.getAttribute("msAsId");window.open(buildGetHelpAppProtocolLauncherUrl(t,i),"_self")}function buildGetHelpAppProtocolLauncherUrl(n,t){var i={};return i["flighting"]=n,i["ms-asid"]=t,"ms-contact-support://cuv2ghredirect"+createQueryStringFromObject(i)||""}function createQueryStringFromObject(n){var i,r,t;if(typeof n!="object"||n===null)return"";i="";r=!0;for(t in n)n.hasOwnProperty(t)&&(typeof n[t]=="string"||typeof n[t]=="boolean"||typeof n[t]=="number")&&n[t]!==""&&(r?(i+="?",r=!1):i+="&",i+=t+"="+encodeURIComponent(n[t].toString()));return i}(function(){enableRoutingCard();enableListOfProductsSwitch()})()