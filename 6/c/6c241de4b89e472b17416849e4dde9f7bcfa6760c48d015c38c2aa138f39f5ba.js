;
(self.AMP=self.AMP||[]).push({m:1,v:"2312191621000",n:"amp-position-observer",ev:"0.1",l:!0,f:function(t,i){(()=>{var{isArray:i}=Array;function s(t,i){const s=[];let n=0;for(let h=0;h<t.length;h++){const r=t[h];i(r,h,t)?s.push(r):(n<h&&(t[n]=r),n++)}return n<t.length&&(t.length=n),s}var{hasOwnProperty:n,toString:h}=Object.prototype;function r(t){return 1==(null==(i=t)?void 0:i.nodeType)?t.tagName.toLowerCase()+(t.id?`#${t.id}`:""):t;var i}function e(t,i,n,h,e,o,l,u,c,a,f){return function(t,i,n="Assertion failed",h){var e,o;if(i)return i;t&&-1==n.indexOf(t)&&(n+=t);let l=3;const u=n.split("%s");let c=u.shift();const a=[c];for(;u.length;){const t=arguments[l++],i=u.shift();c+=r(t)+i,a.push(t,i.trim())}const f=new Error(c);throw f.messageArray=s(a,(),null===(e=(o=self).__AMP_REPORT_ERROR)||void 0===e||e.call(o,f),f}("​​​",t,i,n,h,e,o,l,u,ct),t}var l="inside",u="bou:l}function f(t,i){return!(!t||!i)&&t.left==i.left&&t.top==i.top&&t.width==i.width&&t.height==i.height}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var _=self.__AMfunction g(t){!function(t,i,s,n){const h=E(t),r=M(h);!function(t,i,s,n,h,r){const e=I(t);let o=e[s];o||(o=e[s]={obj:null,promise:null,resolve:null,reject:null,context:null,ctor:null,sharedInstance:!1}),o.ctor||(o.ctor=n,o.context=i,o.sharedInstance=!1,o.resolve&&b(t,s))}(r,h,i,class{constructor(t){this.Ni=t,this.i=t.win,this.l_=[],this.ar=m(this.i,"vsync"),this.Uu=T(t),this.c_=[],this.a_=!1,this.f_=!1,this.__=!1,this.v_=function(t,i,s){let n=0,h=0,r=null;function e(){n=0;const o=s-(t.Date.now()-h);var l;o>0?n=t.setTimeout(e,o):(l=r,r=null,i.apply(null,l))}return function(...i){h=t.Date.now(),r=i,n||(n=t.setTimeout(e,s))}}(th_=!1}),500)}observe(t,i,s){const n=new class{constructor(t,i,s,n){this.element=i,this.Ie=n,this.fidelity=s,this.turn=0==s?Math.floor(4*Math.random()):0,this.A_=null,this.Uu=T(t)}Ee(t){const i=this.A_;if(i&&f(i.positionRect,t.positionRect)&&f(i.viewportRect,t.viewportRect))return;d(t.positionRect);const s=t.positionRect;var n,h;t.relativePos=a(s,t.viewportRect),n=s,h=t.viewportRect,n.top<=h.bottom&&h.top<=n.bottom&&n.left<=h.right&&h.left<=n.right?(this.A_=t,this.Ie(t)):this.A_&&(this.A_=null,t.positionRect=null,this.Ie(t))}update(t){if(!t){if(0!=this.turn)return void this.turn--;0==this.fidelity&&(this.turn=4)}const i=this.Uu.getSize(),s=c(0,0,i.width,i.height);this.Uu.getClientRectAsync(this.element).then((t=>{this.Ee({positionRect:t,viewportRect:s,relativePos:null})}))}}(this.Ni,t,i,s);return this.l_.push(n),this.__||this.P_(),n.update(),()=>{for(let t=0;t<this.l_.length;t++)if(this.l_[t]==n)return void this.d_(t)}}unont")}d_(t){this.l_.splice(t,1),0==this.l_.length&&this.p_()}P_(){this.__=!0,this.c_.push(this.Uu.onScroll((()=>{this.m_()}))),this.c_.push(this.Uu.onResize((()=>{this.R_()}!0)}E_(){this.updateAllEntries(),this.f_=!0,this.a_?this.ar.meaE_()})):this.f_=!1}})}(t,"position-observer")}function w(t,i,s,n){const h={detail:s};return Object.assign(h,n),new t.CustomEvent(i,h)}var x="amp-position-observer",y=class extends t.BaseElement{constructor(t){super(t),this.tc=null,this.Mt=null,this.Uu=null,this.rs=!1,this.M_=0,this.b_=0,this.I_="0",this.V_="0",this.T_=0,this.g_=0,this.Tt=null,this.w_=null,this.x_=null,this.y_=0,this.O_=0,this.S_=!1,this.F_=!1}buildCace")}Au(){this.j_(),this.tc=function(t,i){const s=M(E(t));return V(s,i)?b(s,i):null}(this.element,"action"),this.Uu=T(this.element),this.C_(),this.getAmpDoc().whenReady().then((()=>{const t=this.k_();this.Mt.observe(t,1,this.z_.bind(this))}))}q_(){const t=w(this.win,`${x}.enter`,{});this.tc.trigger(this.element,"enter",t,1)}H_(){const t=w(this.win,`${x}.exit`,{});this.tc.trigger(this.element,"exit",t,1)}N_(){const t=this.Uu.getScrollTop(),i={"start-scroll-offset":t,"end-scroll-offset":t+this.O_,"initial-inview-percent":this.y_},s=w(this.win,`${x}.scroll`,{"percent":this.y_,"positionObserverData":i});this.tc.trigger(this.element,"scroll",s,1)}z_(t){if(this.S_&&this.F_)return;const i=this.rs,s=this.Tt&&this.Tt.height;this.B_(t),this.Tt=t.viewportRect,s!=t.viewportRect.height&&this.D_();const n=this.L_(t.viewportRect),{positionRect:h}=t;let r;h?(r=a(h,n),this.th(h,n,r)):(this.rs=!1,r=t.relativePos),i&&!this.rs&&(this.y_=r==u?0:1,this.N_(),this.H_(),this.F_=!0),!i&&this.rs&&this.q_(),this.rs&&(this.U_(h,n),this.N_())}th(t,i,s){if(s==l)return void(this.rs=!0);const n="top"==s?this.M_:this.b_,h=t.height*n;this.rs=s==u?t.top<=i.bottom-h:t.bottom>=i.top+h}U_(t,i){if(!t)return;const s=t.height*this.b_+t.height*this.M_,n=i.height+t.height-s,h=Math.abs(t.top-this.T_-(i.height-t.height*this.b_));this.y_=h/n,this.O_=et),t}G_(t){var i;coi[0]}(t=o("number"==typeof(i=t)?i+"px":i&&/^\d+(\.\d+)?(px|em|rem|vh|vw|vmin|vmax|cm|mm|q|in|pc|pt)?$/.test(i)?/^\d+(\.\d+)?$/.test(i)?i+"px":i:void 0));let n=function(t){const i=parseFloat(t);return"number"==typeof(s=i)&&isFinite(s)?i:void 0;var s}(t);return n?(p("px"==s||"vh"==s,"Only pixel or vh are valid as units for exclusion margins: "+t),"vh"==s&&(n=n/100*this.Tt.height),nt..T_)}B_(t){this.x_||(this.x_=t.viewportRect.height);const i=this.x_-t.viewportRect.height;let s=0;Math.abs(i)<150?s=i:this.x_=null,t.viewportRect=c(t.viewportRect.left,t.viewportRect.top,t.viewportRect.width,t.viewportRect.height+s)}C_(){this.Mt||(g(this.getAmpDoc()),this.Mt=R(this.element,"position-observerull}}};t.registerElement(x,y)})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-position-observer-0.1.mjs.map