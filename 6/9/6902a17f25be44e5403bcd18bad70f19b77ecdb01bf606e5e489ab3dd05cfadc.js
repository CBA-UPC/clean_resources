/*@license For license information please refer to eg-maps.licenses.txt*/
(self.webpackChunkblossom_flex_ui=self.webpackChunkblossom_flex_ui||[]).push([[87687],{90439:function(e){window,e.exports=function(){var e={736:function(e,t,r){e.exports=function(){var e={712:function(e,t){var r=t.O={};r.read=r._readField=function(e,t,n){1===e?t.dictionary=r.Dictionary.read(n,n.readVarint()+n.pos):2===e&&(t.content=r.Content.read(n,n.readVarint()+n.pos))},r.Dictionary={},r.Dictionary.read=function(e,t){return e.readFields(r.Dictionary._readField,{constants:[]},t)},r.Dictionary._readField=function(e,t,r){1===e&&t.constants.push(r.readString())},r.Feature={},r.Feature.read=function(e,t){return e.readFields(r.Feature._readField,{type:0,id:"",latitude:0,longitude:0,name:"",classifiers:[]},t)},r.Feature._readField=function(e,t,r){1===e?t.type=r.readVarint():2===e?t.id=r.readString():3===e?t.latitude=r.readVarint(!0):4===e?t.longitude=r.readVarint(!0):5===e?t.name=r.readString():6===e&&r.readPackedVarint(t.classifiers,!0)},r.Feature.Type={UNKNOWN:{value:0,options:{}},PLACE:{value:1,options:{}},PROPERTY:{value:2,options:{}}},r.Content={},r.Content.read=function(e,t){return e.readFields(r.Content._readField,{features:[]},t)},r.Content._readField=function(e,t,n){1===e&&t.features.push(r.Feature.read(n,n.readVarint()+n.pos))}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return function(){n.r(i),n.d(i,{EGTSCodec:function(){return l}});var e=r(997),t=n.n(e),o=n(712);function a(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){u=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw o}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}ar l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var r,n,i;return r=e,(n=[{key:"decode",value:function(e){var r=this;return new Promise((function(n){var i,s=new(t())(e),u=o.O.read(s),l=[],c=a(u.content.features);try{for(c.s();!(i=c.n()).done;){var f=i.value;l.push({id:f.id,type:r._getType(f.type),lat:f.latitude/1e6-90,lng:f.longitude/1e6-180,name:f.name,qualifiers:f.classifiers.map(()})}}catch(e){c.e(e)}finally{c.f()}n(l)}))}},{key:"_getType",value:function(e){for(var t in o.O.Feature.Type)if(o.O.Feature.Type[t].value===e)return t.toLowerCase()}}])&&u(r.prototype,n),i&&u(r,i),e}()}(),i}()},501:function(){},744:164:997:function(e,t,r){e.exports=i;var n=r(164);.Varint=0,i.Fixed64=1,i.Bytes=2,i.Fixed32=5;var o=4294967296,a=1/o,s="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");ction f(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function d(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function h(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function p(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function v(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function y(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function g(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function m(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}ototype={destroy:readFields:readMessage:readFixed32:function(){var e=k(this.buf,this.pos);return this.pos+=4,e},readSFixed32:readFixed64:function(){var e=k(this.buf,this.pos)+k(this.buf,this.pos+4)*o;return this.pos+=8,e},readSFixed64:readFloat:function(){var e=n.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:readVarint:readVarint64:readSVarint:readBoolean:readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&s?this.buf,t,e):this.buf,t,e)},readBytes:readPackedVarint:readPackedSVarint:function(e){if(this.type!==i.Bytes)return e.push(this.readSVarint());var t=u(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==i.Bytes)return e.push(this.readBoolean());var t=u(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==i.Bytes)return e.push(this.readFloat());var t=u(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==i.Bytes)return e.push(this.readDouble());var t=u(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==i.Bytes)return e.push(this.readFixed32());var t=u(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==i.Bytes)return e.push(this.readSFixed32());var t=u(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==i.Bytes)return e.push(this.readFixed64());var t=u(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:skip:writeTag:realloc:finish:writeFixed32:function(e){this.realloc(4),w(this.buf,e,this.pos),this.pos+=4},writeSFixed32:writeFixed64:function(e){this.realloc(8),w(this.buf,-1&e,this.pos),w(this.buf,Math.floor(e*a),this.pos+4),this.pos+=8},writeSFixed64:writeVarint:writeSVarint:writeBoolean:writeString:writeFloat:function(e){this.realloc(4),n.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:writeBytes:writeRawMessage:writeMessage:writePackedVarint:function(e,t){t.length&&this.writeMessage(e,f,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,d,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,v,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,h,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,p,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,y,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,g,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,m,t)},writePackedSFixed64:writeBytesField:function(e,t){this.writeTag(e,i.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,i.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,i.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,i.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,i.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,i.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,i.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,i.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,i.Fixed32),this.writeFloat(t)},writeDoubleField:writeBooleanField:},597:function(e){!function(){var t=function(e){return(e="number"==typeof e?{precision:e}:e||{}).precision=e.precision||5,e.factor=e.factor||Math.pow(10,e.precision),e.dimension=e.dimension||2,e},r={encode:function(e,r){r=t(r);for(var n=[],i=0,o=e.length;i<o;++i){var a=e[i];if(2===r.dimension)n.push(a.lat||a[0]),n.push(a.lng||a[1]);else for(var s=0;s<r.dimension;++s)n.push(a[s])}return this.encodeDeltas(n,r)},decode:function(e,r){r=t(r);for(var n=this.decodeDeltas(e,r),i=[],o=0,a=n.length;o+(r.dimension-1)<a;){for(var s=[],u=0;u<r.dimension;++u)s.push(n[o++]);i.push(s)}return i},encodeDeltas:function(e,r){r=t(r);for(var n=[],i=0,o=e.length;i<o;)for(var a=0;a<r.dimension;++a,++i){var s=e[i].toFixed(r.precision),u=s-(n[a]||0);n[a]=s,e[i]=u}return this.encodeFloats(e,r)},decodeDeltas:function(e,r){r=t(r);for(var n=[],i=this.decodeFloats(e,r),o=0,a=i.length;o<a;)for(var s=0;s<r.dimension;++s,++o)i[o]=Math.round((n[s]=i[o]+(n[s]||0))*r.factor)/r.factor;return i},encodeFloats:function(e,r){r=t(r);for(var n=0,i=e.length;n<i;++n)e[n]=Math.round(e[n]*r.factor);return this.encodeSignedIntegers(e)},decodeFloats:function(e,r){r=t(r);for(var n=this.decodeSignedIntegers(e),i=0,o=n.length;i<o;++i)n[i]/=r.factor;return n},encodeSignedIntegers:function(e){for(var t=0,r=e.length;t<r;++t){var n=e[t];e[t]=n<0?~(n<<1):n<<1}return this.encodeUnsignedIntegers(e)},decodeSignedIntegers:function(e){for(var t=this.decodeUnsignedIntegers(e),r=0,n=t.length;r<n;++r){var i=t[r];t[r]=1&i?~(i>>1):i>>1}return t},encodeUnsignedIntegers:decodeUnsignedIntegers:encodeSignedInteger:function(e){return e=e<0?~(e<<1):e<<1,this.encodeUnsignedInteger(e)},encodeUnsignedInteger:function(e){for(var t,r="";e>=32;)t=63+(32|31&e),r+=String.fromCharCode(t),e>>=5;return t=e+63,r+String.fromCharCode(t)}};if("object"==typeof e.exports&&(e.exports=r),"object"==typeof L){L.Polyline.prototype.fromEncoded||(L.Polyline.fromEncoded=function(e,t){return L.polyline(r.decode(e),t)}),L.Polygon.prototype.fromEncoded||(L.Polygon.fromEncoded=;var n={encodePath:;L.Polyline.prototype.encodePath||L.Polyline.include(n),L.Polygon.prototype.encodePath||L.Polygon.include(n),L.PolylineUtil=r}}()}},t={};.n=r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){return window}}(),r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};return function(){r.r(n),r.d(n,{Animation:function(){return o},BaseMap:function(){return xs},BrowserUtils:function(){return i},Cache:function(){return gn},ConfigHelper:function(){return Zs},ConfigLoader:function(){return en},ConsoleLogger:function(){return Br},EGMap:function(){return Iu},EventTypes:function(){return ti},EventsManager:function(){return ri},Geo:function(){return a},HtmlUtils:function(){return e},I18n:function(){return on},IconUtils:function(){return s},KeyboardFeatures:function(){return $i},KeyboardListeners:function(){return ao},Labels:function(){return l},Level:function(){return Ir},Logger:function(){return Tr},MarkerUtils:function(){return u},TilesLoader:function(){return _u},Utils:function(){return t},debugOptions:function(){return Wr},defaultConfig:function(){return Xs},defaultIcons:function(){return $s},i18nKeys:function(){return mi},icons:function(){return $s},identifyUpdates:function(){return qs},newLogger:function(){return Ar},newMapData:function(){return Ls},ttlCache:function(){return kn}});var e={};r.r(e),r.d(e,{addClass:function(){return nt},addClasses:function(){return it},addNewCssStyle:function(){return Ct},anyChildrenMatching:function(){return le},anyChildrenWithClasses:function(){return se},areRectPointsAndCircleIntersecting:function(){return Ye},areRectsIntersecting:function(){return $e},changeImgSrc:function(){return Ke},changeSpanTextContent:function(){return re},changeStyles:function(){return Re},changeTextNodeContent:function(){return ne},childNodesAsArray:function(){return ae},childrenAsArray:function(){return oe},clearAriaLabel:function(){return qe},clearStyle:function(){return ut},createButton:function(){return we},createCheckbox:function(){return xe},createDiv:function(){return ge},createH1:function(){return Pe},createH2:function(){return Le},createHtml:function(){return ee},createImg:function(){return Me},createInput:function(){return ye},createLabel:function(){return ke},createLi:function(){return be},createSpan:function(){return Ce},createTextNode:function(){return te},createUl:function(){return me},detachElement:function(){return pe},documentIsDefined:function(){return ie},eltAsString:function(){return J},findChildIndex:function(){return ue},getClasses:function(){return rt},getDistanceBetweenPoints:function(){return pt},getDistanceToMoveRect:function(){return lt},getFirstChildWithClasses:function(){return ce},getIntersection:function(){return yt},getMaxRect:function(){return ft},getMovedRect:function(){return dt},getRect:function(){return ct},getRectCenter:function(){return ht},getRectIntersectionCandidates:function(){return vt},hasAriaLabel:function(){return _e},hasClass:function(){return Qe},insertChild:function(){return gt},intersectionBottomSide:function(){return wt},intersectionLeftSide:function(){return kt},intersectionRightSide:function(){return mt},intersectionTopSide:function(){return bt},inverseClass:function(){return Xe},isAnHtmlElement:function(){return Y},isDisplayed:function(){return ze},isPointIntersectingCircle:function(){return Je},reattachElement:function(){return ve},removeAllChildren:function(){return fe},removeAriaLabel:function(){return Oe},removeAriaLive:function(){return Ae},removeChildById:function(){return he},removeClass:function(){return ot},removeClasses:function(){return at},removeElementById:function(){return de},replaceClasses:function(){return st},setAriaHidden:function(){return Ee},setAriaLabel:function(){return Fe},setAriaLabelledBy:function(){return Se},setAriaLivePolite:function(){return Ie},setButtonRole:function(){return De},setDisplay:function(){return Ne},setDisplayNone:function(){return Ve},setPosition:function(){return We},setPositionAttributes:function(){return Ge},setPresentationRole:function(){return Be},setRole:function(){return Te},setWidthAndHeight:function(){return Ze},setZIndex:function(){return He},setZeroTabIndex:function(){return je},switchClass:function(){return et},switchClasses:function(){return tt},unsetDisplayNone:function(){return Ue}});var t={};r.r(t),r.d(t,{arrayEquals:function(){return Zt},camelCaseToKebabCase:function(){return tr},camelCaseToSnakeCase:function(){return nr},capitalizeString:function(){return It},chunkArray:function(){return jt},compareBounds:function(){return Kt},convertToCurrency:function(){return vr},countDecimals:function(){return Ht},fastHash:function(){return Jt},firstDefinedKey:function(){return Ot},firstDefinedValue:function(){return _t},firstDefinedValueAndKey:function(){return St},getBalancedRate:function(){return fr},getMinPrice:function(){return Wt},getMultiLineLabelText:function(){return dr},getPaddedZoomAndCenter:function(){return lr},getPaddingPixels:function(){return sr},hashCode:function(){return pr},identifyDecimalSeparatorForPrice:function(){return qt},intToHexString:function(){return Xt},isArray:function(){return Tt},isObject:function(){return At},kebabCaseToCamelCase:function(){return er},listHashKeysSorted:function(){return Gt},opacityDecimalToHex:function(){return $t},parseClientPadding:function(){return ur},randomAlphaNumeric:function(){return Yt},removeDuplicates:function(){return Rt},round:function(){return Ut},roundLatLng:function(){return zt},roundLatOrLng:function(){return Vt},roundZoom:function(){return Nt},snakeCaseToCamelCase:function(){return rr},sortDeeplyObjectAndArray:function(){return Dt},sortHashKeys:function(){return ar},splitLabelTextIntoLines:function(){return cr},stringify:function(){return Bt},transformHistoricalBboxOutput:function(){return ir},undefNullEmpty:function(){return Et},verifyKeyIsLegal:function(){return hr}});var i={};r.r(i),r.d(i,{getCookieValue:function(){return Hr},promiseAllSettled:function(){return zr},timeoutFetch:function(){return Kr}});var o={};r.r(o),r.d(o,{bounce:function(){return tn}});var a={};r.r(a),r.d(a,{addMeterToLat:function(){return Dn},areBoundsCrossingDateLine:function(){return En},areCoordinatesCrossingDateLine:function(){return Sn},areLongitudesCrossingDateLine:function(){return On},computeTileDistance:function(){return Bn},computeTilesIds:function(){return Mn},computeZoomFromBBox:function(){return Ln},directionFromOrigin:function(){return An},furthestLatOrLong:function(){return In}});var s={};r.r(s),r.d(s,{areIconsDifferent:function(){return Zn},ensureImageIsLoaded:function(){return Hn},events:function(){return Nn},extractImgSourcesFromIcons:function(){return Vn},flatIcons:function(){return Kn},flatSuppIcons:function(){return zn},preloadIcons:function(){return Un}});var u={};r.r(u),r.d(u,{bounceMarker:function(){return Ua},createBasicTextMarker:function(){return Ia},createCornerIcons:function(){return Ka},createDoubleClickEventCanceller:function(){return Xa},createImageIcon:function(){return Ea},createInnerIcons:function(){return Ha},haveCornerIconsChanged:function(){return qa},haveInnerIconsChanged:function(){return Wa},identifyCornerIcons:function(){return Qa},identifyInnerIcons:function(){return $a},identifyMarkerLabelsProperties:function(){return Ta},identifyMarkerProperties:function(){return Ba},refreshLabel:function(){return Ra},setAccessibilityFields:function(){return ja},setMarkerIcons:function(){return Na},setMarkerZIndex:function(){return Va},switchAriaLabel:function(){return Da}});var l={};r.r(l),r.d(l,{collisionCssClass:function(){return eu},createLabels:function(){return ru},getRectOfMarkerLabel:function(){return ou}}),r(501);var c=6371008.8,f={centimeters:637100880,centimetres:637100880,degrees:57.22891354143274,feet:20902260.511392,inches:39.37*c,kilometers:6371.0088,kilometres:6371.0088,meters:c,metres:c,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:c/1852,radians:1,yards:6967335.223679999};n b(e,t,r,n){void 0===n&&(n={});var i=e),o=g(i[0]),a=g(i[1]),s=g(r),u=v(t,n.units),l=Math.asin(Math.sin(a)*Math.cos(u)+Math.cos(a)*Math.sin(u)*Math.cos(s));return h([y(o+Math.atan2(Math.sin(s)*Math.sin(u)*Math.cos(a),Math.cos(u)-Math.sin(a)*Math.sin(l))),y(l)],n.properties)}var k=function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==w(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==w(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n.key,"string"),"symbol"===w(i)?i:String(i)),n)}var i}var P=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,(r=[{key:"getClustersAndFeatures",value:])&&C(t.prototype,r),n&&C(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(); O=e=>e[0],S=onst I={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:,A=Math.fround||(T=new Float32Array(1),;var T;H(e){return e.x}ar q=r(744),W=r.n(q);function G(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||$(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Q(e){return function(e){if(Array.isArray(e))return X(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||$(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $(e,t){if(e){if("string"==typeof e)return X(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?X(e,t):void 0}}function X(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}nction ee(e,t,r,n,i,o,a){var s=document.createElement(t);return e&&(s.id=e),i&&(s.style.cssText=i),n&&(s.className=n),a&&nt(s,a),r&&r.appendChild(s),o&&o.length>0&&te(s,o),s}function te(e,t){var r=document.createTextNode(t);return e&&e.appendChild(r),r}function re(e,t){var r=ae(e).filter((function(e){return e.nodeType===Node.TEXT_NODE}));return 1===r.length&&(ne(r[0],t),!0)}nction oe(e){var t=[];if(null!=e&&e.children)for(var r=0;r<e.children.length;r++)t.push(e.children[r]);return t}function ae(e){var t=[];if(null!=e&&e.childNodes)for(var r=0;r<e.childNodes.length;r++)t.push(e.childNodes[r]);return t}function se(e,t){return le(e,t?function(e){if("string"==typeof e.className){var r,n=(null===(r=e.className)||void 0===r?void 0:r.split(" "))||[];return t.every((function(e){return n.includes(e)}))}return!1}:function(){return!0},arguments.length>2&&void 0!==arguments[2]&&arguments[2],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[])}function ue(e){if(e){var t=e.parentNode;return Array.prototype.indexOf.call(t.children,e)}return-1}function le(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(e&&e.children)for(var i=0;i<e.children.length;i++){var o=e.children[i];o&&(t(o)&&n.push({element:o,parent:e,index:i}),r&&le(o,t,r,n))}return n}function ce(e,t){var r;return null===(r=se(e,t,arguments.length>2&&void 0!==arguments[2]&&arguments[2],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[]))||void 0===r||null===(r=r[0])||void 0===r?void 0:r.element}nction he(e,t){if(e){var r=document.getElementById(t);r&&r.parentNode&&r.parentNode===e&&e.removeChild(r)}}function pe(e){var t;e&&(null===(t=e.parentNode)||void 0===t||t.removeChild(e))}function ve(e,t){var r;e&&(null===(r=e.parentNode)||void 0===r||r.removeChild(e),null==t||t.appendChild(e))}function ye(e,t,r,n,i,o,a,s){var u=ee(e,"input",r,n,i,void 0,s);return u.type=t,o&&(u.value=o),Fe(u,a),u}function ge(e,t,r,n,i){return ee(e,"div",t,r,n,void 0,i)}function me(e,t,r,n,i){return ee(e,"ul",t,r,n,void 0,i)}function be(e,t,r,n,i,o){return ee(e,"li",t,r,n,i,o)}function ke(e,t,r,n,i,o){return ee(e,"label",t,r,n,i,o)}function we(e,t,r,n,i,o){return ee(e,"button",t,r,n,i,o)}function Ce(e,t,r,n,i,o){return ee(e,"span",t,r,n,i,o)}function Pe(e,t,r,n,i,o){return ee(e,"h1",t,r,n,i,o)}function Le(e,t,r,n,i,o){return ee(e,"h2",t,r,n,i,o)}function xe(e,t,r,n,i,o,a,s){var u=ye(e,"checkbox",t,r,n,i,a,s);return o&&(u.checked=!0),u}function Me(e,t,r,n,i,o,a){var s=ee(e,"img",t,r,n,void 0,a);return i&&(s.src=i),Fe(s,o),s}function Fe(e,t){e&&t&&e.setAttribute("aria-label",t)}function _e(e){if(e){var t=e.getAttribute("aria-label");return((null==t?void 0:t.length)||0)>0}return!1}function Oe(e){e&&e.removeAttribute("aria-label")}function Se(e,t){e&&e.setAttribute("aria-labelledby",t)}function Ee(e){e&&e.setAttribute("aria-hidden","true")}function Ie(e){e&&e.setAttribute("aria-live","polite")}function Ae(e){e&&e.removeAttribute("aria-live")}function Te(e,t){e&&("presentation"===t&&e.setAttribute("aria-hidden","true"),e.setAttribute("role",t))}function Be(e){Te(e,"presentation")}function De(e){Te(e,"button")}unction Re(e,t){var r,n=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=$(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}(t);try{for(n.s();!(r=n.n()).done;){var i=r.value,o=i.indexOf(":"),a=i.slice(0,o).trim(),s=i.slice(o+1).trim();e.style[a]=s}}catch(e){n.e(e)}finally{n.f()}}unction Ve(e){Ne(e,"none")}unction ze(e){if(e)return!e.style.display||"none"!==e.style.display}unction He(e,t){e&&(e.style.zIndex="".concat(t))}function Ze(e,t,r){e&&(void 0!==t&&(e.style.width="number"==typeof t?"".concat(t,"px"):t),void 0!==r&&(e.style.height="number"==typeof r?"".concat(r,"px"):r))}function qe(e){e&&e.removeAttribute("aria-label")}function We(e,t,r,n,i,o){if(e){var a=void 0!==i?2*i:e.offsetWidth,s=Math.floor(a/2),u=void 0!==o?2*o:e.offsetHeight,l=Math.floor(u/2),c=0,f=0;if(n)switch(n){case"top":c=-s,f=0;break;case"middle":c=-s,f=-l;break;case"bottom":c=-s,f=-u;break;case"left":c=0,f=-l;break;case"right":c=-a,f=-l;break;case"top-left":c=0,f=0;break;case"top-right":c=-a,f=0;break;case"bottom-left":c=0,f=-u;break;case"bottom-right":c=-a,f=-u}Ge(e,{left:"".concat(Math.round(t+c),"px"),top:"".concat(Math.round(r+f),"px")})}}function Ge(e,t){var r=t.bottom,n=t.left,i=t.right,o=t.top;e&&(r||n||i||o)&&(e.style.top=null!=o?o:"",e.style.bottom=null!=r?r:"",e.style.left=null!=n?n:"",e.style.right=null!=i?i:"")}function Qe(e,t){var r;return!!e&&((null===(r=e.className)||void 0===r?void 0:r.split(" "))||[]).includes(t)}function $e(e,t){return e.left<t.left+t.width&&e.left+e.width>t.left&&e.top<t.top+t.height&&e.top+e.height>t.top}function Xe(e,t,r){e&&(Qe(e,t)?et(e,t,r):Qe(e,r)&&et(e,r,t))}function Ye(e,t){return Je(e.right,e.top,t)||Je(e.left,e.top,t)||Je(e.left,e.bottom,t)||Je(e.right,e.bottom,t)||Je(e.center.x,e.center.y,t)}function Je(e,t,r){return Math.sqrt((e-r.center.x)*(e-r.center.x)+(t-r.center.y)*(t-r.center.y))<r.radius}function et(e,t,r){tt(e,[t],[r])}function tt(e,t,r){if(e){var n,i=(null===(n=e.className)||void 0===n?void 0:n.split(" "))||[];t&&t.forEach((function(e){i.indexOf(e)>=0&&i.splice(i.indexOf(e),1)})),r&&r.forEach((function(e){i.includes(e)||i.push(e)})),e.className=i.filter((function(e){return e.length>0})).join(" ")}}function rt(e){var t;return(null==e||null===(t=e.className)||void 0===t?void 0:t.split(" "))||[]}function nt(e,t){if(e){var r,n=(null===(r=e.className)||void 0===r?void 0:r.split(" "))||[];n.includes(t)||n.push(t),e.className=n.filter((function(e){return e.length>0})).join(" ")}}function it(e,t){if(e){var r,n=null===(r=e.className)||void 0===r?void 0:r.split(" ");t.forEach((),e.className=n.filter((function(e){return e.length>0})).join(" ")}}function ot(e,t){if(e){var r,n=(null===(r=e.className)||void 0===r?void 0:r.split(" "))||[];n.indexOf(t)>=0&&n.splice(n.indexOf(t),1),e.className=n.filter((function(e){return e.length>0})).join(" ")}}function at(e,t){if(e){var r,n=null===(r=e.className)||void 0===r?void 0:r.split(" ");t.forEach((function(e){n.indexOf(e)>=0&&n.splice(n.indexOf(e),1)})),e.className=n.filter(().join(" ")}}nction lt(e,t,r){var n=(t.center.y-e.center.y)/(t.center.x-e.center.x),i=pt(e.center,t.center),o=n!==-1/0?t.center.y-n*t.center.x:void 0,a={from:yt(t,n,o,-i.x,-i.y),to:yt(e,n,o,i.x,i.y)};return pt(a.from||t.center,a.to||e.center,r)}function ct(e,t,r){return{center:e,width:t,height:r,left:e.x-t/2,top:e.y-r/2,right:e.x+t/2,bottom:e.y+r/2}}function ft(e){var t={bottom:Math.max.apply(Math,Q(e.map((function(e){return e.bottom})))),left:Math.min.apply(Math,Q(e.map((function(e){return e.left})))),right:Math.max.apply(Math,Q(e.map((function(e){return e.right})))),top:Math.min.apply(Math,Q(e.map((function(e){return e.top}))))};return t.center=ht(t),t.width=t.right-t.left,t.height=t.bottom-t.top,t}function dt(e,t){var r={bottom:e.bottom+t.y,left:e.left+t.x,right:e.right+t.x,top:e.top+t.y,height:e.height,width:e.width};return r.center=ht(r),r}function ht(e){return{x:(e.right-e.left)/2+e.left,y:(e.bottom-e.top)/2+e.top}}function pt(e,t,r){var n=t.x-e.x,i=t.y-e.y;return{x:n+(r?r*Math.sign(n):0),y:i+(r?r*Math.sign(i):0)}}function vt(e,t){return e>0&&0===t?"right":0===e&&t<0?"top":e<0&&0===t?"left":0===e&&t>0?"bottom":e>0&&t<0?"topOrRight":e<0&&t<0?"topOrLeft":e<0&&t>0?"bottomOrLeft":e>0&&t>0?"bottomOrRight":void 0}function yt(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;switch(vt(arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0)){case"right":return mt(e,t,r);case"top":return bt(e,t,r);case"left":return kt(e,t,r);case"bottom":return wt(e,t,r);case"topOrRight":return bt(e,t,r)?bt(e,t,r):mt(e,t,r);case"topOrLeft":return kt(e,t,r)?kt(e,t,r):bt(e,t,r);case"bottomOrLeft":return wt(e,t,r)?wt(e,t,r):kt(e,t,r);case"bottomOrRight":return mt(e,t,r)?mt(e,t,r):wt(e,t,r)}}function gt(e,t,r){if(e&&t)if(r>=t.children.length)t.appendChild(e);else{var n=oe(t)[r];t.insertBefore(e,n)}}function mt(e,t,r){var n=t*e.right+r;if(n>=e.top&&n<=e.bottom)return{x:e.right,y:n}}function bt(e,t,r){var n=t!==-1/0?(e.top-r)/t:e.center.x;if(n>=e.left&&n<=e.right)return{x:n,y:e.top}}function kt(e,t,r){var n=t*e.left+r;if(n>=e.top&&n<=e.bottom)return{x:e.left,y:n}}function wt(e,t,r){var n=t!==-1/0?(e.bottom-r)/t:e.center.x;if(n>=e.left&&n<=e.right)return{x:n,y:e.bottom}}function Ct(e,t,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:r.g.document;if(o){var a=G(o.getElementsByTagName("head"),1)[0];if(a){var s=o.createElement("style");s.id=e,s.setAttribute("data-meta",t),a.appendChild(s);var u,l=s.sheet;if(l)if(void 0!==l.insertRule)u=function(e,t,r){return e.insertRule(t+"{"+r+"}",e.cssRules.length)};else{if(void 0===l.addRule)throw new Error("no insertRule or addRule in sheet");u=var c=[];Object.keys(i).forEach((function(e){var t=i[e],r=".egmaps.".concat(n," ").concat(e),o=Object.keys(t).map((function(e){return"".concat(tr(e),":").concat(t[e]||"''")})).join(";");u(l,r,o),c.push("".concat(r," {\n  ").concat(o.split(";").join(";\n  "),";\n}"))}));var f=o.createTextNode(c.join("\n\n"));s.appendChild(f)}}}function Pt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||Mt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lt(e){return function(e){if(Array.isArray(e))return Ft(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Mt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xt(e){return xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xt(e)}function Mt(e,t){if(e){if("string"==typeof e)return Ft(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ft(e,t):void 0}}function Ft(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _t(e,t){return(St(e,t)||{}).value}function Ot(e,t){return(St(e,t)||{}).key}function St(e,t){if(t){var r,n=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Mt(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}(t);try{for(n.s();!(r=n.n()).done;){var i=r.value;if(i){var o=null==e?void 0:e[i];if(void 0!==o)return{key:i,value:o}}}}catch(e){n.e(e)}finally{n.f()}}}nction At(e){return null!==e&&"object"===xt(e)&&!Y(e)&&"[object Array]"!==Object.prototype.toString.call(e)}unction Bt(e){return JSON.stringify(e,(t=new WeakSet,);var t}function Dt(e){if(e){if(Tt(e))return e.sort();if(At(e)){var t;if("Object"===(null===(t=e.constructor)||void 0===t?void 0:t.name)){var r={};return Object.keys(e).sort().forEach((),r}return e}return e}return e}function jt(e,t){if(t<=0)throw new Error("chunk size should be greater than 0");var r=0,n=e.length,i=[];for(r=0;r<n;r+=t){var o=e.slice(r,r+t);i.push(o)}return i}function Rt(e){return e&&0!==e.length?Lt(new Set(e)):[]}unction Vt(e){var t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=Ut(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:5);if(t){if(r<-180)return r+360;if(r>180)return r-360}return r}function Ut(e,t){var r=Math.pow(10,t),n=e*r;return(n=Math.round(n))/r}function zt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=e.lat,i=e.lng;if(!n){var o=Pt(e,2);n=o[0],i=o[1]}return[Vt(n,t,!1),Vt(i,t,r)]}function Kt(e,t){if(!e)return!t;if(!t)return!1;var r=e.sw,n=e.ne,i=e.center,o=t.sw,a=t.ne,s=t.center;return r[0]===o[0]&&r[1]===o[1]&&n[0]===a[0]&&n[1]===a[1]&&i[0]===s[0]&&i[1]===s[1]}function Ht(e){var t=Number(e);return Math.floor(t.valueOf())===t.valueOf()?0:t.toString().split(".")[1].length||0}function Zt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:if(e.length!==t.length)return!1;var i=t.slice();return e.every((function(e,t){var o=i.findIndex(();return o>=0&&(!r||t===o)}))}function qt(e){var t=e.indexOf("."),r=e.indexOf(",");if(-1!==t||-1!==r){var n=r>t?",":".",i=r>t?r:t;if(e.length<=i+3)return n;for(var o=i+1;o<=i+3;o++){var a=e.charAt(o);if(isNaN(a)||" "===a)return n}if(e.length>=i+4){var s=e[i+4];if(!isNaN(s)&&" "!==s)return n}}}function Wt(e){for(var t,r,n=0;n<e.length;n++){var i=e[n];if(!t&&"string"==typeof i){var o=qt(i);o&&(r=(t=o)&&","===t?".":",")}}var a=void 0,s=void 0;if(e.forEach((function(e){var n=t?W()(e,{decimal:t,separator:r}).value:W()(e).value;(!a||a>n)&&(a=n,s=e)})),a&&isFinite(a))return s}function Gt(e,t,r){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=r?r.sort():[],o=[],a=function(e){for(var t=e.depth;t>=0;t--)for(var r=e[t],n=r.maxQualifiers;n>=0;n--)r[n]&&(o=o.concat(r[n]))};if(t){var s={depth:1,0:["hl"]};Qt("hl#",i.slice(),e,s,1,0),a(s),e&&o.push(["hl",e].sort().join("#")),o.push("hl")}var u={depth:-1};return Qt("",i.slice(),e,u,0,0),a(u),e&&o.push(e),n&&o.push("default"),o}function Qt(e,t,r,n,i,o){var a=n[i];for(a||(a={maxQualifiers:o},n[i]=a,n.depth=i);t.length>0;){var s=t.splice(0,1),u=o+1;if(a[u]||(a[u]=[]),a.maxQualifiers<u&&(a.maxQualifiers=u),a[u].push("".concat(e).concat(s).split("#").sort().join("#")),r){var l=n[i+1];l||(l={maxQualifiers:u},n[i+1]=l,n.depth=i+1),l[u]||(l[u]=[]),l[u].push("".concat(e).concat(s,"#").concat(r).split("#").sort().join("#"))}t.length>0&&Qt("".concat(e).concat(s,"#"),t.slice(),r,n,i+1,o+1)}}unction Xt(e){var t=parseInt(e);t<0&&(t=4294967295+t);var r=t.toString(16).toUpperCase();return 1==r.length?r+"0":r.slice(-2)}function Yt(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<e;n++)t+=r.charAt(Math.floor(62*Math.random()));return t}function Jt(e){return e.split("").reduce((function(e,t){var r=(e<<5)-e+t.charCodeAt(0);return r&r}),0)}function er(e){return e.split("-").map((function(e,t){return 0===t?e.charAt(0).toLowerCase()+e.slice(1):e.charAt(0).toUpperCase()+e.slice(1)})).join("")}function tr(e){var t=[];return e.split("").forEach((function(e,r){var n=e.toUpperCase();e===n&&e.toLowerCase()!==n?r>0?t.push("-",e.toLowerCase()):t.push(e.toLowerCase()):t.push(e)})),t.join("")}function rr(e){return e.split("_").map((function(e,t){return 0===t?e.charAt(0).toLowerCase()+e.slice(1):e.charAt(0).toUpperCase()+e.slice(1)})).join("")}function nr(e){var t=[];return e.split("").forEach((function(e,r){var n=e.toUpperCase();e===n&&e.toLowerCase()!==n?r>0?t.push("_",e.toLowerCase()):t.push(e.toLowerCase()):t.push(e)})),t.join("")}function ir(e){return e.substring(e.indexOf("((")+2,e.lastIndexOf("))")).split(", ").map((function(e){return e.split(" ")})).map((function(e){return{lng:Number(parseFloat(e[0]).toFixed(8)),lat:Number(parseFloat(e[1]).toFixed(8))}}))}var or=function(e,t,r){t.has(r)&&(e.push(r),t.delete(r))},ar=function(e){var t=["available","filtered","sold_out","unknown"],r=new Set,n=new Set;e.forEach((function(e){(function(e){return["available","filtered","sold_out","unknown"].some(()})(e)||-1!==e.indexOf("hl")||-1!==e.indexOf("default")||e.split("#").forEach((function(e){return n.add(e)})),r.add(e)}));var i=[];or(i,r,"default"),t.forEach(();var o=Array.from(n).sort(),a=function(e,t){for(var r=function e(t,r,n,i){if(0!=t)for(var o=0;o<r.length;o++)e(t-1,r.slice(o+1),n.concat([r[o]]),i);else n.length>0&&(i[i.length]=n)},n=[],i=1;i<e.length;i++)r(i,e,[],n);return n.push(e),n}(o).map((function(e){return e.join("#")}));if(o.length>0){for(var s=function(e){for(var n=o.length-1;n>=0;n--)or(i,r,a[e+n]);for(var s=function(n){t.forEach((function(t){for(var s=o.length;s>=0;s--)or(i,r,"".concat(t,"#").concat(a[e+n]))}))},u=o.length-1;u>=0;u--)s(u)},u=0;u<a.length-1;u+=o.length)s(u);or(i,r,a[a.length-1]),t.forEach((function(e){return or(i,r,"".concat(e,"#").concat(a[a.length-1]))}))}if(or(i,r,"hl"),t.forEach((function(e){return or(i,r,"".concat(e,"#hl"))})),o.length>0){for(var l=function(e){for(var n=o.length-1;n>=0;n--)or(i,r,"hl#".concat(a[e+n]));for(var s=function(n){t.forEach((function(t){for(var s=o.length;s>=0;s--)or(i,r,"".concat(t,"#hl#").concat(a[e+n]))}))},u=o.length-1;u>=0;u--)s(u)},c=0;c<a.length-1;c+=o.length)l(c);or(i,r,"hl#".concat(a[a.length-1])),t.forEach((function(e){return or(i,r,"".concat(e,"#hl#").concat(a[a.length-1]))}))}return i.reverse()};function sr(e,t,r){var n;return n="%"===t?parseFloat(e)*r/100:parseFloat(e),Number.isFinite(n)?n:void 0}function ur(e,t){var r,n;if(void 0!==e){if("string"!=typeof e)throw new Error("Client padding has to be of type string");var i=t||{},o=i.clientHeight,a=i.clientWidth;if(!Number.isFinite(o)||!Number.isFinite(a))throw new Error("Dimensions of map element have to be of type number: {height: ".concat(o,", width: ").concat(a,"}"));var s=e.match(/^(((\d+)(\.\d+)?)(px|%|))( ((\d+)(\.\d+)?)(px|%|))?( ((\d+)(\.\d+)?)(px|%|))?( ((\d+)(\.\d+)?)(px|%|))?$/);if(!s)throw new Error("Client padding has to follow CSS syntax and only use 'px' and '%' units");var u=Pt(s,21),l=u[2],c=u[5],f=u[7],d=u[10],h=u[12],p=u[15],v=u[17],y=u[20];return{paddingTop:sr(l,c,o),paddingRight:sr(null!=f?f:l,null!=d?d:c,a),paddingBottom:sr(null!=h?h:l,null!=p?p:c,o),paddingLeft:sr(null!==(r=null!=v?v:f)&&void 0!==r?r:l,null!==(n=null!=y?y:d)&&void 0!==n?n:c,a)}}}function lr(e,t,r){var n=zt(t);if(r){var i=r.paddingTop,o=void 0===i?0:i,a=r.paddingRight,s=void 0===a?0:a,u=r.paddingBottom,l=void 0===u?0:u,c=r.paddingLeft,f=void 0===c?0:c,d=Math.pow(2,Nt(e+1)),h=[(o-l)/d,(s-f)/d];n=zt(n.map(())}return{zoom:Nt(e),center:n}}function cr(e,t,r){var n=parseInt(t),i=parseInt(r),o=String(e);if(o&&n&&i&&n>0&&i>0&&o.length>n){for(var a=o.replace(/[\u0000-\u001F\u007F-\u009F]/g," ").trim().split(/\s+/g).map((),s=[],u=[],l=0;a.length>0&&u.length<=i;){var c=Pt(a,1)[0];((l+=c.length)<=n||l>n&&0===s.length)&&(s.push(c.join("")),a.shift()),(l>=n||l<n&&0===a.length)&&(u.push(s.join(" ")),s=[],l=0)}return u.length>i&&(u.pop(),u.push(u.pop()+"...")),u.join("\n")}return o}function fr(e){var t=e.split("\n").map(();if(1===t.length)return 0;var r=Math.max.apply(Math,Lt(t));return Math.min.apply(Math,Lt(t))/r}function dr(e,t,r){for(var n=String(e),i=0,o=Math.min(Math.floor(n.length/r),t),a=t;a>=o;){var s=cr(e,a,r),u=fr(s);if(!u||0===u||u>=.5)return s;u>i&&(n=s,i=u),a--}return n}nction vr(e,t,r,n){if(!e||isNaN(e))return e;var i=t||Ht(e),o={style:"currency",currency:r,minimumFractionDigits:i,maximumFractionDigits:i};return new Intl.NumberFormat(n,o).format(e)}function yr(e){return yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yr(e)}function gr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||mr(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mr(e,t){if(e){if("string"==typeof e)return br(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?br(e,t):void 0}}function br(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function kr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==yr(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==yr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n.key,"string"),"symbol"===yr(i)?i:String(i)),n)}var i}function wr(e,t){return wr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},wr(e,t)}function Cr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Pr(e);if(t){var i=Pr(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"===yr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function Pr(e){return Pr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Pr(e)}var Lr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wr(e,t)}(o,e);var t,r,n,i=Cr(o);function o(e,t,r,n){var a,s,u,l,c,f,d;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(d=i.call(this)).logger=e("SuperCluster"),d._config=t,d._defaultConfig=r,d.labelKey=null!==(a=d._config.labelKey)&&void 0!==a?a:r.labelKey||"unknown",d._radius=null!==(s=null!==(u=null===(l=d._config.superclusterSettings)||void 0===l?void 0:l.radius)&&void 0!==u?u:null===(c=r.superclusterSettings)||void 0===c?void 0:c.radius)&&void 0!==s?s:0,d._previousMapSize=void 0,d._mapSize=void 0,d._tileDim=void 0,d._supercluster=void 0,d.qualifier=n,d.excludedQualifiers=null!==(f=d._config.excludedQualifiers)&&void 0!==f?f:r.excludedQualifiers,d}return t=o,r=[{key:"radius",get:function(){if(!this._tileDim||!this._mapSize)return 0;var e=this._tileDim,t=e.width,r=e.height,n=this._mapSize,i=75*n.clientWidth/t,o=75*n.clientHeight/r;return Math.min(this._radius,i,o)}},{key:"supercluster",get:function(){var e,t,r,n=this._previousMapSize||{},i=n.clientWidth,o=n.clientHeight,a=this._mapSize||{},s=a.clientWidth,u=a.clientHeight;return this._supercluster&&i===s&&o===u||(this._supercluster=new B({minPoints:null!==(e=this._config.minPoints)&&void 0!==e?e:this._defaultConfig.minPoints,minZoom:null!==(t=this._config.minZoom)&&void 0!==t?t:this._defaultConfig.minZoom,maxZoom:null!==(r=this._config.maxZoom)&&void 0!==r?r:this._defaultConfig.maxZoom,radius:this.radius})),this._supercluster}},{key:"getClustersAndFeatures",value:function(e,t,r,n,i,o,a){this._previousMapSize=this._mapSize,this._mapSize=o,this._tileDim=a;var s=e.remainingFeatures,u=e.clusters,l=this._getExcludedFeatures(s,r),c=l.map((function(e){return e.id})),f=s.filter((),d=this._loadFeaturesForClustering(f);return this._clusterFeatures(d,u,t,l,n,i)}},{key:"_loadFeaturesForClustering",value:function(e){var t=this,r=e.map(();return this.supercluster.load(r)}},{key:"_clusterFeatures",value:function(e,t,r,n,i,o){var a=this._convertBoundsToBbox(i),s=e.getClusters(a,Math.floor(o));return this._getAllFeaturesAndClusters(e,t,r,n,s)}},{key:"_convertBoundsToBbox",value:function(e){return[e.sw[1],e.sw[0],e.ne[1],e.ne[0]]}},{key:"_makeGeoJsonFeature",value:function(e){var t=[e.latLng[1],e.latLng[0]];return{id:e.id,type:"Feature",geometry:{type:"Point",coordinates:t},properties:e}}},{key:"_getAllFeaturesAndClusters",value:function(e,t,r,n,i){var o,a={clusters:t,remainingFeatures:n},s=i);try{for(s.s();!(o=s.n()).done;){var u=o.value;if(u.properties.cluster){var l=u.properties.cluster_id,c=e.getLeaves(l,1/0),f=Wt(c.map(())||0,d=gr(u.geometry.coordinates,2),h=d[0],p={id:l,children:c,minPrice:f,lat:d[1],lng:h,type:"cluster",radius:this.radius};a.clusters.push({cluster:p,labelKey:this.labelKey,featureType:r,qualifier:this.qualifier})}else a.remainingFeatures.push(u.properties)}}catch(e){s.e(e)}finally{s.f()}return a}},{key:"_getExcludedFeatures",value:function(e,t){var r=this;return e.filter((function(e){var n;return(e.qualifiers||[]).some(()||!(null!==(n=e.hashKeys)&&void 0!==n&&n.includes(t))}))}}],r&&kr(t.prototype,r),n&&kr(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}(P);function xr(e,t){return xr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},xr(e,t)}function Mr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Fr(e);if(t){var i=Fr(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"===_r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function Fr(e){return Fr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Fr(e)}function _r(e){return _r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_r(e)}function Or(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==_r(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==_r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n.key,"string"),"symbol"===_r(i)?i:String(i)),n)}var i}function Er(e,t,r){return t&&Sr(e.prototype,t),r&&Sr(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Ir={OFF:"OFF",DEBUG:"DEBUG",INFO:"INFO",WARN:"WARN",ERROR:"ERROR"};function Ar(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=r?new Br:null!=t?t:new Br;return{debug:function(t,i){return n.debug({loggerName:e,message:t,stack:i,debugMode:r})},info:function(t,i){return n.info({loggerName:e,message:t,stack:i,debugMode:r})},warn:function(t,i){return n.warn({loggerName:e,message:t,stack:i,debugMode:r})},error:debugEnabled:function(){return n.debugEnabled()},infoEnabled:function(){return n.infoEnabled()},warnEnabled:function(){return n.warnEnabled()},errorEnabled:function(){return n.errorEnabled()}}}var Tr=function(){eturn Er(e,[{key:"log",value:,{key:"enabled",value:,{key:"debug",value:function(e){var t=e.loggerName,r=e.message,n=e.stack,i=e.debugMode;return this.log(t,Ir.DEBUG,r,n,i)}},{key:"info",value:function(e){var t=e.loggerName,r=e.message,n=e.stack,i=e.debugMode;return this.log(t,Ir.INFO,r,n,i)}},{key:"warn",value:function(e){var t=e.loggerName,r=e.message,n=e.stack,i=e.debugMode;return this.log(t,Ir.WARN,r,n,i)}},{key:"error",value:function(e){var t=e.loggerName,r=e.message,n=e.stack,i=e.debugMode;return this.log(t,Ir.ERROR,r,n,i)}},{key:"debugEnabled",value:function(){return this.enabled(Ir.DEBUG)}},{key:"infoEnabled",value:function(){return this.enabled(Ir.INFO)}},{key:"warnEnabled",value:function(){return this.enabled(Ir.WARN)}},{key:"errorEnabled",value:]),e}(),Br=function(e){!r,e);var t=Mr(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ir.WARN,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e,t,r){return"".concat((new Date).toISOString()," EGMAPS-").concat("6.3.4"," ").concat(e||"undefined"," ").concat(t," ").concat(r)};return Or(this,r),(e=t.call(this)).formatter=i,e.level=n,e}return Er(r,[{key:"enabled",value:function(e){if(this.level!==Ir.OFF)switch(e){case Ir.DEBUG:return this.level===Ir.DEBUG;case Ir.INFO:return this.level===Ir.DEBUG||this.level===Ir.INFO;case Ir.WARN:return this.level===Ir.DEBUG||this.level===Ir.INFO||this.level===Ir.WARN;case Ir.ERROR:return this.level===Ir.DEBUG||this.level===Ir.INFO||this.level===Ir.WARN||this.level===Ir.ERROR;default:throw new Error("level not implemented: ".concat(e))}return!1}},{key:"log",value:function(e,t,r,n,i){var o,a,s,u;if(this.enabled(t||Ir.INFO)||i){var l=[this.formatter(e,t||Ir.INFO,r)];switch(n&&l.push(n),t){case Ir.DEBUG:(o=console).debug.apply(o,l);break;case Ir.INFO:default:(a=console).info.apply(a,l);break;case Ir.WARN:(s=console).warn.apply(s,l);break;case Ir.ERROR:(u=console).error.apply(u,l)}return!0}}}]),r}(Tr);function Dr(e){return Dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dr(e)}function jr(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Rr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Rr(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function Rr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}ction zr(e){return Promise.allSettled?Promise.allSettled(e):Promise.all(e.map(())}function Kr(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("undefined"!=typeof AbortController){var i=new AbortController;return setTimeout((function(){return i.abort()}),t),fetch(e,Vr(Vr({},n),{},{signal:i.signal})).catch((function(n){if(null!=n&&n.toString().includes("The user aborted a request"))return{clone:function(){return r},redirected:!1,type:"basic",url:e,ok:!1,success:!1,status:504,headers:[],statusText:"timeout occurs after ".concat(t,"ms when fetching ").concat(e),arrayBuffer:function(){return Promise.reject(new Error("timeout occurs"))},body:null,bodyUsed:!1,blob:function(){return Promise.reject(new Error("timeout occurs"))},formData:function(){return Promise.reject(new Error("timeout occurs"))},json:function(){return Promise.reject(new Error("timeout occurs"))},text:;throw n}))}return fetch(e,n)}function Hr(e){var t,r,n=jr(null===(t=document.cookie)||void 0===t?void 0:t.split(";"));try{for(n.s();!(r=n.n()).done;){var i=r.value;if((null==i?void 0:i.substring(0,i.indexOf("=")).trim())===e){if(i.indexOf("=")+1>i.length)return;return i.substring(i.indexOf("=")+1)}}}catch(e){n.e(e)}finally{n.f()}}function Zr(e){return Zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zr(e)}function qr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==Zr(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==Zr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n.key,"string"),"symbol"===Zr(i)?i:String(i)),n)}var i}var Wr=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,(r=[{key:"_loadOptionsFromCookie",value:function(){var e=Hr("EGMAPS_DEBUG_OPTIONS");this._debugOptions=new Set(null==e?void 0:e.split(","))}},{key:"_getOptionEnabled",value:function(e){var t;return this._debugOptions||this._loadOptionsFromCookie(),!(null===(t=this._debugOptions)||void 0===t||!t.has(e))}},{key:"getDebugLoggingEnabled",value:function(){return this._getOptionEnabled("logging")}},{key:"getDebugTilesIdEnabled",value:function(){return this._getOptionEnabled("tilesId")}},{key:"getDebugMarkersPositionEnabled",value:function(){return this._getOptionEnabled("markersPosition")}},{key:"getDebugConfigEnabled",value:])&&qr(t.prototype,r),n&&qr(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}());function Gr(e){return Gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gr(e)}function Qr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||Xr(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $r(e){return function(e){if(Array.isArray(e))return Yr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Xr(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xr(e,t){if(e){if("string"==typeof e)return Yr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Yr(e,t):void 0}}function Yr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Jr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==Gr(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==Gr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n.key,"string"),"symbol"===Gr(i)?i:String(i)),n)}var i}var en=function(){function e(t,r,n){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.defaultConfig=t,this.config=r,this.overwriteConfig={},this.configurations=[r,t].filter(Boolean),this.externalConfig=void 0,this.cache=new Map,this.configLoaderLogger=this.logger("config-loader"),this.externalConfigLoaded=n?new Promise((function(e){i.externalConfig=n,i.configurations=[n].concat($r(i.configurations)),e(void 0)})):this._loadExternalConfig(null==r?void 0:r.externalConfigEndpoint,5e3).then((function(e){i.configLoaderLogger.debug("Loaded external config from ".concat(null==r?void 0:r.externalConfigEndpoint)),e&&(i.externalConfig=e,i.configurations=[e].concat($r(i.configurations)))}))}var t,r,n;return t=e,r=[{key:"ready",value:function(){var e=this;return this.externalConfigLoaded.then(()}},{key:"getConfigurations",value:,{key:"_loadExternalConfig",value:function(e,t){var r=this;return e?(arguments.length>2&&void 0!==arguments[2]?arguments[2]:Kr)(e,t).then((function(e){return e.ok?e.json().then(():(e.text().then((),null)})).catch((function(t){return r.configLoaderLogger.error("failed to load external config from ".concat(e),t),null})):Promise.resolve(null)}},{key:"logger",value:function(e){return Ar(e,this.readParam("logging,logger"),Wr.getDebugLoggingEnabled())}},{key:"clearCache",value:,{key:"writeParam",value:function(e,t){this._writeParamAux(e.split(","),t,this.overwriteConfig),this.cache.set(e,t)}},{key:"removeParam",value:,{key:"_writeParamAux",value:function(e,t,r){var n=Qr(e,1)[0];if(hr(n))if(1===e.length)r[n]=t;else{r[n]||(r[n]={});var i=r[n];e.shift(),this._writeParamAux(e,t,i)}}},{key:"readParam",value:function(e){if(this.cache.has(e)){var t=this.cache.get(e);return null===t?void 0:t}var r=e.split(","),n=this._readParamAux(r,this.overwriteConfig,this.configurations);return this.cache.set(e,n),n}},{key:"_readParamAux",value:function(e,t,r){var n=Qr(e,1)[0],i=t?t[n]:void 0;if(null!==i){for(var o=r.map(().filter((function(e){return void 0!==e})),a=0;a<o.length;a++)if(null===o[a]){o=o.splice(0,a);break}return 1===e.length?Dt(i||(o.length>0?o[0]:void 0)):(e.shift(),this._readParamAux(e,i,o))}}},{key:"listStringKeys",value:function(e){var t=this,r=[],n=[];return[this.overwriteConfig].concat($r(this.configurations)).forEach((function(i){return t._listKeysAux(r,n,(null==e?void 0:e.split(","))||[],[],i)})),r}},{key:"listKeys",value:function(e){return $r(this.listStringKeys(e).map((function(e){return e.split(",")})))}},{key:"listKeysShallow",value:function(e){return this.listStringKeys(e).map((function(t){return t.split(",").slice(0,e.split(",").length+1).join(",")})).filter(().map(()}},{key:"subConfig",value:function(e){var t=this,r={};return(e?[e]:Object.keys(this.defaultConfig)).map((function(e){var n={};return t.listStringKeys(e).map((function(r){var i=t.readParam(r);void 0!==i&&t._writeParamAux(r.substring(e.length+1).split(","),i,n)})),r[e]=n,n})),e?r[e]:r}},{key:"_listKeysAux",value:function(e,t,r,n,i){var o=[],a=i;if(r.length>0){var s=Qr(r,1)[0];a=i[s],o.push.apply(o,$r(n).concat([s]))}void 0!==a&&(r.length<=1?this._listKeysAuxDeep(e,t,o,a):(r.shift(),this._listKeysAux(e,t,r,o,a)))}},{key:"_listKeysAuxDeep",value:function(e,t,r,n){if(At(n)&&!Y(n))for(var i in n){var o=[];o.push.apply(o,$r(r).concat([i])),t.includes(o.join(","))||this._listKeysAuxDeep(e,t,o,n[i])}else r&&(t.includes(r.join(","))||(null===n?t.push(r.join(",")):this._checkIfParentPathAlreadyPresent(e,r)||e.push(r.join(","))))}},{key:"_checkIfParentPathAlreadyPresent",value:function(e,t){var r=[];t.forEach((function(t){if(r.push(t),e.includes(r.join(",")))return!0}));var n=t.join(",")+",";return e.some((function(e){return e===t.join(",")||e.startsWith(n)}))}},{key:"_fillObjectWithLeafName",value:function(e,t){var r=this;this.listKeysShallow(e).map((function(e){var n=e[e.length-1];t(n,r.readParam(e.join(",")))}))}},{key:"propertyValues",value:function(e,t,r){var n=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return e},o={};return r.map((function(r){o[r]={};var a=[e,r,t].filter(().join(",");n._fillObjectWithLeafName(a,(function(e,t){var n=e.split("#").sort().join("#");hr(r)&&hr(n)&&(o[r][n]=i(t))}))})),o}}],r&&Jr(t.prototype,r),n&&Jr(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function tn(e){var t=["animate__animated","animate__bounce"];e.addEventListener("animationend",(function r(n){at(e,t),e.removeEventListener("animationend",r)})),it(e,t)}function rn(e){return rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rn(e)}function nn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==rn(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==rn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n.key,"string"),"symbol"===rn(i)?i:String(i)),n)}var i}var on=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var i=n.readParam,o=n.writeParam;this.locale=r,this.messages=t||{},this.readParam=i,this.writeParam=o,this.variants=[],this.locale&&(this.variants.push(this.locale),r.length>2&&this.variants.push(this.locale.slice(0,2))),this.variants.push("default"),this._registerMessages(),this.hookForFormat=this.readParam("i18n,formatFunction")}var t,r,n;return t=e,r=[{key:"_registerMessages",value:function(){var e=this,t=this;this.variants.forEach((function(r){var n=e.messages[r];if(n)for(var i in n){var o="i18n,messages,".concat(i);void 0===t.readParam(o)&&t.writeParam(o,n[i])}}))}},{key:"format",value:function(e){for(var t,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return(t=this._externalFormat.apply(this,[e].concat(n)))||(t=this._internalFormat.apply(this,[e].concat(n))),t}},{key:"_externalFormat",value:function(e){if(this.hookForFormat){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return this.hookForFormat(e,r)}}},{key:"_internalFormat",value:function(e){var t=this.readParam("i18n,messages,".concat(e));if(t){for(var r=t,n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];if(i)for(var a=0;a<i.length;a++){var s=i[a];r=r.replace("{".concat(a,"}"),void 0!==s?s:"")}return r}return"".concat(e," ").concat(this.locale?this.locale:"default"," NOT FOUND")}}],r&&nn(t.prototype,r),n&&nn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();ion fn(e){return function(e){if(Array.isArray(e))return dn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return dn(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?dn(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hn(e){return hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hn(e)}function pn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==hn(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==hn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n.key,"string"),"symbol"===hn(i)?i:String(i)),n)}var i}function yn(e,t,r){return t&&vn(e.prototype,t),r&&vn(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var gn=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pn(this,e),this.isLeaf=t,this.hasExpired=r,this.cache=Object.create(null),this.listeners=new Set}return yn(e,[{key:"get",value:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(var i=this.cache[r[0]],o=1;o<r.length&&i;o++)i=i[r[o]];return i&&this.hasExpired(i,r)?(this.listeners.forEach((),void this.set.apply(this,[void 0].concat(r))):i}},{key:"keys",value:function(){for(var e=this.cache,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(var i=0;i<(null==r?void 0:r.length)&&e;i++)e=e[r[i]];return e?this._keysAux(r,e):[]}},{key:"_keysAux",value:function(e,t){var r=this;return this.isLeaf(t,e)?this.hasExpired(t,e)?[]:[e]:Object.keys(t).flatMap((function(n){return r._keysAux([].concat(fn(e),[n]),t[n])}))}},{key:"set",value:function(e){for(var t=[],r=this.cache,n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];for(var a=0;a<i.length-1;a++){if(!r[i[a]]){if(!e)return;r[i[a]]={}}t.push(r),r=r[i[a]]}if(e)r[i[i.length-1]]=e;else{delete r[i[i.length-1]];for(var s=t.length-1;s>=0&&0===Object.keys(t[s][i[s]]).length;s--)delete t[s][i[s]]}}},{key:"addListener",value:function(e){this.listeners.add(e)}},{key:"removeListener",value:]),e}();gn.EVENTS={EXPIRE:"expire"};var mn=function(e){sn(r,e);var t=ln(r);function r(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:return pn(this,r),t.call(this,n,(function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return i(t.time+e<Date.now(),t.content,n)}))}return yn(r,[{key:"set",value:function(e){for(var t,n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];(t=an(cn(r.prototype),"set",this)).call.apply(t,[this,{leaf:!0,time:Date.now(),content:e}].concat(i))}},{key:"get",value:function(){for(var e,t,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return null===(e=(t=an(cn(r.prototype),"get",this)).call.apply(t,[this].concat(i)))||void 0===e?void 0:e.content}},{key:"keys",value:function(){for(var e,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return(e=an(cn(r.prototype),"keys",this)).call.apply(e,[this].concat(n))}}]),r}(gn),bn=function(e){sn(r,e);var t=ln(r);eturn yn(r,[{key:"set",value:function(){}},{key:"get",value:function(){}}]),r}(gn);function kn(e,t,r){return!e||e<=0?new bn:new mn(e,t,r)}unction Cn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Pn=6378137;function Ln(e,t,r,n,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},a=o.zoomMax,s=void 0===a?21:a,u=o.padding,l=void 0===u?0:u,c=o.worldDimensions,f=void 0===c?{height:256,width:256}:c,d=o.parsedClientPadding,h=(Fn(n)-Fn(t))/Math.PI,p=i-r,v=(p<0?p+360:p)/360,y=e.offsetWidth,g=e.offsetHeight,m=d||{},b=m.paddingTop,k=void 0===b?0:b,w=m.paddingRight,C=void 0===w?0:w,P=m.paddingBottom,L=void 0===P?0:P,x=m.paddingLeft,M=void 0===x?0:x,F=_n(g-2*l-k-L,f.height,h),_=_n(y-2*l-C-M,f.width,v);return isFinite(F)?isFinite(_)?Math.min(F,_,s):F:_}function xn(e,t,r,n,i){var o=Math.sin(e*Math.PI/180);o=Math.min(Math.max(o,-.9999),.9999);var a=1<<r;return[Math.floor(n*(.5+t/360)*a/n),Math.floor(i*(.5-Math.log((1+o)/(1-o))/(4*Math.PI))*a/i)]}function Mn(e,t,r,n,i,o,a){for(var s=wn(xn(r,t,i,o,a),2),u=s[0],l=s[1],c=wn(xn(e,n,i,o,a),2),f=c[0],d=c[1],h=[],p=0;p<=f-u;p++)for(var v=0;v<=d-l;v++)h.push({x:u+p,y:l+v});return h}unction _n(e,t,r){return Math.floor(Math.log(e/t/r)/Math.LN2*1e3)/1e3}function On(e){var t=wn(e,1)[0],r=wn(e,1)[0];return e.forEach((function(e){t>e?t=e:r<e&&(r=e)})),e.length>1&&r-t>t+360-r}function Sn(e){return On(e.map((function(e){var t;return null!==(t=e.lng)&&void 0!==t?t:e[1]})))}function En(e,t){var r,n;return(null!==(r=t.lng)&&void 0!==r?r:t[1])<(null!==(n=e.lng)&&void 0!==n?n:e[1])}function In(e,t,r){var n=On(t)&&r,i=n?Tn(e):e,o=n?t.map(Tn):t,a=i;return o.forEach((function(e){var t=Math.abs(i-a);Math.abs(i-e)>t&&(a=e)})),Vt(a,void 0,r)}function An(e,t){var r,n,i,o,a=Sn([e,t]),s=null!==(r=e.lat)&&void 0!==r?r:e[0],u=null!==(n=e.lng)&&void 0!==n?n:e[1],l=a?Tn(u):u,c=null!==(i=t.lat)&&void 0!==i?i:t[0],f=null!==(o=t.lng)&&void 0!==o?o:t[1],d=a?Tn(f):f;return c>s?d<l?"nw":"ne":d>l?"se":"sw"}function Tn(e){return e<0?e+360:e}function Bn(e,t,r,n,i,o){var a;if(r===o)a=Math.pow(n-e,2)+Math.pow(i-t,2);else if(r>o){var s=1<<r-o;a=Math.pow(n-e/s,2)+Math.pow(i-t/s,2)}else{var u=1<<o-r;a=Math.pow(n/u-e,2)+Math.pow(i/u-t,2)}return Math.sqrt(a)}function Dn(e,t){var r=e+t/Pn*(180/Math.PI);return r<-180?r+360:r>180?r-360:r}unction Rn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Nn={imageLoaded:{type:"load",dom:!0},imageLoadingError:{type:"error",dom:!0}};function Vn(e){var t=new RegExp(/(.*?)[\w,\s-]+\.(gif|jpe?g|tiff?|png|webp|bmp|svg)$/),r=new Set;return e.forEach((function(e){Y(e)?le(e,(,!0).forEach((function(e){var n=e.element.src;n&&t.test(n)&&r.add(n)})):t.test(e)&&r.add(e)})),jn(r)}function Un(e,t,r){var n=[];return e.forEach((function(e){var i=new Image;i.src=e,n.push(Hn(i,t,r))})),zr(n).then(()}function zn(e){var t=new Set;return Object.keys(e).forEach((function(r){var n=e[r];Object.keys(n).forEach((function(e){var r=n[e];Object.keys(r).forEach((function(e){var n=r[e];n&&"none"!==n&&t.add(n)}))}))})),jn(t)}function Kn(e){var t=new Set;return Object.keys(e).forEach((function(r){var n=e[r];Object.keys(n).forEach((function(e){var r=n[e];r&&"none"!==r&&t.add(r)}))})),jn(t)}function Hn(e,t,r){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return new Promise((function(i,o){t(e,Nn.imageLoaded,i),t(e,Nn.imageLoadingError,(function(t){n?(r.debug("failed to load image ".concat(e.src),null==t?void 0:t.stack),i()):o(new Error("failed to load image ".concat(e.src,". ").concat(t)))}))}))}function Zn(e,t,r){return Y(t)&&(!Y(e)||J(t)!==J(e))||!Y(t)&&(Y(e)||r&&t!==e)}function qn(e){return qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qn(e)}function Wn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==qn(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==qn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n.key,"string"),"symbol"===qn(i)?i:String(i)),n)}var i}var Gn=function(){ar t,r,n;return t=e,(r=[{key:"_buildClusterService",value:function(e,t,r,n){var i=t.type;if(i)switch(i){case"supercluster":return new Lr(e,t,r,n);case"none":return;default:throw new Error("Unknown cluster type ".concat(i))}}},{key:"createClusterers",value:function(e,t,r){var n=this,i={};return Object.keys(r).forEach((function(o){i[o]=[];var a=t[o],s=r[o];ar(Object.keys(a)).forEach((function(t){var r=a[t],u=n._buildClusterService(e,r,s,t);u&&i[o].push({qualifier:t,labelKey:a[t].labelKey,clusterer:u})}))})),i}}])&&Wn(t.prototype,r),n&&Wn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Qn=r(597),$n=r.n(Qn);function Xn(e){return Xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xn(e)}unction Jn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ei(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==Xn(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==Xn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n.key,"string"),"symbol"===Xn(i)?i:String(i)),n)}var i}var ti={boundsChanged:"boundsChanged",markersChanged:"markersChanged",selectionChanged:"selectionChanged",filterChanged:"filterChanged",hoverChanged:"hoverChanged",featureContentLoaded:"featureContentLoaded",idle:"idle",routeChanged:"routeChanged",tilesLoaded:"tilesLoaded",tilesContentLoaded:"tilesContentLoaded",mapTypeChanged:"mapTypeChanged"},ri=function(){ar t,r,n;return t=e,(r=[{key:"pushEvent",value:function(e,t){this.logger.debug("pushing event: ".concat(e));var r,n=Yn(this.registeredListeners);try{for(n.s();!(r=n.n()).done;){var i=r.value;i.eventType===e&&i.callback(t)}}catch(e){n.e(e)}finally{n.f()}}},{key:"_registerInternalListener",value:function(e,t,r){var n,i;if(t&&(r?(null!==(i=n=this._findInternalListener(e,void 0,r))&&void 0!==i&&i.id&&this._unregisterInternalListener(e,void 0,r),n=void 0):n=this._findInternalListener(e,t,void 0),!n)){var o={id:r,eventType:e,callback:t};return this.registeredListeners.push(o),o}}},{key:"_identifyListener",value:function(e,t,r,n){return!(e.eventType!==t||n&&e.id!==n||r&&e.callback!==r)}},{key:"_findInternalListener",value:function(e,t,r){var n=this;if(!r&&!t)throw new Error("Can't find a listener with no id and no callback provided");return this.registeredListeners.find(()}},{key:"_unregisterInternalListener",value:function(e,t,r){var n=this,i=this._findInternalListener(e,t,r);return i&&(this.registeredListeners=this.registeredListeners.filter((function(i){return!n._identifyListener(i,e,t,r)}))),i}},{key:"addBoundChangeListener",value:function(e,t){return!!this._registerInternalListener(ti.boundsChanged,e,t)}},{key:"removeBoundChangeListener",value:function(e){return!!this._unregisterInternalListener(ti.boundsChanged,e)}},{key:"deregisterBoundChangeListener",value:function(e){return!!this._unregisterInternalListener(ti.boundsChanged,void 0,e)}},{key:"addMarkerChangeListener",value:function(e,t){return!!this._registerInternalListener(ti.markersChanged,e,t)}},{key:"removeMarkerChangeListener",value:function(e){return!!this._unregisterInternalListener(ti.markersChanged,e)}},{key:"deregisterMarkerChangeListener",value:function(e){return!!this._unregisterInternalListener(ti.markersChanged,void 0,e)}},{key:"addSelectionChangeListener",value:function(e,t){return!!this._registerInternalListener(ti.selectionChanged,e,t)}},{key:"removeSelectionChangeListener",value:function(e,t){return!!this._unregisterInternalListener(ti.selectionChanged,e,t)}},{key:"deregisterSelectionChangeListener",value:function(e){return!!this._unregisterInternalListener(ti.selectionChanged,void 0,e)}},{key:"addFilterChangeListener",value:function(e,t){return!!this._registerInternalListener(ti.filterChanged,e,t)}},{key:"removeFilterChangeListener",value:function(e){return!!this._unregisterInternalListener(ti.filterChanged,e)}},{key:"deregisterFilterChangeListener",value:function(e){return!!this._unregisterInternalListener(ti.filterChanged,void 0,e)}},{key:"addHoverChangeListener",value:function(e,t){return!!this._registerInternalListener(ti.hoverChanged,e,t)}},{key:"removeHoverChangeListener",value:function(e){return!!this._unregisterInternalListener(ti.hoverChanged,e)}},{key:"deregisterHoverChangeListener",value:function(e){return!!this._unregisterInternalListener(ti.hoverChanged,void 0,e)}},{key:"addFeatureContentLoadedListener",value:function(e,t){return!!this._registerInternalListener(ti.featureContentLoaded,e,t)}},{key:"removeFeatureContentLoadedListener",value:function(e){return!!this._unregisterInternalListener(ti.featureContentLoaded,e)}},{key:"deregisterFeatureContentLoadedListener",value:function(e){return!!this._unregisterInternalListener(ti.featureContentLoaded,void 0,e)}},{key:"addIdleListener",value:function(e,t){return!!this._registerInternalListener(ti.idle,e,t)}},{key:"removeIdleListener",value:function(e){return!!this._unregisterInternalListener(ti.idle,e)}},{key:"deregisterIdleListener",value:function(e){return!!this._unregisterInternalListener(ti.idle,void 0,e)}},{key:"addRouteChangeListener",value:function(e,t){return!!this._registerInternalListener(ti.routeChanged,e,t)}},{key:"removeRouteChangeListener",value:function(e){return!!this._unregisterInternalListener(ti.routeChanged,e)}},{key:"deregisterRouteChangeListener",value:function(e){return!!this._unregisterInternalListener(ti.routeChanged,void 0,e)}},{key:"addTilesLoadedListener",value:function(e,t){return!!this._registerInternalListener(ti.tilesLoaded,e,t)}},{key:"removeTilesLoadedListener",value:function(e){return!!this._unregisterInternalListener(ti.tilesLoaded,e)}},{key:"deregisterTilesLoadedListener",value:function(e){return!!this._unregisterInternalListener(ti.tilesLoaded,void 0,e)}},{key:"addTilesContentLoadedListener",value:function(e,t){return!!this._registerInternalListener(ti.tilesContentLoaded,e,t)}},{key:"removeTilesContentLoadedListener",value:function(e){return!!this._unregisterInternalListener(ti.tilesContentLoaded,e)}},{key:"deregisterTilesContentLoadedListener",value:function(e){return!!this._unregisterInternalListener(ti.tilesContentLoaded,void 0,e)}},{key:"addMapTypeChangedListener",value:function(e,t){return!!this._registerInternalListener(ti.mapTypeChanged,e,t)}},{key:"deregisterMapTypeChangedListener",value:function(e){return!!this._unregisterInternalListener(ti.mapTypeChanged,void 0,e)}}])&&ei(t.prototype,r),n&&ei(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();unction(){function e(t,r,n){ui(this,e),this.id=Yt(),this.origin=t,this.destination=r,this.mode=n,this.distance=void 0}return ci(e,[{key:"toString",value:function(){var e;return"Route: {origin:'".concat(this.origin.id,"',destination:").concat(null===(e=this.destination)||void 0===e?void 0:e.id,",mode:").concat(this.mode,"}")}},{key:"originLatLng",value:,{key:"destinationLatLng",value:function(){return this.destination?{lat:this.destination.latLng[0],lng:this.destination.latLng[1]}:void 0}}]),e}(),di=function(){function e(t,r,n){var i=t.loggerFactory,o=t.egDistances,a=t.routeLineStyleByDistanceMode,s=t.routeCacheInMs,u=t.findFeature,l=t.eventsManager,c=t.addRouteOnMap,f=t.removeRouteOnMap,d=t.asKey;ui(this,e),this.routes=r,this.routeDestinations=n,this.logger=i("RoutesRepository"),this.egDistances=o,this.routeLineStyleByDistanceMode=a,this.findFeature=u,this.eventsManager=l,this.addRouteOnMap=c,this.removeRouteOnMap=f,this.asKey=d,this.routeCache=kn(s,void 0,(function(e,t,r){return"polyline"!==r[0]&&e}))}return ci(e,[{key:"_asRoute",value:function(e,t){var r,n,i={origin:(null===(r=this.findFeature(e.origin.id,e.origin.type))||void 0===r?void 0:r.toData())||{id:e.origin.id,type:e.origin.type},destination:e.destination?(null===(n=this.findFeature(e.destination.id,e.destination.type))||void 0===n?void 0:n.toData())||{id:e.destination.id,type:e.destination.type}:void 0,transportMode:e.mode};return t&&(i.distance=e.distance),i}},{key:"_asRouteDestinationFeature",value:function(e){var t=e.idAndType,r=t.id,n=t.type;return{destination:r&&n?this.findFeature(r,n):void 0,transportMode:e.transportMode}}},{key:"_asRouteDestination",value:,{key:"_routeDestinationAsKey",value:function(e){var t=e.idAndType,r=t.id,n=t.type,i=e.transportMode;return"".concat(r,"|").concat(n,"|").concat(i)}},{key:"_buildCacheKeys",value:function(e,t,r,n){var i=[];return i.push(e),t&&i.push("".concat(t.id,"|").concat(t.type)),r&&i.push("".concat(r.id,"|").concat(r.type)),n&&i.push(n),i}},{key:"_sameRoute",value:function(e,t){var r,n,i,o;return e.origin.id===t.origin.id&&e.origin.type===t.origin.type&&(null===(r=e.destination)||void 0===r?void 0:r.id)===(null===(n=t.destination)||void 0===n?void 0:n.id)&&(null===(i=e.destination)||void 0===i?void 0:i.type)===(null===(o=t.destination)||void 0===o?void 0:o.type)&&e.mode===t.mode}},{key:"_sameFeature",value:,{key:"_sameRouteDestination",value:function(e,t){return e.idAndType.id===t.idAndType.id&&e.idAndType.type===t.idAndType.type&&e.transportMode===t.transportMode}},{key:"showRoutes",value:function(e,t){var r=this,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this._asRouteDestinationFeature.bind(this);return zr((t&&t.length>0?t.map(i):[].concat(ii(this.listRegisteredRoutes(e).map(()),ii(this.routeDestinations))).map(().filter((function(e){return!r.routes.some((function(t){return r._sameRoute(t,e)}))&&!r._sameFeature(e.origin,e.destination)})).map((function(t){return new Promise((function(n,i){var o,a,s=t.destination,u=t.mode,l="none"===r.routeLineStyleByDistanceMode[t.mode].lineStyle,c=l?void 0:(o=r.routeCache).get.apply(o,ii(r._buildCacheKeys("polyline",e,s,u)));if(c)a=Promise.resolve(c);else{var f,d=r._buildCacheKeys(l?"distance":"route",e,s,u),h=(f=r.routeCache).get.apply(f,ii(d));if(h)a=Promise.resolve(h);else{if(!r.egDistances)return Promise.reject("EGDistances is not enabled: routes or distances can't be computed on demand");a=l?r.fetchDistance(t,d):r.fetchRoute(t,d)}}a.then((function(e){var t=e.route,i=e.egDistanceRoute,o=e.routeResult;t&&(r.routes.push(t),i?r.addRouteOnMap(t,i).then((function(e){return n(t)})):o?r.addRouteOnMap(t,o).then((function(e){return n(t)})):n(t))})).catch(()}))}))).then((function(e){var t=e.filter((function(e){return"fulfilled"===e.status})).map((function(e){return e.value})).filter((function(e){return void 0!==e}));e.filter((function(e){return"rejected"===e.status})).forEach(r._handleReject.bind(r));var i=t.map((function(e){return r._asRoute(e,!0)}));return n&&i.length>0&&r._handleRouteChanged(!0,i),i}))}},{key:"fetchDistance",value:function(e,t){var r=this;return this.egDistances.getDistances(e.originLatLng(),e.destinationLatLng(),e.mode).then((function(n){if("SUCCESS"===n.status){var i;e.distance=n.matrix[0][0].modes[e.mode];var o={route:e};return(i=r.routeCache).set.apply(i,[o].concat(ii(t))),o}throw new Error(n.errors.join(", "))}))}},{key:"handleFlight",value:function(e){var t=e.originLatLng(),r=e.destinationLatLng(),n=e;return n.copyrights="",n.warnings="",n.status="SUCCESS",n.route={path:[t,r],mode:n.mode},Promise.resolve(n)}},{key:"fetchRoute",value:function(e,t){var r=this;return("flying"==e.mode?this.handleFlight(e):this.egDistances.getRoute(e.originLatLng(),e.destinationLatLng(),e.mode)).then((function(n){if("SUCCESS"===n.status){var i;e.distance=n.route.distance;var o={route:e,egDistanceRoute:n};return(i=r.routeCache).set.apply(i,[o].concat(ii(t))),o}throw new Error(n.error)}))}},{key:"registerRoute",value:function(e,t,r){var n=t.idAndType,i=t.transportMode,o=this._buildCacheKeys("polyline",e,n,i);if(!this._sameFeature(e,n)){var a=this.findFeature(e.id,e.type),s=this.findFeature(n.id,n.type);if(a&&s){var u,l=new fi(a,s,i),c={route:{path:$n().decode(r).map(()}};return(u=this.routeCache).set.apply(u,[{route:l,routeResult:c}].concat(ii(o))),!0}}return!1}},{key:"updateRoutesOnViewport",value:function(){var e=this,t=ii(this.routes);return this.hideRoutes().then((function(){return Promise.all(t.map((function(t){return e.showRoutes(t.origin,[e._asRouteDestination(t)],!1)})))})).then((function(){}))}},{key:"listRegisteredRoutes",value:function(e){var t,r=this,n=this._buildCacheKeys("polyline",e);return(t=this.routeCache).keys.apply(t,ii(n)).flatMap((function(e){var t,n=(t=r.routeCache).get.apply(t,ii(e));if(n){var i=n.route,o=n.routeResult;return[{origin:{id:i.origin.id,type:i.origin.type},destination:{idAndType:{id:i.destination.id,type:i.destination.type},transportMode:i.mode},polyline:$n().encode(o.route.path)}]}return[]}))}},{key:"deregisterRoute",value:function(e,t){var r=this,n=this.listRegisteredRoutes(e).filter((function(e){var n=e.destination;return!t||r._sameRouteDestination(n,t)})).map((function(e){var t,n=e.origin,i=e.destination,o=r._buildCacheKeys("polyline",n,i.idAndType,i.transportMode);return(t=r.routeCache).set.apply(t,[void 0].concat(ii(o))),e}));if(n){var i=this.findFeature(e.id,e.type);this.hideRoutes(i,n.map((function(e){return e.destination})))}return n}},{key:"_handleReject",value:function(e){var t=e.reason,r=t.message,n=t.stack,i=t.error,o=t.route;i?/OVER_QUERY_LIMIT/.test(null==i?void 0:i.message)?this.logger.info("Error when showing route ".concat(o,": ").concat(i.message),i.stack):this.logger.warn("Error when showing route ".concat(o,": ").concat(i.message),i.stack):r&&this.logger.error("Error when showing route ".concat(r),n)}},{key:"hideRoutes",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this._asRoute.bind(this),o=this.asKey,a=r.length>0?r.map((function(e){return"".concat(t.asKey(e.idAndType),"-").concat(e.transportMode)})):void 0;return Promise.all(this.routes.filter((function(t){return(!e||t.origin.id===e.id&&t.origin.type===e.type)&&(!a||a.includes("".concat(o(t.destination),"-").concat(t.mode)))})).map((function(e){return t.removeRouteOnMap(e).then((function(){return t.routes.splice(t.routes.findIndex((function(t){return e===t})),1),e}))}))).then((function(e){return n&&e.length>0&&t._handleRouteChanged(!1,e),e.map((function(e){return i(e)}))}))}},{key:"listRoutesDisplayed",value:function(){var e=this;return this.routes.map((function(t){return e._asRoute(t,!0)}))}},{key:"_handleRouteChanged",value:function(e,t){var r={routes:t,action:e?"show":"hide"};this.eventsManager.pushEvent(ti.routeChanged,r)}},{key:"registerRouteDestination",value:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];r.forEach((function(t){var r;if(null===(r=e.listRegisteredRouteDestinations())||void 0===r||!r.map(e._routeDestinationAsKey).includes(e._routeDestinationAsKey(t))){var n=t.idAndType,i=n.id,o=n.type,a=t.transportMode,s=e.findFeature(i,o);s&&e.routeDestinations.push({destination:s,transportMode:a})}}))}},{key:"listRegisteredRouteDestinations",value:function(){return this.routeDestinations.flatMap((function(e){var t=e.destination,r=e.transportMode;return t?[{idAndType:{id:t.id,type:t.type},transportMode:r}]:[]}))}},{key:"deregisterRouteDestination",value:function(){for(var e=this,t=[],r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return n.forEach((function(r){var n=r.idAndType,i=n.id,o=n.type,a=r.transportMode,s=e.routeDestinations.findIndex((function(e){return e.destination&&e.destination.id===i&&e.destination.type===o&&e.transportMode===a}));s>=0&&(e.routeDestinations.splice(s,1),t.push(r))})),this.hideRoutes(void 0,t),t}}]),e}();function hi(e,t){return!!t&&e.from===t.from&&e.to===t.to&&Zt(e.roomOccupancies,t.roomOccupancies,!1,(function(e,t){return function(e,t){return(e.nbAdults||0)===(t.nbAdults||0)&&Zt(e.childrenAges||[],t.childrenAges||[])}(e,t)}))}function pi(e){return pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pi(e)}function vi(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(i=void 0,i=function(e,t){if("object"!==pi(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==pi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n.key,"string"),"symbol"===pi(i)?i:String(i)),n)}var i}var yi,gi=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.availabilityProvider=r,this.logger=t("AvailabilityCheck"),this.availabilityProvider=void 0,this.featureComputationInProgress=new Map,this.stay=void 0}var t,r,n;return t=e,r=[{key:"saveStay",value:function(e){return!(!e||this.stay&&hi(e,this.stay)||(this.stay=e,this.featureComputationInProgress.clear(),0))}},{key:"isAvailabilityCheckActive",value:,{key:"updateAvailability",value:function(e){var t=this;if(!this.isAvailabilityCheckActive())return Promise.resolve([]);for(var r=this.stay,n=[],i=Date.now(),o=e.length,a=new Map,s=0;s<o;s++){var u=e[s],l=u.id;!this.featureComputationInProgress.has(l)&&u.hasTileData()&&"unknown"===u.toTileData().status&&(n.push(l),a.set(l,s),this.featureComputationInProgress.set(l,i))}if(0===n.length)return Promise.resolve([]);for(var c=[],f=jt(n,300),d=f.length,h=0;h<d;h++)c.push(this.availabilityProvider.checkAvailability(r,f[h]));return zr(c).then((function(n){return n.filter((function(e){return"rejected"===e.status})).forEach((),n.filter(().map((function(n){return n.value.map((function(n){var i=a.get(n.id);if(i>=0&&t.stay===r){var o=e[i];return o.mergeTileData(n),o}})).filter((function(e){return void 0!==e}))})).flat()})).finally(()}}],r&&vi(t.prototype,r),n&&vi(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),mi={variant:"var",defaultClusterProductLabel:"prodClusterLbl",defaultClusterPropertyLabel:"propClusterLbl",defaultClusterPlaceLabel:"placeClusterLbl",keyboardFeaturesNoData:"keybFeatNoData",keyboardFeaturesPreviousPage:"keybFeatPrev",keyboardFeaturesNextPage:"keybFeatNext",filterBoxLegend:"fboxLegend",ariaFilterBoxToggleLegend:"ariaFboxTglLegend",ariaFilterBoxImgProductAvailable:"ariaFboxImgProdAvailable",ariaFilterBoxImgProductFiltered:"ariaFboxImgProdFiltered",ariaFilterBoxImgProductSoldOut:"ariaFboxImgProdSoldOut",ariaFilterBoxImgProductUnknown:"ariaFboxImgProdUnknown",ariaFilterBoxImgPropertyAvailable:"ariaFboxImgPropAvailable",ariaFilterBoxImgPropertyFiltered:"ariaFboxImgPropFiltered",ariaFilterBoxImgPropertySoldOut:"ariaFboxImgPropSoldOut",ariaFilterBoxImgPropertyUnknown:"ariaFboxImgPropUnknown",ariaFilterBoxCheckBoxProductAvailable:"ariaFboxCbProdAvailable",ariaFilterBoxCheckBoxProductFiltered:"ariaFboxCbProdFiltered",ariaFilterBoxCheckBoxProductSoldOut:"ariaFboxCbProdSoldOut",ariaFilterBoxCheckBoxProductUnknown:"ariaFboxCbProdUnknown",ariaFilterBoxCheckBoxPropertyAvailable:"ariaFboxCbPropAvailable",ariaFilterBoxCheckBoxPropertyFiltered:"ariaFboxCbPropFiltered",ariaFilterBoxCheckBoxPropertySoldOut:"ariaFboxCbPropSoldOut",ariaFilterBoxCheckBoxPropertyUnknown:"ariaFboxCbPropUnknown",filterBoxProductAvailable:"fboxProductAvailable",filterBoxProductFiltered:"fboxProductFiltered",filterBoxProductSoldOut:"fboxProductSoldOut",filterBoxProductUnknown:"fboxProductUnknown",filterBoxPropertyAvailable:"fboxPropertyAvailable",filterBoxPropertyFiltered:"fboxPropertyFiltered",filterBoxPropertySoldOut:"fboxPropertySoldOut",filterBoxPropertyUnknown:"fboxPropertyUnknown",filterBoxPlaceUnknown:"fboxPlaceUnknown",ariaFilterBoxImgPlaceUnknown:"ariaFboxImgPlaceUnknown",ariaFilterBoxCheckBoxPlaceUnknown:"ariaFboxCbPlaceUnknown"};function bi(e){return bi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bi(e)}function ki(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==bi(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==bi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===bi(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var wi=(ki(yi={},mi.variant,"default"),ki(yi,mi.defaultClusterProductLabel,"{0} products"),ki(yi,mi.defaultClusterPropertyLabel,"{0} properties"),ki(yi,mi.defaultClusterPlaceLabel,"{0} places"),ki(yi,mi.keyboardFeaturesNoData,"no data"),ki(yi,mi.keyboardFeaturesPreviousPage,"Show previous..."),ki(yi,mi.keyboardFeaturesNextPage,"Show next..."),ki(yi,mi.filterBoxLegend,"Legend"),ki(yi,mi.ariaFilterBoxToggleLegend,"Toggle legend"),ki(yi,mi.ariaFilterBoxImgProductAvailable,"icon used for products matching dates and criteria"),ki(yi,mi.ariaFilterBoxImgProductFiltered,"icon used for products matching dates but not your criteria"),ki(yi,mi.ariaFilterBoxImgProductSoldOut,"icon used for products not available for these dates"),ki(yi,mi.ariaFilterBoxImgProductUnknown,"icon used for products with no availability information for these dates"),ki(yi,mi.ariaFilterBoxImgPropertyAvailable,"icon used for properties matching dates and criteria"),ki(yi,mi.ariaFilterBoxImgPropertyFiltered,"icon used for properties matching dates but not your criteria"),ki(yi,mi.ariaFilterBoxImgPropertySoldOut,"icon used for properties not available for these dates"),ki(yi,mi.ariaFilterBoxImgPropertyUnknown,"icon used for properties with no availability information for these dates"),ki(yi,mi.ariaFilterBoxCheckBoxProductAvailable,"filter products matching dates and criteria"),ki(yi,mi.ariaFilterBoxCheckBoxProductFiltered,"filter products matching dates but not your criteria"),ki(yi,mi.ariaFilterBoxCheckBoxProductSoldOut,"filter products sold out for these dates"),ki(yi,mi.ariaFilterBoxCheckBoxProductUnknown,"filter products with no availability information for these dates"),ki(yi,mi.ariaFilterBoxCheckBoxPropertyAvailable,"filter properties matching dates and criteria"),ki(yi,mi.ariaFilterBoxCheckBoxPropertyFiltered,"filter properties matching dates but not your criteria"),ki(yi,mi.ariaFilterBoxCheckBoxPropertySoldOut,"filter properties sold out for these dates"),ki(yi,mi.ariaFilterBoxCheckBoxPropertyUnknown,"filter properties with no availability information for these dates"),ki(yi,mi.filterBoxProductAvailable,"Matches dates and criteria"),ki(yi,mi.filterBoxProductFiltered,"Doesnt match your criteria"),ki(yi,mi.filterBoxProductSoldOut,"Sold out for these dates"),ki(yi,mi.filterBoxProductUnknown,"Availability unknown"),ki(yi,mi.filterBoxPropertyAvailable,"Matches dates and criteria"),ki(yi,mi.filterBoxPropertyFiltered,"Doesnt match your criteria"),ki(yi,mi.filterBoxPropertySoldOut,"Sold out for these dates"),ki(yi,mi.filterBoxPropertyUnknown,"Availability unknown"),ki(yi,mi.filterBoxPlaceUnknown,"Places"),ki(yi,mi.ariaFilterBoxImgPlaceUnknown,"icon used for places"),ki(yi,mi.ariaFilterBoxCheckBoxPlaceUnknown,"filter places"),yi);function Ci(e){return Ci="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ci(e)}var Pi,Li,xi,Mi=(Pi={},xi="en-US",(Li=function(e){var t=function(e,t){if("object"!==Ci(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==Ci(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Ci(t)?t:String(t)}(Li=mi.variant))in Pi?Object.defineProperty(Pi,Li,{value:xi,enumerable:!0,configurable:!0,writable:!0}):Pi[Li]=xi,Pi);function Fi(e){return Fi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fi(e)}var _i,e}({},mi.variant,"en");function Si(e){return Si="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Si(e)}function Ei(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==Si(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==Si(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Si(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Ii={default:wi,"en-US":Mi,en:Oi,fr:(Ei(_i={},mi.variant,"fr"),Ei(_i,mi.defaultClusterProductLabel,"{0} tablissements"),Ei(_i,mi.defaultClusterPropertyLabel,"{0} tablissements"),Ei(_i,mi.defaultClusterPlaceLabel,"{0} points d'intrt"),Ei(_i,mi.keyboardFeaturesNoData,"Pas de donnes"),Ei(_i,mi.keyboardFeaturesPreviousPage,"Afficher les prcdents..."),Ei(_i,mi.keyboardFeaturesNextPage,"Afficher les suivants..."),Ei(_i,mi.filterBoxLegend,"Lgende"),Ei(_i,mi.ariaFilterBoxToggleLegend,"Afficher la lgende"),Ei(_i,mi.ariaFilterBoxImgProductAvailable,"icne pour les tablissements disponibles et vrifiant les critres"),Ei(_i,mi.ariaFilterBoxImgProductFiltered,"icne pour les tablissements disponibles mais ne vrifiant pas les critres"),Ei(_i,mi.ariaFilterBoxImgProductSoldOut,"icne pour les tablissements non disponibles pour les dates"),Ei(_i,mi.ariaFilterBoxImgProductUnknown,"icne pour les tablissements sans information de disponibilit"),Ei(_i,mi.ariaFilterBoxImgPropertyAvailable,"icne pour les tablissements disponibles et vrifiant les critres"),Ei(_i,mi.ariaFilterBoxImgPropertyFiltered,"icne pour les tablissements disponibles mais ne vrifiant pas les critres"),Ei(_i,mi.ariaFilterBoxImgPropertySoldOut,"icne pour les tablissements non disponibles pour les dates"),Ei(_i,mi.ariaFilterBoxImgPropertyUnknown,"icne pour les tablissements sans information de disponibilit"),Ei(_i,mi.ariaFilterBoxCheckBoxProductAvailable,"filtre pour les tablissements disponibles et vrifiant les critres"),Ei(_i,mi.ariaFilterBoxCheckBoxProductFiltered,"filtre pour les tablissements disponibles mais ne vrifiant pas les critres"),Ei(_i,mi.ariaFilterBoxCheckBoxProductSoldOut,"filtre pour les tablissements non disponibles pour les dates"),Ei(_i,mi.ariaFilterBoxCheckBoxProductUnknown,"filtre pour les tablissements sans information de disponibilit"),Ei(_i,mi.ariaFilterBoxCheckBoxPropertyAvailable,"filtre pour les tablissements disponibles et vrifiant les critres"),Ei(_i,mi.ariaFilterBoxCheckBoxPropertyFiltered,"filtre pour les tablissements disponibles mais ne vrifiant pas les critres"),Ei(_i,mi.ariaFilterBoxCheckBoxPropertySoldOut,"filtre pour les tablissements non disponibles pour les dates"),Ei(_i,mi.ariaFilterBoxCheckBoxPropertyUnknown,"filtre pour les tablissements sans information de disponibilit"),Ei(_i,mi.filterBoxProductAvailable,"Disponibles"),Ei(_i,mi.filterBoxProductFiltered,"Disponibles mais filtrs"),Ei(_i,mi.filterBoxProductSoldOut,"Indisponible"),Ei(_i,mi.filterBoxProductUnknown,"Disponibilit inconnue"),Ei(_i,mi.filterBoxPropertyAvailable,"Disponibles"),Ei(_i,mi.filterBoxPropertyFiltered,"Disponibles mais filtrs"),Ei(_i,mi.filterBoxPropertySoldOut,"Indisponible"),Ei(_i,mi.filterBoxPropertyUnknown,"Disponibilit inconnue"),Ei(_i,mi.filterBoxPlaceUnknown,"Points d'intrt"),Ei(_i,mi.ariaFilterBoxImgPlaceUnknown,"icne pour les point d'intrts"),Ei(_i,mi.ariaFilterBoxCheckBoxPlaceUnknown,"filtre pour les point d'intrts"),_i)};function Ai(e){return Ai="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ai(e)}function Ti(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Bi(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Bi(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Bi(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Di(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ji(n.key),n)}}function ji(e){var t=function(e,t){if("object"!==Ai(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==Ai(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Ai(t)?t:String(t)}var Ri=["1","2","3","4","5","6","7","8","9"],Ni={cluster:{available:9,filtered:7,sold_out:3,unknown:1},product:{available:10,filtered:8,sold_out:4,unknown:2},property:{available:10,filtered:8,sold_out:4,unknown:2},place:{unknown:5}},Vi="no-data",Ui="keyboard-features-enabled",zi="keyboard-features-list",Ki="keyboard-features-list-element",Hi="keyboard-features-list-element-info",Zi="keyboard-features-list-element-number",qi="keyboard-features-list-element-div",Wi="keyboard-features-list-nav",Gi="keyboard-features-not-in-list-marker",Qi="kbc-button",$i=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keyboardFeaturesIcon=t,this.getI18N=r,this.keyboardNavigationMode=!1,this.keyPressZero=48,this.keyDownBackspace=8,this.pageIndex=0,this.pageCount=0,this.uiElementIds=[]}var t,r,n;return t=e,r=[{key:"init",value:function(e){var t=e.node,r=e.uniqId,n=e.containerBounds,i=e.listFeatures,o=e.cloneMarker,a=e.zIndexes,s=e.maxZIndex,u=e.getMapNavFocusElement,l=e.registerListenerOnMapFocusElement,c=e.handleMarkerClick,f=e.isFeatureSelected,d=e.clearSelectedFeature;this.node=t,this.containerBounds=n,this.listFeatures=i,this.cloneMarker=o,this.zIndexes=a,this.maxZIndex=s,this.getMapNavFocusElement=u,this.registerListenerOnMapFocusElement=l,this.handleMarkerClick=c,this.isFeatureSelected=f,this.clearSelectedFeature=d;var h=r("keyboard-features");this._createKeyboardFeaturesIcon(h),this._createKeyboardFeaturesSquare(h),this._createKeyboardFeaturesList(h),this._initializeListeners()}},{key:"removeAl e=this;this.uiElementIds.forEach((function(t){return he(e.node,t)}))}},{key:"_createKeyboardFeaturesIcon",value:function(e){var t="".concat(e,"-icon");this.keyboardIcon=ge(t,this.node,"keyboard-features-icon",void 0),this.uiElementIds.push(t),this.keyboardNavigationMode||Ve(this.keyboardIcon);var r=this.keyboardFeaturesIcon;Be(Me("".concat(e,"-img"),this.keyboardIcon,"keyboard-features-icon-img",void 0,r,"icon to show that keyboard features is enabled")),He(this.keyboardIcon,this.maxZIndex+1)}},{key:"_createKeyboardFeaturesSquare",value:function(e){var t="".concat(e,"-focus");this.focusArea=ge(t,this.node,"".concat("keyboard-features-focus-area"),void 0),this.uiElementIds.push(t),this.keyboardNavigationMode||Ve(this.focusArea),He(this.focusArea,this.maxZIndex+1)}},{key:"_createKeyboardFeaturesList",value:function(e){var t="".concat(e,"-features");this.keybNavFeatures=ge(t,this.node,"keyboard-features-dialog",void 0),this.uiElementIds.push(t),this.keybNavFeaturesList=me("".concat(e,"-list"),this.keybNavFeatures,"".concat(zi," ").concat(Vi),void 0),this.keybNavFeaturesElements=[];for(var r=0;r<7;r++){var n=be("".concat(e,"-elt-").concat(r+1),this.keybNavFeaturesList,"".concat(Ki," ").concat(Vi),void 0);Ce("".concat(n.id,"-info"),n,Hi,void 0,"-"),this.keybNavFeaturesElements.push(n)}var i=this.getI18N(mi.keyboardFeaturesNoData);this.keybNavNoFeatures=Ce("".concat(e,"-nodata"),this.keybNavFeatures,"".concat(zi,"-no-feature-message"),void 0,i),this.keyboardNavigationMode||Ve(this.keybNavFeatures),He(this.keybNavFeatures,this.maxZIndex+1);var o="".concat(Ki," ").concat(Wi," ").concat(Wi,"-previous ").concat(Vi),a=be("".concat(e,"-elt-prev"),this.keybNavFeaturesList,o,void 0),s=this.getI18N(mi.keyboardFeaturesPreviousPage),u=ge("".concat(a.id,"-container"),a,qi,void 0);Ce("".concat(a.id,"-number"),u,"".concat(Zi," ").concat(Qi),void 0,Ri[7]),Ce("".concat(a.id,"-info"),u,Hi,void 0,s),this.keybNavFeaturesElements.push(a);var l="".concat(Ki," ").concat(Wi," ").concat(Wi,"-next ").concat(Vi),c=be("".concat(e,"-elt-next"),this.keybNavFeaturesList,l,void 0),f=this.getI18N(mi.keyboardFeaturesNextPage),d=ge("".concat(c.id,"-container"),c,qi,void 0);Ce("".concat(c.id,"-number"),d,"".concat(Zi," ").concat(Qi),void 0,Ri[8]),Ce("".concat(c.id,"-info"),d,Hi,void 0,f),this.keybNavFeaturesElements.push(c)}},{key:"_clickFeatureAtIndex",value:function(e){var t=this.features[7*this.pageIndex+e];if(t)return this.isFeatureSelected(t)?this.clearSelectedFeature():(this.handleMarkerClick(t,t.markerType,"dialog-keyboard-pressed"),"cluster"!==t.type&&Ua(t.marker)),!0}},{key:"_paginateFeaturePage",value:function(e){return e&&this.pageIndex<this.pageCount-1?(this.pageIndex+=1,!0):!e&&this.pageItedFeature",value:function(){return this.clearSelectedFeature(),!0}},{key:"_initializeListeners",value:function(){var e=this;this.registerListenerOnMapFocusElement({type:"keypress",dom:!0},(function(t){var r=(t.which||t.keyCode||t.key)-e.keyPressZero,n=!1;r>=0&&r<=9&&(t.preventDefault(),0===r?e._clearSelectedFeature():r<=7?e._clickFeatureAtIndex(r-1):n=8===r?e._paginateFeaturePage(!1):e._paginateFeaturePage(!0),n&&e._updateKeyboardFeaturesDialog())})),this.registerListenerOnMapFocusElement({type:"keydown",dom:!0},(function(t){Number(t.which||t.keyCode||t.key)===e.keyDownBackspace&&(t.preventDefault(),e.clearSelectedFeature(),e._updateKeyboardFeaturesDialog())}))}},{key:"refreshKeyboardNavIconVisibility",value:function(e){(void 0!==e?e:this.keyboardNavigationMode)?Ue(this.keyboardIcon):Ve(this.keyboardIcon)}},{key:"_resetFeatures",value:function(e){var t=this._resetMarker.bind(this);e&&e.forEach(t)}},{key:"_resetMarker",value:function(e){e&&e.marker&&Qe(e.marker.cssElement,Gi)&&(ot(e.marker.cssElement,Gi),Va(e.marker,_t(this.zIndexes[e.type],e.hashKeys)))}},{key:"_updateFeatureMarkersAsNotInList",value:function(e){e&&e.forEach((function(e),{key:"_clear",value:function(){this._resetFeatures(this.features)}},{key:"turnKeyboardFeaturesMode",value:function(e){if(!this.node)throw new Error("You need to have the map initialized to turn on the keyboard navigation");this.keyboardNavigationMode=e,e?nt(this.node,Ui):ot(this.node,Ui),this.keyboardNavigationMode&&document.activeElement===this.getMapNavFocusElement()?Ue(this.keyboardIcon):Ve(this.keyboardIcon),this.keyboardNavigationMode?(Ue(this.focusArea),Ue(this.keybNavFeatures)):(Ve(this.focusArea),Ve(this.keybNavFeatures)),this.keyboardNavigationMode||this._clear()}},{key:"isKeyboardFeaturesModeEnabled",value:function(){return this.keyboardNavigationMode}},{key:"_computeScore",value:function(e){return Ni[e.type][e.status||("cluster"===e.type?"available":"unknown")]+(e.score||0)*(e.score<1?1:Math.pow(10,-(""+e.score).split(".")[0].length))+Math.pow(10,-5)*(e.children||[]).length}},{key:"_prioritizeFeaturesForKeyboardNav",value:function(e,t){var r=this._computeScore(e),n=this._computeScore(t);return r===n?(""+e.name).localeCompare(t.name):n-r}},{key:"updateKeyboardFeatures",value:function(){if(this.keyboardNavigationMode){var e=this.containerBounds(this.focusArea);e&&(this._resetFeatures(this.features),this.features=this.listFeatures((function(e){return e.visible}),e).sort(this._prioritizeFeaturesForKeyboardNav.bind(this)),this.pageCount=0===this.features.length?0:Math.floor((this.features.length-1)/7+1),this.pageIndex>=this.pageCount&&(this.pageIndex=0),this._updateKeyboardFeaturesDialog())}}},{key:"_updateKeyboardFeaturesDialog",value:function(){0===this.pageCount?nt(this.keybNavFeaturesList,Vi):ot(this.keybNavFeaturesList,Vi);for(var e=[],t=0;t<7;t++){var r,n=null===(r=this.keybNavFeaturesElements)||void 0===r?void 0:r[t];if(n){fe(n);var i=this.features[7*this.pageIndex+t];if(i){ot(n,Vi);var o=ge("".concat(n.id,"-container"),n,qi,void 0);if(Ce("".concat(n.id,"-number"),o,"".concat(Zi," ").concat(Qi),void 0,Ri[t]),i.marker){this._resetMarker(i);var a,s=this.cloneMarker(i.marker);if(s&&(s.style=null==s||null===(a=s.dataset)||void 0===a?void 0:a.cloneStyles,se(s,void 0,!0).map((function(e){return e.element})).forEach((function(e){return ut(e)}))),nt(s,"keyboard-features-list-element-icon"),"cluster"===i.type){var u=Ti(se(s,["cluster-label-content"],!0).map((function(e){return e.element})),1)[0];nt(u,"no-text-overflow"),u.innerHTML=u.innerHTML.replace(/\s/g," ")}o.appendChild(s)}e.push(i),"cluster"!==i.type&&Ce("".concat(n.id,"-info-").concat(i.id),o,Hi,void 0,i.name||"".concat(i.type," ").concat(i.id))}else nt(n,Vi)s.features||[]).filter((function(t){return!e.includes(t)&&t.marker})));var l=Ti(this.keybNavFeaturesElements||[],9),c=l[7],f=l[8];this._updateNavButton(c,this.pageCount<=1,0===this.pageIndex),this._updateNavButton(f,this.pageCount<=1,this.pageIndex===this.pageCount-1)}},{key:"_updateNavButton",value:function(e,t,r){var n="disabled";t?(nt(e,Vi),ot(e,n)):(ot(e,Vi),r?nt(e,n):ot(e,n))}}],r&&Di(t.prototype,r),n&&Di(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Xi(e){return Xi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xi(e)}function Yi(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ji(n.key),n)}}function Ji(e){var t=function(e,t){if("object"!==Xi(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==Xi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Xi(t)?t:String(t)}var eo="ArrowUp",to="ArrowDown",ro="ArrowRight",no="ArrowLeft",io="+",oo="-",ao=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.panBy=t,this.zoomIn=r,this.zoomOut=n,this.events=i,this.deltaX=5,this.deltaY=5,this.keyDownListenerCallback=this._keyDownListenerCallback.bind(this),this.keyUpListenerCallback=this._keyUpListenerCallback.bind(this),this.keyPressListenerCallback=this._keyPressListenerCallback.bind(this)}var t,r,n;return t=e,r=[{key:"_panUntil",value:function(e,t,r){var n=this;this.panBy(e),setTimeout((function(){if(t()){var e=r();n._panUntil(e,t,r)}}),40)}},{key:"_keyDownListenerCallback",value:function(e){var t=this,r=e.key;if([eo,to,no,ro].includes(r))switch(e.preventDefault(),r){case eo:this.keyUpPressed||(this.keyUpPressed=!0,this._panUntil([0,-this.deltaY],(function(){return t.keyUpPressed}),(function(){return t.deltaY<100&&(t.deltaY+=7),[0,-t.deltaY]})));break;case to:this.keyDownPressed||(this.keyDownPressed=!0,this._panUntil([0,this.deltaY],(function(){return t.keyDownPressed}),(function(){return t.deltaY<100&&(t.deltaY+=7),[0,t.deltaY]})));break;case no:this.keyLeftPressed||(this.keyLeftPressed=!0,this._panUntil([-this.deltaX,0],(function(){return t.keyLeftPressed}),(function(){return t.deltaX<100&&(t.deltaX+=7),[-t.deltaX,0]})));break;case ro:this.keyRighis._panUntil([this.deltaX,0],(function(){return t.keyRightPressed}),(function(){return t.deltaX<100&&(t.deltaX+=7),[t.deltaX,0]})))}}},{key:"_keyUpListenerCallback",value:function(e){var t=e.key;if([eo,to,no,ro].includes(t)){switch(e.preventDefault(),t){case eo:this.keyUpPressed=!1,this.deltaY=5;break;case to:this.keyDownPressed=!1,this.deltaY=5;break;case no:this.keyLeftPressed=!1,this.deltaX=5;break;case ro:this.keyRightPressed=!1,this.deltaX=5}this.events.splice(0,0,"moveKeyboard")}}},{key:"_keyPressListenerCallback",value:function(e){var t=e.key;if([io,oo].includes(t))switch(e.preventDefault(),t){case io:this.events.splice(0,0,"zoomInKeyboard"),this.zoomIn();break;case oo:this.events.splice(0,0,"zoomOutKeyboard"),this.zoomOut()}}}],r&&Yi(t.prototype,r),n&&Yi(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function so(e){return so="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},so(e)}function uo(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lo(n.key),n)}}function lo(e){var t=function(e,t){if("object"!==so(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==so(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===so(t)?t:String(t)}var co=function(){function e(t,r,n,i){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.featureTypeProviders={},r.forEach((function(e){var r={};n[e].forEach((function(e){var n=i[e],o=i[n.type];if(!o)throw new Error("Content provider ".concat(n.type," not supported"));if(!o.checkPackageIsLoaded())throw new Error("You need to load the package supporting the content provider service ".concat(n.type));r[e]=o.newInstance(t,n)})),o.featureTypeProviders[e]=r}))}var t,r,n;return t=e,(r=[{key:"getFeatureProviders",value:function(){return this.featureTypeProviders}}])&&uo(t.prototype,r),n&&uo(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function fo(e){return function(e){if(Array.isArray(e))return ho(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return ho(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ho(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ho(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function po(e){return po="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},po(e)}function vo(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yo(n.key),n)}}function yo(e){var t=function(e,t){if("object"!==po(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==po(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===po(t)?t:String(t)}var go=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),[t,r,n,i].some((function(e){return"object"===po(e)&&e.lng&&e.lat}))?(this.x1=n.lng,this.x2=r.lng,this.y1=t.lat,this.y2=r.lat):(this.x1=t,this.x2=n,this.y1=r,this.y2=i),this.coordinates=[{lng:this.x2,lat:this.y1},{lng:this.x2,lat:this.y2},{lng:this.x1,lat:this.y2},{lng:this.x1,lat:this.y1},{lng:this.x2,lat:this.y1}]}var t,r,n;return t=e,(r=[{key:"getCoordinates",valuinPoints",value:function(){runction(e,t){return this.x1<=e&&e<=this.x2&&this.y1<=t&&t<=this.y2}},{key:"containsBoundingBox",value:function(e){var t=e.getOriginPoints();return this.containsPoint(t[0],t[1])&&this.containsPoint(t[2],t[3])}}])&&vo(t.prototype,r),n&&vo(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function mo(e,t,r,n){return[{lng:r,lat:t},{lng:r,lat:n},{lng:e,lat:n},{lng:e,lat:t},{lng:r,lat:t}]}function bo(e,t){var r,n,i,o,a=e.lowerQuantile,s=void 0===a?.1:a,u=e.upperQuantile,l=void 0===u?.9:u,c=e.marginMultiplier,f=void 0===c?.2:c,d=e.minMargin,h=vn(e){return e.lat||e[0]})),v=t.map((function(e){return e.lng||e[1]}));if(v.length>10)r=ko(v,s),n=ko(v,l),i=ko(p,s),o=ko(p,l);else{var y=function(e,t){return{lowerLongitude:Math.min.apply(Math,fo(e)),upperLongitude:Math.max.apply(Math,fo(e)),lowerLatitude:Math.min.apply(Math,fo(t)),upperLatitude:Math.max.apply(Math,fo(t))}}(v,p);r=y.lowerLongitude,n=y.upperLongitude,i=y.lowerLatitude,o=y.upperLatitude}var g=Math.max(f*(n-r),h),m=Math.max(f*(o-m,n+g,o+m)}function ko(e,t){var r=e.sort((function(e,t){return e-t})),n=(r.length-1)*t,i=Math.floor(n),o=n-i;return void 0!==r[i+1]?r[i]+o*(r[i+1]-r[i]):r[i]}function wo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||xo(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterapply(e,n));return r&&Po(i,r.prototype),i},Co.apply(null,arguments)}function Po(e,t){return Po=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Po(e,t)}function Lo(e){return function(e){if(Array.isArray(e))return Mo(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||xo(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xo(e,t){if(e){if("string"==typeof e)return Mo(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Mo(e,t):void 0}}function Mo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Fo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return _o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_o(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Oo(e,t){var r=Fo(e.getOriginPoints(),4),n=r[0],i=r[1],o=r[2],a=r[3],s=o-n,u=a-i,l=(i+a)/2,c=1/Math.cos(l*Math.PI/180),f=c*(u/s);if(f>t){var d=(c*u/t-s)/2;return mo(n-d,i,o+d,a)}if(f<t){var h=(s*t/c-u)/2;return mo(n,i-h,o,a+h)}return e.getCoordinates()}function So(e){return So="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},So(e)}function Eo(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Io(n.key),n)}}function Io(e){var t=function(e,t){if("object"!==So(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==So(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===So(t)?t:String(t)}var Ao=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,(r=[{key:"computeBoundingBox",value:function(e,t,r,n,i){if(!e||0===e.length)throw new Error("Cannot calculate bounds.(!t)return e[0].lat?e:e.map((function(e){return{lat:e[0],lng:e[1]}}));var o=null!=r?r:{},a=function(e,t,r,n){var i=e.minimumPins,o=void 0===i?50:i,a=e.interpolationRatio,s=void 0===a?.75:a;if(r<=o){if(n){var u=Co(go,Lo(n));if(u.containsBoundingBox(t)){var l=wo(u.getOriginPoints(),4),c=l[0],f=l[1],d=l[2],h=l[3],p=wo(t.getOriginPoints(),4),v=p[0],y=p[1],g=p[2],m=p[3];return new go(v+(c-v)*s,y+(f-y)*s,g+(d-g)*s,m+(h-m)*s)}return t}return t}return t}(o,bo(o,e),e.length,n);return Oo(a,i)}},{key:"computeCenteredBoundingBox",value:function(e,t,r){if(!e||0===e.length)throw new Error("Cannot calculate bounds. No valid coordinate values given.");return Oo(function(e,t){var r,n,i=null!==(r=e.lat)&&void 0!==r?r:e[0],o=null!==(n=e.lng)&&void 0!==n?n:e[1],a=In(i,t.map((function(e){var t;return null!==(t=e.lat)&&void 0!==t?t:e[0]})),!1),s=In(o,t.map((function(e){var t;return null!==(t=e.lng)&&void 0!==t?t:e[1]})),!0),u=o-s,l=Vt(i+(i-a),void 0,!1),c=Vt(o+u,void 0,!0);switch(An([i,o],[a,s])){case"sw":return new go(s,a,c,l);case"ne":return new go(c,l,s,a);case"se":return new go(c,a,s,l);default:return new go(s,l,c,a)}}(t.centeredOn,e),r)}}])&&Eo(t.prototype,r),n&&Eo(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function To(){return To="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Uo(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},To.apply(this,arguments)}function Bo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||Do(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Do(e,t){if(e){if("string"==typeof e)return jo(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?jo(e,t):void 0}}function jo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ro(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&No(e,t)}function No(e,t){return No=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},No(e,t)}function Vo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Uo(e);if(t){var i=Uo(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"===zo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function Uo(e){return Uo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Uo(e)}function zo(e){return zo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zo(e)}function Ko(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ho(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qo(n.key),n)}}function Zo(e,t,r){return t&&Ho(e.prototype,t),r&&Ho(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qo(e){var t=function(e,t){if("object"!==zo(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==zo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===zo(t)?t:String(t)}var Wo=zt,Go=Gt,Qo=Zt,$o=Et,Xo="qualifiers",Yo={default:void 0,onSelect:void 0},Jo="product",ea="property",ta="place",ra="cluster",na=[Jo,ea],ia=[Jo,ea,ta],oa="unknown",aa=["available","filtered","sold_out",oa],sa=aa,ua=[].concat(ia,[ra]),la=function(){function e(t,r,n){Ko(this,e),this.id=t,this.type=r,this.configHelper=n,this.data=[void 0,void 0],this.visible=!1,this._intersectingFeatureIds=[],this._clean()}return Zo(e,[{key:"_clean",value:function(){this.marker=void 0,this.markerType=void 0,this.popupContent=void 0,this.visible=!1,this._highlighted=!1,this.clearHashkeys(}},{key:"updateConfigHelper"er=e}},{key:"clearHashkeys",value:function(){this._hashKeys=void 0}},{key:"_importData",value:function(e,t){e&&(void 0===this.data[t]&&:"_removeData",value:function(e){delete this.data[e],this._clean()}},{key:"hashKeys",get:function(){return void 0===this._hashKeys&&(this._hashKeys=Go(void 0,this._highlighted,[])),this._hashKeys}},{key:"importUserData",value:function(e){this._importData(e,0)}},{key:"importTileData",value:function(e){this._importData(e,1)}},{key:"removeTileData"ta(1)}},{key:"removeUserData",value:function(){this._removeData(0)}},{key:"mergeUserData",value:function(e){this._mergeData(e,0)}},{key:"mergeTileData",value:function(e){this._mergeData(e,1)}},{key:"_mergeData",value:function(e,t){e&&Object.assign(this.data[t],e),this._hashKeys=void 0}},{key:"_toData",value:function(e){if(this.data[e])return{id:this.id,type:this.type}}},{key:"toUserData",value:function(){return this._toData(0)}},{key:"toTileject.assign(Object.assign({},this.toTileData()),this.toUserData())}},{key:"hasUserData",value:function(){return this._hasData(0)}},{key:"hasTileData",value:function(){return this._hasData(1)}},{key:"_hasData",value:function(e){var t=this.data[e];return void 0!==t&&Object.keys(t).length>0}},{key:"defined",get:function(){return!!this.data.find((function(e){return e}))}},{key:"userData",get:function(){returnhis.get:function(){return this.data[1]},set:function(e){this.data[1]=e}},{key:"latLng",get:function(){return this._getLatLngFromData(this._getFirstDefined.bind(this))}},{key:"userLatLng",get:function(){return this._getLatLngFromData(this._getUserProp.bind(this))}},{key:"_getLatLngFrom)}},lighted},set:function(e){this._highlighted=e,this._hashKeys=void 0ue:function(e){return(this.data.find((function(t){return(t||{})[e]}))||{})[e]}},{key:"_getUserProp",value:function(e){return(this.data[0]||{})[e]}},{key:"intersectingeIds},set:function(e){void 0!==e&&(this._invar t=Vo(r);function r(e,n,i){return Ko(this,r),t.call(this,e,n,i)}return Zo(r,[{key:"hashKeys",get:function(){if(void 0===this._hashKeys){var e=this.qualifiers&&this.configHelper?this.configHelper.filterQualifiersUsed(this.type,this.qualifiers):this.qualifiers,t=Go(this.status,this._highlighted||!1,e);this._hashKeys=this.configHelper?this.configHelper.filterHashkeysUsed(this.type,t):t}return this._hashKeys}},{key:"addQualifier",value:function(){for(var e=!1,t=this._getFirstDefined(Xo),r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return n.forEach((function(r){t.includes(r)||(t.push(r),e=!0)})),e&&(this._hashKeys=void 0),e}},{key:"removeQualifier",value:function(){for(var e=!1,t=this._getFirstDefined(Xo),r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return n.forEach((function(r){var n=t.indexOf(r);-1!==n&&(t.splice(n,1),e=!0)})),e&&(this._hashKeys=void 0),e}},{key:"_assign",value:function(e,t,r){void 0!==r?e[t]=r:void 0!==e[t]&&delete e[t]}},{key:"_importData",value:function(e,t){e&&(void 0===this.data[t]&&(this.data[t]={}),this._assign(this.data[t],"status",this.backwardCompatibleStatus(e)),this._assign(this.data[t],"name",e.name),this._assign(this.data[t],Xo,e.qualifiers||[]),this._assign(this.data[t],"textLabel",e.textLabel),this._assign(this.data[t],"price",e.price),this._assign(this.data[t],"text",e.text),this._assign(this.data[t],"latLng",void 0!==e.lat&&void 0!==e.lng?Wo([e.lat,e.lng]):void 0),this._assign(this.data[t],"score",e.score),this._assign(this.data[t],"thumbnail",e.thumbnail),this._assign(this.data[t],"description",e.description),this._assign(this.data[t],"tile",e.tile),this._assign(this.data[t],"ariaLabels",e.ariaLabels),this._hashKeys=void 0)}},{key:"_toData",value:function(e){var t=this.data[e];if(t)return{id:this.id,type:this.type,status:t.status||oa,qualifiers:t.qualifiers||[],name:t.name,price:t.price,text:t.text,lat:t.latLng?t.latLng[0]:void 0,lng:t.latLng?t.latLng[1]:void 0,score:t.score,thumbnail:t.thumbnail,description:t.descriptilue:function(e){return"unavailable"===e.status?"sold_out":e.status}},{key:"isUserDataChanged",value:function(e){if(!e)return!1;var t=Bo(Wo([e.lat,e.lng]),2),r=t[0],n=t[1];return!this._same(this.userStatus||oa,this.backwardCompatibleStatus(e)||oa)||!this._same(this.userPrice,e.price)||!this._same(this.userText,e.text)||!this._same(this.userName,e.name)||!this._same(this.userDescription,e.description)||!Qo(this.userQualifiers,e.qualifiers,!1)||Math.abs(this.userLatLng[01e-5}},{key:"_same",value:function(e,t){return e===t||$o(e)&&$o(t)}},{key:"status",get:function(){return this._getStatusFromData(this._getFirstDefined.bind(this))}},{key:"userStatus",get:function(){return this._getStatusFromData(this._getUserProp.bind(this))}},{key:"_getStatusFromData",value:function(e){return e("status")||oa}},{key:"qualifiers",get:function(){return this._getQualifiersFromData(this._getFirstDefined.bind(this))}},{key:"userQualifiers",get:function(){return this._getQualifiersFromData(this._getUserProp.bind(this))}},{key:"_getQualifiersFromData",value:function(e){return e("qualifiers")}},{key:"name",get:function(){return this._getFirstDefined("name")}},{key:"userName",get:function(){return this._getNameFromData(this._getUserProp.bind(this))}},{key:"_getNameFromData",value:function(e){return e("name")}},{key:"description",get:function(){return this._getFirstDefined("description")}},{key:"userDescription",get:function(){return this._getDescriptionFromData(this._getUserProp.bind(this))}},{key:"_getDescriptionFromData",value:function(e){return e("description")}},{key:"price",get:function(){return this._getPricels",get:function(){return this._getFirstDefined("ariaLabels")||Yo}},{key:"userPrice",get:function(){return this._getPriceFromData(this._getUserProp.bind(this))}},{key:"_getPriceFromData",value:function(e){return e("price")}},{key:"text",get:fuction(){return this._getTextFrohis))}},{key:"_getTextFromData",value:function(e){return e("text")}},{key:"score",get:function(){return this._getFirstDefined("score")}}]),r}(la),fa=function(e){Ro(r,e);var t=Vo(r);function r(e){var n;return Ko(this,r),(n=t.calion(){To(Uo(r.prototype),"_clean",this).call(this),this.visible=!0}},{key:"_importData",value:function(e,t){e&&(this.data[t]={children:e.children,radius:e.radius,minPrice:e.minPrice,originalLatLng:Wo([e.lat,e.lng])},this._hashKeys=void 0)}},{key:"_toData",value:function(e){var t=this.data[e];if(t)return{id:this.id,type:this.type,radius:t.radius,children:t.children,minPrice:t.minPrice,lat:t.ori},{key:"computedLatLng",get:function(){return this._computedLatLng},set:function(e){e&&e.length>0?this._computedLatLng=Wo([e[0],e[1]]):this._computedLatLng=[]}},{key:"latLng",get:function(){return this._getFirstDefined("originalLatLng")}},{key:"children",get:function(){return this._getFirstDefined("children")}},{key:"minPrice",get:function(){return this._getFirstDefined("minPrice")}}]),r}(la),da=function(){function e(t,r){Ko(this,e),this.type=t,this.newInstance=r,this.index=new Map,this._data=[nction(){return this._dataefined}))}},{key:"contains",value:function(e){return!!this.find(e)}},{key:"find",value:function(e){var t,r,n=null!==(t=this.index.get(e))&&void 0!==t?t:-1;if(n>-1)return this._data[n]&&null!==(r=this._data[n])&&void 0!==r&&r.defined?this._data[n]:void 0}},{key:"save",value:function(e){if(e.type===this.type){var t,r=null!==(t=this.index.get(e.id))&&void 0!==t?t:-1;r>-1?this._data[r]=e:(this.index.set(e.id,this._data.length),this._data.push(e))}}},{key:"delete",value:function(e){if(e.type===this.type){var t,r=null!==(t=this.index.get(e.id))&&vo,{key:"clearAll",value:function(){this._data=[],this.index=new Map}}]),e}(),ha=function(){function e(){Ko(this,e),this._repositories={product:new da(Jo,(function(e,t){return new ca(e.id,Jo,t)})),property:ned,ea,t)})),place:new e.id,ta,t)})),cluster:new da(ra,(function(e,t){return new fa(e.id)}))}}return Zo(e,[{key:"allProducts",value:function(){return this.all((function(e){return e===Jo}))}},{key:"allProperties",value:function(){return this.all((function(e){return e===ea}))}},{key:"allPlaces",value:function(){return this.all((function(e){return e==sters",value:function(){return this.all((function(e){retusters",value:function(,{key:"find",value:function(e,t){return this.repository(t).find(e)}},{key:"delete",value:function(e,t)},{key:"repository",value:function(e){return this._repositories[e]}},{key:"all",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return!0},r=[];return Object.keys(this._repositories).filter((function(e){return t(e)})).forEach((function(t){r=r.concat(e._repositories[t].data)})),r}},{key:"upsertUserData",value:function(e,t){retuata",value:function(e,t){return this._upsert(e,"importTileData",t)}},{key:"insertTileData",value:function(e,t){if(!this.repository(e.type).find(e.id))return this._upsert(e,"importTileData",t)}},{key:"insertTileDataWithLowestZoom",value:function(e,t){var r=this.repository(e.type).find(e.id);if(!r)return this._upsert(e,"importTileData",t);var n=r.tileData&&r.tileData.tile,i=e.tile&&e.tile[2],o=n&&n[2];return void 0!==i&&(void 0===o||i<o)?this._upsert(e,"importTileData",t):void 0}},{key:"_upsert",value:function(e,t,r){var n=this.repository(e.type).find(e.id);return n||(n=this.repository(e.type).newInstance(e,r)),n[t]ileData",value:function(e){return this._delete(e,"removeTileData")}},{key:"_delete",value:function(e,t){var r=this.repository(e.type).find(e.id);return r&&(r[t](e),r.defined||this.repository(e.type).delete(e)),r}}]),e}();function pa(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[{score:"DESC"},{id:"ASC"}];return e.sort((function(e,r){var n,i=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Do(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}(t);try{for(i.s();!(n=i.n()).done;)for(var o=n.value,a=0,s=Object.keys(o);a<s.length;a++){var u=s[a],l=e[u],c=r[u],f=0;if(void 0===l&&void 0!==c?f=-1:void 0!==l&&void 0===c?f=1:void 0!==l&&void 0!==c&&(l<c&&(f=-1),l>c&&(f=1)),"DESC"===o[u]&&(f*=-1),0!==f)return f}}catch(e){i.e(e)}finally{i.f()}return 0}))}function va(e){return va="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},va(e)}function ya(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||ma(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iteranction(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function ma(e,t){if(e){if("string"==typeof e)return ba(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ba(e,t):void 0}}function ba(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ka(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wa(n.key),n)}}function wa(e){var t=function(e,t){if("object"!==va(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==va(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===va(t)?t:String(t)}var Ca=_t,Pa=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,r=[{key:"init",value:function(e){var t=e.asKey,r=e.getMarkerComponent,n=e.getRectOfMarker,i=e.moveMarkerPosition,o=e.makeMarkerVisible,a=e.settings;this.asKey=t,this.getMarkerComponent=r,this.getRectOfMarker=n,this.moveMarkerPosition=i,this.makeMarkerVisible=o,this.settings=a;var s=a.collision;this.textLabelVisibility=s.labelVisibility,this.textLabelDynamicPlacement=s.dynamicPlacement,this.collisionBufferVariation=s.collisionBufferVariation,this.collisionBuffers=s.collisionBuffers,this.tagCollidingMarkersConfig=s.tagCollidingMarkers,this.clusterMarkerCollisionBuffer=s.clusterMarkerCollisionBufferInPixels,this.shouldMoveCollidingClusterMarkers=s.shouldMoveCollidingClusterMarkers}},{key:"_isMarkerCollidingOtherMarkerOrLabel",value:function(e,t){var r,n=e.markerBBox,i=ga(t);try{for(i.s();!(r=i.n()).done;){var o=r.value,a=o.textLabelBBox,s=o.markerBBox,u=o.labelVisibility;if(n&&(s&&$e(n,s)||u&&a&&$e(n,a)))return!0}}catch(e){i.e(e)}finally{i.f()}return!1}},{key:"_isLabelCollidingOtherMarkerOrLabel",value:function(e,t){var r,n=e.textLabelBBox,i=e.labelVisibility,o=ga(t);try{for(o.s();!(r=o.n()).done;){var a=r.value,s=a.textLabelBBox,u=a.markerBBox,l=a.labelVisibility;if(i&&n&&(l&&s&&$e(n,s)||u&&$e(n,u)))return!0}}catch(e){o.e(e)}finally{o.f()}return!1}},{key:"_sortCandidateBBoxes",value:function(e){return e.sort((function(e,t){return e.popularity===t.popularity?e.feature.id<t.feature.id?-1:1:e.popularity>t.popularity?-1:1}))}},{key:"_splitFeaturesBoundingBoxes",value:function(e){var t=[],r=[];return e.forEach((function(e){"always"===e.labelVisibility||!1===e.isDynamicLabel?t.push(e):r.push(e)})),{safeFeaturesBBoxes:t,candidateBBoxes:r}}},{key:"_updateMarkerLabelPosition",value:function(e){var t=this._splitFeaturesBoundingBoxes(e),r=t.safeFeaturesBBoxes,n=t.candidateBBoxes;for(this._sortCandidateBBoxes(n);n.length>0;){var i=ya(n,1)[0],o=i.feature,a=i.labelVisibility,s=i.availableLabelPositions,u=i.currentLabelPosition,l=o.marker;if(this._isMarkerCollidingOtherMarkerOrLabel(i,r))nt(this.getMarkerComponent(o),eu),n.shift();else{var c=a&&this._isLabelCollidingOtherMarkerOrLabel(i,r);if(c){s[u]=!1;for(var f=!1,d=0,h=Object.entries(s);d<h.length;d++){var p=ya(h[d],2),v=p[0];if(p[1]){f=!0,u=v;break}}f?(l.labels.updateTextLabelPosition(u),i.textLabelBBox=ou(o,this.getMarkerComponent(o),this.settings,u,this.getRectOfMarker),i.currentLabelPosition=u):(l.labels.toggleTextLabel(c),i.labelVisibility=!1,r.push(i),n.shift())}else r.push(i),n.shift()}}}},{key:"getPopularity",value:function(e){var t,r=null!==(t=null==e?void 0:e.score)&&void 0!==t?t:0;return"number"!=typeof r?0:r}},{key:"_calculateFeaturesBoundingBoxes",value:function(e,t,r){var n=this,i=e.map((function(e){var i=n.asKey(e),o=t[i],a=e.marker.textLabelPosition;return{labelVisibility:o,availableLabelPositions:{right:!0,left:!0,above:!0,below:!0},currentLabelPosition:a,isDynamicLabel:r[i],markerBBox:n.getRectOfMarker(e),textLabelBBox:o?ou(e,n.getMarkerComponent(e),n.settings,a,n.getRectOfMarker):void 0,popularity:n.getPopularity(e),feature:e}}));return i}},{key:"_resetMarkersAndLabels",value:function(e,t){var r=this;e.forEach((function(e){var n;ot(r.getMarkerComponent(e),eu),t[r.asKey(e)]&&(null===(n=e.marker)||void 0===n||n.labels.resetTextLabel())}))}},{key:"_getLabelVisibilityConfigByFeatureKey",value:function(e){var t=this,r={};return e.forEach((function(e){var n=Ca(t.textLabelVisibility[e.type],e.hashKeys),i=t.asKey(e);r[i]=n})),r}},{key:"_getLabelDynamicPlacementConfigByFeatureKey",value:function(e){var t=this,r={};return e.forEach((function(e){var n=Ca(t.textLabelDynamicPlacement[e.type],e.hashKeys),i=t.asKey(e);r[i]=n})),r}},{key:"handleMarkerLabelCollision",value:function(e){var t=this,r=e.filter((function(e){return t.getMarkerComponent(e)})),n=this._getLabelDynamicPlacementConfigByFeatureKey(r);if(Object.values(n).includes(!0)){var i=this._getLabelVisibilityConfigByFeatureKey(r);this._resetMarkersAndLabels(r,i);var o=this._calculateFeaturesBoundingBoxes(r,i,n);this._updateMarkerLabelPosition(o)}}},{key:"moveCollidingClusterMarkers",value:function(e){var t=this;e.filter((function(e){return"cluster"===e.feature.type&&t.getMarkerComponent(e.feature)})).forEach((function(r){var n,i=null===(n=r.feature.toData())||void 0===n?void 0:n.radius;if(ot(t.getMarkerComponent(r.feature),"cluster-marker-moved"),ot(t.getMarkerComponent(r.feature),"cluster-marker-failed-toe){return r.feature._intersectingFeatureIds.includes(e.feature.id)})),a=t.getMaxRectOfMarkers(o),s=r.markerRect,u=lt(a,s,t.clusterMarkerCollisionBuffer),l=dt(s,u),c=ct(l.center,l.width+2*r.markerCollisionBuffer,l.height+2*r.markerCollisionBuffer),f=e.filter((function(e){return e.feature.id!==r.feature.id&&t.getMarkerComponent(e.feature)}));t.withinClusterRadius(s.center,l,i)&&t.noNewClusterCollision(c,f)?(t.moveMarkerPosition(r.feature,u),nt(t.getMarkerComponent(r.feature),"cluster-marker-moved"),t.updateIntersectingFeatureIdsAfterMovingClusterMarkerPosition(r.feature,l,f),r.markerRect=l,r.markerRectWithBuffer=c):nt(t.getMarkerComponent(r.feature),"cluster-marker-failed-to-move")}}),this)}},{key:"updateIntersectingFeatureIdsAfterMovingClusterMarkerPosition",value:function(e,t,r){var n=e.id;e._intersectingFeatureIds=[],r.forEach((function(e){var r=e.feature._intersectingFeatureIds.indexOf(n);$e(e.markerRectWithBuffer,t)?r<0&&e.feature._intersectingFeatureIds.push(n):r>-1&&e.feature._intersectingFeatureIds.splice(r,1)}))}},{key:"withinClusterRadius",value:function(e,t,r){return Ye(t,this.getClusterCircle(e,r)function(e,t){return!t.some((function(t){return $e(e,t.markerRect)}))}},{key:"getClusterCircle",value:function(e,t){reture:function(e){return ft(e.map((function(e){return e.markerRect})))}},{key:"hideCollidingMarkers",value:function(e,t){var r=this,n=e.filter((function(e){return r.getMarkerComponent(e)})),i=[],o=[];n.forEach((function(e){"none"===t[r.asKey(e)]?i.push(e):o.push(e)}));for(var a=pa(o,[{type:"ASC"},{score:"DESC"},{id:"ASC"}]);a.length>0;){var s,u=a.shift(),l=!1,c=ga(i);try{for(c.s();!(s=c.n()).done;){var f=s.value;if(u&&f&&u.type===f.type&&u._intersectingFeatureIds.includes(f.id)){this.makeMarkerVisible(u,!1),this.updateIntersectingFeatureIdsAfterHidingMarker(n,u.id),l=!0;break}}}catch(e){c.e(e)}finally{c.f()}l||i.push(u)}}},{key:"updateIntegFeatureIds.indexOf(t);r>-1&&e._intersectingFeatureIds.splice(r,1)}))}},{key:"tagCollidingMarkers",value:function(e,t){var r=this,norEach((function(e){ot(r.getMarkerComponent(e),"marker-collision")})),n.filter((function(e){return e._intersectingFeatureIds.length>0&&t[r.asKey(e)]})).forEach((function(e){var t,i=ga(n);try{for(i.s();!(t=i.n()).done;){var o=t.value.id;if(e.id!==o&&e._intersectingFeatureIds.includes(o)){nt(r.getMarkerComponent(e),"marker-collision");break}}}catch(e){i.e(e)}finally{i.f()}}))}},{key:"updateMarkerPosition",value:function(e){var t=this,r=e.filter((function(e){return t.getMarkerComponent(e)})),n=this.getCollisionBufferVariationByFeatureKey(r),i=this.getFeaturesWithMarkerRects(r,n);this.updateIntersectingFeatureIds(i),this.shouldMoveCollidingClustersterMarkers(i),Object.values(n).some((function(e){return"none"!==e}))&&this.hideCollidingMarkers(r,n);var o=this.getTagCollidingMarkersConfigByFeatureKey(r);Object.values(o).includes(!0)&&this.tagCollidingMarkers(r,o)}},{key:"getTagCollidingMarkersConfigByFeatureKey",value:function(e){var t=this,r={};return e.forEach((function(e){var n=Ca(t.tagCollidingMarkersConfig[e.type],e.hashKeys),i=t.asKey(e);r[i]=n})),r}},{key:"getCollisionBufferVariationByFeatureKey",value:function(e){var t=this,r={};return e.forEach((function(e){var n=Ca(t.collisionBufferVariation[e.type],e.hashKeys),i=t.asKey(e);r[i]=n})),r}},{key:"updateIntersectingFeatureIds",value:function(e){e.forEach((function(t){var r;(null===(r=t.feature._intersectingFeatureIds)||void 0===r?void 0:r.length)>0&&(t.feature._intersectingFeatureIds=[]),"cluster"===t.feature.type&&(t.feature.computedLatLng=[]),e.forEach((function(e){t.feature.id!==e.feature.id&&$e(t.markerRectWithBuffer,e.markerRect)&&t.feature._intersectingFeatureIds.push(e.feature.id)}))}))}},{key:"getFeaturesWithMarkerRects",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.filter((function(e){return t.getMarkerComponent(e)})).map((function(e){var n=r[t.asKey(e)],i=t.collisionBuffers[n]||0;return{feature:e,markerRectWithBuffer:t.getRectOfMarker(e,i),markerRect:t.getRectOfMarker(e),markerCollisionBuffer:i}}))}}],r&&ka(t.prototype,r),n&&ka(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function La(e){return La="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},La(e)}function xa(e){return function(e){if(Array.isArray(e))return Ma(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Ma(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ma(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ma(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Fa(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _a(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==La(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==La(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===La(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Oa=_t,Sa={doubleClick:{type:"dblclick",dom:!0}};function Ea(e,t){var r,n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"none",o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4?arguments[4]:void 0;if(Y(e)){r=e.cloneNode(!0);var s=["component-icon"];a&&s.push(a),o&&(n=pr(J(e)||"")),it(r,s)}else r=Me(void 0,void 0,a,void 0,e);if("none"!==i){var u=Aa(void 0,t,r,"frame").main;return n&&(u.hashCode=n),{iconImg:r,main:u}}return ve(r,t),n&&(r.hashCode=n),{iconImg:r,main:r}}function Ia(e,t,r,n,i,o){var a=Ce(void 0,void 0,"".concat(r,"-content"),void 0,i);Ee(a);var s=Aa(e,t,a,"".concat(r,"-label"),"".concat(r,"-text ").concat(n),o);return{main:s.main,text:s.text,span:a}}function Aa(e,t,r,n,i,o){var a=ge(e,t,i,o),s=ge(void 0,a,n);return s.appendChild(r),{main:a,text:s}}function Ta(e,t){var r=e.hashKeys,n=t.textLabelVisibility,i=t.textSubLabelVisibility,o={};if(Oa(n[e.type],r)){var a=e.name;a&&(o.label=a)}if(Oa(i[e.type],r)){var s=e.description;s&&(o.subLabel=s)}return o}function Ba(e,t){var r,n,i=t.markerTypes,o=t.frameIcons,a=t.icons,s=t.zIndexes,u=t.cornerIcons,l=t.innerIcons,c=t.iso4217CurrencyCode,f=tfineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({markerType:g,zIndex:0,cssClasses:{toAdd:[e.type,p.status,p.highlighted?"hl":"not-hl"],toRemove:[p.highlighted?"not-hl":"hl"]},frameIcon:Oa(o[h],d),icons:{}},Ta(p,t));switch(g){case"price":case"priceObfuscate":v?m.textContent=vr(v,void 0,c,f):m.markerType="price"===g?"pin":"pinObfuscate";break;case"text":y?m.textContent=y:m.markerType="pin"}switch(null!=e&&null!==(r=e.marker)&&void 0!==r&&r.cssClasses&&(n=m.cssClasses.toRemove).push.apply(n,xa(e.marker.cssClasses)),m.markerType){case"pin":m.cssClasses.toAdd.push("pin-marker"),m.icons.pin=Oa(a[e.type],d);break;case"price":m.cssClasses.toAdd.push("price-marker");break;case"text":m.cssClasses.toAdd.push("text-marker");break;case"obfuscate":m.cssClasses.toAdd.push("obfuscate-marker");break;case"pinObfuscate":m.cssClasses.toAdd.push("pin-obfuscate-marker"),m.icons.pin=Oa(a[e.type],d);break;case"priceObfuscate":m.cssClasses.toAdd.push("price-obfuscate-marker");break;default:throw new Error("Unknown marker type: ".concat(m.markerType))}var b,k=p.qualifiers||[];k.length>0&&(b=m.cssClasses.toAdd).push.apply(b,xa(k)),m.zIndex=Oa(s[p.type],d);var w=Qa(p,u);u&&(m.icons.cornerIcons=w);var C=$a(p,l);return l&&(m.icons.innerIcons=C),m}function Da(e,t,r){e&&r.onSelect?Fe(t,r.onSelect):r.default?Fe(t,r.default):Oe(t)}function ja(e,t,r){Da(e,t,r),De(t),je(t)}function Ra(e,t){var r,n=e.marker,i=Ta(e,t),o=i.label,a=i.subLabel;null===(r=n.labels)||void 0===r||r.updateTextLabel(o,a)}function Na(e,t,r,n){var i,o=null==e||null===(i=e.marker)||void 0===i?void 0:i.iconElements;if(o){var a=[];for(var s in t)if("cornerIcons"!==s&&"innerIcons"!==s){var u=o[s];Ke(o[s],t[s]),a.push(Hn(u,r,n))}return zr(a).then((function(){return!0}))}return Promise.resolve(!1)}function Va(e,t){e&&e.zIndexElement&&(Tt(e.zIndexElement)?e.zIndexElement.forEach((function(e){return He(e,t)})):He(e.zIndexElement,t))}function Ua(e){e&&e.bounceElement&&tn(e.bounceElement)}function za(e,t){return"none"!==e[t]}function Ka(e,t){t&&Object.keys(t).forEach((function(r){if(za(t,r)){var n=ge(void 0,e,"corner-icon ".concat(r));Ea(t[r],n)}}))}function Ha(e,t){if(t){var r=e.parentElement||void 0;Object.keys(t).forEach((function(n){if(za(t,n)){var i;switch(n){case"left":var o=ue(e);o>=0&&gt(i=ge(void 0,void 0,"inner-icon ".concat(n)),r,o);break;case"right":i=ge(void 0,r,"inner-icon ".concat(n))}i&&Ea(t[n],i)}}))}}function Za(e,t){var r=Object.keys(e);return!(Zt(r,Object.keys(t),!1)&&r.every((function(r){return t[r]&&!Zn(e[r],t[r],!0)})))}function qa(e,t){return Za(e,t)}function Wa(e,t){return Za(e,t)}function Ga(e,t){var r;return Object.keys(t).forEach((function(n){var i=Oa(t[n][e.type],e.hashKeys);i&&,r}function Qa(e,t){return Ga(e,t)}functionXa(e,t){return t(e,Sa.doubleClick,(function(e){e.stopPropagation()}))}function Ya(e){return Ya="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.String:Number)(e)}(e,"string");return"symbol"===Ya(t)?t:String(t)}var ts=function(){function e(t){var r=t.getFeatureStatus,n=t.getI18N,i=t.filter,o=t.markerTypes,a=t.icons,s=t.addEventListener,u=t.uniqId,l=t.eventClick,c=t.readParam,f=t.writeParam,d=t.eventsManager;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.checkboxes={},this.getFeatureStatus=r,this.getI18N=n,this.filter=i,this.markerTypes=o,this.icons=a,this.addEventListener=s,this.uniqId=u,this.eltId=this.uniqId("fbox"),this.eventClick=l,this.readParam=c,this.writeParam=f,this.eventsManager=d}var t,r,n;return t=e,r=[{key:"init",value:function(e){var t=e.node,r=e.updateViewport;this.node=t,this._createFiey:"removeAllUIElements",value:function(){he(this.node,this.eltId)}},{key:"syncFilterChecked",value:function(e){var t=this;Object.keys(this.checkboxes).forEach((function(r){return Object.keys(t.checkboxes[r]).forEach((function(n){var i=t.checkboxes[r][n].checked,o="markers,".concat(r,",show,").concat(n);e.writeParam(o,i)}))}))}},{key:"_createFiltersBox",value:function(){var e=this;this.checkboxes={},this.fBox=ge(this.eltId,this.node,"map-legend closed");var t=ge(void 0,this.fBox,"map-legend-header",void 0);Fe(we(void 0,t,"toggle",void 0,void 0),this.getI18N(mi.ariaFilterBoxToggleLegend)),this.addEventListener(this.fBox,this.eventClick,(function(t){"checkbox"!==t.target.type&&Xe(e.fBox,"open","closed")})),Le(void 0,t,"fbox-title",void 0,this.getI18N(mi.filterBoxLegend));var r=this.filter.visibilityByStatus;Object.keys(this.filter.showFilter).forEach((function(t){var n=t;if(e.filter.showFilter[n]&&Object.values(r[n]).some((function(e){return"never"!==e}))){var i=me(void 0,e.fBox,"fbox-list ".concat(n)),o=r[t];e.getFeatureStatus(n).forEach((function(t){var r=e.turnFeaturesVisible.bind(e,n);"never"!==o[t]&&e._createTypeBox(i,n,t,r,o[t])}))}}))}},{key:"turnFeaturesVisible",value:function(e,t,r,n,i){var o="markers,".concat(e,",show,").concat(t),a=this.readParam(o);if("always"===a||"never"===a)throw new Error("Cannot change config value ".concat(e," + ").concat(t,". The value is set to ").concat(a));if(a!==r&&(this.writeParam(o,r),i&&this.checkboxes&&this.checkboxes[e]&&this.checkboxes[e][t]&&(this.checkboxes[e][t].checked=r),this.updateViewport(),n)){var s={type:e,status:t,isVisible:r};this.eventsManager.pushEvent(ti.filterChanged,s)}}},{key:"_createTypeBox",value:function(e,t,r,n,i){var o="always"!==i,a=this._filterBoxLabel(t,r),s=this._ariaFilterBoxLabel(t,"CheckBox",r),u=this._ariaFilterBoxLabel(t,"Img",r),l=this.filter.visibilityBooleanByStatus[t][r],c=be(void 0,e,r);switch(this.markerTypes[t][r]||this.markerTypes[t].default){case"pin":case"pinObfuscate":Be(Me(void 0,c,"status-image",void 0,this.icons[t].legend||this.icons[t][r],u));break;case"price":case"priceObfuscate":it(Ia(void 0,c,"price",r,"$",void 0).main,["price-marker","price-marker-legend","not-hl"]);break;case"text":it(Ia(void 0,c,"text",r,"H",void 0).main,["text-marker","text-marker-legend","not-hl"]);break;default:throw new Error("marker type not supported: ".concat(this.markerTypes[t][r]))}var f=Ce(void 0,ke(void 0,c),"text",void 0,a);if(o){var d=xe(void 0,c,"check",void 0,r,l,s);Se(d,f.id),this.checkboxes||(this.checkboxes={}),this.checkboxes[t]||(this.checkboxes[t]={ntListener(d,this.eventClick,(function(e){n(r,e.target.checked,!0)}))}}},{key:"_ariaFilterBoxLabel",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"unknown",n=It(rr(e)),i=It(rr(r));return this.getI18N(mi["ariaFilterBox".concat(t).concat(n).concat(i)])}},{key:"_filterBoxLabel",value:function(e,t){var r=It(rr(e)),n=It(rr(t));return this.getI18N(mi["filterBox".concat(r).concat(n)])}}],r&&Ja(t.prototype,r),n&&Ja(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function rs(e){return rs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rs(e)}function ns(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,is(n.key),n)}}function is(e){var t=function(e,t){if("object"!==rs(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==rs(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===rs(t)?t:String(t)}function os(e){return os="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},os(e)}var as=["id","type"];function ss(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function us(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ss(Object(r),!0).forEach((function(t){ls(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ss(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ls(e,t,r){return(t=gs(t))in e?Object.definePropertect.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function fs(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=ps(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function ds(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||ps(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hs(e){return function(e){if(Array.isArray(e))return vs(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ps(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ps(e,t){if(e){if("string"==typeof e)return vs(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?vs(e,t):void 0}}function vs(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ys(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gs(n.key),n)}}function gs(e){var t=function(e,t){if("object"!==os(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==os(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===os(t)?t:String(t)}function ms(e,t){return ms=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ms(e,t)}function bs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=ks(e);if(t){var i=ks(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"===os(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function ks(e){return ks=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ks(e)}var ws=_t,Cs=Gt,Ps={click:{type:"click",dom:!0}};function Ls(){return{highlightedFeatures:[],selectedFeature:void 0,featuresOver:new Map,inBounds:{product:[],property:[],place:[]},routes:[],routeDestinations:[]}}var xs=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ms(e,t)}(o,e);var t,r,n,i=bs(o);function o(e,t,r,n){var a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(a=i.call(this)).eventsManager=t,a.features=r,a.mapData=n,a.boundsComputation=new Ao,a.listenersToDeregister=[],a.copyrightsDiv=a.createCopyrightsDiv(),a.copyrights=new Map,a.popup=void 0,a.ignoreMapClickEvent=!1,a.configHelper=e,a.settings=a.configHelper.loadMapSettings(),a.logger=a.configHelper.logger("BaseMap"),a.logger.debug("BaseMap constructor"),a.featureTypes=a.settings.featureTypes,a.clusterFactory=new Gn;var s=!1;return a._newFilterManager(s),a._newKeyboardFeatures(s),a._newRouteManager(),a._newClusterers(),a._newAvailabilityCheck(),a._newContentProviders(),a._newCollisionManagement(s),a.tilesLoader=void 0,a}return t=o,r=[{key:"_newKeyboardFeatures",value:function(e){this.keyboardFeatures&&this.keyboardFeatures.removeAllUIElements(),this.settings.isKeyboardFeaturesDefined?(this.keyboardFeatures=new $i(this.settings.keyboardFeaturesIcon,this.settings.getI18N),e&&this._initializeKeyboardFeatures(this.keyboardFeatures)):this.keyboardFeatures=void 0}},{key:"_initializeKeyboardFeatures",value:function(e){var t=this;e.init({node:this.node,uniqId:this.uniqId.bind(this),containerBounds:this.containerBounds.bind(this),listFeatures:this._listFeatures.bind(this),cloneMarker:this.cloneMarker.bind(this),zIndexes:this.settings.zIndexes,maxZIndex:this.settings.maxZIndex,getMapNavFocusElement:function(){return t.mapNavFocusElement},registerListenerOnMapFocusElement:this.registerListenerOnMapFocusElement.bind(this),handleMarkerClick:this.handleMarkerClick.bind(this),isFeatureSelected:this.isFeatureSelected.bind(this),clearSelectedFeature:this.clearSelectedFeature.bind(this)}),this.settings.isKeyboardFeaturesEnabled&&(this.turnKeyboardFeaturesMode(!0),e.updateKeyboardFeatures())}},{key:"_updateMarkerPosition",value:function(){var e;null===(e=this.collisionManagement)||void 0===e||e.updateMarkerPosition(this.features.all())}},{key:"_newAvailabilityCheck",value:function(){this.availabilityCheck=new gi(this.settings.loggerFactory,this.settings.availabilityProvider)}},{key:"_newContentProviders",value:function(){this.settings.isAnyContentProviderExists?this.contentProvider=new co(this.settings.loggerFactory,this.featureTypes,this.settings.contentProvidersByFeatureType,this.settings.contentProvidersConfigs):this.contentProvider=void 0}},{key:"_newRouteManager",value:function(){this.routes=new di({loggerFactory:this.settings.loggerFactory,egDistances:this.configHelper.egDistances(),routeLineStyleByDistanceMode:this.settings.routeLineStyleByDistanceMode,routeCacheInMs:this.settings.routeCacheInMs,findFeature:this._findFeature.bind(this),eventsManager:this.eventsManager,addRouteOnMap:this.addRouteOnMap.bind(this),removeRouteOnMap:this.removeRouteOnMap.bind(this),asKey:this.asKey},this.mapData.routes,this.mapData.routeDestinations)}},{key:"_updateTilesConfig",value:function(){var e,t=this;this.features.allExceptClusters().forEach((function(e){e.hasUserData()?e.hasTileData()&&e.removeTileData():t.features.delete(e.id,e.type)}));var r=this.getBounds(),n=r.sw,i=r.ne,o=this.getTileDim(),a=o.width,s=o.height,u=this.getZoom(),l=Mn(n[0],n[1],i[0],i[1],u,a,s);null===(e=this.tilesLoader)||void 0===e||e.instantiateTilesProvider(this.settings),l.forEach((function(e){var r=e.x,n=e.y;return setTimeout((function(){var e;return null===(e=t.tilesLoader)||void 0===e?void 0:e.loadTile(r,n,Math.floor(u))}),10)}))}},{key:"_newFilterManager",value:function(e){this.filterManager&&this.filterManager.removeAllUIElements(),this.settings.filter.isOneFilterAvailable?(this.filterManager=new ts({getFeatureStatus:this.settings.getFeatureStatus,filter:this.settings.filter,markerTypes:this.settings.markerTypes,icons:this.settings.icons,getI18N:this.settings.getI18N,addEventListener:this.addEventListener.bind(this),uniqId:this.uniqId.bind(this),eventClick:Ps.click,readParam:this.configHelper.readParam.bind(this.configHelper),writeParam:this.configHelper.writeParam.bind(this.configHelper),eventsManager:this.eventsManager}),e&&this._initializeFilterManager(this.filterManager)):this.filterManager=void 0}},{key:"_initializeFilterManager",value:function(e){e.init({node:this.node,updateViewport:this._updateViewport.bind(this)})}},{key:"_newCollisionManagement",value:function(e){this.collisionManagement=new Pa,e&&this._initializeCollisionManagement(this.collisionManagement)}},{key:"_initializeCollisionManagement",value:function(e){e.init({asKey:this.asKey.bind(this),getMarkerComponent:this.getMarkerComponent.bind(this),getRectOfMarker:this.getRectOfMarker.bind(this),moveMarkerPosition:this.moveMarkerPosition.bind(this),makeMarkerVisible:this._makeMarkerVisible.bind(this),settings:this.settings})}},{key:"_newClusterers",value:function(){this.clusterers=this.clusterFactory.createClusterers(this.settings.loggerFactory,this.settings.clusterConfigurationByType,this.settings.;null===(t=this.filterManager)||void 0===t||t.syncFilterChecked(e)}},{key:"updateConfiguration",value:function(e,t,r){this.configHelper=e,this.settings=t;var n=r.clearHashkeys,i=r.updateMarkers,o=r.updateViewport,a=r.updateMapProviderConfig,s=r.updateFiltersUI,u=r.updateKeyboardA11yUI,l=r.updateStyling,c=r.updateTiles,f=r.resetAvailabilityCheck,d=r.resetClusterers,h=r.resetCollisionManagement,p=r.resetContentProviders,v=r.resetRouteManagement,y=!0;if(a&&this.updateMapProviderConfig(),c&&this._updateTilesConfig(),n&&this.clearHashkeys(),f&&this._newAvailabilityCheck(),d&&this._newClusterers(),v){var g,m=null===(g=this.routes)||void 0===g?void 0:g.listRegisteredRoutes();this.resetRouteStyle(),this._newRouteManager(),this.syncRegisteredRoutes(m),this.updateRoutesOnViewport()}return p&&this._newContentProviders(),h&&this._newCollisionManagement(y),s&&(this.syncFilterChecked(this.configHelper),this._newFilterManager(y)),u&&this._newKeyboardFeatures(y),l&&this._addCssStyleFromConfig(this.settings.styling),Wr.getDebugConfigEnabled()&&console.debug("Configurations updated",this.configHelper.getEGMapConfigurations()),i&&this.clearMarkers(),o?this._updatr e;null===(e=this.routes)||void 0===e||e.updateRoutesOnViewport()}},{key:"syncRegisteredRoutes",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t&&t.forEach((function(t){var r;return null===(r=e.routes)||void 0===r?void 0:r.registerRoute(t.origin,t.destination,t.polyline)}))}},{key:"initMap",value:function(e,t,r,n){var i=this;this.logger.debug("map is initializing");var o=Date.now();this.node=e,this.cssClassId=t,this.idPrefix="".concat(this.node.id,"_"),this._addCssStyleFromConfig(this.settings.styling),this.collisionManagement&&this._initializeCollisionManagement(this.collisionManagement);var a=null==r?void 0:r.options,s=null==a?void 0:a.gaiaId;return Wr.getDebugConfigEnabled()&&console.debug("Configurations used",this.configHelper.getEGMapConfigurations()),this._loadHistoricalBoundingBox(s).then((function(){return i.init(r,n)})).then((function(){return i._lateInit()})).then((function(){i.logger.debug("map initialized in ".concat(Date.now()-o,"ms"))}))}},{key:"_lateInit",value:function(){var e=this,t=new Set([].concat(hs(Kn(this.settings.icons)),hs(zn(this.settings.cornerIcons)),hs(zn(this.settings.innerIcons))));retuures),e.filterManager&&e._initializeFilterManager(e.filterManager)}))}},{key:"createCopyrightsDiv",value:function(){var e=ge(this.uniqId("copyrights-div"),this.node,htsDiv),e}},{key:"uniqId",value:function(e){return this.idPrefix+e}},{key:"cloneObfuscatedPolygon",value:function(e,t){var r,n,i,o,a,s=ws(this.settings.obfuscateStyle[e.type],e.hashKeys),u=$t(null==s||null===(r=s.line)||void 0===r?void 0:r.opacity),l=$t(null==s||null===(n=s.fill)||void 0===n?void 0:n.opacity),c=t.cloneNode(!0);nt(c,"markerClone");var f="".concat(null==s||null===(i=s.fill)||void 0===i?void 0:i.color).concat(l),d="".concat(null==s||null===(o=s.line)||void 0===o?void 0:o.weight,"px"),h="".concat(null==s||null===(a=s.line)||void 0===a?void 0:a.color).concat(u);return c.dataset.cloneStyles="--fillcolor:".concat(f,"; --linewidth:").concat(d,"; --linecolor:").concat(h,";"),c}},{key:"_loadHistoricalBoundingBox",value:function(e){var t=this;return e?Kr(this.settings.historicalBoundingBoxDataEndpoint,5e3).then((function(r){return r.ok?r.json().then((function(r){if(r.errors)return t.logger.error("Failed to fetch historical bounding box data for gaia Id: esolve();var n=r.find((function(t){return t.gaia_id===e.toString()}));return null!=n&&n.historical_polygon_wkt&&(t.historicalBoundingBox=ir(n.historical_polygon_wkt)),Promise.resolve()})):Promise.resolve()})):Promise.resolve()}},{key:"_computeNativeBounds",value:function(e,t,r){var n,i=this.node&&0!==(null===(n=this.node)||void 0===n?void 0:n.clientWidth)?this.node.clientHeight/this.node.clientWidth:1,o=(null==r?void 0:r.centeredOn)?this.boundsComputation.computeCenteredBoundingBox(e,r,i):this.boundsComputation.computeBoundingBox(e,t,r,this.historicalBoundingBox,i);return this.computeNativeBoundsFromLatLongs(o)}},{key:"_parseClientPadding",value:function(e){try{if(this.node)return ur(e,this.node)}catch(e){this.logger.error(e.message,e.stack)}}},{key:"boundsContaining",value:function(e,t,r){var n=this,i=null==.then((function(){return n.asBounds(n._computeNativeBounds(e,t,r))})):Promise.resolve(this.asBounds(thin(e){return this.asBounds(this.computeNativeBoundsFromLatLongs(e))}},{key:"handleBoundsChanged",value:function(e){var t=this;if(this.logger.debug("bounds changed"),this.boundChangedDisabled)this.boundChangedDisabled=!1;else{var r=this.getBounds();if(r)return this._updateViewport().then((function(){var n={bounds:r,zoom:t.getZoom(),originalEvent:e};t.eventsManager.pushEvent(ti.boundsChanged,n)}))}return Promise.resolve()}},{key:"getCirclePolygonData",value:function(e){var t=ws(this.settings.obfuscatePrecision[e.type],e.hashKeys),r=ws(this.settings.obfuscateRadiusInMeters[e.type],e.hashKeys);return k([e.latLng[1],e.latLng[0]],r/1e3,{units:"kilometers",steps:t}).geometry.coordinates[0].map((function(e){return{lat:e[1],lng:e[0]}}))}},{key:"setStay",value:function(e){var t;if(!function(e){return void 0!==e.from&&void 0!==e.to&&e.roomOccupancies.length>0&&e.roomOccupancies.every((function(e){return function(e){return e.nbAdults>0}(e)}))}(e))throw new Error("stay is not valid");null!==(t=this.availabilityCheck)&&void 0!==t&&t.saveStay(e)&&(this.cleanAvailabilityTileData(this.features.allProperties()),this._updateViewport())}},{key:"_addCssStyleFromConfig",value:function(e){this.currentStyleId&&de(this.currentStyleId),e&&Object.keys(e).length>0&&this.cssClassId?(this.currentStyleId=this.uniqId("style"),Ct(this.currentStyleId,"EgMapsStyling",this.cssClassId,e)):this.currentStyleId=void 0}},{key:"cleanAvailabilityTileData",value:function(e){e.forEach((function(e){e.hasTileData()&&(e.tileData.))}},{key:"refresh",value:function(){return this._updateViewport()}},{key:"updateProductsAvailability",value:function(e){var t,r=this;return null===(t=this.availabilityCheck)||void 0===t?void 0:t.updateAvailability(e).then((function(e){return e.forEach((function(e){return r._fixMarkerToUse(e)}))}))}},{key:"updatePropertiesAvailability",value:function(e){var t,r=this;return null===(t=this.on(e){return e.forEach((funvalue:function(){var e=this.nativeBounds();return this.asBounds(e)}},{key:"_actionOnPreviousMarker",value:function(e){return function(t){return{hideRoute:ws(e[t.type],t.hashKeys).some((function(e){return"showRoutes"===e})),dehighlight:ws(e[t.type],t.hashKeys).some((function(e){retws(e[t.type],t.hashKeys).some((function(e){return"addAriaLive"===e}))}}}},{key:"handleMapClick",value:function(){var e=this;this.logger.debug("map click"),!0!==this.ignoreMapClickEvent?(this.settings.actionsOnMapClick.includes("removeAriaLive")&&this._updateAriaLiveOnFeature(this._getFeatureSelected(),!1),this.settings.actionsOnMapClick.forEach((function(t){var r;switch(t){case"clearHighlight":e._dehighlightFeatures();break;case"clearSelection":e.setSelectedFeature(void 0,e._actionOnPreviousMarker(e.settings.actionsOnMarkerClick),!0);break;case"closePopup":e._closePopup();break;case"hideRoutes":null===(r=e.routes)||void 0===r||r.hideRoutes()}}))):this.ignoreMapClickEvent=!1}},{key:"_updateAriaLiveOnFeature",value:function(e,t){var r;e&&(t?(e.marker||this._makeMarkerVisible(e,!0),_e(e.marker.ariaElement)&&Ie(e.marker.ariaElement)):Ae(null===(r=e.marker)||void 0===r?void 0:r.ariaElement))}},{key:"handleMarkerClick",value:function(e,t,r){var n,i=this;this.logger.debug("marker click");var o,a=e;if(a||"popup"!==t||(a=null===(o=this.popup)||void 0===o?void 0:o.feature),null!==(n=a)&&void 0!==n&&n.visible){var s=this.isFeatureSelected(a),u=this._isFeatureHighlighted(a),l=ws(this.settings.actionsOnMarkerClick[a.type],a.hashKeys);if(l.forEach((function(e){var t;switch(e){case"highlight":u||i._setHighlightedFeature(a);break;case"select":i.setSelectedFeature(a,i._actionOnPreviousMarker(i.settings.actionsOnMarkerClick),!0);break;case"toggleSelect":i.setSelectedFeature(s?void 0:a,i._actionOnPreviousMarker(i.settings.actionsOnMarkerClick),!0);break;case"openPopup":i._openPopup(a);break;case"closePopup":i._closePopup();break;case"zoomToExtent":var r=a;i._zoomToExtent(r.children);break;case"showRoutes":null===(t=i.routes)||void 0===t||t.showRoutes(a);break;case"loadFeatureContent":s||i.loadFeatureContent(a.id,a.type)}})),l.includes("addAriaLive")){var c=a;s?l.includes("toggleSelect")&&this._updateAriaLiveOnFeature(c,!1):this._updateAriaLiveOnFea"asKey",value:function(e){return"".concat(e.type,"-").concat(e.id)}},{key:"_setPopupVisible",value:function(e){var t,r;e?Ue(null===(t=this.popup)||void 0===t?void 0:t.visibleElement):Ve(null===(r=this.popup)||void 0===r?void 0:r.visibleElement)}},{key:"_findFeature",value:function(e,t){return this.features.find(e,t)}},{key:"setPopupContent",value:function(e,t,r){var n=this._findFeature(e,t);n&&(n.popupContent=r)}},{key:"_openPopup",value:function(e){if(this.popup){var t;if(e&&void 0===e.popupContent&&e.name){var r=ge(this.uniqId("popup-div"),void 0,"default-popup-content");Ce(this.uniqId("popup-span"),r,void 0,void 0,e.name),e.popupContent=r}if(void 0!==this.popup.feature&&this.popup.feature===e||(this.popup.feature=e),null!==(t=this.popup.feature)&&void 0!==t&&t.popupContent){this._fillPopupContent(this.popup.feature),this._setPopupVisible(!0),this.updatePopupPositionOnLayer();var n=this.configHelper.popupVisibilities()[this.popup.feature.type];ws(n,this.popup.feature.hashKeys)&&this.ensurePopupVisibility()}else this._fillPopupContent(),this._setPopupVisible(!1)}}},{key:"_calculatePopupVisibilityOffsetValues",value:function(e,t,r,n,i,o,a,s){var u=0,l=0;return e.x<-0+t?u=e.x+0-t:e.x+o+0+t>n&&(u=e.x+o+0+t-n),s?e.y<-2+r+a?l=e.y+2-r-a:e.y+2+r>i&&(l=e.y+2+r-i):e.y<-2+r?l=e.y+2-r:e.y+a+2+r>i&&(l=e.y+a+2+r-i),[u,l]}},{key:"_closePopup",value:function(){this.popup&&(delete this.popup.feature,this._fillPopupContent(),this._setPopupVisible(!1))}},{key:"_fillPopupContent",value:function(e){if(this.popup)if(fe(this.popup.content),e&&e.popupContent){this.popup.content.appendChild(e.popupContent);var t=this.popup.backupStyleClass,r=ws(this.settings.popupPositions[e.type],e.hashKeys),n=[e.type,e.status,r];e.qualifiers&&n.push.apply(n,hs(e.qualifiers)),this.popup.backupStyleClass=n,tt(this.popup.cssElement,t,this.popup.backupStyleClass)}else{var i=this.popup.backupStyleClass;this.popup.backupStyleClass=void 0,tt(this.popup.cssElement,i,this.popup.backupStyleClass)}}},{key:"fillPopupExternally",value:function(e,t){e.popupContent=t,this._openPopup(e)}},{key:"isFeatureSelected",value:function(e){var t,r;return void 0!==e&&(null===(t=this.mapData.selectedFeature)||void 0===t?void 0:t.id)===(null==e?void 0:e.id)&&(null===(r=this.mapData.selectedFeature)||void 0===r?void 0:ull===(e=this._getFeatureSelected())||void 0===e?void 0:e.toData()}},{key:"_getFeatureSelected",value:function(){if(this.mapData.selectedFeature){var e=this.mapData.selectedFeature,t=e.id,r=e.type;return this._findFeature(t,r)}}},{key:"setSelectedFeature",value:function(e,t,r){if(!this.isFeatureSelected(e)){var n=this._getFeatureSelected();if(e){var i=e.id,o=e.type;this.mapData.selectedFeature={id:i,type:o}}else this.mapData.selectedFeature=void 0;if(null!=n&&n.marker){var a=n.status,s=n.qualifiers,u=Cs(a,!1,s),l=ws(this.settings.zIndexes[n.type],u);Va(n.marker,l)}if(e&&e.marker){var c=e.status,f=e.qualifiers,d=Cs(c,!0,f),h=ws(this.settings.zIndexes[e.type],d);Va(e.marker,h)}if(n){var p,v=t(n),y=v.hideRoute,g=void 0!==y&&y,m=v.dehighlight,b=void 0!==m&&m,k=v.removeAriaLive,w=void 0!==k&&k;g&&(null===(p=this.routes)||void 0===p||p.hideRoutes(n)),b&&this._dehighlightFeature(n),w&&this._updateAriaLiveOnFeature(n,!1)}if((e||n)&&r){var C,P=this.fillPopupExternally.bind(this,e);if(e?C={action:"select",feature:e.toData(),setPopupContent:P,previousSelectedFeature:null==n?void 0:n.toData()}:n&&(C={action:"clearSelection",feature:n.toData(),setPopupContent:P}),this.keyboardFeatures){var L=this.keyboardFeatures;setTimeout((function(){return L.updateKeyboardFeatures()}),50)}C&&this.eventsManager.pushEvent(ti.selectionChanged,C)}}}},{key:"_zoomToExtent",value:function(e){var t=this;if(e&&e.length>0){var r=e.map((function(e){return e.properties.latLng}));this.boundsContai!1).then((function(){return t.handleBoundsChanged("clusterExtent")}))}))}}},{key:"handleMarkerMouseOver",value:function(e,t,r){var n=this,i=e;if(!i&&"popup"===t&&this.popup&&(i=this.popup.feature),i&&i.visible&&i.type){var o=this.asKey(i),a=this.mapData.featuresOver.has(o);this.mapData.featuresOver.set(o,t),a||ws(this.settings.actionsOnMarkerMouseOver[i.type],i.hashKeys).forEach((function(e){switch(e){case"highlight":n._setHighlightedFeature(i);break;case"openPopup":n._openPopup(i);break;case"sendEvent":var t={action:"mouseEnter",feature:i.toData(),setPopupContent:n.fillPopupExternally.bind(n,i)};n.eventsManager.pushEvent(ti.hoverChanged,t)}}))}}},{key:"handleMarkerMouseOut",value:function(e,t,r){var n=this,i=e;if(!i&&"popup"===t&&this.popup&&(i=this.popup.feature),i&&i.visible){var o=this.asKey(i);this.mapData.featuresOver.get(o)===t&&(this.mapData.featuresOver.delete(o),ws(this.settings.actionsOnMarkerMouseOut[i.type],i.hashKeys).forEach((function(e){switch(e){case"dehighlight":n._dehighlightFeature(i);break;case"dehighlightIfNotSelected":n.isFeatureSelected(i)||n._dehighlightFeature(i);break;case"sendEvent":var t={action:"mouseLeave",feature:i.toData(),setPopupContent:n.fillPopupExternally.bind(n,i)};n.eventsManager.pushEvent(ti.hoverChanged,t);break;case"closePopup":n._closePopup()}})))}}},{key:"handleDragStart",value:function(){var e=this;this.settings.actionsOnMapDrag.includes("removeAriaLive")&&this._updateAriaLiveOnFeature(this._getFeatureSelected(),!1),this.settings.actionsOnMapDrag.forEach((function(t){var r;switch(t){case"clearHighlight":e._dehighlightFeatures();break;case"clearSelection":e.setSelectedFeature(void 0,e._actionOnPreviousMarker(e.settings.actionsOnMarkerClick),!0);break;case"closePopup":e._closePopup();break;case"hideRoutes":null===(r=e.routes)||void 0===r||r.hideRoutes()}}))}},{key:"selectFeature",value:function(e,t,r){var n=this,i=this._findFeature(e,t);if(i&&!this.isFeatureSelected(i)){var o=ws(this.settings.actionsOnFeatureSelect[i.type],i.hashKeys);this.setSelectedFeature(i,this._actionOnPreviousMarker(this.settings.actionsOnFeatureSelect),!1),r&&this.setPopupContent(i.id,i.type,r),o.includes("addAriaLive")&&this._updateAriaLiveOnFeature(i,!0),o.forEach((function(e){var t;switch(e){case"highlight":n._setHighlightedFeature(i);break;case"openPopup":n._openPopup(i);break;case"closePopup":n._closePopup();break;case"showRoutes":null===(t=n.routes)||void 0===t||t.showRoutes(i);break;case"showLinkedFeatures":n.loadFeatureContent(i.id,i.type)}})),o.includes("bounce")&&Ua(i.marker)}}},{key:"registerRouteDestination",value:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return null===(e=this.routes)||void 0===e?void 0:e.registerRouteDestination.apply(e,r)}},{key:"registerRoute",value:function(e,t,r){var n;return!0===(null===(n=this.routes)||void 0===n?void 0:n.registerRoute(e,t,r))}},{key:"listRegisteredRouteDestinations",value:function(){var e;return(null===(e=this.routes)||void 0===e?void 0:e.listRegisteredRouteDestinations())||[]}},{key:"listRegisteredRoutes",value:function(e){var t;return(null===(t=this.routes)||void 0===t?void 0:t.listRegisteredRoutes(e))||[]}},{key:"deregisterRouteDestination",value:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(null===(e=this.routes)||void 0===e?void 0:e.deregisterRouteDestination.apply(e,r))||[]}},{key:"deregisterRoute",value:function(e,t){var r;return(null===(r=this.routes)||void 0===r?void 0:r.deregisterRoute(e,t))||[]}},{key:"showRoutes",value:function(e,t){if(!this.routes)return Promise.reject(new Error("map is not initialized"));var r=this._findFeature(e,t);if(r){for(var n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];return this.routes.showRoutes(r,i,!1)}return Promise.reject(new Error("feature ".concat(t,"-").concat(e," is not found")))}},{key:"addQualifierToFeature",value:function(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];return this._updateQualifierFromFeatures.apply(this,[[{id:e,type:t}],function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.addQualifier.apply(e,r)}].concat(n))}},{key:"addQualifierToFeatures",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return this._updateQualifierFromFeatures.apply(this,[e,function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.addQualifier.apply(e,r)}].concat(r))}},{key:"removeQualifierFromFeature",value:function(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];return this._updateQualifierFromFeatures.apply(this,[[{id:e,type:t}],function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.removeQualifier.apply(e,r)}].concat(n))}},{key:"removeQualifierFromFeatures",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]==1;n<t;n++)r[n-1]=arguments[n];return e.removeQualifier.apply(e,r)}].concat(r))}},{key:"_updateQualifierFromFeatures",value:function(e,t){for(var r=this,n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];var a=!1;return e.forEach((function(e){var n=e.id,o=e.type,s=r._findFeature(n,o);s&&t.apply(void 0,[s].concat(i))&&(r._fixMarkerToUse(s),a=!0)})),a?this._updateViewport().then((function(){return!0})):Promise.resolve(!1)}},{key:"loadFeatureContent",value:function(e,t){var r,n=this,i=null===(r=this.contentProvider)||void 0===r?void 0:r.getFeatureProviders()[t];if(i){var o=[];return Object.keys(i).forEach((function(r){var a=new Promise((function(o,a){i[r].loadFeatureContent(e,t).then((function(r){var i=r.linkedFeatures,a=n.features.allExceptClusters().filter((functionme((function(e){return-1!==e.toSlter((function(e){return!a.find((function(t){return e.id===t.id}))}));null==s||s.forEach((functionlter((function(e){return a.find((function(t){return t.id===e.id}))}));null==u||u.forEach((function(r){r.qualifiers.includes("linked-features-".concat(e,"-").concat(t))||r.qualifiers.pushch((function(e){return n.fegHelper)})),n.features.all().filter((functiram("markers,place,show,linked-features-".concat(e,"-").concat(t))})),n.configHelper.writeParam("markers,place,show,linked-features-".concat(e,"-").concat(t),!0),n._updateViewport().then((function(){var i={success:!0,id:e,type:t,content:r};n.eventsManager.pushEvent(ti.featureContentLoaded,i),o(void 0)}))})).catch((function(e){var t={success:!1,error:e};n.eventsManager.pushEvent(ti.featureContentLoaded,t),a(e)}))}));o.push(a)})),zr(o)}return Promise.reject(new Error("content provider is not enabled"))}},{key:"hideRoutes",value:function(e,t){if(!this.routes)return Promise.reject(new Error("map is not initialized"));var r=this._findFeature(e,t);if(r){for(var n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];return this.routes.hideRoutes(r,i,!1)}return Promise.reject(new Error("feature ".concat(t,===(e=this.routes)||void 0===e?void 0:e.listRoutesDisplayed())||[]}},{key:"handleTilesLoaded",value:function(e,t,r){this.logger.debug("".concat(e," tiles loaded - ").concat(t," - ").concat(r));var n={origin:e,contentType:t,tileIds:r};this.eventsManager.:function(e){this.eventsManager.pushEvent(ti.tilesContentLoaded,e)}},{key:"addCopyright",value:function(e,t){var r=ze(this.copyrightsDiv),n=hs(this.copyrights.entries()).filter((function(e){var r=ds(e,2);return r[0],r[1].content===t}));if(n.length>0)n[0][1].ownerIds.push(e);else{var i=Yt(),o=this.uniqId("copyright-div-".concat(i));this.copyrights.set(o,{content:t,ownerIds:[e]}),Ce(void 0,ge(o,this.copyrightsDiv,"copyright"),"copyright-text",void 0,t),r||Ue(this.copyrightsDiv)}}},{key:"removeCopyrightForOwner",value:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];r.forEach((function(t){hs(e.copyrights.entries()).forEach((function(r){var n=ds(r,2),i=n[0],o=n[1].ownerIds,a=o.findIndex((function(e){return e===t}));a>=0&&(o.splice(a,1),0==o.length&&(he(e.copyrightsDiv,i),e.copyrights.delete(i)))}))}))}},{key:"clearSelectedFeature",value:function(){var e=this,t=this._getFeatureSelected();if(t){this.setSelectedFeature(void 0,this._actionOnPreviousMarker(this.settings.actionsOnFeatureSelect),!1);var r=ws(this.settings.actionsOnFeatureDeselect[t.type],t.hashKeys);if(r.includes("removeAriaLive")&&this._updateAriaLiveOnFeature(t,!1),r.forEach((function(r){var n;switch(r){case"dehighlight":e._dehighlightFeature(t);break;case"closePopup":e._closePopup();break;case"hideRoutes":null===(n=e.routes)||void 0===n||n.hideRoutes(t)}})),this.keyboardFeatures){var n=this.keyboardFeatures;setTimeout((function(){return n.updateKeyboardFeatures()}),50)}}}},{key:"markFeatureOver",value:function(e,t){var r=this,n=this._findFeature(e,t);n&&ws(this.settings.actionsOnFeatureOver[n.type],n.hashKeys).forEach((function(e){switch(e){case"highlight":r._setHighlightedFeature(n);break;case"openPopup":r._openPopup(n)}}))}},{key:"markFeatureOut",value:function(e,t){var r=this,n=this._findFeature(e,t);n&&ws(this.settings.actionsOnFeatureOut[n.type],n.hashKeys).forEach((function(e){switch(e){case"dehighlight":r._dehighlightFeature(n);break;case"dehighlightIfNotSelected":r.isFeatureSelected(n)||r._dehighlightFeature(n);break;arker",value:function(e,t){e.highlighted=t,this._fixMarkerToUse(e)}},{key:"_setHighlightedFeature",value:function(e){if(!this._isFeatureHighlighted(e)){var t=e.id,r=e.type;this.mapData.highlightedFeatures.push({id:t,type:r}),this.highlightMarker(e,!0)}}},{key:"_dehighlightFeature",value:function(e){var t=this._getFeatureHighlightIndex(e);t>=0&&(this.mapData.highlightedFeatures.splice(t,1),this.highlightMarker(e,!1))}},{key:"_getFeatureHighlightIndex",value:function(e){varres.findIndex((function(e){var n=e.id,ited",value:function(e){return this._getFeatureHighlightIndex(e)>=0}},{key:"_dehighlightFeatures",value:function(){var e=this;this.mapData.highlightedFeatures.forEach((function(t){var r=t.id,n=t.type,i=e._findFeature(r,n);i&&e.highlightMarker(i,!1)})),this.mapData.highlightedFeatures=[]}},{key:"turnFeaturesVisible",value:function(e,t,r,n,i){var o;null===(o=this.filterManager)||void 0===o||o.turnFeaturesVisible(e,t,r,n,i)}},{key:"_createGenericPopup",value:function(e){var t=this,r=ge(this.uniqId("popup"),e,"popup","visibility:false"),n=ge(void 0,r,"popup-close-button close-button");ge(void 0,n,"leftright"),ge(void 0,n,"rightleft"),ge(void 0,n,"close");var i=this._closePopup.bind(this);r.content=ge(void 0,r,"popup-content");var o=this.updatePopupPositionOnLayer.bind(this);return new ResizeObserver(o).observe(r.content),r.clean=[this.addEventListener(n,Ps.click,(function(e){var r;e.stopPropagation(),null!==(r=t.popup)&&void 0!==r&&r.feature&&t.mapData.featuresOver.delete(t.asKey(t.popup.feature)),i()}))],r.visibleElement=void 0,r.cssElement=void 0,r}},{key:"_createHtmlClusterMarker",value:function(e,t,r,n,i,o){var a=ge(this.uniqId("marker-".concat(n,"-cluster-").concat(t.id)),e,"cluster-marker cluster-".concat(n,"-marker ").concat(null==i?void 0:i.split("#").join(" ")),"position:absolute;visibility:false;".concat(o||"")),s=Ce(void 0,a,"cluster-label");return Ce(void 0,s,"cluster-label-content",void 0,this._createClusterLabel(t,r)),a.cssElement=a,{main:a,span:s}}},{key:"_createClusterLabel",value:function(e,t){if(void 0!==e.minPrice&&-1!==this.configHelper.getI18N(t,e.children.length).indexOf("{1}")){var r=this.settings,n=r.iso4217CurrencyCode,i=r.locale,o=vr(e.minPrice,void 0,n,i);return this.configHelper.getI18N(t,e.children.length,o)}return this.configHelper.getI18N(t,e.children.length)}},{key:"_createClusterMarker",value:function(e,t,r,n,i,o){var a=this._createHtmlClusterMarker(e,t,r,n,i,o),s=a.main,u=a.span;return s.bounceElement=u,s.cssElement=s,s}},{key:"_clearClusters",value:function(e){var t=this;this.features.allClusters().filter((function(t){var r;return null===(r=t.marker)||void 0===r?void 0:r.cssElement.classList.contains("cluster-".concat(e,"-marker"))})).forEach((function(e){t._deleteFeatureMarker(e),t.features.delete(e.id,e.type)}))}},{key:"_pushClusterData",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=fs(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;r?this.features.upsertUserData(i,this.configHelper):this.features.upsertTileData(i,this.configHelper)}}catch(e){n.e(e)}finally{n.f()}}},{key:"_updateViewport",value:function(e){var t,r=this.configHelper.visibilityBooleanByStatus(),n=e;return n||(n=this.nativeBounds()),null!==(t=this.availabilityCheck)&&void 0!==t&&t.isAvailabilityCheckActive()?this._updateViewportWithAvailabilityCheck(r,n):this._updateViewportAux(r,n)}},{key:"_updateViewportAux",value:function(e,t){var r=this;this.boundsToRefresh=this.asBounds(t);var n=[];return n.push(new Promise((function(n){r.changeProductMarkersVisible(t,e.product),n(void 0)}))),n.push(new Promise((function(n){r.changePropertyMarkersVisible(t,e.property),n(void 0)}))),n.push(new Promise((function(n){r.changePlaceMarkersVisible(t,e.place),n(void 0)}))),Promise.all(n).then((function(){var e=r.getBounds();return e&&r.boundsT=r.keyboardFeatures)||void 0===e?void 0:e.updateKeyboardFeatures()}),100),r.collisionManagement&&r.collisionManagement.handleMarkerLabelCollision(r.features.all())),t}))}},{key:"_updateViewportWithAvailabilityCheck",value:function(e,t){var r=this;this.boundsToRefresh=this.asBounds(t);var n=[];n.push(this._updateViewportAux(e,t));var i=this.features.allProducts().filter((function(e){return r.isFeatureInRealBound(t,e)}));n.push(this.updateProductsAvailability(i).then((function(){var n=r.getBounds();if(n&&r.boundsToRefresh&&Kt(n,r.boundsToRefresh))return r.changeProductMarkersVisible(t,e.product),Promise.resolve()})).catch((function(e){r.logger.error("Failed to update availabilities: ".concat(e.message),e.stack)})));var o=this.features.allProperties().filter((function(e){return r.isFeatureInRealBound(t,e)}));return n.push(this.updatePropertiesAvailability(o).then((function(){var n=r.getBounds();if(n&&r.boundsToRefresh&&Kt(n,r.boundsToRefresh))return r.changePropertyMarkersVisible(t,e.property),Promise.resolve()})).catch((function(e){r.logger.error("Failed to update availabilities: ".concat(e.message),e.stack)}))),Promise.all(n).then((function(){var e=r.getBounds();return r.keyboardFeatures&&e&&r.boundsToRefresh&&Kt(e,r.boundsToRefresh)&&r.keyboardFeatures.updateKeyboardFeatures(),t}))}},{key:"_changeClusterMarkerVisibility",value:function(e,t,r,n){var i=this,o=this.getBounds(),a={clusters:[],remainingFeatures:t};this._clearClusters(e),this.clusterers&&this.clusterers[e].forEach((function(t){var n=t.clusterer,s=t.qualifier;if(n){try{var u,l,c,f,d={clientWidth:null!==(u=null===(l=i.node)||void 0===l?void 0:l.clientWidth)&&void 0!==u?u:0,clientHeight:null!==(c=null===(f=i.node)||void 0===f?void 0:f.clientHeight)&&void 0!==c?c:0};a=n.getClustersAndFeatures(a,e,s,o,r,d,i.getTileDim())}catch(e){i.logger.warn("Failed to compute cluster: ".concat(e.message),e.stack)}i._pushClusterData(a.clusters.map((function(e){return e.cluster})),!1)}})),aeatures.allClusters().find((function(t){return t.id===e.cluster.id}));t&&!t.marker&&(t.marker=i.createClusterMarkerWithClickListener(t,e.labelKey,e.featureType,e.qualifier))}));var s,u=a.remainingFeatures.map((function(e){return e.id})),l=fs(t);try{for(l.s();!(s=l.n()).done;){var c=s.value;u.includes(c.id)&&(n.push(c.id),c.marker?c.visible=!0:this._makeMarkerVisible(c,!0))}}catch(e){l.e(e)}finally{l.f()}}},{key:"_haveSomeClustersByFeatureType",value:function(e){return void 0!==this.clusterers&&void 0!==this.clusterers[e]&&this.clusterers[e].length>0}},{key:"_changeMarkersVisibility",value:function(e,t,r){var n,i=this,o=this.getZoom();switch(r){case Jo:n=this._updateProductsInBounds(e,t,o);break;case ea:n=this._updatePropertiesInBounds(e,t,o);break;case ta:n=this._updatePlacesInBounds(e,t,o);break;default:n={oldInBounds:[],inBounds:[]}}var a=n,s=a.oldInBounds,u=a.inBounds,l=[];this._haveSomeClustersByFeatureType(r)?this._changeClusterMarkerVisibility(r,u,o,l):u.forEach((function(e){l.push(e.id),e.marker?e.visible=!0:i._makeMarkerVisiblees(e.id)})).forEach((function(e){return i._makeMarkerVisible(e,!1)}))}},{key:"changeProductMarkersVisible",value:function(e,t){this._changeMarkersVisibility(e,t,Jo)}},{key:"changePropertyMarkersVisible",value:function(e,t){this._changVisible",value:function(e,t){this._changeMarkersVisibility(e,t,ta)}},{key:"_shouldFeatureBeDisplayed",value:function(e,t,r,n){var i,o=null===(i=e.tileData)||void 0===i?void 0:i.tile,a=o&&o.length>=3?o[2]:void 0;return(void 0===a||e.hasUserData()||a<=n)&&this.isFeatureInRealBound(t,e)&&ws(this.settings.minZoomForDisplay[e.type],e.hashKeys)<=n&&!1!==ws(r,[e.status])&&ws(r,e.hashKeys)}},{key:"_retrieveCandidates",value:function(e,t,r,n,i){for(var o=e.length,a=0;a<o;){var s=e[a];a++,this._shouldFeatureBeDisplayed(s,t,r,n)&&i(s)}}},{key:"_updateProductsInBounds",value:function(e,t,r){var n=hs(this.mapData.inBounds.product),i=[],o=[],a=[],s=[],u={available:i,filtered:o,sold_out:a,unknown:s};this._retrieveCandidates(this.features.allProducts(),e,t,r,(function(e){return u[e.status].push(e)}));var l=this.settings.threshold.product.default;return r>=this.settings.maxZoomForCount.product.default||i.length+o.length+a.length+s.length<=l?this.mapData.inBounds.product=i.concat(o.concat(a.concat(s))):i.length+o.length+a.length<=l?this.mapData.inBounds.product=i.concat(o.concat(a)):i.length+o.length<=l?this.mapData.inBounds.product=i.concat(o):i.length<=l?this.mapData.inBounds.product=i:this.mapData.inBounds.product=[],{oldInBounds:n,inBounds:this.mapData.inBounds.product}}},{key:"_updatePropertiesInBounds",value:function(e,t,r){var n=hs(this.mapData.inBounds.property),i=[],o=[],a=[],s=[],u={available:i,filtered:o,sold_out:a,unknoures.allProperties(),e,t,r,(function(e){return u[e.status].push(e)}));var l=this.settings.threshold.property.default;return r>=this.settings.maxZoomForCount.property.default||i.length+o.length+a.length+s.length<=l?this.mapData.inBounds.property=i.concat(o.concat(a.concat(s))):i.length+o.length+a.length<=l?this.mapData.inBounds.property=i.concat(o.concat(a)):i.length+o.length<=l?this.mapData.inBounds.property=i.concat(o):i.length<=l?this.mapData.inBounds.property=i:this.mapData.inBounds.property=[],{oldInBounds:n,inBounds:this.mapData.inBounds.property}}},{key:"_updatePlacesInBounds",value:function(e,t,r){var n=hs(this.mapData.inBounds.place),i={selected:{threshold:1,maxZoomForCount:1,data:[]}};for(var o in this.settings.threshold.place){var a=ws(this.settings.maxZoomForCount.place,[o]);i[o]={threshold:this.settings.threshold.place[o],maxZoomForCount:a,data:[]}}this._retrieveCandidates(this.features.allPlaces(),e,t,r,(function(e){return ws(i,e.hashKeys).data.push(e)}));var s=[];for(var u in i){var l=i[u],c=l.threshold,f=l.maxZoomForCount,d=l.data;d.length>0&&(r>=f||d.length<=c)&&(s=s.concat(d))}return this.mapData.inBounds.place=s,{oldInBounds:n,inBounds:this.mapData.inBounds.place}}},{key:"updateCon){this.features.all().forEach((on(){this.features.all().forEach((function(e){e.clearHashkeys()}))}},{key:"cleion(t){t.marker&&(e.removeMarkerFromMap(t.marker),delete t.marker)}))}},{key:"listFeatures",value:function(e,t){return this._listFeatures(e,t).map((function(e){return e.toData()}))}},{key:"_listFeatures",value:function(e,t){var r=this,n=this.features.all();if(t){var i=this.asNativeBounds(t.sw,t.ne);n=n.filter((function(e){return void 0!==e})).filter((function(e){return r.isFeatureInRealBound(i,e)}))}return e&&(n=n.filter(e)),n}},{key:"pushFeatureData",value:function(e,t,r){var n=this;this.logger.debug("push feature data");var i=[],o=[],a=[],s=[];this._pushFeatureDataModifyFeatures(e,i,a,o);var u=o.concat(i);switch(t){case"merge":if(a.length===e.length)return;break;case"replace":ExceptClusters().filter((function(e){return!l.includes(n.asKey(e))}));s=this._removePushedFeatureDataAux(c,!1);break;default:throw new Error("action ".concat(t," not supported"))}if(r&&this._pushFeatureDataHandleEvents(u,s),this.mapData.selectedFeature&&s.map(this.asKey).includes(this.asKey(this.mapData.selectedFeature))&&this.clearSelectedFeature(),u.length>0||s.length>0)return this._updateViewport(),this._computeStrictBounds(u.concat(a).map((function(e){return e.latLng})))}},{key:"_pushFeatureDataModifyFeatures",value:function(e,t,r,n){var i,o=fs(e);try{for(o.s();!(i=o.n()).done;){var a=i.value,s=this.features.repository(a.type).find(a.id);if(s)if(s.isUserDataChanged(a)){var u=this.features.upsertUserData(a,this.configHelper);this._fixMarkerToUse(u),t.push(u)}else r.push(s);else{var l=this.features.upsertUserData(a,this.configHelper);this._fixMarkerToUse(l),n.push(l)}}}catch(e){o.e(e)}finally{o.f()}}},{key:"updatePartiallyFeature",value:function(e){var t=this,r=[],n=e.flatMap((function(e){e.id,e.type;var n=cs(e,as),i=t.features.repository(e.type).find(e.id);return i?us(us({},i.toData()),n):(r.push(e),[])}));return this.pushFeatureData(n,"merge",!1),r}},{key:"_pushFeatureDataHandleEvents",value:function(e,t){var r=[];if(e.length>0){var n=this._computeStrictBounds(e.map((function(e){return e.latLng})));r.push({type:"addedOrUpdated",features:e.map((function(e){return e.toData()})),bounds:n})}if(t.length>0){var i=this._computeStrictBounds(t.map((function(e){return[e.lat,e.lng]})));r.push({type:"removed",features:t,bounds:i})}if(r.length>0){var o={changes:r};this.eventsManager.pushEvent(ti.markersChanged,o)}}},{key:"removePushedFeatureData",value:function(e){var t,r,n=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.logger.debug("removing pushed feature data"),this.logger.debug(e),void 0!==e){var o=e.map((function(e){var t=e.id,r=e.type;return n.features.repository(r).find(t)})).filter((function(e){return void 0!==e}));r=this._removePushedFeatureDataAux(o,i)}else{var a=this.features.allExceptClusters();r=this._removePushedFeatureDataAux(a,i)}return(null===(t=r)||void 0===t?void 0:t.lengpdateViewport(),r}},{key:"onMarkerIconsChanged",value:function(e){}},{key:"_fixMarkerToUse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u,r=t.identifyMarkerProperties(e,this.settings),n=r.icons,i=r.zIndex,o=r.cssClasses,a=e.marker,s=e.ariaLabels,l=null==n?void 0:n.pin,c=this.onMarkerIconsChanged.bind(this),f=this.addEventListener.bind(this);this._shouldRecreateMarker(e,r)?this.switchMarktMarkerIcons(e,n,f,this.logger).then((function(t){return t&&c(e),t})),tt(a.cssElement,o.toRemove,o.toAdd),t.switchAriaLabel(e.highlighted,a.ariaElement,s),a.cssClasses=o.toAdd,Va(a,i),Ra(e,this.settings))}},{key:"_shouldRecreateMarker",value:function(e,t){var r,n,i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u,a=e.markerType,s=e.marker,l=t.icons,c=void 0===l?{}:l,f=t.markerType,d=t.label,h=t.frameIcon,p=c.pin,v=c.cornerIcons,y=void 0===v?{}:v,g=c.innerIcons,m=void 0===g?{}:g,b=null==s||null===(r=s.iconElements)||void 0===r||null===(r=r.pin)||void 0===r?void 0:r.hashCode;return f!==a||o.haveCornerIconsChanged((null==s||null===(n=s.iconElements)||void 0===n?void 0:n.cornerIcons)||{},y)||o.haveInnerIconsChanged((null==s||null===(i=s.iconElements)||void 0===i?void 0:i.innerIcons)||{},m)||("price"===f||"text"===f||"priceObfuscate"===f)&&d!==(null==s?void 0:s.label)||("pin"===f||"pinObfuscate"===f)&&h!==(null==s?void 0:s.frameIcon)||b&&(!Y(p)||b!==pr(J(p)||""))||void 0===b&&Y(p)||this._hasObfuscateMarker(e)&&this.hasObfuscateAreaStyleChanged(e)}},{key:"_hasObfuscateMarker",value:function(e){var t=null==e?void 0:e.markerType;if(t)return"obfuscate"===t||"pinObfuscate"===t||"priceObfuscate"===t}},{key:"_remove(e,t){var r,n=[],i=fs(e.filter((function(e){return e.hasUserData()})));try{for(i.s();!(r=i.n()).done;){var o=r.value;this.popup&&this.popup.feature&&this.popup.feature.id===o.id&&this._closePopup(),o.marker&&this.removeMarkerFromMap(o.marker),this.isFeatureSelected(o)&&this.clearSelectedFeature(),n.push(o.toData()),o.removeUserData()}}catch(e){i.e(e)}finally{i.f()}if(n.length>0&&t){var a=this._computeStrictBounds(n.map((function(e){return e.latLng}))),s={changes:[{type:"removed",features:n,bounds:a}]};this.eventsManager.pushErn this.features.insertTileDataWeFeature",value:function(e){return this.features.deleteTileData(e)}},{key:"_makeMarkerVisible",value:function(e,t){e.visible=t,t?this._createMarker(e):e.marker&&this._deleteFeatureMarker(e)}},{key:"_createMarker",value:function(e,t){var r=t;r||(r=Ba(e,this.settings));var n,i=r,o=i.markerType,a=i.icons,s=i.frameIcon,u=i.cssClasses,l=i.zIndex,c=i.textContent,f=void 0===c?"?":c,d=i.label,h=i.subLabel,p=a||{},v=p.pin,y=p.cornerIcons,g=p.innerIcons,m=e.ariaLabels;this.clearObfuscateArea(e);var b={feature:e,cssClasses:u.toAdd,zIndex:l,label:d,subLabel:h,ariaLabels:m},k=us(us({},b),{},{cornerIcons:y,innerIcons:g});switch(o){case"price":n=this.createTextMarkerWithClickListener(k,f,"price");break;case"text":n=this.createTextMarkerWithClickListener(k,f,"text");break;case"pin":"none"===s&&(k.innerIcons=void 0),n=this.createPinMarkerWithClickListener(k,v,s);break;case"obfuscate":n=this.createObfuscateMarkerWithClickListener(b);break;case"pinObfuscate":"none"===s&&(k.innerIcons=void 0),n=this.createPinObfuscateMarkerWithClickListener(k,v,s);break;case"priceObfuscate":n=this.createPriceObfuscateMarkerWithClickListener(k,f);break;default:throw new Error("marker type not supported: ".concat(o))}e.markerType=o,e.marker=n,e.marker.cssClasses=u.toAdd}},{key:"_deleteFeatureMarker",value:function(e){this.clearObfuscateArea(e),this.removeMarkerFromMap(e.marker),delete e.marker}},{key:"switchMarkerType",value:function(e,t){return e.marker&&this._deleteFeatureMarker(e),e.markerType=t.markerType,!!e.visible&&(der to use it.");this.keyboardFeatures.turnKeyboardFeaturesMode(e)}},{key:"isKeyboardFeaturesModeEnabled",value:function(){var e;return!!this.keyboardFeatures&&(null===(e=this.keyboardFeatures)||void 0===e?void 0:e.isKeyboardFeaturesModeEnabled())}},{key:"_zIndexAdjustment",value:function(e){return e}}],r&&ys(t.prototype,r),n&&ys(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,(r=[{key:"init",value:function(e,t){return Promise.reject(new Error("method init not implemented"))}},{key:"clearObfuscateArea",value:function(e){throw new Error("method clearObfuscateArea not implemented")}},{key:"createPinMarkerWithClickListener",value:function(e,t,r){throw new Error("method createPinMarkerWithClickListener not implemented")}},{key:"createTextMarkerWithClickListener",value:function(e,t,r){throw new Error("method createTextMarkerWithClickListener not implemented")}},{key:"createObfuscateMarkerWithClickListener",value:function(e){throw new Error("method createObfuscateMarkerWithClickListener not implemented")}},{key:"createPriceObfuscateMarkerWithClickListener",value:function(e,t){throw new Error("method createPriceObfuscateMarkerWithClickListener not implemented")}},{key:"createPinObfuscateMarkerWithClickListener",value:function(e,t,r){throw new Error("method createPinObfuscateMarkerWithClickListener not implemented")}},{key:"hasObfuscateAreaStyleChanged",value:function(e){throw new Error("method _hasObfuscateAreaStyleChanged noror("method createClusterMarkerWithClickListener not implemented")}},{key:"removeMarkerFromMap",value:function(e){throw new Error("method removeMarkerFromMap not implemented")}},{key:"cloneMarker",value:function(e){throw new Error("method cloneMarker not implemented")}},{key:"updatePopupPositionOnLayer",value:function(){throw new Error("method updatePopupPositionOnLayer not implemented")}},{key:"ensurePopupVisibility",value:function(){throw new Error("method ensurePopupVisibility not implemented")}},{key:"getMarkerComponent",value:function(e){throw new Error("method getMarkerComponent not implemented")}},{key:"moveMarkerPosition",value:function(e,t){throw new Error("method moveMarkerPosition not implemented")}},{key:"getRectOfMarker",value:function(e){throw new Errorion(e,t){return Promise.reject("method fitBounds not implemented")}},{key:"nativeBounds",value:function(){throw new Error("method nativeBounds not implemented")}},{key:"asNativeBounds",value:function(e,t){throw new Error("method asNativeBounds not implemented")}},{key:"computeNativeBoundsFromLatLongs",value:function(e){throw new Error("method computeNativeBoundsFromLatLongs not implemented")}},{key:"asBounds",value:function(e){throw new Error("method asBounds not implemented")}},{key:"containerBounds",value:function(e){throw new Error("method containerBounds not implemented")}},{key:"fitLatLongs",value:function(e){return Promise.reject("method fitLatLongs not implemented")}},{key:"getZoom",value:function(){throw new Error("method getZoom not implemented")}},{key:"getCenter",value:function(){throw new Error("method getCenter not implemented")}},{key:"isFeatureInRealBound",value:function(e,t){throw new Error("method isFeatureInRealBound not implemented")}},{key:"centerAndZoomMap",value:function(e,t,r){throw new Error("method(e,t,r){throw new Error("met Promise.reject(new Error("methomise.reject(new Error("method removeRouteOnMap  Error("method registerListenerOnMapFocusElement not implemented")}},{key:"unbindAll",value:function(){throw new Error("method unbindAll not implemented")}},{key:"getTileDim",value:function(){throw new Error("method getTileDim not implemented")}},{key:"resetRouteStyle",value:function(){throw new Error("method resetRouteStyle not implemented")}},{key:"updateMapProviderConfig",value:function(){throw new Error("method updateMapProviderConfig not implemented")}}])&&ns(t.prototype,r),n&&ns(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}());function Ms(e){return Ms="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ms(e)}function Fs(e){return function(e){if(Array.isArray(e))return Ss(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Os(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||Os(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Os(e,t){if(e){if("string"==typeof e)return Ss(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ss(e,t):void 0}}function Ss(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Es(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Is(n.key),n)}}function Is(e){var t=function(e,t){if("object"!==Ms(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==Ms(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Ms(t)?t:String(t)}function As(){return As="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=js(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},As.apply(this,arguments)}function Ts(e,t){return Ts=Object.setPrototypeOf?Object.s hasn't been initialised - super() hasn't been called");return e}function js(e){return js=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},js(e)}var Rs=At,Ns=Bt,Vs="markers",Us="default",zs="undefined"!=typeof google?google.maps.Marker.MAX_ZINDEX:0;function Ks(e){var t={};return Object.keys(e).forEach((function(r){t[r]="markers"===r?Hs(e[r],{}):e[r]})),t}function Hs(e,t){var r=/^unavailable#/,n=/#unavailable$/,i=/#unavailable#/;return Object.keys(e).forEach((function(o){var a=o;"unavailable"===o?a="sold_out":r.test(o)?a=o.replace(r,"sold_out#"):n.test(o)?a=o.replace(n,"#sold_out"):i.test(o)&&(a=o.replace(i,"#sold_out#"));var s=e[o];Rs(s)&&!Y(s)?t[a]=Hs(s,{}):t[a]=s})),t}var Zs=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ts(e,t)}(o,e);var t,r,n,i=Bs(o);function o(e,t,r,n){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(a=i.call(this,e,t?Ks(t):t,n))._loadLocale(e),a.i18n=new on(r,a.locale,{readParam:a.readParam.bind(Ds(a)),writeParam:a.writeParam.bind(Ds(a))}),a.qualifiersAndHashkeysUsed={},a}return t=o,r=[{key:"ready",value:function(){(this).then((function(){return e.loadQualifiersAndHashkeysUsed(),e}))}},{key:"getEGMapConfigurations",value:function(){var e=this.getConfigurations();return{default:e.default,external:e.external,overwrite:e.overwrite,parameter:e.parameter,final:this.subConfig()}}},{key:"loadHashkeysUsed[t]=e._identifyQualifiersAndHashKeysUsedInHashkeys(t)}))}},{key:"_loadLocale",value:function(e){this.locale=null==e?void 0:e.locale;var t=this.readParam("locale");if(t){var r=_s(/^([a-z]{2})((-|_)([A-Z]{2}))?$/.exec(t)||[],5),n=r[1],i=r[4];n&&(this.locale=i?"".concat(n,"-").concat(i):n)}}},{key:"mapProvider",value:function(){return this.readParam("mapProvider")}},{key:"ge-1]=arguments[i];return(t=this.i18n).format.apply(t,[e].concat(n))}},{key:"filterQualifiersUsed",value:function(e,t){var r=this.qualifiersAndHashkeysUsed[e].qualifiers;return t.filter((function(e){return r.includes(e)}))}},{key:"filterHashkeysUsed",value:function(e,t){var r=this.qualifiersAndHashkeysUsed[e].hashkeys;return t.filter((function(e){return r.includes(e)}))}},{key:"_identifyQualifiersAndHashKeysUsedInHashkeys",value:function(e){var t=this,r=new Set,n=new Set;return n.add("default"),this._identifyAllHashkeys(e).forEach((function(i){n.add(i),i.split("#").forEach((function(n){t.getFeatureStatus(e).includesshkeys:Fs(n).map((function(e){return e.split("#").sort().join("#")}))}}},{key:"_identifyAllHashkeys",value:function(e){var t=this.listStringKeys("markers,".concat(e)),r=new Set,n=new Set;t.forEach((function(e){if(e.endsWith(Us))n.add(e.substring(0,e.length-7-1));else{var t=e.indexOf(",".concat(Us,","));t>0?n.add(e.substring(0,t)):r.add(e)}}));var i=new Set;return r.forEach((function(e){n.forEach((function(t){e.startsWith(t)&&i.add(e.substring(t.length+1).split(",")[0])}))})),Fs(i)}},{key:"mapboxAccessToken",value:function(){return this.readParam("mapbox,accessToken")}},{key:"getFeatureTypes",value:function(){return ia}},{key:"getFeatureStatus",value:function(e){switch(e){case Jo:return aa;case ea:return sa;case ta:case ra:return[oa];default:throw new Error("Type unknown: ".concat(e))}}},{key:"iso4217CurrencyCode",value:function(){return this.readParam("iso4217CurrencyCode")}},{key:"icons",value:function(){return this.propertyValues(Vs,"icons",ia)}},{key:"frameIcons",value:function(){return this.propertyValues(Vs,"frameIcons",ia)}},{key:"cornerIcons",value:function(){return{"top-left":this.propertyValues(Vs,"cornerIcons,topLeft",ia),"top-right":this.propertyValues(Vs,"cornerIcons,topRight",ia),"bottom-left":this.propertyValues(Vs,"cornerIcons,bottomLeft",ia),"bottom-right":this.propertyValues(Vs,"cornerIcons,bottomRight",ia)}}},{key:"innerIcons",value:function(){return{left:this.propertyValues(Vs,"innerIcons,left",ia),right:this.propertyValues(Vs,"innerIcons,right",ia)}}},{key:"obfuscateRadiusInMeters",value:function(){return this.propertyValues(Vs,"obfuscateMarkers,radiusInM",na)}},{key:"obfuscatePrecision",value:function(){return this.propertyValues(Vs,"obfuscateMarkers,precision",na)}},{key:"obfuscateStyle",value:function(){return this.propertyValues(Vs,"obfuscateMarkers,style",na)}},{key:"zIndexes",value:function(){var e=this.propertyValues(Vs,"zIndex",ua);if("google-maps"===this.mapProvider())for(var t in e)for(var r in e[t])e[t][r]=e[t][r]+zs;return e}},{key:"maxZIndex",value:function(){var e=this.zIndexes(),t=0;return Objunction(e){return Object.values(e).forEach((function(e){e>t&&(t=e)}))})),t}},{key:"textLabelDynamicPlacement",value:function(){return this.propertyValues(Vs,"textLabel,dynamicPlacement",ia)}},{key:"textLabelMaxLineLength",value:function(){return this.propertyValues(Vs,"textLabel,maxLineLength",ia)}},{key:"textLabelMaxLines",value:function(){return this.propertyValues(Vs,"textLabel,maxLines",ia)}},{key:"textSubLabelMaxLineLength",value:function(){return this.propertyValues(Vs,"textLabel,subLabel,maxLineLength",ia)}},{key:"textSubLabelMaxLines",value:function(){return this.propertyValues(Vs,"textLabel,subLabel,maxLines",ia)}},{key:"textLabelVisibility",value:function(){return this.propertyValues(Vs,"textLabel,show",ua)}},{key:"textSubLabelVisibility",value:function(){return this.propertyValues(Vs,"textLabel,subLabel,show",ua)}},{key:"textLabelZIndex",value:function(){return this.propertyValues(Vs,"textLabel,zIndex",ua)}},{key:"textLabelPosition",value:function(){return this.propertyValues(Vs,"textLabel,position",ua,(function(e){var t=e;switch(e){case"bottom":t="below";break;case"top":t="above"}return t}))}},{key:"popupPositions",value:function(){return this.propertyValues(Vs,"popup,position",ia,(function(e){var t=e;switch(e){case"bottom":t="below";break;case"top":t="above"}return t}))}},{key:"popupVisibilities",value:function(){return this.propertyValues(Vs,"popup,ensureVisibility",ia)}},{key:"popupVisibilityPaddings",value:function(){return this.propertyValues(Vs,"popup,visibilityPadding",ia)}},{key:"markerTypes",value:function(){return this.propertyValues(Vs,"markerType",ia)}},{key:"isAtLeastOneProductStatusUsingObfuscateMarker",value:function(){return Object.values(this.markerTypes().product||{}).some((function(e){return"obfuscate"===e||"pinObfuscate"===e||"priceObfuscate"===e}))}},{key:"isAtLeastOnePropertyStatusUsingObfuscateMarker",value:fune){return"obfuscate"===e||"pinObfuscate"===e||"priceObfuscate"===e}))}},{key:"visibilityByStatus",value:function(){return this.propertyValues(Vs,"show",ia)}},{key:"actionsOnFeatureSelect",value:function(){return this.propertyValues(Vs,"actionOnFeatureSelect",ia)}},{key:"actionsOnFeatureDeselect",value:function(){return this.propertyValues(Vs,"actionOnFeatureDeselect",ia)}},{key:"actionsOnFeatureOver",value:function(){return this.propertyValues(Vs,"actionOnFeatureOver",ia)}},{key:"actionsOnFeatureOut",value:function(){return this.propertyValues(Vs,"actionOnFeatureOut",ia)}},{key:"actionsOnMarkerClick",value:function(){return this.propertyValues(Vs,"actionOnClick",ua)}},{key:"actionsOnMarkerMouseOver",value:function(){return this.propertyValues(Vs,"actionOnMouseOver",ua)}},{key:"actionsOnMarkerMouseOut",value:function(){return this.propertyValues(Vs,"actionOnMouseOut",ua)}},{key:"actionsOnMapDrag",value:function(){return this.readParam("map,onMapDrag")}},{key:"actionsOnMapClick",value:function(){return this.readParam("map,onMapClick")}},{key:"singlePropertiesValues",value:function(e,t){var r=this,n={};return t.map((function(t){n[t]=r.readParam("".concat(Vs,",").concat(t,",").concat(e))})),n}},{key:"threshold",value:function(){var e=this.propertyValues(Vs,"threshold",ia),t=this.singlePropertiesValues("threshold,".concat(Us),ia);return ia.forEach((function(r){return e[r].default=t[r]})),e}},{key:"style",value:function(){return this.readParam("style")}},{key:"maxZoomForCount",value:function(){var e=this.propertyValues(Vs,"maxZoomForCount",ia),t=this.singlePropertiesValues("maxZoomForCount,".concat(Us),ia);return ia.forEach((function(r){retue",value:function(){return this.propertyValues(Vs,"clustering",ia)}},{key:"clusterDefaultConfigurationByType",value:function(){var e=this,t={};return ia.forEach((function(r){t[r]=e.subConfig("markers,".concat(r,",(){return void 0!==this.readParam("a11y,ction(){return!0===this.readParam("a11y,keyboardFeatures,enabled")}},{key:"isAnyContentProviderExists",value:function(){var e=this;return ia.some((function(t){var r,n;return null!==(r=null===(n=e.readParam("contentProvider,".concat(t,",default")))||void 0===n?void 0:n.length)&&void 0!==r&&r}))}},{key:"minZoomForDisplay",value:function(){var e=this.propertyValues(Vs,"minZoomForDisplay",ia),t=this.singlePropertiesValues("minZoomForDisplay,".concat(Us),ia);return ia.forEach((function(r){return e[r].default=t[r]})),e}},{key:"minZoomForTileRequest",value:function(){return this.readParam("tiles,minZoomForTileRequest")}},{key:"historicalBoundingBoxDataEndpoint",value:function(){return this.readParam("historicalBoundingBoxDataEndpoint")}},{key:"tagCollidingMarkers",value:function(){var e=this.propertyValues(Vs,"tagCollidingMarkers",ua),t=this.singlePropertiesValues("tagCollidingMarkers,".concat(Us),ua);return ua.forEach((function(r){return e[r].default=t[r]})),e}},{key:"collisionBufferVariation",value:function(){var e=this.propertyValues(Vs,"collisionBufferVariation",ua),t=this.singlePropertiesVat(Us),ua);return ua.forEach((function(r){return e[r].default=t[r]})),e}},{key:"collisionBuffers",value:function(){return this.readParam("markers,common,collisionBuffers")}},{key:"clusterMarkerCollisionBufferInPixels",value:function(){return this.readParam("markers,cluster,clusterMarkerCollisionAvoidance,clusterMarkerCollisionBufferInPixels,default")}},{key:"shouldMoveCollidingClusterMarkers",value:function(){return this.readParam("markers,cluster,clusterMarkerCollisionAvoidance,moveCollidingClusterMarkers,default")}},{key:"visibilityBooleanByStatus",value:function(){var e=this.visibilityByStatus();for(var t in e)for(var r in e[t])e[t][r]=!0===e[t][r]||"true"===e[t][r]||"always"===e[t][r];return e}},{key:"routeLineStyleByDistanceMode",value:function(){return this.propertyValues("routes,style",void 0,["driving","cycling","walking","flying"])}},{key:"googleMaps",value:function(){return this.subConfig("googleMaps")}},{key:"mapbox",value:function(){return this.subConfig("mapbox")}},{key:"isOneFilterAvailable",value:function(){var e=this.subConfig("filters"),t=this.visibilityByStatus();return ia.some((function(r){return(null==e?void 0:e[r])&&Object.values(t[r]).some((function(e){return"never"!==e}))}))}},{key:"tilesReaderConfig",value:function(){return this.subConfig("tiles,enabled")}},{key:"tilesProvidersConfig",value:function(){return this.subConfig("tiles,providers")}},{key:"tilesCacheConfig",value:function(){return this.subConfig("tiles,cache")}},{key:"routeCacheInMs",value:function(){return this.readParam("routes,cacheInMs")}},{key:"egDistances",value:function(){return this.readParam("routes,egDistances")}},{key:"keyboardFeaturesIcon",value:function(){return this.readParam("a11y,keyboardFeatures,keyboardFeaturesIcon")}},{key:"contentProvidersByFeatureType",value:function(){var e=this,t={};return ia.forEach((function(r){return t[r]=e.readParam("contentProvider,".concat(r,",default"))})),t}},{key:"contentProvidersConfigs",value:function(){return this.subConfig("contentProvider,providers")}},{key:"availabilityProvider",value:function(){return this.readParam("availability,availabilityProvider")}},{key:"gmapsAddConfig",value:function(){return this.subConfig("googleMaps,gmapsAddConfig")}},{key:"loadMapSettings",value:function(){return{mapProvider:this.mapProvider(),loggerFactory:this.logger.bind(this),featureTypes:ia,getFeatureStatus:this.getFeatureStatus.bind(this),getI18N:this.getI18N.bind(this),actionsOnFeatureSelect:this.actionsOnFeatureSelect(),actionsOnFeatureDeselect:this.actionsOnFeatureDeselect(),actionsOnFeatureOver:this.actionsOnFeatureOver(),actionsOnFeatureOut:this.actionsOnFeatureOut(),actionsOnMarkerClick:this.actionsOnMarkerClick(),actionsOnMarkerMouseOver:this.actionsOnMarkerMouseOver(),actionsOnMarkerMouseOut:this.actionsOnMarkerMouseOut(),popupPositions:this.popupPositions(),actionsOnMapDrag:this.actionsOnMapDrag(),actionsOnMapClick:this.actionsOnMapClick(),routeCacheInMs:this.routeCacheInMs(),contentProvidersByFeatureType:this.contentProvidersByFeatureType(),contentProvidersConfigs:this.contentProvidersConfigs(),availabilityProvider:this.availabilityProvider(),filter:{showFilter:this.subConfig("filters"),isOneFilterAvailable:this.isOneFilterAvailable(),visibilityByStatus:this.visibilityByStatus(),visibilityBooleanByStatus:this.visibilityBooleanByStatus()},locale:this.getLocale(),isKeyboardFeaturesDefined:this.isKeyboardFeaturesDefined(),isKeyboardFeaturesEnabled:this.isKeyboardFeaturesEnabled(),keyboardFeaturesIcon:this.keyboardFeaturesIcon(),tiles:{tilesReaderConfig:this.tilesReaderConfig(),tilesProvidersConfig:this.tilesProvidersConfig(),tilesCacheConfig:this.tilesCacheConfig(),minZoomForTileRequest:this.minZoomForTileRequest(),debugTileId:Wr.getDebugTilesIdEnabled()},styling:this.style(),threshold:this.threshold(),maxZoomForCount:this.maxZoomForCount(),minZoomForDisplay:this.minZoomForDisplay(),clusterConfigurationByType:this.clusterConfigurationByType(),clusterDefaultConfigurationByType:this.clusterDefaultConfigurationByType(),isAnyContentProviderExists:this.isAnyContentProviderExists(),historicalBoundingBoxDataEndpoint:this.historicalBoundingBoxDataEndpoint(),markerTypes:this.markerTypes(),isAtLeastOneProductStatusUsingObfuscateMarker:this.isAtLeastOneProductStatusUsingObfuscateMarker(),isAtLeastOnePropertyStatusUsingObfuscateMarker:this.isAtLeastOnePropertyStatusUsingObfuscateMarker(),obfuscateRadiusInMeters:this.obfuscateRadiusInMeters(),obfuscatePrecision:this.obfuscatePrecision(),obfuscateStyle:this.obfuscateStyle(),icons:this.icons(),frameIcons:this.frameIcons(),cornerIcons:this.cornerIcons(),innerIcons:this.innerIcons(),textLabelVisibility:this.textLabelVisibility(),textSubLabelVisibility:this.textSubLabelVisibility(),zIndexes:this.zIndexes(),maxZIndex:this.maxZIndex(),textLabelZIndex:this.textLabelZIndex(),textLabelPosition:this.textLabelPosition(),textLabelMaxLineLength:this.textLabelMaxLineLength(),textLabelMaxLines:this.textLabelMaxLines(),textSubLabelMaxLineLength:this.textSubLabelMaxLineLength(),textSubLabelMaxLines:this.textSubLabelMaxLines(),iso4217CurrencyCode:this.iso4217CurrencyCode(),debugMarkersPosition:Wr.getDebugMarkersPositionEnabled(),collision:{labelVisibility:this.textLabelVisibility(),dynamicPlacement:this.textLabelDynamicPlacement(),collisionBufferVariation:this.collisionBufferVariation(),collisionBuffers:this.collisionBuffers(),tagCollidingMarkers:this.tagCollidingMarkers(),clusterMarkerCollisionBufferInPixels:this.clusterMarkerCollisionBufferInPixels(),shouldMoveCollidingClusterMarkers:this.shouldMoveCollidingClusterMarkers()},routeLineStyleByDistanceMode:this.routeLineStyleByDistanceMode(),googleMaps:this.googleMaps(),mapbox:this.mapbox()}}},{key:"getActiveTilesets",value:function(){var e=this.readParam("tiles,enabled,product"),t=this.readParam("tiles,enabled,property"),r=this.readParam("tiles,enabled,place"),nion(e){var t;return null===(t=i[e])||void 0===t?void 0:t.tilesetId}))}}],r&&Es(t.prototype,r),n&&Es(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}(en);function qs(e,t){var r,n,i=e.mapProvider!==t.mapProvider||"mapbox"===t.mapProvider&&Ws(e.mapbox,t.mapbox)||"google-maps"===t.mapProvider&&((null===(r=e.googleMaps)||void 0===r||null===(r=r.gmapsAddConfig)||void 0===r?void 0:r.mapId)||"")!==((null===(n=t.googleMaps)||void 0===n||null===(n=n.gmapsAddConfig)||void 0===n?void 0:n.mapId)||"");if(i)return{reinstantiate:i};var o="google-maps"===t.mapProvider&&Ws(e.googleMaps.gmapsAddConfig||{},t.googleMaps.gmapsAddConfig||{}),a=Gs(e.icons,t.icons),s=Ws(e.frameIcons,t.frameIcons),u=Gs(e.cornerIcons,t.cornerIcons),l=Gs(e.innerIcons,t.innerIcons),c=Ws(e.contentProvidersByFeatureType,t.contentProvidersByFeatureType),f=Ws(e.threshold,t.threshold),d=Ws(e.maxZoomForCount,t.maxZoomForCount),h=Ws(e.minZoomForDisplay,t.minZoomForDisplay),p=Ws(e.clusterConfigurationByType,t.clusterConfigurationByType),v=Ws(e.markerTypes,t.markerTypes),y=Ws(e.obfuscateRadiusInMeters,t.obfuscateRadiusInMeters),g=Ws(e.obfuscatePrecision,t.obfuscatePrecision),m=Ws(e.obfuscateStyle,t.obfuscateStyle),b=Ws(e.textLabelVisibility,t.textLabelVisibility),k=Ws(e.textSubLabelVisibility,t.textSubLabelVisibility),w=Ws(e.zIndexes,t.zIndexes),C=Ws(e.textLabelZIndex,t.textLabelZIndex),P=Ws(e.textLabelPosition,t.textLabelPosition),L=Ws(e.textLabelMaxLineLength,t.textLabelMaxLineLength),x=Ws(e.textLabelMaxLines,t.textLabelMaxLines),M=Ws(e.textSubLabelMaxLineLength,t.textSubLabelMaxLineLength),F=Ws(e.textSubLabelMaxLines,t.textSubLabelMaxLines),_=Ws(e.collision,t.collision),O=Ws(e.routeLineStyleByDistanceMode,t.routeLineStyleByDistanceMode),S=Ws(e.contentProvidersConfigs,t.contentProvidersConfigs),E=Ws(e.availabilityProvider,t.availabilityProvider),I=Ws(e.filter,t.filter),A=Ws(e.clusterDefaultConfigurationByType,t.clusterDefaultConfigurationByType),T=Ws(e.tiles,t.tiles),B=Ws(e.actionsOnFeatureSelect,t.actionsOnFeatureSelect)||Ws(e.actionsOnFeatureDeselect,t.actionsOnFeatureDeselect)||Ws(e.actionsOnFeatureOver,t.actionsOnFeatureOver)||Ws(e.actionsOnFeatureOut,t.actionsOnFeatureOut)||Ws(e.actionsOnMarkerClick,t.actionsOnMarkerClick)||Ws(e.actionsOnMarkerMouseOver,t.actionsOnMarkerMouseOver)||Ws(e.actionsOnMarkerMouseOut,t.actionsOnMarkerMouseOut)||Ws(e.popupPositions,t.popupPositions)||c||f||d||h||e.isAnyContentProviderExists!==t.isAnyContentProviderExists||p||v||y||g||m||a||s||u||l||b||k||w||C||P||L||x||M||F||_,D=T,j={updateMapProviderConfig:o,updateViewport:O||e.routeCacheInMs!==t.routeCacheInMs||c||S||E||I||e.isKeyboardFeaturesDefined!==t.isKeyboardFeaturesDefined||e.isKeyboardFeaturesEnabled!==t.isKeyboardFeaturesEnabled||f||d||h||p||A||e.isAnyContentProviderExists!==t.isAnyContentProviderExists||v||e.isAtLeastOneProductStatusUsingObfuscateMarker!==t.isAtLeastOneProductStatusUsingObfuscateMarker||e.isAtLeastOnePropertyStatusUsingObfuscateMarker!==t.isAtLeastOnePropertyStatusUsingObfuscateMarker||y||g||m||a||s||u||l||b||k||w||C||P||L||x||M||F||e.debugMarkersPosition!==t.debugMarkersPosition||_||T,updateMarkers:v||e.isAtLeastOneProductStatusUsingObfuscateMarker!==t.isAtLeastOneProductStatusUsingObfuscateMarker||e.isAtLeastOnePropertyStatusUsingObfuscateMarker!==t.isAtLeastOnePropertyStatusUsingObfuscateMarker||y||g||m||a||s||u||l||b||k||w||C||P||L||x||M||F||e.debugMarkersPosition!==t.debugMarkersPosition,updateKeyboardA11yUI:e.isKeyboardFeaturesDefined!==t.isKeyboardFeaturesDefined||e.isKeyboardFeaturesEnabled!==t.isKeyboardFeaturesEnabled||Ws(e.keyboardFeaturesIcon,t.keyboardFeaturesIcon),updateFiltersUI:I,updateStyling:Ws(e.styling,t.styling),resetRouteManagement:O||e.routeCacheInMs!==t.routeCacheInMs,resetClusterers:p||A,resetContentProviders:c||S,resetCollisionManagement:_,resetAvailabilityCTiles:D};retion(e){return!1===j[e]})).forEach((function(e){return delete j[e]})),j}function Ws(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Ns(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Qs(e))}function Qs(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new WeakSet;return Object.keys(e).forEach((function(n){var i=e[n];Y(i)?t[n]=J(i):Rs(i)?r.has(i)||(t[n]={},Qs(e[n],t[n],r)):t[n]=i})),t}var $s={marker:"data:image/svg+xml,%3c!-- file: marker.svg --%3e %3csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3e%3cpath fill='%23026dc5' d='M16 2.667A9.326 9.326 0 006.667 12C6.667 19 16 29.333 16 29.333S25.333 19 25.333 12A9.326 9.326 0 0016 2.667zm0 12.666a3.334 3.334 0 010-6.666 3.334 3.334 0 010 6.666z'/%3e%3c/svg%3e",markerHighlighted:"data:image/svg+xml,%3c!-- file: marker-hl.svg --%3e %3csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3e%3cpath fill='%2354a0dd' d='M16 2.667A9.326 9.326 0 006.667 12C6.667 19 16 29.333 16 29.333S25.333 19 25.333 12A9.326 9.326 0 0016 2.667zm0 12.666a3.334 3.334 0 010-6.666 3.334 3.334 0 010 6.666z'/%3e%3c/svg%3e",keyboardNavigationIcon:"data:image/svg+xml,%3c!-- file: keyboard.svg --%3e %3csvg xmlns='http://www.w3.org/2000/svg' height='24' width='24'%3e%3cpath d='M20 5H4c-1.1 0-1.99.9-1.99 2L2 17c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-9 3h2v2h-2V8zm0 3h2v2h-2v-2zM8 8h2v2H8V8zm0 3h2v2H8v-2zm-1 2H5v-2h2v2zm0-3H5V8h2v2zm9 7H8v-2h8v2zm0-4h-2v-2h2v2zm0-3h-2V8h2v2zm3 3h-2v-2h2v2zm0-3h-2V8h2v2z'/%3e%3c/svg%3e",leftArrowIcon:"data:image/svg+xml,%3c!-- file: left-arrow.svg --%3e %3csvg xmlns='http://www.w3.org/2000/svg' height='24' width='14'%3e%3cpath d='M9.87.613Q9.55.96 8.08 2.523 6.612 4.085 4.983 5.82q-1.628 1.736-2.95 3.125L.735 10.335q-.343.322-.54.756-.195.434-.195.88 0 .447.196.881t.539.756l1.298 1.39q1.322 1.388 2.95 3.124l3.098 3.299q1.47 1.562 1.788 1.91.686.669 1.64.669.956 0 1.617-.67t.723-1.537q.06-.868-.723-1.761l-7.518-8.06 7.665-8.06q.784-.794.723-1.712-.062-.917-.723-1.587-.784-.67-1.75-.608-.968.062-1.654.608z'/%3e%3c/svg%3e",rightArrowIcon:"data:image/svg+xml,%3c!-- file: right-arrow.svg --%3e %3csvg xmlns='http://www.w3.org/2000/svg' height='24' width='14'%3e%3cpath d='M4.13 23.387q.32-.347 1.789-1.91 1.469-1.562 3.098-3.298 1.628-1.736 2.95-3.125l1.298-1.389q.343-.322.54-.756.195-.434.195-.88 0-.447-.196-.881t-.539-.756l-1.298-1.39q-1.322-1.388-2.95-3.124L5.919 2.579Q4.449 1.017 4.13.67 3.445 0 2.49 0 1.534 0 .873.67T.15 2.207q-.06.868.723 1.761l7.518 8.06-7.665 8.06q-.784.794-.723 1.712.062.917.723 1.587.784.67 1.75.608.968-.062 1.654-.608z'/%3e%3c/svg%3e"},Xs=function(){var e=new Br;return{mapProvider:"google-maps",map:{onMapDrag:["clearHighlight","clearSelection","closePopup","removeAriaLive"],onMapClick:["clearHighlight","clearSelection","closePopup","removeAriaLive"],mapInitWaitForTiles:!0},googleMaps:{padding:32,gmapsAddConfig:{zoom:2,mapId:"57df04e09ffe3110",center:{lat:0,lng:0},gestureHandling:"greedy",clickableIcons:!1,disableDefaultUI:!1,zoomControl:!0,mapTypeControl:!1,scaleControl:!1,streetViewControl:!1,rotateControl:!1,fullscreenControl:!1,isFractionalZoomEnabled:!0},urls:{api:"https://maps.googleapis.com/maps/api/js?libraries=places,geometry"}},mapbox:{accessToken:void 0,rtlTextPlugin:"https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js",padding:32,scaleControl:{ctrlEnabled:!1,ctrlOptions:{unit:"metric"},ctrlPosition:void 0},navControl:{ctrlEnabled:!0,ctrlOptions:{},ctrlPosition:void 0},geoLocateControl:{ctrlEnabled:!1,ctrlOptions:{},ctrlPosition:void 0},fullscreenControl:{ctrlEnabled:!1,ctrlOptions:{},ctrlPosition:void 0},mapboxAddConf:{center:[0,0],zoom:1,fadeDuration:100,style:"mapbox://styles/expedia-geo/ckfgvpedb2neq19pe9u3zg69x"},urls:{api:"https://api.mapbox.com/mapbox-gl-js/v2.9.2/mapbox-gl.js",css:"https://api.mapbox.com/mapbox-gl-js/v2.9.2/mapbox-gl.css",pluginUrls:["https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-language/v1.0.0/mapbox-gl-language.js"]}},markers:{common:{collisionBuffers:{low:16,medium:128,high:192}},product:{threshold:{default:200},maxZoomForCount:{default:15},minZoomForDisplay:{default:9},actionOnFeatureSelect:{default:["bounce","highlight","showRoutes","addAriaLive"]},actionOnFeatureDeselect:{default:["dehighlight","hideRoutes","removeAriaLive"]},actionOnFeatureOver:{default:[]},actionOnFeatureOut:{default:[]},actionOnClick:{default:["select","highlight","showRoutes","addAriaLive"]},actionOnMouseOver:{default:["sendEvent"]},actionOnMouseOut:{default:["sendEvent"]},tagCollidingMarkers:{default:!1},collisionBufferVariation:{default:"none"},show:{default:"never",available:"always",filtered:"never",sold_out:"never",unknown:"never","linked-features":!1},clustering:{default:{type:"none",minPoints:2,minZoom:0,maxZoom:15,labelKey:mi.defaultClusterProductLabel,superclusterSettings:{radius:105},excludedQualifiers:[]}},zIndex:{default:1,hl:6,available:5,filtered:4,sold_out:3},markerType:{default:"pin",available:"price",filtered:"pin"},icons:{default:$s.marker,hl:$s.markerHighlighted},cornerIcons:{topLeft:{default:"none"},topRight:{default:"none"},bottomLeft:{default:"none"},bottomRight:{default:"none"}},frameIcons:{default:"none"},innerIcons:{left:{default:"none"},right:{default:"none"}},popup:{position:{default:"above"},ensureVisibility:{default:!1},visibilityPadding:{default:{x:20,y:20}}},obfuscateMarkers:{precision:{default:100},style:{default:{line:{weight:1,color:"#616161",opacity:1},fill:{color:"#E6E6E6",opacity:.3}},hl:{line:{weight:1,color:"#1C598C",opacity:1},fill:{color:"#0E77CD",opacity:.5}}},radiusInM:{default:500}},textLabel:{show:{default:!1},zIndex:{default:"sameAsMarker"},position:{default:"right"},maxLineLength:{default:-1},maxLines:{default:-1},dynamicPlacement:{default:!1}}},property:{threshold:{default:200},maxZoomForCount:{default:15},minZoomForDisplay:{default:9},actionOnFeatureSelect:{default:["bounce","highlight","showRoutes","addAriaLive"]},actionOnFeatureDeselect:{default:["dehighlight","hideRoutes","removeAriaLive"]},actionOnFeatureOver:{default:[]},actionOnFeatureOut:{default:[]},actionOnClick:{default:["select","highlight","showRoutes","addAriaLive"]},actionOnMouseOver:{default:["sendEvent"]},actionOnMouseOut:{default:["sendEvent"]},tagCollidingMarkers:{default:!1},collisionBufferVariation:{default:"none"},show:{default:"never",available:"always",filtered:"never",sold_out:"never",unknown:"never","linked-features":!1},clustering:{default:{type:"none",minPoints:2,minZoom:0,maxZoom:15,labelKey:mi.defaultClusterPropertyLabel,superclusterSettings:{radius:105},excludedQualifiers:[]}},zIndex:{default:1,hl:6,available:5,filtered:4,sold_out:3},markerType:{default:"pin",available:"price",filtered:"pin"},icons:{default:$s.marker,hl:$s.markerHighlighted},cornerIcons:{topLeft:{default:"none"},topRight:{default:"none"},bottomLeft:{default:"none"},bottomRight:{default:"none"}},frameIcons:{default:"none"},innerIcons:{left:{default:"none"},right:{default:"none"}},popup:{position:{default:"above"},ensureVisibility:{default:!1},visibilityPadding:{default:{x:20,y:20}}},obfuscateMarkers:{precision:{default:100},style:{default:{line:{weight:1,color:"#616161",opacity:1},fill:{color:"#E6E6E6",opacity:.3}},hl:{line:{weight:1,color:"#1C598C",opacity:1},fill:{color:"#0E77CD",opacity:.5}}},radiusInM:{default:500}},textLabel:{show:{default:!1},subLabel:{show:{default:!1},maxLineLength:{default:-1},maxLines:{default:-1}},zIndex:{default:"sameAsMarker"},position:{default:"right"},maxLineLength:{default:-1},maxLines:{default:-1},dynamicPlacement:{default:!1}}},place:{threshold:{default:100},maxZoomForCount:{default:10},minZoomForDisplay:{default:11},actionOnFeatureSelect:{default:["bounce","highlight","addAriaLive"]},actionOnFeatureDeselect:{default:["dehighlight","removeAriaLive"]},actionOnFeatureOver:{default:[]},actionOnFeatureOut:{default:[]},actionOnClick:{default:["select","highlight","addAriaLive"]},actionOnMouseOver:{default:["sendEvent"]},actionOnMouseOut:{default:["sendEvent"]},tagCollidingMarkers:{default:!1},collisionBufferVariation:{default:"none"},show:{default:!1},clustering:{default:{type:"none",minPoints:2,minZoom:0,maxZoom:15,labelKey:mi.defaultClusterPlaceLabel,superclusterSettings:{radius:105},excludedQualifiers:[]}},zIndex:{default:1,hl:6},markerType:{default:"pin"},icons:{default:$s.marker,hl:$s.markerHighlighted},cornerIcons:{topLeft:{default:"none"},topRight:{default:"none"},bottomLeft:{default:"none"},bottomRight:{default:"none"}},frameIcons:{default:"none"},innerIcons:{left:{default:"none"},right:{default:"none"}},popup:{position:{default:"above"},ensureVisibility:{default:!1},visibilityPadding:{default:{x:20,y:20}}},textLabel:{show:{default:!1},subLabel:{show:{default:!1},maxLineLength:{default:-1},maxLines:{default:-1}},zIndex:{default:"sameAsMarker"},position:{default:"right"},maxLineLength:{default:20},maxLines:{default:3},dynamicPlacement:{default:!1}}},cluster:{actionOnClick:{default:["select","zoomToExtent"]},actionOnMouseOver:{default:["sendEvent"]},actionOnMouseOut:{default:["sendEvent"]},tagCollidingMarkers:{default:!1},collisionBufferVariation:{default:"none"},clusterMarkerCollisionAvoidance:{moveCollidingClusterMarkers:{default:!1},clusterMarkerCollisionBufferInPixels:{default:5}},zIndex:{default:1,hl:6,unknown:2},textLabel:{show:{default:!1},zIndex:{default:"sameAsMarker"},position:{default:"right"}}}},filters:{product:!1,property:!1,place:!1},tiles:{enabled:{product:[],property:[],place:[]},providers:{egPois:{type:"eg",tilesetId:"pois",url:"https://www.expedia.com/eg-tile-server",query:"",timeout:2e3}},minZoomForTileRequest:8,cache:{maxSize:-1,maxDistance:30}},contentProvider:{cacheInMs:18e5,product:{default:[]},property:{default:[]},place:{default:[]},providers:{}},historicalBoundingBoxDataEndpoint:"https://a.travel-assets.com/travel-assets-manager/df4af43c-2db9-4868-8665-96b7042a2c98/historical_bbox_data-min.json",availability:{availabilityProvider:"none",availabilityProviders:{}},locale:"en-US",iso4217CurrencyCode:"USD",routes:{egDistances:void 0,cacheInMs:18e5,style:{driving:{lineStyle:"normal",color:"#000000",width:1.5,opacity:.8},cycling:{lineStyle:"dash",color:"#000000",width:1.54,opacity:.8},walking:{lineStyle:"dot",color:"#000000",width:1.5,opacity:.8},flying:{lineStyle:"dash",color:"#000000",width:1.5,opacity:.8}}},a11y:{keyboardFeatures:{keyboardFeaturesIcon:$s.keyboardNavigationIcon}},logging:{logger:e},style:{}}},Ys=_t,Js=dr,eu="on-collision";function tu(e,t,r,n,i){e.labels.aligner&&(pe(e.labels.aligner),e.labels.label=void 0,e.labels.subLabel=void 0),e.labels.textLabelPosition=r,e.labels.aligner=ge(void 0,e.labels.textLblCont,"marker-labels-aligner ".concat(r)),e.labels.container=ge(void 0,e.labels.aligner,"marker-labels-container");var o=Ys(n.textLabelZIndex[t.type],t.hashKeys);"sameAsMarker"!=o&&He(e.labels.aligner,i(o))}function ru(e,t,r,n,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:function(e){return e},a=Ys(i.textLabelPosition[t.type],t.hashKeys);r&&(tu(e,t,a,i,o),iu(e,t,r,n,i)),e.labels.updateTextLabel=function(r,n){r&&!e.labels.aligner&&tu(e,t,a,i,o),iu(e,t,r,n,i)},e.labels.updateTextLabelPosition=function(){var s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;s!==e.labels.textLabelPosition&&(tu(e,t,s,i,o),iu(e,t,r,n,i))},e.labels.toggleTextLabel=function(t){var r=e.labels.aligner;r&&(t?nt(r,eu):ot(r,eu))},e.labels.resetTextLabel=function(){e.labels.toggleTextLabel(!1),e.labels.updateTextLabelPosition(a)}}function nu(e,t,r,n,i,o,a){var s=Ys(r[e.type],e.hashKeys),u=Ys(n[e.type],e.hashKeys),l=Js(i,s,u);return a?(re(a,l),a):Ce(void 0,t,"marker-".concat(o,"-text"),void 0,l)}function iu(e,t,r,n,i){var o=e.labels,a=o.container,s=o.label,u=o.subLabel;if(r){var l=i.textLabelMaxLineLength,c=i.textLabelMaxLines;if(e.labels.label=nu(t,a,l,c,r,"label",s),n){var f=i.textSubLabelMaxLineLength,d=i.textSubLabelMaxLines;e.labels.subLabel=nu(t,a,f,d,n,"sublabel",u)}else pe(u),e.labels.subLabel=void 0}else e.labels&&(pe(e.labels.aligner),e.labels.aligner=void 0,e.labels.container=void 0,e.labels.label=void 0,e.labels.subLabel=void 0,e.labels.textLabelPosition=void 0)}function ou(e,t,r,n,i){var o=ce(t,["marker-labels-container"],!0),a=i(e),s=a.width,u=a.height,l=a.center,c=n||Ys(r.textLabelPosition[e.type],e.hashKeys),f=o.scrollWidth,d=o.scrollHeight;switch(l.x-=s/2,l.y-=u/2,c){case"right":l.y+=u/2,l.x+=s+f/2;break;case"left":l.y+=u/2,l.x-=f/2;break;case"above":l.y-=d/2,l.x+=s/2;break;default:l.y+=u+d/2,l.x+=s/2}return ct(l,f,d)}function au(e){return au="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},au(e)}function su(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uu(n.key),n)}}function uu(e){var t=function(e,t){if("object"!==au(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==au(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===au(t)?t:String(t)}var lu=hr,cu=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.maxSize=t,this.maxDistance=r,this.cache={},this.listeners=new Set,this.size=0}var t,r,n;return t=e,(r=[{key:"getTile",value:function(e,t,r){return this.cache[r]&&this.cache[r][e]?this.cache[r][e][t]:void 0}},{key:"setTile",value:function(e,t,r,n){var i=this.cache;i[r]||(i[r]={}),!i[r][e]&&lu(r)&&lu(e)&&(i[r][e]={}),!i[r][e][t]&&n?this.size=this.size+1:i[r][e][t]&&!n&&(this.size=this.size-1),lu(r)&&lu(e)&&lu(t)&&(i[r][e][t]=n),this.maxSize>0&&this.size>this.maxSize&&this._expire(e,t,r)}},{key:"addTilesListener",value:function(e){this.listeners.add(e)}},{key:"removeTilesListener",value:function(e){this.listeners.delete(e)}},{key:"_expire",value:function(t,r,n){var i=this,o=function(o){var a=function(a){var s=function(s){Bn(t,r,n,a,s,o)>i.maxDistance&&(i.listeners.forEach((function(t){return t(e.EVENTS.EXPIRE,Number(a),Number(s),Number(o),i.cache[o][a][s])})),delete i.cache[o][a][s],i.size=i.size-1)};for(var u in i.cache[o][a])s(u)};for(var s in i.cache[o])a(s)};for(var a in this.cache)o(a)}}])&&su(t.prototype,r),n&&su(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function fu(e){return fu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fu(e)}function du(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hu(n.key),n)}}function hu(e){var t=function(e,t){if("object"!==fu(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==fu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===fu(t)?t:String(t)}cu.EVENTS={EXPIRE:"expire"};var pu=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,(r=[{key:"loadTile",value:function(e,t,r,n,i){return Promise.reject("not implemented")}}])&&du(t.prototype,r),n&&du(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),vu=r(736);function yu(e){return yu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yu(e)}function gu(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mu(n.key),n)}}function mu(e){var t=function(e,t){if("object"!==yu(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==yu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===yu(t)?t:String(t)}function bu(e,t){return bu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},bu(e,t)}function ku(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=wu(e);if(t){var i=wu(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"===yu(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function wu(e){return wu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},wu(e)}var Cu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bu(e,t)}(o,e);var t,r,n,i=ku(o);function o(e,t){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(r=i.call(this)).codec=new vu.EGTSCodec,r.logger=t("EgTilesReader"),r.tilesUrlPrefix=e.url,r.query=e.query,r.tilesetId=e.tilesetId,r.queryByZoom=e.queryByZoom,r.timeout=e.timeout||500,r}return t=o,(r=[{key:"loadTile",value:function(e,t,r,n,i){var o=this,a=this.buildUrl(t,r,n,i);return this.fetchTile(a,e,t,r,n).then((function(e){return e.success?e.data.map((function(e){return o.removeColonFromQualifiers(e)})):(o.logger.error("Failed to load tile from ".concat(e.url,": ").concat(e.error.message),e.error.stack),[])}))}},{key:"removeColonFromQualifiers",value:function(e){var t;re)||void 0===t?void 0:t.map((function(e){return e.replace(":","__")})),e}},{key:"buildUrl",value:function(e,t,r,n){var i="/v1/tilesets/".concat(this.tilesetId,"/").concat(r,"/").concat(e,"/").concat(t,"/egmaps.pbf?locale=").concat(n),o=i;return this.queryByZoom&&this.queryByZoom[r]?o="".concat(i,"&").concat(this.queryByZoom[r]):this.query&&(o="".concat(i,"&").concat(this.query)),o}},{key:"fetchTile",value:function(e,t,r,n,i){var o=this;return Kr("".concat(this.tilesUrlPrefix).concat(e),this.timeout,{referrerPolicy:"no-referrer",credentials:"omit"}).then((function(t){return t.ok?t.arrayBuffer():404===t.status?void 0:Promise.reject(new Error("Server returns error code ".concat(t.status," ")+"when calling ".concat(e," for tile {x: ").concat(r,", y: ").concat(n,", zoom: ").concat(i,"}: \n              ").concat(t.statusText)))})).then((function(t){return o.handleRespons,data:t}}))})).catch((function(t){return{url:e,success:!1,error:t}}))}},{key:"handleResponse",value:function(e){return e?this.codec.decode(e):Promise.resolve([])}}])&&gu(t.prototype,r),n&&gu(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}(pu);function Pu(e){return Pu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pu(e)}function Lu(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return xu(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?xu(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function xu(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Mu(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fu(n.key),n)}}function Fu(e){var t=function(e,t){if("object"!==Pu(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==Pu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Pu(t)?t:String(t)}var _u=function(){function e(t,r,n,i,o,a,s){var u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},l=u.delayBeforeRefresh,c=void 0===l?100:l,f=u.delayForceRefresh,d=void 0===f?2e3:f;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.logger=t.loggerFactory("TilesLoader"),this.delayBeforeRefresh=c,this.delayForceRefresh=d,this.refreshRequested=Date.now(),this.lastRefresh=this.refreshRequested,this.createFeature=r,this.deleteFeature=n,this.updateViewport=i,this.handleTilesLoaded=o,this.handleTilesContentLoaded=a,this.depth=s,this.tilesInFlight=new Set,this.instantiateTilesProvider(t)}var t,r,n;return t=e,(r=[{key:"instantiateTilesProvider",value:function(e){var t=this,r=e.tiles,n=r.tilesReaderConfig,i=r.tilesProvidersConfig,o=r.tilesCacheConfig,a=r.minZoomForTileRequest,s=e.locale;this.locale=s,this.tilesProvidersConfig={},Object.keys(n).forEach((function(r){n[r].forEach((function(n){if(!t.tilesProvidersConfig[n]){t.tilesProvidersConfig[n]={featureTypes:[]};var o=i[n];switch(o&&o.type||n){case"eg":t.tilesProvidersConfig[n].service=new Cu(o,e.loggerFactory);break;case"noop":t.tilesProvidersConfig[n].service=new pu;break;default:throw new Error("Tiles provider ".concat(n," not supported"))}}t.tilesProvidersConfig[n].featureTypes.push(r)}))})),this.minZoomForTileRequest=a,this.tilesCache=new cu(o.maxSize,o.maxDistance),this.tilesCache.addTilesListener(this.handleCacheEvent.bind(this))}},{key:"getNormalizedCoord",value:function(e,t,r){var n=1<<r,i=e;return t<0||t>=n?null:((i<0||i>=n)&&(i=(i%n+n)%n),{x:i,y:t})}},{key:"registerRefreshViewport",value:function(){var e=this,t=Date.now();this.refreshRequested=t,setTimeout((function(){var r=Date.now();(e.refreshRequested===t||e.lastRefresh+e.delayForceRefresh<r)&&(e.refreshRequested=r,e.lastRefresh=r,e.updateViewpo,r,n){return"".concat(e,",").concat(t,",").concat(r,",").concat(n)}},{key:"_registerTileInFlight",value:function(e,t,r,n){this.tilesInFlight.add(this._getTileInFlightKey(e,t,r,n))}},{key:"_removeTileInFlight",value:function(e,t,r,n){this.tilesInFlight.delete(thisightTilesDone",value:function(){return 0===this.tilesInFlight.size}},{key:"_loadData",value:function(e,t,r,n,i,o,a){for(var s=Math.pow(2,a),u=i+a,l=r*s,c=n*s,f=[],d=0;d<s;d++)for(var h=0;h<s;h++)f.push(e.loadTile(t,l+d,c+h,u,o));return Promise.all(f).then((function(e){return e.flat()}))}},{key:"loadTile",value:function(e,t,r){var n=this;if(this.tilesProvidersConfig&&Object.keys(this.tilesProvidersConfig).length>0&&!isNaN(e)&&!isNaN(t)&&!isNaN(r)){var i=this.getNormalizedCoord(e,t,r);if(null!==i&&r>=this.minZoomForTileRequest&&!this.tilesCache.getTile(i.x,i.y,r)){this.tilesCache.setTile(i.x,i.y,r,[]);var o=[],a=function(e){var t=n.tilesProvidersConfig[e],a=t.service,s=t.featureTypes;n._registerTileInFlight(e,i.x,i.y,r);var u,l=Lu(s);try{var c=function(){varth).then((function(r){return{data:r,tilesProvider:e,featureType:t}})))};for(l.s();!(u=l.n()).done;)c()}catch(e){l.e(e)}finally{l.f()}};for(var s in this.tilesProvidersConfig)a(s);return Promise.all(o).then((function(o){var a=[],s={};for(var u in o.forEach((function(i){var o=i.data,u=i.tilesProvider,l=i.featureType;return o.forEach((function(i){i.tile=[e,t,r],a.push(n.createFeature(i)),s[u]?s[u].includes(l)||s[u].push(l):s[u]=[l]}))})),n.tilesCache.setTile(i.x,i.y,r,a),n.tilesProvidersConfig)n._removeTileInFlight(u,i.x,i.y,r);n._areInFlightTilesDone()&&n.handleTilesContentLoaded(Object.keys(n.tilesProvidersConfig)),a.length>0&&(n.registerRefreshViewport(),Object.keys(s).forEach((function(e){return n.handleTilesLoaded(e,s[e].join(","),["(".concat(i.x,", ").concat(i.y,", ").concat(r,")")])})))})).catch((function(){return n.tilesCache.setTile(i.x,i.y,r,null)}))}}return Promise.resolve()}},{key:"handleCacheEvent",value:function(e,t,r,n,i){var o=this;e===cu.EVENTS.EXPIRE&&(this.logger.infoEnabled()&&this.logger.info("Cache expires. Deleting ".concat(i.length," features")),i.forEach((function(e){return o.deleteFeature(e)})))}}])&&Mu(t.prototype,r),n&&Mu(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ou(e){return Ou="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ou(e)}function Su(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Eu(n.key),n)}}function Eu(e){var t=function(e,t){if("object"!==Ou(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==Ou(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Ou(t)?t:String(t)}var Iu=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.configHelper=new Zs(Xs(),t,Ii),this.eventsManager=new ri(this.configHelper.logger("EventsManager")),this.dataRepositories=new ha,this.mapData=Ls(),this.uniqId=Yt()}var t,r,n;return t=e,r=[{key:"_initializeProperties",value:function(){this.logger=this.configHelper.logger("EGMap"),this.logger.debug("initializing EGMaps"),"mapbox"===this.configHelper.mapProvider()?this.mapImpl=this._createMapBox():this.mapImpl=this._createGMaps()}},{key:"_createMapBox",value:function(){if(this.logger.debug("creating MapBox"),"undefined"!=typeof egmapsMapbox)return new egmapsMapbox.MapBox(this.configHelper,this.eventsManager,this.dataRepositories,this.mapData);throw new Error("You need to load '@eg-maps/mapbox' to use this map provider")}},{key:"_createGMaps",value:function(){if(this.logger.debug("creating GMaps"),"undefined"!=typeof egmapsGoogleMaps)return new egmapsGoogleMaps.GMaps(this.configHelper,this.eventsManager,this.dataRepositories,this.mapData);throw new Error("You need to load '@eg-maps/google-maps' to use this map provider")}},{key:"initMap",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,i=arguments.s.configHelper.ready().then((function(){return t._initMap(e,r,n,i)})).then((function(){}))}},{key:"_cleanPreviousMapContainer",value:function(e,t){var r=se(e,["egmaps"]);return r.length>0?(t||this.logger.warn("This container contains some other instance of eg-maps.In order to avner will be cleaned."),r.forEach((function(e){return pe(e.element)})),r[0].index):-1}},{key:"_createMapContainer",value:function(e,t,r){var n=this.uniqId;null!=e&&e.id&&(n="".concat(e.id,"-").concat(n));var i=ge(n,void 0,"egmaps",void 0,r);t>=0?gt(i,e,t):e.appendChild(i);var o=this.configHelper.readParam("additionalCssClass");return o&&nt(i,o),nt(i,this.configHelper.mapProvider()),i}},{key:"updateConfiguration",value:function(e){var t,r=this,n=this.configHelper,i=n.getConfigurations(),o=null===(t=i.parameter)||void 0===t?void 0:t.externalConfigEndpoint,a=e.externalConfigEndpoint&&e.externalConfigEndpoint===o?i.external:void 0,s=new Zs(Xs(),e,Ii,a);return s.ready().then((function(){var e=n.loadMapSettings(),t=s.loadMapSettings(),i=qs(e,t);if(Object.keys(i).filter((function(e){return i[e]})).length>0){if(r.configHelper=s,r.mapImpl.updateConfigHelperOnFeatures(r.configHelper),i.reinstantiate){var o=r.mapImpl.getBounds();r.mapImpl.syncFilterChecked(r.configHelper);var a=r.mapImpl.listRegisteredRoutes();return r.mapImpl.clearHashkeys(),r.mapImpl.clearMarkers(),r._initMap(r.origmapImpl.syncRegisteredRoutes(a),r.mapImpl.updateRoutesOnViewport()})).then((function(){return i}))}return r.mapImpl.updateConfiguration(r.configHelper,t,i).then((function(){return i}))}return{}}))}},{key:"_initMap",value:function(e,t,r,n){var i=this;this._initializeProperties();var o=this._cleanPreviousMapContainer(e,t),a="style-".concat(this.uniqId);return this.originalNode=e,this.node=this._createMapContainer(e,o,a),this.clientPadding=n,this.mapImpl.initMap(this.node,a,r,this.clientPadding).then((function(){return i.mapImpl}))}},{key:"centerAndZoomMap",value:function(e,t,r){var n;return!0===(null===(n=this.mapImpl)||void 0===n?void 0:n.centerAndZoomMap(e,t,r))}},{key:"getCenter",value:function(){if(this.mapImpl)return this.mapImpl.getCenter();throw new Error("map is not initialized")}},{key:"getZoom",value:function(){if(this.mapImpl)return this.mapImpl.getZoom();throw new Error("map is not initialized")}},{key:"getBounds",value:function(){if(this.mapImpl)return this.mapImpl.getBounds()ue:function(){this.mapImpl&&this.mapImpl.unbindAll(),pe(this.node)}},{key:"fitLatLongs",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0;return this.mapImpl?this.mapImpl.fitLatLongs(e,!1,t,r):Promise.reject(new Error("map is not initialized"))}},{key:"fitBounds",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3?arguments[3]:void 0;return this.mapImpl?this.mapImpl.fitBounds(e,t,!1,r,n):Promise.reject(new Error("map is not initialized"))}},{key:"boundsContaining",value:function(e,t,r){return this.mapImpl?this.mapImpl.boundsContaining(e,t,r):Promise.reject(new Error("map is not initialized"))}},{key:"pushFeatureData",value:function(e,t){if(this.mapImpl)return this.mapImpl.pushFeatureData(e,t,!1);throw new Error("map is not initialized")}},{key:"removePushedFeatureData",value:function(e){if(this.mapImpl)return this.mapImpl.removePushedFeatureData(e,!1);throw new Error("map is not initialized")}},{key:"registerRoute",value:function(e,t,r){if(this.mapImpl)return this.mapImpl.registerRoute(e,t,r);throw new Error("map is not initialized")}},{key:"registerRouteDestination",value:function(){var e;if(this.mapImpl)return(e=this.mapImpl).registerRouteDestination.apply(e,arguments);throw new Error("map is not initialized")}},{key:"listRegisteredRouteDestinations",value:function(){if(this.mapImpl)return this.mapImpl.listRegisteredRouteDestinations();throw new Error("map is not initialized")}},{key:"listRegisteredRoutes",value:function(e){if(this.mapImpl)return this.mapImpl.listRegisteredRoutes(e);throw new Error("map is not initialized")}},{key:"deregisterRouteDestination",value:function(){var e;if(this.mapImpl)return(e=this.mapImpl).deregisterRouteDestination.apply(e,arguments);throw new Error("map is not initialized")}},{key:"deregisterRoute",value:function(e,t){if(this.mapImpl)return this.mapImpl.deregisterRoute(e,t);throw new Error("map is not initialized")}},{key:"showRoutes",value:function(e,t){if(this.mapImpl){for(var r,n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];return(r=this.mapImpl).showRoutes.apply(r,[e,t].concat(i))}return Promise.reject(new Error("map is not initialized"))}},{key:"hideRoutes",value:function(e,t){if(this.mapImpl){for(var r,n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];return(r=this.mapImpl).hideRoutes.apply(r,[e,t].concat(i))}return Promise.reject(new Error("map is not initialized"))}},{key:"listRoutesDisplayed",value:function(){if(this.mapImpl)return this.mapImpl.listRoutesDisplayed();thapImpl.listFeatures(e,t);throw new Error("map is not initialized")}},{key:"selectFeature",value:function(e,t,r){if(!this.mapImpl)throw new Error("map is not initialized");thrror("map is not initialized");this.mapImpl.clearSelectedFeature()}},{key:"markFeatureOver",value:function(e,t){if(!this.mapImpl)throw new Error("map is not initializew Error("map is not initialized");this.mapImpl.markFeatureOut(e,t)}},{key:"getFeatureSelected",value:function(){if(this.mapImpl)return this.mapImpl.getFeatureSelected();throw new Error("map is not initialized")}},{key:"setPopupContent",value:function(e,t,r){if(!this.mapImpl)throw new Error("map is not initialized");this.mapImpl.setPopupContent(e,t,r)}},{key:"turnProductsVisible",value:function(e,t){if(!this.mapImpl)throw new Error("map is not initialized");this.mapImpl.turnFeaturesVisible("product",e,t,!1,!0)}},{key:"turnPropertiesVisible",value:function(e,t){if(!this.mapImpl)throw new Error("map is not initialized");this.mapImpl.turnFeaturesVisible("property",e,t,!1,!0)}},{key:"turnPlacesVisible",value:function(e,t){if(!this.mapImpl)throw new Error("map is not initialized");this.mapImpl.turnFeaturesVisible("place",e,t,!1,!0)}},{key:"addBoundChangeListener",value:function(e,t){return this.eventsManager.addBoundChangeListener(e,t)}},{key:"removeBoundChangeListener",value:function(e){return this.eventsManager.removeBoundChangeListener(e)}},{key:"deregisterBoundChangeListener",value:function(e){return this.eventsManager.deregisterBoundChangeListener(e)}},{key:"addMarkerChangeListener",value:function(e,t){return this.eventsManager.addMarkerChangeListener(e,t)}},{key:"removeMarkerChangeListener",value:function(e){return this.eventsManager.removeMarkerChangeListener(e)}},{key:"deregisterMarkerChangeListener",value:function(e){return this.eventsManager.deregisterMarkerChangeListener(e)}},{key:"addSelectionChangeListener",value:function(e,t){return this.eventsManager.addSelectionChangeListener(e,t)}},{key:"removeSelectionChangeListener",value:function(e){return this.eventsManager.removeSelectionChangeListener(e)}},{key:"deregisterSelectionChangeListener",value:function(e){return this.eventsManager.deregisterSelectionChangeListener(e)}},{key:"addFilterChangeListener",value:function(e,t){return this.eventsManager.addFilterChangeListener(e,t)}},{key:"removeFilterChangeListener",value:function(e){return this.eventsManager.removeFilterChangeListener(e)}},{key:"deregisterFilterChangeListener",value:function(e){return this.eventsManager.deregisterFilterChangeListener(e)}},{key:"addHoverChangeListener",value:function(e,t){return this.eventsManager.addHoverChangeListener(e,t)}},{key:"removeHoverChangeListener",value:function(e){return this.eventsManager.removeHoverChangeListener(e)}},{key:"deregisterHoverChangeListener",value:function(e){return this.eventsManager.deregisterHoverChangeListener(e)}},{key:"addFeatureContentLoadedListener",value:function(e,t){return this.eventsManager.addFeatureContentLoadedListener(e,t)}},{key:"removeFeatureContentLoadedListener",value:function(e){return this.eventsManager.removeFeatureContentLoadedListener(e)}},{key:"deregisterFeatureContentLoadedListener",value:function(e){return this.eventsManager.deregisterFeatureContentLoadedListener(e)}},{key:"addIdleListener",value:function(e,t){return this.eventsManager.addIdleListener(e,t)}},{key:"removeIdleListener",value:function(e){return this.eventsManager.removeIdleListener(e)}},{key:"deregisterIdleListener",value:function(e){return this.eventsManager.deregisterIdleListener(e)}},{key:"addRouteChangeListener",value:function(e,t){return this.eventsManager.addRouteChangeListener(e,t)}},{key:"removeRouteChangeListener",value:function(e){return this.eventsManager.removeRouteChangeListener(e)}},{key:"deregisterRouteChangeListener",value:function(e){return this.eventsManager.deregisterRouteChangeListener(e)}},{key:"addTilesLoadedListener",value:function(e,t){return this.eventsManager.addTilesLoadedListener(e,t)}},{key:"removeTilesLoadedListener",value:function(e){return this.eventsManager.removeTilesLoadedListener(e)}},{key:"deregisterTilesLoadedListener",value:function(e){return this.eventsManager.deregisterTilesLoadedListener(e)}},{key:"addTilesContentLoadedListener",value:function(e,t){return this.eventsManager.addTilesContentLoadedListener(e,t)}},{key:"removeTilesContentLoadedListener",value:function(e){return this.eventsManager.removeTilesContentLoadedListener(e)}},{key:"deregisterTilesContentLoadedListener",value:function(e){return this.eventsManager.deregisterTiltion(e,t){return this.eventsManager.addMapTypeChangedListener(e,t)}},{key:"deregisterMapTypeChangedListener",value:function(e){return this.eventsManager.deregisterMapTypeChangedListener(e)}},{key:"setStay",value:function(e){if(this.mapImpl)return this.mapImpl.setStay(ion(){return this.mapImpl?this.mapImpl.refresh():Promise.resolve()}},{key:"turnKeyboardFeaturesMode",value:function(e){if(!this.mapImpl)throw new Error("map is not initialized");this.mapImpl.turnKeyboardFeaturesMode(e)}},{key:"isKeyboardFeaturesModeEnabled",value:function(){if(this.mapImpl)return this.mapImpl.isKeyboardFeaturesModeEnabled();throw nlper.getActiveTilesets();throw new Error("map is not initialized")}},{key:"readConfigParam",value:function(e){return this.configHelper.readParam(e)}},{key:"getSubConfig",value:function(e){retvalue:function(){return this.configHelper.getEGMapConfigurations()}},{key:"updatePartiallyFeature",value:function(e){if(this.mapImpl)return this.mapImpl.updatePartiallyFeature(e);throw new Error("map is not initialized")}},{key:"addQualifierToFeature",value:function(e,t){if(this.mapImpl){for(var r,n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];return(r=this.mapImpl).addQualifierToFeature.apply(r,[e,t].concat(i))}throw new Error("map is not initialized")}},{key:"addQualifierToFeatures",value:function(e){if(this.mapImpl){for(var t,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return(t=this.mapImpl).addQualifierToFeatures.apply(t,[e].concat(n))}throw new Error("map is not initialized")}},{key:"removeQualifierFromFeature",value:function(e,t){if(this.mapImpl){for(var r,n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];return(r=this.mapImpl).removeQualifierFromFeature.apply(r,[e,t].concat(i))}throw new Error("map is not initialized")}},{key:"removeQualifierFromFeatures",value:function(e){if(this.mapImpl){for(var t,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return(t=this.mapImpl).removeQualifierFromFeatures.apply(t,[e].concat(n))}throw new Error("map is not initialized")}}],r&&Su(t.prototype,r),n&&Su(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()}(),n}()},22676:function(e,t,r){var n;window,e.exports=(n=r(90439),function(){var e={621:function(e){e.exports=n}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,r),o.exports}r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(n){return window}}(),r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return function(){r.r(i);var e={};r.r(e),r.d(e,{GMaps:function(){return te}});var t=r(621);function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function l(){return l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=y(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},l.apply(this,arguments)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(o=void 0,o=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!==n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i.key,"string"),"symbol"===n(o)?o:String(o)),i)}var o}function d(e,t,r){return t&&f(e.prototype,t),r&&f(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}function p(e,t){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},p(e,t)}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,i=y(e);if(t){var o=y(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}var g=t.Utils.firstDefinedValue,m=t.Utils.firstDefinedValueAndKey,b=t.Utils.firstDefinedKey,k=t.Utils.removeDuplicates,w=t.Utils.roundLatOrLng,C=t.Utils.roundLatLng,P=t.Utils.isArray,L=t.Utils.getPaddedZoomAndCenter,x=t.Utils.roundZoom,M=t.Geo.computeZoomFromBBox,F=t.Geo.addMeterToLat,_=t.MarkerUtils.setAccessibilityFields,O=t.MarkerUtils.createCornerIcons,S=t.MarkerUtils.createInnerIcons,E=t.MarkerUtils.createDoubleClickEventCanceller,I=t.MarkerUtils.createImageIcon,A=t.MarkerUtils.createBasicTextMarker,T=t.Labels.createLabels,B=256,D=256,j=function(e){h(r,e);var t=v(r);function r(e,n,i,o,a,s){var u;return c(this,r),(u=t.call(this,e,n,i,o,a,s,0)).tileSize=new google.maps.Size(B,D),u.debugTileId=e.tiles.debugTileId,u}return {var n=this;if(setTimeout((function(){return n.loadTile(e.x,e.y,t)}),10),this.debugTileId){var i=r.createElement("div");return i.innerHTML=String(e),i.style.width=this.tileSize.width+"px",i.style.height=this.tileSize.height+"px",i.style.fontSize="10",i.style.borderStyle="solid",i.style.borderWi:function(){this.getPanes().overlayMouseTarget.removeAllChildren()}}]),r}(t.TilesLoader),R={type:"click",dom:!0},N={type:"dragstart",dom:!1},V={type:"click",dom:!0},U={type:"center_changed",dom:!1},z={type:"bounds_changed",dom:!1},K={type:"zoom_changed",dom:!1},H={type:"mouseenter",dom:!0},Z={type:"mouseleave",dom:!0},q={type:"tilesloaded",dom:!1},W={type:"idle",dom:!1},G={type:"focus",dom:!0},Q={type:"focusout",dom:!0},$={type:"keydown",dom:!0},X={type:"keyup",dom:!0},Y={type:"keypress",dom:!0},J={type:"maptypeid_changed",dom:!1},ee="marker-icon",te=function(e){h(n,e);var r=v(n);function n(e,t,i,o){var a;return c(this,n),(a=r.call(this,e,t,i,o)).logger=e.logger("GMaps"),a.logger.debug("GMaps constructor"),a.mapFocusListenersToRegister=[],a}return d(n,[{key:"_buildMapProviderOptions",value:function(e,t){var r,n={keyboardShortcuts:!1};return null!==(r=this.settings.googleMaps)&&void 0!==r&&r.gmapsAddConfig&&Object.assign(n,this.settings.googleMaps.gmapsAddConfig),e&&t&&(n.zoom=e,n.center={lat:t[0],lng:t[1]}),n}},{key:"updateMapProviderConfig",value:function(){var e=this._buildMapProviderOptions(this.realmap.getZoom(),this.getCenter());this.realmap.setOptions(e)}},{key:"removeMarkerFromMap",value:function(e){t.HtmlUtils.detachElement(e),e.debug&&e.debug.setMap(null),e.clean.forEach((function(e){return e()}))}},{key:"cloneMarker",value:function(e){return null==e?void 0:e.clone()}},{key:"_callbackWhenElementReattached",value:function(){var e=this;return new Promise((function(t){setTimeout((function(){var r=e.temporaryDiv;e.temporaryDiv=void 0,e._reattachElementFromTemporaryDiv(r,e.customMarkerOverlay.getPanes().overlayMouseTarget),e._updateViewport(),t()}),20)}))}},{key:"init",value:function(e,r){var n=this,i=this.addEventListener.bind(this),o=this._zoomAndCenterFromViewport(e,r)||{},a=o.zoom,s=o.center,u=this._buildMapProviderOptions(a,s);return this.node&&(this.realmap=new google.maps.Map(this.node,u)),this._registerListenersMap(),this._initializeTilesOverlayMapType(),t.HtmlUtils.documentIsDefined()&&(this.temporaryDiv=t.HtmlUtils.createDiv(this.uniqId("temporaryDiv"))),this.popup=this._createPopup(),this._initializeCustomMarkerOverlay(this.temporaryDiv,this._callbackWhenElementReattached.bind(this)).then((function(){n.mapNavFocusElement=n._findMapFocusElement(),n.mapNavFocusElement&&n.mapFocusListenersToRegister.forEach((function(e){var t=e.eventDef,r=e.cb;n.listenersToDeregister.push(i(n.mapNavFocusElement,t,r))})),n._registerKeyboardListeners(),n._registerMapFocusListeners(),n._registerTilesLoadedListener(),n._updateViewport()})),this.configHelper.readParam("map,mapInitWaitForTiles")?new Promise((function(e){return i(n.realmap,q,e,!0)})):Promise.resolve()}},{key:"_findMapFocusElement",value:function(){var e;if(this.node)return null===(e=t.HtmlUtils.childrenAsArray(this.node).map((function(e){var r;return null===(r=t.HtmlUtils.anyChildrenWithClasses(e,["gm-style"],!1)[0])||void 0===r?void 0:r.element})).filter((function(e){return void 0!==e}))[0])||void 0===e?void 0:e.children[0]}},{key:"registerListenerOnMapFocusElement",value:function(e,t){this.mapNavFocusElement?this.listenersToDeregister.push(this.addEventListener(this.mapNavFocusElement,e,t)):this.mapFocusListenersToRegister.push({eventDef:e,cb:t})}},{key:"_registerMapFocusListeners",value:function(){var e=this;this.keyboardFeatures&&this.mapNavFocusElement&&(this.listenersToDeregister.push(this.addEventListener(this.mapNavFocusElement,G,(function(){return e.keyboardFeatures.refreshKeyboardNavIconVisibility()}))),this.listenersToDeregister.push(this.addEventListener(this.mapNavFocusElement,Q,(function(){return e.keyboardFeatures.refreshKeyboardNavIconVisibility(!1)}))))}},{key:"_registerTilesLoadedListener",value:function(){var e=this;thlmap,q,(function(){return e.handleTilesLoaded("mapProvider","map")})))}},{key:"_initializeTilesOverlayMapType",value:function(){var e;this.tilesLoader=new j(this.settings,this.createTileFeature.bind(this),this.removeTileFeature.bind(this),this._updateViewport.bind(this),this.handleTilesLoaded.bind(this),this.handleTilesContentLoaded.bind(this)),null===(e=this.realmap)||void 0===e||null===(e=e.overlayMapTypes)||void 0===e||e.insertAt(0,this.tilesLoader)}},{key:"_reattachElementFromTemporaryDiv",value:function(e,r){if(e)for(var n=e.children,i=0;i<((null==n?void 0:n.length)||-1);i++)t.HtmlUtils.reattachElement(n[i],r)}},{key:"_initializeCustomMarkerOverlay",value:function(e,r){var n=this,i=this._updateMarkerPosition.bind(this),o=this.features.all.bind(this),a=function(n,i,o,a,u){this.updateTextMarkerPosition=i,this.listAllFeatures=o,this.onAdd=function(){var n=this.getPanes().overlayMouseTarget;a(e),t.HtmlUtils.setZIndex(n,google.maps.Marker.MAX_ZINDEX+1),r(),u()},thisFeatures().forEach((function(e){t.HtmlUtils.detachElement(e.popup)}));var e,r=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=s(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){u=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw o}}}}(this.clusters);try{for(r.s();!(e=r.n()).done;){var n=e.value;t.HtmlUtilsnally{r.f()}},this.draw=function(){this.updateTextMarkerPosition()}};return a.prototype=new google.maps.OverlayView,new Promise((function(e){n.customMarkerOverlay=new a(n.realmap,i,o,n._reattachElementFromTemporaryDiv.bind(n),e)}))}},{key:"getMarkerComponent",value:function(e){return e.marker}},{key:"moveMarkerPosition",value:function(e,t){var r=this.customMarkerOverlay.getProjection(),n=r.fromLatLngToDivPixel(new google.maps.LatLng(e.latLng[0],e.latLng[1])),i={x:n.x+t.x,y:n.y+t.y},o=r.fromDivPixelToLatLng(i);e.latLng[0]=o.lat(),e.latLng[1]=o.lng(),e.computedLatLng=[o.lat(),o.lng()],this.getMarkerComponent(e).position=o,this._updateMarkerPositionOnLayer(e,r)}},{key:"_updateViewport",value:function(e){var t,r=this;return null!==(t=this.customMarkerOverlay)&&void 0!==t&&null!==(t=t.getPanes())&&void 0!==t&&t.overlayMouseTarget?l(y(n.prototype),"_updateViewport",this).call(this,e).then((function(e){return r._updateMarkerPosition(),e})):Promise.resolve(e)}},{key:"getRectOfMarker",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.customMarkerOverlay.getProjection(),i=e.computedLatLng&&e.computedLatLng[0]?e.computedLatLng[0]:e.latLng[0],o=e.computedLatLng&&e.computedLatLng[1]?e.computedLatLng[1]:e.latLng[1],a=n.fromLatLngToDivPixel(new google.maps.LatLng(i,o)),s=this.getMarkerComponent(e),u=s.clientWidth,l=s.clientHeight;return t.HtmlUtils.getRect(a,u+2*r,l+2*r)}},{key:"_updateMarkerPosition",value:function(e){var t=this;if(this.customMarkerOverlay){var r=this.customMarkerOverlay.getProjection();if(r){var i=e?e.filter((function(e){return t.getMarkerComponent(e)})):this.features.all().filter((function(e){return t.getMarkerComponent(e)})).concat(this.clusters||[]);if(this.settings.isAtLeastOnePropertyStatusUsingObfuscateMarker||this.settings.isAtLeastOneProductStatusUsingObfuscateMarker){var o=this.getCenter();Object.values(this.settings.obfuscateRadiusInMeters).forEach((function(e){var n=[w(F(o[0],2*e.radius)),o[1]];e.width=Math.round(t._fromLatLngToDivPixel.apply(t,[r].concat(a(o))}i.forEach((function(e){return t._updateMarkerPositionOnLayer(e,r)})),l(y(n.prototype),"_updateMarkerPosition",this).call(this,i),this.updatePopupPositionOnLayer()}}}},{key:"_updateMarkerPositionOnLayer",value:function(e,r){if(e&&this.getMarkerComponent(e)&&r){var n=r.fromLatLngToDivPixel(this.getMarkerComponent(e).position);if(n){var i="middle";switch(e.markerType){case"pin":case"price":case"text":i="bottom"}t.HtmlUtils.setPosition(this.getMarkerComponent(e),n.x+0,n.y+0,i)}}}},{key:"_fromLatLngToDivPixel",value:function(e,t,r){return null==e?void 0:e.fromLatLngToDivPixel(new google.maps.LatLng(t,r))}},{key:"_fromDivPixelToLatLng",value:function(e,t,r){return null==e?void 0:e.fromDivPixelToLatLng(new google.maps.Point(t,r))}},{key:"updatePopupPositionOnLayer",value:function(){var e,r=(this.popup||{}).feature;if(null!==(e=this.customMarkerOverlay)&&void 0!==e&&e.getProjection()&&r&&r.defined){var n,i,o,s=this._fromLatLngToDivPixel.apply(this,[this.customMarkerOverlay.getProjection()].concat(a(r.latLng)));switch(g(this.settings.popupPositions[r.type],r.hashKeys)){case"above":default:n=0,i=-2,o="bottom";break;case"below":n=0,i=2,o="top"}s&&t.HtmlUtils.setPosition(this.popup,s.x+n,s.y+i,o)}}},{key:"ensurePopupVisibility",value:function(){var e=this.popup,t=e.feature,r=e.offsetWidth,n=e.offsetHeight,i=this.node,s=i.offsetWidth,u=i.offsetHeight,l=g(this.configHelper.popupVisibilityPaddings()[t.type],t.hashKeys),c=null==l?void 0:l.x,f=null==l?void 0:l.y,d="below"===g(this.settings.popupPositions[t.type],t.hashKeys),h=d?1:-1,p=this.getRectOfMarker(t).height,v=this._fromLatLngToDivPixel.apply(this,[this.customMarkerOverlay.getProjection()].concat(a(t.latLng))),y={x:v.x+s/2-r/2,y:v.y+p*h+u/2+n*h},m=o(this._calculatePopupVisibilityOffsetValues(y,c,f,s,u,r,n,d),2),b=m[0],k=m[1];0===b&&0===k||this.realmap.panBy(b,k)}},{key:"_registerListenersMap",value:function(){var e=this;this._registerListenerForIdle(),this._registerCenterChangedEventLogic(),this._registerZoomListener(),this.listenersToDeregister.push(this.addEventListener(this.realmap,N,this.handleDragStart.bind(this))),this.listenersToDeregister.push(this.addEventListener(this.node,V,this.handleMapClick.bind(this))),this.listenersToDeregister.push(this.addEventListener(this.realmap,J,function(){e.eventsManager.pushEvent(t.EventTypes.mapTypeChanged,{mapTypeId:e.realmap.getMapTypeId()})}.bind(this)))}},{key:"_registerListenerForIdle",value:function(){this.idle=!0;var e=this;th(function(){e.idle=!0,e.eventsManager.pushEvent(t.EventTypes.idle)}))),th(this.addEventListener(this.realmap,z,(function(){return e.idle=!1})))}},{key:"_registerKeyboardListeners",value:function(){var e=this,r=this.getZoom.bind(this);return this.registeredEvents={ksteners((function(t){var r;return(r=e.realmap).panBy.apply(r,a(t))}),(function(){return e.realmap.setZoom(r()+1)}),(function(){return e.realmap.setZoom(r()-1)}),this.registeredEvents.keyboardFeatures),[this.addEventListener(this.mapNavFocusElement,$,this.keyboardListeners.keyDownListenerCallback),this.addEventListener(this.mapNavFocusElement,X,this.keyboardListeners.keyUpListenerCallback),this.addEventListener(this.mapNavFocusElement,Y,this.keyboardListeners.keyPressListenerCallback)]}},{key:"_registerCenterChangedEventLogic",value:function(){var e=this;this.listenersToDeregister.push(this.addEventListener(this.realmap,U,(function(){void 0===e.mapViewportInfoBeforeIdle&&(e.mapViewportInfoBeforeIdle={center:e.getCenter(),zoom:e.getZoom()})}))),this.listenersToDeregister.push(this.addEventListener(this.realmap,W,(function(){if(void 0!==e.mapViewportInfoBeforeIdle){var t=e.getCenter(),r=e.handleBoundsChanged.bind(e);setTimeout((function(){var n=e.getCenter();if(n[0]===t[0]&&n[1]===t[1]){var i,o,a,s,u=null!==(i=e.getZoom()-(null===(o=e.mapViewportInfoBeforeIdle)||void 0===o?void 0:o.zoom))&&void 0!==i?i:0,l=null===(a=e.mapViewportInfoBeforeIdle)||void 0===a?void 0:a.center;e.mapViewportInfoBeforeIdle=void 0;var c=((null===(s=e.registeredEvents)||void 0===s?void 0:s.keyboardFeatures)||[]).splice(0);0!==u||!l||n[0]===l[0]&&n[1]===l[1]||(c.length>0?k(c).forEach(r):r("drag"))}}),50)}})))}},{key:"_registerZoomListener",value:function(){var e=this;this.lastZoomValueChecked=[this.getZoom()],this.listenersToDeregister.push(this.addEventListener(this.realmap,K,(function(){e.boundChangedDisabled?e.lastZoomValueChecked=[e.getZoom()]:e.lastZoomValueChecked.push(e.getZoom())}))),this.listenersToDeregister.push(this.addEventListener(this.realmap,W,(function(){if(e.lastZoomValueChecked.length>1){var t=e.getZoom(),r=e.handleBoundsChanged.bind(e);setTimeout((function(){var n=e.getZoom();if(n===t){var i,a=n>o(e.lastZoomValueChecked.splice(0,e.lastZoomValueChecked.length-1),1)[0],s=((null===(i=e.registeredEvents)||void 0===i?void 0:i.keyboardFeatures)||[]).splice(0);s.length>0?k(s).forEach(r):a?e.handleBoundsChanged("zoomIn"):e.handleBoundsChanged("zoomOut")}}),100)}})))}},{key:"_createCallbackForBoundsChanged"=this.handleBoundsChanged.bind(this);return function(){return t(e)}}},{key:"centerAndZoomMap",value:function(e,t,r){var n=o(e?C(e):[],2),i=n[0],a=n[1],s=t?x(t):void 0;if(void 0!==i&&void 0!==a&&void 0!==s&&void 0!==r){var u=this._parseClientPadding(r),l=this._getPaddedZoomAndCenterForCenterAndZoom(e,s,u)||{},c=l.zoom,f=l.center;if(void 0!==c&&void 0!==f){var d=o(f,2);i=d[0],a=d[1],s=c}}var h=this.realmap.getCenter(),p=o(C([h.lat(),h.lng()])||[],2),v=p[0],y=p[1],g=void 0!==i&&void 0!==a&&(v!==i||y!==a)||void 0!==s&&this.getZoom()!==s;return g&&this._fitViewport(s,[i,a],!1).then(this._updateViewport.bind(this)),g}},{key:"isFeatureInRealBound",value:function(e,t){return null==e?void 0:e.contains({lat:t.latLng[0],lng:t.latLng[1]})}},{key:"asNativeBounds",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return new google.maps.LatLngBounds(new google.maps.LatLng(w(e[0]),w(e[1],void 0,r)),new google.maps.LatLng(w(t[0]),w(t[1],void 0,r)))}},{key:"getCenter",value:function(){var e=this.realmap.getCenter();return[w(e.lat()),w(e.lng())]}},{key:"getZoom",value:function(){return x(this.realmap.getZoom())}},{key:"unbindAll",value:function(){this.listenersToDeregister.forEach((function(e){return e()})),this.customMarkerOverlay&&this.customMarkerOverlay.unbindAll(),this.realmap.unbindAll()}},{key:"asBounds",value:function(e){if(e){var t=e.getSouthWest(),r=e.getNorthEast(),n=this.getCenter();return{sw:[w(t.lat()),w(t.lng())],ne:[w(r.lat()),w(r.lng())],center:n}}}},{key:"containerBounds",value:function(e){if(this.customMarkerOverlay){var t=this.customMarkerOverlay.getProjection();if(t){var r=t.fromContainerPixelToLatLng(new google.maps.Point(e.offsetLeft-e.offsetWidth/2,e.offsetTop+e.offsetHeight/2)),n=t.fromContainerPixelToLatLng(new google.maps.Point(e.offsetLeft+e.offsetWidth/2,e.offsetTop-e.offsetHeight/2));return{sw:[w(r.lat()),w(r.lng())],ne:[w(n.lat()),w(n.lng())],center:[w(r.lat()+(r.lat()-n.lat())/2),w(n.lnvalue:function(e){return e.getNorthEast().equals(e.getSouthWest())}},{key:"_extendsOneCoordinateBounds",value:function(e){var t=new google.maps.LatLng(e.getNorthEast().lat()+.01,e.getNorthEast().lng()+.01),r=new google.maps.LatLng(e.getNorthEast().lat()-.01,e.getNorthEast().lng()-.01);e.extend(t),e.extend(r)}},{key:"computeNativeBoundsFromLatLongs",value:function(e){if(e.length>0){var t=new google.maps.LatLngBounds;return e.forEach((function(e){var r=o(C(e),2),n=r[0],i=r[1];t.extend(new google.maps.LatLng(n,i))})),t}}},{key:"fitLatLongs",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3?arguments[3]:void 0;if(this.realmap){var i=this._parseClientPadding(n),o=this._getPaddedZoomAndCenterFromLatLongs(e,r,i)||{},a=o.zoom,s=o.center;if(void 0!==a&&void 0!==s){var u=this._updateViewport.bind(this),l=this.asBounds.bind(this);return this._fitViewport(a,s,t).then(u).then(l)}return Promise.resolve(this.getBounds())}return Promise.reject("map is not ready")}},{key:"nativeBounds",value:function(){var e,t;return(null===(e=this.customMarkerOverlay)||void 0===e||null===(e=e.getProjection())||void 0===e||null===(e=e.getVisibleRegion())||void 0===e?void 0:e.latLngBounds)||(null===(t=this.realmap)||void 0===t?void 0:t.getBounds())}},{key:"switchMarkerType",value:function(e,t){l(y(n.prototype),"switchMarkerType",this).call(this,e,t)&&this.customMarkerOverlay&&this._updateMarkerPositionOnLayer(e,this.custoeMarkerPositionOnLayer(e,this.customMarkerOverlay.getProjection())}},{key:"_fitViewport",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(void 0!==e||t){var i=this.nativeBounds.bind(this),o=this,a=this.realmap,s=this.addEventListener.bind(this),u=function(){return new Promise((functingedDisabled=!n,s(a,W,(function(){o.boundChangedDisabled=!1,u(i())}),!0),a.setZoom(e)):u(i())};t?(o.boundChangedDisabled=!n,r.addEventListener(a,W,l,!0),a.setCenter(new google.maps.LatLng(t[0],t[1]))):w Promise((function(e){return s(a,W,(function(){return u().then(e)}),!0)}))}return Promise.resolve()}},{key:"_zoomAndCenterFromViewport",value:function(e,t){if(e){var r=e.center,n=e.zoom,i=e.sw,o=e.ne,a=e.coordinates,s=e.useBoundsComputation,u=e.options,l=this._parseClientPadding(t);if(r&&n)return this._getPaddedZoomAndCenterForCenterAndZoom(r,n,l);if(i&&o){var c=C(i),f=C(o);return this._getPaddedZoomAndCenterForBounds(c,f,!1,l)}if(a&&s){var d=this._computeNativeBounds(a,s,u),h=this._computeZoomAndCenterFromGmapsBounds(d,!1,l)||{},p=h.zoom,v=h.center;if(p&&v)return L(p,v,l)}else if(P(e)&&e.length>0)return this._getPaddedZoomAndCenterFromLatLoomAndCenterForCenterAndZoom",value:function(e,t,r){return L(t,e,r)}},{key:"_getPaddedZoomAndCenterForBounds",value:function(e,t,r,n){var i=new google.maps.LatLngBounds(new google.maps.LatLng(e[0],e[1]),new google.maps.LatLng(t[0],t[1])),o=this._computeZoomAndCenterFromGmapsBounds(i,r,n)||{},a=o.zoom,s=o.center;if(a&&s)return L(a,s,n)}},{key:"_getPaddedZoomAndCenterFromLatLongs",value:function(e,t,r){var n=this._computeZoomAndCenterFromGmapsBounds(this.computeNativeBoundsFromLatLongs(this.boundsComputation.computeBoundingBox(e)),t,r)||{},i=n.zoom,o=n.center;if(i&&o)return L(i,o,r)}},{key:"_computeZoomAndCenterFromGmapsBounds",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0,n=e;this._boundsForOneCoordinate(n)&&(n=new google.maps.LatLngBounds(n.getSouthWest(),n.getNorthEast()),this._extendsOneCoordinateBounds(n));var i=M(this.node,n.getSouthWest().lat(),n.getSouthWest().lng(),n.getNorthEast().lat(),n.getNorthEast().lng(),{zoomMax:21,padding:t?this.settings.googleMaps.padding:0,parsedClientPadding:r});if(isFinite(i))return{zoom:i,center:C([n)])}}},{key:"getTileDim",value:function(){return{width:B,height:D}}},{key:"fitBounds",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4?arguments[4]:void 0;if(this.realmap){var a=this._parseClientPadding(i),s=C(e),u=C(t),l=this._getPaddedZoomAndCenterForBounds(s,u,n,a)||{},c=l.zoom,f=l.center;if(void 0!==c&&void 0!==f){var d=this.getZoom(),h=o(this.getCenter(),2),p=h[0],v=h[1];if(p!==f[0]||v!==f[1]||d!==c){var y=this._updateViewport.bind(this),g=this.asBounds.bind(this);return this._fitViewport(c,f,r).then(y).then(g)}}return Promise.resolve(this.getBounds())}return Promise.reject("map is not ready")}},{key:"addEventListener",value:function(e,t,r){var n,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return!t.dom||e instanceof google.maps.Polygon?(n=i?google.maps.event.ad(e,t.type,r),function(){return google.maps.event.removeListener(n)}):(i?e.addEventListenerOnce(t.type,r):e.addEventListener(t.type,r),function(){return e.removeEventListener(t.type,r)})}},{key:"_createPopup",value:function(){var e=this._createGenericPopup(this._getMainParent());return t.HtmlUtils.setZIndex(e,this.settings.maxZIndex+1),t.HtmlUtils.setDisplayNone(e),e.visibleElement=e,e.cssElement=e,e.clean=[].concat(a(this.registerCompListeners(e,"popup")),[E(e,this.addEventListener.bind(this))]),e}},{key:"registerCompListeners",value:function(e,r,n){var i=this,o=this.handleMarkerClick.bind(this),a=this.handleMarkerMouseOver.bind(this),s=this.handleMarkerMouseOut.bind(this),u=function(e,r){t.HtmlUtils.isAnHtmlElement(e)&&r.stopPropagation(),r.stop&&(r.stop(),i.ignoreMapClickEvent=!0)};return[this.addEventListener(e,R,(function(t){u(e,t),o(n,r,t.type)})),this.addEventListener(e,H,(function(t){u(e,t),a(n,r,t.type)})),this.addEventListener(e,Z,(function(t){u(e,t),s(n,r,t.type)})),E(e,this.addEventListener.bind(this))]}},{key:"_createDebugMarker",value:function(e){return this.settings.debugMarkersPosition?{debug:new google.maps.Marker({position:new google.maps.LatLng(e.latLng[0],e.latLng[1]),map:this.realmap}),style:"opacity: 0.5"}:{}}},{key:"clearObfuscateArea",value:function(e){var t,r,n;null!=e&&null!==(t=e.marker)&&void 0!==t&&null!==(t=t.obfuscateArea)&&void 0!==t&&t.setMap&&(null==e||null===(n=e.marker)||void 0===n||null===(n=n.obfuscateArea)||void 0===n||n.setMap(null)),null==e||null===(r=e.marker)||void 0===r||delete r.obfuscateArea}},{key:"_createObfuscatedPolygon",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.getCirclePolygonData(e);return new google.maps.Polygon({paths:r,map:this.realmap.data.getMap(),clickable:t})}},{key:"_updateObfuscateAreaStyle",value:function(e,t){var r,n,i,o,a,s=m(this.settings.obfuscateStyle[e.type],e.hashKeys),u=s.key,l=s.value;t.setOptions({fillColor:null==l||null===(r=l.fill)||void 0===r?void 0:r.color,fillOpacity:null==l||null===(n=l.fill)||void 0===n?void 0:n.opacity,strokeColor:null==l||null===(i=l.line)||void 0===i?void 0:i.color,strokeOpacity:null==l||null===(o=l.line)||void 0===o?void 0:o.opacity,strokeWeight:null==l||null===(a=l.line)||void 0===a?void 0:a.weight}),t.styleKey=u}},{key:"hasObfuscateAreaStyleChanged",value:function(e){var t,r;return(null===(t=this.getMarkerComponent(e))||void 0===t?void 0:t.obfuscateArea)&&(null===(r=this.getMarkerComponent(e))||void 0===r||null===(r=r.obfuscateArea)||void 0===r?void 0:r.styleKey)!==b(this.settings.obfuscateStyle[e.type],e.hashKeys)}},{key:"_getMainParent",value:function(){var e;return(null===(e=this.customMarkerOverlay)||void 0===e||null===(e=e.getPanes())||void 0===e?void 0:e.overlayMouseTarget)||this.temporaryDiv}},{key:"createPinMarkerWithClickListener",value:function(e,r,n){var i=e.feature,o=e.cornerIcons,a=e.innerIcons,s=e.cssClasses,u=e.zIndex,l=e.label,c=e.subLabel,f=e.ariaLabels,d=this._createDebugMarker(i),h=d.debug,p=d.style,v=this.uniqId("marker-".concat(this.asKey(i))),y="".concat(s.join(" ")).concat("none"!==n?" frame-".concat(n):""),g=t.HtmlUtils.createDiv(v,this._getMainParent(),y,p),m=I(r,g,n,!0,ee),b=m.iconImg,k=m.main;return g.frameIcon=n,t.HtmlUtils.setAriaHidden(k),g.iconElements={cornerIcons:o,innerIcons:a},O(g,o),S(b,a),t.HtmlUtils.setZIndex(g,u),g.ariaElement=g,_(i.highlighted,g.ariaElement,f),g.zIndexElement=g,g.iconElements.pin=k,g.clone=function(){return g.cloneNode(!0)},g.bounceElement=k,g.cssElement=g,g.labels={textLblCont:g},T(g,i,l,c,this.settings,this._zIndexAdjustment),g.clean=this.registerCompListeners(g,"pin",i),g.position=new google.maps.LatLng(i.latLng[0],i.latLng[1]),g.debug=h,g}},{key:"createTextMarkerWithClickListener",value:function(e,r,n){var i=e.feature,o=e.cornerIcons,a=e.innerIcons,s=e.cssClasses,u=e.zIndex,l=e.label,c=e.subLabel,f=e.ariaLabels,d=this._createDebugMarker(i),h=d.debug,p=d.style,v=this.uniqId("marker-".concat(this.asKey(i))),y=A(v,this._getMainParent(),n,null==s?void 0:s.join(" "),r,p),g=y.main,m=y.text,b=y.span;return g.iconElements={cornerIcons:o,innerIcons:a},O(m,o),S(b,a),t.HtmlUtils.setZIndex(g,u),g.ariaElement=m,_(i.highlighted,g.ariaElement,f),g.zIndexElement=g,g.clone=function(){return g.cloneNode(!0)},g.bounceElement=m,g.cssElement=g,g.labels={textLblCont:g},g.label=r,T(g,i,l,c,this.settings,this._zIndexAdjustment.bind(this)),g.clean=this.registerCompListeners(g,n,i),g.position=new google.maps.LatLng(i.latLng[0],i.latLng[1]),g.debug=h,g}},{key:"createClusterMarkerWithClickListener",value:function(e,r,n,i){var o=this._createDebugMarker(e),a=o.debug,s=o.style,u=this._createClusterMarker(this._getMainParent(),e,r,n,i,s);u.clone=function(){return u.cloneNode(!0)};var l=g(this.settings.zIndexes[e.type],e.hashKeys);return t.HtmlUtils.setZIndex(u,l),u.zIndexElement=u,u.clean=this.registerCompListeners(u,"clusterMarker",e),u.position=new google.maps.LatLng(e.latLng[0],e.latLng[1]),u.debug=a,u}},{key:"createObfuscateMarkerWithClickListener",value:function(e){var r=this,n=e.feature,i=e.cssClasses,o=e.zIndex,a=e.label,s=e.subLabel,u=e.ariaLabels,l=this._createDebugMarker(n),c=l.debug,f=l.style,d=this.uniqId("marker-".concat(this.asKey(n))),h=t.HtmlUtils.createDiv(d,this._getMainParent(),i.join(" "),f),p=this._createObfuscatedPolygon(n,!0);return this._updateObfuscateAreaStyle(n,p),t.HtmlUtils.setZIndex(h,o),h.ariaElement=h,_(n.highlighted,h.ariaElement,u),h.zIndexElement=h,h.cssElement=h,h.labels={textLblCont:h},T(h,n,a,s,this.settings,this._zIndexAdjustment),h.clean=this.registerCompListeners(p,"obfuscate",n),h.position=new google.maps.LatLng(n.latLng[0],n.latLng[1]),h.clone=function(){return r.cloneObfuscatedPolygon(n,h)},h.obfuscateArea=p,h.debug=c,h}},{key:"createPinObfuscateMarkerWithClickListener",value:function(e,r,n){var i=this,o=e.feature,a=e.cornerIcons,s=e.innerIcons,u=e.cssClasses,l=e.zIndex,c=e.label,f=e.subLabel,d=e.ariaLabels,h=this._createDebugMarker(o),p=h.debug,v=h.style,y=this.uniqId("marker-".concat(this.asKey(o))),g="".concat(u.join(" ")).concat("none"!==n?" frame-".concat(n):""),m=t.HtmlUtils.createDiv(y,this._getMainParent(),g,v),b=t.HtmlUtils.createDiv(void 0,m,"pin-marker"),k=t.HtmlUtils.createDiv(void 0,b,"marker-icon-inter");t.HtmlUtils.setAriaHidden(k);var w=I(r,k,n,!0,ee),C=w.iconImg,P=w.main;m.frameIcon=n,m.iconElements={cornerIcons:a,innerIcons:s},O(k,a),S(C,s);var L=this._createObfuscatedPolygon(o);return this._updateObfuscateAreaStyle(o,L),t.HtmlUtils.setZIndex(b,l),m.ariaElement=b,_(o.highlighted,m.ariaElement,d),m.zIndexElement=b,m.bounceElement=P,m.cssElement=m,m.labels={textLblCont:t.HtmlUtils.isAnHtmlElement(r)?P:k},m.iconElements.pin=P,m.obfuscateArea=L,m.clone=function(){return i.cloneObfuscatedPolygon(o,m)},T(m,o,c,f,this.settings,this._zIndexAdjustment),m.clean=this.registerCompListeners(b,"pinObfuscate",o),m.position=new google.maps.LatLng(o.latLng[0],o.latLng[1]),m.debug=p,m}},{key:"createPriceObfuscateMarkerWithClickListener",value:function(e,r){var n=this,i=e.feature,o=e.cornerIcons,a=e.innerIcons,s=e.cssClasses,u=e.zIndex,l=e.label,c=e.subLabel,f=e.ariaLabels,d=this._createDebugMarker(i),h=d.debug,p=d.style,v=this.uniqId("marker-".concat(this.asKey(i))),y=t.HtmlUtils.createDiv(v,this._getMainParent(),s.join(" "),p),g=A(v,y,"price","price-marker",r),m=g.main,b=g.text,k=g.span;y.iconElements={cornerIcons:o,innerIcons:a},O(b,o),S(k,a);var w=this._createObfuscatedPolygon(i);return this._updateObfuscateAreaStyle(i,w),t.HtmlUtils.setZIndex(m,u),y.ariaElement=b,_(i.highlighted,y.ariaElement,f),y.zIndexElement=m,y.bounceElement=b,y.cssElement=y,y.labels={textLblCont:m},y.clean=this.registerCompListeners(m,"priceObfuscate",i),y.position=new google.maps.LatLng(i.latLng[0],i.latLng[1]),y.obfuscateArea=w,y.clone=function(){return n.cloneObfuscatedPolygon(i,y)},y.label=r,T(y,i,l,c,this.settings,this._zIndexAdjustment),y.debug=h,y}},{key:"resetRouteStyle",value:function(){}},{key:"_createPolyline",value:function(e,t,r){var n={path:e,geodesic:null!=r&&r};switch(t.lineStyle){case"none":break;case"dash":n.icons=[{icon:{path:"M 0,-1 0,1",fillColor:t.color,fillOpacity:t.opacity,strokeColor:t.color,strokeOpacity:t.opacity,scale:t.width},offset:"0",repeat:"".concat(4*t.width,"px")}],n.strokeOpacity=0;break;case"dot":n.icons=[{icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:t.color,fillOpacity:t.opacity,strokeColor:t.color,strokeOpacity:t.opacity,scale:t.width/2},offset:"0",repeat:"".concat(2*t.width,"px")}],n.strokeOpacity=0;break;default:n.strokeColor=t.color,n.strokeWeight=t.width,n.strokeOpacity=t.opacity}return new google.maps.Polyline(n)}},{key:"addRouteOnMap",value:function(e,t){var r=this;return new Promise((function(n){var i;null===(i=t.route)||void 0===i||delete i.copyrights;var o="flying"==e.mode;e.polyline=r._createPolyline(t.route.path,r.settings.routeLineStyleByDistanceMode[e.mode],o),e.polyline.setMap(r.realmap),n(e)}))}},{key:"removeRouteOnMap",value:function(e){return new Promise((function(t){var r;null===(r=e.polyline)|justment",value:function(e){return google.maps.Marker.MAX_ZINDEX+e}}]),n}(t.BaseMap);window.egmapsGoogleMaps=e}(),i}())},11921:funct.exporporn)&&returnr.o={value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return function(){r.r(i);var e={};r.r(e),r.d(e,{MapBox:function(){return ve}});var t=r(621),n=6371008.8,o={centimeters:637100880,centimetres:637100880,degrees:57.22891354143274,feet:20902260.511392,inches:39.37*n,kilometers:6371.0088,kilometres:6371.0088,meters:n,metres:n,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:n/1852,radians:1,yards:6967335.223679999};function a(e,t,r){void 0===r&&(r={});var n={type:"Feature"};return(0===r.id||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=t||{},n.geometry=e,n}function s(e,t,r){if(void 0===r&&(r={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!h(e[0])||!h(e[1]))throw new Error("coordinatear r=o[t];if(!r)throw new Error(t+" units is invalid");return e*r}function c(e,t){void 0===t&&(t="kilometers");var r=o[t];if(!r)throw new Error(t+" units is invalid");return e/r}function f(e){return e%(2*Math.PI)*180/Math.PI}function d(e){return e%360*Matow new Error("coord must be GeoJSON Point or an Array of numbers")}function v(e,t,r){if(void 0===r&&(r={}),!0===r.final)return function(e,t){var r=v(t,e);return(r+180)%360}(e,t);var n=p(e),i=p(t),o=d(n[0]),a=d(i[0]),s=d(n[1]),u=d(i[1]),l=Math.sin(a-o)*Math.cos(u),c=Math.cos(s)*Math.sinh.coscos(u);return l(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),r.units)};function m(e,t,r){void 0===r&&(r={});for(var n,i=("Feature"===(n=e).type?n.geometry:n).coordinates,o=0,a=0;a<i.length&&!(t>=o&&a===i.length-1);a++){if(o>=t){var u=t-o;if(u){var l=v(i[a],i[a-1])-180;return y(i[anates[l];if(!1===t(a({type:s,coordinates:c},n),r,l))re],e.pr(e,(function(e,o,a,s,u){n=!1===i&&void 0===r?e:t(n,e,o,a,s,u),i=!0})),n}function P(e){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P(e)}function L(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?L(Object(r),!0).forEach((function(t){S(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function M(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||_(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(e){return function(e){if(Array.isArray(e))return O(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||_(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e,t){if(e){if("string"==typeof e)return O(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?O(e,t):void 0}}function O(e,t){(null==t||t>e.length)&(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,I(n.key),n)}}function I(e){var t=function(e,t){if("object"!==P(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==P(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===P(t)?t:String(t)}function A(){return A="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=D(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},A.apply(this,arguments)}function T(e,t){return T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},T(e,t)}function B(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=D(e);if(t){var i=D(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"===P(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function D(e){return D=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},D(e)}var j=t.Utils.firstDefinedValue,R=t.Utils.firstDefinedValueAndKey,N=t.Utils.firstDefinedKey,V=t.Utils.removeDuplicates,U=t.Utils.roundLatOrLng,z=t.Utils.roundLatLng,K=t.Utils.isArray,H=t.Utils.getPaddedZoomAndCenter,Z=t.Utils.roundZoom,q=t.MarkerUtils.setAccessibilityFields,W=t.MarkerUtils.createCornerIcons,G=t.MarkerUtils.createInnerIcons,Q=t.MarkerUtils.createDoubleClickEventCanceller,$=t.MarkerUtils.createImageIcon,X=t.MarkerUtils.createBasicTextMarker,Y=t.Labels.createLabels,J=t.Geo.computeZoomFromBBox,ee=t.Geo.areBoundsCrossingDateLine,te=t.Geo.areCoordinatesCrossingDateLine,re="flying",ne={height:512,width:512},ie=200,oe={type:"click",dom:!0},ae={type:"mouseenter",dom:!0},se={type:"mouseleave",dom:!0},ue={type:"focus",dom:!0},le={type:"focusout",dom:!0},ce={type:"keydown",dom:!0},fe={type:"keyup",dom:!0},de={type:"keypress",dom:!0},he={scaleControl:function(e){return new mapboxgl.ScaleControl(e)},navControl:function(e){return new mapboxgl.NavigationControl(e)},geoLocateControl:funscreenControl:function(e){return new mapboxgl.FullscreenControl(e)}},pe="marker-icon",ve=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T(e,t)}(a,e);var r,n,i,o=B(a);function a(e,r,n,i){var s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(s=o.call(this,e,r,n,i)).TilesLoader=t.TilesLoader,s.logger=e.logger("MapBox"),s.logger.debug("MapBox constructor"),s.mapConfig={keyboard:!1},s.additionalConfig=s.settings.mapbox.mapboxAddConf,s.rtlTextPlugin=s.settings.mapbox.rtlTextPlugin,s.additionalConfig&&Object.assign(s.mapConfig,s.additionalConfig),s}return r=a,n=[{key:"removeMarkerFromMap",value:function(e){e.remove(),e.debug&&e.debug.remove(),e.ey:"cloneMarker",value:function(e){return null==e?void 0:e.clone()}},{key:"init",value:function(e,t){var r=this;this.mapConfig.container=this.node;var n=this.configHelper.mapboxAccessToken();if(n)mapboxgl.accessToken=n;else if(!mapboxgl.accessToken)throw new Error("No mapbox access token set ! Mapbox cannot work properly !");var i=this._zoomAndCenterFromViewport(e,t)||{},o=i.zoom,a=i.center;o&&a&&(this.mapConfig.zoom=o-1,this.mapConfig.center=[a[1],a[0]]),thiObject.keys(he).forEach((function(e){return r._addControl(e,he[e])})),this.mapNavFocusElement=this.realmap.getCanvas(),this._handleMapFocus(),this._registerMapListeners(),this.obfuscatedFeatures=[];var s=[];s.push(this._initializeTilesLoader());var u=this._initializeRouteSourcesAndLayers.bind(this),l=this._initializePolygonSourcesAw Promise((function(e){r.realmap.on("load",(function(){l(),u(),e()}))}));return this.configHelper.readParam("map,mapInitWaitForTiles")&&s.push(c),this.popup=this._createPopup(),Promise.all(s)}},{key:"_addControl",value:function(e,t){var r=this.configHelper.readParam("mapbox,".concat(e));if(r.ctrlEnabled){var n=t(r.ctrlOptions),i=r.ctrlPosition;this.realmap.addControl(n,i)}}},{key:"registerListenerOnMapFocusElement",value:function(e,t){this.listenersToDeregister.push(this.addEventListener(this.mapNavFocusElement,e,t))}},{key:"_handleMapFocus",value:function(){var e=this;this.keyboardFeatures&&this.mapNavFocusElement&&(this.listenersion(){return e.keyboardFeatures.refreshKeyboardNavIconVisibility()}))),this.listenersn(){return e.keyboardFeatures.refreshKeyboardNavIconVisibility(!1)}))))}},{key:"_initializeTilesLoader",value:function(){var e=this;return new Promise((function(t){e.tilesLoader=new e.TilesLoader(e.settings,e.createTileFeature.bind(e),e.removeTileFeature.bind(e),e._updateViewport.bind(e),e.handleTilesLoaded.bind(e),e.handleTilesContentLoaded.bind(e),1),e.realmap.on("data",(function(t){if(t&&t.coord&&"source"===t.dataType&&t.coord.canonical){var r=t.coord.canonical;e.tilesLoader.loadTile(r.x,r.y,r.z,1)}})),t()}))}},{key:"resetRouteStyle",value:function(){var e=this;Object.keys(this.routesSources).forEach((function(t){e.realmap.removeLayer(e.routesSources[t].id),e.realmap.addLayer(e._createRouteLayer(t))}))}},{key:"_createRouteLayer",value:function(e){var t=this.settings.routeLineStyleByDistanceMode[e],r={id:"layer-".concat(e),type:"line",source:e,data:{type:"FeatureCollection",features:[]},paint:{"line-color":t.color,"line-opacity":t.opacity,"line-width":t.width}};switch(t.lineStyle){case"dash":r.paint["line-dasharray"]=[2,2];break;case"dot":r.paint["line-dasharray"]=[1,1]}return this.routesSources[e]=r,r}},{key:"_initializePolygonSourcesAndLayers",value:function(){var e,t,r="polygonFeatures",n="fill-color",i="fill-opacity",o="line-color",a="line-width";this.realmap.addSource(r,{type:"geojson",data:{type:"FeatureCollection",features:this.obfuscatedFeatures}}),this.realmap.addLayer({id:"polygonFill",type:"fill",source:r,layout:{},paint:(e={},S(e,n,["get",n]),S(e,i,["get",i]),e)}),this.realmap.addLayer({id:"polygonStroke",type:"line",source:r,layout:{},paint:(t={},S(t,o,["get",o]),S(t,a,["get",a]),t)})}},{key:"_initializeRouteSourcesAndLayers",value:function(){var e=this;this.routesSources={},["cycling","driving","walking",re].forEach((function(t){e.realmap.addSource(t,{type:"geojson",data:{type:"FeatureCollection",features:[]}}),e.realmap.addLayer(e._createRouteLayer(t))}))}},{key:"_registerMapListeners",value:function(){var e,t,r,n,i;this._registerZoomListener(),this.registeredEvents={},this.listenersToDeregister.push(this._registerIdleListener()),(e=this.listenersToDeregister).push.apply(e,F(this._registerListenerForBoundsChanged("dragend","drag"))),(t=this.listenersToDeregister).push.apply(t,F(this._registerListenerForBoundsChanged("pitchend","pitch"))),(r=this.listenersToDeregister).push.apply(r,F(this._registerListenerForBoundsChanged("rotatend","rotate"))),(n=this.listenersToDeregister).push.apply(n,F(this._registerListenerForBoundsChanged("touchend","touch"))),this.listenersToDeregister.push(this._registerMapListener("dragstart",this.handleDragStart.bind(this))),this.listenersToDeregister.push(this._registerMapListener("style.load",this.setLocale.bind(this))),this.listenersToDeregister.push(this._registerMapListener("click",this.handleMapClick.bind(this))),(i=this.listenersToDeregister).push.apply(i,F(this._registerKeyboardListener())),this.listenersToDeregister.push(this._registerTilesLoadedListener())}},{key:"_registerTilesLoadedListener",value:function(){var e=this.handleTiMapListener("sourcedata",(function(){return e("mapProvider","map")}))}},{key:"_registerKeyboardListener",value:function(){var e=this,r={duration:ie},n=this.realmap.zoomIn.bind(this.realmap),i=this.realmap.zoomOut.bind(this.realmap);this.registeredEvents.s=new t.KeyboardListeners((function(t){return e.realmap.panBy(t,r)}),n,i,this.registeredEvents.keyboardFeatures);var o=this.handleBoundsChanged.bind(this);return[this.addEventListener(this.mapNavFocusElement,ce,this.keyboardListeners.keyDownListenerCallback),this.addEventListener(this.mapNavFocusElement,fe,this.keyboardListeners.keyUpListenerCallback),this.addEventListener(this.mapNavFocusElement,de,this.keyboardListeners.keyPressListenerCallback),this._registerMapListener("idle",(function(){V((e.registeredEvents.keyboardFeatures||[]).splice(0)).forEach(o)}))]}},{key:"_registerZoomListener",value:function(){var e=this;this.lastZoomValueChecked=this.getZoom();var t=this.handleBoundsChanged.bind(this),r=this.getZoom.bind(this);this.listenersToDeregister.push(this._registerMapListener("zoomend",(function(){var n=r(),i=n>e.lastZoomValueChecked;e.lastZoomValueChecked=n,t(i?"zoomIn":"zoomOut")})))}},{key:"_registerMapListenern r?(this.realmap.on(e,,r,t)}):(this.realmap.on(e,t),function(){return n.realmap.off(e,t)})}},{key:"_registerListenerForBoundsChanged",value:function(e,t){var r=this,n=this.handleBoundsChanged.bind(thiener(e,(function(n){n.originalEvent&&r.registeredEvents[e].push(t)})),this._registerMapListener("idle",(function(){return V(r.registeredEvents[e].splice(0)).forEach(n)}))]}},{key:"_registerIdleListener",ve",(function(){return e.eventsManager.pushEvent(t.EventTypes.idle)}))}},{kction(){this.listenersToDeregister.forEach((function(e){return e()})),this.realmap&&this.realmap.remove()}},{key:"addEventListener",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return t.dom||this.logger.warn("Not able to register an event which is not a dom event: ".concat(t," on comp ").concat(stener(t.type,r),function(){return e.removeEventListener(t.type,r)}}},{key:"centerAndZoomMap",value:function(e,t,r){var n=this,i=M(e?z(e):[],2),o=i[0],a=i[1],s=t,u={};if(void 0!==o&&void 0!==a&&void 0!==s&&void 0!==r){var l=this._parseClientPadding(r),c=this._getPaddedZoomAndCenterForCenterAndZoom(e,t,l)||{},f=c.zoom,d=c.center;if(void 0!==f&&void 0!==d){var h=M(d,2);o=h[0],a=h[1],s=f-1}}if(void 0!==o&&void 0!==a){var p=this.realmap.getCenter(),v=M(z([p.lat,p.lng]),2),y=v[0],g=v[1];y===o&&g===a||(u.center=new mapboxgl.LngLat(a,o))}return s&&this.getZoom()!==s&&(u.zoom=s),!(!u.center&&led=!0,this.realmap.once("moveend",(function(){n._updateViewport()})),this.realmap.easeTo(x({duration:ie},u)),0))}},{key:"asNativeBounds",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return new mapboxgl.LngLatBounds(new mapboxgl.LngLat(U(e[1],void 0,r),U(e[0],void 0,!1)),new mapboxgl.LngLat(U(t[1],void 0,r),U(t[0],void 0,!1)))}},{key:"isFeatureInRealBound",value:function(e,t){var r=e.contains([t.latLng[1],t.latLng[0]]);if(!r){if(e.getNorthEast().lng>180)return e.contains([t.latLng[1]+360,t.latLng[0]]);if(e.getSouthWest().lng<-180)return e.contaialue:function(){var e=this.realmap.getCenter();return[e.lat,e.lng]}},{key:"getRectOfMarker",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.getMarkerComponent(e),i=n.clientWidth,o=n.clientHeight,a=this.realmap.project(e.marker.getLngLat(},{key:"getZoom",value:function(){return Z(this.realmap.getZoom())}},{key:"asBounds",value:function(e){if(e){var t=e.getSouthWest(),r=e.getNorthEast(),n=this.getCenter();return{sw:[U(t.lat),U(t.lng)],ne:[U(r.lat),U(r.lng)],center:n}}}},{key:"containerBounds",value:function(e){if(this.realmap){var t=this.realmap.unproject([e.offsetLeft-e.offsetWidth/2,e.offsetTop+e.offsetHeight/2]),r=this.realmap.unproject([e.offsetLeft+e.offsetWidth/2,e.offsetTop-e.offsetHeight/2]);return{sw:[U(t.lat),U(t.lng)],ne:[U(r.lat),U(r.lng)],center:[U(t.lat+(t.lat-r.lat)/2),U(r.lng+(r.lng-t.lng)/2)]}}}},{key:"computeNativeBoundsFromLatLongs",value:function(e){if((null==e?void 0:e.length)>0){var t=this._computeNativeBoundsFromLatLongsAux(e);if(te(e)){var r=this._computeNativeBoundsFromLatLongsAux(e.filter((function(e){var t;return(null!==(t=e.lng)&&void 0!==t?t:e[1])<0}))),n=this._computeNativeBoundsFromLatLongsAux(e.filter((function(e){var t;return(null!==(t=e.lng)&&void 0!==t?t:e[1])>=0})));return this.asNativeBounds(z([t.getSouthWest().lat,n.getSouthWest().lng]),z([r.getNorthEast().lat,r.getNorthEast().lng]))}return t}}},{key:"_computeNativeBoundsFromLatLongsAux",value:function(e){var t=new mapboxgl.LngLatBounds;return e.forEach((function(e){var r=M(z(e),2),n=r[0],i=r[1];t=t.extend(new mapboxgl.LngLat(i,n))})),t}},{key:"_zoomAndCenterFromViewport",value:function(e,t){if(e){var r=e.center,n=e.zoom,i=e.sw,o=e.ne,a=e.coordinates,s=e.useBoundsComputation,u=e.options,l=this._parseClientPadding(t);if(r&&n)return this._getPaddedZoomAndCenterForCenterAndZoom(r,n,l);if(i&&o){var c=z(i),f=z(o);return this._getPaddedZoomAndCenterForBounds(c,f,!1,l)}if(a&&s){var d=this._computeNativeBounds(a,s,u),h=this._computeZoomAndCenterFromMapboxBounds(d,!1,l)||{},p=h.zoom,v=h.center;if(void 0!==p&&void 0!==v)return H(p+1,v,l)}else if(K(e)&&e.length>0)return this._getPaddedZoomAndCenterFromLatLongs(e,!0,l)}}},{key:"_getPaddedZoomAndCenterForCenterAndZoom",value:function(e,t,r){return H(t+1,e,r)}},{key:"_getPaddedZoomAndCenterForBounds",value:function(e,t,r,n){var i=new mapboxgl.LngLatBounds(new mapboxgl.LngLat(e[1],e[0]),new mapboxgl.LngLat(t[1],t[0])),o=this._computeZoomAndCenterFromMapboxBounds(i,r,n)||{},a=o.zoom,s=o.center;if(void 0!==a&&void 0!==s)return H(a+1,s,n)}},{key:"_getPaddedZoomAndCenterFromLatLongs",value:function(e,t,r){var n=this._computeZoomAndCenterFromMapboxBounds(this.computeNativeBoundsFromLatLongs(this.boundsComputation.computeBoundingBox(e)),t,r)||{},i=n.zoom,o=n.center;if(void 0!==i&&void 0!==o)return H(i+1,o,r)}},{key:"_computeZoomAndCenterFromMapboxBounds",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0,n=e;this._boundsForOneCoordinate(n)&&(n=new mapboxgl.LngLatBounds(n.getSouthWest(),n.getNorthEast()),n=this._extendsOneCoordinateBounds(n)),n=this._fixDatelineBoundsForMapboxInternalMethods(n);var i=J(this.node,n.getSouthWest().lat,n.getSouthWest().lng,n.getNorthEast().lat,n.getNorthEast().lng,{zoomMax:22,padding:t?this.configHelper.readParam("mapbox,padding"):0,worldDimensions:ne,parsedClientPadding:r});if(isFinite(i))return{zoom:i,center:z([n.getCenter().lat,n.getCenter().lng])}}},{key:"_extendsOneCoordinateBounds",value:function(e){var t=new mapboxgl.LngLat(e.getNorthEast().lng+.01,e.getNorthEast().lat+.01),r=new mapboxgl.LngLat(e.getNorthEast().lng-.01,e.getNorthEast().lat-.01);=e.getSouthWest().lat&&e.getNorthEast().lng===e.getSouthWest().lng}},{key:"_fixDatelineBoundsForMapboxInternalMethods",value:function(e){var t=e.getSouthWest(),r=e.getNorthEast();return ee(t,r)?this.asNativeBounds([t.lat,t.lng],[r.lat,r.lng+360],!1):e}},{key:"fitLatLongs",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3?arguments[3]:void 0;if(this.realmap){this.boundChangedDisabled=!r;var o=this._parseClientPadding(i),a=this._getPaddedZoomAndCenterFromLatLongs(e,n,o)||{},s=a.zoom,u=a.center;if(void 0!==s&&void 0!==u){var l={center:new mapboxgl.LngLat(u[1],u[0]),zoom:s-1};return new Promise((function(e){t.realmap.once("moveend",(function(){t._updateViewport().then((function(r){return e(t.asBounds(r))}))})),t.realmap.easeTo(x({duration:ie},l))}))}return Promise.resolve(this.getBounds({this.realmap.resize(),A(D(",value:function(){if(thitTileDim",value:function(){return{width:ne.width,height:ne.height}}},{key:"fitBounds",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4?arguments[4]:void 0;if(this.realmap){this.boundChangedDisabled=!n;var a=this._parseClientPadding(o),s=z(e),u=z(t),l=this._getPaddedZoomAndCenterForBounds(s,u,i,a)||{},c=l.zoom,f=l.center;if(void 0!==c&&void 0!==f){var d=this.getZoom(),h=M(this.getCenter(),2),p=h[0],v=h[1];if(p!==f[0]||v!==f[1]||d!==c-1){var y={center:new mapboxgl.LngLat(f[1],f[0]),zoom:c-1};return new Promise((functioon(){r._updateViewport().then((function(t){return e(r.asBounds(t))}))})),r.realmap.easeTo(x({duration:ie},y))}))}this.boundChangedDisabled=!1}return Promise.resolve(this.getBounds())}return Pvar t;return null===(t=e.marker)||void 0===t?void 0:t.getElement()}},{key:"moveMarkerPosition",value:function(e,t){var r=this.realmap.project(e.marker.getLngLat());r.x+=t.x,r.y+=t.y;var n=this.realmap.unproject(r);e.marker.setLngLat(n)}},{key:"updatePopupPositionOnLayer",value:function(){var e=(this.popup||{}).feature;if(e&&e.defined){var t,r;switch(j(this.settings.popupPositions[e.type],e.hashKeys)){case"above":default:t=0,r=-24;break;case"below":t=0,r=5+this.popup.getElement().offsetHeight}this.popup.setOffset([t,r]),this.popup.setLngLat([this.popup.feature.latLng[1],this.popup.feature.latLng[0]])}}},{key:"_updateViewport",value:function(e){var t=this;return this..call(this,e).then((function(e){return t._updateMarkerPosition(),e})):Promise.resolve(e)}},{key:"ensurePopupVisibility",value:function(){var e=this.popup,t=e.feature,r=e.visibleElement,n=r.offsetWidth,i=r.offsetHeight,o=this.node,a=o.offsetWidth,s=o.offsetHeight,u=j(this.configHelper.popupVisibilityPaddings()[t.type],t.hashKeys),l=null==u?void 0:u.x,c=null==u?void 0:u.y,f="below"===j(this.settings.popupPositions[t.type],t.hashKeys),d=f?1:-1,h=this.getRectOfMarker(t).height,p=this.realmap.project(t.marker.getLngLat()),v={x:p.x-n/2,y:p.y+h*d+i*d},y=M(this._calculatePopupVisibilityOffsetValues(v,l,c,a,s,n,i,f),2),g=y[0],m=y[1];if(0!==g||0!==m){var b=this.realmap.project(this.realmap.getCenter()),k=this.realmap.unproject([b.x+g,b.y+m]);this.realmap.easeTo(k,{duration:ie})}}},{key:"_createPopup",value:function(){var e=this._createGenericPopup(void 0),r=new mapboxgl.Marker({element:e,anchor:"bottom"}).setLngLat([0,0]).addTo(this.realmap);return t.HtmlUtils.setZIndex(e,this.settings.maxZIndex+1),t.HtmlUtils.setDisplayNone(e),r.content=e.content,r.cssElement=e,r.visibleElement=e,r.clean=[].concat(F(this.registerCompListeners(e,"popup")),[Q(e,this.addEventListener.bind(this))]),r}},{key:"registerCompListeners",value:function(e,t,r){var n=this.handleMarkerClick.bind(this),i=this.handleMarkerMouseOver.bind(this),o=this.handleMarkerMouseOut.bind(this);return[this.addEventListener(e,oe,(function(e){e.stopPropagation(),n(r,t,e.type)})),this.addEventListener(e,ae,(function(dEventListener(e,se,(function(e){e.stopPropagation(),o(r,t,e.type)})),Q(e,this.addEventListener.bind(this))]}},{key:"clearObfuscateArea",value:function(e){var t=e.id;this.obfuscatedFeatures.findIndex((function(e){return e.feature_idhis.obfuscatedFeatures.filter((function(e){return e.feature_id!==t})),arkerToUse",this).call(this,e),this._updatePolygonFeaturesSource()}},{key:"_updatePolygonFeaturesSource",value:function(){var e;if("function"==typeof(null===(e=this.realmap)||void 0===e?void 0:e.getSource)){var t,r=null===(t=this.realmap)||void 0===t?void 0:t.getSource("polygonFeatures");null==r||r.setData({type:"FeatureCollection",features:this.obfuscatedFeatures})}}},{key:"changeProductMarkersVisible",value:function(e,t){A(D(a.prototype),"changeProductMarkersVisible",this).call(this,e,t),this._updatesVisible",this).call(this,e,t),this._updatePolygonFeaturesSource()}},{key:"hasObfuscateAreaStyleChanged",value:function(e){var t=e.id,r=this.obfuscatedFeatures.findIndex((function(e){return e.feature_id==t}));if(r>=0){var n=N(this.settings.obfuscateStyle[e.type],e.hashKeys);return this.obfuscatedFeatures[r].styleKey!==n}return!1}},{key:"_createObfuscatedPolygon",value:function(e){var t=e.id,r=this.getCirclePolygonData(e),n=R(this.settings.obfuscateStyle[e.type]s.obfuscatedFeatures.findIndex((function(e){return e.feature_id==t})),s=function(e){return{"fill-color":e.fill.color,"fill-opacity":e.fill.opacity,"line-color":e.line.color,"line-width":e.line.weight}};if(a<0){var u={feature_id:t,type:"Feature",styltype:"Polygon",coordinates:[r.map((function(e){return[e.lng,e.lat]}))]}};this.obfuscatedFeatures.push(u)}else this.obfuscatedFeatures[a].properties=s(o),this._updatePolygonFeaturesSource()}},{key:"_createDebugMarker",value:function(e){return this.settings.debugMarkersPosition?{debug:(new mapboxgl.Marker).setLngLat([e.latLng[1],e.latLng[0]]).addTo(this.realmap),style:"opacity: 0.5"}:{}}},{key:"createPinMarkerWithClickListener",value:function(e,r,n){var i=e.feature,o=e.cornerIcons,a=e.innerIcons,s=e.cssClasses,u=e.zIndex,l=e.label,c=e.subLabel,f=e.ariaLabels,d=this._createDebugMarker(i),h=d.debug,p=d.style,v=this.uniqId("marker-".concat(this.asKey(i))),y="".concat(s.join(" ")).concat("none"!==n?" frame-".concat(n):""),g=t.HtmlUtils.createDiv(v,void 0,y,p),m=new mapboxgl.Marker({element:g,anchor:"bottom"}).setLngLat([i.latLng[1],i.latLng[0]]).addTo(this.realmap),b=$(r,g,n,!0,pe),k=b.iconImg,w=b.main;return m.frameIcon=n,t.HtmlUtils.setAriaHidden(w),m.iconElements={cornerIcons:o,innerIcons:a},W(g,o),G(k,a),m.debug=h,t.HtmlUtils.setZIndex(g,u),t.HtmlUtils.clearAriaLabel(g),m.ariaElement=g,q(i.highlighted,m.ariaElement,f),m.zIndexElement=g,m.iconElements.pin=w,m.cssElement=g,m.labels={textLblCont:g},m.bounceElement=w,m.clone=function(){return g.cloneNode(!0)},Y(m,i,l,c,this.settings,this._zIndexAdjustment),m.clean=this.registerCompListeners(g,"pin",i),m}},{key:"createTextMarkerWithClickListener",value:function(e,r,n){var i=e.feature,o=e.cornerIcons,a=e.innerIcons,s=e.cssClasses,u=e.zIndex,l=e.label,c=e.subLabel,f=e.ariaLabels,d=this._createDebugMarker(i),h=d.debug,p=d.style,v=this.uniqId("marker-".concat(this.asKey(i))),y=X(v,void 0,n,null==s?void 0:s.join(" "),r,p),g=y.main,m=y.text,b=y.span,k=new mapboxgl.Marker({element:g,anchor:"bottom"}).setLngLat([i.latLng[1],i.latLng[0]]).addTo(this.realmap);return k.iconElements={cornerIcons:o,innerIcons:a},W(m,o),G(b,a),k.debug=h,t.HtmlUtils.setZIndex(g,u),t.HtmlUtils.clearAriaLabel(g),k.ariaElement=m,q(i.highlighted,k.ariaElement,f),k.zIndexElement=g,k.bounceElement=m,k.cssElement=g,k.labels={textLblCont:g},k.clone=function(){return g.cloneNode(!0)},k.label=r,Y(k,i,l,c,this.settings,this._zIndexAdjustment),k.clean=this.registerCompListeners(g,n,i),k}},{key:"createClusterMarkerWithClickListener",value:function(e,r,n,i){var o=this._createDebugMarker(e),a=o.debug,s=o.style,u=this._createClusterMarker(void 0,e,r,n,i,s),l=new mapboxgl.Marker({element:u}).setLngLat([e.latLng[1],e.latLng[0]]).addTo(this.realmap);l.debug=a;var c=j(this.settings.zIndexes[e.type],e.hashKeys);return t.HtmlUtils.cssElement=u.cssElement,l.clone=function(){return u.cloneNode(!0)},l.clean=this.registerCompListeners(u,"clusterMarker",e),l}},{key:"createObfuscateMarkerWithClickListener",value:function(e){var r=this,n=e.feature,i=e.cssClasses,o=e.zIndex,a=e.label,s=e.subLabel,u=e.ariaLabels,l=this._createDebugMarker(n),c=l.debug,f=l.style,d=this.uniqId("marker-".concat(this.asKey(n))),h=t.HtmlUtils.createDiv(d,void 0,i.join(" "),f),p=new mapboxgl.Marker({element:h}).setLngLat([n.latLng[1],n.latLng[0]]).addTo(this.realmap);return p.debug=c,t.HtmlUtils.setZIndex(h,o),t.HtmlUtils.clearAriaLabel(h),p.ariaElement=h,q(n.highlighted,p.ariaElement,u),p.zIndexElement=h,p.cssElement=h,p.labels={textLblCont:h},p.obfuscateArea=p,p.featureId=n.id,p.clone=function(){return r.cloneObfuscatedPolygon(n,h)},this._createObfuscatedPolygon(n),Y(p,n,a,s,this.settings,this._zIndexAdjustment),p.clean=this.registerCompListeners(h,"obfuscate",n),p}},{key:"createPinObfuscateMarkerWithClickListener",value:function(e,r,n){var i=this,o=e.feature,a=e.cornerIcons,s=e.innerIcons,u=e.cssClasses,l=e.zIndex,c=e.label,f=e.subLabel,d=e.ariaLabels,h=this._createDebugMarker(o),p=h.debug,v=h.style,y=this.uniqId("marker-".concat(this.asKey(o))),g="".concat(u.join(" ")).concat("none"!==n?" frame-".concat(n):""),m=t.HtmlUtils.createDiv(y,void 0,g,v),b=new mapboxgl.Marker({element:m}).setLngLat([o.latLng[1],o.latLng[0]]).addTo(this.realmap),k=t.HtmlUtils.createDiv(void 0,m,"pin-marker"),w=t.HtmlUtils.createDiv(void 0,k,"marker-icon-inter");t.HtmlUtils.setAriaHidden(w);var C=$(r,w,n,!0,pe),P=C.iconImg,L=C.main;return b.frameIcon=n,b.iconElements={cornerIcons:a,innerIcons:s},W(w,a),G(P,s),b.debug=p,t.HtmlUtils.setZIndex(k,l),t.HtmlUtils.clearAriaLabel(m),b.ariaElement=k,q(o.highlighted,b.ariaElement,d),b.zIndexElement=k,b.bounceElement=L,b.cssElement=m,b.labels={textLblCont:t.HtmlUtils.isAnHtmlElement(r)?L:w},b.featureId=o.id,b.clone=function(){return i.cloneObfuscatedPolygon(o,m)},b.obfuscateArea=b,this._createObfuscatedPolygon(o),Y(b,o,c,f,this.settings,this._zIndexAdjustment),b.iconElements.pin=L,b.clean=this.registerCompListeners(k,"pinObfuscate",o),b}},{key:"createPriceObfuscateMarkerWithClickListener",value:function(e,r){var n=this,i=e.feature,o=e.cornerIcons,a=e.innerIcons,s=e.cssClasses,u=e.zIndex,l=e.label,c=e.subLabel,f=e.ariaLabels,d=this._createDebugMarker(i),h=d.debug,p=d.style,v=this.uniqId("marker-".concat(this.asKey(i))),y=t.HtmlUtils.createDiv(v,void 0,s.join(" "),p),g=X(v,y,"price","price-marker",r),m=g.main,b=g.text,k=g.span,w=new mapboxgl.Marker({element:y}).setLngLat([i.latLng[1],i.latLng[0]]).addTo(this.realmap);return w.iconElements={cornerIcons:o,innerIcons:a},W(b,o),G(k,a),w.debug=h,t.HtmlUtils.setZIndex(m,u),t.HtmlUtils.clearAriaLabel(y),w.ariaElement=b,q(i.highlighted,w.ariaElement,f),w.zIndexElement=m,w.bounceElementureId=i.id,w.clone=function(){return n.cloneObfuscatedPolygon(i,y)},w.obfuscateArea=w,this._createObfuscatedPolygon(i),w.clean=this.registerCompListeners(m,"priceObfuscate",i),w.label=r,Y(w,i,l,c,this.settings,this._zIndexAdjustment),w}},{key:"setLocale",value:function(){if(this.settings.locale){var e=this.settings.locale.substring(0,2);"unavailable"===mapboxgl.getRTLTextPluginStatus()&&mapboxgl.setRTLTextPlugin(this.rtlTextPlugin,null,!0);var t,r=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.returap.getStyle().layers.filter((function(e){return/-label/.test(e.id)})));try{for(r.s();!(t=r.n()).done;){var n=t.value;this.realmap.setLayoutProperty(n.id,"text-field",["coalesce",["get","name_"+e],["get","name"]])}}catch(e){r.e(e)}finally{r.f()}}}},{key:"_genGeodesicRoute",value:function(e,t){try{for(var r={type:"Feature",geometrfunction(e,t){var r=t.geometry.coordinates;return e+g(r[0],r[1],s)}),0)),i=[],o=0;o<n;o+=n/500){var a=m(r,o);i.push(a.geometry.coordinates)}return i.length>1&&i[0][0]<0&&i[1][0]>0&&(i[0][0]+=360),i}catch(e){this.logger.error("failed to generate geodesic line. use straight line",e)}var s}},{key:"addRouteOnMap",value:function(e,t){var r=this;return new Promise((funci){var o=t.route.path.map((function(e){var t=e.lat;return[e.lng,t]}));e.mode===re&&2==o.length&&(o=r._genGeodesicRoute(o[0],o[1])||o),i.data.features.push({id:e.id,type:"Feature",geometry:{type:"LineString",coordinates:o}}),r.realmap.getSource(e.mode).setData(i.data)}n(e)}))}},{key:"removeRouteOnMap",value:function(e){var t=this;return new Promise((function(r,n){vi){var o=i.data.features.findIndex((function(t){return t.id===e.id}));o>=0&&(i.data.features.splice(o,1),t.realmap.getSource(e.mode).setData(i.data)),r()}else n(new Error("can't find source for ".concat(e.mode)))}))}},{key:"updateMapProviderConfig",value:function(){}}],n&&E(r.prototype,n),i&&E(r,i),Object.defineProperty(r,"prototype",{writable:!1}),a}(t.BaseMap);window.egmapsMapbox=e}(),i}())}}]);
//# sourceMappingURL=eg-maps.3011d4078a13d3f1eea4.js.map