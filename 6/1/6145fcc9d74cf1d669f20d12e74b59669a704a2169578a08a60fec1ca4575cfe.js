((function(){var define,module,exports;return )({1:[function(require,module,exports){"use strict";var analyticsq=window.Attribution||[];var analytics=require("@segment/analytics.js-core");var attribution=require("analytics.js-integration-attribution");analytics.require=require;analytics.use(attribution);if(!analyticsq._loadOptions||!analyticsq._loadOptions.projectId){if(window.Attribution&&window.Attribution.projectId){analyticsq._loadOptions=analyticsq._loadOptions||{};analyticsq._loadOptions.projectId=window.Attribution.projectId}else{window.console&&console.error("Attribution failed to load, Project ID is missing https://docs.attributionapp.com")}}analytics.initialize({Attribution:analyticsq._loadOptions});while(analyticsq&&analyticsq.length>0){var args=analyticsq.shift();var method=args.shift();if(analytics[method])analytics[method].apply(analytics,args)}module.exports=analytics},{"@segment/analytics.js-core":21,"analytics.js-integration-attribution":53}],2:[function(require,module,exports){var IDX=256,HEX=[],BUFFER;while(IDX--)HEX[IDX]=(IDX+256).toString(16).substring(1);function v4(){var i=0,num,out="";if(!BUFFER||IDX+16>256){BUFFER=Array(i=256);while(i--)BUFFER[i]=256*Math.random()|0;i=IDX=0}for(;i<16;i++){num=BUFFER[IDX+i];if(i==6)out+=HEX[num&15|64];else if(i==8)out+=HEX[num&63|128];else out+=HEX[num];if(i&1&&i>1&&i<11)out+="-"}IDX++;return out}exports.v4=v4},{}],3:[function(require,module,exports){"use strict";var arity=require("@ndhoule/arity");var objToString=Object.prototype.toString;var isFunction=function(val){return typeof val==="function"};var isNumber=function(val){var type=typeof val;return type==="number"||type==="object"&&objToString.call(val)==="[object Number]"};var after=function after(n,fn){if(!isNumber(n)){throw new TypeError("Expected a number but received "+typeof n)}if(!isFunction(fn)){throw new TypeError("Expected a function but received "+typeof fn)}var callCount=0;return arity(fn.length,function(){callCount+=1;if(callCount<n){return}return fn.apply(this,arguments)})};module.exports=after},{"@ndhoule/arity":4}],4:[function(require,module,exports){"use strict";var objToString=Object.prototype.toString;var isFunction=function(val){return typeof val==="function"};var isNumber=var createParams=function createParams(n){var args=[];for(var i=1;i<=n;i+=1){args.push("arg"+i)}return args};var createArityWrapper=function createArityWrapper(n){var paramNames=createParams(n).join(", ");var wrapperBody="".concat("  return function(",paramNames,") {\n","    return func.apply(this, arguments);\n","  };");return new Function("func",wrapperBody)};var arityWrapperCache=[;var arity=function arity(n,func){if(!isFunction(func)){throw new TypeError("Expected a function but got "+typeof func)}n=Math.max(isNumber(n)?n:0,0);if(!arityWrapperCache[n]){arityWrapperCache[n]=createArityWrapper(n)}return arityWrapperCache[n](func)};module.exports=arity},{}],5:[{"component-type":69}],6:[{"@ndhoule/drop":7,"@ndhoule/rest":16}],7:[{}],8:[function(require,module,exports){"use strict";var keys=require("@ndhoule/keys");var objToString=Object.prototype.toString;var isNumber=function isNumber(val){var type=typeof val;return type==="number"||type==="object"&&objToString.call(val)==="[object Number]"};var isArray=typeof Array.isArray==="function"?Array.isArray:function isArray(val){return objToString.call(val)==="[object Array]"};var isArrayLike=function isArrayLike(val){return val!=null&&(isArray(val)||val!=="function"&&isNumber(val.length))};var arrayEach=function arrayEach(iterator,array){for(var i=0;i<array.length;i+=1){if(iterator(array[i],i,array)===false){break}}};var baseEach=function baseEach(iterator,object){var ks=keys(object);for(var i=0;i<ks.length;i+=1){if(iterator(object[ks[i]],ks[i],object)===false){break}}};var each=function each(iterator,collection){return(isArrayLike(collection)?arrayEach:baseEach).call(this,iterator,collection)};module.exports=each},{"@ndhoule/keys":13}],9:[{"@ndhoule/each":8}],10:[{}],11:[{"@ndhoule/each":8}],12:[{"@ndhoule/each":8}],13:[{}],14:[function(require,module,exports){"use strict";var each=require("@ndhoule/each");var map=function map(iterator,collection){if(typeof iterator!=="function"){throw new TypeError("Expected a function but received a "+typeof iterator)}var result=[];each(function(val,i,collection){result.push(iterator(val,i,collection))},collection);return result};module.exports=map},{"@ndhoule/each":8}],15:[{}],16:[{}],17:[function(require,module,exports){(function(global){(function(){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _analytics=global.analytics;var Alias=require("segmentio-facade").Alias;var Emitter=require("component-emitter");var Facade=require("segmentio-facade");var Group=require("segmentio-facade").Group;var Identify=require("segmentio-facade").Identify;var SourceMiddlewareChain=require("./middleware").SourceMiddlewareChain;var IntegrationMiddlewareChain=require("./middleware").IntegrationMiddlewareChain;var DestinationMiddlewareChain=require("./middleware").DestinationMiddlewareChain;var Page=require("segmentio-facade").Page;var Track=require("segmentio-facade").Track;var bindAll=require("bind-all");var clone=require("./utils/clone");var extend=require("extend");var cookie=require("./cookie");var metrics=require("./metrics");var debug=require("debug");var defaults=require("@ndhoule/defaults");var each=require("./utils/each");var group=require("./group");var is=require("is");var isMeta=require("@segment/is-meta");var keys=require("@ndhoule/keys");var memory=require("./memory");var nextTick=require("next-tick");var normalize=require("./normalize");var on=require("component-event").bind;var pageDefaults=require("./pageDefaults");var pick=require("@ndhoule/pick");var prevent=require("@segment/prevent-default");var url=require("component-url");var store=require("./store");var user=require("./user");var type=require("component-type");mitter(Analytics.prototype);Analytics.prototype.use=Analytics.prototype.addIntegration=Analytics.prototype.addSourceMiddleware=function(middleware){this._sourceMiddlewares.add(middleware);return this};Analytics.prototype.addIntegrationMiddleware=Analytics.prototype.addDestinationMiddleware=Analytics.prototype.init=Analytics.prototype.initialize=Analytics.prototype.setAnonymousId=Analytics.prototype.add=Analytics.prototype.identify=Analytics.prototype.user=function(){return user};Analytics.prototype.group=Analytics.prototype.track=Analytics.prototype.trackClick=Analytics.prototype.trackLink=Analytics.prototype.trackSubmit=Analytics.prototype.trackForm=Analytics.prototype.page=Analytics.prototype.pageview=Analytics.prototype.alias=Analytics.prototype.ready=Analytics.prototype.timeout=Analytics.prototype.debug=Analytics.prototype._options=Analytics.prototype._callback=Analytics.prototype._invoke=Analytics.prototype.push=Analytics.prototype.reset=Analytics.prototype._parseQuery=function(query){var parsed=url.parse(query);var q=parsed.query.split("&").reduce(function(acc,str){var _a=str.split("="),k=_a[0],v=_a[1];acc[k]=decodeURI(v).replace("+"," ");return acc},{});var traits=pickPrefix("ajs_trait_",q);var props=pickPrefix("ajs_prop_",q);if(q.ajs_uid)this.identify(q.ajs_uid,traits);if(q.ajs_event)this.track(q.ajs_event,props);if(q.ajs_aid)user.anonymousId(q.ajs_aid);return this;function pickPrefix(prefix,object){var length=prefix.length;var sub;return Object.keys(object).reduce(function(acc,key){if(key.substr(0,length)===prefix){sub=key.substr(length);acc[sub]=object[key]}return acc},{})}};Analytics.prototype.normalize=Analytics.prototype._mergeInitializeAndPlanIntegrations=Analytics.prototype.noConflict=module.exports=Analytics;module.exports.cookie=cookie;module.exports.memory=memory;module.exports.store=store;module.exports.metrics=metrics}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./cookie":18,"./group":20,"./memory":22,"./metrics":23,"./middleware":24,"./normalize":25,"./pageDefaults":26,"./store":27,"./user":28,"./utils/clone":29,"./utils/each":30,"@ndhoule/defaults":6,"@ndhoule/keys":13,"@ndhoule/pick":15,"@segment/is-meta":37,"@segment/prevent-default":46,"bind-all":60,"component-emitter":66,"component-event":67,"component-type":69,"component-url":70,debug:71,extend:74,is:78,"next-tick":86,"segmentio-facade":96}],18:[{"./utils/clone":29,"@ndhoule/defaults":6,"@segment/cookie":35,"@segment/top-domain":50,"bind-all":60,debug:71}],19:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var clone=require("./utils/clone");var cookie=require("./cookie");var debug=require("debug")("analytics:entity");var defaults=require("@ndhoule/defaults");var extend=require("@ndhoule/extend");var memory=require("./memory");var store=require("./store");var isodateTraverse=require("@segment/isodate-traverse");module.exports=Entity;ntity.prototype.initialize=Entity.prototype.storage=function(){return this._storage};Entity.prototype.options=Entity.prototype.id=function(id){switch(arguments.length){case 0:return this._getId();case 1:return this._setId(id);default:}};Entity.prototype._getId=Entity.prototype._getIdFromCookie=Entity.prototype._getIdFromLocalStorage=Entity.prototype._setId=Entity.prototype._setIdInCookies=Entity.prototype._setIdInLocalStorage=Entity.prototype.properties=Entity.prototype.traits=Entity.prototype._getTraits=Entity.prototype._setTraits=Entity.prototype.identify=Entity.prototype.save=Entity.prototype.logout=Entity.prototype.reset=Entity.prototype.load=,{"./cookie":18,"./memory":22,"./store":27,"./utils/clone":29,"@ndhoule/defaults":6,"@ndhoule/extend":10,"@segment/isodate-traverse":38,debug:71}],20:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Entity=require("./entity");var bindAll=require("bind-all");var debug=require("debug")("analytics:group");var inherit=require("inherits");Group.defaults={persist:true,cookie:{key:"_attrg"},localStorage:{key:"attr_group_properties"}};function Group(options){this.defaults=Group.defaults;this.debug=debug;Entity.call(this,options)}inherit(Group,Entity);module.exports=bindAll(new Group);module.exports.Group=Group},{"./entity":19,"bind-all":60,debug:71,inherits:76}],21:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Analytics=require("./analytics");var analytics=new Analytics;analytics.require=require;analytics.VERSION=require("../package.json").version;module.exports=analytics},{"../package.json":32,"./analytics":17}],22:[{"./utils/clone":29,"bind-all":60}],23:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var bindAll=require("bind-all");var send=require("@segment/send-json");var debug=require("debug")("analytics.js:metrics");function Metrics(options){this.options(options)}Metrics.prototype.options=Metrics.prototype.increment=Metrics.prototype._flush=module.exports=bindAll(new Metrics);module.exports.Metrics=Metrics},{"@segment/send-json":48,"bind-all":60,debug:71}],24:[{"segmentio-facade":96}],25:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var debug=require("debug")("analytics.js:normalize");var defaults=require("@ndhoule/defaults");var each=require("./utils/each");var includes=require("@ndhoule/includes");var map=require("./utils/map");var type=require("component-type");var uuid=require("uuid/v4");var md5=require("spark-md5").hash;var has=Object.prototype.hasOwnProperty;module.exports=normalize;var toplevel=["integrations","anonymousId","timestamp","context"];,{"./utils/each":30,"./utils/map":31,"@ndhoule/defaults":6,"@ndhoule/includes":12,"component-type":69,debug:71,"spark-md5":103,"uuid/v4":114}],26:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var canonical=require("@segment/canonical");var includes=require("@ndhoule/includes");var url=require("component-url");ule.exports=pageDefaults},{"@ndhoule/includes":12,"@segment/canonical":34,"component-url":70}],27:[{"@ndhoule/defaults":6,"@segment/store":49,"bind-all":60}],28:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Entity=require("./entity");var bindAll=require("bind-all");var cookie=require("./cookie");var debug=require("debug")("analytics:user");var inherit=require("inherits");var rawCookie=require("@segment/cookie");var uuid=require("uuid");var localStorage=require("./store");User.defaults={persist:true,cookie:{key:"_attru",oldKey:"none"},localStorage:{key:"attr_user_traits"}};nherit(User,Entity);User.prototype.id=User.prototype.anonymousId=User.prototype._setAnonymousIdInLocalStorage=User.prototype.logout=User.prototype.load=User.prototype._loadOldCookie=module.exports=bindAll(new User);module.exports.User=User},{"./cookie":18,"./entity":19,"./store":27,"@segment/cookie":35,"bind-all":60,debug:71,inherits:76,uuid:110}],29:[{"component-type":69}],30:[{"@ndhoule/keys":13}],31:[{"./each":30}],32:[{}],33:[{"utf8-encode":109}],34:[{}],35:[{debug:71}],36:[{}],37:[{}],38:[function(require,module,exports){"use strict";var isodate=require("@segment/isodate");module.exports=traverse;function traverse(input,strict){if(strict===undefined)strict=true;if(input&&typeof input==="object"){return traverseObject(input,strict)}else if(Array.isArray(input)){return traverseArray(input,strict)}else if(isodate.is(input,strict)){return isodate.parse(input)}return input}function traverseObject(obj,strict){Object.keys(obj).forEach(;return obj}function traverseArray(arr,strict){arr.forEach(;return arr}},{"@segment/isodate":39}],39:[{}],40:[{"component-type":69,"next-tick":86,"script-onload":89}],41:[function(require,module,exports){"use strict";var keys=require("@ndhoule/keys");var uuid=require("uuid").v4;var inMemoryStore={_data:{},length:0,setItem:getItem:function(key){if(key in this._data){return this._data[key]}return null},removeItem:function(key){if(key in this._data){delete this._data[key]}this.length=keys(this._data).length;return null},clear:key:;function isSupportedNatively(){try{if(!window.localStorage)return false;var key=uuid();window.localStorage.setItem(key,"test_value");var value=window.localStorage.getItem(key);window.localStorage.removeItem(key);return value==="test_value"}catch(e){return false}}function pickStorage(){if(isSupportedNatively()){return window.localStorage}return inMemoryStore}module.exports.defaultEngine=pickStorage();module.exports.inMemoryEngine=inMemoryStore},{"@ndhoule/keys":13,uuid:110}],42:[function(require,module,exports){"use strict";var uuid=require("@lukeed/uuid").v4;var Store=require("./store");var each=require("@ndhoule/each");var Schedule=require("./schedule");var debug=require("debug")("localstorage-retry");var Emitter=require("component-emitter");unction Queue(name,opts,fn){if(typeof opts==="function")fn=opts;this.name=name;this.id=uuid();this.fn=fn;this.maxItems=opts.maxItems||Infinity;this.maxAttempts=opts.maxAttempts||Infinity;this.backoff={MIN_RETRY_DELAY:opts.minRetryDelay||1e3,MAX_RETRY_DELAY:opts.maxRetryDelay||3e4,FACTOR:opts.backoffFactor||2,JITTER:opts.backoffJitter||0};this.timeouts={ACK_TIMER:1e3,RECLAIM_TIMER:3e3,RECLAIM_TIMEOUT:1e4,RECLAIM_WAIT:500};this.keys={IN_PROGRESS:"inProgress",QUEUE:"queue",RECLAIM_START:"reclaimStart",RECLAIM_END:"reclaimEnd",ACK:"ack"};this._schedule=new Schedule;this._processId=0;this._store=new Store(this.name,this.id,this.keys);this._store.set(this.keys.IN_PROGRESS,{});this._store.set(this.keys.QUEUE,[]);this._ack=bind(this._ack,this);this._checkReclaim=bind(this._checkReclaim,this);this._processHead=bind(this._processHead,this);this._running=false}Emitter(Queue.prototype);Queue.prototype.start=function(){if(this._running){this.stop()}this._running=true;this._ack();this._checkReclaim();this._processHead()};Queue.prototype.stop=Queue.prototype.shouldRetry=function(_,attemptNumber){if(attemptNumber>this.maxAttempts)return false;return true};Queue.prototype.getDelay=function(attemptNumber){var ms=this.backoff.MIN_RETRY_DELAY*Math.pow(this.backoff.FACTOR,attemptNumber);if(this.backoff.JITTER){var rand=Math.random();var deviation=Math.floor(rand*this.backoff.JITTER*ms);if(Math.floor(rand*10)<5){ms-=deviation}else{ms+=deviation}}return Number(Math.min(ms,this.backoff.MAX_RETRY_DELAY).toPrecision(1))};Queue.prototype.addItem=Queue.prototype.requeue=function(item,attemptNumber,error,id){if(this.shouldRetry(item,attemptNumber,error)){this._enqueue({item:item,attemptNumber:attemptNumber,time:this._schedule.now()+this.getDelay(attemptNumber),id:id||uuid()})}else{this.emit("discard",item,attemptNumber)}};Queue.prototype._enqueue=function(entry){var queue=this._store.get(this.keys.QUEUE)||[];queue=queue.slice(-(this.maxItems-1));queue.push(entry);queue=queue.sort(function(a,b){return a.time-b.time});this._store.set(this.keys.QUEUE,queue);if(this._running){this._processHead()}};Queue.prototype._processHead=function(){var self=this;var store=this._store;this._schedule.cancel(this._processId);var queue=store.get(this.keys.QUEUE)||[];var inProgress=store.get(this.keys.IN_PROGRESS)||{};var now=this._schedule.now();var toRun=[];function enqueue(el,id){toRun.push({item:el.item,done:function handle(err,res){var inProgress=store.get(self.keys.IN_PROGRESS)||{};delete inProgress[id];store.set(self.keys.IN_PROGRESS,inProgress);self.emit("processed",err,res,el.item);if(err){self.requeue(el.item,el.attemptNumber+1,err,el.id)}}})}var inProgressSize=Object.keys(inProgress).length;while(queue.length&&queue[0].time<=now&&inProgressSize++<self.maxItems){var el=queue.shift();var id=uuid();inProgress[id]={item:el.item,attemptNumber:el.attemptNumber,time:self._schedule.now()};enqueue(el,id)}store.set(this.keys.QUEUE,queue);store.set(this.keys.IN_PROGRESS,inProgress);each(toRun);queue=store.get(this.keys.QUEUE)||[];this._schedule.cancel(this._processId);if(queue.length>0){this._processId=this._schedule.run(this._processHead,queue[0].time-now,Schedule.Modes.ASAP)}};Queue.prototype._ack=function(){this._store.set(this.keys.ACK,this._schedule.now());this._store.set(this.keys.RECLAIM_START,null);this._store.set(this.keys.RECLAIM_END,null);this._schedule.run(this._ack,this.timeouts.ACK_TIMER,Schedule.Modes.ASAP)};Queue.prototype._checkReclaim=function(){var self=this;function tryReclaim(store){store.set(self.keys.RECLAIM_START,self.id);store.set(self.keys.ACK,self._schedule.now());self._schedule.run(function(){if(store.get(self.keys.RECLAIM_START)!==self.id)return;store.set(self.keys.RECLAIM_END,self.id);self._schedule.run(function(){if(store.get(self.keys.RECLAIM_END)!==self.id)return;if(store.get(self.keys.RECLAIM_START)!==self.id)return;self._reclaim(store.id)},self.timeouts.RECLAIM_WAIT,Schedule.Modes.ABANDON)},self.timeouts.RECLAIM_WAIT,Schedule.Modes.ABANDON)}function findOtherQueues(name){var res=[];var storage=self._store.getOriginalEngine();for(var i=0;i<storage.length;i++){var k=storage.key(i);var parts=k.split(".");if(parts.length!==3)continue;if(parts[0]!==name)continue;if(parts[2]!=="ack")continue;res.push(new Store(name,parts[1],self.keys))}return res}each(function(store){if(store.id===self.id)return;if(self._schedule.now()-store.get(self.keys.ACK)<self.timeouts.RECLAIM_TIMEOUT)return;tryReclaim(store)},findOtherQueues(this.name));this._schedule.run(this._checkReclaim,this.timeouts.RECLAIM_TIMER,Schedule.Modes.RESCHEDULE)};Queue.prototype._reclaim=function(id){var self=this;var other=new Store(this.name,id,this.keys);var our={queue:this._store.get(this.keys.QUEUE)||[]};var their={inProgress:other.get(this.keys.IN_PROGRESS)||{},queue:other.get(this.keys.QUEUE)||[]};var trackMessageIds=[];var addConcatQueue=function(queue,incrementAttemptNumberBy){each(function(el){var id=el.id||uuid();if(trackMessageIds.indexOf(id)>=0){self.emit("duplication",el.item,el.attemptNumber)}else{our.queue.push({item:el.item,attemptNumber:el.attemptNumber+incrementAttemptNumberBy,time:self._schedule.now(),id:id});trackMessageIds.push(id)}},queue)};addConcatQueue(their.queue,0);addConcatQueue(their.inProgress,1);our.queue=our.queue.sort(;this._store.set(this.keys.QUEUE,our.queue);other.remove(this.keys.IN_PROGRESS);other.remove(this.keys.QUEUE);other.remove(this.keys.RECLAIM_START);other.remove(this.keys.RECLAIM_END);other.remove(this.keys.ACK);this._processHead()};module.exports=Queue},{"./schedule":43,"./store":44,"@lukeed/uuid":2,"@ndhoule/each":8,"component-emitter":66,debug:45}],43:[function(require,module,exports){"use strict";var each=require("@ndhoule/each");var CLOCK_LATE_FACTOR=2;var defaultClock={setTimeout:clearTimeout:function(id){return window.clearTimeout(id)},Date:window.Date};var clock=defaultClock;var modes={ASAP:1,RESCHEDULE:2,ABANDON:3};chedule.prototype.now=Schedule.prototype.run=function(task,timeout,mode){var id=this.nextId++;this.tasks[id]=clock.setTimeout(this._handle(id,task,timeout,mode||modes.ASAP),timeout);return id};Schedule.prototype.cancel=Schedule.prototype.cancelAll=Schedule.prototype._handle=function(id,callback,timeout,mode){var self=this;var start=self.now();return function(){delete self.tasks[id];if(mode>=modes.RESCHEDULE&&start+timeout*CLOCK_LATE_FACTOR<self.now()){if(mode===modes.RESCHEDULE){self.run(callback,timeout,mode)}return}return callback()}};Schedule.setClock=Schedule.resetClock=Schedule.Modes=modes;module.exports=Schedule},{"@ndhoule/each":8}],44:[function(require,module,exports){"use strict";var defaultEngine=require("./engine").defaultEngine;var inMemoryEngine=require("./engine").inMemoryEngine;var each=require("@ndhoule/each");var keys=require("@ndhoule/keys");var json=JSON;function Store(name,id,keys,optionalEngine){this.id=id;this.name=name;this.keys=keys||{};this.engine=optionalEngine||defaultEngine;this.originalEngine=this.engine}Store.prototype.set=function(key,value){var compoundKey=this._createValidKey(key);if(!compoundKey)return;try{this.engine.setItem(compoundKey,json.stringify(value))}catch(err){if(isQuotaExceeded(err)){this._swapEngine();this.set(key,value)}}};Store.prototype.get=function(key){try{var str=this.engine.getItem(this._createValidKey(key));if(str===null){return null}return json.parse(str)}catch(err){return null}};Store.prototype.getOriginalEngine=Store.prototype.remove=Store.prototype._createValidKey=function(key){var name=this.name;var id=this.id;if(!keys(this.keys).length)return[name,id,key].join(".");var compoundKey;each(function(value){if(value===key){compoundKey=[name,id,key].join(".")}},this.keys);return compoundKey};Store.prototype._swapEngine=module.exports=Store;function isQuotaExceeded(e){var quotaExceeded=false;if(e.code){switch(e.code){case 22:quotaExceeded=true;break;case 1014:if(e.name==="NS_ERROR_DOM_QUOTA_REACHED"){quotaExceeded=true}break;default:break}}else if(e.number===-2147024882){quotaExceeded=true}return quotaExceeded}},{"./engine":41,"@ndhoule/each":8,"@ndhoule/keys":13}],45:[{}],46:[{}],47:[function(require,module,exports){"use strict";var define=Object.defineProperty;var initialProtocol=window.location.protocol;var mockedProtocol;module.exports=function(protocol){if(arguments.length===0){return get()}return set(protocol)};module.exports.http=function(){set("http:")};module.exports.https=module.exports.reset={}],48:[{"@segment/base64-encode":33,"has-cors":75,json3:79,jsonp:80}],49:[{json3:79}],50:[{"component-cookie":63,"component-url":70}],51:[function(require,module,exports){"use strict";var map=require("@ndhoule/map");var foldl=require("@ndhoule/foldl");var eventMap={videoPlaybackStarted:[{object:"video playback",action:"started"}],videoPlaybackPaused:[{object:"video playback",action:"paused"}],videoPlaybackInterrupted:[{object:"video playback",action:"interrupted"}],videoPlaybackResumed:[{object:"video playback",action:"resumed"}],videoPlaybackCompleted:[{object:"video playback",action:"completed"}],videoPlaybackExited:[{object:"video playback",action:"exited"}],videoPlaybackBufferStarted:[{object:"video playback buffer",action:"started"}],videoPlaybackBufferCompleted:[{object:"video playback buffer",action:"completed"}],videoPlaybackSeekStarted:[{object:"video playback seek",action:"started"}],videoPlaybackSeekCompleted:[{object:"video playback seek",action:"completed"}],videoContentStarted:[{object:"video content",action:"started"}],videoContentPlaying:[{object:"video content",action:"playing"}],videoContentCompleted:[{object:"video content",action:"completed"}],videoAdStarted:[{object:"video ad",action:"started"}],videoAdPlaying:[{object:"video ad",action:"playing"}],videoAdCompleted:[{object:"video ad",action:"completed"}],videoAdClicked:[{object:"video ad",action:"clicked"}],videoAdSkipped:[{object:"video ad",action:"skipped"}],promotionViewed:[{object:"promotion",action:"viewed"}],promotionClicked:[{object:"promotion",action:"clicked"}],productsSearched:[{object:"products",action:"searched"}],productListViewed:[{object:"product list",action:"viewed"},{object:"product category",action:"viewed"}],productListFiltered:[{object:"product list",action:"filtered"}],productClicked:[{object:"product",action:"clicked"}],productViewed:[{object:"product",action:"viewed"}],productAdded:[{object:"product",action:"added"}],productRemoved:[{object:"product",action:"removed"}],cartViewed:[{object:"cart",action:"viewed"}],orderUpdated:[{object:"order",action:"updated"}],orderCompleted:[{object:"order",action:"completed"}],orderRefunded:[{object:"order",action:"refunded"}],orderCancelled:[{object:"order",action:"cancelled"}],paymentInfoEntered:[{object:"payment info",action:"entered"}],checkoutStarted:[{object:"checkout",action:"started"}],checkoutStepViewed:[{object:"checkout step",action:"viewed"}],checkoutStepCompleted:[{object:"checkout step",action:"completed"}],couponEntered:[{object:"coupon",action:"entered"}],couponApplied:[{object:"coupon",action:"applied"}],couponDenied:[{object:"coupon",action:"denied"}],couponRemoved:[{object:"coupon",action:"removed"}],productAddedToWishlist:[{object:"product",action:"added to wishlist"}],productRemovedFromWishlist:[{object:"product",action:"removed from wishlist"}],productAddedFromWishlistToCart:[{object:"product",action:"added to cart from wishlist"},{object:"product",action:"added from wishlist to cart"}],wishlistProductAddedToCart:[{object:"wishlist product",action:"added to cart"}],productShared:[{object:"product",action:"shared"}],cartShared:[{object:"cart",action:"shared"}],productReviewed:[{object:"product",action:"reviewed"}],applicationInstalled:[{object:"application",action:"installed"}],applicationUpdated:[{object:"application",action:"updated"}],applicationOpened:[{object:"application",action:"opened"}],applicationBackgrounded:[{object:"application",action:"backgrounded"}],applicationUninstalled:[{object:"application",action:"uninstalled"}],applicationCrashed:[{object:"application",action:"crashed"}],installAttributed:[{object:"install",action:"attributed"}],deepLinkOpened:[{object:"deep link",action:"opened"}],deepLinkClicked:[{object:"deep link",action:"clicked"}],pushNotificationReceived:[{object:"push notification",action:"received"}],pushNotificationTapped:[{object:"push notification",action:"tapped"}],pushNotificationBounced:[{object:"push notification",action:"bounced"}],emailBounced:[{object:"email",action:"bounced"}],emailDelivered:[{object:"email",action:"delivered"}],emailLinkClicked:[{object:"email link",action:"clicked"}],emailMarkedAsSpam:[{object:"email",action:"marked as spam"}],emailOpened:[{object:"email",action:"opened"}],unsubscribed:[{object:"",action:"unsubscribed"}],liveChatConversationEnded:[{object:"live chat conversation",action:"ended"}],liveChatConversationStarted:[{object:"live chat conversation",action:"started"}],liveChatMessageReceived:[{object:"live chat message",action:"received"}],liveChatMessageSent:[{object:"live chat message",action:"sent"}]};module.exports=foldl({},eventMap)},{"@ndhoule/foldl":11,"@ndhoule/map":14}],52:[function(require,module,exports){function ads(query){var queryIds={btid:"dataxu",urid:"millennial-media"};if(query.lastIndexOf("?",0)===0){query=query.substring(1)}query=query.replace(/\?/g,"&");var parts=query.split("&");for(var i=0;i<parts.length;i++){var k=parts[i].split("=")[0];var v=parts[i].split("=")[1];if(queryIds[k]){return{id:v,type:queryIds[k]}}}}module.exports=ads},{}],53:[function(require,module,exports){"use strict";var ads=require("./ads");var clone=require("component-clone");var cookie=require("component-cookie");var extend=require("@ndhoule/extend");var integration=require("@segment/analytics.js-integration");var json=require("json3");var keys=require("@ndhoule/keys");var localstorage=require("yields-store");var protocol=require("@segment/protocol");var send=require("@segment/send-json");var topDomain=require("@segment/top-domain");var utm=require("./utm");var Queue=require("@segment/localstorage-retry");var url=require("component-url");const Middlewares={FixRelativeUrl:require("./middleware/fixRelativeUrl")};var cookieOptions={maxage:31536e6,secure:false,path:"/"};var MAX_SIZE=32*1e3;var queueOptions={maxRetryDelay:36e4,minRetryDelay:1e3,backoffFactor:2,maxAttempts:10,maxItems:100};var Attribution=(exports=module.exports=integration("Attribution").option("projectId","").option("apiHost","track.attributionapp.com").option("retryQueue",true)).option("sourceMiddlewares",["FixRelativeUrl"]);exports.storage=function(){return protocol()==="file:"||protocol()==="chrome-extension:"?localstorage:cookie};exports.global=window;exports.sendJsonWithTimeout=function(url,obj,headers,timeout,fn){if(send.type!=="xhr"){send(url,obj,headers,fn);return}var req=new XMLHttpRequest;req.onerror=fn;req.onreadystatechange=done;req.open("POST",url,true);req.timeout=timeout;req.ontimeout=fn;for(var k in headers){req.setRequestHeader(k,headers[k])}req.send(json.stringify(obj));function done(){if(req.readyState===4){if(req.status===429||req.status>=500&&req.status<600){fn(new Error("HTTP Error "+req.status+" ("+req.statusText+")"))}else{fn(null,req)}}}};Attribution.prototype.addMiddlewares=function(){for(const middlewareName of this.options.sourceMiddlewares){const middleware=Middlewares[middlewareName];if(typeof middleware!=="undefined"){this.analytics.addSourceMiddleware(middleware)}}};Attribution.prototype.initialize=function(){this.addMiddlewares();var self=this;if(this.options.retryQueue){this._lsqueue=new Queue("Attribution",queueOptions,function(elem,done){var item=elem;item.msg.sentAt=new Date;Attribution.sendJsonWithTimeout(item.url,item.msg,item.headers,10*1e3,});this._lsqueue.start()}this.ready();this.analytics.on("invoke",function(msg){var action=msg.action();var listener="on"+msg.action();self.debug("%s %o",action,msg);if(self[listener])self[listener](msg);self.ready()})};Attribution.prototype.loaded=function(){return true};Attribution.prototype.onpage=function(page){this.enqueue("/v1/p",page.json())};Attribution.prototype.onidentify=function(identify){this.enqueue("/v1/i",identify.json())};Attribution.prototype.ongroup=Attribution.prototype.ontrack=function(track){var json=track.json();this.enqueue("/v1/t",json)};Attribution.prototype.onalias=function(alias){var json=alias.json();var user=this.analytics.user();json.previousId=json.previousId||json.from||user.id()||user.anonymousId();json.userId=json.userId||json.to;delete json.from;delete json.to;this.enqueue("/v1/a",json)};Attribution.prototype.normalize=function(message){var msg=message;this.debug("normalize %o",msg);var user=this.analytics.user();var global=exports.global;var query=global.location.search;var ctx=msg.context=msg.context||msg.options||{};delete msg.options;msg.projectId=this.options.projectId;ctx.userAgent=navigator.userAgent;var locale=navigator.userLanguage||navigator.language;if(typeof ctx.locale==="undefined"&&typeof locale!=="undefined"){ctx.locale=locale}if(!ctx.library)ctx.library={name:"attribution.js",version:this.analytics.VERSION};if(query&&!ctx.campaign){ctx.campaign=utm(query)}this.referrerId(query,ctx);msg.userId=msg.userId||user.id();this.setAnonymousIdFromQuery(query);msg.anonymousId=user.anonymousId();msg.sentAt=new Date;var failedInitializations=this.analytics.failedInitializations||[];if(failedInitializations.length>0){msg._metadata={failedInitializations:failedInitializations}}if(this.options.addBundledMetadata){var bundled=keys(this.analytics.Integrations);msg._metadata=msg._metadata||{};msg._metadata.bundled=bundled;msg._metadata.unbundled=this.options.unbundledIntegrations}this.debug("normalized %o",msg);return msg};Attribution.prototype.enqueue=function(path,message,fn){var url=scheme()+"//"+this.options.apiHost+path;var headers={"Content-Type":"text/plain"};var msg=this.normalize(message);if(json.stringify(msg).length>MAX_SIZE){this.debug("message must be less than 32kb %O",msg)}this.debug("enqueueing %O",msg);var self=this;if(this.options.retryQueue){this._lsqueue.addItem({url:url,headers:headers,msg:msg})}else{send(url,msg,headers,}};Attribution.prototype.cookie=function(name,val){var store=Attribution.storage();if(arguments.length===1)return store(name);var global=exports.global;var href=global.location.href;var domain="."+topDomain(href);if(domain===".")domain="";this.debug("store domain %s -> %s",href,domain);var opts=clone(cookieOptions);opts.domain=domain;this.debug("store %s, %s, %o",name,val,opts);store(name,val,opts);if(store(name))return;delete opts.domain;this.debug("fallback store %s, %s, %o",name,val,opts);store(name,val,opts)};Attribution.prototype.referrerId=function(query,ctx){var stored=this.cookie("s:context.referrer");var ad;if(stored)stored=json.parse(stored);if(query)ad=ads(query);ad=ad||stored;if(!ad)return;ctx.referrer=extend(ctx.referrer||{},ad);this.cookie("s:context.referrer",json.stringify(ad))};Attribution.prototype.setAnonymousIdFromQuery=function(query){var idFromQuery=url.parse(query).anonymous_id;if(idFromQuery){this.analytics.setAnonymousId(idFromQuery)}};function getJson(url,callback){var xhr=new XMLHttpRequest;xhr.open("GET",url,true);xhr.withCredentials=true;xhr.onreadystatechange=function(){if(xhr.readyState===XMLHttpRequest.DONE){if(xhr.status>=200&&xhr.status<300){callback(null,xhr.responseText?json.parse(xhr.responseText):null)}else{callback(xhr.statusText||"Unknown Error",null)}}};xhr.send()}function httpGet(url,callback){var xhr=new XMLHttpRequest;xhr.open("GET",url,true);xhr.withCredentials=true;xhr.onreadystatechange=function(){if(xhr.readyState===XMLHttpRequest.DONE){if(xhr.status>=200&&xhr.status<300){callback(null,xhr.responseText)}else{callback(xhr.statusText||xhr.responseText||"Unknown Error",null)}}};xhr.send()}{"./ads":52,"./middleware/fixRelativeUrl":54,"./utm":55,"@ndhoule/extend":10,"@ndhoule/keys":13,"@segment/analytics.js-integration":56,"@segment/localstorage-retry":42,"@segment/protocol":47,"@segment/send-json":59,"@segment/top-domain":50,"component-clone":62,"component-cookie":63,"component-url":70,json3:79,"yields-store":115}],54:[function(require,module,exports){"use strict";function FixRelativeUrl({payload,next,integrations}){try{if(payload.obj.context.page.url.charAt(0)=="/"){payload.obj.context.page.url=window.location.origin+payload.obj.context.page.url}if(payload.obj.properties.url.charAt(0)=="/"){payload.obj.properties.url=window.location.origin+payload.obj.properties.url}}catch(e){}finally{next(payload)}}module.exports=FixRelativeUrl},{}],55:[function(require,module,exports){function utm(query){if(query.lastIndexOf("?",0)===0){query=query.substring(1)}query=query.replace(/\?/g,"&");var split=query.split("&");var acc={};for(var i=0;i<split.length;i++){var k=split[i].split("=")[0];var v=split[i].split("=")[1]||"";if(k.indexOf("utm_")!==-1&&k.length>4){var utmParam=k.substr(4);if(utmParam==="campaign"){utmParam="name"}acc[utmParam]=decodeURIComponent(v.replace(/\+/g," "))}}return acc}module.exports=utm},{}],56:[function(require,module,exports){"use strict";var bind=require("component-bind");var clone=require("@ndhoule/clone");var debug=require("debug");var defaults=require("@ndhoule/defaults");var extend=require("@ndhoule/extend");var slug=require("slug-component");var protos=require("./protos");var statics=require("./statics");function createIntegration(name){function Integration(options){if(options&&options.addIntegration){return options.addIntegration(Integration)}this.debug=debug("analytics:integration:"+slug(name));this.options=defaults(clone(options)||{},this.defaults);this._queue=[];this.once("ready",bind(this,this.flush));Integration.emit("construct",this);this.ready=bind(this,this.ready);this._wrapInitialize();this._wrapPage();this._wrapTrack()}Integration.prototype.defaults={};Integration.prototype.globals=[];Integration.prototype.templates={};Integration.prototype.name=name;extend(Integration,statics);extend(Integration.prototype,protos);return Integration}module.exports=createIntegration},{"./protos":57,"./statics":58,"@ndhoule/clone":5,"@ndhoule/defaults":6,"@ndhoule/extend":10,"component-bind":61,debug:71,"slug-component":102}],57:[function(require,module,exports){"use strict";var Emitter=require("component-emitter");var after=require("@ndhoule/after");var each=require("@ndhoule/each");var events=require("analytics-events");var every=require("@ndhoule/every");var fmt=require("@segment/fmt");var foldl=require("@ndhoule/foldl");var is=require("is");var loadIframe=require("load-iframe");var loadScript=require("@segment/load-script");var nextTick=require("next-tick");var normalize=require("to-no-case");var has=Object.prototype.hasOwnProperty;var noop=function noop(){};var onerror=window.onerror;var onload=null;Emitter(exports);exports.initialize=exports.loaded=function(){return false};exports.page=function(page){};exports.track=exports.map=exports.invoke=exports.queue=function(method,args){if(method==="page"&&this._assumesPageview&&!this._initialized){return this.page.apply(this,args)}this._queue.push({method:method,args:args})};exports.flush=exports.reset=exports.load=exports.locals=exports.ready=exports._wrapInitialize=function(){var initialize=this.initialize;this.initialize=if(this._assumesPageview)this.initialize=after(2,this.initialize)};exports._wrapPage=function(){var page=this.page;this.page=function(){if(this._assumesPageview&&!this._initialized){return this.initialize.apply(this,arguments)}return page.apply(this,arguments)}};exports._wrapTrack=ndhoule/after":3,"@ndhoule/each":8,"@ndhoule/every":9,"@ndhoule/foldl":11,"@segment/fmt":36,"@segment/load-script":40,"analytics-events":51,"component-emitter":66,is:78,"load-iframe":81,"next-tick":86,"to-no-case":106}],58:[{"@ndhoule/each":8,"@ndhoule/includes":12,"component-emitter":66,domify:73}],59:[function(require,module,exports){"use strict";var base64encode=require("@segment/base64-encode");var cors=require("has-cors");var jsonp=require("jsonp");exports=module.exports=cors?json:base64;exports.callback="callback";exports.prefix="data";exports.json=json;exports.base64=base64;exports.type=cors?"xhr":"jsonp";function json(url,obj,headers,timeout,fn){var req=new XMLHttpRequest;req.onerror=fn;req.onreadystatechange=done;req.open("POST",url,true);if(timeout){req.timeout=timeout;req.ontimeout=fn}for(var k in headers){req.setRequestHeader(k,headers[k])}req.send(JSON.stringify(obj));function base64(url,obj,headers,timeout,fn){var prefix=exports.prefix;var data=encode(obj);url+="?"+prefix+"="+data;jsonp(url,{param:exports.callback},},{"@segment/base64-encode":33,"has-cors":75,jsonp:80}],60:[{"component-bind":61}],61:[{}],62:[{"component-type":69,type:69}],63:[{debug:71}],64:[{"component-type":65,"to-function":105,type:65}],65:[{}],66:[{}],67:[{}],68:[{}],69:[{}],70:[{}],71:[{"./debug":72,_process:88}],72:[{ms:82}],73:[function(require,module,exports){module.exports=parse;var innerHTMLBug=false;var bugTestDiv;if(typeof document!=="undefined"){bugTestDiv=document.createElement("div");bugTestDiv.innerHTML='  <link/><table></table><a href="/a">a</a><input type="checkbox"/>';innerHTMLBug=!bugTestDiv.getElementsByTagName("link").length;bugTestDiv=undefined}var map={legend:[1,"<fieldset>","</fieldset>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],_default:innerHTMLBug?[1,"X<div>","</div>"]:[0,"",""]};map.td=map.th=[3,"<table><tbody><tr>","</tr></tbody></table>"];map.option=map.optgroup=[1,'<select multiple="multiple">',"</select>"];map.thead=map.tbody=map.colgroup=map.caption=map.tfoot=[1,"<table>","</table>"];map.polyline=map.ellipse=map.polygon=map.circle=map.text=map.line=map.path=map.rect=map.g=[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">',"</svg>"];function parse(html,doc){if("string"!=typeof html)throw new TypeError("String expected");if(!doc)doc=document;var m=/<([\w:]+)/.exec(html);if(!m)return doc.createTextNode(html);html=html.replace(/^\s+|\s+$/g,"");var tag=m[1];if(tag=="body"){var el=doc.createElement("html");el.innerHTML=html;return el.removeChild(el.lastChild)}var wrap=Object.prototype.hasOwnProperty.call(map,tag)?map[tag]:map._default;var depth=wrap[0];var prefix=wrap[1];var suffix=wrap[2];var el=doc.createElement("div");el.innerHTML=prefix+html+suffix;while(depth--)el=el.lastChild;if(el.firstChild==el.lastChild){return el.removeChild(el.firstChild)}var fragment=doc.createDocumentFragment();while(el.firstChild){fragment.appendChild(el.removeChild(el.firstChild))}return fragment}},{}],74:[{}],75:[{}],76:[{}],77:[function(require,module,exports){module.exports=,{}],78:[{}],79:[{}],80:[function(require,module,exports){var debug=require("debug")("jsonp");module.exports=jsonp;var count=0;function noop(){}function jsonp(url,opts,fn){if("function"==typeof opts){fn=opts;opts={}}if(!opts)opts={};var prefix=opts.prefix||"__jp";var id=opts.name||prefix+count++;var param=opts.param||"callback";var timeout=null!=opts.timeout?opts.timeout:6e4;var enc=encodeURIComponent;var target=document.getElementsByTagName("script")[0]||document.head;var script;var timer;if(timeout){timer=setTimeout(timeout)}function cleanup(){if(script.parentNode)script.parentNode.removeChild(script);window[id]=noop;if(timer)clearTimeout(timer)}indow[id]=function(data){debug("jsonp got",data);cleanup();if(fn)fn(null,data)};url+=(~url.indexOf("?")?"&":"?")+param+"="+enc(id);url=url.replace("?&","?");debug('jsonp req "%s"',url);script=document.createElement("script");script.src=url;target.parentNode.insertBefore(script,target);return cancel}},{debug:71}],81:[{is:78,"next-tick":86,"script-onload":89}],82:[{}],83:[function(require,module,exports){"use strict";var isodate=require("@segment/isodate");var milliseconds=require("./milliseconds");var seconds=require("./seconds");var objProto=Object.prototype;var toStr=objProto.toString;function isDate(value){return toStr.call(value)==="[object Date]"}odule.exports=function newDate(val){if(isDate(val))return val;if(isNumber(val))return new Date(toMs(val));if(isodate.is(val)){return isodate.parse(val)}if(milliseconds.is(val)){return milliseconds.parse(val)}if(seconds.is(val)){return seconds.parse(val)}return new Date(val)};,{"./milliseconds":84,"./seconds":85,"@segment/isodate":39}],84:[{}],85:[{}],86:[{_process:88,timers:104}],87:[function(require,module,exports){var identity=module.exports=multiple(find);module.exports.find=module.exports;module.exports.replace=module.exports.del=function multiple(fn){return function(obj,path,val,options){var normalize=options&&isFunction(options.normalizer)?options.normalizer:defaultNormalize;path=normalize(path);var key;var finished=false;while(!finished)loop();f(!key)return;if(null==obj)return obj;return fn(obj,key,val)}},88:[{}],89:[{}],90:[{"obj-case":87}],91:[{"./facade":93,"./utils":101}],92:[{"./facade":93,"./utils":101}],93:[{"./address":90,"./is-enabled":97,"./utils":101,"@segment/isodate-traverse":38,"new-date":83,"obj-case":87}],94:[{"./facade":93,"./utils":101,"is-email":77,"new-date":83}],95:[{"./facade":93,"./utils":101,"is-email":77,"new-date":83,"obj-case":87,trim:107}],96:[{"./alias":91,"./delete":92,"./facade":93,"./group":94,"./identify":95,"./page":98,"./screen":99,"./track":100}],97:[{}],98:[{"./facade":93,"./track":100,"./utils":101,"is-email":77}],99:[{"./page":98,"./track":100,"./utils":101}],100:[{"./facade":93,"./identify":95,"./utils":101,"is-email":77,"obj-case":87}],101:[{"@ndhoule/clone":5,inherits:76,"type-component":108}],102:[{}],103:[{}],104:[{"process/browser.js":88,timers:104}],105:[{"component-props":68,props:68}],106:[{}],107:[{}],108:[{}],109:[{}],110:[{"./v1":113,"./v4":114}],111:[{}],112:[{}],113:[{"./lib/bytesToUuid":111,"./lib/rng":112}],114:[{"./lib/bytesToUuid":111,"./lib/rng":112}],115:[function(require,module,exports){var unserialize=require("unserialize");var each=require("each");var storage;try{storage=window.localStorage}catch(e){storage=null}module.exports=store;function store(key,value){var length=arguments.length;if(0==length)return all();if(2<=length)return set(key,value);if(1!=length)return;if(null==key)return storage.clear();if("string"==typeof key)return get(key);if("object"==typeof key)return each(key,set)}store.supported=!!storage;nction all(){var len=storage.length;var ret={};var key;while(0<=--len){key=storage.key(len);ret[key]=get(key)}return ret}},{each:64,unserialize:116}],116:[function(require,module,exports){module.exports=,{}]},{},[1])(1)});