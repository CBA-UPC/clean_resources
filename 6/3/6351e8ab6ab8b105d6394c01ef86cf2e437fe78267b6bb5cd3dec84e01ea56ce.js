"use strict";var _slicedToArray=((),_createClass=(function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}})();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!(function(){var e=function(e){e.parentNode&&e.parentNode.removeChild(e)},t=(function(){eturn _createClass(t,[{key:"destructor",value:,{key:"initDetailViewIframe",value:function(e,t,i){i=i||{};this.iframe=document.createElement("iframe"),this.iframe.setAttribute("id","wallsio-widget-detail-view"),this.iframe.setAttribute("style",["border: 0","width: 100%","height: 100%","position: fixed","top: 0","right: 0","bottom: 0","left: 0","z-index: 2147483647","display: none","opacity: 0","transition: opacity 0.3s ease"].join(";")),this.iframe.setAttribute("allowfullscreen","");var r=new URL(t+"/p/"+e);if(r.host){r.searchParams.append("theme","single"),r.searchParams.append("widget_id",this.widgetId);var a=!0,n=!1,o=void 0;try{for(var l,s=Object.entries(i)[Symbol.iterator]();!(a=(l=s.next()).done);a=!0){var c=l.value,d=_slicedToArray(c,2),u=d[0],f=d[1];r.searchParams.append(u,f)}}catch(e){n=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(n)throw o}}this.iframe.setAttribute("src",r.toString()),document.body.appendChild(this.iframe)}else console.error("Invalid wall url",t)}},{key:"openModalView",value:function(t){var i=["position: fixed","border: 0","width: 100%","height: 100%","top: 0","right: 0","bottom: 0","left: 0","background-color: #000000c2","opacity: 1","transition: all 0.25s ease","z-index:"+Number.MAX_SAFE_INTEGER],r=document.createElement("div");r.id="detailModalView",r.setAttribute("style",i.join(";"));r.innerHTML="<div id='closeDetailModalView'><svg style='height:30px' aria-hidden='true' focusable='false' data-prefix='fas' data-icon='times' class='svg-inline--fa fa-times fa-w-11' role='img' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 352 512'><path fill='currentColor' d='M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z'></path></svg></div>",r.appendChild(t),document.body.appendChild(r);var a=function(){var t=r;t.style.opacity=0,setTimeout((,100)};document.getElementById("closeDetailModalView").setAttribute("style",["position: absolute","width: 50px","height: 50px","padding: 15px","top: 0","right: 0","cursor: pointer","color: white","background-color: #000000c2","border-radius: 50%","display: flex","align-items: center","margin: 10px","box-sizing: border-box"].join(";")),document.getElementById("closeDetailModalView").addEventListener("click",(),window.addEventListener("message",()}},{key:"initDirectPostIframe",value:function(e,t,i){var r=this;i=i||{};var a,n=["border: 0","width: 100%","height: 100%","opacity: 0","transition: all 0.25s ease"],o=new URL(t);(a=document.getElementById("detailModalView"))?(a.style.visibility="visible",a.style.opacity="1",setTimeout((,100)):(function(){var a=document.createElement("iframe");if(a.setAttribute("id","wallsio-widget-direct-post-view"),a.setAttribute("style",n.join(";")),o.host){var l=!0,s=!1,c=void 0;try{for(var d,u=Object.entries(i)[Symbol.iterator]();!(l=(d=u.next()).done);l=!0){var f=d.value,h=_slicedToArray(f,2),m=h[0],y=h[1];o.searchParams.set(m,y)}}catch(e){s=!0,c=e}finally{try{!l&&u.return&&u.return()}finally{if(s)throw c}}o.searchParams.set("wallId",e),a.src=o.toString(),a.onload=r.openModalView(a)}else console.error("Invalid widget URL",t)})()}},{key:"triggerDocumentEventInDetailViewIframe",value:function(e,t){return!!this.iframe.contentWindow&&(this.iframe.contentWindow.postMessage({method:"Wallsio.triggerDocumentEvent",args:[e,t]},"*"),!0)}},{key:"changeCheckin",value:,{key:"showWidgetDetail",value:function(e,t,i){!!this.iframe&&this.iframe.parentElement?this.changeCheckin(e):this.initDetailViewIframe(e,t,i),this.iframe.style.setProperty("display","block"),this.iframe.style.setProperty("opacity","1")}},{key:"showWidgetDirectPost",value:,{key:"hideWidgetDetail",value:function(){var e=this;this.iframe?(this.iframe.style.setProperty("opacity","0"),setTimeout((,300)):console.error("WallsioWidgetDetailView.hideWidgetDetail() was called, but the iframe doesn't exist yet.")}}]),t})();window.WallsioWidgetDetailView||(window.WallsioWidgetDetailView=t)})();
"use strict";var _createClass=(();function(){if(document.body){var t=Number.MAX_SAFE_INTEGER||9007199254740991,e=void 0;"function"==typeof window.CustomEvent?e=window.CustomEvent:(e=.prototype=window.Event.prototype;var i=(function(){var t=document.querySelector("script[data-wallurl]:not([data-wallsio-was-fired])");if(!t)throw new Error("Walls.io <script> tag not found");return t.dataset.wallsioWasFired=!0,t})(),a=i.getAttribute("id")||"wallsio-widget-"+Math.floor(Math.random()*t),s=function(t,e){Object.keys(t).forEach(()},o=n=r=function(t){var e=i.getAttribute("data-"+t);return""===e?null:(function(t){return"string"==typeof t&&""!==t&&!isNaN(t)})(e)?Number(e):e},l=function(t,e){var i=void 0,a=(function(t){t=(t=t.replace(/^https:\/\/dev\.walls\.io/,"https://dev-my.walls.io")).replace(/^https:\/\/walls\.io/,"https://my.walls.io");var e=document.createElement("a");return e.href=t,e})(t.wallUrl),s=a.search.replace(/^\?/,"");return(i=s.length>0?s.split("&"):[]).push("widget_id="+e),(t.notscrollable||t.autoheight)&&i.push("notscrollable=1"),t.autoheight&&i.push("autoheight=1"),(i=i.filter(()).length>0&&(a.search="?"+i.join("&")),a.href},h=d=(function(){function t(e){_classCallCheck(this,t),this.widgetId=e,this.detailView=new WallsioWidgetDetailView(e),this.autoHeightInterval=null,this.currentHeight=0,this.isInitialized=!1,this.isLoaded=!1,this.params=(function(){var t={};if(["autoheight","height","injectLoadMoreButton","lazyload","lazyloadDistance","loadMoreCount","loadMoreText","notscrollable","iframe","title","wallUrl","width","accessibility"].forEach((),!t.wallUrl)throw new Error("missing data-wallurl attribute");return t.height||(t.height=400),t})(),this.src=l(this.params,this.widgetId),this.initialHeight=this.params.height,this.iframe=this.getInitialIframe();var i=this.params.lazyload;this.init(),i?this._initLazyLoad():this.loadContent()}return _createClass(t,[{key:"getInitialIframe",value:function(){var t=this.params.iframe;if(!t)return null;var e=document.getElementById(t);return e?e.tagName.toLowerCase()?e:(console.error("Element with id '"+t+"' is not an iframe"),null):(console.error("There is no element with id '"+t+"'"),null)}},{key:"init",value:function(){this.isInitialized||(this.initDom(),this._initPostMessageChannel(),this.params.autoheight&&this.initAutoHeight(),this.isInitialized=!0)}},{key:"initAutoHeight",value:function(){var t=this;this.iframe.addEventListener("load",()}},{key:"initDom",value:function(){var t,e;this.iframe||(this.iframe=document.createElement("iframe")),this.initIframe(),e=this.iframe,document.body.contains(e)||(t=this.iframe,o(t,i)),this.params.injectLoadMoreButton&&this.injectLoadMoreButton()}},{key:"injectLoadMoreButton",value:function(){var t=this.createLoadMoreButton();o(t,i)}},{key:"restoreLoadMoreButtonIfNeeded",value:function(){if(this.params.injectLoadMoreButton){var t=h(this.widgetId);document.getElementById(t)||this.injectLoadMoreButton()}}},{key:"initIframe",value:function(){var t=["border: 0"];this.params.width&&(isNaN(this.params.width)?t.push("width: 100%"):t.push("width: "+this.params.width+"px")),isNaN(this.params.height)?t.push("height: 100%"):t.push("height: "+this.params.height+"px");var e=this.iframe.getAttribute("id"),i=e||"wallsio-iframe-"+this.widgetId;e||this.iframe.setAttribute("id",i),this.params.title&&this.iframe.setAttribute("title",this.params.title),this.iframe.setAttribute("id",i),this.iframe.setAttribute("class","wallsio-iframe "+i),this.iframe.setAttribute("allowfullscreen",""),this.iframe.setAttribute("style",t.join(";"))}},{key:"clearIframeContent",value:function(){try{this.iframe.contentDocument.open(),this.iframe.contentDocument.close()}catch(t){console.error(t)}}},{key:"loadContent",value:function(){this.isLoaded||(this.isLoaded=!0,this.iframe.contentWindow.location.replace(this.src))}},{key:"createLoadMoreButton",value:function(){var t=this,e=document.createElement("button"),i=this.params.loadMoreText||"load more",a=this.params.loadMoreCount||18,s=h(this.widgetId);return e.setAttribute("type","button"),e.setAttribute("id",s),e.setAttribute("class","wallsio-load-more-button "+s),e.innerText=i,e.addEventListener("click",(),document.addEventListener("WallsioNoMorePosts",(),e}},{key:"destructor",value:function(){clearInterval(this.autoHeightInterval),this._closePostMessageChannel(),this.iframe&&n(this.iframe),this.detailView.destructor(),n(i),delete window.WallsioWidgets[this.widgetId]}},{key:"_sendPostMessage",value:function(t){for(var e=arguments.length,i=Array(e>1?e-1:0),a=1;a<e;a++)i[a-1]=arguments[a];return!(!this.iframe||!this.iframe.contentWindow)&&(this.iframe.contentWindow.postMessage({method:t,args:i},"*"),!0)}},{key:"_postMessageIsFromValidSource",value:function(t){return!(!this.iframe||!this.iframe.contentWindow||t.source!==this.iframe.contentWindow)||this.detailView&&this.detailView.iframe&&this.detailView.iframe.contentWindow&&t.source===this.detailView.iframe.contentWindow}},{key:"_handlePostMessage",value:function(t){var e,i;if(t&&t.data&&t.data.method)if(this._postMessageIsFromValidSource(t)){if(!t.data.widgetId||t.data.widgetId===this.widgetId)switch(t.data.method){case"Wallsio.height":this._setIframeHeight.apply(this,t.data.args);break;case"Wallsio.triggerDomEvent":this._triggerDomEvent.apply(this,t.data.args);break;case"Wallsio.showWidgetDetail":(e=this.detailView).showWidgetDetail.apply(e,_toConsumableArray(t.data.args));break;case"Wallsio.showDirectPostView":(i=this.detailView).showWidgetDirectPost.apply(i,_toConsumableArray(t.data.args));break;case"Wallsio.hideWidgetDetail":this._sendPostMessage("Wallsio.triggerDocumentEvent","wall.hideIframeDetailOverlay"),this.detailView.hideWidgetDetail()}}else console.error("postMessage is not from the iframe")}},{key:"_initPostMessageChannel",value:,{key:"_closePostMessageChannel",value:,{key:"_getViewportHeight",value:,{key:"_getWidgetDistanceFromViewportBottom",value:function(){return this.iframe.getBoundingClientRect().top-this._getViewportHeight()}},{key:"_checkLazyLoad",value:function(){if(!this.isLoaded){var t=this._getWidgetDistanceFromViewportBottom(),e=this._getViewportHeight();t<(null!==this.params.lazyloadDistance?this.params.lazyloadDistance:e)&&this.loadContent()}}},{key:"_initLazyLoad",value:function(){var t=this;this.clearIframeContent(),(function(t){if(i.async)if("complete"!==document.readyState){var e=!1;addEventListener("load",(function(){e||(e=!0,t())})),setTimeout((,3e3)}else t();else t()})(()}},{key:"_startLazyLoadInterval",value:function(){var t,e,i,a,s=this,o=(t=this._checkLazyLoad.bind(this),e=100,i=void 0,a=void 0,;window.addEventListener("scroll",o,!0),setTimeout((,0)}},{key:"_setIframeHeight",value:function(t){var e=this.initialHeight;return t=Math.max(t,e),this.currentHeight!==t&&(this.iframe.style.height=t+"px",this.currentHeight=t,!0)}},{key:"isAutoheightActive",value:,{key:"setAutoHeight",value:function(t){var e=this;if(!this.iframe||!this.iframe.contentWindow)return!1;var i=!t;return this._sendPostMessage("Wallsio.setAutoFillEnabled",i),!1===t?(clearInterval(this.autoHeightInterval),!1):!this.autoHeightInterval&&(this.autoHeightInterval=setInterval((,1e3),this._sendPostMessage("Wallsio.getHeight"),!0)}},{key:"loadMorePosts",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return!(!this.iframe||!this.iframe.contentWindow)&&(this._sendPostMessage("Wallsio.requestOlderCheckins",t),!0)}},{key:"setNetworkFilter",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.isAutoheightActive()&&this._setIframeHeight(this.initialHeight),this._sendPostMessage("Wallsio.setNetworkFilter",t),this.restoreLoadMoreButtonIfNeeded()}},{key:"_triggerDomEvent",value:function(t){if(document.dispatchEvent){var i=new e(t,{detail:{widgetId:this.widgetId}});document.dispatchEvent(i)}}}]),t})();window.WallsioWidgets=window.WallsioWidgets||{},window.WallsioWidgets[a]?console.error('This page already contains a walls.io script widget with the id "'+a+'". To use multiple <script> widgets on the same page, please use different "id" attributes for each of them.'):(window.WallsioWidgets[a]=new d(a),window.Wallsio||(window.Wallsio={setAutoHeight:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];s(window.WallsioWidgets,(function(t){t.setAutoHeight.apply(t,e)}))},setNetworkFilter:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];s(window.WallsioWidgets,(function(t){t.setNetworkFilter.apply(t,e)}))},loadMorePosts:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];s(window.WallsioWidgets,()},destructor:function(){s(window.WallsioWidgets,()}}))}else console.error("Please add the Walls.io <script> tag inside the <body> of the page.")})();