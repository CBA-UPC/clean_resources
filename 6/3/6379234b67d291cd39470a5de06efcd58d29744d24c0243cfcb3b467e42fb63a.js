(self.webpackChunktama_web=self.webpackChunktama_web||[]).push([[7524],{10793:(t,e,n)=>{"use strict";n.d(e,{f:()=>c});var r=n(76955),o=n(52377),i=n(5154),a=n.n(i),s=n(54285);class c extends r.PureComponent{constructor(t){super(t),this.handleClick=this.handleClick.bind(this),this.handleInview=this.handleInview.bind(this),this.startListen=this.startListen.bind(this),this.stopListen=this.stopListen.bind(this),this.inviewTracked=!1,this.tapTracked=!1}static get defaultProps(){return{activate:["tap"],algorithmId:"",bloggerAmebaId:"",categories:[],categoryId:"",subCategoryId:"",children:null,contentId:"",disable:!1,displayPosition:"",entryId:"",orderId:"",pageId:"",sectionId:"",serviceId:"",tagName:"",tapLogger:a(),viewLogger:a()}}componentDidMount(){this.startListen()}componentDidUpdate(){this.startListen()}et params(){var{algorithmId:t,bloggerAmebaId:e,categoryId:n,subCategoryId:r,contentId:o,displayPosition:i,pageId:a,entryId:s,orderId:c,sectionId:d,serviceId:l,tagName:m}=this.props;return{algorithmId:t,bloggerAmebaId:e,categories:this.props.categories.filter((),categoryId:n,subCategoryId:r,contentId:o,displayPosition:i,pageId:a,entryId:s,orderId:c,sectionId:d,serviceId:l,tagName:m}}startListen(){-1===this.props.activate.indexOf("view")||this.inviewTracked||(c.intersectionListener||(c.intersectionListener=(0,s.T)({})),this.stopListen(),this.trigger=o.findDOMNode(this),this.trigger&&!this.unlisten&&(this.unlisten=c.intersectionListener.listen(this.trigger,(t=>{(t.isIntersecting||t.intersectionRatio>0)&&(this.stopListen(),this.handleInview())}))))}andleClick(t){var e=r.Children.only(this.props.children).props.onClick;e&&e(t),this.props.tapLogger(this.params)}ender(){if(this.props.disable)return this.props.children;var t=this.props.children;return-1!==this.props.activate.indexOf("tap")&&(t=r.cloneElement(t,{onClick:this.handleClick})),t}}c.displayName="Tracker"},85287:33811:(t,e,n)=>{"use strict";n.d(e,{uw:()=>_,x0:()=>k});var r=n(41185),o=n(66062),i=n(18274),a=n(55752),s=n.n(a),c=n(5663),d=n.n(c),l=n(74890),m=n.n(l),p=n(62720),g=n(64123),u=n(11622),h=n(18966),v=n(41779);r b=[p.Z.REBLOG,p.Z.HASH_TAG,p.Z.IMAGE,p.Z.VIDEO,p.Z.CLIPBLOG,p.Z.VOICE_BLOG,p.Z.PR,p.Z.AUTO_AD],I=C=(t,e,n)=>({type:h.V7,payload:{blogId:t,entryId:e,error:n},error:!0}),k=(0,i.H)((function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3?arguments[3]:void 0;return function(){var i=(0,o.Z)((function*(o,i,a){var{fetchr:c}=a,l=m()(b.concat(n)),p=s()(i(),["bloggerState","blogMap",t,"blog_name"],"");if(!p||!e)return null;var v=s()(i(),["entryState","entryMetaMap",e],null),y=s()(v,"pagingType",void 0),k=r===y,_=s()(i(),["entryState","entryMap",e],null);if(v&&k&&_&&(!d()(_.entry_text)||404===_.status_code))return null;try{o({type:h.Gh,payload:{blogId:t,entryId:e,fieldFilter:l,frm:r}});var P={amebaId:p,blogId:t,entryId:e,fieldFilter:l,frm:r},Z=yield c.read(g.Z.BlogEntry).params(P).end(),N=Z.data;if(!(!1!==i().deviceState.isEmojiSupported)&&N.entities&&N.entities.entryMap)try{N=f(f({},N),{},{entities:f(f({},N.entities),{},{entryMap:yield(0,u.R9)(N.entities.entryMap)})})}catch(O){console.warn(O),N=Z.data}return o(I(t,e,N,r))}catch(L){return o(C(t,e,L))}}));return ()})),_=(0,i.H)(((t,e)=>function(){var n=(0,o.Z)((function*(n,r){var o=s()(r(),["bloggerState","blogMap",t,"blog_name"],"");if(!o||!e)return null;var i=s()(r(),["entryState","entryMap",e],null);if("amember"!==i.publish_flg||i&&(i.entry_text||404===i.statusCode))return null;try{n({type:h.tB,payload:{entryId:e}});var a={token:s()(r(),["amebloTokenState","amebloToken"],null),amebaId:o,entryId:parseInt(e,10)},c=yield(0,v.s)(a);return n(((e,c))}catch(d){return n(((t,e)=>({type:h.Ny,payload:{entryId:t,error:e},error:!0}))(e,d))}}));return ()))},27524:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:);var r,o,i,a,s,c,d,l,m,p,g,u,h,v=n(3e4),y=n(66062),f=(n(91938),n(76955)),b=n(29466),I=n.n(b),C=n(55382),k=n.n(C),_=n(97175),P=n(66948),Z=n(45525),N=n(97455),O=n.n(N),L=n(29842),w=n(85287),M=n(73614),x=n(33811),S=n(9263),T=n(5563),B=n(10793),A=n(72591),j=n(30657),E=n(26334),H=n.n(E),D=n(48516),R=(0,Z.w1)(H())((i=o=class extends f.Component{shouldComponentUpdate(t){return this.props.amebaId!==t.amebaId||this.props.dispCommentNo!==t.dispCommentNo||this.props.isHidden!==t.isHidden||this.props.onClick!==t.onClick||!I()(this.props.comment,t.comment)}render(){var{amebaId:t,comment:e,dispCommentNo:n,onClick:r,isHidden:o}=this.props;if(!e)return null;var i=e.comment_title||"\u7121\u984c",a=e.comment_text||"",s=e.comment_url?(0,v.Z)(D.Z,{rel:"noopener noreferrer nofollow",target:"_blank",targetUrl:e.comment_url},void 0,e.comment_name):e.comment_name,c=(0,j.TA)(1,e.ins_datetime);"accept"!==e.comment_add_flg&&(i="",s="",c="");var d=(e.comment_url?A.parse(e.comment_url).path:"").startsWith("/".concat(t,"/"));return(0,v.Z)("li",{className:k()({[H().Comment_hidden]:o})},void 0,(0,v.Z)("div",{className:k()("blogComment",{ownerComment:d,skinStrongBgColor:d})},void 0,(0,v.Z)("a",{id:"c".concat(e.comment_id),name:"c".concat(e.comment_id)}),(0,v.Z)("div",{className:"commentHeader"},void 0,"\u7121\u984c"!==i?"".concat(n,". ").concat(i):"".concat(n,".")),(0,v.Z)("div",{className:"commentBody",dangerouslySetInnerHTML:{__html:a}}),(0,v.Z)("div",{className:"commentFooter"},void 0,(0,v.Z)("span",{className:"commentAuthor"},void 0,s),(0,v.Z)("span",{className:"commentTime skinWeakColor"},void 0,(0,v.Z)("time",{},void 0,c)),(0,v.Z)("a",{className:k()("commentReply commentWinOpenBtn",H().Link),"data-cid":e.comment_id,href:"",role:"button",onClick:r},void 0,"\u8fd4\u4fe1\u3059\u308b"))))}},o.displayName="PcEntryDetailCommentListItemNew",r=i))||r,W=n(51650);function U(t){var e=parseInt(t,10);return!e||e<1?1:e}function q(t){var e=U(t);return!e||e<1?0:50*(e-1)}function G(){return(G=(0,y.Z)((function*(t){var{dispatch:e,getState:n,match:r,location:o}=t,{params:i}=r,a=i.amebaId,s=yield e((0,M.Rs)(a));if(!s||!s.error){var c=n().bloggerState,d=c.bloggerMap,l=c.blogMap[(d[a]||{}).blog];if(l&&l.blog_id){var m=i.entryId,{frm:p}=o.query;yield e((0,x.x0)(l.blog_id,m,[],p))}}}))).apply(this,arguments)}function F(){return(F=(0,y.Z)((function*(t){var{dispatch:e,getState:n,match:r}=t,{params:o}=r,i=o.amebaId,a=n().bloggerState,s=a.bloggerMap,c=a.blogMap[(s[i]||{}).blog];if(c&&c.blog_id){var d=n().entryState.entryMap,l=o.entryId,m=d[l]||{};if(m.entry_id&&m.entry_text)if((0,L.M)(c,m).canComment){var p=q(o.page),g=U(o.page);yield e((0,S.u1)({blogId:c.blog_id,entryId:l,excludeReplies:!1,offset:p,limit:50,currentPage:g}))}}}))).apply(this,arguments)}var V=(0,W.lB)(["match","location"])(a=(0,P.$j)((function(t,e){var{match:n,location:r}=e,{params:o,route:i}=n,a=o.amebaId,s=o.entryId,c=i.pageType,d=r.hash||"",l=t.entryState,m=t.bloggerState,p=t.commentState,g=m.bloggerMap,u=m.blogMap,h=l.entryMap,v=g[a]||{},y=(v.attribute||{}).isOfficial,f=h[s]||{},b=u[v.blog]||{},I=b.blog_id||"",C=p.commentPageMap.currentPage||U(o.page),k=p.commentPageMap["".concat(f.entry_id,"/").concat(C)]||{},_=k.data||[],P=p.commentMap||{},Z=_.map((),N=k.paging||{},O=N.total_count||0,w=!(0,L.M)(b,f).canComment;return{amebaId:a,blog:b,blogId:I,commentCount:O,comments:Z,denyComment:w,entry:f,entryId:s,isOfficial:y,loading:!w&&void 0===k.loading,locationHash:d,pageType:c,paging:N}}),{fetchCommentsRequest:S.u1,trackTapLog:T.XI})(a=(0,_.provideHooks)({defer:function(t){return G.apply(this,arguments)},done:)(a=(0,Z.w1)(O())((c=s=class extends f.Component{ouldComponentUpdate(t,e){return this.state.isClickedMoreBtn!==e.isClickedMoreBtn||this.props.amebaId!==t.amebaId||this.props.blogId!==t.blogId||this.props.commentCount!==t.commentCount||this.props.denyComment!==t.denyComment||this.props.entryId!==t.entryId||this.props.fetchCommentsRequest!==t.fetchCommentsRequest||this.props.isOfficial!==t.isOfficial||this.props.loading!==t.loading||this.props.locationHash!==t.locationHash||this.props.pageType!==t.pageType||this.props.trackTapLog!==t.trackTapLog||!I()(this.props.comments,t.comments)||!I()(this.props.paging,t.paging)}componentDidUpdate(){setImmediate((()=>{this.moveToCommentArea()}))}moveToCommentArea(){"#cbox"===this.props.locationHash&&this.comentArea&&this.comentArea.scrollIntoView()}handleClickPaging(t){var e=this;return(0,y.Z)((function*(){t.preventDefault();var{blogId:n,entryId:r}=e.props,o=t.target.getAttribute("data-link-page");null==o&&(o=t.target.parentElement.getAttribute("data-link-page"));var i=!o||parseInt(o,10)<1?1:o,a=!i||i<1?0:50*(i-1);yield e.props.fetchCommentsRequest({blogId:n,entryId:r,excludeReplies:!1,offset:a,limit:50,currentPage:i});var s=document.getElementById("cbox");if(s){var c=document.getElementById("ambHeader"),d=c?c.clientHeight:w.S,l=window.pageXOffset||document.documentElement.scrollLeft;window.scroll(l,s.offsetTop-d)}}))()}handleClickPostComment(t){if(t.preventDefault(),"undefined"!=typeof window){var{amebaId:e,entryId:n}=this.props,r=t.target.getAttribute("data-cid"),o="".concat(window.process.env.HTTP_PATH_COMMENT_AMEBA,"/form?eid=").concat(n,"&bnm=").concat(e);r&&(o="".concat(o,"&cid=").concat(r));var i={width:536,height:675,scrollbars:"yes",resizable:"yes"};window.open(o,"childWindow",Object.keys(i).map(().join(","))}}renderCommentList(){var{amebaId:t,commentCount:e,comments:n,paging:r}=this.props;if(n.length<1)return null;var o=e-50*(r.current_page-1),i=n.map(((e,n)=>(0,v.Z)(R,{amebaId:t,comment:e,dispCommentNo:o-n,isHidden:1===r.current_page&&n>=10&&!this.state.isClickedMoreBtn,onClick:this.handleClickPostComment},"comment_".concat(e.comment_id))));return(0,v.Z)("ul",{className:"commentList skinBorderList",id:"commentListUl"},void 0,i)}renderMoreLink(){var{comments:t,paging:e}=this.props;return this.state.isClickedMoreBtn||e.current_page>1||t.length<=10?null:(0,v.Z)("div",{className:O().MoreLink,id:"commentListMoreLink",role:"presentation",onClick:,void 0,d||(d=(0,v.Z)("a",{},void 0,"\u3082\u3063\u3068\u898b\u308b")))}renderPaging(){var{paging:t}=this.props,e=t.current_page||1,n=t.max_page||1;return 1===n?null:(0,v.Z)("div",{className:"textPagingArea"},void 0,1===e?l||(l=(0,v.Z)("span",{className:"textPagingPrev skinWeakColor"},void 0,"\xab\xa0\u524d\u3078")):(0,v.Z)("a",{className:"textPagingPrev","data-link-page":e-1,role:"button",tabIndex:"0",onClick:this.handleClickPaging},void 0,"\xab\xa0\u524d\u3078"),m||(m=(0,v.Z)("span",{className:"skinWeakColor"},void 0,"|")),e===n?p||(p=(0,v.Z)("span",{className:"textPagingNext skinWeakColor"},void 0,"\u6b21\u3078\xa0\xbb")):(0,v.Z)("a",{className:"textPagingNext","data-link-page":e+1,role:"button",tabIndex:"0",onClick:this.handleClickPaging},void 0,"\u6b21\u3078\xa0\xbb"))}renderPostCommentButton(){return(0,v.Z)(f.Fragment,{},void 0,g||(g=(0,v.Z)("a",{id:"cform",name:"cform"})),(0,v.Z)("div",{className:"commentBtnArea"},void 0,(0,v.Z)(B.f,{pageId:this.props.pageType,sectionId:"comment_lower",serviceId:this.props.isOfficial?"official":"general",tapLogger:this.props.trackTapLog},void 0,(0,v.Z)("button",{className:k()("basicBtnS commentBtn commentWinOpenBtn",O().CommnetButton),type:"button",onClick:this.handleClickPostComment},void 0,u||(u=(0,v.Z)("span",{"data-uranus-icon":"comment"})),"\u30b3\u30e1\u30f3\u30c8\u3059\u308b"))))}render(){return this.props.denyComment?null:(0,v.Z)(f.Fragment,{},void 0,f.createElement("a",{id:"cbox",name:"cbox",ref:),(0,v.Z)("aside",{},void 0,(0,v.Z)("div",{className:"commentArea skinBlock"},void 0,(0,v.Z)("div",{className:"commentTitleArea skinBorderHr"},void 0,(0,v.Z)("div",{className:"commentOpenArea skinWeakColor"},void 0,"[\xa0",(0,v.Z)("a",{className:k()("commentWinOpenBtn",O().CommnetButton),role:"button",tabIndex:"0",onClick:this.handleClickPostComment},void 0,"\u30b3\u30e1\u30f3\u30c8\u8a18\u5165\u6b04\u3092\u8868\u793a"),"\xa0]"),h||(h=(0,v.Z)("h1",{className:"commentTitle"},void 0,"\u30b3\u30e1\u30f3\u30c8"))),this.renderCommentList(),this.renderMoreLink(),this.renderPaging(),this.renderPostCommentButton())))}},s.displayName="PcEntryDetailCommentListNew",a=c))||a)||a)||a)||a},74890:5185:(t,e,n)=>{var r=n(18300)((function(t){return t[1]}));r.push([t.id,"._32ggN5Pd{display:none}._1N2hr8S-{cursor:pointer}",""]),r.locals={Comment_hidden:"_32ggN5Pd",Link:"_1N2hr8S-"},t.exports=r},43658:(t,e,n)=>{var r=n(18300)(();r.push([t.id,"._1XxCN-M_{cursor:pointer;padding:0}._AZq6N-bE{cursor:pointer}",""]),r.locals={CommnetButton:"_1XxCN-M_",MoreLink:"_AZq6N-bE"},t.exports=r},26334:(t,e,n)=>{var r=n(5185),o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=Object.defineProperty||function(t,e,n){t[e]=n.value};"string"==typeof r&&(r=[[t.id,r,""]]),t.exports=function(t){var e=o({},t.locals||{});return i(e,"_",{value:function(){return t}}),i(e,"toString",{value:function(){return"function"==typeof t.toString?t.toString():""}}),e}(r)},97455:(t,e,n)=>{var r=n(43658),o=Object.assign||i=Object.defineProperty||"string"==typeof r&&(r=[[t.id,r,""]]),t.exports=function(t){var e=o({},t.locals||{});return i(e,"_",{value:),i(e,"toString",{value:function(){return"function"==typeof t.toString?t.toString():""}}),e}(r)}}]);