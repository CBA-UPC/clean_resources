(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[725],{"+4M4":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("NrNW"),a=n("B5kz"),u=n("CaQ9"),o=n("yNE0");function s(){var e=Object(r.a)().data,t=Object(u.a)().data;return Object(a.c)(["FeatureSettings"],(,{staleTime:1/0,cacheTime:1/0,enabled:e&&t})}},HMhV:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("NrNW"),a=n("/Oio"),u=n("iiZS"),o=n("mXGw"),s=n("B5kz"),i=n("Pd+Y"),d=n("66iV");function l(e){var t=function(e){var t=Object(r.a)().data,n=Object(d.a)(),u=["UserStorage",e];return Object(s.c)(u,(function(){return function(e,t){return Object(i.a)(e,t).then((function(e){return e?{result:e,fromPersistence:!1}:{result:void 0,fromPersistence:!1}}))}(e,n)}),{cacheTime:1/0,staleTime:1/0,enabled:!!t&&!!n&&(null==t?void 0:t.workload)!==a.a.Hwa})}(e),n=t.data,l=t.isLoading,c=Object(u.a)(e),f=c.data,v=c.isLoading,C=Object(r.a)().data;return Object(o.useMemo)((function(){return l||v||!C?null:C.workload===a.a.Hwa?f||void 0:n?n.result:void 0}),[C,f,n,v,l])}},"X/Yx":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("QjXU"),a=n("NrNW"),u=n("/Oio"),o=n("Pspf"),s=n("mXGw"),i=n("LLg0");function d(e,t){return Object(r.__assign)(Object(r.__assign)({},e),t)}function l(e){var t=Object(a.a)().data,n=Object(i.a)(e,d),r=Object(o.a)(e,d);return Object(s.useMemo)((function(){return(null==t?void 0:t.workload)===u.a.Hwa?r:n}),[null==t?void 0:t.workload,r,n])}},aAUn:function(e,t,n){"use strict";n.r(t),n.d(t,"NewBadge",();var r,a=n("QjXU"),u=n("BZvo"),o=n("+4M4"),s=n("mXGw");!r||(r={}));var i=function(e,t){return!!t.find(()},d=function(e,t,n,a,u){return function(e){return(new Date).getTime()-new Date(e).getTime()<=7776e6}(t.addedDate)&&(function(e,t,n){return t.type===r.App&&i(e,n)}(e,t,n)||function(e,t,n,a,u){var o=u&&-1!==(null==u?void 0:u.indexOf(e));return t.type===r.FeaturedCard&&a&&!o&&i(l(e),n)}(e,t,n,a,u))},l=c=function(e){if(e){var t=e.replace(" ","").split(",");if(2===t.length&&-1!==["0","1"].indexOf(t[0])){var n=Date.parse(t[1]);if(!isNaN(n))return{type:"0"===t[0]?r.App:r.FeaturedCard,addedDate:t[1]}}}},f=function(e){if(e){var t={};for(var n in e){var r=c(e[n]);r&&(t[v(n,r)]=r)}return t}},v=function(e,t){return t.type===r.FeaturedCard?e:e.charAt(0).toUpperCase()+e.slice(1)},C=function(e,t,n){if(n&&(e===r.App||e===r.FeaturedCard)){var a=f(t);if(a&&0!==Object.keys(a).length){var u=[];for(var o in n){var s=n[o];if(!s||s<3){var i=a[o];i&&i.type===e&&u.push(o)}}return u}}},p=function(e,t){if(t){var n=C(r.FeaturedCard,e,t);return w(n,e)}},w=function(e,t){var n,r,u,o=f(t);if(e&&o&&0!==Object.keys(o).length){var s=e.sort((function(e,t){var n,r,a,u,s=(null===(n=o[e])||void 0===n?void 0:n.addedDate)?new Date(null===(r=o[e])||void 0===r?void 0:r.addedDate).getTime():0;return((null===(a=o[t])||void 0===a?void 0:a.addedDate)?new Date(null===(u=o[t])||void 0===u?void 0:u.addedDate).getTime():0)-s})),i={},d=[];try{for(var l=Object(a.__values)(s),c=l.next();!c.done;c=l.next()){var v=c.value,C=null===(u=v.split("_"))||void 0===u?void 0:u[0];i[C]||(i[C]=v,d.push(v))}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}return d}},b=n("NrNW"),O=n("CU8J"),j=n("CaQ9"),_=n("HMhV"),m=n("X/Yx"),N=n("K7tG"),g=n("elnK"),h=n.n(g),k=n("fk7v"),y=h()((function(e){return{isComputed:!1,setIsComputed:function(t){e({isComputed:t})},initialConsumerNewContents:void 0,setInitialConsumerNewContents:})),F=function(e,t){if(e&&function(e){var t=l(e);return!!t&&t.length>0&&t.length<100}(e)&&null!==t){var n=t?Object(a.__assign)({},t):{};return n[e]=4,n}},I=function(e,t){var n,r;if((null==e?void 0:e.length)&&null!==t){var u=t?Object(a.__assign)({},t):{};try{for(var o=Object(a.__values)(e),s=o.next();!s.done;s=o.next()){var i=s.value,d=null==t?void 0:t[i],l=null!=d?d:0;l>=0&&l<3&&(l+=1),u[i]=l}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return u}},A=function(e){var t=e.firstPartyAppItems,n=e.setFirstPartyAppItems,i=e.showNewBadge,l=e.setShowNewBadge,c=e.showFeaturedCardNewBadge,v=e.setShowFeaturedCardNewBadge,w=e.newAppIsClicked,g=e.setNewAppIsClicked,h=e.newFeaturedCardIsClicked,A=e.setNewFeaturedCardIsClicked,M=e.featuredExpandClicked,x=e.setFeaturedExpandClicked,B=e.setNewFeaturedCardProps,D=Object(a.__read)(function(){var e=Object(a.__read)(function(){var e=Object(_.a)(k.a),t=Object(a.__read)(Object(m.a)(k.a),1)[0],n=Object(o.a)().data,r=Object(O.a)().data,u=Object(j.a)().data,i=Object(b.a)().data,l=Object(N.a)(),c=y(),v=c.isComputed,C=c.setIsComputed,p=c.initialConsumerNewContents,w=c.setInitialConsumerNewContents;return Object(s.useEffect)((function(){var o,s,c,p,b;if(n&&r&&n.result&&r.result&&l&&i&&u&&null!==e&&(null===(s=null===(o=null==r?void 0:r.result)||void 0===o?void 0:o.appsModuleGates)||void 0===s?void 0:s.appsModuleNewBadgeEnabled)&&!v){var O=f(n.result.amConsumerNewContents);if(O&&0!==Object.keys(O).length){var j=!0,_=null===(c=n.result.appsModule)||void 0===c?void 0:c.featuredBlockedCards,m=u.isMsa&&(null===(b=null===(p=r.result)||void 0===p?void 0:p.appsModuleGates)||void 0===b?void 0:b.appsModuleFeaturedEnabled)&&"en-us"===(i.preferredCulture||"en-US").toLowerCase();return function(n){var r,u,o=(null==e?void 0:e.consumerNewContents)?Object(a.__assign)({},e.consumerNewContents):{},s={},i=!1;for(var c in O)d(c,O[c],l,!!m,null==_?void 0:_.split(","))&&(c in o?s[c]=null!==(r=o[c])&&void 0!==r?r:0:(s[c]=0,i=!0));Object.keys(o).length!==Object.keys(s).length&&(i=!0),w(s),i&&n&&t({featuredCollapsed:null!==(u=null==e?void 0:e.featuredCollapsed)&&void 0!==u&&u,consumerNewContents:s}),C(!0)}(j),}}),[i,r,n,u,v,l,e,t,w,C]),Object(s.useMemo)((,[e,t,p])}(),3),t=e[0],n=e[1],r=e[2],u=Object(o.a)().data;return Object(s.useMemo)((function(){return null!==t&&r&&u&&u.result?[p(u.result.amConsumerNewContents,r),t,n]:[null,null,n]}),[u,t,r,n])}(),3),E=D[0],S=D[1],T=D[2],U=Object(o.a)().data,L=Object(s.useCallback)((function(e){var t,n;if(S&&U&&U.result){var r=[],u=p(U.result.amConsumerNewContents,S.consumerNewContents);if(E&&u&&!e){try{for(var o=Object(a.__values)(E),s=o.next();!s.done;s=o.next()){var i=s.value;-1!==u.indexOf(i)&&r.push(i)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}v(!0)}return{seenNewFeaturedCards:r,newFeaturedCardIds:u}}}),[U,E,S,v]),P=Object(s.useCallback)((function(){var e;if(t&&S&&U&&U.result){var o=function(e,t){if(t)return C(r.App,e,t)}(U.result.amConsumerNewContents,S.consumerNewContents),s=[];if(t&&o){var d=t.map((function(e){return o.includes(e.AppId)?(s.push(e.AppId),Object(a.__assign)(Object(a.__assign)({},e),{IsNew:!0})):Object(a.__assign)(Object(a.__assign)({},e),{IsNew:!1})}));n(d)}var c=L(S.featuredCollapsed);if((null===(e=null==c?void 0:c.seenNewFeaturedCards)||void 0===e?void 0:e.length)&&s.push.apply(s,Object(a.__spreadArray)([],Object(a.__read)(c.seenNewFeaturedCards),!1)),E&&(null==c?void 0:c.newFeaturedCardIds)&&B({newFeaturedCardIds:c.newFeaturedCardIds,initialNewFeaturedCards:E,setNewFeaturedCardIsClicked:A,setFeaturedExpandClicked:x}),!i){Object(u.d)("AppsModule_Consumer_NewContents",void 0,s.join(";"));var f=I(s,S.consumerNewContents);f&&T(Object(a.__assign)(Object(a.__assign)({},S),{consumerNewContents:f})),l(!0)}}}),[U,t,E,i,S,x,A,L,B,n,l,T]),X=Object(s.useCallback)((function(){var e;if("true"===window.sessionStorage.getItem("AM_New_Badge_Reset"))return window.sessionStorage.setItem("AM_New_Badge_Reset","false"),T({featuredCollapsed:null!==(e=null==S?void 0:S.featuredCollapsed)&&void 0!==e&&e,consumerNewContents:{}})}),[S,T]);return Object(s.useEffect)((function(){var e;if(M){x(!1);var t=Object(a.__assign)(Object(a.__assign)({},S),{featuredCollapsed:!1});if(!c){var n=null===(e=L(!1))||void 0===e?void 0:e.seenNewFeaturedCards;if((null==n?void 0:n.length)&&S){Object(u.d)("AppsModule_Consumer_NewContents",void 0,n.join(";"));var r=I(n,S.consumerNewContents);t&&(t.consumerNewContents=r)}}T(t)}}),[w,M,c,S,L,n,g,x,T]),Object(s.useEffect)((function(){if(w&&(null==S?void 0:S.consumerNewContents)){var e=F(w,S.consumerNewContents);e&&T(Object(a.__assign)(Object(a.__assign)({},S),{consumerNewContents:e})),g("")}}),[w,S,g,T]),Object(s.useEffect)((function(){if(h&&(null==S?void 0:S.consumerNewContents)){var e=F(h,S.consumerNewContents);e&&T(Object(a.__assign)(Object(a.__assign)({},S),{consumerNewContents:e})),A("")}}),[h,S,A,T]),Object(s.useEffect)((,[i,P,X]),null};t.default=A},fk7v:]);
//# sourceMappingURL=725.517e66c0d9de877eeef9.chunk.v7.js.map