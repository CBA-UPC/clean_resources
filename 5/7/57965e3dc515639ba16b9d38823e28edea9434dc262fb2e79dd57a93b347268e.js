"use strict";var _createClass=);r JssoCrosswalk=function(){function s(t,n,r,d,p){_classCallCheck(this,s),this.channel=t,this.platform=n,window.showSsoFedCmIframe=window.showSsoFedCmIframe||r,this.ssoBaseUrl=d&&this.isValidDomain(d)?d+"/sso/crossapp/identity/web/":"https://jsso.indiatimes.com/sso/crossapp/identity/web/",this.socialappBaseUrl=p&&this.isValidDomain(p)?p+"/socialsite/crossapp/web/":"https://socialappsintegrator.indiatimes.com/socialsite/crossapp/web/",this.sdkVersion="0.7.78",this.csrfToken=this.getCookie("csrfToken"),this.ssec=this.getCookie("jsso_crosswalk_ssec_"+this.channel),this.tksec=this.getCookie("jsso_crosswalk_tksec_"+this.channel),this.csut=this.getCookie("csut"),this.gdpr=this.getCookie("gdpr"),this.userDetails=this.getSessionStorage("jsso_crosswalk_user_details"),this.profileDetails=this.getSessionStorage("jsso_crosswalk_profile_details"),this.captchaToken=this.getCookie("captchaToken"),this.UNAUTHORIZED_ACCESS_RESPONSE={code:404,message:"UNAUTHORIZED_ACCESS",status:"FAILURE",data:null},this.CONNECTION_ERROR_RESPONSE={code:503,message:"CONNECTION_ERROR",status:"FAILURE",data:null},this.CONNECTION_TIMEOUT_RESPONSE={code:504,message:"CONNECTION_TIMEOUT",status:"FAILURE",data:null},this.APP_CONNECTION_TIMEOUT_RESPONSE={code:505,message:"TRUECALLER_LOGIN_FAILURE",status:"FAILURE",data:null},this.INVALID_MOBILE={code:402,message:"INVALID_MOBILE",status:"FAILURE",data:null},this.INVALID_EMAIL={code:403,message:"INVALID_EMAIL",status:"FAILURE",data:null},this.INVALID_REQUEST={code:413,message:"INVALID_REQUEST",status:"FAILURE",data:null},this.INVALID_PASSWORD={code:417,message:"INVALID_PASSWORD",status:"FAILURE",data:null},this.INVALID_DOMAIN={code:418,message:"INVALID_DOMAIN",status:"FAILURE",data:null},this.waitForloginWithTicket=!1,this.fpslogincheck=!0;var u=new URLSearchParams(window.location.search),m=u.get("ticketId"),k=this.getChannelCookies();m?this.getV1ValidLoggedInUser(m,!1):""!=k.login&&""==k.daily&&this.getValidLoggedInUser();var g=window.location.href,C=this;if(window.redirectLoginType&&"SSOTLOGINAPPLE"==window.redirectLoginType&&this.appleLogin(window.appleTicket,function(y){200==y.code&&(C.fedcmInIfram(y),window.opener.postMessage({sender:"applelogin",message:y},"*"),window.close())}),getParameterByName("code",g)){var I=getParameterByName("state",g).split(",");"SSOTLOGINGOOGLEPLUS"==I[0]&&this.googleplusLogin(getParameterByName("code",g),I[1],function(y){200==y.code&&(C.fedcmInIfram(y),window.opener&&window.opener.JssoLoginCompleteCallback?window.opener.JssoLoginCompleteCallback(y):window.parent&&window.parent.JssoLoginCompleteCallback&&window.parent.JssoLoginCompleteCallback(y),window.close())}),"SSOTLOGINFACEBOOK"==I[0]&&this.facebookLogin(getParameterByName("code",g),I[1],function(y){(200==y.code||4413==y.code&&y.stateid)&&(C.fedcmInIfram(y),window.opener&&window.opener.JssoLoginCompleteCallback?window.opener.JssoLoginCompleteCallback(y):window.parent&&window.parent.JssoLoginCompleteCallback&&window.parent.JssoLoginCompleteCallback(y),window.close())}),"SSOTLOGINMICROSOFT"==I[0]&&this.microsoftLogin(getParameterByName("code",g),I[1],function(y){(200==y.code||4413==y.code&&y.stateid)&&(C.fedcmInIfram(y),window.opener&&window.opener.JssoLoginCompleteCallback?window.opener.JssoLoginCompleteCallback(y):window.parent&&window.parent.JssoLoginCompleteCallback&&window.parent.JssoLoginCompleteCallback(y),window.close())}),"SSOTLOGINLINKEDIN"==getParameterByName("state",g)[0]&&this.linkedinLogin(getParameterByName("code",g),window.location.href.split("?")[0],function(y){200==y.code&&(C.fedcmInIfram(y),window.opener&&window.opener.JssoLoginCompleteCallback?window.opener.JssoLoginCompleteCallback(y):window.parent&&window.parent.JssoLoginCompleteCallback&&window.parent.JssoLoginCompleteCallback(y),window.close())})}}return _createClass(s,[{key:"fedcmInIfram",value:function fedcmInIfram(t){if(window.showSsoFedCmIframe){var n=this.ssoBaseUrl.split("/sso")[0]+"/sso/identity/login/setLoginStatus";if(t)this.getValidLoggedInUser(function(d){n=n+"?ticketId="+d.data.encTicket+"&openforfedcm="+!0;window.open(n,"ssoLoginWindownew","menubar=no,locationbar=n0,toolbar=no,status=no,menubar=no,scrollbars=no,resizable=no,left=10000,top=10000,width=10,height=10,visible=none")});else{var r=window.open(n,"ssoLoginWindownew","menubar=no,locationbar=n0,toolbar=no,status=no,menubar=no,scrollbars=no,resizable=no,left=10000,top=10000,width=10,height=10,visible=none");setTimeout(0)}}}},{key:"asyncJssoCall",value:function asyncJssoCall(t,n,r){this.asyncCall(this.ssoBaseUrl+t,n,r,t)}},{key:"asyncJssoCallWithHeaders",value:function asyncJssoCallWithHeaders(t,n,r,d){this.asyncCallWithHeaders(this.ssoBaseUrl+t,n,r,d)}},{key:"asyncSocialappCall",value:function asyncSocialappCall(t,n,r){this.asyncCall(this.socialappBaseUrl+t,n,r,t)}},{key:"asyncCall",value:function asyncCall(t,n,r,d){var p=new XMLHttpRequest;p.open("POST",t),p.timeout=3e4,p.withCredentials=!0,p.setRequestHeader("content-type","application/json"),p.setRequestHeader("channel",this.channel),p.setRequestHeader("platform",this.platform),p.setRequestHeader("sdkVersion",this.sdkVersion),p.setRequestHeader("IsJssoCrosswalk","true"),p.setRequestHeader("csrfToken",this.getCookie("csrfToken")||this.csrfToken),p.setRequestHeader("captchaToken",this.getCookie("captchaToken")||this.captchaToken),p.setRequestHeader("ssec",this.getCookie("jsso_crosswalk_ssec_"+this.channel)),p.setRequestHeader("tksec",this.getCookie("jsso_crosswalk_tksec_"+this.channel)),p.setRequestHeader("csut",this.getCookie("csut")),p.setRequestHeader("gdpr",this.getCookie("gdpr")),p.responseType="json",p.onload=function(){var k=p.response;return("string"==typeof k&&(k=JSON.parse(k)),!k||!k.code)?(this.deleteChannelCookies(),void(r&&r(this.UNAUTHORIZED_ACCESS_RESPONSE))):404==k.code?(this.deleteChannelCookies(),void(r&&r(k))):(p.getResponseHeader("ssec")&&(this.ssec=p.getResponseHeader("ssec")),p.getResponseHeader("tksec")&&(this.tksec=p.getResponseHeader("tksec")),p.getResponseHeader("csut")&&(this.csut=p.getResponseHeader("csut")),p.getResponseHeader("gdpr")&&(this.gdpr=p.getResponseHeader("gdpr")),p.getResponseHeader("csrfToken")&&(this.csrfToken=p.getResponseHeader("csrfToken"),this.createCookie("csrfToken",p.getResponseHeader("csrfToken"),2592000000)),p.getResponseHeader("captchaToken")&&(this.captchaToken=p.getResponseHeader("captchaToken"),this.createCookie("captchaToken",p.getResponseHeader("captchaToken"),2592000000)),"getUserDetails"===d?(this.userDetails=JSON.stringify(k),this.userDetails&&this.setSessionStorage("jsso_crosswalk_user_details",this.userDetails,15)):"getUserProfile"==d&&(this.profileDetails=JSON.stringify(k),this.profileDetails&&this.setSessionStorage("jsso_crosswalk_profile_details",this.profileDetails,15)),r)?r(k):void 0}.bind(this),p.onerror=function(){if(r)return r(this.CONNECTION_ERROR_RESPONSE)}.bind(this),p.ontimeout=function(){if(r)return r(this.CONNECTION_TIMEOUT_RESPONSE)}.bind(this),p.send(JSON.stringify(n))}},{key:"asyncCallWithHeaders",value:function asyncCallWithHeaders(t,n,r,d){var p=new XMLHttpRequest;if(p.open("POST",t),p.timeout=3e4,p.withCredentials=!0,p.setRequestHeader("content-type","application/json"),p.setRequestHeader("channel",this.channel),p.setRequestHeader("platform",this.platform),p.setRequestHeader("sdkVersion",this.sdkVersion),p.setRequestHeader("IsJssoCrosswalk","true"),p.setRequestHeader("csrfToken",this.getCookie("csrfToken")||this.csrfToken),p.setRequestHeader("captchaToken",this.getCookie("captchaToken")||this.captchaToken),p.setRequestHeader("csut",this.getCookie("csut")),p.setRequestHeader("gdpr",this.getCookie("this.gdpr")),p.responseType="json",r)for(var k in r)p.setRequestHeader(k,r[k]);else p.setRequestHeader("ssec",this.getCookie("jsso_crosswalk_ssec_"+this.channel)),p.setRequestHeader("tksec",this.getCookie("jsso_crosswalk_tksec_"+this.channel));p.onload=function(){var g=p.response;return("string"==typeof g&&(g=JSON.parse(g)),!g||!g.code)?(this.deleteChannelCookies(),void(d&&d(this.UNAUTHORIZED_ACCESS_RESPONSE))):404==g.code?(this.deleteChannelCookies(),void(d&&d(g))):(p.getResponseHeader("csrfToken")&&(this.csrfToken=p.getResponseHeader("csrfToken"),this.createCookie("csrfToken",p.getResponseHeader("csrfToken"),2592000000)),p.getResponseHeader("captchaToken")&&(this.captchaToken=p.getResponseHeader("captchaToken"),this.createCookie("captchaToken",p.getResponseHeader("captchaToken"),2592000000)),p.getResponseHeader("ssec")&&(this.ssec=p.getResponseHeader("ssec")),p.getResponseHeader("tksec")&&(this.tksec=p.getResponseHeader("tksec")),p.getResponseHeader("csut")&&(this.csut=p.getResponseHeader("csut")),p.getResponseHeader("gdpr")&&(this.gdpr=p.getResponseHeader("gdpr")),d)?d(g):void 0}.bind(this),p.onerror=function(){if(d)return d(this.CONNECTION_ERROR_RESPONSE)}.bind(this),p.ontimeout=function(){if(d)return d(this.CONNECTION_TIMEOUT_RESPONSE)}.bind(this),p.send(JSON.stringify(n))}},{key:"fedcmLogin",value:function fedcmLogin(t){var r=this;if(""==this.getCookie("jsso_crosswalk_tksec_"+this.channel)&&"IdentityCredential"in window){var n=Math.random().toString().substring(7);navigator.credentials.get({identity:{providers:[{configURL:this.ssoBaseUrl.split("/sso")[0]+"/fedcm.json",clientId:"TIMES",nonce:n}]}}).then(function(d){var p=d.token;null!=p&&r.getV1ValidLoggedInUser(p,!1,t)}).catch(}}},{key:"FPSLOGIN",value:function FPSLOGIN(t){var n=this,r=this.ssoBaseUrl.split("/sso")[0]+"/";navigator.permissions.query({name:"top-level-storage-access",requestedOrigin:r}).then(function(d){if("granted"===d.state)"requestStorageAccessFor"in document&&document.requestStorageAccessFor(r).then(function(){n.getValidLoggedInUser(t)},;else if("prompt"===d.state){var p=!0;window.onclick=function(){"requestStorageAccessFor"in document&&p&&(p=!1,document.requestStorageAccessFor(r).then()}}})}},{key:"getValidLoggedInUser",value:function getValidLoggedInUser(t){var r=this;if(this.waitForloginWithTicket)var n=setInterval(function(){r.waitForloginWithTicket||(clearInterval(n),r.getValidLoggedInUser(t))},50);else this.asyncJssoCall("loggedInUser",{},function(d){if(200==d.code?this.createChannelCookies():this.fpslogincheck&&(this.fpslogincheck=!1,this.FPSLOGIN(t)),t)return t(d)}.bind(this))}},{key:"getV1ValidLoggedInUser",value:function getV1ValidLoggedInUser(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0,r=arguments[2];this.waitForloginWithTicket=!0,this.asyncJssoCallWithHeaders("v1LoggedInUser",{},{ticketId:t},function(d){if(this.waitForloginWithTicket=!1,200==d.code&&(navigator.login.setStatus("logged-in"),this.createChannelCookies(),getParameterByName("openforfedcm")&&window.close(),n&&location.reload()),r)return r(d)}.bind(this))}},{key:"getValidAppLoggedInUser",value:function getValidAppLoggedInUser(t,n,r,d,p){this.asyncJssoCallWithHeaders("appLoggedInUser",{},{ssoid:t,ssec:n,ticketId:r,tksec:d},function(k){if(200==k.code&&this.createChannelCookies(),p)return p(k)}.bind(this))}},{key:"checkUserExists",value:function checkUserExists(t,n){this.asyncJssoCall("checkUserExists",{identifier:t},n)}},{key:"registerUser",value:function registerUser(t,n,r,d,p,k,g,C,I,u,m,y,L){return p||k?p&&!this.isValidEmail(p)?y(this.INVALID_EMAIL):k&&!this.isValidMobile(k)?y(this.INVALID_MOBILE):this.isValidPassword(g)?void(L?this.asyncJssoCall("registerUser",{firstName:t,lastName:n,gender:r,dob:d,email:p,mobile:k,password:g,isSendOffer:C,termsAccepted:I,shareDataAllowed:u,timespointsPolicy:m,userRecaptchaResponseToken:L},function(f){if(200==f.code&&this.createChannelCookies(),y)return y(f)}.bind(this)):this.asyncJssoCall("registerUser",{firstName:t,lastName:n,gender:r,dob:d,email:p,mobile:k,password:g,isSendOffer:C,termsAccepted:I,shareDataAllowed:u,timespointsPolicy:m},y)):y(this.INVALID_PASSWORD):y(this.INVALID_REQUEST)}},{key:"registerUserRecaptcha",value:function registerUserRecaptcha(t,n,r,d,p,k,g,C,I,u,m,y,L){return p||k?p&&!this.isValidEmail(p)?L(this.INVALID_EMAIL):k&&!this.isValidMobile(k)?L(this.INVALID_MOBILE):this.isValidPassword(g)?void this.asyncJssoCall("registerUserRecaptcha",{firstName:t,lastName:n,gender:r,dob:d,email:p,mobile:k,password:g,isSendOffer:C,recaptcha:I,termsAccepted:u,shareDataAllowed:m,timespointsPolicy:y},function(f){if(200==f.code&&this.createChannelCookies(),L)return L(f)}.bind(this)):L(this.INVALID_PASSWORD):L(this.INVALID_REQUEST)}},{key:"resendMobileSignUpOtp",value:function resendMobileSignUpOtp(t,n,r,d){return this.isValidMobile(t)?void(d?this.asyncJssoCall("resendSignUpOtp",{mobile:t,ssoid:n,userRecaptchaResponseToken:d},r):this.asyncJssoCall("resendSignUpOtp",{mobile:t,ssoid:n},r)):r(this.INVALID_MOBILE)}},{key:"resendEmailSignUpOtp",value:function resendEmailSignUpOtp(t,n,r,d){return this.isValidEmail(t)?void(d?this.asyncJssoCall("resendSignUpOtp",{email:t,ssoid:n,userRecaptchaResponseToken:d},function(p){if(200==p.code&&this.createChannelCookies(),r)return r(p)}.bind(this)):this.asyncJssoCall("resendSignUpOtp",{email:t,ssoid:n},r)):r(this.INVALID_EMAIL)}},{key:"verifyMobileSignUp",value:function verifyMobileSignUp(t,n,r,d){return this.isValidMobile(t)?void this.asyncJssoCall("verifySignUpOTP",{mobile:t,ssoid:n,otp:r},function(p){if(200==p.code&&(this.createChannelCookies(),this.fedcmInIfram(p)),d)return d(p)}.bind(this)):d(this.INVALID_MOBILE)}},{key:"verifyEmailSignUp",value:function verifyEmailSignUp(t,n,r,d){return this.isValidEmail(t)?void this.asyncJssoCall("verifySignUpOTP",{email:t,ssoid:n,otp:r},function(p){if(200==p.code&&(this.createChannelCookies(),this.fedcmInIfram(p)),d)return d(p)}.bind(this)):d(this.INVALID_EMAIL)}},{key:"verifyMobileLogin",value:function verifyMobileLogin(t,n,r){return this.isValidMobile(t)?void this.asyncJssoCall("verifyLoginOtpPassword",{mobile:t,password:n},function(d){if(200==d.code&&(this.createChannelCookies(),this.fedcmInIfram(d)),r)return r(d)}.bind(this)):r(this.INVALID_MOBILE)}},{key:"verifyEmailLogin",value:function verifyEmailLogin(t,n,r){return this.isValidEmail(t)?void this.asyncJssoCall("verifyLoginOtpPassword",{email:t,password:n},function(d){if(200==d.code&&(this.createChannelCookies(),this.fedcmInIfram(d)),r)return r(d)}.bind(this)):r(this.INVALID_EMAIL)}},{key:"v1VerifyMobileLogin",value:function v1VerifyMobileLogin(t,n,r){return this.isValidMobile(t)?void this.asyncJssoCall("v1VerifyLoginOtp",{mobile:t,password:n},function(d){if(200==d.code&&(this.createChannelCookies(),this.fedcmInIfram(d)),r)return r(d)}.bind(this)):r(this.INVALID_MOBILE)}},{key:"v1VerifyEmailLogin",value:function v1VerifyEmailLogin(t,n,r){return this.isValidEmail(t)?void this.asyncJssoCall("v1VerifyLoginOtp",{email:t,password:n},function(d){if(200==d.code&&(this.createChannelCookies(),this.fedcmInIfram(d)),r)return r(d)}.bind(this)):r(this.INVALID_EMAIL)}},{key:"verifyMobileLoginForOptIn",value:function verifyMobileLoginForOptIn(t,n,r){return this.isValidMobile(t)?void this.asyncJssoCall("verifyLoginOtpPassword",{mobile:t,password:n,optInRequest:!0},function(d){if(200==d.code&&(this.createChannelCookies(),this.fedcmInIfram(d)),r)return r(d)}.bind(this)):r(this.INVALID_MOBILE)}},{key:"verifyEmailLoginForOptIn",value:function verifyEmailLoginForOptIn(t,n,r){return this.isValidEmail(t)?void this.asyncJssoCall("verifyLoginOtpPassword",{email:t,password:n,optInRequest:!0},function(d){if(200==d.code&&(this.createChannelCookies(),this.fedcmInIfram(d)),r)return r(d)}.bind(this)):r(this.INVALID_EMAIL)}},{key:"optIn",value:function optIn(t){this.asyncJssoCall("optIn",{},bind(this))}},{key:"facebookLogin",value:function facebookLogin(t,n,r){this.asyncSocialappCall("facebookLogin",{code:t,facebookRedirectUri:n},function(d){if(200==d.code&&this.createChannelCookies(),r)return r(d)}.bind(this))}},{key:"appleLogin",value:function appleLogin(t,n){this.asyncSocialappCall("appleLogin",{code:t},function(r){if(200==r.code&&this.createChannelCookies(),n)return n(r)}.bind(this))}},{key:"googleplusLogin",value:function googleplusLogin(t,n,r){this.asyncSocialappCall("googleplusLogin",{code:t,googleplusRedirectUri:n},function(d){if(200==d.code&&(this.createChannelCookies(),this.fedcmInIfram(d)),r)return r(d)}.bind(this))}},{key:"linkedinLogin",value:function linkedinLogin(t,n,r){this.asyncSocialappCall("linkedinLogin",{code:t,linkedinRedirectUri:n},function(d){if(200==d.code&&(this.createChannelCookies(),this.fedcmInIfram(d)),r)return r(d)}.bind(this))}},{key:"microsoftLogin",value:function microsoftLogin(t,n,r){this.asyncSocialappCall("microsoftLogin",{code:t,microsoftRedirectUri:n},function(d){if(200==d.code&&(this.createChannelCookies(),this.fedcmInIfram(d)),r)return r(d)}.bind(this))}},{key:"getUserProfile",value:function getUserProfile(t){var n=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!this.profileDetails||n)this.asyncJssoCall("getUserProfile",{},t);else if(t)return t(JSON.parse(this.profileDetails))}},{key:"getUserDetails",value:function getUserDetails(t){var n=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!this.userDetails||n)this.asyncJssoCall("getUserDetails",{},t);else if(t)return t(JSON.parse(this.userDetails))}},{key:"sendUpdateOtp",value:function sendUpdateOtp(t,n){n?this.asyncJssoCall("sendUpdateOtp",{},function(r){if(200==r.code&&this.createChannelCookies(),t)return t(r)}.bind(this)):this.asyncJssoCall("sendUpdateOtp",{},t)}},{key:"getMobileLoginOtp",value:function getMobileLoginOtp(t,n,r){return this.isValidMobile(t)?void(void 0==r?this.asyncJssoCall("getLoginOtp",{mobile:t},function(d){if(200==d.code&&this.createChannelCookies(),n)return n(d)}.bind(this)):this.asyncJssoCall("getLoginOtp",{mobile:t,userRecaptchaResponseToken:r},n)):n(this.INVALID_MOBILE)}},{key:"getMobileLoginOtpForOptIn",value:function getMobileLoginOtpForOptIn(t,n,r){return this.isValidMobile(t)?void(void 0==r?this.asyncJssoCall("getLoginOtp",{mobile:t},function(d){if(200==d.code&&this.createChannelCookies(),n)return n(d)}.bind(this)):this.asyncJssoCall("getLoginOtp",{mobile:t,optInRequest:!0,userRecaptchaResponseToken:r},n)):n(this.INVALID_MOBILE)}},{key:"getEmailLoginOtp",value:function getEmailLoginOtp(t,n,r){return this.isValidEmail(t)?void(void 0==r?this.asyncJssoCall("getLoginOtp",{email:t},n):this.asyncJssoCall("getLoginOtp",{email:t,userRecaptchaResponseToken:r},n)):n(this.INVALID_EMAIL)}},{key:"getEmailLoginOtpForOptIn",value:function getEmailLoginOtpForOptIn(t,n,r){return this.isValidEmail(t)?void(void 0==r?this.asyncJssoCall("getLoginOtp",{email:t},n):this.asyncJssoCall("getLoginOtp",{email:t,optInRequest:!0,userRecaptchaResponseToken:r},n)):n(this.INVALID_EMAIL)}},{key:"updateUserProfile",value:function updateUserProfile(t,n,r,d,p,k,g,C){this.asyncJssoCall("updateUserProfile",{firstName:t,lastName:n,gender:r,dob:d,city:p,termsAccepted:k,shareDataAllowed:g},function(I){if(200==I.code&&this.createChannelCookies(),C)return C(I)}.bind(this))}},{key:"getMobileForgotPasswordOtp",value:function getMobileForgotPasswordOtp(t,n,r){return this.isValidMobile(t)?void(r?this.asyncJssoCall("getForgotPasswordOtp",{mobile:t,userRecaptchaResponseToken:r},n):this.asyncJssoCall("getForgotPasswordOtp",{mobile:t},function(d){if(200==d.code&&this.createChannelCookies(),n)return n(d)}.bind(this))):n(this.INVALID_MOBILE)}},{key:"getEmailForgotPasswordOtp",value:function getEmailForgotPasswordOtp(t,n,r){return this.isValidEmail(t)?void(r?this.asyncJssoCall("getForgotPasswordOtp",{email:t,userRecaptchaResponseToken:r},n):this.asyncJssoCall("getForgotPasswordOtp",{email:t},n)):n(this.INVALID_EMAIL)}},{key:"verifyMobileForgotPassword",value:function verifyMobileForgotPassword(t,n,r,d,p){return this.isValidMobile(t)?this.isValidPassword(r)?void this.asyncJssoCall("verifyForgotPassword",{mobile:t,otp:n,password:r,confirmPassword:d},p):p(this.INVALID_PASSWORD):p(this.INVALID_MOBILE)}},{key:"verifyEmailForgotPassword",value:function verifyEmailForgotPassword(t,n,r,d,p){return this.isValidEmail(t)?this.isValidPassword(r)?void this.asyncJssoCall("verifyForgotPassword",{email:t,otp:n,password:r,confirmPassword:d},p):p(this.INVALID_PASSWORD):p(this.INVALID_EMAIL)}},{key:"loginMobileForgotPassword",value:function loginMobileForgotPassword(t,n,r,d,p){return this.isValidMobile(t)?this.isValidPassword(r)?void this.asyncJssoCall("loginForgotPassword",{mobile:t,otp:n,password:r,confirmPassword:d},function(k){if(200==k.code&&this.createChannelCookies(),p)return p(k)}.bind(this)):p(this.INVALID_PASSWORD):p(this.INVALID_MOBILE)}},{key:"loginEmailForgotPassword",value:function loginEmailForgotPassword(t,n,r,d,p){return this.isValidEmail(t)?this.isValidPassword(r)?void this.asyncJssoCall("loginForgotPassword",{email:t,otp:n,password:r,confirmPassword:d},function(k){if(200==k.code&&this.createChannelCookies(),p)return p(k)}.bind(this)):p(this.INVALID_PASSWORD):p(this.INVALID_EMAIL)}},{key:"signOutUser",value:function signOutUser(t){this.asyncJssoCall("signOutUser",{},function(n){if(this.deleteChannelCookies(),sessionStorage.removeItem("jsso_crosswalk_user_details"),this.userDetails="",this.fedcmInIfram(),t)return t(n)}.bind(this))}},{key:"updateMobile",value:function updateMobile(t,n,r){return this.isValidMobile(t)?void(r?this.asyncJssoCall("updateMobile",{mobile:t,userRecaptchaResponseToken:r},function(d){if(200==d.code&&this.createChannelCookies(),n)return n(d)}.bind(this)):this.asyncJssoCall("updateMobile",{mobile:t},n)):n(this.INVALID_MOBILE)}},{key:"v1UpdateMobile",value:function v1UpdateMobile(t,n,r){return this.isValidMobile(t)?void(r?this.asyncJssoCall("v1UpdateMobile",{mobile:t,userRecaptchaResponseToken:r},n):this.asyncJssoCall("updateMobile",{mobile:t},asyncJssoCallWithHeaders,n)):n(this.INVALID_MOBILE)}},{key:"verifyMobile",value:function verifyMobile(t,n,r){return this.isValidMobile(t)?void this.asyncJssoCall("verifyMobile",{mobile:t,otp:n},r):r(this.INVALID_MOBILE)}},{key:"addAlternateEmail",value:function addAlternateEmail(t,n){return this.isValidEmail(t)?void this.asyncJssoCall("addAlternateEmail",{email:t},n):n(this.INVALID_EMAIL)}},{key:"v1AddUpdateEmail",value:function v1AddUpdateEmail(t,n,r){return this.isValidEmail(t)?void(r?this.asyncJssoCall("v1AddUpdateEmail",{email:t,userRecaptchaResponseToken:r},function(d){if(200==d.code&&this.createChannelCookies(),n)return n(d)}.bind(this)):this.asyncJssoCall("v1AddUpdateEmail",{email:t},n)):n(this.INVALID_EMAIL)}},{key:"v1AddUpdateMobile",value:function v1AddUpdateMobile(t,n,r){return this.isValidMobile(t)?void(r?this.asyncJssoCall("v1AddUpdateMobile",{mobile:t,userRecaptchaResponseToken:r},function(d){if(200==d.code&&this.createChannelCookies(),n)return n(d)}.bind(this)):this.asyncJssoCall("v1AddUpdateMobile",{mobile:t},n)):n(this.INVALID_MOBILE)}},{key:"verifyAlternateEmail",value:function verifyAlternateEmail(t,n,r){return this.isValidEmail(t)?void this.asyncJssoCall("verifyAlternateEmail",{email:t,otp:n},r):r(this.INVALID_EMAIL)}},{key:"v1VerifyAlternateEmail",value:function v1VerifyAlternateEmail(t,n,r,d){return this.isValidEmail(t)?void this.asyncJssoCall("v1verifyAlternateEmail",{email:t,otp:n,uuid:r},d):d(this.INVALID_EMAIL)}},{key:"v1VerifyAlternateMobile",value:function v1VerifyAlternateMobile(t,n,r,d){return this.isValidMobile(t)?void this.asyncJssoCall("v1verifyAlternateMobile",{mobile:t,otp:n,uuid:r},d):d(this.INVALID_MOBILE)}},{key:"verifyUpdateOtp",value:function verifyUpdateOtp(t,n,r){this.asyncJssoCall("verifyUpdateOtp",{otp:t,uuid:n},r)}},{key:"linkFacebook",value:function linkFacebook(t,n,r){this.asyncJssoCall("linkSocial",{oauthSiteId:"facebook",oauthCode:t,redirectUri:n},r)}},{key:"linkGoogleplus",value:function linkGoogleplus(t,n,r){this.asyncJssoCall("linkSocial",{oauthSiteId:"googleplus",oauthCode:t,redirectUri:n},r)}},{key:"linkLinkedin",value:function linkLinkedin(t,n,r){this.asyncJssoCall("linkSocial",{oauthSiteId:"linkedin",oauthCode:t,redirectUri:n},r)}},{key:"delinkSocial",value:function delinkSocial(t,n){this.asyncJssoCall("delinkSocial",{oauthSiteId:t},n)}},{key:"setPassword",value:function setPassword(t,n,r){return this.isValidPassword(t)?void this.asyncJssoCall("setPassword",{newPassword:t,confirmPassword:n},r):r(this.INVALID_PASSWORD)}},{key:"changePassword",value:function changePassword(t,n,r,d){return this.isValidPassword(n)?void this.asyncJssoCall("changePassword",{oldPassword:t,newPassword:n,confirmPassword:r},d):d(this.INVALID_PASSWORD)}},{key:"changePrimaryEmail",value:function changePrimaryEmail(t,n){return this.isValidEmail(t)?void this.asyncJssoCall("changePrimaryEmail",{emailId:t},n):n(this.INVALID_EMAIL)}},{key:"facebookLoginAccessToken",value:function facebookLoginAccessToken(t,n,r){this.asyncSocialappCall("facebookLogin",{accessToken:t,facebookRedirectUri:n},function(d){if(200==d.code&&this.createChannelCookies(),r)return r(d)}.bind(this))}},{key:"linkFacebookAccessToken",value:function linkFacebookAccessToken(t,n,r){this.asyncJssoCall("linkSocial",{oauthSiteId:"facebook",accessToken:t,redirectUri:n},r)}},{key:"socialImageUpload",value:function socialImageUpload(t,n){this.asyncJssoCall("socialImageUpload",{oauthSiteId:t},n)}},{key:"updateProfilePic",value:function updateProfilePic(t,n){var r=this.ssoBaseUrl+"uploadProfilePic",d=new FormData;d.append("datafile",t);var p=new XMLHttpRequest;p.open("POST",r),p.timeout=3e4,p.withCredentials=!0,p.setRequestHeader("channel",this.channel),p.setRequestHeader("platform",this.platform),p.setRequestHeader("sdkVersion",this.sdkVersion),p.setRequestHeader("IsJssoCrosswalk","true"),p.setRequestHeader("csrfToken",this.getCookie("csrfToken")),p.setRequestHeader("captchaToken",this.getCookie("captchaToken")),p.setRequestHeader("ssec",this.getCookie("jsso_crosswalk_ssec_"+this.channel)),p.setRequestHeader("tksec",this.getCookie("jsso_crosswalk_tksec_"+this.channel)),p.responseType="json",p.onload=function(){var k=p.response;return("string"==typeof k&&(k=JSON.parse(k)),!k||!k.code)?(this.deleteChannelCookies(),void(n&&n(this.UNAUTHORIZED_ACCESS_RESPONSE))):404==k.code?(this.deleteChannelCookies(),void(n&&n(k))):(p.getResponseHeader("csrftoken")&&(this.csrfToken=p.getResponseHeader("csrftoken")),p.getResponseHeader("captchaToken")&&(this.csrfToken=p.getResponseHeader("captchaToken")),p.getResponseHeader("ssec")&&(this.ssec=p.getResponseHeader("ssec")),p.getResponseHeader("tksec")&&(this.tksec=p.getResponseHeader("tksec")),n)?n(k):void 0}.bind(this),p.onerror=function(){if(n)return n(this.CONNECTION_ERROR_RESPONSE)}.bind(this),p.ontimeout=function(){if(n)return n(this.CONNECTION_TIMEOUT_RESPONSE)}.bind(this),p.send(d)}},{key:"registerOnlyMobile",value:function registerOnlyMobile(t,n,r,d,p,k,g,C,I){return d?d&&!this.isValidMobile(d)?C(this.INVALID_MOBILE):void(I?this.asyncJssoCall("registerOnlyMobile",{firstName:t,lastName:n,gender:r,mobile:d,termsAccepted:p,shareDataAllowed:k,timespointsPolicy:g,userRecaptchaResponseToken:I},function(u){if(200==u.code&&this.createChannelCookies(),C)return C(u)}.bind(this)):this.asyncJssoCall("registerOnlyMobile",{firstName:t,lastName:n,gender:r,mobile:d,termsAccepted:p,shareDataAllowed:k,timespointsPolicy:g},C)):C(this.INVALID_REQUEST)}},{key:"truecallerLogin",value:function truecallerLogin(t,n){return t?t&&!this.isValidMobile(t)?n(this.INVALID_MOBILE):void this.asyncJssoCall("truecallerLogin",{mobile:t},n):n(this.INVALID_REQUEST)}},{key:"truecallerVerify",value:function truecallerVerify(t,n){return t?void this.asyncJssoCall("truecallerVerify",{requestId:t},function(r){if(200==r.code&&this.createChannelCookies(),n)return n(r)}.bind(this)):n(this.INVALID_REQUEST)}},{key:"addAlternateEmailTrap",value:function addAlternateEmailTrap(t,n,r,d){return this.isValidEmail(t)?void this.asyncJssoCall("addAlternateEmailIdTrap",{email:t,password:n,alterEmail:r},d):d(this.INVALID_EMAIL)}},{key:"verifyAlternateEmailTrap",value:function verifyAlternateEmailTrap(t,n,r,d,p){return this.isValidEmail(t)?void this.asyncJssoCall("verifyAlternateEmailIdTrap",{email:t,password:n,alterEmail:r,otp:d},p):p(this.INVALID_EMAIL)}},{key:"addAlternateMobileTrap",value:function addAlternateMobileTrap(t,n,r,d){return this.isValidEmail(t)?void this.asyncJssoCall("addAlternateEmailIdTrap",{email:t,password:n,alterMobile:r},d):d(this.INVALID_EMAIL)}},{key:"verifyAlternateMobileTrap",value:function verifyAlternateMobileTrap(t,n,r,d,p){return this.isValidEmail(t)?void this.asyncJssoCall("verifyAlternateMobileTrap",{email:t,password:n,alterMobile:r,otp:d},p):p(this.INVALID_EMAIL)}},{key:"deleteAccount",value:function deleteAccount(t,n){this.asyncJssoCall("deleteUser",{password:t},n)}},{key:"getChannelDetails",value:function getChannelDetails(t,n,r){this.asyncJssoCall("channelDetails",{channel:t,ru:n},r)}},{key:"gpOneTapLogin",value:function gpOneTapLogin(t,n){this.asyncJssoCall("gpOneTap",{token:t},function(r){if(200==r.code&&this.createChannelCookies(),n)return n(r)}.bind(this))}},{key:"subscriberLogin",value:function subscriberLogin(t,n){this.asyncJssoCall("subscriberLogin",{token:t},function(r){if(200==r.code&&this.createChannelCookies(),n)return n(r)}.bind(this))}},{key:"verifyMobileLoginGdpr",value:function verifyMobileLoginGdpr(t,n,r,d,p,k){return this.isValidMobile(t)?void this.asyncJssoCall("verifyLoginOtpPasswordGdpr",{mobile:t,password:n,termsAccepted:r,shareDataAllowed:d,timespointsPolicy:p},function(g){if(200==g.code&&this.createChannelCookies(),k)return k(g)}.bind(this)):k(this.INVALID_MOBILE)}},{key:"verifyMobileLoginGdprForOptIn",value:function verifyMobileLoginGdprForOptIn(t,n,r,d,p,k){return this.isValidMobile(t)?void this.asyncJssoCall("verifyLoginOtpPasswordGdpr",{mobile:t,password:n,termsAccepted:r,shareDataAllowed:d,timespointsPolicy:p},function(g){if(200==g.code&&this.createChannelCookies(),k)return k(g)}.bind(this)):k(this.INVALID_MOBILE)}},{key:"verifyEmailLoginGdpr",value:function verifyEmailLoginGdpr(t,n,r,d,p,k){return this.isValidEmail(t)?void this.asyncJssoCall("verifyLoginOtpPasswordGdpr",{email:t,password:n,termsAccepted:r,shareDataAllowed:d,timespointsPolicy:p},function(g){if(200==g.code&&this.createChannelCookies(),k)return k(g)}.bind(this)):k(this.INVALID_EMAIL)}},{key:"verifyEmailLoginGdprForOptIn",value:function verifyEmailLoginGdprForOptIn(t,n,r,d,p,k){return this.isValidEmail(t)?void this.asyncJssoCall("verifyLoginOtpPasswordGdpr",{email:t,password:n,optInRequest:!0,termsAccepted:r,shareDataAllowed:d,timespointsPolicy:p},function(g){if(200==g.code&&this.createChannelCookies(),k)return k(g)}.bind(this)):k(this.INVALID_EMAIL)}},{key:"updateUserPermissions",value:function updateUserPermissions(t,n,r,d){this.asyncJssoCall("updateUserPermissions",{termsAccepted:t,shareDataAllowed:n,timespointsPolicy:r},function(p){if(200==p.code&&this.createChannelCookies(),d)return d(p)}.bind(this))}},{key:"truecallerOneTapLogin",value:function truecallerOneTapLogin(t,n){return!0!=t.valueOf()&&!1!=t.valueOf()?n(this.INVALID_REQUEST):void this.asyncJssoCall("truecallerOneTapLogin",{},function(r){var d=this;if(200==r.code){if(window.location.href="truecallersdk://truesdk/web_verify?requestNonce="+r.data.requestId+"&partnerKey=Mfn40c8470b1f53324b99aa45ac47738ad539&partnerName="+r.data.channelName+"&lang=en&title=signIn&skipOption=skip",!1==t.valueOf()&&n)return n(r);setTimeout(function(){if(document.hasFocus()){if(n)return n(d.APP_CONNECTION_TIMEOUT_RESPONSE);}else if(n)return n(r)},800)}}.bind(this))}},{key:"socialLogin",value:function socialLogin(t,n,r,d){"FACEBOOK"==t&&this.openSocialLoginPage("https://www.facebook.com/v5.0/dialog/oauth",n,t,r),"GOOGLEPLUS"==t&&this.openSocialLoginPage("https://accounts.google.com/o/oauth2/v2/auth",n,t,r),"LINKEDIN"==t&&this.openSocialLoginPage("https://www.linkedin.com/oauth/v2/authorization",n,t,r),"APPLE"==t&&this.openSocialLoginPage("https://appleid.apple.com/auth/authorize",n,t,r,d)}},{key:"openSocialLoginPage",value:function openSocialLoginPage(t,n,r,d,p){var k=t;"FACEBOOK"==r&&(k+="?client_id="+n+"&display=popup&state=SSOTLOGIN"+r+","+d+"&redirect_uri="+d+"&scope=email"),"GOOGLEPLUS"==r&&(k+="?response_type=code&client_id="+n+"&state=SSOTLOGIN"+r+","+d+"&scope=email profile&include_granted_scopes=true&redirect_uri="+d),"LINKEDIN"==r&&(k+="?response_type=code&client_id="+n+"&state=SSOTLOGIN"+r+"&scope=r_emailaddress r_liteprofile&redirect_uri="+d),"APPLE"==r&&(k+="?client_id="+n+"&state=SSOTLOGIN"+r+","+p+"&redirect_uri="+d+"&scope=email name&response_type=code id_token&response_mode=form_post");window.open(k,"ssoLoginWindow","height=600,width=600,toolbar=no,titlebar=no,status=no,resizable=no,menubar=no,location=no,top=100,left=300,screenX=300,screenY=100")}},{key:"getGeoLocation",value:function getGeoLocation(t){var r=document.createElement("script");r.onload=r.src="https://geoapi.indiatimes.com/?cb=1",document.head.appendChild(r)}},{key:"linkSocialTrapPage",value:function linkSocialTrapPage(t,n){this.asyncJssoCall("linkSocialTrap",{stateid:t},n)}},{key:"resendMobileForgotPasswordOtp",value:function resendMobileForgotPasswordOtp(t,n,r){return this.isValidMobile(t)?void(r?this.asyncJssoCall("resendForgotPasswordOTP",{mobile:t,userRecaptchaResponseToken:r},function(d){if(200==d.code&&this.createChannelCookies(),n)return n(d)}.bind(this)):this.asyncJssoCall("resendForgotPasswordOTP",{mobile:t},n)):n(this.INVALID_MOBILE)}},{key:"resendEmailForgotPasswordOtp",value:function resendEmailForgotPasswordOtp(t,n,r){return this.isValidEmail(t)?void(r?this.asyncJssoCall("resendForgotPasswordOTP",{email:t,userRecaptchaResponseToken:r},n):this.asyncJssoCall("resendForgotPasswordOTP",{email:t},n)):n(this.INVALID_EMAIL)}},{key:"resendMobileLoginOtp",value:function resendMobileLoginOtp(t,n,r){return this.isValidMobile(t)?void(void 0==r?this.asyncJssoCallWithHeaders("resendLoginOtp",{mobile:t},this.captchaToken,n):this.asyncJssoCall("resendLoginOtp",{mobile:t,userRecaptchaResponseToken:r},function(d){if(200==d.code&&this.createChannelCookies(),n)return n(d)}.bind(this))):n(this.INVALID_MOBILE)}},{key:"resendEmailLoginOtp",value:function resendEmailLoginOtp(t,n,r){return this.isValidEmail(t)?void(void 0==r?this.asyncJssoCallWithHeaders("resendLoginOtp",{email:t},this.captchaToken,n):this.asyncJssoCall("resendLoginOtp",{email:t,userRecaptchaResponseToken:r},n)):n(this.INVALID_EMAIL)}},{key:"GisLogin",value:function GisLogin(t,n,r,d,p){this.asyncJssoCall("GISverify",{clientId:t,credential:n,select_by:r,ru:d},function(k){if(200==k.code&&(this.createChannelCookies(),this.fedcmInIfram(k)),p)return p(k)}.bind(this))}},{key:"credLogin",value:function credLogin(t,n){this.asyncJssoCall("credLogin",{accessToken:t},function(r){if(200==r.code&&this.createChannelCookies(),n)return n(r)}.bind(this))}},{key:"newSocialLogin",value:function newSocialLogin(t,n,r,d){this.asyncJssoCall("socialLogin",{accessToken:t,preference:n,loginType:r},function(p){if(200==p.code&&this.createChannelCookies(),d)return d(p)}.bind(this))}},{key:"createChannelCookies",value:function createChannelCookies(){var t=new Date,n=new Date(t);n.setHours(24,0,0,0),this.createCookie("jsso_crosswalk_login_"+this.channel,"true",2592000000),this.createCookie("jsso_crosswalk_daily_"+this.channel,"true",n-t),this.createCookie("csrfToken",this.csrfToken,2592000000),this.createCookie("captchaToken",this.captchaToken,2592000000),this.createCookie("jsso_crosswalk_ssec_"+this.channel,this.ssec,2592000000),this.createCookie("jsso_crosswalk_tksec_"+this.channel,this.tksec,2592000000),this.createCookie("csut",this.csut,2592000000),this.createCookie("gdpr",this.gdpr,2592000000)}},{key:"getChannelCookies",value:function getChannelCookies(){var t={login:this.getCookie("jsso_crosswalk_login_"+this.channel),daily:this.getCookie("jsso_crosswalk_daily_"+this.channel)};return t}},{key:"deleteChannelCookies",value:function deleteChannelCookies(){this.deleteCookieByName("jsso_crosswalk_login_"+this.channel),this.deleteCookieByName("jsso_crosswalk_daily_"+this.channel),this.deleteCookieByName("csrfToken"),this.deleteCookieByName("captchaToken"),this.deleteCookieByName("jsso_crosswalk_ssec_"+this.channel),this.deleteCookieByName("jsso_crosswalk_tksec_"+this.channel),this.deleteCookieByName("csut"),this.deleteCookieByName("gdpr")}},{key:"getCookie",value:function getCookie(t){for(var k,n=t+"=",r=decodeURIComponent(document.cookie),d=r.split(";"),p=0;p<d.length;p++){for(k=d[p];" "==k.charAt(0);)k=k.substring(1);if(0==k.indexOf(n))return k.substring(n.length,k.length)}return""}},{key:"deleteCookieByName",value:,{key:"createCookie",value:function createCookie(t,n,r){var d=new Date,p=d.getTime()+r;d.setTime(p),document.cookie=t+"="+n+"; expires="+d.toGMTString()+"; path=/"}},{key:"getSessionStorage",value:function getSessionStorage(t){var d=null;if(window.sessionStorage&&(d=sessionStorage.getItem(t),d&&-1<d.indexOf("~~"))){var n=d.split("~~"),r=parseInt(n[1]);r<new Date().getTime()?(d=null,sessionStorage.removeItem(t)):d=n[0]}return d}},{key:"setSessionStorage",value:function setSessionStorage(t,n,r){var p=new Date().getTime()+1e3*(60*r);if(window.sessionStorage)if(null==n)sessionStorage.removeItem(t);else try{sessionStorage.setItem(t,n+"~~"+p)}catch(k){}}},{key:"isValidEmail",value:function isValidEmail(t){var n=/^(([^<>()\[\]\\.,;:\s@"]+([^<>()\[\]\\,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return n.test((t+"").toLowerCase().trim())}},{key:"isValidMobile",value:function isValidMobile(t){var n=/^((((\+?\(91\))|0|((00|\+)?91))-?)?[6-9]\d{9})|((\+\d{1,5}[-])\d{3,14})$/;return n.test(t.trim()+"")}},{key:"isValidDomain",value:function isValidDomain(t){var n=/^(ttp[s]?:\/\/(www\.)?|ftp:\/\/(www\.)?|www\.){1}([0-9A-Za-z-\.@:%_+~#=]+)+((\.[a-zA-Z]{2,3})+)(\/(.)*)?(\?(.)*)?/;return n.test(t+"")}},{key:"isValidPassword",value:function isValidPassword(t){t+="";var n=/.*[a-z]+.*/,r=/.*[!@#$%^&*()]+.*/,d=/.*[0-9]+.*/;return 6>t.length||14<t.length?!1:n.test(t)&&r.test(t)&&d.test(t)}},{key:"open",value:function open(){for(var n=arguments.length,t=Array(n),r=0;r<n;r++)t[r]=arguments[r];var d=t[0],p=t.slice(1);if(d){var k=new URL(d);this.getValidLoggedInUser(function g(C){var u,I=C.data.encTicket;k.searchParams.set("ticketId",I),(u=window).open.apply(u,[k].concat(_toConsumableArray(p)))})}}}]),s}();function getParameterByName(s,a){a=a||window.location.href,s=s.replace(/[\[\]]/g,"\\$&");var o=new RegExp("[?&]"+s+"(=([^&#]*)|&|#|$)"),l=o.exec(a);return l?l[2]?decodeURIComponent(l[2].replace(/\+/g," ")):"":""}