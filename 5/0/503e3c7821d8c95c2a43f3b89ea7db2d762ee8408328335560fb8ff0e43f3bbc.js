(window._vfP=window._vfP||[]).push([[191],{670:function(t,e,n){"use strict";n.r(e),n.d(e,"storeModule",();n(27),n(3),n(52),n(46),n(58),n(47),n(48),n(17),n(18),n(13),n(14),n(15),n(51);var r=n(0),u=n(423);function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){c(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function c(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var _={[r.Vc]:function(t,e,n,u){return function(n){var i=t[n];if(i){var c=u[r.Rb];return o(o({},i),{},{thread_palette:e[r.Xc](n),visible_content:i.visible_content.filter(c),realtime_content:i.realtime_content.filter(c)})}}},[r.ad]:function(t,e,n,u){return function(t){var n=e[r.Vc](t);if(n){var i=u[r.db],c=u[r.eb];return o(o({},n),{},{pinned_content:n.visible_content.filter(i),unpinned_content:n.visible_content.filter(c)})}}},[r.wd]:function(t,e,n,u){return function(e){return t[e].visible_content.filter(u[r.Rb])}},[r.Wc]:function(t){return function(e){var n=t[e],r=n.total_content,u=n.visible_content,i=n.realtime_content;return r-u.length-i.length}},[r.td]:function(t,e,n,u){return function(e){return t[e].visible_replies.map(u[r.S])}},[r.Yc]:[r.Dc]:[r.dc]:function(t){return function(e){var n=e.content_uuid,r=e.thread_uuid;return t[r].unread_reply_content.includes(n)}},[r.cc]:function(t){return function(e){var n=e.content_uuid,r=e.thread_uuid;return t[r].unread_mention_content.includes(n)}},[r.Ib]:function(t){return function(e){return Boolean(t[e].unread_reply_content.length)}},[r.Gb]:function(t){return ,[r.Hb]:function(t,e,n,u){return function(e){var n=e.thread_uuid,i=e.subthread_uuid;return Boolean(t[n].unread_reply_content.filter((function(t){return u[r.S](t).parent_uuid===i})).length)}},[r.Fb]:function(t,e,n,u){return function(e){var n=e.thread_uuid,i=e.subthread_uuid;return Boolean(t[n].unread_mention_content.filter((function(t){return u[r.S](t).parent_uuid===i||u[r.hd](t).target_uuid===i})).length)}},[r.id]:function(t,e,n,u){return function(e){return t[e].unread_reply_content.map(u[r.S])}},[r.Jb]:function(t,e,n,u){return function(e){return t[e].unread_reply_content.filter(u[r.Y]).length>0}},[r.Xc]:function(t){return function(e){var n=t[e],r=n.unread_mention_content,i=n.unread_reply_content;return r.length>0?u.a.MENTION:i.length>0?u.a.ACCENT:u.a.LIGHT_PRIMARY}},[r.m]:function(t,e,n,u){return function(n){var i=e[r.wd](n),o=u[r.Ad](n),c=o.promo_interval,_=o.first_promo_position,a=t[n].base_promo_uuid,d=a?i.indexOf(a):i.length-1,l=a?d+_-1:d;return i.filter((function(t,e){return!(e!==l||!a)||(e>l&&(e-l)%c==0||!!(e<d&&(l-e)%c==0))}))}},[r.bc]:function(t,e){return function(t,n){return e[r.m](t).includes(n)}}},a=(n(35),n(34),n(139),n(284),n(2)),d=n(55),l=n(41); b=Object(d.b)(l.default,"thread_uuid",(function(t){return{thread_uuid:t,thread_top_uuid:null,visible_content:[],unread_mention_content:[],unread_reply_content:[],realtime_content:[],selected_content:[],base_promo_uuid:null,total_content:0,is_in_view:!1,page_from:null,more_available:!1}})),p={[a.T]:b,[a.cc][a.Mb](t,e){var n=e.thread_uuid,r=e.content_uuid;t[n].visible_content=t[n].visible_content.filter((function(t){return t!==r}))},[a.Lb](t,e){var n=e.thread_uuid,r=e.content_uuid;t[n].realtime_content=t[n].realtime_content.filter(()},[a.z](t,e){var n=e.thread_uuid,r=e.content_uuid;t[n].visible_content.includes(r)||t[n].visible_content.push(r)},[a.zb](t,e){var n=e.thread_uuid,r=e.content_uuid;if(!t[n].visible_content.includes(r)){var u=t[n].visible_content;t[n].visible_content=[r].concat(u)}},[a.y](t,e){var n=e.thread_uuid,r=e.content_uuid;t[n].realtime_content.includes(r)||t[n].realtime_content.push(r)},[a.yb](t,e){var n=e.thread_uuid,r=e.content_uuid;if(!t[n].realtime_content.includes(r)){var u=t[n].realtime_content;t[n].realtime_content=[r].concat(u)}},[a.A](t,e){var n=e.thread_uuid,r=e.limit,u=t[n],i=u.visible_content,o=u.realtime_content,c=o.slice(0,r);t[n].realtime_content=o.slice(r),t[n].visible_content=i.concat(c)},[a.Ab](t,e){var n=e.thread_uuid,r=e.limit,u=t[n],i=u.visible_content,o=u.realtime_content,c=o.slice(o.length-r,o.length);t[n].realtime_content=o.slice(0,o.length-r),t[n].visible_content=c.concat(i)},[a.od](t,e){var n=e.thread_uuid,r=e.is_in_view;t[n].is_in_view=r},[a.P](t,e){t[e]&&(t[e]=f(f({},t[e]),{},{visible_content:[],page_from:null,more_available:!1,base_promo_uuid:null}))},[a.B](t,e){var n=e.thread_uuid,r=e.contents,u=e.new_page,i=void 0===u||u,o=r.map((function(t){return t.content_uuid})).filter((function(e){return!t[n].visible_content.includes(e)}));t[n].visible_content=t[n].visible_content.concat(o),t[n].realtime_content=t[n].realtime_content.filter((function(t){return!o.includes(t)})),i&&o.length&&(t[n].page_from=o[o.length-1])},[a.Bb](t,e){var n=e.thread_uuid,r=e.contents.sort((function(t,e){return t.time-e.time})).map((function(t){return t.content_uuid})).filter((),u=t[n].visible_content;t[n].visible_content=r.concat(u),t[n].realtime_content=t[n].realtime_content.filter((),t[n].page_from=r[0]},[a.d](t,e){var n=e.thread_uuid,r=e.content_uuid;t[n].unread_mention_content.push(r)},[a.e](t,e){var n=e.thread_uuid,r=e.content_uuid;t[n].unread_reply_content.push(r)},[a.Pb](t,e){var n=e.thread_uuid,r=e.content_uuid,u=t[n].unread_mention_content.indexOf(r);t[n].unread_mention_content.splice(u,1)},[a.Qb](t,e){var n=e.thread_uuid,r=e.content_uuid,u=t[n].unread_reply_content.indexOf(r);t[n].unread_reply_content.splice(u,1)},[a.Sb](t,e){var n=e.thread_uuid,r=e.content_uuid;if(t[n]){var u=t[n].visible_content.indexOf(r);-1!==u&&t[n].visible_content.splice(u,1)}},[a.Kb](t,e){var n=e.thread_uuid,r=e.content_uuid;if(t[n]){var u=t[n].realtime_content.indexOf(r);-1!==u&&t[n].realtime_content.splice(u,1)}},[a.nb](t,e){t[e]&&(t[e].total_content+=1)},[a.W](t,e){t[e]&&(t[e].total_content-=1)},[a.Oc](t,e){var n=e.thread_uuid,r=e.content_uuids;t[n].selected_content=t[n].selected_content.concat(r)},[a.N][a.Wc],h=(n(7),n(4)),m=n(175),g={[h.u](t,e){for(var n=t.getters,u=t.commit,i=t.rootGetters,o=e.content_container_uuid,c=e.contents,_=e.more_available,d={},l=0;l<c.length;l++){var s=c[l];if(s.thread_uuid===o){d[s.content_uuid]=d[s.content_uuid]||{},d[s.content_uuid].visible_content=d[s.content_uuid].visible_content||[],d[s.content_uuid].thread_uuid=s.content_uuid,d[s.content_uuid].thread_top_uuid=s.thread_uuid,d[s.content_uuid].total_content=s.total_replies;var f=(0,i[r.gd])(s.content_uuid);d[s.content_uuid].unread_mention_content=f.map((function(t){return t.content_uuid}))}else{d[s.thread_uuid]||(d[s.thread_uuid]={},d[s.thread_uuid].visible_content=[]);var v=d[s.thread_uuid].visible_content;v.push(s),v.sort((),d[s.thread_uuid].page_from=v[0].content_uuid}}for(var b in d)d[b].visible_content=d[b].visible_content.map((function(t){return t.content_uuid})),u(a.T,d[b]);var p=n[r.Vc](o);if(null==p||!p.base_promo_uuid){var h=Object.keys(d),m=h[0];u(a.T,{thread_uuid:o,visible_content:h,base_promo_uuid:m,page_from:h[h.length-1],more_available:_})}},[h.Tb](t,e){var n=e.content_container_uuid,u=e.thread_uuid,i=e.selected_content_uuids,o=e.fetchAction,c=t.getters,_=t.commit,d=t.dispatch,l=t.rootGetters,s=c[r.Vc](u);return function(t,e,n,u,i){if(e)return Promise.resolve();var o=t.getters,c=t.commit,_=t.dispatch,d=t.rootGetters;return _(i,{content_container_uuid:n,content_uuids:u},{root:!0}).then((function(_){var l=d[r.S](_[0]),s=[];return l.thread_uuid===n&&(s=d[r.gd](u).map((function(t){return t.content_uuid}))),c(a.T,{thread_uuid:u,thread_top_uuid:l.thread_uuid,total_content:l.total_replies,unread_mention_content:s}),e=o[r.Vc](u),function(t,e,n,u){var i=t.getters,o=t.commit,c=t.dispatch,_=t.rootGetters,d=e===n.thread_top_uuid?n.thread_uuid:n.thread_top_uuid,l=_[r.S](d);if(l){if(!i[r.Vc](d)){var s=_[r.gd](d).map((function(t){return t.content_uuid})),f={thread_uuid:d,thread_top_uuid:e,total_content:l.total_replies,unread_mention_content:s};o(a.T,f)}return o(a.B,{thread_uuid:e,contents:[l],new_page:!1}),Promise.resolve()}return c(u,{content_container_uuid:e,content_uuids:d},{root:!0}).then((function(t){var n=_[r.S](t[0]),u=_[r.gd](d).map((),i={thread_uuid:d,thread_top_uuid:e,total_content:n.total_replies,unread_mention_content:u};o(a.T,i),o(a.B,{thread_uuid:e,contents:[n],new_page:!1})}))}(t,n,e,i)}))}(t,s,n,u,o).then((function(){if(s||(s=c[r.Vc](u)),i){_(a.N,u);var t=i.filter((function(t){return!l[r.S](t)})).join();if(t.length>0)return d(o,{content_container_uuid:n,content_uuids:t},{root:!0}).then(();_(a.Oc,{thread_uuid:u,content_uuids:i})}return Promise.resolve()}))},[h.c](t,e){var n=t.commit,u=t.getters,i=t.dispatch,o=t.rootGetters,c=e.content_container_uuid,_=e.parent_uuid,d=e.actor_uuid,l=e.parent_actor_uuid,s=e.thread_uuid,f=e.content_uuid,v=u[r.Vc](s);if(!v)return Promise.resolve();var b=s===c,p=o[r.a](c),g=p.thread_uuid===s||p.parent_thread_uuid===s;if(!o[r.Rb](f))return Promise.resolve();var y=v.realtime_content,O=v.visible_content,P=v.is_in_view,j=y.includes(f)||O.includes(f);if((b||g)&&j)return Promise.resolve();var w=function(t,e,n,u,i,o){var c=t[r.Y](n),_=0===u.length&&i;if(e)return!m.f||_||o?a.zb:a.yb;if(c)return a.z;return a.y}(o,b,f,y,P,0===O.length);return n(w,{thread_uuid:s,content_uuid:f}),g&&p.parent_thread_uuid!==c&&n(w,{thread_uuid:p.thread_uuid,content_uuid:f}),n(a.nb,s),i(h.d,{parent_actor_uuid:l,parent_uuid:_,actor_uuid:d,content_container_uuid:c,thread_uuid:s,content_uuid:f})},[h.d](t,e){var n=t.rootGetters,u=t.commit,i=e.parent_actor_uuid,o=e.parent_uuid,c=e.actor_uuid,_=e.content_container_uuid,d=e.thread_uuid,l=e.content_uuid,s=n[r.kb];u(s===c||o===_||!(s===i)?a.e:a.d,{thread_uuid:d,content_uuid:l})},[h.Cc](t,e){var n=t.getters,u=t.commit,i=t.rootGetters,o=e.thread_uuid,c=e.content_uuid,_=i[r.S](c),d=n[r.Vc](o);if(d&&_){var l=_.content_container_uuid,s=!d.thread_top_uuid,f=l===d.thread_top_uuid,v={thread_uuid:s||f?o:d.thread_top_uuid,content_uuid:c},b=n[r.cc](v),p=n[r.dc](v);b&&u(a.Pb,v),p&&u(a.Qb,v)}}};var y=function(){return{namespaced:!0,state:getters:_,actions:g,mutations:p}}}}]);
//# sourceMappingURL=threads-module-js.d2804e8bedf7c12b57f2.js.map