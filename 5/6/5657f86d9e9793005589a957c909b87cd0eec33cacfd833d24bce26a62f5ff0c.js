(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5695],{6676:function(e,t,r){var i=r(92368),n=r(36658),o=r(68289),s=0;function randomBlock(){return n((1679616*o()<<0).toString(36),4)}function safeCounter(){return s=s<1679616?s:0,++s-1}uid.slug=cuid.isCuid=cuid.isSlug=cuid.fingerprint=i,e.exports=cuid},92368:function(e,t,r){var i=r(36658),n=Object.keys("object"==typeof window?window:self).length,o=i(((navigator.mimeTypes?navigator.mimeTypes.length:0)+navigator.userAgent.length).toString(36)+n.toString(36),4);e.exports=function(){return o}},68289:function(e){var t,r="undefined"!=typeof window&&(window.crypto||window.msCrypto)||"undefined"!=typeof self&&self.crypto;t=r?function(){return Math.abs(r.getRandomValues(new Uint32Array(1))[0]/4294967295)}:Math.random,e.exports=t},36658:67173:1991:57289:function(e,t,r){"use strict";r.d(t,{W3:function(){return syncProject}});var i=r(47330),n=r(24065),o=r(61543),s=r(81332),u=r(47147),a=r(73750),l=r(81525),c=r(3583),d=r(83615),p=r(20851);async function syncStaticResource(e,t,r,i){if(t.startsWith("data:"))return;let o=(0,n.m1)(t);if(o){let s=await (0,n.M2)(e,t,r,i);if(!s)return;let u=(0,a.C)(s);if(!u)return;let{mime:l,base64:c}=u;if(!l.startsWith("text/css"))return;let d=c?atob(u.body):u.body,p=(0,n.d1)(r,{staticResourceId:o});await (0,n.$_)(e,d,p);return}let s=await (0,n.Cz)(t,i);if(!s)return;let u=(0,a.C)(s);if(!u)return s;let{mime:l,base64:c}=u;if(!l.startsWith("text/css"))return s;let d=c?atob(u.body):u.body,p=d;return await (0,n.Cf)(d,async(t,i)=>{let o=i[0].includes("@import"),s=(0,n.m1)(t),u=s?(0,n.d1)(r,{staticResourceId:s}):r,a=await syncStaticResource(e,t,u,o?"text/css":void 0);a&&(p=p.replace(t,a))}),"data:text/css;base64,".concat(btoa(p))}async function syncWebCapture(e,t,r){let{id:i,published:o}=t,s=(null==o?void 0:o.captureVersionId)||(null==o?void 0:o.id);if(s&&r.allWebCaptureVersions[s])return;r.allWebCaptureVersions[s]=!0;let u={id:s,webCaptureId:i,node:await (0,n.rT)({id:s})};if(!u.node){console.error("Capture ".concat(s," not found"));return}let a=(0,n.d1)(r,{webCaptureVersionId:s});return a.webCaptureVersionToStaticResources[s]=[],await (0,l.hv)(u.node,[(0,n.Or)({filter:d.hK,operation:(0,n.rw)(e,a)}),(0,n.tZ)({filter:n.u4,operation:(0,n.GR)(e,a)}),(0,n.tZ)({filter:n.If,operation:(0,n.Xw)(e,a)}),(0,n.tZ)({filter:n.aI,operation:(0,n.kC)(e,a)}),(0,n.tZ)({filter:n.Yn,operation:(0,n.dv)(e,a)}),(0,n.tZ)({filter:n.wq,operation:(0,n.oB)(e,a)}),(0,n.tZ)({filter:n.FU,operation:(0,n.EA)(e,a)}),(0,n.tZ)({filter:n.TE,operation:(0,n.hQ)(e,a)})],!0),a.guideToWebCaptureVersions[r.guideId].push(s),await e.webCaptureVersion.upsert({data:u})}async function syncWebCaptures(e,t,r){return await Promise.all(t.map(t=>syncWebCapture(e,t,r)))}async function syncMediaCapture(e,t,r){if(r.allScreenshotCaptures[t.id])return;r.allScreenshotCaptures[t.id]=!0;let{deviceScreenshot:i,deviceTemplate:o,...u}=t,a={...u,deviceScreenshot:i,deviceTemplate:void 0};if(i&&(a.deviceScreenshot=await (0,n.Cz)(i)),o){let e=s.Ak.find(;if(null==e?void 0:e.image){let t=(0,s.Gc)(e),r=await (0,n.Cz)(t);r&&(a.deviceTemplate={...e,image:r})}}return r.guideToScreenshotCaptures[r.guideId].push(t.id),await e.screenshotCapture.upsert({data:a})}async function syncMediaCaptures(e,t,r){return await Promise.all(t.map()}async function syncFlow(e,t,r){if(r.allGuides[t.id])return;if(r.allGuides[t.id]=!0,!("published"in t)){let e=await (0,n.sj)(t.id);if(!e){console.error("Flow ".concat(t.id," not found"));return}e.guide&&(e.published=e.guide),t=e}let o=t,s=(0,n.d1)(r,{guideId:o.id});s.guideToWebCaptureVersions[o.id]=[],s.guideToScreenshotCaptures[o.id]=[],s.guideToStaticResources[o.id]=[];let u=[],{steps:a,...l}=o.published,c=[],d=[],f=[];if(a)for(let{webCapture:t,screenshotCapture:r,...n}of a){if(t&&c.push(t),r&&d.push(r),(n.appearance===i.XB.Modal||n.appearance===i.XB.Tooltip)&&n.content){let t=(0,p.OA)(n.content);if(t)for(let r in t.entityMap)try{let i=t.entityMap[r];i.data.src&&u.push(syncStaticResource(e,i.data.src,s))}catch(e){}}f.push({...n,webCapture:t?{id:t.id,name:t.name}:void 0})}let{published:h,...m}=o.published.theme||{};h&&u.push(syncThemeVersion(e,h,s));let w={...o,published:{...l,steps:f,theme:o.published.theme?m:void 0},type:o.type};if((null==c?void 0:c.length)&&u.push(syncWebCaptures(e,c,s)),(null==d?void 0:d.length)&&u.push(syncMediaCaptures(e,d,s)),w.published.steps.length)for(let t of w.published.steps){let{backBtn:r,nextBtn:i,beacons:n,buttons:o,triggers:a}=t;(null==r?void 0:r.actions)&&u.push(scanActionsForFlowStarts(e,r.actions,s)),(null==i?void 0:i.actions)&&u.push(scanActionsForFlowStarts(e,i.actions,s)),(null==n?void 0:n.length)&&u.push(Promise.all(n.map(async t=>{t.actions&&await scanActionsForFlowStarts(e,t.actions,s)}))),(null==o?void 0:o.length)&&u.push(Promise.all(o.map(async t=>{t.actions&&await scanActionsForFlowStarts(e,t.actions,s)}))),(null==a?void 0:a.length)&&u.push(Promise.all(a.map(async t=>{t.actions&&await scanActionsForFlowStarts(e,t.actions,s)})))}u.push(e.guide.upsert({data:w})),await Promise.all(u)}async function syncChecklist(e,t,r){if(r.allGuides[t.id])return;if(r.allGuides[t.id]=!0,!("published"in t)){let e=await (0,n.sj)(t.id);if(!e){console.error("Checklist ".concat(t.id," not found"));return}let{guide:r,...i}=e;t={...i,published:r}}let i=t,o=(0,n.d1)(r,{guideId:i.id});o.guideToWebCaptureVersions[i.id]=[],o.guideToScreenshotCaptures[i.id]=[];let s=[],{steps:u,...a}=i.published,{published:l,...c}=i.published.theme||{};l&&s.push(syncThemeVersion(e,l,o));let d={...i,published:{...a,theme:i.published.theme?c:void 0},type:i.type};if(d.published.tasks)for(let t of d.published.tasks)t.actions&&s.push(scanActionsForFlowStarts(e,t.actions,o));s.push(e.guide.upsert({data:d})),await Promise.all(s)}let scanActionsForFlowStarts=async(e,t,r)=>await Promise.all(t.map(async t=>{t.startFlowId&&await syncFlow(e,{id:t.startFlowId},r)})),syncThemeVersion=async(e,t,r)=>{if(r.allThemeVersions[t.id]){r.themeVersionToGuides[t.id].includes(r.guideId)||r.themeVersionToGuides[t.id].push(r.guideId);return}if(r.allThemeVersions[t.id]=!0,r.themeVersionToGuides[t.id]=[r.guideId],t.dialogFontUrl){let i=await syncStaticResource(e,t.dialogFontUrl,r,"text/css");i&&(t.dialogFontUrl=i)}return await e.themeVersion.upsert({data:t})};async function syncProject(e,t){let r=await (0,n.$M)(t);if(!r){console.error("Project ".concat(t," not found"));return}if((0,u.MH)(r)){console.error("Project ".concat(t," is passcode protected"));return}let{checklist:i,flow:s,...a}=r,l={...a,flowId:null==s?void 0:s.id,checklistId:null==i?void 0:i.id},c=(0,n.d1)(t),d=[];if(s&&d.push(syncFlow(e,s,c)),i&&d.push(syncChecklist(e,i,c)),d.length&&await Promise.all(d),!l.screenshot){let e="";if(s){var p,f,h;let t=null===(p=s.published.steps)||void 0===p?void 0:p.find(e=>{var t,r,i;return(null===(r=e.webCapture)||void 0===r?void 0:null===(t=r.published)||void 0===t?void 0:t.id)||(null===(i=e.screenshotCapture)||void 0===i?void 0:i.deviceScreenshot)});t&&(e=(null===(f=t.screenshotCapture)||void 0===f?void 0:f.deviceScreenshot)?null===(h=t.screenshotCapture)||void 0===h?void 0:h.deviceScreenshot:(0,o.m$)(t.webCapture.published.id))}e&&(l.screenshot=await (0,n.Cz)(e,null))}await updateItemConnections(e,c),await e.project.upsert({data:l})}async function updateItemConnections(e,t){var r,i,n;let{projectId:o,themeVersionToGuides:s,guideToScreenshotCaptures:u,guideToWebCaptureVersions:a,guideToStaticResources:l,webCaptureVersionToStaticResources:d,staticResourceToStaticResources:f}=t,h={};for(let e in s)for(let t of s[e])h[t]=e;let m={};for(let e in u)for(let t of u[e])m[t]=m[t]||[],m[t].push(e);let w={};for(let e in a)for(let t of a[e])w[t]=w[t]||[],w[t].push(e);let g={};for(let e in d)for(let t of d[e])g[t]=g[t]||[],g[t].push(e);let v={};for(let e in f)for(let t of f[e])v[t]=v[t]||[],v[t].push(e);let y={};for(let e in l)for(let t of l[e])y[t]=y[t]||[],y[t].push(e);let b=Object.keys(s),C=Object.keys(a),T=Object.keys(m),S=Object.keys(w),P=Object.keys(g),I=Object.keys(v),R=Object.keys(l),F=Object.keys(y),j=[e.projectToGuides.findFirst({where:o}),Promise.all(b.map(t=>e.themeVersionToGuideVersions.findFirst({where:t}))),Promise.all(T.map(t=>e.screenshotCaptureToGuides.findFirst({where:t}))),Promise.all(C.map(t=>Promise.all([e.guideToProjects.findFirst({where:t}),e.guideToScreenshotCaptures.findFirst({where:t}),e.guideToWebCaptureVersions.findFirst({where:t})]))),Promise.all(S.map(t=>Promise.all([e.webCaptureVersionToStaticResources.findFirst({where:t}),e.webCaptureVersionToGuides.findFirst({where:t})]))),Promise.all(P.map(t=>Promise.all([e.staticResourceToStaticResources.findFirst({where:t}),e.staticResourceToWebCaptureVersions.findFirst({where:t})]))),Promise.all(I.map(t=>e.staticResourceInStaticResources.findFirst({where:t}))),Promise.all(R.map(t=>e.guideToStaticResources.findFirst({where:t}))),Promise.all(F.map()],[k,V,G,W,_,x,E,A,U]=await Promise.all(j),M=new c.ci,O=(null==k?void 0:k.guideIds)||[],L=(0,p.hp)(O,C);L.length!==O.length&&M.enqueue(e.projectToGuides.upsert({data:{projectId:o,guideIds:L}}));for(let t=0;t<b.length;++t){let r=b[t],i=V[t],n=(null==i?void 0:i.guideVersionIds)||[],o=s[r],u=(0,p.hp)(n,o);u.length!==n.length&&M.enqueue(e.themeVersionToGuideVersions.upsert({data:{themeVersionId:r,guideVersionIds:u}}))}for(let t=0;t<T.length;++t){let r=T[t],i=G[t],n=(null==i?void 0:i.guideIds)||[],o=m[r],s=(0,p.hp)(n,o);s.length!==n.length&&M.enqueue(e.screenshotCaptureToGuides.upsert({data:{screenshotCaptureId:r,guideIds:s}}))}for(let t=0;t<C.length;++t){let[r,i,n]=W[t]||[],s=C[t],l=(null==r?void 0:r.projectIds)||[],c=[o],d=(0,p.hp)(l,c);d.length!==l.length&&M.enqueue(e.guideToProjects.upsert({data:{guideId:s,projectIds:d}}));let f=(null==i?void 0:i.screenshotCaptureIds)||[],m=u[s]||[],w=(0,p.hp)(f,m);w.length!==f.length&&M.enqueue(e.guideToScreenshotCaptures.upsert({data:{guideId:s,screenshotCaptureIds:w}}));let g=(null==n?void 0:n.webCaptureVersionIds)||[],v=a[s]||[],y=(0,p.hp)(g,v);y.length!==g.length&&M.enqueue(e.guideToWebCaptureVersions.upsert({data:{guideId:s,webCaptureVersionIds:y}}));let b=h[s];b&&M.enqueue(e.guideToThemeVersion.upsert({data:{guideId:s,themeVersionId:b}}))}for(let t=0;t<S.length;++t){let[r,i]=_[t]||[],n=S[t],o=(null==r?void 0:r.staticResourceIds)||[],s=d[n]||[],u=(0,p.hp)(o,s);u.length!==o.length&&M.enqueue(e.webCaptureVersionToStaticResources.upsert({data:{webCaptureVersionId:n,staticResourceIds:u}}));let a=(null==i?void 0:i.guideIds)||[],l=w[n]||[],c=(0,p.hp)(a,l);c.length!==a.length&&M.enqueue(e.webCaptureVersionToGuides.upsert({data:{webCaptureVersionId:n,guideIds:c}}))}for(let t=0;t<P.length;++t){let[r,i]=x[t]||[],n=P[t],o=(null==r?void 0:r.staticResourceIds)||[],s=f[n]||[],u=(0,p.hp)(o,s);u.length!==o.length&&M.enqueue(e.staticResourceToStaticResources.upsert({data:{staticResourceId:n,staticResourceIds:u}}));let a=(null==i?void 0:i.webCaptureVersionIds)||[],l=g[n]||[],c=(0,p.hp)(a,l);c.length!==a.length&&M.enqueue(e.staticResourceToWebCaptureVersions.upsert({data:{staticResourceId:n,webCaptureVersionIds:c}}))}for(let t=0;t<I.length;++t){let i=(null===(r=E[t])||void 0===r?void 0:r.staticResourceIds)||[],n=v[I[t]]||[],o=(0,p.hp)(i,n);o.length!==i.length&&M.enqueue(e.staticResourceInStaticResources.upsert({data:{staticResourceId:I[t],staticResourceIds:o}}))}for(let t=0;t<R.length;++t){let r=(null===(i=A[t])||void 0===i?void 0:i.staticResourceIds)||[],n=l[R[t]]||[],o=(0,p.hp)(r,n);o.length!==r.length&&M.enqueue(e.guideToStaticResources.upsert({data:{guideId:R[t],staticResourceIds:o}}))}for(let t=0;t<F.length;++t){let r=(null===(n=U[t])||void 0===n?void 0:n.guideIds)||[],i=y[F[t]]||[],o=(0,p.hp)(r,i);o.length!==r.length&&M.enqueue(e.staticResourceToGuides.upsert({data:{staticResourceId:F[t],guideIds:o}}))}await Promise.all(M)}},61543:function(e,t,r){"use strict";r.d(t,{I8:function(){return formatReviewShareLink},Lp:function(){return removeStartSlash},U4:function(){return previewFlowUrl},V7:function(){return formatURLForDisplay},fJ:function(){return projectPlayerUrl},fP:function(){return formatShareLinkWithPath},fy:function(){return n},m$:function(){return formatScreenshotUrl},s1:function(){return replaceSubdomainInHost},wn:function(){return removeHttpFromUrl}});var i,n,o=r(42906),s=r(89720),u=r(1991);let previewFlowUrl=(e,t,r)=>"".concat((0,u.e9)({flow_id:e}),"?s=").concat(null!=t?t:0).concat(r?"&lang=".concat(r):""),projectPlayerUrl=formatScreenshotUrl=e=>"".concat(s._.CAPTURE_SCREENSHOT_URL.PROD,"/nv_static/").concat(e),replaceSubdomainInHost=formatURLForDisplay=removeWWWFromUrl=removeHttpFromUrl=(i=n||(n={})).G2="g2",i.TrustRadius="trustRadius",i.Capterra="capterra",i.Gartner="gartner";let formatReviewShareLink=et formatShareLinkWithPath=,7095:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return OfflineSync}});var i=r(52322),n=r(57289),o=r(29119);function onClick(){let e=document.getElementById("project-id-input"),t=e.value;if(!t){alert("Please enter a project ID");return}(0,n.W3)(o.w,t).then(}function OfflineSync(){return(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{children:"Offline"}),(0,i.jsxs)("div",{style:{display:"flex"},children:[(0,i.jsx)("input",{id:"project-id-input",placeholder:"Enter Project ID...",style:{marginRight:"2px",marginLeft:"2px"}}),(0,i.jsx)("button",{onClick:onClick,style:{marginLeft:"2px",border:"1px solid black"},children:"Download"})]})]})}},42906:47147:50733:function(e,t,r){"use strict";r.d(t,{$M:function(){return n},JH:function(){return i},SW:function(){return s},lk:);let i="__NAVATTIC_FLOW____CAPTURE_OPEN__",n=Symbol("nv_node_ref"),o={width:1200,height:750},s=800},34406:,);
//# sourceMappingURL=sync-99b8fdb84ed0679f.js.map