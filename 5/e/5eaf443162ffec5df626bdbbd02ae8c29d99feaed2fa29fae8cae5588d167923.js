function $_global_core(){if("undefined"==typeof g_all_modules)g_all_modules={};g_all_modules["core.js"]={version:{rmj:16,rmm:0,rup:10404,rpr:20003}};typeof spWriteProfilerMark=="function"&&spWriteProfilerMark("perfMarkBegin_core.js");SPAnimation={};SPAnimation.g_Curves=new Array(7);SPAnimation.g_Curves[0]=new SPCurve(0,0,0,0,0,0);SPAnimation.g_Curves[1]=new SPCurve(1,1,0,0,0,0);SPAnimation.g_Curves[2]=new SPCurve(2,2,0,0,0,0);SPAnimation.g_Curves[3]=new SPCurve(3,3,.1,.9,.2,1);SPAnimation.g_Curves[4]=new SPCurve(4,3,.42,0,1,1);SPAnimation.g_Curves[5]=new SPCurve(5,3,0,0,.58,1);SPAnimation.g_Curves[6]=new SPCurve(6,3,.42,0,.58,1);SPKeyFrame.prototype={type:0,curveID:0,startTime:0,endTime:0,startValue:0,endValue:0,relativeTo:0,operationType:0};SPAnimation.Attribute={PositionX:1,PositionY:2,Height:3,Width:4,Opacity:5};SPAnimation.ID={Basic_Show:0,Basic_SlowShow:1,Basic_Fade:2,Basic_Move:3,Basic_Size:4,Content_SlideInFadeInRight:5,Content_SlideInFadeInRightInc:6,Content_SlideOutFadeOutRight:7,Content_SlideInFadeInLeft:8,Content_SlideInFadeInLeftInc:9,SmallObject_SlideInFadeInTop:10,SmallObject_SlideInFadeInLeft:11,Test_Instant:12,Test_Hold:13,Basic_Opacity:14,Basic_QuickShow:15,Basic_QuickFade:16,Content_SlideInFadeInGeneric:17,Basic_StrikeThrough:18,SmallObject_SlideInFadeInBottom:19,SmallObject_SlideOutFadeOutBottom:20,Basic_QuickSize:21};SPAnimation.g_Animations=new Array(22);SPAnimation.g_Animations[SPAnimation.ID.Basic_Show]=new Animation(SPAnimation.ID.Basic_Show,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,367,0,1,1,0)]);SPAnimation.g_Animations[SPAnimation.ID.Basic_SlowShow]=new Animation(SPAnimation.ID.Basic_SlowShow,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,700,0,1,1,0)]);SPAnimation.g_Animations[SPAnimation.ID.Basic_QuickShow]=new Animation(SPAnimation.ID.Basic_QuickShow,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,167,0,1,1,0)]);SPAnimation.g_Animations[SPAnimation.ID.Basic_Fade]=new Animation(SPAnimation.ID.Basic_Fade,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,367,1,0,1,0)]);SPAnimation.g_Animations[SPAnimation.ID.Basic_QuickFade]=new Animation(SPAnimation.ID.Basic_QuickFade,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,167,1,0,1,0)]);SPAnimation.g_Animations[SPAnimation.ID.Basic_Move]=new Animation(SPAnimation.ID.Basic_Move,[new SPKeyFrame(SPAnimation.Attribute.PositionX,3,0,367,null,0,1,1),new SPKeyFrame(SPAnimation.Attribute.PositionY,3,0,367,null,0,1,1)]);SPAnimation.g_Animations[SPAnimation.ID.Basic_Size]=new Animation(SPAnimation.ID.Basic_Size,[new SPKeyFrame(SPAnimation.Attribute.Width,3,0,367,null,0,1,1),new SPKeyFrame(SPAnimation.Attribute.Height,3,0,367,null,0,1,1)]);SPAnimation.g_Animations[SPAnimation.ID.Basic_QuickSize]=new Animation(SPAnimation.ID.Basic_QuickSize,[new SPKeyFrame(SPAnimation.Attribute.Width,3,0,167,null,0,1,1),new SPKeyFrame(SPAnimation.Attribute.Height,3,0,167,null,0,1,1)]);SPAnimation.g_Animations[SPAnimation.ID.Content_SlideInFadeInRight]=new Animation(SPAnimation.ID.Content_SlideInFadeInRight,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,367,0,1,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionX,0,0,1,null,-100,0,1),new SPKeyFrame(SPAnimation.Attribute.PositionX,3,1,367,null,0,0,1)]);SPAnimation.g_Animations[SPAnimation.ID.Content_SlideInFadeInRightInc]=new Animation(SPAnimation.ID.Content_SlideInFadeInRightInc,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,367,0,1,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionX,3,0,367,null,100,0,1)]);SPAnimation.g_Animations[SPAnimation.ID.Content_SlideOutFadeOutRight]=new Animation(SPAnimation.ID.Content_SlideOutFadeOutRight,[new SPKeyFrame(SPAnimation.Attribute.Opacity,0,0,1,1,0,1,0)]);SPAnimation.g_Animations[SPAnimation.ID.Content_SlideInFadeInLeft]=new Animation(SPAnimation.ID.Content_SlideInFadeInLeft,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,367,0,1,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionX,0,0,1,null,100,0,1),new SPKeyFrame(SPAnimation.Attribute.PositionX,3,1,367,null,0,0,1)]);SPAnimation.g_Animations[SPAnimation.ID.Content_SlideInFadeInLeftInc]=new Animation(SPAnimation.ID.Content_SlideInFadeInLeftInc,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,367,0,1,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionX,3,0,367,null,-100,0,1)]);SPAnimation.g_Animations[SPAnimation.ID.SmallObject_SlideInFadeInTop]=new Animation(SPAnimation.ID.SmallObject_SlideInFadeInTop,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,167,0,1,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionY,0,0,1,null,-40,0,1),new SPKeyFrame(SPAnimation.Attribute.PositionY,3,1,167,null,0,0,1)]);SPAnimation.g_Animations[SPAnimation.ID.SmallObject_SlideInFadeInLeft]=new Animation(SPAnimation.ID.SmallObject_SlideInFadeInLeft,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,167,0,1,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionX,0,0,1,null,40,0,1),new SPKeyFrame(SPAnimation.Attribute.PositionX,3,1,167,null,0,0,1)]);SPAnimation.g_Animations[SPAnimation.ID.Test_Instant]=new Animation(SPAnimation.ID.Test_Instant,[new SPKeyFrame(SPAnimation.Attribute.PositionX,0,0,367,null,1,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionY,0,0,367,null,1,1,0)]);SPAnimation.g_Animations[SPAnimation.ID.Test_Hold]=new Animation(SPAnimation.ID.Test_Hold,[new SPKeyFrame(SPAnimation.Attribute.PositionX,1,0,367,null,1,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionY,1,0,367,null,1,1,0)]);SPAnimation.g_Animations[SPAnimation.ID.Basic_Opacity]=new Animation(SPAnimation.ID.Basic_Opacity,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,367,null,1,1,0)]);SPAnimation.g_Animations[SPAnimation.ID.Content_SlideInFadeInGeneric]=new Animation(SPAnimation.ID.Content_SlideInFadeInGeneric,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,367,0,1,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionX,3,0,367,null,1,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionY,3,0,367,null,1,1,0)]);SPAnimation.g_Animations[SPAnimation.ID.Basic_StrikeThrough]=new Animation(SPAnimation.ID.Basic_StrikeThrough,[new SPKeyFrame(SPAnimation.Attribute.Width,3,0,167,null,0,1,1)]);SPAnimation.g_Animations[SPAnimation.ID.SmallObject_SlideInFadeInBottom]=new Animation(SPAnimation.ID.SmallObject_SlideInFadeInBottom,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,167,0,1,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionY,0,0,1,null,40,0,1),new SPKeyFrame(SPAnimation.Attribute.PositionY,3,1,167,null,0,0,1)]);SPAnimation.g_Animations[SPAnimation.ID.SmallObject_SlideOutFadeOutBottom]=new Animation(SPAnimation.ID.SmallObject_SlideOutFadeOutBottom,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,167,1,0,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionY,0,0,1,null,0,0,1),new SPKeyFrame(SPAnimation.Attribute.PositionY,3,1,167,null,40,0,1)]);SPAnimation.g_AnimationEngine=function(){return null}();SPAnimation.Logging=window.location.search.indexOf("AnimationLogging=1")!=-1;SPAnimation.g_AnimationWSA=null;SPAnimation.DATAID_SPANIMATION=9423;SPAnimation.g_AnimationThrottleCutoffFPS=11;SPAnimation.g_AnimationThrottleNumInstance=3;!IsNullOrUndefined(window.sessionStorage)&&IsNullOrUndefined(window.sessionStorage.SPAnimationEnabled)&&TrySetProperty(window.sessionStorage,"SPAnimationEnabled",1);!IsNullOrUndefined(window.localStorage)&&IsNullOrUndefined(window.localStorage.SPAnimationEnabled)&&TrySetProperty(window.localStorage,"SPAnimationEnabled",1);SPAnimation.Settings={};SPAnimation.Settings.EnableAnimation=SPAnimation.Settings.DisableAnimation=function(){TrySetProperty(window.localStorage,"SPAnimationEnabled",0);typeof UpdateAnimationUserControl!="undefined"&&UpdateAnimationUserControl(false)};SPAnimation.Settings.DisableSessionAnimation=SPAnimation.Settings.IsAnimationEnabled=UpdateAnimationStateFromQuery();SPAnimation.State=SPAnimation_State;SPAnimation.Object=SPAnimation_Object;AnimationEngine.prototype={AnimationQueue:new Array(0),sharedTimer:null,sharedCancelTimer:null,frameInterval:1e3/60,resetInterval:3e4,sharedTimerRefs:0,conflictTable:new Array(0),currentAnimationIndex:-1,temporaryIDGenerator:0};AnimationEngine.prototype.LocalStepper=function(){SPAnimation.g_AnimationEngine.StepAllAnimations()};AnimationEngine.prototype.LocalStopper=function(){SPAnimation.g_AnimationEngine.StopEngine()};AnimationEngine.prototype.StartEngine=AnimationEngine.prototype.StopEngine=AnimationEngine.prototype.StartAnimation=function(a){this.AnimationQueue[this.sharedTimerRefs++]=a};AnimationEngine.prototype.StopAnimation=AnimationEngine.prototype.StepAllAnimations=AnimationEngine.prototype.CheckForConflictingAnimations=AnimationEngine.prototype.RemoveTemporaryIds=SPAnimation_State.prototype={Index:0,Data:new Array(0)};SPAnimation_State.prototype.SetAttribute=SPAnimation_State.prototype.GetAttribute=SPAnimation_State.prototype.GetDataIndex=SPAnimation_Object.prototype={animationID:-1,delay:0,element:null,finalState:null,finishFunc:null,extraData:null,arrAnimationUnits:null,idxAnimUnit:0};SPAnimation_Object.prototype.Initialize=SPAnimation_Object.prototype.RunAnimation=SPAnimation_Object.prototype.ValidateParametersForAnimation=SPAnimation_Object.prototype.AdvanceToFinalState=SPAnimation_Object.prototype.GenerateAnimationUnits=SPAnimation_Object.prototype.FindMatchingAnimationUnit=SPAnimation_Object.prototype.GetFinalValue=AnimationUnit.prototype={element:null,delay:0,duration:0,startValue:null,perElementStartValue:null,targetValue:null,curveID:null,finishFunc:null,extraData:null,startTime:null,fIsExecuting:false};AnimationUnit.prototype.Initialize=AnimationUnit.prototype.StartAnimation=AnimationUnit.prototype.StopAnimation=AnimationUnit.prototype.StepAnimation=AnimationUnit.prototype.PositionFunction=AnimationUnit.prototype.SetStyle=AnimationUnit.prototype.StyleLeftSetter=AnimationUnit.prototype.StyleTopSetter=function(a,b){a.style.top=String(b)+"px";SPAnimation.Logging&&SPAnimation.g_TelemetryObject.LogData("element: "+a.id+", top: "+String(a.style.top)+", timestamp: "+String(Number(new Date)))};AnimationUnit.prototype.StyleHeightSetter=function(a,b){a.style.height=String(b)+"px";SPAnimation.Logging&&SPAnimation.g_TelemetryObject.LogData("element: "+a.id+", height: "+String(a.style.height)+", timestamp: "+String(Number(new Date)))};AnimationUnit.prototype.StyleWidthSetter=AnimationUnit.prototype.StyleOpacitySetter=AnimationTelemetry.prototype={perfData:null,logData:null,perfDataIndex:0,logDataIndex:0,animationIndex:0,startTime:null,duration:null,numUnits:0};AnimationTelemetry.prototype.Start=AnimationTelemetry.prototype.Stop=AnimationTelemetry.prototype.AddPerfData=function(a){this.perfData[this.perfDataIndex++]=a};AnimationTelemetry.prototype.LogData=AnimationTelemetry.prototype.CalculateStatistics=AnimationTelemetry.prototype.CalculateAndShowStatistics=AnimationTelemetry.prototype.ShowAnimationStats=SPAnimation.g_TelemetryObject=new AnimationTelemetry;SPAnimation.g_LastAnimationTelemetryData=null;SPAnimationUtility={};SPAnimationUtility.BasicAnimator={};SPAnimationUtility.BasicAnimator.FadeIn=SPAnimationUtility.BasicAnimator.FadeOut=SPAnimationUtility.BasicAnimator.Move=SPAnimationUtility.BasicAnimator.StrikeThrough=SPAnimationUtility.BasicAnimator.PositionAbsolute=SPAnimationUtility.BasicAnimator.PositionRelative=SPAnimationUtility.BasicAnimator.PositionAbsoluteExact=function(a,e,d,b,c){if(a==null)return;a.style.position="absolute";SPAnimationUtility.BasicAnimator.PositionElement(a,e,d,b,c)};SPAnimationUtility.BasicAnimator.PositionRelativeExact=SPAnimationUtility.BasicAnimator.ResetPosition=SPAnimationUtility.BasicAnimator.GetLeftOffset=function(a){if(a==null)return 0;var b=a.offsetLeft;while(a.offsetParent!=null){a=a.offsetParent;if(SPAnimationUtility.BasicAnimator.IsPositioned(a)&&!(browseris.firefox&&a.tagName.toUpperCase()=="TD"))break;b+=a.offsetLeft}return b};SPAnimationUtility.BasicAnimator.GetTopOffset=SPAnimationUtility.BasicAnimator.IsPositioned=SPAnimationUtility.BasicAnimator.GetDefaultCloneId=SPAnimationUtility.BasicAnimator.CloneElement=SPAnimationUtility.BasicAnimator.CommonResize=SPAnimationUtility.BasicAnimator.Resize=function(d,b,c,a,e){SPAnimationUtility.BasicAnimator.CommonResize(d,b,c,a,e,SPAnimation.ID.Basic_Size)};SPAnimationUtility.BasicAnimator.QuickResize=SPAnimationUtility.BasicAnimator.ResizeContainerAndFillContent=SPAnimationUtility.BasicAnimator.GetRightOffset=SPAnimationUtility.BasicAnimator.PositionElement=SPAnimationUtility.BasicAnimator.GetWindowScrollPosition=SPAnimationUtility.RowAddInfo=function(){};SPAnimationUtility.RowMoveInfo=function(){};SPAnimationUtility.TableAnimator=SPAnimUtil_TableAnimator;SPAnimUtil_TableAnimator.prototype={tableElement:null,tbody:null,headerRow:null,footer:null,fAnimatable:false,topOffset:0,leftOffset:0,headerRowHeight:0,itemRowHeight:0,headerColWidths:null,itemColWidths:null};SPAnimUtil_TableAnimator.prototype.AnimatePaging=SPAnimUtil_TableAnimator.prototype.ResetPagingAnimation=SPAnimUtil_TableAnimator.prototype.AnimateSort=SPAnimUtil_TableAnimator.prototype.PrepareForSortAnimation=SPAnimUtil_TableAnimator.prototype.AnimateFooter=SPAnimUtil_TableAnimator.prototype.Initialize=SPAnimUtil_TableAnimator.prototype.GetTableBody=SPAnimUtil_TableAnimator.prototype.GetColumnWidths=SPAnimUtil_TableAnimator.prototype.IncrementRefCount=SPAnimUtil_TableAnimator.prototype.DecrementRefCount=SPAnimUtil_TableAnimator.prototype.IsErrorRow=IsMenuShown=false;ChevronContainer=null;itemTableDeferred=null;imageCell=null;onKeyPress=false;downArrowText=null;currentEditMenu=null;currentItemID=null;currentItemAppName=null;currentItemProgId=null;currentItemIcon=null;currentItemOpenControl=null;currentItemOpenApp=null;currentItemFileUrl=null;currentItemFSObjType=null;currentItemContentTypeId=null;currentItemCheckedOutUserId=null;currentItemCheckoutExpires=null;currentItemModerationStatus=null;currentItemUIString=null;currentItemCheckedoutToLocal=null;bIsCheckout=0;currentItemCanModify=null;currentItemPermMaskH=null;currentItemPermMaskL=null;currentItemEvtType=0;currentItemIsEventsExcp=null;currentItemIsEventsDeletedExcp=null;currentItemIsMountPoint=null;g_MaximumSelectedItemsAllowed=100;g_CustomActionDialogHandlers={};g_CustomActionDialogHandlerId=0;g_ExpGroupWPState=new LRUCache;DocOpen={CLIENT:0,BROWSER:1};hoverTR=null;ecbTD=null;ProtocolCommand={View:"ofv",Edit:"ofe",New:"nft"};phManager=new function(){var a=false,c=false,b={};this.ShouldTryProtocolHandler=this.Win7IE11=function(){return navigator.appVersion.indexOf("Windows NT 6.1")!=-1&&browseris.ie11};this.SetProtocolHandlerEnabled=this.LaunchProtocolHandler=this.LaunchProtocolHandlerInIFrame=this.IsProtocolHandlerEnabled=function(c,d){if(IsStrNullOrEmpty(c))return false;if(!(window.OffSwitch==null||OffSwitch.IsActive("2F09EDF7-17CB-4BF0-928D-465B32D19A78"))){if((browseris.ie10standardUp||browseris.msEdge)&&typeof navigator.msLaunchUri=="undefined"&&c!=="ms-project"&&!this.Win7IE11())return false}else if((browseris.ie10standardUp||browseris.msEdge)&&typeof navigator.msLaunchUri=="undefined"&&c!=="ms-project")return false;if(b[c]!=null)return b[c];if((IsSupportedChromeOnWin()||IsSupportedFirefoxOnWin())&&c==="ms-project")a=true;if(c==="ms-project"){if(typeof navigator.msLaunchUri=="function"){a=true;return a}if(!(window.OffSwitch==null||OffSwitch.IsActive("6DF1B085-52FA-45FD-AC15-960C7819882F"))&&this.Win7IE11())a=true}if(Boolean(window.ActiveXObject))try{if(c==="ms-project")var f=new ActiveXObject("WinProj.Activator");else var g=new ActiveXObject("SharePoint.OpenDocuments.5");a=true}catch(h){}else if(IsSupportedNPApiBrowserOnWin()){var e=CreateNPApiOnWindowsPlugin("application/x-sharepoint");if(e!=null)try{if(e.GetOfficeVersion()=="15")a=true}catch(h){}else if(browseris.chrome&&!d)a=true}else if(!(window.OffSwitch==null||OffSwitch.IsActive("2F09EDF7-17CB-4BF0-928D-465B32D19A78"))){if((browseris.safari||browseris.ie11)&&!d)a=true}else if(browseris.safari&&!d)a=true;return a};this.CreateProtocolHandlerUrl=function(d,i,f,j,h){var a=[],g=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(54)&&!(window.OffSwitch==null||OffSwitch.IsActive("25DBBCF7-9D48-4530-B3AC-14FC12FC66F0")),e=g&&h,b=d.split("|");if(b.length==2){a.push(b[0]);a.push(":");a.push(i);return a.join("")}else if(b.length==3)d=b[0];a.push(d);a.push(":");a.push(f);!(window.OffSwitch==null||OffSwitch.IsActive("423DCB15-E0B1-485E-9D9C-89DD8488B184"))&&Boolean(_spPageContextInfo)&&Boolean(_spPageContextInfo.isSPO)&&d==="ms-excel"&&f!=ProtocolCommand.New&&a.push(e?"%7Cofc":"|ofc");a.push(e?"%7Cu%7C":"|u|");a.push(i);if(f==ProtocolCommand.New){a.push(e?"%7Cs%7C":"|s|");a.push(j)}var c=a.join("");return g?h?c:Encoding.EncodePath(c,true):browseris.mac&&browseris.chrome?encodeURI(c):c}};CBSelectedValues_InitializePrototype();g_ExtensionNotSupportCheckoutToLocal=["ascx","asp","aspx","htm","html","master","odc","exe","bat","com","cmd","onetoc2"];g_ExtensionDefaultForRead=["jpg","jpeg","bmp","png","gif","onetoc2","one","odc"];bValidSearchTerm=false;fListControl=false;fListErrorShown=false;fNewDoc=false;fNewDoc2=false;fNewDoc3=false;SPDesignerDownloadUrl="http://o15.officeredir.microsoft.com/r/rlidSPD2013Download";SPDesignerProgID="SharePoint.WebPartPage.Document";CtxRgiid_InitializePrototype();g_varSkipRefreshOnFocus=0;g_useDialogAlwaysList=["upload.aspx","uploadex.aspx","deploydeveloperapp.aspx"];DocType={Invalid:0,Word:1,Excel:2,PowerPoint:3,Visio:8};LRUCache_InitializePrototype();v_stsOpenDoc=null;v_strStsOpenDoc=null;_lightboxImageExtensions=["GIF","JPG","JPEG","JPE","JFIF","BMP","DIB","PNG","TIF","TIFF","ICO","WDP","HDP"];_lightboxVideoExtensions=["WMV","WMA","AVI","MPG","MP4","ASF","OGG","OGV","OGA","WEBM"];g_AdditionalNavigateHierarchyQString="";httpFolderTarget=null;httpFolderSource=null;httpFolderDiv=null;IframeWorker=g_onRefreshCommandUIHandlers=[];previousClickedItemRow=null;Point.prototype={x:undefined,y:undefined,toString:;isdlg=ajaxNavigate.get_search().match(new RegExp("[?&]IsDlg=1"));if(_spBodyOnLoadFunctionNames!=null&&typeof _spBodyOnLoadFunctionNames!="undefined"){_spBodyOnLoadFunctionNames.push("SearchOnBodyLoad");_spBodyOnLoadFunctionNames.push("LoadGroupAndSiteLinkingBanners")}preventResizeHandler=false;if(typeof g_PreventResizeHandler!=="undefined"&&g_PreventResizeHandler!==null)preventResizeHandler=Boolean(g_PreventResizeHandler);isdlg==null&&!preventResizeHandler&&SetEvent("resize",FixRibbonAndWorkspaceDimensionsForResize,window);g_listItemCache={};g_fSkipAnimation=false;g_fSkipNextTabExpandAnimation=false;_searchClickLogTerm="";_searchClickLogSeq=0;_updateInterval=30*1e3*60;g_NotificationEngine=null;g_notiExpireTimerId=-1;g_standardNotiCt=null;g_statusNotiCt=null;SPNotifications={};SPNotifications.ContainerID={Basic:0,Status:1};g_SPNotificationEventID_Count=5;SPNotifications.EventID={OnShow:0,OnHide:1,OnDisplayNotification:2,OnRemoveNotification:3,OnNotificationCountChanged:4,OnDisposing:5};SP.UI.Notify={};SP.UI.Notify.Notification=SPNotification;SP.UI.Notify.NotificationContainer=SPNotificationContainer;SP.UI.Notify.addNotification=SP.UI.Notify.removeNotification=function(a){removeNotification(a)};SP.UI.Notify.showLoadingNotification=NotificationEngine.prototype={Initialized:false,Notifications:undefined,Containers:undefined,Initialize:undefined,AddNotification:undefined,AddContainer:undefined,DisposeNotification:undefined,SetExpireTimer:undefined,RetireNotificationInternal:undefined};(function(){var d=null,b=-1;NotificationEngine.prototype.Initialize=NotificationEngine.prototype.Reset=NotificationEngine.prototype.AddNotification=NotificationEngine.prototype.AddContainer=NotificationEngine.prototype.DisposeNotification=NotificationEngine.prototype.SetExpireTimer=NotificationEngine.prototype.RetireNotificationInternal=SPNotification.prototype={id:undefined,elm:undefined,strHtml:undefined,strTooltip:undefined,bSticky:undefined,bIsAdd:undefined,bNoAnimate:undefined,bHidden:undefined,onclickHandler:undefined,container:undefined,extraData:undefined,expires:undefined,ariaLiveAttribute:undefined};SPNotification.prototype.Initialize=SPNotification.prototype.Show=function(a){if(Boolean(a)==true)this.bNoAnimate=true;this.container.AddNotification(this)};SPNotification.prototype.Hide=SPNotificationContainer.prototype={id:undefined,element:undefined,bIsShown:undefined,bIsBlocked:undefined,nDisposalState:undefined,nNotificationLayer:25,nDisplayDuration:7e3,nMaxNotifications:20,events:undefined,items:undefined,pending:undefined,blockedUpdates:undefined};SPNotificationContainer.prototype.Initialize=SPNotificationContainer.prototype.Dispose=SPNotificationContainer.prototype.AddNotification=SPNotificationContainer.prototype.RemoveNotification=SPNotificationContainer.prototype.ShowAllNotifications=SPNotificationContainer.prototype.Update=SPNotificationContainer.prototype.Clear=SPNotificationContainer.prototype.GetCount=SPNotificationContainer.prototype.GetHiddenCount=SPNotificationContainer.prototype.SetEventHandler=SPNotificationContainer.prototype.FireEvent=SPNotificationContainer.prototype.Show=SPNotificationContainer.prototype.Hide=SPNotificationContainer.prototype.BlockUpdatesInternal=SPNotificationContainer.prototype.UnblockUpdatesInternal=var e=function(b,i){var a=b.elm,e=b.onclickHandler,f=b.strTooltip,h=b.bNoAnimate,g=a.className="ms-trcnoti-base";!b.bNoAnimate&&SetOpacity(a,0);var c=document.createElement("div");c.className="ms-trcnoti-bg";AttachEvent("click",g,c);var d=document.createElement("div");d.className=i;c.appendChild(d);a.appendChild(c);if(Boolean(f))a.title=f;a.setAttribute("role","alert");return d},c=tion h(){var f=i(),q=f.ctr,d=f.root,b=f.ovrflw,g=f.host,a=new SPNotificationContainer(SPNotifications.ContainerID.Status,g,75,3);ar h=function(h){var q=e(h,"ms-trcnoti-status"),m=h.strHtml,b=h.extraData,k=document.createElement("div"),f=document.createElement("div"),a=document.createElement("div");f.className="ms-trcnoti-body";k.className="ms-trcnoti-gfx";a.className="ms-trcnoti-txt ms-core-defaultFont ms-trc-noti-title";if(b.img!=null){var i=document.createElement("img");i.src=b.img;if(browseris.ie){i.removeAttribute("width");i.removeAttribute("height")}k.appendChild(i)}if(b.sip!=null)if(browseris.ie5up){var p=j(h.id,m,b.sip);a.appendChild(p);for(var g=p.getElementsByTagName("img"),d=0,r=g.length;d<r;d++)g[d].name=="imnmark"&&IMNRC(g[d].getAttribute("sip"),g[d])}else{var o=document.createElement("span");o.innerHTML=m;a.insertBefore(o,a.firstChild)}else{var l=document.createElement("span");l.className="ms-core-defaultFont ms-textLarge";l.innerHTML=m;a.appendChild(l)}a.appendChild(document.createTextNode(" "));var n=document.createElement("span");n.className="ms-textSmall";n.innerHTML=b.txt;a.appendChild(n);f.appendChild(a);if(b.dt!=null){var c=document.createElement("div");c.className="ms-trcnoti-dt ms-metadata";c.style.whiteSpace="normal";if(browseris.ie)c.style.paddingBottom="1px";c.innerHTML=b.dt;f.appendChild(c)}q.appendChild(k);q.appendChild(f)},p=function(b){if(IsAccessibilityFeatureEnabled())b();else{var a=new SPAnimation.State;a.SetAttribute(SPAnimation.Attribute.Opacity,1);d.style.top="0px";var c=new SPAnimation.Object(SPAnimation.ID.SmallObject_SlideInFadeInTop,0,d,a,b,null);c.RunAnimation()}d.style.display="block"},o=l=n=k=m=a.SetEventHandler(SPNotifications.EventID.OnShow,p);a.SetEventHandler(SPNotifications.EventID.OnHide,o);a.SetEventHandler(SPNotifications.EventID.OnDisplayNotification,l);a.SetEventHandler(SPNotifications.EventID.OnRemoveNotification,n);a.SetEventHandler(SPNotifications.EventID.OnNotificationCountChanged,k);a.SetEventHandler(SPNotifications.EventID.OnDisposing,m);g_statusNotiCt=a}addNotification=removeNotification=otificationEngine.GetInstance=a})();cGCMinimumWidth=400;cGCMinimumHeight=200;cGCMaxGCResizeCount=10;glGCObjectHeight=0;glGCObjectWidth=0;glGCResizeCounter=0;objGCGlobal=null;checkNewEcbFlights(null);WSS_MENUITEMSEQUENCE_REPLY=100;WSS_MENUITEMSEQUENCE_VIEWPROPERTIES=200;WSS_MENUITEMSEQUENCE_EDITPROPERTIES=220;WSS_MENUITEMSEQUENCE_EDITSERIESITEM=230;WSS_MENUITEMSEQUENCE_EDITINOIS=260;WSS_MENUITEMSEQUENCE_EDITINAPPLICATION=260;WSS_MENUITEMSEQUENCE_OPENFOLDER=270;WSS_MENUITEMSEQUENCE_CHECKINCHECKOUT=300;WSS_MENUITEMSEQUENCE_DISCARDCHECKOU=310;WSS_MENUITEMSEQUENCE_PUBLISHITEM=320;WSS_MENUITEMSEQUENCE_CANCELPUBLISH=330;WSS_MENUITEMSEQUENCE_EXPORTCONTACT=350;WSS_MENUITEMSEQUENCE_SENDMENU=400;WSS_MENUITEMSEQUENCE_GOTOSOURCEITEM=440;WSS_MENUITEMSEQUENCE_DOCTRANMENU=500;WSS_MENUITEMSEQUENCE_DOWNLOADORIGINAL=550;WSS_MENUITEMSEQUENCE_VERSIONS=800;WSS_MENUITEMSEQUENCE_MODERATEITEM=850;WSS_MENUITEMSEQUENCE_WORKFLOWS=900;WSS_MENUITEMSEQUENCE_ADDTOMYLINKS=1e3;WSS_MENUITEMSEQUENCE_ADDTOCATEGORY=1050;WSS_MENUITEMSEQUENCE_SUBSCRIBE=1100;WSS_MENUITEMSEQUENCE_DISCUSS=1130;WSS_MENUITEMSEQUENCE_PUBLISHBACK=1140;WSS_MENUITEMSEQUENCE_CREATEDWS=1140;WSS_MENUITEMSEQUENCE_MANAGEPERMISSIONS=1160;WSS_MENUITEMSEQUENCE_CUSTOMIZENEWBUTTON=1170;WSS_MENUITEMSEQUENCE_DELETEITEM=1180;WSS_MENUITEMSEQUENCE_DELETEDOCITEM=1190;WSS_MENUITEMSEQUENCE_MOVECOPYITEM=1200;WSS_MENUITEMSEQUENCE_ACTIVATESOLUTION=1210;WSS_MENUITEMSEQUENCE_DEACTIVATESOLUTION=1220;WSS_MENUITEMSEQUENCE_UPGRADESOLUTION=1230;WSS_MENUITEMSEQUENCE_ENCRYPTITEM=1240;setNewEcbCmdSequence();g_menuLaunchPoint=null;ecbManager={callOutPar:null,DismissECB:;ecbItems="ECBItems";SYSTEM_ACCOUNT_ID=1073741823;_ContextForShowingShareDialog=null;resetItemGlobals();seqCompare=_spBodyOnLoadFunctions.push(InitFullScreenMode);filterTable=null;bIsFilterMenuShown=false;bIsFilterDataLoaded=false;filterImageCell=null;currentFilterMenu=null;loadingFilterMenu=null;ctxFilter=null;bIsFilterKeyPress=false;filterStr=null;strFieldName="";bMenuLoadInProgress=false;strFilteredValue=null;bIsMultiFilter=false;fnOnFilterMouseOut=null;if(typeof String.prototype.trim=="undefined")String.prototype.trim=if(typeof Object.create==="undefined")Object.create=if(typeof Object.keys==="undefined")Object.keys=RibbonBlock.prototype={initialTabId:null,buildMinimized:true,initStarted:false,initialTabSelectedByUser:false,launchedByKeyboard:false};kfnDisableEvent=new Function("return false");g_menuHtc_lastMenu=null;g_uniqueNumber=0;g_MenuEndOfDOM=false;ElementPosition_InitializePrototype();MenuTag_InitializePrototype();MMU_chDelim=",";MMU_chDelimEnc="%2c";MMU_postbackPrefix="javascript:__doPostBack(";MMU_chDelim2="%";MMU_chDelim2Enc="%25";MHash_InitializePrototype();ParseContext_InitializePrototype();MMU_reDelimEnc=new RegExp(MMU_chDelimEnc,"g");MMU_reDelim2Enc=new RegExp(MMU_chDelim2Enc,"g");MMU_reDelimDec=new RegExp(MMU_chDelim,"g");MMU_reDelim2Dec=new RegExp(MMU_chDelim2,"g");g_MMU_HighlightedEcbTable=null;g_MMU_HighlightedEcbTableOpen=null;g_MMU_OpenTimeoutHandle=null;g_MMU_theFormActionAtPageLoad=null;g_MMU_Form0ActionAtPageLoad=null;g_MMU_Form0ActionAtPreMenuOpen=null;g_MMU_RequestTimeoutTimeoutHandle=null;_AddSilverlightWebPartPopupUI_InitializePrototype();_ConfigSilverlightWebpartPopupUI_InitializePrototype();_launchNotificationId=null;_tenantAppData=null;if(typeof Accessibility=="undefined"){Accessibility={__namespace:true};Accessibility_module_def()}if(typeof DOM_afterglass=="undefined"){DOM_afterglass={__namespace:true};DOM_afterglass_module_def()}GetAncestor=DOM_afterglass.GetAncestor;GetAncestorByTagNames=DOM_afterglass.GetAncestorByTagNames;GetParentLinkFromEvent=DOM_afterglass.GetParentLinkFromEvent;GetPosition=DOM_afterglass.GetPosition;GetSelectedElement=DOM_afterglass.GetSelectedElement;IsContained=DOM_afterglass.IsContained;IsEventRightClickOnAnchor=DOM_afterglass.IsEventRightClickOnAnchor;IsEventTargetAnchor=DOM_afterglass.IsEventTargetAnchor;if(typeof ListModule_afterglass=="undefined"){ListModule_afterglass={__namespace:true};ListModule_afterglass_module_def()}_ListHeaderMenu_OnMouseDown=ListModule.Util.headerMenuMouseDown;CountSelectedItems=ListModule.Util.countSelectedItems;CountTotalItems=ListModule.Util.countTotalItems;CreateAjaxMenu=ListModule.Util.createAjaxMenu;CtxFromElement=ListModule.Util.ctxFromElement;FetchEcbInfo=ListModule.Util.fetchEcbInfo;FindSTSMenuTable=ListModule.Util.findSTSMenuTable;FocusRow=ListModule.Util.focusRow;GetEcbDivFromEcbTd=ListModule.Util.getEcbDivFromEcbTd;GetEcbTdFromRow=ListModule.Util.getEcbTdFromRow;GetItemRowCbx=ListModule.Util.getItemRowCbx;getFilterValueFromUrl=ListModule.Util.getFilterValueFromUrl;GetLastSelectableRowIdx=ListModule.Util.getLastSelectableRowIdx;GetRootFolder=ListModule.Util.getRootFolder;GetRootFolder2=ListModule.Util.getRootFolder2;GetUrlWithNoSortParameters=ListModule.Util.getUrlWithNoSortParameters;GroupNameFromRow=ListModule.Util.groupNameFromRow;GroupStringFromGroupName=ListModule.Util.groupStringFromGroupName;ItemHasiid=ListModule.Util.itemHasIid;ItemIsCurrentlySelected=ListModule.Util.itemIsCurrentlySelected;ItemIsCurrentlyVisible=ListModule.Util.itemIsCurrentlyVisible;ItemIsSelectable=ListModule.Util.itemIsSelectable;OnItemSelectionChanged=ListModule.Util.onItemSelectionChanged;SelectListItem=ListModule.Util.selectListItem;SetFocusOnRowDelayed=ListModule.Util.setFocusOnRowDelayed;ShowECBMenuForTr=ListModule.Util.showEcbMenuForTr;ToggleItemRowSelection2=ListModule.Util.toggleItemRowSelection2;UpdateCtxLastSelectableRow=ListModule.Util.updateCtxLastSelectableRow;UpdateSelectAllCbx=ListModule.Util.updateSelectAllCbx;_OnFocusFilter=ListModule.Util.onFocusFilter;FindCtxImg=ListModule.Util.findCtxImg;ShowCtxImg=ListModule.Util.showCtximg;RemoveCtxImg=ListModule.Util.removeCtxImg;PositionCtxImg=ListModule.Util.positionCtxImg;List_CreateCtxImg_Helper=ListModule.Util.createCtxImg_Helper;FilterFieldV3=ListModule.Util.FilterField;RegisterOnItemSelectionChangedHandler=ListModule.Util.registerOnItemSelectionChangedHandler;UnregisterOnItemSelectionChangedHandler=ListModule.Util.unregisterOnItemSelectionChangedHandler;DocumentType={Invalid:0,Word:1,Excel:2,PowerPoint:3,OneNote:4,ExcelForm:5,Folder:6,SuiteExtensionApp:7,Visio:8,Max:9};DocumentInformation.prototype={type:undefined,idToken:undefined,imgSrc:undefined,imgAlt:undefined,textLabel:undefined};c_newdocWOPIID="js-newdocWOPI-";c_newDocDivHtml=['<a id="{0}" class="ms-newdoc-callout-item ms-displayBlock" onclick="{5}" href="#">','<img id="{1}" src="{2}" alt="{3}" class="ms-verticalAlignMiddle ms-newdoc-callout-img"/>','<h3 id="{4}" class="ms-displayInline ms-newdoc-callout-text ms-verticalAlignMiddle ms-soften">{6}</h3></a>'].join("");c_onClickCreateDoc="CalloutManager.closeAll(); OpenPopUpPageWithTitle(&quot;{0}&TemplateType={1}&quot;, OnCloseDialogNavigate); return false;";c_newDocCalloutWidth=parseInt(typeof Strings!="undefined"?Strings.STS.L_NewDocumentCalloutSize:"");NewDocumentInfo=InitializeNewDocumentInfo();g_lastLaunchPointIIDClicked=null;usedCalloutIDs={};generateUniqueCalloutIDFromBaseID=Callout_OnOpeningCallback=GenerateCtx=(();(();g_FP_nextId=1;c_fpContainerID="DeltaPlaceHolderSearchArea";c_maxFaces=4;ExecuteOrDelayUntilScriptLoaded("core.js");g_ClipboardControl=null;g_IsClipboardControlValid=false;(();typeof NotifyScriptLoadedAndExecuteWaitingJobs=="function"&&NotifyScriptLoadedAndExecuteWaitingJobs("core.js");typeof spWriteProfilerMark=="function"&&spWriteProfilerMark("perfMarkEnd_core.js")}var SPAnimation;nction Animation(a,b){this.ID=a;this.keyFrames=b}nUtility; IsMenuShown,ChevronContainer,itemTableDeferred,imageCell,onKeyPress,downArrowText,currentEditMenu,currentItemID,currentItemAppName,currentItemProgId,currentItemIcon,currentItemOpenControl,currentItemOpenApp,currentItemFileUrl,currentItemFSObjType,currentItemContentTypeId,currentItemCheckedOutUserId,currentItemCheckoutExpires,currentItemModerationStatus,currentItemUIString,currentItemCheckedoutToLocal,bIsCheckout,currentItemCanModify,currentItemPermMaskH,currentItemPermMaskL,currentItemEvtType,currentItemIsEventsExcp,currentItemIsEventsDeletedExcp,currentItemIsMountPoint,g_MaximumSelectedItemsAllowed,g_CustomActionDialogHandlers,g_CustomActionDialogHandlerId,g_ExpGroupWPState,DocOpen,hoverTR,ecbTD;otocolCommand,phManager;function CBSelectedValues(b,a){this.strList=b;this.fAllChecked=a}ar _groupCollapse,bGridViewPresent,_fV4Calendar,_spCustomNavigateHierarchy,g_ExtensionNotSupportCheckoutToLocal,g_ExtensionDefaultForRead,bValidSearchTerm,ListCtrlObj,fListControl,fListErrorShown,fNewDoc,fNewDoc2,fNewDoc3,SPDesignerDownloadUrl,SPDesignerProgID;function CtxRgiid(b,a){this.ctx=b;this.rgiid=a}pRefreshOnFocus;unction RefreshOnFocusForOneRow(){RefreshOnFocus()}ction CallSuiteExtensionControlFactory(a,f,c,d,e){if(IsFileExtensionControlsSupported())if(typeof SuiteExtensions=="object"&&typeof SuiteExtensions.ControlFactory=="function"&&typeof SuiteExtensions.ControlType=="function")if(typeof SuiteExtensions.ControlFactory.CreateControl=="function"&&typeof SuiteExtensions.ControlType.Edit=="number"){var b=SuiteExtensions.ControlFactory.CreateControl(c,SuiteExtensions.ControlType.Edit);if(b!=null){b.httpRoot=d;b.itemUrl=e;b.updateElement(a);if(IsFileHandlerForAllNonOfficeFilesSupported()){a.editHref="";a.removeAttribute("isEdit");a.removeAttribute("App");itemTable=FindSTSMenuTable(a,"CTXName");itemTable!=null&&itemTable.removeAttribute("App")}}}}nction _EnterFolder(c){var b,a,e=new URI(ajaxNavigate.get_href()),f=new URI(c);b=e.getQueryParameter("RootFolder");a=f.getQueryParameter("RootFolder");if(!Boolean(a))a="";if(!Boolean(b))b="";var d=a!=null&&a.length>0&&a.charAt(0)=="/"&&a.length<b.length&&b.indexOf(a)==b.length-a.length;if(!d&&a.toLowerCase()!=b.toLowerCase())Nav.navigate(c);else _SubmitFormPost(c)}unction createMetaNodes(){a=document.createElement("meta");a.name="viewport";a.content="width=device-width, initial-scale=1.0, maximum-scale= 1.0, minimum-scale=1.0, user-scalable=no";document.head.insertBefore(a,document.head.firstChild);var a=document.createElement("meta");a.httpEquiv="X-UA-Compatible";a.content="IE=edge";document.head.insertBefore(a,document.head.firstChild)}function getMarkTime(c){if(Boolean(window.performance)&&Boolean(window.performance.mark&&Boolean(window.performance.now))){var d=window.performance.getEntriesByName(c)[0];return Boolean(d)?Math.round(d.startTime):NaN}else{var a=window._perfMarks,e=NaN;if(Boolean(a)&&a.length>0)for(var b=0;b<a.length;b++)if(a[b].name===c){e=Math.round(a[b].startTime);break}return e}}function mark(b){if(Boolean(window.performance)&&Boolean(window.performance.mark&&Boolean(window.performance.now)))window.performance.mark(b);else{var a;if(window._perfMarks!=undefined)a=window._perfMarks;else a=window._perfMarks=[];a.push({name:b,startTime:Date.now()})}}function RemoveDOMNodes(c){for(var d=c.length,a=0;a<d;a++)try{var b=c[d-a-1],e=b.getAttribute("rel");if(Boolean(e)&&e=="shortcut icon")continue;b.parentNode.removeChild(b)}catch(f){}}function GCBeforeOnePageNavigation(d){var e={};for(var b in window){try{var h=window[b]}catch(i){}if(Boolean(b)&&Boolean(h))e[b]=1}var f=window._initGlobalSnapShot,a,c,g=function(a){return a}();for(a in e){try{c=window[a]}catch(i){}if(c!=null&&"undefined"!=typeof c&&d.modernGlobalWhiteList.indexOf(a)==-1&&d.classicGlobalWhiteList.indexOf(a)==-1&&!Boolean(f[a]))try{window[a]=g;delete window[a]}catch(i){}}}function GCGivenGlobals(d){for(var a,b,e=function(a){return a}(),c=0;c<d.length;c++){a=d[c];try{b=window[a]}catch(f){}if(b!=null&&"undefined"!=typeof b)try{window[a]=e;delete window[a]}catch(f){}}}function getUnique(a){for(var b=0;b<a.length;++b)for(var c=b+1;c<a.length;++c)a[b]===a[c]&&a.splice(c--,1);return a}function clearEventHandlers(){window.removeEventListener(null,null,false);document.removeEventListener(null,null,false);$clearHandlers(document.head);$clearHandlers(document.body);$clearHandlers(document);$clearHandlers(window);clearOnEvents(window);clearOnEvents(document);clearOnEvents(document.head);clearOnEvents(document.body);var a=document.body,b=a.cloneNode(true);a.parentNode.replaceChild(b,a);OnePageUtil.undoOverrideEventListenerFunctions(document);OnePageUtil.undoOverrideEventListenerFunctions(window)}function clearOnEvents(c){for(var d="onabort,onanimationend,onanimationiteration,onanimationstart,onauxclick,onbeforeunload,onblur,oncancel,oncanplay,oncanplaythrough,onchange,onclick,onclose,oncontextmenu,oncuechange,ondblclick,ondevicemotion,ondeviceorientation,ondeviceorientationabsolute,ondrag,ondragend,ondragenter,ondragleave,ondragover,ondragstart,ondrop,ondurationchange,onemptied,onended,onerror,onfocus,ongotpointercapture,onhashchange,oninput,oninvalid,onkeydown,onkeypress,onkeyup,onlanguagechange,onload,onloadFuncts,onloadeddata,onloadedmetadata,onloadstart,onlostpointercapture,onmessage,onmousedown,onmouseenter,onmouseleave,onmousemove,onmouseout,onmouseover,onmouseup,onmousewheel,onoffline,ononline,onpagehide,onpageshow,onpause,onplay,onplaying,onpointercancel,onpointerdown,onpointerenter,onpointerleave,onpointermove,onpointerout,onpointerover,onpointerup,onpopstate,onprogress,onratechange,onrejectionhandled,onreset,onresize,onscroll,onsearch,onseeked,onseeking,onselect,onshow,onstalled,onstorage,onsubmit,onsuspend,ontimeupdate,ontoggle,ontransitionend,onunhandledrejection,onunload,onvolumechange,onwaiting",b=d.split(","),a=0;a<b.length;a++)c[b[a]]=null}function displayPageContent(b,a){if(b){if(Boolean(a.hidden))document.body.style.visibility="";a.hidden=false}else if(typeof a.hidden==="undefined"){document.body.style.visibility="hidden";a.hidden=true}}function clearAllDOMElements(a){var f=Boolean(a.headNodesBeforeOnePageNavigation)?[].slice.call(a.headNodesBeforeOnePageNavigation):[],d=!(window.OffSwitch==null||OffSwitch.IsActive("C0517CC9-59C8-4969-BED4-F04A225E63BD"))?document.querySelectorAll("style:not([data-glamor]):not([data-merge-styles])"):document.querySelectorAll("style:not([data-glamor])"),h=d.length>0?[].slice.call(d):[],i=document.getElementsByTagName("link").length>0?[].slice.call(document.getElementsByTagName("link")):[],c=document.head.querySelectorAll("head>script[src^='/_layouts']"),e=Boolean(c)?[].slice.call(c):[],g=getUnique([].concat.apply([],[f,h,i,e]));RemoveDOMNodes(g);var b=a.bodyNodesBeforeOnePageNavigation;Boolean(b)&&RemoveDOMNodes([].slice.call(b))}function clearBodyDOMElements(){var a=document.body.childNodes.length>0?[].slice.call(document.body.childNodes):[];a.length>0&&RemoveDOMNodes(a)}function prefetchCallback(f,l,k,i){var b=true,c={};try{if(f==200){mark("EUPL.OnePage.Prefetch.End");var d=undefined,a=JSON.parse(l),g=undefined;if(Boolean(a)){var e=Boolean(a.NewExperienceRendering);if(Boolean(a.ViewMetadata)){g=a.ViewMetadata.Id;b=!e;c={shouldRenderNewExperience:e};if(e){var j=Boolean(a.ShouldLoadSPFramework),h=false;if(!(window.OffSwitch==null||OffSwitch.IsActive("F52E56BE-2E96-4537-A67A-D74BFB99BD7D")))h=Boolean(a.SPFrameworkClientInfo);b=b||j&&!h;c.ShouldLoadSPFramework=j}}d=JSON.parse(a.PageContextInfo);if(Boolean(g))d.viewId=g}if(!b){displayPageContent(true,i);window._spPageContextInfo=d;k(d);SP.QoS.WriteSuccess("ClassicToModernOnePageNavigation_Success")}}else{SP.QoS.WriteFailure("ClassicToModernOnePageNavigation_FailureHttpStatus",{prefetchStatus:f});c["prefetch failure"]=f}}catch(m){SP.QoS.WriteFailure("ClassicToModernOnePageNavigation_FailureException",{exception:m.toString()});c.exception=m.toString()}b&&fallbackToNormalNavigation(i.fallbackUrl,c)}function fixUpBrowserLocation(a){if(Boolean(window.history)&&Boolean(window.history.pushState)&&Boolean(window.history.replaceState)){window.history.replaceState({onepageInfo:"ClassicPageBeforeNavigatingToModernPage",originalNavUrl:a.fallbackUrl},"ClassicPageBeforeNavigatingToModernPage",window.location.href);window.history.pushState({onepageInfo:"ModernPageFromClassicPage"},"ModernPageFromClassicPage",a.newBrowserLocation)}else fallbackToNormalNavigation(a.fallbackUrl,{"window.history":Boolean(window.history)})}function fallbackToNormalNavigation(a,b){!(window.OffSwitch==null||OffSwitch.IsActive("188171B9-48EC-444E-8568-A969320EA694"))&&clearBodyDOMElements();SP.QoS.WriteUserEngagement("ClassicToModernOnePageNavigation_FallbackToNormalNavigation",{reason:b,location:Boolean(a)?a.split("/"):undefined});if(Boolean(a))window.location.href=a}function applyStylesForOnePageNavigation(a){var b=window.__themeState__;b.registeredStyles=[];mark("before require theme code");require([mapModuleName("@microsoft/load-themed-styles",a)],function(e){var c=a.resolvedToBeRegisteredStyles;b.loadStyles=undefined;if(Boolean(c)&&c.length>0){for(var d=0;d<c.length;d++)e.loadStyles(c[d]);a.resolvedToBeRegisteredStyles=undefined}},function(b){fallbackToNormalNavigation(a.fallbackUrl,{"requre error":b})})}function applyStylesAndBoot(a){var b=window.__themeState__;b.registeredStyles=[];mark("EUPL.applyStylesAndBoot.Start");require([mapModuleName("@microsoft/load-themed-styles",a)],function(e){var c=a.resolvedToBeRegisteredStyles;b.loadStyles=undefined;if(Boolean(c)&&c.length>0){for(var d=0;d<c.length;d++)e.loadStyles(c[d]);a.resolvedToBeRegisteredStyles=undefined}mark("EUPL.applyStylesAndBoot.StyleApplied");Boolean(a.boot)&&a.boot()},function(b){fallbackToNormalNavigation(a.fallbackUrl,{"requre error":b})})}function clearAsyncTimer(){var a=OnePageUtil.GetTimerManager();a.clearAllIntervals();a.clearAllTimeouts();a.undoOverrideTimer()}function doPrepareWorkBeforeOnePageNav(a){clearAllDOMElements(a);clearEventHandlers();spinnerOnload(a);createMetaNodes();applyStylesForOnePageNavigation(a);GCBeforeOnePageNavigation(a)}function doPrepareWorkBeforeOnePageNavForFasterOnePage(a){clearAllDOMElements(a);displayPageContent(false,a);clearEventHandlers();createMetaNodes();GCBeforeOnePageNavigation(a)}function bootModernApp(a){try{doPrepareWorkBeforeOnePageNavForFasterOnePage(a);applyStylesAndBoot(a)}catch(b){fallbackToNormalNavigation(a.fallbackUrl,{exception:b.toString()})}}function runModernAppPrefetchForFasterOnePage(a){mark("EUPL.OnePage.Prefetch.Start");var b=window._spPageContextInfo;if(Boolean(a.startPrefetch)&&Boolean(a)&&Boolean(a.targetListUrl))a.startPrefetch({inputPageContextInfo:{webAbsoluteUrl:b.webAbsoluteUrl,webTemplate:b.webTemplate,listBaseTemplate:101,listUrl:a.targetListUrl},onePagePrefetchCompleteCallback:);else fallbackToNormalNavigation(a.fallbackUrl,{startPrefetch:Boolean(a.startPrefetch),targetListUrl:Boolean(a.targetListUrl)})}function preloadModernApp(){var a=window.__onePageContext;if(Boolean(a))loadModernAppInternalForFasterOnePage(a);else window.__onePageContextReady=function(a){loadModernAppInternalForFasterOnePage(a)}}function checkRequireJSLoaded(){return typeof require!=="undefined"&&Boolean(require)&&typeof require==="function"&&Boolean(require.version)&&Boolean(require.config)}unction checkLoadThemableStyles(){var a=Boolean(window.__themeState__);a&&SP.QoS.WriteUserEngagement("LoadThemableStyles_Before_OnePage");return!(window.OffSwitch==null||OffSwitch.IsActive("43CD91E9-E92F-4B07-B4CD-078A917FD612"))&&a}function cleanRequireJS(){window["require"]=window.requirejs=window.define=undefined}function cleanFabricGlobals(){if(typeof __globalSettings__!=="undefined")window.__globalSettings__=__globalSettings__=undefined;if(typeof __stylesheet__!=="undefined")window.__stylesheet__=__stylesheet__=undefined}function loadRequireJS(b,c){if(Boolean(b)&&!Boolean(getMarkTime("EUPL.OnePage.LoadRequireJS.Start"))){mark("EUPL.OnePage.LoadRequireJS.Start");cleanRequireJS();var a=document.createElement("script");a.type="text/javascript";a.src=b;a.onload=a.onreadystatechange=function(){if(!Boolean(a.readyState)||/loaded|complete/.test(a.readyState)){mark("EUPL.OnePage.LoadRequireJS.End");checkRequireJSLoaded()&&c();a.onload=a.onreadystatechange=null;a=undefined}};document.head.insertBefore(a,document.head.firstChild)}}function setLoadStylesOverride(a){if(!Boolean(window.__themeState__))window.__themeState__={theme:undefined,lastStyleElement:undefined,registeredStyles:[]};window.__themeState__.loadStyles=function mapModuleName(a,b){var c=a;if(Boolean(b)&&Boolean(b.moduleNameMapping)&&Boolean(a)&&Boolean(b.moduleNameMapping[a]))c=b.moduleNameMapping[a];return c}function loadModernAppInternalForFasterOnePage(a,c){if(c||!checkRequireJSLoaded()&&!checkSPModuleLoader()&&!checkLoadThemableStyles()){var b=function(){setLoadStylesOverride(a);var b=a.requireConfig;if(Boolean(b)&&!Boolean(getMarkTime("EUPL.OnePage.requireConfig.Start"))){mark("EUPL.OnePage.requireConfig.Start");b()}require([mapModuleName("odsp-next/dataSources/item/odb/ListViewDataPrefetch",a)],function(b){a.modernGlobalWhiteList=b.ONEPAGE_GLOABLS;a.startPrefetch=b.startPrefetch;Boolean(a.startPrefetchLoadedCallBack)&&a.startPrefetchLoadedCallBack(a)});require([mapModuleName("odsp-next/SPList",a)],function(b){a.boot=b.SPListBoot;Boolean(a.spListBootLoadedCallBack)&&a.spListBootLoadedCallBack(a)})};loadRequireJS(a.requireJSPath,b)}}function partialFixPageContext(a){_spPageContextInfo.listTitle=undefined;_spPageContextInfo.listid=undefined;_spPageContextInfo.listUrl=a.listUrl;_spPageContextInfo.viewId=SP.Guid.get_empty().toString("B");_spPageContextInfo.serverRedirectedUrl=undefined}function performModernOnePageNavigationForFasterOnePage(c){SP.QoS.WriteStart("ClassicToModernOnePageNavigation_Start");mark("EUPL.OnePageNavigation.Start");var a=window.__onePageContext;if(Boolean(a)){a.fallbackUrl=c.currentTarget.href;var b=GetOnePageNavUrl(c.currentTarget.getAttribute("href"));a.targetListUrl=b.listUrl;a.newBrowserLocation=b.newBrowserLocation;a.classicGlobalWhiteList=a.classicGlobalWhiteList=!(window.OffSwitch==null||OffSwitch.IsActive("B1C4F535-DD03-4C97-B520-F983BBBCBB71"))?["fallbackToNormalNavigation","displayPageContent","SP","BrowserStorage","OnePageUtil","GCGivenGlobals","applyStylesAndBoot","CancelEvent","prefetchCallback","clearBodyDOMElements","RemoveDOMNodes","__stylesheet__","__globalSettings__","mapModuleName","OffSwitch"]:["fallbackToNormalNavigation","displayPageContent","SP","BrowserStorage","OnePageUtil","GCGivenGlobals","applyStylesAndBoot","CancelEvent","prefetchCallback","clearBodyDOMElements","RemoveDOMNodes","__stylesheet__","__globalSettings__"];partialFixPageContext(b);var d=a.requireJSPath;fixUpBrowserLocation(a);clearAsyncTimer();if(Boolean(getMarkTime("EUPL.OnePage.requireConfig.Start"))){if(Boolean(a.startPrefetch))runModernAppPrefetchForFasterOnePage(a);else a.startPrefetchLoadedCallBack=runModernAppPrefetchForFasterOnePage;if(Boolean(a.boot))bootModernApp(a);else a.spListBootLoadedCallBack=bootModernApp}else{a.startPrefetchLoadedCallBack=runModernAppPrefetchForFasterOnePage;a.spListBootLoadedCallBack=bootModernApp;cleanFabricGlobals();loadModernAppInternalForFasterOnePage(a,true)}return CancelEvent(c)}else fallbackToNormalNavigation(a.fallbackUrl,{onePageContext:Boolean(a)});return true}function GetOnePageNavUrl(a){var b=undefined,c=new URI(a),e=a.toLowerCase().indexOf("/forms/"),f=/\/Lists\/.*(\/[^/]*?\.aspx)/i,d=!(window.OffSwitch==null||OffSwitch.IsActive("231319CB-52CC-4B6B-86B7-547665CEB111"))&&f.test(a)?a.match(f)[1]:undefined;if(e>=0)b=a.substring(0,e);else if(Boolean(d)){if(window.OffSwitch==null||OffSwitch.IsActive("CB559CFF-A2D5-4160-968F-176592A88B59")||["/newform.aspx","/editform.aspx","/dispform.aspx"].indexOf(d.toLowerCase())<0)b=a.substring(0,a.indexOf(d))}else if(a.toLowerCase().indexOf(".aspx")==-1)b=a;var g=c.getQueryAsObject(),h=c.getPath();if(Boolean(h))g.viewpath=h;c.setQueryFromObject(g);return{listUrl:Boolean(b)?URI.decodeURIComponent(b.replace(/\/+$/,"")):undefined,newBrowserLocation:c.getString()}}function spinnerOnload(a){window.setTimeout(b,1e3);function b(){var b=document.getElementById("notificationArea");if(Boolean(b))try{b.parentNode.removeChild(b)}catch(e){}b=document.createElement("div");b.id="notificationArea";b.setAttribute("style","min-width: 140px; z-index: 400; position: absolute; right: 16px;");var d='"Segoe UI Light", "Segoe UI", Tahoma, Helvetica, Arial, sans-serif';b.innerHTML="<a onclick='this.style.display=\"none\";'><img src='data:image/gif;base64,R0lGODlhGAAYAJECAP///5mZmf///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFCgACACwAAAAAGAAYAAACQJQvAGgRDI1SyLnI5jr2YUQx10eW5hmeB6Wpkja5SZy6tYzn+g5uMhuzwW6lFtF05CkhxGQm+HKuoDPplOlDFAAAIfkEBQoAAgAsFAAGAAQABAAAAgVUYqeXUgAh+QQFCgACACwUAA4ABAAEAAACBVRip5dSACH5BAUKAAIALA4AFAAEAAQAAAIFVGKnl1IAIfkEBQoAAgAsBgAUAAQABAAAAgVUYqeXUgAh+QQFCgACACwAAA4ABAAEAAACBVRip5dSACH5BAUKAAIALAAABgAEAAQAAAIFVGKnl1IAIfkECQoAAgAsBgAAAAQABAAAAgVUYqeXUgAh+QQJCgACACwAAAAAGAAYAAACJZQvEWgADI1SyLnI5jr2YUQx10eW5omm6sq27gvH8kzX9o3ndAEAIfkECQoAAgAsAAAAABgAGAAAAkCULxFoAAyNUsi5yOY69mFEMddHluYZntyjqY3Vul2yucJo5/rOQ6lLiak0QtSEpvv1lh8l0lQsYqJHaO3gFBQAACH5BAkKAAIALAAAAAAYABgAAAJAlC8RaAAMjVLIucjmOvZhRDHXR5bmGZ7co6mN1bpdsrnCaOf6zkOpzJrYOjHV7Gf09JYlJA0lPBQ/0ym1JsUeCgAh+QQJCgACACwAAAAAGAAYAAACQJQvEWgADI1SyLnI5jr2YUQx10eW5hme3KOpjdW6XbK5wmjn+s5Dqcya2Dox1exn9PSWJeRNSSo+cR/pzOSkHgoAIfkECQoAAgAsAAAAABgAGAAAAkCULxFoAAyNUsi5yOY69mFEMddHluYZntyjqY3Vul2yucJo5/rOQ6nMmtg6MdXsZ/T0liXc6jRbOTHR15SqfEIKACH5BAkKAAIALAAAAAAYABgAAAJAlC8RaAAMjVLIucjmOvZhRDHXR5bmGZ7co6mN1bpdsrnCaOf6zkO4/JgBOz/TrHhC9pYRpNJnqURLwtdT5JFGCgAh+QQJCgACACwAAAAAGAAYAAACPpQvEWgADI1SyLnI5jr2YUQx10eW5jme3NOpTWe5Qpu6tYzn+l558tWywW4lmk/IS6KOr2UtSILOYiYiUVAAADs='></a><span class='ms-accentText' style='font-size: 36px; font-family: "+d+"'>&nbsp;"+(typeof a.workingOnIt!="undefined"?a.workingOnIt:"")+"</span>";document.body.appendChild(b);b=document.getElementById("notificationArea");var c=[].slice.call(b.children).reduce(0);b.style.top=String(window.innerHeight*(1-.618))+"px";b.style.left=String(Math.max(10,(window.innerWidth-c)/2))+"px"}}function spinnerOffload(){var a=document.getElementById("notificationArea");if(Boolean(a))try{a.parentNode.removeChild(a)}catch(b){}}ar g_useDialogAlwaysList; FSupportCheckoutToLocal(a){var c=true;if(a==null||a=="")return false;a=a.toLowerCase();for(var b=0,b=0;b<g_ExtensionNotSupportCheckoutToLocal.length;b++)if(a==g_ExtensionNotSupportCheckoutToLocal[b])return false;return true}unction ShouldCallEncodeURIComponent(){if(!(window.OffSwitch==null||OffSwitch.IsActive("DE16248D-2B09-442A-96A5-F7783DAEF943"))){var a=GetCurrentCtx();return Flighting.VariantConfiguration.IsExpFeatureClientEnabled(54)&&a!=null&&a.IsClientRendering}return false}function CheckoutDocument(b,a){if(a.charAt(0)=="/"||a.substr(0,3).toLowerCase()=="%2f")a=window.location.protocol+"//"+window.location.host+a;if(ShouldCallEncodeURIComponent())a=encodeURIComponent(a);else a=escapeProperly(unescapeProperly(a));var c="FileName="+a+"&Checkout=true";NavigateToCheckinAspx(b,c);return true}function NewOrEditV4Core(g,a,i){var j=g!=null&&EnsureScript("inplview",typeof InitAllClvps,j);var e=a.toUpperCase().indexOf("UPLOAD.ASPX")!=-1||a.toUpperCase().indexOf("UPLOADEX.ASPX")!=-1?true:false;if(e){var f=GetCurrentCtx();if(f!=null&&SupportAjaxFolderNav(f)){var h=new URI(a);h.setQueryParameter("RootFolder",f.rootFolder);a=h.getString()}}var c=typeof IsDragDropSupported!="undefined"&&IsDragDropSupported();if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(61)&&e&&c){if(IsUploadInProgress())return false;var d,b=GetCtxFromFormUrl(a);if(!fIsNullOrUndefined(b)&&!fIsNullOrUndefined(b.wpq))d="WebPart"+b.wpq;if(!fIsNullOrUndefined(d))c=TryPrepUploadDialogToDragDrop(d)}if(i)_OpenPopUpPage(a,RefreshOnDialogClose);else if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(61)&&e&&c)_OpenPopUpPage(a,;else _OpenPopUpPage(a,RefreshPage);return false}unction _NewItem(a){GoToPage(a)}AdjustUrlForRootFolder(c){var a=GetCurrentCtx(),b=new URI(c);if(a!=null&&SupportAjaxFolderNav(a)){b.setQueryParameter("SaveLocation",Boolean(a.rootFolder)?a.rootFolder:a.listUrlDir);return b.getString()}return c}ion _OpenPopUpPage(d,a,c,b){OpenPopUpPageWithTitle(d,a,c,b,null)}unction _GoToCreateNewPage(){SP.QoS.WriteStart("WexGoToCreateNewPage_Start");_SendCreateNewCSRPageAjaxPost(function(a){if(IsXhrAborted(a)){SP.QoS.WriteFailure("WexGoToCreateNewPage_FailureAborted");_OpenDefaultCreateWebPageDialog();return}else if(IsXhrReady(a)&&(a.status<200||a.status>=300)){SP.QoS.WriteFailure("WexGoToCreateNewPage_FailureHttpStatus",{xhrStatus:a.status});_OpenDefaultCreateWebPageDialog();return}else if(IsXhrReady(a)){var b;try{b=JSON.parse(a.responseText)}catch(d){}if(b==null||!b.hasOwnProperty("d")||!b.d.hasOwnProperty("AbsoluteUrl")){SP.QoS.WriteFailure("WexGoToCreateNewPage_FailureInvalidJson",{json:a.responseText,xhrStatus:a.status});_OpenDefaultCreateWebPageDialog();return}var c=b.d.AbsoluteUrl+"?Mode=Edit";SP.QoS.WriteSuccess("WexGoToCreateNewPage_Success");GoToPage(c,true)}});return}function _SendCreateNewCSRPageAjaxPost(b){var c=Nav.combineUrl(_spPageContextInfo.webServerRelativeUrl,"/_api/sitepages/pages?$select=AbsoluteUrl"),d=JSON.stringify({__metadata:{type:"SP.Publishing.SitePage"}}),a=new XMLHttpRequest;a.open("POST",c,true);a.setRequestHeader("Content-type","application/json;odata=verbose");a.setRequestHeader("accept","application/json;odata=verbose");a.setRequestHeader("Connection","Keep-alive");a.setRequestHeader("x-requestdigest",document.forms[MSOWebPartPageFormName].__REQUESTDIGEST.value);a.setRequestHeader("cache-control","no-cache");a.setRequestHeader("DataServiceVersion","3.0");a.onreadystatechange=a.send(d)}function _OpenDefaultCreateWebPageDialog(){_OpenCreateWebPageDialog(GetLayoutsPageUrl(_spPageContextInfo.webServerRelativeUrl,"createwebpage.aspx"))}n _ExportList(a){var b=typeof navigator.msProtocols=="function"&&navigator.msProtocols.excel;!b&&g_ssImporterObj==null&&EnsureSSImporter();if(!b&&g_ssImporterObj==null)(g_fSSImporter||GetCookie("EnsureSSImporter")==null)&&EnsureSSImporter(true);if(IsSupportedMacBrowser())if(g_fSSImporter&&typeof g_ssImporterObj.IqyExportEnabled!="undefined"&&g_ssImporterObj.IqyExportEnabled&&typeof g_ssImporterObj.IqyExport!="undefined"){var c=g_ssImporterObj.IqyExport(makeAbsUrl(a));if(!c)window.location.href=STSPageUrlValidation(makeAbsUrl(a))}else window.location.href=STSPageUrlValidation(makeAbsUrl(a));else window.location.href=STSPageUrlValidation(makeAbsUrl(a))}oadGroupAndSiteLinkingBanners(){Flighting.VariantConfiguration.IsExpFeatureClientEnabled(527)&&ModuleLink.loadManifest("GroupLinking","groupLinking",}ction SubmitSearch(){_SubmitSearchForView("")}mizeSharePointListUsingInfoPath(c,d,a,f){var b=GetMSInfoPathCustomizeSharePointListProtocolUrl(c,d,a);if(typeof phManager!="undefined"&&phManager!=null)if(phManager.ShouldTryProtocolHandler("infopath")){navigator.msLaunchUri(b,;return}e();function e(){try{var e=null;if(Boolean(window.ActiveXObject))e=new ActiveXObject("SharePoint.OpenXMLDocuments.3");if(e!=null&&typeof e.CustomizeSharePointList!="undefined")if(a!=null)e.CustomizeSharePointList(c,d,a);else e.CustomizeSharePointList(c,d);else if(b!=null&&typeof phManager!="undefined"&&phManager!=null&&phManager.IsProtocolHandlerEnabled("infopath"))window.location.href=b;else throw"cannot open";}catch(g){alert(f)}}}unction editDocumentWithProgID2(e,a,h,g,f,b,j){var i=!(window.OffSwitch==null||OffSwitch.IsActive("A55794A6-5D97-41B5-A4E2-DE95BDC82583"));editDocumentWithProgIDNoUI(e,a,h,g,f,b,j,c,d,i);unction d(){alert(Strings.STS.L_EditDocumentProgIDError_Text)}}function editDocumentWithProgIDNoUI(a,d,e,h,o,m,b,j,k,i){var c,f=false;e=e.replace(/(?:\.\d+)$/,"");if(a.charAt(0)=="/"||a.substr(0,3).toLowerCase()=="%2f")a=window.location.protocol+"//"+window.location.host+a;var n=SzExtension(unescapeProperly(a));if(phManager.ShouldTryProtocolHandler(b)){navigator.msLaunchUri(phManager.CreateProtocolHandlerUrl(b,a,ProtocolCommand.Edit,null,i),function(){PHSucceed(b,true)},function(){PHSucceed(b,false);g()});return}g();function g(){var c=l();if(c!=0&&!browseris.ie&&!IsNullOrUndefined(b)&&b!="")window.location.href=phManager.CreateProtocolHandlerUrl(b,a,ProtocolCommand.Edit,null,i);else if(c==1&&j!=null)j();else c==2&&k!=null&&k()}function l(){if(!IsNullOrUndefined(b)&&b!=""&&phManager.IsProtocolHandlerEnabled(b)){window.location.href=phManager.CreateProtocolHandlerUrl(b,a,ProtocolCommand.Edit,null);return 0}if(FSupportCheckoutToLocal(n))try{c=StsOpenEnsureEx2(e+".3");if(c!=null){if(h=="1"){if(typeof c.CheckoutDocumentPrompt=="undefined")return 1;if(!c.CheckoutDocumentPrompt(a,true,d))return 1}else{if(m=="1")f=true;if(!c.EditDocument3(window,a,f,d))return 1}var i=false;i=c.PromptedOnLastOpen();if(i)window.onfocus=RefreshOnNextFocus;else SetWindowRefreshOnFocus();return 0}}catch(j){}if(h=="1")if(confirm(Strings.STS.L_ConfirmCheckout_Text)){var g;if(ShouldCallEncodeURIComponent())g=encodeURIComponent(a);else g=escapeProperly(unescapeProperly(a));NavigateToCheckinAspx(o,"FileName="+g+"& true")}else return 0;c=StsOpenEnsureEx2(e);if(c!=null){try{if(!c.EditDocument2(window,a,d))return 1;if(e=="SharePoint.OpenXMLDocuments")SetWindowRefreshOnFocus();else window.onfocus=RefreshOnNextFocus;return 0}catch(j){}try{window.onfocus=null;if(SzExtension(a)=="ppt"&&d=="")d="PowerPoint.Slide";if(!c.EditDocument(a,d))return 1;SetWindowRefreshOnFocus();return 0}catch(j){return 2}}return 1}}n createNewDocumentWithRedirect(d,c,b,i,h,j,g,a){var e=GetCurrentCtx(),f=false;if(!(window.OffSwitch==null||OffSwitch.IsActive("75D2F2A7-BAAA-4FE4-A315-D9C10A9F33AE"))&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(211))f=Boolean(e)&&IsNewWOPIDocumentEnabledForType(e.NewWOPIDocumentTypes,a)&&IsDefaultFileCreationSupported(null,a);else f=Boolean(e)&&Boolean(e.NewWOPIDocumentEnabled)&&IsDefaultFileCreationSupported(null,a);if(j&&!f)if(IsClientAppInstalled(b,a,null))createNewInClient(d,c,b,i,a);else createNewInBrowser(h,c,b,g,a,d);else if(IsClientAppInstalled(b,a,null)&&g!=1)createNewInClient(d,c,b,i,a);else createNewInBrowser(h,c,b,g,a,d)}r DocType;function IsDefaultFileCreationSupported(a,c){if(!Boolean(a))switch(c){case"ms-word":a=DocType.Word;break;case"ms-excel":a=DocType.Excel;break;case"ms-powerpoint":a=DocType.PowerPoint;break;case"ms-visio":if(!(window.OffSwitch==null||OffSwitch.IsActive("75D2F2A7-BAAA-4FE4-A315-D9C10A9F33AE"))&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(211)||!(window.OffSwitch==null||OffSwitch.IsActive("BDE14C63-89F3-40C1-80AA-136EF1076BE6")))a=DocType.Visio;else a=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(973)?DocType.Visio:DocType.Invalid;break;default:a=DocType.Invalid}var b=false;if(!(window.OffSwitch==null||OffSwitch.IsActive("75D2F2A7-BAAA-4FE4-A315-D9C10A9F33AE"))&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(211)||!(window.OffSwitch==null||OffSwitch.IsActive("BDE14C63-89F3-40C1-80AA-136EF1076BE6")))b=a==DocType.Word||a==DocType.Excel||a==DocType.PowerPoint||a==DocType.Visio;else b=a==DocType.Word||a==DocType.Excel||a==DocType.PowerPoint||a==DocType.Visio&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(973);return IsWOPIRenameFeatureActive()&&b}function IsNewWOPIDocumentEnabledForType(a,b){switch(b){case"ms-word":return Boolean(a&1<<DocType.Word);case"ms-excel":return Boolean(a&1<<DocType.Excel);case"ms-powerpoint":return Boolean(a&1<<DocType.PowerPoint);case"ms-visio":return Boolean(a&1<<DocType.Visio);default:return false}}nction addWopiPerfMarkForTarget(e,b,c){var d=Boolean(b)?b:+new Date;try{var a=new URI(e,{disableEncodingDecodingForLegacyCode:true,queryCaseInsensitive:true});a.setQueryParameter("CT",d.toString());a.setQueryParameter("OR",c);return a.getString()}catch(f){}}function addWopiPerfMark(b){var c=+new Date;try{var a=ajaxNavigate.get_href();a=addWopiPerfMarkForTarget(a,c,b);history.replaceState({reason:"WopiUserClick"},"WopiUserClick",a)}catch(d){}}function addWopiPerfMarkEx(b,c,a){if(a==null||a.length==0)return;b=+new Date;if(!IsNullOrUndefined(window.sessionStorage)){TrySetProperty(window.sessionStorage,"WOPIPerf_UserClick_"+a,b);TrySetProperty(window.sessionStorage,"WOPIPerf_UserClickOrigin",c)}}unction CreateNewDefaultDocument(j,c,h){var b=j==null?GetCurrentCtx():window["ctx"+j],f=SP.ClientContext.get_current(),m=+new Date,d=null,e=null,a="",p=(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(160))&&Boolean(b.RealHttpRoot);if(p){var i=new SP.RemoteWeb(f,b.HttpRoot);d=i.getListById(b.listName);e=Boolean(b.clvp.rootFolder)?i.getFolderByServerRelativeUrl(b.clvp.rootFolder):d.get_rootFolder();a="Remote_"}else{var k=f.get_web();d=k.get_lists().getById(b.listName);e=Boolean(b.clvp.rootFolder)?k.getFolderByServerRelativeUrl(b.clvp.rootFolder):d.get_rootFolder()}_WriteDocEngagement(a+"Start CreateNewDefaultDocument",a+"OneDrive_Start CreateNewDefaultDocument");var g=b.NewWOPIDocumentUrl+"&Source="+Nav.getSource();g+=Boolean(c)?"&TemplateType="+String(c):"&id="+h;var r=Boolean(c)?d.createDocument(null,e,c):d.createDocumentFromTemplate(null,e,h),l=SP.Utilities.SPWOPIFrameAction,q=r.getWOPIFrameUrl(l.edit);f.executeQueryAsync(o,n);function o(){var b=q.get_value();if(Boolean(b)){_WriteDocEngagement(a+"Success CreateNewDefaultDocument",a+"OneDrive_Success CreateNewDefaultDocument");b=b.replace("action=edit","action=editnew");if(parseInt(c)==DocType.Word&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(202)&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(165)||parseInt(c)==DocType.PowerPoint&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(55)&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(194)){b=b.replace("/WopiFrame.aspx","/doc.aspx");b=addWopiPerfMarkForTarget(b,m,"DocLibClassicUI")}GoToPage(b)}}function n(c,b){_WriteDocEngagement(a+"Fail CreateNewDefaultDocument",a+"OneDrive_Fail CreateNewDefaultDocument");_WriteDocDebugLog(a+"Debug TeamSite_Fail CreateNewDefaultDocument",a+"Debug OneDrive_Fail CreateNewDefaultDocument",SP.DebugLogger.LoggingLevel.Interesting,getLoggingInfo(b));(window.OffSwitch==null||OffSwitch.IsActive("8FDE0754-2E15-4696-ADF5-F2266A765360"))&&removeWopiPerfMark();OpenPopUpPageWithTitle(g,OnCloseDialogNavigate,null,null,null)}}ExpDataViewGroupOnPageLoad(){ExpGroupOnPageLoad("PageLoad")}stsOpenDoc,v_strStsOpenDoc;ightboxImageExtensions,_lightboxVideoExtensions;function _shouldOpenInLightbox(){return false}function _openInLightbox(a){if(Boolean(history.state)&&Boolean(history.state.lightbox))return;EnsureScriptFunc("SP.js","SP.Utilities.Utility",function(){var b=new URI(ajaxNavigate.get_href()).getQueryAsObject(),c=!(window.OffSwitch==null||OffSwitch.IsActive("EA88F22A-E74E-4315-BCC9-14F41AA20A67"));a=SP.Utilities.Utility.getLayoutsPageUrl("Lightbox.aspx?url="+encodeURIComponent(c?decodeURI(a):a));if(Boolean(b.GroupId))a+="&GroupId="+encodeURIComponent(b.GroupId)+"&GroupSiteUrl="+(Boolean(b.GroupSiteUrl)?encodeURIComponent(b.GroupSiteUrl):"");EnsureScriptFunc("SP.UI.Dialog.js","SP.UI.MediaLightbox",})}unction DispDocItemExWithEvent(g,f,m,p,r,d,n,q){var i;itemTable=FindSTSMenuTable(g,"CTXName");if(!browseris.ie&&!browseris.msEdge&&!IsSupportedMacBrowser()&&!IsSupportedNPApiBrowserOnWin()){_WriteDocEngagement("Documents_OpenDocumentUnsupportedBrowser","OneDrive_OpenDocumentUnsupportedBrowser");if(browseris.ie)event.cancelBubble=false;i=g.href;if(ajaxNavigate.get_search().match(new RegExp("[?&]IsDlg=1"))!=null)typeof window.frameElement.navigateParent!="undefined"&&window.frameElement.navigateParent(i);else Nav.navigate(i);return false}var a,b,e=true,j="",s=document.getElementById("FileDialogViewTable");if(s!=null){_WriteDocEngagement("Documents_OpenDocumentClickInFileDialog2","OneDrive_OpenDocumentClickInFileDialog2");if(browseris.ie){event.cancelBubble=false;event.returnValue=false}return true}var h=Boolean(g.getAttribute("isEdit"));b=itemTable!=null?GetAttributeFromItemTable(itemTable,"Url","ServerUrl"):"";if(b==null||b==""){if(h)b=g.editHref;if(!Boolean(b))b=g.href}else b=SzServer(g.href)+b;var c=itemTable!=null?GetAttributeFromItemTable(itemTable,"App",null):"";if(!Boolean(c))c=g.getAttribute("App");var k=SzExtension(b);h=h||c=="ms-infopath";var l=h&&HasRights(0,4)&&!FDefaultOpenForReadOnly(k)&&(!Boolean(currentItemCheckedOutUserId)||currentItemCheckedOutUserId==ctx.CurrentUserId);if(phManager.ShouldTryProtocolHandler(c)){_WriteDocEngagement("Documents_OpenDocumentWithProtocolHandlerIE10PlusStart","OneDrive_OpenDocumentWithProtocolHandlerIE10PlusStart");navigator.msLaunchUri(phManager.CreateProtocolHandlerUrl(c,b,l?ProtocolCommand.Edit:ProtocolCommand.View,null,true),;return CancelMyEvent(false,a,f,true)}if(m==="TRUE"&&_shouldOpenInLightbox(b)){_WriteDocEngagement("Documents_OpenDocumentWithLightbox","OneDrive_OpenDocumentWithLightbox");_openInLightbox(b);return CancelMyEvent(false,a,f,true)}if(IsOfficeURLSchemes(c)){window.location.href=phManager.CreateProtocolHandlerUrl(c,b,l?ProtocolCommand.Edit:ProtocolCommand.View,null,true);return CancelMyEvent(false,a,f,true)}return o();function o(){if(n!=null&&!(h&&(q||browseris.chrome||!(window.OffSwitch==null||OffSwitch.IsActive("855C3AE1-A63D-41F1-B713-721B65620BE7"))&&phManager.Win7IE11()))&&!(Boolean(ctx)&&Boolean(ctx.IRMEnabled))){n();return CancelMyEvent(false,a,f,true)}phManager.SetProtocolHandlerEnabled(c,null);if(Boolean(c)&&phManager.IsProtocolHandlerEnabled(c))if(c!=null&&c!=""){_WriteDocEngagement("Documents_OpenDocumentWithProtocolHandler","OneDrive_OpenDocumentWithProtocolHandler");window.location.href=phManager.CreateProtocolHandlerUrl(c,b,l?ProtocolCommand.Edit:ProtocolCommand.View,null,true);return CancelMyEvent(false,a,f,true)}if(!(window.OffSwitch==null||OffSwitch.IsActive("DE8A4D11-E9A4-40F1-A2DF-BBD52CE6070E"))&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(54))try{b=decodeURI(b)}catch(v){_WriteDocDebugLog("Documents_OpenDocumentWithActiveXDecodeFailure","Documents_OpenDocumentWithActiveXDecodeFailure",SP.DebugLogger.LoggingLevel.Interesting,v)}if(currentItemProgId==null&&itemTable!=null)currentItemProgId=GetAttributeFromItemTable(itemTable,"Type","HTMLType");if(currentItemProgId!=null)j=currentItemProgId;if(FDefaultOpenForReadOnly(k)){if(d.indexOf("SharePoint.OpenDocuments")>=0)d="SharePoint.OpenDocuments.3"}else if(!FSupportCheckoutToLocal(k))d="";if(currentItemCheckedOutUserId==null&&itemTable!=null&&typeof itemTable.COUId=="string")currentItemCheckedOutUserId=itemTable.COUId;if(currentItemCheckedoutToLocal==null&&itemTable!=null)currentItemCheckedoutToLocal=GetAttributeFromItemTable(itemTable,"COut","IsCheckedoutToLocal ");if(currentItemCheckedOutUserId!=null&&currentItemCheckedOutUserId!=""&&currentItemCheckedOutUserId==ctx.CurrentUserId&&(d==""||d.indexOf("SharePoint.OpenDocuments")>=0)&&FSupportCheckoutToLocal(k)||d=="SharePoint.OpenDocuments")d="SharePoint.OpenDocuments.3";var s=2;if(d!=""&&HasRights(16,0)){if(d.indexOf(".3")>=0)s=3;a=StsOpenEnsureEx2(d);if(a==null&&s==3){d=d.replace(".3",".2");a=StsOpenEnsureEx2(d);s=2}}if(a!=null)if(s==2||itemTable==null&&currentItemCheckedOutUserId==null||ctx.isVersions==1&&(itemTable==null||typeof itemTable.isMostCur!="string"||itemTable.isMostCur=="0")){try{_WriteDocEngagement("Documents_OpenDocumentWithO11ClientStart","OneDrive_OpenDocumentWithO11ClientStart");if(currentItemCheckedOutUserId!=null&&currentItemCheckedOutUserId!=""&&(currentItemCheckedOutUserId==ctx.CurrentUserId||ctx.CurrentUserId==null))if(currentItemCheckedoutToLocal=="1"){alert(Strings.STS.L_OpenDocumentLocalError_Text);e=false}else e=typeof a.EditDocument2!="undefined"&&a.EditDocument2(window,b,j);else e=typeof a.ViewDocument2!="undefined"&&a.ViewDocument2(window,b,j);_WriteDocEngagement("Documents_OpenDocumentWithO11ClientSuccess","OneDrive_OpenDocumentWithO11ClientSuccess")}catch(v){_WriteDocEngagement("Documents_OpenDocumentWithO11ClientFailure","OneDrive_OpenDocumentWithO11ClientFailure");_WriteDocDebugLog("Documents_OpenDocumentWithO11ClientFailure","OneDrive_OpenDocumentWithO11ClientFailure",SP.DebugLogger.LoggingLevel.Interesting,v);e=false}if(e)window.onfocus=RefreshOnNextFocus}else{_WriteDocEngagement("Documents_OpenDocumentWithActiveXStart","OneDrive_OpenDocumentWithActiveXStart");var o=0;if(currentItemCheckedOutUserId!="")if(currentItemCheckedOutUserId!=ctx.CurrentUserId&&ctx.CurrentUserId!=null)o=1;else if(currentItemCheckedoutToLocal==null||currentItemCheckedoutToLocal!="1")o=2;else o=4;else if(!HasRights(0,4)||FDefaultOpenForReadOnly(k))o=1;else if(ctx.isForceCheckout==true)o=3;try{if(h)e=typeof a.EditDocument3!="undefined"&&a.EditDocument3(window,b,false,j);else e=typeof a.ViewDocument3!="undefined"&&a.ViewDocument3(window,b,o,j);_WriteDocEngagement("Documents_OpenDocumentWithActiveXSuccess","OneDrive_OpenDocumentWithActiveXSuccess")}catch(v){_WriteDocEngagement("Documents_OpenDocumentWithActiveXFailure","OneDrive_OpenDocumentWithActiveXFailure");_WriteDocDebugLog("Documents_OpenDocumentWithActiveXFailure","OneDrive_OpenDocumentWithActiveXFailure",SP.DebugLogger.LoggingLevel.Interesting,v);e=false}if(e){var t=typeof a.PromptedOnLastOpen!="undefined"&&a.PromptedOnLastOpen();if(t)window.onfocus=RefreshOnNextFocus;else SetWindowRefreshOnFocus()}}else if(currentItemCheckedoutToLocal=="1"){_WriteDocEngagement("Documents_OpenDocumentLocalError","OneDrive_OpenDocumentLocalError");alert(Strings.STS.L_OpenDocumentLocalError_Text)}if(a==null||!e){if(m=="TRUE"&&p=="TRUE"&&r=="TRUE"){_WriteDocEngagement("Documents_OpenDocumentWithHtmlTransformService","OneDrive_OpenDocumentWithHtmlTransformService");if(itemTable==null)return e;if(browseris.ie){event.cancelBubble=true;event.returnValue=false}else if(IsSupportedMacBrowser()||IsSupportedFirefoxOnWin()){typeof f.preventDefault!="undefined"&&f.preventDefault();typeof f.stopPropagation!="undefined"&&f.stopPropagation()}var u=new Function("return "+itemTable.getAttribute("CTXName")+".HttpRoot;");i=u()+"/_layouts/15/htmltrverify.aspx?doc="+escapeProperly(b);if(ajaxNavigate.get_search().match(new RegExp("[?&]IsDlg=1"))!=null)typeof window.frameElement.navigateParent!="undefined"&&window.frameElement.navigateParent(i);else GoToPage(i)}else if(ajaxNavigate.get_search().match(new RegExp("[?&]IsDlg=1"))!=null){_WriteDocEngagement("Documents_OpenDocumentDownloadFromDialog","OneDrive_OpenDocumentDownloadFromDialog");typeof window.frameElement.navigateParent!="undefined"&&window.frameElement.navigateParent(g.href)}else{_WriteDocEngagement("Documents_OpenDocumentDownload","OneDrive_OpenDocumentDownload");Nav.navigate(g.href)}return false}return CancelMyEvent(e,a,f)}}function CancelMyEvent(c,e,a,d){if(browseris.ie){if(event!=null){event.cancelBubble=true;event.returnValue=false}}else if(IsSupportedMacBrowser()||IsSupportedNPApiBrowserOnWin())return b();if(!(window.OffSwitch==null||OffSwitch.IsActive("D05C06F8-4F27-450A-B726-A1F8971EFFF3"))&&typeof a.preventDefault!=="undefined")return b();return c;function b(){if(d||e!=null&&c){typeof a.preventDefault!="undefined"&&a.preventDefault();typeof a.stopPropagation!="undefined"&&a.stopPropagation()}return true}}function DispDocItemEx2(b,c,l,j,k,r,m,d,f){var a,u=false,o=f!=null&&f!="",e=IsClientAppInstalled(d,null,b)&&HasRights(16,0),h=!IsNullOrUndefined(b.getAttribute("isEdit"));function p(){_WriteDocEngagement("Documents_OpenDocumentInWac","OneDrive_OpenDocumentInWac");a=f;a=AddInfoPathParametersToUrl(a,d,b,DocOpen.BROWSER);a=AddSourceToUrl(a);if(!(window.OffSwitch==null||OffSwitch.IsActive("231299DB-0D50-4B47-91F8-1624E539A39A"))&&(a.toLowerCase().indexOf("doc.aspx")!==-1||a.toLowerCase().indexOf("wopiframe.aspx")!==-1))a=addWopiPerfMarkForTarget(a,null,"DocLibClassicUI");if(h){var e=new URI(a);e.setQueryParameter("action","edit");a=e.getString()}if(ajaxNavigate.get_search().match(new RegExp("[?&]IsDlg=1"))!=null)typeof window.frameElement.navigateParent!="undefined"&&window.frameElement.navigateParent(a);else if(c.shiftKey||c.ctrlKey)return true;else NavigateParentOrSelf(b,a);c.cancelBubble=true;c.returnValue=false;typeof c.preventDefault!="undefined"&&c.preventDefault();typeof c.stopPropagation!="undefined"&&c.stopPropagation();return false}if(SzExtension(b.href).indexOf("pdf")!=-1){var g=b,q=h&&Boolean(g.editHref)?g.editHref:g.href;g.href=q;Nav.navigate(q);_WriteDocEngagement("Documents_OpenDocumentPDF","OneDrive_OpenDocumentPDF");return false}if(o){itemTable=FindSTSMenuTable(b,"CTXName");var i=itemTable!=null?GetAttributeFromItemTable(itemTable,"App",null):"";if(!Boolean(i))i=b.getAttribute("App");var s=!e&&(browseris.ie10standardUp||browseris.msEdge||browseris.chrome)&&Boolean(i)&&(m=="0"||h)&&HasRights(0,32);if(!s&&(m=="1"&&!(e&&h&&HasRights(0,32))||!e))return p();else if(e)if(d==""||d.indexOf("SharePoint.OpenDocuments")>=0)return DispDocItemExWithEvent(b,c,l,j,k,r);else{!ViewDoc(b.href,d)&&editDocumentWithProgIDNoUI(b.href,currentItemProgId,d,"0",ctx.HttpRoot,"0",i,n,n);var t=StsOpenEnsureEx2(d);_WriteDocEngagement("Documents_OpenDocumentInClientWithWacInstalled","OneDrive_OpenDocumentInClientWithWacInstalled");return CancelMyEvent(false,t,c)}}eturn DispDocItemExWithEvent(b,c,l,j,k,d,o?p:null,e)}unction AddSourceToUrl(a){var c=a.toLowerCase().indexOf("/wopiframe.aspx?")>0,b=a.toLowerCase().indexOf("/doc.aspx?")>0&&!(window.OffSwitch==null||OffSwitch.IsActive("231299DB-0D50-4B47-91F8-1624E539A39A"));if(c||b){document.cookie="WOPISessionContext="+Nav.getSource()+";path=/;";if(c)a=a.replace(/\/_layouts\/WopiFrame.aspx\?/,"/_layouts/15/WopiFrame.aspx?");if(!(window.OffSwitch==null||OffSwitch.IsActive("8F28B448-4E84-4367-BC49-84618C6D684E"))&&b)a=a.replace(/\/_layouts\/Doc.aspx\?/,"/_layouts/15/Doc.aspx?");return a}else{var d=Nav.getSource(),e=a.length+d.length;if(e>1950)return a;else{var f=a.indexOf("?")>=0?"&":"?";return a+f+"Source="+d}}}ction _VerifyHref(a,d,c,g,b){var k=+new Date,i=d.button==Sys.UI.MouseButton.rightButton,h=GetRedirectedHref(a.href,c,g,null,b,false,i,a),j=b!=null&&b.length>1,f=IsClientAppInstalled(g,null,a)&&HasRights(16,0);if(j){if((!Boolean(a)||a.className.indexOf("ms-calloutLink")==-1)&&(window.OffSwitch==null||OffSwitch.IsActive("231299DB-0D50-4B47-91F8-1624E539A39A"))){var e=GetSourceDocId(h);e!=null&&e.length>0&&addWopiPerfMarkEx(k,1,e)}if(c=="1"&&!(f&&!IsNullOrUndefined(a.getAttribute("isEdit")))||!f){if(Boolean(a.getAttribute("isEdit")))a.editHref=a.href;if(c=="1")a.href=h;d.cancelBubble=true;d.returnValue=true}DetachEvent("mousedown",VerifyHref,a)}return false}function GetSourceDocId(d){var a=unescape(d);if(Boolean(a)){var b=a.indexOf("sourcedoc="),c=a.substring(b).indexOf("&"),e=c==-1?a.substring(b):a.substring(b,b+c);return escape(e)}return null}function GetRedirectedHref(c,k,e,f,b,g,j,h){var d=b!=null&&b!=""&&(!g||f!=null&&f!=""),i=IsClientAppInstalled(e,null,h)&&HasRights(16,0);if(d){b=b.substring(1);d=b!=""}var a=c;if(d)if(g||k=="1"||!i&&!browseris.msEdge&&!browseris.chrome){a=b;if(!IsInfoPathProgId(e)&&c.indexOf("?")<0&&j)if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(69))a=c+"?Web=1";else if(GetUrlKeyValue("sourcedoc",true,b,true)!=""||GetUrlKeyValue("d",true,b,true)!="")a=b;else a=StURLSetVar2(c,"Web","1");else if(Nav.getUrlKeyValue("Web",true,c,true)=="1")a=c;else{a=AddInfoPathParametersToUrl(a,e,h,DocOpen.BROWSER);a=AddSourceToUrl(a)}a=STSPageUrlValidation(a)}return a}unction IsClientAppInstalled(c,e,b){if(e!=null&&phManager.IsProtocolHandlerEnabled(e,true))return true;if(!(window.OffSwitch==null||OffSwitch.IsActive("860BFCE4-DE4A-476E-8FCE-8F7A5A0E17E4"))&&Boolean(ctx)&&Boolean(ctx.IRMEnabled))return true;if(b!=null){itemTable=FindSTSMenuTable(b,"CTXName");var a=itemTable!=null?GetAttributeFromItemTable(itemTable,"App",null):"";if(!Boolean(a))a=b.getAttribute("App");if(Boolean(a)&&phManager.IsProtocolHandlerEnabled(a,true))return true}var d=null;if(c!="")d=StsOpenEnsureEx2(c);return d!=null}n _MoveToDate(a,b){_MoveToViewDate(a,null,b)}function MoveToToday(){_MoveToViewDate("",null)}unction _ClickDay(a){_MoveToDate(a)}function GetIframe(){return null}eHierarchyQString;unction SetAdditionalNavigateHierarchyQString(a){g_AdditionalNavigateHierarchyQString=a}ar httpFolderTarget,httpFolderSource,httpFolderDiv;function NavigateHttpFolderCore(){var i=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(122)&&Boolean(browseris.ie11)&&!Boolean(opener);if(i){EnsureScriptFunc("SP.js","SP.Utilities.Utility",function(){var b="menubar=no,toolbar=no,location=no,resizable=no,scrollbars=no,status=no,height=1,width=1",a=new URI(httpFolderSource);a.setPath(SP.Utilities.Utility.getLayoutsPageUrl("openinexplorer.aspx"));window.open(a.getString(),"",b)});return true}_WriteDocEngagement("StartOpenInWinExplorer","OneDrive_StartOpenInWinExplorer");var a;if(httpFolderDiv==null){httpFolderDiv=document.createElement("DIV");document.body.appendChild(httpFolderDiv);httpFolderDiv.onreadystatechange=function(){NavigateHttpFolderCore()};typeof httpFolderDiv.addBehavior!="undefined"&&httpFolderDiv.addBehavior("#default#httpFolder")}var c=false;if(typeof httpFolderDiv.readyState=="string"&&httpFolderDiv.readyState=="complete"){httpFolderDiv.onreadystatechange=null;try{a=typeof document.frames!="undefined"&&typeof document.frames.item!="undefined"?document.frames.item(httpFolderTarget):null;if(a!=null){var e=typeof a.document!="undefined"?a.document:null;if(e!=null){var g=typeof e.body!="undefined"?e.body:null;if(g!=null&&typeof g.innerText=="string")g.innerText=Strings.STS.L_WebFoldersRequired_Text}}}catch(k){}var h="",b="";try{if(typeof httpFolderDiv.navigateFrame!="undefined")h=httpFolderDiv.navigateFrame(httpFolderSource,httpFolderTarget);if(h=="OK")c=true}catch(k){b=k.message}if(!c&&0==httpFolderSource.search(new RegExp("http://[a-zA-Z0-9-.]+(:80)?/"))){var j=httpFolderSource.replace(/http:\/\/([a-zA-Z0-9\-\.]+)(:80)?[\/]/,"//$1/").replace(/[\/]/g,"\\");try{a=typeof document.frames!="undefined"&&typeof document.frames.item!="undefined"?document.frames.item(httpFolderTarget):null;if(a!=null){a.onload=null;var d=typeof a.document!="undefined"?a.document:null;if(d!=null){var f=typeof d.location!="undefined"?d.location:null;if(f!=null&&typeof f.href=="string"){f.href=j;c=true}}}}catch(k){b=k.message}}if(!c){if(browseris.ie){_WriteDocEngagement("FailureOpenInWinExplorer_IE","OneDrive_FailureOpenInWinExplorer_IE");b="Fail to launch Explorer view in IE, show users sync client link. "+b}else{_WriteDocEngagement("FailureOpenInWinExplorer_OtherBrowser","OneDrive_FailureOpenInWinExplorer_OtherBrowser");b="Fail to launch Explorer view in non-IE browser, show users sync client link. "+b}SP.DebugLogger.Write("FailureLaunchExplorerView",SP.DebugLogger.LoggingLevel.Interesting,b);ShowExplorerViewError()}else _WriteDocEngagement("SuccessOpenInWinExplorer","OneDrive_SuccessOpenInWinExplorer")}return c}nction NavigateHttpFolder(c,i,b){if(!Boolean(b))b=(Boolean(_spPageContextInfo)?_spPageContextInfo.webAbsoluteUrl:"")+"/_layouts/15/webdav.aspx";if("/"==c.charAt(0))c=window.location.protocol+"//"+window.location.host+c;httpFolderTarget=i;httpFolderSource=c;var a=new IframeWorker("explorerViewFrame"),g=a.getFrame();if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(167)&&g==null&&_spPageContextInfo!=null)e();else NavigateHttpFolderCore();function f(){var a;if(Boolean(_spPageContextInfo)&&Boolean(_spPageContextInfo.currentUICultureName))a=_spPageContextInfo.currentUICultureName;else a="en-us";var e='<a href="'+STSHtmlEncode("http://www.microsoft.com/online/legal/v2/?docid=18&langid="+a)+'">'+STSHtmlEncode(Strings.STS.L_ExplorerViewPersistCookiePrivacyStatementLink)+"</a>",d="<div>"+STSHtmlEncode(Strings.STS.L_ExplorerViewPersistCookieConfirm_Text)+"</div><div class='ms-core-form-bottomLeftBox'>"+e+"</div><div class='ms-core-form-bottomButtonBox'><button id='js-PrivateComputerBtnDismissDlg' class = 'ms-button-emphasize' onclick='logAndClose(1)'>"+STSHtmlEncode(Strings.STS.L_ExplorerViewPersistCookiePrivateComputer)+"</button><button id='js-CancelBtnDismissDlg' onclick='logAndClose(0)'>"+STSHtmlEncode(Strings.STS.L_DocMoveDialogCancel)+"</button></div>",c=document.createElement("DIV");c.innerHTML=d;var f={html:c,title:STSHtmlEncode(Strings.STS.L_ExplorerViewPersistCookieDialogTitle),dialogReturnValueCallback:;SP.SOD.execute("sp.ui.dialog.js","SP.UI.ModalDialog.showModalDialog",f);var b=document.getElementById("js-CancelBtnDismissDlg");b!=null&&b.focus()}nction h(){if(typeof SPO.Identity.SPOIdentityHelper.doesSessionSupportIssuingWebDavCookies=="function")EnsureScriptFunc("SP.js","SP.ClientContext",function(){var c=SP.ClientContext.get_current(),e=SPO.Identity.SPOIdentityHelper.doesSessionSupportIssuingWebDavCookies(c);c.executeQueryAsync(function(){if(e.get_value()){a.createAndAppendFrame(b);Flighting.VariantConfiguration.IsExpFeatureClientEnabled(323)&&window.setInterval(d,27e4);a.checkFrameLoaded(f,ShowExplorerViewError);return}else NavigateHttpFolderCore()},});else NavigateHttpFolderCore()}}ar IframeWorker;function NavigateHttpFolderIfSupported(c,b){if(b=="_blank")if(SupportsNavigateHttpFolder()){var f=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(392),a=(Boolean(_spPageContextInfo)?_spPageContextInfo.webAbsoluteUrl:"")+"/_layouts/15/webdav.aspx",e=GetCurrentCtx();if(f&&Boolean(e)){SP.QoS.WriteStart("GetWebDavUrl_Start");var d=SP.ClientContext.get_current(),i=d.get_web(),h=i.get_lists().getById(e.listName),g=h.getWebDavUrl(c);d.executeQueryAsync(function(){var e=g.get_value();if(Boolean(e)){SP.QoS.WriteSuccess("GetWebDavUrl_Success");var d=new URI(e);d.setPath("/_layouts/15/webdav.aspx");a=d.getString();d.setPath("/_layouts/15/openinexplorer.aspx");d.setQueryParameter("aspxUrl",a);d.setQueryParameter("target",b);d.setQueryParameter("source",e);window.open(d.getString(),"","menubar=no,toolbar=no,location=no,status=no,resizable=yes,height=450,width=400");return}else{SP.QoS.WriteFailure("GetWebDavUrl_Fail");e=c;NavigateHttpFolder(c,b,a)}},function(){SP.QoS.WriteFailure("GetWebDavUrl_Fail");NavigateHttpFolder(c,b,a)})}else NavigateHttpFolder(c,b,a)}else alert(Strings.STS.L_WebFoldersError_Text);else alert(Strings.STS.L_NoExplorerView_Text)}ion CopyPageAddressToClipboard(){CopyStringToClipboard(window.location.href)}SetupFixedWidthWebParts(){EnsureScriptParams("browserScript","browserScript.MSOWebPartPage_SetupFixedWidthWebParts")}ction OnListViewKeyDown(a,b){var d=GetListContextFromContextNumber(String(b));if(d==null)return;if(d.inGridMode&&PageMinimized()){if(a.ctrlKey&&!a.altKey&&!a.shiftKey&&a.keyCode==="E".charCodeAt(0)){parent.postMessage("ClosingGrid","*");if(window.event!=null)window.event.cancelBubble=true;else a!=null&&a.stopPropagation()}return}var e=a.keyCode,c=a.shiftKey||a.ctrlKey;if(IsCallOutOn())return;switch(e){case Sys.UI.Key.del:HandleItemDelete(a,b);break;case Sys.UI.Key.up:SelectNextRow(b,-1,c,a);break;case Sys.UI.Key.down:SelectNextRow(b,1,c,a);break;case Sys.UI.Key.enter:if(IsEventTargetAnchor(a))return;if(a.target!=null&&!IsStrNullOrEmpty(a.target.className)&&a.target.className.indexOf("ms-lstItmLinkAnchor")>=0)OpenCallOutOrECB(b,a);else ListItem_Open(b,a)}}ClickedItemRow;on Point(a,b){this.x=a;this.y=b}esizeHandler;_listItemCache;r g_fRibbonAnimationEnabled,g_fSkipAnimation,g_fSkipNextTabExpandAnimation;tion setupPageDescriptionCallout(){var c=document.getElementById("ms-pageDescription");if(Boolean(c)){var a=GetInnerText(c),b=document.getElementById("ms-pageDescriptionDiv");if(Boolean(a)){a=a.trim();setInnerText(c,a);b.title=a;b.setAttribute("role","button");!OffSwitch.IsActive("6DE0A6C4-5A29-4DE3-9996-05545DD0FE2F")&&$addHandler(b,"keydown",;a=a.replace(/(\n|\r|\t| )/g,"");if(Boolean(a)){SPAnimationUtility.BasicAnimator.FadeIn(b,null,null);EnsureScriptFunc("callout.js","Callout",}}}}function DescriptionDivKeyDown(a){if(a.keyCode==Sys.UI.Key.space||a.keyCode==Sys.UI.Key.enter){a.target.click();a.preventDefault()}}ClickLogTerm,_searchClickLogSeq;function WriteSearchClickLog(f){try{var c=GetItemRow(f),a=CtxFromRow(c),e=c.getAttribute("iid"),b=GetIndexFromIID(a,e)+a.ListData.FirstRow,d=typeof a.completedSearchTerm!="undefined"&&a.completedSearchTerm!=null;if(typeof a.ListTemplateType!="undefined"&&d){if(_searchClickLogTerm!=a.completedSearchTerm){_searchClickLogSeq=0;_searchClickLogTerm=a.completedSearchTerm}if(a.ListTemplateType==700)SP.QoS.WriteUserEngagement("OneDriveInPlaceSearchItemClick",{index:b,seq:_searchClickLogSeq++});else SP.QoS.WriteUserEngagement("SitesInPlaceSearchItemClick",{index:b,seq:_searchClickLogSeq++})}}catch(g){}}_lastRequestDigestUpdate,_requestDigest,_updateInterval;nction CreatePanel(h){ClosePanel();var f=document.createElement("DIV");f.id="ms-OldPanel-PanelBackdrop";f.className="ms-OldPanel-PanelBackdrop";f.onclick=ClosePanel;document.body.appendChild(f);var e=document.createElement("DIV");e.id="ms-OldPanel-PanelContainer";e.className="ms-OldPanel-PanelContainer";e.style.height="calc(100% - 50px)";var g=document.createElement("IFRAME");g.className="ms-OldPanel-Frame";g.src=h;g.title=SP.Res.PanelTitle;e.appendChild(g);var d=document.createElement("DIV");d.id="ms-OldPanel-CloseButton";d.className="ms-OldPanel-CloseButton";d.setAttribute("aria-label",SP.Res.ClosePanel);d.onclick=ClosePanel;var c=document.createElement("SPAN");c.id="ms-OldPanel-CloseButtonOuterSpan";c.style.padding="8px";c.style.width="16px";c.style.height="16px";c.style.display="inline-block";var a=document.createElement("SPAN");a.id="ms-OldPanel-CloseButtonInnerSpan";a.className="s4-clust";a.style.width="16px";a.style.height="16px";a.style.overflow="hidden";a.style.position="relative";a.style.display="inline-block";var b=document.createElement("IMG");b.id="ms-OldPanel-CloseButtonImage";b.className="ms-dlgCloseBtnImg";b.alt=Strings.STS.L_OldPanel_CloseText;b.src="/_layouts/15/images/fgimg.png?rev=44";b.style.left="0px";b.style.top="-645px";b.style.position="absolute";a.appendChild(b);c.appendChild(a);d.appendChild(c);e.appendChild(d);document.body.appendChild(e)}function ClosePanel(){var b=document.getElementById("ms-OldPanel-PanelContainer");b!==null&&b!==undefined&&document.body.removeChild(b);var a=document.getElementById("ms-OldPanel-PanelBackdrop");a!==null&&a!==undefined&&document.body.removeChild(a)}var g_NotificationEngine,g_notiExpireTimerId,g_standardNotiCt,g_statusNotiCt,SPNotifications,g_SPNotificationEventID_Count,addNotification,removeNotification;ction SPStatusNotificationData(c,d,a,b){this.txt=c;this.dt=d;this.img=a;this.sip=b}ar cGCMinimumWidth,cGCMinimumHeight,cGCMaxGCResizeCount,glGCObjectHeight,glGCObjectWidth,glGCResizeCounter;CGlobal;ction GCGridNewRow(a){if(TestGCObject(a))typeof a.SelectNewRow!="undefined"&&a.SelectNewRow()}function GCRefresh(a){if(TestGCObject(a))typeof a.Refresh!="undefined"&&a.Refresh()}ar isNewEcb,isDocLibContextMenu;ar WSS_MENUITEMSEQUENCE_REPLY,WSS_MENUITEMSEQUENCE_VIEWPROPERTIES,WSS_MENUITEMSEQUENCE_EDITPROPERTIES,WSS_MENUITEMSEQUENCE_EDITSERIESITEM,WSS_MENUITEMSEQUENCE_EDITINOIS,WSS_MENUITEMSEQUENCE_EDITINAPPLICATION,WSS_MENUITEMSEQUENCE_OPENFOLDER,WSS_MENUITEMSEQUENCE_CHECKINCHECKOUT,WSS_MENUITEMSEQUENCE_DISCARDCHECKOU,WSS_MENUITEMSEQUENCE_PUBLISHITEM,WSS_MENUITEMSEQUENCE_CANCELPUBLISH,WSS_MENUITEMSEQUENCE_EXPORTCONTACT,WSS_MENUITEMSEQUENCE_SENDMENU,WSS_MENUITEMSEQUENCE_GOTOSOURCEITEM,WSS_MENUITEMSEQUENCE_DOCTRANMENU,WSS_MENUITEMSEQUENCE_DOWNLOADORIGINAL,WSS_MENUITEMSEQUENCE_VERSIONS,WSS_MENUITEMSEQUENCE_MODERATEITEM,WSS_MENUITEMSEQUENCE_WORKFLOWS,WSS_MENUITEMSEQUENCE_ADDTOMYLINKS,WSS_MENUITEMSEQUENCE_ADDTOCATEGORY,WSS_MENUITEMSEQUENCE_SUBSCRIBE,WSS_MENUITEMSEQUENCE_DISCUSS,WSS_MENUITEMSEQUENCE_PUBLISHBACK,WSS_MENUITEMSEQUENCE_CREATEDWS,WSS_MENUITEMSEQUENCE_MANAGEPERMISSIONS,WSS_MENUITEMSEQUENCE_CUSTOMIZENEWBUTTON,WSS_MENUITEMSEQUENCE_DELETEITEM,WSS_MENUITEMSEQUENCE_DELETEDOCITEM,WSS_MENUITEMSEQUENCE_MOVECOPYITEM,WSS_MENUITEMSEQUENCE_ACTIVATESOLUTION,WSS_MENUITEMSEQUENCE_DEACTIVATESOLUTION,WSS_MENUITEMSEQUENCE_UPGRADESOLUTION,WSS_MENUITEMSEQUENCE_ENCRYPTITEM,WSS_MENUITEMSEQUENCE_EDITINBROWSER,WSS_MENUITEMSEQUENCE_OPENSEP,WSS_MENUITEMSEQUENCE_GETLINK,WSS_MENUITEMSEQUENCE_DOWNLOADACOPY,WSS_MENUITEMSEQUENCE_SHARE,WSS_MENUITEMSEQUENCE_ACTIONSEP,WSS_MENUITEMSEQUENCE_ADVANCEDSEP,WSS_MENUITEMSEQUENCE_ADVANCED,WSS_MENUITEMSEQUENCE_COPY;ar g_menuLaunchPoint; ecbManager;unction setupMenuContext(a){currentCtx=a}CreateHiddenCtxMenu(b,a){return List_CreateCtxImg_Helper(b,a,false)}n CreateMenuEx(g,a,e,h){checkNewEcbFlights(g);setNewEcbCmdSequence();IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfWSSECBClickStart);if(a==null)return undefined;IsMenuShown=true;document.body.onclick=null;resetItemGlobals();var d;d=BuildMenu(g,e);d.setAttribute("hideicons","true");currentEditMenu=d;if(!isDocLibContextMenu){a.onmouseout=null;var b=null,c=null;if(a.tagName=="SPAN"&&HasCssClass(a,"js-callout-ecbMenu"))b=a;else if(a.tagName=="BUTTON"&&HasCssClass(a,"js-qcb-button"))b=a;else{c=FindCtxImg(a);if(c==null){b=GetAncestorByTagNames(a,["TD","TR"]);if(b==null)b=a;else c=FindCtxImg(a)}}c!=null&&typeof c.shown=="boolean"&&c.shown==false&&ShowCtxImg(c,true,b);OMenu(d,b,null,h,-1,false,false,e);if(itemTable!=null&&itemTable.tagName!="DIV"){var f=itemTable.getAttribute("CTXName");if(f==undefined||f=="")itemTable=GetSelectedElement(a,"TABLE","DIV")}if(b.tagName=="TD")b.onclick=SingleItemSelect;d._onDestroy=OutItem;if(e!=null)e.cancelBubble=true;IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfWSSECBClickEnd)}return false}isInvalidAjaxMenuElement(a){var b=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(162);checkNewEcbFlights(currentCtx);return a===null||typeof a==="undefined"||onKeyPress==false&&IsInCtxImg(a)==null&&a.className.indexOf("js-callout-action")===-1&&a.className.indexOf("ms-lstItmLinkAnchor")===-1&&!b&&(!isNewEcb||!Boolean(currentCtx)||!Boolean(currentCtx.listBaseType==1))&&(a.tagName=="A"||Boolean(a.parentNode.tagName=="A"))}var ecbItems;unction AddSendSubMenu(k,r,a,p,q){var y=Boolean(a.CurrentSelectedItems>1),l=[];l.Copy=Strings.STS.L_SubmitFileCopyWarning_Text;l.Move=Strings.STS.L_SubmitFileMoveWarning_Text;l.Link=Strings.STS.L_SubmitFileLinkWarning_Text;var d=Strings.STS.L_Send_Text,C=GetAttributeFromItemTable(itemTable,"Url","ServerUrl"),f,n,i;if(currentItemFileUrl!=null){n=unescapeProperly(currentItemFileUrl);if(!(window.OffSwitch==null||OffSwitch.IsActive("587EBAE9-3F96-405E-B02F-E1BE9A756777"))&&ShouldCallEncodeURIComponent()){f=encodeURIComponent(currentItemFileUrl);f=encodeScriptQuote(f)}else f=escapeProperly(n);i=SzExtension(n);if(i!=null&&i!="")i=i.toLowerCase()}var u=itemTable.getAttribute("SRed"),x=itemTable.getAttribute("DefaultIO");if(x=="0"&&!HasRights(0,32))x="1";var t=currentItemProgId!="SharePoint.WebPartPage.Document"&&!Boolean(a.RealHttpRoot)&&HasDownloadRights(u)&&i!="aspx",s=currentItemFSObjType!="1"&&a.listBaseType==1&&HasDownloadRights(u);if(!t&&!s)return;if(!isDocLibContextMenu){var e=null;if(!Boolean(a.RealHttpRoot)){e=CASubM(k,d,"","",String(WSS_MENUITEMSEQUENCE_SENDMENU));CUIInfo(e,"SendTo",["SendTo","PopulateSendToMenu"]);e.IsSubMenu=true;e.id="ID_Send";e.style.display="none"}var c;if(t){if(typeof a.SendToLocationName!="undefined"&&a.SendToLocationName!=null&&a.SendToLocationName!=""&&typeof a.SendToLocationUrl!="undefined"&&a.SendToLocationUrl!=null&&a.SendToLocationUrl!=""){var b="Nav.navigate('"+a.HttpRoot+"/_layouts/15/copy.aspx?SourceUrl="+f+"&FldUrl="+escapeProperly(a.SendToLocationUrl);b=AddSourceToUrl(b)+"')";c=CAMOpt(e,a.SendToLocationName,b,"");CUIInfo(c,"SendToRecommendedLocation",["SendToRecommendedLocation"])}if(typeof itemTable.getAttribute("HCD")!="undefined"&&itemTable.getAttribute("HCD")=="1"){d=Strings.STS.L_ExistingCopies_Text;b="Nav.navigate('"+a.HttpRoot+"/_layouts/15/updatecopies.aspx?SourceUrl="+f;b=AddSourceToUrl(b)+"')";var g=a.imagesPath+"existingLocations.gif";c=CIMOpt(e,d,b,g);c.id="ID_ExistingCopies";CUIInfo(c,"SendToExistingCopies",["SendToExistingCopies"])}}}if(!Boolean(a.RealHttpRoot)){if(isNewEcb&&!currentItemIsMountPoint&&!Boolean(a.RealHttpRoot)&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(329)&&a.listTemplate==700)AddMoveCopyMenuItem(k,r,a,p,q);else if(!y&&!hasFolderSelected(a)){d=Strings.STS.L_OtherLocation_Text;if(isNewEcb)d=Strings.STS.L_Copy_Text;b="NavigateToSendToOtherLocationV4(event, '"+a.HttpRoot+"/_layouts/15/copy.aspx?SourceUrl="+f;b=AddSourceToUrl(b)+"')";g=a.imagesPath+"sendOtherLoc.gif";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(p,q,"ID_OtherLocation",d,b,g,String(WSS_MENUITEMSEQUENCE_COPY));else{if(isNewEcb)c=InsertMenuOption(k,r,d,b,g,String(WSS_MENUITEMSEQUENCE_COPY));else c=CAMOpt(e,d,b,g);c.id="ID_OtherLocation";CUIInfo(c,"SendToOtherLocation",["SendToOtherLocation"])}if(typeof a.OfficialFileNames=="string"&&a.OfficialFileNames!=""){var o=a.OfficialFileNames.split("__HOSTSEPARATOR__");if(o!=null)for(var m=0;m<o.length;m++){var B=o[m],j=B.split(",");d=j[0];var A=0,z="Copy";if(j.length==3){d=j[0].replace(/%2c/g,",").replace(/%25/g,"%");A=j[1];z=j[2]}b='if(confirm("'+StBuildParam(l[z],STSScriptEncode(d))+"\")!=0) SubmitFormPost('"+a.HttpRoot+"/_layouts/15/SendToOfficialFile.aspx?ID="+escapeProperly(d)+"&Index="+String(A)+"&SourceUrl="+f;b=AddSourceToUrl(b)+"')";g="";c=CAMOpt(e,d,b,g);var w="SendToOfficialFile"+String(m);CUIInfo(c,w,[w])}}}!isNewEcb&&CAMSep(e)}if(s&&!y){var h=typeof ctx!="undefined"?ctx:a;if(h.listTemplate!=119){Boolean(e)&&AddWorkspaceMenuItem(e,null,h);var v=null;if(Boolean(h.RealHttpRoot)&&(v=ListModule.Util.makeMountedFolderQueryStrParams(false,false))!=null)b="Nav.navigate('"+h.RealHttpRoot+"/_layouts/15/download.aspx?SourceUrl="+f+v+"&FldUrl="+escapeProperly(h.SendToLocationUrl);else b="Nav.navigate('"+h.HttpRoot+"/_layouts/15/download.aspx?SourceUrl="+f+"&FldUrl="+escapeProperly(h.SendToLocationUrl);b=AddSourceToUrl(b)+"'); if (typeof CalloutManager !== 'undefined' && Boolean(CalloutManager) && Boolean(CalloutManager.closeAll)) CalloutManager.closeAll()";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(p,q,"ID_DownloadACopy",Strings.STS.L_Download_Text,b,"",String(WSS_MENUITEMSEQUENCE_DOWNLOADACOPY));else{if(isNewEcb)c=InsertMenuOption(k,r,Strings.STS.L_Download_Text,b,"",String(WSS_MENUITEMSEQUENCE_DOWNLOADACOPY));else c=CAMOpt(k,Strings.STS.L_DownloadACopy_Text,b,"");CUIInfo(c,"DownloadCopy",["DownloadCopy"]);c.id="ID_DownloadACopy"}}}}nction AddListMenuItems(f,i,b,g,h){if(typeof Custom_AddListMenuItems!="undefined")if(Custom_AddListMenuItems(f,b))return;if(currentItemFileUrl==null){currentItemFileUrl=GetAttributeFromItemTable(itemTable,"Url","ServerUrl");UpdateRibbonUrl()}var j;if(currentItemFileUrl!=null)if(ShouldCallEncodeURIComponent()){j=encodeURIComponent(currentItemFileUrl);if(!(window.OffSwitch==null||OffSwitch.IsActive("2AE13CDE-8329-47B8-AA4B-4AE3B97AC677")))j=j.replace(/'/g,"\\u0027")}else j=escapeProperly(unescapeProperly(currentItemFileUrl));var n=currentItemID;if(currentItemIsEventsExcp==null){currentItemIsEventsExcp=false;currentItemIsEventsDeletedExcp=false;currentItemEvtType=parseInt(itemTable.getAttribute("EventType"));if(currentItemEvtType!=null&&(currentItemEvtType==2||currentItemEvtType==3||currentItemEvtType==4)){currentItemIsEventsExcp=true;if(currentItemEvtType==3)currentItemIsEventsDeletedExcp=true;if(currentItemID.indexOf(".")!=-1)n=currentItemID.split(".")[0]}}var e,a,d;if(b.listBaseType==3&&b.listTemplate==108){var c=Strings.STS.L_Reply_Text;if(itemTable.getAttribute("Ordering").length>=504)a="alert('"+Strings.STS.L_ReplyLimitMsg_Text+"')";else{a="Nav.navigate('"+b.newFormUrl+"&Threading="+escapeProperly(itemTable.getAttribute("Ordering"))+"&Guid="+escapeProperly(itemTable.getAttribute("ThreadID"))+"&Subject="+escapeProperly(itemTable.getAttribute("Subject"));a=AddSourceToUrl(a)+"')"}d=b.imagesPath+"reply.gif";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(g,h,"ID_Reply",c,a,d,String(WSS_MENUITEMSEQUENCE_REPLY));else{if(isNewEcb)e=InsertMenuOption(f,i,c,a,d,String(WSS_MENUITEMSEQUENCE_REPLY));else e=CAMOpt(f,c,a,d,null,String(WSS_MENUITEMSEQUENCE_REPLY));e.id="ID_Reply"}}AddSharedNamespaceMenuItems(f,i,b,g,h);var m=itemTable.getAttribute("CId");if(m!=null&&m.indexOf("0x0106")==0&&HasRights(16,0)){c=Strings.STS.L_ExportContact_Text;a="Nav.navigate('"+b.HttpPath+"&Cmd=Display&CacheControl=1&List="+b.listName+"&ID="+currentItemID+"&Using="+escapeProperly(b.listUrlDir)+"/vcard.vcf')";d=b.imagesPath+"exptitem.gif";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(g,h,"ID_ExportContact",c,a,d,String(WSS_MENUITEMSEQUENCE_EXPORTCONTACT));else{if(isNewEcb)e=InsertMenuOption(f,i,c,a,d,String(WSS_MENUITEMSEQUENCE_EXPORTCONTACT));else e=CAMOpt(f,c,a,d,null,String(WSS_MENUITEMSEQUENCE_EXPORTCONTACT));CUIInfo(e,"ExportContact",["ExportContact"]);e.id="ID_ExportContact"}}!isNewEcb&&CAMSep(f);b.verEnabled==1&&AddVersionsMenuItem(f,i,b,j,g,h);if(HasRights(0,4)&&b.isModerated==true&&HasRights(0,16)&&HasRights(0,135168)&&b.listBaseType!=4&&currentItemID.indexOf(".0.")<0){c=Strings.STS.L_ModerateItem_Text;a="NavigateToApproveRejectAspx(event, '"+b.HttpRoot+"/_layouts/15/approve.aspx?List="+b.listName+"&ID="+n;a=AddSourceToUrl(a)+"')";d=b.imagesPath+"apprj.gif";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(g,h,"ID_ModerateItem",c,a,d,String(WSS_MENUITEMSEQUENCE_MODERATEITEM));else{if(isNewEcb)e=InsertMenuOption(f,i,c,a,d,String(WSS_MENUITEMSEQUENCE_MODERATEITEM));else e=CAMOpt(f,c,a,d,null,String(WSS_MENUITEMSEQUENCE_MODERATEITEM));CUIInfo(e,"Moderate",["Moderate"]);e.id="ID_ModerateItem"}}!isNewEcb&&CAMSep(f);var k=Number(b.SiteTemplateId)===64&&Number(b.listTemplate)===100;!k&&AddWorkflowsMenuItem(f,i,b,g,h);var l=typeof _spPageContextInfo!="undefined"&&_spPageContextInfo!=null&&_spPageContextInfo.alertsEnabled;if(currentItemID.indexOf(".0.")<0&&HasRights(128,0)&&!b.ExternalDataList&&l&&!currentItemIsMountPoint&&!k){c=Strings.STS.L_Subscribe_Text;a="NavigateToSubNewAspxV4(event, '"+b.HttpRoot+"', 'List="+b.listName+"&ID="+currentItemID+"')";d="";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(g,h,"ID_Subscribe",c,a,d,String(WSS_MENUITEMSEQUENCE_SUBSCRIBE));else{if(isNewEcb)e=InsertMenuOption(f,i,c,a,d,String(WSS_MENUITEMSEQUENCE_SUBSCRIBE));else e=CAMOpt(f,c,a,d,null,String(WSS_MENUITEMSEQUENCE_SUBSCRIBE));e.id="ID_Subscribe";CUIInfo(e,"Subscribe",["Subscribe"])}}if(l||!b.ExternalDataList&&HasRights(0,4))!isNewEcb&&CAMSep(f);!k&&AddManagePermsMenuItem(f,i,b,b.listName,currentItemID,g,h);if(currentItemID.indexOf(".0.")<0&&HasRights(0,8)&&!currentItemIsEventsExcp){if(b.listBaseType==4)c=Strings.STS.L_DeleteResponse_Text;else c=Strings.STS.L_DeleteItem_Text;a="DeleteListItem()";d=b.imagesPath+"delitem.gif";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(g,h,"ID_DeleteItem",c,a,d,String(WSS_MENUITEMSEQUENCE_DELETEITEM));else{if(isNewEcb)e=InsertMenuOption(f,i,c,a,d,String(WSS_MENUITEMSEQUENCE_DELETEITEM));else e=CAMOpt(f,c,a,d,null,String(WSS_MENUITEMSEQUENCE_DELETEITEM));e.id="ID_DeleteItem";CUIInfo(e,"Delete",["Delete"])}}var o=currentItemProgId!=null&&currentItemProgId!="";if(currentItemFSObjType=="1"&&!o&&HasRights(0,4)&&b.ContentTypesEnabled&&b.listTemplate!=108){c=Strings.STS.L_CustomizeNewButton_Text;a="Nav.navigate('"+b.HttpRoot+"/_layouts/15/ChangeContentTypeOrder.aspx?List="+b.listName+"&RootFolder="+j;a=AddSourceToUrl(a)+"')";d="";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(g,h,"ID_CustomizeNewButton",c,a,d,String(WSS_MENUITEMSEQUENCE_CUSTOMIZENEWBUTTON));else{if(isNewEcb)e=InsertMenuOption(f,i,c,a,d,String(WSS_MENUITEMSEQUENCE_CUSTOMIZENEWBUTTON));else e=CAMOpt(f,c,a,d,null,String(WSS_MENUITEMSEQUENCE_CUSTOMIZENEWBUTTON));CUIInfo(e,"ChangeNewButton",["ChangeNewButton"]);e.id="ID_CustomizeNewButton"}}_ContextForShowingShareDialog=b;a="DisplaySharingDialogFromEcb('"+currentItemID+"')";c=Strings.STS.L_Share_Text;if(isDocLibContextMenu)InsertItemToContextMenuDefinition(g,h,"ID_Share",c,a,d,String(WSS_MENUITEMSEQUENCE_SHARE));else{e=InsertMenuOption(f,i,c,a,d,String(WSS_MENUITEMSEQUENCE_SHARE));e.id="ID_Share"}}function ReplaceUrlTokens(c,e,i){var d;if(c==null||c==""){c="";return c}if(currentItemID!=null)c=c.replace(/{ItemId}/g,currentItemID);var a=null,b=null,f=c.indexOf("?");if(-1!=f&&f+2<c.length){a=c.substr(f+1);b=c.substr(0,f+1)}else b=c;if(currentItemFileUrl!=null){if(null!=a){var k=false,g=false;if(!(window.OffSwitch==null||OffSwitch.IsActive("D8D402DA-D1D9-4385-8122-53F9FEB1270A")))g=b==="{SiteUrl}/_layouts/15/WopiFrame.aspx?"||b==="{SiteUrl}/_layouts/15/Doc.aspx?";else g=b==="{SiteUrl}/_layouts/15/WopiFrame.aspx?";if(!(window.OffSwitch==null||OffSwitch.IsActive("82DEE36B-7B9A-48D7-96F0-6E475DB54C9A"))&&Boolean(i)&&g&&a.indexOf("sourcedoc={ItemUrl}")===0){var l=new URI(i),j=l.getQueryParameter("sourcedoc");if(Boolean(j)){a=a.replace(/{ItemUrl}/g,encodeURIComponent(j));k=true}}if(!k){if(ShouldCallEncodeURIComponent())d=encodeURIComponent(currentItemFileUrl);else d=escapeProperly(unescapeProperly(currentItemFileUrl));a=a.replace(/{ItemUrl}/g,d)}}b=b.replace(/{ItemUrl}/g,currentItemFileUrl)}if(e.HttpRoot!=null){if(null!=a){d=escapeProperly(unescapeProperly(e.HttpRoot));a=a.replace(/{SiteUrl}/g,d)}b=b.replace(/{SiteUrl}/g,e.HttpRoot)}if(e.listName!=null){if(null!=a){d=escapeProperly(e.listName);a=a.replace(/{ListId}/g,d)}b=b.replace(/{ListId}/g,e.listName)}if(e.listUrlDir!=null){if(null!=a){if(ShouldCallEncodeURIComponent())d=encodeURIComponent(e.listUrlDir);else d=escapeProperly(unescapeProperly(e.listUrlDir));a=a.replace(/{ListUrlDir}/g,d)}b=b.replace(/{ListUrlDir}/g,e.listUrlDir)}var h=Nav.getSource();b=b.replace(/{Source}/g,h);if(a!=null)if(b.length+a.length+h.length>1950)a=a.replace(/{Source}/g,"");else a=a.replace(/{Source}/g,h);return null==a?b:b+a}var SYSTEM_ACCOUNT_ID;unction InsertFeatureMenuItems(A,L,b,H,J){!isNewEcb&&CAMSep(A);var k=GetAttributeFromItemTable(itemTable,"Ext","FileType"),l=GetAttributeFromItemTable(itemTable,"Type","HTMLType"),i=GetAttributeFromItemTable(itemTable,"CId","ContentTypeId"),o=null,m=null,s=ecbItems,E=Boolean(b.CurrentSelectedItems>1);if(b!=null){o=String(b.listTemplate);if(null!=b.listName&&0<b.listName.length){m=b.listName.toLowerCase();s=s+"_"+m}}if(k!=null)k=k.toLowerCase();if(l!=null)l=l.toLowerCase();if(i!=null)i=i.toLowerCase();var p,q=document.getElementById(s),h=new Array(0),a=null,e=0,w=[];if(q!=null&&!E)for(var r=0;r<q.childNodes.length;r++){var d=q.childNodes[r],I=GetInnerText(d.childNodes[5]),K=GetInnerText(d.childNodes[6]),F=parseInt(GetInnerText(d.childNodes[3])),G=parseInt(GetInnerText(d.childNodes[4]));if(!UseCustomAction(I,K,F,G,k,l,i,o,m))continue;a={};a.Title=GetInnerText(d.childNodes[0]);a.ImageUrl=GetInnerText(d.childNodes[1]);a.Action=GetInnerText(d.childNodes[2]);a.Sequence=parseInt(GetInnerText(d.childNodes[7]));var j=GetInnerText(d.childNodes[8]);a.ProductId=j.length>0?j:null;a.FromTenantApp=false;if(j!=null&&j.length>0)w[j]=true;h.push(a)}var x=GetTenantAppData();if(x!=null){var z=x.apps;for(e=0;e<z.length;e++)for(var u=z[e],v=0;v<u.customActions.length;v++)try{a=u.customActions[v];if(!UseCustomAction(a.registrationType,a.registrationId,parseInt(a.rightsHigh),parseInt(a.rightsLow),k,l,i,o,m))continue;if(typeof w[a.productId]!="undefined")continue;var g={};g.Title=a.title;g.ImageUrl=a.imageUrl;g.Action=a.action;g.Sequence=parseInt(a.sequence);g.ProductId=a.productId;g.FromTenantApp=true;g.AppTitle=u.title;h.push(g)}catch(M){throw M;}}var C=itemTable.getAttribute("SRed"),B=HandleWopiActions(h);for(e=0;e<h.length;e++){a=h[e];if(currentItemFSObjType=="1"&&a.Title==Strings.STS.L_CalloutFollowAction)continue;if(a.Title==Strings.STS.L_CalloutFollowAction&&(b.listTemplate==171||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)&&currentItemIsMountPoint||Boolean(b.RealHttpRoot)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(424)&&window.groupContextData!=null||!window.IsSPSocialSwitchEnabled||IsSPSocialSwitchEnabled()!=true))continue;if(a.Sequence==898&&Boolean(b.RealHttpRoot))continue;var f=ReplaceUrlTokens(a.Action,b,C),c=null;if(a.FromTenantApp){if(f.startsWith("javascript:LaunchApp"))c=f;else if(f.substr(0,11)!="javascript:")c="window.open('"+STSScriptEncode(f)+"', '_blank')"}else if(f.substr(0,11)=="javascript:")c=f;else c="window.open('"+STSScriptEncode(f)+"', '_blank')";if(h[e].Sequence==WSS_MENUITEMSEQUENCE_EDITINBROWSER){var t=GetSourceDocId(f);if(t!=null&&t.length>0)c="addWopiPerfMarkEx(null, 1,'"+t+"'); "+c}if(c!=null){var n="";if(isNewEcb)if(IsWopiViewAction(a))if(B)n="none";var y="ID_CA_"+a.Title;if(isDocLibContextMenu)InsertItemToContextMenuDefinition(H,J,y,a.Title,c,a.ImageUrl,String(a.Sequence),"display:"+n);else{var D=a.ImageUrl==null?null:ReplaceUrlTokens(a.ImageUrl,b);p=InsertMenuOption(A,L,a.Title,c,D,String(a.Sequence));p.id=y;if(n!="")p.style.display=n}}}}nction IsWopiEditAction(a){return!(window.OffSwitch==null||OffSwitch.IsActive("D8D402DA-D1D9-4385-8122-53F9FEB1270A"))?(a.Action.indexOf("WopiFrame")!=-1||a.Action.indexOf("Doc.aspx")!=-1)&&a.Action.indexOf("action=edit")!=-1:a.Action.indexOf("WopiFrame")!=-1&&a.Action.indexOf("action=edit")!=-1}function HasDownloadRights(a){return!(window.OffSwitch==null||OffSwitch.IsActive("C2418980-1076-4635-9436-2063B32E1F39"))?HasRights(0,32)||(a==null||a=="")&&!HasRights(65536,0):a==null||a==""||HasRights(0,32)}n UpdateRibbonUrl(){if(!(window.OffSwitch==null||OffSwitch.IsActive("19BBD588-AD5E-4187-B25E-44AA99396C92"))&&ShouldCallEncodeURIComponent())if(Boolean(itemTable.getAttribute("onmouseover"))){currentItemFileUrl=currentItemFileUrl.replace(/%23/g,"#");currentItemFileUrl=currentItemFileUrl.replace(/%26/g,"&");currentItemFileUrl=decodeURI(currentItemFileUrl)}}function AddSharedNamespaceMenuItems(h,m,a,k,l){var p=GetRootFolder(a);setupMenuContext(a);if(currentItemFileUrl==null){currentItemFileUrl=GetAttributeFromItemTable(itemTable,"Url","ServerUrl");UpdateRibbonUrl()}if(currentItemFSObjType==null)currentItemFSObjType=String(parseInt(GetAttributeFromItemTable(itemTable,"OType","FSObjType")));if(currentItemContentTypeId==null)currentItemContentTypeId=GetAttributeFromItemTable(itemTable,"CId","ContentTypeId");if(currentItemModerationStatus==null)currentItemModerationStatus=GetAttributeFromItemTable(itemTable,"MS","MStatus");if(currentItemCheckedOutUserId==null)currentItemCheckedOutUserId=itemTable.getAttribute("COUId");if(currentItemCheckedoutToLocal==null)currentItemCheckedoutToLocal=GetAttributeFromItemTable(itemTable,"COut","IsCheckedoutToLocal ");if(currentItemCheckedoutToLocal!="1")currentItemCheckedoutToLocal="0";bIsCheckout=0;if(a.isForceCheckout==true&&currentItemCheckedOutUserId==""&&currentItemFSObjType!="1")bIsCheckout=1;var q;if(currentItemFileUrl!=null)q=escapeProperly(unescapeProperly(currentItemFileUrl));if(Boolean(a.RealHttpRoot))return;if(!Boolean(ctx.CurrentSelectedItems>1)){var r=currentItemCheckedOutUserId==String(SYSTEM_ACCOUNT_ID)&&a.CurrentUserId!=String(SYSTEM_ACCOUNT_ID),d,c,b,e;if(a.listBaseType==1)if(isNewEcb)c=Strings.STS.L_Properties_Text;else c=Strings.STS.L_ViewProperties_Text;else if(a.listBaseType==4)c=Strings.STS.L_ViewResponse_Text;else c=Strings.STS.L_ViewItem_Text;var i="";if(currentItemContentTypeId!=null&&currentItemContentTypeId!="")i="&ContentTypeID="+currentItemContentTypeId;var g="&";if(a.displayFormUrl.indexOf("?")==-1)g="?";var j=a.displayFormUrl+g+"ID="+currentItemID+i;j=AddSourceToUrl(j)+p;if(301==a.listTemplate)b="EditItem('"+j+"')";else b="EditItem2(event, '"+STSScriptEncode(j)+"')";var f;if(a.listBaseType==1)f="ID_ViewProperties";else f="ID_ViewItem";var n="",o=HasRights(0,4)&&!r&&!currentItemIsEventsDeletedExcp;if(o)if(isNewEcb&&a.listBaseType==1)n="none";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(k,l,f,c,b,e,String(WSS_MENUITEMSEQUENCE_VIEWPROPERTIES),"display:"+n);else{if(isNewEcb)d=InsertMenuOption(h,m,c,b,e,String(WSS_MENUITEMSEQUENCE_VIEWPROPERTIES));else d=CAMOpt(h,c,b,e,null,String(WSS_MENUITEMSEQUENCE_VIEWPROPERTIES));CUIInfo(d,"ViewProperties",["ViewProperties"]);d.id=f;d.style.display=n}if(o){if(a.listBaseType==1)if(isNewEcb)c=Strings.STS.L_Rename_Text;else c=Strings.STS.L_EditProperties_Text;else if(a.listBaseType==4)c=Strings.STS.L_EditResponse_Text;else c=Strings.STS.L_EditItem_Text;g="&";if(a.editFormUrl.indexOf("?")==-1)g="?";if(a.listBaseType==1){b="EditItemWithCheckoutAlert(event, '"+a.editFormUrl+g+"ID="+currentItemID+i;b=AddSourceToUrl(b)+p+"',"+String(bIsCheckout)+",'"+currentItemCheckedoutToLocal+"','"+STSScriptEncode(currentItemFileUrl)+"','"+a.HttpRoot+"')"}else if(FV4UI())b="EditItem2(event, '"+STSScriptEncode(a.editFormUrl)+g+"ID="+currentItemID+i+"')";else{b="EditItem('"+a.editFormUrl+g+"ID="+currentItemID+i;b=AddSourceToUrl(b)+"')"}e=a.imagesPath+"edititem.gif";if(a.listBaseType==1)f="ID_EditProperties";else f="ID_EditItem";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(k,l,f,c,b,e,String(WSS_MENUITEMSEQUENCE_EDITPROPERTIES));else{if(isNewEcb)d=InsertMenuOption(h,m,c,b,e,String(WSS_MENUITEMSEQUENCE_EDITPROPERTIES));else d=CAMOpt(h,c,b,e,null,String(WSS_MENUITEMSEQUENCE_EDITPROPERTIES));d.id=f;CUIInfo(d,"EditProperties",["EditProperties"])}if(a.listBaseType==1)if(isNewEcb){c=Strings.STS.L_Properties_Text;f="ID_ViewProperties";if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(250))b="EditItem('"+j+"')";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(k,l,f,c,b,e,String(WSS_MENUITEMSEQUENCE_VIEWPROPERTIES));else{d=InsertMenuOption(h,m,c,b,e,String(WSS_MENUITEMSEQUENCE_VIEWPROPERTIES));d.id=f}}if(a.listTemplate==106&&currentItemID.indexOf(".0.")>0){var t=currentItemID.indexOf(".0."),s=currentItemID.substr(0,t);c=Strings.STS.L_EditSeriesItem_Text;b="EditItem2(event, '"+STSScriptEncode(a.editFormUrl)+g+"ID="+s+i;b=AddSourceToUrl(b)+"')";e=a.imagesPath+"recurrence.gif";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(k,l,"ID_EditSeriesItem",c,b,e,String(WSS_MENUITEMSEQUENCE_EDITSERIESITEM));else{if(isNewEcb)d=InsertMenuOption(h,m,c,b,e,String(WSS_MENUITEMSEQUENCE_EDITSERIESITEM));else d=CAMOpt(h,c,b,e,null,String(WSS_MENUITEMSEQUENCE_EDITSERIESITEM));CUIInfo(d,"EditSeriesItem",["EditSeriesItem"]);d.id="ID_EditSeriesItem"}}}}}nction AddSolutionMenuActivate(e,d,a,b){if(typeof window.SPUserCanManageSolutions=="boolean"&&window.SPUserCanManageSolutions==true)if(isDocLibContextMenu){var c="if(event){event.currentItemID="+currentItemID+';}RunSolutionOperation(event, "ACT")';InsertItemToContextMenuDefinition(a,b,"ID_ActivateSolution",Strings.STS.L_ActivateSolution_Text,c,"",String(WSS_MENUITEMSEQUENCE_ACTIVATESOLUTION))}else AddSolutionMenuHelper(e,d,Strings.STS.L_ActivateSolution_Text,"ACT","",WSS_MENUITEMSEQUENCE_ACTIVATESOLUTION,"ActivateSolution","ID_ActivateSolution")}function AddSolutionMenuDeactivate(e,d,a,b){if(typeof window.SPUserCanManageSolutions=="boolean"&&window.SPUserCanManageSolutions==true)if(isDocLibContextMenu){var c="if(event){event.currentItemID="+currentItemID+';}RunSolutionOperation(event, "DEA")';InsertItemToContextMenuDefinition(a,b,"ID_DeactivateSolution",Strings.STS.L_DeactivateSolution_Text,c,"",String(WSS_MENUITEMSEQUENCE_DEACTIVATESOLUTION))}else AddSolutionMenuHelper(e,d,Strings.STS.L_DeactivateSolution_Text,"DEA","",WSS_MENUITEMSEQUENCE_DEACTIVATESOLUTION,"DeactivateSolution","ID_DeactivateSolution")}ction AddDocLibMenuItems(e,g,a,h,i){if(typeof window.Custom_AddDocLibMenuItems!="undefined")if(window.Custom_AddDocLibMenuItems(e,a))return;var j=Boolean(ctx.CurrentSelectedItems>1),t=GetRootFolder(a),d,c,b,f;if(currentItemIsMountPoint==null)currentItemIsMountPoint=IsSelectedItemMountPoint(a);AddSharedNamespaceMenuItems(e,g,a,h,i);var k;if(currentItemFileUrl!=null)if(ShouldCallEncodeURIComponent()){k=encodeURIComponent(currentItemFileUrl);if(!(window.OffSwitch==null||OffSwitch.IsActive("6BA2FDF8-BFCE-44AF-BCDC-DA55BB740F7E")))k=k.replace(/'/g,"\\u0027")}else k=escapeProperly(unescapeProperly(currentItemFileUrl));var o=itemTable.getAttribute("SRed"),l=currentItemCheckedOutUserId==String(SYSTEM_ACCOUNT_ID)&&a.CurrentUserId!=String(SYSTEM_ACCOUNT_ID);if(HasRights(0,4)&&HasRights(16,0)&&!l&&HasDownloadRights(o)&&!j&&!currentItemIsMountPoint&&!(isNewEcb&&_shouldOpenInLightbox(currentItemFileUrl)))if(!Boolean(a.isWebEditorPreview)&&a.listBaseType==1)if(a.listTemplate!=119){setDocType();if(currentItemAppName!=""&&currentItemOpenControl!="")if(!(a.IsAppWeb&&currentItemProgId==SPDesignerProgID)){c="";if(currentItemAppName!=" ")if(isNewEcb)c=StBuildParam(Strings.STS.L_OpenIn_Text,currentItemAppName);else c=StBuildParam(Strings.STS.L_EditIn_Text,currentItemAppName);else{var r=StsOpenEnsureEx2(currentItemOpenControl+".3");if(r!=null)if(isNewEcb)c=Strings.STS.L_OpenInApplication_Text;else c=Strings.STS.L_EditInApplication_Text}if(c!=""){if(Boolean(a.RealHttpRoot)&&currentItemFileUrl.length>0&&currentItemFileUrl.charAt(0)=="/")currentItemFileUrl=getHostUrl(a.HttpRoot)+currentItemFileUrl;b="editDocumentWithProgID2('"+STSScriptEncode(currentItemFileUrl)+"', '"+currentItemProgId+"', '"+currentItemOpenControl+"', '"+String(bIsCheckout)+"', '"+a.HttpRoot+"', '"+currentItemCheckedoutToLocal+"', '"+currentItemOpenApp+"')";f=a.imagesPath+currentItemIcon;if(isDocLibContextMenu)InsertItemToContextMenuDefinition(h,i,"ID_EditIn_"+currentItemAppName,c,b,f,String(WSS_MENUITEMSEQUENCE_EDITINAPPLICATION));else{if(isNewEcb)d=InsertMenuOption(e,g,c,b,f,String(WSS_MENUITEMSEQUENCE_EDITINAPPLICATION));else d=CAMOpt(e,c,b,f,null,String(WSS_MENUITEMSEQUENCE_EDITINAPPLICATION));d.id="ID_EditIn_"+currentItemAppName;if(!isNewEcb)d.style.cssText="display:none";CUIInfo(d,"EditDocument",["EditDocument"])}}}}if(isNewEcb&&!j){if(_shouldOpenInLightbox(currentItemFileUrl)){c=Strings.STS.L_OpenInApplication_Text;b='_openInLightbox("'+currentItemFileUrl+'");';f="";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(h,i,"ID_OPENINLIGHTBOX",c,b,f,String(WSS_MENUITEMSEQUENCE_EDITINAPPLICATION));else{d=InsertMenuOption(e,g,c,b,f,String(WSS_MENUITEMSEQUENCE_EDITINAPPLICATION));d.id="ID_OPENINLIGHTBOX"}}if(currentItemFSObjType=="1"&&currentItemProgId===""){c=Strings.STS.L_OpenInApplication_Text;var n=itemTable.querySelector('a[class*="ms-listlink"]');if(isDocLibContextMenu&&Boolean(n)){b="Nav.navigate('"+n.href+"');";InsertItemToContextMenuDefinition(h,i,"ID_OpenFolder",c,b,"",String(WSS_MENUITEMSEQUENCE_OPENFOLDER))}}_ContextForShowingShareDialog=a;b="DisplaySharingDialogFromEcb('"+currentItemID+"')";c=Strings.STS.L_Share_Text;if(isDocLibContextMenu)InsertItemToContextMenuDefinition(h,i,"ID_Share",c,b,f,String(WSS_MENUITEMSEQUENCE_SHARE));else{d=InsertMenuOption(e,g,c,b,f,String(WSS_MENUITEMSEQUENCE_SHARE));d.id="ID_Share"}b="DisplaySharingDialogFromEcb('"+currentItemID+"', 1); SP.QoS.WriteUserEngagement('SharingUserClickedGetLinkContextMenuItem');";c=Strings.STS.L_GetLink_Text;if(isDocLibContextMenu)InsertItemToContextMenuDefinition(h,i,"ID_GetLink",c,b,f,String(WSS_MENUITEMSEQUENCE_GETLINK));else{d=InsertMenuOption(e,g,c,b,f,String(WSS_MENUITEMSEQUENCE_GETLINK));d.id="ID_GetLink"}SP.QoS.WriteStart("SharingAddedGetLinkContextMenuItem")}!currentItemIsMountPoint&&!isNewEcb&&CAMSep(e);if(HasRights(0,4)&&!currentItemIsMountPoint)if(j&&!hasFolderSelected(a)||!j&&currentItemFSObjType!="1")a.listBaseType==1&&AddCheckinCheckoutMenuItem(e,g,a,k,h,i);(a.verEnabled==1||a.isModerated)&&!j&&currentItemFSObjType!="1"&&!currentItemIsMountPoint&&AddVersionsMenuItem(e,g,a,k,h,i);if(HasRights(0,4)&&!currentItemIsMountPoint&&!Boolean(a.RealHttpRoot))if(a.isModerated==true&&HasRights(0,16)&&((currentItemModerationStatus==String(2)||!a.EnableMinorVersions)&&currentItemCheckedOutUserId==""||currentItemFSObjType=="1")){c=Strings.STS.L_ModerateItem_Text;b="NavigateToApproveRejectAspx(event, '"+a.HttpRoot+"/_layouts/15/approve.aspx?List="+a.listName+"&ID="+currentItemID;b=AddSourceToUrl(b)+GetRootFolder(a)+"')";f=a.imagesPath+"apprj.gif";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(h,i,"ID_ModerateItem",c,b,f,String(WSS_MENUITEMSEQUENCE_MODERATEITEM));else{if(isNewEcb)d=InsertMenuOption(e,g,c,b,f,String(WSS_MENUITEMSEQUENCE_MODERATEITEM));else d=CAMOpt(e,c,b,f,null,String(WSS_MENUITEMSEQUENCE_MODERATEITEM));CUIInfo(d,"Moderate",["Moderate"]);d.id="ID_ModerateItem"}}!currentItemIsMountPoint&&!isNewEcb&&CAMSep(e);if(!currentItemIsMountPoint&&!Boolean(a.RealHttpRoot)){!j&&AddWorkflowsMenuItem(e,g,a,h,i);(!isNewEcb||currentItemFSObjType=="1")&&AddMoveCopyMenuItem(e,g,a,h,i)}if(currentItemFSObjType!="1"){if(a.PortalUrl!=null&&!Boolean(a.RealHttpRoot)&&!j){c=Strings.STS.L_AddToMyLinks_Text;b="Portal_Tasks('PinToMyPage')";f="";if(!isDocLibContextMenu){if(isNewEcb)d=InsertMenuOption(e,g,c,b,f,String(WSS_MENUITEMSEQUENCE_ADDTOMYLINKS));else d=CAMOpt(e,c,b,f,null,String(WSS_MENUITEMSEQUENCE_ADDTOMYLINKS));CUIInfo(d,"AddToMyLinks",["AddToMyLinks"]);d.id="ID_AddToMyLinks";d.style.display="none"}}}else a.listBaseType==1&&HasRights(16,0)&&!Boolean(a.RealHttpRoot)&&!j&&AddWorkOfflineMenuItem(e,g,a,currentItemFileUrl,h,i);if(HasRights(128,0)&&typeof _spPageContextInfo!="undefined"&&_spPageContextInfo!=null&&typeof _spPageContextInfo.alertsEnabled=="boolean"&&_spPageContextInfo.alertsEnabled&&!j){c=Strings.STS.L_Subscribe_Text;b="NavigateToSubNewAspxV4(event, '"+a.HttpRoot+"', 'List="+a.listName+"&ID="+currentItemID+"')";f="";if(!isDocLibContextMenu){if(isNewEcb)d=InsertMenuOption(e,g,c,b,f,String(WSS_MENUITEMSEQUENCE_SUBSCRIBE));else d=CAMOpt(e,c,b,f,null,String(WSS_MENUITEMSEQUENCE_SUBSCRIBE));CUIInfo(d,"Subscribe",["Subscribe"]);d.id="ID_Subscribe";d.style.display="none"}}if(currentItemFSObjType!="1"&&!currentItemIsMountPoint){AddSendSubMenu(e,g,a,h,i);if(!Boolean(a.RealHttpRoot)){AddGotoSourceItemMenuItem(e,g,a,itemTable,currentItemFSObjType,h,i);AddDocTransformSubMenu(e,a)}}!currentItemIsMountPoint&&!isNewEcb&&CAMSep(e);AddManagePermsMenuItem(e,g,a,a.listName,currentItemID,h,i);if(HasRights(0,8)&&!l&&!currentItemIsMountPoint){c=Strings.STS.L_DeleteDocItem_Text;var m="false";if(typeof itemTable.getAttribute("CSrc")!="undefined"&&itemTable.getAttribute("CSrc")!=null&&itemTable.getAttribute("CSrc")!="")m="true";if((Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(160))&&Boolean(a.RealHttpRoot))b="DeleteDocLibItemCSOM('"+currentItemID+"', "+m+")";else b="DeleteDocLibItem('"+a.HttpPath+"&Cmd=Delete&List="+a.listName+"&ID="+currentItemID+"&owsfileref="+k+"&NextUsing="+Nav.getSource()+"',"+m+")";b+="; if (typeof CalloutManager !== 'undefined' && Boolean(CalloutManager) && Boolean(CalloutManager.closeAll)) CalloutManager.closeAll()";f=a.imagesPath+"delitem.gif";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(h,i,"ID_DeleteDocItem",c,b,f,String(WSS_MENUITEMSEQUENCE_DELETEDOCITEM));else{if(isNewEcb)d=InsertMenuOption(e,g,c,b,f,String(WSS_MENUITEMSEQUENCE_DELETEDOCITEM));else d=CAMOpt(e,c,b,f,null,String(WSS_MENUITEMSEQUENCE_DELETEDOCITEM));d.id="ID_DeleteDocItem";CUIInfo(d,"Delete",["Delete"])}}if(HasRights(0,4)&&currentItemFSObjType=="1"&&a.ContentTypesEnabled&&a.listTemplate!=108&&!currentItemIsMountPoint&&!j){c=Strings.STS.L_CustomizeNewButton_Text;b="Nav.navigate('"+a.HttpRoot+"/_layouts/15/ChangeContentTypeOrder.aspx?List="+a.listName+"&RootFolder="+k;b=AddSourceToUrl(b)+"')";f="";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(h,i,"ID_CustomizeNewButton",c,b,f,String(WSS_MENUITEMSEQUENCE_CUSTOMIZENEWBUTTON));else{if(isNewEcb)d=InsertMenuOption(e,g,c,b,f,String(WSS_MENUITEMSEQUENCE_CUSTOMIZENEWBUTTON));else d=CAMOpt(e,c,b,f,null,String(WSS_MENUITEMSEQUENCE_CUSTOMIZENEWBUTTON));CUIInfo(d,"ChangeNewButton",["ChangeNewButton"]);d.id="ID_CustomizeNewButton"}}if(Boolean(a.ListSchema)&&Boolean(a.ListSchema.RmsSupportedExtensions)){var s=itemTable.getAttribute("ext").toLowerCase(),p=a.ListSchema.RmsSupportedExtensions.toLowerCase().split(","),q=p.indexOf(s)>-1;q&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(524)&&HasRights(0,4)&&!currentItemIsMountPoint&&!j&&!l&&currentItemFSObjType!="1"&&a.listBaseType==1&&AddEncryptMenuItem(e,g,a,k,h,i)}}var _ContextForShowingShareDialog;unction AddManagePermsMenuItem(g,e,a,d,f,b,c){if(!HasRights(0,131072)||currentItemIsEventsExcp||a.ExternalDataList||currentItemEvtType==5)return;AddSharedWithMenuItem(g,e,a,d,f,b,c)}ion AddCheckinCheckoutMenuItem(f,j,a,g,h,i){var e,c,d,b;if(!HasRights(0,4))return;if(currentItemCheckedOutUserId==String(SYSTEM_ACCOUNT_ID)&&a.CurrentUserId!=String(SYSTEM_ACCOUNT_ID))return;if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(424)&&window.groupContextData!=null)return;if(currentItemCheckedOutUserId==null)currentItemCheckedOutUserId=itemTable.getAttribute("COUId");if(currentItemCheckedOutUserId!=""){if(currentItemCheckedOutUserId==a.CurrentUserId||a.CurrentUserId==null||HasRights(0,256)){c=Strings.STS.L_Checkin_Text;if(!FV4UI())b="NavigateToCheckinAspx('"+a.HttpRoot+"', 'List="+a.listName+"&FileName="+g+"')";else b="CheckInSingleItemFromECB(event, currentCtx, itemTable)";d=a.imagesPath+"checkin.gif";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(h,i,"ID_Checkin",c,b,d,String(WSS_MENUITEMSEQUENCE_CHECKINCHECKOUT));else{if(isNewEcb)e=InsertMenuOption(f,j,c,b,d,String(WSS_MENUITEMSEQUENCE_CHECKINCHECKOUT));else e=CAMOpt(f,c,b,d,null,String(WSS_MENUITEMSEQUENCE_CHECKINCHECKOUT));e.id="ID_Checkin";CUIInfo(e,"CheckIn",["CheckIn"])}c=Strings.STS.L_DiscardCheckou_Text;b="UnDoCheckOutwithNotification('"+a.HttpRoot+"', '"+g+"', currentCtx, '"+STSScriptEncode(currentItemID)+"')";d=a.imagesPath+"unchkout.gif";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(h,i,"ID_DiscardCheckou",c,b,d,String(WSS_MENUITEMSEQUENCE_DISCARDCHECKOU));else{if(isNewEcb)e=InsertMenuOption(f,j,c,b,d,String(WSS_MENUITEMSEQUENCE_DISCARDCHECKOU));else e=CAMOpt(f,c,b,d,null,String(WSS_MENUITEMSEQUENCE_DISCARDCHECKOU));e.id="ID_DiscardCheckou";CUIInfo(e,"DiscardCheckOut",["DiscardCheckOut"])}}}else if(typeof g_disableCheckoutInEditMode=="undefined"||!g_disableCheckoutInEditMode){c=Strings.STS.L_Checkout_Text;currentItemOpenControl==""&&setDocType();var p="",n=itemTable.getAttribute("SRed");if(HasDownloadRights(n)){if(!FV4UI())b="CheckoutDocument('"+a.HttpRoot+"', '"+g+"', '"+p+"')";else b="CheckoutSingleItemFromECB(currentCtx, itemTable)";d=a.imagesPath+"checkout.gif";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(h,i,"ID_Checkout",c,b,d,String(WSS_MENUITEMSEQUENCE_CHECKINCHECKOUT));else{if(isNewEcb)e=InsertMenuOption(f,j,c,b,d,String(WSS_MENUITEMSEQUENCE_CHECKINCHECKOUT));else e=CAMOpt(f,c,b,d,null,String(WSS_MENUITEMSEQUENCE_CHECKINCHECKOUT));e.id="ID_Checkout";CUIInfo(e,"CheckOut",["CheckOut"])}}if(currentItemModerationStatus==null)currentItemModerationStatus=GetAttributeFromItemTable(itemTable,"MS","MStatus");if(a.EnableMinorVersions){if(currentItemUIString==null)currentItemUIString=GetAttributeFromItemTable(itemTable,"UIS","UIString");var o=parseInt(currentItemUIString)%512,k=null;if((currentItemModerationStatus==String(1)||currentItemModerationStatus==String(3))&&a.isModerated||!a.isModerated&&o!=0){c=Strings.STS.L_PublishItem_Text;if(Boolean(a.RealHttpRoot)&&(k=ListModule.Util.makeMountedFolderQueryStrParams(true,false))!=null)b="PublishMajorVersion(event, '"+a.RealHttpRoot+"', 'List="+a.listName+"&FileName="+g+"&Publish=true"+k+"')";else b="PublishMajorVersion(event, '"+a.HttpRoot+"', 'List="+a.listName+"&FileName="+g+"&Publish=true')";d=a.imagesPath+"pubmajor.gif";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(h,i,"ID_PublishItem",c,b,d,String(WSS_MENUITEMSEQUENCE_PUBLISHITEM));else{if(isNewEcb)e=InsertMenuOption(f,j,c,b,d,String(WSS_MENUITEMSEQUENCE_PUBLISHITEM));else e=CAMOpt(f,c,b,d,null,String(WSS_MENUITEMSEQUENCE_PUBLISHITEM));CUIInfo(e,"Publish",["Publish"]);e.id="ID_PublishItem"}}else{var m,l=false;if(!a.isModerated||currentItemModerationStatus==String(0)){c=Strings.STS.L_UnPublishItem_Text;m="ID_UnPublishItem";d=a.imagesPath+"unpub.gif"}else{c=Strings.STS.L_CancelPublish_Text;m="ID_CancelPublish";d=a.imagesPath+"unapprv.gif";l=true}if(Boolean(a.RealHttpRoot)&&(k=ListModule.Util.makeMountedFolderQueryStrParams(true,false))!=null)b="UnPublish('"+a.RealHttpRoot+"', 'FileName="+g+"&UnPublish=true"+k+"',"+String(l)+")";else b="UnPublish('"+a.HttpRoot+"', 'FileName="+g+"&UnPublish=true',"+String(l)+")";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(h,i,m,c,b,d,String(WSS_MENUITEMSEQUENCE_CANCELPUBLISH));else{if(isNewEcb)e=InsertMenuOption(f,j,c,b,d,String(WSS_MENUITEMSEQUENCE_CANCELPUBLISH));else e=CAMOpt(f,c,b,d,null,String(WSS_MENUITEMSEQUENCE_CANCELPUBLISH));if(l)CUIInfo(e,"CancelApproval",["CancelApproval"]);else CUIInfo(e,"Unpublish",["Unpublish"]);e.id=m}}}}}nction AddEncryptMenuItem(e,h,d,i,f,g){var a,b=Strings.STS.L_Encrypt_Text,c="NavigateToFileIRMAspx(event, '"+d.HttpRoot+"', 'list="+d.listName+"&ID="+currentItemID+"&FileLevel=true')";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(f,g,"ID_Encrypt",b,c,"",String(WSS_MENUITEMSEQUENCE_ENCRYPTITEM));else{if(isNewEcb)a=InsertMenuOption(e,h,b,c,"",String(WSS_MENUITEMSEQUENCE_ENCRYPTITEM));else a=CAMOpt(e,b,c,"",null,String(WSS_MENUITEMSEQUENCE_ENCRYPTITEM));CUIInfo(a,"Encrypt",["Encrypt"]);a.id="ID_Encrypt"}}tion NavigateToApproveRejectAspx(b,a){if(FV4UI())ShowInPopUI(b,currentCtx,a);else Nav.navigate(a)}function PublishMajorVersion(d,b,c){var a=b+"/_layouts/15/Checkin.aspx?"+c;a=AddSourceToUrl(a);if(FV4UI())ShowInPopUI(d,currentCtx,a);else SubmitFormPost(a)}function _NavigateToSubNewAspx(b,c){var a=b+"/_layouts/15/SubNew.aspx?"+c;a=AddSourceToUrl(a);Nav.navigate(a)}function NavigateToSubNewAspxV4(d,b,c){var a=b+"/_layouts/15/SubNew.aspx?"+c;a=AddSourceToUrl(a);if(FV4UI())ShowInPopUI(d,currentCtx,a);else Nav.navigate(a)}tDocType(){var b=GetAttributeFromItemTable(itemTable,"Icon","DocIcon"),a=Boolean(b)?b.split("|"):[];currentItemIcon=a[0];currentItemAppName=a[1];currentItemOpenControl=a[2];currentItemOpenApp=a[3]==null?"":a[4]==null?a[3]:a[3]+"|"+a[4];currentItemProgId=GetAttributeFromItemTable(itemTable,"Type","HTMLType")}unction DeleteDocLibItem(a,d){if(!IsContextSet())return;var b=currentCtx;if(Boolean(b.CurrentSelectedItems>=1))EnsureScriptParams("inplview","inplview.DeleteSelectedItems",b);else{var c=GenerateDeleteConfirmationMessage(d);if(confirm(c)){if(currentItemFSObjType=="1"&&currentItemContentTypeId!=null)a+="&ContentTypeId="+currentItemContentTypeId;var e=Strings.STS.L_Notification_Delete;addNotification(e,true);SubmitFormPost(a,false,true)}}}e;function AddSubMenu(b,a){if(a.items.length==0)return;else if(a.items.length==1)b.items.splice(locationOf(a.items[0],b.items,seqCompare)+1,0,a.items[0]);else b.items.splice(locationOf(a,b.items,seqCompare)+1,0,a)}ion _HelpWindowKey(a){if(a!==null&&a!=="")HelpWindowHelper("&Key="+a+"&ShowNav=true");else if(typeof navBarHelpOverrideKey!="undefined")HelpWindowHelper("&Key="+navBarHelpOverrideKey+"&ShowNav=true");else HelpWindowHelper("&Key=HelpHome&ShowNav=true")}unction _HelpWindow(){HelpWindowKey("HelpHome")}tion EditSelectedImages(){if(!IsImgLibJssLoaded()){alert(Strings.STS.L_NotOurView_Text);return}_EditSelectedImages()}function DeleteImages(){if(!IsImgLibJssLoaded()){alert(Strings.STS.L_NotOurView_Text);return}_DeleteImages()}function SendImages(){if(!IsImgLibJssLoaded()){alert(Strings.STS.L_NotOurView_Text);return}_SendImages()}able,bIsFilterMenuShown,bIsFilterDataLoaded,filterImageCell,currentFilterMenu,loadingFilterMenu,ctxFilter,bIsFilterKeyPress,filterStr,strFieldName,bMenuLoadInProgress,strFilteredValue,bIsMultiFilter,fnOnFilterMouseOut;unction setupFilterMenuContext(a){ctxFilter=a}tionAllUsers(b){var a=document.getElementById("spToggleUserSelectionCheckBox_"+b.toString());if(a!=null){var g="spUserSelectionCheckBox_"+b.toString(),f=document.getElementsByName(g);a.checked=!a.checked;for(var d=0;d<f.length;d++){var e=f[d];if(!e.disabled)e.checked=a.checked}var h="cbxUserSelectAll"+b.toString(),c=document.getElementById(h);if(c!=null)if(a.checked)c.src="/_layouts/15/images/checkall.gif";else c.src="/_layouts/15/images/unchecka.gif"}}_errMsg,L_SSCDlgInvalidCharacter_TEXT,g_btnCreateId,g_txtTitleId,g_CusValTxtTitle;ribbon; _spRibbonInstantiateByRibbonControl;menuHtc_lastMenu,g_uniqueNumber,g_MenuEndOfDOM;MU_chDelim2Enc;tion MHash_Keys(){return this._keys}MU_reDelimEnc,MMU_reDelim2Enc,MMU_reDelimDec,MMU_reDelim2Dec;function MMU_EncVal(a){return a.replace(MMU_reDelimDec,MMU_chDelimEnc).replace(MMU_reDelim2Dec,MMU_chDelim2Enc)}MU_HighlightedEcbTable,g_MMU_HighlightedEcbTableOpen,g_MMU_OpenTimeoutHandle;on MMU_PopMenuIfShowingDeferCall(){} g_MMU_theFormActionAtPageLoad,g_MMU_Form0ActionAtPageLoad,g_MMU_Form0ActionAtPreMenuOpen;ar g_MMU_RequestTimeoutTimeoutHandle;r loadingMessageMenuItem;teAllVersions(b,a){if(b<=1)alert(Strings.STS.L_Version_NoDeleteAll_None_ERR);else confirm(Boolean(a.RecycleBinEnabled)?Strings.STS.L_Version_RecycleAll_Confirm_Text:Strings.STS.L_Version_DeleteAll_Confirm_Text)&&SubmitFormPost(a.HttpPath+"&op=DeleteAll")} _spFullDownloadList;ction SPUpdatePage(a){if("undefined"==typeof g_MinimalDownload||!g_MinimalDownload||IsAccessibilityFeatureEnabled()||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(556)&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(44))return true;a=GetAbsoluteUrl(a);if(BrowserDetection.userAgent.ie&&BrowserDetection.userAgent.iever<10){var n=a.indexOf("?");if(-1==n)n=a.length;var m=a.indexOf("#");if(-1==m)m=a.length;var w=Math.min(n,m);a=encodeURI(decodeURI(a.substr(0,w)))+a.substr(w)}var c=true,v="/_layouts/15/start.aspx",o=v.length,u=window.location.pathname,r=u.length,b=a.indexOf("#");if(-1!=b){var q=a.substr(0,b).toLowerCase().indexOf("/_layouts/15/start.aspx");if(-1!=q)if(a.length>b+2&&"/"==a[b+1])if(a.length>b+3&&"/"==a[b+2])a=a.substr(b+2);else a=a.substr(0,q)+a.substr(b+1)}if(r>=o&&v==u.substr(r-o))if(a.charAt(0)=="/"){if(!IsFailoverTarget(GetTargetHandler(a))){Nav.ajaxNavigate.update(a);c=false}}else{if(a.indexOf("/")==-1){var f=Nav.ajaxNavigate.get_href(),t=f.indexOf("?");if(t!=-1)f=f.substr(0,t);var p=f.lastIndexOf("/");if(p!=-1)a=f.substr(0,p+1)+a}var g=a.indexOf("//");if(-1!=g){var j=a.indexOf("/",g+2);if(-1!=j){var e=a.substr(g+2,j-(g+2)),i="",l=e.indexOf(":");if(-1!=l){i=e.substr(l+1);if(i=="80")i="";e=e.substr(0,l)}if(window.location.hostname==e&&window.location.port==i)if(!IsFailoverTarget(GetTargetHandler(a.substr(j)))){Nav.ajaxNavigate.update(a.substr(j));c=false}}else if(window.location.hostname==a.substr(g+2)){Nav.ajaxNavigate.update("");c=false}}else c=true}else if("undefined"!==typeof g_WebServerRelativeUrl){var k=document.createElement("a");k.href=a;a=k.href;k.href=g_WebServerRelativeUrl;var h=k.href;if(a.length>=h.length&&h.toLowerCase()==a.substr(0,h.length).toLowerCase()){var d=h;if("/"==d[d.length-1])d+="/_layouts/15/start.aspx".substr(1);else d+="/_layouts/15/start.aspx";if(!IsFailoverTarget(GetTargetHandler(GetServerRelativeUrlFromURL(a)))){d+="#/"+GetServerRelativeUrlFromURL(a);window.location.href=d;c=false}}}if(!c){g_MDNav=false;var s=window.event;s!=null&&cancelDefault(s)}return c}NotificationId;function LaunchAppInternal(c,d,e,b,g,f){var h=typeof _spPageContextInfo!="undefined"&&typeof _spPageContextInfo.webServerRelativeUrl!="undefined"&&_spPageContextInfo.webServerRelativeUrl=="/"?"":_spPageContextInfo.webServerRelativeUrl,a=escapeUrlForCallback(h)+"/_layouts/15/appredirect.aspx";if(typeof d!="undefined"&&d!=null&&typeof e!="undefined"&&e!=null)a+="?client_id="+escapeProperly(d)+"&redirect_uri="+escapeProperly(e);else if(typeof c!="undefined"&&c!=null)a+="?instance_id="+escapeProperly(c);else throw"appOAuthId, launchUrl, appInstanceId are null";if(g)a+="&tsapp=1";if(typeof b!="undefined"&&b!=null&&(!window._spModuleLink||!(window.OffSwitch==null||OffSwitch.IsActive("B3F9D971-9B68-4ED1-B9FD-071152E20CBA"))&&!f))SetupAndOpenDialogForCustomAction(a,b.width,b.height,b.title);else window.location.href=a}var _tenantAppData;ar Accessibility;ar DOM_afterglass;ar GetAncestor,GetAncestorByTagNames,GetParentLinkFromEvent,GetPosition,GetSelectedElement,IsContained,IsEventRightClickOnAnchor,IsEventTargetAnchor,ListModule_afterglass;function ListModule_afterglass_module_def(){ListModule.Util.countSelectedItems=i;ListModule.Util.countTotalItems=n;ListModule.Util.createAjaxMenu=p;ListModule.Util.ctxFromElement=I;ListModule.Util.fetchEcbInfo=t;ListModule.Util.findSTSMenuTable=k;ListModule.Util.focusRow=v;ListModule.Util.getEcbDivFromEcbTd=j;ListModule.Util.getEcbTdFromRow=o;ListModule.Util.getItemRowCbx=c;ListModule.Util.getLastSelectableRowIdx=e;ListModule.Util.getRootFolder=J;ListModule.Util.getRootFolder2=q;ListModule.Util.getUrlWithNoSortParameters=y;ListModule.Util.groupNameFromRow=l;ListModule.Util.groupStringFromGroupName=A;ListModule.Util.headerMenuMouseDown=F;ListModule.Util.itemHasIid=u;ListModule.Util.itemIsCurrentlySelected=B;ListModule.Util.itemIsCurrentlyVisible=f;ListModule.Util.itemIsSelectable=m;ListModule.Util.onItemSelectionChanged=g;ListModule.Util.selectListItem=s;ListModule.Util.setFocusOnRowDelayed=h;ListModule.Util.showEcbMenuForTr=H;ListModule.Util.toggleItemRowSelection2=C;ListModule.Util.updateCtxLastSelectableRow=z;ListModule.Util.updateSelectAllCbx=G;ListModule.Util.registerOnItemSelectionChangedHandler=x;ListModule.Util.unregisterOnItemSelectionChangedHandler=w;ListModule.Util.onFocusFilter=K;ListModule.Util.findCtxImg=a;ListModule.Util.showCtximg=d;ListModule.Util.removeCtxImg=L;ListModule.Util.positionCtxImg=r;ListModule.Util.createCtxImg_Helper=E;ListModule.Util.FilterField=M;ListModule.Util.getFilterValueFromUrl=D;ction n(a){if(a.TotalListItems==null)a.TotalListItems=0;return a.TotalListItems}a==null||a.SelectAllCbx==null)return;a.SelectAllCbx.checked=false;if(c){var d=n(a),b=i(a);if(b==d&&b>0)a.SelectAllCbx.checked=true}ListModule.Settings.SupportsDoclibAccessibility&&a.SelectAllCbx.setAttribute("aria-checked",a.SelectAllCbx.checked.toString())}nction b(a){return GetThemedImageUrl(a)}derMenu_OnMouseDown,CountSelectedItems,CountTotalItems,CreateAjaxMenu,CtxFromElement,FetchEcbInfo,FindSTSMenuTable,FocusRow,GetEcbDivFromEcbTd,GetEcbTdFromRow,GetItemRowCbx,getFilterValueFromUrl,GetLastSelectableRowIdx,GetRootFolder,GetRootFolder2,GetUrlWithNoSortParameters,GroupNameFromRow,GroupStringFromGroupName,ItemHasiid,ItemIsCurrentlySelected,ItemIsCurrentlyVisible,ItemIsSelectable,OnItemSelectionChanged,SelectListItem,SetFocusOnRowDelayed,ShowECBMenuForTr,ToggleItemRowSelection2,UpdateCtxLastSelectableRow,UpdateSelectAllCbx,_OnFocusFilter,FindCtxImg,ShowCtxImg,RemoveCtxImg,PositionCtxImg,List_CreateCtxImg_Helper,FilterFieldV3,RegisterOnItemSelectionChangedHandler,UnregisterOnItemSelectionChangedHandler,DocumentType;function DocumentInformation(e,b,d,c,a){this.type=e;this.idToken=b;this.imgSrc=d;this.imgAlt=c;this.textLabel=a}var c_newdocWOPIID,c_newDocDivHtml,c_onClickCreateDoc,c_newDocCalloutWidth,NewDocumentInfo;function InitializeNewDocumentInfo(){var a={};a[DocumentType.Word]=new DocumentInformation(DocumentType.Word,"Word","/_layouts/15/images/lg_icdocx.png?rev=43",typeof Strings!="undefined"?Strings.STS.L_NewDocumentWordImgAlt:"",typeof Strings!="undefined"?Strings.STS.L_NewDocumentWord:"");a[DocumentType.Excel]=new DocumentInformation(DocumentType.Excel,"Excel","/_layouts/15/images/lg_icxlsx.png?rev=43",typeof Strings!="undefined"?Strings.STS.L_NewDocumentExcelImgAlt:"",typeof Strings!="undefined"?Strings.STS.L_NewDocumentExcel:"");a[DocumentType.PowerPoint]=new DocumentInformation(DocumentType.PowerPoint,"PowerPoint","/_layouts/15/images/lg_icpptx.png?rev=43",typeof Strings!="undefined"?Strings.STS.L_NewDocumentPowerPointImgAlt:"",typeof Strings!="undefined"?Strings.STS.L_NewDocumentPowerPoint:"");a[DocumentType.OneNote]=new DocumentInformation(DocumentType.OneNote,"OneNote","/_layouts/15/images/lg_icont.png?rev=43",typeof Strings!="undefined"?Strings.STS.L_NewDocumentOneNoteImgAlt:"",typeof Strings!="undefined"?Strings.STS.L_NewDocumentOneNote:"");if(!(window.OffSwitch==null||OffSwitch.IsActive("75D2F2A7-BAAA-4FE4-A315-D9C10A9F33AE"))&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(211)||!(window.OffSwitch==null||OffSwitch.IsActive("BDE14C63-89F3-40C1-80AA-136EF1076BE6")))a[DocumentType.Visio]=new DocumentInformation(DocumentType.Visio,"Visio","/_layouts/15/images/lg_icvdx.png?rev=43",typeof Strings!="undefined"?Strings.STS.L_NewDocumentVisioImgAlt:"",typeof Strings!="undefined"?Strings.STS.L_NewDocumentVisio:"");else if(Boolean(_spPageContextInfo)&&_spPageContextInfo.isSPO&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(973))a[DocumentType.Visio]=new DocumentInformation(DocumentType.Visio,"Visio","/_layouts/15/images/lg_icvdx.png?rev=43",typeof Strings!="undefined"?Strings.STS.L_NewDocumentVisioImgAlt:"",typeof Strings!="undefined"?Strings.STS.L_NewDocumentVisio:"");a[DocumentType.ExcelForm]=new DocumentInformation(DocumentType.ExcelForm,"ExcelForm","/_layouts/15/images/lg_icxlsx.png?rev=43",typeof Strings!="undefined"?Strings.STS.L_NewDocumentExcelFormImgAlt:"",typeof Strings!="undefined"?Strings.STS.L_NewDocumentExcelForm:"");a[DocumentType.Folder]=new DocumentInformation(DocumentType.Folder,"Folder","/_layouts/15/images/mb_folder.png?rev=43",typeof Strings!="undefined"?Strings.STS.L_NewDocumentFolderImgAlt:"",typeof Strings!="undefined"?Strings.STS.L_NewDocumentFolder:"");return a}unction CreateDocItem(a,e,i){var c=c_newdocWOPIID+"div"+a.idToken+"-",f=ListModule.Util.addWPQtoId(c,e),g=ListModule.Util.addWPQtoId(c+"img-",e),h=ListModule.Util.addWPQtoId(c+"txt-",e);if(a.type==DocumentType.SuiteExtensionApp){var d=document.createElement("div");d.innerHTML=String.format(c_newDocDivHtml,f,g,"","",h,i,"");var j=d.children[0],b=j.children[0],k=j.children[1];try{b.src=a.imgSrc}catch(l){}b.alt=a.imgAlt;b.style.height="32px";b.style.width="32px";k.appendChild(document.createTextNode(a.textLabel));return d.innerHTML}else return String.format(c_newDocDivHtml,f,g,a.imgSrc,Encoding.HtmlEncode(a.imgAlt),h,i,Encoding.HtmlEncode(a.textLabel))}unction RenderNewDocumentCallout(d,j){var f=[],i=d.wpq;f.push('<div id="');f.push(GetNewDocumentCalloutMainID(d));f.push('" class="ms-newdoc-callout-main">');var l=window["toolbarData"+i],o=false;if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(432)&&Boolean(l)&&Boolean(l.NewMenuData)){var r="/Forms/template.do",q="Forms\\u002ftemplate.do",g=ParseNewMenuJson(l.NewMenuData);if(g.length>1||g.length==1&&Boolean(g[0].ClickScript)&&g[0].ClickScript.indexOf(r)===-1&&g[0].ClickScript.indexOf(q)===-1){o=true;for(var c=0;c<g.length;c++){var e=g[c].ClickScript,s=Encoding.HtmlEncode(g[c].LabelText),t=Encoding.HtmlEncode(g[c].Description),m=c_newdocWOPIID+"div"+c.toString()+"-",u=String.format(c_newDocDivHtml,ListModule.Util.addWPQtoId(m,i),ListModule.Util.addWPQtoId(m+"img-",i),g[c].Image32by32,t,ListModule.Util.addWPQtoId(m+"txt-",i),"CalloutManager.closeAll();"+e,s);f.push(u)}if(Boolean(d.AllowCreateFolder)){e="";var b=null;for(var a in NewDocumentInfo){b=NewDocumentInfo[a];if(Number(a)==DocumentType.Folder){e=RenderNewFolderUrl(d);break}}if(Boolean(e)){f.push("<hr/>");f.push(CreateDocItem(b,i,e))}}}}if(!o){var k=[],p=[];if(typeof IsFileHandlerFileCreationSupported=="function"&&IsFileHandlerFileCreationSupported()){var h=d.newDoc_seInfo;if(h==null)h=d.newDoc_seInfo={};if(h.menu==null)h.menu=TryCreateSuiteExtensionFileCreationMenu();if(h.menu!=null){WriteStart("FileHandler_StartLoadFileCreationEntries");if(h.entries==null)h.entries=h.menu.get_fileCreationEntries();for(c=0;c<h.entries.length;c++){var n=h.entries[c];k.push(new DocumentInformation(DocumentType.SuiteExtensionApp,"SuiteExtensionApp"+c.toString(),n.imageUrl+"",n.imageAlternateText+"",n.displayName+""));p.push("NewDocumentCallout_OnClickedSuiteExtensionApp('"+d.ctxId+"', "+c.toString()+"); return false;")}WriteSuccess("FileHandler_SuccessLoadFileCreationEntries")}}if(!(window.OffSwitch==null||OffSwitch.IsActive("D9E1074E-94FF-4B77-A579-CFBF66E05758"))){for(a in NewDocumentInfo){if(Number(a)==DocumentType.ExcelForm&&!Boolean(d.CanShareLinkForNewDocument))continue;if(!(window.OffSwitch==null||OffSwitch.IsActive("75D2F2A7-BAAA-4FE4-A315-D9C10A9F33AE"))&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(211)){if(Number(a)==DocumentType.Word||Number(a)==DocumentType.Excel||Number(a)==DocumentType.PowerPoint||Number(a)==DocumentType.OneNote||Number(a)==DocumentType.Visio||Number(a)==DocumentType.ExcelForm)if(false==Boolean(d.NewWOPIDocumentTypes&1<<Number(a)))continue}else if(!(window.OffSwitch==null||OffSwitch.IsActive("BDE14C63-89F3-40C1-80AA-136EF1076BE6")))if(Number(a)==DocumentType.Visio&&!Boolean(d.VisioDrawingCreationEnabled))continue;b=NewDocumentInfo[a];if(typeof b!="undefined"&&b!=null&&Number(a)!=DocumentType.Folder){if(Number(a)==DocumentType.ExcelForm)e="TryLaunchExcelForm('"+j+"'); return false;";else if(IsDefaultFileCreationSupported(Number(a)))e="CalloutManager.closeAll(); CreateNewDefaultDocument('"+d.ctxId+"', '"+String(b.type)+"'); return false;";else e=String.format(c_onClickCreateDoc,j,String(b.type));f.push(CreateDocItem(b,i,e))}}if(Boolean(d.AllowCreateFolder))for(a in NewDocumentInfo){b=NewDocumentInfo[a];if(typeof b!="undefined"&&b!=null&&Number(a)==DocumentType.Folder){f.push("<hr/>");e=RenderNewFolderUrl(d);f.push(CreateDocItem(b,i,e))}}}else for(a in NewDocumentInfo){if(Number(a)==DocumentType.ExcelForm&&!Boolean(d.CanShareLinkForNewDocument))continue;b=NewDocumentInfo[a];if(typeof b!="undefined"&&b!=null){if(Number(a)!=DocumentType.Folder)if(Number(a)==DocumentType.ExcelForm)e="TryLaunchExcelForm('"+j+"'); return false;";else if(IsDefaultFileCreationSupported(Number(a)))e="CalloutManager.closeAll(); CreateNewDefaultDocument('"+d.ctxId+"', '"+String(b.type)+"'); return false;";else e=String.format(c_onClickCreateDoc,j,String(b.type));else if(Boolean(d.AllowCreateFolder)){f.push("<hr/>");e=RenderNewFolderUrl(d)}else continue;f.push(CreateDocItem(b,i,e))}}if(k.length>0){WriteStart("FileHandler_StartAppendAppsToNewDocumentCallout");f.push("<hr/>");for(c=0;c<k.length;c++)f.push(CreateDocItem(k[c],i,p[c]));WriteSuccess("FileHandler_SuccessAppendAppsToNewDocumentCallout")}}f.push("</div>");return f.join("")}function RefreshNewDocumentCallout(c,e,g){WriteStart("FileHandler_StartRefreshNewDocumentCallout");var b=RenderNewDocumentCallout(c,e),f=GetNewDocumentCalloutMainID(c),d=document.getElementById(f);if(Boolean(d)){var a=d.parentNode;if(Boolean(a))a.innerHTML=b}g.set({content:b});WriteSuccess("FileHandler_SuccessRefreshNewDocumentCallout")}unction NewDocumentCallout_OnOpeningCallback(b,c,d){if(typeof IsFileHandlerFileCreationSupported=="function"&&IsFileHandlerFileCreationSupported()){var a=b.newDoc_seInfo;if(a!=null)if(a.menu==null){a.menu=TryCreateSuiteExtensionFileCreationMenu();a.menu!=null&&RefreshNewDocumentCallout(b,c,d)}}}function TryCreateSuiteExtensionFileCreationMenu(){var a=null;if(typeof SuiteExtensions=="object"&&typeof SuiteExtensions.ControlFactory=="function"&&typeof SuiteExtensions.ControlType=="function")if(typeof SuiteExtensions.ControlFactory.CreateControl=="function"&&typeof SuiteExtensions.ControlType.FileCreation=="number")try{a=SuiteExtensions.ControlFactory.CreateControl("",SuiteExtensions.ControlType.FileCreation)}catch(b){}return a}function NewDocumentCallout_OnClickedSuiteExtensionApp(l,j){WriteStart("FileHandler_StartGetNewFileControl");var b=window.g_ctxDict["ctx"+l];if(b==null){WriteFailure("FileHandler_FailedGetNewFileControl");return}var k=b.newDoc_seInfo,a=k.menu.createNewFileControl(j);if(a==null){WriteFailure("FileHandler_FailedGetNewFileControl");return}WriteSuccess("FileHandler_SuccessGetNewFileControl");a.pickFileHandler(i);var c,e,d;function i(){c=a.get_fileExtension();e=a.get_appId();CalloutManager.closeAll();WriteStart("FileHandler_StartCreateDoc");CreateDocumentWithExtension(b,c,g,f)}function f(a){WriteFailure("FileHandler_FailedCreateDoc");WriteDebugLog("FileHandler_FailedCreateDoc",true,"Failed with extension: "+c+", appId: "+e+", reason: "+a)}function g(c){WriteSuccess("FileHandler_SuccessCreateDoc");WriteStart("FileHandler_StartRedirectToNewDoc");a.set_httpRoot(b.HttpRoot);a.set_itemUrl(c);d=a.getRedirectUrl();GoToPage(d);setTimeout(h,5e3)}function h(){WriteFailure("FileHandler_FailedRedirectToNewDoc")}}function CreateDocumentWithExtension(e,g,m,h){var a=SP.ClientContext.get_current(),j=a.get_web(),n=j.get_lists().getById(e.listName),i=Boolean(e.clvp.rootFolder)?j.getFolderByServerRelativeUrl(e.clvp.rootFolder):n.get_rootFolder(),c=i.get_files(),d=i.get_folders(),b,f;a.load(c);a.load(d);a.executeQueryAsync(k,function(b,a){h(a.get_message())});function k(){for(var j={},k=0,e=0,m=c.get_count();e<m;++e){k+=1;j["KEY_"+c.getItemAtIndex(e).get_name()]=true}for(e=0,m=d.get_count();e<m;++e){k+=1;j["KEY_"+d.getItemAtIndex(e).get_name()]=true}var n=g.toUpperCase()+" File",p="."+g;b=n+p;if(j["KEY_"+b]===true)for(e=1;e<k+1;++e){var o=n+e.toString()+p;if(j["KEY_"+o]!==true){b=o;break}}var i=new SP.FileCreationInformation;i.set_url(b);i.set_overwrite(false);i.set_content(new SP.Base64EncodedByteArray);f=c.add(i);a.load(f);a.executeQueryAsync(l,}var g_lastLaunchPointIIDClicked;r usedCalloutIDs,generateUniqueCalloutIDFromBaseID,Callout_OnOpeningCallback,GenerateCtx;nction GetCallOutOpenText(){return typeof Strings!="undefined"?Strings.STS.L_CalloutOpenAction:""}function CalloutOnPostRenderTemplate(a,b){Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)&&b.addAction(new CalloutAction({text:Strings.STS.L_AddToOneDrive_Text,onClickCallback:function(b,c){CalloutAction_AddToOneDrive_OnClick(b,c,a)},isVisibleCallback:function(b){return CalloutAction_AddToOneDrive_IsVisible(b,a)}}));var d=a.CurrentItem,e=GetCallOutOpenText(d,a),c=typeof Strings!="undefined"?Strings.STS.L_SPCalloutAction_EDIT:"";b.addAction(new CalloutAction({text:e,tooltip:c,onClickCallback:function(b,c){CalloutAction_Open_OnClick(b,c,a)},isVisibleCallback:));c=typeof Strings!="undefined"?Strings.STS.L_SPCalloutAction_SHARE:"";b.addAction(new CalloutAction({text:typeof Strings!="undefined"?Strings.STS.L_CalloutShareAction:"",tooltip:c,onClickCallback:isVisibleCallback:))}on GetCalloutSharingStatusDivId(a){return GetCalloutElementIDFromRenderCtx(a)+"SharedWithInfo"}ction CalloutPostRenderSharingStatus(d,j,i,h){var a=d.CurrentItem,b=Boolean(j);if(b||permMaskContains(a.PermMask,0,131072)){var r=GetCalloutFromRenderCtx(d),e=getViewCtxFromCalloutCtx(d),q=b?j:GetCalloutSharingStatusDivId(d),g=null,p=function(c,k){var j=c.get_isSharedWithMany(),h=c.get_isSharedWithSecurityGroup(),i=c.get_isSharedWithGuest()&&(ListModule.Util.isDefinedAndNotNullOrEmpty(c.get_anonymousEditLink())||ListModule.Util.isDefinedAndNotNullOrEmpty(c.get_anonymousViewLink())),f=null;if(ListModule.Util.isDefinedAndNotNullOrEmpty(a.FileLeafRef))f=a.FileLeafRef;else if(ListModule.Util.isDefinedAndNotNullOrEmpty(a.Title))f=a.Title;g=GetSharedWithUserInfo(k);EnsureScriptFunc("sharing.js","GetSharingStatusHtml",function(){if(!b){var y=GetCalloutLinkBoxElementID(d),n=document.getElementById(y);if(Boolean(n)){var w=c.get_sharingLinks();if(Boolean(w)&&w.length>0){var p=GetBestCsomSharingLink(w);if(p!=null){n.value=p.get_url();var l=n.parentNode,v=GetSharingLabelFromType(p.get_linkKind());if(Boolean(v))n.title=v;var x="js-sharingLinks-linkBoxLabel",k=document.getElementById(x);if(!Boolean(k)){k=document.createElement("div");k.id=x;CSSUtil.AddClass(k,"js-callout-sharingLink-label");l.parentNode.insertBefore(k,l);k.style.width=String(k.parentNode.offsetWidth)+"px"}k.innerHTML="<a href='javascript:;' class='js-sharingLinks-linkBoxLabelLink' title='"+Encoding.HtmlEncode(Strings.STS.L_SharedWithGuestTooltip)+"'>"+Encoding.HtmlEncode(v)+"</a>";if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(40)){for(var o=null,s=0,z=l.parentNode.childNodes.length;s<z;s++)if(l.parentNode.childNodes[s].tagName.toUpperCase()=="A")o=l.parentNode.childNodes[s];if(Boolean(o)){var u=document.createElement("div");u.innerHTML=GenStyledQrImgLink(p.get_url());window.setTimeout(function(){for(var a=0,b=u.childNodes.length;a<b;a++)l.parentNode.insertBefore(u.childNodes[a],o);l.parentNode.removeChild(o)},0)}}}}}}var m=document.getElementById(q),t=GetSharingStatusHtml(g,j,h,i,false,e.ListSchema.UserDispUrl,f,e,b?null:r,b,a.ID);if(t.length>0){m.innerHTML=b?t:Callout.GenerateDefaultSection(null,t);m.calloutRenderCtx=d;m.objectSharingInformation=c}window.setTimeout(0)})},c=SP.ClientContext.get_current(),f=SP.ObjectSharingInformation.getListItemSharingInformation(c,e.listName,a.ID,true,false,b?false:true,true,b?true:false,false),k=f.getSharedWithUsers(c);c.load(f,"IsSharedWithMany","IsSharedWithSecurityGroup","IsSharedWithGuest","CanManagePermissions","AnonymousEditLink","AnonymousViewLink");c.load(f,"SharingLinks");if(b){var m=c.get_web().get_lists().getById(e.listName),l=m.getItemById(a.ID);c.load(m);c.load(l,"ID","SharedWithUsers")}c.load(k);var n=o=c.executeQueryAsync(n,o)}}function CalloutRenderSourceUrl(b){var a=[],h=GetCalloutLinkBoxElementID(b),c=GetItemUrlForLinking(b),e=GetItemDocIdUrl(b);if(IsMountPoint(b.CurrentItem))c=GetMountPointRedirectUrl(b);var f=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(40);a.push('<input id="');a.push(h);a.push('" value="');a.push(Encoding.HtmlEncode(Boolean(e)?e:c.getString()));a.push('" class="js-callout-location" ');a.push('onclick="javascript: this.select();" ');a.push('onblur="javascript: this.value = this.defaultValue;" ');a.push("oncopy=\"javascript: WriteDocEngagementLog('CalloutCopyUrl', 'OneDriveCalloutCopyUrl', { Source : 'ListView' })\" ");a.push("aria-label="+StAttrQuote(Strings.STS.L_SPCalloutEdit_URL));a.push("/>");var d=a.join("");if(f){var g=GenLinkBoxWithQrCode(c.getString(),d);return Callout.GenerateDefaultSection(null,g)}else return Callout.GenerateDefaultSection(null,d)}function CalloutAction_Open_OnClick(g,h,a){var e=g,c=e.target,f=a.ListSchema,b=a.CurrentItem;if(m$.isUndefinedOrNull(b)||m$.isUndefinedOrNull(b.ID))throw"Error: listItem is missing properties";if(f.IsDocLib=="1"||b.FSObjType=="1")if(IsFileExtensionControlsSupported()&&!IsFileHandlerForAllNonOfficeFilesSupported())if(typeof SuiteExtensions=="object"&&typeof SuiteExtensions.ControlFactory=="function"&&typeof SuiteExtensions.ControlType=="function"){var d=SuiteExtensions.ControlFactory.CreateControl(a.CurrentItem.File_x0020_Type,SuiteExtensions.ControlType.Edit);if(d!=null){d.httpRoot=a.HttpRoot;d.itemUrl=a.CurrentItem.FileRef;d.updateElement(c)}else CalloutAction_UpdateHref(c,b,a)}else CalloutAction_UpdateHref(c,b,a);else CalloutAction_UpdateHref(c,b,a);else c.setAttribute("href",ListModule.Util.createItemPropertiesTitleUrl(a,b));smartOpenFileOrFolderFromHrefCore(e.originalEvent,c,b,f,a);c.removeAttribute("isEdit");c.removeAttribute("App")}function CalloutAction_UpdateHref(a,c,d){var b=c.FileRef;if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(54)&&!(window.OffSwitch==null||OffSwitch.IsActive("5AF73175-F77B-49B9-811F-16F671373269")))b=Encoding.EncodePath(b,true);a.setAttribute("href",getHostUrl(d.HttpRoot)+b);a.setAttribute("isEdit","1");a.setAttribute("App",c["File_x0020_Type.mapapp"])}unction RenderNewFolderUrl(b){var a=[];a.push("CalloutManager.closeAll();");var c=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(76);WriteEngagementLog("CreateSharedFolderDialog_Flight"+(c?"On":"Off"));if((c||window.enableCreateSharedFolderDialog)&&_spPageContextInfo.webUIVersion>=15&&Boolean(b.ListSchema.IsDocLib)&&Boolean(b.isXslView)&&!IsInIframe()){a.push("EnsureScriptParams('createsharedfolderdialog.js', 'DisplayCreateSharedFolderDialog', ");a.push("'WebPart"+b.wpq+"', 'Callout');")}else{a.push("NewItem2(event, &quot;");a.push(b.HttpRoot);a.push("/_layouts/15/listform.aspx?ListId=");a.push(unescapeProperly(b.listName));a.push("&PageType=8");a.push("&RootFolder=");if(Boolean(b.rootFolder)&&b.rootFolder!="")a.push(URI_Encoding.encodeURIComponent(unescapeProperly(b.rootFolder)));else a.push(URI_Encoding.encodeURIComponent(unescapeProperly(b.listUrlDir)));a.push("&Type=1&quot;);")}a.push("return false;");return a.join("")}function GenLinkBoxWithQrCode(e,b){var a=[],d=fRightToLeft?"right":"left",c=fRightToLeft?"left":"right";a.push('<div style="position:relative">');a.push("<div style='position:absolute; display:inline-block; "+d+":0px; "+c+":20px'>");a.push(b);a.push("</div>");a.push(GenStyledQrImgLink(e));a.push("<div style='height:16px;visibility:hidden' ></div>");a.push("</div>");return a.join("")}function GenStyledQrImgLink(c){var b=fRightToLeft?"left":"right",a="position:absolute; "+b+":0px;";return GenQrImgLink(c,a)}nction CalloutRenderSection(a,b){Callout.GenerateDefaultSection(a,b)}function GetItemDocIdUrl(c){var d=c.CurrentItem,g=Boolean(d._dlc_DocIdUrl),f=null;if(g){var e=d._dlc_DocIdUrl,a=new URI(Boolean(e)?e:""),b=new URI(c.HttpRoot);b.setPath(a.getPath());Boolean(a.getQuery())&&b.setQuery(a.getQuery());Boolean(a.getFragment())&&b.setFragment(a.getFragment());f=b.getDecodedStringForDisplay()}return f}function GetItemUrlForLinking(a){var b=a.CurrentItem,i=a.ListSchema.IsDocLib==="1",d=null;if(i){var g;if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(54))g=Encoding.EncodePath(b.FileRef,true);else g=b.FileRef;d=new URI(a.HttpRoot);d.setPath(g)}else d=new URI(ListModule.Util.createItemPropertiesTitleUrl(a,b));var e=d.getString(),c=b["serverurl.progid"];if(Boolean(c)&&c.indexOf("?")!=-1){var h=a&&a.ListSchema&&a.ListSchema.DefaultItemOpen==="0";if(h)c="1"+e;else{var f=b.UniqueId.toLowerCase();f=f.replace(/[\{\}-]/g,"");c="1"+e+"?d=w"+f}}return new URI(GetRedirectedHref(e,a.ListSchema.DefaultItemOpen,b["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"],b.HTML_x0020_File_x0020_Type,c,b.FSObjType=="1",true,null))}nction getCtxFromCtxNum(a){return window["ctx"+a]}unction smartOpenFileOrFolderFromHref(a,d,c,b){smartOpenFileOrFolderFromHrefCore(a,d,c,b,null)}function smartOpenFileOrFolderFromHrefCore(c,d,a,b,e){if(a.FSObjType==="1"){_WriteDocEngagement("Documents_OpenFolderCalloutClick","OneDrive_OpenFolderCalloutClick");var f=fMaintainUserChrome()?"&MaintainUserChrome=true":"";VerifyFolderHref(d,c,a["File_x0020_Type.url"],["File_x0020_Type.progid"],b.DefaultItemOpen,a["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"],a.HTML_x0020_File_x0020_Type,a["serverurl.progid"]);HandleFolder(d,c,b.PagePath+"?RootFolder="+URI_Encoding.encodeURIComponent(a.FileRef)+b.ShowWebPart+"&FolderCTID="+a.ContentTypeId+"&View="+URI_Encoding.encodeURIComponent(b.View)+f,"TRUE","FALSE",a["File_x0020_Type.url"],a["File_x0020_Type.progid"],b.DefaultItemOpen,a["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"],a.HTML_x0020_File_x0020_Type,a["serverurl.progid"],Boolean(a.CheckoutUser)?a.CheckoutUser[0].id:"",b.Userid,b.ForceCheckout,a.IsCheckedoutToLocal,a.PermMask)}else{_WriteDocEngagement("Documents_OpenDocumentCalloutClick","OneDrive_OpenDocumentCalloutClick");VerifyHref(d,c,b.DefaultItemOpen,a["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"],a["serverurl.progid"]);IsFileHandlerForAllNonOfficeFilesSupported()&&e&&ShouldCallSuiteExtensionControlFactory(e)&&CallSuiteExtensionControlFactory(d,c,a.File_x0020_Type,e.HttpRoot,a.FileRef);DispEx(d,c,"TRUE","FALSE",a["File_x0020_Type.url"],a["File_x0020_Type.progid"],b.DefaultItemOpen,a["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"],a.HTML_x0020_File_x0020_Type,a["serverurl.progid"],Boolean(a.CheckoutUser)?a.CheckoutUser[0].id:"",b.Userid,b.ForceCheckout,a.IsCheckedoutToLocal,a.PermMask)}}m(b,e,c){var a=GetAttributeFromItemTable(e,"Url","ServerUrl");if(a!=null){var f=GetCurrentCtx();if(ShouldCallEncodeURIComponent()&&!c)a=encodeURIComponent(a);else a=URI_Encoding.encodeURIComponent(URI.decodeURIComponent(a))}var d=b.HttpRoot+"/_layouts/15/checkin.aspx?List="+b.listName+"&FileName="+a;OpenPopUpPage(d,CheckInNotifyAndRefreshPage)}ar _CheckoutSelectedItems,_DiscardCheckoutSelectedItems,_CheckinSelectedItems,_CountDictionary,_DeleteSelectedItemsCore;ction _ModerateSelectedItems(j){var a=j.clvp,b=[],c=GetSelectedItemsDict(j),n=_CountDictionary(c),d,e,g=a.ctx.HttpRoot;b.push(g);g[g.length-1]!="/"&&b.push("/");b.push("_layouts/15/approve.aspx?List=");b.push(a.ctx.listName);var f=false;if(n==1)for(e in c){d=c[e];b.push("&ID="+d.id);break}else{b.push("&IsBulk=1");f=true;if(!(window.OffSwitch==null||OffSwitch.IsActive("C3DD9714-B881-4BCB-8E4E-F4755A038F2F"))){var i=a.ctx.rootFolder;if(Boolean(i)){b.push("&RootFolder=");b.push(i)}}}var k=m=h={};for(e in c){d=c[e];h[d.id]=d.id}var l={url:b.join(""),dialogReturnValueCallback:m,args:h,delayAppearance:f,autoSize:true};OpenPopUpPageWithDialogOptions(l)}var _CLVPShowErrorDialog;_nextId;ar c_fpContainerID,c_maxFaces;function AsyncRenderSharedWithFacePile(a,b){SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){SP.QoS.WriteStart("SharedWithFacePile_StartAsyncRender");if(!SupportFacePile(a)){SP.QoS.WriteSuccess("SharedWithFacePile_SuccessAsyncRender");RemoveFacePile(a);WriteDebugLog("SharedWithFacePile_SuccessAsyncRender",false,"either SharedWithFacePile flight is not on or not mysite pages");return}if(typeof b!="undefined"&&b==""){RemoveFacePile(a);SP.QoS.WriteSuccess("SharedWithFacePile_SuccessAsyncRender");WriteDebugLog("SharedWithFacePile_SuccessAsyncRender",false,"No FacePile on Document lib root");return}if(!Boolean(a.CurrentItem))if(Boolean(a.CurrentSelectedItem))a.CurrentItem=a.CurrentSelectedItem;else a.CurrentItem=GetListItemDataByRootFolder(a,b);function d(c,j,g){try{var b,l=GetFPElementIDFromRenderCtx(c),f={onError:htmlShareInfo:"",users:[],buttons:[{idBtn:"fp_ShareBtn",glyph:"&#xE078",tooltip:Strings.STS.L_SharedWithSomeOne,accessKey:Strings.STS.L_AccessKey_SharedWithSomeOne,onclick:function(a){onShareButtonPress(a,c)}},{idBtn:"fp_MailToBtn",glyph:"&#xE009",tooltip:Strings.STS.L_EmailSomeone,accessKey:Strings.STS.L_AccessKey_EmailSomeone,onclick:]};f.idFacePileContainer=l;f.idFacePileShareWith=l+"_ShareWith";f.idFacePile=l+"_FacePile";f.regionLabel=Encoding.HtmlEncode(Strings.STS.L_SharedWithFacePileRegion);var k=document.getElementById(c_fpContainerID);f.htmlSharedWithInfo=k.innerHTML;k.innerHTML;var d=[];if(Boolean(g)&&g.length>0){var r=g.length-1;for(b=r;b>=0;b--){var q=i(j,g[b].get_lookupId());Boolean(q)&&d.push(q)}if(d.length<j.length&&d.length<c_maxFaces)for(b=d.length;b<c_maxFaces;b++){var p=e(j);Boolean(p)&&d.push(p)}}else d=j;c.sharedWithUsers=d;var m=0;if(Boolean(a.sharedWithUsers))m=h(c);else WriteDebugLog("SharedWithFacePile_AsyncRenderLog",false,"Could not find folder sharedWithUser information");f.numUsers=m;var n=new FacePile(f);n.Render(k);var s={PictureOnly:"1",PictureSize:"Size_36px",InlineRender:false,InlineRenderMoreAsLink:true},t={EffectivePresenceEnabled:"1",PresenceAlt:"No presence information"},o=[];for(b=0;b<m;b++){var u={title:c.sharedWithUsers[b].title,email:c.sharedWithUsers[b].email,sip:c.sharedWithUsers[b].sip,id:c.sharedWithUsers[b].id,picture:c.sharedWithUsers[b].picture,isDomainGroup:c.sharedWithUsers[b].idDomainGroup};o[b]=RenderUserFieldWorker(a,s,u,t)}n.FillUserFaces(o);typeof ProcessImn!="undefined"&&ProcessImn()}catch(v){SP.QoS.WriteFailure("SharedWithFacePile_FailedAsyncRender");return}SP.QoS.WriteSuccess("SharedWithFacePile_SuccessAsyncRender")}ar c=g={if(!Boolean(a.CurrentItem)||!IsTwoFoldersEqual(a.CurrentItem.FileRef,b))AsyncGetFolderItem(a,b,c,g);else c(a)}catch(j){SP.QoS.WriteFailure("SharedWithFacePile_FailedAsyncRender")}})}lToButtonPress(j,a){SP.QoS.WriteUserEngagement("OneDrive_FacePile_OnMailToBtnPress");var f=[],g=document.getElementById("fp_MailToBtn"),c=null,b=null;a.CurrentItem=EnsureCtxCurrentItem(a);if(Boolean(a.CurrentItem)){c=a.CurrentItem.FileLeafRef;var i=a.CurrentItem.FileRef;b=getHostUrl(ajaxNavigate.get_href())+i}else if(Boolean(a.rootFolder)){var d=URI.decodeURIComponent(a.rootFolder);c=d.substring(d.lastIndexOf("/")+1);b=getHostUrl(ajaxNavigate.get_href())+d}else WriteDebugLog("FacePIle_onMailToButtonPress",false,"Neither CurrentItem nor renderCtx.rootFolder is set when click MailTo cmd.");if(Boolean(a.sharedWithUsers))for(var h=a.sharedWithUsers.length>30?30:a.sharedWithUsers.length,e=0;e<h;e++)f.push(a.sharedWithUsers[e].email);ConfigEmailLinkHelper(f,g,c,b)}ClipboardControl,g_IsClipboardControlValid; FollowDocumentFromEmail,PrepareYammerEnvironment,FollowSelectedDocument,IsSPSocialSwitchEnabled;$_global_core();