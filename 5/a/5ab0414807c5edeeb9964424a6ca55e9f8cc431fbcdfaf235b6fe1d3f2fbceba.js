"use strict";(self.webpackChunk_guardian_frontend=self.webpackChunk_guardian_frontend||[]).push([[165],{35400:(e,t,n)=>{n.d(t,{F:()=>i,z:()=>o});var a=n(8683),r="accessibility",o=function(e){Object.keys(e).forEach((function(t){a.Z.set("".concat(r,".").concat(t),e[t])}))},i=function(e){return!0===function(e){return!1!==a.Z.get("".concat(r,".").concat(e))}(e)}},69597:(e,t,n)=>{n.d(t,{O:()=>D});var a=n(15861),r=n(89062),o=n(4942),i=n(64687),c=n.n(i),u=n(19877),d=n(91284),s=n(95868),l=n(41401),f=n(4149),m=n.n(f),v=n(55826),g=n(48729),p=n(35103),y=n(76324),b=n(48607);r P,T=new Promise((function(e){var t,n=window;if(null!==(t=n.YT)&&void 0!==t&&t.Player)e();else if(n.onYouTubeIframeAPIReady){var a=n.onYouTubeIframeAPIReady;n.onYouTubeIframeAPIReady=else n.onYouTubeIframeAPIReady=)),A=E=new Promise((function(e){g.d.adFree&&e({canTarget:!1,framework:null}),P=e}));(0,d.Uc)(();var S=["ENDED","PLAYING","PAUSED","BUFFERING","CUED"],Z=function(e,t,n){if(n){if(y.Z.get("page.isDev")){var a=window.YT.PlayerState[e.data];a&&console.log("Player ".concat(n.id," is ").concat(a))}m().mutate((function(){S.forEach((function(t){n.classList.toggle("youtube__video-".concat(t.toLocaleLowerCase()),e.data===window.YT.PlayerState[t]);var a=n.closest("fc-item");a&&a.classList.toggle("fc-item--has-video-main-media__".concat(t.toLocaleLowerCase()),e.data===window.YT.PlayerState[t]),A(n)}))}))}null==t||t.onPlayerStateChange(e)},C=function(e,t,n){m().mutate((function(){if(n){n.classList.add("youtube__video-ready");var e=n.closest("fc-item");e&&e.classList.add("fc-item--has-video-main-media__ready")}})),null==t||t.onPlayerReady(e)},I=function(){var e={disableAds:!0};return(0,s.c)("commercial","YouTube Ad-Free Config",e),e},_=function(e){var t=(0,v.vb)(e);t.permutive=(0,u.jC)();var n={adTagParameters:{iu:y.Z.get("page.adUnit",""),cust_params:encodeURIComponent((0,b.AZ)(t))}};if(e.tcfv2){var a={adTagParameters:h(h({},n.adTagParameters),{},{cmpGdpr:e.tcfv2.gdprApplies?1:0,cmpVcd:e.tcfv2.tcString,cmpGvcd:e.tcfv2.addtlConsent}),nonPersonalizedAd:!e.canTarget};return(0,s.c)("commercial","YouTube Ads Config TCFv2",a),a}if(e.ccpa||e.aus){var r=h(h({},n),{},{restrictedDataProcessor:!e.canTarget});return(0,s.c)("commercial","YouTube Ads Config CCPA/AUS",r),r}return n},O=function(e){var t=e.consentState,n=e.classes,a=e.adFree;return t.canTarget&&!a&&n.includes("youtube-media-atom__iframe")?"https://www.youtube.com":"https://www.youtube-nocookie.com"},k=function(e,t,n,a,o,i,c,u){var d=g.d.youtubeAdvertising?_(u):I();return new window.YT.Player(e.id,{host:O({consentState:u,classes:(0,r.Z)(e.classList.values()),adFree:g.d.adFree}),videoId:t,width:"100%",height:"100%",events:{onReady:n,onStateChange:a,onError:o,onAdStart:i,onAdEnd:c},embedConfig:{relatedChannels:[],adsConfig:d}})},L=function(e){return e.target.getCurrentTime()>0},j=D=function(){var e=(0,a.Z)(c().mark((function e(t,n,a){var r,o,i,u,d,s,f;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.v)("https://www.youtube.com/iframe_api",{});case 2:return e.next=4,T;case 4:return e.next=6,E;case 6:return r=e.sent,o=i=function(e){var a=j(t.id);L(e)&&A(a),C(e,n,a)},u=function(e){console.error("YOUTUBE: ".concat(e.data)),console.dir(e)},d=y.Z.get("googleAnalytics.trackers.editorial"),s=function(){window.ga("".concat(d,".send"),"event",(0,p.iE)("adStart",a))},f=function(){window.ga("".concat(d,".send"),"event",(0,p.iE)("adEnd",a))},e.abrupt("return",k(t,a,i,o,u,s,f,r));case 14:case"end":return e.stop()}}),e)})));return ()},13192:(e,t,n)=>{n.d(t,{$:()=>d,w:()=>s});var a=n(17489),r=n(76324),o=n(55571),i=n.n(o),c=n(35103),u=d=function(e){var t=r.Z.get("googleAnalytics.trackers.editorial"),n="video content",o={play:"metric1",skip:"metric2",25:"metric3",50:"metric4",75:"metric5",end:"metric6"},d=function(e){var t={video:{id:"gu-video-youtube-".concat(e.mediaId),eventType:"video:content:".concat(e.eventType)}};i().record(t)};["play","25","50","75","end"].forEach((function(r){a.K.once(u(r,e),(function(a){var i={mediaId:e,mediaType:"video",eventType:r,isPreroll:!1};d(i),window.ga("".concat(t,".send"),"event",(0,c.ye)(i,o,a,"gu-video-youtube",(,e))}))})),d({mediaId:e,mediaType:"video",eventType:"ready",isPreroll:!1})},s=function(e,t){a.K.emit(u(e,t),t)}},9165:(e,t,n)=>{n.d(t,{Q:()=>O,W:()=>k});var a=n(89856),r=n(88171),o=n(56535),i=n(69597),c=n(13192),u=n(88710),d=n(73964),s=n(76324),l=n(75435),f=n(53434),m=n(35400),v=n(48607),g={},p=[];document.addEventListener("focusout",(function(){p.forEach((function(e){a.Z.measure((function(){if(document.activeElement===e)return(0,d.Z)(".vjs-big-play-button",e.parentElement)})).then((function(e){a.Z.mutate((function(){e&&e.addClass("youtube-play-btn-focussed")}))}))}))})),document.addEventListener("focusin",(function(){a.Z.measure(().then((function(e){a.Z.mutate(()}))}));var y=function(e){var t=g[e];if(t){var n=t.pendingTrackingCalls,a=t.youtubePlayer,r=t.duration,o=t.atomId;if(n.length){var i=a.getCurrentTime();if(r){var u=Math.round(i/r*100);n.length&&u>=n[0]&&((0,c.w)(n[0].toString(),o),n.shift())}}}},b=w=function(e){return g[e].progressTracker=setInterval(y.bind(null,e),1e3),g[e].progressTracker},h=function(e,t){var n=t.atomId,a=t.iframe,r=t.overlay,o=t.endSlate,i=t.paused;b(e),w(e),t.playing=!0,i?t.paused=!1:(0,c.w)("play",n);var u=a.closest(".immersive-main-media");if(u&&u.classList.add("atom-playing"),r&&o&&!o.rendered){var d=r.parentElement;d&&o.fetch(d,"html")}},P=function(e){var t=e.split("?");return 1===t.length?"":(0,v.ES)(t[1]).v||""},T={ENDED:function(e){var t=g[e];t.playing=!1,b(e),(0,c.w)("end",t.atomId),t.pendingTrackingCalls=[25,50,75];var n=t.iframe&&t.iframe.closest(".immersive-main-media")||null;n&&n.classList.remove("atom-playing")},PLAYING:function(e){var t=g[e];if(t){var n=g[e],a=n.youtubePlayer,i=n.youtubeId,u=P(a.getVideoUrl());u!==i?(0,r.r)("/atom/youtube/".concat(u,".json")).then((function(n){var r=n.atomId;r&&(t.atomId=r,t.youtubeId=u,t.duration=a.getDuration(),(0,c.$)(r),h(e,t))})).catch((function(e){(0,o.e)(Error("Failed to get atom ID for youtube ID ".concat(u,". ").concat(e)),{feature:"youtube"},!1)})):h(e,t)}},PAUSED:function(e){var t=g[e];t.playing=!1,t.paused=!0,b(e)}},A=function(e){var t=(0,l.gn)()||(0,l.Dt)(),n=s.Z.get("page.isDev")?0===document.referrer.indexOf(window.location.origin):0===document.referrer.indexOf(s.Z.get("page.host")),a=e&&!!e.closest('figure[data-component="main video"]')||!1,r=e&&!!e.closest('div[data-layout="vertical-video"]')||!1;return{isAutoplayBlockingPlatform:t,isInternalReferrer:n,isMainVideo:a,flashingElementsAllowed:(0,m.F)("flashing-elements"),isVideoArticle:"video"===s.Z.get("page.contentType","").toLowerCase(),isFront:s.Z.get("page.isFront",!1),isUSContent:"us"===s.Z.get("page.productionOffice","").toLowerCase(),isPaidContent:s.Z.get("page.isPaidContent"),isVerticalVideo:r}},E=function(e){var t=e.isAutoplayBlockingPlatform,n=e.isInternalReferrer,a=e.isMainVideo,r=e.flashingElementsAllowed,o=e.isVideoArticle,i=e.isFront,c=e.isUSContent,u=e.isPaidContent,d=e.isVerticalVideo;return c&&u&&(o&&a||i)&&r?{autoplay:!0,mutedOnStart:(0,l.Dt)()}:{autoplay:(o&&n&&a||i)&&(d||!t)&&r,mutedOnStart:!1}},S=function(){var e=document.querySelector(".immersive-main-media__media .youtube-media-atom"),t=e?e.offsetHeight:0,n=document.querySelector(".immersive-main-media__headline-container"),a=t-(n?n.offsetHeight:0),r=document.querySelector(".youtube-media-atom__immersive-interface");r&&(r.style.top="".concat(a,"px"))},Z=function(e,t,n,a,r){var o=document.getElementById(n);if(o){p.push(o);var i=r.target,c=P(i.getVideoUrl()),d=i.getDuration();g[t]={iframe:o,atomId:e,youtubeId:c,duration:d,youtubePlayer:i,paused:!1,playing:!1,pendingTrackingCalls:[25,50,75]};var m=A(o),v=E(m);if(v.mutedOnStart&&i.mute(),v.autoplay&&((0,l.gn)()&&i.mute(),i.playVideo()),a&&(g[t].overlay=a,s.Z.get("page.section")&&(0,l.zn)({min:"desktop"}))){var y=function(e){var t=e.parentNode;if(t instanceof HTMLElement){var n=(t.dataset||{}).endSlate;if(n){var a=new u.w;return a.endpoint=n,a}}}(a);y&&(g[t].endSlate=y)}o.closest(".immersive-main-media__media")&&(S(),window.addEventListener("resize",(0,f.Z)(S.bind(null),200)))}},C=function(e,t){var n=t.data,a=Object.keys(T).find(();a&&(T[a](e),Object.keys(g).map((function(e){return g[e]})).filter(().length>0))},I=function(e){a.Z.measure((function(){if(e){var t=e.querySelector(".youtube-media-atom__iframe");if(t){var n=t.id,a=e.getAttribute("data-media-atom-id")||"",r=function(e){return"".concat(e,"/").concat(Math.random().toString(36).substr(2,9))}(a);e.setAttribute("data-unique-atom-id",r);var o=e.querySelector(".youtube-media-atom__overlay"),u=e.getAttribute("data-channel-id")||"";(0,c.$)(a),(0,i.O)(t,{onPlayerReady:onPlayerStateChange:,t.dataset.assetId,u)}}}))},_=function(e){e&&a.Z.measure((function(){(0,d.Z)(".youtube-media-atom:not(.no-player)",e).each((function(e){var t=e.querySelector(".youtube-media-atom__overlay");s.Z.get("page.isFront")?t.addEventListener("click",():I(e)}))}))},O=function(e){e&&e.length?e.forEach(_):_(document.body)},k=,55826:(e,t,n)=>{n.d(t,{vb:()=>f});var a=n(93324),r=n(19877),o=n(65336),i=n(95868),c=n(13936),u=n(58563),d=n(48729),s=(0,c.Z)((function(e){return t={sens:e.sens,pt1:e.url,pt2:e.edition,pt3:e.ct,pt4:e.p,pt5:e.k,pt6:e.su,pt7:e.bp,pt9:[e.pv,e.co,e.tn].join("|"),permutive:e.permutive},Object.entries(t).reduce((function(e,t){var n=(0,a.Z)(t,2),r=n[0],i=n[1];return i?((0,o.H)(i)&&(e[r]=i),Array.isArray(i)&&i.length>0&&i.some(Boolean)&&i.every(o.H)&&(e[r]=i.filter(Boolean)),e):e}),{});var t})),l=(0,c.Z)((function(e){return t=s(e),n=Object.entries(t).map((function(e){var t=(0,a.Z)(e,2),n=t[0],r=t[1];return Array.isArray(r)?r.map(():"".concat(n,"=").concat(r)})),Array.prototype.concat.apply([],n).join(",");var t,n})),f=function(e){var t=window.guardian.config.page,n=(0,r.lL)({adFree:d.d.adFree,clientSideParticipations:(0,u.In)(),consentState:e});return t.appNexusPageTargeting=l(n),t.pageAdTargeting=n,(0,i.c)("commercial","pageTargeting object:",n),n}},48729:(e,t,n)=>{n.d(t,{d:()=>c});var a=n(43144),r=n(15671),o=n(4942),i=n(84168),c=new((0,a.Z)((function e(){(0,r.Z)(this,e),(0,o.Z)(this,"adFree",void 0),(0,o.Z)(this,"youtubeAdvertising",void 0);var t=/[#&]noadsaf(&.*)?$/.test(window.location.hash),n=window.guardian.config.page.shouldHideAdverts||"childrens-books-site"===window.guardian.config.page.section;this.adFree=!!t||(0,i.wh)(),this.youtubeAdvertising=!this.adFree&&!n})))},35103:(e,t,n)=>{n.d(t,{iE:()=>i,uE:()=>o,ye:);var a=n(4942),r=function(e,t,n,a,r,o){var i={eventCategory:"media",eventAction:r(e),eventLabel:n,dimension19:o,dimension20:a};if(e.eventType in t){var c=t[e.eventType];void 0!==c&&(i[c]=1)}return i},o=function(e){var t="".concat(e.mediaType," ");return e.isPreroll?t+="preroll":t+="content",t},i=function(e,t){var n="adStart"===e?24:25;return(0,a.Z)({eventCategory:"media",eventAction:"video preroll",eventLabel:t,dimension19:t,dimension20:"gu-video-youtube"},"metric".concat(n),1)}}}]);
//# sourceMappingURL=graun.165.js.map