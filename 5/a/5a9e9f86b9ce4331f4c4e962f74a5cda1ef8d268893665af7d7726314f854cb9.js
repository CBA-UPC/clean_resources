import{debug,delegate as u}from"../base/croco.js";import{LOGGERS as t,MODULE_ALREADY_INITIALIZED as l}from"../base/config.js";let i=false;let m=null;let p=null;let activeElement=null;let h=null;const A=t.DEFAULT;const g="is-active";const j="is-expanded";const k=".js-menu-main";const q=".js-menu-item";const S=".js-menu-close";const T=".js-submenu-item";const v=".js-ada-focusable, input, button, a[href]";const L="js-ada-menu-loop-start";const D="js-ada-menu-loop-stop";const H=".js-header-panel-btn";const $=".js-close-panel";const C=".js-header-panel";function F(e){const target=e.delegateTarget;if(p&&target&&target.classList.contains(L)){p.focus()}if(m&&target&&target.classList.contains(D)){m.focus()}}unction I(e){const index=h&&h.indexOf(document.activeElement);let preventDefault=false;if(activeElement){switch(e.which){case 32:case 37:case 39:preventDefault=true;break;case 38:preventDefault=true;if(index>-1){const t=h&&h[index-1]||p;t&&t.focus()}break;case 40:preventDefault=true;if(index>-1){const t=h&&h[index+1]||m;t&&t.focus()}break;default:break}}if(preventDefault){e.preventDefault();e.stopPropagation()}}function M(){if(activeElement){const o=activeElement.classList.contains(g);const u=activeElement.dataset.submenuTarget;const t=document.querySelector(k);const l=[...document.querySelectorAll(T)];t&&[...t.querySelectorAll(q)].forEach(t=>{t.setAttribute("aria-expanded",activeElement!==t||o?"false":"true")});if(!o){const i=l.find(t=>t.dataset.submenu===u);if(i){h=[...i.querySelectorAll(v)].filter(;h.forEach(t=>t.removeAttribute("tabindex"));m=h[0];p=h[h.length-1];setTimeout(()=>{m&&m.focus()},300)}}else{l&&l.forEach(t=>{[...t.querySelectorAll(v)].forEach(t=>t.setAttribute("tabindex","-1"))});activeElement.focus()}}}function O(){if(activeElement){const o=activeElement.dataset.panelTarget;const t=[...document.querySelectorAll(C)];const u=o&&t&&t.find(;if(u){if(!u.classList.contains(j)){u.setAttribute("aria-expanded","true");h=[...u.querySelectorAll(v)];h.forEach(;m=h[0];p=h[h.length-1];setTimeout(300)}else{u.setAttribute("aria-expanded","false");[...u.querySelectorAll(v)].forEach(;activeElement.focus()}}}}export async function adaHeaderMenuInit(){if(i){debug("error",A,l);return}function t(e,t){activeElement=e.delegateTarget;t()}function o(t){t();m=null;p=null;activeElement=null}u(document.documentElement,`.${L}`,"focus",F,true);u(document.documentElement,`.${D}`,"focus",F,true);u(document.documentElement,q,"click",e=>{t(e,M)},true);u(document.documentElement,H,"click",true);u(document.documentElement,S,"click",()=>{o(M)},true);u(document.documentElement,$,"click",true);document.addEventListener("keydown",I);i=true}