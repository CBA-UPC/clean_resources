(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[681],{"+jQL":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("tBub"),a=n("PZ4A");function o(e){var t=Object(r.a)(e);return Object(a.b)(t)}},"3+RV":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("QjXU"),a=n("NrNW"),o=n("lUkk"),i=n("5eS3"),c=n("mXGw"),u=n("XlCq"),s=n("vaZn"),l=function(){var e=Object(s.a)(),t=Object(a.a)().data,n=Object(c.useMemo)((function(){var e=u.b;return t&&(e=t.loginHint?Object(i.a)(u.b,"".concat(u.a,"=").concat(t.loginHint)):u.b),e}),[t]),l=Object(c.useCallback)((function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return Object(o.a)({type:"Click",id:"StorageErrorManageStorage",area:"Other",subArea:"Other",result:"Navigate",target:"Other",eventName:"StorageError_ManageStorage"}),[2]}))}))}),[]);return Object(c.useMemo)((function(){if(e)return{link:n,caption:e.manageStorageText,description:e.manageStorageText,onClick:l}}),[l,n,e])}},"4PWS":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={home:"5099F2E5-AD99-4BF2-BF82-DF525FFD0BE2",create:"83D3F491-B586-4266-8738-89776471BF21",mycontent:"F57D5D29-4967-495C-A648-F7AB66BF8572",orion:"099317ab-9a66-4a75-868c-dc2263ce2eb9",intents:"2CC62124-219E-4777-9A92-00CDE9062859",feed:"261d33d6-15ba-4e1d-b298-8096960fab40",appgallery:"26706956-2AAE-4A22-8960-09B98C35B28C",alps:"4fbe3a87-55c7-45f6-a518-462f40fd25a0",outlook:"Mail",onedrive:"Documents",teams:"SkypeTeams",word:"WordOnline",excel:"ExcelOnline",powerpoint:"PowerPointOnline",onenote:"OneNoteOnline",sway:"Sway",forms:"OfficeForms",admin:"Admin",visio:"VisioOnline",stream:"MicrosoftStream",todo:"ToDo",familysafety:"FamilySafety",calendar:"Calendar",skype:"Skype",people:"People",powerautomate:"LogicFlows",clipchamp:"Clipchamp",lists:"Lists",yammer:"Yammer",powerbi:"PowerBIv2",bing:"Bing",msn:"MSN",privacy:"Privacy",rewards:"Rewards",whiteboard:"Whiteboard",defender:"Defender"}},"5Ulw":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e){var t="";return e.forEach((function(e){e.name="",e.fileSizeTooSmall?t+="File size is too small!":e.fileSizeToolarge?t+="File size is too large!":e.readerError&&(t+="Problem occurred while reading file!")})),t}},"68nG":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("NrNW"),a=n("ynVX"),o=n("CU8J"),i=n("CaQ9"),c=n("mXGw"),u=n("bcvx"),s=n("MhuU");function l(){var e=Object(s.a)().data,t=Object(r.a)().data,n=Object(a.a)().data,l=Object(i.a)().data,d=Object(o.a)().data,p=Object(c.useMemo)((function(){if(t&&l&&n)return{correlationId:t.correlationId,getAccessToken:t.getAccessToken,jwtAuthEnabled:t.jwtAuthEnabled,officeApiRoot:t.officeHomeApiRoot,graphApiRoot:n.graphApiRoot}}),[t,l,n]);return Object(c.useCallback)((function(n,r){return Object(u.a)({componentContext:t,featureGates:d,fileUploadState:n,graphXhrOptions:p,uploadConfig:e,updateFileUploadState:r})}),[t,d,p,e])}},"8mU8":function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n("QjXU"),a=n("+jQL"),o=n("FZB6"),i=n("IqTF"),c=n("lUkk"),u=n("d1AP"),s=n("wSOj"),l=n("UaN+"),d=n("IIIn"),p=n("95Ql"),f=function(e){var t=e.fileUploadState,n=e.updateFileUploadState,f=e.graphXhrOptions,m=e.componentContext;return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e,v;return Object(r.__generator)(this,(function(r){return f?t&&t.file?(e=(null==m?void 0:m.sessionId)||"",v=performance.now(),[2,new Promise((function(r,m){var b=Object(l.a)(t),g=Object(d.a)(t);Object(i.a)({cancellationToken:t.cancellationToken,driveId:g,file:t.file,graphXhrOptions:f,path:b,onUploadProgress:function(e){n&&t&&t.sequenceNumber&&n({sequenceNumber:t.sequenceNumber,progress:e.total?e.loaded/e.total:0,uploadStatus:u.d.Uploading})},setAutoTranscribePreferHeader:!0}).then((function(n){var i,l=(null===(i=t.file)||void 0===i?void 0:i.name)&&Object(a.a)(t.file.name);Object(c.a)({eventName:"Upload_Click",id:"Upload_Click",area:t.telemetry.area,result:"Refer",target:l?Object(o.a)(l):"Documents"}),Object(p.a)(e,s.a.Success,v,t),t.fileUrlModel=n,t.progress=1,t.uploadStatus=u.d.Completed,r(t)})).catch((function(n){Object(p.a)(e,s.a.Failed,v,t),m(n)}))}))]):[2,Promise.reject("Missing file")]:[2,Promise.reject("Missing graphXhrOptions")]}))}))}},"95Ql":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("+jQL"),a=n("cenr"),o=n("a3FV"),i=n("Dn7E"),c=n("wSOj"),u=n("RYUs");function s(e,t,n,s){var l,d,p,f=s.telemetry,m=f.source,v=f.version,b=f.area,g=Object(u.a)(m,v);g.UploadSessionId=e,g.TotalSize=null===(l=null==s?void 0:s.file)||void 0===l?void 0:l.size.toString(),g.DocumentType=Object(r.a)(null!==(p=null===(d=s.file)||void 0===d?void 0:d.name)&&void 0!==p?p:""),g.Area=b,g.IsUploadSuccessful=t===c.a.Success,t===c.a.Cancelled&&(g.IsUploadCancelled=!0),g.Latency=Math.ceil(performance.now()-n).toString(),Object(a.a)(o.a.UploadCompleted,g,[o.a.UploadCompleted]),Object(i.a)({featureName:"Upload",eventName:"Upload_Completed",params:g})}},"9IwS":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return M}));var r=n("QjXU"),a=n("JlDK"),o=n("5Spd"),i=n("c+Fk"),c=n("NrNW"),u=n("bTtP"),s=n("CU8J"),l=n("CaQ9"),d=n("gd1C"),p=n("h8qh"),f=n("/Oio"),m=n("Dn7E"),v=n("lUkk"),b=n("CMIS"),g=n("LHhM"),O=n("V+NM"),j=n("AeLC"),h=n("d1AP"),S=n("skfY"),_=n("Coo+"),U=n("JYsJ"),w=n("mXGw"),C=n.n(w),x=n("f6UF"),T="https://msit.microsoftstream.com/?referrer=https:%2F%2Fwww.office.com%2F",P=n("HeHW"),k=n("EXRb"),y=n("p/uK"),F=n("sLnE"),E=n("DU/N"),I=Object(y.a)({createCardBlankWorkbookPresentation:Object(r.__assign)({position:"relative",width:"calc(100% - 20px)",height:"calc(100% - 20px)"},F.a.margin("10px !important")),cssOverrideForCard:{maxWidth:"175px","@media (max-width: 480px)":{paddingTop:"35px"}},cssOverrideForCardsContainer:{"@media (max-width: 768px)":{columnGap:"0px",flexWrap:"unset"}}}),N=Object(y.a)({welcomeText:{zIndex:3,position:"absolute",right:"10px",top:"49px",fontSize:"12px",fontWeight:600,color:E.a.colorNeutralForeground3,"@media (max-width: 768px)":{width:"50%"}},highlightedLink:{color:"#BC1948",fontSize:"12px",fontWeight:600},streamClassicLink:{textDecorationLine:"underline",color:E.a.colorNeutralForeground1,fontSize:"12px",fontWeight:600}}),A={containerStyles:{paddingTop:"48px",paddingBottom:"44px"},cardConfig:{cardType:"presentation"}},M=function(){var e=Object(p.a)().data.createSectionResources,t=Object(c.a)().data,n=Object(s.a)().data;return C.a.createElement("div",null,C.a.createElement(R,{resources:e,context:t}),C.a.createElement(D,{resources:e,context:t,featureGates:n}))},D=function(e){var t,n,o,i,s,l,p=e.resources,f=e.context,x=e.featureGates,T=I(),y=Object(_.a)().data,F=null!==(n=null===(t=null==y?void 0:y.result)||void 0===t?void 0:t.OneDriveResourceId)&&void 0!==n?n:"",E=Object(g.a)("Templates",h.c.CreateTile,h.e.uploadV1).openFileSelector,N=function(){var e=Object(P.a)(),t=Object(c.a)().data,n=Object(w.useCallback)((function(n){var r="".concat(n,"_tile_").concat(e?"dark":"light");return Object(k.a)(null==t?void 0:t.cdnDomain,"officestartresources",r,"svg")}),[null==t?void 0:t.cdnDomain,e]),r=n("upload"),a=n("recording"),o=n("playlist"),i=n("camera_recording_v2");return Object(w.useMemo)((,[r,a,o,i])}(),M=N.playlistSrc,D=N.screenRecordingSrc,R=N.uploadSrc,q=N.cameraRecordingSrc,L=Object(O.a)({area:"Templates",source:h.c.CreateTile,version:h.e.uploadV2}).openFileSelector,B=Object(U.a)("partnerCid"),G=Object(w.useContext)(j.a),z=Object(w.useCallback)((function(){var e,t,n,a,o={};B&&(o.PartnerCorrelationId=B),(null===(a=null===(n=null==x?void 0:x.result)||void 0===n?void 0:n.streamUploadV2Gates)||void 0===a?void 0:a.streamUploadV2Enabled)?(G&&G.onUploadClick&&G.onUploadClick(),L(),Object(m.a)({featureName:"Upload",eventName:"Create_Upload_Clicked",params:Object(r.__assign)(Object(r.__assign)({},o),(e={},e.ItemCategory=h.c[h.c.CreateTile],e.Version=h.e[h.e.uploadV2],e))})):(E(),Object(m.a)({featureName:"Upload",eventName:"Create_Upload_Clicked",params:Object(r.__assign)(Object(r.__assign)({},o),(t={},t.ItemCategory=h.c[h.c.CreateTile],t.Version=h.e[h.e.uploadV1],t))})),Object(v.a)({type:"Click",eventName:"Stream_Create_Section_Upload_Clicked",id:"StreamCreateTileSection",area:"Templates",result:"Open",target:"Other"})}),[B,null===(i=null===(o=null==x?void 0:x.result)||void 0===o?void 0:o.streamUploadV2Gates)||void 0===i?void 0:i.streamUploadV2Enabled,G,L,E]),X=Object(w.useCallback)((function(e,t){var n="".concat(F,"/_layouts/15/stream.aspx?action=create&referrer=OfficeHome&referrerScenario=StreamStartPage&cid=").concat(e.correlationId);t&&(n+="&captureMode=screenrecorder"),Object(v.a)({type:"Click",eventName:t?"Stream_Create_Section_Screen_Recording_Clicked":"Stream_Create_Section_Recording_Clicked",id:"StreamCreateTileSection",area:"Templates",result:"Open",target:"Other"}),Object(S.a)(n)?Object(d.a)(n,{action:"OpenInBrowser",linkTarget:"_blank"}):Object(b.a)({eventName:t?"Stream_Create_Section_Screen_Recording_Clicked":"Stream_Create_Section_Recording_Clicked",errorType:"Invalid_Open_Link_Url",message:"Invalid URL"})}),[F]),W=Object(w.useCallback)((function(e){var t="".concat(F,"/_layouts/15/lists.aspx?openListTemplateId=3a867b4a-7429-0e1a-b02e-bf4b240ff1ce&workload=Stream&cid=").concat(e.correlationId);Object(v.a)({type:"Click",eventName:"Stream_Create_Section_Playlist_Clicked",id:"StreamCreateTileSection",area:"Templates",result:"Open",target:"Other"}),Object(S.a)(t)?Object(d.a)(t,{action:"OpenInBrowser",linkTarget:"_blank"}):Object(b.a)({eventName:"Stream_Create_Section_Playlist_Clicked",errorType:"Invalid_Open_Link_Url",message:"Invalid URL"})}),[F]),V=null===(l=null===(s=null==x?void 0:x.result)||void 0===s?void 0:s.streamScreenRecordingGates)||void 0===l?void 0:l.streamScreenRecordingEnabled,Q=function(e){return C.a.createElement(a.a,{className:T.createCardBlankWorkbookPresentation},C.a.createElement("img",{src:e.src,alt:e.altText}))},H={onClick:z,name:p.uploadTileTextStream,cardPreview:C.a.createElement(Q,{src:R,altText:p.uploadTileTextStream})},Z={onClick:function(){f&&X(f)},name:V?p.cameraRecordingTileTextStream:p.recordingTileTextStream,cardPreview:C.a.createElement(Q,{src:V?q:D,altText:V?p.cameraRecordingTileTextStream:p.recordingTileTextStream})},J={onClick:name:p.playlistTileTextStream,cardPreview:C.a.createElement(Q,{src:M,altText:p.playlistTileTextStream})},Y=[H,Z,J];return V&&(Y=[H,{onClick:name:p.screenRecordingTileTextStream,cardPreview:C.a.createElement(Q,{src:D,altText:p.screenRecordingTileTextStream})},Z,J]),C.a.createElement(u.a,{createItems:Y,config:A,sectionTitle:p.createSectionTitle,createItemCardCssOverride:T.cssOverrideForCard,cardsContainerCssOverride:T.cssOverrideForCardsContainer})},R=function(e){var t=e.resources,n=e.context,r=N(),a=Object(l.a)().data,c=("prod"==(null==n?void 0:n.deploymentEnvironment)||"prodprv"==(null==n?void 0:n.deploymentEnvironment))&&(null==n?void 0:n.workload)!==f.a.Embed;return C.a.createElement(o.a,{className:r.welcomeText},t.welcomeToTextStream,C.a.createElement(i.a,{href:"https://learn.microsoft.com/stream/streamnew/new-stream",target:"_blank",className:r.highlightedLink},t.streamOnSharePointTextStream),"."," ",c?C.a.createElement(C.a.Fragment,null,Object(x.format)(t.streamMigratedContentString,C.a.createElement(i.a,{onClick:function(){var e={pp:"".concat(null==a?void 0:a.objectId,"@").concat(null==a?void 0:a.tenantId,"|").concat(null==a?void 0:a.loginHint),refiners:'{"FileType":["video"]}'};null==n||n.router.navigateTo({route:"SearchPersonScoped"},!1,e).then((function(){return Object(v.a)({type:"Click",eventName:"Stream_Search",id:"StreamSearch",area:"StartPage",result:"Open",target:"SearchResults"})})).catch((function(){return Object(b.a)({eventName:"Stream_Search",errorType:"Routing_Error",message:"Error in Routing"})}))},className:r.highlightedLink},t.streamSearch),C.a.createElement(i.a,{href:T,target:"_blank",className:r.streamClassicLink},t.streamClassic))):C.a.createElement(C.a.Fragment,null,t.streamClassicTextStream," ",C.a.createElement(i.a,{href:T,target:"_blank",className:r.streamClassicLink},t.clickHereTextStream),"."))}},"9pOv":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("QjXU"),a=n("mgFK"),o=n("6ib3"),i=n("aADZ"),c={key:"UploadConfig",isGetClientGeneratedConfigEnabled:getClientGeneratedConfig:function(e){var t,n,r,a,c,u,s,l,d,p,f,m,v,b,g,O,j=e.featureSettings,h=Object(i.a)(null===(t=j.upload)||void 0===t?void 0:t.discreteChunkSizeInBytes),S=Object(i.a)(null===(n=j.upload)||void 0===n?void 0:n.fragmentTimeoutInMilliseconds),_=Object(i.a)(null===(r=j.upload)||void 0===r?void 0:r.initialFragmentDivisor),U=Object(i.a)(null===(a=j.upload)||void 0===a?void 0:a.initialWaitDurationInMilliseconds),w=Object(i.a)(null===(c=j.upload)||void 0===c?void 0:c.maxFragmentDivisor),C=Object(i.a)(null===(u=j.upload)||void 0===u?void 0:u.maxFragmentSizeInBytes),x=Object(i.a)(null===(s=j.upload)||void 0===s?void 0:s.maxWaitDurationInMilliseconds),T=Object(i.a)(null===(l=j.upload)||void 0===l?void 0:l.minFragmentSizeInBytes),P=Object(i.a)(null===(d=j.upload)||void 0===d?void 0:d.numAttemptsOnClientError),k=Object(i.a)(null===(p=j.upload)||void 0===p?void 0:p.numAttemptsOnServerError),y=Object(i.a)(null===(f=j.upload)||void 0===f?void 0:f.simpleUploadMaxSize),F=Object(i.a)(null===(m=j.upload)||void 0===m?void 0:m.slowDowngradeDivisor),E=Object(i.a)(null===(v=j.upload)||void 0===v?void 0:v.downgradeDivisor),I=Object(i.a)(null===(b=j.upload)||void 0===b?void 0:b.slowFragmentTimeoutMultiplier),N=Object(i.a)(null===(g=j.upload)||void 0===g?void 0:g.standardWaitDurationInMilliseconds),A=Object(i.a)(null===(O=j.upload)||void 0===O?void 0:O.upgradePowerDivisor);return{discreteChunkSize:h,editableFileTypes:new Set([o.a.Excel,o.a.Word,o.a.PowerPoint]),fragmentTimeoutInMs:S,initialSpeed:1/_,initialWaitDurationInMs:U,maxFragmentSize:C,maxWaitDurationInMs:x,minFragmentSize:T,minSpeed:1/w,numClientAttempts:P,numServerAttempts:k,simpleUploadMaxSize:y,slowFragmentTimeoutMultiplier:I,slowSpeedDowngradeRatio:1/F,speedDowngradeRatio:1/E,speedUpgradeRatio:Math.pow(2,1/A),standardWaitDurationInMs:N,uploadFileTypes:new Set([o.a.Excel,o.a.Word,o.a.Pdf,o.a.PowerPoint,o.a.Visio,o.a.Stream])}},getServerGeneratedConfig:function(e){return function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(a.a)("uploadConfig",e)];case 1:if(!(t=n.sent()))throw new Error("Cannot parse UploadConfig");return[2,Object(r.__assign)(Object(r.__assign)({},t),{uploadFileTypes:new Set([o.a.Excel,o.a.Word,o.a.Pdf,o.a.PowerPoint,o.a.Visio,o.a.Stream]),editableFileTypes:new Set([o.a.Excel,o.a.Word,o.a.PowerPoint])})]}}))}))}(e)}}},B7gc:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("lUkk"),a=n("mXGw"),o=n("bcUD"),i=n("u9fO"),c=n("XlCq"),u=n("lJoY"),s=n("vaZn"),l=function(e){var t=Object(s.a)(),n=function(e){var t=function(){var e=function(){var e=Object(u.a)();return"Pwa"===(null==e?void 0:e.route)?"cmm8gnwxv06":"cmmhp9cy416"}();return Object(a.useMemo)((function(){return Object(i.a)(c.b,"ocid",e)}),[e])}(),n=Object(o.a)({experiences:[e]}),r=Object(a.useCallback)((,[e,n,t]);return Object(a.useMemo)((,[r,n])}(e),l=Object(a.useCallback)((function(e){Object(r.a)({type:"Click",id:"StorageErrorUpsell",area:"Upsell",subArea:e,result:"Navigate",target:"Other",eventName:"StorageError_Upsell"}),n&&n()}),[n]);return Object(a.useMemo)((function(){if(t)return{caption:t.upsellButtonText,description:t.upsellButtonText,onClick:l,showDime:!!n}}),[t,l,n])}},BCEv:C2Jl:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("slmW");function a(e){if(e.fileType&&!e.isEmailAttachment&&e.canonicalUrl){var t=Object(r.a)(e.fileType);if(t){var n=e.canonicalUrl.lastIndexOf("?"),a=e.canonicalUrl;return n>0&&(a=e.canonicalUrl.substring(0,n)),"".concat(t).concat(a)}}}},CBRv:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("QjXU"),a=n("kb6k"),o=n("lAHu");function i(e,t,n,i,c,u,s,l,d,p,f,m){void 0===f&&(f={});var v=Object(r.__assign)(Object(r.__assign)({},c),{url:n,method:"DELETE",body:i});return Object(a.a)((function(n){return Object(o.a)(e,t,n,l,d,void 0,f.populateRequestEvent,f.onUploadProgress,f.onDownloadProgress,f.cancellationToken,f.timeoutInMs)}),e,t,v,u,s,p,f.mockParam,f.resourceUrl,f.rpsHeaderPrefix,f.additionalAuthErrors,f.isRetriableError,f.updateRequestWithAuth,void 0,void 0,void 0,m)}},HNLS:function(e,t,n){"use strict";function r(e){if("itemId"in e)return"".concat(e.drivePath,"items/").concat(e.itemId,"/");var t=e.drivePath,n=e.file,r=e.parent,a=e.path,o=a?"root:/".concat(a,"/"):r?"items/".concat(r,":/"):"root:/";return"".concat(t).concat(o).concat(encodeURIComponent(n.name),":/")}n.d(t,"a",(function(){return r}))},HeHW:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("FPnS"),a=n("io1X");function o(){return Object(a.a)()==r.a.dark}},IIIn:function(e,t,n){"use strict";function r(e){return e.parent?e.parent.parentReference.driveId:void 0}n.d(t,"a",(function(){return r}))},IqTF:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("QjXU"),a=n("8wW2"),o=n("a3FV"),i=n("cy7S"),c=n("gI4v"),u=n("HNLS"),s=n("fNDz"),l=n("PvZE");function d(e){var t=e.cancellationToken,n=e.conflictBehavior,d=void 0===n?"rename":n,p=e.driveId,f=e.file,m=e.graphXhrOptions,v=e.itemId,b=e.onUploadProgress,g=e.parent,O=e.path,j=e.sessionId,h=e.setAutoTranscribePreferHeader;return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,n,S,_,U;return Object(r.__generator)(this,(function(w){return d=v?"replace":d,e={drivePath:p?"drives/"+p+"/":c.a},n=v?Object(r.__assign)(Object(r.__assign)({},e),{itemId:v}):Object(r.__assign)(Object(r.__assign)({},e),{file:f,parent:g,path:O}),S="".concat(Object(u.a)(n),"content?@microsoft.graph.conflictBehavior=").concat(d,"&select=webDavUrl,*"),_=Object(s.a)(m.graphApiRoot,S),U={method:"PUT",headers:{"Content-Type":"application/json"}},h&&(U.headers.Prefer="autoTranscribe"),[2,new Promise((function(e,n){Object(i.a)(o.a.OneDriveGraphUploadFileRequest,"OneDrive_Graph_Upload_File",_,f,U,m.jwtAuthEnabled,m.getAccessToken,m.officeApiRoot,m.correlationId,"Graph",{onUploadProgress:b,populateRequestEvent:function(e,t){var n=Object(r.__assign)({},t);n.TotalSize=f.size.toString(),Object(l.a)("OneDrive_Graph_Upload_File",j,e,n)},cancellationToken:t}).then((function(t){var r,a,o;if(t.data&&t.data.webUrl&&t.data.id){var i={canonicalUrl:t.data.webDavUrl,createdByUserGivenName:null!==(o=null===(a=null===(r=t.data.createdBy)||void 0===r?void 0:r.user)||void 0===a?void 0:a.displayName)&&void 0!==o?o:"",docId:t.data.id,downloadUrl:t.data["@microsoft.graph.downloadUrl"],name:t.data.name,webUrl:t.data.webUrl};e(i)}else n({clientError:"Could not parse drive item from Graph response"})})).catch((function(e){var t,o;Object(a.a)().handleError(e,"NWgrO"),n(Object(r.__assign)(Object(r.__assign)({},e),{clientError:null===(o=null===(t=e.httpResponse.data)||void 0===t?void 0:t.error)||void 0===o?void 0:o.code}))}))}))]}))}))}},LHhM:function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));var r=n("QjXU"),a=n("NrNW"),o=n("CU8J"),i=n("PZ4A"),c=n("+jQL"),u=n("Tqea"),s=n("tBub"),l=n("O/XG"),d=n("xvrq"),p=n("l+H3"),f=n("Dn7E"),m=n("d1AP"),v=n("mXGw"),b=n("BCEv"),g=n("RYUs"),O=n("5Ulw"),j=n("MhuU"),h=n("68nG"),S=n("svnf");function _(e,t,n){void 0===t&&(t=m.c.Button);var _=Object(h.a)(),U=Object(j.a)().data,w=Object(a.a)().data,C=Object(r.__read)(Object(p.a)(),2),x=C[0],T=C[1],P=Object(o.a)().data,k=Array.from((null==U?void 0:U.uploadFileTypes.values())||[]).map((function(e){return Object(i.a)(e)||[]})).reduce((function(e,t){return e.concat(t)}),[]).filter((function(e){return""!==e})).map((function(e){return"."+e})),y=Object(S.a)(),F=y.uploadState,E=y.setV1FileUploadState,I=Object(r.__read)(Object(b.useFilePicker)({multiple:!1,accept:k,readAs:"ArrayBuffer"}),4),N=I[0],A=I[1],M=I[2],D=I[3];return Object(v.useEffect)((function(){var a,o,i,p,v=Object(g.a)(t,n);if(A.length&&Object(f.a)({featureName:"Upload",eventName:"File_Picker_Error",params:Object(r.__assign)(Object(r.__assign)({},v),(a={},a.Error=Object(O.a)(A),a))}),(!A||!A.length)&&N&&N.length&&N[0]&&!D){var b=N[0],j=b.name,h=new Blob([b.content],{type:"text/plain"}),S=new File([h],j),U=Object(c.a)(S.name),w=Object(u.a)(U),C=Object(s.a)(S.name);if((null===(p=null===(i=null==P?void 0:P.result)||void 0===i?void 0:i.storageErrorGates)||void 0===p?void 0:p.storageErrorDialogForUploadEnabled)&&T&&T(null==w?void 0:w.toString()))x({workloadId:null==w?void 0:w.toString(),area:"Upload",subArea:"Other",isTemplate:!1});else if(S){var k={sequenceNumber:0,file:S,uploadStatus:m.d.Started,cancellationToken:Object(d.a)(),telemetry:{area:e,source:t,version:n}};Object(f.a)({featureName:"Upload",eventName:"File_Selected",params:Object(r.__assign)(Object(r.__assign)({},v),(o={},o.DocumentType=U,o.Area=e,o))}),E(k),_(k).then((function(e){if(E(void 0,m.d.Completed),e&&e.fileUrlModel){var t=e.fileUrlModel,n={canonicalUrl:t.canonicalUrl,webUrl:t.webUrl,app:w,attribution:t.canonicalUrl,url:t.canonicalUrl,extension:C,title:S.name,id:t.docId||"",fileType:U};Object(l.a)({action:"Upload",inAppNavFileType:U,document:n,useWebUrl:!0,wdOriginType:"UPLOAD"})}})).catch((function(e){e===m.a.UnsupportedType?(Object(f.a)({featureName:"Upload",eventName:"Unsupported_File_Type",params:v}),E(void 0,m.d.Unsupported)):E(void 0,m.d.Failed)})),E(void 0,m.d.Uploading)}}}),[A,N,D,_,w,E]),Object(v.useMemo)((function(){return{v1UploadStatus:F.v1FileUploadState.uploadStatus,openFileSelector:M,resetV1UploadStatus:function(){return E(void 0,m.d.Started,null)}}}),[M,E,F.v1FileUploadState.uploadStatus])}},MhuU:PZ4A:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u}));var r,a,o=n("6ib3");function i(){return(r={})[o.a[o.a.Excel]]=["xls","xlsx","xlb","xlc","xlsb","xlsm","xlt","xltx","xltm","xlm","xla","xll","xlam","xlw","excel","csv"],r[o.a[o.a.Visio]]=["vsd","vss","vst","vdx","vsx","vtx","vsl","vsu","vsw","vsdx","vsdm","vssm","vstx","vstm"],r[o.a[o.a.PowerPoint]]=["ppt","pptx","pot","potx","potm","ppam","ppsx","ppsm","sldx","sldm","ppa","pps","pptm","powerpoint"],r[o.a[o.a.Word]]=["doc","dot","docx","docm","dotx","dotm","docb","word"],r[o.a[o.a.Photos]]=["jpg","png","jpeg","gif","svg","bmp","tif","tiff","heic"],r[o.a[o.a.Outlook]]=["msg","eml"],r[o.a[o.a.OneNote]]=["one"],r[o.a[o.a.Pdf]]=["pdf"],r[o.a[o.a.Audio]]=["mp3","m4a","wav","wma"],r[o.a[o.a.Text]]=["txt"],r[o.a[o.a.Fluid]]=["fluid","loop"],r[o.a[o.a.Stream]]=["mts","m2ts","ts","3g2","3gp","3gp2","3gpp","asf","wmv","avi","m4v","mov","mp4","mp4v","ogg","webm","movie","mkv","mpg","mpeg"],r[o.a[o.a.Whiteboard]]=["whiteboard"],r[o.a[o.a.MeetingNotes]]=["note"],r[o.a[o.a.Clipchamp]]=["clipchamp"],r[o.a[o.a.Link]]=["url"],r[o.a[o.a.Draft]]=["draft"],r[o.a[o.a.Planner]]=["plan"],r}function c(e){return a||(a=function(){r||(r=i()),a={};var e=function(e){if(!r.hasOwnProperty(e))return"continue";var t=r[e];if(!t)return"continue";t.forEach(()};for(var t in r)e(t);return a}()),e&&a[e.toLowerCase()]||o.a.None}function u(e){return r||(r=i()),r[e]}},PvZE:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("Dn7E"),a=n("zPk6");function o(e,t,n,o){var i=o||{};t&&(i.UploadSessionId=t),n&&(i.RequestId=Object(a.a)(n)||""),Object(r.a)({featureName:"Upload",eventName:e,params:i})}},RV7E:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return i}));var r=new(n("AlWG").a)(null);YUs:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("d1AP"),a=n("JYsJ"),o=function(e,t){var n={},o=Object(a.a)("partnerCid");return void 0!==e&&(n.ItemCategory=r.c[e]),void 0!==t&&(n.Version=r.e[t]),o&&(n.PartnerCorrelationId=o),n}},TdXu:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("mXGw"),a=n("dr7E");.useFilePicker=function(e){var t=e.accept,n=void 0===t?"*":t,i=e.multiple,c=void 0===i||i,u=e.readAs,s=void 0===u?"Text":u,l=e.minFileSize,d=e.maxFileSize,p=e.limitFilesConfig,f=r.useState([]),m=f[0],v=f[1],b=r.useState([]),g=b[0],O=b[1],j=r.useState([]),h=j[0],S=j[1],_=r.useState(!1),U=_[0],w=_[1];return r.useEffect((function(){if(0!==m.length){if(p){if(p.max&&m.length>p.max)return void S((function(e){return[{maxLimitExceeded:!0}].concat(e)}));if(p.min&&m.length<p.min)return void S((function(e){return[{minLimitNotReached:!0}].concat(e)}))}w(!0);var e=m.map((function(e){return new Promise((function(t,n){var r=new FileReader;r["readAs"+s].call(r,e),r.onload=function(){l&&e.size<1e6*l&&a({fileSizeTooSmall:!0}),d&&e.size>1e6*d&&a({fileSizeToolarge:!0}),t({content:r.result,name:e.name,lastModified:e.lastModified})},r.onerror=var a=function(t){var r=t.name,a=void 0===r?e.name:r,i=t,["name"]);n(o({name:a,fileSizeToolarge:!1,fileSizeTooSmall:!1},i))}}))}));Promise.all(e).then(().catch((function(e){S(()})).finally(()}else O([])}),[m]),[g,h,function(){!function(e,t,n){var r=document.createElement("input");r.type="file",r.accept=e,r.multiple=t,r.addEventListener("change",(),r.dispatchEvent(new MouseEvent("click"))}(n instanceof Array?n.join(","):n,c)},U]}},Tqea:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("6ib3");function a(e){switch(e){case r.a.Word:return"Word";case r.a.Excel:return"Excel";case r.a.PowerPoint:return"PowerPoint";case r.a.OneNote:case r.a.OneNoteClassNoteBook:case r.a.OneNotePage:return"OneNote";case r.a.Pdf:return"PDF";case r.a.Visio:return"Visio";case r.a.Audio:return"Audio";case r.a.Video:return"Video";case r.a.Photos:return"Photos";case r.a.Outlook:return"Outlook";case r.a.Text:return"Text";case r.a.Sway:return"Sway";case r.a.Forms:case r.a.FormsQuiz:return"Forms";case r.a.Project:return"Project";case r.a.ProjectOperations:return"ProjectOperations";case r.a.Portfolio:return"Portfolio";case r.a.NewsArticle:return"NewsArticle";case r.a.Fluid:case r.a.MeetingNotes:return"Loop";case r.a.PowerBI:return"PowerBI";case r.a.StreamsVideo:return"Streams";case r.a.Stream:return"Stream";case r.a.ScreenRecording:return"ScreenRecording";case r.a.UpcomingMeeting:return"UpcomingMeeting";case r.a.Link:return"Link";case r.a.List:return"List";case r.a.PlayLists:return"PlayLists";case r.a.PlayList:return"PlayList";case r.a.MindMeister:return"MindMeister";case r.a.Monday:return"monday.com";case r.a.Trello:return"Trello";case r.a.Platform:return"Platform";case r.a.Whiteboard:return"Whiteboard";case r.a.MeetingObject:return"MeetingObject";case r.a.ThirdParty:return"Custom";case r.a.MyAnalytics:return"MyAnalytics";case r.a.Designer:return"Designer";case r.a.Clipchamp:return"Clipchamp";case r.a.Draft:return"Draft";case r.a.Planner:return"Planner";case r.a.ToDo:return"ToDo";default:return"Document"}}},UKGo:function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));var r=n("QjXU"),a=n("+jQL"),o=n("ZcZ3"),i=n("V8LI"),c=n("lOFt"),u=n("a3FV"),s=n("lUkk"),l=n("rTyw"),d=n("d1AP"),p=n("AlWG"),f=n("wSOj"),m=n("ZbLT"),v=n("5eS3"),b=n("zIbX");function g(e,t,n,r){return t.state=d.b.Started,n.next(t),function(e,t,n){return function(e,t,n){return O(e,t,{},n)}(e,t,n).then((function(e){var r={};e.webDavUrl&&(r.canonicalUrl=e.webDavUrl);var o=e.webUrl,i=Object(a.a)(t.file.name);if(i&&n.editableFileTypes.has(i)){var c="action=edit";-1===(o=o.replace(new RegExp("([?&])action[^&]*"),"$1action=edit")).lastIndexOf(c)&&(o=Object(v.a)(o,c))}return r.webUrl=o,r}))}(e,t,r).then((function(e){t.result=e,t.state=d.b.Completed,n.next(t)}),()}function O(e,t,n,r){var a=n.sessionUrl,o=n.item,c=n.error;return t.sessionUrl=a,new Promise((function(u,s){o?u(o):c?a?Object(i.a)(e,a,t.sessionId).catch(().then(():s(c):Object(b.a)(e,t,n,t.cancellationToken,r).then((function(n){O(e,t,n,r).then(u,s)}),s)}))}var j=n("UaN+"),h=n("IIIn"),S=n("95Ql"),_=function(e){var t=e.fileUploadState,n=e.updateFileUploadState,v=e.graphXhrOptions,b=e.uploadConfig,O=e.componentContext;return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e,_,U,w,C,x,T,P,k,y,F,E;return Object(r.__generator)(this,(function(r){return v&&b&&O?t&&t.file?(e=O.sessionId||"",_=performance.now(),U=Object(j.a)(t),w=Object(h.a)(t),C={sessionId:e,file:t.file,uploadSource:t.telemetry.source,cancellationToken:t.cancellationToken,bytesUploaded:0,state:d.b.Started,startTime:_,progress:new p.a(Object(m.a)(0,t.file.size)),fileSize:t.file.size,lastLoaded:0,path:U,driveId:w},x=Object(a.a)(t.file.name),T=!1,P=d.c[t.telemetry.source],k=(null==b?void 0:b.uploadFileTypes.has(x))?Object(o.a)(x):"Documents",y=function(n){T||(T=!0,function(e){var t=e.elementId,n=e.success,r=e.area,a=e.referralType,o=e.platform,i=function(e){var t=e.elementId,n=e.uploadSource,r=e.buttonOrigin,a=e.numDocuments,o={};return o.UploadSessionId=e.sessionId,t=r?"".concat(t,"-").concat(r):t,o.ElementId=t,o.ItemCount=(a||0).toString(),o.ItemCategory=d.c[n],{eventName:u.a.UploadClick,params:o,metrics:[]}}({elementId:t,sessionId:e.sessionId,uploadSource:e.uploadSource});Object(c.a)(i.eventName,t,r,n?a:"",o,i.params,i.metrics),n&&Object(s.a)({eventName:i.eventName,id:t,area:r,result:"Refer",target:Object(l.a)(a)})}({elementId:P,sessionId:e,uploadSource:t.telemetry.source,_fileType:x,success:n,area:t.telemetry.area,referralType:k}))},F=new p.a(C),C.progress.subscribe((function(e){n&&t&&t.sequenceNumber&&n({sequenceNumber:t.sequenceNumber,progress:e.loaded/e.total,uploadStatus:d.d.Uploading})})),E=!1,F.subscribe((function(r){r.state===d.b.Completed?(n&&t&&t.sequenceNumber&&n({sequenceNumber:t.sequenceNumber,progress:1,uploadStatus:d.d.Completed}),E=!0,y(!0),Object(S.a)(e,f.a.Success,_,t)):r.state===d.b.Cancelled?(F.unsubscribe(),E?n&&t&&t.sequenceNumber&&n({sequenceNumber:t.sequenceNumber,progress:1,uploadStatus:d.d.Completed}):(n&&t&&t.sequenceNumber&&n({sequenceNumber:t.sequenceNumber,progress:1,uploadStatus:d.d.Cancelled}),y(!1),Object(S.a)(e,f.a.Cancelled,_,t))):r.state===d.b.Failed&&(n&&t&&t.sequenceNumber&&n({sequenceNumber:t.sequenceNumber,progress:1,uploadStatus:d.d.Failed,error:r.error}),y(!1),Object(S.a)(e,f.a.Failed,_,t))})),C.cancellationToken.onCancel((function(){C.sessionUrl&&!C.state)&&Object(i.a)(v,C.sessionUrl,C.sessionId),C.state=d.b.Cancelled,F.next(C)})),[2,new Promise((function(e,n){g(v,C,F,b).then((function(){C.result?(t.fileUrlModel=C.result,t.progress=1,t.uploadStatus=d.d.Completed,e(t)):n(d.a.Unknown)}))}))]):[2,Promise.reject("Missing file")]:[2,Promise.reject("Missing configs")]}))}))}},"UaN+":function(e,t,n){"use strict";function r(e){return e.parent?e.parent.webDavUrl.replace(e.parent["@sharePoint.listUrl"],""):void 0}n.d(t,"a",(function(){return r}))},Ug56:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("6ib3"),a=n("+jQL"),o=n("mXGw"),i=n("MhuU"),c=function(){var e,t=null===(e=Object(i.a)())||void 0===e?void 0:e.data;return Object(o.useCallback)((function(e){if(!t||!e)return r.a.None;var n=e&&Object(a.a)(e);return n&&t.uploadFileTypes.has(n)?n:r.a.None}),[t])}},"V+NM":function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n("QjXU"),a=n("6ib3"),o=n("PZ4A"),i=n("xvrq"),c=n("Dn7E"),u=n("d1AP"),s=n("mXGw"),l=n("BCEv"),d=n("RYUs"),p=n("5Ulw"),f=n("Ug56"),m=n("MhuU"),v=n("svnf");function b(e){var t=e.area,n=e.source,b=e.version,g=Object(m.a)().data,O=Object(f.a)(),j=Array.from((null==g?void 0:g.uploadFileTypes.values())||[]).map((function(e){return Object(o.a)(e)||[]})).reduce((,[]).filter((function(e){return""!==e})).map((),h=Object(v.a)(),S=h.uploadState,_=h.addFileUploadState,U=h.setShowUploadFileUnsupportedDialog,w=Object(r.__read)(Object(l.useFilePicker)({multiple:!1,accept:j,readAs:"ArrayBuffer"}),4),C=w[0],x=w[1],T=w[2],P=w[3];return Object(s.useEffect)((function(){var e,o,s=Object(d.a)(n,b);if(x.length&&Object(c.a)({featureName:"Upload",eventName:"File_Picker_Error",params:Object(r.__assign)(Object(r.__assign)({},s),(e={},e.Error=Object(p.a)(x),e))}),(!x||!x.length)&&C&&C.length&&C[0]&&!P){var l=C[0],f=l.name,m=l.content,v=O(f);if(v===a.a.None)U(!0),Object(c.a)({featureName:"Upload",eventName:"Unsupported_File_Type",params:s});else{var g=new Blob([m],{type:"text/plain"}),j=new File([g],f);j&&(_({sequenceNumber:S.nextSequenceNumber,file:j,uploadStatus:u.d.Started,progress:0,cancellationToken:Object(i.a)(),telemetry:{area:t,source:null!=n?n:u.c.Button,version:b}}),Object(c.a)({featureName:"Upload",eventName:"File_Selected",params:Object(r.__assign)(Object(r.__assign)({},s),(o={},o.DocumentType=v,o.Area=t,o))}))}}}),[x,C,O,P,_,U,t]),Object(s.useMemo)((,[T])}},V8LI:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("QjXU"),a=n("8wW2"),o=n("a3FV"),i=n("CBRv"),c=n("PvZE");function u(e,t,n){return Object(i.a)(o.a.OneDriveGraphCancelUploadSessionRequest,"OneDrive_Graph_Cancel_Upload_Session",t,{},{},e.jwtAuthEnabled,e.getAccessToken,e.officeApiRoot,e.correlationId,"Graph",{populateRequestEvent:function(e,t){var a=Object(r.__assign)({},t);Object(c.a)("OneDrive_Graph_Cancel_Upload_Session",n,e,a)}}).catch((function(e){throw Object(a.a)().handleError(e,"wQvvW"),e}))}},XlCq:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var r="https://go.microsoft.com/fwlink/?linkid=2228772",a="login_hint"},ZbLT:function(e,t,n){"use strict";function r(e,t){return{percentage:Math.floor(100*e/t),loaded:e,total:t}}n.d(t,"a",(function(){return r}))},ZcZ3:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("6ib3"),a=n("Tqea");function o(e){switch(e){case r.a.Word:return"WordOnline";case r.a.Excel:return"ExcelOnline";case r.a.PowerPoint:return"PowerPointOnline";case r.a.OneNote:return"OneNoteOnline";case r.a.Sway:return"Sway";case r.a.Visio:return"VisioOnline";case r.a.Project:case r.a.ProjectOperations:case r.a.Portfolio:return"Project";case r.a.PowerBI:return"PowerBIv2";default:return Object(a.a)(e)}}},ZrMS:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("faS/"),a=n("pKjf"),o=n("mXGw"),i=function(){var e=Object(r.a)({area:"WelcomeBadge",logFullQuota:!0});return Object(o.useMemo)((function(){var t=null==e?void 0:e.storageAlertLevel;return!!t&&(t===a.a.Over||t===a.a.Full)}),[null==e?void 0:e.storageAlertLevel])}},am3b:bcvx:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("QjXU"),a=n("+jQL"),o=n("d1AP"),i=n("UKGo"),c=n("k34z"),u=n("8mU8"),s=function(e){var t=e.componentContext,n=e.featureGates,s=e.fileUploadState,l=e.graphXhrOptions,d=e.updateFileUploadState,p=e.uploadConfig;return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e,f,m,v,b;return Object(r.__generator)(this,(function(r){return(e=(null===(f=s.file)||void 0===f?void 0:f.name)&&Object(a.a)(s.file.name))&&(null==p?void 0:p.uploadFileTypes.has(e))?(s.retries=3,[2,!(null===(m=null==s?void 0:s.file)||void 0===m?void 0:m.size)||s.file.size<p.simpleUploadMaxSize?(null===(b=null===(v=null==n?void 0:n.result)||void 0===v?void 0:v.uploadRetryGates)||void 0===b?void 0:b.uploadRetryEnabled)?Object(c.a)({fileUploadState:s,updateFileUploadState:d,graphXhrOptions:l,componentContext:t}):Object(u.a)({fileUploadState:s,updateFileUploadState:d,graphXhrOptions:l,componentContext:t}):Object(i.a)({fileUploadState:s,updateFileUploadState:d,graphXhrOptions:l,uploadConfig:p,componentContext:t})]):[2,Promise.reject(o.a.UnsupportedType)]}))}))}},cy7S:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("QjXU"),a=n("kb6k"),o=n("lAHu");function i(e,t,n,i,c,u,s,l,d,p,f,m){void 0===f&&(f={});var v=Object(r.__assign)(Object(r.__assign)({},c),{url:n,method:"PUT",body:i});return Object(a.a)((function(n){return Object(o.a)(e,t,n,l,d,void 0,f.populateRequestEvent,f.onUploadProgress,f.onDownloadProgress,f.cancellationToken,f.timeoutInMs)}),e,t,v,u,s,p,f.mockParam,f.resourceUrl,f.rpsHeaderPrefix,f.additionalAuthErrors,f.isRetriableError,f.updateRequestWithAuth,void 0,void 0,void 0,m)}},d1AP:function(e,t,n){"use strict";var r,a,o,i,c;n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return c})),r||(r={})),function(e){e[e.Button=0]="Button",e[e.DragAndDrop=1]="DragAndDrop",e[e.CreateMenu=2]="CreateMenu",e[e.Unknown=3]="Unknown",e[e.CreateTile=4]="CreateTile"}(a||(a={})),o||(o={})),i||(i={})),c||(c={}))},dr7E:function(e,t,n){"use strict";n.r(t),n.d(t,"fromEvent",(function(){return c}));var r=n("QjXU"),a=new Map([["avi","video/avi"],["gif","image/gif"],["ico","image/x-icon"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["mkv","video/x-matroska"],["mov","video/quicktime"],["mp4","video/mp4"],["pdf","application/pdf"],["png","image/png"],["zip","application/zip"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"]]);ar i=[".DS_Store","Thumbs.db"];function c(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,()}))}nction l(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,()}))}n O(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,()}))}},f6UF:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("mXGw");function a(e,t,n){var a=[];return e.forEach((function(e){if("string"==typeof e){var o=new RegExp("\\{"+n+"\\}","gi");if("string"==typeof t||"number"==typeof t)a.push(e.replace(o,""+t));else{var i=e.split(o);i.forEach((function(e,n){e&&function(e){var t=[],n=!1,a=!1;return e.match(/^\s+/gi)&&(e=e.replace(/^\s+/gi,""),n=!0),e.match(/\s+$/gi)&&(e=e.replace(/\s+$/gi,""),a=!0),n&&t.push(r.createElement(r.Fragment,null," ")),t.push(e),a&&t.push(r.createElement(r.Fragment,null," ")),t}(e).forEach})),n+1<i.length&&a.push(t)}))}}else a.push(e)})),a}t.WhiteSpaceChar="&nbsp;",t.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=[e];return t.forEach})),0===o.length?"":1===o.length&&"string"==typeof o[0]?o[0]:r.createElement(r.Fragment,null,o.map})))}},gI4},jwpY:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("QjXU"),a=n("kb6k"),o=n("lAHu");function i(e,t,n,i,c,u,s,l,d,p,f,m,v){void 0===f&&(f={});var b="cache-only"===m;b&&(p="None");var g=Object(r.__assign)(Object(r.__assign)({},c),{url:n,method:"POST",body:i});return Object(a.a)((function(n){return Object(o.a)(e,t,n,l,d,m,f.populateRequestEvent,f.onUploadProgress,f.onDownloadProgress,f.cancellationToken,f.timeoutInMs)}),e,t,g,u,s,p,f.mockParam,f.resourceUrl,f.rpsHeaderPrefix,f.additionalAuthErrors,f.isRetriableError,f.updateRequestWithAuth,b,void 0,void 0,v)}},k34z:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n("QjXU"),a=n("+jQL"),o=n("FZB6"),i=n("IqTF"),c=n("lUkk"),u=n("d1AP"),s=n("wSOj"),l=n("UaN+"),d=n("IIIn"),p=n("95Ql"),f=function(e){var t=e.fileUploadState,n=e.updateFileUploadState,f=e.graphXhrOptions,m=e.componentContext;return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e,v,b,g,O,j,h,S,_,U;return Object(r.__generator)(this,(function(w){switch(w.label){case 0:return f?t&&t.file?(e=(null==m?void 0:m.sessionId)||"",v=performance.now(),b=Object(l.a)(t),g=Object(d.a)(t),O=!1,[4,(j=function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return O=!0,[4,Object(i.a)({cancellationToken:t.cancellationToken,driveId:g,file:t.file,graphXhrOptions:f,path:b,onUploadProgress:function(e){n&&t&&t.sequenceNumber&&n({sequenceNumber:t.sequenceNumber,progress:e.total?e.loaded/e.total:0,uploadStatus:u.d.Uploading})},setAutoTranscribePreferHeader:!0}).catch}))];case 1:return[2,e.sent()]}}))}))})()]):[2,Promise.reject("Missing file")]:[2,Promise.reject("Missing graphXhrOptions")];case 1:h=w.sent(),},w.label=2;case 2:return h.docId?[3,7]:t.retries&&t.retries>0&&!O?(t.retries=t.retries-1,t.uploadStatus=u.d.Queued,[4,S(1e3)]):[3,5];case 3:return w.sent(),[4,j()];case 4:return h=w.sent(),[3,6];case 5:return n&&n({sequenceNumber:t.sequenceNumber,progress:1,uploadStatus:u.d.Failed,error:h}),Object(p.a)(e,s.a.Failed,v,t),[2,Promise.reject(h)];case 6:return[3,2];case 7:return h.docId?(_=(null===(U=t.file)||void 0===U?void 0:U.name)&&Object(a.a)(t.file.name),Object(c.a)({eventName:"Upload_Click",id:"Upload_Click",area:t.telemetry.area,result:"Refer",target:_?Object(o.a)(_):"Documents"}),Object(p.a)(e,s.a.Success,v,t),t.fileUrlModel=h,t.progress=1,t.uploadStatus=u.d.Completed,[2,t]):[2,t]}}))}))}},"l+H3":function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("faO/"),a=n("RV7E"),o=n("a3FV"),i=n("lUkk"),c=n("mXGw"),u=n("ZrMS"),s=n("CU8J"),l=n("3+RV"),d=n("B7gc"),p=function(){var e=function(){var e=Object(u.a)(),t=function(){var e=Object(s.a)().data;return Object(c.useMemo)((function(){var t,n;return(null===(n=null===(t=null==e?void 0:e.result)||void 0===t?void 0:t.storageErrorGates)||void 0===n?void 0:n.storageErrorDialogEnabled)||!1}),[e])}();return Object(c.useMemo)}),[e,t])}(),t=Object(l.a)(),n=Object(d.a)(r.a.WelcomeBadge),p=Object(c.useMemo)}),[]),f=Object(c.useMemo)}),[]),m=Object(c.useMemo)((function(){var e=Object.assign({},p);return n&&n.showDime&&n.onClick&&(e=Object.assign(e,{onActionClicke}})),t&&t.link&&(e=Object.assign(e,{fallbackSiteUrl:t.link})),e}),[p,t,n]),v=Object(c.useCallback)((function(e){var n=e.workloadId,r=e.area,c=e.subArea,u=e.isTemplate;t&&t.link&&n&&(Object(i.a)({eventName:u?o.a.TemplateClick:o.a.CreateLinkClick,id:n,area:r,subArea:c,result:"Navigate",target:"Other"}),Object(i.a)({eventName:o.a.ShowStorageErrorDialog,id:n,area:r,subArea:c,result:"Block",target:"Other"}),Object(a.c)(m))}),[m,t]),b=Object(c.useCallback)((function(t){return!!t&&e&&f.indexOf(t)>=0}),[e,f]);return Object(c.useMemo)}),[b,v])}},nX9G:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("QjXU"),a=n("MJsD"),o=n("yQST"),i=n("/Oio"),c=void 0;function u(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return c?[3,4]:[4,Object(a.a)()];case 1:return(e=t.sent()).workload===i.a.Hwa||Object(o.a)()?[4,Promise.all([n.e(50),n.e(650)]).then(n.bind(null,"N3Xl")).then((function(t){return{launchFile:t.getLaunchFileFunc(e),launchInDesktopApps:t.launchInDesktopApps,launchTemplate:t.launchTemplate,openFileInExplorer:t.openFileInExplorer}}))]:[3,3];case 2:return c=t.sent(),[3,4];case 3:c={launchFile:function(){return Promise.reject()},launchInDesktopApps:function(){return Promise.reject()},launchTemplate:function(){return Promise.reject()},openFileInExplorer:function(){return Promise.reject()}},t.label=4;case 4:return[2,c]}}))}))}},skfY:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var }},slmW:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("6ib3"}},svnf:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("QjXU"),a=n("d1AP"),o=n("mXGw"),i=new(n("AlWG").a)({v1FileUploadState:{sequenceNumber:0,file:null,uploadStatus:a.d.Started,telemetry:{source:a.c.Unknown,area:"Other"}},fileUploadStates:{},nextSequenceNumber:1});function c(){var e=Object(r.__read)(Object(o.useState)(i.getValue()),2),t=e[0],n=e[1];Object(o.useEffect)((function(){var e=i.subscribe}));retur}}),[]);var c=Object(o.useCallback)((function(e,t,n){var a=i.getValue(),o=Object(r.__assign)(Object(r.__assign)({},a.v1FileUploadState),{uploadStatus:void 0!==t?t:a.v1FileUploadState.uploadStatus,file:void 0!==n?n:a.v1FileUploadState.file});i.next(Object(r.__assign)(Object(r.__assign)({},a),{v1FileUploadState:void 0!==e?e:o}))}),[]),u=Object(o.useCallback)((function(e){var t,n=i.getValue(),a=e.sequenceNumber+1,o=Object(r.__assign)(Object(r.__assign)({},n),{nextSequenceNumber:a,fileUploadStates:Object(r.__assign)(Object(r.__assign)({},n.fileUploadStates),(t={},t[e.sequenceNumber]=e,t))});i.next(o)}),[]),s=Object(o.useCallback)((function(e){var t,n=i.getValue(),o=n.fileUploadStates[e.sequenceNumber];if(o){var c=!1,u=o.uploadStatus===a.d.Cancelled||o.uploadStatus===a.d.Completed||o.uploadStatus===a.d.Failed||o.uploadStatus===a.d.Unsupported,s=Object(r.__assign)({},o);if((!u||o.uploadStatus===a.d.Failed&&e.uploadStatus===a.d.Queued)&&(void 0!==e.progress&&(s.progress=e.progress,c=!0),void 0!==e.uploadStatus&&(s.uploadStatus=e.uploadStatus,c=!0)),void 0!==e.fileUrlModel&&(s.fileUrlModel=e.fileUrlModel,c=!0),void 0!==e.error&&(s.error=e.error,c=!0),void 0!==e.parent&&(s.parent=e.parent,c=!0),c){var l=Object(r.__assign)(Object(r.__assign)({},n),{fileUploadStates:Object(r.__assign)(Object(r.__assign)({},n.fileUploadStates),(t={},t[s.sequenceNumber]=s,t))});i.next(l)}}}),[]),l=Object(o.useCallback)((function(e){var t=i.getValue();if(t.fileUploadStates[e]){var n=t.fileUploadStates[e].uploadStatus;if(n!==a.d.Queued&&n!==a.d.Uploading){var o=Object(r.__assign)({},t.fileUploadStates);delete o[e];var c=Object(r.__assign)(Object(r.__assign)({},t),{fileUploadStates:o});i.next(c)}}}),[]),d=Object(o.useCallback)((function(e){var t=i.getValue(),n=Object(r.__assign)(Object(r.__assign)({},t),{showUploadFileUnsupportedDialog:e});i.next(n)}),[]);return Object(o.useMemo)}),[u,l,d,c,s,t])}},tBub:function(e,t,n){"use strict";function r(e){if(!e)return"";var t=e.lastIndexOf(".");return-1===t?"":e.substring(t+1)}n.d(t,"a"}))},vaZn:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("h8qh"),a=function(){var e=Object(r.a)().data,t=null==e?void 0:e.storageErrorResources;if(e&&t)return t}},wSO},xvrq:function(e,t,n){"use strict";function r(){var e=function(){},t=new Promise}));return{cancel:e,onCancel:function(e){return t.then(e)}}}n.d(t,"a",(function(){return r}))},zIbX:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n("QjXU"),a=n("gCKw"),o=n("8wW2"),i=n("a3FV"),c=n("jwpY"),u=n("gI4v"),s=n("HNLS"),l=n("fNDz"),d=n("PvZE"),p=n("Wa5Y"),f=n("5eS3"),m=n("cy7S");function v(e,t,n,a,c,u,s,l){var p="select=webDavUrl,*";t.endsWith(p)||(t=Object(f.a)(t,p));var v=Math.max(0,a-n),b={headers:{"Content-Range":"bytes ".concat(n,"-").concat(n+v-1,"/").concat(c)}};return Object(m.a)(i.a.OneDriveGraphUploadFragmentRequest,"OneDrive_Graph_Upload_Fragment",t,u,b,e.jwtAuthEnabled,e.getAccessToken,e.officeApiRoot,e.correlationId,"None",{onUploadProgress:l,populateRequestEvent:function(e,t){var a=Object(r.__assign)({},t);a.TotalSize=c.toString(),a.ActualSize=v.toString(),a.Index=n.toString(),Object(d.a)("OneDrive_Graph_Upload_Fragment",s,e,a)}}).then((function(e){return e.data})).catch((function(e){throw Object(o.a)().handleError(e,"t59Ym"),e}))}var b=n("V8LI");function g(e){var t=performance.now();return e.expirationTime-t>t-e.startTime}var O=n("ZbLT");function j(e,t,n){void 0!==e&&(t.lastLoaded=Math.min(Math.max(t.lastLoaded,e),t.fileSize),t.progress.next(n))}function h(e,t,n,f,m){return(n.sessionUrl?n.nextExpectedRanges?function(e,t,n,o,i){var c=t.file.size,u=function(e,t){return void 0===t&&(t=[]),t.reduce((function(t,n){var a=Object(r.__read)(n.split("-",2),2),o=a[1],i=parseInt(a[0],10);return!t||i<t.start&&i<e?{start:i,end:""===o?e:Math.min(parseInt(o,10)+1,e)}:t}),void 0)}(c,n.nextExpectedRanges);return(u&&u.start<c?function(e,t,n,o,i,c){var u;return Object(r.__awaiter)(this,void 0,void 0,(function(){var s,l,d,p,f,m,b,h,S,U,w,C,x,T,P=this;return Object(r.__generator)(this,(function(k){switch(k.label){case 0:return s=o.sessionUrl,d=void 0===(l=o.speed)?c.initialSpeed||0:l,[4,Object(a.a)()];case 1:return p=k.sent(),f=(null===(u=null==p?void 0:p.result.uploadRetryGates)||void 0===u?void 0:u.uploadRetryEnabled)||!1,s?(b=t.end,j(m=t.start,n,Object(O.a)(n.lastLoaded,n.fileSize)),h=function(e,t,n,r){var a=e*t;return Math.min(Math.max(a>n?a-a%n:a-a%r,r),t)}(d,c.maxFragmentSize,c.discreteChunkSize,c.minFragmentSize),S=Math.min(m+h,b),U=d>c.minSpeed?c.fragmentTimeoutInMs:c.fragmentTimeoutInMs*c.slowFragmentTimeoutMultiplier,w=performance.now(),C={startTime:w,expirationTime:w+U,progressPoints:0,totalBytes:S-m},x=n.file,T={cancel:function(){},onCance}},i.onCancel})),[2,new Promise((function(t){return Object(r.__awaiter)(P,void 0,void 0,(function(){function a(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t,n,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:e=!0,t=0,n=function(){return new Promise((function(e){setTimeout((function(){u().then((function(t){e(t)})).catch}))}),1e3)}))},r.label=1;case 1:return e&&t<3?[4,n()]:[3,3];case 2:return(a=r.sent()).error?(t++,[3,1]):(e=!1,[2,a]);case 3:return[2]}}))}))}var i,u,l,p=this;return Object(r.__generator)(this,(function(b){return i=function(e){var r=m+e.loaded;d>c.minSpeed&&!function(e,t){var n=function(e,t){t.progressPoints++;var n=performance.now(),r=n-t.startTime,a=t.expirationTime-n,o=void 0;return t.progressPoints>=4&&r>=4e3&&a>0&&r>0&&(o=(t.totalBytes-e)/a/(e/r)),o}(e,t);return void 0===n||n<=1}(r-m,C)&&(T.cancel(),t(_(o,{speed:Math.max(d*c.slowSpeedDowngradeRatio,c.minSpeed),nextExpectedRanges:void 0}))),j(r,n,Object(O.a)(n.lastLoaded,n.fileSize))},(u=function(){return Object(r.__awaiter)(p,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,v(e,s,m,S,x.size,x.slice(m,S),n.sessionId,i)];case 1:return[2,t.sent()]}}))}))})().then((function(e){l(e)})).catch((function(e){return Object(r.__awaiter)(p,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return f?[3,1]:(t(_(o,{error:e})),[3,3]);case 1:return[4,a()];case 2:(n=r.sent())?l(n):t(_(o,{error:e})),r.label=3;case 3:return[2]}}))}))})),l=function(e){j(S,n,Object(O.a)(n.lastLoaded,n.fileSize)),}(e)?_(o,{item:e}):_(o,{nextExpectedRanges:e.nextExpectedRanges,speed:Math.min(g(C)?d*c.speedUpgradeRatio:d,1)}),t(o)},[2]}))}))}))]):[2,Promise.reject("Empty sessionUrl")]}}))}))}(e,u,t,n,o,i):function(e,t,n){return t.sessionUrl?Object(b.a)(e,t.sessionUrl,n).then((function(){return _(t,{sessionUrl:void 0})}),(function(){return _(t,{sessionUrl:void 0})})):Promise.reject("Empty sessionUrl")}(e,n,t.sessionId)).then((function(e){return e.error?function(e,t,n){return S(e=_(e,{nextExpectedRanges:void 0}))}(e):e}))}(e,t,n,f,m):function(e,t,n){return t.sessionUrl?function(e,t,n){return Object(p.a)(i.a.OneDriveGraphUploadStatusRequest,"OneDrive_Graph_Upload_Status",t,{},e.jwtAuthEnabled,e.getAccessToken,e.officeApiRoot,e.correlationId,"Graph",{populateRequestEvent:function(e,t){var a=Object(r.__assign)({},t);Object(d.a)("OneDrive_Graph_Upload_Status",n,e,a)}}).then})).catch((function(e){throw Object(o.a)().handleError(e,"PPAU2"),e}))}(e,t.sessionUrl,n).then}),(function(e){return _(t,{error:e})})):Promise.reject("Empty sessionUrl")}(e,n,t.sessionId):function(e,t,n){return function(e,t,n,a,p,f,m){if(!t||!t.name)return Promise.reject({clientError:"Invalid file"});var v="".concat(Object(s.a)({drivePath:m?"drives/"+m+"/":u.a,file:t,parent:void 0,path:p}),"createUploadSession"),b=Object(l.a)(e.graphApiRoot,v),g={method:"POST",headers:{"Content-Type":"application/json"}};g.headers.Prefer="autoTranscribe";var O={item:{"@microsoft.graph.conflictBehavior":"rename"}};return new Promise((function(a,u){Object(c.a)(i.a.OneDriveGraphCreateUploadSessionRequest,"OneDrive_Graph_Create_Upload_Session",b,O,g,e.jwtAuthEnabled||!1,e.getAccessToken,e.officeApiRoot,e.correlationId,"Graph",{populateRequestEvent:function(e,a){var o=Object(r.__assign)({},a);o.TotalSize=t.size.toString(),Object(d.a)("OneDrive_Graph_Create_Upload_Session",n,e,o)}}).then((function(e){var t=e.data;t&&t.uploadUrl?a(t):u({clientError:"Could not parse upload session from Graph response"})})).catch((function(e){Object(o.a)().handleError(e,"Nt3wB"),u(e)}))}))}(e,t.file,t.sessionId,0,t.path,0,t.driveId).then})}))}(e,t,n)).then((function(e){return e.erro}(e):_(e,{waitDuration:void 0,clientAttemptsRemaining:void 0,serverAttemptsRemaining:void 0})})}function _(e,t){return Object(r.__assign)(Object(r.__assign)({},e),t)}},zPk6:function(e,t,n){"use strict}n.d(t,"a",(function(){return r}))}}]);
//# sourceMappingURL=681.90e7c75581ecf0963101.chunk.v7.js.map