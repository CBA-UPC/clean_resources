require(['ta/rollupAmdShim'], function(rollupAmdShim) {rollupAmdShim.install(["servlets/homerebranded","ta/Core/TA.FireEvent","lib/jquery-amd","api-mod","ta/Core/TA.Event","common/trackingStreams","mixins/page-dates/picker-autoadvance","common/Radio","mixins/page-dates/default-dates","ta/Core/TA.Store","hotels/RoomsGuests","overlays/Overlay","overlays/styles/popover","overlays/position","overlays/options/closeOnDocClick","overlays/options/closeOnLegacyOverlay","overlays/options/repositionOnEvent","overlays/options/autoReposition","overlays/options/highlightElement","overlays/options/centerArrowOnSrcElement","overlays/options/blurSourceOnHide","ta/util/LegacyDateShim","hotels/RoomsGuestsUI","mixins/Events","utils/throttle","utils/responsive","utils/ResponsiveEvents","hotels/HotelsRadioHelper","ta/Core/TA.Record","shelves/shelfEventHandlers","vanillajs","vr/shared/utility"],["ta","ta","ta","ta","ta","ta","ta","ta","ta","ta","ta"]);});
if(window.requirejs && requirejs.taConfig)requirejs.taConfig({"deferred":{},"name":"build/concat/home_rebranded","files":{"js3_secure":{"ssl":{"ta":{"Core":{"TA.Record":1}}}},"js-amd":{"src":{"mixins":{"page-dates":{"default-dates":1,"picker-autoadvance":1},"Events":1},"common":{"trackingStreams":1},"hotels":{"RoomsGuests":1},"utils":{"throttle":1,"responsive":1,"ResponsiveEvents":1},"api-mod":1,"overlays":{"options":{"blurSourceOnHide":1,"autoReposition":1,"centerArrowOnSrcElement":1,"repositionOnEvent":1,"closeOnLegacyOverlay":1,"highlightElement":1,"closeOnDocClick":1},"styles":{"popover":1},"position":1},"servlets":{"homerebranded":1},"vr":{"shared":{"utility":1}},"shelves":{"shelfEventHandlers":1},"vanillajs":1}},"js3":{"lib":{"jquery-amd":1},"build":{"es6":{"src":{"common":{"Radio":1},"hotels":{"RoomsGuestsUI":1,"HotelsRadioHelper":1},"overlays":{"Overlay":1}}}},"src":{"ta":{"util":{"LegacyDateShim":1},"Core":{"TA.FireEvent":1,"TA.Event":1,"TA.Store":1}}}}},"_":{"baseUrl":"/"}});
define("ta/util/Date",["vanillajs","ns-exporter"],function(e,t){var n={};return n.MS_IN_DAY=864e5,n.DAYS_IN_MONTH=[31,28,31,30,31,30,31,31,30,31,30,31],n.HOUR_CONST=12,n.THAI_BUDDHIST_YEAR_OFFSET=543,n.MAX_STAY_DURATION_DAYS=30,n.MAX_VR_DURATION_DAYS=183,n.MAX_DAYS_BEFORE_RETURN_FLIGHT=330,n.MAX_ATTRACTION_RANGE_DAYS=330,n.inDateSet=function(e,t){if(null==e||null==t)return!1;for(var n=t.length,r=0;r<n;r++){var a=t[r];if(a.length){var i=a[0].getTime(),T=a[1].getTime();if(i<=e.getTime()&&T>=e.getTime())return!0}else if(e.getTime()==a.getTime())return!0}return!1},n.rangesIntersect=function(e,t){return Math.max(e[0].getTime(),t[0].getTime())<=Math.min(e[1].getTime(),t[1].getTime())},n.getDaysInRange=function(e,t){return Math.round((t.getTime()-e.getTime())/n.MS_IN_DAY)+1},n.getLastDayOfMonth=function(e){var t=new Date;return e&&(t=new Date(e.getTime())),t=new Date(n.normalize(t)),t.setDate(1),t.setMonth(t.getMonth()+1),t.setDate(0),t.getDate()},n.getDaysApart=function(e,t){var n=864e5;return e&&t?Math.round(Math.abs((e.getTime()-t.getTime())/n)):0},n.inSameMonth=function(e,t){return null!=e&&null!=t&&e.getMonth()==t.getMonth()&&e.getYear()==t.getYear()},n.normalize=n.create=t.exportTo(n,"ta.util.date"),n});
define("mixins/page-dates/Utils",["vanillajs"],function(e){"use strict";nction n(e,t){return t+"Year="+e.getFullYear()+"&"+t+"Month="+(e.getMonth()+1)+"&"+t+"Day="+e.getDate()}function a(e){return n(e[0],"in")+"&"+n(e[1],"out")}function i(e){if(!e)return null;var t=e.split("-");return t.length<2&&(t=e.split("_")),new Date(parseInt(t[0],10),parseInt(t[1],10)-1,parseInt(t[2],10))}unction o(e,t){if((!e||!t)&&[e,t].every(u))return!1;var r=new Date(e.getTime()),n=new Date(t.getTime());return r.setHours(0,0,0,0),n.setHours(0,0,0,0),r.getTime()===n.getTime()}function s(e,t){if((!e||!t)&&[e,t].every(u))return!1;var r=new Date(e.getTime()),n=new Date(t.getTime()),a=864e5;return r.setHours(0,0,0,0),n.setHours(0,0,0,0),Math.round((n.getTime()-r.getTime())/a)}function g(e,t){for(var r;e;){if(r=e.querySelector("[data-dateType="+t+"]"))return r;e=e.parentNode}return null}function l(e,t){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(var r=!0,n=0;n<e.length;n++)r=r&&o(e[n],t[n]);return r}return{pad:t,dateToIso:r,datesToCommerceUrlParams:a,fromString:i,compareDatesNoTime:o,compareDatesArrayNoTime:l,getNumNightsNoTime:s,findClosestDatepicker:g}});
define("calendars/CalendarDate",["vanillajs"],function(t){"use strict";function n(t){t=t||new Date,this.date=new Date(t.getFullYear(),t.getMonth(),t.getDate())}return n.prototype={constructor:n,daysInMonth:eachDayInMonth:function(t){for(var e=1,r=this.daysInMonth();e<=r;e++)t(new n(new Date(this.year(),this.month(),e)))},thisMonth:function(){return new n(new Date(this.year(),this.month(),1))},nextMonth:previousMonth:relativeMonth:function(t){return new n(new Date(this.year(),this.month()+t,1))},relativeDay:function(t){return new n(new Date(this.year(),this.month(),this.day()+t))},firstOfMonth:function(){return new n(new Date(this.year(),this.month(),1))},lastOfMonth:function(){return new n(new Date(this.year(),this.month(),this.daysInMonth()))},year:function(){return this.date.getFullYear()},month:function(){return this.date.getMonth()},day:function(){return this.date.getDate()},dayOfWeek:firstDayOfMonth:inRange:function(t,n){return!(!t||!n)&&(this.compare(t)>0&&this.compare(n)<0)},compare:function(t){for(var n,e=["getFullYear","getMonth","getDate"],r=0,i=e.length;r<i;r++){if(n=e[r],this.date[n]()<t.date[n]())return-1;if(this.date[n]()>t.date[n]())return 1}return 0},daysTo:function(t){return Math.ceil((t.date.getTime()-this.date.getTime())/864e5)},toISOString:toString:,n.fromString=function(t){var e=t.split("-");return new n(new Date(e[0],e[1],e[2]))},n});
define("mixins/page-dates/DateTypeStore",["vanillajs","ta/Core/TA.Store","calendars/CalendarDate","mixins/page-dates/Utils"],function(t,e,n,r){"use strict";function i(t){var e=[];for(var n in T)T.hasOwnProperty(n)&&T[n].children&&T[n].children.indexOf(t)>=0&&e.push(n);return e}function a(t){var e=ta.page.getDates(t);return e&&e[0]?new n(e[0]):null}var u="zu",T={CHECKIN:{queryString:null,pathString:null},CHECKOUT:{queryString:null,pathString:null},STAYDATES:{children:["CHECKIN","CHECKOUT"],queryString:"staydates",pathString:u+"s"},EATERY:{queryString:"eaterydate",pathString:u+"r"},DEPARTURE:{queryString:null,pathString:null},RETURN:{queryString:null,pathString:null},ROUNDTRIP:{children:["DEPARTURE","RETURN"],queryString:"rtdates",pathString:u+"t"},ONEWAYFLIGHT:{queryString:"oneway",pathString:u+"o"},LEG_1:{queryString:"leg1date",pathString:u+"1"},LEG_2:{queryString:"leg2date",pathString:u+"2"},LEG_3:{queryString:"leg3date",pathString:u+"3"},ATTRACTION:{queryString:"attrdate",pathString:u+"a"},ATTRACTION_FROM:{queryString:null,pathString:null},ATTRACTION_TO:{queryString:null,pathString:null},ATTRACTIONRANGE:{children:["ATTRACTION_FROM","ATTRACTION_TO"],queryString:"attrrange",pathString:u+"e"},VPDATES:{children:["VPDEPARTURE","VPRETURN"],queryString:"vpdates",pathString:null},VPDEPARTURE:{queryString:null,pathString:null},VPRETURN:{queryString:null,pathString:null}};return T.getStartDateType=function(t){var e=i(t);if(0==e.length){var n=T[t].children;return n&&n.length>0?n[0]:t}return T[e[0]].children[0]},T.getEndDateType=function(t){var e=i(t);if(0==e.length){var n=T[t].children;return n&&n.length>0?n[n.length-1]:t}var r=T[e[0]];return r.children[r.children.length-1]},T.isChildDateType=T.isSingleDateType=function(t){var e=T[t];return!(T.isChildDateType(t)||e&&e.children&&e.children.length>0)},T.getParents=i,T.isHotelDateType=function(t){return i(t).indexOf("STAYDATES")>=0},T.isRoundTripDateType=function(t){return i(t).indexOf("ROUNDTRIP")>=0},T.isAttractionRangeDateType=function(t){return i(t).indexOf("ATTRACTIONRANGE")>=0},T.isVacationPackagesDateType=function(t){return i(t).indexOf("VPDATES")>=0},T.allowsSameDayRange=T.isMultiCityDateType=T.isStartDateType=function(t){var e=i(t);return 0!=e.length&&0==T[e[0]].children.indexOf(t)},T.isEndDateType=function(t){var e=i(t);if(0==e.length)return!1;var n=T[e[0]];return n.children.indexOf(t)==n.children.length-1},T.getStartDate=function(t){var e=T.getStartDateType(t);return null==e?ta.page.getDates(t)[0]:ta.page.getDates(e)[0]},T.getEndDate=function(t){var e=T.getEndDateType(t);return null==e?ta.page.getDates(t)[0]:ta.page.getDates(e)[0]},T.getMinEnabledDate=function(t){if(T.isHotelDateType(t)||T.isRoundTripDateType(t)){var i=e.retrieve("multiDP.minCheckInDate");if(i)return new n(r.fromString(i))}else{if("LEG_1"==t)return a("ONEWAYFLIGHT");if("LEG_2"==t)return a("LEG_1")||a("ONEWAYFLIGHT");if("LEG_3"==t)return a("LEG_2")||a("LEG_1")||a("ONEWAYFLIGHT");if("ATTRACTION_TO"==t)return a("ATTRACTION_FROM")}return null},T.flattenType=function(t){var e=T[t];return e?e.children?e.children.slice(0):[t]:[]},T.getCorrespondingDateType=T});
define("mixins/page-dates/Base",["vanillajs","ta","mixins/page-dates/Utils","mixins/page-dates/DateTypeStore"],function(e,r,t,n){"use strict";unction i(e){if(!n[e])throw"Invalid date type: "+e}function s(e){var r=[];for(var t in n)n.hasOwnProperty(t)&&n[t].children&&n[t].children.indexOf(e)>=0&&r.push(t);return r}function o(e,r){var a=n[e],i="";if(a.children)for(var s=0,o=a.children.length;s<o;s++){if("_"===r[a.children[s]])return"_";i+=(s>0?"_":"")+t.dateToIso(r[a.children[s]])}else{if("_"===r[e])return"_";i+=t.dateToIso(r[e])}return i}function h(e,r){var t=n[e];if(t.children){for(var a=0,i=t.children.length;a<i;a++)if("_"!==r[t.children[a]])return!1;return!0}return"_"===r[e]}function u(e,r){require.defined("ta/util/Error")&&require("ta/util/Error").record(e,r)}var f=function(e){var s={},f={};!function(){var r,i;if(e)for(i in e)r=t.fromString(e[i]),e.hasOwnProperty(i)&&n[i]&&a(r)&&(s[i]=r)}(),this.hasDates=function(e){if(i(e),n[e].children){for(var t=0,a=n[e].children.length;t<a;t++)if(!r.page.hasDates(n[e].children[t]))return!1;return!0}return!!s[e]&&"_"!==s[e]},this.hasUserSetDates=function(e){return n[e].children?n[e].children.reduce(!1):!!f[e]},this.getDates=function(e){var r=[];if(i(e),n[e].children)for(var t=0,a=n[e].children.length;t<a;t++)r.push(s[n[e].children[t]]);else r.push(s[e]);for(var t in r)"_"===r[t]&&(r[t]=null);return r},this.setDates=function(e,r){if(i(e),Array.isArray(r)||(r=[r]),r=r.map(function(e){return e instanceof Date?new Date(e.getFullYear(),e.getMonth(),e.getDate()):"_"}),n[e].children){if(n[e].children.length!==r.length)throw"Incorrect number of dates for date type "+e;for(var t=0,a=n[e].children.length;t<a;t++){var o=n[e].children[t];s[o]=r[t],f[o]=!0}}else{if(1!==r.length)throw"Incorrect number of dates for date type "+e;s[e]=r[0]}f[e]=!0},this.clearDates=function(e){if(!e)return void(s={});if(i(e),n[e].children)for(var r=0,t=n[e].children.length;r<t;r++)s[n[e].children[r]]="_";else s[e]="_"},this.datesToQueryString=function(e){var t=n[e];if(i(e),!t.queryString)throw"Cannot generate query-string for DateType "+e;return(r.page.hasDates(e)||h(e,s))&&r.page.hasUserSetDates(e)?t.queryString+"="+o(e,s):""},this.defaultDatesToQueryString=function(e){var t=n[e];return i(e),t.queryString?r.page.hasDates(e)||h(e,s)?r.page.hasUserSetDates(e)?"":t.queryString+"="+o(e,s):"":(u(null,"Cannot generate query-string for DateType "+e),"")},this.datesToQueryPath=function(e){var t=n[e];if(i(e),!t.pathString)throw"Cannot generate path-string for DateType "+e;return(r.page.hasDates(e)||h(e,s))&&r.page.hasUserSetDates(e)?t.pathString+o(e,s):""},this.datesToQueryJson=function(e){var t=n[e],a={};if(i(e),!t.queryString)throw"Cannot generate query json for DateType "+e;return(r.page.hasDates(e)||h(e,s))&&(r.page.hasUserSetDates(e)||"EATERY"===e)?(a[t.queryString]=o(e,s),a):{}}};return f.prototype.onDatesSelected=function(e,t,n){var a=s(t);if(r.page&&r.page.emit){r.page.emit("dateSelected",e,t,n);for(var i=0,o=a.length;i<o;i++)r.page.hasDates(a[i])&&r.page.emit("dateSelected",e,a[i],r.page.getDates(a[i]))}},f.prototype.usingUnifiedDates=!0,f});
define("mixins/page-dates/Validator",["vanillajs","ta","mixins/page-dates/DateTypeStore","calendars/CalendarDate","ta/util/Date"],function(e,t,a,n,r){"use strict";function i(e){if(!a[e].children||!t.page.hasDates(e))return!0;var n=a[e].children,r=t.page.getDates(e);return a.isStartDateType(n[0])&&a.isEndDateType(n[1])&&r[0]<=r[1]||a.isEndDateType(n[0])&&a.isStartDateType(n[1])&&r[1]<=r[0]}function s(e){if(!a[e].children||!t.page.hasDates(e))return!0;var n=t.page.getDates(e);return n[0].getTime()!==n[1].getTime()}function u(e){return function(n){return!a[n].children||!t.page.hasDates(n)||D.apply(null,t.page.getDates(n))<=e}}function D(e,t){var a=e instanceof n?e:new n(e),r=t instanceof n?t:new n(t);return Math.abs(a.daysTo(r))}var T=function(e){var t=e&&e.hasOwnProperty("maxStayLength")?e.maxStayLength:r.MAX_STAY_DURATION_DAYS;this.VALIDATORS={STAYDATES:[i,s,u(t)],ROUNDTRIP:[i],ATTRACTIONRANGE:[i],VPDATES:[i,s,u(t)]}};return T.prototype.validate=function(e){var t=this.VALIDATORS[e];return!t||0==t.length||!t.some(function(t){return!t(e)})},T});
define("mixins/page-dates/pop-calendar",["ta","common/trackingStreams","common/Radio","ta/support/Qualtrics","ta/Core/TA.Store","ta/Core/TA.LocalStorage","ta/util/SessionStorage","utils/responsive"],function(e,t,n,r,i,a,o,s){function d(){j=!1}function u(t){b=!!t.popFromDefault,D=!!t.popFromVisibleOnly,P=t.popFromVisibleOnlyBreakpoint,k=!!t.datesWereDefaulted,y=t.popCalendarType,T=!!t.hasMetaMarketingDefaultDates,E=!!t.qualtricsSurveyEnabled,O=!!t.isDetailPage,A="Vacation_Packages"===window.pageServlet,e.page.on("datepickerRejected",d),e.page.on("dateSelected",d)}function c(e){if(a.enabled&&a.get("popCalendarAfterRedirectedFromIB"))return a.remove("popCalendarAfterRedirectedFromIB"),!0;if(!k||R)return!1;if(i.retrieve("suppressCalendarPop"))return!1;if(!y)return!1;if(E&&r&&(r.canDisplay()||r.seenThisPageView())){if(!require.defined("page-model"))return!1;if(require("page-model").isMobile)return!1}if(e&&D&&(!P||s.is(P,!0,!1)())&&!g(e))return!1;switch(y){case"doNot":return!1;case"untilClosedPerServletType":return!l();case"untilClosed":return!p();case"always":return!0}return b&&k}function p(){return o.canUseSessionStore()&&!!o.getObject(C)}function l(){var e=o.canUseSessionStore()&&o.getObject(C);return e&&!!e[A?"vp":O?"detail":"list"]}function f(){if(o.canUseSessionStore()){var e=o.getObject(C)||{};e[A?"vp":O?"detail":"list"]=!0,o.setObject("pop-calendar-dismissed",e),n("pop-calendar").emit("dismissed")}}unction m(){return T}function S(n){j=!0,e.page.gatherDates(n),R=!0,t.trackEvent("DATEPICKER","auto-popped-calendar-shown",window.pageServlet),t.trackEvent("calendar","in_view","autopop")}function v(){return R}r C="pop-calendar-dismissed",b=!1,D=!1,P="",k=!1,E=!1,T=!1,y="",O=!1,R=!1,j=!1,A=!1;return{init:u,shouldPop:c,shouldPopMetaMarketing:m,popCalendar:S,wasPoppedThisPageLoad:v,isShowing:h,setUserEnteredDates:w,setDismissedThisSession:f}});
define("mixins/page-dates/default-dates",["ta","mixins/mixin","mixins/Events","mixins/page-dates/pop-calendar","mixins/page-dates/DateTypeStore","common/trackingStreams","vanillajs","ta/Core/TA.Event"],function(e,t,a,n,i,o,d,r){"use strict";function s(e){n.init(e),g=!!e.datesWereDefaulted,f=!!e.refreshLocalStorage,D=e.localStorageTTL,m=!0,S.emit("init")}function p(e){"function"==typeof e&&(m?e():S.on("init",e))}function u(t,a,d){function s(t){n.wasPoppedThisPageLoad()&&(S.emit("poppedCalendarDismissed",t),n.setDismissedThisSession(),e.page.off("datepickerRejected",s))}function p(){if(f&&(g&&o.trackEvent("DATEPICKER","undated_to_default_dated"),!a)){var t=n.shouldPop(f);(t||n.shouldPopMetaMarketing())&&(t&&S.emit("popFromDefault"),e.page.on("datepickerRejected",s),n.popCalendar(f))}}var u=d?d:"STAYDATES";if(e.page.usingUnifiedDates){e.page.hasDates(u)||e.page.clearDates(u),c=e.page.getDates(i.getStartDateType(u))[0],l=e.page.getDates(i.getEndDateType(u))[0];var f=t.querySelector('[data-datetype="'+i.getStartDateType(u)+'"]');e.page.on("dateSelected",function(a,i,d){var r,p=c&&l,f=e.page.getDates(u)[0],D=e.page.getDates(u)[1];if(t.contains(a)&&(!p&&e.page.hasDates(u)?r="undated_to_manually_dated":f==c&&D==l||(n.setUserEnteredDates(),e.page.off("datepickerRejected",s),g?(r="default_dated_to_manually_dated",g=!1):r="manually_dated_to_manually_dated"),c=f,l=D,r)){var m="";a&&a.getAttribute("data-picker-location")&&(m=a.getAttribute("data-picker-location"),document.querySelector("#PERSISTENT_TRIP_SEARCH_BAR.fixed")&&(m+="_persistent")),o.trackEvent("DATEPICKER",r,m)}}),"loading"===document.readyState?window.addEventListener("DOMContentLoaded",p):p(),r.on("specialOfferClosed",function(){a||f&&n.shouldPop(f)&&n.popCalendar(f)})}}var c,l,g=!1,f=!1,D=0,m=!1,S={init:s,onInit:p,apply:u,usingDefaults:function(){return g},shouldRefreshLocalStorage:function(){return f},getLocalStorageTTL:function(){return D}};return t(S,new a("popFromDefault"))});
define("mixins/page-dates/Responsive",["vanillajs","ta","mixins/mixin","ta/util/Date","mixins/page-dates/Base","calendars/CalendarDate","mixins/page-dates/Utils","mixins/page-dates/DateTypeStore","mixins/page-dates/Validator","mixins/page-dates/default-dates","ta/util/Deferred","common/trackingStreams"],function(e,a,t,s,n,l,i,r,o,p,d,u){"use strict";function c(e){var a={dateType:e,startDate:r.getStartDate(e),endDate:!r.isSingleDateType(e)&&r.getEndDate(e),minEnabledDate:E&&new l(i.fromString(E)),maxEnabledDate:P&&new l(i.fromString(P)),thaiOffset:S,showClearButton:A,calendarTitle:L,demandLoadAssets:k,calendarStyle:w,moveIntoView:N,heatmapStyle:y,heatmap:O,heatmapPercentiles:I,colorAccessibilityTestClass:R,calendarTitleTestClass:V,headerProminenceTestClass:M,popularDates:j};r.isHotelDateType(e)||r.isRoundTripDateType(e)||r.isAttractionRangeDateType(e)||r.isVacationPackagesDateType(e)?(a.maxStayLength=b,!a.maxEnabledDate&&v&&(a.maxEnabledDate=(new l).relativeDay(parseInt(v)))):(a.availableDates=x,a.excludedDates=C);var t=r.getMinEnabledDate(e);return t&&(a.minEnabledDate=t),a}function D(e,a){if(!e||!a||!e.querySelector)return null;for(var t="[data-dateType="+a+"]",s=null,n=0;n<3&&e.parentNode&&!s;n++)e=e.parentNode,s=e.querySelector(t);return s}function m(e){r.getParents(e).forEach(function(t){f.validate(t)||r[t].children.filter(.forEach(function(e){a.page.clearDates(e),a.page.emit("dateSelected",null,e,[null])})})}function g(e){return h&&r.getCorrespondingDateType(e)&&!r.isStartDateType(e)&&!a.page.hasDates(r.getCorrespondingDateType(e))}var f,y,T=null,h=!1,S=!1,v=null,b=s.MAX_STAY_DURATION_DAYS,x=null,C=null,E=null,P=null,A=!1,L=null,k=!0,w={},N=!1,O={},I={},R=null,V=null,M=null,j=[],q=function(e,a){t(this,new n(e)),f=new o(a),a&&(S=a.thaiOffset,h=a.popCheckInFirst,b=a.maxStayLength||b,x=a.availableDates,C=a.excludedDates,E=a.minEnabledDate,P=a.maxEnabledDate,A=a.showClearButton,L=a.calendarTitle,k=a.demandLoadAssets,v=a.maxEnabledDaysOut,w=a.calendarStyle,N=a.moveIntoView||N,y=a.heatmapStyle,O=a.heatmap||O,I=a.heatmapPercentiles||I,R=a.colorAccessibilityTestClass,V=a.calendarTitleTestClass,M=a.headerProminenceTestClass,j=a.popularDates,p.init({datesWereDefaulted:a.didCreateDefaultDates,popFromDefault:a.supportsPrePopWithDefaultDates,popCalendarType:a.popCalendarType,qualtricsSurveyEnabled:a.qualtricsSurveyEnabled,hasMetaMarketingDefaultDates:a.hasMetaMarketingDefaultDates,popFromVisibleOnly:a.supportsPrePopWithVisibilityOnly,popFromVisibleOnlyBreakpoint:a.supportsPrePopWithVisibilityOnlyBreakpoint,isDetailPage:a.isDetailPage}))};return q.prototype.gatherDates=function(e,t,s,n,l){var i=e&&e.getAttribute("data-dateType"),o=i&&r[i]?i:"UNKNOWN";if(g(o)&&(o=r.getCorrespondingDateType(o),e&&o&&(e.blur(),e=D(e,o))),!e||e!==T){T=e,e&&e.classList&&e.classList.add("focused");var p=d(!0);return require(["trjs!calendars/ResponsiveStayDates"],function(t){t.openAsPopover(e,c(o)).then(function(t){T=null,e&&e.classList&&e.classList.remove("focused"),a.page.pushDates(e,o,t),p.resolve(t)},function(t){t===T&&(T=null),e&&e.classList&&e.classList.remove("focused"),l&&a.page.hasDates("STAYDATES")&&"classic"===w&&a.page.onDatesSelected(e,o,a.page.getDates("STAYDATES")),a.page.emit("datepickerRejected",e)}),u.trackEvent("calendar","in_view","default")}),p.promise()}},q.prototype.gatherDatesNear=function(e){var t=i.findClosestDatepicker(e,"CHECKIN");t&&a.page.gatherDates(t)},q.prototype.pushDates=function(e,t,s){a.page.setDates(t,s),m(t),a.page.onDatesSelected(e,t,s)},q.prototype.setAvailableDates=function(e){x=e},q.prototype.setExcludedDates=function(e){C=e},q.prototype.setMaximumDaysOut=function(e){v=e},q.prototype.setTargetLocationId=function(e){a.page.setRepollAjaxParamsNoPoll&&a.page.setRepollAjaxParamsNoPoll({"removeCommerceTargetLocationId":e})},q});
define("ta/popups/SlotSet",["vanillajs","api-mod","ta/util/Error"],function(t,s,o){function i(){this.nW=525,this.nH=460,this.nXI=24,this.nYI=24,this.totalSlots=20,this.slots=[];try{screen.width>1024?(this.nW=800,this.nH=600,this.nXI=80,this.nYI=40):screen.width>800&&(this.nW=620,this.nH=500,this.nXI=60,this.nYI=30)}catch(t){this.error=t,o.record(this.error,"slot set",null,{"slot set":"general"})}this.getOpenSlot=function(t){(!t||t<0||t>this.totalSlots)&&(t=0);var s=function(t){try{var s=!1,i=!1;try{i=this.slots[t].occupied}catch(t){}if(i)try{var r=i.windowObject;r&&!r.closed||(s=!0)}catch(t){s=!0}else s=!0}catch(s){o.record(s,"get open slot - get pop slot",null,{totalSlots:this.totalSlots,slotNumber:t})}if(s){this.slots[t].occupied=null;var l=this.slots[t];return l.slotPos=t,l}return!1}.bind(this);try{var i,r;for(i=t-1;i>=0;i-=1)if(r=s(i))return r;for(i=t;i<this.slots.length;i++)if(r=s(i))return r}catch(t){o.record(t,"get open slot",null,{totalSlots:this.totalSlots})}return!1}}return i});
define("ta/popups/Slot",["vanillajs"],function(i){eturn t});
define("ta/popups/PopupSlotSet",["vanillajs","api-mod","ta/util/Error","ta/popups/SlotSet","ta/popups/Slot"],function(t,s,i,n,e){function o(){s.mixin(this,new n),this.nX=500;var t=1160;try{screen.width<1660&&(screen.width>1024&&screen.width<1280?t=960:screen.width<=1024&&(t=740),this.nX=screen.width-t),this.nY=isNaN(window.screenTop)?isNaN(window.screenY)?0:window.screenY:window.screenTop}catch(t){this.error=t,this.nY=0,i.record(this.error,"slot set",null,{"slot set":"popup"})}for(var o=0;o<this.totalSlots;o++)this.slots[o]=new e(this.nX,this.nY,this.nW,this.nH),this.nX=this.nX+this.nXI,this.nY=this.nY+this.nYI}return o});
define("ta/popups/PopunderSlot",["vanillajs","api-mod","ta/popups/Slot"],function(t,i,n){function o(t,o,p,s,h,u,a,e){i.mixin(this,new n(t,o,p,s)),this.tx=h,this.ty=u,this.tw=a,this.th=e}return o});
define("ta/popups/PopunderSlotSet",["vanillajs","api-mod","ta/util/Error","utils/browserutils","ta/popups/PopupSlotSet","ta/popups/PopunderSlot"],function(t,i,s,h,n,e){function o(){i.mixin(this,new n);try{this.nX=window.screenLeft||window.screenX,this.nY=window.screenTop||window.screenY}catch(t){this.error=t,this.nX=200,this.nY=200}this.w=1,this.h=1,this.x=5e3,this.y=5e3,this.totalSlots=4;try{h.ie7&&(this.w=250,this.h=100),(h.safari||h.chrome)&&(this.w=85,this.h=100),"undefined"==typeof this.nX?(this.nX=0,this.nY=0,this.x=this.nX+window.screen.availWidth-this.w,this.y=this.nY+window.screen.availHeight-this.h):(this.x=this.nX+window.getWidth()-this.w,this.y=this.nY+window.getHeight()-this.h),h.ie7?(this.y=this.y-95,this.x=this.x+13):(h.safari||h.chrome)&&(this.y=this.y-16)}catch(t){this.error=t}this.error&&s.record(this.error,"slot set",null,{"slot set":"popunder"});for(var t=0;t<this.totalSlots;t++)this.slots[t]=new e(this.nX,this.nY,this.nW,this.nH,this.x,this.y,this.w,this.h),this.nX=this.nX+this.nXI,this.nY=this.nY+this.nYI}return o});
define("ta/popups/TAPopWindow",["vanillajs","api-mod","ta/util/Error","ta/Core/TA.Store","ta/util/Cookie","utils/browserutils","ta/Core/TA.Record","ta/Browser"],function(t,i,s,o,e,h,n,r){function w(t){this.options={name:"TAWin",url:"",windowHook:!1,customWidth:!1,customHeight:!1,toolbar:1,location:1,directories:1,status:1,menubar:r.isIE9orHigher()?0:1,resizable:1,copyhistory:1,scrollbars:1,alwaysRaised:!1,alwaysLowered:!1,widthOffset:8,heightOffset:164,delayLoad:!1},this.init=function(n,r){var w,l,a;if(i.merge(this.options,r),this.type=n,this.assignSlot(),this.options.customWidth&&(this.width=this.options.customWidth),this.options.customHeight&&(this.height=this.options.customHeight),null!=this.options.widthOffset&&(this.widthOffset=this.options.widthOffset),null!=this.options.heightOffset&&(this.heightOffset=this.options.heightOffset),this.options.delayLoad&&(this.delayLoad=this.options.delayLoad),this.options.windowHook)return this.windowObject=this.options.windowHook,o.has("checkrates.add_holding_windows")||this.windowObject.refresh(),!0;o.has("checkrates.chrome_dates_entry_holding")&&(this.options.scrollbars=0),this.url=this.options.url,this.assignWinArgs();try{if(this.type==t.windowType.HOLDING&&e.setPIDCookie(28962),h.chrome&&this.options.inTab){var d=Math.random().toString(36).substring(7);return this.options.popunder?(w=document.createElement("a"),w.href=this.url,w.target=d,document.body.appendChild(w),l=document.createEvent("MouseEvents"),l.initMouseEvent("click",!1,!0,window,0,0,0,0,0,!0,!1,!1,!0,0,null),w.dispatchEvent(l),w.parentNode.removeChild(w),void(this.windowObject=window.open(this.url,d))):void(this.windowObject=window.open(this.url,d))}var p=h.chrome&&h.version>31;if(p)this.windowObject=window.open("","_blank");else if(this.options.popunder)if(h.ie8||h.ie9||h.ie10||h.ie11)this.windowObject=window.open("pages/blank.html","_blank",this.winArgs),window.document.focus();else if(h.safari&&"ios"!==h.Platform.name){if(this.windowObject=window.open("","_blank",this.winArgs),this.windowObject){var c=window.open("","_blank");c.close()}window.focus()}else h.firefox?(this.windowObject=window.open("","_blank",this.winArgs),window.open("","_self",""),window.focus()):this.windowObject=window.open("","_blank",this.winArgs);else this.windowObject=window.open("","_blank",this.winArgs);a=this.windowObject,a&&this.isTAWindow()?(this.type==t.windowType.CHECK_RATE&&t.pollForPartnerLoad(a,new Date,this.options.name,t.extractSlotFromCommerceUrl(this.options.url)),this.delayLoad||t.redirectToUrl(this.windowObject,this.url)):!a&&h.ie&&this.type===t.windowType.CHECK_RATE&&this.url&&o.has("ta.ie_commerce_popup_block_fix")&&(e.setPIDCookie(38822),window.location=this.url)}catch(t){this.errorOpening=t,s.record(this.errorOpening,"pop window opening failure",null,{type:this.type,url:this.url})}try{a=this.windowObject,a&&this.isTAWindow()&&this.type==t.windowType.HOLDING&&this.moveBehindMain(a)}catch(t){this.errorMoving=t,s.record(this.errorMoving,"popunder window moving",null,{type:this.type,url:this.url})}},this.repurpose=function(i,o,e){if(this.type==t.windowType.HOLDING){this.type=t.windowType.CHECK_RATE,this.slot.occupied=!1,this.assignSlot(),this.url=i,o&&(this.width=o,this.options.widthOffset=0),e&&(this.height=e,this.options.heightOffset=0);var h=this.windowObject;if(h&&this.isTAWindow())try{this.options.inTab||(h.moveTo(0,0),h.resizeTo(this.width+this.options.widthOffset,this.height+this.options.heightOffset),h.moveTo(this.x,this.y)),this.delayLoad||this.options.keepFocus||h.focus(),this.delayLoad||(h.location=this.url)}catch(t){s.record(this.errorMoving,"repurpose popunder fail",null,{type:this.type,url:this.url})}return this}return!1},this.assignWinArgs=function(){this.winArgs="toolbar="+this.options.toolbar,this.winArgs+=",location="+this.options.location,this.winArgs+=",directories="+this.options.directories,this.winArgs+=",status="+this.options.status,this.winArgs+=",menubar="+this.options.menubar,this.winArgs+=",resizable="+this.options.resizable,this.winArgs+=",copyhistory="+this.options.copyhistory,this.winArgs+=",scrollbars="+this.options.scrollbars,this.winArgs+=",width="+this.width,this.winArgs+=",height="+this.height,this.winArgs+=",left="+this.x,this.winArgs+=",top="+this.y,this.winArgs+=",screenx="+this.x,this.winArgs+=",screeny="+this.y,this.options.alwaysRaised&&(this.winArgs+=",alwaysRaised"),this.options.alwaysLowered&&(this.winArgs+=",alwaysLowered")},this.assignSlot=function(){this.type==t.windowType.HOLDING?(this.slot=t.getPopunderSlots().getOpenSlot(),this.width=this.slot.tw,this.height=this.slot.th,this.x=this.slot.tx,this.y=this.slot.ty):(this.slot=t.getPopupSlots().getOpenSlot(),this.width=this.slot.w+this.options.widthOffset,this.height=this.slot.h+this.options.heightOffset,this.x=this.slot.x,this.y=this.slot.y),this.slot.occupied=this},this.moveBehindMain=function(e){if(o.has("checkrates.cr_popunder_by_shift_ctrl")&&h.version>23)t.openCloseTab();else if(o.has("checkrates.chrome_dates_entry_holding"))try{var r=window.open("about:blank");r&&(r.focus(),r.close())}catch(t){s.record(t,"holdingWindow - Chrome blur failed")}e.blur(),e.opener=self,e.moveTo(this.slot.x,this.slot.y),e.resizeTo(this.slot.w,this.slot.h),this.delayLoad||(e.location=this.url),window.focus(),i.hasClass(document.activeElement,"globalNav2011_reset")||n.trackEventOnPage("checkrates","no_focus_on_main",h.version,1)},this.isTAWindow=function(){var t=!0;try{var i=this.windowObject.location;this.windowObject.status="",null!==i&&""!==i||(t=!1)}catch(i){t=!1}return t}}return w});
define("ta/util/openNewTab",["utils/browserutils","ta/Browser","ta/util/Cookie"],function(e,o,t){return function(n){var i;return o.isIE10Metro()||(i=e.ie&&!o.isIE9orHigher()?window.open(n,"_blank","location=yes,resizable=yes,menubar=yes,scrollbars=yes,toolbar=yes,width="+document.documentElement.clientWidth+",height="+document.documentElement.clientHeight):window.open(n,"_blank")),!i||i.closed||"undefined"==typeof i.closed?(t.setPIDCookie(38821),window.location=n,!1):i}});
define("ta/popups/PollForPartnerLoad",["common/trackingStreams"],function(t){var e=function(n,E,r,a,o){n&&setTimeout(function(){var C=null,c=(new Date).getTime()-E.getTime();try{C=n.document}catch(t){}C?c>2e4?t.trackEvent("COMMERCE_CLICK","PROVIDER_TIMEOUT",r||"",c):n.closed?t.trackEvent("COMMERCE_CLICK","PROVIDER_CLOSED",r||"",c):e(n,E,r,a,o):t.trackEvent("COMMERCE_CLICK","PROVIDER_LOADED",(o||window.pageServlet||"")+"|"+(a||"")+"|"+(r||""),c)},100)};return e});
define("ta/popups/BeforePopTargetBlankIE",["ta/Browser","ta/util/Cookie"],function(e,t){return function(o){var n;return!o||!o.href||"_blank"!==o.target||(e.isIE10Metro()||(n=e.isIE9orHigher()?window.open(o.href,"_blank"):window.open(url,"_blank","location=yes,resizable=yes,menubar=yes,scrollbars=yes,toolbar=yes,width="+document.documentElement.clientWidth+",height="+document.documentElement.clientHeight)),!(n&&!n.closed&&"undefined"!=typeof n.closed)&&(o.target="",t.setPIDCookie(38821),!0))}});
define("ta/popups/PopUtil",["vanillajs","ns-exporter","utils/browserutils","ta/util/Cookie","ta/util/Error","ta/Core/TA.Record","ta/Browser","ta/Core/TA.Store","ta/popups/PopupSlotSet","ta/popups/PopunderSlotSet","ta/popups/TAPopWindow","ta/util/openNewTab","ta/popups/PollForPartnerLoad","ta/popups/BeforePopTargetBlankIE"],function(e,n,t,o,r,i,d,a,c,u,l,s,p,w){function h(e,n){n=n||{};var t=new l(k);if(t.init(e,n),!t.errorOpening&&!t.errorMoving&&t.windowObject)try{return a.has("checkrates.add_holding_windows")&&n.windowHook&&n.windowHook.location&&n.windowHook.location.href.test(/RuleBasedPopunder/)?f.unshift(t):f.push(t),n.windowHook||e!=k.windowType.HOLDING||this.trackPopunder(n.url,k.numPopundersCheck()),t}catch(e){r.record(e,"Window Popup - could not register new window")}return!1}var f=[],m=null,g=null,v=2,k={windowType:{CHECK_RATE:0,PROV_WIN:1,HOLDING:2,COMMERCE:3,VFM:4,COOKIE:5},maxPopunders:4,tryHoldingWindows:function(e,n){try{for(var t=!0,o=0;o<n;o++){var i=this.launchHoldingWindow(e);i.windowObject||(t=!1)}if(t)return!0}catch(e){r.record(e,"try two hw")}return!1},getPopunderSlots:function(){return null===m&&(m=new u),m},getPopupSlots:createCheckRatesWindow:function(e){return h(this.windowType.CHECK_RATE,e)},createHoldingWindow:function(e){return h(this.windowType.HOLDING,e)},createVFMWindow:getHoldingWindowSet:function(){for(var e=[],n=0;n<f.length;n++){var t=f[n];if(t&&t.type==this.windowType.HOLDING){var r=t.windowObject;if(r&&"closed"in r)if(r.closed){if(a.has("checkrates.add_holding_windows")&&r.closed){var i=window.cookieDomain;i&&o.write("CommercePopunder","SuppressAll",0,i)}}else e[e.length]=t}}return e},attemptHoldingWindowWNumChecked:function(){},openCloseTab:function(){var e,n;if(a.has("popunder.popunder_by_self_closing_tab"))try{n=document.createElement("a"),n.href="http://"+window.location.hostname+"/vpages/tab.html",document.body.appendChild(n),e=document.createEvent("MouseEvents"),e.initMouseEvent("click",!1,!0,window,0,0,0,0,0,!0,!1,!1,!0,0,null),n.dispatchEvent(e),n.parentNode.removeChild(n)}catch(e){r.record(e,"self-closing tab blur method failed")}else if(a.has("checkrates.cr_popunder_by_shift_ctrl")&&t.version>23)try{n=document.createElement("a"),n.href="about:blank",n.target="popunderwindowhelper",document.body.appendChild(n),e=document.createEvent("MouseEvents");var o=!0,i=!0;e.initMouseEvent("click",o,i,window,0,0,0,0,0,!0,!1,!1,!0,0,null),n.dispatchEvent(e),n.parentNode.removeChild(n),window.open("about:blank","popunderwindowhelper").close()}catch(e){r.record(e,"shift-ctrl blur method failed")}},attemptHoldingWindow:function(e){if(!this.useShiftClick())if(a.has("checkrates.add_holding_windows")){var n=this.numPopundersCheck();n<this.maxPopunders&&this.launchHoldingWindow(e)}else v>this.getHoldingWindowSet().length&&this.launchHoldingWindow(e)},launchHoldingWindow:function(e){if(!e)return!1;var n=a.retrieve("checkrates.holdingWindowURI");if(n){a.store("checkrates.HWtracking","date");var t={url:n};return this.createHoldingWindow(t)}return!1},launchAddHoldingWindow:function(e,n){var t=n||{};return t.url=e,this.createHoldingWindow(t)},popunderReminder:numPopundersCheck:function(){try{var e=this.getHoldingWindowSet(),n=0,t=o.readRaw("CommercePopunder"),i=t?t.match(/\d+/):null;return n=t&&i?Math.max(e.length,parseInt(i[0],10)):e.length}catch(e){r.record(e,"CommercePopunder - numPopundersCheck")}},trackPopunder:function(e,n){try{if(!n||!e)return;var t="CommerceEnhancedPopunder";if(e.match(/AlsoViewedLB/))t="AlsoViewedLB";else{var o=e.match(/RuleBasedPopunder\?Rule=\d+/);if(o){var d=o[0].match(/\d+/);t="RuleBasedPopunder_"+d[0]}}var c="OpenWindow",u=a.retrieve("checkrates.HWtracking");u&&(c="OpenWindow_"+u,a.remove("checkrates.HWtracking")),i.trackEventOnPage("CommercePopunder",c,t,n,!0)}catch(e){r.record(e,"CommercePopunder - trackPopunder")}},getProviderWindowDims:function(e,n){var o=null,r=null,i=null,d=null;return"hotels.com"==e&&(o=975),screen.width>=1280&&(o=1e3,r=897,n||(i=0,d=0,t.chrome?r-=50:t.firefox?r-=87:t.ie&&(o-=12,r-=179))),{customWidth:o,customHeight:r,widthOffset:i,heightOffset:d}},useShiftClick:expandSidebarWindow:function(e,n,t){i.trackEventOnPage("traffic_acquisition_sidebar","any",n,1),"true"==t&&(window.moveTo(0,0),window.resizeTo(screen.width,screen.height)),document.getElementById("SliderHolder").style.display="none",document.getElementById("PAGE").style.marginLeft="0px"},pollForPartnerLoad:extractSlotFromCommerceUrl:redirectToUrl:function(e,n){e?e.location=n:window.location=n},beforePopTargetBlankIE:function(e){return w(e)},attemptOpenUrlNewTab:function(e){return s(e)}};return n.exportTo(k,"ta.popups.PopUtil"),k});
define("mixins/page-guests/Guests",["vanillajs","ta/Core/TA.FireEvent"],function(t,r){"use strict";function s(t){this.guests=new o(t)}var e=4,n={adults:2,rooms:1,child_rm_ages:""},o=function(t){function s(t,r){var s=!1,e=!1;for(var n in t)t.hasOwnProperty(n)&&n in a&&a[n]!=t[n]&&(a[n]=t[n],o(n)&&(e=!0),s=!0);return s&&!r&&setTimeout(d,1),s}function o(t){if("adults"==t){if(i())return a.rooms=Math.ceil(a.adults/e),!0;if(u())return a.rooms=a.adults,!0}else if("rooms"==t){if(i())return a.adults=a.rooms*e,!0;if(u())return a.adults=a.rooms,!0}return!1}function i(){return a.adults/Math.max(a.rooms,1)>e}=t||{};var a={rooms:t.rooms||n.rooms,adults:t.adults||n.adults,child_rm_ages:t.child_rm_ages||n.child_rm_ages};this.getRooms=function(){return a.rooms},this.getAdults=function(){return a.adults},this.getChildRoomAges=function(){return a.child_rm_ages},this.set=function(t){return s(t)},this.clear=this.toJson=function(){var t={};for(var r in a)t[r]=a[r];return t},this.toQueryJson=function(){var t=[a.rooms,a.adults];return a.child_rm_ages&&t.push(a.child_rm_ages),{uguests:t.join("_")}};var d=function(t){window.ta&&ta.page&&ta.page.emit&&ta.page.emit("guestsSelected",this.toJson(),t)}.bind(this);r.on("onLegacyGuestsChanged",function(t){if(t){var r={rooms:t.rooms,adults:t.guests,child_rm_ages:t.child_rm_ages};s(r,!0)&&d(!0)}});var c=!1;r.on("receivedGuestData",function(t){var r={};for(var e in{adults:1,rooms:1,child_rm_ages:1}){var n=t.getAttribute("data-"+e);n&&(r[e]=n)}!s(r,!0)&&c||d(!0),c=!0})};return s});
define("overlays/options/closeOnSourceClick",["vanillajs","api-mod"],function(t,e){"use strict";function n(t){e.containsElement(this.sourceElement,t.target)&&(this.hide("source-click"),t.stopPropagation(),t.preventDefault())}function i(t){return function(){var i=n.bind(this),o=function(t){setTimeout(t.bind(this),1)}.bind(this);this.on("show",o.bind(void 0,function(){e.addEvent(this.sourceElement,"click",i),t&&e.addEvent(this.sourceElement,"touchstart",i)})).on("hide",o.bind(void 0,function(){e.removeEvent(this.sourceElement,"click",i),t&&e.removeEvent(this.sourceElement,"touchstart",i)}))}}var o=i(!0);return o.withoutTouchEvents=i(!1),o});
define("overlays/options/closeOnChildClick",["vanillajs","api-mod"],function(t,n){"use strict";function i(t){n.containsElement(this.container,t.target)&&this.hide("child-click")}function e(t){return function(){var e=n.bind(i,this);this.on("show",function(){n.addEvent(this.domParent,"click",e),t&&n.addEvent(this.domParent,"touchstart",e)}).on("hide",function(){n.removeEvent(this.domParent,"click",e),t&&n.removeEvent(this.domParent,"touchstart",e)})}}var o=e(!0);return o.withoutTouchEvents=e(!1),o});
define("overlays/options/repositionOnEvent",["vanillajs","api-mod"],function(n,i){"use strict";function t(){this.emit("positionDirty")}return function(n,o){return function(){var e=o.splice?o:[o],c=i.bind(t,this);this.on("show",function(){e.forEach(function(t){i.addEvent(n,t,c)})}).on("hide",function(){e.forEach(function(t){i.removeEvent(n,t,c)})})}}});
define("overlays/options/minWidth",["vanillajs"],function(i){"use strict";var n=function(i){function n(){this.container.style.minWidth=i+"px",this.emit("positionDirty")}return function(){this.on("show",n.bind(this))}};return n});
define("overlays/options/maxWidth",["vanillajs"],function(i){"use strict";var t=function(i){function t(){this.container.style.maxWidth=i+"px",this.emit("positionDirty")}return ;return t});
define("overlays/options/keepInDom",["vanillajs","api-mod"],function(n,i){var t="";return function(){this.isOpen=function(){return!!i.inDocument(this.container)&&!i.hasClass(this.container,"hidden")},this.show=function(){return i.inDocument(this.container)?(this.container.style.display=t,i.removeClass(this.container,"hidden")):this.domParent.appendChild(this.container),this.emit("show"),this},this.hide=function(n){return i.inDocument(this.container)&&"none"!=this.container.style.display&&("none"!=this.container.style.display&&(t=this.container.style.display||"",this.container.style.display="none"),i.hasClass(this.container,"hidden")||i.addClass(this.container,"hidden"),this.emit("hide",{trigger:n})),this}}});
define("overlays/styles/dropdown",["vanillajs","api-mod"],function(t,n){"use strict";function e(t,e,i,o){this.container=n.createElement(o||"span",{"class":"ui_overlay ui_dropdown "+e,"style":i}),this.contentElement=this.container}var i=function(t,n,i,o,r,a){i=i||t.getAttribute("data-dropdown")||"";var s=r||t.getAttribute("style")||"";return function(){e.call(this,n,i,s,a),this.updateContent(o)}};return i});
define("forms/select",["vanillajs","api-mod","overlays/Overlay","overlays/position","overlays/options/closeOnDocClick","overlays/options/closeOnSourceClick","overlays/options/closeOnChildClick","overlays/options/repositionOnEvent","overlays/options/minWidth","overlays/options/maxWidth","overlays/options/keepInDom","overlays/styles/dropdown","mixins/Events"],function(e,t,n,i,o,s,c,l,a,r,u,d,h){function v(){function e(){t.removeClass(m,"open"),g.emit("close")}function v(){E.show(),t.addClass(m,"open"),g.emit("open")}function f(e,n,i){if(e){if(C!=e){y.innerHTML=e.innerHTML;var o=e.getAttribute("data-value");w&&(w.value=o),C&&t.removeClass(C,"ui_icon checkmark"),t.addClass(e,"ui_icon checkmark"),C=e,g.emit("change",o,e.innerHTML,i)}}else C&&(t.removeClass(C,"ui_icon checkmark"),C=null);return n&&E.hide(),!!e}function p(e){f(this,!0)}var m,k,y,w,C,E,g=this;t.mixin(this,new h("open","close","change")),this.init=function(h,v,f,m){k=t.find(".options",h),C=t.find(".option.ui_icon.checkmark",k);var y=h.getAttribute("data-select-class")||[];return E=new n(h,d(h,"below",y,k,null,f),i.below([0,-h.offsetHeight]),a(h.offsetWidth),m&&r(h.offsetWidth),o.withoutTouchEvents,c.withoutTouchEvents,s.withoutTouchEvents,l(window,"resize"),l(window,"scroll"),u),t.removeClass(k,"hidden"),E.on("hide",e),h.onclick=function(){},t.select(".option",k).forEach(function(e){t.addEvent(e,"click",p)}),this.attach(h,!v),this.init=function(){},this},this.attach=function(e,n){m!==e&&(m&&t.removeEvent(y,"click",v),m=e,y=t.find(".closed_text,.select-label",m),w=t.find(m.getAttribute("data-input"),m),E.sourceElement=m,t.addEvent(y,"click",v),n&&v())},this.destroy=function(){E&&(t.select(".option",k).forEach(,t.removeEvent(y,"click",v),E.destroy(),E=null)},this.revealValue=function(e){t.removeClass(t.find('.option[data-value="'+e+'"]',k),"hidden")},this.selectValue=function(e){return f(t.find('.option[data-value="'+e+'"]',k),!1,!0)},this.selectValueAndClose=function(e){return f(t.find('.option[data-value="'+e+'"]',k),!0,!0)},this.getValue=this.reposition=function(){E&&t.hasClass(m,"open")&&E.reposition()}}return{Select:v}});
define("mixins/page-guests/GuestsSelector",["vanillajs","ta","forms/select"],function(t,e,n){"use strict";function s(t,s,i){function a(e,n){if(!f){var i={};i[t]=parseInt(e,10),c.set(i)&&s()}}function u(e,n){o&&(f=n,o.selectValue(e[t]),f=!1,n&&i&&i(e))}var o,f;this.init=function(t){t&&(e.page.off("guestsSelected",u).on("guestsSelected",u),o||(o=new n.Select,o.on("change",a),o.init(t,!0)))},this.attach=function i(t){c=t,this.GuestsSelector=s}var c;return i});
define("ta/util/LegacyDateShim",["vanillajs","api-mod","ns-exporter","ta/util/Error","ta/Core/TA.Event","utils/ajax","ta/Core/TA.Store","ta/util/Date"],function(e,t,a,r,n,s,o,l){function i(){return ta.page&&ta.page.hasDates&&ta.page.hasDates("STAYDATES")}unction d(e){var t=ta.page.datesToQueryJson(e||"STAYDATES");if(o.has("guests_rooms_picker.enabled")){var a=ta.page.guests.toJson();for(var r in a)t[r]=a[r]}else t.adults=f();return t}function c(){var e=ta.page.guests.toJson();return e.guests=e.adults,delete e.adults,e}function g(){return ta.page&&ta.page.getDates&&ta.page.getDates("CHECKIN")[0]||void 0}function p(){return ta.page&&ta.page.getDates&&ta.page.getDates("CHECKOUT")[0]||void 0}function D(){if(!i())return!1;var e=ta.widgets.calendar.getPageInDate(),t=ta.widgets.calendar.getPageOutDate(),a=Math.round(Math.abs((e.getTime()-t.getTime())/l.MS_IN_DAY));return a>=1&&a<=l.MAX_STAY_DURATION_DAYS}function f(){var e=2;return ta.page.guests?e=ta.page.guests.getAdults():o.has("multiDP.adultsCount")&&(e=o.retrieve("multiDP.adultsCount"),o.store("date.picker.adultsCount",e)),e}function v(e){return"classic"===e&&"undefined"!=typeof DATE_PICKER_CLASSIC_FORMAT?DATE_PICKER_CLASSIC_FORMAT:"short"===e&&"undefined"!=typeof DATE_PICKER_SHORT_FORMAT?DATE_PICKER_SHORT_FORMAT:"undefined"!=typeof DATE_PICKER_META_FORMAT?DATE_PICKER_META_FORMAT:("string"!=typeof e&&(e="not_a_string"),"")}function h(){var e="no dates";try{var t=v("classic");i()&&(e=ta.widgets.calendar.dateToString(ta.widgets.calendar.getPageInDate(),t),e=e+" - "+ta.widgets.calendar.dateToString(ta.widgets.calendar.getPageOutDate(),t))}catch(e){}return e}function E(e,t){var a,r,n,s,i,u,d,c,g;return e&&e.getDate&&t?t==v("classic")?(a=new Date(e),o.retrieve("thai_buddhist_era_year")&&a.setFullYear(a.getFullYear()+l.THAI_BUDDHIST_YEAR_OFFSET),r="MM",n="yyyy",s="dd",c=a.getDate()+"",t.indexOf("dd")!=-1?c&&1===c.length&&(c="0"+c):s="d",g=a.getMonth()+1+"",t.indexOf("MM")!=-1?g&&1===g.length&&(g="0"+g):r="M",t=t.replace(r,g).replace(s,c).replace(n,a.getFullYear()).replace(/'/g,"")):t==v("short")?(a=new Date(e),r="MM",s="dd",c=a.getDate()+"",c&&1==c.length&&(c="0"+c),g=a.getMonth()+1+"",g&&1==g.length&&(g="0"+g),t=t.replace(r,g).replace(s,c).replace(/'/g,"")):(i=o.retrieve("multiDP.abbrevMonthList"),u=e.getDay(),o.retrieve("multiDP.isMondayFirstDayOfWeek")&&(u-=1),u==-1&&(u=6),d="EEE",r="MMM","EEEE d MMMM"==t&&(d="EEEE",r="MMMM"),t=t.replace(d,jsGlobalDaysAbbrev[u]).replace(r,i[e.getMonth()]).replace(/\bd\b/,e.getDate()).replace(/'/g,"")):""}function T(){try{var e=g(),t=p(),a=f();if(!e||!t||!a)return null;var n=e.getDate(),s=e.getMonth()+1,o=e.getFullYear(),l=t.getDate(),i=t.getMonth()+1,u=t.getFullYear(),d={"inDay":n,"inMonth":s+" "+o,"outDay":l,"outMonth":i+" "+u,"adults":a};return d}catch(e){return r.record(e,"Unable to create calendar date args object"),null}}function y(){ta.page&&ta.page.processNewTravelInfo&&ta.page.processNewTravelInfo()}function C(e,t,a){return t&&!i()?void(e&&"function"==typeof e&&e()):(s({url:"/UpdateSessionDatesAjax",data:d(),method:"post",async:a!==!0,success:function(){"function"==typeof e&&e(),n.fireEvent("hotels.sessionDatesUpdated")}}),!0)}function M(e){ta.page.gatherDatesNear(e),!window.event||window.event.target!==e&&window.event.currentTarget!==e||t.stopEvent(window.event)}function _(e){if(e){e=JSON.decode(e);var t=e.url;o.retrieve("is_from_sdprospect")&&t.contains("Hotels")&&(t=t.replace("Hotels","SmartDeals")),window.location=t}else window.location="/Hotels"}function m(){var e,t,a,r=null;if(ta.page.hasDates("CHECKIN")){e=document.querySelectorAll(".meta_date_field.first .date_picker.date"),a=null;for(var n=0;n<e.length;++n)t=e[n].firstChild,t&&3==t.nodeType&&(r=r||v("classic"),a=a||E(ta.page.getDates("CHECKIN")[0],r),t.nodeValue=a)}if(ta.page.hasDates("CHECKOUT")){e=document.querySelectorAll(".meta_date_field .out_date .date_picker.date"),a=null;for(var n=0;n<e.length;++n)t=e[n].firstChild,t&&3==t.nodeType&&(r=r||v("classic"),a=a||E(ta.page.getDates("CHECKOUT")[0],r),t.nodeValue=a)}}function A(e,t,a){var r="date.picker.calendarflyout",n=o.retrieve(r);n||(n=[]);var s={};s.elmt=e,s.overlay=t,s.overlaySrc=a,n.push(s),o.store(r,n),o.remove("date.picker.calendarflyout.allCleared")}function w(){var e="date.picker.calendarflyout",t=o.retrieve(e);t&&(t.forEach(function(e){var t=e.elmt,a=e.overlay,r=e.overlaySrc;t&&a&&r&&(t.removeEventListener("mouseenter",a.showWithDelay),t.removeEventListener("mouseleave",a.hideWithDelay),t.removeEventListener("mouseenter",a.show),t.removeEventListener("mouseleave",a.hide),t.removeEventListener("click",a._pin),t.appendChild(r))}),o.store("date.picker.calendarflyout.allCleared",!0))}function S(){t.select(".roomsButton .grp-rooms-value").forEach(function(e){e.innerHTML=ta.page.guests.getRooms()}),t.select(".guestsButton .grp-guests-value").forEach(,ta.widgets.calendar.syncAllDatePickers()}function R(){}if(ta.widgets&&ta.widgets.calendar&&ta.widgets.calendar.hasPageDates)return ta.widgets.calendar;var P={hasPageDates:i,hasRoundTripDates:u,datesExist:i,datesInRange:D,getCheckRatesData:d,getDateArgsObject:T,getGuestsRoomsPickerData:c,updateGuestsRoomsPickerDataFromCookie:R,updateGuestsRoomsPickerUI:R,getPageInDate:g,getPageOutDate:p,getPageAdultsCount:f,getDatePickerFormat:v,getErrorDates:h,dateToString:E,checkDatesMakeHacCallHR:y,justUpdateSessionDates:C,setErrorStyling:M,redirectToHotelOverview:_,updateLegacyDatePickers:m,trackCalendarEvent:R,closeCalendarWidgets:R,handleNewDates:R,syncAllDatePickers:R,trackCRButtonClick:R,clearCalendarFlyouts:w,trackCalendarFlyout:A,removeMetaCalendarFromSync:R,updateAllGuestsRoomsButtons:S,isShim:!0};return a.exportTo(P,"ta.widgets.calendar"),P});
define("mixins/flight-traveler-info/FlightTravelerInfo",["vanillajs"],function(e){"use strict";function t(e){this.travelerInfo=new s(e)}var i="travelerInfoChanged",s=function(e){e=e||{};var t={adults:e.adults,seniors:e.seniors,childAges:e.childAges,classOfService:e.classOfService};this.getAdults=function(){return t.adults},this.getSeniors=function(){return t.seniors},this.getChildAges=function(){return t.childAges},this.getNumChildren=this.getTotalTravelers=this.getClassOfService=function(){return t.classOfService},this.setAdults=function(e){e!==t.adults&&(t.adults=e,ta.page.emit(i,t))},this.addAdults=function(e){0!==e&&(t.adults+=e,ta.page.emit(i,t))},this.setSeniors=function(e){e!==t.seniors&&(t.seniors=e,ta.page.emit(i,t))},this.addSeniors=function(e){0!==e&&(t.seniors+=e,ta.page.emit(i,t))},this.addChildAge=this.removeLastChild=function(){t.childAges.pop(),ta.page.emit(i,t)},this.changeChildAge=function(e,s){s!==t.childAges[e]&&(t.childAges[e]=s,ta.page.emit(i,t))},this.setClassOfService=function(e){"number"==typeof e&&e!==this.getClassOfService()&&(t.classOfService=e,ta.page.emit(i,t))},this.setData=function(e){t.adults=e.adults,t.seniors=e.seniors,t.childAges=e.childAges.slice(),t.classOfService=e.classOfService,ta.page.emit(i,t)}};return t});
define("mixins/page-dates/MultiCity",["vanillajs","ta","ta/util/SessionStorage","mixins/page-dates/Utils"],function(t,e,a,i){ar s="ONEWAYFLIGHT",o=["LEG_1","LEG_2","LEG_3"],r=function(){var t=a.canUseSessionStore();t&&o.forEach(function(t){var a=i.fromString(window.sessionStorage.getItem("multiCity-"+t+"-date"));a&&!isNaN(a.getTime())&&e.page.setDates(t,[a])});var n=function(e,a,n){n[0]&&t&&o.indexOf(a)>=0&&window.sessionStorage.setItem("multiCity-"+a+"-date",i.dateToIso(n[0]))};e.page.on("dateSelected",n),this.clearInvalidDates=function(){var t=e.page.getDates(s)[0];o.forEach(function(a){var i=e.page.getDates(a)[0];i&&(!t||i>=t?t=i:e.page.pushDates(null,a,[null]))})}};return n});
define("mixins/page-airports/Airports",[],function(){"use strict";ar i=function(t){t=t||{};var i={origination:t.origination,destination:t.destination};this.setOrigination=function(t){return this.set(Object.assign({},i,{origination:t}))},this.setDestination=function(t){return this.set(Object.assign({},i,{destination:t}))},this.set=function(t){var e=!1;return Object.keys(t).forEach(function(n){n in i&&i[n]!==t[n]&&(i[n]=t[n],e=!0)}),e&&setTimeout(n,1),e},this.getOrigination=function(){return this.get().origination},this.getDestination=this.get=this.getQueryString=function(){var t=[i.origination,i.destination];return t.join("_")};var n=function(){window.ta&&ta.page&&ta.page.emit&&ta.page.emit("airportsSelected",this.get())}.bind(this)};return t});
define("mixins/vacation-packages/VacationPackagesTripSearchForm",["ta/Core/TA.Event","mixins/mixin","mixins/page-dates/DateEvents","mixins/page-dates/Responsive","mixins/page-guests/Guests","mixins/page-airports/Airports","utils/ajax","ta/Core/TA.Record","ta/util/SessionStorage"],function(e,t,a,i,n,s,r,o,c){"use strict";function g(g){function u(t){var a=Object.assign({},_,t);if(JSON.stringify(_)!==JSON.stringify(a)){_=a;var i=d();e.fireEvent("vacation_packages_search_updated",i)}}function p(){f.airports.getDestination()||f.airports.setDestination(E),r({url:"/UpdateSessionDatesAjax",data:{vpairports:f.airports.getQueryString()},method:"post",async:!0})}function d(){var e={},t=!1;return!h&&(_.origination&&"null"!==_.origination||(t=!0,e.origination=!0),_.geo||(t=!0,e.geo=!0),f.hasDates("VPDATES")||(t=!0,e.dates=!0),t&&e)}function v(t){l||e.fireEvent("vacation_packages_geo_reset"),o.trackEventOnPage("vp_search","click"),h=!1;var a=d();return a?void e.fireEvent("vacation_packages_search_updated",a):(e.fireEvent("vacation_packages_redirecting",!0),c.setObject("vp_geo_changed",_.geo),void(window.location=window.location.pathname.concat("-g"+_.geo)))}if(!g)return void require(["ta/util/Error"],function(e){e.record(null,"/VP init missing options")});t(this,a),t(this,new i(g.pageDates,g.calendar)),t(this,new n(g.pageGuests)),t(this,new s(g.pageAirports));var f=this,h=!0,l=!1,E="NA",_=Object.assign({},f.guests.toJson(),f.airports.get(),{geo:g.geo,departure:f.getDates("VPDEPARTURE")[0],return:f.getDates("VPRETURN")[0]});f.on("guestsSelected",,f.on("airportsSelected",function(){u(f.airports.get()),p()}),f.on("dateSelected",function(){u({"departure":f.getDates("VPDEPARTURE")[0],"return":f.getDates("VPRETURN")[0]})}),e.on("vacation_packages_geo_selected",,this.searchErrors=d,this.updateSearchParams=u,this.search=v,this.autoAdvancingEnabled=return g});
define("servlets/homerebranded",["ta","vanillajs","mixins/mixin","mixins/page-dates/DateEvents","mixins/page-dates/Responsive","ta/Core/TA.Event","ta/popups/PopUtil","ta/util/Element","ta/Core/TA.Store","ta/util/Error","mixins/page-guests/Guests","mixins/page-guests/GuestsSelector","ta/util/LegacyDateShim","mixins/page-dates/DateTypeStore","utils/ajax","common/pixels-loader","mixins/flight-traveler-info/FlightTravelerInfo","mixins/page-dates/MultiCity","mixins/Events","utils/urlDecoder","mixins/vacation-packages/VacationPackagesTripSearchForm"],function(e,t,a,n,r,i,s,o,c,l,u,f,d,g,h,p,m,v,_,S,b){"use strict";function w(e){e&&Object.keys(e).forEach(}function x(e){if(e){var t=new Date;t.setDate(t.getDate()+7);var a=JSON.stringify({partnerReference:e.partnerReference,referrerId:e.partnerReferrerId,expires:t});localStorage.setItem("VacationRentalPartnerReferrerParams",a)}}function D(t){G||(a(this,n),_.extend("travelerInfoChanged"),a(this,new r(t.pageDates,t.calendar)),a(this,new u(t.pageGuests)),a(this,new f(this.guests)),a(this,new m(t.travelerInfo)),a(this,new v),t.isVpLander&&a(this,new b(t)),I(),p.init(t.remarketingOptions),G=!0),w(t.itemsToStore),x(t.partnerReferrerParams);var i=this.onDatesSelected;this.onDatesSelected=function(e,t,a){i(e,t,a),A(g.isChildDateType(t)?g.getParents(t):[t],};var s=this.clearDates;return this.clearDates=function(t){s(t),this.onDatesSelected(null,t,e.page.getDates(t)),y()},this.on("travelerInfoChanged",,this.processNewTravelInfo=function(){C()},R={rooms:new this.GuestsSelector("rooms",C.bind({},!0)),adults:new this.GuestsSelector("adults",C.bind({},!0))},P(),this}function A(t,n){var r=t.map(e.page.datesToQueryJson).reduce({});0!==Object.keys(r).length&&h({url:"/UpdateSessionDatesAjax",data:r,method:"post",async:!0,success:function(){"function"==typeof n&&n()}})}function y(){h({url:"/UpdateSessionDatesAjax",data:{clear:!0},method:"post",async:!0})}function k(e,t){for(var a=e.getAdults()+"_"+e.getSeniors()+"_"+e.getClassOfService(),n=0;n<e.getNumChildren();n++){var r=e.getChildAges()[n];r>=0&&(a+="_"+r)}h({url:"/UpdateSessionDatesAjax",data:{travelerinfo:a},method:"post",async:!1,success:)}function C(t){t&&(c.store("hotels.datesChanged",!0),c.store("meta.isFromDatesChange",!0)),e.page.emit("newPageTravelInfo")}function I(){try{var e=[],t=["#taplc_brand_messaging_0",".shelf_container","#taplc_attractions_near_you_link_0","#taplc_global_footer_0"];t.forEach(function(t){for(var a=document.querySelectorAll(t),n=0;n<a.length;n++)a[n].className.indexOf("featured_destinations")==-1&&e.push(a[n])}),e.forEach(function(e){var t=E(e),a=T(e);if(t&&a){var n=["Home","shelf_in_view",t],r=j(e);if(r&&n.push(r),e.getAttribute&&e.getAttribute("data-brand-shelf")){var i=window.location.pathname,s=i.length<=1?"servletname_Home":"servletname_"+i.substring(1);o.trackWhenScrolledIntoView(a,["pcb_campaign_trending_view","view",s])}o.trackWhenScrolledIntoView(a,n)}})}catch(e){l.record(e,"homepage _setupScrollTracking error")}}function T(e){var t=null;if(e.id)t="#"+e.id;else{var a="."+e.className.split(/ +/).join("."),n=document.querySelectorAll(a);1===n.length?t=a:l.record(null,"ambiguous selector for scroll tracking: "+a)}return t}function E(e){var t=e.getAttribute("data-rownumber");return t?""+t:e.getAttribute("data-placement-name")}unction P(){e.on("shelf_item_click_event",function(e,t){O(e,t),location.href=S.getUrl(t)}),e.on("track_shelf_item_click_event",}function O(t,a){var n=a.getAttribute("data-tpp"),r=a.getAttribute("data-tpact"),i=a.getAttribute("data-tpatt"),s=a.getAttribute("data-tpid");e.trackEventOnPage(n,r,i,s)}var R,G=!1;return{init:D}});
require(["ta/p13n/placements"],function(e){var n=e.define.bind(e,"masthead_h1","handlers",["handlers"]);n(["placement","ta/Core/TA.FireEvent"],function(e,n){"use strict";function t(n){var t=document.getElementById(e.id);t&&(t.innerHTML=n.innerHTML)}var r="true"===e.params.trackInView;return r&&require(["trjs!ta/util/Element"],function(n){n.trackWhenScrolledIntoView("#"+e.id,["masthead","in_view"])}),n.on("update-"+e.name,t),{}})});
define("mixins/page-dates/picker-autoadvance-utils",[],function(){var e={};return e.keepOverlayOpenOnSelection=function(e){for(var n=document.querySelectorAll(".ui_overlay"),r=0;r<n.length;r++){var t=n[r].overlay,a=t&&t.sourceElement;if(a===e){t.dontHideOnSelection=!0;break}}},e});
define("mixins/page-dates/picker-autoadvance",["mixins/page-dates/DateTypeStore","mixins/page-dates/picker-autoadvance-utils","utils/domUtils"],function(e,t,a){"use strict";function i(i,r,s){var o=ta.page;o&&o.on("dateSelected",function d(l,u,p){if(!a.isOrContainsElement(document.body,i))return void o.off("dateSelected",d);if(l&&a.isOrContainsElement(i,l)){var c=e.getCorrespondingDateType(u);if(c){var f=e.isStartDateType(u),g=!o.hasDates(c)||s&&f&&u!==n;if(g){if(r&&!o.hasDates(c)&&Array.isArray(p)){var v=new Date(p[0].getFullYear(),p[0].getMonth(),p[0].getDate()+(f?1:-1));o.pushDates(null,c,[v])}var y=i.querySelector('[data-datetype="'+c+'"]');y&&(n=c,t.keepOverlayOpenOnSelection(l),setTimeout(o.gatherDates.bind(o,y)))}}}})}var n=null;return{apply:i}});
require(["ta/prwidgets"],function(e){var t=e.define.bind(e,"datepickers_trip_search_dates","handlers",["handlers"]);t(["widget","lib/jquery-amd","api-mod","ta/Core/TA.Event","common/trackingStreams","mixins/page-dates/picker-autoadvance","common/Radio","mixins/page-dates/default-dates"],function(e,t,r,a,n,i,o,c){"use strict";function l(e,r){var a,n=e.attr("data-dateFormat");try{a=r?ta.i18n.formatDate(n,r):e.attr("data-emptyText");var i=e.find(".picker-label.target");i.removeClass("ghost_text"),t(".picker-inner .picker-label",e).html(a)}catch(e){require(["trjs!ta/util/Error"],function(t){t.record(e,"handlers dateSelected - parentElement.contains")})}}function d(t,a,n){try{if(!r.inDocument(e.element))return ta.page.removeListener("dateSelected",d),h=null,void(_=null)}catch(e){require(["trjs!ta/util/Error"],function(t){t.record(e,"handlers _onDateSelected - inDocument")})}try{"CHECKIN"===a?l(h,n[0]):"CHECKOUT"===a?l(_,n[0]):"STAYDATES"===a&&(l(h,n[0]),l(_,n[1]))}catch(e){require(["trjs!ta/util/Error"],}}function s(e,r,a,n){if(r){e&&"click"==e.type&&(e.stopPropagation(),u(e));var i=t(".ui_overlay.rooms_guests_children");if(i){var o=t(".ui_overlay.rooms_guests_children .ui_close_x");o.click()}return ta.page.gatherDates(r,null,a,!1,n),!1}}function u(e){if(e){var t="datepicker";r.getParent(m,"persistent_trip_search_fixed")&&(t+="_persistent");var a="module";e.target&&(e.target==h[0]||r.containsElement(h[0],e.target)?a="checkin":e.target==_[0]||r.containsElement(_[0],e.target)?a="checkout":e.target.className.indexOf("caret-down")>=0&&(a="caret")),n.trackEvent(t,"click",a)}}unction g(){require(["ta/page"],function(t){t.on("dateSelected",d),ta.store&&ta.store("interact_through_progress_bar",!0),i.apply(e.element,k,k),c.apply(e.element)})}var m=e.element,f=t(".ui_picker .unified-picker",m),h=t("[data-datetype=CHECKIN]",m),_=t("[data-datetype=CHECKOUT]",m),k=!!m.getAttribute("data-hotels-improvements"),v=!!m.getAttribute("data-early-autopop");return f.on("focus",function(e){s(e,this,!k)}),o("search").on("loading",function(r){t(e.element).toggleClass("loading",r)}).on("popDatePicker",function(){s(null,h[0],!1)}),v?g():a.queueForLoad(g,"datepicker widget handlers"),t(m).on("click",function(e){return e.target===_[0]||r.containsElement(_[0],e.target)?s(e,_[0],k):s(e,h[0],k)}),{openCalendar:p}})});
require(["ta/prwidgets"],function(e){var t=e.define.bind(e,"common_form_submit","handlers",["handlers"]);t(["widget","lib/jquery-amd","page-model","common/Radio","ta/Core/TA.Store","common/trackingStreams"],function(e,t,a,r,i,o){"use strict";function n(e){if(!k.requestAny("is-valid",!1)){var a=k.request("url:require");a?(_?k.trigger("loading",!0):k.trigger("disabled",!0),t.when(a).done(function(t){t?(t=s(t),require(["trjs!ta/Core/TA.Record"],function(a){a.setEvtCookie("tripsearch",m?m:"submit",f(t,e),0,t),window.location=t.replace("/Tourism",e)})):(k.trigger("loading",!1),o.trackEvent("tripsearch","submit_error",e.substr(1)))})):o.trackEvent("tripsearch","submit_error",e.substr(1))}}function s(e){var t=window.location.pathname,r={hotels:"Hotels"===a.session.pageServlet,restaurants:"Restaurants"===a.session.pageServlet};if(r.hotels||r.restaurants){var i=new RegExp("-g[0-9]+-");if(!t.match(i)){var o=new RegExp("-([a-z]+)([0-9]+)-"),n=o.exec(t);if(n){var s=n[1],c=n[2];if(s&&c){var l=e.indexOf("?")>-1?"&":"?",u=e+l;return"26"===c&&"zff"===s&&r.hotels&&(u+="c=3&"),u+s+"="+c}}}}return e}function c(a){if(a&&"click"==a.type){var r="formsubmit";t(e.element).parents(".persistent_trip_search_fixed").length&&(r+="_persistent"),o.trackEvent(r,"click","update")}}function l(e,a){!1!==k.request("is-valid")&&(o.trackEvent("GuestSelector-tripsearch","update_results_click",w,"1",!1),c(e),ta.servlet&&ta.servlet.HACSearch?ta.servlet.HACSearch.doMetaDateSearch(i.retrieve("page.location"),a):ta.page.processNewTravelInfo(),t(a).addClass("disabled"),t(".ui_overlay .ui_close_x").click())}function u(e,t){!1!==k.request("is-valid")&&(o.trackEvent("RGP_global_update","Click"),ta.page&&ta.page.processNewTravelInfo&&ta.page.processNewTravelInfo())}function p(e,a){!1!==k.request("is-valid")&&(ta.page&&ta.page.onDatesSelected(),t(".ui_overlay .ui_close_x").click())}function g(e,t,a){e&&e.detail>0&&e.currentTarget&&e.currentTarget.blur(),ta&&ta.page&&ta.page.processNewTravelInfo&&"function"==typeof ta.page.processNewTravelInfo&&ta.page.processNewTravelInfo(e,t,a)}function v(e,a){var r=!1,i=t(".ui_overlay.rooms_guests_children .age-picker.error").is(":visible");i&&(r=!0),t(".ui_overlay .ui_close_x").click(),ta&&ta.page&&ta.page.processNewTravelInfo&&"function"==typeof ta.page.processNewTravelInfo&&ta.page.processNewTravelInfo(e,a)}function d(e,a){t(".ui_overlay .ui_close_x").click(),ta&&ta.page&&ta.page.processNewTravelInfo&&"function"==typeof ta.page.processNewTravelInfo&&(o.trackEvent("AttractionProductDetail","click_check_availability_cta","tourplanner"),ta.page.processNewTravelInfo(e,a))}function f(e,t){var a=new RegExp("/(.*?_Review)-g"),r=new RegExp("/(.*?Near)-g"),i=a.exec(e);if(i)return i[1];var o=r.exec(e);return o?o[1]:t.substr(1)}var _=!0,m="",k=r("search"),w="",b=i.retrieve("tracking.impression.key"),h=i.retrieve("page.location");return b&&(w="IK:"+b),h&&(w+="/L:"+h),k.on("loading",function(a){t(e.element).toggleClass("loading",a),t(e.element).closest(".trip_search.rounded_lockup").toggleClass("loading",a)}).on("disabled",.on("submit",function(a,r){_=a,m=r,t("button",e.element).click()}),{run:n,updateHotels:l,updateResponsiveListPage:u,updateSemPage:p,updateAttractionProducts:v,apdAvailabilityCheck:d,updateAttractions:g}})});
define("hotels/ChildAgesSerialization",["vanillajs"],function(){function n(n){return null==n||0===n.length?[]:n.split(t).map(function(n){return parseInt(n,10)}).filter(}function e(n,e){if(null==e||0===e.length)return"";for(var t=Math.floor(e.length/n),l=e.length-t*n,a=[],u=0,o=0;o<n;++o){var f=0;if(f=o<l?t+1:t){var h=Math.min(u+f,e.length),s=e.slice(u,h);u=h,a.push(s.join(i))}}return a.join(r)}var i=",",r=":",t=new RegExp(i+"|"+r);return{deserialize:n,serialize:e}});
define("hotels/RoomsGuests",["hotels/ChildAgesSerialization","api-mod","ta/Core/TA.Store","utils/objutils","mixins/Events","vanillajs"],function(e,n,t,i,r,s){"use strict";function l(e){for(var n=new Array(e),t=0;t<e;++t)n[t]=u;return n}var u=-1,o=1,a=2,h=0,c=4,d=10,A={ROOMS_CHANGED:"roomsChanged",ADULTS_CHANGED:"adultsChanged",CHILDREN_CHANGED:"childrenChanged"},g={MIN_ROOMS:1,MAX_ROOMS:8,MIN_ADULTS:1,MAX_ADULTS:8*c,MIN_CHILDREN:0,MAX_CHILDREN:20,MAX_CHILD_AGE:17,MAX_ADULTS_PER_ROOM:4,MAX_CHILDREN_PER_ROOM:10},m=function(s){function m(e,n,t){return isNaN(e)||e%1!==0?null:Math.min(t,Math.max(n,e))}function f(e){return m(e,g.MIN_ROOMS,g.MAX_ROOMS)}function C(e){return m(e,g.MIN_ADULTS,g.MAX_ADULTS)}ction E(t){R=f(t.nRooms)||o,D=C(t.nAdults)||a;var i;t.childrenAges?(H=N(n.isArray(t.childrenAges)?t.childrenAges:e.deserialize(t.childrenAges)),i=_(H.length),H=H.slice(0,i)):(i=_(t.nChildren)||h,H=l(i))}var R,D,H,S=s||{},b=S.roomChangedCallback||function(){},O=S.adultsChangedCallback||function(){},I=S.childrenChangedCallback||function(){},L=new(r.bind.apply(r,Object.keys(A).map(function(e){return A[e]})));if(S.initialValues)E(S.initialValues);else if(S.initialValuesHolder){var v={nRooms:Number(S.initialValuesHolder.getAttribute("numRooms")),nAdults:Number(S.initialValuesHolder.getAttribute("numAdults")),nChildren:Number(S.initialValuesHolder.getAttribute("numChildren")),childrenAges:S.initialValuesHolder.getAttribute("childrenAges")};E(v)}else E({});this.get=this.fromStore=function(){var n=t.retrieve("guests.rooms.object");this.update({nRooms:n.rooms,nAdults:n.guests,childrenAges:e.deserialize(n.child_rm_ages)})},this.hasStoreValues=function(){return t.has("guests.rooms.object")},this.updateStore=function(){var n=t.retrieve("guests.rooms.object"),i=H.map(,r={guests:D,rooms:R,child_rm_ages:e.serialize(R,i)};return n&&n.guests===r.guests&&n.rooms===r.rooms&&n.child_rm_ages===r.child_rm_ages?null:(t.store("guests.rooms.object",r),r)},this.clear=function(){return this.update({nRooms:o,nAdults:a,nChildren:h})},this.update=function(e){var t,r,s,g,m,M,E=e.nRooms||R,S=e.nAdults||D;if(n.isArray(e.childrenAges)?(r=N(e.childrenAges),t=r.length):"undefined"!=typeof e.nChildren?(t=e.nChildren,r=H.length<t?l(t).map(:H.slice(0,t)):(t=H.length,r=H),R===E&&D===S&&H.length===t)return!i.shallowEquals(H,r)&&(H=r,I(H),L.emit(A.CHILDREN_CHANGED,H),!0);var v=_(t)||h;if(E!==R)m=f(E)||o,s=m>S?m:Math.min(E*c,S),g=Math.min(E*d,v);else{var p=C(S)||a,T=Math.ceil(p/c);T=Math.max(T,E);var G=Math.ceil(v/d);m=Math.max(T,G),m=Math.min(m,p),g=Math.min(v,m*d),s=p}M=r.length>g?r.slice(0,g):r;var j=!1;return m!==R&&(b(m),L.emit(A.ROOMS_CHANGED,m),j=!0),s!==D&&(O(s),L.emit(A.ADULTS_CHANGED,s),j=!0),i.shallowEquals(H,M)||(I(M),L.emit(A.CHILDREN_CHANGED,M),j=!0),R=m,D=s,H=M,j},this.equals=function(e){return R===e.nRooms&&D===e.nAdults&&i.shallowEquals(H,e.childrenAges)},this.updateChildAge=function(e,n){return"string"==typeof n&&(n=parseInt(n,10)),n=M(n),e>=0&&e<H.length&&H[e]!==n&&(H[e]=n,I(H),L.emit(A.CHILDREN_CHANGED,H),!0)},this.cleanMissingChildrenAges=function(){var e=H.filter(;return H=e,I(e),L.emit(A.CHILDREN_CHANGED,e),e},this.hasMissingChildrenAges=function(){for(var e=0;e<H.length;++e)if(H[e]===-1)return!0;return!1},this.on=L.on.bind(L),this.off=L.off.bind(L)};return Object.freeze?(m.EVENTS=Object.freeze(A),m.CONSTANTS=Object.freeze(g)):(m.EVENTS=A,m.CONSTANTS=g),m});
define("overlays/styles/popover",["api-mod","lib/jquery-amd","overlays/utils"],function(t,e,a){"use strict";function i(e,i,n,r){this.container=t.createElement(r,{"class":"ui_overlay ui_popover arrow_"+a.getArrowDir(e,this.sourceElement,this.domParent)+" "+i,"style":n}),this.arrow=t.createElement("div",{"class":"arrow"}),this.container.appendChild(this.arrow),this.header=t.createElement("div",{"class":"header_text"}),this.container.appendChild(this.header),this.inner=t.createElement("div",{"class":"body_text"}),this.container.appendChild(this.inner),this.contentElement=this.inner,this.close=t.createElement("div",{"class":"ui_close_x"}),this.container.appendChild(this.close)}var n=function(n,r,s,o,h,d){n=e(n),s=s||n.attr("data-popover")||"",o=o||n.attr("data-header")||"",h=h||n.attr("data-content")||"";var c=n.attr("data-style")||"",l=n.attr("data-header-element"),p=n.attr("data-header-copy");return function(){i.call(this,r,s,c,d||"span"),this.updateContent(h),o&&a.injectContent(this.header,n,o,l,p),t.addEvent(this.close,"click",t.bind(this,"close-button"))}};return n});
define("overlays/options/closeOnLegacyOverlay",["vanillajs","ta/Core/TA.Event"],function(n,e){"use strict";return );
define("overlays/options/autoReposition",["vanillajs","overlays/options/repositionOnEvent"],function(o,n){return n(window,["resize","scroll"])});
define("overlays/options/highlightElement",["api-mod"],function(i){"use strict";var n=function(n){function t(n){this.on("show",function(){i.addClass(n,"highlight")}).on("hide",}return arguments.length?void t.call(this,this.sourceElement)};return n});
define("overlays/options/centerArrowOnSrcElement",["vanillajs","api-mod"],function(t,i){"use strict";var o=function(t){function o(){if(t=t||this.sourceElement,this.container&&t&&this.arrow){var o=i.getCoords(this.container),r=i.getCoords(t),n=i.hasClass(this.container,"arrow_top")||i.hasClass(this.container,"arrow_bottom");if(n){var s=r.left+r.width/2,e=i.getSize(this.arrow).x/2,a=Math.max(e,Math.min(o.width-e,s-o.left));i.setStyle(this.arrow,{"left":a+"px","right":"auto","margin":"0 0 0 -"+e+"px"})}else{var s=r.top+r.height/2,e=i.getSize(this.arrow).y/2,h=Math.max(e,Math.min(o.height-e,s-o.top));i.setStyle(this.arrow,{"top":h+"px","bottom":"auto","margin":"-"+e+"px 0 0 0"})}}}return function(){this.on("show",i.bind(o,this)),this.on("positionDirty",i.bind(o,this)),this.on("repositionArrow",i.bind(o,this))}};return o});
define("overlays/options/blurSourceOnHide",["vanillajs"],function(){"use strict";return function(){var e=this;this.on("hide",}});
define("overlays/options/closeOnTargetEvent",["vanillajs","api-mod"],function(n,t){"use strict";eturn function(n,o){return function(){var e=o.splice?o:[o],c=i.bind(this);this.on("show",function(){e.forEach(function(i){t.addEvent(n,i,c)})}).on("hide",}}});
define("overlays/options/matchWidth",["vanillajs","api-mod"],function(t,i){"use strict";var n=function(t){function n(){this.container&&t&&(i.setStyle(this.container,"width",i.getSize(t).x+"px"),this.emit("positionDirty"))}return function(){this.on("show",i.bind(n,this))}};return n});
define("hotels/RoomsGuestsUI",["babel/babel-helpers","lib/jquery-amd","hotels/RoomsGuests","ta/Core/TA.Dust","mixins/Events","ta/Core/TA.Store","mixins/mixin","overlays/Overlay","overlays/styles/dropdown","overlays/options/closeOnDocClick","overlays/options/closeOnLegacyOverlay","overlays/options/closeOnTargetEvent","overlays/options/repositionOnEvent","overlays/options/matchWidth","overlays/options/autoReposition","overlays/position"],function(e,t,o,i,n,r,s,a,l,c,u,_,p,h,d,f){"use strict";var v=Object.freeze({VALUE_CHANGED:"valueChanged",WILL_OPEN:"willOpen",CLOSED:"closed"}),y=function(){function o(i,r,a,l,c,u,_){e.classCallCheck(this,o),this._placeHolder=t(i),this._topClass=r,this._valueDecorator="function"==typeof a?a:function(e){return e},this._valueProvider="function"==typeof l?l:function(){return 0},this._min=c,this._max=u,this._options=t.extend({},_),s(this,new n(v.VALUE_CHANGED,v.WILL_OPEN,v.CLOSED))}return e.createClass(o,[{key:"setValue",value:function(e){var t=Math.min(Math.max(this._min,e),this._max),o=this._valueDecorator(t);this._label&&this._label.text(o)}}]),o}(),k=function(o){function n(o,r,s,a,l,c,u){e.classCallCheck(this,n);var _=e.possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,o,r,s,a,l,c,u));_._element=null,_._overlay=null;var p=function(e){var t=e.attr("data-val");_.setValue(t),d(),_.emit(v.VALUE_CHANGED,t)},h=function(){if(_._overlay&&_._overlay.container){var e=t(_._overlay.container).find(".options-container");e.scrollTop(e.scrollTop()+1),e.scrollTop(e.scrollTop()-1)}},d=function(){var e=!0;_._overlay&&(e=!_._overlay.isOpen()),_._showPicker(e)},f=function(){_._overlay||(_._overlay=_._setupDropdown(),_._overlay.on("hide",_.emit.bind(_,v.CLOSED,_))),d(),h()},y=_;return i.render(_._getTemplate(),_._getData(),_._placeHolder.get(0),function(){t(o).find(".curoption").on("click",,t(o).find(".option").on("click",.each(function(){var e=t(this).attr("data-val"),o=parseInt(e,10),i=s(o);t(this).text(i)}),y.setValue(l),y._element=t(o).find(".unified-picker"),y._element.on("click",,y._element.find(".picker-inner").on("click",}),_}return e.inherits(n,o),e.createClass(n,[{key:"_setupDropdown",value:function(){var e=this._element.find(".picker-dropdown"),t=this._element.get(0);e.removeClass("hidden");var o=new a(t,l(t,"below",[],e.get(0),null,"div"),!this._options.flexWidth&&h(t),c,u,_(window,["date_bar_docked","date_bar_undocked"]));return o&&(o.domParent=t),o}},{key:"_getTemplate",value:function(){return"rooms-guests/desktop/dropdown.dust"}},{key:"_getData",value:function(){return{topClass:this._topClass,min:this._min,max:this._max+1,titleClass:this._options.titleClass}}},{key:"_showPicker",value:function(e){this._overlay&&(e&&this.emit(v.WILL_OPEN,this),this._overlay.isOpen&&(e?this._overlay.show():this._overlay.hide()))}},{key:"setValue",value:function(e){var o=this._valueDecorator(e);this._overlay?t(this._overlay.container).find(".picker-dropdown .picker-label").text(o):this._placeHolder.find(".picker-dropdown .picker-label").text(o),this._placeHolder.find(".picker-inner .picker-label").text(o)}},{key:"hidePopup",value:,{key:"destroy",value:function(e){this._overlay&&this._overlay.destroy(),e&&this._element.parent().length?this._element.parent().remove():this._element.remove()}},{key:"toggleVisible",value:,{key:"toggleError",value:function(e){this._element.find(".picker-inner").toggleClass("error",e),this._element.toggleClass("error",e)}},{key:"setTitle",value:function(e){this._options.titleClass&&this._element.find("."+this._options.titleClass).text(e)}}]),n}(y),g=function(o){function i(t,o,n,r,s,a,l){return e.classCallCheck(this,i),e.possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t,o,n,r,s,a,l))}return e.inherits(i,o),e.createClass(i,[{key:"_setupDropdown",value:function(){var e=this._element.find(".picker-dropdown").removeClass("hidden").get(0),t=this._element.find(".picker-inner").get(0);return new a(t,l(t,"below ",this._options.dropdownClasses,e,null,"div"),f.overlapRightTop(),h(t),c,u,p(window,["date_bar_docked","date_bar_undocked"]),d)}},{key:"_getTemplate",value:function(){return"rooms-guests/desktop/checkmark_dropdown.dust"}},{key:"_getData",value:function(){return t.extend(e.get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"_getData",this).call(this),{icon:this._options.icon})}},{key:"_resetSelection",value:function(e){var o=this._overlay&&this._overlay.container||this._placeHolder;t(o).find(".option.selected").removeClass("selected"),t(o).find(".option[data-val="+e+"]").addClass("selected")}},{key:"setValue",value:function(t){e.get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"setValue",this).call(this,t),this._resetSelection(t)}}]),i}(k),m=function(){function o(r,s,a,l,c,u){var _=this;e.classCallCheck(this,o);var p="rooms-guests/desktop/ticker.dust",h=new n(v.VALUE_CHANGED);this._min=c,this._max=u,this._valueDecorator=a,a&&"function"==typeof a||(this._valueDecorator=function(e){return e}),l&&"function"==typeof l||(l=function(){return 0}),this.placeHolder=t(r),this.on=h.on.bind(h),this.off=h.off.bind(h);var d=function(e){if(e){var t=l(),o=t+e;_.setValue(o),h.emit(v.VALUE_CHANGED,o,t)}},f={topClass:s};i.render(p,f,this.placeHolder.get(0),function(){_._increase=_.placeHolder.find(".plus-circle"),_._decrease=_.placeHolder.find(".minus-circle"),_._increase.on("click",,_._decrease.on("click",,_.setValue(l())})}return e.createClass(o,[{key:"setValue",value:function(e){var t=Math.min(Math.max(this._min,e),this._max),o=this._valueDecorator(t);this.placeHolder.find(".picker-label").text(o),this._increase.toggleClass("inactive",e>=this._max),this._decrease.toggleClass("inactive",e<=this._min)}}]),o}(),C=function(t){function o(t,n,r,s,a,l,c){e.classCallCheck(this,o);var u=e.possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,t,n,r,s,a,l,c));return i.render(u._getTemplate(),u._getData(),u._placeHolder.get(0),function(){u._increase=u._placeHolder.find(".rg-ticker-plus"),u._decrease=u._placeHolder.find(".rg-ticker-minus"),u._increase.on("click",function(){return u._delta(1)}),u._decrease.on("click",,u._label=u._placeHolder.find(".rg-ticker-label"),u.setValue(u._valueProvider())}),u}return e.inherits(o,t),e.createClass(o,[{key:"_getTemplate",value:function(){return"rooms-guests/desktop/label_ticker.dust"}},{key:"_getData",value:,{key:"_delta",value:function(e){if(e){var t=this._valueProvider(),o=t+e;this.setValue(o),this.emit(v.VALUE_CHANGED,o,t)}}},{key:"setValue",value:function(t){e.get(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"setValue",this).call(this,t),this._increase.toggleClass("inactive",t>=this._max),this._decrease.toggleClass("inactive",t<=this._min)}}]),o}(y),b=function(o){function i(t,o,n,r,s,a,l){return e.classCallCheck(this,i),e.possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t,o,r,s,a,l))}return e.inherits(i,o),e.createClass(i,[{key:"_getTemplate",value:,{key:"_getData",value:function(){return t.extend(e.get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"_getData",this).call(this),{icon:this._options.icon,label:this._options.label})}}]),i}(C),D=function(e){var t=r.retrieve(e);return function(e){return t&&t.length>e&&e>=0?t[e]:""}};return{DropDownPicker:k,CheckmarkDropdownPicker:g,Ticker:m,CountTicker:b,createStoreValuesDecorator:D,EVENTS:v}});
require(["ta/prwidgets"],function(e){var r=e.define.bind(e,"ibex_trip_search_rooms_guests","pickers",["handlers","pickers"]);r(["lib/jquery-amd","ta/Core/TA.Store","hotels/RoomsGuests","hotels/RoomsGuestsUI","mixins/Events","common/trackingStreams"],function(e,r,t,n,o,i){function c(c,s){function a(){function o(e){return"string"==typeof e&&(e=parseInt(e,10),isNaN(e))?m:e<0?m:0===e?"0-1":e.toString()}unction s(s){var a=e("<span/>",{"class":"age-picker"});S.append(a);var l=new n.DropDownPicker(a.get(0),"",o,null,0,t.CONSTANTS.MAX_CHILD_AGE,{titleClass:"age-of-child",flexWidth:!0});p.push(l),a.css("order",s),l.on(n.EVENTS.VALUE_CHANGED,function(e){i.trackEvent("childrenpicker","click","age",e),C.updateChildAge(s,e),V.emit("roomInfoChanged")}),l.on(n.EVENTS.WILL_OPEN,c);var d=r.retrieve("rgPicker.nAgeOfChildIndex"),g=d&&d.length>s+1?d[s+1]:"";l.setTitle(g)}function a(e,r){S.toggleClass("hidden",0===e.length);for(var t=0;t<e.length;++t)p.length<=t&&s(t),p[t].setValue(e[t]),e[t]>=0?p[t].toggleError(!1):r&&p[t].toggleError(!0);for(;p.length>e.length;)p.pop().destroy(!0)}return{createAgePickersWithAges:a}}function l(){for(var e=C.get().childrenAges,r=!1,t=0;t<e.length;++t)e[t]<0?(r=!0,p[t].toggleError(!0)):p[t].toggleError(!1);return V.emit("markErrors",r),!r}function d(e){E.setValue(e)}unction u(e){a().createAgePickersWithAges(e),k.setValue(e.length);for(var r=!1,t=0;t<e.length;++t)e[t]<0&&(r=!0);r||V.emit("markErrors",r)}function h(){var e=C.get();E.setValue(e.nRooms),N.setValue(e.nAdults),k&&(k.setValue(e.childrenAges.length),a().createAgePickersWithAges(e.childrenAges))}function f(){l()&&V.emit("submit",!1)}function A(){S=e(".ages-wrap",T);var r=T.find(".childrenPlaceholder"),o=r.length>0;E=new n.Ticker(T.find(".roomsPlaceholder"),"rooms-picker",n.createStoreValuesDecorator("rgPicker.nRooms"),function(){return C.get().nRooms},t.CONSTANTS.MIN_ROOMS,t.CONSTANTS.MAX_ROOMS),E.on(n.EVENTS.VALUE_CHANGED,function(e,r){i.trackEvent("roompicker","click",e>r?"add":"subtract",e),C.update({nRooms:e}),V.emit("roomInfoChanged")}),N=new n.Ticker(T.find(".adultsPlaceholder"),"adults-picker",n.createStoreValuesDecorator(o?"rgPicker.nAdults":"rgPicker.nGuests"),t.CONSTANTS.MIN_ADULTS,t.CONSTANTS.MAX_ADULTS),N.on(n.EVENTS.VALUE_CHANGED,function(e,r){i.trackEvent("adultpicker","click",e>r?"add":"subtract",e),C.update({nAdults:e}),V.emit("roomInfoChanged")}),o&&(m=T.find(".age-translated").text(),k=new n.Ticker(T.find(".childrenPlaceholder"),"children-picker",n.createStoreValuesDecorator("rgPicker.nChildren"),t.CONSTANTS.MIN_CHILDREN,t.CONSTANTS.MAX_CHILDREN),k.on(n.EVENTS.VALUE_CHANGED,function(e,r){i.trackEvent("childrenpicker","click",e>r?"add":"subtract",e),C.update({nChildren:e}),V.emit("roomInfoChanged"),k.setValue(C.get().childrenAges.length)})),C.on(t.EVENTS.ROOMS_CHANGED,d),C.on(t.EVENTS.ADULTS_CHANGED,g),C.on(t.EVENTS.CHILDREN_CHANGED,u),T.find(".btn_close").on("click",f)}var E,N,k,S,m,C=c,T=s,p=[],V=new o("markErrors","hide");this.on=V.on.bind(V),this.off=V.off.bind(V),A(),this.verifyAgesOfChildren=l,this.setInitialState=h}return c})});
require(["ta/prwidgets"],function(e){var n=e.define.bind(e,"ibex_trip_search_rooms_guests","handlers",["handlers","pickers"]);n(["widget","lib/jquery-amd","common/trackingStreams","ta/Core/TA.Event","ta/Core/TA.Store","ta/page","common/Radio","hotels/RoomsGuests","overlays/Overlay","overlays/styles/popover","overlays/position","overlays/options/closeOnDocClick","overlays/options/closeOnLegacyOverlay","overlays/options/repositionOnEvent","overlays/options/autoReposition","overlays/options/highlightElement","overlays/options/centerArrowOnSrcElement","overlays/options/blurSourceOnHide","ta/util/LegacyDateShim","pickers"],function(e,n,t,o,r,i,s,a,l,c,u,d,v,f,g,_,p,h,m,k){"use strict";function E(e){e===!0?j.removeClass("disabled"):j.addClass("disabled")}function y(e){e!==K.get(0)&&(q.fromStore(),S(!1))}function C(){for(var e=K.parent(),n=0;n<4;++n){var t=e.find(".update_results_button");if(t)return t;e=e.parent()}return null}function S(e){U&&U.setInitialState(),R(),D(),e&&q.updateStore()}function b(e){D(e),x()}unction A(e){R(void 0,e),x()}unction O(){r.store("guests_rooms_picker.enabled",!0),F=K.find(".traveler_info_container");var e=K.find(".initial-values-holder");q=new a({initialValuesHolder:e.get(0)}),q.on(a.EVENTS.ROOMS_CHANGED,b),q.on(a.EVENTS.ADULTS_CHANGED,w),q.on(a.EVENTS.CHILDREN_CHANGED,A),j=C(),N(),q.hasStoreValues()?y():S(!0)}nction D(e){var t=e||q.get().nRooms,o=r.retrieve("rgPicker.nRooms"),i=o&&o.length>t?o[t]:"";n(".traveler_info_numeric .room-info").text(t),n(".traveler_info_text .room-info").text(i),n(".rooms-picker .picker-label:visible").text(i)}function R(e,t){var o=q.get(),i=e||o.nAdults,s=(t||o.childrenAges).length,a=i+s;n(".traveler_info_numeric .guest-info").text(a);var l=K.find(".traveler_info_text .guest-info");if(l.length){var c=r.retrieve("rgPicker.nGuests"),u=c&&c.length>a?c[a]:"";l.text(u)}else{var d=r.retrieve("rgPicker.nAdults"),v=d&&d.length>i?d[i]:"",f=r.retrieve("rgPicker.nChildren"),g=f&&f.length>s?f[s]:"";K.find(".traveler_info_text .adult-info").text(v),K.find(".traveler_info_text .child-info").text(g)}}function G(){R(),D();var e=q.updateStore();e&&(o.fireEvent("onLegacyGuestsChanged",e),m.justUpdateSessionDates())}function I(e){U&&!U.verifyAgesOfChildren()?M.show():(G(),J&&(L(),o.fireEvent("searchFieldsChanged",K.get(0))),J=!1,H(e&&"close"===e.trigger?"close":"dismiss"))}function H(e){t.trackEvent("roomguestpicker_module","click",e);var n=q.get()||{},o=n.nRooms||0,r=n.nAdults||0,i=n.childrenAges?n.childrenAges.length:0,s="room="+o+",adult="+r+",children="+i;t.trackEvent("roomguestpicker_module","final_selection",s)}function L(){j.length?j.is(":hidden")&&s("search").emit("submit"):i.processNewTravelInfo&&i.processNewTravelInfo(K.get(0))}function V(){M.hide("close")}function P(){var e;if(M&&n.contains(document,M.sourceElement))e=M.isOpen();else{var o=K.find(".popup_content"),r=K.find(".traveler_info_container").get(0),i="rooms_guests_children no_x no_padding";i+=K.parents(".responsive_inline").length?" responsive_inline":"";var s=[c(r,"below",i,"",o.get(0)),u.below([],!1,!1,[16]),p(r),d.withoutTouchEvents,v,f(window,["date_bar_docked","date_bar_undocked"]),g,_,h];M=new l(r,s),M.on("hide",I);var a=n(".pickers",M.contentElement);a.removeClass("hidden"),U=new k(q,a),U.on("submit",V),U.on("roomInfoChanged",G),U.on("markErrors",,U.setInitialState(),e=!1}if(!e){var m=K.parents(".persistent_trip_search_fixed").length?1:0;t.trackEvent("roomguestpicker_module","click","manual",m),M.show(),t.trackEvent("roomguestpicker_module","in_view")}}var j,q,F,M,U,K=n(e.element),z=!0,B=!1,J=!1,Q="",W=r.retrieve("tracking.impression.key"),X=r.retrieve("page.location");W&&(Q="IK:"+W),X&&(Q+="/L:"+X);var Y=K.find(".ui_picker .traveler_info_container");Y.on("focus",function(){T(),P()}),K.on("click",,O(),s("search").on("loading",.reply("is-valid",function(){return B||(z=U?U.verifyAgesOfChildren():!q.hasMissingChildrenAges()),z||t.trackEvent("GuestSelector-tripsearch","age_validation_error",Q,"1",!1),z})})});
require(["ta/prwidgets"],function(n){var e=n.define.bind(n,"common_progress_bar","handlers",["handlers"]);e(["widget","lib/jquery-amd","ta/page","ta/Core/TA.Event"],function(n,e,o,a){"use strict";function i(){t.removeClass("loading"),setTimeout(0)}function r(){t.removeClass("loading")}var t=e(".progress_bar",n.element);return o.on("newPageTravelInfo",i),a.on("page-polling-complete",r),a.on("page-repoll-failed",r),{}})});
define("utils/ResponsiveEvents",["mixins/Events","utils/responsive","utils/throttle","vanillajs"],function(n,e,t){"use strict";function r(n,e,t){var r=n.filter(function(n){return e.indexOf(n)<0}),i=e.filter(;return t?r.reverse().concat(i.reverse()):r.concat(i)}function i(){var n=document.body.clientWidth;if(n!=o){var t=n>o,i=e.currentBreakpoints(),f=r(u,i,t);f.forEach(function(n){var e=t?"over-":"under-";c.emit(e+n)}),f.length&&c.emit("breakpoint",i[0]),u=i,o=n}}var o=document.documentElement.clientWidth,u=e.currentBreakpoints(),f=["breakpoint"];e.breakpoints.forEach(function(n){f.push("over-"+n,"under-"+n)});var c=n.create(f);return c.onOver=function(n,e){c.on("over-"+n,e)},c.onUnder=function(n,e){c.on("under-"+n,e)},c.offOver=function(n,e){c.off("over-"+n,e)},c.offUnder=window.addEventListener("resize",t(i,100)),c});
define("hotels/HotelsRadioHelper",["babel/babel-helpers","utils/objutils"],function(e,l){var s={ELEMENT:"hotels_radio_channel_element"},t={PERSISTENT_OFFSET:"persistent_header_height"},n={channels:s,elementMessages:t};return l.deepFreezeCopy(n)});
require(["ta/p13n/placements"],function(e){var t=e.define.bind(e,"trip_search","handlers",["handlers"]);t(["placement","api-mod","lib/jquery-amd","utils/throttle","ta/Core/TA.Event","ta/Core/TA.Store","common/trackingStreams","common/Radio","utils/responsive","utils/ResponsiveEvents","hotels/HotelsRadioHelper"],function(e,t,s,i,n,o,r,a,d,l,c){function f(){function e(){m.css("height",C.height()||""),s(window).on("resize",l),C.addClass("fixed persistent_trip_search_fixed"),p(),t.fireEvent(window,"date_bar_undocked"),n.fireEvent("scrollingTabs_updateTabBar",{"height":C.height()})}function o(){m.css("height",""),s(window).off("resize",l),C.removeClass("fixed persistent_trip_search_fixed"),p(),t.fireEvent(window,"date_bar_docked")}if(C){var r=s(window).scrollTop(),a=t.find(".date_picker_modal",w),l=i(function(){m&&C&&C.hasClass("fixed")&&m.css("height",C.height()||"")},100);d.mobile()?C.hasClass("fixed")&&o():!C.hasClass("fixed")&&h(a,r)?e():C.hasClass("fixed")&&_(a,r)&&o()}}function h(e,t){return e?t>e.offset().top:t>m.offset().top}function _(e,t){return e?t<=e.offset().top:t<=m.offset().top}unction p(){g()}function g(){setTimeout(function(){if(w){var e=s(".change_dates_text",w);e&&(e.removeAttr("style"),e.addClass("autoResize"),t.fireEvent("refreshedDOMContent",w))}},1)}unction E(){var i=s("#h"),n=s("#"+e.id);t.toggleClass(n,"hidden",!t.hasClass(i,"selected"))}var m=s("#"+e.id),w=s(".datepicker_box",m),T=s(".title",m),b=s("#UPDATE_RESULTS",m),C=s("#PERSISTENT_TRIP_SEARCH_BAR",m);return u(),n.on("hotels.sessionDatesUpdated",u),n.on("show_hide_tripsearch",E),m.find(".traveler_info_container").length&&o.store("guests_rooms_picker.enabled",!0),s(window).one("date_bar_undocked",,s(window).on("scroll",i(f,100)),l.onUnder("tablet",f),l.onOver("tablet",f),n.queueForLoad(f),a(c.channels.ELEMENT).reply(c.elementMessages.PERSISTENT_OFFSET,function(){return C.length&&!d.mobile()?C.height():0}),T&&o.store("hotels_left_filters_redesign_searching_text",T.outerHTML+'<div class="content">'+o.retrieve("hotels_left_filters_redesign_searching_text")+"</div>"),{clearDates:v}})});
require(["ta/p13n/placements"],function(a){var r=a.define.bind(a,"attraction_promo_header","handlers",["handlers"]);r(["placement","ta","lib/jquery-amd"],function(a,r,e){var t=function(a){return e(".attraction_promo_header").find(".ui_modal_card").addClass("is-active"),r.trackEventOnPage("attraction_promo_click","terms","",a,!1),!1},n=function(a){return e(".attraction_promo_header").find(".ui_modal_card").removeClass("is-active"),!1};return{showPromoTermsDialog:t,hidePromoTermsDialog:n}})});
require(["ta/p13n/placements"],function(e){var r=e.define.bind(e,"homepage_hero","handlers",["handlers"]);r(["placement"],function(e){"use strict";function r(e,r,t){require(["trjs!ta/Core/TA.Record"],function(n){n.setEvtCookie(window.pageServlet,e,r,0,t)})}var t=document.getElementById(e.id),n=t.querySelector("[data-hero-overlay]");return n&&t.classList.add("heroWithOverlay"),{clicked:r}})});
define("shelves/shelfEventHandlers",["lib/jquery-amd","ta","ta/util/Element","utils/urlDecoder"],function(n,e,t,i){"use strict";function l(n){var t=n.getAttribute("data-tpp"),i=n.getAttribute("data-tpact")||"shelf_in_view",l=n.getAttribute("data-tpatt"),c=n.getAttribute("data-tpid");e.trackEventOnPage(t,i,l,c)}function c(){var e=n(".shelf_title");e&&e.each(function(n){var i=e[n];I.indexOf(i)===-1&&t.isScrolledIntoView(i)&&(l(i),I.push(i))})}unction o(n,e){e?window.location=i.getUrl(n):window.open(i.getUrl(n),"_blank")}function r(n,t){e.SHELF_EVENT_INITIALIZED||(e.SHELF_EVENT_INITIALIZED={}),e.SHELF_EVENT_INITIALIZED[n]||(t(),e.SHELF_EVENT_INITIALIZED[n]=!0)}unction f(){r("scrollEvent",}function s(){r("seeAllTracking",function(){e.on("track_shelf_see_all_click_event",function(n,e){l(e)})})}function E(){r("seeAllItemTracking",function(){e.on("track_shelf_item_click_event",})}function _(n){r("seeAllEventHandlers",function(){e.on("shelf_see_all_click_event",function(e,t,i,c){new Event(e).preventDefault(),c||l(t),n?n(e,t):o(t,i)})})}function v(n){r("seeAnItemEventHandlers",function(){e.on("shelf_item_click_event",function(e,t,i,c){new Event(e).preventDefault(),n?n(e,t):o(t,i),c||l(t)})})}var I=[];return{initShelfListeners:u,initSeeAllTracking:s,initSeeAnItemTracking:E,initSeeAllEventHandlers:_,initSeeAnItemEventHandlers:v,initScrollEvent:f}});
require(["ta/p13n/placements"],function(e){var n=e.define.bind(e,"homepage_shelves","handlers",["handlers"]);n(["placement","ta/Core/TA.Event","ta/Core/TA.Store","ta/Core/TA.Record","lib/jquery-amd","shelves/shelfEventHandlers"],function(e,n,i,t,d,o){function a(){if(window.removeEventListener("resize",r),d(window).width()>=760){var e=d(l);if(e.length){var i={elemIds:[],isNewContext:!0};e.each(,n.fireEvent("ads.queueForInjection",i),w=!0}}window.addEventListener("resize",r)}function r(){!w&&d(window).width()>=760&&a();var e=d(l).parent();d(window).width()>=760&&e.hasClass("hidden")&&(e.removeClass("hidden inactive"),n.fireEvent("homePageBannerRefresh")),e.toggleClass("hidden inactive",d(window).width()<760)}function s(){window.googletag&&googletag.apiReady?a():(window.googletag=window.googletag||{cmd:[]},googletag.cmd.push(a))}var l="#"+e.id+" .gptAd",w=!1;o.initSeeAllEventHandlers(),o.initSeeAllTracking(),s()})});
require(["ta/p13n/placements"],function(e){var a=e.define.bind(e,"popular_cuisines","handlers",["handlers"]);a(["placement","lib/jquery-amd"],function(e,a){function n(e){var n=a(e),s=n.find(".ui_icon");s.is(":hidden")||(s.hasClass("caret-down")?(s.removeClass("caret-down").addClass("caret-up"),n.addClass("expanded"),n.nextUntil(".sectionTitle").addClass("expanded")):s.hasClass("caret-up")&&(s.removeClass("caret-up").addClass("caret-down"),n.removeClass("expanded"),n.nextUntil(".sectionTitle").removeClass("expanded")))}return{toggleCollapsible:n}})});
require(["ta/p13n/placements"],function(e){var a=e.define.bind(e,"popular_destinations","handlers",["handlers"]);a(["placement","lib/jquery-amd"],function(e,a){"use strict";function n(e,n){var s=a(e),d=s.find(".ui_icon");d.is(":hidden")||(d.hasClass("caret-down")?(d.removeClass("caret-down").addClass("caret-up"),s.addClass("expanded"),n?s.parent().find(".item").addClass("expanded"):s.nextUntil(".sectionTitle").addClass("expanded")):d.hasClass("caret-up")&&(d.removeClass("caret-up").addClass("caret-down"),s.removeClass("expanded"),n?s.parent().find(".item").removeClass("expanded"):s.nextUntil(".sectionTitle").removeClass("expanded")))}eturn{toggleCollapsible:n,toggleMore:s}})});
require(["ta/p13n/placements"],function(e){var a=e.define.bind(e,"popular_hotels","handlers",["handlers"]);a(["placement","lib/jquery-amd"],function(e,a){function n(e){var n=a(e),s=n.find(".ui_icon");s.is(":hidden")||(s.hasClass("caret-down")?(s.removeClass("caret-down").addClass("caret-up"),n.addClass("expanded"),n.nextUntil(".sectionTitle").addClass("expanded")):s.hasClass("caret-up")&&(s.removeClass("caret-up").addClass("caret-down"),n.removeClass("expanded"),n.nextUntil(".sectionTitle").removeClass("expanded")))}return{toggleCollapsible:n}})});
require(["ta/p13n/placements"],function(e){var a=e.define.bind(e,"popular_vacation_packages","handlers",["handlers"]);a(["placement","lib/jquery-amd"],function(e,a){function n(e){var n=a(e),s=n.find(".ui_icon");s.is(":hidden")||(s.hasClass("caret-down")?(s.removeClass("caret-down").addClass("caret-up"),n.addClass("expanded"),n.nextUntil(".sectionTitle").addClass("expanded")):s.hasClass("caret-up")&&(s.removeClass("caret-up").addClass("caret-down"),n.removeClass("expanded"),n.nextUntil(".sectionTitle").removeClass("expanded")))}return{toggleCollapsible:n}})});
require(["ta/p13n/placements"],function(e){var a=e.define.bind(e,"popular_vacation_rentals","handlers",["handlers"]);a(["placement","lib/jquery-amd","ta/Core/TA.Record"],function(e,a,n){function s(e){var n=a(e),s=n.find(".ui_icon");s.is(":hidden")||(s.hasClass("caret-down")?(s.removeClass("caret-down").addClass("caret-up"),n.addClass("expanded"),n.nextUntil(".sectionTitle").addClass("expanded")):s.hasClass("caret-up")&&(s.removeClass("caret-up").addClass("caret-down"),n.removeClass("expanded"),n.nextUntil(".sectionTitle").removeClass("expanded")))}return{toggleCollapsible:s,trackCityClick:n.trackEventOnPage}})});
require(["ta/p13n/placements"],function(t){var e=t.define.bind(t,"top_restaurants_near","handlers",["handlers"]);e(["placement","ta","ta/Core/TA.Event","ta/Core/TA.Record"],function(t,e,r,a){function n(t){return t&&t.getAttribute&&!!t.getAttribute("data-tpp")}function i(t){return n(t)?{"property":t.getAttribute("data-tpp"),"action":t.getAttribute("data-tpact"),"attrib":t.getAttribute("data-tpatt"),"pid":t.getAttribute("data-tpid")}:null}function p(t,e){var r=i(e);r&&e.href&&a.setEvtCookie(r.property,r.action,r.attrib,r.pid,e.href)}return{trackShelfSeeAllClick:p}})});
require(["ta/p13n/placements"],function(n){var e=n.define.bind(n,"vp_lander_popular_destinations","handlers",["handlers"]);e(["placement","ta/Core/TA.Record","vanillajs"],function(n,e,a){return{trackCardClick:e.trackEventOnPage}})});
require(["ta/p13n/placements"],function(n){var e=n.define.bind(n,"vr_lander_blog_link","handlers",["handlers"]);e(["placement","ta/Core/TA.Record","vanillajs"],function(n,e,a){return{trackBlogClick:e.trackEventOnPage}})});
require(["ta/p13n/placements"],function(n){var e=n.define.bind(n,"vr_lander_popular_destinations","handlers",["handlers"]);e(["placement","ta/Core/TA.Record","vanillajs"],});
define("mobile/lite/ajax-request",["utils/json-to-url","vanillajs"],function(t){function e(t){var e=document.createElement("a");return e.href=t,e.protocol!==window.location.protocol||e.host!==window.location.hostname}return function(s,o){"object"==typeof s&&(o=s,s=o.url),o=o||{};var n=o.method||o.type||"GET",r="string"==typeof o.data?o.data:t(o.data);return new Promise(function(t,a){var i=new XMLHttpRequest;i.onreadystatechange=function(){this.readyState===XMLHttpRequest.DONE&&(200===this.status?(o.success&&o.success(this.responseText,this.status,i),t(this.responseText)):(o.error&&o.error(i,this.status,this.statusText),a(this.responseText)),o.complete&&o.complete(i,this.statusText))},"get"==n.toLowerCase()&&"string"==typeof r&&r.length>0&&(s+=("?"==r[0]?"":"?")+r,r=null),i.open(n,s,!o.synchronous),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e(s)||i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.send(r)})}});
define("utils/cookieutils",["vanillajs","mobile/lite/ajax-request"],function(t,e){"use strict";var o=n=i=function(){var t=window.location.host.match(/\.tripadvisor\..*/);return null!=t?t=t[0]:null},a=function(t,e,n){if(o(n.doNotEscape)&&n.doNotEscape||(e=encodeURIComponent(e)),e+=n.domain?"; domain="+n.domain:"; domain="+i(),n.path&&(e+="; path="+n.path),n.duration){var a=new Date;a.setTime(a.getTime()+1e3*n.duration),e+="; expires="+a.toGMTString()}n.secure&&(e+="; secure");var r="%1%";o(n.ignoreVersion)&&n.ignoreVersion&&(r=""),document.cookie=t+"="+r+e};return{addPidToCookie:function(t){o(t)&&0!==t.length&&a("NPID",t,{path:"/",duration:5,ignoreVersion:!0})},roybatty:function(){var t,o=i(),n=window.taSecureToken;if(window.taEarlyRoyBattyStatus)window.taEarlyRoyBattyStatus>1&&ta&&ta.trackEventOnPage&&ta.trackEventOnPage("early_roy_batty","confirm","",0,!0);else if(t=this.getCookie("roybatty")){var a=t.split(",");if(a&&2==a.length){var r=parseInt(a[1],10);document.setCookie("roybatty",n+","+r,{domain:o,ignoreVersion:!0,path:"/"})}}else document.setCookie("roybatty",n+",1",{domain:o,ignoreVersion:!0,path:"/"}),e({method:"POST",url:"/CookiePingback"})},getCookie:function(t){var e=document.cookie.match("(?:^|;)\\s*"+n(t)+"=([^;]*)");return e?(e=e[1],0===e.indexOf("%1%")&&(e=e.substring(3)),decodeURIComponent(e)):null},setCookieInSeconds:a}});
define("vr/shared/utility",["ta","utils/cookieutils","utils/ajax","utils/store","utils/objutils","utils/decoder"],function(e,t,o,n,d,a){"use strict";var i=r=function(t){if(!t)return t;switch(typeof t){case"object":t.puid=e.uid;break;case"string":t+="&puid="+e.uid}return t},l=function(e){var t="VR_",o=e&&e.length>=t.length&&e.substring(0,3)===t;return o?e:t+e},c=function(e,t,o){var d=r({});"/ActionRecord?action="+l(e);return d.action=l(e),"undefined"!=typeof modelGeoId&&null!=modelGeoId&&""!=modelGeoId?d.geo=modelGeoId:n.has("ftl.geoId")&&n.get("ftl.geoId")&&(d.geo=n.get("ftl.geoId")),t&&t>0&&(d.pid=t),o&&o>0?d.detail=o:"undefined"!=typeof modelLocId&&null!=modelLocId&&""!=modelLocId?d.detail=modelLocId:n.has("ftl.locId")&&n.get("ftl.locId")&&(d.detail=n.get("ftl.locId")),d},u=function(e,t,n,d){var a=c(e,t,n);o({url:"/ActionRecord",data:a,method:"GET",success:d?d:i})},s=y=function(e){if(e){var t=e.innerHTML,o=f(t);if(!o)return!1;e.innerHTML=o,e.style.display="block";var n=document.getElementById("payment-count-vehicle").dataset.content,d=n.replace(t,o);return document.getElementById("payment-count-vehicle").dataset.content=d,!0}return!1},f=function(e){var t=a.base64Decoder(e);return t.split("_")[1]};return{actionRecord:u,actionRecordWithPartner:function(e,t,o,n){var d=s(),a=""!=d&&"undefined"!=typeof d?d+"_"+e:e;u(a,t,o,n)},preventEventBubble:splitName:function(e){var t=void 0;if("string"==typeof e){var o=e.trim().split(" ");o.length>1&&(t={first:o.slice(0,o.length-1).join(" "),last:o[o.length-1]})}return t},goToUrl:function(e,o,n){e&&e.trim()&&(o&&o>0&&t.addPidToCookie(o),n?window.open(e):window.location=e)},addLocationAsReviewedInMemCachedCookie:function(e,t){var n="WAR_ADD_REVIEWED_LOCATION";o({url:"/VacationRentalsAjax",data:{"a":n,"locationId":e},method:"get",complete:t?t:i})},addPuid:r,identify:function(e,t){var o=0;return e&&e.length?d.each(e,function(e,n){if(!n.getAttribute("id")){do{o++;var d=t+"_"+o}while(null!=document.getElementById(d));n.setAttribute("id",d)}}):e},allowIfNumber:function(){var e={backspace:8,tab:9,pageDown:34,downArrow:40,deleteKey:46,slash:47,colon:58,aKey:65,cKey:67,vKey:86,xKey:88,sleep:95,numPadStar:106};return function(t){e.slash<t.keyCode&&t.keyCode<e.colon&&!t.shiftKey&&!t.altKey||e.sleep<t.keyCode&&t.keyCode<e.numPadStar||t.keyCode==e.backspace||t.keyCode==e.tab||t.keyCode>e.pageDown&&t.keyCode<e.downArrow||t.keyCode==e.aKey&&t.metaKey||t.keyCode==e.cKey&&t.metaKey||t.keyCode==e.vKey&&t.metaKey||t.keyCode==e.xKey&&t.metaKey||t.keyCode==e.deleteKey||t.preventDefault()}}(),unobfuscatePaymentCount:y}});
require(["ta/p13n/placements"],function(e){var t=e.define.bind(e,"vr_list_your_property","handlers",["handlers"]);t(["placement","api-mod","vr/shared/utility","ta/Core/TA.Record","vanillajs"],function(e,t,n,r,i){var a=t.find(".get_listed_button_container"),o=t.retrieve(a,"url");return t.addEvent(a,"click",function(){n.actionRecord("GetListed_Lander","","",n.goToUrl(o))}),{trackListingButtonClick:r.trackEventOnPage}})});
require(['ta/rollupAmdShim'], function(rollupAmdShim) {rollupAmdShim.install(["babel/babel-helpers","lib/jquery-amd","photoviewer/models/eventTypes","photoviewer/radioHelper","photoviewer/tracking","mobile/lite/image-loader","utils/throttle","utils/ajax","ta/prwidgets","api-mod","ta/util/I18N","common/trackingStreams","utils/urlutils","hotels/tracking/timing","utils/responsive","ta/common/Swipe","common/Radio","photoviewer/loader","utils/browserutils","ta/Core/TA.FireEvent","utils/ResponsiveEvents","responsive/text-resizer","ta/Core/TA.Event","ta/common/Repoll","ta/Core/TA.Store","common/EventBus","utils/safeCall"],["page-model","page-model","ta","ta","page-model"]);});
if(window.requirejs && requirejs.taConfig)requirejs.taConfig({"deferred":{},"name":"build/concat/apg-HomeRebranded","files":{"js-amd":{"lib":{"babel":{"babel-helpers":1}},"src":{"common":{"trackingStreams":1},"utils":{"urlutils":1,"throttle":1,"browserutils":1,"responsive":1,"ResponsiveEvents":1,"ajax":1},"api-mod":1,"mobile":{"lite":{"image-loader":1}}}},"js3":{"lib":{"jquery-amd":1},"build":{"es6":{"src":{"common":{"Radio":1,"EventBus":1},"hotels":{"tracking":{"timing":1}},"utils":{"safeCall":1},"responsive":{"text-resizer":1},"photoviewer":{"models":{"eventTypes":1},"loader":1,"radioHelper":1,"tracking":1}}}},"src":{"ta":{"common":{"Repoll":1,"Swipe":1},"util":{"I18N":1},"prwidgets":1,"Core":{"TA.FireEvent":1,"TA.Event":1,"TA.Store":1}}}}},"_":{"baseUrl":"/"}});
define("photoviewer/models/eventTypes",["babel/babel-helpers","utils/objutils"],function(e,E){"use strict";var C={GRID_SCROLLED:"gridViewScrolled",HERO_THUMBS_REQUESTED:"heroThumbsRequested",ADVANCE_HERO_CLICKED:"advanceHeroClicked",HERO_FOCUS_CHANGED:"heroFocusChanged",HERO_UPDATED:"heroUpdated",HERO_CLICKED:"heroClicked",HELPFUL_VOTE_CHANGE:"updateHelpfulVote",CATEGORY_CHANGE:"categoryChange",MEDIA_FILTER_CHANGE:"mediaFilterChange",HERO_PHOTO_CHANGE:"heroPhotoChange",ALBUM_CHANGE:"albumChange",TYPE_CHANGE:"typeChange",BACK_TO_GALLERY:"backToGallery",AUTOPLAY_TOGGLE:"autoPlayToggle",RHR_CLICKED:"rhrClicked",CANCEL_AUTO_PLAY:"cancelAutoPlay",AUTO_PLAY_NEXT:"autoPlayNext",NAV_KEY_PRESSED:"navKeyPressed"},_=C;return E.deepFreezeCopy(_)});
define("photoviewer/radioHelper",["babel/babel-helpers","lib/jquery-amd","common/Radio"],function(e,o,n){"use strict";function t(e,t,i,r){function u(t){return!!o(e).closest("#"+t)&&(f=n(t),!0)}function c(){n("responsive-photoviewer").off("content-loaded",d),"function"==typeof r&&r()}function d(n){return i&&!o.contains(document,o(e).get(0))?void setTimeout(c,0):void(u(n)&&"function"==typeof t&&t(n))}var f=void 0;return n("responsive-photoviewer").on("content-loaded",d),{getRadio:getOrInitRadio:function(e){return f||d(e),f}}}return t});
define("photoviewer/tracking",["babel/babel-helpers","common/trackingStreams","ta/Core/TA.FireEvent","lib/jquery-amd","utils/responsive","utils/throttle","page-model"],function(i,e,t,o,n,r,c){"use strict";unction d(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";_(i)&&e.trackEvent(S,i,t,W)}function a(i){e.trackEvent(S,i,"",W)}function _(i){var e=void 0;if(i.includes("grid_view"))e=Q;else{if(!i.includes("detail_view"))return!1;e=M}return o(J).hasClass(e)}function v(){Z=o(window).height(),Y=o(window).width(),o(window).off("resize",$).on("resize",$)}unction w(){n.desktop()&&t.fireEvent("galNavClick"),l(S,D,null)}function k(){l(S,P,null,W)}function s(){l(S,H,null,W)}unction p(i){l(S,i,L,W)}unction g(){l(S,R,null,W)}function m(){l(S,F,null,W)}function b(){n.desktop()&&l(S,G,null,W)}nction y(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;l(S,V,i+"|"+e+"|"+t+"|"+o),1===o&&i!==n&&l(S,x,i+"|"+e+"|"+t+"|"+o)}function A(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";l(S,N,i+"|"+e+"|"+o+"|"+r),n.desktop()&&t.fireEvent("galThumbClick")}function E(i,e,t){var n=o(e).closest(J).hasClass(M),r=o(e).hasClass(K),c=n?"detail":"grid",d=r?"dropdown_open":"dropdown_select";l(S,""+c+U[t],d+"_"+i)}function z(i,e,t,o){l(S,O,i+"|"+e+"|"+t+"|"+o)}var S="photoviewer",D="detail_view_image_arrow_click",P="detail_view_gallery_click",R="detail_view_caption_review_click",F="detail_view_caption_attribution_url_click",G="detail_view_desktop_image_click",H="detail_view_photostrip_arrow_click",I="detail_view_image_swipe_click",V="grid_view_thumbnail_click",x="grid_view_property_video_thumbnail_click",N="detail_view_photostrip_tile_click",O="helpful_vote_click",j="_view_album_click",q="_view_type_click",B="_view_category_click",L="dropdown_abandoned",U={"album":j,"type":q,"category":B},J=".photoviewerContainer",K="tabs_item",M="hero",Q="grid",W=c.LOC_ID,X=1e3,Y=void 0,Z=void 0,$=r(function(){setTimeout(function(){var i=o(window).width(),t=o(window).height();i===Y&&t===Z||(e.trackEvent("screenSizeRecord","resize","s"+Y+"x"+Z+"b"+i+"x"+t,""),Y=i,Z=t)},X)},X);return{attachResizeTracker:v,detachResizeTracker:u,trackPhotoViewerEvent:l,trackPhotoViewerImpression:d,trackSimpleAction:a,recordBackToGalleryClick:k,recordCaptionReviewClick:g,recordCaptionAttributionUrlClick:m,recordPhotoStripArrowClick:s,recordGridDropdownAbandonment:p,recordAlbumDropdownAbandonment:f,recordHeroClickOnDesktop:b,recordNavArrowVisibilityChange:h,recordArrowClick:w,recordPhotoSwipe:C,recordFilmstripThumbClick:T,recordGridTileClick:y,recordHeroThumbClick:A,recordFilterItemClick:E,recordHelpfulClick:z}});
require(["ta/p13n/placements"],function(a){var e=a.define.bind(a,"pv_resp_content_grid","handlers",["handlers"]);e(["babel/babel-helpers","placement","lib/jquery-amd","photoviewer/models/eventTypes","photoviewer/radioHelper","photoviewer/tracking","mobile/lite/image-loader","utils/throttle"],function(a,e,t,r,i,o,d,n){"use strict";function l(a,e){var r=t(a),i=r.attr("data-updateComponent"),o=r.find(".albumGridItem"),d=_.find("[data-updateComponent="+i+"]");if(e===G){var n=t(".albumGridItem",_).first(),l=t(".photoGridWrapper",_),p=n.offset().top;n.before(o);var f=n.offset().top,g=Math.abs(p-f)>1;if(g){var m=f-p;l.scrollTop(m)}y=!1}else t(".albumGridItem",_).last().after(o),O=!1;d.replaceWith(r),s()}function p(a,e){var i=t(e),o=t(".photoGridBox",_);T=i.data("mediaid"),B=i.data("mediatype"),x=o.data("albumid");var d=o.data("aggregationid");M=o.data("filter");var n=i.attr("data-panoid");V=i.data("storyboardid"),R.getRadio().trigger(r.HERO_PHOTO_CHANGE,{albumViewMode:"hero",aggregationId:d,albumid:x,ff:T,filter:M,panoId:n})}function f(a,e){p(a,e),a&&"click"===a.type&&o.recordGridTileClick(T,x,M,B,V)}function g(a){var i=t(".loadMore"+a,_);if(!i.length)return!1;var o=t(".photoGridBox",_);x=o.data("albumid");var d=o.data("aggregationid");M=o.data("filter");var n=i.data("offset"),l={albumViewMode:"imageThumbs",aggregationId:d,albumid:x,filter:M,albumPartialsToUpdate:"partial",offset:n,loadDirection:a};return a===G?(y=!0,l.cnt=parseInt(i.attr("data-firstOffset"))-n):O=!0,R.getRadio().trigger(r.GRID_SCROLLED,l,"update-"+e.name+"-more"+a,a),!0}function s(){d.demandLoadImages(_.get(0))}function m(a,e,r){var i=t(e),o=t(r);if(o.length){o.find(".ui_spinner").remove();var d=t(".fillSquare",o);if(d&&d.length){var n=i.width()/i.height()>d.width()/d.height();d.toggleClass("landscape",n)}t(".videoOverlay",o).removeClass("hidden"),t(".panoOverlay",o).removeClass("hidden")}}function h(){var a=t(".photoGridWrapper",_),e=a.scrollTop();e+a.height()+b>=t(".photoGridBox",_)[0].scrollHeight&&!O&&g(w)&&R.getRadio().trigger("force-ad-refresh"),e<b&&!y&&g(G)&&R.getRadio().trigger("force-ad-refresh")}function v(){u(),_=t("#"+e.id),C=R.getRadio(),C.on(I,l);var a=t(".loadMoreUpward",_);if(a.length){var r=parseInt(a.attr("data-initialMediaId"));if(!isNaN(r)){var i=t("[data-mediaid="+r+"]",_),o=i.length&&i.get(0);o.scrollIntoView&&o.scrollIntoView()}}t(".photoGridWrapper, .photoGridBox",_).on("scroll",n(function(){s(),h()},100)),s(),h(),c()}function u(){C&&C.off(I,l),_&&t(".photoGridWrapper, .photoGridBox",_).off("scroll")}function c(){var a=_.find(".photoGridBox"),e=a.attr("data-aggregationid"),t=a.attr("data-albumid"),r=a.attr("data-filter"),i=a.find(".albumGridItem").length;o.trackPhotoViewerImpression("grid_view",t+"|"+e+"|"+r),i&&o.trackPhotoViewerImpression("grid_view_photos_seen",i)}var b=200,w="Downward",G="Upward",I="update-"+e.name+"-moreDownward update-"+e.name+"-moreUpward",_=void 0,C=void 0,R=i("#"+e.id,v),y=!1,O=!1,T=void 0,x=void 0,B=void 0,M=void 0,V=void 0;return{afterImgLoad:m,onGridItemSelected:f}})});
require(["ta/p13n/placements"],function(e){var a=e.define.bind(e,"pv_resp_content_grid_zepto","handlers",["handlers"]);a(["babel/babel-helpers","placement","lib/jquery-amd","photoviewer/models/eventTypes","photoviewer/radioHelper","photoviewer/tracking","mobile/lite/image-loader","utils/throttle"],function(e,a,t,r,i,o,d,n){"use strict";function l(e,a){var r=t(e),i=r.attr("data-updateComponent"),o=r.find(".albumGridItem"),d=G.find("[data-updateComponent="+i+"]");if(a===w){var n=t(".albumGridItem",G).first(),l=t(".photoGridWrapper",G),p=n.offset().top-l.scrollTop();n.before(o),n.offset().top!==p&&l.scrollTop(n.offset().top-p),T=!1}else t(".albumGridItem",G).last().after(o),R=!1;d.replaceWith(r),s()}function p(e,a){var i=t(a),o=t(".photoGridBox",G);C=i.data("mediaid"),k=i.data("mediatype"),V=o.data("albumid");var d=o.data("aggregationid");D=o.data("filter");var n=i.attr("data-panoid");_.getRadio().trigger(r.HERO_PHOTO_CHANGE,{albumViewMode:"hero",aggregationId:d,albumid:V,ff:C,filter:D,panoId:n})}function f(e,a){p(e,a),e&&"click"===e.type&&o.recordGridTileClick(C,V,D,k)}function g(e){var i=t(".loadMore"+e,G);if(i.length){var o=t(".photoGridBox",G);V=o.data("albumid");var d=o.data("aggregationid");D=o.data("filter");var n=i.data("offset"),l={albumViewMode:"imageThumbs",aggregationId:d,albumid:V,filter:D,albumPartialsToUpdate:"partial",offset:n,loadDirection:e};e===w?(T=!0,l.cnt=parseInt(i.attr("data-firstOffset"))-n):R=!0,_.getRadio().trigger(r.GRID_SCROLLED,l,"update-"+a.name+"-more"+e,e)}}unction m(e,a,r){var i=t(a),o=t(r);if(o.length){o.find(".ui_spinner").remove();var d=i.width()/i.height()>o.width()/o.height();o.toggleClass("landscape",d)}}function c(){var e=t(".photoGridWrapper",G);e.scrollTop()+e.height()+v>=e.get(0).scrollHeight&&!R&&(g(b),_.getRadio().trigger("force-ad-refresh")),e.scrollTop()<v&&!T&&(g(w),_.getRadio().trigger("force-ad-refresh"))}function h(){_.getRadio().off(I,l).on(I,l),G=t("#"+a.id);var e=t(".loadMoreUpward",G);if(e.length){var r=parseInt(e.attr("data-initialMediaId"));if(!isNaN(r)){var i=t("[data-mediaid="+r+"]",G),o=i.length&&i.get(0);o.scrollIntoView&&o.scrollIntoView()}}t(".photoGridWrapper, .photoGridBox",G).off("scroll").on("scroll",n(100)),s(),u()}function u(){var e=G.find(".photoGridBox"),a=e.attr("data-aggregationid"),t=e.attr("data-albumid"),r=e.attr("data-filter"),i=e.find(".albumGridItem").length;o.trackPhotoViewerImpression("grid_view",t+"|"+a+"|"+r),i&&o.trackPhotoViewerImpression("grid_view_photos_seen",i)}var v=200,b="Downward",w="Upward",I="update-"+a.name+"-moreDownward update-"+a.name+"-moreUpward",G=void 0,_=i("#"+a.id,h),T=!1,R=!1,C=void 0,V=void 0,k=void 0,D=void 0;return{afterImgLoad:m,onGridItemSelected:f}})});
require(["ta/p13n/placements"],function(t){var e=t.define.bind(t,"pv_resp_content_hero","thumbsScroller",["handlers","preloader","thumbsScroller"]);e(["babel/babel-helpers","lib/jquery-amd","api-mod","ta/util/I18N","common/trackingStreams"],function(t,e,a,i,r){function s(t,s){function h(){var t=e(".heroPhoto",s).attr("data-mediaid");return o.children.filter("[data-mediaid="+t+"]").first()}function l(t){t=e(t),e(".tinyThumb.current",s).removeClass("current"),t.addClass("current");var a=e(".heroNav.right",s),i=e(".heroNav.left",s);i.toggleClass("disabled",0===parseInt(t.attr("data-offset"))),t.next(".tinyThumb").length>0?a.removeClass("disabled"):a.addClass("disabled")}function n(){var t=e(".heroThumbnails",e(s)),a=t.width();e("img[data-lazyurl]",t).each(function(t,i){var r=e(i);r.position().left<=a&&r.attr("src",r.attr("data-lazyurl")).removeAttr("data-lazyurl")})}function d(){var t=e(".heroThumbnails .thumbNav.left",s),a=e(".heroThumbnails .thumbNav.right",s);t.length&&a.length&&(u?(t.toggleClass("disabled",!f.hasMore.loaded.right&&!f.hasMore.unloaded.right),a.toggleClass("disabled",!f.hasMore.loaded.left&&!f.hasMore.unloaded.left)):(t.toggleClass("disabled",!f.hasMore.loaded.left&&!f.hasMore.unloaded.left),a.toggleClass("disabled",!f.hasMore.loaded.right&&!f.hasMore.unloaded.right)))}var o={},f={},u=i.isRtl();s=e(s),this.init=function(){if(o={thumbs:e(".photos.inHeroList",s),thumbsParent:e(".heroThumbnails",s),children:e(".photos.inHeroList > div",s)},!o.thumbsParent.length||!o.children.length)return!1;o.lastThumb=o.children.last(),o.firstThumb=o.children.first(),f={firstOffset:parseInt(o.firstThumb.attr("data-offset")),lastOffset:parseInt(o.lastThumb.attr("data-offset")),maxOffset:parseInt(o.thumbsParent.attr("data-totalThumbs"))-parseInt(o.thumbsParent.attr("data-panoCount"))-1,navWidth:e(".thumbNav.left",s).outerWidth(),oneThumbWidth:o.lastThumb.outerWidth()},f.visibleWidth=o.thumbsParent.width()-2*f.navWidth;var t=o.thumbsParent.offset().left+f.navWidth,i=t+o.thumbsParent.outerWidth()-f.navWidth,r=o.thumbs.offset().left,h=r+o.thumbs.outerWidth();return f.curLeft=parseInt(o.thumbs.css("left"))||0,f.curRight=parseInt(o.thumbs.css("right"))||0,f.maxLeft=a.getPosition(o.lastThumb,o.thumbs).left+f.oneThumbWidth-f.visibleWidth,f.maxRight=o.thumbs.width()-f.visibleWidth,f.hasMore={unloaded:u?{right:f.firstOffset>0,left:f.lastOffset<f.maxOffset}:{right:f.lastOffset<f.maxOffset,left:f.firstOffset>0},loaded:{right:h>i,left:r<t},loadedNextPage:{right:h-f.visibleWidth>i,left:r+f.visibleWidth<t}},n(),d(),!0},this.loadMore=function(a,i){try{var s=parseInt(o.thumbsParent.attr("data-pageSize"));if(f.hasMore.unloaded[i]){var h=function(){"left"!==i||u?"right"===i&&u&&o.thumbs.css({left:"auto",right:window.getComputedStyle(o.thumbs.get(0)).right}):o.thumbs.css({right:"auto",left:window.getComputedStyle(o.thumbs.get(0)).left}),m.init(),a&&a()},l="left"===i?u:!u,n={albumViewMode:"heroThumbs",albumid:o.thumbsParent.attr("data-albumid"),aggregationId:o.thumbsParent.attr("data-aggregationId"),filter:o.thumbsParent.attr("data-filter")};l?n.offset=Math.min(f.lastOffset+1,f.maxOffset):(n.offset=Math.max(f.firstOffset-s,0),s>f.firstOffset&&(n.cnt=f.firstOffset));var d="?"+e.param(n),m=this,b=u?"right":"left";return t(d,h,{prepend:i===b}),"left"!==i||u?"right"===i&&u&&o.thumbs.css({right:"auto",left:f.visibleWidth-f.curRight-o.thumbs.width()-4}):o.thumbs.css({left:"auto",right:f.visibleWidth-f.curLeft-o.thumbs.width()-4}),!0}}catch(t){r.error(t,"ResponsivePhotoViewer hero thumbs loadMore failed")}return!1};var m=function(t){var e=h();if(e.length>0){var i=o.thumbsParent[0].getBoundingClientRect(),r=e[0].getBoundingClientRect(),s=i.left+f.navWidth,n=i.right-f.navWidth,d=n-s,m=r.right-r.left,b=r.right>n,c=r.left<s,v=!1,p=a.getPosition(e,o.thumbs).left;u&&(p=o.thumbs.width()-p-m),b?(f.hasMore.loadedNextPage.right||t||(v=this.loadMore(g.bind(this,"current",!0),u?"left":"right")),v||(u?o.thumbs.css("right",Math.min(-p+d-m,0)+"px"):o.thumbs.css("left",Math.max(-p,-f.maxLeft)+"px"))):c&&(f.hasMore.loadedNextPage.left||t||(v=this.loadMore(g.bind(this,"current",!0),u?"right":"left")),v||(u?o.thumbs.css("right",Math.max(-p,-f.maxRight)+"px"):o.thumbs.css("left",Math.min(-p+d-m,0)+"px"))),l(e)}}.bind(this),b=function(t,e){var a=!1;if(f.hasMore.loadedNextPage[t]||e||(a=this.loadMore(g.bind(this,t,!0),t)),!a&&f.hasMore.loaded[t]){var i=void 0,r=u?"right":"left";i="right"===t?u?Math.min(f.curRight+f.visibleWidth,0):Math.max(f.curLeft-f.visibleWidth,-f.maxLeft):u?Math.max(f.curRight-f.visibleWidth,-f.maxRight):Math.min(f.curLeft+f.visibleWidth,0),o.thumbs.css(r,i+"px")}}.bind(this);this.scroll=function(t,e){"left"===t||"right"===t?b(t,e):"current"===t&&m(e);var a=this;o.thumbs.off("transitionend").on("transitionend",a.init)};var g=bind(this)}return s})});
define("common/metric-recorder",["babel/babel-helpers","ajax-request"],function(e,r){return function(e){return r({"method":"POST","url":"/MetricsAjax","x-requested-by":require("page-model").JS_SECURITY_TOKEN,"data":"metricsData="+encodeURIComponent(JSON.stringify(e))})}});
define("utils/uuid",["babel/babel-helpers"],function(x){return );
define("ta/Core/TA.PageVisibility",["vanillajs"],function(e){"use strict";function n(){a=!1;for(var e in s)s.hasOwnProperty(e)&&s[e]()}function t(){a=!0;for(var e in f)f.hasOwnProperty(e)&&f[e]()}function d(){var e=document[c]?f:s;for(var n in e)e.hasOwnProperty(n)&&e[n]()}function i(){"undefined"==typeof document[c]?document.addEventListener?(document.addEventListener("focus",n,!1),document.addEventListener("blur",t,!1)):(document.attachEvent("onfocus",n),document.attachEvent("onblur",t)):document.addEventListener(r,d),m=!0}function o(){"undefined"==typeof document[c]?document.removeEventListener?(document.removeEventListener("focus",n,!1),document.removeEventListener("blur",t,!1)):(document.detachEvent("onfocus",n),document.detachEvent("onblur",t)):document.removeEventListener(r,d),a=!1,m=!1}function u(e,n){var t=e.indexOf(n);return t>=0?e.splice(t,1):null}var c,r,f=[],s=[],m=!1,a=!1;return"undefined"!=typeof document.hidden?(c="hidden",r="visibilitychange"):"undefined"!=typeof document.mozHidden?(c="mozHidden",r="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(c="msHidden",r="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(c="webkitHidden",r="webkitvisibilitychange"),{addFocusListener:function(e){s.push(e),m||i()},addBlurListener:removeFocusListener:function(e){e?u(s,e):s.length=0,0===s.length&&0===f.length&&o()},removeBlurListener:function(e){e?u(f,e):f.length=0,0===s.length&&0===f.length&&o()},hidden:});
define("hotels/tracking/timing",["babel/babel-helpers","common/metric-recorder","utils/uuid","ta/Core/TA.PageVisibility"],function(e,r,n,t){function i(){a||(a=!0,t.addBlurListener()}function u(e,t){if(!a)return var i=n();o[i]=!0;var u=Date.now();return function(){if(!o[i])return Promise.resolve();delete o[i];var n=Date.now()-u;return r([{name:e,value:n,labels:[t]}])}}var a=!1,o={};return{enable:i,start:u}});
require(["ta/p13n/placements"],function(e){var t=e.define.bind(e,"pv_resp_content_hero","preloader",["handlers","preloader","thumbsScroller"]);t(["babel/babel-helpers","lib/jquery-amd","hotels/tracking/timing"],function(e,t,r){function n(){unction t(){if(!a){var t=n.shift();t&&(a=new Image,r[t]=a,a.onload=e,a.onerror=e,a.src=t,a.complete&&e())}}var r={},n=[],a=null;this.clear=this.clearQueue=this.getImageByUrl=this.addToQueue=function(e){e&&!r[e]&&n.indexOf(e)<0&&(n.push(e),setTimeout(t,1))}}function a(e,a,l){var u=this,h=new n;e=t(e),this.clear=this.preloadPhoto=function(n,o){var i=r.start("pv_change_photo",require("page-model").LOC_ID);n=t(n);var c=t(".heroPhoto",e),d=t(".mainImg img",c),p=n.attr("data-heroheight"),f=n.attr("data-herowidth"),s=t(h.getImageByUrl(o)||"<img/>"),g=function(){a(),l()===o&&d.parent().length&&(d.replaceWith(s),u.beginPreload(),s.off("load"),i())};s.on("load",g),p&&s.prop("height",parseInt(p)),f&&s.prop("width",parseInt(f)),s.prop("src")||s.prop("src",o),s.prop("complete")&&g.call(s)},this.beginPreload=function(){var r=t(".tinyThumb",e),n=r.filter(".current"),a=n.index();if(n.length){var l=Math.max(a-o,0),u=Math.min(a+1+i,r.length),c=void 0;for(c=a+1;c<u;c++)h.addToQueue(t(r[c]).attr("data-bigUrl"));for(c=a-1;c>=l;c--)h.addToQueue(t(r[c]).attr("data-bigUrl"))}}}var o=1,i=3;return a})});
define("ta/common/Swipe",["vanillajs"],function(e){"use strict";return{resetImageBehavior:function(e,t){for(var n,o=document.querySelectorAll(e),i=r=0;r<o.length;r++)n=o[r],n.onmousedown=i,t&&n.removeAttribute("onclick")},addSwipeListener:function(e,t,n){function o(){e.removeEventListener("touchmove",i),e.removeEventListener("touchend",r),window.removeEventListener("MSPointerMove",i,!1),window.removeEventListener("MSPointerUp",r,!1),c=null,a=null,v=null}function i(e){if(e.touches.length>1)o();else{s=e.touches[0].pageX-c;var t=e.touches[0].pageY-a;null===v?(v=s,n||e.preventDefault(),e.stopPropagation()):(v<0&&s>0||v>0&&s<0||Math.abs(t)>l)&&o()}}function r(n){o(),t&&Math.abs(s)>d&&t({target:e,direction:s>0?"right":"left",event:n}),s=0}function u(t){1==t.touches.length&&(c=t.touches[0].pageX,a=t.touches[0].pageY,e.addEventListener("touchmove",i,!1),e.addEventListener("touchend",r,!1),window.addEventListener("MSPointerMove",i,!1),window.addEventListener("MSPointerUp",r,!1))}var c,a,s,v,d=40,l=30;return"function"==typeof t&&e.addEventListener("touchstart",u,!1),{cancel:function(){"function"==typeof t&&e.removeEventListener("touchstart",u,!1)}}}}});
define("overlays/position/fullscreen",["lib/jquery-amd","overlays/position/base","overlays/options/disableBodyScroll"],function(o,i,t){"use strict";return function(n){ar e=i(),l=t(n);return s.onPosition=e.onPosition=function(){o(this.container).css({position:"fixed",top:0,left:0,bottom:0,right:0,height:"auto",width:"auto"}).addClass("fullscreen")},s.offPosition=e.offPosition=s}});
define("overlays/options/closeOnEmit",["babel/babel-helpers"],function(n){"use strict";return function(n,e,o){return function(){var t=this,i=function(){o&&!o.apply(void 0,arguments)||t.hide("on-event")};this.on("show",function(){return n.on(e,i)}).on("hide",}}});
define("utils/AjaxData",["ta","mixins/Events","lib/jquery-amd"],function(t,e,n){"use strict";unction a(t){unction r(){var t=a(),e=d,n=l;if(d=null,s=null,l=null,null!==n)try{n.abort()}catch(t){}return null!==e&&clearTimeout(e),t}function o(){var t=s;if(s=null,t){var e;t.success=function(n){l==e&&(l=null,v&&(y=n),f.data=n,f.error=void 0,f.dataVersion=++p,h(f,e,t.data),u.emit("update"))},t.error=function(n,i,a){l==e&&(l=null,f.data=y,f.dataVersion=++p,f.error={type:i,error:a,status:n.status,responseText:n.responseText},h(f,e,t.data),u.emit("update"))},e=c(t),l=e,u.emit("update")}}t=t||{};var u=new e("update"),d=null,s=null,l=null,f=this,p=0,c=t.ajaxFunc||n.ajax,h=t.transformer||i,m=t.dataType||"html",v=!!t.holdData,y=void 0;this.dataVersion=0,this.on=u.on.bind(u),this.off=u.off.bind(u),this.removeListener=u.removeListener.bind(u),this.isDone=this.isBusy=this.clear=function(){var t=a()||"undefined"!=typeof this.data||"undefined"!=typeof this.error;r(),y=void 0,f.data=void 0,f.error=void 0,f.dataVersion=0,h(f),t&&u.emit("update")},this.refresh=function(t,e,n,i,a){r(),(!i||i<0)&&(i=0),s={type:t,url:e,data:n,dataType:m,xhrFields:{withCredentials:!0}},"undefined"!=typeof a&&(s.timeout=a),d=setTimeout(o,i),f.error=void 0,v||(f.data=void 0,h(f)),u.emit("update")},this.postJson=function(t,e,n,i){r(),n=n||0,n<0&&(n=0),s={beforeSend:type:"POST",url:t,contentType:"application/json",data:JSON.stringify(e),dataType:m,xhrFields:{withCredentials:!0}},"undefined"!=typeof i&&(s.timeout=i),d=setTimeout(o,n),f.error=void 0,v||(f.data=void 0,h(f)),u.emit("update")}}return a});
define("overlays/ajaxUtil",["vanillajs","ta","utils/object/shallow-copy","utils/AjaxData","mixins/Events","overlays/loading-spinner","utils/resourceLoader","amdloaders"],function(e,t,a,r,n,i,o,s){"use strict";function d(e,t){var a,r=[];for(a in t)t[a]&&r.push(a);r.sort();for(var n=e,i=n.indexOf("?")>=0?"&":"?",o=0;o<r.length;++o)a=r[o],n+=i+encodeURIComponent(a)+"="+encodeURIComponent(String(t[a])),i="&";return n}function u(){for(var e=0,t={},a=[],r=p.length-1;r>=0;--r){var n=p[r],i=g[n];i&&!t[n]&&(i.hasClients()||++e<=h)&&(t[n]=i,a.push(n))}return a.reverse(),g=t,p=a,m=p.length+h,p}function l(e,i){function d(){if(T){T=!1,u();for(var e=p.length-1;e>=0;--e){var t=g[p[e]];t.needsTravelInfo&&t.invalidate()}}}function l(){u();for(var e=p.length-1;e>=0;--e){var t=g[p[e]];t.invalidateOnPricingModeUpdate&&t.invalidate()}}function c(e,a,r,n,i,s,u){if(n=n&&t.page&&t.page.usingUnifiedDates){T=!0;var c=t.page.datesToQueryString("STAYDATES");!c&&i&&(c=t.page.defaultDatesToQueryString("STAYDATES")),c&&(a+="&"+c),y||(y=!0,t.page.on("dateSelected",d),t.page.on("guestsSelected",d),require(["trjs!common/Radio"],function(e){v||(v=e("web-component-pricingMode"),v.on("update",)}))}if(s>1){if(s>20)return;a+="&reqNum="+s,u>=0||(u=2e3)}else u=0;r?e.refresh("POST",a,r,u):e.refresh("GET",a,void 0,u),o.load(A,}function h(){if(b.isBusy()||!S)return L&&clearTimeout(L),void(L=void 0);if(!b.data)return void(0!==b.dataVersion?E.error&&E.error===b.error||(E.error=b.error||"no content",L=L||setTimeout(m,0)):0!==j&&(V=q,j=b.dataVersion,U=[],P.hasListeners("update")&&(L=L||setTimeout(m,0))));if(j!==b.dataVersion){try{var e=document.createElement("div");e.innerHTML=b.data;var t=x,a=document.head||document.getElementsByTagName("head")[0];U=[],i.noScript||Array.prototype.forEach.call(e.querySelectorAll("script"),function(e){if(t){var r=document.createElement("script");r.setAttribute("type","text/javascript"),e.src&&(r.src=e.src),e.text&&(r.text=e.text),r.setAttribute("data-rup",e.getAttribute("data-rup")),a.appendChild(r),e.src||a.removeChild(r)}e.parentNode.removeChild(e)}),Array.prototype.forEach.call(e.querySelectorAll("style"),function(e){t?a.appendChild(e):e.parentNode.removeChild(e)}),Array.prototype.forEach.call(e.querySelectorAll("[data-targetEvent]"),,t&&(x=!1,f[i.inlineResourceId]=!0),V=e.innerHTML,j=b.dataVersion,b.data=void 0}catch(e){E.error="invalid HTML"}L=L||setTimeout(m,0)}}function m(){var t,a=!P.hasListeners("update");for(L=void 0,E.data=V,E.dataVersion=j,P.emit("update");t=U.shift();){var r=t.getAttribute("data-targetEvent");if("repoll-required"===r){if(a)return U=[],E.data=V=q,void(E.dataVersion=j=0);++M>1||(M=2);var n=Number(t.getAttribute("data-delay"));c(b,e,i.reqParams,I,D,M,n)}else P.emit("data-targetEvent",r,t)}}var A,S,E=this,b=new r({dataType:"html",ajaxFunc:i.ajaxFunc}),P=new n("update","data-targetEvent"),q=i.loadingContent||C,x=!1,I=!!i.sendTravelInfo,R=!!i.invalidateOnPricingModeUpdate,D=I&&i.sendDefaultDates,L=void 0,V=q,j=b.dataVersion,U=[],M=0;this.error=void 0,this.loadingData=q,this.data=V,this.dataVersion=j,this.needsTravelInfo=I,this.invalidateOnPricingModeUpdate=R,this.on=P.on.bind(P),this.off=P.off.bind(P),this.removeListener=P.removeListener.bind(P),this.init=this.isBusy=this.isDone=function(){return!b.isBusy()&&!L},this.invalidate=function(){b.clear(),M=0,this.hasClients()?c(b,e,i.reqParams,I,D,0,0):(E.data=V=q,E.dataVersion=j=0)},this.hasClients=this.load=function(){if(!b.isBusy()){if(0!==b.dataVersion)return void setTimeout(1);var t=i.reqParams,r=!i.isWidget||!i.inlineResourceId||!f[i.inlineResourceId];if(r){var n=s.getLoadedFilesParams();x=!0,t=t?a(t):{},t.haveJses=n.haveJses,t.haveCsses=n.haveCsses,i.isWidget&&(t.Action="install")}A=i.resources,M=0,c(b,e,t,I,D,0,0)}}}function c(e,t){var a=d(e,t.reqParams);a.length<128&&(e=a,t.reqParams=void 0);var r=g[a];return r||(r=new l(e,t),r.init(),t.noCache||(g[a]=r)),t.noCache||(p.push(a),p.length>m&&u()),r}var v,f={},h=10,p=[],g={},m=h,y=!1,T=!1,C=i();return{loadData:function(e,t){!t&&(t={});var a=c(e,t);return a.load(),a},loadOverlayWidget:function(e,t,r){var n="/OverlayWidgetAjax?Mode="+e;r?n+="&metaReferer="+encodeURIComponent(r):"string"==typeof crPageServlet&&(n+="&metaReferer="+encodeURIComponent(crPageServlet)),t=t?a(t):{},t.inlineResourceId=e,t.isWidget=!0;var i=c(n,t);return i.load(),i},cleanCache:u}});
define("overlays/options/ajax",["vanillajs","overlays/ajaxUtil"],function(t,e){"use strict";unction n(t,n){function a(){if(this.sourceElement&&(t=t||this.sourceElement.getAttribute("data-url"),void 0===n.noCache&&(n.noCache=this.sourceElement.getAttribute("data-ajaxNoCache")),n.resources||(n.resources=this.sourceElement.getAttribute("data-resources"),n.resources&&(n.resources=n.resources.replace(/[\[\]]/g,"").split(/[ ,]+/))),n.invalidateOnPricingModeUpdate||(n.invalidateOnPricingModeUpdate=this.sourceElement.getAttribute("data-invalidateOnPricingModeUpdate"))),t){var a,s,r=0,o=function(){a.dataVersion!==r&&(this.contentElement.innerHTML=a.data,this.emit("contentsUpdated"),r=a.dataVersion,require.defined("ta/prwidgets")&&require("ta/prwidgets").initWidgets(this.contentElement)),this.reposition(),setTimeout(this.reposition.bind(this),1),this.emit("contentLoaded",a.error)}.bind(this),d=function(i){return s==t?(this.reposition(),void this.emit("contentsUnchanged")):(n.skipInvalidate||a&&a.invalidate(),s=t,a=e.loadData(t,n),i||(this.contentElement.innerHTML=a.data),this.emit("contentsUpdated"),this.reposition(),r=a.dataVersion,require.defined("ta/prwidgets")&&require("ta/prwidgets").initWidgets(this.contentElement),a.on("update",o),void a.on("data-targetEvent",u))}.bind(this),u=this.emit.bind(this,"data-targetEvent");this.on("show",d),this.on("hide",function(){a&&(a.off("update",o),a.off("data-targetEvent",u),a=void 0)});var h=this.updateContent;this.updateContent=function(e,n){return e?i(e)?(t=e,this.isOpen()&&d(n),this):(t="",h.apply(this,arguments)):(t="",e=this.sourceElement.getAttribute("data-url"),e?this.updateContent(e):h.apply(this,arguments))}}}return n||(n={}),a}return n});
define("overlays/support/radio",["common/Radio"],function(n){"use strict";return{hide:function(o,i){return o||(o="overlays"),i||(i="shown"),function(){var t=this,u=n(o),e=this.on("show",function(){u.on(i,e)}).on("hide",}},announce:function(o,i,t){return i||(i="overlays"),t||(t="shown"),function(){var u=this,e=n(i);this.on("show",}}}});
define("overlays/options/closeOnEscape",["vanillajs","api-mod"],function(e,n){"use strict";function t(e){27===e.keyCode&&(e.preventDefault(),this.hide("escape"))}var o=function(){var e=n.bind(t,this);this.on("show",function(){n.addEvent(document,"keyup",e)}).on("hide",};return o});
define("utils/HistoryManager",[],function(){"use strict";function t(){function t(){return(new Date).getTime()+""+Math.random()}function i(t){var i=t.state;if(!a&&i&&i.id){var e=i.id,s=n[e];s&&s(i.data)}}var n={},e={},a=!1;this.pushState=function(i,e,a,s){var r=t();n[r]=s,i.id=r,history.pushState(i,e,a)},this.replaceState=function(i,e,a,s){var r=t();n[r]=s,i.id=r,history.replaceState(i,e,a)},this.addCallback=this.removeCallback=this.doCallbacks=function(t){e[t]&&e[t].each(},this.isSupported=this.disableCallbacks=window.addEventListener("popstate",i)}return t});
define("commerce/offerclickEvents",["mixins/Events","vanillajs"],function(e){"use strict";return new e("beforeClick","afterClick")});
define("photoviewer/loader",["babel/babel-helpers","lib/jquery-amd","page-model","overlays/Overlay","overlays/styles/modal","overlays/position/fullscreen","overlays/options/closeOnEmit","overlays/options/ajax","overlays/support/radio","overlays/options/closeOnEscape","common/trackingStreams","common/Radio","ta/Core/TA.FireEvent","ta/Core/TA.Store","photoviewer/tracking","utils/responsive","utils/HistoryManager","utils/urlutils","mixins/page-dates/pop-calendar","commerce/offerclickEvents"],function(e,o,t,n,i,r,a,d,l,s,c,p,u,v,h,f,w,m,g,b){"use strict";function y(e){var n=e,i=f.mobile()?2:f.desktop()?5:3;return n.heroMinWidth=o(window).width()-2*x,n.heroMinHeight=o(window).height()-2*x,n.gridItemMinWidth=n.heroMinWidth/i,n.updateType=n.updateType||"partial",n.placementRollUps="responsive-photo-viewer",n.albumid=e.albumid||e.albumId,n.puid=t.session.uid,n.geo=n.geo||t.GEO_ID,n.detail=n.detail||t.LOC_ID,n.geo&&n.detail?(e.albumViewMode||(n.albumid=n.albumid||P,n.filter=n.filter||T,e.ff||e.imageId?(n.albumViewMode="hero",n.ff=e.ff||e.imageId):e.panoId?n.albumViewMode="hero":n.albumViewMode="grid"),n.area="QC_Meta_Mini|Photo_Lightbox",window.pageServlet&&(n.metaReferer=window.pageServlet),n):(c.error(null,"photoviewer/loader.js:load missing required arguments"),!1)}nction C(){if(A.contentElement){var e=A.contentElement.querySelector(".photoviewerContainer");e&&e.parentNode&&(A.contentElement=e.parentNode),A.contentElement.id||(A.contentElement.id="photo_viewer_default_id");var o=k();o&&o.clear(),p("responsive-photoviewer").trigger("content-loaded",A.contentElement.id)}}function k(){if(A){var e=A.contentElement.id;if(e)return p(e)}return null}function M(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],f="no_padding";if(e.currentHeroId=e.ff,A){var w=void 0,m=k();m&&(w=m.request("currentHeroId")),w&&(e.currentHeroId=w),A.updateContent(E(e),!0)}else A=new n(document.body,i(null,"",f),r(),s,a(b,"beforeClick",function(e){return e.isBooking}),d(E(e),{resources:[],noCache:!0,skipInvalidate:!0}),l.hide("responsive-photoviewer","close")),_(t,e),A.on("contentLoaded",C),A.on("contentsUnchanged",function(){p("responsive-photoviewer").trigger("contents-unchanged")}),A.on("data-targetEvent",u.fireEvent),A.on("hide",function(){p("responsive-photoviewer").trigger("overlay-hide"),h.trackSimpleAction("photoviewer_close_click"),h.detachResizeTracker(),j&&v.remove("suppressCalendarPop");var e=o("[data-datetype='CHECKIN']").get(0);g.shouldPop(e)&&g.popCalendar(e)}),A.on("show",;c||t||O(e),A.show()}function O(e){var t=e.aggregationId,n=e.albumid,i=e.ff,r=e.filter,a=e.panoId,d={aggregationId:t,albumid:n,filter:r};i&&(d.ff=i),a&&(d.panoId=a);var l=H+o.param(d);p("responsive-photoviewer").trigger("addHistory",{data:d},document.title,l,}function _(e,o){var t=new w;if(t.isSupported()){if(e){var n=window.location.href;window.setTimeout(function(){if(n===window.location.href){var e=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search;window.history.replaceState(null,"",e),O(o)}},0)}p("responsive-photoviewer").on("addHistory",t.pushState);var i=!1;A.on("hide",function(){window.location.hash.indexOf(S)>=0&&(i=!0,t.disableCallbacks(!0),history.back())}),window.addEventListener("popstate",function(){window.location.hash.indexOf(S)>=0?i?history.back():A.show():(i=!1,t.disableCallbacks(!1),A.hide())})}}var x=20,S="#photos",H=S+";",T=7,P=101,A=void 0,j=!1;return o(function(){if(!v.retrieve("mediaviewer")){var e=window.location.hash;if(e.indexOf(S)>=0){v.retrieve("suppressCalendarPop")||(j=!0,v.store("suppressCalendarPop","true"));var o=void 0,t=e.indexOf(H)>=0&&e.substring(e.indexOf(H)+H.length,e.length);o=t&&t.length>0?m.getUrlQueryArgs("?"+t):y({}),o.updateType="full",M(o,!0)}}}),p("responsive-photoviewer").on("load",M),{load:M,buildUrl:E,getOverlayId:I}});
require(["ta/p13n/placements"],function(t){var e=t.define.bind(t,"pv_resp_content_hero","handlers",["handlers","preloader","thumbsScroller"]);e(["babel/babel-helpers","placement","lib/jquery-amd","photoviewer/models/eventTypes","photoviewer/tracking","photoviewer/radioHelper","utils/ajax","ta/prwidgets","thumbsScroller","utils/urlutils","ta/util/I18N","preloader","common/trackingStreams","utils/responsive","ta/common/Swipe","common/Radio","photoviewer/loader","utils/throttle","utils/browserutils"],function(t,e,a,r,o,n,i,d,l,u,s,p,m,c,h,f,g,v,b){"use strict";function w(){ot.getRadio().reply("currentHeroId",T),ot.getRadio().on("update-"+e.name+"-hero-thumbnails",S),rt=a("#"+e.id),pt=new l(M,rt),pt.init(),ot.getRadio().off(r.ADVANCE_HERO_CLICKED).on(r.ADVANCE_HERO_CLICKED,function(t){H(1===t)}),ot.getRadio().off("autoPlayNext",Y).on("autoPlayNext",Y),ot.getRadio().off("cancelAutoPlay",E).on("cancelAutoPlay",E),ot.getRadio().off(r.RHR_CLICKED,_).on(r.RHR_CLICKED,_),ot.getRadio().reply("nextVideoTitle",et),f("responsive-photoviewer").off("overlay-hide",y).on("overlay-hide",y),nt=new p(rt,R,function(){return it}),nt.beginPreload();var t=a(".tinyThumb.current",rt).attr("data-panorama");t&&O(t);var n=a(".heroWrapper",rt);n.off("mouseover").on("mouseover",function(){ot.getRadio().trigger(r.HERO_FOCUS_CHANGED,{hasFocus:!0})}),n.off("mouseout").on("mouseout",function(){ot.getRadio().trigger(r.HERO_FOCUS_CHANGED,{hasFocus:!1})});var i=a(".photoviewerContainer.hero .pvContent");i.length&&(ut&&ut.cancel(),ut=h.addSwipeListener(i.get(0),function(t){if(!n.hasClass("panorama")){if(a(t.event.target).closest(".heroThumbnails").length)return;H("left"===t.direction),o.recordPhotoSwipe()}})),a(".mainImg",n).off("click",I).on("click",I),a(".inHeroList",rt).length&&(st&&st.cancel(),st=h.addSwipeListener(a(".inHeroList",rt).get(0),function(t){t.event.stopPropagation(),N("left"===t.direction?"right":"left")})),setTimeout(function(){var t=a(".tinyThumb.current",rt);X(t),J(t)},0),Z(),q(C()),"ios"===b.Platform.name&&(mt(),a(window).off("resize",mt).on("resize",mt))}function y(){nt&&nt.clear(!0),"ios"===b.Platform.name&&a(window).off("resize",mt)}function T(){if(rt.length>0){var t=a(".tinyThumb.current",rt);return t.attr("data-mediaid")}return null}function C(){return a(".heroPhoto",rt).hasClass("playableVideo")}function P(){lt=setTimeout(function(){a(".heroPhoto .ui_spinner",rt).show()},500)}function R(){clearTimeout(lt),a(".heroPhoto .ui_spinner",rt).hide()}function I(){if(!a(".heroWrapper",rt).hasClass("panorama")){if(o.recordHeroClickOnDesktop(),c.desktop()){var t=a(".pano.tinyThumb.current",rt);if(t.length||C())return;H(!at)}_(),ot.getRadio().trigger(r.HERO_CLICKED)}}function _(){a(".heroThumbnails, .actions",rt).toggleClass("anchor")}function H(t){var e=void 0,r=void 0,o=a(".tinyThumb.current",rt);if(t?(r=o.next(".tinyThumb"),!r.length&&parseInt(o.attr("data-offset"))>0&&(e=at?"left":"right")):(r=o.prev(".tinyThumb"),!r.length&&parseInt(o.attr("data-offset"))>0&&(e=at?"right":"left")),f("photo_pagination_event").emit("pagination"),e)return void pt.loadMore(H.bind(self,t),e);var n=V(r)?D(r):L(r);n&&M(n)}function E(){H(!1)}function k(t){var e=V(t);return e?D(t):L(t)}function V(t){var e=a(t);return e.hasClass("pano")}function A(){var t=a(".heroThumbnails",rt);return{albumViewMode:"hero",aggregationId:t.attr("data-aggregationId"),albumid:t.attr("data-albumid"),filter:t.attr("data-filter")}}function D(t){if(!t)return{};var e=a(t),r=e.attr("data-mediaid"),o=e.attr("data-panorama"),n=A();return n.panoId=r,n.panoPath=o,n}function L(t){if(!t)return{};var e=a(t),r=e.attr("data-mediaid"),o=A();return o.ff=r,o}function O(t){R();var r=e.params.krpanoNew?"trjs!krpano":"trjs!krpano-old";require(["babel/babel-helpers",r],function(e){a("#PANO_HOLDER",rt).empty().removeProp("onclick");var r={html5:"only",wmode:"transparent",xml:"/PanoramaXml?pano="+encodeURIComponent(t),target:"PANO_HOLDER",id:"albumViewerPano"};a(".heroWrapper",rt).addClass("panorama"),a(rt).closest(".pvMain").addClass("fullHeight"),window.embedpano&&window.embedpano(r)})}function S(t,e){var r=a(t),o=r.attr("data-updateComponent"),n=rt.find('[data-updateComponent="'+o+'"]'),i=a(".photos.inHeroList",n),d=a(".tinyThumb",r);e&&e.options&&e.options.prepend?(i.prepend(d),N("current",!0)):i.append(d),dt=!1,e&&e.callback&&"function"==typeof e.callback&&e.callback()}function x(t,e,r){a(e).hasClass("disabled")||(at&&("left"===r?r="right":"right"===r&&(r="left")),o.recordPhotoStripArrowClick(),N(r))}function N(t,e){try{pt.scroll(t,e)}catch(e){m.error(e,"albumViewer:scrollThumbs failed",null,{direction:t})}}function U(t,e){if(f("photo_pagination_event").emit("pagination"),M(k(e)),t&&"click"===t.type){var r=a(e).data(),n=r.mediaid,i=r.albumid,d=r.mediaFilter,l=r.mediaType;o.recordHeroThumbClick(n,i,d,l),ot.getRadio().trigger("check-ad-refresh")}}function M(t,a,r){if("Restaurant_Review"===e.servletName&&f("restaurants-interactions").emit("photo-click-event",t.ff),!dt&&(R(),nt?nt.clear(!1):m.error(null,"m_heroPreloader is null in responsive photo viewer:update()"),"string"==typeof t&&(t=u.getUrlQueryArgs(t)),t&&t.albumViewMode))if("hero"===t.albumViewMode){var o=t.panoId||t.ff;j(t,function(){null==T()?g.load(t,!1,!0):K(o,t.panoPath)}),K(o,t.panoPath)}else"heroThumbs"===t.albumViewMode&&F(t,a,r)}function F(t,a,o){dt=!0,ot.getRadio().trigger(r.HERO_THUMBS_REQUESTED,t,"update-"+e.name+"-hero-thumbnails",{callback:a,options:o})}function K(t,e){P();var r=e&&e.length>0,o=a(".mainImg .videoPlayer",rt);o.length&&o.remove(),a(".mainImg img",rt).length||a("<img>").appendTo(a(".mainImg",rt)),a(".heroWrapper",rt).removeClass("panorama"),a(rt).closest(".pvMain").removeClass("fullHeight"),window.removepano&&window.removepano("albumViewerPano");var n=a(".heroPhoto",rt);n.attr("data-mediaid",t),W(!1);var i=a(".tinyThumb.current",rt),d=i.attr("data-bigurl"),l=i.attr("data-dmoGeo");l?n.attr("data-dmogeo",l):n.removeAttr("data-dmogeo"),it=d;var u=!i.attr("data-videoformats");if(q(!(r||u)),r)O(e);else if(u)nt.preloadPhoto(i,d);else{R();var s=i.attr("data-srcurl"),p=i.attr("data-videoautoplay");z(d,s,p)}X(i),J(i)}function j(t,e){var r=t.aggregationId,o=t.albumid,n=t.ff,i=t.filter,d=t.panoId,l={aggregationId:r,albumid:o,filter:i};n&&(l.ff=n),d&&(l.panoId=d);var u="#photos;"+a.param(l);f("responsive-photoviewer").trigger("addHistory",{data:l},document.title,u,e)}function q(t){a(".heroPhoto",rt).toggleClass("playableVideo",t);var e=a("#heroVideo",rt).get(0);t||null==e||e.paused||e.pause()}function W(t){t&&G();var e=a(".heroPhoto",rt);e.length&&N("current",t)}function z(t,e,r){a(".videoContainer",rt).show();var o=a("#heroVideo",rt);o.length&&(o.attr("poster",t),o.attr("src",e),r&&(o.get(0).play(),o.prop("muted",!1)))}function G(){if(rt.parent("body").length){var t=a(".heroPhoto .mainImg img",rt);if(t.length){var e=a("img",t);e.length&&B(e,t)}}}function Q(t,e,r){a(r).find(".ui_spinner").remove()}function B(){setTimeout(function(){R()},1)}function X(t){var e=t.attr("data-captionText")||t.attr("data-icaption")||"";e=e.replace(/[\r\n]/g,"");var o=a(".heroThumbnails",rt),n={albumid:parseInt(o.attr("data-albumid")),isPano:t.hasClass("pano"),avatarUrl:t.attr("data-avatarurl"),captionText:e,captionProvider:t.attr("data-captionprovider"),helpfulvotes:parseInt(t.attr("data-helpfulVotes")),mediaFilter:parseInt(t.attr("data-image-media-filter")),mediaType:t.attr("data-media-type")||"",mediaid:t.attr("data-mediaid"),rating:parseInt(t.attr("data-rating")),reviewUrl:t.attr("data-reviewurl"),mediaAttributionUrl:t.attr("data-mediaAttributionUrl")};ot.getRadio().trigger(r.HERO_UPDATED,n)}function J(t){var e=t.attr("data-mediaid");if(e){var r=a(".heroThumbnails",rt),n=parseInt(r.attr("data-albumid")),i=parseInt(t.attr("data-image-media-filter")),d=t.attr("data-media-type")||"";o.trackPhotoViewerImpression("detail_view",e+"|"+n+"|"+i+"|"+d)}}function Y(){var t=a("#heroVideo",rt).get(0);null!=t&&t.play()}function Z(){var t=a("#heroVideo",rt).get(0);null!=t&&t.addEventListener("ended",$)}function $(){ot.getRadio().request("isAutoPlayEnabled")&&tt()&&(ot.getRadio().trigger("showAutoPlayOverlay"),H(!0))}function tt(){var t=a(".tinyThumb.current",rt),e=t.next(".tinyThumb");return!!e.length}function et(){var t=a(".tinyThumb.current",rt),e=t.next(".tinyThumb"),r=e.attr("data-captionText")||e.attr("data-icaption")||"";return r=r.replace(/[\r\n]/g,"")}var at=s.isRtl(),rt=void 0,ot=n("#"+e.id,w),nt=void 0,it=void 0,dt=!1,lt=void 0,ut=void 0,st=void 0,pt=void 0,mt=v(function(){var t=window.innerHeight,e=window.document.documentElement.clientHeight;if(t&&e&&t!==e){var r=e-t;a(".heroThumbnails",rt).css("bottom",r+"px")}},20);return{onThumbSelected:U,moveThumbs:x,heroClicked:I,afterThumbnailLoad:Q,afterImgLoad:B,playVideo:Y}})});
require(["ta/p13n/placements"],function(e){var o=e.define.bind(e,"pv_resp_content_hero_ad","handlers",["handlers"]);o(["babel/babel-helpers","placement","lib/jquery-amd","ta/Core/TA.FireEvent","common/Radio","photoviewer/radioHelper"],function(e,o,t,a,n,r){function i(){require(["babel/babel-helpers","@ta/platform.runtime"],function(e,o){o.importBundle("@ta/taps.ad-photo-album-on-mobile").then(function(){var t=document.getElementsByClassName("pv_ad_horizon_mobile"),a=e.slicedToArray(t,1),n=a[0],r="@ta/taps.ad-photo-album-on-mobile",i={refreshKey:d.toString(),pageTypeTargeting:"Restaurants_LocationPhotoAlbum"};document.getElementById(r)&&document.getElementById(r).remove();var l=document.createElement("div");l.id=r,n.appendChild(l),o.createRoot(r,"@ta/taps.ad-photo-album-on-mobile",i)})}),++d}function l(){i(),n("responsive-photoviewer").off("refresh-ad"),n("responsive-photoviewer").on("refresh-ad",i)}var d=0;r("#"+o.id,l)})});
require(["ta/p13n/placements"],function(t){var e=t.define.bind(t,"pv_resp_content_hero_zepto","thumbsScroller",["handlers","preloader","thumbsScroller"]);e(["babel/babel-helpers","lib/jquery-amd","api-mod","ta/util/I18N","common/trackingStreams"],function(t,e,a,i,r){function s(t,s){function h(){var t=e(".heroPhoto",s).attr("data-mediaid");return o.children.filter(function(){return e(this).data("mediaid")===parseInt(t)}).first()}function n(t){t=e(t),e(".tinyThumb.current",s).removeClass("current"),t.addClass("current");var a=e(".heroNav.right",s),i=e(".heroNav.left",s);i.toggleClass("disabled",0===parseInt(t.attr("data-offset"))),t.next(".tinyThumb").length>0?a.removeClass("disabled"):a.addClass("disabled")}function l(){var t=e(".heroThumbnails",e(s)),a=t.width();e("img[data-lazyurl]",t).each(function(t,i){var r=e(i);r.position().left<=a&&r.attr("src",r.attr("data-lazyurl")).removeAttr("data-lazyurl")})}function d(){var t=e(".heroThumbnails .thumbNav.left",s),a=e(".heroThumbnails .thumbNav.right",s);t.length&&a.length&&(u?(t.toggleClass("disabled",!f.hasMore.loaded.right&&!f.hasMore.unloaded.right),a.toggleClass("disabled",!f.hasMore.loaded.left&&!f.hasMore.unloaded.left)):(t.toggleClass("disabled",!f.hasMore.loaded.left&&!f.hasMore.unloaded.left),a.toggleClass("disabled",!f.hasMore.loaded.right&&!f.hasMore.unloaded.right)))}var o={},f={},u=i.isRtl();s=e(s),this.init=function(){if(o={thumbs:e(".photos.inHeroList",s),thumbsParent:e(".heroThumbnails",s),children:e(".photos.inHeroList > div",s)},!o.thumbsParent.length||!o.children.length)return!1;o.lastThumb=o.children.last(),o.firstThumb=o.children.first(),f={firstOffset:parseInt(o.firstThumb.attr("data-offset")),lastOffset:parseInt(o.lastThumb.attr("data-offset")),maxOffset:parseInt(o.thumbsParent.attr("data-totalThumbs"))-parseInt(o.thumbsParent.attr("data-panoCount"))-1,navWidth:e(".thumbNav.left",s)[0].offsetWidth,oneThumbWidth:o.lastThumb[0].offsetWidth},f.visibleWidth=o.thumbsParent.width()-2*f.navWidth;var t=o.thumbsParent.offset().left+f.navWidth,i=t+o.thumbsParent[0].offsetWidth-f.navWidth,r=o.thumbs.offset().left,h=r+o.thumbs[0].offsetWidth;return f.curLeft=parseInt(o.thumbs.css("left"))||0,f.curRight=parseInt(o.thumbs.css("right"))||0,f.maxLeft=a.getPosition(o.lastThumb,o.thumbs).left+f.oneThumbWidth-f.visibleWidth,f.maxRight=o.thumbs.width()-f.visibleWidth,f.hasMore={unloaded:u?{right:f.firstOffset>0,left:f.lastOffset<f.maxOffset}:{right:f.lastOffset<f.maxOffset,left:f.firstOffset>0},loaded:{right:h>i,left:r<t},loadedNextPage:{right:h-f.visibleWidth>i,left:r+f.visibleWidth<t}},l(),d(),!0},this.loadMore=function(a,i){try{var s=parseInt(o.thumbsParent.attr("data-pageSize"));if(f.hasMore.unloaded[i]){var h=function(){"left"!==i||u?"right"===i&&u&&o.thumbs.css({left:"auto",right:window.getComputedStyle(o.thumbs.get(0)).right}):o.thumbs.css({right:"auto",left:window.getComputedStyle(o.thumbs.get(0)).left}),m.init(),a&&a()},n="left"===i?u:!u,l={albumViewMode:"heroThumbs",albumid:o.thumbsParent.attr("data-albumid"),aggregationId:o.thumbsParent.attr("data-aggregationId"),filter:o.thumbsParent.attr("data-filter"),mediaGroupPreference:o.thumbsParent.attr("data-mediaGroupPreference")};n?l.offset=Math.min(f.lastOffset+1,f.maxOffset):(l.offset=Math.max(f.firstOffset-s,0),s>f.firstOffset&&(l.cnt=f.firstOffset));var d="?"+e.param(l),m=this,b=u?"right":"left";return t(d,h,{prepend:i===b}),"left"!==i||u?"right"===i&&u&&o.thumbs.css({right:"auto",left:f.visibleWidth-f.curRight-o.thumbs.width()-4}):o.thumbs.css({left:"auto",right:f.visibleWidth-f.curLeft-o.thumbs.width()-4}),!0}}catch(t){r.error(t,"ResponsivePhotoViewer hero thumbs loadMore failed")}return!1};var m=function(t){var e=h();if(e.length>0){var i=o.thumbsParent[0].getBoundingClientRect(),r=e[0].getBoundingClientRect(),s=i.left+f.navWidth,l=i.right-f.navWidth,d=l-s,m=r.right-r.left,b=r.right>l,c=r.left<s,v=!1,p=a.getPosition(e,o.thumbs).left;u&&(p=o.thumbs.width()-p-m),b?(f.hasMore.loadedNextPage.right||t||(v=this.loadMore(g.bind(this,"current",!0),u?"left":"right")),v||(u?o.thumbs.css("right",Math.min(-p+d-m,0)+"px"):o.thumbs.css("left",Math.max(-p,-f.maxLeft)+"px"))):c&&(f.hasMore.loadedNextPage.left||t||(v=this.loadMore(g.bind(this,"current",!0),u?"right":"left")),v||(u?o.thumbs.css("right",Math.max(-p,-f.maxRight)+"px"):o.thumbs.css("left",Math.min(-p+d-m,0)+"px"))),n(e)}}.bind(this),b=function(t,e){var a=!1;if(f.hasMore.loadedNextPage[t]||e||(a=this.loadMore(g.bind(this,t,!0),t)),!a&&f.hasMore.loaded[t]){var i=void 0,r=u?"right":"left";i="right"===t?u?Math.min(f.curRight+f.visibleWidth,0):Math.max(f.curLeft-f.visibleWidth,-f.maxLeft):u?Math.max(f.curRight-f.visibleWidth,-f.maxRight):Math.min(f.curLeft+f.visibleWidth,0),o.thumbs.css(r,i+"px")}}.bind(this);this.scroll=function(t,e){"left"===t||"right"===t?b(t,e):"current"===t&&m(e);var a=this;o.thumbs.off("transitionend").on("transitionend",a.init)};var g=function(t,e){this.init()&&this.scroll(t,e)}.bind(this)}return s})});
require(["ta/p13n/placements"],function(e){var t=e.define.bind(e,"pv_resp_content_hero_zepto","preloader",["handlers","preloader","thumbsScroller"]);t(["babel/babel-helpers","lib/jquery-amd"],function(e,t){function r(){function e(){a=null,t()}function t(){if(!a){var t=n.shift();t&&(a=new Image,r[t]=a,a.onload=e,a.onerror=e,a.src=t,a.complete&&e())}}var r={},n=[],a=null;this.clear=function(){n=[],r={}},this.clearQueue=function(){n=[]},this.getImageByUrl=function(e){return r[e]},this.addToQueue=function(e){e&&!r[e]&&n.indexOf(e)<0&&(n.push(e),setTimeout(t,1))}}function n(e,n,i){var l=this,u=new r;e=t(e),this.clear=function(e){e?u.clear():u.clearQueue()},this.preloadPhoto=function(r,a){r=t(r);var o=t(".heroPhoto",e),h=t(".mainImg img",o),c=r.attr("data-heroheight"),d=r.attr("data-herowidth"),p=t(u.getImageByUrl(a)||"<img/>"),f=function(){n(),i()===a&&h.parent().length&&h[0]!==p[0]&&(h.replaceWith(p),l.beginPreload(),p.off("load"))};p.on("load",f),c&&p.prop("height",parseInt(c)),d&&p.prop("width",parseInt(d)),p.prop("src")||p.prop("src",a),p.prop("complete")&&f.call(p)},this.beginPreload=function(){var r=t(".tinyThumb",e),n=r.filter(".current"),i=n.index();if(n.length){var l=Math.max(i-a,0),h=Math.min(i+1+o,r.length),c=void 0;for(c=i+1;c<h;c++)u.addToQueue(t(r[c]).attr("data-bigUrl"));for(c=i-1;c>=l;c--)u.addToQueue(t(r[c]).attr("data-bigUrl"))}}}var a=1,o=3;return n})});
require(["ta/p13n/placements"],function(t){var e=t.define.bind(t,"pv_resp_content_hero_zepto","handlers",["handlers","preloader","thumbsScroller"]);e(["babel/babel-helpers","placement","lib/jquery-amd","photoviewer/models/eventTypes","photoviewer/tracking","photoviewer/radioHelper","utils/ajax","ta/prwidgets","thumbsScroller","utils/urlutils","ta/util/I18N","preloader","common/trackingStreams","utils/responsive","ta/common/Swipe","common/Radio"],function(t,e,a,r,o,n,i,d,l,u,s,c,m,p,h,f){"use strict";function g(){tt.getRadio().reply("currentHeroId",v),tt.getRadio().on("update-"+e.name+"-hero-thumbnails",A),$=a("#"+e.id),dt=new l(S,$),dt.init(),tt.getRadio().off(r.ADVANCE_HERO_CLICKED).on(r.ADVANCE_HERO_CLICKED,,tt.getRadio().off("autoPlayNext",z).on("autoPlayNext",z),tt.getRadio().off("cancelAutoPlay",R).on("cancelAutoPlay",R),tt.getRadio().off(r.RHR_CLICKED,C).on(r.RHR_CLICKED,C),tt.getRadio().reply("nextVideoTitle",Y),et=new c($,T,function(){return at}),et.beginPreload();var t=a(".tinyThumb.current",$).attr("data-panorama");t&&k(t);var n=a(".heroWrapper",$);n.off("mouseover").on("mouseover",function(){tt.getRadio().trigger(r.HERO_FOCUS_CHANGED,{hasFocus:!0})}),n.off("mouseout").on("mouseout",function(){tt.getRadio().trigger(r.HERO_FOCUS_CHANGED,{hasFocus:!1})});var i=a(".photoviewerContainer.hero .pvContent");i.length&&(nt&&nt.cancel(),nt=h.addSwipeListener(i.get(0),function(t){if(!n.hasClass("panorama")){if(a(t.event.target).closest(".heroThumbnails").length)return;P("left"===t.direction),o.recordPhotoSwipe()}})),a(".mainImg",n).off("click",w).on("click",w),a(".inHeroList",$).length&&(it&&it.cancel(),it=h.addSwipeListener(a(".inHeroList",$).get(0),function(t){t.event.stopPropagation(),D("left"===t.direction?"right":"left")})),setTimeout(function(){var t=a(".tinyThumb.current",$);j(t),Q(t)},0),B(),M(b())}function v(){if($.length>0){var t=a(".tinyThumb.current",$);return t.attr("data-mediaid")}return null}function b(){return a(".heroPhoto",$).hasClass("playableVideo")}function y(){ot=setTimeout(500)}function T(){clearTimeout(ot),a(".heroPhoto .ui_spinner",$).hide()}function w(){if(!a(".heroWrapper",$).hasClass("panorama")){if(p.desktop()){var t=a(".pano.tinyThumb.current",$);if(t.length||b())return;P(!Z)}C(),tt.getRadio().trigger(r.HERO_CLICKED)}}unction P(t){var e=void 0,r=void 0,o=a(".tinyThumb.current",$);if(t?(r=o.next(".tinyThumb"),!r.length&&parseInt(o.attr("data-offset"))>0&&(e=Z?"left":"right")):(r=o.prev(".tinyThumb"),!r.length&&parseInt(o.attr("data-offset"))>0&&(e=Z?"right":"left")),e)return void dt.loadMore(P.bind(self,t),e);var n=_(r)?H(r):V(r);n&&S(n)}unction I(t){var e=_(t);return e?H(t):V(t)}unction E(){var t=a(".heroThumbnails",$);return{albumViewMode:"hero",aggregationId:t.attr("data-aggregationId"),albumid:t.attr("data-albumid"),filter:t.attr("data-filter"),mediaGroupPreference:t.attr("data-mediaGroupPreference")}}function H(t){if(!t)return{};var e=a(t),r=e.attr("data-mediaid"),o=e.attr("data-panorama"),n=E();return n.panoId=r,n.panoPath=o,n}function V(t){if(!t)return{};var e=a(t),r=e.attr("data-mediaid"),o=E();return o.ff=r,o}function k(t){T(),require(["babel/babel-helpers","trjs!krpano"],function(e){a("#PANO_HOLDER",$).empty().removeProp("onclick");var r={html5:"only",wmode:"transparent",xml:"/PanoramaXml?pano="+encodeURIComponent(t),target:"PANO_HOLDER",id:"albumViewerPano"};a(".heroWrapper",$).addClass("panorama"),a($).closest(".pvMain").addClass("fullHeight"),window.embedpano&&window.embedpano(r)})}function A(t,e){var r=a(t),o=r.attr("data-updateComponent"),n=$.find('[data-updateComponent="'+o+'"]'),i=a(".photos.inHeroList",n),d=a(".tinyThumb",r);e&&e.options&&e.options.prepend?(i.prepend(d),D("current",!0)):i.append(d),rt=!1,r.length>0&&e&&e.callback&&"function"==typeof e.callback&&e.callback()}function L(t,e,r){a(e).hasClass("disabled")||(Z&&("left"===r?r="right":"right"===r&&(r="left")),D(r))}function D(t,e){try{dt.scroll(t,e)}catch(e){m.error(e,"albumViewer:scrollThumbs failed",null,{direction:t})}}function O(t,e){if(S(I(e)),t&&"click"===t.type){var r=a(e),n=r.data("mediaid"),i=r.data("albumid"),d=r.data("mediaFilter"),l=r.data("mediaType");o.recordHeroThumbClick(n,i,d,l),tt.getRadio().trigger("check-ad-refresh")}}function S(t,e,a){if(!rt&&(T(),et?et.clear(!1):m.error(null,"m_heroPreloader is null in responsive photo viewer:update()"),"string"==typeof t&&(t=u.getUrlQueryArgs(t)),t&&t.albumViewMode))if("hero"===t.albumViewMode){var r=t.panoId||t.ff;U(t,,N(r,t.panoPath)}else"heroThumbs"===t.albumViewMode&&x(t,e,a)}function x(t,a,o){rt=!0,tt.getRadio().trigger(r.HERO_THUMBS_REQUESTED,t,"update-"+e.name+"-hero-thumbnails",{callback:a,options:o})}function N(t,e){y();var r=e&&e.length>0,o=a(".mainImg .videoPlayer",$);o.length&&o.remove(),a(".mainImg img",$).length||a("<img>").appendTo(a(".mainImg",$)),a(".heroWrapper",$).removeClass("panorama"),a($).closest(".pvMain").removeClass("fullHeight"),window.removepano&&window.removepano("albumViewerPano");var n=a(".heroPhoto",$);n.attr("data-mediaid",t),F(!1);var i=a(".tinyThumb.current",$),d=i.attr("data-bigurl"),l=i.attr("data-dmoGeo");l?n.attr("data-dmogeo",l):n.removeAttr("data-dmogeo"),at=d;var u=!i.attr("data-videoformats");if(M(!(r||u)),r)k(e);else if(u)et.preloadPhoto(i,d);else{T();var s=i.attr("data-srcurl");G(d,s)}j(i),Q(i)}function U(t,e){var r=t.aggregationId,o=t.albumid,n=t.ff,i=t.filter,d=t.panoId,l={aggregationId:r,albumid:o,filter:i};n&&(l.ff=n),d&&(l.panoId=d);var u="#photos;"+a.param(l);f("responsive-photoviewer").trigger("addHistory",{data:l},document.title,u,e)}function M(t){a(".heroPhoto",$).toggleClass("playableVideo",t);var e=a("#heroVideo",$).get(0);t||null==e||e.paused||e.pause()}function F(t){t&&K();var e=a(".heroPhoto",$);e.length&&D("current",t)}function G(t,e){a(".videoContainer",$).show();var r=a("#heroVideo",$);r.length&&(r.attr("poster",t),r.attr("src",e))}function K(){if($.parent("body").length){var t=a(".heroPhoto .mainImg img",$);if(t.length){var e=a("img",t);e.length&&W(e,t)}}}function q(t,e,r){a(r).find(".ui_spinner").remove()}unction j(t){var e=t.attr("data-captionText")||t.attr("data-icaption")||"";e=e.replace(/[\r\n]/g,"");var o=a(".heroThumbnails",$),n={albumid:parseInt(o.attr("data-albumid")),isPano:t.hasClass("pano"),avatarUrl:t.attr("data-avatarurl"),captionText:e,captionProvider:t.attr("data-captionprovider"),helpfulvotes:parseInt(t.attr("data-helpfulVotes")),mediaFilter:parseInt(t.attr("data-image-media-filter")),mediaType:t.attr("data-media-type")||"",mediaid:t.attr("data-mediaid"),rating:parseInt(t.attr("data-rating")),reviewUrl:t.attr("data-reviewurl")};tt.getRadio().trigger(r.HERO_UPDATED,n)}function Q(t){var e=t.attr("data-mediaid");if(e){var r=a(".heroThumbnails",$),n=parseInt(r.attr("data-albumid")),i=parseInt(t.attr("data-image-media-filter")),d=t.attr("data-media-type")||"";o.trackPhotoViewerImpression("detail_view",e+"|"+n+"|"+i+"|"+d)}}function z(){var t=a("#heroVideo",$).get(0);null!=t&&t.play()}function B(){var t=a("#heroVideo",$).get(0);null!=t&&t.addEventListener("ended",X)}function X(){tt.getRadio().request("isAutoPlayEnabled")&&J()&&(tt.getRadio().trigger("showAutoPlayOverlay"),P(!0))}function J(){var t=a(".tinyThumb.current",$),e=t.next(".tinyThumb");return!!e.length}function Y(){var t=a(".tinyThumb.current",$),e=t.next(".tinyThumb"),r=e.attr("data-captionText")||e.attr("data-icaption")||"";return r=r.replace(/[\r\n]/g,"")}var Z=s.isRtl(),$=void 0,tt=n("#"+e.id,g),et=void 0,at=void 0,rt=!1,ot=void 0,nt=void 0,it=void 0,dt=void 0;return{onThumbSelected:O,moveThumbs:L,heroClicked:w,afterThumbnailLoad:q,afterImgLoad:W,playVideo:z}})});
define("utils/classnameUtils",["vanillajs"],function(){function s(s){return e[s]?e[s].lastIndex=0:e[s]=new RegExp("(\\s|^)"+s+"(\\s|$)","g"),e[s]}var a={},e={};return a.hasClass=function(a,e){return!!a&&(a.classList?a.classList.contains(e):s(e).test(a.className))},a.addClass=function(s,e){s&&e&&(s.classList?s.classList.add(e):a.hasClass(s,e)||(s.className+=" "+e))},a.removeClass=function(a,e){a&&e&&(a.classList?a.classList.remove(e):a.className=a.className.replace(s(e)," "))},a.toggleClass=function(s,e,n){s&&(n||void 0===n&&!a.hasClass(s,e)?a.addClass(s,e):a.removeClass(s,e))},a.getParentByClassname=function(s,e){for(var n=s&&s.parentNode;n;n=n.parentNode)if(a.hasClass(n,e))return n;return null},a});
define("responsive/text-resizer",["babel/babel-helpers","utils/to-array","utils/classnameUtils","utils/throttle","utils/ResponsiveEvents","vanillajs"],function(t,e,i,r,n){function l(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body;return!t===document&&(t=document.body),e(t.querySelectorAll("."+p)).filter(}function u(e){e.style.fontSize=null;var i=(getComputedStyle(e)||{}).fontSize;if(!i)return{};var r=i.match(b),n=t.slicedToArray(r,3),l=(n[0],n[1]),u=n[2],o=parseFloat(l);return o&&o>.001&&z[u]?{originalSize:o,units:u,multiplier:1,minMult:Math.max(y,z[u]/o)}:{}}function o(t){if(t[v])return t[v];var e=u(t);return e.originalSize?(t[v]=Object.assign(e,{group:t.getAttribute(h),multApplied:1}),t[v]):null}function a(t){for(var e=0;e<g&&t.length;e++)t.forEach(c),t=t.filter(function(t){if(!(t.clientWidth>0)||t.scrollWidth<=t.clientWidth)return!1;var e=t[v],i=(parseFloat(t.style.paddingLeft)||0)+(parseFloat(t.style.paddingRight)||0),r=t.scrollWidth-i;if(r<1)return!1;var n=(t.clientWidth-i-2)/r;return n=Math.min(n,.95)*e.multiplier,n<=e.minMult?(e.multiplier=e.minMult,!1):(e.multiplier=n,!0)});t.length&&(t.forEach(c),t.forEach(function(t){t.scrollWidth>t.clientWidth&&(t[v].multiplier=t[v].minMult)}))}function c(t){var e=t[v];if(!(e&&e.multApplied!=e.multiplier&&e.multiplier>0))return!1;var i=Math.max(z[e.units],e.originalSize*e.multiplier);return t.style.fontSize=""+i+e.units,e.multApplied=e.multiplier,!0}function s(t){if(t&&t.length){var e={};t.forEach(function(t){var i=t[v];i.group?e[i.group]=1:c(t)}),Object.keys(e).length&&(t=l(document.body).filter(function(t){var i=t[v],r=i.group;return!!(i&&r&&e[r]&&i.multiplier>0)&&(e[r]>i.multiplier&&(e[r]=i.multiplier),!0)}),t.forEach(function(t){var i=t[v];i.multiplier=e[i.group],c(t)}))}}function f(t){if(t&&(E||(E=!0,f(document.body),t!==document&&t!==document.body))){var c=e(t.querySelectorAll("."+m));if(c.length){c.forEach(function(t){i.removeClass(t,m),i.addClass(t,p)});var h=[];c=c.filter(function(t){var e=o(t);return!!e||(h.push(t),!1)}),a(c),h.forEach(,s(c),S||(window.addEventListener("resize",r(50)),n.on("breakpoint",function(){l(document.body).forEach(}),S=!0)}}}ar m="autoResize",p="__resizeWatch",h="data-sizegroup",v="__resizerContext",g=4,y=.5,b=/^(\d+(?:\.\d+)?)(.*)$/,z={"px":8.5,"em":.5,"pt":6,"%":50},E=!1,S=!1;return{init:f,refresh:d}});
require(["ta/p13n/placements"],function(e){var n=e.define.bind(e,"pv_resp_navbar","handlers",["handlers"]);n(["babel/babel-helpers","placement","lib/jquery-amd","photoviewer/models/eventTypes","photoviewer/loader","photoviewer/tracking","utils/responsive","utils/ResponsiveEvents","common/Radio","photoviewer/radioHelper","ta/prwidgets","responsive/text-resizer","ta/Core/TA.Event","ta/common/Repoll"],function(e,n,o,l,t,r,i,a,s,d,v,u,p,m){"use strict";function c(){_=o("#"+n.id),u.init(_.get(0)),w(),s("responsive-photoviewer").off("overlay-shown",g).on("overlay-shown",g)}function f(){i.tablet()||require(["babel/babel-helpers","overlays/Overlay","overlays/position/fullside","overlays/styles/windowshade","overlays/options/keepInDom","overlays/styles/modal","overlays/options/closeOnWindowshadeClick","overlays/options/slideInOut"],function(e,n,o,l,t,i,a,s){if(!O){var d=_.find(".albums_flyout");O=new n(_.get(0),o.right(),new i(null,null,"second-layer",null,null,d.get(0)),l("dark second-layer"),s("from_right"),a),O.on("hide",function(){if(!N){var e=b();if(e){var n="hero"===e?"detail_view_album_click":"grid_view_album_click";r.recordAlbumDropdownAbandonment(n)}}N=!1})}O.show()})}function b(){var e=o(".small_picker");return e.length?e.attr("data-viewType"):null}function h(e,n,o){O&&(O.destroy(),O=null,N=!0),A.getOrInitRadio(t.getOverlayId()).trigger(l.ALBUM_CHANGE,{albumid:o}),r.recordFilterItemClick(o,n,"album")}function y(e){if(_&&e){var n=_.find(".meta_wrapper");n&&n.remove(),_.append(e),v.initWidgets(_[0]),w()}}function w(){_&&_.find(".poll-in-progress").length&&g()}function g(){k||(k=m({placement:n.name}),k.setPageUrl("/MetaPlacementAjax"),k.setAjaxParamsNoPoll({placementName:n.name,detail:n.location_id,servlet:n.servletName,metaReferer:n.servletName})),k&&k.setNotDone()}var _=void 0,k=void 0,A=d("#"+n.id,c),O=null,N=!1;return a.onOver("tablet",function(){O&&O.hide()}),p.on("update-meta-"+n.name,y),{showAlbumsOverlay:f,albumClicked:h}})});
require(["ta/p13n/placements"],function(e){var l=e.define.bind(e,"pv_resp_navbar_zepto","handlers",["handlers"]);l(["babel/babel-helpers","placement","lib/jquery-amd","photoviewer/models/eventTypes","photoviewer/tracking","utils/responsive","utils/ResponsiveEvents","photoviewer/radioHelper","ta/prwidgets","responsive/text-resizer"],function(e,l,i,n,o,r,t,s,a,d){"use strict";function u(){b=i("#"+l.id),d.init(b.get(0))}function v(){r.tablet()||require(["babel/babel-helpers","overlays/Overlay","overlays/position/fullside","overlays/styles/windowshade","overlays/options/keepInDom","overlays/styles/modal","overlays/options/closeOnWindowshadeClick","overlays/options/slideInOut"],function(e,l,i,n,o,r,t,s){if(!y){var a=b.find(".albums_flyout");y=new l(b.get(0),i.right(),new r(null,null,"second-layer",null,null,a.get(0)),n("dark second-layer"),s("from_right"),t)}y.show()})}function p(e,l,i){y&&(y.destroy(),y=null),c.getRadio().trigger(n.ALBUM_CHANGE,{albumid:i}),o.recordFilterItemClick(i,l,"album")}var b=void 0,c=s("#"+l.id,u),y=null;return t.onOver("tablet",,{showAlbumsOverlay:v,albumClicked:p}})});
define("common/EventBus",["babel/babel-helpers"],function(e){unction t(t){var o=n();switch("undefined"==typeof t?"undefined":e["typeof"](t)){case"boolean":o.dependsOnWebComponents=t;break;case"object":Object.assign(o,t);break;default:console.error("Got unknown WebComponentDispatchOptions:",t)}return o}var o=function(e){if(!e.match(/^[a-z_.-]+[/][a-z_.-]+$/i))throw Error('Event "'+e+'" must namespaced by using the format of "[a-z_.-]+/[a-z_.-]+"')},u=void 0,i="EventBus/WEB-ACK",r="EventBus/TRTOP-ACK",d=s=function e(n,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,u=1===++o;return setTimeout(function(){return c()?n():void(o<=10&&e(n,t,o))},u?0:t),!0},c=function(){return u?u:(u!==!1&&(u=!1,document.addEventListener(r,d)),document.dispatchEvent(new CustomEvent(i,{detail:r})),u)};return{on:function(e,n){o(e),document.addEventListener(e,n)},dispatch:function(e,n){var u=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];o(e);var i=t(u);return i.dependsOnWebComponents?s(function(){return document.dispatchEvent(new CustomEvent(e,{detail:n}))},i.timeoutMs):document.dispatchEvent(new CustomEvent(e,{detail:n}))},remove:});
require(["ta/p13n/placements"],function(e){var t=e.define.bind(e,"pv_resp_right_hand_rail","handlers",["handlers"]);t(["babel/babel-helpers","placement","lib/jquery-amd","ta/Core/TA.FireEvent","common/Radio","photoviewer/radioHelper","photoviewer/models/eventTypes","ta/Core/TA.Store","utils/throttle","common/EventBus"],function(e,t,o,a,r,n,i,d,l,s){function c(){t.servletName===A?h():f()}function f(){require(["babel/babel-helpers","@ta/platform.runtime"],function(e,t){t.importBundle("@ta/taps.ad-photo-album").then(function(){var o=document.getElementsByClassName("pv_rhr"),a=e.slicedToArray(o,1),r=a[0],n="@ta/taps.ad-photo-album",i={refreshKey:_.toString(),pageTypeTargeting:"Restaurants_LocationPhotoAlbum"};document.getElementById(n)&&document.getElementById(n).remove();var d=document.createElement("div");d.id=n,r.appendChild(d),t.createRoot(n,"@ta/taps.ad-photo-album",i)})})}function h(){require(["babel/babel-helpers","@ta/platform.runtime"],function(e,t){t.importBundle("@ta/taps.ad-photo-album-legacy").then(function(){var o=document.getElementsByClassName("pv_rhr"),a=e.slicedToArray(o,1),r=a[0];if(r){var n=document.getElementById(E);if(n)v();else{var i=document.createElement("div");i.id=E,r.appendChild(i),t.createRoot(E,"@ta/taps.ad-photo-album-legacy",{pageTypeTargeting:"Restaurants_LocationPhotoAlbum"})}}})})}function p(){t.servletName===A?u():m()}function m(){++_,_%R===0&&(c(),r("responsive-photoviewer").trigger("refresh-ad"))}function u(){++_,_%y===0&&v()}function v(){s.dispatch("photoalbum/rr_refresh",{})}function g(){w.getRadio().trigger(i.RHR_CLICKED)}function b(){if(!C){c();var e=o("#"+t.id);o(".pv_rhr",e).off("click",g).on("click",g),w.getRadio().off("check-ad-refresh"),w.getRadio().off("force-ad-refresh"),w.getRadio().off("re-initialize-ads"),r("responsive-photoviewer").off("overlay-shown",c),w.getRadio().on("check-ad-refresh",p),t.params.throttleAdRefresh?w.getRadio().on("force-ad-refresh",l(c,5e3)):w.getRadio().on("force-ad-refresh",c),w.getRadio().on("re-initialize-ads",function(){C=!1}),r("responsive-photoviewer").on("overlay-shown",c),a.off("mediaViewerCheckAdRefresh"),a.on("mediaViewerCheckAdRefresh",c),C=!0}}var R=6,y=5,_=0,w=n("#"+t.id,b),C=!1,E="taps-RR-legacy-ad-photo-album",A="Restaurant_Review"})});
require(["ta/p13n/placements"],function(e){var t=e.define.bind(e,"pv_resp_right_hand_rail_zepto","handlers",["handlers"]);t(["babel/babel-helpers","placement","lib/jquery-amd","ta/Core/TA.Event","common/Radio","photoviewer/radioHelper","photoviewer/models/eventTypes","ta/Core/TA.Store","utils/responsive"],function(e,t,o,r,i,a,n,d,l){unction s(){++v,v%h===0&&c()}unction m(){l.desktop()&&require(["babel/babel-helpers","@ta/platform.runtime"],function(e,t){t.importBundle("@ta/attractions.multi-tour-ticket").then(function(){var o=document.getElementById("taplc_location_detail_review_highlight_photo_viewer_0"),r=document.getElementById("attraction_review_no_commerce_placeholder"),i=document.getElementsByClassName("prw_rup prw_photoviewer_sponsored_video"),a=e.slicedToArray(i,1),n=a[0],d="@ta/attractions.multi-tour-ticket";if(!document.getElementById(d)&&n&&!o&&!r){var l=document.createElement("div");l.id=d,l.classList.add("multiTourModuleWrapper"),n.parentNode.insertBefore(l,n.nextSibling),t.createRoot(d,"@ta/attractions.multi-tour-ticket",{showOverlay:!1})}})})}function u(){require(["babel/babel-helpers","@ta/platform.runtime"],function(e,t){t.importBundle("@ta/taps.ad-photo-album").then(function(){var o=document.getElementsByClassName("pv_rhr"),r=e.slicedToArray(o,1),i=r[0],a="@ta/taps.ad-photo-album",n={refreshKey:v.toString(),pageTypeTargeting:"Attractions_LocationPhotoAlbum"};document.getElementById(a)&&document.getElementById(a).remove();var d=document.createElement("div");d.id=a,i.appendChild(d),t.createRoot(a,"@ta/taps.ad-photo-album",n)})})}function f(){if(!_){c();var e=o("#"+t.id);o(".pv_rhr",e).off("click",p).on("click",p),g.getRadio().off("check-ad-refresh"),g.getRadio().off("force-ad-refresh"),g.getRadio().off("re-initialize-ads"),i("responsive-photoviewer").off("overlay-shown",c),g.getRadio().on("check-ad-refresh",s),g.getRadio().on("force-ad-refresh",c),g.getRadio().on("re-initialize-ads",function(){_=!1}),i("responsive-photoviewer").on("overlay-shown",c),r.off("mediaViewerCheckAdRefresh"),r.on("mediaViewerCheckAdRefresh",c),_=!0}}var h=6,v=0,g=a("#"+t.id,f),_=!1})});
define("utils/safeCall",["babel/babel-helpers","vanillajs"],function(n,e){function l(n){if("string"==typeof n){var e=n.split(".");if(e&&e.length>0){for(var l=e.reduce(function(n,e){var l=n?n[e]:null;return l instanceof Function?l.bind(n):l},window),i=arguments.length,r=Array(i>1?i-1:0),t=1;t<i;t++)r[t-1]=arguments[t];return l&&l.apply(void 0,r)}}}return{call:l}});
require(["ta/p13n/placements"],function(e){var o=e.define.bind(e,"responsive_photoviewer","handlers",["handlers"]);o(["babel/babel-helpers","placement","lib/jquery-amd","photoviewer/models/eventTypes","photoviewer/tracking","common/Radio","photoviewer/radioHelper","photoviewer/loader","utils/ajax","utils/safeCall"],function(e,o,n,i,t,r,a,s,d,c){"use strict";function f(e){n("#"+o.id).find(".photoviewerLoading").removeClass("hidden"),C.getRadio().trigger("re-initialize-ads"),"Restaurant_Review"===o.servletName&&r("restaurants-interactions").emit("photo-click-event",e.ff),r("responsive-photoviewer").off("contents-unchanged",v).on("contents-unchanged",v),s.load(n.extend({},o.params,e))}function l(e,i,t){var r=s.buildUrl(n.extend({},o.params,e));d(r,{success:function(e){var o=n(e).find('[data-updateComponent="'+i+'"]');C.getRadio().trigger(i,o.get(0),t)},error:function(){}})}function p(){_||(c.call("performance.mark","responsive-photo-viewer-first-load"),h(),_=!0),C.getRadio().off(R,f).on(R,f),C.getRadio().off(E,l).on(E,l),t.attachResizeTracker()}function v(){n("#"+o.id).find(".photoviewerLoading").addClass("hidden")}function u(){r("responsive-photoviewer").trigger("close")}function h(){g(),r("responsive-photoviewer").off("overlay-shown",g).on("overlay-shown",g),r("responsive-photoviewer").off("overlay-hide",w).on("overlay-hide",w)}function w(){n(document).off("keyup",m)}function g(){n(document).on("keyup",m)}function m(e){switch(e=e||window.event,e.keyCode){case 37:case 39:C.getRadio().emit(i.NAV_KEY_PRESSED,e)}}var R=[i.ALBUM_CHANGE,i.TYPE_CHANGE,i.CATEGORY_CHANGE,i.HERO_PHOTO_CHANGE,i.BACK_TO_GALLERY].join(" "),E=[i.GRID_SCROLLED,i.HERO_THUMBS_REQUESTED].join(" "),_=!1,C=a("#"+o.id,p);return{close:u}})});
require(["ta/p13n/placements"],function(e){var o=e.define.bind(e,"responsive_photoviewer_with_ad","handlers",["handlers"]);o(["babel/babel-helpers","placement","lib/jquery-amd","photoviewer/models/eventTypes","photoviewer/tracking","common/Radio","photoviewer/radioHelper","photoviewer/loader","utils/ajax","utils/safeCall"],function(e,o,n,i,t,r,a,s,d,c){"use strict";function f(e){n("#"+o.id).find(".photoviewerLoading").removeClass("hidden"),C.getRadio().trigger("re-initialize-ads"),"Restaurant_Review"===o.servletName&&r("restaurants-interactions").emit("photo-click-event",e.ff),r("responsive-photoviewer").off("contents-unchanged",v).on("contents-unchanged",v),s.load(n.extend({},o.params,e))}function l(e,i,t){var r=s.buildUrl(n.extend({},o.params,e));d(r,{success:function(e){var o=n(e).find('[data-updateComponent="'+i+'"]');C.getRadio().trigger(i,o.get(0),t)},error:function(){}})}function p(){_||(c.call("performance.mark","responsive-photo-viewer-first-load"),h(),_=!0),C.getRadio().off(R,f).on(R,f),C.getRadio().off(E,l).on(E,l),t.attachResizeTracker()}function v(){n("#"+o.id).find(".photoviewerLoading").addClass("hidden")}function u(){r("responsive-photoviewer").trigger("close")}function h(){g(),r("responsive-photoviewer").off("overlay-shown",g).on("overlay-shown",g),r("responsive-photoviewer").off("overlay-hide",w).on("overlay-hide",w)}function w(){n(document).off("keyup",m)}function g(){n(document).on("keyup",m)}function m(e){switch(e=e||window.event,e.keyCode){case 37:case 39:C.getRadio().emit(i.NAV_KEY_PRESSED,e)}}var R=[i.ALBUM_CHANGE,i.TYPE_CHANGE,i.CATEGORY_CHANGE,i.HERO_PHOTO_CHANGE,i.BACK_TO_GALLERY].join(" "),E=[i.GRID_SCROLLED,i.HERO_THUMBS_REQUESTED].join(" "),_=!1,C=a("#"+o.id,p);return{close:u}})});
require(["ta/p13n/placements"],function(e){var o=e.define.bind(e,"responsive_photoviewer_zepto","handlers",["handlers"]);o(["babel/babel-helpers","placement","lib/jquery-amd","photoviewer/models/eventTypes","photoviewer/tracking","common/Radio","photoviewer/radioHelper","photoviewer/loader","utils/ajax","utils/safeCall"],function(e,o,i,r,t,n,a,s,l,d){"use strict";function p(e){g.getRadio().trigger("re-initialize-ads"),s.load(i.extend({},o.params,e))}function c(e,r,t){l({url:s.buildUrl(i.extend({},o.params,e)),success:function(e){var o=i(e).find('[data-updateComponent="'+r+'"]');g.getRadio().trigger(r,o.get(0),t)},error:function(){}})}function u(){R||(d.call("performance.mark","responsive-photo-viewer-first-load"),R=!0),g.getRadio().off(v,p).on(v,p),g.getRadio().off(E,c).on(E,c),t.attachResizeTracker()}ar v=[r.ALBUM_CHANGE,r.TYPE_CHANGE,r.CATEGORY_CHANGE,r.HERO_PHOTO_CHANGE,r.BACK_TO_GALLERY].join(" "),E=[r.GRID_SCROLLED,r.HERO_THUMBS_REQUESTED].join(" "),R=!1,g=a("#"+o.id,u);return{close:f}})});
