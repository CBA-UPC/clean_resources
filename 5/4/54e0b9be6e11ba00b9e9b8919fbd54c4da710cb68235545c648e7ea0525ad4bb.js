!function(s,a){"use strict";var o=this&&this.__assign||t=(i.hasDebugMode=i.isExternalNavigationEvent=function(t){return!!(t instanceof Object&&"type"in t&&"navigation"===t.type)},i.isExternalCriteriaEvent=function(t){return!(!(t instanceof Object&&"type"in t&&"criteria"===t.type&&"criterias"in t&&Array.isArray(t.criterias))||t.criterias.some()},i.prototype.start=function(){var t=this;this.pushNavigationEvent(),this.pushExternalEvent([]),s.onpopstate=,i.prototype.debug=function(t){this.hasDebug&&console.log("[GRAVITY] ".concat(t))},i.prototype.hasConsent=function(e){return-1!==this.cmpIds.indexOf(String(e.cmpId))&&this.purposesIds.reduce(function(t,n){return t&&!0===e.purpose.consents[n]},!0)&&this.vendorsIds.filter(.reduce(function(t,n){return t&&!0===e.vendor.consents[n]},!0)},i.prototype.identifyUser=function(t,n){var e=this;if(this.identifyingUser){var i="Xandr ID already loading";return this.debug(i),void n(new Error(i))}if(this.identifyingUserSuccess)return this.debug("Xandr ID already loaded"),void n(null);this.identifyingUser=!0;var i=null!==(i=null===(i=null===(i=s.__gravity)||void 0===i?void 0:i.userIdentifierHolder)||void 0===i?void 0:i.findVectorIdLongValue())&&void 0!==i?i:"0",i="https://id.agrvt.com/generate.gif?".concat(["hostname=".concat(encodeURIComponent(s.location.hostname)),"tc_string_v2=".concat(encodeURIComponent(t.tcString)),"xandr_id=$UID","mediarithmics_id=".concat(i),"t=".concat(Date.now()),"v=".concat(this.version)].join("&")),i="https://secure.adnxs.com/getuid?".concat(encodeURIComponent(i)),o=new s.Image(1,1);o.onload=function(){e.identifyingUser=!1,e.identifyingUserSuccess=!0,e.debug("Gravity ID pixel loaded successfully"),o.remove(),n(null)},o.onerror=function(t){e.identifyingUser=!1,e.identifyingUserSuccess=!1;t="string"==typeof t?t:"Gravity ID pixel loading error";e.debug(t),o.remove(),n(new Error(t))},o.src=i,a.body.appendChild(o)},i.prototype.pushInternalEvent=function(e){var i=this;this.getConsentData(function(t,n){t?i.debug("Get TCF Data error: ".concat(t.message)):n?i.hasConsent(n)?(i.internalEvents.push(o(o({},e),{tcString:n.tcString})),i.identifyUser(n,function(t){t?i.debug("User identification error: ".concat(t.message)):i.logGravityEvents()})):i.debug("No consent for event: cmpId='".concat(n.cmpId,"', purposes=[").concat(Object.keys(null!==(t=null===(t=null==n?void 0:n.purpose)||void 0===t?void 0:t.consents)&&void 0!==t?t:{}).join(","),"], vendors=[").concat(Object.keys(null!==(n=null===(n=null==n?void 0:n.vendor)||void 0===n?void 0:n.consents)&&void 0!==n?n:{}).join(","),"]")):i.debug("Missing TCF Data")})},i.prototype.getConsentData=function(e){var i=this;if(this.gettingConsentData)e(new Error("Already running get TCF data"));else{this.gettingConsentData=!0;var o=function(t){i.gettingConsentData=!1,i.debug("Get TCF data retry reason='".concat(t.message,"'")),setTimeout(100)},t=s.__tcfapi;if(!Object.hasOwnProperty.call(s,"__tcfapi")||void 0===t)return this.gettingConsentData=!1,void o(new Error("Missing TCF API global variable"));var r=!1;t("getTCData",2,function(t,n){i.gettingConsentData=!1,r||(r=!0,n?null==t?o(new Error("No TCF data returned")):"loaded"===t.cmpStatus&&["tcloaded","useractioncomplete"].includes(t.eventStatus)?e(null,t):o(new Error("CMP not loaded or no user choice picked")):o(new Error("Get TCF data call error")))},this.vendorsIds)}},i.prototype.pushNavigationEvent=function(){this.pushInternalEvent({type:"navigation",url:"".concat(s.location.origin).concat(s.location.pathname)})},i.prototype.pushCriteriaEvent=function(t,n){this.pushInternalEvent({type:"criteria",hostname:s.location.hostname,criterias:t.join(","),email:null!=n?n:null})},i.prototype.logGravityEvents=function(){var e,i=this;if(this.identifyingUserSuccess)for(var o=void 0,r=this;void 0!==(o=this.internalEvents.shift());)!function(){var t="",t="criteria"===o.type?(r.debug("Logging criteria event for hostaname ".concat(o.hostname)),"https://events.agrvt.com/collect_criteria?".concat(["criterias=".concat(encodeURIComponent(o.criterias)),"hostname=".concat(encodeURIComponent(o.hostname)),"email=".concat(encodeURIComponent(null!==(e=o.email)&&void 0!==e?e:"")),"tc_string_v2=".concat(encodeURIComponent(o.tcString)),"t=".concat(Date.now()),"v=".concat(r.version)].join("&"))):(r.debug("Logging navigation event for URL ".concat(o.url)),"https://events.agrvt.com/collect_navigation?".concat(["url=".concat(encodeURIComponent(o.url)),"tc_string_v2=".concat(encodeURIComponent(o.tcString)),"t=".concat(Date.now()),"v=".concat(r.version)].join("&"))),n=new s.Image(1,1);n.onload=function(){i.debug("Event collection pixel loaded successfully"),n.remove()},n.onerror=n.src=t,a.body.appendChild(n)}();else this.debug("User has not been identified yet")},i.prototype.wrapExternalEventsArrayPush=function(e){var i=this;e.push=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return i.pushExternalEvent(t),e.length}},i.prototype.pushExternalEvent=function(t){var n=this;Array.prototype.push.apply(this.externalEvents,t),this.externalEvents.filter(.forEach(function(t){switch(t.type){case"criteria":n.pushCriteriaEvent(t.criterias);break;case"navigation":n.pushNavigationEvent()}}),this.externalEvents.length=0},i);function i(t){var n=void 0===t?{}:t,e=n.vendorsIds,t=n.purposesIds,n=n.cmpIds;this.version=101,this.hasDebug=i.hasDebugMode(s.location),this.vendorsIds=null!=e?e:[501,32,755],this.purposesIds=null!=t?t:[1,2,3,4,7,9],this.cmpIds=null!=n?n:["10","104","105","112","113","123","125","129","134","14","141","162","165","167","168","170","171","18","181","183","185","193","198","2","21","212","213","217","218","221","222","224","225","227","229","23","231","235","236","237","242","246","247","25","252","258","259","260","264","27","273","277","279","28","280","282","284","287","291","292","294","297","299","3","30","300","302","303","304","305","306","307","308","309","31","310","311","312","316","318","319","321","322","323","327","329","330","332","335","338","339","340","341","343","345","348","35","350","351","352","353","354","355","358","359","360","361","363","364","367","369","371","372","373","374","376","378","379","38","380","382","383","384","385","386","387","388","390","391","392","393","396","397","399","401","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","44","45","46","47","5","50","54","58","59","6","61","63","65","68","69","7","72","76","77","79","84","9","90","92","96"],this.identifyingUser=!1,this.identifyingUserSuccess=!1,this.gettingConsentData=!1,this.internalEvents=[],this.externalEvents=[],Array.isArray(s.grvt_events)&&0<s.grvt_events.length&&((n=this.externalEvents).push.apply(n,s.grvt_events),s.grvt_events.length=0),s.grvt_events=this.externalEvents,this.wrapExternalEventsArrayPush(this.externalEvents)}(s.grvt_tag=new t).start()}(window,document);