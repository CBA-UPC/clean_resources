(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[604],{"8KAq":function(e,n,l){"use strict";l.r(n),l.d(n,"SidePopupMenuModuleNgFactory",();var t=l("keVe"),o=l("55A9"),u=(l("nFwq"),function(){function e(e,n){var l=this;this.sidePopupMenuService=e,this.eRef=n,this.MENU_TYPE_FORMSMOVE=0,e.sidePopupMenuEmitter.subscribe((function(e){l.sidePopupMenuModel=e}))}return e.prototype.clickout=function(e){this.sidePopupMenuModel&&this.sidePopupMenuModel.isShown&&!this.eRef.nativeElement.contains(e.target)&&(this._popupOutsideListenerState?this.closeSideMenu():this._popupOutsideListenerState=!0,e.preventDefault())},e.prototype.closeSideMenu=function(){this.sidePopupMenuService.sidePopupMenuEmitter.next({type:1,isShown:!1}),this._popupOutsideListenerState=!1},e}()),i=u,s=),r=l("fYis"),c=l("pzhl"),p=l("PkQn"),a=l("4/We"),m=l("TOqr"),d=l("lUkk"),f=l("hhzZ"),b=l("7Gwk"),h=l("TDzr"),g=l("PBJH"),M=l("24t9"),v=(l("cHtN"),function(){function e(e,n,l,o){this.formsService=e,this.eventService=n,this.locService=l,this.instrumentationService=o,this.closeEmitter=new t.q,this.groupThumbnailLoadMap={},this.Success=1,this.Failed=2,this.selectedIndex=0}return e.prototype.ngAfterViewInit=function(){this.dismissIcon=document.getElementById("forms-group-panel__close-button"),this.moveButton=document.getElementById("forms-group-panel__move-button");var e=document.getElementById("forms-group-item-"+this.selectedIndex);e?setTimeout((,500):this.dismissIcon&&this.dismissIcon.focus()},e.prototype.ngOnInit=function(){var e=this;this.formsGroupMenuModel={menuTitle:this.locService.MoveItemLabel,menuSubtitle:this.sidePopupMenuModel.movingFileItem.fileName,selectorTitle:this.locService.MoveItemSublabel,selections:[],moveButtonLabel:this.locService.MoveButtonLabel,dismissButton:this.locService.Dismiss},this.formsGroupsSubscription=this.formsService.getFormsGroups().results.subscribe((function(n){e.formsGroupMenuModel.selections=n.value.filter((),e.formsGroupMenuModel.selections.forEach((function(n){e.formsService.getFormGroupThumbnailUrl(n.id).then(()})),e.selectedGroup=e.formsGroupMenuModel.selections[e.selectedIndex]}))},e.prototype.ngOnDestroy=e.prototype.onloadGroupThumbnail=e.prototype.onClickFormsGroupMenuItem=e.prototype.trackByFunction=e.prototype.onClickClose=e.prototype.onClickMove=function(){this.onClickClose(),this.instrumentationService.logClickEvent("Group_SideMenu_Move_Click",this.sidePopupMenuModel.movingFileItem.fileTypeName,f.b.SideMenu),Object(d.a)({id:this.sidePopupMenuModel.movingFileItem.fileTypeName,result:"Move",target:"GroupSideMenu",eventName:"Group_SideMenu_Move_Click",area:"SideMenu"}),this.sidePopupMenuModel.resolveMoveModel({moveTargetId:this.selectedGroup.id,moveTargetName:this.selectedGroup.displayName})},e.prototype.onKeyDownOnSideMenu=function(e){switch(M.a.getKey(e)){case 3:this.closeEmitter.emit(),e.preventDefault();break;case 1:e.shiftKey?document.activeElement===this.dismissIcon&&this.moveButton&&(this.moveButton.focus(),e.preventDefault()):document.activeElement===this.moveButton&&this.dismissIcon&&(this.dismissIcon.focus(),e.preventDefault());break;default:return}},e.prototype.onKeyDownOnGroupSelector=function(e){var n=M.a.getKey(e),l=this.formsGroupMenuModel.selections.length-1;switch(n){case 4:this.selectedIndex=this.selectedIndex>0?this.selectedIndex-1:l;break;case 5:this.selectedIndex=this.selectedIndex===l?0:this.selectedIndex+1;break;case 32:case 2:this.selectedIndex=Number(e.target.dataset.itemindex);break;default:return}e.preventDefault(),this.selectedGroup=this.formsGroupMenuModel.selections[this.selectedIndex],document.getElementById("forms-group-item-"+this.selectedIndex).focus()},e}()),_=t.Fb({encapsulation:2,styles:[],data:{}});function k(e){return t.jc(0,[(e()(),t.Hb(0,0,null,null,1,"ohp-icon-font",[["class","forms-group-panel__selector__item--placeholder ms-bgc-tp"],["cssClass","ms-ohp-svg-Icon ms-ohp-Icon--group forms-group-panel__selector__item__thumbnail--icon"],["size","20"]],null,null,null,c.b,c.a)),t.Gb(1,638976,null,0,p.a,[a.a],{cssClass:[0,"cssClass"],size:[1,"size"]},null)],(,null)}function y(e){return t.jc(0,[(e()(),t.Hb(0,0,null,null,0,"img",[["alt",""]],[[8,"src",4]],[[null,"error"],[null,"load"]],(function(e,n,l){var t=!0,o=e.component;return"error"===n&&(t=!1!==o.onloadGroupThumbnail(e.parent.context.$implicit.id,o.Failed)&&t),"load"===n&&(t=!1!==o.onloadGroupThumbnail(e.parent.context.$implicit.id,o.Success)&&t),t}),null,null))],null,()}function I(e){return t.jc(0,[(e()(),t.Hb(0,0,null,null,9,"li",[["class","forms-group-panel__selector__item list-item--shadowed list-item--shadowed--bg-hover"],["role","tab"]],[[1,"aria-labelledby",0],[8,"id",0],[1,"data-itemindex",0],[1,"aria-selected",0],[8,"tabIndex",0]],[[null,"click"]],(,null,null)),t.Gb(1,278528,null,0,m.i,[t.x,t.y,t.o,t.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),t.Zb(2,{"selected-item":0}),(e()(),t.Hb(3,0,null,null,4,"div",[["class","forms-group-panel__selector__item__thumbnail"]],null,null,null,null,null)),(e()(),t.qb(16777216,null,null,1,null,k)),t.Gb(5,16384,null,0,m.k,[t.W,t.S],{ngIf:[0,"ngIf"]},null),(e()(),t.qb(16777216,null,null,1,null,y)),t.Gb(7,16384,null,0,m.k,[t.W,t.S],{ngIf:[0,"ngIf"]},null),(e()(),t.Hb(8,0,null,null,1,"div",[["class","forms-group-panel__selector__item__name"]],[[8,"id",0]],null,null,null,null)),(e()(),t.gc(9,null,[" "," "]))],(function(e,n){var l=n.component,t=e(n,2,0,l.selectedIndex===n.context.index);e(n,1,0,"forms-group-panel__selector__item list-item--shadowed list-item--shadowed--bg-hover",t),e(n,5,0,!n.context.$implicit.thumbnailUrl||l.groupThumbnailLoadMap[n.context.$implicit.id]!==l.Success),e(n,7,0,n.context.$implicit.thumbnailUrl)}),(function(e,n){var l=n.component;e(n,0,0,"forms-group-"+n.context.index,t.Ob(1,"","forms-group-item-"+n.context.index,""),n.context.index,l.selectedIndex===n.context.index,t.Ob(1,"",l.selectedIndex===n.context.index?0:-1,"")),e(n,8,0,t.Ob(1,"","forms-group-"+n.context.index,"")),e(n,9,0,n.context.$implicit.displayName)}))}function x(e){return t.jc(0,[(e()(),t.Hb(0,0,null,null,19,"div",[["class","forms-group-panel"],["role","dialog"]],[[1,"aria-label",0]],[[null,"keydown"]],(function(e,n,l){var t=!0;return"keydown"===n&&(t=!1!==e.component.onKeyDownOnSideMenu(l)&&t),t}),null,null)),(e()(),t.Hb(1,0,null,null,8,"div",[["class","forms-group-panel__menu"]],null,null,null,null,null)),(e()(),t.Hb(2,0,null,null,4,"div",[["class","forms-group-panel__menu__title"]],null,null,null,null,null)),(e()(),t.Hb(3,0,null,null,1,"h1",[],null,null,null,null,null)),(e()(),t.gc(4,null,[" "," "])),(e()(),t.Hb(5,0,null,null,1,"h2",[["class","forms-group-panel__menu__subtitle"]],null,null,null,null,null)),(e()(),t.gc(6,null,[" "," "])),(e()(),t.Hb(7,0,null,null,2,"div",[["class","dismiss-container"],["id","forms-group-panel__close-button"],["role","button"],["tabindex","0"]],[[1,"aria-label",0]],[[null,"click"],[null,"keyup.enter"],[null,"keyup.space"]],(,null,null)),(e()(),t.Hb(8,0,null,null,1,"ohp-icon-font",[["iconFontName","X2"],["size","18"]],null,null,null,c.b,c.a)),t.Gb(9,638976,null,0,p.a,[a.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null),(e()(),t.Hb(10,0,null,null,1,"div",[["class","forms-group-panel__selector__title"],["id","forms-group-panel-selectortitle"]],null,null,null,null,null)),(e()(),t.gc(11,null,[" "," "])),(e()(),t.Hb(12,0,null,null,2,"ul",[["aria-labelledby","forms-group-panel-selectortitle"],["class","forms-group-panel__selector"],["id","forms-group-panel__selector"],["role","tablist"]],null,[[null,"keydown"]],(,null,null)),(e()(),t.qb(16777216,null,null,1,null,I)),t.Gb(14,278528,null,0,m.j,[t.W,t.S,t.x],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null),(e()(),t.Hb(15,0,null,null,4,"div",[["class","forms-group-panel__move"]],null,null,null,null,null)),(e()(),t.Hb(16,0,null,null,3,"button",[["class","forms-group-panel__move__button generic-button generic-button--fluent generic-button--fluent--primary ms-bgc-w-h ms-bgc-w-a ms-fcl-w ms-bgc-tp ms-fcl-tp-h ms-fcl-tp-a"],["id","forms-group-panel__move-button"]],[[8,"disabled",0]],[[null,"click"]],(function(e,n,l){var t=!0;return"click"===n&&(t=!1!==e.component.onClickMove()&&t),t}),null,null)),t.Gb(17,278528,null,0,m.i,[t.x,t.y,t.o,t.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),t.Zb(18,{"generic-button--disabled--grey":0}),(e()(),t.gc(19,null,[" "," "]))],(function(e,n){var l=n.component;e(n,9,0,"cursor--pointer","X2","18"),e(n,14,0,l.formsGroupMenuModel.selections,l.trackByFunction);var t=e(n,18,0,!l.selectedGroup);e(n,17,0,"forms-group-panel__move__button generic-button generic-button--fluent generic-button--fluent--primary ms-bgc-w-h ms-bgc-w-a ms-fcl-w ms-bgc-tp ms-fcl-tp-h ms-fcl-tp-a",t)}),(function(e,n){var l=n.component;e(n,0,0,l.formsGroupMenuModel.menuTitle),e(n,4,0,l.formsGroupMenuModel.menuTitle),e(n,6,0,l.formsGroupMenuModel.menuSubtitle),e(n,7,0,l.formsGroupMenuModel.dismissButton),e(n,11,0,l.formsGroupMenuModel.selectorTitle),e(n,16,0,!l.selectedGroup),e(n,19,0,l.formsGroupMenuModel.moveButtonLabel)}))}var G=t.Db("ohp-forms-group-menu",v,(function(e){return t.jc(0,[(e()(),t.Hb(0,0,null,null,1,"ohp-forms-group-menu",[],null,null,null,x,_)),t.Gb(1,4440064,null,0,v,[h.a,b.a,g.a,f.a],null,null)],(,null)}),{sidePopupMenuModel:"sidePopupMenuModel"},{closeEmitter:"closeEmitter"},[]),S=t.Fb({encapsulation:2,styles:[],data:{}});function w(e){return t.jc(0,[(e()(),t.Hb(0,0,null,null,1,"ohp-forms-group-menu",[],null,[[null,"closeEmitter"]],(,x,_)),t.Gb(1,4440064,null,0,v,[h.a,b.a,g.a,f.a],{sidePopupMenuModel:[0,"sidePopupMenuModel"]},{closeEmitter:"closeEmitter"})],(,null)}function C(e){return t.jc(0,[(e()(),t.Hb(0,0,null,null,2,"div",[["class","side-menu"],["id","side-popup-menu"]],null,null,null,null,null)),(e()(),t.qb(16777216,null,null,1,null,w)),t.Gb(2,16384,null,0,m.k,[t.W,t.S],{ngIf:[0,"ngIf"]},null)],(function(e,n){var l=n.component;e(n,2,0,l.sidePopupMenuModel.type===l.MENU_TYPE_FORMSMOVE)}),null)}function E(e){return t.jc(0,[(e()(),t.qb(16777216,null,null,1,null,C)),t.Gb(1,16384,null,0,m.k,[t.W,t.S],{ngIf:[0,"ngIf"]},null)],(,null)}var P=t.Db("ohp-side-popup-menu",u,(function(e){return t.jc(0,[(e()(),t.Hb(0,0,null,null,1,"ohp-side-popup-menu",[],null,[["document","click"]],(,E,S)),t.Gb(1,49152,null,0,u,[o.a,t.o],null,null)],null,null)}),{},{},[]),F=l("+P5Z"),T=l("xIlw"),H=l("+a0u"),U=l("lQwO"),O=l("CfLe"),B=l("ej7j"),D=l("X+PR"),N=l("VY7U"),j=l("CCRL"),L=t.Eb(s,[],(function(e){return t.Tb([t.Ub(512,t.k,t.hb,[[8,[r.a,P,G]],[3,t.k],t.D]),t.Ub(4608,m.m,m.l,[t.z]),t.Ub(1073742336,m.c,m.c,[]),t.Ub(1073742336,F.a,F.a,[]),t.Ub(1073742336,T.a,T.a,[]),t.Ub(1073742336,H.a,H.a,[]),t.Ub(1073742336,U.a,U.a,[]),t.Ub(1073742336,O.a,O.a,[]),t.Ub(1073742336,B.a,B.a,[]),t.Ub(1073742336,D.o,D.o,[[2,D.u],[2,D.n]]),t.Ub(1073742336,N.a,N.a,[]),t.Ub(1073742336,s,s,[]),t.Ub(256,j.a,i,[])])}))}}]);
//# sourceMappingURL=side-popup-menu.95be04f4d73cc1716310.chunk.v7.js.map