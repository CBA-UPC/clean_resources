(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4727],{11446:38445:function(e,t,a){"use strict";var r=a(52322),n=a(78066);t.Z=e=>{let{name:t,logo:a,handleNext:o,...s}=e;return(0,r.jsxs)(n.Z,{containerClass:"mt-5",title:"Add engagement fields to ".concat(t),nextButton:(0,r.jsxs)("button",{className:"btn-white justify-center bg-white font-medium shadow",onClick:o,children:[(0,r.jsx)(a,{className:"mr-2"}),"Automap fields"]}),...s,children:[(0,r.jsxs)("div",{className:"rounded-md border bg-gray-50 px-4 py-3 text-sm shadow-sm",children:[(0,r.jsx)("div",{className:"mb-1 font-medium",children:"Fields successfully created"}),(0,r.jsxs)("div",{children:["The Navattic engagement fields have been added to your ",t," instance."]})]}),(0,r.jsx)("div",{className:"mt-5 text-base font-medium",children:"Auto-map new fields"}),(0,r.jsxs)("div",{className:"mt-1 text-sm text-gray-500",children:["Automatically connect these new ",t," fields to the corresponding Navattic engagement fields."]})]})}},13710:function(e,t,a){"use strict";var r=a(52322),n=a(2784),o=a(99219),s=a(61807),i=a(78066),l=a(73022),c=a(77512);t.Z=function(e){let{error:t,name:a,logo:d,handleNext:p,allowedFields:m,children:f,loading:g,...h}=e,[b,x]=(0,n.useState)(new Set);return(0,n.useEffect)(()=>{x(m.reduce(new Set))},[m]),(0,r.jsx)(i.Z,{containerClass:"mt-5",title:"Add engagement fields to ".concat(a),nextButton:g?(0,r.jsx)(s.Z,{}):(0,r.jsxs)("button",{className:"btn-white justify-center bg-white font-medium shadow",onClick:children:[(0,r.jsx)(d,{className:"mr-2"}),"Create Fields"]}),...h,children:(0,r.jsxs)("div",{className:"-mt-2 space-y-4",children:[t&&(0,r.jsx)("div",{className:"space-x-2 rounded border bg-gray-50 px-4 py-3 text-sm text-rose-900",children:t}),(0,r.jsx)("div",{className:"space-y-1.5",children:m.map(e=>{let t=e.type===l.J.NUMBER?o.yEv:o.Rhe;return(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)(c.XZ,{name:e.name,checked:b.has(e.name),onChange:t=>{var a,r;t?(a=e.name,x(e=>{let t=new Set(e);return t.add(a),t})):(r=e.name,x()}}),(0,r.jsxs)("div",{className:"flex w-full items-center rounded border px-3 py-2 text-[12px] text-gray-700 shadow-sm",children:[(0,r.jsx)("div",{className:"mr-3 rounded bg-gray-600",children:(0,r.jsx)(t,{className:"h-3.5 w-3.5 text-white"})}),e.name]})]},e.name)})}),f]})})}},40761:function(e,t,a){"use strict";a.d(t,{Z:function(){return QuickSetupCollapse}});var r=a(52322),n=a(37100);function QuickSetupCollapse(e){let{objectName:t,logo:a,integrationName:o,onClick:s}=e;return(0,r.jsxs)(n.Z,{title:(0,r.jsxs)("div",{className:"flex items-center",children:["Quick Setup",(0,r.jsx)("div",{className:"ml-3 rounded border bg-gray-50 px-1 text-[13px] leading-5 text-gray-600",children:t})]}),className:"mt-5 overflow-hidden rounded-md border border-gray-200",children:[(0,r.jsxs)("div",{className:"text-sm leading-relaxed text-gray-500",children:["Create Navattic engagement fields on your ",o," instance. You'll have an option to select which fields to create."]}),(0,r.jsxs)("button",{onClick:s,className:"btn-white mt-4 w-full justify-center bg-white font-medium shadow",children:[(0,r.jsx)(a,{className:"mr-2"}),"Auto-create engagement fields"]})]})}},78066:function(e,t,a){"use strict";a.d(t,{Z:function(){return Modal}});var r=a(52322),n=a(2784),o=a(68810),s=a(64529),i=a(83122),l=a(82002),c=a(89370);}},6059:function(e,t,a){"use strict";a.d(t,{Z:function(){return Radio}});var r=a(52322),n=a(81436),o=a(83122);let getFirstItemBorderClass=e=>"vertical"===e?"rounded-tl-md rounded-tr-md":"rounded-tl-md rounded-bl-md",getLastItemBorderClas";function Radio(e){let{items:t,value:a,label:s,name:i,onChange:l,className:c,orientation:d="vertical"}=e;return(0,r.jsxs)(n.E,{name:i,value:a,onChange:l,className:c,children:[s&&(0,r.jsx)(n.E.Label,{className:"label-small",children:s}),(0,r.jsx)("div",{className:(0,o.AK)("mt-1 rounded-md bg-white shadow-sm","vertical"===d?"-space-y-px":"","horizontal"===d&&"flex w-fit flex-row -space-x-px"),children:t.map((e,a)=>(0,r.jsx)(n.E.Option,{value:e.value,className:e=>{let{checked:r}=e;return(0,o.AK)(0===a?getFirstItemBorderClass(d):"",a===t.length-1?getLastItemBorderClass(d):"",r?"z-10 border-gray-300 bg-gray-50":"border-gray-200","vertical"===d?"p-4":"px-4 py-2","relative flex cursor-pointer items-center border focus:outline-none")},children:t=>{let{active:a,checked:s}=t;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:(0,o.AK)(s?"bg-blue-primary border-transparent":"border-gray-300 bg-white",a?"ring-2 ring-blue-500 ring-offset-2":"","flex h-3 w-3 shrink-0 cursor-pointer items-center justify-center rounded-full border"),"aria-hidden":"true",children:(0,r.jsx)("span",{className:"h-1.5 w-1.5 rounded-full bg-white"})}),(0,r.jsxs)("div",{className:"ml-3 flex w-full items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(n.E.Label,{as:"span",className:"block text-sm font-medium text-gray-900",children:e.name}),s&&(0,r.jsx)(n.E.Description,{as:"span",className:(0,o.AK)(s?"text-gray-600":"text-gray-500","block text-sm"),children:e.description})]}),e.Icon&&(0,r.jsx)(e.Icon,{className:"ml-2 shrink-0"})]})]})}},e.value))})]})}},199},18074:function(e,t,a){"use strict";a.r(t),a.d(t,{__N_SSP:function(){return L},default:function(){return Z}});var r=a(52322),n=a(99219),o=a(2784),s=a(27425),i=a(32517),l=a(77815),c=a(83122),use_load_sobject_fields=e=>{let{webhookId:t,sobject:a,onError:r}=e,[n,s]=(0,o.useState)(!1),[i,l]=(0,o.useState)([]);return(0,o.useEffect)(()=>{t&&(s(!0),fetch("/api/integration/salesforce/fields?id=".concat(t,"&sobject=").concat(a)).then(async e=>{if(s(!1),e.ok){let t=await e.json();l(t.sobjectFields)}else r("Could not retrieve fields for ".concat(a))}))},[t,a,r]),{fetching:n,fields:i}},d=a(47128),p=a(91077),m=a(73022),f=a(77262);let addEntryToFieldMa),removeEntryFromFieldMap=(e,t)=>{let{[t]:a,...r}=e||{};return r},setSelectedSObject=(e,t)=>"Lead"===t?{...e,sobject:t}:{...e,sobject:t,syncToContact:!1},salesforceConfigReducer=(e,t)=>{var a,r;switch(t.type){case"set-selected-sobject":return setSelectedSObject(e,t.payload);case"set-sync-to-contact":if("Contact"===e.sobject||"Account"===e.sobject)break;return{contactConfig:{sobject:"Contact"},...e,syncToContact:t.payload};case"update-field-map":return{...e,fieldMap:t.payload};case"update-contact-field-map":return{...e,contactConfig:{...e.contactConfig,sobject:"Contact",fieldMap:t.payload}};case"add-field-map-entry":return{...e,fieldMap:addEntryToFieldMap(e.fieldMap,t.payload.key,t.payload.value)};case"remove-field-map-entry":return{...e,fieldMap:removeEntryFromFieldMap(e.fieldMap,t.payload)};case"set-create":return{...e,create:t.payload};case"set-update":return{...e,update:t.payload};case"contact-config-add-field-map-entry":if("Lead"===e.sobject)return{...e,contactConfig:{...e.contactConfig,sobject:"Contact",fieldMap:addEntryToFieldMap(null===(a=e.contactConfig)||void 0===a?void 0:a.fieldMap,t.payload.key,t.payload.value)}};console.warn("Cannot add field map entry for Salesforce Contact");break;case"contact-config-remove-field-map-entry":if("Lead"===e.sobject)return{...e,contactConfig:{...e.contactConfig,sobject:"Contact",fieldMap:removeEntryFromFieldMap(null===(r=e.contactConfig)||void 0===r?void 0:r.fieldMap,t.payload)}};console.warn("Cannot remove field map entry for Salesforce Contact");break;case"update-company-field-mappings":return{...e,companyFieldMappings:t.payload}}return e},addFieldToMap=e=>{let{dispatch:t,field:a,type:r}=e,n=(0,f.zi)(a.name);switch(a.label){case m.Rz.FLOW_ID:t({type:r,payload:{key:"last_viewed_flow_id",value:n}});break;case m.Rz.FLOW_TITLE:t({type:r,payload:{key:"last_viewed_flow_name",value:n}});break;case m.Rz.PROJECT_ID:t({type:r,payload:{key:"last_viewed_project_id",value:n}});break;case m.Rz.PROJECT_TITLE:t({type:r,payload:{key:"last_viewed_project_name",value:n}});break;case m.Rz.STEP_ID:t({type:r,payload:{key:"last_viewed_step_id",value:n}});break;case m.Rz.STEP_TITLE:t({type:r,payload:{key:"last_viewed_step_name",value:n}});break;case m.Rz.STEP_NUMBER:t({type:r,payload:{key:"last_viewed_step_number",value:n}})}};var g=a(40761),h=a(56268);let upsertSObjectFields=async e=>{let{webhookId:t,...a}=e,r=await fetch("/api/integration/salesforce/fields?id=".concat(t),{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}}),n=await r.json();return n};var b=a(5001);let fetchProfiles=async e=>{let{webhookId:t,sobjectName:a}=e,r=await fetch("/api/integration/salesforce/permissions?id=".concat(t,"&sobject=").concat(a));if(!r.ok){let e=await r.json();return{error:e.error,profiles:[]}}let n=await (async()=>{try{let e=await r.text(),t=JSON.parse(e);return t}catch(e){return console.error(e),{error:"".concat(e),profiles:[]}}})();return n},syncSalesforceProfiles=async e=>{let{webhookId:t,sobject:a,addProfiles:r,removeProfiles:n,fields:o}=e,s=await fetch("/api/integration/salesforce/permissions?id=".concat(t),{method:b.Z.POST,headers:{"Content-Type":"application/json"},body:JSON.stringify({sobject:a,addProfiles:r,removeProfiles:n,fields:o})});if(!s.ok){let e=await s.json();return{error:e.error}}let i=await s.json(),{profiles:l}=i;return{profiles:l,error:void 0}};var use_load_salesforce_profiles=e=>{let{webhookId:t,sobject:a}=e,[r,n]=(0,o.useState)(!0),[s,i]=(0,o.useState)([]),[l,c]=(0,o.useState)();return(0,o.useEffect)(()=>{let e=!0;return fetchProfiles({webhookId:t,sobjectName:a}).then(async t=>{await (async()=>{if(!e)return;let{profiles:a}=t;if(0===a.length){c("Unable to fetch profiles");return}if(0===a.length){c("Could not query permission profiles");return}i(a)})(),n(!1)}),()=>{e=!1}},[a,t]),(0,o.useMemo),[r,s,l])},x=a(38445),v=a(13710),y=a(77512);let profilesReducer=(e,t)=>{let{profilesChecked:a,profiles:r}=e;switch(t.type){case"init":r=Object.fromEntries(t.profiles.ma])),a=Object.fromEntries(t.profiles.ma]));break;case"set-checked":a={...a,[t.fullName]:t.checked};break;case"check-all":a=Object.keys(a).reduce((e,t)=>({...e,[t]:!0}),{});break;case"check-none":a=Object.keys(a).reduc),{})}return{profiles:r,profilesChecked:a}},ProfileEntry=e=>{let{fullName:t,checked:a,onChange:n}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(y.XZ,{name:t,checked:a,onChange:n,className:"mr-4"}),(0,r.jsx)("span",{className:"text-sm font-medium text-gray-600",children:decodeURIComponent(t)})]})};var Configuration_SalesforceProfileConfig=e=>{let{profilesState:t,dispatch:a,loadingProfiles:o}=e,{profiles:s,profilesChecked:i}=t,l=Object.values(s).ma}).sort(),c=Object.values(i).evere);return(0,r.jsx)("div",{className:"max-h-48 overflow-auto rounded border border-gray-100",children:o?(0,r.jsx)("div",{className:"flex h-52 w-full items-center",children:(0,r.jsx)(n.L4p,{className:"m-auto text-gray-200"})}):(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"sticky top-0 z-10 border-b border-gray-100 bg-white px-4 py-3",children:(0,r.jsx)(y.XZ,{name:"select-all",labelText:"Select all profiles",checked:c,onChange:()=>{c?a({type:"check-none"}):a({type:"check-all"})}})}),(0,r.jsx)("ul",{role:"list",className:"divide-y divide-gray-200 border-gray-200 text-base",children:l.map(e=>(0,r.jsx)("li",{className:"group mb-0 flex items-center px-4 py-3",children:(0,r.jsx)(ProfileEntry,{checked:i[e],onChang},fullName:e})},e))})]})})};function formatToSalesforceFields(e){return e.map(e=>{let t=e.type===m.J.STRING?(0,f.FS)(e):e.label===m.Rz.STEP_NUMBER?(0,f.Gd)({...e,scale:0,precision:5}):(0,f.C7)(e);return{inlineHelpText:e.description,...e,...t}})}function SalesforceQuickSetup(e){let{webhook:t,objectName:a,integrationName:n,logo:s,autoMapField:l}=e,[c,d]=(0,o.useState)(!1),[p,f]=(0,o.useState)(!1),[b,y]=(0,o.useState)([]),[j,w]=(0,o.useState)(!1),{fetching:S,profiles:N,error:C}=use_load_salesforce_profiles({webhookId:t.id,sobject:a}),[k,R]=(0,o.useReducer)(profilesReducer,{profiles:{},profilesChecked:{}});(0,o.useEffect},[S,N]);let handleUpdateProfilePermissions=async e=>{let r=Object.keys(k.profilesChecked).filter(e=>k.profilesChecked[e]),n=await syncSalesforceProfiles({webhookId:t.id,sobject:a,fields:formatToSalesforceFields(e),addProfiles:r,removeProfiles:[]});if(n.error){(0,i.Rn)("Could not update profile permissions: ".concat(n.error));return}},createFieldsOnPlatform=async e=>{let r=await upsertSObjectFields({webhookId:t.id,sobject:a,fields:formatToSalesforceFields(e)});return await handleUpdateProfilePermissions(e),r},E=(0,o.useMemo)(()=>m.VG.filte)),[]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.Z,{objectName:a,logo:s,integrationName:n,onClic)}),(0,r.jsx)(v.Z,{name:n,logo:s,handleNext:function(e){w(!0);let t=m.VG.filter(t=>e.includes(t.name));createFieldsOnPlatform(t).then(e=>{if(e.fields){let t=e.fields.mae),a=m.VG.filte));y(a),d(!1),w(!1),f(!0)}})},loading:j,allowedFields:E,open:c,handleClose:()=>{d(!1)},children:(0,r.jsxs)("div",{className:"mt-5 flex flex-col",children:[(0,r.jsxs)("div",{className:"mb-2 flex flex-row space-x-2 text-sm font-medium text-gray-600",children:[(0,r.jsx)("span",{children:"Grant field access to profiles"}),(0,r.jsx)(h.Z,{className:"my-auto",children:"You can still create fields without granting access to profiles, but you will need to manually grant access in Salesforce."})]}),(0,r.jsx)("div",{children:(0,r.jsx)(Configuration_SalesforceProfileConfig,{profilesState:k,dispatch:R,loadingProfiles:S})})]})}),(0,r.jsx)(x.Z,{name:n,logo:s,open:p,handleClos},handleNext:()=>{let e=m.VG.filte));e.forEach(l),f(!1)}})]})}let SalesforceIcon=e=>{let{className:t}=e;return(0,r.jsx)(n.XjB,{className:(0,c.AK)("text-gray-300","h-4 w-4 shrink-0",t)})};var SalesforceContactConfig=function(e){var t,a;let{webhook:n,integrationSettings:o,state:c,dispatch:m,contactSObject:f,onUpdateFieldMap:g}=e,{fields:h,fetching:b}=use_load_sobject_fields({webhookId:n.id,sobject:"Contact",onError:i.Rn}),[{data:x}]=(0,l.x)({variables:{workspaceId:n.workspaceId}});return f?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(SalesforceQuickSetup,{webhook:n,logo:o.Logo,integrationName:o.name,objectName:f.name,autoMapField:e=>{addFieldToMap({dispatch:m,field:e,type:"contact-config-add-field-map-entry"})}}),!b&&(null==x?void 0:x.formFieldMetadata)&&(0,r.jsx)(s.Z,{tabs:{[f.name]:{toIcon:()=>(0,r.jsx)(SalesforceIcon,{className:"mr-2"}),fromIcon:()=>(0,r.jsx)(p.H,{className:"mr-2 h-4 w-4"}),preventDuplicates:!0,fromOptions:(0,d.Ed)(x.formFieldMetadata).map(e=>({label:e.name,value:e.id})),toOptions:h.map(e=>({label:e.label,value:e.name})),mappings:Object.entries(null!==(a=null===(t=c.contactConfig)||void 0===t?void 0:t.fieldMap)&&void 0!==a?a:{}).map((e,t)=>{let[a,r]=e;return{from:a,to:r,id:t.toString()}}),onChange:e=>g(Object.fromEntries(e.map(e=>[e.from,e.to])))}}})]}):(0,r.jsx)("div",{className:"rounded bg-gray-50 px-3 py-2 text-sm text-rose-900",children:"Could not fetch Contact object from Salesforce"})},j=a(1991),w=a(18318),S=a(52934),N=a(47330),C=a(53954),k=a(56958);let stringifyConfi);var R=a(20851),E=a(83408);let _=(0,E.hu)("debug:navattic:salesforce");var T=a(34126),F=a(6059),O=a(86414),I=a(25088);let formatOAuthSignInUrl=e=>{let{clientId:t,state:a,env:r}=e;return"".concat((0,d.Fj)(r),"?").concat(T.stringify({redirect_uri:d.Wg,client_id:t,response_type:"code",state:a}))};var M=a(64766),P=a(97185);let A={name:"Salesforce",screenshot:"https://www.navattic.com/img/integrations/salesforce.png",allowTestConnection:!0,webhookFormat:N.M8.Salesforce,Logo:n.XjB,ConnectComponent:e=>{let{clientId:t,integrationSettings:a}=e,{workspace:n}=(0,C.cF)(),{Logo:s}=a,[l,c]=o.useState("production"),goToSalesforceLogin=()=>{if(!t)return;if(!(null==n?void 0:n.slug)){(0,i.Rn)("Need workspace slug");return}O.Z.track("salesforce_integration_oauth_clicked");let e=(0,I.c_)({workspaceSlug:n.slug,env:l});window.location.href=formatOAuthSignInUrl({clientId:t,state:e,env:l})};return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("form",{onSubmi},children:[(0,r.jsx)("h4",{className:"mb-1 text-base font-semibold",children:"Connect Navattic to Salesforce"}),(0,r.jsx)("div",{className:"mb-7 text-sm text-gray-600",children:"Salesforce will prompt you to grant read/write permission on objects, layouts, and permissions."}),(0,r.jsx)(F.Z,{label:"Environment",items:d.fX,value:l,onChange:c,orientation:"horizontal"}),(0,r.jsxs)("button",{className:"btn-white mt-7 bg-white font-medium shadow",type:"submit",children:[(0,r.jsx)(s,{className:"mr-2 h-4 w-4"}),"Connect to Salesforce"]})]})})},ConfigurationComponent:function(e){var t,a;let{webhook:n,integrationSettings:c}=e,{workspace:f}=(0,C.cF)(),g=(0,C.NK)(f,N.TT.Enrichment),h=JSON.parse(n.config||"{}"),{loading:b,sobjects:x}=function(e){let{webhook:t}=e,[a,r]=(0,o.useState)([]),[n,s]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{if(!(null==t?void 0:t.id))return;let e=!0;return s(!0),fetch("".concat((0,j.T6)(),"?id=").concat(t.id)).then(async t=>{if(e){if(s(!1),t.ok){let e=await t.json();r(e.sobjects)}else(0,i.Rn)("Could not retrieve available Salesforce objects")}}}},[t]),{sobjects:a,loading:n}}({webhook:n}),[v,R]=(0,o.useState)(!1),[{data:E}]=(0,l.x)({variables:{workspaceId:n.workspaceId}}),_=(0,o.useMemo},[null==E?void 0:E.formFieldMetadata]),[T,F]=(0,o.useReducer)(salesforceConfigReducer,h),{sobject:O="",fieldMap:I={},create:M=!1,update:P=!1,syncToContact:A=!1,companyFieldMappings:L={}}=T,{fields:Z,fetching:z}=use_load_sobject_fields({sobject:O,webhookId:null==n?void 0:n.id,onError:i.Rn}),{fields:G}=use_load_sobject_fields({sobject:"Account",webhookId:null==n?void 0:n.id,onError:i.Rn}),[,D]=(0,S.I)(),onSaveIntegratio},onSaveConfig=()=>{if(!(null==n?void 0:n.id))return;let updateWebHookOrError=async()=>{let e=await D({id:null==n?void 0:n.id,config:stringifyConfig(T)});if(e.error)throw Error("Error saving: ".concat(e.error.message))},e=updateWebHookOrError();return k.A.promise(e,{success:"Saved Salesforce object configuration!",loading:"Saving Salesforce configuration...",error:i.bW}),e},V=x.fin}),{Logo:B}=c,H=(0,o.useMemo)(()=>g?{Accounts:{toIcon:()=>(0,r.jsx)(SalesforceIcon,{className:"mr-2"}),fromIcon:()=>(0,r.jsx)(p.H,{className:"mr-2 h-4 w-4"}),preventDuplicates:!0,mappings:Object.entries(L).map((e,t)=>{let[a,r]=e;return{from:a,to:r,id:t.toString()}}),fromOptions:m.jw.map(e=>({label:e.label,value:e.name})),toOptions:G.map(e=>({label:e.label,value:e.name})),onChange:e=>F({type:"update-company-field-mappings",payload:Object.fromEntries(e.map(e=>[e.from,e.to]))})}}:void 0,[G,L,g]),J=(0,o.useMemo)(()=>({[O]:{toIcon:()=>(0,r.jsx)(SalesforceIcon,{className:"mr-2"}),fromIco),preventDuplicates:!0,mappings:Object.entries(I).map((e,t)=>{let[a,r]=e;return{from:a,to:r,id:t.toString()}}),fromOptions:(0,d.Ed)(_).map(e=>({label:e.name,value:e.id})),toOptions:Z.ma)),onChange:e=>F({type:"update-field-map",payload:Object.fromEntries(e.ma]))})},...H}),[H,I,_,Z,O]);return(0,r.jsxs)("div",{className:"mx-auto max-w-md",children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("div",{"data-testid":"sobject-name-selector",className:"mb-6",children:[(0,r.jsx)("label",{className:"label-small normal-case",children:"Sync to"}),(0,r.jsx)(w.Z,{disabled:b,placeHolder:"Select Salesforce object",items:x.ma}),renderSelectedIco),selectFirstItem:!0,selected:O,onChange:e=>{let{id:t}=e;return F({type:"set-selected-sobject",payload:t})}})]}),O&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"pb-3",children:[(0,r.jsx)(y.XZ,{checked:M,onChange:e=>F({type:"set-create",payload:e}),labelText:"Create new Salesforce ".concat(null!==(t=null==V?void 0:V.labelPlural)&&void 0!==t?t:""," from Navattic visitors"),name:"checkbox-create",className:"mb-3"}),(0,r.jsx)(y.XZ,{checked:P,onChange:e=>F({type:"set-update",payload:e}),labelText:"Update existing Salesforce ".concat(null!==(a=null==V?void 0:V.labelPlural)&&void 0!==a?a:""," from Navattic visitors"),name:"checkbox-create"})]}),(0,r.jsx)(SalesforceQuickSetup,{webhook:n,logo:c.Logo,integrationName:c.name,objectName:O,autoMapFiel}}),(0,r.jsx)(s.Z,{tabs:J}),"Lead"===O&&(0,r.jsxs)("div",{className:"mt-5",children:[(0,r.jsxs)("div",{className:"flex flex-row items-center space-x-3 text-sm",children:[(0,r.jsx)(y.rs,{checked:A,onChange:e=>F({type:"set-sync-to-contact",payload:e})}),(0,r.jsx)("span",{className:"text-sm leading-none text-gray-500",children:"Also update Contact if exists"})]}),A&&(0,r.jsx)(SalesforceContactConfig,{contactSObject:x.fin}),state:T,dispatch:F,webhook:n,integrationSettings:c,onUpdateFieldMa)})]})]})]}),(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsxs)("button",{disabled:v,onClick:onSaveIntegration,className:"btn-white mt-3 w-full justify-center bg-white font-medium shadow",children:[(0,r.jsx)(B,{className:"mr-2"}),"Save configuration"]})})]})},DevelopmentComponent:e=>{let[t,a]=(0,o.useState)("create-field"),[n,s]=(0,o.useState)("{}"),[l,c]=(0,o.useState)(""),[d,p]=(0,o.useState)(0),{webhook:m}=e,onClick=async()=>{if(!t){(0,i.Rn)("Need to specify a method");return}let e=(0,R.OA)(n);if(!e){(0,i.Rn)("Invalid JSON body provided");return}k.A.promise((async()=>{let a=await fetch("/api/private/salesforce",{method:b.Z.POST,headers:{"Content-Type":"application/json"},body:JSON.stringify({sobject:"Lead",webhookId:m.id,method:t,data:e})}),r=await a.text(),n=(0,R.OA)(r);n?(_.log(n),c(JSON.stringify(n,null,2))):c(r),p(a.status)})(),{loading:"Sending request to Salesforce...",success:"Successfully hit Salesforce endpoint",error:i.bW})};return(0,r.jsxs)("div",{className:"mx-auto max-w-md",children:[(0,r.jsx)("label",{htmlFor:"select-method",className:"label-small",children:"Select method"}),(0,r.jsx)(w.Z,{selected:t,onChang),disabled:!1,items:[{id:"add-navattic-fields-to-layout"},{id:"create-field"},{id:"delete-navattic-fields"},{id:"describe-sobject"},{id:"list-fields"},{id:"list-layouts"},{id:"list-profiles"},{id:"read-layout"},{id:"read-profile"},{id:"remove-navattic-section-from-layout"},{id:"sync-navattic-fields"},{id:"update-profile-permissions"}].ma})}),(0,r.jsx)(y.gx,{id:"json-body",labelText:"JSON body",style:{fontFamily:"Consolas,Monaco,Lucida Console,Liberation Mono,DejaVu Sans Mono,Bitstream Vera Sans Mono,Courier New, monospace"},className:"mt-3 w-full",value:n,onChange:s}),(0,r.jsx)("button",{className:"btn-blue my-3 w-full",onClick:onClick,children:"Send Test Request"}),(0,r.jsx)(y.gx,{id:"json-response",readOnly:!0,labelText:"Response",style:{fontFamily:"Consolas,Monaco,Lucida Console,Liberation Mono,DejaVu Sans Mono,Bitstream Vera Sans Mono,Courier New, monospace"},className:"mt-3 w-full",value:l,placeholder:"Response goes here"}),d?(0,r.jsx)("label",{className:"label-base text-base text-gray-500",children:"Status: ".concat(d)}):null]})}}SalesforceIntegrationPage.getLayou};var L=!0,Z=SalesforceIntegrationPage},25088:function(e,t,a){"use strict";a.d(t,{c_:function(){return storeSalesforceInfo}}),a(83122),a(77262);var r=a(35196),n=a(34126),o=a(13077);a(34406);let storeSalesforceInf}},81436:function(e,t,a){"use strict";a.d(t,{}});var r,n,o=a(2784),s=a(90544),i=a(80586),l=a(3703),c=a(88064),d=a(99108),p=a(52929),m=a(57870),f=a(33401),g=a(55559);let h=(0,o.createContext)(null);function label_H(){let[e,t]=(0,o.useState)([]);return[e.length>0?e.join(" "):void 0,(0,o.useMemo},[t])]}let b=Object.assign((0,s.yV)(function(e,t){let a=(0,i.M)(),{id:r=`headlessui-label-${a}`,passive:n=!1,...l}=e,d=function u(){let e=(0,o.useContext)(h);if(null===e){let e=Error("You used a <Label /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(e,u),e}return e}(),p=(0,f.T)(t);(0,c.e),[r,d.register]);let m={ref:p,...d.props,id:r};return n&&("onClick"in m&&(delete m.htmlFor,delete m.onClick),"onClick"in l&&delete l.onClick),(0,s.sY)({ourProps:m,theirProps:l,slot:d.slot||{},defaultTag:"label",name:d.name||"Label"})}),{});var x=a(46465),v=a(68685),y=a(36799),j=a(60567),w=a(29833),S=a(84407),N=a(15426),C=a(61742),k=a(58314),R=((r=R||{})[r.RegisterOption=0]="RegisterOption",r[r.UnregisterOption=1]="UnregisterOption",r);let E={0(e,t){let a=[...e.options,{id:t.id,element:t.element,propsRef:t.propsRef}];return{...e,options:(0,p.z2)(a,e=>e.element.current)}}}},_=(0,o.createContext)(null);_.displayName="RadioGroupDataContext";let T=(0,o.createContext)(null}T.displayName="RadioGroupActionsContext";var F=((n=F||{})[n.Empty=1]="Empty",n[n.Active=2]="Active",n);let O=Object.assign((0,s.yV)(function(e,t){let a=(0,i.M)(),{id:r=`headlessui-radiogroup-${a}`,value:n,defaultValue:l,name:c,onChange:m,by:t,disabled:b=!1,...N}=e,C=(0,g.z)("string"==typeof ):h),[R,E]=(0,o.useReducer)(ke,{options:[]}),F=R.options,[O,I]=label_H(),[M,P]=(0,x.f)(),A=(0,o.useRef)(null),L=(0,f.T)(A,t),[Z,z]=(0,S.q)(n,m,l),G=(0,o.useMemo),[F]),D=(0,o.useMemo),[F,Z]),V=(0,g.z});(0,v.B)({container:A.current,accepT,wa}});let B=(0,g.z)(e=>{let t=A.current;if(!t)return;let a=(0,w.r)(t),r=F.filted).mat);switch(e.key){case d.R.Enter:(0,j.g)(e.currentTarget);break;case d.R.ArrowLeft:case d.R.ArrowUp:if(e.preventDefault(),e.stopPropagation(),(0,p.jA)(r,p.TO.Previous|p.TO.WrapAround)===p.fE.Success){let e=F.find(e=>e.element.current===(null==a?void 0:a.activeElement));e&&V(e.propsRef.current.value)}break;case d.R.ArrowRight:case d.R.ArrowDown:if(e.preventDefault(),e.stopPropagation(),(0,p.jA)(r,p.TO.Next|p.TO.WrapAround)===p.fE.Success){let e=F.find(e=>e.element.current===(null==a?void 0:a.activeElement));e&&V(e.propsRef.current.value)}break;case d.R.Space:{e.preventDefault(),e.stopPropagation();let t=F.fin));t&&V(t.propsRef.current.value)}}}),H=(0,g.z)),J=(0,o.useMemo),[Z,G,D,b,C,R]),U=(0,o.useMemo),[H,V]),K=(0,o.useMemo),[Z]),W=(0,o.useRef)(null),X=(0,k.G)();return(0,o.useEffect)(()=>{W.current&&void 0!==l&&X.addEventListener(W.current,"reset})},[W,V]),o.createElement(P,{name:"RadioGroup.Description"},o.createElement(I,{name:"RadioGroup.Label"},o.createElement(T.Provider,{value:U},o.createElement(_.Provider,{value:J},null!=c&&null!=Z&&(0,j.t)({[c]:Z}).map(([e,t],a)=>o.createElement(y._,{features:y.A.Hidden,ref:0===}:void 0,...(0,s.oA)({key:e,as:"input",type:"radio",checked:null!=t,hidden:!0,readOnly:!0,name:e,value:t})})),(0,s.sY)({ourProps:{ref:L,id:r,role:"radiogroup","aria-labelledby":O,"aria-describedby":M,onKeyDown:B},theirProps:N,slot:K,defaultTag:"div",name:"RadioGroup"})))))}),{Option:(0,s.yV)(function(e,t){var a;let r=(0,i.M)(),{id:n=`headlessui-radiogroup-option-${r}`,value:l,disabled:d=!1,...p}=e,h=(0,o.useRef)(null),b=(0,f.T)(h,t),[v,y]=label_H(),[j,w]=(0,x.f)(),{addFlag:S,removeFlag:k,hasFlag:R}=(0,m.V)(1),E=(0,C.E)({value:l,disabled:d}),F=function oe(e){let t=(0,o.useContext)(_);if(null===t){let t=Error(`<${e} /> is missing a parent <RadioGroup /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,oe),t}return t}("RadioGroup.Option"),O=function ne(e){let t=(0,o.useContext)(T);if(null===t){let t=Error(`<${e} /> is missing a parent <RadioGroup /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,ne),t}return t}("RadioGroup.Option");(0,c.e),[n,O,h,e]);let I=(0,g.z)(e=>{var t;if((0,N.P)(e.currentTarget))return e.preventDefault();O.change(l)&&(S(2),null==(t=h.current)||t.focus())}),M=(0,g.z)(e=>{if((0,N.P)(e.currentTarget))return e.preventDefault();S(2)}),P=(0,g.z)),A=(null==(a=F.firstOption)?void 0:a.id)===n,L=F.disabled||d,Z=F.compare(F.value,l),z={ref:b,id:n,role:"radio","aria-checked":Z?"true":"false","aria-labelledby":v,"aria-describedby":j,"aria-disabled":!!L||void 0,tabIndex:L?-1:Z||!F.containsCheckedOption&&A?0:-1,onClick:L?void 0:I,onFocus:L?void 0:M,onBlur:L?void 0:P},G=(0,o.useMemo),[Z,L,R]);return o.createElement(w,{name:"RadioGroup.Description"},o.createElement(y,{name:"RadioGroup.Label"},(0,s.sY)({ourProps:z,theirProps:p,slot:G,defaultTag:"div",name:"RadioGroup.Option"})))}),Label:b,Description:x.d})}}]);
//# sourceMappingURL=salesforce-2eef46b2b9ced14a.js.map