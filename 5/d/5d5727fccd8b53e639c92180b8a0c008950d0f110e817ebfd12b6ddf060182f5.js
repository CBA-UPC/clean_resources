var DIGIOH_API={};var DIGIOH_VARS={};var DIGIOH_CUSTOM_JS_GLOBAL={};var DIGIOH_CUSTOM_JS_SUPER={};var DIGIOH_CUSTOM_JS={};var DIGIOH_VENDOR_GUID='3b4da1dc-f56a-4e22-9d6e-68d05cb480ea';var DIGIOH_VENDOR_SHORT_ID='42156';var DIGIOH_KEEN_WRITE_KEY='BBFD8AEF5B4C0F66C43A7F194283B4833B7BC2AF15B5FF57EBE1453C0F4BE18C842F1915441BFA440927F985F23CD5FFFB61BED43E8545C68E076B1A7C85C64D94E2583A1DCA3A74AC2B0E0C8635CB0FD818AA76D34ABAAFBD7856BC9AB628A2CCD4DBF6C34ACE89B7DBE14F2B9A6514B5B93310100ED95AF53433D62FB96D9EBA72BB726FB5A50FCA1C1579C1C66F16E4E67A6F7755363BF4A38526322ED3D44C1E9C6CACF07927AB0D6CCBDE1E839A606463DAE5FC4B57E9BBBC985BD5565D8B3978F8FC4A348FF498E0EE0CC751160430198B1FA83881B34A1E932E7CA5614457ABE380D75035451024C23BE8FDB45219C6BC18DAB6E1D3B5817AE6F2161B9AA3FEFD550FCFACBE066400303886B109581E06E62376B5A52A88350E64BA16844C16807C25CCACB26C2EF9F2C98C74541C5B26E9FEA4BCDAE2D9E28E184C4C3B5C2AADAD817BC1FF194AD41C24E14E253E19A3AB10EF63E28DC493ABA1A64FD54EDE2DC6540B0C4F3F8E09D37E12FD';var DIGIOH_CDN_DOMAIN='www.lightboxcdn.com';var DIGIOH_CLIENT_IP='[#######DIGIOH_CLIENT_IP#######]';var DIGIOH_CACHE_VERSION='637828914502455094';var DIGIOH_STORAGE_TYPE='local_storage';var DIGIOH_EMBED_TYPE='lightning';var DIGIOH_LIGHTBOX_CONDITIONS=[];var DIGIOH_LIGHTBOX_RULESETS={};var DIGIOH_LIGHTBOX_EFFECTS={};var DIGIOH_LIGHTBOX_NAMES={};var DIGIOH_LIGHTBOX_IDS={};var DIGIOH_VARIATION_TO_BOX_MAP={};DIGIOH_API.DIGIOH_LIGHTBOX_SETTINGS={};DIGIOH_LIGHTBOX_NAMES['de1a37e3-693c-4a74-9155-cd950a9addb3']='Desktop Lightbox  ';DIGIOH_LIGHTBOX_NAMES['c29b8fdb-891c-45fc-8443-5474ab2610ff']='Mobile Banner ';DIGIOH_LIGHTBOX_IDS['de1a37e3-693c-4a74-9155-cd950a9addb3']='184772';DIGIOH_LIGHTBOX_IDS['c29b8fdb-891c-45fc-8443-5474ab2610ff']='184773';DIGIOH_LIGHTBOX_CONDITIONS[0]={};DIGIOH_LIGHTBOX_CONDITIONS[0].lightbox_guid='de1a37e3-693c-4a74-9155-cd950a9addb3';DIGIOH_LIGHTBOX_CONDITIONS[0].conditions=[[{"p":"E_device","o":"in_set","s":["Desktop","Tablet"],"v":"","sd":"","ed":""},{"p":"S_pages_navigated","o":"does_not_contain","v":"utm_source=exacttarget","s":[],"sd":"","ed":""},{"p":"S_referring_website_url","o":"does_not_contain","v":"utm_source=exacttarget","s":[],"sd":"","ed":""},{"p":"S_current_page_url","o":"does_not_contain","v":"utm_source=exacttarget","s":[],"sd":"","ed":""},{"p":"I_days_since_last_view","o":"greater_than","v":"3","s":[],"sd":"","ed":""},{"p":"E_visitor_activity_session","o":"equals","v":"1","s":[],"sd":"","ed":""},{"p":"S_current_page_url","o":"contains","v":"/event/","s":[],"sd":"","ed":""},{"p":"E_lightbox_activity","o":"equals","v":"submit","s":[],"sd":"","ed":""},{"p":"C_exists_jquery_selector","o":"does_not_equal","v":"#referring-source-email","s":[],"sd":"","ed":""}]];DIGIOH_LIGHTBOX_CONDITIONS[1]={};DIGIOH_LIGHTBOX_CONDITIONS[1].lightbox_guid='c29b8fdb-891c-45fc-8443-5474ab2610ff';DIGIOH_LIGHTBOX_CONDITIONS[1].conditions=[[{"p":"E_device","o":"equals","v":"Phone","s":[],"sd":"","ed":""},{"p":"E_visitor_activity_session","o":"equals","v":"1","s":[],"sd":"","ed":""},{"p":"I_days_since_last_view","o":"greater_than","v":"3","s":[],"sd":"","ed":""},{"p":"S_current_page_url","o":"contains","v":"/event/","s":[],"sd":"","ed":""},{"p":"E_lightbox_activity","o":"equals","v":"submit","s":[],"sd":"","ed":""},{"p":"C_exists_jquery_selector","o":"does_not_equal","v":"#referring-source-email","s":[],"sd":"","ed":""}]];DIGIOH_LIGHTBOX_EFFECTS['de1a37e3-693c-4a74-9155-cd950a9addb3']={"widget_type":"fancybox","fancybox":{"speed":{"open":100,"close":500},"animation":{"open":"fade","close":"fade"},"easing":{"open":"swing","close":"swing"},"position":{"top":5,"left":5},"overlay":{"close_click":false,"background":{"color":"rgba(0, 0, 0, 0.44)","gradient":"#000000","image":"","repeat":"no-repeat","position":"left top","use_gradient":false,"use_image":false}},"close_button":{"display":true,"type":"default","image":"","position":"top-right","offset_x":-18,"offset_y":-18},"teaser":{"display":false,"display_on_page_load":false,"css_positioning":"fixed","width":292,"height":35,"padding":{"top":10,"right":0,"bottom":0,"left":0},"text":"Fresh Content, Straight to your Inbox!","font":{"family":"Arial, Helvetica, sans-serif","color":"#ffffff","align":"center","size":"14","bold":true,"italic":false,"underline":false},"font_hover":{"family":"Arial, Helvetica, sans-serif","color":"#ffffff","align":"center","size":"14","bold":true,"italic":false,"underline":true},"font_focus":{"family":"Arial, Helvetica, sans-serif","color":"#ffffff","align":"center","size":"14","bold":true,"italic":false,"underline":false},"border":{"width":2,"color":"#ffffff","style":"none","radius":"0"},"border_hover":{"width":2,"color":"#ff0000","style":"none","radius":"0"},"border_focus":{"width":2,"color":"#ff0000","style":"none","radius":"0"},"background":{"color":"rgb(24, 41, 57)","gradient":"rgb(204, 204, 204)","image":"","repeat":"no-repeat","position":"left top","use_gradient":false,"use_image":false},"background_hover":{"color":"rgb(24, 41, 57)","gradient":"rgb(204, 204, 204)","image":"","repeat":"no-repeat","position":"left top","use_gradient":false,"use_image":false},"background_focus":{"color":"rgb(24, 41, 57)","gradient":"rgb(204, 204, 204)","image":"","repeat":"no-repeat","position":"left top","use_gradient":false,"use_image":false},"position":"bottom-right","offset_x":0,"offset_y":0,"follow_me":false},"css":""},"width":467,"height":346,"iframe":{"use_custom":false,"is_self_hosted":false,"self_hosted_url":"","html_last_uploaded":"","width":750,"height":600},"thxwidth":467,"thxheight":346,"ep1width":599,"ep1height":471,"ep2width":599,"ep2height":471,"ep3width":599,"ep3height":471,"ep4width":599,"ep4height":471,"responsive":{"use":false},"thxresponsive":{"use":false},"ep1responsive":{"use":false},"ep2responsive":{"use":false},"ep3responsive":{"use":false},"ep4responsive":{"use":false},"scaling":{"use":false,"max_type":"abs","max_width":467,"max_height":346,"max_width_pct":75,"max_height_pct":75},"thxscaling":{"use":false,"max_type":"abs","max_width":467,"max_height":346,"max_width_pct":75,"max_height_pct":75},"ep1scaling":{"use":false,"max_type":"abs","max_width":599,"max_height":471,"max_width_pct":75,"max_height_pct":75},"ep2scaling":{"use":false,"max_type":"abs","max_width":599,"max_height":471,"max_width_pct":75,"max_height_pct":75},"ep3scaling":{"use":false,"max_type":"abs","max_width":599,"max_height":471,"max_width_pct":75,"max_height_pct":75},"ep4scaling":{"use":false,"max_type":"abs","max_width":599,"max_height":471,"max_width_pct":75,"max_height_pct":75}};DIGIOH_LIGHTBOX_EFFECTS['c29b8fdb-891c-45fc-8443-5474ab2610ff']={"widget_type":"banner","width":269,"height":212,"iframe":{"use_custom":false,"is_self_hosted":false,"self_hosted_url":"","html_last_uploaded":"","width":750,"height":600},"banner":{"placement":"bottom","page_overlap":"move","css_positioning":"absolute","close_button":{"display":false,"type":"default","image":"","position":"top-left","offset_x":0,"offset_y":0},"css":"overflow:visible;","teaser":{"display":false,"display_on_page_load":false,"follow_me":false,"css_positioning":"fixed","width":0,"height":0,"padding":{"top":0,"right":0,"bottom":0,"left":0},"text":"","font":{"family":"Arial, Helvetica, sans-serif","color":"#ffffff","align":"center","size":14,"bold":false,"italic":false,"underline":false,"vspace":0},"font_hover":{"family":"Arial, Helvetica, sans-serif","color":"#ffffff","align":"center","size":14,"bold":false,"italic":false,"underline":false,"vspace":0},"font_focus":{"family":"Arial, Helvetica, sans-serif","color":"#ffffff","align":"center","size":14,"bold":false,"italic":false,"underline":false,"vspace":0},"border":{"width":2,"color":"#ffffff","style":"solid","radius":6},"border_hover":{"width":2,"color":"#ff0000","style":"solid","radius":6},"border_focus":{"width":2,"color":"#ff0000","style":"solid","radius":6},"background":{"color":"#000000","gradient":"#000000","image":"","repeat":"no-repeat","position":"left top","use_gradient":false,"use_image":false},"background_hover":{"color":"#ff0000","gradient":"#ff0000","image":"","repeat":"no-repeat","position":"left top","use_gradient":false,"use_image":false},"background_focus":{"color":"#ff0000","gradient":"#ff0000","image":"","repeat":"no-repeat","position":"left top","use_gradient":false,"use_image":false},"position":"bottom-right","offset_x":0,"offset_y":0}},"thxwidth":269,"thxheight":193,"ep1width":599,"ep1height":471,"ep2width":599,"ep2height":471,"ep3width":599,"ep3height":471,"ep4width":599,"ep4height":471,"responsive":{"use":true},"thxresponsive":{"use":false},"ep1responsive":{"use":false},"ep2responsive":{"use":false},"ep3responsive":{"use":false},"ep4responsive":{"use":false},"scaling":{"use":false,"max_type":"abs","max_width":269,"max_height":212,"max_width_pct":75,"max_height_pct":75},"thxscaling":{"use":false,"max_type":"abs","max_width":269,"max_height":193,"max_width_pct":75,"max_height_pct":75},"ep1scaling":{"use":false,"max_type":"abs","max_width":599,"max_height":471,"max_width_pct":75,"max_height_pct":75},"ep2scaling":{"use":false,"max_type":"abs","max_width":599,"max_height":471,"max_width_pct":75,"max_height_pct":75},"ep3scaling":{"use":false,"max_type":"abs","max_width":599,"max_height":471,"max_width_pct":75,"max_height_pct":75},"ep4scaling":{"use":false,"max_type":"abs","max_width":599,"max_height":471,"max_width_pct":75,"max_height_pct":75}};var DIGIOH_PIXEL_THRESHOLDS={};DIGIOH_PIXEL_THRESHOLDS['de1a37e3-693c-4a74-9155-cd950a9addb3']={};DIGIOH_PIXEL_THRESHOLDS['c29b8fdb-891c-45fc-8443-5474ab2610ff']={};var DIGIOH_PUBLISHED_VARIATIONS_ARR=[];var DIGIOH_DATA_STORAGE_TYPE_BY_BOX_OBJ={};var DIGIOH_PRIMARY_VARIATIONS_ARR=[];var DIGIOH_EFFECTS_IMAGE_CACHE_ARR=[];var DIGIOH_SETTINGS_IMAGE_CACHE_ARR=[];var DIGIOH_LIGHTBOX_MASTER_RULES={"OneBoxPerPageview":false,"OneBoxPerSession":false,"OneBoxPerVisitor":false,"StopAfterFormSubmitted":false,"DisableIfCookiesDisabled":true,"IgnoreForInlineBoxes":true,"AllowMultipleBoxes":false};var DIGIOH_LIGHTBOX_TEASER_PRELOAD_ARR=[];var DIGIOH_LIGHTBOX_TEASER_FOLLOW_ME_ARR=[];var DIGIOH_LIGHTBOX_INLINE_ALWAYS_ARR=[];var DIGIOH_LIGHTBOX_INLINE_CONDITIONS_ARR=[];var DIGIOH_LIGHTBOX_INLINE_DEPENDENT_ARR=[];var DIGIOH_LIGHTBOX_PRELOAD_ARR=[];var DIGIOH_LIGHTBOX_MOBILE_DEVICE_ARR=[];var DIGIOH_LIGHTBOX_DESKTOP_DEVICE_ARR=['de1a37e3-693c-4a74-9155-cd950a9addb3'];var DIGIOH_LIGHTBOX_UNCATEGORIZED_DEVICE_ARR=['c29b8fdb-891c-45fc-8443-5474ab2610ff'];var DIGIOH_DYNAMIC_BOXES=[];var DIGIOH_SPLIT_TESTS_ARR=[];var DIGIOH_USE_BUGSNAG=false;var DIGIOH_USE_CONSOLE=false;var DIGIOH_USE_RESPONSIVE=false;var DIGIOH_USE_REAL_TIME_SUBMISSIONS=false;var DIGIOH_USE_HTTPS_ONLY=false;var DIGIOH_IS_QA=false;var DIGIOH_IS_PREVIEW=false;var DIGIOH_IS_DEV=false;var DIGIOH_KEEN_PV=false;var DIGIOH_BLIP_LZ='NoIg7GB0Bs2QnABkgJgIxpAGgAQgCxxrQCsqJakGJ2e0KqayaAHCzCrSPY8xaui4pE8KkgRwkQxHBRzIUNAGZE02fMUzpotOJL4q-7WOT6ELY7uRKlqY.12il-NQIZlhnXCDRhb-MiZKVks9AylvYVEHeCh8LzxhdQYoT1DTA2VVSJk3GFRnVzl3VHj0.N0XHJ0wqjBsxNzihTEqxuSW9AtqyBioCMaajKolbsHe4NiCtpAkvLgSMdmm-Vkynr7GJaiJsVT18atezPoi-UDCLl9.QMRghuWh46pL72vSk-QwGZ2j-CIVOUzCwEssOroqFoekczBgZu8ApDKIsrn5IIigpDoKibkiXti3miMXcqGh4UTbpQDiBKXVwksmLZRGBJGAuGB2GgSKlWFQ5FxoJzBaSyCjvMLiJyydN2VBvmJbChCuKhVLbgS8BzDDz2CgNeApcx6qgoXRVaTMoCVVQJVy-aCtRgjcg0tbJSLzOzDXVmPAlhAFJl4IqlPrHdytqSHgH5boQzRvLSyQCHmgUB404weeTFfgTjzU2iUHmbftQe9iyddcq8BWS8RUiRC7n81scR8bbrqZnhAZ0CnLHrIbZiD8mQxnAgHsIoKNICwoIKuCxJhPgrppLP2Av5.AuIQbR5hKTMBtKMJRUseOhmPgqWy3unGAx0DzT3QX0x50RhPZJooyQFT9bypBM8CTA8myA3h51sFglGgm8RlEJVpxEExICUSYZmvL9k3RPdxWA.EFEIj8YNYbd9VwkD0Wo4jlBQwQiJg8MyO4Yj4PnHCGLYTD9QPYgjxdLk.z2XolkE0gBBdO9EK.YsyHwB88Ck4TGAQ7w1Jkk0HglW1NHoii73RK9eJ0HiKJYURthWBgIThdtK1LOoGSLetoFSRBy3c1tKicjzFHqdtERXLEQrIMKQQi-dgjc3EwscwkEsoAYfF8lziFBHZ-AvEZUyfdBPx5MD0pS-0YrC2BKuRZt0Ui4IrXIpCuUoNh5OYJQUNDDqbXs6lfnEeBAjMqyuxUjixoUUEaOQmUWKQrU.F6xiCk05q8K6j4Vr44t2NmyiCjQ6Jz0QQJAIWzbuv2hiTJIUqDq24t30eDDhtQfUEQaj6AqrVzfs7QNBx.RRoHYnL.14coiFGxbOW-cp3p83EhuOt6yGqnJwR0fksbyBzTmhIbbjE3RUj1XquLSg7crOlb4l6dbJpap6N0u5geG5MS8ops8TRG4HSR0LnoSHNMDAR0WiAckgmd-MXixkwXxdi5XpRXZXvJ9NWLLl9C0x.TIFx1-cJvl6XhdsnGLcMcH0M2LI1Ylq2-UNhRSvNyEDCUbL9bFxADACTXA5-P2iAD4dg.nX3reHUko6YNGDa9k0E49sOU7AGPXbj5QxwQCcDGi9nvyFqOWHT2OmCL.VPerqdy7NjP65YUOq4j4KpZTi7DjFiEIE1-ywfLl3k5VzHe.DgwSDt9ui9nnPGUjrv6-HleI6YX2t1NmA7e3ndO8afeoHgzdMO3OV0-PmAr.PneJ-Wa.JaPu-D731-5RemcP4UWyn-zo4rBAgcjPnOA-TM6ytjSt.MBcom7X08srRWxQdo6GWiXfCzENocyHqAi-Lx4E.zTF.RA18uRoTITYPBO9lCENgSMUOZCSBbyIT1HIZCMDUJ3GmFh9DWpcMbAIl4t96G11IUQ387CJF6w4e.PhXV6ZwGsoo02K1rxiMoX.H-SohF0PwXI.BGBeH4N5i.PhFDWEiJMYwoheYhFaPoZIsxhiSFkJsXw.AMiJFCOTD4qxNCNG2IcYYu4QjgxhMCfQ-Arif7wHcfg9qUjzEWKiRNA6-BOTFh8YgJmB0eAZPppk3Jt0GCE2wXNJUsM8KCVMczPCfFE7ZLSQxHgTVH5EO8tkm6xl7JtIOnxV4zid5-n3EQaSxYiDoMnkLSEeiaFMBNo0om1g-xGRapzSyLUBkxPMcEmhpp2lRIMfs0qkDdJ8hejTYIWcdrsDAA9Fpn4vEePYj2COrd5rlPwmvdo-M4AIwALpAA_';var COUPON_GROUP_POPULATE_OBJ={};var ClientJsDomMaxWaitSeconds=0;var CDP_VARS={'enabled':0,'dimension':0,'save_email':0,'embed_type':'','account_type':'','esp_params':'','ua_tracking_id':''};var USE_LZ=true;var ACCOUNT_METADATA={};DIGIOH_CUSTOM_JS={runCustomJsOnDocumentReady:function(api,window,document,$,s){try{var console={};console.log=DIGIOH_CUSTOM_JS.log;try{if(api.contains(window.location.href,"2018wwdbeautyceo")){if(window.pmc.tracking._tokens){var utm_campaign=window.pmc.tracking._tokens['utm_campaign'];if(utm_campaign){if(api.contains(utm_campaign,"mail")){JQUERY_DIGIOH('body').append("<div id='referring-source-email' style='display:none;'></div>");}}}}}catch(err){}}
catch(e){DIGIOH_CUSTOM_JS.logError(e,'runCustomJsOnDocumentReady');e.message='DIGIOH: Custom JS Parent -- '+e.message;window.console.error(e);}
return true;},runCustomJsBeforeLightboxDisplay:runCustomJsOnLightboxDisplay:function(api,window,document,$,lightbox_id,variation_id,s){try{var console={};console.log=DIGIOH_CUSTOM_JS.log;}
catch(e){DIGIOH_CUSTOM_JS.logError(e,'runCustomJsOnLightboxDisplay');e.message='DIGIOH: Custom JS Parent -- '+e.message;window.console.error(e);}},runCustomJsOnChangePages:function(api,window,document,$,lightbox_id,variation_id,s){try{var console={};console.log=DIGIOH_CUSTOM_JS.log;}
catch(e){DIGIOH_CUSTOM_JS.logError(e,'runCustomJsOnChangePages');e.message='DIGIOH: Custom JS Parent -- '+e.message;window.console.error(e);}},runCustomJsOnLightboxSubmit:function(api,window,document,$,lightbox_id,variation_id,s){try{var console={};console.log=DIGIOH_CUSTOM_JS.log;}
catch(e){DIGIOH_CUSTOM_JS.logError(e,'runCustomJsOnLightboxSubmit');e.message='DIGIOH: Custom JS Parent -- '+e.message;window.console.error(e);}},runCustomJsOnLightboxRedirect:function(api,window,document,$,lightbox_id,variation_id,s){try{var console={};console.log=DIGIOH_CUSTOM_JS.log;}
catch(e){DIGIOH_CUSTOM_JS.logError(e,'runCustomJsOnLightboxRedirect');e.message='DIGIOH: Custom JS Parent -- '+e.message;window.console.error(e);}},runCustomJsOnLightboxDownload:function(api,window,document,$,lightbox_id,variation_id,s){try{var console={};console.log=DIGIOH_CUSTOM_JS.log;}
catch(e){DIGIOH_CUSTOM_JS.logError(e,'runCustomJsOnLightboxDownload');e.message='DIGIOH: Custom JS Parent -- '+e.message;window.console.error(e);}},runCustomJsOnLightboxClose:function(api,window,document,$,lightbox_id,variation_id,s){try{var console={};console.log=DIGIOH_CUSTOM_JS.log;}
catch(e){DIGIOH_CUSTOM_JS.logError(e,'runCustomJsOnLightboxClose');e.message='DIGIOH: Custom JS Parent -- '+e.message;window.console.error(e);}},runCustomJsCdpEspId:log:function(msg){try{DIGIOH_API.log(msg,'CUSTOM_JS_PARENT');}
catch(e)
{e.message='DIGIOH: Custom JS Parent -- '+e.message;window.console.error(e);}},logError:function(e,fcn){try{DIGIOH_API.log(e.message,'CUSTOM_JS_PARENT.'+fcn+'()');DIGIOH_API.logErrorFromCustomJsParent(e,'CUSTOM_JS_PARENT.'+fcn);}
catch(e)
{e.message='DIGIOH: Custom JS Parent -- '+e.message;window.console.error(e);}}};DIGIOH_CUSTOM_JS_SUPER={runCustomJsOnDocumentReady:function(api,window,document,$,s){try{var console={};console.log=DIGIOH_CUSTOM_JS_SUPER.log;console.log('This is PMC GJS');function setRule(value){var Rule=document.createElement("div");Rule.setAttribute("id",value);Rule.setAttribute("style","display:none");Rule.setAttribute("digioh","digioh_rule");document.body.appendChild(Rule);}
try{if(window.digiohVisitorFromEmail){setCookie("digioh_utm","came_from_email",3000);setRule("came_from_email");}else if(getCookie("digioh_utm")==="came_from_email"){setRule("came_from_email");}}catch(err){}
api.initGetEmails=function(geqId,window,document){try{!function(){var geq=window.geq=window.geq||[];if(geq.initialize)return;if(geq.invoked){if(window.console&&console.error){console.error("GE snippet included twice.");}
return;}
geq.invoked=true;geq.methods=["suppress"];geq.factory=for(var i=0;i<geq.methods.length;i++){var key=geq.methods;geq[key]=geq.factory(key);}
geq.load=function(key){var script=document.createElement("script");script.type="text/javascript";script.async=true;if(location.href.includes("vge=true")){script.src="https://s3-us-west-2.amazonaws.com/jsstore/a/"+key+"/ge.js?v="+Math.random();}else{script.src="https://s3-us-west-2.amazonaws.com/jsstore/a/"+key+"/ge.js";}
var first=document.getElementsByTagName("script")[0];first.parentNode.insertBefore(script,first);};geq.SNIPPET_VERSION="1.5.1";geq.load(geqId);}();}catch(e){console.log("Error: initGetEmails: "+e);}};api.supressGetEmails=function(window){try{window.geq.suppress();}catch(e){console.log("Error: supressGetEmails: "+e);}};api.td_ssc_id=function(){if(window.blogherads&&typeof window.blogherads==="object"){if(window.blogherads.hasOwnProperty("getTreasureDataObject")&&typeof window.blogherads.getTreasureDataObject==="function"){let dataObject=window.blogherads.getTreasureDataObject();if(dataObject&&typeof dataObject==="object"){if(dataObject.hasOwnProperty("client")&&typeof dataObject.client==="object"){let clientData=dataObject.client;if(clientData&&typeof clientData==="object"&&clientData.hasOwnProperty("globals")&&typeof clientData.globals==="object"){let globals=clientData.globals;if(globals&&typeof globals==="object"&&globals.hasOwnProperty("$global")&&typeof globals.$global==="object"){let $global=globals.$global;if($global&&typeof $global==="object"&&$global.hasOwnProperty("td_ssc_id")&&typeof $global.td_ssc_id==="string"){return $global.td_ssc_id;}}}}}}}
return "";};api.setDataLayerValue("custom_50",api.td_ssc_id());}
catch(e){DIGIOH_CUSTOM_JS_SUPER.logError(e,'runCustomJsOnDocumentReady');e.message='DIGIOH: Custom JS Global -- '+e.message;window.console.error(e);}
return true;},runCustomJsBeforeLightboxDisplay:function(api,window,document,$,lightbox_id,variation_id,s){try{var console={};console.log=DIGIOH_CUSTOM_JS_SUPER.log;var isExist=false;$("iframe").each(function(index,iframe){try{var valid=iframe.contentWindow.document.body.innerHTML.indexOf('parent.postMessage("pmcadm:dfp:isdirect=true"')>-1||iframe.contentWindow.document.body.innerHTML.indexOf('pmc_show_interrupt_ads')>-1;if(valid){isExist=true;}}catch(err){}});if($("#pmc-adm-interrupts-container").length&&$("#pmc-adm-interrupts-container").css("display")==="block")isExist=true;if(isExist){return false;}}
catch(e){DIGIOH_CUSTOM_JS_SUPER.logError(e,'runCustomJsBeforeLightboxDisplay');e.message='DIGIOH: Custom JS Global -- '+e.message;window.console.error(e);}
return true;},runCustomJsOnLightboxDisplay:function(api,window,document,$,lightbox_id,variation_id,s){try{var console={};console.log=DIGIOH_CUSTOM_JS_SUPER.log;}
catch(e){DIGIOH_CUSTOM_JS_SUPER.logError(e,'runCustomJsOnLightboxDisplay');e.message='DIGIOH: Custom JS Global -- '+e.message;window.console.error(e);}},runCustomJsOnChangePages:function(api,window,document,$,lightbox_id,variation_id,s){try{var console={};console.log=DIGIOH_CUSTOM_JS_SUPER.log;}
catch(e){DIGIOH_CUSTOM_JS_SUPER.logError(e,'runCustomJsOnChangePages');e.message='DIGIOH: Custom JS Global -- '+e.message;window.console.error(e);}},runCustomJsOnLightboxSubmit:function(api,window,document,$,lightbox_id,variation_id,s){try{var console={};console.log=DIGIOH_CUSTOM_JS_SUPER.log;}
catch(e){DIGIOH_CUSTOM_JS_SUPER.logError(e,'runCustomJsOnLightboxSubmit');e.message='DIGIOH: Custom JS Global -- '+e.message;window.console.error(e);}},runCustomJsOnLightboxRedirect:function(api,window,document,$,lightbox_id,variation_id,s){try{var console={};console.log=DIGIOH_CUSTOM_JS_SUPER.log;}
catch(e){DIGIOH_CUSTOM_JS_SUPER.logError(e,'runCustomJsOnLightboxRedirect');e.message='DIGIOH: Custom JS Global -- '+e.message;window.console.error(e);}},runCustomJsOnLightboxDownload:function(api,window,document,$,lightbox_id,variation_id,s){try{var console={};console.log=DIGIOH_CUSTOM_JS_SUPER.log;}
catch(e){DIGIOH_CUSTOM_JS_SUPER.logError(e,'runCustomJsOnLightboxDownload');e.message='DIGIOH: Custom JS Global -- '+e.message;window.console.error(e);}},runCustomJsOnLightboxClose:log:logError:;var DIGIOH_WIN_PARENT;var DIGIOH_DOC_PARENT;var DIGIOH_WIN_CHILD;if(DIGIOH_VENDOR_GUID!=='f5736c5c-cae5-4054-81ae-a82b7b8ef0aa'&&DIGIOH_VENDOR_GUID!=='12967-17a4d24d-3070-4072-8e41-0c409aac0086'){if(DIGIOH_EMBED_TYPE=='lightning'){DIGIOH_WIN_PARENT=window.parent;DIGIOH_DOC_PARENT=window.parent.document;DIGIOH_WIN_CHILD=window;}else{DIGIOH_WIN_PARENT=window;DIGIOH_DOC_PARENT=window.document;DIGIOH_WIN_CHILD=window;}}
if(window.parent.document&&window.parent.document.getElementById(DIGIOH_VENDOR_GUID)!==null){window.parent.document.getElementById(DIGIOH_VENDOR_GUID).style.display='none';}
var DIGIOH_LIGHTBOX_ANALYTICS={};var DIGIOH_BUGSNAG=null;!"Keen",this,;var LZString=(();()(window.parent);var JQUERY_DIGIOH=window.parent.jQuery.noConflict(true);JQUERY_DIGIOH.idleTimer;JQUERY_DIGIOH.fn.idleTimer;if(DIGIOH_EMBED_TYPE==='inline'){}
var hasRunJquerySelectorGenerator=false;var JquerySelectorGeneratorPrevBorder={};var JquerySelectorGeneratorPrevPath='';var runJquerySelectorGenerator;if(window.parent.location.href.indexOf('lightbox-jquery-selector-generator')>0){runJquerySelectorGenerator();}
var DIGIOH_STORAGE={storage_type:(DIGIOH_STORAGE_TYPE||'cookie'),data:{},callbacks:{},set,get,erase,setStorageType};var DIGIOH_LOCAL_STORAGE={set,get,erase,setManual,getManual,isAvailable};var DIGIOH_CROSS_DOMAIN={isWorking:false,isWorkingFinished:false,callbacks:{},set:function(value){var data_val='';var useLZ=(typeof USE_LZ==='undefined'||USE_LZ==true);if(typeof value!=='object'||value===null){if(useLZ){data_val=LZString.compressToBase64(JSON.stringify({}));}else{data_val=JSON.stringify({});}}else{if(useLZ){data_val=LZString.compressToBase64(JSON.stringify(value));}else{data_val=JSON.stringify(value);}}
var obj={operation:"set",value:data_val,vid:DIGIOH_VENDOR_GUID};window.parent.frames['DigiohLocalStorageIframe'].postMessage(JSON.stringify(obj),'https://www.lightboxcdn.com');},get:function(callback){var identifier=new Date().getTime();var obj={operation:"get",identifier:identifier,vid:DIGIOH_VENDOR_GUID};DIGIOH_CROSS_DOMAIN.callbacks[identifier]=callback;window.parent.frames['DigiohLocalStorageIframe'].postMessage(JSON.stringify(obj),'https://www.lightboxcdn.com');},erase:function(){var obj={operation:"erase",vid:DIGIOH_VENDOR_GUID};window.parent.frames['DigiohLocalStorageIframe'].postMessage(JSON.stringify(obj),'https://www.lightboxcdn.com');},setInner:function(key,value){var data_type='';var data_val='';var useLZ=(typeof USE_LZ==='undefined'||USE_LZ==true);if(typeof value==='undefined'||value===null){data_type='string';if(useLZ){data_val=LZString.compressToBase64('');}else{data_val='';}}else if(typeof value==='object'){data_type='object';if(useLZ){data_val=LZString.compressToBase64(JSON.stringify(value));}else{data_val=JSON.stringify(value);}}else{data_type=(typeof value);if(useLZ){data_val=LZString.compressToBase64(value.toString());}else{data_val=value.toString();}}
var obj={operation:"set_inner",key:key,value:data_val,type:data_type,vid:DIGIOH_VENDOR_GUID};window.parent.frames['DigiohLocalStorageIframe'].postMessage(JSON.stringify(obj),'https://www.lightboxcdn.com');},getInner:function(key,callback){var identifier=new Date().getTime();var obj={operation:"get_inner",key:key,identifier:identifier,vid:DIGIOH_VENDOR_GUID};DIGIOH_CROSS_DOMAIN.callbacks[identifier]=callback;window.parent.frames['DigiohLocalStorageIframe'].postMessage(JSON.stringify(obj),'https://www.lightboxcdn.com');},eraseInner:function(key){var obj={operation:"erase_inner",key:key,vid:DIGIOH_VENDOR_GUID};window.parent.frames['DigiohLocalStorageIframe'].postMessage(JSON.stringify(obj),'https://www.lightboxcdn.com');},setManual:function(key,value){var data_val='';var useLZ=(typeof USE_LZ==='undefined'||USE_LZ==true);if(typeof value==='undefined'||value===null){if(useLZ){data_val=LZString.compressToBase64('');}else{data_val='';}}else if(typeof value==='object'){if(useLZ){data_val=LZString.compressToBase64(JSON.stringify(value));}else{data_val=JSON.stringify(value);}}else{if(useLZ){data_val=LZString.compressToBase64(value.toString());}else{data_val=value.toString();}}
var obj={operation:"set_manual",key:key,value:data_val,vid:DIGIOH_VENDOR_GUID};window.parent.frames['DigiohLocalStorageIframe'].postMessage(JSON.stringify(obj),'https://www.lightboxcdn.com');},getManual:function(key,callback){var identifier=new Date().getTime();var obj={operation:"get_manual",key:key,identifier:identifier,vid:DIGIOH_VENDOR_GUID};DIGIOH_CROSS_DOMAIN.callbacks[identifier]=callback;window.parent.frames['DigiohLocalStorageIframe'].postMessage(JSON.stringify(obj),'https://www.lightboxcdn.com');},eraseManual:function(key){var obj={operation:"erase_manual",key:key,vid:DIGIOH_VENDOR_GUID};window.parent.frames['DigiohLocalStorageIframe'].postMessage(JSON.stringify(obj),'https://www.lightboxcdn.com');}};var DIGIOH_COOKIE={set:function(name,value,days){DIGIOH_COOKIE.trySet(name,value,true,days);},setDecoded,trySet,get,getEncoded,erase,eraseWithoutDomain,eraseWithSpecificDomain};if(!String.prototype.trim)
{String.prototype.trim;}
var DIGIOH_IS_ANALYTICS_IDENTIFY_DONE={geo:false,device:false};(window.parent,window.parent.document,JQUERY_DIGIOH));JQUERY_DIGIOH.easing['jswing']=JQUERY_DIGIOH.easing['swing'];JQUERY_DIGIOH.extend(JQUERY_DIGIOH.easing,{def:'easeOutQuad',swing,easeInQuad,easeOutQuad,easeInOutQuad,easeInCubic,easeOutCubic,easeInOutCubic,easeInQuart,easeOutQuart,easeInOutQuart,easeInQuint,easeOutQuint,easeInOutQuint,easeInSine,easeOutSine,easeInOutSine,easeInExpo,easeOutExpo,easeInOutExpo,easeInCirc,easeOutCirc,easeInOutCirc,easeInElastic,easeOutElastic,easeInOutElastic,easeInBack,easeOutBack,easeInOutBack,easeInBounce,easeOutBounce,easeInOutBounce});)(JQUERY_DIGIOH,window.parent);var DeviceAtlas=DeviceAtlas||{},DeviceAtlas(window,document,navigator);function DIGIOH_ANALYTICS($,showErrors,vendorGUID,isPreview,baseUrl){this.jQuery=$;this.ShowErrors=showErrors;this.BaseDomain=baseUrl;this.IsNewSession=true;this.IsNewVisitor=true;this.RanSetCurrent=false;this.PageviewStart=(new Date()).getTime();this.SessionStart=0;this.SessionLengthTicks=1800000;this.OverwriteCurrentCookie=false;this.PreviousPageviewTs=0;this.VARS={};this.VARS.VendorGuid=vendorGUID;this.VARS.IsLoaded=false;this.VARS.IsPreview=isPreview;this.VARS.current_page_url="";this.VARS.referring_website_url="";this.VARS.landing_page="";this.VARS.landing_page_ip="";this.VARS.date_of_visit=0;this.VARS.web_source="Direct Traffic";this.VARS.past_visits=0;this.VARS.page_visits=0;this.VARS.page_visits_session=0;this.VARS.pages_navigated="";this.VARS.search_engine="";this.VARS.device="";this.VARS.device_apple="";this.VARS.browser_type="";this.VARS.browser_version="";this.VARS.operating_system="";this.VARS.utm_campaign_source="";this.VARS.utm_campaign_medium="";this.VARS.utm_campaign_term="";this.VARS.utm_campaign_content="";this.VARS.utm_campaign_name="";this.VARS.total_time_seconds=0;this.VARS.active_time_seconds=0;this.VARS.idle_time_seconds=0;this.VARS.continent="";this.VARS.continent_name="";this.VARS.country="";this.VARS.country_name="";this.VARS.region_name="";this.VARS.state="";this.VARS.city="";this.VARS.ip_address="";this.VARS.zipcode="";this.VARS.latitude=0;this.VARS.longitude=0;this.VARS.metro_code="";this.VARS.time_zone="";this.VARS.area_code="";this.VARS.segments=[];this.VARS.scroll_percent=0;this.VARS.scroll_pixels=0;this.VARS.exit_intent="";this.VARS.click_jquery_selector={};this.VARS.hover_jquery_selector={};this.VARS.exists_jquery_selector={};this.VARS.lightbox_activity={};this.VARS.master_rules={};this.VARS.lightbox_events={};this.VARS.DeviceAtlas={};this.VARS.DeviceAtlas.primaryHardwareType="";this.VARS.DeviceAtlas.mobileDevice="";this.VARS.DeviceAtlas.isApp="";this.VARS.DeviceAtlas.isTablet="";this.VARS.DeviceAtlas.isMobilePhone="";this.VARS.DeviceAtlas.model="";this.VARS.DeviceAtlas.vendor="";this.VARS.DeviceAtlas.touchScreen="";this.VARS.DeviceAtlas.osName="";this.VARS.DeviceAtlas.osVersion="";this.VARS.DeviceAtlas.browserName="";this.VARS.DeviceAtlas.browserVersion="";this.VARS.DeviceAtlas.osAndroid="";this.VARS.DeviceAtlas.osiOs="";this.VARS.geo_source="";this.VARS.device_source="";this.VARS.PagesNavigated=new Array();this.VARS.PastVisitsText="";}
DIGIOH_ANALYTICS.prototype.onDocumentReady;DIGIOH_ANALYTICS.prototype.loadAllVars;DIGIOH_ANALYTICS.prototype.getDeviceAtlasServerPropsMap
DIGIOH_ANALYTICS.prototype.getDeviceAtlasServerPropsArr
DIGIOH_ANALYTICS.prototype.getDeviceAtlasServerPropsInclude
DIGIOH_ANALYTICS.prototype.reduceDeviceAtlasServerProps
DIGIOH_ANALYTICS.prototype.expandDeviceAtlasServerProps
DIGIOH_ANALYTICS.prototype.expandDeviceAtlasServerPropsFromModulus
DIGIOH_ANALYTICS.prototype.setGeoData;DIGIOH_ANALYTICS.prototype.setDeviceData;DIGIOH_ANALYTICS.prototype.loadMasterRulesViewEvents;DIGIOH_ANALYTICS.prototype.loadMasterRulesSubmitEvents;DIGIOH_ANALYTICS.prototype.loadLightboxActivity;DIGIOH_ANALYTICS.prototype.getBaseDomain;DIGIOH_ANALYTICS.prototype.getBaseDomainName;DIGIOH_ANALYTICS.prototype.formatDate;DIGIOH_ANALYTICS.prototype.formatDateWithSeconds;DIGIOH_ANALYTICS.prototype.formatDateWithSecondsForSalesforce;DIGIOH_ANALYTICS.prototype.getReadableHMS;DIGIOH_ANALYTICS.prototype.padStr;DIGIOH_ANALYTICS.prototype.getSearchEngine;DIGIOH_ANALYTICS.prototype.isGoogleAdWordsUrl=function(landingUrl,referringUrl,search_engine){try{if(landingUrl&&(landingUrl.toLowerCase().indexOf('?gclid=')>0||landingUrl.toLowerCase().indexOf('&gclid=')>0))
return true;if(!referringUrl||!search_engine||search_engine.toLowerCase()!=="google")
return false;return(referringUrl.toLowerCase().indexOf('/aclk?')>0);}
catch(error){this.logError(error,"isGoogleAdWordsUrl");return false;}};DIGIOH_ANALYTICS.prototype.isFacebookUrl;DIGIOH_ANALYTICS.prototype.isAndroidAppUrl;DIGIOH_ANALYTICS.prototype.removeUrlBeginning;DIGIOH_ANALYTICS.prototype.removeUrlProtocol;DIGIOH_ANALYTICS.prototype.removeUrlEnding;DIGIOH_ANALYTICS.prototype.getUrlBaseDomain;DIGIOH_ANALYTICS.prototype.getUrlSubdomain;DIGIOH_ANALYTICS.prototype.doSubdomainsMatch;DIGIOH_ANALYTICS.prototype.hasUTMCampaign;DIGIOH_ANALYTICS.prototype.isStringAnInteger;DIGIOH_ANALYTICS.prototype.updateLightboxActivity;DIGIOH_ANALYTICS.prototype.setLightboxEvent=function(eventKey,lbguid,isOptionalDelete){try{var cookieName="__bxevents";var timestamp=new Date().getTime();var boxShortId='';if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(lbguid)&&DIGIOH_LIGHTBOX_IDS[lbguid]){boxShortId=DIGIOH_LIGHTBOX_IDS[lbguid];}
var key=eventKey;if(key=='view'||key=='v')key='v';else if(key=='submit'||key=='s')key='s';else if(key=='redirect'||key=='r')key='r';else if(key=='download'||key=='d')key='d';else if(key=='close'||key=='c')key='c';if(!this.VARS.lightbox_events.hasOwnProperty(lbguid)&&!this.VARS.lightbox_events.hasOwnProperty(boxShortId)){this.VARS.lightbox_events[boxShortId]={'v':{'c':0,'t':[]},'s':{'c':0,'t':[]},'r':{'c':0,'t':[]},'d':{'c':0,'t':[]},'c':{'c':0,'t':[]}};}else if(this.VARS.lightbox_events.hasOwnProperty(lbguid)&&!this.VARS.lightbox_events.hasOwnProperty(boxShortId)){this.VARS.lightbox_events[boxShortId]=DIGIOH_API.LIGHTBOX.cloneObj(this.VARS.lightbox_events[lbguid]);delete this.VARS.lightbox_events[lbguid];}else if(this.VARS.lightbox_events.hasOwnProperty(lbguid)&&this.VARS.lightbox_events.hasOwnProperty(boxShortId)){delete this.VARS.lightbox_events[lbguid];}
if(this.VARS.lightbox_events[boxShortId].hasOwnProperty(eventKey)){this.VARS.lightbox_events[boxShortId][key]=DIGIOH_API.LIGHTBOX.cloneObj(this.VARS.lightbox_events[boxShortId][eventKey]);delete this.VARS.lightbox_events[boxShortId][eventKey];if(this.VARS.lightbox_events[boxShortId][key].hasOwnProperty('cnt')){this.VARS.lightbox_events[boxShortId][key]['c']=this.VARS.lightbox_events[boxShortId][key]['cnt']+1;delete this.VARS.lightbox_events[boxShortId][key]['cnt'];}else if(this.VARS.lightbox_events[boxShortId][key].hasOwnProperty('c')){this.VARS.lightbox_events[boxShortId][key]['c']++;}else{this.VARS.lightbox_events[boxShortId][key]['c']=1;}}else if(this.VARS.lightbox_events[boxShortId].hasOwnProperty(key)){this.VARS.lightbox_events[boxShortId][key]['c']++;}else{this.VARS.lightbox_events[boxShortId][key]={'c':1,'t':[]};}
if(this.VARS.lightbox_events[boxShortId][key].hasOwnProperty('ts')){this.VARS.lightbox_events[boxShortId][key]['t']=DIGIOH_API.LIGHTBOX.cloneObj(this.VARS.lightbox_events[boxShortId][key]['ts']);delete this.VARS.lightbox_events[boxShortId][key]['ts'];}else if(!this.VARS.lightbox_events[boxShortId][key].hasOwnProperty('t')){this.VARS.lightbox_events[boxShortId][key]['t']=[];}
this.VARS.lightbox_events[boxShortId][key]['t'].push(timestamp);if(typeof isOptionalDelete!=='undefined'&&isOptionalDelete===true){this.VARS.lightbox_events[boxShortId][key]={'c':0,'t':[]};}
this.updateLightboxActivity(eventKey,lbguid,timestamp);DIGIOH_STORAGE.data[cookieName]=this.VARS.lightbox_events;DIGIOH_STORAGE.set();this.logger('ANALYTICS.setLightboxEvent - '+eventKey+' ('+key+')'+', '+lbguid+' ('+boxShortId+'), '+this.VARS.lightbox_events[boxShortId][key]['t'].length);}
catch(error){this.logError(error,"setLightboxEvent");}};DIGIOH_ANALYTICS.prototype.parseLightboxEvents;DIGIOH_ANALYTICS.prototype.loadAllEventsByLightboxGuid;DIGIOH_ANALYTICS.prototype.getLightboxEventCount;DIGIOH_ANALYTICS.prototype.getEventCountByLightbox;DIGIOH_ANALYTICS.prototype.getEventCountAcrossAllLightboxes;DIGIOH_ANALYTICS.prototype.getEventCountAcrossAllLightboxesExcept;DIGIOH_ANALYTICS.prototype.setCurrent;DIGIOH_ANALYTICS.prototype.getCurrent=function(){try{var cookieName="__bxcurr";var cookieVal=DIGIOH_STORAGE.data[cookieName];if(cookieVal){var cobj={};if(typeof cookieVal==='string'&&cookieVal.length>1&&cookieVal.indexOf('{')===0&&cookieVal.substring(cookieVal.length-1)==='}'){cobj=JSON.parse(cookieVal);}else if(typeof cookieVal==='object'&&cookieVal!==null){cobj=cookieVal;}
var domain_protocol=window.parent.location.protocol;var domain_base=window.parent.location.host;this.logger('getCurrent > domain_base = '+domain_base);if(cobj.hasOwnProperty('lurl')){this.VARS.landing_page=domain_protocol+"//"+domain_base+cobj['lurl'];}
if(cobj.hasOwnProperty('rurl')){var refUrl=cobj['rurl'];if(refUrl.length>0&&refUrl.indexOf("://")!==-1){this.VARS.referring_website_url=refUrl;var search_engine=this.getSearchEngine(refUrl);this.VARS.search_engine=search_engine;var isAdWords=false;var isSearchEngine=false;if(this.isFacebookUrl(refUrl)){this.VARS.web_source="Facebook";}else if(this.isAndroidAppUrl(refUrl)){this.VARS.web_source="Android App";}else if(this.isGoogleAdWordsUrl(this.VARS.landing_page,refUrl,search_engine)){this.VARS.web_source="Google AdWords";isAdWords=true;}else if(search_engine!==""){this.VARS.web_source="Organic Search";isSearchEngine=true;}}}
try{if(this.VARS.landing_page||cobj.hasOwnProperty('lurl')){if(this.VARS.referring_website_url.length>0&&this.VARS.web_source!="Google AdWords"&&this.VARS.web_source!="Organic Search"&&!this.doSubdomainsMatch(this.VARS.referring_website_url,this.VARS.landing_page)){this.VARS.web_source="Referring Website";}
if(this.VARS.landing_page.length>0&&this.VARS.landing_page.indexOf('?')!==-1){var queryString=this.VARS.landing_page.split('?')[1];if(queryString.length>0&&queryString.indexOf('=')!==-1){var queryVars=queryString.split('&');for(var i=0;i<queryVars.length;i++){var pair=queryVars[i].split('=');var pairKey=decodeURIComponent(pair[0]).toLowerCase();if(pairKey=="utm_source"||pairKey=="utm_campaign_source"||pairKey=="campaign_source"){this.VARS.utm_campaign_source=decodeURIComponent(pair[1]).split("+").join(" ");}
else if(pairKey=="utm_medium"||pairKey=="utm_campaign_medium"||pairKey=="campaign_medium"){this.VARS.utm_campaign_medium=decodeURIComponent(pair[1]).split("+").join(" ");}
else if(pairKey=="utm_term"||pairKey=="utm_campaign_term"||pairKey=="campaign_term"){this.VARS.utm_campaign_term=decodeURIComponent(pair[1]).split("+").join(" ");}
else if(pairKey=="utm_content"||pairKey=="utm_campaign_content"||pairKey=="campaign_content"){this.VARS.utm_campaign_content=decodeURIComponent(pair[1]).split("+").join(" ");}
else if(pairKey=="utm_campaign"||pairKey=="utm_campaign_name"||pairKey=="campaign_name"){this.VARS.utm_campaign_name=decodeURIComponent(pair[1]).split("+").join(" ");}}}}}}
catch(err){}
if(!this.VARS.ip_address&&cobj.hasOwnProperty('ip')&&cobj['ip']){this.VARS.ip_address=cobj['ip'];this.VARS.landing_page_ip=this.VARS.ip_address;}
if(!this.VARS.device&&cobj.hasOwnProperty('dev')&&cobj['dev'])
this.VARS.device=cobj['dev'];if(!this.VARS.operating_system&&cobj.hasOwnProperty('os')&&cobj['os'])
this.VARS.operating_system=cobj['os'];if(!this.VARS.browser_type&&cobj.hasOwnProperty('bt')&&cobj['bt'])
this.VARS.browser_type=cobj['bt'];if(!this.VARS.browser_version&&cobj.hasOwnProperty('bv')&&cobj['bv'])
this.VARS.browser_version=cobj['bv'];if(!this.VARS.date_of_visit&&cobj.hasOwnProperty('lts')&&cobj['lts'])
this.VARS.date_of_visit=cobj['lts'];if(!this.VARS.continent&&cobj.hasOwnProperty('geo_co')&&cobj['geo_co'])
this.VARS.continent=cobj['geo_co'];if(!this.VARS.country&&cobj.hasOwnProperty('geo_cc')&&cobj['geo_cc'])
this.VARS.country=cobj['geo_cc'];if(!this.VARS.country_name&&cobj.hasOwnProperty('geo_cn')&&cobj['geo_cn'])
this.VARS.country_name=cobj['geo_cn'];if(!this.VARS.region_name&&cobj.hasOwnProperty('geo_rn')&&cobj['geo_rn'])
this.VARS.region_name=cobj['geo_rn'];if(!this.VARS.state&&cobj.hasOwnProperty('geo_s')&&cobj['geo_s'])
this.VARS.state=cobj['geo_s'];if(!this.VARS.city&&cobj.hasOwnProperty('geo_c')&&cobj['geo_c'])
this.VARS.city=cobj['geo_c'];if(!this.VARS.zipcode&&cobj.hasOwnProperty('geo_z')&&cobj['geo_z'])
this.VARS.zipcode=cobj['geo_z'];if(!this.VARS.latitude&&cobj.hasOwnProperty('geo_lat')&&cobj['geo_lat'])
this.VARS.latitude=cobj['geo_lat'];if(!this.VARS.longitude&&cobj.hasOwnProperty('geo_lon')&&cobj['geo_lon'])
this.VARS.longitude=cobj['geo_lon'];if(!this.VARS.metro_code&&cobj.hasOwnProperty('geo_mc')&&cobj['geo_mc'])
this.VARS.metro_code=cobj['geo_mc'];if(!this.VARS.time_zone&&cobj.hasOwnProperty('geo_tz')&&cobj['geo_tz'])
this.VARS.time_zone=cobj['geo_tz'];if(!this.VARS.area_code&&cobj.hasOwnProperty('geo_ac')&&cobj['geo_ac'])
this.VARS.area_code=cobj['geo_ac'];var pvCurr='';var pvTempArray=new Array();var pvResultArray=new Array();if(this.VARS.landing_page.length>0){this.VARS.pages_navigated=this.VARS.landing_page+"|";pvResultArray.push(this.VARS.landing_page);}
if(DIGIOH_STORAGE.storage_type==='cookie'){pvTempArray=DIGIOH_LOCAL_STORAGE.getManual('xdibx_pgsnavurls');}
else if(cobj.hasOwnProperty('purl')&&cobj['purl'].length>0){pvTempArray=cobj['purl'];}
if(typeof pvTempArray==='object'&&pvTempArray.length>0){for(var i=0;i<pvTempArray.length;i++){if(pvTempArray[i].length>0){pvCurr=domain_protocol+"//"+domain_base+pvTempArray[i];pvResultArray.push(pvCurr);this.VARS.pages_navigated+=pvCurr+"|";}}
if(this.VARS.pages_navigated.indexOf("|")>=0){this.VARS.pages_navigated=this.VARS.pages_navigated.substring(0,this.VARS.pages_navigated.length-1);}
this.VARS.PagesNavigated=pvResultArray;}else if(this.VARS.landing_page.length>0){this.VARS.pages_navigated=this.VARS.landing_page;this.VARS.PagesNavigated=new Array();this.VARS.PagesNavigated.push(this.VARS.landing_page);}
if(this.VARS.pages_navigated.length===0||this.VARS.PagesNavigated.length===0){if(this.VARS.current_page_url.length>0){this.VARS.pages_navigated=this.VARS.current_page_url;this.VARS.PagesNavigated=new Array();this.VARS.PagesNavigated.push(this.VARS.current_page_url);}}
if(this.VARS.pages_navigated.length>0&&this.VARS.pages_navigated.indexOf(this.VARS.current_page_url)<0){this.VARS.pages_navigated+="|"+this.VARS.current_page_url;if(typeof this.VARS.PagesNavigated==='object'&&this.VARS.PagesNavigated){this.VARS.PagesNavigated.push(this.VARS.current_page_url);}}
if(this.VARS.PagesNavigated.length>=2&&this.VARS.PagesNavigated[0]==this.VARS.PagesNavigated[1])
{this.VARS.PagesNavigated.shift();}
this.logger('getCurrent > this.VARS.pages_navigated > '+this.VARS.pages_navigated.length);this.logger(this.VARS.pages_navigated);this.logger(this.VARS.PagesNavigated);if(this.VARS.date_of_visit>0){this.VARS.date_of_visit=new Date(this.VARS.date_of_visit);}else{this.VARS.date_of_visit=new Date();}}}
catch(error){this.logError(error,"getCurrent");}
return false;};DIGIOH_ANALYTICS.prototype.getCurrentEncoded=function(){try{return DIGIOH_COOKIE.getEncoded("__bxcurr");}
catch(error){this.logError(error,"getCurrentEncoded");}};DIGIOH_ANALYTICS.prototype.setPrevious=function(){try{var cookieName="__bxprev";var cookieVal=DIGIOH_STORAGE.data[cookieName];var timestamp=new Date().getTime();if(cookieVal&&((typeof cookieVal==='string'&&cookieVal.length>0)||(typeof cookieVal==='object'&&cookieVal.hasOwnProperty('days')))){this.IsNewVisitor=false;if(!this.VARS.IsPreview){var cobj={};if(typeof cookieVal==='object'){cobj=cookieVal;}
else if(typeof cookieVal==='string'&&cookieVal.indexOf('{')>=0&&cookieVal.indexOf('{')<=2){cobj=JSON.parse(cookieVal);}
if(cobj&&cobj.hasOwnProperty('days')){var allDays=cobj['days'];var prev=new Date(allDays[allDays.length-1]);prev=new Date(prev.getFullYear(),prev.getMonth(),prev.getDate(),0,0,0,0);var curr=new Date(timestamp);curr=new Date(curr.getFullYear(),curr.getMonth(),curr.getDate(),0,0,0,0);if(curr.getTime()>prev.getTime()){allDays.push(timestamp);cobj['days']=allDays;DIGIOH_STORAGE.data[cookieName]=cobj;DIGIOH_STORAGE.set();}}
else if(typeof cookieVal==='string'&&cookieVal.length>0&&cookieVal.indexOf('|')>=0){var allDays=cookieVal.split("|");var prev=new Date(parseInt(allDays[allDays.length-1]));prev=new Date(prev.getFullYear(),prev.getMonth(),prev.getDate(),0,0,0,0);var curr=new Date(timestamp);curr=new Date(curr.getFullYear(),curr.getMonth(),curr.getDate(),0,0,0,0);if(curr.getTime()>prev.getTime()){allDays.push(timestamp+'');var cobj={};cobj['days']=[];for(var i=0;i<allDays.length;i++){cobj['days'].push(parseInt(allDays[i]));}
DIGIOH_STORAGE.data[cookieName]=cobj;DIGIOH_STORAGE.set();}}}}
else{var cobj={};cobj['days']=[timestamp];DIGIOH_STORAGE.data[cookieName]=cobj;DIGIOH_STORAGE.set();}}
catch(error){this.logError(error,"setPrevious");}};DIGIOH_ANALYTICS.prototype.getPrevious;DIGIOH_ANALYTICS.prototype.getPreviousEncoded;DIGIOH_ANALYTICS.prototype.setDevice;DIGIOH_ANALYTICS.prototype.logger;DIGIOH_ANALYTICS.prototype.logError;(function(window,document,iframewin){var STOPWATCH=new Date().getTime();var VENDOR_GUID=DIGIOH_VENDOR_GUID;var IS_PREVIEW=(typeof DIGIOH_IS_PREVIEW!=="undefined"&&DIGIOH_IS_PREVIEW===true);var IS_DEV=(typeof DIGIOH_IS_DEV!=="undefined"&&DIGIOH_IS_DEV==true);var IS_QA=(typeof DIGIOH_IS_QA!=="undefined"&&DIGIOH_IS_QA==true);var PROTOCOL=('https:'==document.location.protocol?'https://':'http://');var PROTOCOL_USER_OVERRIDE=((typeof DIGIOH_USE_HTTPS_ONLY!=="undefined"&&DIGIOH_USE_HTTPS_ONLY===true)?'https://':PROTOCOL);var __CDNDomainWithProtocol=PROTOCOL_USER_OVERRIDE+DIGIOH_CDN_DOMAIN;var __CDNStaticFilesPath=PROTOCOL_USER_OVERRIDE+DIGIOH_CDN_DOMAIN+'/static/';var __CDNVendorFilesPath=PROTOCOL_USER_OVERRIDE+DIGIOH_CDN_DOMAIN+'/vendor/';var CLOSE_BUTTON_URL=PROTOCOL_USER_OVERRIDE+"cdn.jsdelivr.net/fancybox/2.1.5/fancybox_sprite.png";var BASE_URL=PROTOCOL_USER_OVERRIDE+document.location.href.split('/')[2];if(BASE_URL.indexOf('?')>0)BASE_URL=BASE_URL.split('?')[0];if(BASE_URL.indexOf('#')>0)BASE_URL=BASE_URL.split('#')[0];var SHOW_ERRORS=(typeof console!=="undefined"&&typeof DIGIOH_USE_CONSOLE!=="undefined"&&DIGIOH_USE_CONSOLE)||IS_DEV||IS_QA;var LIGHTBOX_GUID='';var CLIENT_GUID='';var KEEN_CLIENT='';var KEEN_CLIENT_2='';var WIDGET_DIV='';var CURRENT_IFRAME_SRC='';var SIDEBAR_ELEMENT_ID='';var CHILD_READY={};var GEO_IP={};var GEO_LOADED=false;var GEO_LOADING=false;var CLICK_SELECTORS=new Array();var HOVER_SELECTORS=new Array();var EXISTS_SELECTORS=new Array();var SCROLL_BOXES_ARR=new Array();var EXIT_BOXES_ARR=new Array();var TIME_BOXES_ARR=new Array();var LOADED_LIGHTBOXES=[];var KEEN_SCHEMA={};var LIGHTBOX_OPEN_TIME=0;var CURR_SCROLL_TOP=0;var TEASER_LIGHTBOX_GUIDS={};var FOCUSED_SIDEBAR_BANNER_GUIDS={};var PREVENT_SIDEBAR_CLOSE_GUIDS={};var ELIGIBLE_SIDEBAR_CLOSE_SCROLL_GUIDS={};var ELIGIBLE_SIDEBAR_CLOSE_SCROLL_SIDS={};var IS_REDIRECTING_PARENT=false;var IS_PREVIEW_EVENT=false;var CURR_TIME=0;var WAS_IMPRESSION_REGISTERED={};var WAS_REDIRECT_REGISTERED={};var WAS_SUBMIT_REGISTERED={};var WAS_DOWNLOAD_REGISTERED={};var WAS_CUSTOM_EVENT_REGISTERED={};var LIGHTBOX_TO_VARIATION_MAP={};var PRELOADED_LIGHTBOXES=[];var PRELOADED_LIGHTBOXES_LOADED=[];var TERMINATED_LIGHTBOXES={};var EFFECTS=DIGIOH_LIGHTBOX_EFFECTS;var CONDITION_SELECTOR_BOXES_MAP={};var SIDEBAR_CLOSE_MAP={};var BANNER_CLOSE_MAP={};var LOADED_BOX_DOM_ID_MAP={};var MOBILE_SCROLL_TOP_MAP={};var COOKIES_DISABLED=false;var DIGIOH_IDENTITY_CHILD_IFRAME=null;var DIGIOH_IS_READY=false;var CONDITIONS_OUTPUT={};var jqWin;var jqDoc;var body;var TS_EVAL_PREV={};var SS_EVAL_PREV={};var IDLE_PERIOD=5;var IDLE_INTERVAL=0;var TOTAL_INTERVAL=0;var IDLE_TIME=0;var TOTAL_TIME=0;var ERROR_LOG_TEMP_ARR=[];var AB_BOXES_TAKE_MAP={};var AB_BOXES_SKIP_MAP={};var BLIP_ARR=[];var BLIP_MATCHED=-1;var FirebaseRef=null;var IsFirebaseRefSet=false;var FirebaseTimeOffset=0;var IsFirebaseTimeSet=false;var IsFirebaseLoaded=false;var AfterDomLoadedHasRun=false;var FANCY_REPOSITION_LOCKED={};var CURRENT_PAGE_DIMS_RESPONSIVE={};var CURRENT_PAGE_DIMS={};var CURRENT_PAGE={};var ANALYTICS_JSONP_RESPONSE={};var INIT_DEPENDENT_SCRIPTS_HAS_RUN=false;var IS_LIGHTBOX_CLOSING={};var isEmbedInlineLightboxConditionsFormsFinished=false;var DIGIOH_LIGHTBOX_INLINE_DISPLAYED=[];if(typeof DIGIOH_LIGHTBOX_NAMES==='undefined'){DIGIOH_LIGHTBOX_NAMES={};}
if(typeof DIGIOH_LIGHTBOX_IDS==='undefined'){DIGIOH_LIGHTBOX_IDS={};}
if(typeof DIGIOH_LIGHTBOX_TEASER_PRELOAD_ARR==='undefined'){DIGIOH_LIGHTBOX_TEASER_PRELOAD_ARR=[];}
if(typeof DIGIOH_LIGHTBOX_TEASER_FOLLOW_ME_ARR==='undefined'){DIGIOH_LIGHTBOX_TEASER_FOLLOW_ME_ARR=[];}
if(typeof DIGIOH_LIGHTBOX_INLINE_ALWAYS_ARR==='undefined'){DIGIOH_LIGHTBOX_INLINE_ALWAYS_ARR=[];}
if(typeof DIGIOH_LIGHTBOX_INLINE_CONDITIONS_ARR==='undefined'){DIGIOH_LIGHTBOX_INLINE_CONDITIONS_ARR=[];}
if(typeof DIGIOH_LIGHTBOX_INLINE_DEPENDENT_ARR==='undefined'){DIGIOH_LIGHTBOX_INLINE_DEPENDENT_ARR=[];}
function appendFbDigiohCss(){var h=document.head||document.getElementsByTagName('head')[0];var l=document.createElement('link');l.type='text/css';l.rel='stylesheet';l.media='screen';l.href=__CDNStaticFilesPath+'fb_lightbox.2.1.5.css'+'?cb='+DIGIOH_CACHE_VERSION;h.appendChild(l);}
function preloadEffectsImages(){if(typeof DIGIOH_EFFECTS_IMAGE_CACHE_ARR!=="undefined"&&DIGIOH_EFFECTS_IMAGE_CACHE_ARR.length>0){var preloadedImages=new Array();for(var i=0;i<DIGIOH_EFFECTS_IMAGE_CACHE_ARR.length;i++){preloadedImages[i]=new Image();preloadedImages[i].src=PROTOCOL_USER_OVERRIDE+"s3.lightboxcdn.com/vendors/"+VENDOR_GUID+"/uploads/"+DIGIOH_EFFECTS_IMAGE_CACHE_ARR[i];}
var preloadedCloseButton=new Image();preloadedCloseButton.src=CLOSE_BUTTON_URL;}}
function preloadSettingsImages(){if(typeof DIGIOH_SETTINGS_IMAGE_CACHE_ARR!=="undefined"&&DIGIOH_SETTINGS_IMAGE_CACHE_ARR.length>0){var preloadedImages=new Array();for(var i=0;i<DIGIOH_SETTINGS_IMAGE_CACHE_ARR.length;i++){preloadedImages[i]=new Image();preloadedImages[i].src=PROTOCOL_USER_OVERRIDE+"s3.lightboxcdn.com/vendors/"+VENDOR_GUID+"/uploads/"+DIGIOH_SETTINGS_IMAGE_CACHE_ARR[i];}}}
var generateGuidWithTimestamp
var generateGuid
function loadClientGuid(){try{if(!DIGIOH_STORAGE.data.hasOwnProperty("__bxcid")||typeof DIGIOH_STORAGE.data["__bxcid"]!=='string'||DIGIOH_STORAGE.data["__bxcid"].length<7){DIGIOH_STORAGE.data["__bxcid"]=generateGuidWithTimestamp();}
CLIENT_GUID=DIGIOH_STORAGE.data["__bxcid"];}
catch(e){logError(e,"loadClientGuid");}}
var getClientGuid=function(){return CLIENT_GUID;};var removeOldCookieData=function(foundData){try{var cookieVal='';if(!foundData){cookieVal=DIGIOH_COOKIE.get(DIGIOH_VENDOR_GUID);if(cookieVal==null||cookieVal.length==0){cookieVal=DIGIOH_COOKIE.get('xdibx');}
if(cookieVal!==null&&cookieVal.length>0&&cookieVal.indexOf("{")>=0&&cookieVal.indexOf("{")<=2){var json=JSON.parse(cookieVal);if(typeof json==='object'&&json!==null&&json.hasOwnProperty('__bxcurr')){DIGIOH_STORAGE.data=json;DIGIOH_STORAGE.set();foundData=true;}}}
if(!foundData){DIGIOH_STORAGE.data={};cookieVal=DIGIOH_COOKIE.get("__bxcurr");if(cookieVal!==null&&cookieVal.length>0&&cookieVal.indexOf("{")>=0&&cookieVal.indexOf("{")<=2){DIGIOH_STORAGE.data["__bxcurr"]=JSON.parse(cookieVal);}else if(cookieVal!==null&&cookieVal){DIGIOH_STORAGE.data["__bxcurr"]=cookieVal;}else{DIGIOH_STORAGE.data["__bxcurr"]={};}
cookieVal=DIGIOH_COOKIE.get("__bxprev");if(cookieVal!==null&&cookieVal.length>0&&cookieVal.indexOf("{")>=0&&cookieVal.indexOf("{")<=2){DIGIOH_STORAGE.data["__bxprev"]=JSON.parse(cookieVal);}else if(cookieVal!==null&&cookieVal){DIGIOH_STORAGE.data["__bxprev"]=cookieVal;}else{DIGIOH_STORAGE.data["__bxprev"]={};}
cookieVal=DIGIOH_COOKIE.get("__bxevents");if(cookieVal!==null&&cookieVal.length>0&&cookieVal.indexOf("{")>=0&&cookieVal.indexOf("{")<=2){DIGIOH_STORAGE.data["__bxevents"]=JSON.parse(cookieVal);}else if(cookieVal!==null&&cookieVal){DIGIOH_STORAGE.data["__bxevents"]=cookieVal;}else{DIGIOH_STORAGE.data["__bxevents"]={};}
cookieVal=DIGIOH_COOKIE.getEncoded("__bxcid");if(cookieVal!==null&&cookieVal.length>0){DIGIOH_STORAGE.data["__bxcid"]=cookieVal;DIGIOH_API.log('found existing client_id: '+cookieVal);}else{DIGIOH_STORAGE.data["__bxcid"]=generateGuidWithTimestamp();DIGIOH_API.log('generated new client_id: '+DIGIOH_STORAGE.data["__bxcid"]);}
DIGIOH_STORAGE.set();}
if(DIGIOH_STORAGE.storage_type==='local_storage'||(DIGIOH_STORAGE.storage_type==='cross_domain'&&DIGIOH_CROSS_DOMAIN.isWorking)){if(DIGIOH_COOKIE.get(DIGIOH_VENDOR_GUID,true)!==null)
DIGIOH_COOKIE.erase(DIGIOH_VENDOR_GUID);if(DIGIOH_COOKIE.get('xdibx',true)!==null)
DIGIOH_COOKIE.erase('xdibx');}
if(!DIGIOH_STORAGE.data.hasOwnProperty("__bxcurr")){DIGIOH_STORAGE.data["__bxcurr"]={};}
if(!DIGIOH_STORAGE.data.hasOwnProperty("__bxprev")){DIGIOH_STORAGE.data["__bxprev"]={};}
if(!DIGIOH_STORAGE.data.hasOwnProperty("__bxevents")){DIGIOH_STORAGE.data["__bxevents"]={};}
if(!DIGIOH_STORAGE.data.hasOwnProperty("__bxcid")){DIGIOH_STORAGE.data["__bxcid"]=generateGuidWithTimestamp();}
DIGIOH_COOKIE.erase('__bxcurr');DIGIOH_COOKIE.erase('__bxprev');DIGIOH_COOKIE.erase('__bxevents');DIGIOH_COOKIE.erase('__bxcid');DIGIOH_COOKIE.erase('__bxtest');DIGIOH_COOKIE.erase('__lbxcurr');DIGIOH_COOKIE.erase('__lbxprev');DIGIOH_COOKIE.erase('__lbxevents');DIGIOH_COOKIE.erase('__lbxcid');if(DIGIOH_STORAGE.storage_type==='local_storage'||DIGIOH_STORAGE.storage_type==='cross_domain')
{DIGIOH_COOKIE.erase('xdibx');}
afterDomLoadedAndStorageLoadedAndPostMessageInit();}
catch(e){logError(e,"removeOldCookieData");afterDomLoadedAndStorageLoadedAndPostMessageInit();}};var loadAllClientSideDataFromClientStorage=function(){try{DIGIOH_API.log('loadAllClientSideDataFromClientStorage() --> storage_type = '+DIGIOH_STORAGE.storage_type);DIGIOH_STORAGE.get);}
catch(e){logError(e,"loadAllClientSideDataFromClientStorage");removeOldCookieData(false);}};function setIsCrossDomainStorageWorking(cnt){try{var testVal='abcxyz';DIGIOH_CROSS_DOMAIN.setManual('__bxtest',testVal);DIGIOH_CROSS_DOMAIN.getManual('__bxtest');}
catch(e){logError(e,"setIsCrossDomainStorageWorking");DIGIOH_CROSS_DOMAIN.isWorking=false;DIGIOH_API.log('setIsCrossDomainStorageWorking exception: cnt='+cnt);loadAllClientSideDataFromClientStorage();}}
var areCookiesDisabled=function(){try{if(COOKIES_DISABLED){return true;}
DIGIOH_COOKIE.setDecoded('__bxtest','xyz');var cv=DIGIOH_COOKIE.getEncoded('__bxtest');if(cv!==null&&cv==='xyz'){COOKIES_DISABLED=false;DIGIOH_COOKIE.erase('__bxtest');return false;}else{COOKIES_DISABLED=true;return true;}}
catch(e){logError(e,"areCookiesDisabled");COOKIES_DISABLED=true;return true;}}
function tryLoadMaxmind(){try{var frameSrc=__CDNStaticFilesPath+'maxmind.html#'+encodeURIComponent(document.location.href);body.append("<iframe title='maxmind iframe' src='"+frameSrc+"' sandbox='allow-same-origin allow-top-navigation allow-scripts' width='1' height='1' frameborder='0' scrolling='no' style='position: absolute; right: -10px; top: -10px;'></iframe>");}
catch(e){logError(e,"tryLoadMaxmind");}}
function checkDocumentReadyState(){try{if(document.readyState==="complete"||document.readyState==="loaded"||document.readyState==="interactive"){logger("STOPWATCH (DOMContentLoaded) - "+Math.ceil((new Date().getTime()-STOPWATCH)/1000));afterDomLoaded();}else{setTimeout(checkDocumentReadyState,250);}}
catch(e){logError(e,"checkDocumentReadyState");}}
function afterScriptLoaded(){try{cfPageview();DIGIOH_STORAGE.setStorageType();initKeen();logger("STOPWATCH (afterScriptLoaded) - "+Math.ceil((new Date().getTime()-STOPWATCH)/1000));if(DIGIOH_API.contains(location.host,'.digioh.com')){DIGIOH_API.printAll();}}
catch(e){logError(e,"afterScriptLoaded");}
try{JQUERY_DIGIOH(document).ready(function(){logger("STOPWATCH ($(document).ready) - "+Math.ceil((new Date().getTime()-STOPWATCH)/1000));afterDomLoaded();});checkDocumentReadyState();if(typeof ClientJsDomMaxWaitSeconds==='number'&&ClientJsDomMaxWaitSeconds>0){setTimeout,ClientJsDomMaxWaitSeconds*1000);}}
catch(e){logError(e,"afterScriptLoaded");}}
function afterDomLoaded(){try{if(!AfterDomLoadedHasRun){AfterDomLoadedHasRun=true;logger("STOPWATCH (afterDomLoaded) - "+Math.ceil((new Date().getTime()-STOPWATCH)/1000));initPostMessageReceiver();if(DIGIOH_STORAGE.storage_type==='cross_domain'){DIGIOH_CROSS_DOMAIN.callbacks['999999999'];createIdentityIframe();setTimeout,2000);}
else if(DIGIOH_STORAGE.storage_type==='local_storage'){loadAllClientSideDataFromClientStorage();}
else if(DIGIOH_STORAGE.storage_type==='cookie'){loadAllClientSideDataFromClientStorage();}}}
catch(e){logError(e,"afterDomLoaded");}}
function afterDomLoadedAndStorageLoadedAndPostMessageInit(){try{loadClientGuid();jqWin=JQUERY_DIGIOH(window);jqDoc=JQUERY_DIGIOH(document);body=JQUERY_DIGIOH('body');if(JQUERY_DIGIOH('.digioh-lightbox-container').length){WIDGET_DIV=JQUERY_DIGIOH("div.digioh-lightbox-container:first");WIDGET_DIV.hide();}
preloadEffectsImages();preloadSettingsImages();initBugsnag();DIGIOH_LIGHTBOX_ANALYTICS=new DIGIOH_ANALYTICS(JQUERY_DIGIOH,SHOW_ERRORS,VENDOR_GUID,IS_PREVIEW,BASE_URL);initDigiohVars();if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.ip_address!==''){if(JQUERY_DIGIOH.inArray(DIGIOH_LIGHTBOX_ANALYTICS.VARS.ip_address,BLIP_ARR)>-1){BLIP_MATCHED=1;}else{BLIP_MATCHED=0;}}
analyticsGeoDeviceCDP();}
catch(e){logError(e,"afterDomLoadedAndStorageLoadedAndPostMessageInit");}}
function embedInlineLightboxAlwaysForms(){try{for(var i=0;i<DIGIOH_LIGHTBOX_INLINE_ALWAYS_ARR.length;i++){if(!DIGIOH_API.contains(DIGIOH_LIGHTBOX_INLINE_DISPLAYED,DIGIOH_LIGHTBOX_INLINE_ALWAYS_ARR[i])&&!AB_BOXES_SKIP_MAP.hasOwnProperty(DIGIOH_LIGHTBOX_INLINE_ALWAYS_ARR[i])){var embedSuccess=embedInlineLightboxForm(DIGIOH_LIGHTBOX_INLINE_ALWAYS_ARR[i]);if(embedSuccess){DIGIOH_LIGHTBOX_INLINE_DISPLAYED.push(DIGIOH_LIGHTBOX_INLINE_ALWAYS_ARR[i]);}}}
logger('embedInlineLightboxAlwaysForms: '+DIGIOH_LIGHTBOX_INLINE_ALWAYS_ARR.length);}
catch(e){logError(e,"embedInlineLightboxAlwaysForms");}}
var embedInlineLightboxForm=function(lid){try{setPixelThreshold(lid,true);if(EFFECTS[lid].inline.removal_rules==='remove'){if(DIGIOH_LIGHTBOX_ANALYTICS.getEventCountByLightbox("submit",lid)>0||DIGIOH_LIGHTBOX_ANALYTICS.getEventCountByLightbox("redirect",lid)>0){logger('DIGIOH: Inline Form - Removal Rules - remove after conversion - '+lid);return false;}}
var var_id='';var orig_lid=lid;if(DIGIOH_VARIATION_TO_BOX_MAP.hasOwnProperty(lid)){orig_lid=DIGIOH_VARIATION_TO_BOX_MAP[lid];var_id=lid;}else if(LIGHTBOX_TO_VARIATION_MAP.hasOwnProperty(lid)){var_id=LIGHTBOX_TO_VARIATION_MAP[lid];}
if(var_id!==''&&var_id.length>7)
{lid=var_id;}
if(!IS_PREVIEW||IS_DEV){if(doesInlineLightboxHaveCustomJsType(lid,'display')||doesInlineLightboxHaveCustomJsType(lid,'all')){var customJsSuperResult=DIGIOH_CUSTOM_JS_SUPER.runCustomJsBeforeLightboxDisplay(window.DIGIOH_API,window,document,JQUERY_DIGIOH,orig_lid,var_id,getCustomJsMetadata(orig_lid));logger('JS_GLOBAL.runCustomJsBeforeLightboxDisplay - '+lid);if(!customJsSuperResult){logger('JS_GLOBAL.runCustomJsBeforeLightboxDisplay - prevented lightbox '+lid+' from being displayed');return false;}
var customJsResult=DIGIOH_CUSTOM_JS.runCustomJsBeforeLightboxDisplay(window.DIGIOH_API,window,document,JQUERY_DIGIOH,orig_lid,var_id,getCustomJsMetadata(orig_lid));logger('JS_PARENT.runCustomJsBeforeLightboxDisplay - '+lid);if(!customJsResult){logger('JS_PARENT.runCustomJsBeforeLightboxDisplay - prevented lightbox '+lid+' from being displayed');return false;}}}
var style='';var pref=getPagePref(lid);var is_responsive=false;if(EFFECTS[lid].hasOwnProperty(pref+'responsive')&&EFFECTS[lid][pref+'responsive'].use){is_responsive=true;}else{style+="width:"+getBoxWidth(lid)+"px;";style+="height:"+getBoxHeight(lid)+"px;";}
style+="z-index:9938010;";if(EFFECTS[lid].inline.border.style==='none'||EFFECTS[lid].inline.border.width==='0'||EFFECTS[lid].inline.border.width===0){style+='border-style:none;';style+='border-width:0px;';}else{style+='border-color:'+EFFECTS[lid].inline.border.color+';';style+='border-style:'+EFFECTS[lid].inline.border.style+';';style+='border-width:'+EFFECTS[lid].inline.border.width+'px;';style+='border-radius:'+EFFECTS[lid].inline.border.radius+'px;';}
var resPreloadIframe=false;if(IS_PREVIEW){style+='position:absolute;';if(is_responsive){style+='top:0;';style+='left:0;';}else{style+='top:50%;';style+='left:50%;';style+='margin-top:'+(1-Math.round(getBoxHeight(lid)/2))+'px;';style+='margin-left:'+(1-Math.round(getBoxWidth(lid)/2))+'px;';}
if(EFFECTS[lid].inline.css.indexOf(':')>0&&EFFECTS[lid].inline.css.indexOf(';')>0){style+=EFFECTS[lid].inline.css;}
resPreloadIframe=preloadIframe(lid,style,'','','');}else if(EFFECTS[lid].inline.position_using=='absolute'||EFFECTS[lid].inline.position_using=='fixed'){style+='position:'+EFFECTS[lid].inline.position_using+';';if(EFFECTS[lid].inline.position.top>0||EFFECTS[lid].inline.position.bottom==0){style+='top:'+EFFECTS[lid].inline.position.top+'px;';}else{style+='bottom:'+EFFECTS[lid].inline.position.bottom+'px;';}
if(EFFECTS[lid].inline.position.left>0||EFFECTS[lid].inline.position.right==0){style+='left:'+EFFECTS[lid].inline.position.left+'px;';}else{style+='right:'+EFFECTS[lid].inline.position.right+'px;';}
if(EFFECTS[lid].inline.css.indexOf(':')>0&&EFFECTS[lid].inline.css.indexOf(';')>0){style+=EFFECTS[lid].inline.css;}
resPreloadIframe=preloadIframe(lid,style,'','','');}else if(EFFECTS[lid].inline.position_using=='jquery_selector'){var jquery_selector=EFFECTS[lid].inline.jquery_selector;var jquery_method=EFFECTS[lid].inline.jquery_method;var clear='';if(!JQUERY_DIGIOH(jquery_selector).length)
{logger('embedInlineLightboxForm: jquery_selector not found for '+lid+'('+jquery_selector+')');return false;}
if(EFFECTS[lid].inline.margin.top>0)
style+='margin-top:'+EFFECTS[lid].inline.margin.top+'px;';if(EFFECTS[lid].inline.margin.right>0)
style+='margin-right:'+EFFECTS[lid].inline.margin.right+'px;';if(EFFECTS[lid].inline.margin.bottom>0)
style+='margin-bottom:'+EFFECTS[lid].inline.margin.bottom+'px;';if(EFFECTS[lid].inline.margin.left>0)
style+='margin-left:'+EFFECTS[lid].inline.margin.left+'px;';if(EFFECTS[lid].inline.float!=='none'&&EFFECTS[lid].inline.float!==''){style+='float:'+EFFECTS[lid].inline.float+';';if(EFFECTS[lid].inline.clear!=='none'&&EFFECTS[lid].inline.clear!==''){clear='<div style="float:none;clear:'+EFFECTS[lid].inline.clear+';"></div>';}}
if(EFFECTS[lid].inline.css.indexOf(':')>0&&EFFECTS[lid].inline.css.indexOf(';')>0){style+=EFFECTS[lid].inline.css;}
resPreloadIframe=preloadIframe(lid,style,jquery_selector,jquery_method,clear);}else if(EFFECTS[lid].inline.position_using=='smart_tag'||EFFECTS[lid].inline.position_using=='google_amp'){var jquery_selector='';if(var_id===lid){jquery_selector='#variation-inline-form-'+var_id;}else{jquery_selector='#lightbox-inline-form-'+lid;}
if(!JQUERY_DIGIOH(jquery_selector).length){return false;}
var jquery_method=EFFECTS[lid].inline.jquery_method||'append';style+='margin-top:'+EFFECTS[lid].inline.margin.top+'px;';style+='margin-right:'+EFFECTS[lid].inline.margin.right+'px;';style+='margin-bottom:'+EFFECTS[lid].inline.margin.bottom+'px;';style+='margin-left:'+EFFECTS[lid].inline.margin.left+'px;';if(EFFECTS[lid].inline.css.indexOf(':')>0&&EFFECTS[lid].inline.css.indexOf(';')>0){style+=EFFECTS[lid].inline.css;}
resPreloadIframe=preloadIframe(lid,style,jquery_selector,jquery_method,'');}else if(EFFECTS[lid].inline.position_using=='custom_function'){resPreloadIframe=preloadIframe(lid,style,'','','');}else{logger('found no effects for inline form');}
return resPreloadIframe;}
catch(e){logError(e,"embedInlineLightboxForm");return false;}}
function initDigiohVars(){try{if(typeof DIGIOH_VARS==='undefined'){DIGIOH_VARS={};}
try{var useLZ=(typeof USE_LZ==='undefined'||USE_LZ==true);if(typeof DIGIOH_BLIP_LZ!=='undefined'&&useLZ){BLIP_ARR=JSON.parse(LZString.decompressFromBase64(DIGIOH_BLIP_LZ));}}
catch(e1){BLIP_ARR=[];logErrorText("DIGIOH_BLIP_LZ_INITDIGIOHVARS","DIGIOH_BLIP_LZ_INITDIGIOHVARS");}}
catch(e){logError(e,"initDigiohVars");}}
function initDependentScripts(){try{if(!INIT_DEPENDENT_SCRIPTS_HAS_RUN){INIT_DEPENDENT_SCRIPTS_HAS_RUN=true;initAnalytics();initFancyboxEffects();customJsSuperOnDocumentReadyCallback();}}
catch(e){logError(e,"initDependentScripts");}}
var customJsSuperOnDocumentReadyCallback=function(){try{var customJsSuperResult=true;if(!IS_PREVIEW||IS_DEV){customJsSuperResult=DIGIOH_CUSTOM_JS_SUPER.runCustomJsOnDocumentReady(window.DIGIOH_API,window,document,JQUERY_DIGIOH,getCustomJsMetadata(''));logger('JS_GLOBAL.runCustomJsOnDocumentReady()');}
if(typeof customJsSuperResult==='string'&&customJsSuperResult.indexOf('async_retry')===0){logger('JS_GLOBAL.customJsSuperOnDocumentReadyCallback() - async_retry - retrying in 300ms...');setTimeout(function(){customJsSuperOnDocumentReadyCallback();},300);}else if(typeof customJsSuperResult==='string'&&customJsSuperResult.indexOf('async_callback')===0){logger('JS_GLOBAL.customJsSuperOnDocumentReadyCallback() - async_callback - waiting for callback...');return;}else{logger('JS_GLOBAL.customJsSuperOnDocumentReadyCallback()');customJsSuperOnDocumentReadyComplete(customJsSuperResult);}}
catch(e){logError(e,"customJsSuperOnDocumentReadyCallback");}}
function customJsSuperOnDocumentReadyComplete(customJsSuperResult){try{logger("STOPWATCH (customJsSuperOnDocumentReadyComplete) - "+Math.ceil((new Date().getTime()-STOPWATCH)/1000));if(typeof customJsSuperResult!=='boolean'||customJsSuperResult===true){customJsOnDocumentReadyCallback();}else{logger('JS_GLOBAL.runCustomJsOnDocumentReady() returned false, execution of JS has been stopped.  Checking for embedded inline forms...');setEligibleInlineLightboxesAfterDocReadyFalseCustomJS();if(DIGIOH_LIGHTBOX_INLINE_ALWAYS_ARR.length>0||DIGIOH_LIGHTBOX_INLINE_CONDITIONS_ARR.length>0){initABSplitTests();initVariations();initLightboxActivity();buildConditionSelectorsToBoxesMap();embedInlineLightboxAlwaysForms();embedInlineLightboxConditionsForms();}}}
catch(e){logError(e,"customJsSuperOnDocumentReadyComplete");}}
var customJsOnDocumentReadyCallback=function(){try{var customJsResult=true;if(!IS_PREVIEW||IS_DEV){customJsResult=DIGIOH_CUSTOM_JS.runCustomJsOnDocumentReady(window.DIGIOH_API,window,document,JQUERY_DIGIOH,getCustomJsMetadata(''));logger('DIGIOH: DIGIOH_CUSTOM_JS.runCustomJsOnDocumentReady()');}
if(typeof customJsResult==='string'&&customJsResult.indexOf('async_retry')===0){logger('DIGIOH: customJsOnDocumentReadyCallback() - async_retry - retrying in 300ms...');setTimeout(function(){customJsOnDocumentReadyCallback();},300);}else if(typeof customJsResult==='string'&&customJsResult.indexOf('async_callback')===0){logger('DIGIOH: customJsOnDocumentReadyCallback() - async_callback - waiting for callback...');return;}else{logger('DIGIOH: customJsOnDocumentReadyCallback()');customJsOnDocumentReadyComplete(customJsResult);}}
catch(e){logError(e,"customJsOnDocumentReadyCallback");}}
function customJsOnDocumentReadyComplete(customJsResult){try{logger("STOPWATCH (customJsOnDocumentReadyComplete) - "+Math.ceil((new Date().getTime()-STOPWATCH)/1000));if(typeof customJsResult!=='boolean'||customJsResult===true){initConditions();}else{logger('DIGIOH_CUSTOM_JS.runCustomJsOnDocumentReady() returned false, execution of JS has been stopped.  Checking for embedded inline forms...');setEligibleInlineLightboxesAfterDocReadyFalseCustomJS();if(DIGIOH_LIGHTBOX_INLINE_ALWAYS_ARR.length>0||DIGIOH_LIGHTBOX_INLINE_CONDITIONS_ARR.length>0){initABSplitTests();initVariations();initLightboxActivity();buildConditionSelectorsToBoxesMap();embedInlineLightboxAlwaysForms();embedInlineLightboxConditionsForms();}}
DIGIOH_IS_READY=true;JQUERY_DIGIOH(document).trigger('DIGIOH_CONDITIONS_FINISHED',{});}
catch(e){logError(e,"customJsOnDocumentReadyComplete");}}
function setEligibleInlineLightboxesAfterDocReadyFalseCustomJS(){try{var NEW_ALWAYS_ARR=[];for(var i=0;i<DIGIOH_LIGHTBOX_INLINE_ALWAYS_ARR.length;i++){cjs=EFFECTS[DIGIOH_LIGHTBOX_INLINE_ALWAYS_ARR[i]].inline.custom_js_rules;if(cjs!=='all'&&cjs.indexOf('ready')===-1){NEW_ALWAYS_ARR.push(DIGIOH_LIGHTBOX_INLINE_ALWAYS_ARR[i]);}}
DIGIOH_LIGHTBOX_INLINE_ALWAYS_ARR=NEW_ALWAYS_ARR;var NEW_CONDITIONS_ARR=[];var cjs='';for(var i=0;i<DIGIOH_LIGHTBOX_INLINE_CONDITIONS_ARR.length;i++){cjs=EFFECTS[DIGIOH_LIGHTBOX_INLINE_CONDITIONS_ARR[i]].inline.custom_js_rules;if(cjs!=='all'&&cjs.indexOf('ready')===-1){NEW_CONDITIONS_ARR.push(DIGIOH_LIGHTBOX_INLINE_CONDITIONS_ARR[i]);}}
DIGIOH_LIGHTBOX_INLINE_CONDITIONS_ARR=NEW_CONDITIONS_ARR;}
catch(e){logError(e,"setEligibleInlineLightboxesAfterDocReadyFalseCustomJS");}}
function doesInlineLightboxHaveCustomJsType(lid,cjsType){try{var idxArrAlways=JQUERY_DIGIOH.inArray(lid,DIGIOH_LIGHTBOX_INLINE_ALWAYS_ARR);var idxArrConditions=JQUERY_DIGIOH.inArray(lid,DIGIOH_LIGHTBOX_INLINE_CONDITIONS_ARR);var cjsVal='';if(idxArrAlways>=0){cjsVal=EFFECTS[DIGIOH_LIGHTBOX_INLINE_ALWAYS_ARR[idxArrAlways]].inline.custom_js_rules;}else if(idxArrConditions>=0){cjsVal=EFFECTS[DIGIOH_LIGHTBOX_INLINE_CONDITIONS_ARR[idxArrConditions]].inline.custom_js_rules;}
var foundType=(cjsVal.indexOf(cjsType)>=0);return foundType;}
catch(e){logError(e,"doesInlineLightboxHaveCustomJsType");}}
function cleanTextForLogging(txt){try{if(typeof txt==='string'){return txt.trim().split(' ').join('_').toUpperCase().replace(/[^a-zA-Z0-9]/g,'');}else if(typeof txt==='number'){return(txt+'').trim();}else{return 'NA';}}catch(e){logError(e,"cleanTextForLogging");return txt;}}
function padStr(i){try{return(i<10)?("0"+i):(""+i);}
catch(e){logError(e,"padStr");}}
function getAnalyticsEndpointAzure(test){try{if(typeof test!=='undefined'&&test){return 'lightboxapitest.azurewebsites.net';}
return 'lightboxapi.azurewebsites.net';}
catch(e){return 'lightboxapi.azurewebsites.net';}}
function analyticsGeoDeviceCDP(){try{if(IS_PREVIEW){initDependentScripts();}else{var vendorShortId=VENDOR_GUID||'empty';if(typeof DIGIOH_VENDOR_SHORT_ID!=='undefined'){vendorShortId=DIGIOH_VENDOR_SHORT_ID;}
var hostname='empty';if(window&&window.location&&window.location.hostname){hostname=window.location.hostname;}
var test=false;if(typeof CDP_VARS==='object'&&CDP_VARS&&CDP_VARS.hasOwnProperty('enabled')&&CDP_VARS.enabled===1&&JSON.stringify(DIGIOH_LIGHTBOX_CONDITIONS).indexOf('E_segments')>=0)
{if(!DIGIOH_API.CDP){DIGIOH_API.CDP={};}
DIGIOH_API.CDP.segments=[];getDIUID(vendorShortId,hostname,test,0);}
else{var url_geo_device=PROTOCOL_USER_OVERRIDE+getAnalyticsEndpointAzure(test)+'/z9gd/'+vendorShortId+'/'+hostname+'/jsonp/z?cb='+(new Date().getTime());callGeoDeviceCDP(url_geo_device,'',{});tryInitGADigioh(false);}
if(DIGIOH_API.hasOwnProperty('analyticsRecipientSegments')){DIGIOH_API.analyticsRecipientSegments();}}}
catch(e){logError(e,"analyticsGeoDeviceCDP");initDependentScripts();}}
var tryInitGADigioh=function(send_pv,esp_id){try{if(typeof send_pv==='undefined'){send_pv=false;}
if(window.ga&&window.ga.create){DIGIOH_API.GoogleAnalytics.is_ga_universal=true;if(typeof CDP_VARS==='object'&&CDP_VARS&&CDP_VARS.hasOwnProperty('enabled')&&CDP_VARS.enabled===1&&CDP_VARS.ua_tracking_id){DIGIOH_API.GoogleAnalytics.trackerArr=window.ga.getAll();if(DIGIOH_API.GoogleAnalytics.trackerArr&&DIGIOH_API.GoogleAnalytics.trackerArr.length){for(var i=0;i<DIGIOH_API.GoogleAnalytics.trackerArr.length;i++){if(DIGIOH_API.GoogleAnalytics.trackerArr[i].get('trackingId')===CDP_VARS.ua_tracking_id){DIGIOH_API.GoogleAnalytics.tracker=DIGIOH_API.GoogleAnalytics.trackerArr[i];DIGIOH_CUSTOM_JS.log('DIGIOH: Using GA Account: '+DIGIOH_API.GoogleAnalytics.tracker.get('trackingId'));break;}}}}
else if(window.ga.getAll().length){DIGIOH_API.GoogleAnalytics.tracker=window.ga.getAll()[0];DIGIOH_CUSTOM_JS.log('DIGIOH: Using GA Account: '+DIGIOH_API.GoogleAnalytics.tracker.get('trackingId'));}
logger('DIGIOH: Using Google Universal Analytics');if(send_pv&&typeof CDP_VARS==='object'&&CDP_VARS&&CDP_VARS.hasOwnProperty('dimension')&&CDP_VARS.dimension){var extra={'nonInteraction':1};extra['dimension'+CDP_VARS.dimension]=DIGIOH_API.LIGHTBOX.DIGIOH_COOKIE.getEncoded("_diuid_")||top.localStorage.getItem("_diuid_");if(esp_id){extra['dimension'+CDP_VARS.dimension]+='||||'+esp_id;}
sendGAEvent('DIGIOH','Link User','Log DIUID to GA',1,extra);}}
else if(window._gaq&&typeof window._gaq._getAsyncTracker==='function'){DIGIOH_API.GoogleAnalytics.is_ga_classic=true;DIGIOH_API.GoogleAnalytics.tracker=window._gaq._getAsyncTracker();logger('DIGIOH: Using Google Classic Analytics');if(send_pv&&typeof CDP_VARS==='object'&&CDP_VARS&&CDP_VARS.hasOwnProperty('dimension')&&CDP_VARS.dimension){var extra={'nonInteraction':1};extra['dimension'+CDP_VARS.dimension]=DIGIOH_API.LIGHTBOX.DIGIOH_COOKIE.getEncoded("_diuid_")||top.localStorage.getItem("_diuid_");if(esp_id){extra['dimension'+CDP_VARS.dimension]+='||||'+esp_id;}
sendGAEvent('DIGIOH','Link User','Log DIUID to GA',1,extra);}}
else if(DIGIOH_API.GoogleAnalytics.num_checks<25){DIGIOH_API.GoogleAnalytics.num_checks++;setTimeout,500);}else{logger('DIGIOH: Unable to find Google Analytics (Classic or Universal)');}
logger('DIGIOH: tryInitGADigioh (internal)');}
catch(e){logError(e,"tryInitGADigioh");}};var sendGAEvent=function(cat,act,lab,val,extra,ua_tracking_id){try
{var tempTracker='';if(typeof ua_tracking_id==='string'&&ua_tracking_id.length>4&&ua_tracking_id.indexOf('UA-')===0&&DIGIOH_API.GoogleAnalytics.is_ga_universal){if(!DIGIOH_API.GoogleAnalytics.tracker||DIGIOH_API.GoogleAnalytics.tracker.get('trackingId')!==ua_tracking_id){DIGIOH_API.GoogleAnalytics.trackerArr=window.ga.getAll();if(DIGIOH_API.GoogleAnalytics.trackerArr&&DIGIOH_API.GoogleAnalytics.trackerArr.length){for(var i=0;i<DIGIOH_API.GoogleAnalytics.trackerArr.length;i++){if(DIGIOH_API.GoogleAnalytics.trackerArr[i].get('trackingId')===ua_tracking_id){tempTracker=DIGIOH_API.GoogleAnalytics.trackerArr[i];if(!DIGIOH_API.GoogleAnalytics.tracker)
DIGIOH_API.GoogleAnalytics.tracker=DIGIOH_API.GoogleAnalytics.trackerArr[i];logger('DIGIOH: Using GA Account: '+tempTracker.get('trackingId'));break;}}}}}
if(!tempTracker&&DIGIOH_API.GoogleAnalytics.tracker)
tempTracker=DIGIOH_API.GoogleAnalytics.tracker;if(tempTracker){if(typeof extra==='object'&&extra!==null&&extra!=={}){if(typeof val!=='number'){val=1;}
tempTracker.send('event',cat,act,lab,val,extra);logger('DIGIOH: Sent GA Event: '+cat+', '+act+', '+lab+', '+val+', '+JSON.stringify(extra));}else if(typeof val!=='undefined'&&val!==null&&val!==''){tempTracker.send('event',cat,act,lab,val);logger('DIGIOH: Sent GA Event: '+cat+', '+act+', '+lab+', '+val);}else{tempTracker.send('event',cat,act,lab);logger('DIGIOH: Sent GA Event: '+cat+', '+act+', '+lab);}}
else{setTimeout,1000);logger('DIGIOH: Did NOT send GA Event, tracker not found!  Trying again in 1 second.');}}
catch(e){logError(e,"sendGAEvent");}};function generateDIUID(){try{var cn='_diuid_';var diuid=top.localStorage.getItem(cn);if(!diuid){var cv="; "+top.document.cookie;var parts=cv.split("; "+cn+"=");if(parts.length==2){diuid=parts.pop().split(";").shift();if(diuid){top.localStorage.setItem(cn,diuid);}}}
if(!diuid){diuid='xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g);diuid=diuid.split('-').join('')+new Date().getTime();top.localStorage.setItem(cn,diuid);var d=new Date();d.setTime(d.getTime()+(3650*24*60*60*1000));var expires="expires="+d.toUTCString();top.document.cookie=cn+"="+diuid+";"+expires+";path=/";}
DIGIOH_API.GoogleAnalytics.is_new_diuid=true;logger('CODE_DIUID: '+diuid);return diuid;}
catch(e){logError(e,"generateDIUID");}}
function getDIUID(vendorShortId,hostname,test,cnt){try{var diuid=DIGIOH_API.LIGHTBOX.DIGIOH_COOKIE.getEncoded("_diuid_")||top.localStorage.getItem("_diuid_");logger('getDIUID: '+diuid);var isCDPEmbedTypeBlankOrCode=(typeof CDP_VARS!=='object'||!CDP_VARS||!CDP_VARS.hasOwnProperty('embed_type')||!CDP_VARS.embed_type||CDP_VARS.embed_type==='code');if(!diuid&&cnt<20){if(isCDPEmbedTypeBlankOrCode){generateDIUID();getDIUID(vendorShortId,hostname,test,cnt+1);}else{setTimeout(function(){getDIUID(vendorShortId,hostname,test,cnt+1);},300);}}
else if(!diuid&&cnt>=20){generateDIUID();getDIUID(vendorShortId,hostname,test,cnt+1);}
else if(diuid){var send_pv=DIGIOH_API.GoogleAnalytics.is_new_diuid&&isCDPEmbedTypeBlankOrCode;var call_geo_device=true;if(typeof diuid==='string'&&diuid.length>30){logger('Found_DIUID: '+diuid);var cookieName="__cdp";var cookieVal=DIGIOH_STORAGE.data[cookieName];var cobj={};if(typeof cookieVal==='object'&&cookieVal!==null){cobj=cookieVal;}
else if(typeof cookieVal==='string'&&cookieVal.length>1&&cookieVal.indexOf('{')===0&&cookieVal.substring(cookieVal.length-1)==='}'){cobj=JSON.parse(cookieVal);}
logger(cobj);var customJsCdpEspIdResult='_empty_';if(!IS_PREVIEW||IS_DEV){customJsCdpEspIdResult=DIGIOH_CUSTOM_JS.runCustomJsCdpEspId(window.DIGIOH_API,window,document,JQUERY_DIGIOH,getCustomJsMetadata(''));logger('DIGIOH: DIGIOH_CUSTOM_JS.runCustomJsCdpEspId(): '+customJsCdpEspIdResult);}
var esp_param_val='';if(customJsCdpEspIdResult!==null&&customJsCdpEspIdResult!==undefined&&customJsCdpEspIdResult!==''&&customJsCdpEspIdResult!=='_empty_'){esp_param_val=customJsCdpEspIdResult.toString();}
else if(typeof CDP_VARS==='object'&&CDP_VARS&&CDP_VARS.hasOwnProperty('esp_params')&&CDP_VARS.esp_params&&CDP_VARS.esp_params.indexOf(',')>0){var items=CDP_VARS.esp_params.split(',');for(var i=0;i<items.length;i++){esp_param_val=getUrlParam(items[i].split(' ').join(''));if(esp_param_val){break;}}}
else if(typeof CDP_VARS==='object'&&CDP_VARS&&CDP_VARS.hasOwnProperty('esp_params')&&CDP_VARS.esp_params){esp_param_val=getUrlParam(CDP_VARS.esp_params);}
if(esp_param_val===null||esp_param_val===undefined)
esp_param_val='';if(typeof esp_param_val!=='string')
esp_param_val=esp_param_val.toString();if(typeof CDP_VARS==='object'&&CDP_VARS)
CDP_VARS.esp_param_val=esp_param_val;var update_esp_id=false;if(esp_param_val.length>0)
update_esp_id=true;var timestamp=new Date().getTime();if(cobj.hasOwnProperty("ts")&&cobj["ts"]&&timestamp-cobj["ts"]<=3600000){if(cobj.hasOwnProperty("segs")&&cobj["segs"]){DIGIOH_API.CDP.segments=cobj["segs"];DIGIOH_API.GET_ANALYTICS().VARS.segments=cobj["segs"];}
if(cobj.hasOwnProperty("esp_id")&&cobj["esp_id"]==esp_param_val){update_esp_id=false;}}
else if(!cobj.hasOwnProperty("ts")||(cobj["ts"]&&timestamp-cobj["ts"]>3600000)){var url_geo_device_cdp=PROTOCOL_USER_OVERRIDE+getAnalyticsEndpointAzure(test)+'/z9gdc/'+diuid+'/'+vendorShortId+'/'+hostname+'/jsonp/z?cb='+(new Date().getTime())+(esp_param_val?'&espid='+esp_param_val:'');callGeoDeviceCDP(url_geo_device_cdp,esp_param_val,cobj);call_geo_device=false;update_esp_id=false;}
if(update_esp_id){var url_update_cdp=PROTOCOL_USER_OVERRIDE+getAnalyticsEndpointAzure(test)+'/z9uc/'+diuid+'/'+vendorShortId+'/'+hostname+'/jsonp/z?cb='+(new Date().getTime())+'&espid='+esp_param_val;callUpdateCDP(url_update_cdp,esp_param_val,cobj);}
if(esp_param_val.length>0){tryInitGADigioh(true,esp_param_val);}else{tryInitGADigioh(send_pv);}}
else{tryInitGADigioh(send_pv);}
if(call_geo_device){var url_geo_device=PROTOCOL_USER_OVERRIDE+getAnalyticsEndpointAzure(test)+'/z9gd/'+vendorShortId+'/'+hostname+'/jsonp/z?cb='+(new Date().getTime());callGeoDeviceCDP(url_geo_device,'',{});}}
else{var url_geo_device_2=PROTOCOL_USER_OVERRIDE+getAnalyticsEndpointAzure(test)+'/z9gd/'+vendorShortId+'/'+hostname+'/jsonp/z?cb='+(new Date().getTime());callGeoDeviceCDP(url_geo_device_2,'',{});tryInitGADigioh(false);}}
catch(e){logError(e,"getDIUID");}}
function callGeoDeviceCDP(url,esp_param_val,cobj){try{setTimeout(function(){analyticsRunAfterIdentify(true);},7000);JQUERY_DIGIOH.ajax({dataType:'jsonp',url:url,success:function(json){if(json&&typeof json==='object'&&json!==null&&json.hasOwnProperty('success')&&json.success){logger('callGeoDeviceCDP ==> success');logger(json);}else{logger('callGeoDeviceCDP ==> failure');logger(json);}
if(json.hasOwnProperty("geo")&&typeof json.geo==='object'&&json.geo.hasOwnProperty("ip")&&json.geo.ip){if(JQUERY_DIGIOH.inArray(json.geo.ip,BLIP_ARR)>-1){json.geo.blip_matched=1;BLIP_MATCHED=1;}else{json.geo.blip_matched=0;BLIP_MATCHED=0;}}
if(json.hasOwnProperty("rand")&&typeof json['rand']=='number'){DIGIOH_API.RANDOM_GLOBAL=json['rand'];DIGIOH_API.RANDOM_GLOBAL_SOURCE='api';}
else{DIGIOH_API.RANDOM_GLOBAL=getRandomInt(1,1000001);DIGIOH_API.RANDOM_GLOBAL_SOURCE='js';}
logger('DIGIOH_API.RANDOM_GLOBAL: '+DIGIOH_API.RANDOM_GLOBAL);logger('DIGIOH_API.RANDOM_GLOBAL_SOURCE: '+DIGIOH_API.RANDOM_GLOBAL_SOURCE);if(json.hasOwnProperty("ts")&&typeof json['ts']=='number'){DIGIOH_API.TIME_GLOBAL=json['ts'];DIGIOH_API.TIME_GLOBAL_SOURCE='api';}
else{DIGIOH_API.TIME_GLOBAL=Date.now();DIGIOH_API.TIME_GLOBAL_SOURCE='js';}
logger('DIGIOH_API.TIME_GLOBAL: '+DIGIOH_API.TIME_GLOBAL+' (vs JS timestamp = '+Date.now()+')');logger('DIGIOH_API.TIME_GLOBAL_SOURCE: '+DIGIOH_API.TIME_GLOBAL_SOURCE);if(json.hasOwnProperty("geo")&&typeof json.geo==='object'){DIGIOH_LIGHTBOX_ANALYTICS.setGeoData(json);setKeenSchemaAfterGeo();DIGIOH_IS_ANALYTICS_IDENTIFY_DONE['geo']=true;}
if(json.hasOwnProperty("da")&&typeof json.da==='string'){DIGIOH_LIGHTBOX_ANALYTICS.setDeviceData(json);setKeenSchemaAfterDevice();DIGIOH_IS_ANALYTICS_IDENTIFY_DONE['device']=true;}
if(json.hasOwnProperty("cdp")){if(typeof json["cdp"]==='string'&&json["cdp"]){if(json["cdp"].indexOf('|')>0){DIGIOH_API.CDP.segments=json["cdp"].split('|');DIGIOH_API.GET_ANALYTICS().VARS.segments=json["cdp"].split('|');}else{DIGIOH_API.CDP.segments.push(json["cdp"]);DIGIOH_API.GET_ANALYTICS().VARS.segments.push(json["cdp"]);}}
cobj["segs"]=DIGIOH_API.CDP.segments;cobj["ts"]=new Date().getTime();if(esp_param_val)
cobj["esp_id"]=esp_param_val;DIGIOH_STORAGE.data["__cdp"]=cobj;DIGIOH_STORAGE.set();DIGIOH_IS_ANALYTICS_IDENTIFY_DONE['cdp']=true;}
analyticsRunAfterIdentify(false);},error});}
catch(e){logError(e,"callGeoDeviceCDP");DIGIOH_IS_ANALYTICS_IDENTIFY_DONE['geo']=true;DIGIOH_IS_ANALYTICS_IDENTIFY_DONE['device']=true;DIGIOH_IS_ANALYTICS_IDENTIFY_DONE['cdp']=true;analyticsRunAfterIdentify(false);}}
function callUpdateCDP(url,esp_param_val,cobj){try{JQUERY_DIGIOH.ajax({dataType:'jsonp',url:url,success,error});}
catch(e){logError(e,"callUpdateCDP");}}
var analyticsRunAfterIdentify=function(force){try{var is_done=true;for(var prop in DIGIOH_IS_ANALYTICS_IDENTIFY_DONE){if(DIGIOH_IS_ANALYTICS_IDENTIFY_DONE.hasOwnProperty(prop)&&!DIGIOH_IS_ANALYTICS_IDENTIFY_DONE[prop]){is_done=false;}}
if(is_done){initDependentScripts();}
else if(force){initDependentScripts();}}
catch(e){logError(e,"analyticsRunAfterIdentify");initDependentScripts();}};function analyticsEvent(eventType,boxGUID,variationGUID,splitGUID){try{var vendorShortId=VENDOR_GUID||'empty';var boxShortId=boxGUID||'empty';var variationShortId=variationGUID||'empty';var splitShortId=splitGUID||'empty';if(typeof DIGIOH_VENDOR_SHORT_ID!=='undefined'){vendorShortId=DIGIOH_VENDOR_SHORT_ID;}
if(eventType!=='pageview'&&boxGUID&&DIGIOH_LIGHTBOX_IDS.hasOwnProperty(boxGUID)&&DIGIOH_LIGHTBOX_IDS[boxGUID]){boxShortId=DIGIOH_LIGHTBOX_IDS[boxGUID];}
if(eventType!=='pageview'&&variationGUID&&DIGIOH_LIGHTBOX_IDS.hasOwnProperty(variationGUID)&&DIGIOH_LIGHTBOX_IDS[variationGUID]){variationShortId=DIGIOH_LIGHTBOX_IDS[variationGUID];}
if(eventType!=='pageview'&&typeof DIGIOH_SPLIT_TESTS_ARR!=='undefined'&&DIGIOH_SPLIT_TESTS_ARR.length){for(var i=0;i<DIGIOH_SPLIT_TESTS_ARR.length;i++){if(DIGIOH_SPLIT_TESTS_ARR[i].hasOwnProperty('split_short_id')&&DIGIOH_SPLIT_TESTS_ARR[i].hasOwnProperty('split_guid')&&DIGIOH_SPLIT_TESTS_ARR[i]['split_guid']==splitGUID){splitShortId=DIGIOH_SPLIT_TESTS_ARR[i]['split_short_id'];break;}}}
var hostname='empty';if(window&&window.location&&window.location.hostname){hostname=window.location.hostname;}
var ids={};ids.uid=vendorShortId;ids.uguid=VENDOR_GUID;ids.bid=boxShortId;ids.bguid=boxGUID;ids.vid=variationShortId;ids.vguid=variationGUID;ids.sid=splitShortId;ids.sguid=splitGUID;var pathRewrite='/';var et='';if(eventType=='pageview'){pathRewrite='/z9v/'+vendorShortId+'/'+hostname;et='p';}
if(eventType=='display'){pathRewrite='/z9d/'+vendorShortId+'/'+boxShortId+'/'+variationShortId+'/'+splitShortId+'/'+hostname;et='i';}
if(eventType=='submit'){pathRewrite='/z9s/'+vendorShortId+'/'+boxShortId+'/'+variationShortId+'/'+splitShortId+'/'+hostname;et='s';}
if(eventType=='redirect'){pathRewrite='/z9r/'+vendorShortId+'/'+boxShortId+'/'+variationShortId+'/'+splitShortId+'/'+hostname;et='r';}
if(eventType=='download'){pathRewrite='/z9w/'+vendorShortId+'/'+boxShortId+'/'+variationShortId+'/'+splitShortId+'/'+hostname;et='d';}
if(pathRewrite==='/')
return;if(eventType!=='submit'){var i=document.createElement("img");i.width=1;i.height=1;i.src=(PROTOCOL_USER_OVERRIDE+'www.lightboxcdn.com/z9g/t.gif?c='+(new Date().getTime())+'&h='+encodeURIComponent(hostname)+'&e='+et+'&u='+vendorShortId+'&b='+boxShortId+'&v='+variationShortId+'&s='+splitShortId);}}
catch(e){logError(e,"analyticsEvent");}}
function analyticsDisplay(boxGUID,variationGUID,splitGUID){analyticsEvent('display',boxGUID,variationGUID,splitGUID);}
function analyticsSubmit(boxGUID,variationGUID,splitGUID){analyticsEvent('submit',boxGUID,variationGUID,splitGUID);}
function analyticsRedirect(boxGUID,variationGUID,splitGUID){analyticsEvent('redirect',boxGUID,variationGUID,splitGUID);}
function analyticsLightboxDisplay(lbid){try{var var_id='';var orig_lid=lbid;if(DIGIOH_VARIATION_TO_BOX_MAP.hasOwnProperty(lbid)){orig_lid=DIGIOH_VARIATION_TO_BOX_MAP[lbid];var_id=lbid;}else if(LIGHTBOX_TO_VARIATION_MAP.hasOwnProperty(lbid)){var_id=LIGHTBOX_TO_VARIATION_MAP[lbid];}
var splitId='empty';if(var_id.length>7&&AB_BOXES_TAKE_MAP.hasOwnProperty(var_id)){splitId=AB_BOXES_TAKE_MAP[var_id];}else if(AB_BOXES_TAKE_MAP.hasOwnProperty(orig_lid)){splitId=AB_BOXES_TAKE_MAP[orig_lid];}
if(var_id===''){var_id='empty';}
if(!WAS_IMPRESSION_REGISTERED.hasOwnProperty(orig_lid)){WAS_IMPRESSION_REGISTERED[orig_lid]=0;}
WAS_IMPRESSION_REGISTERED[orig_lid]++;if(WAS_IMPRESSION_REGISTERED[orig_lid]>10){logErrorText("MAX_DISPLAY_COUNT_REACHED","MAX_DISPLAY_COUNT_REACHED");return;}
if(!IS_PREVIEW){if(BLIP_MATCHED===1){logErrorText("BLIP_MATCHED_INVALID_DISPLAY","BLIP_MATCHED_INVALID_DISPLAY");return;}}
analyticsDisplay(orig_lid,var_id,splitId);}
catch(e){logError(e,"analyticsLightboxDisplay");}}
function initKeen(){try{KEEN_CLIENT=new Keen({projectId:"53ab77e2c9e1637d8a000000",writeKey:DIGIOH_KEEN_WRITE_KEY});}
catch(e){logError(e,"initKeen");}}
function initKeen2(){try{KEEN_CLIENT_2=new Keen({projectId:'58ac97f58db53dfda8a88662',writeKey:'2423E50F591F96B78CC8CC2434EE076D85F6A17251188536CE621FEDC71E7F8F030C191915774ACAEE91B3927D45F29CA621652AE08BD36B70BBAE5C5AF43FD7F2ED6C3CDB88D5CE84B973DD7CC4335661CDEE112E618628032BB2F855CE6576'});}
catch(e){logError(e,"initKeen2");}}
function initKeenSchema(){try{KEEN_SCHEMA={cache_version:DIGIOH_CACHE_VERSION,is_preview:IS_PREVIEW,ip_address:"${keen.ip}",user_agent:"${keen.user_agent}",vendor_id:VENDOR_GUID,client_id:CLIENT_GUID,referrer_url:document.referrer,page_url:document.location.href,geoip:{ip_address:DIGIOH_LIGHTBOX_ANALYTICS.VARS.ip_address,continent_code:DIGIOH_LIGHTBOX_ANALYTICS.VARS.continent,country_code:DIGIOH_LIGHTBOX_ANALYTICS.VARS.country,country_name:DIGIOH_LIGHTBOX_ANALYTICS.VARS.country_name,region_code:DIGIOH_LIGHTBOX_ANALYTICS.VARS.state,region_name:DIGIOH_LIGHTBOX_ANALYTICS.VARS.region_name,city:DIGIOH_LIGHTBOX_ANALYTICS.VARS.city,zipcode:DIGIOH_LIGHTBOX_ANALYTICS.VARS.zipcode,metro_code:DIGIOH_LIGHTBOX_ANALYTICS.VARS.metro_code,time_zone:DIGIOH_LIGHTBOX_ANALYTICS.VARS.time_zone,area_code:DIGIOH_LIGHTBOX_ANALYTICS.VARS.area_code,latitude:DIGIOH_LIGHTBOX_ANALYTICS.VARS.latitude,longitude:DIGIOH_LIGHTBOX_ANALYTICS.VARS.longitude,geo_source:DIGIOH_LIGHTBOX_ANALYTICS.VARS.geo_source,blip_matched:BLIP_MATCHED},device:{hardware:DIGIOH_LIGHTBOX_ANALYTICS.VARS.device,os:DIGIOH_LIGHTBOX_ANALYTICS.VARS.operating_system,browser_type:DIGIOH_LIGHTBOX_ANALYTICS.VARS.browser_type,browser_version:DIGIOH_LIGHTBOX_ANALYTICS.VARS.browser_version},entry_point:{referrer_url:DIGIOH_LIGHTBOX_ANALYTICS.VARS.referring_website_url,landing_page_url:DIGIOH_LIGHTBOX_ANALYTICS.VARS.landing_page,landing_page_ip:DIGIOH_LIGHTBOX_ANALYTICS.VARS.landing_page_ip,landing_page_date:DIGIOH_LIGHTBOX_ANALYTICS.VARS.date_of_visit,web_source:DIGIOH_LIGHTBOX_ANALYTICS.VARS.web_source,past_visits:DIGIOH_LIGHTBOX_ANALYTICS.VARS.past_visits,page_visits:DIGIOH_LIGHTBOX_ANALYTICS.VARS.page_visits,search_engine:DIGIOH_LIGHTBOX_ANALYTICS.VARS.search_engine,utm_campaign_source:DIGIOH_LIGHTBOX_ANALYTICS.VARS.utm_campaign_source,utm_campaign_medium:DIGIOH_LIGHTBOX_ANALYTICS.VARS.utm_campaign_medium,utm_campaign_term:DIGIOH_LIGHTBOX_ANALYTICS.VARS.utm_campaign_term,utm_campaign_content:DIGIOH_LIGHTBOX_ANALYTICS.VARS.utm_campaign_content,utm_campaign_name:DIGIOH_LIGHTBOX_ANALYTICS.VARS.utm_campaign_name}};KEEN_SCHEMA.keen={};KEEN_SCHEMA.keen.addons=[{name:"keen:ip_to_geo",input:{ip:"ip_address"},output:"ip_to_geo_addon"},{name:"keen:ua_parser",input:{ua_string:"user_agent"},output:"ua_parser_addon"},{name:"keen:url_parser",input:{url:"page_url"},output:"url_parser_addon"},{name:"keen:referrer_parser",input:{referrer_url:"referrer_url",page_url:"page_url"},output:"referrer_parser_addon"}];if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.latitude&&DIGIOH_LIGHTBOX_ANALYTICS.VARS.longitude){KEEN_SCHEMA.keen.location={};KEEN_SCHEMA.keen.location.coordinates=[DIGIOH_LIGHTBOX_ANALYTICS.VARS.latitude,DIGIOH_LIGHTBOX_ANALYTICS.VARS.longitude];}}
catch(e){logError(e,"initKeenSchema");}}
function cfPageview(){try{if(typeof window.SENT_LIGHTBOX_PV!=='undefined'&&window.SENT_LIGHTBOX_PV===true){return;}}
catch(err){}
try{var vendorShortId=VENDOR_GUID||'empty';if(typeof DIGIOH_VENDOR_SHORT_ID!=='undefined'){vendorShortId=DIGIOH_VENDOR_SHORT_ID;}
var hostname='empty';if(window&&window.location&&window.location.hostname){hostname=window.location.hostname;}
var i=document.createElement("img");i.width=1;i.height=1;i.src=(PROTOCOL_USER_OVERRIDE+'www.lightboxcdn.com/z9g/t.gif?c='+(new Date().getTime())+'&h='+encodeURIComponent(hostname)+'&e=p'+'&u='+vendorShortId);window.SENT_LIGHTBOX_PV=true;try{if(typeof window.RECAPTURE_LIGHTBOX_PV!=='undefined'&&window.RECAPTURE_LIGHTBOX_PV===true){window.RECAPTURE_LIGHTBOX_PV=false;window.SENT_LIGHTBOX_PV=false;setTimeout(cfPageview,1000);}}
catch(err){}}
catch(e){logErrorText("cfPageview_EXCEPTION","cfPageview_EXCEPTION");}}
function keenLightboxDisplay(boxGUID,variationGUID,splitGUID){try{}
catch(e){logErrorText("keenLightboxDisplayJSONP_EXCEPTION","keenLightboxDisplayJSONP_EXCEPTION");}}
function keenLightboxCoupon(lid,coupon_meta_data){try{}
catch(e){logErrorText("keenLightboxCoupon_EXCEPTION","keenLightboxCoupon_EXCEPTION");}}
function keenLightboxSubmit(form_data,lid,sid){try{var var_id='';var orig_lid=lid;if(DIGIOH_VARIATION_TO_BOX_MAP.hasOwnProperty(lid)){orig_lid=DIGIOH_VARIATION_TO_BOX_MAP[lid];var_id=lid;}else if(LIGHTBOX_TO_VARIATION_MAP.hasOwnProperty(lid)){var_id=LIGHTBOX_TO_VARIATION_MAP[lid];}
var ab_test_id='';if(var_id!=''&&AB_BOXES_TAKE_MAP.hasOwnProperty(var_id)){ab_test_id=AB_BOXES_TAKE_MAP[var_id];}else if(AB_BOXES_TAKE_MAP.hasOwnProperty(orig_lid)){ab_test_id=AB_BOXES_TAKE_MAP[orig_lid];}
if(!WAS_SUBMIT_REGISTERED.hasOwnProperty(orig_lid)){WAS_SUBMIT_REGISTERED[orig_lid]=0;}
WAS_SUBMIT_REGISTERED[orig_lid]++;if(!IS_PREVIEW){if(BLIP_MATCHED===1){logErrorText("BLIP_MATCHED_INVALID_SUBMIT","BLIP_MATCHED_INVALID_SUBMIT");return;}}
var vendorShortId=VENDOR_GUID||'empty';var boxShortId=orig_lid||'empty';var variationShortId=var_id||'empty';var splitShortId=ab_test_id||'empty';if(typeof DIGIOH_VENDOR_SHORT_ID!=='undefined'){vendorShortId=DIGIOH_VENDOR_SHORT_ID;}
if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(orig_lid)&&DIGIOH_LIGHTBOX_IDS[orig_lid]){boxShortId=DIGIOH_LIGHTBOX_IDS[orig_lid];}
if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(var_id)&&DIGIOH_LIGHTBOX_IDS[var_id]){variationShortId=DIGIOH_LIGHTBOX_IDS[var_id];}
if(typeof DIGIOH_SPLIT_TESTS_ARR!=='undefined'&&DIGIOH_SPLIT_TESTS_ARR.length){for(var i=0;i<DIGIOH_SPLIT_TESTS_ARR.length;i++){if(DIGIOH_SPLIT_TESTS_ARR[i].hasOwnProperty('split_short_id')&&DIGIOH_SPLIT_TESTS_ARR[i].hasOwnProperty('split_guid')&&DIGIOH_SPLIT_TESTS_ARR[i]['split_guid']==ab_test_id){splitShortId=DIGIOH_SPLIT_TESTS_ARR[i]['split_short_id'];break;}}}
var integration_map={};if(window.DIGIOH_API.LIGHTBOX.hasOwnProperty('INTEGRATION_MAP')&&window.DIGIOH_API.LIGHTBOX.INTEGRATION_MAP!==null&&typeof window.DIGIOH_API.LIGHTBOX.INTEGRATION_MAP==='object'){integration_map=window.DIGIOH_API.LIGHTBOX.INTEGRATION_MAP;}
updateKeenSchemaBeforeSending();var lightbox_submit=KEEN_SCHEMA;lightbox_submit.cache_version=DIGIOH_CACHE_VERSION;lightbox_submit.is_preview=IS_PREVIEW;lightbox_submit.ip_address="${keen.ip}";lightbox_submit.user_agent="${keen.user_agent}";lightbox_submit.vendor_id=VENDOR_GUID;lightbox_submit.client_id=CLIENT_GUID;lightbox_submit.event_id=generateGuidWithTimestamp();lightbox_submit.submission_id=sid;lightbox_submit.lightbox_id=orig_lid;lightbox_submit.variation_id=var_id;lightbox_submit.ab_test_id=ab_test_id;lightbox_submit.uid=vendorShortId;lightbox_submit.bid=boxShortId;lightbox_submit.vid=variationShortId;lightbox_submit.sid=splitShortId;lightbox_submit.lightbox_open_time=TOTAL_TIME-LIGHTBOX_OPEN_TIME;lightbox_submit.page_total_time=TOTAL_TIME;lightbox_submit.page_active_time=TOTAL_TIME-IDLE_TIME;lightbox_submit.page_idle_time=IDLE_TIME;lightbox_submit.impressions_on_page=(WAS_IMPRESSION_REGISTERED.hasOwnProperty(orig_lid)?WAS_IMPRESSION_REGISTERED[orig_lid]:0);lightbox_submit.submits_on_page=WAS_SUBMIT_REGISTERED[orig_lid];lightbox_submit.integration_map=integration_map;if(var_id&&EFFECTS.hasOwnProperty(var_id)){lightbox_submit.widget_type=EFFECTS[var_id].widget_type;}else{lightbox_submit.widget_type=EFFECTS[orig_lid].widget_type;}
if(DIGIOH_LIGHTBOX_NAMES.hasOwnProperty(orig_lid)){lightbox_submit.lightbox_name=DIGIOH_LIGHTBOX_NAMES[orig_lid];}
if(DIGIOH_LIGHTBOX_NAMES.hasOwnProperty(var_id)){lightbox_submit.variation_name=DIGIOH_LIGHTBOX_NAMES[var_id];}
if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(orig_lid)){lightbox_submit.lightbox_short_id=DIGIOH_LIGHTBOX_IDS[orig_lid];}
if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(var_id)){lightbox_submit.variation_short_id=DIGIOH_LIGHTBOX_IDS[var_id];}
var submit_schema=mergeObjectData(lightbox_submit,form_data);var dataStorageType="";var obfuscatedFieldsArr=[];if(typeof DIGIOH_DATA_STORAGE_TYPE_BY_BOX_OBJ==='object'){if(var_id&&var_id.indexOf('var')===0&&DIGIOH_DATA_STORAGE_TYPE_BY_BOX_OBJ.hasOwnProperty(var_id)&&DIGIOH_DATA_STORAGE_TYPE_BY_BOX_OBJ[var_id]){if(DIGIOH_DATA_STORAGE_TYPE_BY_BOX_OBJ[var_id]==='none'){return;}else if(DIGIOH_DATA_STORAGE_TYPE_BY_BOX_OBJ[var_id]!=='all'){obfuscatedFieldsArr=DIGIOH_DATA_STORAGE_TYPE_BY_BOX_OBJ[var_id].split(',');}}else if(DIGIOH_DATA_STORAGE_TYPE_BY_BOX_OBJ.hasOwnProperty(orig_lid)&&DIGIOH_DATA_STORAGE_TYPE_BY_BOX_OBJ[orig_lid]){if(DIGIOH_DATA_STORAGE_TYPE_BY_BOX_OBJ[orig_lid]==='none'){return;}else if(DIGIOH_DATA_STORAGE_TYPE_BY_BOX_OBJ[orig_lid]!=='all'){obfuscatedFieldsArr=DIGIOH_DATA_STORAGE_TYPE_BY_BOX_OBJ[orig_lid].split(',');}}}
if(obfuscatedFieldsArr.length>0){if(DIGIOH_API.contains(obfuscatedFieldsArr,'ip')){submit_schema.geoip.ip_address="****";if(submit_schema.keen.addons.length>0&&submit_schema.keen.addons[0].name=="keen:ip_to_geo"){submit_schema.keen.addons.shift();delete submit_schema.ip_address;}}
if(DIGIOH_API.contains(obfuscatedFieldsArr,'city')){submit_schema.geoip.city="****";}
if(DIGIOH_API.contains(obfuscatedFieldsArr,'state')){submit_schema.geoip.region_code="**";submit_schema.geoip.region_name="****";}
if(DIGIOH_API.contains(obfuscatedFieldsArr,'country')){submit_schema.geoip.country_code="**";submit_schema.geoip.country_name="****";}
if(DIGIOH_API.contains(obfuscatedFieldsArr,'zip')){submit_schema.geoip.zipcode="****";}
if(DIGIOH_API.contains(obfuscatedFieldsArr,'ip')||DIGIOH_API.contains(obfuscatedFieldsArr,'city')||DIGIOH_API.contains(obfuscatedFieldsArr,'state')||DIGIOH_API.contains(obfuscatedFieldsArr,'country')||DIGIOH_API.contains(obfuscatedFieldsArr,'zip')){delete submit_schema.geoip.latitude;delete submit_schema.geoip.longitude;if(submit_schema.keen.hasOwnProperty('location')){delete submit_schema.keen.location;}}
if(DIGIOH_API.contains(obfuscatedFieldsArr,'email')&&submit_schema.hasOwnProperty('email')&&submit_schema.email){if(!submit_schema.email.contains('@')||submit_schema.email.split('@')[0].length<1){submit_schema.email="***@***.***";}else{var emstart=submit_schema.email.split('@')[0];submit_schema.email=emstart.substr(0,1)+"****"+emstart.slice(-1)+"@"+submit_schema.email.split('@')[1];}}
if(DIGIOH_API.contains(obfuscatedFieldsArr,'name')&&submit_schema.hasOwnProperty('name')&&submit_schema.name){submit_schema.name="****";}
if(DIGIOH_API.contains(obfuscatedFieldsArr,'first_name')&&submit_schema.hasOwnProperty('first_name')&&submit_schema.first_name){submit_schema.first_name="****";}
if(DIGIOH_API.contains(obfuscatedFieldsArr,'last_name')&&submit_schema.hasOwnProperty('last_name')&&submit_schema.last_name){submit_schema.last_name="****";}
if(DIGIOH_API.contains(obfuscatedFieldsArr,'phone')&&submit_schema.hasOwnProperty('phone')&&submit_schema.phone){submit_schema.phone="****";}
for(var i=1;i<=20;i++){var custom_n='custom_'+i;if(DIGIOH_API.contains(obfuscatedFieldsArr,custom_n)&&submit_schema.hasOwnProperty(custom_n)&&submit_schema[custom_n]){submit_schema[custom_n]="****";}}}
if(window.DIGIOH_API.LIGHTBOX.hasOwnProperty('keen_custom_js_data')){submit_schema.custom_js_data=window.DIGIOH_API.LIGHTBOX.keen_custom_js_data;}
KEEN_CLIENT.addEvent("lightbox_submit",submit_schema,function(res,err){if(res&&typeof res==='object'&&res.hasOwnProperty('created')&&res.created===true){logger('keenLightboxSubmit: success!');logger(res);}else if(err){logErrorText("keenLightboxSubmit_ERROR","keenLightboxSubmit_ERROR");}
else{logErrorText("keenLightboxSubmit_ERROR_OTHER","keenLightboxSubmit_ERROR_OTHER");}});}
catch(e){logErrorText("keenLightboxSubmit_EXCEPTION","keenLightboxSubmit_EXCEPTION");}}
function keenLightboxRedirect(lid){try{}
catch(e){logErrorText("keenLightboxRedirect_EXCEPTION","keenLightboxRedirect_EXCEPTION");}}
function keenLightboxDownload(lid){try{var var_id='';var orig_lid=lid;if(DIGIOH_VARIATION_TO_BOX_MAP.hasOwnProperty(lid)){orig_lid=DIGIOH_VARIATION_TO_BOX_MAP[lid];var_id=lid;}else if(LIGHTBOX_TO_VARIATION_MAP.hasOwnProperty(lid)){var_id=LIGHTBOX_TO_VARIATION_MAP[lid];}
var ab_test_id='';if(var_id!=''&&AB_BOXES_TAKE_MAP.hasOwnProperty(var_id)){ab_test_id=AB_BOXES_TAKE_MAP[var_id];}else if(AB_BOXES_TAKE_MAP.hasOwnProperty(orig_lid)){ab_test_id=AB_BOXES_TAKE_MAP[orig_lid];}
if(!WAS_DOWNLOAD_REGISTERED.hasOwnProperty(orig_lid)){WAS_DOWNLOAD_REGISTERED[orig_lid]=0;}
WAS_DOWNLOAD_REGISTERED[orig_lid]++;if(!IS_PREVIEW){if(BLIP_MATCHED===1){logErrorText("BLIP_MATCHED_INVALID_DOWNLOAD","BLIP_MATCHED_INVALID_DOWNLOAD");return;}}
var vendorShortId=VENDOR_GUID||'empty';var boxShortId=orig_lid||'empty';var variationShortId=var_id||'empty';var splitShortId=ab_test_id||'empty';if(typeof DIGIOH_VENDOR_SHORT_ID!=='undefined'){vendorShortId=DIGIOH_VENDOR_SHORT_ID;}
if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(orig_lid)&&DIGIOH_LIGHTBOX_IDS[orig_lid]){boxShortId=DIGIOH_LIGHTBOX_IDS[orig_lid];}
if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(var_id)&&DIGIOH_LIGHTBOX_IDS[var_id]){variationShortId=DIGIOH_LIGHTBOX_IDS[var_id];}
if(typeof DIGIOH_SPLIT_TESTS_ARR!=='undefined'&&DIGIOH_SPLIT_TESTS_ARR.length){for(var i=0;i<DIGIOH_SPLIT_TESTS_ARR.length;i++){if(DIGIOH_SPLIT_TESTS_ARR[i].hasOwnProperty('split_short_id')&&DIGIOH_SPLIT_TESTS_ARR[i].hasOwnProperty('split_guid')&&DIGIOH_SPLIT_TESTS_ARR[i]['split_guid']==ab_test_id){splitShortId=DIGIOH_SPLIT_TESTS_ARR[i]['split_short_id'];break;}}}
updateKeenSchemaBeforeSending();var lightbox_download=KEEN_SCHEMA;lightbox_download.cache_version=DIGIOH_CACHE_VERSION;lightbox_download.is_preview=IS_PREVIEW;lightbox_download.ip_address="${keen.ip}";lightbox_download.user_agent="${keen.user_agent}";lightbox_download.vendor_id=VENDOR_GUID;lightbox_download.client_id=CLIENT_GUID;lightbox_download.event_id=generateGuidWithTimestamp();lightbox_download.lightbox_id=orig_lid;lightbox_download.variation_id=var_id;lightbox_download.ab_test_id=ab_test_id;lightbox_download.uid=vendorShortId;lightbox_download.bid=boxShortId;lightbox_download.vid=variationShortId;lightbox_download.sid=splitShortId;lightbox_download.page_total_time=TOTAL_TIME;lightbox_download.page_active_time=TOTAL_TIME-IDLE_TIME;lightbox_download.page_idle_time=IDLE_TIME;lightbox_download.impressions_on_page=(WAS_IMPRESSION_REGISTERED.hasOwnProperty(orig_lid)?WAS_IMPRESSION_REGISTERED[orig_lid]:0);lightbox_download.downloads_on_page=WAS_DOWNLOAD_REGISTERED[orig_lid];if(var_id&&EFFECTS.hasOwnProperty(var_id)){lightbox_download.widget_type=EFFECTS[var_id].widget_type;}else{lightbox_download.widget_type=EFFECTS[orig_lid].widget_type;}
if(DIGIOH_LIGHTBOX_NAMES.hasOwnProperty(orig_lid)){lightbox_download.lightbox_name=DIGIOH_LIGHTBOX_NAMES[orig_lid];}
if(DIGIOH_LIGHTBOX_NAMES.hasOwnProperty(var_id)){lightbox_download.variation_name=DIGIOH_LIGHTBOX_NAMES[var_id];}
if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(orig_lid)){lightbox_download.lightbox_short_id=DIGIOH_LIGHTBOX_IDS[orig_lid];}
if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(var_id)){lightbox_download.variation_short_id=DIGIOH_LIGHTBOX_IDS[var_id];}
if(window.DIGIOH_API.LIGHTBOX.hasOwnProperty('keen_custom_js_data')){lightbox_download.custom_js_data=window.DIGIOH_API.LIGHTBOX.keen_custom_js_data;}
KEEN_CLIENT.addEvent("lightbox_download",lightbox_download,function(res,err){if(res&&typeof res==='object'&&res.hasOwnProperty('created')&&res.created===true){logger('keenLightboxDownload: success!');logger(res);}else if(err){logErrorText("keenLightboxDownload_ERROR","keenLightboxDownload_ERROR");}
else{logErrorText("keenLightboxDownload_ERROR_OTHER","keenLightboxDownload_ERROR_OTHER");}});LIGHTBOX_OPEN_TIME=TOTAL_TIME;}
catch(e){logErrorText("keenLightboxDownload_EXCEPTION","keenLightboxDownload_EXCEPTION");}}
function keenLightboxPageChange(lid,page_prefix){try{var var_id='';var orig_lid=lid;if(DIGIOH_VARIATION_TO_BOX_MAP.hasOwnProperty(lid)){orig_lid=DIGIOH_VARIATION_TO_BOX_MAP[lid];var_id=lid;}else if(LIGHTBOX_TO_VARIATION_MAP.hasOwnProperty(lid)){var_id=LIGHTBOX_TO_VARIATION_MAP[lid];}
var ab_test_id='';if(var_id!=''&&AB_BOXES_TAKE_MAP.hasOwnProperty(var_id)){ab_test_id=AB_BOXES_TAKE_MAP[var_id];}else if(AB_BOXES_TAKE_MAP.hasOwnProperty(orig_lid)){ab_test_id=AB_BOXES_TAKE_MAP[orig_lid];}
if(!IS_PREVIEW){if(BLIP_MATCHED===1){logErrorText("BLIP_MATCHED_INVALID_PAGE_CHANGE","BLIP_MATCHED_INVALID_PAGE_CHANGE");return;}}
if(page_prefix===''||page_prefix==='main'){page_prefix='main_page';}else if(page_prefix==='thx'||page_prefix==='thx_'){page_prefix='thank_you_page';}
else if(page_prefix.indexOf('ep')===0)
{var pNum=getExtraPageNumberFromEPString(page_prefix);page_prefix='extra_page_'+pNum;}
var vendorShortId=VENDOR_GUID||'empty';var boxShortId=orig_lid||'empty';var variationShortId=var_id||'empty';var splitShortId=ab_test_id||'empty';if(typeof DIGIOH_VENDOR_SHORT_ID!=='undefined'){vendorShortId=DIGIOH_VENDOR_SHORT_ID;}
if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(orig_lid)&&DIGIOH_LIGHTBOX_IDS[orig_lid]){boxShortId=DIGIOH_LIGHTBOX_IDS[orig_lid];}
if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(var_id)&&DIGIOH_LIGHTBOX_IDS[var_id]){variationShortId=DIGIOH_LIGHTBOX_IDS[var_id];}
if(typeof DIGIOH_SPLIT_TESTS_ARR!=='undefined'&&DIGIOH_SPLIT_TESTS_ARR.length){for(var i=0;i<DIGIOH_SPLIT_TESTS_ARR.length;i++){if(DIGIOH_SPLIT_TESTS_ARR[i].hasOwnProperty('split_short_id')&&DIGIOH_SPLIT_TESTS_ARR[i].hasOwnProperty('split_guid')&&DIGIOH_SPLIT_TESTS_ARR[i]['split_guid']==ab_test_id){splitShortId=DIGIOH_SPLIT_TESTS_ARR[i]['split_short_id'];break;}}}
updateKeenSchemaBeforeSending();var lightbox_page_change=KEEN_SCHEMA;lightbox_page_change.cache_version=DIGIOH_CACHE_VERSION;lightbox_page_change.is_preview=IS_PREVIEW;lightbox_page_change.ip_address="${keen.ip}";lightbox_page_change.user_agent="${keen.user_agent}";lightbox_page_change.vendor_id=VENDOR_GUID;lightbox_page_change.client_id=CLIENT_GUID;lightbox_page_change.event_id=generateGuidWithTimestamp();lightbox_page_change.lightbox_id=orig_lid;lightbox_page_change.variation_id=var_id;lightbox_page_change.ab_test_id=ab_test_id;lightbox_page_change.uid=vendorShortId;lightbox_page_change.bid=boxShortId;lightbox_page_change.vid=variationShortId;lightbox_page_change.sid=splitShortId;lightbox_page_change.page_total_time=TOTAL_TIME;lightbox_page_change.page_active_time=TOTAL_TIME-IDLE_TIME;lightbox_page_change.page_idle_time=IDLE_TIME;lightbox_page_change.impressions_on_page=(WAS_IMPRESSION_REGISTERED.hasOwnProperty(orig_lid)?WAS_IMPRESSION_REGISTERED[orig_lid]:0);lightbox_page_change.page_name=page_prefix;if(var_id&&EFFECTS.hasOwnProperty(var_id)){lightbox_page_change.widget_type=EFFECTS[var_id].widget_type;}else{lightbox_page_change.widget_type=EFFECTS[orig_lid].widget_type;}
if(DIGIOH_LIGHTBOX_NAMES.hasOwnProperty(orig_lid)){lightbox_page_change.lightbox_name=DIGIOH_LIGHTBOX_NAMES[orig_lid];}
if(DIGIOH_LIGHTBOX_NAMES.hasOwnProperty(var_id)){lightbox_page_change.variation_name=DIGIOH_LIGHTBOX_NAMES[var_id];}
if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(orig_lid)){lightbox_page_change.lightbox_short_id=DIGIOH_LIGHTBOX_IDS[orig_lid];}
if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(var_id)){lightbox_page_change.variation_short_id=DIGIOH_LIGHTBOX_IDS[var_id];}
if(window.DIGIOH_API.LIGHTBOX.hasOwnProperty('keen_custom_js_data')){lightbox_page_change.custom_js_data=window.DIGIOH_API.LIGHTBOX.keen_custom_js_data;}
KEEN_CLIENT.addEvent("lightbox_page_change",lightbox_page_change);LIGHTBOX_OPEN_TIME=TOTAL_TIME;}
catch(e){logErrorText("keenLightboxPageChange_EXCEPTION","keenLightboxPageChange_EXCEPTION");}}
var keenLightboxDebug=function(lid,additional_data_obj){try{var var_id='';var orig_lid=lid;if(DIGIOH_VARIATION_TO_BOX_MAP.hasOwnProperty(lid)){orig_lid=DIGIOH_VARIATION_TO_BOX_MAP[lid];var_id=lid;}else if(LIGHTBOX_TO_VARIATION_MAP.hasOwnProperty(lid)){var_id=LIGHTBOX_TO_VARIATION_MAP[lid];}
var ab_test_id='';if(var_id!=''&&AB_BOXES_TAKE_MAP.hasOwnProperty(var_id)){ab_test_id=AB_BOXES_TAKE_MAP[var_id];}else if(AB_BOXES_TAKE_MAP.hasOwnProperty(orig_lid)){ab_test_id=AB_BOXES_TAKE_MAP[orig_lid];}
var vendorShortId=VENDOR_GUID||'empty';var boxShortId=orig_lid||'empty';var variationShortId=var_id||'empty';var splitShortId=ab_test_id||'empty';if(typeof DIGIOH_VENDOR_SHORT_ID!=='undefined'){vendorShortId=DIGIOH_VENDOR_SHORT_ID;}
if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(orig_lid)&&DIGIOH_LIGHTBOX_IDS[orig_lid]){boxShortId=DIGIOH_LIGHTBOX_IDS[orig_lid];}
if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(var_id)&&DIGIOH_LIGHTBOX_IDS[var_id]){variationShortId=DIGIOH_LIGHTBOX_IDS[var_id];}
if(typeof DIGIOH_SPLIT_TESTS_ARR!=='undefined'&&DIGIOH_SPLIT_TESTS_ARR.length){for(var i=0;i<DIGIOH_SPLIT_TESTS_ARR.length;i++){if(DIGIOH_SPLIT_TESTS_ARR[i].hasOwnProperty('split_short_id')&&DIGIOH_SPLIT_TESTS_ARR[i].hasOwnProperty('split_guid')&&DIGIOH_SPLIT_TESTS_ARR[i]['split_guid']==ab_test_id){splitShortId=DIGIOH_SPLIT_TESTS_ARR[i]['split_short_id'];break;}}}
updateKeenSchemaBeforeSending();var lightbox_debug=KEEN_SCHEMA;lightbox_debug.cache_version=DIGIOH_CACHE_VERSION;lightbox_debug.is_preview=IS_PREVIEW;lightbox_debug.ip_address="${keen.ip}";lightbox_debug.user_agent="${keen.user_agent}";lightbox_debug.vendor_id=VENDOR_GUID;lightbox_debug.client_id=CLIENT_GUID;lightbox_debug.event_id=generateGuidWithTimestamp();lightbox_debug.lightbox_id=orig_lid;lightbox_debug.variation_id=var_id;lightbox_debug.ab_test_id=ab_test_id;lightbox_debug.uid=vendorShortId;lightbox_debug.bid=boxShortId;lightbox_debug.vid=variationShortId;lightbox_debug.sid=splitShortId;lightbox_debug.page_total_time=TOTAL_TIME;lightbox_debug.page_active_time=TOTAL_TIME-IDLE_TIME;lightbox_debug.page_idle_time=IDLE_TIME;lightbox_debug.impressions_on_page=(WAS_IMPRESSION_REGISTERED.hasOwnProperty(orig_lid)?WAS_IMPRESSION_REGISTERED[orig_lid]:0);if(DIGIOH_LIGHTBOX_NAMES.hasOwnProperty(orig_lid)){lightbox_debug.lightbox_name=DIGIOH_LIGHTBOX_NAMES[orig_lid];}
if(DIGIOH_LIGHTBOX_NAMES.hasOwnProperty(var_id)){lightbox_debug.variation_name=DIGIOH_LIGHTBOX_NAMES[var_id];}
if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(orig_lid)){lightbox_debug.lightbox_short_id=DIGIOH_LIGHTBOX_IDS[orig_lid];}
if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(var_id)){lightbox_debug.variation_short_id=DIGIOH_LIGHTBOX_IDS[var_id];}
if(window.DIGIOH_API.LIGHTBOX.hasOwnProperty('keen_custom_js_data')){lightbox_debug.custom_js_data=window.DIGIOH_API.LIGHTBOX.keen_custom_js_data;}
if(typeof additional_data_obj!=='undefined'&&additional_data_obj!==null){var debug_schema=mergeObjectData(lightbox_debug,additional_data_obj);KEEN_CLIENT.addEvent("lightbox_debug",debug_schema);}else{KEEN_CLIENT.addEvent("lightbox_debug",lightbox_debug);}}
catch(e){logError(e,"keenLightboxDebug");}};function updateKeenSchemaBeforeSending(){try{KEEN_SCHEMA.geoip={ip_address:DIGIOH_LIGHTBOX_ANALYTICS.VARS.ip_address,continent_code:DIGIOH_LIGHTBOX_ANALYTICS.VARS.continent,country_code:DIGIOH_LIGHTBOX_ANALYTICS.VARS.country,country_name:DIGIOH_LIGHTBOX_ANALYTICS.VARS.country_name,region_code:DIGIOH_LIGHTBOX_ANALYTICS.VARS.state,region_name:DIGIOH_LIGHTBOX_ANALYTICS.VARS.region_name,city:DIGIOH_LIGHTBOX_ANALYTICS.VARS.city,zipcode:DIGIOH_LIGHTBOX_ANALYTICS.VARS.zipcode,metro_code:DIGIOH_LIGHTBOX_ANALYTICS.VARS.metro_code,time_zone:DIGIOH_LIGHTBOX_ANALYTICS.VARS.time_zone,area_code:DIGIOH_LIGHTBOX_ANALYTICS.VARS.area_code,latitude:DIGIOH_LIGHTBOX_ANALYTICS.VARS.latitude,longitude:DIGIOH_LIGHTBOX_ANALYTICS.VARS.longitude,geo_source:DIGIOH_LIGHTBOX_ANALYTICS.VARS.geo_source,blip_matched:BLIP_MATCHED};KEEN_SCHEMA.device_atlas={primaryHardwareType:DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.primaryHardwareType,isApp:DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.isApp,isTablet:DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.isTablet,isMobilePhone:DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.isMobilePhone,model:DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.model,vendor:DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.vendor,touchScreen:DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.touchScreen,osName:DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.osName,osVersion:DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.osVersion,browserName:DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.browserName,browserVersion:DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.browserVersion,osAndroid:DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.osAndroid,osiOs:DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.osiOs,device_source:DIGIOH_LIGHTBOX_ANALYTICS.VARS.device_source};KEEN_SCHEMA.device={hardware:DIGIOH_LIGHTBOX_ANALYTICS.VARS.device,os:DIGIOH_LIGHTBOX_ANALYTICS.VARS.operating_system,browser_type:DIGIOH_LIGHTBOX_ANALYTICS.VARS.browser_type,browser_version:DIGIOH_LIGHTBOX_ANALYTICS.VARS.browser_version};KEEN_SCHEMA.entry_point={referrer_url:DIGIOH_LIGHTBOX_ANALYTICS.VARS.referring_website_url,landing_page_url:DIGIOH_LIGHTBOX_ANALYTICS.VARS.landing_page,landing_page_ip:DIGIOH_LIGHTBOX_ANALYTICS.VARS.landing_page_ip,landing_page_date:DIGIOH_LIGHTBOX_ANALYTICS.VARS.date_of_visit,web_source:DIGIOH_LIGHTBOX_ANALYTICS.VARS.web_source,past_visits:DIGIOH_LIGHTBOX_ANALYTICS.VARS.past_visits,page_visits:DIGIOH_LIGHTBOX_ANALYTICS.VARS.page_visits,search_engine:DIGIOH_LIGHTBOX_ANALYTICS.VARS.search_engine,utm_campaign_source:DIGIOH_LIGHTBOX_ANALYTICS.VARS.utm_campaign_source,utm_campaign_medium:DIGIOH_LIGHTBOX_ANALYTICS.VARS.utm_campaign_medium,utm_campaign_term:DIGIOH_LIGHTBOX_ANALYTICS.VARS.utm_campaign_term,utm_campaign_content:DIGIOH_LIGHTBOX_ANALYTICS.VARS.utm_campaign_content,utm_campaign_name:DIGIOH_LIGHTBOX_ANALYTICS.VARS.utm_campaign_name};}
catch(e){logError(e,"updateKeenSchemaBeforeSending");}}
function postToKeen(post_query,lid,sid){try{var src="https://submit.lightboxcdn.com/Keen/PostToKeen2";var src3="https://submitcus.lightboxcdn.com/Keen/PostToKeen3";if(IS_DEV||DIGIOH_API.contains(window.location.host,"robert.lightbox")||DIGIOH_API.contains(window.location.host,"-robert.az")||DIGIOH_API.contains(window.location.host,"robert.digioh"))
src="https://robert.lightboxcdn.com/Keen/PostToKeenR2";var var_id='';var orig_lid=lid;if(DIGIOH_VARIATION_TO_BOX_MAP.hasOwnProperty(lid)){orig_lid=DIGIOH_VARIATION_TO_BOX_MAP[lid];var_id=lid;}else if(LIGHTBOX_TO_VARIATION_MAP.hasOwnProperty(lid)){var_id=LIGHTBOX_TO_VARIATION_MAP[lid];}
var ab_test_id='';if(var_id!=''&&AB_BOXES_TAKE_MAP.hasOwnProperty(var_id)){ab_test_id=AB_BOXES_TAKE_MAP[var_id];}else if(AB_BOXES_TAKE_MAP.hasOwnProperty(orig_lid)){ab_test_id=AB_BOXES_TAKE_MAP[orig_lid];}
if(!IS_PREVIEW){if(BLIP_MATCHED===1){logger("BLIP_MATCHED_INVALID_SUBMIT_POSTTOKEEN","BLIP_MATCHED_INVALID_SUBMIT_POSTTOKEEN");return;}}
var delay_integration=false;if(post_query.indexOf('delay_integration_3_minutes')>0)
{delay_integration=true;}
var required_params='';required_params+='_uid='+VENDOR_GUID+'&';required_params+='_lid='+orig_lid+'&';required_params+='_vid='+var_id+'&';required_params+='_tid='+ab_test_id+'&';required_params+='_cid='+CLIENT_GUID+'&';required_params+='_sid='+sid+'&';var query="?_form="+LZString.compressToBase64(required_params+post_query);var extended_data={};extended_data.g={};var qsext="";qsext+=(DIGIOH_LIGHTBOX_ANALYTICS.VARS.city||'');qsext+="|_-_|"+(DIGIOH_LIGHTBOX_ANALYTICS.VARS.region_name||'');qsext+="|_-_|"+(DIGIOH_LIGHTBOX_ANALYTICS.VARS.country||'');qsext+="|_-_|"+(DIGIOH_LIGHTBOX_ANALYTICS.VARS.country_name||'');qsext+="|_-_|"+(DIGIOH_LIGHTBOX_ANALYTICS.VARS.continent||'');qsext+="|_-_|"+(DIGIOH_LIGHTBOX_ANALYTICS.VARS.ip_address||'');qsext+="|_-_|"+(DIGIOH_LIGHTBOX_ANALYTICS.VARS.zipcode||'');qsext+="|_-_|"+(DIGIOH_LIGHTBOX_ANALYTICS.VARS.web_source||'');qsext+="|_-_|"+(DIGIOH_LIGHTBOX_ANALYTICS.VARS.search_engine||'');qsext+="|_-_|"+(DIGIOH_LIGHTBOX_ANALYTICS.VARS.page_visits||'0');qsext+="|_-_|"+(DIGIOH_LIGHTBOX_ANALYTICS.VARS.past_visits||'0');qsext+="|_-_|"+(DIGIOH_LIGHTBOX_ANALYTICS.VARS.referring_website_url||'');qsext+="|_-_|"+(DIGIOH_LIGHTBOX_ANALYTICS.VARS.landing_page||'');qsext+="|_-_|"+(DIGIOH_LIGHTBOX_ANALYTICS.VARS.current_page_url||'');qsext+="|_-_|"+(DIGIOH_LIGHTBOX_ANALYTICS.VARS.device||'');qsext+="|_-_|"+(DIGIOH_LIGHTBOX_ANALYTICS.VARS.browser_type||'');qsext+="|_-_|"+(DIGIOH_LIGHTBOX_ANALYTICS.VARS.browser_version||'');qsext+="|_-_|"+(DIGIOH_LIGHTBOX_ANALYTICS.VARS.operating_system||'');qsext+="|_-_|"+(DIGIOH_LIGHTBOX_ANALYTICS.VARS.date_of_visit||'');qsext+="|_-_|"+(DIGIOH_LIGHTBOX_ANALYTICS.VARS.utm_campaign_source||'');qsext+="|_-_|"+(DIGIOH_LIGHTBOX_ANALYTICS.VARS.utm_campaign_medium||'');qsext+="|_-_|"+(DIGIOH_LIGHTBOX_ANALYTICS.VARS.utm_campaign_term||'');qsext+="|_-_|"+(DIGIOH_LIGHTBOX_ANALYTICS.VARS.utm_campaign_content||'');qsext+="|_-_|"+(DIGIOH_LIGHTBOX_ANALYTICS.VARS.utm_campaign_name||'');if(IS_DEV)qsext+="|_-_|1";else qsext+="|_-_|0";if(IS_PREVIEW)qsext+="|_-_|1";else qsext+="|_-_|0";query+="&_ext="+LZString.compressToBase64(qsext);if(window.DIGIOH_API.LIGHTBOX.hasOwnProperty('INTEGRATION_MAP')&&window.DIGIOH_API.LIGHTBOX.INTEGRATION_MAP!==null&&typeof window.DIGIOH_API.LIGHTBOX.INTEGRATION_MAP==='object'){var iov='';for(var iprop in window.DIGIOH_API.LIGHTBOX.INTEGRATION_MAP){if(window.DIGIOH_API.LIGHTBOX.INTEGRATION_MAP.hasOwnProperty(iprop)){if(iov!==''){iov+='|';}
iov+=iprop+'='+window.DIGIOH_API.LIGHTBOX.INTEGRATION_MAP[iprop];}}
if(iov!==''){query+="&_iov="+LZString.compressToBase64(iov);}}
if(!delay_integration)
{var img=new Image();img.src=(src+query);}
var img3=new Image();img3.src=(src3+query);analyticsSubmit(orig_lid,var_id,ab_test_id);}
catch(e){logError(e,"postToKeen");}}
function initAnalytics(){try{DIGIOH_LIGHTBOX_ANALYTICS.onDocumentReady();DIGIOH_LIGHTBOX_ANALYTICS.loadAllVars();DIGIOH_LIGHTBOX_ANALYTICS.VARS.IsLoaded=true;startIdleTimer();initKeenSchema();}
catch(e){logError(e,"initAnalytics");}}
var onPageUrlChanged;var onInfiniteScrollPageChanged;function embedInlineLightboxConditionsForms(){try{for(var i=0;i<DIGIOH_LIGHTBOX_INLINE_CONDITIONS_ARR.length;i++){if(IS_PREVIEW||checkConditions('',DIGIOH_LIGHTBOX_INLINE_CONDITIONS_ARR[i],'',false)===DIGIOH_LIGHTBOX_INLINE_CONDITIONS_ARR[i]){if(!DIGIOH_API.contains(DIGIOH_LIGHTBOX_INLINE_DISPLAYED,DIGIOH_LIGHTBOX_INLINE_CONDITIONS_ARR[i])){var embedSuccess=embedInlineLightboxForm(DIGIOH_LIGHTBOX_INLINE_CONDITIONS_ARR[i]);if(embedSuccess){DIGIOH_LIGHTBOX_INLINE_DISPLAYED.push(DIGIOH_LIGHTBOX_INLINE_CONDITIONS_ARR[i]);logger('DIGIOH::::embedInlineLightboxConditionsForms('+DIGIOH_LIGHTBOX_INLINE_CONDITIONS_ARR[i]+') ==> PASS');}
else{logger('DIGIOH::::embedInlineLightboxConditionsForms('+DIGIOH_LIGHTBOX_INLINE_CONDITIONS_ARR[i]+') ==> FAIL 1');}}
else{logger('DIGIOH::::embedInlineLightboxConditionsForms('+DIGIOH_LIGHTBOX_INLINE_CONDITIONS_ARR[i]+') ==> FAIL 2');}}
else{logger('DIGIOH::::embedInlineLightboxConditionsForms('+DIGIOH_LIGHTBOX_INLINE_CONDITIONS_ARR[i]+') ==> FAIL 3');}}
logger('ran embedInlineLightboxConditionsForms('+DIGIOH_LIGHTBOX_INLINE_CONDITIONS_ARR.length+')');}
catch(e){logError(e,"embedInlineLightboxConditionsForms");}}
var closeAllInlineForms=function(){try{for(var i=0;i<DIGIOH_LIGHTBOX_INLINE_ALWAYS_ARR.length;i++){closeInline(DIGIOH_LIGHTBOX_INLINE_ALWAYS_ARR[i]);}
for(var i=0;i<DIGIOH_LIGHTBOX_INLINE_CONDITIONS_ARR.length;i++){closeInline(DIGIOH_LIGHTBOX_INLINE_CONDITIONS_ARR[i]);}}
catch(err){logError(e,"closeAllInlineForms");}};var reDisplayInlineForm=function(lid){try{if(DIGIOH_API.contains(PRELOADED_LIGHTBOXES,lid)){PRELOADED_LIGHTBOXES=DIGIOH_API.remove(PRELOADED_LIGHTBOXES,lid);}
if(DIGIOH_API.contains(DIGIOH_LIGHTBOX_INLINE_DISPLAYED,lid)){DIGIOH_LIGHTBOX_INLINE_DISPLAYED=DIGIOH_API.remove(DIGIOH_LIGHTBOX_INLINE_DISPLAYED,lid);}
var embedSuccess=embedInlineLightboxForm(lid);if(embedSuccess){DIGIOH_LIGHTBOX_INLINE_DISPLAYED.push(lid);}
else{}}
catch(e){logError(e,"redisplayInlineForm");}};var isActiveBox=function(lbid){try{return JQUERY_DIGIOH.inArray(lbid,LOADED_LIGHTBOXES)>=0;}
catch(e){logError(e,"isActiveBox");}};function keepSendingResizeToChildUntilReceived(resize_obj,lbid,retry_delay,cnt){try{var resizeReceivedByChild=sendMessageToIframe(resize_obj,lbid);if(!resizeReceivedByChild&&cnt*retry_delay<5000){if(EFFECTS[lbid].widget_type==='inline'||isActiveBox(lbid))
window.setTimeout(function(){keepSendingResizeToChildUntilReceived(resize_obj,lbid,retry_delay,cnt+1);},retry_delay);}else if(cnt>0&&resizeReceivedByChild){logger('DIGIOH:  keepSendingResizeToChildUntilReceived: '+cnt+' misses before SUCCEEDING: '+lbid);}else if(!resizeReceivedByChild&&cnt*retry_delay>=5000){}}
catch(e){logError(e,"keepSendingResizeToChildUntilReceived");}}
function keepSendingEventNotificationToChildUntilReceived(notify_obj,lbid,retry_delay,cnt){try{var wasMessageReceivedByChild=sendMessageToIframe(notify_obj,lbid);if(!wasMessageReceivedByChild&&cnt*retry_delay<5000){if(EFFECTS[lbid].widget_type==='inline'||isActiveBox(lbid))
window.setTimeout,retry_delay);}else if(cnt>0&&wasMessageReceivedByChild){logger('DIGIOH:  keepSendingEventNotificationToChildUntilReceived: '+cnt+' misses before SUCCEEDING: '+lbid);}else if(!wasMessageReceivedByChild&&cnt*retry_delay>=5000){}}
catch(e){logError(e,"keepSendingEventNotificationToChildUntilReceived");}}
function getPagePref(lbid){try{var pref='';if(CURRENT_PAGE.hasOwnProperty(lbid)&&CURRENT_PAGE[lbid]!==''&&CURRENT_PAGE[lbid]!=='main'&&CURRENT_PAGE[lbid]){pref=CURRENT_PAGE[lbid];}
return pref;}
catch(e){logError(e,"getPagePref");return '';}}
var responsiveResizeCheck=function(trigger_source,lid){try{if(typeof lid!=='string'||lid.length<20){for(var b=0;b<LOADED_LIGHTBOXES.length;b++){if(LOADED_LIGHTBOXES[b]&&LOADED_LIGHTBOXES[b].length>20&&isActiveBox(LOADED_LIGHTBOXES[b])){responsiveResizeCheck(trigger_source,LOADED_LIGHTBOXES[b]);}}
for(var i=0;i<DIGIOH_LIGHTBOX_INLINE_DISPLAYED.length;i++){var lbid=DIGIOH_LIGHTBOX_INLINE_DISPLAYED[i];var var_id='';var orig_lid=lbid;if(DIGIOH_VARIATION_TO_BOX_MAP.hasOwnProperty(lbid))
{orig_lid=DIGIOH_VARIATION_TO_BOX_MAP[lbid];var_id=lbid;}
else if(LIGHTBOX_TO_VARIATION_MAP.hasOwnProperty(lbid))
{var_id=LIGHTBOX_TO_VARIATION_MAP[lbid];}
if(var_id!==''&&var_id.length>7)
{lbid=var_id;}
var dom_id=getLightboxDomId(lbid);var pref=getPagePref(lbid);var inlinePixelVersionChangeDetected=setPixelThreshold(lbid,true);if(inlinePixelVersionChangeDetected){logger('inlinePixelVersionChangeDetected: '+lbid);var pg='';if(CURRENT_PAGE.hasOwnProperty(lbid)){pg=CURRENT_PAGE[lbid];}
sendMessageToIframe({sender:'lightbox',action:'pixel_version_changed',page:pg},lbid);logger('responsiveResizeCheck_inline:pixel_version_changed: '+lbid);var widthAndHeight='';var widthAndHeightInlineResponsive='';var responsiveScale='';if(DIGIOH_USE_RESPONSIVE&&EFFECTS[lbid].hasOwnProperty(pref+'responsive')&&EFFECTS[lbid][pref+'responsive'].use)
{JQUERY_DIGIOH('#'+dom_id).css({'width':getResponsiveBoxWidthPercent(lbid)+'%','height':getResponsiveBoxHeightPercent(lbid)+'%','max-width':getResponsiveBoxWidthMax(lbid)+'px','min-width':getResponsiveBoxWidthMin(lbid)+'px','max-height':getResponsiveBoxHeightMax(lbid)+'px','min-height':getResponsiveBoxHeightMin(lbid)+'px'});}
else if(!DIGIOH_USE_RESPONSIVE&&EFFECTS[lbid].hasOwnProperty(pref+'responsive')&&EFFECTS[lbid][pref+'responsive'].use)
{var bw=getBoxWidth(lbid);var bh=getBoxHeight(lbid);JQUERY_DIGIOH('#'+dom_id).css({'width':'100%','height':bh+'px','max-width':'10000px','min-width':bw+'px','max-height':bh+'px','min-height':bh+'px'});}
else
{var bw=getBoxWidth(lbid);var bh=getBoxHeight(lbid);JQUERY_DIGIOH('#'+dom_id).css({'width':bw+'px','height':bh+'px','min-width':bw+'px','min-height':bh+'px','max-height':bh+'px'});}
setBoxToScrollMode(lbid,pg,'pixel_version_changed');}
if(EFFECTS.hasOwnProperty(lbid)&&EFFECTS[lbid].widget_type==='inline'&&EFFECTS[lbid].hasOwnProperty(pref+'responsive')&&EFFECTS[lbid][pref+'responsive'].use&&JQUERY_DIGIOH('#'+dom_id).length){inlineResponsiveResizing(lbid,dom_id,(new Date().getTime()),0,0);}}}
else if(lid&&lid!==''&&EFFECTS.hasOwnProperty(lid)&&EFFECTS[lid].widget_type!=='inline'){var pixelVersionChangeDetected=setPixelThreshold(lid,true);if(pixelVersionChangeDetected){logger('pixelVersionChangeDetected: '+lid);var pg='';if(CURRENT_PAGE.hasOwnProperty(lid)){pg=CURRENT_PAGE[lid];}
sendMessageToIframe({sender:'lightbox',action:'pixel_version_changed',page:pg},lid);setBoxToScrollMode(lid,pg,'pixel_version_changed');}
var dom_id=getLightboxDomId(lid);var pref=getPagePref(lid);if(EFFECTS[lid].hasOwnProperty(pref+'responsive')&&EFFECTS[lid][pref+'responsive'].use){var dims_obj=getActualBoxWidthAndHeight(lid);CURRENT_PAGE_DIMS_RESPONSIVE[lid]={width:dims_obj.width,height:dims_obj.height};if(EFFECTS[lid].widget_type==='sidebar'){if(FOCUSED_SIDEBAR_BANNER_GUIDS.hasOwnProperty(lid)&&FOCUSED_SIDEBAR_BANNER_GUIDS[lid]&&isMobile()){if(trigger_source==='mobile_orientation_change'){JQUERY_DIGIOH('#'+dom_id).attr('style',getSidebarPositionMobileFocused(EFFECTS[lid].sidebar,lid));}else{return;}}else{JQUERY_DIGIOH('#'+dom_id).attr('style',getSidebarPositionAfterAnimation(EFFECTS[lid].sidebar,lid));}}
if(EFFECTS[lid].widget_type==='banner'){if(FOCUSED_SIDEBAR_BANNER_GUIDS.hasOwnProperty(lid)&&FOCUSED_SIDEBAR_BANNER_GUIDS[lid]&&isMobile()){if(trigger_source==='mobile_orientation_change'){JQUERY_DIGIOH('#'+dom_id).attr('style',getBannerPositionMobileFocused(EFFECTS[lid].banner,lid));}else{return;}}else{JQUERY_DIGIOH('#'+dom_id).attr('style',getBannerPosition(EFFECTS[lid].banner,lid));}
if(!EFFECTS[lid].banner.hasOwnProperty('placement')||EFFECTS[lid].banner.placement!=='bottom'){if(JQUERY_DIGIOH('#banner-spacer-'+lid).length){var banner_height=getResponsiveBoxHeight(lid);JQUERY_DIGIOH('#banner-spacer-'+lid).height(banner_height);}}}
if(EFFECTS[lid].widget_type==='fancybox'){FANCY_REPOSITION_LOCKED[lid]=true;var left_new=Math.round(((jqWin.width()-dims_obj.width)/2)+jqWin.scrollLeft());var top_new=Math.round(((jqWin.height()-dims_obj.height)/2)+jqWin.scrollTop());var wrap=JQUERY_DIGIOH('.fb_lightbox-wrap').filter(':first');wrap.css({'left':left_new,'top':top_new,'width':dims_obj.width+'px','height':dims_obj.height+'px'});JQUERY_DIGIOH('#'+dom_id).css({'left':left_new,'top':top_new,'width':dims_obj.width+'px','height':dims_obj.height+'px'});}
keepSendingResizeToChildUntilReceived({sender:'lightbox',action:'dimensions_changed',widget_type:EFFECTS[lid].widget_type,width:dims_obj.width,height:dims_obj.height},lid,100,0);}
else{var dims_obj=getActualBoxWidthAndHeight(lid);if(EFFECTS[lid].widget_type==='sidebar'){if(FOCUSED_SIDEBAR_BANNER_GUIDS.hasOwnProperty(lid)&&FOCUSED_SIDEBAR_BANNER_GUIDS[lid]&&isMobile()){if(trigger_source==='mobile_orientation_change'){JQUERY_DIGIOH('#'+dom_id).attr('style',getSidebarPositionMobileFocused(EFFECTS[lid].sidebar,lid));}else{return;}}else{JQUERY_DIGIOH('#'+dom_id).attr('style',getSidebarPositionAfterAnimation(EFFECTS[lid].sidebar,lid));}}
if(EFFECTS[lid].widget_type==='banner'){if(FOCUSED_SIDEBAR_BANNER_GUIDS.hasOwnProperty(lid)&&FOCUSED_SIDEBAR_BANNER_GUIDS[lid]&&isMobile()){if(trigger_source==='mobile_orientation_change'){JQUERY_DIGIOH('#'+dom_id).attr('style',getBannerPositionMobileFocused(EFFECTS[lid].banner,lid));}else{return;}}else{JQUERY_DIGIOH('#'+dom_id).attr('style',getBannerPosition(EFFECTS[lid].banner,lid));}
if(!EFFECTS[lid].banner.hasOwnProperty('placement')||EFFECTS[lid].banner.placement!=='bottom'){if(JQUERY_DIGIOH('#banner-spacer-'+lid).length){var banner_height=JQUERY_DIGIOH('#'+dom_id).height();JQUERY_DIGIOH('#banner-spacer-'+lid).height(banner_height);}}}
if(EFFECTS[lid].widget_type==='fancybox'){FANCY_REPOSITION_LOCKED[lid]=true;var left_new=Math.round(((jqWin.width()-dims_obj.width)/2)+jqWin.scrollLeft());var top_new=Math.round(((jqWin.height()-dims_obj.height)/2)+jqWin.scrollTop());var m=getResponsiveScaleMultiplier(lid);var wrap=JQUERY_DIGIOH('.fb_lightbox-wrap').filter(':first');wrap.css({'left':left_new,'top':top_new,'width':dims_obj.width+'px','height':dims_obj.height+'px','transform':'scale('+m+')','-webkit-transform':'scale('+m+')','-moz-transform':'scale('+m+')','-ms-transform':'scale('+m+')','-o-transform':'scale('+m+')'});JQUERY_DIGIOH('#'+dom_id).css({'left':left_new,'top':top_new,'width':dims_obj.width+'px','height':dims_obj.height+'px','transform':'scale('+m+')','-webkit-transform':'scale('+m+')','-moz-transform':'scale('+m+')','-ms-transform':'scale('+m+')','-o-transform':'scale('+m+')'});}}}}
catch(e){logError(e,"responsiveResizeCheck");}}
function doOnOrientationChange(){try{responsiveResizeCheck('mobile_orientation_change');window.setTimeout(function(){responsiveResizeCheck('mobile_orientation_change');},350);window.setTimeout,850);}
catch(e){logError(e,"doOnOrientationChange");}}
function responsiveResizeOnWindowResize(){try{jqWin.resize);}
catch(e){logError(e,"responsiveResizeOnWindowResize");}}
var cloneObj;function initConditions(){try{var box_test_id=getUrlParam('box_test_id');var box_test_name=getUrlParam('box_test_name');var lbid='';if(IS_PREVIEW)
{DIGIOH_API.clearDataLayer();logger('clearDataLayer for Preview');}
if(box_test_id&&box_test_name){if(DIGIOH_LIGHTBOX_IDS){for(var guid in DIGIOH_LIGHTBOX_IDS){if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(guid)&&DIGIOH_LIGHTBOX_IDS[guid]===box_test_id){lbid=guid;break;}}
if(lbid){if(!EFFECTS.hasOwnProperty(lbid)||!EFFECTS[lbid]){logger('**DIGIOH_DEFAULT_EFFECTS() were required in Test Mode**');var w={};w.widget_type="sidebar";w.sidebar={};w.sidebar.css_positioning="fixed";w.sidebar.position="center-center";w.sidebar.speed={"open":100,"close":100};w.sidebar.animation={open:"fade",close:"fade"};w.sidebar.easing={open:"swing",close:"swing"};w.sidebar.close_button={display:false};w.sidebar.auto_close={"click":false,"time":0,"scroll_up":0,"scroll_down":0};w.sidebar.teaser={display:false};EFFECTS[lbid]=w;DIGIOH_LIGHTBOX_EFFECTS[lbid]=w;}
if(window.location.href.indexOf('lightbox-jquery-selector-generator')>0&&EFFECTS[lbid].widget_type==='inline'){DIGIOH_API.activeInlineSelectorGeneratorBox=lbid;}
else if(EFFECTS[lbid].widget_type==='inline'){if(!EFFECTS[lbid].hasOwnProperty('sidebar')){EFFECTS[lbid].sidebar={};EFFECTS[lbid].sidebar.animation={};EFFECTS[lbid].sidebar.easing={};EFFECTS[lbid].sidebar.auto_close={click:true,time:0,scroll_up:0,scroll_down:0};EFFECTS[lbid].sidebar.close_button={display:true,type:'default',image:'',position:'top-right',offset_x:-18,offset_y:-18};EFFECTS[lbid].sidebar.css='';EFFECTS[lbid].sidebar.css_positioning='absolute';EFFECTS[lbid].sidebar.speed={open:400,close:400};EFFECTS[lbid].sidebar.teaser={display:false,display_on_page_load:false};}
EFFECTS[lbid].widget_type='sidebar';EFFECTS[lbid].sidebar.position='center-center';EFFECTS[lbid].sidebar.animation.open='fade';EFFECTS[lbid].sidebar.animation.close='fade';EFFECTS[lbid].sidebar.easing.open='swing';EFFECTS[lbid].sidebar.easing.close='swing';EFFECTS[lbid].sidebar.overlay={};EFFECTS[lbid].sidebar.overlay.close_click=false;EFFECTS[lbid].sidebar.overlay.background={color:"rgba(255, 255, 255, 0)",gradient:"rgba(255, 255, 255, 0)",image:"",position:"left top",repeat:"no-repeat",use_gradient:false,use_image:false};responsiveResizeOnWindowResize();loadLightbox(lbid);}
else{responsiveResizeOnWindowResize();loadLightbox(lbid);}}else{alert('The Box you are trying to test is currently turned OFF, or it does not have any Conditions assigned to it.  In order to test a Box on your site, you must first turn the Box ON, add at least 1 Condition to it, and then Publish.  Note: only YOU will see this alert message, your visitors will NEVER see this message.');}}}
else if(!IS_PREVIEW){initABSplitTests();initVariations();initLightboxActivity();buildConditionSelectorsToBoxesMap();responsiveResizeOnWindowResize();if(isMobile()||isTablet()){window.addEventListener('orientationchange',doOnOrientationChange);DIGIOH_API.PREVIOUS_WINDOW_WIDTH=getiOSWindowWidth();DIGIOH_API.previousOrientation=window.orientation;window.setInterval,500);}
initExistsSelectors();embedInlineLightboxAlwaysForms();embedInlineLightboxConditionsForms();logger('DIGIOH: checkLightboxMasterRules() called from initConditions()');if(checkLightboxMasterRules()){preloadLightboxes();if(VENDOR_GUID!=="13511-7341134d-8e07-40ab-b595-a3d69d7a4501"||document.location.href.indexOf("ecospaints.net/shop-by-color-reds")!==-1){checkConditionsPreloadTeasers();}
initClickSelectors();initHoverSelectors();initScrollSelectors();initExitSelectors();checkConditionsLoad();logger('DIGIOH_LIGHTBOX_ANALYTICS.VARS ==>');logger(DIGIOH_LIGHTBOX_ANALYTICS.VARS,true);}}
else{initVariations();responsiveResizeOnWindowResize();if(isMobile()||isTablet()){window.addEventListener('orientationchange',doOnOrientationChange);}
lbid=LIGHTBOX_GUID_PREVIEW;if(typeof IS_VARIATION_PREVIEW!=='undefined'&&IS_VARIATION_PREVIEW==='true'&&VARIATION_GUID_PREVIEW&&VARIATION_GUID_PREVIEW.length>7){if(!LIGHTBOX_TO_VARIATION_MAP.hasOwnProperty(lbid)){LIGHTBOX_TO_VARIATION_MAP[lbid]=VARIATION_GUID_PREVIEW;}
if(!DIGIOH_VARIATION_TO_BOX_MAP.hasOwnProperty(VARIATION_GUID_PREVIEW)){DIGIOH_VARIATION_TO_BOX_MAP[VARIATION_GUID_PREVIEW]=LIGHTBOX_GUID_PREVIEW;}
lbid=VARIATION_GUID_PREVIEW;LIGHTBOX_GUID_PREVIEW=VARIATION_GUID_PREVIEW;if(DIGIOH_API.contains(DIGIOH_LIGHTBOX_INLINE_CONDITIONS_ARR,VARIATION_GUID_PREVIEW)){DIGIOH_LIGHTBOX_INLINE_CONDITIONS_ARR=[lbid,VARIATION_GUID_PREVIEW];}
else if(DIGIOH_API.contains(DIGIOH_LIGHTBOX_INLINE_ALWAYS_ARR,VARIATION_GUID_PREVIEW)){DIGIOH_LIGHTBOX_INLINE_ALWAYS_ARR=[lbid,VARIATION_GUID_PREVIEW];}}
embedInlineLightboxAlwaysForms();embedInlineLightboxConditionsForms();if(!EFFECTS.hasOwnProperty(lbid)||!EFFECTS[lbid]){logger('**DIGIOH_DEFAULT_EFFECTS() were required in Preview**');var w={};w.widget_type="sidebar";w.sidebar={};w.sidebar.css_positioning="fixed";w.sidebar.position="center-center";w.sidebar.speed={"open":100,"close":100};w.sidebar.animation={open:"fade",close:"fade"};w.sidebar.easing={open:"swing",close:"swing"};w.sidebar.close_button={display:false};w.sidebar.auto_close={"click":false,"time":0,"scroll_up":0,"scroll_down":0};w.sidebar.teaser={display:false};EFFECTS[lbid]=w;DIGIOH_LIGHTBOX_EFFECTS[lbid]=w;}
if(JQUERY_DIGIOH.inArray(lbid,DIGIOH_LIGHTBOX_PRELOAD_ARR)<0)
DIGIOH_LIGHTBOX_PRELOAD_ARR.push(lbid);var effects=EFFECTS[lbid];IS_PREVIEW_EVENT=(IS_PREVIEW_CLICK||IS_PREVIEW_HOVER||IS_PREVIEW_SCROLL||IS_PREVIEW_EXIT);preloadLightboxes();if(VENDOR_GUID!="13511-7341134d-8e07-40ab-b595-a3d69d7a4501"||document.location.href.indexOf("ecospaints.net/shop-by-color-reds")!==-1){if(effects.widget_type=="sidebar"&&effects.sidebar.teaser&&effects.sidebar.teaser.display_on_page_load){openTeaser(effects.sidebar.teaser,lbid);}else if(effects.widget_type=="fancybox"&&effects.fancybox.teaser&&effects.fancybox.teaser.display_on_page_load){openTeaser(effects.fancybox.teaser,lbid);}}
lbid='';if(typeof IS_PREVIEW_CLICK!=="undefined"&&IS_PREVIEW_CLICK){JQUERY_DIGIOH("#preview_click_selector").click(function(e){e.preventDefault();DIGIOH_LIGHTBOX_ANALYTICS.VARS.click_jquery_selector["#preview_click_selector"]=true;loadLightbox(LIGHTBOX_GUID_PREVIEW);DIGIOH_LIGHTBOX_ANALYTICS.VARS.click_jquery_selector["#preview_click_selector"]=false;});}else if(typeof IS_PREVIEW_HOVER!=="undefined"&&IS_PREVIEW_HOVER){DIGIOH_LIGHTBOX_ANALYTICS.VARS.hover_jquery_selector["#preview_hover_selector"]=false;JQUERY_DIGIOH("#preview_hover_selector").mouseenter(function(){DIGIOH_LIGHTBOX_ANALYTICS.VARS.hover_jquery_selector["#preview_hover_selector"]=true;loadLightbox(LIGHTBOX_GUID_PREVIEW);}).mouseleave);}else if(typeof IS_PREVIEW_SCROLL!=="undefined"&&IS_PREVIEW_SCROLL){DIGIOH_LIGHTBOX_ANALYTICS.VARS.scroll_pixels_prev=0;DIGIOH_LIGHTBOX_ANALYTICS.VARS.scroll_pixels=0;jqWin.scroll(function(){DIGIOH_LIGHTBOX_ANALYTICS.VARS.scroll_pixels=Math.round(jqWin.scrollTop());if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.scroll_pixels<DIGIOH_LIGHTBOX_ANALYTICS.VARS.scroll_pixels_prev){DIGIOH_LIGHTBOX_ANALYTICS.VARS.scroll_pixels_prev=DIGIOH_LIGHTBOX_ANALYTICS.VARS.scroll_pixels;}
if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.scroll_pixels>=300+DIGIOH_LIGHTBOX_ANALYTICS.VARS.scroll_pixels_prev){DIGIOH_LIGHTBOX_ANALYTICS.VARS.scroll_pixels_prev=DIGIOH_LIGHTBOX_ANALYTICS.VARS.scroll_pixels;loadLightbox(LIGHTBOX_GUID_PREVIEW);}});}else if(typeof IS_PREVIEW_EXIT!=="undefined"&&IS_PREVIEW_EXIT){var mousex=-1;var mousey=-1;var lastmousex=-1;var lastmousey=-1;var lastmousetime;var mousetravel=0;var directionx='';var directiony='';var pageWidth=jqWin.width();var pageHeight=jqWin.height();var yOffset=jqWin.scrollTop();jqDoc.mousemove);jqDoc.mouseleave(function(){var yOffset=jqWin.scrollTop();if(directiony=='up'&&mousey<yOffset+20&&mousetravel>3){loadLightbox(LIGHTBOX_GUID_PREVIEW);}else if(directiony=='down'&&mousey>pageHeight+yOffset-20&&mousetravel>3){loadLightbox(LIGHTBOX_GUID_PREVIEW);}else if(directionx=='right'&&mousex>pageWidth-20&&mousetravel>3){loadLightbox(LIGHTBOX_GUID_PREVIEW);}else if(directionx=='left'&&mousex<20&&mousetravel>3){loadLightbox(LIGHTBOX_GUID_PREVIEW);}});jqWin.resize(function(){pageWidth=jqWin.width();pageHeight=jqWin.height();yOffset=jqWin.scrollTop();});}else{lbid=LIGHTBOX_GUID_PREVIEW;}
if(EFFECTS[LIGHTBOX_GUID_PREVIEW].hasOwnProperty('iframe')&&EFFECTS[LIGHTBOX_GUID_PREVIEW]['iframe']['use_custom']){if(typeof DigiohPreviewOnScriptLoaded!=="undefined"){DigiohPreviewOnScriptLoaded();}
if(!IS_PREVIEW_EVENT){window.setTimeout(function(){loadLightbox(LIGHTBOX_GUID_PREVIEW);},500);}}
if(typeof DIGIOH_PIXEL_THRESHOLDS==='object')
{lbid=LIGHTBOX_GUID_PREVIEW;var bb='';var ptArr=[];if(DIGIOH_PIXEL_THRESHOLDS.hasOwnProperty(lbid))
{for(var prop in DIGIOH_PIXEL_THRESHOLDS[lbid])
{if(DIGIOH_PIXEL_THRESHOLDS[lbid].hasOwnProperty(prop))
{if(JQUERY_DIGIOH.inArray(parseInt(prop),ptArr)===-1)
{ptArr.push(parseInt(prop));}}}}
if(ptArr.length>0)
{ptArr.sort(function(a,b)
{return a-b;});var breakpoint_bar_position='bottom';if(effects.widget_type=="sidebar"&&effects.sidebar.position.indexOf('bottom-')===0||effects.widget_type=="banner"&&effects.banner.placement==='bottom')
breakpoint_bar_position='top';var currHeight=jqWin.height();var prevWidth=0;for(var i=0;i<ptArr.length;i++)
{bb+="<a href='javascript:window.resizeTo([BP2], "+currHeight+");' style='display:inline-block;cursor:pointer;float:left;width:[BP1]px;height:35px;line-height:35px;text-align:center;border-right:3px solid white;color:white;background-color:black;'>Breakpoint [BP2]px</a>";bb=bb.split('[BP2]').join(ptArr[i].toString()).replace('[BP1]',(ptArr[i]-prevWidth-3).toString());prevWidth=ptArr[i];}
bb+="<a href='javascript:window.resizeTo([BP2], "+currHeight+");' style='display:inline-block;cursor:pointer;float:left;width:[BP1]px;height:35px;line-height:35px;text-align:center;color:white;background-color:black;'>Main &rarr;</a>";bb=bb.split('[BP2]').join((prevWidth+300).toString()).replace('[BP1]',(280).toString());JQUERY_DIGIOH("body").css('overflow-x','hidden').prepend("<div id='breakpoint_bar' style='min-width:"+(prevWidth+300)+"px;z-index:9998010;position:fixed;"+breakpoint_bar_position+":0px;background-color:black;width:100%;height:35px;'>"+bb+"<div style='float:none;clear:both;'></div></div>");}}}
logger("STOPWATCH (initConditions finished) - "+Math.ceil((new Date().getTime()-STOPWATCH)/1000));}
catch(e){logError(e,"initConditions");}}
function buildConditionSelectorsToBoxesMap(){try{var rule_prop='';var rule_operator='';var rule_val='';var rule_set=[];var lbid='';var event_type='';CONDITION_SELECTOR_BOXES_MAP['click']={};CONDITION_SELECTOR_BOXES_MAP['hover']={};CONDITION_SELECTOR_BOXES_MAP['exists']={};for(var i=0;i<DIGIOH_LIGHTBOX_CONDITIONS.length;i++){DIGIOH_LIGHTBOX_CONDITIONS[i].has_only_load_rules=false;DIGIOH_LIGHTBOX_CONDITIONS[i].has_exists_rules=false;DIGIOH_LIGHTBOX_CONDITIONS[i].has_click_rules=false;DIGIOH_LIGHTBOX_CONDITIONS[i].has_hover_rules=false;DIGIOH_LIGHTBOX_CONDITIONS[i].has_scroll_rules=false;DIGIOH_LIGHTBOX_CONDITIONS[i].has_exit_rules=false;DIGIOH_LIGHTBOX_CONDITIONS[i].has_time_rules=false;lbid=DIGIOH_LIGHTBOX_CONDITIONS[i].lightbox_guid;var found_non_load_rules_in_or_block=false;var found_or_block_with_only_load_rules=false;var found_non_load_rules_in_or_block_ruleset=false;var found_or_block_with_only_load_rules_ruleset=false;for(var x=0;x<DIGIOH_LIGHTBOX_CONDITIONS[i].conditions.length;x++){found_non_load_rules_in_or_block=false;for(var y=0;y<DIGIOH_LIGHTBOX_CONDITIONS[i].conditions[x].length;y++){rule_prop=DIGIOH_LIGHTBOX_CONDITIONS[i].conditions[x][y]['p'];rule_operator=DIGIOH_LIGHTBOX_CONDITIONS[i].conditions[x][y]['o'];rule_val=DIGIOH_LIGHTBOX_CONDITIONS[i].conditions[x][y]['v'];rule_set=DIGIOH_LIGHTBOX_CONDITIONS[i].conditions[x][y]['s'];event_type='';if(rule_prop=='I_total_time_seconds'||rule_prop=='I_active_time_seconds'||rule_prop=='I_idle_time_seconds'){DIGIOH_LIGHTBOX_CONDITIONS[i].has_time_rules=true;found_non_load_rules_in_or_block=true;if(JQUERY_DIGIOH.inArray(lbid,TIME_BOXES_ARR)==-1){TIME_BOXES_ARR.push(lbid);}}else if(rule_prop=='I_scroll_percent'||rule_prop=='I_scroll_pixels'){DIGIOH_LIGHTBOX_CONDITIONS[i].has_scroll_rules=true;found_non_load_rules_in_or_block=true;if(JQUERY_DIGIOH.inArray(lbid,SCROLL_BOXES_ARR)==-1){SCROLL_BOXES_ARR.push(lbid);}}else if(rule_prop=='E_exit_intent'){DIGIOH_LIGHTBOX_CONDITIONS[i].has_exit_rules=true;found_non_load_rules_in_or_block=true;if(JQUERY_DIGIOH.inArray(lbid,EXIT_BOXES_ARR)==-1){EXIT_BOXES_ARR.push(lbid);}}else if(rule_prop=='C_click_jquery_selector'){DIGIOH_LIGHTBOX_CONDITIONS[i].has_click_rules=true;found_non_load_rules_in_or_block=true;event_type='click';}else if(rule_prop=='C_hover_jquery_selector'){DIGIOH_LIGHTBOX_CONDITIONS[i].has_hover_rules=true;found_non_load_rules_in_or_block=true;event_type='hover';}else if(rule_prop=='C_exists_jquery_selector'){DIGIOH_LIGHTBOX_CONDITIONS[i].has_exists_rules=true;found_non_load_rules_in_or_block=true;event_type='exists';}
else if(rule_prop==='R_ruleset'&&DIGIOH_LIGHTBOX_RULESETS.hasOwnProperty(rule_val)){for(var w=0;w<DIGIOH_LIGHTBOX_RULESETS[rule_val].length;w++){found_non_load_rules_in_or_block_ruleset=false;for(var z=0;z<DIGIOH_LIGHTBOX_RULESETS[rule_val][w].length;z++){var ruleset_prop=DIGIOH_LIGHTBOX_RULESETS[rule_val][w][z]['p'];var ruleset_operator=DIGIOH_LIGHTBOX_RULESETS[rule_val][w][z]['o'];var ruleset_val=DIGIOH_LIGHTBOX_RULESETS[rule_val][w][z]['v'];var ruleset_set=DIGIOH_LIGHTBOX_RULESETS[rule_val][w][z]['s'];if(ruleset_prop=='I_total_time_seconds'||ruleset_prop=='I_active_time_seconds'||ruleset_prop=='I_idle_time_seconds'){DIGIOH_LIGHTBOX_CONDITIONS[i].has_time_rules=true;found_non_load_rules_in_or_block_ruleset=true;if(JQUERY_DIGIOH.inArray(lbid,TIME_BOXES_ARR)==-1){TIME_BOXES_ARR.push(lbid);}}else if(ruleset_prop=='I_scroll_percent'||ruleset_prop=='I_scroll_pixels'){DIGIOH_LIGHTBOX_CONDITIONS[i].has_scroll_rules=true;found_non_load_rules_in_or_block_ruleset=true;if(JQUERY_DIGIOH.inArray(lbid,SCROLL_BOXES_ARR)==-1){SCROLL_BOXES_ARR.push(lbid);}}else if(ruleset_prop=='E_exit_intent'){DIGIOH_LIGHTBOX_CONDITIONS[i].has_exit_rules=true;found_non_load_rules_in_or_block_ruleset=true;if(JQUERY_DIGIOH.inArray(lbid,EXIT_BOXES_ARR)==-1){EXIT_BOXES_ARR.push(lbid);}}else if(ruleset_prop=='C_click_jquery_selector'){DIGIOH_LIGHTBOX_CONDITIONS[i].has_click_rules=true;found_non_load_rules_in_or_block_ruleset=true;event_type='click';}else if(ruleset_prop=='C_hover_jquery_selector'){DIGIOH_LIGHTBOX_CONDITIONS[i].has_hover_rules=true;found_non_load_rules_in_or_block_ruleset=true;event_type='hover';}else if(ruleset_prop=='C_exists_jquery_selector'){DIGIOH_LIGHTBOX_CONDITIONS[i].has_exists_rules=true;found_non_load_rules_in_or_block_ruleset=true;event_type='exists';}
if(event_type!=''&&ruleset_prop.indexOf('C_')===0&&ruleset_prop.indexOf('jquery_selector')>0)
{if(ruleset_operator=='in_set'||ruleset_operator=='not_in_set')
{for(var k=0;k<ruleset_set.length;k++)
{if(ruleset_set[k]!='')
{if(!CONDITION_SELECTOR_BOXES_MAP[event_type].hasOwnProperty(ruleset_set[k]))
{CONDITION_SELECTOR_BOXES_MAP[event_type][ruleset_set[k]]=[lbid];}else if(JQUERY_DIGIOH.inArray(lbid,CONDITION_SELECTOR_BOXES_MAP[event_type][ruleset_set[k]])==-1)
{CONDITION_SELECTOR_BOXES_MAP[event_type][ruleset_set[k]].push(lbid);}
if(event_type=='click'&&JQUERY_DIGIOH.inArray(ruleset_set[k],CLICK_SELECTORS)==-1)
{CLICK_SELECTORS.push(ruleset_set[k]);}else if(event_type=='hover'&&JQUERY_DIGIOH.inArray(ruleset_set[k],HOVER_SELECTORS)==-1)
{HOVER_SELECTORS.push(ruleset_set[k]);}else if(event_type=='exists'&&JQUERY_DIGIOH.inArray(ruleset_set[k],EXISTS_SELECTORS)==-1)
{EXISTS_SELECTORS.push(ruleset_set[k]);}}}}
else
{if(ruleset_val!='')
{if(!CONDITION_SELECTOR_BOXES_MAP[event_type].hasOwnProperty(ruleset_val))
{CONDITION_SELECTOR_BOXES_MAP[event_type][ruleset_val]=[lbid];}else if(JQUERY_DIGIOH.inArray(lbid,CONDITION_SELECTOR_BOXES_MAP[event_type][ruleset_val])==-1)
{CONDITION_SELECTOR_BOXES_MAP[event_type][ruleset_val].push(lbid);}
if(event_type=='click'&&JQUERY_DIGIOH.inArray(ruleset_val,CLICK_SELECTORS)==-1)
{CLICK_SELECTORS.push(ruleset_val);}else if(event_type=='hover'&&JQUERY_DIGIOH.inArray(ruleset_val,HOVER_SELECTORS)==-1)
{HOVER_SELECTORS.push(ruleset_val);}else if(event_type=='exists'&&JQUERY_DIGIOH.inArray(ruleset_val,EXISTS_SELECTORS)==-1)
{EXISTS_SELECTORS.push(ruleset_val);}}}}}
if(!found_non_load_rules_in_or_block_ruleset){found_or_block_with_only_load_rules_ruleset=true;}}}
else{found_or_block_with_only_load_rules_ruleset=true;}
if(!found_non_load_rules_in_or_block&&found_or_block_with_only_load_rules_ruleset){found_or_block_with_only_load_rules=true;}
if(event_type!=''&&rule_prop!=='R_ruleset')
{if(rule_operator=='in_set'||rule_operator=='not_in_set')
{for(var k=0;k<rule_set.length;k++)
{if(rule_set[k]!='')
{if(!CONDITION_SELECTOR_BOXES_MAP[event_type].hasOwnProperty(rule_set[k]))
{CONDITION_SELECTOR_BOXES_MAP[event_type][rule_set[k]]=[lbid];}else if(JQUERY_DIGIOH.inArray(lbid,CONDITION_SELECTOR_BOXES_MAP[event_type][rule_set[k]])==-1)
{CONDITION_SELECTOR_BOXES_MAP[event_type][rule_set[k]].push(lbid);}
if(event_type=='click'&&JQUERY_DIGIOH.inArray(rule_set[k],CLICK_SELECTORS)==-1)
{CLICK_SELECTORS.push(rule_set[k]);}else if(event_type=='hover'&&JQUERY_DIGIOH.inArray(rule_set[k],HOVER_SELECTORS)==-1)
{HOVER_SELECTORS.push(rule_set[k]);}else if(event_type=='exists'&&JQUERY_DIGIOH.inArray(rule_set[k],EXISTS_SELECTORS)==-1)
{EXISTS_SELECTORS.push(rule_set[k]);}}}}
else
{if(rule_val!='')
{if(!CONDITION_SELECTOR_BOXES_MAP[event_type].hasOwnProperty(rule_val))
{CONDITION_SELECTOR_BOXES_MAP[event_type][rule_val]=[lbid];}else if(JQUERY_DIGIOH.inArray(lbid,CONDITION_SELECTOR_BOXES_MAP[event_type][rule_val])==-1)
{CONDITION_SELECTOR_BOXES_MAP[event_type][rule_val].push(lbid);}
if(event_type=='click'&&JQUERY_DIGIOH.inArray(rule_val,CLICK_SELECTORS)==-1)
{CLICK_SELECTORS.push(rule_val);}else if(event_type=='hover'&&JQUERY_DIGIOH.inArray(rule_val,HOVER_SELECTORS)==-1)
{HOVER_SELECTORS.push(rule_val);}else if(event_type=='exists'&&JQUERY_DIGIOH.inArray(rule_val,EXISTS_SELECTORS)==-1)
{EXISTS_SELECTORS.push(rule_val);}}}}
else if(rule_prop==='R_ruleset')
{}}}
DIGIOH_LIGHTBOX_CONDITIONS[i].has_only_load_rules=!(DIGIOH_LIGHTBOX_CONDITIONS[i].has_click_rules||DIGIOH_LIGHTBOX_CONDITIONS[i].has_hover_rules||DIGIOH_LIGHTBOX_CONDITIONS[i].has_scroll_rules||DIGIOH_LIGHTBOX_CONDITIONS[i].has_exit_rules||DIGIOH_LIGHTBOX_CONDITIONS[i].has_time_rules);DIGIOH_LIGHTBOX_CONDITIONS[i].has_or_block_with_only_load_rules=found_or_block_with_only_load_rules;}}
catch(e){logError(e,"buildConditionSelectorsToBoxesMap");}}
function doConditionsUseGeo(){try{var rule_prop='';for(var i=0;i<DIGIOH_LIGHTBOX_CONDITIONS.length;i++){for(var x=0;x<DIGIOH_LIGHTBOX_CONDITIONS[i].conditions.length;x++){for(var y=0;y<DIGIOH_LIGHTBOX_CONDITIONS[i].conditions[x].length;y++){rule_prop=DIGIOH_LIGHTBOX_CONDITIONS[i].conditions[x][y]['p'];if(rule_prop=='E_continent'||rule_prop=='E_country'||rule_prop=='E_state'||rule_prop=='S_city'||rule_prop=='S_ip_address'||rule_prop=='S_zipcode'||rule_prop=='I_latitude'||rule_prop=='I_longitude'||rule_prop=='S_metro_code'||rule_prop=='S_area_code'){return true;}}}}}
catch(e){logError(e,"doConditionsUseGeo");}
return false;}
var initABSplitTests=function(){try{if(typeof DIGIOH_SPLIT_TESTS_ARR==='undefined'){return false;}
var utcNowMillisJs=new Date().getTime();var foundMatch=false;var lpMax=1000000;for(var i=0;i<DIGIOH_SPLIT_TESTS_ARR.length;i++){var tp=getRandomInt(1,101);var lp=getRandomInt(1,lpMax+1);var dist=0;var test_type='multivariate';var skip=false;if(DIGIOH_API&&DIGIOH_API.hasOwnProperty('RANDOM_GLOBAL')&&DIGIOH_API.RANDOM_GLOBAL){lp=DIGIOH_API.RANDOM_GLOBAL;}
if(!DIGIOH_STORAGE.data.hasOwnProperty("__bxabtest"))
DIGIOH_STORAGE.data["__bxabtest"]={};if(!DIGIOH_STORAGE.data["__bxabtest"].hasOwnProperty(DIGIOH_SPLIT_TESTS_ARR[i].split_short_id))
DIGIOH_STORAGE.data["__bxabtest"][DIGIOH_SPLIT_TESTS_ARR[i].split_short_id]={};if(!DIGIOH_STORAGE.data["__bxabtest"][DIGIOH_SPLIT_TESTS_ARR[i].split_short_id].hasOwnProperty('end_date'))
DIGIOH_STORAGE.data["__bxabtest"][DIGIOH_SPLIT_TESTS_ARR[i].split_short_id]={"tp":tp,"lp":lp,"end_date":DIGIOH_SPLIT_TESTS_ARR[i].end_date};if(DIGIOH_SPLIT_TESTS_ARR[i].end_date<=utcNowMillisJs){delete DIGIOH_STORAGE.data["__bxabtest"][DIGIOH_SPLIT_TESTS_ARR[i].split_short_id];}else if(typeof DIGIOH_VENDOR_SHORT_ID!=='undefined'&&DIGIOH_VENDOR_SHORT_ID&&DIGIOH_VENDOR_SHORT_ID.toString()!='1'){tp=DIGIOH_STORAGE.data["__bxabtest"][DIGIOH_SPLIT_TESTS_ARR[i].split_short_id].tp;lp=DIGIOH_STORAGE.data["__bxabtest"][DIGIOH_SPLIT_TESTS_ARR[i].split_short_id].lp;if(lp<=100)lpMax=100;}
if(!DIGIOH_SPLIT_TESTS_ARR[i].hasOwnProperty('test_type')||DIGIOH_SPLIT_TESTS_ARR[i].test_type==='multivariate'){test_type='multivariate';}else if(DIGIOH_SPLIT_TESTS_ARR[i].hasOwnProperty('test_type')&&DIGIOH_SPLIT_TESTS_ARR[i].test_type==='box_variation'){test_type='box_variation';}else if(DIGIOH_SPLIT_TESTS_ARR[i].hasOwnProperty('test_type')&&DIGIOH_SPLIT_TESTS_ARR[i].test_type==='variation_variation'){test_type='variation_variation';}else{logger('Skipping AB Test (No Test Type Specified): '+DIGIOH_SPLIT_TESTS_ARR[i].name);skip=true;}
if(!skip&&DIGIOH_SPLIT_TESTS_ARR[i].start_date>=utcNowMillisJs){logger('Skipping AB Test ('+test_type+') (Start Date): '+DIGIOH_SPLIT_TESTS_ARR[i].name);skip=true;}
if(!skip&&DIGIOH_SPLIT_TESTS_ARR[i].end_date<=utcNowMillisJs){logger('Skipping AB Test ('+test_type+') (End Date): '+DIGIOH_SPLIT_TESTS_ARR[i].name);skip=true;}
if(!skip&&DIGIOH_SPLIT_TESTS_ARR[i].traffic_percent<tp){logger('Skipping AB Test ('+test_type+') (Traffic Percent): '+DIGIOH_SPLIT_TESTS_ARR[i].name+', and associated Lightboxes...');if(test_type=='multivariate'){var box_guids=DIGIOH_SPLIT_TESTS_ARR[i].box_guids.split(',');for(var j=0;j<box_guids.length;j++){AB_BOXES_SKIP_MAP[box_guids[j]]=DIGIOH_SPLIT_TESTS_ARR[i].split_guid;logger('Skipping Lightbox : '+box_guids[j]);}}
skip=true;}
if(skip){if(DIGIOH_SPLIT_TESTS_ARR[i].variation_guids.length>0){var var_guids=DIGIOH_SPLIT_TESTS_ARR[i].variation_guids.split(',');for(var j=0;j<var_guids.length;j++){if(DIGIOH_SPLIT_TESTS_ARR[i].primary_variation_guids.indexOf(var_guids[j])===-1){AB_BOXES_SKIP_MAP[var_guids[j]]=DIGIOH_SPLIT_TESTS_ARR[i].split_guid;}}}
continue;}
if(test_type=='multivariate'){var box_guids=DIGIOH_SPLIT_TESTS_ARR[i].box_guids.split(',');var box_weights=(DIGIOH_SPLIT_TESTS_ARR[i].hasOwnProperty('box_weights')&&DIGIOH_SPLIT_TESTS_ARR[i].box_weights.indexOf(',')>0)?DIGIOH_SPLIT_TESTS_ARR[i].box_weights.split(','):[];if(box_guids.length<2){logger('Skipping AB Test (Multivariate) (Box GUIDs length = '+box_guids.length+', min 2): '+DIGIOH_SPLIT_TESTS_ARR[i].name);continue;}
var matchedBoxGuid='';foundMatch=false;dist=lpMax/box_guids.length;var pctCheckedSoFar=0;for(var k=0;k<box_guids.length;k++){var isOutsideRange=true;if(box_weights.length===box_guids.length){dist=lpMax*parseInt(box_weights[k])/100;isOutsideRange=lp<pctCheckedSoFar||lp>(pctCheckedSoFar+dist);pctCheckedSoFar+=dist;}else{isOutsideRange=(k*dist>lp)||((k+1)*dist<lp);}
if(foundMatch){AB_BOXES_SKIP_MAP[box_guids[k]]=DIGIOH_SPLIT_TESTS_ARR[i].split_guid;logger('Skipped Lightbox (Multivariate) ('+box_guids[k]+') for AB Test ('+DIGIOH_SPLIT_TESTS_ARR[i].split_guid+')');}else if(isOutsideRange){AB_BOXES_SKIP_MAP[box_guids[k]]=DIGIOH_SPLIT_TESTS_ARR[i].split_guid;logger('Skipped Lightbox (Multivariate) ('+box_guids[k]+') for AB Test ('+DIGIOH_SPLIT_TESTS_ARR[i].split_guid+')');}else{AB_BOXES_TAKE_MAP[box_guids[k]]=DIGIOH_SPLIT_TESTS_ARR[i].split_guid;foundMatch=true;matchedBoxGuid=box_guids[k];logger('Activated Lightbox (Multivariate) ('+box_guids[k]+') for AB Test ('+DIGIOH_SPLIT_TESTS_ARR[i].split_guid+')');}}
if(!foundMatch){if(AB_BOXES_SKIP_MAP.hasOwnProperty(box_guids[0])){delete AB_BOXES_SKIP_MAP[box_guids[0]];logger('Removed Lightbox (Multivariate) ('+box_guids[0]+') from Skipped Map, for AB Test ('+DIGIOH_SPLIT_TESTS_ARR[i].split_guid+')');}
AB_BOXES_TAKE_MAP[box_guids[0]]=DIGIOH_SPLIT_TESTS_ARR[i].split_guid;matchedBoxGuid=box_guids[0];logger('Defaulting to first Lightbox in AB Test, due to no match of lp: '+lp);logger('Activated Lightbox (Multivariate) ('+box_guids[0]+') for AB Test ('+DIGIOH_SPLIT_TESTS_ARR[i].split_guid+')');}
if(matchedBoxGuid.length>7){for(var var_guid in DIGIOH_VARIATION_TO_BOX_MAP){if(DIGIOH_VARIATION_TO_BOX_MAP.hasOwnProperty(var_guid)&&DIGIOH_VARIATION_TO_BOX_MAP[var_guid]==matchedBoxGuid){AB_BOXES_SKIP_MAP[var_guid]=DIGIOH_SPLIT_TESTS_ARR[i].split_guid;}}}}else if(test_type=='box_variation'){var box_guid=DIGIOH_SPLIT_TESTS_ARR[i].box_guids;var variation_guid=DIGIOH_SPLIT_TESTS_ARR[i].variation_guids;if(box_guid.length<7||box_guid.indexOf(',')>=0){logger('Skipping AB Test (Box vs. Variation) (Box GUID invalid): '+box_guid+', for AB Test: '+DIGIOH_SPLIT_TESTS_ARR[i].name);continue;}
if(variation_guid.length<=1||variation_guid.indexOf(',')>=0){logger('Skipping AB Test (Box vs. Variation) (Variation GUID invalid): '+variation_guid+', for AB Test: '+DIGIOH_SPLIT_TESTS_ARR[i].name);continue;}
if(lp<=(lpMax/2)){AB_BOXES_TAKE_MAP[box_guid]=DIGIOH_SPLIT_TESTS_ARR[i].split_guid;AB_BOXES_SKIP_MAP[variation_guid]=DIGIOH_SPLIT_TESTS_ARR[i].split_guid;logger('Activated Lightbox (Lightbox vs. Variation) ('+box_guid+') for AB Test ('+DIGIOH_SPLIT_TESTS_ARR[i].split_guid+')');logger('Skipping Variation (Lightbox vs. Variation) ('+variation_guid+') for AB Test ('+DIGIOH_SPLIT_TESTS_ARR[i].split_guid+')');}else{AB_BOXES_TAKE_MAP[variation_guid]=DIGIOH_SPLIT_TESTS_ARR[i].split_guid;logger('Activated Variation (Lightbox vs. Variation) ('+variation_guid+') for AB Test ('+DIGIOH_SPLIT_TESTS_ARR[i].split_guid+')');logger('Skipping Lightbox (Lightbox vs. Variation) ('+box_guid+') for AB Test ('+DIGIOH_SPLIT_TESTS_ARR[i].split_guid+')');}}else if(test_type=='variation_variation'){var box_guid=DIGIOH_SPLIT_TESTS_ARR[i].box_guids;var variation_guids=DIGIOH_SPLIT_TESTS_ARR[i].variation_guids.split(',');if(box_guid.length<7||box_guid.indexOf(',')>=0){logger('Skipping AB Test (Variation vs. Variation) (Box GUID invalid): '+box_guid+', for AB Test: '+DIGIOH_SPLIT_TESTS_ARR[i].name);continue;}
if(variation_guids.length!=2){logger('Skipping AB Test (Variation vs. Variation) (Variation GUIDs = '+DIGIOH_SPLIT_TESTS_ARR[i].variation_guids+', must be 2 variations): '+DIGIOH_SPLIT_TESTS_ARR[i].name);continue;}
if(lp<=(lpMax/2)){AB_BOXES_TAKE_MAP[variation_guids[0]]=DIGIOH_SPLIT_TESTS_ARR[i].split_guid;AB_BOXES_SKIP_MAP[variation_guids[1]]=DIGIOH_SPLIT_TESTS_ARR[i].split_guid;logger('initABSplitTests: id = '+DIGIOH_SPLIT_TESTS_ARR[i].split_short_id);logger('initABSplitTests: lp = '+lp);logger('initABSplitTests: chosen variation '+variation_guids[0]);logger('initABSplitTests: skipped variation '+variation_guids[1]);}else{AB_BOXES_TAKE_MAP[variation_guids[1]]=DIGIOH_SPLIT_TESTS_ARR[i].split_guid;AB_BOXES_SKIP_MAP[variation_guids[0]]=DIGIOH_SPLIT_TESTS_ARR[i].split_guid;logger('initABSplitTests: id = '+DIGIOH_SPLIT_TESTS_ARR[i].split_short_id);logger('initABSplitTests: lp = '+lp);logger('initABSplitTests: chosen variation '+variation_guids[1]);logger('initABSplitTests: skipped variation '+variation_guids[0]);}}}
for(var prop in DIGIOH_STORAGE.data["__bxabtest"]){if(DIGIOH_STORAGE.data["__bxabtest"].hasOwnProperty(prop)){foundMatch=false;for(var i=0;i<DIGIOH_SPLIT_TESTS_ARR.length;i++){if(DIGIOH_SPLIT_TESTS_ARR[i].split_short_id==prop){foundMatch=true;}}
if(!foundMatch)
delete DIGIOH_STORAGE.data["__bxabtest"][prop];}}
DIGIOH_STORAGE.set();}
catch(e){logError(e,"initABSplitTests");}
return '';};var checkConditions=function(hook,lbguidToMatch,selector,multi){var multiArr=[];try{var foundMatch=false;if(typeof lbguidToMatch==='undefined'||!lbguidToMatch)
lbguidToMatch='';if(typeof selector==='undefined'||!selector)
selector='';if(typeof multi==='undefined'||multi!==true||!multi)
multi=false;for(var i=0;i<DIGIOH_LIGHTBOX_CONDITIONS.length;i++){if(lbguidToMatch===''&&AB_BOXES_SKIP_MAP.hasOwnProperty(DIGIOH_LIGHTBOX_CONDITIONS[i].lightbox_guid)){continue;}else if(lbguidToMatch===''&&isInlineLightbox(DIGIOH_LIGHTBOX_CONDITIONS[i].lightbox_guid)){continue;}
if(lbguidToMatch!==''){if(DIGIOH_LIGHTBOX_CONDITIONS[i].lightbox_guid===lbguidToMatch){foundMatch=evalConditions(DIGIOH_LIGHTBOX_CONDITIONS[i].conditions,DIGIOH_LIGHTBOX_CONDITIONS[i].lightbox_guid,DIGIOH_LIGHTBOX_ANALYTICS.VARS,false,false,false);if(foundMatch&&!multi){return DIGIOH_LIGHTBOX_CONDITIONS[i].lightbox_guid;}else if(!foundMatch&&!multi){return '';}else if(foundMatch&&multi){return[DIGIOH_LIGHTBOX_CONDITIONS[i].lightbox_guid];}else if(!foundMatch&&multi){return[''];}}}else if(selector!==''&&typeof selector==='string'&&selector.length>1){if(CONDITION_SELECTOR_BOXES_MAP.hasOwnProperty(hook)&&CONDITION_SELECTOR_BOXES_MAP[hook].hasOwnProperty(selector)&&JQUERY_DIGIOH.inArray(DIGIOH_LIGHTBOX_CONDITIONS[i].lightbox_guid,CONDITION_SELECTOR_BOXES_MAP[hook][selector])>-1){foundMatch=evalConditions(DIGIOH_LIGHTBOX_CONDITIONS[i].conditions,DIGIOH_LIGHTBOX_CONDITIONS[i].lightbox_guid,DIGIOH_LIGHTBOX_ANALYTICS.VARS,false,false,false);}}else if(hook==='load'&&(DIGIOH_LIGHTBOX_CONDITIONS[i].has_only_load_rules||DIGIOH_LIGHTBOX_CONDITIONS[i].has_or_block_with_only_load_rules)){foundMatch=evalConditions(DIGIOH_LIGHTBOX_CONDITIONS[i].conditions,DIGIOH_LIGHTBOX_CONDITIONS[i].lightbox_guid,DIGIOH_LIGHTBOX_ANALYTICS.VARS,false,false,false);logger('evalConditions:load:hook='+hook+':'+foundMatch+":"+DIGIOH_LIGHTBOX_CONDITIONS[i].lightbox_guid);}else if(hook==='exists'&&DIGIOH_LIGHTBOX_CONDITIONS[i].has_exists_rules){foundMatch=evalConditions(DIGIOH_LIGHTBOX_CONDITIONS[i].conditions,DIGIOH_LIGHTBOX_CONDITIONS[i].lightbox_guid,DIGIOH_LIGHTBOX_ANALYTICS.VARS,false,false,false);logger('evalConditions:exists:hook='+hook+':'+foundMatch+":"+DIGIOH_LIGHTBOX_CONDITIONS[i].lightbox_guid);}else if(hook==='click'&&DIGIOH_LIGHTBOX_CONDITIONS[i].has_click_rules){foundMatch=evalConditions(DIGIOH_LIGHTBOX_CONDITIONS[i].conditions,DIGIOH_LIGHTBOX_CONDITIONS[i].lightbox_guid,DIGIOH_LIGHTBOX_ANALYTICS.VARS,false,false,false);logger('evalConditions:click:hook='+hook+':'+foundMatch+":"+DIGIOH_LIGHTBOX_CONDITIONS[i].lightbox_guid);}else if(hook==='hover'&&DIGIOH_LIGHTBOX_CONDITIONS[i].has_hover_rules){foundMatch=evalConditions(DIGIOH_LIGHTBOX_CONDITIONS[i].conditions,DIGIOH_LIGHTBOX_CONDITIONS[i].lightbox_guid,DIGIOH_LIGHTBOX_ANALYTICS.VARS,false,false,false);logger('evalConditions:hover:hook='+hook+':'+foundMatch+":"+DIGIOH_LIGHTBOX_CONDITIONS[i].lightbox_guid);}else if(hook==='scroll'&&DIGIOH_LIGHTBOX_CONDITIONS[i].has_scroll_rules){foundMatch=evalConditions(DIGIOH_LIGHTBOX_CONDITIONS[i].conditions,DIGIOH_LIGHTBOX_CONDITIONS[i].lightbox_guid,DIGIOH_LIGHTBOX_ANALYTICS.VARS,false,false,false);logger('evalConditions:scroll:hook='+hook+':'+foundMatch+":"+DIGIOH_LIGHTBOX_CONDITIONS[i].lightbox_guid);}else if(hook==='exit'&&DIGIOH_LIGHTBOX_CONDITIONS[i].has_exit_rules){foundMatch=evalConditions(DIGIOH_LIGHTBOX_CONDITIONS[i].conditions,DIGIOH_LIGHTBOX_CONDITIONS[i].lightbox_guid,DIGIOH_LIGHTBOX_ANALYTICS.VARS,false,false,false);logger('evalConditions:exit:hook='+hook+':'+foundMatch+":"+DIGIOH_LIGHTBOX_CONDITIONS[i].lightbox_guid);}else if(hook==='time'&&DIGIOH_LIGHTBOX_CONDITIONS[i].has_time_rules){foundMatch=evalConditions(DIGIOH_LIGHTBOX_CONDITIONS[i].conditions,DIGIOH_LIGHTBOX_CONDITIONS[i].lightbox_guid,DIGIOH_LIGHTBOX_ANALYTICS.VARS,false,false,false);logger('evalConditions:time:hook='+hook+":"+DIGIOH_LIGHTBOX_CONDITIONS[i].lightbox_guid);}
if(foundMatch&&!multi){return DIGIOH_LIGHTBOX_CONDITIONS[i].lightbox_guid;}else if(foundMatch&&multi){multiArr.push(DIGIOH_LIGHTBOX_CONDITIONS[i].lightbox_guid);}
foundMatch=false;}}
catch(e){logError(e,"checkConditions");}
if(multi){if(multiArr.length===0)return[''];else return multiArr;}else{return '';}};function evalConditions(conditions,lbid,vars,eval_preload_teaser,is_follow_me_teaser,is_ruleset){if(typeof AB_BOXES_SKIP_MAP!=='undefined'&&AB_BOXES_SKIP_MAP.hasOwnProperty(lbid)){return false;}
if(typeof is_follow_me_teaser==='undefined'||!is_follow_me_teaser){is_follow_me_teaser=false;}
var short_id=lbid;var or_blocks=[];var or_block_json=[];var json_rule={};try{var skip_device_rules=false;for(var x=0;x<conditions.length;x++){or_blocks[x]=true;or_block_json[x]=[];for(var y=0;y<conditions[x].length;y++){json_rule={};if(!conditions[x][y].hasOwnProperty('k')){conditions[x][y]['k']='';}
if(conditions[x][y]['p']==='R_ruleset'&&conditions[x][y]['v']){if(DIGIOH_LIGHTBOX_RULESETS.hasOwnProperty(conditions[x][y]['v'])){if(conditions[x][y]['o']==='does_not_equal'){json_rule.rule_result=!evalConditions(DIGIOH_LIGHTBOX_RULESETS[conditions[x][y]['v']],lbid,vars,eval_preload_teaser,is_follow_me_teaser,true);}else{json_rule.rule_result=evalConditions(DIGIOH_LIGHTBOX_RULESETS[conditions[x][y]['v']],lbid,vars,eval_preload_teaser,is_follow_me_teaser,true);}
json_rule.rule_message='Ruleset ID: '+conditions[x][y]['v'];json_rule.rule_error=false;json_rule.rule_func='evalConditions for Ruleset';}else{json_rule.rule_result=false;json_rule.rule_message='Ruleset ID: '+conditions[x][y]['v']+' was not found in RULESETS.  Check to make sure that Ruleset ID '+conditions[x][y]['v']+' has valid Conditions within it.';json_rule.rule_error=true;json_rule.rule_func='evalConditions for Ruleset (skipped)';}
json_rule.rule_prop='R_ruleset';json_rule.rule_operator='';json_rule.rule_val='';json_rule.rule_set=[];json_rule.rule_visual='';json_rule.is_preload_teaser_eval=eval_preload_teaser;json_rule.is_follow_me_teaser=is_follow_me_teaser;}
else{json_rule=evalRule(conditions[x][y]['p'],conditions[x][y]['o'],conditions[x][y]['s'],conditions[x][y]['v'],conditions[x][y]['sd'],conditions[x][y]['ed'],conditions[x][y]['k'],lbid,vars,eval_preload_teaser,is_follow_me_teaser,skip_device_rules);}
or_block_json[x].push(json_rule);if(!json_rule.rule_result){or_blocks[x]=false;break;}}
if(or_blocks[x]===true){if(!is_ruleset){if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(lbid)){short_id=DIGIOH_LIGHTBOX_IDS[lbid]+'';}
if(eval_preload_teaser){CONDITIONS_OUTPUT[short_id]='---------------------------------'+'\n';CONDITIONS_OUTPUT[short_id]+='Teaser Preload Conditions Succeeded for Lightbox '+short_id+'\n';CONDITIONS_OUTPUT[short_id]+='---------------------------------'+'\n';}else{CONDITIONS_OUTPUT[short_id]='---------------------------------'+'\n';CONDITIONS_OUTPUT[short_id]+='Conditions Succeeded for Lightbox '+short_id+'\n';CONDITIONS_OUTPUT[short_id]+=JSON.stringify(or_block_json,null,2)+'\n';CONDITIONS_OUTPUT[short_id]+='---------------------------------'+'\n';}}
return true;}}}
catch(e){logError(e,"evalConditions");}
if(!is_ruleset){if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(lbid)){short_id=DIGIOH_LIGHTBOX_IDS[lbid]+'';}
if(eval_preload_teaser){CONDITIONS_OUTPUT[short_id]='---------------------------------'+'\n';CONDITIONS_OUTPUT[short_id]+='Teaser Preload Conditions Failed for Lightbox '+short_id+'\n';CONDITIONS_OUTPUT[short_id]+='---------------------------------'+'\n';}else{CONDITIONS_OUTPUT[short_id]='---------------------------------'+'\n';CONDITIONS_OUTPUT[short_id]+='Conditions Failed for Lightbox '+short_id+'\n';CONDITIONS_OUTPUT[short_id]+=JSON.stringify(or_block_json,null,2)+'\n';CONDITIONS_OUTPUT[short_id]+='---------------------------------'+'\n';}}
return false;}
var printConditionsOutput=function(short_id){try{if(typeof console==='undefined'){return;}
if(typeof short_id==='number'){short_id=short_id+'';}
if(typeof short_id==='string'&&short_id.length>30&&DIGIOH_LIGHTBOX_IDS.hasOwnProperty(short_id)){short_id=DIGIOH_LIGHTBOX_IDS[short_id]+'';}
if(typeof short_id==='string'&&CONDITIONS_OUTPUT.hasOwnProperty(short_id)){console.log('printConditionsOutput: '+short_id+'\n\n\n');console.log(CONDITIONS_OUTPUT[short_id]);}
else if(typeof short_id==='string'&&!CONDITIONS_OUTPUT.hasOwnProperty(short_id)){console.log('printConditionsOutput: '+short_id);console.log('CONDITIONS not yet evaluated for Lightbox '+short_id);}
else{console.log('printConditionsOutput: ALL BOXES'+'\n\n\n');for(var prop in CONDITIONS_OUTPUT){if(CONDITIONS_OUTPUT.hasOwnProperty(prop)){console.log(CONDITIONS_OUTPUT[prop]+'\n\n\n');}}}
if(typeof short_id!=='string'||short_id.length<4){for(var z=0;z<DIGIOH_LIGHTBOX_CONDITIONS.length;z++){if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(DIGIOH_LIGHTBOX_CONDITIONS[z].lightbox_guid)){var sidCond=DIGIOH_LIGHTBOX_IDS[DIGIOH_LIGHTBOX_CONDITIONS[z].lightbox_guid];var foundMatch=false;for(var sid in CONDITIONS_OUTPUT){if(CONDITIONS_OUTPUT.hasOwnProperty(sid)&&sid===sidCond){foundMatch=true;}}
if(!foundMatch){console.log('---------------------------------');if(typeof AB_BOXES_SKIP_MAP!=='undefined'&&AB_BOXES_SKIP_MAP.hasOwnProperty(DIGIOH_LIGHTBOX_CONDITIONS[z].lightbox_guid)){console.log('CONDITIONS not evaluated for Lightbox '+sidCond+'.  Skipped Lightbox because it is in a Split Test and was not chosen '+sidCond);}else{console.log('CONDITIONS not evaluated for Lightbox '+sidCond);}
console.log('---------------------------------'+'\n\n\n');}}}}}
catch(e){logError(e,"printConditionsOutput");}};function evalRule(rule_prop,rule_operator,rule_set,rule_val,rule_start_date,rule_end_date,key_name,lbid,vars,eval_preload_teaser,is_follow_me_teaser,skip_device_rules){if(typeof is_follow_me_teaser==='undefined'||!is_follow_me_teaser){is_follow_me_teaser=false;}
var res={};res.rule_func='evalRule';res.rule_prop=rule_prop;res.rule_operator=rule_operator;res.rule_val=rule_val;res.rule_set=rule_set;res.rule_visual='';res.rule_message='';res.rule_error=false;res.rule_result=false;res.is_preload_teaser_eval=eval_preload_teaser;res.is_follow_me_teaser=is_follow_me_teaser;if(eval_preload_teaser){if(is_follow_me_teaser){if(rule_prop=='I_total_time_seconds'||rule_prop=='I_active_time_seconds'||rule_prop=='I_idle_time_seconds'||rule_prop=='I_scroll_percent'||rule_prop=='I_scroll_pixels'||rule_prop=='C_click_jquery_selector'||rule_prop=='C_hover_jquery_selector'||rule_prop=='E_exit_intent'||rule_prop=='E_visitor_activity_visitor'||rule_prop=='E_visitor_activity_session'||rule_prop=='E_visitor_activity_pageview'){res.rule_message='teaser follow me is automatically evaluated as true for the following rule event types:  time, scroll, click, hover, exit, max displays per pageview, max displays per session, max displays per visitor';res.rule_visual=res.rule_message;res.rule_result=true;return res;}}
if(!is_follow_me_teaser){if(rule_prop=='I_total_time_seconds'||rule_prop=='I_active_time_seconds'||rule_prop=='I_idle_time_seconds'||rule_prop=='I_scroll_percent'||rule_prop=='I_scroll_pixels'||rule_prop=='C_click_jquery_selector'||rule_prop=='C_hover_jquery_selector'||rule_prop=='E_exit_intent'){res.rule_message='teaser preloading is automatically evaluated as true for the following rule event types:  time, scroll, click, hover, exit';res.rule_visual=res.rule_message;res.rule_result=true;return res;}}}
if(rule_prop=='E_lightbox_activity'){var boxShortId='';if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(lbid)&&DIGIOH_LIGHTBOX_IDS[lbid]){boxShortId=DIGIOH_LIGHTBOX_IDS[lbid];}
if(!vars.lightbox_events.hasOwnProperty(boxShortId)){res.rule_message='no events found for this lightbox, so continue displaying';res.rule_visual=res.rule_message;res.rule_result=true;return res;}else if(rule_operator=='equals'){var rv='';if(rule_val=='view')rv='v';if(rule_val=='submit')rv='s';if(rule_val=='redirect')rv='r';if(rule_val=='download')rv='d';if(rule_val=='close')rv='c';if(!vars.lightbox_events[boxShortId].hasOwnProperty(rv)||vars.lightbox_events[boxShortId][rv]['c']==0){res.rule_message='no '+rule_val+' events found for this lightbox, so continue displaying';res.rule_visual=res.rule_message;res.rule_result=true;return res;}
else if(eval_preload_teaser&&is_follow_me_teaser&&rule_val=='close'){res.rule_message='continue displaying follow me teaser, even though lightbox close events were found';res.rule_visual=res.rule_message;res.rule_result=true;return res;}
else{res.rule_message=vars.lightbox_events[boxShortId][rv]['c']+' '+rule_val+' events found for this lightbox, so stop displaying';res.rule_visual=res.rule_message;res.rule_result=false;return res;}}else if(rule_operator=='in_set'){for(var x=0;x<rule_set.length;x++){var rv='';if(rule_set[x]=='view')rv='v';if(rule_set[x]=='submit')rv='s';if(rule_set[x]=='redirect')rv='r';if(rule_set[x]=='download')rv='d';if(rule_set[x]=='close')rv='c';if(vars.lightbox_events[boxShortId].hasOwnProperty(rv)&&vars.lightbox_events[boxShortId][rv]['c']>0){if(eval_preload_teaser&&is_follow_me_teaser){if(rule_set[x]!='close'){res.rule_message=vars.lightbox_events[boxShortId][rv]['c']+' '+rule_set[x]+' events found for this lightbox, so stop displaying follow me teaser';res.rule_visual=res.rule_message;res.rule_result=false;return res;}}
else{res.rule_message=vars.lightbox_events[boxShortId][rv]['c']+' '+rule_set[x]+' events found for this lightbox, so stop displaying';res.rule_visual=res.rule_message;res.rule_result=false;return res;}}}
res.rule_message='no matching events found for this lightbox, so continue displaying';res.rule_visual=res.rule_message;res.rule_result=true;return res;}else{res.rule_message='invalid operator: '+rule_operator;res.rule_error=true;res.result=false;return res;}}
if(rule_prop=='D_date_range'){var curr_date=new Date();var compare_date=(curr_date.getMonth()+1)+'/'+curr_date.getDate()+'/'+curr_date.getFullYear();return evalRuleDate(rule_prop,rule_operator,rule_start_date,rule_end_date,compare_date);}
if(rule_prop=='D_date_of_visit'){var compare_date=(vars.date_of_visit.getMonth()+1)+'/'+vars.date_of_visit.getDate()+'/'+vars.date_of_visit.getFullYear();return evalRuleDate(rule_prop,rule_operator,rule_start_date,rule_end_date,compare_date);}
if(rule_prop=='E_visitor_activity_visitor'){var boxShortId='';if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(lbid)&&DIGIOH_LIGHTBOX_IDS[lbid]){boxShortId=DIGIOH_LIGHTBOX_IDS[lbid];}
if(!vars.lightbox_events.hasOwnProperty(boxShortId)){res.rule_message='no displays found for this lightbox, so continue displaying';res.rule_visual=res.rule_message;res.rule_result=true;return res;}else if(rule_operator=='equals'){if(!vars.lightbox_events[boxShortId].hasOwnProperty('v')){res.rule_message='no displays found for this lightbox, so continue displaying';res.rule_visual=res.rule_message;res.rule_result=true;return res;}else if(vars.lightbox_events[boxShortId]['v']['c']<parseInt(rule_val)){res.rule_message=vars.lightbox_events[boxShortId]['v']['c']+' displays found for this lightbox, so continue displaying (max of '+rule_val+' displays per visitor)';res.rule_visual=res.rule_message;res.rule_result=true;return res;}else{res.rule_message=vars.lightbox_events[boxShortId]['v']['c']+' displays found for this lightbox, so stop displaying (max of '+rule_val+' displays allowed per visitor)';res.rule_visual=res.rule_message;res.rule_result=false;return res;}}else{res.rule_message='invalid operator: '+rule_operator;res.rule_error=true;res.result=false;return res;}}
if(rule_prop=='E_visitor_activity_session'){var boxShortId='';if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(lbid)&&DIGIOH_LIGHTBOX_IDS[lbid]){boxShortId=DIGIOH_LIGHTBOX_IDS[lbid];}
if(!vars.lightbox_events.hasOwnProperty(boxShortId)){res.rule_message='no session displays found for this lightbox, so continue displaying';res.rule_visual=res.rule_message;res.rule_result=true;return res;}else if(rule_operator=='equals'){if(!vars.lightbox_events[boxShortId].hasOwnProperty('v')||!vars.lightbox_events[boxShortId]['v'].hasOwnProperty('t')||vars.lightbox_events[boxShortId]['v']['t'].length==0){res.rule_message='no session displays found for this lightbox, so continue displaying';res.rule_visual=res.rule_message;res.rule_result=true;return res;}
var session_display_cnt=0;for(var x=0;x<vars.lightbox_events[boxShortId]['v']['t'].length;x++){if(vars.lightbox_events[boxShortId]['v']['t'][x]>=DIGIOH_LIGHTBOX_ANALYTICS.SessionStart){session_display_cnt++;}}
if(session_display_cnt<parseInt(rule_val)){res.rule_message=session_display_cnt+' session displays found for this lightbox, so continue displaying (max of '+rule_val+' displays allowed per session)';res.rule_visual=res.rule_message;res.rule_result=true;return res;}else{res.rule_message=session_display_cnt+' session displays found for this lightbox, so stop displaying (max of '+rule_val+' displays allowed per session)';res.rule_visual=res.rule_message;res.rule_result=false;return res;}}else{res.rule_message='invalid operator: '+rule_operator;res.rule_error=true;res.result=false;return res;}}
if(rule_prop=='E_visitor_activity_pageview'){var boxShortId='';if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(lbid)&&DIGIOH_LIGHTBOX_IDS[lbid]){boxShortId=DIGIOH_LIGHTBOX_IDS[lbid];}
if(!vars.lightbox_events.hasOwnProperty(boxShortId)){res.rule_message='no current page displays found for this lightbox, so continue displaying';res.rule_visual=res.rule_message;res.rule_result=true;return res;}else if(rule_operator=='equals'){if(!vars.lightbox_events[boxShortId].hasOwnProperty('v')||!vars.lightbox_events[boxShortId]['v'].hasOwnProperty('t')||vars.lightbox_events[boxShortId]['v']['t'].length==0){res.rule_message='no current page displays found for this lightbox, so continue displaying';res.rule_visual=res.rule_message;res.rule_result=true;return res;}
var pageview_display_cnt=0;for(var x=0;x<vars.lightbox_events[boxShortId]['v']['t'].length;x++){if(vars.lightbox_events[boxShortId]['v']['t'][x]>=DIGIOH_LIGHTBOX_ANALYTICS.PageviewStart){pageview_display_cnt++;}}
if(pageview_display_cnt<parseInt(rule_val)){res.rule_message=pageview_display_cnt+' session displays found for this lightbox, so continue displaying (max of '+rule_val+' displays allowed per pageview)';res.rule_visual=res.rule_message;res.rule_result=true;return res;}else{res.rule_message=pageview_display_cnt+' session displays found for this lightbox, so stop displaying (max of '+rule_val+' displays allowed per pageview)';res.rule_visual=res.rule_message;res.rule_result=false;return res;}}else{res.rule_message='invalid operator: '+rule_operator;res.rule_error=true;res.result=false;return res;}}
if(rule_prop=='I_page_visits'){return evalRuleInt(rule_prop,rule_operator,rule_set,rule_val,vars.page_visits);}
if(rule_prop=='I_page_visits_session'){return evalRuleInt(rule_prop,rule_operator,rule_set,rule_val,vars.page_visits_session);}
if(rule_prop=='I_past_visits'){return evalRuleInt(rule_prop,rule_operator,rule_set,rule_val,vars.past_visits);}
if(rule_prop=='I_days_since_last_view'){var boxShortId='';if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(lbid)&&DIGIOH_LIGHTBOX_IDS[lbid]){boxShortId=DIGIOH_LIGHTBOX_IDS[lbid];}
if(!vars.lightbox_activity.hasOwnProperty(boxShortId)||vars.lightbox_activity[boxShortId]["Days since last view"]==-1){res.rule_message='no displays found for this lightbox, so continue displaying';res.rule_visual=res.rule_message;res.rule_result=true;return res;}
return evalRuleInt(rule_prop,rule_operator,rule_set,rule_val,vars.lightbox_activity[boxShortId]["Days since last view"]);}
if(rule_prop=='I_total_time_seconds'){return evalRuleInt(rule_prop,rule_operator,rule_set,rule_val,vars.total_time_seconds);}
if(rule_prop=='I_active_time_seconds'){return evalRuleInt(rule_prop,rule_operator,rule_set,rule_val,vars.active_time_seconds);}
if(rule_prop=='I_idle_time_seconds'){return evalRuleInt(rule_prop,rule_operator,rule_set,rule_val,vars.idle_time_seconds);}
if(rule_prop=='I_scroll_percent'){return evalRuleInt(rule_prop,rule_operator,rule_set,rule_val,vars.scroll_percent);}
if(rule_prop=='I_scroll_pixels'){return evalRuleInt(rule_prop,rule_operator,rule_set,rule_val,vars.scroll_pixels);}
if(rule_prop=='I_browser_version'){if(isNaN(vars.browser_version)){res.rule_message='browser version is Not a Number (NaN), so evaluate to false';res.rule_visual=res.rule_message;res.rule_result=false;return res;}
var browser_version=Math.floor(parseFloat(vars.browser_version));return evalRuleInt(rule_prop,rule_operator,rule_set,rule_val,browser_version);}
if(rule_prop=='I_latitude'){if(isNaN(vars.latitude)){res.rule_message='latitude is Not a Number (NaN), so evaluate to false';res.rule_visual=res.rule_message;res.rule_result=false;return res;}
var latitude=Math.floor(parseFloat(vars.latitude));return evalRuleInt(rule_prop,rule_operator,rule_set,rule_val,latitude);}
if(rule_prop=='I_longitude'){if(isNaN(vars.longitude)){res.rule_message='longitude is Not a Number (NaN), so evaluate to false';res.rule_visual=res.rule_message;res.rule_result=false;return res;}
var longitude=Math.floor(parseFloat(vars.longitude));return evalRuleInt(rule_prop,rule_operator,rule_set,rule_val,longitude);}
if(rule_prop=='E_web_source'){return evalRuleEnum(rule_prop,rule_operator,rule_set,rule_val,vars.web_source);}
if(rule_prop=='E_segments'){return evalRuleEnumSegments(rule_prop,rule_operator,rule_set,rule_val,vars.segments);}
if(rule_prop=='E_search_engine'){return evalRuleEnum(rule_prop,rule_operator,rule_set,rule_val,vars.search_engine);}
if(rule_prop=='E_device'){return evalRuleDeviceEnum(rule_prop,rule_operator,rule_set,rule_val,vars.device);}
if(rule_prop=='E_browser_type'){return evalRuleEnum(rule_prop,rule_operator,rule_set,rule_val,vars.browser_type);}
if(rule_prop=='E_operating_system'){return evalRuleEnum(rule_prop,rule_operator,rule_set,rule_val,vars.operating_system);}
if(rule_prop=='E_language')
{return evalRuleEnumLanguage(rule_prop,rule_operator,rule_set,rule_val);}
if(rule_prop=='E_country'){return evalRuleEnum(rule_prop,rule_operator,rule_set,rule_val,vars.country);}
if(rule_prop=='E_state'){return evalRuleEnum(rule_prop,rule_operator,rule_set,rule_val,vars.state);}
if(rule_prop=='E_continent'){return evalRuleEnum(rule_prop,rule_operator,rule_set,rule_val,vars.continent);}
if(rule_prop=='S_lytics'){var lytics_elems=[];try{var lytics_cookie=DIGIOH_COOKIE.get('ly_segs',true);if(lytics_cookie!==null&&typeof lytics_cookie==='string'&&lytics_cookie.length>0){lytics_cookie=decodeURIComponent(lytics_cookie);var lytics_json=JSON.parse(lytics_cookie);for(var seg in lytics_json){lytics_elems.push(lytics_json[seg]);}}else{}}
catch(e){console.log('S_lytics - error parsing cookie');}
return evalRuleStringMultiVal(rule_prop,rule_operator,rule_set,rule_val,lytics_elems);}
if(rule_prop=='S_current_page_url'){return evalRuleUrl(rule_prop,rule_operator,rule_set,rule_val,vars.current_page_url);}
if(rule_prop=='S_referring_website_url'){return evalRuleUrl(rule_prop,rule_operator,rule_set,rule_val,vars.referring_website_url);}
if(rule_prop=='S_landing_page'){return evalRuleUrl(rule_prop,rule_operator,rule_set,rule_val,vars.landing_page);}
if(rule_prop=='S_pages_navigated'){return evalRulePagesNavigated(rule_prop,rule_operator,rule_set,rule_val,vars.pages_navigated);}
if(rule_prop=='S_current_page_url_host')
{return evalRuleString(rule_prop,rule_operator,rule_set,rule_val,window.parent.location.host);}
if(rule_prop=='S_current_page_url_path')
{return evalRuleString(rule_prop,rule_operator,rule_set,rule_val,window.parent.location.pathname);}
if(rule_prop=='S_current_page_url_protocol')
{return evalRuleString(rule_prop,rule_operator,rule_set,rule_val,window.parent.location.protocol);}
if(rule_prop=='S_current_page_url_query')
{return evalRuleString(rule_prop,rule_operator,rule_set,rule_val,window.parent.location.search);}
if(rule_prop=='S_current_page_url_hash')
{return evalRuleString(rule_prop,rule_operator,rule_set,rule_val,window.parent.location.hash);}
if(rule_prop=='S_city'){return evalRuleString(rule_prop,rule_operator,rule_set,rule_val,vars.city);}
if(rule_prop=='S_ip_address'){return evalRuleString(rule_prop,rule_operator,rule_set,rule_val,vars.ip_address);}
if(rule_prop=='S_zipcode'){return evalRuleString(rule_prop,rule_operator,rule_set,rule_val,vars.zipcode);}
if(rule_prop=='S_metro_code'){return evalRuleString(rule_prop,rule_operator,rule_set,rule_val,vars.metro_code);}
if(rule_prop=='S_area_code'){return evalRuleString(rule_prop,rule_operator,rule_set,rule_val,vars.area_code);}
if(rule_prop=='S_utm_campaign_name'){return evalRuleString(rule_prop,rule_operator,rule_set,rule_val,vars.utm_campaign_name);}
if(rule_prop=='S_utm_campaign_source'){return evalRuleString(rule_prop,rule_operator,rule_set,rule_val,vars.utm_campaign_source);}
if(rule_prop=='S_utm_campaign_content'){return evalRuleString(rule_prop,rule_operator,rule_set,rule_val,vars.utm_campaign_content);}
if(rule_prop=='S_utm_campaign_term'){return evalRuleString(rule_prop,rule_operator,rule_set,rule_val,vars.utm_campaign_term);}
if(rule_prop=='S_utm_campaign_medium'){return evalRuleString(rule_prop,rule_operator,rule_set,rule_val,vars.utm_campaign_medium);}
if(rule_prop=='C_click_jquery_selector'){if(rule_operator=='equals'){if(rule_val==''){res.rule_visual='you entered a blank jquery click selector, which will automatically evaluate to false';res.rule_message=res.rule_visual;res.rule_result=false;return res;}else{res.rule_result=(vars.click_jquery_selector.hasOwnProperty(rule_val)&&vars.click_jquery_selector[rule_val]==true);res.rule_visual='jquery click selector ('+rule_val+') occurred ('+res.rule_result+')';res.rule_message=res.rule_visual;return res;}}else if(rule_operator=='in_set'){for(var x=0;x<rule_set.length;x++){if(rule_set[x]!=''&&vars.click_jquery_selector.hasOwnProperty(rule_set[x])&&vars.click_jquery_selector[rule_set[x]]==true){res.rule_result=true;res.rule_visual='jquery click selector ('+rule_set[x]+') from group item number ('+x+') occurred ('+res.rule_result+')';res.rule_message=res.rule_visual;return res;}}
res.rule_result=false;res.rule_visual='jquery click selector from set did not occur';res.rule_message=res.rule_visual;return res;}else{res.rule_message='invalid operator: '+rule_operator;res.rule_error=true;res.result=false;return res;}}
if(rule_prop=='C_hover_jquery_selector'){if(rule_operator=='equals'){if(rule_val==''){res.rule_visual='you entered a blank jquery hover selector, which will automatically evaluate to false';res.rule_message=res.rule_visual;res.rule_result=false;return res;}else{res.rule_result=(vars.hover_jquery_selector.hasOwnProperty(rule_val)&&vars.hover_jquery_selector[rule_val]==true);res.rule_visual='jquery hover selector ('+rule_val+') occurred ('+res.rule_result+')';res.rule_message=res.rule_visual;return res;}}else if(rule_operator=='in_set'){for(var x=0;x<rule_set.length;x++){if(rule_set[x]!=''&&vars.hover_jquery_selector.hasOwnProperty(rule_set[x])&&vars.hover_jquery_selector[rule_set[x]]==true){res.rule_result=true;res.rule_visual='jquery hover selector ('+rule_set[x]+') from group item number ('+x+') occurred ('+res.rule_result+')';res.rule_message=res.rule_visual;return res;}}
res.rule_result=false;res.rule_visual='jquery hover selector from set did not occur';res.rule_message=res.rule_visual;return res;}else{res.rule_message='invalid operator: '+rule_operator;res.rule_error=true;res.result=false;return res;}}
if(rule_prop=='C_exists_jquery_selector'){if(rule_operator=='equals'){if(rule_val==''){res.rule_visual='you entered a blank jquery exists selector, which will automatically evaluate to false';res.rule_message=res.rule_visual;res.rule_result=false;return res;}else{res.rule_result=(vars.exists_jquery_selector.hasOwnProperty(rule_val)&&vars.exists_jquery_selector[rule_val]==true);res.rule_visual='jquery exists selector ('+rule_val+') exists ('+res.rule_result+')';res.rule_message=res.rule_visual;return res;}}else if(rule_operator=='does_not_equal'){if(rule_val==''){res.rule_visual='you entered a blank jquery exists selector, which will automatically evaluate to false';res.rule_message=res.rule_visual;res.rule_result=false;return res;}else{res.rule_result=(!vars.exists_jquery_selector.hasOwnProperty(rule_val)||vars.exists_jquery_selector[rule_val]==false);res.rule_visual='jquery exists selector ('+rule_val+') does not exist ('+res.rule_result+')';res.rule_message=res.rule_visual;return res;}}else if(rule_operator=='in_set'){for(var x=0;x<rule_set.length;x++){if(rule_set[x]!=''&&vars.exists_jquery_selector.hasOwnProperty(rule_set[x])&&vars.exists_jquery_selector[rule_set[x]]==true){res.rule_result=true;res.rule_visual='jquery exists selector ('+rule_set[x]+') from group item number ('+x+') exists ('+res.rule_result+') (success)';res.rule_message=res.rule_visual;return res;}}
res.rule_result=false;res.rule_visual='jquery exists selector from set did not occur (failure)';res.rule_message=res.rule_visual;return res;}else if(rule_operator=='not_in_set'){for(var x=0;x<rule_set.length;x++){if(rule_set[x]!=''&&vars.exists_jquery_selector.hasOwnProperty(rule_set[x])&&vars.exists_jquery_selector[rule_set[x]]==true){res.rule_result=false;res.rule_visual='jquery exists selector ('+rule_set[x]+') from group item number ('+x+') exists ('+res.rule_result+') (failure)';res.rule_message=res.rule_visual;return res;}}
res.rule_result=true;res.rule_visual='jquery exists selector from set did not occur (success)';res.rule_message=res.rule_visual;return res;}else{res.rule_message='invalid operator: '+rule_operator;res.rule_error=true;res.result=false;return res;}}
if(rule_prop=='E_exit_intent'){return evalRuleEnum(rule_prop,rule_operator,rule_set,rule_val,vars.exit_intent);}
if(rule_prop=='L_any_other_box'){if(rule_operator=='equals'){var occurrances=DIGIOH_LIGHTBOX_ANALYTICS.getEventCountAcrossAllLightboxesExcept(rule_val,lbid);res.rule_result=(occurrances>0);res.rule_visual=rule_val+' event has occurred '+occurrances+' times across all other lightboxes, so this rule is evaluated as '+res.rule_result;res.rule_message=res.rule_visual;return res;}else if(rule_operator=='does_not_equal'){var occurrances=DIGIOH_LIGHTBOX_ANALYTICS.getEventCountAcrossAllLightboxesExcept(rule_val,lbid);res.rule_result=(occurrances==0);res.rule_visual=rule_val+' event has occurred '+occurrances+' times across all other lightboxes, so this rule is evaluated as '+res.rule_result;res.rule_message=res.rule_visual;return res;}else if(rule_operator=='in_set'){for(var x=0;x<rule_set.length;x++){var occurrances=DIGIOH_LIGHTBOX_ANALYTICS.getEventCountAcrossAllLightboxesExcept(rule_set[x],lbid);if(occurrances>0){res.rule_result=true;res.rule_visual=rule_set[x]+' event from group has occurred '+occurrances+' times across all other lightboxes, so this rule is evaluated as '+res.rule_result;res.rule_message=res.rule_visual;return res;}}
res.rule_result=false;res.rule_visual='no events from group have occurred across all other lightboxes, so this rule is evaluated as '+res.rule_result;res.rule_message=res.rule_visual;return res;}else if(rule_operator=='not_in_set'){for(var x=0;x<rule_set.length;x++){var occurrances=DIGIOH_LIGHTBOX_ANALYTICS.getEventCountAcrossAllLightboxesExcept(rule_set[x],lbid);if(occurrances>0){res.rule_result=false;res.rule_visual=rule_set[x]+' event from group has occurred '+occurrances+' times across all other lightboxes, so this rule is evaluated as '+res.rule_result;res.rule_message=res.rule_visual;return res;}}
res.rule_result=true;res.rule_visual='no events from group have occurred across all other lightboxes, so this rule is evaluated as '+res.rule_result;res.rule_message=res.rule_visual;return res;}else{res.rule_message='invalid operator: '+rule_operator;res.rule_error=true;res.result=false;return res;}}
if(rule_prop.indexOf('L_other_box_')==0){var other_lbguid=rule_prop.split('_')[3];if(rule_operator=='equals'){var occurrances=DIGIOH_LIGHTBOX_ANALYTICS.getEventCountByLightbox(rule_val,other_lbguid);res.rule_result=(occurrances>0);res.rule_visual=rule_val+' event has occurred '+occurrances+' times for other lightbox guid '+other_lbguid+', so this rule is evaluated as '+res.rule_result;res.rule_message=res.rule_visual;return res;}else if(rule_operator=='does_not_equal'){var occurrances=DIGIOH_LIGHTBOX_ANALYTICS.getEventCountByLightbox(rule_val,other_lbguid);res.rule_result=(occurrances==0);res.rule_visual=rule_val+' event has occurred '+occurrances+' times for other lightbox guid '+other_lbguid+', so this rule is evaluated as '+res.rule_result;res.rule_message=res.rule_visual;return res;}else if(rule_operator=='in_set'){for(var x=0;x<rule_set.length;x++){var occurrances=DIGIOH_LIGHTBOX_ANALYTICS.getEventCountByLightbox(rule_set[x],other_lbguid);if(occurrances>0){res.rule_result=true;res.rule_visual=rule_set[x]+' event from group has occurred '+occurrances+' times for other lightbox guid '+other_lbguid+', so this rule is evaluated as '+res.rule_result;res.rule_message=res.rule_visual;return res;}}
res.rule_result=false;res.rule_visual='no events from group for other lightbox guid '+other_lbguid+' have occurred, so this rule is evaluated as '+res.rule_result;res.rule_message=res.rule_visual;return res;}else if(rule_operator=='not_in_set'){for(var x=0;x<rule_set.length;x++){var occurrances=DIGIOH_LIGHTBOX_ANALYTICS.getEventCountByLightbox(rule_set[x],other_lbguid);if(occurrances>0){res.rule_result=false;res.rule_visual=rule_set[x]+' event from group has occurred '+occurrances+' times for other lightbox guid '+other_lbguid+', so this rule is evaluated as '+res.rule_result;res.rule_message=res.rule_visual;return res;}}
res.rule_result=true;res.rule_visual='no events in from group for other lightbox guid '+other_lbguid+' have occurred, so this rule is evaluated as '+res.rule_result;res.rule_message=res.rule_visual;return res;}else{res.rule_message='invalid operator: '+rule_operator;res.rule_error=true;res.result=false;return res;}}
if(rule_prop=='K_cookie'||rule_prop=='K_local_storage'||rule_prop=='K_session_storage'){if(!key_name){res.rule_result=false;res.rule_visual='Key Name was not specified.';res.rule_message=res.rule_visual;return res;}
var storageVal='';try{if(rule_prop=='K_cookie'){storageVal=DIGIOH_COOKIE.getEncoded(key_name);}else if(rule_prop=='K_local_storage'){storageVal=window.localStorage.getItem(key_name);}else if(rule_prop=='K_session_storage'){storageVal=window.sessionStorage.getItem(key_name);}}
catch(err_storage){res.rule_result=false;res.rule_error=true;res.rule_message=rule_prop+' - ERROR::::'+err_storage.message;return res;}
if(rule_operator==='exists'){if(storageVal===null||typeof storageVal==='undefined'){res.rule_result=false;res.rule_visual='Key does not exist.';res.rule_message=res.rule_visual;return res;}else{res.rule_result=true;res.rule_visual='Key exists.';res.rule_message=res.rule_visual;return res;}}
if(rule_operator==='does_not_exist'){if(storageVal===null||typeof storageVal==='undefined'){res.rule_result=true;res.rule_visual='Key does not exist.';res.rule_message=res.rule_visual;return res;}else{res.rule_result=false;res.rule_visual='Key exists.';res.rule_message=res.rule_visual;return res;}}
if(typeof storageVal!=='string'){if(rule_operator==='does_not_contain'||rule_operator==='does_not_start_with'||rule_operator==='does_not_end_with'||rule_operator==='does_not_equal'){res.rule_result=true;res.rule_visual='Key does not exist.';res.rule_message=res.rule_visual;return res;}else{res.rule_result=false;res.rule_visual='Key does not exist.';res.rule_message=res.rule_visual;return res;}}
if(rule_operator!=='greater_than'&&rule_operator!=='less_than'){return evalRuleString(rule_prop,rule_operator,rule_set,rule_val,storageVal);}else{if(!isStringAnInteger(storageVal)){res.rule_result=false;res.rule_error=true;res.rule_message='value is not a number';return res;}
return evalRuleInt(rule_prop,rule_operator,rule_set,rule_val,parseInt(storageVal));}}
if(rule_prop=='J_javascript_variable'){if(!key_name){res.rule_result=false;res.rule_visual='Variable Name was not specified.';res.rule_message=res.rule_visual;return res;}
var jsVar='';try{jsVar=looseJsonParseVar(key_name);}
catch(err_jsvar){res.rule_result=false;res.rule_error=true;res.rule_message='J_javascript_variable - ERROR::::'+err_jsvar.message;return res;}
if((rule_operator==='equals'||rule_operator==='not_equals')&&(rule_val=='true'||rule_val=='false'||rule_val==true||rule_val==false)){return evalRuleString(rule_prop,rule_operator,rule_set,rule_val.toString().toLowerCase(),jsVar.toString().toLowerCase());}else if(rule_operator!=='greater_than'&&rule_operator!=='less_than'){return evalRuleString(rule_prop,rule_operator,rule_set,rule_val,jsVar);}else{if(!isStringAnInteger(jsVar)){res.rule_result=false;res.rule_error=true;res.rule_message='value is not a number';return res;}
return evalRuleInt(rule_prop,rule_operator,rule_set,rule_val,parseInt(jsVar));}}
if(rule_prop=='J_javascript_function'){if(!rule_val){res.rule_result=false;res.rule_visual='JS Function was not specified.';res.rule_message=res.rule_visual;return res;}
var jsFunc='';try{jsFunc=looseJsonParseFunc(rule_val);}
catch(err_jsfunc){res.rule_result=false;res.rule_error=true;res.rule_message='J_javascript_function - ERROR::::'+err_jsfunc.message;return res;}
res.rule_result=(jsFunc===true);res.rule_error=!res.rule_result;return res;}}
function looseJsonParseVar(obj){return Function("'use strict';return ("+obj+")")();}
function evalRuleStringMultiVal(rule_prop,rule_operator,rule_set,rule_val,compare_arr){var res={};res.rule_func='evalRuleStringMultiVal';res.rule_prop=rule_prop;res.rule_operator=rule_operator;res.rule_set=rule_set;res.rule_val=rule_val;res.rule_compare_val=compare_arr;res.rule_visual='';res.rule_message='';res.rule_error=false;res.rule_result=false;try{if(rule_operator=='equals'){res.rule_visual='Array EQUALS '+rule_val;res.rule_message=res.rule_visual;res.rule_result=JQUERY_DIGIOH.inArray(rule_val,compare_arr)>-1;return res;}else if(rule_operator=='does_not_equal'){res.rule_visual='Array DOES NOT EQUAL '+rule_val;res.rule_message=res.rule_visual;res.rule_result=JQUERY_DIGIOH.inArray(rule_val,compare_arr)===-1;return res;}else if(rule_operator=='starts_with'){if(rule_val==''){res.rule_visual='Array STARTS WITH '+rule_val;res.rule_message=res.rule_visual;res.rule_result=false;return res;}else{res.rule_visual='Array STARTS WITH '+rule_val;res.rule_message=res.rule_visual;var fm=false;for(var c=0;c<compare_arr.length;c++){if(stringStartsWith(compare_arr[c],rule_val)){fm=true;}}
res.rule_result=fm;return res;}}else if(rule_operator=='does_not_start_with'){if(rule_val==''){res.rule_visual='Array DOES NOT START WITH '+rule_val;res.rule_message=res.rule_visual;res.rule_result=false;return res;}else{res.rule_visual='Array DOES NOT START WITH '+rule_val;res.rule_message=res.rule_visual;var fm=false;for(var c=0;c<compare_arr.length;c++){if(stringStartsWith(compare_arr[c],rule_val)){fm=true;}}
res.rule_result=!fm;return res;}}else if(rule_operator=='ends_with'){if(rule_val==''){res.rule_visual='Array ENDS WITH '+rule_val;res.rule_message=res.rule_visual;res.rule_result=false;return res;}else{res.rule_visual='Array ENDS WITH '+rule_val;res.rule_message=res.rule_visual;var fm=false;for(var c=0;c<compare_arr.length;c++){if(stringEndsWith(compare_arr[c],rule_val)){fm=true;}}
res.rule_result=fm;return res;}}else if(rule_operator=='does_not_end_with'){if(rule_val==''){res.rule_visual='Array DOES NOT END WITH '+rule_val;res.rule_message=res.rule_visual;res.rule_result=false;return res;}else{res.rule_visual='Array DOES NOT END WITH '+rule_val;res.rule_message=res.rule_visual;var fm=false;for(var c=0;c<compare_arr.length;c++){if(stringEndsWith(compare_arr[c],rule_val)){fm=true;}}
res.rule_result=!fm;return res;}}else if(rule_operator=='contains'){if(rule_val==''){res.rule_visual='Array CONTAINS '+rule_val;res.rule_message=res.rule_visual;res.rule_result=false;return res;}else{res.rule_visual='Array CONTAINS '+rule_val;res.rule_message=res.rule_visual;var fm=false;for(var c=0;c<compare_arr.length;c++){if(compare_arr[c].indexOf(rule_val)>=0){fm=true;}}
res.rule_result=fm;return res;}}else if(rule_operator=='does_not_contain'){if(rule_val==''){res.rule_visual='Array DOES NOT CONTAIN '+rule_val;res.rule_message=res.rule_visual;res.rule_result=false;return res;}else{res.rule_visual='Array DOES NOT CONTAIN '+rule_val;res.rule_message=res.rule_visual;var fm=false;for(var c=0;c<compare_arr.length;c++){if(compare_arr[c].indexOf(rule_val)>=0){fm=true;}}
res.rule_result=!fm;return res;}}else if(rule_operator=='in_set'){for(var x=0;x<rule_set.length;x++){for(var y=0;y<compare_arr.length;y++){if(compare_arr[y]==rule_set[x]){res.rule_visual='Array MATCHED VALUE #'+x+' IN GROUP (success)';res.rule_message=res.rule_visual;res.rule_result=true;return res;}}}
res.rule_visual='Array MATCHED NO VALUES IN GROUP (failure)';res.rule_message=res.rule_visual;res.rule_result=false;return res;}else if(rule_operator=='not_in_set'){for(var x=0;x<rule_set.length;x++){for(var y=0;y<compare_arr.length;y++){if(compare_arr[y]==rule_set[x]){res.rule_visual='Array MATCHED VALUE #'+x+' IN GROUP (failure)';res.rule_message=res.rule_visual;res.rule_result=false;return res;}}}
res.rule_visual='Array MATCHED NO VALUES IN GROUP (success)';res.rule_message=res.rule_visual;res.rule_result=true;return res;}else if(rule_operator=='in_set_contains'){for(var x=0;x<rule_set.length;x++){for(var y=0;y<compare_arr.length;y++){if(rule_set[x]!=''&&compare_arr[y].indexOf(rule_set[x])>=0){res.rule_visual='Array CONTAINS VALUE #'+x+' IN GROUP ('+rule_set[x]+') (success)';res.rule_message=res.rule_visual;res.rule_result=true;return res;}}}
res.rule_visual='Array CONTAINS NO VALUES IN GROUP (failure)';res.rule_message=res.rule_visual;res.rule_result=false;return res;}else if(rule_operator=='not_in_set_contains'){for(var x=0;x<rule_set.length;x++){for(var y=0;y<compare_arr.length;y++){if(rule_set[x]!=''&&compare_arr[y].indexOf(rule_set[x])>=0){res.rule_visual='Array CONTAINS VALUE #'+x+' IN GROUP ('+rule_set[x]+') (failure)';res.rule_message=res.rule_visual;res.rule_result=false;return res;}}}
res.rule_visual='Array CONTAINS NO VALUES IN GROUP (success)';res.rule_message=res.rule_visual;res.rule_result=true;return res;}else{res.rule_message='invalid operator: '+rule_operator;res.rule_error=true;res.result=false;return res;}}
catch(e){logError(e,"evalRuleStringMultiVal");res.rule_error=true;res.rule_result=false;res.rule_message=e.message;return res;}}
function evalRuleString(rule_prop,rule_operator,rule_set,rule_val,compare_val){var res={};res.rule_func='evalRuleString';res.rule_prop=rule_prop;res.rule_operator=rule_operator;res.rule_set=rule_set;res.rule_val=rule_val;res.rule_compare_val=compare_val;res.rule_visual='';res.rule_message='';res.rule_error=false;res.rule_result=false;try
{if(typeof compare_val!=='string')
{compare_val='';res.rule_compare_val=compare_val;}
if(rule_operator=='equals'){res.rule_visual=compare_val+' EQUALS '+rule_val;res.rule_message=res.rule_visual;res.rule_result=(compare_val==rule_val);return res;}else if(rule_operator=='does_not_equal'){res.rule_visual=compare_val+' DOES NOT EQUAL '+rule_val;res.rule_message=res.rule_visual;res.rule_result=(compare_val!=rule_val);return res;}else if(rule_operator=='starts_with'){if(rule_val==''){res.rule_visual=compare_val+' STARTS WITH '+rule_val;res.rule_message=res.rule_visual;res.rule_result=false;return res;}else{res.rule_visual=compare_val+' STARTS WITH '+rule_val;res.rule_message=res.rule_visual;res.rule_result=stringStartsWith(compare_val,rule_val);return res;}}else if(rule_operator=='does_not_start_with'){if(rule_val==''){res.rule_visual=compare_val+' DOES NOT START WITH '+rule_val;res.rule_message=res.rule_visual;res.rule_result=false;return res;}else{res.rule_visual=compare_val+' DOES NOT START WITH '+rule_val;res.rule_message=res.rule_visual;res.rule_result=!stringStartsWith(compare_val,rule_val);return res;}}else if(rule_operator=='ends_with'){if(rule_val==''){res.rule_visual=compare_val+' ENDS WITH '+rule_val;res.rule_message=res.rule_visual;res.rule_result=false;return res;}else{res.rule_visual=compare_val+' ENDS WITH '+rule_val;res.rule_message=res.rule_visual;res.rule_result=stringEndsWith(compare_val,rule_val);return res;}}else if(rule_operator=='does_not_end_with'){if(rule_val==''){res.rule_visual=compare_val+' DOES NOT END WITH '+rule_val;res.rule_message=res.rule_visual;res.rule_result=false;return res;}else{res.rule_visual=compare_val+' DOES NOT END WITH '+rule_val;res.rule_message=res.rule_visual;res.rule_result=!stringEndsWith(compare_val,rule_val);return res;}}else if(rule_operator=='contains'){if(rule_val==''){res.rule_visual=compare_val+' CONTAINS '+rule_val;res.rule_message=res.rule_visual;res.rule_result=false;return res;}else{res.rule_visual=compare_val+' CONTAINS '+rule_val;res.rule_message=res.rule_visual;res.rule_result=(compare_val.indexOf(rule_val)>=0);return res;}}else if(rule_operator=='does_not_contain'){if(rule_val==''){res.rule_visual=compare_val+' DOES NOT CONTAIN '+rule_val;res.rule_message=res.rule_visual;res.rule_result=false;return res;}else{res.rule_visual=compare_val+' DOES NOT CONTAIN '+rule_val;res.rule_message=res.rule_visual;res.rule_result=(compare_val.indexOf(rule_val)==-1);return res;}}else if(rule_operator=='in_set'){for(var x=0;x<rule_set.length;x++){if(compare_val==rule_set[x]){res.rule_visual=compare_val+' MATCHED VALUE #'+x+' IN GROUP (success)';res.rule_message=res.rule_visual;res.rule_result=true;return res;}}
res.rule_visual=compare_val+' MATCHED NO VALUES IN GROUP (failure)';res.rule_message=res.rule_visual;res.rule_result=false;return res;}else if(rule_operator=='not_in_set'){for(var x=0;x<rule_set.length;x++){if(compare_val==rule_set[x]){res.rule_visual=compare_val+' MATCHED VALUE #'+x+' IN GROUP (failure)';res.rule_message=res.rule_visual;res.rule_result=false;return res;}}
res.rule_visual=compare_val+' MATCHED NO VALUES IN GROUP (success)';res.rule_message=res.rule_visual;res.rule_result=true;return res;}else if(rule_operator=='in_set_contains'){for(var x=0;x<rule_set.length;x++){if(rule_set[x]!=''&&compare_val.indexOf(rule_set[x])>=0){res.rule_visual=compare_val+' CONTAINS VALUE #'+x+' IN GROUP ('+rule_set[x]+') (success)';res.rule_message=res.rule_visual;res.rule_result=true;return res;}}
res.rule_visual=compare_val+' CONTAINS NO VALUES IN GROUP (failure)';res.rule_message=res.rule_visual;res.rule_result=false;return res;}else if(rule_operator=='not_in_set_contains'){for(var x=0;x<rule_set.length;x++){if(rule_set[x]!=''&&compare_val.indexOf(rule_set[x])>=0){res.rule_visual=compare_val+' CONTAINS VALUE #'+x+' IN GROUP ('+rule_set[x]+') (failure)';res.rule_message=res.rule_visual;res.rule_result=false;return res;}}
res.rule_visual=compare_val+' CONTAINS NO VALUES IN GROUP (success)';res.rule_message=res.rule_visual;res.rule_result=true;return res;}else{res.rule_message='invalid operator: '+rule_operator;res.rule_error=true;res.result=false;return res;}}
catch(e){logError(e,"evalRuleString");logger(res);res.rule_error=true;res.rule_result=false;res.rule_message=e.message;return res;}}
function evalRulePagesNavigated(rule_prop,rule_operator,rule_set,rule_val,compare_val){var res={};res.rule_func='evalRulePagesNavigated';res.rule_prop=rule_prop;res.rule_operator=rule_operator;res.rule_set=rule_set;res.rule_val=rule_val;res.rule_compare_val=compare_val;res.rule_visual='';res.rule_message='';res.rule_error=false;res.rule_result=false;try{if(rule_operator=='equals'){res.rule_visual=compare_val+' EQUALS '+rule_val;res.rule_message=res.rule_visual;res.rule_result=compareUrlEqualityWithAndWithoutTrailingSlash(compare_val,rule_val);return res;}else if(rule_operator=='does_not_equal'){res.rule_visual=compare_val+' DOES NOT EQUAL '+rule_val;res.rule_message=res.rule_visual;res.rule_result=!compareUrlEqualityWithAndWithoutTrailingSlash(compare_val,rule_val);return res;}else if(rule_operator=='starts_with'){if(rule_val==''){res.rule_visual=compare_val+' STARTS WITH '+rule_val;res.rule_message=res.rule_visual;res.rule_result=false;return res;}else{res.rule_visual=compare_val+' STARTS WITH '+rule_val;res.rule_message=res.rule_visual;res.rule_result=stringStartsWith(compare_val.toLowerCase(),rule_val.toLowerCase());return res;}}else if(rule_operator=='does_not_start_with'){if(rule_val==''){res.rule_visual=compare_val+' DOES NOT START WITH '+rule_val;res.rule_message=res.rule_visual;res.rule_result=false;return res;}else{res.rule_visual=compare_val+' DOES NOT START WITH '+rule_val;res.rule_message=res.rule_visual;res.rule_result=!stringStartsWith(compare_val.toLowerCase(),rule_val.toLowerCase());return res;}}else if(rule_operator=='ends_with'){if(rule_val==''){res.rule_visual=compare_val+' ENDS WITH '+rule_val;res.rule_message=res.rule_visual;res.rule_result=false;return res;}else{res.rule_visual=compare_val+' ENDS WITH '+rule_val;res.rule_message=res.rule_visual;res.rule_result=compareUrlEndingWithAndWithoutTrailingSlash(compare_val,rule_val);return res;}}else if(rule_operator=='does_not_end_with'){if(rule_val==''){res.rule_visual=compare_val+' DOES NOT END WITH '+rule_val;res.rule_message=res.rule_visual;res.rule_result=false;return res;}else{res.rule_visual=compare_val+' DOES NOT END WITH '+rule_val;res.rule_message=res.rule_visual;res.rule_result=!compareUrlEndingWithAndWithoutTrailingSlash(compare_val,rule_val);return res;}}else if(rule_operator=='contains'){if(rule_val==''){res.rule_visual=compare_val+' CONTAINS '+rule_val;res.rule_message=res.rule_visual;res.rule_result=false;return res;}else{res.rule_visual=compare_val+' CONTAINS '+rule_val;res.rule_message=res.rule_visual;res.rule_result=(compare_val.toLowerCase().indexOf(rule_val.toLowerCase())>=0);return res;}}else if(rule_operator=='does_not_contain'){if(rule_val==''){res.rule_visual=compare_val+' DOES NOT CONTAIN '+rule_val;res.rule_message=res.rule_visual;res.rule_result=false;return res;}else{res.rule_visual=compare_val+' DOES NOT CONTAIN '+rule_val;res.rule_message=res.rule_visual;res.rule_result=(compare_val.toLowerCase().indexOf(rule_val.toLowerCase())==-1);return res;}}else if(rule_operator=='in_set'){var compare_set=[];if(DIGIOH_API.contains(compare_val,'|')){compare_set=compare_val.split('|');}else if(compare_val){compare_set.push(compare_val);}
for(var x=0;x<rule_set.length;x++){for(s=0;s<compare_set.length;s++){if(compareUrlEqualityWithAndWithoutTrailingSlash(compare_set[s],rule_set[x])){res.rule_visual=compare_set[s]+' MATCHED VALUE #'+x+' IN GROUP (success)';res.rule_message=res.rule_visual;res.rule_result=true;return res;}}}
res.rule_visual=compare_set[s]+' MATCHED NO VALUES IN GROUP (failure)';res.rule_message=res.rule_visual;res.rule_result=false;return res;}else if(rule_operator=='not_in_set'){var compare_set=[];if(DIGIOH_API.contains(compare_val,'|')){compare_set=compare_val.split('|');}else if(compare_val){compare_set.push(compare_val);}
for(var x=0;x<rule_set.length;x++){for(s=0;s<compare_set.length;s++){if(compareUrlEqualityWithAndWithoutTrailingSlash(compare_set[s],rule_set[x])){res.rule_visual=compare_set[s]+' MATCHED VALUE #'+x+' IN GROUP (failure)';res.rule_message=res.rule_visual;res.rule_result=false;return res;}}}
res.rule_visual=compare_set[s]+' MATCHED NO VALUES IN GROUP (success)';res.rule_message=res.rule_visual;res.rule_result=true;return res;}else if(rule_operator=='in_set_contains'){var compare_set=[];if(DIGIOH_API.contains(compare_val,'|')){compare_set=compare_val.split('|');}else if(compare_val){compare_set.push(compare_val);}
for(var x=0;x<rule_set.length;x++){for(s=0;s<compare_set.length;s++){if(rule_set[x]!=''&&compare_set[s].toLowerCase().indexOf(rule_set[x].toLowerCase())>=0){res.rule_visual=compare_set[s]+' CONTAINS VALUE #'+x+' IN GROUP ('+rule_set[x]+') (success)';res.rule_message=res.rule_visual;res.rule_result=true;return res;}}}
res.rule_visual=compare_set[s]+' CONTAINS NO VALUES IN GROUP (failure)';res.rule_message=res.rule_visual;res.rule_result=false;return res;}else if(rule_operator=='not_in_set_contains'){var compare_set=[];if(DIGIOH_API.contains(compare_val,'|')){compare_set=compare_val.split('|');}else if(compare_val){compare_set.push(compare_val);}
for(var x=0;x<rule_set.length;x++){for(s=0;s<compare_set.length;s++){if(rule_set[x]!=''&&compare_set[s].toLowerCase().indexOf(rule_set[x].toLowerCase())>=0){res.rule_visual=compare_set[s]+' CONTAINS VALUE #'+x+' IN GROUP ('+rule_set[x]+') (failure)';res.rule_message=res.rule_visual;res.rule_result=false;return res;}}}
res.rule_visual=compare_set[s]+' CONTAINS NO VALUES IN GROUP (success)';res.rule_message=res.rule_visual;res.rule_result=true;return res;}else{res.rule_message='invalid operator: '+rule_operator;res.rule_error=true;res.result=false;return res;}}
catch(e){logError(e,"evalRulePagesNavigated");res.rule_error=true;res.rule_result=false;res.rule_message=e.message;return res;}}
function evalRuleUrl(rule_prop,rule_operator,rule_set,rule_val,compare_val){var res={};res.rule_func='evalRuleUrl';res.rule_prop=rule_prop;res.rule_operator=rule_operator;res.rule_set=rule_set;res.rule_val=rule_val;res.rule_compare_val=compare_val;res.rule_visual='';res.rule_message='';res.rule_error=false;res.rule_result=false;try{if(rule_operator=='equals'){res.rule_visual=compare_val+' EQUALS '+rule_val;res.rule_message=res.rule_visual;res.rule_result=compareUrlEqualityWithAndWithoutTrailingSlash(compare_val,rule_val);return res;}else if(rule_operator=='does_not_equal'){res.rule_visual=compare_val+' DOES NOT EQUAL '+rule_val;res.rule_message=res.rule_visual;res.rule_result=!compareUrlEqualityWithAndWithoutTrailingSlash(compare_val,rule_val);return res;}else if(rule_operator=='starts_with'){if(rule_val==''){res.rule_visual=compare_val+' STARTS WITH '+rule_val;res.rule_message=res.rule_visual;res.rule_result=false;return res;}else{res.rule_visual=compare_val+' STARTS WITH '+rule_val;res.rule_message=res.rule_visual;res.rule_result=stringStartsWith(compare_val.toLowerCase(),rule_val.toLowerCase());return res;}}else if(rule_operator=='does_not_start_with'){if(rule_val==''){res.rule_visual=compare_val+' DOES NOT START WITH '+rule_val;res.rule_message=res.rule_visual;res.rule_result=false;return res;}else{res.rule_visual=compare_val+' DOES NOT START WITH '+rule_val;res.rule_message=res.rule_visual;res.rule_result=!stringStartsWith(compare_val.toLowerCase(),rule_val.toLowerCase());return res;}}else if(rule_operator=='ends_with'){if(rule_val==''){res.rule_visual=compare_val+' ENDS WITH '+rule_val;res.rule_message=res.rule_visual;res.rule_result=false;return res;}else{res.rule_visual=compare_val+' ENDS WITH '+rule_val;res.rule_message=res.rule_visual;res.rule_result=compareUrlEndingWithAndWithoutTrailingSlash(compare_val,rule_val);return res;}}else if(rule_operator=='does_not_end_with'){if(rule_val==''){res.rule_visual=compare_val+' DOES NOT END WITH '+rule_val;res.rule_message=res.rule_visual;res.rule_result=false;return res;}else{res.rule_visual=compare_val+' DOES NOT END WITH '+rule_val;res.rule_message=res.rule_visual;res.rule_result=!compareUrlEndingWithAndWithoutTrailingSlash(compare_val,rule_val);return res;}}else if(rule_operator=='contains'){if(rule_val==''){res.rule_visual=compare_val+' CONTAINS '+rule_val;res.rule_message=res.rule_visual;res.rule_result=false;return res;}else{res.rule_visual=compare_val+' CONTAINS '+rule_val;res.rule_message=res.rule_visual;res.rule_result=(compare_val.toLowerCase().indexOf(rule_val.toLowerCase())>=0);return res;}}else if(rule_operator=='does_not_contain'){if(rule_val==''){res.rule_visual=compare_val+' DOES NOT CONTAIN '+rule_val;res.rule_message=res.rule_visual;res.rule_result=false;return res;}else{res.rule_visual=compare_val+' DOES NOT CONTAIN '+rule_val;res.rule_message=res.rule_visual;res.rule_result=(compare_val.toLowerCase().indexOf(rule_val.toLowerCase())==-1);return res;}}else if(rule_operator=='in_set'){for(var x=0;x<rule_set.length;x++){if(compareUrlEqualityWithAndWithoutTrailingSlash(compare_val,rule_set[x])){res.rule_visual=compare_val+' MATCHED VALUE #'+x+' IN GROUP (success)';res.rule_message=res.rule_visual;res.rule_result=true;return res;}}
res.rule_visual=compare_val+' MATCHED NO VALUES IN GROUP (failure)';res.rule_message=res.rule_visual;res.rule_result=false;return res;}else if(rule_operator=='not_in_set'){for(var x=0;x<rule_set.length;x++){if(compareUrlEqualityWithAndWithoutTrailingSlash(compare_val,rule_set[x])){res.rule_visual=compare_val+' MATCHED VALUE #'+x+' IN GROUP (failure)';res.rule_message=res.rule_visual;res.rule_result=false;return res;}}
res.rule_visual=compare_val+' MATCHED NO VALUES IN GROUP (success)';res.rule_message=res.rule_visual;res.rule_result=true;return res;}else if(rule_operator=='in_set_contains'){for(var x=0;x<rule_set.length;x++){if(rule_set[x]!=''&&compare_val.toLowerCase().indexOf(rule_set[x].toLowerCase())>=0){res.rule_visual=compare_val+' CONTAINS VALUE #'+x+' IN GROUP ('+rule_set[x]+') (success)';res.rule_message=res.rule_visual;res.rule_result=true;return res;}}
res.rule_visual=compare_val+' CONTAINS NO VALUES IN GROUP (failure)';res.rule_message=res.rule_visual;res.rule_result=false;return res;}else if(rule_operator=='not_in_set_contains'){for(var x=0;x<rule_set.length;x++){if(rule_set[x]!=''&&compare_val.toLowerCase().indexOf(rule_set[x].toLowerCase())>=0){res.rule_visual=compare_val+' CONTAINS VALUE #'+x+' IN GROUP ('+rule_set[x]+') (failure)';res.rule_message=res.rule_visual;res.rule_result=false;return res;}}
res.rule_visual=compare_val+' CONTAINS NO VALUES IN GROUP (success)';res.rule_message=res.rule_visual;res.rule_result=true;return res;}else{res.rule_message='invalid operator: '+rule_operator;res.rule_error=true;res.result=false;return res;}}
catch(e){logError(e,"evalRuleUrl");res.rule_error=true;res.rule_result=false;res.rule_message=e.message;return res;}}
function evalRuleDeviceEnum(rule_prop,rule_operator,rule_set,rule_val,compare_val_orig){var res={};res.rule_func='evalRuleDeviceEnum';res.rule_prop=rule_prop;res.rule_operator=rule_operator;res.rule_set=rule_set;res.rule_val=rule_val;res.rule_compare_val=compare_val_orig;res.rule_visual='';res.rule_message='';res.rule_error=false;res.rule_result=false;var compare_val=compare_val_orig;try{if(rule_operator=='equals'){if(rule_val&&rule_val.indexOf('Desktop/Laptop')===-1&&rule_val.indexOf('Phone/Tablet')===-1){if(isPhone()){compare_val='Phone';}else if(isTablet()){compare_val='Tablet';}else{compare_val='Desktop';}}else{compare_val=compare_val_orig;}
res.rule_visual=compare_val+' EQUALS '+rule_val;res.rule_message=res.rule_visual;res.rule_result=(compare_val==rule_val);return res;}else if(rule_operator=='does_not_equal'){if(rule_val&&rule_val.indexOf('Desktop/Laptop')===-1&&rule_val.indexOf('Phone/Tablet')===-1){if(isPhone()){compare_val='Phone';}else if(isTablet()){compare_val='Tablet';}else{compare_val='Desktop';}}else{compare_val=compare_val_orig;}
res.rule_visual=compare_val+' DOES NOT EQUAL '+rule_val;res.rule_message=res.rule_visual;res.rule_result=(compare_val!=rule_val);return res;}else if(rule_operator=='in_set'){for(var x=0;x<rule_set.length;x++){if(rule_set[x]&&rule_set[x].indexOf('Desktop/Laptop')===-1&&rule_set[x].indexOf('Phone/Tablet')===-1){if(isPhone()){compare_val='Phone';}else if(isTablet()){compare_val='Tablet';}else{compare_val='Desktop';}}else{compare_val=compare_val_orig;}
if(compare_val==rule_set[x]){res.rule_visual=compare_val+' MATCHED VALUE #'+x+' IN GROUP (success)';res.rule_message=res.rule_visual;res.rule_result=true;return res;}}
res.rule_visual=compare_val+' MATCHED NO VALUES IN GROUP (failure)';res.rule_message=res.rule_visual;res.rule_result=false;return res;}else if(rule_operator=='not_in_set'){for(var x=0;x<rule_set.length;x++){if(rule_set[x]&&rule_set[x].indexOf('Desktop/Laptop')===-1&&rule_set[x].indexOf('Phone/Tablet')===-1){if(isPhone()){compare_val='Phone';}else if(isTablet()){compare_val='Tablet';}else{compare_val='Desktop';}}else{compare_val=compare_val_orig;}
if(compare_val==rule_set[x]){res.rule_visual=compare_val+' MATCHED VALUE #'+x+' IN GROUP (failure)';res.rule_message=res.rule_visual;res.rule_result=false;return res;}}
res.rule_visual=compare_val+' MATCHED NO VALUES IN GROUP (success)';res.rule_message=res.rule_visual;res.rule_result=true;return res;}else{res.rule_message='invalid operator: '+rule_operator;res.rule_error=true;res.result=false;return res;}}
catch(e){logError(e,"evalRuleDeviceEnum");res.rule_visual='ERROR: '+e.message;res.rule_error=true;res.rule_result=false;res.rule_message=e.message;return res;}}
var getBrowserLanguages;function evalRuleEnumLanguage(rule_prop,rule_operator,rule_set,rule_val)
{var compare_val_orig='en';var langs=getBrowserLanguages();if(typeof langs==='object'&&langs!=null&&langs.length>0)
compare_val_orig=langs[0];var res={};res.rule_func='evalRuleEnumLanguage';res.rule_prop=rule_prop;res.rule_operator=rule_operator;res.rule_set=rule_set;res.rule_val=rule_val;res.rule_compare_val=compare_val_orig;res.rule_visual='';res.rule_message='';res.rule_error=false;res.rule_result=false;var compare_val=compare_val_orig;try
{if(rule_operator=='equals')
{if(rule_val&&rule_val.indexOf('_')===-1)
compare_val=compare_val_orig.split('-')[0];else
compare_val=compare_val_orig.split('-').join('_');res.rule_visual=compare_val+' EQUALS '+rule_val;res.rule_message=res.rule_visual;res.rule_result=(compare_val.toLowerCase()==rule_val.toLowerCase());return res;}else if(rule_operator=='does_not_equal')
{if(rule_val&&rule_val.indexOf('_')===-1)
compare_val=compare_val_orig.split('-')[0];else
compare_val=compare_val_orig.split('-').join('_');res.rule_visual=compare_val+' DOES NOT EQUAL '+rule_val;res.rule_message=res.rule_visual;res.rule_result=(compare_val.toLowerCase()!=rule_val.toLowerCase());return res;}else if(rule_operator=='in_set')
{for(var x=0;x<rule_set.length;x++)
{if(rule_set[x]&&rule_set[x].indexOf('_')===-1)
compare_val=compare_val_orig.split('-')[0];else
compare_val=compare_val_orig.split('-').join('_');if(compare_val.toLowerCase()==rule_set[x].toLowerCase())
{res.rule_visual=compare_val+' MATCHED VALUE #'+x+' IN GROUP (success)';res.rule_message=res.rule_visual;res.rule_result=true;return res;}}
res.rule_visual=compare_val+' MATCHED NO VALUES IN GROUP (failure)';res.rule_message=res.rule_visual;res.rule_result=false;return res;}else if(rule_operator=='not_in_set')
{for(var x=0;x<rule_set.length;x++)
{if(rule_set[x]&&rule_set[x].indexOf('_')===-1)
compare_val=compare_val_orig.split('-')[0];else
compare_val=compare_val_orig.split('-').join('_');if(compare_val.toLowerCase()==rule_set[x].toLowerCase())
{res.rule_visual=compare_val+' MATCHED VALUE #'+x+' IN GROUP (failure)';res.rule_message=res.rule_visual;res.rule_result=false;return res;}}
res.rule_visual=compare_val+' MATCHED NO VALUES IN GROUP (success)';res.rule_message=res.rule_visual;res.rule_result=true;return res;}else
{res.rule_message='invalid operator: '+rule_operator;res.rule_error=true;res.result=false;return res;}}
catch(e)
{logError(e,"evalRuleEnumLanguage");res.rule_visual='ERROR: '+e.message;res.rule_error=true;res.rule_result=false;res.rule_message=e.message;return res;}}
function evalRuleEnum(rule_prop,rule_operator,rule_set,rule_val,compare_val){var res={};res.rule_func='evalRuleEnum';res.rule_prop=rule_prop;res.rule_operator=rule_operator;res.rule_set=rule_set;res.rule_val=rule_val;res.rule_compare_val=compare_val;res.rule_visual='';res.rule_message='';res.rule_error=false;res.rule_result=false;try{if(rule_operator=='equals'){res.rule_visual=compare_val+' EQUALS '+rule_val;res.rule_message=res.rule_visual;res.rule_result=(compare_val==rule_val);return res;}else if(rule_operator=='does_not_equal'){res.rule_visual=compare_val+' DOES NOT EQUAL '+rule_val;res.rule_message=res.rule_visual;res.rule_result=(compare_val!=rule_val);return res;}else if(rule_operator=='in_set'){for(var x=0;x<rule_set.length;x++){if(compare_val==rule_set[x]){res.rule_visual=compare_val+' MATCHED VALUE #'+x+' IN GROUP (success)';res.rule_message=res.rule_visual;res.rule_result=true;return res;}}
res.rule_visual=compare_val+' MATCHED NO VALUES IN GROUP (failure)';res.rule_message=res.rule_visual;res.rule_result=false;return res;}else if(rule_operator=='not_in_set'){for(var x=0;x<rule_set.length;x++){if(compare_val==rule_set[x]){res.rule_visual=compare_val+' MATCHED VALUE #'+x+' IN GROUP (failure)';res.rule_message=res.rule_visual;res.rule_result=false;return res;}}
res.rule_visual=compare_val+' MATCHED NO VALUES IN GROUP (success)';res.rule_message=res.rule_visual;res.rule_result=true;return res;}else{res.rule_message='invalid operator: '+rule_operator;res.rule_error=true;res.result=false;return res;}}
catch(e){logError(e,"evalRuleEnum");res.rule_error=true;res.rule_result=false;res.rule_message=e.message;return res;}}
function evalRuleEnumSegments(rule_prop,rule_operator,rule_set,rule_val,compare_val){var res={};res.rule_func='evalRuleEnumSegments';res.rule_prop=rule_prop;res.rule_operator=rule_operator;res.rule_set=rule_set;res.rule_val=rule_val;res.rule_compare_val=compare_val;res.rule_visual='';res.rule_message='';res.rule_error=false;res.rule_result=false;try{if(typeof CDP_VARS==='object'&&CDP_VARS&&CDP_VARS.hasOwnProperty('enabled')&&CDP_VARS.enabled){if(rule_operator==='equals'){res.rule_visual='['+compare_val.join(',')+']'+' EQUALS/CONTAINS '+rule_val;res.rule_message=res.rule_visual;res.rule_result=(JQUERY_DIGIOH.inArray(rule_val,compare_val)!==-1);return res;}else if(rule_operator==='does_not_equal'){res.rule_visual='['+compare_val.join(',')+']'+' DOES NOT EQUAL/CONTAIN '+rule_val;res.rule_message=res.rule_visual;res.rule_result=(JQUERY_DIGIOH.inArray(rule_val,compare_val)===-1);return res;}else if(rule_operator==='in_set'){for(var x=0;x<rule_set.length;x++){if(JQUERY_DIGIOH.inArray(rule_val,compare_val)!==-1){res.rule_visual='['+compare_val.join(',')+']'+' MATCHED/CONTAINED VALUE #'+x+' IN GROUP (success)';res.rule_message=res.rule_visual;res.rule_result=true;return res;}}
res.rule_visual='['+compare_val.join(',')+']'+' MATCHED/CONTAINED NO VALUES IN GROUP (failure)';res.rule_message=res.rule_visual;res.rule_result=false;return res;}else if(rule_operator==='not_in_set'){for(var x=0;x<rule_set.length;x++){if(JQUERY_DIGIOH.inArray(rule_val,compare_val)!==-1){res.rule_visual='['+compare_val.join(',')+']'+' MATCHED/CONTAINED VALUE #'+x+' IN GROUP (failure)';res.rule_message=res.rule_visual;res.rule_result=false;return res;}}
res.rule_visual='['+compare_val.join(',')+']'+' MATCHED/CONTAINED NO VALUES IN GROUP (success)';res.rule_message=res.rule_visual;res.rule_result=true;return res;}else{res.rule_message='invalid operator: '+rule_operator;res.rule_error=true;res.result=false;return res;}}
else{if(DIGIOH_API.recipientSegmentsResult&&!DIGIOH_API.recipientSegmentsResult.found){res.rule_visual='API RESULT NOT FOUND (failure)';res.rule_message=res.rule_visual;res.rule_result=false;return res;}
var root_domain=window.location.host;if(window.location.host.split('.').length>2){var temp=window.location.host.split('.').reverse();root_domain=temp[1]+'.'+temp[0];}
if(rule_operator==='equals'){if(!DIGIOH_API.contains(rule_val,root_domain)){res.rule_visual='ROOT DOMAIN DID NOT MATCH (failure)';res.rule_message=res.rule_visual;res.rule_result=false;return res;}
rule_val=rule_val.split(' (')[0];res.rule_visual='['+compare_val.join(',')+']'+' EQUALS/CONTAINS '+rule_val;res.rule_message=res.rule_visual;res.rule_result=(JQUERY_DIGIOH.inArray(rule_val,compare_val)!==-1);return res;}else if(rule_operator==='does_not_equal'){if(!DIGIOH_API.contains(rule_val,root_domain)){res.rule_visual='ROOT DOMAIN DID NOT MATCH (failure)';res.rule_message=res.rule_visual;res.rule_result=true;return res;}
rule_val=rule_val.split(' (')[0];res.rule_visual='['+compare_val.join(',')+']'+' DOES NOT EQUAL/CONTAIN '+rule_val;res.rule_message=res.rule_visual;res.rule_result=(JQUERY_DIGIOH.inArray(rule_val,compare_val)===-1);return res;}else if(rule_operator==='in_set'){for(var x=0;x<rule_set.length;x++){if(!DIGIOH_API.contains(rule_set[x],root_domain)){continue;}
rule_val=rule_set[x].split(' (')[0];if(JQUERY_DIGIOH.inArray(rule_val,compare_val)!==-1){res.rule_visual='['+compare_val.join(',')+']'+' MATCHED/CONTAINED VALUE #'+x+' IN GROUP (success)';res.rule_message=res.rule_visual;res.rule_result=true;return res;}}
res.rule_visual='['+compare_val.join(',')+']'+' MATCHED/CONTAINED NO VALUES IN GROUP (failure)';res.rule_message=res.rule_visual;res.rule_result=false;return res;}else if(rule_operator==='not_in_set'){for(var x=0;x<rule_set.length;x++){if(!DIGIOH_API.contains(rule_set[x],root_domain)){continue;}
rule_val=rule_set[x].split(' (')[0];if(JQUERY_DIGIOH.inArray(rule_val,compare_val)!==-1){res.rule_visual='['+compare_val.join(',')+']'+' MATCHED/CONTAINED VALUE #'+x+' IN GROUP (failure)';res.rule_message=res.rule_visual;res.rule_result=false;return res;}}
res.rule_visual='['+compare_val.join(',')+']'+' MATCHED/CONTAINED NO VALUES IN GROUP (success)';res.rule_message=res.rule_visual;res.rule_result=true;return res;}else{res.rule_message='invalid operator: '+rule_operator;res.rule_error=true;res.result=false;return res;}}}
catch(e){logError(e,"evalRuleEnumSegments");res.rule_error=true;res.rule_result=false;res.rule_message=e.message;return res;}}
function evalRuleInt(rule_prop,rule_operator,rule_set,rule_val,compare_val){var res={};res.rule_func='evalRuleInt';res.rule_prop=rule_prop;res.rule_operator=rule_operator;res.rule_set=rule_set;res.rule_val=rule_val;res.rule_compare_val=compare_val;res.rule_visual='';res.rule_message='';res.rule_error=false;res.rule_result=false;try{if(rule_operator=='equals'){if(!isStringAnInteger(rule_val)){res.rule_error=true;res.rule_message='value is not a number';return res;}else{res.rule_visual=compare_val+' EQUALS '+rule_val;res.rule_message=res.rule_visual;res.rule_result=(compare_val==parseInt(rule_val));return res;}}else if(rule_operator=='does_not_equal'){if(!isStringAnInteger(rule_val)){res.rule_error=true;res.rule_message='value is not a number';return res;}else{res.rule_visual=compare_val+' DOES NOT EQUAL '+rule_val;res.rule_message=res.rule_visual;res.rule_result=(compare_val!=parseInt(rule_val));return res;}}else if(rule_operator=='less_than'){if(!isStringAnInteger(rule_val)){res.rule_error=true;res.rule_message='value is not a number';return res;}else{res.rule_visual=compare_val+' LESS THAN '+rule_val;res.rule_message=res.rule_visual;res.rule_result=(compare_val<parseInt(rule_val));return res;}}else if(rule_operator=='greater_than'){if(!isStringAnInteger(rule_val)){res.rule_error=true;res.rule_message='value is not a number';return res;}else{res.rule_visual=compare_val+' GREATER THAN '+rule_val;res.rule_message=res.rule_visual;res.rule_result=(compare_val>parseInt(rule_val));return res;}}else if(rule_operator=='in_set'){for(var x=0;x<rule_set.length;x++){if(isStringAnInteger(rule_set[x])&&compare_val==parseInt(rule_set[x])){res.rule_visual=compare_val+' MATCHED VALUE #'+x+' IN GROUP (success)';res.rule_message=res.rule_visual;res.rule_result=true;return res;}}
res.rule_visual=compare_val+' MATCHED NO VALUES IN GROUP (failure)';res.rule_message=res.rule_visual;res.rule_result=false;return res;}else if(rule_operator=='not_in_set'){for(var x=0;x<rule_set.length;x++){if(isStringAnInteger(rule_set[x])&&compare_val==parseInt(rule_set[x])){res.rule_visual=compare_val+' MATCHED VALUE #'+x+' IN GROUP (failure)';res.rule_message=res.rule_visual;res.rule_result=false;return res;}}
res.rule_visual=compare_val+' MATCHED NO VALUES IN GROUP (success)';res.rule_message=res.rule_visual;res.rule_result=true;return res;}else{res.rule_message='invalid operator: '+rule_operator;res.rule_error=true;res.result=false;return res;}}
catch(e){logError(e,"evalRuleInt");res.rule_error=true;res.rule_result=false;res.rule_message=e.message;return res;}}
function evalRuleDate(rule_prop,rule_operator,rule_start_date,rule_end_date,compare_date){var res={};res.rule_func='evalRuleDate';res.rule_prop=rule_prop;res.rule_operator=rule_operator;res.rule_start_date=rule_start_date;res.rule_end_date=rule_end_date;res.rule_compare_date=compare_date;res.rule_visual='';res.rule_message='';res.rule_error=false;res.rule_result=false;try{var start_date_parts=[];var end_date_parts=[];var compare_date_parts=[];var start;var end;var compare;if(compare_date.indexOf('/')==-1){res.rule_message='comparison date in invalid format, does not contain slash: '+compare_date;res.rule_error=true;return res;}
compare_date_parts=compare_date.split('/');if(compare_date_parts.length!=3){res.rule_message='comparison date in invalid format, less than 3 date parts: '+compare_date;res.rule_error=true;return res;}
compare=new Date(parseInt(compare_date_parts[2]),parseInt(compare_date_parts[0]-1),parseInt(compare_date_parts[1]),0,0,0);if(rule_start_date.indexOf('/')==-1){res.rule_message='start date in invalid format, does not contain slash: '+rule_start_date;res.rule_error=true;return res;}
start_date_parts=rule_start_date.split('/');if(start_date_parts.length!=3){res.rule_message='start date in invalid format, less than 3 date parts: '+rule_start_date;res.rule_error=true;return res;}
start=new Date(parseInt(start_date_parts[2]),parseInt(start_date_parts[0]-1),parseInt(start_date_parts[1]),0,0,0);if(rule_operator=='equals'){res.rule_visual=(compare.getMonth()+1)+'/'+compare.getDate()+'/'+compare.getFullYear()+' EQUALS '+rule_start_date;res.rule_result=(compare.getTime()==start.getTime());return res;}else if(rule_operator=='does_not_equal'){res.rule_visual=(compare.getMonth()+1)+'/'+compare.getDate()+'/'+compare.getFullYear()+' DOES NOT EQUAL '+rule_start_date;res.rule_result=(compare.getTime()!=start.getTime());return res;}else if(rule_operator=='less_than'){res.rule_visual=(compare.getMonth()+1)+'/'+compare.getDate()+'/'+compare.getFullYear()+' LESS THAN '+rule_start_date;res.rule_result=(compare.getTime()<start.getTime());return res;}else if(rule_operator=='greater_than'){res.rule_visual=(compare.getMonth()+1)+'/'+compare.getDate()+'/'+compare.getFullYear()+' GREATER THAN '+rule_start_date;res.rule_result=(compare.getTime()>start.getTime());return res;}else if(rule_operator=='between'||rule_operator=='is_not_between'){if(rule_end_date.indexOf('/')==-1){res.rule_message='end date in invalid format, does not contain slash: '+rule_end_date;res.rule_error=true;return res;}
end_date_parts=rule_end_date.split('/');if(end_date_parts.length!=3){res.rule_message='end date in invalid format, less than 3 date parts: '+rule_end_date;res.rule_error=true;return res;}
end=new Date(parseInt(end_date_parts[2]),parseInt(end_date_parts[0]-1),parseInt(end_date_parts[1]),0,0,0);if(end.getTime()<start.getTime()){res.rule_message='start date must be less than or equal to end date: '+rule_start_date+' (start date), '+rule_end_date+' (end date)';res.rule_error=true;return res;}
if(rule_operator=='between'){res.rule_visual=(compare.getMonth()+1)+'/'+compare.getDate()+'/'+compare.getFullYear()+' BETWEEN '+rule_start_date+', '+rule_end_date;res.rule_result=(compare.getTime()>=start.getTime()&&compare.getTime()<=end.getTime());return res;}else if(rule_operator=='is_not_between'){res.rule_visual=(compare.getMonth()+1)+'/'+compare.getDate()+'/'+compare.getFullYear()+' IS NOT BETWEEN '+rule_start_date+', '+rule_end_date;res.rule_result=(compare.getTime()<start.getTime()||compare.getTime()>end.getTime());return res;}else{res.rule_message='invalid operator: '+rule_operator;res.rule_error=true;res.result=false;return res;}}else{res.rule_message='invalid operator: '+rule_operator;res.rule_error=true;res.result=false;return res;}}
catch(e){logError(e,"evalRuleDate");res.rule_error=true;res.rule_result=false;res.rule_message=e.message;return res;}}
function initLightboxActivity(){try{DIGIOH_LIGHTBOX_ANALYTICS.loadLightboxActivity();}
catch(e){logError(e,"initLightboxActivity");}}
function checkLightboxMasterRules(){try{if(typeof DIGIOH_LIGHTBOX_MASTER_RULES!=="undefined"&&window.location.href.indexOf('ignore_lightbox_master_rules')<0){if(typeof DIGIOH_LIGHTBOX_MASTER_RULES.OneBoxPerPageview!=="undefined"&&DIGIOH_LIGHTBOX_MASTER_RULES.OneBoxPerPageview===true&&DIGIOH_LIGHTBOX_ANALYTICS.VARS.master_rules["Once per pageview"]===false){logger("OneBoxPerPageview: Master rule prevented further execution.");return false;}
if(typeof DIGIOH_LIGHTBOX_MASTER_RULES.OneBoxPerSession!=="undefined"&&DIGIOH_LIGHTBOX_MASTER_RULES.OneBoxPerSession===true&&DIGIOH_LIGHTBOX_ANALYTICS.VARS.master_rules["Once per session"]===false){logger("OneBoxPerSession:  Master rule prevented further execution.");return false;}
if(typeof DIGIOH_LIGHTBOX_MASTER_RULES.OneBoxPerVisitor!=="undefined"&&DIGIOH_LIGHTBOX_MASTER_RULES.OneBoxPerVisitor===true&&DIGIOH_LIGHTBOX_ANALYTICS.VARS.master_rules["Once per visitor"]===false){logger("OneBoxPerVisitor:  Master rule prevented further execution.");return false;}
if(typeof DIGIOH_LIGHTBOX_MASTER_RULES.StopAfterFormSubmitted!=="undefined"&&DIGIOH_LIGHTBOX_MASTER_RULES.StopAfterFormSubmitted===true&&DIGIOH_LIGHTBOX_ANALYTICS.VARS.master_rules["Until form is submitted"]===false){logger("StopAfterFormSubmitted:  Master rule prevented further execution.");return false;}
if(typeof DIGIOH_LIGHTBOX_MASTER_RULES.DisableIfCookiesDisabled!=="undefined"&&DIGIOH_LIGHTBOX_MASTER_RULES.DisableIfCookiesDisabled===true&&(((DIGIOH_STORAGE.storage_type==='cookie'||DIGIOH_STORAGE.storage_type==='local_storage')&&areCookiesDisabled())||(DIGIOH_STORAGE.storage_type==='cross_domain'&&!DIGIOH_CROSS_DOMAIN.isWorking))){logger("DisableIfCookiesDisabled:  Cookies are currently disabled in this browser.  Preventing further execution.");return false;}}
return true;}
catch(e){logError(e,"checkLightboxMasterRules");return true;}}
function updateLightboxActivityView(lid){try{DIGIOH_LIGHTBOX_ANALYTICS.setLightboxEvent("view",lid);}
catch(e){logError(e,"updateLightboxActivityView");}}
function updateLightboxActivityClose(lid){try{DIGIOH_LIGHTBOX_ANALYTICS.setLightboxEvent("close",lid);}
catch(e){logError(e,"updateLightboxActivityClose");}}
function updateLightboxActivitySubmit(lid){try{DIGIOH_LIGHTBOX_ANALYTICS.setLightboxEvent("submit",lid);}
catch(e){logError(e,"updateLightboxActivitySubmit");}}
function updateLightboxActivityRedirect(lid){try{DIGIOH_LIGHTBOX_ANALYTICS.setLightboxEvent("redirect",lid);}
catch(e){logError(e,"updateLightboxActivityRedirect");}}
var initExistsSelectors=function(){try{for(var x=0;x<EXISTS_SELECTORS.length;x++){if(JQUERY_DIGIOH(EXISTS_SELECTORS[x]).length){DIGIOH_LIGHTBOX_ANALYTICS.VARS.exists_jquery_selector[EXISTS_SELECTORS[x]]=true;}else{DIGIOH_LIGHTBOX_ANALYTICS.VARS.exists_jquery_selector[EXISTS_SELECTORS[x]]=false;}}}
catch(e){logError(e,"initExistsSelectors");}};var recheckExistsSelectors=function(){initExistsSelectors();};function initClickSelectors(){try{for(var x=0;x<CLICK_SELECTORS.length;x++){DIGIOH_LIGHTBOX_ANALYTICS.VARS.click_jquery_selector[CLICK_SELECTORS[x]]=false;JQUERY_DIGIOH(document).on('click',CLICK_SELECTORS[x],function(e){e.preventDefault();var curr=JQUERY_DIGIOH(this)[0];for(var y=0;y<CLICK_SELECTORS.length;y++){var elements=JQUERY_DIGIOH(CLICK_SELECTORS[y]);for(var w=0;w<elements.length;w++){if(elements[w]===curr){DIGIOH_LIGHTBOX_ANALYTICS.VARS.click_jquery_selector[CLICK_SELECTORS[y]]=true;checkConditionsClick(CLICK_SELECTORS[y]);if(!DIGIOH_LIGHTBOX_MASTER_RULES.AllowMultipleBoxes){break;}}}}});}}
catch(e){logError(e,"initClickSelectors");}}
var checkConditionsClick=function(selector){try{var lbguid=checkConditions('click','',selector,false);if(lbguid&&lbguid.length>0){loadLightbox(lbguid);}
DIGIOH_LIGHTBOX_ANALYTICS.VARS.click_jquery_selector[selector]=false;}
catch(e){logError(e,"checkConditionsClick");}};function initHoverSelectors(){try{for(var x=0;x<HOVER_SELECTORS.length;x++){DIGIOH_LIGHTBOX_ANALYTICS.VARS.hover_jquery_selector[HOVER_SELECTORS[x]]=false;JQUERY_DIGIOH(HOVER_SELECTORS[x]).mouseenter).mouseleave);}}
catch(e){logError(e,"initHoverSelectors");}}
var checkConditionsHover=function(selector){try{var lbguid=checkConditions('hover','',selector,false);if(lbguid&&lbguid.length>0){loadLightbox(lbguid);}}
catch(e){logError(e,"checkConditionsHover");}};function initScrollSelectors(){try{if(SCROLL_BOXES_ARR.length>0){jqWin.scroll);logger("initScrollSelectors");}}
catch(e){logError(e,"initScrollSelectors");}}
var checkConditionsScroll=function(){try{var lbguidCurr='';var lbguidMatch='';var ss=SCROLL_BOXES_ARR;for(var x=0;x<ss.length;x++){if(!SS_EVAL_PREV.hasOwnProperty(ss[x])){SS_EVAL_PREV[ss[x]]=false;}
lbguidCurr=checkConditions('scroll',ss[x],'',false);if(lbguidCurr&&lbguidCurr.length>0){if(lbguidMatch===''&&!SS_EVAL_PREV[ss[x]]){lbguidMatch=lbguidCurr;}
SS_EVAL_PREV[ss[x]]=true;}else{SS_EVAL_PREV[ss[x]]=false;}}
if(lbguidMatch&&lbguidMatch.length>0){loadLightbox(lbguidMatch);}}
catch(e){logError(e,"checkConditionsScroll");}};function initExitSelectors(){try{if(EXIT_BOXES_ARR.length>0){var mousex=-1;var mousey=-1;var lastmousex=-1;var lastmousey=-1;var lastmousetime;var mousetravel=0;var magnitudex=0;var magnitudey=0;var directionx='';var directiony='';var pageWidth=jqWin.width();var pageHeight=jqWin.height();var yOffset=jqWin.scrollTop();jqDoc.mousemove);jqDoc.mouseleave);jqWin.resize);}}
catch(e){logError(e,"initExitSelectors");}}
var checkConditionsExit=function(){try{if(DIGIOH_LIGHTBOX_MASTER_RULES.AllowMultipleBoxes){var lbguids=checkConditions('exit','','',true);logger("checkConditionsExit:  AllowMultipleBoxes(true) => lbguidsMatched => "+JSON.stringify(lbguids));for(var i=0;i<lbguids.length;i++){if(lbguids[i]&&lbguids[i].length>0){loadLightbox(lbguids[i]);}}}
else{var lbguid=checkConditions('exit','','',false);logger("checkConditionsExit:  AllowMultipleBoxes(false) => lbguidMatched => "+lbguid);if(lbguid&&lbguid.length>0){loadLightbox(lbguid);}}}
catch(e){logError(e,"checkConditionsExit");}};var checkConditionsLoad=function(){try{if(DIGIOH_LIGHTBOX_MASTER_RULES.AllowMultipleBoxes){var lbguids=checkConditions('load','','',true);logger("checkConditionsLoad:  AllowMultipleBoxes(true) => lbguidsMatched => "+JSON.stringify(lbguids));for(var i=0;i<lbguids.length;i++){if(lbguids[i]&&lbguids[i].length>0){loadLightbox(lbguids[i]);}}}
else{var lbguid=checkConditions('load','','',false);logger("checkConditionsLoad:  AllowMultipleBoxes(false) => lbguidMatched => "+lbguid);if(lbguid&&lbguid.length>0){loadLightbox(lbguid);}}}
catch(e){logError(e,"checkConditionsLoad");}};var checkConditionsTime=function(){try{var lbguidCurr='';var lbguidMatch='';var ts=TIME_BOXES_ARR;for(var x=0;x<ts.length;x++){if(!TS_EVAL_PREV.hasOwnProperty(ts[x])){TS_EVAL_PREV[ts[x]]=false;}
lbguidCurr=checkConditions('time',ts[x],'',false);if(lbguidCurr&&lbguidCurr.length>0){if(lbguidMatch===''&&!TS_EVAL_PREV[ts[x]]){lbguidMatch=lbguidCurr;}
TS_EVAL_PREV[ts[x]]=true;}else{TS_EVAL_PREV[ts[x]]=false;}}
if(lbguidMatch&&lbguidMatch.length>0){loadLightbox(lbguidMatch);}}
catch(e){logError(e,"checkConditionsTime");}};function checkConditionsPreloadTeasers(){try{var lbguid='';var var_id='';var foundMatch=false;if(DIGIOH_LIGHTBOX_TEASER_PRELOAD_ARR.length>0||DIGIOH_LIGHTBOX_TEASER_FOLLOW_ME_ARR.length>0){for(var i=0;i<DIGIOH_LIGHTBOX_CONDITIONS.length;i++){foundMatch=false;lbguid=DIGIOH_LIGHTBOX_CONDITIONS[i].lightbox_guid;var_id='';if(LIGHTBOX_TO_VARIATION_MAP.hasOwnProperty(lbguid)){var_id=LIGHTBOX_TO_VARIATION_MAP[lbguid];}
var skipToNext=false;for(var j=0;j<DIGIOH_LIGHTBOX_INLINE_CONDITIONS_ARR.length;j++){if(lbguid===DIGIOH_LIGHTBOX_INLINE_CONDITIONS_ARR[j]){skipToNext=true;break;}else if(var_id&&var_id===DIGIOH_LIGHTBOX_INLINE_CONDITIONS_ARR[j]){skipToNext=true;break;}}
if(!skipToNext){if(var_id.length>10){if(JQUERY_DIGIOH.inArray(var_id,DIGIOH_LIGHTBOX_TEASER_FOLLOW_ME_ARR)>-1){foundMatch=evalConditions(DIGIOH_LIGHTBOX_CONDITIONS[i].conditions,lbguid,DIGIOH_LIGHTBOX_ANALYTICS.VARS,true,true,false);if(foundMatch)
logger('** Opening Follow Me Teaser');}
else if(JQUERY_DIGIOH.inArray(var_id,DIGIOH_LIGHTBOX_TEASER_PRELOAD_ARR)>-1){foundMatch=evalConditions(DIGIOH_LIGHTBOX_CONDITIONS[i].conditions,lbguid,DIGIOH_LIGHTBOX_ANALYTICS.VARS,true,false,false);}}
else{if(JQUERY_DIGIOH.inArray(lbguid,DIGIOH_LIGHTBOX_TEASER_FOLLOW_ME_ARR)>-1){foundMatch=evalConditions(DIGIOH_LIGHTBOX_CONDITIONS[i].conditions,lbguid,DIGIOH_LIGHTBOX_ANALYTICS.VARS,true,true,false);if(foundMatch)
logger('** Opening Follow Me Teaser');}else if(JQUERY_DIGIOH.inArray(lbguid,DIGIOH_LIGHTBOX_TEASER_PRELOAD_ARR)>-1){foundMatch=evalConditions(DIGIOH_LIGHTBOX_CONDITIONS[i].conditions,lbguid,DIGIOH_LIGHTBOX_ANALYTICS.VARS,true,false,false);}}
if(foundMatch){var open_id=lbguid;if(var_id.length>7){open_id=var_id;}
if(EFFECTS[open_id]['widget_type']=='sidebar'){openTeaser(EFFECTS[open_id].sidebar.teaser,open_id);}else if(EFFECTS[open_id]['widget_type']=='fancybox'){openTeaser(EFFECTS[open_id].fancybox.teaser,open_id);}}}}}}
catch(e){logError(e,"checkConditionsPreloadTeasers");}}
function setLightboxDomId(lid){try{if(!LOADED_BOX_DOM_ID_MAP.hasOwnProperty(lid)||LOADED_BOX_DOM_ID_MAP[lid].length<10){LOADED_BOX_DOM_ID_MAP[lid]='lightbox-'+lid+'-'+new Date().getTime();}
return LOADED_BOX_DOM_ID_MAP[lid];}
catch(e){logError(e,"setLightboxDomId");}
return '';}
var getLightboxDomId=function(lid){try{if(LOADED_BOX_DOM_ID_MAP.hasOwnProperty(lid)&&LOADED_BOX_DOM_ID_MAP[lid].length>10){return LOADED_BOX_DOM_ID_MAP[lid];}}
catch(e){logError(e,"getLightboxDomId");}
return '';};var getActiveLightboxDomId=function(){try{if(LOADED_LIGHTBOXES.length>0){return getLightboxDomId(LOADED_LIGHTBOXES[LOADED_LIGHTBOXES.length-1]);}}
catch(e){logError(e,"getActiveLightboxDomId");}
return '';};function preloadLightboxes(){try{if(DIGIOH_LIGHTBOX_PRELOAD_ARR.length>0){for(var x=0;x<DIGIOH_LIGHTBOX_PRELOAD_ARR.length;x++){preloadIframe(DIGIOH_LIGHTBOX_PRELOAD_ARR[x]);}}}
catch(e){logError(e,"preloadLightboxes");}}
function inlineResponsiveResizing(lbid,dom_id,start_time,prev_width,prev_height){try{var current_time=new Date().getTime();var diff_in_millis=current_time-start_time;var new_width=0;var new_height=0;if(JQUERY_DIGIOH('#'+dom_id).length){new_width=JQUERY_DIGIOH('#'+dom_id).width();new_height=JQUERY_DIGIOH('#'+dom_id).height();}
hMax=getResponsiveBoxHeightMax(lbid);hMin=getResponsiveBoxHeightMin(lbid);if(diff_in_millis>300){if(new_height>hMax){new_height=hMax;JQUERY_DIGIOH('#'+dom_id).height(new_height);}
if(new_height<hMin){new_height=hMin;JQUERY_DIGIOH('#'+dom_id).height(new_height);}}
if(new_width!==prev_width||new_height!==prev_height){window.setTimeout(function(){inlineResponsiveResizing(lbid,dom_id,start_time,new_width,new_height);},100);}
else{CURRENT_PAGE_DIMS_RESPONSIVE[lbid]={width:new_width,height:new_height};if(diff_in_millis<1000){sendMessageToIframe({sender:'lightbox',action:'dimensions_changed',widget_type:EFFECTS[lbid].widget_type,width:new_width,height:new_height},lbid);window.setTimeout,100);}else{keepSendingResizeToChildUntilReceived({sender:'lightbox',action:'dimensions_changed',widget_type:EFFECTS[lbid].widget_type,width:new_width,height:new_height},lbid,100,0);}}}
catch(e){logError(e,"inlineResponsiveResizing");}}
function trySetAttribute(dom_id,kvp)
{try
{if(kvp.k==='class')
JQUERY_DIGIOH('#'+dom_id).addClass(kvp.v);else
JQUERY_DIGIOH('#'+dom_id).attr(kvp.k,kvp.v);}
catch(e)
{logError(e,"trySetAttribute");}}
function preloadIframe(lid,inline_style,inline_jquery_selector,inline_jquery_method,inline_clear){try{if(!EFFECTS.hasOwnProperty(lid)){logger("preloadIframe: EFFECTS does not have lid: "+lid);return;}
if(typeof inline_style==='undefined'||inline_style===null)
inline_style='';if(typeof inline_jquery_selector==='undefined'||inline_jquery_selector===null)
inline_jquery_selector='';if(typeof inline_jquery_method==='undefined'||inline_jquery_method===null)
inline_jquery_method='';if(typeof inline_clear==='undefined'||inline_clear===null)
inline_clear='';var isVariation=false;if(DIGIOH_VARIATION_TO_BOX_MAP.hasOwnProperty(lid)){isVariation=true;}else if(LIGHTBOX_TO_VARIATION_MAP.hasOwnProperty(lid)){lid=LIGHTBOX_TO_VARIATION_MAP[lid];isVariation=true;}else if(DIGIOH_PUBLISHED_VARIATIONS_ARR.length>0&&DIGIOH_PUBLISHED_VARIATIONS_ARR.join(',').indexOf(lid)>=0){logger('preloadIframe: Skipping Preload Variation, it is ineligible: '+lid);return;}
if(JQUERY_DIGIOH.inArray(lid,PRELOADED_LIGHTBOXES)==-1||!JQUERY_DIGIOH('#lightbox-iframe-'+lid).length){PRELOADED_LIGHTBOXES.push(lid);logger('preloadIframe: Preload Lightbox Started: '+lid);}else{logger('preloadIframe: Already Preloaded Lightbox: '+lid);return;}
var dom_id=setLightboxDomId(lid);var add_classes='preloaded_lightbox';var pref=getPagePref(lid);var widthAndHeight='';var widthAndHeightInlineResponsive='';var responsiveScale='';var using_custom_iframe=(EFFECTS[lid].hasOwnProperty('iframe')&&EFFECTS[lid]['iframe']['use_custom']);if(using_custom_iframe){widthAndHeight+='width: '+EFFECTS[lid]['iframe']['width']+'px;';widthAndHeight+='height: '+EFFECTS[lid]['iframe']['height']+'px;';add_classes+=' preloaded_custom_iframe';}else{if(EFFECTS[lid].hasOwnProperty(pref+'responsive')&&EFFECTS[lid][pref+'responsive'].use){widthAndHeight+='width: '+getResponsiveBoxWidth(lid)+'px;';widthAndHeight+='height: '+getResponsiveBoxHeight(lid)+'px;';var wMax=getResponsiveBoxWidthMax(lid);var wMin=getResponsiveBoxWidthMin(lid);var hMax=getResponsiveBoxHeightMax(lid);var hMin=getResponsiveBoxHeightMin(lid);widthAndHeightInlineResponsive=";width:"+getResponsiveBoxWidthPercent(lid)+"%;height:"+getResponsiveBoxHeightPercent(lid)+"%;";widthAndHeightInlineResponsive+="max-width:"+wMax+"px;"+"min-width:"+wMin+"px;"+"max-height:"+hMax+"px;"+"min-height:"+hMin+"px;";}else{widthAndHeight+='width: '+getBoxWidth(lid)+'px;';widthAndHeight+='height: '+getBoxHeight(lid)+'px;';responsiveScale=getResponsiveScale(lid);}}
if(EFFECTS[lid]['widget_type']==='fancybox'&&EFFECTS[lid]['fancybox'].hasOwnProperty('css')&&typeof EFFECTS[lid]['fancybox']['css']==='string'&&EFFECTS[lid]['fancybox']['css'].indexOf(':')>0){}
if(EFFECTS[lid]['widget_type']==='fancybox'){var extra_css='';if(EFFECTS[lid]['fancybox'].hasOwnProperty('css')&&typeof EFFECTS[lid]['fancybox']['css']==='string'&&EFFECTS[lid]['fancybox']['css'].indexOf(':')>0){extra_css=EFFECTS[lid]['fancybox']['css'];}
body.append("<div role='dialog' aria-label='Modal Overlay Box' id='"+dom_id+"' class='"+add_classes+"' style='z-index: 9948035; position: fixed; display: none; left: -2000px; top: -2000px; overflow: visible !important; "+widthAndHeight+responsiveScale+extra_css+"'><div title='Close' class='widget_fb_close' style='"+getCloseButtonStyle(EFFECTS[lid].fancybox.close_button,EFFECTS[lid].widget_type,lid)+"' aria-label='Close Modal'></div></div>");JQUERY_DIGIOH('#'+dom_id+' .widget_fb_close').click(function(){IS_LIGHTBOX_CLOSING[lid]=true;JQUERY_DIGIOH.fb_lightbox.close();});}else if(EFFECTS[lid]['widget_type']==='banner'){body.append("<div role='dialog' aria-label='Modal Overlay Box' id='"+dom_id+"' class='"+add_classes+"' style='display: none; "+getBannerPosition(EFFECTS[lid].banner,lid)+"'><div title='Close' class='banner-iframe-close' style='"+getCloseButtonStyle(EFFECTS[lid].banner.close_button,EFFECTS[lid].widget_type,lid)+"' aria-label='Close Banner'></div></div>");}else if(EFFECTS[lid]['widget_type']==='sidebar'){body.append("<div role='dialog' aria-label='Modal Overlay Box' id='"+dom_id+"' class='"+add_classes+"' style='display: none; "+getSidebarPosition(EFFECTS[lid].sidebar,lid)+"'><div title='Close' class='sidebar-iframe-close' style='"+getCloseButtonStyle(EFFECTS[lid].sidebar.close_button,EFFECTS[lid].widget_type,lid)+"' aria-label='Close Modal'></div></div>");}else if(EFFECTS[lid]['widget_type']==='inline'&&inline_style===''){return false;}else if(EFFECTS[lid]['widget_type']==='inline'&&inline_style!==''){if(inline_style.indexOf('position:')===-1){inline_style='position:relative;'+inline_style;}
if(IS_PREVIEW){JQUERY_DIGIOH('body').append('<div role="dialog" aria-label="Inline Form" id="'+dom_id+'" style="'+inline_style+widthAndHeightInlineResponsive+'"></div>');}else if(EFFECTS[lid].inline.position_using=='custom_function'){JQUERY_DIGIOH('body').append('<div role="dialog" aria-label="Inline Form" id="'+dom_id+'" style="'+inline_style+widthAndHeightInlineResponsive+'"></div>');JQUERY_DIGIOH('#'+dom_id).hide();}
else if(inline_jquery_selector===''){JQUERY_DIGIOH('body').append('<div role="dialog" aria-label="Inline Form" id="'+dom_id+'" style="'+inline_style+widthAndHeightInlineResponsive+'"></div>');}else{if(JQUERY_DIGIOH(inline_jquery_selector).length){if(JQUERY_DIGIOH(inline_jquery_selector).length>1){JQUERY_DIGIOH(inline_jquery_selector).eq(0)[inline_jquery_method]('<div role="dialog" aria-label="Inline Form" id="'+dom_id+'" style="'+inline_style+widthAndHeightInlineResponsive+'"></div>'+inline_clear);}else{JQUERY_DIGIOH(inline_jquery_selector)[inline_jquery_method]('<div role="dialog" aria-label="Inline Form" id="'+dom_id+'" style="'+inline_style+widthAndHeightInlineResponsive+'"></div>'+inline_clear);}}else{return false;}}}
if(using_custom_iframe){if(EFFECTS[lid]['iframe']['is_self_hosted']){if(PROTOCOL=='https://'&&EFFECTS[lid]['iframe']['self_hosted_url'].indexOf('http://')==0){CURRENT_IFRAME_SRC="https://"+EFFECTS[lid]['iframe']['self_hosted_url'].substring(7);}else{CURRENT_IFRAME_SRC=EFFECTS[lid]['iframe']['self_hosted_url'];}}else{if(isVariation){if(IS_QA){CURRENT_IFRAME_SRC=__CDNVendorFilesPath+VENDOR_GUID+'/variation/'+lid+'/custom_iframe_qa.html?v='+EFFECTS[lid]['iframe']['html_last_uploaded'];}else if(IS_PREVIEW){CURRENT_IFRAME_SRC=__CDNVendorFilesPath+VENDOR_GUID+'/variation/'+lid+'/custom_iframe_preview.html?v='+EFFECTS[lid]['iframe']['html_last_uploaded'];}else{CURRENT_IFRAME_SRC=__CDNVendorFilesPath+VENDOR_GUID+'/variation/'+lid+'/custom_iframe.html?v='+EFFECTS[lid]['iframe']['html_last_uploaded'];}}else{if(IS_QA){CURRENT_IFRAME_SRC=__CDNVendorFilesPath+VENDOR_GUID+'/lightbox/'+lid+'/custom_iframe_qa.html?v='+EFFECTS[lid]['iframe']['html_last_uploaded'];}else if(IS_PREVIEW){CURRENT_IFRAME_SRC=__CDNVendorFilesPath+VENDOR_GUID+'/lightbox/'+lid+'/custom_iframe_preview.html?v='+EFFECTS[lid]['iframe']['html_last_uploaded'];}else{CURRENT_IFRAME_SRC=__CDNVendorFilesPath+VENDOR_GUID+'/lightbox/'+lid+'/custom_iframe.html?v='+EFFECTS[lid]['iframe']['html_last_uploaded'];}}}
JQUERY_DIGIOH('#'+dom_id).append("<iframe tabindex='1' aria-label='Modal Overlay Box Frame' title='Modal Overlay Box Frame' src="+CURRENT_IFRAME_SRC+" width='"+getBoxWidth(lid)+"' height='"+getBoxHeight(lid)+"' frameborder='0' scrolling='no'></iframe>");if(JQUERY_DIGIOH.inArray(lid,PRELOADED_LIGHTBOXES_LOADED)==-1){PRELOADED_LIGHTBOXES_LOADED.push(lid);}}else{loadLightningIframe(lid,dom_id);if(EFFECTS[lid]['widget_type']==='inline'){keepSendingEventNotificationToChildUntilReceived({sender:'lightbox',action:'before_lightbox_display'},lid,100,0);if(EFFECTS[lid].hasOwnProperty(pref+'responsive')&&EFFECTS[lid][pref+'responsive'].use){inlineResponsiveResizing(lid,dom_id,(new Date().getTime()),0,0);}}}
if(EFFECTS[lid]['widget_type']&&EFFECTS[lid].hasOwnProperty(EFFECTS[lid]['widget_type'])&&EFFECTS[lid][EFFECTS[lid]['widget_type']].hasOwnProperty('metadata_kvps'))
{var kvps=EFFECTS[lid][EFFECTS[lid]['widget_type']].metadata_kvps;for(var k=0;k<kvps.length;k++)
{if(kvps[k].k&&kvps[k].v)
{trySetAttribute(dom_id,kvps[k]);}}}
if(EFFECTS[lid]['widget_type']==='inline'&&inline_style!==''&&EFFECTS[lid].inline.position_using==='custom_function'){if(!isVariation&&DIGIOH_LIGHTBOX_IDS.hasOwnProperty(lid)&&DIGIOH_CUSTOM_JS.hasOwnProperty('InlineLightboxFormPositionCustomFunction_'+DIGIOH_LIGHTBOX_IDS[lid])){DIGIOH_CUSTOM_JS['InlineLightboxFormPositionCustomFunction_'+DIGIOH_LIGHTBOX_IDS[lid]](window,document,JQUERY_DIGIOH,lid,dom_id,inline_style);}
else if(isVariation&&DIGIOH_LIGHTBOX_IDS.hasOwnProperty(lid)&&DIGIOH_CUSTOM_JS.hasOwnProperty('InlineLightboxFormPositionCustomFunction_VAR_'+DIGIOH_LIGHTBOX_IDS[lid])){DIGIOH_CUSTOM_JS['InlineLightboxFormPositionCustomFunction_VAR_'+DIGIOH_LIGHTBOX_IDS[lid]](window,document,JQUERY_DIGIOH,lid,dom_id,inline_style);}}
return true;}
catch(e){logError(e,"preloadIframe");return false;}}
var shouldSuppressLightbox=function(lbid){try{if(typeof DIGIOH_VENDOR_SHORT_ID!=='undefined'&&DIGIOH_VENDOR_SHORT_ID){var dvsi=parseInt(DIGIOH_VENDOR_SHORT_ID);if((dvsi>40969&&dvsi<=40980&&dvsi!=40971)||dvsi==40774||dvsi==40884||dvsi==41391||dvsi==41763||dvsi==41758||dvsi==41688||dvsi==30575){if(DIGIOH_COOKIE.get('__bxsuppress',true)){logger('SUPPRESSION_POLICY ==> __bxsuppress cookie found, preventing lightbox display: '+lbid);return true;}
DIGIOH_COOKIE.set('__bxsuppress','1',1/48);logger('SUPPRESSION_POLICY ==> __bxsuppress cookie set, strictly preventing any non-inline boxes from displaying for the next 30 mins!');}}}
catch(e){logError(e,"shouldSuppressLightbox");}
return false;};var loadLightbox=function(lbid,force){try{if(typeof lbid!=='string'||lbid.length<20){return false;}else if(!checkLightboxMasterRules()){logger('DIGIOH: checkLightboxMasterRules() called from loadLightbox() - prevented display - '+lbid);return false;}else if(isActiveBox(lbid)){logger('DIGIOH: isActiveBox() called from loadLightbox() - prevented display - '+lbid);return false;}
if(typeof force==='undefined'){force=false;}
if(!force&&!DIGIOH_LIGHTBOX_MASTER_RULES.AllowMultipleBoxes&&LOADED_LIGHTBOXES.length>0){for(var i=0;i<LOADED_LIGHTBOXES.length;i++){var bidtmp=LOADED_LIGHTBOXES[i];if(EFFECTS.hasOwnProperty(bidtmp)&&EFFECTS[bidtmp].hasOwnProperty('widget_type')&&EFFECTS[bidtmp].widget_type!=='inline'){logger('DIGIOH: DIGIOH_LIGHTBOX_MASTER_RULES.AllowMultipleBoxes == false (prevented multi display of '+lbid+')'+' (found another active non-inline box '+EFFECTS[bidtmp].widget_type+' '+bidtmp+')');return false;}}}
var var_id='';var orig_lid=lbid;if(DIGIOH_VARIATION_TO_BOX_MAP.hasOwnProperty(lbid)){orig_lid=DIGIOH_VARIATION_TO_BOX_MAP[lbid];var_id=lbid;}else if(LIGHTBOX_TO_VARIATION_MAP.hasOwnProperty(lbid)){var_id=LIGHTBOX_TO_VARIATION_MAP[lbid];}
if(var_id!==''&&var_id.length>7){lbid=var_id;}
if(!IS_PREVIEW||IS_DEV){if(!isInlineLightbox(lbid)){if(shouldSuppressLightbox(lbid)){return false;}else{var customJsSuperResult=DIGIOH_CUSTOM_JS_SUPER.runCustomJsBeforeLightboxDisplay(window.DIGIOH_API,window,document,JQUERY_DIGIOH,orig_lid,var_id,getCustomJsMetadata(orig_lid));logger('JS_GLOBAL.runCustomJsBeforeLightboxDisplay - '+lbid);if(!customJsSuperResult){logger('JS_GLOBAL.runCustomJsBeforeLightboxDisplay - prevented lightbox '+lbid+' from being displayed');return false;}
var customJsResult=DIGIOH_CUSTOM_JS.runCustomJsBeforeLightboxDisplay(window.DIGIOH_API,window,document,JQUERY_DIGIOH,orig_lid,var_id,getCustomJsMetadata(orig_lid));logger('JS_PARENT.runCustomJsBeforeLightboxDisplay - '+lbid);if(!customJsResult){logger('JS_PARENT.runCustomJsBeforeLightboxDisplay - prevented lightbox '+lbid+' from being displayed');return false;}}}}
addActiveBox(lbid);if(EFFECTS.hasOwnProperty(lbid)&&EFFECTS[lbid].hasOwnProperty('iframe')&&EFFECTS[lbid]['iframe']['use_custom']){EFFECTS[lbid].width=EFFECTS[lbid]['iframe']['width'];EFFECTS[lbid].height=EFFECTS[lbid]['iframe']['height'];}
if(JQUERY_DIGIOH.inArray(lbid,PRELOADED_LIGHTBOXES)>-1){tryShowPreloadedLightbox(lbid);}else{preloadIframe(lbid);tryShowPreloadedLightbox(lbid);}}
catch(e){logError(e,"loadLightbox");}};var addActiveBox=function(lid){try{if(JQUERY_DIGIOH.inArray(lid,LOADED_LIGHTBOXES)===-1){LOADED_LIGHTBOXES.push(lid);}}
catch(e){logError(e,"addActiveBox");}};var removeActiveBox=function(lid){try{if(JQUERY_DIGIOH.inArray(lid,LOADED_LIGHTBOXES)>=0){LOADED_LIGHTBOXES.splice(JQUERY_DIGIOH.inArray(lid,LOADED_LIGHTBOXES),1);logger('removeActiveBox: LOADED_LIGHTBOXES - '+lid);logger(LOADED_LIGHTBOXES);}}
catch(e){logError(e,"removeActiveBox");}};function setPixelThreshold(lid,force_update){try{if(!DIGIOH_API||!DIGIOH_API.LIGHTBOX)
return false;if(!DIGIOH_API.LIGHTBOX.hasOwnProperty('PixelThresholdSettings'))
DIGIOH_API.LIGHTBOX.PixelThresholdSettings={};if(!DIGIOH_API.LIGHTBOX.PixelThresholdSettings.hasOwnProperty(lid))
DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid]='';if(typeof force_update==='undefined'||!force_update){if(typeof DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid]==='object'){return false;}}
var existingThreshold='';if(typeof DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid]==='object'){if(DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid].hasOwnProperty('pixel_version')){existingThreshold=DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid]['pixel_version'];}}
var foundMatch=false;if(typeof DIGIOH_PIXEL_THRESHOLDS==='object'){var ptArr=[];if(DIGIOH_PIXEL_THRESHOLDS.hasOwnProperty(lid)){for(var prop in DIGIOH_PIXEL_THRESHOLDS[lid]){if(DIGIOH_PIXEL_THRESHOLDS[lid].hasOwnProperty(prop)){if(JQUERY_DIGIOH.inArray(parseInt(prop),ptArr)===-1){ptArr.push(parseInt(prop));}}}}
if(ptArr.length>0){ptArr.sort);var winWidth=JQUERY_DIGIOH(window).width();if(isMobile()||isTablet())
{winWidth=getiOSWindowWidth();}
for(var i=0;i<ptArr.length;i++){if(ptArr[i]>winWidth){DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid]=DIGIOH_PIXEL_THRESHOLDS[lid][ptArr[i].toString()];foundMatch=true;logger('DIGIOH_API.LIGHTBOX.PixelThresholdSettings['+lid+'] - foundMatch '+ptArr[i]);break;}}}}
if(!foundMatch&&DIGIOH_API.DIGIOH_LIGHTBOX_SETTINGS.hasOwnProperty(lid)){if(typeof DIGIOH_API.DIGIOH_LIGHTBOX_SETTINGS[lid]==='string'&&DIGIOH_API.DIGIOH_LIGHTBOX_SETTINGS[lid].indexOf('{')<0){DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid]=JSON.parse(DIGIOH_API.LIGHTBOX.LZString.decompressFromBase64(DIGIOH_API.DIGIOH_LIGHTBOX_SETTINGS[lid]));}else if(typeof DIGIOH_API.DIGIOH_LIGHTBOX_SETTINGS[lid]==='string'&&DIGIOH_API.DIGIOH_LIGHTBOX_SETTINGS[lid].indexOf('{')>=0){DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid]=JSON.parse(DIGIOH_API.DIGIOH_LIGHTBOX_SETTINGS[lid]);}else{DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid]=DIGIOH_API.DIGIOH_LIGHTBOX_SETTINGS[lid];}
logger('DIGIOH_API.LIGHTBOX.PixelThresholdSettings['+lid+'] - original');}
if(EFFECTS.hasOwnProperty(lid)&&DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid]){if(DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid].hasOwnProperty('iframe')){EFFECTS[lid].iframe=DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid].iframe;}
var pref='';for(var i=1;i<=102;i++){if(i==1)
{pref='';}
else if(i==2)
{pref='thx';}
else if(i>=3&&i<=6)
{pref='ep'+(i-2);}
else if(i>=7)
{pref='ep'+(i-2);if(!DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid].hasOwnProperty(pref+'layout'))
{continue;}}
if(DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid].hasOwnProperty(pref+'layout'))
{EFFECTS[lid][pref+'width']=DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid][pref+'layout'].width;EFFECTS[lid][pref+'height']=DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid][pref+'layout'].height;}
if(DIGIOH_USE_RESPONSIVE&&DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid].hasOwnProperty(pref+'responsive')&&DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid][pref+'responsive'].use){EFFECTS[lid][pref+'responsive']={};EFFECTS[lid][pref+'responsive'].use=DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid][pref+'responsive'].use;EFFECTS[lid][pref+'responsive'].box_width=DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid][pref+'responsive'].box_width;EFFECTS[lid][pref+'responsive'].box_height=DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid][pref+'responsive'].box_height;EFFECTS[lid][pref+'responsive'].width_max=DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid][pref+'responsive'].width_max;EFFECTS[lid][pref+'responsive'].width_min=DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid][pref+'responsive'].width_min;EFFECTS[lid][pref+'responsive'].height_max=DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid][pref+'responsive'].height_max;EFFECTS[lid][pref+'responsive'].height_min=DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid][pref+'responsive'].height_min;}
else{if(DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid].hasOwnProperty(pref+'responsive')){EFFECTS[lid][pref+'responsive']={};EFFECTS[lid][pref+'responsive'].use=DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid][pref+'responsive'].use;}
if(DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid].hasOwnProperty(pref+'scaling')){EFFECTS[lid][pref+'scaling']={};for(var prop2 in DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid][pref+'scaling']){if(DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid][pref+'scaling'].hasOwnProperty(prop2)){EFFECTS[lid][pref+'scaling'][prop2]=DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid][pref+'scaling'][prop2];}}}}}}
var newThreshold='';if(typeof DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid]==='object'){if(DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid].hasOwnProperty('pixel_version')){newThreshold=DIGIOH_API.LIGHTBOX.PixelThresholdSettings[lid]['pixel_version'];}}
return(existingThreshold!==newThreshold);}
catch(e){logError(e,"setPixelThreshold");return false;}}
function showPreloadedLightbox(lbid){try{keepSendingEventNotificationToChildUntilReceived({sender:'lightbox',action:'before_lightbox_display'},lbid,100,0);if(EFFECTS[lbid].widget_type==="fancybox"){initFancybox(lbid,true);}else if(EFFECTS[lbid].widget_type==="sidebar"){showPreloadedSidebar(lbid);}else if(EFFECTS[lbid].widget_type==="banner"){showPreloadedBanner(lbid);}}
catch(e){logError(e,"showPreloadedLightbox");}}
function showPreloadedSidebar(lid){try{SIDEBAR_CLOSE_MAP[lid]=0;var dom_id=getLightboxDomId(lid);if(dom_id!=''&&JQUERY_DIGIOH('#'+dom_id).length){var ele=JQUERY_DIGIOH('#'+dom_id);ele.attr('style',getSidebarPosition(EFFECTS[lid].sidebar,lid));showSidebar(lid);}else{initSidebar(lid);}}
catch(e){logError(e,"showPreloadedSidebar");}}
function showPreloadedBanner(lid){try{BANNER_CLOSE_MAP[lid]=0;var dom_id=getLightboxDomId(lid);if(dom_id!=''&&JQUERY_DIGIOH('#'+dom_id).length){var ele=JQUERY_DIGIOH('#'+dom_id);ele.attr('style',getBannerPosition(EFFECTS[lid].banner,lid));showBanner(lid);}else{initBanner(lid);}}
catch(e){logError(e,"showPreloadedBanner");}}
function showLightbox(lbid){try{if(EFFECTS[lbid].widget_type==="fancybox"){initFancybox(lbid,false);}else if(EFFECTS[lbid].widget_type==="sidebar"){initSidebar(lbid);}else if(EFFECTS[lbid].widget_type==="banner"){initBanner(lbid);}}
catch(e){logError(e,"showLightbox");}}
function initSidebar(lid){try{var dom_id=setLightboxDomId(lid);if(JQUERY_DIGIOH('#'+dom_id).length){showSidebar(lid);}else{body.append("<div id='"+dom_id+"' style='"+getSidebarPosition(EFFECTS[lid].sidebar,lid)+"'><div title='Close' class='sidebar-iframe-close' style='"+getCloseButtonStyle(EFFECTS[lid].sidebar.close_button,EFFECTS[lid].widget_type,lid)+"' aria-label='Close Modal'></div></div>");loadLightningIframe(lid,dom_id);if(EFFECTS[lid].hasOwnProperty('iframe')&&EFFECTS[lid]['iframe']['use_custom']){showSidebar(lid);}}}
catch(e){logError(e,"initSidebar");}}
function initBanner(lid){try{var dom_id=setLightboxDomId(lid);if(JQUERY_DIGIOH('#'+dom_id).length){showBanner(lid);}else{body.append("<div id='"+dom_id+"' style='"+getBannerPosition(EFFECTS[lid].sidebar,lid)+"'><div title='Close' class='sidebar-iframe-close' style='"+getCloseButtonStyle(EFFECTS[lid].banner.close_button,EFFECTS[lid].widget_type,lid)+"' aria-label='Close Banner'></div></div>");loadLightningIframe(lid,dom_id);if(EFFECTS[lid].hasOwnProperty('iframe')&&EFFECTS[lid]['iframe']['use_custom']){showBanner(lid);}}}
catch(e){logError(e,"initBanner");}}
function showBanner(lid){try{BANNER_CLOSE_MAP[lid]=0;var dom_id=getLightboxDomId(lid);JQUERY_DIGIOH('#'+dom_id+' .banner-iframe-close').click(function(){closeBanner(lid);});if(EFFECTS[lid].banner.close_button.display){JQUERY_DIGIOH('#'+dom_id+' .banner-iframe-close').css({'display':'block'});}
if(!EFFECTS[lid].banner.hasOwnProperty('placement')||EFFECTS[lid].banner.placement!=='bottom'){if(EFFECTS[lid].banner.page_overlap==='move'){var banner_height=getActualBoxWidthAndHeight(lid).height;JQUERY_DIGIOH('body').prepend("<div id='banner-spacer-"+lid+"' style='width:100%; height:"+banner_height+"px;'></div>");}}
var ele=JQUERY_DIGIOH('#'+dom_id);ele.attr('style',getBannerPosition(EFFECTS[lid].banner,lid));ele.show();registerLightboxShow(lid);registerMobileSidebarToLightboxConversion(lid,dom_id);}
catch(e){logError(e,"showBanner");}}
function showSidebar(lid){try{SIDEBAR_CLOSE_MAP[lid]=0;var dom_id=getLightboxDomId(lid);JQUERY_DIGIOH('#'+dom_id+' .sidebar-iframe-close').click);if(effectsHasTeaserDisplaySidebar(lid)){closeTeaser(EFFECTS[lid].sidebar.teaser,lid,false);}
if(EFFECTS[lid].sidebar.close_button.display){JQUERY_DIGIOH('#'+dom_id+' .sidebar-iframe-close').css({'display':'block'});}
if(EFFECTS[lid].sidebar.position==='center-center'){JQUERY_DIGIOH('body').css({'overflow-y':'hidden'});}
var oa=getOpenAnimation(EFFECTS[lid].sidebar,lid);if(EFFECTS[lid].sidebar.hasOwnProperty('overlay')&&EFFECTS[lid].sidebar.overlay&&(EFFECTS[lid].sidebar.overlay.background.use_image||EFFECTS[lid].sidebar.overlay.background.color!=='rgba(255, 255, 255, 0)')){JQUERY_DIGIOH('body').append("<div id='sidebar-overlay-"+dom_id+"' class='fb_lightbox-overlay fb_lightbox-overlay-fixed'></div>");var bg=getBackgroundStyle(EFFECTS[lid].sidebar.overlay.background);bg['display']='block';JQUERY_DIGIOH("#sidebar-overlay-"+dom_id).css(bg);}
if(!oa){oa={};var ele=JQUERY_DIGIOH('#'+dom_id);ele.attr('style',getSidebarPosition(EFFECTS[lid].sidebar,lid));ele.show();setBoxToScrollMode(lid,'main','display');registerLightboxShow(lid);registerCloseSidebarClick(lid);registerCloseSidebarScroll(lid);registerCloseSidebarTime(lid);}else{logger('DIGIOH: getOpenAnimation...');logger(oa);JQUERY_DIGIOH('#'+dom_id).show().animate(oa,{duration:EFFECTS[lid].sidebar.speed.open,easing:EFFECTS[lid].sidebar.easing.open,complete});}}
catch(e){logError(e,"showSidebar");}}
function registerMobileSidebarToLightboxConversion(lid,dom_id){try{if(!MOBILE_SCROLL_TOP_MAP.hasOwnProperty(lid)&&isMobile()){MOBILE_SCROLL_TOP_MAP[lid]=Math.round(jqWin.scrollTop());var ele=JQUERY_DIGIOH('#'+dom_id);var origStyle='';JQUERY_DIGIOH('#lightbox-iframe-'+lid).contents().find('input').each);}}
catch(e){logError(e,"registerMobileSidebarToLightboxConversion");}}
function getMobileSidebarToLightboxConversionPositionCss(lid,position_type){try{var css_top='';var css_left='';var css_margin_left='';var jqW=jqWin.width();var jqH=jqWin.height();var winW=window.innerWidth||jqW;var winH=window.innerHeight||jqH;var scrollTop=jqWin.scrollTop();var scrollLeft=jqWin.scrollLeft();var hasScrollbar=true;var isPortrait=true;if(winH>winW){isPortrait=true;if(winH-jqH<=10){winH=Math.round(winH*52/94);hasScrollbar=true;}else{winH=Math.round(winH*55/97);hasScrollbar=false;}}else{isPortrait=false;if(jqH-winH<=10){winH=Math.round(winH*24/58);hasScrollbar=false;}else{winH=Math.round(winH*18/51);hasScrollbar=true;}}
if(typeof position_type!=='string'||position_type!=='absolute'){position_type='fixed';}else{position_type='absolute';}
css_top=(Math.round(scrollTop)+20+'px');if((getBoxWidth(lid)+20)>=winW){if(scrollLeft>0){css_left=Math.round(scrollLeft)+10+'px';}else{css_left='10px';}}else{if(scrollLeft>0){css_left=Math.round(scrollLeft)+Math.round(winW/2)-Math.round(getBoxWidth(lid)/2)+'px';}else{css_left=Math.round(winW/2)-Math.round(getBoxWidth(lid)/2)+'px';}}
position_type='absolute';css_margin_left='0px';var css_obj={'top':css_top,'left':css_left,'width':(getBoxWidth(lid)+'px'),'height':(getBoxHeight(lid)+'px')};var style_attr="position: absolute; z-index: 9948030; top: "+css_top+"; left: "+css_left+"; width: "+getBoxWidth(lid)+"px; height: "+getBoxHeight(lid)+"px;";return style_attr;}
catch(e){logError(e,"getMobileSidebarToLightboxConversionPositionCss");}}
function setIframeSrc(lid,is_preload){try{if(typeof is_preload!=="undefined"&&is_preload)is_preload=true;else is_preload=false;if(DIGIOH_VARIATION_TO_BOX_MAP.hasOwnProperty(lid)){isVariation=true;}else if(LIGHTBOX_TO_VARIATION_MAP.hasOwnProperty(lid)){lid=LIGHTBOX_TO_VARIATION_MAP[lid];isVariation=true;}
if(EFFECTS[lid].hasOwnProperty('iframe')&&EFFECTS[lid]['iframe']['use_custom']){if(EFFECTS[lid]['iframe']['is_self_hosted']){if(PROTOCOL=='https://'&&EFFECTS[lid]['iframe']['self_hosted_url'].indexOf('http://')==0){CURRENT_IFRAME_SRC="https://"+EFFECTS[lid]['iframe']['self_hosted_url'].substring(7);}else{CURRENT_IFRAME_SRC=EFFECTS[lid]['iframe']['self_hosted_url'];}}else{if(isVariation){if(IS_QA){CURRENT_IFRAME_SRC=__CDNVendorFilesPath+VENDOR_GUID+'/variation/'+lid+'/custom_iframe_qa.html?v='+EFFECTS[lid]['iframe']['html_last_uploaded'];}else if(IS_PREVIEW){CURRENT_IFRAME_SRC=__CDNVendorFilesPath+VENDOR_GUID+'/variation/'+lid+'/custom_iframe_preview.html?v='+EFFECTS[lid]['iframe']['html_last_uploaded'];}else{CURRENT_IFRAME_SRC=__CDNVendorFilesPath+VENDOR_GUID+'/variation/'+lid+'/custom_iframe.html?v='+EFFECTS[lid]['iframe']['html_last_uploaded'];}}else{if(IS_QA){CURRENT_IFRAME_SRC=__CDNVendorFilesPath+VENDOR_GUID+'/lightbox/'+lid+'/custom_iframe_qa.html?v='+EFFECTS[lid]['iframe']['html_last_uploaded'];}else if(IS_PREVIEW){CURRENT_IFRAME_SRC=__CDNVendorFilesPath+VENDOR_GUID+'/lightbox/'+lid+'/custom_iframe_preview.html?v='+EFFECTS[lid]['iframe']['html_last_uploaded'];}else{CURRENT_IFRAME_SRC=__CDNVendorFilesPath+VENDOR_GUID+'/lightbox/'+lid+'/custom_iframe.html?v='+EFFECTS[lid]['iframe']['html_last_uploaded'];}}}}else{if(IS_DEV)CURRENT_IFRAME_SRC=__CDNStaticFilesPath+'lightbox_dev.html?';else CURRENT_IFRAME_SRC=__CDNStaticFilesPath+'lightbox.html?';CURRENT_IFRAME_SRC+='wt='+EFFECTS[lid]['widget_type'];CURRENT_IFRAME_SRC+='&se='+(SHOW_ERRORS?'1':'0');CURRENT_IFRAME_SRC+='&prev='+(IS_PREVIEW?'1':'0');CURRENT_IFRAME_SRC+='&vid='+VENDOR_GUID;CURRENT_IFRAME_SRC+='&lid='+lid;CURRENT_IFRAME_SRC+='&is_var='+(isVariation?'1':'0');CURRENT_IFRAME_SRC+='&purl='+window.location.host;if(DIGIOH_CACHE_VERSION){CURRENT_IFRAME_SRC+='&cb='+DIGIOH_CACHE_VERSION;}else{CURRENT_IFRAME_SRC+='&cb='+(new Date().getTime());}}}
catch(e){logError(e,"setIframeSrc");}}
function getCustomJsMetadata(lid){var S={};try{if(typeof DIGIOH_CACHE_VERSION==='undefined'){DIGIOH_CACHE_VERSION=(new Date().getTime());}
S.protocol=(PROTOCOL||"https://");S.protocol_user_override=(PROTOCOL_USER_OVERRIDE||"https://");S.cache_version=DIGIOH_CACHE_VERSION;S.parent_url=PROTOCOL+window.location.host;S.full_url=window.location.href.split("'").join("%27")||'';S.use_bugsnag=(typeof DIGIOH_USE_BUGSNAG!=='undefined'&&DIGIOH_USE_BUGSNAG);S.use_console=SHOW_ERRORS;S.is_preview=IS_PREVIEW;S.is_qa=IS_QA;S.user_id=VENDOR_GUID;S.user_guid=VENDOR_GUID;S.user_short_id=DIGIOH_VENDOR_SHORT_ID;S.vendor_id=VENDOR_GUID;S.vendor_guid=VENDOR_GUID;S.vendor_short_id=DIGIOH_VENDOR_SHORT_ID;S.client_id=CLIENT_GUID;S.client_guid=CLIENT_GUID;S.is_desktop=isDesktop();S.is_phone=isPhone();S.is_tablet=isTablet();S.is_mobile=isMobile();if(typeof lid==='string'&&lid.length>20){var isVariation=false;var actual_lid=lid;var var_id='';if(DIGIOH_VARIATION_TO_BOX_MAP.hasOwnProperty(lid)){var_id=lid;actual_lid=DIGIOH_VARIATION_TO_BOX_MAP[lid];isVariation=true;}else if(LIGHTBOX_TO_VARIATION_MAP.hasOwnProperty(lid)){var_id=LIGHTBOX_TO_VARIATION_MAP[lid];actual_lid=lid;isVariation=true;lid=var_id;}
var split_guid='';var split_short_id='';var split_name='';if(var_id.length>7&&AB_BOXES_TAKE_MAP.hasOwnProperty(var_id)){split_guid=AB_BOXES_TAKE_MAP[var_id];}else if(AB_BOXES_TAKE_MAP.hasOwnProperty(actual_lid)){split_guid=AB_BOXES_TAKE_MAP[actual_lid];}
if(split_guid!=''){for(var i=0;i<DIGIOH_SPLIT_TESTS_ARR.length;i++){if(DIGIOH_SPLIT_TESTS_ARR[i].split_guid==split_guid){split_short_id=DIGIOH_SPLIT_TESTS_ARR[i].split_short_id;split_name=DIGIOH_SPLIT_TESTS_ARR[i].name;break;}}}
var widget_type='';var lightbox_name='';var variation_name='';var lightbox_short_id='';var variation_short_id='';if(var_id&&EFFECTS.hasOwnProperty(var_id)){widget_type=EFFECTS[var_id].widget_type;}else if(EFFECTS.hasOwnProperty(actual_lid)){widget_type=EFFECTS[actual_lid].widget_type;}
if(DIGIOH_LIGHTBOX_NAMES.hasOwnProperty(actual_lid)){lightbox_name=DIGIOH_LIGHTBOX_NAMES[actual_lid];}
if(DIGIOH_LIGHTBOX_NAMES.hasOwnProperty(var_id)){variation_name=DIGIOH_LIGHTBOX_NAMES[var_id];}
if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(actual_lid)){lightbox_short_id=DIGIOH_LIGHTBOX_IDS[actual_lid];}
if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(var_id)){variation_short_id=DIGIOH_LIGHTBOX_IDS[var_id];}
var varIdOrLid="";if(isVariation&&var_id){varIdOrLid=var_id;}else{varIdOrLid=lid;}
lightbox_or_variation_guid=(isVariation?var_id:actual_lid);S.widget_type=widget_type;S.lightbox_id=actual_lid;S.lightbox_guid=actual_lid;S.lightbox_short_id=lightbox_short_id;S.lightbox_name=lightbox_name;S.variation_id=var_id;S.variation_guid=var_id;S.variation_short_id=variation_short_id;S.variation_name=variation_name;S.is_variation=isVariation;S.ab_test_id=split_guid;S.ab_test_guid=split_guid;S.ab_test_short_id=split_short_id;S.ab_test_name=split_name;S.lightbox_or_variation_id=lightbox_or_variation_guid;S.lightbox_or_variation_guid=lightbox_or_variation_guid;S.lightbox_or_variation_short_id=(isVariation?variation_short_id:lightbox_short_id);S.lightbox_or_variation_name=(isVariation?variation_name:lightbox_name);}}
catch(e){logError(e,"getCustomJsMetadata");}
return S;}
function loadLightningIframe(lid,append_to_element_id){try
{var isVariation=false;var actual_lid=lid;var var_id='';if(DIGIOH_VARIATION_TO_BOX_MAP.hasOwnProperty(lid))
{var_id=lid;actual_lid=DIGIOH_VARIATION_TO_BOX_MAP[lid];isVariation=true;}else if(LIGHTBOX_TO_VARIATION_MAP.hasOwnProperty(lid))
{var_id=LIGHTBOX_TO_VARIATION_MAP[lid];actual_lid=lid;isVariation=true;lid=var_id;}
var split_guid='';var split_short_id='';var split_name='';if(var_id.length>7&&AB_BOXES_TAKE_MAP.hasOwnProperty(var_id))
{split_guid=AB_BOXES_TAKE_MAP[var_id];}else if(AB_BOXES_TAKE_MAP.hasOwnProperty(actual_lid))
{split_guid=AB_BOXES_TAKE_MAP[actual_lid];}
if(split_guid!='')
{for(var i=0;i<DIGIOH_SPLIT_TESTS_ARR.length;i++)
{if(DIGIOH_SPLIT_TESTS_ARR[i].split_guid==split_guid)
{split_short_id=DIGIOH_SPLIT_TESTS_ARR[i].split_short_id;split_name=DIGIOH_SPLIT_TESTS_ARR[i].name;break;}}}
var widget_type='';var lightbox_name='';var variation_name='';var lightbox_short_id='';var variation_short_id='';if(var_id&&EFFECTS.hasOwnProperty(var_id))
{widget_type=EFFECTS[var_id].widget_type;}else if(EFFECTS.hasOwnProperty(actual_lid))
{widget_type=EFFECTS[actual_lid].widget_type;}
if(DIGIOH_LIGHTBOX_NAMES.hasOwnProperty(actual_lid))
{lightbox_name=DIGIOH_LIGHTBOX_NAMES[actual_lid];}
if(DIGIOH_LIGHTBOX_NAMES.hasOwnProperty(var_id))
{variation_name=DIGIOH_LIGHTBOX_NAMES[var_id];}
if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(actual_lid))
{lightbox_short_id=DIGIOH_LIGHTBOX_IDS[actual_lid];}
if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(var_id))
{variation_short_id=DIGIOH_LIGHTBOX_IDS[var_id];}
var iframe_id='lightbox-iframe-'+lid;var iframe_position='absolute';if(isMobile())
{if(widget_type==='inline')
{iframe_position='absolute';}else
{iframe_position='relative';}}
var settingsFile="";var varIdOrLid="";if(isVariation&&var_id)
{settingsFile+="/variation/"+var_id;varIdOrLid=var_id;}else
{settingsFile+="/lightbox/"+lid;varIdOrLid=lid;}
if(IS_QA)
{settingsFile+="/settings_qa.js";}else if(IS_PREVIEW)
{settingsFile+="/settings_preview.js";}else
{settingsFile+="/settings.js";}
if(typeof DIGIOH_CACHE_VERSION==='undefined')
{DIGIOH_CACHE_VERSION=(new Date().getTime());}
if(!window.DIGIOH_API.DIGIOH_LIGHTBOX_SETTINGS.hasOwnProperty(varIdOrLid))
{JQUERY_DIGIOH.ajax({url:PROTOCOL_USER_OVERRIDE+
'www.lightboxcdn.com/vendor/'+
VENDOR_GUID+
settingsFile+
'?cb='+
DIGIOH_CACHE_VERSION,crossDomain:true,dataType:"script",cache:true});}else
{logger('settings.js already preloaded for '+varIdOrLid);}
var iframe_title=lightbox_name;if(iframe_title===''||!iframe_title)
iframe_title=variation_name;if(iframe_title===''||!iframe_title)
iframe_title='Lightbox Screen Overlay';iframe_title=iframe_title.split('"').join('').split("'").join("");if(VENDOR_GUID==='dba8d2cd-9f97-474d-bcb6-8dcb112e4a49'&&!IS_PREVIEW)
{var boxParams='';boxParams+="PROTOCOL="+(PROTOCOL||"https://")+"";boxParams+="|||PROTOCOL_USER_OVERRIDE="+(PROTOCOL_USER_OVERRIDE||"https://")+"";boxParams+="|||WIDGET_TYPE="+widget_type+"";boxParams+="|||CACHE_VERSION="+DIGIOH_CACHE_VERSION+"";boxParams+="|||PARENT_URL="+PROTOCOL+window.location.host+"";boxParams+="|||FULL_URL="+window.location.href.split("'").join("%27")+"";boxParams+="|||IS_PRODUCTION="+(IS_DEV?'false':'true')+"";boxParams+="|||IS_PREVIEW="+(IS_PREVIEW?'true':'false')+"";boxParams+="|||SHOW_ERRORS="+(SHOW_ERRORS?'true':'false')+"";boxParams+="|||IS_IE_9_OR_LESS=false";boxParams+="|||VENDOR_GUID="+VENDOR_GUID+"";boxParams+="|||VENDOR_SHORT_ID="+DIGIOH_VENDOR_SHORT_ID+"";boxParams+="|||CLIENT_GUID="+CLIENT_GUID+"";boxParams+="|||LIGHTBOX_GUID="+actual_lid+"";boxParams+="|||LIGHTBOX_SHORT_ID="+lightbox_short_id+"";boxParams+="|||LIGHTBOX_NAME="+lightbox_name+"";boxParams+="|||VARIATION_GUID="+var_id+"";boxParams+="|||VARIATION_SHORT_ID="+variation_short_id+"";boxParams+="|||VARIATION_NAME="+variation_name+"";boxParams+="|||IS_VARIATION="+isVariation.toString().toLowerCase()+"";boxParams+="|||AB_TEST_GUID="+split_guid+"";boxParams+="|||AB_TEST_SHORT_ID="+split_short_id+"";boxParams+="|||AB_TEST_NAME="+split_name+"";boxParams+="|||IS_DESKTOP="+isDesktop().toString().toLowerCase()+"";boxParams+="|||IS_PHONE="+isPhone().toString().toLowerCase()+"";boxParams+="|||IS_TABLET="+isTablet().toString().toLowerCase()+"";boxParams+="|||IS_MOBILE="+isMobile().toString().toLowerCase()+"";if(typeof DIGIOH_USE_RESPONSIVE!=='undefined'&&DIGIOH_USE_RESPONSIVE)
boxParams+="|||DIGIOH_USE_RESPONSIVE=true";else
boxParams+="|||DIGIOH_USE_RESPONSIVE=false";if(typeof DIGIOH_USE_BUGSNAG!=='undefined'&&DIGIOH_USE_BUGSNAG)
boxParams+="|||DIGIOH_USE_BUGSNAG=true";else
boxParams+="|||DIGIOH_USE_BUGSNAG=false";var lzParams=LZString.compressToBase64(boxParams);var frameLink='robert.digioh.com/AzureBlobStorage/cloudflare/static/box.html';if(VENDOR_GUID==='dba8d2cd-9f97-474d-bcb6-8dcb112e4a49')
{if(window.location.host&&window.location.host.indexOf('www.newrez.com')>=0)
frameLink='www.newrez.com/digioh-box.html';else if(window.location.host&&window.location.host.indexOf('pages.airtory.com')>=0)
frameLink='pages.airtory.com/patch/digioh-newrez.html';else if(window.location.host&&window.location.host.indexOf('www.airtory.com')>=0)
frameLink='www.airtory.com/patch/digioh-newrez.html';else if(window.location.host&&window.location.host.indexOf('test.patch.com')>=0)
frameLink='test.patch.com/patch/digioh-newrez.html';else if(window.location.host&&window.location.host.indexOf('mortgage.patch.com')>=0)
frameLink='mortgage.patch.com/patch/digioh-newrez.html';else if(window.location.host&&window.location.host.indexOf('www.patch.com')>=0)
frameLink='www.patch.com/patch/digioh-newrez.html';else if(window.location.host&&window.location.host.indexOf('patch.com')===0)
frameLink='patch.com/patch/digioh-newrez.html';else
frameLink='lp.newrez.com/digioh-box.html';}
JQUERY_DIGIOH("<iframe tabindex='1' aria-label='Modal Overlay Box Frame' src='//"+frameLink+"?lz="+lzParams+"' id='"+iframe_id+"' title='"+iframe_title+"' class='box-"+lightbox_short_id+"' width='100%' height='100%' frameborder='0' scrolling='no' style='display:block;position:"+iframe_position+";margin:0;padding:0;border:none;width:100%;height:100%;' sandbox='allow-scripts allow-same-origin allow-forms allow-modals allow-popups allow-popups-to-escape-sandbox allow-top-navigation'></iframe>").bind('load').appendTo('#'+append_to_element_id);}
else
{JQUERY_DIGIOH("<iframe tabindex='1' aria-label='Modal Overlay Box Frame' id='"+iframe_id+"' title='"+iframe_title+"' class='box-"+lightbox_short_id+"' width='100%' height='100%' frameborder='0' scrolling='no' style='display:block;position:"+iframe_position+";margin:0;padding:0;border:none;width:100%;height:100%;' sandbox='allow-scripts allow-same-origin allow-forms allow-modals allow-popups allow-popups-to-escape-sandbox allow-top-navigation'></iframe>").bind('load',function(event)
{var cwd=null;if(this.contentDocument)
{cwd=this.contentDocument;}else if(this.contentWindow)
{cwd=this.contentWindow.document;}
if(cwd==null)
{return;}
var s;var cwh=cwd.getElementsByTagName('head')[0];var z="";z+="<scr";z+="ipt type='text/javascript'>";z+="<";z+="/scr"+"ipt>";var scriptInit='';scriptInit+="var PROTOCOL = '"+(PROTOCOL||"https://")+"';";scriptInit+="var PROTOCOL_USER_OVERRIDE = '"+(PROTOCOL_USER_OVERRIDE||"https://")+"';";scriptInit+="var WIDGET_TYPE = '"+widget_type+"';";scriptInit+="var CACHE_VERSION = '"+DIGIOH_CACHE_VERSION+"';";scriptInit+="var PARENT_URL = '"+PROTOCOL+window.location.host+"';";scriptInit+="var FULL_URL = '"+window.location.href.split("'").join("%27")+"';";scriptInit+="var IS_PRODUCTION = "+(IS_DEV?'false':'true')+";";scriptInit+="var IS_PREVIEW = "+(IS_PREVIEW?'true':'false')+";";scriptInit+="var SHOW_ERRORS = "+(SHOW_ERRORS?'true':'false')+";";scriptInit+="var IS_IE_9_OR_LESS = false;";scriptInit+="var VENDOR_GUID = '"+VENDOR_GUID+"';";scriptInit+="var VENDOR_SHORT_ID = '"+DIGIOH_VENDOR_SHORT_ID+"';";scriptInit+="var CLIENT_GUID = '"+CLIENT_GUID+"';";scriptInit+="var LIGHTBOX_GUID = '"+actual_lid+"';";scriptInit+="var LIGHTBOX_SHORT_ID = '"+lightbox_short_id+"';";scriptInit+="var LIGHTBOX_NAME = '"+lightbox_name+"';";scriptInit+="var VARIATION_GUID = '"+var_id+"';";scriptInit+="var VARIATION_SHORT_ID = '"+variation_short_id+"';";scriptInit+="var VARIATION_NAME = '"+variation_name+"';";scriptInit+="var IS_VARIATION = "+isVariation.toString().toLowerCase()+";";scriptInit+="var AB_TEST_GUID = '"+split_guid+"';";scriptInit+="var AB_TEST_SHORT_ID = '"+split_short_id+"';";scriptInit+="var AB_TEST_NAME = '"+split_name+"';";var is_desktop=isDesktop();var is_phone=isPhone();if(typeof is_desktop!=='boolean'||typeof is_phone!=='boolean')
{logger('isDesktop() ==> '+is_desktop);logger('isPhone() ==> '+is_phone);logger('DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.primaryHardwareType ==> '+DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.primaryHardwareType);}
scriptInit+="var IS_DESKTOP = "+is_desktop.toString().toLowerCase()+";";scriptInit+="var IS_PHONE = "+is_phone.toString().toLowerCase()+";";scriptInit+="var IS_TABLET = "+isTablet().toString().toLowerCase()+";";scriptInit+="var IS_MOBILE = "+isMobile().toString().toLowerCase()+";";if(typeof DIGIOH_USE_RESPONSIVE!=='undefined'&&DIGIOH_USE_RESPONSIVE)
{scriptInit+="var DIGIOH_USE_RESPONSIVE = true;";}else
{scriptInit+="var DIGIOH_USE_RESPONSIVE = false;";}
if(typeof DIGIOH_USE_BUGSNAG!=='undefined'&&DIGIOH_USE_BUGSNAG)
{scriptInit+="var DIGIOH_USE_BUGSNAG = true;";}else
{scriptInit+="var DIGIOH_USE_BUGSNAG = false;";}
s=cwd.createElement('script');s.type='text/javascript';if(typeof s.textContent!=="undefined")
{s.textContent=scriptInit;}else
{s.innerText=scriptInit;}
cwh.appendChild(s);s=cwd.createElement('script');s.type='text/javascript';s.src=PROTOCOL_USER_OVERRIDE+'www.lightboxcdn.com/vendor/'+VENDOR_GUID+'/'+'lightbox_builder.js'+'?cb='+DIGIOH_CACHE_VERSION;cwh.appendChild(s);}).appendTo('#'+append_to_element_id);}}
catch(e){logError(e,"loadLightningIframe");}}
function updateFancyboxPosition(dom_id,cnt,lbid){try{if(IS_LIGHTBOX_CLOSING.hasOwnProperty(lbid)&&IS_LIGHTBOX_CLOSING[lbid]){return;}
var wrap=JQUERY_DIGIOH('.fb_lightbox-wrap').filter(':first');var preload=JQUERY_DIGIOH('#'+dom_id);var position={};if(!isMobile()){position.position="fixed";}else{position.position="absolute";}
position.top=parseInt(wrap.css('top'));position.left=parseInt(wrap.css('left'));var m=getResponsiveScaleMultiplier(lbid);preload.css({'position':position.position,'left':position.left,'top':position.top,'transform':'scale('+m+')','-webkit-transform':'scale('+m+')','-moz-transform':'scale('+m+')','-ms-transform':'scale('+m+')','-o-transform':'scale('+m+')'});preload.show();if(cnt<2){cnt++;window.setTimeout,300);}}
catch(e){logError(e,"updateFancyboxPosition");}}
function initFancybox(lbid,is_preloaded){try{if(is_preloaded)is_preloaded=true;else is_preloaded=false;if(effectsHasTeaserDisplayFancybox(lbid)){closeTeaser(EFFECTS[lbid].fancybox.teaser,lbid,false);}
if(!is_preloaded){preloadIframe(lbid);tryInitFancyboxWhenChildReady(lbid,1);return;}
var dom_id=getLightboxDomId(lbid);var fb={};var dims_box=getActualBoxWidthAndHeight(lbid);if(is_preloaded){fb={content:"<div class='fb_lightbox-content'></div>",width:dims_box.width,height:dims_box.height,autoSize:false,scrolling:'no',arrows:false,padding:0,autoCenter:(!isMobile()),fixed:(!isMobile()),keys:{close:0}};fb.afterShow;fb.onUpdate;fb.beforeClose;fb.afterClose;}else{}
fb.beforeLoad;fb.helpers={overlay:{closeClick:EFFECTS[lbid].fancybox.overlay.close_click,css:getBackgroundStyle(EFFECTS[lbid].fancybox.overlay.background)}};fb.topRatio=(EFFECTS[lbid].fancybox.position.top/10);fb.leftRatio=(EFFECTS[lbid].fancybox.position.left/10);if(EFFECTS[lbid].fancybox.animation.open!="fade"&&EFFECTS[lbid].fancybox.animation.open!="elastic"){fb.openEffect="fade";fb.openMethod=EFFECTS[lbid].fancybox.animation.open+"In";}else{fb.openEffect=EFFECTS[lbid].fancybox.animation.open;fb.openMethod='zoomInCustom';}
if(EFFECTS[lbid].fancybox.animation.open!="fade"){fb.openEasing=EFFECTS[lbid].fancybox.easing.open;}
fb.openSpeed=EFFECTS[lbid].fancybox.speed.open;if(EFFECTS[lbid].fancybox.animation.close!="fade"&&EFFECTS[lbid].fancybox.animation.close!="elastic"){fb.closeEffect="fade";fb.closeMethod=EFFECTS[lbid].fancybox.animation.close+"Out";}else{fb.closeEffect=EFFECTS[lbid].fancybox.animation.close;fb.closeMethod='zoomOutCustom';}
if(EFFECTS[lbid].fancybox.animation.close!="fade"){fb.closeEasing=EFFECTS[lbid].fancybox.easing.close;}
fb.closeSpeed=EFFECTS[lbid].fancybox.speed.close;fb.tpl={closeBtn:'<div title="Close" id="widget_fb_close_hide" style="display:none;" aria-label="Close Modal"></div>'};fb.box_id=lbid;JQUERY_DIGIOH.fb_lightbox.open(fb);}
catch(e){logError(e,"initFancybox");}}
function fancyboxMobileSidebarFix(lbid){try{var dom_id=getLightboxDomId(lbid);var dims_box=getActualBoxWidthAndHeight(lbid);var fb={content:'<div></div>',width:dims_box.width,height:dims_box.height,autoSize:false,scrolling:'no',arrows:false,padding:0,autoCenter:false,fixed:false,keys:{close:0}};fb.afterShow;fb.onUpdate;fb.beforeClose;fb.afterClose;fb.beforeLoad;fb.helpers={overlay:{closeClick:false,css:{"background-color":"rgba(0, 0, 0, 0)","opacity":"0"}}};fb.topRatio=(1/10);fb.leftRatio=(5/10);fb.openEffect="fade";fb.openMethod="slideDownIn";fb.closeEffect="fade";fb.closeMethod="slideUpOut";fb.openSpeed=50;fb.closeSpeed=100;fb.tpl={closeBtn:'<div title="Close" id="widget_fb_close_hide" style="display:none;"></div>'};JQUERY_DIGIOH('#'+dom_id+' .widget_fb_close').click);fb.box_id=lbid;JQUERY_DIGIOH.fb_lightbox.open(fb);}
catch(e){logError(e,"fancyboxMobileSidebarFix");}}
function initFancyboxEffects(){try{(JQUERY_DIGIOH,JQUERY_DIGIOH.fb_lightbox));}
catch(e){logError(e,"initFancyboxEffects");}}
function createIdentityIframe(){try{var src='https://www.lightboxcdn.com/lclst/'+VENDOR_GUID+'/ls.html';src+='?purl='+encodeURIComponent(window.location.href);src+='&vid='+VENDOR_GUID;src+='&se='+(SHOW_ERRORS?'1':'0');src+='&prev='+(IS_PREVIEW?'1':'0');if(DIGIOH_CACHE_VERSION){src+='&cb='+DIGIOH_CACHE_VERSION;}else{src+='&cb='+(new Date().getTime());}
DIGIOH_IDENTITY_CHILD_IFRAME=JQUERY_DIGIOH('<iframe title="DigiohLocalStorageIframe" name="DigiohLocalStorageIframe" id="DigiohLocalStorageIframe" src="'+src+'" width="0" height="0" style="position:absolute;visibility:hidden;left:-100px;top:-100px;width:0;height:0;margin:0;padding:0;border-width:0px;border-style:none;" frameborder="0" scrolling="no"></iframe>').appendTo('body');}
catch(e){logError(e,"createIdentityIframe");}}
function initPostMessageReceiver(){try{if(window.addEventListener){window.addEventListener("message",runPostMessageReceiver,false);}
else{window.attachEvent("message",runPostMessageReceiver);}}
catch(e){logError(e,"initPostMessageReceiver");}}
function runPostMessageReceiver(e){try{var postMessageDomain=__CDNDomainWithProtocol;var origin=e.origin||e.originalEvent.origin;if(e.source&&e.source===window.frames['DigiohLocalStorageIframe']){var data=/^#localStorage#(\d+)(null)?#([\S\s]*)/.exec(e.data);if(data){if(DIGIOH_CROSS_DOMAIN.callbacks[data[1]]){DIGIOH_CROSS_DOMAIN.callbacks[data[1]](data[2]==='null'?null:data[3]);}
delete DIGIOH_CROSS_DOMAIN.callbacks[data[1]];}}else if(origin!==postMessageDomain){return;}else{logger('runPostMessageReceiver (version C) origin='+origin);processPostMessage(parsePostMessageResult(e.data));}}
catch(e){logError(e,"runPostMessageReceiver");}}
function sendIdentityPostMessage(msgObj){try{var postMessageContentWindow=DIGIOH_IDENTITY_CHILD_IFRAME.get(0).contentWindow;var src='https://www.lightboxcdn.com/lclst/'+VENDOR_GUID+'/ls.html';src+='?parent_url='+encodeURIComponent(document.location.href);if(DIGIOH_CACHE_VERSION){src+='&cb='+DIGIOH_CACHE_VERSION;}else{src+='&cb='+(new Date().getTime());}
DIGIOH_CROSS_DOMAIN.getAll);}
catch(e){logError(e,"sendIdentityPostMessage");}}
function initPostMessageReceiverOld(){try{var postMessageDomain='https://www.lightboxcdn.com';JQUERY_DIGIOH.receiveMessage,postMessageDomain);}
catch(e){logError(e,"initPostMessageReceiverOld");}}
function processPostMessage(e,lid){try{if(typeof lid!=='undefined'&&lid&&!CHILD_READY.hasOwnProperty(lid)){CHILD_READY[lid]=true;}
var hash=e;if(!hash.hasOwnProperty('sender')||(hash.hasOwnProperty('digioh_identity')&&hash.digioh_identity)){logger('processPostMessage: ');logger(hash);}
if(hash.hasOwnProperty('child_action')&&hash.hasOwnProperty('lightbox_id')){if(hash.child_action=='close_lightbox'){if(EFFECTS.hasOwnProperty(hash.lightbox_id)&&EFFECTS[hash.lightbox_id].widget_type==="sidebar"){if(hash.trigger=='form_submit'){EFFECTS[hash.lightbox_id].sidebar.teaser.display=false;}
closeSidebar(hash.lightbox_id);}else if(EFFECTS.hasOwnProperty(hash.lightbox_id)&&EFFECTS[hash.lightbox_id].widget_type==="banner"){closeBanner(hash.lightbox_id);}else if(EFFECTS.hasOwnProperty(hash.lightbox_id)&&EFFECTS[hash.lightbox_id].widget_type==="fancybox"){if(hash.trigger=='form_submit'){EFFECTS[hash.lightbox_id].fancybox.teaser.display=false;}
IS_LIGHTBOX_CLOSING[lid]=true;JQUERY_DIGIOH.fb_lightbox.close(true);}else if(EFFECTS.hasOwnProperty(hash.lightbox_id)&&EFFECTS[hash.lightbox_id].widget_type==="inline"){logger('closeInline: '+hash.lightbox_id);closeInline(hash.lightbox_id);}}else if(hash.child_action=='redirect_parent'&&hash.hasOwnProperty('url')&&hash.url.length>7){if(hash.hasOwnProperty('ui_trigger')){if(!IS_REDIRECTING_PARENT){IS_REDIRECTING_PARENT=true;keenLightboxRedirect(hash.lightbox_id);var var_id='';var orig_lid=hash.lightbox_id;if(DIGIOH_VARIATION_TO_BOX_MAP.hasOwnProperty(hash.lightbox_id)){orig_lid=DIGIOH_VARIATION_TO_BOX_MAP[hash.lightbox_id];var_id=hash.lightbox_id;}else if(LIGHTBOX_TO_VARIATION_MAP.hasOwnProperty(hash.lightbox_id)){var_id=LIGHTBOX_TO_VARIATION_MAP[hash.lightbox_id];}
var ab_test_id='';if(var_id!=''&&AB_BOXES_TAKE_MAP.hasOwnProperty(var_id)){ab_test_id=AB_BOXES_TAKE_MAP[var_id];}else if(AB_BOXES_TAKE_MAP.hasOwnProperty(orig_lid)){ab_test_id=AB_BOXES_TAKE_MAP[orig_lid];}
if(!IS_PREVIEW||IS_DEV){if(!isInlineLightbox(hash.lightbox_id)||doesInlineLightboxHaveCustomJsType(hash.lightbox_id,'all')){DIGIOH_CUSTOM_JS_SUPER.runCustomJsOnLightboxRedirect(window.DIGIOH_API,window,document,JQUERY_DIGIOH,orig_lid,var_id,getCustomJsMetadata(orig_lid));logger('JS_GLOBAL.runCustomJsOnLightboxRedirect - '+hash.lightbox_id);DIGIOH_CUSTOM_JS.runCustomJsOnLightboxRedirect(window.DIGIOH_API,window,document,JQUERY_DIGIOH,orig_lid,var_id,getCustomJsMetadata(orig_lid));logger('JS_PARENT.runCustomJsOnLightboxRedirect - '+hash.lightbox_id);}}
DIGIOH_LIGHTBOX_ANALYTICS.setLightboxEvent("redirect",orig_lid);var vendorShortId=VENDOR_GUID||'empty';var boxShortId=orig_lid||'empty';var variationShortId=var_id||'empty';var splitShortId=ab_test_id||'empty';if(typeof DIGIOH_VENDOR_SHORT_ID!=='undefined'){vendorShortId=DIGIOH_VENDOR_SHORT_ID;}
if(orig_lid&&DIGIOH_LIGHTBOX_IDS.hasOwnProperty(orig_lid)&&DIGIOH_LIGHTBOX_IDS[orig_lid]){boxShortId=DIGIOH_LIGHTBOX_IDS[orig_lid];}
if(var_id&&DIGIOH_LIGHTBOX_IDS.hasOwnProperty(var_id)&&DIGIOH_LIGHTBOX_IDS[var_id]){variationShortId=DIGIOH_LIGHTBOX_IDS[var_id];}
if(typeof DIGIOH_SPLIT_TESTS_ARR!=='undefined'&&DIGIOH_SPLIT_TESTS_ARR.length){for(var i=0;i<DIGIOH_SPLIT_TESTS_ARR.length;i++){if(DIGIOH_SPLIT_TESTS_ARR[i].hasOwnProperty('split_short_id')&&DIGIOH_SPLIT_TESTS_ARR[i].hasOwnProperty('split_guid')&&DIGIOH_SPLIT_TESTS_ARR[i]['split_guid']==ab_test_id){splitShortId=DIGIOH_SPLIT_TESTS_ARR[i]['split_short_id'];break;}}}
var hostname='empty';if(window&&window.location&&window.location.hostname){hostname=window.location.hostname;}
var eplz=DIGIOH_API.LIGHTBOX.LZString.compressToBase64('e=r&c='+(new Date().getTime())+'&h='+encodeURIComponent(hostname)+'&u='+vendorShortId+'&b='+boxShortId+'&v='+variationShortId+'&s='+splitShortId+'#######'+hash.url);var epred='https://jsapi.lightboxcdn.com/Event/RedirectProxy?eplz='+eplz+'&cb='+(new Date().getTime());var use_watch=getUrlParam('use_watch');if(use_watch&&(use_watch=='yes'||use_watch=='true'||use_watch=='1')){epred+="&use_watch=yes";}
if(!hash.hasOwnProperty('redirect_type')||!hash.redirect_type||hash.redirect_type==='current'){IS_REDIRECTING_PARENT=false;console.log('IS_REDIRECTING_PARENT: '+IS_REDIRECTING_PARENT);logger('redirect_type=current ('+epred+')');window.location.href=epred;}else if(hash.redirect_type==='tab'){JQUERY_DIGIOH('body').append("<a id='new-tab-link-"+hash.lightbox_id+"' style='display:none;' href='"+epred+"' target='_blank'></a>");document.getElementById("new-tab-link-"+hash.lightbox_id).click();window.setTimeout(function(){JQUERY_DIGIOH("#new-tab-link-"+hash.lightbox_id).remove();IS_REDIRECTING_PARENT=false;},1000);logger('redirect_type=tab');}else if(hash.redirect_type==='window'){window.open(epred,"NewWindow","menubar=yes,height="+(JQUERY_DIGIOH(window).height()-25)+",width="+(JQUERY_DIGIOH(window).width()-25)+",left=25,top=25");window.setTimeout,1000);logger('redirect_type=window');}}}}else if(hash.child_action=='lightbox_open'&&hash.hasOwnProperty('lightbox_open')&&hash.lightbox_open.length>1){if(!IS_REDIRECTING_PARENT){IS_REDIRECTING_PARENT=true;if(hash.hasOwnProperty('ui_trigger')&&hash.ui_trigger=='button'){keenLightboxRedirect(hash.lightbox_id);var var_id='';var orig_lid=hash.lightbox_id;if(DIGIOH_VARIATION_TO_BOX_MAP.hasOwnProperty(hash.lightbox_id)){orig_lid=DIGIOH_VARIATION_TO_BOX_MAP[hash.lightbox_id];var_id=hash.lightbox_id;}else if(LIGHTBOX_TO_VARIATION_MAP.hasOwnProperty(hash.lightbox_id)){var_id=LIGHTBOX_TO_VARIATION_MAP[hash.lightbox_id];}
var ab_test_id='';if(var_id!=''&&AB_BOXES_TAKE_MAP.hasOwnProperty(var_id)){ab_test_id=AB_BOXES_TAKE_MAP[var_id];}else if(AB_BOXES_TAKE_MAP.hasOwnProperty(orig_lid)){ab_test_id=AB_BOXES_TAKE_MAP[orig_lid];}
if(!IS_PREVIEW||IS_DEV){if(!isInlineLightbox(hash.lightbox_id)||doesInlineLightboxHaveCustomJsType(hash.lightbox_id,'all')){DIGIOH_CUSTOM_JS_SUPER.runCustomJsOnLightboxRedirect(window.DIGIOH_API,window,document,JQUERY_DIGIOH,orig_lid,var_id,getCustomJsMetadata(orig_lid));logger('JS_GLOBAL.runCustomJsOnLightboxRedirect - '+hash.lightbox_id);DIGIOH_CUSTOM_JS.runCustomJsOnLightboxRedirect(window.DIGIOH_API,window,document,JQUERY_DIGIOH,orig_lid,var_id,getCustomJsMetadata(orig_lid));logger('JS_PARENT.runCustomJsOnLightboxRedirect - '+hash.lightbox_id);}}
DIGIOH_LIGHTBOX_ANALYTICS.setLightboxEvent("redirect",orig_lid);analyticsRedirect(orig_lid,var_id,ab_test_id);}
if(EFFECTS.hasOwnProperty(hash.lightbox_id)&&EFFECTS[hash.lightbox_id].widget_type==="sidebar"){EFFECTS[hash.lightbox_id].sidebar.teaser.display=false;closeSidebar(hash.lightbox_id);}else if(EFFECTS.hasOwnProperty(hash.lightbox_id)&&EFFECTS[hash.lightbox_id].widget_type==="banner"){closeBanner(hash.lightbox_id);}else if(EFFECTS.hasOwnProperty(hash.lightbox_id)&&EFFECTS[hash.lightbox_id].widget_type==="fancybox"){EFFECTS[hash.lightbox_id].fancybox.teaser.display=false;IS_LIGHTBOX_CLOSING[hash.lightbox_id]=true;JQUERY_DIGIOH.fb_lightbox.close(true);}
var foundAnotherLightbox=false;var lightbox_open_guid=DIGIOH_API.getBoxGUID(hash.lightbox_open);for(var i=0;i<DIGIOH_LIGHTBOX_CONDITIONS.length;i++){if(lightbox_open_guid==DIGIOH_LIGHTBOX_CONDITIONS[i].lightbox_guid){foundAnotherLightbox=true;tryOpenAnotherLightbox(lightbox_open_guid);break;}}
if(!foundAnotherLightbox){logger('Action lightbox_open invalid, could not find another active Lightbox with GUID: '+lightbox_open_guid);}}}else if(hash.child_action=='download_file'){keenLightboxDownload(hash.lightbox_id);var var_id='';var orig_lid=hash.lightbox_id;if(DIGIOH_VARIATION_TO_BOX_MAP.hasOwnProperty(hash.lightbox_id)){orig_lid=DIGIOH_VARIATION_TO_BOX_MAP[hash.lightbox_id];var_id=hash.lightbox_id;}else if(LIGHTBOX_TO_VARIATION_MAP.hasOwnProperty(hash.lightbox_id)){var_id=LIGHTBOX_TO_VARIATION_MAP[hash.lightbox_id];}
var ab_test_id='';if(var_id!=''&&AB_BOXES_TAKE_MAP.hasOwnProperty(var_id)){ab_test_id=AB_BOXES_TAKE_MAP[var_id];}else if(AB_BOXES_TAKE_MAP.hasOwnProperty(orig_lid)){ab_test_id=AB_BOXES_TAKE_MAP[orig_lid];}
if(!IS_PREVIEW||IS_DEV){if(!isInlineLightbox(hash.lightbox_id)||doesInlineLightboxHaveCustomJsType(hash.lightbox_id,'all')){DIGIOH_CUSTOM_JS_SUPER.runCustomJsOnLightboxDownload(window.DIGIOH_API,window,document,JQUERY_DIGIOH,orig_lid,var_id,getCustomJsMetadata(orig_lid));logger('JS_GLOBAL.runCustomJsOnLightboxDownload - '+hash.lightbox_id);DIGIOH_CUSTOM_JS.runCustomJsOnLightboxDownload(window.DIGIOH_API,window,document,JQUERY_DIGIOH,orig_lid,var_id,getCustomJsMetadata(orig_lid));logger('JS_PARENT.runCustomJsOnLightboxDownload - '+hash.lightbox_id);}}
DIGIOH_LIGHTBOX_ANALYTICS.setLightboxEvent("download",orig_lid);analyticsDownload(orig_lid,var_id,ab_test_id);}else if(hash.child_action=='change_pages'){var pref=hash.page_prefix.replace('_','');CURRENT_PAGE[hash.lightbox_id]=pref;var width_new=hash.width;var height_new=hash.height;var width_prev=hash.width_prev;var height_prev=hash.height_prev;var dom_id=getLightboxDomId(hash.lightbox_id);var dims_box=getActualBoxWidthAndHeight(hash.lightbox_id);CURRENT_PAGE_DIMS[hash.lightbox_id]={width:dims_box.width,height:dims_box.height};var offset_prev=JQUERY_DIGIOH('#'+dom_id).offset();logger('Changed Pages: '+pref+' ('+dims_box.width+'x'+dims_box.height+')');if(EFFECTS[hash.lightbox_id].widget_type==='inline'){if(EFFECTS[hash.lightbox_id].hasOwnProperty(pref+'responsive')&&EFFECTS[hash.lightbox_id][pref+'responsive'].use){var wMax=getResponsiveBoxWidthMax(hash.lightbox_id);var wMin=getResponsiveBoxWidthMin(hash.lightbox_id);var hMax=getResponsiveBoxHeightMax(hash.lightbox_id);var hMin=getResponsiveBoxHeightMin(hash.lightbox_id);JQUERY_DIGIOH('#'+dom_id).css({'width':getResponsiveBoxWidthPercent(hash.lightbox_id)+'%','height':getResponsiveBoxHeightPercent(hash.lightbox_id)+'%','max-width':wMax+'px','min-width':wMin+'px','max-height':hMax+'px','min-height':hMin+'px'});}else{JQUERY_DIGIOH('#'+dom_id).css({'width':dims_box.width+'px','height':dims_box.height+'px'});if(EFFECTS[hash.lightbox_id].inline.css.indexOf(':')>0&&EFFECTS[hash.lightbox_id].inline.css.indexOf(';')>0){var style_curr=JQUERY_DIGIOH('#'+dom_id).attr('style');style_curr+=';'+EFFECTS[hash.lightbox_id].inline.css;JQUERY_DIGIOH('#'+dom_id).attr('style',style_curr.replace(';;',';'));}}}
if(EFFECTS[hash.lightbox_id].widget_type==='banner'){JQUERY_DIGIOH('#'+dom_id).attr('style',getBannerPosition(EFFECTS[hash.lightbox_id].banner,hash.lightbox_id));if(!EFFECTS[hash.lightbox_id].banner.hasOwnProperty('placement')||EFFECTS[hash.lightbox_id].banner.placement!=='bottom'){if(JQUERY_DIGIOH('#banner-spacer-'+hash.lightbox_id).length){JQUERY_DIGIOH('#banner-spacer-'+hash.lightbox_id).height(dims_box.height);}}}
if(EFFECTS[hash.lightbox_id].widget_type==='sidebar'){if(Math.abs(width_new-width_prev)>20||Math.abs(height_new-height_prev)>20){JQUERY_DIGIOH('#'+dom_id).attr('style',getSidebarPositionAfterAnimation(EFFECTS[hash.lightbox_id].sidebar,hash.lightbox_id));}
setBoxToScrollMode(hash.lightbox_id,pref,'change_pages');}
if(EFFECTS[hash.lightbox_id].widget_type==='fancybox'){FANCY_REPOSITION_LOCKED[hash.lightbox_id]=true;if(isMobile()){if(Math.abs(width_new-width_prev)>20||Math.abs(height_new-height_prev)>20){var left_new=Math.round(((jqWin.width()-dims_box.width)/2)+jqWin.scrollLeft());var top_new=Math.round(((jqWin.height()-dims_box.height)/2)+jqWin.scrollTop());var m=getResponsiveScaleMultiplier(hash.lightbox_id);var wrap=JQUERY_DIGIOH('.fb_lightbox-wrap').filter(':first');wrap.css({'left':left_new,'top':top_new,'width':dims_box.width+'px','height':dims_box.height+'px','transform':'scale('+m+')','-webkit-transform':'scale('+m+')','-moz-transform':'scale('+m+')','-ms-transform':'scale('+m+')','-o-transform':'scale('+m+')'});JQUERY_DIGIOH('#'+dom_id).css({'left':left_new,'top':top_new,'width':dims_box.width+'px','height':dims_box.height+'px','transform':'scale('+m+')','-webkit-transform':'scale('+m+')','-moz-transform':'scale('+m+')','-ms-transform':'scale('+m+')','-o-transform':'scale('+m+')'});}}else{updateFancyboxPosition(dom_id,0,hash.lightbox_id);}}
if(EFFECTS[hash.lightbox_id].hasOwnProperty(pref+'responsive')&&EFFECTS[hash.lightbox_id][pref+'responsive'].use){if(EFFECTS[hash.lightbox_id].widget_type!=='inline'){CURRENT_PAGE_DIMS_RESPONSIVE[hash.lightbox_id]={width:dims_box.width,height:dims_box.height};keepSendingResizeToChildUntilReceived({sender:'lightbox',action:'dimensions_changed',widget_type:EFFECTS[hash.lightbox_id].widget_type,width:dims_box.width,height:dims_box.height},hash.lightbox_id,100,0);}else{inlineResponsiveResizing(hash.lightbox_id,dom_id,(new Date().getTime()),0,0);}}
var var_id='';var orig_lid=hash.lightbox_id;if(DIGIOH_VARIATION_TO_BOX_MAP.hasOwnProperty(hash.lightbox_id)){orig_lid=DIGIOH_VARIATION_TO_BOX_MAP[hash.lightbox_id];var_id=hash.lightbox_id;}else if(LIGHTBOX_TO_VARIATION_MAP.hasOwnProperty(hash.lightbox_id)){var_id=LIGHTBOX_TO_VARIATION_MAP[hash.lightbox_id];}
if(!IS_PREVIEW||IS_DEV){var metadata=getCustomJsMetadata(orig_lid);metadata.new_width=hash.width;metadata.old_width=hash.width_prev;metadata.new_height=hash.height;metadata.old_height=hash.height_prev;metadata.new_page=hash.new_page;metadata.old_page=hash.previous_page;metadata.element=hash.el_name;metadata.trigger=hash.ui_source;if(!isInlineLightbox(hash.lightbox_id)||doesInlineLightboxHaveCustomJsType(hash.lightbox_id,'all')){DIGIOH_CUSTOM_JS_SUPER.runCustomJsOnChangePages(window.DIGIOH_API,window,document,JQUERY_DIGIOH,orig_lid,var_id,metadata);logger('JS_GLOBAL.runCustomJsOnChangePages - '+hash.lightbox_id);DIGIOH_CUSTOM_JS.runCustomJsOnChangePages(window.DIGIOH_API,window,document,JQUERY_DIGIOH,orig_lid,var_id,metadata);logger('JS_PARENT.runCustomJsOnChangePages - '+hash.lightbox_id);}}}else if(hash.child_action=='register_analytics_submit'&&hash.hasOwnProperty('submission')&&hash.hasOwnProperty('post_to_keen')){if(!hash.hasOwnProperty('form_display')){logger("register_analytics_submit: hash does not have property - form_display");}
if(!hash.hasOwnProperty('form_display')||hash.form_display==true){var sid=generateGuidWithTimestamp();DIGIOH_LIGHTBOX_ANALYTICS.form_submit_data=JSON.parse(LZString.decompressFromBase64(hash.submission));DIGIOH_LIGHTBOX_ANALYTICS.form_submit_query=LZString.decompressFromBase64(hash.post_to_keen);keenLightboxSubmit(DIGIOH_LIGHTBOX_ANALYTICS.form_submit_data,hash.lightbox_id,sid);postToKeen(DIGIOH_LIGHTBOX_ANALYTICS.form_submit_query,hash.lightbox_id,sid);registerLightboxSubmit(hash.lightbox_id);try{var curr=DIGIOH_LOCAL_STORAGE.getManual('fsdbx');if(typeof curr!=='object'||!curr){curr={};}
var box_short_id=hash.lightbox_id;if(DIGIOH_LIGHTBOX_IDS&&DIGIOH_LIGHTBOX_IDS.hasOwnProperty(hash.lightbox_id)){box_short_id=DIGIOH_LIGHTBOX_IDS[hash.lightbox_id]+'';}
for(var prop in DIGIOH_LIGHTBOX_ANALYTICS.form_submit_data){if(DIGIOH_LIGHTBOX_ANALYTICS.form_submit_data.hasOwnProperty(prop)&&DIGIOH_LIGHTBOX_ANALYTICS.form_submit_data[prop]!==''){curr[prop]=DIGIOH_LIGHTBOX_ANALYTICS.form_submit_data[prop];if(!curr.hasOwnProperty(box_short_id)||typeof curr[box_short_id]!=='object'||curr[box_short_id]===null){curr[box_short_id]={};}
curr[box_short_id][prop]=DIGIOH_LIGHTBOX_ANALYTICS.form_submit_data[prop];}}
DIGIOH_LOCAL_STORAGE.setManual('fsdbx',curr);logger('fsdbx ==> ');logger(curr);}
catch(err){logger('fsdbx error - '+err.message);}}else{logger("register_analytics_submit: prevented submit event from firing because form is turned off.");DIGIOH_LIGHTBOX_ANALYTICS.form_submit_data=JSON.parse(LZString.decompressFromBase64(hash.submission));keenLightboxDebug(hash.lightbox_id,DIGIOH_LIGHTBOX_ANALYTICS.form_submit_data);}}else if(hash.child_action=='coupon_used'&&hash.hasOwnProperty('coupon_meta_data')){keenLightboxCoupon(hash.lightbox_id,hash.coupon_meta_data);logger("coupon_used: keenLightboxCoupon");logger(hash);}}
if(hash.hasOwnProperty('parent_action')&&hash.hasOwnProperty('lightbox_id')){if(hash.parent_action=='terminate_lightbox'){TERMINATED_LIGHTBOXES[hash.lightbox_id]=true;var domId=getLightboxDomId(hash.lightbox_id);if(domId&&JQUERY_DIGIOH("#"+domId).length){JQUERY_DIGIOH("#"+domId).remove();}
if(DIGIOH_API.contains(PRELOADED_LIGHTBOXES_LOADED,hash.lightbox_id)){PRELOADED_LIGHTBOXES_LOADED=DIGIOH_API.remove(PRELOADED_LIGHTBOXES_LOADED,hash.lightbox_id);}
if(DIGIOH_API.contains(PRELOADED_LIGHTBOXES,hash.lightbox_id)){PRELOADED_LIGHTBOXES=DIGIOH_API.remove(PRELOADED_LIGHTBOXES,hash.lightbox_id);}
logger("Custom JS Boxes - Before DOM Ready - Terminated Execution of Lightbox: "+hash.lightbox_id);}}
if(hash.hasOwnProperty('event')){if(hash.event=='mouseenter'&&hash.hasOwnProperty('lightbox_id')){PREVENT_SIDEBAR_CLOSE_GUIDS[hash.lightbox_id]=true;}else if(hash.event=='mouseleave'&&hash.hasOwnProperty('lightbox_id')){if(PREVENT_SIDEBAR_CLOSE_GUIDS.hasOwnProperty(hash.lightbox_id)){delete PREVENT_SIDEBAR_CLOSE_GUIDS[hash.lightbox_id];}}else if(hash.event=='input_focus'&&hash.hasOwnProperty('lightbox_id')){if(isMobile()){}}}
if(hash.hasOwnProperty('zipcode')){if(hash.hasOwnProperty('sender')&&hash.sender=='maxmind2'){if(hash.hasOwnProperty('callback_func')&&hash.callback_func.length>0){if(window.DIGIOH_API.LIGHTBOX.hasOwnProperty(hash.callback_func)){window.DIGIOH_API.LIGHTBOX[hash.callback_func](hash.ip);}}}else{GEO_IP=hash;if(GEO_IP.hasOwnProperty("country_name"))GEO_IP.country_name=GEO_IP.country_name.replace('+',' ');if(GEO_IP.hasOwnProperty("region_name"))GEO_IP.region_name=GEO_IP.region_name.replace('+',' ');if(GEO_IP.hasOwnProperty("city"))GEO_IP.city=GEO_IP.city.replace('+',' ');if(GEO_IP.hasOwnProperty("latitude")&&GEO_IP.latitude)GEO_IP.latitude=parseFloat(GEO_IP.latitude);if(GEO_IP.hasOwnProperty("longitude")&&GEO_IP.longitude)GEO_IP.longitude=parseFloat(GEO_IP.longitude);if(GEO_IP.hasOwnProperty("time_zone")&&GEO_IP.time_zone)GEO_IP.time_zone=decodeURIComponent(GEO_IP.time_zone);GEO_IP.geo_source='maxmind';DIGIOH_LIGHTBOX_ANALYTICS.setGeoData(GEO_IP);initDependentScripts();}}
if(hash.hasOwnProperty('loading_status')&&hash.loading_status=="settings_applied"){if(hash.hasOwnProperty('widget_type')&&hash.widget_type==="sidebar"){if(JQUERY_DIGIOH.inArray(hash.lightbox_id,PRELOADED_LIGHTBOXES)===-1){showSidebar(hash.lightbox_id);}}else if(hash.hasOwnProperty('widget_type')&&hash.widget_type==="banner"){if(JQUERY_DIGIOH.inArray(hash.lightbox_id,PRELOADED_LIGHTBOXES)===-1){showBanner(hash.lightbox_id);}}else if(hash.hasOwnProperty('widget_type')&&hash.widget_type==="inline"){registerLightboxShow(hash.lightbox_id);}
if(JQUERY_DIGIOH.inArray(hash.lightbox_id,PRELOADED_LIGHTBOXES_LOADED)==-1){PRELOADED_LIGHTBOXES_LOADED.push(hash.lightbox_id);}
if(IS_PREVIEW){logger("preview 1");if(typeof DigiohPreviewOnScriptLoaded!=="undefined"&&!wasScriptOnLoadedCalled){logger("preview 2");DigiohPreviewOnScriptLoaded();if(!IS_PREVIEW_EVENT){logger("preview 3");window.setTimeout(function(){loadLightbox(LIGHTBOX_GUID_PREVIEW);},500);}}}
var pref=getPagePref(hash.lightbox_id);if(EFFECTS[hash.lightbox_id].hasOwnProperty(pref+'responsive')&&EFFECTS[hash.lightbox_id][pref+'responsive'].use){if(EFFECTS[hash.lightbox_id].widget_type!=='inline'){var dims_box=getActualBoxWidthAndHeight(hash.lightbox_id);CURRENT_PAGE_DIMS_RESPONSIVE[hash.lightbox_id]={width:dims_box.width,height:dims_box.height};keepSendingResizeToChildUntilReceived({sender:'lightbox',action:'dimensions_changed',widget_type:EFFECTS[hash.lightbox_id].widget_type,width:dims_box.width,height:dims_box.height},hash.lightbox_id,100,0);}else{inlineResponsiveResizing(hash.lightbox_id,getLightboxDomId(hash.lightbox_id),(new Date().getTime()),0,0);}}}}
catch(e){logError(e,"processPostMessage");}}
function parsePostMessageResult(data){try{var hash={};if(data.indexOf('&')>0){var kvps=data.split('&');for(var x=0;x<kvps.length;x++){if(kvps[x].indexOf('=')>0){var kvp=kvps[x].split('=');hash[kvp[0]]=decodeURIComponent(kvp[1]);}}}else if(data.indexOf('=')>0){var kvp=data.split('=');hash[kvp[0]]=decodeURIComponent(kvp[1]);}
return hash;}
catch(e){logError(e,"parsePostMessageResult");}}
function tryOpenAnotherLightbox(lid){window.setTimeout(function(){logger('tryOpenAnotherLightbox: loading another lightbox: '+lid);loadLightbox(lid,true);IS_REDIRECTING_PARENT=false;},150);}
function getAnalyticsDataForSubmission(lid){try{var var_id='';if(DIGIOH_VARIATION_TO_BOX_MAP.hasOwnProperty(lid)){var_id=lid;lid=DIGIOH_VARIATION_TO_BOX_MAP[lid];}else if(LIGHTBOX_TO_VARIATION_MAP.hasOwnProperty(lid)){var_id=LIGHTBOX_TO_VARIATION_MAP[lid];}
var hash={is_preview:IS_PREVIEW,vendor_id:VENDOR_GUID,client_id:CLIENT_GUID,lightbox_id:lid,variation_id:var_id,referrer_url:document.referrer,page_url:document.location.href,geoip:{ip_address:DIGIOH_LIGHTBOX_ANALYTICS.VARS.ip_address,continent_code:DIGIOH_LIGHTBOX_ANALYTICS.VARS.continent,country_code:DIGIOH_LIGHTBOX_ANALYTICS.VARS.country,country_name:DIGIOH_LIGHTBOX_ANALYTICS.VARS.country_name,region_code:DIGIOH_LIGHTBOX_ANALYTICS.VARS.state,region_name:DIGIOH_LIGHTBOX_ANALYTICS.VARS.region_name,city:DIGIOH_LIGHTBOX_ANALYTICS.VARS.city,zipcode:DIGIOH_LIGHTBOX_ANALYTICS.VARS.zipcode,metro_code:DIGIOH_LIGHTBOX_ANALYTICS.VARS.metro_code,time_zone:DIGIOH_LIGHTBOX_ANALYTICS.VARS.time_zone,area_code:DIGIOH_LIGHTBOX_ANALYTICS.VARS.area_code,latitude:DIGIOH_LIGHTBOX_ANALYTICS.VARS.latitude,longitude:DIGIOH_LIGHTBOX_ANALYTICS.VARS.longitude},device:{hardware:DIGIOH_LIGHTBOX_ANALYTICS.VARS.device,os:DIGIOH_LIGHTBOX_ANALYTICS.VARS.operating_system,browser_type:DIGIOH_LIGHTBOX_ANALYTICS.VARS.browser_type,browser_version:DIGIOH_LIGHTBOX_ANALYTICS.VARS.browser_version},entry_point:{referrer_url:DIGIOH_LIGHTBOX_ANALYTICS.VARS.referring_website_url,landing_page_url:DIGIOH_LIGHTBOX_ANALYTICS.VARS.landing_page,landing_page_ip:DIGIOH_LIGHTBOX_ANALYTICS.VARS.landing_page_ip,landing_page_date:DIGIOH_LIGHTBOX_ANALYTICS.VARS.date_of_visit,web_source:DIGIOH_LIGHTBOX_ANALYTICS.VARS.web_source,past_visits:DIGIOH_LIGHTBOX_ANALYTICS.VARS.past_visits,page_visits:DIGIOH_LIGHTBOX_ANALYTICS.VARS.page_visits,search_engine:DIGIOH_LIGHTBOX_ANALYTICS.VARS.search_engine,utm_campaign_source:DIGIOH_LIGHTBOX_ANALYTICS.VARS.utm_campaign_source,utm_campaign_medium:DIGIOH_LIGHTBOX_ANALYTICS.VARS.utm_campaign_medium,utm_campaign_term:DIGIOH_LIGHTBOX_ANALYTICS.VARS.utm_campaign_term,utm_campaign_content:DIGIOH_LIGHTBOX_ANALYTICS.VARS.utm_campaign_content,utm_campaign_name:DIGIOH_LIGHTBOX_ANALYTICS.VARS.utm_campaign_name}};return hash;}
catch(e){logError(e,"getAnalyticsDataForSubmission");}}
function effectsHasTeaserDisplayFancybox(lbid){try{return(EFFECTS.hasOwnProperty(lbid)&&EFFECTS[lbid].hasOwnProperty("fancybox")&&EFFECTS[lbid]["fancybox"].hasOwnProperty("teaser")&&(EFFECTS[lbid].fancybox.teaser.display||EFFECTS[lbid].fancybox.teaser.display_on_page_load));}
catch(e){logError(e,"effectsHasTeaserDisplayFancybox");}}
function effectsHasTeaserDisplaySidebar(lbid){try{return(EFFECTS.hasOwnProperty(lbid)&&EFFECTS[lbid].hasOwnProperty("sidebar")&&EFFECTS[lbid]["sidebar"].hasOwnProperty("teaser")&&(EFFECTS[lbid].sidebar.teaser.display||EFFECTS[lbid].sidebar.teaser.display_on_page_load));}
catch(e){logError(e,"effectsHasTeaserDisplaySidebar");}}
function registerCloseSidebarTime(lbid){try{if(EFFECTS[lbid].sidebar.auto_close.time>0){window.setTimeout,(1000*EFFECTS[lbid].sidebar.auto_close.time));}}
catch(e){logError(e,"registerCloseSidebarTime");}}
function registerCloseSidebarScroll(lbid){try{if(EFFECTS[lbid].sidebar.auto_close.scroll_up>0||EFFECTS[lbid].sidebar.auto_close.scroll_down>0){ELIGIBLE_SIDEBAR_CLOSE_SCROLL_GUIDS[lbid]=Math.round(jqWin.scrollTop());if(!body.hasClass('sidebar-body-scroll')){body.addClass('sidebar-body-scroll');jqWin.scroll);}
logger("registerCloseSidebarScroll");}}
catch(e){logError(e,"registerCloseSidebarScroll");}}
function registerCloseSidebarClick(lbid){try{if(EFFECTS[lbid].sidebar.auto_close.click){if(!body.hasClass('sidebar-body-click')){body.addClass('sidebar-body-click');}
JQUERY_DIGIOH('.sidebar-body-click').on(isMobile()?'touchstart':'mousedown');}}
catch(e){logError(e,"registerCloseSidebarClick");}}
var closeBanner=function(lbid){try{var dom_id=getLightboxDomId(lbid);if(JQUERY_DIGIOH('#'+dom_id).length&&(!SIDEBAR_CLOSE_MAP.hasOwnProperty(lbid)||SIDEBAR_CLOSE_MAP[lbid]!=1)){SIDEBAR_CLOSE_MAP[lbid]=1;removeActiveBox(lbid);if(body.hasClass('sidebar-body-click')){JQUERY_DIGIOH(".sidebar-body-click").off();body.removeClass('sidebar-body-click');}
if(PREVENT_SIDEBAR_CLOSE_GUIDS.hasOwnProperty(lbid)){delete PREVENT_SIDEBAR_CLOSE_GUIDS[lbid];}
FOCUSED_SIDEBAR_BANNER_GUIDS[lbid]=false;if(ELIGIBLE_SIDEBAR_CLOSE_SCROLL_GUIDS.hasOwnProperty(lbid)){delete ELIGIBLE_SIDEBAR_CLOSE_SCROLL_GUIDS[lbid];}
keepSendingEventNotificationToChildUntilReceived({sender:'lightbox',action:'before_lightbox_close'},lbid,100,0);registerLightboxClose(lbid);JQUERY_DIGIOH('#'+dom_id).hide();if(!EFFECTS[lbid].banner.hasOwnProperty('placement')||EFFECTS[lbid].banner.placement!=='bottom'){if(JQUERY_DIGIOH("#banner-spacer-"+lbid).length){JQUERY_DIGIOH("#banner-spacer-"+lbid).remove();}}}}
catch(e){logError(e,"closeBanner");}};var closeSidebar=function(lbid){try{var dom_id=getLightboxDomId(lbid);stopBoxScrollMode(lbid);if(JQUERY_DIGIOH('#'+dom_id).length&&(!SIDEBAR_CLOSE_MAP.hasOwnProperty(lbid)||SIDEBAR_CLOSE_MAP[lbid]!=1)){SIDEBAR_CLOSE_MAP[lbid]=1;removeActiveBox(lbid);if(body.hasClass('sidebar-body-click')){JQUERY_DIGIOH(".sidebar-body-click").off();body.removeClass('sidebar-body-click');}
if(EFFECTS[lbid].sidebar.position==='center-center'){JQUERY_DIGIOH('body').css({'overflow-y':'visible'});}
if(PREVENT_SIDEBAR_CLOSE_GUIDS.hasOwnProperty(lbid)){delete PREVENT_SIDEBAR_CLOSE_GUIDS[lbid];}
FOCUSED_SIDEBAR_BANNER_GUIDS[lbid]=false;if(ELIGIBLE_SIDEBAR_CLOSE_SCROLL_GUIDS.hasOwnProperty(lbid)){delete ELIGIBLE_SIDEBAR_CLOSE_SCROLL_GUIDS[lbid];}
keepSendingEventNotificationToChildUntilReceived({sender:'lightbox',action:'before_lightbox_close'},lbid,100,0);if(EFFECTS[lbid].sidebar.hasOwnProperty('overlay')&&EFFECTS[lbid].sidebar.overlay){if(JQUERY_DIGIOH("#sidebar-overlay-"+dom_id).length){JQUERY_DIGIOH("#sidebar-overlay-"+dom_id).remove();}else if(JQUERY_DIGIOH(".fb_lightbox-overlay").length){JQUERY_DIGIOH(".fb_lightbox-overlay").remove();}}
var ca=getCloseAnimation(EFFECTS[lbid].sidebar,lbid);if(!ca){ca={};registerLightboxClose(lbid);JQUERY_DIGIOH('#'+dom_id).hide();}else{logger('DIGIOH: getCloseAnimation...');logger(ca);JQUERY_DIGIOH('#'+dom_id).animate(ca,{duration:EFFECTS[lbid].sidebar.speed.close,easing:EFFECTS[lbid].sidebar.easing.close,complete});}}}
catch(e){logError(e,"closeSidebar");}};var closeInline=function(lbid){try{if(JQUERY_DIGIOH.inArray(lbid,PRELOADED_LIGHTBOXES)>-1)
{var dom_id=getLightboxDomId(lbid);if(JQUERY_DIGIOH("#"+dom_id).length)
{setTimeout,100);}
else
{DIGIOH_API.log('closeInline_5::::'+lbid);}
removeActiveBox(lbid);keepSendingEventNotificationToChildUntilReceived({sender:'lightbox',action:'before_lightbox_close'},lbid,100,0);registerLightboxClose(lbid);if(DIGIOH_API.contains(DIGIOH_LIGHTBOX_INLINE_DISPLAYED,lbid))
{DIGIOH_LIGHTBOX_INLINE_DISPLAYED=DIGIOH_API.remove(DIGIOH_LIGHTBOX_INLINE_DISPLAYED,lbid);}
else
{}
if(DIGIOH_API.contains(PRELOADED_LIGHTBOXES,lbid))
{PRELOADED_LIGHTBOXES=DIGIOH_API.remove(PRELOADED_LIGHTBOXES,lbid);}
else
{}}
else
{}}
catch(e){logError(e,"closeInline");}};function openTeaser(teaser,lbid){try{var teaserId='teaser-'+lbid;TEASER_LIGHTBOX_GUIDS[teaserId]="open";if(!JQUERY_DIGIOH('#'+teaserId).length){body.append("<div id=\""+teaserId+"\" class=\""+teaserId+"\" style=\""+getTeaserStyle(teaser)+"\">"+teaser.text+"</div>");JQUERY_DIGIOH('#'+teaserId).css(getBackgroundStyle(teaser.background));JQUERY_DIGIOH('#'+teaserId).css(getBorderStyle(teaser.border));JQUERY_DIGIOH('#'+teaserId).css(getFontStyle(teaser.font));JQUERY_DIGIOH('#'+teaserId).click);JQUERY_DIGIOH('#'+teaserId).mouseenter(function(){JQUERY_DIGIOH('#'+teaserId).css(getBackgroundStyle(teaser.background_hover));JQUERY_DIGIOH('#'+teaserId).css(getBorderStyle(teaser.border_hover));JQUERY_DIGIOH('#'+teaserId).css(getFontStyle(teaser.font_hover));}).mouseleave(function(){JQUERY_DIGIOH('#'+teaserId).css(getBackgroundStyle(teaser.background));JQUERY_DIGIOH('#'+teaserId).css(getBorderStyle(teaser.border));JQUERY_DIGIOH('#'+teaserId).css(getFontStyle(teaser.font));});JQUERY_DIGIOH('#'+teaserId).mousedown(function(){JQUERY_DIGIOH('#'+teaserId).css(getBackgroundStyle(teaser.background_focus));JQUERY_DIGIOH('#'+teaserId).css(getBorderStyle(teaser.border_focus));JQUERY_DIGIOH('#'+teaserId).css(getFontStyle(teaser.font_focus));}).mouseup);}
var oa=getTeaserOpenAnimation(teaser);JQUERY_DIGIOH('#'+teaserId).animate({top:oa.top,left:oa.left,right:oa.right,bottom:oa.bottom},{duration:500,easing:"swing",complete});}
catch(e){logError(e,"openTeaser");}}
function closeTeaser(teaser,lbid,triggerLightboxLoad){try{if(JQUERY_DIGIOH('#teaser-'+lbid).length){var ca=getTeaserCloseAnimation(teaser);if(!ca)ca={};JQUERY_DIGIOH('#teaser-'+lbid).animate({top:ca.top,left:ca.left,right:ca.right,bottom:ca.bottom},{duration:100,easing:"swing",complete:function(){JQUERY_DIGIOH('#teaser-'+lbid).remove();if(triggerLightboxLoad){loadLightbox(lbid);}}});}}
catch(e){logError(e,"closeTeaser");}}
function getTeaserCloseAnimation(teaser){try{var pos=teaser.position.split('-');var posx=pos[1];var posy=pos[0];var ca={};if(posx=='left'){if(posy=='top'){ca.left="-="+(teaser.width+teaser.offset_x)+"px";}else if(posy=='center'){ca.left="-="+(teaser.width+teaser.offset_x)+"px";}else if(posy=='bottom'){ca.bottom="-="+(teaser.height+teaser.offset_y)+"px";}}else if(posx=='center'){if(posy=='top'){ca.top="-="+(teaser.height+teaser.offset_y)+"px";}else if(posy=='bottom'){ca.bottom="-="+(teaser.height+teaser.offset_y)+"px";}}else if(posx=='right'){if(posy=='top'){ca.right="-="+(teaser.width+teaser.offset_x)+"px";}else if(posy=='center'){ca.right="-="+(teaser.width+teaser.offset_x)+"px";}else if(posy=='bottom'){ca.bottom="-="+(teaser.height+teaser.offset_y)+"px";}}
return ca;}
catch(e){logError(e,"getTeaserCloseAnimation");}}
function getTeaserOpenAnimation(teaser){try{var pos=teaser.position.split('-');var posx=pos[1];var posy=pos[0];var oa={};if(posx=='left'){if(posy=='top'){oa.left="+="+(teaser.width+teaser.offset_x)+"px";}else if(posy=='center'){oa.left="+="+(teaser.width+teaser.offset_x)+"px";}else if(posy=='bottom'){oa.bottom="+="+(teaser.height+teaser.offset_y)+"px";}}else if(posx=='center'){if(posy=='top'){oa.top="+="+(teaser.height+teaser.offset_y)+"px";}else if(posy=='bottom'){oa.bottom="+="+(teaser.height+teaser.offset_y)+"px";}}else if(posx=='right'){if(posy=='top'){oa.right="+="+(teaser.width+teaser.offset_x)+"px";}else if(posy=='center'){oa.right="+="+(teaser.width+teaser.offset_x)+"px";}else if(posy=='bottom'){oa.bottom="+="+(teaser.height+teaser.offset_y)+"px";}}
return oa;}
catch(e){logError(e,"getTeaserOpenAnimation");}}
function getTeaserStyle(teaser){try{var str="cursor: pointer; z-index: 9948030; ";str+="position: "+teaser.css_positioning+"; ";str+="width: "+teaser.width+"px; ";str+="height: "+teaser.height+"px; ";str+="padding-top: "+teaser.padding.top+"px; ";str+="padding-right: "+teaser.padding.right+"px; ";str+="padding-bottom: "+teaser.padding.bottom+"px; ";str+="padding-left: "+teaser.padding.left+"px; ";var pos=teaser.position.split('-');var posx=pos[1];var posy=pos[0];if(posx=='left'){if(posy=='top'){str+="left: -"+(teaser.width)+"px; ";str+="top: "+(teaser.offset_y)+"px; ";}else if(posy=='center'){str+="left: -"+(teaser.width)+"px; ";str+="top: 50%; margin-top: -"+(Math.round(teaser.height/2)+teaser.offset_y)+"px; ";}else if(posy=='bottom'){str+="left: "+(teaser.offset_x)+"px; ";str+="bottom: -"+(teaser.height)+"px; ";}}else if(posx=='center'){if(posy=='top'){str+="left: 50%; margin-left: -"+(Math.round(teaser.width/2)+teaser.offset_x)+"px; ";str+="top: -"+(teaser.height)+"px; ";}else if(posy=='bottom'){str+="left: 50%; margin-left: -"+(Math.round(teaser.width/2)+teaser.offset_x)+"px; ";str+="bottom: -"+(teaser.height)+"px; ";}}else if(posx=='right'){if(posy=='top'){str+="right: -"+(teaser.width)+"px; ";str+="top: "+(teaser.offset_y)+"px; ";}else if(posy=='center'){str+="right: -"+(teaser.width)+"px; ";str+="top: 50%; margin-top: -"+(Math.round(teaser.height/2)+teaser.offset_y)+"px; ";}else if(posy=='bottom'){str+="right: "+(teaser.offset_x)+"px; ";str+="bottom: -"+(teaser.height)+"px; ";}}
return str;}
catch(e){logError(e,"getTeaserStyle");}}
function getFontStyle(propFont){try{var hash={};hash["font-family"]=propFont.family;hash["font-weight"]=(propFont.bold?"bold":"normal");hash["font-style"]=(propFont.italic?"italic":"normal");hash["text-decoration"]=(propFont.underline?"underline":"none");hash["text-align"]=propFont.align;hash["font-size"]=propFont.size+"px";hash["color"]=propFont.color;return hash;}
catch(e){logError(e,"getFontStyle");}}
function getBorderStyle(propBorder){try{var hash={};if(propBorder.style==='none'||propBorder.width==='0'||propBorder.width===0){hash["border-style"]='none';hash["border-width"]='0px';hash["border-color"]='transparent';hash["border-radius"]='0px';}else{hash["border-color"]=propBorder.color;hash["border-style"]=propBorder.style;hash["border-width"]=propBorder.width+'px';hash["border-radius"]=propBorder.radius+'px';}
return hash;}
catch(e){logError(e,"getBorderStyle");}}
function getBackgroundStyle(propBackground){try{var hash={};if(propBackground.use_image&&propBackground.image.length>3&&propBackground.image!='none'){hash["background-image"]="url("+PROTOCOL_USER_OVERRIDE+"s3.lightboxcdn.com/vendors/"+VENDOR_GUID+"/uploads/"+propBackground.image+")";hash["background-repeat"]=propBackground.repeat;hash["background-position"]=propBackground.position;hash["background-color"]=propBackground.color;}
else if(propBackground.use_gradient&&propBackground.gradient.length>3){hash["background-image"]="none";if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.browser_type=="Chrome")
hash["background"]="-webkit-gradient(linear, left top, left bottom, from("+propBackground.color+"),to("+propBackground.gradient+"))";else if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.browser_type=="Safari")
hash["background"]="-webkit-linear-gradient(top, "+propBackground.color+","+propBackground.gradient+")";else if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.browser_type=="Opera")
hash["background"]="-o-linear-gradient(top, "+propBackground.color+","+propBackground.gradient+")";else if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.browser_type=="Firefox")
hash["background"]="-moz-linear-gradient(top, "+propBackground.color+","+propBackground.gradient+")";else if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.browser_type=="Internet Explorer")
hash["background"]="-ms-linear-gradient(top, "+propBackground.color+","+propBackground.gradient+")";else
hash["background"]="linear-gradient(to bottom,"+propBackground.color+","+propBackground.gradient+")";}
else{hash["background-image"]="none";hash["background-color"]=propBackground.color;}
return hash;}
catch(e){logError(e,"getBackgroundStyle");}}
function getCloseButtonStyle(prop,widget_type,lbid){try{var str="position: absolute; width: 36px; height: 36px; cursor: pointer; z-index: 9948040; background-image: url("+CLOSE_BUTTON_URL+");";if(typeof lbid==='string'&&lbid&&EFFECTS.hasOwnProperty(lbid))
{if(EFFECTS[lbid].widget_type&&EFFECTS[lbid].widget_type!=='inline'&&EFFECTS[lbid][EFFECTS[lbid].widget_type].hasOwnProperty('close_button_image')&&EFFECTS[lbid][EFFECTS[lbid].widget_type].close_button_image.length>30)
{var btnsrc='https://s3.lightboxcdn.com/vendors/'+DIGIOH_API.getAccountGuid()+'/uploads/'+EFFECTS[lbid][EFFECTS[lbid].widget_type].close_button_image;str="position: absolute; width: 36px; height: 36px; cursor: pointer; z-index: 9948040; background-image: url("+btnsrc+"); background-repeat: no-repeat; background-size: auto; background-position: center center;";}}
if(prop.display&&widget_type!="sidebar")str+="display: block; ";else str+="display: none; ";if(prop.position=='top-left'){str+="top: "+prop.offset_y+"px; ";str+="left: "+prop.offset_x+"px; ";}else if(prop.position=='top-right'){str+="top: "+prop.offset_y+"px; ";str+="right: "+prop.offset_x+"px; ";}else if(prop.position=='bottom-left'){str+="bottom: "+prop.offset_y+"px; ";str+="left: "+prop.offset_x+"px; ";}else if(prop.position=='bottom-right'){str+="bottom: "+prop.offset_y+"px; ";str+="right: "+prop.offset_x+"px; ";}
return str;}
catch(e){logError(e,"getCloseButtonStyle");}}
var setBoxToScrollMode=function(lid,page,event){try{var $=JQUERY_DIGIOH;DIGIOH_API.scroll_mode_data=DIGIOH_API.scroll_mode_data||{};if(typeof page=='undefined'){page='main';}
if(typeof event==='string'&&event==='window_resize'&&DIGIOH_API.scroll_mode_data&&DIGIOH_API.scroll_mode_data.lid){lid=DIGIOH_API.scroll_mode_data.lid;}
if(typeof event==='string'&&event==='change_pages'&&$('#lightbox-override').length){logger('setBoxToScrollMode:  Box page changed, forcing browser to scroll to the top of the box: '+page);$('#lightbox-override')[0].scrollTop=0;}
if((DIGIOH_API.LIGHTBOX.getActiveLightboxDomId()!=""||$('#lightbox-override').length)&&DIGIOH_API.DIGIOH_LIGHTBOX_SETTINGS.hasOwnProperty(lid)&&DIGIOH_LIGHTBOX_EFFECTS.hasOwnProperty(lid)&&DIGIOH_LIGHTBOX_EFFECTS[lid].widget_type=="sidebar"){if(typeof DIGIOH_API.DIGIOH_LIGHTBOX_SETTINGS[lid]==='string'&&DIGIOH_API.DIGIOH_LIGHTBOX_SETTINGS[lid].length>50&&DIGIOH_API.DIGIOH_LIGHTBOX_SETTINGS[lid].indexOf('{')<0){DIGIOH_API.scroll_mode_data.settings=JSON.parse(DIGIOH_API.LIGHTBOX.LZString.decompressFromBase64(DIGIOH_API.DIGIOH_LIGHTBOX_SETTINGS[lid]));}else if(typeof DIGIOH_API.DIGIOH_LIGHTBOX_SETTINGS[lid]==='string'&&DIGIOH_API.DIGIOH_LIGHTBOX_SETTINGS[lid].length>50&&DIGIOH_API.DIGIOH_LIGHTBOX_SETTINGS[lid].indexOf('{')>=0){DIGIOH_API.scroll_mode_data.settings=JSON.parse(DIGIOH_API.DIGIOH_LIGHTBOX_SETTINGS[lid]);}else{DIGIOH_API.scroll_mode_data.settings=DIGIOH_API.DIGIOH_LIGHTBOX_SETTINGS[lid];}
var activeBreakpoint=1000000;DIGIOH_API.scroll_mode_data.responsive_breakpoint_in_use=false;if(typeof DIGIOH_PIXEL_THRESHOLDS==='object'&&DIGIOH_PIXEL_THRESHOLDS&&DIGIOH_PIXEL_THRESHOLDS.hasOwnProperty(lid)&&DIGIOH_PIXEL_THRESHOLDS[lid]){Object.keys(DIGIOH_PIXEL_THRESHOLDS[lid]).forEach(function(key){if(DIGIOH_PIXEL_THRESHOLDS[lid].hasOwnProperty(key)&&$(window).width()<parseInt(key)&&parseInt(key)<activeBreakpoint){activeBreakpoint=parseInt(key);}});}
if(activeBreakpoint<100000&&DIGIOH_PIXEL_THRESHOLDS[lid].hasOwnProperty(activeBreakpoint.toString())){if(!DIGIOH_PIXEL_THRESHOLDS[lid][activeBreakpoint.toString()].hasOwnProperty('scrolling')||!DIGIOH_PIXEL_THRESHOLDS[lid][activeBreakpoint.toString()]['scrolling']['use']){logger("setBoxToScrollMode: scrolling was off for breakpoint ("+activeBreakpoint+") "+lid);stopBoxScrollMode(lid);return false;}
logger("setBoxToScrollMode: scrolling was on for breakpoint ("+activeBreakpoint+") "+lid);DIGIOH_API.scroll_mode_data.responsive_breakpoint_in_use=true;DIGIOH_API.scroll_mode_data.settings=DIGIOH_PIXEL_THRESHOLDS[lid][activeBreakpoint.toString()];}
else if(typeof DIGIOH_API.scroll_mode_data.settings!=='object'||!DIGIOH_API.scroll_mode_data.settings||!DIGIOH_API.scroll_mode_data.settings.hasOwnProperty('scrolling')||!DIGIOH_API.scroll_mode_data.settings.scrolling.use){logger("setBoxToScrollMode: scrolling was off for sidebar "+lid);stopBoxScrollMode(lid);return false;}
DIGIOH_API.scroll_mode_data.is_scroll_box_active=true;if(lid){DIGIOH_API.scroll_mode_data.lid=lid;}
var layoutName=page=="main"?"layout":page+"layout";DIGIOH_API.scroll_mode_data.currentPage=page;if(!$('#lightbox-override').length){$('#'+DIGIOH_API.LIGHTBOX.getLightboxDomId(lid)).attr('id','lightbox-override').attr('style','');logger('setBoxToScrollMode:  going to override the box positioning');}
else{logger('setBoxToScrollMode:  updating scroll box positioning: '+DIGIOH_API.scroll_mode_data.settings.scrolling.use+', '+DIGIOH_API.scroll_mode_data.responsive_breakpoint_in_use);}
DIGIOH_API.scroll_mode_data.pageUpdate=page;scrollModeSetCSSSettings(DIGIOH_API.scroll_mode_data.settings);$("head,body").addClass("digioh_overlay_style");$('#lightbox-override').css('height',$(window).height()+"px").css('width',$(window).width()+"px").css('margin-left','unset').css('margin-top','unset').css('top',$(window).scrollTop()+'px');$('#lightbox-override iframe').attr('style','').attr('data-layout',layoutName).addClass('digioh_override');if(CURRENT_PAGE&&CURRENT_PAGE.hasOwnProperty(lid)&&$('#lightbox-override iframe.digioh_override').length){var pg=CURRENT_PAGE[lid].replace('_','');if(pg=='main')pg='';$('#lightbox-override iframe.digioh_override').attr('data-layout',pg+'layout');logger('setBoxToScrollMode:  data-layout set to page: '+pg);}
if($("#lightbox-override > iframe[id^='lightbox-iframe-']").contents().find("button[custom_close_btn]").length){$("#lightbox-override > iframe[id^='lightbox-iframe-']").contents().find("button[custom_close_btn]").on(DIGIOH_API.LIGHTBOX.isMobile()?'touchend':'click');}}}
catch(e){logError(e,"setBoxToScrollMode");return 1;}}
var stopBoxScrollMode=function(lid){if(DIGIOH_API.hasOwnProperty('scroll_mode_data')&&DIGIOH_API.scroll_mode_data.hasOwnProperty('is_scroll_box_active')&&DIGIOH_API.scroll_mode_data.is_scroll_box_active){delete DIGIOH_API.scroll_mode_data.settings;delete DIGIOH_API.scroll_mode_data.pageUpdate;delete DIGIOH_API.scroll_mode_data.currentPage;JQUERY_DIGIOH('#digioh_element_styles').remove();JQUERY_DIGIOH("head,body").removeClass("digioh_overlay_style");JQUERY_DIGIOH("#lightbox-override iframe").removeClass("digioh_override").removeAttr('data-layout');JQUERY_DIGIOH('#lightbox-override').attr('id',DIGIOH_API.LIGHTBOX.getLightboxDomId(lid));logger('stopBoxScrollMode');}};function getResponsiveScaleMultiplier(lid){try{var pref=getPagePref(lid);if(EFFECTS[lid].hasOwnProperty(pref+'scaling')&&EFFECTS[lid][pref+'scaling'].use===true){var ww=JQUERY_DIGIOH(window).width();var wh=JQUERY_DIGIOH(window).height();var bw=getBoxWidth(lid);var bh=getBoxHeight(lid);var scale=EFFECTS[lid][pref+'scaling'];if(scale.max_type&&scale.max_type==='pct'){if(scale.max_width_pct){ww=ww*scale.max_width_pct/100;}
if(scale.max_height_pct){wh=wh*scale.max_height_pct/100;}}else if(scale.max_type&&scale.max_type==='abs'){if(scale.max_width&&scale.max_width<ww){ww=scale.max_width;}
if(scale.max_height&&scale.max_height<wh){wh=scale.max_height;}}else if(scale.max_type&&scale.max_type==='win'){}
var mh=wh/bh;var mw=ww/bw;var m=1;if(mh<mw){m=mh;}else{m=mw;}
return m;}
else{return 1;}}
catch(e){logError(e,"getResponsiveScaleMultiplier");return 1;}}
function getResponsiveScale(lid){try{var pref=getPagePref(lid);if(EFFECTS[lid].hasOwnProperty(pref+'scaling')&&EFFECTS[lid][pref+'scaling'].use===true){var m=getResponsiveScaleMultiplier(lid);var str='';str+='-webkit-transform: scale('+m+');';str+='-moz-transform: scale('+m+');';str+='-ms-transform: scale('+m+');';str+='-o-transform: scale('+m+');';str+='transform: scale('+m+');';if(EFFECTS[lid].widget_type==='banner'&&EFFECTS[lid].banner.placement==='bottom'){str+='transform-origin: 50% 100%;';}else if(EFFECTS[lid].widget_type==='banner'&&EFFECTS[lid].banner.placement==='top'){str+='transform-origin: 50% 0%;';}
if(EFFECTS[lid].widget_type==='sidebar'&&EFFECTS[lid].sidebar.position==='top-left'){str+='transform-origin: 0% 0%;';}else if(EFFECTS[lid].widget_type==='sidebar'&&EFFECTS[lid].sidebar.position==='top-center'){str+='transform-origin: 50% 0%;';}else if(EFFECTS[lid].widget_type==='sidebar'&&EFFECTS[lid].sidebar.position==='top-right'){str+='transform-origin: 100% 0%;';}
else if(EFFECTS[lid].widget_type==='sidebar'&&EFFECTS[lid].sidebar.position==='center-left'){str+='transform-origin: 0% 50%;';}else if(EFFECTS[lid].widget_type==='sidebar'&&EFFECTS[lid].sidebar.position==='center-center'){str+='transform-origin: 50% 50%;';}else if(EFFECTS[lid].widget_type==='sidebar'&&EFFECTS[lid].sidebar.position==='center-right'){str+='transform-origin: 100% 50%;';}
else if(EFFECTS[lid].widget_type==='sidebar'&&EFFECTS[lid].sidebar.position==='bottom-left'){str+='transform-origin: 0% 100%;';}else if(EFFECTS[lid].widget_type==='sidebar'&&EFFECTS[lid].sidebar.position==='bottom-center'){str+='transform-origin: 50% 100%;';}else if(EFFECTS[lid].widget_type==='sidebar'&&EFFECTS[lid].sidebar.position==='bottom-right'){str+='transform-origin: 100% 100%;';}
return str;}
else{return '';}}
catch(e){logError(e,"getResponsiveScale");return '';}}
function getResponsiveScaleInline(lid,dom_id){try{var pref=getPagePref(lid);if(EFFECTS[lid].hasOwnProperty(pref+'scaling')&&EFFECTS[lid][pref+'scaling'].use===true){var ww=JQUERY_DIGIOH('#'+dom_id).parent().width();var wh=JQUERY_DIGIOH('#'+dom_id).parent().height();var bw=getBoxWidth(lid);var bh=getBoxHeight(lid);var scale=EFFECTS[lid][pref+'scaling'];if(scale.max_type&&scale.max_type==='pct'){if(scale.max_width_pct){ww=ww*scale.max_width_pct/100;}
if(scale.max_height_pct){wh=wh*scale.max_height_pct/100;}}else if(scale.max_type&&scale.max_type==='abs'){if(scale.max_width&&scale.max_width<ww){ww=scale.max_width;}
if(scale.max_height&&scale.max_height<wh){wh=scale.max_height;}}else if(scale.max_type&&scale.max_type==='win'){}
var mh=wh/bh;var mw=ww/bw;var m=1;if(mh<mw){m=mh;}else{m=mw;}
var str='';str+='-webkit-transform: scale('+m+');';str+='-moz-transform: scale('+m+');';str+='-ms-transform: scale('+m+');';str+='-o-transform: scale('+m+');';str+='transform: scale('+m+');';return str;}
else{return '';}}
catch(e){logError(e,"getResponsiveScaleInline");return '';}}
function getBannerPosition(prop,lid){try{var css_pos='';if(prop.hasOwnProperty('placement')&&prop.placement==='bottom'){css_pos="fixed";}else if(prop.css_positioning=="fixed"&&isMobile()){css_pos=prop.css_positioning;}else{css_pos=prop.css_positioning;}
var str="position: "+css_pos+"; ";var dims_box=getActualBoxWidthAndHeight(lid);str+="width: "+dims_box.width+"px; ";str+="height: "+dims_box.height+"px; ";str+="z-index: 9948030; ";str+="left: 50%; margin-left: -"+Math.round(dims_box.width/2)+"px; ";str+=getResponsiveScale(lid);if(css_pos==="fixed"){if(prop.hasOwnProperty('placement')&&prop.placement==='bottom'){str+="bottom: 0px; ";}else{str+="top: 0px; ";}}else{var st=jqWin.scrollTop();if(prop.hasOwnProperty('placement')&&prop.placement==='bottom'){str+="bottom: 0px; ";}else if(prop.hasOwnProperty('placement')&&prop.placement==='top'){str+="top: 0px; ";}}
if(EFFECTS[lid]['banner'].hasOwnProperty('css')&&typeof EFFECTS[lid]['banner']['css']==='string'&&EFFECTS[lid]['banner']['css'].indexOf(':')>0){str+=EFFECTS[lid]['banner']['css'];}
return str;}
catch(e){logError(e,"getBannerPosition");}}
function getSidebarPosition(prop,lid){try{var css_pos='';if(prop.css_positioning=="fixed"&&isMobile()){css_pos=prop.css_positioning;}else{css_pos=prop.css_positioning;}
css_pos='fixed';var str="position: "+css_pos+"; ";var actualWindowWidthPixels=JQUERY_DIGIOH(window).width();var actualWindowHeightPixels=JQUERY_DIGIOH(window).height();var dims_box=getActualBoxWidthAndHeight(lid);str+="width: "+dims_box.width+"px; ";str+="height: "+dims_box.height+"px; ";str+="z-index: 9948030; ";str+=getResponsiveScale(lid);var pos=prop.position.split('-');var posx=pos[1];var posy=pos[0];if(css_pos==="fixed"){var offset_x=-1*Math.round(dims_box.width/2);var offset_y=-1*Math.round(dims_box.height/2);if(prop.hasOwnProperty('offset')&&prop.offset.hasOwnProperty('left')){if(prop.offset.left==0){offset_x=-1*(actualWindowWidthPixels/2)+30;}
else if(prop.offset.left==10){offset_x=1*(actualWindowWidthPixels/2)-dims_box.width-30;}
else if(prop.offset.left<5){offset_x=((prop.offset.left-5)/5)*((actualWindowWidthPixels/2)-Math.round(dims_box.width/2))-Math.round(dims_box.width/2);}
else if(prop.offset.left>5){offset_x=((prop.offset.left-5)/5)*((actualWindowWidthPixels/2)-Math.round(dims_box.width/2))-Math.round(dims_box.width/2);}}
if(prop.hasOwnProperty('offset')&&prop.offset.hasOwnProperty('top')){if(prop.offset.top==0){offset_y=-1*(actualWindowHeightPixels/2)+30;}
else if(prop.offset.top==10){offset_y=1*(actualWindowHeightPixels/2)-dims_box.height-30;}
else if(prop.offset.top<5){offset_y=((prop.offset.top-5)/5)*((actualWindowHeightPixels/2)-Math.round(dims_box.height/2))-Math.round(dims_box.height/2);}
else if(prop.offset.top>5){offset_y=((prop.offset.top-5)/5)*((actualWindowHeightPixels/2)-Math.round(dims_box.height/2))-Math.round(dims_box.height/2);}}
if(prop.animation.open=="slideUp"){str+="top: "+Math.ceil(actualWindowHeightPixels)+"px; ";}else if(prop.animation.open=="slideDown"){str+="top: "+Math.ceil(-1*dims_box.height)+"px; ";}else if(prop.animation.open=="slideRight"){str+="left: "+Math.ceil(-1*dims_box.width)+"px; ";}else if(prop.animation.open=="slideLeft"){str+="left: "+Math.ceil(actualWindowWidthPixels)+"px; ";}
if(prop.animation.open=="slideUp"||prop.animation.open=="slideDown"){if(posx=='left')str+="left: 0px; ";else if(posx=='center')str+="left: 50%; margin-left: "+offset_x+"px; ";else if(posx=='right')str+="right: 0px; ";}else if(prop.animation.open=="slideLeft"||prop.animation.open=="slideRight"){if(posy=='top')str+="top: 0px; ";else if(posy=='center')str+="top: 50%; margin-top: "+offset_y+"px; ";else if(posy=='bottom')str+="bottom: 0px; ";}else if(prop.animation.open=="fade"||prop.animation.open=="elastic"){if(posx=='left')str+="left: 0px; ";else if(posx=='center')str+="left: 50%; margin-left: "+offset_x+"px; ";else if(posx=='right')str+="right: 0px; ";if(posy=='top')str+="top: 0px; ";else if(posy=='center')str+="top: 50%; margin-top: "+offset_y+"px; ";else if(posy=='bottom')str+="bottom: 0px; ";}}else{var st=jqWin.scrollTop();if(prop.animation.open=="slideUp"){str+="top: "+Math.ceil(actualWindowHeightPixels+st)+"px; ";}else if(prop.animation.open=="slideDown"){str+="top: "+(Math.ceil(st)+Math.ceil(-1*dims_box.height))+"px; ";}else if(prop.animation.open=="slideRight"){str+="left: "+Math.ceil(-1*dims_box.width)+"px; ";}else if(prop.animation.open=="slideLeft"){str+="left: "+Math.ceil(actualWindowWidthPixels)+"px; ";}
if(prop.animation.open=="slideUp"||prop.animation.open=="slideDown"){if(posx=='left')str+="left: 0px; ";else if(posx=='center')str+="left: "+(Math.round(jqWin.width()/2)-Math.round(dims_box.width/2))+"px; ";else if(posx=='right')str+="left: "+Math.ceil(jqWin.width()-dims_box.width)+"px; ";}else if(prop.animation.open=="slideLeft"||prop.animation.open=="slideRight"){if(posy=='top')str+="top: "+Math.ceil(st)+"px; ";else if(posy=='center')str+="top: "+(Math.ceil(st)+Math.round(actualWindowHeightPixels/2)-Math.round(dims_box.height/2))+"px; ";else if(posy=='bottom')str+="top: "+Math.ceil(st+jqWin.height()-dims_box.height)+"px; ";}else if(prop.animation.open=="fade"||prop.animation.open=="elastic"){if(posx=='left')str+="left: 0px; ";else if(posx=='center')str+="left: "+(Math.round(jqWin.width()/2)-Math.round(dims_box.width/2))+"px; ";else if(posx=='right')str+="left: "+Math.ceil(jqWin.width()-dims_box.width)+"px; ";if(posy=='top')str+="top: "+Math.ceil(st)+"px; ";else if(posy=='center')str+="top: "+(Math.ceil(st)+Math.round(actualWindowHeightPixels/2)-Math.round(dims_box.height/2))+"px; ";else if(posy=='bottom')str+="top: "+Math.ceil(st+jqWin.height()-dims_box.height)+"px; ";}}
if(EFFECTS[lid]['sidebar'].hasOwnProperty('css')&&typeof EFFECTS[lid]['sidebar']['css']==='string'&&EFFECTS[lid]['sidebar']['css'].indexOf(':')>0){str+=EFFECTS[lid]['sidebar']['css'];}
return str;}
catch(e){logError(e,"getSidebarPosition");}}
function getSidebarPositionAfterAnimation(prop,lid){try{var css_pos='';if(prop.css_positioning=="fixed"&&isMobile()){css_pos=prop.css_positioning;}else{css_pos=prop.css_positioning;}
var str="position: "+css_pos+"; ";var actualWindowWidthPixels=JQUERY_DIGIOH(window).width();var actualWindowHeightPixels=JQUERY_DIGIOH(window).height();var dims_box=getActualBoxWidthAndHeight(lid);str+="width: "+dims_box.width+"px; ";str+="height: "+dims_box.height+"px; ";str+="z-index: 9948030; ";str+=getResponsiveScale(lid);var pos=prop.position.split('-');var posx=pos[1];var posy=pos[0];var st=jqWin.scrollTop();if(css_pos==="fixed"){var offset_x=(Math.round(jqWin.width()/2)-Math.round(dims_box.width/2));var offset_y=(Math.round(jqWin.height()/2)-Math.round(dims_box.height/2));if(prop.hasOwnProperty('offset')&&prop.offset.hasOwnProperty('left')){if(prop.offset.left==0){offset_x=30;}
else if(prop.offset.left==10){offset_x=actualWindowWidthPixels-dims_box.width-30;}
else if(prop.offset.left<5){offset_x=(prop.offset.left/5)*((actualWindowWidthPixels/2)-Math.round(dims_box.width/2));}
else if(prop.offset.left>5){offset_x=((prop.offset.left-5)/5)*((actualWindowWidthPixels/2)-Math.round(dims_box.width/2))+(actualWindowWidthPixels/2)-Math.round(dims_box.width/2);}}
if(prop.hasOwnProperty('offset')&&prop.offset.hasOwnProperty('top')){if(prop.offset.top==0){offset_y=30;}
else if(prop.offset.top==10){offset_y=actualWindowHeightPixels-dims_box.height-30;}
else if(prop.offset.top<5){offset_y=(prop.offset.top/5)*((actualWindowHeightPixels/2)-Math.round(dims_box.height/2));}
else if(prop.offset.top>5){offset_y=((prop.offset.top-5)/5)*((actualWindowHeightPixels/2)-Math.round(dims_box.height/2))+(actualWindowHeightPixels/2)-Math.round(dims_box.height/2);}}
if(posx=='left')str+="left: 0px; ";else if(posx=='center')str+="left: "+offset_x+"px; ";else if(posx=='right')str+="left: "+Math.ceil(jqWin.width()-dims_box.width)+"px; ";if(posy=='top')str+="top: 0px; ";else if(posy=='center')str+="top: "+offset_y+"px; ";else if(posy=='bottom')str+="bottom: 0px; ";}else{if(posx=='left')str+="left: 0px; ";else if(posx=='center')str+="left: "+(Math.round(jqWin.width()/2)-Math.round(dims_box.width/2))+"px; ";else if(posx=='right')str+="left: "+Math.ceil(jqWin.width()-dims_box.width)+"px; ";if(posy=='top')str+="top: "+Math.ceil(st)+"px; ";else if(posy=='center')str+="top: "+(Math.ceil(st)+Math.round(jqWin.height()/2)-Math.round(dims_box.height/2))+"px; ";else if(posy=='bottom')str+="top: "+Math.ceil(st+jqWin.height()-dims_box.height)+"px; ";}
if(EFFECTS[lid]['sidebar'].hasOwnProperty('css')&&typeof EFFECTS[lid]['sidebar']['css']==='string'&&EFFECTS[lid]['sidebar']['css'].indexOf(':')>0){str+=EFFECTS[lid]['sidebar']['css'];}
return str;}
catch(e){logError(e,"getSidebarPositionAfterAnimation");}}
function setSidebarPositionBeforeClose(lid){try{var css_pos='fixed';var str="position: "+css_pos+"; ";var dom_id=getLightboxDomId(lid);var dom_ele=JQUERY_DIGIOH('#'+dom_id);var offset=dom_ele.offset();logger('setSidebarPositionBeforeClose ==> offset: ');logger(offset);var st=jqWin.scrollTop();var top=Math.ceil(offset.top-st)+'px';var left=Math.ceil(offset.left)+'px';logger('top: '+top+', left: '+left);dom_ele.css({'position':'fixed',"left":left,"top":top});}
catch(e){logError(e,"setSidebarPositionBeforeClose");}}
function getSidebarPositionMobileFocused(prop,lid){try{var str="";str+="position: absolute; ";var dims_box=getActualBoxWidthAndHeight(lid);str+="width: "+dims_box.width+"px; ";str+="height: "+dims_box.height+"px; ";str+="z-index: 9948030; ";str+="left: 50%; margin-left: -"+Math.round(dims_box.width/2)+"px; ";str+=getResponsiveScale(lid);var top=JQUERY_DIGIOH(window).scrollTop();var m=getResponsiveScaleMultiplier(lid);if(m>1)
{top=top+((dims_box.height*m)-dims_box.height);}
else if(m<1)
{top=top-(dims_box.height-(dims_box.height*m));}
str+="top: "+top+'px;';if(EFFECTS[lid]['sidebar'].hasOwnProperty('css')&&typeof EFFECTS[lid]['sidebar']['css']==='string'&&EFFECTS[lid]['sidebar']['css'].indexOf(':')>0){str+=EFFECTS[lid]['sidebar']['css'];}
return str;}
catch(e){logError(e,"getSidebarPositionMobileFocused");}}
function getBannerPositionMobileFocused(prop,lid){try{var str="";str+="position: absolute; ";var dims_box=getActualBoxWidthAndHeight(lid);str+="width: "+dims_box.width+"px; ";str+="height: "+dims_box.height+"px; ";str+="z-index: 9948030; ";str+="left: 50%; margin-left: -"+Math.round(dims_box.width/2)+"px; ";str+=getResponsiveScale(lid);var top=JQUERY_DIGIOH(window).scrollTop();var m=getResponsiveScaleMultiplier(lid);if(m>1)
{top=top+((dims_box.height*m)-dims_box.height);}
else if(m<1)
{top=top-(dims_box.height-(dims_box.height*m));}
str+="top: "+top+'px;';if(EFFECTS[lid]['banner'].hasOwnProperty('css')&&typeof EFFECTS[lid]['banner']['css']==='string'&&EFFECTS[lid]['banner']['css'].indexOf(':')>0){str+=EFFECTS[lid]['banner']['css'];}
return str;}
catch(e){logError(e,"getBannerPositionMobileFocused");}}
function getOpenAnimation(prop,lbid){try{var css_pos='';if(prop.css_positioning=="fixed"&&isMobile()){css_pos=prop.css_positioning;}else{css_pos=prop.css_positioning;}
var pos=prop.position.split('-');var posx=pos[1];var posy=pos[0];var oa={};var actualWindowWidthPixels=JQUERY_DIGIOH(window).width();var actualWindowHeightPixels=JQUERY_DIGIOH(window).height();var dims_box=getActualBoxWidthAndHeight(lbid);var offset_x=(Math.round(actualWindowWidthPixels/2)+Math.round(dims_box.width/2));var offset_y=(Math.round(actualWindowHeightPixels/2)+Math.round(dims_box.height/2));if(prop.hasOwnProperty('offset')&&prop.offset.hasOwnProperty('left')){if(prop.offset.left==0&&prop.animation.open=="slideRight"){offset_x=dims_box.width+30;}
else if(prop.offset.left==0&&prop.animation.open=="slideLeft"){offset_x=actualWindowWidthPixels-45;}
else if(prop.offset.left==10&&prop.animation.open=="slideRight"){offset_x=actualWindowWidthPixels-30;}
else if(prop.offset.left==10&&prop.animation.open=="slideLeft"){offset_x=dims_box.width+15;}
else if(prop.offset.left<5&&prop.animation.open=="slideLeft"){offset_x=actualWindowWidthPixels-((prop.offset.left/5)*((actualWindowWidthPixels/2)-Math.round(dims_box.width/2)))-15;}
else if(prop.offset.left<5&&prop.animation.open=="slideRight"){offset_x=(prop.offset.left/5)*((actualWindowWidthPixels/2)-Math.round(dims_box.width/2))+dims_box.width;}
else if(prop.offset.left>5&&prop.animation.open=="slideLeft"){offset_x=(((10-prop.offset.left)/5)*((actualWindowWidthPixels/2)-Math.round(dims_box.width/2)))+dims_box.width-15;}
else if(prop.offset.left>5&&prop.animation.open=="slideRight"){offset_x=((prop.offset.left-5)/5)*((actualWindowWidthPixels/2)-Math.round(dims_box.width/2))+(actualWindowWidthPixels/2)+(dims_box.width/2);}}
if(prop.hasOwnProperty('offset')&&prop.offset.hasOwnProperty('top')){if(prop.offset.top==0&&prop.animation.open=="slideDown"){offset_y=dims_box.height+30;}
else if(prop.offset.top==0&&prop.animation.open=="slideUp"){offset_y=actualWindowHeightPixels-30;}
else if(prop.offset.top==10&&prop.animation.open=="slideDown"){offset_y=actualWindowHeightPixels-30;}
else if(prop.offset.top==10&&prop.animation.open=="slideUp"){offset_y=dims_box.height+30;}
else if(prop.offset.top<5&&prop.animation.open=="slideUp"){offset_y=actualWindowHeightPixels-((prop.offset.top/5)*((actualWindowHeightPixels/2)-Math.round(dims_box.height/2)))-15;}
else if(prop.offset.top<5&&prop.animation.open=="slideDown"){offset_y=(prop.offset.top/5)*((actualWindowHeightPixels/2)-Math.round(dims_box.height/2))+dims_box.height;}
else if(prop.offset.top>5&&prop.animation.open=="slideUp"){offset_y=(((10-prop.offset.top)/5)*((actualWindowHeightPixels/2)-Math.round(dims_box.height/2)))+dims_box.height-15;}
else if(prop.offset.top>5&&prop.animation.open=="slideDown"){offset_y=((prop.offset.top-5)/5)*((actualWindowHeightPixels/2)-Math.round(dims_box.height/2))+(actualWindowHeightPixels/2)+(dims_box.height/2);}}
if(css_pos==="fixed"){if(prop.animation.open=="slideUp"){if(posy=='top'){oa.top="-="+Math.ceil(actualWindowHeightPixels)+"px";}else if(posy=='center'){oa.top="-="+offset_y+"px";}else if(posy=='bottom'){oa.top="-="+Math.ceil(dims_box.height)+"px";}
return oa;}else if(prop.animation.open=="slideDown"){if(posy=='top'){oa.top="+="+Math.ceil(dims_box.height)+"px";}else if(posy=='center'){oa.top="+="+offset_y+"px";}else if(posy=='bottom'){oa.top="+="+Math.ceil(actualWindowHeightPixels)+"px";}
return oa;}
if(prop.animation.open=="slideRight"){if(posx=='left'){oa.left="+="+Math.ceil(dims_box.width)+"px";}else if(posx=='center'){oa.left="+="+offset_x+"px";}else if(posx=='right'){oa.left="+="+Math.ceil(actualWindowWidthPixels)+"px";}
return oa;}else if(prop.animation.open=="slideLeft"){if(posx=='left'){oa.left="-="+Math.ceil(actualWindowWidthPixels)+"px";}else if(posx=='center'){oa.left="-="+offset_x+"px";}else if(posx=='right'){oa.left="-="+Math.ceil(dims_box.width)+"px";}
return oa;}}else{var st=jqWin.scrollTop();if(prop.animation.open=="slideUp"){if(posy=='top'){oa.top="-="+Math.ceil(actualWindowHeightPixels)+"px";}else if(posy=='center'){oa.top="-="+Math.ceil((actualWindowHeightPixels/2)+(dims_box.height/2))+"px";}else if(posy=='bottom'){oa.top="-="+Math.ceil(dims_box.height)+"px";}
return oa;}else if(prop.animation.open=="slideDown"){if(posy=='top'){oa.top="+="+Math.ceil(dims_box.height)+"px";}else if(posy=='center'){oa.top="+="+Math.ceil((actualWindowHeightPixels/2)+(dims_box.height/2))+"px";}else if(posy=='bottom'){oa.top="+="+(Math.ceil(actualWindowHeightPixels))+"px";}
return oa;}
if(prop.animation.open=="slideRight"){if(posx=='left'){oa.left="+="+Math.ceil(dims_box.width)+"px";}else if(posx=='center'){oa.left="+="+Math.ceil((actualWindowWidthPixels/2)+(dims_box.width/2))+"px";}else if(posx=='right'){oa.left="+="+Math.ceil(actualWindowWidthPixels)+"px";}
return oa;}else if(prop.animation.open=="slideLeft"){if(posx=='left'){oa.left="-="+Math.ceil(actualWindowWidthPixels)+"px";}else if(posx=='center'){oa.left="-="+Math.ceil((actualWindowWidthPixels/2)+(dims_box.width/2))+"px";}else if(posx=='right'){oa.left="-="+Math.ceil(dims_box.width)+"px";}
return oa;}}
return false;}
catch(e){logError(e,"getOpenAnimation");}}
function getCloseAnimation(prop,lbid){try{var pos=prop.position.split('-');var posx=pos[1];var posy=pos[0];var ca={};var actualWindowWidthPixels=JQUERY_DIGIOH(window).width();var actualWindowHeightPixels=JQUERY_DIGIOH(window).height();var dims_box=getActualBoxWidthAndHeight(lbid);var dom_id=getLightboxDomId(lbid);var dom_ele=JQUERY_DIGIOH('#'+dom_id);var offset=dom_ele.offset();logger('getCloseAnimation ==> offset: ');var st=jqWin.scrollTop();var top=Math.ceil(offset.top-st);var left=Math.ceil(offset.left);logger('top: '+top+', left: '+left);if(prop.animation.close=="slideUp"){ca.top="-="+Math.ceil(top+dims_box.height)+"px";return ca;}else if(prop.animation.close=="slideDown"){ca.top="+="+Math.ceil(actualWindowHeightPixels-top)+"px";return ca;}else if(prop.animation.close=="slideRight"){ca.left="+="+Math.ceil(actualWindowWidthPixels-left)+"px";return ca;}else if(prop.animation.close=="slideLeft"){ca.left="-="+Math.ceil(left+dims_box.width)+"px";return ca;}
return false;}
catch(e){logError(e,"getCloseAnimation");}}
var isInlineLightbox=function(lid){try{if(lid.length<30){var boxShortId=lid;for(var lbguid in DIGIOH_LIGHTBOX_IDS){if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(lbguid)&&DIGIOH_LIGHTBOX_IDS[lbguid]==boxShortId){lid=lbguid;break;}}}
var idxArrAlways=JQUERY_DIGIOH.inArray(lid,DIGIOH_LIGHTBOX_INLINE_ALWAYS_ARR);var idxArrConditions=JQUERY_DIGIOH.inArray(lid,DIGIOH_LIGHTBOX_INLINE_CONDITIONS_ARR);return(idxArrAlways>=0||idxArrConditions>=0);}
catch(e){logError(e,"isInlineLightbox");}}
function registerLightboxShow(lbid){try{var var_id='';var orig_lid=lbid;if(DIGIOH_VARIATION_TO_BOX_MAP.hasOwnProperty(lbid)){orig_lid=DIGIOH_VARIATION_TO_BOX_MAP[lbid];var_id=lbid;}else if(LIGHTBOX_TO_VARIATION_MAP.hasOwnProperty(lbid)){var_id=LIGHTBOX_TO_VARIATION_MAP[lbid];}
logger('DIGIOH: registerLightboxShow: '+lbid);updateLightboxActivityView(orig_lid);analyticsLightboxDisplay(lbid);var af=false;if(var_id&&var_id.length>7&&EFFECTS.hasOwnProperty(var_id)&&EFFECTS[var_id].widget_type){if(EFFECTS[var_id].widget_type==="fancybox"){af=true;}
else if(EFFECTS[var_id].widget_type==="sidebar"&&EFFECTS[var_id].sidebar.position=='center-center'){af=true;}}
else if(EFFECTS.hasOwnProperty(orig_lid)&&EFFECTS[orig_lid].widget_type){if(EFFECTS[orig_lid].widget_type==="fancybox"){af=true;}
else if(EFFECTS[orig_lid].widget_type==="sidebar"&&EFFECTS[orig_lid].sidebar.position=='center-center'){af=true;}}
keepSendingEventNotificationToChildUntilReceived({sender:'lightbox',action:'after_lightbox_display',auto_focus:af},(var_id&&var_id.length>7?var_id:lbid),100,0);if(!IS_PREVIEW||IS_DEV){if(!isInlineLightbox(lbid)||doesInlineLightboxHaveCustomJsType(lbid,'display')||doesInlineLightboxHaveCustomJsType(lbid,'all')){DIGIOH_CUSTOM_JS_SUPER.runCustomJsOnLightboxDisplay(window.DIGIOH_API,window,document,JQUERY_DIGIOH,orig_lid,var_id,getCustomJsMetadata(orig_lid));logger('JS_GLOBAL.runCustomJsOnLightboxDisplay - '+lbid);DIGIOH_CUSTOM_JS.runCustomJsOnLightboxDisplay(window.DIGIOH_API,window,document,JQUERY_DIGIOH,orig_lid,var_id,getCustomJsMetadata(orig_lid));logger('JS_PARENT.runCustomJsOnLightboxDisplay - '+lbid);}}}
catch(e){logError(e,"registerLightboxShow");}}
function registerLightboxSubmit(lbid){try{var var_id='';var orig_lid=lbid;if(DIGIOH_VARIATION_TO_BOX_MAP.hasOwnProperty(lbid)){orig_lid=DIGIOH_VARIATION_TO_BOX_MAP[lbid];var_id=lbid;}else if(LIGHTBOX_TO_VARIATION_MAP.hasOwnProperty(lbid)){var_id=LIGHTBOX_TO_VARIATION_MAP[lbid];}
updateLightboxActivitySubmit(orig_lid);if(!IS_PREVIEW||IS_DEV){if(!isInlineLightbox(lbid)||doesInlineLightboxHaveCustomJsType(lbid,'submit')||doesInlineLightboxHaveCustomJsType(lbid,'all')){DIGIOH_CUSTOM_JS_SUPER.runCustomJsOnLightboxSubmit(window.DIGIOH_API,window,document,JQUERY_DIGIOH,orig_lid,var_id,getCustomJsMetadata(orig_lid));logger('JS_GLOBAL.runCustomJsOnLightboxSubmit - '+lbid);DIGIOH_CUSTOM_JS.runCustomJsOnLightboxSubmit(window.DIGIOH_API,window,document,JQUERY_DIGIOH,orig_lid,var_id,getCustomJsMetadata(orig_lid));logger('JS_PARENT.runCustomJsOnLightboxSubmit - '+lbid);}}}
catch(e){logError(e,"registerLightboxSubmit");}}
function registerLightboxRedirect(lbid){try{var var_id='';var orig_lid=lbid;if(DIGIOH_VARIATION_TO_BOX_MAP.hasOwnProperty(lbid)){orig_lid=DIGIOH_VARIATION_TO_BOX_MAP[lbid];var_id=lbid;}else if(LIGHTBOX_TO_VARIATION_MAP.hasOwnProperty(lbid)){var_id=LIGHTBOX_TO_VARIATION_MAP[lbid];}
updateLightboxActivityRedirect(orig_lid);}
catch(e){logError(e,"registerLightboxRedirect");}}
function registerLightboxClose(lbid){try{var var_id='';var orig_lid=lbid;if(DIGIOH_VARIATION_TO_BOX_MAP.hasOwnProperty(lbid)){orig_lid=DIGIOH_VARIATION_TO_BOX_MAP[lbid];var_id=lbid;}else if(LIGHTBOX_TO_VARIATION_MAP.hasOwnProperty(lbid)){var_id=LIGHTBOX_TO_VARIATION_MAP[lbid];}
removeActiveBox(lbid);removeActiveBox(orig_lid);updateLightboxActivityClose(orig_lid);keepSendingEventNotificationToChildUntilReceived({sender:'lightbox',action:'after_lightbox_close'},(var_id&&var_id.length>7?var_id:lbid),100,0);if(!IS_PREVIEW||IS_DEV){if(!isInlineLightbox(lbid)||doesInlineLightboxHaveCustomJsType(lbid,'all')){DIGIOH_CUSTOM_JS_SUPER.runCustomJsOnLightboxClose(window.DIGIOH_API,window,document,JQUERY_DIGIOH,orig_lid,var_id,getCustomJsMetadata(orig_lid));logger('JS_GLOBAL.runCustomJsOnLightboxClose - '+lbid);DIGIOH_CUSTOM_JS.runCustomJsOnLightboxClose(window.DIGIOH_API,window,document,JQUERY_DIGIOH,orig_lid,var_id,getCustomJsMetadata(orig_lid));logger('JS_PARENT.runCustomJsOnLightboxClose - '+lbid);}}
logger('DIGIOH: checkLightboxMasterRules() called from registerLightboxClose() - '+orig_lid+', '+var_id);if(checkLightboxMasterRules()){if(effectsHasTeaserDisplayFancybox(lbid)&&EFFECTS[lbid].widget_type==="fancybox"){openTeaser(EFFECTS[lbid].fancybox.teaser,lbid);}else if(effectsHasTeaserDisplaySidebar(lbid)&&EFFECTS[lbid].widget_type==="sidebar"){openTeaser(EFFECTS[lbid].sidebar.teaser,lbid);}}}
catch(e){logError(e,"registerLightboxClose");}}
var registerAnalyticsManualRedirect=function(lbid){try{var var_id='';var orig_lid=lbid;if(DIGIOH_VARIATION_TO_BOX_MAP.hasOwnProperty(lbid)){orig_lid=DIGIOH_VARIATION_TO_BOX_MAP[lbid];var_id=lbid;}else if(LIGHTBOX_TO_VARIATION_MAP.hasOwnProperty(lbid)){var_id=LIGHTBOX_TO_VARIATION_MAP[lbid];}
var ab_test_id='';if(var_id!=''&&AB_BOXES_TAKE_MAP.hasOwnProperty(var_id)){ab_test_id=AB_BOXES_TAKE_MAP[var_id];}else if(AB_BOXES_TAKE_MAP.hasOwnProperty(orig_lid)){ab_test_id=AB_BOXES_TAKE_MAP[orig_lid];}
keenLightboxRedirect(lbid);DIGIOH_LIGHTBOX_ANALYTICS.setLightboxEvent("redirect",orig_lid);analyticsRedirect(orig_lid,var_id,ab_test_id);if(!IS_PREVIEW||IS_DEV){if(!isInlineLightbox(lbid)||doesInlineLightboxHaveCustomJsType(lbid,'all')){DIGIOH_CUSTOM_JS_SUPER.runCustomJsOnLightboxRedirect(window.DIGIOH_API,window,document,JQUERY_DIGIOH,orig_lid,var_id,getCustomJsMetadata(orig_lid));logger('JS_GLOBAL.runCustomJsOnLightboxRedirect - '+lbid);DIGIOH_CUSTOM_JS.runCustomJsOnLightboxRedirect(window.DIGIOH_API,window,document,JQUERY_DIGIOH,orig_lid,var_id,getCustomJsMetadata(orig_lid));logger('JS_PARENT.runCustomJsOnLightboxRedirect - '+lbid);}}}
catch(e){logError(e,"registerAnalyticsManualRedirect");}}
function startIdleTimer(){try{JQUERY_DIGIOH.idleTimer(IDLE_PERIOD*1000);JQUERY_DIGIOH(document).bind("idle.idleTimer");JQUERY_DIGIOH(document).bind("active.idleTimer");TOTAL_INTERVAL=iframewin.setInterval(totalTimerIncrement,1000);}
catch(e){logError(e,"startIdleTimer");}}
function idleTimerIncrement(){try{IDLE_TIME+=1;DIGIOH_LIGHTBOX_ANALYTICS.VARS.idle_time_seconds=IDLE_TIME;}
catch(e){logError(e,"idleTimerIncrement");}}
function totalTimerIncrement(){try{TOTAL_TIME+=1;DIGIOH_LIGHTBOX_ANALYTICS.VARS.total_time_seconds=TOTAL_TIME;DIGIOH_LIGHTBOX_ANALYTICS.VARS.active_time_seconds=TOTAL_TIME-IDLE_TIME;if(TIME_BOXES_ARR.length>0){checkConditionsTime();}}
catch(e){logError(e,"totalTimerIncrement");}}
function isStringAnInteger(str){if(str.length==0)return false;return!isNaN(str);}
function compareUrlEqualityWithAndWithoutTrailingSlash(urla,urlb){try{if(urla.toLowerCase()==urlb.toLowerCase())return true;if(urla.length>1&&stringEndsWith(urla,'/'))urla=urla.substr(0,urla.length-1);if(urlb.length>1&&stringEndsWith(urlb,'/'))urlb=urlb.substr(0,urlb.length-1);if(urla.toLowerCase()==urlb.toLowerCase())return true;else return false;}
catch(e){logError(e,"compareUrlEqualityWithAndWithoutTrailingSlash");return false;}}
function compareUrlEndingWithAndWithoutTrailingSlash(url,suffix){try{if(stringEndsWith(url.toLowerCase(),suffix.toLowerCase()))return true;if(url.length>1&&stringEndsWith(url,'/'))url=url.substr(0,url.length-1);return stringEndsWith(url.toLowerCase(),suffix.toLowerCase());}
catch(e){logError(e,"compareUrlEndingWithAndWithoutTrailingSlash");return false;}}
var TEXT_ERROR_LOG_ARR=[]
var addExistsSelector;var removeExistsSelector;var getExistsSelectors=function(){return EXISTS_SELECTORS;};var hasOpenLightboxes;var setLightboxID;function getIntFromStringOrIntOrDecimal(the_num){try{var out_num=0;if(typeof the_num==='undefined'||the_num===null||the_num===0||the_num===''){return 0;}
if(typeof the_num==='string'){the_num=the_num.trim();if(the_num.indexOf('.')===0){return 0;}else if(the_num.indexOf('.')>0){return getIntFromStringOrIntOrDecimal(the_num.split('.')[0].trim());}else{var parsed=parseInt(the_num.trim());if(isNaN(parsed)){return 0;}else{return Math.round(parsed);}}}
if(typeof the_num==='number'){return Math.round(the_num);}}
catch(e){logError(e,"getIntFromStringOrIntOrDecimal");}
return the_num;}
var getActualBoxWidthAndHeight=function(lbid){try{var pref=getPagePref(lbid);var actualBoxWidthPixels=0;var actualBoxHeightPixels=0;if(EFFECTS[lbid].hasOwnProperty(pref+'responsive')&&EFFECTS[lbid][pref+'responsive'].use){actualBoxWidthPixels=getResponsiveBoxWidth(lbid);actualBoxHeightPixels=getResponsiveBoxHeight(lbid);FANCY_REPOSITION_LOCKED[lbid]=true;}else{actualBoxWidthPixels=getBoxWidth(lbid);actualBoxHeightPixels=getBoxHeight(lbid);}
return{width:actualBoxWidthPixels,height:actualBoxHeightPixels};}
catch(e){logError(e,"getActualBoxWidthAndHeight");}
return{width:500,height:500};};var getBoxWidth=function(lbid){try{setPixelThreshold(lbid);var pref=getPagePref(lbid);if(EFFECTS.hasOwnProperty(lbid)&&EFFECTS[lbid].hasOwnProperty(pref+'width')&&EFFECTS[lbid][pref+'width']>0){return getIntFromStringOrIntOrDecimal(EFFECTS[lbid][pref+'width']);}else{return getIntFromStringOrIntOrDecimal(EFFECTS[lbid].width);}}
catch(e){logError(e,"getBoxWidth");}
return 600;};var getBoxHeight=function(lbid){try{setPixelThreshold(lbid);var pref=getPagePref(lbid);if(EFFECTS.hasOwnProperty(lbid)&&EFFECTS[lbid].hasOwnProperty(pref+'height')&&EFFECTS[lbid][pref+'height']>0){return getIntFromStringOrIntOrDecimal(EFFECTS[lbid][pref+'height']);}else{return getIntFromStringOrIntOrDecimal(EFFECTS[lbid].height);}}
catch(e){logError(e,"getBoxHeight");}
return 400;};var getResponsiveBoxWidth=function(lbid){try{var widthWin=JQUERY_DIGIOH(window).width();var widthPct=getResponsiveBoxWidthPercent(lbid);var widthActual=Math.round(widthWin*widthPct/100);if(DIGIOH_USE_RESPONSIVE){var widthMax=getResponsiveBoxWidthMax(lbid);if(widthActual>widthMax){widthActual=widthMax;}
var widthMin=getResponsiveBoxWidthMin(lbid);if(widthActual<widthMin){widthActual=widthMin;}}
return widthActual;}
catch(e){logError(e,"getResponsiveBoxWidth");}
return 50;};var getResponsiveBoxHeight=function(lbid){try{if(!DIGIOH_USE_RESPONSIVE){return getBoxHeight(lbid);}
var heightWin=JQUERY_DIGIOH(window).height();var heightPct=getResponsiveBoxHeightPercent(lbid);var heightActual=Math.round(heightWin*heightPct/100);if(DIGIOH_USE_RESPONSIVE){var heightMax=getResponsiveBoxHeightMax(lbid);if(heightActual>heightMax){heightActual=heightMax;}
var heightMin=getResponsiveBoxHeightMin(lbid);if(heightActual<heightMin){heightActual=heightMin;}}
return heightActual;}
catch(e){logError(e,"getResponsiveBoxHeight");}
return 50;};var getResponsiveBoxWidthPercent=function(lbid){try{setPixelThreshold(lbid);if(!DIGIOH_USE_RESPONSIVE)
return 100;var pref=getPagePref(lbid);if(EFFECTS[lbid].hasOwnProperty(pref+'responsive'))
return getIntFromStringOrIntOrDecimal(EFFECTS[lbid][pref+'responsive'].box_width);}
catch(e){logError(e,"getResponsiveBoxWidthPercent");}
return 100;};var getResponsiveBoxHeightPercent=function(lbid){try{setPixelThreshold(lbid);if(!DIGIOH_USE_RESPONSIVE)
return 100;var pref=getPagePref(lbid);if(EFFECTS[lbid].hasOwnProperty(pref+'responsive'))
return getIntFromStringOrIntOrDecimal(EFFECTS[lbid][pref+'responsive'].box_height);}
catch(e){logError(e,"getResponsiveBoxHeightPercent");}
return 35;};var getResponsiveBoxWidthMax=function(lbid){try{setPixelThreshold(lbid);var pref=getPagePref(lbid);if(EFFECTS[lbid].hasOwnProperty(pref+'responsive')&&EFFECTS[lbid][pref+'responsive'].use&&DIGIOH_USE_RESPONSIVE)
return getIntFromStringOrIntOrDecimal(EFFECTS[lbid][pref+'responsive'].width_max);else if(EFFECTS[lbid].hasOwnProperty(pref+'responsive')&&EFFECTS[lbid][pref+'responsive'].use&&!DIGIOH_USE_RESPONSIVE)
return 10000;else if(EFFECTS[lbid].hasOwnProperty(pref+'width'))
return getIntFromStringOrIntOrDecimal(EFFECTS[lbid][pref+'width']);else
return getIntFromStringOrIntOrDecimal(EFFECTS[lbid].width);}
catch(e){logError(e,"getResponsiveBoxWidthMax");}
return 1000;};var getResponsiveBoxHeightMax=function(lbid){try{setPixelThreshold(lbid);var pref=getPagePref(lbid);if(EFFECTS[lbid].hasOwnProperty(pref+'responsive')&&DIGIOH_USE_RESPONSIVE)
return getIntFromStringOrIntOrDecimal(EFFECTS[lbid][pref+'responsive'].height_max);else if(EFFECTS[lbid].hasOwnProperty(pref+'height'))
return getIntFromStringOrIntOrDecimal(EFFECTS[lbid][pref+'height']);else
return getIntFromStringOrIntOrDecimal(EFFECTS[lbid].height);}
catch(e){logError(e,"getResponsiveBoxHeightMax");}
return 600;};var getResponsiveBoxWidthMin=function(lbid){try{setPixelThreshold(lbid);var pref=getPagePref(lbid);if(EFFECTS[lbid].hasOwnProperty(pref+'responsive')&&DIGIOH_USE_RESPONSIVE)
return getIntFromStringOrIntOrDecimal(EFFECTS[lbid][pref+'responsive'].width_min);else if(EFFECTS[lbid].hasOwnProperty(pref+'width'))
return getIntFromStringOrIntOrDecimal(EFFECTS[lbid][pref+'width']);else
return getIntFromStringOrIntOrDecimal(EFFECTS[lbid].width);}
catch(e){logError(e,"getResponsiveBoxWidthMin");}
return 50;};var getResponsiveBoxHeightMin=function(lbid){try{setPixelThreshold(lbid);var pref=getPagePref(lbid);if(EFFECTS[lbid].hasOwnProperty(pref+'responsive')&&DIGIOH_USE_RESPONSIVE)
return getIntFromStringOrIntOrDecimal(EFFECTS[lbid][pref+'responsive'].height_min);else if(EFFECTS[lbid].hasOwnProperty(pref+'height'))
return getIntFromStringOrIntOrDecimal(EFFECTS[lbid][pref+'height']);else
return getIntFromStringOrIntOrDecimal(EFFECTS[lbid].height);}
catch(e){logError(e,"getResponsiveBoxHeightMin");}
return 50;};var closeAllOpenLightboxes=function(guid){try{if(DIGIOH_LIGHTBOX_IDS){for(var lbguid in DIGIOH_LIGHTBOX_IDS){if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(lbguid)&&isActiveBox(lbguid)&&(typeof guid==='undefined'||!guid||guid===lbguid)){if(EFFECTS[lbguid]['widget_type']==='fancybox'){IS_LIGHTBOX_CLOSING[lbguid]=true;JQUERY_DIGIOH.fb_lightbox.close();}else if(EFFECTS[lbguid]['widget_type']==='sidebar'){closeSidebar(lbguid);}else if(EFFECTS[lbguid]['widget_type']==='banner'){closeBanner(lbguid);}}}
logger('closeAllOpenLightboxes_2');}}
catch(err){logError(e,"closeAllOpenLightboxes");}};var sendMessageToIframe=function(obj,lid){try{if(document.getElementById('lightbox-iframe-'+lid)!==null){document.getElementById('lightbox-iframe-'+lid).contentWindow.receiveMessageFromParent(obj);return true;}else{return false;}}catch(e){logger('sendMessageToIframe - child not ready: '+lid);return false;}};var receiveMessageFromIframe;var relayMessageToIframe;var getUrlParam=function(name,urlOverride){try{if(!name)
return null;var url=parent.location.href;if(typeof urlOverride==='string'&&urlOverride.indexOf('http')===0)
url=urlOverride;if(!url||!DIGIOH_API.contains(url,'?'))
return null;var qs=url.split('?')[1];if(!qs||!DIGIOH_API.contains(qs,name+'='))
return null;var val='';var foundVal=false;if(DIGIOH_API.contains(qs,'&')){var parts=qs.split('&');for(var i=0;i<parts.length;i++){if(parts[i].indexOf(name+'=')===0){val=parts[i].split(name+'=')[1];foundVal=true;break;}}}else if(qs.indexOf(name+'=')===0){val=qs.split(name+'=')[1];foundVal=true;}
if(!foundVal)
return null;if(DIGIOH_API.contains(val,'%'))
return decodeURIComponent(val);return val;}
catch(err){return null;}};var isPhone=function(){try{if(typeof DIGIOH_LIGHTBOX_ANALYTICS==='object'&&DIGIOH_LIGHTBOX_ANALYTICS!==null&&DIGIOH_LIGHTBOX_ANALYTICS.hasOwnProperty('VARS')&&typeof DIGIOH_LIGHTBOX_ANALYTICS.VARS==='object'&&DIGIOH_LIGHTBOX_ANALYTICS.VARS!==null){if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.hasOwnProperty('DeviceAtlas')&&typeof DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas==='object'){if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.hasOwnProperty('isMobilePhone')&&DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.isMobilePhone!==''){return DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.isMobilePhone;}
if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.hasOwnProperty('primaryHardwareType')&&DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.primaryHardwareType!==''){return(DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.primaryHardwareType==='Mobile Phone');}}
if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.device){if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.device==='Phone/Tablet'){if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.hasOwnProperty('device_apple')&&DIGIOH_LIGHTBOX_ANALYTICS.VARS.device_apple){if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.device_apple.toLowerCase()==='iphone'){return true;}else{return false;}}else{return true;}}else{return false;}}}}
catch(e){logError(e,"isPhone");}
return '';}
var isTablet=function(){try{if(typeof DIGIOH_LIGHTBOX_ANALYTICS==='object'&&DIGIOH_LIGHTBOX_ANALYTICS!==null&&DIGIOH_LIGHTBOX_ANALYTICS.hasOwnProperty('VARS')&&typeof DIGIOH_LIGHTBOX_ANALYTICS.VARS==='object'&&DIGIOH_LIGHTBOX_ANALYTICS.VARS!==null){if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.hasOwnProperty('DeviceAtlas')&&typeof DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas==='object'){if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.hasOwnProperty('isTablet')&&DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.isTablet!==''){return DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.isTablet;}
if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.hasOwnProperty('primaryHardwareType')&&DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.primaryHardwareType!==''){return(DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.primaryHardwareType==='Tablet');}}
if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.device){if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.device==='Phone/Tablet'){if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.hasOwnProperty('device_apple')&&DIGIOH_LIGHTBOX_ANALYTICS.VARS.device_apple){if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.device_apple.toLowerCase()==='ipad'){return true;}else{return false;}}else{return true;}}else{return false;}}}}
catch(e){logError(e,"isTablet");}
return '';}
var isMobile=function(){try{if(typeof DIGIOH_LIGHTBOX_ANALYTICS==='object'&&DIGIOH_LIGHTBOX_ANALYTICS!==null&&DIGIOH_LIGHTBOX_ANALYTICS.hasOwnProperty('VARS')&&typeof DIGIOH_LIGHTBOX_ANALYTICS.VARS==='object'&&DIGIOH_LIGHTBOX_ANALYTICS.VARS!==null){if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.hasOwnProperty('DeviceAtlas')&&typeof DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas==='object'){if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.hasOwnProperty('mobileDevice')&&DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.mobileDevice!==''){return DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.mobileDevice;}}
if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.device&&DIGIOH_LIGHTBOX_ANALYTICS.VARS.device==='Phone/Tablet'){return true;}}
return(isPhone()||isTablet());}
catch(e){logError(e,"isMobile");}
return '';}
var isiOs=function(){try{if(typeof DIGIOH_LIGHTBOX_ANALYTICS==='object'&&DIGIOH_LIGHTBOX_ANALYTICS!==null&&DIGIOH_LIGHTBOX_ANALYTICS.hasOwnProperty('VARS')&&typeof DIGIOH_LIGHTBOX_ANALYTICS.VARS==='object'&&DIGIOH_LIGHTBOX_ANALYTICS.VARS!==null){if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.hasOwnProperty('DeviceAtlas')&&typeof DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas==='object'){if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.hasOwnProperty('osiOs')&&DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.osiOs!==''){return DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.osiOs;}}
if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.device&&DIGIOH_LIGHTBOX_ANALYTICS.VARS.device==='Phone/Tablet'){return true;}}
return(isPhone()||isTablet());}
catch(e){logError(e,"isiOs");}
return '';}
var isAndroid=function()
{try
{if(typeof DIGIOH_LIGHTBOX_ANALYTICS==='object'&&DIGIOH_LIGHTBOX_ANALYTICS!==null&&DIGIOH_LIGHTBOX_ANALYTICS.hasOwnProperty('VARS')&&typeof DIGIOH_LIGHTBOX_ANALYTICS.VARS==='object'&&DIGIOH_LIGHTBOX_ANALYTICS.VARS!==null)
{if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.hasOwnProperty('DeviceAtlas')&&typeof DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas==='object')
{if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.hasOwnProperty('osAndroid')&&DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.osAndroid!=='')
{return DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.osAndroid;}}
if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.device&&DIGIOH_LIGHTBOX_ANALYTICS.VARS.device==='Phone/Tablet')
{return true;}}
return(isPhone()||isTablet());}
catch(e)
{logError(e,"isAndroid");}
return '';}
var isDesktop=function(){try{if(typeof DIGIOH_LIGHTBOX_ANALYTICS==='object'&&DIGIOH_LIGHTBOX_ANALYTICS!==null&&DIGIOH_LIGHTBOX_ANALYTICS.hasOwnProperty('VARS')&&typeof DIGIOH_LIGHTBOX_ANALYTICS.VARS==='object'&&DIGIOH_LIGHTBOX_ANALYTICS.VARS!==null){if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.hasOwnProperty('DeviceAtlas')&&typeof DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas==='object'){if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.hasOwnProperty('primaryHardwareType')&&DIGIOH_LIGHTBOX_ANALYTICS.VARS.DeviceAtlas.primaryHardwareType==='Desktop'){return true;}}
if(DIGIOH_LIGHTBOX_ANALYTICS.VARS.device&&DIGIOH_LIGHTBOX_ANALYTICS.VARS.device==='Desktop/Laptop'){return true;}}
return(!isPhone()&&!isTablet());}
catch(e){logError(e,"isDesktop");}
return '';}
var isDigiohReady=function(){return DIGIOH_IS_READY;}
DIGIOH_API.GET_ANALYTICS=function(){return DIGIOH_LIGHTBOX_ANALYTICS;}
DIGIOH_API.GET_KEEN_SCHEMA=function(){return KEEN_SCHEMA;}
DIGIOH_API.GET_KEEN_CLIENT=function(){return KEEN_CLIENT;}
DIGIOH_API.GET_KEEN_CLIENT_2=function(){return KEEN_CLIENT_2;}
DIGIOH_API.GET_EFFECTS
DIGIOH_API.GET_SETTINGS
DIGIOH_API.formatLogMessage=function(msg,caller){try
{if(typeof caller==='string'&&caller.length>0)
caller=caller+' -- ';else
caller='';if(typeof msg==='string'&&msg.indexOf('DIGIOH:')!==0&&msg.indexOf('POST')===-1){return 'DIGIOH: '+caller+msg;}else if(typeof msg==='object'&&msg!==null){return caller+JSON.stringify(msg,undefined,2);}else if(typeof msg!=='undefined'&&msg!==null){return caller+msg;}else{return '';}}
catch(err){return msg;}}
DIGIOH_API.logStream=false;DIGIOH_API.logArray=[];DIGIOH_API.log=function(msg,caller){try
{if(typeof caller!=='string')
caller='';if(DIGIOH_API.logStream&&typeof console!=="undefined")
console.log(DIGIOH_API.formatLogMessage(msg,caller));else
DIGIOH_API.logArray.push(DIGIOH_API.formatLogMessage(msg,caller));}
catch(err){}}
DIGIOH_API.logErrorStream=false;DIGIOH_API.logErrorArray=[];DIGIOH_API.logError=function(msg){try{if(DIGIOH_API.logErrorStream&&typeof console!=="undefined"){if(typeof msg==='string'&&msg.indexOf('ERROR::::')!==0){console.log('ERROR:::: '+msg);}else if(typeof msg==='object'&&msg!==null){console.log('ERROR:::: '+JSON.stringify(msg,undefined,2));}else if(typeof msg!=='undefined'&&msg!==null){console.log(msg);}}else{if(typeof msg==='string'&&msg.indexOf('ERROR::::')!==0){DIGIOH_API.logErrorArray.push('ERROR:::: '+msg);DIGIOH_API.logArray.push('ERROR:::: '+msg);}else if(typeof msg==='object'&&msg!==null){DIGIOH_API.logErrorArray.push('ERROR:::: '+JSON.stringify(msg,undefined,2));DIGIOH_API.logArray.push('ERROR:::: '+JSON.stringify(msg,undefined,2));}else if(typeof msg!=='undefined'&&msg!==null){DIGIOH_API.logErrorArray.push(msg);DIGIOH_API.logArray.push(msg);}}}
catch(err){}}
DIGIOH_API.logErrorFromBox=function(e,function_name){try{if(function_name&&function_name!=="logger")
DIGIOH_API.logError('BOX.'+function_name+'() - '+e.message);else
DIGIOH_API.logError('BOX - '+e.message);if(typeof DIGIOH_BUGSNAG!=='undefined'&&DIGIOH_BUGSNAG!==null)
{processStoredExceptions();DIGIOH_BUGSNAG.notifyException(e,"[DIGIOH_EXCEPTION_JS] (lightbox_builder.js) - "+function_name);}else{ERROR_LOG_TEMP_ARR.push({ex:e,fcn:("(lightbox_builder.js) - "+function_name),processed:false});}}
catch(err)
{}}
DIGIOH_API.logErrorFromAnalytics=function(e,function_name){try{if(function_name&&function_name!=="logger")
DIGIOH_API.logError('ANALYTICS.'+function_name+'() - '+e.message);else
DIGIOH_API.logError('ANALYTICS - '+e.message);if(typeof DIGIOH_BUGSNAG!=='undefined'&&DIGIOH_BUGSNAG!==null)
{processStoredExceptions();DIGIOH_BUGSNAG.notifyException(e,"[DIGIOH_EXCEPTION_JS] (analytics.js) - "+function_name);}else{ERROR_LOG_TEMP_ARR.push({ex:e,fcn:("(analytics.js) - "+function_name),processed:false});}}
catch(err)
{}}
DIGIOH_API.logErrorFromCustomJsParent=function(e,function_name){try{if(function_name&&function_name!=="logger")
DIGIOH_API.logError('PARENT_JS.'+function_name+'() - '+e.message);else
DIGIOH_API.logError('PARENT_JS - '+e.message);if(typeof DIGIOH_BUGSNAG!=='undefined'&&DIGIOH_BUGSNAG!==null)
{processStoredExceptions();DIGIOH_BUGSNAG.notifyException(e,"[DIGIOH_EXCEPTION_JS] - "+function_name);}else{ERROR_LOG_TEMP_ARR.push({ex:e,fcn:function_name,processed:false});}}
catch(err)
{}};DIGIOH_API.print;DIGIOH_API.printAll;DIGIOH_API.printErrors;DIGIOH_API.printConditionsOutput=printConditionsOutput;if(typeof DIGIOH_DYNAMIC_BOXES!=='undefined')
DIGIOH_API.DIGIOH_DYNAMIC_BOXES=DIGIOH_DYNAMIC_BOXES;else
DIGIOH_API.DIGIOH_DYNAMIC_BOXES=[];if(typeof COUPON_GROUP_POPULATE_OBJ!=='undefined')
DIGIOH_API.COUPON_GROUP_POPULATE_OBJ=COUPON_GROUP_POPULATE_OBJ;else
DIGIOH_API.COUPON_GROUP_POPULATE_OBJ={};DIGIOH_API.GoogleAnalytics={};DIGIOH_API.GoogleAnalytics.num_checks=0;DIGIOH_API.GoogleAnalytics.tracker=false;DIGIOH_API.GoogleAnalytics.is_ga_classic=false;DIGIOH_API.GoogleAnalytics.is_ga_universal=false;DIGIOH_API.GoogleAnalytics.is_new_diuid=false;DIGIOH_API.GoogleAnalytics.tryInitGADigioh=tryInitGADigioh;DIGIOH_API.GoogleAnalytics.sendGAEvent=sendGAEvent;DIGIOH_API.GoogleAnalytics.uaIdManual='';DIGIOH_API.sendGAEvent;DIGIOH_API.setGATracker;DIGIOH_API.sendGADisplayEvent=function(obj)
{if(typeof obj==='object'&&obj&&obj.hasOwnProperty('lightbox_name'))
{var label=obj.lightbox_name;if(obj.hasOwnProperty('is_variation')&&obj.is_variation&&obj.variation_name)
label+='['+obj.variation_name+']';DIGIOH_API.sendGAEvent('Digioh','Display',label);}};DIGIOH_API.sendGASubmitEvent=function(obj)
{if(typeof obj==='object'&&obj&&obj.hasOwnProperty('lightbox_name'))
{var label=obj.lightbox_name;if(obj.hasOwnProperty('is_variation')&&obj.is_variation&&obj.variation_name)
label+='['+obj.variation_name+']';DIGIOH_API.sendGAEvent('Digioh','Submit',label);}};DIGIOH_API.sendGARedirectEvent=function(obj)
{if(typeof obj==='object'&&obj&&obj.hasOwnProperty('lightbox_name'))
{var label=obj.lightbox_name;if(obj.hasOwnProperty('is_variation')&&obj.is_variation&&obj.variation_name)
label+='['+obj.variation_name+']';DIGIOH_API.sendGAEvent('Digioh','Redirect',label);}};DIGIOH_API.sendGACloseEvent;DIGIOH_API.LIGHTBOX={};DIGIOH_API.LIGHTBOX.loadLightbox=loadLightbox;DIGIOH_API.LIGHTBOX.closeSidebar=closeSidebar;DIGIOH_API.LIGHTBOX.closeBanner=closeBanner;DIGIOH_API.LIGHTBOX.closeInline=closeInline;DIGIOH_API.LIGHTBOX.closeAllInlineForms=closeAllInlineForms;DIGIOH_API.LIGHTBOX.getLightboxDomId=getLightboxDomId;DIGIOH_API.LIGHTBOX.getActiveLightboxDomId=getActiveLightboxDomId;DIGIOH_API.LIGHTBOX.cloneObj=cloneObj;DIGIOH_API.LIGHTBOX.isPhone=isPhone;DIGIOH_API.LIGHTBOX.isTablet=isTablet;DIGIOH_API.LIGHTBOX.isMobile=isMobile;DIGIOH_API.LIGHTBOX.isDesktop=isDesktop;DIGIOH_API.LIGHTBOX.isiOs=isiOs;DIGIOH_API.LIGHTBOX.isAndroid=isAndroid;DIGIOH_API.LIGHTBOX.getActualBoxWidthAndHeight=getActualBoxWidthAndHeight;DIGIOH_API.LIGHTBOX.getBoxWidth=getBoxWidth;DIGIOH_API.LIGHTBOX.getBoxHeight=getBoxHeight;DIGIOH_API.LIGHTBOX.getResponsiveBoxWidth=getResponsiveBoxWidth;DIGIOH_API.LIGHTBOX.getResponsiveBoxHeight=getResponsiveBoxHeight;DIGIOH_API.LIGHTBOX.getResponsiveBoxWidthPercent=getResponsiveBoxWidthPercent;DIGIOH_API.LIGHTBOX.getResponsiveBoxHeightPercent=getResponsiveBoxHeightPercent;DIGIOH_API.LIGHTBOX.getResponsiveBoxWidthMax=getResponsiveBoxWidthMax;DIGIOH_API.LIGHTBOX.getResponsiveBoxHeightMax=getResponsiveBoxHeightMax;DIGIOH_API.LIGHTBOX.getResponsiveBoxWidthMin=getResponsiveBoxWidthMin;DIGIOH_API.LIGHTBOX.getResponsiveBoxHeightMin=getResponsiveBoxHeightMin;DIGIOH_API.LIGHTBOX.responsiveResizeCheck=responsiveResizeCheck;DIGIOH_API.LIGHTBOX.sendMessageToIframe=sendMessageToIframe;DIGIOH_API.LIGHTBOX.receiveMessageFromIframe=receiveMessageFromIframe;DIGIOH_API.LIGHTBOX.relayMessageToIframe=relayMessageToIframe;DIGIOH_API.LIGHTBOX.setLightboxID=setLightboxID;DIGIOH_API.LIGHTBOX.hasOpenLightboxes=hasOpenLightboxes;DIGIOH_API.LIGHTBOX.closeAllOpenLightboxes=closeAllOpenLightboxes;DIGIOH_API.LIGHTBOX.initExistsSelectors=initExistsSelectors;DIGIOH_API.LIGHTBOX.recheckExistsSelectors=recheckExistsSelectors;DIGIOH_API.LIGHTBOX.addExistsSelector=addExistsSelector;DIGIOH_API.LIGHTBOX.removeExistsSelector=removeExistsSelector;DIGIOH_API.LIGHTBOX.getExistsSelectors=getExistsSelectors;DIGIOH_API.LIGHTBOX.checkConditions=checkConditions;DIGIOH_API.LIGHTBOX.checkConditionsClick=checkConditionsClick;DIGIOH_API.LIGHTBOX.checkConditionsHover=checkConditionsHover;DIGIOH_API.LIGHTBOX.checkConditionsScroll=checkConditionsScroll;DIGIOH_API.LIGHTBOX.checkConditionsExit=checkConditionsExit;DIGIOH_API.LIGHTBOX.checkConditionsLoad=checkConditionsLoad;DIGIOH_API.LIGHTBOX.checkConditionsTime=checkConditionsTime;DIGIOH_API.LIGHTBOX.isInlineLightbox=isInlineLightbox;DIGIOH_API.LIGHTBOX.embedInlineLightboxForm=embedInlineLightboxForm;DIGIOH_API.LIGHTBOX.reDisplayInlineForm=reDisplayInlineForm;DIGIOH_API.LIGHTBOX.onInfiniteScrollPageChanged=onInfiniteScrollPageChanged;DIGIOH_API.LIGHTBOX.onPageUrlChanged=onPageUrlChanged;DIGIOH_API.LIGHTBOX.isDigiohReady=isDigiohReady;DIGIOH_API.LIGHTBOX.customJsOnDocumentReadyCallback=customJsOnDocumentReadyCallback;DIGIOH_API.LIGHTBOX.analyticsRunAfterIdentify=analyticsRunAfterIdentify;DIGIOH_API.LIGHTBOX.getUrlParam=getUrlParam;DIGIOH_API.LIGHTBOX.getUrlParameter=getUrlParam;DIGIOH_API.LIGHTBOX.getClientGuid=getClientGuid;DIGIOH_API.LIGHTBOX.generateGuid=generateGuid;DIGIOH_API.LIGHTBOX.generateGuidWithTimestamp=generateGuidWithTimestamp;DIGIOH_API.LIGHTBOX.keenLightboxDebug=keenLightboxDebug;DIGIOH_API.LIGHTBOX.registerAnalyticsManualRedirect=registerAnalyticsManualRedirect;DIGIOH_API.LIGHTBOX.runJquerySelectorGenerator=runJquerySelectorGenerator;DIGIOH_API.LIGHTBOX.setBoxToScrollMode=setBoxToScrollMode;DIGIOH_API.LIGHTBOX.INTEGRATION_MAP={};DIGIOH_API.LIGHTBOX.AB_BOXES_TAKE_MAP=AB_BOXES_TAKE_MAP;DIGIOH_API.LIGHTBOX.AB_BOXES_SKIP_MAP=AB_BOXES_SKIP_MAP;DIGIOH_API.LIGHTBOX.JQUERY_DIGIOH=JQUERY_DIGIOH;DIGIOH_API.LIGHTBOX.DIGIOH_KEEN_WRITE_KEY=DIGIOH_KEEN_WRITE_KEY;DIGIOH_API.LIGHTBOX.KEEN_CLIENT=KEEN_CLIENT;DIGIOH_API.LIGHTBOX.LZString=LZString;DIGIOH_API.LIGHTBOX.DIGIOH_BUGSNAG=DIGIOH_BUGSNAG;DIGIOH_API.LIGHTBOX.DIGIOH_COOKIE=DIGIOH_COOKIE;DIGIOH_API.LIGHTBOX.DIGIOH_LOCAL_STORAGE=DIGIOH_LOCAL_STORAGE;DIGIOH_API.LIGHTBOX.DIGIOH_STORAGE=DIGIOH_STORAGE;DIGIOH_API.LIGHTBOX.USE_LZ=(typeof USE_LZ==='undefined'||USE_LZ==true);DIGIOH_API.getCookie;DIGIOH_API.getCookieLZString;DIGIOH_API.getCookieBase64=function(name,obj)
{try{var b64=DIGIOH_COOKIE.getEncoded(name);if(b64!=null&&typeof b64==='string'&&b64!=''&&typeof atob==='function')
{var decodedVal=atob(b64);return decodedVal;}
else
{return b64;}}
catch(e)
{logError(e,"getCookieBase64");return DIGIOH_COOKIE.getEncoded(name);}};DIGIOH_API.setCookie=function(name,value,obj)
{try{var expirationDays=365;if(typeof obj==='object'&&obj!==null&&obj.hasOwnProperty('expirationDays'))
expirationDays=obj.expirationDays;if(typeof expirationDays==='string')
expirationDays=parseFloat(expirationDays);DIGIOH_COOKIE.trySet(name,value,false,expirationDays);}
catch(e)
{logError(e,"setCookie");}};DIGIOH_API.setCookieLZString=function(name,value,obj)
{try
{var expirationDays=365;if(typeof obj==='object'&&obj!==null&&obj.hasOwnProperty('expirationDays'))
expirationDays=obj.expirationDays;if(typeof expirationDays==='string')
expirationDays=parseFloat(expirationDays);DIGIOH_COOKIE.trySet(name,value,true,expirationDays);}
catch(e)
{logError(e,"setCookieLZString");}};DIGIOH_API.setCookieBase64=function(name,value,obj)
{try
{var expirationDays=365;if(typeof obj==='object'&&obj!==null&&obj.hasOwnProperty('expirationDays'))
expirationDays=obj.expirationDays;if(typeof expirationDays==='string')
expirationDays=parseFloat(expirationDays);DIGIOH_COOKIE.trySet(name,btoa(value),false,expirationDays);}
catch(e)
{logError(e,"setCookieBase64");}};DIGIOH_API.deleteCookie;DIGIOH_API.getUrlParameter;DIGIOH_API.getCurrentUrl=function(obj)
{return window.location.href;};DIGIOH_API.getHostname=function(obj)
{return window.location.host;};DIGIOH_API.getPagePath=function(obj)
{return window.location.pathname;};DIGIOH_API.getQueryString=function(obj)
{return window.location.search;};DIGIOH_API.getQueryString=function(obj)
{return window.location.search;};DIGIOH_API.getUrlHash;DIGIOH_API.getLandingPageUrl=function(obj)
{return DIGIOH_API.GET_ANALYTICS().VARS.landing_page;};DIGIOH_API.getReferrer;DIGIOH_API.getLandingPageReferrer=function(obj)
{return DIGIOH_API.GET_ANALYTICS().VARS.referring_website_url;};DIGIOH_API.getClientIpAddress=function(obj)
{return DIGIOH_API.GET_ANALYTICS().VARS.ip_address;};DIGIOH_API.getClientContinentCode=function(obj)
{return DIGIOH_API.GET_ANALYTICS().VARS.continent;};DIGIOH_API.getClientContinentName=function(obj)
{return DIGIOH_API.GET_ANALYTICS().VARS.continent_name;};DIGIOH_API.getClientCountryCode=function(obj)
{return DIGIOH_API.GET_ANALYTICS().VARS.country;};DIGIOH_API.getClientCountryName=function(obj)
{return DIGIOH_API.GET_ANALYTICS().VARS.country_name;};DIGIOH_API.getClientCountryISO=function(obj)
{return DIGIOH_API.GET_ANALYTICS().VARS.country;};DIGIOH_API.isClientInEU;DIGIOH_API.getClientRegionOrStateCode=function(obj)
{return DIGIOH_API.GET_ANALYTICS().VARS.state;};DIGIOH_API.getClientRegionOrStateName=function(obj)
{return DIGIOH_API.GET_ANALYTICS().VARS.region_name;};DIGIOH_API.getClientCity=function(obj)
{return DIGIOH_API.GET_ANALYTICS().VARS.city;};DIGIOH_API.getClientPostalCode=function(obj)
{return DIGIOH_API.GET_ANALYTICS().VARS.zipcode;};DIGIOH_API.getOperatingSystem=function(obj)
{return DIGIOH_API.GET_ANALYTICS().VARS.operating_system;};DIGIOH_API.getBrowserType=function(obj)
{return DIGIOH_API.GET_ANALYTICS().VARS.browser_type;};DIGIOH_API.getBrowserVersion=function(obj)
{return DIGIOH_API.GET_ANALYTICS().VARS.browser_version;};DIGIOH_API.getDeviceType=function()
{return DIGIOH_API.GET_ANALYTICS().VARS.device;};DIGIOH_API.getTrafficSource=function()
{return DIGIOH_API.GET_ANALYTICS().VARS.web_source;};DIGIOH_API.getSearchEngineSource=function()
{return DIGIOH_API.GET_ANALYTICS().VARS.search_engine;};DIGIOH_API.getTotalPageViews=function()
{return DIGIOH_API.GET_ANALYTICS().VARS.page_visits;};DIGIOH_API.getTotalSessions=function()
{return DIGIOH_API.GET_ANALYTICS().VARS.past_visits;};DIGIOH_API.getDeviceType=function()
{return DIGIOH_API.GET_ANALYTICS().VARS.device;};DIGIOH_API.getDeviceType=function()
{return DIGIOH_API.GET_ANALYTICS().VARS.device;};DIGIOH_API.getDeviceType;DIGIOH_API.isMobile=function(obj)
{return DIGIOH_API.LIGHTBOX.isMobile();};DIGIOH_API.isTablet=function(obj)
{return DIGIOH_API.LIGHTBOX.isTablet();};DIGIOH_API.isDesktop=function(obj)
{return DIGIOH_API.LIGHTBOX.isDesktop();};DIGIOH_API.isIOS=function(obj)
{return DIGIOH_API.LIGHTBOX.isiOs();};DIGIOH_API.isAndroid=function(obj)
{return DIGIOH_API.LIGHTBOX.isAndroid();};DIGIOH_API.isNewSession=function(obj)
{return DIGIOH_API.GET_ANALYTICS().IsNewSession;};DIGIOH_API.isNewVisitor;DIGIOH_API.getPagesNavigatedAllTime;DIGIOH_API.getDaysSinceLastPageview=function(obj)
{try{var timestamp=new Date().getTime();var diff=Math.floor((timestamp-DIGIOH_API.GET_ANALYTICS().PreviousPageviewTs)/(1000*60*60*24));return diff;}
catch(e)
{logError(e,"getDaysSinceLastPageview");return 0;}};DIGIOH_API.getAccountId=function(obj)
{return DIGIOH_VENDOR_SHORT_ID;};DIGIOH_API.getAccountGuid=function(obj)
{return DIGIOH_VENDOR_GUID;};DIGIOH_API.getClientId;DIGIOH_API.closeAllBoxes=function()
{try
{DIGIOH_API.LIGHTBOX.closeAllOpenLightboxes();}
catch(e)
{logError(e,"closeAllBoxes");}};DIGIOH_API.closeBox=function(boxId)
{try
{boxId=DIGIOH_API.getBoxGUID(boxId);if(!boxId)
DIGIOH_API.LIGHTBOX.closeAllOpenLightboxes();else
DIGIOH_API.LIGHTBOX.closeAllOpenLightboxes(boxId);}
catch(e)
{logError(e,"closeBox");}};DIGIOH_API.openBox=function(boxId)
{try
{boxId=DIGIOH_API.getBoxGUID(boxId);if(boxId)
DIGIOH_API.LIGHTBOX.loadLightbox(boxId);else
DIGIOH_API.log('DIGIOH_API.openBox ==> boxId parameter is required!');}
catch(e)
{logError(e,"openBox");}};DIGIOH_API.addBoxIntegration=function(boxId,integrationId)
{try
{boxId=DIGIOH_API.getBoxGUID(boxId);if(!boxId)
{DIGIOH_API.log('DIGIOH_API.addBoxIntegration ==> boxId parameter is required!');return;}
if(!integrationId||(typeof integrationId==='string'&&integrationId.indexOf('-')>0))
{DIGIOH_API.log('DIGIOH_API.addBoxIntegration ==> integrationId parameter is required!  It should be the short id value of the integration.');return;}
if(typeof integrationId!=='string')
integrationId=integrationId.toString();if(!DIGIOH_API.LIGHTBOX.INTEGRATION_MAP.hasOwnProperty(boxId))
{DIGIOH_API.LIGHTBOX.INTEGRATION_MAP[boxId]=integrationId;}
else if(DIGIOH_API.LIGHTBOX.INTEGRATION_MAP[boxId].indexOf(integrationId)===-1)
{if(DIGIOH_API.LIGHTBOX.INTEGRATION_MAP[boxId].length>1)
{DIGIOH_API.LIGHTBOX.INTEGRATION_MAP[boxId]+=',';}
DIGIOH_API.LIGHTBOX.INTEGRATION_MAP[boxId]+=integrationId;}}
catch(e)
{logError(e,"addBoxIntegration");}};DIGIOH_API.removeBoxIntegration=function(boxId,integrationId)
{try
{boxId=DIGIOH_API.getBoxGUID(boxId);if(!boxId)
{DIGIOH_API.log('DIGIOH_API.removeBoxIntegration ==> boxId parameter is required!');return;}
if(!integrationId||(typeof integrationId==='string'&&integrationId.indexOf('-')>0))
{DIGIOH_API.log('DIGIOH_API.removeBoxIntegration ==> integrationId parameter is required!  It should be the short id value of the integration.');return;}
if(typeof integrationId!=='string')
integrationId=integrationId.toString();if(DIGIOH_API.LIGHTBOX.INTEGRATION_MAP.hasOwnProperty(boxId)&&DIGIOH_API.LIGHTBOX.INTEGRATION_MAP[boxId].indexOf(integrationId)>=0)
{DIGIOH_API.LIGHTBOX.INTEGRATION_MAP[boxId]=DIGIOH_API.LIGHTBOX.INTEGRATION_MAP[boxId].replace(','+integrationId,'').replace(integrationId+',','').replace(integrationId,'');}}
catch(e)
{logError(e,"removeBoxIntegration");}};DIGIOH_API.resetBoxIntegrations=function(boxId)
{try
{boxId=DIGIOH_API.getBoxGUID(boxId);if(!boxId)
{DIGIOH_API.log('DIGIOH_API.resetBoxIntegrations ==> boxId parameter is required!');return;}
if(DIGIOH_API.LIGHTBOX.INTEGRATION_MAP.hasOwnProperty(boxId))
{delete DIGIOH_API.LIGHTBOX.INTEGRATION_MAP[boxId];}}
catch(e)
{logError(e,"resetBoxIntegrations");}};DIGIOH_API.getBoxType=function(boxId)
{try
{boxId=DIGIOH_API.getBoxGUID(boxId);if(!boxId)
{DIGIOH_API.log('DIGIOH_API.getBoxType ==> boxId parameter is required!');return '';}
if(!DIGIOH_API.GET_EFFECTS(boxId))
{DIGIOH_API.log('DIGIOH_API.getBoxType ==> boxId '+boxId+' not found in EFFECTS object!');return '';}
if(DIGIOH_API.GET_EFFECTS(boxId).widget_type==='sidebar'&&DIGIOH_API.GET_EFFECTS(boxId).sidebar.hasOwnProperty('is_converted_lightbox')&&DIGIOH_API.GET_EFFECTS(boxId).sidebar.is_converted_lightbox)
return 'lightbox';if(DIGIOH_API.GET_EFFECTS(boxId).widget_type==='fancybox')
return 'lightbox';return DIGIOH_API.GET_EFFECTS(boxId).widget_type;}
catch(e)
{logError(e,"getBoxType");return '';}};DIGIOH_API.getBoxGUID=function(boxIDorGUID)
{try
{if(!boxIDorGUID)
{DIGIOH_API.log('DIGIOH_API.getBoxGUID ==> boxIDorGUID parameter is required!');return '';}
if(typeof boxIDorGUID!=='string')
boxIDorGUID=boxIDorGUID.toString();if(boxIDorGUID.indexOf('-')>0&&boxIDorGUID.length>30)
return boxIDorGUID;var boxShortID=boxIDorGUID;for(var guid in DIGIOH_LIGHTBOX_IDS)
{if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(guid)&&DIGIOH_LIGHTBOX_IDS[guid].toString()===boxShortID)
{return guid;}}
return '';}
catch(e)
{logError(e,"getBoxGUID");return '';}};DIGIOH_API.getBoxID=function(boxIDorGUID)
{try
{if(!boxIDorGUID)
{DIGIOH_API.log('DIGIOH_API.getBoxID ==> boxIDorGUID parameter is required!');return '';}
if(typeof boxIDorGUID!=='string')
boxIDorGUID=boxIDorGUID.toString();if(boxIDorGUID.indexOf('-')<0&&boxIDorGUID.length<30)
return boxIDorGUID;var boxGUID=boxIDorGUID;if(DIGIOH_LIGHTBOX_IDS.hasOwnProperty(boxGUID))
{return DIGIOH_LIGHTBOX_IDS[boxGUID].toString();}
return '';}
catch(e)
{logError(e,"getBoxID");return '';}};DIGIOH_API.isValidEmail=function(email,obj)
{try
{if(typeof email!=='string'||email.indexOf('@')<=0)
{DIGIOH_API.log('DIGIOH_API.isValidEmail ==> email parameter is required!');return false;}
var emailParts=email.split('@'),emailName=emailParts[0],emailDomain=emailParts[1],emailDomainParts=emailDomain.split('.'),validChars='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ.0123456789_-+',validCharsBasic='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_';var valid_email_regex=/\S+@\S+\.\S+/;if(!valid_email_regex.test(email))
{DIGIOH_API.log('DIGIOH_API.isValidEmail ==> Failed regex format test');return false;}
if(emailParts.length!==2)
{DIGIOH_API.log('DIGIOH_API.isValidEmail ==> Wrong number of @ signs');return false;}
if(emailName.length<1||emailDomain.length<3)
{DIGIOH_API.log('DIGIOH_API.isValidEmail ==> Wrong number of characters before or after @ sign');return false;}
if(emailDomain.indexOf('.')<=0)
{DIGIOH_API.log('DIGIOH_API.isValidEmail ==> Domain must include but not start with .');return false;}
if(email.indexOf(',')>=0||email.indexOf("'")>=0||email.indexOf('`')>=0||email.indexOf('"')>=0||email.indexOf(' ')>=0)
{DIGIOH_API.log('DIGIOH_API.isValidEmail ==> Email must exclude most special characters');return false;}
if(validCharsBasic.indexOf(emailName.substr(emailName.length-1))<0)
{DIGIOH_API.log('DIGIOH_API.isValidEmail ==> no special chars immediately before @ symbol');return false;}
if(validCharsBasic.indexOf(emailDomain.substr(0,1))<0)
{DIGIOH_API.log('DIGIOH_API.isValidEmail ==> no special chars immediately after @ symbol');return false;}
if(validCharsBasic.indexOf(emailName.substr(0,1))<0)
{DIGIOH_API.log('DIGIOH_API.isValidEmail ==> Email must not start with special chars');return false;}
if(emailDomainParts[emailDomainParts.length-1].length<2)
{DIGIOH_API.log('DIGIOH_API.isValidEmail ==> Domains last . should be 2 chars or more from the end');return false;}
if(emailName.indexOf(' ')>0||emailDomain.indexOf(' ')>0||emailName.indexOf('..')>=0||emailDomain.indexOf('..')>=0)
{DIGIOH_API.log('DIGIOH_API.isValidEmail ==> Found extra spaces or chained periods');return false;}
return true;}
catch(e)
{logError(e,"isValidEmail");return false;}};DIGIOH_API.writeCustomFlag=function(flagId,obj)
{try
{if(!flagId)
{DIGIOH_API.log('DIGIOH_API.writeCustomFlag ==> flagId parameter is required!');return;}
DIGIOH_API.LIGHTBOX.JQUERY_DIGIOH('body').append('<div id="'+flagId+'" class="box_custom_flag"></div>');}
catch(e)
{logError(e,"writeCustomFlag");}};DIGIOH_API.reload=function(obj)
{try
{var url='';var sendPvEvent=true;var updatePvVars=true;var useMasterRules=true;var recalculateAbTests=false;if(obj&&typeof obj==='object'&&obj.hasOwnProperty('url'))
url=obj.url;if(obj&&typeof obj==='object'&&obj.hasOwnProperty('sendPvEvent'))
sendPvEvent=obj.sendPvEvent;if(obj&&typeof obj==='object'&&obj.hasOwnProperty('updatePvVars'))
updatePvVars=obj.updatePvVars;if(obj&&typeof obj==='object'&&obj.hasOwnProperty('useMasterRules'))
useMasterRules=obj.useMasterRules;if(obj&&typeof obj==='object'&&obj.hasOwnProperty('recalculateAbTests'))
recalculateAbTests=obj.recalculateAbTests;DIGIOH_API.LIGHTBOX.onPageUrlChanged(url,sendPvEvent,updatePvVars,useMasterRules,recalculateAbTests);}
catch(e)
{logError(e,"reload");}};DIGIOH_API.enableReloadOnUrlChange=function(obj)
{DIGIOH_API.CURRENT_PAGE_URL=DIGIOH_API.CURRENT_PAGE_URL||window.location.href;var sendPvEvent=true;var updatePvVars=true;var useMasterRules=true;var recalculateAbTests=false;var checkIntervalMillis=500;try
{if(obj&&typeof obj==='object'&&obj.hasOwnProperty('sendPvEvent'))
sendPvEvent=obj.sendPvEvent;if(obj&&typeof obj==='object'&&obj.hasOwnProperty('updatePvVars'))
updatePvVars=obj.updatePvVars;if(obj&&typeof obj==='object'&&obj.hasOwnProperty('useMasterRules'))
useMasterRules=obj.useMasterRules;if(obj&&typeof obj==='object'&&obj.hasOwnProperty('recalculateAbTests'))
recalculateAbTests=obj.recalculateAbTests;if(obj&&typeof obj==='object'&&obj.hasOwnProperty('checkIntervalMillis')&&typeof obj.checkIntervalMillis==='number')
checkIntervalMillis=obj.checkIntervalMillis;}
catch(e)
{logError(e,"enableReloadOnUrlChange ");}
DIGIOH_API.enableReloadOnUrlChangeInterval=setInterval,checkIntervalMillis);checkReloadDigiohOnUrlChange();};DIGIOH_API.isReady;DIGIOH_API.logEvent=function(data,options)
{try
{if(!data||typeof data!=='object')
{DIGIOH_API.log('DIGIOH_API.logEvent ==> data param is required!');return;}
updateKeenSchemaBeforeSending();var ev={};ev.geoip=KEEN_SCHEMA.geoip;ev.device_atlas=KEEN_SCHEMA.device_atlas;ev.entry_point=KEEN_SCHEMA.entry_point;ev.referrer_url=document.referrer;ev.current_url=document.location.href;ev.cache_version=DIGIOH_CACHE_VERSION;ev.is_preview=IS_PREVIEW;ev.client_id=CLIENT_GUID;ev.event_id=generateGuidWithTimestamp();ev.user_id=DIGIOH_API.getAccountId();ev.user_guid=DIGIOH_API.getAccountGuid();ev.page_total_time=TOTAL_TIME;ev.page_active_time=TOTAL_TIME-IDLE_TIME;ev.page_idle_time=IDLE_TIME;var dt=(new Date()).getTime();if(!options||typeof options!=='object')
options={};if(!options.hasOwnProperty('group'))
options.group='default';var isExpDefault=false;if(!options.hasOwnProperty('exp'))
{options.exp=dt+(72*60*60*1000);isExpDefault=true;}
try
{if(typeof options.exp==='string'&&(options.exp.indexOf('/')>0||options.exp.indexOf('-')>0||options.exp.indexOf('.')>0))
options.exp=Date.parse(options.exp);}
catch(err)
{options.exp=dt+(72*60*60*1000);isExpDefault=true;logError(err,"DIGIOH_API.logEvent.Date.parse(options.exp)");}
var opt={};try
{var localOptions=localStorage.getItem('__d_widget_logs');if(typeof localOptions==='string'&&localOptions.length>7)
{opt=JSON.parse(LZString.decompressFromBase64(localOptions));if(opt.hasOwnProperty(options.group)&&opt[options.group].hasOwnProperty('exp')&&isExpDefault)
{options.exp=opt[options.group]['exp'];}}}
catch(err)
{logError(err,"DIGIOH_API.logEvent.localOptions");}
opt[options.group]={};opt[options.group]['exp']=options.exp;localStorage.setItem('__d_widget_logs',LZString.compressToBase64(JSON.stringify(opt)));if(dt>options.exp)
{DIGIOH_API.log('DIGIOH_API.logEvent ==> Log event suppressed.  Log group ('+options.group+') expired on '+new Date(options.exp));return;}
DIGIOH_API.log('DIGIOH_API.logEvent ==> Log event sent!  Log group ('+options.group+') expires on '+new Date(options.exp));ev.options_group=options.group;ev.options_exp=options.exp;var event_schema=mergeObjectData(ev,data);var img=new Image();img.src=('https://lgev.lightboxcdn.com/Keen/LgEv?u='+DIGIOH_API.getAccountId()+'&k='+encodeURIComponent(DIGIOH_KEEN_WRITE_KEY)+'&p='+encodeURIComponent(LZString.compressToBase64(JSON.stringify(event_schema))));}
catch(e)
{logError(e,"logEvent");}};DIGIOH_API.getBrowserLanguages=getBrowserLanguages;DIGIOH_API.trim=function(str)
{try
{return str.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,'');}
catch(e)
{logError(e,"trim");return str;}};DIGIOH_API.contains=function(obj,val)
{try
{if(typeof obj==='undefined'||obj===null)
{return false;}
if(typeof obj==='string')
{return obj.indexOf(val)>=0;}
if(DIGIOH_API.LIGHTBOX.JQUERY_DIGIOH.isArray(obj))
{return DIGIOH_API.LIGHTBOX.JQUERY_DIGIOH.inArray(val,obj)>=0;}
return false;}
catch(e)
{logError(e,"contains");return false;}};DIGIOH_API.remove=function(obj,valToRemove)
{try
{if(typeof obj==='undefined'||obj===null)
{return obj;}
if(typeof obj==='string'&&obj.indexOf(valToRemove)>=0)
{obj=obj.split(valToRemove).join('');}
else if(DIGIOH_API.LIGHTBOX.JQUERY_DIGIOH.isArray(obj))
{obj=DIGIOH_API.LIGHTBOX.JQUERY_DIGIOH.grep(obj);}
return obj;}
catch(e)
{logError(e,"remove");return obj;}};DIGIOH_API.hideUrlParameter=function(key)
{try
{if(typeof key!=='string'||!key)
return;if(top.location.search.indexOf(key+'=')>=0)
{var qre=new RegExp('[\?&]'+key+'=[^&]+','gi');top.history.replaceState(null,null,top.location.protocol+'//'+top.location.host+top.location.pathname+top.location.search.replace(qre,'').replace(/^&/,'?'));}}
catch(e)
{logError(e,"hideUrlParameter");}};DIGIOH_API.getDataLayerValue=function(key,box_id)
{try
{if(typeof key!=='string'||!key)
return null;var curr=DIGIOH_LOCAL_STORAGE.getManual('fsdbx');if(typeof curr!=='object'||!curr)
return null;if(typeof box_id==='string'&&box_id.length>2)
{var box_short_id=DIGIOH_API.getBoxID(box_id);if(!curr.hasOwnProperty(box_short_id)||typeof curr[box_short_id]!=='object'||curr[box_short_id]===null||!curr[box_short_id].hasOwnProperty(key))
return null;return curr[box_short_id][key];}
else if(curr.hasOwnProperty(key))
{return curr[key];}}
catch(e)
{logError(e,"getDataLayerValue");}
return null;};DIGIOH_API.setDataLayerValue=function(key,val,box_id)
{try
{if(typeof key!=='string'||!key)
return;var curr=DIGIOH_LOCAL_STORAGE.getManual('fsdbx');if(typeof curr!=='object'||!curr)
curr={};if(typeof box_id==='string'&&box_id.length>2)
{var box_short_id=DIGIOH_API.getBoxID(box_id);if(!curr.hasOwnProperty(box_short_id)||typeof curr[box_short_id]!=='object'||curr[box_short_id]===null)
curr[box_short_id]={};curr[box_short_id][key]=val;DIGIOH_LOCAL_STORAGE.setManual('fsdbx',curr);}
else
{curr[key]=val;DIGIOH_LOCAL_STORAGE.setManual('fsdbx',curr);}}
catch(e)
{logError(e,"setDataLayerValue");}};DIGIOH_API.removeDataLayerValue=function(key,box_id)
{try
{if(typeof key!=='string'||!key)
return;var curr=DIGIOH_LOCAL_STORAGE.getManual('fsdbx');if(typeof curr!=='object'||!curr)
return;if(typeof box_id==='string'&&box_id.length>2)
{var box_short_id=DIGIOH_API.getBoxID(box_id);if(!curr.hasOwnProperty(box_short_id)||typeof curr[box_short_id]!=='object'||curr[box_short_id]===null||!curr[box_short_id].hasOwnProperty(key))
return;delete curr[box_short_id][key];DIGIOH_LOCAL_STORAGE.setManual('fsdbx',curr);}
else if(curr.hasOwnProperty(key))
{delete curr[key];DIGIOH_LOCAL_STORAGE.setManual('fsdbx',curr);}}
catch(e)
{logError(e,"removeDataLayerValue");}};DIGIOH_API.getDataLayer=function(box_id)
{try
{var curr=DIGIOH_LOCAL_STORAGE.getManual('fsdbx');if(typeof curr!=='object'||!curr)
return{};if(typeof box_id==='string'&&box_id.length>2)
{var box_short_id=DIGIOH_API.getBoxID(box_id);if(!curr.hasOwnProperty(box_short_id)||typeof curr[box_short_id]!=='object'||curr[box_short_id]===null)
return{};return curr[box_short_id];}
else
{return curr;}}
catch(e)
{logError(e,"getDataLayer");}
return{};};DIGIOH_API.setDataLayer=function(obj,box_id)
{try
{if(typeof obj!=='object'||!obj)
return;var curr=DIGIOH_LOCAL_STORAGE.getManual('fsdbx');if(typeof curr!=='object'||!curr)
curr={};if(typeof box_id==='string'&&box_id.length>2)
{var box_short_id=DIGIOH_API.getBoxID(box_id);if(!curr.hasOwnProperty(box_short_id)||typeof curr[box_short_id]!=='object'||curr[box_short_id]===null)
curr[box_short_id]={};for(var prop in obj)
{if(obj.hasOwnProperty(prop))
{curr[box_short_id][prop]=obj[prop];}}
DIGIOH_LOCAL_STORAGE.setManual('fsdbx',curr);}
else
{for(var prop in obj)
{if(obj.hasOwnProperty(prop))
{curr[prop]=obj[prop];}}
DIGIOH_LOCAL_STORAGE.setManual('fsdbx',curr);}}
catch(e)
{logError(e,"setDataLayer");}};DIGIOH_API.clearDataLayer=function(box_id)
{try
{if(typeof box_id==='string'&&box_id.length>2)
{var box_short_id=DIGIOH_API.getBoxID(box_id);curr[box_short_id]={};DIGIOH_LOCAL_STORAGE.setManual('fsdbx',curr);}
else
{curr={};DIGIOH_LOCAL_STORAGE.setManual('fsdbx',curr);}}
catch(e)
{logError(e,"clearDataLayer");}};DIGIOH_API.getWidgetMetadata=function(box_id,key)
{try
{if(typeof box_id!=='string'&&typeof box_id!=='number')
return null;var box_guid=DIGIOH_API.getBoxGUID(box_id);if(!box_guid||box_guid.length<20)
return null;var box_effects=DIGIOH_API.GET_EFFECTS(box_guid);if(box_effects&&box_effects.widget_type&&box_effects[box_effects.widget_type]&&box_effects[box_effects.widget_type].metadata_kvps)
{if(typeof key!=='string'||!key)
return box_effects[box_effects.widget_type].metadata_kvps;for(var i=0;i<box_effects[box_effects.widget_type].metadata_kvps.length;i++)
{if(box_effects[box_effects.widget_type].metadata_kvps[i].k===key)
return box_effects[box_effects.widget_type].metadata_kvps[i].v;}}}
catch(e)
{logError(e,"getWidgetMetadata");}
return null;};DIGIOH_API.getAccountMetadata=function(key)
{try
{if(typeof key==='string'&&key.length>0&&typeof ACCOUNT_METADATA==='object'&&ACCOUNT_METADATA!==null&&ACCOUNT_METADATA.hasOwnProperty(key))
return ACCOUNT_METADATA[key];}
catch(e)
{logError(e,"getAccountMetadata");}
return null;};DIGIOH_API.DIGIOH_LIGHTBOX_IDS=DIGIOH_LIGHTBOX_IDS;window.DIGIOH_API=DIGIOH_API;window.LIGHTBOX_API=DIGIOH_API;hideEmbedDivContainer();appendFbDigiohCss();afterScriptLoaded();}(window.parent,window.parent.document,window));