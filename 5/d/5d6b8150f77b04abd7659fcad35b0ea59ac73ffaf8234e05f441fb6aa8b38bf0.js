(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[51],{"05Vi":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n("QjXU"),r=n("MJsD"),s=n("B5kz"),o=n("mgFK");function c(){return Object(a.__awaiter)(this,void 0,void 0,(function(){var e;return Object(a.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(r.a)()];case 1:return e=t.sent(),[2,s.a.fetchQuery(["HwaConfig"],(function(){return function(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(o.a)("pwaConfig",e)];case 1:return[2,t.sent()]}}))}))}(e)}),{staleTime:1/0,cacheTime:1/0})]}}))}))}},"0mcE":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n("QjXU"),r=n("i1ND");function s(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t;return Object(a.__generator)(this,(function(n){return(t=Object(r.a)(e))?[2,Windows.System.Launcher.launchUriAsync(t).then((function(e){return"boolean"==typeof e?{success:e,errorCode:e?0:1,additionalInfo:"Older Native API response."}:e)?e:{success:!1,errorCode:1,additionalInfo:"Incorrect Native API return type"}}),(function(e){return{success:!1,errorCode:1,additionalInfo:null==e?void 0:e.toString()}}))]:[2,{success:!1,errorCode:1,additionalInfo:"getWindowsFoundationUri"}]}))}))}},"1R5x":function(e,t,n){"use strict";n.d(t,"a",(function(){return I}));var a=n("QjXU"),r=n("a3FV"),s=n("CMIS"),o=n("B6oE"),c=n("W1wp"),i=n("cenr"),l=n("8/lW"),u=n("Dn7E"),d=n("gY3Z"),p=n("CKW3"),f=n("MJsD"),v=n("W7wX"),m=n("i1ND");function h(e){return new Promise((function(t,n){var a=Object(m.a)(e);a?Windows.System.Launcher.queryUriSupportAsync(a,Windows.System.LaunchQuerySupportType.uri,Windows.ApplicationModel.Package.current.id.familyName).then((function(e){t(e===Windows.System.LaunchQuerySupportStatus.available)}),():n("Invalid protocol")}))}var O=n("0mcE"),b="ms-officecmd:";function g(e,t){return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,r,s,o,c,i,l;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return[4,h(b)];case 1:return a.sent()?(n="",(r=e[1].data.details)&&"OneDrive"===r.name&&r.discovered&&r.discovered.uri&&"odopen"===r.discovered.uri.toLowerCase()?[4,Object(v.a)()]:[3,3]):[2,{success:!1,errorCode:1,additionalInfo:"launchViaProtocol: Protocol not supported"}];case 2:return s=a.sent(),n=function(e,t){return"odopen://launch"+(e?"?accounttype=personal":"?accounttype=business&userEmail=".concat(t))}(s.isMsa,s.userPrincipalName||""),[3,5];case 3:return[4,Object(f.a)()];case 4:o=a.sent(),c={},e.forEach((function(e){c[e.method]=e.data})),i=o.correlationId,l=o.sessionId,n=b+JSON.stringify(JSON.stringify(c))+" cid:"+i+" sid:"+l+" requestStart:"+t,a.label=5;case 5:return[2,Object(O.a)(n)]}}))}))}function I(e,t,n){return Object(c.a)(e).then((function(c){var f,v;if(!c){var m="".concat(e," not installed");return Object(o.a)(r.a.LaunchLocalApp,"NotInstalled",m),Object(s.a)({eventName:"Launch_Office_App",errorType:"App_Error",message:m}),{success:!1,message:m}}var h={appId:c.identifier,name:c.name,discovered:{}};try{for(var O=Object(a.__values)(["command","uri","aumid"]),b=O.next();!b.done;b=O.next()){var I=b.value;c.launchInstall?c.launchInstall.hasOwnProperty(I)&&h.discovered&&(h.discovered[I]=c.launchInstall[I]):c.hasOwnProperty(I)&&h.discovered&&(h.discovered[I]=c[I])}}catch(e){f={error:e}}finally{try{b&&!b.done&&(v=O.return)&&v.call(O)}finally{if(f)throw f.error}}return function(e,t){return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,c,f;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return[4,Object(p.a)()];case 1:return n=a.sent(),c=performance.now(),f=Math.ceil(Date.now()-(c-t)).toString(),[2,g(e,f).then((function(e){var n=Object(d.a)(c).toString(),a={State:"Success",Action:"Protocol"};return a.Latency=n,a.DebugInfo="StartLatency:".concat(Object(d.a)(t)),Object(i.a)(r.a.LaunchLocalApp,a,[],l.a.Enhanced),Object(u.a)({featureName:"LocalLaunch",eventName:"Protocol_launch",params:{state:"Success",action:"Protocol",latency:n}}),{success:e.success,message:"launchViaProtocol",result:"Native",error:null==e?void 0:e.errorMessage,additionalInfo:null==e?void 0:e.additionalInfo,errorCode:null==e?void 0:e.errorCode}}),(function(a){var p,f={};return f.Error=a,f.Latency=Object(d.a)(c).toString(),Object(i.a)(r.a.LaunchByProtocolFailed,f,[],l.a.Enhanced),Object(s.a)({eventName:"Launch_By_Protocol_Failed",errorType:"Launch_Error",message:a}),c=performance.now(),n.sendCommands(e).then((function(e){if(p=Object(d.a)(c),0!==e.status)return{success:!1,message:e.status.toString()};if(!e.message)return{success:!1,message:"No response message",additionalInfo:"appService"};var n=e.message["LocalProviders.LaunchOfficeAppForResult"];if(!n)return{success:!1,message:"No response message for launchApp property",additionalInfo:"appService"};if("number"==typeof n&&n<=32)return{success:!1,message:n.toString(),additionalInfo:"appService"};var a={},s=Object(d.a)(t);return a.State="Success",a.Action="Bridge",a.Latency=p.toString(),a.DebugInfo="StartLatency:".concat(s),Object(i.a)(r.a.LaunchLocalApp,a,[],l.a.Enhanced),Object(u.a)({featureName:"LocalLaunch",eventName:"AppService_Launch",params:{state:"Success",action:"Bridge",latency:p,startLatency:s}}),{success:!0,message:"local launch successful",additionalInfo:"appService"}})).catch((function(e){return p=p||Object(d.a)(c),Object(o.a)(r.a.LaunchLocalApp,"Failed",e,p),Object(s.a)({eventName:"Launch_By_AppService",errorType:"AppService_Error",message:e}),{success:!1,message:null==e?void 0:e.toString(),additionalInfo:"appService"}}))}))]}}))}))}([{method:"LocalProviders.LaunchOfficeAppForResult",data:{details:h,filename:t}}],n)})).catch((function(e){return Object(o.a)(r.a.LaunchLocalApp,"Failed",e),Object(s.a)({eventName:"Launch_Office_App",errorType:"Launch_Error",message:e}),{success:!1,message:null==e?void 0:e.toString()}}))}},B6oE:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n("cenr"),r=n("8/lW");function s(e,t,n,s){var o={};o.State=t,o.Error=(n||"").toString(),"number"==typeof s&&(o.Latency=s.toString()),Object(a.a)(e,o,[],r.a.Enhanced)}},CKW3:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a,r=n("QjXU"),s=n("MJsD"),o=n("05Vi"),c=n("cenr"),i=n("a3FV"),l=n("8/lW"),u=n("CMIS"),d=((a={})[Windows.ApplicationModel.AppService.AppServiceResponseStatus.success]=0,a[Windows.ApplicationModel.AppService.AppServiceResponseStatus.failure]=1,a[Windows.ApplicationModel.AppService.AppServiceResponseStatus.resourceLimitsExceeded]=2,a);function p(e,t,n){return new Promise((function(a,r){var s=new Windows.Foundation.Collections.ValueSet,o={};t.forEach((),s.insert("message",JSON.stringify(o));var c=e.sendMessageAsync(s).then((function(e){var t;try{t=JSON.parse(e.message.message)}catch(t){return void r("JSON parsing failed. Has message: ".concat(!e.message,", error: ").concat(e.error||""))}a({message:t,status:d.hasOwnProperty(e.status)?d[e.status]:3})}),r);if(n){var i=setTimeout((,n);c.then(()}}))}var f,v=n("Dn7E");function m(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t,n,a,d,m;return Object(r.__generator)(this,(function(h){switch(h.label){case 0:return e=Windows.ApplicationModel.AppService,f?[3,2]:[4,Promise.all([Object(s.a)(),Object(o.a)()])];case 1:t=r.__read.apply(void 0,[h.sent(),2]),n=t[0],d=1e3*((null==(a=t[1])?void 0:a.bridgeTimeoutInSeconds)||10),m=new Promise((function(t,a){var r=performance.now(),s=new e.AppServiceConnection;s.appServiceName="com.microsoft.myoffice.client.bridge",s.packageFamilyName=Windows.ApplicationModel.Package.current.id.familyName,s.openAsync().then((function(o){if(o===e.AppServiceConnectionStatus.success)s.onserviceclosed=function(e,t,n,a,r){return new Promise((function(s){p(e,[{method:"cid",data:n},{method:"sid",data:a}],r).then((function(e){if(0!==e.status)throw new Error("Response failed: "+e.status);return null})).catch(().then((function(e){var n={},a=Math.ceil(performance.now()-t),r=e?"FailedContext":"Success";n.Latency=a.toString(),n.State=r,e&&(n.Error="SendTelemetryContext failed: "+e),Object(c.a)(i.a.AppServiceConnection,n,[],l.a.Enhanced),Object(v.a)({featureName:"AppService",eventName:"Telemetry_Context",params:{state:r,error:e,latency:a}}),s()}))}))}(s,r,n.correlationId,n.sessionId,d).then(();else{var m={},h=Math.ceil(performance.now()-r);m.Latency=h.toString();var O="Connection status: "+o;m.State="Failed",m.Error=O,Object(c.a)(i.a.AppServiceConnection,m,[],l.a.Enhanced),Object(u.a)({eventName:"AppService_Connection",errorType:"AppService_Error",message:"AppService connection status:".concat(o)}),f=void 0,a(O)}}))})),f={sendCommands:,h.label=2;case 2:return[2,f]}}))}))}},W1wp:function(e,t,n){"use strict";n.d(t,"a",();var a=n("QjXU"),r=n("05Vi"),s=n("W7wX"),o=n("a3FV"),c=n("CMIS");function i(e){return-1!==["outlook","word","excel","powerpoint"].indexOf(e.toLowerCase())}var l,u,d,p,f=n("B6oE"),v=n("cenr"),m=n("8/lW"),h=n("Dn7E"),O=n("gY3Z"),b=n("CKW3"),g=!0,I=n("vhka"),S=n("MJsD"),j=n("D/tM"),w=n("WJ2C");function _(e,t){return function(){return Object(a.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(a.__generator)(this,(function(n){switch(n.label){case 0:return p?[3,7]:[4,Object(s.a)()];case 1:if(!n.sent().isMsa)return[3,6];n.label=2;case 2:return n.trys.push([2,4,,5]),[4,Object(w.a)()];case 3:return e=n.sent(),p=Promise.resolve(e&&e.currentSkuInfo?e.currentSkuInfo.skuType:j.a.NotDetected),[3,5];case 4:return t=n.sent(),Object(f.a)(o.a.AppInstalledStatus,"SubscriptionFetchFailed",t),p=Promise.resolve(j.a.NotDetected),[3,5];case 5:return[3,7];case 6:p=Promise.resolve(null),n.label=7;case 7:return[2,p]}}))}))}().then((function(n){return null!==n&&n)?(t.launchInstall=t.o365Installed,t):(Object(f.a)(o.a.AppInstalledStatus,"NoSubscription",e),null)}))}function A(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n,p,j;return Object(a.__generator)(this,(function(w){switch(w.label){case 0:return[4,Promise.all([Object(s.a)(),Object(r.a)()])];case 1:return t=a.__read.apply(void 0,[w.sent(),2]),n=t[0],p=t[1],j=e.toLowerCase(),[2,new Promise((function(t,s){Object(I.a)().then((function(r){if(!r)throw new Error("getInstalledAppsEx returned null");var s=r.apps.find((function(e){return e.name.toLowerCase()===j}));return s&&s.isInstalled?i(e)&&n.isMsa?void(s.perpetualInstalled?(s.launchInstall=s.perpetualInstalled,t(s)):s.o365Installed?function(){return Object(a.__awaiter)(this,void 0,void 0,(function(){var e;return Object(a.__generator)(this,(function(t){switch(t.label){case 0:return l?[3,2]:[4,Object(b.a)()];case 1:e=t.sent(),l=new Promise((function(t,n){var a,r=performance.now();e.sendCommands([{method:"LocalProviders.GetCurrentOfficeLicenses",data:{version:1}}]).then((function(e){if(a=Object(O.a)(r),0!==e.status)throw new Error("AppService sendMessageAsync returned status: "+e.status);var n;try{n=JSON.parse(e.message["LocalProviders.GetCurrentOfficeLicenses"])}catch(t){throw new Error("OfficeLicensesResponse JSON parsing failed. r.msg: ".concat(!e.message,", OfficeLicensesResponse: ").concat(!(e.message&&!e.message["LocalProviders.GetCurrentOfficeLicenses"])))}n&&n.forEach((),t(n);var s={State:"Success"};s.Latency=a.toString(),Object(v.a)(o.a.OfficeLicensesFetch,s,[],m.a.Enhanced),Object(h.a)({featureName:"OfficeLicense",eventName:"Current_Licenses",params:{state:"Success",latency:a}})})).catch((function(e){a=a||Object(O.a)(r),l=void 0,Object(f.a)(o.a.OfficeLicensesFetch,"Failed",e,a),Object(c.a)({eventName:"Office_Licenses_Fetch",errorType:"AppService_Error",message:e}),n("getCurrentOfficeLicenses failed: "+e)}))})),t.label=2;case 2:return[2,l]}}))}))}().then((function(n){if(function(e,t,n){if(t){var a=n?["licensed","ootgrace","extendedgrace"]:["licensed","ootgrace","extendedgrace","oobgrace"];return!!e&&e.some(()}return!!e&&e.some(()}(n,(null==p?void 0:p.rfmToWeb)||!1,(null==p?void 0:p.oobToWeb)||!1))return s.launchInstall=s.o365Installed,void t(s);_(e,s).then(t)})).catch(():(Object(f.a)(o.a.AppInstalledStatus,"NotInstalled",e),Object(c.a)({eventName:"Installed_Apps",errorType:"Not_Found",debugInfo:e,message:"No launch info"}),t(null))):(s.launchInstall=s.o365Installed||s.perpetualInstalled,void(s.launchInstall?t(s):(Object(f.a)(o.a.AppInstalledStatus,"NotModern",e),Object(c.a)({eventName:"Installed_Apps",errorType:"Not_Supported",debugInfo:e,message:"Missing O365 and perpetual launch info"}),t(null)))):(Object(f.a)(o.a.AppInstalledStatus,"NotInstalled",e),Object(c.a)({eventName:"Installed_Apps",errorType:"Not_Found",debugInfo:e,message:"GetInstalledAppsEx failed to find app"}),void t(null))})).catch((function(l){Object(f.a)(o.a.AppInstalledStatus,"FailedEx",l),Object(c.a)({eventName:"Installed_Apps",errorType:"Handled_Exception",message:"Caught getInstalledAppsExError",debugInfo:l}),-1!==l.toString().indexOf("ApiNotExist")?function(){return Object(a.__awaiter)(this,void 0,void 0,(function(){var e,t,n,s;return Object(a.__generator)(this,(function(i){switch(i.label){case 0:return u?[3,2]:[4,Promise.all([Object(b.a)(),Object(r.a)()])];case 1:e=a.__read.apply(void 0,[i.sent(),2]),t=e[0],s=(null==(n=e[1])?void 0:n.installedAppsToLookFor)||"",u=new Promise((function(e,n){var r,i=[{method:"LocalProviders.GetInstalledOfficeApps",data:{apps:s.split(",")}}],l=performance.now();t.sendCommands(i).then((function(t){if(r=Object(O.a)(l),0!==t.status)throw new Error("AppService sendMessageAsync returned status: "+t.status);var n;try{n=JSON.parse(t.message["LocalProviders.GetInstalledOfficeApps"])}catch(e){throw new Error("Apps JSON parsing failed. r.msg: ".concat(!t.message,", appsFromResponse: ").concat(!(t.message&&!t.message["LocalProviders.GetInstalledOfficeApps"])))}e({apps:n.map((function(e){var t,n,r={name:e.name,identifier:e.appId,isInstalled:e.hasOwnProperty("discovered")};if(r.isInstalled&&e.discovered)try{for(var s=Object(a.__values)(["command","uri","aumid","version"]),o=s.next();!o.done;o=s.next()){var c=o.value;e.discovered.hasOwnProperty(c)&&(r[c]=e.discovered[c])}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return r}))});var s={State:"Success"};s.Latency=r.toString(),Object(v.a)(o.a.InstalledAppsFetch,s,[],m.a.Enhanced),Object(h.a)({featureName:"InstalledApps",eventName:"Installed_Apps_Discovered",params:{state:"Success",latency:r}})})).catch((function(e){r=r||Object(O.a)(l);var t=g?"FailedInitial":"Failed";Object(f.a)(o.a.InstalledAppsFetch,t,e,r),Object(c.a)({eventName:"Installed_Apps",errorType:"AppService_Error",message:e}),u=void 0,n("getInstalledApps failed: "+e)})).then(()})),i.label=2;case 2:return[2,u]}}))}))}().then((function(r){if(!r)throw new Error("Installed apps returned null");var s=r.apps.find(();if(!s||!s.isInstalled)return Object(f.a)(o.a.AppInstalledStatus,"NotInstalled",e),Object(c.a)({eventName:"Installed_Apps",errorType:"Not_Found",debugInfo:e,message:"GetInstalledApps failed to find app"}),void t(null);i(s.name)&&n.isMsa?function(){return Object(a.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(a.__generator)(this,(function(r){switch(r.label){case 0:return d?[3,2]:[4,Promise.all([Object(b.a)(),Object(S.a)()])];case 1:e=a.__read.apply(void 0,[r.sent(),2]),t=e[0],n=e[1],d=new Promise((function(e,a){if(n.wrapperVersion&&18===n.wrapperVersion.major&&n.wrapperVersion.minor<1902)return Object(f.a)(o.a.InstalledOfficeDetailsFetch,"ApiNotExist","",0),Object(c.a)({eventName:"Office_Install_Details",errorType:"Not_Supported",message:"Version ".concat(n.wrapperVersion.major,".").concat(n.wrapperVersion.minor," doesn't support getOfficeInstallationDetails")}),void a("getOfficeInstallationDetails failed: ".concat("ApiNotExist"));var r,s=performance.now();t.sendCommands([{method:"LocalProviders.GetOfficeInstallationDetails",data:{version:1}}]).then((function(t){if(r=Object(O.a)(s),0!==t.status)throw new Error("AppService sendMessageAsync returned status: "+t.status);var n;try{n=JSON.parse(t.message["LocalProviders.GetOfficeInstallationDetails"])}catch(e){throw new Error("InstalledOfficeDetailsResponse JSON parsing failed. r.msg: ".concat(!t.message,", InstalledOfficeDetailsResponse: ").concat(!(t.message&&!t.message["LocalProviders.GetOfficeInstallationDetails"])))}e(n);var a={State:"Success"};a.Latency=r.toString(),Object(v.a)(o.a.InstalledOfficeDetailsFetch,a,[],m.a.Enhanced),Object(h.a)({featureName:"OfficeInstallDetails",eventName:"Office_Details",params:{state:"Success",latency:r}})})).catch((function(e){r=r||Object(O.a)(s),d=void 0,Object(f.a)(o.a.InstalledOfficeDetailsFetch,"Failed",e,r),Object(c.a)({eventName:"Office_Install_Details",errorType:"AppService_Error",message:e}),a("getOfficeInstallationDetails failed: "+e)}))})),r.label=2;case 2:return[2,d]}}))}))}().then((function(n){n.IsO365?_(e,s).then(t):t(s)})).catch((function(e){Object(f.a)(o.a.AppInstalledStatus,"DetailsFailed",e),Object(c.a)({eventName:"Installed_Apps",errorType:"Handled_Exception",debugInfo:e,message:"Caught getOfficeDetailsError"}),t(s)})):t(s)})).catch((function(e){Object(f.a)(o.a.AppInstalledStatus,"Failed",e),Object(c.a)({eventName:"Installed_Apps",errorType:"Handled_Exception",debugInfo:e,message:"Caught GetInstalledAppsError"}),s("getInstalledApps failed: "+e)})):t(null)}))}))]}}))}))}},gY3Z:function(e,t,n){"use strict";.d(t,"a",(function(){return a}))},i1ND:function(e,t,n){"use strict";function a(e){try{return new Windows.Foundation.Uri(e)}catch(e){}return null}n.d(t,"a",(function(){return a}))},vhka:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n("QjXU"),r=n("MJsD"),s=n("05Vi"),o=n("cenr"),c=n("a3FV"),i=n("8/lW"),l=n("CMIS"),u=n("Dn7E"),d=n("gY3Z");function p(e){return parseInt(e.substring(0,e.indexOf(".")))||0}var f,v=n("V9hE"),m=n("B6oE"),h=n("CKW3"),O=!0;function b(){return Object(a.__awaiter)(this,void 0,void 0,(function(){var e,t,n,b,g;return Object(a.__generator)(this,(function(I){switch(I.label){case 0:return f?[3,2]:[4,Promise.all([Object(h.a)(),Object(s.a)(),Object(r.a)()])];case 1:e=a.__read.apply(void 0,[I.sent(),3]),t=e[0],b=e[2],g=(null==(n=e[1])?void 0:n.installedAppsToLookFor)||"",f=new Promise((function(e,n){if(b.wrapperVersion&&18===b.wrapperVersion.major&&b.wrapperVersion.minor<1903)return Object(m.a)(c.a.InstalledAppsExFetch,"ApiNotExist","",0),Object(l.a)({eventName:"Installed_Apps",errorType:"Not_Supported",debugInfo:"".concat(b.wrapperVersion.major,".").concat(b.wrapperVersion.minor),message:"GetInstalledAppsEx not supported"}),void n("getInstalledAppsEx failed: ".concat("ApiNotExist"));var a,r=[{method:"LocalProviders.GetInstalledOfficeAppsEx",data:{version:1,apps:{apps:g.split(",")}}}],s=performance.now();t.sendCommands(r).then((function(t){var n,r;if(a=Object(d.a)(s),0!==t.status)throw new Error("AppService sendMessageAsync returned status: "+t.status);try{r=JSON.parse(t.message["LocalProviders.GetInstalledOfficeAppsEx"])}catch(e){var f=t.message&&t.message["LocalProviders.GetInstalledOfficeAppsEx"];if(f){if(-1!==f.toString().indexOf("forbidden"))throw new Error("ApiNotExist");!function(e,t,n){var a={State:"FailedEx"};a.Error=(n||"").toString(),Object(v.a)(e,a,[],i.a.Enhanced)}(c.a.InstalledAppsExFetchDebug,0,f.toString()),Object(l.a)({eventName:"Installed_Apps",errorType:"Parse_Error",message:f.toString()})}throw new Error("Apps JSON parsing failed. r.msg: ".concat(!t.message,", appsFromResponse: ").concat(!(t.message&&!t.message["LocalProviders.GetInstalledOfficeAppsEx"])))}e({apps:r.map((function(e){var t={name:e.name,identifier:e.appId,isInstalled:e.hasOwnProperty("discovered")&&!!e.discovered&&e.discovered.length>0};return e.discovered&&e.discovered.length>0&&e.discovered.forEach((function(e){var n,a;e.isO365?(!t.hasOwnProperty("o365Installed")||p((null===(n=t.o365Installed)||void 0===n?void 0:n.version)||"")<p(e.version))&&(t.o365Installed=e):(!t.hasOwnProperty("perpetualInstalled")||p((null===(a=t.perpetualInstalled)||void 0===a?void 0:a.version)||"")<p(e.version))&&(t.perpetualInstalled=e)})),t}))}),Object(o.a)(c.a.InstalledAppsExFetch,((n={}).State="Success",n.Latency=a.toString(),n),[],i.a.Enhanced),Object(u.a)({featureName:"InstalledApps",eventName:"Installed_Apps_Discovered_Ex",params:{state:"Success",latency:a}})})).catch((function(e){a=a||Object(d.a)(s);var t=function(){return"ApiNotExist"===e.message?"ApiNotExist":O?"FailedInitial":"Failed"}();Object(m.a)(c.a.InstalledAppsExFetch,t,e!==t?e:"",a),Object(l.a)({eventName:"Installed_Apps",errorType:"AppService_Error",message:e}),f=void 0,n("getInstalledAppsEx failed: "+e)})).then((function(){return O=!1}))})),I.label=2;case 2:return[2,f]}}))}))}}}]);
//# sourceMappingURL=51.a730c70c9c0e048527a2.chunk.v7.js.map