"use strict";(self.webpackChunkphotobucket_web=self.webpackChunkphotobucket_web||[]).push([[3240],{944:96849:function(e,t,n){var r=n(47131),i=n(17592);t.Z=(0,i.ZP)(r.Z,{shouldForwardProp:)((function(e){var t=e.isActive;return{position:"absolute",color:e.theme.palette.primary.contrastText,backgroundColor:"rgba(71,85,105,0.5)",padding:"2px",display:t?"inline-flex":"none","&:hover":{display:"inline-flex"}}}))},65582:function(e,t,n){n.d(t,{Z:function(){return f}});var r=n(29439),i=n(47196),o=n(90891),a=n(47131),s=n(25002),l=n(61113),d=n(47313),u=n(28297),c=n(46417);function f(){var e=(0,d.useState)(null),t=(0,r.Z)(e,2),n=t[0],f=t[1];return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(a.Z,{color:"inherit","aria-label":"Blurred media",sx:{position:"absolute",top:"calc(50% - 30px)",left:"calc(50% - 30px)",zIndex:1,color:"#fff"},onClick:"data-test":"blurred-image",children:(0,c.jsx)(i.Z,{sx:{height:60,width:60}})}),(0,c.jsx)(s.ZP,{anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"center",horizontal:"center"},open:Boolean(n),anchorEl:n,onClose:children:(0,c.jsxs)(l.Z,{sx:{p:2},children:["You appear to be over your storage limit. Please click here to ",(0,c.jsx)(o.Z,{href:u.ZP.appUrl.billing,children:"upgrade your plan"}),"."]})})]})}},36575:function(e,t,n){n.d(t,{Z:function(){return m}});var r=n(29439),i=n(87462),o=n(63366),a=n(47313),s=["getTrigger","target"];ar d="undefined"!==typeof window?window:null;function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.getTrigger,n=void 0===t?l:t,u=e.target,c=void 0===u?d:u,f=(0,o.Z)(e,s),h=a.useRef(),m=a.useState((),g=(0,r.Z)(m,2),p=g[0],v=g[1];return a.useEffect((function(){var e=return e(),c.addEventListener("scroll",e,{passive:!0}),),[c,n,JSON.stringify(f)]),p}var c=n(50301),f=n(25258),h=n(46417);function m(e){var t=e.children,n=e.window,i=(0,a.useState)(void 0),o=(0,r.Z)(i,2),s=o[0],l=o[1],d=document.getElementById("main")||void 0,m=n?n():d,g=u({target:s});return f.Z.debug("Trigger target %s",s),(0,a.useEffect)((,[d,m]),(0,h.jsx)(c.Z,{id:"slider",appear:!1,direction:"down",in:!g,easing:{enter:"cubic-bezier(0.4, 0, 0.2, 1)",exit:"cubic-bezier(0.4, 0, 0.2, 1)"},children:t})}m.defaultProps={window:void 0}},31500:function(e,t,n){n.d(t,{Z:function(){return u}});var r=n(1413),i=n(29439),o=n(96420),a=n(18248),s=n(28422),l=n(91345),d=n(25258);function u(){var e=(0,o.t)(s.D9W,{onCompleted:function(e){var t=e.getProfile;t&&(0,l.at)({profile:(0,r.Z)({},t)})},onError:function(e){d.Z.error("Something went wrong while updating user usage statistics",e);var t={id:(0,a.Z)(),message:"Something went wrong while updating user image count. Please refresh the page to show new image count.",severity:"none"};(0,l.sh)([t])}});return{execute:(0,i.Z)(e,1)[0]}}},47053:function(e,t,n){function r(e){var t,n,r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;if(null!==e&&void 0!==e&&null!==(t=e.originalImage)&&void 0!==t&&t.url){var o=e.originalImage.url.split("?")[0],a=e.originalImage.width||1/0,s={width:(null===(n=e.originalImage.width)||void 0===n?void 0:n.toString())||"590",height:(null===(r=e.originalImage.height)||void 0===r?void 0:r.toString())||"590",fit:"bounds"};i<=590&&a>=590&&(s.width="590",s.height="590"),i<=320&&a>=320&&(s.width="320",s.height="320");var l=new URLSearchParams(s).toString();return"".concat(o,"?").concat(l)}}n.d(t,{Z:function(){return r}})},13240:function(e,t,n){n.r(t),n.d(t,{default:function(){return pe}});var r=n(72668),i=n(16031),o=n(39837),a=n(28422),s=n(93433),l=n(15861),d=n(1413),u=n(64687),c=n.n(u),f=n(90297),h=n(19860),m=n(24813),g=n(36241),p=n(47313),v=n(58467),x=n(8566),y=n(17189),Z=n(72657),b=n(91345),j=n(20716),I=n(68728),w=n(20201),S=n(71651),R=n(944),T=n(96849),C=n(65582),M=n(47053),_=n(61113),D=n(70816),k=n.n(D),E=n(46417);function z(e){var t=e.deletedAt,n=k()().diff(k()(t),"days");return(0,E.jsx)(_.Z,{align:"center",sx:{fontWeight:500},children:"".concat((30-n).toString()," days left")})}function A(e){var t,n=e.data,r=e.rowIndex,i=e.columnIndex,o=e.style,a=(0,w.Z)(),s=(0,f.l)(b.YR),l=(0,p.useRef)(null),u=(0,S.Z)(l),c=n.items,h=n.selectedMedia,m=n.selectModeEnabled,g=n.toggleBulkSelect,v=n.toggleSelect,x=n.zoom,y=c[r*x+i],Z=!s&&(null===y||void 0===y?void 0:y.isBlurred),j=(0,M.Z)(y,Number(o.width)),_=h.get(null===y||void 0===y?void 0:y.id),D="small";x<4&&(D="medium");return y?(0,E.jsxs)("div",{style:(0,d.Z)((0,d.Z)({},o),{},{bottom:20}),ref:l,children:[(0,E.jsxs)(T.Z,{isActive:m||_||u,onClick:function(e){e.shiftKey?g(y.id,c):v(y.id)},sx:{top:8,left:8,zIndex:1,backgroundColor:_?a.palette.primary.main:"rgba(71,85,105,0.5)","&:hover":{backgroundColor:_?"white":"rgba(71,85,105,0.9)"}},"data-test":_?"deselect":"select",children:[_&&(0,E.jsx)(I.Z,{color:"inherit",fontSize:D,sx:{background:a.palette.primary.main,borderRadius:"50%",padding:"2px"}}),!_&&(0,E.jsx)(I.Z,{color:"inherit",fontSize:D,sx:{background:"transparent",borderRadius:"50%",padding:"2px"}})]}),(0,E.jsx)("img",{alt:y.title,"data-test":"trash-item",onError:function(e){e.currentTarget.src=y.isVideoType?R.h:R.N,e.currentTarget.srcset=y.isVideoType?R.h:R.N},role:"presentation",src:j,srcSet:j,style:{borderStyle:"solid",borderWidth:3,borderColor:"transparent",filter:Z?"blur(5px) brightness(95%)":"none",width:Number(o.width)-10,height:Number(o.height)-40,objectFit:"contain",display:"flex"}}),(null===y||void 0===y?void 0:y.isBlurred)&&(0,E.jsx)(C.Z,{}),(0,E.jsx)(z,{deletedAt:null===(t=y.deletionState)||void 0===t?void 0:t.deletedAt})]}):null}var P=(0,p.forwardRef)((function(e,t){var n=e.children,r=e.style,i=e.onScroll,o=(0,p.useRef)(0);return(0,E.jsx)("div",{id:"gallery",style:(0,d.Z)((0,d.Z)({},r),{},{overflowX:"hidden"}),onScroll:function(e){e.currentTarget.scrollTop>o.current?(0,b.MD)("down"):(0,b.MD)("up"),o.current=e.currentTarget.scrollTop,i(e)},ref:t,children:n})})),L=(0,p.forwardRef)((function(e,t){var n=e.style,r=e.children;return(0,E.jsx)("div",{"data-test":"grid",ref:t,style:(0,d.Z)((0,d.Z)({},n),{},{height:Number(n.height)+84}),children:r})}));function O(e){var t=e.items,n=e.fetchMore,r=e.hasMore,i=(0,f.l)(b._N).media,o=g.isMobile?0:14,a=d=(0,p.useRef)(null),u=(0,h.Z)(),I=(0,m.Z)(u.breakpoints.down("sm"))?1:4,w=(0,v.UO)().albumId,S=(0,v.TH)(),R=new URLSearchParams(S.search).get("scrollTo"),T=t.findIndex((),C=(0,p.useRef)(I),M=(0,j.Z)(),_=M.selectedMedia,D=M.toggleBulkSelect,k=new Map;_.forEach((),(0,p.useEffect)((function(){return(0,b.WV)([]),(0,b._N)({}),(0,b.MD)(null),(0,b.eG)({}),function(){(0,b.WV)([]),(0,b._N)({}),(0,b.MD)(null),(0,b.eG)({})}}),[w]),(0,p.useEffect)((function(){if(R&&-1!==T){var e,t=Math.floor((T||0)/C.current);null===(e=d.current)||void 0===e||e.scrollToItem({align:"smart",columnIndex:0,rowIndex:t})}}),[R,T]);var z=function(){var e=(0,l.Z)(c().mark((function e(r,i){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t[i]||n();case 1:case"end":return e.stop()}}),e)})));return (),O={items:t,selectedMedia:k,selectModeEnabled:i,toggleSelect:function(e){k.get(e)?(0,b.WV)(_.filter(()):(0,b.WV)([].concat((0,s.Z)(_),[e]))},toggleBulkSelect:D,zoom:I};return(0,E.jsx)("div",{"data-test":"drag-and-drop",style:{flex:1,position:"relative"},children:(0,E.jsx)(x.Z,{children:function(e){var n=e.height,i=e.width;return(0,E.jsx)(Z.Z,{isItemLoaded:a,itemCount:t.length+Number(r),loadMoreItems:z,children:function(e){var r=e.onItemsRendered,a=e.ref;return i&&n?(0,E.jsx)(y.Ym,{columnCount:I,columnWidth:Math.floor(i/I)-Math.floor(o/I),height:n,innerElementType:L,itemData:O,ref:outerElementType:P,rowCount:Math.ceil(t.length/I),rowHeight:Math.floor(i/I)-Math.floor(o/I),width:i,onItemsRendered:function(e){var n=e.overscanRowStartIndex*I,i=e.overscanRowStopIndex*I,o=e.visibleRowStartIndex*I,a=e.visibleRowStopIndex*I,s=t[o].uploadDate,l=t[a].uploadDate;r({overscanStartIndex:n,overscanStopIndex:i,visibleStartIndex:o,visibleStopIndex:a}),s&&l&&(0,b.eG)({startDate:s,endDate:l})},children:A}):(0,E.jsx)("div",{})}})}})})}var U=n(96217),H=n(99881),N=n(47825);function W(e){return e.isEmpty?(0,E.jsxs)(N.Z,{maxWidth:"md",sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:"300px",paddingTop:"15%"},children:[(0,E.jsx)(U.Z,{sx:{fontSize:"7rem"},color:"primary","data-test":"trash-empty-icon"}),(0,E.jsx)(_.Z,{sx:{fontSize:"1rem",fontWeight:500},"data-test":"trash-empty-text",children:"Your Trash is Empty"})]}):(0,E.jsx)(H.Z,{severity:"info",children:"Images in your Trash will be automatically deleted after 30 days. Images in your Trash will continue to apply toward your storage threshold until they are permanently deleted."})}var B=n(4942),Y=n(74615),F=n(42832),V=n(17592),G=n(9289),Q=n(75909),q=n(36575),J=n(29439),K=n(51997),X=n(24193),$=n(57451),ee=n(47131),te=n(61689),ne=n(37673),re=n(60790),ie=n(18248),oe=n(25258),ae=n(31500);function se(e){var t=e.isDisabled,n=e.trashId,r=e.selectedMedia,i=e.deselectAllMedia,o=(0,p.useState)(!1),s=(0,J.Z)(o,2),l=s[0],d=s[1],u=function(){var e=(0,ae.Z)(),t=(0,re.D)(a.aYQ,{update:function(t,n,r){var i,o=r.variables,s=null===(i=n.data)||void 0===i?void 0:i.imagesDelete;if(null!==s&&void 0!==s&&s.length){var l=0;s.forEach((function(e){var n=t.readFragment({id:"Image:".concat(e),fragment:a.xDo});l+=(null===n||void 0===n?void 0:n.image.size)||0,t.evict({id:"Image:".concat(e)})})),t.modify({id:"AlbumDetails:".concat(null===o||void 0===o?void 0:o.albumId),fields:{imageCount:function(e){return e-s.length},usedSpace:function(e){return e-l}}}),t.gc(),e.execute(),oe.Z.debug("Cache flushed for: ",s)}},onCompleted:function(){var e={id:(0,ie.Z)(),message:"Images have been deleted!",severity:"none"};(0,b.sh)([e])},onError:function(){var e={id:(0,ie.Z)(),message:"Images have been deleted!",severity:"none"};(0,b.sh)([e])},refetchQueries:[],awaitRefetchQueries:!0}),n=(0,J.Z)(t,2),r=n[0],i=n[1];return{mutation:r,results:i,loading:i.loading}}(),c=u.mutation,f=function(){return d(!1)},h=function(){return d(!0)};return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)($.Z,{smUp:!0,children:(0,E.jsx)(ee.Z,{color:"primary",disabled:t,onClick:h,children:(0,E.jsx)(te.Z,{title:"Permanently Delete",children:(0,E.jsx)(K.Z,{})})})}),(0,E.jsx)($.Z,{smDown:!0,children:(0,E.jsxs)(X.Z,{sx:{textTransform:"none",marginLeft:"6px",marginRight:"4px"},color:"primary","data-test":"permenently-delete",disabled:t,onClick:h,startIcon:(0,E.jsx)(K.Z,{}),variant:"outlined",children:[(0,E.jsx)($.Z,{mdDown:!0,children:"Permanently "}),"Delete"]})}),(0,E.jsx)(ne.Z,{isOpen:l,onSecondayAction:f,onSecondayActionText:(0,E.jsx)("p",{children:"Cancel"}),onSubmit:function(){c({variables:{albumId:n,imageIds:r}}),i(),f()},close:f,onSubmitText:(0,E.jsx)("p",{children:"Yes, Delete"}),title:"Are you sure you want to permanently delete this image?",subTitle:"The selected ".concat(r.length," image").concat(r.length>1?"s":""," will be permanently deleted. You cannot undo this action.")})]})}var le=n(92769);function de(e){var t=e.isDisabled,n=function(){var e=(0,ae.Z)(),t=(0,f.l)(b.sh),n=(0,re.D)(a.zrG,{update:function(t){var n=t.readQuery({query:a.o2m}),r=(null===n||void 0===n?void 0:n.getTrashImages.items)||[],i=null===n||void 0===n?void 0:n.getTrashAlbumDetails.id,o=0;r.forEach((function(e){e&&(o+=e.image.size||0,t.evict({id:"Image:".concat(e.id)}))})),i&&t.modify({id:"AlbumDetails:".concat(i),fields:{imageCount:usedSpace:}),t.gc(),e.execute(),oe.Z.debug("Cache flushed for: ",r)},onCompleted:function(){var n={id:(0,ie.Z)(),message:"Trash was successfully empty.",severity:"success"};(0,b.sh)([].concat((0,s.Z)(t),[n])),e.execute()},onError:function(){var e={id:(0,ie.Z)(),message:"There was a problem to emtpy trash. Please try again later.",severity:"error"};(0,b.sh)([].concat((0,s.Z)(t),[e]))}}),r=(0,J.Z)(n,2),i=r[0],o=r[1];return{mutation:i,results:o,loading:o.loading}}(),r=n.mutation,i=(0,p.useState)(!1),o=(0,J.Z)(i,2),l=o[0],d=o[1],u=function(){return d(!1)},c=function(){return d(!0)};return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)($.Z,{smUp:!0,children:(0,E.jsx)(ee.Z,{color:"primary",disabled:t,onClick:c,children:(0,E.jsx)(te.Z,{title:"Empty Trash",children:(0,E.jsx)(le.Z,{})})})}),(0,E.jsx)($.Z,{smDown:!0,children:(0,E.jsxs)(X.Z,{sx:{textTransform:"none",marginLeft:"6px",marginRight:"4px"},color:"primary","data-test":"empty-trash",disabled:t,onClick:c,startIcon:(0,E.jsx)(le.Z,{}),variant:"outlined",children:["Empty",(0,E.jsx)($.Z,{mdDown:!0,children:" Trash"})]})}),(0,E.jsx)(ne.Z,{isOpen:l,onSecondayAction:u,onSecondayActionText:(0,E.jsx)("p",{children:"Cancel"}),onSubmit:function(){r(),u()},close:u,onSubmitText:(0,E.jsx)("p",{children:"Yes, Delete"}),title:"Are you sure you want to Empty Trash?",subTitle:"All images in your Trash will be permanently deleted. You cannot undo this action."})]})}var ue=n(32897),ce=n(46923),fe=n(58965);function he(e){var t=e.isDisabled,n=e.selectedMedia,r=e.deselectAllMedia,i=(0,p.useState)(!1),o=(0,J.Z)(i,2),a=o[0],s=o[1],l=d=function(){return s(!1)};return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)($.Z,{smUp:!0,children:(0,E.jsx)(ee.Z,{color:"primary",disabled:t,onClick:l,children:(0,E.jsx)(te.Z,{title:"Restore",children:(0,E.jsx)(ue.Z,{})})})}),(0,E.jsx)($.Z,{smDown:!0,children:(0,E.jsx)(X.Z,{sx:{textTransform:"none",marginLeft:"6px",marginRight:"4px"},color:"primary","data-test":"restore",disabled:t,onClick:l,variant:"outlined",startIcon:(0,E.jsx)(ue.Z,{}),children:"Restore"})}),(0,E.jsx)(ce.ZP,{anchor:"right",open:a,onClose:d,PaperProps:{sx:{width:"400px",maxWidth:"100%"}},children:(0,E.jsx)(fe.Z,{imageIds:n,onClose:d,handleMoveSuccess:)})]})}var me=(0,V.ZP)(G.Z)((function(e){return(0,B.Z)({background:"white",position:"sticky",width:"100%",justifyContent:"space-between",alignItems:"center",top:0,zIndex:1e3,minHeight:"90px",padding:"0 10px"},e.theme.breakpoints.up("sm"),{top:0,minHeight:"90px",paddingLeft:"0 15px"})}));function ge(e){var t=e.trashId,n=e.imageCount,r=e.usedSpace,o=(0,h.Z)(),a=(0,m.Z)(o.breakpoints.down("md")),s=(0,j.Z)(),l=s.deselectAll,d=s.selectedMedia,u="".concat(n,1===n?" Image":" Images");return(0,E.jsx)(q.Z,{children:(0,E.jsxs)(me,{disableGutters:a,children:[(0,E.jsxs)(F.Z,{direction:{xs:"column",md:"row"},justifyContent:"flex-start",alignItems:{xs:"flex-start",md:"center"},gap:{xs:0,md:"10px"},children:[(0,E.jsxs)(F.Z,{direction:"row",alignItems:"center",gap:"4px",children:[(0,E.jsx)(Y.Z,{}),(0,E.jsx)(_.Z,{variant:"h6",sx:{fontWeight:600},children:"Trash"})]}),(0,E.jsxs)(_.Z,{sx:{fontSize:{xs:"0.75rem",md:"0.875rem"}},children:[u," [",(0,Q.Z)(r,2),"]"]})]}),(0,E.jsxs)(F.Z,{direction:"row",justifyContent:"flex-start",alignItems:"center",gap:"4px",children:[(0,E.jsx)(de,{isDisabled:n<1}),(0,E.jsx)(he,{isDisabled:(0,i.isEmpty)(d),deselectAllMedia:l,selectedMedia:d}),(0,E.jsx)(se,{isDisabled:(0,i.isEmpty)(d),selectedMedia:d,deselectAllMedia:l,trashId:t})]})]})})}function pe(){var e,t,n,s,l,d,u,c=(0,r.a)(a.o2m,{variables:{pageSize:20,trashSorter:{desc:!1}}}),f=null!==(e=c.data)&&void 0!==e&&e.getTrashImages?null===(t=c.data)||void 0===t||null===(n=t.getTrashImages)||void 0===n?void 0:n.items:[],h=(null===(s=c.data)||void 0===s?void 0:s.getTrashAlbumDetails.imageCount)||0,m=(null===(l=c.data)||void 0===l?void 0:l.getTrashAlbumDetails.usedSpace)||0,g=null===(d=c.data)||void 0===d?void 0:d.getTrashAlbumDetails.id,p=null===(u=c.data)||void 0===u?void 0:u.getTrashImages.scrollPointer;if(!g)return null;var v=(0,i.debounce)((function(){p&&c.fetchMore({variables:{scrollPointer:p}})}),500,{leading:!0});return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(o.Z,{title:"Trash"}),(0,E.jsx)(ge,{imageCount:h,usedSpace:m,trashId:g}),(0,E.jsx)(W,{isEmpty:c.called&&!c.loading&&(0,i.isEmpty)(f)}),(0,E.jsx)(O,{items:f,fetchMore:v,hasMore:!!p})]})}},68728:function(e,t,n){var r=n(64836);t.Z=void 0;var i=r(n(45045)),o=n(46417),a=(0,i.default)((0,o.jsx)("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check");t.Z=a},92769:function(e,t,n){var r=n(64836);t.Z=void 0;var i=r(n(45045)),o=n(46417),a=(0,i.default)((0,o.jsx)("path",{d:"M15 16h4v2h-4zm0-8h7v2h-7zm0 4h6v2h-6zM3 18c0 1.1.9 2 2 2h6c1.1 0 2-.9 2-2V8H3v10zM14 5h-3l-1-1H6L5 5H2v2h12z"}),"DeleteSweep");t.Z=a},32897:function(e,t,n){var r=n(64836);t.Z=void 0;var i=r(n(45045)),o=n(46417),a=(0,i.default)((0,o.jsx)("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"}),"Restore");t.Z=a},3485:function(e,t,n){n.d(t,{S1:function(){return o},ZT:function(){return r},jU:function(){return a},on:);var r=function i(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e&&e.addEventListener&&e.addEventListener.apply(e,t)}ar a="undefined"!==typeof window},71651:function(e,t,n){var r=n(47313),i=n(3485);t.Z=,72657:function(e,t,n){var r=n(47313);var i=o=),a=s=function(e){eturn t,e),o(t,[{key:"resetloadMoreItemsCache",value:,{key:"componentDidMount",value:,{key:"render",value:,{key:"_ensureRowsLoaded",value:,{key:"_loadUnloadedRanges",value:function(e){for(var t=this,n=this.props.loadMoreItems||this.props.loadMoreRows,r=function(r){var i=e[r],o=e[r+1],a=n(i,o);null!=a&&a.then((function(){if({lastRenderedStartIndex:t._lastRenderedStartIndex,lastRenderedStopIndex:t._lastRenderedStopIndex,startIndex:i,stopIndex:o})){if(null==t._listRef)return;"function"===typeof t._listRef.resetAfterIndex?t._listRef.resetAfterIndex(i,!0):("function"===typeof t._listRef._getItemStyleCache&&t._listRef._getItemStyleCache(-1),t._listRef.forceUpdate())}}))},i=0;i<e.length;i+=2)r(i)}}]),t}(r.PureComponent);t.Z=s}}]);