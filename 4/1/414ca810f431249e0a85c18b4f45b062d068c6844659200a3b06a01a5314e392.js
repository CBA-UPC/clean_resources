mw.loader.impl(function(){return["ext.gadget.AddTopic@1fhoc",function($,jQuery,require,module){(function(){var $newSectionLink=$('#ca-addsection a');if($newSectionLink.length){var $link=$newSectionLink.clone();$link.removeAttr('accesskey').updateTooltipAccessKeys();var $lastEditsectionLink=$('span.mw-editsection:last a:last');$lastEditsectionLink.after($link);$lastEditsectionLink.after(' | ');}}());
}];});
mw.loader.impl(function(){return["ext.gadget.CentralAuthInterlinkFixer@1myf0",function($,jQuery,require,module){(function(mw,$){'use strict';function host(id){var wikimedia,idNoSpaces;if(id==='mediawikiwiki'){return'mediawiki.org';}if(id==='foundationwiki'){return'wikimediafoundation.org';}if(id==='wikidatawiki'){return'wikidata.org';}wikimedia=/^(advisory|auditcom|board|chair|chapcom|collab|comcom|commons|exec|grants|incubator|internal|login|meta|office|otrs wiki|quality|spcom|species|strategy|steward|wikimaniateam|wikimania20\d\d)wiki$/;if(wikimedia.test(id)){return id.replace(/ /g,'-').replace(/_/g,'-').replace(/wiki$/,'.wikimedia.org');}idNoSpaces=id.match(/(arbcom enwiki|labswikimedia|pa uswikimedia|wg enwiki)$/)?id.replace(/ /g,'.'):id.replace(/ /g,'-');idNoSpaces=idNoSpaces.replace(/(wiki([mp]edia|quote|source|books|news|versity)|wiktionary)/,'.$1.org').replace(/wiki$/,'.wikipedia.org');if(idNoSpaces.indexOf('.org')!==-1){return idNoSpaces;}return false;}function fixCrosswikiLinks(){$('body li a').each(function(){var bits,wiki,user,hostName,$el=$(this),txt=$el.text();if(txt.indexOf('@')
!==-1&&txt.indexOf('/')===-1&&/^User\:/i.test(txt)){bits=txt.split('@');user=bits.shift().replace(/^\s*User:(.+)\s*$/g,'$1');wiki=bits.join('@');if(wiki==='global'){$el.attr('href',mw.config.get('wgScript')+'?title=Special:CentralAuth&target='+encodeURIComponent(user));}else{hostName=host(wiki);if(hostName){$el.attr('href','//'+hostName+'/wiki/User:'+encodeURIComponent(user));}}if(wiki!=='metawiki'){$el.removeClass('new external').addClass('extiw');}$el.attr('title',txt);}});}if(mw.config.get('wgCanonicalSpecialPageName')==='Log'||mw.config.get('wgCanonicalSpecialPageName')==='Recentchanges'){mw.hook('wikipage.content').add(fixCrosswikiLinks);}}(mediaWiki,jQuery));
}];});
mw.loader.impl(function(){return["ext.gadget.ReferenceTooltips@1un1v",function($,jQuery,require,module){$(function(){var settings,settingsString,$footer,enabled,delay,isTouchscreen,settingsMenu;if(window.pg){return;}function toggleRT(enable){mw.loader.using('mediawiki.cookie',function(){mw.cookie.set('RTsettings',(enable?'1':'0')+'|'+settings[1]+'|'+settings[2],{path:'/',expires:90});location.reload();});}if(['','Project','Help','Draft'].indexOf(mw.config.get('wgCanonicalNamespace'))>-1){mw.messages.set({'RT-enable':'Enable Reference Tooltips','RT-disable':'Disable Reference Tooltips','RT-disablenote':'Once disabled, Reference Tooltips can be re-enabled using a link in the footer of the page.','RT-delay':'Delay before the tooltip appears (in milliseconds): ','RT-activationmethod':'Tooltip is activated by:','RT-hovering':'hovering','RT-clicking':'clicking','RT-options':'Reference Tooltips options','RT-options-save':'Save settings','RT-settings':'Tooltip settings'});settingsString=document.cookie.split('RTsettings=')[1];if(settingsString){settings=settingsString.split(';')[0].split('%7C');
enabled=!!+settings[0];delay=+settings[1];isTouchscreen=!!+settings[2];}else{enabled=true;delay=200;isTouchscreen='ontouchstart'in document.documentElement;settings=[+enabled,delay,+isTouchscreen];}if(!enabled){$footer=$('#footer-places, #f-list');if(!$footer.length){$footer=$('#footer li').parent();}$footer.append($('<li>').append($('<a>').text(mw.msg('RT-enable')).attr('href','').on('click',function(e){e.preventDefault();toggleRT(true);})));return;}$('.reference').each(function(){var tooltipNode,hideTimer,showTimer,checkFlip=false;function findRef(h){h=h.firstChild;h=h&&h.getAttribute&&h.getAttribute('href');h=h&&h.split('#');h=h&&h[1];h=h&&document.getElementById(h);h=h&&h.nodeName==='LI'&&h;return h;}function hide(refLink){if(tooltipNode&&tooltipNode.parentNode===document.body){hideTimer=setTimeout(function(){$(tooltipNode).animate({opacity:0},100,;},isTouchscreen?16:100);}else{$(findRef(refLink)).removeClass('RTTarget');}}
function show(){if(!tooltipNode.parentNode||tooltipNode.parentNode.nodeType===11){document.body.appendChild(tooltipNode);checkFlip=true;}$(tooltipNode).stop().animate({opacity:1},100);clearTimeout(hideTimer);}function openSettingsMenu(){if(settingsMenu){settingsMenu.dialog('open');}else{settingsMenu=$('<form>').append($('<button>').css('width','100%').text(mw.msg('RT-disable',mw.user)).button().on('click',,$('<br>'),$('<small>').text(mw.msg('RT-disablenote')),$('<hr>'),$('<label>').text(mw.msg('RT-delay')).append($('<input>').attr({type:'number',value:delay,step:50,min:0,max:5000})),$('<br>'),$('<span>').text(mw.msg('RT-activationmethod',mw.user)),$('<label>').append($('<input>').attr({type:'radio',name:'RTActivate',checked:!isTouchscreen?'checked':undefined,disabled:'ontouchstart'in document.documentElement?'disabled':undefined}),mw.msg('RT-hovering',mw.user)),$('<label>').append($('<input>').attr({type:'radio',name:'RTActivate',checked
:isTouchscreen?'checked':undefined}),mw.msg('RT-clicking',mw.user))).submit(.dialog({modal:true,width:500,title:mw.msg('RT-options'),buttons:[{text:mw.msg('RT-options-save',mw.user),click:function(){var inputs=this.getElementsByTagName('input'),newDelay=+inputs[0].value;mw.cookie.set('RTsettings','1|'+(newDelay>-1&&newDelay<5001?newDelay:delay)+'|'+(inputs[1].checked?'0':'1'),{path:'/',expires:90});location.reload();}}]});}}function onStartEvent(e){var onBodyClick,self=this;if(window.pg){return;}if(isTouchscreen){e.preventDefault();if(!(tooltipNode&&tooltipNode.parentNode===document.body)){onBodyClick=function(e){e=e.target;for(;e&&!$(e).hasClass('referencetooltip');){e=e.parentNode;}if(!e){clearTimeout(showTimer);hide(self);$(document.body).off('click touchstart',onBodyClick);}};setTimeout(;}}if(hideTimer){clearTimeout(hideTimer);}if(showTimer){clearTimeout(showTimer);}showTimer=
setTimeout(function(){var windowTop,hOffsetTop,c,o,oH,h=findRef(self);if(!h){return;}windowTop=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop;hOffsetTop=$(h).offset().top;if(!isTouchscreen&&windowTop<hOffsetTop&&windowTop+$(window).height()>hOffsetTop+h.offsetHeight){$(h).addClass('RTTarget');return;}if(!tooltipNode){tooltipNode=document.createElement('ul');tooltipNode.className='referencetooltip';c=tooltipNode.appendChild($(h).clone(true)[0]);try{if(c.firstChild.nodeName!=='A'){while(c.childNodes[1].nodeName==='A'&&c.childNodes[1].getAttribute('href').indexOf('#cite_ref-')!==-1){do{c.removeChild(c.childNodes[1]);}while(c.childNodes[1].nodeValue===' ');}}}catch(err){mw.log(err);}c.removeChild(c.firstChild);$(tooltipNode.firstChild.insertBefore(document.createElement('span'),tooltipNode.firstChild.firstChild)).addClass('RTsettings').attr('title',mw.msg('RT-settings')).on('click',function(){mw.loader.using(['mediawiki.cookie','jquery.ui'],openSettingsMenu
);});tooltipNode.appendChild(document.createElement('li'));if(!isTouchscreen){$(tooltipNode).on({mouseenter:show,mouseleave:hide});}}show();o=$(self).offset();oH=tooltipNode.offsetHeight;$(tooltipNode).css({top:o.top-oH,left:o.left-7});if(tooltipNode.offsetHeight>oH){$(tooltipNode).css({left:'auto',right:0});tooltipNode.lastChild.style.marginLeft=(o.left-tooltipNode.offsetLeft)+'px';}if(checkFlip){if(o.top<tooltipNode.offsetHeight+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop)){$(tooltipNode).addClass('RTflipped').css({top:o.top+12});}else if(tooltipNode.className==='referencetooltip RTflipped'){$(tooltipNode).removeClass('RTflipped');}checkFlip=false;}},isTouchscreen?0:delay);}function onEndEvent(){clearTimeout(showTimer);hide(this);}$(this).on(isTouchscreen?{click:onStartEvent}:{mouseenter:onStartEvent,mouseleave:onEndEvent});});}});
},{"css":[".referencetooltip{position:absolute;list-style:none;list-style-image:none;opacity:0;font-size:10px;margin:0;z-index:5;padding:0}.referencetooltip li{border:#080086 2px solid;max-width:260px;padding:10px 8px 13px 8px;margin:0px;background-color:#F7F7F7;-webkit-box-shadow:2px 4px 2px rgba(0,0,0,0.3);-moz-box-shadow:2px 4px 2px rgba(0,0,0,0.3);box-shadow:2px 4px 2px rgba(0,0,0,0.3)}.referencetooltip li+li{margin-left:7px;margin-top:-2px;border:0;padding:0;height:3px;width:0px;background-color:transparent;-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none;border-top:12px #080086 solid;border-right:7px transparent solid;border-left:7px transparent solid}.referencetooltip\u003Eli+li::after{content:'';border-top:8px #F7F7F7 solid;border-right:5px transparent solid;border-left:5px transparent solid;margin-top:-12px;margin-left:-5px;z-index:1;height:0px;width:0px;display:block}.client-js body .referencetooltip li li{border:none;-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none;height:auto;width:auto;margin:auto;padding:0;position:static}.RTflipped{padding-top:13px}.referencetooltip.RTflipped li+li{position:absolute;top:2px;border-top:0;border-bottom:12px #080086 solid}.referencetooltip.RTflipped li+li::after{border-top:0;border-bottom:8px #F7F7F7 solid;position:absolute;margin-top:7px}.RTsettings{float:right;height:20px;width:20px;padding:2px;cursor:pointer;background-image:url(//upload.wikimedia.org/wikipedia/commons/thumb/0/05/OOjs_UI_icon_advanced.svg/20px-OOjs_UI_icon_advanced.svg.png);background-image:linear-gradient(transparent,transparent),url(//upload.wikimedia.org/wikipedia/commons/0/05/OOjs_UI_icon_advanced.svg);background-repeat:no-repeat;background-position:center;margin-top:-9px;margin-right:-7px;-webkit-transition:opacity 0.15s;-moz-transition:opacity 0.15s;-ms-transition:opacity 0.15s;-o-transition:opacity 0.15s;transition:opacity 0.15s;opacity:0.6;filter:alpha(opacity=60)}.RTsettings:hover{opacity:1;filter:alpha(opacity=100)}.RTTarget{border:#080086 2px solid}"]}];});
mw.loader.impl(function(){return["ext.gadget.aaq@1ur66",function($,jQuery,require,module){(function(){'use strict';var questionTextBox;mw.loader.using(['oojs-ui','oojs-ui.styles.icons-alerts']).done(function(){if(mw.config.get('wgPageName').split('/')[0]=='Ask_a_question'||mw.config.get('wgPageName')=='Template:Ask_button'){var that=this,gadgetMsg,userLang;gadgetMsg={};userLang=mw.config.get('wgUserLanguage');new mw.Api().get({action:'query',list:'messagecollection',mcgroup:'page-Template:I18n/Ask_a_question',mclanguage:userLang}).done(function(data){var i,res,key,val;res=data.query.messagecollection;for(i=0;i<res.length;i++){key=res[i].key.replace('Template:I18n/Ask_a_question/','');val=res[i].translation;if(!val){val=res[i].definition;}gadgetMsg[key]=val;}questionTextBox=new OO.ui.MultilineTextInputWidget({rows:5,placeholder:gadgetMsg['question-placeholder']});$('.aaq-textbox').css('margin-top','0.5625em').append(questionTextBox.$element);$('.aaq-ask-button .mw-ui-button').on('click',function(){var prefix,randomString,sectionTitle,suffix,questionAsked;event.preventDefault
();randomString=Math.random().toString(36).substring(2);questionAsked=questionTextBox.getValue();if(questionAsked){prefix='<section begin=question />\n';suffix='\n~~'+'~~\n<span class="aaq-view-discussion" id="'+randomString+'"><includeonly>\n'+': {{TNT|AAQ view discussion|'+randomString+'}}'+'</includeonly></span>\n'+'<section end=question /><!--\n\n'+'You may post responses below this line. -->';sectionTitle=mw.config.get('wgUserName')+'\'s question';questionAsked=prefix+questionAsked+suffix;new mw.Api().postWithToken('csrf',{action:'edit',section:'new',sectiontitle:sectionTitle,nocreate:true,summary:'/*'+sectionTitle+'*/ new question',title:'Ask a question/Recent questions',text:questionAsked}).done(function(){new mw.Api().postWithToken('csrf',{action:'purge',titles:['Wikimedia Resource Center','Ask a question']}).done(function(){window.location.href='https://meta.wikimedia.org/wiki/Ask_a_question/Recent_questions#'+mw.util.escapeIdForLink(randomString);location.reload();});}).fail(
;}});if(mw.config.get('wgPageName')=='Ask_a_question/Recent_questions'){$('head').append('<style>.aaq-respond-button { margin-left:1.125em; } .aaq-response { margin-top:0.5625em; margin-left:1.5em; }</style>');$('h2').each(function(){var $sectionHeader=$(this),buttonLabel,respondButton,userName;userName=$sectionHeader.children().eq(0)[0];if(userName){userName=userName.innerText.replace('\'s question','');buttonLabel=gadgetMsg['button-respond-to'].replace('$1',userName);}else{buttonLabel=gadgetMsg['button-respond'];}$sectionHeader.data('aaq-username',userName);respondButton=new OO.ui.ButtonInputWidget({label:buttonLabel,framed:false,icon:'speechBubbles',classes:['aaq-respond-button'],flags:['progressive']}).on('click',function(){var $button,defaultInput;$button=$(this);if($sectionHeader.data('aaq-username')){defaultInput='{{ping|'+$sectionHeader.data('aaq-username')+'}} ';}else{defaultInput='';}$button.responseTextBox=new OO.ui
.MultilineTextInputWidget({value:defaultInput,rows:5,classes:['aaq-response']});$button.responseSubmit=new OO.ui.ButtonInputWidget({label:gadgetMsg['button-respond-submit'],classes:['aaq-response']}).on('click',function(){var response,sectionNumber;if($button.responseTextBox.getValue()){response='\n\n: '+$button.responseTextBox.getValue()+' ~~'+'~~';sectionNumber=$button.responseSubmit.$element.parent().prevAll("h2:first").children('.mw-editsection').eq(0).children('a').eq(0).attr('href').match(/&section=(\d+)/)[1];new mw.Api().postWithToken('csrf',{title:'Ask a question/Recent questions',action:'edit',section:sectionNumber,appendtext:response}).done(function(){location.reload();});}});$sectionHeader.nextUntil('h2').last().append($button.responseTextBox.$element).append($button.responseSubmit.$element).append($('<span>'+gadgetMsg['respond-placeholder']+'</span>'));});if($sectionHeader.children().eq(1)){$sectionHeader.children().eq(1).append(respondButton.$element);}});}});}});}());
}];});
mw.loader.impl(function(){return["ext.gadget.addMe@zpyrh",function($,jQuery,require,module){var gadgetUtilities=function(){var that=this;this.interfaceMessagesPath='Meta:AddMe/InterfaceText';this.configPath='Meta:AddMe/Config';this.feedbackScrollTime=2000;this.feedbackDisappearDelay=10000;this.setFeedbackCookie=this.checkFeedbackCookie=function(value){if($.cookie(value)){$.cookie(value,null);return true;}else{return false;}};this.showErrorMessage=function(gadget,type){var errorAttr='[localize=error-'+type+']';var gadgetID='.'+gadget;$(gadgetID+' '+errorAttr).show();};this.removeErrorMessage=function(gadget){var gadgetID='.'+gadget;$(gadgetID+' [localize^="error-"]').hide();};this.grantType=function(config){var grant=mw.config.get('wgTitle').split('/')[0].replace(/ /g,'_');if(grant in config){return config[grant];}else{return config.default;}};this.userLanguage=function(){return mw.config.get('wgUserLanguage');};this.contentLanguage=function(){return mw.config.get('wgContentLanguage');};this.cleanupText=function(text){text=$.trim(text)+
' ';var indexOf=text.indexOf('~~~~');if(indexOf===-1){return text;}else{return text.slice(0,indexOf)+text.slice(indexOf+4);}};this.stripWhiteSpace=function(dict){var key;for(key in dict){if(key==='section-header'){dict['section-header-read']=dict[key].replace(/ /g,'_');dict['section-header-write']=dict[key];}dict[key]=typeof(dict[key])==='object'?that.stripWhiteSpace(dict[key]):$.trim(dict[key]);}return dict;};this.addToInfobox=this.localizeGadget=function(gadgetClass,localizeDict){$(gadgetClass+' [localize]').each(function(){var localizeValue=localizeDict[$(this).attr('localize')];if($(this).attr('value')){$(this).attr('value',localizeValue);}else if($(this).attr('placeholder')){$(this).attr('placeholder',localizeValue);}else if($(this).attr('data-placeholder')){$(this).attr('data-placeholder',localizeValue);}else{$(this).html(localizeValue);}});};this.showFeedback=function(config,InterfaceMessages){var $li=$('#'+config['section-header-read']).
parent().next().find('li').eq(-1);var $speechBubble=$li.append($('<div class="grantsSpeechBubbleContainer"></div>').html('<div class="grantsSpeechBubble">\
		<span localize="message-feedback">Thank You</span></div><div class="grantsSpeechBubbleArrowDown"></div>')).find('.grantsSpeechBubbleContainer');var width=$li.css('display','inline-block').width();$li.css('display','');$li.css('position','relative');$speechBubble.css('left',width/2+'px');$('[localize=message-feedback]').html(InterfaceMessages['message-feedback']);$('body, html').animate({scrollTop:$li[0].offsetTop},that.feedbackScrollTime);setTimeout(function(){$speechBubble.hide();},that.feedbackDisappearDelay);};};var endorseGadget=function(){var util=new gadgetUtilities();var dialog=null;var api=new mw.Api();var that=this;var createDialog=function(){dialog=$("<div id='devEndorseDialog'></div>").html(
'<div class="mw-ui-vform">\
					<div class="error grantsHide" localize="error-save">An error occurred</div>\
					<div class="error grantsHide" localize="error-login">An error occurred</div>\
				</div>\
				<div localize="message-description" class="messageDescription">Explaining your endorsement improves process</div>'+'\
				<textarea rows="5" cols="10" placeholder="Add your comment" id="devEndorseComment" class="" localize="placeholder-comment"></textarea>\
				<span localize="message-signature" class="messageSignature">Your signature will be added automatically</span>\
				<div class="gadgetControls">\
					<a href="#" localize="button-cancel" class="mw-ui-button cancel mw-ui-quiet">Cancel</a>\
					<input type="submit" localize="button-submit" class="mw-ui-button mw-ui-constructive add-endorse" disabled localize="button" value="Ok"></input>\
				</div>').dialog({dialogClass:'grantsGadget endorseGadget',autoOpen:false,title:'Endorse Comment',width:'495px',modal:true,closeOnEscape
:true,resizable:false,draggable:false,close:function(){$('#devEndorseComment').val('');}});$('.add-endorse').on('click',function(){that.addEndorsement(util.cleanupText($('#devEndorseComment').val()));});$('#devEndorseComment').on('change keyup paste',function(){util.removeErrorMessage('endorseGadget');if($(this).val()){$('.add-endorse').attr('disabled',false);$('.messageSignature').css('visibility','visible');}else{$('.add-endorse').attr('disabled',true);$('.messageSignature').css('visibility','hidden');}});$('.endorseGadget .ui-dialog-title').attr('localize','title');$('.endorseGadget .cancel').on('click',function(){dialog.dialog('close');});util.localizeGadget('.endorseGadget',that.interfaceMessages);$('.messageSignature').css('visibility','hidden');};this.Dialog=function(){if(dialog===null){createDialog();}else{dialog.dialog('open');}};this.addEndorsement=function(text){var endorseComment='\n*'+text+'~~~~'+'\n';api.get({format:'json',action:'parse',prop:'sections',page:mw.config.get
('wgPageName')}).then(function(result){var sections=result.parse.sections;var sectionCount=1;var sectionFound=false;for(var section in sections){if($.trim(sections[section].anchor)===that.config['section-header-read']){sectionFound=true;break;}sectionCount++;}if(sectionFound){api.get({format:'json',action:'parse',prop:'wikitext',page:mw.config.get('wgPageName'),section:sectionCount}).then(function(result){var wikitext=result.parse.wikitext['*'];var endorsementSection=wikitext+endorseComment;api.post({action:'edit',title:mw.config.get('wgPageName'),text:endorsementSection,summary:'Endorsed by '+mw.user.getName(),section:sectionCount,watchlist:'watch',token:mw.user.tokens.get('csrfToken')}).then(function(){console.log('Successfully added endorsement');window.location.reload(true);util.setFeedbackCookie('endorseFeedback');},function(){util.showErrorMessage('endorseGadget','save');});});}else{var sectionHeader=that.config['section-header-write'];api.post({action:'edit',title:mw.config.get(
'wgPageName'),section:'new',summary:sectionHeader+' Endorsed by '+mw.user.getName(),sectiontitle:sectionHeader,text:$.trim(endorseComment),watchlist:'watch',token:mw.user.tokens.get('csrfToken')}).then(function(){console.log('Successfully added endorsement');location.reload();util.setFeedbackCookie('endorseFeedback');},function(){util.showErrorMessage('endorseGadget','save');});}},function(){util.showErrorMessage('endorseGadget','save');});};};var joinGadget=function(){var util=new gadgetUtilities();var dialog=null;this.config=null;this.interfaceMessages=null;var roleDict={};var api=new mw.Api();var that=this;var extractInfobox=function(markup){var startIndex=markup.indexOf('{{Probox');var counter=0;var endIndex=0;for(var i=startIndex;i<markup.length;i++){if(markup[i]==='}'&&markup[i+1]==='}'){counter++;}if(markup[i]==='{'&&markup[i+1]==='{'){counter--;}if(counter===0){endIndex=i+2;break;}}if(counter!==0){return'';}var infobox={infobox:markup.slice(startIndex,endIndex),before:markup.
slice(0,startIndex),after:markup.slice(endIndex)};return infobox;};var createDialog=function(){dialog=$("<div id='devJoinDialog'></div>").html(
'<div class="mw-ui-vform">\
					<div class="error grantsHide" localize="error-save">An error occurred</div>\
					<div class="error grantsHide" localize="error-login">An error occurred</div>\
				</div>\
				<select class="roleSelect" localize="placeholder-role" data-placeholder="Select a role">\
					<option></option>\
				</select>\
				<div localize="message-description" class="messageDescription">Tell us how you would like to help</div>\
				<textarea rows="5" cols="10" placeholder="Add your comment" id="devJoinComment" class="" localize="placeholder-comment"></textarea>\
				<span localize="message-signature" class="messageSignature">Your signature will be added automatically</span>\
				<div class="gadgetControls">\
					<a href="#" localize="button-cancel" class="mw-ui-button cancel mw-ui-quiet">Cancel</a>\
					<input type="submit" localize="button-join" class="mw-ui-button mw-ui-constructive add-join" disabled localize="button" value="Join"></input>\
				</div>').dialog({
dialogClass:'grantsGadget joinGadget',autoOpen:false,title:'join Comment',width:'495px',modal:true,closeOnEscape:true,resizable:false,draggable:false,close:function(){$('#devJoinComment').val('');}});$('.add-join').on('click',function(){var joinRole=$('.roleSelect').val().replace(/_/,' ');joinRole=joinRole[0].toUpperCase()+joinRole.slice(1);joinRole="'''"+joinRole+"'''"+' ';that.addjoinment(joinRole+util.cleanupText($('#devJoinComment').val()));});$('#devJoinComment').on('change keyup paste',function(){util.removeErrorMessage('joinGadget');if($(this).val()){$('.messageSignature').css('visibility','visible');if($('.roleSelect').val()){$('.add-join').attr('disabled',false);}}else{$('.add-join').attr('disabled',true);$('.messageSignature').css('visibility','hidden');}});$('.joinGadget .ui-dialog-title').attr('localize','title');$('.joinGadget .cancel').on('click',;util.localizeGadget('.joinGadget',that.interfaceMessages);$('.messageSignature').css(
'visibility','hidden');api.get({format:'json',action:'parse',prop:'wikitext',page:mw.config.get('wgPageName'),section:0}).then(function(result){var roles=that.interfaceMessages.roles;var wikitext=result.parse.wikitext['*'];var content=extractInfobox(wikitext);var infobox=that.infobox=content.infobox;that.before=content.before;that.after=content.after;var units=infobox.split('\n');for(var unit in units){var line=units[unit];var role=line.match(/[a-zA-z]+/g);if(role){role=role.join('');var elements=line.split('=');var count=elements[0].match(/[0-9]+/)?elements[0].match(/[0-9]+/)[0]:1;if(role.indexOf('volunteer')!==-1){roleDict.volunteer=count;}if(role in roles&&line.indexOf('=')!==-1){roleDict[role]=count;if(!$('.roleSelect option[value="'+role+'"]').length){$('.roleSelect').append('<option value='+role+'>'+roles[role]+'</option>');}}}}if(!$('.roleSelect option[value="volunteer"]').length){$('.roleSelect').append('<option value="volunteer">'+roles.volunteer+'</option>');}$('.roleSelect')
.chosen({disable_search:true,placeholder_text_single:'Select a role',width:'50%'});$('.roleSelect').on('change',function(){util.removeErrorMessage('joinGadget');if($(this).val()&&$('#devJoinComment').val()){$('.add-join').attr('disabled',false);}else{$('.add-join').attr('disabled',true);}});});};this.Dialog=function(){if(dialog===null){createDialog();}else{dialog.dialog('open');}};this.addjoinment=function(text){var joinComment='\n*'+text+'~~~~'+'\n';var userName=mw.config.get('wgUserName')?mw.config.get('wgUserName'):'{{subst:REVISIONUSER}}';var roleSelected=$('.roleSelect').val();var units=that.infobox.split('\n');var emptyRoleAdded=false;for(var unit in units){if($.trim(units[unit].split('=')[1])===''){var role=units[unit].match(/[a-zA-z]+/);if(role){role=role[0];if(role===roleSelected){units[unit]=$.trim(units[unit])+util.addToInfobox(userName);emptyRoleAdded=true;break;}}}}var modifiedInfoBox=units.join('\n');if(!emptyRoleAdded){var paramCount=roleDict.volunteer?parseInt(roleDict.
volunteer)+1:1;var endIndex=modifiedInfoBox.lastIndexOf('}}');modifiedInfoBox=modifiedInfoBox.slice(0,endIndex)+'|volunteer'+paramCount+'='+util.addToInfobox(userName)+'\n}}';}api.post({action:'edit',title:mw.config.get('wgPageName'),text:that.before+modifiedInfoBox+that.after,summary:'Joined as '+roleSelected,section:0,watchlist:'watch',token:mw.user.tokens.get('csrfToken')}).then(function(){api.get({format:'json',action:'parse',prop:'sections',page:mw.config.get('wgPageName')}).then(function(result){var sections=result.parse.sections;var sectionCount=1;var sectionFound=false;for(var section in sections){if($.trim(sections[section].anchor)===that.config['section-header-read']){sectionFound=true;break;}sectionCount++;}if(sectionFound){api.get({format:'json',action:'parse',prop:'wikitext',page:mw.config.get('wgPageName'),section:sectionCount}).then(function(result){var wikitext=result.parse.wikitext['*'];var joinmentSection=wikitext+joinComment;api.post({action:'edit',title:mw.config.
get('wgPageName'),text:joinmentSection,summary:'Adding my name to the participants section',section:sectionCount,watchlist:'watch',token:mw.user.tokens.get('csrfToken')}).then(function(){console.log('Successfully added to participants');location.reload();util.setFeedbackCookie('joinFeedback');},function(){util.showErrorMessage('joinGadget','save');});});}else{var sectionHeader=that.config['section-header-write'];api.post({action:'edit',title:mw.config.get('wgPageName'),section:'new',summary:sectionHeader,text:$.trim(joinComment),watchlist:'watch',token:mw.user.tokens.get('csrfToken')}).then(function(){util.showErrorMessage('joinGadget','save');});}},function(){util.showErrorMessage('joinGadget','save');});},;};};$(function(){if(!$('.wp-join-button,.wp-endorse-button').length){return;}mw.loader.using(['jquery.ui',
'mediawiki.api','mediawiki.ui','jquery.chosen'],function(){if(mw.config.get('wgPageContentLanguage')==='en'){var endorse=new endorseGadget();var join=new joinGadget();var util=new gadgetUtilities();var api=new mw.Api();var interfaceMessagesFullPath=util.interfaceMessagesPath+'/'+util.userLanguage();var configFullPath=util.configPath+'/'+util.contentLanguage();api.get({action:'query',titles:interfaceMessagesFullPath+'|'+configFullPath,format:'json'}).then(function(data){for(var id in data.query.pages){if(data.query.pages[id].title===util.interfaceMessagesPath+'/'+util.userLanguage()&&id===-1){interfaceMessagesFullPath=util.interfaceMessagesPath+'/en';}if(data.query.pages[id].title===util.configPath+'/'+util.contentLanguage()&&id===-1){configFullPath=util.configPath+'/en';}}var interfaceMessagesUrl='https://meta.wikimedia.org/w/index.php?title='+interfaceMessagesFullPath+'&action=raw';var configUrl='https://meta.wikimedia.org/w/index.php?title='+configFullPath+'&action=raw';$.when($.get(
interfaceMessagesUrl),$.get(configUrl)).then(function(interfaceStr,configStr){var interfaceData=RJSON.parse(interfaceStr[0]),configData=RJSON.parse(configStr[0]);join.config=util.stripWhiteSpace(util.grantType(configData.join));join.interfaceMessages=util.stripWhiteSpace(util.grantType(interfaceData.join));endorse.config=util.stripWhiteSpace(util.grantType(configData.endorse));endorse.interfaceMessages=util.stripWhiteSpace(util.grantType(interfaceData.endorse));join.Dialog();$('.wp-join-button').off();$('.wp-join-button').on('click',function(e){e.preventDefault();join.Dialog();});if(util.checkFeedbackCookie('joinFeedback')){util.showFeedback(join.config,join.interfaceMessages);}endorse.Dialog();$('.wp-endorse-button').off();$('.wp-endorse-button').on('click',;if(!mw.config.get('wgUserName')){util.showErrorMessage('endorseGadget','login');util.showErrorMessage('joinGadget','login');}if(util.checkFeedbackCookie('endorseFeedback')){util.
showFeedback(endorse.config,endorse.interfaceMessages);}});});}else{$('.wp-join-button').hide();$('.wp-endorse-button').hide();}});});
},{"css":[".grantsGadget .ui-state-hover{background:transparent;border-color:#a1a1a1}.grantsGadget.ui-dialog .ui-icon-closethick{background:url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxNi4wLjQsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+DQo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB3aWR0aD0iMTEuMzEzcHgiIGhlaWdodD0iMTEuMzEzcHgiIHZpZXdCb3g9IjAgMCAxMS4zMTMgMTEuMzEzIiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCAxMS4zMTMgMTEuMzEzIiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxwb2x5Z29uIGZpbGw9IiNCMEIxQjEiIHBvaW50cz0iMTEuMzEzLDIuMTIxIDkuMTkyLDAgNS42NTcsMy41MzUgMi4xMjIsMCAwLDIuMTIxIDMuNTM2LDUuNjU2IDAuMDAxLDkuMTkxIDIuMTIyLDExLjMxMyANCgk1LjY1Nyw3Ljc3NyA5LjE5MiwxMS4zMTIgMTEuMzEzLDkuMTkxIDcuNzc4LDUuNjU2ICIvPg0KPC9zdmc+DQo=) no-repeat 50% 50% !important}.grantsGadget .ui-widget-content{background:#EEE}.grantsGadget.ui-dialog .ui-widget-header{border:none;background:#EEE !important;padding-left:11px !important}.grantsGadget.ui-widget-content{background:#EEE;padding:10px 18px;color:#444;border-left:1px solid #ddd;border-top:1px solid #ddd;border-right:1px solid #ddd;border-bottom:3px solid #D0D0D0;border-radius:1px}.grantsGadget .gadgetControls{text-align:right;margin:10px 0px} .grantsGadget .messageDescription{margin:10px 0px}.grantsGadget textarea{outline:0px;padding:14px;resize:none;background-color:white;border:1px solid #DDD;border-radius:1px;margin-bottom:1em}.grantsGadget textarea:focus{box-shadow:inset .45em 0 0 #5088f7}.grantsSpeechBubbleContainer{position:absolute;top:-50px}.grantsSpeechBubble{background:#347BFF;border-radius:3px;display:inline-block;padding:10px;border-bottom-color:#1059E1;border-width:0px 0px 3px 0px;border-style:solid;color:white}.grantsSpeechBubbleArrowDown{width:0px;height:0px;border-left:10px solid transparent;border-right:10px solid transparent;border-top:10px solid #347BFF;position:relative;top:-3px;left:10px}div.grantsHide{display:none}.messageSignature{font-size:9px}.grantsGadget mw-ui-vform{width:100%}.grantsGadget textarea::-webkit-input-placeholder{font-style:italic}.grantsGadget textarea::-moz-placeholder{ font-style:italic}.grantsGadget textarea:-ms-input-placeholder{font-style:italic}  .joinGadget .chzn-container-single .chzn-single{background-image:none;border-radius:1px;box-shadow:none;border:1px solid #ddd;padding:.25em;padding-left:14px}.joinGadget .chzn-container .chzn-results li{padding-left:10px}.joinGadget .chzn-container-active.chzn-with-drop .chzn-single{ background:#F6F3F3;border:1px solid #aaa;padding:.25em;padding-left:14px}.joinGadget .chzn-container .chzn-results .highlighted{background-image:none;background-color:#347bff}.joinGadget .chzn-container-single .chzn-single div b{background-position:0px 5px}.joinGadget .chzn-container-active.chzn-with-drop .chzn-single div b{background-position:-18px 5px}"]}];});
mw.loader.impl(function(){return["ext.gadget.formWizard@1bgny",function($,jQuery,require,module){var namespace=mw.config.get('wgCanonicalNamespace');window.FormsGadget_enabled=(namespace=='Grants'||namespace=='Research'||namespace=='User'||mw.config.get('wgPageName')==='Learning_patterns');var formsGadget={'createDialog':function(){var that=this;var dialogDict={dialogClass:'formsGadget',autoOpen:false,width:'495px',modal:true,closeOnEscape:true,resizable:false,draggable:false,};if($('#formsDialog').length){this.dialog=$('#formsDialog').dialog(dialogDict);}else{this.dialog=$('<div id="formsDialog"></div>').dialog(dialogDict);}$('#formsDialog').append('<div class="loading"></div>');},'dialog':null,'openPanel':'openDialog':function(){if(this.dialog===null){this.createDialog();}else{this.dialog.dialog('open');}},'cleanupDialog':function(){if(this.dialog){this.dialog.dialog('destroy');}this.dialog=null;$('#formsDialog').text('');},'utilities':{'configPath':'Meta:FormWizard/Config','apiUrl':'https://meta.wikimedia.org/w/api.php?callback=?',
'getPageTitle':function(){return true;},'grantType':function(){var grant=mw.config.get('wgTitle').split('/')[0].replace(/ /g,'_');return grant;},'userLanguage':function(){return mw.config.get('wgUserLanguage');},'contentLanguage':'cleanupText':function(text){text=$.trim(text)+' ';var indexOf=text.indexOf('~~~~');if(indexOf==-1){return text;}else{return text.slice(0,indexOf)+text.slice(indexOf+4);}},'stripWhiteSpace':function(dict){for(key in dict){dict[key]=typeof(dict[key])=='object'?this.stripWhiteSpace(dict[key]):$.trim(dict[key]);}return dict;},},'formElement':{'hiddenInfoboxFields':[],'found':false,'timestamp':0,'defaultTextBoxConfig':{'type':'smallTextBox','placeholder':'Enter the text','title':'Textbox','characterLength':100,'mandatory':false,'error-messageLength':'Max length reached','error-notFilled':'Mandatory field','value':'','parent':'','id':null,'comment':''},'elementContainer':'addDescription':function(dict,div){for(key in dict){if(key.indexOf('text')!=-1){this.addText(div,dict[key],'text');delete dict[key];}}return div;},'checkTitle':function(string,exists,titleStem,type){var that=this;var apiUrl=formsGadget.utilities.apiUrl;var title=titleStem+string;var searchDict={'action':'query','format':'json','titles':title,'prop':'imageinfo'};var timestamp=Date.now();console.log('String before ajax',string);return $.getJSON(apiUrl,searchDict,function(data){var query=data['query'];var pages=data['query']['pages'];var pageId=Object.keys(pages);var pageExists=pageId!=-1?true:false;var imageExists=pages[pageId]['imagerepository']?true:false;var value=0;if(type=='image'){value=imageExists;}else{value=pageExists;}if(that.timestamp<timestamp){that.timestamp=timestamp;that.found=!(value^exists);console.log('String ',string,'found ',that.found);}});},'inputList':function(type,list,title,dict,role){var div=
this.elementContainer();div=this.addText(div,title,'title');this.addDescription(dict,div);for(elem in list){var label=document.createElement('div');var input=document.createElement('input');var key=list[elem]['key'];var value=list[elem]['value'];input.type=type;if(type=='number'){input.min=dict['min'];input.max=dict['max'];}input.value=value;input.setAttribute('data-add-to',dict['add-to']);if(role){input.setAttribute('data-role',true);}input.className='inputListItem';input.setAttribute('data-add-to-attribute',key);var descriptionText=key.replace(/_/g,' ');descriptionText=descriptionText.slice(0,1).toUpperCase()+descriptionText.slice(1);var description=document.createElement('span');description.className='inputListItemDescription';description.textContent=descriptionText;label.appendChild(input);label.appendChild(description);div.appendChild(label);}return div;},'createTextBoxConfig':function(defaultConfig,actualConfig){var config={};for(key in defaultConfig){actualConfig[key]=key in
actualConfig?actualConfig[key]:defaultConfig[key];if(key=='mandatory'&&(typeof(actualConfig[key])=='string')){if(actualConfig[key]=='true'){actualConfig[key]=true;}else{actualConfig[key]=false;}}}return actualConfig;},'textBox':function(dict,type,callback,element){var config=this.createTextBoxConfig(this.defaultTextBoxConfig,dict);var className=type=='small'?'smallTextBox':'largeTextBox';var div=this.elementContainer();div=this.addText(div,config['title'],'title');this.addDescription(dict,div);if(type=='large'){var input=document.createElement('textarea');}else{var input=document.createElement('input');}if(dict['visibility']=='hidden'){div.style['display']='none';input.value=dict['value'];}if('page-title'in dict){input.setAttribute('page-title',true);}if(dict['id']){input.id=dict['id'];}input.setAttribute('type','textbox');input.setAttribute('class',className);input.setAttribute('placeholder',config['placeholder']);input.setAttribute('data-character-length',config['characterLength']);
input.setAttribute('data-mandatory',config['mandatory']);input.setAttribute('data-comment',config['comment']);input.setAttribute('data-add-to',config['add-to']);var conditionalAttr=config['add-to']=='infobox'?config['infobox-param']:config['section-header'];input.setAttribute('data-add-to-attribute',conditionalAttr);var that=this;$(input).on('change keyup paste',function(){var inputTextBox=this;var enteredString=$(this).val();if(!enteredString&&!dict['mandatory']){$('#formsDialog [elemType="button"]').trigger('enableButtons');$(inputTextBox).parent().removeClass('entrySatisfying entryNotSatisfying');that.timestamp=Date.now();that.found=true;}else{if('validate'in dict&&enteredString){var exists=dict['validate']=='exists'?1:0;var titleStem='image'in dict?'':that.formDict.config['page-title-stem'];$.when(that.checkTitle(enteredString,exists,titleStem,dict['type'])).then(function(){$(inputTextBox).removeClass('entrySatisfying entryNotSatisfying');$(inputTextBox).addClass(that.found?
'entrySatisfying':'entryNotSatisfying');$(inputTextBox).parent().removeClass('entrySatisfying entryNotSatisfying');$(inputTextBox).parent().addClass(that.found?'entrySatisfying':'entryNotSatisfying');if(that.found){$('#formsDialog [elemType="button"]').trigger('enableButtons');if(typeof(callback)==='function'&&that.found){var apiUrl=formsGadget.utilities.apiUrl;$.getJSON(apiUrl,{'action':'parse','format':'json','text':'[['+enteredString+']]'},function(data){console.log(data['parse']['text']['*']);var src=$('<div>').html(data['parse']['text']['*']).find('img').attr('src');if(src){callback(element,src);}});}}else{$('#formsDialog [elemType="button"]').trigger('disableButtons');}});}}});inputElementWrapper=document.createElement('span');$(inputElementWrapper).addClass('inputElementWrapper');if('validate'in dict){$(inputElementWrapper).addClass('validationContainer');}if(dict['mandatory']){$(inputElementWrapper).addClass('mandatoryContainer');}inputElementWrapper.appendChild(input);div.
appendChild(inputElementWrapper);return div;},'smallTextBox':function(dict,callback,element){return this.textBox(dict,'small',callback,element);},'largeTextBox':'checkboxList':function(dict){var list=dict['choiceList'];var hidden=dict['hidden'];if('hidden'in dict){this.hiddenInfoboxFields=this.hiddenInfoboxFields.concat(dict['hidden']);}return this.inputList('checkbox',list,dict['title'],dict);},'addText':function(container,text,type){var textHolder=$('<p>');textHolder.text(text);if(type=='title'){textHolder.addClass('title');}else if(type=='text'){textHolder.addClass('text');}else{textHolder.addClass(type);}container.appendChild(textHolder[0]);return container;},'text':function(dict){var textHolder=$('<p>');return textHolder.text(dict['string'])[0];},'stepperList':function(dict){var list=dict['choiceList'];if('hidden'in dict){this.hiddenInfoboxFields=this.hiddenInfoboxFields.concat(dict['hidden']);}
dict['min']=0;if(!('max'in dict)){dict['max']=9;}return this.inputList('number',list,dict['title'],dict,true);},'dropdownList':function(dict){var div=this.elementContainer();div=this.addText(div,dict['title'],'title');this.addDescription(dict,div);var values=dict['values'];var select=document.createElement('select');select.setAttribute('type','textbox');select.setAttribute('class','dropdown');select.setAttribute('data-placeholder',dict['placeholder']);select.setAttribute('data-add-to',dict['add-to']);select.setAttribute('data-add-to-attribute',dict['infobox-param']);var option;for(elem in values){option=$('<option>').attr('value',values[elem]).text(values[elem]);select.appendChild(option[0]);}div.appendChild(select);return div;},'link':function(dict){var link=document.createElement('a');link.href='href'in dict?dict['href']:'https://commons.wikimedia.org/wiki/Main_Page';link.target='_blank';var innerText='link'in dict?dict['link']:'Search Wikimedia Commons for an image';$(link).text(
innerText);return link;},'image':function(dict){var url=dict['url'];var text=dict['title'];dict['add-to']='infobox';dict['infobox-param']='image';dict['validate']='exists';dict['placeholder']='placeholder'in dict?dict['placeholder']:'File:Test.png';var div=this.elementContainer();this.addText(div,dict['title'],'title');this.addDescription(dict,div);var img=document.createElement('img');img.src=url;dict['title']='imageTitleBox'in dict?dict['imageTitleBox']:'Enter the file name';dict['image']=true;var textbox=this.smallTextBox(dict,img);var description=document.createTextNode(text);div.appendChild(img);div.appendChild(textbox);var commonsLink=this.link(dict);div.appendChild(commonsLink);return div;},'button':function(type,text){var a=document.createElement('input');a.type='submit';a.setAttribute('elemType','button');if(type=='cancel'||type=='back'){a.className='mw-ui-button cancel mw-ui-quiet';}else{a.className='mw-ui-button mw-ui-constructive';}a.value=
text;$(a).on('disableButtons',function(){$(this).attr('disabled',true);});$(a).on('enableButtons',;return a;},'cancelButton':function(dict){var button=this.button('cancel',dict['title']);button.onclick=function(){formsGadget.dialog.dialog('close');};return button;},'doneButton':function(dict){var that=this;var button=this.button('done',dict['title']);button.onclick=function(){that.validateForm();};return button;},'nextButton':function(dict){var button=this.button('next',dict['title']);var that=this;button.onclick=function(){$('#formsDialog [step]').hide();$('#formsDialog'+' #'+dict['step']).next().show();};return button;},'backButton':function(dict){var button=this.button('back',dict['title']);var that=this;button.onclick=function(){$('#formsDialog [step]').hide();$('#formsDialog'+' #'+dict['step']).prev().show();};return button;},'validateForm':function(){var counter=0;var firstElem;$('#formsDialog [data-mandatory="true"]').each(function(){
var elem=$(this);if(!elem.val()){if(counter==0){firstElem=elem;}counter++;elem.addClass('mandatoryInput');}});if(firstElem){$('#formsDialog [step]').hide();while(true){if(firstElem.attr('step')){firstElem.show();break;}firstElem=firstElem.parent();}}else{if(formsGadget.type=='create'){this.createWikiPage();}else{this.modifyWikiPage();}}},'infoboxString':'','remainingSectionString':'','extractInfobox':function(markup,infoboxTemplate){var startIndex=markup.indexOf('{{'+infoboxTemplate);var counter=0;var endIndex=0;for(i=startIndex;i<markup.length;i++){if(markup[i]=='}'&&markup[i+1]=='}'){counter++;}if(markup[i]=='{'&&markup[i+1]=='{'){counter--;}if(counter==0){var endIndex=i+2;break;}}if(counter!=0){return'';}var infobox={'infobox':markup.slice(startIndex,endIndex),'before':markup.slice(0,startIndex),'after':markup.slice(endIndex),};return infobox;},'infoboxObjectify':function(infoboxString){var paramRe=/( )*\|( )*[A-Za-z0-9_]+( )*=/gi;var units=infoboxString.split('\n');var infobox=[];
var infoboxParams={};var parts,line,param,value;for(unit in units){line=units[unit];if(line.search(paramRe)!=-1){parts=line.split('=');param=$.trim(parts[0].replace('|',''));value=$.trim(parts[1]);infobox.push({'param':param,'value':value});}else{infobox.push($.trim(line));}}return infobox;},'modifyInfoboxParam':function(infobox,param,newValue){var flag=true;for(elem in infobox){if(typeof(infobox[elem])=='object'&&infobox[elem]['param']==param){infobox[elem]['value']=newValue;flag=false;}}if(flag){infobox.splice(-1,0,{'param':param,'value':newValue});}return infobox;},'stringifyInfobox':function(infobox){var infoboxString='';for(elem in infobox){if(typeof(infobox[elem])=='object'){if(infobox[elem]['value']){infoboxString=infoboxString+'|'+infobox[elem]['param']+'='+infobox[elem]['value']+'\n';}else{infoboxString=infoboxString+'|'+infobox[elem]['param']+'='+'\n';}}else{infoboxString=infoboxString+infobox[elem]+'\n';}}return infoboxString;},'createEditSummary':function(title,subcomment){
var summary='';var formsConfig=formsGadget.formDict['config'];if(formsConfig['edit-comment-prefix']){summary=formsConfig['edit-comment-prefix']+' ';}else{summary=formsConfig['edit-comment-default']+' ';}if(subcomment){summary=summary+title+' ('+subcomment+') ';}else{summary=summary+title+' ';}if(formsConfig['edit-comment-suffix']){summary=summary+formsConfig['edit-comment-suffix'];}return summary;},'modifyWikiPage':function(){var that=this;var infobox='';var infoboxString='';var sections='';var api=new mw.Api();var roots=this.wikiSectionTree.roots;for(elem in roots){console.log('---------');this.wikiSectionTree.traverse([roots[elem]],1,function(id){var elem=$('#formsDialog #'+id);value=elem.val()?elem.val():'';var heading=elem.attr('data-add-to-attribute');return{'heading':heading,'value':value};});}$('#formsDialog [elemType="button"]').trigger('disableButtons');var title=mw.config.get('wgPageName').replace('/Toolkit','');var gettingInfobox=api.get({'format':'json','action':'query',
'prop':'revisions','rvprop':'content','rvsection':0,'titles':title,}).then(function(result){var pages=result.query.pages;var key=Object.keys(result.query.pages)[0];var content=pages[key]['revisions'][0]['*'];var infoboxTemplate=formsGadget.formDict.config['infobox']?formsGadget.formDict.config['infobox']:'Probox/Idealab';var elements=that.extractInfobox(content,infoboxTemplate);var infobox=that.infoboxObjectify(elements['infobox']);var before=elements['before'];var after=elements['after'];$('#formsDialog [data-add-to]').each(function(index,elem){var elem=$(elem);if(elem.attr('data-add-to')=='infobox'){if(elem.attr('type')=='checkbox'){if(elem.is(':checked')){infobox=that.modifyInfoboxParam(infobox,elem.attr('data-add-to-attribute'),elem.val());}else{infobox=that.modifyInfoboxParam(infobox,elem.attr('data-add-to-attribute'),null);}}else if(elem.attr('data-role')){for(var i=0;i<elem.val();i++){infobox=that.modifyInfoboxParam(infobox,elem.attr('data-add-to-attribute')+(i+1),null);}}else{
infobox=that.modifyInfoboxParam(infobox,elem.attr('data-add-to-attribute'),elem.val());}}});var hiddenFields=that.hiddenInfoboxFields;for(entry in hiddenFields){infobox=infobox.push({'param':hiddenFields[entry]['key'],'value':hiddenFields[entry]['value']});}var modifiedSection=before+$.trim(that.stringifyInfobox(infobox))+after;var formsConfig=formsGadget.formDict['config'];api.post({'action':'edit','title':title,'text':modifiedSection,'summary':that.createEditSummary(title,'editing infobox parameters'),'section':0,'watchlist':'watch','token':mw.user.tokens.get('csrfToken')}).then(function(){var newSections='\n'+that.wikiSectionTree.sections;api.post({'action':'edit','title':title,'summary':that.createEditSummary(title,'editing section'),'appendtext':newSections,'watchlist':'watch','token':mw.user.tokens.get('csrfToken')}).then(function(){console.log('Successfully Added new sections & modified the infobox');var postEditMessage=formsGadget.formDict['config']['post-edit'];formsGadget.
dialog.dialog('close');mw.cookie.set('formsGadgetNotify',postEditMessage);window.location.href=location.origin+'/wiki/'+title;});});});},'createWikiPage':function(){var that=this;var infobox='';var page='';var api=new mw.Api();var pageTitle=$('#formsDialog [page-title]').val();var roots=this.wikiSectionTree.roots;for(elem in roots){console.log('---------');this.wikiSectionTree.traverse([roots[elem]],1,function(id){var elem=$('#formsDialog #'+id);value=elem.val()?elem.val():'';var heading=elem.attr('data-add-to-attribute');var comment=elem.attr('data-comment');return{'heading':heading,'value':value,'comment':comment};});}$('#formsDialog [data-add-to]').each(function(index,elem){var elem=$(elem);if(elem.attr('data-add-to')=='section'){}else{if(elem.attr('data-role')){for(var i=0;i<elem.val();i++){infobox=infobox+'|'+elem.attr('data-add-to-attribute')+(i+1)+'=\n';}}else if(elem.attr('type')=='checkbox'){if(elem.is(':checked')){infobox=infobox+'|'+elem.attr('data-add-to-attribute')+'='+
elem.val()+'\n';}else{infobox=infobox+'|'+elem.attr('data-add-to-attribute')+'=\n';}}else if(elem.attr('data-add-to-attribute')=='image'){var image=elem.val()?elem.val():elem.attr('placeholder');infobox=infobox+'|'+elem.attr('data-add-to-attribute')+'='+image+'\n';}else{infobox=infobox+'|'+elem.attr('data-add-to-attribute')+'='+elem.val()+'\n';}}});var hiddenFields=this.hiddenInfoboxFields;for(entry in hiddenFields){infobox=infobox+'|'+hiddenFields[entry]['key']+'='+hiddenFields[entry]['value']+'\n';}infobox=infobox+'|'+'timestamp = ~~~~~'+'\n';infobox=infobox+'|'+'creator = '+mw.user.getName()+'\n';var probox=this.formDict.config['infobox']?this.formDict.config['infobox']:'Probox/Idealab';infobox='{{'+probox+'\n'+infobox+'}} \n';page=infobox+this.wikiSectionTree.sections;var title=formsGadget.formDict['config']['page-title-stem']+pageTitle;$('#formsDialog [elemType="button"]').trigger('disableButtons');api.post({'action':'edit','title':title,'summary':that.createEditSummary(title),
'text':page,'watchlist':'watch',token:mw.user.tokens.get('csrfToken')}).then(function(){var formsConfig=formsGadget.formDict['config'];var toolkit=formsConfig['toolkit-name'];var toolkitContent='{{'+formsConfig['toolkit-template']+'}}';var createToolkit=true;if(toolkit&&toolkitContent){var toolkitTitle=title+'/'+toolkit;var summary='Adding the toolkit for '+title;createToolkit=api.post({'action':'edit','title':toolkitTitle,'summary':summary,'text':toolkitContent,'watchlist':'watch',token:mw.user.tokens.get('csrfToken')});}console.log('Successfully created new page');$.when(createToolkit).then(function(){formsGadget.dialog.dialog('close');var postEditMessage=formsGadget.formDict['config']['post-edit'];mw.cookie.set('formsGadgetNotify',postEditMessage);window.location.href=location.origin+'/wiki/'+title;},function(){$('#formsDialog [elemType="button"]').trigger('enableButtons');});},;console.log(title,page);}},
'createForm':function(formDict){formDict.config['page-title-stem']=formDict.config['namespace']+formDict.config['portal-page'];this.formDict=formDict;this.formElement.formDict=formDict;this.formElement.wikiSectionTree=this.wikiSectionTree;var dialogInternal=document.createElement('div');if(!mw.user.getName()){var errorMessage=formDict['config']['error-not-logged-in'];var errorDiv=document.createElement('div');errorDiv.className='mw-ui-vform';this.formElement.addText(errorDiv,errorMessage,'error');dialogInternal.appendChild(errorDiv);}var counter=0;for(step in formDict){if(step!='config'){counter++;var stepDict=formDict[step];var panel=document.createElement('div');panel.id=step;if(counter!=1){panel.style['display']='none';}panel.setAttribute('step',step);for(elem in stepDict){elemDict=stepDict[elem];elemDict['elem']=elem;elemDict['step']=step;elemDict['id']=elem;panel.appendChild(this.formElement[elemDict.type](elemDict));if(elemDict['add-to']=='section'){var parent='parent'in elemDict
?elemDict['parent']:null;var node=elem;if(parent){this.wikiSectionTree.addLink(parent,node);}else{this.wikiSectionTree.addLink(node);}}}dialogInternal.appendChild(panel);}}$('#formsDialog').append(dialogInternal);$('.formsGadget .dropdown').chosen({disable_search:true,width:'50%',});return true;},'Tree':function(){var rootList={};var nodeList={};this.sections='';this.roots=rootList;var node=var getNode=function(id){if(id in nodeList){return nodeList[id];}else{var Node=new node(null,null,id);nodeList[id]=Node;rootList[id]=Node;return Node;}};this.addLink=function(startId,endId){if(endId){var startNode=getNode(startId);var endNode=getNode(endId);endNode.parent=startNode;if(startNode.child){startNode.child.push(endNode);}else{startNode.child=[endNode];}delete rootList[endNode.id];}else{getNode(startId);}};var sectionLevel=function(indent){var string='';for(var i=0;i<indent;i++){string=string+'=';}return string;};
this.traverse=function(rootList,level,callback){if(!rootList){return;}level++;var wikiSectionHeaderMarkup=sectionLevel(level);for(elem in rootList){var root=rootList[elem];var sectionValues=callback(root.id);var section=wikiSectionHeaderMarkup+sectionValues['heading']+wikiSectionHeaderMarkup+'\n';var section=section+(sectionValues['comment']?sectionValues['comment']+'\n':'')+sectionValues['value']+'\n';this.sections=this.sections+section;root=root.child;this.traverse(root,level,callback);}};}};if(window.FormsGadget_enabled){$.when(mw.loader.using(['mediawiki.api','mediawiki.cookie','mediawiki.ui','mediawiki.user','jquery.chosen','jquery.ui']),$.ready).then(function(){var api=new mw.Api();var utility=formsGadget.utilities;var postEditMessage=mw.cookie.get('formsGadgetNotify');if(postEditMessage){mw.cookie.set('formsGadgetNotify',null);mw.notify(postEditMessage,{autoHide:false});}$('.wp-formsGadget').click(function(e){e.preventDefault();formsGadgetType=$(this).attr('data-type')||'Idea';
formsGadgetMode=$(this).attr('data-mode')||'create';formsGadget.cleanupDialog();formsGadget.openDialog();formsGadget.openPanel();$('#formsDialog .loading').show();var configFullPath=utility.configPath+'/'+formsGadgetType+'/'+utility.userLanguage();api.get({'action':'query','titles':configFullPath,'format':'json'}).then(function(data){for(id in data.query.pages){if(id==-1){configFullPath=utility.configPath+'/'+formsGadgetType+'/en';}}var configUrl='https://meta.wikimedia.org/w/index.php?title='+encodeURIComponent(configFullPath)+'&action=raw';$.when(jQuery.get(configUrl)).then(function(dataStr){var data=RJSON.parse(dataStr);var config=utility.stripWhiteSpace(data[formsGadgetMode]);formsGadget['formDict']=config;$('.formsGadget .ui-dialog-title').text(config.config['dialog-title']);formsGadget['wikiSectionTree']=new formsGadget.Tree();formsGadget.openDialog();formsGadget.createForm(config);formsGadget.type=formsGadgetMode;formsGadget.openDialog();$('#formsDialog .loading').hide();});});}
);});}
},{"css":[".formsGadget .ui-state-hover{background:transparent;border-color:#a1a1a1}.formsGadget.ui-dialog .ui-icon-closethick{background:url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxNi4wLjQsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+DQo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB3aWR0aD0iMTEuMzEzcHgiIGhlaWdodD0iMTEuMzEzcHgiIHZpZXdCb3g9IjAgMCAxMS4zMTMgMTEuMzEzIiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCAxMS4zMTMgMTEuMzEzIiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxwb2x5Z29uIGZpbGw9IiNCMEIxQjEiIHBvaW50cz0iMTEuMzEzLDIuMTIxIDkuMTkyLDAgNS42NTcsMy41MzUgMi4xMjIsMCAwLDIuMTIxIDMuNTM2LDUuNjU2IDAuMDAxLDkuMTkxIDIuMTIyLDExLjMxMyANCgk1LjY1Nyw3Ljc3NyA5LjE5MiwxMS4zMTIgMTEuMzEzLDkuMTkxIDcuNzc4LDUuNjU2ICIvPg0KPC9zdmc+DQo=) no-repeat 50% 50% !important}.formsGadget .ui-widget-content{background:#EEE}.formsGadget.ui-dialog .ui-widget-header{border:none;background:#EEE !important;padding-left:11px !important;margin-top:25px}.formsGadget.ui-widget-content{background:#EEE;padding:10px 18px;color:#444;border-left:1px solid #ddd;border-top:1px solid #ddd;border-right:1px solid #ddd;border-bottom:3px solid #D0D0D0;border-radius:1px}.formsGadget .gadgetControls{text-align:right;margin:10px 0px} .formsGadget .messageDescription{margin:10px 0px}.formsGadget textarea,.formsGadget input[type=textbox],.formsGadget input[type=number]{outline:0px;padding:14px 7px;resize:none;background-color:white;border:1px solid #DDD;border-radius:1px;margin-bottom:1em}.formsGadget textarea:focus,.formsGadget input[type=textbox]:focus{box-shadow:inset .45em 0 0 #5088f7}div.grantsHide{display:none}.formsGadget mw-ui-vform{width:100%}.formsGadget textarea::-webkit-input-placeholder{font-style:italic}.formsGadget textarea::-moz-placeholder{ font-style:italic}.formsGadget textarea:-ms-input-placeholder{font-style:italic}.formsGadget input::-webkit-input-placeholder{font-style:italic}.formsGadget input::-moz-placeholder{ font-style:italic}.formsGadget input:-ms-input-placeholder{font-style:italic}.formsGadget input.entryNotSatisfying:focus{box-shadow:inset .45em 0 0 #D11D13}.formsGadget input.entrySatisfying:focus{box-shadow:inset .45em 0 0 #5088f7}.formsGadget .title{font-weight:bold}.formsGadget .text{line-height:15px;margin:6px 0px}.formsGadget .elementContainer{padding:7px 0px}.formsGadget .inputListItem{width:50px;margin-right:30px}.formsGadget input[type=textbox],.formsGadget input[type=number]{padding:7px}.formsGadget input[type=number]{text-align:center}.formsGadget .inputListItemDescription{ display:inline-block}.formsGadget .ui-widget-content a{color:#0b0080}.formsGadget .ui-widget-content a span{color:#444444}.formsGadget .validationContainer.entrySatisfying:after{content:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAICAYAAAAvOAWIAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAuIwAALiMBeKU/dgAAAAd0SU1FB94HFgU5GtaftYcAAACqSURBVBjTfZA7SkMBFAXPi5UfcAHBwl6wt7HOfnQZgr0bSGdt6x7ERlDEyiIgCPLAM2NhIhE/U94Lc5k75A/UDMMQYDvJRZK3/Ie62XbeVuAm6q56BAT4srbdaXsFCNwC0wAPwKt6vGbcAuZ+8qQerBYny+ELMEsS4BJQfQb2V9eibgBnwLu6UK/b2vax7Z76PWQcxwlwvrQJ3KuHP4rXoibqKXAHTH/7zge2aLmJza+PXAAAAABJRU5ErkJggg==);padding:7px 8px 7px 8px;background-color:#347BFF;border:1px solid #DDD;border-width:1px 1px 1px 0px}.formsGadget .validationContainer.entryNotSatisfying:after{content:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAALCAYAAACprHcmAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAuIwAALiMBeKU/dgAAAAd0SU1FB94HFgU0Ikszc1QAAADOSURBVBjTbZAhTkNBFEXvT7+gCRLDLkgTUtUF1NSxnErkl4gmX4DuQuoKC/iWYKqqyzmYGZgAN3kZc/LmnRv1BhjULdDnV4CV+qIuow6qgMAIXFVQ3QDvgOoUYFth9aLuysa1+mEJcIjaq2MBa/bqVBYIHNW7etdc3TU/tHlV7/OPzL6lgJO6+AOqa3VqwDpP6rwFN62MemrOuZSW+pm6SvKc5FZNkrckD13XfSZZJJmV9zql8JpjlSnSYyN9DrAEJuDwXc+PcK8OwBl4/AKbp0zxmA5MdAAAAABJRU5ErkJggg==);padding:7px 8px 7px 8px;background-color:#D11D13;border:1px solid #DDD;border-width:1px 1px 1px 0px}.formsGadget .inputElementWrapper{position:relative}.formsGadget .mandatoryContainer:before{position:absolute;left:-6px;content:\"*\";color:#D11D13}.formsGadget img{height:100px}.formsGadget input[type=textbox]{margin:0px 0px 10px 0px;width:90%}.formsGadget input[type=submit]{margin-right:.5em;float:right} .formsGadget .chzn-container-single .chzn-single{background-image:none;border-radius:1px;box-shadow:none;border:1px solid #ddd;padding:.25em;padding-left:14px}.formsGadget .chzn-container .chzn-results li{padding-left:10px}.formsGadget .chzn-container-active.chzn-with-drop .chzn-single{ background:#F6F3F3;border:1px solid #aaa;padding:.25em;padding-left:14px}.formsGadget .chzn-container .chzn-results .highlighted{background-image:none;background-color:#347bff}.formsGadget .chzn-container-single .chzn-single div b{background-position:0px 5px}.formsGadget .chzn-container-active.chzn-with-drop .chzn-single div b{background-position:-18px 5px} .formsGadget .loading{background:url(data:image/gif;base64,R0lGODlhgAAPAPEAAP///6fX+eXy/KfX+SH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAgAAPAAACo5QvoIC33NKKUtF3Z8RbN/55CEiNonMaJGp1bfiaMQvBtXzTpZuradUDZmY+opA3DK6KwaQTCbU9pVHc1LrDUrfarq765Ya9u+VRzLyO12lwG10yy39zY11Jz9t/6jf5/HfXB8hGWKaHt6eYyDgo6BaH6CgJ+QhnmWWoiVnI6ddJmbkZGkgKujhplNpYafr5OooqGst66Uq7OpjbKmvbW/p7UAAAIfkECQoAAAAsAAAAAIAADwAAArCcP6Ag7bLYa3HSZSG2le/Zgd8TkqODHKWzXkrWaq83i7V5s6cr2f2TMsSGO9lPl+PBisSkcekMJphUZ/OopGGfWug2Jr16x92yj3w247bh6teNXseRbyvc0rbr6/x5Ng0op4YSJDb4JxhI58eliEiYYujYmFi5eEh5OZnXhylp+RiaKQpWeDf5qQk6yprawMno2nq6KlsaSauqS5rLu8cI69k7+ytcvGl6XDtsyzxcAAAh+QQJCgAAACwAAAAAgAAPAAACvpw/oIC3IKIUb8pq6cpacWyBk3htGRk1xqMmZviOcemdc4R2kF3DvfyTtFiqnPGm+yCPQdzy2RQMF9Moc+fDArU0rtMK9SYzVUYxrASrxdc0G00+K8ruOu+9tmf1W06ZfsfXJfiFZ0g4ZvEndxjouPfYFzk4mcIICJkpqUnJWYiYs9jQVpm4edqJ+lkqikDqaZoquwr7OtHqAFerqxpL2xt6yQjKO+t7bGuMu1L8a5zsHI2MtOySVwo9fb0bVQAAIfkECQoAAAAsAAAAAIAADwAAAsucP6CAt9zSErSKZyvOd/KdgZaoeaFpRZKiPi1aKlwnfzBF4jcNzDk/e7EiLuLuhzwqayfmaNnjCCGNYhXqw9qcsWjT++TqxIKp2UhOprXf7PoNrpyvQ3p8fAdu82o+O5w3h2A1+Nfl5geHuLgXhEZVWBeZSMnY1oh5qZnyKOhgiGcJKHqYOSrVmWpHGmpauvl6CkvhaUD4qejaOqvH2+doV7tSqdsrexybvMsZrDrJaqwcvSz9i9qM/Vxs7Qs6/S18a+vNjUx9/v1TAAAh+QQJCgAAACwAAAAAgAAPAAAC0Zw/oIC33NKKUomLxct4c718oPV5nJmhGPWwU9TCYTmfdXp3+aXy+wgQuRRDSCN2/PWAoqVTCSVxilQZ0RqkSXFbXdf3ZWqztnA1eUUbEc9wm8yFe+VguniKPbNf6mbU/ubn9ieUZ6hWJAhIOKbo2Pih58C3l1a5OJiJuflYZidpgHSZCOnZGXc6l3oBWrE2aQnLWYpKq2pbV4h4OIq1eldrigt8i7d73Ns3HLjMKGycHC1L+hxsXXydO9wqOu3brPnLXL3C640sK+6cTaxNflEAACH5BAkKAAAALAAAAACAAA8AAALVnD+ggLfc0opS0SeyFnjn7oGbqJHf4mXXFD2r1bKNyaEpjduhPvLaC5nJEK4YTKhI1ZI334m5g/akJacAiDUGiUOHNUd9ApTgcTN81WaRW++Riy6Tv/S4dQ1vG4ps4NwOaBYlOEVYhYbnplexyJf3ZygGOXkWuWSZuNel+aboV0k5GFo4+qN22of6CMoq2kr6apo6m5fJWCoZm+vKu2Hr6KmqiHtJLKebRhuszNlYZ3ncewh9J9z8u3mLHA0rvetrzYjd2Wz8bB6oNO5MLq6FTp2+bVUAACH5BAkKAAAALAAAAACAAA8AAALanD+ggLfc0opS0XeX2Fy8zn2gp40ieHaZFWHt9LKNO5eo3aUhvisj6RutIDUZgnaEFYnJ4M2Z4210UykQ8BtqY0yHstk1UK+/sdk63i7VYLYX2sOa0HR41S5wi7/vcMWP1FdWJ/dUGIWXxqX3xxi4l0g4GEl5yOHIBwmY2cg1aXkHSjZXmbV4uoba5kkqelbaapo6u0rbN/SZG7trKFv7e6savKTby4voaoVpNAysiXscV4w8fSn8fN1pq1kd2j1qDLK8yYy9/ff9mgwrnv2o7QwvGO1ND049UgAAIfkECQoAAAAsAAAAAIAADwAAAticP6CAt9zSilLRd2d8onvBfV0okp/pZdamNRi7ui3yyoo4Ljio42h+w6kgNiJt5kAaasdYE7D78YKlXpX6GWphxqTT210qK1Cf9XT2SKXbYvv5Bg+jaWD5ekdjU9y4+PsXRuZHRrdnZ5inVidAyCTXF+nGlVhpdjil2OE49hjICVh4qZlpibcDKug5KAlHOWqqR8rWCjl564oLFruIucaYGlz7+XoKe2wsIqxLzMxaxIuILIs6/JyLbZsdGF063Uu6vH2tXc79LZ1MLWS96t4JH/rryzhPWgAAIfkECQoAAAAsAAAAAIAADwAAAtWcP6CAt9zSilLRd2fEe4kPCk8IjqTonZnVsQ33arGLwLV8Kyeqnyb5C60gM2LO6MAlaUukwdbcBUspYFXYcla00KfSywRzv1vpldqzprHFoTv7bsOz5jUaUMer5vL+Mf7Hd5RH6HP2AdiUKLa41Tj1Acmjp0bJFuinKKiZyUhnaBd5OLnzSNbluOnZWQZqeVdIYhqWyop6ezoquTs6O0aLC5wrHErqGnvJibms3LzKLIYMe7xnO/yL7TskLVosqa1aCy3u3FrJbSwbHpy9fr1NfR4fUgAAIfkECQoAAAAsAAAAAIAADwAAAsqcP6CAt9zSilLRd2fEW7cnhKIAjmFpZla3fh7CuS38OrUR04p5Ljzp46kgMqLOaJslkbhbhfkc/lAjqmiIZUFzy2zRe5wGTdYQuKs9N5XrrZPbFu94ZYE6ms5/9cd7/T824vdGyIa3h9inJQfA+DNoCHeomIhWGUcXKFIH6RZZ6Bna6Zg5l8JnSamayto2WtoI+4jqSjvZelt7+URKpmlmKykM2vnqa1r1axdMzPz5LLooO326Owxd7Bzam4x8pZ1t3Szu3VMOdF4AACH5BAkKAAAALAAAAACAAA8AAAK/nD+ggLfc0opS0XdnxFs3/i3CSApPSWZWt4YtAsKe/DqzXRsxDqDj6VNBXENakSdMso66WzNX6fmAKCXRasQil9onM+oziYLc8tWcRW/PbGOYWupG5Tsv3TlXe9/jqj7ftpYWaPdXBzbVF2eId+jYCAn1KKlIApfCSKn5NckZ6bnJpxB2t1kKinoqJCrlRwg4GCs4W/jayUqamaqryruES2b72StsqgvsKlurDEvbvOx8mzgazNxJbD18PN1aUgAAIfkECQoAAAAsAAAAAIAADwAAArKcP6CAt9zSilLRd2fEWzf+ecgjlKaQWZ0asqPowAb4urE9yxXUAqeZ4tWEN2IOtwsqV8YkM/grLXvTYbV4PTZpWGYU9QxTxVZyd4wu975ZZ/qsjsPn2jYpatdx62b+2y8HWMTW5xZoSIcouKjYePeTh7TnqFcpabmFSfhHeemZ+RkJOrp5OHmKKapa+Hiyyokaypo6q1CaGDv6akoLu3DLmLuL28v7CdypW6vsK9vsE1UAACH5BAkKAAAALAAAAACAAA8AAAKjnD+ggLfc0opS0XdnxFs3/nkISI2icxokanVt+JoxC8G1fNOlm6tp1QNmZj6ikDcMrorBpBMJtT2lUdzUusNSt9qurvrlhr275VHMvI7XaXAbXTLLf3NjXUnP23/qN/n8d9cHyEZYpoe3p5jIOCjoFofoKAn5CGeZZaiJWcjp10mZuRkaSAq6OGmU2lhp+vk6iioay3rpSrs6mNsqa9tb+ntQAAA7AAAAAAAAAAAA);width:128px;height:15px;margin:auto}"]}];});
mw.loader.impl(function(){return["ext.gadget.relaxedjson@1ju33",function($,jQuery,require,module){(function(){"use strict";function some(array,f){var acc=false;for(var i=0;i<array.length;i++){acc=f(array[i],i,array);if(acc){return acc;}}return acc;}function makeLexer(tokenSpecs){return function(contents){var tokens=[];var line=1;function findToken(){return some(tokenSpecs,function(tokenSpec){var m=tokenSpec.re.exec(contents);if(m){var raw=m[0];contents=contents.slice(raw.length);return{raw:raw,matched:tokenSpec.f(m,line),};}});}while(contents!==""){var matched=findToken();if(!matched){var err=new SyntaxError("Unexpected character: "+contents[0]+"; input: "+contents.substr(0,100));err.line=line;throw err;}matched.matched.line=line;line+=matched.raw.replace(/[^\n]/g,"").length;tokens.push(matched.matched);}return tokens;};}function fStringSingle(m){var content=m[1].replace(/([^'\\]|\\['bnrtf\\]|\\u[0-9a-fA-F]{4})/g,function(mm){if(mm==="\""){return"\\\"";}else if(mm==="\\'"){return"'";}else{return mm;}});return{type:"string",match:"\""+content+"\"",value:JSON.parse("\""+content+"\"")
,};}function fStringDouble(m){return{type:"string",match:m[0],value:JSON.parse(m[0]),};}function fIdentifier(m){return{type:"string",value:m[0],match:"\""+m[0].replace(/./g,+"\"",};}function fComment(m){return{type:" ",match:m[0].replace(/./g,};}function fNumber(m){return{type:"number",match:m[0],value:parseFloat(m[0]),};}function fKeyword(m){var value;switch(m[1]){case"null":value=null;break;case"true":value=true;break;case"false":value=false;break;}return{type:"atom",match:m[0],value:value,};}function makeTokenSpecs(relaxed){function f(type){return }var ret=[{re:/^\s+/,f:f(" ")},{re:/^\{/,f:f("{")},{re:/^\}/,f:f("}")},{re:/^\[/,f:f("[")},{re:/^\]/,f:f("]")},{re:/^,/,f:f(",")},{re:/^:/,f:f(":")},{re:/^(true|false|null)/,f:fKeyword},{re:/^\-?\d+(\.\d+)?([eE][+-]?\d+)?/,f:fNumber},{re:/^"([^"\\]|\\["bnrtf\\\/]|\\u[0-9a-fA-F]{4})*"/,f:fStringDouble},];if(relaxed){ret
=ret.concat([{re:/^'(([^'\\]|\\['bnrtf\\\/]|\\u[0-9a-fA-F]{4})*)'/,f:fStringSingle},{re:/^\/\/.*?(?:\r\n|\r|\n)/,f:fComment},{re:/^\/\*[\s\S]*?\*\//,f:fComment},{re:/^[$a-zA-Z0-9_\-+\.\*\?!\|&%\^\/#\\]+/,f:fIdentifier},]);}return ret;}var lexer=makeLexer(makeTokenSpecs(true));var strictLexer=makeLexer(makeTokenSpecs(false));function previousNWSToken(tokens,index){for(;index>=0;index--){if(tokens[index].type!==" "){return index;}}}function stripTrailingComma(tokens){var res=[];tokens.forEach(function(token,index){if(token.type==="]"||token.type==="}"){var commaI=previousNWSToken(res,index-1);if(commaI&&res[commaI].type===","){var preCommaI=previousNWSToken(res,commaI-1);if(preCommaI&&res[preCommaI].type!=="["&&res[preCommaI].type!=="{"){res[commaI]={type:" ",match:" ",line:tokens[commaI].line,};}}}res.push(token);});return res;}function transform(text){var tokens=lexer(text);tokens=stripTrailingComma(tokens);return tokens.reduce(function(str,token){return str+token.match;},"");}function
popToken(tokens,state){var token=tokens[state.pos];state.pos+=1;if(!token){var line=tokens.length!==0?tokens[tokens.length-1].line:1;return{type:"eof",line:line};}return token;}function strToken(token){switch(token.type){case"atom":case"string":case"number":return token.type+" "+token.match;case"eof":return"end-of-file";default:return"'"+token.type+"'";}}function skipColon(tokens,state){var colon=popToken(tokens,state);if(colon.type!==":"){var message="Unexpected token: "+strToken(colon)+", expected ':'";if(state.tolerant){state.warnings.push({message:message,line:colon.line,});state.pos-=1;}else{var err=new SyntaxError(message);err.line=colon.line;throw err;}}}function skipPunctuation(tokens,state,valid){var punctuation=[",",":","]","}"];var token=popToken(tokens,state);while(true){if(valid&&valid.indexOf(token.type)!==-1){return token;}else if(token.type==="eof"){return token;}else if(punctuation.indexOf(token.type)!==-1){var message="Unexpected token: "+strToken(token)+
", expected '[', '{', number, string or atom";if(state.tolerant){state.warnings.push({message:message,line:token.line,});token=popToken(tokens,state);}else{var err=new SyntaxError(message);err.line=token.line;throw err;}}else{return token;}}}function raiseError(state,token,message){if(state.tolerant){state.warnings.push({message:message,line:token.line,});}else{var err=new SyntaxError(message);err.line=token.line;throw err;}}function raiseUnexpected(state,token,expected){raiseError(state,token,"Unexpected token: "+strToken(token)+", expected "+expected);}function checkDuplicates(state,obj,token){var key=token.value;if(state.duplicate&&Object.prototype.hasOwnProperty.call(obj,key)){raiseError(state,token,"Duplicate key: "+key);}}function appendPair(state,obj,key,value){value=state.reviver?state.reviver(key,value):value;if(value!==undefined){obj[key]=value;}}function parsePair(tokens,state,obj){var token=skipPunctuation(tokens,state,[":"]);var key;var value;if(token.type!=="string"){
raiseUnexpected(state,token,"string");switch(token.type){case":":token={type:"string",value:"null",line:token.line,};state.pos-=1;break;case"number":case"atom":token={type:"string",value:""+token.value,line:token.line,};break;case"[":case"{":state.pos-=1;value=parseAny(tokens,state);appendPair(state,obj,"null",value);return;}}checkDuplicates(state,obj,token);key=token.value;skipColon(tokens,state);value=parseAny(tokens,state);appendPair(state,obj,key,value);}function parseElement(tokens,state,arr){var key=arr.length;var value=parseAny(tokens,state);arr[key]=state.reviver?state.reviver(""+key,value):value;}function parseObject(tokens,state){return parseMany(tokens,state,{},{skip:[":","}"],elementParser:parsePair,elementName:"string",endSymbol:"}",});}function parseArray(tokens,state){return parseMany(tokens,state,[],{skip:["]"],elementParser:parseElement,elementName:"json object",endSymbol:"]",});}function parseMany(tokens,state,obj,opts){var token=skipPunctuation(tokens,state,opts.skip
);if(token.type==="eof"){raiseUnexpected(state,token,"'"+opts.endSymbol+"' or "+opts.elementName);token={type:opts.endSymbol,line:token.line,};}switch(token.type){case opts.endSymbol:return obj;default:state.pos-=1;opts.elementParser(tokens,state,obj);break;}while(true){token=popToken(tokens,state);if(token.type!==opts.endSymbol&&token.type!==","){raiseUnexpected(state,token,"',' or '"+opts.endSymbol+"'");token={type:token.type==="eof"?opts.endSymbol:",",line:token.line,};state.pos-=1;}switch(token.type){case opts.endSymbol:return obj;case",":opts.elementParser(tokens,state,obj);break;}}}function endChecks(tokens,state,ret){if(state.pos<tokens.length){raiseError(state,tokens[state.pos],"Unexpected token: "+strToken(tokens[state.pos])+", expected end-of-input");}if(state.tolerant&&state.warnings.length!==0){var message=state.warnings.length===1?state.warnings[0].message:state.warnings.length+" parse warnings";var err=new SyntaxError(message);err.line=state.warnings[0].line;err.warnings=
state.warnings;err.obj=ret;throw err;}}function parseAny(tokens,state,end){var token=skipPunctuation(tokens,state);var ret;if(token.type==="eof"){raiseUnexpected(state,token,"json object");}switch(token.type){case"{":ret=parseObject(tokens,state);break;case"[":ret=parseArray(tokens,state);break;case"string":case"number":case"atom":ret=token.value;break;}if(end){ret=state.reviver?state.reviver("",ret):ret;endChecks(tokens,state,ret);}return ret;}function parse(text,opts){if(typeof opts==="function"||opts===undefined){return JSON.parse(transform(text),opts);}else if(new Object(opts)!==opts){throw new TypeError("opts/reviver should be undefined, a function or an object");}opts.relaxed=opts.relaxed!==undefined?opts.relaxed:true;opts.warnings=opts.warnings||opts.tolerant||false;opts.tolerant=opts.tolerant||false;opts.duplicate=opts.duplicate||false;if(!opts.warnings&&!opts.relaxed){return JSON.parse(text,opts.reviver);}var tokens=opts.relaxed?lexer(text):strictLexer(text);if(opts.relaxed){
tokens=stripTrailingComma(tokens);}if(opts.warnings){tokens=tokens.filter(;var state={pos:0,reviver:opts.reviver,tolerant:opts.tolerant,duplicate:opts.duplicate,warnings:[]};return parseAny(tokens,state,true);}else{var newtext=tokens.reduce("");return JSON.parse(newtext,opts.reviver);}}function stringifyPair(obj,key){return JSON.stringify(key)+":"+stringify(obj[key]);}function stringify(obj){switch(typeof obj){case"string":case"number":case"boolean":return JSON.stringify(obj);}if(Array.isArray(obj)){return"["+obj.map(stringify).join(",")+"]";}if(new Object(obj)===obj){var keys=Object.keys(obj);keys.sort();return"{"+keys.map(stringifyPair.bind(null,obj))+"}";}return"null";}var RJSON={transform:transform,parse:parse,stringify:stringify,};if(typeof window!=="undefined"){window.RJSON=RJSON;}else if(typeof module!=="undefined"){module.exports=RJSON;}}());
}];});
mw.loader.impl(function(){return["ext.gadget.susaresources@1paid",function($,jQuery,require,module){if($.inArray(mw.config.get('wgPageName'),['Mental_health_resources'])!==-1){mw.loader.using('ext.centralNotice.geoIP','mediawiki.api').then(.then(function(geo){var api=new mw.Api(),countrysection,countrycode,countrylist=[];$("#first-group").show();$("#first-group").children(".resources").each(function(){$(this).hide();countrylist.push($(this).attr("class").replace("resources resources-",""));});countrycode=Geo.country;if($.inArray(countrycode,countrylist)==-1){$("#nocountrywarn").html("We're sorry, but there are not currently resources for "+countrycode+". Please feel free to suggest some on the <a href='https://office.wikimedia.org/wiki/Talk:Support_and_Safety/MH_Resources&action=edit&section=new'>talk page</a>.");countrycode="XX";}if(Geo.country===null){countrycode="XX";}countrysection="#first-group .resources-"+countrycode;$(countrysection).show();});}
}];});
mw.loader.impl(function(){return["ext.gadget.wadpGadgetsLoader@xkx0g",function($,jQuery,require,module){(function(){'use strict';var pageName=mw.config.values.wgPageName;if(pageName.startsWith('Wikimedia_Affiliates_Data_Portal')){var me_staff=['DAlangi (WMF)','DNdubane (WMF)','MKaur (WMF)','AChina-WMF'];if(me_staff.indexOf(mw.config.values.wgUserName)>-1){mw.loader.using('ext.gadget.wadpOrgInfoForm',;}else{mw.loader.load('ext.gadget.wadpOrgInfoForm');}mw.loader.load('ext.gadget.wadpFinancialReportForm');mw.loader.load('ext.gadget.wadpActivitiesReportForm');mw.loader.load('ext.gadget.wadpQueryForm');mw.loader.load('ext.gadget.wadpAIUForm');}if(pageName.split('Wikimedia_Affiliates_Data_Portal/')[1]==='Organizations_Information'){mw.loader.load('ext.gadget.wadpOrgInfoForm');}}());
},{"css":[".radio-inline .oo-ui-radioOptionWidget{display:inline-block;padding-right:10px}.checkbox-inline .oo-ui-checkboxMultioptionWidget{display:inline-block;padding-right:13px}.bold-label .oo-ui-fieldLayout-header{font-weight:bold}.full-width.mw-widget-dateInputWidget.oo-ui-textInputWidget{max-width:none}#wadp-popup-widget-position{top:0;left:0}"]}];});
mw.loader.impl(function(){return["ext.gadget.wrcAddNewGroup@1im7n",function($,jQuery,require,module){(function(){'use strict';if(mw.config.values.wgPageName.split('/')[0]=='Connect'){mw.loader.using(['ext.gadget.luaparse','mediawiki.api','oojs-ui','oojs-ui-core','oojs-ui.styles.icons-editing-core']).done(function(){var cleanRawEntry,gadgetMsg,getContentGroups,getContentModule,getRelevantRawEntry,openWindow,userLang;userLang=mw.config.get('wgUserLanguage');new mw.Api().get({action:'query',list:'messagecollection',mcgroup:'page-Template:I18n/Wikimedia_Resource_Center',mclanguage:userLang}).done(function(data){var i,res,key,val,gadgetMsg={};res=data.query.messagecollection;for(i=0;i<res.length;i++){key=res[i].key.replace('Template:I18n/Wikimedia_Resource_Center/','');val=res[i].translation;if(!val){val=res[i].definition;}gadgetMsg[key]=val;}getContentGroups=function(){return{action:'query',prop:'revisions',titles:'Module:Wikimedia Resource Center/Groups',rvprop:'content',rvlimit:1};};getRelevantRawEntry=function(entries,name){var i,j;for(i=0;i<entries.length;i++){for(j=0;j<entries[i].
value.fields.length;j++){if(entries[i].value.fields[j].key.name=='name'&&entries[i].value.fields[j].value.value==name){return entries[i].value.fields;}}}};cleanRawEntry=function(relevantRawEntry){var entryData={},i,j;for(i=0;i<relevantRawEntry.length;i++){entryData[relevantRawEntry[i].key.name]=relevantRawEntry[i].value.value;}return entryData;};getContentModule=function(sourceblob){var i,raw,ast;for(i in sourceblob){raw=sourceblob[i].revisions[0]['*'];ast=luaparse.parse(raw);return ast.body[0].arguments[0].fields;}};function WrcAddNewGroup(config){this.type='group';this.name='';this.description='';this.icon='';this.facebook='';this.twitter='';this.facebook='';if(config.name){this.name=config.name;}if(config.description){this.description=config.description;}if(config.icon){this.icon=config.icon;}if(config.facebook){this.facebook=config.facebook;}if(config.twitter){this.twitter=config.twitter;}if(config.youtube){this.youtube=config.youtube;}WrcAddNewGroup.super.call(this,config);}OO.
inheritClass(WrcAddNewGroup,OO.ui.ProcessDialog);WrcAddNewGroup.static.name='wrcAddNewGroup';WrcAddNewGroup.static.title=gadgetMsg['editor-ang-button'];WrcAddNewGroup.static.actions=[{action:'continue',modes:'edit',label:gadgetMsg['editor-save'],flags:['primary','constructive']},{action:'cancel',modes:'edit',label:gadgetMsg['editor-cancel'],flags:'safe'}];WrcAddNewGroup.prototype.initialize=function(){var dialog;dialog=this;WrcAddNewGroup.super.prototype.initialize.call(this);this.content=new OO.ui.PanelLayout({padded:true,expanded:false});this.fieldType=new OO.ui.TextInputWidget({value:this.type,indicator:'required',required:true});this.fieldName=new OO.ui.TextInputWidget({value:this.name,indicator:'required',required:true});this.fieldDescription=new OO.ui.MultilineTextInputWidget({value:this.description,rows:5,indicator:'required',required:true});this.fieldIcon=new OO.ui.TextInputWidget({value:this.icon});this.fieldFacebook=new OO.ui.TextInputWidget({value:this.facebook});this.
fieldTwitter=new OO.ui.TextInputWidget({value:this.twitter});this.fieldYouTube=new OO.ui.TextInputWidget({value:this.youtube});this.deleteButton=new OO.ui.ButtonWidget({label:gadgetMsg['editor-remove-entry'],icon:'trash',flags:['destructive']}).on('click',function(){new OO.ui.confirm(gadgetMsg['editor-remove-confirm']).done(function(confirmed){if(confirmed){dialog.saveItem('delete');}});});this.fieldSet=new OO.ui.FieldsetLayout({items:[new OO.ui.FieldLayout(this.fieldName,{label:gadgetMsg['editor-ang-fieldname'],align:'top',help:gadgetMsg['editor-ang-fieldname-help']}),new OO.ui.FieldLayout(this.fieldDescription,{label:gadgetMsg['editor-ang-fielddescription'],align:'top',help:gadgetMsg['editor-ang-fielddescription-help']}),new OO.ui.FieldLayout(this.fieldIcon,{label:gadgetMsg['editor-ang-fieldicon'],align:'top',help:gadgetMsg['editor-ang-fieldicon-help']}),new OO.ui.FieldLayout(this.fieldFacebook,{label:gadgetMsg['editor-ang-fieldfacebook'],align:'top',help:gadgetMsg[
'editor-ang-fieldfacebook-help']}),new OO.ui.FieldLayout(this.fieldTwitter,{label:gadgetMsg['editor-ang-fieldtwitter'],align:'top',help:gadgetMsg['editor-ang-fieldtwitter-help']}),new OO.ui.FieldLayout(this.fieldYouTube,{label:gadgetMsg['editor-ang-fieldyoutube'],align:'top',help:gadgetMsg['editor-ang-fieldyoutube-help']})]});if(this.name){this.fieldSet.addItems([new OO.ui.FieldLayout(this.deleteButton)]);}this.content.$element.append(this.fieldSet.$element);this.$body.append(this.content.$element);};WrcAddNewGroup.prototype.getBodyHeight=function(){return 550;};WrcAddNewGroup.prototype.getActionProcess=function(action){var dialog=this;if(action==='continue'&&dialog.fieldType.getValue()){return new OO.ui.Process(function(){dialog.saveItem();});}else{return new OO.ui.Process(function(){dialog.close();});}return NewItemDialog.parent.prototype.getActionProcess.call(this,action);};WrcAddNewGroup.prototype.saveItem=function(deleteFlag){var dialog=this,content,insertGroupPage='',
generateGrouppageData,gpName;dialog.pushPending();new mw.Api().get(getContentGroups()).done(function(data){var i,insertInPlace,sanitizeInput,processWorkingEntry,editSummary,manifest=[],workingEntry,generateKeyValuePair,entries,pageName;sanitizeInput=function(s){return s.replace(/\\/g,'\\\\').replace(/\n/g,'<br />');};generateKeyValuePair=function(k,v){var res,jsonarray;res='\t\t'.concat(k,' = ');v=sanitizeInput(v);v=v.replace(/'/g,'\\\'');res+='\''+v+'\'';res+=',\n';return res;};generateGrouppageData=function(k,v){var res;res='| '.concat(k,' = ');res+=v+'\n';return res;};processWorkingEntry=function(workingEntry){workingEntry.type=dialog.fieldType.getValue();insertGroupPage='{{Connect group\n';if(dialog.fieldType.getValue()){workingEntry.type=dialog.fieldType.getValue();}else if(!dialog.fieldType.getValue()&&workingEntry.type){delete workingEntry.type;}if(dialog.fieldName.getValue()){workingEntry.name=dialog.fieldName.getValue();}else if(!dialog.fieldName.getValue()&&workingEntry.name)
{delete workingEntry.name;}if(dialog.fieldDescription.getValue()){workingEntry.description=dialog.fieldDescription.getValue();insertGroupPage+=generateGrouppageData('introduction',workingEntry.description);}else if(!dialog.fieldDescription.getValue()&&workingEntry.description){delete workingEntry.description;}if(dialog.fieldIcon.getValue()){workingEntry.icon=dialog.fieldIcon.getValue();insertGroupPage+=generateGrouppageData('icon',workingEntry.icon);}else if(!dialog.fieldIcon.getValue()&&workingEntry.icon){delete workingEntry.icon;}if(dialog.fieldFacebook.getValue()){workingEntry.facebook=dialog.fieldFacebook.getValue();insertGroupPage+=generateGrouppageData('facebook',workingEntry.facebook);}else if(!dialog.fieldFacebook.getValue()&&workingEntry.facebook){delete workingEntry.facebook;}if(dialog.fieldTwitter.getValue()){workingEntry.twitter=dialog.fieldTwitter.getValue();insertGroupPage+=generateGrouppageData('twitter',workingEntry.twitter);}else if(!dialog.fieldTwitter.getValue()&&
workingEntry.twitter){delete workingEntry.twitter;}if(dialog.fieldYouTube.getValue()){workingEntry.youtube=dialog.fieldYouTube.getValue();insertGroupPage+=generateGrouppageData('youtube',workingEntry.youtube);}else if(!dialog.fieldYouTube.getValue()&&workingEntry.youtube){delete workingEntry.youtube;}insertGroupPage+='}}\n\n[[Category:Connect groups|{{SUBPAGENAME}}]]';return workingEntry;};entries=getContentModule(data.query.pages);for(i=0;i<entries.length;i++){workingEntry=cleanRawEntry(entries[i].value.fields);if(workingEntry.name==dialog.name){if(deleteFlag){editSummary='Removing entry: '.concat(workingEntry.name);}else{workingEntry=processWorkingEntry(workingEntry);editSummary='Editing entry: '.concat(workingEntry.name);}}if(workingEntry.name!=dialog.name||!deleteFlag){manifest.push(workingEntry);}}if(!dialog.name){workingEntry={};workingEntry=processWorkingEntry(workingEntry);editSummary=gadgetMsg['editor-ang-preeditsummary'].concat(workingEntry.name);manifest.push(workingEntry);}
insertInPlace='return {\n';for(i=0;i<manifest.length;i++){insertInPlace+='\t{\n';if(manifest[i].type){insertInPlace+=generateKeyValuePair('type',manifest[i].type);}if(manifest[i].name){insertInPlace+=generateKeyValuePair('name',manifest[i].name.split(" ").join("_"));pageName='Connect/'+manifest[i].name;gpName=manifest[i].name.split(" ").join("_");}if(manifest[i].description){insertInPlace+=generateKeyValuePair('description',manifest[i].description);}if(manifest[i].icon){insertInPlace+=generateKeyValuePair('icon',manifest[i].icon);}if(manifest[i].facebook){insertInPlace+=generateKeyValuePair('facebook',manifest[i].facebook);}if(manifest[i].twitter){insertInPlace+=generateKeyValuePair('twitter',manifest[i].twitter);}if(manifest[i].youtube){insertInPlace+=generateKeyValuePair('youtube',manifest[i].youtube);}insertInPlace+='\t},\n';}insertInPlace+='}';new mw.Api().postWithToken('csrf',{action:'edit',nocreate:true,summary:editSummary,pageid:10588351,text:insertInPlace,contentmodel:
'Scribunto'}).done(function(){dialog.close();new mw.Api().postWithToken('csrf',{action:'purge',titles:mw.config.values.wgPageName}).done(function(){location.reload();});}).fail(function(){alert(gadgetMsg['editor-ang-failed-alert']);dialog.close();});new mw.Api().postWithToken('csrf',{action:'edit',title:pageName,summary:editSummary,text:insertGroupPage,contentmodel:'wikitext'}).done(function(){dialog.close();new mw.Api().postWithToken('csrf',{action:'purge',titles:mw.config.values.wgPageName}).done(function(){location.reload();});}).fail(function(){alert(gadgetMsg['editor-ang-failed-alert']);dialog.close();});});};openWindow=function(config){var wrcAddNewGroup,windowManager;config.size='large';wrcAddNewGroup=new WrcAddNewGroup(config);windowManager=new OO.ui.WindowManager();$('body').append(windowManager.$element);windowManager.addWindows([wrcAddNewGroup]);windowManager.openWindow(wrcAddNewGroup);};$('.group-edit-icon').each(function(){var $icon=$(this),editButton;editButton=new OO.ui.
ButtonWidget({framed:false,icon:'edit'}).on('click',function(){new mw.Api().get(getContentGroups()).done(function(data){var entryData,gpName,content;gpName=editButton.$element.closest('.wrc-card').data('wrc-unique-id');entryData=cleanRawEntry(getRelevantRawEntry(getContentModule(data.query.pages),gpName));openWindow(entryData);});});$icon.css('float','right');$icon.append(editButton.$element);});$('.wrc-ag-button').each(function(){var $addButton=$(this),addButton;addButton=new OO.ui.ButtonWidget({icon:'add',label:gadgetMsg['editor-ang-button'],flags:['primary','progressive']}).on('click',function(){openWindow({});});$addButton.css('margin','1.125em');$addButton.append(addButton.$element);});});});}}());
}];});
mw.loader.impl(function(){return["ext.gadget.wrcAddNewIndividual@c6kbn",function($,jQuery,require,module){(function(){'use strict';if(mw.config.values.wgPageName.split('/')[0]=='Connect'){mw.loader.using(['ext.gadget.luaparse','mediawiki.api','oojs-ui','oojs-ui-core','oojs-ui.styles.icons-editing-core']).done(function(){var addSkillsToUserpage,cleanRawEntry,gadgetMsg,getContentIndividuals,getContentModule,getRelevantRawEntry,getUserpageData,getWikitextModule,openWindow,userLang;userLang=mw.config.get('wgUserLanguage');new mw.Api().get({action:'query',list:'messagecollection',mcgroup:'page-Template:I18n/Wikimedia_Resource_Center',mclanguage:userLang}).done(function(data){var i,res,key,val,gadgetMsg={};res=data.query.messagecollection;for(i=0;i<res.length;i++){key=res[i].key.replace('Template:I18n/Wikimedia_Resource_Center/','');val=res[i].translation;if(!val){val=res[i].definition;}gadgetMsg[key]=val;}getContentIndividuals=getUserpageData=function(username){
return{action:'query',prop:'revisions',titles:'User:'+username,rvprop:'content',rvlimit:1};};getContentModule=function(sourceblob){var i,raw,ast;for(i in sourceblob){raw=sourceblob[i].revisions[0]['*'];ast=luaparse.parse(raw);return ast.body[0].arguments[0].fields;}};getWikitextModule=function(sourceblob){var i,raw;for(i in sourceblob){raw=sourceblob[i].revisions[0]['*'];return raw;}};getRelevantRawEntry=function(entries,name){var i,j;for(i=0;i<entries.length;i++){for(j=0;j<entries[i].value.fields.length;j++){if(entries[i].value.fields[j].key.name=='name'&&entries[i].value.fields[j].value.value==name){return entries[i].value.fields;}}}};cleanRawEntry=function(relevantRawEntry){var entryData={},i,j;for(i=0;i<relevantRawEntry.length;i++){if(relevantRawEntry[i].key.name=='skills'){entryData.skills=[];for(j=0;j<relevantRawEntry[i].value.fields.length;j++){entryData.skills.push(relevantRawEntry[i].value.fields[j].value.value);}}else{entryData[relevantRawEntry[i].key.name]=relevantRawEntry[i
].value.value;}}return entryData;};addSkillsToUserpage=function(username,skills){var i,userPageContent,userPageContentWithCategories,categories='',summaryMsg;if(skills.length>1){summaryMsg=gadgetMsg['added-categories'];}else{summaryMsg=gadgetMsg['added-category'];}new mw.Api().get(getUserpageData(username)).done(function(data){categories+="\n<!--Connect Categories-->";categories+="\n<!--[DO NOT EDIT BELOW MANUALLY] Please edit on [[Connect]]-->";for(i=0;i<skills.length;i++){categories+="\n[[Category:";categories+=skills[i];categories+="]]\n";}categories+="<!--Edit via form on [[Connect]]-->";userPageContent=getWikitextModule(data.query.pages);userPageContent=userPageContent.split("<!--Connect Categories-->")[0];userPageContentWithCategories=userPageContent+categories;new mw.Api().postWithToken('csrf',{action:'edit',nocreate:true,summary:summaryMsg+skills,title:gadgetMsg['user-page']+username,text:userPageContentWithCategories,contentmodel:'wikitext'}).done(function(){dialog.close();new
mw.Api().postWithToken('csrf',{action:'purge',titles:mw.config.values.wgPageName}).done(function(){location.reload();});}).fail(function(){alert(gadgetMsg['added-category-failure']);dialog.close();});});};function WrcAddNewIndividual(config){this.type='user';this.name='';this.description='';this.icon='';this.skills=[];if(config.name){this.name=config.name;}if(config.description){this.description=config.description;}if(config.icon){this.icon=config.icon;}if(config.skills){this.skills=config.skills;}WrcAddNewIndividual.super.call(this,config);}OO.inheritClass(WrcAddNewIndividual,OO.ui.ProcessDialog);WrcAddNewIndividual.static.name='wrcAddNewIndividual';WrcAddNewIndividual.static.title=gadgetMsg['editor-ani-button'];WrcAddNewIndividual.static.actions=[{action:'continue',modes:'edit',label:gadgetMsg['editor-save'],flags:['primary','constructive']},{action:'cancel',modes:'edit',label:gadgetMsg['editor-cancel'],flags:'safe'}];WrcAddNewIndividual.prototype.initialize=function(){var dialog,i,
fieldSkillsToShare,fieldSkillsToShareSelected;dialog=this;WrcAddNewIndividual.super.prototype.initialize.call(this);this.content=new OO.ui.PanelLayout({padded:true,expanded:false});this.fieldType=new OO.ui.TextInputWidget({value:this.type,indicator:'required',required:true});this.fieldName=new OO.ui.TextInputWidget({value:this.name,indicator:'required',required:true});this.fieldDescription=new OO.ui.MultilineTextInputWidget({value:this.description,rows:5,indicator:'required',required:true});this.fieldIcon=new OO.ui.TextInputWidget({value:this.icon});fieldSkillsToShareSelected=[];for(i=0;i<this.skills.length;i++){fieldSkillsToShareSelected.push({data:this.skills[i],label:gadgetMsg[this.skills[i].toLowerCase().replace(/ /g,'-')]});}this.fieldSkillsToShare=new OO.ui.MenuTagMultiselectWidget({selected:fieldSkillsToShareSelected,options:[{data:'Program design skills',label:gadgetMsg['program-design-skills']},{data:'Program evaluation skills',label:gadgetMsg['program-evaluation-skills']},{
data:'Program planning skills',label:gadgetMsg['program-planning-skills']},{data:'Program management skills',label:gadgetMsg['program-management-skills']},{data:'Storytelling skills',label:gadgetMsg['storytelling-skills']},{data:'Press relations experience',label:gadgetMsg['press-relations-experience']},{data:'Annual planning skills',label:gadgetMsg['annual-planning-skills']},{data:'Survey skills',label:gadgetMsg['survey-skills']},{data:'Fundraising skills',label:gadgetMsg['fundraising-skills']},{data:'Financial skills',label:gadgetMsg['financial-skills']},{data:'Affiliate collaboration skills',label:gadgetMsg['affiliate-collaboration-skills']},{data:'Event organization and planning skills',label:gadgetMsg['event-organization-and-planning-skills']},{data:'Event program design skills',label:gadgetMsg['event-program-design-skills']},{data:'Facilitation skills',label:gadgetMsg['facilitation-skills']},{data:'Online governance experience',label:gadgetMsg['online-governance-experience']},{
data:'New affiliate proposal experience',label:gadgetMsg['new-affiliate-proposal-experience']}],indicator:'required'});this.deleteButton=new OO.ui.ButtonWidget({label:gadgetMsg['editor-remove-entry'],icon:'trash',flags:['destructive']}).on('click',function(){new OO.ui.confirm(gadgetMsg['editor-remove-confirm']).done(;});this.fieldSet=new OO.ui.FieldsetLayout({items:[new OO.ui.FieldLayout(this.fieldName,{label:gadgetMsg['editor-ani-fieldname'],align:'top',help:gadgetMsg['editor-ani-fieldname-help']}),new OO.ui.FieldLayout(this.fieldDescription,{label:gadgetMsg['editor-ani-fielddescription'],align:'top',help:gadgetMsg['editor-ani-fielddescription-help']}),new OO.ui.FieldLayout(this.fieldIcon,{label:gadgetMsg['editor-ani-fieldicon'],align:'top',help:gadgetMsg['editor-ani-fieldicon-help']}),new OO.ui.FieldLayout(this.fieldSkillsToShare,{label:gadgetMsg['editor-ani-skills-and-exprience'],align:'top',help:gadgetMsg[
'editor-ani-skills-and-exprience-help']}),]});if(this.name){this.fieldSet.addItems([new OO.ui.FieldLayout(this.deleteButton)]);}this.content.$element.append(this.fieldSet.$element);this.$body.append(this.content.$element);};WrcAddNewIndividual.prototype.getBodyHeight=WrcAddNewIndividual.prototype.getActionProcess=function(action){var dialog=this;if(action==='continue'&&dialog.fieldType.getValue()){return new OO.ui.Process(function(){dialog.saveItem();});}else{return new OO.ui.Process(function(){dialog.close();});}return NewItemDialog.parent.prototype.getActionProcess.call(this,action);};WrcAddNewIndividual.prototype.saveItem=function(deleteFlag){var dialog=this,content;dialog.pushPending();new mw.Api().get(getContentIndividuals()).done(function(data){var i,insertInPlace,sanitizeInput,processWorkingEntry,editSummary,manifest=[],workingEntry,username,generateKeyValuePair,skills,entries,name;sanitizeInput=generateKeyValuePair=function(k,v){var res,jsonarray;res='\t\t'.concat(k,' = ');if(k=='skills'){jsonarray=JSON.stringify(v);jsonarray=jsonarray.replace('[','{');jsonarray=jsonarray.replace(']','}');jsonarray=jsonarray.replace(/\"/g,'\'');jsonarray=jsonarray.replace(/,/g,', ');jsonarray=sanitizeInput(jsonarray);res+=jsonarray;}else{v=sanitizeInput(v);v=v.replace(/'/g,'\\\'');res+='\''+v+'\'';}res+=',\n';return res;};processWorkingEntry=function(workingEntry){workingEntry.type=dialog.fieldType.getValue();if(dialog.fieldType.getValue()){workingEntry.type=dialog.fieldType.getValue();}else if(!dialog.fieldType.getValue()&&workingEntry.type){delete workingEntry.type;}if(dialog.fieldName.getValue()){workingEntry.name=dialog.fieldName.getValue();}else if(!dialog.fieldName.getValue()&&workingEntry.name){delete workingEntry.name;}if(dialog.fieldDescription.getValue()){workingEntry.description=dialog.fieldDescription.getValue();}else if(!dialog.fieldDescription.getValue()&&
workingEntry.description){delete workingEntry.description;}if(dialog.fieldIcon.getValue()){workingEntry.icon=dialog.fieldIcon.getValue();}else if(!dialog.fieldIcon.getValue()&&workingEntry.icon){delete workingEntry.icon;}if(dialog.fieldSkillsToShare.getValue()){workingEntry.skills=dialog.fieldSkillsToShare.getValue();}else if(!dialog.fieldSkillsToShare.getValue()&&workingEntry.skills){delete workingEntry.skills;}return workingEntry;};entries=getContentModule(data.query.pages);for(i=0;i<entries.length;i++){workingEntry=cleanRawEntry(entries[i].value.fields);if(workingEntry.name==dialog.name){if(deleteFlag){editSummary='Removing individual: '.concat(workingEntry.name);}else{workingEntry=processWorkingEntry(workingEntry);editSummary='Editing individual: '.concat(workingEntry.name);}}if(workingEntry.name!=dialog.name||!deleteFlag){manifest.push(workingEntry);}}if(!dialog.name){workingEntry={};workingEntry=processWorkingEntry(workingEntry);editSummary=gadgetMsg['add-new-individual'].concat(
workingEntry.name);manifest.push(workingEntry);}insertInPlace='return {\n';for(i=0;i<manifest.length;i++){insertInPlace+='\t{\n';if(manifest[i].type){insertInPlace+=generateKeyValuePair('type',manifest[i].type);}if(manifest[i].name){name=manifest[i].name.split(" ").join("_");insertInPlace+=generateKeyValuePair('name',name);username=name;}if(manifest[i].description){insertInPlace+=generateKeyValuePair('description',manifest[i].description);}if(manifest[i].icon){insertInPlace+=generateKeyValuePair('icon',manifest[i].icon);}if(manifest[i].skills){insertInPlace+=generateKeyValuePair('skills',manifest[i].skills);skills=manifest[i].skills;}insertInPlace+='\t},\n';}insertInPlace+='}';addSkillsToUserpage(username,skills);new mw.Api().postWithToken('csrf',{action:'edit',nocreate:true,summary:editSummary,pageid:10588347,text:insertInPlace,contentmodel:'Scribunto'}).done(function(){dialog.close();new mw.Api().postWithToken('csrf',{action:'purge',titles:mw.config.values.wgPageName}).done(;}).fail(function(){alert(gadgetMsg['editor-ani-failed-alert']);dialog.close();});});};openWindow=function(config){var wrcAddNewIndividual,windowManager;config.size='large';wrcAddNewIndividual=new WrcAddNewIndividual(config);windowManager=new OO.ui.WindowManager();$('body').append(windowManager.$element);windowManager.addWindows([wrcAddNewIndividual]);windowManager.openWindow(wrcAddNewIndividual);};$('.user-edit-icon').each(function(){var $icon=$(this),editButton;editButton=new OO.ui.ButtonWidget({framed:false,icon:'edit'}).on('click',function(){new mw.Api().get(getContentIndividuals()).done(function(data){var entryData,username,content;username=editButton.$element.closest('.wrc-card').data('wrc-unique-id');entryData=cleanRawEntry(getRelevantRawEntry(getContentModule(data.query.pages),username));openWindow(entryData);});});$icon.css('float','right');$icon.append(editButton.$element);});$('.wrc-ai-button').each(function(){var $addButton=$(this),addButton;addButton=
new OO.ui.ButtonWidget({icon:'add',label:gadgetMsg['editor-ani-button'],flags:['primary','progressive']}).on('click',;$addButton.css('margin','1.125em');$addButton.append(addButton.$element);});});});}}());
}];});
mw.loader.impl(function(){return["ext.gadget.wrcCollapsible@a3fza",function($,jQuery,require,module){(function(){'use strict';mw.loader.using(['oojs-ui','oojs-ui.styles.icons-movement']).done(function(){if(mw.config.values.wgPageName=='Wikimedia_Resource_Center/All'||mw.config.values.wgPageName=='Wikimedia_Resource_Center/For_program_coordinators'||mw.config.values.wgPageName=='Wikimedia_Resource_Center/For_contributors'||mw.config.values.wgPageName=='Wikimedia_Resource_Center/For_developers'||mw.config.values.wgPageName=='Wikimedia_Resource_Center/For_affiliate_organizers'){$('.mw-parser-output h2').each(function(){var $sectionHeader,doTheSwitch,toggleWidget;$sectionHeader=$(this);$sectionHeader.nextUntil('h2').wrapAll('<div class="section-content" style="display:none;"></div>');$sectionHeader.data('collapsed','true');doTheSwitch=function(){if($sectionHeader.data('collapsed')=='true'){$sectionHeader.next().css('display','block');toggleWidget.setIcon('collapse');$sectionHeader.data('collapsed','false');}else{$sectionHeader.next().css('display','none');toggleWidget.setIcon('expand');
$sectionHeader.data('collapsed','true');}};toggleWidget=new OO.ui.ButtonWidget({framed:false,icon:'expand'}).on('click',;toggleWidget.$element.css('font-size','70%');$sectionHeader.prepend(toggleWidget.$element);$('.toc').css('display','none');$sectionHeader.click(doTheSwitch);});}});}());
}];});
mw.loader.impl(function(){return["ext.gadget.wrcEditor@1bs7l",function($,jQuery,require,module){(function(){'use strict';if(mw.config.values.wgPageName.split('/')[0]=='Wikimedia_Resource_Center'){mw.loader.load('ext.gadget.wrcEditor-core');}}());
}];});
