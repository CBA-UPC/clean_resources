(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[685],{"/Oio":"08+0":function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return a}));var r=n("qU2n"),o=n("SoYc");function i(t,e,n,i){var c=Object(o.a)(n);if(c){var a=Object(r.a)(t,i);try{var u=void 0===e?"null":JSON.stringify(e);c.setItem(a,u)}catch(t){}}}function c(t,e,n){return void 0===n&&(n="localStorage"),i(t,e,n)}function a(t,e,n,r){return void 0===r&&(r="localStorage"),i(e,n,r,t)}},CASw:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("QjXU"),o=n("qnPW"),i=n("xjjT"),c=n("EJjl");function a(t,e,n){var a;return Object(r.__awaiter)(this,void 0,void 0,(function(){var u;return Object(r.__generator)(this,(function(r){return u=(null===(a=null==n?void 0:n.firstRunGates)||void 0===a?void 0:a.firstRunSecondMockEnabled)||!1,[2,Object(c.a)(t,e,"SecondRunState",u,(function(t){return{CompletedFirstRun:t,Version:o.b}}),i.a)]}))}))}},EJjl:function(t,e,n){"use strict";n.d(e,"a",(function(){return m}));var r=n("QjXU"),o=n("muUJ"),i=n("a3FV"),c=n("/Oio"),a=n("CMIS"),u=n("mpo9"),s=n("Yh/z"),f=n("08+0"),d=n("Pd+Y"),l=n("PIlr");function b(t,e){return t||e?t?e?t.Version>e.Version?t:e.Version>t.Version?e:t.CompletedFirstRun?t:e.CompletedFirstRun?e:t:t:e:null}var v=n("oKmG");function j(t,e,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,c,a,u,j;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i=Object(l.b)(e.puid,"_".concat(n))||null,o?[2,i]:[4,Object(d.a)(n,t)];case 1:return c=r.sent()||null,a=b(c,i),u=c&&i&&(c.CompletedFirstRun!==i.CompletedFirstRun||c.Version!==i.Version),j=a&&(null===i||u),a&&(null===c||u)&&Object(s.a)(n,a,t),j&&Object(f.b)(e.puid,Object(v.a)(n),a),[2,a]}}))}))}var O=n("i2XK");function h(t,e,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return o=Object(l.b)(e.puid,O.c)||null,n?[2,o]:[4,Object(d.a)(O.b,t)];case 1:return[2,b(r.sent()||null,o)]}}))}))}function m(t,e,n,d,l,b){return Object(r.__awaiter)(this,void 0,void 0,(function(){var v,O,m,p,_,w,g,S;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:v={correlationId:e.correlationId,getAccessToken:e.getAccessToken,getIdentity:function(){return Promise.resolve(t)},inMockMode:e.inMockMode,jwtAuthEnabled:e.jwtAuthEnabled,officeHomeApiRoot:e.officeHomeApiRoot,workload:e.workload},r.label=1;case 1:return r.trys.push([1,7,,8]),function(t){var e=!0;return t.workload===c.a.Hwa?"/pwa"!==location.pathname&&(e=!1):"/"!==location.pathname&&(e=!1),e}(e)?d?[2,l(!1)]:[4,j(v,t,n,O=t.isMsa&&e.workload===c.a.Hwa)]:[2,l(!0)];case 2:return null!==(m=r.sent())?[3,6]:e.workload===c.a.OfficeHome||e.workload===c.a.OfficeHomeReact?(p=!Object(u.c)(),m=l(p),[3,5]):[3,3];case 3:return[4,h(v,t,O)];case 4:_=r.sent(),m=_?b(_):l(!1),r.label=5;case 5:Object(f.b)(t.puid,"_".concat(n),m),Object(s.a)(n,m,v),r.label=6;case 6:return[2,m];case 7:return w=r.sent(),g="Couldn't determine FirstRunState: ".concat(w),Object(o.a)(i.a.FirstRunDetermineStateError,((S={}).Error=g,S)),Object(a.a)({eventName:i.a.FirstRunDetermineStateError,errorType:"FirstRun_Error",area:"FirstRun",errorCategory:"React",message:g}),[2,l(!0)];case 8:return[2]}}))}))}},Hnto:function(t,e,n){"use strict";n.r(e),n.d(e,"fetchFirstRunState",(function(){return r.a})),n.d(e,"fetchSecondRunState",(function(){return r.b})),n.d(e,"fetchTuiNewUserState",(function(){return r.c})),n.d(e,"useFirstRunState",(function(){return u})),n.d(e,"useSecondRunState",(function(){return f})),n.d(e,"useTuiNewUserState",(function(){return l})),n.d(e,"updateFirstRunState",(function(){return b.a})),n.d(e,"updateSecondRunState",(function(){return v.a})),n.d(e,"updateTuiNewUserState",(function(){return j.a}));var r=n("mzFX"),o=n("B5kz"),i=n("myGd"),c=n("uuEz"),a=n("i2XK");function u(){var t=[a.a];return Object(o.c)(t,Object(c.a)(i.a),{staleTime:1/0,cacheTime:1/0})}var s=n("CASw");function f(){var t=[a.d];return Object(o.c)(t,Object(c.a)(s.a),{staleTime:1/0,cacheTime:1/0})}var d=n("WKCs");function l(){var t=[a.e];return Object(o.c)(t,Object(c.a)(d.a),{staleTime:1/0,cacheTime:1/0})}var b=n("UihW"),v=n("SbzA"),j=n("ToD/")},MJsD:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("QjXU"),o=n("B5kz"),i=n("zPZ9");function c(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){return[2,o.a.fetchQuery(["OfficeComponentContext"],(,{cacheTime:1/0,staleTime:1/0})]}))}))}},PIlr:function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return a}));var r=n("qU2n"),o=n("SoYc");function i(t,e,n){var i=Object(o.a)(e);if(i){var c=Object(r.a)(t,n),a=i.getItem(c);return"string"==typeof a?JSON.parse(a):void 0}}"Pd+Y":function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n("QjXU"),o=n("8wW2"),i=n("a3FV"),c=n("0TX8"),a=n("Wa5Y"),u=n("mpo9");function s(t,e,n,s){var f=this;return void 0===n&&(n=!1),void 0===s&&(s=1),new Promise((function(d,l){return Object(r.__awaiter)(f,void 0,void 0,(function(){var f,b,v,j;return Object(r.__generator)(this,(function(O){switch(O.label){case 0:return(f=Object(u.b)()).hasOwnProperty(t)&&!n?(b=Array.isArray(f[t])?f[t]:Object(r.__assign)({},f[t]),d(b),[2]):Object(u.c)()||s<1?(d(void 0),[2]):[4,e.getIdentity()];case 1:return v=O.sent(),e.jwtAuthEnabled&&v.isMsa?(l("User storage does not support roaming"),[2]):(j={},[4,Object(c.a)(j,e.inMockMode,e.workload,e.getIdentity)]);case 2:return O.sent(),Object(a.a)(i.a.OfficeHomeStorageReadRequest,"OfficeHomeStorage_Read","".concat(e.officeHomeApiRoot,"/api/userstorage/").concat(t,"/"),j,e.jwtAuthEnabled,e.getAccessToken,e.officeHomeApiRoot,e.correlationId,"OfficeHome",{populateRequestEvent:function(e,n){n.RequestId=t},isRetriableError:).then((function(e){e.data&&(f[t]=Array.isArray(e.data)?e.data:Object(r.__assign)({},e.data)),d(e.data)})).catch((function(e){Object(o.a)().handleError(e,"Bn3rc"),e&&e.httpResponse&&404===e.httpResponse.status?d(void 0):l("Failed to get value from user data storage for <".concat(t,"> key."))})),[2]}}))}))}))}},SbzA:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n("QjXU"),o=n("W2rS");function i(t){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return Object(o.a)("SecondRunState",t),[2]}))}))}},SoYc:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=new Map;function o(t){return r.has(t)||r.set(t,function(t){try{var e=window[t];if(!e)return;var n="".concat(Math.round(1e6*Math.random()));return e.setItem(n,n),e.removeItem(n),e}catch(t){return}}(t)),r.get(t)}},"ToD/":function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n("QjXU"),o=n("W2rS");function i(t){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return Object(o.a)("TuiNewUserState",t),[2]}))}))}},UihW:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n("QjXU"),o=n("W2rS");function i(t){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return Object(o.a)("FirstRunState",t),[2]}))}))}},W2rS:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n("QjXU"),o=n("MJsD"),i=n("W7wX"),c=n("Yh/z"),a=n("08+0"),u=n("oKmG");function s(t,e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,s,f,d;return Object(r.__generator)(this,(function(l){switch(l.label){case 0:return[4,Promise.all([Object(o.a)(),Object(i.a)()])];case 1:return n=r.__read.apply(void 0,[l.sent(),2]),f=n[1],d={correlationId:(s=n[0]).correlationId,getAccessToken:s.getAccessToken,getIdentity:inMockMode:s.inMockMode,jwtAuthEnabled:s.jwtAuthEnabled,officeHomeApiRoot:s.officeHomeApiRoot,workload:s.workload},Object(a.b)(f.puid,Object(u.a)(t),e),Object(c.a)(t,e,d),[2]}}))}))}},W7wX:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("QjXU"),o=n("MJsD"),i=n("B5kz");function c(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Object(o.a)()];case 1:return t=e.sent(),[2,i.a.fetchQuery(["Identity"],(,{cacheTime:1/0,staleTime:1/0})]}}))}))}},WKCs:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n("QjXU"),o=n("EJjl");function i(t,e,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){return[2,Object(o.a)(t,e,"TuiNewUserState",!1,(,()]}))}))}},"Yh/z":function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n("QjXU"),o=n("8wW2"),i=n("muUJ"),c=n("a3FV"),a=n("CMIS"),u=n("0TX8"),s=n("cy7S"),f=n("oK0o"),d=n("mpo9");function l(t,e,n){var l=this;return new Promise((function(b,v){return Object(r.__awaiter)(l,void 0,void 0,(function(){var l,j,O;return Object(r.__generator)(this,(function(h){switch(h.label){case 0:return Object(d.b)()[t]=Array.isArray(e)?e:Object(r.__assign)({},e),[4,n.getIdentity()];case 1:if(l=h.sent(),n.jwtAuthEnabled&&l.isMsa)return v("User storage does not support roaming"),[2];if(j={headers:{}},!n.inMockMode&&!n.jwtAuthEnabled){if(!(O=f.get("AjaxSessionKey")))return Object(i.a)(c.a.CsrfTokenError),Object(a.a)({eventName:"Csrf_Token",errorType:"User_Storage_Error"}),v("CSRF token missing"),[2];j.headers.AjaxSessionKey=O}return[4,Object(u.a)(j,n.inMockMode,n.workload,n.getIdentity)];case 2:return h.sent(),Object(s.a)(c.a.OfficeHomeStorageWriteRequest,"OfficeHomeStorage_Write","".concat(n.officeHomeApiRoot,"/api/userstorage/").concat(t,"/"),e,j,n.jwtAuthEnabled,n.getAccessToken,n.officeHomeApiRoot,n.correlationId,"OfficeHome",{populateRequestEvent:).then(().catch((function(e){Object(o.a)().handleError(e,"J7GBR"),v("Failed to update or create value in roaming user data storage for <".concat(t,"> key."))})),[2]}}))}))}))}},cy7S:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("QjXU"),o=n("kb6k"),i=n("lAHu");function c(t,e,n,c,a,u,s,f,d,l,b,v){void 0===b&&(b={});var j=Object(r.__assign)(Object(r.__assign)({},a),{url:n,method:"PUT",body:c});return Object(o.a)((function(n){return Object(i.a)(t,e,n,f,d,void 0,b.populateRequestEvent,b.onUploadProgress,b.onDownloadProgress,b.cancellationToken,b.timeoutInMs)}),t,e,j,u,s,l,b.mockParam,b.resourceUrl,b.rpsHeaderPrefix,b.additionalAuthErrors,b.isRetriableError,b.updateRequestWithAuth,void 0,void 0,void 0,v)}},gCKw:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("QjXU"),o=n("MJsD"),i=n("B5kz"),c=n("W7wX"),a=n("XcEc");function u(){var t=this;return i.a.fetchQuery(["FeatureGates"],(function(){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t,e,n;return Object(r.__generator)(this,(function(i){switch(i.label){case 0:return[4,Promise.all([Object(o.a)(),Object(c.a)()])];case 1:return t=r.__read.apply(void 0,[i.sent(),2]),e=t[0],n=t[1],[2,Object(a.a)(n,e)]}}))}))}),{staleTime:1/0,cacheTime:1/0})}},i2XK:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"d",(function(){return o})),n.d(e,"e",(function(){return i})),n.d(e,"b",(function(){return c})),n.d(e,"c",(function(){return a}));var r="FirstRunState",o="SecondRunState",i="TuiNewUserState",c="FirstRunData",a="_"+c},mpo9:function(t,e,n){"use strict";n.d(e,"b",(function(){return f})),n.d(e,"c",(function(){return d})),n.d(e,"a",(function(){return l}));var r,o,i,c=n("E7ar"),a=n("8wW2"),u=!1;function s(){if(!u){u=!0;var t=void 0;try{t=Object(c.a)("userStorageCache")}catch(t){Object(a.a)().handleError(t)}r=t?t.content:{},o=!!t&&t.firstUse,i=t?t.firstUseTimestamp:0}}function f(){return s(),r}function d(){return s(),o},myGd:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("QjXU"),o=n("qnPW"),i=n("xjjT"),c=n("EJjl");function a(t,e,n){var a;return Object(r.__awaiter)(this,void 0,void 0,(function(){var u;return Object(r.__generator)(this,(function(r){return u=(null===(a=null==n?void 0:n.firstRunGates)||void 0===a?void 0:a.firstRunMockEnabled)||!1,[2,Object(c.a)(t,e,"FirstRunState",u,(,i.a)]}))}))}},mzFX:function(t,e,n){"use strict";n.d(e,"a",(function(){return f})),n.d(e,"b",(function(){return d})),n.d(e,"c",(function(){return l}));var r=n("B5kz"),o=n("uuEz"),i=n("i2XK"),c=n("myGd"),a=n("CASw"),u=n("WKCs");function s(t,e){return r.a.fetchQuery([t],Object(o.a)(e),{staleTime:1/0,cacheTime:1/0})}var f=function(){return s(i.a,c.a)},d=function(){return s(i.d,a.a)},l=,oK0o:oKmG:qU2n:function(t,e,n){"use strict";function r(t,e){return e?"officeHome-".concat(e).concat(t):t}n.d(e,"a",(function(){return r}))},qnPW:uuEz:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("QjXU"),o=n("MJsD"),i=n("gCKw"),c=n("W7wX"),a=function(t){return function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,Promise.all([Object(o.a)(),Object(c.a)(),Object(i.a)()])];case 1:return e=r.__read.apply(void 0,[n.sent(),3]),[2,t(e[1],e[0],e[2].result)]}}))}))}}},xjjT:]);
//# sourceMappingURL=685.13395255cd72bd77b211.chunk.v7.js.map