(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[758],{r8hs:function(e,t,i){"use strict";i.r(t),i.d(t,"UpsellButton",();var r=i("QjXU"),n=i("mXGw"),s=i("xARA"),o=i("zvoD"),c=i("y3b+"),a=i("laSs"),l=i("BaAg"),p=n?function(e){function t(t){var i=e.call(this,t)||this;return i.props.installConfigService.config.dimeEnabled&&i.props.upsellDataService.warmupDime("gopremium"),i.launchDime=i.launchDime.bind(i),i}return Object(r.__extends)(t,e),t.prototype.render=function(){return"Start"!==this.props.route&&("MyForms"!==this.props.route||this.props.app!==l.b.Forms)||this.props.app!==l.b.Word&&this.props.app!==l.b.Excel&&this.props.app!==l.b.PowerPoint&&this.props.app!==l.b.Forms&&this.props.app!==l.b.FormsQuiz?null:(this.props.instrumentationService.logImpressionEvent("Upsell_Button_Impression"),Object(a.a)({eventName:"Upsell_Button",area:"Shell"}),n.createElement("a",{id:"upsell-button",style:{lineHeight:"normal"},className:"shell-upsell-button o365sx-button o365sx-highContrastButton",href:this.getHref(),target:this.getTarget(),onClick:this.launchDime,"aria-label":this.props.locService.FirstRunFreeConsumerGoPremium},n.createElement("span",{className:"shell-upsell-button__icon ms-ohp-Icon ms-ohp-Icon--diamond"}),this.props.minimized?null:n.createElement("span",{className:"shell-upsell-button__text"},this.props.locService.FirstRunFreeConsumerGoPremium)))},t.prototype.getHref=function(){return this.props.installConfigService.config.dimeEnabled?"#":this.getUrl()},t.prototype.getTarget=function(){return this.props.installConfigService.config.dimeEnabled?"":this.props.linkTarget},t.prototype.getUrl=function(){var e=this.props.upsellDataService.getUpsellTrackingParam();return this.props.installConfigService.config.shellGoPremiumUrl.replace("{OEM}",e).replace("{APP}",l.b[this.props.app])},t.prototype.launchDime=function(e){this.props.installConfigService.config.dimeEnabled&&(null==e||e.preventDefault(),this.props.upsellDataService.launchDime("gopremium",this.getUrl()))},t}(n.Component):u=i("vSs+"),h=i("hhzZ"),m=i("6nG3"),b=i("hZW2"),g=i("PBJH"),f=function(){function e(e,t,i,n,s,o,c){var a=this;this.consumerInstallConfigService=e,this.contextService=t,this.eventService=i,this.injector=n,this.officeRouteService=s,this.capabilitiesService=o,this.consumerPublicDataService=c,this.isFreeUser=!1;var l=function(e,t){void 0===t&&(t=!1);var i=e&&e.currentSkuInfo?e.currentSkuInfo.skuType:m.b.NotDetected;a.isFreeUser=(i===m.b.NotSubscribed||i===m.b.NonActive)&&!t,a.isFreeUser&&(a.subscribe(),a.eventService.whenEventFired("convertedToPaid",1).then((function(){a.isFreeUser=!1;var e=a.injector.get(b.a),t=e.nativeDocument.getElementById("goPremium");t&&e.addCssClassToElement(t,"element-hidden")})))};this.capabilitiesService.capabilities.workloadPublicDataEnabled?Promise.all([this.consumerPublicDataService.getConfig(),this.consumerInstallConfigService.getConfig()]).then((function(e){var t=Object(r.__read)(e,2);l(t[1],t[0].hasBusinessLicense)})).catch(l):this.consumerInstallConfigService.getConfig().then(l)}return e.prototype.unsubscribe=e.prototype.subscribe=function(){var e=this;this.renderUpsellSubscription=this.eventService.events.withScope(0).pipe(Object(o.a)(()).subscribe((function(t){if(t.args.length){var i=0===t.args[0];i||1===t.args[0]||(e.container=t.args[0]),e.routeChangeEndSubscription=e.officeRouteService.subscribeToRouteChangeEnd((function(t){n&&e.isFreeUser&&s.render(n.createElement(p,{route:t.currentRoute.route,app:t.currentRoute.app,locService:e.injector.get(g.a),instrumentationService:e.injector.get(h.a),upsellDataService:e.injector.get(u.a),installConfigService:e.injector.get(c.a),linkTarget:e.contextService.sharedContext.defaultLinkTarget,minimized:i}),e.container)}))}}))},e}()}}]);
//# sourceMappingURL=758.b379c98f0c9893a55d69.chunk.v7.js.map