(self.webpackChunkhybrid_client=self.webpackChunkhybrid_client||[]).push([[3],{"./node_modules/@video/events-typed/index.js":"./node_modules/@video/log-client/index.js":(e,t,i)=>{"use strict";e.exports=i("./node_modules/@video/log-client/lib/index.js")},"./node_modules/@video/log-client/lib/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoggerCore=void 0;const r=i("./node_modules/tslib/tslib.es6.js");r.__exportStar(i("./node_modules/@video/log-node/index.js"),t);var s=i("./node_modules/@video/log-client/lib/logger-core.js");Object.defineProperty(t,"LoggerCore",{enumerable:!0,get:function(){return s.LoggerCore}}),r.__exportStar(i("./node_modules/@video/log-client/lib/logger-http-writer.js"),t)},"./node_modules/@video/log-client/lib/logger-core.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoggerCore=void 0;const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/@video/log-node/index.js"),o=r.__importDefault(i("./node_modules/debug/src/browser.js")),n=i("./node_modules/events/events.js"),a=i("./node_modules/@video/log-client/lib/logger-http-writer.js"),l=i("./node_modules/@video/log-client/lib/utils/colors.js"),d=e=>{},c=new WeakMap;t.LoggerCore=class{constructor(e){this.debug=d,this.deprecated=d,this.error=d,this.fatal=d,this.info=d,this.local=d,this.network=d,this.notice=d,this.timing=d,this.trace=d,this.warn=d,this.packageContext={meta:{}},this.messageContext={},this.attachedObjects=new Set,this.emitter=new n.EventEmitter,this.printer={},this.lastLogged={},this.name=e,this.packageContext.meta={package:this.name},this.httpWriter=new a.LoggerGlobal,this.httpWriter.registerPackage(this),this.proxyingToEmitter=!1,this.debugLogger=(0,o.default)(this.name),s.LEVELS.forEach(e=>{this[e]=this.log.bind(this,e),this.printer[e]=this.printLog.bind(this,e)})}flush(){this.httpWriter.send()}attachObject(e){return e.on("disposed",,this.attachedObjects.add(e),this}setMessageAggregate(e,t){return void 0===t?this.removeMessageAggregate(e):(null==this.messageContext.aggregates?this.messageContext.aggregates={[e]:t}:this.messageContext.aggregates[e]=t,this)}appendChain(e){var t,i;let r=0;c.has(e)&&(r=c.get(e)+1);const s=null!==(i=null===(t=this.messageContext.aggregates)||void 0===t?void 0:t.chain)&&void 0!==i?i:"",o=""===s?`${e.displayName}#${r}`:`${s}:${e.displayName}#${r}`;return this.setMessageAggregate("chain",o),c.set(e,r),this}removeMessageAggregate(e){return null!=this.messageContext.aggregates&&null!=this.messageContext.aggregates[e]&&(delete this.messageContext.aggregates[e],0===Object.keys(this.messageContext.aggregates).length&&delete this.messageContext.aggregates),this}etLoggerAggregate(e,t){return null==this.packageContext.aggregates?this.packageContext.aggregates={[e]:t}:this.packageContext.aggregates[e]=t,this}setLoggerMeta(e,t){return null==this.packageContext.meta?this.packageContext.meta={[e]:t,package:this.name}:this.packageContext.meta[e]=t,this}getLoggerMeta(e){var t;if((null===(t=this.packageContext)||void 0===t?void 0:t.meta)&&null!=this.packageContext.meta[e])return this.packageContext.meta[e]}log(e,t,i){var r,s;null===(s=null===(r=this.printer)||void 0===r?void 0:r[e])||void 0===s||s.call(r,t,i,this.messageContext.aggregates);const[o,n]=this.handleLogData(t,i,!0),a=Object.assign({message:""+o,level:"trace"===e?"debug":e,time:(new Date).toISOString()},n);this.httpWriter.add(a,this),this.proxyingToEmitter&&this.emitter.emit(e,t,n)}throttledLog(e,t,i,r){var s;(null==this.lastLogged[i]||Date.now()-(null!==(s=this.lastLogged[i])&&void 0!==s?s:0)>t)&&(this.lastLogged[i]=Date.now(),this.log(e,i,r))}handleLogData(e,t,i=!1){var o,n,a;let l="";null!=t||(t={}),e instanceof Error?(l=e.message,(0,s.isSerializableObject)(e)?t.err=e:t.err={message:e.message,name:e.name,stack:e.stack}):l=e;let d={aggregates:{}};try{!function e(t,...i){for(const o of i){if("object"!=typeof o||Array.isArray(o)){console.error("Invalid logger data:",o);continue}if((0,s.isSerializableObject)(o)){e(t,o.toJSON());continue}const{aggregates:i}=o,n=r.__rest(o,["aggregates"]);if("object"==typeof i)for(const[e,r]of Object.entries(i))t.aggregates[e]=r;for(const[e,i]of Object.entries(n))t[e]=null==i?i:JSON.parse(JSON.stringify(i))}}(d,{aggregates:this.packageContext.aggregates},{aggregates:this.messageContext.aggregates},t,...this.attachedObjects)}catch(t){const r=`logging data were dropped because it's not serializable; log message: ${e}; error: ${t};`;i&&this.printLog("error",r),d={aggregates:{chain:null===(o=d.aggregates)||void 0===o?void 0:o.chain,contextId:null===(n=d.aggregates)||void 0===n?void 0:n.contextId,instanceId:null===(a=d.aggregates)||void 0===a?void 0:a.instanceId},__logging_error__:r}}return[l,d]}printLog(e,t,i){var r,s,o,n,a,d,c,u,p,h,m;const[v,g]=this.handleLogData(t,i);switch(e){case"warn":case"error":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?console[e](`${null!==(s=null===(r=g.aggregates)||void 0===r?void 0:r.chain)&&void 0!==s?s:""} ${v}`,g):"undefined"!=typeof window&&"function"==typeof(null===(o=window.console)||void 0===o?void 0:o.error)?window.console[e](`%c ${null!==(a=null===(n=g.aggregates)||void 0===n?void 0:n.chain)&&void 0!==a?a:""} ${v}`,l.browserStyles[e],[g]):this.debugLogger(`%c ${null!==(c=null===(d=g.aggregates)||void 0===d?void 0:d.chain)&&void 0!==c?c:""} ${v}`,l.browserStyles[e],[g]);break;default:"undefined"!=typeof navigator&&"ReactNative"===navigator.product?console.log(`${null!==(p=null===(u=g.aggregates)||void 0===u?void 0:u.chain)&&void 0!==p?p:""} ${v}`,g):this.debugLogger(`%c ${null!==(m=null===(h=g.aggregates)||void 0===h?void 0:h.chain)&&void 0!==m?m:""} ${v}`,l.browserStyles[e],[g])}}proxyToEmitter(e,t){for(const i of t)this.emitter.on(i,;this.proxyingToEmitter=!0}extend(e){var t,i,r;if(null!=(null===(t=null==e?void 0:e.messageContext)||void 0===t?void 0:t.aggregates))for(const[t,i]of Object.entries(e.messageContext.aggregates))this.setMessageAggregate(t,i);if(null!=(null===(i=null==e?void 0:e.packageContext)||void 0===i?void 0:i.aggregates))for(const[t,i]of Object.entries(e.packageContext.aggregates))this.setLoggerAggregate(t,i);if(null!=(null===(r=null==e?void 0:e.packageContext)||void 0===r?void 0:r.meta))for(const[t,i]of Object.entries(e.packageContext.meta))this.setLoggerMeta(t,i);return this}},"./node_modules/@video/log-client/lib/logger-http-writer.js":(e,t,i)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.LoggerGlobal=void 0;const s=i("./node_modules/tslib/tslib.es6.js"),o=i("./node_modules/@video/events-typed/index.js"),n=i("./node_modules/@video/log-node/index.js"),a=s.__importDefault(i("./node_modules/lodash.throttle/index.js")),l=s.__importDefault(i("./node_modules/@video/log-client/lib/package-json.js")),d=s.__importDefault(i("./node_modules/@video/log-client/lib/utils/byteLength.js")),c=i("./node_modules/@video/log-client/lib/utils/supportedLevels.js"),u=i("./node_modules/@video/log-client/lib/utils/uuid.js"),p=null!==(r=globalThis)&&void 0!==r?r:function(){return this}(),h={maxRequestSize:1048576,level:"warn",limit:500,interval:3e4};class m extends o.EventEmitter{constructor(){if(super(),this.options=h,this.storage=[],this.packageContextStorage=[],this.globalContext={meta:{userAgent:"undefined"!=typeof navigator?navigator.userAgent:"unknown",referrer:"undefined"!=typeof document?document.referrer:"unknown",source:"client",logId:(0,u.uuidv4)(),loggerVer:l.default.version}},this.watchTimeout=null,this.loggers=[],this.online=!0,this.throttleSend=(0,a.default)(this.send,5e3),p.LivelyHttpWriterV4)return p.LivelyHttpWriterV4;p.LivelyHttpWriterV4=this,null!=p.addEventListener&&(p.addEventListener("unload",()=>this.send()),p.addEventListener("online",()=>{this.online=!0,this.send()}),i.g.addEventListener("offline",()=>{this.online=!1}))}static setOptions(e){(new m).setOptions(e)}setOptions(e){null!=e.host&&(this.options.host=e.host),null!=e.level&&(this.options.level=e.level),null!=e.maxRequestSize&&(this.options.maxRequestSize=e.maxRequestSize),null!=e.limit&&(this.options.limit=e.limit),null!=e.interval&&(this.options.interval=e.interval),this.resetTimeout()}static setGlobalAggregate(e,t){(new m).setGlobalAggregate(e,t)}setGlobalAggregate(e,t){null==this.globalContext.aggregates?this.globalContext.aggregates={[e]:t}:this.globalContext.aggregates[e]=t}static removeGlobalAggregate(e){(new m).removeGlobalAggregate(e)}removeGlobalAggregate(e){null!=this.globalContext.aggregates&&null!=this.globalContext.aggregates[e]&&(delete this.globalContext.aggregates[e],0===Object.keys(this.globalContext.aggregates).length&&delete this.globalContext.aggregates)}atic setGlobalMetaetGlobalMeta(e,t){null==this.globalContext.meta?this.globalContext.meta={userAgent:"undefined"!=typeof navigator?navigator.userAgent:"unknown",referrer:"undefined"!=typeof document?document.referrer:"unknown",source:"client",logId:(0,u.uuidv4)(),loggerVer:l.default.version,[e]:t}:this.globalContext.meta[e]=t}emoveGlobalMeta(e){null!=this.globalContext.meta&&null!=this.globalContext.meta[e]&&delete this.globalContext.meta[e]}resetTimeout(){this.options.interval&&(null!=this.watchTimeout&&("undefined"!=typeof window?window.clearTimeout(this.watchTimeout):clearTimeout(this.watchTimeout)),null!=this.send&&("undefined"!=typeof window?this.watchTimeout=window.setTimeout(this.send.bind(this),this.options.interval):this.watchTimeout=setTimeout(this.send.bind(this),this.options.interval)))}emovePackagedd(e,t){if((0,c.meetsLevel)(e.level,this.options.level))if(this.storage.push(e),null!=this.options.host&&this.online){if(null!=t){-1===this.packageContextStorage.indexOf(t.packageContext)&&this.packageContextStorage.push(t.packageContext)}(0,c.meetsLevel)(e.level,"error")&&this.throttleSend()}else this.checkStorageLimit()}send(){if(0===this.storage.length)return void this.resetTimeout();if(null==this.options.host)return this.checkStorageLimit(),void this.resetTimeout();const e=this.storage.splice(0,this.options.limit),t={},i={};this.packageContextStorage.forEach(e=>{null!=e.aggregates&&Object.keys(e.aggregates).forEach(i=>{var r;const s=null===(r=e.aggregates)||void 0===r?void 0:r[i];null!=s&&(t[i]=s)}),null!=e.meta&&n.PackageMetaKeys.forEach(t=>{var r;null!=(null===(r=e.meta)||void 0===r?void 0:r[t])&&(i[t]=e.meta[t])})});const r={aggregates:t,meta:i};this.packageContextStorage.splice(0,-1*this.packageContextStorage.length);const s={logs:e,sendTime:(new Date).toISOString(),context:{packageContexts:r,globalContext:this.globalContext}};let o;try{o=JSON.stringify(s)}catch(e){return this.add({level:"error",message:"Failed to stringify in logger",error:""+e,time:(new Date).toISOString()}),void this.resetTimeout()}if((0,d.default)(o)>this.options.maxRequestSize)return this.add({level:"error",message:`Body exceeds maxRequestSize. Dropped ${e.length} logs.`,time:(new Date).toISOString()}),void this.resetTimeout();m.fetch(this.options.host+"/client-logs/v4",{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:o}).then(e=>{if(!e.ok)throw new TypeError(e.status.toString());return this.resetTimeout(),e}).catch(e=>{this.add({level:"network",message:"Network failure.",error:""+e,time:(new Date).toISOString()}),this.resetTimeout()})}checkStorageLimit(){this.storage.length>this.options.limit&&this.storage.slice(-1*this.options.limit)}}t.LoggerGlobal=m,m.fetch="undefined"!=typeof window?window.fetch.bind(window):,"./node_modules/@video/log-client/lib/package-json.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"@video/log-client",version:"5.0.2"}},"./node_modules/@video/log-client/lib/source.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoggerGlobal=void 0;const r=i("./node_modules/@video/log-client/lib/logger-core.js"),s=i("./node_modules/@video/log-client/lib/logger-http-writer.js");Object.defineProperty(t,"LoggerGlobal",{enumerable:!0,get:function(){return s.LoggerGlobal}}),t.default=r.LoggerCore},"./node_modules/@video/log-client/lib/utils/byteLength.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=,"./node_modules/@video/log-client/lib/utils/colors.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ttySyles=t.browserStyles=void 0,t.browserStyles={trace:"color: rgba(169,184,186,0.6)",debug:"color: #a9b8ba",network:"color: #a9b8ba",timing:"color: #a9b8ba",local:"color: #a9b8ba",info:"",warn:"color: #c0a044",notice:"color: #c0a044",deprecated:"color: #c0a044",error:"color: #f44336",fatal:"color: #f44336"},t.ttySyles={trace:"[38;5;239m",debug:"[38;5;239m",network:"[38;5;239m",timing:"[38;5;239m",local:"[38;5;239m",info:"[38;5;231m",warn:"[38;5;226m",notice:"[38;5;226m",deprecated:"[38;5;226m",error:"[38;5;196m",fatal:"[38;5;196m"}},"./node_modules/@video/log-client/lib/utils/supportedLevels.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.supportedLevels=t.meetsLevel=t.supportsLevel=void 0;const i={fatal:0,error:0,warn:1,notice:1,deprecated:1,info:2,local:3,debug:3,timing:3,network:3,trace:3};.supportedLevels=i,t.supportsLevel=r,t.meetsLevel=function(e,t){return!(!r(e)||!r(t))&&i[e]<=i[t]}},"./node_modules/@video/log-client/lib/utils/uuid.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uuidv4=void 0,t.uuidv4=,"./node_modules/@video/log-node/index.js":(e,t,i)=>{"use strict";e.exports=i("./node_modules/@video/log-node/lib/index.js")},"./node_modules/@video/log-node/lib/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PackageMetaKeys=t.LEVELS=t.isSerializableObject=t.isPlainRecord=t.GlobalMetaKeys=t.extractAggregates=void 0;var r=i("./node_modules/@video/log-node/lib/interface.js");Object.defineProperty(t,"extractAggregates",{enumerable:!0,get:function(){return r.extractAggregates}}),Object.defineProperty(t,"GlobalMetaKeys",{enumerable:!0,get:function(){return r.GlobalMetaKeys}}),Object.defineProperty(t,"isPlainRecord",{enumerable:!0,get:function(){return r.isPlainRecord}}),Object.defineProperty(t,"isSerializableObject",{enumerable:!0,get:function(){return r.isSerializableObject}}),Object.defineProperty(t,"LEVELS",{enumerable:!0,get:function(){return r.LEVELS}}),Object.defineProperty(t,"PackageMetaKeys",{enumerable:!0,get:function(){return r.PackageMetaKeys}})},"./node_modules/@video/log-node/lib/interface.js":(e,t)=>{"use strict";function i(e){return null!=e&&"object"==typeof e&&!Array.isArray(e)&&"toJSON"in e&&"function"==typeof e.toJSON}function r(e){return null!=e&&"object"==typeof e&&!Array.isArray(e)&&!i(e)&&!Object.values(e).some(e=>null!=e&&!["number","string","boolean"].includes(typeof e))}Object.defineProperty(t,"__esModule",{value:!0}),t.extractAggregates=t.isPlainRecord=t.isSerializableObject=t.PackageMetaKeys=t.GlobalMetaKeys=t.LEVELS=void 0,t.LEVELS=["trace","debug","network","timing","local","info","warn","notice","deprecated","error","fatal"],t.GlobalMetaKeys=["source","logId","userAgent","referrer","loggerVer"],t.PackageMetaKeys=["package","component","service","release","chain","client","contextId","instanceId","commitHash"],t.isSerializableObject=i,t.isPlainRecord=r,t.extractAggregates=function(e,...t){if(!i(e))return{};const s=e.toJSON();if(null==s||"object"!=typeof s||Array.isArray(s)||i(s))return{};const o=s.aggregates;if(!r(o))return{};for(const e of t)delete o[e];return o}},"./node_modules/@video/video-client-core/index.js":(e,t,i)=>{"use strict";e.exports=i("./node_modules/@video/video-client-core/lib/index.js")},"./node_modules/@video/video-client-core/lib/api/adapter/features/feature.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Feature=void 0,t.Feature||(t.Feature={}))},"./node_modules/@video/video-client-core/lib/api/adapter/features/types.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},"./node_modules/@video/video-client-core/lib/api/adapter/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSafari=t.isMobileDevice=t.isIosDevice=t.isAndroidDevice=t.implement=t.onceDeviceReady=t.device=t.Feature=void 0;const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/@video/video-client-core/lib/internal/adapters/web-device.js"),o=i("./node_modules/@video/video-client-core/lib/api/adapter/features/feature.js");var n=i("./node_modules/@video/video-client-core/lib/api/adapter/features/feature.js");let a;Object.defineProperty(t,"Feature",{enumerable:!0,get:function(){return n.Feature}}),r.__exportStar(i("./node_modules/@video/video-client-core/lib/api/adapter/features/types.js"),t),t.device=new s.WebDevice,t.onceDeviceReady=new Promise(,t.implement=t.isAndroidDevice=function(){return t.device.isAndroidDevice},t.isIosDevice=function(){return t.device.isIosDevice},t.isMobileDevice=t.isSafari=function(){return t.device.isImplements(o.Feature.BROWSER_TYPE)&&"safari"===t.device.browserInfo.name}},"./node_modules/@video/video-client-core/lib/api/deprecated.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},"./node_modules/@video/video-client-core/lib/api/error.js":(e,t)=>{"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.isVideoClientError=t.ErrorCode=void 0,i=t.ErrorCode||(t.ErrorCode={})),t.isVideoClientError=function(e){return e&&e.code&&Object.values(i).includes(e.code)}},"./node_modules/@video/video-client-core/lib/api/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlayerFeature=t.ExistsStreamPolicy=t.isWebrtcFormat=t.isValidFormat=t.isManifest=t.isGenericFormat=t.ErrorCode=t.AdapterFeature=void 0;const r=i("./node_modules/tslib/tslib.es6.js");var s=i("./node_modules/@video/video-client-core/lib/api/adapter/features/feature.js");Object.defineProperty(t,"AdapterFeature",{enumerable:!0,get:function(){return s.Feature}}),r.__exportStar(i("./node_modules/@video/video-client-core/lib/api/adapter/features/types.js"),t),r.__exportStar(i("./node_modules/@video/video-client-core/lib/api/deprecated.js"),t);var o=i("./node_modules/@video/video-client-core/lib/api/error.js");Object.defineProperty(t,"ErrorCode",{enumerable:!0,get:function(){return o.ErrorCode}});var n=i("./node_modules/@video/video-client-core/lib/api/manifest.js");Object.defineProperty(t,"isGenericFormat",{enumerable:!0,get:function(){return n.isGenericFormat}}),Object.defineProperty(t,"isManifest",{enumerable:!0,get:function(){return n.isManifest}}),Object.defineProperty(t,"isValidFormat",{enumerable:!0,get:function(){return n.isValidFormat}}),Object.defineProperty(t,"isWebrtcFormat",{enumerable:!0,get:function(){return n.isWebrtcFormat}});var a=i("./node_modules/@video/video-client-core/lib/api/media-stream-controller.js");Object.defineProperty(t,"ExistsStreamPolicy",{enumerable:!0,get:function(){return a.ExistsStreamPolicy}});var l=i("./node_modules/@video/video-client-core/lib/api/player/features/feature.js");Object.defineProperty(t,"PlayerFeature",{enumerable:!0,get:function(){return l.Feature}}),r.__exportStar(i("./node_modules/@video/video-client-core/lib/api/player/features/types.js"),t)},"./node_modules/@video/video-client-core/lib/api/manifest.js":(e,t)=>{"use strict";function i(e){const t=e;return"object"==typeof t&&"object"==typeof t.origin&&"string"==typeof t.origin.callId}function r(e){const t=e;return"object"==typeof t&&(Array.isArray(t.encodings)||null!=t.substitute)}Object.defineProperty(t,"__esModule",{value:!0}),t.isValidFormat=t.isGenericFormat=t.isWebrtcFormat=t.isManifestObject=t.isManifest=void 0,t.isManifest=function(e){return null!=e&&("string"==typeof e?e.startsWith("http://")||e.startsWith("https://")||e.startsWith("://"):"object"==typeof e&&"formats"in(null!=e?e:{}))},t.isManifestObject=function(e){return null!=e&&("object"==typeof e&&"formats"in(null!=e?e:{}))},t.isWebrtcFormat=i,t.isGenericFormat=r,t.isValidFormat=,"./node_modules/@video/video-client-core/lib/api/media-stream-controller.js":"./node_modules/@video/video-client-core/lib/api/player.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.players=void 0;const r=i("./node_modules/@video/video-client-core/lib/internal/player/flv-http.js"),s=i("./node_modules/@video/video-client-core/lib/internal/player/hlsjs.js"),o=i("./node_modules/@video/video-client-core/lib/internal/player/mediasoup.js"),n=i("./node_modules/@video/video-client-core/lib/internal/player/mp4-ws.js"),a=i("./node_modules/@video/video-client-core/lib/internal/player/native-hls.js"),l=i("./node_modules/@video/video-client-core/lib/internal/player/webrtc.js");t.players={"native-hls":a.NativeHlsPlayer,hlsjs:s.HlsJsPlayer,webrtc:l.WebrtcPlayer,mediasoup:o.MediasoupPlayer,mp4ws:n.Mp4WsPlayer,flvhttp:r.FlvHttpPlayer}},"./node_modules/@video/video-client-core/lib/api/player/features/bitrate-switching.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutoQualityLevel=t.SourceScoreLevel=t.TranscodeScoreLevel=void 0,t.TranscodeScoreLevel||(t.TranscodeScoreLevel={})),t.SourceScoreLevel||(t.SourceScoreLevel={})),t.AutoQualityLevel||(t.AutoQualityLevel={}))},"./node_modules/@video/video-client-core/lib/api/player/features/feature.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Feature=void 0,function(e){e[e.DURATION=0]="DURATION",e[e.CONSUMER=1]="CONSUMER",e[e.MUTED_AUTOPLAY=2]="MUTED_AUTOPLAY",e[e.BITRATE_SWITCHING=3]="BITRATE_SWITCHING",e[e.PLAYER_SELECTOR=4]="PLAYER_SELECTOR",e[e.BROADCAST=5]="BROADCAST"}(t.Feature||(t.Feature={}))},"./node_modules/@video/video-client-core/lib/api/player/features/types.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutoQualityLevel=t.TranscodeScoreLevel=t.SourceScoreLevel=void 0;var r=i("./node_modules/@video/video-client-core/lib/api/player/features/bitrate-switching.js");Object.defineProperty(t,"SourceScoreLevel",{enumerable:!0,get:function(){return r.SourceScoreLevel}}),Object.defineProperty(t,"TranscodeScoreLevel",{enumerable:!0,get:function(){return r.TranscodeScoreLevel}}),Object.defineProperty(t,"AutoQualityLevel",{enumerable:!0,get:function(){return r.AutoQualityLevel}})},"./node_modules/@video/video-client-core/lib/api/player/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Feature=void 0;const r=i("./node_modules/tslib/tslib.es6.js");var s=i("./node_modules/@video/video-client-core/lib/api/player/features/feature.js");Object.defineProperty(t,"Feature",{enumerable:!0,get:function(){return s.Feature}}),r.__exportStar(i("./node_modules/@video/video-client-core/lib/api/player/features/types.js"),t)},"./node_modules/@video/video-client-core/lib/api/typings/dom-exception.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isOverconstrainedError=t.isErrorLike=void 0,t.isErrorLike=function(e){return null!=e&&"object"==typeof e&&(void 0!==e.message&&void 0!==e.name)},t.isOverconstrainedError=,"./node_modules/@video/video-client-core/lib/api/typings/video-element.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isVideoElement=t.MediaErrorCodeConstants=t.isMediaStream=void 0,t.isMediaStream=function(e){return"object"==typeof e&&null!=e&&("getAudioTracks"in e&&"getVideoTracks"in e)},t.MediaErrorCodeConstants||(t.MediaErrorCodeConstants={})),t.isVideoElement=,"./node_modules/@video/video-client-core/lib/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSafari=t.isMobileDevice=t.isIosDevice=t.isAndroidDevice=t.MediaElementSupervisor=t.AutoQualityLevel=t.SourceScoreLevel=t.TranscodeScoreLevel=t.ObservableEventEmitter=t.InstanceCollector=t.makeBounded=t.timeupdateWrapper=t.applyUserInteractionHook=t.instanceId=t.contextId=t.RecorderCore=t.utils=t.CONSTRAINTS_SCREENCAPTURE_OPTIMAL_WEAK=t.CONSTRAINTS_VIDEO_OPTIMAL_WEAK=t.CONSTRAINTS_VIDEO_OPTIMAL_STRICT=t.CONSTRAINTS_AUDIO_OPTIMAL_WEAK=t.CONSTRAINTS_AUDIO_OPTIMAL_STRICT=t.errors=t.player=t.types=t.mediaController=t.VideoClient=t.adapter=void 0;const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/mobx/dist/mobx.esm.js");t.adapter=r.__importStar(i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"));const o=i("./node_modules/@video/video-client-core/lib/internal/media-controller.js"),n=i("./node_modules/@video/video-client-core/lib/internal/utils/debug.js"),a=i("./node_modules/@video/video-client-core/lib/internal/video-client.js");t.VideoClient=a.VideoClient,t.mediaController=o.mediaController,t.types=r.__importStar(i("./node_modules/@video/video-client-core/lib/api/index.js")),t.player=r.__importStar(i("./node_modules/@video/video-client-core/lib/api/player/index.js")),t.errors=r.__importStar(i("./node_modules/@video/video-client-core/lib/internal/errors.js"));var l=i("./node_modules/@video/video-client-core/lib/internal/media-controller.js");Object.defineProperty(t,"CONSTRAINTS_AUDIO_OPTIMAL_STRICT",{enumerable:!0,get:function(){return l.CONSTRAINTS_AUDIO_OPTIMAL_STRICT}}),Object.defineProperty(t,"CONSTRAINTS_AUDIO_OPTIMAL_WEAK",{enumerable:!0,get:function(){return l.CONSTRAINTS_AUDIO_OPTIMAL_WEAK}}),Object.defineProperty(t,"CONSTRAINTS_VIDEO_OPTIMAL_STRICT",{enumerable:!0,get:function(){return l.CONSTRAINTS_VIDEO_OPTIMAL_STRICT}}),Object.defineProperty(t,"CONSTRAINTS_VIDEO_OPTIMAL_WEAK",{enumerable:!0,get:function(){return l.CONSTRAINTS_VIDEO_OPTIMAL_WEAK}}),Object.defineProperty(t,"CONSTRAINTS_SCREENCAPTURE_OPTIMAL_WEAK",{enumerable:!0,get:function(){return l.CONSTRAINTS_SCREENCAPTURE_OPTIMAL_WEAK}}),t.utils=r.__importStar(i("./node_modules/@video/video-client-core/lib/internal/utils/index.js"));var d=i("./node_modules/@video/video-client-core/lib/recorder/index.js");Object.defineProperty(t,"RecorderCore",{enumerable:!0,get:function(){return d.Recorder}});var c=i("./node_modules/@video/video-client-core/lib/utils/common.js");Object.defineProperty(t,"contextId",{enumerable:!0,get:function(){return c.contextId}}),Object.defineProperty(t,"instanceId",{enumerable:!0,get:function(){return c.instanceId}}),Object.defineProperty(t,"applyUserInteractionHook",{enumerable:!0,get:function(){return c.applyUserInteractionHook}});var u=i("./node_modules/@video/video-client-core/lib/internal/player/core.js");Object.defineProperty(t,"timeupdateWrapper",{enumerable:!0,get:function(){return u.timeupdateWrapper}});var p=i("./node_modules/@video/video-client-core/lib/internal/utils/bind.js");Object.defineProperty(t,"makeBounded",{enumerable:!0,get:function(){return p.makeBounded}});var h=i("./node_modules/@video/video-client-core/lib/internal/utils/debug/instance-collector.js");Object.defineProperty(t,"InstanceCollector",{enumerable:!0,get:function(){return h.InstanceCollector}});var m=i("./node_modules/@video/video-client-core/lib/internal/utils/events/event-emitter.js");Object.defineProperty(t,"ObservableEventEmitter",{enumerable:!0,get:function(){return m.ObservableEventEmitter}});var v=i("./node_modules/@video/video-client-core/lib/api/player/features/bitrate-switching.js");Object.defineProperty(t,"TranscodeScoreLevel",{enumerable:!0,get:function(){return v.TranscodeScoreLevel}}),Object.defineProperty(t,"SourceScoreLevel",{enumerable:!0,get:function(){return v.SourceScoreLevel}}),Object.defineProperty(t,"AutoQualityLevel",{enumerable:!0,get:function(){return v.AutoQualityLevel}});var g=i("./node_modules/@video/video-client-core/lib/internal/player/media-element-supervisor.js");Object.defineProperty(t,"MediaElementSupervisor",{enumerable:!0,get:function(){return g.MediaElementSupervisor}});var f=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js");Object.defineProperty(t,"isAndroidDevice",{enumerable:!0,get:function(){return f.isAndroidDevice}}),Object.defineProperty(t,"isIosDevice",{enumerable:!0,get:function(){return f.isIosDevice}}),Object.defineProperty(t,"isMobileDevice",{enumerable:!0,get:function(){return f.isMobileDevice}}),Object.defineProperty(t,"isSafari",{enumerable:!0,get:function(){return f.isSafari}}),(0,s.configure)({observableRequiresReaction:!1,reactionRequiresObservable:!1,enforceActions:"never"}),(0,n.startMobxDebugging)()},"./node_modules/@video/video-client-core/lib/internal/adapters/web-device.js":(e,t,i)=>{"use strict";var r,s,o,n=i("./node_modules/process/browser.js");Object.defineProperty(t,"__esModule",{value:!0}),t.WebDevice=void 0;const a=i("./node_modules/tslib/tslib.es6.js"),l=i("./node_modules/@video/log-client/index.js"),d=a.__importDefault(i("./node_modules/bowser/es5.js")),c=i("./node_modules/@video/video-client-core/lib/api/adapter/features/feature.js"),u=null!==(r=globalThis)&&void 0!==r?r:function(){return this}(),p=null!==(s=n.env.HLSJS_URL)&&void 0!==s?s:"https://cdnjs.cloudflare.com/ajax/libs/hls.js/1.4.5/hls.min.js";const h=null!==(o=n.env.MPEGTS_URL)&&void 0!==o?o:"https://cdn-us.threadsafesystems.com/mpegts.min.js";if("false"!==n.env.MPEGTS_BUNDLED)try{u.mpegts=i("./node_modules/mpegts.js/dist/mpegts.js")}catch(e){}class m extends Error{constructor(e,t){super(`${e} is not supported. ${t||""}`)}}class v{constructor(){var e,t;this.hadUserInteraction=!1,this.canvasElement=null,this.setTimeout=setTimeout.bind(u),this.clearTimeout=clearTimeout.bind(u),this.clearInterval=clearInterval.bind(u);const i=null===(t=null===(e=null==u?void 0:u.navigator)||void 0===e?void 0:e.storage)||void 0===t?void 0:t.estimate;"function"==typeof i&&(this.storageEstimate=i.bind(u.navigator.storage)),this.logger=new l.LoggerCore("VDC-core").setLoggerMeta("client","VDC").appendChain(v),u||this.logger.error("globalScope is undefined"),(null==u?void 0:u.navigator)||this.logger.info("globalScope navigator is undefined"),"object"!=typeof u.__VDC_VARS__&&(u.__VDC_VARS__=new Map),this.globals=u.__VDC_VARS__,this.isImplements(c.Feature.CREATE_CANVAS_ELEMENT)&&(this.canvasElement=this.createCanvasElement()),this.browser=this.parseBrowserInfo()}createConstantSource(e){const t=e.createBufferSource(),i=e.createBuffer(1,1,e.sampleRate),r=i.getChannelData(0);for(let e=0;e<r.length;e++)r[e]=2*Math.random()-1;return t.buffer=i,t.loop=!0,t}applyUserInteractionHook(){var e;this.hadUserInteraction||null==(null===(e=u.document)||void 0===e?void 0:e.body)||null==this.AudioContext||null==this.MediaStream||u.document.body.addEventListener("click",()=>{this.hadUserInteraction=!0;const e=t=new this.AudioContext,i=this.createConstantSource(t),r=t.createGain();r.gain.value=.001,i.connect(r),r.connect(t.destination),i.start();const s=t.createMediaStreamDestination().stream.getAudioTracks()[0],o=new this.MediaStream;o.addTrack(s);const n=u.document.createElement("audio");u.document.body.appendChild(n),n.srcObject=o,n.play().catch(e),setTimeout(()=>{n.remove(),s.stop(),t.close().catch(e)},100)},{once:!0})}arseBrowserInfo(){const e=d.default.getParser(this.userAgent);return{name:null==e?void 0:e.getBrowserName(!0),version:null==e?void 0:e.getBrowserVersion(),osname:null==e?void 0:e.getOSName(!0)}}get browserInfo(){return this.browser}get isIosDevice(){var e;let t=!1;if(null!=this.platform){if("MacIntel"===this.platform&&(null===(e=null==u?void 0:u.navigator)||void 0===e?void 0:e.maxTouchPoints)>1)return!0;t=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(this.platform)}return t}get isAndroidDevice(){let e=!1;return null!=this.userAgent&&(e=/Android/.test(this.userAgent)),e}get isMobileDevice(){var e;let t=!1;return((null===(e=null==u?void 0:u.navigator)||void 0===e?void 0:e.maxTouchPoints)>1||null!=this.userAgent&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(this.userAgent))&&(t=!0),t}get isSafari(){return this.isImplements(c.Feature.BROWSER_TYPE)&&"safari"===this.browserInfo.name}get hiddenet appVersion(){var e,t;return null!==(t=null===(e=null==u?void 0:u.navigator)||void 0===e?void 0:e.appVersion)&&void 0!==t?t:null}get platform(){var e,t;return null!==(t=null===(e=null==u?void 0:u.navigator)||void 0===e?void 0:e.platform)&&void 0!==t?t:null}get supportFullscreen(){const e=u.document.createElement("video"),t=u.document;return!0===u.document.fullscreenEnabled||!0===t.mozFullScreenEnabled||!0===t.msFullscreenEnabled||!0===t.webkitSupportsFullscreen||!0===t.webkitFullscreenEnabled||null!=e.webkitRequestFullScreen||null!=e.webkitEnterFullScreen}get onLine(){var e,t;return null===(t=null===(e=null==u?void 0:u.navigator)||void 0===e?void 0:e.onLine)||void 0===t||t}get locationet userAgent(){var e,t;return null!==(t=null===(e=null==u?void 0:u.navigator)||void 0===e?void 0:e.userAgent)&&void 0!==t?t:"<unknown ua>"}get permissions(){var e;return null===(e=null==u?void 0:u.navigator)||void 0===e?void 0:e.permissions}addEventListener(e,t){null!=u.addEventListener&&u.addEventListener(e,t)}removeEventListeneretInterval(e,t){return u.setInterval(e,t)}get console(){return u.console}et URLSearchParams(){return u.URLSearchParams}et MediaRecorder(){return u.MediaRecorder}get MediaStream(){return u.MediaStream}get WebSocketClient(){return u.WebSocketClient}get RTCRtpReceiver(){return u.RTCRtpReceiver}get RTCRtpSender(){return u.RTCRtpSender}get Uint8Array(){return u.Uint8Array}matchMedia(e){return null==u?void 0:u.matchMedia(e)}get mediaDeviceset connection(){var e,t,i,r,s;return null!==(r=null!==(t=null===(e=null==u?void 0:u.navigator)||void 0===e?void 0:e.connection)&&void 0!==t?t:null===(i=null==u?void 0:u.navigator)||void 0===i?void 0:i.mozConnection)&&void 0!==r?r:null===(s=null==u?void 0:u.navigator)||void 0===s?void 0:s.webkitConnection}get localStorage(){return u.localStorage}get performance(){return u.performance}get screenOrientation(){var e,t,i;const r=u.screen;return null!==(i=null!==(t=(null!==(e=r.orientation)&&void 0!==e?e:{}).type)&&void 0!==t?t:r.mozOrientation)&&void 0!==i?i:r.msOrientation}get MediaSource(){return u.MediaSource||u.WebKitMediaSource}get WebSocket(){return u.WebSocket}et Hls(){return u.Hls}reateVideoElement(){const e=u.document.createElement("video");e.autoplay=!0,e.setAttribute("webkit-playsinline","true"),e.setAttribute("playsinline","true");const t=u.document.createTextNode("Sorry, your browser doesn't support embedded videos.");return e.appendChild(t),e}reateScreenshot(e){const t=this.canvasElement;if(null==t)return"";t.width=e.videoWidth,t.height=e.videoHeight;return t.getContext("2d").drawImage(e,0,0,t.width,t.height),t.toDataURL()}supportsMediaStreamCapture(e){const t=null==e?void 0:e.captureStream;return t}createVideoStub(){throw new Error("not implemented")}disableCpuStats(){}enableCpuStats(){}HlsLoaded(){try{return null!=this.Hls}catch(e){return!1}}loadHlsScript(e){if(null!=this.hlsPromise)return this.hlsPromise;if(this.isHlsLoaded())return Promise.resolve();const t=null!=e?e:p;return this.hlsPromise=new Promise((e,i)=>{if(this.isHlsLoaded())return void e();const r=u.document.createElement("script");r.setAttribute("src",null!=t?t:""),r.onload=()=>{this.isHlsLoaded()?e():i(new Error("hlsjs not loaded"))},r.onerror=e=>{i(new Error("hlsjs not loaded: "+e))},u.document.body.appendChild(r)}),this.hlsPromise}get mpegts(){return u.mpegts}isMpegtsLoaded(){try{return null!=this.mpegts}catch(e){return!1}}loadMpegtsScript(e){if(null!=this.mpegtsPromise)return this.mpegtsPromise;if(this.isMpegtsLoaded())return Promise.resolve();const t=null!=e?e:h;return this.mpegtsPromise=new Promise((e,i)=>{if(this.isMpegtsLoaded())return void e();const r=u.document.createElement("script");r.setAttribute("src",null!=t?t:""),r.onload=()=>{this.isMpegtsLoaded()?e():i(new Error("mpegts not loaded"))},r.onerror=e=>{i(new Error("mpegts not loaded: "+e))},u.document.body.appendChild(r)}),this.mpegtsPromise}showSaveFilePickert isFirefox(){return"firefox"===this.browserInfo.name}isImplements(e){var t,i;try{switch(e){case c.Feature.NETWORK_INFORMATION:return null!=this.location;case c.Feature.CREATE_VIDEO_ELEMENT:return null!=u.document&&null!=this.createVideoElement;case c.Feature.CREATE_CANVAS_ELEMENT:return null!=u.document&&null!=this.createCanvasElement;case c.Feature.CREATE_SCREENSHOT:return null!=(null===(t=this.canvasElement)||void 0===t?void 0:t.getContext);case c.Feature.DEBUGGING:return null!=this.console&&null!=this.performance;case c.Feature.SCREEN_ORIENTATION:return null!=this.screenOrientation;case c.Feature.MEDIA_RECORDER:return null!=this.MediaRecorder;case c.Feature.APPLY_CONSTRAINTS:return!0;case c.Feature.MEDIA_DEVICE:return null!=this.mediaDevices;case c.Feature.MATCH_MEDIA:return null!=this.matchMedia;case c.Feature.MEDIA_STREAM:return null!=this.MediaStream;case c.Feature.MEDIA_SOURCE:return null!=this.MediaSource&&null!=this.SourceBuffer;case c.Feature.WEB_SOCKET:case c.Feature.WEB_SOCKET_CLIENT:return null!=this.WebSocket;case c.Feature.LOCAL_STORAGE:try{return null!=this.localStorage}catch(e){return!1}case c.Feature.AUDIO_CONTEXT:return null!=this.AudioContext;case c.Feature.URL_LOCATION:return null!=this.location;case c.Feature.URL_SEARCHPARAMS:return null!=this.URLSearchParams;case c.Feature.CPU_USAGE:return!1;case c.Feature.HLSJS:return!0;case c.Feature.PERMISSIONS:return null!=this.permissions;case c.Feature.WEBRTC:return null!=(null===(i=this.RTCRtpReceiver)||void 0===i?void 0:i.getCapabilities)&&null!=this.RTCRtpSender;case c.Feature.MPEGTS:return!0;case c.Feature.BROWSER_TYPE:return""!==this.browserInfo.name&&""!==this.browserInfo.version&&""!==this.browserInfo.osname;default:return!1}}catch(e){if(e instanceof m)return!1;throw e}}}t.WebDevice=v,v.displayName="WebDevice"},"./node_modules/@video/video-client-core/lib/internal/broadcast.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Broadcast=void 0;const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/@video/video-client-core/node_modules/@video/log-node/index.js"),o=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/index.js"),n=i("./node_modules/mobx/dist/mobx.esm.js"),a=i("./node_modules/@video/video-client-core/lib/internal/errors-deprecated.js"),l=i("./node_modules/@video/video-client-core/lib/internal/utils/context/context.js"),d=i("./node_modules/@video/video-client-core/lib/internal/utils/events/event-emitter.js");class c extends d.ObservableEventEmitter{constructor(e,t,i,r,s){var o;super(),this.state="active",this.lastTrafficTS=0,this.lastTrafficBitrate=[],(0,n.makeObservable)(this,{state:n.observable});const d=null==i?void 0:i.streams[s.streamName];if(null==i||null==d)throw new a.StreamNotFoundError("stream not found",{call:t,broadcast:this});this.ctx=e,this.ctrl=r,this.call=t,this.pvcCall=i,this.stream=d,this.options=s,this.options.simulcast&&(this.options.videoProducerOptions=null!==(o=this.options.videoProducerOptions)&&void 0!==o?o:{},this.options.videoProducerOptions.simulcast=this.options.simulcast),this.call.isOwner&&(this.lastTrafficTS=Date.now(),i.on("webrtc-stats",this.bitrateObserver)),r.on("audioDeviceChanged",this.onAudioDeviceChanged),r.on("videoDeviceChanged",this.onVideoDeviceChanged),r.on("audioMuted",this.onAudioMuted),r.on("videoPaused",this.onVideoPaused),e.logger.attachObject(this),e.logger.trace("constructor()"),this.sourceUpdate().catch(e=>{this.emitErrorDeprecated(new a.UpdateBroadcastError("initial source update error",{broadcast:this,call:this.call,inner:(0,a.wrapNativeError)(e)}))}),(0,l.onceCanceled)(e).then(e=>this.dispose("Broadcast Class Context Cancelled: "+e)),this.addInnerDisposer(()=>{try{this.stop()}catch(e){this.ctx.logger.warn("unable to stop broadcast while disposing",{err:""+e})}this.options.disposeController&&this.ctrl.dispose("Broadcast options are set to disposeController")})}get streamName(){return this.options.streamName}get audioMuted(){return this.ctrl.audioMuted}set audioMuted(e){this.ctrl.audioMuted=e}get videoHidden(){return this.ctrl.videoPaused}set videoHidden(e){this.ctrl.videoPaused=e}bitrateObserver(e){var t,i,r;if("producer"!==e.kind||null==this.options.zeroBitrate)return;const s=null!==(t=this.options.zeroBitrate.timeout)&&void 0!==t?t:3e4,o=null!==(i=this.options.zeroBitrate.dropPercent)&&void 0!==i?i:.04;let n=null!==(r=e.videoBitrate)&&void 0!==r?r:0;"total"===this.options.zeroBitrate.kind&&(n+=e.audioBitrate);const a=0===this.lastTrafficBitrate.length?0:this.lastTrafficBitrate.reduce(0)/this.lastTrafficBitrate.length;if(n>a*o)this.lastTrafficTS=Date.now(),this.lastTrafficBitrate.push(n),this.lastTrafficBitrate.length>10&&this.lastTrafficBitrate.unshift();else if(Date.now()-this.lastTrafficTS>s){const e=1-n/a;this.ctx.logger.warn("zero bitrate",{drop:e,timeout:s,meanBitrate:a,lastBitrate:n}),this.emit("zeroBitrate",{call:this.call,broadcast:this,drop:e})}}pause(){null!=this.ctrl.audioDeviceId&&this.stream.pauseAudio(),null!=this.ctrl.videoDeviceId&&this.stream.pauseVideo(),this.state="paused"}get controller(){return this.ctrl}replaceController(e){this.ctrl=e}resume(){null!=this.ctrl.audioDeviceId&&this.stream.enableAudio(this.options.audioProducerOptions).then(()=>{this.state="active"}).catch(e=>{this.emitErrorDeprecated(new a.UpdateBroadcastError("unable to resume audio device",{broadcast:this,call:this.call,inner:(0,a.wrapNativeError)(e)}))}),null!=this.ctrl.videoDeviceId&&this.stream.enableVideo(this.options.videoProducerOptions).then(()=>{this.state="active"}).catch(e=>{this.emitErrorDeprecated(new a.UpdateBroadcastError("unable to resume video device",{broadcast:this,call:this.call,inner:(0,a.wrapNativeError)(e)}))})}stop(){this.ctx.logger.debug("stop()"),this.state="closed",this.stream.close(),this.ctrl.off("source",this.sourceUpdate),this.ctrl.off("audioDeviceChanged",this.onAudioDeviceChanged),this.ctrl.off("videoDeviceChanged",this.onVideoDeviceChanged),this.ctrl.off("audioMuted",this.onAudioMuted),this.ctrl.off("videoPaused",this.onVideoPaused),this.pvcCall.off("webrtc-stats",this.bitrateObserver),this.pvcCall.removeStream(this.stream.streamName)}sourceUpdate(){var e,t;return r.__awaiter(this,void 0,void 0,(function*(){if(this.ctx.logger.debug("sourceUpdate()",{audio:this.ctrl.audioDeviceId,video:this.ctrl.videoDeviceId}),null==this.ctrl.videoDeviceId||this.ctrl.videoPaused||this.options.audioOnly||this.ctrl.videoDisabled)this.options.audioOnly&&this.ctx.logger.debug("Broadcast is set to audioOnly, video not produced",{options:this.options});else{const i=this.pvcCall._closed||(null===(e=this.pvcCall.peer)||void 0===e?void 0:e._closed);try{yield this.pvcCall.enableVideo(this.options.videoProducerOptions,this.stream.streamName,!0)}catch(e){const r=this.pvcCall._closed||(null===(t=this.pvcCall.peer)||void 0===t?void 0:t._closed);if(!i&&r)return;this.emitErrorDeprecated(new a.EnableVideoError("unable to enable video on `source` event",{inner:(0,a.wrapNativeError)(e),broadcast:this,call:this.call}))}}if(null==this.ctrl.audioDeviceId||this.ctrl.audioMuted||this.options.videoOnly)this.options.videoOnly&&this.ctx.logger.debug("Broadcast is set to videoOnly, audio not produced",{options:this.options});else try{yield this.pvcCall.enableAudio(this.options.audioProducerOptions,this.stream.streamName,!0)}catch(e){this.emitErrorDeprecated(new a.EnableAudioError("unable to enable audio on `source` event",{inner:(0,a.wrapNativeError)(e),broadcast:this,call:this.call}))}}))}onAudioDeviceChanged(e){return r.__awaiter(this,void 0,void 0,(function*(){if(this.ctx.logger.debug("audioDeviceChanged()",{device:e}),null==e)try{yield this.pvcCall.disableAudio(this.stream.streamName)}catch(e){if(e instanceof o.types.InvalidStateError&&"track ended"===e.message)return void this.ctx.logger.warn("broadcast has not been updated because the audio track is ended");const t=e instanceof Error?e:null;this.emitErrorDeprecated(new a.DisableAudioError("unable to disable audio on `audioDeviceChanged` event",{inner:t,broadcast:this,call:this.call}))}else try{yield this.pvcCall.enableAudio(this.options.audioProducerOptions,this.stream.streamName,!0)}catch(e){if(e instanceof o.types.InvalidStateError&&"track ended"===e.message)return void this.ctx.logger.warn("broadcast has not been updated because the audio track is ended");const t=e instanceof Error?e:null;this.emitErrorDeprecated(new a.EnableAudioError("unable to enable audio on `audioDeviceChanged` event",{inner:t,broadcast:this,call:this.call}))}}))}onVideoDeviceChanged(e){return r.__awaiter(this,void 0,void 0,(function*(){if(this.ctx.logger.debug("videoDeviceChanged()",{device:e}),null==e)try{yield this.pvcCall.disableVideo(this.stream.streamName)}catch(e){if(e instanceof o.types.InvalidStateError&&"track ended"===e.message)return void this.ctx.logger.warn("broadcast has not been updated because the video track is ended");const t=e instanceof Error?e:null;this.emitErrorDeprecated(new a.DisableVideoError("unable to disable video on `videoDeviceChanged` event",{inner:t,broadcast:this,call:this.call}))}else try{yield this.pvcCall.enableVideo(this.options.videoProducerOptions,this.stream.streamName,!0)}catch(e){if(e instanceof o.types.InvalidStateError&&"track ended"===e.message)return void this.ctx.logger.warn("broadcast has not been updated because the video track is ended");this.emitErrorDeprecated(new a.EnableVideoError("unable to enable video on `videoDeviceChanged` event",{inner:(0,a.wrapNativeError)(e),broadcast:this,call:this.call}))}}))}onAudioMuted(e){return r.__awaiter(this,void 0,void 0,(function*(){if(this.ctx.logger.debug("audioMuted()",{value:e}),this.ctrl.hasActiveAudioTrack())if(e)try{yield this.pvcCall.muteAudio(this.stream.streamName)}catch(e){this.emitErrorDeprecated(new a.EnableAudioError("unable to mute audio on `audioMuted` event",{inner:(0,a.wrapNativeError)(e),broadcast:this,call:this.call}))}else try{yield this.pvcCall.unmuteAudio(this.stream.streamName,this.options.audioProducerOptions)}catch(e){this.emitErrorDeprecated(new a.DisableAudioError("unable to unmute audio on `audioMuted` event",{inner:(0,a.wrapNativeError)(e),broadcast:this,call:this.call}))}}))}onVideoPaused(e){return r.__awaiter(this,void 0,void 0,(function*(){if(this.ctx.logger.debug("videoPaused()",{value:e}),this.ctrl.hasActiveVideoTrack())if(e)try{yield this.pvcCall.pauseVideo(this.stream.streamName)}catch(e){const t=e instanceof Error?e:null;this.emitErrorDeprecated(new a.DisableVideoError("unable to pause video on `videoPaused` event",{inner:t,broadcast:this,call:this.call}))}else try{yield this.pvcCall.unpauseVideo(this.stream.streamName,this.options.videoProducerOptions)}catch(e){const t=e instanceof Error?e:null;this.emitErrorDeprecated(new a.EnableVideoError("unable to unpause video on `videoPaused` event",{inner:t,broadcast:this,call:this.call}))}}))}hotswapProducer(e,t){return r.__awaiter(this,void 0,void 0,(function*(){this.ctx.logger.debug("hotswapProducer()",{kind:e,producerOptions:t}),yield this.pvcCall.hotswapProducer(e,this.streamName,t)}))}toJSON(){return{msc:this.controller,stream:this.stream,options:this.options,aggregates:Object.assign(Object.assign({},(0,s.extractAggregates)(this.stream,"support")),{support:this.ctx.support.hash,state:this.state})}}}t.Broadcast=c,c.displayName="Broadcast"},"./node_modules/@video/video-client-core/lib/internal/call.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Call=void 0;const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/@video/log-client/lib/index.js"),o=i("./node_modules/@video/video-client-core/node_modules/@video/log-node/lib/index.js"),n=i("./node_modules/mobx/dist/mobx.esm.js"),a=i("./node_modules/@video/video-client-core/lib/api/index.js"),l=i("./node_modules/@video/video-client-core/lib/utils/common.js"),d=i("./node_modules/@video/video-client-core/lib/internal/broadcast.js"),c=i("./node_modules/@video/video-client-core/lib/internal/client-stats/client-stats.js"),u=i("./node_modules/@video/video-client-core/lib/internal/errors.js"),p=i("./node_modules/@video/video-client-core/lib/internal/errors-deprecated.js"),h=i("./node_modules/@video/video-client-core/lib/internal/peer.js"),m=r.__importDefault(i("./node_modules/@video/video-client-core/lib/internal/pvc/call/call.js")),v=i("./node_modules/@video/video-client-core/lib/internal/utils/bind.js"),g=i("./node_modules/@video/video-client-core/lib/internal/utils/context/context.js"),f=i("./node_modules/@video/video-client-core/lib/internal/utils/events/event-emitter.js"),b=i("./node_modules/@video/video-client-core/lib/internal/utils/logger.js"),_=i("./node_modules/@video/video-client-core/lib/internal/utils/proxy/events-handler.js"),y=r.__importDefault(i("./node_modules/@video/video-client-core/lib/internal/utils/request/request.js")),w=i("./node_modules/@video/video-client-core/lib/internal/utils/retry.js"),S=r.__importDefault(i("./node_modules/@video/video-client-core/lib/internal/utils/auth/auth-core.js")),E=new _.EventsHandler;class C extends f.ObservableEventEmitter{constructor(e,t,i,r=null){super(!1),this.state="active",this.failover=[],this.failoverCallUrls=[],this.region=null,this.auth=void 0,this.pvcCall=null,this.connectedPeers=[],this.joinUrl=null,this.failoverJoinUrls=[],this.broadcasts=new Map,this.isOwner=!1,(0,n.makeObservable)(this,{broadcasts:n.observable}),this.ctx=e,(0,g.onceCanceled)(e).then(e=>this.dispose("VideoClient Context Cancelled: "+e));const s=(0,v.makeBounded)(new Proxy(this,E));return s.init(t,i,r),e.logger.attachObject(s),e.logger.trace("constructor()"),s}init(e,t,i){var o,n,d,p,h,m;if(this.isOwner=e,this.options=t,0===(null!==(n=null===(o=t.backendEndpoints)||void 0===o?void 0:o.length)&&void 0!==n?n:0)&&null==this.options.sfu.joinUrl&&this.throwError((0,u.createError)(a.ErrorCode.NoBackendEndpoints,"backendEndpoints or joinUrl are required",{})),this.joinUrl=null!==(d=this.options.sfu.joinUrl)&&void 0!==d?d:null,null!=t.backendEndpoints){const[e,...i]=t.backendEndpoints;this.backendEndpoint=e,this.failover=i,this.callUrl=e+"/lb/calls",this.failoverCallUrls=i.map(,null==this.joinUrl&&(this.joinUrl=`${this.backendEndpoint}/lb/v2/calls/${this.options.callId}/join`,this.failoverJoinUrls=this.failover.map()}"string"==typeof t.token?this.token=t.token:this.tokenRefresher=t.token,null!=t.callId&&this.emit("callId",{callId:t.callId,user:null!==(h=null===(p=this.pvcCall)||void 0===p?void 0:p.user)&&void 0!==h?h:null}),this.auth=new S.default({bootstrap:{token:this.token,refreshToken:this.tokenRefresher}});const{callId:v}=this.options;this.clientStats=null;const g=null!==(m=t.sfu)&&void 0!==m?m:{};this.readyPromise=(()=>r.__awaiter(this,void 0,void 0,(function*(){if(null!=this.backendEndpoint){let e=null;e=-1!==this.backendEndpoint.indexOf("https")?"wss://"+this.backendEndpoint.substring(8):-1!==this.backendEndpoint.indexOf("http")?"ws://"+this.backendEndpoint.substring(7):"ws://"+this.backendEndpoint,-1!==this.backendEndpoint.indexOf("localhost")&&(e="ws://localhost:9002"),t.stats&&(this.clientStats=new c.ClientStats(e,new s.LoggerCore(l.PACKAGE_NAME).extend(this.ctx.logger).setLoggerMeta("chain",this.ctx.chain+":ClientStats"))),this.addInnerDisposer(()=>{var e;try{null===(e=this.clientStats)||void 0===e||e.close()}catch(e){}})}const e=yield(0,w.retry)(0,1e3,this.createInternalCall.bind(this,v,t,i,g),this.ctx.logger);this.pvcCall=e,e.on("webrtc-stats",this.handleWebrtcStats)})))(),this.addInnerDisposer(this.close)}createInternalCall(e,t,i,s,o){var n,l;return r.__awaiter(this,void 0,void 0,(function*(){let r;if(null==e)null==this.callUrl&&this.throwError((0,u.createError)(a.ErrorCode.NoBackendEndpoints,"backendEndpoints or joinUrl are required",{})),r=yield this.createCallAndJoin(t,s);else{const a=null===(n=t.playerOptions)||void 0===n?void 0:n.retryCall;o>0&&a&&(null==i||delete i.call),r=yield this.joinCall(e,s,i)}return r.on("error",e=>{this.emit("error",e)}),this.emit("callId",{callId:r.call.id,user:null!==(l=r.user)&&void 0!==l?l:null}),r.on("CALL_ADD_PEER",this.handleAddPeer),r.on("CALL_REMOVE_PEER",this.handleRemovePeer),r.on("CALL_SFU_CONNECTION",,r.on("webrtc-stats",e=>{this.emit("webrtcStats",{stats:e})}),r.on("webrtc-stats-raw",,r.on("CALL_DOMINANT_SPEAKER",e=>{this.emit("dominantSpeaker",e)}),this[_.addProxy](r),r.on("CALL_PRODUCER_KICKED",()=>{this.emit("viewerKicked")}),r.on("CALL_PEER_AT_CAPACITY",e=>{this.emit("peerAtCapacity",e)}),r.on("CALL_ACCESS_DENIED",e=>{this.emit("accessDenied",e)}),r.on("CALL_CONNECTING",e=>{this.emit("isConnecting",e)}),r.on("CALL_SET_CONNECTED",({connected:e})=>{this.emit("isConnected",e)}),r.on("CALL_WEBSOCKET_RECONNECT",()=>{this.emit("websocketReconnect")}),new Promise((e,t)=>{r.start().catch(e=>{t((0,u.createError)(a.ErrorCode.UnableJoinCall,"Unable to start call",{},e)),r.dispose("Join call error: "+String(e))}),r.once("CALL_READY",})}))}et peers(){return this.connectedPeers}handleAddPeer({peer:e}){var t,i,r,s,o,n;if(null==this.pvcCall)return void this.ctx.logger.warn("handleAddPeer() call is null",{aggregates:{peerId:null!==(t=e.peerId)&&void 0!==t?t:"",displayName:null!==(i=e.displayName)&&void 0!==i?i:"",scope:null!==(r=e.scope)&&void 0!==r?r:""}});if(this.connectedPeers.some(t=>t.peerId===e.id))return void this.ctx.logger.debug("handleAddPeer() peer already exists",{aggregates:{peerId:null!==(s=e.peerId)&&void 0!==s?s:"",displayName:null!==(o=e.displayName)&&void 0!==o?o:"",scope:null!==(n=e.scope)&&void 0!==n?n:""}});const a=new h.Peer((0,b.extendContext)(this.ctx,h.Peer),this,this.pvcCall,e,this.options.playerOptions);this.connectedPeers.push(a),this[_.addProxy](a),this.ctx.logger.debug("handleAddPeer() peer added",a),this.emit("peerAdded",{call:this,peer:a})}handleRemovePeer({peerId:e}){const t=this.connectedPeers.findIndex(t=>t.peerId===e);if(-1!==t){const e=this.peers.splice(t,1)[0];e instanceof h.Peer&&(this.ctx.logger.debug("handleRemovePeer() peer removed",e),e.dispose("removing peer")),this.emit("peerRemoved",{call:this,peer:e})}}handleWebrtcStats(e){var t,i;if("producer"===e.kind){const t=e;t.videoMediaSourceFrameWidth&&t.videoMediaSourceFrameHeight&&0===t.videoBitrate&&this.ctx.logger.warn("handleWebrtcStats() producer sending 0 bitrate for video",t)}null!=(null===(t=this.options.stats)||void 0===t?void 0:t.app)&&null!=this.options.stats.userId&&(null===(i=this.clientStats)||void 0===i||i.push({measurement:"producer"===e.kind?"ProducerStats":"ConsumerStats",tags:this.options.stats,fields:e,timestamp:Date.now()}))}ready(){return r.__awaiter(this,void 0,void 0,(function*(){return yield this.readyPromise,this}))}createCall(e){var t;return r.__awaiter(this,void 0,void 0,(function*(){null==this.callUrl&&this.throwErrorDeprecated(new p.ValidationError("callUrl is null",{critical:!0}));const i={mode:"broadcast",region:null!==(t=this.region)&&void 0!==t?t:"",msVersion:[3]};Object.assign(i,e),this.ctx.logger.info("call creation",{callUrl:this.callUrl,auth:{token:this.token,hasRefreshToken:null!=this.tokenRefresher},body:i});const r=yield(0,y.default)(this.ctx,this.callUrl,{auth:this.auth,method:"post",body:JSON.stringify(i),failoverUrls:this.failoverCallUrls});return null!=r?r.body:(this.ctx.logger.error("response is null",Object.assign({callUrl:this.callUrl,auth:{token:this.token,hasRefreshToken:null!=this.tokenRefresher}},i)),null)}))}createCallAndJoin(e,t={}){var i,s;return r.__awaiter(this,void 0,void 0,(function*(){null!=(null===(i=this.options)||void 0===i?void 0:i.clientReferrer)&&(e.clientReferrer=this.options.clientReferrer);const r=yield this.createCall(e),o=null!==(s=null==r?void 0:r.id)&&void 0!==s?s:"";return(0,m.default)(this.ctx,o,`${this.backendEndpoint}/lb/v2/calls/${o}/join`,Object.assign({auth:this.auth,failoverUrls:this.failover.map(,stats:this.options.stats},t),this)}))}joinCall(e,t={},i=null){return r.__awaiter(this,void 0,void 0,(function*(){null==this.joinUrl&&this.throwErrorDeprecated(new p.ValidationError("joinUrl is null",{}));const r=Object.assign(Object.assign({},this.options.sfu),t);return(0,m.default)(this.ctx,e,this.joinUrl,Object.assign(Object.assign({auth:this.auth,failoverUrls:this.failoverJoinUrls},r),{stats:this.options.stats}),this,i)}))}broadcast(e,t){var i;return r.__awaiter(this,void 0,void 0,(function*(){null==this.pvcCall&&this.throwErrorDeprecated(new p.InternalCallError("call is not started; pvcCall is null",{})),(null!=this.pvcCall.streams[t.streamName]||this.broadcasts.has(t.streamName))&&this.throwErrorDeprecated(new p.StreamExistsError("stream name already exists",{broadcast:null!==(i=this.broadcasts.get(t.streamName))&&void 0!==i?i:{},call:this})),this.ctx.logger.debug("starting broadcast",{hasAudio:e.hasActiveAudioTrack(),hasVideo:e.hasActiveVideoTrack(),broadcastOptions:t}),this.pvcCall.setStream(t.streamName,{audio:{streamProvider:e},video:{streamProvider:e}});const r=new d.Broadcast((0,b.extendContext)(this.ctx,d.Broadcast),this,this.pvcCall,e,t);return this[_.addProxy](r),r.once("disposed",()=>{this.broadcasts.delete(t.streamName),this[_.removeProxy](r)}),this.broadcasts.set(t.streamName,r),r}))}close(e="Implementer did not pass debugString"){var t,i,r,s;if(null!=this.auth&&this.auth.destroy(),"closed"!==this.state){null===(t=this.pvcCall)||void 0===t||t.off("CALL_ADD_PEER",this.handleAddPeer),null===(i=this.pvcCall)||void 0===i||i.off("CALL_REMOVE_PEER",this.handleRemovePeer),null===(r=this.pvcCall)||void 0===r||r.off("webrtc-stats",this.handleWebrtcStats);try{null===(s=this.pvcCall)||void 0===s||s.close(e)}catch(e){}this.connectedPeers.splice(0,this.connectedPeers.length),(0,g.cancel)(this.ctx,"Call has been closed"),this.emit("callClosed",{callId:this.id}),this.state="closed"}}kickViewer(e,t,i=!1){var s;return r.__awaiter(this,void 0,void 0,(function*(){return null===(s=this.pvcCall)||void 0===s?void 0:s.kickViewer(e,t,i)}))}kickPeer(e,t,i){var s;return r.__awaiter(this,void 0,void 0,(function*(){return null===(s=this.pvcCall)||void 0===s?void 0:s.kickPeer(e,t,i)}))}promoteViewer(e,t,i=!1){var s;return r.__awaiter(this,void 0,void 0,(function*(){return null===(s=this.pvcCall)||void 0===s?void 0:s.promoteViewer(e,t,i)}))}demoteViewer(e,t,i=!1){var s;return r.__awaiter(this,void 0,void 0,(function*(){return null===(s=this.pvcCall)||void 0===s?void 0:s.demoteViewer(e,t,i)}))}toJSON(){var e,t,i,r;return{callUrl:this.callUrl,joinUrl:this.joinUrl,backendEndpoint:this.backendEndpoint,peersIds:this.connectedPeers.map(e=>e.peerId),options:{callId:null===(e=this.options)||void 0===e?void 0:e.callId,backendEndpoints:null===(t=this.options)||void 0===t?void 0:t.backendEndpoints,playerOptions:null===(i=this.options)||void 0===i?void 0:i.playerOptions,sfu:null===(r=this.options)||void 0===r?void 0:r.sfu},aggregates:Object.assign(Object.assign({},(0,o.extractAggregates)(this.pvcCall,"support")),{support:this.ctx.support.hash,state:this.state})}}}t.Call=C,C.displayName="Call"},"./node_modules/@video/video-client-core/lib/internal/client-stats/client-stats.js":(e,t,i)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ClientStats=void 0;const s=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),o=null!==(r=globalThis)&&void 0!==r?r:function(){return this}();t.ClientStats=class{penWebsocket(e){var t,i;if((null===(t=null==o?void 0:o.livelyWebsocketV1)||void 0===t?void 0:t.readyState)>0)this.ws=o.livelyWebsocketV1,this.websocketOpen=!0;else{if(!s.device.isImplements(s.Feature.WEB_SOCKET_CLIENT))throw new Error("No websocket client found");this.ws=new s.device.WebSocketClient({websocketUri:this.websocketUri,logger:this.logger,plugin:"client-stats",version:"v2"},void 0,{maxReconnectInterval:15e3,reconnectDecay:1.2}),this.websocketOpen=!0}null===(i=this.ws)||void 0===i||i.send("'client-stats",e)}push(e){var t;e.type="client-stats",this.websocketOpen?null===(t=this.ws)||void 0===t||t.send("client-stats",e):this.openWebsocket(e)}close(){null!=this.ws&&(this.ws.close(1005,"ClientStats is closed"),this.ws=null),this.websocketOpen=!1}}},"./node_modules/@video/video-client-core/lib/internal/errors-deprecated.js":(e,t,i)=>{"use strict";var r,s;Object.defineProperty(t,"__esModule",{value:!0}),t.HlsjsNotLoadedError=t.InvalidBitrateError=t.UserRequiredError=t.UnrecognizedDriverError=t.UnknownError=t.UnknownDriverError=t.PlaybackError=t.NoDriversError=t.WSNetworkError=t.InvalidElementError=t.InvalidPopoutURLError=t.InvalidMediaURLError=t.InvalidControlsError=t.ManifestNotFoundError=t.ManifestInternalError=t.ManifestForbiddenError=t.ManifestUnauthorizedError=t.ManifestUnexpectedResponseError=t.GetUserMediaFailedError=t.EmbedSWFFailedError=t.ElementRequiredError=t.DriverNotSupportedError=t.ManifestBadInputError=t.ManifestError=t.DisableAudioError=t.DisableVideoError=t.EnableAudioError=t.EnableVideoError=t.StreamNotFoundError=t.StreamExistsError=t.UpdateBroadcastError=t.StartBroadcastError=t.BroadcastError=t.JoinCallError=t.CallError=t.TrackEndedError=t.CapturableStreamError=t.DeviceNotFoundError=t.ConstraintsError=t.NetworkError=t.PermissionsError=t.InternalCallError=t.ValidationError=t.NotSupportedError=t.NotInitializedError=t.InternalError=t.NativeError=t.VideoClientErrorDeprecated=t.wrapNativeError=t.ErrorCode=void 0,t.HandleHlsJsError=t.Mp4BufferError=t.ChangeMSCDeviceError=t.UpdateMSCError=t.MediaRecorderError=t.TransportStateError=t.MediaError=t.MediasoupSetupError=t.WSRequestError=t.SFUProducerResumedEventError=t.SFUProducerPausedEventError=t.SFUProducerClosedEventError=t.SFUConsumerLayersChangedEventError=t.SFUConsumerScoreEventError=t.SFUConsumerResumedEventError=t.SFUConsumerPausedEventError=t.SFUConsumerClosedEventError=t.SFUSwitchConsumerTrackEventError=t.SFUPeerClosedEventError=t.SFUNewConsumerEventError=t.SFUConsumerSourcesEventError=t.SFUNewPeersEventError=t.RetrievingMediaStreamError=t.DisposedObjectError=t.MeowDriverError=t.PlayingIssueError=t.ConsumerNotFoundError=t.LayerNotFoundError=void 0;const o=i("./node_modules/tslib/tslib.es6.js"),n=i("./node_modules/@video/video-client-core/node_modules/@video/log-node/index.js"),a=i("./node_modules/@video/video-client-core/lib/api/index.js"),l=i("./node_modules/@video/video-client-core/lib/api/typings/dom-exception.js");var d=i("./node_modules/@video/video-client-core/lib/api/index.js");Object.defineProperty(t,"ErrorCode",{enumerable:!0,get:function(){return d.ErrorCode}});const c=new Set(["toJSON","ppStack","stack","detailed","handled","inner","aggregates"]);function u(e){var t;return null==e?null:"toJSON"in e&&"function"==typeof e.toJSON?e:{err:null!==(t=e.name)&&void 0!==t?t:e.constructor.name,message:e.message,stack:e.stack}}t.wrapNativeError=function(e){return e instanceof Error?new m(e.message,{native:e}):new m(String(e),{})};const p="Video Client Error: ";class h extends Error{constructor(e,t){super(),this.inner=null,r.set(this,void 0),s.set(this,null),this.handled=!1,o.__classPrivateFieldSet(this,r,e,"f");const{inner:i,critical:n}=t,a=o.__rest(t,["inner","critical"]);this.inner=i,this.critical=null!=n?n:i instanceof h&&i.critical;for(const[e,t]of Object.entries(a))this[e]=t}get message(){var e;let t=null===(e=this.inner)||void 0===e?void 0:e.message;return null!=t?(t.startsWith(p)&&(t=t.slice(p.length)),`${p}[${this.code}] ${o.__classPrivateFieldGet(this,r,"f")}; ${t}`):Reflect.has(this,"err")?`${p}[${this.code}] ${o.__classPrivateFieldGet(this,r,"f")}${function e(t){return null==t||"object"!=typeof t||"string"!=typeof t.message?"":`${null==t.code?"; ":`; [${String(t.code)} `}${t.message}${e(t.inner)}`}(Reflect.get(this,"err"))}`:`${p}[${this.code}] ${o.__classPrivateFieldGet(this,r,"f")}`}static loadPrettyPrintStacktrace(e){return o.__awaiter(this,void 0,void 0,(function*(){return Promise.resolve()}))}static log(e,t){h.loadPrettyPrintStacktrace(e).finally(}toJSON(){var e,t;const i={message:this.message,stack:null!==(t=null!==(e=o.__classPrivateFieldGet(this,s,"f"))&&void 0!==e?e:this.stack)&&void 0!==t?t:null,inner:u(this.inner),aggregates:this.aggregates()};for(const e of Object.keys(this))c.has(e)||(i[e.toString()]=this[e]);return i}aggregates(){var e,t;return this.inner instanceof h?Object.assign(Object.assign({},this.inner.aggregates()),{errCode:this.code,errCritical:null!==(e=this.critical)&&void 0!==e&&e,errHandled:this.handled}):{errCode:this.code,errCritical:null!==(t=this.critical)&&void 0!==t&&t,errHandled:this.handled}}}t.VideoClientErrorDeprecated=h,r=new WeakMap,s=new WeakMap;.NativeError=m;t.InternalError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.InternalError}};t.NotInitializedError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.NotInitialized}};t.NotSupportedError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.NotSupported}};t.ValidationError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.ValidationError}};t.InternalCallError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.InternalCallError}aggregates(){return Object.assign(Object.assign({},super.aggregates()),(0,n.extractAggregates)(this.internalCall))}};t.PermissionsError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.Permission}aggregates(){return Object.assign(Object.assign({},super.aggregates()),(0,n.extractAggregates)(this.stream))}};t.NetworkError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.NetworkError}aggregates(){var e;return Object.assign(Object.assign({},super.aggregates()),{errStatus:null!==(e=this.status)&&void 0!==e?e:0})}};t.ConstraintsError=class extends h{constructor(e,t){super(e,t),this.code=a.ErrorCode.Constraints;const{inner:i}=t;this.failedConstraint=null!=i&&(0,l.isOverconstrainedError)(i)?i.constraint:"NA"}};t.DeviceNotFoundError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.DeviceNotFound}};t.CapturableStreamError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.CapturableStreamError}};t.TrackEndedError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.TrackEnded}};t.CallError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.CallError};t.JoinCallError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.JoinCallError}aggregates(){return Object.assign(Object.assign({},super.aggregates()),(0,n.extractAggregates)(this.call))}};class v extends h{aggregates(){return Object.assign(Object.assign({},super.aggregates()),(0,n.extractAggregates)(this.broadcast))}}t.BroadcastError=v;t.StartBroadcastError=class extends v{constructor(){super(...arguments),this.code=a.ErrorCode.StartBroadcastError}};t.UpdateBroadcastError=class extends v{constructor(){super(...arguments),this.code=a.ErrorCode.UpdateBroadcastError}};t.StreamExistsError=class extends v{constructor(){super(...arguments),this.code=a.ErrorCode.StreamExists}};t.StreamNotFoundError=class extends v{constructor(){super(...arguments),this.code=a.ErrorCode.StreamNotFound}};t.EnableVideoError=class extends v{constructor(){super(...arguments),this.code=a.ErrorCode.EnableVideoError}};t.EnableAudioError=class extends v{constructor(){super(...arguments),this.code=a.ErrorCode.EnableAudioError}};t.DisableVideoError=class extends v{constructor(){super(...arguments),this.code=a.ErrorCode.DisableVideoError}};t.DisableAudioError=class extends v{constructor(){super(...arguments),this.code=a.ErrorCode.DisableAudioError}};t.ManifestError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.ManifestError}aggregates(){return Object.assign(Object.assign({},super.aggregates()),(0,n.extractAggregates)(this.loader))}};t.ManifestBadInputError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.BadInput}};t.DriverNotSupportedError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.DriverNotSupported}aggregates(){return Object.assign(Object.assign({},super.aggregates()),(0,n.extractAggregates)(this.loader))}};t.ElementRequiredError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.ElementRequired}};t.EmbedSWFFailedError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.EmbedSWFFailed}};t.GetUserMediaFailedError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.GetUserMediaFailed}};t.ManifestUnexpectedResponseError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.ManifestUnexpectedResponse}};t.ManifestUnauthorizedError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.ManifestUnauthorized}};t.ManifestForbiddenError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.ManifestForbidden}};t.ManifestInternalError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.ManifestInternalError}};t.ManifestNotFoundError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.ManifestNotFound}};t.InvalidControlsError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.InvalidControls}};t.InvalidMediaURLError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.InvalidMediaURL}};t.InvalidPopoutURLError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.InvalidPopoutURL}};t.InvalidElementError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.InvalidElement}};t.WSNetworkError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.WSNetworkError}};t.NoDriversError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.NoDrivers}};t.PlaybackError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.PlaybackError}aggregates(){return Object.assign(Object.assign({},super.aggregates()),(0,n.extractAggregates)(this.loader))}};t.UnknownDriverError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.UnknownDriver}};t.UnknownError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.UnknownError}};t.UnrecognizedDriverError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.UnrecognizedDriver}};t.UserRequiredError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.UserRequired}};t.InvalidBitrateError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.InvalidBitrate}};t.HlsjsNotLoadedError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.HlsjsNotLoaded}};t.LayerNotFoundError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.LayerNotFound}};t.ConsumerNotFoundError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.ConsumerNotFound}};t.PlayingIssueError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.PlayingIssue}aggregates(){return Object.assign(Object.assign({},super.aggregates()),(0,n.extractAggregates)(this.player))}};t.MeowDriverError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.MeowDriverError}};t.DisposedObjectError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.DisposedObject}};t.RetrievingMediaStreamError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.RetrievingMediaStreamError};t.SFUNewPeersEventError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.SFUNewPeersEvent}aggregates(){return Object.assign(Object.assign({},super.aggregates()),(0,n.extractAggregates)(this.peer))}};t.SFUConsumerSourcesEventError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.SFUConsumerSourcesEvent}aggregates(){return Object.assign(Object.assign({},super.aggregates()),(0,n.extractAggregates)(this.peer))}};t.SFUNewConsumerEventError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.SFUNewConsumerEvent}aggregates(){return Object.assign(Object.assign({},super.aggregates()),(0,n.extractAggregates)(this.peer))}};t.SFUPeerClosedEventError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.SFUPeerClosedEvent}aggregates(){return Object.assign(Object.assign({},super.aggregates()),(0,n.extractAggregates)(this.peer))}};t.SFUSwitchConsumerTrackEventError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.SFUSwitchConsumerTrackEvent}aggregates(){return Object.assign(Object.assign({},super.aggregates()),(0,n.extractAggregates)(this.peer))}};t.SFUConsumerClosedEventError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.SFUConsumerClosedEvent}aggregates(){return Object.assign(Object.assign({},super.aggregates()),(0,n.extractAggregates)(this.peer))}};t.SFUConsumerPausedEventError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.SFUConsumerPausedEvent}aggregates(){return Object.assign(Object.assign({},super.aggregates()),(0,n.extractAggregates)(this.peer))}};t.SFUConsumerResumedEventError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.SFUConsumerResumedEvent}aggregates(){return Object.assign(Object.assign({},super.aggregates()),(0,n.extractAggregates)(this.peer))}};t.SFUConsumerScoreEventError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.SFUConsumerScoreEvent}aggregates(){return Object.assign(Object.assign({},super.aggregates()),(0,n.extractAggregates)(this.peer))}};t.SFUConsumerLayersChangedEventError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.SFUConsumerLayersChangedEvent}aggregates(){return Object.assign(Object.assign({},super.aggregates()),(0,n.extractAggregates)(this.peer))}};t.SFUProducerClosedEventError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.SFUProducerClosedEvent}aggregates(){return Object.assign(Object.assign({},super.aggregates()),(0,n.extractAggregates)(this.peer))}};t.SFUProducerPausedEventError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.SFUProducerPausedEvent}aggregates(){return Object.assign(Object.assign({},super.aggregates()),(0,n.extractAggregates)(this.peer))}};t.SFUProducerResumedEventError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.SFUProducerResumedEvent}aggregates(){return Object.assign(Object.assign({},super.aggregates()),(0,n.extractAggregates)(this.peer))}};t.WSRequestError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.WSRequestError}aggregates(){return Object.assign(Object.assign({},super.aggregates()),(0,n.extractAggregates)(this.internalCall))}};t.MediasoupSetupError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.MediasoupSetupError}};t.MediaError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.MediaError}};t.TransportStateError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.TransportStateError}};t.MediaRecorderError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.MediaRecorderError}};t.UpdateMSCError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.UpdateMSCError}aggregates(){return Object.assign(Object.assign({},super.aggregates()),(0,n.extractAggregates)(this.msc))}};t.ChangeMSCDeviceError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.UpdateMSCError}aggregates(){var e,t,i,r,s,o,a,l;return Object.assign(Object.assign(Object.assign({},super.aggregates()),(0,n.extractAggregates)(this.msc)),{prevVideoDeviceId:null!==(e=this.prevVideoDeviceId)&&void 0!==e?e:"",prevVideoDeviceLabel:null!==(t=this.prevVideoDeviceLabel)&&void 0!==t?t:"",failedVideoDeviceId:null!==(i=this.failedVideoDeviceId)&&void 0!==i?i:"",failedVideoDeviceLabel:null!==(r=this.failedVideoDeviceLabel)&&void 0!==r?r:"",prevAudioDeviceId:null!==(s=this.prevAudioDeviceId)&&void 0!==s?s:"",prevAudioDeviceLabel:null!==(o=this.prevAudioDeviceLabel)&&void 0!==o?o:"",failedAudioDeviceId:null!==(a=this.failedAudioDeviceId)&&void 0!==a?a:"",failedAudioDeviceLabel:null!==(l=this.failedAudioDeviceLabel)&&void 0!==l?l:""})}};t.Mp4BufferError=class extends h{constructor(){super(...arguments),this.code=a.ErrorCode.Mp4BufferError}};t.HandleHlsJsError=class extends h{},"./node_modules/@video/video-client-core/lib/internal/errors.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VideoClientError=t.createError=t.wrapError=t.ErrorCode=void 0;const r=i("./node_modules/@video/video-client-core/lib/api/index.js"),s=i("./node_modules/@video/video-client-core/lib/api/error.js");var o=i("./node_modules/@video/video-client-core/lib/api/index.js");Object.defineProperty(t,"ErrorCode",{enumerable:!0,get:function(){return o.ErrorCode}});const n=new Set(["toJSON","stack","detailed","handled","inner","aggregates"]);function a(e){var t;return null==e?null:"toJSON"in e&&"function"==typeof e.toJSON?e:{err:null!==(t=e.name)&&void 0!==t?t:e.constructor.name,message:e.message,stack:e.stack}}function l(e){return null==e?null:(0,s.isVideoClientError)(e)?e:e instanceof Error?d(r.ErrorCode.NativeError,e.message,{type:e.name}):e instanceof ErrorEvent?d(r.ErrorCode.NativeError,e.message,{type:e.type}):d(r.ErrorCode.NativeError,String(e),{type:"unknown"})}function d(e,t,i,r=null){return new c(e,t,i,r)}t.wrapError=l,t.createError=d;class c extends Error{constructor(e,t,i={},r=null){super(function(e,t,i){let r=`[${e}] ${t}`;for(;null!=i;)r+=`; [${i.code}] ${i.message}`,i=i.inner;return r}(e,t,l(r))),this.inner=null,this.innerCodes=new Set,this.muted=!1,this.code=e,this.inner=l(r);for(const[e,t]of Object.entries(i))this[e]=t}static loget isMuted(){return this.muted}toJSON(){var e;const t={message:this.message,stack:null!==(e=this.stack)&&void 0!==e?e:null,inner:a(this.inner),aggregates:this.aggregates()};for(const e of Object.keys(this))n.has(e)||(t[e.toString()]=this[e]);return t}aggregates(){return this.inner instanceof c?Object.assign(Object.assign({},this.inner.aggregates()),{errCode:this.code}):{errCode:this.code}}t.VideoClientError=c},"./node_modules/@video/video-client-core/lib/internal/media-controller.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MediaStreamController=t.optionsKey=t.mediaController=t.CONSTRAINTS_SCREENCAPTURE_OPTIMAL_WEAK=t.CONSTRAINTS_VIDEO_OPTIMAL_WEAK=t.CONSTRAINTS_VIDEO_OPTIMAL_STRICT=t.CONSTRAINTS_AUDIO_OPTIMAL_WEAK=t.CONSTRAINTS_AUDIO_OPTIMAL_STRICT=t.VIDEO_DEVICE_CAPTURABLE=t.VIDEO_DEVICE_SCREENCAPTURE=void 0;const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/@video/log-client/index.js"),o=r.__importDefault(i("./node_modules/@video/log-client/lib/source.js")),n=i("./node_modules/deep-object-diff/cjs/index.js"),a=i("./node_modules/mobx/dist/mobx.esm.js"),l=i("./node_modules/@video/video-client-core/lib/api/index.js"),d=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),c=i("./node_modules/@video/video-client-core/lib/api/typings/dom-exception.js"),u=r.__importDefault(i("./node_modules/@video/video-client-core/lib/package-json.js")),p=i("./node_modules/@video/video-client-core/lib/utils/common.js"),h=i("./node_modules/@video/video-client-core/lib/internal/errors.js"),m=i("./node_modules/@video/video-client-core/lib/internal/utils/bind.js"),v=i("./node_modules/@video/video-client-core/lib/internal/utils/events/event-emitter.js");t.VIDEO_DEVICE_SCREENCAPTURE={deviceId:"screencapture",groupId:"screencapture",label:"Screen Capture",kind:"videoinput",virtual:!0,toJSON(){return{deviceId:this.deviceId,groupId:this.groupId,label:this.label,kind:this.kind}}},t.VIDEO_DEVICE_CAPTURABLE={deviceId:"capturable",groupId:"capturable",label:"Capturable",kind:"videoinput",virtual:!0,toJSON,t.CONSTRAINTS_AUDIO_OPTIMAL_STRICT={autoGainControl:{exact:!0},channelCount:{min:1,ideal:2},echoCancellation:{exact:!0},latency:{ideal:0},noiseSuppression:{exact:!0},sampleRate:{min:8e3,ideal:48e3,max:48e3},sampleSize:{min:16,ideal:32}},t.CONSTRAINTS_AUDIO_OPTIMAL_WEAK={autoGainControl:{ideal:!0},channelCount:{min:1,ideal:2},echoCancellation:{ideal:!0},latency:{ideal:0},noiseSuppression:{ideal:!0},sampleRate:{min:8e3,ideal:48e3,max:48e3},sampleSize:{min:16,ideal:32}},t.CONSTRAINTS_VIDEO_OPTIMAL_STRICT={facingMode:{ideal:"user"},aspectRatio:{exact:16/9},height:d.device.isAndroidDevice?{min:240,max:2160}:{min:240,ideal:2160,max:2160},frameRate:{ideal:24}},t.CONSTRAINTS_VIDEO_OPTIMAL_WEAK={facingMode:{ideal:"user"},aspectRatio:{ideal:16/9},height:d.device.isAndroidDevice?{min:240,max:2160}:{min:240,ideal:2160,max:2160},frameRate:{ideal:24}},t.CONSTRAINTS_SCREENCAPTURE_OPTIMAL_WEAK={frameRate:{ideal:24}};const g=a.observable.array([],{name:"mediaDevicesList"}),f=new Proxy({},{get:(e,i)=>{var r;return i===t.VIDEO_DEVICE_SCREENCAPTURE.deviceId?t.VIDEO_DEVICE_SCREENCAPTURE:i===t.VIDEO_DEVICE_CAPTURABLE.deviceId?t.VIDEO_DEVICE_CAPTURABLE:null!==(r=g.find(e=>e.deviceId===i&&"videoinput"===e.kind))&&void 0!==r?r:null}}),b=new Proxy({},{get:(e,t)=>{var i;return null!==(i=g.find()&&void 0!==i?i:null}}),_=new Proxy({},{get:(e,i)=>{var r;return i===t.VIDEO_DEVICE_SCREENCAPTURE.deviceId?t.VIDEO_DEVICE_SCREENCAPTURE:i===t.VIDEO_DEVICE_CAPTURABLE.deviceId?t.VIDEO_DEVICE_CAPTURABLE:null!==(r=g.find(e=>e.deviceId===i))&&void 0!==r?r:null}}),y=[4320,2160,1440,1080,720,480,240],w=new WeakMap,S={};let E=0,C=null;const j={defaultConstraints:{audio:t.CONSTRAINTS_AUDIO_OPTIMAL_STRICT,video:t.CONSTRAINTS_VIDEO_OPTIMAL_STRICT,screencapture:t.CONSTRAINTS_SCREENCAPTURE_OPTIMAL_WEAK},fallbackConstraints:{audio:t.CONSTRAINTS_AUDIO_OPTIMAL_WEAK,video:t.CONSTRAINTS_VIDEO_OPTIMAL_WEAK,screencapture:{}},replaceTracks:!0,waitingDelay:100,defaultLockPolicy:l.ExistsStreamPolicy.wait,noEchoGainAmplifier:d.device.isIosDevice,requestAudioPermission:!0};function P(e,t,i){if(!d.device.isImplements(d.Feature.AUDIO_CONTEXT))return t;if(!t.getAudioTracks().length)return t;if(e.debug("attach gain controller to stream"),null==C&&(C=new d.device.AudioContext),null==C.createAnalyser||null==C.createGain||null==C.createMediaStreamSource||null==C.createMediaStreamDestination)return t;const r=C.createGain(),s=C.createMediaStreamSource(t),o=C.createMediaStreamDestination(),n=o.stream;s.connect(r),r.connect(o),r.gain.value=i;const a=t.getAudioTracks()[0],l=n.getAudioTracks()[0];if(null==a||null==l)throw new Error("no audio tracks");const c=function(e){var t,i,r;const s=w.get(e);if(null!=(null==s?void 0:s.deviceId))return s.deviceId;const o=x(e),n=D(e),a=null!==(t=null==o?void 0:o.deviceId)&&void 0!==t?t:"object"==typeof(null==n?void 0:n.deviceId)?n.deviceId.exact:Array.isArray(n.deviceId)?n.deviceId[0]:n.deviceId;if(null!=a)return a.toString();return null!==(r=null===(i=g.find(t=>t.label===e.label))||void 0===i?void 0:i.deviceId)&&void 0!==r?r:null}(a);null!=c&&w.set(l,{deviceId:c,originalTrack:a,gainNode:r}),t.getVideoTracks().forEach(;const u=()=>{e.debug("modified audio track is ended. stopping original one",{originalTrack:a.id}),a.stop(),l.removeEventListener("ended",u)};return l.addEventListener("ended",u),n}function R(e,t=!0,i=!0){var r;if(null!=e)for(const s of e.getTracks()){if("audio"===s.kind&&!t||"video"===s.kind&&!i)continue;const o=w.get(s);null!=o&&(null===(r=o.originalTrack)||void 0===r||r.stop()),s.stop(),e.removeTrack(s)}}function x(e){var t;let i;try{i=null===(t=e.getSettings)||void 0===t?void 0:t.call(e)}catch(e){i={}}return i}function D(e){var t;let i;try{i=null===(t=e.getConstraints)||void 0===t?void 0:t.call(e)}catch(e){i={}}return i}function T(e,t,i){const r=JSON.parse(JSON.stringify(e));if(null!=i.aspectRatio)if("number"==typeof i.aspectRatio)r.aspectRatio={exact:i.aspectRatio};else{const[e,t]=i.aspectRatio;r.aspectRatio={min:e,max:t}}if(null!=i.autoGainControl&&(r.autoGainControl={exact:i.autoGainControl}),null!=i.echoCancellation&&(r.echoCancellation={exact:i.echoCancellation}),null!=i.facingMode&&(r.facingMode={exact:i.facingMode}),null!=i.frameRate)if("number"==typeof i.frameRate)r.frameRate={exact:i.frameRate};else{const[e,t]=i.frameRate;r.frameRate={min:e,max:t}}if(null!=i.resolution)if("number"==typeof i.resolution)r.height={exact:i.resolution};else if(Array.isArray(i.resolution)){const[e,t]=i.resolution;r.height={min:e,max:t}}else r.height={min:i.resolution.min,ideal:i.resolution.ideal,max:i.resolution.max};var s;return r.deviceId=null==t||null!=(s=_[t])&&s.virtual?void 0:{exact:t},r}function I(e,i,r,{echoCancellation:s,autoGainControl:o,noiseSuppression:n,frameRate:a,resolution:l,aspectRatio:d,facingMode:c}){const u=(null==r?void 0:r.deviceId)===(null===t.VIDEO_DEVICE_SCREENCAPTURE||void 0===t.VIDEO_DEVICE_SCREENCAPTURE?void 0:t.VIDEO_DEVICE_SCREENCAPTURE.deviceId)?e.screencapture:e.video,{audio:p}=e;return{audio:null!=i&&T(p,null==i?void 0:i.deviceId,{echoCancellation:s,autoGainControl:o,noiseSuppression:n}),video:null!=r&&T(u,null==r?void 0:r.deviceId,{resolution:l,frameRate:a,aspectRatio:d,facingMode:c})}}class O extends v.ObservableEventEmitter{constructor(){var e,t;super(),this.isInitialized=!1,this.initialized=null,this._supportSharedDevices=null,this.logger=new s.LoggerCore(p.PACKAGE_NAME).setLoggerMeta("client","VDC").setLoggerMeta("release",u.default.version).appendChain(O).setMessageAggregate("contextId",null!==(e=(0,p.contextId)())&&void 0!==e?e:void 0).setMessageAggregate("instanceId",null!==(t=(0,p.instanceId)())&&void 0!==t?t:void 0),(0,m.makeBounded)(this),(0,a.makeObservable)(this,{requestController:a.action})}audioDevices(){return this.isInitialized?g.filter(e=>"audioinput"===e.kind):(this.logger.warn("init() must be called on the media-controller singleton",{}),[])}videoDevices(){if(!this.isInitialized)return this.logger.warn("init() must be called on the media-controller singleton",{}),[];return g.filter(e=>"videoinput"===e.kind)}et supportSharedDevicesheckSupportSharedDevices(e,t){return r.__awaiter(this,void 0,void 0,(function*(){if((i=d.device).isAndroidDevice&&"ReactNative"===i.platform)return void(this._supportSharedDevices=!1);var i;if(!d.device.isImplements(d.Feature.MEDIA_DEVICE))return void(this._supportSharedDevices=!1);if(!1===e&&!1===t)return this.logger.warn("video and audio device permissions denied"),void(this._supportSharedDevices=!1);let r=null,s=null;const o=e?{video:{deviceId:"default"}}:{audio:{deviceId:"default"}};try{r=yield d.device.mediaDevices.getUserMedia(o);const e=r.getVideoTracks()[0].id;s=yield d.device.mediaDevices.getUserMedia({video:{deviceId:e}});const t=s.getVideoTracks()[0].id;this._supportSharedDevices=e===t}catch(e){this._supportSharedDevices=!1}finally{R(r),R(s)}}))}init(e){return r.__awaiter(this,void 0,void 0,(function*(){if(this.mediaControllerOptions=e,null!=this.initialized)return e&&this.setOptions(e),this.initialized;this.initialized=this._init(),e&&this.setOptions(e);try{yield this.initialized}catch(e){throw this.initialized=null,e}return this.isInitialized=!0,this.initialized}))}setOptions(e){var t;clearInterval(E),null!=e.updateByTimer&&(E=d.device.setInterval(this.enumerateDevices,e.updateByTimer)),null!=e.logger&&(null===(t=this.logger)||void 0===t||t.destroy(),this.logger=e.logger)}_init(){return r.__awaiter(this,void 0,void 0,(function*(){return d.device.isImplements(d.Feature.MEDIA_DEVICE)||this.throwError((0,h.createError)(l.ErrorCode.MediaDeviceNotSupported,"media device is not supported",{})),d.device.mediaDevices.removeEventListener("devicechange",this.enumerateDevices),d.device.mediaDevices.addEventListener("devicechange",this.enumerateDevices),this.enumerateDevices(!0).then(this.observePerms)}))}observePerms(){return r.__awaiter(this,void 0,void 0,(function*(){if(!d.device.isImplements(d.Feature.PERMISSIONS))return;const e=e=>{const t=e.target;this.enumerateDevices("prompt"===t.state)};try{const t=yield d.device.permissions.query({name:"camera"}),i=yield d.device.permissions.query({name:"microphone"});t.addEventListener("change",e),i.addEventListener("change",e)}catch(e){}}))}requestController(e=j){var t,i;const r=Object.assign(Object.assign(Object.assign({},j),{replaceTracks:this.supportSharedDevices,requestAudioPermission:null===(i=null===(t=this.mediaControllerOptions)||void 0===t?void 0:t.requestAudioPermission)||void 0===i||i}),e);return this.logger.info("request new MediaStreamController",{options:{defaultConstraints:JSON.stringify(r.defaultConstraints),fallbackConstraints:JSON.stringify(r.fallbackConstraints),defaultLockPolicy:r.defaultLockPolicy,replaceTracks:r.replaceTracks,waitingDelay:r.waitingDelay,displayName:r.displayName,requestAudioPermission:r.requestAudioPermission}}),this.isInitialized||this.throwError((0,h.createError)(l.ErrorCode.MediaControllerNotInitialized,"init() must be called on the media-controller singleton",{})),Promise.resolve(new k(r))}enumerateDevices(e=!1){var t,i;return r.__awaiter(this,void 0,void 0,(function*(){d.device.isImplements(d.Feature.MEDIA_DEVICE)&&null!=d.device.mediaDevices.enumerateDevices||this.throwError((0,h.createError)(l.ErrorCode.MediaDeviceNotSupported,"media device is not supported",{}));const r=[];if(e){let e=!1,s=!1;const o=null===(i=null===(t=this.mediaControllerOptions)||void 0===t?void 0:t.requestAudioPermission)||void 0===i||i;try{r.push(yield d.device.mediaDevices.getUserMedia({audio:o,video:!0})),e=o,s=!0}catch(t){try{o&&(r.push(yield d.device.mediaDevices.getUserMedia({audio:!0,video:!1})),e=!0)}catch(e){e instanceof Error&&("NotFoundError"===e.name?(this.logger.warn("no audio devices found",{err:(0,h.wrapError)(e)}),this.emit("audioNotFound")):"NotAllowedError"===e.name?(this.logger.warn("audio device permission denied",{err:(0,h.wrapError)(e)}),this.emit("audioNotAllowed")):this.logger.warn("Audio device error",{err:(0,h.wrapError)(e)}))}try{r.push(yield d.device.mediaDevices.getUserMedia({audio:!1,video:!0})),s=!0}catch(e){e instanceof Error&&("NotFoundError"===e.name?(this.logger.warn("no video devices found",{err:(0,h.wrapError)(e)}),this.emit("videoNotFound")):"NotAllowedError"===e.name?(this.logger.warn("video device permission denied",{err:(0,h.wrapError)(e)}),this.emit("videoNotAllowed")):this.logger.warn("Video device error",{err:(0,h.wrapError)(e)}))}}yield this.checkSupportSharedDevices(s,e)}try{const e=yield d.device.mediaDevices.enumerateDevices();let t=[];for(const i of e)""===i.deviceId||""===i.label||t.some(||t.push(i);if(d.device.isSafari&&d.device.isImplements(d.Feature.PERMISSIONS)){const e=yield d.device.permissions.query({name:"camera"}),i=yield d.device.permissions.query({name:"microphone"});"granted"!==e.state&&(t=t.filter(e=>"videoinput"!==e.kind)),"granted"!==i.state&&(t=t.filter(e=>"audioinput"!==e.kind))}(g.length!==t.length||g.some((e,i)=>e.deviceId!==t[i].deviceId||e.groupId!==t[i].groupId||e.label!==t[i].label||e.kind!==t[i].kind))&&((0,a.runInAction)((),this.emit("deviceListChanged",g.slice()))}finally{for(const e of r)R(e)}}))}}O.displayName="MediaController",t.mediaController=new O,t.optionsKey=Symbol("options");class k extends v.ObservableEventEmitter{get[t.optionsKey]et settings(){var e,t,i,r,s,o,n;this.applyConstraintsAtom.reportObserved();const a={};if(this.hasActiveAudioTrack()){const o=null===(e=this.source)||void 0===e?void 0:e.getAudioTracks()[0],n=w.get(o);null!=o&&null!=n?(a.audioCtx={gain:null===(t=n.gainNode)||void 0===t?void 0:t.gain.value,internallyEnded:n.internallyEnded,track:o.getSettings()},a.audio=null===(i=n.originalTrack)||void 0===i?void 0:i.getSettings()):a.audio=null===(s=null===(r=this.source)||void 0===r?void 0:r.getAudioTracks()[0])||void 0===s?void 0:s.getSettings()}return this.hasActiveVideoTrack()&&(a.video=null===(n=null===(o=this.source)||void 0===o?void 0:o.getVideoTracks()[0])||void 0===n?void 0:n.getSettings()),a}t audioDeviceId(e){var t,i;null!=e?(null==b[e]&&this.emitError((0,h.createError)(l.ErrorCode.MediaDeviceNotAvailable,"audio device not found or not available",{deviceId:e,deviceLabel:null,prevDeviceId:this.audioDeviceId,prevDeviceLabel:null!==(i=null===(t=this.audioDeviceChanged)||void 0===t?void 0:t.label)&&void 0!==i?i:null,kind:"audio"})),this.audioDeviceChanging=this.options.requestAudioPermission?b[e]:null):this.audioDeviceChanging=null}get inVideoDeviceTransition(){return null!=this.sync&&this.videoDeviceChanging!==this.videoDeviceChanged}et videoDeviceId(){var e,t,i,r;return this.videoDisabled?null!==(t=null===(e=this.videoDeviceChanging)||void 0===e?void 0:e.deviceId)&&void 0!==t?t:null:null!==(r=null===(i=this.videoDeviceChanged)||void 0===i?void 0:i.deviceId)&&void 0!==r?r:null}set videoDeviceId(e){var t,i;null!=e?(null==f[e]&&this.emitError((0,h.createError)(l.ErrorCode.MediaDeviceNotAvailable,"video device not found or not available",{deviceId:e,deviceLabel:null,prevDeviceId:this.videoDeviceId,prevDeviceLabel:null!==(i=null===(t=this.videoDeviceChanged)||void 0===t?void 0:t.label)&&void 0!==i?i:null,kind:"video"})),this.videoDeviceChanging=f[e]):this.videoDeviceChanging=null}onstructor(e){var i,r,o,n;super(),this.sync=null,this.audioCtx=null,this.optionsAtom=(0,a.createAtom)("options"),this.applyConstraintsAtom=(0,a.createAtom)("applyConstraints"),this.capturable=null,this.batchUpdates={timeout:null,changes:[],videoDevice:!1,audioDevice:!1,gain:!1,videoPaused:!1,audioMuted:!1,constraints:!1},this.audioDeviceChanged=null,this.videoDeviceChanged=null,this.audioDeviceChanging=null,this.videoDeviceChanging=null,this.videoDeviceRemoved=null,this.audioDeviceRemoved=null,this.audioMuted=!1,this.availableResolutions=[],this.maxWidth=null,this.maxHeight=null,this.videoPaused=!1,this.videoDisabled=!1,this.facingMode=null,this.gain=1,this.noEchoGainAmplifier=!1,this.resolution=null,this.frameRate=null,this.aspectRatio=null,this.echoCancellation=null,this.noiseSuppression=null,this.autoGainControl=null,d.device.isImplements(d.Feature.MEDIA_STREAM)||this.throwError((0,h.createError)(l.ErrorCode.MediaStreamNotSupported,"MediaStream is not supported",{})),this.source=new d.device.MediaStream,this.logger=new s.LoggerCore(p.PACKAGE_NAME).setLoggerMeta("package","VDC-core").setLoggerMeta("client","VDC").setLoggerMeta("release",u.default.version).setLoggerMeta("commitHash",u.default.commit).setLoggerMeta("contextId",null!==(i=(0,p.contextId)())&&void 0!==i?i:"").setLoggerMeta("instanceId",null!==(r=(0,p.instanceId)())&&void 0!==r?r:"").setMessageAggregate("displayName",null==e?void 0:e.displayName).appendChain(k).attachObject(this),this.logger.trace("constructor()",this),this.on("error",,(0,a.makeObservable)(this,{audioDeviceChanged:a.observable.ref,videoDeviceChanged:a.observable.ref,audioDeviceChanging:a.observable.ref,videoDeviceChanging:a.observable.ref,audioMuted:a.observable,availableResolutions:a.observable,maxWidth:a.observable,maxHeight:a.observable,videoPaused:a.observable,videoDisabled:a.observable,facingMode:a.observable,gain:a.observable,resolution:a.observable,frameRate:a.observable,aspectRatio:a.observable,echoCancellation:a.observable,noiseSuppression:a.observable,autoGainControl:a.observable,source:a.observable.ref,audioDeviceId:a.computed,videoDeviceId:a.computed,isScreenCaptured:a.computed,sourceUrl:a.computed,settings:a.computed,toggleCamera:a.action,toggleMic:a.action,onDeviceListChanged:a.action}),this.options=JSON.parse(JSON.stringify(j)),null!=e&&(this.setOptions(Object.assign(Object.assign({},j),e)),null!=(null===(o=null==e?void 0:e.capturable)||void 0===o?void 0:o.element)&&d.device.supportsMediaStreamCapture(null===(n=null==e?void 0:e.capturable)||void 0===n?void 0:n.element)&&(this.capturable=e.capturable,this.videoDeviceId=t.VIDEO_DEVICE_CAPTURABLE.deviceId,this.applyNewDevices())),this.options.noEchoGainAmplifier&&(this.noEchoGainAmplifier=!0),this.setupMobxBatching(),t.mediaController.on("deviceListChanged",this.onDeviceListChanged),this.addInnerDisposer(this.close)}asActiveVideoTrack(){const{videoDeviceChanged:e,videoDisabled:t}=this;return null!=e&&!t}oggleCamera(){this.videoPaused=!this.videoPaused}nDeviceListChanged(e){if(null!=this.videoDeviceChanged&&!e.some(e=>{var t;return e.deviceId===(null===(t=this.videoDeviceChanged)||void 0===t?void 0:t.deviceId)})){const t=e.filter(e=>"videoinput"===e.kind);t.length>0?[this.videoDeviceChanging]=t:this.videoDeviceChanging=null}if(null!=this.audioDeviceChanged&&!e.some(){const t=e.filter(e=>"audioinput"===e.kind);t.length>0?[this.audioDeviceChanging]=t:this.audioDeviceChanging=null}}setupMobxBatching(){const e={scheduler:this.batchUpdatesScheduler,name:"MediaStreamController(batch update)"};this.addInnerDisposer((0,a.reaction)(()=>this.videoDeviceChanging,()=>{this.batchUpdates.videoDevice=!0},e)),this.addInnerDisposer((0,a.reaction)(()=>this.audioDeviceChanging,()=>{this.batchUpdates.audioDevice=!0},e)),this.addInnerDisposer((0,a.reaction)(()=>this.videoDisabled,()=>{this.batchUpdates.videoDevice=!0},e)),this.addInnerDisposer((0,a.reaction)(()=>this.gain,()=>{this.batchUpdates.gain=!0},e)),this.addInnerDisposer((0,a.reaction)(()=>this.videoPaused,()=>{this.batchUpdates.videoPaused=!0},e)),this.addInnerDisposer((0,a.reaction)(()=>{this.batchUpdates.audioMuted=!0},e)),this.addInnerDisposer((0,a.reaction)(()=>[this.facingMode,this.aspectRatio,this.frameRate,this.resolution,this.noiseSuppression,this.autoGainControl,this.echoCancellation],e))}batchUpdatesScheduler(e,...t){this.batchUpdates.changes.push(e),null==this.batchUpdates.timeout&&(this.batchUpdates.timeout=d.device.setInterval(()=>{var e;if(null!=this.sync)return;d.device.clearInterval(null!==(e=this.batchUpdates.timeout)&&void 0!==e?e:void 0),this.batchUpdates.changes.forEach(;const t=this.batchUpdates;this.batchUpdates={timeout:null,changes:[],videoDevice:!1,audioDevice:!1,gain:!1,videoPaused:!1,audioMuted:!1,constraints:!1},t.audioDevice||t.videoDevice?this.applyNewDevices():!t.constraints||d.device.isImplements(d.Feature.APPLY_CONSTRAINTS)?(t.audioMuted&&this.applyAudioMute(),t.videoPaused&&this.applyVideoPause(),t.gain&&this.applyGain(),t.constraints&&this.applyConstraints()):this.applyConstraints()},10))}setOptions(e){let t=!1;null!=e.replaceTracks&&(this.options.replaceTracks=e.replaceTracks),null!=e.requestAudioPermission&&(this.options.requestAudioPermission=e.requestAudioPermission),null!=e.defaultConstraints&&(this.options.defaultConstraints=Object.assign({},e.defaultConstraints),t=!0),void 0!==e.fallbackConstraints&&(this.options.fallbackConstraints=null==e.fallbackConstraints?null:Object.assign({},e.fallbackConstraints),t=!0),void 0!==e.capturable&&(this.capturable=e.capturable),t&&this.applyConstraints(),this.optionsAtom.reportChanged()}constraints(){return I(this.options.defaultConstraints,this.options.requestAudioPermission?this.audioDeviceChanging:null,this.videoDisabled?null:this.videoDeviceChanging,{aspectRatio:this.aspectRatio,autoGainControl:this.autoGainControl,echoCancellation:this.echoCancellation,facingMode:this.facingMode,frameRate:this.frameRate,noiseSuppression:this.noiseSuppression,resolution:this.resolution})}fallbackConstraints(){return null==this.options.fallbackConstraints?null:I(this.options.fallbackConstraints,this.options.requestAudioPermission?this.audioDeviceChanging:null,this.videoDisabled?null:this.videoDeviceChanging,{aspectRatio:this.aspectRatio,autoGainControl:this.autoGainControl,echoCancellation:this.echoCancellation,facingMode:this.facingMode,frameRate:this.frameRate,noiseSuppression:this.noiseSuppression,resolution:this.resolution})}activeConstraints(){var e,t,i,r,s,o;this.applyConstraintsAtom.reportObserved();const n={};try{if(this.hasActiveVideoTrack()&&(n.video=null===(i=null===(t=null===(e=this.source)||void 0===e?void 0:e.getVideoTracks())||void 0===t?void 0:t[0])||void 0===i?void 0:i.getConstraints()),this.hasActiveAudioTrack()){const e=null===(s=null===(r=this.source)||void 0===r?void 0:r.getAudioTracks())||void 0===s?void 0:s[0];if(null!=e){const t=null===(o=w.get(e))||void 0===o?void 0:o.originalTrack;n.audio=null!=t?t.getConstraints():e.getConstraints()}}}catch(e){this.logger.warn("unable to detect active constaints")}return n}applyVideoPause(){var e;const{videoPaused:i}=this;(null===(e=this.videoDeviceChanged)||void 0===e?void 0:e.deviceId)!==t.VIDEO_DEVICE_SCREENCAPTURE.deviceId&&this.source.getVideoTracks().forEach(e=>{i?this.logger.debug("pause video track",{trackId:e.id}):this.logger.debug("unpause video track",{trackId:e.id}),e.enabled=!i})}applyAudioMute(){const{audioMuted:e}=this;this.source.getAudioTracks().forEach(t=>{e?this.logger.debug("disable audio track",{trackId:t.id}):this.logger.debug("enable audio track",{trackId:t.id}),t.enabled=!e})}applyNewDevices(){var e,i,s,o,n,c,u,p,m,v,g,f,b,_,y,w,S,E,C,j,P,x,D,T;return r.__awaiter(this,void 0,void 0,(function*(){const{replaceTracks:r}=this.options,I=this.videoDisabled?null:this.videoDeviceChanging,O=this.audioDeviceChanging,k=this.videoDeviceChanged,M=this.audioDeviceChanged,L=I!==this.videoDeviceChanged,A=this.audioDeviceChanging!==this.audioDeviceChanged;if(null==I&&null==O)return void(0,a.action)("applyNewDevices",()=>{d.device.isImplements(d.Feature.MEDIA_STREAM)&&(this.audioDeviceChanged=O,this.videoDeviceChanged=I,R(this.source),this.source=new d.device.MediaStream)})();this.logger.debug("preparing new devices",{videoDevice:I,audioDevice:O,videoChanged:L,audioChanged:A,replaceTracks:r});let N=null;const B=this.source;if(r)try{if(N=yield this.lockAndPrepareStream(I,O,this.options.defaultLockPolicy,this.constraints(),this.fallbackConstraints()),L&&I!==t.VIDEO_DEVICE_SCREENCAPTURE&&I!==t.VIDEO_DEVICE_CAPTURABLE)try{yield this.updateResolutions(I)}catch(t){this.emitError((0,h.createError)(l.ErrorCode.UpdateResolutionsFailed,"unable to update available resolutions",{kind:"video",deviceId:null!==(e=null==I?void 0:I.deviceId)&&void 0!==e?e:null,deviceLabel:null!==(i=null==I?void 0:I.label)&&void 0!==i?i:null,prevDeviceId:null!==(s=null==k?void 0:k.deviceId)&&void 0!==s?s:null,prevDeviceLabel:null!==(o=null==k?void 0:k.label)&&void 0!==o?o:null},t))}R(B,A,L)}catch(e){return R(N),L&&this.emitError((0,h.createError)(l.ErrorCode.MediaDeviceChangingFailed,"unable to change video device",{deviceId:null!==(n=null==I?void 0:I.deviceId)&&void 0!==n?n:null,deviceLabel:null!==(c=null==I?void 0:I.label)&&void 0!==c?c:null,prevDeviceId:null!==(u=null==k?void 0:k.deviceId)&&void 0!==u?u:null,prevDeviceLabel:null!==(p=null==k?void 0:k.label)&&void 0!==p?p:null,kind:"video"},e)),A&&this.emitError((0,h.createError)(l.ErrorCode.MediaDeviceChangingFailed,"unable to change audio device",{deviceId:null!==(m=null==O?void 0:O.deviceId)&&void 0!==m?m:null,deviceLabel:null!==(v=null==O?void 0:O.label)&&void 0!==v?v:null,prevDeviceId:null!==(g=null==M?void 0:M.deviceId)&&void 0!==g?g:null,prevDeviceLabel:null!==(f=null==M?void 0:M.label)&&void 0!==f?f:null,kind:"audio"},e)),this.emit("changeDevicesError",{err:e,audio:{old:M,new:O},video:{old:k,new:I}}),void(null==this.sync&&(0,a.action)("rollbackDevices",()=>{this.videoDeviceChanging=k,this.audioDeviceChanging=M})())}else try{if(R(B,A,L),L&&I!==t.VIDEO_DEVICE_SCREENCAPTURE&&I!==t.VIDEO_DEVICE_CAPTURABLE)try{yield this.updateResolutions(I)}catch(e){this.emitError((0,h.createError)(l.ErrorCode.UpdateResolutionsFailed,"unable to update available resolutions",{kind:"video",deviceId:null!==(b=null==I?void 0:I.deviceId)&&void 0!==b?b:null,deviceLabel:null!==(_=null==I?void 0:I.label)&&void 0!==_?_:null,prevDeviceId:null!==(y=null==k?void 0:k.deviceId)&&void 0!==y?y:null,prevDeviceLabel:null!==(w=null==k?void 0:k.label)&&void 0!==w?w:null},e))}N=yield this.lockAndPrepareStream(I,O,this.options.defaultLockPolicy,this.constraints(),this.fallbackConstraints())}catch(e){return R(N),L&&this.emitError((0,h.createError)(l.ErrorCode.MediaDeviceChangingFailed,"unable to change video device",{deviceId:null!==(S=null==I?void 0:I.deviceId)&&void 0!==S?S:null,deviceLabel:null!==(E=null==I?void 0:I.label)&&void 0!==E?E:null,prevDeviceId:null!==(C=null==k?void 0:k.deviceId)&&void 0!==C?C:null,prevDeviceLabel:null!==(j=null==k?void 0:k.label)&&void 0!==j?j:null,kind:"video"},e)),A&&this.emitError((0,h.createError)(l.ErrorCode.MediaDeviceChangingFailed,"unable to change audio device",{deviceId:null!==(P=null==O?void 0:O.deviceId)&&void 0!==P?P:null,deviceLabel:null!==(x=null==O?void 0:O.label)&&void 0!==x?x:null,prevDeviceId:null!==(D=null==M?void 0:M.deviceId)&&void 0!==D?D:null,prevDeviceLabel:null!==(T=null==M?void 0:M.label)&&void 0!==T?T:null,kind:"audio"},e)),this.emit("changeDevicesError",{err:e,audio:{old:M,new:O},video:{old:k,new:O}}),void(null==this.sync&&(0,a.action)("rollbackDevices",())}for(const e of B.getTracks())B.removeTrack(e),N.addTrack(e);const U=N;(0,a.action)("applyNewDevices",()=>{this.audioDeviceChanged=O,this.videoDeviceChanged=I,this.source=U,this.logger.info("applied new devices",{videoDevice:I,audioDevice:O})})()}))}updateResolutions(e){return r.__awaiter(this,void 0,void 0,(function*(){if(!this.options.replaceTracks&&this.source.getVideoTracks().some(e=>"live"===e.readyState))throw new Error("attempt to get resolutions with replaceTracks enabled and running stream");const t=null==e?void 0:e.deviceId;if(null==t)return void(0,a.runInAction)(()=>{this.maxWidth=0,this.maxHeight=0,this.availableResolutions=[]});let i=null,r=null,s=[];if(null==S[t]){const i=yield this.lockAndPrepareStream(e,null,l.ExistsStreamPolicy.error,{video:{deviceId:{exact:t}}});S[t]=function(e){const t=e.getVideoTracks()[0];if(null==t)return[null,null,[]];const i=x(t),r=null==i?void 0:i.width,s=null==i?void 0:i.height;if(null==s||null==r)return[null,null,[]];const o=y.filter(;return[r,s,o]}(i),R(i)}[i,r,s]=S[t],(0,a.runInAction)(()=>{this.maxWidth=i,this.maxHeight=r,this.availableResolutions=s})}))}applyConstraintsVideo(e,t,i){var s;return r.__awaiter(this,void 0,void 0,(function*(){if(d.device.isImplements(d.Feature.APPLY_CONSTRAINTS)){this.logger.debug("apply video constraints",{defaultVideo:i,fallbackVideo:t}),d.device.isImplements(d.Feature.BROWSER_TYPE)&&"safari"===d.device.browserInfo.name&&delete i.deviceId;try{yield d.device.applyConstraints(e,i)}catch(r){this.logger.warn("unable to apply video constraints",{defaultVideo:i});const o=r instanceof Error||(0,c.isErrorLike)(r)?r:null,a=this.activeConstraints(),l=(0,n.diff)(i,null!==(s=a.video)&&void 0!==s?s:{});this.emit("videoConstraintsError",{diff:l,isFallback:!1,constraints:i,err:(0,h.wrapError)(o)}),null!=t&&"boolean"!=typeof t&&(this.logger.debug("trying fallback video constraints",{fallbackVideo:t}),d.device.applyConstraints(e,t).catch(r=>{var s;const o=r instanceof Error||(0,c.isErrorLike)(r)?r:null,a=this.activeConstraints(),l=(0,n.diff)(t,null!==(s=a.video)&&void 0!==s?s:{});null!=o&&(0,c.isOverconstrainedError)(o)&&"height"===o.constraint?(this.logger.error("Unable to apply selected resolution, please select a resolution supported by your current video device.",{fallbackConstraints:t,defaultConstraints:i,trackId:e.id,trackType:e.kind,err:(0,h.wrapError)(o)}),this.emit("videoConstraintsError",{diff:l,isFallback:!0,constraints:t,err:(0,h.wrapError)(o)})):(this.logger.error("Unable to apply video constraints. Try restarting the stream.",{fallbackConstraints:t,defaultConstraints:i,trackId:e.id,trackType:e.kind,err:(0,h.wrapError)(o)}),this.emit("videoConstraintsError",{diff:l,isFallback:!0,constraints:t,err:(0,h.wrapError)(o)}))}))}}}))}applyConstraintsAudio(e,t,i){var s,o;return r.__awaiter(this,void 0,void 0,(function*(){if(d.device.isImplements(d.Feature.APPLY_CONSTRAINTS))try{d.device.isImplements(d.Feature.BROWSER_TYPE)&&"safari"===d.device.browserInfo.name&&delete t.deviceId,yield d.device.applyConstraints(e,t)}catch(r){this.logger.warn("unable to apply constraints",{defaultAudio:t});const a=r instanceof Error||(0,c.isErrorLike)(r)?r:null,l=this.activeConstraints(),u=(0,n.diff)(t,null!==(s=l.audio)&&void 0!==s?s:{});if(this.emit("audioConstraintsError",{diff:u,isFallback:!1,constraints:t,err:(0,h.wrapError)(a)}),null!=i&&"boolean"!=typeof i){this.logger.debug("trying fallback apply constraints",{fallbackAudio:i});const r=this.activeConstraints(),s=(0,n.diff)(i,null!==(o=r.audio)&&void 0!==o?o:{});d.device.applyConstraints(e,i).catch(r=>{const o=r instanceof Error||(0,c.isErrorLike)(r)?r:null;this.logger.error("unable to apply audio constraints. restart stream",{fallbackConstraints:i,defaultConstraints:t,trackId:e.id,trackType:e.kind,err:(0,h.wrapError)(o)}),this.emit("audioConstraintsError",{diff:s,isFallback:!0,constraints:i,err:(0,h.wrapError)(o)})})}}}))}applyConstraints(){return r.__awaiter(this,void 0,void 0,(function*(){if(null==this.audioDeviceChanging&&null==this.videoDeviceChanging)return;if(!d.device.isImplements(d.Feature.APPLY_CONSTRAINTS)){R(this.source);const e=this.constraints(),t=this.fallbackConstraints();try{this.source=yield this.lockAndPrepareStream(this.videoDeviceChanging,this.audioDeviceChanging,this.options.defaultLockPolicy,e,t)}catch(i){this.emitError((0,h.createError)(l.ErrorCode.ApplyingConstraintsFailed,"applying constraints failed",{constraints:e,fallbackConstraints:t},i))}return}const e=this.source,t=this.constraints(),i=this.fallbackConstraints(),r=[],s=t.video,o=null==i?void 0:i.video,n=t.audio,a=null==i?void 0:i.audio;null!=s&&"boolean"!=typeof s&&r.push(...e.getVideoTracks().filter(.map(e=>this.applyConstraintsVideo(e,o,s))),null!=n&&"boolean"!=typeof n&&r.push(...e.getAudioTracks().map(e=>{var t;return null!=(null===(t=w.get(e))||void 0===t?void 0:t.originalTrack)?w.get(e).originalTrack:e}).filter(.map(),yield Promise.all(r),this.applyConstraintsAtom.reportChanged()}))}supportsNoiseSuppression(){var e;if(d.device.isImplements(d.Feature.MEDIA_DEVICE))try{return null!==(e=d.device.mediaDevices.getSupportedConstraints().noiseSuppression)&&void 0!==e&&e}catch(e){return!1}return!1}supportsEchoCancellation(){var e;if(d.device.isImplements(d.Feature.MEDIA_DEVICE))try{return null!==(e=d.device.mediaDevices.getSupportedConstraints().echoCancellation)&&void 0!==e&&e}catch(e){return!1}return!1}applyGain(){return r.__awaiter(this,void 0,void 0,(function*(){const e=this.source.getAudioTracks()[0],t=w.get(e);if(null!=(null==t?void 0:t.gainNode)){const i=D(e);this.noEchoGainAmplifier&&!1===i.echoCancellation?t.gainNode.gain.value=10*this.gain:t.gainNode.gain.value=this.gain,this.applyConstraintsAtom.reportChanged()}}))}lockAndPrepareStream(e,i,s,o,n){return r.__awaiter(this,void 0,void 0,(function*(){const r=e===t.VIDEO_DEVICE_SCREENCAPTURE?"screencapture":e===t.VIDEO_DEVICE_CAPTURABLE?"captureable":"media";if(!1===o.audio&&!1===o.video&&d.device.isImplements(d.Feature.MEDIA_STREAM))return new d.device.MediaStream;if(this.logger.trace("lockAndPrepareStream()",{policy:l.ExistsStreamPolicy[s],constraints:o}),null!=this.sync)switch(s){case l.ExistsStreamPolicy.error:this.throwError((0,h.createError)(l.ErrorCode.MediaStreamPreparingConflict,"MediaStream is preparing already",{}));break;case l.ExistsStreamPolicy.stale:return this.logger.debug("stream is preparing already, waiting"),this.sync;case l.ExistsStreamPolicy.wait:return yield this.sync,new Promise((t,r)=>{d.device.setTimeout(()=>{this.lockAndPrepareStream(e,i,s,o,n).then(t).catch(r)},this.options.waitingDelay)});case l.ExistsStreamPolicy.ignore:this.sync.then(;break;default:throw new Error("Unknown policy MediaStream "+s)}return this.sync=this.prepareStream(r,o).catch(e=>{if(null!=n&&"media"===r)return this.logger.warn("constraints failed. using fallback constraints",{constraints:o,fallbackConstraints:n,err:e}),this.prepareStream(r,n);throw e}),this.sync.finally(}))}prepareStream(e,i){var s,o;return r.__awaiter(this,void 0,void 0,(function*(){this.logger.trace("prepareStream() start",{constraints:i});let n=null;if(n="screencapture"===e?yield this.prepareScreenCaptureStream({audio:i.audio,video:this.options.defaultConstraints.screencapture}):"captureable"===e?yield this.prepareCapturableStream({audio:i.audio}):yield this.prepareMediaStream(i),n.getVideoTracks().forEach(i=>{i.addEventListener("ended",()=>r.__awaiter(this,void 0,void 0,(function*(){"media"===e&&(this.logger.warn("video track has ended unexpectedly (perm revoked?)"),yield t.mediaController.enumerateDevices(),(null==g?void 0:g.some(e=>"videoinput"===e.kind&&e.deviceId===this.videoDeviceId))||(this.logger.warn("Video device no longer exists in list of available devices, check to see if device was removed"),this.emit("videoDeviceRemoved",this.videoDeviceId),this.videoDeviceId=null))})))}),n.getAudioTracks().forEach(e=>{e.addEventListener("ended",()=>r.__awaiter(this,void 0,void 0,(function*(){this.logger.warn("audio track has ended unexpectedly (perm revoked?)"),yield t.mediaController.enumerateDevices(),(null==g?void 0:g.some()||(this.logger.warn("Audio device no longer exists in list of available devices, check to see if device was removed"),this.emit("audioDeviceRemoved",this.audioDeviceId),this.audioDeviceId=null)})))}),!1!==i.audio){const e=this.noEchoGainAmplifier&&"boolean"!=typeof i.audio&&!1===(null===(s=i.audio)||void 0===s?void 0:s.echoCancellation)?10*this.gain:this.gain;n=P(this.logger,n,e)}for(const e of null!==(o=null==n?void 0:n.getTracks())&&void 0!==o?o:[])"ended"===e.readyState&&this.throwError((0,h.createError)(l.ErrorCode.MediaTrackEnded,"track ended unexpectedly",{trackId:e.id,kind:e.kind})),"video"===e.kind&&(e.enabled=!this.videoPaused),"audio"===e.kind&&(e.enabled=!this.audioMuted);return this.logger.trace("prepareStream() finished"),n}))}prepareMediaStream(e){return r.__awaiter(this,void 0,void 0,(function*(){return this.logger.trace("prepareMediaStream()"),d.device.isImplements(d.Feature.MEDIA_DEVICE)&&null!=d.device.mediaDevices.getUserMedia||this.throwError((0,h.createError)(l.ErrorCode.MediaDeviceNotSupported,"MediaDevices not supported",{})),this.logger.debug("using constraints",{constraints:e}),d.device.mediaDevices.getUserMedia(e)}))}prepareScreenCaptureStream(e){var i,s;return r.__awaiter(this,void 0,void 0,(function*(){this.logger.trace("prepareScreenCaptureStream()",{constraints:e});let r=null,o=null;if(d.device.isImplements(d.Feature.MEDIA_STREAM)&&d.device.isImplements(d.Feature.MEDIA_DEVICE)&&"function"==typeof d.device.mediaDevices.getDisplayMedia){const t=null===(s=null===(i=d.device.mediaDevices)||void 0===i?void 0:i.getDisplayMedia)||void 0===s?void 0:s.call(i,{video:e.video});if(null!=t)try{r=yield t}catch(e){throw this.videoDeviceChanging=null,e}o=!1!==e.audio?yield this.prepareMediaStream({audio:e.audio}):new d.device.MediaStream}if(null==r||null==o)throw new Error("unable to capture screen");return r.getTracks().forEach(e=>{w.set(e,{deviceId:t.VIDEO_DEVICE_SCREENCAPTURE.deviceId}),null==o||o.addTrack(e)}),o}))}prepareCapturableStream(e){var i,s;return r.__awaiter(this,void 0,void 0,(function*(){this.logger.trace("prepareCapturableStream()",{constraints:e});let r=null,o=null;if(d.device.isImplements(d.Feature.MEDIA_STREAM)&&null!=(null===(i=this.capturable)||void 0===i?void 0:i.element)&&d.device.supportsMediaStreamCapture(null===(s=this.capturable)||void 0===s?void 0:s.element)?r=this.capturable.element.captureStream(this.capturable.framerate):this.logger.warn("unable to support stream capture"),d.device.isImplements(d.Feature.MEDIA_DEVICE)&&d.device.isImplements(d.Feature.MEDIA_STREAM)&&(o=!1===e.audio||null==e.audio?new d.device.MediaStream:yield this.prepareMediaStream({audio:e.audio})),null==r||null==o)throw new Error(`prepareCapturableStream(): unable to generate MediaStream from provided inputs. CapturableStream is null: ${null==r}. Base MediaStream is null: ${null==o}`);return r.getTracks().forEach(e=>{w.set(e,{deviceId:t.VIDEO_DEVICE_CAPTURABLE.deviceId}),null==o||o.addTrack(e)}),o}))}close(e="not provided"){var t;try{R(this.source),this.audioDeviceChanging=null,this.videoDeviceChanging=null,this.logger.info("MediaController Class close()",{aggregates:{reason:e}})}catch(t){this.emitError((0,h.createError)(l.ErrorCode.DisposingError,"unable to dispose media stream controller",{className:k.displayName,reason:e},t))}null===(t=this.audioCtx)||void 0===t||t.close().catch(}toJSON(){var e,t,i;return{audioMuted:this.audioMuted,videoPaused:this.videoPaused,videoDisabled:this.videoDisabled,inAudioDeviceTransition:this.inAudioDeviceTransition,inVideoDeviceTransition:this.inVideoDeviceTransition,hasSync:null!=this.sync,mscOptions:{replaceTracks:null===(e=this.options)||void 0===e?void 0:e.replaceTracks,waitingDelay:null===(t=this.options)||void 0===t?void 0:t.waitingDelay,defaultLockPolicy:null===(i=this.options)||void 0===i?void 0:i.defaultLockPolicy},aggregates:{audioDeviceId:this.audioDeviceId,videoDeviceId:this.videoDeviceId}}}}t.MediaStreamController=k,k.displayName="MediaStreamController"},"./node_modules/@video/video-client-core/lib/internal/media-loader.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/mobx/dist/mobx.esm.js"),o=i("./node_modules/@video/video-client-core/lib/api/index.js"),n=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),a=i("./node_modules/@video/video-client-core/lib/internal/errors.js"),l=i("./node_modules/@video/video-client-core/lib/internal/utils/context/context.js"),d=i("./node_modules/@video/video-client-core/lib/internal/utils/events/event-emitter.js"),c=i("./node_modules/@video/video-client-core/lib/utils/common.js"),u=["aac"];class p extends d.ObservableEventEmitter{constructor(e,t,i){super(),this.source=null,this.currentState="offline",this.formats={},this.uri=null,this.originalAuthToken=null,this.viewCount=0,this.pingUri=null,this.destroyed=!1,this.shouldBePolling=!1,this.manifest=null,this.type=null,this.pollingTimeout=null,this.noLongerUnauthorizedPolling=!1,this.unauthorizedRecoveryTimout=null,this.ctx=e,(0,l.onceCanceled)(e).then(,(0,s.makeObservable)(this,{source:s.observable.ref}),this.currentState="offline",this.formats={},this.pingUri=null,this.destroyed=!1,this.options=i,this.setManifest(t),this.setUri(t),this.shouldBePolling=!1,e.logger.attachObject(this),e.logger.trace("constructor()",{manifest:t}),this.addInnerDisposer(()=>{var e;this.destroyed=!0,clearInterval(null!==(e=this.pollingTimeout)&&void 0!==e?e:0)})}static modifyFormats(e){for(const t of Object.keys(e))if("mp4-ws"===t){const i=e[t];null!=(null==i?void 0:i.origin)&&u.includes(i.audioCodec)&&(i.origin=void 0)}return e}load(e=!1){var t,i,s,l,d,u,h,m,v,g,f;return r.__awaiter(this,void 0,void 0,(function*(){if(null!=this.manifest||this.vod)return this.emit("manifest",{state:this.currentState,formats:this.formats}),void(null!=this.manifest&&"string"!=typeof this.manifest&&(this.source=this.manifest));if(null==this.uri)return;this.ctx.logger.debug("loading manifest",{uri:this.uri});let r,b,_=null,y=null;const w=this.uri.split("?");let S;S=null!==(t=w[1])&&void 0!==t?t:"",S=(0,c.removeSearchParameterFromUrl)(S,"img"),S=`${S}&img=${e.toString()}`,S=(0,c.removeSearchParameterFromUrl)(S,"vdc"),(null==(null===(s=null===(i=this.options)||void 0===i?void 0:i.urlParams)||void 0===s?void 0:s.vdc)||(null===(d=null===(l=this.options)||void 0===l?void 0:l.urlParams)||void 0===d?void 0:d.vdc))&&(S+="&vdc=true"),S=(0,c.removeSearchParameterFromUrl)(S,"sbp"),(null==(null===(h=null===(u=this.options)||void 0===u?void 0:u.urlParams)||void 0===h?void 0:h.substitute)||(null===(v=null===(m=this.options)||void 0===m?void 0:m.urlParams)||void 0===v?void 0:v.substitute))&&(S+="&sbp=true");const E=`${w[0]}?${S}`;try{_=yield n.device.fetch(E,Object.assign({method:"GET"},null!=this.options.requestHeaders&&{headers:this.options.requestHeaders})),r=_.status}catch(e){r=null!==(g=null==_?void 0:_.status)&&void 0!==g?g:0,y=(0,a.createError)(o.ErrorCode.NetworkError,"Internal Error",{status:r})}if(this.isDisposed)return;r>499?y=(0,a.createError)(o.ErrorCode.NetworkError,"Internal Error",{status:r}):404===r?y=(0,a.createError)(o.ErrorCode.NetworkError,"Not Found",{status:r}):403===r?y=(0,a.createError)(o.ErrorCode.NetworkError,"Forbidden",{status:r}):401===r&&(y=(0,a.createError)(o.ErrorCode.NetworkError,"Unauthorized",{status:r}));let C=null;y||null==_||(b=yield _.json(),C=this.validateResponse(b)?b:null),y||null!=C||(y=(0,a.createError)(o.ErrorCode.NetworkError,"Unexpected Response",{status:r})),null!=y&&(404===r?this.ctx.logger.debug("manifest not found"):this.emitError(y)),this.ctx.logger.debug("manifest received",{body:C,code:r,uri:this.uri});let j=null;if(404===r||null==C||null==C.formats)j="offline";else if(200===r&&null!=C.self){let{self:e}=C;if(!e.includes("://")&&this.uri.includes("://")){const t=/(\w*:\/\/[^/]+)/.exec(this.uri);(null!==(f=null==t?void 0:t.length)&&void 0!==f?f:0)>1&&(e=`${null==t?void 0:t[1]}/${e}`)}this.uri=e}if(null==j&&null!=(null==C?void 0:C.formats)&&(this.formats=p.modifyFormats(C.formats),j=0===Object.keys(this.formats).length?"offline":"online"),"online"===j&&null!=(null==C?void 0:C.viewCount)&&(this.viewCount=C.viewCount),null==j){const e=r>=400?"Network error while retrieving manifest":"Invalid manifest";this.throwError((0,a.createError)(o.ErrorCode.ManifestError,e,{url:this.uri},y))}j!==this.currentState&&this.emit(j),this.currentState=j,this.pingUri=null!=(null==C?void 0:C.ping)?C.ping:null,this.type=null!=(null==C?void 0:C.type)?C.type:"live",this.emit("manifest",{state:this.currentState,code:r,formats:this.formats,viewCount:this.viewCount}),null!=C&&(this.source=C),"recorded"!==(null==C?void 0:C.type)&&this.setNextPoll(r)}))}setNextPoll(e){var t;if(this.vod)return;n.device.clearTimeout(null!==(t=this.pollingTimeout)&&void 0!==t?t:0);let i=this.options.pollingInterval;switch(e){case 401:case 403:if(this.noLongerUnauthorizedPolling)return this.currentState="forbidden",void this.emit("manifest",{state:this.currentState,code:e,formats:this.formats});i=this.options.unauthorizedPollingInterval,null==this.unauthorizedRecoveryTimout&&(this.unauthorizedRecoveryTimout=n.device.setTimeout(()=>{this.noLongerUnauthorizedPolling=!0},this.options.unauthorizedRecoveryDuration));break;case 404:i=this.options.notFoundPollingInterval;break;default:this.noLongerUnauthorizedPolling=!1}this.pollingTimeout=n.device.setTimeout(()=>{this.load().catch(},i)}setManifest(e){var t,i,r,s;if(this.type=null,this.formats={},"string"==typeof e?this.uri=e:this.validateResponse(e)&&(this.uri=null!==(t=e.self)&&void 0!==t?t:null,this.manifest=e,this.currentState="online",this.type=null!==(i=this.manifest.type)&&void 0!==i?i:null,this.formats=null!==(r=this.manifest.formats)&&void 0!==r?r:{}),null==this.uri)return;const o=this.uri.indexOf("accessToken=");if(o>-1){const e=this.uri.slice(o+12),t=null!==(s=e.indexOf("&"))&&void 0!==s?s:-1;this.originalAuthToken=t>-1?e.slice(0,t):e}}alidateResponse(e){var t,i,r;try{const s=null===(t=e.formats)||void 0===t?void 0:t.webrtc;null!=s&&("string"==typeof(null===(i=s.origin)||void 0===i?void 0:i.location)&&(s.origin.location=null===(r=s.origin)||void 0===r?void 0:r.location.replace(/https?:\/\/(https?):?\/\//,"$1://")),"string"==typeof s.origin.rsrc&&(s.origin.rsrc=s.origin.rsrc.replace(/:3000:3000/,":3000")))}catch(e){return this.emitError((0,a.createError)(o.ErrorCode.BadManifest,"bad manifest",{},e)),!1}return!0}setUri(e){return null==e?null!=this.uri:"string"==typeof e?(this.uri=e,!0):this.validateResponse(e)?(this.manifest=e,null!=e.self&&(this.uri=e.self),!0):(this.emitError((0,a.createError)(o.ErrorCode.BadManifest,"Invalid Media URL",{})),!1)}get(e){var t;const i=this.formats[e];if(null==i)return{encodings:[],state:"online",auto:!1,driver:""};let r,s=[];return"origin"in i&&null!=i.origin&&(r=i.origin,r.origin=!0),"encodings"in i&&null!=i.encodings&&(s=i.encodings.sort((e,t)=>{var i,r,s,o;return(null!==(i=e.videoKbps)&&void 0!==i?i:0)+(null!==(r=e.audioKbps)&&void 0!==r?r:0)>(null!==(s=t.videoKbps)&&void 0!==s?s:0)+(null!==(o=t.audioKbps)&&void 0!==o?o:0)?1:-1})),{type:null!==(t=this.type)&&void 0!==t?t:void 0,origin:null!=r?r:void 0,encodings:s,audioCodec:"audioCodec"in i?i.audioCodec:void 0,videoCodec:"videoCodec"in i?i.videoCodec:void 0,manifest:"manifest"in i?i.manifest:void 0,state:"online",auto:!1,driver:""}}tartInterval(){null==this.options.pollingInterval||null!=this.manifest||this.vod?this.shouldBePolling=!1:this.shouldBePolling=!0}toJSON(){return{uri:this.uri,options:this.options,aggregates:{support:this.ctx.support.hash,state:this.currentState}}}}p.displayName="MediaLoader",t.default=p},"./node_modules/@video/video-client-core/lib/internal/mediasoup-source.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MediasoupSource=void 0;const r=i("./node_modules/@video/video-client-core/node_modules/@video/log-node/index.js"),s=i("./node_modules/mobx/dist/mobx.esm.js"),o=i("./node_modules/@video/video-client-core/lib/api/index.js"),n=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),a=i("./node_modules/@video/video-client-core/lib/internal/errors.js"),l=i("./node_modules/@video/video-client-core/lib/internal/player/helper.js"),d=i("./node_modules/@video/video-client-core/lib/internal/utils/events/event-emitter.js"),c={replaceTracks:!0};class u extends d.ObservableEventEmitter{constructor(e,t,i,r=c){var l;super(),this.consumers={},this.currentQuality=null,this.availableQualities=[],this.ctx=e,(0,s.makeObservable)(this,{currentQuality:s.observable.ref,availableQualities:s.observable.shallow}),n.device.isImplements(n.Feature.MEDIA_STREAM)||this.throwError((0,a.createError)(o.ErrorCode.MediaStreamNotSupported,"MediaStream is not supported by device",{})),this.options=r,this.peer=t,this.streamName=i,this.stream=new n.device.MediaStream,null===(l=this.peer.call)||void 0===l||l.on("accessDenied",this.handlePeerAccessDenied),this.addInnerDisposer(()=>{var e;null===(e=this.peer.call)||void 0===e||e.removeListener("accessDenied",this.handlePeerAccessDenied)}),e.logger.attachObject(this),e.logger.trace("constructor()")}handlePeerAccessDenied(e){this.emit("accessDenied",e)}get source(){return this.stream}get consumerIds(){return Object.keys(this.consumers)}addConsumer(e,t=!0){if(!e.dontAdd){if("video"===e.track.kind&&this.stream.getVideoTracks().length>0&&this.stream.getVideoTracks().forEach(e=>this.stream.removeTrack(e)),"audio"===e.track.kind&&this.stream.getAudioTracks().length>0&&this.stream.getAudioTracks().forEach(,"video"===e.track.kind){const t=(0,l.fetchManifestQualities)(e.layers,null);(0,s.runInAction)(()=>{this.availableQualities=t;const i=e.activeLayer;if(null!=i){const t=this.availableQualities.find(e=>{var t;return(null===(t=e.layer)||void 0===t?void 0:t.id)===i.id});null!=t?this.currentQuality=t:this.ctx.logger.warn("Consumer refers to a layer which doesn't exist",{layers:e.layers,activeLayer:e.activeLayer})}})}this.stream.addTrack(e.track)}this.consumers[e.id]=e,t&&!e.dontAdd&&this.emit("source",this.stream)}removeConsumer(e,t=!0){const i=this.consumers[e];null!=i&&(this.stream.removeTrack(i.track),delete this.consumers[e],this.stream.getTracks().length>0&&t&&this.emit("source",this.stream))}swapConsumers(e,t){t.forEach(e=>{this.stream.removeTrack(e)}),e.forEach(,this.emit("source",this.stream)}pauseConsumer(e){const t=this.consumers[e];null!=t&&(t.paused=!0,this.stream.getTracks().some(e=>e.id===t.track.id)&&("video"===t.kind?this.emit("videoPaused",t.paused):this.emit("audioMuted",t.paused)))}resumeConsumer(e){const t=this.consumers[e];null!=t&&(t.paused=!1,this.stream.getTracks().some(&&("video"===t.kind?this.emit("videoPaused",t.paused):this.emit("audioMuted",t.paused)))}consumerLayersChanged(e){const t=this.availableQualities.find(;null!=t&&(this.currentQuality=t)}consumerSourcesChanged(e){const t=(0,l.fetchManifestQualities)(e,null);this.availableQualities=t}getTracks(){return this.stream.getTracks()}get hasAudio(){return Object.values(this.consumers).some(e=>"audio"===e.kind&&!1===e.dontAdd)}get hasVideo(){return Object.values(this.consumers).some(e=>"video"===e.kind&&!1===e.dontAdd)}get audioMuted(){const e=Object.values(this.consumers).filter(e=>"audio"===e.kind&&!1===e.dontAdd);return 0===e.length||e.some(e=>e.paused)}get videoPaused(){const e=Object.values(this.consumers).filter(;return 0===e.length||e.some(e=>e.paused)}toJSON(){return{hasAudio:this.hasAudio,hasVideo:this.hasVideo,audioMuted:this.audioMuted,videoPaused:this.videoPaused,options:this.options,aggregates:Object.assign(Object.assign({},(0,r.extractAggregates)(this.peer,"support")),{support:this.ctx.support.hash,streamName:this.streamName})}}}t.MediasoupSource=u,u.displayName="MediasoupSource"},"./node_modules/@video/video-client-core/lib/internal/peer.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Peer=void 0;const r=i("./node_modules/@video/video-client-core/node_modules/@video/log-node/index.js"),s=i("./node_modules/mobx/dist/mobx.esm.js"),o=i("./node_modules/@video/video-client-core/lib/api/error.js"),n=i("./node_modules/@video/video-client-core/lib/internal/errors.js"),a=i("./node_modules/@video/video-client-core/lib/internal/mediasoup-source.js"),l=i("./node_modules/@video/video-client-core/lib/internal/player/mediasoup.js"),d=i("./node_modules/@video/video-client-core/lib/internal/utils/context/context.js"),c=i("./node_modules/@video/video-client-core/lib/internal/utils/events/event-emitter.js"),u=i("./node_modules/@video/video-client-core/lib/internal/utils/logger.js");class p extends c.ObservableEventEmitter{constructor(e,t,i,r,o){super(),this.remoteSources=new Map,(0,s.makeObservable)(this,{remoteSources:s.observable,streams:s.computed,players:s.computed}),this.ctx=e,this.call=t,this.pvcCall=i,this.playerOptions=null!=o?o:{},this.pvcCall.on("CALL_ADD_CONSUMER",this.addConsumer),this.pvcCall.on("CALL_REMOVE_CONSUMER",this.removeConsumer),this.pvcCall.on("CALL_SWAP_CONSUMERS",this.swapConsumers),this.pvcCall.on("CALL_SET_CONSUMER_PAUSED",this.pauseConsumer),this.pvcCall.on("CALL_SET_CONSUMER_RESUMED",this.resumeConsumer),this.pvcCall.on("CALL_CONSUMER_LAYER_CHANGED",this.layerChanged),this.pvcCall.on("CALL_CONSUMER_SOURCES",this.sourcesChanged),(0,d.onceCanceled)(e).then(e=>this.dispose("Peer Context Cancelled: "+e)),this.peerParams=r,e.logger.attachObject(this),e.logger.trace("constructor()"),this.addInnerDisposer(this.close)}get streams(){return Array.from(this.remoteSources.values()).map(e=>e.provider)}et peerId(){var e;return null!==(e=this.peerParams.peerId)&&void 0!==e?e:""}dConsumer({peerId:e,streamName:t,consumer:i}){var r,s,d;if(e===this.peerParams.peerId){this.ctx.logger.debug("addConsumer()",{streamName:t,consumerId:i.id});try{const e=this.remoteSources.get(t);if(null==e){const e=new a.MediasoupSource((0,u.extendContext)(this.ctx,a.MediasoupSource),this,t),o=Object.assign({autoPlay:null===(d=null===(s=null===(r=null==this?void 0:this.ctx)||void 0===r?void 0:r.videoClient)||void 0===s?void 0:s.options)||void 0===d?void 0:d.autoPlay},this.playerOptions),n=new l.MediasoupPlayer((0,u.extendContext)(this.ctx,l.MediasoupPlayer),e,o);this.emit("videoConsumer"),e.addConsumer(i),this.remoteSources.set(t,{player:n,provider:e}),this.emit("playerAdded",{player:n,streamName:t,peer:this}),this.emit("streamAdded",{stream:e,streamName:t,peer:this})}else e.provider.addConsumer(i)}catch(t){let r="Consumer has not created";(0,o.isVideoClientError)(t)&&t.code===n.ErrorCode.MediaStreamNotSupported&&(r="Consumer has not created because MediaStream is not supported"),this.emitError((0,n.createError)(n.ErrorCode.ConsumerNotCreated,r,{consumerId:i.id,peerId:e},t))}}}removeConsumer({peerId:e,streamName:t,consumerId:i}){var r;if(e!==this.peerParams.peerId)return;this.ctx.logger.trace("removeConsumer()",{peerId:e,streamName:t,consumerId:i});const s=this.remoteSources.get(t);null!=s?(s.provider.removeConsumer(i),0===s.provider.getTracks().length&&(this.emit("playerRemoved",{player:s.player,streamName:t,peer:this}),this.emit("streamRemoved",{stream:s.provider,streamName:t,peer:this}),this.remoteSources.delete(t))):(null===(r=this.pvcCall._wsTransport)||void 0===r?void 0:r.closed)?this.ctx.logger.debug("Unable to remove consumer, stream not found. Ws closed.",{peerId:e,streamName:t,consumerId:i}):this.ctx.logger.warn("Unable to remove consumer stream not found",{peerId:e,streamName:t,consumerId:i})}swapConsumers({peerId:e,streamName:t,add:i,remove:r}){if(e!==this.peerParams.peerId)return;this.ctx.logger.trace("swapConsumer()",{peerId:e,streamName:t,add:i.map(e=>e.id),remove:r.map(e=>e.id)});const s=this.remoteSources.get(t);null!=s?s.provider.swapConsumers(i,r):this.ctx.logger.warn("Unable to swap consumer stream not found",{peerId:e,streamName:t})}pauseConsumer({peerId:e,streamName:t,consumerId:i}){if(e!==this.peerParams.peerId)return;this.ctx.logger.debug("CALL_SET_CONSUMER_PAUSED",{streamName:t,consumerId:i});const r=this.remoteSources.get(t);null!=r?r.provider.pauseConsumer(i):this.ctx.logger.warn("Unable to pause consumer stream not found",{peerId:e,streamName:t,consumerId:i})}resumeConsumer({peerId:e,streamName:t,consumerId:i}){if(e!==this.peerParams.peerId)return;this.ctx.logger.debug("CALL_SET_CONSUMER_RESUMED",{streamName:t,consumerId:i});const r=this.remoteSources.get(t);null!=r?r.provider.resumeConsumer(i):this.ctx.logger.warn("Unable to resumeConsumer stream not found",{peerId:e,streamName:t,consumerId:i})}layerChanged(e){if(e.peerId!==this.peerParams.peerId)return;this.ctx.logger.debug("CALL_CONSUMER_LAYER_CHANGED",{ev:e});const t=this.remoteSources.get(e.streamName);null!=t?t.provider.consumerLayersChanged(e):this.ctx.logger.warn("Unable to change layer stream not found",{streamName:e.streamName,ev:e})}sourcesChanged(e){if(e.peerId!==this.peerParams.peerId)return;this.ctx.logger.debug("CALL_CONSUMER_SOURCES",{ev:e});const t=this.remoteSources.get(e.streamName);null!=t?t.provider.consumerSourcesChanged(e.layers):this.ctx.logger.warn("Unable to change source stream not found",{remoteSources:Object.fromEntries(this.remoteSources.entries()),streamName:e.streamName,ev:e})}close(){this.pvcCall.off("CALL_ADD_CONSUMER",this.addConsumer),this.pvcCall.off("CALL_REMOVE_CONSUMER",this.removeConsumer),this.pvcCall.off("CALL_SET_CONSUMER_PAUSED",this.pauseConsumer),this.pvcCall.off("CALL_SET_CONSUMER_RESUMED",this.resumeConsumer),this.pvcCall.off("CALL_CONSUMER_LAYER_CHANGED",this.layerChanged);for(const[e,t]of this.remoteSources.entries())t.provider.consumerIds.forEach(t=>{this.removeConsumer({peerId:this.peerId,streamName:e,consumerId:t})})}setPreferredEncoding(e){var t;const i=null===(t=e.appData)||void 0===t?void 0:t.consumerId;null!=i&&"string"==typeof i||this.throwError((0,n.createError)(n.ErrorCode.UnableChangeBitrate,"unable to set preferred encoding because consumerId is not provided",{layerId:e.id,peerId:this.peerId})),this.ctx.logger.info("setPreferredEncoding",{layer:e}),this.pvcCall.setPreferredEncoding(i,e.id)}toJSON(){return{call:this.call,aggregates:Object.assign(Object.assign({},(0,r.extractAggregates)(this.call,"support")),{support:this.ctx.support.hash,peerId:this.peerId})}}}t.Peer=p,p.displayName="Peer"},"./node_modules/@video/video-client-core/lib/internal/player/core.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CorePlayer=t.proxyHandler=t.timeupdateWrapper=void 0;const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/@video/log-client/index.js"),o=i("./node_modules/mobx/dist/mobx.esm.js"),n=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),a=i("./node_modules/@video/video-client-core/lib/api/adapter/features/feature.js"),l=i("./node_modules/@video/video-client-core/lib/api/player/features/bitrate-switching.js"),d=i("./node_modules/@video/video-client-core/lib/api/player/features/feature.js"),c=i("./node_modules/@video/video-client-core/lib/api/typings/video-element.js"),u=i("./node_modules/@video/video-client-core/lib/internal/errors-deprecated.js"),p=i("./node_modules/@video/video-client-core/lib/internal/mediasoup-source.js"),h=i("./node_modules/@video/video-client-core/lib/internal/utils/context/context.js"),m=i("./node_modules/@video/video-client-core/lib/internal/utils/debug/play-logs.js"),v=i("./node_modules/@video/video-client-core/lib/internal/utils/events/event-emitter.js"),g=i("./node_modules/@video/video-client-core/lib/internal/utils/proxy/sync-handler.js"),f=i("./node_modules/@video/video-client-core/lib/internal/utils/timeupdate-wrapper.js"),b=i("./node_modules/@video/video-client-core/lib/internal/player/helper.js"),_=i("./node_modules/@video/video-client-core/lib/internal/player/media-element-supervisor.js"),y=[0,1e3,2e3,5e3,25e3],w={bufferOverflowCount:0,bufferUnderflowCount:0,currentErrorCount:0,downshift:0,fragCounts:0,fragDownloadTime:0,fragDuration:0,fragMaxTime:0,fragMinTime:0,fragFetchTime:0,fragSize:0,lastProgress:0,recentErrorCount:0,restartCount:0,upshift:0};t.timeupdateWrapper=new f.TimeupdateWrapper,t.proxyHandler=new g.SyncHandler({logger:new s.LoggerCore("VDC-core"),methods:{isSupported:"postpone",initVideoEl:"postpone",getClosestQuality:"stub"}});const S={bitrate:null,muted:!1,volume:.75,autoPlay:!0,origin:!1,preset:null,recoverErrorCount:0,timeout:3e4,driverFailover:!0};class E extends v.ObservableEventEmitter{get logger(){return this.ctx.logger}get poster(){return this._poster}set poster(e){null!=e&&null!=this.elementSupervisor&&this.elementSupervisor.setPoster(e),this._poster=e}get activeLayer(){var e,t;return null!==(t=null===(e=this.currentQuality)||void 0===e?void 0:e.layer)&&void 0!==t?t:null}get layers(){return(0,b.getBitrateLayersFromQualities)(this.availableQualities)}constructor(e,t,i){var r,s;if(super(),this.counters=w,this.lockRestart=!1,this.clearRestartCount=0,this.playingPromise=null,this.elementSupervisor=null,this.consumerAudioMuted=void 0,this.consumerVideoPaused=void 0,this.lowPowerMode=!1,this.internalPaused=!1,this.qualityEqual=!1,this.internalMuted=!1,this.internalVolume=1,this.startedPlaying=!1,this.pausedOnUnmount=!1,this.mutedOnHidden=!1,this.autoPlay=!0,this.driverFailover=!0,this.forcedMute=!1,this.source=null,this.errors={},this.availableQualities=[],this.currentQuality=null,this.isConnecting=null,this.isConnected=null,this.blurred=!1,this.qualityHasChanged=!1,this.successfulPlayTimeStamp=null,this._poster=null,this.preferredLevel=null,(0,o.makeObservable)(this,{consumerAudioMuted:o.observable,consumerVideoPaused:o.observable,internalPaused:o.observable,internalMuted:o.observable,internalVolume:o.observable,forcedMute:o.observable,source:o.observable.ref,availableQualities:o.observable.shallow,currentQuality:o.observable.shallow,_poster:o.observable,driverFailover:o.observable,blurred:o.observable,preferredLevel:o.observable,lowPowerMode:o.observable,attached:o.computed,localVideoPaused:o.computed,localAudioMuted:o.computed,localAudioVolume:o.computed,poster:o.computed,attachTo:o.action}),this.ctx=e,this.options=null!=i?i:S,null!=this.options.autoPlay&&(this.autoPlay=this.options.autoPlay),this.provider=t,this.internalPaused=!this.autoPlay,null!=(null===(r=this.options)||void 0===r?void 0:r.muted)&&(this.internalMuted=this.options.muted),null!=(null===(s=this.options)||void 0===s?void 0:s.volume)&&(this.localAudioVolume=this.options.volume),this.addInnerDisposer((0,o.reaction)(([e,t])=>{if(null!=t||1!==(null==e?void 0:e.length)&&"flv-http"!==this.format){if(null==t&&1!==(null==e?void 0:e.length))return void(this.currentQuality=null)}else t=l.TranscodeScoreLevel.Highest;if(null!=t&&null!=e){const i=(0,b.findClosestQuality)(t,e);i!==this.currentQuality&&(this.qualityHasChanged=!0),this.currentQuality=i,this.qualityHasChanged&&this.updatePosterWithLatestFrame(),null!=this.currentQuality&&null!=this.provider.source&&this.handleSource(this.provider.source)}},{equals:o.comparer.structural})),e.logger.attachObject(this),e.logger.trace("constructor()",{options:this.options}),(0,h.onceCanceled)(e).then(e=>this.dispose("Core Player Context Cancelled: "+e)),this._handleVisibilityChange=()=>{(n.device.isIosDevice||n.device.isAndroidDevice)&&(n.device.hidden?(this.mutedOnHidden=this.internalMuted,this.localAudioMuted=!0):this.localAudioMuted=this.mutedOnHidden)},n.device.addEventListener("visibilitychange",this._handleVisibilityChange),this.provider.on("source",this.handleSource),this.provider.on("source",this.isSource),this.provider.on("audioMuted",this.handleAudioMuted),this.provider.on("videoPaused",this.handleVideoPaused),this.provider instanceof p.MediasoupSource&&this.provider.on("accessDenied",this.handleProviderAccessDenied),this.addInnerDisposer(()=>{this.provider.off("source",this.handleSource),this.provider.off("source",this.isSource),this.provider.off("audioMuted",this.handleAudioMuted),this.provider.off("videoPaused",this.handleVideoPaused),n.device.removeEventListener("visibilitychange",this._handleVisibilityChange),this.provider instanceof p.MediasoupSource&&this.provider.off("accessDenied",this.handleProviderAccessDenied)}),null!=this.provider.source){const e=this.provider.source;setTimeout(()=>{this.handleSource(e)},0)}}updatePosterWithLatestFrame(){null!=this.elementSupervisor&&n.device.isImplements(a.Feature.CREATE_SCREENSHOT)?this.poster=this.elementSupervisor.createScreenshot():this.ctx.logger.warn("Unable to set update poster. Create screenshot is not compatible with device.")}ready(){return r.__awaiter(this,void 0,void 0,(function*(){if(null==this.source)return this.ctx.logger.debug("no source, not ready"),new Promise((e,t)=>{let i;const r=(0,o.autorun)(t=>{null!=this.source&&(t.dispose(),n.device.clearTimeout(i),e())});null!=this.options.timeout&&(i=n.device.setTimeout(()=>{r();const e=new u.PlayingIssueError(`timeout after ${this.options.timeout}ms`,{player:this});this.emitErrorDeprecated(e),this.options.driverFailover&&this.emit("driverFailover",!0),t(e)},this.options.timeout))})}))}handleAudioMuted(e){this.consumerAudioMuted=e}handleVideoPaused(e){this.consumerVideoPaused=e}sSource(){this.provider instanceof p.MediasoupSource&&(this.consumerVideoPaused=!this.provider.hasVideo||this.provider.videoPaused)}get attached(){return null!=this.elementSupervisor}get localVideoPaused(){return this.internalPaused}set localVideoPaused(e){this.internalPaused=e,null!=this.elementSupervisor&&(this.internalPaused?this.pauseEl():(()=>{r.__awaiter(this,void 0,void 0,(function*(){try{yield this.play()}catch(e){this.emitErrorDeprecated(new u.PlayingIssueError("VideoElement.play() error",{inner:e instanceof Error?e:null,player:this}))}}))})())}pauseEl(){var e;null===(e=this.elementSupervisor)||void 0===e||e.pause()}get localAudioMuted(){return this.internalMuted}et localAudioVolume(){return this.internalVolume}set localAudioVolume(e){e>1||e<0?this.ctx.logger.warn(`Volume level not set. ${e} is not a valid volume value for an HTMLMediaElement. Volume levels must be between 0-1.`):(this.internalVolume=e,null!=this.elementSupervisor&&(this.elementSupervisor.volume=e))}handleElPlay(){this.suspended||(this.internalPaused?(this.ctx.logger.warn("A try to call .play() on HTMLVideoElement outside the Player"),this.internalPaused=!1):this.ctx.logger.info(".play() called on HTMLVideoElement"))}handleElPause(){if(!this.suspended&&!this.internalPaused&&null!=this.elementSupervisor){if(!this.elementSupervisor.paused)return;this.play().catch(e=>{n.device.setTimeout(this.handleElPause,50),this.ctx.logger.error("An error occured on the play() request",{err:(0,u.wrapNativeError)(e)})})}}handleElError(){var e,t;if(null==this.elementSupervisor||this.suspended)return;const i=c.MediaErrorCodeConstants[null!==(t=null===(e=this.elementSupervisor.error)||void 0===e?void 0:e.code)&&void 0!==t?t:0];this.ctx.logger.warn("VideoElement Error: "+i)}handleElVolumeChange(){null==this.elementSupervisor||this.suspended||(Math.abs(this.internalVolume-this.elementSupervisor.volume)>.01&&(this.ctx.logger.warn("A try to change volume on HTMLVideoElement outside the Player"),this.elementSupervisor.volume=this.internalVolume),this.elementSupervisor.muted!==this.internalMuted&&(this.elementSupervisor.muted=this.internalMuted))}attachTo(e){return r.__awaiter(this,void 0,void 0,(function*(){this.ctx.logger.trace("attachTo()",{el:(0,m.dumpVideoElement)(e)}),this.elementSupervisor=_.MediaElementSupervisor.getSupervisor(e).attachToPlayer(this),this.pausedOnUnmount=this.internalPaused,this.ctx.logger.debug("attach to host element",{element:(0,m.dumpVideoElement)(e),options:this.options}),this.initVideoEl(this.elementSupervisor).catch(,null!=this.source&&(this.emit("hostElementAttached",{el:e}),this.ctx.logger.debug("hostElementAttached",{el:(0,m.dumpVideoElement)(e)}))}))}initVideoEl(e,t=!1){return r.__awaiter(this,void 0,void 0,(function*(){e.muted=this.internalMuted,e.volume=this.internalVolume,t&&(this.pausedOnUnmount=this.internalPaused),this.pausedOnUnmount||"flv-http"===this.format?e.autoplay=!1:e.autoplay=!0,this.startedPlaying=!1,null!=this._poster&&e.setPoster(this._poster),this.ctx.logger.debug("host element is initialized",{autoPlay:this.options.autoPlay,internalPaused:this.internalPaused,internalMuted:this.internalMuted}),null!=this.source&&("string"==typeof this.source?e.updateSrc(this.source):e.updateSrcObject(this.source)),this.pausedOnUnmount||(this.ctx.logger.info("core: initVideoEl() -> await play()"),yield this.play())}))}handleElProgress(){n.device.isImplements(a.Feature.DEBUGGING)?this.counters.lastProgress=n.device.performance.now():this.counters.lastProgress=Date.now(),this.emit("progress")}handleElTimeupdate(){if(null!=this.elementSupervisor){this.elementSupervisor.isVideoPlaying()&&!this.startedPlaying&&(this.startedPlaying=!0,this.successfulPlayTimeStamp=Date.now(),this.emit("videoFirstPlay"))}if(null!=this.successfulPlayTimeStamp){15===Math.floor((Date.now()-this.successfulPlayTimeStamp)/1e3)&&(this.ctx.logger.debug("Successful playback."),this.successfulPlayTimeStamp=null)}this.counters.fragCounts+=1,this.emit("timeupdate")}bufferTimes(){var e,t,i;const r=null!==(i=null===(t=null===(e=this.elementSupervisor)||void 0===e?void 0:e.buffered)||void 0===t?void 0:t.length)&&void 0!==i?i:0;for(let e=0;null!=this.elementSupervisor&&e<r;e++)yield[this.elementSupervisor.buffered.start(e),this.elementSupervisor.buffered.end(e)]}get details(){var e;return{bufferOverflowCount:this.counters.bufferOverflowCount,bufferUnderflowCount:this.counters.bufferUnderflowCount,downshift:this.counters.downshift,errors:null!==(e=this.errors)&&void 0!==e?e:{},muted:this.localAudioMuted,segments:this.counters.fragCounts,segmentsSize:this.counters.fragSize,segmentsDuration:this.counters.fragDuration,segmentTotalDownloadTime:this.counters.fragDownloadTime,segMaxTime:this.counters.fragMaxTime,segMinTime:this.counters.fragMinTime,upshift:this.counters.upshift,volume:this.localAudioVolume}}restart(e){var t;return r.__awaiter(this,void 0,void 0,(function*(){if(this.ctx.logger.info("restart()",{immediate:e}),!this.lockRestart)return this.lockRestart=!0,this.counters.currentErrorCount=0,this.counters.recentErrorCount=0,this.counters.restartCount+=1,e?new Promise(t=>{this.stop();try{this.play(e).then(()=>{this.lockRestart=!1,t()})}catch(e){this.ctx.logger.error("An error occured on the play() request",{err:(0,u.wrapNativeError)(e)})}}):(n.device.clearTimeout(null!==(t=this.clearRestartCount)&&void 0!==t?t:0),this.clearRestartCount=n.device.setTimeout(2*y[y.length-1]),this.emit("restartDriver",{timeout:y[Math.min(this.counters.restartCount,y.length-1)]}),this.restartTimeout())}))}restartTimeout(){return r.__awaiter(this,void 0,void 0,(function*(){return new Promise(e=>{n.device.setTimeout(()=>{if(!this.isDisposed){this.stop();try{this.play().then(}catch(e){this.ctx.logger.error("An error occured on the play() request",{err:(0,u.wrapNativeError)(e)})}}},y[Math.min(this.counters.restartCount,y.length-1)])})}))}stop(){null!=this.elementSupervisor&&(this.elementSupervisor.updateSrc(""),this.elementSupervisor.updateSrcObject(null))}play(e=!1){var t;return r.__awaiter(this,void 0,void 0,(function*(){return this.ctx.logger.info("play()",{videoEl:null===(t=this.elementSupervisor)||void 0===t?void 0:t.dumpVideoElement(),aggregates:{debug:"play"}}),yield this.ready(),this.ctx.logger.info("ready to play",{aggregates:{debug:"play"}}),null==this.elementSupervisor?(this.ctx.logger.warn("a try to play without host element attached",{aggregates:{debug:"play"}}),!1):this.elementSupervisor.isSourceSet()?(null==this.playingPromise&&(this.ctx.logger.setMessageAggregate("debug","play"),this.ctx.logger.setMessageAggregate("playImmediately",e),this.ctx.logger.setMessageAggregate("hasPlayingPromise",null!=this.playingPromise),this.playingPromise=this.playInternal(this.elementSupervisor,e).then(()=>{var e;return this.ctx.logger.trace("playingPromise.then()"),!(null===(e=this.elementSupervisor)||void 0===e?void 0:e.paused)}).catch(e=>(this.ctx.logger.trace("playingPromise.catch()",{err:(0,u.wrapNativeError)(e)}),e)).finally(()=>{this.ctx.logger.trace("playingPromise.finally()"),this.playingPromise=null,this.ctx.logger.removeMessageAggregate("debug"),this.ctx.logger.removeMessageAggregate("playImmediately"),this.ctx.logger.removeMessageAggregate("hasPlayingPromise")})),this.playingPromise):(this.ctx.logger.debug("nothing to play",{aggregates:{debug:"play"}}),!1)}))}playInternal(e,t=!1){var i;return r.__awaiter(this,void 0,void 0,(function*(){if(this.ctx.logger.trace("playInternal()"),(0,c.isMediaStream)(e.srcObject)&&(null===(i=e.srcObject)||void 0===i?void 0:i.getTracks().length)<=0)return;n.device.isImplements(a.Feature.BROWSER_TYPE)&&"safari"===n.device.browserInfo.name&&"mp4-hls"===this.format&&(this.ctx.logger.info("playInternal safari hls bypassing loadeddata check"),t=!0);const r=t?e.play.bind(e):b.playOncePossible.bind(null,e,this.ctx.logger);try{this.ctx.logger.trace("playInternal() trying playDelegate (first time)"),yield r()}catch(e){if(!(e instanceof Error))throw this.ctx.logger.info("playDelegate unknown error type",{errType:typeof e,player:this}),e;{const i={inner:(0,u.wrapNativeError)(e),playImmediately:t,player:this};if("AbortError"!==e.name&&"NotAllowedError"!==e.name||this.localAudioMuted||!this.isImplements(d.Feature.MUTED_AUTOPLAY)){this.ctx.logger.info("bypassed forcedMute autoplay",{errName:e.name,localAudioMuted:this.localAudioMuted,implementsMutedAutoplay:this.isImplements(d.Feature.MUTED_AUTOPLAY)});try{yield new Promise(,yield r(),this.ctx.logger.info("playDelegate playing (one more time just in case)",i)}catch(t){t instanceof Error&&(0,b.isInLowPowerMode)(t)?(this.lowPowerMode=!0,this.ctx.logger.info("iOS Device in low power mode, cannot autoplay",{err:(0,u.wrapNativeError)(e),lowPowerMode:this.lowPowerMode})):this.throwErrorDeprecated(new u.PlayingIssueError("playDelegate error after second try",i))}}else{this.ctx.logger.info("attempting forcedMute play",i),this.localAudioMuted=!0,this.forcedMute=!0;try{yield r(),this.ctx.logger.info("playDelegate playing muted due to low page engagement",i)}catch(t){t instanceof Error&&(0,b.isInLowPowerMode)(t)?(this.lowPowerMode=!0,this.ctx.logger.info("iOS Device in low power mode, cannot autoplay",{err:(0,u.wrapNativeError)(e),lowPowerMode:this.lowPowerMode})):this.throwErrorDeprecated(new u.PlayingIssueError("playDelegate error after mute play",i))}}}}finally{this.ctx.logger.trace("playInternal() finally"),this.internalPaused=e.paused}}))}checkRestart(e){return r.__awaiter(this,void 0,void 0,(function*(){const t=e;if(this.counters.recentErrorCount+=1,n.device.setTimeout(()=>{this.counters.recentErrorCount-=1,this.counters.recentErrorCount=Math.max(this.counters.recentErrorCount,0)},1e4),this.counters.recentErrorCount>=10&&(t.fatal=!0),this.counters.currentErrorCount>=10&&(t.fatal=!0),t.fatal)return this.restart(!1)}))}setPreferredLevel(e){this.preferredLevel=e}SON(){var e;return{availableQualities:(0,o.toJS)(this.availableQualities),currentQuality:(0,o.toJS)(this.currentQuality),attached:this.attached,counters:this.counters,aggregates:Object.assign({support:this.ctx.support.hash,autoPlay:this.autoPlay,localAudioMuted:this.localAudioMuted,localVideoPaused:this.localVideoPaused,playingPromise:null==this.playingPromise,format:this.format},null===(e=this.elementSupervisor)||void 0===e?void 0:e.dumpVideoElement())}}}t.CorePlayer=E},"./node_modules/@video/video-client-core/lib/internal/player/flv-http.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlvHttpPlayer=void 0;const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),o=i("./node_modules/@video/video-client-core/lib/api/player/features/feature.js"),n=i("./node_modules/@video/video-client-core/lib/internal/errors-deprecated.js"),a=i("./node_modules/@video/video-client-core/lib/internal/player/core.js"),l=i("./node_modules/@video/video-client-core/lib/internal/utils/browser-support/index.js");class d extends a.CorePlayer{static isSupported(e){return r.__awaiter(this,void 0,void 0,(function*(){return(0,l.supportsFlvHttp)(e)}))}isSupported(){return r.__awaiter(this,void 0,void 0,(function*(){return d.isSupported()}))}static get format(){return"flv-http"}get format(){return d.format}constructor(e,t,i){super(e,t,i),this.player=null,this.isFirstLoad=!0,this.autorun(()=>{var e;const t=null===(e=this.currentQuality)||void 0===e?void 0:e.layer;null!=t&&"string"==typeof t.id&&""!==t.id&&this.requestUrl(t.id)}),this.on("hostElementAttached",this.handleElAttached),this.addInnerDisposer(}ready(){const e=Object.create(null,{ready:{get:()=>super.ready}});return r.__awaiter(this,void 0,void 0,(function*(){s.device.isImplements(s.Feature.MPEGTS)&&(yield s.device.loadMpegtsScript()),yield e.ready.call(this)}))}andleSource(e){if(this.suspended)return;null==(null==e?void 0:e.formats["flv-http"])&&this.emitErrorDeprecated(new n.DriverNotSupportedError("manifest doesn't contains 'flv-http' format",{manifest:e}))}requestUrl(e){var t;s.device.isImplements(s.Feature.MPEGTS)||this.throwErrorDeprecated(new n.PlayingIssueError("mpegts library is not loaded",{player:this})),null!=this.player&&this.player.destroy();const i=null!==(t=this.options.requestHeaders)&&void 0!==t?t:null,r=null!=i?{headers:i}:void 0;this.player=s.device.mpegts.createPlayer({type:"flv",isLive:!0,url:e},r),null!=this.elementSupervisor&&this.handleElAttached({el:Reflect.get(this.elementSupervisor,"element")})}handleElAttached(e){if(null!=this.player){if(this.player.attachMediaElement(e.el),this.player.load(),this.ctx.logger.debug("host element is attached and loaded"),this.isFirstLoad&&!this.options.autoPlay)return void(this.isFirstLoad=!1);try{this.internalPaused?(this.ctx.logger.debug("pause"),this.player.pause()):(this.ctx.logger.debug("play"),this.player.play())}catch(e){const t=e instanceof Error?e:null;this.emitErrorDeprecated(new n.PlayingIssueError("mpegts call failed in handleElAttached()",{inner:t,player:this}))}}}get implementedFeatures(){return[o.Feature.BITRATE_SWITCHING,o.Feature.MUTED_AUTOPLAY]}}t.FlvHttpPlayer=d,d.displayName="FlvHttpPlayer"},"./node_modules/@video/video-client-core/lib/internal/player/helper.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.attachVideoElement=t.isInLowPowerMode=t.lowPowerModeMsg=t.dataProperties=t.equalQualities=t.findClosestQuality=t.isFatalError=t.ERRORS=t.fetchManifestQualities=t.encodingToLayer=t.sortEncodings=t.getBitrateLayersFromQualities=t.isBitrateLayer=t.playOncePossible=void 0;const r=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),s=i("./node_modules/@video/video-client-core/lib/api/player/features/bitrate-switching.js"),o=i("./node_modules/@video/video-client-core/lib/internal/player/hlsjs.js"),n=i("./node_modules/@video/video-client-core/lib/internal/player/native-hls.js");unction l(e){return[...e].sort((e,t)=>{var i,r,s,o,n,l;const d=a(e)?null!==(i=e.bitrate)&&void 0!==i?i:e.maxBitrate:(null!==(r=e.audioKbps)&&void 0!==r?r:0)+(null!==(s=e.videoKbps)&&void 0!==s?s:0),c=a(t)?null!==(o=t.bitrate)&&void 0!==o?o:t.maxBitrate:(null!==(n=t.audioKbps)&&void 0!==n?n:0)+(null!==(l=t.videoKbps)&&void 0!==l?l:0);return 0===d?-1:c-d})}function d(e){var t,i,r,s,o;if(a(e))return{id:e.id,bitrate:null!==(t=e.bitrate)&&void 0!==t?t:e.maxBitrate,isSource:null!==(i=e.isSource)&&void 0!==i&&i,appData:null!==(r=e.appData)&&void 0!==r?r:{}};const n={id:e.location,bitrate:(null!==(s=e.audioKbps)&&void 0!==s?s:0)+(null!==(o=e.videoKbps)&&void 0!==o?o:0),isSource:!1,appData:{},encoding:e};return null!=n.appData&&e.videoWidth&&e.videoHeight&&(n.appData.videoWidth=e.videoWidth,n.appData.videoHeight=e.videoHeight),n}function c(e){switch(e){case s.SourceScoreLevel.Low:return s.SourceScoreLevel.Medium;case s.SourceScoreLevel.Medium:return s.SourceScoreLevel.High;case s.SourceScoreLevel.High:return null;case s.TranscodeScoreLevel.Lowest:return s.TranscodeScoreLevel.Low;case s.TranscodeScoreLevel.Low:return s.TranscodeScoreLevel.MediumLow;case s.TranscodeScoreLevel.MediumLow:return s.TranscodeScoreLevel.Medium;case s.TranscodeScoreLevel.Medium:return s.TranscodeScoreLevel.MediumHigh;case s.TranscodeScoreLevel.MediumHigh:return s.TranscodeScoreLevel.High;case s.TranscodeScoreLevel.High:return s.TranscodeScoreLevel.Highest;default:return null}}function u(e){switch(e){case s.SourceScoreLevel.High:return s.SourceScoreLevel.Medium;case s.SourceScoreLevel.Medium:return s.SourceScoreLevel.Low;case s.SourceScoreLevel.Low:return null;case s.TranscodeScoreLevel.Highest:return s.TranscodeScoreLevel.High;case s.TranscodeScoreLevel.High:return s.TranscodeScoreLevel.MediumHigh;case s.TranscodeScoreLevel.MediumHigh:return s.TranscodeScoreLevel.Medium;case s.TranscodeScoreLevel.Medium:return s.TranscodeScoreLevel.MediumLow;case s.TranscodeScoreLevel.MediumLow:return s.TranscodeScoreLevel.Low;case s.TranscodeScoreLevel.Low:return s.TranscodeScoreLevel.Lowest;default:return null}}t.playOncePossible=function(e,t){return t.debug("playOncePossible()",{aggregates:e.dumpVideoElement()}),e.paused||e.ended?e.readyState>2?e.play():new Promise((i,s)=>{t.debug("playOncePossible() returned Promise",{aggregates:e.dumpVideoElement()});const o=()=>{e.readyState>2&&(e.removeListener("loadeddata",o),e.play().catch(s).then(()=>{if(!e.paused)return void i();let t=20;const o=r.device.setInterval(()=>{e.paused||(r.device.clearInterval(o),i()),0==--t&&(r.device.clearInterval(o),s(new Error("Video element remains paused for 1s after play() call")))},50)}))};e.addListener("loadeddata",o)}):Promise.resolve()},t.isBitrateLayer=a,t.getBitrateLayersFromQualities=function(e){return e.map(e=>e.layer).filter((function(e){return null!=e&&void 0!==e}))},t.sortEncodings=l,t.encodingToLayer=d,t.fetchManifestQualities=function(e,t,i){let r;r=Array.isArray(e)?e:null!=e.substitute?[e.substitute]:e.encodings;const a=l(null!=r?r:[]),c=[];if(null!=t)c.push({level:s.SourceScoreLevel.High,layer:{bitrate:0,isSource:!0,id:t}});else{const e=a.map(e=>d(e)).filter(e=>e.isSource);e.sort(;for(let t=0;t<e.length;t++)switch(t){case 0:c.push({level:s.SourceScoreLevel.Low,layer:e[t],encoding:e[t].encoding});break;case 1:c.push({level:s.SourceScoreLevel.Medium,layer:e[t],encoding:e[t].encoding});break;case 2:c.push({level:s.SourceScoreLevel.High,layer:e[t],encoding:e[t].encoding})}}const u=a.map(.filter(e=>!e.isSource);switch(u.length){case 0:break;case 1:c.push({level:s.TranscodeScoreLevel.Medium,layer:d(u[0]),encoding:u[0].encoding});break;case 2:c.push({level:s.TranscodeScoreLevel.Low,layer:d(u[1]),encoding:u[1].encoding}),c.push({level:s.TranscodeScoreLevel.High,layer:d(u[0]),encoding:u[0].encoding});break;case 3:c.push({level:s.TranscodeScoreLevel.Low,layer:d(u[2]),encoding:u[2].encoding}),c.push({level:s.TranscodeScoreLevel.Medium,layer:d(u[1]),encoding:u[1].encoding}),c.push({level:s.TranscodeScoreLevel.High,layer:d(u[0]),encoding:u[0].encoding});break;case 4:c.push({level:s.TranscodeScoreLevel.Low,layer:d(u[3]),encoding:u[3].encoding}),c.push({level:s.TranscodeScoreLevel.MediumLow,layer:d(u[2]),encoding:u[2].encoding}),c.push({level:s.TranscodeScoreLevel.MediumHigh,layer:d(u[1]),encoding:u[1].encoding}),c.push({level:s.TranscodeScoreLevel.High,layer:d(u[0]),encoding:u[0].encoding});break;case 5:c.push({level:s.TranscodeScoreLevel.Low,layer:d(u[4]),encoding:u[4].encoding}),c.push({level:s.TranscodeScoreLevel.MediumLow,layer:d(u[3]),encoding:u[3].encoding}),c.push({level:s.TranscodeScoreLevel.Medium,layer:d(u[2]),encoding:u[2].encoding}),c.push({level:s.TranscodeScoreLevel.MediumHigh,layer:d(u[1]),encoding:u[1].encoding}),c.push({level:s.TranscodeScoreLevel.High,layer:d(u[0]),encoding:u[0].encoding});break;case 6:c.push({level:s.TranscodeScoreLevel.Lowest,layer:d(u[5]),encoding:u[5].encoding}),c.push({level:s.TranscodeScoreLevel.Low,layer:d(u[4]),encoding:u[4].encoding}),c.push({level:s.TranscodeScoreLevel.MediumLow,layer:d(u[3]),encoding:u[3].encoding}),c.push({level:s.TranscodeScoreLevel.MediumHigh,layer:d(u[2]),encoding:u[2].encoding}),c.push({level:s.TranscodeScoreLevel.High,layer:d(u[1]),encoding:u[1].encoding}),c.push({level:s.TranscodeScoreLevel.Highest,layer:d(u[0]),encoding:u[0].encoding});break;default:c.push({level:s.TranscodeScoreLevel.Lowest,layer:d(u[6]),encoding:u[6].encoding}),c.push({level:s.TranscodeScoreLevel.Low,layer:d(u[5]),encoding:u[5].encoding}),c.push({level:s.TranscodeScoreLevel.MediumLow,layer:d(u[4]),encoding:u[4].encoding}),c.push({level:s.TranscodeScoreLevel.Medium,layer:d(u[3]),encoding:u[3].encoding}),c.push({level:s.TranscodeScoreLevel.MediumHigh,layer:d(u[2]),encoding:u[2].encoding}),c.push({level:s.TranscodeScoreLevel.High,layer:d(u[1]),encoding:u[1].encoding}),c.push({level:s.TranscodeScoreLevel.Highest,layer:d(u[0]),encoding:u[0].encoding})}return null!=i&&(i instanceof o.HlsJsPlayer||i instanceof n.NativeHlsPlayer)&&c.push({level:s.AutoQualityLevel.Auto}),c},t.ERRORS={BAD_INPUT:"bad-input",DRIVER_NOT_SUPPORTED:"driver-not-supported",ELEMENT_REQUIRED:"element-required",EMBED_SWF_FAILED:"embedding-flash-swf-failed",GET_USER_MEDIA_FAILED:"get-user-media-failed",HTTP_SERVER_UNEXPECTED_RESPONSE:"http-server-unexpected-response",HTTP_SERVER_UNAUTHORIZED:"http-server-unauthorized",HTTP_SERVER_FORBIDDEN:"http-server-forbidden",HTTP_SERVER_INTERNAL_ERROR:"http-server-internal-error",HTTP_SERVER_NOT_FOUND:"http-server-not-found",MANIFEST:"http-response",INVALID_CONTROLS:"invalid-controls-parent",INVALID_MEDIA_URL:"invalid-media-url",INVALID_POPOUT_URL:"invalid-popout-url",INVALID_EL:"invalid-element",WS_NETWORK_ERROR:"websocket-network-error",NETWORK_ERROR:"network-error",NO_DRIVERS:"no-valid-drivers",PLAYBACK_ERROR:"playback-error",UNKNOWN_DRIVER:"unknown-driver",UNKNOWN_ERROR:"unknown-error",UNRECOGNIZED_DRIVER:"unrecognized-driver",USER_REQUIRED:"user-required",INVALD_BITRATE:"invalid-bitrate",HLSJS_NOT_LOADED:"hlsjs-not-loaded"},t.isFatalError=function(e){return!(!e||"object"!=typeof e||!("fatal"in e))&&!0===e.fatal},t.findClosestQuality=function(e,t){if(0===t.length)return null;if(e===s.AutoQualityLevel.Auto)return{level:e};let i;const r=Object.fromEntries(t.map();for(i=e;null!=i&&null==r[i];)i=u(i);if(null==i)for(i=e;null!=i&&null==r[i];)i=c(i);return null!=i?r[i]:null},t.equalQualities=t.dataProperties=t.lowPowerModeMsg="The request is not allowed by the user agent or the platform in the current context, possibly because the user denied permission.",t.isInLowPowerMode=function(e){return r.device.isIosDevice&&e instanceof Error&&"NotAllowedError"===e.name&&e.message===t.lowPowerModeMsg},t.attachVideoElement=,"./node_modules/@video/video-client-core/lib/internal/player/hlsjs.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HlsJsPlayer=void 0;const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),o=i("./node_modules/@video/video-client-core/lib/api/adapter/features/feature.js"),n=i("./node_modules/@video/video-client-core/lib/api/error.js"),a=i("./node_modules/@video/video-client-core/lib/api/player/features/bitrate-switching.js"),l=i("./node_modules/@video/video-client-core/lib/api/player/features/feature.js"),d=i("./node_modules/@video/video-client-core/lib/api/typings/video-element.js"),c=i("./node_modules/@video/video-client-core/lib/internal/errors.js"),u=i("./node_modules/@video/video-client-core/lib/internal/errors-deprecated.js"),p=i("./node_modules/@video/video-client-core/lib/internal/utils/browser-support/index.js"),h=i("./node_modules/@video/video-client-core/lib/internal/utils/debug/play-logs.js"),m=i("./node_modules/@video/video-client-core/lib/internal/utils/stats/index.js"),v=i("./node_modules/@video/video-client-core/lib/internal/player/core.js"),g=i("./node_modules/@video/video-client-core/lib/internal/player/helper.js"),f=class b extends v.CorePlayer{static isSupported(e){return r.__awaiter(this,void 0,void 0,(function*(){return(0,p.supportsHlsjs)(e)}))}get hostEl(){return null==this.elementSupervisor?null:Reflect.get(this.elementSupervisor,"element")}isSupported(){return r.__awaiter(this,void 0,void 0,(function*(){return b.isSupported()}))}static get format(){return"mp4-hls"}get format(){return b.format}ready(){const e=Object.create(null,{ready:{get:()=>super.ready}});return r.__awaiter(this,void 0,void 0,(function*(){yield this.device.loadHlsScript(this.options.hlsjsPath),yield e.ready.call(this)}))}handleSource(e){var t,i,o,n;return r.__awaiter(this,void 0,void 0,(function*(){if(this.suspended)return;const r=null!=(null===(i=null===(t=this.manifestJson)||void 0===t?void 0:t.formats["mp4-hls"])||void 0===i?void 0:i.substitute);this.manifestJson=e;if(null==(null==e?void 0:e.formats["mp4-hls"]))return void this.emitErrorDeprecated(new u.DriverNotSupportedError("Manifest did not receive a 'mp4-hls' format, the driver was not provided.",{manifest:e}));this.source=this.manifest;if(null!=(null===(o=null==e?void 0:e.formats["mp4-hls"])||void 0===o?void 0:o.substitute)!==r&&!this._firstSourceEv)return this.ctx.logger.debug("Changing stream to/from blurredStream. Restart hlsjs."),void this.restart(!0);if(this._firstSourceEv&&(this._firstSourceEv=!1),null!=this.hostEl&&null!=this.source&&(!this.hostEl.src||null!=this.hostEl.srcObject||this.qualityHasChanged||s.device.isImplements(s.Feature.URL_LOCATION)&&this.hostEl.src===s.device.location)){const e=this.hostEl.currentTime;this.qualityHasChanged=!1,this.hostEl.srcObject=null,this.hostEl.setAttribute("src",this.source),"recorded"===(null===(n=this.manifestJson)||void 0===n?void 0:n.type)&&e>0&&(this.hostEl.currentTime=e),this.ctx.logger.debug("hlsjs: await play()",{aggregates:(0,h.dumpVideoElement)(this.hostEl)}),yield this.play()}}))}get implementedFeatures(){return[l.Feature.BITRATE_SWITCHING,l.Feature.MUTED_AUTOPLAY]}get device(){if(null!=this._device)return this._device;if(!s.device.isImplements(o.Feature.HLSJS))throw new Error("Device is not supported");return this._device=s.device,this._device}constructor(e,t,i){if(super(e,t,i),this.lastProgress=0,this.manifestJson=null,this.destroyed=!1,this.m3u8ManifestLoadId=0,this.indexManifestLoadId=0,this.initialFragmentLoadId=0,this._firstSourceEv=!0,this.lastFrag=null,this.loadingHls=!1,this.loadFailure=null,this.recoverDecodingErrorDate=0,this.recoverSwapAudioCodecDate=0,this.hls=null,this.isAttached=!1,this._device=null,this.chosenLevel=null,this.hlsJsInitId=m.stats.start(m.STATS_EVENTS.HLSJS_INIT),!s.device.isImplements(o.Feature.HLSJS))throw new Error("Device is not supported");this.loadHls(),this.addInnerDisposer(this.destroy),this.on("error",()=>{})}get data(){var e,t;return null!==(t=null===(e=this.manifestJson)||void 0===e?void 0:e.formats["mp4-hls"])&&void 0!==t?t:null}get mediaLoader(){return this.provider}get manifest(){var e,t,i,r,s,o,n;const l=this.data;if(null==l)return null;let d;if(d=l.substitute?l.substitute.location:(null===(e=this.currentQuality)||void 0===e?void 0:e.level)!==a.SourceScoreLevel.High&&(null===(t=this.currentQuality)||void 0===t?void 0:t.level)!==a.SourceScoreLevel.Medium&&(null===(i=this.currentQuality)||void 0===i?void 0:i.level)!==a.SourceScoreLevel.Low||null==(null===(r=l.origin)||void 0===r?void 0:r.location)?null!=(null===(n=null===(o=this.currentQuality)||void 0===o?void 0:o.layer)||void 0===n?void 0:n.id)&&""!==this.currentQuality.layer.id?this.currentQuality.layer.id.toString():l.manifest:null===(s=l.origin)||void 0===s?void 0:s.location,null==d)return this.ctx.logger.info("Returning null in manifest getter. Data: ",{format:l}),null;const c=d.includes("?")?"&":"?";d+=c;const u=this.device.globals.get("lv_auto_last_kbps");if(null!=u){const e=d.includes("?")?"&":"?";d+=`${e}kbps=${u}`}return d}reloadAndRestart(){return r.__awaiter(this,void 0,void 0,(function*(){this.isDisposed||(yield this.mediaLoader.load(),"online"===this.mediaLoader.currentState&&(yield this.restart(!1)))}))}loadHls(e){const t=null!=e?e:f;this.device.loadHlsScript(this.options.hlsjsPath).then(.catch(e=>{this.ctx.logger.error("hlsjs not loaded",{path:this.options.hlsjsPath,err:e}),t(e)})}playNow(){const e=Object.create(null,{play:{get:()=>super.play}});return r.__awaiter(this,void 0,void 0,(function*(){const t=this.manifest;if(!this.device.isHlsLoaded())throw new Error(g.ERRORS.HLSJS_NOT_LOADED);if(null==t&&"online"===this.mediaLoader.currentState)return this.emitErrorDeprecated(new u.DriverNotSupportedError("manifest doesn't contains 'flv-http' format",{manifest:t,loader:this.mediaLoader})),!1;if(null==this.hostEl)return this.emitErrorDeprecated(new u.ElementRequiredError("cannot play, no video element",{})),!1;if(null!=this.hls){if(this.mediaLoader.vod&&t===this.hls.url){try{yield e.play.call(this)}catch(e){const t=e instanceof Error?e:null;this.emitErrorDeprecated(new u.PlayingIssueError("vod play failed in playNow()",{inner:t,player:this}))}return!0}this.destroyHls()}if(null==t)return this.emitErrorDeprecated(new u.ManifestNotFoundError("cannot play, manifest is null",{})),!1;this.hostEl.setAttribute("src",t);const i=()=>{var r;if(this.isDisposed)return;if(!this.device.isHlsLoaded())throw new Error("Hls.js is not loaded");this.device.removeEventListener("visibilitychange",i);const s={debug:this.options.debug,maxBufferLength:this.options.maxBufferLength,maxBufferSize:this.options.maxBufferSize,fragLoadingTimeOut:3900,maxBufferHole:2,backBufferLength:90,progressive:!1,autoLevelEnabled:!0},o=null!==(r=this.options.requestHeaders)&&void 0!==r?r:null,n=this.hls=new this.device.Hls(Object.assign(Object.assign(Object.assign({},s),this.options.hlsjsConfig),{xhrSetup(e,t){null!=o&&Object.entries(o).forEach(}}));if(this.listen(),n.loadSource(t),n.attachMedia(this.hostEl),null!=this.hostEl&&!this.localVideoPaused)try{e.play.call(this,!0)}catch(e){const t=e instanceof Error?e:null;this.emitErrorDeprecated(new u.PlayingIssueError("play failed in startIt() method",{inner:t,player:this}))}this.mediaLoader.vod||n.on(this.device.Hls.Events.BUFFER_APPENDED,()=>{null==this.hostEl||0===this.hostEl.buffered.length||this.hostEl.paused||this.hostEl.buffered.end(this.hostEl.buffered.length-1)-this.hostEl.currentTime>25&&(this.ctx.logger.warn("player fell behind more than 25s, restarting"),this.reloadAndRestart())}),n.on(this.device.Hls.Events.MEDIA_ATTACHED,()=>{this.isAttached=!0}),n.on(this.device.Hls.Events.MEDIA_DETACHED,()=>{this.isAttached=!1}),n.on(this.device.Hls.Events.MANIFEST_PARSED,};return this.device.hidden?this.device.addEventListener("visibilitychange",i):i(),!this.hostEl.paused}))}play(){return r.__awaiter(this,void 0,void 0,(function*(){if(this.ctx.logger.debug("play()"),null==this.hostEl)return!1;if(null!=this.hls&&!this.localVideoPaused){try{yield this.playNow()}catch(e){const t=e instanceof Error?e:null;this.emitErrorDeprecated(new u.PlayingIssueError("playNow() failed",{inner:t,player:this}))}return!0}this.hostEl.onprogress=null,yield this.ready();try{yield this.playNow()}catch(e){const t=e instanceof Error?e:null;this.emitErrorDeprecated(new u.PlayingIssueError("play failed",{inner:t,player:this}))}return!0}))}get autoLevelEnabled(){var e,t;return null!==(t=null===(e=this.hls)||void 0===e?void 0:e.autoLevelEnabled)&&void 0!==t&&t}set bitrate(e){if(null!=this.hostEl&&(s.device.isImplements(o.Feature.BROWSER_TYPE)&&"firefox"===s.device.browserInfo.name||this.mediaLoader.vod)){const e=this.hostEl.currentTime;if(this.stop(),this.mediaLoader.vod){const{hostEl:t}=this,i=()=>{var r;null===(r=this.hostEl)||void 0===r||r.removeEventListener("loadedmetadata",i),t.currentTime=e};this.hostEl.addEventListener("loadedmetadata",i)}this.play().catch(e=>{const t=e instanceof Error?e:null;this.emitErrorDeprecated(new u.PlayingIssueError("play failed after changing bitrate",{inner:t,player:this}))})}}troyHls(){const{hls:e}=this;null!=e&&(null!=this.hostEl&&this.hostEl.removeEventListener("error",this._handleElError),null==e||e.detachMedia(),null==e||e.destroy(),this.hls=null,this.loadFailure=null)}recoverFromBufferSeekOverHole(){return r.__awaiter(this,void 0,void 0,(function*(){if(null!=this.data){this.stop();try{yield this.play()}catch(e){const t=e instanceof Error?e:null;this.emitErrorDeprecated(new u.PlayingIssueError("play failed after recoverFromBufferSeekOverHole()",{inner:t,player:this}))}}}))}pickEncoding(e){if(null==this.data)return null;if(null!=e&&(this.options.bitrate=e),null==this.options.bitrate)return null;const{encodings:t}=this.data;return 0===t.length||null==this.chosenLevel?null:t[this.chosenLevel]}ifNoProgress(e){const t=this.hostEl;if(null==t)return;const i=t.currentTime;s.device.setTimeout(()=>{t.currentTime<=i&&e()},250)}emitProgress(){s.device.isImplements(o.Feature.DEBUGGING)?this.lastProgress=s.device.performance.now():this.lastProgress=Date.now(),this.emit("progress")}listen(){var e,t,i,r;let o=0;const{hls:l}=this,d=this.hostEl;if(null==l)throw new Error(g.ERRORS.HLSJS_NOT_LOADED);if(null==d)throw new Error(g.ERRORS.ELEMENT_REQUIRED);l.on(this.device.Hls.Events.ERROR,(e,t)=>{var i;try{switch(t.details){case this.device.Hls.ErrorDetails.LEVEL_LOAD_ERROR:case this.device.Hls.ErrorDetails.FRAG_LOAD_TIMEOUT:if(this.mediaLoader.vod){const e=(0,g.dataProperties)(t);return void this.emitErrorDeprecated(new u.PlaybackError("hlsjs playback error",Object.assign(Object.assign({},e),{loader:this.mediaLoader})))}return"offline"===this.mediaLoader.currentState?void this.stop():(this.ctx.logger.warn("level load reload and restart",{type:String(e)}),this.reloadAndRestart().catch(e=>{const t=(0,n.isVideoClientError)(e)&&e.code===u.ErrorCode.ManifestNotLoaded?"hlsjs restart failed because manifest has not loaded":"hlsjs restart failed";this.emitError((0,c.createError)(u.ErrorCode.PlayerLoadingFailed,t,{player:b.displayName,format:this.format},e))}),o=d.currentTime,void s.device.setTimeout(()=>{d.currentTime<=o&&(this.ctx.logger.warn("level load reload and restart",{type:String(e)}),this.reloadAndRestart().catch(e=>{const t=(0,n.isVideoClientError)(e)&&e.code===u.ErrorCode.ManifestNotLoaded?"hlsjs restart failed because manifest has not loaded":"hlsjs restart failed";this.emitError((0,c.createError)(u.ErrorCode.PlayerLoadingFailed,t,{player:b.displayName,format:this.format},e))}))},100));case this.device.Hls.ErrorDetails.BUFFER_SEEK_OVER_HOLE:return void this.ifNoProgress(()=>{this.recoverFromBufferSeekOverHole()});case this.device.Hls.ErrorDetails.BUFFER_APPEND_ERROR:case this.device.Hls.ErrorDetails.BUFFER_FULL_ERROR:this.counters.bufferOverflowCount++;break;case this.device.Hls.ErrorDetails.FRAG_LOAD_ERROR:case this.device.Hls.ErrorDetails.FRAG_DECRYPT_ERROR:case this.device.Hls.ErrorDetails.FRAG_PARSING_ERROR:case this.device.Hls.ErrorDetails.BUFFER_APPENDING_ERROR:case this.device.Hls.ErrorDetails.BUFFER_STALLED_ERROR:this.counters.bufferUnderflowCount++;break;case this.device.Hls.ErrorDetails.MANIFEST_LOAD_ERROR:return this.ctx.logger.error("unable to load m3u8 manifest",{level:void 0,url:t.url}),void this.setPreferredLevel(a.TranscodeScoreLevel.Highest)}switch(t.type){case this.device.Hls.ErrorTypes.NETWORK_ERROR:t.details!==this.device.Hls.ErrorDetails.FRAG_LOAD_TIMEOUT?this.counters.currentErrorCount++:this.counters.currentErrorCount=null!==(i=this.options.recoverErrorCount)&&void 0!==i?i:0,this.emitErrorDeprecated(new u.NetworkError("hlsjs playback error",{data:(0,g.dataProperties)(t)}));break;case this.device.Hls.ErrorTypes.MEDIA_ERROR:if(t.fatal)return void this.handleMediaError();if(t.details===this.device.Hls.ErrorDetails.BUFFER_STALLED_ERROR)return void this.emitErrorDeprecated(new u.PlaybackError("hlsjs media error",{data:(0,g.dataProperties)(t),loader:this.mediaLoader}));t.details===this.device.Hls.ErrorDetails.FRAG_LOAD_ERROR&&this.counters.currentErrorCount++,this.emitErrorDeprecated(new u.PlaybackError("hlsjs media error",{data:(0,g.dataProperties)(t),loader:this.mediaLoader}));break;case this.device.Hls.ErrorTypes.OTHER_ERROR:this.counters.currentErrorCount++,this.ctx.logger.warn("hlsjs other error",(0,g.dataProperties)(t));break;default:return void this.ctx.logger.error("unhandled hlsjs error",(0,g.dataProperties)(t))}this.checkRestart(t);const r=(0,g.dataProperties)(t);this.ctx.logger.warn(""+e,r)}catch(e){const t=e instanceof Error?e:null;this.emitErrorDeprecated(new u.HandleHlsJsError("error handling error from hlsjs library",{inner:t}))}}),d.addEventListener("progress",()=>{this.emitProgress()}),d.addEventListener("ended",()=>{this.emit("ended")});const p={driver:this.format,abr:null===(e=this.manifestJson)||void 0===e?void 0:e.abr,aor:null===(t=this.manifestJson)||void 0===t?void 0:t.aor,atr:null===(i=this.manifestJson)||void 0===i?void 0:i.atr,rep:null===(r=this.manifestJson)||void 0===r?void 0:r.rep};v.timeupdateWrapper.wrap(d,()=>{if(this.emit("timeupdate"),-1!==this.initialFragmentLoadId){d.currentTime>0&&!d.paused&&!d.ended&&d.readyState>2&&(this.emit("initialFragmentLoad",m.stats.stop(this.initialFragmentLoadId,p)),this.initialFragmentLoadId=-1)}}),d.addEventListener("error",this._handleElError),l.on(this.device.Hls.Events.MANIFEST_LOADING,(e,t)=>{this.emit("hlsJsInit",m.stats.stop(this.hlsJsInitId,p)),this.m3u8ManifestLoadId=m.stats.start(m.STATS_EVENTS.M3U8_MANIFEST_LOAD)}),l.on(this.device.Hls.Events.MANIFEST_LOADED,(e,t)=>{this.emit("m3u8ManifestLoad",m.stats.stop(this.m3u8ManifestLoadId,p)),this.indexManifestLoadId=m.stats.start(m.STATS_EVENTS.INDEX_MANIFEST_LOAD)}),l.once(this.device.Hls.Events.LEVEL_UPDATED,(e,t)=>{this.emit("indexManifestLoad",m.stats.stop(this.indexManifestLoadId,p))}),l.once(this.device.Hls.Events.FRAG_LOADING,e=>{this.initialFragmentLoadId=m.stats.start(m.STATS_EVENTS.INITIAL_FRAGMENT_LOAD)}),l.on(this.device.Hls.Events.FRAG_LOADED,}_handleElError(e){var t;if((0,d.isVideoElement)(e.target)&&null!=e.target.error){switch(e.target.error.code){case d.MediaErrorCodeConstants.MEDIA_ERR_DECODE:this.handleMediaError();break;case d.MediaErrorCodeConstants.MEDIA_ERR_SRC_NOT_SUPPORTED:this.emitErrorDeprecated(new u.DriverNotSupportedError("hlsjs src not supported",{manifest:this.manifest,loader:this.mediaLoader}))}this.autoPlay&&(null===(t=this.hostEl)||void 0===t||t.play())}}handleMediaError(){const e=this.device.isImplements(o.Feature.DEBUGGING)?this.device.performance.now():Date.now(),{hls:t}=this;if(null==t){if(this.destroyed||this.isDisposed)return;throw new Error(g.ERRORS.HLSJS_NOT_LOADED)}null!=this.recoverDecodingErrorDate||e-this.recoverDecodingErrorDate>3e3?(this.recoverDecodingErrorDate=e,t.recoverMediaError()):(null!=this.recoverSwapAudioCodecDate||e-this.recoverSwapAudioCodecDate>3e3)&&(this.recoverSwapAudioCodecDate=e,t.swapAudioCodec(),t.recoverMediaError()),this.ifNoProgress(()=>{this.recoverFromBufferSeekOverHole()})}get currentLevel(){const{hls:e}=this;return null==e||null==e.abrController.fragCurrent?null:e.abrController.fragCurrent.level}get nextLevel(){const{hls:e}=this;if(null==e)throw new Error(g.ERRORS.HLSJS_NOT_LOADED);return e.abrController.nextAutoLevel}bitrateSwitch(e){var t;null!=this.hls&&(e>(null!==(t=this.currentLevel)&&void 0!==t?t:0)?this.counters.upshift++:this.counters.downshift++,this.emit("bitrate-switch"))}loadedFrag(e){var t,i,r;const s=e;this.counters.fragCounts++,s.request=null!=this.lastFrag?s.trequest-(null!==(i=null===(t=this.lastFrag)||void 0===t?void 0:t.trequest)&&void 0!==i?i:0):s.trequest,this.lastFrag=s,this.counters.fragSize+=s.loaded,this.counters.fragDuration+=s.duration,this.counters.fragDownloadTime+=s.request,this.counters.fragMaxTime=Math.max(this.counters.fragMaxTime,s.request),this.counters.fragMinTime=Math.min(null!==(r=this.counters.fragMinTime)&&void 0!==r?r:s.request,s.request)}}t.HlsJsPlayer=b,b.displayName="HlsJsPlayer"},"./node_modules/@video/video-client-core/lib/internal/player/manifest.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ManifestPlayer=void 0;const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/@video/video-client-core/node_modules/@video/log-node/index.js"),o=i("./node_modules/mobx/dist/mobx.esm.js"),n=i("./node_modules/@video/video-client-core/lib/api/index.js"),a=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),l=i("./node_modules/@video/video-client-core/lib/api/error.js"),d=i("./node_modules/@video/video-client-core/lib/api/manifest.js"),c=i("./node_modules/@video/video-client-core/lib/api/player.js"),u=i("./node_modules/@video/video-client-core/lib/api/player/features/feature.js"),p=i("./node_modules/@video/video-client-core/lib/api/adapter/features/feature.js"),h=i("./node_modules/@video/video-client-core/lib/internal/errors.js"),m=i("./node_modules/@video/video-client-core/lib/internal/errors-deprecated.js"),v=i("./node_modules/@video/video-client-core/lib/internal/utils/bind.js"),g=i("./node_modules/@video/video-client-core/lib/internal/utils/context/context.js"),f=i("./node_modules/@video/video-client-core/lib/internal/utils/events/event-emitter.js"),b=i("./node_modules/@video/video-client-core/lib/internal/utils/logger.js"),_=i("./node_modules/@video/video-client-core/lib/internal/utils/proxy/sync-handler.js"),y=i("./node_modules/@video/video-client-core/lib/internal/utils/stats/index.js"),w=i("./node_modules/@video/video-client-core/lib/internal/player/core.js"),S=i("./node_modules/@video/video-client-core/lib/internal/player/helper.js"),E=i("./node_modules/@video/video-client-core/lib/internal/player/media-element-supervisor.js");class C extends f.ObservableEventEmitter{attachTo(e){this.elementSupervisor=E.MediaElementSupervisor.getSupervisor(e).attachToPlayer(this);const t=this.currentPlayer;null!=t&&null!=this.elementSupervisor&&t.initVideoEl(this.elementSupervisor,!0).catch(e=>this.ctx.logger.error(e))}setPreferredLevel(e){this.preferredLevel=e}get noConsumerAudioAndVideo(){var e;return!!(null===(e=this.currentPlayer)||void 0===e?void 0:e.isImplements(u.Feature.CONSUMER))&&(!this.currentPlayer.consumerAudioEnabled&&!this.currentPlayer.consumerVideoEnabled)}get webrtcConnecting(){var e;return!!(null===(e=this.currentPlayer)||void 0===e?void 0:e.isImplements(u.Feature.BROADCAST))&&this.currentPlayer.isConnecting}get currentPlayer(){return this[_.implementation]}set currentPlayer(e){this[_.implementation]=e}get lowLatency(){var e;return!!this.isImplements(u.Feature.BITRATE_SWITCHING)&&"webrtc"===(null===(e=this.currentPlayer)||void 0===e?void 0:e.format)}selectWebrtcPlayer(){const e=this.availablePlayers.findIndex(e=>"webrtc"===e.id);this.selectPlayer(e)}set lowLatency(e){var t,i;this.supportsLowLatency?e?("webrtc"!==(null===(t=this.currentPlayer)||void 0===t?void 0:t.format)&&this.selectWebrtcPlayer(),this.preferredLevel=n.SourceScoreLevel.High):("webrtc"===(null===(i=this.currentPlayer)||void 0===i?void 0:i.format)&&this.nextPlayer(),this.preferredLevel=n.TranscodeScoreLevel.Highest):this.logger.warn("unable to set low latency. player does not support low latency.")}isImplements(e){var t;const i=this[_.implementation];return e===u.Feature.PLAYER_SELECTOR||null!==(t=null==i?void 0:i.isImplements(e))&&void 0!==t&&t}et logger(){return this.ctx.logger}constructor(e,t,i){var r;super(!1),this.lastTimeUpdate=Date.now()+5e3,this.manifest=null,this.availablePlayers=[],this.providedPlayers=[],this.currentPlayerIndex=null,this.allPlayers=[],this.manifestLoadId=0,this.blurred=!1,this.firstLoadId=y.stats.start(y.STATS_EVENTS.FIRST_LOAD),this.ctx=e,this.options=Object.assign(Object.assign({displayPoster:"preview"},i),{driverFailoverSeconds:null!==(r=i.driverFailoverSeconds)&&void 0!==r?r:10}),(0,o.makeObservable)(this,{blurred:o.observable}),this.provider=t,(0,g.onceCanceled)(e).then(e=>this.dispose("ManifestPlayer Context Cancelled: "+e));const s=(0,v.makeBounded)(new Proxy(this,w.proxyHandler));return s.init(),e.logger.attachObject(s),e.logger.trace("constructor()",i),s}andleWebsocketReconnect(){this.selectWebrtcPlayer()}init(){this.provider.on("manifest",this.updateManifest),this.on("timeupdate",this.handleTimeUpdate),this.addInnerDisposer(()=>this.off("timeupdate",this.handleTimeUpdate));const e={autoPlay:this.options.autoPlay,muted:this.options.muted,volume:this.options.volume};this.allPlayers=this.parsePlayerSpecs(this.options.players,e),this.validatePlayers(this.allPlayers).then(()=>{this.provider.once("source",e=>{var t,i,r,s,o;this.manifest=e,this.emit("manifestLoadTime",y.stats.stop(this.manifestLoadId,{driver:(null===(t=this.currentPlayer)||void 0===t?void 0:t.format)||void 0,abr:null===(i=this.manifest)||void 0===i?void 0:i.abr,aor:null===(r=this.manifest)||void 0===r?void 0:r.aor,atr:null===(s=this.manifest)||void 0===s?void 0:s.atr,rep:null===(o=this.manifest)||void 0===o?void 0:o.rep}))}),this.manifestLoadId=y.stats.start(y.STATS_EVENTS.MANIFEST_LOAD),this.provider.load("preview"===this.options.displayPoster).then(this.firstLoad).catch(e=>this.emitError((0,h.createError)(l.ErrorCode.PlayerLoadingFailed,"unable to start playing because of manifest loading error",{},e)))}),this.driverFailoverInterval(),this.on("localVideoPaused",e=>{e?this.currentPlayer?this.currentPlayer.updatePosterWithLatestFrame():this.poster=this.selectPoster():this.driverFailoverInterval()}),this.on("implementation",()=>this.emit("currentPlayer",this))}driverFailoverInterval(){null!=this.options.driverFailoverSeconds&&!0!==this.localVideoPaused&&(a.device.clearInterval(this.driverFailInterval),this.driverFailInterval=a.device.setInterval(()=>{null!=this.options.driverFailoverSeconds&&(!0!==this.localVideoPaused?this.driverFailoverCheck(this.options.driverFailoverSeconds):a.device.clearInterval(this.driverFailInterval))},1e3),this.addInnerDisposer()}driverFailoverCheck(e){"online"!==this.provider.currentState||this.noConsumerAudioAndVideo||a.device.hidden||this.webrtcConnecting?this.lastTimeUpdate=Date.now():Date.now()-this.lastTimeUpdate>1e3*e&&(this.logger.warn(`driver failover check: no timeupdate for ${e} seconds`),this.lastTimeUpdate=Date.now()+5e3,this.nextPlayer())}firstLoad(){var e;(null===(e=this.elementSupervisor)||void 0===e?void 0:e.hasPoster())||(this.poster=this.selectPoster())}selectPoster(){var e,t,i,r,s;const o=this.options.displayPoster,n=null===(e=this.manifest)||void 0===e?void 0:e.formats.jpeg;if(null==o||!1===o||null==n)return this.ctx.logger.debug("no posters",{displayPoster:o,manifest:this.manifest}),null;if("preview"===o&&null!=(null===(t=this.manifest)||void 0===t?void 0:t.previewImg))return this.ctx.logger.debug("select previewImg poster"),null===(i=this.manifest)||void 0===i?void 0:i.previewImg;let a,l;"object"==typeof o?(a=o.videoHeight,l=o.videoWidth):null!=(null===(s=null===(r=this.currentQuality)||void 0===r?void 0:r.layer)||void 0===s?void 0:s.appData)&&(a=this.currentQuality.layer.appData.videoHeight,l=this.currentQuality.layer.appData.videoWidth);const d=n.encodings.find(;return null!=d?(this.ctx.logger.debug(`select ${l}x${a} poster`),d.location):n.encodings.length>0?(this.ctx.logger.debug("select first poster"),n.encodings[0].location):(this.ctx.logger.debug("poster not found"),null)}updatePosterWithLatestFrame(){null!=this.elementSupervisor&&a.device.isImplements(p.Feature.CREATE_SCREENSHOT)?this.poster=this.elementSupervisor.createScreenshot():this.ctx.logger.warn("Unable to set update poster. Create screenshot is not compatible with device.")}parsePlayerSpecs(e,t){return e.map(e=>{var i;if("string"==typeof e)return{id:e,options:t};const r=null!==(i=e.options)&&void 0!==i?i:{};return Object.assign(Object.assign({},e),{options:Object.assign(Object.assign({},t),r)})})}validatePlayers(e){return r.__awaiter(this,void 0,void 0,(function*(){this.providedPlayers=[];const t=yield Promise.all(e.map(),i=e.map(;this.providedPlayers=i.filter(e=>e.supported),this.emit("availablePlayers",{players:this.providedPlayers}),0===this.providedPlayers.length&&this.noDrivers()}))}updateManifest(e){var t;this.emit("manifest",e);const i={401:"MANIFEST_UNAUTHORIZED",403:"MANIFEST_FORBIDDEN",404:"MANIFEST_NOT_FOUND"};if(this.manifest=e,"forbidden"===e.state){const e=`manifest is forbidden after polling it for '${this.provider.options.unauthorizedRecoveryDuration}' ms`;return this.emitErrorDeprecated(new m.ManifestError(e,{loader:this.provider})),void this.dispose(e)}if("online"!==e.state)return 401!==e.code&&403!==e.code||(this.options.refetch?this.emit("info",{code:i[e.code]}):(this.emitErrorDeprecated(new m.ManifestError("manifest error: "+i[e.code],{loader:this.provider})),this.dispose(i[e.code]))),void(404!==e.code&&403!==e.code||(null===(t=this.currentPlayer)||void 0===t||t.dispose(),this.currentPlayer=null,this.emit("info",{code:i[e.code]})));this.availablePlayers=this.providedPlayers.filter(t=>{const i=e.formats[c.players[t.id].format];return null!=i&&(0,d.isValidFormat)(i)}),this.emit("availablePlayers",{players:this.availablePlayers}),null==this.currentPlayer&&(0===this.availablePlayers.length?this.noDrivers():(this.ctx.logger.debug("Select the first player"),this.selectPlayer(0)));const r=this.currentPlayer,s=e.formats[null==r?void 0:r.format];this.updateQualities(s)}updateQualities(e){var t,i,r,s;const o=this.currentPlayer;if(null!=o&&(0,n.isGenericFormat)(e)){const n=null!==(r=(0,S.fetchManifestQualities)(e,null!==(i=null===(t=e.origin)||void 0===t?void 0:t.location)&&void 0!==i?i:null,o))&&void 0!==r?r:[];(0,S.equalQualities)(n,null!==(s=this.availableQualities)&&void 0!==s?s:[])||(this.availableQualities=n),this.blurred=null!=e.substitute}}noDrivers(){"online"===this.provider.currentState&&(this.emit("noPlayers",!0),this.emitErrorDeprecated(new m.NoDriversError("no drivers",{})))}nextPlayer(){var e;1!==this.availablePlayers.length?null==this.currentPlayerIndex||this.currentPlayerIndex>=this.availablePlayers.length-1?this.selectPlayer(0):this.selectPlayer(this.currentPlayerIndex+1):null===(e=this.restart)||void 0===e||e.call(this,!1)}selectPlayer(e){var t;if(this.suspended=!0,this.ctx.logger.debug("selectPlayer()",{index:e}),e>=this.availablePlayers.length)return void this.noDrivers();const i=this.availablePlayers[e];this.emit("driver",i.id);const r=c.players[i.id];if(null==r)return void this.noDrivers();if(null!=this.currentPlayer){const e=this.currentPlayer;this.currentPlayer=null,e.removeAllListeners("error"),e.dispose("replacing current player")}if(null!=r.format){const e=null===(t=this.manifest)||void 0===t?void 0:t.formats[r.format];this.updateQualities(e)}const s=new r((0,b.extendContext)(this.ctx,r),this.provider,i.options);this.currentPlayer=s,this.currentPlayerIndex=e,this.ctx.logger.debug("set manifest player",{player:this.currentPlayer,format:s.format,name:i}),s.on("error",e=>{switch(e.code){case l.ErrorCode.EmbedSWFFailed:case l.ErrorCode.NotSupported:case l.ErrorCode.HandleHlsJsError:case l.ErrorCode.JoinCallError:case l.ErrorCode.UnableJoinCall:this.ctx.logger.debug("Select next player because "+e.code),this.nextPlayer();break;default:e.critical&&(this.ctx.logger.debug("Select next player because the error is critical"),this.nextPlayer())}}),s.once("videoFirstPlay",()=>{var e,t,i,r,s;this.emit("initialLoadTime",y.stats.stop(this.firstLoadId,{driver:(null===(e=this.currentPlayer)||void 0===e?void 0:e.format)||void 0,abr:null===(t=this.manifest)||void 0===t?void 0:t.abr,aor:null===(i=this.manifest)||void 0===i?void 0:i.aor,atr:null===(r=this.manifest)||void 0===r?void 0:r.atr,rep:null===(s=this.manifest)||void 0===s?void 0:s.rep}))}),s.isImplements(u.Feature.BROADCAST)&&(s.on("websocketReconnect",this.handleWebsocketReconnect),s.addInnerDisposer(),null!=this.elementSupervisor&&s.initVideoEl(this.elementSupervisor,!0).catch(,this.suspended=!1}oJSON(){var e,t,i;const r=null===(e=this[_.implementation])||void 0===e?void 0:e.toJSON();if(null==r||"object"!=typeof r||Array.isArray(r)||(0,s.isSerializableObject)(r))return{};const o=null!==(t=r.aggregates)&&void 0!==t?t:{};return null==o||"object"!=typeof o||Array.isArray(o)||(0,s.isSerializableObject)(o)?r:(delete r.aggregates,Object.assign(Object.assign({},r),{options:this.options,playersSpecs:this.availablePlayers,currentPlayerIndex:this.currentPlayerIndex,uri:null===(i=this.provider)||void 0===i?void 0:i.uri,aggregates:Object.assign(Object.assign(Object.assign({},o),(0,s.extractAggregates)(this.provider,"support")),{support:this.ctx.support.hash})}))}}t.ManifestPlayer=C,C.displayName="ManifestPlayer"},"./node_modules/@video/video-client-core/lib/internal/player/media-element-supervisor.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MediaElementSupervisor=void 0;const r=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),s=i("./node_modules/@video/video-client-core/lib/internal/utils/debug/play-logs.js"),o=i("./node_modules/@video/video-client-core/lib/internal/utils/events/event-emitter.js"),n=i("./node_modules/@video/video-client-core/lib/internal/player/core.js"),a=new WeakMap;class l extends o.ObservableEventEmitter{static getSupervisoronstructor(e){super(),this.element=e,this.activePlayer=null,this.debugSuspendTimeupdate=!1,e.setAttribute("playsinline","true"),e.setAttribute("webkit-playsinline","true"),this.startListenEvent("play","handleElPlay"),this.startListenEvent("pause","handleElPause"),this.startListenEvent("volumechange","handleElVolumeChange"),this.startListenEvent("error","handleElError"),this.startListenEvent("progress","handleElProgress"),n.timeupdateWrapper.wrap(e,this.createEventHandler("handleElTimeupdate")),this.element.addEventListener("loadeddata",()=>{this.emit("loadeddata")})}attachToPlayer(e){return this.element.src="",this.element.srcObject=null,this.activePlayer=e,this}createEventHandler(e){return()=>{var t,i;null==this.activePlayer||this.activePlayer.isDisposed||"handleElTimeupdate"===e&&this.debugSuspendTimeupdate||null===(i=null===(t=this.activePlayer)||void 0===t?void 0:t[e])||void 0===i||i.call(t)}}startListenEvent(e,t){const i=this.createEventHandler(t);this.element.addEventListener(e,i),this.addInnerDisposer(this.stopListenEvent.bind(this,e,i))}sVideoPlayingateScreenshot(){try{return r.device.isImplements(r.Feature.CREATE_SCREENSHOT)?r.device.createScreenshot(this.element):null}catch(e){return null}}dateSrcObjectt muted(){return this.element.muted}set muted(e){this.element.muted=e}get paused(){return this.element.paused}get volume(){return this.element.volume}set volume(e){this.element.volume=e}get error(){return this.element.error}get autoplay(){return this.element.autoplay}set autoplay(e){this.element.autoplay=e}get buffered(){return this.element.buffered}get ended(){return this.element.ended}get readyState(){return this.element.readyState}get currentTime(){return this.element.currentTime}set currentTime(e){this.element.currentTime=e}get playbackRate(){return this.element.playbackRate}et sourceKind(){const e=r.device.isImplements(r.Feature.URL_LOCATION)?r.device.location:"";return null!=this.element.srcObject?"srcObject":null!=this.element.src&&""!==this.element.src&&this.element.src!==e?"src":null}isSourceSet(){const e=r.device.isImplements(r.Feature.URL_LOCATION)?r.device.location:"";return null!=this.element.src&&""!==this.element.src&&this.element.src!==e||null!=this.element.srcObject}get srcObject(){return this.element.srcObject}play(){return this.element.play()}}t.MediaElementSupervisor=l},"./node_modules/@video/video-client-core/lib/internal/player/mediasoup.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MediasoupPlayer=void 0;const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/@video/video-client-core/node_modules/@video/log-node/index.js"),o=i("./node_modules/mobx/dist/mobx.esm.js"),n=i("./node_modules/@video/video-client-core/lib/api/player/features/feature.js"),a=i("./node_modules/@video/video-client-core/lib/internal/errors.js"),l=i("./node_modules/@video/video-client-core/lib/internal/errors-deprecated.js"),d=i("./node_modules/@video/video-client-core/lib/internal/mediasoup-source.js"),c=i("./node_modules/@video/video-client-core/lib/internal/peer.js"),u=i("./node_modules/@video/video-client-core/lib/internal/utils/browser-support/browser.js"),p=i("./node_modules/@video/video-client-core/lib/internal/player/core.js"),h=i("./node_modules/@video/video-client-core/lib/internal/player/helper.js");class m extends p.CorePlayer{get displayName(){return m.displayName}static isSupported(e){return r.__awaiter(this,void 0,void 0,(function*(){return(0,u.supportsMediasoupWebrtc)("Mediasoup Player",e)}))}isSupported(){return r.__awaiter(this,void 0,void 0,(function*(){return m.isSupported()}))}static get format(){return"webrtc"}get format(){return m.format}get implementedFeatures(){return this.isManifestPlayer?[n.Feature.CONSUMER,n.Feature.BITRATE_SWITCHING,n.Feature.MUTED_AUTOPLAY]:[n.Feature.CONSUMER,n.Feature.BITRATE_SWITCHING]}constructor(e,t,i){super(e,t,i),this.preferredSource=null,this.hasAudio=!1,this.hasVideo=!1,this.isManifestPlayer=!1,(0,o.makeObservable)(this,{hasAudio:o.observable,hasVideo:o.observable,consumerAudioEnabled:o.computed,consumerVideoEnabled:o.computed,noConsumerAudioAndVideo:o.computed}),this.playerOptions=i,this.playerOptions.mutedAutoplayFallback&&(this.isManifestPlayer=!0),this.addInnerDisposer((0,o.reaction)(()=>this.availableQualities,e=>{this.emit("layers",(0,h.getBitrateLayersFromQualities)(e))},{equals:o.comparer.structural})),this.addInnerDisposer((0,o.reaction)(()=>this.currentQuality,e=>{var t;if(this.emit("activeLayer",null!==(t=null==e?void 0:e.layer)&&void 0!==t?t:null),this.provider instanceof d.MediasoupSource&&this.provider.peer instanceof c.Peer&&null!=(null==e?void 0:e.layer))try{this.provider.peer.setPreferredEncoding(e.layer)}catch(t){this.emitError((0,a.createError)(l.ErrorCode.UnableSwitchQuality,"Failed to change quality for webrtc consumer after currentQuality is changed",{player:this.displayName,format:this.format,preferredLevel:e.level}))}},{equals:o.comparer.structural})),this.provider instanceof d.MediasoupSource&&(this.provider.on("availableQualities",this.handleAvailableQualities),this.provider.on("accessDenied",this.handleAccessDenied)),this.addInnerDisposer(()=>{this.provider instanceof d.MediasoupSource&&(this.provider.off("availableQualities",this.handleAvailableQualities),this.provider.off("accessDenied",this.handleAccessDenied))}),this.ctx.logger.trace("constructor()",{options:i})}handleSource(e){return r.__awaiter(this,void 0,void 0,(function*(){this.suspended||(this.ctx.logger.trace("handleSource()"),this.source=e,null!=this.elementSupervisor&&(this.autoPlay?(yield this.playingPromise,this.ctx.logger.trace("handleSource() -> await this.playingPromise"),this.elementSupervisor.updateSrcObject(e),yield this.play(),this.ctx.logger.trace("handleSource() -> await play()")):this.elementSupervisor.updateSrcObject(e),this.ctx.logger.debug("srcObject set")),this.provider instanceof d.MediasoupSource&&(this.hasAudio=this.provider.hasAudio,this.hasVideo=this.provider.hasVideo,this.consumerAudioMuted=!this.hasAudio||this.provider.audioMuted,this.consumerVideoPaused=!this.hasVideo||this.provider.videoPaused,this.availableQualities=this.provider.availableQualities))}))}handleAccessDenied(e){var t;this.provider instanceof d.MediasoupSource&&(null===(t=this.provider.peer.call)||void 0===t||t.dispose(e.message))}handleAvailableQualities(e){this.availableQualities=e}get consumerAudioEnabled(){const{consumerAudioMuted:e,hasAudio:t}=this;return this.provider instanceof d.MediasoupSource&&(t&&!1===e)}get consumerVideoEnabled(){const{consumerVideoPaused:e,hasVideo:t}=this;return this.provider instanceof d.MediasoupSource&&(t&&!1===e)}get noConsumerAudioAndVideo(){const{consumerAudioMuted:e,hasAudio:t,consumerVideoPaused:i,hasVideo:r}=this;return!(t&&!1===e||r&&!1===i)}et peerId(){var e,t;return this.provider instanceof d.MediasoupSource&&null!==(t=null===(e=this.provider.peer)||void 0===e?void 0:e.peerId)&&void 0!==t?t:""}get callId(){var e,t,i;return this.provider instanceof d.MediasoupSource&&null!==(i=null===(t=null===(e=this.provider.peer)||void 0===e?void 0:e.call)||void 0===t?void 0:t.id)&&void 0!==i?i:""}get userId(){var e,t;return this.provider instanceof d.MediasoupSource&&null!==(t=null===(e=this.provider.peer)||void 0===e?void 0:e.userId)&&void 0!==t?t:""}toJSON(){var e;const t=super.toJSON();if(null==t||"object"!=typeof t||Array.isArray(t)||(0,s.isSerializableObject)(t))return{};const i=null!==(e=t.aggregates)&&void 0!==e?e:{};return null==i||"object"!=typeof i||Array.isArray(i)||(0,s.isSerializableObject)(i)?t:(delete t.aggregates,Object.assign(Object.assign({},t),{options:this.options,aggregates:Object.assign(Object.assign(Object.assign({},i),(0,s.extractAggregates)(this.provider,"support")),{support:this.ctx.support.hash,consumerAudioEnabled:this.consumerAudioEnabled,consumerVideoEnabled:this.consumerVideoEnabled,noConsumerAudioAndVideo:this.noConsumerAudioAndVideo,preferredSource:this.preferredSource,currentQuality:this.currentQuality,isManifestPlayer:this.isManifestPlayer,peerId:this.peerId,userId:this.userId})}))}}t.MediasoupPlayer=m,m.displayName="MediasoupPlayer"},"./node_modules/@video/video-client-core/lib/internal/player/mp4-ws.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Mp4WsPlayer=void 0;const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/@video/log-client/index.js"),o=i("./node_modules/mobx/dist/mobx.esm.js"),n=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),a=i("./node_modules/@video/video-client-core/lib/api/player/features/feature.js"),l=i("./node_modules/@video/video-client-core/lib/utils/common.js"),d=i("./node_modules/@video/video-client-core/lib/internal/errors-deprecated.js"),c=i("./node_modules/@video/video-client-core/lib/internal/utils/browser-support/index.js"),u=i("./node_modules/@video/video-client-core/lib/internal/utils/context/context.js"),p=i("./node_modules/@video/video-client-core/lib/internal/utils/debug/instance-collector.js"),h=i("./node_modules/@video/video-client-core/lib/internal/utils/events/event-emitter.js"),m=i("./node_modules/@video/video-client-core/lib/internal/utils/logger.js"),v=i("./node_modules/@video/video-client-core/lib/internal/utils/uuid.js"),g=i("./node_modules/@video/video-client-core/lib/internal/player/core.js"),f=i("./node_modules/@video/video-client-core/lib/internal/player/helper.js"),b="lv_estimated_kbps",_="lv_origin",y=["A","B","N"];let w=0;class S extends g.CorePlayer{static isSupported(e){return r.__awaiter(this,void 0,void 0,(function*(){return(0,c.supportsMp4)(e)}))}isSupported(){return r.__awaiter(this,void 0,void 0,(function*(){return S.isSupported()}))}static get format(){return"mp4-ws"}get format(){return S.format}handleSource(e){this.ctx.logger.debug("mp4-ws: handleSource()");const t=null==e?void 0:e.formats["mp4-ws"];null!=t?0===this.data.encodings.length&&(this.data=t):this.emitErrorDeprecated(new d.DriverNotSupportedError("manifest doesn't contains 'mp4-hls' format",{manifest:e}))}get implementedFeatures(){return[a.Feature.BITRATE_SWITCHING,a.Feature.MUTED_AUTOPLAY]}constructor(e,t,i){var r;if(super(e,t,i),this.data={encodings:[],audioCodec:"",videoCodec:""},this.sessionKey=(0,v.uuidv4)(),this.origin=null,this.player=null,this.currentManifest=null,this.seekingOverHole=!1,this.activeEncoding=null,this.estimatedKbps=null,this.playbackLock=!1,this.nudgeInterval=void 0,this.nudgeTime=null,this.lastBufferEnd=null,this.fragFetchTime=0,!n.device.isImplements(n.Feature.DEBUGGING)||!n.device.isImplements(n.Feature.MEDIA_DEVICE))throw new Error("Device is not supported");(0,u.onceCanceled)(this.ctx).then(e=>this.dispose("Mp4Ws Player Context Cancelled: "+e)),this.addInnerDisposer(this.stop),this.device=n.device;const s=this.options;(null==s.backFill||Number.isNaN(s.backFill)||s.backFill<0||s.backFill>10)&&(s.backFill=2),(null==s.maxGap||Number.isNaN(s.maxGap)||s.maxGap<0||s.maxGap>1e4)&&(s.maxGap=500),(null==s.retry||Number.isNaN(s.retry)||s.retry<0||s.retry>30)&&(s.retry=20),(null==s.requiredBuffer||Number.isNaN(s.requiredBuffer)||s.requiredBuffer<0||s.requiredBuffer>10)&&(s.requiredBuffer=1),(n.device.isImplements(n.Feature.BROWSER_TYPE)&&"edge"===n.device.browserInfo.name||n.device.isImplements(n.Feature.BROWSER_TYPE)&&"ie"===n.device.browserInfo.name)&&(s.backFill=Math.max(s.backFill,4),s.requiredBuffer=Math.max(s.requiredBuffer,3)),(null==s.initFailTimeout||Number.isNaN(s.initFailTimeout)||s.initFailTimeout<0)&&(s.initFailTimeout=3e4),(null==s.playbackFailTimeout||Number.isNaN(s.playbackFailTimeout)||s.playbackFailTimeout<0)&&(s.playbackFailTimeout=6e4),null!=s.mode&&y.includes(s.mode)||(s.mode="B"),s.requiredBufferBeforeRemove=s.requiredBuffer,s.skipWatchInterval=Math.floor(400*s.requiredBuffer),s.skipForwardThreshold=25,Number.isNaN(null!==(r=s.maxShifts)&&void 0!==r?r:NaN)&&(s.maxShifts=1/0),this.mse=this.options,this.on("currentQuality",e=>{var t;this.setQuality(e),null===(t=this.player)||void 0===t||t.setupTransport()}),(0,o.autorun)(e=>{const t=this.elementSupervisor,i=this.provider.source;null!=t&&null!=i&&(e.dispose(),this.handleSource(i),this.initSource(t))})}handleElTimeupdate(){var e;super.handleElTimeupdate();const t=this.elementSupervisor,i=null===(e=this.elementSupervisor)||void 0===e?void 0:e.buffered;null!=t&&null!=i&&0!==i.length&&(i.end(i.length-1)-t.currentTime>this.mse.requiredBuffer?n.device.isImplements(n.Feature.BROWSER_TYPE)&&"safari"===n.device.browserInfo.name?t.playbackRate=1.01:t.playbackRate=1.05:t.playbackRate=1)}handleElError(){var e,t,i;super.handleElError();const r=null===(t=null===(e=this.elementSupervisor)||void 0===e?void 0:e.error)||void 0===t?void 0:t.code;if(null!=r)switch(r){case 1:this.emitErrorDeprecated(new d.MediaError("MEDIA_ERR_ABORTED",{critical:!0,eventTargetCode:r}));break;case 2:this.emitErrorDeprecated(new d.MediaError("MEDIA_ERR_NETWORK",{critical:!0,eventTargetCode:r}));break;case 3:this.emitErrorDeprecated(new d.DriverNotSupportedError("MEDIA_ERR_DECODE",{critical:!0,eventTargetCode:r}));break;case 4:this.emitErrorDeprecated(new d.DriverNotSupportedError("MEDIA_ERR_SRC_NOT_SUPPORTED",{critical:!0,eventTargetCode:r}));break;default:(null===(i=this.elementSupervisor)||void 0===i?void 0:i.isSourceSet())||this.ctx.logger.error("meow unknown element error",{manifest:this.manifest}),this.localVideoPaused||this.isDisposed||this.restart(!1)}}handleElPause(){super.handleElPause(),"offline"===this.provider.currentState&&this.stop()}getLevelForBitrate(e){var t,i;const{encodings:r}=this.data;if(0===r.length)return null;let s;for(s=0;s<r.length;s++){const o=r[s];if(null!=o&&null!=o.videoWidth&&(null!==(t=r[s].videoKbps)&&void 0!==t?t:0)+(null!==(i=r[s].audioKbps)&&void 0!==i?i:0)>e)break}return s=Math.max(s-1,0),s}get currentLevel(){var e,t,i,r,s;return null!=this.options.bitrate?this.getLevelForBitrate(this.options.bitrate):null==this.activeEncoding?this.getLevelForBitrate(null!==(e=this.options.estimatedKbps)&&void 0!==e?e:0):this.getLevelForBitrate((null!==(i=null===(t=this.activeEncoding)||void 0===t?void 0:t.videoKbps)&&void 0!==i?i:0)+(null!==(s=null===(r=this.activeEncoding)||void 0===r?void 0:r.audioKbps)&&void 0!==s?s:0))}pickEncoding(e){var t;const i=null!=e?e:this.options.bitrate;let{encodings:r}=this.data;if(0===r.length)return null;if(null==i)return r[0];r=r.sort((e,t)=>{var i,r,s,o;return(null!==(i=e.audioKbps)&&void 0!==i?i:0)+(null!==(r=e.videoKbps)&&void 0!==r?r:0)<(null!==(s=t.audioKbps)&&void 0!==s?s:0)+(null!==(o=t.videoKbps)&&void 0!==o?o:0)?1:-1});const s=r.find(e=>{var t,r;return(null!==(t=e.audioKbps)&&void 0!==t?t:0)+(null!==(r=e.videoKbps)&&void 0!==r?r:0)<=i});return null!=s?s:r[null!==(t=this.currentLevel)&&void 0!==t?t:0]}setQuality(e){null!=(null==e?void 0:e.encoding)?this.setEncoding(e.encoding):this.ctx.logger.warn("encoding not found",{qty:e})}setEncoding(e){var t,i,r,s,o;if(null==e||(null===(t=this.activeEncoding)||void 0===t?void 0:t.videoKbps)===e.videoKbps&&(null===(i=this.activeEncoding)||void 0===i?void 0:i.audioKbps)===e.audioKbps)return;if(this.activeEncoding=e,this.estimatedKbps=(null!==(r=e.videoKbps)&&void 0!==r?r:0)+(null!==(s=e.audioKbps)&&void 0!==s?s:0),n.device.isImplements(n.Feature.BROWSER_TYPE)&&"safari"===n.device.browserInfo.name){this.stop();try{this.play().then(()=>{this.emit("bitrate-switch")})}catch(e){const t=e instanceof Error?e:null;this.emitErrorDeprecated(new d.PlayingIssueError("play failed after setEncoding()",{inner:t,player:this}))}return}const a=e.location.split("/");null===(o=this.player)||void 0===o||o.switchBitrate(a[a.length-1]),this.emit("bitrate-switch")}switchBitrate(e){this.ctx.logger.debug("meow switch bitrate",{bitrate:e}),this.options.origin=!1,this.options.bitrate=e,this.emit("bitrate-switch"),this.stop();try{this.play().then(()=>{this.emit("bitrate-switch")})}catch(e){const t=e instanceof Error?e:null;this.emitErrorDeprecated(new d.PlayingIssueError("play failed after switchBitrate()",{inner:t,player:this}))}}addSessionKey(e){if(e.includes("sid"))return e;w++;const t=e.includes("?")?"&":"?";return`${e}${t}sid=${this.sessionKey}&c=${w}`}get originLocation(){const e=this.origin;return null==e?null:this.addSessionKey(e.location)}get manifest(){var e,t;let i;if(this.options.origin){if(i=this.originLocation,null==i)return this.options.origin=!1,this.manifest}else{if(0===this.data.encodings.length){const e=this.originLocation;return null!=e&&(this.options.origin=!0),e}const r=this.pickEncoding(null!==(t=null!==(e=this.options.bitrate)&&void 0!==e?e:this.estimatedKbps)&&void 0!==t?t:this.options.estimatedKbps);if(null==r)return null;i=r.location}return null==i?null:this.addSessionKey(i)}top(){this.playbackLock=!1,clearInterval(this.nudgeInterval),null!=this.player&&this.player.once("disposed",()=>{this.player=null})}et location(e){}corePlay(){const e=Object.create(null,{play:{get:()=>super.play}});return r.__awaiter(this,void 0,void 0,()}play(){return r.__awaiter(this,void 0,void 0,(function*(){const e=this.elementSupervisor;if(null==e)throw new Error(f.ERRORS.ELEMENT_REQUIRED);return this.playbackLock?!e.paused:(this.playbackLock=!0,this.options.autoPlay&&this.localVideoPaused&&setTimeout(,null!=this.player?this.player.play():(this.ctx.logger.debug("meow driver play received"),!this.localVideoPaused))}))}initSource(e){if(null!=this.player)return;clearInterval(this.nudgeInterval),this.nudgeTime=null;let t=0;this.nudgeInterval=n.device.setInterval(()=>{if(!this.localVideoPaused&&0!==e.currentTime){if(null!=this.nudgeTime&&e.currentTime===this.nudgeTime&&(null==this.lastBufferEnd||e.currentTime<this.lastBufferEnd)){this.ctx.logger.debug("meow playback halted, nudging"),t++,e.currentTime+=.1;const i=this.corePlay();null!=i.then&&i.catch(()=>{})}else t=0,this.nudgeTime=e.currentTime;t>29&&(clearInterval(this.nudgeInterval),this.ctx.logger.debug("meow too many halt nudges, restart"),this.restart(!1))}},500);const i=this.provider.source;if(null!=i&&setTimeout(,this.ctx.logger.debug("meow manifest verified, player created"),null==this.elementSupervisor)throw new Error(f.ERRORS.ELEMENT_REQUIRED);if(this.player=new C(this.ctx,this,this.options,this.provider,Reflect.get(this.elementSupervisor,"element")),this.counters.upshift=0,this.counters.downshift=0,this.counters.currentErrorCount=0,this.counters.fragCounts=0,this.counters.fragSize=0,this.counters.fragFetchTime=0,this.counters.fragMaxTime=0,this.counters.fragMinTime=0,this.player.on("stop",,this.player.on("no-audio",()=>{this.emit("no-audio")}),this.player.on("upshift",()=>{this.counters.upshift++}),this.player.on("downshift",,this.player.on("fragment",e=>{var t;this.counters.fragCounts++,this.counters.fragSize+=e.size,this.counters.fragFetchTime+=e.time,this.counters.fragMaxTime=Math.max(this.counters.fragMaxTime,e.time),this.counters.fragMinTime=Math.min(null!==(t=this.counters.fragMinTime)&&void 0!==t?t:e.time,e.time)}),this.player.on("error",e=>{this.counters.currentErrorCount++,e.notSupported?this.emitErrorDeprecated(new d.DriverNotSupportedError("player error",{data:{fatal:e.fatal,message:e.message,notSupported:e.notSupported,err:(0,d.wrapNativeError)(e.err)}})):e.fatal&&(this.ctx.logger.debug("meow player fatal error, restarting"),this.restart(!1))}),this.device.hidden)this.device.addEventListener("visibilitychange",()=>{var e;try{null===(e=this.player)||void 0===e||e.play()}catch(e){const t=e instanceof Error?e:null;this.emitErrorDeprecated(new d.PlayingIssueError("play failed after visibilitychange event triggered",{inner:t,player:this}))}});else try{this.pausedOnUnmount||this.player.play()}catch(e){const t=e instanceof Error?e:null;this.emitErrorDeprecated(new d.PlayingIssueError("play failed",{inner:t,player:this}))}}}t.Mp4WsPlayer=S,S.displayName="Mp4WsPlayer";const E=new WeakMap;class C extends h.ObservableEventEmitter{constructor(e,t,i,r,s){var o,a;if(super(),this.buffering=!1,this.queue=[],this.sourceBuffers=[],this.receivedSegments=0,this.abrController=null,this.encoding=null,this.transport=null,this.version=null,this.ms=null,this.mediaSourceTime=null,this.manifest=null,this.lastMessageReceived=null,this.logInterval=void 0,this.gcInterval=void 0,this.destroyed=!1,this.ctx=e,(0,u.onceCanceled)(e).then(e=>this.dispose("Mp4ws Context Cancelled: "+e)),this.addInnerDisposer(this.destroy),!n.device.isImplements(n.Feature.DEBUGGING)||!n.device.isImplements(n.Feature.MEDIA_SOURCE)||!n.device.isImplements(n.Feature.LOCAL_STORAGE))throw new Error("Device is not supported");if(this.device=n.device,this.videoPlayer=t,this.mediaLoader=r,this.options=i,this.el=s,null==this.options.bitrate){const t=null!==(o=this.device.localStorage.getItem(_))&&void 0!==o?o:"normal",i=new T((0,m.extendContext)(e,T),this,this.videoPlayer,t,!1,null!==(a=this.options.maxShifts)&&void 0!==a?a:1/0,this.options);this.abrController=i,i.on("profile",e=>{this.device.localStorage.setItem(b,e.estimatedKbps.toString()),this.device.localStorage.setItem(_,e.profile.key)}),this.abrController.on("upshift",()=>{this.emit("upshift")}),this.abrController.on("downshift",()=>{this.emit("downshift")})}let l;l=this.options.origin?this.videoPlayer.data.origin:this.videoPlayer.pickEncoding(),null==l&&this.videoPlayer.data.encodings.length>0&&([l]=this.videoPlayer.data.encodings),null!=l&&(this.encoding=l),this.setupMSE()}appendBuffer(){if(this.buffering)return;const e=()=>{this.buffering=!0,n.device.setTimeout(20)};if("open"!==this.readyState)return void e();const t=this.queue.shift();if(null!=t)if(this.buffering=!0,"remove"===t.type){if(null==t.sb)return this.buffering=!1,void this.appendBuffer();this.ctx.logger.debug("remove buffer",{buffer:`${t.start}-${t.end} buffered until ${t.sb.buffered.end(0)}`}),t.sb.remove(t.start,t.end)}else t.blob.arrayBuffer().then(i=>{if(null==this.transport)throw new Error("Transport is not defined");const r=this.transport.getSegmentInfo(i);1===this.version&&(r.contentTag=0);const s=this.sourceBuffers[r.contentTag];if(this.emit("fragment",{size:t.blob.size,time:t.time,duration:300}),"open"!==this.readyState)return this.ctx.logger.debug("meow mse not ready",{readyState:this.readyState}),this.queue.unshift(t),void e();if(null==s)return this.queue.unshift(t),void e();try{s.appendBuffer(i)}catch(e){this.emitErrorDeprecated(new d.Mp4BufferError("failed to append source buffer in appendBuffer()",{inner:(0,d.wrapNativeError)(e)}))}});else e()}get readyState(){var e;if(null==this.ms)return null;const{encoding:t}=this;return null==t||(null===(e=t.channels)||void 0===e?void 0:e.length)!==this.sourceBuffers.length?null:this.ms.readyState}checkSourceBuffers(){var e,t,i;for(const t of this.sourceBuffers)if(0===(null!==(e=null==t?void 0:t.buffered.length)&&void 0!==e?e:0))return!1;return 0!==(null!==(i=null===(t=this.el)||void 0===t?void 0:t.buffered.length)&&void 0!==i?i:0)}newSourceBuffer(e){if(null==e||!this.device.MediaSource.isTypeSupported(e))return void this.sourceBuffers.push(null);if(null==this.ms)return;const t=this.ms.addSourceBuffer(e);this.ctx.logger.debug("meow adding sourcebuffer",{mimetype:e}),E.set(t,{mimetype:e}),t.addEventListener("error",e=>{this.emitErrorDeprecated(new d.Mp4BufferError("failed to append source buffer in newSourceBffer()",{inner:e})),this.buffering=!1,this.appendBuffer()}),t.addEventListener("updateend",()=>{var e,t,i;this.buffering=!1,this.appendBuffer();const{el:r}=this;if(null==r)return;if(r.buffered.length>0){const s=r.buffered.end(r.buffered.length-1)-r.currentTime;if(0===r.currentTime){if(r.buffered.end(r.buffered.length-1)-r.buffered.start(0)>(null!==(e=this.options.requiredBuffer)&&void 0!==e?e:0)){const e=Math.max(r.buffered.end(r.buffered.length-1)-(null!==(t=this.options.requiredBuffer)&&void 0!==t?t:0),r.buffered.start(0));r.currentTime=e,this.ctx.logger.debug("meow attempting to start",{startTime:e}),this.play()}}else if(s>25){const e=r.currentTime,t=Math.max(r.buffered.end(r.buffered.length-1)-(null!==(i=this.options.requiredBuffer)&&void 0!==i?i:0),r.buffered.start(0));r.currentTime=t,this.ctx.logger.warn("meow buffer max reached, moving to playback head",{max:25,ct:e,nt:t})}}if(this.receivedSegments++,this.receivedSegments>60&&!this.checkSourceBuffers())return this.ctx.logger.error("no buffer after 60 segments"),void this.emit("error",{message:"media-error",fatal:!0,notSupported:!0});const s=[];this.sourceBuffers.forEach((e,t)=>{if(null!=e&&"open"===this.readyState)for(let i=0;i<e.buffered.length;i++)s.push({sourceBufferIndex:t,index:i,start:e.buffered.start(i),end:e.buffered.end(i)})}),s.length}),this.sourceBuffers.push(t)}setupMSE(){this.ms=new this.device.MediaSource,this.ms.addEventListener("error",()=>{this.ctx.logger.error("meow mediasource dom error"),this.emit("error",{message:"media-error",fatal:!0})}),this.ms.addEventListener("abort",()=>{this.ctx.logger.error("meow mediasource dom abort"),this.emit("error",{message:"media-error",fatal:!0})}),this.ms.addEventListener("sourceended",()=>{this.ctx.logger.debug("meow mediasource source ended")}),this.ms.addEventListener("sourceclose",()=>{this.ctx.logger.debug("meow mediasource source closed")}),this.ms.addEventListener("sourceopen",this.onSourceOpen),this.ctx.logger.debug("meow attempting to create media source"),this.mediaSourceTime=this.device.performance.now(),this.videoPlayer.source=URL.createObjectURL(this.ms),null!=this.el&&(this.el.src=this.videoPlayer.source)}onSourceOpen(){this.ms.removeEventListener("sourceopen",this.onSourceOpen),this.ctx.logger.debug("meow media source opened");const{encoding:e}=this;if(null!=e)try{if(null!=(null==e?void 0:e.channels)){if(0===e.channels.length)return void this.emit("error",{message:"media-error",fatal:!0,notSupported:!0});this.version=2;for(const t of e.channels)this.newSourceBuffer(t)}else{this.version=1;const{origin:e}=this.videoPlayer.data;let t;t=null!=this.options.origin&&null!=e&&"aac"!==e.audioCodec||!this.options.origin&&"aac"!==this.videoPlayer.data.audioCodec?'video/mp4; codecs="avc1.4d4028"':'video/mp4; codecs="avc1.4d4028, mp4a.40.2"',this.ctx.logger.debug("meow adding sourcebuffer",{mimetype:t}),this.newSourceBuffer(t)}}catch(e){const t=e instanceof Error?e:null;this.emitErrorDeprecated(new d.MeowDriverError("meow error in newSourceBuffer(). restarting player",{inner:t})),this.destroy(),this.videoPlayer.player=null,this.videoPlayer.restart(!1)}else this.emit("error",{message:"media-error",fatal:!0})}setupTransport(){var e,t,i,r,s,o;const n=(null!==(i=null===(t=null===(e=this.encoding)||void 0===e?void 0:e.channels)||void 0===t?void 0:t.length)&&void 0!==i?i:0)>0?null!==(o=null===(s=null===(r=this.encoding)||void 0===r?void 0:r.channels)||void 0===s?void 0:s.length)&&void 0!==o?o:0:1,{manifest:a}=this.videoPlayer;this.manifest=a,null!=a?(null!=this.transport&&(this.transport.removeAllListeners(),this.transport.destroy()),this.transport=new x((0,m.extendContext)(this.ctx,x),a,this.options.backFill,this.options.maxGap,this.options.retry,this.options.mode,this.options.download,this.options.segmentDuration,n),this.transport.on("error",()=>{var e;(null===(e=this.transport)||void 0===e?void 0:e.disconnected)?this.emit("error",{message:f.ERRORS.WS_NETWORK_ERROR,fatal:!1}):this.emit("error",{message:"websocket-connection",notSupported:!0})}),this.transport.on("destroy",,this.transport.on("message",e=>{this.lastMessageReceived=this.device.performance.now(),this.queue.push({type:"append",blob:e.data,time:e.fetchTime}),this.appendBuffer()})):this.emit("error",{message:f.ERRORS.INVALID_MEDIA_URL,fatal:!0})}switchBitrate(e){var t;this.ctx.logger.debug("meow switching bitrate to ",{name:e}),null===(t=this.transport)||void 0===t||t.switchBitrate(e)}play(){return r.__awaiter(this,void 0,void 0,(function*(){return new Promise(e=>{const{el:t}=this;if(null==t)throw new Error(f.ERRORS.ELEMENT_REQUIRED);return this.queue=[],null==this.transport&&this.setupTransport(),this.lastMessageReceived=this.device.performance.now(),this.logInterval=n.device.setInterval(()=>{var e;const t=this.device.performance.now()-(null!==(e=this.lastMessageReceived)&&void 0!==e?e:0);t>2e3&&this.emit("error",{message:"stall",timeSinceLastFrag:t})},1e3),this.gcInterval=n.device.setInterval(()=>{if(null!=(null==t?void 0:t.currentTime))for(const e of this.sourceBuffers)this.queue.push({type:"remove",sb:null!=e?e:void 0,start:0,end:t.currentTime-15})},3e4),this.ctx.logger.info("meow player play attempted"),this.videoPlayer.corePlay().catch(e=>{this.ctx.logger.warn("meow player play attempt failed",{errName:e.name,errMessage:e.message}),this.stop()})})}))}stop(){var e;const{el:t}=this;if(null==t)throw new Error(f.ERRORS.ELEMENT_REQUIRED);this.ctx.logger.debug("meow player stop"),clearInterval(this.gcInterval),clearInterval(this.logInterval),null===(e=this.transport)||void 0===e||e.removeAllListeners("message"),this.buffering=!1,t.pause(),""!==t.src&&(this.ctx.logger.debug("meow revoking media source url"),URL.revokeObjectURL(t.src),t.src=""),this.emit("stop")}destroy(){var e;this.destroyed=!0,null!=this.transport&&(this.transport.removeAllListeners("destroy"),this.transport.removeAllListeners("message"),this.transport.destroy()),null===(e=this.abrController)||void 0===e||e.destroy(),this.stop()}}C.displayName="Mp4WsPlayer";const j=["moof","mfhd"];lass R{constructor(){this.lastTime=n.device.isImplements(n.Feature.DEBUGGING)?n.device.performance.now():Date.now(),this.lastSegmentTime=n.device.isImplements(n.Feature.DEBUGGING)?n.device.performance.now():Date.now(),this.lastSegmentDuration=0}}class x extends h.ObservableEventEmitter{constructor(e,t,i=0,r=500,s=20,o="B",a=!1,l=300,d=1){if(super(),this.downloadedSegments=[],this.introFrag={},this.channelTracker=0,this.channelLatency=[],this.pingInterval=void 0,this.ctx=e,(0,u.onceCanceled)(e).then(e=>this.dispose("Transport Class Context Cancelled: "+e)),this.addInnerDisposer(this.destroy),!n.device.isImplements(n.Feature.DEBUGGING)||!n.device.isImplements(n.Feature.MEDIA_SOURCE)||!n.device.isImplements(n.Feature.LOCAL_STORAGE))throw new Error("Device is not supported");this.device=n.device,this.uri=t,this.backFill=i,this.maxGap=r,this.retry=s,this.mode=o,this.segmentDuration=l,this.saveToDownload=a,this.introFrag={};const c=`${this.uri}&bckfil=${this.backFill}`;this.ws=new WebSocket(c),p.InstanceCollector.reportNewInstance("websocket",this.ws,{file:"player/mp4-ws.ts"}),this.channelLatency=[];for(let e=0;e<d;e++)this.channelLatency.push(new R);this.ctx.logger.debug("meow ws connecting",{url:c}),this.ws.onopen=this.ws.onmessage=e=>{var t;if("object"==typeof e.data)return this.emit("message",Object.assign(Object.assign({},e),{data:e.data,fetchTime:this.device.performance.now()-this.lastTime+10,segmentDuration:null!==(t=this.lastSegmentDuration)&&void 0!==t?t:this.segmentDuration})),this.lastSegmentTime=this.device.performance.now(),this.saveToDownload&&this.downloadedSegments.push(e.data),void this.nextChannel();const i=e.data.split(/\s/g),r=parseInt(i[0],10);if(Number.isNaN(r))try{this.introFrag=JSON.parse(e.data)}catch(t){this.ctx.logger.error("unhandled websocket frame - attempted to parse and failed",{event:e.data})}else this.lastTime=this.device.performance.now(),this.lastSegmentDuration=r<2e3&&r>0?r:this.segmentDuration},this.ws.onclose=e=>{this.ctx.logger.debug("meow ws closing",{reason:e.reason,code:e.code}),p.InstanceCollector.disposeInstance("websocket",this.ws),this.emit("close",{code:e}),this.emit("destroy")},this.ws.onerror=()=>{this.emit("error")},e.logger.attachObject(this),e.logger.trace("constructor()")}get lastTime(){return this.channelLatency[this.channelTracker].lastTime}set lastTime(e){this.channelLatency[this.channelTracker].lastTime=e}get lastSegmentTime(){return this.channelLatency[this.channelTracker].lastSegmentTime}set lastSegmentTime(e){this.channelLatency[this.channelTracker].lastSegmentTime=e}et lastSegmentDurationextChannel(){this.channelTracker++,this.channelLatency.length>=this.channelTracker&&(this.channelTracker=0)}tSegmentInfo(e){const t=new DataView(e),i=function(e,t){return e.byteLength<9||1936419184!==t.getUint32(e.byteLength-5)?1:t.getUint8(e.byteLength-1)}(e,t);let r=0,s=0,o=0,n=e.byteLength,a=0,l=!1;for("ftyp"==`${P(t,4)}${P(t,5)}${P(t,6)}${P(t,7)}`&&(l=!0),s=0;s<n&&o<j.length;)r=t.getUint32(s),P(t,s+4)===j[o].charAt(0)&&P(t,s+5)===j[o].charAt(1)&&P(t,s+6)===j[o].charAt(2)&&P(t,s+7)===j[o].charAt(3)?(n=s+r,o++,s+=8):s+=r;return o===j.length&&(a=t.getUint32(s+4)),{contentTag:i,segment:a,init:l}}switchBitrate(e){this.ws.send(`switch_stream?name=${e}&mode=${this.mode}&bckfil=${this.backFill}&retry=${this.retry}&mxgap=${this.maxGap}`)}destroy(){this.ctx.logger.info("meow transport destroy"),this.downloadedSegments=[],clearInterval(this.pingInterval),null!=this.ws&&(this.ctx.logger.info("meow ws close"),this.ws.onerror=null,this.ws.close(),p.InstanceCollector.disposeInstance("websocket",this.ws),this.dispose("Transport was destroyed"))}toJSON(){return{uri:this.uri,disconnected:this.disconnected,retry:this.retry,aggregates:{support:this.ctx.support.hash,wsReadyState:this.ws.readyState}}}}x.displayName="Mp4WsTransport";const D={stable:{key:"stable",bwModifier:e=>Math.min(e,e-(.01*e+Math.log(e*e)/Math.log(2))),resistUpshift:(e,t)=>2.5*t+Math.pow(Math.log(2*t),3.2)>2*e,resistDownshift:(e,t)=>2*e+Math.pow(Math.log(2*e),3.2)>2*t},normal:{key:"normal",bwModifier:e=>Math.min(e,e-(.06*e+Math.log(e*e)/Math.log(2))),resistUpshift:(e,t)=>2.5*t+Math.pow(Math.log(2*t),3.4)>2*e,resistDownshift:(e,t)=>2*e+Math.pow(Math.log(2*e),3.4)>2*t},uncertain:{key:"uncertain",bwModifier:e=>Math.min(e,e-(.3*e+Math.log(e*e)/Math.log(2))),resistUpshift:(e,t)=>2.5*t+Math.pow(Math.log(2*t),3.6)>2*e,resistDownshift:(e,t)=>2*e+Math.pow(Math.log(2*e),3.4)>2*t},sporadic:{key:"sporadic",bwModifier:e=>Math.min(e,e-(.5*e+Math.log(e*e)/Math.log(2))),resistUpshift:(e,t)=>2.5*t+Math.pow(Math.log(2*t),4)>2*e,resistDownshift:(e,t)=>2*e+Math.pow(Math.log(2*e),3.4)>2*t}};class T extends h.ObservableEventEmitter{constructor(e,t,i,r,o,a,d){var c,p,h;if(super(),this.switchThreshold=8e3,this.count=0,this.dropCount=0,this.totalShifts=0,this.rawKbps=[],this.recentKbps=[],this.sampleBws=[],this.selectedEncoding=null,this.emergencyModifier=1,this.releaseEmergencyTimeout=void 0,this.profileInterval=void 0,this.trackRecentKbpsInterval=void 0,this.estimatedKbpsInterval=void 0,this.destroyed=!1,this.spinTimeout=void 0,this.ctx=e,(0,u.onceCanceled)(e).then(e=>this.dispose("AbrController Class Context Cancelled: "+e)),this.addInnerDisposer(this.destroy),!n.device.isImplements(n.Feature.DEBUGGING)||!n.device.isImplements(n.Feature.MEDIA_SOURCE)||!n.device.isImplements(n.Feature.LOCAL_STORAGE))throw new Error("Device is not supported");this.logger=new s.LoggerCore(l.PACKAGE_NAME).extend(e.logger),this.device=n.device,this.options=d,this.player=t,this.driver=i,this.switchImmediately=o,this.profile=null!==(c=D[r])&&void 0!==c?c:D.normal,this.maxShifts=null!=a?a:1/0,this.currentKbps=null!==(p=this.options.bitrate)&&void 0!==p?p:Math.max(null!==(h=this.options.estimatedKbps)&&void 0!==h?h:0,244),this.lastMessageTime=this.device.performance.now(),this.lastSwitch=-8e3,this.init()}init(){this.player.on("fragment",this.onMessage),this.profileInterval=n.device.setInterval(this.profileStream.bind(this),1e4),this.trackRecentKbpsInterval=n.device.setInterval(()=>{let e=0;for(let t=0;t<this.rawKbps.length;t++)e+=this.rawKbps[t];const t=e/this.rawKbps.length;this.rawKbps=[],this.recentKbps.unshift(t),this.recentKbps.splice(120)},1e3),this.estimatedKbpsInterval=n.device.setInterval(()=>{this.emit("profile",{estimatedKbps:this.currentKbps,profile:this.profile}),null!=this.selectedEncoding?this.logger.debug("meow abr estimated",{KBPS:this.currentKbps,modifier:this.emergencyModifier,lastSwitch:this.lastSwitch,shiftable:this.shiftable,profile:this.profile.key,encoding:this.selectedEncoding}):this.logger.debug("meow abr estimated",{KBPS:this.currentKbps,modifier:this.emergencyModifier,lastSwitch:this.lastSwitch,shiftable:this.shiftable,profile:this.profile.key})},4e3)}get shiftable(){return this.totalShifts<this.maxShifts&&this.sampleBws.length>25&&this.device.performance.now()-this.lastSwitch>this.switchThreshold}handleEmergencyDrop(e,t){this.dropCount++,this.dropCount<2||(this.dropCount=0,this.emergencyModifier=e,this.sampleBws.splice(t),n.device.clearTimeout(this.releaseEmergencyTimeout),n.device.setTimeout(()=>{this.emergencyModifier=1},900))}profileStream(){const e=[];e.push(...this.recentKbps),e.sort(;const t=Math.floor(e.length/4),i=(e[2*t]-e[t])/e[2*t]+(e[3*t]-e[2*t])/e[3*t];this.profile=i>1?D.sporadic:i>.65?D.uncertain:i>.3?D.normal:D.stable}onMessage(e){if(this.destroyed)return;this.lastMessageTime=this.device.performance.now(),e.time>2.5*e.duration?(this.dropCount++,this.handleEmergencyDrop(.6,72)):e.time>2.25*e.duration?this.handleEmergencyDrop(.7,Math.max(24,Math.floor(150))):e.time>2*e.duration?this.handleEmergencyDrop(.8,Math.max(24,Math.floor(210))):e.time>1.75*e.duration?this.handleEmergencyDrop(.9,Math.max(24,Math.floor(240))):this.dropCount=0;const t=this.profile.bwModifier(8*e.size)*this.emergencyModifier/e.time;this.rawKbps.push(8*e.size/e.time),e.time<2&&(e.time=2),e.size<2e3?this.count>0&&(this.count=Math.floor(0)):(this.count++,!Number.isNaN(t)&&this.count>0&&t<4e5&&(this.sampleBws.unshift(t),this.sampleBws.splice(300),this.currentKbps=this.calculateCurrentKbps()),this.shiftable&&this.shiftIfNecessary())}shiftIfNecessary(){var e,t,i,r,s,o,a,l,d,c,u,p;if(null==this.driver.currentLevel||n.device.isImplements(n.Feature.BROWSER_TYPE)&&"safari"===n.device.browserInfo.name)return;const{activeLayer:h}=this.driver,m=this.driver.data.encodings.filter(e=>{var t,i,r;return null==h||(null!==(t=e.videoKbps)&&void 0!==t?t:0)+(null!==(i=e.audioKbps)&&void 0!==i?i:0)<(null!==(r=h.bitrate)&&void 0!==r?r:0)+1e-4}),v=m[this.driver.currentLevel];let g=m[0],f=0;for(let i=0;i<m.length&&(null!==(e=m[i].videoKbps)&&void 0!==e?e:0)+(null!==(t=m[i].audioKbps)&&void 0!==t?t:0)<this.currentKbps;i++)g=m[i],f=i;if(this.switchImmediately)return this.switchBitrate(g),this.switchImmediately=!1,void this.logger.debug("meowpick first adaptive encoding",{suggestedEncoding:g});if(null!=v&&v.videoKbps!==g.videoKbps){if(g.kbps=(null!==(i=g.videoKbps)&&void 0!==i?i:0)+(null!==(r=g.audioKbps)&&void 0!==r?r:0),v.kbps=(null!==(s=v.videoKbps)&&void 0!==s?s:0)+(null!==(o=v.audioKbps)&&void 0!==o?o:0),g.kbps>v.kbps){for(;this.profile.resistUpshift(this.currentKbps,null!==(a=g.kbps)&&void 0!==a?a:0)&&(null!==(l=g.kbps)&&void 0!==l?l:0)>v.kbps;)if(g=m[--f],null==g||(null!==(d=g.kbps)&&void 0!==d?d:0)<v.kbps)return;this.emit("upshift")}else{for(;this.profile.resistDownshift(this.currentKbps,null!==(c=g.kbps)&&void 0!==c?c:0)&&(null!==(u=g.kbps)&&void 0!==u?u:0)<v.kbps;)if(g=m[++f],null==g||(null!==(p=g.kbps)&&void 0!==p?p:0)>v.kbps)return;this.emit("downshift")}v.videoKbps!==g.videoKbps&&(this.logger.debug("meow switching bitrate",{currentEncoding:v,suggestedEncoding:v,currentKbps:this.currentKbps}),this.lastSwitch=this.device.performance.now(),this.selectedEncoding=g,this.switchBitrate(g),this.totalShifts++)}}switchBitrate(e){this.emit("meow profile",{estimatedKbps:this.currentKbps,profile:this.profile}),this.driver.setEncoding(e)}calculateCurrentKbps(){let e=0;for(let t=0;t<this.sampleBws.length;t++)e+=this.sampleBws[t];return e/this.sampleBws.length}destroy(){var e;n.device.clearTimeout(this.spinTimeout),n.device.clearTimeout(this.releaseEmergencyTimeout),clearInterval(this.estimatedKbpsInterval),this.destroyed=!0,null===(e=this.player)||void 0===e||e.removeListener("fragment",this.onMessage)}}T.displayName="AbrController"},"./node_modules/@video/video-client-core/lib/internal/player/native-hls.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NativeHlsPlayer=void 0;const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),o=i("./node_modules/@video/video-client-core/lib/api/player/features/feature.js"),n=i("./node_modules/@video/video-client-core/lib/internal/errors-deprecated.js"),a=i("./node_modules/@video/video-client-core/lib/internal/utils/browser-support/browser.js"),l=i("./node_modules/@video/video-client-core/lib/internal/player/core.js");class d extends l.CorePlayer{constructor(e,t,i){super(e,t,i),this.srcReset=!1,this.manifestJson=null,this.on("currentQuality",this.handleCurrentQuality),this.addInnerDisposer(}tatic isSupported(e){return r.__awaiter(this,void 0,void 0,()}isSupported(){return r.__awaiter(this,void 0,void 0,(function*(){return d.isSupported()}))}static get format(){return"mp4-hls"}get format(){return d.format}handleSource(e){var t,i,o,a;return r.__awaiter(this,void 0,void 0,(function*(){if(this.suspended)return;this.ctx.logger.debug("native-hls: handleSource()");const r=null==e?void 0:e.formats["mp4-hls"];if(null!=r){if(null!=e&&(this.manifestJson=e),null!=(null===(i=null===(t=this.currentQuality)||void 0===t?void 0:t.layer)||void 0===i?void 0:i.id)&&""!==this.currentQuality.layer.id?this.source=this.currentQuality.layer.id.toString():null!=(null===(o=null==r?void 0:r.substitute)||void 0===o?void 0:o.location)?this.source=r.substitute.location:this.source=r.manifest,s.device.isImplements(s.Feature.URL_LOCATION)&&null!=this.elementSupervisor&&"src"!==this.elementSupervisor.sourceKind&&(this.srcReset=!0),null!=this.elementSupervisor&&"src"!==this.elementSupervisor.sourceKind||null!=this.elementSupervisor&&!this.srcReset){const e=this.elementSupervisor.currentTime;if(this.srcReset=!0,null===(a=this.elementSupervisor)||void 0===a||a.updateSrc(this.source),e>0&&(this.elementSupervisor.currentTime=e),this.options.autoPlay)try{yield this.play(!0)}catch(e){const t=e instanceof Error?e:null;this.emitErrorDeprecated(new n.PlayingIssueError("autoplay call failed after handleSource()",{inner:t,player:this}))}}}else this.emitErrorDeprecated(new n.DriverNotSupportedError("manifest doesn't contains 'mp4-hls' format",{manifest:e,loader:this.provider}))}))}attachTo(e){const t=Object.create(null,{attachTo:{get:});return r.__awaiter(this,void 0,void 0,(function*(){if(yield t.attachTo.call(this,e),this.options.autoPlay)try{yield this.play(!0)}catch(e){const t=e instanceof Error?e:null;this.emitErrorDeprecated(new n.PlayingIssueError("autoplay call failed after attachTo()",{inner:t,player:this}))}}))}t.NativeHlsPlayer=d,d.displayName="NativeHlsPlayer"},"./node_modules/@video/video-client-core/lib/internal/player/webrtc.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebrtcPlayer=void 0;const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/mobx/dist/mobx.esm.js"),o=i("./node_modules/@video/video-client-core/lib/api/index.js"),n=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),a=i("./node_modules/@video/video-client-core/lib/api/adapter/features/feature.js"),l=i("./node_modules/@video/video-client-core/lib/api/player/features/feature.js"),d=i("./node_modules/@video/video-client-core/lib/internal/errors.js"),c=i("./node_modules/@video/video-client-core/lib/internal/errors-deprecated.js"),u=i("./node_modules/@video/video-client-core/lib/internal/utils/bind.js"),p=i("./node_modules/@video/video-client-core/lib/internal/utils/browser-support/browser.js"),h=i("./node_modules/@video/video-client-core/lib/internal/utils/context/context.js"),m=i("./node_modules/@video/video-client-core/lib/internal/utils/events/event-emitter.js"),v=i("./node_modules/@video/video-client-core/lib/internal/utils/logger.js"),g=i("./node_modules/@video/video-client-core/lib/internal/utils/proxy/sync-handler.js"),f=i("./node_modules/@video/video-client-core/lib/internal/utils/stats/index.js"),b=i("./node_modules/@video/video-client-core/lib/internal/video-client.js"),_=i("./node_modules/@video/video-client-core/lib/internal/player/core.js"),y=i("./node_modules/@video/video-client-core/lib/internal/player/helper.js"),w=i("./node_modules/@video/video-client-core/lib/internal/player/mediasoup.js");class S extends m.ObservableEventEmitter{t canBroadcast(){return null!=this.call}get callBroadcast(){return this.call}t logger(){return this.ctx.logger}static isSupported(e){return r.__awaiter(this,void 0,void 0,()}tatic get format(){return"webrtc"}onstructor(e,t,i){super(!1),this.isConnecting=!1,this.isConnected=!1,this.call=null,this.manifestJson=null,this.videoEl=null,this.callStreamName=null,this.callId=null,this.isJoiningCall=!1,this.sfuConnectionLoadId=0,this.videoConsumerLoadId=0,this.firstTimeUpdateLoadId=0,this.joinCallEndpointLoadId=f.stats.start(f.STATS_EVENTS.JOIN_CALL_ENDPOINT),this.ctx=e,this.mediaLoader=t,this.options=i,this.autoPlay=null==i.autoPlay||i.autoPlay,(0,s.makeObservable)(this,{isConnected:s.observable,isConnecting:s.observable}),(0,h.onceCanceled)(e).then(e=>this.dispose("WebrtcPlayer Context Cancelled: "+e));const r=(0,u.makeBounded)(new Proxy(this,_.proxyHandler));return r.init(),e.logger.attachObject(r),e.logger.trace("constructor()",{}),r}init(){this.mediaLoader.on("source",this.handleSource),this.addInnerDisposer(,null!=this.mediaLoader.source&&this.handleSource(this.mediaLoader.source)}handleSource(e){return r.__awaiter(this,void 0,void 0,(function*(){if(!this.suspended)if(this.ctx.logger.debug("webrtc: handleSource()"),this.manifestJson=e,null==e)this.stopCall();else{const{webrtc:t}=e.formats;if(null==t)return void this.emitErrorDeprecated(new c.NotSupportedError("manifest doesn't contains webrtc format",{}));this.isJoiningCall&&this.callId===t.origin.callId&&this.callStreamName===t.origin.streamNames[0]||(this.isJoiningCall=!0,this.callId=t.origin.callId,this.callStreamName=t.origin.streamNames[0],this.stopCall(),yield this.joinCall(this.callId,t.origin.streamNames[0],t.origin.token,{rsrc:t.origin.rsrc,xkey:t.origin.publicKey,bpeerId:t.origin.peerId,joinUrl:t.origin.location}))}}))}stopCall(){var e;null!=this.call&&(null===(e=this.call)||void 0===e||e.removeAllListeners("playerAdded"),this.call=null)}get sfuJoinParams(){var e,t;const{webrtc:i}=null!==(t=null===(e=this.manifestJson)||void 0===e?void 0:e.formats)&&void 0!==t?t:{};return null==(null==i?void 0:i.origin.uri)?null:{call:{id:i.origin.callId,sfu:{uri:i.origin.uri,httpUri:i.origin.httpUri,region:i.origin.region,version:i.origin.version},turn:i.origin.turn,support:"ovh"},user:{userId:i.origin.token,scope:"viewer",displayName:"",authorizeToken:i.origin.token}}}joinCall(e,t,i,s){var n,a,l,c,u;return r.__awaiter(this,void 0,void 0,(function*(){const r={driver:this.format,abr:null===(n=this.manifestJson)||void 0===n?void 0:n.abr,aor:null===(a=this.manifestJson)||void 0===a?void 0:a.aor,atr:null===(l=this.manifestJson)||void 0===l?void 0:l.atr,rep:null===(c=this.manifestJson)||void 0===c?void 0:c.rep},p={token:i,onCallJoinEndpoint:()=>{this.emit("joinCallEndpoint",f.stats.stop(this.joinCallEndpointLoadId,r)),this.sfuConnectionLoadId=f.stats.start(f.STATS_EVENTS.SFU_CONNECTION)},onSFUConnection:()=>{this.emit("sfuConnection",f.stats.stop(this.sfuConnectionLoadId,r)),this.videoConsumerLoadId=f.stats.start(f.STATS_EVENTS.VIDEO_CONSUMER)},playerOptions:this.options};try{this.call=yield this.ctx.videoClient.internalJoinCall(e,Object.assign(Object.assign({},s),p),(0,v.extendContext)(this.ctx,b.VideoClient),this.sfuJoinParams),this.emit("joinedCall",{call:this.call}),this.call.once("videoConsumer",()=>{this.emit("videoConsumer",f.stats.stop(this.videoConsumerLoadId,r)),this.firstTimeUpdateLoadId=f.stats.start(f.STATS_EVENTS.FIRST_TIME_UPDATE)}),this.call.on("playerAdded",e=>{this.ctx.logger.debug("got a player",{ev:e}),t===e.streamName&&(this.ctx.logger.debug("set currentPlayer",{old:this.currentPlayer}),e.player instanceof w.MediasoupPlayer&&(e.player.isManifestPlayer=!0),this.currentPlayer=e.player,this.currentPlayer.once("videoFirstPlay",()=>{this.emit("firstTimeUpdate",f.stats.stop(this.firstTimeUpdateLoadId,r))}))}),this.call.on("webrtcStats",e=>{this.emit("webrtcStats",e)}),this.call.on("peerAtCapacity",,this.call.on("isConnected",e=>{this.isConnected=e}),this.call.on("isConnecting",,this.call.on("playerRemoved",e=>{var i;t===e.streamName&&(null===(i=this.currentPlayer)||void 0===i||i.dispose("peer player removed due to call.on('playerRemoved') event"))}),this.call.on("websocketReconnect",,this.call.on("error",}catch(e){this.emit("error",null!==(u=(0,d.wrapError)(e))&&void 0!==u?u:(0,d.createError)(o.ErrorCode.CallError,"unknown error",{}))}}))}updatePosterWithLatestFrame(){null!=this.hostEl&&n.device.isImplements(a.Feature.CREATE_SCREENSHOT)?this.poster=n.device.createScreenshot(this.hostEl):this.ctx.logger.warn("Unable to set update poster. Create screenshot is not compatible with device.")}t.WebrtcPlayer=S,S.displayName="WebrtcPlayer"},"./node_modules/@video/video-client-core/lib/internal/pvc/call/call.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Call=void 0;const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/@video/events-typed/index.js"),o=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/index.js"),n=r.__importDefault(i("./node_modules/@video/video-client-core/node_modules/qs/lib/index.js")),a=i("./node_modules/@video/video-client-core/lib/api/index.js"),l=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),d=i("./node_modules/@video/video-client-core/lib/internal/errors.js"),c=i("./node_modules/@video/video-client-core/lib/internal/errors-deprecated.js"),u=i("./node_modules/@video/video-client-core/lib/internal/utils/context/context.js"),p=i("./node_modules/@video/video-client-core/lib/internal/utils/logger.js"),h=r.__importDefault(i("./node_modules/@video/video-client-core/lib/internal/utils/request/request.js")),m=i("./node_modules/@video/video-client-core/lib/internal/pvc/call/common.js"),v=i("./node_modules/@video/video-client-core/lib/internal/pvc/call/messageList.js"),g=i("./node_modules/@video/video-client-core/lib/internal/pvc/call/peer.js"),f=r.__importDefault(i("./node_modules/@video/video-client-core/lib/internal/pvc/call/stream.js")),b=r.__importDefault(i("./node_modules/@video/video-client-core/lib/internal/pvc/call/transport.js")),_=r.__importDefault(i("./node_modules/@video/video-client-core/lib/internal/utils/auth/auth-core.js")),y=i("./node_modules/@video/video-client-core/lib/utils/common.js");class w extends s.EventEmitter{get peer(){return this._peer}get _iceServers(){return this.__iceServers}get _edgeIceServers(){return this.__edgeIceServers}get _iceTransportPolicy(){return this.__iceTransportPolicy}get maxBitrate(){return this._maxBitrate}get _requireRecv(){return this.__requireRecv}get _requireSend(){return this.__requireSend}get _wsTransport(){return this.__wsTransport}get _closed(){return this.__closed}get streams(){return this._streams}get permissions(){return this._permissions}get peerId(){return this._localPeerId}erShould(e){return!!this.hasPermission(e)&&this._behaviours.includes(e)}constructor(e,t,i,r={}){var s,o,n,a,d,c;super(),this.setPreferredEncodingProcessing=!1,this.__wsTransport=null,this._startPromise=null,this._iceTransportPolicyUsed=null,this.isDisposed=!1,this.ctx=e,(0,u.onceCanceled)(e).then(e=>this.dispose("VideoClient Context Cancelled: "+e)),e.logger.trace("constructor()",{options:r});const{maxProducingViewers:p,stats:h}=r;if(this.options={call:{maxProducingViewers:p,stats:h}},this._maxBitrate=r.maxBitrate,this._messages=new v.MessageList,this._handleOffline=()=>{this.emit("CALL_EMIT_MESSAGES",{messages:v.offlineMessages.messages})},this._handleOnline=l.device.addEventListener("offline",this._handleOffline),l.device.addEventListener("online",this._handleOnline),null==t.call)throw new Error("json.call is undefined");this.call=t.call,this._userOverrides=r.user,this.user=Object.assign(Object.assign({},t.user),this._userOverrides),this._stunServers=null!==(n=null===(o=null===(s=this.call.stun)||void 0===s?void 0:s.servers)||void 0===o?void 0:o.map()&&void 0!==n?n:[],this._stunIndex=5,this.__iceServers=()=>{var e,t,i,r;if(0===this._stunIndex||0===this._stunServers.length)return(null===(t=null===(e=this.call.turn)||void 0===e?void 0:e.servers)||void 0===t?void 0:t.length)>0?this.call.turn.servers:[];const s=[{urls:this._stunServers.slice(this._stunIndex-5,this._stunIndex)}];return(null===(r=null===(i=this.call.turn)||void 0===i?void 0:i.servers)||void 0===r?void 0:r.length)>0?this.call.turn.servers.concat(s):s},this.__edgeIceServers=()=>{var e,t;const i=[];return(null===(t=null===(e=this.call.turn)||void 0===e?void 0:e.servers)||void 0===t?void 0:t.length)>0&&this.call.turn.servers.forEach(e=>{if(Array.isArray(e.urls)){const t=e.urls.filter(;(null==t?void 0:t.length)>0&&i.push(Object.assign(Object.assign({},e),{urls:t.map(e=>{var t;return null!==(t=e.split("?")[0])&&void 0!==t?t:""})}))}}),i},this._joinCall=i,this._localPeerId=null,this.__iceTransportPolicy=r.iceTransportPolicy,this.__requireRecv=!0===r.requireRecv,this.__requireSend=!0===r.requireSend,this._flushLogs=!r.test,this._retries=null!==(a=r.retries)&&void 0!==a?a:1/0,this._wsReconnect=null!==(d=r.wsReconnect)&&void 0!==d&&d,this._wsReconnectTime=null!==(c=r.wsReconnectTime)&&void 0!==c?c:10,this._iceTransportPolicyUsed=null,this._ip=null,this._permissions=[],this._behaviours=[],this._initialRun=!0,this.__closed=!1,this._startResolve=null,this._startPromise=null,this._serverOptions=null,this._stableTimeout=void 0,this._stable=null,this._streams={};const{streams:m}=r;null!=m&&Object.keys(m).length>0?Object.keys(m).forEach(:this.ctx.logger.debug("Setting stream failed, there are no defined streams",{streams:m}),this.setLogData()}dispose(e){this.close("disposed: "+e),this.isDisposed=!0}tStream(e,t){this._streams[e]=new f.default((0,p.extendContext)(this.ctx,f.default),e,this,t)}rEachStream(e){null!=this._streams&&Object.keys(this._streams).length>0?Object.keys(this._streams).forEach(:this.ctx.logger.debug("Stream close() failed, there are no defined streams to close",{streams:this._streams})}*streamsIterator(){for(const e of Object.keys(this._streams))yield this._streams[e]}setLogData(){var e,t,i,r,s,o;this.ctx.logger.setMessageAggregate("callId",this.call.id),this.ctx.logger.setMessageAggregate("userId",null!==(t=null===(e=this.user)||void 0===e?void 0:e.userId)&&void 0!==t?t:"no user id"),this.ctx.logger.setMessageAggregate("scope",null!==(r=null===(i=this.user)||void 0===i?void 0:i.scope)&&void 0!==r?r:"no scope"),this.ctx.logger.setMessageAggregate("displayName",null!==(o=null===(s=this.user)||void 0===s?void 0:s.displayName)&&void 0!==o?o:"no display name")}clearLogData(){this.ctx.logger.removeMessageAggregate("callId"),this.ctx.logger.removeMessageAggregate("peerId"),this.ctx.logger.removeMessageAggregate("userId"),this.ctx.logger.removeMessageAggregate("scope"),this.ctx.logger.removeMessageAggregate("displayName"),this.ctx.logger.removeMessageAggregate("recvTransportId"),this.ctx.logger.removeMessageAggregate("recvTransportState"),this.ctx.logger.removeMessageAggregate("sendTransportId"),this.ctx.logger.removeMessageAggregate("sendTransportState")}_addMessage(e){this._messages.addMessage(e),this.emit("CALL_EMIT_MESSAGES",{messages:v.offlineMessages.messages})}_removeMessage(e){this._messages.removeMessage(e),this.emit("CALL_EMIT_MESSAGES",{messages:v.offlineMessages.messages})}lose(e="Implementer did not pass debugString",t=!1,i=!1){return r.__awaiter(this,void 0,void 0,(function*(){return this.__closed?null:(this.ctx.logger.info("Call Class, call closed()",{aggregates:{internal:t,reason:e}}),this._flushLogs&&this.ctx.logger.flush(),null!=this._peer&&(yield this._peer.close(e)),null!=this.__wsTransport&&this.__wsTransport.setClosing(),l.device.removeEventListener("offline",this._handleOffline),l.device.removeEventListener("online",this._handleOnline),this.__closed=!0,this.forEachStream(,l.device.clearTimeout(this._stableTimeout),this._stable=null,this._cleanup(i),Promise.resolve())}))}_cleanup(e=!1){e||null==this._startResolve||this._startResolve(),null!=this.__wsTransport&&(this.__wsTransport.close(),this.__wsTransport=null),this.emit("CALL_SET_ROOM_DONE"),this.clearLogData()}updateMaxBitrate(e){return r.__awaiter(this,void 0,void 0,(function*(){if(null!=this.__wsTransport){const t={bitrate:e};try{yield this._request("updateMaxBitrate",t),this._maxBitrate=e}catch(e){const i=e instanceof Error?e:null;this.emit("error",new c.WSRequestError("ws request error",{inner:i,request:"updateMaxBitrate",args:t,internalCall:this}))}}}))}setDisplayName(e){this.ctx.logger.info("updating displayName",{displayName:e}),null!=this.user&&(this.user.displayName=e),null!=this.__wsTransport&&this.__wsTransport.send("options",{peer:{displayName:e}})}setMaxProducingViewers(e){this.ctx.logger.info("updating maxProducingViewers",{maxProducingViewers:e}),null!=this.__wsTransport&&this.__wsTransport.send("options",{call:{maxProducingViewers:e}})}romoteViewer(e,t,i=!1){var s;return r.__awaiter(this,void 0,void 0,(function*(){if(null==this.__wsTransport)throw this.ctx.logger.warn("calling get viewers on a disconnected call"),new Error("call not connected");if(!this.hasPermission(m.PERMISSIONS.CHANGE_PEER_SCOPE))throw this.ctx.logger.warn("viewer does not have permission to promote other viewers"),new Error("no admin change scope permissions");let r;const o={userId:e,permissions:t,webhook:i};try{r=yield this._request("promote",o)}catch(e){const t=e instanceof Error?e:null;return void this.emit("error",new c.WSRequestError("ws request error",{inner:t,request:"promote",args:o,internalCall:this}))}this.emit("CALL_VIEWERS",{viewers:null!==(s=r.viewers)&&void 0!==s?s:[]})}))}demoteViewer(e,t,i=!1){var s;return r.__awaiter(this,void 0,void 0,(function*(){if(null==this.__wsTransport)throw this.ctx.logger.warn("calling get viewers on a disconnected call"),new Error("call not connected");if(!this.hasPermission(m.PERMISSIONS.CHANGE_PEER_SCOPE))throw this.ctx.logger.warn("viewer does not have permission to demote other viewers"),new Error("no admin change scope permissions");let r;const o={userId:e,webhook:i,permissions:t};try{r=yield this._request("demote",o)}catch(e){const t=e instanceof Error?e:null;return void this.emit("error",new c.WSRequestError("ws request error",{inner:t,request:"demote",args:o,internalCall:this}))}this.emit("CALL_VIEWERS",{viewers:null!==(s=r.viewers)&&void 0!==s?s:[]})}))}kickViewer(e,t,i=!1){var s;return r.__awaiter(this,void 0,void 0,(function*(){if(null==this.__wsTransport)throw this.ctx.logger.warn("calling get viewers on a disconnected call"),new Error("call not connected");if(!this.hasPermission(m.PERMISSIONS.CHANGE_PEER_SCOPE))throw this.ctx.logger.warn("viewer does not have permission to kick other viewers"),new Error("no admin change scope permissions");let t;const i={userId:e};try{t=yield this._request("kick",i)}catch(e){const t=e instanceof Error?e:null;return void this.emit("error",new c.WSRequestError("ws request error",{inner:t,request:"kick",args:i,internalCall:this}))}this.emit("CALL_VIEWERS",{viewers:null!==(s=t.viewers)&&void 0!==s?s:[]})}))}kickPeer(e,t,i=!1){var s;return r.__awaiter(this,void 0,void 0,(function*(){if(null==this.__wsTransport)throw this.ctx.logger.warn("calling get peers on a disconnected call"),new Error("call not connected");if(!this.hasPermission(m.PERMISSIONS.CHANGE_PEER_SCOPE))throw this.ctx.logger.warn("viewer does not have permission to kick other peers"),new Error("no admin change scope permissions");let t;const i={peerId:e};try{t=yield this._request("kick",i)}catch(e){const t=e instanceof Error?e:null;return void this.emit("error",new c.WSRequestError("ws request error",{inner:t,request:"kick",args:i,internalCall:this}))}this.emit("CALL_VIEWERS",{viewers:null!==(s=t.viewers)&&void 0!==s?s:[]})}))}connect(){var e,t;return r.__awaiter(this,void 0,void 0,(function*(){if(this.emit("CALL_CONNECTING",!0),this.__wsTransport){try{this.__wsTransport.close(!0)}catch(e){this.ctx.logger.info("Error closing websocket transport",{error:e})}this.__wsTransport=null}return null===(e=this._peer)||void 0===e||e.peers.forEach(,yield null===(t=this._peer)||void 0===t?void 0:t.dispose("Reconnecting"),this._peer=void 0,new Promise((e,t)=>{if(null==this.call.callUri)return t(new Error("callUri is undefined")),void this.emit("CALL_CONNECTING",!1);this.__wsTransport=new b.default((0,p.extendContext)(this.ctx,b.default),this.call.callUri,this._joinCall,this._retries,this._wsReconnect,this._wsReconnectTime),this.__wsTransport.on("websocket-reconnect",e=>{(this._wsReconnect||e)&&(this.ctx.logger.info("Attempting websocket reconnect"),this.emit("CALL_WEBSOCKET_RECONNECT"))}),this.__wsTransport.on("prepare-rejoin-call",()=>{for(const e of this.streamsIterator())e.close(!1)}),this.__wsTransport.on("callEnded",()=>{this.close("call already ended on websocket",!0).catch(this.ctx.logger.error),e(),this.ctx.logger.info("calls-core/call: end")}),this.__wsTransport.on("callError",e=>{var i,r;t(new c.CallError(null!==(i=e.errorMessage)&&void 0!==i?i:"Unknown call error",{reason:e.reason})),"sfu-busy"===e.reason&&this.emit("error",(0,d.createError)(a.ErrorCode.SFUBusy,null!==(r=e.errorMessage)&&void 0!==r?r:"unknown reason",{})),this.close("call error on websocket",!0,!0).catch(this.ctx.logger.error)}),this._setup(e,t),this.__wsTransport.once("connect",()=>{this.emit("CALL_CONNECTING",!1),this.emit("CALL_SET_CONNECTED",{connected:!0})})})}))}start(){return this.ctx.logger.info("calls-core/call: start",{}),null!=this._startPromise?(this.ctx.logger.info("call: start has already been called"),this._startPromise):(this._startPromise=new Promise((e,t)=>{this.ctx.support.any?(this._startResolve=e,this._initialRun||(this.emit("CALL_SET_CONNECTED",{connected:!1}),this.emit("CALL_EMIT_MESSAGES",{messages:v.disconnectedMessages.messages})),null!=this.call.callUri?this.connect().then(()=>{var e;this._messages=new v.MessageList,this.emit("CALL_EMIT_MESSAGES",{messages:null!==(e=this._messages.messages)&&void 0!==e?e:[]}),this._initialRun=!1}).catch(t):t(new Error("Call URI is undefined"))):t(new Error("Device is not supported"))}),this._startPromise)}_setup(e,t){if(this.ctx.logger.debug("call setup"),null==this.__wsTransport){const e=new Error("_wsTransport is null");throw this.ctx.logger.warn("call _setup",{err:null==e?void 0:e.message}),e}this.__wsTransport.on("disconnect",,this.__wsTransport.on("need-user",,this.__wsTransport.on("join-refresh",e=>{null!=e.body.call?(this.user=Object.assign(Object.assign({},e.body.user),this._userOverrides),this.call=e.body.call):this.ctx.logger.error("response.body.call is undefined")}),this.__wsTransport.on("join-call-error",e=>{const i=e.error instanceof Error?e.error:null,r=new c.JoinCallError("WS: Join Call Error",{inner:i});this.emit("error",r),t(r)}),this.__wsTransport.on("call-rejected",()=>{this.ctx.logger.info("call rejected");const e=new c.CallError("WS: Call Rejected",{reason:"rejected"});this.emit("error",e),t(e),this.close("call was rejected by websocket",!0).catch(this.ctx.logger.error)}),this.__wsTransport.on("callRejected",()=>{this.ctx.logger.info("call rejected");const e=new c.CallError("WS: Call Rejected",{reason:"rejected"});t(e),this.close("call was rejected by websocket",!0)}),this.__wsTransport.on("call-ended",()=>{this.ctx.logger.info("call ended"),this.close("call already ended on websocket",!0)}),this.__wsTransport.on("Forbidden",()=>{this.ctx.logger.info("call ended - kicked"),this.emit("CALL_FORBIDDEN"),this.close("call ended - kicked (Forbidden)",!0)}),this.__wsTransport.on("call-refresh",e=>{this.call=e}),this.__wsTransport.on("peerAtCapacity",e=>{const t=Object.keys(e);this.emit("CALL_PEER_AT_CAPACITY",e[t[0]])}),this.__wsTransport.on("producersKicked",,this.__wsTransport.on("dominantSpeaker",e=>{this.ctx.logger.debug("websocket transport dominantSpeaker",{dominantSpeaker:e}),this.emit("CALL_DOMINANT_SPEAKER",{userId:e.userId,displayName:e.displayName,peerId:e.peerId,streamName:e.streamName,producerId:e.producerId})});const i=e=>{var t,i,r,s,o,n,a,l,d;null!=this._stable&&"video"===e.mediaType&&(null!==(r=null===(i=null===(t=this._serverOptions)||void 0===t?void 0:t.call)||void 0===i?void 0:i.defaultMinBitrate)&&void 0!==r?r:0)>0&&((null!==(s=e.consumerBitrate)&&void 0!==s?s:0)<(null!==(a=null===(n=null===(o=this._serverOptions)||void 0===o?void 0:o.call)||void 0===n?void 0:n.defaultMinBitrate)&&void 0!==a?a:0)?0===this._stable.consumerBitrate?this._stable.consumerBitrate=Date.now():Date.now()>(null!==(d=null===(l=this._stable)||void 0===l?void 0:l.consumerBitrate)&&void 0!==d?d:0)+1e3&&this._addMessage(v.TROUBLESHOOTING.UNSTABLE_NETWORK):delete this._stable.consumerBitrate)};this.__wsTransport.on("consumer-stats",e=>{i(e),this.emit("CALL_SET_CONSUMER_STATS",{peerId:e.peerId,streamName:e.streamName,consumerId:e.id,stats:e})}),this.__wsTransport.on("producer-stats",e=>{i(e),this.emit("CALL_SET_PRODUCER_STATS",{streamName:e.streamName,producerId:e.id,stats:e})}),this.__wsTransport.on("permissions",e=>{this._permissions=e.permissions,this.emit("CALL_PERMISSIONS",{permissions:e.permissions})}),this.__wsTransport.on("options",e=>{this.ctx.logger.debug("websocket transport options",{options:e}),this._serverOptions=e,this.emit("CALL_OPTIONS",{options:e})}),this.__wsTransport.on("ready",e=>{var i,r,s,o,n,a;if(this.emit("CALL_SFU_CONNECTION"),this.__closed&&null!=this.__wsTransport)return this.ctx.logger.debug("call: ready event fired after call was closed"),void this.__wsTransport.close();this.ctx.logger.info("websocket transport ready",{readyData:e}),this._ip=e.ip,this._localPeerId=e.peerId,this.ctx.logger.setMessageAggregate("peerId",this._localPeerId),(null===(i=e.permissions)||void 0===i?void 0:i.length)>0&&(this._permissions=e.permissions,this.emit("CALL_PERMISSIONS",{permissions:e.permissions})),(null===(r=e.behaviours)||void 0===r?void 0:r.length)>0&&(this._behaviours=e.behaviours),"v3"===e.version&&null!=this.user&&(this.user.scope=e.scope,null!=e.userId&&(this.user.userId=e.userId),null!=e.displayName&&(this.user.displayName=e.displayName),this.clearLogData(),this.setLogData()),this.emit("CALL_ROOM_DATA",{scope:null!==(o=null===(s=this.user)||void 0===s?void 0:s.scope)&&void 0!==o?o:"",peerId:e.peerId});const l=this._closed||(null===(n=this._peer)||void 0===n?void 0:n._closed);this._request("options",this.options).catch(e=>{var t;const i=this._closed||(null===(t=this._peer)||void 0===t?void 0:t._closed);if(!(!l&&i)){const t=e instanceof Error?e:null;this.emit("error",new c.WSRequestError("ws request error",{inner:t,request:"options",args:this.options,internalCall:this}))}}),null===(a=this._peer)||void 0===a||a.dispose("Create a new peer after ws reconnection"),this._peer=new g.Peer((0,p.extendContext)(this.ctx,g.Peer),this),this._peer.statsCollector.on("webrtc-stats",e=>{this.emit("webrtc-stats",e)}),this._peer.statsCollector.on("webrtc-stats-raw",e=>{this.emit("webrtc-stats-raw",e)}),this._peer.on("error",e=>{e.critical?(this.ctx.logger.error(`Peer error: ${e.code}; ${e.message}`,{err:e,call:this}),this.close("peer error",!0),t(e)):this.ctx.logger.warn(`Peer error: ${e.code}; ${e.message}`,{err:e,call:this})}),this._peer._setup(e.rtpCapabilities).then(()=>{this.ctx.logger.debug("websocket ready",{rtpCapabilities:e.rtpCapabilities}),this.emit("CALL_READY")})})}createProducer(e,t,i){var s,n;return r.__awaiter(this,void 0,void 0,(function*(){if(null==this._peer){const e="creating a producer on a room which has not been set up";throw this.ctx.logger.warn(e),new Error(e)}const r=this._closed||(null===(s=this._peer)||void 0===s?void 0:s._closed);try{return yield this._peer.produce(e,t,i)}catch(e){const t=this._closed||(null===(n=this._peer)||void 0===n?void 0:n._closed);throw!r&&t||(e instanceof o.types.InvalidStateError&&"track ended"===e.message?this.ctx.logger.warn("createProducer: track ended"):this.ctx.logger.error(new c.MediasoupSetupError("createProducer: error creating producer",{inner:(0,c.wrapNativeError)(e)}))),e}}))}get _localSettings(){if(!l.device.isImplements(l.Feature.LOCAL_STORAGE))return{};const e=l.device.localStorage.getItem(`pvc:${this._ip}:settings`);if(null==e)return{};let t;try{t=JSON.parse(e)}catch(t){const i=t instanceof Error?t.message:"unknown error";return this.ctx.logger.error("unable to parse settings",{data:e,err:i}),{}}return t}set _localSettings(e){l.device.isImplements(l.Feature.LOCAL_STORAGE)&&"false"!==l.device.localStorage.getItem("debug")&&l.device.localStorage.setItem(`pvc:${this._ip}:settings`,JSON.stringify(e))}_request(e,t){return r.__awaiter(this,void 0,void 0,(function*(){if(null==this.__wsTransport){const e=new Error("_wsTransport is null");throw this.ctx.logger.warn("call _request",{err:null==e?void 0:e.message}),e}const i=yield this.__wsTransport.request(e,t);if(null==i){const e=new Error("response is null");throw this.ctx.logger.warn("call _request",{err:null==e?void 0:e.message}),e}return i}))}requestSources(e,t){return r.__awaiter(this,void 0,void 0,(function*(){const i={streamName:e,peerId:t};return this._request("consumerSources",i).catch(e=>{const t=e instanceof Error?e:null;return e instanceof Error&&"request error: peer-closed"!==e.message&&this.emit("error",new c.WSRequestError("ws request error",{inner:t,request:"consumerSources",args:i,internalCall:this})),e})}))}setPreferredEncoding(e,t){var i;if(!(null===(i=this.peer)||void 0===i?void 0:i.hasConsumerId(e)))return void this.emit("error",new c.ConsumerNotFoundError("consumer not found for consumer event",{consumerId:e}));if(this.setPreferredEncodingProcessing)return void this.ctx.logger.warn("setPreferredEncoding already processing",{consumerId:e,id:t});const r={consumerId:e,id:t};this.setPreferredEncodingProcessing=!0,this._request("setPreferredEncoding",r).catch(t=>{var i;const s=t instanceof Error?t:null;if(!this._consumerNotFoundError(e,s))return this.emit("error",new c.WSRequestError("ws request error",{inner:s,request:"setPreferredEncoding",args:r,internalCall:this})),t;(null===(i=this.peer)||void 0===i?void 0:i.hasConsumerId(e))&&this.ctx.logger.warn("consumer does not exist on server, but still exists in videoclient",{err:null==t?void 0:t.message,consumerId:e})}).finally(()=>{this.setPreferredEncodingProcessing=!1})}_consumerNotFoundError(e,t){return null!=t&&"request error: consumer not found"===(null==t?void 0:t.message)}setVideoStreamProvider(e,t,i,s,o=!1){return r.__awaiter(this,void 0,void 0,(function*(){if(null==this._streams[e]){const e="setVideoStreamRetriever on invalid stream";throw this.ctx.logger.error(e),new Error(e)}return this._streams[e].setVideoStreamProvider(t,i,s,o)}))}setAudioStreamProvider(e,t,i,s,o=!1){return r.__awaiter(this,void 0,void 0,(function*(){if(null==this._streams[e]){const e="setAudioStreamRetriever on invalid stream";throw this.ctx.logger.error(e),new Error(e)}return this._streams[e].setAudioStreamProvider(t,i,s,o)}))}muteAudio(e){if(null==this._streams[e]){const t="muteAudio on invalid stream";throw this.ctx.logger.error(t,{streamName:e}),new Error(t)}this._streams[e].pauseAudio()}unmuteAudio(e,t={}){return r.__awaiter(this,void 0,void 0,(function*(){if(null==this._streams[e]){const t="unmuteAudio on invalid stream";throw this.ctx.logger.error(t,{streamName:e}),new Error(t)}return this._streams[e].enableAudio(t,!1)}))}disableAudio(e){if(null==this._streams[e]){const t="disableAudio on invalid stream";throw this.ctx.logger.error(t,{streamName:e}),new Error(t)}this._streams[e].disableAudio()}enableAudio(e={},t,i,s=!1){return r.__awaiter(this,void 0,void 0,(function*(){if(this.ctx.logger.debug("enable audio",{streamName:t,refresh:i}),null==this._streams[t]){const e="enableAudio on invalid stream";throw this.ctx.logger.error(e,{streamName:t}),new Error(e)}return this._streams[t].enableAudio(e,i,s)}))}enableVideo(e={},t,i,s=!1){return r.__awaiter(this,void 0,void 0,(function*(){if(!e.audioOnly){if(this.ctx.logger.debug("enable video",{streamName:t,refresh:i}),null==this._streams[t]){const e="enableVideo on invalid stream";throw this.ctx.logger.error(e,{streamName:t}),new Error(e)}return this._streams[t].enableVideo(e,i,s)}this.ctx.logger.debug("enable video",{streamName:t,refresh:i})}))}disableVideo(e){if(null==this._streams[e]){const t="disableVideo on invalid stream";throw this.ctx.logger.error(t,{streamName:e}),new Error(t)}this._streams[e].disableVideo()}unpauseVideo(e,t={}){return r.__awaiter(this,void 0,void 0,(function*(){if(null==this._streams[e]){const t="unpauseVideo on invalid stream";throw this.ctx.logger.error(t,{streamName:e}),new Error(t)}return this._streams[e].enableVideo(t,!1)}))}pauseVideo(e){if(this.ctx.logger.debug("calls-core/call: pause video"),null==this._streams[e]){const t="pauseVideo on invalid stream";throw this.ctx.logger.error(t,{streamName:e}),new Error(t)}return this._streams[e].pauseVideo()}_pauseProducer(e,t){if(null==this.__wsTransport){const e=new Error("_wsTransport is null");throw this.ctx.logger.warn("call _pauseProducer",{err:null==e?void 0:e.message}),e}this.__wsTransport.request("pauseProducer",{producerId:e}).catch(e=>{this.ctx.logger.warn("call.pauseProducer: error pausing server producer",e)}),this.emit("CALL_SET_PRODUCER_PAUSED",{streamName:t,producerId:e,originator:"client"})}_resumeProducer(e,t){if(null==this.__wsTransport){const e=new Error("_wsTransport is null");throw this.ctx.logger.warn("call _pauseProducer",{err:null==e?void 0:e.message}),e}this.__wsTransport.request("resumeProducer",{producerId:e}).catch(,this.emit("CALL_SET_PRODUCER_RESUMED",{streamName:t,producerId:e,originator:"client"})}_closeProducer(e,t){null!=this.__wsTransport?(this.__wsTransport.request("closeProducer",{producerId:e}).catch(t=>{this.ctx.logger.warn("call.closeProducer: error closing server producer",{err:""+t,producerId:e})}),this.emit("CALL_REMOVE_PRODUCER",{streamName:t,producerId:e,originator:"client"})):this.ctx.logger.debug("_closeProducer was called when websocket was closed")}hotswapProducer(e,t,i){return r.__awaiter(this,void 0,void 0,(function*(){if(this.ctx.logger.debug("calls-core/call: hotswwap producer"),null==this._streams[t]){const e="hotswapProducer on invalid stream";throw this.ctx.logger.error(e,{streamName:t}),new Error(e)}yield this._streams[t].hotswapProducer(e,i)}))}toJSON(){var e,t,i;return{streamNames:this.streamNames,peer:this._peer,aggregates:{support:this.ctx.support.hash,url:this.call.callUri,callId:this.call.id,userId:null!==(t=null===(e=this.user)||void 0===e?void 0:e.userId)&&void 0!==t?t:"",peerId:this.peerId,isConnected:null===(i=this._wsTransport)||void 0===i?void 0:i.connected}}}}t.Call=w,w.displayName="PvcCall";const S=(e,t,i,r)=>{const s={support:e.support.hash};return!!l.device.isImplements(l.Feature.LOCAL_STORAGE)&&"true"===l.device.localStorage.getItem("pvc:debug")&&(s.debug=!0),"string"==typeof i&&i.length>0&&(s.t=i),r.test&&(s.t="test"),null!=r.clientName&&(s.client_name=r.clientName),null!=r.displayName&&(s.displayName=r.displayName),null!=r.clientVersion&&(s.client_version=r.clientVersion),!1===r.sendAudio&&!1!==r.sendVideo?s.videoOnly=!0:!1!==r.sendAudio&&!1===r.sendVideo&&(s.audioOnly=!0),null!=r.rsrc&&(s.rsrc=r.rsrc),null!=r.xkey&&(s.xkey=r.xkey),null!=r.bpeerId&&(s.bpeerId=r.bpeerId),r.suspendPlay&&(s.sp=!0),null!=r.user&&(s.udata=!0),`${t.sfu.uri}/v3/${t.id}?${n.default.stringify(s)}`};t.default=(e,t,i,s,o,n=null)=>r.__awaiter(void 0,void 0,void 0,(function*(){var a,l,d,c,u,m,v,g;e.logger.debug("joining call",{id:t,options:s});const f=Object.assign({},s),b={method:"post",callId:t,failoverUrls:s.failoverUrls};null!=f.auth&&(b.auth=f.auth),null!=f.authOptions&&(b.auth=new _.default(f.authOptions)),null==f.clientName&&(f.clientName=""),null==f.clientVersion&&(f.clientVersion=""),b.query={};const E=(0,y.contextId)();null!=E&&(b.query.contextId=E);const C=(0,y.instanceId)();null!=C&&(b.query.instanceId=C),null!=(null===(a=f.sfu)||void 0===a?void 0:a.id)&&(b.query.id=null===(l=f.sfu)||void 0===l?void 0:l.id),null!=(null===(d=f.sfu)||void 0===d?void 0:d.region)&&(b.query.region=null===(c=f.sfu)||void 0===c?void 0:c.region),null!=(null===(u=f.sfu)||void 0===u?void 0:u.version)&&(b.query.version=null===(m=f.sfu)||void 0===m?void 0:m.version),null!=(null===(v=f.sfu)||void 0===v?void 0:v.pool)&&(b.query.pool=null===(g=f.sfu)||void 0===g?void 0:g.pool);const j={sfu:{msVersion:[3]}};null!=f.sfu&&(j.sfu=Object.assign(Object.assign({},f.sfu),{msVersion:[3]})),b.body=JSON.stringify(j);const P=(s={})=>r.__awaiter(void 0,void 0,void 0,(function*(){var r;e.logger.debug("calls-core/call:joinCall");try{const t=yield(0,h.default)(e,i,Object.assign(Object.assign(Object.assign({},b),s),{warnStatuses:[404,422]}));if(null==(null===(r=null==t?void 0:t.body)||void 0===r?void 0:r.call))throw new Error("response is null or incorrect");return t.body.call.callUri=S(e,t.body.call,t.authToken,f),e.logger.debug("joinCall() response",{response:t}),o.emit("callJoinEndpoint"),t}catch(r){const s=r instanceof Error?r.message:"unknown error";throw r instanceof Response?404===r.status?e.logger.warn("sfu unavailable",{id:t,joinUrl:i,err:s}):503===r.status&&e.logger.error("unable to join a call - no sfus available",{id:t,joinUrl:i,err:s}):e.logger.warn("unable to get sfu uri",{id:t,joinUrl:i,err:s}),r}}));let R;return null!=(null==n?void 0:n.call)?(n.call.callUri=S(e,n.call,n.user.authorizeToken,f),R=n):R=(yield P()).body,new w((0,p.extendContext)(e,w),R,P,f)}))},"./node_modules/@video/video-client-core/lib/internal/pvc/call/common.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CUSTOM_STREAM_TYPE=t.PERMISSIONS=void 0,t.PERMISSIONS={STREAM_VIDEO:"produceVideo",STREAM_AUDIO:"produceAudio",CHANGE_PEER_SCOPE:"changePeerScope"},t.CUSTOM_STREAM_TYPE="custom"},"./node_modules/@video/video-client-core/lib/internal/pvc/call/device.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendedDevice=void 0;const r=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/index.js");class s extends r.types.Device{constructor(e,t={}){super(t),this.device=e,this.directionContext=null,this.originalRtpCapabilities=Reflect.get(this,"_extendedRtpCapabilities"),this.originalCreateTransport=Reflect.get(this,"createTransport"),Reflect.defineProperty(this,"_extendedRtpCapabilities",{get:this.getterRtpCapabilities.bind(this),set:this.setterRtpCapabilities.bind(this),enumerable:!0}),Reflect.defineProperty(this,"_createTransport",{value:this.wrapperCreateTransport.bind(this),enumerable:!1})}getterRtpCapabilities(){return null==this.directionContext||null==this.originalRtpCapabilities?this.originalRtpCapabilities:this.device.processRtpCapabilities(this.directionContext,this.originalRtpCapabilities)}setterRtpCapabilities(e){this.originalRtpCapabilities=e}wrapperCreateTransport(e){try{return this.directionContext=e.direction,this.originalCreateTransport(e)}finally{this.directionContext=null}}}t.ExtendedDevice=s},"./node_modules/@video/video-client-core/lib/internal/pvc/call/echo.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/@video/events-typed/index.js"),s=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),o=i("./node_modules/@video/video-client-core/lib/api/adapter/features/feature.js");class n extends r.EventEmitter{constructor(e){if(super(),this.total=0,this.echo=!1,this._history=[],this._currBucket=0,!s.device.isImplements(o.Feature.AUDIO_CONTEXT))throw new Error("Audio management is not supported");if(this._audioContext=new s.device.AudioContext,this._analyserNode=this._audioContext.createAnalyser(),this._processorNode=this._audioContext.createScriptProcessor(),this._dataArray=new s.device.Uint8Array(this._analyserNode.fftSize),this._analyserNode.smoothingTimeConstant=.4,this._analyserNode.fftSize=64,this._processorNode.onaudioprocess=()=>{var e;this._analyserNode.getByteTimeDomainData(this._dataArray);const t=Date.now(),i=Math.floor(t/1e3);this._currBucket!==i&&(this._history.length>2&&(this._history=this._history.slice(1,this._history.length),this.runAnalysis()),this._history.push([]),this._currBucket=i),null===(e=this._history[this._history.length-1])||void 0===e||e.push(this.dataResult()),this.total+=1},!s.device.isImplements(o.Feature.MEDIA_STREAM))throw new Error("media stream is not implemented");this._mediaStream=new s.device.MediaStream,this._mediaStream.addTrack(e),this._mediaStreamSource=this._audioContext.createMediaStreamSource(this._mediaStream),this._mediaStreamSource.connect(this._analyserNode),this._analyserNode.connect(this._processorNode)}close(){this._audioContext.close()}dataResult(){let e=null,t=null,i=0;for(let r=0;r<this._dataArray.length;r+=1){const s=this._dataArray[r];(null==e||s<e)&&(e=s),(null==t||s>t)&&(t=s),i+=s}return{lowest:e,highest:t,total:this._dataArray.length,sum:i,average:i/this._dataArray.length}}runAnalysis(){var e,t,i;let r=0,n=0,a=0;const l=[];for(const[s,o]of this._history.entries())for(const[d,c]of o.entries()){const u=this._history[s-1];if(null!=u){const s=null!==(e=o[d-1])&&void 0!==e?e:u[u.length-1];if(null!=s){const e=null!==(t=c.highest)&&void 0!==t?t:0,o=null!==(i=s.highest)&&void 0!==i?i:0;if(e>=o-.09*Math.abs(o)){e<=o+.09*Math.abs(o)?(a+=1,l.push("s")):(r+=1,l.push("i"))}else n+=1,l.push("d")}}}const d=r+n,c=d+a;d/c>.4?this.echo||(this.echo=!0,this.emit("echo")):this.echo&&(this.echo=!1,this.emit("noecho")),((...e)=>{!0===s.device.globals.get("printOutput")&&s.device.isImplements(o.Feature.DEBUGGING)&&s.device.console.log(...e)})(`${l.join("")} - (${r}/${n}/${a}) (${d})/${c})`)}}t.default=n,n.displayName="EchoDetector"},"./node_modules/@video/video-client-core/lib/internal/pvc/call/messageList.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.disconnectedMessages=t.offlineMessages=t.PEER_MESSAGES=t.TROUBLESHOOTING=t.MessageList=void 0;class i{ messages(){return Object.keys(this._messages).map(e=>this._messages[parseInt(e,10)]).sort(}}t.MessageList=i,i.displayName="MessageList";const r=new i;t.offlineMessages=r,r.addMessage({code:1001,type:"network",level:"error",message:"Internet disconnected",explanation:"Check your internet connection and reconnect to the network"});const s=new i;t.disconnectedMessages=s,s.addMessage({code:1002,type:"network",level:"error",message:"Call disconnected",explanation:"Please wait while the call reconnects"});t.TROUBLESHOOTING={NO_WEBCAM:{code:1003,type:"webcam",level:"warn",message:"No webcam found",explanation:"Make sure your webcam is connected and your browser has permission to use it"},NO_MIC:{code:1004,type:"microphone",level:"warn",message:"No microphone found",explanation:"Make sure your microphone is connected and your browser has permission to use it"},NETWORK_FIREWALLED:{code:1005,type:"network",level:"error",message:"Connection blocked by firewall",explanation:"Disable firewall"},UNSTABLE_NETWORK:{code:1006,type:"network",level:"warn",message:"Unstable connection",explanation:"If on wifi, try connecting to a stronger network"},WEBRTC_RECV_DISCONNECTED:{code:1007,type:"network",level:"error",message:"Unable to receive stream",explanation:"If on wifi, try connecting to a stronger network"},WEBRTC_SEND_DISCONNECTED:{code:1008,type:"network",level:"warn",message:"Unable to send stream",explanation:"If on wifi, try connecting to a stronger network"},ONE_TO_ONE_PEER_DISCONNECTED:{code:1009,type:"network",level:"error",message:"Peer disconnected",explanation:"Please wait for the other user to come back online"}};t.PEER_MESSAGES={UNSTABLE_PEER:{code:2001,type:"network",level:"error",message:"This user's connection is unstable"}}},"./node_modules/@video/video-client-core/lib/internal/pvc/call/peer.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Peer=void 0;const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/index.js"),o=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),n=i("./node_modules/@video/video-client-core/lib/api/adapter/features/feature.js"),a=i("./node_modules/@video/video-client-core/lib/api/error.js"),l=i("./node_modules/@video/video-client-core/lib/internal/errors.js"),d=i("./node_modules/@video/video-client-core/lib/internal/errors-deprecated.js"),c=i("./node_modules/@video/video-client-core/lib/internal/player/helper.js"),u=i("./node_modules/@video/video-client-core/lib/internal/utils/context/context.js"),p=i("./node_modules/@video/video-client-core/lib/internal/utils/events/event-emitter.js"),h=i("./node_modules/@video/video-client-core/lib/internal/utils/logger.js"),m=i("./node_modules/@video/video-client-core/lib/internal/pvc/stats/index.js"),v=r.__importStar(i("./node_modules/@video/video-client-core/lib/internal/pvc/stats/anomalies.js")),g=i("./node_modules/@video/video-client-core/lib/internal/pvc/call/common.js"),f=i("./node_modules/@video/video-client-core/lib/internal/pvc/call/device.js"),b=i("./node_modules/@video/video-client-core/lib/internal/pvc/call/messageList.js");class _ extends p.ObservableEventEmitter{constructor(e,t){var i,r,s,o,n,a,l,c,p,v,g,f;super(),this._closed=!1,this._iceTimeouts=new Map,this._mediasoupDevice=null,this._sendTransport=null,this._recvTransport=null,this._producers=new Map,this._consumerStatIntervals=new Map,this._delayVideoStart=!1,this.peers=new Map,this.sendLock=null,this.recvLock=null,this.ctx=e,this.call=t,(0,u.onceCanceled)(e).then(this.dispose);const b=null!=(null===(o=null===(s=null===(r=null===(i=null==this?void 0:this.call)||void 0===i?void 0:i.options)||void 0===r?void 0:r.call)||void 0===s?void 0:s.stats)||void 0===o?void 0:o.statsInterval)?null===(c=null===(l=null===(a=null===(n=null==this?void 0:this.call)||void 0===n?void 0:n.options)||void 0===a?void 0:a.call)||void 0===l?void 0:l.stats)||void 0===c?void 0:c.statsInterval:null;if(this.statsCollector=new m.StatsCollector((0,h.extendContext)(this.ctx,m.StatsCollector),{interval:null!=b?b:5e3,callId:this.call.call.id,userId:null!==(v=null===(p=this.call.user)||void 0===p?void 0:p.userId)&&void 0!==v?v:null,displayName:null!==(f=null===(g=this.call.user)||void 0===g?void 0:g.displayName)&&void 0!==f?f:null,debug:!0}),null==this.call._wsTransport)throw new Error("Call._wsTransport is null");e.logger.attachObject(this),e.logger.trace("constructor()");const _=this.call._wsTransport;_.on("newPeers",this._handleNewPeers),_.on("consumerSources",this._handleConsumerSources),_.on("kicked",this._handleAccessDenied),this.addInnerDisposer(,this._peerEvent("newConsumer",this._onNewConsumer.bind(this),(e,t)=>{this.emitErrorDeprecated(new d.SFUNewConsumerEventError("unable to handle `newConsumer` peer event",{peer:this,request:{id:t.id,kind:t.kind,producerPaused:t.producerPaused,producerId:t.producerId,rtpParameters:t.rtpParameters},inner:e instanceof Error?e:null}))}),this._peerEvent("peerClosed",this._onPeerClosed.bind(this),(e,t)=>{this.emitErrorDeprecated(new d.SFUPeerClosedEventError("unable to handle `peerClosed` peer event",{peer:this,request:t,inner:e instanceof Error?e:null}))}),this._peerEvent("switchConsumerTrack",this._onSwitchConsumerTrack.bind(this),(e,t)=>{this.emitErrorDeprecated(new d.SFUSwitchConsumerTrackEventError("unable to handle `switchConsumerTrack` peer event",{peer:this,request:t,inner:e instanceof Error?e:null}))}),this._consumerEvent("consumerClosed",this._onConsumerClosed.bind(this),(e,t)=>{this.emitErrorDeprecated(new d.SFUConsumerClosedEventError("unable to handle `consumerClosed` consumer event",{peer:this,request:t,inner:e instanceof Error?e:null}))}),this._consumerEvent("consumerPaused",this._onConsumerPaused.bind(this),(e,t)=>{this.emitErrorDeprecated(new d.SFUConsumerPausedEventError("unable to handle `consumerPaused` consumer event",{peer:this,request:t,inner:e instanceof Error?e:null}))}),this._consumerEvent("consumerResumed",this._onConsumerResumed.bind(this),(e,t)=>{this.emitErrorDeprecated(new d.SFUConsumerResumedEventError("unable to handle `consumerResumed` consumer event",{peer:this,request:t,inner:e instanceof Error?e:null}))}),this._consumerEvent("consumerScore",this._onConsumerScore.bind(this),(e,t)=>{this.emitErrorDeprecated(new d.SFUConsumerScoreEventError("unable to handle `consumerScore` consumer event",{peer:this,request:t,inner:e instanceof Error?e:null}))}),this._consumerEvent("consumerLayersChanged",this._onConsumerLayersChanged.bind(this),(e,t)=>{this.emitErrorDeprecated(new d.SFUConsumerLayersChangedEventError("unable to handle `consumerLayersChanged` consumer event",{peer:this,request:t,inner:e instanceof Error?e:null}))}),this._producerEvent("producerClosed",this._onProducerClosed.bind(this),(e,t)=>{this.emitErrorDeprecated(new d.SFUProducerClosedEventError("unable to handle `producerClosed` producer event",{peer:this,request:t,inner:e instanceof Error?e:null}))}),this._producerEvent("producerPaused",this._onProducerPaused.bind(this),(e,t)=>{this.emitErrorDeprecated(new d.SFUProducerPausedEventError("unable to handle `producerPaused` producer event",{peer:this,request:t,inner:e instanceof Error?e:null}))}),this._producerEvent("producerResumed",this._onProducerResumed.bind(this),(e,t)=>{this.emitErrorDeprecated(new d.SFUProducerResumedEventError("unable to handle `producerResumed` producer event",{peer:this,request:t,inner:e instanceof Error?e:null}))}),this.addInnerDisposer(this.clear)}_handleConsumerSources(e){try{this._onConsumerSources(e)}catch(t){this.emitErrorDeprecated(new d.SFUConsumerSourcesEventError("unable to handle `newPeers` peer event",{peer:this,request:e,inner:t instanceof Error?t:null}))}}_handleAccessDenied(e){return r.__awaiter(this,void 0,void 0,()}_handleNewPeers(e){try{this._onNewPeers(e)}catch(t){this.emitErrorDeprecated(new d.SFUNewPeersEventError("unable to handle `newPeers` peer event",{peer:this,request:e,inner:t instanceof Error?t:null}))}}_setup(e){return r.__awaiter(this,void 0,void 0,(function*(){try{this._mediasoupDevice=new f.ExtendedDevice(o.device),yield this._mediasoupDevice.load({routerRtpCapabilities:e});let t=[];Object.keys(this.call.streams).length>0&&t.push(this._createSendTransport()),t.push(this._createReceiveTransport()),yield Promise.all(t),this.call.emit("CALL_SET_MEDIA_CAPABILITIES",{canSendMic:this._mediasoupDevice.canProduce("audio"),canSendWebcam:this._mediasoupDevice.canProduce("video")}),t=[];for(const e of this.call.streamsIterator())e.hasVideoStreamTrack&&!this._delayVideoStart&&this.call.hasPermission(g.PERMISSIONS.STREAM_VIDEO)&&t.push((()=>r.__awaiter(this,void 0,void 0,(function*(){var t;try{(null===(t=this._mediasoupDevice)||void 0===t?void 0:t.canProduce("video"))&&(yield e.enableVideo())}catch(e){const t=e instanceof Error?e.message:"unknown error";this.ctx.logger.warn("Unable to set video producer",{err:t}),this.call._addMessage(b.TROUBLESHOOTING.NO_WEBCAM)}})))()),e.hasAudioStreamTrack&&this.call.hasPermission(g.PERMISSIONS.STREAM_AUDIO)&&t.push((()=>r.__awaiter(this,void 0,void 0,(function*(){var t;try{(null===(t=this._mediasoupDevice)||void 0===t?void 0:t.canProduce("audio"))&&(yield e.enableAudio())}catch(e){const t=e instanceof Error?e.message:"unknown error";this.ctx.logger.warn("Unable to set audio producer",{err:t}),this.call._addMessage(b.TROUBLESHOOTING.NO_MIC)}})))());yield Promise.all(t)}catch(e){if(null!=this.sendLock)try{this.sendLock.reject()}catch(e){}if(null!=this.recvLock)try{this.recvLock.reject()}catch(e){}if(null!=this._recvTransport)try{this._recvTransport.close()}catch(e){}if(null!=this._sendTransport)try{this._sendTransport.close()}catch(e){}this.emitErrorDeprecated(new d.MediasoupSetupError("ms3._setup: error during setup",{critical:!0,inner:e instanceof Error?e:null}))}}))}_createSendTransport(){return r.__awaiter(this,void 0,void 0,(function*(){if(null==this._mediasoupDevice)throw new Error("Peer._mediasoupDevice is null");let e;this.sendLock=this._initLock();const t={producing:!0,consuming:!1,rtpCapabilities:this._mediasoupDevice.rtpCapabilities,maxBitrate:this.call.maxBitrate};try{e=yield this.call._request("createWebRtcTransport",t)}catch(e){const i=e instanceof Error?e:null,r=new d.WSRequestError("createSendTransport: ws request error",{inner:i,request:"createWebRtcTransport",args:t,internalCall:this.call});throw this.call.emit("error",r),r}this._sendTransport=this._mediasoupDevice.createSendTransport(Object.assign({id:e.id,iceParameters:e.iceParameters,iceCandidates:e.iceCandidates,dtlsParameters:e.dtlsParameters},this._transportOptions())),null!=this.call.peerId?this.statsCollector.attachTransports(this.call.peerId,this._sendTransport,null):this.ctx.logger.error("unable to attach stats collector: peerId is null"),this.sendLock.resolve(),this.ctx.logger.debug("ms3._createSendTransport: created",{transportInfo:e,deviceCapabilities:this._mediasoupDevice.rtpCapabilities}),this._handleTransportEvents(this._sendTransport,"send")}))}_createReceiveTransport(){return r.__awaiter(this,void 0,void 0,(function*(){if(null==this._mediasoupDevice)throw new Error("Peer._mediasoupDevice is null");let e;this.recvLock=this._initLock();const t={forceTcp:this._forceRecvTcp,producing:!1,consuming:!0,rtpCapabilities:this._mediasoupDevice.rtpCapabilities},i=this._closed||this.call._closed;try{e=yield this.call._request("createWebRtcTransport",t)}catch(e){const r=this._closed||this.call._closed;if(!i&&r)return;const s=e instanceof Error?e:null,o=new d.WSRequestError("createReceiveTransport: ws request error",{inner:s,request:"createWebRtcTransport",args:t,internalCall:this.call});throw this.call.emit("error",o),o}e=Object.assign(Object.assign({},e),this._transportOptions()),this._recvTransport=this._mediasoupDevice.createRecvTransport(e),null!=this.call.peerId?this.statsCollector.attachTransports(this.call.peerId,null,this._recvTransport):this.ctx.logger.error("unable to attach stats collector: peerId is null"),this.recvLock.resolve(),this.ctx.logger.debug("ms3._createReceiveTransport: created",{transportInfo:e}),this._handleTransportEvents(this._recvTransport,"recv")}))}_transportOptions(){var e,t,i;const r=o.device.isImplements(n.Feature.BROWSER_TYPE)&&"edge"===(null===(e=o.device.browserInfo)||void 0===e?void 0:e.name)?this.call._edgeIceServers():this.call._iceServers();return this.call._iceTransportPolicyUsed=null!==(i=null!==(t=this.call._iceTransportPolicy)&&void 0!==t?t:this.call._localSettings.iceTransportPolicy)&&void 0!==i?i:"all",{iceServers:r,iceTransportPolicy:this.call._iceTransportPolicyUsed}}_handleTransportEvents(e,t){let i;("send"===t&&this.call._requireSend||"recv"===t&&this.call._requireRecv)&&(i=o.device.setTimeout(()=>{"new"===e.connectionState&&this.emitErrorDeprecated(new d.TransportStateError("Transport failed to change connection state",{critical:!0}))},2e4));const r=t.toUpperCase();let s=null;e.on("connectionstatechange",a=>{o.device.clearTimeout(i),"SEND"===r?this.call.emit("CALL_SET_SENDING_ICE_STATE",{state:a}):this.call.emit("CALL_SET_RECEIVING_ICE_STATE",{state:a}),this.ctx.logger.setMessageAggregate(t+"TransportId",e.id),this.ctx.logger.setMessageAggregate(t+"TransportState",a);const l=o.device.isImplements(n.Feature.NETWORK_INFORMATION)?o.device.connection:null;switch(this.ctx.logger.info(t+" transport connection state change",{state:a,transportType:t,prevState:s,connection:l}),s=a,"completed"===a&&(a="connected"),a){case"connected":e.appData.onceConnected=!0,this.call._removeMessage(b.TROUBLESHOOTING.NETWORK_FIREWALLED),this.call._removeMessage(b.TROUBLESHOOTING["SEND"===r?"WEBRTC_SEND_DISCONNECTED":"WEBRTC_RECV_DISCONNECTED"]),o.device.clearTimeout(this._iceTimeouts.get(t)),this._iceTimeouts.delete(t),this.ctx.logger.info(t+" transport entered connected state"),this.emit("webrtc-transport-connected",t);break;case"disconnected":this.call._addMessage(b.TROUBLESHOOTING["SEND"===r?"WEBRTC_SEND_DISCONNECTED":"WEBRTC_RECV_DISCONNECTED"]),this._restartIce(t),this.ctx.logger.warn(t+" transport entered disconnected state"),this.emit("webrtc-transport-disconnected",t);break;case"failed":if(this.ctx.logger.warn(t+" transport entered failed state"),this.emit("webrtc-transport-failed",t),"SEND"===r&&this.call._requireSend)this.emitErrorDeprecated(new d.TransportStateError("Send transport failed",{critical:!0}));else if("RECV"===r&&this.call._requireRecv){const e=new Error("Receive transport failed");null!=this.recvLock&&this.recvLock.reject(e),this.emitErrorDeprecated(new d.TransportStateError("Receive transport failed",{critical:!0}))}else this.call._removeMessage(b.TROUBLESHOOTING["SEND"===r?"WEBRTC_SEND_DISCONNECTED":"WEBRTC_RECV_DISCONNECTED"]),this._restartIce(t),e.appData.onceConnected||this.call._addMessage(b.TROUBLESHOOTING.NETWORK_FIREWALLED);break;case"closed":"send"===r?null!=this.sendLock&&this.sendLock.reject(new Error("send transport closed")):null!=this.recvLock&&this.recvLock.reject(new Error("recv transport closed")),this._closed||this.emitErrorDeprecated(new d.TransportStateError(t+" transport closed prematurely",{critical:!0})),this.ctx.logger.warn(t+" transport entered closed state"),this.emit("webrtc-transport-closed",t)}}),e.observer.on("close",()=>{this.ctx.logger.info(t+" transport.observer.closed state"),this.emit("webrtc-transport-closed",t),this._closed||this.disposing||this._closed||"recv"!==t||(this.ctx.logger.warn(t+" transport.observer.closed, but peer is still open. Trying to recreate recv transport"),this._createReceiveTransport().catch(e=>{const t=e instanceof Error?e:null;this.throwErrorDeprecated(new d.TransportStateError("unable to re-create recv transport",{inner:t,critical:!0}))}))});const a=this._closed||this.call._closed;e.on("connect",({dtlsParameters:i},r,s)=>{const o={transportId:e.id,dtlsParameters:i};this.call._request("connectWebRtcTransport",o).then(()=>{var e;r(),null===(e=this.recvLock)||void 0===e||e.resolve(),this.ctx.logger.debug("ms3._handleTransportEvents connected",{transportType:t})}).catch(e=>{const t=this._closed||this.call._closed;if(!a&&t)return;const i=e instanceof Error?e:null,r=new d.WSRequestError("handleTransportEvents: ws request error",{inner:i,request:"connectWebRtcTransport",args:o,internalCall:this.call});this.call.emit("error",r),s(r)})}),e.on("produce",({kind:t,rtpParameters:i,appData:r},s,o)=>{const n={transportId:e.id,kind:t,rtpParameters:i,appData:r};this.call._request("produce",n).then(e=>{s(e),this.ctx.logger.debug("ms3._handleTransportEvents: produce",{kind:t,appData:r})}).catch(e=>{const t=e instanceof Error?e:null,i=new d.WSRequestError("handleTransportEvents: ws request error",{inner:t,request:"produce",args:n,internalCall:this.call});this.call.emit("error",i),o(i)})})}_addPeers(e){e.forEach(e=>{null!=e.id?(this.peers.set(e.id,e),this.call.emit("CALL_ADD_PEER",{peer:e}),this.call.emit("PEER_CHANGE",{peer:e,action:"added"})):this.emitErrorDeprecated(new d.InternalError("peerId is undefined",{}))})}_restartIce(e){if(null!=this._iceTimeouts.get(e))return;const t=()=>r.__awaiter(this,void 0,void 0,(function*(){if(!this._closed)if(null!=this.call._wsTransport){if(this.ctx.logger.throttledLog("debug",15e3,"ice restart",{online:this.call._wsTransport.online}),!this.call._wsTransport.online)return o.device.clearTimeout(this._iceTimeouts.get(e)),void this._iceTimeouts.set(e,o.device.setTimeout(t.bind(this),500));try{const t={dir:e};let i;try{i=yield this.call._request("restartIce",t)}catch(e){const i=e instanceof Error?e:null,r=new d.WSRequestError("restartIce: ws request error",{inner:i,request:"restartIce",args:t,internalCall:this.call});throw this.call.emit("error",r),r}if("send"===e){if(null==this._sendTransport)return void this.ctx.logger.error("call: restartIce error",{err:"_sendTransport is null"});yield this._sendTransport.restartIce(i)}else{if(null==this._recvTransport)return void this.ctx.logger.error("call: restartIce error",{err:"_recvTransport is null"});yield this._recvTransport.restartIce(i)}return void this._iceTimeouts.delete(e)}catch(e){const t=e instanceof Error?e.message:"unknown error";this.ctx.logger.warn("call: restartIce error",{err:t})}o.device.clearTimeout(this._iceTimeouts.get(e)),this._iceTimeouts.set(e,o.device.setTimeout(t.bind(this),5e3))}else this.ctx.logger.error("call: restartIce error",{err:"call._wsTransport is null"})}));t().catch(this.ctx.logger.error)}_onNewPeers(e){this._addPeers(e.peers)}_onConsumerSources(e){var t,i,r;const s={};for(const o of e.consumers){const e=null!==(t=s[`${o.peerId}-${o.streamName}`])&&void 0!==t?t:{peerId:o.peerId,streamName:o.streamName,layers:[]};for(const t of o.encodings)e.layers.push({id:t.id,bitrate:null!==(r=null!==(i=t.bitrate)&&void 0!==i?i:t.maxBitrate)&&void 0!==r?r:0,isSource:!o.xcode,appData:{consumerId:o.consumerId}});s[`${o.peerId}-${o.streamName}`]=e}for(const e of Object.values(s))this.call.emit("CALL_CONSUMER_SOURCES",e)}getLayers(e,t){var i,s;return r.__awaiter(this,void 0,void 0,(function*(){let r=[],o=null,n=null;const a=this._closed||this.call._closed;try{n=yield this.call.requestSources(e,t),this.ctx.logger.debug("request consumerSources from ws",{sources:n});for(const e of n.consumers)for(const t of e.encodings){const n={id:t.id,bitrate:null!==(s=null!==(i=t.bitrate)&&void 0!==i?i:t.maxBitrate)&&void 0!==s?s:0,isSource:!e.xcode,appData:{consumerId:e.consumerId}};r.push(n),t.active&&(o=n)}}catch(e){const t=this._closed||this.call._closed;if(!a&&t)return[null,[]];this.ctx.logger.error("unable to get consumer sources: "+e,{sources:n})}return r=(0,c.sortEncodings)(r),[o,r]}))}_onNewConsumer(e,t,i){var o,n,a,l,c,u,p;return r.__awaiter(this,void 0,void 0,(function*(){if(this.ctx.logger.info("call: _onNewConsumer"),null!=this.recvLock?yield this.recvLock.ready():yield this._createReceiveTransport(),null==this._recvTransport)return this.ctx.logger.error("call: _onNewConsumer error",{err:"_recvTransport is null"}),void i(null,"_recvTransport is null");if(this._recvTransport.closed)return yield this._createReceiveTransport(),yield null===(o=this.recvLock)||void 0===o?void 0:o.ready(),void i(null,"_recvTransport closed");const r=yield this._recvTransport.consume(t);!1!==(null===(n=t.appData)||void 0===n?void 0:n.trackEnabled)&&!t.producerPaused||r.paused||r.pause(),null===(a=e.consumers)||void 0===a||a.push(r),r.on("transportclose",()=>{this.ctx.logger.debug("consumer event",{event:"transportclose",kind:t.kind}),this._deleteConsumers(e,[r.id])}),r.on("trackended",()=>{this.ctx.logger.debug("consumer event",{event:"trackended",kind:t.kind}),this._deleteConsumers(e,[r.id])}),v.watchCpuSpikes(this.ctx.logger,r),r.on("webrtc-anomaly",e=>{this.emit("webrtc-anomaly",e)});const{encodings:h}=r.rtpParameters;if(null==h||0===(null==h?void 0:h.length))return this.ctx.logger.error("call: _onNewConsumer error",{err:"consumer doesn't have any encodings"}),void i(null,"consumer doesn't have any encodings");const{spatialLayers:m,temporalLayers:g}=(0,s.parseScalabilityMode)(null!==(c=null===(l=h[0])||void 0===l?void 0:l.scalabilityMode)&&void 0!==c?c:""),{streamName:f}=r.appData;if("string"!=typeof f)return this.ctx.logger.error("call: _onNewConsumer error",{err:"consumer.appData doesn't have a proper stream name"}),void i(null,"consumer.appData doesn't have a proper stream name");if(null==e.id)return this.ctx.logger.error("call: _onNewConsumer error",{err:"peer.id is null"}),void i(null,"peer.id is null");const b="object"==typeof t&&t.dontAdd;let[_,y]=[null,[]];if(!b){const t=this._closed||this.call._closed;if("video"===r.kind)try{[_,y]=yield this.getLayers(f,e.id)}catch(e){const i=this._closed||this.call._closed;if(!t&&i)return;throw e}}const w={peerId:e.id,streamName:f,consumer:{id:r.id,peerId:e.id,kind:r.kind,streamName:String(r.appData.streamName),supported:!0,locallyPaused:!1,paused:r.paused,track:r.track,codec:null!==(p=null===(u=r.rtpParameters.codecs[0])||void 0===u?void 0:u.mimeType.split("/")[1])&&void 0!==p?p:"",pause:()=>{r.pause();const e={consumerId:r.id};this.call._request("pauseConsumer",e).catch(t=>{const i=t instanceof Error?t:null,r=new d.WSRequestError("pause: ws request error",{inner:i,request:"pauseConsumer",args:e,internalCall:this.call});this.call.emit("error",r)})},resume:()=>{r.resume();const e={consumerId:r.id};this.call._request("resumeConsumer",e).catch(t=>{const i=t instanceof Error?t:null,r=new d.WSRequestError("resume: ws request error",{inner:i,request:"resumeConsumer",args:e,internalCall:this.call});return this.call.emit("error",r),r})},layers:y,activeLayer:_,preferredSpatialLayer:m-1,preferredTemporalLayer:g-1,rtpParameters:r.rtpParameters,dontAdd:b}};this.call.emit("CALL_ADD_CONSUMER",w),b||(this.call.emit("CALL_SET_CONSUMER_TRACK",{peerId:e.id,streamName:f,consumerId:r.id,track:r.track}),this.call.emit("PEER_CHANGE",{peer:e,action:"consumer_added"})),i({})}))}hasConsumerId(e){return Array.from(this.peers.values()).some(}_peerEvent(e,t,i){const s=this.call._wsTransport;if(null==s)return void this.emitErrorDeprecated(new d.InternalError("call: peerEvent error: wsTransport is null",{}));const o=(s,o)=>r.__awaiter(this,void 0,void 0,(function*(){if(null==s.peerId||""===s.peerId)return this.ctx.logger.warn("invalid peer event request: no peerId",{event:e,req:s}),void o(null,"invalid peer event request: no peerId");const r=this.peers.get(s.peerId);if(null==r)return this.ctx.logger.warn("peer not found for peer event",{event:e,req:s}),void o(null,"peer not found for peer event");this.ctx.logger.debug("peer event",{event:e,req:s});try{yield t(r,s,o)}catch(t){i(t instanceof Error?t:null,s),"function"==typeof o?t instanceof Error?o(null,"peer event error: "+t.message):o(null,"peer event error: undefined error"):this.ctx.logger.debug(`BUG: check '${e}' event in PvcTransport, it doesn't provide 'resp' callback`,{aggregates:{bug:!0}})}}));s.on(e,o),this.addInnerDisposer(()=>{s.off(e,o)})}_onPeerClosed(e){var t,i;return r.__awaiter(this,void 0,void 0,(function*(){if(null!=e.id){if(this.peers.has(e.id)){this.peers.delete(e.id);const r=null===(t=e.consumers)||void 0===t?void 0:t.map(e=>e.id);if(yield this._deleteConsumers(e,null!=r?r:[]),this.call._closed)return;this.call.emit("CALL_REMOVE_PEER",{peerId:null!==(i=e.id)&&void 0!==i?i:""}),this.call.emit("PEER_CHANGE",{peer:e,action:"removed"})}}else this.emitErrorDeprecated(new d.InternalError("peerId is undefined",{}))}))}_producerEvent(e,t,i){const s=this.call._wsTransport;if(null==s)return void this.ctx.logger.error("call: produceEvent error",{err:"call._wsTransport is null"});const o=s=>r.__awaiter(this,void 0,void 0,(function*(){if(s.peerId!==this.call.peerId)return void this.ctx.logger.debug("wrong peer ID for producer event",{event:e,req:s});const r=this._producers.get(s.producerId);if(null!=r)try{yield t(r,s)}catch(e){i(e instanceof Error?e:null,s)}else console.trace("producer not found for producer event",{event:e,req:s})}));s.on(e,o),this.addInnerDisposer(()=>{s.off(e,o)})}_consumerEvent(e,t,i){const s=this.call._wsTransport;if(null==s)return void this.ctx.logger.error("call: consumerEvent error",{err:"call._wsTransport is null"});const o=s=>r.__awaiter(this,void 0,void 0,(function*(){var r;const o=this.peers.get(s.peerId);if(null==o)return void this.ctx.logger.debug("peer not found for consumer event",{event:e,req:s});const n=null===(r=o.consumers)||void 0===r?void 0:r.find(e=>e.id===s.consumerId);if(null!=n){this.ctx.logger.debug("consumer event",{event:e,req:s});try{yield t(n,o,s)}catch(e){i(e instanceof Error?e:null,s)}}else"consumerClosed"!==e&&this.ctx.logger.debug("consumer not found for consumer event",{event:e,req:s})}));s.on(e,o),this.addInnerDisposer(}_deleteConsumers(e,t){return t.forEach(t=>{var i,r,s,o;const n=null===(i=e.consumers)||void 0===i?void 0:i.find(e=>e.id===t);if(null==n)return;this.call.emit("CALL_REMOVE_CONSUMER",{peerId:null!==(r=e.id)&&void 0!==r?r:"",streamName:String(n.appData.streamName),consumerId:n.id}),this.call.emit("PEER_CHANGE",{peer:e,action:"consumer_removed"});const a=null===(s=e.consumers)||void 0===s?void 0:s.indexOf(n);null===(o=e.consumers)||void 0===o||o.splice(null!=a?a:0,1)}),Promise.resolve()}_onConsumerClosed(e,t){return r.__awaiter(this,void 0,void 0,(function*(){e.close();const i=this._consumerStatIntervals.get(e.id);clearInterval(i),this._consumerStatIntervals.delete(e.id),yield this._deleteConsumers(t,[e.id])}))}_onConsumerPaused(e,t){var i;return e.pause(),this.call.emit("CALL_SET_CONSUMER_PAUSED",{peerId:null!==(i=t.id)&&void 0!==i?i:"",streamName:String(e.appData.streamName),consumerId:e.id,originator:"peer"}),Promise.resolve()}_onConsumerResumed(e,t){var i;return e.resume(),this.call.emit("CALL_SET_CONSUMER_RESUMED",{peerId:null!==(i=t.id)&&void 0!==i?i:"",streamName:String(e.appData.streamName),consumerId:e.id,originator:"peer"}),Promise.resolve()}onConsumerLayersChanged(e,t,i){return r.__awaiter(this,void 0,void 0,()}_onSwitchConsumerTrack(e,t,i){var s,o,n,a;return r.__awaiter(this,void 0,void 0,(function*(){const r=e.id;if(null==r)return;const l=new Map;for(const i of t.add){const r=null===(s=e.consumers)||void 0===s?void 0:s.find(e=>e.id===i.consumerId);if(!r){const e=new d.SFUSwitchConsumerTrackEventError("unable to switch tracks: consumer not found",{consumerId:i.consumerId,peer:this,request:t});return void this.emitErrorDeprecated(e)}const n=String(r.appData.streamName);l.has(n)||l.set(n,{add:[],remove:[]}),null===(o=l.get(n))||void 0===o||o.add.push(r.track)}for(const i of t.remove){const r=null===(n=e.consumers)||void 0===n?void 0:n.find(e=>e.id===i.consumerId);if(!r){const e=new d.SFUSwitchConsumerTrackEventError("unable to switch tracks: consumer not found",{consumerId:i.consumerId,peer:this,request:t});return void this.emitErrorDeprecated(e)}const s=String(r.appData.streamName);l.has(s)||l.set(s,{add:[],remove:[]}),null===(a=l.get(s))||void 0===a||a.remove.push(r.track)}for(const[e,i]of l.entries()){if(0===i.add.length||0===i.remove.length){const e=new d.SFUSwitchConsumerTrackEventError("unable to switch tracks: consumers have different stream names",{peer:this,request:t});return void this.emitErrorDeprecated(e)}this.call.emit("CALL_SWAP_CONSUMERS",{peerId:r,streamName:e,add:i.add,remove:i.remove})}i({})}))}_onProducerClosed(e,t){return e.closed||(this.call.emit("CALL_REMOVE_PRODUCER",{streamName:t.streamName,producerId:t.producerId,originator:"client"}),e.close()),Promise.resolve()}_onProducerPaused(e){return e.pause(),Promise.resolve()}roduce(e,t,i){var s,d,c,u;return r.__awaiter(this,void 0,void 0,(function*(){if(null!=this.sendLock)try{yield this.sendLock.ready()}catch(e){throw new Error("unable to acquire a lock")}else try{yield this._createSendTransport()}catch(e){const t=e instanceof Error?e.message:"unknown error";throw this.ctx.logger.error("unable to create send transport",{err:t}),e}if(null==this._sendTransport){const e=new Error("_sendTransport is null");throw this.ctx.logger.error("ms3.produce error",{err:e.message}),e}let r;const{simulcast:{maxBitrates:p}={}}=t;if(p&&"video"===e.kind){const o=Object.assign(Object.assign({},t),{track:e,appData:i,encodings:[{maxBitrate:p[0],dtx:!0},{maxBitrate:p[1],dtx:!0}],stopTracks:!1});t.audioOnly&&(o.appData.audioOnly=t.audioOnly),t.videoOnly&&(o.appData.videoOnly=t.videoOnly),o.appData.trackEnabled=o.track.enabled,o.appData.userId=null===(s=this.call.user)||void 0===s?void 0:s.userId,o.appData.displayName=null===(d=this.call.user)||void 0===d?void 0:d.displayName,this.ctx.logger.debug("create maxBitrates producer",Object.assign(Object.assign({},o),{track:null,appData:null})),r=yield this._sendTransport.produce(o)}else{const s=Object.assign(Object.assign({},t),{track:e,appData:i,stopTracks:!1});t.audioOnly&&(s.appData.audioOnly=t.audioOnly),t.videoOnly&&(s.appData.videoOnly=t.videoOnly),s.appData.trackEnabled=s.track.enabled,s.appData.userId=null===(c=this.call.user)||void 0===c?void 0:c.userId,s.appData.displayName=null===(u=this.call.user)||void 0===u?void 0:u.displayName,this.ctx.logger.debug("create basic producer",Object.assign(Object.assign({},s),{track:null,appData:null})),s.encodings&&s.encodings.length>1&&o.device.isIosDevice&&o.device.isImplements(n.Feature.BROWSER_TYPE)&&"chrome"===o.device.browserInfo.name&&(s.encodings=[{maxBitrate:25e5}],this.emitError((0,l.createError)(a.ErrorCode.SimulcastDisabled,"simulcast is disabled due to ios chrome limitations",{}))),r=yield this._sendTransport.produce(s)}return this._producers.set(r.id,r),this.ctx.logger.debug("ms3.produce",{appData:i,trackLabel:e.label}),r.on("transportclose",()=>{this.ctx.logger.debug("ms3.produce: transport closed",{trackLabel:e.label,appData:i})}),r.on("trackended",()=>{this.ctx.logger.debug("ms3.produce: track ended",{trackLabel:e.label,appData:i})}),r}))}clear(e){this.statsCollector.dispose(e),this._iceTimeouts.forEach(,this._iceTimeouts.clear(),null!=this._recvTransport&&this._recvTransport.close(),null!=this._sendTransport&&this._sendTransport.close()}close(e="Implementer did not pass debugString",t=!1){return r.__awaiter(this,void 0,void 0,(function*(){if(!this._closed)if(this.clear(e),this._closed=!0,null!=this.call._wsTransport)try{yield this.call._wsTransport.request("closePeer",{internal:t})}catch(i){const r=i instanceof Error?i.toString():"unknown error";this.ctx.logger.info("ms3.close: error closing peer on the server",{aggregates:{err:r,internal:t,reason:e}})}else this.ctx.logger.debug("close error",{err:"call._wsTransport is null"})}))}_initLock(){const e={};return e.promise=new Promise((t,i)=>{e.resolve=e.reject=t=>{e.resolved?e.promise=Promise.reject(t):i(t)}}),e.ready=()=>e.promise,e}toJSON(){return{peers:Array.from(this.peers.values()).map(,aggregates:{support:this.ctx.support.hash,localPeerId:this.call._localPeerId}}}}t.Peer=_,_.displayName="PvcPeer"},"./node_modules/@video/video-client-core/lib/internal/pvc/call/stream.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/@video/log-client/index.js"),o=i("./node_modules/@video/video-client-core/node_modules/@video/log-node/index.js"),n=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),a=i("./node_modules/@video/video-client-core/lib/api/adapter/features/feature.js"),l=i("./node_modules/@video/video-client-core/lib/utils/common.js"),d=i("./node_modules/@video/video-client-core/lib/internal/errors-deprecated.js"),c=i("./node_modules/@video/video-client-core/lib/internal/utils/context/context.js"),u=i("./node_modules/@video/video-client-core/lib/internal/utils/events/event-emitter.js"),p=r.__importStar(i("./node_modules/@video/video-client-core/lib/internal/pvc/stats/anomalies.js")),h=i("./node_modules/@video/video-client-core/lib/internal/pvc/call/common.js"),m=r.__importDefault(i("./node_modules/@video/video-client-core/lib/internal/pvc/call/echo.js")),v=i("./node_modules/@video/video-client-core/lib/internal/pvc/call/messageList.js");let g=null;n.onceDeviceReady.then(e=>{e.isImplements(a.Feature.AUDIO_CONTEXT)&&(g=new e.AudioContext)});class f extends u.ObservableEventEmitter{constructor(e,t,i,r){var s,o,n,a,l,d,u,p;super(),(0,c.onceCanceled)(e).then(e=>this.dispose("Stream Context Cancelled: "+e)),this.ctx=e,this.streamName=t,this.call=i;const m=null!=r?r:{};this._audioOptions=null!==(s=m.audio)&&void 0!==s?s:{},null!=this._audioOptions.streamProvider?(this._audioStreamProvider=null!==(o=this._audioOptions.streamProvider)&&void 0!==o?o:null,this._audioStreamProviderType=null!==(n=this._audioOptions.streamProviderType)&&void 0!==n?n:h.CUSTOM_STREAM_TYPE):(this._audioStreamProvider=null,this._audioStreamProviderType=null),this._useEchoDetection=null!==(a=this._audioOptions.echoDetection)&&void 0!==a&&a,this._videoOptions=null!==(l=m.video)&&void 0!==l?l:{},null!=this._videoOptions.streamProvider?(this._videoStreamProvider=null!==(d=this._videoOptions.streamProvider)&&void 0!==d?d:null,this._videoStreamProviderType=null!==(u=this._videoOptions.streamProviderType)&&void 0!==u?u:h.CUSTOM_STREAM_TYPE):(this._videoStreamProvider=null,this._videoStreamProviderType=null),this._videoProducer=null,this._audioProducer=null,this._statsInterval=null!==(p=m.statsInterval)&&void 0!==p?p:5e3,e.logger.attachObject(this),e.logger.trace("constructor()",this),this.addInnerDisposer(()=>{this.close()})}et audioProducer(){return this._audioProducer}get videoProducer(){return this._videoProducer}get hasVideoStreamTrack(){var e;const t=null===(e=this._videoStreamProvider)||void 0===e?void 0:e.source;return null!=t&&t.getVideoTracks().length>0}get hasAudioStreamTrack(){var e;const t=null===(e=this._audioStreamProvider)||void 0===e?void 0:e.source;return null!=t&&t.getAudioTracks().length>0}setVideoStreamProvider(e,t,i,s){return r.__awaiter(this,void 0,void 0,(function*(){return this._setMediaStreamProvider("video",e,t,i,!1,s)}))}setAudioStreamProvider(e,t,i,s){return r.__awaiter(this,void 0,void 0,(function*(){return this._setMediaStreamProvider("audio",e,t,i,!1,s)}))}checkPermissions(e){e&&!this.call.hasPermission(h.PERMISSIONS.STREAM_VIDEO)?this.throwErrorDeprecated(new d.PermissionsError("no permission to stream video",{stream:this,permissions:this.call.permissions})):e||this.call.hasPermission(h.PERMISSIONS.STREAM_AUDIO)||this.throwErrorDeprecated(new d.PermissionsError("no permission to stream audio",{stream:this,permissions:this.call.permissions}))}_setMediaStreamProvider(e,t,i,s,o,n){var a,l,c;return r.__awaiter(this,void 0,void 0,(function*(){this.ctx.logger.debug("setMediaStreamRetriever",Object.assign(Object.assign({},this.logData),{kind:e}));const r="video"===e;let u,p=null,m=null;if(r?(m=this._videoStreamProvider,u=this._videoStreamProviderType,this._videoStreamProvider=t,this._videoStreamProviderType=null!==(a=i.streamType)&&void 0!==a?a:h.CUSTOM_STREAM_TYPE,p=this._videoProducer):(m=this._audioStreamProvider,u=this._audioStreamProviderType,this._audioStreamProvider=t,this._audioStreamProviderType=null!==(l=i.streamType)&&void 0!==l?l:h.CUSTOM_STREAM_TYPE,p=this._audioProducer),!s)return null;if(this.checkPermissions(r),null!=p&&!p.closed){let s,n;null!=p.track&&p.track.stop();try{if(s=t.source,null==s)return this.ctx.logger.error("Stream provider returned null",Object.assign(Object.assign({},this.logData),{kind:e})),null}catch(t){const r=t instanceof Error?t.message:"unknown error";if(this.ctx.logger.warn("Unable to get media stream",Object.assign(Object.assign({err:r},this.logData),{kind:e})),!o&&null!=m)try{const t=Object.assign(Object.assign({},i),{streamType:null!=u?u:h.CUSTOM_STREAM_TYPE});yield this._setMediaStreamProvider(e,m,t,!0,!0,!1)}catch(t){this.emitErrorDeprecated(new d.InternalError("Unable to revert media stream: "+e,{}))}throw t}if([n]=r?s.getVideoTracks():s.getAudioTracks(),this.ctx.logger.info("replacing producer track",Object.assign(Object.assign({},this.logData),{kind:e,trackLabel:null==n?void 0:n.label,trackState:null==n?void 0:n.readyState,settings:null!=(null==n?void 0:n.getSettings)?n.getSettings():null,capabilities:null!=(null==n?void 0:n.getCapabilities)?n.getCapabilities():null,constraints:null!=(null==n?void 0:n.getConstraints)?n.getConstraints():null})),null==n)throw this.ctx.logger.error("stream has no tracks of this kind",Object.assign(Object.assign({},this.logData),{kind:e,stream:s})),new Error("Unable to get track");return yield p.replaceTrack({track:n}),p.paused&&(p.resume(),this.call._resumeProducer(p.id,this.streamName)),this.call.emit("CALL_SET_PRODUCER_TRACK",{streamName:this.streamName,streamType:null!==(c=i.streamType)&&void 0!==c?c:h.CUSTOM_STREAM_TYPE,producerId:p.id,track:n}),p}this.ctx.logger.info("cannot replaceTrack, so resetting producer",Object.assign({},this.logData));try{p=yield this._setProducer(e,i,n)}catch(t){this.ctx.logger.warn("unable to set new producer",Object.assign(Object.assign({},this.logData),{kind:e}))}return p}))}_setProducer(e,t,i=!1,o=!1){var c,u,f,b,_,y,w,S,E,C,j,P,R,x,D,T;return r.__awaiter(this,void 0,void 0,(function*(){const r="video"===e;let I;this.checkPermissions(r);try{if(r){o||null==(null===(c=this._videoProducer)||void 0===c?void 0:c.track)||this._videoProducer.track.stop(),null==this._videoStreamProvider&&this.throwErrorDeprecated(new d.RetrievingMediaStreamError("videoStreamProvider is not provided",{streamName:this.logData.streamName,mediaKind:e}));const t=this._videoStreamProvider.source;null==t&&this.throwErrorDeprecated(new d.RetrievingMediaStreamError("videoStreamProvider returned null",{streamName:this.logData.streamName,mediaKind:e})),I=t,this.ctx.logger.debug("retrieve a new video stream",{stream:I})}else{o||null==(null===(u=this._audioProducer)||void 0===u?void 0:u.track)||this._audioProducer.track.stop(),null==this._audioStreamProvider&&this.throwErrorDeprecated(new d.RetrievingMediaStreamError("audioStreamProvider is not provided",{streamName:this.logData.streamName,mediaKind:e}));const t=this._audioStreamProvider.source;null==t&&this.throwErrorDeprecated(new d.RetrievingMediaStreamError("audioStreamProvider returned null",{streamName:this.logData.streamName,mediaKind:e})),I=t,this.ctx.logger.debug("retrieve a new audio stream",{stream:I})}}catch(t){const i=t instanceof Error?t.message:"unknown error";throw this.ctx.logger.warn("Unable to get media stream",Object.assign(Object.assign({err:i},this.logData),{kind:e})),t}let O,k,M=!1;if(r){[O]=I.getVideoTracks();const i={streamName:this.streamName,userId:null===(f=this.call.user)||void 0===f?void 0:f.userId,trackEnabled:null==O?void 0:O.enabled,displayName:null===(b=this.call.user)||void 0===b?void 0:b.displayName};if(r&&n.device.isImplements(a.Feature.SCREEN_ORIENTATION)&&(i.orientation=n.device.screenOrientation),null==O){const t=new Error("stream.getVideoTracks()[0] is undefined");throw this.ctx.logger.warn("Unable to get media track",Object.assign(Object.assign({err:null==t?void 0:t.message},this.logData),{kind:e})),t}if(this._videoProducer&&!o)try{yield this._videoProducer.replaceTrack({track:O}),k=this._videoProducer,M=!0}catch(r){const s=r instanceof Error?r.message:"unknown error";this.ctx.logger.warn("Unable to replace track",Object.assign(Object.assign({err:s},this.logData),{kind:e})),k=yield this.call.createProducer(O,t,i)}else k=yield this.call.createProducer(O,t,i)}else{const i={streamName:this.streamName,userId:null===(_=this.call.user)||void 0===_?void 0:_.userId,displayName:null===(y=this.call.user)||void 0===y?void 0:y.displayName};let r;if(this._useEchoDetection&&null!=(null==g?void 0:g.createMediaStreamSource)&&null!=(null==g?void 0:g.createMediaStreamDestination)&&null!=this._gainNode){g.createMediaStreamSource(I).connect(this._gainNode);const e=g.createMediaStreamDestination();this._gainNode.connect(e),[O]=e.stream.getAudioTracks(),[r]=I.getAudioTracks()}else[O]=I.getAudioTracks();if(null==O){const t=new Error("stream.getAudioTracks()[0] is undefined");throw this.ctx.logger.warn("Unable to get media track",Object.assign(Object.assign({err:null==t?void 0:t.message},this.logData),{kind:e})),t}if(this._audioProducer&&!o)try{yield this._audioProducer.replaceTrack({track:O}),k=this._audioProducer,M=!0}catch(s){const o=s instanceof Error?s.message:"unknown error";this.ctx.logger.warn("Unable to replace track",Object.assign(Object.assign({err:o},this.logData),{kind:e})),k=yield this.call.createProducer(O,t,i),k.appData.parallelTrack=r}else k=yield this.call.createProducer(O,t,i),k.appData.parallelTrack=r}let L=null;if(r)M||(L=this._videoProducer,this._videoProducer=k,p.watchCpuSpikes(new s.LoggerCore(l.PACKAGE_NAME).extend(this.ctx.logger),k),k.on("webrtc-anomaly",);else if(M||(L=this._audioProducer,this._audioProducer=k),this._useEchoDetection)try{this._echoDetector=new m.default(k.track),null===(w=this._echoDetector)||void 0===w||w.on("echo",()=>{var e;this.ctx.logger.debug(`echo detected at ${Date.now()}. Gain at ${null===(e=this._gainNode)||void 0===e?void 0:e.gain.value}`,Object.assign({},this.logData)),this._reduceGain()}),null===(S=this._echoDetector)||void 0===S||S.on("noecho",()=>{var e;this.ctx.logger.debug(`echo stopped at ${Date.now()}. Gain at ${null===(e=this._gainNode)||void 0===e?void 0:e.gain.value}`,Object.assign({},this.logData)),this._restoreGain()})}catch(e){const t=e instanceof Error?e.message:"unknown error";this.ctx.logger.error("unable to set up echo detector",Object.assign({err:t},this.logData))}const A=e=>{this.ctx.logger.debug(e,Object.assign({},this.logData)),null!=k.appData.parallelTrack&&k.appData.parallelTrack.stop();let t="";r&&null!=this._videoProducer?(t=this._videoProducer.id,this._videoProducer=null):null!=this._audioProducer&&(t=this._audioProducer.id,this._audioProducer=null),this.call._closeProducer(t,this.streamName)};return k.once("transportclose",()=>A("producer transportclose")),k.once("trackended",,this.call._closed||(r?(this.call._removeMessage(v.TROUBLESHOOTING.NO_WEBCAM),this.call.emit("CALL_ADD_PRODUCER",{streamerName:this.streamName,producer:{id:k.id,kind:"video",streamName:this.streamName,streamType:null!==(E=t.streamType)&&void 0!==E?E:h.CUSTOM_STREAM_TYPE,paused:k.paused,track:k.track,codec:null!==(P=null===(j=null===(C=k.rtpParameters)||void 0===C?void 0:C.codecs[0])||void 0===j?void 0:j.mimeType.split("/")[1])&&void 0!==P?P:"",preview:i}})):(this.call._removeMessage(v.TROUBLESHOOTING.NO_MIC),this.call.emit("CALL_ADD_PRODUCER",{streamerName:this.streamName,producer:{id:k.id,kind:"audio",streamName:this.streamName,streamType:null!==(R=t.streamType)&&void 0!==R?R:h.CUSTOM_STREAM_TYPE,paused:k.paused,track:k.track,codec:null!==(T=null===(D=null===(x=k.rtpParameters)||void 0===x?void 0:x.codecs[0])||void 0===D?void 0:D.mimeType.split("/")[1])&&void 0!==T?T:"",preview:i}})),this.ctx.logger.debug("producer set",Object.assign(Object.assign({},this.logData),{kind:e,producerId:k.id}))),null==L||L.closed||(L.close(),this.call._closeProducer(L.id,this.streamName)),k}))}disableAudio(){if(null!=this._audioProducer){this.ctx.logger.debug("disableAudio",Object.assign({},this.logData));try{this._audioProducer.close()}catch(e){const t=e instanceof Error?e.message:"unknown error";throw this.ctx.logger.error("unable to close audio producer",Object.assign({err:t},this.logData)),e}this.call._closeProducer(this._audioProducer.id,this.streamName),this._audioProducer=null}else this.ctx.logger.warn("stream.disableAudio: calling disableAudio without an audio producer",Object.assign({},this.logData))}pauseAudio(){null!=this._audioProducer?(this.ctx.logger.debug("pauseAudio",Object.assign({},this.logData)),this._audioProducer.pause(),this.call._pauseProducer(this._audioProducer.id,this.streamName)):this.ctx.logger.warn("stream.pauseAudio: calling pauseAudio without an audio producer",Object.assign({},this.logData))}enableAudio(e={},t=!1,i=!1){var s,o,n;return r.__awaiter(this,void 0,void 0,(function*(){if(this.ctx.logger.debug("enableAudio",Object.assign({},this.logData)),null==this._audioProducer||this._audioProducer.closed||t){if(null==this._audioStreamProvider){const e="no default audio stream retriever";throw this.ctx.logger.error(e,Object.assign({},this.logData)),new Error(e)}try{const t=Object.assign(Object.assign({},e),{streamType:null!==(s=this._videoStreamProviderType)&&void 0!==s?s:h.CUSTOM_STREAM_TYPE});yield this._setProducer("audio",t,i)}catch(e){const t=e instanceof Error?e.message:"unknown error";throw this.ctx.logger.warn("unable to set up audio producer",Object.assign({err:t},this.logData)),e}(null===(n=null===(o=this._audioProducer)||void 0===o?void 0:o.track)||void 0===n?void 0:n.enabled)||this.pauseAudio()}else this._audioProducer.resume(),this.call._resumeProducer(this._audioProducer.id,this.streamName)}))}enableVideo(e={},t=!1,i=!1){var s,o,n;return r.__awaiter(this,void 0,void 0,(function*(){if(this.ctx.logger.debug("enableVideo",Object.assign(Object.assign({},this.logData),{options:e,refresh:t,preview:i})),null==this._videoProducer||this._videoProducer.closed||t){if(null==this._videoStreamProvider){const e="no default video stream retriever";throw this.ctx.logger.error(e,Object.assign({},this.logData)),new Error(e)}try{const t=Object.assign(Object.assign({},e),{streamType:null!==(s=this._videoStreamProviderType)&&void 0!==s?s:h.CUSTOM_STREAM_TYPE});yield this._setProducer("video",t,i)}catch(e){const t=e instanceof Error?e.message:"unknown error";throw this.ctx.logger.warn("unable to set up video producer",Object.assign({err:t},this.logData)),e}(null===(n=null===(o=this._videoProducer)||void 0===o?void 0:o.track)||void 0===n?void 0:n.enabled)||this.pauseVideo()}else this._videoProducer.resume(),this.call._resumeProducer(this._videoProducer.id,this.streamName)}))}disableVideo(){if(null!=this._videoProducer){this.ctx.logger.debug("disableVideo",Object.assign({},this.logData));try{this._videoProducer.close()}catch(e){const t=e instanceof Error?e.message:"unknown error";throw this.ctx.logger.error("unable to close video producer",Object.assign({err:t},this.logData)),e}this.call._closeProducer(this._videoProducer.id,this.streamName),this._videoProducer=null}else this.ctx.logger.warn("stream.disableVideo: calling disable video without a video producer",Object.assign({},this.logData))}pauseVideo(){null!=this._videoProducer?(this.ctx.logger.debug("pauseVideo",Object.assign({},this.logData)),this._videoProducer.pause(),this.call._pauseProducer(this._videoProducer.id,this.streamName)):this.ctx.logger.warn("stream.pauseVideo: calling pause video without a video producer",Object.assign({},this.logData))}hotswapProducer(e,t){var i,s;return r.__awaiter(this,void 0,void 0,(function*(){try{null==t.streamType&&(t.streamType="video"===e?null!==(i=this._videoStreamProviderType)&&void 0!==i?i:h.CUSTOM_STREAM_TYPE:null!==(s=this._audioStreamProviderType)&&void 0!==s?s:h.CUSTOM_STREAM_TYPE),yield this._setProducer("video",t,!1,!0)}catch(i){const r=i instanceof Error?i.message:"unknown error";throw this.ctx.logger.warn("unable to hotswap producer",Object.assign({kind:e,producerOptions:t,err:r},this.logData)),i}}))}_reduceGain(){var e,t;null!=this._gainNode&&(this._gainNode.gain.cancelScheduledValues(null!==(e=null==g?void 0:g.currentTime)&&void 0!==e?e:0),this._gainNode.gain.exponentialRampToValueAtTime(.5,null!==(t=null==g?void 0:g.currentTime)&&void 0!==t?t:0))}_restoreGain(){var e,t;null!=this._gainNode&&null!=this._baseGainValue&&(this._gainNode.gain.cancelScheduledValues(null!==(e=null==g?void 0:g.currentTime)&&void 0!==e?e:0),this._gainNode.gain.exponentialRampToValueAtTime(this._baseGainValue,(null!==(t=null==g?void 0:g.currentTime)&&void 0!==t?t:0)+30))}close(e=!0){null!=this._audioProducer&&(e&&this.call._closeProducer(this._audioProducer.id,this.streamName),this._audioProducer.close(),this._audioProducer=null),null!=this._videoProducer&&(e&&this.call._closeProducer(this._videoProducer.id,this.streamName),this._videoProducer.close(),this._videoProducer=null),null!=this._echoDetector&&(this._echoDetector.close(),this._echoDetector=null)}toJSON(){var e,t;return{audioProducer:null==this.audioProducer?null:{id:this.audioProducer.id,closed:this.audioProducer.closed,paused:this.audioProducer.paused,trackId:null===(e=this.audioProducer.track)||void 0===e?void 0:e.id},videoProducer:null==this.videoProducer?null:{id:this.videoProducer.id,closed:this.videoProducer.closed,paused:this.videoProducer.paused,trackId:null===(t=this.videoProducer.track)||void 0===t?void 0:t.id},aggregates:Object.assign(Object.assign({support:this.ctx.support.hash},(0,o.extractAggregates)(this.call)),{streamName:this.streamName})}}}f.displayName="PvcStream",t.default=f},"./node_modules/@video/video-client-core/lib/internal/pvc/call/transport.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),s=i("./node_modules/@video/video-client-core/lib/internal/errors-deprecated.js"),o=i("./node_modules/@video/video-client-core/lib/internal/utils/debug/instance-collector.js"),n=i("./node_modules/@video/video-client-core/lib/internal/utils/events/event-emitter.js");class a extends n.ObservableEventEmitter{constructor(e,t,i,s,o,n){super(),this.connected=!1,this.connecting=!1,this.closed=!1,this.closing=!1,this.online=r.device.onLine,this._ws=null,this._hasError=!1,this._retryCount=0,this._requestId=0,this._pingTimeout=void 0,this._retry=()=>{},this.wsMessageTime=null,this.wsMessageInterval=void 0,this.shouldReconnect=!1,this.wsMessageSent=!1,this._webpageInactive=!1,this.ctx=e,this.uri=t,this.joinCall=i,this._retries=null!=s?s:1/0,this._handleOffline=()=>{e.logger.debug("Transport: offline detected"),this.online=!1,this.shouldReconnect=!0},this._handleOnline=()=>{e.logger.debug("Transport: online detected",{connected:this.connected,connecting:this.connecting,hasError:this._hasError}),this.online=!0},this._handleVisibilityChange=()=>{r.device.hidden&&(this._webpageInactive=!0)},r.device.addEventListener("offline",this._handleOffline),r.device.addEventListener("online",this._handleOnline),r.device.addEventListener("visibilitychange",this._handleVisibilityChange),e.logger.attachObject(this),e.logger.trace("constructor()"),this._connect(),this.wsMessageInterval=r.device.setInterval(()=>{let e=0;const t=new Date;if(null!=this.wsMessageTime&&this.wsMessageTime.getSeconds()!==t.getSeconds()&&(e=t.getTime()-this.wsMessageTime.getTime()),e/=1e3,!this.online||r.device.hidden)return;(this.shouldReconnect||e>n)&&(o||this._webpageInactive?(this.wsMessageSent=!0,this.log.warn(`Message not received from websocket exceeding ${n} seconds, re-initializing websocket.`),this._emit("websocket-reconnect",this._webpageInactive),this.shouldReconnect=!1,this._webpageInactive=!1):this.wsMessageSent||(this.wsMessageSent=!0,this.log.warn(`Message not received from websocket exceeding ${n} seconds.`),this.shouldReconnect=!1,this._webpageInactive=!1))},1e3),this.addInnerDisposer(}get log(){return this.ctx.logger}request(e,t){if(!this._sendReady())return Promise.resolve(null);this._requestId+=1;const i=this._requestId;return new Promise((r,s)=>{this.once("response-"+i,e=>{var t;if(null!=e.reasons&&e.reasons.length>0){const i=null===(t=e.reasons[0])||void 0===t?void 0:t.text,r=new Error("request error: "+i);s(r)}else r(e)}),this.send("request",{requestId:i,type:e,request:null!=t?t:null})})}send(e,t){if(!this._sendReady(!1,this._ws))return;let i;try{i=JSON.stringify({event:e,data:t})}catch(t){return void this.log.error("websocket send error: unable to serialize date",{event:e,err:(0,s.wrapNativeError)(t)})}try{this._ws.send(i)}catch(t){const r=t instanceof Error?t.message:"unknown error";this.log.error("websocket send error",{event:e,data:i,err:r})}}setClosing(){this.closing=!0}close(e=!0){this.closed=e,this.closed&&(r.device.removeEventListener("offline",this._handleOffline),r.device.removeEventListener("online",this._handleOnline),r.device.removeEventListener("visibilitychange",this._handleVisibilityChange),r.device.clearInterval(this.wsMessageInterval)),null!=this._ws&&(this.log.debug("Transport: close called - closing websocket"),this._ws.close(),o.InstanceCollector.disposeInstance("websocket",this._ws))}_sendReady(e=!1,t=this._ws){return null!=t&&1===(null==t?void 0:t.readyState)||(e||this.log.warn("Transport: trying to sending on a closed websocket",{uri:this.uri,ws:null==t?void 0:t.readyState}),!1)}_onServerRequest(e){const{method:t,requestId:i,request:r}=e.data;if(Number.isNaN(i))return void this.log.error("transport: Invalid request from server",{json:e});this.emit(t,r,(e={},t=null)=>{this.send("response",{requestId:i,response:e,error:t})})}_connect(){this.connecting=!0,null!=this._ws&&(this._ws.onclose=()=>{},this._ws.close(),o.InstanceCollector.disposeInstance("websocket",this._ws),this._ws=null),this._ws=null,this._ws=new WebSocket(this.uri),o.InstanceCollector.reportNewInstance("websocket",this._ws,{file:"call/transport.ts"});const e=Math.random();this.log.debug("Transport: _connect",{id:e}),this._ws.onopen=()=>{this.connected=!0,this.connecting=!1,this._hasError=!1,this._retryCount=0,this.log.debug("Transport: onopen",{id:e}),this._emit("connect")},this._ws.onerror=e=>{this._hasError=!0,this.log.info("websocket error",{uri:this.uri,err:(0,s.wrapNativeError)(e)})},this._ws.onmessage=e=>{var t,i,s,o,n,a,l,d,c;if(this.wsMessageTime=new Date,"pong"===e.data)return void this._pong();if("ping"===e.data||"0"===e.data)return void(null===(t=this._ws)||void 0===t||t.send("pong"));let u;try{u=JSON.parse(e.data)}catch(t){const i=t instanceof Error?t.stack:"unknown error";return void this.log.error("websocket parse error",{data:null==e?void 0:e.data,uri:this.uri,err:i})}if("ping"===u.event)return null===(i=this._ws)||void 0===i||i.send("pong"),void(r.device.isImplements(r.Feature.DEBUGGING)&&r.device.console.debug("websocket pong sent"));if("request"!==u.event){if("callError"===u.event){let t={},i="unknown";try{t=JSON.parse(null==e?void 0:e.data),i=(null===(o=null===(s=null==t?void 0:t.data)||void 0===s?void 0:s.causes)||void 0===o?void 0:o.length)?(null!==(l=null===(a=null===(n=null==t?void 0:t.data)||void 0===n?void 0:n.causes)||void 0===a?void 0:a.map(e=>e.message))&&void 0!==l?l:[]).join("; "):null!==(c=null===(d=null==t?void 0:t.data)||void 0===d?void 0:d.errorMessage)&&void 0!==c?c:"unknown"}catch(e){}this.log.error("Call Error: "+i,{data:t,uri:this.uri,event:u.event}),this.close()}this._emit(u.event,u.data)}else this._onServerRequest(u)},this._ws.onclose=t=>{this.log.info("Transport: websocket close",{code:t.code,uri:this.uri,id:e}),this._emit("disconnect",t.code,"websocket-closed"),r.device.clearTimeout(this._pingTimeout)}}_canRetry(){return this.connecting||this.closed||this.closing?(this.log.debug("Transport: no retry",{online:this.online,connecting:this.connecting,closed:this.closed,closing:this.closing}),!1):!(this._retryCount>this._retries)||(this.log.warn("Transport: limited retries",{uri:this.uri}),this._emit("call-rejected"),!1)}_retryTimeoutLength(){let e=500;return this._retryCount>5&&this._retryCount<15?e=1e3:this._retryCount>=15?e=1e4:this._retryCount>=100&&(e=6e5),e}_joinCall(){this.online||this.connecting||this.closed?this._canRetry()&&(this._retryCount+=1,this.log.debug("Transport: join call"),this.joinCall().then(e=>{var t;let i;if(this.log.debug("Transport: response from joinCall",{response:e}),null==(null===(t=e.body)||void 0===t?void 0:t.call))return this.log.warn("Transport: refreshCall error",{sfuUri:this.uri}),this._emit("join-call-error",{error:"invalid response, call was missing"}),void r.device.setTimeout(this._joinCall.bind(this),this._retryTimeoutLength());i=e.body.call,this._hasError=!1,null!=i.callUri&&this.uri!==i.callUri?(this.log.debug("Transport: call uri changed",{call:i}),this.uri=i.callUri):this.log.debug("Transport: join call did not update call uri"),this._emit("join-refresh",e),this._connect()}).catch(e=>{404!==e.status&&this.log.warn("Transport: refreshCall error",{error:e,sfuUri:this.uri}),this._emit("join-call-error",{error:e}),r.device.setTimeout(this._joinCall.bind(this),this._retryTimeoutLength())})):r.device.setTimeout(this._joinCall.bind(this),500)}_ping(){this._sendReady(!0,this._ws)&&(this._ws.send("ping"),this._pingTimeout=r.device.setTimeout(()=>{this.log.error("Transport: failed ping to server - retry connection"),this._retry(!0)},3e3))}_pong(){r.device.clearTimeout(this._pingTimeout),this.connected&&r.device.setTimeout(this._ping.bind(this),3e3)}_emit(e,...t){try{this.emit(e,...t)}catch(e){const i=e instanceof Error?e.stack:"unknown error";this.log.warn("unhandled event handler error",{event:""+t[0],err:i,uri:this.uri})}}toJSON(){return{aggregates:{support:this.ctx.support.hash,uri:this.uri,online:this.online}}}}t.default=a,a.displayName="Transport"},"./node_modules/@video/video-client-core/lib/internal/pvc/stats/anomalies.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.watchCpuSpikes=void 0;const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),o=i("./node_modules/@video/video-client-core/lib/api/adapter/features/feature.js");t.watchCpuSpikes=function(e,t,i=.25,n=.9,a=15e3){return r.__awaiter(this,void 0,void 0,(function*(){const r=s.device;if(!r.isImplements(o.Feature.CPU_USAGE))return;let l={bitrate:0},d=null;t.on("webrtc-stats",s=>{var o,c;const u=r.averageCpuUsage(a);if(null!=d&&Date.now()-d>3e4){const i="CPU usage is too high for long time",r={cpuUsage:u,cpuUsageDuration:Date.now()-d};e.throttledLog("error",3e4,i,Object.assign(Object.assign({},r),{aggregates:{messageGroup:"webrtc anomaly"}}));const s=Object.assign({message:i},r);t.emit("webrtc-anomaly",s)}r.averageCpuUsage(1e3)>=n?null==d&&(d=Date.now()):d=null;const p=(l.bitrate-(null!==(o=s.videoBitrate)&&void 0!==o?o:0))/l.bitrate;if(p>i&&u>=n){const i=Date.now(),r="Bitrate has been dropped with high CPU usage",s={bitrateDrop:p,cpuUsage:u,cpuUsageDuration:i-(null!=d?d:i)};e.throttledLog("error",3e4,r,Object.assign(Object.assign({},s),{aggregates:{messageGroup:"webrtc anomaly"}}));const o=Object.assign({message:r},s);t.emit("webrtc-anomaly",o)}l={bitrate:null!==(c=s.videoBitrate)&&void 0!==c?c:0}})}))}},"./node_modules/@video/video-client-core/lib/internal/pvc/stats/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StatsCollector=void 0;const r=i("./node_modules/@video/webrtc-stats/index.js"),s=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),o=i("./node_modules/@video/video-client-core/lib/internal/utils/context/context.js"),n=i("./node_modules/@video/video-client-core/lib/internal/utils/events/event-emitter.js");function a(e){if(e.length<2)return 0;let t=0,i=0;return e.forEach((e,r)=>{var s;const o=null!==(s=e.bitrate)&&void 0!==s?s:0;o>i&&(t=r,i=o)}),t}function l(e,t){var i,r,s,o,n,a;const l=null===(i=e.current[t])||void 0===i?void 0:i.inbound[0],d=null===(r=e.previous[t])||void 0===r?void 0:r.inbound[0];if(null==l||null==d)return 0;if(null!=l.fractionLost)return l.fractionLost;const c=null===(o=null===(s=e.current.remote)||void 0===s?void 0:s[t])||void 0===o?void 0:o.outbound[0],u=null===(a=null===(n=e.previous.remote)||void 0===n?void 0:n[t])||void 0===a?void 0:a.outbound[0];if(null==c||null==u)return 0;const p=c.packetsSent-u.packetsSent;let h=0;return null==d.packetsReceived||null==l.packetsReceived?0:void 0!==l.packetsLost?(h=l.packetsLost-d.packetsLost,p>0?h/p:0):0}function d(e,t,i){var r,s,o,n,a,l,d,c;return e?{connection:e.connection,video:{outbound:e.video.outbound.filter(e=>i(e)===t),inbound:e.video.inbound.filter(e=>i(e)===t)},audio:{outbound:e.audio.outbound.filter(e=>i(e)===t),inbound:e.audio.inbound.filter(e=>i(e)===t)},remote:{video:{outbound:null!==(s=null===(r=e.remote)||void 0===r?void 0:r.video.outbound.filter(e=>i(e)===t))&&void 0!==s?s:[],inbound:null!==(n=null===(o=e.remote)||void 0===o?void 0:o.video.inbound.filter(e=>i(e)===t))&&void 0!==n?n:[]},audio:{outbound:null!==(l=null===(a=e.remote)||void 0===a?void 0:a.audio.outbound.filter(e=>i(e)===t))&&void 0!==l?l:[],inbound:null!==(c=null===(d=e.remote)||void 0===d?void 0:d.audio.inbound.filter()&&void 0!==c?c:[]}}}:{connection:null,video:{outbound:[],inbound:[]},audio:{outbound:[],inbound:[]},remote:{video:{outbound:[],inbound:[]},audio:{outbound:[],inbound:[]}}}}function c(e,t,i){const r={},s=function(e,t){const i=new Set,r=e=>{const r=t(e).toString();""!==r&&i.add(r)};return e.video.inbound.forEach(r),e.video.outbound.forEach(r),e.audio.inbound.forEach(r),e.video.outbound.forEach(r),Array.from(i.values())}(e,i);for(const o of s)r[o]={current:d(e,o,i),previous:d(t,o,i)};return r}class u extends n.ObservableEventEmitter{constructor(e,t){super(),(0,o.onceCanceled)(e).then(this.dispose),this.options=t,this.options.interval<1e3&&(this.options.interval=5e3),this.ctx=e,this.webrtcStats=new r.WebRTCStats({getStatsInterval:this.options.interval}),s.device.isImplements(s.Feature.CPU_USAGE)&&s.device.enableCpuStats(),this.addInnerDisposer(}attachTransports(e,t,i){null==i||"recv"===i.direction?null==t||"send"===t.direction?(this.webrtcStats.addPeer({sendTransport:null!=t?t:void 0,recvTransport:null!=i?i:void 0,peerId:e}),this.webrtcStats.removeAllListeners("stats"),this.webrtcStats.on("stats",this.collectStats)):this.ctx.logger.error("Wrong transport direction for a consumer",{direction:t.direction}):this.ctx.logger.error("Wrong transport direction for a consumer",{direction:i.direction})}collectStats(e){if(null==e.peerId)return void this.ctx.logger.warn("peerId not found",{peerId:e.peerId});const t=c(e.data,e.prev,;for(const[,i]of Object.entries(t))(i.current.video.outbound.length>0||i.current.audio.outbound.length>0)&&this.emitProducer(e,i),(i.current.video.inbound.length>0||i.current.audio.inbound.length>0)&&this.emitConsumer(e,i)}emitProducer(e,t){var i,r,o,n,l,d,c,u,p,h,m,v,g,f,b,_,y,w,S,E,C,j,P,R,x,D,T,I,O,k,M,L,A,N,B,U,F,V,H,q,W,G,K,$,z,J,Q,Y;const Z=a(t.current.video.outbound),X=a(t.current.audio.outbound);if(Z!==a(t.previous.video.outbound)||X!==a(t.previous.audio.outbound))return;const ee=null!==(i=t.current.video.outbound[Z])&&void 0!==i?i:{},te=null!==(r=t.current.audio.outbound[X])&&void 0!==r?r:{},ie=null!==(n=null!==(o=ee.appData)&&void 0!==o?o:te.appData)&&void 0!==n?n:{},re=null!==(l=t.previous.video.outbound[Z])&&void 0!==l?l:{},se=null!==(d=t.previous.audio.outbound[X])&&void 0!==d?d:{},oe=null!==(c=ee.framesPerSecond)&&void 0!==c?c:0,ne=null!==(p=null===(u=ee.track)||void 0===u?void 0:u.frameRate)&&void 0!==p?p:0,ae=null!==(m=null===(h=ee.track)||void 0===h?void 0:h.height)&&void 0!==m?m:0,le=null!==(g=null===(v=ee.track)||void 0===v?void 0:v.width)&&void 0!==g?g:0,de=(null!==(f=ee.totalEncodeTime)&&void 0!==f?f:0)-(null!==(b=re.totalEncodeTime)&&void 0!==b?b:0),ce=(null!==(_=ee.totalEncodedBytesTarget)&&void 0!==_?_:0)-(null!==(y=re.totalEncodedBytesTarget)&&void 0!==y?y:0),ue=(null!==(w=te.packetsSent)&&void 0!==w?w:0)-(null!==(S=se.packetsSent)&&void 0!==S?S:0),pe=(null!==(E=ee.packetsSent)&&void 0!==E?E:0)-(null!==(C=re.packetsSent)&&void 0!==C?C:0),he=(null!==(j=te.retransmittedPacketsSent)&&void 0!==j?j:0)-(null!==(P=se.retransmittedPacketsSent)&&void 0!==P?P:0),me=(null!==(R=ee.retransmittedPacketsSent)&&void 0!==R?R:0)-(null!==(x=re.retransmittedPacketsSent)&&void 0!==x?x:0),ve={cpu:s.device.isImplements(s.Feature.CPU_USAGE)?s.device.averageCpuUsage(this.options.interval):0,peerId:null!==(D=e.peerId)&&void 0!==D?D:"NA",callId:this.options.callId,userId:null!==(T=this.options.userId)&&void 0!==T?T:"NA",displayName:null!==(I=this.options.displayName)&&void 0!==I?I:"NA",streamName:ie.streamName,studioId:ie.studioId,kind:"producer",localCandidate_networkType:null!==(M=null===(k=null===(O=t.current.connection)||void 0===O?void 0:O.local)||void 0===k?void 0:k.networkType)&&void 0!==M?M:"NA",transport_transportStatus:null!==(A=null===(L=t.current.connection)||void 0===L?void 0:L.state)&&void 0!==A?A:"NA",videoFrameHeight:null!==(N=ee.frameHeight)&&void 0!==N?N:0,videoFrameWidth:null!==(B=ee.frameWidth)&&void 0!==B?B:0,videoFramesPerSecond:oe,videoBitrate:null==ee.bitrate||ee.bitrate<0?0:Math.trunc(ee.bitrate),audioBitrate:null==te.bitrate||te.bitrate<0?0:Math.trunc(te.bitrate),videoPacketSendDelay:(null!==(U=ee.totalPacketSendDelay)&&void 0!==U?U:0)-(null!==(F=re.totalPacketSendDelay)&&void 0!==F?F:0),videoRetransmittedPacketsSent:pe?me/pe*1e5:0,videoMediaSourceFrameHeight:null!==(H=null===(V=ee.track)||void 0===V?void 0:V.height)&&void 0!==H?H:0,videoMediaSourceFrameWidth:null!==(W=null===(q=ee.track)||void 0===q?void 0:q.width)&&void 0!==W?W:0,videoMediaSourceFramesPerSecond:ne,videoOutboundRtpQualityLimitationReason:null!==(G=null==ee?void 0:ee.qualityLimitationReason)&&void 0!==G?G:"NA",videoOutboundRtpQualityLimitationResolutionChanges:(null!==(K=ee.qualityLimitationResolutionChanges)&&void 0!==K?K:0)-(null!==($=re.qualityLimitationResolutionChanges)&&void 0!==$?$:0),videoCalculationFpsSourceToOutput:ne>0?oe/ne:0,videoCalculationHeightSourceToOutput:ae>0?(null!==(z=ee.frameHeight)&&void 0!==z?z:0)/ae:0,videoCalculationWidthSourceToOutput:le>0?(null!==(J=ee.frameWidth)&&void 0!==J?J:0)/le:0,videoOutboundRtpEncodeTime:de/(this.options.interval/1e3),videoOutboundRtpEncodedBytesTarget:ce/(this.options.interval/1e3),audioPacketSendDelay:(null!==(Q=te.totalPacketSendDelay)&&void 0!==Q?Q:0)-(null!==(Y=se.totalPacketSendDelay)&&void 0!==Y?Y:0),audioRetransmittedPacketsSent:ue?he/ue*1e5:0};this.emit("webrtc-stats-raw",t),this.emit("webrtc-stats",ve)}emitConsumer(e,t){var i,r,o,n,d,c,u,p,h,m,v,g,f,b,_,y,w,S,E,C,j,P,R,x,D,T,I,O,k,M,L,A,N,B;const U=a(t.current.video.inbound),F=a(t.current.audio.inbound);if(U!==a(t.previous.video.inbound)||F!==a(t.previous.audio.inbound))return;const V=null!==(i=t.current.video.inbound[U])&&void 0!==i?i:{},H=null!==(r=t.current.audio.inbound[F])&&void 0!==r?r:{},q=null!==(n=null===(o=t.current.remote)||void 0===o?void 0:o.video.outbound[U])&&void 0!==n?n:{},W=null!==(c=null===(d=t.current.remote)||void 0===d?void 0:d.audio.outbound[F])&&void 0!==c?c:{},G=null!==(p=null!==(u=V.appData)&&void 0!==u?u:H.appData)&&void 0!==p?p:{},K=null!==(h=V.framesPerSecond)&&void 0!==h?h:0,$={cpu:s.device.isImplements(s.Feature.CPU_USAGE)?s.device.averageCpuUsage(this.options.interval):0,peerId:null!==(m=e.peerId)&&void 0!==m?m:"NA",callId:this.options.callId,userId:null!==(v=this.options.userId)&&void 0!==v?v:"NA",displayName:null!==(g=this.options.displayName)&&void 0!==g?g:"NA",streamName:G.streamName,studioId:G.studioId,kind:"consumer",localCandidate_networkType:null!==(_=null===(b=null===(f=t.current.connection)||void 0===f?void 0:f.local)||void 0===b?void 0:b.networkType)&&void 0!==_?_:"NA",transport_transportStatus:null!==(w=null===(y=t.current.connection)||void 0===y?void 0:y.state)&&void 0!==w?w:"NA",videoFrameHeight:null!==(S=V.frameHeight)&&void 0!==S?S:0,videoFrameWidth:null!==(E=V.frameWidth)&&void 0!==E?E:0,videoFramesPerSecond:K,videoBytesReceived:null!==(C=V.bytesReceived)&&void 0!==C?C:0,videoBitrate:null==V.bitrate||V.bitrate<0?0:Math.trunc(V.bitrate),audioBitrate:null==H.bitrate||H.bitrate<0?0:Math.trunc(H.bitrate),producingUserId:G.userId,producingPeerId:G.peerId,videoFractionLost:l(t,"video"),videoRoundTripTime:null!==(D=null!==(x=null!==(P=null===(j=t.current.connection)||void 0===j?void 0:j.currentRoundTripTime)&&void 0!==P?P:null===(R=t.current.connection)||void 0===R?void 0:R.currentRtt)&&void 0!==x?x:q.roundTripTime)&&void 0!==D?D:0,audioBytesReceived:null!==(T=H.bytesReceived)&&void 0!==T?T:0,audioFractionLost:l(t,"audio"),audioRoundTripTime:null!==(L=null!==(M=null!==(O=null===(I=t.current.connection)||void 0===I?void 0:I.currentRoundTripTime)&&void 0!==O?O:null===(k=t.current.connection)||void 0===k?void 0:k.currentRtt)&&void 0!==M?M:W.roundTripTime)&&void 0!==L?L:0,audioJitter:null!==(A=H.jitter)&&void 0!==A?A:0,audioPacketsReceived:null!==(N=H.packetsReceived)&&void 0!==N?N:0,audioPacketsLost:null!==(B=H.packetsLost)&&void 0!==B?B:0};this.emit("webrtc-stats-raw",t),this.emit("webrtc-stats",$)}}t.StatsCollector=u,u.displayName="StatsCollector"},"./node_modules/@video/video-client-core/lib/internal/utils/auth/auth-core.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultOptions=void 0;const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("./node_modules/events/events.js")),o=r.__importDefault(i("./node_modules/@video/video-client-core/node_modules/deepmerge/dist/cjs.js")),n=i("./node_modules/@video/log-client/index.js"),a=r.__importDefault(i("./node_modules/@video/video-client-core/lib/package-json.js")),l=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),d=i("./node_modules/@video/video-client-core/lib/utils/common.js");t.defaultOptions={timeout:3e4,headers:{Accept:"application/json"}};class c extends s.default{constructor(e){var i,r,s,u,p,h,m,v;super(),this._stopped=!1,this._fatalError=null,this._token=null,this._retry=0,this._retries=[0,200,1e3,3e3],this._autorefresh=null,this._url=null;const g=null!==(i=null==e?void 0:e.logger)&&void 0!==i?i:new n.LoggerCore("VDC-core");null==e||delete e.logger;const f=null!==(s=null===(r=null==e?void 0:e.loggerConfig)||void 0===r?void 0:r.clientName)&&void 0!==s?s:"VDC",b=g.getLoggerMeta("client"),_=g.getLoggerMeta("release"),y=g.getLoggerMeta("package");if(g.setLoggerMeta("package",null!=y&&"VDC-core"!==y?y+"/VDC-core":"VDC-core").setLoggerMeta("client",null!=b?`${b}/${f}`:f).setLoggerMeta("release",null!=_?`${_}/${a.default.version}`:a.default.version).setLoggerMeta("commitHash",a.default.commit).setLoggerMeta("contextId",null!==(u=(0,d.contextId)())&&void 0!==u?u:"").setLoggerMeta("instanceId",null!==(p=(0,d.instanceId)())&&void 0!==p?p:"").appendChain(c),this.logger=g,this.options=(0,o.default)(t.defaultOptions,e),null!=e.endpoint||null!=(null==e?void 0:e.bootstrap)){if(null!=(null===(h=this.options.bootstrap)||void 0===h?void 0:h.token)&&(this._token=this.options.bootstrap.token,this.logger.setMessageAggregate("token",null!==(m=this._token)&&void 0!==m?m:"undefined"),this.logger.info("auth token set from bootstrap value")),this._headers=this.options.headers,null==this._token)this._retryRequest();else if(null!=(null===(v=this.options.bootstrap)||void 0===v?void 0:v.expire)){const e=this.options.bootstrap.expire.getTime()-Date.now()-6e4;this._autorefresh=l.device.setTimeout(e)}}else this.validationError("endpoint or bootstrap must be configured for auth")}validationError(e){const t=new Error(e);this._fatalError=t,this._stopped=!0,this.logger.error(e,{errName:null==t?void 0:t.name,errStack:null==t?void 0:t.stack})}destroy(){this._stopped=!0}request(e){if(this._fatalError)return void e(this._fatalError);if(null!=this._token)return this.logger.debug("existing token returned on token request"),void e(null,this._token);const t=()=>{this.removeListener("fatal",i),l.device.clearTimeout(r),this.logger.debug("new token returned on token request"),e(null,this._token)},i=()=>{this.removeListener("token",t),l.device.clearTimeout(r),this.logger.debug("new token returned on token request"),e(this._fatalError)},r=l.device.setTimeout(()=>{this.removeListener("token",t),this.removeListener("fatal",i),this.logger.info("token request timeout"),e(new Error("authorization: timeout"))},this.options.timeout);this.once("token",t),this.once("fatal",i)}refreshToken(e){var t;return this.logger.debug("refreshToken called",{token:e}),null==e&&null==this._token?(this.logger.debug("no token to refresh"),!1):null!=e?(this._token=e,this.logger.setMessageAggregate("token",null!==(t=this._token)&&void 0!==t?t:"undefined"),this.logger.info("token manually set from refreshToken"),this._fatalError=null,null!=this._autorefresh&&(l.device.clearTimeout(this._autorefresh),this._autorefresh=null),!0):!this._fatalError&&(null!=this._token&&(null!=this._autorefresh&&(l.device.clearTimeout(this._autorefresh),this._autorefresh=null),this._token=null,this.logger.removeMessageAggregate("token"),(()=>{this._retryRequest()})()),!0)}ensureToken(e){null!=this._token?e():this.once("token",}_parseJSON(e){return e.text().then(e=>{if(e)try{return JSON.parse(e)}catch(e){}return{}})}_retryRequest(){const e=this._retries[this._retry];e?setTimeout(()=>{this._makeRequest()},e):this._makeRequest()}tokenSuccess(e){this._token=e,this.logger.setMessageAggregate("token",this._token),this._retry=0,setTimeout(}_makeRequest(){var e,t,i;return r.__awaiter(this,void 0,void 0,(function*(){if(null!=(null===(t=null===(e=this.options)||void 0===e?void 0:e.bootstrap)||void 0===t?void 0:t.refreshToken))try{const e=yield this.options.bootstrap.refreshToken();return this._tokenSuccess(e),void this.logger.info("token set from async bootstrap refreshToken")}catch(e){return void(e instanceof Error&&(this._fatalError=e,this.logger.warn("unable to refresh token from bootstrap function",{errName:null==e?void 0:e.name,errStack:null==e?void 0:e.stack}),this.emit("fatal")))}if(null==(null===(i=this.options)||void 0===i?void 0:i.endpoint))throw new Error("authorization: no ability to refresh token (boostrap or endpoint)");-1===this.options.endpoint.uri.indexOf("?")?this._url=`${this.options.endpoint.uri}?scope=${this.options.endpoint.scope}`:this._url=`${this.options.endpoint.uri}&scope=${this.options.endpoint.scope}`,this._handleFetch()}))}_handleFetch(){return r.__awaiter(this,void 0,void 0,(function*(){if(null!=this._url)try{const e=yield l.device.fetch(this._url,{credentials:"same-origin",headers:this._headers});this._handleFetchResponse(e)}catch(e){if(this._token=null,this.logger.removeMessageAggregate("token"),e instanceof TypeError)return this._fatalError=e,this.logger.error(e.message,{errName:null==e?void 0:e.name,errStack:null==e?void 0:e.stack}),void this.emit("fatal");this.logger.network("unable to refresh token from endpoint",{}),this._retryRequest(),this._retry<this._retries.length-1&&this._retry++}}))}_handleFetchResponse(e){if(!(e.status>=200&&e.status<300)){var t;if(401===e.status){throw new Error("authorization: unauthorized")}if(403===e.status){throw new Error("authorization: forbidden")}throw new Error("authorization: non-200 response code from auth server")}{const i=this._parseJSON(e);if(!(t=i,void 0===t.token&&void 0===t.expire||(null!=(null==i?void 0:i.token)&&(this._tokenSuccess(i.token),this.logger.info("token set from request response")),null==(null==i?void 0:i.expire)))){const e=new Date(i.expire).getTime()-Date.now()-6e4;this._autorefresh=l.device.setTimeout(()=>{this._autorefresh=null,this._stopped||(this.logger.info("refreshing token before expiration"),this._retryRequest())},e)}}}}c.displayName="Authorization",t.default=c},"./node_modules/@video/video-client-core/lib/internal/utils/bind.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeBounded=void 0;const r=i("./node_modules/tslib/tslib.es6.js").__importStar(i("./node_modules/stacktrace-js/stacktrace.js")),s=i("./node_modules/@video/video-client-core/lib/internal/errors-deprecated.js"),o=i("./node_modules/@video/video-client-core/lib/internal/utils/debug.js");const n=new WeakMap;function a(e,t){return function(...i){var r;if("object"==typeof e&&e.isDisposed){const i=n.get(e),a=null==i?"":(0,o.formatStacktrace)(i),l=new s.DisposedObjectError("call on the disposed object",{className:null!==(r=e.constructor.displayName)&&void 0!==r?r:e.constructor.name,method:t.name});if("object"!=typeof e.ctx||"object"!=typeof e.ctx.logger||"function"!=typeof e.ctx.logger.error)throw l;e.ctx.logger.error(l.message,{err:l,target:e.name,method:t.name,stacktrace:a})}return t.apply(e,i)}}function l(e,t){return function(...i){return r.get().then(,t.apply(e,i)}}t.makeBounded=function(e,t=[],i=!1){var r,s,o;if(null==e||"object"!=typeof e)throw new Error("bindMethods works only on objects");const n=function(e){let t={},i=e;for(;null!=i&&i!==Object.prototype;)t=Object.assign(Object.assign({},Object.getOwnPropertyDescriptors(i)),t),i=Object.getPrototypeOf(i);return t}(e),d=Object.keys(n).filter(;for(const t of d){const d=Object.getOwnPropertyDescriptor(e,t),c=n[t].value;if("function"==typeof c&&"constructor"!==t&&(null==d||d.configurable)){let n=c.bind(e);i&&(n="dispose"===t?l(e,c):a(e,c)),Object.defineProperty(e,t,{value:n,configurable:null===(r=null==d?void 0:d.configurable)||void 0===r||r,enumerable:null!==(s=null==d?void 0:d.writable)&&void 0!==s&&s,writable:null!==(o=null==d?void 0:d.writable)&&void 0!==o&&o})}}return e}},"./node_modules/@video/video-client-core/lib/internal/utils/browser-support/browser.js":(e,t,i)=>{"use strict";var r=i("./node_modules/process/browser.js");Object.defineProperty(t,"__esModule",{value:!0}),t.getNetworkConnectionType=t.isMobileDevice=t.isIosDevice=t.isChrome=t.isSafari=t.isFirefox=t.supportsMediasoupWebrtc=t.supportsFlvHttp=t.supportsNativeHls=t.supportsMp4=t.supportsHlsjs=t.H264_CAPABILITY=t.OPUS_CAPABILITY=t.VP8_CAPABILITY=void 0;const s=i("./node_modules/tslib/tslib.es6.js"),o=i("./node_modules/@video/log-client/index.js"),n=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/index.js"),a=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),l=i("./node_modules/@video/video-client-core/lib/internal/utils/support/index.js"),d=i("./node_modules/@video/video-client-core/lib/mocks/mediasoup-client-device.js");t.VP8_CAPABILITY={clockRate:9e4,kind:"video",mimeType:"video/VP8"},t.OPUS_CAPABILITY={channels:2,clockRate:48e3,kind:"audio",mimeType:"audio/opus"},t.H264_CAPABILITY={clockRate:9e4,kind:"video",mimeType:"video/H264",parameters:{"packetization-mode":1}};t.supportsHlsjs=e=>{var i,r;if(!a.device.isImplements(a.Feature.HLSJS))return null==e||e.info("HlsJsPlayer is NOT supported"),!1;if(a.device.isImplements(a.Feature.BROWSER_TYPE)){if((0,t.isSafari)(a.device.browserInfo))return null==e||e.info("HlsJsPlayer is NOT supported in Safari, use Native Hls player instead",Object.assign(Object.assign({},a.device.browserInfo),{platform:a.device.platform})),!1;if("windows"===a.device.browserInfo.osname&&"chrome"===a.device.browserInfo.name&&parseInt(null!==(i=a.device.browserInfo.version)&&void 0!==i?i:"0",10)<52)return null==e||e.info("HlsJsPlayer is NOT supported",Object.assign(Object.assign({},a.device.browserInfo),{platform:a.device.platform})),!1;if(!a.device.isImplements(a.Feature.MEDIA_SOURCE)||!(null===(r=a.device.MediaSource)||void 0===r?void 0:r.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')))return null==e||e.info("HlsJsPlayer is NOT supported",Object.assign(Object.assign({},a.device.browserInfo),{platform:a.device.platform})),!1;null==e||e.debug("HlsJsPlayer is supported",Object.assign(Object.assign({},a.device.browserInfo),{platform:a.device.platform}))}return!0};t.supportsMp4=e=>{var t,i,r;return a.device.isImplements(a.Feature.BROWSER_TYPE)?"safari"===a.device.browserInfo.name&&parseInt(null!==(t=a.device.browserInfo.version)&&void 0!==t?t:"0",10)<10||"ie"===a.device.browserInfo.name?(null==e||e.info("MP4Player is NOT supported",Object.assign(Object.assign({},a.device.browserInfo),{platform:a.device.platform})),!1):("chrome"!==a.device.browserInfo.name||parseInt(null!==(i=a.device.browserInfo.version)&&void 0!==i?i:"0",10)>49)&&a.device.isImplements(a.Feature.WEB_SOCKET)&&a.device.isImplements(a.Feature.MEDIA_SOURCE)&&a.device.isImplements(a.Feature.MEDIA_DEVICE)&&a.device.isImplements(a.Feature.LOCAL_STORAGE)&&a.device.isImplements(a.Feature.DEBUGGING)&&a.device.isImplements(a.Feature.BROWSER_TYPE)&&(null===(r=a.device.MediaSource)||void 0===r?void 0:r.isTypeSupported('video/mp4; codecs="avc1.4d4028,mp4a.40.2"'))?(null==e||e.debug("MP4Player is supported",Object.assign(Object.assign({},a.device.browserInfo),{platform:a.device.platform})),!0):(null==e||e.info("MP4Player is NOT supported",Object.assign(Object.assign({},a.device.browserInfo),{platform:a.device.platform})),!1):(null==e||e.debug("MP4Player is NOT supported."),!1)};t.supportsNativeHls=e=>{if(!a.device.isImplements(a.Feature.BROWSER_TYPE))return null==e||e.debug("NativeHlsPlayer is NOT supported."),!1;if(!a.device.isIosDevice&&!a.device.isSafari)return null==e||e.debug("NativeHlsPlayer is NOT supported on non Safari browsers outside of iOS"),!1;if(!a.device.isImplements(a.Feature.CREATE_VIDEO_ELEMENT))return null==e||e.info("NativeHlsPlayer is NOT supported"),!1;const t=a.device.createVideoElement();return!((t)||"probably"!==t.canPlayType("application/vnd.apple.mpegURL")&&"maybe"!==t.canPlayType("application/vnd.apple.mpegURL")?(null==e||e.info("NativeHlsPlayer is NOT supported",Object.assign(Object.assign({},a.device.browserInfo),{platform:a.device.platform})),!1):(null==e||e.debug("NativeHlsPlayer is supported",Object.assign(Object.assign({},a.device.browserInfo),{platform:a.device.platform})),!0)};t.supportsFlvHttp=e=>s.__awaiter(void 0,void 0,void 0,(function*(){var t,i;if(!a.device.isImplements(a.Feature.BROWSER_TYPE))return null==e||e.debug("FlvHttpPlayer is NOT supported."),!1;if(a.device.isSafari)return null==e||e.debug("FlvHttpPlayer is NOT supported on non Safari browsers"),!1;if(a.device.isImplements(a.Feature.MPEGTS)){yield a.device.loadMpegtsScript();const r=null!==(i=null===(t=a.device.mpegts)||void 0===t?void 0:t.isSupported())&&void 0!==i&&i;return r||null==e||e.info("FlvHttpPlayer is NOT supported"),r}return null==e||e.debug("NativeHlsPlayer is supported",Object.assign(Object.assign({},a.device.browserInfo),{platform:a.device.platform})),!0}));t.supportsMediasoupWebrtc=(e,i)=>s.__awaiter(void 0,void 0,void 0,(function*(){const s=new l.Support(i?new o.LoggerCore("VDC-core").extend(i):new o.LoggerCore("VDC-core"));yield s.ready;if(!s.supports("h264"))return!1;if(!a.device.isImplements(a.Feature.MEDIA_STREAM))return null==i||i.info(e+" is NOT supported"),!1;const c=[t.OPUS_CAPABILITY];a.device.isAndroidDevice?c.push(t.VP8_CAPABILITY):c.push(t.H264_CAPABILITY);try{let t;t=null!=r.env.TEST?new d.MockMediasoupClientDevice:new n.Device,yield t.load({routerRtpCapabilities:{codecs:c}});const s={audio:t.canProduce("audio"),video:t.canProduce("video")};if(a.device.isImplements(a.Feature.BROWSER_TYPE)){if(!t.canProduce("audio")||!t.canProduce("video"))return null==i||i.info(e+" is NOT supported",Object.assign({browserInfo:a.device.browserInfo,avSupport:s,platform:a.device.platform})),!1;null==i||i.debug(e+" is supported",Object.assign({browserInfo:a.device.browserInfo,avSupport:s,platform:a.device.platform}))}return!0}catch(t){return a.device.isImplements(a.Feature.BROWSER_TYPE)?null==i||i.info(e+" is NOT supported",Object.assign(Object.assign({},a.device.browserInfo),{platform:a.device.platform})):null==i||i.info(e+" is NOT supported",{platform:a.device.platform}),!1}}));t.isFirefox=e=>a.device.isImplements(a.Feature.BROWSER_TYPE)&&"firefox"===a.device.browserInfo.name;t.isSafari=e=>a.device.isImplements(a.Feature.BROWSER_TYPE)&&"safari"===a.device.browserInfo.name;t.isChrome=e=>a.device.isImplements(a.Feature.BROWSER_TYPE)&&"chrome"===a.device.browserInfo.name;t.isIosDevice=()=>a.device.isIosDevice;t.isMobileDevice=t.getNetworkConnectionType=function(){var e,t;let i="information unavailable",r="information unavailable";return a.device.isImplements(a.Feature.NETWORK_INFORMATION)&&((null===(e=null===a.device||void 0===a.device?void 0:a.device.connection)||void 0===e?void 0:e.type)&&(i=a.device.connection.type),(null===(t=null===a.device||void 0===a.device?void 0:a.device.connection)||void 0===t?void 0:t.effectiveType)&&(r=a.device.connection.effectiveType)),[i,r]}},"./node_modules/@video/video-client-core/lib/internal/utils/browser-support/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});i("./node_modules/tslib/tslib.es6.js").__exportStar(i("./node_modules/@video/video-client-core/lib/internal/utils/browser-support/browser.js"),t)},"./node_modules/@video/video-client-core/lib/internal/utils/context/context.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onceCanceled=t.cancel=t.walk=t.context=t.NullContext=t.cancelFuncKey=t.cancelPromiseKey=t.canceledKey=t.childrenKey=t.idKey=void 0;const r=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js");t.idKey=Symbol("id"),t.childrenKey=Symbol("children"),t.canceledKey=Symbol("canceled"),t.cancelPromiseKey=Symbol("cancelPromise"),t.cancelFuncKey=Symbol("cancelFunc");let s=1;function o(e,i=[],r=!1){for(const s of e[t.childrenKey])o(s,i,r);return r&&e[t.childrenKey].splice(0,e[t.childrenKey].length),i.push(e),i}t.NullContext={[t.idKey]:0,[t.childrenKey]:[],[t.canceledKey]:!1,[t.cancelPromiseKey]:Promise.resolve("null context"),[t.cancelFuncKey]:()=>{}},t.context=function(e,i=t.NullContext){const r=i===t.NullContext?{}:i,o=Object.assign(Object.assign(Object.assign({},r),e),{[t.idKey]:s++,[t.childrenKey]:[],[t.canceledKey]:!1,[t.cancelFuncKey]:()=>{}});return o[t.cancelPromiseKey]=new Promise(.then(,null!=r[t.childrenKey]&&(r[t.childrenKey].push(o),r[t.canceledKey]&&o[t.cancelFuncKey]("parent context is canceled")),o},t.walk=o,t.cancel=function(e,i="not specified"){if(e[t.canceledKey])return;const s=o(e,[],!0);for(const e of s)r.device.setTimeout(()=>{e[t.cancelFuncKey](i),e[t.canceledKey]=!0},0)},t.onceCanceled=,"./node_modules/@video/video-client-core/lib/internal/utils/context/vc-context.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hasVcContext=void 0,t.hasVcContext=function(e){if("object"!=typeof e||!("ctx"in e))return!1;const t=e.ctx;return"object"==typeof t&&"object"==typeof t.logger&&"object"==typeof t.support&&"object"==typeof t.videoClient}},"./node_modules/@video/video-client-core/lib/internal/utils/debug.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.startMobxDebugging=t.formatStacktrace=t.filterStacktrace=void 0;const r=i("./node_modules/mobx/dist/mobx.esm.js"),s=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),o=/.*(bootstrap.*|node_modules.*|disposable\.ts)$/;function n(e){var t;const i=e.split("/");let r=null;for(;"src"!==r&&i.length>1;)r=null!==(t=i.shift())&&void 0!==t?t:null;return"src"===r&&i.unshift(r),"/"+i.join("/")}function a(e){return e.filter(.map(e=>{var t;return Object.assign(Object.assign({},e),{fileName:n(null!==(t=e.fileName)&&void 0!==t?t:"<unknown>")})})}t.filterStacktrace=a,t.formatStacktrace=function(e,t=!0){return t?a(e).map(.join("\n"):e.map(.join("\n")};const l=["name","type","spyReportStart","debugObjectName","observableKind"];t.startMobxDebugging=function(){const e=s.device.isImplements(s.Feature.LOCAL_STORAGE)?s.device.localStorage.getItem("mobxDebug"):"";if("true"===e||"flat"===e){const t="flat"!==e,i=s.device.globals.get("mobxSpyDisposer");"function"==typeof i&&i();const o=(0,r.spy)(e=>{var i,r;let s=e.type,o=null!==(i=e.name)&&void 0!==i?i:"";switch(s){case"action":"object"==typeof e.object&&(o=`${e.object.constructor.name}.${o}`);break;case"add":case"delete":case"create":case"remove":case"splice":case"update":o=null!==(r=null==e.name?e.debugObjectName:`${e.debugObjectName}.${e.name}`)&&void 0!==r?r:""}o.startsWith("event:")&&(s="event "+s,o=o.slice(6)),e.observableKind&&(o=`${e.observableKind} ${o}`);const n=Object.entries(e).filter(;if(e.spyReportStart)t?(console.groupCollapsed(s,o),console.groupCollapsed("stacktrace"),console.trace(),console.groupEnd()):console.log("%c"+e.type,"font-weight: bold",o,Object.fromEntries(n));else{if("report-end"===e.type)return void(t&&console.groupEnd());console.log("%c"+e.type,"font-weight: bold",o)}t&&n.length>0&&console.log(Object.fromEntries(n))});s.device.globals.set("mobxSpyDisposer",o)}}},"./node_modules/@video/video-client-core/lib/internal/utils/debug/instance-collector.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InstanceCollector=void 0;const r=i("./node_modules/@video/events-typed/index.js");class s extends r.EventEmitter{constructor(e){super(),this.options=e,this.objects=new Map,this.metas=new WeakMap,this.isDisposed=!1,s.instances.add(this);for(const t of e.classes)this.objects.set(t,new Set)}nsertObject(e,t,i){this.objects.get(e).add(t),null!=i&&this.metas.set(t,i),t instanceof r.EventEmitter&&t.once("disposed",()=>this.objects.get(e).delete(t))}removeObject(e,t){var i;null===(i=this.objects.get(e))||void 0===i||i.delete(t),this.metas.delete(t)}static reportNewInstance(e,t,i){for(const r of s.instances.values())r.doesCollect(e)&&r.insertObject(e,t,i)}static disposeInstance(e,t){for(const i of s.instances.values())i.removeObject(e,t)}getObjects(e){return this.objects.has(e)?Array.from(this.objects.get(e).values()).map(e=>{var t;return[e,null!==(t=this.metas.get(e))&&void 0!==t?t:{}]}):[]}dispose(e){this.isDisposed=!0,s.instances.delete(this),this.emit("disposed")}}t.InstanceCollector=s,s.instances=new Set,"object"==typeof i.g&&null!=i.g&&(i.g._VDC_InstanceCollector=s)},"./node_modules/@video/video-client-core/lib/internal/utils/debug/play-logs.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dumpVideoElement=void 0;const r=i("./node_modules/@video/video-client-core/lib/api/typings/video-element.js");t.dumpVideoElement=function(e){var t,i,s,o;if(null==e)return{};const n={playDebugHasSrcObject:null!=e.srcObject,playDebugMuted:e.muted,playDebugPaused:e.paused,playDebugHeight:e.videoHeight,playDebugWidth:e.videoWidth,playDebugAutoplay:e.autoplay,playDebugReadyState:e.readyState,playDebugPlaysInLineAttr:null!==(t=e.getAttribute("playsinline"))&&void 0!==t?t:"undefined",playDebugWebkitPlaysInLineAttr:null!==(i=e.getAttribute("webkit-playsinline"))&&void 0!==i?i:"undefined"};return(0,r.isMediaStream)(e.srcObject)&&(n.playDebugHasAudioTrack=(null===(s=e.srcObject)||void 0===s?void 0:s.getAudioTracks().length)>0,n.playDebugHasVideoTrack=(null===(o=e.srcObject)||void 0===o?void 0:o.getVideoTracks().length)>0),n}},"./node_modules/@video/video-client-core/lib/internal/utils/dispose.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.disposeObjects=void 0;const r=i("./node_modules/@video/video-client-core/node_modules/@video/log-node/index.js"),s=i("./node_modules/@video/video-client-core/lib/internal/utils/context/context.js"),o=i("./node_modules/@video/video-client-core/lib/internal/utils/context/vc-context.js");t.disposeObjects=function(e,t,i){var n;const a=e.constructor,l=null!==(n=null==a?void 0:a.displayName)&&void 0!==n?n:a.name;e.isDisposed||((0,o.hasVcContext)(e)&&(e.ctx.logger.trace("dispose() "+i,{aggregates:{reason:i}}),(0,s.cancel)(e.ctx,`${l} disposed: ${i}`)),t.forEach(t=>{try{t(`${l} inner disposer: ${i}`)}catch(t){(0,o.hasVcContext)(e)&&e.ctx.logger.error("error in dispose logic",{object:(0,r.isSerializableObject)(e)?e:""+e,className:l,err:""+t,reason:i})}}),t.splice(0,t.length))}},"./node_modules/@video/video-client-core/lib/internal/utils/events/event-emitter.js":(e,t,i)=>{"use strict";var r,s;Object.defineProperty(t,"__esModule",{value:!0}),t.ObservableEventEmitter=void 0;const o=i("./node_modules/@video/events-typed/index.js"),n=i("./node_modules/mobx/dist/mobx.esm.js"),a=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),l=i("./node_modules/@video/video-client-core/lib/internal/errors-deprecated.js"),d=i("./node_modules/@video/video-client-core/lib/internal/utils/bind.js"),c=i("./node_modules/@video/video-client-core/lib/internal/utils/context/context.js"),u=i("./node_modules/@video/video-client-core/lib/internal/utils/context/vc-context.js"),p=i("./node_modules/@video/video-client-core/lib/internal/utils/dispose.js");function h(e,t){return(0,n.isObservableProp)(e,t)||(0,n.isComputedProp)(e,t)}const m=Symbol("Emitter"),v=Symbol("Observers");t.ObservableEventEmitter=class{constructor(e=!0){this[r]=new o.EventEmitter,this[s]=new Map,this.disposers=[],this.disposed=!1,this.disposing=!1,e&&(0,d.makeBounded)(this,[],!1)}startEmitting(e){if(this[v].has(e))return;const t=this[m].emit.bind(this[m],e),i=(0,n.reaction)(function(e,t){return()=>e[t]}(this,e),t,{name:`event:${this.constructor.name}.${String(e)}`});this[v].set(e,i)}tMaxListeners(){return this[m].getMaxListeners()}addListener(e,t){return this[m].addListener(e,t),h(this,e)&&this.startEmitting(e),this}emit(e,t,...i){return this[m].emit(e,t,...i)}off(e,t){return this[m].off(e,t),0===o.EventEmitter.listenerCount(this[m],e)&&this.stopEmitting(e),this}on(e,t){return this[m].on(e,t),h(this,e)&&this.startEmitting(e),this}once(e,t){return this[m].once(e,t),h(this,e)&&this.startEmitting(e),this}prependListener(e,t){return this[m].prependListener(e,t),h(this,e)&&this.startEmitting(e),this}prependOnceListener(e,t){return this[m].prependOnceListener(e,t),h(this,e)&&this.startEmitting(e),this}removeAllListeners(e){this[m].removeAllListeners(e);for(const e of this[v].keys())this.stopEmitting(e);return this}removeListener(e,t){return this[m].removeListener(e,t),0===o.EventEmitter.listenerCount(this[m],e)&&this.stopEmitting(e),this}addInnerDisposer(...e){for(const t of e)"function"==typeof t?this.disposers.unshift(t):this.disposers.unshift(t.dispose.bind(t))}et isDisposed(){return this.disposed}emitError(e){this[m].emit("error",e),!e.isMuted&&(0,u.hasVcContext)(this)&&l.VideoClientErrorDeprecated.log(e,this.ctx.logger)}throwError(e){throw this.emitError(e),e}mitErrorDeprecated(e){try{this[m].emit("error",e),e.critical&&this.dispose("due error: "+e.code)}catch(t){(0,u.hasVcContext)(this)?this.ctx.logger.error("error handler throws another error",{err:e,handlerErr:(0,l.wrapNativeError)(t)}):a.device.isImplements(a.Feature.DEBUGGING)&&a.device.console.error("error handler throws another error",{err:e,handlerErr:t})}}dispose(e="not provided"){this.disposed||this.disposing||(this.disposing=!0,(0,p.disposeObjects)(this,this.disposers,e),this.removeAllListeners(),(0,u.hasVcContext)(this)&&(0,c.cancel)(this.ctx),this.disposed=!0,this.emit("disposed"))}},r=m,s=v},"./node_modules/@video/video-client-core/lib/internal/utils/index.js":"./node_modules/@video/video-client-core/lib/internal/utils/logger.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extendContext=t.isNamedClass=void 0;const r=i("./node_modules/@video/log-client/index.js"),s=i("./node_modules/@video/video-client-core/lib/utils/common.js"),o=i("./node_modules/@video/video-client-core/lib/internal/utils/context/context.js");t.isNamedClass=function(e){return"string"==typeof Reflect.get(e,"displayName")},t.extendContext=function(e,t){return(0,o.context)({logger:new r.LoggerCore(s.PACKAGE_NAME).extend(e.logger).appendChain(t),chain:`${e.chain}:${t.displayName}`},e)}},"./node_modules/@video/video-client-core/lib/internal/utils/proxy/events-handler.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventsHandler=t.originalTarget=t.removeProxy=t.addProxy=t.emitterMethods=void 0;const i=["disposed"];.emitterMethods=new Map(Object.entries({addListener:"addListener",on:"addListener",prependListener:"prependListener",removeListener:"removeListener",off:"removeListener"})),t.addProxy=Symbol("AddProxy"),t.removeProxy=Symbol("RemoveProxy"),t.originalTarget=Symbol("originalTarget");t.EventsHandler=class{etOrCreateEvent(e){let t=this.proxyEvents.get(e);return null==t&&(t=[],this.proxyEvents.set(e,t)),t}addProxy(e,t){var i,s;if(r(e)&&r(t)){const i=e.getMaxListeners();t.getMaxListeners()<i&&t.setMaxListeners(i)}for(const r of null!==(i=this.proxyEvents.get(e))&&void 0!==i?i:[])t.addListener(r.type,r.listener);t.once("disposed",this.removeProxy.bind(this,e,t)),this.proxies.has(e)||this.proxies.set(e,new Set),null===(s=this.proxies.get(e))||void 0===s||s.add(t)}removeProxy(e,t){var i;for(const r of null!==(i=this.proxyEvents.get(e))&&void 0!==i?i:[])t.removeListener(r.type,r.listener);const r=this.proxies.get(e);null!=r&&r.delete(t)}addListener(e,t,r){var s;const o=null!==(s=this.proxies.get(e))&&void 0!==s?s:[];if(this.getOrCreateEvent(e).push({type:t,listener:r}),e.addListener(t,r),!i.includes(t))for(const e of o)e.addListener(t,r)}prependListener(e,t,r){var s;const o=null!==(s=this.proxies.get(e))&&void 0!==s?s:[];if(this.getOrCreateEvent(e).unshift({type:t,listener:r}),e.prependListener(t,r),!i.includes(t))for(const e of o)e.prependListener(t,r)}removeListener(e,t,r){var s;const o=null!==(s=this.proxies.get(e))&&void 0!==s?s:[],n=this.getOrCreateEvent(e);for(let e=0;e<n.length;e++)t===n[e].type&&r===n[e].listener&&n.splice(e,1);if(e.removeListener(t,r),!i.includes(t))for(const e of o)e.removeListener(t,r)}get(e,i,r){if(i===t.originalTarget)return e;if(i===t.addProxy)return this.addProxy.bind(this,e);if(i===t.removeProxy)return this.removeProxy.bind(this,e);if(t.emitterMethods.has(i)){const r=t.emitterMethods.get(i);if(null!=r)return this[r].bind(this,e)}return Reflect.get(e,i,r)}}},"./node_modules/@video/video-client-core/lib/internal/utils/proxy/sync-handler.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncHandler=t.implementation=void 0;const r=i("./node_modules/@video/events-typed/index.js"),s=i("./node_modules/@video/log-client/index.js"),o=i("./node_modules/mobx/dist/mobx.esm.js"),n=i("./node_modules/@video/video-client-core/lib/internal/utils/logger.js"),a=i("./node_modules/@video/video-client-core/lib/internal/utils/proxy/events-handler.js");class l{et wrapper(){const e=this,t=return Object.defineProperty(t,"name",{value:String(this.key)+"SyncWrapper"}),t}get fn(){return this._fn}set fn(e){this._fn=e,null!=e&&(this.stack.forEach(([t,i,r,s])=>{e.apply(t,i).then(r,s)}),this.stack.splice(0,this.stack.length))}postpone(e,t){return new Promise((i,r)=>{this.stack.push([e,t,i,r])})}apply(e,t){return null!=this.fn?this.fn.apply(e,t):this.postpone(e,t)}}t.implementation=Symbol("implementation");class d extends a.EventsHandler{constructor(e={}){var t;super(),this.options=e,this.implementation=new WeakMap,this.syncProperties=new WeakMap,this.logger=null!==(t=e.logger)&&void 0!==t?t:new s.LoggerCore("SyncHandler")}sync(e,t,i,r){var s;if(null!=r&&"postpone"===Reflect.get(null!==(s=this.options.methods)&&void 0!==s?s:{},i))return void(t.method.fn=Reflect.get(r,i));null!=r&&t.changed&&Reflect.set(r,i,t.val),this.updateReaction(e,t,i,r);const o=null==r?void 0:Reflect.get(r,i);t.changed||t.val===o||(t.val=o,t.atom.reportChanged())}updateReaction(e,t,i,r){var s;null===(s=t.disposer)||void 0===s||s.call(t),delete t.disposer,null!=r&&(t.disposer=(0,o.reaction)(()=>Reflect.get(r,i),{name:"proxy:"+String(i)}))}propBecomeObservable(e,t){var i,r;const s=this.getOrCrateMeta(e,t);this.updateReaction(e,s,t,null!==(r=null===(i=this.implementation.get(e))||void 0===i?void 0:i.impl)&&void 0!==r?r:null)}propBecomeUnobservable(e,t){var i;const r=this.getOrCrateMeta(e,t);null===(i=r.disposer)||void 0===i||i.call(r),delete r.disposer}getOrCrateMeta(e,t){var i,r,s;this.syncProperties.has(e)||this.syncProperties.set(e,new Map);let n=null===(i=this.syncProperties.get(e))||void 0===i?void 0:i.get(t);if(null==n){const i=null===(r=this.implementation.get(e))||void 0===r?void 0:r.impl,a=null==i?void 0:(0,o.untracked)(;n={val:a,atom:(0,o.createAtom)("proxy:"+String(t),this.propBecomeObservable.bind(this,e,t),this.propBecomeUnobservable.bind(this,e,t)),changed:!1,method:new l(t,null!=a?a:null)},null===(s=this.syncProperties.get(e))||void 0===s||s.set(t,n)}return n}getObservedProp(e,t){const i=this.getOrCrateMeta(e,t);return i.atom.reportObserved(),i.val}deleteObservedProp(e,t){var i;const r=this.getOrCrateMeta(e,t),s=null===(i=this.implementation.get(e))||void 0===i?void 0:i.impl;return r.val=null==s?void 0:Reflect.get(s,t),r.changed=!1,r.atom.reportObserved(),r.val}reportObservedProp(e,t,i){const r=this.getOrCrateMeta(e,t);r.val=i,r.changed=!0,r.atom.reportChanged()}getObservableImplementation(e){let t=this.implementation.get(e);return null==t&&(t={atom:(0,o.createAtom)("proxy:implementation"),impl:null,sentWarn:!1},this.implementation.set(e,t)),t.atom.reportObserved()||0!==r.EventEmitter.listenerCount(e,"implementation")||t.sentWarn||(t.sentWarn=!0),t.impl}setImplementation(e,t){var i,r,s;for(const[s,o]of null!==(r=null===(i=this.syncProperties.get(e))||void 0===i?void 0:i.entries())&&void 0!==r?r:[])this.sync(e,o,s,t);let n=this.implementation.get(e);null==n&&(n={impl:null,atom:(0,o.createAtom)("proxy:implementation"),sentWarn:!1},this.implementation.set(e,n)),null!=n.impl&&(null===(s=n.impl)||void 0===s||s.emit("detached"),super.removeProxy(e,n.impl)),null!=t&&super.addProxy(e,t),n.impl=t,n.atom.reportChanged(),e.emit("implementation"),null!=t&&(null==t||t.emit("attached"))}getImplMethod(e,t){var i;const r=null===(i=this.implementation.get(e))||void 0===i?void 0:i.impl;if(null!=r){const e=Reflect.get(r,t);if(null!=e&&"function"==typeof e)return e}}get(e,i,r){if(i===a.originalTarget)return e;if(i===t.implementation)return this.getObservableImplementation(e);if(a.emitterMethods.has(i)){const t=a.emitterMethods.get(i);if(null!=t)return this[t].bind(this,e)}if(null!=this.options.methods&&i in this.options.methods){const t=this.getImplMethod(e,i);switch(this.options.methods[i]){case"stub":return null!=t?t:()=>{};case"optional":return t;case"strict":if(null==t)throw new Error(`No implementations of method '${String(i)}' found`);return t;case"postpone":return this.getOrCrateMeta(e,i).method.wrapper}}return Reflect.has(e,i)?Reflect.get(e,i,r):this.getObservedProp(e,i)}set(e,i,r,s){if(i===t.implementation)return(0,o.runInAction)(,!0;if(Reflect.has(e,i)){if(!Reflect.set(e,i,r,s)){const t=(0,n.isNamedClass)(e.constructor)?e.constructor.displayName:e.constructor.name;this.logger.warn(`Property '${String(i)}' of class '${t}' is not writable`)}return!0}this.reportObservedProp(e,i,r);const a=this.implementation.get(e);if(null!=(null==a?void 0:a.impl)){if(!Reflect.set(a.impl,i,r)){const e=(0,n.isNamedClass)(a.impl.constructor)?a.impl.constructor.displayName:a.impl.constructor.name;this.logger.warn(`Property '${String(i)}' of class '${e}' is not writable`)}return!0}return!0}deleteProperty(e,i){return i===t.implementation?(this.setImplementation(e,null),!0):Reflect.has(e,i)?Reflect.deleteProperty(e,i):(this.deleteObservedProp(e,i),!0)}}t.SyncHandler=d},"./node_modules/@video/video-client-core/lib/internal/utils/request/auth.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=e=>new Promise((t,i)=>{e.request((e,r)=>{null==e&&null!=r?t(r):i(e)})})},"./node_modules/@video/video-client-core/lib/internal/utils/request/request.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("./node_modules/@video/video-client-core/node_modules/qs/lib/index.js")),o=i("./node_modules/@video/video-client-core/lib/internal/errors-deprecated.js"),n=r.__importDefault(i("./node_modules/@video/video-client-core/lib/internal/utils/request/auth.js")),a=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),l={Accept:"application/json","Content-Type":"application/json"},d={headers:{},failoverUrls:[],reauth:!1,method:"get",warnStatuses:[],callId:""};t.default=(e,t,i)=>r.__awaiter(void 0,void 0,void 0,(function*(){var c,u,p,h;const m=Object.assign(Object.assign({},d),i);if(null!=i.auth&&"function"!=typeof i.auth.refreshToken)throw e.logger.error("auth must be a Authorization object"),new Error("auth must be a Authorization object");const v=null!==(c=m.auth)&&void 0!==c?c:null,g=null!==(u=m.headers)&&void 0!==u?u:{},f=Object.assign(Object.assign({},l),g);let b=t,_=null!==(h=null===(p=m.failoverUrls)||void 0===p?void 0:p.slice())&&void 0!==h?h:[],y=_.length>0;const w=()=>{if(null==_[0])throw new Error("Failover URL is undefined");[b]=_,_=_.slice(1),y=_.length>0},S=(t=!1)=>r.__awaiter(void 0,void 0,void 0,(function*(){var r,l;let d=null;if(null!=v){i.reauth&&v.refreshToken();try{d=yield(0,n.default)(v)}catch(t){const i=t instanceof Error?t.message:"unknown error";throw e.logger.warn("Authorization error",{err:i}),t}}const c={method:null!==(r=i.method)&&void 0!==r?r:"get",headers:null!=d?Object.assign(Object.assign({},f),{Authorization:"bearer "+d}):f};if(null!=i.body&&(c.body=i.body),null!=i.query){const e=s.default.stringify(i.query);b=b.includes("?")?`${b}&${e}`:`${b}?${e}`}let u,p;try{u=yield a.device.fetch(b,c)}catch(i){const r=i instanceof Error?i.message:"unknown error";if(e.logger.warn("Unable to reach server",{useUrl:b,err:r}),!t&&y)return w(),S(0===_.length);throw i}if(204===u.status)return null;try{p=yield u.json()}catch(i){let r;try{r=yield u.text()}catch(e){}if(e.logger.warn("Unexpected non-json response from server",{useUrl:b,body:r,statusCode:u.status}),!t&&y)return w(),S(0===_.length);throw i}if(401===u.status||403===u.status){if(null!=v&&!t&&v.refreshToken())return S(!0);throw e.logger.warn("Authorization error from server",{useUrl:b,status:u.status,reasons:null==p?void 0:p.reasons}),new o.NetworkError("Authorization error from server",{status:u.status})}if(null!=i.expectedStatus&&u.status!==i.expectedStatus||200!==u.status){y||(null===(l=i.warnStatuses)||void 0===l?void 0:l.includes(u.status))?e.logger.warn("Unexpected response code from server",{useUrl:b,status:u.status,reasons:null==p?void 0:p.reasons}):e.logger.error("Unexpected response code from server",{useUrl:b,status:u.status,reasons:null==p?void 0:p.reasons});const r=new o.NetworkError("Unexpected response code from server",{status:u.status});if(!t&&y)return w(),S(0===_.length);throw r}return{authToken:d,body:p}}));return S()}))},"./node_modules/@video/video-client-core/lib/internal/utils/retry.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.retry=void 0;const r=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),s=i("./node_modules/@video/video-client-core/lib/internal/errors-deprecated.js");t.retry=function(e,t,i,o){return new Promise((n,a)=>{let l=0;const d=()=>{i(l).then(n).catch(i=>{++l<e?(null==o||o.warn(`retrying ${l} time(s)`,{err:(0,s.wrapNativeError)(i)}),r.device.setTimeout(d,t)):a(i)})};d()})}},"./node_modules/@video/video-client-core/lib/internal/utils/stats/events.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={AUTOPLAY_PROGRESS:"autoplay-first-progress",FIRST_LOAD:"first-load",MANIFEST_LOAD:"manifest-load",HLSJS_INIT:"hlsjs-init",M3U8_MANIFEST_LOAD:"m3u8-manifest-load",INDEX_MANIFEST_LOAD:"index-manifest-load",INITIAL_FRAGMENT_LOAD:"initial-fragment-load",JOIN_CALL_ENDPOINT:"join-call-endpoint",SFU_CONNECTION:"sfu-connection",VIDEO_CONSUMER:"video-consumer",FIRST_TIME_UPDATE:"first-time-update"}},"./node_modules/@video/video-client-core/lib/internal/utils/stats/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.STATS_EVENTS=t.stats=void 0;const r=i("./node_modules/tslib/tslib.es6.js").__importDefault(i("./node_modules/@video/video-client-core/lib/internal/utils/stats/events.js"));t.STATS_EVENTS=r.default;const s=new(i("./node_modules/@video/video-client-core/lib/internal/utils/stats/stats.js").Stats);t.stats=s},"./node_modules/@video/video-client-core/lib/internal/utils/stats/stats.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Stats=void 0;t.Stats=class{tart(e){this.eventCounter+=1;const t=this.eventCounter;return this.timings[t]={ms:Date.now(),name:e},t}stop(e,t){var i,r;const s=null===(i=this.timings[e])||void 0===i?void 0:i.ms;if(null==s)return{};const o=null!==(r=Object.assign({},t))&&void 0!==r?r:{};return o.ms=Date.now()-s,delete this.timings[e],o}}},"./node_modules/@video/video-client-core/lib/internal/utils/support/codecs.js":(e,t,i)=>{"use strict";var r=i("./node_modules/process/browser.js");Object.defineProperty(t,"__esModule",{value:!0}),t.hasH264=t.hasVP8=t.getGlobalDocument=t.hasOpus=t.hasH264Capability=t.hasVP8Capability=t.hasOpusCapability=t.checkCapabilitiesForRoom=void 0;const s=i("./node_modules/tslib/tslib.es6.js"),o=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/index.js"),n=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),a=i("./node_modules/@video/video-client-core/lib/api/adapter/features/feature.js"),l=i("./node_modules/@video/video-client-core/lib/internal/utils/browser-support/index.js"),d=i("./node_modules/@video/video-client-core/lib/mocks/mediasoup-client-device.js");function c(e){return s.__awaiter(this,void 0,void 0,(function*(){try{let t;return t=null!=r.env.TEST?new d.MockMediasoupClientDevice:new o.Device,yield t.load({routerRtpCapabilities:e}),{audio:t.canProduce("audio"),video:t.canProduce("video")}}catch(e){throw new Error("current browser/device not supported: "+e)}}))}t.checkCapabilitiesForRoom=c;t.hasOpusCapability=e=>s.__awaiter(void 0,void 0,void 0,(function*(){const t=n.device.isImplements(a.Feature.BROWSER_TYPE)?Object.assign(Object.assign({},n.device.browserInfo),{platform:n.device.platform}):{platform:n.device.platform};let i;try{i=yield c({codecs:[l.OPUS_CAPABILITY]})}catch(i){const r=i instanceof Error?i.message:"unknown error";return null==e||e.warn("support: no opus capabilities support",{logInfo:t,err:r}),!1}return i.audio?(null==e||e.debug("support: have opus capabilities support",{logInfo:t}),!0):(null==e||e.warn("support: no opus capabilities support",{logInfo:t}),!1)}));t.hasVP8Capability=e=>s.__awaiter(void 0,void 0,void 0,(function*(){const t=n.device.isImplements(a.Feature.BROWSER_TYPE)?Object.assign(Object.assign({},n.device.browserInfo),{platform:n.device.platform}):{platform:n.device.platform};let i;try{i=yield c({codecs:[l.VP8_CAPABILITY]})}catch(i){const r=i instanceof Error?i.message:"unknown error";return null==e||e.warn("support: no vp8 capabilities support",{logInfo:t,err:r}),!1}return i.video?(null==e||e.debug("support: have vp8 capabilities support",{logInfo:t}),!0):(null==e||e.warn("support: no vp8 capabilities support",{logInfo:t}),!1)}));t.hasH264Capability=e=>s.__awaiter(void 0,void 0,void 0,(function*(){const t=n.device.isImplements(a.Feature.BROWSER_TYPE)?Object.assign(Object.assign({},n.device.browserInfo),{platform:n.device.platform}):{platform:n.device.platform};let i;try{i=yield c({codecs:[l.H264_CAPABILITY]})}catch(i){const r=i instanceof Error?i.message:"unknown error";return null==e||e.warn("support: no h264 capabilities support",{logInfo:t,err:r}),!1}return i.video?(null==e||e.debug("support: have h264 capabilities support",{logInfo:t}),!0):(null==e||e.warn("support: no h264 capabilities support",{logInfo:t}),!1)}));t.hasOpus=()=>!0;t.getGlobalDocument=()=>globalThis.document;t.hasVP8=()=>{try{if(null==(0,t.getGlobalDocument)())return!0}catch(e){return!0}return!n.device.isImplements(a.Feature.BROWSER_TYPE)||"ios"!==n.device.browserInfo.osname&&"safari"!==n.device.browserInfo.name&&"edge"!==n.device.browserInfo.name&&"microsoft edge"!==n.device.browserInfo.name};t.hasH264=e=>{try{if(null==(0,t.getGlobalDocument)())return!0}catch(e){return!0}if(n.device.isImplements(a.Feature.BROWSER_TYPE)&&"chrome"===n.device.browserInfo.name){if(!n.device.isImplements(a.Feature.MEDIA_RECORDER))return null==e||e.flush(),!1;if(n.device.MediaRecorder.isTypeSupported("video/webm; codecs=h264"))return null==e||e.debug("support: h264 support: chrome"),!0;null==e||e.warn("support: no h264 support",Object.assign(Object.assign({reason:"chrome without h264"},n.device.browserInfo),{platform:n.device.platform}))}return n.device.isAndroidDevice?(n.device.isImplements(a.Feature.BROWSER_TYPE)?null==e||e.warn("support: no h264 support",Object.assign(Object.assign({reason:"android device"},n.device.browserInfo),{platform:n.device.platform})):null==e||e.warn("support: no h264 support",{reason:"android device",platform:n.device.platform}),!1):n.device.isImplements(a.Feature.MEDIA_DEVICE)&&n.device.isCodecSupported("h264")}},"./node_modules/@video/video-client-core/lib/internal/utils/support/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.videoSupported=t.Support=t.supportsChromeiOSCheck=t.iosVersion=void 0;const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/index.js"),o=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),n=i("./node_modules/@video/video-client-core/lib/api/adapter/features/feature.js"),a=r.__importStar(i("./node_modules/@video/video-client-core/lib/internal/utils/support/codecs.js"));function l(){const e=(0,t.iosVersion)();return!(!o.device.isImplements(n.Feature.BROWSER_TYPE)||null==o.device.browserInfo.version||"ios"!==o.device.browserInfo.osname||"chrome"!==o.device.browserInfo.name)&&(null!=e&&(e[0]>14||14===e[0]&&e[1]>=3))}t.iosVersion=()=>{if(null!=o.device.platform&&/iP(hone|od|ad)/.test(o.device.platform)&&null!=o.device.appVersion){const e=o.device.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);if(e)return[parseInt(e[1],10),parseInt(e[2],10)]}return null},t.supportsChromeiOSCheck=l;class d{constructor(e,t){this.log=e,null!=t&&this.log.setMessageAggregate("create",t),this.supportTags={opus:!1,vp8:!1,h264:!1};const i=null!=t?t:this.buildLocalSupportHashSync();i.includes("o")&&(this.supportTags.opus=!0),i.includes("v")&&(this.supportTags.vp8=!0),i.includes("h")&&(this.supportTags.h264=!0),this.ready=this.buildLocalSupportHashAsync().then(e=>{e.includes("o")&&(this.supportTags.opus=!0),e.includes("v")&&(this.supportTags.vp8=!0),e.includes("h")&&(this.supportTags.h264=!0)})}t audio(){return this.supportTags.opus}et hashhared(e){if(!this.any)return this;if(!e.any)return e;const t=this.hash;let i="";return e.hash.split("").forEach(e=>{t.includes(e)&&(i+=e)}),new d(this.log,i)}basicSupport(){var e,t;if("ReactNative"===o.device.platform)return!0;const i=o.device.isImplements(n.Feature.BROWSER_TYPE)?Object.assign(Object.assign({},o.device.browserInfo),{platform:o.device.platform}):{platform:o.device.platform};if(null==(0,s.detectDevice)())return this.log.warn("support: mediasoups says device is unsupported",{logInfo:i}),this.log.flush(),!1;if(!o.device.isImplements(n.Feature.MEDIA_DEVICE))return this.log.warn("support: no RTCPeerConnection",{logInfo:i}),this.log.flush(),!1;if(o.device.isImplements(n.Feature.BROWSER_TYPE)){const i=l();if("ios"===o.device.browserInfo.osname&&!["safari","ios"].includes(null!==(e=o.device.browserInfo.name)&&void 0!==e?e:"")&&!i)return"chrome"===o.device.browserInfo.name?this.log.warn("support: ios chrome support is only available on versions >= 14.3",Object.assign({},o.device.browserInfo)):this.log.warn("support: non-safari ios",Object.assign({},o.device.browserInfo)),this.log.flush(),!1;if(null!=o.device.browserInfo.name&&/edge/.test(o.device.browserInfo.name)&&!o.device.isImplements(n.Feature.WEBRTC))return this.log.warn("support: msedge with missing webrtc api",Object.assign({hasRTCRtpReceiver:null==(null===o.device||void 0===o.device?void 0:o.device.RTCRtpReceiver)?"false":"true",hasRTCRtpSender:null==(null===o.device||void 0===o.device?void 0:o.device.RTCRtpSender)?"false":"true",hasRTCRtpReceiverGetCapabilities:null!=(null===(t=null===o.device||void 0===o.device?void 0:o.device.RTCRtpReceiver)||void 0===t?void 0:t.getCapabilities)?"true":"false"},o.device.browserInfo)),this.log.flush(),!1}return o.device.isImplements(n.Feature.MEDIA_DEVICE)}buildLocalSupportHashSync(){const e=o.device.isImplements(n.Feature.BROWSER_TYPE)?Object.assign(Object.assign({},o.device.browserInfo),{platform:o.device.platform}):{platform:o.device.platform};if(!this.basicSupport())return"";let t="";return a.hasOpus()&&(t=t.concat("o")),a.hasVP8()&&(t=t.concat("v")),a.hasH264(this.log)&&(t=t.concat("h")),this.log.setLoggerAggregate("supportHash",t),this.log.debug("support: support hash generated",{logInfo:e}),t}buildLocalSupportHashAsync(){return r.__awaiter(this,void 0,void 0,(function*(){const e=o.device.isImplements(n.Feature.BROWSER_TYPE)?Object.assign(Object.assign({},o.device.browserInfo),{platform:o.device.platform}):{platform:o.device.platform};if(!this.basicSupport())return"";let t="";return(yield a.hasOpusCapability(this.log))&&(t=t.concat("o")),(yield a.hasVP8Capability(this.log))&&(t=t.concat("v")),(yield a.hasH264Capability(this.log))&&(t=t.concat("h")),""!==t&&this.log.setLoggerAggregate("supportHash",t),this.log.debug("support: support hash generated",{logInfo:e}),t}))}}t.Support=d,d.displayName="Support",t.videoSupported=,"./node_modules/@video/video-client-core/lib/internal/utils/timeupdate-wrapper.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TimeupdateWrapper=void 0;t.TimeupdateWrapper=class{constructor(){this.paused=!1,this.handlersMap=new WeakMap,this.pauseUpdates=()=>{this.paused=!0},this.resumeUpdates=()=>{this.paused=!1}}wrap(e,t){var i;null==this.handlersMap.get(e)&&this.handlersMap.set(e,[]);const r=this.handle.bind(this,t);null===(i=this.handlersMap.get(e))||void 0===i||i.push(r),e.addEventListener("timeupdate",r),e.addEventListener("vdc:timeupdatePause",this.pauseUpdates),e.addEventListener("vdc:timeupdateResume",this.resumeUpdates)}handlenwrap(e){var t;for(const i of null!==(t=this.handlersMap.get(e))&&void 0!==t?t:[])e.removeEventListener("timeupdate",i),e.removeEventListener("vdc:timeupdatePause",this.pauseUpdates),e.removeEventListener("vdc:timeupdateResume",this.resumeUpdates)}}},"./node_modules/@video/video-client-core/lib/internal/utils/uuid.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uuidv4=void 0,t.uuidv4=,"./node_modules/@video/video-client-core/lib/internal/video-client.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VideoClient=void 0;const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/@video/log-client/index.js"),o=i("./node_modules/mobx/dist/mobx.esm.js"),n=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),a=i("./node_modules/@video/video-client-core/lib/api/manifest.js"),l=r.__importDefault(i("./node_modules/@video/video-client-core/lib/package-json.js")),d=i("./node_modules/@video/video-client-core/lib/utils/common.js"),c=i("./node_modules/@video/video-client-core/lib/internal/call.js"),u=i("./node_modules/@video/video-client-core/lib/internal/errors.js"),p=i("./node_modules/@video/video-client-core/lib/internal/errors-deprecated.js"),h=i("./node_modules/@video/video-client-core/lib/internal/media-controller.js"),m=r.__importDefault(i("./node_modules/@video/video-client-core/lib/internal/media-loader.js")),v=i("./node_modules/@video/video-client-core/lib/internal/mediasoup-source.js"),g=i("./node_modules/@video/video-client-core/lib/internal/player/manifest.js"),f=i("./node_modules/@video/video-client-core/lib/internal/player/mediasoup.js"),b=i("./node_modules/@video/video-client-core/lib/internal/utils/bind.js"),_=i("./node_modules/@video/video-client-core/lib/internal/utils/context/context.js"),y=i("./node_modules/@video/video-client-core/lib/internal/utils/events/event-emitter.js"),w=i("./node_modules/@video/video-client-core/lib/internal/utils/logger.js"),S=i("./node_modules/@video/video-client-core/lib/internal/utils/proxy/events-handler.js"),E=i("./node_modules/@video/video-client-core/lib/internal/utils/support/index.js"),C=i("./node_modules/@video/video-client-core/lib/internal/utils/browser-support/index.js"),j={autoPlay:!0,refetch:!1,displayPoster:"preview",players:[{id:"webrtc"},{id:"native-hls"},{id:"hlsjs"}],muted:!1,volume:.5,driverFailoverSeconds:10,pollingInterval:5e3,unauthorizedPollingInterval:2e3,notFoundPollingInterval:1e4,unauthorizedRecoveryDuration:1e4,retryCall:!0,urlParams:{vdc:!0,substitute:!1}},P=new S.EventsHandler;class R extends y.ObservableEventEmitter{constructor(e){var t,i,r,a,c,u,p;super(!1),this.options={backendEndpoints:[]},this.setMaxListeners(20);const h=null!==(t=null==e?void 0:e.logger)&&void 0!==t?t:new s.LoggerCore("VDC-core");null==e||delete e.logger;const m=null!==(r=null===(i=null==e?void 0:e.loggerConfig)||void 0===i?void 0:i.clientName)&&void 0!==r?r:"VDC",v=h.getLoggerMeta("client"),g=h.getLoggerMeta("release"),f=h.getLoggerMeta("package"),y=n.device.isImplements(n.Feature.NETWORK_INFORMATION)?null===(a=null===n.device||void 0===n.device?void 0:n.device.connection)||void 0===a?void 0:a.type:"information unavailable",[w,S]=(0,C.getNetworkConnectionType)();h.setLoggerMeta("package",null!=f&&"VDC-core"!==f?f+"/VDC-core":"VDC-core").setLoggerMeta("client",null!=v?`${v}/${m}`:m).setLoggerMeta("release",null!=g?`${g}/${l.default.version}`:l.default.version).setLoggerMeta("commitHash",l.default.commit).setLoggerMeta("contextId",null!==(c=(0,d.contextId)())&&void 0!==c?c:"").setLoggerMeta("instanceId",null!==(u=(0,d.instanceId)())&&void 0!==u?u:"").appendChain(R).setMessageAggregate("displayName",null==e?void 0:e.displayName).setMessageAggregate("networkConnection",y).setMessageAggregate("networkConnectionType",w).setMessageAggregate("networkConnectionEffectiveType",S);const j=new E.Support(new s.LoggerCore("VDC-core").extend(h).appendChain(E.Support));this.ctx=(0,_.context)({logger:h,videoClient:this,statsDebugLogs:null===(p=null==e?void 0:e.stats)||void 0===p?void 0:p.debugLogs,support:j,chain:R.displayName}),(0,o.makeObservable)(this,{requestPlayer:o.action});const x=(0,b.makeBounded)(new Proxy(this,P));return x.init(e),h.trace("constructor()",{backendEndpoints:null==e?void 0:e.backendEndpoints}),x}init(e){var t;null!=(null==e?void 0:e.autoPlay)&&null!=(null==e?void 0:e.playerOptions)&&null==(null===(t=null==e?void 0:e.playerOptions)||void 0===t?void 0:t.autoPlay)&&(e.playerOptions.autoPlay=e.autoPlay),this.updateOptions(e),this.on("error",}pdateOptions(e){if(null==e)return;const t=R.validateOptions(e);null!=t.logger&&(this.ctx.logger.warn("using `logger` in updateOptions() is not allowed"),delete t.logger),this.options=Object.assign(Object.assign({},this.options),t)}callSupported(){return r.__awaiter(this,void 0,void 0,(function*(){return yield this.ctx.support.ready,this.ctx.support.supports("h264")||this.ctx.support.supports("vp8")}))}createCall(e){var t,i;return r.__awaiter(this,void 0,void 0,(function*(){yield this.ctx.support.ready;const{backendEndpoints:r,token:s}=this.options;(yield this.callSupported())||this.throwError((0,u.createError)(u.ErrorCode.H264NotSupported,"h264 is not supported",{})),null==r&&this.throwError((0,u.createError)(u.ErrorCode.NoBackendEndpoints,"backendEndpoints is not provided",{}));const o=new c.Call((0,w.extendContext)(this.ctx,c.Call),!0,{token:s,backendEndpoints:r,sfu:Object.assign({},null!==(t=e.sfu)&&void 0!==t?t:{}),stats:null!==(i=e.stats)&&void 0!==i?i:this.options.stats,playerOptions:this.options.playerOptions,clientReferrer:e.clientReferrer,streamKey:e.streamKey});return this[S.addProxy](o),o.ready()}))}joinCall(e,t={}){return r.__awaiter(this,void 0,void 0,()}internalJoinCall(e,t={},i=this.ctx,s=null){var o;return r.__awaiter(this,void 0,void 0,(function*(){const{playerOptions:n,token:a}=t,l=r.__rest(t,["playerOptions","token"]),{backendEndpoints:d}=this.options,{onCallJoinEndpoint:p,onSFUConnection:h}=t;(yield this.callSupported())||this.throwError((0,u.createError)(u.ErrorCode.H264NotSupported,"h264 is not supported",{})),0===(null!==(o=null==d?void 0:d.length)&&void 0!==o?o:0)&&null==t.joinUrl&&this.throwError((0,u.createError)(u.ErrorCode.NoBackendEndpoints,"backendEndpoints or joinUrl are required",{}));const m=new c.Call((0,w.extendContext)(i,c.Call),!1,{token:null!=a?a:this.options.token,backendEndpoints:d,callId:e,sfu:l,playerOptions:null!=n?n:this.options.playerOptions,stats:this.options.stats},s);return m.on("callJoinEndpoint",()=>{p&&p()}),m.on("sfuConnection",,this[S.addProxy](m),m.ready()}))}requestPlayer(e,t=j){const i={autoPlay:null!=t.autoPlay?t.autoPlay:j.autoPlay,displayPoster:null!=t.displayPoster?t.displayPoster:j.displayPoster,players:null!=t.players?t.players:j.players,refetch:null!=t.refetch?t.refetch:j.refetch,muted:null!=t.muted?t.muted:j.muted,pollingInterval:null!=t.pollingInterval?t.pollingInterval:j.pollingInterval,unauthorizedPollingInterval:null!=t.unauthorizedPollingInterval?t.unauthorizedPollingInterval:j.unauthorizedPollingInterval,notFoundPollingInterval:null!=t.notFoundPollingInterval?t.notFoundPollingInterval:j.notFoundPollingInterval,unauthorizedRecoveryDuration:null!=t.unauthorizedRecoveryDuration?t.unauthorizedRecoveryDuration:j.unauthorizedRecoveryDuration,volume:null!=t.volume?t.volume:j.volume,driverFailoverSeconds:null!=t.driverFailoverSeconds?t.driverFailoverSeconds:j.driverFailoverSeconds,retryCall:null!=t.retryCall?t.retryCall:j.retryCall,urlParams:null!=t.urlParams?t.urlParams:j.urlParams,requestHeaders:null!=t.requestHeaders?t.requestHeaders:j.requestHeaders},r={muted:t.muted,autoPlay:t.autoPlay,refetch:t.refetch,volume:t.volume};this.ctx.logger.debug("requestPlayer()",{manifest:e,mergedPlayerOptions:i,options:r});let s=null,o=null;try{o=this.internalRequestPlayer(e,i)}catch(e){e instanceof Error&&(s=e)}return null==o&&this.throwError((0,u.createError)(u.ErrorCode.NoPlayersAvailable,"No supported players",{},s)),this[S.addProxy](o),o}internalRequestPlayer(e,t){if((0,a.isManifest)(e)){const i=(0,w.extendContext)(this.ctx,g.ManifestPlayer),r=new m.default((0,w.extendContext)(i,m.default),e,{pollingInterval:t.pollingInterval,notFoundPollingInterval:t.notFoundPollingInterval,unauthorizedPollingInterval:t.unauthorizedPollingInterval,unauthorizedRecoveryDuration:t.unauthorizedRecoveryDuration,urlParams:t.urlParams,requestHeaders:t.requestHeaders});r.on("error",e=>{this.emit("error",e)});const s=t.players.filter(e=>"mediasoup"===e||"string"!=typeof e&&"mediasoup"!==e.id),o={autoPlay:t.autoPlay,muted:t.muted,volume:t.volume,blurred:t.blurred,retryCall:t.retryCall,requestHeaders:t.requestHeaders};s.forEach(e=>{"string"!=typeof e&&(e.options=Object.assign(Object.assign({},o),e.options))});const n=new g.ManifestPlayer(i,r,Object.assign(Object.assign({},t),{players:s}));return null!=t.preferredScoreLevel&&(n.preferredLevel=t.preferredScoreLevel),n}if(e instanceof v.MediasoupSource)return new f.MediasoupPlayer((0,w.extendContext)(this.ctx,f.MediasoupPlayer),e,{});if(e instanceof h.MediaStreamController)return new f.MediasoupPlayer((0,w.extendContext)(this.ctx,f.MediasoupPlayer),e,{});throw new p.NotSupportedError("source not supported",{})}}t.VideoClient=R,R.displayName="VideoClient"},"./node_modules/@video/video-client-core/lib/mocks/mediasoup-client-device.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MockMediasoupClientDevice=void 0;const r=i("./node_modules/tslib/tslib.es6.js");t.MockMediasoupClientDevice=class{load(){return r.__awaiter(this,void 0,void 0,(function*(){}))}canProduce(e){return!0}}},"./node_modules/@video/video-client-core/lib/package-json.js":"./node_modules/@video/video-client-core/lib/recorder/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Recorder=void 0;const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/@video/log-client/lib/index.js"),o=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),n=i("./node_modules/@video/video-client-core/lib/internal/errors-deprecated.js"),a=i("./node_modules/@video/video-client-core/lib/internal/utils/events/event-emitter.js"),l=r.__importDefault(i("./node_modules/@video/video-client-core/lib/package-json.js")),d=i("./node_modules/@video/video-client-core/lib/utils/common.js");class c extends a.ObservableEventEmitter{constructor(e,t){var i,r,a,u,p,h,m,v,g,f;super(),this.recorder=null,this.locked=!1,this.destroyed=!1,this.localFilePath=null,this.writable=null,this.totalStorageAvailable=0,this.maxRecordingLength=0,this.dataWritten=!1,this.closing=!1,this.saving=!1,this.storageAlertSent=!1,this.userClosedSave=!1,this.dataAggregate=[],o.device.isImplements(o.Feature.MEDIA_RECORDER)||this.throwErrorDeprecated(new n.NotSupportedError("MediaRecorder is not supported",{})),o.device.isImplements(o.Feature.MEDIA_STREAM)&&o.device.isImplements(o.Feature.MEDIA_DEVICE)||this.throwErrorDeprecated(new n.NotSupportedError("MediaStream is not supported",{})),o.device.isImplements(o.Feature.AUDIO_CONTEXT)||this.throwErrorDeprecated(new n.NotSupportedError("AudioContext is not supported",{})),this.device=o.device,this.logger=null!==(i=t.logger)&&void 0!==i?i:new s.LoggerCore(d.PACKAGE_NAME).setLoggerMeta("client","VDC").setLoggerMeta("release",l.default.version).appendChain(c),this.on("error",,this.stream=null!=e?e:null,this.options=null!=t?t:{},this.options.mimetype=null!==(r=this.options.mimetype)&&void 0!==r?r:o.device.isIosDevice?"video/mp4":"video/webm;codecs=VP8",this.options.startRecordingWhenClicked=null===(a=this.options.startRecordingWhenClicked)||void 0===a||a;const b=null!==(u=this.options.audioBitsPerSecond)&&void 0!==u?u:128e3;this.options.audioBitsPerSecond=b;const _=null!==(p=this.options.videoBitsPerSecond)&&void 0!==p?p:5e6;this.options.videoBitsPerSecond=_,this.options.cursor=null!==(h=this.options.cursor)&&void 0!==h?h:"motion",this.options.displaySurface=null!==(m=this.options.displaySurface)&&void 0!==m?m:"all",this.options.frameRate=null!==(v=this.options.frameRate)&&void 0!==v?v:24,this.options.height=1920,o.device.MediaRecorder.isTypeSupported(this.options.mimetype)||this.throwErrorDeprecated(new n.MediaRecorderError("mimeType is not supported",{mimeType:this.options.mimetype})),null===(f=(g=this.device).storageEstimate)||void 0===f||f.call(g).then(({usage:e,quota:t})=>{const i=Math.round(e/1048576),r=Math.round(t/1048576)-i;this.totalStorageAvailable=r;const s=(b+_)/8/1e6;this.maxRecordingLength=r/(60*s)-1})}static isSupported(e){return o.device.isImplements(o.Feature.MEDIA_RECORDER)&&o.device.MediaRecorder.isTypeSupported(e)}newMediaRecorder(e,t){const i=new this.device.MediaRecorder(e,t);i.addEventListener("error",e=>{this.emitErrorDeprecated(new n.MediaRecorderError("media recorder error",{}))});const r=e.getVideoTracks();return 0!==r.length&&r[0].enabled&&"ended"!==r[0].readyState||this.throwErrorDeprecated(new n.MediaRecorderError("no active video tracks",{})),r[0].addEventListener("ended",()=>{this.emit("browser-stop")}),i.addEventListener("pause",this.handlePause),i.addEventListener("resume",this.handleResume),i.addEventListener("start",this.handleStart),i.addEventListener("stop",this.handleStop),i.addEventListener("dataavailable",this.handleNewData),i}handlePause(){this.emit("pause")}handleResume(){this.emit("resume")}handleStart(){this.emit("start")}andleNewData(e){var t,i;return r.__awaiter(this,void 0,void 0,(function*(){if(!this.closing)if(this.saving){const r={suggestedName:"recording."+Date.now(),types:[{description:"Video Recording",accept:{"video/x-matroska":[".webm"]},"-use_wallclock_as_timestamps":!0}]};try{this.localFilePath=yield this.device.showSaveFilePicker(r),this.writable=yield this.localFilePath.createWritable()}catch(t){const i=t instanceof Error?t:null;return this.emitErrorDeprecated(new n.MediaRecorderError("an error occurred on save record",{inner:i})),this.saving=!1,this.dataAggregate.push(e.data),void this.emit("save-canceled")}this.emit("data",e.data);let s=null;this.dataAggregate.length>0?(this.dataAggregate.push(e.data),s=new Blob(this.dataAggregate)):s=new Blob([e.data]);try{yield null===(t=this.writable)||void 0===t?void 0:t.write(s),this.dataWritten=!0,null===(i=this.writable)||void 0===i||i.close(),this.dataAggregate=[],yield this.close()}catch(e){const t=e instanceof Error?e:null;this.emitErrorDeprecated(new n.MediaRecorderError("failed to write to file",{inner:t}))}}else this.dataWritten||this.storageAlertSent||(this.storageAlertSent=!0,this.pause(),this.dataAggregate.push(e.data),this.device.confirmMessage("Your device is nearing its storage capacity. Please return to the app to save your recording."),yield this.record())}))}lock(){this.locked=!0,this.emit("lock")}pply(e){if(null!=this.stream){if(this.locked)return this.logger.debug("recorder apply locked"),void o.device.setTimeout(50);this.lock(),this.logger.info("applying recorder options",{options:e})}}get state(){var e,t;return null!==(t=null===(e=this.recorder)||void 0===e?void 0:e.state)&&void 0!==t?t:"inactive"}etupRecorder(){return r.__awaiter(this,void 0,void 0,(function*(){let e;return e=null==this.stream?yield this.createStream():this.stream,this.dataWritten=!1,this.closing=!1,this.saving=!1,null==this.recorder&&(this.recorder=yield this.newMediaRecorder(e,this.recorderOptions)),this.options.startRecordingWhenClicked&&(yield this.record()),{status:"success"}}))}record(){var e,t;return r.__awaiter(this,void 0,void 0,(function*(){return null==this.stream?(this.emitErrorDeprecated(new n.MediaRecorderError("attempting to record without a local stream",{})),{status:"error",message:"No stream provided or created"}):0===this.stream.getTracks().length?(this.emit("stream",null),this.emitErrorDeprecated(new n.MediaRecorderError("attempting to start to record with a local stream that has no tracks",{})),{status:"error",message:"No video tracks from the stream found"}):("inactive"===this.state?null===(e=this.recorder)||void 0===e||e.start(6e4*this.maxRecordingLength):"paused"===this.state&&(null===(t=this.recorder)||void 0===t||t.resume()),{status:"success"})}))}save(){return r.__awaiter(this,void 0,void 0,(function*(){return null==this.recorder?(this.emitErrorDeprecated(new n.MediaRecorderError("attempting to pause recorder with no recorder",{})),{status:"error",message:"No recorder found"}):(this.saving=!0,this.pause(),yield this.recorder.requestData(),{status:"success"})}))}pause(){return null==this.recorder?(this.emitErrorDeprecated(new n.MediaRecorderError("attempting to pause recorder with no recorder",{})),{status:"error",message:"No recorder found"}):(this.recorder.pause(),{status:"success"})}close(){var e;return r.__awaiter(this,void 0,void 0,(function*(){if(null==this.recorder)return this.emitErrorDeprecated(new n.MediaRecorderError("attempting to stop recorder with no recorder",{})),{status:"error",message:"No recorder found"};if("inactive"!==this.recorder.state){this.closing=!0;try{const t=null===(e=this.stream)||void 0===e?void 0:e.getTracks();null==t||t.forEach(,this.recorder.stop(),this.recorder=null,this.destroyed=!0,this.stream=null,this.localFilePath=null,this.writable=null}catch(e){const t=e instanceof Error?e:null;return this.emitErrorDeprecated(new n.MediaRecorderError("failed to close",{inner:t})),{status:"error",message:"Failed to close"}}}return{status:"success"}}))}createStream(){return r.__awaiter(this,void 0,void 0,(function*(){const e={video:{frameRate:this.options.frameRate,height:this.options.height,resizeMode:"crop-and-scale",cursor:this.options.cursor,displaySurface:this.options.displaySurface,logicalSurface:!0},audio:{autoGainControl:!1,echoCancellation:!1,googAutoGainControl:!1,noiseSuppression:!1}},t=yield this.device.mediaDevices.getDisplayMedia(e),i=yield this.device.mediaDevices.getUserMedia({audio:!0}),r=t.getAudioTracks(),s=t.getVideoTracks(),o=new this.device.AudioContext;let n,a,l;const d=new this.device.MediaStream;let c;return r.length>0?(a=t.getAudioTracks()[0],l=o.createMediaStreamDestination(),c=new this.device.MediaStream([a]),o.createMediaStreamSource(c).connect(l),o.createMediaStreamSource(i).connect(l),d.addTrack(l.stream.getTracks()[0]),d.addTrack(s[0])):(n=i.getAudioTracks(),d.addTrack(n[0]),d.addTrack(s[0])),this.stream=d,d}))}emoveAudioTrack(e){var t;const i=null===(t=this.stream)||void 0===t?void 0:t.getAudioTracks();null==i||i.forEach(t=>{var i;t.id===e.id&&(null===(i=this.stream)||void 0===i||i.removeTrack(t))})}}t.Recorder=c,c.displayName="Recorder"},"./node_modules/@video/video-client-core/lib/utils/common.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeSearchParameterFromUrl=t.applyUserInteractionHook=t.contextId=t.instanceId=t.CONTEXT_ID_KEY=t.INSTANCE_ID_KEY=t.PACKAGE_NAME=void 0;const r=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),s=i("./node_modules/@video/video-client-core/lib/internal/utils/index.js");t.PACKAGE_NAME="VDC-core",t.INSTANCE_ID_KEY="vdc:instanceId",t.CONTEXT_ID_KEY="vdc:contextId",t.instanceId=function(){return r.device.isImplements(r.Feature.LOCAL_STORAGE)?(null==r.device.localStorage.getItem(t.INSTANCE_ID_KEY)&&r.device.localStorage.setItem(t.INSTANCE_ID_KEY,(0,s.uuidv4)()),r.device.localStorage.getItem(t.INSTANCE_ID_KEY)):null},t.contextId=function(){r.device.globals.has(t.CONTEXT_ID_KEY)||r.device.globals.set(t.CONTEXT_ID_KEY,(0,s.uuidv4)());const e=r.device.globals.get(t.CONTEXT_ID_KEY);return"string"==typeof e?e:null},t.applyUserInteractionHook=t.removeSearchParameterFromUrl=function(e,t){const i=new RegExp(`([?&])${t}=[^&]*`,"g");return e.replace(i,"")}},"./node_modules/@video/video-client-core/node_modules/@video/log-node/index.js":(e,t,i)=>{"use strict";e.exports=i("./node_modules/@video/video-client-core/node_modules/@video/log-node/lib/index.js")},"./node_modules/@video/video-client-core/node_modules/@video/log-node/lib/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PackageMetaKeys=t.LEVELS=t.isSerializableObject=t.isPlainRecord=t.GlobalMetaKeys=t.extractAggregates=void 0;var r=i("./node_modules/@video/video-client-core/node_modules/@video/log-node/lib/interface.js");Object.defineProperty(t,"extractAggregates",{enumerable:!0,get:function(){return r.extractAggregates}}),Object.defineProperty(t,"GlobalMetaKeys",{enumerable:!0,get:function(){return r.GlobalMetaKeys}}),Object.defineProperty(t,"isPlainRecord",{enumerable:!0,get:function(){return r.isPlainRecord}}),Object.defineProperty(t,"isSerializableObject",{enumerable:!0,get:function(){return r.isSerializableObject}}),Object.defineProperty(t,"LEVELS",{enumerable:!0,get:function(){return r.LEVELS}}),Object.defineProperty(t,"PackageMetaKeys",{enumerable:!0,get:function(){return r.PackageMetaKeys}})},"./node_modules/@video/video-client-core/node_modules/@video/log-node/lib/interface.js":(e,t)=>{"use strict";function i(e){return null!=e&&"object"==typeof e&&!Array.isArray(e)&&"toJSON"in e&&"function"==typeof e.toJSON}function r(e){return null!=e&&"object"==typeof e&&!Array.isArray(e)&&!i(e)&&!Object.values(e).some(e=>null!=e&&!["number","string","boolean"].includes(typeof e))}Object.defineProperty(t,"__esModule",{value:!0}),t.extractAggregates=t.isPlainRecord=t.isSerializableObject=t.PackageMetaKeys=t.GlobalMetaKeys=t.LEVELS=void 0,t.LEVELS=["trace","debug","network","timing","local","info","warn","notice","deprecated","error","fatal"],t.GlobalMetaKeys=["source","logId","userAgent","referrer","loggerVer"],t.PackageMetaKeys=["package","component","service","release","chain","client","contextId","instanceId","commitHash"],t.isSerializableObject=i,t.isPlainRecord=r,t.extractAggregates=function(e,...t){if(!i(e))return{};const s=e.toJSON();if(null==s||"object"!=typeof s||Array.isArray(s)||i(s))return{};const o=s.aggregates;if(!r(o))return{};for(const e of t)delete o[e];return o}},"./node_modules/@video/video-client-core/node_modules/deepmerge/dist/cjs.js":"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/Consumer.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Consumer=void 0;const r=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/Logger.js"),s=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/EnhancedEventEmitter.js"),o=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/errors.js"),n=new r.Logger("Consumer");class a extends s.EnhancedEventEmitter{et id(){return this._id}get localId(){return this._localId}get producerId(){return this._producerId}get closed(){return this._closed}get kind(){return this._track.kind}get rtpReceiver(){return this._rtpReceiver}get track(){return this._track}get rtpParameters(){return this._rtpParameters}get paused(){return this._paused}get appData(){return this._appData}set appData(e){this._appData=e}get observer(){return this._observer}close(){this._closed||(n.debug("close()"),this._closed=!0,this.destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(n.debug("transportClosed()"),this._closed=!0,this.destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}async getStats(){if(this._closed)throw new o.InvalidStateError("closed");return new Promise((e,t)=>{this.safeEmit("@getstats",e,t)})}pause(){n.debug("pause()"),this._closed?n.error("pause() | Consumer closed"):this._paused?n.debug("pause() | Consumer is already paused"):(this._paused=!0,this._track.enabled=!1,this.emit("@pause"),this._observer.safeEmit("pause"))}resume(){n.debug("resume()"),this._closed?n.error("resume() | Consumer closed"):this._paused?(this._paused=!1,this._track.enabled=!0,this.emit("@resume"),this._observer.safeEmit("resume")):n.debug("resume() | Consumer is already resumed")}onTrackEnded(){n.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}.Consumer=a},"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/DataConsumer.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataConsumer=void 0;const r=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/Logger.js"),s=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/EnhancedEventEmitter.js"),o=new r.Logger("DataConsumer");class n extends s.EnhancedEventEmitter{et id(){return this._id}get dataProducerId(){return this._dataProducerId}get closed(){return this._closed}get sctpStreamParameters(){return this._sctpStreamParameters}get readyState(){return this._dataChannel.readyState}get label(){return this._dataChannel.label}get protocol(){return this._dataChannel.protocol}get binaryType(){return this._dataChannel.binaryType}set binaryType(e){this._dataChannel.binaryType=e}get appData(){return this._appData}set appData(e){this._appData=e}get observer(){return this._observer}close(){this._closed||(o.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(o.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}handleDataChannel(){this._dataChannel.addEventListener("open",()=>{this._closed||(o.debug('DataChannel "open" event'),this.safeEmit("open"))}),this._dataChannel.addEventListener("error",e=>{if(this._closed)return;let{error:t}=e;t||(t=new Error("unknown DataChannel error")),"sctp-failure"===t.errorDetail?o.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",t.sctpCauseCode,t.message):o.error('DataChannel "error" event: %o',t),this.safeEmit("error",t)}),this._dataChannel.addEventListener("close",()=>{this._closed||(o.warn('DataChannel "close" event'),this._closed=!0,this.emit("@close"),this.safeEmit("close"),this._observer.safeEmit("close"))}),this._dataChannel.addEventListener("message",}}t.DataConsumer=n},"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/DataProducer.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataProducer=void 0;const r=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/Logger.js"),s=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/EnhancedEventEmitter.js"),o=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/errors.js"),n=new r.Logger("DataProducer");class a extends s.EnhancedEventEmitter{et id(){return this._id}get closed(){return this._closed}get sctpStreamParameters(){return this._sctpStreamParameters}get readyState(){return this._dataChannel.readyState}get label(){return this._dataChannel.label}get protocol(){return this._dataChannel.protocol}get bufferedAmount(){return this._dataChannel.bufferedAmount}get bufferedAmountLowThreshold(){return this._dataChannel.bufferedAmountLowThreshold}set bufferedAmountLowThreshold(e){this._dataChannel.bufferedAmountLowThreshold=e}get appData(){return this._appData}set appData(e){this._appData=e}get observer(){return this._observer}close(){this._closed||(n.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"))}ndleDataChannel(){this._dataChannel.addEventListener("open",,this._dataChannel.addEventListener("error",e=>{if(this._closed)return;let{error:t}=e;t||(t=new Error("unknown DataChannel error")),"sctp-failure"===t.errorDetail?n.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",t.sctpCauseCode,t.message):n.error('DataChannel "error" event: %o',t),this.safeEmit("error",t)}),this._dataChannel.addEventListener("close",()=>{this._closed||(n.warn('DataChannel "close" event'),this._closed=!0,this.emit("@close"),this.safeEmit("close"),this._observer.safeEmit("close"))}),this._dataChannel.addEventListener("message",,this._dataChannel.addEventListener("bufferedamountlow",}}t.DataProducer=a},"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/Device.js":function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var s=Object.getOwnPropertyDescriptor(t,i);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,s)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Device=t.detectDevice=void 0;const a=n(i("./node_modules/bowser/es5.js")),l=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/Logger.js"),d=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/EnhancedEventEmitter.js"),c=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/errors.js"),u=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/utils.js")),p=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/ortc.js")),h=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/Transport.js"),m=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/Chrome111.js"),v=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/Chrome74.js"),g=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/Chrome70.js"),f=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/Chrome67.js"),b=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/Chrome55.js"),_=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/Firefox60.js"),y=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/Safari12.js"),w=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/Safari11.js"),S=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/Edge11.js"),E=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/ReactNativeUnifiedPlan.js"),C=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/ReactNative.js"),j=new l.Logger("Device");function P(){if("object"==typeof navigator&&"ReactNative"===navigator.product)return"undefined"==typeof RTCPeerConnection?void j.warn("this._detectDevice() | unsupported react-native-webrtc without RTCPeerConnection, forgot to call registerGlobals()?"):"undefined"!=typeof RTCRtpTransceiver?(j.debug("this._detectDevice() | ReactNative UnifiedPlan handler chosen"),"ReactNativeUnifiedPlan"):(j.debug("this._detectDevice() | ReactNative PlanB handler chosen"),"ReactNative");if("object"!=typeof navigator||"string"!=typeof navigator.userAgent)j.warn("this._detectDevice() | unknown device");else{const e=navigator.userAgent,t=a.default.getParser(e),i=t.getEngine();if(t.satisfies({chrome:">=111",chromium:">=111","microsoft edge":">=111"}))return"Chrome111";if(t.satisfies({chrome:">=74",chromium:">=74","microsoft edge":">=88"}))return"Chrome74";if(t.satisfies({chrome:">=70",chromium:">=70"}))return"Chrome70";if(t.satisfies({chrome:">=67",chromium:">=67"}))return"Chrome67";if(t.satisfies({chrome:">=55",chromium:">=55"}))return"Chrome55";if(t.satisfies({firefox:">=60"}))return"Firefox60";if(t.satisfies({ios:{OS:">=14.3",firefox:">=30.0"}}))return"Safari12";if(t.satisfies({safari:">=12.0"})&&"undefined"!=typeof RTCRtpTransceiver&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(t.satisfies({safari:">=11"}))return"Safari11";if(t.satisfies({"microsoft edge":">=11"})&&t.satisfies({"microsoft edge":"<=18"}))return"Edge11";if(i.name&&"blink"===i.name.toLowerCase()){const t=e.match(/(?:(?:Chrome|Chromium))[ /](\w+)/i);if(t){const e=Number(t[1]);return e>=111?"Chrome111":e>=74?"Chrome74":e>=70?"Chrome70":e>=67?"Chrome67":"Chrome55"}return"Chrome111"}j.warn("this._detectDevice() | browser not supported [name:%s, version:%s]",t.getBrowserName(),t.getBrowserVersion())}}t.detectDevice=P;t.Device=class{constructor({handlerName:e,handlerFactory:t,Handler:i}={}){if(this._loaded=!1,this._observer=new d.EnhancedEventEmitter,j.debug("constructor()"),i){if(j.warn("constructor() | Handler option is DEPRECATED, use handlerName or handlerFactory instead"),"string"!=typeof i)throw new TypeError("non string Handler option no longer supported, use handlerFactory instead");e=i}if(e&&t)throw new TypeError("just one of handlerName or handlerInterface can be given");if(t)this._handlerFactory=t;else{if(e)j.debug("constructor() | handler given: %s",e);else{if(!(e=P()))throw new c.UnsupportedError("device not supported");j.debug("constructor() | detected handler: %s",e)}switch(e){case"Chrome111":this._handlerFactory=m.Chrome111.createFactory();break;case"Chrome74":this._handlerFactory=v.Chrome74.createFactory();break;case"Chrome70":this._handlerFactory=g.Chrome70.createFactory();break;case"Chrome67":this._handlerFactory=f.Chrome67.createFactory();break;case"Chrome55":this._handlerFactory=b.Chrome55.createFactory();break;case"Firefox60":this._handlerFactory=_.Firefox60.createFactory();break;case"Safari12":this._handlerFactory=y.Safari12.createFactory();break;case"Safari11":this._handlerFactory=w.Safari11.createFactory();break;case"Edge11":this._handlerFactory=S.Edge11.createFactory();break;case"ReactNativeUnifiedPlan":this._handlerFactory=E.ReactNativeUnifiedPlan.createFactory();break;case"ReactNative":this._handlerFactory=C.ReactNative.createFactory();break;default:throw new TypeError(`unknown handlerName "${e}"`)}}const r=this._handlerFactory();this._handlerName=r.name,r.close(),this._extendedRtpCapabilities=void 0,this._recvRtpCapabilities=void 0,this._canProduceByKind={audio:!1,video:!1},this._sctpCapabilities=void 0}get handlerName(){return this._handlerName}get loaded(){return this._loaded}get rtpCapabilities(){if(!this._loaded)throw new c.InvalidStateError("not loaded");return this._recvRtpCapabilities}et observer(){return this._observer}async load({routerRtpCapabilities:e}){let t;j.debug("load() [routerRtpCapabilities:%o]",e),e=u.clone(e,void 0);try{if(this._loaded)throw new c.InvalidStateError("already loaded");p.validateRtpCapabilities(e),t=this._handlerFactory();const i=await t.getNativeRtpCapabilities();j.debug("load() | got native RTP capabilities:%o",i),p.validateRtpCapabilities(i),this._extendedRtpCapabilities=p.getExtendedRtpCapabilities(i,e),j.debug("load() | got extended RTP capabilities:%o",this._extendedRtpCapabilities),this._canProduceByKind.audio=p.canSend("audio",this._extendedRtpCapabilities),this._canProduceByKind.video=p.canSend("video",this._extendedRtpCapabilities),this._recvRtpCapabilities=p.getRecvRtpCapabilities(this._extendedRtpCapabilities),p.validateRtpCapabilities(this._recvRtpCapabilities),j.debug("load() | got receiving RTP capabilities:%o",this._recvRtpCapabilities),this._sctpCapabilities=await t.getNativeSctpCapabilities(),j.debug("load() | got native SCTP capabilities:%o",this._sctpCapabilities),p.validateSctpCapabilities(this._sctpCapabilities),j.debug("load() succeeded"),this._loaded=!0,t.close()}catch(e){throw t&&t.close(),e}}canProduce(e){if(!this._loaded)throw new c.InvalidStateError("not loaded");if("audio"!==e&&"video"!==e)throw new TypeError(`invalid kind "${e}"`);return this._canProduceByKind[e]}createSendTransport({id:e,iceParameters:t,iceCandidates:i,dtlsParameters:r,sctpParameters:s,iceServers:o,iceTransportPolicy:n,additionalSettings:a,proprietaryConstraints:l,appData:d}){return j.debug("createSendTransport()"),this.createTransport({direction:"send",id:e,iceParameters:t,iceCandidates:i,dtlsParameters:r,sctpParameters:s,iceServers:o,iceTransportPolicy:n,additionalSettings:a,proprietaryConstraints:l,appData:d})}createRecvTransport({id:e,iceParameters:t,iceCandidates:i,dtlsParameters:r,sctpParameters:s,iceServers:o,iceTransportPolicy:n,additionalSettings:a,proprietaryConstraints:l,appData:d}){return j.debug("createRecvTransport()"),this.createTransport({direction:"recv",id:e,iceParameters:t,iceCandidates:i,dtlsParameters:r,sctpParameters:s,iceServers:o,iceTransportPolicy:n,additionalSettings:a,proprietaryConstraints:l,appData:d})}createTransport({direction:e,id:t,iceParameters:i,iceCandidates:r,dtlsParameters:s,sctpParameters:o,iceServers:n,iceTransportPolicy:a,additionalSettings:l,proprietaryConstraints:d,appData:u}){if(!this._loaded)throw new c.InvalidStateError("not loaded");if("string"!=typeof t)throw new TypeError("missing id");if("object"!=typeof i)throw new TypeError("missing iceParameters");if(!Array.isArray(r))throw new TypeError("missing iceCandidates");if("object"!=typeof s)throw new TypeError("missing dtlsParameters");if(o&&"object"!=typeof o)throw new TypeError("wrong sctpParameters");if(u&&"object"!=typeof u)throw new TypeError("if given, appData must be an object");const p=new h.Transport({direction:e,id:t,iceParameters:i,iceCandidates:r,dtlsParameters:s,sctpParameters:o,iceServers:n,iceTransportPolicy:a,additionalSettings:l,proprietaryConstraints:d,appData:u,handlerFactory:this._handlerFactory,extendedRtpCapabilities:this._extendedRtpCapabilities,canProduceByKind:this._canProduceByKind});return this._observer.safeEmit("newtransport",p),p}}},"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/EnhancedEventEmitter.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EnhancedEventEmitter=void 0;const r=i("./node_modules/events/events.js"),s=new(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/Logger.js").Logger)("EnhancedEventEmitter");class o extends r.EventEmitter{feEmit(e,...t){const i=super.listenerCount(e);try{return super.emit(e,...t)}catch(t){return s.error("safeEmit() | event listener threw an error [eventName:%s]:%o",e,t),Boolean(i)}}on(e,t){return super.on(e,t),this}off(e,t){return super.off(e,t),this}addListener(e,t){return super.on(e,t),this}prependListener(e,t){return super.prependListener(e,t),this}once(e,t){return super.once(e,t),this}prependOnceListener(e,t){return super.prependOnceListener(e,t),this}stenerCount(e){return super.listenerCount(e)}listeners(e){return super.listeners(e)}t.EnhancedEventEmitter=o},"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/Logger.js":function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=void 0;const s=r(i("./node_modules/debug/src/browser.js")),o="mediasoup-client";t.Logger=class{constructor(e){e?(this._debug=(0,s.default)(`${o}:${e}`),this._warn=(0,s.default)(`${o}:WARN:${e}`),this._error=(0,s.default)(`${o}:ERROR:${e}`)):(this._debug=(0,s.default)(o),this._warn=(0,s.default)(o+":WARN"),this._error=(0,s.default)(o+":ERROR")),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}}},"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/Producer.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Producer=void 0;const r=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/Logger.js"),s=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/EnhancedEventEmitter.js"),o=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/errors.js"),n=new r.Logger("Producer");class a extends s.EnhancedEventEmitter{et id(){return this._id}get localId(){return this._localId}get closed(){return this._closed}get kind(){return this._kind}get rtpSender(){return this._rtpSender}get track(){return this._track}get rtpParameters(){return this._rtpParameters}get paused(){return this._paused}get maxSpatialLayer(){return this._maxSpatialLayer}get appData(){return this._appData}set appData(e){this._appData=e}get observer(){return this._observer}close(){this._closed||(n.debug("close()"),this._closed=!0,this.destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"))}use(){n.debug("pause()"),this._closed?n.error("pause() | Producer closed"):(this._paused=!0,this._track&&this._disableTrackOnPause&&(this._track.enabled=!1),this._zeroRtpOnPause&&new Promise((e,t)=>{this.safeEmit("@pause",e,t)}).catch(()=>{}),this._observer.safeEmit("pause"))}resume(){n.debug("resume()"),this._closed?n.error("resume() | Producer closed"):(this._paused=!1,this._track&&this._disableTrackOnPause&&(this._track.enabled=!0),this._zeroRtpOnPause&&new Promise(.catch(()=>{}),this._observer.safeEmit("resume"))}async replaceTrack({track:e}){if(n.debug("replaceTrack() [track:%o]",e),this._closed){if(e&&this._stopTracks)try{e.stop()}catch(e){}throw new o.InvalidStateError("closed")}if(e&&"ended"===e.readyState)throw new o.InvalidStateError("track ended");e!==this._track?(await new Promise((t,i)=>{this.safeEmit("@replacetrack",e,t,i)}),this.destroyTrack(),this._track=e,this._track&&this._disableTrackOnPause&&(this._paused?this._paused&&(this._track.enabled=!1):this._track.enabled=!0),this.handleTrack()):n.debug("replaceTrack() | same track, ignored")}async setMaxSpatialLayer(e){if(this._closed)throw new o.InvalidStateError("closed");if("video"!==this._kind)throw new o.UnsupportedError("not a video Producer");if("number"!=typeof e)throw new TypeError("invalid spatialLayer");e!==this._maxSpatialLayer&&(await new Promise((t,i)=>{this.safeEmit("@setmaxspatiallayer",e,t,i)}).catch(()=>{}),this._maxSpatialLayer=e)}async setRtpEncodingParameters(e){if(this._closed)throw new o.InvalidStateError("closed");if("object"!=typeof e)throw new TypeError("invalid params");await new Promise(}Producer=a},"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/RtpParameters.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/SctpParameters.js":"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/Transport.js":function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var s=Object.getOwnPropertyDescriptor(t,i);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,s)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Transport=void 0;const a=i("./node_modules/awaitqueue/lib/index.js"),l=n(i("./node_modules/queue-microtask/index.js")),d=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/Logger.js"),c=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/EnhancedEventEmitter.js"),u=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/errors.js"),p=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/utils.js")),h=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/ortc.js")),m=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/Producer.js"),v=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/Consumer.js"),g=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/DataProducer.js"),f=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/DataConsumer.js"),b=new d.Logger("Transport");lass y extends c.EnhancedEventEmitter{constructor({direction:e,id:t,iceParameters:i,iceCandidates:r,dtlsParameters:s,sctpParameters:o,iceServers:n,iceTransportPolicy:l,additionalSettings:d,proprietaryConstraints:u,appData:h,handlerFactory:m,extendedRtpCapabilities:v,canProduceByKind:g}){super(),this._closed=!1,this._connectionState="new",this._producers=new Map,this._consumers=new Map,this._dataProducers=new Map,this._dataConsumers=new Map,this._probatorConsumerCreated=!1,this._awaitQueue=new a.AwaitQueue,this._pendingConsumerTasks=[],this._consumerCreationInProgress=!1,this._pendingPauseConsumers=new Map,this._consumerPauseInProgress=!1,this._pendingResumeConsumers=new Map,this._consumerResumeInProgress=!1,this._pendingCloseConsumers=new Map,this._consumerCloseInProgress=!1,this._observer=new c.EnhancedEventEmitter,b.debug("constructor() [id:%s, direction:%s]",t,e),this._id=t,this._direction=e,this._extendedRtpCapabilities=v,this._canProduceByKind=g,this._maxSctpMessageSize=o?o.maxMessageSize:null,delete(d=p.clone(d,{})).iceServers,delete d.iceTransportPolicy,delete d.bundlePolicy,delete d.rtcpMuxPolicy,delete d.sdpSemantics,this._handler=m(),this._handler.run({direction:e,iceParameters:i,iceCandidates:r,dtlsParameters:s,sctpParameters:o,iceServers:n,iceTransportPolicy:l,additionalSettings:d,proprietaryConstraints:u,extendedRtpCapabilities:v}),this._appData=h||{},this.handleHandler()}get id(){return this._id}get closed(){return this._closed}get direction(){return this._direction}get handler(){return this._handler}get connectionState(){return this._connectionState}get appData(){return this._appData}set appData(e){this._appData=e}get observer(){return this._observer}close(){if(!this._closed){b.debug("close()"),this._closed=!0,this._awaitQueue.stop(),this._handler.close();for(const e of this._producers.values())e.transportClosed();this._producers.clear();for(const e of this._consumers.values())e.transportClosed();this._consumers.clear();for(const e of this._dataProducers.values())e.transportClosed();this._dataProducers.clear();for(const e of this._dataConsumers.values())e.transportClosed();this._dataConsumers.clear(),this._observer.safeEmit("close")}}sync restartIce({iceParameters:e}){if(b.debug("restartIce()"),this._closed)throw new u.InvalidStateError("closed");if(!e)throw new TypeError("missing iceParameters");return this._awaitQueue.push(async()=>this._handler.restartIce(e),"transport.restartIce()")}async updateIceServers({iceServers:e}={}){if(b.debug("updateIceServers()"),this._closed)throw new u.InvalidStateError("closed");if(!Array.isArray(e))throw new TypeError("missing iceServers");return this._awaitQueue.push("transport.updateIceServers()")}async produce({track:e,encodings:t,codecOptions:i,codec:r,stopTracks:s=!0,disableTrackOnPause:o=!0,zeroRtpOnPause:n=!1,appData:a={}}={}){if(b.debug("produce() [track:%o]",e),this._closed)throw new u.InvalidStateError("closed");if(!e)throw new TypeError("missing track");if("send"!==this._direction)throw new u.UnsupportedError("not a sending Transport");if(!this._canProduceByKind[e.kind])throw new u.UnsupportedError("cannot produce "+e.kind);if("ended"===e.readyState)throw new u.InvalidStateError("track ended");if(0===this.listenerCount("connect")&&"new"===this._connectionState)throw new TypeError('no "connect" listener set into this transport');if(0===this.listenerCount("produce"))throw new TypeError('no "produce" listener set into this transport');if(a&&"object"!=typeof a)throw new TypeError("if given, appData must be an object");return this._awaitQueue.push("transport.produce()").catch(}async consume({id:e,producerId:t,kind:i,rtpParameters:r,streamId:s,appData:o={}}){if(b.debug("consume()"),r=p.clone(r,void 0),this._closed)throw new u.InvalidStateError("closed");if("recv"!==this._direction)throw new u.UnsupportedError("not a receiving Transport");if("string"!=typeof e)throw new TypeError("missing id");if("string"!=typeof t)throw new TypeError("missing producerId");if("audio"!==i&&"video"!==i)throw new TypeError(`invalid kind '${i}'`);if(0===this.listenerCount("connect")&&"new"===this._connectionState)throw new TypeError('no "connect" listener set into this transport');if(o&&"object"!=typeof o)throw new TypeError("if given, appData must be an object");if(!h.canReceive(r,this._extendedRtpCapabilities))throw new u.UnsupportedError("cannot consume this Producer");const n=new _({id:e,producerId:t,kind:i,rtpParameters:r,streamId:s,appData:o});return this._pendingConsumerTasks.push(n),(0,l.default)(()=>{this._closed||!1===this._consumerCreationInProgress&&this.createPendingConsumers()}),n.promise}async produceData({ordered:e=!0,maxPacketLifeTime:t,maxRetransmits:i,label:r="",protocol:s="",appData:o={}}={}){if(b.debug("produceData()"),this._closed)throw new u.InvalidStateError("closed");if("send"!==this._direction)throw new u.UnsupportedError("not a sending Transport");if(!this._maxSctpMessageSize)throw new u.UnsupportedError("SCTP not enabled by remote Transport");if(0===this.listenerCount("connect")&&"new"===this._connectionState)throw new TypeError('no "connect" listener set into this transport');if(0===this.listenerCount("producedata"))throw new TypeError('no "producedata" listener set into this transport');if(o&&"object"!=typeof o)throw new TypeError("if given, appData must be an object");return(t||i)&&(e=!1),this._awaitQueue.push("transport.produceData()")}async consumeData({id:e,dataProducerId:t,sctpStreamParameters:i,label:r="",protocol:s="",appData:o={}}){if(b.debug("consumeData()"),i=p.clone(i,void 0),this._closed)throw new u.InvalidStateError("closed");if("recv"!==this._direction)throw new u.UnsupportedError("not a receiving Transport");if(!this._maxSctpMessageSize)throw new u.UnsupportedError("SCTP not enabled by remote Transport");if("string"!=typeof e)throw new TypeError("missing id");if("string"!=typeof t)throw new TypeError("missing dataProducerId");if(0===this.listenerCount("connect")&&"new"===this._connectionState)throw new TypeError('no "connect" listener set into this transport');if(o&&"object"!=typeof o)throw new TypeError("if given, appData must be an object");return h.validateSctpStreamParameters(i),this._awaitQueue.push("transport.consumeData()")}async createPendingConsumers(){this._consumerCreationInProgress=!0,this._awaitQueue.push(async()=>{if(0===this._pendingConsumerTasks.length)return void b.debug("createPendingConsumers() | there is no Consumer to be created");const e=[...this._pendingConsumerTasks];this._pendingConsumerTasks=[];let t=void 0;const i=[];for(const t of e){const{id:e,kind:r,rtpParameters:s,streamId:o}=t.consumerOptions;i.push({trackId:e,kind:r,rtpParameters:s,streamId:o})}try{const r=await this._handler.receive(i);for(let i=0;i<r.length;++i){const s=e[i],o=r[i],{id:n,producerId:a,kind:l,rtpParameters:d,appData:c}=s.consumerOptions,{localId:u,rtpReceiver:p,track:h}=o,m=new v.Consumer({id:n,localId:u,producerId:a,rtpReceiver:p,track:h,rtpParameters:d,appData:c});this._consumers.set(m.id,m),this.handleConsumer(m),this._probatorConsumerCreated||t||"video"!==l||(t=m),this._observer.safeEmit("newconsumer",m),s.resolve(m)}}catch(t){for(const i of e)i.reject(t)}if(t)try{const e=h.generateProbatorRtpParameters(t.rtpParameters);await this._handler.receive([{trackId:"probator",kind:"video",rtpParameters:e}]),b.debug("createPendingConsumers() | Consumer for RTP probation created"),this._probatorConsumerCreated=!0}catch(e){b.error("createPendingConsumers() | failed to create Consumer for RTP probation:%o",e)}},"transport.createPendingConsumers()").then(()=>{this._consumerCreationInProgress=!1,this._pendingConsumerTasks.length>0&&this.createPendingConsumers()}).catch(()=>{})}pausePendingConsumers(){this._consumerPauseInProgress=!0,this._awaitQueue.push(async()=>{if(0===this._pendingPauseConsumers.size)return void b.debug("pausePendingConsumers() | there is no Consumer to be paused");const e=Array.from(this._pendingPauseConsumers.values());this._pendingPauseConsumers.clear();try{const t=e.map(e=>e.localId);await this._handler.pauseReceiving(t)}catch(e){b.error("pausePendingConsumers() | failed to pause Consumers:",e)}},"transport.pausePendingConsumers").then(()=>{this._consumerPauseInProgress=!1,this._pendingPauseConsumers.size>0&&this.pausePendingConsumers()}).catch(()=>{})}resumePendingConsumers(){this._consumerResumeInProgress=!0,this._awaitQueue.push(async()=>{if(0===this._pendingResumeConsumers.size)return void b.debug("resumePendingConsumers() | there is no Consumer to be resumed");const e=Array.from(this._pendingResumeConsumers.values());this._pendingResumeConsumers.clear();try{const t=e.map(e=>e.localId);await this._handler.resumeReceiving(t)}catch(e){b.error("resumePendingConsumers() | failed to resume Consumers:",e)}},"transport.resumePendingConsumers").then(()=>{this._consumerResumeInProgress=!1,this._pendingResumeConsumers.size>0&&this.resumePendingConsumers()}).catch(()=>{})}closePendingConsumers(){this._consumerCloseInProgress=!0,this._awaitQueue.push(async()=>{if(0===this._pendingCloseConsumers.size)return void b.debug("closePendingConsumers() | there is no Consumer to be closed");const e=Array.from(this._pendingCloseConsumers.values());this._pendingCloseConsumers.clear();try{await this._handler.stopReceiving(e.map()}catch(e){b.error("closePendingConsumers() | failed to close Consumers:",e)}},"transport.closePendingConsumers").then(.catch(()=>{})}handleHandler(){const e=this._handler;e.on("@connect",({dtlsParameters:e},t,i)=>{this._closed?i(new u.InvalidStateError("closed")):this.safeEmit("connect",{dtlsParameters:e},t,i)}),e.on("@connectionstatechange",}andleConsumer(e){e.on("@close",,e.on("@pause",()=>{this._pendingResumeConsumers.has(e.id)&&this._pendingResumeConsumers.delete(e.id),this._pendingPauseConsumers.set(e.id,e),(0,l.default)(()=>{this._closed||!1===this._consumerPauseInProgress&&this.pausePendingConsumers()})}),e.on("@resume",()=>{this._pendingPauseConsumers.has(e.id)&&this._pendingPauseConsumers.delete(e.id),this._pendingResumeConsumers.set(e.id,e),(0,l.default)(()=>{this._closed||!1===this._consumerResumeInProgress&&this.resumePendingConsumers()})}),e.on("@getstats",}handleDataProducer(e){e.on("@close",()=>{this._dataProducers.delete(e.id)})}t.Transport=y},"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/errors.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InvalidStateError=t.UnsupportedError=void 0;class i extends Error{constructor(e){super(e),this.name="UnsupportedError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,i):this.stack=new Error(e).stack}}t.UnsupportedError=i;class r extends Error{constructor(e){super(e),this.name="InvalidStateError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,r):this.stack=new Error(e).stack}}t.InvalidStateError=r},"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/Chrome111.js":function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var s=Object.getOwnPropertyDescriptor(t,i);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,s)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Chrome111=void 0;const n=o(i("./node_modules/sdp-transform/lib/index.js")),a=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/Logger.js"),l=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/utils.js")),d=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/ortc.js")),c=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/commonUtils.js")),u=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/unifiedPlanUtils.js")),p=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/ortc/utils.js")),h=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/HandlerInterface.js"),m=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/RemoteSdp.js"),v=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/scalabilityModes.js"),g=new a.Logger("Chrome111"),f={OS:1024,MIS:1024};class b extends h.HandlerInterface{static createFactory(){return()=>new b}constructor(){super(),this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"Chrome111"}close(){if(g.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}async getNativeRtpCapabilities(){g.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{e.addTransceiver("audio"),e.addTransceiver("video");const t=await e.createOffer();try{e.close()}catch(e){}const i=n.parse(t.sdp),r=c.extractRtpCapabilities({sdpObject:i});return p.addNackSuppportForOpus(r),r}catch(t){try{e.close()}catch(e){}throw t}}async getNativeSctpCapabilities(){return g.debug("getNativeSctpCapabilities()"),{numStreams:f}}run({direction:e,iceParameters:t,iceCandidates:i,dtlsParameters:r,sctpParameters:s,iceServers:o,iceTransportPolicy:n,additionalSettings:a,proprietaryConstraints:l,extendedRtpCapabilities:c}){g.debug("run()"),this._direction=e,this._remoteSdp=new m.RemoteSdp({iceParameters:t,iceCandidates:i,dtlsParameters:r,sctpParameters:s}),this._sendingRtpParametersByKind={audio:d.getSendingRtpParameters("audio",c),video:d.getSendingRtpParameters("video",c)},this._sendingRemoteRtpParametersByKind={audio:d.getSendingRemoteRtpParameters("audio",c),video:d.getSendingRemoteRtpParameters("video",c)},r.role&&"auto"!==r.role&&(this._forcedLocalDtlsRole="server"===r.role?"client":"server"),this._pc=new RTCPeerConnection({iceServers:o||[],iceTransportPolicy:n||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...a},l),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):(g.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",()=>{switch(this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed")}}))}async updateIceServers(e){g.debug("updateIceServers()");const t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(g.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady)if("send"===this._direction){const e=await this._pc.createOffer({iceRestart:!0});g.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e);const t={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setRemoteDescription(t)}else{const e={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();g.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",t),await this._pc.setLocalDescription(t)}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:t,codecOptions:i,codec:r}){var s;if(this.assertSendDirection(),g.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),t&&t.length>1){t.forEach((e,t)=>{e.rid="r"+t});let e=1,i=1;for(const e of t){const t=e.scalabilityMode?(0,v.parse)(e.scalabilityMode).temporalLayers:3;t>i&&(i=t)}for(const r of t)r.rid="r"+e++,r.scalabilityMode="L1T"+i}const o=l.clone(this._sendingRtpParametersByKind[e.kind],{});o.codecs=d.reduceCodecs(o.codecs,r);const a=l.clone(this._sendingRemoteRtpParametersByKind[e.kind],{});a.codecs=d.reduceCodecs(a.codecs,r);const p=this._remoteSdp.getNextMediaSectionIdx(),h=this._pc.addTransceiver(e,{direction:"sendonly",streams:[this._sendStream],sendEncodings:t}),m=await this._pc.createOffer();let f=n.parse(m.sdp);this._transportReady||await this.setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:f}),g.debug("send() | calling pc.setLocalDescription() [offer:%o]",m),await this._pc.setLocalDescription(m);const b=h.mid;o.mid=b,f=n.parse(this._pc.localDescription.sdp);const _=f.media[p.idx];if(o.rtcp.cname=c.getCname({offerMediaObject:_}),t)if(1===t.length){const e=u.getRtpEncodings({offerMediaObject:_});Object.assign(e[0],t[0]),o.encodings=e}else o.encodings=t;else o.encodings=u.getRtpEncodings({offerMediaObject:_});this._remoteSdp.send({offerMediaObject:_,reuseMid:p.reuseMid,offerRtpParameters:o,answerRtpParameters:a,codecOptions:i,extmapAllowMixed:!0});const y={type:"answer",sdp:this._remoteSdp.getSdp()};return g.debug("send() | calling pc.setRemoteDescription() [answer:%o]",y),await this._pc.setRemoteDescription(y),this._mapMidTransceiver.set(b,h),{localId:b,rtpParameters:o,rtpSender:h.sender}}async stopSending(e){this.assertSendDirection(),g.debug("stopSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");t.sender.replaceTrack(null),this._pc.removeTrack(t.sender);if(this._remoteSdp.closeMediaSection(t.mid))try{t.stop()}catch(e){}const i=await this._pc.createOffer();g.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const r={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r),this._mapMidTransceiver.delete(e)}async pauseSending(e){this.assertSendDirection(),g.debug("pauseSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");t.direction="inactive",this._remoteSdp.pauseMediaSection(e);const i=await this._pc.createOffer();g.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const r={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r)}async resumeSending(e){this.assertSendDirection(),g.debug("resumeSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(this._remoteSdp.resumeSendingMediaSection(e),!t)throw new Error("associated RTCRtpTransceiver not found");t.direction="sendonly";const i=await this._pc.createOffer();g.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const r={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r)}async replaceTrack(e,t){this.assertSendDirection(),t?g.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):g.debug("replaceTrack() [localId:%s, no track]",e);const i=this._mapMidTransceiver.get(e);if(!i)throw new Error("associated RTCRtpTransceiver not found");await i.sender.replaceTrack(t)}async setMaxSpatialLayer(e,t){this.assertSendDirection(),g.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);const i=this._mapMidTransceiver.get(e);if(!i)throw new Error("associated RTCRtpTransceiver not found");const r=i.sender.getParameters();r.encodings.forEach((e,i)=>{e.active=i<=t}),await i.sender.setParameters(r),this._remoteSdp.muxMediaSectionSimulcast(e,r.encodings);const s=await this._pc.createOffer();g.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async setRtpEncodingParameters(e,t){this.assertSendDirection(),g.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);const i=this._mapMidTransceiver.get(e);if(!i)throw new Error("associated RTCRtpTransceiver not found");const r=i.sender.getParameters();r.encodings.forEach((e,i)=>{r.encodings[i]={...e,...t}}),await i.sender.setParameters(r),this._remoteSdp.muxMediaSectionSimulcast(e,r.encodings);const s=await this._pc.createOffer();g.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async getSenderStats(e){this.assertSendDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.sender.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:t,maxRetransmits:i,label:r,protocol:s}){var o;this.assertSendDirection();const a={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:t,maxRetransmits:i,protocol:s};g.debug("sendDataChannel() [options:%o]",a);const l=this._pc.createDataChannel(r,a);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%f.MIS,!this._hasDataChannelMediaSection){const e=await this._pc.createOffer(),t=n.parse(e.sdp),i=t.media.find(e=>"application"===e.type);this._transportReady||await this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:t}),g.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e),this._remoteSdp.sendSctpAssociation({offerMediaObject:i});const r={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r),this._hasDataChannelMediaSection=!0}return{dataChannel:l,sctpStreamParameters:{streamId:a.id,ordered:a.ordered,maxPacketLifeTime:a.maxPacketLifeTime,maxRetransmits:a.maxRetransmits}}}async receive(e){var t;this.assertRecvDirection();const i=[],r=new Map;for(const t of e){const{trackId:e,kind:i,rtpParameters:s,streamId:o}=t;g.debug("receive() [trackId:%s, kind:%s]",e,i);const n=s.mid||String(this._mapMidTransceiver.size);r.set(e,n),this._remoteSdp.receive({mid:n,kind:i,offerRtpParameters:s,streamId:o||s.rtcp.cname,trackId:e})}const s={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",s),await this._pc.setRemoteDescription(s);let o=await this._pc.createAnswer();const a=n.parse(o.sdp);for(const t of e){const{trackId:e,rtpParameters:i}=t,s=r.get(e),o=a.media.find(e=>String(e.mid)===s);c.applyCodecParameters({offerRtpParameters:i,answerMediaObject:o})}o={type:"answer",sdp:n.write(a)},this._transportReady||await this.setupTransport({localDtlsRole:null!==(t=this._forcedLocalDtlsRole)&&void 0!==t?t:"client",localSdpObject:a}),g.debug("receive() | calling pc.setLocalDescription() [answer:%o]",o),await this._pc.setLocalDescription(o);for(const t of e){const{trackId:e}=t,s=r.get(e),o=this._pc.getTransceivers().find(e=>e.mid===s);if(!o)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(s,o),i.push({localId:s,track:o.receiver.track,rtpReceiver:o.receiver})}return i}async stopReceiving(e){this.assertRecvDirection();for(const t of e){g.debug("stopReceiving() [localId:%s]",t);const e=this._mapMidTransceiver.get(t);if(!e)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(e.mid)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const i=await this._pc.createAnswer();g.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const t of e)this._mapMidTransceiver.delete(t)}async pauseReceiving(e){this.assertRecvDirection();for(const t of e){g.debug("pauseReceiving() [localId:%s]",t);const e=this._mapMidTransceiver.get(t);if(!e)throw new Error("associated RTCRtpTransceiver not found");e.direction="inactive",this._remoteSdp.pauseMediaSection(t)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const i=await this._pc.createAnswer();g.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i)}async resumeReceiving(e){this.assertRecvDirection();for(const t of e){g.debug("resumeReceiving() [localId:%s]",t);const e=this._mapMidTransceiver.get(t);if(!e)throw new Error("associated RTCRtpTransceiver not found");e.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(t)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const i=await this._pc.createAnswer();g.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i)}async getReceiverStats(e){this.assertRecvDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:t,protocol:i}){var r;this.assertRecvDirection();const{streamId:s,ordered:o,maxPacketLifeTime:a,maxRetransmits:l}=e,d={negotiated:!0,id:s,ordered:o,maxPacketLifeTime:a,maxRetransmits:l,protocol:i};g.debug("receiveDataChannel() [options:%o]",d);const c=this._pc.createDataChannel(t,d);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const e={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();if(!this._transportReady){const e=n.parse(t.sdp);await this.setupTransport({localDtlsRole:null!==(r=this._forcedLocalDtlsRole)&&void 0!==r?r:"client",localSdpObject:e})}g.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setLocalDescription(t),this._hasDataChannelMediaSection=!0}return{dataChannel:c}}async setupTransport({localDtlsRole:e,localSdpObject:t}){t||(t=n.parse(this._pc.localDescription.sdp));const i=c.extractDtlsParameters({sdpObject:t});i.role=e,this._remoteSdp.updateDtlsRole("client"===e?"server":"client"),await new Promise((e,t)=>{this.safeEmit("@connect",{dtlsParameters:i},e,t)}),this._transportReady=!0}assertSendDirection(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}t.Chrome111=b},"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/Chrome55.js":function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var s=Object.getOwnPropertyDescriptor(t,i);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,s)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Chrome55=void 0;const n=o(i("./node_modules/sdp-transform/lib/index.js")),a=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/Logger.js"),l=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/errors.js"),d=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/utils.js")),c=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/ortc.js")),u=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/commonUtils.js")),p=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/planBUtils.js")),h=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/HandlerInterface.js"),m=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/RemoteSdp.js"),v=new a.Logger("Chrome55"),g={OS:1024,MIS:1024};class f extends h.HandlerInterface{static createFactory(){return()=>new f}constructor(){super(),this._sendStream=new MediaStream,this._mapSendLocalIdTrack=new Map,this._nextSendLocalId=0,this._mapRecvLocalIdInfo=new Map,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"Chrome55"}close(){if(v.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}async getNativeRtpCapabilities(){v.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{const t=await e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{e.close()}catch(e){}const i=n.parse(t.sdp);return u.extractRtpCapabilities({sdpObject:i})}catch(t){try{e.close()}catch(e){}throw t}}async getNativeSctpCapabilities(){return v.debug("getNativeSctpCapabilities()"),{numStreams:g}}run({direction:e,iceParameters:t,iceCandidates:i,dtlsParameters:r,sctpParameters:s,iceServers:o,iceTransportPolicy:n,additionalSettings:a,proprietaryConstraints:l,extendedRtpCapabilities:d}){v.debug("run()"),this._direction=e,this._remoteSdp=new m.RemoteSdp({iceParameters:t,iceCandidates:i,dtlsParameters:r,sctpParameters:s,planB:!0}),this._sendingRtpParametersByKind={audio:c.getSendingRtpParameters("audio",d),video:c.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:c.getSendingRemoteRtpParameters("audio",d),video:c.getSendingRemoteRtpParameters("video",d)},r.role&&"auto"!==r.role&&(this._forcedLocalDtlsRole="server"===r.role?"client":"server"),this._pc=new RTCPeerConnection({iceServers:o||[],iceTransportPolicy:n||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b",...a},l),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(v.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed")}})}async updateIceServers(e){v.debug("updateIceServers()");const t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(v.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady)if("send"===this._direction){const e=await this._pc.createOffer({iceRestart:!0});v.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e);const t={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setRemoteDescription(t)}else{const e={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();v.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",t),await this._pc.setLocalDescription(t)}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:t,codecOptions:i,codec:r}){var s;this.assertSendDirection(),v.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),r&&v.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(e),this._pc.addStream(this._sendStream);let o,a=await this._pc.createOffer(),l=n.parse(a.sdp);const h=d.clone(this._sendingRtpParametersByKind[e.kind],{});h.codecs=c.reduceCodecs(h.codecs);const m=d.clone(this._sendingRemoteRtpParametersByKind[e.kind],{});if(m.codecs=c.reduceCodecs(m.codecs),this._transportReady||await this.setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:l}),"video"===e.kind&&t&&t.length>1&&(v.debug("send() | enabling simulcast"),l=n.parse(a.sdp),o=l.media.find(e=>"video"===e.type),p.addLegacySimulcast({offerMediaObject:o,track:e,numStreams:t.length}),a={type:"offer",sdp:n.write(l)}),v.debug("send() | calling pc.setLocalDescription() [offer:%o]",a),await this._pc.setLocalDescription(a),l=n.parse(this._pc.localDescription.sdp),o=l.media.find(t=>t.type===e.kind),h.rtcp.cname=u.getCname({offerMediaObject:o}),h.encodings=p.getRtpEncodings({offerMediaObject:o,track:e}),t)for(let e=0;e<h.encodings.length;++e)t[e]&&Object.assign(h.encodings[e],t[e]);if(h.encodings.length>1&&"video/vp8"===h.codecs[0].mimeType.toLowerCase())for(const e of h.encodings)e.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:o,offerRtpParameters:h,answerRtpParameters:m,codecOptions:i});const g={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("send() | calling pc.setRemoteDescription() [answer:%o]",g),await this._pc.setRemoteDescription(g);const f=String(this._nextSendLocalId);return this._nextSendLocalId++,this._mapSendLocalIdTrack.set(f,e),{localId:f,rtpParameters:h}}async stopSending(e){this.assertSendDirection(),v.debug("stopSending() [localId:%s]",e);const t=this._mapSendLocalIdTrack.get(e);if(!t)throw new Error("track not found");this._mapSendLocalIdTrack.delete(e),this._sendStream.removeTrack(t),this._pc.addStream(this._sendStream);const i=await this._pc.createOffer();v.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",i);try{await this._pc.setLocalDescription(i)}catch(e){if(0===this._sendStream.getTracks().length)return void v.warn("stopSending() | ignoring expected error due no sending tracks: %s",e.toString());throw e}if("stable"===this._pc.signalingState)return;const r={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r)}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,t){throw new l.UnsupportedError("not implemented")}async setMaxSpatialLayer(e,t){throw new l.UnsupportedError(" not implemented")}sync getSenderStats(e){throw new l.UnsupportedError("not implemented")}async sendDataChannel({ordered:e,maxPacketLifeTime:t,maxRetransmits:i,label:r,protocol:s}){var o;this.assertSendDirection();const a={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:t,maxRetransmitTime:t,maxRetransmits:i,protocol:s};v.debug("sendDataChannel() [options:%o]",a);const l=this._pc.createDataChannel(r,a);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%g.MIS,!this._hasDataChannelMediaSection){const e=await this._pc.createOffer(),t=n.parse(e.sdp),i=t.media.find(e=>"application"===e.type);this._transportReady||await this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:t}),v.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e),this._remoteSdp.sendSctpAssociation({offerMediaObject:i});const r={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r),this._hasDataChannelMediaSection=!0}return{dataChannel:l,sctpStreamParameters:{streamId:a.id,ordered:a.ordered,maxPacketLifeTime:a.maxPacketLifeTime,maxRetransmits:a.maxRetransmits}}}async receive(e){var t;this.assertRecvDirection();const i=[];for(const t of e){const{trackId:e,kind:i,rtpParameters:r,streamId:s}=t;v.debug("receive() [trackId:%s, kind:%s]",e,i);const o=i;this._remoteSdp.receive({mid:o,kind:i,offerRtpParameters:r,streamId:s||r.rtcp.cname,trackId:e})}const r={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);let s=await this._pc.createAnswer();const o=n.parse(s.sdp);for(const t of e){const{kind:e,rtpParameters:i}=t,r=e,s=o.media.find(e=>String(e.mid)===r);u.applyCodecParameters({offerRtpParameters:i,answerMediaObject:s})}s={type:"answer",sdp:n.write(o)},this._transportReady||await this.setupTransport({localDtlsRole:null!==(t=this._forcedLocalDtlsRole)&&void 0!==t?t:"client",localSdpObject:o}),v.debug("receive() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const t of e){const{kind:e,trackId:r,rtpParameters:s}=t,o=e,n=r,a=t.streamId||s.rtcp.cname,l=this._pc.getRemoteStreams().find(e=>e.id===a).getTrackById(n);if(!l)throw new Error("remote track not found");this._mapRecvLocalIdInfo.set(n,{mid:o,rtpParameters:s}),i.push({localId:n,track:l})}return i}async stopReceiving(e){this.assertRecvDirection();for(const t of e){v.debug("stopReceiving() [localId:%s]",t);const{mid:e,rtpParameters:i}=this._mapRecvLocalIdInfo.get(t)||{};this._mapRecvLocalIdInfo.delete(t),this._remoteSdp.planBStopReceiving({mid:e,offerRtpParameters:i})}const t={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const i=await this._pc.createAnswer();v.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i)}async pauseReceiving(e){}async resumeReceiving(e){}sync receiveDataChannel({sctpStreamParameters:e,label:t,protocol:i}){var r;this.assertRecvDirection();const{streamId:s,ordered:o,maxPacketLifeTime:a,maxRetransmits:l}=e,d={negotiated:!0,id:s,ordered:o,maxPacketLifeTime:a,maxRetransmitTime:a,maxRetransmits:l,protocol:i};v.debug("receiveDataChannel() [options:%o]",d);const c=this._pc.createDataChannel(t,d);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});const e={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();if(!this._transportReady){const e=n.parse(t.sdp);await this.setupTransport({localDtlsRole:null!==(r=this._forcedLocalDtlsRole)&&void 0!==r?r:"client",localSdpObject:e})}v.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setLocalDescription(t),this._hasDataChannelMediaSection=!0}return{dataChannel:c}}async setupTransport({localDtlsRole:e,localSdpObject:t}){t||(t=n.parse(this._pc.localDescription.sdp));const i=u.extractDtlsParameters({sdpObject:t});i.role=e,this._remoteSdp.updateDtlsRole("client"===e?"server":"client"),await new Promise((e,t)=>{this.safeEmit("@connect",{dtlsParameters:i},e,t)}),this._transportReady=!0}assertSendDirection(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}t.Chrome55=f},"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/Chrome67.js":function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var s=Object.getOwnPropertyDescriptor(t,i);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,s)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Chrome67=void 0;const n=o(i("./node_modules/sdp-transform/lib/index.js")),a=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/Logger.js"),l=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/utils.js")),d=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/ortc.js")),c=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/commonUtils.js")),u=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/planBUtils.js")),p=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/HandlerInterface.js"),h=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/RemoteSdp.js"),m=new a.Logger("Chrome67"),v={OS:1024,MIS:1024};class g extends p.HandlerInterface{static createFactory(){return()=>new g}et name(){return"Chrome67"}close(){if(m.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}sync getNativeSctpCapabilities(){return m.debug("getNativeSctpCapabilities()"),{numStreams:v}}run({direction:e,iceParameters:t,iceCandidates:i,dtlsParameters:r,sctpParameters:s,iceServers:o,iceTransportPolicy:n,additionalSettings:a,proprietaryConstraints:l,extendedRtpCapabilities:c}){m.debug("run()"),this._direction=e,this._remoteSdp=new h.RemoteSdp({iceParameters:t,iceCandidates:i,dtlsParameters:r,sctpParameters:s,planB:!0}),this._sendingRtpParametersByKind={audio:d.getSendingRtpParameters("audio",c),video:d.getSendingRtpParameters("video",c)},this._sendingRemoteRtpParametersByKind={audio:d.getSendingRemoteRtpParameters("audio",c),video:d.getSendingRemoteRtpParameters("video",c)},r.role&&"auto"!==r.role&&(this._forcedLocalDtlsRole="server"===r.role?"client":"server"),this._pc=new RTCPeerConnection({iceServers:o||[],iceTransportPolicy:n||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b",...a},l),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(m.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed")}})}async updateIceServers(e){m.debug("updateIceServers()");const t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(m.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady)if("send"===this._direction){const e=await this._pc.createOffer({iceRestart:!0});m.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e);const t={type:"answer",sdp:this._remoteSdp.getSdp()};m.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setRemoteDescription(t)}else{const e={type:"offer",sdp:this._remoteSdp.getSdp()};m.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();m.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",t),await this._pc.setLocalDescription(t)}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:t,codecOptions:i,codec:r}){var s;this.assertSendDirection(),m.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),r&&m.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(e),this._pc.addTrack(e,this._sendStream);let o,a=await this._pc.createOffer(),p=n.parse(a.sdp);const h=l.clone(this._sendingRtpParametersByKind[e.kind],{});h.codecs=d.reduceCodecs(h.codecs);const v=l.clone(this._sendingRemoteRtpParametersByKind[e.kind],{});if(v.codecs=d.reduceCodecs(v.codecs),this._transportReady||await this.setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:p}),"video"===e.kind&&t&&t.length>1&&(m.debug("send() | enabling simulcast"),p=n.parse(a.sdp),o=p.media.find(e=>"video"===e.type),u.addLegacySimulcast({offerMediaObject:o,track:e,numStreams:t.length}),a={type:"offer",sdp:n.write(p)}),m.debug("send() | calling pc.setLocalDescription() [offer:%o]",a),await this._pc.setLocalDescription(a),p=n.parse(this._pc.localDescription.sdp),o=p.media.find(,h.rtcp.cname=c.getCname({offerMediaObject:o}),h.encodings=u.getRtpEncodings({offerMediaObject:o,track:e}),t)for(let e=0;e<h.encodings.length;++e)t[e]&&Object.assign(h.encodings[e],t[e]);if(h.encodings.length>1&&"video/vp8"===h.codecs[0].mimeType.toLowerCase())for(const e of h.encodings)e.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:o,offerRtpParameters:h,answerRtpParameters:v,codecOptions:i});const g={type:"answer",sdp:this._remoteSdp.getSdp()};m.debug("send() | calling pc.setRemoteDescription() [answer:%o]",g),await this._pc.setRemoteDescription(g);const f=String(this._nextSendLocalId);this._nextSendLocalId++;const b=this._pc.getSenders().find(t=>t.track===e);return this._mapSendLocalIdRtpSender.set(f,b),{localId:f,rtpParameters:h,rtpSender:b}}async stopSending(e){this.assertSendDirection(),m.debug("stopSending() [localId:%s]",e);const t=this._mapSendLocalIdRtpSender.get(e);if(!t)throw new Error("associated RTCRtpSender not found");this._pc.removeTrack(t),t.track&&this._sendStream.removeTrack(t.track),this._mapSendLocalIdRtpSender.delete(e);const i=await this._pc.createOffer();m.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",i);try{await this._pc.setLocalDescription(i)}catch(e){if(0===this._sendStream.getTracks().length)return void m.warn("stopSending() | ignoring expected error due no sending tracks: %s",e.toString());throw e}if("stable"===this._pc.signalingState)return;const r={type:"answer",sdp:this._remoteSdp.getSdp()};m.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r)}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,t){this.assertSendDirection(),t?m.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):m.debug("replaceTrack() [localId:%s, no track]",e);const i=this._mapSendLocalIdRtpSender.get(e);if(!i)throw new Error("associated RTCRtpSender not found");const r=i.track;await i.replaceTrack(t),r&&this._sendStream.removeTrack(r),t&&this._sendStream.addTrack(t)}async setMaxSpatialLayer(e,t){this.assertSendDirection(),m.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);const i=this._mapSendLocalIdRtpSender.get(e);if(!i)throw new Error("associated RTCRtpSender not found");const r=i.getParameters();r.encodings.forEach((e,i)=>{e.active=i<=t}),await i.setParameters(r)}async setRtpEncodingParameters(e,t){this.assertSendDirection(),m.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);const i=this._mapSendLocalIdRtpSender.get(e);if(!i)throw new Error("associated RTCRtpSender not found");const r=i.getParameters();r.encodings.forEach((e,i)=>{r.encodings[i]={...e,...t}}),await i.setParameters(r)}async getSenderStats(e){this.assertSendDirection();const t=this._mapSendLocalIdRtpSender.get(e);if(!t)throw new Error("associated RTCRtpSender not found");return t.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:t,maxRetransmits:i,label:r,protocol:s}){var o;this.assertSendDirection();const a={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:t,maxRetransmitTime:t,maxRetransmits:i,protocol:s};m.debug("sendDataChannel() [options:%o]",a);const l=this._pc.createDataChannel(r,a);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%v.MIS,!this._hasDataChannelMediaSection){const e=await this._pc.createOffer(),t=n.parse(e.sdp),i=t.media.find(e=>"application"===e.type);this._transportReady||await this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:t}),m.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e),this._remoteSdp.sendSctpAssociation({offerMediaObject:i});const r={type:"answer",sdp:this._remoteSdp.getSdp()};m.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r),this._hasDataChannelMediaSection=!0}return{dataChannel:l,sctpStreamParameters:{streamId:a.id,ordered:a.ordered,maxPacketLifeTime:a.maxPacketLifeTime,maxRetransmits:a.maxRetransmits}}}async receive(e){var t;this.assertRecvDirection();const i=[];for(const t of e){const{trackId:e,kind:i,rtpParameters:r,streamId:s}=t;m.debug("receive() [trackId:%s, kind:%s]",e,i);const o=i;this._remoteSdp.receive({mid:o,kind:i,offerRtpParameters:r,streamId:s||r.rtcp.cname,trackId:e})}const r={type:"offer",sdp:this._remoteSdp.getSdp()};m.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);let s=await this._pc.createAnswer();const o=n.parse(s.sdp);for(const t of e){const{kind:e,rtpParameters:i}=t,r=e,s=o.media.find(e=>String(e.mid)===r);c.applyCodecParameters({offerRtpParameters:i,answerMediaObject:s})}s={type:"answer",sdp:n.write(o)},this._transportReady||await this.setupTransport({localDtlsRole:null!==(t=this._forcedLocalDtlsRole)&&void 0!==t?t:"client",localSdpObject:o}),m.debug("receive() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const t of e){const{kind:e,trackId:r,rtpParameters:s}=t,o=r,n=e,a=this._pc.getReceivers().find(;if(!a)throw new Error("new RTCRtpReceiver not");this._mapRecvLocalIdInfo.set(o,{mid:n,rtpParameters:s,rtpReceiver:a}),i.push({localId:o,track:a.track,rtpReceiver:a})}return i}async stopReceiving(e){this.assertRecvDirection();for(const t of e){m.debug("stopReceiving() [localId:%s]",t);const{mid:e,rtpParameters:i}=this._mapRecvLocalIdInfo.get(t)||{};this._mapRecvLocalIdInfo.delete(t),this._remoteSdp.planBStopReceiving({mid:e,offerRtpParameters:i})}const t={type:"offer",sdp:this._remoteSdp.getSdp()};m.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const i=await this._pc.createAnswer();m.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i)}async pauseReceiving(e){}async resumeReceiving(e){}async getReceiverStats(e){this.assertRecvDirection();const{rtpReceiver:t}=this._mapRecvLocalIdInfo.get(e)||{};if(!t)throw new Error("associated RTCRtpReceiver not found");return t.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:t,protocol:i}){var r;this.assertRecvDirection();const{streamId:s,ordered:o,maxPacketLifeTime:a,maxRetransmits:l}=e,d={negotiated:!0,id:s,ordered:o,maxPacketLifeTime:a,maxRetransmitTime:a,maxRetransmits:l,protocol:i};m.debug("receiveDataChannel() [options:%o]",d);const c=this._pc.createDataChannel(t,d);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});const e={type:"offer",sdp:this._remoteSdp.getSdp()};m.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();if(!this._transportReady){const e=n.parse(t.sdp);await this.setupTransport({localDtlsRole:null!==(r=this._forcedLocalDtlsRole)&&void 0!==r?r:"client",localSdpObject:e})}m.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setLocalDescription(t),this._hasDataChannelMediaSection=!0}return{dataChannel:c}}async setupTransport({localDtlsRole:e,localSdpObject:t}){t||(t=n.parse(this._pc.localDescription.sdp));const i=c.extractDtlsParameters({sdpObject:t});i.role=e,this._remoteSdp.updateDtlsRole("client"===e?"server":"client"),await new Promise((e,t)=>{this.safeEmit("@connect",{dtlsParameters:i},e,t)}),this._transportReady=!0}assertSendDirection(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}t.Chrome67=g},"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/Chrome70.js":function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var s=Object.getOwnPropertyDescriptor(t,i);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,s)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Chrome70=void 0;const n=o(i("./node_modules/sdp-transform/lib/index.js")),a=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/Logger.js"),l=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/utils.js")),d=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/ortc.js")),c=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/commonUtils.js")),u=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/unifiedPlanUtils.js")),p=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/HandlerInterface.js"),h=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/RemoteSdp.js"),m=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/scalabilityModes.js"),v=new a.Logger("Chrome70"),g={OS:1024,MIS:1024};class f extends p.HandlerInterface{static createFactory(){return()=>new f}constructor(){super(),this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"Chrome70"}close(){if(v.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}sync getNativeSctpCapabilities(){return v.debug("getNativeSctpCapabilities()"),{numStreams:g}}run({direction:e,iceParameters:t,iceCandidates:i,dtlsParameters:r,sctpParameters:s,iceServers:o,iceTransportPolicy:n,additionalSettings:a,proprietaryConstraints:l,extendedRtpCapabilities:c}){v.debug("run()"),this._direction=e,this._remoteSdp=new h.RemoteSdp({iceParameters:t,iceCandidates:i,dtlsParameters:r,sctpParameters:s}),this._sendingRtpParametersByKind={audio:d.getSendingRtpParameters("audio",c),video:d.getSendingRtpParameters("video",c)},this._sendingRemoteRtpParametersByKind={audio:d.getSendingRemoteRtpParameters("audio",c),video:d.getSendingRemoteRtpParameters("video",c)},r.role&&"auto"!==r.role&&(this._forcedLocalDtlsRole="server"===r.role?"client":"server"),this._pc=new RTCPeerConnection({iceServers:o||[],iceTransportPolicy:n||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...a},l),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(v.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed")}})}async updateIceServers(e){v.debug("updateIceServers()");const t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(v.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady)if("send"===this._direction){const e=await this._pc.createOffer({iceRestart:!0});v.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e);const t={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setRemoteDescription(t)}else{const e={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();v.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",t),await this._pc.setLocalDescription(t)}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:t,codecOptions:i,codec:r}){var s;this.assertSendDirection(),v.debug("send() [kind:%s, track.id:%s]",e.kind,e.id);const o=l.clone(this._sendingRtpParametersByKind[e.kind],{});o.codecs=d.reduceCodecs(o.codecs,r);const a=l.clone(this._sendingRemoteRtpParametersByKind[e.kind],{});a.codecs=d.reduceCodecs(a.codecs,r);const p=this._remoteSdp.getNextMediaSectionIdx(),h=this._pc.addTransceiver(e,{direction:"sendonly",streams:[this._sendStream]});let g,f=await this._pc.createOffer(),b=n.parse(f.sdp);this._transportReady||await this.setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:b}),t&&t.length>1&&(v.debug("send() | enabling legacy simulcast"),b=n.parse(f.sdp),g=b.media[p.idx],u.addLegacySimulcast({offerMediaObject:g,numStreams:t.length}),f={type:"offer",sdp:n.write(b)});let _=!1;const y=(0,m.parse)((t||[{}])[0].scalabilityMode);if(t&&1===t.length&&y.spatialLayers>1&&"video/vp9"===o.codecs[0].mimeType.toLowerCase()&&(v.debug("send() | enabling legacy simulcast for VP9 SVC"),_=!0,b=n.parse(f.sdp),g=b.media[p.idx],u.addLegacySimulcast({offerMediaObject:g,numStreams:y.spatialLayers}),f={type:"offer",sdp:n.write(b)}),v.debug("send() | calling pc.setLocalDescription() [offer:%o]",f),await this._pc.setLocalDescription(f),t){v.debug("send() | applying given encodings");const e=h.sender.getParameters();for(let i=0;i<(e.encodings||[]).length;++i){const r=e.encodings[i],s=t[i];if(!s)break;e.encodings[i]=Object.assign(r,s)}await h.sender.setParameters(e)}const w=h.mid;if(o.mid=w,b=n.parse(this._pc.localDescription.sdp),g=b.media[p.idx],o.rtcp.cname=c.getCname({offerMediaObject:g}),o.encodings=u.getRtpEncodings({offerMediaObject:g}),t)for(let e=0;e<o.encodings.length;++e)t[e]&&Object.assign(o.encodings[e],t[e]);if(_&&(o.encodings=[o.encodings[0]]),o.encodings.length>1&&("video/vp8"===o.codecs[0].mimeType.toLowerCase()||"video/h264"===o.codecs[0].mimeType.toLowerCase()))for(const e of o.encodings)e.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:g,reuseMid:p.reuseMid,offerRtpParameters:o,answerRtpParameters:a,codecOptions:i});const S={type:"answer",sdp:this._remoteSdp.getSdp()};return v.debug("send() | calling pc.setRemoteDescription() [answer:%o]",S),await this._pc.setRemoteDescription(S),this._mapMidTransceiver.set(w,h),{localId:w,rtpParameters:o,rtpSender:h.sender}}async stopSending(e){this.assertSendDirection(),v.debug("stopSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");t.sender.replaceTrack(null),this._pc.removeTrack(t.sender);if(this._remoteSdp.closeMediaSection(t.mid))try{t.stop()}catch(e){}const i=await this._pc.createOffer();v.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const r={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r),this._mapMidTransceiver.delete(e)}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,t){this.assertSendDirection(),t?v.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):v.debug("replaceTrack() [localId:%s, no track]",e);const i=this._mapMidTransceiver.get(e);if(!i)throw new Error("associated RTCRtpTransceiver not found");await i.sender.replaceTrack(t)}async setMaxSpatialLayer(e,t){this.assertSendDirection(),v.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);const i=this._mapMidTransceiver.get(e);if(!i)throw new Error("associated RTCRtpTransceiver not found");const r=i.sender.getParameters();r.encodings.forEach((e,i)=>{e.active=i<=t}),await i.sender.setParameters(r),this._remoteSdp.muxMediaSectionSimulcast(e,r.encodings);const s=await this._pc.createOffer();v.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async setRtpEncodingParameters(e,t){this.assertSendDirection(),v.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);const i=this._mapMidTransceiver.get(e);if(!i)throw new Error("associated RTCRtpTransceiver not found");const r=i.sender.getParameters();r.encodings.forEach((e,i)=>{r.encodings[i]={...e,...t}}),await i.sender.setParameters(r),this._remoteSdp.muxMediaSectionSimulcast(e,r.encodings);const s=await this._pc.createOffer();v.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async getSenderStats(e){this.assertSendDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.sender.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:t,maxRetransmits:i,label:r,protocol:s}){var o;this.assertSendDirection();const a={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:t,maxRetransmitTime:t,maxRetransmits:i,protocol:s};v.debug("sendDataChannel() [options:%o]",a);const l=this._pc.createDataChannel(r,a);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%g.MIS,!this._hasDataChannelMediaSection){const e=await this._pc.createOffer(),t=n.parse(e.sdp),i=t.media.find(e=>"application"===e.type);this._transportReady||await this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:t}),v.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e),this._remoteSdp.sendSctpAssociation({offerMediaObject:i});const r={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r),this._hasDataChannelMediaSection=!0}return{dataChannel:l,sctpStreamParameters:{streamId:a.id,ordered:a.ordered,maxPacketLifeTime:a.maxPacketLifeTime,maxRetransmits:a.maxRetransmits}}}async receive(e){var t;this.assertRecvDirection();const i=[],r=new Map;for(const t of e){const{trackId:e,kind:i,rtpParameters:s,streamId:o}=t;v.debug("receive() [trackId:%s, kind:%s]",e,i);const n=s.mid||String(this._mapMidTransceiver.size);r.set(e,n),this._remoteSdp.receive({mid:n,kind:i,offerRtpParameters:s,streamId:o||s.rtcp.cname,trackId:e})}const s={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",s),await this._pc.setRemoteDescription(s);let o=await this._pc.createAnswer();const a=n.parse(o.sdp);for(const t of e){const{trackId:e,rtpParameters:i}=t,s=r.get(e),o=a.media.find(e=>String(e.mid)===s);c.applyCodecParameters({offerRtpParameters:i,answerMediaObject:o})}o={type:"answer",sdp:n.write(a)},this._transportReady||await this.setupTransport({localDtlsRole:null!==(t=this._forcedLocalDtlsRole)&&void 0!==t?t:"client",localSdpObject:a}),v.debug("receive() | calling pc.setLocalDescription() [answer:%o]",o),await this._pc.setLocalDescription(o);for(const t of e){const{trackId:e}=t,s=r.get(e),o=this._pc.getTransceivers().find(e=>e.mid===s);if(!o)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(s,o),i.push({localId:s,track:o.receiver.track,rtpReceiver:o.receiver})}return i}async stopReceiving(e){this.assertRecvDirection();for(const t of e){v.debug("stopReceiving() [localId:%s]",t);const e=this._mapMidTransceiver.get(t);if(!e)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(e.mid)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const i=await this._pc.createAnswer();v.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const t of e)this._mapMidTransceiver.delete(t)}async pauseReceiving(e){}sync getReceiverStats(e){this.assertRecvDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:t,protocol:i}){var r;this.assertRecvDirection();const{streamId:s,ordered:o,maxPacketLifeTime:a,maxRetransmits:l}=e,d={negotiated:!0,id:s,ordered:o,maxPacketLifeTime:a,maxRetransmitTime:a,maxRetransmits:l,protocol:i};v.debug("receiveDataChannel() [options:%o]",d);const c=this._pc.createDataChannel(t,d);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const e={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();if(!this._transportReady){const e=n.parse(t.sdp);await this.setupTransport({localDtlsRole:null!==(r=this._forcedLocalDtlsRole)&&void 0!==r?r:"client",localSdpObject:e})}v.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setLocalDescription(t),this._hasDataChannelMediaSection=!0}return{dataChannel:c}}async setupTransport({localDtlsRole:e,localSdpObject:t}){t||(t=n.parse(this._pc.localDescription.sdp));const i=c.extractDtlsParameters({sdpObject:t});i.role=e,this._remoteSdp.updateDtlsRole("client"===e?"server":"client"),await new Promise(,this._transportReady=!0}assertSendDirection(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirectiont.Chrome70=f},"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/Chrome74.js":function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?,s=this&&this.__setModuleDefault||(Object.create?,o=this&&this.__importStar||Object.defineProperty(t,"__esModule",{value:!0}),t.Chrome74=void 0;const n=o(i("./node_modules/sdp-transform/lib/index.js")),a=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/Logger.js"),l=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/utils.js")),d=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/ortc.js")),c=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/commonUtils.js")),u=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/unifiedPlanUtils.js")),p=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/ortc/utils.js")),h=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/HandlerInterface.js"),m=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/RemoteSdp.js"),v=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/scalabilityModes.js"),g=new a.Logger("Chrome74"),f={OS:1024,MIS:1024};class b extends h.HandlerInterface{c getNativeRtpCapabilities(){g.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{e.addTransceiver("audio"),e.addTransceiver("video");const t=await e.createOffer();try{e.close()}catch(e){}const i=n.parse(t.sdp),r=c.extractRtpCapabilities({sdpObject:i});return p.addNackSuppportForOpus(r),r}catch(t){try{e.close()}catch(e){}throw t}}un({direction:e,iceParameters:t,iceCandidates:i,dtlsParameters:r,sctpParameters:s,iceServers:o,iceTransportPolicy:n,additionalSettings:a,proprietaryConstraints:l,extendedRtpCapabilities:c}){g.debug("run()"),this._direction=e,this._remoteSdp=new m.RemoteSdp({iceParameters:t,iceCandidates:i,dtlsParameters:r,sctpParameters:s}),this._sendingRtpParametersByKind={audio:d.getSendingRtpParameters("audio",c),video:d.getSendingRtpParameters("video",c)},this._sendingRemoteRtpParametersByKind={audio:d.getSendingRemoteRtpParameters("audio",c),video:d.getSendingRemoteRtpParameters("video",c)},r.role&&"auto"!==r.role&&(this._forcedLocalDtlsRole="server"===r.role?"client":"server"),this._pc=new RTCPeerConnection({iceServers:o||[],iceTransportPolicy:n||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...a},l),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",:(g.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",)}sync restartIce(e){if(g.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady)if("send"===this._direction){const e=await this._pc.createOffer({iceRestart:!0});g.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e);const t={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setRemoteDescription(t)}else{const e={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();g.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",t),await this._pc.setLocalDescription(t)}}sync send({track:e,encodings:t,codecOptions:i,codec:r}){var s;this.assertSendDirection(),g.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),t&&t.length>1&&t.forEach((e,t)=>{e.rid="r"+t});const o=l.clone(this._sendingRtpParametersByKind[e.kind],{});o.codecs=d.reduceCodecs(o.codecs,r);const a=l.clone(this._sendingRemoteRtpParametersByKind[e.kind],{});a.codecs=d.reduceCodecs(a.codecs,r);const p=this._remoteSdp.getNextMediaSectionIdx(),h=this._pc.addTransceiver(e,{direction:"sendonly",streams:[this._sendStream],sendEncodings:t});let m,f=await this._pc.createOffer(),b=n.parse(f.sdp);this._transportReady||await this.setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:b});let _=!1;const y=(0,v.parse)((t||[{}])[0].scalabilityMode);t&&1===t.length&&y.spatialLayers>1&&"video/vp9"===o.codecs[0].mimeType.toLowerCase()&&(g.debug("send() | enabling legacy simulcast for VP9 SVC"),_=!0,b=n.parse(f.sdp),m=b.media[p.idx],u.addLegacySimulcast({offerMediaObject:m,numStreams:y.spatialLayers}),f={type:"offer",sdp:n.write(b)}),g.debug("send() | calling pc.setLocalDescription() [offer:%o]",f),await this._pc.setLocalDescription(f);const w=h.mid;if(o.mid=w,b=n.parse(this._pc.localDescription.sdp),m=b.media[p.idx],o.rtcp.cname=c.getCname({offerMediaObject:m}),t)if(1===t.length){let e=u.getRtpEncodings({offerMediaObject:m});Object.assign(e[0],t[0]),_&&(e=[e[0]]),o.encodings=e}else o.encodings=t;else o.encodings=u.getRtpEncodings({offerMediaObject:m});if(o.encodings.length>1&&("video/vp8"===o.codecs[0].mimeType.toLowerCase()||"video/h264"===o.codecs[0].mimeType.toLowerCase()))for(const e of o.encodings)e.scalabilityMode?e.scalabilityMode="L1T"+y.temporalLayers:e.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:m,reuseMid:p.reuseMid,offerRtpParameters:o,answerRtpParameters:a,codecOptions:i,extmapAllowMixed:!0});const S={type:"answer",sdp:this._remoteSdp.getSdp()};return g.debug("send() | calling pc.setRemoteDescription() [answer:%o]",S),await this._pc.setRemoteDescription(S),this._mapMidTransceiver.set(w,h),{localId:w,rtpParameters:o,rtpSender:h.sender}}async stopSending(e){this.assertSendDirection(),g.debug("stopSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");t.sender.replaceTrack(null),this._pc.removeTrack(t.sender);if(this._remoteSdp.closeMediaSection(t.mid))try{t.stop()}catch(e){}const i=await this._pc.createOffer();g.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const r={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r),this._mapMidTransceiver.delete(e)}async pauseSending(e){this.assertSendDirection(),g.debug("pauseSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");t.direction="inactive",this._remoteSdp.pauseMediaSection(e);const i=await this._pc.createOffer();g.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const r={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r)}async resumeSending(e){this.assertSendDirection(),g.debug("resumeSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(this._remoteSdp.resumeSendingMediaSection(e),!t)throw new Error("associated RTCRtpTransceiver not found");t.direction="sendonly";const i=await this._pc.createOffer();g.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const r={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r)}async replaceTrack(e,t){this.assertSendDirection(),t?g.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):g.debug("replaceTrack() [localId:%s, no track]",e);const i=this._mapMidTransceiver.get(e);if(!i)throw new Error("associated RTCRtpTransceiver not found");await i.sender.replaceTrack(t)}async setMaxSpatialLayer(e,t){this.assertSendDirection(),g.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);const i=this._mapMidTransceiver.get(e);if(!i)throw new Error("associated RTCRtpTransceiver not found");const r=i.sender.getParameters();r.encodings.forEach(,await i.sender.setParameters(r),this._remoteSdp.muxMediaSectionSimulcast(e,r.encodings);const s=await this._pc.createOffer();g.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async setRtpEncodingParameters(e,t){this.assertSendDirection(),g.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);const i=this._mapMidTransceiver.get(e);if(!i)throw new Error("associated RTCRtpTransceiver not found");const r=i.sender.getParameters();r.encodings.forEach(,await i.sender.setParameters(r),this._remoteSdp.muxMediaSectionSimulcast(e,r.encodings);const s=await this._pc.createOffer();g.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async getSenderStats(e){this.assertSendDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.sender.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:t,maxRetransmits:i,label:r,protocol:s}){var o;this.assertSendDirection();const a={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:t,maxRetransmits:i,protocol:s};g.debug("sendDataChannel() [options:%o]",a);const l=this._pc.createDataChannel(r,a);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%f.MIS,!this._hasDataChannelMediaSection){const e=await this._pc.createOffer(),t=n.parse(e.sdp),i=t.media.find(;this._transportReady||await this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:t}),g.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e),this._remoteSdp.sendSctpAssociation({offerMediaObject:i});const r={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r),this._hasDataChannelMediaSection=!0}return{dataChannel:l,sctpStreamParameters:{streamId:a.id,ordered:a.ordered,maxPacketLifeTime:a.maxPacketLifeTime,maxRetransmits:a.maxRetransmits}}}async receive(e){var t;this.assertRecvDirection();const i=[],r=new Map;for(const t of e){const{trackId:e,kind:i,rtpParameters:s,streamId:o}=t;g.debug("receive() [trackId:%s, kind:%s]",e,i);const n=s.mid||String(this._mapMidTransceiver.size);r.set(e,n),this._remoteSdp.receive({mid:n,kind:i,offerRtpParameters:s,streamId:o||s.rtcp.cname,trackId:e})}const s={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",s),await this._pc.setRemoteDescription(s);let o=await this._pc.createAnswer();const a=n.parse(o.sdp);for(const t of e){const{trackId:e,rtpParameters:i}=t,s=r.get(e),o=a.media.find(;c.applyCodecParameters({offerRtpParameters:i,answerMediaObject:o})}o={type:"answer",sdp:n.write(a)},this._transportReady||await this.setupTransport({localDtlsRole:null!==(t=this._forcedLocalDtlsRole)&&void 0!==t?t:"client",localSdpObject:a}),g.debug("receive() | calling pc.setLocalDescription() [answer:%o]",o),await this._pc.setLocalDescription(o);for(const t of e){const{trackId:e}=t,s=r.get(e),o=this._pc.getTransceivers().find(;if(!o)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(s,o),i.push({localId:s,track:o.receiver.track,rtpReceiver:o.receiver})}return i}async stopReceiving(e){this.assertRecvDirection();for(const t of e){g.debug("stopReceiving() [localId:%s]",t);const e=this._mapMidTransceiver.get(t);if(!e)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(e.mid)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const i=await this._pc.createAnswer();g.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const t of e)this._mapMidTransceiver.delete(t)}async pauseReceiving(e){this.assertRecvDirection();for(const t of e){g.debug("pauseReceiving() [localId:%s]",t);const e=this._mapMidTransceiver.get(t);if(!e)throw new Error("associated RTCRtpTransceiver not found");e.direction="inactive",this._remoteSdp.pauseMediaSection(t)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const i=await this._pc.createAnswer();g.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i)}async resumeReceiving(e){this.assertRecvDirection();for(const t of e){g.debug("resumeReceiving() [localId:%s]",t);const e=this._mapMidTransceiver.get(t);if(!e)throw new Error("associated RTCRtpTransceiver not found");e.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(t)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const i=await this._pc.createAnswer();g.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i)}async getReceiverStats(e){this.assertRecvDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:t,protocol:i}){var r;this.assertRecvDirection();const{streamId:s,ordered:o,maxPacketLifeTime:a,maxRetransmits:l}=e,d={negotiated:!0,id:s,ordered:o,maxPacketLifeTime:a,maxRetransmits:l,protocol:i};g.debug("receiveDataChannel() [options:%o]",d);const c=this._pc.createDataChannel(t,d);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const e={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();if(!this._transportReady){const e=n.parse(t.sdp);await this.setupTransport({localDtlsRole:null!==(r=this._forcedLocalDtlsRole)&&void 0!==r?r:"client",localSdpObject:e})}g.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setLocalDescription(t),this._hasDataChannelMediaSection=!0}return{dataChannel:c}}async setupTransport({localDtlsRole:e,localSdpObject:t}){t||(t=n.parse(this._pc.localDescription.sdp));const i=c.extractDtlsParameters({sdpObject:t});i.role=e,this._remoteSdp.updateDtlsRole("client"===e?"server":"client"),await new Promise((e,t)=>{this.safeEmit("@connect",{dtlsParameters:i},e,t)}),this._transportReady=!0}assertSendDirection(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}t.Chrome74=b},"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/Edge11.js":function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var s=Object.getOwnPropertyDescriptor(t,i);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,s)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Edge11=void 0;const n=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/Logger.js"),a=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/errors.js"),l=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/utils.js")),d=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/ortc.js")),c=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/ortc/edgeUtils.js")),u=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/HandlerInterface.js"),p=new n.Logger("Edge11");class h extends u.HandlerInterface{static createFactory(){return()=>new h}et name(){return"Edge11"}({direction:e,iceParameters:t,iceCandidates:i,dtlsParameters:r,sctpParameters:s,iceServers:o,iceTransportPolicy:n,additionalSettings:a,proprietaryConstraints:c,extendedRtpCapabilities:u}){p.debug("run()"),this._sendingRtpParametersByKind={audio:d.getSendingRtpParameters("audio",u),video:d.getSendingRtpParameters("video",u)},this._remoteIceParameters=t,this._remoteIceCandidates=i,this._remoteDtlsParameters=r,this._cname="CNAME-"+l.generateRandomNumber(),this.setIceGatherer({iceServers:o,iceTransportPolicy:n}),this.setIceTransport(),this.setDtlsTransport()}async updateIceServers(e){throw new a.UnsupportedError("not supported")}async restartIce(e){if(p.debug("restartIce()"),this._remoteIceParameters=e,this._transportReady){p.debug("restartIce() | calling iceTransport.start()"),this._iceTransport.start(this._iceGatherer,e,"controlling");for(const e of this._remoteIceCandidates)this._iceTransport.addRemoteCandidate(e);this._iceTransport.addRemoteCandidate({})}}async getTransportStats(){return this._iceTransport.getStats()}async send({track:e,encodings:t,codecOptions:i,codec:r}){p.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),this._transportReady||await this.setupTransport({localDtlsRole:"server"}),p.debug("send() | calling new RTCRtpSender()");const s=new RTCRtpSender(e,this._dtlsTransport),o=l.clone(this._sendingRtpParametersByKind[e.kind],{});o.codecs=d.reduceCodecs(o.codecs,r);const n=o.codecs.some(;t||(t=[{}]);for(const e of t)e.ssrc=l.generateRandomNumber(),n&&(e.rtx={ssrc:l.generateRandomNumber()});o.encodings=t,o.rtcp={cname:this._cname,reducedSize:!0,mux:!0};const a=c.mangleRtpParameters(o);p.debug("send() | calling rtpSender.send() [params:%o]",a),await s.send(a);const u=String(this._nextSendLocalId);return this._nextSendLocalId++,this._rtpSenders.set(u,s),{localId:u,rtpParameters:o,rtpSender:s}}async stopSending(e){p.debug("stopSending() [localId:%s]",e);const t=this._rtpSenders.get(e);if(!t)throw new Error("RTCRtpSender not found");this._rtpSenders.delete(e);try{p.debug("stopSending() | calling rtpSender.stop()"),t.stop()}catch(e){throw p.warn("stopSending() | rtpSender.stop() failed:%o",e),e}}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,t){t?p.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):p.debug("replaceTrack() [localId:%s, no track]",e);const i=this._rtpSenders.get(e);if(!i)throw new Error("RTCRtpSender not found");i.setTrack(t)}async setMaxSpatialLayer(e,t){p.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);const i=this._rtpSenders.get(e);if(!i)throw new Error("RTCRtpSender not found");const r=i.getParameters();r.encodings.forEach((e,i)=>{e.active=i<=t}),await i.setParameters(r)}async setRtpEncodingParameters(e,t){p.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);const i=this._rtpSenders.get(e);if(!i)throw new Error("RTCRtpSender not found");const r=i.getParameters();r.encodings.forEach((e,i)=>{r.encodings[i]={...e,...t}}),await i.setParameters(r)}async getSenderStats(e){const t=this._rtpSenders.get(e);if(!t)throw new Error("RTCRtpSender not found");return t.getStats()}async sendDataChannel(e){throw new a.UnsupportedError("not implemented")}async receive(e){const t=[];for(const t of e){const{trackId:e,kind:i}=t;p.debug("receive() [trackId:%s, kind:%s]",e,i)}this._transportReady||await this.setupTransport({localDtlsRole:"server"});for(const i of e){const{trackId:e,kind:r,rtpParameters:s}=i;p.debug("receive() | calling new RTCRtpReceiver()");const o=new RTCRtpReceiver(this._dtlsTransport,r);o.addEventListener("error",e=>{p.error('rtpReceiver "error" event [event:%o]',e)});const n=c.mangleRtpParameters(s);p.debug("receive() | calling rtpReceiver.receive() [params:%o]",n),await o.receive(n);const a=e;this._rtpReceivers.set(a,o),t.push({localId:a,track:o.track,rtpReceiver:o})}return t}async stopReceiving(e){for(const t of e){p.debug("stopReceiving() [localId:%s]",t);const e=this._rtpReceivers.get(t);if(!e)throw new Error("RTCRtpReceiver not found");this._rtpReceivers.delete(t);try{p.debug("stopReceiving() | calling rtpReceiver.stop()"),e.stop()}catch(e){p.warn("stopReceiving() | rtpReceiver.stop() failed:%o",e)}}}async pauseReceiving(e){}async resumeReceiving(e){}async getReceiverStats(e){const t=this._rtpReceivers.get(e);if(!t)throw new Error("RTCRtpReceiver not found");return t.getStats()}async receiveDataChannel(e){throw new a.UnsupportedError("not implemented")}setIceGatherer({iceServers:e,iceTransportPolicy:t}){const i=new RTCIceGatherer({iceServers:e||[],gatherPolicy:t||"all"});i.addEventListener("error",e=>{p.error('iceGatherer "error" event [event:%o]',e)});try{i.gather()}catch(e){p.debug("setIceGatherer() | iceGatherer.gather() failed: %s",e.toString())}this._iceGatherer=i}ync setupTransport({localDtlsRole:e}){p.debug("setupTransport()");const t=this._dtlsTransport.getLocalParameters();t.role=e,await new Promise((e,i)=>{this.safeEmit("@connect",{dtlsParameters:t},e,i)}),this._iceTransport.start(this._iceGatherer,this._remoteIceParameters,"controlling");for(const e of this._remoteIceCandidates)this._iceTransport.addRemoteCandidate(e);this._iceTransport.addRemoteCandidate({}),this._remoteDtlsParameters.fingerprints=this._remoteDtlsParameters.fingerprints.filter(,this._dtlsTransport.start(this._remoteDtlsParameters),this._transportReady=!0}}t.Edge11=h},"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/Firefox60.js":function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var s=Object.getOwnPropertyDescriptor(t,i);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,s)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Firefox60=void 0;const n=o(i("./node_modules/sdp-transform/lib/index.js")),a=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/Logger.js"),l=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/errors.js"),d=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/utils.js")),c=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/ortc.js")),u=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/commonUtils.js")),p=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/unifiedPlanUtils.js")),h=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/HandlerInterface.js"),m=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/RemoteSdp.js"),v=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/scalabilityModes.js"),g=new a.Logger("Firefox60"),f={OS:16,MIS:2048};class b extends h.HandlerInterface{static createFactory(){return()=>new b}constructor(){super(),this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"Firefox60"}close(){if(g.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}async getNativeRtpCapabilities(){g.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"}),t=document.createElement("canvas");t.getContext("2d");const i=t.captureStream().getVideoTracks()[0];try{e.addTransceiver("audio",{direction:"sendrecv"});const r=e.addTransceiver(i,{direction:"sendrecv"}),s=r.sender.getParameters(),o=[{rid:"r0",maxBitrate:1e5},{rid:"r1",maxBitrate:5e5}];s.encodings=o,await r.sender.setParameters(s);const a=await e.createOffer();try{t.remove()}catch(e){}try{i.stop()}catch(e){}try{e.close()}catch(e){}const l=n.parse(a.sdp);return u.extractRtpCapabilities({sdpObject:l})}catch(r){try{t.remove()}catch(e){}try{i.stop()}catch(e){}try{e.close()}catch(e){}throw r}}async getNativeSctpCapabilities(){return g.debug("getNativeSctpCapabilities()"),{numStreams:f}}run({direction:e,iceParameters:t,iceCandidates:i,dtlsParameters:r,sctpParameters:s,iceServers:o,iceTransportPolicy:n,additionalSettings:a,proprietaryConstraints:l,extendedRtpCapabilities:d}){g.debug("run()"),this._direction=e,this._remoteSdp=new m.RemoteSdp({iceParameters:t,iceCandidates:i,dtlsParameters:r,sctpParameters:s}),this._sendingRtpParametersByKind={audio:c.getSendingRtpParameters("audio",d),video:c.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:c.getSendingRemoteRtpParameters("audio",d),video:c.getSendingRemoteRtpParameters("video",d)},this._pc=new RTCPeerConnection({iceServers:o||[],iceTransportPolicy:n||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...a},l),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(g.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed")}})}async updateIceServers(e){throw new l.UnsupportedError("not supported")}async restartIce(e){if(g.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady)if("send"===this._direction){const e=await this._pc.createOffer({iceRestart:!0});g.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e);const t={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setRemoteDescription(t)}else{const e={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();g.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",t),await this._pc.setLocalDescription(t)}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:t,codecOptions:i,codec:r}){this.assertSendDirection(),g.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),t&&(t=d.clone(t,[])).length>1&&(t.forEach((e,t)=>{e.rid="r"+t}),t.reverse());const s=d.clone(this._sendingRtpParametersByKind[e.kind],{});s.codecs=c.reduceCodecs(s.codecs,r);const o=d.clone(this._sendingRemoteRtpParametersByKind[e.kind],{});o.codecs=c.reduceCodecs(o.codecs,r);const a=this._pc.addTransceiver(e,{direction:"sendonly",streams:[this._sendStream]});if(t){const e=a.sender.getParameters();e.encodings=t,await a.sender.setParameters(e)}const l=await this._pc.createOffer();let h=n.parse(l.sdp);this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:h});const m=(0,v.parse)((t||[{}])[0].scalabilityMode);g.debug("send() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l);const f=a.mid;s.mid=f,h=n.parse(this._pc.localDescription.sdp);const b=h.media[h.media.length-1];if(s.rtcp.cname=u.getCname({offerMediaObject:b}),t)if(1===t.length){const e=p.getRtpEncodings({offerMediaObject:b});Object.assign(e[0],t[0]),s.encodings=e}else s.encodings=t.reverse();else s.encodings=p.getRtpEncodings({offerMediaObject:b});if(s.encodings.length>1&&("video/vp8"===s.codecs[0].mimeType.toLowerCase()||"video/h264"===s.codecs[0].mimeType.toLowerCase()))for(const e of s.encodings)e.scalabilityMode?e.scalabilityMode="L1T"+m.temporalLayers:e.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:b,offerRtpParameters:s,answerRtpParameters:o,codecOptions:i,extmapAllowMixed:!0});const _={type:"answer",sdp:this._remoteSdp.getSdp()};return g.debug("send() | calling pc.setRemoteDescription() [answer:%o]",_),await this._pc.setRemoteDescription(_),this._mapMidTransceiver.set(f,a),{localId:f,rtpParameters:s,rtpSender:a.sender}}async stopSending(e){g.debug("stopSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated transceiver not found");t.sender.replaceTrack(null),this._pc.removeTrack(t.sender),this._remoteSdp.disableMediaSection(t.mid);const i=await this._pc.createOffer();g.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const r={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r),this._mapMidTransceiver.delete(e)}async pauseSending(e){this.assertSendDirection(),g.debug("pauseSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");t.direction="inactive",this._remoteSdp.pauseMediaSection(e);const i=await this._pc.createOffer();g.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const r={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r)}async resumeSending(e){this.assertSendDirection(),g.debug("resumeSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");t.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(e);const i=await this._pc.createOffer();g.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const r={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r)}async replaceTrack(e,t){this.assertSendDirection(),t?g.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):g.debug("replaceTrack() [localId:%s, no track]",e);const i=this._mapMidTransceiver.get(e);if(!i)throw new Error("associated RTCRtpTransceiver not found");await i.sender.replaceTrack(t)}async setMaxSpatialLayer(e,t){this.assertSendDirection(),g.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);const i=this._mapMidTransceiver.get(e);if(!i)throw new Error("associated transceiver not found");const r=i.sender.getParameters();t=r.encodings.length-1-t,r.encodings.forEach((e,i)=>{e.active=i>=t}),await i.sender.setParameters(r),this._remoteSdp.muxMediaSectionSimulcast(e,r.encodings);const s=await this._pc.createOffer();g.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async setRtpEncodingParameters(e,t){this.assertSendDirection(),g.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);const i=this._mapMidTransceiver.get(e);if(!i)throw new Error("associated RTCRtpTransceiver not found");const r=i.sender.getParameters();r.encodings.forEach((e,i)=>{r.encodings[i]={...e,...t}}),await i.sender.setParameters(r),this._remoteSdp.muxMediaSectionSimulcast(e,r.encodings);const s=await this._pc.createOffer();g.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async getSenderStats(e){this.assertSendDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.sender.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:t,maxRetransmits:i,label:r,protocol:s}){this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:t,maxRetransmits:i,protocol:s};g.debug("sendDataChannel() [options:%o]",o);const a=this._pc.createDataChannel(r,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%f.MIS,!this._hasDataChannelMediaSection){const e=await this._pc.createOffer(),t=n.parse(e.sdp),i=t.media.find(e=>"application"===e.type);this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:t}),g.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e),this._remoteSdp.sendSctpAssociation({offerMediaObject:i});const r={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r),this._hasDataChannelMediaSection=!0}return{dataChannel:a,sctpStreamParameters:{streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits}}}async receive(e){this.assertRecvDirection();const t=[],i=new Map;for(const t of e){const{trackId:e,kind:r,rtpParameters:s,streamId:o}=t;g.debug("receive() [trackId:%s, kind:%s]",e,r);const n=s.mid||String(this._mapMidTransceiver.size);i.set(e,n),this._remoteSdp.receive({mid:n,kind:r,offerRtpParameters:s,streamId:o||s.rtcp.cname,trackId:e})}const r={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);let s=await this._pc.createAnswer();const o=n.parse(s.sdp);for(const t of e){const{trackId:e,rtpParameters:r}=t,a=i.get(e),l=o.media.find(e=>String(e.mid)===a);u.applyCodecParameters({offerRtpParameters:r,answerMediaObject:l}),s={type:"answer",sdp:n.write(o)}}this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:o}),g.debug("receive() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const r of e){const{trackId:e}=r,s=i.get(e),o=this._pc.getTransceivers().find(e=>e.mid===s);if(!o)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(s,o),t.push({localId:s,track:o.receiver.track,rtpReceiver:o.receiver})}return t}async stopReceiving(e){this.assertRecvDirection();for(const t of e){g.debug("stopReceiving() [localId:%s]",t);const e=this._mapMidTransceiver.get(t);if(!e)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(e.mid)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const i=await this._pc.createAnswer();g.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const t of e)this._mapMidTransceiver.delete(t)}async pauseReceiving(e){this.assertRecvDirection();for(const t of e){g.debug("pauseReceiving() [localId:%s]",t);const e=this._mapMidTransceiver.get(t);if(!e)throw new Error("associated RTCRtpTransceiver not found");e.direction="inactive",this._remoteSdp.pauseMediaSection(t)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const i=await this._pc.createAnswer();g.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i)}async resumeReceiving(e){this.assertRecvDirection();for(const t of e){g.debug("resumeReceiving() [localId:%s]",t);const e=this._mapMidTransceiver.get(t);if(!e)throw new Error("associated RTCRtpTransceiver not found");e.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(t)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const i=await this._pc.createAnswer();g.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i)}async getReceiverStats(e){this.assertRecvDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:t,protocol:i}){this.assertRecvDirection();const{streamId:r,ordered:s,maxPacketLifeTime:o,maxRetransmits:a}=e,l={negotiated:!0,id:r,ordered:s,maxPacketLifeTime:o,maxRetransmits:a,protocol:i};g.debug("receiveDataChannel() [options:%o]",l);const d=this._pc.createDataChannel(t,l);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const e={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();if(!this._transportReady){const e=n.parse(t.sdp);await this.setupTransport({localDtlsRole:"client",localSdpObject:e})}g.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setLocalDescription(t),this._hasDataChannelMediaSection=!0}return{dataChannel:d}}async setupTransport({localDtlsRole:e,localSdpObject:t}){t||(t=n.parse(this._pc.localDescription.sdp));const i=u.extractDtlsParameters({sdpObject:t});i.role=e,this._remoteSdp.updateDtlsRole("client"===e?"server":"client"),await new Promise((e,t)=>{this.safeEmit("@connect",{dtlsParameters:i},e,t)}),this._transportReady=!0}assertSendDirection(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}t.Firefox60=b},"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/HandlerInterface.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HandlerInterface=void 0;const r=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/EnhancedEventEmitter.js");.HandlerInterface=s},"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/ReactNative.js":function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var s=Object.getOwnPropertyDescriptor(t,i);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,s)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ReactNative=void 0;const n=o(i("./node_modules/sdp-transform/lib/index.js")),a=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/Logger.js"),l=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/errors.js"),d=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/utils.js")),c=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/ortc.js")),u=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/commonUtils.js")),p=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/planBUtils.js")),h=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/HandlerInterface.js"),m=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/RemoteSdp.js"),v=new a.Logger("ReactNative"),g={OS:1024,MIS:1024};class f extends h.HandlerInterface{static createFactory(){return()=>new f}constructor(){super(),this._sendStream=new MediaStream,this._mapSendLocalIdTrack=new Map,this._nextSendLocalId=0,this._mapRecvLocalIdInfo=new Map,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"ReactNative"}close(){if(v.debug("close()"),this._sendStream.release(!1),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}async getNativeRtpCapabilities(){v.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{const t=await e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{e.close()}catch(e){}const i=n.parse(t.sdp);return u.extractRtpCapabilities({sdpObject:i})}catch(t){try{e.close()}catch(e){}throw t}}async getNativeSctpCapabilities(){return v.debug("getNativeSctpCapabilities()"),{numStreams:g}}run({direction:e,iceParameters:t,iceCandidates:i,dtlsParameters:r,sctpParameters:s,iceServers:o,iceTransportPolicy:n,additionalSettings:a,proprietaryConstraints:l,extendedRtpCapabilities:d}){v.debug("run()"),this._direction=e,this._remoteSdp=new m.RemoteSdp({iceParameters:t,iceCandidates:i,dtlsParameters:r,sctpParameters:s,planB:!0}),this._sendingRtpParametersByKind={audio:c.getSendingRtpParameters("audio",d),video:c.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:c.getSendingRemoteRtpParameters("audio",d),video:c.getSendingRemoteRtpParameters("video",d)},r.role&&"auto"!==r.role&&(this._forcedLocalDtlsRole="server"===r.role?"client":"server"),this._pc=new RTCPeerConnection({iceServers:o||[],iceTransportPolicy:n||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b",...a},l),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(v.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed")}})}async updateIceServers(e){v.debug("updateIceServers()");const t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(v.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady)if("send"===this._direction){const e=await this._pc.createOffer({iceRestart:!0});v.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e);const t={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setRemoteDescription(t)}else{const e={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();v.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",t),await this._pc.setLocalDescription(t)}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:t,codecOptions:i,codec:r}){var s;this.assertSendDirection(),v.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),r&&v.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(e),this._pc.addStream(this._sendStream);let o,a=await this._pc.createOffer(),l=n.parse(a.sdp);const h=d.clone(this._sendingRtpParametersByKind[e.kind],{});h.codecs=c.reduceCodecs(h.codecs);const m=d.clone(this._sendingRemoteRtpParametersByKind[e.kind],{});if(m.codecs=c.reduceCodecs(m.codecs),this._transportReady||await this.setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:l}),"video"===e.kind&&t&&t.length>1&&(v.debug("send() | enabling simulcast"),l=n.parse(a.sdp),o=l.media.find(e=>"video"===e.type),p.addLegacySimulcast({offerMediaObject:o,track:e,numStreams:t.length}),a={type:"offer",sdp:n.write(l)}),v.debug("send() | calling pc.setLocalDescription() [offer:%o]",a),await this._pc.setLocalDescription(a),l=n.parse(this._pc.localDescription.sdp),o=l.media.find(t=>t.type===e.kind),h.rtcp.cname=u.getCname({offerMediaObject:o}),h.encodings=p.getRtpEncodings({offerMediaObject:o,track:e}),t)for(let e=0;e<h.encodings.length;++e)t[e]&&Object.assign(h.encodings[e],t[e]);if(h.encodings.length>1&&("video/vp8"===h.codecs[0].mimeType.toLowerCase()||"video/h264"===h.codecs[0].mimeType.toLowerCase()))for(const e of h.encodings)e.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:o,offerRtpParameters:h,answerRtpParameters:m,codecOptions:i});const g={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("send() | calling pc.setRemoteDescription() [answer:%o]",g),await this._pc.setRemoteDescription(g);const f=String(this._nextSendLocalId);return this._nextSendLocalId++,this._mapSendLocalIdTrack.set(f,e),{localId:f,rtpParameters:h}}async stopSending(e){this.assertSendDirection(),v.debug("stopSending() [localId:%s]",e);const t=this._mapSendLocalIdTrack.get(e);if(!t)throw new Error("track not found");this._mapSendLocalIdTrack.delete(e),this._sendStream.removeTrack(t),this._pc.addStream(this._sendStream);const i=await this._pc.createOffer();v.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",i);try{await this._pc.setLocalDescription(i)}catch(e){if(0===this._sendStream.getTracks().length)return void v.warn("stopSending() | ignoring expected error due no sending tracks: %s",e.toString());throw e}if("stable"===this._pc.signalingState)return;const r={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r)}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,t){throw new l.UnsupportedError("not implemented")}async setMaxSpatialLayer(e,t){throw new l.UnsupportedError("not implemented")}async setRtpEncodingParameters(e,t){throw new l.UnsupportedError("not implemented")}async getSenderStats(e){throw new l.UnsupportedError("not implemented")}async sendDataChannel({ordered:e,maxPacketLifeTime:t,maxRetransmits:i,label:r,protocol:s}){var o;this.assertSendDirection();const a={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:t,maxRetransmitTime:t,maxRetransmits:i,protocol:s};v.debug("sendDataChannel() [options:%o]",a);const l=this._pc.createDataChannel(r,a);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%g.MIS,!this._hasDataChannelMediaSection){const e=await this._pc.createOffer(),t=n.parse(e.sdp),i=t.media.find(e=>"application"===e.type);this._transportReady||await this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:t}),v.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e),this._remoteSdp.sendSctpAssociation({offerMediaObject:i});const r={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r),this._hasDataChannelMediaSection=!0}return{dataChannel:l,sctpStreamParameters:{streamId:a.id,ordered:a.ordered,maxPacketLifeTime:a.maxPacketLifeTime,maxRetransmits:a.maxRetransmits}}}async receive(e){var t;this.assertRecvDirection();const i=[],r=new Map;for(const t of e){const{trackId:e,kind:i,rtpParameters:s}=t;v.debug("receive() [trackId:%s, kind:%s]",e,i);const o=i;let n=t.streamId||s.rtcp.cname;v.debug("receive() | forcing a random remote streamId to avoid well known bug in react-native-webrtc"),n+="-hack-"+d.generateRandomNumber(),r.set(e,n),this._remoteSdp.receive({mid:o,kind:i,offerRtpParameters:s,streamId:n,trackId:e})}const s={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",s),await this._pc.setRemoteDescription(s);let o=await this._pc.createAnswer();const a=n.parse(o.sdp);for(const t of e){const{kind:e,rtpParameters:i}=t,r=e,s=a.media.find(e=>String(e.mid)===r);u.applyCodecParameters({offerRtpParameters:i,answerMediaObject:s})}o={type:"answer",sdp:n.write(a)},this._transportReady||await this.setupTransport({localDtlsRole:null!==(t=this._forcedLocalDtlsRole)&&void 0!==t?t:"client",localSdpObject:a}),v.debug("receive() | calling pc.setLocalDescription() [answer:%o]",o),await this._pc.setLocalDescription(o);for(const t of e){const{kind:e,trackId:s,rtpParameters:o}=t,n=s,a=e,l=r.get(s),d=this._pc.getRemoteStreams().find(e=>e.id===l).getTrackById(n);if(!d)throw new Error("remote track not found");this._mapRecvLocalIdInfo.set(n,{mid:a,rtpParameters:o}),i.push({localId:n,track:d})}return i}async stopReceiving(e){this.assertRecvDirection();for(const t of e){v.debug("stopReceiving() [localId:%s]",t);const{mid:e,rtpParameters:i}=this._mapRecvLocalIdInfo.get(t)||{};this._mapRecvLocalIdInfo.delete(t),this._remoteSdp.planBStopReceiving({mid:e,offerRtpParameters:i})}const t={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const i=await this._pc.createAnswer();v.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i)}async pauseReceiving(e){}async resumeReceiving(e){}async getReceiverStats(e){throw new l.UnsupportedError("not implemented")}async receiveDataChannel({sctpStreamParameters:e,label:t,protocol:i}){var r;this.assertRecvDirection();const{streamId:s,ordered:o,maxPacketLifeTime:a,maxRetransmits:l}=e,d={negotiated:!0,id:s,ordered:o,maxPacketLifeTime:a,maxRetransmitTime:a,maxRetransmits:l,protocol:i};v.debug("receiveDataChannel() [options:%o]",d);const c=this._pc.createDataChannel(t,d);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});const e={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();if(!this._transportReady){const e=n.parse(t.sdp);await this.setupTransport({localDtlsRole:null!==(r=this._forcedLocalDtlsRole)&&void 0!==r?r:"client",localSdpObject:e})}v.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setLocalDescription(t),this._hasDataChannelMediaSection=!0}return{dataChannel:c}}async setupTransport({localDtlsRole:e,localSdpObject:t}){t||(t=n.parse(this._pc.localDescription.sdp));const i=u.extractDtlsParameters({sdpObject:t});i.role=e,this._remoteSdp.updateDtlsRole("client"===e?"server":"client"),await new Promise((e,t)=>{this.safeEmit("@connect",{dtlsParameters:i},e,t)}),this._transportReady=!0}assertSendDirection(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}t.ReactNative=f},"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/ReactNativeUnifiedPlan.js":function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var s=Object.getOwnPropertyDescriptor(t,i);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,s)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ReactNativeUnifiedPlan=void 0;const n=o(i("./node_modules/sdp-transform/lib/index.js")),a=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/Logger.js"),l=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/utils.js")),d=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/ortc.js")),c=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/commonUtils.js")),u=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/unifiedPlanUtils.js")),p=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/ortc/utils.js")),h=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/HandlerInterface.js"),m=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/RemoteSdp.js"),v=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/scalabilityModes.js"),g=new a.Logger("ReactNativeUnifiedPlan"),f={OS:1024,MIS:1024};class b extends h.HandlerInterface{static createFactory(){return()=>new b}constructor(){super(),this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"ReactNativeUnifiedPlan"}sync getNativeRtpCapabilities(){g.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{e.addTransceiver("audio"),e.addTransceiver("video");const t=await e.createOffer();try{e.close()}catch(e){}const i=n.parse(t.sdp),r=c.extractRtpCapabilities({sdpObject:i});return p.addNackSuppportForOpus(r),r}catch(t){try{e.close()}catch(e){}throw t}}async getNativeSctpCapabilities(){return g.debug("getNativeSctpCapabilities()"),{numStreams:f}}run({direction:e,iceParameters:t,iceCandidates:i,dtlsParameters:r,sctpParameters:s,iceServers:o,iceTransportPolicy:n,additionalSettings:a,proprietaryConstraints:l,extendedRtpCapabilities:c}){g.debug("run()"),this._direction=e,this._remoteSdp=new m.RemoteSdp({iceParameters:t,iceCandidates:i,dtlsParameters:r,sctpParameters:s}),this._sendingRtpParametersByKind={audio:d.getSendingRtpParameters("audio",c),video:d.getSendingRtpParameters("video",c)},this._sendingRemoteRtpParametersByKind={audio:d.getSendingRemoteRtpParameters("audio",c),video:d.getSendingRemoteRtpParameters("video",c)},r.role&&"auto"!==r.role&&(this._forcedLocalDtlsRole="server"===r.role?"client":"server"),this._pc=new RTCPeerConnection({iceServers:o||[],iceTransportPolicy:n||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...a},l),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(g.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed")}})}async updateIceServers(e){g.debug("updateIceServers()");const t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(g.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady)if("send"===this._direction){const e=await this._pc.createOffer({iceRestart:!0});g.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e);const t={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setRemoteDescription(t)}else{const e={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();g.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",t),await this._pc.setLocalDescription(t)}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:t,codecOptions:i,codec:r}){var s;this.assertSendDirection(),g.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),t&&t.length>1&&t.forEach((e,t)=>{e.rid="r"+t});const o=l.clone(this._sendingRtpParametersByKind[e.kind],{});o.codecs=d.reduceCodecs(o.codecs,r);const a=l.clone(this._sendingRemoteRtpParametersByKind[e.kind],{});a.codecs=d.reduceCodecs(a.codecs,r);const p=this._remoteSdp.getNextMediaSectionIdx(),h=this._pc.addTransceiver(e,{direction:"sendonly",streams:[this._sendStream],sendEncodings:t});let m,f=await this._pc.createOffer(),b=n.parse(f.sdp);this._transportReady||await this.setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:b});let _=!1;const y=(0,v.parse)((t||[{}])[0].scalabilityMode);t&&1===t.length&&y.spatialLayers>1&&"video/vp9"===o.codecs[0].mimeType.toLowerCase()&&(g.debug("send() | enabling legacy simulcast for VP9 SVC"),_=!0,b=n.parse(f.sdp),m=b.media[p.idx],u.addLegacySimulcast({offerMediaObject:m,numStreams:y.spatialLayers}),f={type:"offer",sdp:n.write(b)}),g.debug("send() | calling pc.setLocalDescription() [offer:%o]",f),await this._pc.setLocalDescription(f);const w=h.mid;if(o.mid=w,b=n.parse(this._pc.localDescription.sdp),m=b.media[p.idx],o.rtcp.cname=c.getCname({offerMediaObject:m}),t)if(1===t.length){let e=u.getRtpEncodings({offerMediaObject:m});Object.assign(e[0],t[0]),_&&(e=[e[0]]),o.encodings=e}else o.encodings=t;else o.encodings=u.getRtpEncodings({offerMediaObject:m});if(o.encodings.length>1&&("video/vp8"===o.codecs[0].mimeType.toLowerCase()||"video/h264"===o.codecs[0].mimeType.toLowerCase()))for(const e of o.encodings)e.scalabilityMode?e.scalabilityMode="L1T"+y.temporalLayers:e.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:m,reuseMid:p.reuseMid,offerRtpParameters:o,answerRtpParameters:a,codecOptions:i,extmapAllowMixed:!0});const S={type:"answer",sdp:this._remoteSdp.getSdp()};return g.debug("send() | calling pc.setRemoteDescription() [answer:%o]",S),await this._pc.setRemoteDescription(S),this._mapMidTransceiver.set(w,h),{localId:w,rtpParameters:o,rtpSender:h.sender}}async stopSending(e){this.assertSendDirection(),g.debug("stopSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");t.sender.replaceTrack(null),this._pc.removeTrack(t.sender);if(this._remoteSdp.closeMediaSection(t.mid))try{t.stop()}catch(e){}const i=await this._pc.createOffer();g.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const r={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r),this._mapMidTransceiver.delete(e)}async pauseSending(e){this.assertSendDirection(),g.debug("pauseSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");t.direction="inactive",this._remoteSdp.pauseMediaSection(e);const i=await this._pc.createOffer();g.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const r={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r)}async resumeSending(e){this.assertSendDirection(),g.debug("resumeSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(this._remoteSdp.resumeSendingMediaSection(e),!t)throw new Error("associated RTCRtpTransceiver not found");t.direction="sendonly";const i=await this._pc.createOffer();g.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const r={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r)}async replaceTrack(e,t){this.assertSendDirection(),t?g.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):g.debug("replaceTrack() [localId:%s, no track]",e);const i=this._mapMidTransceiver.get(e);if(!i)throw new Error("associated RTCRtpTransceiver not found");await i.sender.replaceTrack(t)}async setMaxSpatialLayer(e,t){this.assertSendDirection(),g.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);const i=this._mapMidTransceiver.get(e);if(!i)throw new Error("associated RTCRtpTransceiver not found");const r=i.sender.getParameters();r.encodings.forEach((e,i)=>{e.active=i<=t}),await i.sender.setParameters(r),this._remoteSdp.muxMediaSectionSimulcast(e,r.encodings);const s=await this._pc.createOffer();g.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async setRtpEncodingParameters(e,t){this.assertSendDirection(),g.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);const i=this._mapMidTransceiver.get(e);if(!i)throw new Error("associated RTCRtpTransceiver not found");const r=i.sender.getParameters();r.encodings.forEach((e,i)=>{r.encodings[i]={...e,...t}}),await i.sender.setParameters(r),this._remoteSdp.muxMediaSectionSimulcast(e,r.encodings);const s=await this._pc.createOffer();g.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async getSenderStats(e){this.assertSendDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.sender.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:t,maxRetransmits:i,label:r,protocol:s}){var o;this.assertSendDirection();const a={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:t,maxRetransmits:i,protocol:s};g.debug("sendDataChannel() [options:%o]",a);const l=this._pc.createDataChannel(r,a);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%f.MIS,!this._hasDataChannelMediaSection){const e=await this._pc.createOffer(),t=n.parse(e.sdp),i=t.media.find(e=>"application"===e.type);this._transportReady||await this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:t}),g.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e),this._remoteSdp.sendSctpAssociation({offerMediaObject:i});const r={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r),this._hasDataChannelMediaSection=!0}return{dataChannel:l,sctpStreamParameters:{streamId:a.id,ordered:a.ordered,maxPacketLifeTime:a.maxPacketLifeTime,maxRetransmits:a.maxRetransmits}}}async receive(e){var t;this.assertRecvDirection();const i=[],r=new Map;for(const t of e){const{trackId:e,kind:i,rtpParameters:s,streamId:o}=t;g.debug("receive() [trackId:%s, kind:%s]",e,i);const n=s.mid||String(this._mapMidTransceiver.size);r.set(e,n),this._remoteSdp.receive({mid:n,kind:i,offerRtpParameters:s,streamId:o||s.rtcp.cname,trackId:e})}const s={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",s),await this._pc.setRemoteDescription(s);let o=await this._pc.createAnswer();const a=n.parse(o.sdp);for(const t of e){const{trackId:e,rtpParameters:i}=t,s=r.get(e),o=a.media.find(e=>String(e.mid)===s);c.applyCodecParameters({offerRtpParameters:i,answerMediaObject:o})}o={type:"answer",sdp:n.write(a)},this._transportReady||await this.setupTransport({localDtlsRole:null!==(t=this._forcedLocalDtlsRole)&&void 0!==t?t:"client",localSdpObject:a}),g.debug("receive() | calling pc.setLocalDescription() [answer:%o]",o),await this._pc.setLocalDescription(o);for(const t of e){const{trackId:e}=t,s=r.get(e),o=this._pc.getTransceivers().find(e=>e.mid===s);if(!o)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(s,o),i.push({localId:s,track:o.receiver.track,rtpReceiver:o.receiver})}return i}async stopReceiving(e){this.assertRecvDirection();for(const t of e){g.debug("stopReceiving() [localId:%s]",t);const e=this._mapMidTransceiver.get(t);if(!e)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(e.mid)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const i=await this._pc.createAnswer();g.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const t of e)this._mapMidTransceiver.delete(t)}async pauseReceiving(e){this.assertRecvDirection();for(const t of e){g.debug("pauseReceiving() [localId:%s]",t);const e=this._mapMidTransceiver.get(t);if(!e)throw new Error("associated RTCRtpTransceiver not found");e.direction="inactive",this._remoteSdp.pauseMediaSection(t)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const i=await this._pc.createAnswer();g.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i)}async resumeReceiving(e){this.assertRecvDirection();for(const t of e){g.debug("resumeReceiving() [localId:%s]",t);const e=this._mapMidTransceiver.get(t);if(!e)throw new Error("associated RTCRtpTransceiver not found");e.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(t)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const i=await this._pc.createAnswer();g.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i)}async getReceiverStats(e){this.assertRecvDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:t,protocol:i}){var r;this.assertRecvDirection();const{streamId:s,ordered:o,maxPacketLifeTime:a,maxRetransmits:l}=e,d={negotiated:!0,id:s,ordered:o,maxPacketLifeTime:a,maxRetransmits:l,protocol:i};g.debug("receiveDataChannel() [options:%o]",d);const c=this._pc.createDataChannel(t,d);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const e={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();if(!this._transportReady){const e=n.parse(t.sdp);await this.setupTransport({localDtlsRole:null!==(r=this._forcedLocalDtlsRole)&&void 0!==r?r:"client",localSdpObject:e})}g.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setLocalDescription(t),this._hasDataChannelMediaSection=!0}return{dataChannel:c}}async setupTransport({localDtlsRole:e,localSdpObject:t}){t||(t=n.parse(this._pc.localDescription.sdp));const i=c.extractDtlsParameters({sdpObject:t});i.role=e,this._remoteSdp.updateDtlsRole("client"===e?"server":"client"),await new Promise((e,t)=>{this.safeEmit("@connect",{dtlsParameters:i},e,t)}),this._transportReady=!0}assertSendDirection(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}t.ReactNativeUnifiedPlan=b},"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/Safari11.js":function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var s=Object.getOwnPropertyDescriptor(t,i);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,s)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Safari11=void 0;const n=o(i("./node_modules/sdp-transform/lib/index.js")),a=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/Logger.js"),l=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/utils.js")),d=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/ortc.js")),c=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/commonUtils.js")),u=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/planBUtils.js")),p=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/HandlerInterface.js"),h=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/RemoteSdp.js"),m=new a.Logger("Safari11"),v={OS:1024,MIS:1024};class g extends p.HandlerInterface{static createFactory(){return()=>new g}constructor(){super(),this._sendStream=new MediaStream,this._mapSendLocalIdRtpSender=new Map,this._nextSendLocalId=0,this._mapRecvLocalIdInfo=new Map,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"Safari11"}close(){if(m.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}async getNativeRtpCapabilities(){m.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{const t=await e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{e.close()}catch(e){}const i=n.parse(t.sdp);return c.extractRtpCapabilities({sdpObject:i})}catch(t){try{e.close()}catch(e){}throw t}}async getNativeSctpCapabilities(){return m.debug("getNativeSctpCapabilities()"),{numStreams:v}}run({direction:e,iceParameters:t,iceCandidates:i,dtlsParameters:r,sctpParameters:s,iceServers:o,iceTransportPolicy:n,additionalSettings:a,proprietaryConstraints:l,extendedRtpCapabilities:c}){m.debug("run()"),this._direction=e,this._remoteSdp=new h.RemoteSdp({iceParameters:t,iceCandidates:i,dtlsParameters:r,sctpParameters:s,planB:!0}),this._sendingRtpParametersByKind={audio:d.getSendingRtpParameters("audio",c),video:d.getSendingRtpParameters("video",c)},this._sendingRemoteRtpParametersByKind={audio:d.getSendingRemoteRtpParameters("audio",c),video:d.getSendingRemoteRtpParameters("video",c)},r.role&&"auto"!==r.role&&(this._forcedLocalDtlsRole="server"===r.role?"client":"server"),this._pc=new RTCPeerConnection({iceServers:o||[],iceTransportPolicy:n||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...a},l),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(m.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed")}})}async updateIceServers(e){m.debug("updateIceServers()");const t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(m.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady)if("send"===this._direction){const e=await this._pc.createOffer({iceRestart:!0});m.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e);const t={type:"answer",sdp:this._remoteSdp.getSdp()};m.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setRemoteDescription(t)}else{const e={type:"offer",sdp:this._remoteSdp.getSdp()};m.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();m.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",t),await this._pc.setLocalDescription(t)}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:t,codecOptions:i,codec:r}){var s;this.assertSendDirection(),m.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),r&&m.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(e),this._pc.addTrack(e,this._sendStream);let o,a=await this._pc.createOffer(),p=n.parse(a.sdp);const h=l.clone(this._sendingRtpParametersByKind[e.kind],{});h.codecs=d.reduceCodecs(h.codecs);const v=l.clone(this._sendingRemoteRtpParametersByKind[e.kind],{});if(v.codecs=d.reduceCodecs(v.codecs),this._transportReady||await this.setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:p}),"video"===e.kind&&t&&t.length>1&&(m.debug("send() | enabling simulcast"),p=n.parse(a.sdp),o=p.media.find(e=>"video"===e.type),u.addLegacySimulcast({offerMediaObject:o,track:e,numStreams:t.length}),a={type:"offer",sdp:n.write(p)}),m.debug("send() | calling pc.setLocalDescription() [offer:%o]",a),await this._pc.setLocalDescription(a),p=n.parse(this._pc.localDescription.sdp),o=p.media.find(t=>t.type===e.kind),h.rtcp.cname=c.getCname({offerMediaObject:o}),h.encodings=u.getRtpEncodings({offerMediaObject:o,track:e}),t)for(let e=0;e<h.encodings.length;++e)t[e]&&Object.assign(h.encodings[e],t[e]);if(h.encodings.length>1&&"video/vp8"===h.codecs[0].mimeType.toLowerCase())for(const e of h.encodings)e.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:o,offerRtpParameters:h,answerRtpParameters:v,codecOptions:i});const g={type:"answer",sdp:this._remoteSdp.getSdp()};m.debug("send() | calling pc.setRemoteDescription() [answer:%o]",g),await this._pc.setRemoteDescription(g);const f=String(this._nextSendLocalId);this._nextSendLocalId++;const b=this._pc.getSenders().find(t=>t.track===e);return this._mapSendLocalIdRtpSender.set(f,b),{localId:f,rtpParameters:h,rtpSender:b}}async stopSending(e){this.assertSendDirection();const t=this._mapSendLocalIdRtpSender.get(e);if(!t)throw new Error("associated RTCRtpSender not found");t.track&&this._sendStream.removeTrack(t.track),this._mapSendLocalIdRtpSender.delete(e);const i=await this._pc.createOffer();m.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",i);try{await this._pc.setLocalDescription(i)}catch(e){if(0===this._sendStream.getTracks().length)return void m.warn("stopSending() | ignoring expected error due no sending tracks: %s",e.toString());throw e}if("stable"===this._pc.signalingState)return;const r={type:"answer",sdp:this._remoteSdp.getSdp()};m.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r)}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,t){this.assertSendDirection(),t?m.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):m.debug("replaceTrack() [localId:%s, no track]",e);const i=this._mapSendLocalIdRtpSender.get(e);if(!i)throw new Error("associated RTCRtpSender not found");const r=i.track;await i.replaceTrack(t),r&&this._sendStream.removeTrack(r),t&&this._sendStream.addTrack(t)}async setMaxSpatialLayer(e,t){this.assertSendDirection(),m.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);const i=this._mapSendLocalIdRtpSender.get(e);if(!i)throw new Error("associated RTCRtpSender not found");const r=i.getParameters();r.encodings.forEach((e,i)=>{e.active=i<=t}),await i.setParameters(r)}async setRtpEncodingParameters(e,t){this.assertSendDirection(),m.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);const i=this._mapSendLocalIdRtpSender.get(e);if(!i)throw new Error("associated RTCRtpSender not found");const r=i.getParameters();r.encodings.forEach((e,i)=>{r.encodings[i]={...e,...t}}),await i.setParameters(r)}async getSenderStats(e){this.assertSendDirection();const t=this._mapSendLocalIdRtpSender.get(e);if(!t)throw new Error("associated RTCRtpSender not found");return t.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:t,maxRetransmits:i,label:r,protocol:s}){var o;this.assertSendDirection();const a={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:t,maxRetransmits:i,protocol:s};m.debug("sendDataChannel() [options:%o]",a);const l=this._pc.createDataChannel(r,a);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%v.MIS,!this._hasDataChannelMediaSection){const e=await this._pc.createOffer(),t=n.parse(e.sdp),i=t.media.find(e=>"application"===e.type);this._transportReady||await this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:t}),m.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e),this._remoteSdp.sendSctpAssociation({offerMediaObject:i});const r={type:"answer",sdp:this._remoteSdp.getSdp()};m.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r),this._hasDataChannelMediaSection=!0}return{dataChannel:l,sctpStreamParameters:{streamId:a.id,ordered:a.ordered,maxPacketLifeTime:a.maxPacketLifeTime,maxRetransmits:a.maxRetransmits}}}async receive(e){var t;this.assertRecvDirection();const i=[];for(const t of e){const{trackId:e,kind:i,rtpParameters:r,streamId:s}=t;m.debug("receive() [trackId:%s, kind:%s]",e,i);const o=i;this._remoteSdp.receive({mid:o,kind:i,offerRtpParameters:r,streamId:s||r.rtcp.cname,trackId:e})}const r={type:"offer",sdp:this._remoteSdp.getSdp()};m.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);let s=await this._pc.createAnswer();const o=n.parse(s.sdp);for(const t of e){const{kind:e,rtpParameters:i}=t,r=e,s=o.media.find(e=>String(e.mid)===r);c.applyCodecParameters({offerRtpParameters:i,answerMediaObject:s})}s={type:"answer",sdp:n.write(o)},this._transportReady||await this.setupTransport({localDtlsRole:null!==(t=this._forcedLocalDtlsRole)&&void 0!==t?t:"client",localSdpObject:o}),m.debug("receive() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const t of e){const{kind:e,trackId:r,rtpParameters:s}=t,o=e,n=r,a=this._pc.getReceivers().find(e=>e.track&&e.track.id===n);if(!a)throw new Error("new RTCRtpReceiver not");this._mapRecvLocalIdInfo.set(n,{mid:o,rtpParameters:s,rtpReceiver:a}),i.push({localId:n,track:a.track,rtpReceiver:a})}return i}async stopReceiving(e){this.assertRecvDirection();for(const t of e){m.debug("stopReceiving() [localId:%s]",t);const{mid:e,rtpParameters:i}=this._mapRecvLocalIdInfo.get(t)||{};this._mapRecvLocalIdInfo.delete(t),this._remoteSdp.planBStopReceiving({mid:e,offerRtpParameters:i})}const t={type:"offer",sdp:this._remoteSdp.getSdp()};m.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const i=await this._pc.createAnswer();m.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i)}async getReceiverStats(e){this.assertRecvDirection();const{rtpReceiver:t}=this._mapRecvLocalIdInfo.get(e)||{};if(!t)throw new Error("associated RTCRtpReceiver not found");return t.getStats()}async pauseReceiving(e){}async resumeReceiving(e){}async receiveDataChannel({sctpStreamParameters:e,label:t,protocol:i}){var r;this.assertRecvDirection();const{streamId:s,ordered:o,maxPacketLifeTime:a,maxRetransmits:l}=e,d={negotiated:!0,id:s,ordered:o,maxPacketLifeTime:a,maxRetransmits:l,protocol:i};m.debug("receiveDataChannel() [options:%o]",d);const c=this._pc.createDataChannel(t,d);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});const e={type:"offer",sdp:this._remoteSdp.getSdp()};m.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();if(!this._transportReady){const e=n.parse(t.sdp);await this.setupTransport({localDtlsRole:null!==(r=this._forcedLocalDtlsRole)&&void 0!==r?r:"client",localSdpObject:e})}m.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setLocalDescription(t),this._hasDataChannelMediaSection=!0}return{dataChannel:c}}async setupTransport({localDtlsRole:e,localSdpObject:t}){t||(t=n.parse(this._pc.localDescription.sdp));const i=c.extractDtlsParameters({sdpObject:t});i.role=e,this._remoteSdp.updateDtlsRole("client"===e?"server":"client"),await new Promise((e,t)=>{this.safeEmit("@connect",{dtlsParameters:i},e,t)}),this._transportReady=!0}assertSendDirection(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}t.Safari11=g},"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/Safari12.js":function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var s=Object.getOwnPropertyDescriptor(t,i);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,s)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Safari12=void 0;const n=o(i("./node_modules/sdp-transform/lib/index.js")),a=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/Logger.js"),l=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/utils.js")),d=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/ortc.js")),c=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/commonUtils.js")),u=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/unifiedPlanUtils.js")),p=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/ortc/utils.js")),h=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/HandlerInterface.js"),m=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/RemoteSdp.js"),v=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/scalabilityModes.js"),g=new a.Logger("Safari12"),f={OS:1024,MIS:1024};class b extends h.HandlerInterface{static createFactory(){return()=>new b}constructor(){super(),this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"Safari12"}close(){if(g.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}async getNativeRtpCapabilities(){g.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});try{e.addTransceiver("audio"),e.addTransceiver("video");const t=await e.createOffer();try{e.close()}catch(e){}const i=n.parse(t.sdp),r=c.extractRtpCapabilities({sdpObject:i});return p.addNackSuppportForOpus(r),r}catch(t){try{e.close()}catch(e){}throw t}}async getNativeSctpCapabilities(){return g.debug("getNativeSctpCapabilities()"),{numStreams:f}}run({direction:e,iceParameters:t,iceCandidates:i,dtlsParameters:r,sctpParameters:s,iceServers:o,iceTransportPolicy:n,additionalSettings:a,proprietaryConstraints:l,extendedRtpCapabilities:c}){g.debug("run()"),this._direction=e,this._remoteSdp=new m.RemoteSdp({iceParameters:t,iceCandidates:i,dtlsParameters:r,sctpParameters:s}),this._sendingRtpParametersByKind={audio:d.getSendingRtpParameters("audio",c),video:d.getSendingRtpParameters("video",c)},this._sendingRemoteRtpParametersByKind={audio:d.getSendingRemoteRtpParameters("audio",c),video:d.getSendingRemoteRtpParameters("video",c)},r.role&&"auto"!==r.role&&(this._forcedLocalDtlsRole="server"===r.role?"client":"server"),this._pc=new RTCPeerConnection({iceServers:o||[],iceTransportPolicy:n||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...a},l),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(g.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed")}})}async updateIceServers(e){g.debug("updateIceServers()");const t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(g.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady)if("send"===this._direction){const e=await this._pc.createOffer({iceRestart:!0});g.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e);const t={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setRemoteDescription(t)}else{const e={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();g.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",t),await this._pc.setLocalDescription(t)}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:t,codecOptions:i,codec:r}){var s;this.assertSendDirection(),g.debug("send() [kind:%s, track.id:%s]",e.kind,e.id);const o=l.clone(this._sendingRtpParametersByKind[e.kind],{});o.codecs=d.reduceCodecs(o.codecs,r);const a=l.clone(this._sendingRemoteRtpParametersByKind[e.kind],{});a.codecs=d.reduceCodecs(a.codecs,r);const p=this._remoteSdp.getNextMediaSectionIdx(),h=this._pc.addTransceiver(e,{direction:"sendonly",streams:[this._sendStream]});let m,f=await this._pc.createOffer(),b=n.parse(f.sdp);this._transportReady||await this.setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:b});const _=(0,v.parse)((t||[{}])[0].scalabilityMode);t&&t.length>1&&(g.debug("send() | enabling legacy simulcast"),b=n.parse(f.sdp),m=b.media[p.idx],u.addLegacySimulcast({offerMediaObject:m,numStreams:t.length}),f={type:"offer",sdp:n.write(b)}),g.debug("send() | calling pc.setLocalDescription() [offer:%o]",f),await this._pc.setLocalDescription(f);const y=h.mid;if(o.mid=y,b=n.parse(this._pc.localDescription.sdp),m=b.media[p.idx],o.rtcp.cname=c.getCname({offerMediaObject:m}),o.encodings=u.getRtpEncodings({offerMediaObject:m}),t)for(let e=0;e<o.encodings.length;++e)t[e]&&Object.assign(o.encodings[e],t[e]);if(o.encodings.length>1&&("video/vp8"===o.codecs[0].mimeType.toLowerCase()||"video/h264"===o.codecs[0].mimeType.toLowerCase()))for(const e of o.encodings)e.scalabilityMode?e.scalabilityMode="L1T"+_.temporalLayers:e.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:m,reuseMid:p.reuseMid,offerRtpParameters:o,answerRtpParameters:a,codecOptions:i});const w={type:"answer",sdp:this._remoteSdp.getSdp()};return g.debug("send() | calling pc.setRemoteDescription() [answer:%o]",w),await this._pc.setRemoteDescription(w),this._mapMidTransceiver.set(y,h),{localId:y,rtpParameters:o,rtpSender:h.sender}}async stopSending(e){this.assertSendDirection(),g.debug("stopSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");t.sender.replaceTrack(null),this._pc.removeTrack(t.sender);if(this._remoteSdp.closeMediaSection(t.mid))try{t.stop()}catch(e){}const i=await this._pc.createOffer();g.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const r={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r),this._mapMidTransceiver.delete(e)}async pauseSending(e){this.assertSendDirection(),g.debug("pauseSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");t.direction="inactive",this._remoteSdp.pauseMediaSection(e);const i=await this._pc.createOffer();g.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const r={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r)}async resumeSending(e){this.assertSendDirection(),g.debug("resumeSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");t.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(e);const i=await this._pc.createOffer();g.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const r={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r)}async replaceTrack(e,t){this.assertSendDirection(),t?g.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):g.debug("replaceTrack() [localId:%s, no track]",e);const i=this._mapMidTransceiver.get(e);if(!i)throw new Error("associated RTCRtpTransceiver not found");await i.sender.replaceTrack(t)}async setMaxSpatialLayer(e,t){this.assertSendDirection(),g.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);const i=this._mapMidTransceiver.get(e);if(!i)throw new Error("associated RTCRtpTransceiver not found");const r=i.sender.getParameters();r.encodings.forEach((e,i)=>{e.active=i<=t}),await i.sender.setParameters(r),this._remoteSdp.muxMediaSectionSimulcast(e,r.encodings);const s=await this._pc.createOffer();g.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async setRtpEncodingParameters(e,t){this.assertSendDirection(),g.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);const i=this._mapMidTransceiver.get(e);if(!i)throw new Error("associated RTCRtpTransceiver not found");const r=i.sender.getParameters();r.encodings.forEach((e,i)=>{r.encodings[i]={...e,...t}}),await i.sender.setParameters(r),this._remoteSdp.muxMediaSectionSimulcast(e,r.encodings);const s=await this._pc.createOffer();g.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async getSenderStats(e){this.assertSendDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.sender.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:t,maxRetransmits:i,label:r,protocol:s}){var o;this.assertSendDirection();const a={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:t,maxRetransmits:i,protocol:s};g.debug("sendDataChannel() [options:%o]",a);const l=this._pc.createDataChannel(r,a);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%f.MIS,!this._hasDataChannelMediaSection){const e=await this._pc.createOffer(),t=n.parse(e.sdp),i=t.media.find(e=>"application"===e.type);this._transportReady||await this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:t}),g.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",e),await this._pc.setLocalDescription(e),this._remoteSdp.sendSctpAssociation({offerMediaObject:i});const r={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r),this._hasDataChannelMediaSection=!0}return{dataChannel:l,sctpStreamParameters:{streamId:a.id,ordered:a.ordered,maxPacketLifeTime:a.maxPacketLifeTime,maxRetransmits:a.maxRetransmits}}}async receive(e){var t;this.assertRecvDirection();const i=[],r=new Map;for(const t of e){const{trackId:e,kind:i,rtpParameters:s,streamId:o}=t;g.debug("receive() [trackId:%s, kind:%s]",e,i);const n=s.mid||String(this._mapMidTransceiver.size);r.set(e,n),this._remoteSdp.receive({mid:n,kind:i,offerRtpParameters:s,streamId:o||s.rtcp.cname,trackId:e})}const s={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",s),await this._pc.setRemoteDescription(s);let o=await this._pc.createAnswer();const a=n.parse(o.sdp);for(const t of e){const{trackId:e,rtpParameters:i}=t,s=r.get(e),o=a.media.find(e=>String(e.mid)===s);c.applyCodecParameters({offerRtpParameters:i,answerMediaObject:o})}o={type:"answer",sdp:n.write(a)},this._transportReady||await this.setupTransport({localDtlsRole:null!==(t=this._forcedLocalDtlsRole)&&void 0!==t?t:"client",localSdpObject:a}),g.debug("receive() | calling pc.setLocalDescription() [answer:%o]",o),await this._pc.setLocalDescription(o);for(const t of e){const{trackId:e}=t,s=r.get(e),o=this._pc.getTransceivers().find(e=>e.mid===s);if(!o)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(s,o),i.push({localId:s,track:o.receiver.track,rtpReceiver:o.receiver})}return i}async stopReceiving(e){this.assertRecvDirection();for(const t of e){g.debug("stopReceiving() [localId:%s]",t);const e=this._mapMidTransceiver.get(t);if(!e)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(e.mid)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const i=await this._pc.createAnswer();g.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const t of e)this._mapMidTransceiver.delete(t)}async pauseReceiving(e){this.assertRecvDirection();for(const t of e){g.debug("pauseReceiving() [localId:%s]",t);const e=this._mapMidTransceiver.get(t);if(!e)throw new Error("associated RTCRtpTransceiver not found");e.direction="inactive",this._remoteSdp.pauseMediaSection(t)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const i=await this._pc.createAnswer();g.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i)}async resumeReceiving(e){this.assertRecvDirection();for(const t of e){g.debug("resumeReceiving() [localId:%s]",t);const e=this._mapMidTransceiver.get(t);if(!e)throw new Error("associated RTCRtpTransceiver not found");e.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(t)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const i=await this._pc.createAnswer();g.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i)}async getReceiverStats(e){this.assertRecvDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:t,protocol:i}){var r;this.assertRecvDirection();const{streamId:s,ordered:o,maxPacketLifeTime:a,maxRetransmits:l}=e,d={negotiated:!0,id:s,ordered:o,maxPacketLifeTime:a,maxRetransmits:l,protocol:i};g.debug("receiveDataChannel() [options:%o]",d);const c=this._pc.createDataChannel(t,d);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const e={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",e),await this._pc.setRemoteDescription(e);const t=await this._pc.createAnswer();if(!this._transportReady){const e=n.parse(t.sdp);await this.setupTransport({localDtlsRole:null!==(r=this._forcedLocalDtlsRole)&&void 0!==r?r:"client",localSdpObject:e})}g.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",t),await this._pc.setLocalDescription(t),this._hasDataChannelMediaSection=!0}return{dataChannel:c}}async setupTransport({localDtlsRole:e,localSdpObject:t}){t||(t=n.parse(this._pc.localDescription.sdp));const i=c.extractDtlsParameters({sdpObject:t});i.role=e,this._remoteSdp.updateDtlsRole("client"===e?"server":"client"),await new Promise((e,t)=>{this.safeEmit("@connect",{dtlsParameters:i},e,t)}),this._transportReady=!0}assertSendDirection(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}t.Safari12=b},"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/ortc/edgeUtils.js":function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var s=Object.getOwnPropertyDescriptor(t,i);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,s)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.mangleRtpParameters=t.getCapabilities=void 0;const n=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/utils.js"));t.getCapabilities=function(){const e=RTCRtpReceiver.getCapabilities(),t=n.clone(e,{});for(const e of t.codecs){if(e.channels=e.numChannels,delete e.numChannels,e.mimeType=e.mimeType||`${e.kind}/${e.name}`,e.parameters){const t=e.parameters;t.apt&&(t.apt=Number(t.apt)),t["packetization-mode"]&&(t["packetization-mode"]=Number(t["packetization-mode"]))}for(const t of e.rtcpFeedback||[])t.parameter||(t.parameter="")}return t},t.mangleRtpParameters=function(e){const t=n.clone(e,{});t.mid&&(t.muxId=t.mid,delete t.mid);for(const e of t.codecs)e.channels&&(e.numChannels=e.channels,delete e.channels),e.mimeType&&!e.name&&(e.name=e.mimeType.split("/")[1]),delete e.mimeType;return t}},"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/ortc/utils.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addNackSuppportForOpus=void 0,t.addNackSuppportForOpus=function(e){var t;for(const i of e.codecs||[])"audio/opus"!==i.mimeType.toLowerCase()&&"audio/multiopus"!==i.mimeType.toLowerCase()||(null===(t=i.rtcpFeedback)||void 0===t?void 0:t.some()||(i.rtcpFeedback||(i.rtcpFeedback=[]),i.rtcpFeedback.push({type:"nack"}))}},"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/MediaSection.js":function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var s=Object.getOwnPropertyDescriptor(t,i);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,s)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.OfferMediaSection=t.AnswerMediaSection=t.MediaSection=void 0;const n=o(i("./node_modules/sdp-transform/lib/index.js")),a=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/utils.js"));class l{constructor({iceParameters:e,iceCandidates:t,dtlsParameters:i,planB:r=!1}){if(this._mediaObject={},this._planB=r,e&&this.setIceParameters(e),t){this._mediaObject.candidates=[];for(const e of t){const t={component:1};t.foundation=e.foundation,t.ip=e.ip,t.port=e.port,t.priority=e.priority,t.transport=e.protocol,t.type=e.type,e.tcpType&&(t.tcptype=e.tcpType),this._mediaObject.candidates.push(t)}this._mediaObject.endOfCandidates="end-of-candidates",this._mediaObject.iceOptions="renomination"}i&&this.setDtlsRole(i.role)}tObject(){return this._mediaObject}ause(){this._mediaObject.direction="inactive"}disable(){this.pause(),delete this._mediaObject.ext,delete this._mediaObject.ssrcs,delete this._mediaObject.ssrcGroups,delete this._mediaObject.simulcast,delete this._mediaObject.simulcast_03,delete this._mediaObject.rids,delete this._mediaObject.extmapAllowMixed}t.MediaSection=l;t.AnswerMediaSection=class extends l{constructor({iceParameters:e,iceCandidates:t,dtlsParameters:i,sctpParameters:r,plainRtpParameters:s,planB:o=!1,offerMediaObject:n,offerRtpParameters:l,answerRtpParameters:c,codecOptions:u,extmapAllowMixed:p=!1}){switch(super({iceParameters:e,iceCandidates:t,dtlsParameters:i,planB:o}),this._mediaObject.mid=String(n.mid),this._mediaObject.type=n.type,this._mediaObject.protocol=n.protocol,s?(this._mediaObject.connection={ip:s.ip,version:s.ipVersion},this._mediaObject.port=s.port):(this._mediaObject.connection={ip:"127.0.0.1",version:4},this._mediaObject.port=7),n.type){case"audio":case"video":this._mediaObject.direction="recvonly",this._mediaObject.rtp=[],this._mediaObject.rtcpFb=[],this._mediaObject.fmtp=[];for(const e of c.codecs){const t={payload:e.payloadType,codec:d(e),rate:e.clockRate};e.channels>1&&(t.encoding=e.channels),this._mediaObject.rtp.push(t);const i=a.clone(e.parameters,{});let r=a.clone(e.rtcpFeedback,[]);if(u){const{opusStereo:t,opusFec:s,opusDtx:o,opusMaxPlaybackRate:n,opusMaxAverageBitrate:a,opusPtime:d,opusNack:c,videoGoogleStartBitrate:p,videoGoogleMaxBitrate:h,videoGoogleMinBitrate:m}=u,v=l.codecs.find(t=>t.payloadType===e.payloadType);switch(e.mimeType.toLowerCase()){case"audio/opus":case"audio/multiopus":void 0!==t&&(v.parameters["sprop-stereo"]=t?1:0,i.stereo=t?1:0),void 0!==s&&(v.parameters.useinbandfec=s?1:0,i.useinbandfec=s?1:0),void 0!==o&&(v.parameters.usedtx=o?1:0,i.usedtx=o?1:0),void 0!==n&&(i.maxplaybackrate=n),void 0!==a&&(i.maxaveragebitrate=a),void 0!==d&&(v.parameters.ptime=d,i.ptime=d),c||(v.rtcpFeedback=v.rtcpFeedback.filter(e=>"nack"!==e.type||e.parameter),r=r.filter();break;case"video/vp8":case"video/vp9":case"video/h264":case"video/h265":void 0!==p&&(i["x-google-start-bitrate"]=p),void 0!==h&&(i["x-google-max-bitrate"]=h),void 0!==m&&(i["x-google-min-bitrate"]=m)}}const s={payload:e.payloadType,config:""};for(const e of Object.keys(i))s.config&&(s.config+=";"),s.config+=`${e}=${i[e]}`;s.config&&this._mediaObject.fmtp.push(s);for(const t of r)this._mediaObject.rtcpFb.push({payload:e.payloadType,type:t.type,subtype:t.parameter})}this._mediaObject.payloads=c.codecs.map(e=>e.payloadType).join(" "),this._mediaObject.ext=[];for(const e of c.headerExtensions){(n.ext||[]).some(t=>t.uri===e.uri)&&this._mediaObject.ext.push({uri:e.uri,value:e.id})}if(p&&"extmap-allow-mixed"===n.extmapAllowMixed&&(this._mediaObject.extmapAllowMixed="extmap-allow-mixed"),n.simulcast){this._mediaObject.simulcast={dir1:"recv",list1:n.simulcast.list1},this._mediaObject.rids=[];for(const e of n.rids||[])"send"===e.direction&&this._mediaObject.rids.push({id:e.id,direction:"recv"})}else if(n.simulcast_03){this._mediaObject.simulcast_03={value:n.simulcast_03.value.replace(/send/g,"recv")},this._mediaObject.rids=[];for(const e of n.rids||[])"send"===e.direction&&this._mediaObject.rids.push({id:e.id,direction:"recv"})}this._mediaObject.rtcpMux="rtcp-mux",this._mediaObject.rtcpRsize="rtcp-rsize",this._planB&&"video"===this._mediaObject.type&&(this._mediaObject.xGoogleFlag="conference");break;case"application":"number"==typeof n.sctpPort?(this._mediaObject.payloads="webrtc-datachannel",this._mediaObject.sctpPort=r.port,this._mediaObject.maxMessageSize=r.maxMessageSize):n.sctpmap&&(this._mediaObject.payloads=r.port,this._mediaObject.sctpmap={app:"webrtc-datachannel",sctpmapNumber:r.port,maxMessageSize:r.maxMessageSize})}}esume(){this._mediaObject.direction="recvonly"}muxSimulcastStreams(e){var t;if(!this._mediaObject.simulcast||!this._mediaObject.simulcast.list1)return;const i={};for(const t of e)t.rid&&(i[t.rid]=t);const r=this._mediaObject.simulcast.list1,s=n.parseSimulcastStreamList(r);for(const e of s)for(const r of e)r.paused=!(null===(t=i[r.scid])||void 0===t?void 0:t.active);this._mediaObject.simulcast.list1=s.map(e=>e.map(e=>`${e.paused?"~":""}${e.scid}`).join(",")).join(";")}};function d(e){const t=new RegExp("^(audio|video)/(.+)","i").exec(e.mimeType);if(!t)throw new TypeError("invalid codec.mimeType");return t[2]}t.OfferMediaSection=class extends l{constructor({iceParameters:e,iceCandidates:t,dtlsParameters:i,sctpParameters:r,plainRtpParameters:s,planB:o=!1,mid:n,kind:a,offerRtpParameters:l,streamId:c,trackId:u,oldDataChannelSpec:p=!1}){switch(super({iceParameters:e,iceCandidates:t,dtlsParameters:i,planB:o}),this._mediaObject.mid=String(n),this._mediaObject.type=a,s?(this._mediaObject.connection={ip:s.ip,version:s.ipVersion},this._mediaObject.protocol="RTP/AVP",this._mediaObject.port=s.port):(this._mediaObject.connection={ip:"127.0.0.1",version:4},this._mediaObject.protocol=r?"UDP/DTLS/SCTP":"UDP/TLS/RTP/SAVPF",this._mediaObject.port=7),a){case"audio":case"video":{this._mediaObject.direction="sendonly",this._mediaObject.rtp=[],this._mediaObject.rtcpFb=[],this._mediaObject.fmtp=[],this._planB||(this._mediaObject.msid=`${c||"-"} ${u}`);for(const e of l.codecs){const t={payload:e.payloadType,codec:d(e),rate:e.clockRate};e.channels>1&&(t.encoding=e.channels),this._mediaObject.rtp.push(t);const i={payload:e.payloadType,config:""};for(const t of Object.keys(e.parameters))i.config&&(i.config+=";"),i.config+=`${t}=${e.parameters[t]}`;i.config&&this._mediaObject.fmtp.push(i);for(const t of e.rtcpFeedback)this._mediaObject.rtcpFb.push({payload:e.payloadType,type:t.type,subtype:t.parameter})}this._mediaObject.payloads=l.codecs.map(e=>e.payloadType).join(" "),this._mediaObject.ext=[];for(const e of l.headerExtensions)this._mediaObject.ext.push({uri:e.uri,value:e.id});this._mediaObject.rtcpMux="rtcp-mux",this._mediaObject.rtcpRsize="rtcp-rsize";const e=l.encodings[0],t=e.ssrc,i=e.rtx&&e.rtx.ssrc?e.rtx.ssrc:void 0;this._mediaObject.ssrcs=[],this._mediaObject.ssrcGroups=[],l.rtcp.cname&&this._mediaObject.ssrcs.push({id:t,attribute:"cname",value:l.rtcp.cname}),this._planB&&this._mediaObject.ssrcs.push({id:t,attribute:"msid",value:`${c||"-"} ${u}`}),i&&(l.rtcp.cname&&this._mediaObject.ssrcs.push({id:i,attribute:"cname",value:l.rtcp.cname}),this._planB&&this._mediaObject.ssrcs.push({id:i,attribute:"msid",value:`${c||"-"} ${u}`}),this._mediaObject.ssrcGroups.push({semantics:"FID",ssrcs:`${t} ${i}`}));break}case"application":p?(this._mediaObject.payloads=r.port,this._mediaObject.sctpmap={app:"webrtc-datachannel",sctpmapNumber:r.port,maxMessageSize:r.maxMessageSize}):(this._mediaObject.payloads="webrtc-datachannel",this._mediaObject.sctpPort=r.port,this._mediaObject.maxMessageSize=r.maxMessageSize)}}anBReceive({offerRtpParameters:e,streamId:t,trackId:i}){const r=e.encodings[0],s=r.ssrc,o=r.rtx&&r.rtx.ssrc?r.rtx.ssrc:void 0,n=this._mediaObject.payloads.split(" ");for(const t of e.codecs){if(n.includes(String(t.payloadType)))continue;const e={payload:t.payloadType,codec:d(t),rate:t.clockRate};t.channels>1&&(e.encoding=t.channels),this._mediaObject.rtp.push(e);const i={payload:t.payloadType,config:""};for(const e of Object.keys(t.parameters))i.config&&(i.config+=";"),i.config+=`${e}=${t.parameters[e]}`;i.config&&this._mediaObject.fmtp.push(i);for(const e of t.rtcpFeedback)this._mediaObject.rtcpFb.push({payload:t.payloadType,type:e.type,subtype:e.parameter})}this._mediaObject.payloads+=" "+e.codecs.filter(.map(e=>e.payloadType).join(" "),this._mediaObject.payloads=this._mediaObject.payloads.trim(),e.rtcp.cname&&this._mediaObject.ssrcs.push({id:s,attribute:"cname",value:e.rtcp.cname}),this._mediaObject.ssrcs.push({id:s,attribute:"msid",value:`${t||"-"} ${i}`}),o&&(e.rtcp.cname&&this._mediaObject.ssrcs.push({id:o,attribute:"cname",value:e.rtcp.cname}),this._mediaObject.ssrcs.push({id:o,attribute:"msid",value:`${t||"-"} ${i}`}),this._mediaObject.ssrcGroups.push({semantics:"FID",ssrcs:`${s} ${o}`}))}planBStopReceiving({offerRtpParameters:e}){const t=e.encodings[0],i=t.ssrc,r=t.rtx&&t.rtx.ssrc?t.rtx.ssrc:void 0;this._mediaObject.ssrcs=this._mediaObject.ssrcs.filter(,r&&(this._mediaObject.ssrcGroups=this._mediaObject.ssrcGroups.filter(e=>e.ssrcs!==`${i} ${r}`))}}},"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/RemoteSdp.js":function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var s=Object.getOwnPropertyDescriptor(t,i);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,s)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.RemoteSdp=void 0;const n=o(i("./node_modules/sdp-transform/lib/index.js")),a=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/Logger.js"),l=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/MediaSection.js"),d=new a.Logger("RemoteSdp");t.RemoteSdp=class{pdateIceParameters(e){d.debug("updateIceParameters() [iceParameters:%o]",e),this._iceParameters=e,this._sdpObject.icelite=e.iceLite?"ice-lite":void 0;for(const t of this._mediaSections)t.setIceParameters(e)}updateDtlsRole(e){d.debug("updateDtlsRole() [role:%s]",e),this._dtlsParameters.role=e;for(const t of this._mediaSections)t.setDtlsRole(e)}end({offerMediaObject:e,reuseMid:t,offerRtpParameters:i,answerRtpParameters:r,codecOptions:s,extmapAllowMixed:o=!1}){const n=new l.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,planB:this._planB,offerMediaObject:e,offerRtpParameters:i,answerRtpParameters:r,codecOptions:s,extmapAllowMixed:o});t?this._replaceMediaSection(n,t):this._midToIndex.has(n.mid)?this._replaceMediaSection(n):this._addMediaSection(n)}receive({mid:e,kind:t,offerRtpParameters:i,streamId:r,trackId:s}){const o=this._midToIndex.get(e);let n;if(void 0!==o&&(n=this._mediaSections[o]),n)n.planBReceive({offerRtpParameters:i,streamId:r,trackId:s}),this._replaceMediaSection(n);else{n=new l.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,planB:this._planB,mid:e,kind:t,offerRtpParameters:i,streamId:r,trackId:s});const o=this._mediaSections.find(e=>e.closed);o?this._replaceMediaSection(n,o.mid):this._addMediaSection(n)}}pauseMediaSection(e){this._findMediaSection(e).pause()}resumeSendingMediaSection(e){this._findMediaSection(e).resume()}resumeReceivingMediaSection(e){this._findMediaSection(e).resume()}loseMediaSection(e){const t=this._findMediaSection(e);return e===this._firstMid?(d.debug("closeMediaSection() | cannot close first media section, disabling it instead [mid:%s]",e),this.disableMediaSection(e),!1):(t.close(),this._regenerateBundleMids(),!0)}muxMediaSectionSimulcast(e,t){const i=this._findMediaSection(e);i.muxSimulcastStreams(t),this._replaceMediaSection(i)}planBStopReceiving({mid:e,offerRtpParameters:t}){const i=this._findMediaSection(e);i.planBStopReceiving({offerRtpParameters:t}),this._replaceMediaSection(i)}sendSctpAssociation({offerMediaObject:e}){const t=new l.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,offerMediaObject:e});this._addMediaSection(t)}receiveSctpAssociation({oldDataChannelSpec:e=!1}={}){const t=new l.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,mid:"datachannel",kind:"application",oldDataChannelSpec:e});this._addMediaSection(t)}eplaceMediaSection(e,t){if("string"==typeof t){const i=this._midToIndex.get(t);if(void 0===i)throw new Error(`no media section found for reuseMid '${t}'`);const r=this._mediaSections[i];this._mediaSections[i]=e,this._midToIndex.delete(r.mid),this._midToIndex.set(e.mid,i),this._sdpObject.media[i]=e.getObject(),this._regenerateBundleMids()}else{const t=this._midToIndex.get(e.mid);if(void 0===t)throw new Error(`no media section found with mid '${e.mid}'`);this._mediaSections[t]=e,this._sdpObject.media[t]=e.getObject()}}_findMediaSection(e){const t=this._midToIndex.get(e);if(void 0===t)throw new Error(`no media section found with mid '${e}'`);return this._mediaSections[t]}},"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/commonUtils.js":function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var s=Object.getOwnPropertyDescriptor(t,i);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,s)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.applyCodecParameters=t.getCname=t.extractDtlsParameters=t.extractRtpCapabilities=void 0;const n=o(i("./node_modules/sdp-transform/lib/index.js"));t.extractRtpCapabilities=function({sdpObject:e}){const t=new Map,i=[];let r=!1,s=!1;for(const o of e.media){const e=o.type;switch(e){case"audio":if(r)continue;r=!0;break;case"video":if(s)continue;s=!0;break;default:continue}for(const i of o.rtp){const r={kind:e,mimeType:`${e}/${i.codec}`,preferredPayloadType:i.payload,clockRate:i.rate,channels:i.encoding,parameters:{},rtcpFeedback:[]};t.set(r.preferredPayloadType,r)}for(const e of o.fmtp||[]){const i=n.parseParams(e.config),r=t.get(e.payload);r&&(i&&i.hasOwnProperty("profile-level-id")&&(i["profile-level-id"]=String(i["profile-level-id"])),r.parameters=i)}for(const i of o.rtcpFb||[]){const r={type:i.type,parameter:i.subtype};if(r.parameter||delete r.parameter,"*"!==i.payload){const e=t.get(i.payload);if(!e)continue;e.rtcpFeedback.push(r)}else for(const i of t.values())i.kind!==e||/.+\/rtx$/i.test(i.mimeType)||i.rtcpFeedback.push(r)}for(const t of o.ext||[]){if(t["encrypt-uri"])continue;const r={kind:e,uri:t.uri,preferredId:t.value};i.push(r)}}return{codecs:Array.from(t.values()),headerExtensions:i}},t.extractDtlsParameters=function({sdpObject:e}){const t=(e.media||[]).find(;if(!t)throw new Error("no active media section found");const i=t.fingerprint||e.fingerprint;let r;switch(t.setup){case"active":r="client";break;case"passive":r="server";break;case"actpass":r="auto"}return{role:r,fingerprints:[{algorithm:i.type,value:i.hash}]}},t.getCname=function({offerMediaObject:e}){const t=(e.ssrcs||[]).find(e=>"cname"===e.attribute);return t?t.value:""},t.applyCodecParameters=function({offerRtpParameters:e,answerMediaObject:t}){for(const i of e.codecs){const e=i.mimeType.toLowerCase();if("audio/opus"!==e)continue;if(!(t.rtp||[]).find(e=>e.payload===i.payloadType))continue;t.fmtp=t.fmtp||[];let r=t.fmtp.find(e=>e.payload===i.payloadType);r||(r={payload:i.payloadType,config:""},t.fmtp.push(r));const s=n.parseParams(r.config);switch(e){case"audio/opus":{const e=i.parameters["sprop-stereo"];void 0!==e&&(s.stereo=e?1:0);break}}r.config="";for(const e of Object.keys(s))r.config&&(r.config+=";"),r.config+=`${e}=${s[e]}`}}},"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/planBUtils.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addLegacySimulcast=t.getRtpEncodings=void 0,t.getRtpEncodings=function({offerMediaObject:e,track:t}){let i;const r=new Set;for(const s of e.ssrcs||[]){if("msid"!==s.attribute)continue;if(s.value.split(" ")[1]===t.id){const e=s.id;r.add(e),i||(i=e)}}if(0===r.size)throw new Error(`a=ssrc line with msid information not found [track.id:${t.id}]`);const s=new Map;for(const t of e.ssrcGroups||[]){if("FID"!==t.semantics)continue;let[e,i]=t.ssrcs.split(/\s+/);e=Number(e),i=Number(i),r.has(e)&&(r.delete(e),r.delete(i),s.set(e,i))}for(const e of r)s.set(e,null);const o=[];for(const[e,t]of s){const i={ssrc:e};t&&(i.rtx={ssrc:t}),o.push(i)}return o},t.addLegacySimulcast=function({offerMediaObject:e,track:t,numStreams:i}){if(i<=1)throw new TypeError("numStreams must be greater than 1");let r,s,o;if(!(e.ssrcs||[]).find(e=>{if("msid"!==e.attribute)return!1;return e.value.split(" ")[1]===t.id&&(r=e.id,o=e.value.split(" ")[0],!0)}))throw new Error(`a=ssrc line with msid information not found [track.id:${t.id}]`);(e.ssrcGroups||[]).some(e=>{if("FID"!==e.semantics)return!1;const t=e.ssrcs.split(/\s+/);return Number(t[0])===r&&(s=Number(t[1]),!0)});const n=e.ssrcs.find(;if(!n)throw new Error(`a=ssrc line with cname information not found [track.id:${t.id}]`);const a=n.value,l=[],d=[];for(let e=0;e<i;++e)l.push(r+e),s&&d.push(s+e);e.ssrcGroups=e.ssrcGroups||[],e.ssrcs=e.ssrcs||[],e.ssrcGroups.push({semantics:"SIM",ssrcs:l.join(" ")});for(let i=0;i<l.length;++i){const r=l[i];e.ssrcs.push({id:r,attribute:"cname",value:a}),e.ssrcs.push({id:r,attribute:"msid",value:`${o} ${t.id}`})}for(let i=0;i<d.length;++i){const r=l[i],s=d[i];e.ssrcs.push({id:s,attribute:"cname",value:a}),e.ssrcs.push({id:s,attribute:"msid",value:`${o} ${t.id}`}),e.ssrcGroups.push({semantics:"FID",ssrcs:`${r} ${s}`})}}},"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/handlers/sdp/unifiedPlanUtils.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addLegacySimulcast=t.getRtpEncodings=void 0,t.getRtpEncodings=function({offerMediaObject:e}){const t=new Set;for(const i of e.ssrcs||[]){const e=i.id;t.add(e)}if(0===t.size)throw new Error("no a=ssrc lines found");const i=new Map;for(const r of e.ssrcGroups||[]){if("FID"!==r.semantics)continue;let[e,s]=r.ssrcs.split(/\s+/);e=Number(e),s=Number(s),t.has(e)&&(t.delete(e),t.delete(s),i.set(e,s))}for(const e of t)i.set(e,null);const r=[];for(const[e,t]of i){const i={ssrc:e};t&&(i.rtx={ssrc:t}),r.push(i)}return r},t.addLegacySimulcast=function({offerMediaObject:e,numStreams:t}){if(t<=1)throw new TypeError("numStreams must be greater than 1");const i=(e.ssrcs||[]).find(e=>"msid"===e.attribute);if(!i)throw new Error("a=ssrc line with msid information not found");const[r,s]=i.value.split(" "),o=i.id;let n;(e.ssrcGroups||[]).some(;const a=e.ssrcs.find(e=>"cname"===e.attribute);if(!a)throw new Error("a=ssrc line with cname information not found");const l=a.value,d=[],c=[];for(let e=0;e<t;++e)d.push(o+e),n&&c.push(n+e);e.ssrcGroups=[],e.ssrcs=[],e.ssrcGroups.push({semantics:"SIM",ssrcs:d.join(" ")});for(let t=0;t<d.length;++t){const i=d[t];e.ssrcs.push({id:i,attribute:"cname",value:l}),e.ssrcs.push({id:i,attribute:"msid",value:`${r} ${s}`})}for(let t=0;t<c.length;++t){const i=d[t],o=c[t];e.ssrcs.push({id:o,attribute:"cname",value:l}),e.ssrcs.push({id:o,attribute:"msid",value:`${r} ${s}`}),e.ssrcGroups.push({semantics:"FID",ssrcs:`${i} ${o}`})}}},"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/index.js":function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var s=Object.getOwnPropertyDescriptor(t,i);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,s)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t},n=this&&this.__importDefault||Object.defineProperty(t,"__esModule",{value:!0}),t.debug=t.parseScalabilityMode=t.detectDevice=t.Device=t.version=t.types=void 0;const a=n(i("./node_modules/debug/src/browser.js"));t.debug=a.default;const l=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/Device.js");Object.defineProperty(t,"Device",{enumerable:!0,get:function(){return l.Device}}),Object.defineProperty(t,"detectDevice",{enumerable:!0,get:function(){return l.detectDevice}});const d=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/types.js"));t.types=d,t.version="3.6.84";var c=i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/scalabilityModes.js");Object.defineProperty(t,"parseScalabilityMode",{enumerable:!0,get:function(){return c.parse}})},"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/ortc.js":function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var s=Object.getOwnPropertyDescriptor(t,i);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,s)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.canReceive=t.canSend=t.generateProbatorRtpParameters=t.reduceCodecs=t.getSendingRemoteRtpParameters=t.getSendingRtpParameters=t.getRecvRtpCapabilities=t.getExtendedRtpCapabilities=t.validateSctpStreamParameters=t.validateSctpParameters=t.validateNumSctpStreams=t.validateSctpCapabilities=t.validateRtcpParameters=t.validateRtpEncodingParameters=t.validateRtpHeaderExtensionParameters=t.validateRtpCodecParameters=t.validateRtpParameters=t.validateRtpHeaderExtension=t.validateRtcpFeedback=t.validateRtpCodecCapability=t.validateRtpCapabilities=void 0;const n=o(i("./node_modules/h264-profile-level-id/index.js")),a=o(i("./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/utils.js"));function l(e){const t=new RegExp("^(audio|video)/(.+)","i");if("object"!=typeof e)throw new TypeError("codec is not an object");if(!e.mimeType||"string"!=typeof e.mimeType)throw new TypeError("missing codec.mimeType");const i=t.exec(e.mimeType);if(!i)throw new TypeError("invalid codec.mimeType");if(e.kind=i[1].toLowerCase(),e.preferredPayloadType&&"number"!=typeof e.preferredPayloadType)throw new TypeError("invalid codec.preferredPayloadType");if("number"!=typeof e.clockRate)throw new TypeError("missing codec.clockRate");"audio"===e.kind?"number"!=typeof e.channels&&(e.channels=1):delete e.channels,e.parameters&&"object"==typeof e.parameters||(e.parameters={});for(const t of Object.keys(e.parameters)){let i=e.parameters[t];if(void 0===i&&(e.parameters[t]="",i=""),"string"!=typeof i&&"number"!=typeof i)throw new TypeError(`invalid codec parameter [key:${t}s, value:${i}]`);if("apt"===t&&"number"!=typeof i)throw new TypeError("invalid codec apt parameter")}e.rtcpFeedback&&Array.isArray(e.rtcpFeedback)||(e.rtcpFeedback=[]);for(const t of e.rtcpFeedback)d(t)}function d(e){if("object"!=typeof e)throw new TypeError("fb is not an object");if(!e.type||"string"!=typeof e.type)throw new TypeError("missing fb.type");e.parameter&&"string"==typeof e.parameter||(e.parameter="")}function c(e){if("object"!=typeof e)throw new TypeError("ext is not an object");if("audio"!==e.kind&&"video"!==e.kind)throw new TypeError("invalid ext.kind");if(!e.uri||"string"!=typeof e.uri)throw new TypeError("missing ext.uri");if("number"!=typeof e.preferredId)throw new TypeError("missing ext.preferredId");if(e.preferredEncrypt&&"boolean"!=typeof e.preferredEncrypt)throw new TypeError("invalid ext.preferredEncrypt");if(e.preferredEncrypt||(e.preferredEncrypt=!1),e.direction&&"string"!=typeof e.direction)throw new TypeError("invalid ext.direction");e.direction||(e.direction="sendrecv")}function u(e){if("object"!=typeof e)throw new TypeError("params is not an object");if(e.mid&&"string"!=typeof e.mid)throw new TypeError("params.mid is not a string");if(!Array.isArray(e.codecs))throw new TypeError("missing params.codecs");for(const t of e.codecs)p(t);if(e.headerExtensions&&!Array.isArray(e.headerExtensions))throw new TypeError("params.headerExtensions is not an array");e.headerExtensions||(e.headerExtensions=[]);for(const t of e.headerExtensions)h(t);if(e.encodings&&!Array.isArray(e.encodings))throw new TypeError("params.encodings is not an array");e.encodings||(e.encodings=[]);for(const t of e.encodings)m(t);if(e.rtcp&&"object"!=typeof e.rtcp)throw new TypeError("params.rtcp is not an object");e.rtcp||(e.rtcp={}),v(e.rtcp)}function p(e){const t=new RegExp("^(audio|video)/(.+)","i");if("object"!=typeof e)throw new TypeError("codec is not an object");if(!e.mimeType||"string"!=typeof e.mimeType)throw new TypeError("missing codec.mimeType");const i=t.exec(e.mimeType);if(!i)throw new TypeError("invalid codec.mimeType");if("number"!=typeof e.payloadType)throw new TypeError("missing codec.payloadType");if("number"!=typeof e.clockRate)throw new TypeError("missing codec.clockRate");"audio"===i[1].toLowerCase()?"number"!=typeof e.channels&&(e.channels=1):delete e.channels,e.parameters&&"object"==typeof e.parameters||(e.parameters={});for(const t of Object.keys(e.parameters)){let i=e.parameters[t];if(void 0===i&&(e.parameters[t]="",i=""),"string"!=typeof i&&"number"!=typeof i)throw new TypeError(`invalid codec parameter [key:${t}s, value:${i}]`);if("apt"===t&&"number"!=typeof i)throw new TypeError("invalid codec apt parameter")}e.rtcpFeedback&&Array.isArray(e.rtcpFeedback)||(e.rtcpFeedback=[]);for(const t of e.rtcpFeedback)d(t)}function h(e){if("object"!=typeof e)throw new TypeError("ext is not an object");if(!e.uri||"string"!=typeof e.uri)throw new TypeError("missing ext.uri");if("number"!=typeof e.id)throw new TypeError("missing ext.id");if(e.encrypt&&"boolean"!=typeof e.encrypt)throw new TypeError("invalid ext.encrypt");e.encrypt||(e.encrypt=!1),e.parameters&&"object"==typeof e.parameters||(e.parameters={});for(const t of Object.keys(e.parameters)){let i=e.parameters[t];if(void 0===i&&(e.parameters[t]="",i=""),"string"!=typeof i&&"number"!=typeof i)throw new TypeError("invalid header extension parameter")}}function m(e){if("object"!=typeof e)throw new TypeError("encoding is not an object");if(e.ssrc&&"number"!=typeof e.ssrc)throw new TypeError("invalid encoding.ssrc");if(e.rid&&"string"!=typeof e.rid)throw new TypeError("invalid encoding.rid");if(e.rtx&&"object"!=typeof e.rtx)throw new TypeError("invalid encoding.rtx");if(e.rtx&&"number"!=typeof e.rtx.ssrc)throw new TypeError("missing encoding.rtx.ssrc");if(e.dtx&&"boolean"==typeof e.dtx||(e.dtx=!1),e.scalabilityMode&&"string"!=typeof e.scalabilityMode)throw new TypeError("invalid encoding.scalabilityMode")}function v(e){if("object"!=typeof e)throw new TypeError("rtcp is not an object");if(e.cname&&"string"!=typeof e.cname)throw new TypeError("invalid rtcp.cname");e.reducedSize&&"boolean"==typeof e.reducedSize||(e.reducedSize=!0)}function g(e){if("object"!=typeof e)throw new TypeError("numStreams is not an object");if("number"!=typeof e.OS)throw new TypeError("missing numStreams.OS");if("number"!=typeof e.MIS)throw new TypeError("missing numStreams.MIS")}unction b(e,t,{strict:i=!1,modify:r=!1}={}){const s=e.mimeType.toLowerCase();if(s!==t.mimeType.toLowerCase())return!1;if(e.clockRate!==t.clockRate)return!1;if(e.channels!==t.channels)return!1;switch(s){case"video/h264":if(i){if((e.parameters["packetization-mode"]||0)!==(t.parameters["packetization-mode"]||0))return!1;if(!n.isSameProfile(e.parameters,t.parameters))return!1;let i;try{i=n.generateProfileLevelIdForAnswer(e.parameters,t.parameters)}catch(e){return!1}r&&(i?(e.parameters["profile-level-id"]=i,t.parameters["profile-level-id"]=i):(delete e.parameters["profile-level-id"],delete t.parameters["profile-level-id"]))}break;case"video/vp9":if(i){if((e.parameters["profile-id"]||0)!==(t.parameters["profile-id"]||0))return!1}}return!0}function _(e,t){return(!e.kind||!t.kind||e.kind===t.kind)&&e.uri===t.uri}function y(e,t){const i=[];for(const r of e.rtcpFeedback||[]){const e=(t.rtcpFeedback||[]).find(;e&&i.push(e)}return i}t.validateRtpCapabilities=function(e){if("object"!=typeof e)throw new TypeError("caps is not an object");if(e.codecs&&!Array.isArray(e.codecs))throw new TypeError("caps.codecs is not an array");e.codecs||(e.codecs=[]);for(const t of e.codecs)l(t);if(e.headerExtensions&&!Array.isArray(e.headerExtensions))throw new TypeError("caps.headerExtensions is not an array");e.headerExtensions||(e.headerExtensions=[]);for(const t of e.headerExtensions)c(t)},t.validateRtpCodecCapability=l,t.validateRtcpFeedback=d,t.validateRtpHeaderExtension=c,t.validateRtpParameters=u,t.validateRtpCodecParameters=p,t.validateRtpHeaderExtensionParameters=h,t.validateRtpEncodingParameters=m,t.validateRtcpParameters=v,t.validateSctpCapabilities=function(e){if("object"!=typeof e)throw new TypeError("caps is not an object");if(!e.numStreams||"object"!=typeof e.numStreams)throw new TypeError("missing caps.numStreams");g(e.numStreams)},t.validateNumSctpStreams=g,t.validateSctpParameters=function(e){if("object"!=typeof e)throw new TypeError("params is not an object");if("number"!=typeof e.port)throw new TypeError("missing params.port");if("number"!=typeof e.OS)throw new TypeError("missing params.OS");if("number"!=typeof e.MIS)throw new TypeError("missing params.MIS");if("number"!=typeof e.maxMessageSize)throw new TypeError("missing params.maxMessageSize")},t.validateSctpStreamParameters=function(e){if("object"!=typeof e)throw new TypeError("params is not an object");if("number"!=typeof e.streamId)throw new TypeError("missing params.streamId");let t=!1;if("boolean"==typeof e.ordered?t=!0:e.ordered=!0,e.maxPacketLifeTime&&"number"!=typeof e.maxPacketLifeTime)throw new TypeError("invalid params.maxPacketLifeTime");if(e.maxRetransmits&&"number"!=typeof e.maxRetransmits)throw new TypeError("invalid params.maxRetransmits");if(e.maxPacketLifeTime&&e.maxRetransmits)throw new TypeError("cannot provide both maxPacketLifeTime and maxRetransmits");if(t&&e.ordered&&(e.maxPacketLifeTime||e.maxRetransmits))throw new TypeError("cannot be ordered with maxPacketLifeTime or maxRetransmits");if(t||!e.maxPacketLifeTime&&!e.maxRetransmits||(e.ordered=!1),e.label&&"string"!=typeof e.label)throw new TypeError("invalid params.label");if(e.protocol&&"string"!=typeof e.protocol)throw new TypeError("invalid params.protocol")},t.getExtendedRtpCapabilities=function(e,t){const i={codecs:[],headerExtensions:[]};for(const r of t.codecs||[]){if(f(r))continue;const t=(e.codecs||[]).find(;if(!t)continue;const s={mimeType:t.mimeType,kind:t.kind,clockRate:t.clockRate,channels:t.channels,localPayloadType:t.preferredPayloadType,localRtxPayloadType:void 0,remotePayloadType:r.preferredPayloadType,remoteRtxPayloadType:void 0,localParameters:t.parameters,remoteParameters:r.parameters,rtcpFeedback:y(t,r)};i.codecs.push(s)}for(const r of i.codecs){const i=e.codecs.find(e=>f(e)&&e.parameters.apt===r.localPayloadType),s=t.codecs.find(;i&&s&&(r.localRtxPayloadType=i.preferredPayloadType,r.remoteRtxPayloadType=s.preferredPayloadType)}for(const r of t.headerExtensions){const t=e.headerExtensions.find(;if(!t)continue;const s={kind:r.kind,uri:r.uri,sendId:t.preferredId,recvId:r.preferredId,encrypt:t.preferredEncrypt,direction:"sendrecv"};switch(r.direction){case"sendrecv":s.direction="sendrecv";break;case"recvonly":s.direction="sendonly";break;case"sendonly":s.direction="recvonly";break;case"inactive":s.direction="inactive"}i.headerExtensions.push(s)}return i},t.getRecvRtpCapabilities=function(e){const t={codecs:[],headerExtensions:[]};for(const i of e.codecs){const e={mimeType:i.mimeType,kind:i.kind,preferredPayloadType:i.remotePayloadType,clockRate:i.clockRate,channels:i.channels,parameters:i.localParameters,rtcpFeedback:i.rtcpFeedback};if(t.codecs.push(e),!i.remoteRtxPayloadType)continue;const r={mimeType:i.kind+"/rtx",kind:i.kind,preferredPayloadType:i.remoteRtxPayloadType,clockRate:i.clockRate,parameters:{apt:i.remotePayloadType},rtcpFeedback:[]};t.codecs.push(r)}for(const i of e.headerExtensions){if("sendrecv"!==i.direction&&"recvonly"!==i.direction)continue;const e={kind:i.kind,uri:i.uri,preferredId:i.recvId,preferredEncrypt:i.encrypt,direction:i.direction};t.headerExtensions.push(e)}return t},t.getSendingRtpParameters=function(e,t){const i={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}};for(const r of t.codecs){if(r.kind!==e)continue;const t={mimeType:r.mimeType,payloadType:r.localPayloadType,clockRate:r.clockRate,channels:r.channels,parameters:r.localParameters,rtcpFeedback:r.rtcpFeedback};if(i.codecs.push(t),r.localRtxPayloadType){const e={mimeType:r.kind+"/rtx",payloadType:r.localRtxPayloadType,clockRate:r.clockRate,parameters:{apt:r.localPayloadType},rtcpFeedback:[]};i.codecs.push(e)}}for(const r of t.headerExtensions){if(r.kind&&r.kind!==e||"sendrecv"!==r.direction&&"sendonly"!==r.direction)continue;const t={uri:r.uri,id:r.sendId,encrypt:r.encrypt,parameters:{}};i.headerExtensions.push(t)}return i},t.getSendingRemoteRtpParameters=function(e,t){const i={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}};for(const r of t.codecs){if(r.kind!==e)continue;const t={mimeType:r.mimeType,payloadType:r.localPayloadType,clockRate:r.clockRate,channels:r.channels,parameters:r.remoteParameters,rtcpFeedback:r.rtcpFeedback};if(i.codecs.push(t),r.localRtxPayloadType){const e={mimeType:r.kind+"/rtx",payloadType:r.localRtxPayloadType,clockRate:r.clockRate,parameters:{apt:r.localPayloadType},rtcpFeedback:[]};i.codecs.push(e)}}for(const r of t.headerExtensions){if(r.kind&&r.kind!==e||"sendrecv"!==r.direction&&"sendonly"!==r.direction)continue;const t={uri:r.uri,id:r.sendId,encrypt:r.encrypt,parameters:{}};i.headerExtensions.push(t)}if(i.headerExtensions.some(e=>"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===e.uri))for(const e of i.codecs)e.rtcpFeedback=(e.rtcpFeedback||[]).filter(e=>"goog-remb"!==e.type);else if(i.headerExtensions.some(e=>"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"===e.uri))for(const e of i.codecs)e.rtcpFeedback=(e.rtcpFeedback||[]).filter(e=>"transport-cc"!==e.type);else for(const e of i.codecs)e.rtcpFeedback=(e.rtcpFeedback||[]).filter(;return i},t.reduceCodecs=function(e,t){const i=[];if(t){for(let r=0;r<e.length;++r)if(b(e[r],t)){i.push(e[r]),f(e[r+1])&&i.push(e[r+1]);break}if(0===i.length)throw new TypeError("no matching codec found")}else i.push(e[0]),f(e[1])&&i.push(e[1]);return i},t.generateProbatorRtpParameters=function(e){u(e=a.clone(e,{}));const t={mid:"probator",codecs:[],headerExtensions:[],encodings:[{ssrc:1234}],rtcp:{cname:"probator"}};return t.codecs.push(e.codecs[0]),t.codecs[0].payloadType=127,t.headerExtensions=e.headerExtensions,t},t.canSend=t.canReceive=,"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/scalabilityModes.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parse=void 0;const i=new RegExp("^[LS]([1-9]\\d{0,1})T([1-9]\\d{0,1})");t.parse=,"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/types.js":"./node_modules/@video/video-client-core/node_modules/mediasoup-client/lib/utils.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateRandomNumber=t.clone=void 0,t.clone=t.generateRandomNumber=,"./node_modules/@video/video-client-core/node_modules/qs/lib/formats.js":"./node_modules/@video/video-client-core/node_modules/qs/lib/index.js":"./node_modules/@video/video-client-core/node_modules/qs/lib/parse.js":"./node_modules/@video/video-client-core/node_modules/qs/lib/stringify.js":(e,t,i)=>{"use strict";var r=i("./node_modules/@video/video-client-core/node_modules/qs/lib/utils.js"),s=i("./node_modules/@video/video-client-core/node_modules/qs/lib/formats.js"),o=Object.prototype.hasOwnProperty,n={brackets:comma:"comma",indices:repeat:function(e){return e}},a=Array.isArray,l=Array.prototype.push,d=c=Date.prototype.toISOString,u=s.default,p={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:r.encode,encodeValuesOnly:!1,format:u,formatter:s.formatters[u],indices:!1,serializeDate:function(e){return c.call(e)},skipNulls:!1,strictNullHandling:!1},h=e.exports=,"./node_modules/@video/video-client-core/node_modules/qs/lib/utils.js":"./node_modules/@video/video-client-web/index.js":(e,t,i)=>{"use strict";e.exports=i("./node_modules/@video/video-client-web/lib/index.js")},"./node_modules/@video/video-client-web/lib/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.selectStyles=t.styles=void 0;const r=i("./node_modules/tslib/tslib.es6.js");r.__exportStar(i("./node_modules/@video/video-client-core/index.js"),t),r.__exportStar(i("./node_modules/@video/video-client-web/lib/store/index.js"),t),r.__exportStar(i("./node_modules/@video/video-client-web/lib/ui/index.js"),t),t.styles=r.__importStar(i("./node_modules/@video/video-client-web/lib/styles.js")),t.selectStyles=r.__importStar(i("./node_modules/@video/video-client-web/lib/select-styles.js"))},"./node_modules/@video/video-client-web/lib/package-json.js":"./node_modules/@video/video-client-web/lib/select-styles.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Inputs=void 0;const r=i("./node_modules/tslib/tslib.es6.js");t.Inputs=r.__importStar(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Inputs/selectStyles.js"))},"./node_modules/@video/video-client-web/lib/store/call/call-state.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/@video/video-client-core/index.js"),o=i("./node_modules/mobx/dist/mobx.esm.js");class n extends s.ObservableEventEmitter{constructor(){super(),this.call=null,this.broadcast=null,this.zeroBitrateHandler=[],(0,o.makeObservable)(this,{call:o.observable,broadcast:o.observable}),this.addInnerDisposer((0,o.reaction)(()=>this.call,(e,t)=>{null!=t&&t.off("zeroBitrate",this.onZeroBitrate),null!=e&&e.on("zeroBitrate",this.onZeroBitrate)}))}ggleBroadcast(e,t,i,s){return r.__awaiter(this,void 0,void 0,(function*(){return this.isBroadcasting?this.stopBroadcast():"string"==typeof e?this.startBroadcastOnExistingCall(e,t,i,s):this.startBroadcastOnNewCall(e,t,i,s)}))}startBroadcastOnNewCall(e,t,i,s){return r.__awaiter(this,void 0,void 0,(function*(){if(null!=this.call)throw new Error("Cannot start broadcast on a call that is already active");return this.call=yield s.createCall(e),this.startBroadcastOnExistingCall(this.call.id,t,i,s)}))}startBroadcastOnExistingCall(e,t,i,s){return r.__awaiter(this,void 0,void 0,(function*(){if(null!=this.broadcast)throw new Error("Broadcast is already active");null!=this.call&&"active"===this.call.state||(this.call=yield s.joinCall(e)),this.call.on("viewerKicked",,this.broadcast=yield this.call.broadcast(i,t)}))}stopBroadcast(){var e,t,i,s;return r.__awaiter(this,void 0,void 0,(function*(){(null===(e=this.call)||void 0===e?void 0:e.isOwner)?(null===(t=this.call)||void 0===t||t.dispose("call disposed via callState stopBroadcast()"),null===(i=this.call)||void 0===i||i.close("Closing via callState stopBroadcast()"),this.call=null):null===(s=this.broadcast)||void 0===s||s.dispose("broadcast disposed via callState stopBroadcast()"),this.broadcast=null}))}}t.default=n},"./node_modules/@video/video-client-web/lib/store/call/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CallState=void 0;const r=i("./node_modules/tslib/tslib.es6.js").__importDefault(i("./node_modules/@video/video-client-web/lib/store/call/call-state.js"));t.CallState=r.default},"./node_modules/@video/video-client-web/lib/store/encoder/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EncoderUiState=void 0;const r=i("./node_modules/tslib/tslib.es6.js").__importDefault(i("./node_modules/@video/video-client-web/lib/store/encoder/ui-state.js"));t.EncoderUiState=r.default},"./node_modules/@video/video-client-web/lib/store/encoder/silence-background.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.withSilenceBackground=void 0;const i=new WeakMap;t.withSilenceBackground=function(e,t){if(null==t)return null;const r=i.get(t);if(null!=r)return r;const s=t.getVideoTracks();if(0===s.length)return t;const o=function(e,t){const i=function(e){const t=e.createBufferSource(),i=e.createBuffer(1,1,e.sampleRate),r=i.getChannelData(0);for(let e=0;e<r.length;e++)r[e]=2*Math.random()-1;return t.buffer=i,t.loop=!0,t}(e),r=e.createGain();r.gain.value=.001,i.connect(r),r.connect(e.destination),i.start();const s=e.createMediaStreamDestination().stream.getAudioTracks()[0],o=new MediaStream;return t.forEach(e=>{o.addTrack(e),e.addEventListener("ended",()=>{s.stop()},{once:!0})}),o.addTrack(s),o}(e,s);return i.set(t,o),o}},"./node_modules/@video/video-client-web/lib/store/encoder/ui-state.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/@video/video-client-core/index.js"),o=i("./node_modules/mobx/dist/mobx.esm.js"),n=i("./node_modules/@video/video-client-web/lib/store/utils/online-watcher.js"),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/store/utils/ui-state.js"));class l extends a.default{constructor(e,t={}){var i;if(super(),this.audioCtx=new AudioContext,this.prevVideoDeviceId=null,this.testMic=!1,this.mediaStreamController=e,this.logger=null!==(i=t.logger)&&void 0!==i?i:this.mediaStreamController.logger,(0,o.makeObservable)(this,{mediaStreamController:o.observable.ref,prevVideoDeviceId:o.observable,testMic:o.observable,aspectRatioPadding:o.computed,handleScreenCapture:o.action,toggleVideoCallSlider:o.action}),!e.inVideoDeviceTransition)if(void 0===t.videoDevice){if(s.mediaController.videoDevices().length>0){const[t]=s.mediaController.videoDevices();e.videoDeviceId=t.deviceId}}else e.videoDeviceId=t.videoDevice;if(!e.inAudioDeviceTransition)if(void 0===t.audioDevice){if(s.mediaController.audioDevices().length>0){const[t]=s.mediaController.audioDevices();e.audioDeviceId=t.deviceId}}else e.audioDeviceId=t.audioDevice;this.addInnerDisposer(this.mediaStreamController),this.addInnerDisposer(,this.addInnerDisposer((0,n.onlineWatcher)(this.logger))}et aspectRatioPadding(){var e,t,i;const r=null===(i=null===(t=null===(e=this.mediaStreamController)||void 0===e?void 0:e.settings)||void 0===t?void 0:t.video)||void 0===i?void 0:i.aspectRatio;return null==r?null:(1/r*100).toFixed(2)+"%"}toggleMute(){null!=this.videoElement.current&&(this.videoElement.current.muted=!this.videoElement.current.muted)}handleScreenCapture(){var e,t;null!=(null===(e=this.mediaStreamController)||void 0===e?void 0:e.videoDeviceId)&&("screencapture"!==(null===(t=this.mediaStreamController)||void 0===t?void 0:t.videoDeviceId)?(this.prevVideoDeviceId=this.mediaStreamController.videoDeviceId,this.mediaStreamController.videoDeviceId="screencapture"):this.mediaStreamController.videoDeviceId=this.prevVideoDeviceId)}toggleVideoCallSlider(){this.viewVideoCallSlider=!this.viewVideoCallSlider}}t.default=l,l.displayName="EncoderUiState"},"./node_modules/@video/video-client-web/lib/store/index.js":"./node_modules/@video/video-client-web/lib/store/player/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlayerUiState=void 0;const r=i("./node_modules/tslib/tslib.es6.js").__importDefault(i("./node_modules/@video/video-client-web/lib/store/player/ui-state.js"));t.PlayerUiState=r.default},"./node_modules/@video/video-client-web/lib/store/player/ui-state.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/@video/log-client/index.js"),o=i("./node_modules/@video/video-client-core/index.js"),n=i("./node_modules/mobx/dist/mobx.esm.js"),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/package-json.js")),l=i("./node_modules/@video/video-client-web/lib/store/utils/online-watcher.js"),d=r.__importDefault(i("./node_modules/@video/video-client-web/lib/store/utils/ui-state.js")),c=i("./node_modules/@video/video-client-web/lib/store/player/utils.js");class u extends d.default{constructor(e,t){var i,r;super(),this.viewGetSound=!0,this.qualityMouseOver=!1,(0,n.makeObservable)(this,{viewGetSound:n.observable,qualityMouseOver:n.observable,encoderMuted:n.computed,encoderNoVideo:n.computed,availableBitrates:n.computed}),this._options=t,this.player=e,null!=this.player.logger?this.logger=new s.LoggerCore("VDC-web").extend(this.player.logger).setMessageAggregate("chain","Player:"+u.displayName):this.logger=new s.LoggerCore("VDC-web").setLoggerMeta("client","VDC").setLoggerMeta("chain","PlayerUiState").setLoggerMeta("release",a.default.version).setMessageAggregate("contextId",null!==(i=(0,o.contextId)())&&void 0!==i?i:void 0).setMessageAggregate("instanceId",null!==(r=(0,o.instanceId)())&&void 0!==r?r:void 0),this.player.on("consumerVideoEnabled",e=>this.emit("encoderNoVideo",!e)),this.player.on("consumerAudioEnabled",e=>this.emit("encoderMuted",!e)),this.addInnerDisposer(this.player),this.addInnerDisposer((0,l.onlineWatcher)(this.logger))}get availableQualities(){var e;return this.player.isImplements(o.player.Feature.BITRATE_SWITCHING)&&null!==(e=this.player.availableQualities)&&void 0!==e?e:[]}get availableBitrates(){return this.player.isImplements(o.player.Feature.BITRATE_SWITCHING)&&null!=this.player.availableQualities?(0,c.availableBitrateHelper)(this.player.availableQualities):[]}get availablePlayers(){var e;return this.player.isImplements(o.player.Feature.PLAYER_SELECTOR)&&null!==(e=this.player.availablePlayers)&&void 0!==e?e:[]}get currentPlayer(){return this.player}get encoderMuted(){return this.player.isImplements(o.player.Feature.CONSUMER)?!this.player.consumerAudioEnabled:null}get encoderNoVideo(){return this.player.isImplements(o.player.Feature.CONSUMER)?!this.player.consumerVideoEnabled:null}get showToolbar(){const e=this.videoMouseOver,t=this.controlMouseOver,i=this.qualityMouseOver;return e||t||i}}t.default=u,u.displayName="PlayerUiState"},"./node_modules/@video/video-client-web/lib/store/player/utils.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.availableBitrateHelper=void 0;const r=i("./node_modules/@video/video-client-core/index.js");function s(e,t=""){var i;return null==e.layer?t:((null!==(i=e.layer.bitrate)&&void 0!==i?i:0)/1e3).toFixed(2)}function o(e,t,i){let r=null,o=null;for(const i of t){const t=e.find(e=>e.level===i);if(null!=t){r=i,o=s(t);break}}return{score:r,name:i,formattedBitrate:o}}t.availableBitrateHelper=e=>{if(null==e)return[];return[o(e,[r.AutoQualityLevel.Auto],"Auto"),o(e,[r.SourceScoreLevel.Low,r.SourceScoreLevel.Medium,r.SourceScoreLevel.High],"Source"),o(e,[r.TranscodeScoreLevel.Low,r.TranscodeScoreLevel.Lowest],"Low"),o(e,[r.TranscodeScoreLevel.Medium,r.TranscodeScoreLevel.MediumHigh,r.TranscodeScoreLevel.MediumLow],"Medium"),o(e,[r.TranscodeScoreLevel.High,r.TranscodeScoreLevel.Highest],"High")].filter(}},"./node_modules/@video/video-client-web/lib/store/recorder/index.js":"./node_modules/@video/video-client-web/lib/store/recorder/ui-state.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/mobx/dist/mobx.esm.js"),o=r.__importDefault(i("./node_modules/@video/video-client-web/lib/store/utils/ui-state.js"));class n extends o.default{constructor(){super(),this.recordingReady=!1,this.recording=!1,(0,s.makeObservable)(this,{recordingReady:s.observable,recording:s.observable,setRecorder:s.action,removeRecorder:s.action,setupRecorder:s.action,record:s.action,pauseRecording:s.action,browserStopEvent:s.action,closeRecording:s.action,saveRecording:s.action,resetRecorder:s.action,setRecordingReady:s.action}),this.recorder=null,this.recordingReady=!1,this.recording=!1,this.resumeDisabled=!1}setRecorder(e){this.recorder=e}etupRecorder(e=!0){var t;return r.__awaiter(this,void 0,void 0,(function*(){"error"===(yield null===(t=this.recorder)||void 0===t?void 0:t.setupRecorder()).status&&(0,s.runInAction)(()=>{this.recording=!1,this.recordingReady=!1}),e?(0,s.runInAction)(()=>{this.recording=!0,this.recordingReady=!0}):(0,s.runInAction)(()=>{this.recordingReady=!0})}))}record(){var e;return r.__awaiter(this,void 0,void 0,(function*(){"error"===(yield null===(e=this.recorder)||void 0===e?void 0:e.record()).status&&(0,s.runInAction)(()=>{this.recording=!1}),(0,s.runInAction)(()=>{this.recording=!0})}))}pauseRecording(){var e;(0,s.runInAction)(()=>{this.recording=!1}),null===(e=this.recorder)||void 0===e||e.pause()}browserStopEvent(){var e;(0,s.runInAction)(,null===(e=this.recorder)||void 0===e||e.pause()}closeRecording(){var e,t;return r.__awaiter(this,void 0,void 0,(function*(){(null===(e=this.recorder)||void 0===e?void 0:e.stream)&&(yield null===(t=this.recorder)||void 0===t?void 0:t.close()),(0,s.runInAction)(()=>{this.recording=!1,this.recordingReady=!1,this.recorder=null})}))}saveRecording(){var e;return r.__awaiter(this,void 0,void 0,(function*(){(0,s.runInAction)(()=>{this.recording=!1}),yield null===(e=this.recorder)||void 0===e?void 0:e.save(),(0,s.runInAction)(()=>{this.recordingReady=!1})}))}resetRecorder(){return r.__awaiter(this,void 0,void 0,(function*(){(0,s.runInAction)(}))}setRecordingReady(){return r.__awaiter(this,void 0,void 0,(function*(){(0,s.runInAction)(()=>{this.recordingReady=!0})}))}}t.default=n,n.displayName="RecorderUiState"},"./node_modules/@video/video-client-web/lib/store/utils/fullscreen.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fullscreenElement=t.exitFullscreen=t.requestFullscreen=void 0;const r=i("./node_modules/@video/video-client-core/index.js");let s=null;function o(e){var t;return null==e||e instanceof HTMLVideoElement?e:null!==(t=e.querySelector("video"))&&void 0!==t?t:null}function n(e){const t=o(e);return r.adapter.device.isIosDevice&&"function"==typeof(null==t?void 0:t.webkitEnterFullscreen)}t.requestFullscreen=function(e){let t;return t=n(e)?function(e){var t;const i=o(e);if(null==i)return Promise.reject(new Error("video element not found"));const r=null===(t=i.webkitEnterFullscreen)||void 0===t?void 0:t.call(i);return s=i,i.addEventListener("webkitendfullscreen",()=>{s=null,document.dispatchEvent(new Event("fullscreenchange")),setTimeout(1e3)},{once:!0}),document.dispatchEvent(new Event("fullscreenchange")),null!=r?r:Promise.resolve()}(e):"function"==typeof e.requestFullscreen?e.requestFullscreen():"function"==typeof e.webkitRequestFullScreen?e.webkitRequestFullScreen():Promise.reject(new Error("requestFullscreen not supported")),null!=t?t:Promise.resolve()},t.exitFullscreen=function(){let e;return e=n(s)?function(){var e;const t=null===(e=null==s?void 0:s.webkitCancelFullScreen)||void 0===e?void 0:e.call(s);return null!=t?t:Promise.resolve()}():"function"==typeof document.exitFullscreen?document.exitFullscreen():"function"==typeof document.webkitCancelFullScreen?document.webkitCancelFullScreen():Promise.reject(new Error("exitFullscreen not supported")),null!=e?e:Promise.resolve()},t.fullscreenElement=function(){var e,t,i;return null!==(i=null!==(t=null!==(e=document.fullscreenElement)&&void 0!==e?e:document.webkitFullscreenElement)&&void 0!==t?t:document.webkitCurrentFullScreenElement)&&void 0!==i?i:s}},"./node_modules/@video/video-client-web/lib/store/utils/index.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.videoStylesNamespace=t.getDevices=t.createVideoElement=void 0;t.createVideoElement=(e=!0)=>{const t=document.createElement("video");t.autoplay=e,t.muted=!0;const i=document.createTextNode("Sorry, your browser doesn't support embedded videos.");return t.appendChild(i),t};t.getDevices=(e,t)=>!Array.isArray(e)||"audio"!==t&&"video"!==t?null:e.filter(,t.videoStylesNamespace="video"},"./node_modules/@video/video-client-web/lib/store/utils/online-watcher.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onlineWatcher=void 0,t.onlineWatcher=function(e){const t=t=>{const i=JSON.stringify(t);e.warn("user online",{eventJson:i})},i=t=>{const i=JSON.stringify(t);e.warn("user offline",{eventJson:i})};return window.addEventListener("online",t),window.addEventListener("offline",i),},"./node_modules/@video/video-client-web/lib/store/utils/ui-state.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/@video/video-client-core/index.js"),o=i("./node_modules/mobx/dist/mobx.esm.js"),n=i("webpack/sharing/consume/default/react/react"),a=i("./node_modules/@video/video-client-web/lib/store/utils/fullscreen.js");class l extends s.ObservableEventEmitter{constructor(){super(),this.videoElement=(0,n.createRef)(),this.videoWrapperElement=(0,n.createRef)(),this.isFullscreen=!1,this.newWindow=null,this.newWindowElement=null,this.portal=!1,this.portalElement=null,this.viewSettings=!1,this.viewVideoCallSlider=!1,this.videoMouseOver=s.adapter.device.isMobileDevice,this.controlMouseOver=s.adapter.device.isMobileDevice,this.mobileDevice=s.adapter.device.isMobileDevice,this.iosDevice=s.adapter.device.isIosDevice,this.screenShareSupported=!s.adapter.device.isMobileDevice,this.volumeRangeSupported=!s.adapter.device.isIosDevice,(0,o.makeObservable)(this,{videoWrapperElement:o.observable.ref,isFullscreen:o.observable,newWindow:o.observable,newWindowElement:o.observable.ref,portal:o.observable,portalElement:o.observable.ref,viewSettings:o.observable,viewVideoCallSlider:o.observable,controlMouseOver:o.observable,videoMouseOver:o.observable,toggleFullscreen:o.action,onFullscreenChange:o.action}),document.addEventListener("fullscreenchange",this.onFullscreenChange),document.addEventListener("webkitfullscreenchange",this.onFullscreenChange),this.addInnerDisposer(}onFullscreenChange(){this.isFullscreen=null!=(0,a.fullscreenElement)()}toggleFullscreen(){return r.__awaiter(this,void 0,void 0,(function*(){null!=this.videoWrapperElement.current&&(this.isFullscreen?yield(0,a.exitFullscreen)():yield(0,a.requestFullscreen)(this.videoWrapperElement.current))}))}}t.default=l},"./node_modules/@video/video-client-web/lib/styles.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CallControl=t.VideoWrapper=t.SlidingShelf=t.Inputs=t.ButtonsIcon=t.Recorder=t.InputsPlayer=void 0;const r=i("./node_modules/tslib/tslib.es6.js");t.InputsPlayer=r.__importStar(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Inputs/Player/styles.js")),t.Recorder=r.__importStar(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Recorder/styles.js")),t.ButtonsIcon=r.__importStar(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Buttons/Icon/styles.js")),t.Inputs=r.__importStar(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Inputs/styles.js")),t.SlidingShelf=r.__importStar(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/SlidingShelf/styles.js")),t.VideoWrapper=r.__importStar(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/VideoWrapper/styles.js")),t.CallControl=r.__importStar(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/CallControl/callControlStyles.js"))},"./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useUIEventError=t.useUndefinedStoreError=t.ErrorBoundary=void 0;const r=i("webpack/sharing/consume/default/react/react");class s extends r.Component{nder(){const{children:e,render:t}=this.props,{error:i}=this.state;return i?t():e}}t.ErrorBoundary=s,t.useUndefinedStoreError=t.useUIEventError=function(e,t){const[i,s]=(0,r.useState)(null);return(0,r.useEffect)(()=>{if(i instanceof Error&&null!=e){const r=e.name||"undefined function";throw new Error(`[Video]: ${i.name} ${i.message} in ${r} at ${t}.`)}},[t,i,e]),(...t)=>{if(null!=e)try{e(...t)}catch(e){s(e)}}}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Alerts/ErrorAlert.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/mobx-react-lite/es/index.js"),o=r.__importStar(i("webpack/sharing/consume/default/react/react")),n=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Alerts/AlertBase.js")),a={root:{backgroundColor:"#f54248",color:"#00000"}},l=(0,s.observer)(e=>{var{error:t,children:i,classes:s}=e,l=r.__rest(e,["error","children","classes"]);const[d,c]=(0,o.useState)(!1);if((0,o.useEffect)([t]),null==t)return null;return o.default.createElement(n.default,Object.assign({classes:s||a},l,{active:d,setActive:c}),null!=i?i:o.default.createElement((function(){return o.default.createElement("p",{style:{margin:0}}," Error: ",null==t?void 0:t.code," ")}),null))});t.default=l},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Badges/PeerMuted.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/@video/video-client-core/index.js"),o=i("./node_modules/mobx-react-lite/es/index.js"),n=r.__importStar(i("webpack/sharing/consume/default/react/react")),a=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),l=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Badges/PeerMuted.js")),d=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js"),c=(0,o.observer)(e=>{var t,{icon:i,muted:o}=e,c=r.__rest(e,["icon","muted"]);const u=(0,n.useContext)(a.PlayerUiContext);return(0,d.useUndefinedStoreError)(null!=u,"<PeerMutedBadge/>"),u.player.isImplements(s.player.Feature.CONSUMER)?n.default.createElement(l.default,Object.assign({muted:null!==(t=null!=o?o:!u.player.consumerAudioEnabled)&&void 0!==t&&t,icon:i},c)):null});t.default=e=>{var t=r.__rest(e,[]);return n.default.createElement(d.ErrorBoundary,{render:,n.default.createElement(c,Object.assign({},t)))}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Encoder/Camera/Camera.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/mobx-react-lite/es/index.js"),o=r.__importStar(i("webpack/sharing/consume/default/react/react")),n=i("./node_modules/@video/video-client-core/index.js"),a=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),l=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Buttons/Icon/index.js")),d=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/index.js")),c=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js"),u=(0,s.observer)(e=>{var{icon:t,onClick:i,active:s,classes:u={root:{},icon:{}},screenReaderText:p,label:h="Toggle camera"}=e,m=r.__rest(e,["icon","onClick","active","classes","screenReaderText","label"]);const v=(0,o.useContext)(a.EncoderUiContext);(0,c.useUndefinedStoreError)(null!=(null==v?void 0:v.mediaStreamController),"<CameraButton/>");const g=null!=i?i:(0,c.useUIEventError)(()=>{n.adapter.device.isIosDevice?v.mediaStreamController.videoPaused=!v.mediaStreamController.videoPaused:v.mediaStreamController.videoDisabled=!v.mediaStreamController.videoDisabled},"<CameraButton/>"),f=(null!=s?s:n.adapter.device.isIosDevice)?!v.mediaStreamController.videoPaused:!v.mediaStreamController.videoDisabled,b=f?o.default.createElement(d.default,{iconName:"camera",classes:null==u?void 0:u.icon}):o.default.createElement(d.default,{iconName:"cameraoff",classes:null==u?void 0:u.icon});return o.default.createElement(l.default,Object.assign({active:f,"data-selenium":"camera-toggle-button",icon:null!=t?t:b,onClick:g,classes:u,label:h,disabled:null==v.mediaStreamController.videoDeviceId},m),null!=p?p:"Click to turn Camera Stream "+(f?"Off":"On"))});t.default=e=>{var{icon:t,classes:i,label:s="Toggle camera",screenReaderText:n}=e,a=r.__rest(e,["icon","classes","label","screenReaderText"]);const p=null!=t?t:o.default.createElement(d.default,{iconName:"camera",classes:null==i?void 0:i.icon});return o.default.createElement(c.ErrorBoundary,{render:()=>o.default.createElement(l.default,Object.assign({"data-selenium":"camera-toggle-button",disabled:!0,classes:i,icon:p,label:s,onClick:void 0,active:!1},a),null!=n?n:"Click to turn Camera Stream On")},o.default.createElement(u,Object.assign({classes:i,icon:t,label:s,screenReaderText:n},a)))}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Encoder/JoinBroadcast/JoinBroadcast.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/mobx/dist/mobx.esm.js"),o=i("./node_modules/mobx-react-lite/es/index.js"),n=r.__importStar(i("webpack/sharing/consume/default/react/react")),a=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),l=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Buttons/Icon/index.js")),d=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/index.js")),c=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js"),u=(0,o.observer)(e=>{var{icon:t,onClick:i,screenReaderText:o,broadcastOptions:u,onZeroBitrate:p,active:h,classes:m={root:{},icon:{}},label:v="Stream Broadcast Toggle Button",setCallId:g,callId:f,setOwnerCall:b,setCall:_,clientReferrer:y,sfuOptions:w,videoUserId:S}=e,E=r.__rest(e,["icon","onClick","screenReaderText","broadcastOptions","onZeroBitrate","active","classes","label","setCallId","callId","setOwnerCall","setCall","clientReferrer","sfuOptions","videoUserId"]);const C=(0,n.useContext)(a.EncoderUiContext),j=(0,n.useContext)(a.CallContext),P=(0,n.useContext)(a.VideoClientContext),R=(0,n.useRef)(!1);(0,c.useUndefinedStoreError)(null!=(null==C?void 0:C.mediaStreamController)&&null!=P&&null!=j,"<BroadcastButton/>"),(0,n.useEffect)(()=>(p&&j.zeroBitrateHandler.push(p),,[j,p]),(0,n.useEffect)(()=>{(0,s.reaction)(()=>j.call,(e,t)=>{var i;null==_||_(e),null==g||g(null!==(i=null==e?void 0:e.id)&&void 0!==i?i:null),(null==e?void 0:e.isOwner)&&(null==b||b(e))})},[j,_,g,b]);const x=null!=h?h:j.isBroadcasting,D={userId:S,clientReferrer:y,sfu:w};const T=null!=i?i:(0,c.useUIEventError)((function(){return r.__awaiter(this,void 0,void 0,(function*(){C&&P&&j&&!R.current&&(R.current=!0,yield j.toggleBroadcast(null!=f?f:D,u,C.mediaStreamController,P),R.current=!1)}))}),"<BroadcastButton/>"),I=null!=t?t:n.default.createElement(d.default,{iconName:"broadcast",classes:null==m?void 0:m.icon});return n.default.createElement(l.default,Object.assign({active:x,activeClass:"video-button--active lv-button--active",classes:m,inactiveClass:null,"data-selenium":"broadcast-stream-button",icon:I,onClick:T,disabled:null==C.mediaStreamController.videoDeviceId&&null==C.mediaStreamController.audioDeviceId,label:v},E),null!=o?o:`Click to ${x?"Stop":"Start"} Broadcast`)});t.default=e=>{var{icon:t,label:i="Stream Broadcast Toggle Button",screenReaderText:s,broadcastOptions:o,classes:a}=e,p=r.__rest(e,["icon","label","screenReaderText","broadcastOptions","classes"]);const h=n.default.createElement(d.default,{iconName:"broadcast",classes:null==a?void 0:a.icon});return n.default.createElement(c.ErrorBoundary,{render:()=>n.default.createElement(l.default,Object.assign({"data-selenium":"broadcast-stream-button",disabled:!0,classes:a,icon:null!=t?t:h,label:i,onClick:void 0,active:!1},p),null!=s?s:"Click to start Broadcast")},n.default.createElement(u,Object.assign({icon:t,classes:a,label:i,screenReaderText:s,broadcastOptions:o},p)))}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Encoder/Microphone/Microphone.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/mobx-react-lite/es/index.js"),o=r.__importStar(i("webpack/sharing/consume/default/react/react")),n=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Buttons/Icon/index.js")),l=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/index.js")),d=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js"),c=(0,s.observer)(e=>{var{onClick:t,classes:i={root:{},icon:{}},icon:s,screenReaderText:c,label:u="Toggle mute",active:p}=e,h=r.__rest(e,["onClick","classes","icon","screenReaderText","label","active"]);const m=(0,o.useContext)(n.EncoderUiContext);(0,d.useUndefinedStoreError)(null!=(null==m?void 0:m.mediaStreamController),"<MicrophoneButton/>");const v=t||(0,d.useUIEventError)(()=>{m.mediaStreamController.audioMuted=!m.mediaStreamController.audioMuted},"<MicrophoneButton/>"),g=null!=p?p:!m.mediaStreamController.audioMuted,f=g?o.default.createElement(l.default,{title:u,iconName:"microphone",classes:null==i?void 0:i.icon}):o.default.createElement(l.default,{title:u,iconName:"microphoneoff",classes:null==i?void 0:i.icon});return o.default.createElement(a.default,Object.assign({active:g,classes:i,"data-selenium":"mic-toggle-button",icon:s||f,onClick:v,label:u,disabled:null==m.mediaStreamController.audioDeviceId},h),null!=c?c:`Click to ${p?"Stop":"Start"} Audio Stream`)});t.default=e=>{var{icon:t,classes:i,label:s="Toggle mute",screenReaderText:n,style:u={}}=e,p=r.__rest(e,["icon","classes","label","screenReaderText","style"]);const h=t||o.default.createElement(l.default,{iconName:"microphoneoff",classes:null==i?void 0:i.icon});return o.default.createElement(d.ErrorBoundary,{render:()=>o.default.createElement(a.default,Object.assign({"data-selenium":"mic-toggle-button",disabled:!0,label:s,icon:h,classes:i,onClick:void 0,active:!1},p),null!=n?n:"Click to Start Audio Stream")},o.default.createElement(c,Object.assign({classes:i,icon:t,label:s,screenReaderText:n,style:u},p)))}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Encoder/ScreenCapture/ScreenCapture.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/mobx-react-lite/es/index.js"),o=r.__importStar(i("webpack/sharing/consume/default/react/react")),n=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Buttons/Icon/index.js")),l=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/index.js")),d=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js"),c=(0,s.observer)(e=>{var t,{icon:i,onClick:s,active:c,label:u="Toggle screenshare",screenReaderText:p,classes:h={root:{},icon:{}}}=e,m=r.__rest(e,["icon","onClick","active","label","screenReaderText","classes"]);const v=(0,o.useContext)(n.EncoderUiContext);(0,d.useUndefinedStoreError)(null!=(null==v?void 0:v.mediaStreamController),"<ScreenCaptureButton/>");const g=s||(0,d.useUIEventError)(null==v?void 0:v.handleScreenCapture,"<ScreenCaptureButton/>"),f=null!=c?c:"screencapture"===(null===(t=null==v?void 0:v.mediaStreamController)||void 0===t?void 0:t.videoDeviceId),b=o.default.createElement(l.default,{iconName:"screencapture",classes:null==h?void 0:h.icon});return(null==v?void 0:v.screenShareSupported)?o.default.createElement(a.default,Object.assign({active:f,"data-selenium":"screencapture-toggle-button",icon:i||b,label:u,onClick:g,activeClass:"video-button--active lv-button--active",inactiveClass:null,classes:h},m),null!=p?p:`Click to ${c?"Unshare":"Share"} Screen`):null});t.default=e=>{var{icon:t,label:i="Toggle screenshare",screenReaderText:s,classes:n}=e,u=r.__rest(e,["icon","label","screenReaderText","classes"]);const p=t||o.default.createElement(l.default,{iconName:"screencapture",classes:null==n?void 0:n.icon});return o.default.createElement(d.ErrorBoundary,{render:()=>o.default.createElement(a.default,Object.assign({"data-selenium":"screencapture-toggle-button",disabled:!0,icon:p,label:i,classes:n,onClick:void 0,active:!1},u),null!=s?s:"Click to Share Screen")},o.default.createElement(c,Object.assign({icon:t,label:i,screenReaderText:s,classes:n},u)))}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Encoder/SendCallRequest/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/mobx-react-lite/es/index.js"),o=r.__importStar(i("webpack/sharing/consume/default/react/react")),n=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Buttons/Text/index.js")),l=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js"),d=(0,s.observer)(e=>{var{buttonRequestText:t,isFirstAttempt:i,classes:s,hideOnAcceptedCall:d=!1,label:c="Request call button",onRequestButtonClick:u}=e,p=r.__rest(e,["buttonRequestText","isFirstAttempt","classes","hideOnAcceptedCall","label","onRequestButtonClick"]);const{store:h,sendCallRequest:m,cancelCallRequest:v}=(0,o.useContext)(n.EncoderUiContext),g=u||(0,l.useUIEventError)("<SendCallRequestButton/>");if(d&&(null==h?void 0:h.callAccepted))return null;const f=null==h?void 0:h.requestingCall;let b;b=f?"Cancel":i?null!=t?t:"Send video call request":"Try again";const _=!h||h&&!h.cameraOn&&!h.micOn||(null==h?void 0:h.disconnectingCall);return o.default.createElement(a.default,Object.assign({active:f,classNames:"video-button--send-call-request lv-button--send-call-request","data-selenium":"video-button--send-call-request-button",disabled:_,label:c,onClick:g},p),b)});t.default=e=>{var{active:t,classes:i,buttonRequestText:s="Send video call request",label:n="Request call button"}=e,c=r.__rest(e,["active","classes","buttonRequestText","label"]);return o.default.createElement(l.ErrorBoundary,{render:()=>o.default.createElement(a.default,Object.assign({classNames:"video-button--send-call-request lv-button--send-call-request",classes:i,"data-selenium":"video-button--send-call-request-button",disabled:!0,label:n,onClick:void 0},c),s)},o.default.createElement(d,Object.assign({classes:i,buttonRequestText:s,label:n,active:t},c)))}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Encoder/Settings/Settings.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/mobx-react-lite/es/index.js"),o=r.__importStar(i("webpack/sharing/consume/default/react/react")),n=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Buttons/Icon/index.js")),l=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/index.js")),d=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js"),c=(0,s.observer)(e=>{var t,{active:i,icon:s,label:c="Options",onClick:u,screenReaderText:p,classes:h={root:{},icon:{}}}=e,m=r.__rest(e,["active","icon","label","onClick","screenReaderText","classes"]);const v=(0,o.useContext)(n.EncoderUiContext);(0,d.useUndefinedStoreError)(null!=(null==v?void 0:v.viewSettings),"<EncoderSettingsButton/>");const g=u||(0,d.useUIEventError)(()=>{v.viewSettings=!v.viewSettings},"<EncoderSettingsButton/>"),f=null!==(t=null!=i?i:v.viewSettings)&&void 0!==t&&t,b=o.default.createElement(l.default,{iconName:"settings",classes:null==h?void 0:h.icon});return o.default.createElement(a.default,Object.assign({"data-selenium":"settings-button",active:f,activeClass:null,inactiveClass:null,icon:s||b,label:c,onClick:g,classes:h},m),null!=p?p:`Click to ${f?"Hide":"Show"} Settings`)});t.default=e=>{var{icon:t,classes:i,label:s="Options",screenReaderText:n,style:u={}}=e,p=r.__rest(e,["icon","classes","label","screenReaderText","style"]);const h=t||o.default.createElement(l.default,{iconName:"settings",classes:null==i?void 0:i.icon});return o.default.createElement(d.ErrorBoundary,{render:()=>o.default.createElement(a.default,Object.assign({"data-selenium":"settings-button",disabled:!0,icon:h,label:s,classes:i,onClick:void 0,active:!1},p),null!=n?n:"Click to Show Settings")},o.default.createElement(c,Object.assign({icon:t,label:s,screenReaderText:n,classes:i},p)))}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Encoder/TestMic/TestMic.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/mobx-react-lite/es/index.js"),o=r.__importStar(i("webpack/sharing/consume/default/react/react")),n=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Buttons/Text/index.js")),l=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js"),d=(0,s.observer)(e=>{var{active:t,children:i,classes:s,label:d="Test Sound",onClick:c}=e,u=r.__rest(e,["active","children","classes","label","onClick"]);const p=(0,o.useContext)(n.EncoderUiContext);(0,l.useUndefinedStoreError)(null!=(null==p?void 0:p.mediaStreamController)&&null!=p.videoElement,"<TestMicButton/>");const h=c||(0,l.useUIEventError)(()=>{p.testMic=!p.testMic},"<TestMicButton/>");return o.default.createElement(a.default,Object.assign({classNames:"video-button--get-sound lv-button--get-sound","data-selenium":"test-mic-button",label:d,classes:s,onClick:h},u),null!=i?i:p.testMic?"Click to End Microphone Test":"Click to Test Microphone")});t.default=e=>{var{label:t="Test Sounds",buttonText:i,classes:s}=e,n=r.__rest(e,["label","buttonText","classes"]);return o.default.createElement(l.ErrorBoundary,{render:()=>o.default.createElement(a.default,Object.assign({classNames:"video-button--get-sound lv-button--get-sound","data-selenium":"test-mic-button",onClick:void 0,disabled:!0,label:t},n),null!=i?i:"Microphone Test Unavailable")},o.default.createElement(d,Object.assign({label:t,classes:s},n)))}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Player/Audio/Audio.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/mobx-react-lite/es/index.js"),o=r.__importStar(i("webpack/sharing/consume/default/react/react")),n=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Buttons/Icon/index.js")),l=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Player/index.js")),d=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js"),c=(0,s.observer)(e=>{var t,{active:i=!1,icon:s,onClick:c,screenReaderText:u,classes:p={root:{},icon:{}},label:h="Toggle mute"}=e,m=r.__rest(e,["active","icon","onClick","screenReaderText","classes","label"]);const v=(0,o.useContext)(n.PlayerUiContext);(0,d.useUndefinedStoreError)(null!=(null==v?void 0:v.player),"<AudioButton/>");const g=null!=c?c:(0,d.useUIEventError)(()=>{v.player.localAudioMuted=!v.player.localAudioMuted},"<AudioButton/>"),f=null!==(t=i&&!v.player.localAudioMuted)&&void 0!==t&&t,b=v.player.localAudioMuted?o.default.createElement(l.default,{title:h,iconName:"soundoff",classes:null==p?void 0:p.icon}):o.default.createElement(l.default,{title:h,iconName:"sound",classes:null==p?void 0:p.icon});return o.default.createElement(a.default,Object.assign({classes:p,active:f,inactiveClass:null,label:h,"data-selenium":"audio-stream-button",icon:s||b,onClick:g},m),null!=u?u:`Click to ${i?"Stop":"Start"} Audio Stream`)});t.default=e=>{var{icon:t,classes:i,label:s="Toggle mute",screenReaderText:n,style:u={},ref:p}=e,h=r.__rest(e,["icon","classes","label","screenReaderText","style","ref"]);const m=t||o.default.createElement(l.default,{iconName:"sound",classes:null==i?void 0:i.icon});return o.default.createElement(d.ErrorBoundary,{render:()=>o.default.createElement(a.default,Object.assign({classes:i,"data-selenium":"audio-stream-button",disabled:!0,icon:m,label:s,onClick:void 0,active:!1},h),null!=n?n:"Click to Start Audio Stream")},o.default.createElement(c,Object.assign({ref:p,icon:t,label:s,screenReaderText:n,classes:i},h)))}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Player/Bitrate/Bitrate.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/mobx/dist/mobx.esm.js"),o=i("./node_modules/mobx-react-lite/es/index.js"),n=r.__importStar(i("webpack/sharing/consume/default/react/react")),a=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),l=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Buttons/Icon/index.js")),d=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Player/index.js")),c=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js"),u=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Inputs/Player/LowLatencyToggle.js")),p=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Inputs/Player/QualitySelect.js")),h=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Tooltip/Tooltip.js")),m=(0,o.observer)(e=>{var{active:t,classNames:i,label:o="Quality",icon:m,screenReaderText:v,classes:g={root:{},icon:{}},disableToggle:f,disableSelect:b,showBitrate:_}=e,y=r.__rest(e,["active","classNames","label","icon","screenReaderText","classes","disableToggle","disableSelect","showBitrate"]);const w=(0,n.useContext)(a.PlayerUiContext),[S,E]=(0,n.useState)(!1),C=n.default.createElement(d.default,{iconName:"settings",classes:null==g?void 0:g.icon});(0,c.useUndefinedStoreError)(null!=(null==w?void 0:w.player),"<BitrateButton/>"),(0,n.useEffect)(()=>(0,s.reaction)(()=>w.showToolbar,,[w]);return n.default.createElement("div",null,n.default.createElement(h.default,{active:S},n.default.createElement(p.default,{disableSelect:b,showBitrate:_}),n.default.createElement(u.default,{disabledOff:f})),n.default.createElement(l.default,Object.assign({active:S,inactiveClass:null,"data-selenium":"settings-button",icon:m||C,onClick:()=>{E(!S)},classes:g,label:o},y),null!=v?v:`Click to ${t?"Hide":"Show"} Settings`))});t.default=e=>{var{classes:t,icon:i,label:s="Quality",screenReaderText:o,active:a,disableToggle:u,disableSelect:p,showBitrate:h}=e,v=r.__rest(e,["classes","icon","label","screenReaderText","active","disableToggle","disableSelect","showBitrate"]);const g=null!=i?i:n.default.createElement(d.default,{iconName:"settings",classes:null==t?void 0:t.icon});return n.default.createElement(c.ErrorBoundary,{render:()=>n.default.createElement(l.default,Object.assign({classes:t,"data-selenium":"bitrate-button",disabled:!0,icon:g,label:s,onClick:void 0,active:!1},v),null!=o?o:"Click to Show Settings")},n.default.createElement(m,Object.assign({"data-selenium":"bitrate-button",icon:i,label:s,screenReaderText:o,classes:t,active:a,showBitrate:h,disableSelect:p,disableToggle:u},v)))}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Player/GetSound/GetSound.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/@video/video-client-core/index.js"),o=i("./node_modules/mobx-react-lite/es/index.js"),n=r.__importStar(i("webpack/sharing/consume/default/react/react")),a=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),l=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Buttons/Icon/index.js")),d=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Player/index.js")),c=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js"),u=(0,o.observer)(e=>{var{active:t=!1,icon:i,label:o="Get sound",onClick:u,screenReaderText:p,classes:h={root:{},icon:{}}}=e,m=r.__rest(e,["active","icon","label","onClick","screenReaderText","classes"]);const v=(0,n.useContext)(a.PlayerUiContext);(0,c.useUndefinedStoreError)(null!=(null==v?void 0:v.player),"<GetSoundButton/>");const g=null!=u?u:(0,c.useUIEventError)("<GetSoundButton/>"),f=t?n.default.createElement(d.default,{iconName:"sound",classes:null==h?void 0:h.icon}):n.default.createElement(d.default,{iconName:"soundoff",classes:null==h?void 0:h.icon});return v.player.isImplements(s.player.Feature.MUTED_AUTOPLAY)&&v.player.forcedMute&&v.player.localAudioMuted?n.default.createElement(l.default,Object.assign({classes:h,"data-selenium":"audio-stream-button",classNames:"video-button--get-sound lv-button--get-sound",icon:i||f,label:o,active:null!=t&&t,onClick:g},m),null!=p?p:`Click to ${t?"Stop":"Start"} Audio Stream`):null});t.default=e=>{var{icon:t,label:i="Get sound",screenReaderText:s,active:o,classes:a}=e,p=r.__rest(e,["icon","label","screenReaderText","active","classes"]);const h=null!=t?t:n.default.createElement(d.default,{iconName:"soundoff",classes:null==a?void 0:a.icon});return n.default.createElement(c.ErrorBoundary,{render:()=>n.default.createElement(l.default,Object.assign({classes:a,"data-selenium":"audio-stream-button",disabled:!0,icon:h,label:i,onClick:void 0,active:!1},p),null!=s?s:"Click to Start Audio Stream")},n.default.createElement(u,Object.assign({icon:t,label:i,screenReaderText:s,classes:a,active:o},p)))}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Player/NewWindow/NewWindow.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/mobx-react-lite/es/index.js"),o=r.__importStar(i("webpack/sharing/consume/default/react/react")),n=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Buttons/Icon/index.js")),l=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Player/index.js")),d=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js"),c=(0,s.observer)(e=>{var{active:t=!1,icon:i,classes:s={root:{},icon:{}},label:c="Open in a new window Button",onClick:u,screenReaderText:p}=e,h=r.__rest(e,["active","icon","classes","label","onClick","screenReaderText"]);const m=(0,o.useContext)(n.PlayerUiContext);(0,d.useUndefinedStoreError)(null!=(null==m?void 0:m.newWindow),"<NewWindowButton/>");const v=null!=u?u:(0,d.useUIEventError)(()=>{},"<NewWindowButton/>"),g=o.default.createElement(l.default,{iconName:"launchopen",classes:null==s?void 0:s.icon});return o.default.createElement(a.default,Object.assign({active:t,"data-selenium":"new-window-button",icon:null!=i?i:g,label:c,classes:s,onClick:v},h),null!=p?p:`Click to ${t?"Collapse from ":"Expand to "}  Fullscreen`)});t.default=e=>{var{icon:t,label:i="Open in a new window Button",screenReaderText:s,classes:n,active:u}=e,p=r.__rest(e,["icon","label","screenReaderText","classes","active"]);const h=t||o.default.createElement(l.default,{iconName:"launchopen",classes:null==n?void 0:n.icon});return o.default.createElement(d.ErrorBoundary,{render:()=>o.default.createElement(a.default,Object.assign({classes:n,"data-selenium":"new-window-button",disabled:!0,icon:h,label:i,onClick:void 0,active:!1},p),null!=s?s:"Click to Expand to Fullscreen")},o.default.createElement(c,Object.assign({icon:t,label:i,screenReaderText:s,classes:n,active:u},p)))}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Player/Play/Play.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/mobx-react-lite/es/index.js"),o=r.__importStar(i("webpack/sharing/consume/default/react/react")),n=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Buttons/Icon/index.js")),l=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Player/index.js")),d=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js"),c=(0,s.observer)(e=>{var{active:t,classes:i={root:{},icon:{}},onClick:s,icon:c,label:u="Play Pause Toggle Button",screenReaderText:p}=e,h=r.__rest(e,["active","classes","onClick","icon","label","screenReaderText"]);const m=(0,o.useContext)(n.PlayerUiContext);(0,d.useUndefinedStoreError)(null!=(null==m?void 0:m.player),"<PlayButton/>");const v=null!=s?s:(0,d.useUIEventError)(()=>{m.player.localVideoPaused=!m.player.localVideoPaused},"<PlayButton/>"),g=null!=t?t:!m.player.localVideoPaused,f=g?o.default.createElement(l.default,{iconName:"pause",classes:null==i?void 0:i.icon}):o.default.createElement(l.default,{iconName:"play",classes:null==i?void 0:i.icon});return o.default.createElement(a.default,Object.assign({classes:i,active:g,inactiveClass:null,label:u,icon:null!=c?c:f,onClick:v,"data-selenium":"play-pause-button"},h),null!=p?p:`Click to ${g?"Pause":"Play"} Stream`)});t.default=e=>{var{icon:t,label:i="Play Pause Toggle Button",screenReaderText:s,classes:n,active:u}=e,p=r.__rest(e,["icon","label","screenReaderText","classes","active"]);const h=t||o.default.createElement(l.default,{iconName:"play",classes:null==n?void 0:n.icon});return o.default.createElement(d.ErrorBoundary,{render:()=>o.default.createElement(a.default,Object.assign({classes:n,"data-selenium":"play-pause-button",disabled:!0,icon:h,label:i,onClick:void 0,active:!1},p),null!=s?s:"Click to Play Stream")},o.default.createElement(c,Object.assign({icon:t,label:i,screenReaderText:s,classes:n,active:u},p)))}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Recorder/Delete/Delete.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react")),o=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Buttons/Icon/index.js")),n=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/index.js"));t.default=function(e){var{active:t,classes:i={root:{},icon:{}},label:a="Delete Recording Button",icon:l}=e,d=r.__rest(e,["active","classes","label","icon"]);const c=s.default.createElement(n.default,{iconName:"recorderdelete",classes:null==i?void 0:i.icon});return s.default.createElement(o.default,Object.assign({active:t,classes:i,label:a,icon:l||c,onClick:d.onClick,"data-selenium":"delete-recording-button"},d),"Delete Recording")}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Recorder/Pause/Pause.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react")),o=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Buttons/Icon/index.js")),n=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/index.js"));t.default=function(e){var{active:t,classes:i={root:{},icon:{}},label:a="Pause Recording Button",icon:l}=e,d=r.__rest(e,["active","classes","label","icon"]);const c=s.default.createElement(n.default,{iconName:"recorderpause",classes:null==i?void 0:i.icon});return s.default.createElement(o.default,Object.assign({active:t,classes:i,label:a,icon:l||c,onClick:d.onClick,"data-selenium":"pause-button"},d),"Click to Pause Recording")}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Recorder/Record/Record.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react")),o=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Buttons/Icon/index.js")),n=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/index.js"));t.default=function(e){var{classes:t={root:{},icon:{}},icon:i,active:a,label:l="Record Button"}=e,d=r.__rest(e,["classes","icon","active","label"]);const c=s.default.createElement(n.default,{iconName:"record",classes:null==t?void 0:t.icon});return s.default.createElement(o.default,Object.assign({active:a,classes:t,label:l,icon:i||c,onClick:d.onClick,"data-selenium":"record-button"},d),"Click to Start Recording")}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Recorder/Save/Save.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react")),o=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Buttons/Icon/index.js")),n=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/index.js"));t.default=function(e){var{active:t,classes:i={root:{},icon:{}},label:a="Save Recording Button",icon:l}=e,d=r.__rest(e,["active","classes","label","icon"]);const c=s.default.createElement(n.default,{iconName:"recordersave",classes:null==i?void 0:i.icon});return s.default.createElement(o.default,Object.assign({active:t,classes:i,label:a,icon:l||c,onClick:d.onClick,"data-selenium":"save-recording-button"},d),"Click to save Recording")}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Recorder/Start/Start.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react")),o=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Buttons/Icon/index.js")),n=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/index.js"));t.default=function(e){var{active:t,classes:i={root:{},icon:{}},label:a="Start Recording Button",icon:l}=e,d=r.__rest(e,["active","classes","label","icon"]);const c=s.default.createElement(n.default,{iconName:"recorderstart",classes:null==i?void 0:i.icon});return s.default.createElement(o.default,Object.assign({active:t,classes:i,label:a,icon:l||c,onClick:d.onClick,"data-selenium":"start-recording-button"},d),"Click to Start Recording")}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Shared/Fullscreen.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/mobx-react-lite/es/index.js"),o=r.__importStar(i("webpack/sharing/consume/default/react/react")),n=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Buttons/Icon/index.js")),l=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Player/index.js")),d=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js"),c=(0,s.observer)(e=>{var t,{active:i,classes:s={root:{},icon:{}},icon:c,label:u="Toggle fullscreen",onClick:p,screenReaderText:h}=e,m=r.__rest(e,["active","classes","icon","label","onClick","screenReaderText"]);const v=null!=(0,o.useContext)(n.EncoderUiContext)?(0,o.useContext)(n.EncoderUiContext):(0,o.useContext)(n.PlayerUiContext);(0,d.useUndefinedStoreError)(null!=(null==v?void 0:v.toggleFullscreen),"<FullscreenButton/>");const g=null!=p?p:(0,d.useUIEventError)(v.toggleFullscreen,"<FullscreenButton/>"),f=null!==(t=null!=i?i:v.isFullscreen)&&void 0!==t&&t,b=f?o.default.createElement(l.default,{iconName:"fullscreenexit",classes:null==s?void 0:s.icon}):o.default.createElement(l.default,{iconName:"fullscreen",classes:null==s?void 0:s.icon});return o.default.createElement(a.default,Object.assign({active:f,inactiveClass:null,classes:s,"data-selenium":"fullscreen-button",icon:c||b,label:u,onClick:g},m),null!=h?h:`Click to ${f?"Collapse from ":"Expand to "}  Fullscreen`)});t.default=e=>{var{classes:t,icon:i,label:s="Toggle fullscreen",screenReaderText:n,style:u={}}=e,p=r.__rest(e,["classes","icon","label","screenReaderText","style"]);const h=null!=i?i:o.default.createElement(l.default,{iconName:"fullscreen",classes:null==t?void 0:t.icon});return o.default.createElement(d.ErrorBoundary,{render:()=>o.default.createElement(a.default,Object.assign({classes:t,"data-selenium":"fullscreen-button",disabled:!0,label:s,icon:h,onClick:void 0,active:!1},p),null!=n?n:"Click to Expand to Fullscreen")},o.default.createElement(c,Object.assign({icon:i,label:s,screenReaderText:n,classes:t},p)))}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Cam2Cam/CallControl.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react")),o=r.__importDefault(i("webpack/sharing/consume/default/react-dom/react-dom")),n=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/CallControl/CallControlUI.js"));t.default=function({attachToRef:e,isCallInProgress:t,renderCustomControls:i,renderCallMetaDisplay:r,classes:a}){return null!=e&&t?o.default.createPortal(s.default.createElement(n.default,{classes:a,renderCustomControls:i,renderCallMetaDisplay:r}),e):null}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/DurationLabel/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/mobx-react-lite/es/index.js"),o=r.__importDefault(i("webpack/sharing/consume/default/react/react")),n=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/DurationLabel/index.js")),a=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js"),l=(0,s.observer)(e=>{r.__rest(e,[]);return o.default.createElement(o.default.Fragment,null)});t.default=e=>{var t=r.__rest(e,[]);return o.default.createElement(a.ErrorBoundary,{render:()=>o.default.createElement(n.default,Object.assign({},t),"Duration Unavailable")},o.default.createElement(l,Object.assign({},t)))}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Inputs/Encoder/AspectRatioSelect.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/mobx-react-lite/es/index.js"),o=r.__importStar(i("webpack/sharing/consume/default/react/react")),n=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),a=i("./node_modules/@video/video-client-web/lib/ui/styling/index.js"),l=i("./node_modules/@video/video-client-web/lib/ui/styling/utils.js"),d=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Inputs/Select.js")),c=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js");var u;!u||(u={}));function p(e){if(null==e)return null;const t=Array.isArray(e)?e[0]:e;for(const e of Object.keys(u)){if(Math.abs(u[e]-t)<.001)return e}return null}const h=(0,s.observer)(e=>{var t,{classes:i={}}=e;r.__rest(e,["classes"]);const s=Object.keys(u),h=(0,a.useStyles)({source:i,target:{}},"select"),m=(0,l.mergeStylesObjects)(i,{}),v=(0,o.useContext)(n.EncoderUiContext);(0,c.useUndefinedStoreError)(null!=(null==v?void 0:v.mediaStreamController),"<AspectRatioSelect/>");const g=(0,c.useUIEventError)(e=>{const t=u[e.target.value];if(null==t)throw new Error("<AspectRatioSelect/>: Invalid aspect ratio: "+e.target.value);v.mediaStreamController.aspectRatio=t},"<AspectRatioSelect/>");return o.default.createElement(d.default,{classes:m,label:"Aspect Ratio: "+p(v.mediaStreamController.aspectRatio),onChange:g,value:null!==(t=p(v.mediaStreamController.aspectRatio))&&void 0!==t?t:void 0},o.default.createElement("option",{disabled:!0,value:""},"Select an aspect ratio"),s.map(e=>o.default.createElement("option",{key:e,value:e,className:h.options},e)))});t.default=e=>{var{classes:t={}}=e,i=r.__rest(e,["classes"]);const s=(0,a.useStyles)({source:t,target:{}},"select"),n=(0,l.mergeStylesObjects)(t,{});return o.default.createElement(c.ErrorBoundary,{render:()=>{var e;return o.default.createElement(d.default,Object.assign({},i,{value:"",classes:n,disabled:!0}),o.default.createElement("option",{value:"",className:null==s?void 0:s.options},null!==(e=i.fallbackText)&&void 0!==e?e:"Aspect Ratio Unavailable"))}},o.default.createElement(h,Object.assign({classes:t},i)))}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Inputs/Encoder/AudioDeviceSelect.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/@video/video-client-core/index.js"),o=i("./node_modules/mobx-react-lite/es/index.js"),n=r.__importStar(i("webpack/sharing/consume/default/react/react")),a=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),l=i("./node_modules/@video/video-client-web/lib/ui/styling/index.js"),d=i("./node_modules/@video/video-client-web/lib/ui/styling/utils.js"),c=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Inputs/Select.js")),u=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js"),p=(0,o.observer)(e=>{var t,{classes:i={}}=e,o=r.__rest(e,["classes"]);const{label:p}=o,h=(0,n.useContext)(a.EncoderUiContext);(0,u.useUndefinedStoreError)(null!=(null==h?void 0:h.mediaStreamController),"<AudioDeviceSelect/>");const m=(0,l.useStyles)({source:i,target:{}},"select"),v=(0,d.mergeStylesObjects)(i,{}),g=(0,u.useUIEventError)("<AudioDeviceSelect/>");return n.default.createElement(c.default,Object.assign({classes:v,onChange:g,value:null!==(t=h.mediaStreamController.audioDeviceId)&&void 0!==t?t:"",label:null!=p?p:"Mic"},o),n.default.createElement("option",{disabled:!0,value:"",className:m.options},"Select a microphone"),s.mediaController.audioDevices().map((e,t)=>{var i;return n.default.createElement("option",{key:e.deviceId,value:e.deviceId,className:null==m?void 0:m.options},null!==(i=e.label)&&void 0!==i?i:"Microphone "+(t+1))}))});t.default=e=>{var{classes:t={}}=e,i=r.__rest(e,["classes"]);const s=(0,l.useStyles)({source:t,target:{}},"select"),o=(0,d.mergeStylesObjects)(t,{});return n.default.createElement(u.ErrorBoundary,{render:()=>{var e;return n.default.createElement(c.default,Object.assign({},i,{value:"",classes:o,disabled:!0,label:"Audio Device: Unavailable"}),n.default.createElement("option",{value:"",className:null==s?void 0:s.options},null!==(e=i.fallbackText)&&void 0!==e?e:"Audio Devices Unavailable"))}},n.default.createElement(p,Object.assign({classes:t},i)))}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Inputs/Encoder/EchoCancellationCheckbox.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/mobx-react-lite/es/index.js"),o=r.__importStar(i("webpack/sharing/consume/default/react/react")),n=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Inputs/Checkbox.js")),l=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js"),d=(0,s.observer)(e=>{var{classes:t}=e,i=r.__rest(e,["classes"]);const s=(0,o.useContext)(n.EncoderUiContext);(0,l.useUndefinedStoreError)(null!=(null==s?void 0:s.mediaStreamController),"<EchoCancellationCheckbox/>");const d=(0,l.useUIEventError)(()=>{s.mediaStreamController.echoCancellation=!s.mediaStreamController.echoCancellation},"<EchoCancellationCheckbox/>");return o.default.createElement(a.default,Object.assign({},i,{classes:null==t?void 0:t.echoCancellationCheckbox,label:"Echo Cancellation",disabled:!s.mediaStreamController.supportsEchoCancellation(),checked:!0===s.mediaStreamController.echoCancellation,onChange:d,title:s.mediaStreamController.supportsEchoCancellation()?void 0:"Your browser does not support echo cancellation"}))});t.default=e=>{var{classes:t}=e,i=r.__rest(e,["classes"]);return o.default.createElement(l.ErrorBoundary,{render:()=>o.default.createElement(a.default,Object.assign({},i,{disabled:!0,classes:null==t?void 0:t.echoCancellationCheckbox,label:"Echo Cancellation Unavailable"}))},o.default.createElement(d,Object.assign({classes:t},i)))}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Inputs/Encoder/NoiseSuppressionCheckbox.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/mobx-react-lite/es/index.js"),o=r.__importStar(i("webpack/sharing/consume/default/react/react")),n=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Inputs/Checkbox.js")),l=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js"),d=(0,s.observer)(e=>{var{classes:t}=e,i=r.__rest(e,["classes"]);const s=(0,o.useContext)(n.EncoderUiContext);(0,l.useUndefinedStoreError)(null!=(null==s?void 0:s.mediaStreamController),"<NoiseSuppressionCheckbox/>");const d=(0,l.useUIEventError)("<NoiseSuppressionCheckbox/>");return o.default.createElement(a.default,Object.assign({},i,{classes:null==t?void 0:t.noiseSuppressionCheckbox,label:"Noise Suppression",disabled:!s.mediaStreamController.supportsNoiseSuppression(),checked:!0===s.mediaStreamController.noiseSuppression,onChange:d,title:s.mediaStreamController.supportsNoiseSuppression()?void 0:"Your browser does not support noise suppression"}))});t.default=e=>{var{classes:t}=e,i=r.__rest(e,["classes"]);return o.default.createElement(l.ErrorBoundary,{render:()=>o.default.createElement(a.default,Object.assign({},i,{classes:null==t?void 0:t.noiseSuppressionCheckbox,disabled:!0,label:"Noise Suppression Unavailable"}))},o.default.createElement(d,Object.assign({classes:t},i)))}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Inputs/Encoder/ResolutionSelect.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/mobx-react-lite/es/index.js"),o=r.__importStar(i("webpack/sharing/consume/default/react/react")),n=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),a=i("./node_modules/@video/video-client-web/lib/ui/styling/index.js"),l=i("./node_modules/@video/video-client-web/lib/ui/styling/utils.js"),d=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Inputs/Select.js")),c=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js");function u(e){var t,i;if(null!=(null===(i=null===(t=e.settings)||void 0===t?void 0:t.video)||void 0===i?void 0:i.height))return e.settings.video.height;const r=e.resolution;return null==r?null:Array.isArray(r)?r[0]:"number"==typeof r?r:r.ideal}const p=(0,s.observer)(e=>{var t,i,{classes:s={},maxResolutionHeight:p}=e,h=r.__rest(e,["classes","maxResolutionHeight"]);const m=(0,o.useContext)(n.EncoderUiContext);(0,c.useUndefinedStoreError)(null!=(null==m?void 0:m.mediaStreamController),"<ResolutionSelect/>");const v=m.mediaStreamController.availableResolutions.filter(,g=(0,a.useStyles)({source:s,target:{}},"select"),f=(0,l.mergeStylesObjects)(s,{}),b=(0,c.useUIEventError)("<ResolutionSelect/>");return o.default.createElement(d.default,Object.assign({},h,{classes:f,label:"Quality",onChange:b,value:null!==(i=null===(t=u(m.mediaStreamController))||void 0===t?void 0:t.toString())&&void 0!==i?i:void 0}),o.default.createElement("option",{disabled:!0,value:"",className:g.options},"Select a Resolution"),v.map(e=>o.default.createElement("option",{key:e,value:e,className:g.options},e+"p")))});t.default=e=>{var{classes:t={},maxResolutionHeight:i}=e,s=r.__rest(e,["classes","maxResolutionHeight"]);const n=(0,a.useStyles)({source:t,target:{}},"select"),u=(0,l.mergeStylesObjects)(t,{});return o.default.createElement(c.ErrorBoundary,{render:()=>{var e;return o.default.createElement(d.default,Object.assign({},s,{value:"",disabled:!0,classes:u,label:"Resolution: Unavailable"}),o.default.createElement("option",{value:"",className:null==n?void 0:n.options},null!==(e=s.fallbackText)&&void 0!==e?e:" Resolution Unavailable"))}},o.default.createElement(p,Object.assign({maxResolutionHeight:i,classes:t},s)))}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Inputs/Encoder/VideoDeviceSelect.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/@video/video-client-core/index.js"),o=i("./node_modules/mobx-react-lite/es/index.js"),n=r.__importStar(i("webpack/sharing/consume/default/react/react")),a=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),l=i("./node_modules/@video/video-client-web/lib/ui/styling/index.js"),d=i("./node_modules/@video/video-client-web/lib/ui/styling/utils.js"),c=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Inputs/Select.js")),u=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js"),p=(0,o.observer)(e=>{var t,{classes:i={}}=e,o=r.__rest(e,["classes"]);const{label:p}=o,h=(0,l.useStyles)({source:i,target:{}},"select"),m=(0,d.mergeStylesObjects)(i,{}),v=(0,n.useContext)(a.EncoderUiContext);(0,u.useUndefinedStoreError)(null!=(null==v?void 0:v.mediaStreamController),"<VideoDeviceSelect/>");const g=(0,n.createRef)(),f=(0,u.useUIEventError)("<VideoDeviceSelect/>");return n.default.createElement(c.default,Object.assign({classes:m,ref:g,onChange:f,value:null!==(t=v.mediaStreamController.videoDeviceId)&&void 0!==t?t:"",label:null!=p?p:"Camera"},o),n.default.createElement("option",{disabled:!0,value:""},"Select a camera"),s.mediaController.videoDevices().map((e,t)=>{var i;return n.default.createElement("option",{key:e.deviceId,value:e.deviceId,className:h.options},null!==(i=e.label)&&void 0!==i?i:"Camera "+(t+1))}),";")});t.default=function(e){var{classes:t={}}=e,i=r.__rest(e,["classes"]);const s=(0,l.useStyles)({source:t,target:{}},"select"),o=(0,d.mergeStylesObjects)(t,{});return n.default.createElement(u.ErrorBoundary,{render:()=>{var e;return n.default.createElement(c.default,Object.assign({},i,{disabled:!0,classes:o,label:"Video device unavailable"}),n.default.createElement("option",{value:"",className:null==s?void 0:s.options},null!==(e=i.fallbackText)&&void 0!==e?e:"Video Devices Unavailable"))}},n.default.createElement(p,Object.assign({classes:t},i)))}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Inputs/Player/LowLatencyToggle.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/mobx-react-lite/es/index.js"),o=i("./node_modules/@video/video-client-core/index.js"),n=r.__importStar(i("webpack/sharing/consume/default/react/react")),a=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),l=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Inputs/PillToggle.js")),d=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js"),c=(0,s.observer)(e=>{var t,{classes:i={},disableToggle:s,active:c}=e,u=r.__rest(e,["classes","disableToggle","active"]);const p=(0,n.useContext)(a.PlayerUiContext);(0,d.useUndefinedStoreError)(null!=(null==p?void 0:p.player),"<LowLatencyToggle/>");return p.player.isImplements(o.player.Feature.PLAYER_SELECTOR)&&(null===(t=p.player)||void 0===t?void 0:t.supportsLowLatency)?n.default.createElement(l.default,Object.assign({isActive:p.player.lowLatency,label:"Low-latency:",handleClick:()=>{p.player.isImplements(o.player.Feature.PLAYER_SELECTOR)&&(p.player.lowLatency=!p.player.lowLatency)}},u)):null});t.default=function(e){var{classes:t}=e,i=r.__rest(e,["classes"]);return n.default.createElement(d.ErrorBoundary,{render:()=>n.default.createElement(l.default,Object.assign({isActive:!1,disabled:!0},i))},n.default.createElement(c,Object.assign({},i)))}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Inputs/Player/QualitySelect.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/@video/video-client-core/index.js"),o=i("./node_modules/mobx-react-lite/es/index.js"),n=r.__importStar(i("webpack/sharing/consume/default/react/react")),a=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),l=i("./node_modules/@video/video-client-web/lib/ui/styling/videoStyles.js"),d=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Inputs/SelectNonNative.js")),c=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js"),u=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Inputs/Player/styles.js")),p=(0,o.observer)(e=>{var t,{classes:i={},disableSelect:o,showBitrate:p}=e,h=r.__rest(e,["classes","disableSelect","showBitrate"]);const m=(0,n.useContext)(a.PlayerUiContext),v=(0,l.useStyles)({source:i,target:u.default},"quality-select");function g(e){var t;return!!(null==m?void 0:m.player.isImplements(s.player.Feature.BITRATE_SWITCHING))&&e===(null===(t=m.player.currentQuality)||void 0===t?void 0:t.level)}function f(e){(null==m?void 0:m.player.isImplements(s.player.Feature.BITRATE_SWITCHING))&&(m.player.preferredLevel=e)}return(0,c.useUndefinedStoreError)(null!=(null==m?void 0:m.player),"<QualitySelect/>"),(null===(t=null==m?void 0:m.player)||void 0===t?void 0:t.isImplements(s.player.Feature.BITRATE_SWITCHING))?n.default.createElement(d.default,Object.assign({},h,{className:v.root}),m.availableBitrates.map(e=>{return n.default.createElement("div",{role:"button",tabIndex:0,onKeyDown:t=>"Enter"===t.key&&void 0!==e.score&&f(e.score),key:e.score,id:e.score,onClick:className:g(e.score)?v.activeOption:v.option},n.default.createElement("label",{htmlFor:"layer.score"},e.name," ",(t=e.formattedBitrate,p&&null!=t&&""!==t?t:"")));var t})):null});t.default=function(e){var{classes:t}=e,i=r.__rest(e,["classes"]);const s=(0,l.useStyles)({source:null!=t?t:{},target:u.default},"select");return n.default.createElement(c.ErrorBoundary,{render:()=>n.default.createElement(d.default,Object.assign({},i,{className:s.root}),n.default.createElement("div",{key:"",id:"disabled-select",className:s.disabledOption},"Qualities Unavailable"))},n.default.createElement(p,Object.assign({},i)))}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Inputs/Player/QualitySettings.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/mobx-react-lite/es/index.js"),o=r.__importDefault(i("webpack/sharing/consume/default/react/react")),n=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Inputs/Player/LowLatencyToggle.js")),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Inputs/Player/QualitySelect.js")),l=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Tooltip/Tooltip.js")),d=(0,s.observer)(e=>{var{classes:t={},disableToggle:i,disableSelect:s,showBitrate:d,active:c}=e;r.__rest(e,["classes","disableToggle","disableSelect","showBitrate","active"]);return o.default.createElement(l.default,{active:c},o.default.createElement(a.default,{disableSelect:s,showBitrate:d}),o.default.createElement(n.default,{disabledOff:i}))});t.default=d},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Inputs/Player/VolumeRange.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/mobx-react-lite/es/index.js"),o=r.__importStar(i("webpack/sharing/consume/default/react/react")),n=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Inputs/Range.js")),l=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js"),d=(0,s.observer)(e=>{var t,{classes:i}=e,s=r.__rest(e,["classes"]);const d=(0,o.useContext)(n.PlayerUiContext);(0,l.useUndefinedStoreError)(null!=(null==d?void 0:d.player),"<VolumeRange/>");const c=(0,l.useUIEventError)(e=>{d.player.localAudioMuted=!1,d.player.localAudioVolume=Number(e.currentTarget.value)},"<VolumeRange/>");return(null==d?void 0:d.volumeRangeSupported)?o.default.createElement(a.default,Object.assign({},s,{classes:i,onInput:c,onChange:c,value:null!==(t=d.player.localAudioVolume)&&void 0!==t?t:.5})):null});t.default=e=>{var{classes:t}=e,i=r.__rest(e,["classes"]);return o.default.createElement(l.ErrorBoundary,{render:()=>o.default.createElement(a.default,Object.assign({classes:t},i,{disabled:!0}))},o.default.createElement(d,Object.assign({classes:t},i)))}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Inputs/Player/styles.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={wrapper:{position:"absolute",bottom:50},root:{position:"relative",overflow:"auto","@media only screen and (max-width: 1000px)":{maxHeight:112}},option:{width:120,background:"#111111",fontSize:12,color:"#eeeeee",fontFamily:"sans-serif",padding:5,paddingLeft:10,paddingRight:10,display:"flex",cursor:"pointer",transition:"all 0.3s ease-in-out","&:hover":{color:"#111111",background:"#eeeeee"}},activeOption:{background:"#eeeeee",fontSize:12,color:"#111111",fontFamily:"sans-serif",padding:5,paddingLeft:10,paddingRight:10,display:"flex",cursor:"pointer"},disabledOption:{cursor:"not-allowed",background:"#313131",fontSize:12,color:"#a0a0a0",fontFamily:"sans-serif",padding:5,paddingLeft:10,paddingRight:10,display:"flex"}}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/MediaContainer/MediaContainer.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/mobx-react-lite/es/index.js"),o=r.__importStar(i("webpack/sharing/consume/default/react/react")),n=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/MediaWrapper/index.js")),l=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js"),d=(0,s.observer)(e=>{var{children:t,classes:i}=e,s=r.__rest(e,["children","classes"]);const d=null!=(0,o.useContext)(n.EncoderUiContext)?(0,o.useContext)(n.EncoderUiContext):(0,o.useContext)(n.PlayerUiContext);(0,l.useUndefinedStoreError)(null!=d,"<MediaContainer/>");return o.default.createElement(a.default,Object.assign({ref:d.videoWrapperElement,classes:i,isFullscreen:d.isFullscreen},s),t)});t.default=e=>{var{classes:t}=e,i=r.__rest(e,["classes"]);return o.default.createElement(l.ErrorBoundary,{render:()=>o.default.createElement(a.default,Object.assign({classes:t},i))},o.default.createElement(d,Object.assign({classes:t},i)))}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Multistream/MultistreamCarousel.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/mobx-react-lite/es/index.js"),o=r.__importStar(i("webpack/sharing/consume/default/react/react")),n=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Carousel/index.js")),l=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js"),d=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Multistream/MultistreamCarouselSlide.js")),c=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Hooks/useMediaQuery.js")),u=(0,s.observer)(({itemsPerSlide:e=6})=>{const t=(0,c.default)("screen and (max-width: 1023px)"),i=(0,c.default)("screen and (max-width: 768px)"),r=(0,o.useContext)(n.MultistreamContext);(0,l.useUndefinedStoreError)(null!=r,"<MultistreamCarousel/>");const{isInitialLoadDone:s,publicKeys:u}=r;return o.default.createElement("div",null,s&&o.default.createElement(a.default,{itemsPerSlide:t?e/2:e,gap:10,vertical:!i},u.map(e=>o.default.createElement(d.default,{key:e,publicKey:e,isMobile:i}))))});t.default=u},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Multistream/MultistreamCarouselSlide.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importStar(i("webpack/sharing/consume/default/react/react")),o=i("./node_modules/mobx-react-lite/es/index.js"),n=i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Multistream/styles.js"),a=i("./node_modules/@video/video-client-web/lib/ui/styling/index.js"),l=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Close.js")),d=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),c=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js"),u=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Eye.js")),p=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Camera.js")),h=(0,o.observer)(({publicKey:e,classes:t,isMobile:i})=>{var r,o,h;const[m,v]=(0,s.useState)(!1),g=(0,a.useStyles)({target:null!=t?t:{},source:n.carouselSlideStyles},"multistream-carousel-slide"),f=(0,s.useContext)(d.MultistreamContext);(0,c.useUndefinedStoreError)(null!=f,"<MultistreamCarouselSlide/>");const{activePublicKeys:b,startPlayer:_,streams:y}=f,w=null===(r=y[e])||void 0===r?void 0:r.posterUrl,S=null===(o=y[e])||void 0===o?void 0:o.disconnected,E=null===(h=y[e])||void 0===h?void 0:h.viewCount,C=b.includes(e);if((0,s.useEffect)(()=>{let e=null;return m&&(e=setInterval(()=>{const t=new Image;t.onload=()=>{v(!1),document.body.removeChild(t),null!=e&&clearInterval(e)},t.src=null!=w?w:"",t.style.display="none",document.body.appendChild(t)},2e3)),,[m,w]),S)return s.default.createElement("div",{className:g.disconnectedWrapper},s.default.createElement("h2",{className:g.disconnected},"OFFLINE"));const j=null!=w&&!m;return s.default.createElement("div",{className:j?g.root:g.disconnectedWrapper,onClick:onKeyDown:t=>"Enter"===t.key&&i&&_(e),tabIndex:0,role:"button",style:{cursor:i?"pointer":"default"}},!0==!C&&s.default.createElement("button",{type:"button",onClick:()=>_(e),className:g.addButton},s.default.createElement(l.default,{weight:"normal",style:{width:"15px",transform:"rotateZ(45deg)",marginLeft:"3px"}})),j?s.default.createElement("img",{className:g.image,src:w,alt:"video-poster",onError:()=>v(!0)}):s.default.createElement("div",{className:g.stockImageWrapper},s.default.createElement(p.default,{style:{width:"30%"},outline:!0})),C&&s.default.createElement("div",{className:g.playingOverlay}),null!=E&&E>0&&s.default.createElement("div",{className:g.viewCount},s.default.createElement(u.default,{style:{width:"15px",marginRight:"3px",height:"11px"}}),s.default.createElement("span",null,E)))});t.default=h},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Multistream/MultistreamPlayer.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importStar(i("webpack/sharing/consume/default/react/react")),o=i("./node_modules/mobx-react-lite/es/index.js"),n=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/MediaContainer/MediaContainer.js")),l=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Videos/PlayerVideo.js")),d=i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/index.js"),c=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/ControlBar/index.js")),u=i("./node_modules/@video/video-client-web/lib/ui/styling/index.js"),p=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Close.js")),h=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js"),m=i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Multistream/styles.js"),v=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Eye.js")),g=(0,o.observer)(({classes:e,publicKey:t,useDefaultStyles:i=!0,reRender:r})=>{var o;const g=(0,u.useStyles)({target:null!=e?e:{},source:m.playerStyles},"multistream"),f=(0,s.useContext)(n.MultistreamContext);(0,h.useUndefinedStoreError)(null!=f,"<MultistreamPlayer/>");const{playersWrapperElement:b,activePublicKeys:_,stopPlayer:y,streams:w}=f,S=w[t],{offsetHeight:E,offsetWidth:C}=null!==(o=b.current)&&void 0!==o?o:{offsetHeight:0,offsetWidth:0},j=(0,s.useMemo)(()=>(0,m.getVideoElementStyles)({containerHeight:E,containerWidth:C,playersCount:_.length}),[_.length,E,C]),P=null==S?void 0:S.viewCount;return s.default.createElement(a.default,{classes:i?{root:Object.assign(Object.assign({},j.root),null==e?void 0:e.root)}:e},1!==_.length&&s.default.createElement("button",{type:"button",onClick:className:g.closeButton},s.default.createElement(p.default,{weight:"normal",style:{width:"15px",marginLeft:"3px"}})),s.default.createElement(l.default,{pillarBox:!1}),s.default.createElement(c.default,{variant:"player",classes:{root:{bottom:"0 !important"},controls:{backgroundImage:"transparent",justifyContent:"flex-start"}}},s.default.createElement(d.PlayerPlayButton,null),s.default.createElement(d.PlayerAudioButton,null)),null!=P&&P>0&&s.default.createElement("div",{className:g.viewCount},s.default.createElement(v.default,{style:{width:"15px",marginRight:"3px",height:"11px"}}),s.default.createElement("span",null,P)))});t.default=g},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Multistream/MultistreamPlayersGrid.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/mobx-react-lite/es/index.js"),o=r.__importStar(i("webpack/sharing/consume/default/react/react")),n=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),a=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),l=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js"),d=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Multistream/MultistreamPlayer.js")),c=i("./node_modules/@video/video-client-web/lib/ui/styling/index.js"),u=i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Multistream/styles.js"),p=i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Hooks/useRefDimensions.js"),h=(0,s.observer)(({classes:e})=>{const t=(0,c.useStyles)({target:null!=e?e:{},source:u.playersWrapperStyles},"multistream-players-grid"),i=(0,o.useContext)(a.MultistreamContext),[r,s]=(0,o.useState)(!1);(0,l.useUndefinedStoreError)(null!=i,"<MultistreamPlayersGrid/>");const{width:h,height:m}=(0,p.useRefDimensions)(i.playersWrapperElement);(0,o.useEffect)(()=>{const e=return n.device.addEventListener("resize",e),e(),,[h,m]);const{playersWrapperElement:v,activePublicKeys:g,streams:f}=i;return o.default.createElement("div",{ref:v,className:t.root},g.map(e=>{var t;return o.default.createElement(a.PlayerUiContext.Provider,{key:e,value:null===(t=f[e])||void 0===t?void 0:t.playerUi},o.default.createElement(d.default,{publicKey:e,reRender:r}))}))});t.default=h},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Multistream/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MultistreamCarousel=t.MultistreamPlayersGrid=t.MultistreamCarouselSlide=t.MultistreamPlayer=void 0;const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Multistream/MultistreamPlayer.js"));t.MultistreamPlayer=s.default;const o=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Multistream/MultistreamCarouselSlide.js"));t.MultistreamCarouselSlide=o.default;const n=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Multistream/MultistreamPlayersGrid.js"));t.MultistreamPlayersGrid=n.default;const a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Multistream/MultistreamCarousel.js"));t.MultistreamCarousel=a.default},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Multistream/styles.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVideoElementStyles=t.carouselSlideStyles=t.playersWrapperStyles=t.playerStyles=t.VIDEO_SPACING=void 0;const i={position:"absolute",top:0,right:0,width:"1.5rem",height:"1.5rem",color:"#fff",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"rgba(220, 175, 15, 0.7)",borderBottomLeftRadius:"15px",border:"1px solid #fff",paddingBottom:"0.15rem",zIndex:1},r={position:"absolute",padding:"0.2rem 0.8rem",color:"#fff",display:"flex",gap:"0.7rem",justifyContent:"space-between",alignItems:"center",background:"rgba(29, 29, 29, 0.4)",backdropFilter:"blur(3.40008px)",border:"1px solid #fff",borderRadius:"1.36px"};t.VIDEO_SPACING=16,t.playerStyles={root:{},closeButton:i,viewCount:Object.assign(Object.assign({},r),{bottom:11,right:10})},t.playersWrapperStyles={root:{display:"flex",justifyContent:"center",alignItems:"center",flexWrap:"wrap",gap:t.VIDEO_SPACING+"px","@media only screen and (min-width: 769px)":{width:"100%",height:"inherit"},"@media only screen and (max-width: 770px)":{width:"inherit",height:"100%"}}},t.carouselSlideStyles={root:{height:"inherit",width:"100%",position:"relative"},disconnectedWrapper:{height:"inherit",width:"100%",position:"relative",background:"rgba(29, 29, 29, 0.4)",backdropFilter:"blur(3.40008px)"},addButton:i,image:{height:"inherit",width:"100%",objectFit:"cover"},playingOverlay:{position:"absolute",top:0,left:0,height:"inherit",width:"100%",border:"solid 3px #E5B711"},disconnected:{display:"flex",justifyContent:"center",alignItems:"center",height:"inherit",width:"100%",color:"#fff"},stockImageWrapper:{height:"inherit",width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},viewCount:Object.assign(Object.assign({},r),{bottom:5,right:5})};t.getVideoElementStyles=({containerHeight:e,containerWidth:i,playersCount:r})=>{if(0===e||0===i)return{root:{width:"100%",height:"100%"}};if(1===r)return{root:{width:"100%",height:e+"px","@media only screen and (max-width: 768px)":{width:"100%",height:"auto"}}};return{root:{width:(i-t.VIDEO_SPACING-2)/2+"px",height:(e-t.VIDEO_SPACING-2)/2+"px","@media only screen and (max-width: 768px)":{width:"100%",height:"auto"}}}}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/PlayerOverlayButton/PlayerOverlayButton.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/mobx-react-lite/es/index.js"),o=r.__importStar(i("webpack/sharing/consume/default/react/react")),n=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/PlayerOverlayButton/index.js")),l=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js"),d=(0,s.observer)(e=>{var{children:t,onClick:i}=e,s=r.__rest(e,["children","onClick"]);const d=(0,o.useContext)(n.PlayerUiContext);(0,l.useUndefinedStoreError)(null!=(null==d?void 0:d.player),"<PlayerOverlayButton/>");const c=(0,l.useUIEventError)(null!=i?i:()=>{d.logger.info("PlayerOverlayButton clicked"),d.player.localVideoPaused=!1},"<PlayerOverlayButton/>");if(!d.player.localVideoPaused)return null;return o.default.createElement(a.default,Object.assign({onMouseEnter:()=>{d.mobileDevice||(d.videoMouseOver=!0)},onMouseLeave:,s,{onClick:c}),t)});t.default=e=>{var t=r.__rest(e,[]);return o.default.createElement(l.ErrorBoundary,{render:()=>o.default.createElement(a.default,Object.assign({},t,{disabled:!0}))},o.default.createElement(d,Object.assign({},t)))}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Recorder/Recorder.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/@video/video-client-core/index.js"),o=i("./node_modules/mobx/dist/mobx.esm.js"),n=i("./node_modules/mobx-react-lite/es/index.js"),a=r.__importStar(i("webpack/sharing/consume/default/react/react")),l=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),d=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),c=i("./node_modules/@video/video-client-web/lib/ui/styling/index.js"),u=i("./node_modules/@video/video-client-web/lib/ui/styling/utils.js"),p=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js"),h=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Recorder/Delete/Delete.js")),m=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Recorder/Pause/Pause.js")),v=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Recorder/Record/Record.js")),g=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Recorder/Save/Save.js")),f=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Recorder/Start/Start.js")),b=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Recorder/styles.js")),_=(0,n.observer)(({stream:e,classes:t={root:{},recordButton:{},pauseButton:{},startButton:{},deleteButton:{},saveButton:{}},recordButtonIcon:i,startButtonIcon:r,pauseButtonIcon:n,deleteButtonIcon:p,saveButtonIcon:_,startRecordingWhenClicked:y,frameRate:w,audioBitsPerSecond:S,videoBitsPerSecond:E,displaySurface:C,cursor:j,mimetype:P,height:R,width:x})=>{const D=(0,a.useContext)(d.RecorderUiContext),T=(0,c.useStyles)({source:t,target:b.default},"recorder"),I=(0,u.mergeStylesObjects)(t,b.default),O={startRecordingWhenClicked:y,audioBitsPerSecond:S,videoBitsPerSecond:E,frameRate:w,displaySurface:C,cursor:j,mimetype:P,height:R,width:x};return null!=P&&""!==P||(s.adapter.device.isImplements(l.Feature.BROWSER_TYPE)&&"safari"===s.adapter.device.browserInfo.name?O.mimetype="video/mp4;codecs=avc1":s.adapter.device.isIosDevice?O.mimetype="video/mp4":O.mimetype="video/webm;codecs=VP8"),(0,a.useEffect)(()=>{(0,o.autorun)(()=>{if(null==(null==D?void 0:D.recorder)){const t=new s.RecorderCore(null!=e?e:null,O);t.on("browser-stop",()=>{(null==D?void 0:D.recordingReady)&&(null==D||D.saveRecording()),null==D||D.browserStopEvent()}),t.on("save-canceled",()=>{null==D||D.setRecordingReady()}),null==D||D.setRecorder(t)}})}),(0,a.useEffect)(()=>{(0,o.autorun)(()=>{if(null!=(null==D?void 0:D.recorder)&&null!=e){null==D||D.closeRecording();const t=new s.RecorderCore(e,O);t.on("browser-stop",()=>{(null==D?void 0:D.recordingReady)&&(null==D||D.saveRecording()),null==D||D.browserStopEvent()}),t.on("save-canceled",,null==D||D.setRecorder(t)}})},[y,S,E,C,j,D,e,O]),a.default.createElement("div",{className:T.root},(!(null==D?void 0:D.recording)&&!(null==D?void 0:D.recordingReady)||(null==D?void 0:D.recording)&&!(null==D?void 0:D.recordingReady))&&a.default.createElement(v.default,{classes:I.recordButton,icon:i,onClick:),(null==D?void 0:D.recordingReady)&&a.default.createElement(h.default,{classes:I.deleteButton,icon:p,onClick:null==D?void 0:D.closeRecording}),(null==D?void 0:D.recordingReady)&&!(null==D?void 0:D.recording)&&a.default.createElement(f.default,{icon:r,classes:I.startButton,onClick:null==D?void 0:D.record,disabled:null==D?void 0:D.resumeDisabled}),(null==D?void 0:D.recordingReady)&&(null==D?void 0:D.recording)&&a.default.createElement(m.default,{classes:I.pauseButton,icon:n,onClick:null==D?void 0:D.pauseRecording}),(null==D?void 0:D.recordingReady)&&a.default.createElement(g.default,{classes:I.saveButton,icon:_,onClick:null==D?void 0:D.saveRecording}))});t.default=function(e){return a.default.createElement(p.ErrorBoundary,{render:()=>a.default.createElement("div",{style:{height:"600px",width:"100%"}},a.default.createElement("p",null,"Recorder is not working"))},a.default.createElement(_,Object.assign({},e)))}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Recorder/styles.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={root:{display:"flex"},recordButton:{root:{margin:5,color:"#e45b59 !important"}},pauseButton:{root:{margin:5,color:"#007fff !important"}},startButton:{root:{margin:5,color:"#007fff !important"}},saveButton:{root:{margin:5,color:"#007fff !important"}},deleteButton:{root:{margin:5,color:"#e45b59 !important"}}}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/SlideSidebar/CallRequestSidebar.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importStar(i("webpack/sharing/consume/default/react/react")),o=r.__importDefault(i("webpack/sharing/consume/default/react-dom/react-dom")),n=i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/index.js"),a=i("./node_modules/@video/video-client-web/lib/ui/styling/index.js"),l=i("./node_modules/@video/video-client-web/lib/ui/styling/utils.js"),d=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Buttons/Close/index.js")),c=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/SlidingShelf/index.js")),u=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Encoder/SendCallRequest/index.js")),p=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/SlideSidebar/callRequestSidebarStyles.js"));t.default=e=>{var{attachToRef:t,classes:i={},ref:h,children:m,open:v=!1,renderTitle:g,title:f,onRequestButtonClick:b,buttonRequestText:_,onCloseButtonClick:y,renderButton:w}=e,S=r.__rest(e,["attachToRef","classes","ref","children","open","renderTitle","title","onRequestButtonClick","buttonRequestText","onCloseButtonClick","renderButton"]);if(!t)return console.warn("VideoCallSidebar was not provided the attachToRef prop. This is used to attach to a DOM element and display the sidebar."),null;const[E,C]=(0,s.useState)(v);(0,s.useEffect)(()=>{C(},[v]);const j=(0,a.useStyles)({source:i,target:p.default},"callRequestSidebar"),P=(0,l.mergeStylesObjects)(i,{}),R=return o.default.createPortal(s.default.createElement(c.default,{classes:null==i?void 0:i.slideSidebar,open:E},s.default.createElement("div",{className:j.headerContainer},s.default.createElement(d.default,{onClick:R,open:E,classes:P.closeButton}),g?g(S):s.default.createElement("span",{className:j.renderTitleSpan},f)),s.default.createElement("div",{className:j.callRequestContainer},s.default.createElement("div",{className:j.encoderContainer},s.default.createElement(n.EncoderVideo,{classes:P.videoWrapper})),s.default.createElement("div",{className:j.deviceSelectContainer},s.default.createElement("p",{className:j.settingsText},"Settings"),s.default.createElement(n.EncoderVideoDeviceSelect,{ariaLabel:"Video device select",classes:P.videoDeviceSelect}),s.default.createElement(n.EncoderAudioDeviceSelect,{ariaLabel:"Audio device select",classes:P.audioDeviceSelect})),w?w(S):s.default.createElement("div",{className:j.buttonContainer},s.default.createElement(u.default,{ref:h,buttonRequestText:null!=_?_:void 0,onRequestButtonClick:b,active:!1,disabled:!1,isFirstAttempt:!0})))),t)}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/SlideSidebar/SettingsSidebar.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StatelessSettingsSidebar=void 0;const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/mobx-react-lite/es/index.js"),o=r.__importStar(i("webpack/sharing/consume/default/react/react")),n=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/SlidingShelf/index.js"));t.StatelessSettingsSidebar=a.default;const l=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js"),d=(0,s.observer)(e=>{var{children:t,open:i,onCloseButtonClick:s}=e,d=r.__rest(e,["children","open","onCloseButtonClick"]);const c=null!=(0,o.useContext)(n.EncoderUiContext)?(0,o.useContext)(n.EncoderUiContext):(0,o.useContext)(n.PlayerUiContext);(0,l.useUndefinedStoreError)(null!=c,"<SettingsSidebar/>");const u=(0,l.useUIEventError)(()=>{c.viewSettings=!c.viewSettings},"<SettingsSidebar/>");return o.default.createElement(a.default,Object.assign({},d,{open:null!=i?i:c.viewSettings,onCloseButtonClick:null!=s?s:u}),t)});t.default=e=>{var{children:t}=e,i=r.__rest(e,["children"]);return o.default.createElement(l.ErrorBoundary,{render:()=>o.default.createElement(a.default,Object.assign({},i))},o.default.createElement(d,Object.assign({},i),t))}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/SlideSidebar/VideoCall.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/mobx-react-lite/es/index.js"),o=r.__importStar(i("webpack/sharing/consume/default/react/react")),n=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/SlidingShelf/index.js")),l=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js"),d=(0,s.observer)(e=>{var{children:t,onCloseButtonClick:i,open:s}=e,d=r.__rest(e,["children","onCloseButtonClick","open"]);const c=(0,o.useContext)(n.EncoderUiContext);(0,l.useUndefinedStoreError)(null!=c,"<VideoSidebar/>");const u=(0,l.useUIEventError)("<VideoSidebar/>");return o.default.createElement(a.default,Object.assign({},d,{onCloseButtonClick:null!=i?i:u,open:null!=s?s:null==c?void 0:c.viewVideoCallSlider,variant:"dark"}),t)});t.default=e=>{var{children:t}=e,i=r.__rest(e,["children"]);return o.default.createElement(l.ErrorBoundary,{render:()=>o.default.createElement(a.default,Object.assign({},i))},o.default.createElement(d,Object.assign({},i),t))}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/SlideSidebar/callRequestSidebarStyles.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={buttonContainer:{},callRequestContainer:{display:"flex",flexDirection:"column",justifyContent:"space-evenly",height:"100%"},deviceSelectContainer:{display:"flex",flexDirection:"column",justifyContent:"space-between",width:"12rem"},encoderContainer:{},headerContainer:{alignItems:"center",display:"flex",height:"2rem",width:"100%"},renderTitleSpan:{color:"#000",fontFamily:"sans-serif",marginLeft:"0.2rem"},settingsText:{fontFamily:"sans-serif"}}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Videos/EncoderVideo.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/mobx-react-lite/es/index.js"),o=r.__importStar(i("webpack/sharing/consume/default/react/react")),n=i("./node_modules/@video/video-client-web/lib/store/encoder/silence-background.js"),a=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),l=i("./node_modules/@video/video-client-web/lib/ui/styling/index.js"),d=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/PlayerOverlayButton/index.js")),c=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/VideoWrapper/index.js")),u=i("./node_modules/@video/video-client-web/lib/ui/ui-lib/VideoWrapper/styles.js"),p=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js"),h=i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Videos/TempVideo.js"),m=(0,s.observer)(e=>{var t,{classes:i,backgroundAudio:s}=e,d=r.__rest(e,["classes","backgroundAudio"]);const m=(0,o.useContext)(a.EncoderUiContext);(0,p.useUndefinedStoreError)(null!=(null==m?void 0:m.videoElement),"<EncoderVideo/>");const v=(0,u.videoWrapperStyles)(null!==(t=d.pillarBox)&&void 0!==t&&t,d.isFullScreen,d.mirror,d.elementBlur,d.blurPixels),g=(0,l.useStyles)({source:null!=i?i:{},target:v},"videoWrapper"),f=s&&!m.testMic?(0,n.withSilenceBackground)(m.audioCtx,m.mediaStreamController.source):m.mediaStreamController.source;return o.default.createElement(c.default,Object.assign({classes:i,isFullScreen:m.isFullscreen,ref:m.videoWrapperElement},d),o.default.createElement(h.TempVideo,{muted:!m.testMic,ref:m.videoElement,playsInline:!0,source:f,className:g.videoElement}))});t.default=e=>{var t,{classes:i}=e,s=r.__rest(e,["classes"]);const n=(0,u.videoWrapperStyles)(null!==(t=s.pillarBox)&&void 0!==t&&t,s.isFullScreen,s.mirror,s.elementBlur,s.blurPixels),a=(0,l.useStyles)({source:null!=i?i:{},target:n},"videoWrapper");return o.default.createElement(p.ErrorBoundary,{render:()=>o.default.createElement(c.default,Object.assign({classes:i},s),o.default.createElement("div",{className:a.videoElement,style:{display:"inline-block",aspectRatio:"16/9"}},o.default.createElement("p",null,"Video is not working"),o.default.createElement(d.default,Object.assign({classes:null==i?void 0:i.playerOverlayButton},s,{disabled:!0}))))},o.default.createElement(m,Object.assign({classes:i},s)))}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Videos/PlayerVideo.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/@video/video-client-core/index.js"),o=i("./node_modules/mobx-react-lite/es/index.js"),n=r.__importStar(i("webpack/sharing/consume/default/react/react")),a=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),l=i("./node_modules/@video/video-client-web/lib/ui/styling/index.js"),d=i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Hooks/useRefDimensions.js"),c=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/VideoWrapper/index.js")),u=i("./node_modules/@video/video-client-web/lib/ui/ui-lib/VideoWrapper/styles.js"),p=i("./node_modules/@video/video-client-web/lib/ui/components/ErrorBoundary/index.js"),h=i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Videos/Video.js"),m=(0,o.observer)(e=>{var t,{classes:i,adaptiveBlur:o,adaptiveBlurValues:m,elementBlur:v,blurPixels:g}=e,f=r.__rest(e,["classes","adaptiveBlur","adaptiveBlurValues","elementBlur","blurPixels"]);const b=(0,n.useContext)(a.PlayerUiContext);(0,p.useUndefinedStoreError)(null!=(null==b?void 0:b.videoElement),"<PlayerVideo/>");const _=o||v||b.player.isImplements(s.player.Feature.BITRATE_SWITCHING)&&b.player.blurred,{width:y}=(0,d.useRefDimensions)(null==b?void 0:b.videoElement);g=o?(e=>{var t,i;const r=null!==(t=null==m?void 0:m.min)&&void 0!==t?t:9;return((null!==(i=null==m?void 0:m.max)&&void 0!==i?i:15)-r)*(e-360)/1560+r})(y):g;const w=(0,u.videoWrapperStyles)(null!==(t=f.pillarBox)&&void 0!==t&&t,f.isFullScreen,f.mirror,_,g),S=(0,l.useStyles)({source:null!=i?i:{},target:w},"videoWrapper");return n.default.createElement(c.default,Object.assign({isFullScreen:null==b?void 0:b.isFullscreen,classes:i,ref:b.videoWrapperElement,elementBlur:_,blurPixels:g},f),n.default.createElement(h.Video,{source:b.player,autoPlay:!1,className:S.videoElement,ref:b.videoElement,id:f.id}))});t.default=e=>{var{classes:t}=e,i=r.__rest(e,["classes"]);return n.default.createElement(p.ErrorBoundary,{render:()=>n.default.createElement("div",{style:{height:"600px",width:"100%"}},n.default.createElement("p",null,"Video is not working"))},n.default.createElement(m,Object.assign({classes:t},i)))}},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Videos/TempVideo.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TempVideo=void 0;const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importStar(i("webpack/sharing/consume/default/react/react"));t.TempVideo=(0,s.forwardRef)((e,t)=>{const i=(0,s.useRef)(null),{source:o}=e,n=r.__rest(e,["source"]);return(0,s.useImperativeHandle)(t,()=>i.current),(0,s.useEffect)(()=>{const e=i.current;null!=e&&null!=o&&e.srcObject!==o&&(o instanceof MediaStream?(e.srcObject=o,e.play().catch(e=>{})):o.attachTo(e))},[o]),(0,s.useEffect)(()=>{null!=i.current&&(o instanceof MediaStream||(null==o?void 0:o.localVideoPaused)||i.current.paused&&!i.current.ended&&i.current.play())}),s.default.createElement("video",Object.assign({},n,{ref:i}))})},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Videos/Video.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Video=void 0;const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importStar(i("webpack/sharing/consume/default/react/react"));t.Video=(0,s.forwardRef)((e,t)=>{const i=(0,s.useRef)(null),{source:o}=e,n=r.__rest(e,["source"]);return(0,s.useImperativeHandle)(t,,(0,s.useEffect)(()=>{const e=i.current;null!=e&&null!=o&&e.srcObject!==o&&(o instanceof MediaStream?(e.srcObject=o,e.play().catch():o.attachTo(e))},[o]),s.default.createElement("video",Object.assign({},n,{ref:i}))})},"./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MultistreamCarousel=t.MultistreamPlayersGrid=t.MultistreamPlayer=t.MultistreamCarouselSlide=t.StatelessSettingsSidebar=t.PeerMutedBadge=t.PlayerVideo=t.EncoderVideo=t.VideoCall=t.SettingsSidebar=t.MediaContainer=t.Checkbox=t.PlayerVolumeRange=t.ErrorAlert=t.EncoderVideoDeviceSelect=t.EncoderResolutionSelect=t.EncoderNoiseSuppressionCheckbox=t.EncoderEchoCancellationCheckbox=t.EncoderAudioDeviceSelect=t.EncoderAspectRatioSelect=t.DurationLabel=t.ControlBar=t.RecordSaveButton=t.RecordDeleteButton=t.RecordStartButton=t.RecordPauseButton=t.RecordButton=t.Recorder=t.PlayerOverlayButton=t.PlayerQualitySettings=t.PlayerPlayButton=t.PlayerNewWindowButton=t.PlayerGetSoundButton=t.PlayerFullscreenButton=t.PlayerBitrateButton=t.PlayerAudioButton=t.TestMicButton=t.SettingsButton=t.ScreenCaptureButton=t.MicrophoneButton=t.FullscreenButton=t.CameraButton=t.CallRequestSidebar=t.CallControl=t.JoinBroadcastButton=void 0;const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Alerts/ErrorAlert.js"));t.ErrorAlert=s.default;const o=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/ControlBar/index.js"));t.ControlBar=o.default;const n=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Inputs/Checkbox.js"));t.Checkbox=n.default;const a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Badges/PeerMuted.js"));t.PeerMutedBadge=a.default;const l=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Encoder/Camera/Camera.js"));t.CameraButton=l.default;const d=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Encoder/JoinBroadcast/JoinBroadcast.js"));t.JoinBroadcastButton=d.default;const c=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Encoder/Microphone/Microphone.js"));t.MicrophoneButton=c.default;const u=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Encoder/ScreenCapture/ScreenCapture.js"));t.ScreenCaptureButton=u.default;const p=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Encoder/Settings/Settings.js"));t.SettingsButton=p.default;const h=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Encoder/TestMic/TestMic.js"));t.TestMicButton=h.default;const m=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Player/Audio/Audio.js"));t.PlayerAudioButton=m.default;const v=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Player/Bitrate/Bitrate.js"));t.PlayerBitrateButton=v.default;const g=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Player/GetSound/GetSound.js"));t.PlayerGetSoundButton=g.default;const f=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Player/NewWindow/NewWindow.js"));t.PlayerNewWindowButton=f.default;const b=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Player/Play/Play.js"));t.PlayerPlayButton=b.default;const _=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Recorder/Delete/Delete.js"));t.RecordDeleteButton=_.default;const y=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Recorder/Pause/Pause.js"));t.RecordPauseButton=y.default;const w=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Recorder/Record/Record.js"));t.RecordButton=w.default;const S=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Recorder/Save/Save.js"));t.RecordSaveButton=S.default;const E=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Recorder/Start/Start.js"));t.RecordStartButton=E.default;const C=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Buttons/Shared/Fullscreen.js"));Object.defineProperty(t,"FullscreenButton",{enumerable:!0,get:function(){return C.default}}),Object.defineProperty(t,"PlayerFullscreenButton",{enumerable:!0,get:function(){return C.default}});const j=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Cam2Cam/CallControl.js"));t.CallControl=j.default;const P=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/DurationLabel/index.js"));t.DurationLabel=P.default;const R=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Inputs/Encoder/AspectRatioSelect.js"));t.EncoderAspectRatioSelect=R.default;const x=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Inputs/Encoder/AudioDeviceSelect.js"));t.EncoderAudioDeviceSelect=x.default;const D=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Inputs/Encoder/EchoCancellationCheckbox.js"));t.EncoderEchoCancellationCheckbox=D.default;const T=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Inputs/Encoder/NoiseSuppressionCheckbox.js"));t.EncoderNoiseSuppressionCheckbox=T.default;const I=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Inputs/Encoder/ResolutionSelect.js"));t.EncoderResolutionSelect=I.default;const O=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Inputs/Encoder/VideoDeviceSelect.js"));t.EncoderVideoDeviceSelect=O.default;const k=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Inputs/Player/QualitySettings.js"));t.PlayerQualitySettings=k.default;const M=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Inputs/Player/VolumeRange.js"));t.PlayerVolumeRange=M.default;const L=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/MediaContainer/MediaContainer.js"));t.MediaContainer=L.default;const A=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/PlayerOverlayButton/PlayerOverlayButton.js"));t.PlayerOverlayButton=A.default;const N=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Recorder/Recorder.js"));t.Recorder=N.default;const B=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/SlideSidebar/CallRequestSidebar.js"));t.CallRequestSidebar=B.default;const U=r.__importStar(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/SlideSidebar/SettingsSidebar.js"));t.SettingsSidebar=U.default,Object.defineProperty(t,"StatelessSettingsSidebar",{enumerable:!0,get:function(){return U.StatelessSettingsSidebar}});const F=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/SlideSidebar/VideoCall.js"));t.VideoCall=F.default;const V=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Videos/EncoderVideo.js"));t.EncoderVideo=V.default;const H=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Videos/PlayerVideo.js"));t.PlayerVideo=H.default;const q=i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Multistream/index.js");Object.defineProperty(t,"MultistreamCarouselSlide",{enumerable:!0,get:function(){return q.MultistreamCarouselSlide}}),Object.defineProperty(t,"MultistreamPlayer",{enumerable:!0,get:function(){return q.MultistreamPlayer}}),Object.defineProperty(t,"MultistreamPlayersGrid",{enumerable:!0,get:function(){return q.MultistreamPlayersGrid}}),Object.defineProperty(t,"MultistreamCarousel",{enumerable:!0,get:function(){return q.MultistreamCarousel}})},"./node_modules/@video/video-client-web/lib/ui/context/Context.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MultistreamContext=t.VideoClientContext=t.RecorderUiContext=t.PlayerUiContext=t.CallContext=t.EncoderUiContext=void 0;const r=i("webpack/sharing/consume/default/react/react"),s=(0,r.createContext)(null);t.EncoderUiContext=s;const o=(0,r.createContext)(null);t.PlayerUiContext=o;const n=(0,r.createContext)(null);t.RecorderUiContext=n;const a=(0,r.createContext)(null);t.VideoClientContext=a;const l=(0,r.createContext)(null);t.CallContext=l;const d=(0,r.createContext)(null);t.MultistreamContext=d},"./node_modules/@video/video-client-web/lib/ui/context/index.js":"./node_modules/@video/video-client-web/lib/ui/index.js":"./node_modules/@video/video-client-web/lib/ui/styling/index.js":"./node_modules/@video/video-client-web/lib/ui/styling/utils.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergeStylesObjects=void 0;t.mergeStylesObjects=(e,i)=>{const r=Object.assign({},e);return Object.keys(i).forEach(s=>{var o;null==(o=i[s])||"object"!=typeof o||Array.isArray(o)?Object.assign(r,{[s]:i[s]}):s in e?r[s]=(0,t.mergeStylesObjects)(e[s],i[s]):Object.assign(r,{[s]:i[s]})}),r}},"./node_modules/@video/video-client-web/lib/ui/styling/videoStyles.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeStyles=t.mergeStyles=t.useStyles=void 0;const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/jss/dist/jss.esm.js"),o=r.__importDefault(i("./node_modules/jss-plugin-camel-case/dist/jss-plugin-camel-case.esm.js")),n=r.__importDefault(i("./node_modules/jss-plugin-default-unit/dist/jss-plugin-default-unit.esm.js")),a=r.__importDefault(i("./node_modules/jss-plugin-nested/dist/jss-plugin-nested.esm.js")),l=i("webpack/sharing/consume/default/react/react"),d=i("./node_modules/@video/video-client-web/lib/store/utils/index.js"),c=i("./node_modules/@video/video-client-web/lib/ui/styling/utils.js"),u=(0,s.create)({plugins:[(0,o.default)(),(0,a.default)(),(0,n.default)()]});t.useStyles=({target:e,source:t},i)=>{const r=(0,c.mergeStylesObjects)(null!=e?e:{},null!=t?t:{}),s=u.createStyleSheet(r,{classNamePrefix:`${d.videoStylesNamespace}-${i}-`});return(0,l.useLayoutEffect)([s]),Object.keys(s.classes).reduce((e,t)=>Object.assign(Object.assign({},e),{[t]:""+s.classes[t]}),{})},t.mergeStyles=t.useStyles;t.makeStyles=(e,i)=>(0,t.useStyles)({target:e,source:{}},i.classNamePrefix)},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Alerts/AlertBase.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react")),o=i("./node_modules/@video/video-client-web/lib/ui/styling/index.js"),n=i("./node_modules/@video/video-client-web/lib/ui/styling/utils.js"),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Alerts/styles.js")),l=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Buttons/Close/index.js"));t.default=e=>{var{children:t,classes:i={},active:d,setActive:c}=e,u=r.__rest(e,["children","classes","active","setActive"]);const p=(0,o.useStyles)({source:i,target:a.default},"alertBase"),h=(0,n.mergeStylesObjects)(i,a.default);return s.default.createElement("div",Object.assign({className:`${p.root} ${d&&"open"}`},u),s.default.createElement("div",{className:p.inner},t),s.default.createElement(l.default,{onClick:()=>c(!1),open:d,classes:{root:h.closeButton}}))}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Alerts/styles.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={root:{alignItems:"center",backgroundColor:"#F8FA8F",display:"flex",flexWrap:"wrap",justifyContent:"center",margin:"0.5rem auto",width:"100%",position:"absolute",borderRadius:"4px",fontFamily:"sans-serif",fontSize:"1.5rem",overflow:"hidden",transition:"all .5s ease-in-out",height:"0","&.open":{height:"auto",zIndex:"200"}},inner:{padding:"1rem"},closeButton:{width:"10px",position:"absolute",right:"0",top:"0",margin:"10px"}}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Badges/PeerMuted.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react")),o=i("./node_modules/@video/video-client-web/lib/ui/styling/videoStyles.js"),n=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/index.js")),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Badges/styles.js"));function l({classes:e={root:{},icon:{}},muted:t,icon:i=(t?s.default.createElement(n.default,{iconName:"microphoneoff",title:"Muted",classes:e.icon}):s.default.createElement(n.default,{iconName:"microphone",title:"Unmuted",classes:e.icon})),classNames:r,render:l,style:d,color:c,height:u,width:p,activeColor:h}){(null==e?void 0:e.root)&&(e.root["& svg"]={color:t?h:null!=c?c:"",height:null!=u?u:"2rem",width:null!=p?p:"2rem"}),(null==e?void 0:e.root)&&(e.root["&.muted & svg"]={color:h});const m=(0,o.useStyles)({source:e,target:a.default},"peerMutedBadge");return s.default.createElement("span",{className:`${m.root} ${t&&"muted"} ${r}`,style:d},l?l(t):i)}l.defaultProps={color:"black",activeColor:"red"},t.default=l},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Badges/styles.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={root:{alignContent:"center",backgroundColor:"transparent",color:"#f5f5f5",border:"none",cursor:"none",display:"flex",flex:"initial",height:"2rem",justifyContent:"center",marginLeft:".5rem",marginRight:".5rem",padding:"0",position:"absolute",transitionDuration:".15s",transitionProperty:"color, background-color, border",transitionTimingFunction:"linear",width:"2rem"}}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Buttons/Close/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importStar(i("webpack/sharing/consume/default/react/react")),o=i("./node_modules/@video/video-client-web/lib/ui/styling/videoStyles.js"),n=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/index.js")),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Buttons/Close/styles.js"));t.default=e=>{var{onClick:t,active:i=null,classes:l={},icon:d,open:c,iconColor:u,label:p}=e,h=r.__rest(e,["onClick","active","classes","icon","open","iconColor","label"]);const m=(0,o.useStyles)({source:l,target:a.default},"closeButton"),v=d||s.default.createElement(n.default,{iconName:"close",classes:l.icon,style:{height:"16px"}});return(0,s.useEffect)(()=>{const e=e=>{"Escape"===e.key&&!0===c&&null!=t&&t()};return window.addEventListener("keydown",e,!1),,[t,c]),s.default.createElement("button",Object.assign({title:null!=p?p:"close button",className:m.root+" close",onClick:null!=t?t:void 0,"data-selenium":"close-button"},h),v)}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Buttons/Close/styles.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={root:{alignContent:"center",backgroundColor:"#f5f5f5",color:cursor:"pointer",justifyContent:"center",padding:"0",transitionDuration:".15s",transitionProperty:"color, background-color, border",transitionTimingFunction:"linear","&.close":{background:"none",border:"none",display:"inline-block",textDecoration:"none","-webkit-appearance":"none"},"& svg":{width:"15px"}}}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Buttons/Icon/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importStar(i("webpack/sharing/consume/default/react/react")),o=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),n=i("./node_modules/@video/video-client-web/lib/ui/styling/videoStyles.js"),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Buttons/Icon/styles.js")),l=(0,s.forwardRef)((e,t)=>{var i,l,{active:d=!0,children:c,activeClass:u="video-button--on lv-button--on",inactiveClass:p="video-button--off lv-button--off",classes:h={},classNames:m="",disabled:v=!1,icon:g,label:f="Default Button",onClick:b,style:_={}}=e,y=r.__rest(e,["active","children","activeClass","inactiveClass","classes","classNames","disabled","icon","label","onClick","style"]);const w=(0,s.useContext)(o.PlayerUiContext),S=(0,s.useContext)(o.EncoderUiContext);let E;E=S?(0,a.default)(null!==(i=null==S?void 0:S.mobileDevice)&&void 0!==i&&i):(0,a.default)(null!==(l=null==w?void 0:w.mobileDevice)&&void 0!==l&&l);const C=(0,n.useStyles)({source:h,target:E},"videoIconButton");let j;return void 0!==f&&(j=f.replace(/\s+/g,"-").toLowerCase()),s.default.createElement("button",Object.assign({"aria-label":f,className:`${C.root} ${d?null!=u?u:"":null!=p?p:""} ${m&&m}`,"data-selenium":(f&&j)+"-button",disabled:v,onClick:null!=b?b:void 0,ref:t,type:"button",title:f},y),null!=g&&g)});l.displayName="ButtonIcon",t.default=l},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Buttons/Icon/styles.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=e=>({root:{display:"flex!important",justifyContent:"center",alignItems:"center",backgroundColor:"transparent",border:"none",borderRadius:"10rem",color:"#f5f5f5",cursor:"pointer",height:"40px",width:"40px",marginLeft:e?5:"none",marginRight:e?5:"none",outline:"none",transitionDuration:".15s",transitionProperty:"color, background-color, border",transitionTimingFunction:"linear","&:disabled":{color:"#ff6565",opacity:.5,cursor:"not-allowed"},"&.custom":{backgroundColor:"transparent"},"&.video-button--on":{color:"#f5f5f5"},"&.video-button--off":{color:"#ff6565"},"&.video-button--active":{backgroundColor:"#ff6565",color:"#f5f5f5"},"&.video-button--get-sound":{position:"absolute",zIndex:130,left:0},"&.video-push-left":{marginLeft:"auto"},"&.video-push-right":{marginRight:"auto"},"&.lv-button--on":{color:"#f5f5f5"},"&.lv-button--off":{color:"#ff6565"},"&.lv-button--active":{backgroundColor:"#ff6565",color:"#f5f5f5"},"&.lv-button--get-sound":{position:"absolute",zIndex:130,left:0},"&.lv-push-left":{marginLeft:"auto"},"&.lv-push-right":{marginRight:"auto"}}})},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Buttons/Text/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importStar(i("webpack/sharing/consume/default/react/react")),o=i("./node_modules/@video/video-client-web/lib/ui/styling/videoStyles.js"),n=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Buttons/Text/styles.js")),a=(0,s.forwardRef)((e,t)=>{var{active:i,buttonText:a="",children:l,classes:d={},classNames:c="",disabled:u=!1,label:p="Default Button",onClick:h,style:m={}}=e,v=r.__rest(e,["active","buttonText","children","classes","classNames","disabled","label","onClick","style"]);const g=(0,o.useStyles)({source:d,target:n.default},"button-text");let f;return void 0!==p&&(f=p.replace(/\s+/g,"-").toLowerCase()),s.default.createElement("button",Object.assign({title:p,"aria-label":p,className:`${g.root} ${i||""} ${c&&c}`,"data-selenium":(p&&f)+"-button",disabled:u,onClick:h,ref:t,style:m,type:"button"},v),l)});a.displayName="ButtonText",t.default=a},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Buttons/Text/styles.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={root:{border:"none",borderRadius:"30px",backgroundColor:"#4293b6",color:"white",cursor:"pointer",fontSize:"14px",height:"auto",padding:"10px 20px",width:"100%"}}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/CallControl/CallControlUI.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importStar(i("webpack/sharing/consume/default/react/react")),o=i("./node_modules/@video/video-client-web/lib/index.js"),n=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Inputs/Encoder/AudioDeviceSelect.js")),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/components/ModularComponents/Inputs/Encoder/VideoDeviceSelect.js")),l=i("./node_modules/@video/video-client-web/lib/ui/styling/index.js"),d=i("./node_modules/@video/video-client-web/lib/ui/styling/utils.js"),c=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/CallControl/callControlStyles.js"));t.default=function({classes:e={screenCaptureButton:{},settingsButton:{},cameraButton:{},microphoneButton:{}},renderCustomControls:t,renderCallMetaDisplay:i}){const[r,u]=(0,s.useState)(!1),[p,h]=(0,s.useState)(!1),m=(0,d.mergeStylesObjects)(c.default,e),v=(0,l.useStyles)({source:e,target:c.default},"callControlUi");return s.default.createElement("div",{className:v.root,onBlur:()=>{u(!1),h(!1)},onFocus:()=>{u(!0)},onMouseOver:onMouseLeave:,s.default.createElement("div",{className:v.videoContainer,style:{height:r?"100%":void 0}},s.default.createElement(o.EncoderVideo,{classes:m.videoWrapper})),s.default.createElement("div",{className:v.controlsContainer,style:{display:!0===r?"block":"none"}},null==t?void 0:t(),!t&&s.default.createElement("div",{className:v.buttonsContainer},s.default.createElement(o.ScreenCaptureButton,{classes:m.screenCaptureButton}),s.default.createElement(o.SettingsButton,{classes:m.settingsButton,onClick:),s.default.createElement(o.CameraButton,{classes:m.cameraButton}),s.default.createElement(o.MicrophoneButton,{classes:m.microphoneButton})),null==i?void 0:i(),p&&s.default.createElement("div",{className:v.settingsContainer},s.default.createElement(a.default,{classes:m.videoDeviceSelect}),s.default.createElement(n.default,{classes:m.audioDeviceSelect}))))}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/CallControl/callControlStyles.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i={root:{color:"white",height:"32px",width:"32px",display:"inline",marginRight:"0",background:"#357793",backgroundColor:"#357793",border:"none",borderRadius:"5px !important"},svg:{height:"32px",width:"32px"}},r={root:{height:"25%",width:"25%",position:"absolute",top:0,right:0},controlsContainer:{backdropFilter:"blur(10px)",WebkitBackdropFilter:"blur(10px)",boxSizing:"border-box",justifyContent:"space-between",background:"rgba(0, 0, 0, 0.73)",borderBottomLeftRadius:"20px",borderBottomRightRadius:"20px",position:"absolute",top:"110px",left:"5px",maxWidth:"190px",padding:"25px 10px",width:"95%",zIndex:0,transition:"all .225s"},settingsButton:i,cameraButton:i,microphoneButton:i,screenCaptureButton:Object.assign(Object.assign({},i),{svg:{height:"20px",width:"20px",verticalAlign:"sub"}}),audioDeviceSelect:{root:{color:"white",height:"60px"},select:{fontSize:"12px"},label:{fontFamily:"sans-serif"}},videoDeviceSelect:{root:{color:"white",height:"60px"},select:{fontSize:"12px"},label:{fontFamily:"sans-serif"}},settingsContainer:{root:{display:"flex",marginTop:"25%",flexDirection:"column",padding:"0 10px"}},buttonsContainer:{display:"flex",justifyContent:"space-between",marginBottom:"15px"},videoContainer:{width:"100%",borderRadius:"20px",overflow:"hidden",position:"relative",zIndex:2,maxWidth:"190px",left:"5px",top:"3px",transition:"all .225s"}};t.default=r},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Carousel/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importStar(i("webpack/sharing/consume/default/react/react")),o=i("./node_modules/@video/video-client-web/lib/ui/styling/index.js"),n=r.__importStar(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Carousel/styles.js")),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/ChevronDown.js"));t.default=function({classes:e,itemsPerSlide:t=3,gap:i=10,children:r,vertical:l=!0}){const d=(0,o.useStyles)({target:null!=e?e:{},source:n.default},"carousel"),c=(0,s.useRef)(null),[u,p]=(0,s.useState)(0),[h,m]=(0,s.useState)(0),[v,g]=(0,s.useState)(!0),f=r.length-t<0?0:r.length-t,b=f===u,_=0===u,y=r.length>t;f<u&&p(f);const w=(0,s.useCallback)(()=>{if(!c.current)return;const e=c.current.offsetHeight,r=c.current.offsetWidth;if(l){if(0===e)return void console.error("Carousel component must be placed inside a fixed height container.");m((e-i*(t-1))/t)}else{if(0===r)return void console.error("Carousel component must be placed inside a fixed width container.");m((r-i*(t-1))/t)}},[i,t,l]);return(0,s.useEffect)(()=>{if(!c.current)return()=>{};w();const e=new ResizeObserver(w);return e.observe(c.current),,[w]),(0,s.useEffect)([h]),s.default.createElement("div",{className:d.root,style:(0,n.getRootStyles)(l)},s.default.createElement("button",{type:"button",className:d.carouselButton,onClick:()=>{p(e=>{const t=e-1;return t<0?e:t})},style:(0,n.getButtonStyles)(l,_,y)},s.default.createElement(a.default,{style:(0,n.getChevronStyles)(l,y,"up")})),s.default.createElement("div",{ref:c,className:d.slidesWrapper},s.default.createElement("div",{className:d.carouselSlidesWrapper,style:(0,n.getCarouselSlidesWrapperStyles)(l,i)},s.Children.map(r,(e,t)=>s.default.createElement("div",{className:d.carouselItem,style:(0,n.getCarouselSlideStyles)({carouselDrivingDimension:h,currentIndex:u,isVertical:l,gap:i,isLoading:v})},e)))),s.default.createElement("button",{type:"button",className:d.carouselButton,onClick:()=>{p(e=>{const i=e+1;return i>r.length-t?e:i})},style:(0,n.getButtonStyles)(l,b,y)},s.default.createElement(a.default,{style:(0,n.getChevronStyles)(l,y,"down")})))}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Carousel/styles.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCarouselSlideStyles=t.getCarouselSlidesWrapperStyles=t.getChevronStyles=t.getButtonStyles=t.getRootStyles=void 0;t.getRootStyles=e=>Object.assign(Object.assign({},e&&{gridTemplateRows:"auto 1fr auto"}),!e&&{gridTemplateColumns:"auto 1fr auto"});t.getButtonStyles=(e,t,i)=>Object.assign(Object.assign(Object.assign({},t&&{backgroundColor:"rgba(0,0,0, 0.6)",pointerEvents:"none",color:"#aeafaf"}),!e&&{height:"100%",width:"1.5rem"}),!i&&{height:"0px",width:"0px"});t.getChevronStyles=(e,t,i)=>Object.assign(Object.assign(Object.assign(Object.assign({},e&&"up"===i&&{transform:"rotateZ(180deg)"}),!e&&"up"===i&&{transform:"rotateZ(90deg)"}),!e&&"down"===i&&{transform:"rotateZ(-90deg)"}),!t&&{display:"none"});t.getCarouselSlidesWrapperStyles=(e,t)=>Object.assign(Object.assign({gap:t+"px"},e&&{width:"100%",flexDirection:"column"}),!e&&{height:"100%",flexDirection:"row"});t.getCarouselSlideStyles=({isVertical:e,isLoading:t,carouselDrivingDimension:i,gap:r,currentIndex:s})=>Object.assign(Object.assign(Object.assign({position:"relative"},!t&&{transition:"0.5s ease-in-out"}),e&&{transform:`translate3d(0px, -${s*i+r*s}px, 0px)`,height:i+"px"}),!e&&{transform:`translate3d(-${s*i+r*s}px, 0px, 0px)`,width:i+"px",height:"100%"}),t.default={root:{display:"grid",height:"100%"},slidesWrapper:{position:"relative",overflow:"hidden",width:"100%"},carouselSlidesWrapper:{position:"absolute",top:0,left:0,display:"flex"},carouselItem:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%"},carouselButton:{zIndex:10,width:"100%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(0,0,0, 0.3)",color:"#fff",backdropFilter:"blur(15px)",height:"1.5rem"}}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/ControlBar/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=i("./node_modules/mobx-react-lite/es/index.js"),o=r.__importStar(i("webpack/sharing/consume/default/react/react")),n=i("./node_modules/@video/video-client-web/lib/ui/context/Context.js"),a=i("./node_modules/@video/video-client-web/lib/ui/styling/videoStyles.js"),l=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/ControlBar/styles.js")),d=(0,s.observer)(e=>{var{children:t,classes:i={},variant:s}=e;r.__rest(e,["children","classes","variant"]);const d=null!=(0,o.useContext)(n.EncoderUiContext)?(0,o.useContext)(n.EncoderUiContext):(0,o.useContext)(n.PlayerUiContext),c=(0,a.useStyles)({source:i,target:l.default},"controlBar"),u={player:c["controls--player"],encoder:c["controls--encoder"],mini:c["controls--mini"]},p=()=>{d&&!d.mobileDevice&&(d.controlMouseOver=!0)},h=return o.default.createElement("div",{onMouseOver:p,onFocus:p,onBlur:h,onMouseLeave:h,style:{bottom:(null==d?void 0:d.videoMouseOver)||(null==d?void 0:d.controlMouseOver)?0:-75},className:`${c.root} ${u[s]}`},o.default.createElement("div",{className:c.controls},t))});t.default=d},"./node_modules/@video/video-client-web/lib/ui/ui-lib/ControlBar/styles.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={root:{width:"100%",zIndex:130,position:"absolute",transition:"bottom 0.4s ease-in-out"},controls:{display:"flex",flexWrap:"wrap",justifyContent:"center",alignItems:"center",backgroundImage:"linear-gradient(rgba(0,0,0,0), rgba(0, 0, 0, 0.05) 5%, rgba(0, 0, 0, 0.10) 10%, rgba(0, 0, 0, 0.15) 15%, rgba(0, 0, 0, 0.20) 25%, rgba(0,0,0,0.40) 50%, rgba(0, 0, 0, 0.60) 75%, rgba(0,0,0,0.80))",opacity:1,padding:"1.25rem 0 0.5rem 0",transition:"opacity 300ms ease-out, bottom 0.3s ease-in-out","& button":{display:"block"},"&.video-controls--hidden":{opacity:0,transitionDelay:"500ms"},"&.lv-controls--hidden":{opacity:0,transitionDelay:"500ms"}},"video::-webkit-media-controls":{display:"none!important","-webkit-appearance":"none"},"video::-moz-media-controls":{display:"none!important","-webkit-appearance":"none"}}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/DurationLabel/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react")),o=i("./node_modules/@video/video-client-web/lib/ui/styling/videoStyles.js"),n=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Clock.js")),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/DurationLabel/styles.js"));t.default=e=>{var{children:t,classes:i={}}=e;r.__rest(e,["children","classes"]);const l=(0,o.useStyles)({source:i,target:a.default},"durationLabel");return s.default.createElement("div",{className:l.root},s.default.createElement(n.default,null))}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/DurationLabel/styles.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={"svg:not(:root)":{overflow:"hidden"},root:{borderRadius:"10rem",color:"#fff",display:"flex",flexDirection:"row",position:"absolute",left:"50%",top:"3rem",backgroundColor:"rgba(0, 0, 0, 0.66)",padding:".375rem .625rem",transform:"translate(-50%, -50%)",zIndex:130,"&.video-icon":{display:"block",width:"14px",height:"14px",marginRight:"0.5rem"},"&.video-time":{lineHeight:1.1,fontSize:".75rem"},"&.lv-icon":{display:"block",width:"14px",height:"14px",marginRight:"0.5rem"},"&.lv-time":{lineHeight:1.1,fontSize:".75rem"}}}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Hooks/useMediaQuery.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/@video/video-client-core/lib/api/adapter/index.js"),s=i("webpack/sharing/consume/default/react/react");t.default=e=>{const[t,i]=(0,s.useState)(;return(0,s.useEffect)(()=>{if(r.device.isImplements(r.Feature.MATCH_MEDIA)){const t=r.device.matchMedia(e),s=return t.addEventListener("change",s),i(t.matches),return()=>{}},[e]),t}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Hooks/useRefDimensions.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useRefDimensions=void 0;const r=i("webpack/sharing/consume/default/react/react");t.useRefDimensions=e=>{const[t,i]=(0,r.useState)({width:0,height:0});return(0,r.useEffect)(()=>{const t=new ResizeObserver(e=>{const{width:t,height:r}=e[0].contentRect;i({width:Math.round(t),height:Math.round(r)})});return e.current&&t.observe(e.current),,[e]),t}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Broadcast.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react"));t.default=e=>{var{className:t}=e,i=r.__rest(e,["className"]);return s.default.createElement("svg",Object.assign({"aria-hidden":"true",className:""+(null!=t&&t),"data-icon":"broadcast",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 200 200",fill:"none"},i),s.default.createElement("path",{d:"M159.958 42.1414C159.308 41.4718 158.532 40.9379 157.674 40.5709C156.816 40.2038 155.894 40.0108 154.961 40.0032H154.91C153.044 40.0043 151.255 40.7457 149.936 42.0646L149.228 42.772C147.929 44.0781 147.193 45.8415 147.178 47.684C147.164 49.5265 147.872 51.3012 149.151 52.6274C161.448 65.3316 168.323 82.3194 168.323 100C168.323 117.681 161.448 134.668 149.151 147.373C147.87 148.701 147.161 150.479 147.177 152.324C147.193 154.17 147.933 155.935 149.238 157.241L149.948 157.948C151.266 159.263 153.052 160.001 154.913 160H154.974C155.905 159.991 156.825 159.798 157.681 159.431C158.538 159.064 159.312 158.53 159.961 157.862C174.984 142.348 183.384 121.599 183.384 100.003C183.384 78.4074 174.984 57.6584 159.961 42.1446L159.958 42.1414Z",fill:"currentColor"}),s.default.createElement("path",{d:"M32.0611 100C32.0265 82.313 38.9058 65.3128 51.231 52.6274C52.5121 51.2999 53.2211 49.5226 53.2056 47.6778C53.19 45.833 52.4511 44.068 51.1478 42.7623L50.4372 42.0549C49.1182 40.74 47.332 40.0011 45.4694 40H45.4118C44.4798 40.0076 43.5586 40.2005 42.7019 40.5676C41.8452 40.9347 41.0701 41.4686 40.4217 42.1382C25.3994 57.6518 17 78.4002 17 99.9952C17 121.59 25.3994 142.339 40.4217 157.852C41.071 158.521 41.8467 159.055 42.7039 159.422C43.5611 159.789 44.4826 159.982 45.415 159.99H45.4855C46.4089 159.991 47.3234 159.809 48.1764 159.455C49.0294 159.101 49.8042 158.583 50.4564 157.929L51.167 157.218C52.4684 155.913 53.2061 154.149 53.2217 152.306C53.2372 150.463 52.5294 148.687 51.2502 147.36C38.9187 134.682 32.0322 117.686 32.0611 100V100Z",fill:"currentColor"}),s.default.createElement("path",{d:"M136.774 69.1214C136.123 68.4506 135.345 67.9161 134.486 67.549C133.626 67.1819 132.702 66.9896 131.768 66.9832H131.723C130.796 66.9842 129.878 67.1681 129.022 67.5246C128.166 67.8811 127.389 68.4031 126.736 69.0605L126.39 69.4062C125.095 70.7132 124.362 72.4753 124.35 74.3155C124.337 76.1556 125.045 77.9276 126.323 79.2521C131.707 84.8169 134.717 92.2568 134.717 100C134.717 107.743 131.707 115.183 126.323 120.748C125.045 122.072 124.336 123.844 124.348 125.684C124.36 127.524 125.092 129.286 126.387 130.594L126.733 130.939C127.386 131.598 128.162 132.12 129.018 132.477C129.874 132.833 130.792 133.017 131.72 133.017H131.764C132.699 133.01 133.623 132.818 134.482 132.451C135.342 132.084 136.12 131.549 136.771 130.879C144.789 122.6 149.273 111.526 149.273 100C149.273 88.4742 144.789 77.4004 136.771 69.1214H136.774Z",fill:"currentColor"}),s.default.createElement("path",{d:"M73.9763 69.3934L73.6306 69.0478C72.9781 68.3944 72.2033 67.876 71.3503 67.5223C70.4973 67.1686 69.583 66.9865 68.6597 66.9864H68.5988C67.6663 66.9936 66.7445 67.1863 65.8872 67.5534C65.0299 67.9205 64.2543 68.4546 63.6055 69.1246C55.5841 77.4055 51.0989 88.4823 51.0989 100.011C51.0989 111.54 55.5841 122.617 63.6055 130.898C64.2548 131.567 65.0305 132.101 65.8877 132.468C66.7449 132.835 67.6664 133.028 68.5988 133.036H68.6533C69.5767 133.036 70.4912 132.855 71.3442 132.501C72.1972 132.147 72.972 131.628 73.6242 130.975L73.9699 130.629C75.2723 129.323 76.0106 127.559 76.0261 125.715C76.0417 123.871 75.3333 122.094 74.0531 120.767C68.6682 115.203 65.6576 107.763 65.6576 100.019C65.6576 92.2758 68.6682 84.8357 74.0531 79.2713C75.339 77.944 76.0516 76.1645 76.0372 74.3166C76.0228 72.4687 75.2826 70.7005 73.9763 69.3934Z",fill:"currentColor"}),s.default.createElement("path",{d:"M100.191 114.97C108.604 114.97 115.424 108.15 115.424 99.7376C115.424 91.3247 108.604 84.5047 100.191 84.5047C91.7783 84.5047 84.9583 91.3247 84.9583 99.7376C84.9583 108.15 91.7783 114.97 100.191 114.97Z",fill:"currentColor"}))}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Camera.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react"));t.default=e=>{var{className:t,outline:i=!1}=e,o=r.__rest(e,["className","outline"]);return i?s.default.createElement("svg",Object.assign({viewBox:"0 0 38 38",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:""+(null!=t&&t)},o),s.default.createElement("circle",{cx:"19",cy:"19",r:"19",fill:"white",fillOpacity:"0.1"}),s.default.createElement("path",{d:"M22.75 17.5L27.47 12.78C27.5749 12.6752 27.7085 12.6039 27.8539 12.575C27.9993 12.5462 28.15 12.561 28.2869 12.6177C28.4239 12.6744 28.541 12.7705 28.6234 12.8937C28.7058 13.0169 28.7499 13.1618 28.75 13.31V24.69C28.7499 24.8382 28.7058 24.9831 28.6234 25.1063C28.541 25.2295 28.4239 25.3256 28.2869 25.3823C28.15 25.439 27.9993 25.4538 27.8539 25.425C27.7085 25.3961 27.5749 25.3248 27.47 25.22L22.75 20.5M11.5 25.75H20.5C21.0967 25.75 21.669 25.5129 22.091 25.091C22.5129 24.669 22.75 24.0967 22.75 23.5V14.5C22.75 13.9033 22.5129 13.331 22.091 12.909C21.669 12.4871 21.0967 12.25 20.5 12.25H11.5C10.9033 12.25 10.331 12.4871 9.90901 12.909C9.48705 13.331 9.25 13.9033 9.25 14.5V23.5C9.25 24.0967 9.48705 24.669 9.90901 25.091C10.331 25.5129 10.9033 25.75 11.5 25.75Z",stroke:"white",strokeWidth:"2",strokeLinecap:"round"})):s.default.createElement("svg",Object.assign({"aria-hidden":"true",className:""+(null!=t&&t),"data-icon":"camera",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 200 200"},o),s.default.createElement("path",{fill:"currentColor",d:"M112.209 50.7342H39.1599C32.473 50.7342 27.0526 56.225 27.0526 62.9987V136.996C27.0526 143.77 32.473 149.261 39.1599 149.261H112.209C118.895 149.261 124.316 143.77 124.316 136.996V62.9987C124.316 56.225 118.895 50.7342 112.209 50.7342ZM160.182 60.4072L132.421 79.8046V120.19L160.182 139.562C165.551 143.308 172.947 139.485 172.947 132.942V67.027C172.947 60.5099 165.577 56.6612 160.182 60.4072Z"}))}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/CameraOff.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react"));t.default=e=>{var{className:t}=e,i=r.__rest(e,["className"]);return s.default.createElement("svg",Object.assign({"aria-hidden":"true",className:""+(null!=t&&t),"data-icon":"camera-slash",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 200 200"},i),s.default.createElement("path",{fill:"currentColor",d:"M179.427 151.748L165.505 140.855C169.403 140.497 172.897 137.344 172.897 132.885V67.0154C172.897 60.4798 165.53 56.6609 160.139 60.4029L132.395 79.7792V114.944L124.295 108.613V62.9915C124.295 56.2252 118.878 50.7404 112.196 50.7404H50.3556L30.51 35.2086C28.7381 33.8246 26.2068 34.1322 24.8146 35.9263L19.8532 42.385C18.4863 44.1791 18.7901 46.7421 20.562 48.1261L29.8013 55.3538L124.295 129.322L169.479 164.691C171.251 166.075 173.782 165.768 175.175 163.974L180.136 157.489C181.528 155.721 181.199 153.132 179.427 151.748ZM27.0928 136.908C27.0928 143.675 32.5098 149.16 39.1925 149.16H112.196C115.031 149.16 117.613 148.134 119.688 146.468L27.0928 73.9868V136.908Z"}))}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/ChevronDown.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js").__importDefault(i("webpack/sharing/consume/default/react/react"));t.default=,"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Clock.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js").__importDefault(i("webpack/sharing/consume/default/react/react"));t.default=({className:e})=>r.default.createElement("svg",{"aria-hidden":"true",className:""+(null!=e&&e),"data-icon":"clock",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 200 200"},r.default.createElement("path",{fill:"currentColor",d:"M99 3.09375C46.0195 3.09375 3.09375 46.0195 3.09375 99C3.09375 151.98 46.0195 194.906 99 194.906C151.98 194.906 194.906 151.98 194.906 99C194.906 46.0195 151.98 3.09375 99 3.09375ZM99 176.344C56.2676 176.344 21.6562 141.732 21.6562 99C21.6562 56.2676 56.2676 21.6562 99 21.6562C141.732 21.6562 176.344 56.2676 176.344 99C176.344 141.732 141.732 176.344 99 176.344ZM122.899 135.97L90.0668 112.11C88.868 111.22 88.1719 109.828 88.1719 108.359V44.8594C88.1719 42.307 90.2602 40.2188 92.8125 40.2188H105.188C107.74 40.2188 109.828 42.307 109.828 44.8594V99.6574L135.661 118.452C137.749 119.96 138.175 122.861 136.666 124.949L129.396 134.965C127.888 137.014 124.987 137.479 122.899 135.97Z"}))},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Close.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react"));t.default=function(e){var{className:t,style:i,weight:o}=e,n=r.__rest(e,["className","style","weight"]);return"normal"===o?s.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",className:""+(null!=t&&t),role:"img",style:Object.assign({},i)},s.default.createElement("path",{fillRule:"evenodd",d:"M5.47 5.47a.75.75 0 011.06 0L12 10.94l5.47-5.47a.75.75 0 111.06 1.06L13.06 12l5.47 5.47a.75.75 0 11-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 01-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 010-1.06z",clipRule:"evenodd"})):s.default.createElement("svg",Object.assign({"aria-hidden":"true",className:""+(null!=t&&t),"data-icon":"camera-slash",focusable:"false",role:"img",style:Object.assign({},i),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 352 512"},n),s.default.createElement("path",{fill:"currentColor",d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"}))}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Collapse.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react"));t.default=e=>{var{className:t}=e,i=r.__rest(e,["className"]);return s.default.createElement("svg",Object.assign({"aria-hidden":"true",className:""+(null!=t&&t),"data-icon":"collapse",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 200 200"},i),s.default.createElement("path",{fill:"currentColor",d:"M166.25 79.6875H127.5C123.344 79.6875 120 76.3646 120 72.2344V33.7266C120 31.677 121.688 30 123.75 30H136.25C138.312 30 140 31.677 140 33.7266V59.8125H166.25C168.312 59.8125 170 61.4895 170 63.5391V75.9609C170 78.0105 168.312 79.6875 166.25 79.6875ZM80 72.2344V33.7266C80 31.677 78.3125 30 76.25 30H63.75C61.6875 30 60 31.677 60 33.7266V59.8125H33.75C31.6875 59.8125 30 61.4895 30 63.5391V75.9609C30 78.0105 31.6875 79.6875 33.75 79.6875H72.5C76.6563 79.6875 80 76.3646 80 72.2344ZM80 165.398V126.891C80 122.76 76.6563 119.438 72.5 119.438H33.75C31.6875 119.438 30 121.114 30 123.164V135.586C30 137.636 31.6875 139.312 33.75 139.312H60V165.398C60 167.448 61.6875 169.125 63.75 169.125H76.25C78.3125 169.125 80 167.448 80 165.398ZM140 165.398V139.312H166.25C168.312 139.312 170 137.636 170 135.586V123.164C170 121.114 168.312 119.438 166.25 119.438H127.5C123.344 119.438 120 122.76 120 126.891V165.398C120 167.448 121.688 169.125 123.75 169.125H136.25C138.312 169.125 140 167.448 140 165.398Z"}))}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Configuration.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react"));t.default=e=>{var{className:t}=e,i=r.__rest(e,["className"]);return s.default.createElement("svg",Object.assign({"aria-hidden":"true",className:""+(null!=t&&t),"data-icon":"configuration",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 200 200"},i),s.default.createElement("path",{fill:"currentColor",d:"M164.525 134.286H74.75V130C74.75 127.643 72.8262 125.714 70.475 125.714H61.925C59.5737 125.714 57.65 127.643 57.65 130V134.286H36.275C33.9237 134.286 32 136.214 32 138.571V147.143C32 149.5 33.9237 151.429 36.275 151.429H57.65V155.714C57.65 158.071 59.5737 160 61.925 160H70.475C72.8262 160 74.75 158.071 74.75 155.714V151.429H164.525C166.876 151.429 168.8 149.5 168.8 147.143V138.571C168.8 136.214 166.876 134.286 164.525 134.286ZM164.525 91.4286H143.15V87.1429C143.15 84.7857 141.226 82.8571 138.875 82.8571H130.325C127.974 82.8571 126.05 84.7857 126.05 87.1429V91.4286L36.275 91.4286C33.9237 91.4286 32 93.3571 32 95.7143V104.286C32 106.643 33.9237 108.571 36.275 108.571L126.05 108.571V112.857C126.05 115.214 127.974 117.143 130.325 117.143H138.875C141.226 117.143 143.15 115.214 143.15 112.857V108.571H164.525C166.876 108.571 168.8 106.643 168.8 104.286V95.7143C168.8 93.3571 166.876 91.4286 164.525 91.4286ZM164.525 48.5714L108.95 48.5714V44.2857C108.95 41.9286 107.026 40 104.675 40L96.125 40C93.7737 40 91.85 41.9286 91.85 44.2857V48.5714L36.275 48.5714C33.9237 48.5714 32 50.5 32 52.8571V61.4286C32 63.7857 33.9237 65.7143 36.275 65.7143L91.85 65.7143V70C91.85 72.3571 93.7737 74.2857 96.125 74.2857L104.675 74.2857C107.026 74.2857 108.95 72.3571 108.95 70V65.7143L164.525 65.7143C166.876 65.7143 168.8 63.7857 168.8 61.4286V52.8571C168.8 50.5 166.876 48.5714 164.525 48.5714Z"}))}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Expand.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react"));t.default=e=>{var{className:t}=e,i=r.__rest(e,["className"]);return s.default.createElement("svg",Object.assign({"aria-hidden":"true",className:""+(null!=t&&t),"data-icon":"expand",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 200 200"},i),s.default.createElement("path",{fill:"currentColor",d:"M30 75.9609V37.4531C30 33.3229 33.3437 30 37.5 30H76.25C78.3125 30 80 31.677 80 33.7266V46.1484C80 48.198 78.3125 49.875 76.25 49.875H50V75.9609C50 78.0105 48.3125 79.6875 46.25 79.6875H33.75C31.6875 79.6875 30 78.0105 30 75.9609ZM120 33.7266V46.1484C120 48.198 121.688 49.875 123.75 49.875H150V75.9609C150 78.0105 151.688 79.6875 153.75 79.6875H166.25C168.312 79.6875 170 78.0105 170 75.9609V37.4531C170 33.3229 166.656 30 162.5 30H123.75C121.688 30 120 31.677 120 33.7266ZM166.25 119.438H153.75C151.688 119.438 150 121.114 150 123.164V149.25H123.75C121.688 149.25 120 150.927 120 152.977V165.398C120 167.448 121.688 169.125 123.75 169.125H162.5C166.656 169.125 170 165.802 170 161.672V123.164C170 121.114 168.312 119.438 166.25 119.438ZM80 165.398V152.977C80 150.927 78.3125 149.25 76.25 149.25H50V123.164C50 121.114 48.3125 119.438 46.25 119.438H33.75C31.6875 119.438 30 121.114 30 123.164V161.672C30 165.802 33.3437 169.125 37.5 169.125H76.25C78.3125 169.125 80 167.448 80 165.398Z"}))}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Eye.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js").__importStar(i("webpack/sharing/consume/default/react/react"));t.default=e=>r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none"},e),r.createElement("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.295,d:"M1.622 6.046c-.088-.14-.132-.21-.157-.318a.76.76 0 0 1 0-.289c.025-.108.069-.177.157-.317C2.351 3.968 4.52 1.05 7.826 1.05c3.306 0 5.476 2.918 6.205 4.072.088.14.132.21.157.317a.761.761 0 0 1 0 .29c-.025.107-.07.177-.157.317-.73 1.154-2.899 4.071-6.205 4.071S2.351 7.2 1.622 6.046Z"}),r.createElement("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.295,d:"M7.826 7.527a1.943 1.943 0 1 0 0-3.886 1.943 1.943 0 0 0 0 3.886Z"}))},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Microphone.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react"));t.default=e=>{var{className:t}=e,i=r.__rest(e,["className"]);return s.default.createElement("svg",Object.assign({"aria-hidden":"true",className:""+(null!=t&&t),"data-icon":"microphone",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 200 200"},i),s.default.createElement("title",null,i.title),s.default.createElement("path",{fill:"currentColor",d:"M100.004 124.659C113.738 124.659 124.872 113.619 124.872 100V58.9016C124.872 45.2826 113.738 34.2426 100.004 34.2426C86.2693 34.2426 75.1355 45.2826 75.1355 58.9016V100C75.1355 113.619 86.2693 124.659 100.004 124.659ZM141.451 83.5606H137.306C135.016 83.5606 133.161 85.3998 133.161 87.6705V100C133.161 119.214 116.456 134.631 96.6906 132.719C79.4642 131.052 66.8461 115.697 66.8461 98.5359V87.6705C66.8461 85.3998 64.9914 83.5606 62.7014 83.5606H58.5567C56.2667 83.5606 54.412 85.3998 54.412 87.6705V97.9862C54.412 121.012 70.9831 141.538 93.7867 144.656V153.428H79.2802C76.9903 153.428 75.1355 155.267 75.1355 157.538V161.648C75.1355 163.918 76.9903 165.757 79.2802 165.757H120.727C123.017 165.757 124.872 163.918 124.872 161.648V157.538C124.872 155.267 123.017 153.428 120.727 153.428H106.221V144.754C128.424 141.733 145.596 122.835 145.596 100V87.6705C145.596 85.3998 143.741 83.5606 141.451 83.5606Z"}))}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/MicrophoneOff.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react"));t.default=e=>{var{className:t}=e,i=r.__rest(e,["className"]);return s.default.createElement("svg",Object.assign({"aria-hidden":"true",className:""+(null!=t&&t),"data-icon":"microphone-off",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 200 200"},i),s.default.createElement("title",null,i.title),s.default.createElement("path",{fill:"currentColor",d:"M181.397 151.912L140.483 120.585C143.748 114.417 145.664 107.451 145.664 99.9996V87.6701C145.664 85.3995 143.807 83.5603 141.515 83.5603H137.367C135.075 83.5603 133.218 85.3995 133.218 87.6701V99.9996C133.218 104.603 132.192 108.938 130.439 112.894L123.555 107.623C124.359 105.209 124.924 102.686 124.924 100.002V58.9014C124.924 45.2825 113.78 34.2426 100.033 34.2426C86.2863 34.2426 75.1425 45.2825 75.1425 58.9014V70.5528L28.8509 35.1082C27.0411 33.716 24.4328 34.0371 23.0275 35.83L17.9353 42.3209C16.53 44.1112 16.8541 46.6927 18.6639 48.0875L171.213 164.891C173.023 166.286 175.628 165.962 177.036 164.169L182.129 157.678C183.531 155.888 183.207 153.306 181.397 151.912ZM120.773 153.427H106.253V144.753C109.276 144.342 112.178 143.587 114.983 142.618L101.991 132.67C100.251 132.773 98.5138 132.894 96.7145 132.721C82.2338 131.322 71.1133 120.23 67.8879 106.56L54.3976 96.2263V97.9858C54.3976 121.011 70.9837 141.537 93.8079 144.655V153.427H79.2883C76.9963 153.427 75.1399 155.266 75.1399 157.537V161.647C75.1399 163.917 76.9963 165.757 79.2883 165.757H120.773C123.065 165.757 124.921 163.917 124.921 161.647V157.537C124.921 155.266 123.065 153.427 120.773 153.427Z"}))}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Pause.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react"));t.default=e=>{var{className:t}=e,i=r.__rest(e,["className"]);return s.default.createElement("svg",Object.assign({className:""+(null!=t&&t),"data-icon":"pause",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 200 200"},i),s.default.createElement("path",{fill:"currentColor",d:"M155.769 147.143V52.8571C155.769 45.7589 150.083 40 143.075 40H128.124C121.116 40 115.43 45.7589 115.43 52.8571V147.143C115.43 154.241 121.116 160 128.124 160H143.075C150.083 160 155.769 154.241 155.769 147.143Z"}),s.default.createElement("path",{fill:"currentColor",d:"M85.3395 147.143V52.8571C85.3395 45.7589 79.6536 40 72.6453 40H57.6943C50.686 40 45 45.7589 45 52.8571V147.143C45 154.241 50.686 160 57.6943 160H72.6453C79.6536 160 85.3395 154.241 85.3395 147.143Z"}))}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Play.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react"));t.default=e=>{var{className:t}=e,i=r.__rest(e,["className"]);return s.default.createElement("svg",Object.assign({className:""+(null!=t&&t),"data-icon":"play",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 200 200"},i),s.default.createElement("path",{fill:"currentColor",d:"M146.378 90.3108L64.7827 41.5393C58.1531 37.5785 48 41.4221 48 51.2186V148.738C48 157.527 57.4345 162.823 64.7827 158.417L146.378 109.669C153.657 105.334 153.68 94.6465 146.378 90.3108V90.3108Z"}))}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Player/CamCall.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js").__importDefault(i("webpack/sharing/consume/default/react/react"));t.default=({className:e})=>r.default.createElement("svg",{className:""+(null!=e&&e),"data-icon":"camcall",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48"},r.default.createElement("path",{fill:"currentColor",d:"M34.031 21l7.969-7.969v21.938l-7.969-7.969v7.031q0 0.844-0.609 1.406t-1.453 0.563h-24q-0.844 0-1.406-0.563t-0.563-1.406v-20.063q0-0.844 0.563-1.406t1.406-0.563h24q0.844 0 1.453 0.563t0.609 1.406v7.031z"}))},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Player/Delay.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js").__importDefault(i("webpack/sharing/consume/default/react/react"));t.default=({className:e})=>r.default.createElement("svg",{className:""+(null!=e&&e),"data-icon":"delaystream",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48"},r.default.createElement("path",{fill:"currentColor",d:"M24 31.969q-1.594 0-2.813-1.172t-1.219-2.766q0-1.688 1.219-2.906l16.969-11.25-11.344 16.969q-1.125 1.125-2.813 1.125zM40.781 17.156q1.313 2.063 2.25 5.25t0.938 5.625q0 5.531-2.625 9.938-1.219 2.063-3.469 2.063h-27.75q-2.25 0-3.469-2.063-2.625-4.406-2.625-9.938 0-8.25 5.859-14.109t14.203-5.859q2.438 0 5.578 0.938t5.203 2.25l-3.75 2.438q-3.375-1.688-7.125-1.688-6.563 0-11.297 4.688t-4.734 11.344q0 4.313 2.156 7.969h27.75q2.156-3.656 2.156-7.969 0-3.844-1.688-7.219z"}))},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Player/Fullscreen.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js").__importDefault(i("webpack/sharing/consume/default/react/react"));t.default=({className:e})=>r.default.createElement("svg",{className:""+(null!=e&&e),"data-icon":"fullscreen",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48"},r.default.createElement("path",{fill:"currentColor",d:"M28.031 10.031h9.938v9.938h-3.938v-6h-6v-3.938zM34.031 34.031v-6h3.938v9.938h-9.938v-3.938h6zM10.031 19.969v-9.938h9.938v3.938h-6v6h-3.938zM13.969 28.031v6h6v3.938h-9.938v-9.938h3.938z"}))},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Player/FullscreenExit.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js").__importDefault(i("webpack/sharing/consume/default/react/react"));t.default=({className:e})=>r.default.createElement("svg",{className:""+(null!=e&&e),"data-icon":"fullscreenexit",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48"},r.default.createElement("path",{fill:"currentColor",d:"M31.969 16.031h6v3.938h-9.938v-9.938h3.938v6zM28.031 37.969v-9.938h9.938v3.938h-6v6h-3.938zM16.031 16.031v-6h3.938v9.938h-9.938v-3.938h6zM10.031 31.969v-3.938h9.938v9.938h-3.938v-6h-6z"}))},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Player/LaunchOpen.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js").__importDefault(i("webpack/sharing/consume/default/react/react"));t.default=({className:e})=>r.default.createElement("svg",{className:""+(null!=e&&e),"data-icon":"launchopen",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48"},r.default.createElement("path",{fill:"currentColor",d:"M28.031 6h13.969v13.969h-4.031v-7.125l-19.594 19.594-2.813-2.813 19.594-19.594h-7.125v-4.031zM37.969 37.969v-13.969h4.031v13.969q0 1.594-1.219 2.813t-2.813 1.219h-27.938q-1.688 0-2.859-1.172t-1.172-2.859v-27.938q0-1.688 1.172-2.859t2.859-1.172h13.969v4.031h-13.969v27.938h27.938z"}))},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Player/Pause.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js").__importDefault(i("webpack/sharing/consume/default/react/react"));t.default=({className:e})=>r.default.createElement("svg",{className:""+(null!=e&&e),"data-icon":"pause",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48"},r.default.createElement("path",{fill:"currentColor",d:"M28.031 10.031h7.969v27.938h-7.969v-27.938zM12 37.969v-27.938h7.969v27.938h-7.969z"}))},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Player/Play.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js").__importDefault(i("webpack/sharing/consume/default/react/react"));t.default=({className:e})=>r.default.createElement("svg",{className:""+(null!=e&&e),"data-icon":"play",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48"},r.default.createElement("path",{fill:"currentColor",d:"M16.031 10.031l21.938 13.969-21.938 13.969v-27.938z"}))},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Player/Settings.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js").__importDefault(i("webpack/sharing/consume/default/react/react"));t.default=({className:e})=>r.default.createElement("svg",{className:""+(null!=e&&e),"data-icon":"settings",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48"},r.default.createElement("path",{fill:"currentColor",d:"M24 31.031q2.906 0 4.969-2.063t2.063-4.969-2.063-4.969-4.969-2.063-4.969 2.063-2.063 4.969 2.063 4.969 4.969 2.063zM38.906 25.969l4.219 3.281q0.656 0.469 0.188 1.313l-4.031 6.938q-0.375 0.656-1.219 0.375l-4.969-1.969q-1.969 1.406-3.375 1.969l-0.75 5.25q-0.188 0.844-0.938 0.844h-8.063q-0.75 0-0.938-0.844l-0.75-5.25q-1.781-0.75-3.375-1.969l-4.969 1.969q-0.844 0.281-1.219-0.375l-4.031-6.938q-0.469-0.844 0.188-1.313l4.219-3.281q-0.094-0.656-0.094-1.969t0.094-1.969l-4.219-3.281q-0.656-0.469-0.188-1.313l4.031-6.938q0.375-0.656 1.219-0.375l4.969 1.969q1.969-1.406 3.375-1.969l0.75-5.25q0.188-0.844 0.938-0.844h8.063q0.75 0 0.938 0.844l0.75 5.25q1.781 0.75 3.375 1.969l4.969-1.969q0.844-0.281 1.219 0.375l4.031 6.938q0.469 0.844-0.188 1.313l-4.219 3.281q0.094 0.656 0.094 1.969t-0.094 1.969z"}))},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Player/Sound.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js").__importDefault(i("webpack/sharing/consume/default/react/react"));t.default=({className:e})=>r.default.createElement("svg",{className:""+(null!=e&&e),"data-icon":"sound",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48"},r.default.createElement("path",{fill:"currentColor",d:"M28.031 6.469q6.094 1.313 10.031 6.234t3.938 11.297-3.938 11.297-10.031 6.234v-4.125q4.406-1.313 7.172-4.969t2.766-8.438-2.766-8.438-7.172-4.969v-4.125zM33 24q0 5.625-4.969 8.063v-16.125q2.063 1.031 3.516 3.375t1.453 4.688zM6 18h7.969l10.031-10.031v32.063l-10.031-10.031h-7.969v-12z"}))},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Player/SoundOff.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js").__importDefault(i("webpack/sharing/consume/default/react/react"));t.default=({className:e})=>r.default.createElement("svg",{className:""+(null!=e&&e),"data-icon":"soundoff",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48"},r.default.createElement("path",{fill:"currentColor",d:"M24 7.969v8.438l-4.219-4.219zM8.531 6l33.469 33.469-2.531 2.531-4.125-4.125q-3.094 2.625-7.313 3.656v-4.125q2.344-0.656 4.5-2.344l-8.531-8.531v13.5l-10.031-10.031h-7.969v-12h9.469l-9.469-9.469zM37.969 24q0-4.781-2.766-8.438t-7.172-4.969v-4.125q6.094 1.313 10.031 6.234t3.938 11.297q0 4.406-2.063 8.344l-3-3.094q1.031-2.531 1.031-5.25zM33 24q0 0.844-0.094 1.219l-4.875-4.875v-4.406q2.063 1.031 3.516 3.375t1.453 4.688z"}))},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Player/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react")),o=i("./node_modules/@video/video-client-web/lib/ui/styling/videoStyles.js"),n=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/styles.js")),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Player/CamCall.js")),l=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Player/Delay.js")),d=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Player/Fullscreen.js")),c=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Player/FullscreenExit.js")),u=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Player/LaunchOpen.js")),p=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Player/Pause.js")),h=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Player/Play.js")),m=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Player/Settings.js")),v=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Player/Sound.js")),g=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Player/SoundOff.js"));t.default=({classes:e={},iconName:t})=>{const i={camcall:a.default,delay:l.default,fullscreen:d.default,fullscreenexit:c.default,launchopen:u.default,play:h.default,pause:p.default,settings:m.default,sound:v.default,soundoff:g.default},r=(0,o.useStyles)({source:e,target:n.default},"icons"),f=t.toLowerCase(),b=i[t];return s.default.createElement("span",{className:""+r.root},s.default.createElement(b,{className:`${r.icon} ${f}`}))}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Recorder/Delete.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react"));t.default=e=>{var{className:t}=e,i=r.__rest(e,["className"]);return s.default.createElement("svg",Object.assign({width:"30px",height:"30px",fill:"none","aria-hidden":"true",className:""+(null!=t&&t),viewBox:"0 0 24 24",stroke:"currentColor"},i),s.default.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"}))}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Recorder/Pause.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react"));t.default=e=>{var{className:t}=e,i=r.__rest(e,["className"]);return s.default.createElement("svg",Object.assign({width:"30px",height:"30px",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",className:""+(null!=t&&t),"data-icon":"recorderpause",focusable:"false",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},i),s.default.createElement("rect",{x:"6",y:"4",width:"2",height:"16"}),s.default.createElement("rect",{x:"16",y:"4",width:"2",height:"16"}))}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Recorder/Record.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react"));t.default=e=>{var{className:t}=e,i=r.__rest(e,["className"]);return s.default.createElement("svg",Object.assign({"aria-hidden":"true",className:""+(null!=t&&t),"data-icon":"record",focusable:"false",width:"38",height:"35",viewBox:"0 0 30 32",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},i),s.default.createElement("circle",{cx:"15",cy:"12",r:"10"}))}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Recorder/Save.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react"));t.default=e=>{var{className:t}=e;r.__rest(e,["className"]);return s.default.createElement("svg",{"aria-hidden":"true",width:"30px",height:"30px",className:""+(null!=t&&t),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},s.default.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"}))}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Recorder/Start.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react"));t.default=e=>{var{className:t}=e,i=r.__rest(e,["className"]);return s.default.createElement("svg",Object.assign({className:""+(null!=t&&t),height:"28",width:"28",viewBox:"0 0 48 48"},i),s.default.createElement("path",{d:"M-838-2232H562v3600H-838z",fill:"none"}),s.default.createElement("path",{d:"M16 10v28l22-14z"}),s.default.createElement("path",{d:"M0 0h48v48H0z",fill:"none"}))}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/ScreenCapture.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react"));t.default=e=>{var{className:t}=e,i=r.__rest(e,["className"]);return s.default.createElement("svg",Object.assign({"aria-hidden":"true",className:""+(null!=t&&t),"data-icon":"volume-off",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 576 512"},i),s.default.createElement("path",{fill:"currentColor",d:"M568.482 177.448L424.479 313.433C409.3 327.768 384 317.14 384 295.985v-71.963c-144.575.97-205.566 35.113-164.775 171.353 4.483 14.973-12.846 26.567-25.006 17.33C155.252 383.105 120 326.488 120 269.339c0-143.937 117.599-172.5 264-173.312V24.012c0-21.174 25.317-31.768 40.479-17.448l144.003 135.988c10.02 9.463 10.028 25.425 0 34.896zM384 379.128V448H64V128h50.916a11.99 11.99 0 0 0 8.648-3.693c14.953-15.568 32.237-27.89 51.014-37.676C185.708 80.83 181.584 64 169.033 64H48C21.49 64 0 85.49 0 112v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48v-88.806c0-8.288-8.197-14.066-16.011-11.302a71.83 71.83 0 0 1-34.189 3.377c-7.27-1.046-13.8 4.514-13.8 11.859z"}))}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Settings.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react"));t.default=e=>{var{className:t}=e,i=r.__rest(e,["className"]);return s.default.createElement("svg",Object.assign({className:""+(null!=t&&t),"data-icon":"settings",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 200 200"},i),s.default.createElement("path",{fill:"currentColor",d:"M151.18 87.3637H147.989C146.822 87.3524 145.687 86.9831 144.736 86.3056C143.786 85.6281 143.067 84.6751 142.676 83.5756C142.423 82.8192 142.051 82.0597 141.791 81.4284C141.279 80.3716 141.113 79.18 141.317 78.0233C141.521 76.8667 142.085 75.804 142.929 74.9868L147.476 70.4392C148.016 69.9135 148.445 69.2851 148.738 68.5911C149.031 67.897 149.182 67.1513 149.182 66.3979C149.182 65.6446 149.031 64.8989 148.738 64.2048C148.445 63.5107 148.016 62.8823 147.476 62.3567L137.631 52.502C137.106 51.9624 136.477 51.5335 135.783 51.2406C135.089 50.9478 134.344 50.7969 133.59 50.7969C132.837 50.7969 132.091 50.9478 131.397 51.2406C130.703 51.5335 130.075 51.9624 129.549 52.502L125.011 57.0527C124.177 57.8698 123.116 58.4157 121.966 58.6187C120.817 58.8218 119.633 58.6725 118.57 58.1904C117.813 57.9372 117.179 57.5653 116.422 57.3059C115.323 56.9148 114.37 56.1955 113.692 55.2452C113.015 54.295 112.646 53.1596 112.634 51.9926V45.6854C112.638 44.937 112.493 44.1955 112.208 43.5036C111.922 42.8117 111.503 42.1833 110.973 41.6546C110.444 41.1258 109.815 40.7074 109.122 40.4234C108.43 40.1394 107.688 39.9956 106.94 40.0001H93.0475C92.3 39.9968 91.5592 40.1416 90.868 40.4261C90.1768 40.7107 89.5487 41.1293 89.0202 41.6579C88.4916 42.1865 88.0729 42.8145 87.7884 43.5058C87.5039 44.1971 87.3591 44.9378 87.3624 45.6854V52.127C87.3691 53.2983 87.0067 54.4419 86.3268 55.3956C85.6469 56.3494 84.6839 57.0648 83.5744 57.4403C82.8375 57.6807 82.1197 57.9764 81.4273 58.3248C80.3633 58.8017 79.1807 58.9484 78.0324 58.7462C76.8841 58.5439 75.8229 58.0019 74.9858 57.1903L70.4383 52.6302C69.9127 52.0905 69.2843 51.6616 68.5903 51.3688C67.8962 51.0759 67.1505 50.925 66.3972 50.925C65.6439 50.925 64.8982 51.0759 64.2041 51.3688C63.51 51.6616 62.8817 52.0905 62.356 52.6302L52.5016 62.4817C51.962 63.0073 51.5331 63.6357 51.2402 64.3298C50.9474 65.0239 50.7965 65.7696 50.7965 66.5229C50.7965 67.2763 50.9474 68.022 51.2402 68.7161C51.5331 69.4102 51.962 70.0386 52.5016 70.5642L57.0491 75.1118C57.8694 75.9468 58.4172 77.011 58.6203 78.1638C58.8234 79.3166 58.6722 80.5039 58.1867 81.569C57.8383 82.2615 57.5427 82.9793 57.3023 83.7162C56.9112 84.8158 56.1919 85.7687 55.2416 86.4462C54.2914 87.1237 53.156 87.493 51.9891 87.5043H45.6851C44.9389 87.501 44.1995 87.6453 43.5092 87.9289C42.819 88.2124 42.1917 88.6297 41.6633 89.1566C41.135 89.6835 40.716 90.3097 40.4305 90.9992C40.1451 91.6886 39.9988 92.4277 40 93.1739V107.067C40.0181 108.557 40.627 109.98 41.6929 111.021C42.7588 112.063 44.1947 112.64 45.6851 112.624H51.8765C53.0482 112.617 54.1921 112.98 55.1458 113.661C56.0996 114.341 56.8147 115.305 57.1897 116.415C57.4429 117.171 57.8148 117.931 58.0742 118.687C58.5507 119.752 58.6969 120.934 58.4941 122.083C58.2913 123.231 57.7488 124.292 56.9366 125.129L52.5016 129.551C51.962 130.077 51.5331 130.705 51.2402 131.4C50.9474 132.094 50.7965 132.839 50.7965 133.593C50.7965 134.346 50.9474 135.092 51.2402 135.786C51.5331 136.48 51.962 137.108 52.5016 137.634L62.3529 147.485C62.8785 148.025 63.5069 148.454 64.201 148.747C64.895 149.04 65.6407 149.191 66.3941 149.191C67.1474 149.191 67.8931 149.04 68.5871 148.747C69.2812 148.454 69.9096 148.025 70.4352 147.485L74.7295 143.191C75.5379 142.375 76.5779 141.829 77.7081 141.625C78.8383 141.421 80.0038 141.571 81.046 142.053C81.9304 142.432 82.8149 142.81 83.5713 143.191C84.6423 143.61 85.5634 144.34 86.2162 145.287C86.869 146.234 87.2235 147.354 87.2343 148.504V154.315C87.231 155.062 87.3757 155.803 87.6603 156.494C87.9448 157.185 88.3634 157.813 88.892 158.342C89.4206 158.871 90.0486 159.289 90.7399 159.574C91.4311 159.858 92.1719 160.003 92.9194 160H106.812C107.561 160.005 108.303 159.861 108.997 159.577C109.69 159.293 110.32 158.874 110.849 158.344C111.379 157.815 111.799 157.186 112.084 156.493C112.369 155.8 112.514 155.057 112.509 154.308V148.12C112.512 146.968 112.863 145.844 113.517 144.895C114.171 143.947 115.097 143.219 116.172 142.807C117.047 142.504 117.892 142.124 118.698 141.669C119.742 141.19 120.908 141.044 122.037 141.252C123.167 141.459 124.205 142.01 125.011 142.828L129.305 147.123C129.831 147.663 130.459 148.091 131.153 148.384C131.847 148.677 132.593 148.828 133.346 148.828C134.1 148.828 134.845 148.677 135.54 148.384C136.234 148.091 136.862 147.663 137.388 147.123L147.239 137.271C147.779 136.746 148.207 136.117 148.5 135.423C148.793 134.729 148.944 133.983 148.944 133.23C148.944 132.477 148.793 131.731 148.5 131.037C148.207 130.343 147.779 129.715 147.239 129.189L142.938 125.013C142.116 124.183 141.567 123.121 141.364 121.97C141.161 120.819 141.313 119.634 141.801 118.572C142.15 117.837 142.446 117.077 142.685 116.299C143.076 115.2 143.796 114.247 144.746 113.569C145.696 112.892 146.831 112.523 147.998 112.511H154.315C155.062 112.515 155.803 112.37 156.494 112.085C157.186 111.801 157.814 111.382 158.342 110.854C158.871 110.325 159.289 109.697 159.574 109.006C159.858 108.314 160.003 107.574 160 106.826V92.9239C159.987 89.8922 154.337 87.3637 151.18 87.3637ZM100.008 122.1C95.6352 122.103 91.3601 120.808 87.7234 118.38C84.0867 115.953 81.2518 112.501 79.5773 108.461C77.9028 104.422 77.4641 99.9766 78.3165 95.6878C79.169 91.399 81.2743 87.4594 84.3662 84.3674C87.4581 81.2754 91.3976 79.17 95.6863 78.3176C99.975 77.4651 104.42 77.9039 108.459 79.5784C112.499 81.2529 115.951 84.0879 118.378 87.7247C120.806 91.3615 122.101 95.6367 122.098 100.009C122.104 102.912 121.536 105.787 120.428 108.47C119.32 111.153 117.693 113.59 115.641 115.643C113.588 117.695 111.151 119.322 108.468 120.43C105.785 121.539 102.91 122.106 100.008 122.1V122.1Z"}))}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Sound.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react"));t.default=e=>{var{className:t}=e,i=r.__rest(e,["className"]);return s.default.createElement("svg",Object.assign({className:""+(null!=t&&t),"data-icon":"volume",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 200 200"},i),s.default.createElement("path",{fill:"currentColor",d:"M77.1969 42.2038L49.3937 69.9993H17.5C13.3562 69.9993 10 73.3554 10 77.499V122.497C10 126.637 13.3562 129.997 17.5 129.997H49.3937L77.1969 157.792C81.8937 162.489 90 159.189 90 152.489V47.5066C90 40.8007 81.8875 37.5134 77.1969 42.2038ZM150.109 26.242C146.619 23.9515 141.928 24.9171 139.637 28.4138C137.344 31.9042 138.319 36.5947 141.809 38.8852C162.519 52.4752 174.878 75.321 174.878 100.001C174.878 124.681 162.519 147.527 141.809 161.117C138.319 163.404 137.344 168.098 139.637 171.585C141.837 174.932 146.491 176.135 150.109 173.757C175.084 157.364 190 129.787 190 99.9979C190 70.2087 175.084 42.635 150.109 26.242ZM160 99.9979C160 80.1457 149.981 61.8935 133.197 51.1752C129.7 48.9441 125.062 49.9815 122.847 53.5064C120.631 57.0312 121.666 61.6966 125.162 63.9309C137.584 71.8649 145 85.3455 145 99.9979C145 114.65 137.584 128.131 125.162 136.065C121.666 138.296 120.631 142.962 122.847 146.489C124.881 149.727 129.447 151.221 133.197 148.821C149.981 138.102 160 119.853 160 99.9979ZM115.697 75.9772C112.078 73.9991 107.512 75.3022 105.506 78.9302C103.509 82.5581 104.831 87.1173 108.459 89.1203C112.494 91.3358 115 95.5075 115 99.9979C115 104.491 112.494 108.66 108.462 110.876C104.834 112.879 103.513 117.438 105.509 121.066C107.519 124.709 112.087 126.003 115.7 124.019C124.522 119.16 130.003 109.957 130.003 99.9948C130.003 90.0328 124.522 80.8332 115.697 75.9772Z"}))}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/SoundOff.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react"));t.default=e=>{var{className:t}=e,i=r.__rest(e,["className"]);return s.default.createElement("svg",Object.assign({"aria-hidden":"true",className:""+(null!=t&&t),"data-icon":"volume-off",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 200 200"},i),s.default.createElement("path",{fill:"currentColor",d:"M77.1962 42.2018L49.3934 69.999H17.4999C13.3562 69.999 10 73.3553 10 77.4991V122.499C10 126.64 13.3562 130 17.4999 130H49.3934L77.1962 157.797C81.8931 162.494 89.9992 159.194 89.9992 152.494V47.505C89.9992 40.7987 81.8868 37.5112 77.1962 42.2018ZM154.261 99.9993L168.523 85.7366C170.492 83.7679 170.492 80.5741 168.523 78.6053L161.392 71.474C159.424 69.5052 156.23 69.5052 154.261 71.474L139.999 85.7366L125.736 71.474C123.768 69.5052 120.574 69.5052 118.605 71.474L111.474 78.6053C109.505 80.5741 109.505 83.7679 111.474 85.7366L125.736 99.9993L111.477 114.259C109.508 116.228 109.508 119.421 111.477 121.39L118.608 128.521C120.577 130.49 123.771 130.49 125.739 128.521L139.999 114.262L154.261 128.525C156.23 130.493 159.424 130.493 161.392 128.525L168.523 121.393C170.492 119.424 170.492 116.231 168.523 114.262L154.261 99.9993Z"}))}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react")),o=i("./node_modules/@video/video-client-web/lib/ui/styling/videoStyles.js"),n=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Broadcast.js")),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Camera.js")),l=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/CameraOff.js")),d=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Clock.js")),c=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Close.js")),u=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Collapse.js")),p=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Configuration.js")),h=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Expand.js")),m=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Microphone.js")),v=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/MicrophoneOff.js")),g=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Pause.js")),f=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Play.js")),b=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Recorder/Delete.js")),_=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Recorder/Pause.js")),y=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Recorder/Record.js")),w=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Recorder/Save.js")),S=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Recorder/Start.js")),E=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/ScreenCapture.js")),C=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Settings.js")),j=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/Sound.js")),P=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/SoundOff.js")),R=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/styles.js"));t.default=({classes:e={},title:t,iconName:i})=>{const r={broadcast:n.default,camera:a.default,cameraoff:l.default,clock:d.default,close:c.default,configuration:p.default,collapse:u.default,expand:h.default,microphone:m.default,microphoneoff:v.default,play:f.default,recorderstart:S.default,recorderpause:_.default,recorderdelete:b.default,recordersave:w.default,pause:g.default,screencapture:E.default,settings:C.default,sound:j.default,soundoff:P.default,record:y.default},x=i.toLowerCase(),D=r[i];let T;"screencapture"===x&&(T=Object.assign(Object.assign({},R.default),{icon:{width:"15px "}}));const I=(0,o.useStyles)({source:e,target:T||R.default},"screencapture"===x?x:"icons");return s.default.createElement("span",{className:""+I.root},s.default.createElement(D,{title:t,className:`${I.icon} ${x}`}))}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/styles.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={root:{display:"flex",fill:"currentColor",transition:"fill 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms",userSelect:"none",alignItems:"center",width:"100%",justifyContent:"center"},"svg:not(:root)":{overflow:"hidden"},icon:{width:"28px"}}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Inputs/Checkbox.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importStar(i("webpack/sharing/consume/default/react/react")),o=i("./node_modules/react-uid/dist/es2015/index.js"),n=i("./node_modules/@video/video-client-web/lib/ui/styling/videoStyles.js"),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Inputs/styles.js"));t.default=e=>{var t,{classes:i={},label:l,checked:d,id:c,title:u,disabled:p}=e,h=r.__rest(e,["classes","label","checked","id","title","disabled"]);const[m,v]=(0,s.useState)(d),g=(0,n.useStyles)({source:i,target:a.default},"checkbox"),f=(0,o.useUID)();return s.default.createElement("div",{className:`${g.root} ${g.fields} ${g.checkbox}`},s.default.createElement("label",{htmlFor:f,className:p?`${g.label} ${g.labelDisabled}`:g.label,title:u},s.default.createElement("input",Object.assign({type:"checkbox",className:""+g.input,id:f,"data-selenium":null!==(t=null==h?void 0:h.tag)&&void 0!==t?t:"checkbox-input",onChange:()=>{void 0!==h.onChange&&h.onChange(),v(d)},checked:m,title:u,disabled:p},h)),l))}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Inputs/PillToggle.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importStar(i("webpack/sharing/consume/default/react/react")),o=i("./node_modules/@video/video-client-web/lib/ui/styling/videoStyles.js"),n={pillWrapper:{width:120,position:"relative",borderTop:"1px solid #eeeeee",display:"flex",alignItems:"center",paddingTop:5,paddingRight:10,paddingLeft:10,paddingBottom:5,background:"#111111"},pill:{marginLeft:10,position:"relative",display:"flex",alignItems:"center",width:35,height:20,borderRadius:20,background:"#111111",border:"solid 1px #eeeeee",transition:"all 0.3s ease-in-out"},pillBall:{position:"absolute",height:14,width:14,left:3,borderRadius:100,background:"#eeeeee",transition:"all 0.3s ease-in-out",transform:"translate(0px, 0px)"},label:{cursor:"default",fontSize:12,color:"#eeeeee",fontFamily:"Lato, Arial, sans-serif"},activePill:{background:"#eeeeee"},activePillBall:{height:16,width:16,borderColor:"#111111",transform:"translate(15px, 0px)",background:"#111111"},disabled:{height:"100%",width:"100%",zIndex:999,background:"rgba(81, 81, 81, 0.5)",cursor:"not-allowed",position:"absolute"}};t.default=function(e){var{disabled:t,classes:i={},className:a="",label:l,handleClick:d,disabledOff:c,disabledOn:u,isActive:p}=e;r.__rest(e,["disabled","classes","className","label","handleClick","disabledOff","disabledOn","isActive"]);const[h,m]=(0,s.useState)(p),v=(0,o.useStyles)({source:i,target:n},"radio");return(0,s.useEffect)([p]),s.default.createElement("div",{className:`${v.pillWrapper} ${a}`,style:{cursor:u||c?"not-allowed":"pointer"}},t&&s.default.createElement("div",{className:v.disabled}),s.default.createElement("div",{className:`${v.label} ${a}`}," ",l," "),s.default.createElement("div",{role:"button",tabIndex:t?-1:0,onKeyDown:e=>"Enter"===e.key&&!u&&!c&&(m(!h),d),onClick:()=>{u||c||(m(!h),null==d||d())},className:`${v.pill} ${a} ${h&&v.activePill}`},s.default.createElement("div",{className:`${v.pillBall} ${a} ${h&&v.activePillBall}`})))}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Inputs/Range.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importStar(i("webpack/sharing/consume/default/react/react")),o=i("./node_modules/@video/video-client-web/lib/ui/styling/videoStyles.js"),n=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Inputs/styles.js")),a=Object.assign(Object.assign({},n.default),{root:{height:"auto"}}),l=(0,s.forwardRef)((e,t)=>{var i,{classes:n={},min:l=0,max:d=1,step:c=.1,label:u,variant:p,classNames:h="",value:m}=e,v=r.__rest(e,["classes","min","max","step","label","variant","classNames","value"]);const g=(0,o.useStyles)({source:n,target:a},"range");return s.default.createElement("div",{className:g.root},s.default.createElement("input",Object.assign({type:"range",ref:t,min:l,max:d,step:c,value:m,className:`${g.range} ${h}`,"data-selenium":null!==(i=v.tag)&&void 0!==i?i:"range-input",onInput:v.onInput,onChange:v.onChange},v)))});t.default=l},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Inputs/Select.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importStar(i("webpack/sharing/consume/default/react/react")),o=i("./node_modules/react-uid/dist/es2015/index.js"),n=i("./node_modules/@video/video-client-web/lib/ui/styling/videoStyles.js"),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Inputs/selectStyles.js")),l=(0,s.forwardRef)((e,t)=>{var{ariaLabel:i,classes:l={root:{},select:{},label:{}},label:d,children:c,onChange:u,value:p,tag:h}=e;r.__rest(e,["ariaLabel","classes","label","children","onChange","value","tag"]);const{root:m,select:v,label:g}=(0,n.useStyles)({source:l,target:a.default},"select"),f=(0,o.useUID)();return s.default.createElement("div",{className:m},null!=d?s.default.createElement("label",{htmlFor:f,className:g},d):null,s.default.createElement("select",{ref:t,id:f,className:v,"aria-label":null!=d?d:"Default select","data-selenium":null!=h?h:"select-input",onChange:u,value:p},c))});t.default=l},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Inputs/SelectNonNative.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js").__importDefault(i("webpack/sharing/consume/default/react/react"));t.default=({className:e,classes:t,children:i})=>r.default.createElement("div",{className:""+e},i)},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Inputs/selectStyles.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={root:{},label:{fontFamily:"sans-serif",fontSize:"0.75rem",marginBottom:0,".dark-shelf &":{color:"white"}},select:{appearance:"none",backgroundImage:"url(data:image/svg+xml;charset=utf-8,%3Csvg%20viewBox%3D%220%200%20200%20200%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cpath%20fill%3D%22%23FCC444%22%20d%3D%22M58.2031%2083.2031H141.797L100%20125L58.2031%2083.2031Z%22%20%2F%3E%3C%2Fsvg%3E)",backgroundPosition:"center right",backgroundRepeat:"no-repeat",backgroundSize:"1.25rem",borderBottom:"1px solid #2b2b2b",borderRadius:"0",color:"#2b2b2b",padding:"0.5rem 1rem",width:"100%",".dark-shelf &":{color:"#f5f5f5",borderBottom:"1px solid #f5f5f5 !important"}}}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Inputs/styles.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={root:{background:"none",border:"none",color:"#2b2b2b",display:"inline-block",height:"2.5rem",padding:"0.5rem 1rem",verticalAlign:"middle",width:"100%"},label:{fontSize:"0.75rem",marginBottom:0,".dark-shelf &":{color:"white"}},labelDisabled:{cursor:"not-allowed"},checkbox:{height:"auto",marginRight:".625rem",padding:0,width:"auto","& $label":{display:"flex",flex:"1 1 auto",alignItems:"center"}},radio:{padding:0,display:"inline-block",border:"1px solid #fff",appearance:"none",width:"0.5rem",height:"0.5rem",marginRight:".625rem",borderRadius:"1rem","&:checked":{border:"1px solid #f5f5f5",background:"#f5f5f5"},"& $label":{display:"flex",flex:"1 1 auto",alignItems:"center"}},range:{width:"auto",padding:"none",height:"auto"},fields:{display:"block",marginBottom:"0.625rem",".video-tippy-popper &":{padding:"0.5rem",marginBottom:0,"&:hover":{backgroundColor:"rgba(255, 255, 255, 0.25)"}},".lv-tippy-popper &":{padding:"0.5rem",marginBottom:0,"&:hover":{backgroundColor:"rgba(255, 255, 255, 0.25)"}}},input:{"&:disabled":{color:"#6b6b6b",opacity:.5,cursor:"not-allowed"}}}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/MediaWrapper/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importStar(i("webpack/sharing/consume/default/react/react")),o=i("./node_modules/@video/video-client-web/lib/ui/styling/videoStyles.js"),n=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/MediaWrapper/styles.js")),a=(0,s.forwardRef)((e,t)=>{var{classes:i}=e,a=r.__rest(e,["classes"]);const{children:l,isFullscreen:d}=a,c=(0,o.useStyles)({source:null!=i?i:{},target:n.default},"mediaWrapper");return s.default.createElement("div",{className:`\n        ${c.root?c.root:""}\n        ${d?"video-fullscreen-mode lv-fullscreen-mode":""}\n      `,ref:t},l)});t.default=a},"./node_modules/@video/video-client-web/lib/ui/ui-lib/MediaWrapper/styles.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={root:{height:"inherit",position:"relative",overflow:"hidden",width:"100%"}}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/PlayerOverlayButton/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react")),o=i("./node_modules/@video/video-client-web/lib/ui/styling/index.js"),n=i("./node_modules/@video/video-client-web/lib/ui/styling/utils.js"),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/PlayerOverlayButton/styles.js")),l=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Icons/index.js"));t.default=function(e){var{classes:t={root:{}},children:i}=e,d=r.__rest(e,["classes","children"]);const c=(0,o.useStyles)({source:t,target:a.default},"playerOverlayButton"),u=(0,n.mergeStylesObjects)(t,a.default);return s.default.createElement("div",Object.assign({},d,{className:`${d.disabled?c.rootDisabled:""} ${c.root}`}),null!=i?i:s.default.createElement(l.default,{iconName:"play",classes:u.overlayPlayIcon}))}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/PlayerOverlayButton/styles.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={root:{backgroundColor:"rgba(0, 0, 0, 0.33)",display:"flex",position:"absolute",top:0,bottom:0,width:"100%",zIndex:"120","&:before":{backgroundSize:"25%",backgroundRepeat:"no-repeat",backgroundPosition:"center center",content:"''",cursor:"pointer",position:"absolute",top:0,right:0,bottom:0,left:0}},rootDisabled:{"&::before":{cursor:"default"}},overlayPlayIcon:{icon:{width:"30%",color:"white"}}}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/SlidingShelf/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react")),o=i("./node_modules/@video/video-client-web/lib/ui/styling/index.js"),n=i("./node_modules/@video/video-client-web/lib/ui/styling/utils.js"),a=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Buttons/Close/index.js")),l=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/SlidingShelf/styles.js"));t.default=function(e){var{className:t="",classes:i={root:{}},onCloseButtonClick:d,open:c,children:u,variant:p="light",height:h,style:m}=e,v=r.__rest(e,["className","classes","onCloseButtonClick","open","children","variant","height","style"]);const g=(0,o.useStyles)({source:i,target:l.default},"slidingShelf"),f=(0,n.mergeStylesObjects)(i,l.default);return s.default.createElement("div",Object.assign({className:`${g.root} ${"dark"===p&&"dark-shelf"} ${c&&"open"} ${t}`},v),s.default.createElement(a.default,{onClick:d,open:c,classes:{root:f.closeButton}}),u)}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/SlidingShelf/styles.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/@video/video-client-core/index.js"),s={root:{backgroundColor:"rgba(255, 255, 255, 0.90)","backdrop-filter":"blur(10px)",boxShadow:"6px 0px 12px 0px rgba(43,43,43,0.33)",fontFamily:"sans-serif",height:"auto",overflow:r.adapter.device.isMobileDevice?"auto":"hidden",transition:"left 1s",transitionProperty:"opacity, left, top",transitionDuration:".33s",transitionTimingFunction:"ease-out",width:"40%",zIndex:140,bottom:0,left:"-100vw",padding:r.adapter.device.isMobileDevice?"15px":"0 1.5rem",position:"absolute",top:0,display:"grid",gap:"10px 0px",gridAutoColumns:"1fr",gridTemplateRows:"1fr 10fr 1fr","@media only screen and (max-width: 768px)":{width:"initial"},"@media only screen and (min-width: 1200px)":{top:0,left:"-100vw",width:"40%","&.open":{left:0}},"&.open":{left:0},"&.dark-shelf":{backgroundColor:"rgba(0, 0, 0, 0.9)"}},closeButton:{width:"15px"}};t.default=s},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Tooltip/Tooltip.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js"),s=r.__importDefault(i("webpack/sharing/consume/default/react/react")),o=i("./node_modules/@video/video-client-web/lib/ui/styling/index.js"),n=r.__importDefault(i("./node_modules/@video/video-client-web/lib/ui/ui-lib/Tooltip/styles.js"));t.default=function({classes:e={},children:t,active:i}){const r=(0,o.useStyles)({source:e,target:n.default},"tooltip");return s.default.createElement("div",{className:`${r.root} ${i?"active":"inactive"}`},t)}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/Tooltip/styles.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={root:{transition:"opacity 0.3s ease-in-out, transform 0.5s ease-in-out",position:"absolute",bottom:"50px","&.active":{opacity:1},"&.inactive":{transform:"translateY(50px)",opacity:0,visibility:"hidden"}}}},"./node_modules/@video/video-client-web/lib/ui/ui-lib/VideoWrapper/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i("./node_modules/tslib/tslib.es6.js").__importStar(i("webpack/sharing/consume/default/react/react")),s=i("./node_modules/@video/video-client-web/lib/ui/context/index.js"),o=i("./node_modules/@video/video-client-web/lib/ui/styling/videoStyles.js"),n=i("./node_modules/@video/video-client-web/lib/ui/ui-lib/VideoWrapper/styles.js"),a=(0,r.forwardRef)(({onClick:e,variant:t,children:i,isFullScreen:a,classes:l,style:d,pillarBox:c=!1,elementBlur:u=!1,blurPixels:p=11,mirror:h},m)=>{const v=(0,r.useContext)(s.PlayerUiContext),g=(0,r.useContext)(s.EncoderUiContext),f=null!=v?v:g,b=(0,n.videoWrapperStyles)(c,a,h,u,p),_=(0,o.useStyles)({source:null!=l?l:{},target:b},"videoWrapper");return r.default.createElement("div",{onMouseEnter:()=>{null!=f&&(f.videoMouseOver=!0)},onMouseLeave:()=>{null!=f&&(f.videoMouseOver=!1)},className:`\n      ${_.root?_.root:""}\n      ${null!=t?`video-${t} lv-${t}`:""}\n    `,"data-selenium":"video-element",onClick:e,onKeyDown:void 0,style:d,role:"button",tabIndex:0,ref:m},i)});a.displayName="VideoWrapper",t.default=a},"./node_modules/@video/video-client-web/lib/ui/ui-lib/VideoWrapper/styles.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.videoWrapperStyles=void 0;t.videoWrapperStyles=(e,t,i,r,s)=>{let o={},n={};t?(o={height:"inherit",width:"100%",overflow:"hidden",lineHeight:0},n=e?{width:"100%",height:"100%",backgroundColor:"black",position:"absolute",transform:i?"rotateY(180deg)":"rotateY(0deg)","&:before":{display:"block",content:'""',paddingTop:"0",paddingRight:"0",paddingLeft:"0"},"&::-webkit-media-controls":{display:"none","-webkit-appearance":"none"},"&::-webkit-media-controls-play-button":{display:"none","-webkit-appearance":"none"},"&::-webkit-media-controls-start-playback-button":{display:"none","-webkit-appearance":"none"},"&::-webkit-media-controls-container":{display:"none","-webkit-appearance":"none"},filter:r?`blur(${s}px)`:null}:{width:"100%",height:"100%",objectFit:"cover",backgroundColor:"black",top:0,left:"50%",position:"relative",transform:i?"rotateY(180deg) translate(50%, 0)":"rotateY(0deg) translate(-50%, 0)",transition:"all 0.3s ease-in-out",filter:r?`blur(${s}px)`:null}):(o={width:"100%",height:"100%",lineHeight:0,backgroundColor:"black","&.preview":{position:"relative",zIndex:130,"@media only screen and (min-width: 600px)":{position:"absolute","&.right":{top:"1rem",right:"1rem",width:"25%"},"&.left":{top:"1rem",left:"1rem",width:"25%"}}}},n=e?{width:"100%",height:"100%",backgroundColor:"black",position:"absolute",transform:i?"rotateY(180deg)":"rotateY(0deg)","&:before":{display:"block",content:'""',paddingTop:"0",paddingRight:"0",paddingLeft:"0"},"&::-webkit-media-controls":{display:"none","-webkit-appearance":"none"},"&::-webkit-media-controls-play-button":{display:"none","-webkit-appearance":"none"},"&::-webkit-media-controls-start-playback-button":{display:"none","-webkit-appearance":"none"},"&::-webkit-media-controls-container":{display:"none","-webkit-appearance":"none"},filter:r?`blur(${s}px)`:null}:{width:"100%",height:"100%",objectFit:"cover",backgroundColor:"black",top:0,left:"50%",position:"relative",transform:i?"rotateY(180deg) translate(50%, 0)":"translate(-50%, 0)",filter:r?`blur(${s}px)`:null});return{root:o,videoElement:n}};const i=(0,t.videoWrapperStyles)(!1,!1,!1,!1,11);t.default=i},"./node_modules/@video/webrtc-stats/index.js":"./node_modules/@video/webrtc-stats/lib/index.js":(e,t,i)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.WebRTCStats=void 0;const s=i("./node_modules/tslib/tslib.es6.js"),o=i("./node_modules/@video/events-typed/index.js"),n=s.__importDefault(i("./node_modules/throttled-queue/dist/throttledQueue.js")),a=i("./node_modules/@video/webrtc-stats/lib/utils.js"),l=null!==(r=globalThis)&&void 0!==r?r:);class d extends o.EventEmitter{constructor(e){if(super(),this._getStatsInterval=5e3,this.connectionMonitoringSetInterval=0,this.connectionMonitoringInterval=1e3,this.remote=!0,this.peersToMonitor={},this.timeline=[],this.statsToMonitor=["inbound-rtp","outbound-rtp","remote-inbound-rtp","remote-outbound-rtp","peer-connection","data-channel","stream","track","sender","receiver","transport","candidate-pair","local-candidate","remote-candidate"],this.peerConnectionListeners={},"undefined"==typeof window)throw new Error("WebRTCStats only works in browser");const t=Object.assign({},e);this.isEdge=!!l.RTCIceGatherer,this.getStatsInterval=t.getStatsInterval||1e3,this.rawStats=!!t.rawStats,this.statsObject=!!t.statsObject,this.filteredStats=!!t.filteredStats,this.shouldWrapGetUserMedia=!!t.wrapGetUserMedia,"boolean"==typeof t.remote&&(this.remote=t.remote),this.debug=!!t.debug,this.logLevel=t.logLevel||"none",this.shouldWrapGetUserMedia&&this.wrapGetUserMedia()}addPeer(e){var t,i,r;return s.__awaiter(this,void 0,void 0,(function*(){const s=e.peerId;let o=e.sendTransport,n=e.recvTransport,a=null===(t=null==o?void 0:o.handler)||void 0===t?void 0:t._pc,l=null===(i=null==n?void 0:n.handler)||void 0===i?void 0:i._pc,{remote:d}=e;const c=null===(r=this.peersToMonitor[s])||void 0===r?void 0:r.info;if(c&&(null!=c.send&&null==o&&(o=c.send,a=o._pc),null!=c.recv&&null==n&&(n=c.recv,l=n._pc)),!s)throw new Error("Missing argument peerId");if(d="boolean"==typeof d?d:this.remote,!(a instanceof RTCPeerConnection||l instanceof RTCPeerConnection))throw new Error("At least one Transport argument is missing or incorrect");const u={send:o,recv:n,sendPC:a,recvPC:l,peerId:s};if(this.isEdge)throw new Error("Can't monitor peers in Edge at this time.");null!=c&&this.removePeer(c.peerId);const p=null==a?void 0:a.getConfiguration(),h=null==l?void 0:l.getConfiguration();(null==p?void 0:p.iceServers)&&p.iceServers.forEach((function(e){delete e.credential})),(null==h?void 0:h.iceServers)&&h.iceServers.forEach((),this.emitEvent({event:"addPeer",tag:"peer",peerId:s,data:{options:e,sendConfig:p,recvConfig:h}}),this.monitorPeer(u,{remote:d})}))}getTimeline(e){return this.timeline=this.timeline.sort((e,t)=>{var i,r,s,o;return(null!==(r=null===(i=e.timestamp)||void 0===i?void 0:i.getTime())&&void 0!==r?r:0)-(null!==(o=null===(s=t.timestamp)||void 0===s?void 0:s.getTime())&&void 0!==o?o:0)}),e?this.timeline.filter(t=>t.tag===e):this.timeline}monitorPeer(e,t){this.peersToMonitor[e.peerId]={info:e,stream:null,stats:{parsed:null,raw:null},options:t},this.addPeerConnectionEventListeners(e),1===Object.keys(this.peersToMonitor).length&&(this.startStatsMonitoring(),this.startConnectionStateMonitoring())}startStatsMonitoring(){this.monitoringSetInterval||(this.monitoringSetInterval=window.setInterval(()=>{Object.keys(this.peersToMonitor).length||this.stopStatsMonitoring(),this.getStats().then(},this._getStatsInterval))}stopStatsMonitoring(){this.monitoringSetInterval&&(window.clearInterval(this.monitoringSetInterval),this.monitoringSetInterval=0)}getStats(e=null){var t,i,r,o;return s.__awaiter(this,void 0,void 0,(function*(){this.logger.info(e?"Getting stats from peer "+e:"Getting stats from all peers");let s={};if(e){if(s[e]=this.peersToMonitor[e],!s[e])throw new Error(`Cannot get stats. Peer with id ${e} does not exist`)}else s=this.peersToMonitor;const l=[];for(const e in s){const s=this.peersToMonitor[e],d=s.info.send,c=s.info.recv;if(!this.isConnectionClosed(s.info))try{const u={},p=Array.from(null!==(t=null==d?void 0:d._producers)&&void 0!==t?t:new Map,([e,t])=>t),h=Array.from(null!==(i=null==c?void 0:c._consumers)&&void 0!==i?i:new Map,,m=n.default(1,this._getStatsInterval/(p.length+h.length)),v=Promise.all(p.map(e=>m(()=>e.getStats()))),g=Promise.all(h.map(),[f,b]=yield Promise.all([v,g]);for(let e=0;e<f.length;e++)f[e]=a.map2obj(f[e],{producerId:p[e].id,appData:p[e].appData,track:null===(r=p[e].track)||void 0===r?void 0:r.getSettings()},u);for(let e=0;e<b.length;e++)b[e]=a.map2obj(b[e],{consumerId:h[e].id,appData:h[e].appData,track:null===(o=h[e].track)||void 0===o?void 0:o.getSettings()},u);const _=[...f,...b];if(Object.keys(u).length>0){const t={remote:s.options.remote},i=a.parseStats(_,s.stats.parsed,t),r={event:"stats",tag:"stats",peerId:e,data:i,prev:s.stats.parsed};this.rawStats&&(r.rawStats=_),this.statsObject&&(r.statsObject=u),this.filteredStats&&(r.filteredStats=this.filteroutStats(u)),l.push(r),s.stats.parsed=i}else this.logger.error(`PeerConnection from peer ${e} did not return any stats data`)}catch(e){this.logger.error(e)}}return l}))}startConnectionStateMonitoring(){this.connectionMonitoringSetInterval=window.setInterval(()=>{Object.keys(this.peersToMonitor).length||this.stopConnectionStateMonitoring();for(const e in this.peersToMonitor){const t=this.peersToMonitor[e].info;this.isConnectionClosed(t)}},this.connectionMonitoringInterval)}isConnectionClosed(e){var t,i;if((null==e.send||e.send.closed)&&(null==e.recv||e.recv.closed)){const r="onconnectionstatechange";return this.emitEvent({event:r,tag:"connection",peerId:e.peerId,data:"closed",appData:{send:null===(t=e.send)||void 0===t?void 0:t.appData,recv:null===(i=e.recv)||void 0===i?void 0:i.appData}}),this.removePeer(e.peerId),!0}return!1}rapGetUserMedia(){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)return void this.logger.warn("'navigator.mediaDevices.getUserMedia' is not available in browser. Will not wrap getUserMedia.");this.logger.info("Wrapping getUsermedia functions.");const e=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices),t=this.parseGetUserMedia.bind(this);navigator.mediaDevices.getUserMedia=function(){return t({constraints:arguments[0]}),e.apply(navigator.mediaDevices,arguments).then(e=>(t({error:e}),Promise.reject(e)))}.bind(navigator.mediaDevices)}filteroutStats(e={}){const t=Object.assign({},e);for(const e in t){const i=t[e];this.statsToMonitor.includes(null==i?void 0:i.type)||delete t[e]}return t}get peerConnectionListenersMap(){return{icecandidate:(e,t,i,r)=>{this.logger.debug("[pc-event] icecandidate | peerId: ${peerId}",r),this.emitEvent({event:"onicecandidate",tag:"connection",peerId:i,data:r.candidate,appData:e.appData})},track:(e,t,i,r)=>{this.logger.debug("[pc-event] track | peerId: "+i,r);const s=r.track,o=r.streams[0];this.peersToMonitor[i].stream=o,this.addTrackEventListeners(s),this.emitEvent({event:"ontrack",tag:"track",peerId:i,data:{stream:o?this.getStreamDetails(o):null,track:s?this.getMediaTrackDetails(s):null,title:`${r.track.kind}:${r.track.id} ${r.streams.map(()}`},appData:e.appData})},signalingstatechange:(e,t,i,r)=>{this.logger.debug("[pc-event] signalingstatechange | peerId: "+i),this.emitEvent({event:"onsignalingstatechange",tag:"connection",peerId:i,data:{signalingState:t.signalingState,localDescription:t.localDescription,remoteDescription:t.remoteDescription},appData:e.appData})},iceconnectionstatechange:(e,t,i,r)=>{this.logger.debug("[pc-event] iceconnectionstatechange | peerId: "+i),this.emitEvent({event:"oniceconnectionstatechange",tag:"connection",peerId:i,data:t.iceConnectionState,appData:e.appData})},icegatheringstatechange:(e,t,i,r)=>{this.logger.debug("[pc-event] icegatheringstatechange | peerId: "+i),this.emitEvent({event:"onicegatheringstatechange",tag:"connection",peerId:i,data:t.iceGatheringState,appData:e.appData})},icecandidateerror:(e,t,i,r)=>{this.logger.debug("[pc-event] icecandidateerror | peerId: "+i),this.emitEvent({event:"onicecandidateerror",tag:"connection",peerId:i,error:{errorCode:r.errorCode},appData:e.appData})},connectionstatechange:(e,t,i,r)=>{this.logger.debug("[pc-event] connectionstatechange | peerId: "+i),this.emitEvent({event:"onconnectionstatechange",tag:"connection",peerId:i,data:t.connectionState,appData:e.appData})},negotiationneeded:(e,t,i,r)=>{this.logger.debug("[pc-event] negotiationneeded | peerId: "+i),this.emitEvent({event:"onnegotiationneeded",tag:"connection",peerId:i,appData:e.appData})},datachannel:(e,t,i,r)=>{this.logger.debug("[pc-event] datachannel | peerId: "+i,r),this.emitEvent({event:"ondatachannel",tag:"datachannel",peerId:i,data:r.channel,appData:e.appData})}}}addPeerConnectionEventListeners(e){const t=e.peerId;this.logger.info(`Adding new peer with ID ${t}.`),this.logger.debug("Newly added PeerConnection",e.peerId),Object.keys(this.peerConnectionListenersMap).forEach(i=>{if(null==this.peerConnectionListeners[t]&&(this.peerConnectionListeners[t]={send:{},recv:{}}),null!=e.send&&null!=e.sendPC){const r=this.peerConnectionListenersMap[i].bind(this,e.send,e.sendPC,e.peerId);this.peerConnectionListeners[t].send[i]=r,e.sendPC.addEventListener(i,r)}if(null!=e.recv&&null!=e.recvPC){const r=this.peerConnectionListenersMap[i].bind(this,e.recv,e.recvPC,e.peerId);this.peerConnectionListeners[t].recv[i]=r,e.recvPC.addEventListener(i,r)}})}parseGetUserMedia(e){const t={event:"getUserMedia",tag:"getUserMedia",data:Object.assign({},e)};e.stream&&(t.data.details=this.parseStream(e.stream)),this.emitEvent(t)}parseStream(e){const t={audio:[],video:[]};return e.getTracks().forEach(e=>{t[e.kind].push(this.getMediaTrackDetails(e))}),t}getMediaTrackDetails(e){return{enabled:e.enabled,id:e.id,contentHint:e.contentHint,kind:e.kind,label:e.label,muted:e.muted,readyState:e.readyState,constructorName:e.constructor.name,capabilities:e.getCapabilities?e.getCapabilities():{},constraints:e.getConstraints?e.getConstraints():{},settings:e.getSettings?e.getSettings():{},_track:e}}getStreamDetailsddTrackEventListeners(e){e.addEventListener("mute",e=>{this.emitEvent({event:"mute",tag:"track",data:{event:e}})}),e.addEventListener("unmute",e=>{this.emitEvent({event:"unmute",tag:"track",data:{event:e}})}),e.addEventListener("overconstrained",e=>{this.emitEvent({event:"overconstrained",tag:"track",data:{event:e}})}),e.addEventListener("ended",e=>{this.emitEvent({event:"ended",tag:"track",data:{event:e}})})}mitEvent(e){const t=Object.assign(Object.assign({},e),{timestamp:new Date});this.addToTimeline(t),t.tag&&this.emit(t.tag,t)}set getStatsInterval(e){if(!Number.isInteger(e))throw new Error("getStatsInterval should be an integer, got: "+e);this._getStatsInterval=e,this.monitoringSetInterval&&(this.stopStatsMonitoring(),this.startStatsMonitoring())}get logger(){const e=e=>{const t=["none","error","warn","info","debug"];return t.slice(0,t.indexOf(this.logLevel)+1).indexOf(e)>-1},t=this;return{error(...i){t.debug&&e("error")&&console.error("[webrtc-stats][error] ",...i)},warn(...i){t.debug&&e("warn")&&console.warn("[webrtc-stats][warn] ",...i)},info(...i){t.debug&&e("info")&&console.log("[webrtc-stats][info] ",...i)},debug(...i){t.debug&&e("debug")&&console.debug("[webrtc-stats][debug] ",...i)}}}removePeer(e){if(this.logger.info(`Removing PeerConnection with id ${e}.`),!this.peersToMonitor[e])return;const t=this.peersToMonitor[e].info.sendPC,i=this.peersToMonitor[e].info.recvPC;Object.keys(this.peerConnectionListeners).forEach(r=>{const s=this.peerConnectionListeners[e].send[r];null!=s&&(null==t||t.removeEventListener(r,s),delete this.peerConnectionListeners[e].send[r]);const o=this.peerConnectionListeners[e].recv[r];null!=o&&(null==i||i.removeEventListener(r,o),delete this.peerConnectionListeners[e].recv[r])}),delete this.peerConnectionListeners[e],delete this.peersToMonitor[e]}}t.WebRTCStats=d},"./node_modules/@video/webrtc-stats/lib/utils.js":(e,t)=>{"use strict";function i(e,t){if(!e||!t)return{};const i=Object.assign({},e);if(i.localCandidateId){const e=t.get(i.localCandidateId);i.local=Object.assign({},e)}if(i.remoteCandidateId){const e=t.get(i.remoteCandidateId);i.remote=Object.assign({},e)}return i}function r(e,t,i){const r=e[i],s=t?t[i]:null;return"number"!=typeof r||"number"!=typeof s||null==e.timestamp||null==(null==t?void 0:t.timestamp)?null:(r-s)/(e.timestamp-t.timestamp)*1e3}function s(e,t,i){const s=r(e,t,i);return null!=s?8*s:null}function o(e,t,r,o={}){var n,a;for(const r of t.values())switch(r.type){case"outbound-rtp":{const i=r.mediaType||r.kind,s={};if(!["audio","video"].includes(i))continue;if(r.codecId){const e=t.get(r.codecId);e&&(s.clockRate=e.clockRate,s.mimeType=e.mimeType,s.payloadType=e.payloadType)}e[i].outbound.push(Object.assign(Object.assign({},r),s));break}case"inbound-rtp":{let s=r.mediaType||r.kind;const o={};if(!["audio","video"].includes(s))if(r.id.includes("Video"))s="video";else{if(!r.id.includes("Audio"))continue;s="audio"}if(r.codecId){const e=t.get(r.codecId);e&&(o.clockRate=e.clockRate,o.mimeType=e.mimeType,o.payloadType=e.payloadType)}if(!e.connection.id&&r.transportId){const s=t.get(r.transportId);if(s&&s.selectedCandidatePairId){const r=t.get(s.selectedCandidatePairId);e.connection=i(r,t)}}e[s].inbound.push(Object.assign(Object.assign({},r),o));break}case"peer-connection":e.connection.dataChannelsClosed=r.dataChannelsClosed,e.connection.dataChannelsOpened=r.dataChannelsOpened;break;case"remote-inbound-rtp":{if(!(null==o?void 0:o.remote))break;let s=r.mediaType||r.kind;const a={};if(!["audio","video"].includes(s))if(r.id.includes("Video"))s="video";else{if(!r.id.includes("Audio"))continue;s="audio"}if(r.codecId){const e=t.get(r.codecId);e&&(a.clockRate=e.clockRate,a.mimeType=e.mimeType,a.payloadType=e.payloadType)}if(!e.connection.id&&r.transportId){const s=t.get(r.transportId);if(s&&s.selectedCandidatePairId){const r=t.get(s.selectedCandidatePairId);e.connection=i(r,t)}}null===(n=e.remote)||void 0===n||n[s].inbound.push(Object.assign(Object.assign({},r),a));break}case"remote-outbound-rtp":{if(!(null==o?void 0:o.remote))break;const i=r.mediaType||r.kind,s={};if(!["audio","video"].includes(i))continue;if(r.codecId){const e=t.get(r.codecId);e&&(s.clockRate=e.clockRate,s.mimeType=e.mimeType,s.payloadType=e.payloadType)}null===(a=e.remote)||void 0===a||a[i].outbound.push(Object.assign(Object.assign({},r),s));break}}if(!e.connection.id)for(const r of t.values())"candidate-pair"===r.type&&r.nominated&&"succeeded"===r.state&&!1!==r.selected&&(e.connection=i(r,t));!function(e,t){null!=t&&(e.audio.inbound.map(e=>{let i=t.audio.inbound.find(t=>t.id===e.id);e.bitrate=s(e,i,"bytesReceived"),e.packetRate=s(e,i,"packetsReceived")}),e.audio.outbound.map(e=>{let i=t.audio.outbound.find(t=>t.id===e.id);e.bitrate=s(e,i,"bytesSent"),e.packetRate=s(e,i,"packetsSent")}),e.video.inbound.map(e=>{let i=t.video.inbound.find(t=>t.id===e.id);e.bitrate=s(e,i,"bytesReceived"),e.packetRate=s(e,i,"packetsReceived")}),e.video.outbound.map(e=>{let i=t.video.outbound.find(t=>t.id===e.id);e.bitrate=s(e,i,"bytesSent"),e.packetRate=s(e,i,"packetsSent")}))}(e,null!=r?r:null)}Object.defineProperty(t,"__esModule",{value:!0}),t.parseStats=t.map2obj=t.computeBitrate=t.computeRate=void 0,t.computeRate=r,t.computeBitrate=s,t.map2obj=function(e,t,i){if(!e.entries)return e;const r=new Map;return e.forEach((function(e,s){const o=Object.assign({},e,t);i[s]=o,r.set(s,o)})),r},t.parseStats=function(e,t,i={}){let r={audio:{inbound:[],outbound:[]},video:{inbound:[],outbound:[]},connection:{inbound:[],outbound:[]}};(null==i?void 0:i.remote)&&(r.remote={audio:{inbound:[],outbound:[]},video:{inbound:[],outbound:[]}});for(const s of e)o(r,s,t,i);return r}},"./node_modules/vscode-jsonrpc/lib/events.js":(e,t)=>{"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,(o=s.key,n=void 0,n=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!==i(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===i(n)?n:String(n)),s)}var o,n}function o(e,t,i){return t&&s(e.prototype,t),i&&s(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}Object.defineProperty(t,"__esModule",{value:!0}),t.Disposable||(t.Disposable={})),function(e){var t={dispose:function(){}};e.None=(t.Event||(t.Event={}));var n=function(){eturn o(e,[{key:"add",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2?arguments[2]:void 0;this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(i),Array.isArray(r)&&r.push({dispose:)}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this._callbacks){for(var i=!1,r=0,s=this._callbacks.length;r<s;r++)if(this._callbacks[r]===e){if(this._contexts[r]===t)return this._callbacks.splice(r,1),void this._contexts.splice(r,1);i=!0}if(i)throw new Error("When adding a listener with a context, you should remove it with the same context")}}},{key:"invoke",value:function(){if(!this._callbacks)return[];for(var e=[],t=this._callbacks.slice(0),i=this._contexts.slice(0),r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];for(var n=0,a=t.length;n<a;n++)try{e.push(t[n].apply(i[n],s))}catch(e){console.error(e)}return e}},{key:"isEmpty",value:,{key:"dispose",value:]),e}(),a=function(){eturn o(e,[{key:"event",get:function(){var t=this;return this._event||(this._event=function(i,r,s){var o;return t._callbacks||(t._callbacks=new n),t._options&&t._options.onFirstListenerAdd&&t._callbacks.isEmpty()&&t._options.onFirstListenerAdd(t),t._callbacks.add(i,r),o={dispose:function(){t._callbacks&&(t._callbacks.remove(i,r),o.dispose=e._noop,t._options&&t._options.onLastListenerRemove&&t._callbacks.isEmpty()&&t._options.onLastListenerRemove(t))}},Array.isArray(s)&&s.push(o),o}),this._event}},{key:"fire",value:,{key:"dispose",value:]),e}();t.Emitter=a,a._noop=function(){}},"./node_modules/vscode-jsonrpc/lib/is.js":(e,t)=>{"use strict";ject.defineProperty(t,"__esModule",{value:!0}),t.boolean=t.string=i,t.number=t.error=t.func=t.array=r,t.stringArray=function(e){return r(e)&&e.every(()}},"./node_modules/vscode-jsonrpc/lib/messageReader.js":(e,t,i)=>{"use strict";var r=i("./node_modules/buffer/index.js").Buffer;fineProperty(t,"__esModule",{value:!0});var h=i("./node_modules/vscode-jsonrpc/lib/events.js"),m=i("./node_modules/vscode-jsonrpc/lib/is.js"),v=r.from("\r","ascii")[0],g=r.from("\n","ascii")[0],f=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"utf8";c(this,e),this.encoding=t,this.index=0,this.buffer=r.allocUnsafe(8192)}return p(e,[{key:"append",value:function(e){var t=e;if("string"==typeof e){var i=e,s=r.byteLength(i,this.encoding);(t=r.allocUnsafe(s)).write(i,0,s,this.encoding)}if(this.buffer.length-this.index>=t.length)t.copy(this.buffer,this.index,0,t.length);else{var o=8192*(Math.ceil((this.index+t.length)/8192)+1);0===this.index?(this.buffer=r.allocUnsafe(o),t.copy(this.buffer,0,0,t.length)):this.buffer=r.concat([this.buffer.slice(0,this.index),t],o)}this.index+=t.length}},{key:"tryReadHeaders",value:function(){for(var e=void 0,t=0;t+3<this.index&&(this.buffer[t]!==v||this.buffer[t+1]!==g||this.buffer[t+2]!==v||this.buffer[t+3]!==g);)t++;if(t+3>=this.index)return e;e=Object.create(null),this.buffer.toString("ascii",0,t).split("\r\n").forEach((function(t){var i=t.indexOf(":");if(-1===i)throw new Error("Message header must separate key and value using :");var r=t.substr(0,i),s=t.substr(i+1).trim();e[r]=s}));var i=t+4;return this.buffer=this.buffer.slice(i),this.index=this.index-i,e}},{key:"tryReadContent",value:function(e){if(this.index<e)return null;var t=this.buffer.toString(this.encoding,0,e),i=e;return this.buffer.copy(this.buffer,0,i),this.index=this.index-i,t}},{key:"numberOfBytes",get:function(){return this.index}}]),e}();!function(e){e.is=function(e){var t=e;return t&&m.func(t.listen)&&m.func(t.dispose)&&m.func(t.onError)&&m.func(t.onClose)&&m.func(t.onPartialMessage)}}(t.MessageReader||(t.MessageReader={}));var b=function(){function e(){c(this,e),this.errorEmitter=new h.Emitter,this.closeEmitter=new h.Emitter,this.partialMessageEmitter=new h.Emitter}return p(e,[{key:"dispose",value:,{key:"onError",get:function(){return this.errorEmitter.event}},{key:"fireError",value:,{key:"onClose",get:function(){return this.closeEmitter.event}},{key:"fireClose",value:,{key:"onPartialMessage",get:,{key:"firePartialMessage",value:,{key:"asError",value:function(e){return e instanceof Error?e:new Error("Reader received error. Reason: ".concat(m.string(e.message)?e.message:"unknown"))}}]),e}();t.AbstractMessageReader=b;var _=function(e){s(i,e);var t=n(i);function i(e){var r,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";return c(this,i),(r=t.call(this)).readable=e,r.buffer=new f(s),r._partialMessageTimeout=1e4,r}return p(i,[{key:"partialMessageTimeout",get:set:,{key:"listen",value:function(e){var t=this;this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e,this.readable.on("data",(),this.readable.on("error",(function(e){return t.fireError(e)})),this.readable.on("close",(function(){return t.fireClose()}))}},{key:"onData",value:function(e){for(this.buffer.append(e);;){if(-1===this.nextMessageLength){var t=this.buffer.tryReadHeaders();if(!t)return;var i=t["Content-Length"];if(!i)throw new Error("Header must provide a Content-Length property.");var r=parseInt(i);if(isNaN(r))throw new Error("Content-Length value must be a number.");this.nextMessageLength=r}var s=this.buffer.tryReadContent(this.nextMessageLength);if(null===s)return void this.setPartialMessageTimer();this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.messageToken++;var o=JSON.parse(s);this.callback(o)}}},{key:"clearPartialMessageTimer",value:,{key:"setPartialMessageTimer",value:function(){var e=this;this.clearPartialMessageTimer(),this._partialMessageTimeout<=0||(this.partialMessageTimer=setTimeout((function(t,i){e.partialMessageTimer=void 0,t===e.messageToken&&(e.firePartialMessage({messageToken:t,waitingTime:i}),e.setPartialMessageTimer())}),this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}]),i}(b);t.StreamMessageReader=_;var y=function(e){s(i,e);var t=n(i);function i(e){var r;c(this,i),(r=t.call(this)).process=e;var s=r.process;return s.on("error",(),s.on("close",(),r}return p(i,[{key:"listen",value:]),i}(b);t.IPCMessageReader=y;var w=function(e){s(i,e);var t=n(i);eturn p(i)}(_);t.SocketMessageReader=w},"./node_modules/util-deprecate/browser.js":"./node_modules/websocket-stream/stream.js":(e,t,i)=>{"use strict";var r=i("./node_modules/process/browser.js"),s=i("./node_modules/readable-stream/readable-browser.js").Transform,o=i("./node_modules/duplexify/index.js"),n=i("./node_modules/websocket-stream/ws-fallback.js"),a=i("./node_modules/safe-buffer/index.js").Buffer;e.exports=function(e,t,l){var d,c,u="browser"===r.title,p=!!i.g.WebSocket,h=u?t&&!Array.isArray(t)&&"object"==typeof t&&(l=t,t=null,("string"==typeof l.protocol||Array.isArray(l.protocol))&&(t=l.protocol));l||(l={});void 0===l.objectMode&&(l.objectMode=!(!0===l.binary||void 0===l.binary));var m=l,h,();l.objectMode||(m._writev=E);var v=l.browserBufferSize||524288,g=l.browserBufferTimeout||1e3;"object"==typeof e?c=e:(c=p&&u?new n(e,t):new n(e,t,l)).binaryType="arraybuffer";var f=void 0===c.addEventListener;c.readyState===c.OPEN?d=m:(d=d=o(void 0,void 0,l),l.objectMode||(d._writev=E),f?c.addEventListener("open",_):c.onopen=_);d.socket=c,f?(c.addEventListener("close",y),c.addEventListener("error",w),c.addEventListener("message",S)):(c.onclose=y,c.onerror=w,c.onmessage=S);m.on("close",();var b=!l.objectMode;n d}},"./node_modules/websocket-stream/ws-fallback.js":e=>{var t=null;"undefined"!=typeof WebSocket?t=WebSocket:"undefined"!=typeof MozWebSocket?t=MozWebSocket:"undefined"!=typeof window&&(t=window.WebSocket||window.MozWebSocket),e.exports=t},"./node_modules/wrappy/wrappy.js":"./node_modules/yeast/index.js":]);
//# sourceMappingURL=https://hybridclient.naiadsystems.com/dist/hybrid/3~eaaf811b006f8bf0ac55.js.map