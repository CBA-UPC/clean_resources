(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8376],{92258:18406:21215:function(e,t,a){"use strict";a.d(t,{Z:function(){return SettingsHeader}});var r=a(52322);,86045:function(e,t,a){"use strict";a.d(t,{Z:function(){return SettingsTabs}});var r=a(52322),n=a(51830),s=a(47330),l=a(83122),d=a(53954),i=a(5632);,81291:78066:function(e,t,a){"use strict";a.d(t,{Z:function(){return Modal}});var r=a(52322),n=a(2784),s=a(68810),l=a(64529),d=a(83122),i=a(82002),o=a(89370);}},54297:function(e,t,a){"use strict";a.d(t,{Z:function(){return SearchComboboxMultiple}});var r=a(52322),n=a(2784),s=a(68377),l=a(68810),d=a(99219),i=a(83122),o=a(20851),c=a(6676),u=a.n(c),m=a(18318}},55261:function(e,t,a){"use strict";a.d(t,{V:function(){return s}});var r=a(73235),n=a(66547);function _templateObject(){let e=(0,r._)(["\n    fragment Board on Board {\n  id\n  createdAt\n  updatedAt\n  name\n  displayName\n  description\n  permissionType\n  teamAccess {\n    permission\n    team {\n      id\n      name\n    }\n  }\n  order\n  autoGenerated\n  projectCount\n}\n    "]);return _templateObject=function(){return e},e}let s=(0,n.ZP)(_templateObject())},75433:function(e,t,a){"use strict";a.d(t,{D:function(){return l}});var r=a(73235),n=a(66547),s=a(46678);function _templateObject(){let e=(0,r._)(["\n    fragment BoardProject on BoardProject {\n  createdAt\n  creatorId\n  project {\n    ...ProjectListItem\n  }\n  pinned\n}\n    ",""]);return _templateObject=function(){return e},e}let l=(0,n.ZP)(_templateObject(),s.c)},7652},36763:function(e,t,a){"use strict";a.d(t,{d:function(){return useListBoardProjectsQuery}});var r=a(73235),n=a(66547),s=a(75433),l=a(26806);function _templateObject(){let e=(0,r._)(["\n    query ListBoardProjects($data: BoardProjectListFilterArgs!) {\n  boardProjects(data: $data) {\n    count\n    results {\n      ...BoardProject\n    }\n  }\n}\n    ",""]);return _templateObject=function(){return e},e}let d=(0,n.ZP)(_templateObject(),s.D);function useListBoardProjectsQuery(e){return l.aM({query:d,...e})}},7199:function(e,t,a){"use strict";a.d(t,{H:function(){return useListBoardsQuery}});var r=a(73235),n=a(66547),s=a(55261),l=a(26806);function _templateObject(){let e=(0,r._)(["\n    query ListBoards($workspaceId: String!, $filterForCurrentUser: Boolean) {\n  boards(workspaceId: $workspaceId, filterForCurrentUser: $filterForCurrentUser) {\n    ...Board\n  }\n}\n    ",""]);return _templateObject=function(){return e},e}let d=(0,n.ZP)(_templateObject(),s.V);function useListBoardsQuery(e){return l.aM({query:d,...e})}},58072:function(e,t,a){"use strict";a.d(t,{m:function(){return useListTeamsQuery}});var r=a(73235),n=a(66547),s=a(76526),l=a(26806);function _templateObject(){let e=(0,r._)(["\n    query ListTeams($workspaceId: String!) {\n  teams(workspaceId: $workspaceId) {\n    ...Team\n  }\n}\n    ",""]);return _templateObject=function(){return e},e}let d=(0,n.ZP)(_templateObject(),s.t}},52879:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return E}});var r=a(52322),n=a(18406),s=a(97185),l=a(2784),d=a(23094),i=a(66548),o=a(54297);function SelectBoardProject(e){let{items:t,selected:a,onChange:n}=e;return(0,r.jsx)(o.Z,{allowCreate:!1,field:"name",diffField:"id",items:t,selected:a,onChange:n,placeHolder:"Add product demo"})}function SelectBoardTeam(e){let{items:t,selected:a,onChange:n}=e;return(0,r.jsx)(o.Z,{allowCreate:!1,field:"name",diffField:"id",items:t,selected:a,onChange:n,placeHolder:"Add team"})}var c=a(3016),u=a(78066),m=a(73235),p=a(66547),x=a(26806}let h=(0,p.ZP)(_templateObject());var b=a(55261);function createBoard_templateObject(){let e=(0,m._)(["\n    mutation CreateBoard($data: BoardCreateInput!) {\n  createBoard(data: $data) {\n    ...Board\n  }\n}\n    ",""]);return createBoard_templateObject=function(){return e},e}let f=(0,p.ZP)(createBoard_templateObject(),b.V);function updateBoard_templateObject(){let e=(0,m._)(["\n    mutation UpdateBoard($data: BoardUpdateInput!) {\n  updateBoard(data: $data) {\n    ...Board\n  }\n}\n    ",""]);return updateBoard_templateObject=function(){return e},e}let j=(0,p.ZP)(updateBoard_templateObject(),b.V);var v=a(36763),g=a(84038),y=a(58072),w=a(47330),N=a(86414),B=a(77512),_=a(56958);let C="Untitled",k={name:"",description:"",permissionType:w.xf.Workspace};function BoardDetailsModal(e){var t;let{boardToUpdate:a,open:n,handleClose:s,onReset:d,workspaceId:i,teamsEnabled:o}=e,m=void 0===a,[p,b]=(0,l.useState)(k),[,T]=x.Db(f),[,O]=x.Db(j),[,P]=x.Db(h),[{data:S}]=(0,v.d)({variables:{data:{boardId:(null==a?void 0:a.id)||"",showPinnedFirst:!1}},pause:!a}),[A,F]=(0,l.useState)([]),[{data:Z}]=(0,y.m)({variables:{workspaceId:i},pause:!i}),I=(null==Z?void 0:Z.teams)||[],L=I.ma)),E=A.map(e=>e.id),D=L.filter(e=>!E.includes(e.id)),[$,U]=(0,l.useState)([]),[{data:z}]=(0,g.O)({variables:{data:{workspaceId:i,limit:500,privacy:w.Bp.Workspace}},pause:!i}),M=(null==z?void 0:null===(t=z.projects)||void 0===t?void 0:t.results)||[],R=M.map(e=>({id:e.id,name:e.name||C})),V=$.map(e=>e.id),K=R.filte)),H=(0,l.useCallback)(()=>{b(k),U([]),F([]),d()},[d]);(0,l.useEffect)(()=>{if(a){var e;let{name:t,description:r,permissionType:n,teamAccess:s}=a;b({name:t,description:r||"",permissionType:n}),U(((null==S?void 0:null===(e=S.boardProjects)||void 0===e?void 0:e.results)||[]).map(e=>{let{project:t}=e;return{id:t.id,name:t.name||C}})),F((s||[]).map(e=>e.team))}else H()},[a,null==S?void 0:S.boardProjects,H]);let handleCreateBoard=async()=>{let{name:e,description:t,permissionType:a}=p;return _.A.promise(T({data:{name:e,description:t,workspaceId:i,permissionType:a,teamAccess:A.map(e=>e.id),projects:$.map(e=>e.id)}}).then(e=>{let{data:t,error:a}=e;if(a)throw a;let r=null==t?void 0:t.createBoard;if(!r)throw Error("Board not created");N.Z.track("board_created")}),{loading:"Creating board...",erro),succes"})},handleUpdateBoard=async()=>{var e;if(!a)return;let{name:t,description:r,permissionType:n}=p,s=(a.teamAccess||[]).map(e=>e.team.id),l=A.map(e=>e.id),d=l.filter(e=>!s.includes(e)),o=s.filter(e=>!l.includes(e)),c=(null==S?void 0:null===(e=S.boardProjects)||void 0===e?void 0:e.results)||[],u=c.mad),m=$.mad),x=m.filter(e=>!u.includes(e)),h=u.filter(e=>!m.includes(e)),b=await checkForUnRemovableProjects(h,a.id),f="";if(b.length){let e=new Map;c.forEach(t=>{e.set(t.project.id,t.project.name||"")});let t=b.ma"),a=t.ma)).join(", ");f=b.length>1?"Board updated but product demos\n      } ".concat(a," were not removed because they must be on at least one board."):"Board updated but product demo ".concat(a," was not removed because it must be on at least one board.")}let j=b.length?h.filte)):h;try{(0,_.A)("Updating board...");let{error:e}=await O({data:{id:a.id,workspaceId:i,name:t!=a.name?t:void 0,description:r!=a.description?r:void 0,permissionType:n!=a.permissionType?n:void 0,teamUpdates:{add:d,remove:o},projectUpdates:{add:x,remove:j}}});if(e)throw e;f?_.A.error(f):_.A.success("Updated board")}catch(e){_.A.error("Error updating board")}},checkForUnRemovableProjects=async(e,t)=>{var a;let{data:r}=await P({data:{boardId:t,projectIds:e}}),n=(null==r?void 0:null===(a=r.checkProjectsLastBoard)||void 0===a?void 0:a.projectIds)||[];return n},onSubmit=async()=>{m?await handleCreateBoard():await handleUpdateBoard(),H(),s()},handleChang},q=(0,l.useMemo)(()=>a&&a.autoGenerated?[{value:w.xf.Workspace,name:"Workspace"},{value:w.xf.Team,name:"Teams"},{value:w.xf.Private,name:"Private"}]:[{value:w.xf.Workspace,name:"Workspace"},{value:w.xf.Team,name:"Teams"}],[a]);return(0,r.jsx)(u.Z,{containerClass:"mt-10",title:n?m?"Create Board":"Edit Board":"",open:n,handleClose:s,handleReset:H,handleNext:onSubmit,nextText:m?"Create":"Save",nextDisabled:!p.name,nextOnEnter:!0,children:(0,r.jsxs)("div",{children:[(0,r.jsx)(B.oi,{labelText:"Name",className:"mb-4 w-full",placeholder:"Name",tabIndex:0,name:"name",id:"name",onChang),value:p.name,disabled:a&&a.autoGenerated}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"label-small normal-case",children:"Product Demos"}),(0,r.jsx)(SelectBoardProject,{items:K,selected:$,onChange:U})]}),o&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"workspaceAccess",className:"label-small normal-case",children:"Access level"}),(0,r.jsx)(c.Z,{items:q,buttonClassName:"border-gray-300",selected:p.permissionType,onChange:e=>{let{value:t}=e;b({...p,permissionType:t})},disabled:a&&a.autoGenerated})]}),p.permissionType===w.xf.Team&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("label",{className:"label-small",children:"Teams"}),(0,r.jsx)(SelectBoardTeam,{items:D,selected:A,onChange:F})]})]})]})})}var T=a(99219),O=a(82851);function SortableBoardListItem(e){let{id:t,board:a,userCanEdit:n,handleEdit:s,handleDelete:l}=e,{listeners:d,setNodeRef:o,setActivatorNodeRef:c,transform:u,transition:m}=(0,i.nB)({id:t}),p={transform:O.ux.Transform.toString(u),transition:m};return(0,r.jsx)("div",{className:"relative bg-white px-3 py-3",ref:o,id:t,style:p,children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[n&&(0,r.jsx)("button",{className:"rounded py-1 hover:bg-gray-50",ref:c,...d,children:(0,r.jsx)(T.STC,{className:"h-3.5 w-3.5 text-gray-400"})}),(0,r.jsxs)("div",{className:"ml-3",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:" text-base font-medium text-gray-800",children:a.displayName}),(0,r.jsxs)("div",{className:"ml-2 text-sm text-zinc-500",children:["(",a.projectCount,")"]})]}),a.permissionType===w.xf.Workspace?(0,r.jsx)(Subtext,{title:"Access",description:"Workspace"}):a.permissionType===w.xf.Team&&a.teamAccess?(0,r.jsx)(Subtext,{title:"Teams",description:a.teamAccess.ma}).join(", ")}):(0,r.jsx)(Subtext,{title:"Access",description:"Personal"})]})]}),n&&(0,r.jsxs)("div",{className:"flex divide-x overflow-hidden rounded-md border",children:[(0,r.jsx)(EditButton,{clickHandler:s,disabled:!1}),!a.autoGenerated&&(0,r.jsx)(DeleteButton,{clickHandler:l,disabled:!1})]})]})})}let Subtext=e=>{let{title:t,description:a}=e;return(0,r.jsxs)("div",{className:"mt-1 text-sm font-medium",children:[(0,r.jsxs)("span",{className:"text-zinc-500",children:[t,": "]}),(0,r.jsx)("span",{className:"text-zinc-600",children:a})]})},EditButton=e=>{let{clickHandler:t,disabled:a}=e;return(0,r.jsx)("button",{className:"flex items-center px-2 py-1 hover:bg-slate-100",onClick:t,disabled:a,children:(0,r.jsx)(T.SxV,{className:"h-3.5 w-3.5 text-gray-600"})})},DeleteButton=e=>{let{clickHandler:t,disabled:a}=e;return(0,r.jsx)("button",{className:"flex items-center px-2 hover:bg-slate-100",onClick:t,disabled:a,children:(0,r.jsx)(T.pJl,{className:"h-3.5 w-3.5 text-gray-600"})})};function deleteBoard_templateObject(){let e=(0,m._)(["\n    mutation DeleteBoard($id: String!) {\n  deleteBoard(id: $id) {\n    ...Board\n  }\n}\n    ",""]);return deleteBoard_templateObject=function(){return e},e}let P=(0,p.ZP)(deleteBoard_templateObject(),b.V}let S=(0,p.ZP)(updateBoardOrdering_templateObject(),b.V);var A=a(7199),F=a(53954),Z=a(21215);function SettingsBoards(){var e;let{workspace:t}=(0,F.cF)(),a=(0,F.OC)(t),[n,s]=(0,l.useState)(!1),[o,c]=(0,l.useState)(null),[,u]=x.Db(P),[{data:m,error:p,fetching:h}]=(0,A.H)({variables:{workspaceId:null==t?void 0:t.id},pause:!(null==t?void 0:t.id)}),[b,f]=(0,l.useState)([]);(0,l.useEffect},[m]);let j="product demos",v=(0,d.Dy)((0,d.VT)(d.we)),[,g]=x.Db(S),y=(0,F.j_)(w.KG.Projects),N=y===w.KA.Edit,B=(0,F.cn)(),C=N&&B,k=y===w.KA.None?{}:{"data-testid":"boards-".concat(C?"edit":"view")},T=(null==m?void 0:null===(e=m.boards)||void 0===e?void 0:e.length)===0&&!h,handleDeleteBoard=async e=>{let t=u({id:e}).then(e=>{let{error:t,data:a}=e;if(t)throw t;return a});_.A.promise(t,{loading:"Deleting board...",success:"Deleted board",error:e=>e.message.includes("Board cannot be deleted because it has projects")?"Board cannot be deleted until all its ".concat(j," are removed."):"Failed to delete board"})};return(0,r.jsxs)("div",{className:"mx-auto w-full max-w-3xl",...k,children:[(0,r.jsx)(Z.Z,{title:"Boards",description:"Organize ".concat(j," in your workspace."),Actions:(0,r.jsx)(AddBoardButton,{enabled:!T&&!h&&C,handleClick:()=>s(!0)})}),h?(0,r.jsx)("div",{}):T?(0,r.jsx)(EmptyState,{canEdit:C,handleEdit:()=>s(!0)}):(0,r.jsx)("div",{className:"divide-y divide-gray-200 overflow-hidden rounded-md border",children:(0,r.jsx)(d.LB,{sensors:v,onDragEnd:function(e){let{active:t,over:a}=e;a&&f(e=>{let r=e.findIndex(e=>e.id===t.id),n=e.findInded),s=(0,i.Rp)(e,r,n),l=[];for(let e=0;e<s.length;e++){let t=s[e];t.order!==e&&l.push({id:t.id,order:e})}return l.length&&g({data:l}),s})},children:(0,r.jsx)(i.Fo,{items:b,strategy:i.qw,children:b.map(e=>(0,r.jsx)("div",{className:"bg-white",children:(0,r.jsx)(SortableBoardListItem,{id:e.id,board:e,userCanEdit:C,handleEdi},handleDelet)})},e.id))})})}),(0,r.jsx)(BoardDetailsModal,{open:n,handleClos),onRese),workspaceId:null==t?void 0:t.id,boardToUpdate:o?b.fino):void 0,teamsEnabled:a})]})}let AddBoardButton=e=>{let{enabled:t,handleClick:a}=e;return t?(0,r.jsx)("button",{className:"duration-70 flex items-center justify-between rounded-md border border-zinc-900 bg-zinc-900 px-3 py-2 text-base font-medium text-white transition-all hover:bg-zinc-700 focus:border-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-300",onClick:a,children:"Add board"}):null},EmptyState=e=>{let{canEdit:t,handleEdit:a}=e;return(0,r.jsx)("div",{className:"flex items-center justify-center rounded-md border p-4 text-center text-gray-500 md:p-6",children:(0,r.jsxs)("div",{className:"mx-auto max-w-3xl px-6 py-16 text-center",children:[(0,r.jsx)("div",{className:"text-blue m-auto mb-3 inline-block",children:(0,r.jsx)(T.pso,{className:"h-8 w-8"})}),(0,r.jsx)("h2",{className:"mb-2 text-lg font-semibold text-gray-800",children:"There are no boards in this workspace"}),(0,r.jsx)("div",{className:"mb-7 text-base text-gray-500",children:"Boards are collections of Product Demos that teams can access."}),(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)(AddBoardButton,{enabled:t,handleClick:a})})]})})};var I=a(86045),L=a(81291);function TeamPage(){return(0,r.jsxs)(n.Z,{children:[(0,r.jsx)(L.Z,{title:"Boards",includeSlug:!0}),(0,r.jsx)(I.Z,{children:(0,r.jsx)(SettingsBoards,{})})]})}TeamPage.getLayou};var E=TeamPage}},function(e){e.O(0,[3211,8426,3265,1617,4637,5837,6548,4054,7330,9219,5306,6870,7156,6456,7185,9774,2888,179}),_N_E=e.O()}]);
//# sourceMappingURL=boards-b8b4fec2b5a8b8b9.js.map