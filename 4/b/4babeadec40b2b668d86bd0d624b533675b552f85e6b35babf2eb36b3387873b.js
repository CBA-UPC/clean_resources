(self.webpackChunkcircle=self.webpackChunkcircle||[]).push([[902],{7552:(t,e,n)=>{"use strict";n.r(e);var r=n(67093);class i{constructor(t,e){this.attachment=t,this.element=e,this.directUpload=new r.DirectUpload(t.file,this.directUploadUrl,this)}irectUploadWillStoreFileWithXHR(t){t.upload.addEventListener("progress",(t=>{const e=t.loaded/t.total*100;this.attachment.setUploadProgress(e)}))}directUploadDidComplete(t,e){if(t)throw new Error(`Direct upload failed: ${t}`);this.attachment.setAttributes({sgid:e.attachable_sgid,url:this.createBlobUrl(e.signed_id,e.filename)})}createBlobUrl(t,e){return this.blobUrlTemplate.replace(":signed_id",t).replace(":filename",encodeURIComponent(e))}get directUploadUrl(){return this.element.dataset.directUploadUrl}addEventListener("trix-attachment-add",(t=>{const{attachment:e,target:n}=t;if(e.file){new i(e,n).start()}}))},67093:function(t,e){!function(t){"use strict";ar n=e((function(t,e){!(function(t){var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];ello")),"undefined"===typeof ArrayBuffer||ArrayBuffer.prototype.slice||),f.prototype.append=f.prototype.appendBinary=f.prototype.end=f.prototype.reset=f.prototype.getState=f.prototype.setState=f.prototype.destroy=f.prototype._finish=f.hash=f.hashBinary=f.ArrayBuffer=f.ArrayBuffer.prototype.append=f.ArrayBuffer.prototype.end=f.ArrayBuffer.prototype.reset=f.ArrayBuffer.prototype.getState=f.ArrayBuffer.prototype.setState=f.ArrayBuffer.prototype.destroy=f.prototype.destroy,f.ArrayBuffer.prototype._finish=f.prototype._finish,f.ArrayBuffer.hash=f}))})),r=i=),o=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice,s=function(){eturn i(t,null,[{key:"create",value:]),i(t,[{key:"create",value:,{key:"fileReaderDidLoad",value:,{key:"fileReaderDidError",value:function(t){this.callback("Error reading "+this.file.name)}},{key:"readNextChunk",value:]),t}();function a(t){var e=l(document.head,'meta[name="'+t+'"]');if(e)return e.getAttribute("content")}function u(t,e){return"string"==typeof t&&(e=t,t=document),h(t.querySelectorAll(e))} d=function(){function t(e,n,i){var o=this;r(this,t),this.file=e,this.attributes={filename:e.name,content_type:e.type||"application/octet-stream",byte_size:e.size,checksum:n},this.xhr=new XMLHttpRequest,this.xhr.open("POST",i,!0),this.xhr.responseType="json",this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.setRequestHeader("Accept","application/json"),this.xhr.setRequestHeader("X-Requested-With","XMLHttpRequest");var s=a("csrf-token");void 0!=s&&this.xhr.setRequestHeader("X-CSRF-Token",s),this.xhr.addEventListener("load",(function(t){return o.requestDidLoad(t)})),this.xhr.addEventListener("error",(function(t){return o.requestDidError(t)}))}return i(t,[{key:"create",value:,{key:"requestDidLoad",value:,{key:"requestDidError",value:function(t){this.callback('Error creating Blob for "'+this.file.name+'". Status: '+this.status)}},{key:"toJSON",value:,{key:"status",get:,{key:"response",get:]),t}(),p=function(){eturn i(t,[{key:"create",value:,{key:"requestDidLoad",value:,{key:"requestDidError",value:]),t}(),f=0,m=);ar v=),g="input[type=file][data-direct-upload-url]:not([disabled])",b=function(){function t(e){r(this,t),this.form=e,this.inputs=u(e,g).filter(()}return i(t,[{key:"start",value:function(t){var e=this,n=this.createDirectUploadControllers(),r=this.dispatch("start"),r()}},{key:"createDirectUploadControllers",value:,{key:"dispatch",value:]),t}(),E="data-direct-uploads-processing",S=new WeakMap,w=!1;tion A(t){var e=t.target;if(e.hasAttribute(E))t.preventDefault();else{var n=new b(e),r=n.inputs;r.length&&(t.preventDefault(),e.setAttribute(E,""),r.forEach(T),n.start((function(t){e.removeAttribute(E),t?r.forEach(q):P(e)})))}}function P(t){var e=S.get(t)||l(t,"input[type=submit], button[type=submit]");if(e){var n=e.disabled;e.disabled=!1,e.focus(),e.click(),e.disabled=n}else(e=document.createElement("input")).type="submit",e.style.display="none",t.appendChild(e),e.click(),t.removeChild(e);S.delete(t)}function T(t){t.disabled=!0}tTimeout(x,1),t.start=k,t.DirectUpload=m,Object.defineProperty(t,"__esModule",{value:!0})}(e)},18535:function(t,e,n){var r,i;(function(){(.call(this);var o=this.Rails;(function(){(.call(this),call(this),call(this),call(this),call(this),call(this),call(this),call(this),call(this),call(this),call(this)}).call(this),t.exports?t.exports=o:void 0===(i="function"===typeof(r=o)?r.call(e,n,e,t):r)||(t.exports=i)}).call(this)},12918:function(t,e,n){var r,i;(function(){(.call(this);var o=this.Turbolinks;(function(){(.call(this),call(this),call(this),call(this),call(this),call(this),call(this),call(this),function(){var t=[].slice;o.Renderer=function(){ar n;return e.render=function(){var e,n,r;return n=arguments[0],e=arguments[1],r=this,3<=arguments.length?t.call(arguments,2):[],(),r.delegate=n,r.render(e),r},e.prototype.renderView=e.prototype.invalidateView=function(){return this.delegate.viewInvalidated()},e.prototype.createScriptElement=n=e}()}.call(this),call(this),call(this),call(this),call(this),call(this),call(this),call(this),call(this),call(this)}).call(this),t.exports?t.exports=o:void 0===(i="function"===typeof(r=o)?r.call(e,n,e,t):r)||(t.exports=i)}).call(this)}}]);