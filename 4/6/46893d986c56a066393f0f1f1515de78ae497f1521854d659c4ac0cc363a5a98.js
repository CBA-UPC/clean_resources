(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[649],{"/5so":function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("QjXU"),a=r("mgFK");function o(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(r){switch(r.label){case 0:return t.isMsa?[4,Object(a.a)("consumerInstallInfo",e)]:[2,null];case 1:return[2,r.sent()||null]}}))}))}},"5eS3":function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("GeVZ");function a(e,t){if(!e||!t)return e;var r=Object(n.a)(e);if(!r)return e;var a=r.hostname,o=r.port,c=r.path,s=r.search,i=r.hash;return"".concat(r.protocol,"//").concat(a).concat(o?":"+o:"").concat(c).concat(s?s+"&":"?").concat(t).concat(i)}},"D/tM":GeVZ:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=new RegExp(["^(https?:)//","(([^:/?#]*)(?::([0-9]+))?)","(/{0,1}[^?#]*)","(\\?[^#]*|)","(#.*|)$"].join(""));function a(e){if(e&&e.length){var t=e.match(n);if(t)return{href:e,protocol:t[1],host:t[2],hostname:t[3],port:t[4],path:t[5],search:t[6],hash:t[7]}}}},N3Xl:function(e,t,r){"use strict";r.r(t),r.d(t,"getLaunchFileFunc",(function(){return x})),r.d(t,"launchTemplate",(function(){return E})),r.d(t,"openFileInExplorer",(function(){return y})),r.d(t,"launchInDesktopApps",(function(){return N}));var n=r("QjXU"),a=r("DCX/"),o=r("Ohvh"),c=r("slmW"),s=r("05Vi"),i=r("W1wp"),u=r("1R5x"),l=r("vhka"),p=r("0mcE"),f=r("cenr"),d=r("V9hE"),h=r("4CZh"),v=r("a3FV"),m=r("8/lW"),b=r("Dn7E"),w=r("CMIS"),g=r("GMuP"),O=r("z+rT"),j=["word","excel","powerpoint","visio"],P=r("rYv4"),_=r("wuzB"),L=new Set(["ms-word:","ms-powerpoint:","ms-excel:","ms-visio:","ms-access:","ms-project:","ms-publisher:","onenote:"]);function S(e,t){var r=e.toLocaleLowerCase(),n="onenote"===r,a=n?r+":":"ms-"+r+":";if(L.has(a))return t?a+"nft|u|":a+(n?"":"ofe|u|")}var x=function(e){return function(e){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var t,r,c,l,p,h,O,j,_,L,x,E,y,N,F,C,I;return Object(n.__generator)(this,(function(U){switch(U.label){case 0:return t=e.appName,r=e.prelaunchCallback,c=e.filePath,l=performance.now(),r&&r(),p=Object(o.a)(t),[4,Promise.all([Object(a.a)(),Object(s.a)()])];case 1:return h=n.__read.apply(void 0,[U.sent(),2]),O=h[0],j=h[1],p&&(null==j?void 0:j.PwaStartPageEnabled)&&(null===(I=null==O?void 0:O.startPageApps)||void 0===I?void 0:I.has(p))&&!c?[4,Object(i.a)(t)]:[3,3];case 2:return U.sent()&&"Excel"===p?[2,Object(u.a)(t,c||"",l)]:[2,{success:!1,message:"Unable to get app info"}];case 3:if(c&&(c=decodeURI(c),_=c.indexOf("?"),c=_>=0?c.substring(0,_):c),!((null==j?void 0:j.officeUriProtocolEnabled)&&t&&c&&""!==c)||c.startsWith("https://1drv.ms"))return[3,9];if(!(L=S(t)))return[3,9];(x={}).Action="AppsProtocol",U.label=4;case 4:return U.trys.push([4,8,,9]),[4,Object(i.a)(t)];case 5:if(!U.sent())return[3,7];E=void 0;try{E=new URL(c)}catch(e){E=new URL("file://"+c)}return L+=E,y="LaunchProtocol",N=Math.ceil(performance.now()-l),[4,Object(P.hwaLaunchUrl)(L,{action:y})];case 6:return U.sent(),x.State="Success",x.Latency=N.toString(),Object(f.a)(v.a.LaunchLocalApp,x,[],m.a.Enhanced),Object(b.a)({featureName:"LocalLaunch",eventName:"Protocol_Launch",params:{state:"Success",action:y,latency:N}}),[2,{success:!0}];case 7:return[3,9];case 8:return F=U.sent(),C=(F||"Unable to launch url").toString(),x.State="Failed",x.Error=C,x.Latency=Math.ceil(performance.now()-l).toString(),Object(f.a)(v.a.LaunchLocalApp,x,[],m.a.Enhanced),Object(w.a)({eventName:"Launch_By_Protocol_Failed",errorType:"Launch_Error"}),Object(g.a)({eventName:"Launch_By_Protocol_Failed",params:{errorType:"Launch_Error",message:C}},m.a.Enhanced),Object(d.a)("HWA_Launch",{errorType:"Launch_Error",message:C},[],m.a.Enhanced),[3,9];case 9:return[2,Object(u.a)(t,c||"",l)]}}))}))}},E=function(e,t){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var r;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:if(!e||!t)return[2,!1];if(!(r=S(e,!0)))return[2,!1];n.label=1;case 1:return n.trys.push([1,5,,6]),[4,Object(i.a)(e)];case 2:return n.sent()?(r+=t,[4,Object(P.hwaLaunchUrl)(r,{action:"CreateFileWithTemplate"})]):[3,4];case 3:return n.sent(),[2,!0];case 4:return[3,6];case 5:return n.sent(),[3,6];case 6:return[2,!1]}}))}))},y=function(e){return new Promise((function(t,r){Windows.Storage.StorageFolder.getFolderFromPathAsync(e).then((function(e){if(!e)throw new Error("GetFolderFromPath returned null");return Windows.System.Launcher.launchFolderAsync(e).then((function(e){if(!e)throw new Error("Failed to open folder");t()}),()}),(function(){var e=window.ng2EventService;throw e&&e.broadcastEvent&&e.broadcastEvent({name:"needAccessToFileSystem",args:["allow-file-system-access-open-file-location"]}),new Error("GetFolderFromPath exception")})).then(void 0,(function(e){var t,n={};n.Error=e?e.message:"",Object(f.a)(v.a.LaunchFileExplorerFailed,n,[],m.a.Enhanced),Object(w.a)({eventName:"Launch_File_Explorer_Failed",errorType:"Launch_Error"}),Object(g.a)({eventName:"Launch_File_Explorer_Failed",params:{errorType:"Launch_Error",message:null!==(t=null==e?void 0:e.message)&&void 0!==t?t:"Unable to open explorer"}}),r()}))}))},N=function(e){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var t,r,a,o,s,i,u,f,d,v,w;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:if(t=!!j.find((function(t){var r;return(null===(r=null==e?void 0:e.appName)||void 0===r?void 0:r.toLowerCase())==t})),r={success:!1,message:"launchInDesktopApps",result:"OpenUndefined",additionalInfo:t?"launchOptions invalid":"app LOR not supported"},o={app:e.appName,hasCanonicalUrl:!!e.filePath,hasWebUrl:!!e.webUrl},!(e.fileType&&e.filePath&&e.webUrl&&e.appName&&t))return[3,6];n.label=1;case 1:return n.trys.push([1,5,,6]),[4,Object(l.a)()];case 2:return s=n.sent(),i=null==s?void 0:s.apps.find((),u=Object(c.a)(e.fileType),i&&i.isInstalled&&u?(f={CT:Date.now(),OR:"office-start"},d=Object(O.a)(e.filePath,f),v=u+d+"|wu|"+e.webUrl,void 0!==e.templateBinaryUrl&&(v=S(e.appName,!0)+e.templateBinaryUrl),[4,Object(p.a)(v)]):[3,4];case 3:r=n.sent(),a=(r={success:r.success,message:"launchInDesktopApps",result:"Native",errorMessage:null==r?void 0:r.errorMessage,additionalInfo:null==r?void 0:r.additionalInfo,errorCode:null==r?void 0:r.errorCode}).errorMessage,n.label=4;case 4:return[3,6];case 5:return w=n.sent(),a=Object(_.a)(w).message,[3,6];case 6:return Object(h.c)()>=m.a.Enhanced&&(o.success=r.success,o.error=null!=a?a:"",o.errorCode=null==r?void 0:r.errorCode),Object(b.a)({featureName:"HwaLaunchInDesktopApps",eventName:"HwaLaunchInDesktopApps",params:o}),[2,r]}}))}))}},PZ4A:function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return i}));var n,a,o=r("6ib3");function c(){return(n={})[o.a[o.a.Excel]]=["xls","xlsx","xlb","xlc","xlsb","xlsm","xlt","xltx","xltm","xlm","xla","xll","xlam","xlw","excel","csv"],n[o.a[o.a.Visio]]=["vsd","vss","vst","vdx","vsx","vtx","vsl","vsu","vsw","vsdx","vsdm","vssm","vstx","vstm"],n[o.a[o.a.PowerPoint]]=["ppt","pptx","pot","potx","potm","ppam","ppsx","ppsm","sldx","sldm","ppa","pps","pptm","powerpoint"],n[o.a[o.a.Word]]=["doc","dot","docx","docm","dotx","dotm","docb","word"],n[o.a[o.a.Photos]]=["jpg","png","jpeg","gif","svg","bmp","tif","tiff","heic"],n[o.a[o.a.Outlook]]=["msg","eml"],n[o.a[o.a.OneNote]]=["one"],n[o.a[o.a.Pdf]]=["pdf"],n[o.a[o.a.Audio]]=["mp3","m4a","wav","wma"],n[o.a[o.a.Text]]=["txt"],n[o.a[o.a.Fluid]]=["fluid","loop"],n[o.a[o.a.Stream]]=["mts","m2ts","ts","3g2","3gp","3gp2","3gpp","asf","wmv","avi","m4v","mov","mp4","mp4v","ogg","webm","movie","mkv","mpg","mpeg"],n[o.a[o.a.Whiteboard]]=["whiteboard"],n[o.a[o.a.MeetingNotes]]=["note"],n[o.a[o.a.Clipchamp]]=["clipchamp"],n[o.a[o.a.Link]]=["url"],n[o.a[o.a.Draft]]=["draft"],n}function s(e){return a||(a=function(){n||(n=c()),a={};var e=function(e){if(!n.hasOwnProperty(e))return"continue";var t=n[e];if(!t)return"continue";t.forEach(()};for(var t in n)e(t);return a}()),e&&a[e.toLowerCase()]||o.a.None}function i(e){return n||(n=c()),n[e]}},QHw4:RJ4M:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("GeVZ");function a(e){var t=Object(n.a)(e);return t&&t.hostname||""}},SL81:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("PZ4A"),a=r("QHw4");function o(e){return e.startsWith("/")&&(e=e.slice(1)),e.endsWith("/")&&(e=e.slice(0,-1)),e.toLowerCase()}function c(e){if(e){var t=Object(n.b)(e);return"None"!==t?t:e}}function s(e,t){if(e){if(void 0!==e.route)return e;if("string"==typeof e)try{var r=new URL(e),n=r.pathname.toLowerCase().split("/").filter((function(e,t){return!!e&&(t>1||"embed"!==e)})),s=function(e,t){var r,n=t.pwaEnabled?"Pwa":"OfficeHome";if(void 0===e)return n;var s=o(a.a.TemplatePageRootPath),i=o(a.a.StartPageRootPath),u=o(a.a.WacHostPagePath);return((r={home:n,apps:"AppGallery",pwa:"Pwa",create:"Create",mycontent:"MyContent",m365apps:function(e,t){var r,n,a,o,c=null!==(r=e[1])&&void 0!==r?r:void 0,s=null!==(n=null==t?void 0:t.get("subPageId"))&&void 0!==n?n:void 0;return{route:"M365Apps",app:c,appId:c,entityId:null!==(a=e[2])&&void 0!==a?a:void 0,subPageId:null!==(o=e[3])&&void 0!==o?o:s}},search:function(e,t){switch(e[1]){case"siteall":case"sitenews":case"sitesites":case"sitefiles":case"siteimages":return{route:"SearchSiteScoped"};case"content":case"contact":case"organization":case"calendar":case"office":return{route:"SearchPersonScoped"};case"files":return{route:"SearchFilesScoped"};case"people":return{route:"SearchPeopleScoped"};case"sites":return{route:"SearchSitesScoped"};default:return{route:"Search"}}}})[i]=function(e,t){var r="Start";switch(e[2]){case"myforms":r="MyForms";break;case"groupforms":r="GroupForms";break;case u:r="Content";break;default:r="Start"}var n=c(e[1]);return n?{route:r,app:n}:{route:r}},r[s]=function(e,t){var r="Templates",n=c(e[1]);return n?{route:r,app:n}:{route:r}},r)[e]}(n[0],t);if(s)switch(typeof s){case"string":return{route:s};case"function":return s(n,r.searchParams);default:return}}catch(e){}}}},WJ2C:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("QjXU"),a=r("MJsD"),o=r("B5kz"),c=r("W7wX"),s=r("/5so");function i(){return Object(n.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(n.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(a.a)()];case 1:return e=r.sent(),[4,Object(c.a)()];case 2:return t=r.sent(),[2,o.a.fetchQuery(["ConsumerInstallInfoConfig"],(,{staleTime:1/0,cacheTime:1/0})]}}))}))}},rYv4:function(e,t,r){"use strict";r.r(t),r.d(t,"hwaLaunchUrl",(function(){return O}));var n=r("QjXU"),a=r("DCX/"),o=r("MJsD"),c=r("0mcE"),s=r("cenr"),i=r("V9hE"),u=r("a3FV"),l=r("8/lW"),p=r("SL81"),f=r("CMIS"),d=r("GMuP"),h=r("dSKW"),v=r("RJ4M"),m=r("NkqM"),b=r("KSsg"),w=r("wuzB"),g=new Set(["GoToBlankDoc","CreateNewFallback","Upload","CreateFromDocument","LaunchProtocol","CreateFileWithTemplate"]),O=function(e,t,r,O){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var j,P,_;return Object(n.__generator)(this,(function(L){switch(L.label){case 0:return[4,Object(o.a)()];case 1:return j=L.sent(),[4,Object(a.a)()];case 2:if(!(P=L.sent()))throw new Error("Capabilities not available");return[4,function(){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var a,o,b,_,L,S,x,E,y,N,F,C,I;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:if("string"==typeof e&&Object(v.a)(e)!==window.location.hostname||(a=Object(p.a)(e,P)),"string"!=typeof e&&!a)return[2,{success:!1,message:"No url or no route"}];if("string"!=typeof e)return[3,5];e=Object(m.a)(e),n.label=1;case 1:return n.trys.push([1,4,,5]),"_self"===(null==t?void 0:t.linkTarget)?[3,3]:[4,Object(c.a)(e)];case 2:return[2,{success:(o=n.sent()).success,message:"hwaLaunchUri",result:"Native",errorMessage:null==o?void 0:o.errorMessage,additionalInfo:null==o?void 0:o.additionalInfo,errorCode:null==o?void 0:o.errorCode}];case 3:return a||"https:"!==new URL(e).protocol?[3,5]:(window.location.href=e,[2,{success:!0,message:"Navigated to url directly",result:"Inline"}]);case 4:return b=n.sent(),_={},(L=null!==(F=null==t?void 0:t.action)&&void 0!==F?F:"")&&(_.Action=L),S=Object(w.a)(b),x=null!==(C=S.message)&&void 0!==C?C:"Unable to launch URL",E=S.debugInfo,_.Error=x,Object(s.a)(u.a.PwaNavigationFailed,_,[],l.a.Enhanced),Object(f.a)({eventName:"HWA_Launch",errorType:"Launch_Error"}),(N={}).Action=L,N.errorType="Launch_Error",N.message=x,N.DebugInfo=E,y=N,Object(d.a)({eventName:"HWA_Launch",params:y},l.a.Enhanced),Object(i.a)("HWA_Launch",y,[],l.a.Enhanced),(null===(I=j.uiContext)||void 0===I?void 0:I.showErrorDialog)&&j.uiContext.showErrorDialog({category:"OpenFailed",error:t&&g.has(null==t?void 0:t.action)?"None":"Generic",inputText:e}),[2,{success:!1,message:x,result:"Native"}];case 5:return a?(r&&(r.pageName=Object(h.a)(j.router.getCurrentPageForLogging())),[4,j.router.navigateTo(a,!1,O)]):[3,7];case 6:return[2,{success:n.sent(),message:"Navigated via router",result:"Inline"}];case 7:return[2,{success:!1,message:"Fall through"}]}}))}))}()];case 3:return _=L.sent(),Object(b.a)({launchInstrumentationParams:r,success:_.success,platform:"Native"}),[2,_]}}))}))}},slmW:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("6ib3");,wuzB:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e){var t,r;return e instanceof Error?(t=e.stack,r=e.message):"string"==typeof e?r=e:"object"==typeof e&&(r=null==e?void 0:e.toString()),{debugInfo:null!=t?t:"",message:null!=r?r:""}}},"z+rT":function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("5eS3"),a=r("zP6S");function o(e,t,r){return e?Object(n.a)(e,Object(a.a)(t,r)):e}},zP6S:function(e,t,r){"use strict";function n(e,t){if(!e)return"";var r="";for(var n in e){var a,o=r?"&":"";a=t?e[n]?"".concat(e[n]):"":e[n]?"".concat(encodeURIComponent(e[n])):"",r="".concat(r).concat(o).concat(n,"=").concat(a)}return r}r.d(t,"a",()}}]);
//# sourceMappingURL=vendors~hwalaunchfile.15c1890e4163e94a9ef4.chunk.v7.js.map