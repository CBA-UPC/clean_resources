(window.wpJsonpExCoAdPlayer=window.wpJsonpExCoAdPlayer||[]).push([[0,1,2,4,5,6,7,8,9],{15:function(t,n,e){"use strict";e.r(n),e.d(n,"PLUGIN_NAME",(function(){return o}));var r=e(39);e.d(n,"API",(function(){return r.API}));var i=e(38);e.d(n,"VAST_DEMAND_TPL",(function(){return i.VAST_DEMAND_TPL})),e.d(n,"RTB_DEMAND_TPL",(function(){return i.RTB_DEMAND_TPL})),e.d(n,"MEDIA_TYPES",(function(){return i.MEDIA_TYPES}));var a=e(40);e.d(n,"PLUGIN_EVENTS",();var o="tbla"},16:function(t,n,e){"use strict";e.r(n);var r=e(44),i=e(1),a=e(15),o=e(42),c=e(41),u=e(0),_=function(t,n,e,r){return new(e||(e=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function c(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var n;t.done?i(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(o,c)}u((r=r.apply(t,n||[])).next())}))},s=function(t,n){var e,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=n.call(t,o)}catch(t){a=[6,t],r=0}finally{e=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},l=window.location.href.includes("exco-tbla-debug=true"),d=function(){function t(t){this.completionSent=!1,Object(c.setCallbacks)(t.callbacks),i.b.emit(i.a.PLUGIN.ENABLED,{name:a.PLUGIN_NAME}),this._listenToAdProgress(),this._listenToAdEvents(),this._listenToStickyEvents(),this._listenToCompletionEvent(),this._handleViewabilityEvent(),this._listenToRefreshEvent()}return t.prototype.apply=function(t){var n;return _(this,void 0,void 0,(function(){var e,r,i=this;return s(this,(function(o){return e=t.find((),r=(null===(n=null==e?void 0:e.dmid)||void 0===n?void 0:n.split("-")[0])||"317149441",a.VAST_DEMAND_TPL.dmid=a.VAST_DEMAND_TPL.dmid.replace("{supplyId}",r),a.RTB_DEMAND_TPL.dmid=a.RTB_DEMAND_TPL.dmid.replace("{supplyId}",r),[2,t.filter(()]}))}))},t.prototype._isTaboolaDemand=function(t){return t.demandId?t.demandId===a.VAST_DEMAND_TPL.dmid||t.demandId===a.RTB_DEMAND_TPL.dmid:t.id===a.VAST_DEMAND_TPL.id||t.id===a.RTB_DEMAND_TPL.id},t.prototype._listenToRefreshEvent=function(){var t=this;i.b.on(i.a.PLUGIN.ACTION.AUCTION,(function(n){var e=n.players;return _(t,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[],u.a.debug("[Plugin] Fetching WF"),[4,Object(r.getDemands)(e,{debug:l})];case 1:return[2,t.sent()]}}))}))}))},t.prototype._handleViewabilityEvent=function(){var t=this;i.b.on(i.a.AD.IMPRESSION,(),window.addEventListener("visibilitychange",()},t.prototype._sendViewabilityEvent=function(){var t=this;setTimeout((function(){if(t.impressionData){var n=t.impressionData,e=n.demand,r=n.players;if(!r.closed&&r.isInView&&"visible"===document.visibilityState){var a=Object(o.getEventData)(e),c=Object(o.getEventName)(i.a.AD.VIEWABILITY);Object(o.sendEvent)(c,a),t.impressionData=null}}}),2e3)},t.prototype._listenToStickyEvents=function(){var t=this;i.b.on(i.a.STICKY.CLOSED,(function(){i.b.emit(i.a.PLAYER.ACTION.CLOSE),t._toggleUpNext(!0),t.impressionData=null})),i.b.on(i.a.STICKY.OPENED,()},t.prototype._listenToCompletionEvent=function(){var t=this;i.b.on(i.a.AD.STARTED,(),i.b.on(i.a.AD.CLICKED,(function(n){var e=n.demand,r=Object(o.getEventData)(e);t._sendCompletionEvent(r)})),i.b.on(i.a.AD.SKIPPED,(function(n){var e=n.demand,r=Object(o.getEventData)(e);t._sendCompletionEvent(r),t._stopTimeUpdate(),t._handleSADemand(e),t.impressionData=null})),i.b.on(i.a.AD.TIME_UPDATE,(function(n){var e=n.demand,r=n.time,i=Object(o.getEventData)(e);r>=30&&t._sendCompletionEvent(i)})),i.b.on(i.a.AD.COMPLETED,(function(n){var e=n.demand,r=e.getProgress().time;if(clearInterval(t.timeUpdateInterval),r<31){var i=Object(o.getEventData)(e);t._sendCompletionEvent(i)}t.playingDemand=null,t.completionSent=!1,t.impressionData=null,t._stopTimeUpdate(),t._handleSADemand(e)}))},t.prototype._listenToAdEvents=function(){var t=this;i.b.on(i.a.AD.XML_PARSED,(),i.b.on(i.a.AD.INIT,(function(n){var e=n.demand;t._isTaboolaDemand(e)&&(e.impressionData&&e.impressionData.pricing||(e.impressionData=e.apiImpressionData))})),i.b.on(i.a.AD.STARTED,(function(n){var e,r,i=n.demand;t.playingDemand=i,void 0!==(null===(r=null===(e=null==i?void 0:i.capping)||void 0===e?void 0:e.current)||void 0===r?void 0:r.imp)&&i.capping.current.imp++,t._startTimeUpdate()})),i.b.on(i.a.AD.ANY,(function(t){if(this.event!==i.a.AD.XML_PARSED){var n=t.demand,e=Object(o.getEventData)(n),r=Object(o.getEventName)(this.event);this.event===i.a.AD.IMPRESSION&&u.a.debug("[Plugin] Ad Impression"),Object(o.sendEvent)(r,e)}}))},t.prototype._handleSADemand=t.prototype._stopTimeUpdate=t.prototype._startTimeUpdate=function(){var t=this;this._stopTimeUpdate(),this.timeUpdateInterval=setInterval((function(){if(t.playingDemand){var n=t.playingDemand.getProgress();(null==n?void 0:n.time)&&i.b.emit(i.a.AD.TIME_UPDATE,{demand:t.playingDemand,time:null==n?void 0:n.time})}}),500)},t.prototype._handleXmlPricing=function(t){var n=t.impressionData,e=t.ad.pricing;e&&(n&&n.pricing||e.value&&(t.impressionData={pricing:parseFloat(e.value),currency:e.currency}))},t.prototype._sendCompletionEvent=function(t){this.completionSent||(this.completionSent=!0,Object(o.sendEvent)(a.PLUGIN_EVENTS.COMPLETION,t))},t.prototype._toggleUpNext=function(t){var n=document.querySelector(".tbl-next-up-position-right");n&&n.classList.toggle("in-viewport",t)},t.prototype._listenToAdProgress=function(){i.b.on(i.a.AD.PROGRESS,(function(t){var n=t.quartile,e=t.demand;switch(n){case 1:i.b.emit(i.a.AD.FIRST_QUARTILE,{demand:e});break;case 2:i.b.emit(i.a.AD.MIDPOINT,{demand:e});break;case 3:i.b.emit(i.a.AD.THIRD_QUARTILE,{demand:e})}}))},t}();n.default=d},38:function(t,n,e){"use strict";e.r(n),e.d(n,"VAST_DEMAND_TPL",(function(){return r})),e.d(n,"RTB_DEMAND_TPL",(function(){return i})),e.d(n,"MEDIA_TYPES",(function(){return a}));var r={type:"vast",id:"1837283097",dmid:"{supplyId}-1837283097",domainId:"320",dp:"Taboola VAST Demand",gtag:!0},i={type:"rtb",id:"2099606595",dmid:"{supplyId}-2099606595",domainId:"320",dp:"Taboola RTB Demand",gtag:!0},a={video:1,jsvpaid:2,jsima:5,omid:6}},39:40:41:function(t,n,e){"use strict";e.r(n),e.d(n,"setCallbacks",(function(){return i})),e.d(n,"getCallback",(function(){return a}));var r=[],i=a=function(t){if(r){var n=r.find(();if(n&&n.fn)return n.fn}return function(){}}},42:function(t,n,e){"use strict";e.r(n),e.d(n,"updateEventsGlobalData",(function(){return u})),e.d(n,"getEventData",(function(){return _})),e.d(n,"getEventName",(function(){return s})),e.d(n,"sendEvent",(function(){return l}));var r=e(1),i=e(41),a=e(15),o=function(){return(o=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)},c={},u=_=function(t){var n,e,r,i,u=t.extraData||{},_=o(o(o({},c),u),{viewability:t.viewability,progress:t.progress,vastPrice:parseFloat((null===(n=null==t?void 0:t.impressionData)||void 0===n?void 0:n.pricing)||(null===(e=null==t?void 0:t.extraData)||void 0===e?void 0:e.price)),url:t.mediaURL||u.url,created:u.created,waterfallTagId:u.waterfallTagId,sequenceId:u.sequenceId,mty:a.MEDIA_TYPES[t.adType]||a.MEDIA_TYPES.video,title:null===(r=u.nas)||void 0===r?void 0:r.title});return"prebid"===t.type&&(_.prebid={bidder:t.bidder,price:null===(i=null==t?void 0:t.impressionData)||void 0===i?void 0:i.pricing,campaignId:t.vastId}),_},s=function(t){return"".concat(a.PLUGIN_EVENTS.PREFIX,".").concat(t.replace(".","-"))},l=function(t,n){try{var e=window.structuredClone?window.structuredClone(n):JSON.parse(JSON.stringify(n)),a="".concat(t);Object(i.getCallback)(a)(e),r.b.emit(r.a.PLUGIN.EVENT,{eventName:a,data:e})}catch(t){}}},43:function(t,n,e){"use strict";e.r(n),e.d(n,"applyMacros",(function(){return i}));var r={"%%player-width%%":function(t){return t.width},"%%player-height%%":function(t){return t.height},"%%ua%%":"%%referrer%%":"%%cirf%%":function(){return encodeURIComponent("".concat(window.location.protocol,"//").concat(window.location.host))},"%%page-url%%":function(){return window.location.href},"%%video-url%%":"%%vidlength%%":function(t){var n,e;return null===(e=null===(n=null==t?void 0:t.content)||void 0===n?void 0:n.currentItem)||void 0===e?void 0:e.duration},"%%title%%":function(t){var n,e;return null===(e=null===(n=null==t?void 0:t.content)||void 0===n?void 0:n.currentItem)||void 0===e?void 0:e.title},"%%description%%":function(t){var n,e;return null===(e=null===(n=null==t?void 0:t.content)||void 0===n?void 0:n.currentItem)||void 0===e?void 0:e.description},"%%tag%%":"%%keywords%%":function(t){var n,e,r=null===(e=null===(n=null==t?void 0:t.content)||void 0===n?void 0:n.currentItem)||void 0===e?void 0:e.keywords;if(r&&r.length)return r.join(",")},"%%vertical%%":function(t){var n,e,r=null===(e=null===(n=null==t?void 0:t.content)||void 0===n?void 0:n.currentItem)||void 0===e?void 0:e.categories;if(r&&r.length)return r[0]},"%%ip%%":"%%domain%%":"%%country%%":"%%timestamp%%":"%%cb%%":"[CACHEBUSTING]":function(){return"".concat(Date.now()).substring(0,8)}},i=function(t,n){if(!t)return t;var e=t;return Object.entries(r).forEach((function(t){var r=t[0],i=(0,t[1])(n);i&&(e=e.replace(new RegExp(r),"img"),i))})),e}},44:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"getWfIndex",(function(){return getWfIndex})),__webpack_require__.d(__webpack_exports__,"getDemands",(function(){return getDemands}));var _services_ng_events__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_callbacks__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(41),_constants__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(15),_events__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(42),_macros__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(43),__assign=__awaiter=__generator=WF_COUNTER=0,updateProtocol=function(t){try{var n=new URL(t);return n.protocol!==window.location.protocol&&(n.protocol=window.location.protocol),n.toString()}catch(t){}return t},mapDemands=function(t,n){return(t||[]).map((function(t,e){var r,i=6===t.advType||8===t.advType?_constants__WEBPACK_IMPORTED_MODULE_2__.RTB_DEMAND_TPL:_constants__WEBPACK_IMPORTED_MODULE_2__.VAST_DEMAND_TPL;return __assign(__assign({},i),{url:updateProtocol(Object(_macros__WEBPACK_IMPORTED_MODULE_4__.applyMacros)(t.url,n)),vastXml:t.vast,title:null===(r=t.nas)||void 0===r?void 0:r.title,impressionData:{pricing:parseFloat(t.price||t.cpmFloor),price:parseFloat(t.price||t.cpmFloor),currency:"USD"},extraData:__assign(__assign({},t),{sequenceId:e,waterfallTagId:getWfIndex(),created:(new Date).getTime()}),capping:{imp:1,current:{imp:0}}})}))},getWfIndex=getDemands=function(players,options){return void 0===options&&(options={}),__awaiter(void 0,void 0,void 0,(function(){var url,res,raw,wf,demands,error_1;return __generator(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,4]),url=Object(_callbacks__WEBPACK_IMPORTED_MODULE_1__.getCallback)("_generateUrl")(),[4,fetch(url||_constants__WEBPACK_IMPORTED_MODULE_2__.API.WF.URL,{credentials:"include"})];case 1:if(res=_a.sent(),!res.ok)throw new Error("HTTP error! Status: ".concat(res.status));return[4,res.text()];case 2:return raw=_a.sent(),wf=raw,wf=wf&&wf.startsWith("(")?eval(raw):JSON.parse(wf),WF_COUNTER++,demands=mapDemands(wf.tags||[],players),wf.externalPrebidTags&&Object(_events__WEBPACK_IMPORTED_MODULE_3__.updateEventsGlobalData)({externalPrebidTags:wf.externalPrebidTags}),demands&&demands.length&&demands.forEach((function(t){_services_ng_events__WEBPACK_IMPORTED_MODULE_0__.b.emit(_services_ng_events__WEBPACK_IMPORTED_MODULE_0__.a.PLUGIN.EVENT,{eventName:_constants__WEBPACK_IMPORTED_MODULE_2__.PLUGIN_EVENTS.TAG_STARTED,data:Object(_events__WEBPACK_IMPORTED_MODULE_3__.getEventData)(t)})})),_services_ng_events__WEBPACK_IMPORTED_MODULE_0__.b.emit(_services_ng_events__WEBPACK_IMPORTED_MODULE_0__.a.PLUGIN.AUCTION,{waterFallSize:demands.length,waterFallIndex:WF_COUNTER}),[2,options.debug?[]:demands];case 3:return error_1=_a.sent(),[3,4];case 4:return[2,[]]}}))}))}}}]);