(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3822],{31612:18406:31024:function(e,t,n){"use strict";n.d(t,{Z:function(){return ActionsDropdown}});var r=n(52322),a=n(39708),i=n(8583),s=n(83122);,81291:78066:function(e,t,n){"use strict";n.d(t,{Z:function(){return Modal}});var r=n(52322),a=n(2784),i=n(68810),s=n(64529),o=n(83122),l=n(82002),c=n(89370);}},2594},5453},5526},54242:function(e,t,n){"use strict";n.d(t,{d:function(){return useListBoardProjectsQuery}});var r=n(73235),a=n(66547),i=n(84902);function _templateObject(){let e=(0,r._)(["\n    fragment ProjectMinimal on Project {\n  id\n  name\n  subdomain\n  createdAt\n  updatedAt\n  privacy\n  archived\n  screenshot\n  primaryShareLink {\n    id\n    projectId\n    name\n    createdAt\n    updatedAt\n    customPath\n  }\n  initialScreenshotCapture {\n    ...ScreenshotBasedCapture\n  }\n  scaleStrategy\n  mobileStrategy\n  migrationStatus\n}\n    ",""]);return _templateObject=function(){return e},e}let s=(0,a.ZP)(_templateObject(),i.P);function boardProject_templateObject(){let e=(0,r._)(["\n    fragment BoardProject on BoardProject {\n  createdAt\n  creatorId\n  project {\n    ...ProjectMinimal\n  }\n}\n    ",""]);return boardProject_templateObject=function(){return e},e}let o=(0,a.ZP)(boardProject_templateObject(),s);var l=n(26806);function listBoardProjects_templateObject(){let e=(0,r._)(["\n    query ListBoardProjects($data: BoardProjectListFilterArgs!) {\n  boardProjects(data: $data) {\n    ...BoardProject\n  }\n}\n    ",""]);return listBoardProjects_templateObject=function(){return e},e}let c=(0,a.ZP)(listBoardProjects_templateObject(),o);function useListBoardProjectsQuery(e){return l.aM({query:c,...e})}},7199:function(e,t,n){"use strict";n.d(t,{H:function(){return useListBoardsQuery}});var r=n(73235),a=n(66547),i=n(55261),s=n(26806);function _templateObject(){let e=(0,r._)(["\n    query ListBoards($workspaceId: String!, $filterForCurrentUser: Boolean) {\n  boards(workspaceId: $workspaceId, filterForCurrentUser: $filterForCurrentUser) {\n    ...Board\n  }\n}\n    ",""]);return _templateObject=function(){return e},e}let o=(0,a.ZP)(_templateObject(),i.V}},92774:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return eu}});var r,a,i=n(52322),s=n(2784),o=n(94225);function DateTimeInput(e){let{value:t,onChange:},debounce:r=0}=e,a=(0,o.y1)(n,r),[l,c]=(0,s.useState)(t);return(0,s.useEffect},[t]),(0,i.jsx)("input",{className:"focus:border-blue-primary block rounded-md border border-gray-200 px-3 py-1 text-sm shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-200 disabled:cursor-not-allowed disabled:bg-gray-50 disabled:text-gray-500 disabled:ring-gray-200",type:"datetime-local",value:l,onChang}})}var l=n(54242),c=n(7199),d=n(73235),u=n(66547);function _templateObject(){let e=(0,d._)(["\n    fragment EngagementMetricSource on EngagementMetricSource {\n  id\n  sourceType\n  eventType\n  urlPattern\n}\n    "]);return _templateObject=function(){return e},e}let m=(0,u.ZP)(_templateObject());function engagementMetricExtended_templateObject(){let e=(0,d._)(["\n    fragment EngagementMetricExtended on EngagementMetricExtended {\n  id\n  createdAt\n  updatedAt\n  name\n  description\n  numerator {\n    ...EngagementMetricSource\n  }\n  denominator {\n    ...EngagementMetricSource\n  }\n  displayFormat\n  workspaceId\n}\n    ",""]);return engagementMetricExtended_templateObject=function(){return e},e}let p=(0,u.ZP)(engagementMetricExtended_templateObject(),m);var g=n(26806);function listEngagementMetrics_templateObject(){let e=(0,d._)(["\n    query ListEngagementMetrics($workspaceId: String!) {\n  engagementMetrics(workspaceId: $workspaceId) {\n    id\n    results {\n      ...EngagementMetricExtended\n    }\n    count\n  }\n}\n    ",""]);return listEngagementMetrics_templateObject=function(){return e},e}let x=(0,u.ZP)(listEngagementMetrics_templateObject(),p);var h=n(84038),y=n(47330),v=n(83122),f=n(45152),j=n(47643),b=n(87433),M=n(5632),w=n(8583),T=n(3016),_=n(25948),C=n(18318),N=n(32517),S=n(78066);function createEngagementMetric_templateObject(){let e=(0,d._)(["\n    mutation CreateEngagementMetric($input: EngagementMetricCreateInput!) {\n  createEngagementMetric(input: $input) {\n    id\n    name\n    description\n    createdAt\n    updatedAt\n    displayFormat\n  }\n}\n    "]);return createEngagementMetric_templateObject=function(){return e},e}let E=(0,u.ZP)(createEngagementMetric_templateObject());function engagementMetric_templateObject(){let e=(0,d._)(["\n    fragment EngagementMetric on EngagementMetric {\n  id\n  createdAt\n  updatedAt\n  name\n  description\n  displayFormat\n  workspaceId\n}\n    "]);return engagementMetric_templateObject=function(){return e},e}let A=(0,u.ZP)(engagementMetric_templateObject());function updateEngagementMetric_templateObject(){let e=(0,d._)(["\n    mutation UpdateEngagementMetric($input: EngagementMetricUpdateInput!) {\n  updateEngagementMetric(input: $input) {\n    ...EngagementMetric\n  }\n}\n    ",""]);return updateEngagementMetric_templateObject=function(){return e},e}let D=(0,u.ZP)(updateEngagementMetric_templateObject(),A);var k=n(86414),P=n(1422),F=n(77512);let O={[y.$K.Number]:"Number",[y.$K.Percentage]:"Percentage",[y.$K.TimeDuration]:"Time Duration"},displayFormatToOptio),I={number:displayFormatToOption(y.$K.Number),percentage:displayFormatToOption(y.$K.Percentage),timeDuration:displayFormatToOption(y.$K.TimeDuration)},Z=[{name:"Steps viewed",value:"stepsViewed",sourceInit:{sourceType:y.CK.Events,eventType:y.tw.ViewStep},unitSingular:"step view"},{name:"Navigations",value:"navigations",sourceInit:{sourceType:y.CK.Events,eventType:y.tw.Navigate,urlPattern:""},unitSingular:"navigation"},{name:"Conversion events",value:"conversions",sourceInit:{sourceType:y.CK.Events,eventType:y.tw.Converted},unitSingular:"conversion"},{name:"Flow start",value:"flowStarts",sourceInit:{sourceType:y.CK.Events,eventType:y.tw.StartFlow},unitSingular:"flow start"},{name:"Flow completions",value:"flowCompletions",sourceInit:{sourceType:y.CK.Events,eventType:y.tw.CompleteFlow},unitSingular:"flow completion"},{name:"Visitor identifications",value:"visitorIdentificactions",sourceInit:{sourceType:y.CK.Events,eventType:y.tw.IdentifyUser},unitSingular:"identification"},{name:"Unique sessions",value:"uniqueSessions",sourceInit:{sourceType:y.CK.Sessions},unitSingular:"session"},{name:"Unique visitors",value:"uniqueVisitors",sourceInit:{sourceType:y.CK.Visitors},unitSingular:"visitor"},{name:"Unique engaged visitors",value:"uniqueEngagedVisitors",sourceInit:{sourceType:y.CK.Visitors,eventType:y.tw.Engage},unitSingular:"engaged visitor"},{name:"Time spent",value:"activeTime",sourceInit:{sourceType:y.CK.ActiveTime},unitSingular:"millisecond"}],findMatchingSourceOption=e=>{let t=Z.find(t=>t.sourceInit.sourceType===e.sourceType&&(t.sourceInit.sourceType!==y.CK.Events||t.sourceInit.eventType===e.eventType&&(t.sourceInit.eventType!==y.tw.Navigate||t.sourceInit.urlPattern===e.urlPattern)));return t};var Analytics_MetricFormModal=e=>{var t,n,r,a;let{metricInit:o,handleClose:l,open:c}=e,d=!!o,[u,m]=(0,s.useState)(null!==(t=null==o?void 0:o.name)&&void 0!==t?t:""),[p,x]=(0,s.useState)(null!==(n=null==o?void 0:o.name)&&void 0!==n&&n),[h,v]=(0,s.useState)(null!==(r=null==o?void 0:o.description)&&void 0!==r?r:""),[j,b]=(0,s.useState)(()=>o&&findMatchingSourceOption(o.numerator)||Z[0]),[M,_]=(0,s.useState)(()=>o&&o.denominator?findMatchingSourceOption(o.denominator)||Z[0]:null),C=(0,s.useMemoM,[M]),[,A]=g.Db(E),[,O]=g.Db(D),[L,q]=(0,s.useState)(!1),{workspace:K}=(0,f.cF)(),U=(0,s.useMemo)(()=>{let e=j.sourceInit.sourceType===y.CK.ActiveTime?[I.timeDuration]:[I.number];return C&&e.push(I.percentage),e},[j,C]),[B,$]=(0,s.useState)(null!==(a=null==o?void 0:o.displayFormat)&&void 0!==a?a:U[0].value);(0,s.useEffect)(()=>{U.find(e=>e.value===B)||$(U[0].value)},[B,U]),(0,s.useEffect)(()=>{p||(C?m("".concat(j.name," per ").concat(null==M?void 0:M.unitSingular)):m(j.name))},[C,M,j,p]);let handleCreate=async()=>{let e=await A({input:{name:u,description:h,workspaceId:null==K?void 0:K.id,numerator:j.sourceInit,denominator:null==M?void 0:M.sourceInit,displayFormat:B}});e.error?(0,N.Rn)((0,P.q)(e.error.message)):((0,N.Vp)("Metric created successfully"),k.Z.track("engagement_metric_created"),l())},handleUpdate=async()=>{let e=await O({input:{id:null==o?void 0:o.id,name:u,description:h,numerator:j.sourceInit,denominator:null==M?void 0:M.sourceInit,displayFormat:B}});e.error?(0,N.Rn)((0,P.q)(e.error.message)):((0,N.Vp)("Metric updated successfully"),k.Z.track("engagement_metric_updated"),l())},onSubmit=async()=>{q(!0),d?await handleUpdate():await handleCreate(),q(!1)};return(0,i.jsx)(S.Z,{open:c,title:d?"Edit metric":"Create new metric",handleClose:l,handleNext:onSubmit,nextText:L?(0,i.jsx)(w.L4p,{}):"Save",nextOnEnter:!0,nextDisabled:!u,children:(0,i.jsxs)("div",{className:"overflow-scroll pl-2 pr-3",children:[(0,i.jsx)(T.Z,{label:C?"Source (numerator)":"Source",items:Z,onChange:e=>b(e),selected:j.value,mb:1}),(0,i.jsxs)("button",{className:"mb-4 cursor-pointer text-sm text-blue-500",onClick:()=>{C?_(null):_(Z[0])},children:[C?"Remove":"Add"," denominator"]}),C&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(T.Z,{label:"Source (denominator)",items:Z,onChang),selected:null==M?void 0:M.value})}),(0,i.jsx)(T.Z,{label:"Display format",items:U,onChang),field:"name",selected:B}),(0,i.jsx)(F.oi,{labelText:"Name",placeholder:"Enter name",className:"mb-4",onChang},value:u}),(0,i.jsx)(F.gx,{labelText:"Description",placeholder:"Enter description (optional)",onChange:v,className:"input-base mb-4 w-full placeholder-gray-400",value:h})]})})},Analytics_CreateNewMetricModal=e=>{let{handleClose:t,open:n}=e;return(0,i.jsx)(Analytics_MetricFormModal,{open:n,metricInit:void 0,handleClose:t})},Analytics_EditMetricModal=e=>{let{handleClose:t,metric:n,open:r}=e;return(0,i.jsx)(Analytics_MetricFormModal,{open:r,metricInit:n,handleClose:t})},L=n(31024),q=n(56268}let K=(0,u.ZP)(deleteEngagementMetric_templateObject(),A}let U=(0,u.ZP)(getEngagementMetricData_templateObject());var B=n(78991),$=n(61660),H=n(44895),R=n(25556),V=n(3131),z=n(47857),G=n(81073);let LoadingMetricChart=()=>(0,i.jsx)(i.Fragment,{children:[...Array(7).keys()].map(e=>(0,i.jsx)("div",{className:"h-4 w-full rounded bg-gray-100"},"loading-".concat(e)))}),LoadingMetricHeade),LoadingAnalyticsMetric=()=>(0,i.jsxs)("div",{className:"flex animate-pulse flex-col py-4",children:[(0,i.jsx)("div",{className:"mb-3 space-y-2",children:[...[,,].keys()].map(e=>(0,i.jsx)(LoadingMetricHeader,{},"loading-short-".concat(e)))}),(0,i.jsx)("div",{className:"space-y-2",children:(0,i.jsx)(LoadingMetricChart,{})})]}),LoadingMetricsGrid=()=>(0,i.jsx)(GridContainer,{children:[...Array(6).keys()].map(e=>(0,i.jsx)(LoadingAnalyticsMetric,{},"loading-card-".concat(e)))}),WorkspaceMetricsEmpt),MetricCardError=e=>{let{title:t,error:n}=e;return(0,i.jsxs)("div",{className:"mt-3 flex h-full flex-1 flex-col items-center justify-center space-y-2 rounded bg-gray-50/50",children:[(0,i.jsx)("div",{className:"text-sm font-medium text-gray-600",children:t}),!1]})},MetricsPageBodyConditional=e=>{let{fetching:t,error:n,children:r,empty:a}=e;return t?(0,i.jsx)(LoadingMetricsGrid,{}):n?(0,i.jsx)(MetricCardError,{title:"Error loading analytics",error:n}):a?(0,i.jsx)(WorkspaceMetricsEmpty,{}):(0,i.jsx)(i.Fragment,{children:r})},computeChange=e=>{let{previous:t,current:n}=e,r=void 0===t?0:n-t,a=Math.abs(r),i=roundToDecimalPlaces(a,1),s=void 0===t?0:r/t,o=s<1/0?100*s:0,l=o?o>0?"up":"down":"same",c=changeStateToSign(l),d=Math.abs(o||0),u=roundToDecimalPlaces(d,1);return{sign:c,percentChange:o,percentChangeAbsValueRounded:u,percentChangeAbsValue:d,change:r,changeState:l,changeAbsValue:a,changeAbsValueRounded:i}},MetricCardLoading=()=>(0,i.jsx)("div",{className:"animate-skeletonEnter",children:(0,i.jsxs)("div",{className:"mt-3 animate-pulse space-y-2",children:[(0,i.jsx)("div",{className:"mb-4",children:(0,i.jsx)(LoadingMetricHeader,{})}),(0,i.jsx)(LoadingMetricChart,{})]})});(r=a||(a={})).Up="up",r.Down="down",r.Same="same";let changeStateToSig},roundToDecimalPlaces=(e,t)=>Math.round(e*10**t)/10**t,formatNumberToDisplay=e=>{let{value:t,displayFormat:n}=e;switch(n){case y.$K.Number:return"".concat(roundToDecimalPlaces(t,2).toLocaleString());case y.$K.Percentage:return"".concat(roundToDecimalPlaces(100*t,2).toLocaleString(),"%");case y.$K.TimeDuration:return new B.Z({milliseconds:t}).toHumanReadable()}},formatNumberAsStat=e=>{let{value:t,displayFormat:n}=e;switch(n){case y.$K.Number:case y.$K.Percentage:return formatNumberToDisplay({value:t,displayFormat:n});case y.$K.TimeDuration:return new B.Z({milliseconds:t}).toHumanReadable({showMilliseconds:!1})}},formatDateTick=(e,t)=>{let{showTime:n}=t;return(0,b.Z)(e,"MMM dd ".concat(n?"HH:mm":""))},RechartTooltip=e=>{let{active:t,payload:n,title:r,formatYAxis:a,formatXAxis:s}=e;if(!t||!n||1!==n.length)return null;let o=n[0].payload;return(0,i.jsxs)("div",{className:"min-w-[110px] rounded border bg-white text-sm",children:[(0,i.jsx)("h4",{className:"border-b px-2 py-1 font-medium",children:r}),(0,i.jsxs)("div",{className:"flex justify-between space-x-1 p-2 font-medium text-gray-500",children:[(0,i.jsxs)("span",{children:[s(o.dt)," "]}),(0,i.jsxs)("span",{children:[a(o.value)," "]})]})]})},hydrateTimeSeriesData=e=>e.map((t,n)=>{let r=computeChange({current:t.value,previous:n>0?e[n-1].value:void 0});return{...t,...r,dt:new Date(t.dt)}}),StartEndXAxisTick=e=>{let{x:t,y:n,payload:r,tickFormatter:a,ticks:s}=e,o=r.value===s[0];return(0,i.jsx)("g",{transform:"translate(".concat(t,",").concat(n,")"),children:(0,i.jsx)("text",{x:0,y:0,dy:12,textAnchor:o?"start":"end",fill:"#6b7280",fontSize:13,children:a(r.value)})})},EndYAxisTick=e=>{let{x:t,y:n,payload:r,tickFormatter:a}=e;return(0,i.jsx)("g",{transform:"translate(".concat(t,",").concat(n,")"),children:(0,i.jsx)("text",{x:0,y:0,dy:-5,textAnchor:"start",fill:"#6b7280",fontSize:10,children:a(r.value)})})},MetricTimeSeriesChart=e=>{let{id:t,chartName:n,displayFormat:r,timeSeries:a,timeResolution:s}=e,o=hydrateTimeSeriesData(a),l=s===y.M7.Hour,c="gradient-".concat(t),d=[o[0].dt,o[o.length-1].dt],u=[Math.max(...o.mae))||1];function formatXAxis(e){let t=new Date(e);return formatDateTick(t,{showTime:l}}return(0,i.jsx)($.h,{width:"100%",height:"100%",children:(0,i.jsxs)(H.T,{data:o,margin:{top:15,right:10,left:0,bottom:15},children:[(0,i.jsx)("defs",{children:(0,i.jsxs)("linearGradient",{id:c,x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,i.jsx)("stop",{offset:"5%",stopColor:"#d5e5f0"}),(0,i.jsx)("stop",{offset:"95%",stopColor:"#FFFFFF"})]})}),(0,i.jsx)(R.K,{dataKey:"dt",fontSize:12,height:8,offset:50,interval:0,axisLine:{stroke:"#d1d5db"},textAnchor:"end",tickLine:{stroke:"#e5e7eb"},ticks:d,tickFormatter:formatXAxis,tick:e=>(0,i.jsx)(StartEndXAxisTick,{ticks:d,...e})}),(0,i.jsx)(V.B,{width:10,axisLine:!1,tickLine:{stroke:"transparent"},allowDecimals:!1,textAnchor:"start",fontSize:10,style:{fontSize:10},domain:["dataMin","dataMax"],ticks:u,tickFormatter:formatYAxis,tic)}),(0,i.jsx)(z.u,{cursor:{fill:"transparent",stroke:"#d1d5db",strokeDasharray:3},wrapperStyle:{outline:"none"},content:(0,i.jsx)(RechartTooltip,{title:n,showTime:l,displayFormat:r,formatXAxis:formatXAxis,formatYAxis:formatYAxis})}),(0,i.jsx)(G.u,{type:"linear",dataKey:"value",animationDuration:1e3,strokeWidth:2,fillOpacity:1,stroke:"#316CBF",fill:"url(#".concat(c,")")})]})})},ChangeStat=e=>{let{previous:t,current:n}=e,{sign:r,changeState:a,percentChangeAbsValueRounded:s}=computeChange({previous:t,current:n});return(0,i.jsxs)("span",{className:(0,v.AK)("flex flex-row space-x-2 rounded border px-1 text-[12px] font-semibold leading-[18px]","up"===a?"border-[#13862e]/30 bg-[#effff3] text-[#13862e]":"down"===a?"border-amber-300 bg-amber-100/70 text-amber-700":"border-gray-700/20 bg-gray-100 text-gray-700"),children:[r,roundToDecimalPlaces(s,1),"%"]})};var Analytics_MetricCard=e=>{var t,n,r,a,s,o,l;let{metric:c,timeSpan:d,openEditModal:u,guideId:m,projectIds:p,canEdit:x,overrideStorageType:h,startTime:v,endTime:f}=e,j=(null==p?void 0:p.length)===0,[{data:b,fetching:M,error:w}]=(l={variables:{input:{id:c.id,timeSpan:d,guideId:m,projectIds:p,storageType:h||y.Do.Summary,startTime:d===y.U.TCustom?v:void 0,endTime:d===y.U.TCustom?f:void 0}},pause:j},g.aM({query:U,...l})),[,T]=g.Db(K),handleDelete=async()=>{if(!confirm("Are you sure you want to delete this metric?"))return;let e=await T({id:c.id});e.error?(0,N.Rn)((0,P.q)(e.error.message)):k.Z.track("engagement_metric_deleted")},_=(null==b?void 0:null===(t=b.engagementMetricData)||void 0===t?void 0:t.timeSeries)||[];return(0,i.jsxs)("div",{className:"simpleEnter flex h-56  w-full flex-col rounded-lg",children:[(0,i.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,i.jsxs)("div",{className:"flex flex-row items-center space-x-3",children:[(0,i.jsx)("div",{className:"text-base font-semibold text-gray-700",children:c.name}),c.description&&(0,i.jsx)(q.Z,{children:c.description}),(0,i.jsx)(ChangeStat,{previous:(null==b?void 0:null===(n=b.engagementMetricData)||void 0===n?void 0:n.previousPeriod)||0,current:(null==b?void 0:null===(r=b.engagementMetricData)||void 0===r?void 0:r.currentPeriod)||0})]}),x&&X&&(0,i.jsx)(L.Z,{tabs:[{id:"edit_metric",name:"Edit",onClick:u},{id:"delete_metric",name:"Delete",onClick:handleDelete}]})]}),(0,i.jsx)(i.Fragment,{children:M?(0,i.jsx)(MetricCardLoading,{}):j?(0,i.jsx)(WorkspaceMetricsEmpty,{}):w?(0,i.jsx)(MetricCardError,{title:"Error loading metric",error:w}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"my-1 mb-2 flex max-w-2xl items-center justify-between",children:(0,i.jsx)("div",{className:"w-full",children:(0,i.jsxs)("div",{className:"h-[10px]  w-full leading-[10px]",children:[(0,i.jsx)("span",{className:"align-baseline text-lg font-medium ",children:formatNumberAsStat({value:(null==b?void 0:null===(a=b.engagementMetricData)||void 0===a?void 0:a.currentPeriod)||0,displayFormat:c.displayFormat})}),(0,i.jsxs)("span",{className:"ml-1 align-baseline text-sm text-gray-500",children:[" ",formatNumberAsStat({value:(null==b?void 0:null===(s=b.engagementMetricData)||void 0===s?void 0:s.previousPeriod)||0,displayFormat:c.displayFormat})," ","last period"]})]})})}),(0,i.jsx)("div",{className:"mt-5 h-3/4",children:(0,i.jsx)(MetricTimeSeriesChart,{id:c.id,chartName:c.name,displayFormat:c.displayFormat,timeResolution:(null==b?void 0:null===(o=b.engagementMetricData)||void 0===o?void 0:o.timeResolution)||y.M7.Day,timeSeries:_})})]})})]})};let X=!1,AddMetricButton=e=>{let{onClick:t}=e;return(0,i.jsxs)("button",{className:"btn-blue text-sm",onClick:t,children:[(0,i.jsx)(w.pOD,{className:"my-auto -ml-1 mr-1"}),"Add metric"]})},GridContaine},Y={[y.U.T_1D]:0,[y.U.T_7D]:1,[y.U.T_30D]:2,[y.U.T_3M]:3,[y.U.T_6M]:4,[y.U.T_1Y]:5,[y.U.TCustom]:6},Q=Object.values(y.U).filtel).sor]),W=Q.ma]),J=new Map(W),timeSpanToHumanReadabl},ee=Q.map(e=>e!==y.U.TCustom?{value:e,name:"Last ".concat(timeSpanToHumanReadable(e))}:{value:e,name:"Custom range"}),et="all_boards",en="all_guides",er="all_projects",ea="loading",ei=new Date,es=(0,j.Z)(ei,{days:-7});var Analytics_AnalyticsPageContent=()=>{var e;let t=(0,M.useRouter)(),{timespan:n,guide:r,project:a,board:o,startTime:d,endTime:u}=(0,v.H8)(t.query),m=J.get((null==n?void 0:n.toLowerCase())||"")||y.U.T_7D,p=r||en,j=o||et,N=d||(0,b.Z)(es,"yyyy-MM-dd'T'HH:mm"),S=u||(0,b.Z)(ei,"yyyy-MM-dd'T'HH:mm"),E=a||er,{workspace:A}=(0,f.cF)(),[D]=(0,f.AH)(),k=(0,f.BH)(A),[{data:P,fetching:F,error:O}]=(e={variables:{workspaceId:A.id}},g.aM({query:x,...e})),[{data:I,fetching:Z}]=(0,h.O)({variables:{data:{workspaceId:A.id,privacy:D,limit:500}}}),L="All Product Demos",[{data:q,fetching:K}]=(0,c.H)({variables:{workspaceId:A.id,filterForCurrentUser:!0},pause:!k}),[{data:U,fetching:B}]=(0,l.d)({variables:{data:{boardId:j,archived:!1}},pause:!k||j===et}),$=(0,s.useMemo)(()=>{if(Z||B)return[{id:ea,name:"Loading..."}];if(k&&j!==et){let e=((null==U?void 0:U.boardProjects)||[]).map(e=>{let{project:t}=e;return{id:t.id,name:t.name||"Untitled (".concat(t.id,")")}});return[{id:er,name:L},...e]}{var e;let t=((null==I?void 0:null===(e=I.projects)||void 0===e?void 0:e.results)||[]).map(e=>({id:e.id,name:e.name||"Untitled (".concat(e.id,")")}));return[{id:er,name:L},...t]}},[I,Z,B,L,k,U,j]),H=(0,s.useMemo)(()=>{if(K)return[{id:ea,name:"Loading..."}];let e=((null==q?void 0:q.boards)||[]).ma));return[{id:et,name:"All boards"},...e]},[q,K]),R=(0,s.useMemo},[P]),V=(0,f.j_)(y.KG.Analytics),z=V===y.KA.Edit,[G,Y]=(0,s.useState)(!1),[Q,W]=(0,s.useState)(void 0),eo=(0,s.useMemo),[Q,R]),el=(0,s.useMemo)(()=>{var e;return E!==er?[E]:k&&j!==et?null==U?void 0:null===(e=U.boardProjects)||void 0===e?void 0:e.ma}):void 0},[k,j,E,U]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,i.jsx)(_.Z,{title:"Analytics"}),z&&X&&(0,i.jsx)(AddMetricButton,{onClick:()=>Y(!0)})]}),(0,i.jsx)("div",{className:"mb-6",role:"separator"}),(0,i.jsxs)("div",{className:"mb-4 flex flex-row justify-between space-x-2",children:[(0,i.jsxs)("div",{className:"flex flex-col space-y-2 text-sm lg:flex-row lg:space-x-2 lg:space-y-0",children:[k&&(0,i.jsx)(C.Z,{className:"text-sm font-medium",placeHolder:K?"Loading...":"Select board",items:H,selected:j,renderSelectedIcon:()=>(0,i.jsx)("div",{className:"mr-1 text-gray-500",children:"Board:"}),onChange:e=>{let{id:n}=e;if(n!==ea){if(n===et){let{board:e,...n}=t.query;t.push({query:{...n}})}else t.push({query:{...t.query,board:n}})}}}),(0,i.jsx)(C.Z,{className:"text-sm font-medium",placeHolder:Z?"Loading...":"Select project",items:$,selected:E,renderSelectedIco),onChange:e=>{let{id:n}=e;if(n!==ea){if(n===er){let{project:e,...n}=t.query;t.push({query:{...n}})}else t.push({query:{...t.query,project:n}})}}})]}),m!==y.U.TCustom?(0,i.jsx)("div",{className:"min-w-[100px]",children:(0,i.jsx)(T.Z,{mb:0,className:"text-sm font-medium shadow-sm",items:ee,selected:m,renderIcon:()=>(0,i.jsx)(w.Que,{className:"mr-1.5 h-3.5 w-3.5 text-gray-500"}),onChange:e=>{let{value:n}=e;return t.push({query:{...t.query,timespan:n.toLowerCase()}})}})}):(0,i.jsxs)("div",{className:"flex flex-col-reverse xl:flex-row xl:space-x-1 xl:space-y-0",children:[(0,i.jsxs)("div",{className:"flex flex-col space-y-2 pt-2 xl:flex-row xl:space-x-1 xl:space-y-0 xl:pt-0",children:[(0,i.jsx)(DateTimeInput,{id:"custom-range-start",name:"custom-range-start",value:N,onChange:e=>{t.push({query:{...t.query,startTime:e}})},debounce:1e3}),(0,i.jsx)(DateTimeInput,{id:"custom-range-end",name:"custom-range-end",value:S,onChange:e=>{t.push({query:{...t.query,endTime:e}})},debounce:1e3})]}),(0,i.jsx)(T.Z,{mb:0,className:"text-sm font-medium shadow-sm",items:ee,selected:m,renderIco),onChange:e=>{let{value:n}=e;return t.push({query:{...t.query,timespan:n.toLowerCase()}})}})]})]}),(0,i.jsx)(MetricsPageBodyConditional,{empty:0===R.length,fetching:F,error:O,children:(0,i.jsx)(GridContainer,{children:R.map(e=>(0,i.jsx)(Analytics_MetricCard,{canEdit:z,guideId:p===en?void 0:p,projectIds:el,openEditModa),timeSpan:m,metric:e,overrideStorageType:"storageType"in t.query?t.query.storageType:void 0,startTime:new Date(N),endTime:new Date(S)},e.id))})}),!Q&&(0,i.jsx)(Analytics_CreateNewMetricModal,{open:G,handleClos)}),Q&&(0,i.jsx)(Analytics_EditMetricModal,{open:!!eo,handleClos),metric:eo})]})},eo=n(18406),el=n(170),ec=n(81291),ed=n(54532);let AnalyticsPage=()=>(0,i.jsxs)(ed.Z,{workspaceItem:y.KG.Analytics,children:[(0,i.jsx)(ec.Z,{title:"Analytics",includeSlug:!0}),(0,i.jsx)(eo.Z,{children:(0,i.jsx)(Analytics_AnalyticsPageContent,{})})]});AnalyticsPage.getLayout=e=>(0,i.jsx)(el.Z,{navLeft:!0,children:e});var eu=AnalyticsPage},78991:function(e,t){"use strict";let secondsToMilliseconde,minutesToMilliseconds=e=>secondsToMilliseconds(60*e),hoursToMilliseconds=e=>minutesToMilliseconds(60*e),daysToMillisecond);let Duratio};t.Z=Duration}},function(e){e.O(0,[3211,696,8426,3265,1617,4637,5837,9391,8842,2814,4054,5306,7330,8583,6870,7156,6456,170,9774,2888,179}),_N_E=e.O()}]);
//# sourceMappingURL=analytics-b83c9a422eedd5d6.js.map