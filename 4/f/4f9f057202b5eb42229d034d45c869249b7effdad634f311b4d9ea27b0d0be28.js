const e="serviceWorker";unction n(){if(!r())return Promise.reject();try{return window.navigator.serviceWorker.register("/service-worker.js").then(().catch((e=>(window.opbox.plugin.get("sentry").then(().catch((),Promise.reject())))}catch(e){return Promise.reject()}}function i(){if(!r())return Promise.resolve(void 0);try{return window.navigator.serviceWorker.getRegistration()}catch(e){return Promise.resolve(void 0)}}const t={headers:{Accept:"application/vnd.allegro.public.v1+json","Content-Type":"application/json"},withCredentials:!0};function o(){return r()&&"PushManager"in window}unction c(e){return void 0===e?Promise.resolve(null):e.pushManager.getSubscription()}function a(e){return void 0===e?Promise.reject():c(e).then((e=>s(e)?e.unsubscribe().then(():Promise.reject()))}function u(e){const{endpoint:r,keys:{auth:n,p256dh:i}={}}=e.toJSON();return window.opbox.edge.post("/notifications/subscriptions",{endpoint:r,auth:n,p256dh:i},t)}function p(e){return window.opbox.edge.post("/notifications/subscriptions/remove",{endpoint:e},t)}const l=()=>i().then(c).then(s).catch((),h=d={serviceWorkerConfiguration:w,applicationServerKey:b}=(({pluginName:e,clientImplementationVersion:r})=>{try{return JSON.parse(window.document.querySelector(`script[data-serialize-plugin-name="${e}"][data-civ="${r}"]`).textContent)}catch(n){return window.opbox.reportError(Error(`Missing serialized props of plugin "${e}", with civ "${r}"`)),{}}})({pluginName:e,clientImplementationVersion:"f8f"});w&&w.enabled&&b&&window.opbox.plugin.register({name:e},new class{constructor({applicationServerKey:e}){this.applicationServerKey=void 0,this.subscribeToWebPush=()=>(o()?new Promise(((e,r)=>{const n=Notification.requestPermission(();n&&n.then(e,r)})).then((e=>{if("granted"!==e)throw Error("Permission not granted.")})):Promise.reject()).then(n).then((e=>((e,r)=>{const n={userVisibleOnly:!0,applicationServerKey:this.applicationServerKey};return e.pushManager.subscribe(n)})(e))).then(u),this.getPublicApi=()=>({isSubscribedToWebPush:l,unsubscribeFromWebPush:h,isWebPushSupported:d,subscribeToWebPush:this.subscribeToWebPush}),this.applicationServerKey=((e)}}({window,applicationServerKey:b}).getPublicApi()),i().then((e=>{e&&"function"==typeof window.cm&&window.cm("send","event",{category:"Performance",label:"ServiceWorkerRegistered"})}));
//# sourceMappingURL=index.es6_abf0e332.js.mapm=l(),p=r("FID"),v=function(e){e.startTime<m.timeStamp&&(p.value=e.processingStart-e.startTime,p.entries.push(e),f.add(p),u())},y=o("first-input",v);u=d(e,p,i),y&&c((function(){y.takeRecords().map(v),y.disconnect()}),!0),y&&s((function(){var o;p=r("FID"),u=d(e,p,i),a=[],n=-1,t=null,b(addEventListener),o=v,a.push(o),S()}))},e.getLCP=function(e,t){var n,i=l(),a=r("LCP"),u=function(e){var t=e.startTime;t<i.timeStamp&&(a.value=t,a.entries.push(e)),n()},m=o("largest-contentful-paint",u);if(m){n=d(e,a,t);var p=function(){f.has(a)||(m.takeRecords().map(u),m.disconnect(),f.add(a),n())};["keydown","click"].map((function(e){addEventListener(e,p,{once:!0,capture:!0})})),c(p,!0),s((function(i){a=r("LCP"),n=d(e,a,t),requestAnimationFrame((function(){requestAnimationFrame((function(){a.value=performance.now()-i.timeStamp,f.add(a),n()}))}))}))}},e.getTTFB=function(e){var t,n=r("TTFB");t=function(){try{var t=performance.getEntriesByType("navigation")[0]||function(){var e=performance.timing,t={entryType:"navigation",startTime:0};for(var n in e)"navigationStart"!==n&&"toJSON"!==n&&(t[n]=Math.max(e[n]-e.navigationStart,0));return t}();n.value=n.delta=t.responseStart,n.entries=[t],e(n)}catch(e){}},"complete"===document.readyState?setTimeout(t,0):addEventListener("pageshow",t)},Object.defineProperty(e,"__esModule",{value:!0})}));
