![function(e,t,n){"use strict";e.exports=n(185)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(0),s=(r=a)&&r.__esModule?r:{default:r},u=n(1),c=n(278);function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var p=p||{env:{}},d=function(e){eturn function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"componentDidMount",value:function(){var e=this.props.children;"production"!==p.env.NODE_ENV&&null!=e&&console.info("<InlineSVG />: `children` prop will be ignored.")}},{key:"render",value:function(){var e=void 0,t=void 0,n=void 0,r=this.props,i=r.element,a=r.raw,u=r.src,l=r,["element","raw","src"]);return!0===a&&(e="svg",n=(0,c.extractSVGProps)(u),t=(0,c.getSVGFromSource)(u).innerHTML),t=t||u,e=e||i,n=n||{},s.default.createElement(e,o({},n,l,{src:null,children:null,dangerouslySetInnerHTML:{__html:t}}))}}]),t}(s.default.Component);t.default=d,d.defaultProps={element:"i",raw:!1,src:""},d.propTypes={src:u.string.isRequired,element:u.string,raw:u.bool}},function(e,t,n){"use strict";var r=n(8),o=n(21).map,i=n(119),a=n(39),s=i("map"),u=a("map");r({target:"Array",proto:!0,forced:!s||!u},{map:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})},[||o(e,t)||i()}},function(e,t){e.exports='<svg viewBox="0 0 64 64" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>conversations-company-logo-default</title><desc>Created with Sketch.</desc><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="conversations-company-logo-default"><rect id="bg" fill="#E3EBFC" x="0" y="0" width="64" height="64"></rect><path d="M33.5748056,28.257086 C40.4376051,35.8260122 26.0349045,16.3640271 25.5271156,15.4806038 C24.588419,13.8475109 25.5223809,12.704607 26.0339047,12.361228 C27.5109096,11.3697347 28.8783848,12.6028143 29.8696857,13.8475109 C31.3761084,15.7390045 38.7277036,25.3830953 40.5355637,27.0617432 C42.3434238,28.7403912 44.3770754,28.2871371 44.3770754,25.2381995 C44.3770754,22.1892619 46.7687077,18.5266703 50.0908226,18.8137822 C53.4129375,19.1008942 53.4129375,21.2921327 52.4278218,22.9975777 C51.4427062,24.7030228 50.2050555,26.9754182 50.7185306,31.1071508 C51.2320057,35.2388833 53.4192413,42.5219567 49.5460195,46.0936295 C45.6727976,49.6653023 44.5786067,50.5369742 42.8624386,51.7906965 C41.1462704,53.0444187 36.1918474,54.5259164 30.4756168,49.3980968 C24.7593863,44.2702772 18.4991167,38.6960941 17.2035855,37.4787394 C15.9080543,36.2613847 14.7771866,33.6346399 16.9567813,32.5 C19.1363759,31.3653601 27.0965765,38.4223807 27.5109096,38.7883528 C27.9252428,39.1543248 28.3002247,39.2978808 27.8029868,38.7883528 C21.1484033,31.9692899 16.5047188,27.820858 15.4585726,26.1179105 C13.8415464,23.4856681 16.8440765,20.7944719 19.1363759,22.9975777 C21.4286753,25.2006835 29.2637546,33.3385849 29.8696857,33.6122983 C30.2736398,33.7947739 30.2736398,33.6724643 29.8696857,33.2453693 C23.5622966,25.408744 19.9845267,20.6823069 19.1363759,19.0660579 C17.8641498,16.6416845 17.9334918,15.4733303 19.1363759,14.7951718 C20.33926,14.1170134 22.2821748,15.0242872 24.1240373,17.6917487 C25.3519457,19.4700564 28.5022018,22.9918355 33.5748056,28.257086 Z" id="Path-2" stroke="#356AE6" stroke-width="2" fill="#FFFFFF" fill-rule="nonzero" stroke-linecap="square" stroke-linejoin="round"></path><g id="group-01" transform="translate(26.443885, 29.648031) rotate(170.000000) translate(-26.443885, -29.648031) translate(6.443885, 9.648031)" fill="#F3376B" fill-rule="nonzero"><path d="M8.22173541,37.60155 L8.44560531,38.3595368 L6.936581,38.8083162 L6.7127111,38.0503294 C5.80403977,34.9737172 3.92754543,32.2712186 1.38420589,30.3382253 L0.756416838,29.861092 L1.70570548,28.6005548 L2.33349453,29.0776881 C5.14342898,31.2132994 7.21697133,34.1995835 8.22173541,37.60155 Z" id="Oval-2" transform="translate(4.601011, 33.704435) rotate(184.000000) translate(-4.601011, -33.704435) "></path><path d="M12.229739,36.6176596 L12.4536089,37.3756464 L10.9445846,37.8244258 L10.7207147,37.066439 C9.55991323,33.1361555 7.16292924,29.6840556 3.91419786,27.2149492 L3.2864088,26.7378158 L4.23569744,25.4772786 L4.86348649,25.954412 C8.37881279,28.6261364 10.9728448,32.3620218 12.229739,36.6176596 Z" id="Oval-2-Copy" transform="translate(7.870009, 31.650852) rotate(184.000000) translate(-7.870009, -31.650852) "></path><path d="M35.8689758,12.9960115 L36.0926064,13.7539452 L34.583476,14.2032031 L34.3598453,13.4452694 C33.4521451,10.3688727 31.5765271,7.66689831 29.0338404,5.73465307 L28.4062125,5.2577044 L29.3558704,3.99684494 L29.9834983,4.47379361 C32.7927116,6.60857837 34.8652855,9.59428326 35.8689758,12.9960115 Z" id="Oval-2"></path><path d="M39.7073136,11.972905 L39.9309442,12.7308388 L38.4218137,13.1800967 L38.1981831,12.422163 C37.0386222,8.49215474 34.6427577,5.04072446 31.3948601,2.57257356 L30.7672322,2.09562489 L31.7168902,0.83476543 L32.3445181,1.3117141 C35.8589421,3.98240452 38.4517626,7.71756528 39.7073136,11.972905 Z" id="Oval-2-Copy"></path></g></g></g></svg>'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 9"><path fill-rule="nonzero" d="M3.131 6.445L8.245.356a.978.978 0 0 1 1.41-.103c.417.374.462 1.026.1 1.457L3.932 8.644a.979.979 0 0 1-1.47.047L.287 6.4A1.057 1.057 0 0 1 .3 4.94a.978.978 0 0 1 1.415.013L3.13 6.445z">:!0,value:t})}},function(e,tn r.constructor=t,t.prototype=r,t}},functi{var l=n[c];r(e,l)||s(e,l,u(t,l))}}},fun/g,(function(e,n){return r(n,t)}))}},function(e,t,n){var r=n(34);e.exporangeError("Wrong offset");return n}},function(e,t){e.exports="\t\n\v\f\r 0,t.createTokenClass=function(){return function(e){e&&(this.v=e)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));n(28),n(51),n(18);var r=n(0),o=n.n(r);function i(){return(i=Object.assign||function(e){for(var t,n=1;n<arguments.length;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)}var a=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)0>t.indexOf(r[o])&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},s=function(e){var t=e.error,n=e.label,r=e.onChange,s=e.value,u=e.id,c=e.disabled,l=e.required,f=a(e,["error","label","onChange","value","id","disabled","required"]);return o.a.createElement("div",{className:"widget_messages_capture-form-message_field"},o.a.createElement("label",{htmlFor:u,className:"widget_messages_capture-form-message_field_label "+(t?"error":"")},n+(void 0!==l&&l?"*":""),o.a.createElement("input",i({id:u,className:"widget_messages_capture-form-message_input "+(c?"disabled":"")+" "+(t?"error":""),onChange:r,value:s,disabled:c},f)),!!t&&o.a.createElement("div",{className:"||!c},{join:funcents)},t.devToolsEnhancer=function(){return function(e){return e}}},function(e,t,n){t.no=t.noCase=n(34),t.dot=t.dotCase=n(232),t.swap=t.swapCase=n(233),t.path=t.pathCase=n(234),t.upper=t.upperCase=n(40),t.lower=t.lowerCase=n(70),t.camel=t.camelCase=n(146),t.snake=t.snakeCase=n(147),t.title=t.titleCase=n(235),t.param=t.paramCase=n(236),t.kebab=t.kebabCase=t.paramCase,t.hyphen=t.hyphenCase=t.paramCase,t.header=t.headerCase=n(237),t.pascal=t.pascalCase=n(238),t.constant=t.constantCase=n(239),t.sentence=t.sentenceCase=n(240),t.isUpper=t.isUpperCase=n(241),t.isLower=t.isLowerCase=n(242),tll(n,r)&&(e[r]=n[r])}return e},n.apply(this,arguments)}e.exports=n},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 108 11"><g fill-rule="evenodd"><path d="M80.733.084h-.72v.741c0 .186.078.408.449.408h.742V.512c0-.196-.082-.428-.47-.428M80.67 2.445h-.595v6.028c0 .25.158.425.397.446v.024h.669v-6.05c0-.293-.163-.448-.47-.448M45.27 7.161a.543.543 0 0 0-.759-.024c-.783.644-1.481.907-2.411.907-1.846 0-3.291-1.555-3.291-3.541 0-1.995 1.414-3.5 3.29-3.5.896 0 1.649.281 2.37.885.176.155.464.213.676-.023.187-.187.376-.397.378-.399l.034-.038-.036-.035C44.76.67 43.82 0 42.12 0c-2.479 0-4.42 1.996-4.42 4.545 0 2.578 1.891 4.523 4.399 4.523 1.397 0 2.433-.46 3.464-1.541l.03-.032-.026-.036a2.63 2.63 0 0 0-.297-.298M61.155 2.277c-.919 0-1.642.387-2.207 1.183-.253-.492-.835-1.224-2.055-1.224-1.05 0-1.615.533-2.016 1.096v-.459c0-.312-.18-.491-.491-.491h-.575V8.88h.595c.285 0 .45-.073.45-.45V5.193c0-1.132.725-1.953 1.723-1.953 1.001 0 1.599.691 1.599 1.849V8.43c0 .303.167.47.47.47h.575v-3.73c0-1.335.865-1.932 1.723-1.932 1.016 0 1.599.681 1.599 1.87v3.26c0 .263.058.532.49.532h.555V4.9c0-1.618-.933-2.623-2.435-2.623M70.715 5.673c0 1.42-.907 2.413-2.205 2.413-1.114 0-2.267-.91-2.267-2.434 0-1.51 1.153-2.413 2.267-2.413 1.095 0 2.205.836 2.205 2.434m-2.017-3.375c-.969 0-1.753.429-2.392 1.308v-.67c0-.335-.184-.512-.533-.512h-.512v7.992c0 .307.155.47.45.47h.595v-3.09c.639.842 1.423 1.251 2.392 1.251 1.504 0 3.103-1.182 3.103-3.374s-1.599-3.375-3.103-3.375M88.078 5.38c0 1.328-1.163 2.121-2.288 2.121-1.233 0-2.163-.92-2.163-2.142 0-1.228.91-2.12 2.163-2.12 1.11 0 2.288.75 2.288 2.141m-.042-2.486v.552c-.442-.57-1.206-1.19-2.434-1.19-.78 0-1.55.3-2.112.824-.612.57-.95 1.372-.95 2.259 0 1.988 1.578 3.06 3.062 3.06.966 0 1.77-.405 2.455-1.24v.603c0 1.415-.826 2.226-2.267 2.226-.694 0-1.36-.174-1.979-.515-.168-.104-.284-.149-.389-.152-.127-.002-.241.066-.33.21-.167.271-.23.397-.232.402l-.02.04.036.026c.852.602 1.84.908 2.935.908 2.091 0 3.29-1.154 3.29-3.165v-5.34h-.574c-.2 0-.49.176-.49.492M94.022 2.298c-.911 0-1.631.38-2.141 1.128v-.553c0-.31-.247-.45-.491-.45h-.575v6.499h1.066l-.021-3.709c0-1.15.769-1.953 1.87-1.953 1.08 0 1.724.699 1.724 1.87v3.343c0 .306.136.449.428.449h.637V4.9c0-1.58-.98-2.602-2.497-2.602M75.719 2.34c-.817 0-1.54.163-2.341.527l-.044.02.016.045c.001.003.106.296.189.504.086.215.328.22.527.154a4.132 4.132 0 0 1 1.57-.31c1.192 0 1.848.598 1.848 1.682V6.51c0 .974-.874 1.682-2.079 1.682-.75 0-1.556-.383-1.556-1.223 0-.788.642-1.222 1.807-1.222h.522c.317 0 .47-.147.47-.45v-.365h-1.076c-1.772 0-2.789.75-2.789 2.058 0 .991.762 2.058 2.434 2.058.914 0 1.695-.35 2.267-1.014v.44c0 .292.143.428.45.428h.574v-3.96c-.02-1.677-1.011-2.6-2.79-2.6M49.413 2.34c-1.008 0-1.72.253-2.34.527l-.045.02.016.045c.001.003.106.296.189.504.086.215.327.221.527.154a4.132 4.132 0 0 1 1.57-.31c1.191 0 1.848.598 1.848 1.682V6.51c0 .974-.874 1.682-2.079 1.682-.75 0-1.556-.383-1.556-1.223 0-.788.641-1.222 1.807-1.222h.514c.317 0 .47-.147.47-.45v-.365h-1.068c-1.772 0-2.789.75-2.789 2.058 0 .991.762 2.058 2.434 2.058.914 0 1.695-.35 2.267-1.014v.44c0 .292.143.428.45.428h.574v-3.96c-.02-1.677-1.012-2.6-2.79-2.6M107.259 4.753c-.166-.124-6.121-4.275-6.374-4.451l-.082-.057v1.019c0 .324.17.447.384.603l.034.024c.291.214 4.534 3.16 5.1 3.552-.57.395-4.869 3.376-5.14 3.55-.325.217-.357.358-.357.65v1.095l6.434-4.605h.001c.287-.216.352-.473.355-.656v-.118c0-.237-.12-.44-.355-.606"></path><path d="M103.537 5.906c.166 0 .333-.065.51-.196.21-.145.397-.27.397-.27l.064-.043-.063-.044c-.028-.02-2.804-1.946-3.092-2.13-.132-.097-.284-.117-.406-.055-.113.057-.178.177-.178.327v.654l.022.015c.02.014 1.927 1.34 2.3 1.589.153.102.299.153.446.153M14.911 7.433c-.222-.223-.516-.094-.657.019-.48.435-1.024.655-1.616.655-1.283 0-2.288-1.07-2.288-2.434 0-1.365.978-2.434 2.226-2.434.7 0 1.179.31 1.554.614.278.232.492.243.697.039.167-.166.356-.376.358-.378l.031-.036-.032-.035c-.74-.792-1.537-1.145-2.587-1.145-1.87 0-3.333 1.492-3.333 3.396 0 1.86 1.495 3.374 3.333 3.374 1.365 0 2.123-.68 2.63-1.272l.035-.04-.042-.035s-.105-.085-.309-.288M21.853.084h-.721v.741c0 .186.078.408.45.408h.741V.575c0-.299-.185-.491-.47-.491M21.77 2.445h-.596v6.028c0 .25.157.425.397.446v.024h.668v-6.05c0-.293-.162-.448-.47-.448M28.637 2.79c-.094.226-1.68 4.069-1.978 4.794-.3-.725-1.882-4.567-1.958-4.794-.107-.257-.306-.387-.592-.387h-.748l.032.073c.025.059 2.55 5.895 2.653 6.121.114.273.281.325.55.325h.125c.26 0 .419-.103.528-.344.104-.228 2.629-6.023 2.654-6.081l.032-.073h-.727c-.281 0-.468.12-.57.366M35.183 5.286h-2.491c-.281 0-.45.168-.45.45v.408l.054-.001c1.187-.019 2.567-.02 3.138-.02.336 0 .593-.094.764-.278.175-.189.255-.474.229-.825-.156-1.64-1.352-2.742-2.978-2.742-1.78 0-3.123 1.46-3.123 3.395s1.396 3.395 3.249 3.395c1.085 0 1.91-.372 2.671-1.208l.036-.04-.04-.035s-.147-.125-.315-.272c-.25-.2-.487-.123-.611.002-.47.426-1.032.634-1.72.634-1.186 0-2.072-.855-2.205-2.128 0-.002-.02-.146-.02-.327 0-.203.02-.347.02-.35.125-1.252.954-2.126 2.016-2.126 1.07 0 1.848.72 1.934 1.796.019.104.01.182-.026.225-.026.031-.07.047-.132.047M5.143.406V.405c-.129-.256-.267-.342-.55-.342h-.25c-.208 0-.392.116-.507.323L.033 8.848 0 8.922h.687c.282 0 .47-.127.632-.427l.843-1.85H4.85c.331 0 .554-.206.554-.512v-.47H2.585l1.904-4.27c.391.887 3.055 6.935 3.17 7.185.16.344.563.344.696.344h.624l-.033-.074C8.909 8.767 5.266.675 5.143.406M19.624 8.002c-.097-.072-.241-.086-.397-.04-.234.065-.392.103-.613.103-.672 0-1.013-.34-1.013-1.013l-.02-3.667h2.026v-.45c0-.337-.287-.49-.554-.49H17.58V.595c0-.298-.21-.49-.533-.49h-.512v7.093c0 1.193.657 1.85 1.85 1.85.457 0 .987-.112 1.318-.278l.026-.013.003-.028c0-.008.021-.193.021-.424 0-.17-.07-.259-.13-.303"></path></g></svg>'},function(e,t,n){e.exports=n(308)},function(e,t){e.exports='<svg viewBox="0 0 66 66" xmlns="http://www.w3.org/2000/svg"><circle class="path" fill="transparent" stroke-width="8" cx="33" cy="33" r="30" stroke="url(#gradient)"></circle><linearGradient id="gradient"><stop offset="50%" stop-color="#FFFFFF" stop-opacity="1"></stop><stop offset="65%" stop-color="#FFFFFF" stop-opacity=".5"></stop><stop offset="100%" stotrict";var r=n(159);n.d(t,"Input",(function(){return r.a}));n(160)},function(e,t){e.exports='<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21.3333333 0C22.8060927 0 24 1.19390733 24 2.66666667V22.2784304c0 .4064776-.1437981.7998502-.4059453 1.1104993-.6133118.7267858-1.6996755.8187746-2.4264613.2054628l-4.7592979-4.016223c-.7697489-.6495671-1.744476-1.0058806-2.7516755-1.0058806H2.66666667C1.19390733 18.5722889 0 17.3783816 0 15.9056223V2.66666667C0 1.19390733 1.19390733 0 2.66666667 0H21.3333333zM4 11.9959463v2.6657658h8v-2.6657658H4zm0-3.99864878v2.66576588h13.3333333V7.99729752H4zm0-3.99864876V6.66c:function(e,t){return o(e,this,n,t.cache.create(),t.serializer)}}},function(e,t){e.exports='<svg viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M4 0H2V2H1C0.482233 2 0.0563729 2.3935 0.00516289 2.89776C0.00174889 2.93137 0 2.96548 0 3V5V11C0 11.5523 0.447715 12 1 12H11C11.5523 12 12 11.5523 12 11V5V3C12 2.44772 11.5523 2 11 2H10V0H8V2H4V0ZM9 6V8H7V6H9ZM2 5H10V10H2V5Z"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M6 12C9.31371 12 12 9.31371 12 6C12 2.68629 9.31371 0 6 0C2.68629 0 0 2.68629 0 6C0 9.31371 2.68629 12 6 12ZM7 5.58579V2H5V6.41421L7.79289 9.20711L9.20711 7.79289L7 5.58579Z"></path></svg>'},function(e,t,n){"use striototype.init=function(e){this.ablyClient=new r.Realtime.Promise(e)},e.prototype.on=function(e,t){this.ablyClient&&(2===arguments.length?this.ablyClient.connectioion(e){return this.ablyClient?this.ablyClient.channels.get(e):null},e.prototype.enterPresence=function(e){vaent=function(e,t){var n=this.getChannel(e);n&&n.presence.update(t)},e.prototype.subscribe=function(e,t,npublish=function(e,t,n){var r=this.getChannel(e);r&&r.publish(t,n)},e}();t.a=new o},function(e,t,n){(function(t){
/**
 * @license Copyright 2020, Ably
 *
 * Ably JavaScript Library v1.1.24
 * https://github.com/ably/ably-js
 *
 * Ably Realtime Messaging
 * https://www.ably.io
 *
 * Released under the Apache Licence v2.0
 */
var n,r,o,i={},a="object"==typeof window&&window||"object"tring)},clone:function(){returnunction(e=t?t:4*e.length},toString:function(e){return(e||s).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,o=e.sigBytes;if(this.clamp(),r%4)for(var i=0;i<o;i++){var a=n[i>>>2]>>>24-i%4*8&255;t[r+i>>>2]|=a<<24-(r+i)%4*8}else if(n.length>65535)for(i=0;i<o;i+=4)t[r+i>>>2]==this.on(){va));n=987654071*s(),r.push(429496i>>>4)>3]|=parseInt(e.substr(2]>>>2+)n[r>>>2]|=(255&e.chu.stri,parse:function(e){return u.parse(unescape(e.extend(&&(e=c.palock(r,l);var f=r.splice(0,u);n.sigBytes-=c}return new i.init(f,c)},clone:function(){var e=o.clone.call(this);return e._data=this._data.clonextend(),init:function(e){this.cfg=this.cfg.extend(e),this.r()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){returfunction(e){returnn(e){return function(t,n){retu});t.SHA256=o._createHelper(l),t.HmacSHA256=o._createHmacHelper]^=154reset:function(){var e=this._hasher;e.reset(),e.update(this._iKealize(e);return t.reset(),t.finalize(this._oKey.clone().concat(r u=r.t(u))>>>6-u%4*2;a[s>>>2]|=(c|l)<<24-s%4*8,s++}return t.create(a,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),s.lib.Cipher||function(e){var t=s,n=t.lib,r=n.Base,o=n.WordArray,i=n.BufferedBlockAlgorithm,a=t.enc,u=(a.Utf8,a.Base64),c=t.algo.EvpKDF,l=n.Cipher=i.extend({cfg:r.extend(),createEncryptor:functioncrypt.cfg=t,this.reeset()},p,finalize:function(e){return e&&this._append(e),this._doFinalize()},k(t,n,r,o)},decrypt:function(n,r,o){return e(amCipher=l.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),t.mode={}),p=n.BlockCipherMode=r.extend({createEncrypt)},createDecryptor:function(e,t){return this.Decryptor.cn+o);r.decryptBlock(e,n),tr<<8|rnpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},g=(n.BlockCipher=l.extend({cfg:l.cfg.extend({mode:d,padding:h}),reset:function(){l.reset.call(this);var e=this.cfg,t=e.iv,n=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var r=n.createEncryptor;else{r=n.createDecryptor;this._miwords)},_doPr t=this._process(!0)}else{t=this._process(!ckSize:4}e)},toString:function(e){return(e||thi684,17.splice(0,4),t.sigBytes-=16}return g.create({ciphertext:t,salt:r})}.mode,pas._pars)},_parse:function(e,t){return"s.slice(t),4*n);return i.sigBytes=4*t,g.create({key:i,iv:a,salt:r})}},iv=o.iv;e.ivSize,t.salt);return r.iv=o.iv,v.decrypt.call(this,e,t,o.key,r)}})}(),function(){var e=s,t=e.lib.Bloc>16,p[h]=y<<8|y>>>24,d[h]=y,n?(n=g^e[e[e[v^g]]],s^=e[e[s]]):n=s=1}}();var h=[0,1,2,4,8,16,32,64,128,27,54],g=n.AES=t.extend({_doReset:function(){for(var e=this._key,t=e.words,n=e.sigBytes/4,o=4*((this._nRounds=n+6)+1),i=this._keySchedule=[],a=0;a<o;a++)if(a<n)i[a]=t[a];else{var s=i[a-1];a%n?n>6&&a%n==4&&(s=r[s>>>24]<<24|r[s>>>16&255]<<16|r[s>>>8&255]<<8|r[255&s]):(s=r[(s=s<<8|s>>>24)>>>24]<<24|r[s>>>16&255]<<16|r[s>>>8&255]<<8|r[255&s],s^=h[a/n|0]<<24),i[a]=i[a-n]^s}for(var u=this._invKeySchedule=[],c=0;c<o;c++){a=o-c;if(c%4)s=i[a];else s=i[a-4];u[c]=c<4||a<=4?s:l[r[s:function(e,t,t,this._invKes[l>>>8&255]<<8|s[255&f])^n[d++];e[t]=g,e[t+1]=m,e[t+2]=v,e[t+3]=y},keySize:8});e.AES=t._createHelper(g)}(),function(){if("undefined"!=typeof ArrayBuffer){var e=s.lib.WordArray,t=e.init;(e.init=function(e){if(e instanceof ArrayBuffer?e=new Uint8Array(e):(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||"undefined"!=typeof Float32Array&&e instanceof Float32Array||"undefined"!=typeof Float64Array&&e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var n=e.byteLength,r=[],o=0;o<n;o++)r[o>>>2]|=e[o]<<24-o%4*8;t.call(this,r,n)}else t.apply(this,arguments)}).prototype=e}}();var u=function(){function e(){}return e.addListener=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,(function(){n.apply(e,arguments)}))},e.removeListener=function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent("on"+t,(function(){n.apply(e,arguments)}))},e.addMessageListener=emoveMessageListenere",n)},e.addUnloadListener=function(t){e.addListener(a,"unload",t)},e}(),c=function(){"use strict";var e={};function t(e,t,n){e.byteLength;for(var r=0,o=n.length;r<o;r++){var i=n.charCodeAt(r);if(i<128)e.setUint8(t++,i>>>0&127|0);else if(i<2048)e.setUint8(t++,i>>>6&31|192),e.setUint8(t++,i>>>0&63|128);else if(i<65536)e.setUint8(t++,i>>>12&15|224),e.setUint8(t++,i>>>6&63|128),e.setUint8(t++,i>>>0&63|128);else{if(!(i<1114112))throw new Error("bad codepoint "+i);e.setUint8(t++,i>>>18&7|240),e.setUint8(t++,i>>>12&f(!(o<1114112))throw new Error("bad codepoint "+o);t+=4}}return t}e.inspect=function(e){if(void 0===e)return"undefined";var t,n;e instanceof ArrayBuffer?(n="ArrayBuffer",t=new DataView(e)):e instanceof DataView&&(n="DataView",t=e);if(!t)return JSON.stringify(e);for(var r=[],o=0;o<e.byteLength;o++){if(o>20){r.push("...");break}var i=t.getUint8(o).toString(16);1===i.length&&(i="0"+i),r.push(i)}return"<"+n+" "+r.join(" ")+">"},e.utf8Write=t,e.utf8Read=n,e.utf8ByteCount=r,e.encode=function(e,n){var o=function e(t,n){var o=typeof t;if("string"===o){if((a=r(t))<32)return 1+a;if(a<256)return 2+a;if(a<65536)return 3+a;if(a<4294967296)return 5+a}ArrayBuffer.isView&&ArrayBuffer.isView(t)&&(t=t.buffer);if(t instanceof ArrayBuffer){if((a=t.byteLength)<256)return 2+a;if(a<65536)return 3+a;if(a<4294967296)return 5+a}if("number"===o){if(Math.floor(t)!==t)return 9;if(t>=0){if(t<128)return 1;if(t<256)return 2;if(t<65536)return 3;if(t<4294967296)return 5;if(t<0x10000000000000000)return 9;throw new Error("Number too big 0x"+t.toString(16))}if(t>=-32)return 1;if(t>=-128)return 2;if(t>=-32768)return 3;if(t>=-2147483648)return 5;if(t>=-0x8000000000000000)return 9;throw new Error("Number too small -0x"+t.toString(16).substr(1))}if("boolean"===o)return 1;if(null===t)return n?0:1;if(void 0===t)return n?0:3;if("function"==typeof t.toJSON)return e(t.toJSON(),n);if("object"===o){var a,s=0;if(Array.isArray(t)){a=t.length;for(var u=0;u<a;u++)s+=e(t[u],n)}else{var c=i(t,n);a=c.length;for(u=0;u<a;u++){var l=c[u];s+=e(l)+e(t[l],n)}}if(a<16)return 1+s;if(a<65536)return 3+s;if(a<4294967296)return 5+s;throw new Error("Array or object too long 0x"+a.toString(16))}if("function"===o)return 0;throw new Error("Unknown type "+o)}(e,n);if(0!=o){var a=new ArrayBuffer(o);return function e(n,o,a,s){var u=typeof n;if("string"===u){if((c=r(n))<32)return o.setUint8(a,160|c),t(o,a+1,n),1+c;if(c<256)return o.setUint8(a,217),o.setUint8(a+1,c),t(o,a+2,n),2+c;if(c<65536)return o.setUint8(a,218),o.setUint16(a+1,c),t(o,a+3,n),3+c;if(c<4294967296)return o.setUint8(a,219),o.setUint32(a+1,c),t(o,a+5,n),5+c}ArrayBuffer.isView&&ArrayBuffer.isView(n)&&(n=n.buffer);if(n instanceof ArrayBuffer){if((c=n.byteLength)<256)return o.setUint8(a,196),o.setUint8(a+1,c),new Uint8Array(o.buffer).set(new Uint8Array(n),a+2),2+c;if(c<65536)return o.setUint8(a,197),o.setUint16(a+1,c),new Uint8Array(o.buffer).set(new Uint8Array(n),a+3),3+c;if(c<4294967296)return o.setUint8(a,198),o.setUint32(a+1,c),new Uint8Array(o.buffer).set(new Uint8Array(n),a+5),5+c}if("number"===u){if(Math.floor(n)!==n)return o.setUint8(a,203),o.setFloat64(a+1,n),9;if(n>=0){if(n<128)return o.setUint8(a,n),1;if(n<256)return o.setUint8(a,204),o.setUint8(a+1,n),2;if(n<65536)return o.setUint8(a,205),o.setUint16(a+1,n),3;if(n<4294967296)return o.setUint8(a,206),o.setUint32(a+1,n),5;if(n<0x10000000000000000)return o.setUint8(a,207),function(e,t,n){n<0x10000000000000000?(e.setUint32(t,Math.floor(2.3283064365386963e-10*n)),e.setInt32(t+4,-1&n)):(e.setUint32(t,4294967295),e.setUint32(t+4,4294967295))}(o,a+1,n),9;throw new Error("Number too big 0x"+n.toString(16))}if(n>=-32)return o.setInt8(a,n),1;if(n>=-128)return o.setUint8(a,208),o.setInt8(a+1,n),2;if(n>=-32768)return o.setUint8(a,209),o.setInt16(a+1,n),3;if(n>=-2147483648)return o.setUint8(a,210),o.st+4,-1&n)):(e.setUint32(t,2147483647),e.setUint32(t+4,2147483647))}(o,a+1,n),9;throw new Error("Number too small -0x"+(-n).toString(16).substr(1))}if("undefined"===u)return s?0:(o.setUint8(a,212),o.setUint8(a+1,0),o.setUint8(a+2,0),3);if(null===n)return s?0:(o.setUint8(a,192),1);if("boolean"===u)return o.setUint8(a,n?195:194),1;if("function"==typeof n.toJSON)return e(n.toJSON(),o,a,s);if("object"===u){var c,l=0,f=Array.isArray(n);if(f)c=n.length;else{var p=i(n,s);c=p.length}if(c<16?(o.setUint8(a,c|(f?144:128)),l=1):c<65536?(o.setUint8(a,f?220:222),o.setUint16(a+1,c),l=3):c<4294967296&&(o.setUint8(a,f?221:223),o.setUint32(a+1,c),l=5),f)for(var d=0;d<c;d++)l+=e(n[d],o,a+l,s);else for(d=0;d<c;d++){var h=p[d];l+=e(h,o,a+l),l+=e(n[h],o,a+l,s)}return l}if("function"===u)return 0;throw new Error("Unknown type "+u)}(e,new DataView(a),0,n),a}},e.decode=function(e){var t=new o(new DataView(e)),n=t.parse();if(t.offset!==e.byteLengthing bytes");return n};function o(e,t){this.offse){var r=e[n];return!(t&&null==r||"function"===typeof r&&!r.toJSON)}))}return o.prototype.map=function(e){for(var t={},n=0;n<e;n++){t[this.parse()]=this.parse()}return t},o.prototype.bin=o.prototype.buf=function(e){var t=new ArrayBuffer(e);return new Uint8Array(t).set(new Uint8Array(this.view.buffer,this.offset,e),0),this.offset+=e,t},o.prototype.str=function(e){var t=n(n(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=this.parse();return t},o.prototype.ext=function(e){var t={};return t.type=this.view.getInt8(this.offset),this.offset++,t.data=this.buf(e),this.offset+=e,t},o.prototype.parse=function(){var e,t,n,r,o=this.view.getUint8(this.offset);if(0==(128&o))return this.offset++,o;if(128==(240&o))return t=15&o,this.offset++,this.map(t);if(144==(240&o))return t=15&o,this.offset++,this.array(t);if(160==(224&o))return t=31&o,this.offset++,this.str(t);if(224==(224&o))return e=this.view.getInt8(this.offset),this.offset++,e;switch(o){case 192:return this.offset++,null;case 193:return void this.offset++;case 194:return this.offset++,!1;case 195:return this.offset++,!0;case 196:return t=this.view.getUint8(this.offset+1),this.offset+=2,this.bin(t);case 197:return t=this.view.getUint16(this.offset+1),this.offset+=3,this.bin(t);case 198:return t=this.view.getUint32(this.offset+1),this.offset+=5,this.bin(t);case 199:return t=this.view.getUint8(this.offset+1),this.offset+=2,this.ext(t);case 200:return t=this.view.getUint16(this.offset+1),this.offset+=3,this.ext(t);case 201:return t=this.view.getUint32(this.offset+1),this.offset+=5,this.ext(t);case 202:return e=this.view.getFloat32(this.offset+1),this.offset+=5,e;case 203:return e=this.view.getFloat64(this.offset+1),this.offset+=9,e;case 204:return e=this.view.getUint8(this.offset+1),this.offset+=2,e;case 205:return e=this.view.getUint16(this.offset+1),this.offset+=3,e;case 206:return e=this.view.getUint32(this.offset+1),this.offset+=5,e;case 207:return n=this.view,r=(r=this.offset+1)||0,e=4294967296*n.getUint32(r)+n.getUint32(r+4),this.offset+=9,e;case 208:return e=this.view.getInt8(this.offset+1),this.offset+=2,e;case 209:return e=this.view.getInt16(this.offset+1),this.offset+=3,e;case 210:return e=tction(e,t){return t=t||0,4294967296*e.getInt32(t)+e.getUint32(t+4)}(this.view,this.offset+1),this.offset+=9,e;case 212:return t=1,this.offset++,this.ext(t);case 213:return t=2,this.offset++,this.ext(t);case 214:return t=4,this.offset++,this.ext(t);case 215:return t=8,this.offset++,this.ext(t);case 216:return t=16,this.offset++,this.ext(t);case 217:return t=this.view.getUint8(this.offset+1),this.offset+=2,this.str(t);case 218:return t=this.view.getUint16(this.offset+1),this.offset+=3,this.str(t);case 219:return t=this.view.getUint32(this.offset+1),this.offset+=5,this.str(t);case 220:return t=this.view.getUint16(this.offset+1),this.offset+=3,this.array(t);case 221:return t=this.view.getUint32(this.offset+1),this.offset+=5,this.array(t);case 222:return t=this.view.getUint16(this.offset+1),this.offset+=3,this.map(t);case 223:return t=this.view.getUint32(this.offset+1),this.offset+=5,this.map(t)}throw new Error("Unknown type 0x"+o.toString(16))},e}();"undefined"==typeof Window&&"undefined"==typeof WorkerGlobalScope&&console.log("Warning: this distribution of Ably is intended for browsers. On nodejs, please use the 'ably' package on npm");var l,f=a.navigator&&a.navigator.userAgent.toString(),p={libver:"js-web",logTimestamps:!0,userAgent:f,currentUrl:a.location&&a.location.href,noUpgrade:f&&f.match(/MSIE\s8\.0/),binaryType:"arraybuffer",WebSocket:a.WebSocket||a.MozWebSocket,xhrSupported:a.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,jsonpSupported:"undefined"!=typeof document,allowComet:(l=a.location,!a.WebSocket||!l||!l.origin||l.origin.indexOf("http")>-1),streamingSupported:!0,useProtocolHeartbeats:!0,createHmac:null,msgpack:c,supportsBinary:!!a.TextDecfer:a.ArrayBuffer,atob:a.atob,nextTick:function(e){setTimeout(e,0)},addEveturn a.TextDecoder&&(new a.TextEncoder).encode(e).length||e.length},TextEncoder:a.Textf(void 0!==e)return function(t,n){e.getRandomValues(t),n&&n(null)}}(a.crypto||a.msCrypto)},d=function(){var e,t=s.lib.WordArray;if(p.getRandomWordArray)e=p.getRandomWordArray;else if("undefined"!=typeof Uint32Array&&p.getRandomValues){var n=new Uint32Array(4);e=functt32Array(r);p.getRandomValues(o,(function(e){t(e,m.toWordArray(o))}))}}else e=function(e,n){A.logAction(A.LOG_MAJOR,"Ably.Crypto.generateRandom()","Warning: the browser you are using does not support secure cryptographically secure randomness generation; falling back to insecure Math.random()");for(var r=e/4,o=new Array(r),i=0;i<r;i++)o[i]=Mters)")}}function o(e){return e.replace("_","/").replace("-","+")}t.create([0,0,0,0]);var i=[t.create([269488144,269488144,269488144,269488144],16),t.create([16777216],1),t.create([33685504],2),t.create([50529024],3),t.create([67372036],4),t.create([84215045,83886080],5),t.create([101058054,101056512],6),t.create([117901063,117901056],7),t.create([134744072,134744072],8),t.create([151587081,151587081,150994944],9),t.create([168430090,168430090,168427520],10),t.create([185273099,185273099,185273088],11),t.create([202116108,202116108,202116108],12),t.create([218959117,218959117,218959117,218103808],13),t.create([235802126,235802126,235802126,235798528],14),t.create([252645135,252645135,252645135,252645135],15),t.ey),n&&(this.iv=m.toWordArray(n).clone()),this.blockLengthWords=t}return a.CipherParams=u,a.getDefaultParams=function(e){var t;if("function"!=typeof e&&"string"!=typeof e){if(!e.key)throw new Error("Crypto.getDefaultParams: a key is required");t="string"==typeof e.key?s.enc.Base64.parse(o(e.key)):m.toWordArray(e.key);var n=new u;if(n.key=t,n.algorithm=e.algorithm||"aes",n.keyLength=32*t.words.length,n.mode=e.mode||"cbc",e.keyLength&&e.keyLength!==n.keyLength)throw new Error("Crypto.getDefaultParams: a keyLength of "+e.keyLength+" was specified, but the key actually has length "+n.keyLength);return r(n),n}if(A.deprecated("Crypto.getDefaultParams(key, callback)","Crypto.getDegenerateRandomKey((function(t){e(null,a.getDefaultParams({key:t}))}));else{if("function"!=typeof arguments[1])throw new Error("Invalid arguments for Crypto.getDefaultParams");aments.length.getDefaultParams(e);return{cipherParams:t,cipher:new c(t,4,e.iv)}},c.prototype.encrypt=function(t,n){A.logAction(A.LOG_MI;var r=(t=m.ncryptCipher.process(t.concat(i[o-r])),c=s.concat(u);n(null,c)}}))};this.encryptCipher?u():this.iv?(this.encryptCipher=s.algo[this.cjsAlgorithm].createEncryptor(this.key,{iv:this.iv}),u()):e(16,(function(e,t){e?n(e):(a.encryptCipher=s.algo[a.cjsAlgorithm].createEncryptor(a.key,{iv:t}),a.iv=t,u())}))},c.prototype.decrypt=function(e){A.logAction(A.LOG_MICRO,"CBCCipher.decrypt()",""),e=m.toWordArray(e);var n=this.blockLengthWords,r=e.words,o=t.create(r.slice(0,n)),i=t.create(r.slice(n)),a=s.algo[this.cjsAlgorithm].createDecryptor(this.key,{iv:o}),u=a.process(i),c=a.finalizes;e(16,(function(e,n){e?t(e):t(null,r.encryptCipher.process(n))}))},a}(),h=function(){var e,t,n="ablyjs-storage-test";try{a.sessionStorage.setItem(n,n),a.sessionStorage.removeItem(n),e=!0}catch(t){e=!1}try{a.localStorage.setItemnction r(){}function o(e){return e?a.sessionStorage:a.localStorage}function i(e,t,n,r){var i={value:t};return n&&(i.expires=v.now()+n),o(r).setItem(e,JSON.stringify(i))}function s(e,t){var n=o(t).getItem(e);if(!n)return null;var r=JSON.parse(n);reoveItem(e),null):r.value}function u(e,t){return o(t).removeItem(e)}return t&&(r.set=function(e,t,n){return i(e,t,n,!1)},r.get=function(e){retturn u(e,!1)}),e&&(r.setSession=function(e,t,n){return i(tion(e){return s(e,!0)},r.removeSession=function(e){return u(e,!0)}),r}(),g={internetUpUrl:"https://internet-up.ably-realtime.com/is-the-internet-up.txt",jsonpInternetUpUrl:"https://internet-up.ably-realtime.com/is-the-internet-up-0-9.js",defaultTransports:["xhr_polling","xhr_streaming","jsonp","web_socket"],baseTransportOrder:["xhr_polling","xhr_streaming","jsonp","web_socket"],transportPreferenceOrder:["jsonp","xhr_polling","xhr_streaming","web_socket"],upgradeTransports:["xhr_streaming","web_socket"]};p.noUpgrade&&(g.upgradeTransports=[]);var m=function(){var e=s.lib.WordArray,t=p.ArrayBuffer,n=p.atob,r=p.TextEncoder,o=p.TextDecoder,iid 0!==e.sigBytes}function u(e){return null!=e&&e.constructor===t}function c(e){return t&&t.isView&&t.isView(e)}function l(){456789abcdef";var f=l.isBuffer=function(e){return u(e)||a(e)||c(e)},d=l.toBuffer=function(e){if(!t)throw new Error("Can't convert to Buffer: browser does not support the necessary types");if(u(e))return new Uint8Array(e);if(c(e))return new Uint8Array(e.buffer);if(a(e)){for(var n=new t(e.sigBytes),r=new Uint8Array(n),o=0;o<e.sigBytes;o++)r[o]=e.words[o>>>2]>>>24-o%4*8&255;return r}throw new Error("BufferUtils.toBuffer expected an arraybuffer, typed array, or CryptoJS wordarray")};return l.toArrayBuffer=function(e){return u(e)?e:d(e).buffer},l.toWordArray=function(t){return c(t)&&(t=t.buffer),a(t)?t:e.create(t)},l.base64Encode=function(e){return a(e)?s.enc.Base64.stringify(e):function(e){for(var t,n="",r=i,o=e.byteLength,a=o%3,s=o-a,u=0;u<s;u+=3)n+=r[(16515072&(t=e[u]<<16|e[u+1]<<8|e[u+2]))>>18]+r[(258048&t)>>12]+r[(4032&t)>>6]+r[63&t];return 1==a?n+=r[(252&(t=e[s]))>>2]+r[(3&t)<<4]+"==":2==a&&(n+=r[(64512&(t=e[s]<<8|e[s+1]))>>10]+r[(1008&t)>>4]+r[(15&t)<<2]+"="),n}(d(e))},l.base64Decode=function(e){return t&&n?function(e){for(var t=n(e),r=t.length,o=new Uint8Array(r),i=0;i<r;i++){var a=t.charCodeAt(i);o[i]=a}return o.buffer}(e):s.enc.Base64.parse(e)},l.hexEncode=function(e){return e=l.toWordArray(e),s.enc.Hex.stringify(e)},l.hexDecode=function(e){var n=s.enc.Hex.parse(e);return t?l.toArrayBuffer(n):n},l.utf8Encode=function(e){return r?(new r).encode(e).buffer:s.enc.Utf8.parse(e)},l.utf8Decode=function(e){if(!f(e))throw new Error("Expected input of utf8decode to be an arraybuffer, typed array, or CryptoJS wordarray");return o&&!a(e)?(new o).decode(e):(e=l.toWordArray(e),s.enc.Utf8.stringify(e))},l.bufferCompare=function(e,t){if(!e)return-1;if(!t)return 1;e=l.toWordArray(e),t=l.toWordArray(t),e.clamp(),t.clamp();var n=e.sigBytes-t.sigBytes;if(0!=n)return n;e=e.words,t=t.words;for(var r=0;r<e.length;r++)if(0!=(n=e[r]-t[r]))return n;return 0},l.byteLength=function(e){return u(e)||c(e)?e.byteLength:a(e)ction t(){}function n(e){return Math.floor(Math.random()*e.length)}t.mixin=function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];if(!n)break;var r=n.hasOwnPr,o)||(e[o]=n[o])}return e},t.copy=function(e){return t.mixin({},e)},t.isArray=Array.isArray||function(e){retursureArray=ftion(e){reng.call(e)},t.iOnlyPropIn=function(e,t){for(var n in e)if(n!==t)return!one=function(e){var t=new Object;for(var n in e)t[n]=e[n];return t},t.prototypicalClone=function(e,n){function r(){}r.prototype=e;var o=new r;return n&&t.mixin(o,n),o},t.inherits=p.inherits||function(e,n){e.super_=n,e.prototypinsValue=fune,n){return t.isArray(n)?t.arrIntersect(e,n):t.arrIntersectOb(e,n)},t.arrIntersect=function(e,n){for(var r=[],o=0;o<e.length;o++){var i=e[o];-1!=t.arrIndexOf(n,i)&&r.push(i)}return r},t.arrIntersectOb=function(e,t){for(var n=[],r=0;r<e.length;r++){var o=e[r];o in t&&n.push(o)}return n},t.arrSubtract=function(e,n){for(var r=[],o=0;o<e.length;o++){var i=e[o];-1==t.arrIndn){n=n||urn n;return-1},t.arrIn=function(e,n){return-1!==t.arrIndexOf(e,n)},t.arrDeleteValue=function(e,n){var r=t.aValue=function(e,n){var r=e.slice();return t.arrDeleteValue(r,n),r},t.keysArray=function(e,t){var n=[];for(var r in e)t&&!e.hasOwnProperty(r)||n.push(r);return n},t.valuesArray=function(e,t){var n=[];for(var r in e)t&&!e.hasOwnProperEach(t)}:functio)},t.safeArrForEach=function(e,n){return t.arrForEach(e.slic){for(var n=[],r=e.length,o=0;o<r;o++)n.push(t(e[o],o,e));return n},tfor(var n=[],r=e.length,o=0;o<r;o){for(var n=e.length,r=0;r<n;r++)if(!t(e[r],r,e))return!1;return!0},t.allSame=function(e,n){if(0===e.length)return!0;var r=e[0][n];return t.arrEvery(e,(function(e){return e[n]===r}))},t.nextTick=p.nextTick;var r={json:"application/json",jsonp:"application/javascript",xml:"application/xml",html:"text/html",msgpack:"application/x-msgpack"};return t.defaultGetHeaders=function(e){return{accept:r[e||"json"],"X-Ably-Version":g.apiVersion,"X-Ably-Lib":g.libstring}},t.defaultPostHeaders=function(e){var t;return{accept:t=r[e||"json"],"content-type":t,"X-Ably-Version":g.apiVersion,"X-Ably-Lib":g.libstring}},t.arrPopRa)+"="+encodeURIComp(e);)r[decodeURIComponent(t[1])]=decodeURIComponent(t[2]);return r},t.now=Date.now||functct,t.isErrorInfo=function(e){return"ErrorInfo"==e.constructor.name},t.inspectError=function(e){return e&&(t.isErrorInfo(e)||"Error"==e.constructor.name||e instanceof Error)?e.toString():t.inspect(e)},t.inspectBody=function(e){return m.isBuffer(e)?e.toString():"string"==typeof e?e:p.inspect(e)},t.dataSizeBytes=function(e){if(m.isBuffer(e))return m.byteLength(e);if("string"==typeof e)return p.stringByteSize(e);throw new Error("Expected input of Utils.dataSizeB},t.cheapRandStr=function(){return String(Math.random()).substr(2)},t.randomString=p.getRandomValues&&"undefined"!=typeof Uint8Array?function(e){var t=new Uint8Array(e);return p.getRandomValues(t),m.base64Encode(t)}:function(e){for(var t=m.base64CharSet,r=Math.round(4*e/3),o="",i=0;i<r;i++)o+=t[n(t)];return o},t.randomHexString=p.getRandomValues&&"undefined"!=typeof Uint8Array?function(e){var t=new Uint8Array(e);return p.getRandomValues(t),m.hexEncode(t)}:function(e){for(var t=m.hexCharSet,r=2*e,o="",i=0;i<r;i++)o+=t[n(t)];return o},t.arrChooseN=function(e,n){for(var r=Math.min(n,e.length),o=e.slice(),i=[],a=0;a<r;a++)i.push(t.arrPopRandomElement(o));ction(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},t.promisify=function(e,t,n){return new Promis(e,Array.prototype.slice.call(n).concat((function(e,t){e?o(e):r(t)})))}))},t.decodeBody=function(t,n){return"msgpack"==n?e.decode(t):JSON.parse(String(t))},t.encodeBody=function(t,n){return"msgpack"==n?e.encode(t,!0):JSON.stringify(t)},t}(),y=function(){var e=function(){};fatusCode;return 408===t&&!e.code||400===t&&!e.code||t>=500&&t<=504}function o(e){var t=e.connection,n=t&&t.connectionManager.host;return n?[n].concat(g.getFallbackHosts(e.options)):g.getHosts(e.options)}return t._getHosts=o,t.methods=["get","delete","post","put","patch"],t.methodsWithoutBody=["get","delete"],t.methodsWithBody=v.arrSubtract(t.methods,t.methodsWithoutBody),v.arrForEach(t.methodsWithoutBody,(function(e){t[e]=function(n,r,o,i,a){t.do(e,n,r,o,null,i,a)},t[e+"Uri"]=function(n,r,o,i,a){t.doUri(e,n,r,o,null,i,a)}})),v.arrForEach(t.methodsWithBody,(function(e){t[e]=function(n,r,o,i,a,s){t.do(e,n,r,o,i,a,s)},t[e+"Uri"]=function(n,r,o,i,a,s){t.doUri(e,n,r,o,i,a,s)}})),t.do=function(i,a,s,u,c,l,f){f=f||e;var p="function"==typeof s?s:function(e){return a.baseUri(e)+s},d=(u&&u.accept,arguments),h=a._currentFallback;if(h){if(h.validUntil>n())return void t.Request(i,a,p(h.host),u,l,c,(function(e){if(e&&r(e))return a._currentFallback=null,void t.do.apply(t,d);f.apply(null,arguments)}));a._currentFallback=null}var g=o(a);if(1!=g.length){var m=function(e,o){var s=e.shift();t.doUri(i,a,p(s),u,c,l,(function(t){t&&r(t)&&e.length?m(e,!0):(o&&(a._currentFallback={host:s,validUntil:n()+a.options.timeouts.fallbackRetryTimeout}),f.apply(nu,c,l,f)},t.doUri=function(e,n,r,o,i,a,s){t.Request(e,n,r,o,a,i,s)},pportsLinkHeaders==[]}e.prototype.appen,this},e.prototype.toString=function(){return this.buffer.join("")};var t={codex:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(r){for(var o=new e,i=t.codex,a=new n(r);a.moveNext();){var s=a.current;a.moveNext();var u=a.current;a.moveNext();var c=a.current,l=s>>2,f=(3&s)<<4|u>>4,p=(15&u)<<2|c>>6,d=63&c;isNaN(u)?p=d=64:isNaN(c)&&(d=64),o.append(i.charAt(l)+i.charAt(f)+i.charAt(p)+i.charAt(d))}return o.toString()},decode:function(t){for(var n=new e,o=new r(t);o.moveNext();){var i=o.current;if(i<128)n.append(String.fromCharCode(i));else if(i>191&&i<224){o.moveNext();var a=o.current;n.append(String.fromCharCode((31&i)<<6|63&a))}else{o.moveNext();a=o.current;o.moveNext();var s=o.current;n.append(String.fromCharCode((15&i)<<12|(63&a)<<6|63&s))}}return n.toString()}};function n(e){this._input=e,this._index=-1,this._buffer=[]}function r(e){this._input=e,this._index=-1,this._buffer=[]}return n.prototype={current:Number.NaN,moveNext:function(){if(this._buffer.length>0)return this.current=this._buffer.shift(),!0;if(this._index>=this._input.length-1)return this.current=Number.NaN,!1;var e=this._input.charCodeAt(++this._index);return 13==e&&10==this._input.charCodeAt(this._index+1)&&(e=10,this._index+=2),e<128?this.current=e:e>127&&e<2048?(this.current=e>>6|192,this._buffer.push(63&e|128)):(this.current=e>>12|224,this._buffer.push(e>>6&63|128),this._buffer.push(63&e|128)),!0}},r.prototype={current:64,moveNext:function(){if(this._buffer.length>0)return this.current=this._buffer.shift(),!0;if(this._index>=this._input.length-1)return this.current=64,!1;var e=t.codex.indexOf(this._input.charAt(++this._index)),n=t.codex.indexOf(this._input.charAt(++this._index)),r=t.codex.indexOf(this._input.charAt(++this._index)),o=t.codex.indexOf(this._input.charAt(++this._index)),i=e<<2|n>>4,a=(15&n)<<4|r>>2,s=(3&r)<<6|o;return this.current=i,64!=r&&this._buffer.push(a),64!=o&&this._buffer.push(s),!0}},t}();function E(e){if("string"!=typeof e)throw new O("host must be a string; was a "+typeof e,4e4,400);if(!e.length)throw new O("host must not be zero-length",4e4,400)}g.ENVIRONMENT="",g.REST_HOST="rest.ably.io",g.REALTIME_HOST="realtime.ably.io",g.FALLBACK_HOSTS=["A.ably-realtime.com","B.ably-realtime.com","C.ably-realtime.com","D.ably-realtime.com","E.ably-realtime.com"],g.PORT=80,g.TLS_PORT=443,g.TIMEOUTS={disconnectedRetryTimeout:15e3,suspendedRetryTimeout:3e4,httpRequestTimeout:15e3,channelRetryTimeout:15e3,fallbackRetryTimeout:6e5,connectionStateTtl:12e4,realtimeRequestTimeout:1e4,recvTimeout:9e4,preferenceConnectTimeout:6e3,parallelUpgradeDelay:6e3},g.httpMaxRetryCount=3,g.maxMessageSize=65536,g.errorReportingUrl="https://errors.ably.io/api/15/store/",g.errorReportingHeaders={"X-Sentry-Auth":"Sentry sentry_version=7, sentry_key=a04e33c8674c451f8a310fbec029acf5, sentry_client=ably-js/0.1","Content-Type":"application/json"},g.version="1.1.24",g.libstring=p.libver+"-"+g.version,g.apiVersion="1.1",g.getHost=function(e,t,n){return t=n?t==e.restHost&&e.realtimeHost||t||e.realtimeHost:t||e.restHost},g.getPort},g.getHttpScheme=function(e){return e.tls?"https://":"http://"},g.getFallbackHosts=function(e){var t=e.fallbackHosts,n=void 0!==e.httpMaxRetryCount?e.httpMaxRetryCount:g.httpMaxRetryCount;return t?v.arrChooseN(t,n):[]},g.getHosts=function(e){return[e.restHost].concat(g.getFallbackHosts(e))},g.objectifyOptions=function(e){return"string"==typeof e?-1==e.indexOf(":")?{token:e}:{key:e}:e},g.normaliseOptions=function(e){e.host&&(A.deprecated("host","restHost"),e.restHost=e.host),e.wsHost&&(A.deprecated("wsHost","realtimeHost"),e.realtimeHost=e.wsHost),e.queueEvents&&(A.deprecated("queueEvents","queueMessages"),e.queueMessages=e.queueEvents),!0===e.recover&&(A.deprecated("{recover: true}","{reconectionDetails, cb) { cb(true); }}"),e.recover=function(e,t){t(!0)}),"function"==typeof e.recover&&!0===e.closeOnUnload&&(A.logAction(A.LOG_ERROR,"Defaults.normaliseOptions","closeOnUnload was true and a session recovery function was set - these are mutually exclusive, so unsetting the latter"),e.recover=null),"closeOnUnload"in e||(e.closeOnUnload=!e.recover),e.transports&&v.arrIn(e.transports,"xhr")&&(A.deprecated('transports: ["xhr"]','transports: ["xhr_streaming"]'),v.arrDeleteValue(e.transports,"xhr"),e.transports.push("xhr_streaming")),"queueMessages"in e||(e.queueMessages=!0);var t=!1;if(e.restHost)e.realtimeHost=e.realtimeHost||e.restHost;else{var n=e.environment&&String(e.environment).toLowerCase()||g.ENVIRONMENT;t=!n||"production"===n,e.restHost=t?g.REST_HOST:n+"-"+g.REST_HOST,e.realtimeHost=t?g.REALTIME_HOST:n+"-"+g.REALTIME_HOST}for(var r in e.fallbackHosts=t||e.fallbackHostsUseDefault?g.FALLBACK_HOSTS:e.fallbackHosts,v.arrForEach((e.fallbackHosts||[]).concat(e.restHost,e.realtimeHost),E),e.port=e.port||g.PORT,e.tlsPort=e.tlsPort||g.TLS_PORT,e.maxMessageSize=e.maxMessageSize||g.maxMessageSize,"tls"in e||(e.tls=!0),e.timeouts={},g.TIMEOUTS)e.timeouts[r]=e[r]||g.TIMEOUTS[r];(e.useBinaryProtocol="useBinaryProtocol"in e?p.supportsBinary&&e.useBinaryProtocol:p.preferBinary,e.clientId)&&((e.headers=e.headers||{})["X-Ably-ClientId"]=m.base64Encode(m.utf8Encode(e.clientId)));return"idempotentRestPublishing"in e||(e.idempotentRestPublishing=!1),e.promises&&!p.Promise&&(A.logAction(A.LOG_ERROR,"Defaults.normaliseOptions","{promises: true} was specified, but no Promise constructor found; disabling promises"),e.promises=!1),e};var w=function(){function e(){this.any=[],this.events={},this.anyOnce=[],this.eventsOnce={}}function t(e,t,n){try{t.apply(e,n)}catch(e){A.logAction(A.LOG_ERROR,"EventEmitter.emit()","Unexpected listener exception: "+e+"; stack = "+(e&&e.stack))}}function n(e,t,r){var o,i,a,s;for(s=0;s<e.length;s++)if(o=e[s],r&&(o=o[r]),v.isArray(o)){for(;-1!==(i=v.arrIndexOf(o,t));)o.splice(i,1);r&&0===o.length&&delete e[s][r]}else if(v.isObject(o))for(a in o)o.hasOwnProperty(a)&&v.isArray(o[a])&&n([o],t,a)}return e.prototype.on=function(e,t){if(1==arguments.length&&"function"==typeof e)this.any.push(e);else if(v.isEmptyArg(e))this.any.push(t);else if(v.isArray(e)){var n=this;v.arrForEach(e,(function(e){n.on(e,t)}))}else{var r=this.events[e]||(this.events[e]=[]);r.push(t)}},e.prototype.off=function(e,t){if(0==arguments.length||v.isEmptyArg(e)&&v.isEmptyArg(t))return this.any=[],this.events={},this.anyOnce=[],void(this.eventsOnce={});if(1==arguments.length&&"function"==typeof e&&(t=e,e=null),t&&v.isEmptyArg(e))n([this.any,this.events,this.anyOnce,this.eventsOnce],t);else{if(v.isArray(e)){var r=this;v.arrForEach(e,(function(e){r.off(e,t)}))}t?n([this.events,this.eventsOnce],t,e):(deletventsOnce[e]),t.length?t:null}return this.any.length?this.any:null},e.prototype.emit=function(e){var n=Array.prototype.slice.call(arguments,1),r={event:e},o=[];this.anyOnce.length&&(Array.prototype.push.apply(o,this.anyOnce),this.anyOnce=[]),this.any.length&&Array.prototype.push.apply(o,this.any);var i=this.eventsOnce[e];i&&(Array.prototype.push.apply(o,i),delete this.eventsOnce[e]);var ray.prototype.push.apply(o,a),v.arrForEach(o,(function(e){t(r,e,n)}))},e.prototype.once=function(e,t){var n=arguments.length,r=this;if((0===n||1===n&&"function"!=typeof e)&&p.Promise)return new p.Promise((function(t){r.once(e,t)}));if(1==arguments.length&&"function"==typeof e)this.anyOnce.push(e);else if(v.isEmptyArg(e))this.anyOnce.push(t);else{if(v.isArray(e))throw"Arrays of events can only be used with on(), not once()";var o=this.eventsOnce[e]||(this.eventsOnce[e]=[]);o.push(t)}},e.prototype.whenState=function(e,n,r){var o={event:e},i=this,a=Array.prototype.slice.call(arguments,3);if("string"!=typeof e||"string"!=typeof n)throw"whenState requires a valid event String argument";if("function"!=typeof r&&p.Promise)return new p.Promise((function(t){i.whenState.bind(i,e,n,t).apply(i,a)}));e===n?t(o,r,a):this.once(e,r)},e}(),A=function(){var e,t;function n(e,t){return("000"+e).slice(-2-(t||0))}"undefined"==typeof Window&&"undefined"==typeof WorkerGlobalScope||a.console&&a.console.log&&"function"==typeof a.console.log.apply?(e=function(){console.log.apply(console,arguments)},t=console.warn?function(){conion(){Function.prototype.apply.call(console.log,console,arguments)}:function(){};var r=1;function o(e){return p.logTimestamps?function(t){var r=new Date;e(n(r.getHours())+":"+n(r.getMinutes())+":"+n(r.getSr.getMilliseconds(),!0)+" "+t)}:e}var i=o(e),s=o(t);function u(e){}return u.LOG_NONE=0,u.LOG_ERROR=1,u.LOG_MAJOR=2,u.LOG_MINOR=3,u.LOG_MICRO=4,u.LOG_DEFAULT=1,u.LOG_DEBUG=4,u.logAction=function(e,t,n){u.shouldLog(e)&&(1===e?s:i)("Ably: "+t+": "+n)},u.deprecated=function(e,t){u.shouldLog(1)&&s("Ably: Deprecation warning - '"+e+"' is deprecated and will be removePlease use '"+t+"' instead.")},u.shouldLog=function(e){return e<=r},u.setLog=function(e,t){void 0!==e&&(r=e),void 0!==t&&(i=s=t)},u}(),C=function(e){e=e||[];var t=function(){for(var t=0;t<e.length;t++){var n=e[t];if(n)try{n.apply(null,arguments)}catch(e){A.logAction(A.LOG_ERROR,"Multicaster multiple callback handler};return t.push=function(){Array.prototype.push.apply(e,arguments)},t},x=function(){function e(){}e.levels=["fatal","error","warning","info","debug"];return e.report=function(e,t,n,r){var o={event_id:v.randomHexString(16),tags:v.mixin({lib:p.libver},r),platform:"javascript",level:e,release:g.version,fingerprint:n&&[n],message:t,request:{headers:{"User-Agent":p.userAgent},url:p.currentUrl}};A.logAction(A.LOG_MICRO,"ErrorReporter","POSTing to error reporter: "+t),y.postUri(null,g.errorReportingUrl,g.errorReportingHeaders,JSON.stringify(o),{},(function(e,t){A.logAction(A.LOG_MICRO,"ErrorReporter","POSTing to error reporter resulted sage=e,this.code=t,this.staage.indexOf("help.ably.io")>-1||(e+="; see "+this.href+" "),e+="]"},e.fromValues=function(t){var n=v.mixin(new e,t);return t instanceof Error&&(n.message=t.message),n.code&&!n.href&&(n.href="https://help.ably.io/error/"+n.code),n},e}(),S=function(){function e(){this.name=void 0,this.id=void 0,this.timestamp=void 0,this.clientId=void 0,this.connectionId=void 0,this.connectionKey=void 0,this.data=void 0,this.encoding=void 0,this.extras=void 0,this.size=void 0}function t(e){if(e&&e.cipher&&!e.cipher.channelCipher){if(!d)throw new Error("Encryption not enabled; use ably.encryption.js instead");var t=d.gestringify(e.extras).length),e.data&&(t+=v.dataSizeBytes(e.data)),t}return e.prototype.toJSON=function(){var e={name:this.name,id:this.id,clientId:this.clientId,connectionId:this.connectionId,connectionKey:this.connectionKey,encoding:this.encoding,extras:this.extras},t=this.data;if(t&&m.isBuffer(t))if(arguments.length>0){var n=this.encoding;e.encoding=n?n+"/base64":"base64",t=m.base64Encode(t)}else t=m.toBuffer(t);return e.data=t,e},e.prototype.toString=function(){var e="[Message";return this.name&&(e+="; name="+this.name),this.id&&(e+="; id="+this.id),this.timestamp&&(e+="; timestamp="+this.timestamp),this.clientId&&(e+="; clientId="+this.clientId),this.connectionId&&(e+="; connectionId="+this.connectionId),this.encoding&&(e+="; encoding="+this.encoding),this.extras&&(e+="; extras ="+JSON.stringify(this.extras)),this.data&&("string"==typeof this.data?e+="; data="+this.data:m.isBuffer(this.data)?e+="; data (buffer)="+m.base64Encode(this.data):e+="; data (json)="+JSON.stringify(this.data)),this.extras&&(e+="; extras="+JSON.stringify(this.extras)),e+="]"},e.encrypt=function(e,t,n){var r=e.data,o=e.encoding,i=t.channelCipher;o=o?o+"/":"",,r){t?n(t):(e.data=r,e.encoding=o+"cipher+"+i.algorithm,n(null,e))}))},e.encode=function(t,n,r){var o,i=t.data;if(!("string"==typeof i||m.isBuffer(i)||null==i)){if(!v.isObject(i)&&!v.isArray(i))throw new O("Data type is unsupported",40013,400);t.data=JSON.stringify(i),t.encoding=(o=t.encoding)?o+"/json":"json"}null!=n&&n.cipher?e.encrypt(t,n,r):r(null,t)},e.encodeArray=function(t,n,r){for(var o=0,i=0;i<t.length;i++)e.encode(t[i],n,(function(e,n){e?r(e):++o==t.length&&r(null,t)}))},e.serialize=v.encodeBody,e.decode=function(e,t){var n=e.encoding;if(n){var r,o=n.split("/"),i=o.length,a=e.data;try{for(;(r=i)>0;){var s=o[--i].match(/([\-\w]+)(\+([\w\-]+))?/);if(!s)break;var u=s[1];switch(u){case"base64":a=m.base64Decode(String(a));continue;case"utf-8":a=m.utf8Decode(a);continue;case"json":a=JSON.parse(a);continue;case"cipher":if(null!=t&&t.cipher){var c=s[3],l=t.channelCipher;if(c!=l.algorithm)throw new Error("Unable to decrypt message with given cipher; incompatible cipher params");a=l.decrypt(a);continue}throw new Error("Unable to decrypt message; not an encrypted channel");default:throw new Error("Unknown encoding")}break}}catch(e){throw new O("Error processing the "+u+" encoding, decoder returned ‘"+e.message+"’",40013,400)}finally{e.encoding=r<=0?null:o.slice(0,r).join("/"),e.data=a}}},e.fromResponseBody=function(t,n,r){r&&(t=v.decodeBody(t,r));for(var o=0;o<t.length;o++){var i=t[o]=e.fromValues(t[o]);try{e.decode(i,n)}catch(e){A.logAction(A.LOG_ERROR,"Message.fromResponseBody()",e.toString())}}return t},e.fromValues=function(t){return v.mixin(new e,t)},e.fromValuesArray=function(t){for(var n=t.length,r=new Array(n),o=0;o<n;o++)r[o]=e.fromValues(t[o]);return r},e.fromEncoded=function(n,r){var o=e.fromValues(n);t(r);try{e.decode(o,r)}catch(e){A.logAction(A.LOG_ERROR,"Message.fromEncoded()",e.toString())}return o},e.fromEncodedArray=function(n,r){return t(r),(var t,r=0,o=0;o<e.length;o+,k=function(){p.msgpack;function e(e){return v.arrIndexOf(t.Actions,e)}function t(){this.action=void 0,this.id=void 0,this.timestamp=void 0,this.clientId=void 0,this.connectionId=void 0,this.data=void 0,this.encoding=void 0,this.size=void 0}return t.Actions=["absent","present","enter","leave","update"],t.prototype.isSynthesized=function(){return this.id.substring(this.connectionId.length,0)!==this.connectionId},t.prototype.parseId=function(){var e=this.id.split(":");return{connectionId:e[0],msgSerial:parseInt(e[1],10),index:parseInt(e[2],10)}},t.prototype.toJSON=function(){var t={clientId:this.clientId,action:e(this.action),encoding:this.encoding},n=this.data;if(n&&m.isBuffer(n))if(arguments.length>0){var r=this.encoding;t.encoding=r?r+"/base64":"base64",n=m.base64Encode(n)}else n=m.toBuffer(n);return t.data=n,t},t.prototype.toString=function(){var e="[PresenceMessage";return e+="; action="+this.action,this.id&&(e+="; id="+this.id),this.timestamp&&(e+="; timestamp="+this.timestamp),this.clientId&&(e+="; clientId="+this.clientId),this.connectionId&&(e+="; connectionId="+this.connectionId),this.encoding&&(e+="; encoding="+this.encoding),this.data&&("string"==typeof this.data?e+="; data="+this.data:m.isBuffer(this.data)?e+="; data (buffer)="+m.base64Encode(this.data):e+="; data (json)="+JSON.stringify(this.data)),e+="]"},t.encode=S.encode,t.decode=S.decode,t.fromResponseBody=function(e,n,r){r&&(e=v.decodeBody(e,r));for(var o=0;o<e.length;o++){var i=e[o]=t.fromValues(e[o],!0);try{t.decode(i,n)}catch(e){A.logAction(A.LOG_ERROR,"Prunction(e,n){return n&&(e.action=t.Actions[e.action]),v.mixin(new t,e)},t.fromValuesArray=function(e){for(var n=e.length,r=new Array(n),o=0;o<n;o++)r[o]=t.fromValues(e[o]);return r},t.fromEncoded=function(e,n){var r=t.fromValues(e,!0);try{t.decode(r,n)}catch(e){A.logAction(A.LOG_ERROR,"Prction(e,n){return v.arrMap(e,(function(e){return t.fromEncoded(e,n)}))},t.getMessagesSize=S.getMessagesSize,t}(),_=function(){function e(){this.action=void 0,this.flags=void 0,this.id=void 0,this.timestamp=void 0,this.count=void 0,this.error=void 0,this.connectionId=void 0,this.connectionKey=void 0,this.connectionSerial=void 0,this.channel=void 0,this.channelSerial=void 0,this.msgSerial=void 0,this.messages=void 0,this.presence=void 0,this.auth=void 0}var t=e.Action={HEARTBEAT:0,ACK:1,NACK:2,CONNECT:3,CONNECTED:4,DISCONNECT:5,DISCONNECTED:6,CLOSE:7,CLOSED:8,ERROR:9,ATTACH:10,ATTACHED:11,DETACH:12,DETACHED:13,PRESENCE:14,MESSAGE:15,.arrForEach(v.keysArray(e.Action,!0),(function(n){e.ActionName[t[n]]=n}));var n={HAS_PRESENCE:1,HAS_BACKLOG:2,RESUMED:4,TRANSIENT:16,PRESENCE:65536,P=0;n<e.length;n++)t.push(e[n].toString());return"[ "+t.join(", ")+" ]"}n.MODE_ALL=n.PRESENCE|n.PUBLISH|n.SUBSCRIBE|n.PRESENCE_SUBSCRIBE,e.proto)>0},e.prototype.set.prototype.getMode=function(){return thize=function(t,n){var r=v.decodeBody(t,n);return e.fromDeserialized(r)},e.fromDeserialized=function(t){var n=t.error;n&&(t.error=O.fromValues(n));var r=t.messages;if(r)for(var o=0;o<r.length;o++)r[o]=S.fromValues(r[o]);var i=t.presence;if(i)for(o=0;o<i.length;o++)i[o]=k.fromValues(i[o],!0);return v.mixin(new e,t)},e.fromValues=function(t){return v.mixin(new e,t)};var i="id channel channelSerial connectionId connectionKey connectionSerial count msgSerial timestamp".split(" ");return e.stringify=function(t){var n,a="[ProtocolMessage";void 0!==t.action&&(a+="; action="+e.ActionName[t.action]||!1);for(var s=0;s<i.length;s++)n=i[s],void 0!==t[n]&&(a+="; "+n+"="+t[n]);return t.messages&&(a+="; messages="+o(S.fromValuesArray(t.messages))),t.presence&&(a+="; presence="+o(k.fromValuesArray(t.presence))),t.error&&(a+="; error="+O.fromValues(t.error).toString()),t.auth&&t.auth.accessToken&&(a+="; token="+t.auth.accessToken),t.flags&&(a+="; flags="+v.arrFilter(r,(function(e){return t.hasFlag(e)})).join(",")),a+="]"},e.isDuplicate=function(e,n){return e&&n&&(e.action===t.MESSAGE||e.action===t.PRESENCE)&&e.action===n.action&&e.channel===n.channel&&e.id===n.id},e}(),T=function(){function e(e){this.count=e&&e.count||0,this.data=e&&e.data||0,this.uncompressedData=e&&e.uncompressedData||0,this.failed=e&&e.failed||0,this.refused=e&&e.refused||0}function t(t){if(e.call(this,t),this.category=void 0,t&&t.category)for(var n in this.category={},t.category){var r=t.category[n];Object.prototype.hasOwnProperty.call(t.category,n)&&r&&(this.category[n]=new e(r))}}function n(e){this.peak=e&&e.peak||0,this.min=e&&e.min||0,this.mean=e&&e.mean||0,this.opened=e&&e.opened||0,this.refused=e&&e.refused||0}function r(e){this.succeeded=e&&e.succeeded||0,this.failed=e&&e.failed||0,this.refused=e&&e.refused||0}function o(e){this.plain=new n(e&&e.plain),this.tls=new n(e&&e.tls),this.all=new n(e&&e.all)}function i(e){this.messages=new t(e&&e.messages),this.presence=new t(e&&e.presence),this.all=new t(e&&e.all)}function a(e){this.realtime=new i(e&&e.realtime),this.rest=new i(e&&e.rest),this.webhook=new i(e&&e.webhook),this.sharedQueue=new i(e&&e.sharedQueue),this.externalQueue=new i(e&&e.externalQueue),this.httpEvent=new i(e&&e.httpEvent),this.push=new i(e&&e.push),this.all=new i(e&&e.all)}function s(e){this.all=new i(e&&e.all),this.inbound=new a(e&&e.inbound),this.outbound=new a(e&&e.outbound)}function u(e){this.all=new i(e&&e.all),this.producerPaid=new s(e&&e.producerPaid),this.consumerPaid=new s(e&&e.consumerPaid)}function c(e){this.messages=e&&e.messages||0;var t=e&&e.notifications;this.notifications={invalid:t&&t.invalid||0,attempted:t&&t.attempted||0,successful:t&&t.successful||0,failed:t&&t.failed||0},this.directPublishes=e&&e.directPublishes||0}function l(e){this.succeeded=e&&e.succeeded||0,this.skipped=e&&e.skipped||0,this.failed=e&&e.failed||0}function f(e){if(this.delta=void 0,e&&e.delta)for(var t in this.delta={},e.delta){var n=e.delta[t];Object.prototype.hasOwnProperty.call(e.delta,t)&&n&&(this.delta[t]=new l(n))}}function p(e){s.call(this,e),this.persisted=new i(e&&e.persisted),this.connections=new o(e&&e.connections),this.channels=new n(e&&e.channels),this.apiRequests=new r(e&&e.apiRequests),this.tokenRequests=new r(e&&e.tokenRequests),this.xchgProducer=new u(e&&e.xchgProducer),this.xchgConsumer=new u(e&&e.xchgConsumer),this.push=new c(e&&e.pushStats),this.processed=new f(e&&e.processed),this.inProgress=e&&e.inProgress||void 0,this.unit=e&&e.unit||void 0,this.intervalId=e&&e.intervalId||void 0}return p.fromValues=function(e){return new p(e)},p}(),D=function(){function e(){this.id=void 0,this.deviceSecret=void 0,this.platform=void 0,this.formFactor=void 0,this.clientId=void 0,this.metadata=void 0,this.deviceIdentityToken=void 0,this.push={recipient:void 0,state:void 0,errorReason:void 0}}return e.prototype.toJSON=function(){return{id:this.id,deviceSecret:this.deviceSecret,platform:this.platform,formFactor:this.formFactor,clientId:this.clientId,metadata:this.metadata,deviceIdentityToken:this.deviceIdentityToken,push:{recipient:this.push.recipient,state:this.push.state,errorReason:this.push.errorReason}}},e.prototype.toString=function(){var e="[DeviceDetails";return this.id&&(e+="; id="+this.id),this.platform&&(e+="; platform="+this.platform),this.formFactor&&(e+="; formFactor="+this.formFactor),this.clientId&&(e+="; clientId="+this.clientId),this.metadata&&(e+="; metadata="+this.metadata),this.deviceIdentityToken&&(e+="; deviceIdentityToken="+JSON.stringify(this.deviceIdentityToken)),this.push.recipient&&(e+="; push.recipient="+JSON.stringify(this.push.recipient)),this.push.state&&(e+="; push.state="+this.push.state),this.push.errorReason&&(e+="; push.errorReason="+this.push.errorReason),this.push.metadata&&(e+="; push.metadata="+this.push.metadata),e+="]"},e.toRequestBody=v.encodeBody,e.fromResponseBody=function(t,n){return n&&(t=v.decodeBody(t,n)),v.isArray(t)?e.fromValuesArray(t):e.fromValues(t)},e.fromValues=function(t){return v.mixin(new e,t)},e.fromValuesArray=function(t){for(var n=t.length,r=new Array(n),o=0;o<n;o++)r[o]=e.fromValues(t[o]);return r},e}(),R=function(){function e(){this.channel=voirn{channel:this.chann+this.deviceId),this.clientId&&(e+="; clientId="t=v.decodeBody(t):e.fromValues(n=t.length,r=new Array(n),o=0;o<n;o++)r[o]=e.fromValues(t[o]);return r},e}(),P={disconnected:O.fromValues({statusCode:400,code:80003,message:"Connection to server temporarily unavailable"}),suspended:O.fromValues({statusCode:400,code:80002,message:"Connection to server unavailable"}),failed:O.fromValues({statusCode:400,code:8e4,message:"Connection failed or disconnected by server"}),closing:O.fromValues({statusCode:400,code:80017,message:"Connection closing"}),closed:O.fromValues({statusCode:400,code:80017,message:"Connection closed"}),unknownConnectionErr:O.fromValues({statusCode:500,code:50002,message:"Internal connection error"}),unknownChannelErr:O.fromValues({stannel error"})},M=function(){function e()inherits(e,w),e.prototype.count=function(){return this.messages.length},e.prototype.push=function(e){this.messages.push(e)},e.prprototype.last=function(){return this.messages[this.messages.length-1]},e.prototype.copyAll=function(){return this.messages.slice()},e.prototype.append=funotype.prepend=function(e){this.messages.unshift.apply(this.messages,e)},e.prototype.completeMessages=function(e,t,n){A.logAction(A.LOG_MICRO,"MessageQueue.completeMessages()","serial = "+e+"; count = "+t),n=n||null;var r=this.messages,o=r[0];if(o){var i=o.message.msgSerial,a=e+t;if(a>i)for(var s=r.splice(0,a-i),u=0;u<s.length;u++)s[u].callb){this.completeMessages(0,Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,e)},e.prototype.clear=function(){A.logAction(A.LOG_MICRO,"MessageQueue.clear()","clearing "+this.messages.length+" messages"),this.messages=[],this.emit("idle")},e}(),N=function(){var e=_.Action;function t(e){w.cals.messageQueue=tion(e,n){t.onAck(e,n)})),e.on("nack",(function(e,n,r){t.onNack(e,n,r)}))}return v.inherits(t,w),t.prototype.onAck=function(e,t){A.logAction(A.LOG_MICRO,"Protocol.onAck()","serial = "+e+"; count = "+t),this.messageQueue.completeMessages(e,t)},t.prototype.onNack=function(e,t,n){A.logAction(A.LOG_ERROR,"Protocol.onNack()","serial = "+e+"; count = "+t+"; err = "+v.inspectError(n)),n||(n=new O("Unable to send message; channel not responding",5000function(e){var t=this.messageQueue;0!==t.count()?t.once("idle",e):e()},t.prototype.send=function(e){e.ackRequired&&this.messageQueue.push(e),A.shouldLog(A.LOG_MICRO)&&A.logAction(A.LOG_MICRO,"Protocol.send()","sending msg; "+_.stringify(e.message)),e.sendAttempted=!0,this.transport.send(e.message)},t.prototype.getTransport=function(){return this.transport},t.prototype.getPendingMessages=functionotype.clearPendingMion(){var e=this.ion;this.sendAttempted=!1,this.ackRequired=r==e.MESSAGE||r==e.PRESENCE},t}(),F=function(){var e=!(void 0===h||!h.get),t=!(void 0===h||!h.getSession),n=_.Action,r=N.PendingMessage,o=function(){},i=g.transportPreferenceOrder,s=i[i.length-1];function u(e,t,n,r){this.options=e,this.host=t,this.mode=n,this.connectionKey=r,this.format=e.useBinaryProtocol?"msgpack":"json",this.connectionSerial=void 0,this.timeSerial=void 0}function c(e,n){w.call(this),this.realtime=e,this.options=n;var r=n.timeouts,o=this,i=r.preferenceConnectTimeout+r.realtimeRequestTimeout;if(this.states={initialized:{state:"initialized",terminal:!1,queueEvents:!0,sendEvents:!1,failState:"disconnected"},connecting:{state:"connecting",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:i,failState:"disconnected"},connected:{state:"connected",terminal:!1,queueEvents:!1,sendEvents:!0,failState:"disconnected"},synchronizing:{state:"connected",terminal:!1,queueEvents:!0,sendEvents:!1,forceQueueEvents:!0,failState:"disconnected"},disconnected:{state:"disconnected",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:r.disconnectedRetryTimeout,failState:"disconnected"},suspended:{state:"suspended",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:r.suspendedRetryTimeout,failState:"suspended"},closing:{state:"closing",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:r.realtimeRequestTimeout,failState:"closed"},closed:{state:"closed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"closed"},failed:{state:"failed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"failed"}},this.state=this.states.initialized,this.errorReason=null,this.queuedMessages=new M,this.msgSerial=0,this.connectionDetails=void 0,this.connectionId=void 0,this.connectionKey=void 0,this.timeSerial=void 0,this.connectionSerial=void 0,this.connectionStateTtl=r.connectionStateTtl,this.maxIdleInterval=null,this.transports=v.intersect(n.transports||g.defaultTransports,c.supportedTransports),this.baseTransport=v.intersect(g.baseTransportOrder,this.transports)[0],this.upgradeTransports=v.intersect(this.transports,g.upgradeTransports),this.transportPreference=null,this.httpHosts=g.getHosts(n),this.activeProtocol=null,this.proposedTransports=[],this.pendingTransports=[],this.host=null,this.lastAutoReconnectAttempt=null,this.lastActivity=null,this.mostRecentMsg=null,this.forceFallbackHost=!1,this.connectCounter=0,A.logAction(A.LOG_MINOR,"Realtime.ConnectionManager()","started"),A.logAction(A.LOG_MICRO,"Realtime.ConnectionManager()","requested transports = ["+(n.transports||g.defaultTransports)+"]"),A.logAction(A.LOG_MICRO,"Realtime.ConnectionManager()","available transports = ["+this.transports+"]"),A.logAction(A.LOG_MICRO,"Realtime.ConnectionManager()","http hosts = ["+this.httpHosts+"]"),!this.transports.length){var a="no requested transports available";throw A.logAction(A.LOG_ERROR,"realtime.ConnectionManager()",a),new Error(a)}var s=p.addEventListener;s&&(t&&"function"==typeof n.recover&&s("beforeunload",this.persistConnection.bind(this)),!0===n.closeOnUnload&&s("beforeunload",(function(){A.logAction(A.LOG_MAJOR,"Realtime.ConnectionManager()","beforeunload event has triggered the connection to close as closeOnUnload is true"),o.requestState({state:"closing"})})),s("online",(function(){o.state!=o.states.disconnected&&o.state!=o.states.suspended||(A.logAction(A.LOG_MINOR,"ConnectionManager caught browser ‘online’ event","reattempting connection"),o.requestState({state:"connecting"}))})),s("offline",(function(){o.state==o.states.connected&&(A.logAction(A.LOG_MINOR,"ConnectionManager caught browser ‘offline’ event","disconnecting active transport"),o.disconnectAllTransports())})))}return u.prototype.getConnectParams=function(e){var t=e?v.copy(e):{},n=this.options;switch(this.mode){case"upgrade":t.upgrade=this.connectionKey;break;case"resume":t.resume=this.connectionKey,void 0!==this.timeSerial?t.timeSerial=this.timeSerial:void 0!==this.connectionSerial&&(t.connectionSerial=this.connectionSerial);break;case"recover":var r=n.recover.split(":");if(r){t.recover=r[0];var o=r[1];isNaN(o)?t.timeSerial=o:t.connectionSerial=o}}return void 0!==n.clientId&&(t.clientId=n.clientId),!1===n.echoMessages&&(t.echo="false"),void 0!==this.format&&(t.format=this.format),void 0!==this.stream&&(t.stream=this.stream),void 0!==this.heartbeats&&(t.heartbeats=this.heartbeats),t.v=g.apiVersion,t.lib=g.libstring,void 0!==n.transportParams&&v.mixin(t,n.transportParams),t},u.prototype.toString=function(){var e="[mode="+this.mode;return this.host&&(e+=",host="+this.host),this.connectionKey&&(e+=",connectionKey="+this.connectionKey),void 0!==this.connectionSerial&&(e+=",connectionSerial="+this.connectionSerial),this.timeSerial&&(e+=",timeSerial="+this.timeSerial),this.format&&(e+=",format="+this.format),e+="]"},v.inherits(c,w),c.supportedTransports={},c.prototype.createTransportParams=function(e,t){var n=new u(this.options,e,t,this.connectionKey);return this.timeSerial?n.timeSerial=this.timeSerial:void 0!==this.connectionSerial&&(n.connectionSerial=this.connectionSerial),n},c.prototype.getTransportParams=function(e){var n=this;!function(e){if(n.connectionKey)e("resume");else if("string"!=typeof n.options.recover){var r=n.options.recover,o=t&&h.getSession("ably-connection-recovery");if(o&&"function"==typeof r)return A.logAction(A.LOG_MINOR,"ConnectionManager.getTransportParams()","Cald r(o,(function(t){t?(n.options.recover=o.recoveryKey,e("recover")):e("clean")}));e("clean")}else e("recover")}((function(t){var r=n.createTransportParams(null,t);if("recover"===t){A.logAction(A.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport recovery mode = recover; recoveryKey = "+n.options.recover);var o=n.options.recover.split(":");o&&o[2]&&(n.msgSerial=o[2])}else A.logAction(A.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport params = "+r.toString());e(r)}))},c.prototype.tryATransport=function(e,t,n){var r=this;e.host;A.logAction(A.LOG_MICRO,"ConnectionManager.tryATransport()","trying "+t),c.supportedTransports[t].tryConnect(this,this.realtime.auth,e,(function(o,i){var a=r.state;return a==r.states.closing||a==r.states.closed||a==r.states.failed?(i&&(A.logAction(A.LOG_MINOR,"ConnectionManager.tryATransport()","connection "+a.state+" while we were attempting the transport; closing "+i),i.close()),void n(!0)):o?(A.logAction(A.LOG_MINOR,"ConnectionManager.tryATransport()","transport "+t+" "+o.event+", err: "+o.error.tn(null,null,(function(o){o?r.actOnErrorFromAuthorize(o):r.tryATransport(e,t,n)})):"failed"===o.event?(r.notifyState({state:"failed",error:o.error}),n(!0)):"disconnected"===o.event&&n(!1))):(A.logAction(A.LOG_MICRO,"ConnectionManager.tryATransport()","viable transport "+t+"; setting pending"),r.setTransportPending(i,e),void n(null,i))}))},c.prototype.setTransportPending=function(e,t){var n=t.mode;A.logAction(A.LOG_MINOR,"ConnectionManager.setTransportPending()","transport = "+e+"; mode = "+n),v.arrDeleteValue(this.proposedTransports,e),this.pendingTransports.push(e);var r=this;e.once("connected",(function(o,i,a,u){"upgrade"==n&&r.actibilities(),s)?setTimeout((function(){r.scheduleTransportActivation(o,e,i,a,u)}),r.options.timeouts.parallelUpgradeDelay):r.schi,a,u):(r.activateTransport(o,e,i,a,u),v.nextTick((function(){r.connectImpl(t)}))),"recover"===n&&r.options.recover&&(r.options.rennected","closed","failed"],(function(t){r.deactivateTransport(e,this.event,t)})),this.emit("transport.pending",e)},c.prototype.scheduleTransportActivation=function(e,t,n,ransport(),l=function(){t.disconnect(),v.arrDeleteValue(u.pendingTransports,t)};return this.state!==this.states.connected&&this.state!==this.states.connecting?(A.logAction(A.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Current connection state ("+this.state.state+(this.state===this.states.synchronizing?", but with an upgrade already in progress":"")+") is not valid to upgrade in; abandoning upgrade to "+t.shortName),void l()):!c||(a=t,s=c,v.arrIndexOf(i,a.shortName)>v.arrIndexOf(i,s.shortName))?(A.logAction(A.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Scheduling transport upgrade; transport = "+t),void this.realtime.channels.onceNopending((function(i){var a;if(i)A.logAction(A.LOG_ERROR,"ConnectionManager.scheduleTransportActivation()","Unable to activate transport; transport = "+t+"; err = "+i);else{if(!t.isConnected)return A.logAction(A.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Proposed transport "+t.shortName+"is no longer connected; abandoning upgrade"),void l();if(u.state===u.states.connected)A.logAction(A.LOG_MICRO,"ConnectionManager.scheduleTransportActivation()","Currently connected, so temporarily pausing events until the upgrade is complete"),u.state=u.states.synchronizing,a=u.activeProtocol;else if(u.state!==u.states.connecting)return A.logAction(A.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Current connection state ("+u.state.state+(u.state===u.states.synchronizing?", but with an upgrade already in progress":"")+") is not valid to upgrade in; abandoning upgrade to "+t.shortName),void l();var s=n!==u.connectionId,c=s?o:u;s&&A.logAction(A.LOG_ERROR,"ConnectionManager.scheduleTransportActivation()","Upgrade resulted in new connectionId; resetting library connection position from "+(u.timeSerial||u.connectionSerial)+" to "+(c.timeSerial||c.connectionSerial)+"; upgrade error was "+e),A.logAction(A.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Syncing transport; transport = "+t),u.sync(t,c,(function(n,o,i){if(n)u.state===u.states.synchronizing&&(A.logAction(A.LOG_ERROR,"ConnectionManager.scheduleTransportActivation()","Unexpected error attempting to sync transport; transport = "+t+"; err = "+n),u.disconnectAllTransports());else{var s=function(){A.logAction(A.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Activating transport; transport = "+t),u.activateTransport(e,t,o,r,i),u.state===u.states.synchronizing?(A.logAction(A.LOG_MICRO,"ConnectionManager.scheduleTransportActivation()","Pre-upgrade protocol idle, sending queued messages on upgraded transport; transport = "+t),u.state=u.states.connected):A.logAction(A.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Pre-upgrade protocol idle, but state is now "+u.state.state+", so leaving unchanged"),u.state.sendEvents&&u.sendQueuedMessages()};a?a.onceIdle(s):s()}}))}}))):(A.logAction(A.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Proposed transport "+t.shortName+" is no better than current active transport "+c.shortName+" - abandoning upgrade"),void l())},c.prototype.activateTransport=function(e,t,n,r,o){A.logAction(A.LOG_MINOR,"ConnectionManager.activateTransport()","transport = "+t),e&&A.logAction(A.LOG_ERROR,"ConnectionManager.activateTransport()","error = "+e),n&&A.logAction(A.LOG_MICRO,"ConnectionManager.activateTransport()","connectionId =  "+n),r&&A.logAction(A.LOG_MICRO,"ConnectionManager.activateTransport()","connectionDetails =  "+JSON.stringify(r)),o&&A.logAction(A.LOG_MICRO,"ConnectionManager.activateTransport()","serial =  "+(o.timeSerial||o.connectionSerial)),this.persistTransportPreference(t);var i=this.state,a=this.states.connected.state;if(A.logAction(A.LOG_MINOR,"ConnectionManager.activateTransport()","current state = "+i.state),i.state==this.states.closing.state||i.state==this.states.closed.state||i.state==this.states.failed.state)return A.logAction(A.LOG_MINOR,"ConnectionManager.activateTransport()","Disconnecting transport and abandoning"),t.disconnect(),!1;if(v.arrDeleteValue(this.pendingTransports,t),!t.isConnected)return A.logAction(A.LOG_MINOR,"ConnectionManager.activateTransport()","Declining to activate transport "+t+" since it appears to no longer be connected"),!1;var s=this.activeProtocol;this.activeProtocol=new N(t),this.host=t.params.host;var u=r.connectionKey;u&&this.connectionKey!=u&&this.setConnection(n,r,o,!!e),this.onConnectionDetailsUpdate(r,t);var c=this;if(v.nextTick((function(){t.on("connected",(function(e,n,r){c.onConnectionDetailsUpdate(r,t),c.emit("update",new H(a,a,null,e))}))})),i.state===this.states.connected.state?e&&(this.errorReason=this.realtime.connection.errorReason=e,this.emit("update",new H(a,a,null,e))):(this.notifyState({state:"connected",error:e}),this.errorReason=this.realtime.connection.errorReason=e||null),this.emit("transport.active",t),s)if(s.messageQueue.count()>0&&A.logAction(A.LOG_ERROR,"ConnectionManager.activateTransport()","Previous active protocol (for transport "+s.transport.shortName+", new one is "+t.shortName+") finishing with "+s.messageQueue.count()+" messages still pending"),s.transport===t){var l="Assumption violated: activating a transport that was also the transport for the previous active protocol; transport = "+t.shortName+"; stack = "+(new Error).stack;A.logAction(A.LOG_ERROR,"ConnectionManager.activateTransport()",l),x.report("error",l,"transport-previously-active")}else s.finish();return v.safeArrForEach(this.pendingTransports,(function(e){if(e===t){var n="Assumption violated: activating a transport that is still marked as a pending transport; transport = "+t.shortName+"; stack = "+(new Error).stack;A.logAction(A.LOG_ERROR,"ConnectionManager.activateTransport()",n),x.report("error",n,"transport-activating-pending"),v.arrDeleteValue(c.pendingTransports,t)}else e.disconnect()})),v.safeArrForEach(this.proposedTransports,(function(e){if(e===t){var n="Assumption violated: activating a transport that is still marked as a proposed transport; transport = "+t.shortName+"; stack = "+(new Error).stack;A.logAction(A.LOG_ERROR,"ConnectionManager.activateTransport()",n),x.report("error",n,"transport-activating-proposed"),v.arrDeleteValue(c.proposedTransports,t)}else e.dispose()})),!0},c.prototype.deactivateTransport=function(e,t,n){var r=this.activeProtocol,o=r&&r.getTransport()===e,i=v.arrDeleteValue(this.pendingTransports,e),a=v.arrDeleteValue(this.proposedTransports,e),s=this.noTransportsScheduledForActivation();if(A.logAction(A.LOG_MINOR,"ConnectionManager.deactivateTransport()","transport = "+e),A.logAction(A.LOG_MINOR,"ConnectionManager.deactivateTransport()","state = "+t+(o?"; was active":i?"; was pending":a?"; was proposed":"")+(s?"":"; another transport is scheduled for activation")),n&&n.message&&A.logAction(A.LOG_MICRO,"ConnectionManager.deactivateTransport()","reason =  "+n.message),o&&(A.logAction(A.LOG_MICRO,"ConnectionManager.deactivateTransport()","Getting, clearing, and requeuing "+this.activeProtocol.messageQueue.count()+" pending messages"),this.queuePendingMessages(r.getPendingMessages()),v.nextTick((function(){r.clearPendingMessages()})),this.activeProtocol=this.host=null,clearTimeout(this.channelResumeCheckTimer)),this.emit("transport.inactive",e),o&&s||o&&"failed"===t||"closed"===t||null===r&&i&&0===this.pendingTransports.length){if("disconnected"===t&&n&&n.statusCode>500&&this.httpHosts.length>1)return this.unpersistTransportPreference(),this.forceFallbackHost=!0,void this.notifyState({state:t,error:n,retryImmediately:!0});var u="failed"===t&&z.isTokenErr(n)?"disconnected":t;this.notifyState({state:u,error:n})}else o&&"disconnected"===t&&this.state!==this.states.synchronizing&&(A.logAction(A.LOG_MICRO,"ConnectionManager.deactivateTransport()","wasActive but another transport is connected and scheduled for activation, so going into the connecting state until it activates"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),this.notifyStateTransports)||this.pendingTransports.every((function(e){return!e.isConnected}))},c.prototype.sync=function(e,t,r){var o=setTimeout((function(){e.off("sync"),r(new O("Timeout waiting for sync response",5e4,500))}),this.options.timeouts.realtimeRequestTimeout),i=_.fromValues({action:n.SYNC,connectionKey:this.connectionKey});t.timeSerial?i.timeSerial=t.timeSerial:void 0!==t.contionSerial),e.send(i),e.once("sync",(function(e,t){clearTimeout(o),r(null,e,t)}))},c.prototype.setConnection=function(e,t,n,r){var o=this,i=this.connectionid,a=i&&i!==e;(a||!i&&r)&&(A.logAction(A.LOG_MINOR,"ConnectionManager.setConnection()","Resetting msgSerial"),this.msgSerial=0),this.connectionId!==e?(A.logAction(A.LOG_MINOR,"ConnectionManager.setC any attached channels"),v.nextTick((function(){o.realtime.channels.reattach()}))):this.options.checkChannelsOnResume&&(A.logAction(A.LOG_MINOR,"ConnectionManager.setConnection()","Same connectionId; checkChannelsOnResume is enabled"),clearTimeout(this.channelResumeCheckTimer),this.realtimeTimer=setTimeout((function(){o.realtime.channels.checkAttachedMsgIndicators(e)}),3e4)),this.realtime.connection.id=this.connectionId=e,this.realtime.connection.key=this.connectionKey=t.connectionKey;var s=a||!i;this.setConnectionSerial(n,s)},c.prototype.clearConnection=function(){this.realtime.connection.id=this.connectionId=void 0,this.realtime.connection.key=this.connectionKey=void 0,this.clearConnectionSerial(),this.msgSerial=0,this.unpersistConnection()},c.prototype.setConnectionSerial=function(e,t){var n=e.timeSerial,r=e.connectionSerial;if(A.logAction(A.LOG_MICRO,"ConnectionManager.setConnectionSerial()","Updating connection serial; serial = "+r+"; timeSerial = "+n+"; force = "+t+"; previous = "+this.connectionSerial),void 0!==n)return n<=this.timeSerial&&!t?(A.logAction(A.LOG_ERROR,"ConnectionManager.setConnectionSerial()","received message with timeSerial "+n+", but current timeSerial is "+this.timeSerial+"; assuming message is a duplicate and discarding it"),!0):(this.realtime.connection.timeSerial=this.timeSerial=n,void this.setRecoveryKey());if(void 0!==r){if(r<=this.connectionSerial&&!t)return A.logAction(A.LOG_ERROR,"ConnectionManager.setConnectionSerial()","received message with connectionSerial "+r+", but current connectionSerial is "+this.connectionSerial+"; assuming message is a duplicate and discarding it"),!0;this.realtime.connection.serial=this.connectionSerial=r,this.setRecoveryKey()}},c.prototype.clearConnectionSerial=function(){this.realtime.connection.serial=this.connectionSerial=void 0,this.realtime.connection.timeSerial=this.timeSerial=void 0,this.clearRecoveryKey()},c.prototype.setRecoveryKey=function(){this.realtime.connection.recoveryKey=this.connectionKey+":"+(this.timerototype.clearRecoveryKey=function(){this.realtime.connection.recoveryKey=null},c.prototype.checkConnectionStateFreshness=function(){if(this.lastActivity&&this.connectionId){var e=v.now()-this.lastActivity;e>this.connectionStateTtl+this.maxIdleInterval&&(A.logAction(A.LOG_MINOR,"ConnectionManager.checkConnectionStateFreshness()","Last known activity from realtime was "+e+"ms ago; discarding connection state"),this.clearConnection(),this.states.connecting.failState="suspended",this.states.connecting.queueEvents=!1)}},c.prototype.persistConnection=function(){if(t){var e=this.realtime.connection.recoveryKey;e&&(n={recoveryKey:e,disconnectedAt:v.now(),location:a.location,clientId:this.realtime.auth.clientId},this.connectionStateTtl,t&&h.s.unpersistConnection=,c.prototype.getError=functStateError()},c.prototype.activeState=function(){return this.state.queueEvents||this.state.sendEvents},c.prototype.enactStateChange=function(e){var t="failed"===e.current?A.LOG_ERROR:A.LOG_MAJOR;A.logAction(t,"Connection state",e.current+(e.reason?"; reason: "+e.reason:"")),A.logAction(A.LOG_MINOR,"ConnectionManager.enactStateChange","setting new state: "+e.current+"; reason = "+(e.reason&&e.reason.message));var n=this.state=this.states[e.current];e.reason&&(this.errorReason=e.reason,this.realtime.connection.errorReason=e.reason),(n.terminal||"suspended"===n.state)&&this.clearConnection(),this.emit("connectionstate",e)},c.prototype.startTransitionTimer=function(e){A.logAction(A.LOG_MINOR,"ConnectionManager.startTransitionTimer()","transitionState: "+e.state),this.transitionTimer&&(A.logAction(A.LOG_MINOR,"ConnectionManager.startTransitionTimer()","clearing already-running timer"),clearTimeout(this.transitionTimer));var t=this;this.transitionTimer=setTimeout((function(){t.transitionTimer&&(t.transitionTimer=null,A.logAction(A.LOG_MINOR,"ConnectionManager "+e.state+" timer expired","requesting new state: "+e.failState),t.notifyState({state:e.failState}))}),e.retryDelay)},c.prototype.cancelTransitionTimer=function(){A.logAction(A.LOG_MINOR,"ConnectionManager.cancelTransitionTimer()",""),this.transitionTimer&&(clearTimeout(this.transitionTimer),this.transitionTimer=null)},c.prototype.startSuspendTimer=function(){var e=this;this.suspendTimer||(this.suspendTimer=setTimeout((function(){e.suspendTimer&&(e.suspendTimer=null,A.logAction(A.LOG_MINOR,"ConnectionManager suspend timer expired","requesting new state: suspended"),e.states.connecting.failState="suspended",e.states.connecting.queueEvents=!1,e.notifyState({isconnected"!==e&&"suspended"!==e&&"connecting"!==e&&this.cancelSuspendTimer()},c.prototype.cancelSuspendTimer=function(){this.states.connecting.failState="disconnected",this.states.connecting.queueEvents=!0,this.suspendTimer&&(clearTimeout(this.suspendTimer),this.suspendTimer=null)},c.prototype.startRetryTimer=function(e){var t=this;this.retryTimer=setTimeout((function(){A.logAction(A.LOG_MINOR,"ConnectionManager retry timer expired","retrying"),t.retryTimer=null,t.requestState({state:"connecting"})}),e)},c.prototype.cancelRetryTimer=function(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)},c.prototype.notifyState=function(e){var t=e.state,n=this,r="disconnected"===t&&(this.state===this.states.connected||this.state===this.states.synchronizing||e.retryImmediately||this.state===this.states.connecting&&e.error&&z.isTokenErr(e.error)&&!(this.errorReason&&z.isTokenErr(this.errorReason)));if(A.logAction(A.LOG_MINOR,"ConnectionManager.notifyState()","new state: "+t+(r?"; will retry connection immediately":"")),t!=this.state.state&&(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(e.state),!this.state.terminal)){var o=this.states[e.state]ted&&(n.lastAutoReconnectAttempt=v.now(),n.requestState({state:"connecting"}))},s=this.lastAutoReconnectAttempt&&v.now()-this.lastAutoReconnectAttempt+1;s&&s<1e3?(A.logAction(A.LOG_MICRO,"ConnectionManager.notifyState()","Last reconnect attempt was only "+s+"ms ago, waiting another "+(1e3-s)+"ms before trying again"),setTimeout(a,1e3-s)):v.nextTick(a)}else"disconnected"!==t&&"suspended"!==t||this.startRetryTimer(o.retryDelay);("disconnected"===t&&!r||"suspended"===t||o.terminal)&&v.nextTick((function(){n.disconnectAllTransports()})),"connected"!=t||this.activeProtocol||A.logAction(A.LOG_ERROR,"ConnectionManager.notifyState()","Broken invariant: attempted to go into connected state, but there is no active protocol"),this.enactStateChange(i),this.state.sendEvents?this.sendQueuedMessages():this.state.queueEvents||(this.realtime.channels.propogateConnectionInterruption(t,i.reason),this.failQueuedMessages(i.reason))}},c.prototype.requestState=function(e){var t=e.state,n=this;if(A.logAction(A.LOG_MINOR,"ConnectionManager.requestState()","requested state: "+t+"; current state: "+this.state.state),t!=this.state.state&&(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(t),!("connecting"==t&&"connected"==this.state.state||"closing"==t&&"closed"==this.state.state))){var r=this.states[t],o=new H(this.state.state,r.state,null,e.error||P[r.state]);this.enactStateChange(o),"connecting"==t&&v.nextTick((function(){n.startConnect()})),"closing"==t&&this.closeImpl()}},c.prototype.startConnect=function(){if(this.state===this.states.connecting){var e=this.realtime.auth,t=this,n=++this.conns(),t.getTransportParams((function(e){n===t.connectCounter&&t.connectImpl(e,n)}))};if(A.logAction(A.LOG_MINOR,"ConnectionManager.startConnect()","starting connection"),this.startSuspendTimer(),thise{var o=function(e){n===t.connectCounter&&(e?t.actOnErrorFromAuthorize(e):r())};this.errorReason&&z.isTokenErr(this.errorReason)?e._forceNewToken(null,null,o):e._ensureValidAuthCredentials(!1,o)}}else A.logAction(A.LOG_MINOR,"ConnectionManager.startConnect()","Must be in connecting state to connect, but was "+this.state.state)},c.prototype.connectImpl=function(e,t){var n=this.state.state;n!==this.states.connecting.state&&n!==this.states.connected.state?A.logAction(A.LOG_MINOR,"ConnectionManager.connectImpl()","Must be in connecting state to connect (or connected to upgrade), but was "+n):this.pendingTransports.length?A.logAction(A.LOG_MINOR,"ConnectionManager.connectImpl()","Transports "+this.pendingTransports[0].toString()+" currently pending; taking no action"):n==this.states.connected.state?this.upgradeIfNeeded(e):this.transports.length>1&&this.getTransportPreference()?this.connectPreference(e):this.connectBase(e,t)},c.prototype.connectPreference=function(e){var t=this.getTransportPreference(),n=this,r=!1;v.arrIn(this.transports,t)||(this.unpersistTransportPreference(),this.connectImpl(e)),A.logAction(A.LOG_MINOR,"ConnectionManager.connectPreference()","Trying to connect with stored transport preference "+t);var o=setTimeout((function(){r=!0,n.state.state!==n.states.connected.state&&(A.logAction(A.LOG_MINOR,"ConnectionManager.connectPreference()","Shortcircuit connection attempt with "+t+" failed; clearing preference and trying from scratch"),n.disconnectAllTransports(),n.unpersistTransportPreference()),n.connectImpl(e)}),this.options.timeouts.preferenceConnectTimeout);e.host=n.httpHosts[0],n.tryATransport(e,t,(function(t,i){clearTimeout(o),r&&i?(i.off(),i.disconnect(),v.arrDeleteValue(this.pendingTransports,i)):i||t||(n.unpersistTransportPreferhis,r=function(e){n.notifyS})},o=this.httpHosts.slice(),i=function(e,r){t===n.connectCounter&&(r||e||s())};A.logAction(A.LOG_MINOR,"ConnectionManager.connectBase()","Trying to connect with base transport "+this.baseTransport);var a=o.shift();if(a){if(e.host=a,this.forceFallbackHost&&o.length)return this.forceFallbackHost=!1,void s();this.tryATransport(e,this.baseTransport,i)}else r(new O("Unable to connect (no available host)",80003,404));function s(){o.length?y.checkConnectivity((function(a,s){t===n.connectCounter&&(a?r(a):s?(e.host=v.arrPopRandomElement(o),n.tryATransport(e,n.baseTransport,i)):r(new O("Unable to connect (network unreachable)",80003,404)))})):r(new O("Unable to connect (and no.arrIndexOf(this.upgradeTransports,e);return this.upgradeTransports.slice(t+1)},c.prototype.upgradeIfNeeded=function(e){var t=this.getUpgradePossibilities(),n=this;A.logAction(A.LOG_MINOR,"ConnectionManager.upgration(t){var r=n.createTransportParams(e.host,"upgrade");n.tryATransport(r,t,o)}))},c.prototype.closeImpl=function(){A.logAction(A.LOG_MINOR,"ConnectionManager.closeImpl()","closing connection"),this.cancelSuspendTimer(),this.startTransitionTimer(this.states.closing),v.safeArrForEach(this.pendingTransports,(function(e){A.logAction(A.LOG_MICRO,"ConnectionManager.closeImpl()","Closing pending transport: "+e),e&&e.close()})),v.safeArrForEach(this.proposedTransports,(function(e){A.logAction(A.LOG_MICRO,"ConnectionManager.closeImpl()","Disposing of proposed transport: "+e),e&&e.dispose()})),this.activeProtocol&&(A.logAction(A.LOG_MICRO,"ConnectionManager.closeImpl()","Closing active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().close()),this.notifyState({state:"closed"})},c.prototype.onAuthUpdated=function(e,t){var r=this;switch(this.state.state){case"connected":if(A.logAction(A.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Sending AUTH message on active transport"),(this.pendingTransports.length||this.proposedTransports.length)&&r.state!==r.states.synchronizing){this.disconnearams;v.nextTick((function(){"connected"===r.state.state&&r.upgradeIfNeeded(o)}))}this.activeProtocol.getTransport().onAuthUpdated(e);va,aon(e){"failed"===e.current&&(r.off(a),r.off(s),t(e.reason||r.getStateError()))};this.once("connectiondetails",a),this.on("connectionstate",s);break;case"connecting":A.logAction(A.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Aborting current connection attempts in order to start again with the new auth details"),this.disconnectAllTransports();default:A.logAction(A.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Connection "failed":case"closed":case"suspended":r.off(u),t(n.reason||r.getStateError())}};r.on("connectionstate",u),"connecting"===this.state.state?r.startConnect():r.requestState({state:"connecting"})}},c.prototype.disconnectAllTransports=function(e){A.logAction(A.LOG_MINOR,"ConnectionManager.disconnectAllTransports()","Disconnecting all transports"+(e?" except the active transport":"")),this.connectCounter++,v.safeArrForEach(this.pendingTransports,(function(e){A.logAction(A.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting pending transport: "+e),e&&e.disconnect()})),this.pendingTransports=[],v.safeArrForEach(this.proposedTransports,(function(e){A.logAction(A.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disposing of proposed transport: "+e),e&&e.dispose()})),this.proposedTransports=[],this.activeProtocol&&!e&&(A.logAction(A.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().disconnect())},c.prototype.send=function(e,t,n){n=n||o;var i=this.state;if(i.sendEvents)return A.logAction(A.LOG_MICRO,"ConnectionManager.send()","sending event"),void this.sendImpl(new r(e,n));if(!(t&&i.queueEvents||i.forceQueueEvents)){var a="rejecting event, queueEvent was "+t+", state was "+i.state;return A.logAction(A.LOG_MICRO,"ConnectionManager.send()",a),void n(this.errorReason||new O(a,9e4,400))}A.shouldLog(A.LOG_MICRO)&&A.logAction(A.LOG_MICRO,"ConnectionManager.send()","queueing msg; "+_.stringify(e)),this.queue(e,n)},c.prototype.sendImpl=function(e){var t=e.message;e.ackRequired&&!e.sendAttempted&&(t.msgSerial=this.msgSerial++,this.setRecoveryKey());try{this.activeProtocol.send(e)}catch(e){A.logAction(A.LOG_ERROR,"ConnectionManager.sendImpl()","Unexpected exception in transport.send(): "+e.stack)}},c.prototype.queue=function(e,t){A.logAction(A.LOG_MICRO,"ConnectionManager.queue()","queueing event");var o=this.queuedMessages.last(),i=this.options.maxMessageSize;o&&!o.sendAttempted&&function(e,t,r){var o;if(e.channel!==t.channel)return!1;if((o=e.action)!==n.PRESENCE&&o!==n.MESSAGE)return!1;if(o!==t.action)return!1;var i=o===n.PRESENCE?"presence":"messages",a=e[i].concat(t[i]);return!(S.getMessagesSize(a)>r)&&(!!v.allSame(a,"clientId")&&(!!v.arrEvery(a,(function(e){return!e.id}))&&(e[i]=a,!0)))}(o.message,e,i)?(o.merged||(o.callback=C([o.callback]),o.merged=!0),o.callback.push(t)):this.queuedMessages.push(new r(e,t))},c.prototype.sendQueuedMessages=function(){var e;for(A.logAction(A.LOG_MICRO,"ConnectionManager.sendQueuedMessages()","sending "+this.queuedMessages.count()+" queued messages");e=this.queuedMessages.shift();)this.sendImpl(e)},c.prototype.queuePendingMessages=function(e){e&&e.length&&(A.logAction(A.LOG_MICRO,"ConnectionManager.queuePendingMessages()","queueing "+e.length+" pending messages"),this.queuedMessages.prepend(e))},c.prototype.failQueuedMessages=function(e){var t=this.queuedMessages.count();t>0&&(A.logAction(A.LOG_ERROR,"ConnectionManager.failQueuedMessages()","failing "+t+" queued messages, err = "+v.inspectError(e)),this.queuedMessages.completeAllMessages(e))},c.prototype.onChannelMessage=function(e,t){var r=this.activeProtocol&&t===this.activeProtocol.getTransport(),o=v.arrIn(this.pendingTransports,t)&&this.state==this.states.synchronizing,i=e.action===n.MESSAGE||e.action===n.PRESENCE;if(r||o){if(i){if(this.setConnectionSerial(e))return;if(_.isDuplicate(e,this.mostRecentMsg))return void A.logAction(A.LOG_ERROR,"ConnectionManager.onChannelMessage()","received message with different connectionSerial, but same message id as a previous; discarding; id = "+e.id);this.mostRecentMsg=e}this.realtime.channels.onChannelMessage(e)}else v.arrIndexOf([n.ACK,n.NACK,n.ERROR],e.action)>-1?this.realtime.channels.onChannelMessage(e):A.logAction(A.LOG_MICRO,"ConnectionManager.onChannelMessage()","received message "+JSON.stringify(e)+"on defunct transport; discarding")},c.prototype.ping=function(e,t){if(e){A.logAction(A.LOG_MINOR,n(a){if(a===r){e.off("heartbeat",o),clearTimeout(i);var s=v.now()-n;t(null,s)}},i=setTimeout((function(){e.off("heartbeat",o),t(new O("Timeout waiting for heartbeat response",5e4,500))}),this.options.timeouts.realtimeRequestTimeout);return e.on("heartbeat",o),void e.ping(r)}if("connected"===this.state.state){var a=!1,s=this,u=function(){a||(a=!0,v.nextTick((function(){s.ping(null,t)})col.getTransport(),(function(e,n){s.off("transport.active",u),a||(a=!0,t(e,n))}))}el00))},c.prototype.abort=function(e){thrototype.registerProposedTransport=function(e){this.proposedTransports.push(e)},c.prototype.getTransportPreference=function(){return this.transportPreference||e&&h.get("ably-transport-preference")},c.prototype.persistTransportPreference=function(t){v.arrIn(g.upgradeTransports,t.shortName)&&(this.transportPreference=t.shortName,e&&h.set("ably-transport-preference",t.shortName))},c.prototype.unpersistTransportPreference=function(){this.transportPreference=null,e&&h.remove("ably-transport-preference")},c.prototype.actOnErrorFromAuthorize=function(e){if(40171===e.code)this.notifyState({state:"failed",error:e});else if(403===e.statusCode){var t="Client configured authentication provider returned 403; failing the connection";A.logAction(A.LOG_ERROR,"ConnectionManager.actOnErrorFromAuthorize()",t),this.notifyState({state:"failed",error:new O(t,80019,403,e)})}else{t="Client configured authentication provider request failed";A.logAction(A.LOG_MINOR,"ConnectionManager.actOnErrorFromAuthorize",t),this.notifyState({state:this.state.failState,error:new O(t,80019,401,e)})}},c.prototype.onConnectionDetailsUpdate=function(e,t){if(e){this.connectionDetails=e,e.maxMessageSize&&(this.options.maxMessageSize=e.maxMessageSize);var n=e.clientId;if(n){var r=this.realtime.auth._uncheckedSetClientId(n);if(r)return A.logAction(A.LOG_ERROR,"ConnectionManager.onConnectionDetailsUpdate()",r.message),void t.fail(r)}var o=e.connectionStateTtl;o&&(this.connectionStateTtl=o),this.maxIdleInterval=e.maxIdleInterval,this.emit("connectiondetails",e)}},c}(),L=function(){var e=_.Action,t=_.fromValues({action:e.CLOSE}),n=_.fromValues({action:e.DISCONNECT});function r(e,t,n){w.call(this),this.connectionManager=e,e.registerProposedTransport(this),this.auth=t,this.params=n,this.timeouts=n.options.timeouts,this.format=n.format,this.isConnected=!1,this.isFinished=!1,this.isDisposed=!1,this.maxIdleInterval=null,this.idleTimer=null,this.lastActivity=null}return v.inherits(r,w),r.prototype.connect=function(){},r.prototype.close=function(){this.isConnected&&this.requestClose(),this.finish("closed",P.closed)},r.prototype.disconnect=function(e){this.isConnected&&this.requestDisconnect(),this.finish("disconnected",e||P.disconnected)},r.prototype.fail=function(e){this.isConnected&&this.requestDisconnect(),this.finish("failed",e||P.failed)},r.prototype.finish=function(e,t){this.isFinished||(this.isFinished=!0,this.isConnected=!1,this.maxIdleInterval=null,clearTimeout(this.idleTimer),this.idleTimer=null,this.emit(e,t),this.dispose())},r.prototype.onProtocolMessage=function(t){switch(A.shouldLog(A.LOG_MICRO)&&A.logAction(A.LOG_MICRO,"Transport.onProtocolMessage()","received on "+this.shortName+": "+_.stringify(t)+"; connectionId = "+this.connectionManager.connectionId),this.onActivity(),t.action){case e.HEARTBEAT:A.logAction(A.LOG_MICRO,"Transport.onProtocolMessage()",this.shortName+" heartbeat; connectionId = "+this.connectionManager.connectionId),this.emit("heartbeat",t.id);break;case e.CONNECTED:this.onConnect(t),this.emit("connected",t.error,t.connectionId,t.connectionDetails,t);break;case e.CLOSED:this.onClose(t);break;case e.DISCONNECTED:this.onDisconnect(t);break;case e.ACK:this.emit("ack",t.msgSerial,t.count);break;case e.NACK:this.emit("nack",t.msgSerial,t.count,t.error);break;case e.SYNC:if(void 0!==t.connectionId){this.emit("sync",t.connectionId,t);break}this.connectionManager.onChannelMessage(t,this);break;case e.AUTH:this.auth.authorize((function(e){e&&A.logAction(A.LOG_ERROR,"Transport.onProtocolMessage()","Ably requested re-authentication, but unable to obtain a new token: "+v.inspectError(e))}));break;case e.ERROR:if(A.logAction(A.LOG_MINOR,"Transport.onProtocolMessage()","received error action; connectionId = "+this.connectionManager.connectionId+"; err = "+v.inspect(t.error)+(t.channel?", channel: "+t.channel:"")),void 0===t.channel){this.onFatalError(t);break}this.connectionManager.onChannelMessage(t,this);break;default:this.connectionManager.onChannelMessage(t,this)}},r.prototype.onConnect=function(e){this.isConnected=!0;var t=e.connectionDetails.maxIdleInterval;t&&(this.maxIdleInterval=t+this.timeouts.realtimeRequestTimeout,this.onActivity())},r.prototype.onDisconnect=function(e){var t=e&&e.error;A.logAction(A.LOG_MINOR,"Transport.onDisconnect()","err = "+v.inspectError(t)),this.finish("disconnected",t)},r.prototype.onFatalError=function(e){var t=e&&e.error;A.logAction(A.LOG_MINOR,"Transport.onFatalError()","err = "+v.inspectError(t)),this.finish("failed",t)},r.prototype.onClose=function(e){var t=e&&e.error;A.logAction(A.LOG_MINOR,"Transport.onClose()","err = "+v.inspectError(t)),this.finish("closed",t)},r.prototype.requestClose=function(){A.logAction(A.LOG_MINOR,"Transport.requestClose()",""),this.send(t)},r.prototype.requestDisconnect=function(){A.logAction(A.LOG_MINOR,"Transport.requestDisconnect()",""),this.send(n)},r.prototype.ping=function(e){var t={action:_.Action.HEARTBEAT};e&&(t.id=e),this.send(_.fromValues(t))},r.prototype.dispose=function(){A.logAction(A.LOG_MINOR,ctionManager.lastActivity.idleTimer||(this.idleTimer=setTimeout((function(){t.onIdleTimerExpire()}),e))},r.prototype.onIdleTimerExpire=function(){this.idleTimer=null;var e=v.now()-this.lastActivity,t=this.maxIdleInterval-e;if(t<=0){var n="No activity seen from realtime in "+e+"ms; assuming connection has dropped";A.logAction(A.LOG_ERROR,"Transport.onIdleTimerExpire()",n),this.disconnect(new O(n,80003,408))}else this.setIdleTimer(t+100)},r.prototype.onAuthUpdated=function(){},r}(),I=(function(){var e=p.WebSocket;function t(e,t,n){this.shortName="web_socket",n.heartbeats=p.useProtocolHeartbeats,L.call(this,etHost(n.options,n.host,!0)}v.inherits(t,L),t.isAvailable=function(){return!!e},t.isAvailable()&&(F.supportedTransports.web_socket=t),t.tryConnect=function(e,n,r,o){var i=new t(e,n,r),a=function(e){o({event:this.event,error:e})};i.on(["failed","disconnected"],a),i.on("wsopen",(function(){A.logAction(A.LOG_MINOR,"WebSocketTransport.tryConnect()","viable transport "+i),i.off(["failed","disconnected"],a),o(null,i)})),i.connect()},t.prototype.createWebSocket=function(t,n){var r=0;if(n)for(var o in(t)},t.prototype.toString=function(){return"WebSocketTransport; uri="+this.uri},t.prototype.connect=function(){A.logAction(A.LOG_MINOR,"WebSocketTransport.connect()","starting"),L.prototype.connect.call(this);var e=this,t=this.params,n=t.options,r=(n.tls?"wss://":"ws://")+this.wsHost+":"+g.getPort(n)+"/";A.logAction(A.LOG_MINOR,"WebSocketTransport.connect()","uri: "+r),this.auth.getAuthParams((function(n,o){if(!e.isDisposed){var i="";for(var a in o)i+=" "+a+": "+o[a]+";";if(A.logAction(A.LOG_MINOR,"WebSocketTransport.connect()","authParams:"+i+" err: "+n),n)e.disconnect(n);else{var s=t.getConnectParams(o);try{var u=e.wsConnection=e.createWebSocket(r,s);u.binaryType=p.binaryType,u.ononclose=function(t){e.onWsClose(t)},u.onmessage=function(t){e.onWsData(t.data)},u.onerror=function(t){e.onWsError(t)},u.on&&u.on("ping",(function(){e.onActivity()}))}catch(t){A.logAction(A.LOG_ERROR,"WebSocketTransport.connect()","Unexpected exception creating websocket: err = "+(t.stack||t.message)),e.disconnect(t)}}}}))},t.prototype.send=function(e){var t=this.wsConnection;if(t)try{t.send(_.serialize(e,this.params.format))}catch(e){var n="Exception from ws connection when trying to send: "+v.inspectError(e);A.logAction(A.LOG_ERROR,"WebSocketTransport.send()",n),this.finish("disconnected",new O(n,5e4,500))}else A.logAction(A.LOG_ERROR,"WebSocketTransport.send()","No socket connection")},t.prototype.onWsData=function(e){A.logAction(A.LOG_MICRO,"WebSocketTransport.onWsData()","data received; length = "+e.length+"; type = "+typeof e);try{this.onProtocolMessage(_.deserialize(e,this.format))}catch(e){A.logAction(A.LOG_ERROR,"WebSocketTransport.onWsData()","Unexpected exception handing channel message: "+e.stack)}},t.prototype.onWsOpen=function(){A.logAction(A.LOG_MINOR,"WebSocketTransport.onWsOpen()","opened WebSocket"),this.emit("wsopen")},t.prototype.onWsClose=function(e){var t,n;if("object"==typeof e?(t=e.wasClean,n=e.code):t=1e3==(n=e),delete this.wsConnection,t){A.logAction(A.LOG_MINOR,"WebSocketTransport.onWsClose()","Cleanly closed WebSocket");var r=new O("Websocket closed",80003,400);this.finish("disconnected",r)}else{var o="Unclean disconnection of WebSocket ; code = "+n;r=new O(o,80003,400);A.logAction(A.LOG_MINOR,"WebSocketTransport.onWsClose()",o),this.finish("disconnected",r)}this.emit("disposed")},t.prototype.onWsError=function(e){A.logAction(A.LOG_MINOR,"WebSocketTransport.onError()","Error from WebSocket: "+e.message);var t=this;v.nextTick((function(){t.disconnect(e)}))},t.prototype.dispose=function(){A.logAction(A.LOG_MINOR,"WebSocketTransport.dispose()",""),this.isDisposed=!0;var e=this.wsConnection;e&&(e.onmessage=function(){},delete this.wsConnection,v.nextTick((function(){A.logAction(A.LOG_MICRO,"WebSocketTransport.dispose()","closing websocket"),e.close()})))}}(),function(){function e(e){return function(e){return!!e.code&&(!z.isTokenErr(e)&&(!!v.arrIn([80015,80017,80030],e.code)||e.code>=4e4&&e.code<5e4))}(e)?[_.fromValues({action:_.Action.ERROR,error:e})]:[_.fromValues({action:_.Action.DISCONNECTED,error:e})]}function t(e,t,n){n.format=void 0,n.heartbeats=!0,L.call(this,e,t,n),this.stream=!("stream"in n)||n.stream,this.sendRequest=null,this.recvRequest=null,this.pendingCallback=null,this.pendingItems=null}return v.inherits(t,L),t.REQ_SEND=0,t.REQ_RECV=1,t.REQ_RECV_POLL=2,t.REQ_RECV_STREAM=3,t.prototype.connect=function(){A.logAction(A.LOG_MINOR,"CometTransport.connect()","starting"),L.prototype.connect.call(this);var t=this,n=this.params,r=n.options,o=g.getHost(r,n.host),i=g.getPort(r),a=r.tls?"https://":"http://";this.baseUri=a+o+":"+i+"/comet/";var s=this.baseUri+"connect";A.logAction(A.LOG_MINOR,"CometTransport.connect()","uri: "+s),this.auth.getAuthParams((function(n,r){if(n)t.disconnect(n);else if(!t.isDisposed){t.authParams=r;var o=t.params.getConnectParams(r);"stream"in o&&(t.stream=o.stream),A.logAction(A.LOG_MINOR,"CometTransport.connect()","connectParams:"+v.toQueryString(o));vadata",(function(e){t.recvRequest&&(i||(i=!0,t.emit("preconnect")),t.onData(e))})),a.on("complete",(function(n,r,o){t.recvRequest||(n=n||new O("Request cancelled",80003,400)),t.recvRequest=null,i||(i=!0,t.emit("preconnect")),t.onActivity(),n?n.code?t.onData(e(n)):t.disconnect(n):v.nextTick((function(){t.recv()}))})),a.exec()}}))},t.prototype.requestClose=function(){A.logAction(A.LOG_MINOR,"CometTransport.requestClose()"),this._requestCloseOrDisconnect(!0)},t.prototype.requestDisconnect=function(){A.logAction(A.LOG_MINOR,"CometTransport.requestDisconnect()"),this._requestCloseOrDisconnect(!1)},t.prototype._requestCloseOrDisconnect=function(e){var t=e?this.closeUri:this.disconnectUri;if(t){var n=this,r=this.createRequest(t,null,this.authParams,null,0);r.on("complete",(function(t){t&&(A.logAction(A.LOG_ERROR,"CometTransport.request"+(e?"Close()":"Disconnect()"),"request returned err = "+v.inspectError(t)),n.finish("disconnected",t))})),r.exec()}},t.prototype.dispose=function(){if(A.logAction(A.LOG_MINOR,"CometTransport.dispose()",""),!this.isDisposed){this.isDisposed=!0,this.recvRequest&&(A.logAction(A.LOG_MINOR,"CometTransport.dispose()","aborting recv request"),this.recvRequest.abort(),this.recvRequest=null),this.finish("disconnected",P.disconnected);var e=this;v.nextTick((function(){e.emit("disposed")}))}},t.prototype.onConnect=function(e){if(!this.isDisposed){var t=e.connectionKey;L.prototype.onConnect.call(this,e);var n=this.baseUri+t;A.logAction(A.LOG_MICRO,"CometTransport.onConnect()","baseUri = "+n+"; connectionKey = "+e.connectionKey),this.sendUri=n+"/send",this.recvUri=n+"/recv"var t=this.pendingItems||[]nction(){var e=this.pendingItems;e&&(this.pendingItems=null,this.sendItems(e))},t.prototype.sendItems=function(t){var n=this,r=this.sendRequest=n.createRequest(n.sendUri,null,n.authParams,this.encodeRequest(t),0);r.on("complete",(function(t,r){t&&A.logAction(A.LOG_ERROR,"CometTransport.sendItems()","on complete: err = "+v.inspectError(t)),n.sendRequest=null,t?t.ta(r),n.pendingItems&&v.nextTick((function(){n.sendRequest||n.sendAnyPending()})))})),r.exec()},t.prototype.recv=function(){if(!this.recvRequest&&this.isConnected){var t=this,n=this.recvRequest=this.createRequest(this.recvUri,null,this.authParams,null,t.stream?3:2);n.on("data",(function(e){t.onData(e)})),n.on("complete",(function(n){t.recvRequest=null,t.onActivity(),n?n.code?t.onData(e(n)):t.disconnect(n):v.nextTick((function(){t.recv()}))})),n.exec()}},t.prototype.onData=function(e){try{var t=this.decodeResponse(e);if(t&&t.length)for(var n=0;n<t.length;n++)this.onProtocolMessage(_.fromDeserialized(t[n]))}catch(e){A.logAction(A.LOG_ERROR,"CometTransport.onData()","Unexpected exception handing channel event: "+e.stack)}},t.prototypeotype.decodeResponse=funct},t.prototype.onAuthUpdated=function(e){this.authParams={access_token:e.token}},t}()),j=function(){function e(){}function t(e){this.channel=e,this.basePath=e.basePath+"/presence"}return v.inherits(t,w),t.prototype.get=function(t,n){if(A.logAction(A.LOG_MICRO,"Presence.get()","channel = "+this.channel.name),void 0===n)if("function"==typeof t)n=t,t=null;else{if(this.channel.rest.options.promises)return v.promisify(this,"get",arguments);n=e}var r=this.channel.rest,o=r.options.useBinaryProtocol?"msgpack":"json",i=y.supportsLinkHeaders?void 0:o,a=v.defaultGetHeaders(o);r.options.headers&&v.mixin(a,r.options.headers);var s=this.channel.channelOptions;new U(r,this.basePath,a,i,(function(e,t,n){return k.fromResponseBody(e,s,!n&&o)})).get(t,n)},t.prototype.history=function(e,t){A.logAction(A.LOG_MICRO,"Presence.history()","channel = "+this.channel.name),this._history(e,t)},t.prototype._history=function(t,n){if(void 0===n)if("function"==typeof t)n=t,t=null;else{if(this.channel.rest.options.promises)return v.promisify(this,"_history",arguments);n=e}var r=this.channel.rest,o=r.options.useBinaryProtocol?"msgpack":"json",i=y.supportsLinkHeaders?void 0:o,a=v.defaultGetHeaders(o);this.channel;r.options.headers&&v.mixin(a,r.options.headers);var s=this.channel.channelOptions;new U(r,this.basePath+"/history",a,i,(function(e,t,n){return k.fromResponseBody(e,s,!n&&o)})).get(t,n)},t}(),B=function(){var e=p.msgpack;fportsAuthHeaders?e.auth..m.push(n+"="+e[n]);return t.join("&")}function o(e,t){return e+(t?"?":"")+r(t)}return v.arrForEach(y.methodsWithoutBody,(function(e){t[e]=function(n,r,o,i,a,s){t.do(e,n,r,null,o,i,a,s)}})),v.arrForEach(y.methodsWithBody,(function(e){t[e]=function(n,r,o,i,a,s,u){t.do(e,n,r,o,i,a,s,u)}})),t.do=function(t,i,a,s,u,c,l,f){A.shouldLog(A.LOG_MICRO)&&(f=function(e,t,n,i){return function(a,s,u,c,l){a?A.logAction(A.LOG_MICRO,"Resource."+t+"()","Received Error; "+o(n,i)+"; Error: "+v.inspectError(a)):A.logAction(A.LOG_MICRO,"Resource."+t+"()","Received; "+o(n,i)+"; Headers: "+r(u)+"; StatusCode: "+l+"; Body: "+(m.isBuffer(s)?s.toString():s)),e&&e(a,s,u,c,l)}}(f,t,a,c)),l&&(f=f&&function(e,t){return function(n,r,o,i,a){if(!n||r){if(!i)try{r=v.decodeBody(r,t)}catch(t){return void e(t)}if(void 0!==r.statusCode){var s=r.statusCode,u=r.response,c=r.headers;if(s<200||s>=300){var l=u&&u.error||n;return l||((l=new Error("Error in unenveloping "+r)).statusCode=s),void e(l,u,c,!0,s)}e(n,u,c,!0,s)}else e(n,r,o,!0,a)}else e(n)}}(f,l),(c=c||{}).envelope=l),n(i,u,c,f,(function r(l,p){A.shouldLog(A.LOG_MICRO)&&A.logAction(A.LOG_MICRO,"Resource."+t+"()","Sending; "+o(a,p));var e&&z.isTokenErr(e)?i.auth.authorize(null,null,(function(e){e?f(e):n(i,u,c,f,r)})):f(e,t,o,a,s)}];if(s||d.splice(3,1),A.shouldLog(A.LOG_MICRO)){var h=s;if((l["content-type"]||"").indexOf("msgpack")>0)try{h=e.decode(s)}catch(e){A.logAction(A.LOG_MICRO,"Resource."+t+"()","Sending MsgPack Decoding Error: "+v.inspectError(e))}A.logAction(A.LOG_MICRO,"Resource."+t+"()","Sending; "+o(a,p)+"; Body: "+h)}y[t].apply(this,d)}))},t}(),U=function(){function e(e,t,n,r,o,i){this.rest=e,this.path=t,this.headers=n,this.envelope=r,this.bodyHandler=o,this.useHttpPaginatedResponse=i||!1}function t(e,t,n){if(this.resource=e,this.items=t,n){var r=this;"firsr.get(n.first,e)}),"current"in n&&(this.current=function(e){r.get(n.current,ext"in n?r.geNext=function(){return"next"in n},this.isLast=function(){return!this.hasNext()}}}function n(e,n,r,o,i,a){t.call(this,e,n,i),this.statusCode=o,this.success=o<300&&o>=200,this.headers=r,this.errorCode=a&&a.code,this.errorMessage=a&&a.message}return v.arrForEach(y.methodsWithoutBody,(function(t){e.prototype[t]=function(e,n){var r=this;B[t](r.rest,r.path,r.headers,e,r.envelope,(function(e,t,o,i,a){r.handlePage(e,t,o,i,a,n)}))}})),v.arrForEach(y.methodsWithBody,(function(t){e.protoath,n,o.headers,e,o.envelope,(function(e,t,n,i,a){r&&o.haon(e,r,o,i,a,s){if(e&&function(e,t,n){return!(n&&(t||"number"==typeof e.code))}(e,r,this.useHttpPaginatedResponse))return A.logAction(A.LOG_ERROR,"PaginatedResource.handlePage()","Unexpected error getting resource: err = "+v.inspectError(e)),void s(e);var u,c,l;try{u=this.bodyHandler(r,o,i)}catch(t){return void s(e||t)}o&&(c=o.Link||o.link)&&(l=function(e){"string"==typeof e&&(e=e.split(","));for(var t,n,r={},o=0;o<e.length;o++){var i=e[o].match(/^\s*<(.+)>;\s*rel="(\w+)"$/);if(i){var a=(t=i[1],n=void 0,(n=t.match(/^\.\/(\w+)\?(.*)$/))&&v.parseQueryString(n[2]));a&&(r[i[2]]=a)}}return r}(c)),this.useHttpPaginatedResponse?s(null,new n(this,u,o,a,l,e)):s(null,new t(this,u,l))},t.prototype.get,n.path,n.headers,e,n.envelope,(function(e,r,o,i,a){n.handlePage(e,r,o,i,a,n o(){}function i(){return("000000"+Math.floor(1e16*Math.random())).slice(-16)}function a(e){return v.isErrorInfo(e)?(e.code||(403===e.statusCode?e.code=40300:(e.code=40170,e.statusCode=401)),e):new O(v.inspectError(e),e.code||40170,e.statusCode||401)}function u(e){if(!e)return"";"string"==typeof e&&(e=JSON.parse(e));var t={},n=v.keysArray(e,!0);if(!n)return"";n.sort();for(var r=0;r<n.length;r++)t[n[r]]=e[n[r]].sort();return JSON.stringify(t)}function c(e){if(e.authCallback)A.logAction(A.LOG_MINOR,"Auth()","using token auth with authCallback");else if(e.authUrl)A.logAction(A.LOG_MINOR,"Auth()","using token auth with authUrl");else if(e.key)A.logAction(A.LOG_MINOR,"Auth()","using token auth with client-side signing");else{if(!e.tokenDetails){var t="authOptions must include valid authentication parameters";throw A.logAction(A.LOG_ERROR,"Auth()",t),new Error(t)}A.logAction(A.Lonly")}}p.createHmac?(n=function(e){return new t(e,"ascii").toString("base64")},e=function(e,t){var n=p.createHmac("SHA256",t);return n.update(e),n.digest("base64")}):(n=b.encode,e=function(e,t){return s.HmacSHA256(e,t).toString(s.enc.Base64)});var l=0;function f(t,n){if(this.client=t,this.tokenParams=n.defaultTn e&&!e.useTokenAuth}(e)&&(e.authCallback||e.authUrl||e.token||e.tokenDetails)}(n)){if(n.key&&!e){var r="client-side token requestAuth()",r),new Error(r)}(function(e){return!e.key&&!e.authCallback&&!e.authUrl})(n)&&A.logAction(A.LOG_ERROR,"Auth()","Warning: library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),this._saveTokenOptions(n.defaultTokenParams,n),c(this.authOptions)}else{if(!n.key){r="No authentication options provided; need one of: key, authUrl, or authCallback (or for testing only, token or tokenDetails)";throw A.logAction(A.LOG_ERROR,"Auth()",r),new O(r,40160,401)}A.logAction(A.LOG_MINOR,"Auth()","anonymous, using basic auth"),this._saveBasicOptions(n)}}return f.prototype.authorize=function(e,t,n){if("function"!=typeof e||n?"function"!=typeof t||n||(n=t,t=null):(n=e,t=e=null),!n){if(this.client.options.promises)return v.promisify(this,"authorize",arguments);n=o}var r=this;if(t&&t.key&&this.authOptions.key!==t.key)throw new O("Unable to update auth options with incompatible key",40102,401);t&&"force"in t&&(A.logAction(A.LOG_ERROR,"Auth.authorize","Deprecation warning: specifying {force: true} in authOptions is no longer necessary, authorize() now always gets a new token. Please remove this, as in version 1.0 and later, having a non-null authOptions will overwrite stored library authOptions, which may not be what you want"),v.isOnlyPropIn(t,"force")&&(t=null)),this._forceNewToken(e,t,(function(e,t){e?n(e):r.client.connection?r.client.connection.connectionManager.onAuthUpdated(t,n):n(null,t)}))},f.prototype.authorise=function(){A.deprecated("Auth.authorise","Aun(e,t){delete r.tokenParams.timestamp,delete r.authOptions.queryTime,n(e,t)}))},f.prototype.requestToken=function(e,t,n){if("function"!=typeof e||n?"function"!=typeof t||n||(n=t,t=null):(n=e,t=e=null),!n&&this.client.options.promises)return v.promisify(this,"requestToken",arguments);t=t||this.authOptions,e=e||v.copy(this.tokenParams),n=n||o;var i,s=this.client;if(t.authCallback)A.logAction(A.LOG_MINOR,"Auth.requestToken()","using token auth with authCallback"),i=t.authCallback;else if(t.authUrl)A.logAction(A.LOG_MINOR,"Auth.requestToken()","using token auth with authUrl"),i=function(e,n){var o=v.mixin({accept:"application/json, text/plain"},t.authHeaders),i=t.authMethod&&"post"===t.authMethod.toLowerCase();if(!i){var a=t.authUrl.indexOf("?");if(a>-1){var u=v.parseQueryString(t.authUrl.slice(a));t.authUrl=t.authUrl.slice(0,a),t.authParams=v.mixin(u,t.authParams)}}var c=v.mixin({},t.authParams||{},e),l=function(e,t,o,i){var a;if(e?A.logAction(A.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received Error: "+v.inspectError(e)):(a=o["content-type"],A.logAction(A.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received; content-type: "+a+"; body: "+v.inspectBody(t))),e||i)return n(e,t);if(m.isBuffer(t)&&(t=t.toString()),a){var s=a.indexOf("application/json")>-1,u=a.indexOf("text/plain")>-1||a.indexOf("application/jwt")>-1;if(s||u){if(s){if(t.length>r)return void n(new O("authUrl response exceeded max permitted length",40170,401));try{t=JSON.parse(t)}catch(e){return void n(new O("Unexpected error processing authURL response; err = "+e.message,40170,401))}}n(null,t,a)}else n(new O("authUrl responded with unacceptable content-type "+a+", should be either text/plain, application/jwt or application/json",40170,401))}else n(new O("authUrl response is missing a content-type header",40170,401))};if(A.logAction(A.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Requesting token from "+t.authUrl+"; Params: "+JSON.stringify(c)+"; method: "+(i?"POST":"GET")),i){var f=o||{};f["content-type"]="application/x-www-form-urlencoded";var p=v.toQueryString(c).slice(1);y.postUri(s,t.authUrl,f,p,{},l)}else y.getUri(s,t.authUrl,o||{},c,l)};else{if(!t.key){var c="Need a new token, but authOptions does not include any way to request one (no authUrl, authCallback, or key)";return A.logAction(A.LOG_ERROR,"Auth()","library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),void n(new O(c,40171,403))}var l=this;A.logAction(Aen auth with client-side signing"),i=function(e,n){l.createTokenRequest(e,t,n)}}"capability"in e&&(e.capability=u(e.capability));var f=function(e,n){var r="/keys/"+e.keyName+"/requestToken",o=v.defaultPostHeaders();t.requestHeaders&&v.mixin(o,t.requestHeaders),A.logAction(A.LOG_MICRO,"Auth.requestToken().requestToken","Sending .stringify(e)),e=JSON.stringify(e),y.post(s,(function(e){return s.baseUri(e)+r}),o,e,null,n)},p=!1,d=this.client.options.timeouts.realtimeRequestTimeout,h=setTimeout((function(){p=!0;var e="Token request callback timed out after "+d/1e3+" seconds";A.logAction(A.LOG_ERROR,"Auth.requestToken()",e),n(new O(e,40170,401))}),d);i(e,(function(e,o,i){if(!p){if(clearTimeout(h),e)return A.logAction(A.LOG_ERROR,"Auth.requestToken()","token request signing call returned error; err = "+v.inspectError(e)),void n(a(e));if("string"!=typeof o){if("object"!=typeof o){var s="Expected token request callback to call back with a token string or token request/details object, but got a "+typeof o;return A.logAction(A.LOG_ERROR,"Auth.requestToken()",s),void n(new O(s,40170,401))}var u=JSON.stringify(o).length;if(u>r&&!t.suppressMaxLengthCheck)n(new O("Token request/details object exceeded max permitted stringified size (was "+u+" bytes)",40170,401));else if("issued"in o)n(null,o);else{if(!("keyName"in o)){s="Expected token request callback to call back with a token string, token request object, or token details object";return A.logAction(A.LOG_ERROR,"Auth.requestToken()",s),void n(new O(s,40170,401))}f(o,(function(e,t,r,o){if(e)return A.logAction(A.LOG_ERROR,"Auth.requestToken()","token request API call returned error; err = "+v.inspectError(e)),void n(a(e));o||(t=JSON.parse(t)),A.logAction(A.LOG_MINOR,"Auth.getToken()","token received"),n(null,t)}))}}else 0===o.length?n(new O("Token string is empty",40170,401)):o.length>r?n(new O("Token string exceeded max permitted length (was "+o.length+" bytes)",40170,401)):"undefined"===o||"null"===o?n(new O("Token string was literal null/undefined",40170,401)):"{"!==o[0]||i&&i.indexOf("application/jwt")>-1?n(null,{token:o}):n(new O("Token was double-encoded; make sure you're not JSON-encoding an already encoded token request or details",40170,401))}}))},f.prototype.createTokenRequest=function(t,n,r){if("function"!=typeof t||r?"function"!=typeof n||r||(r=n,n=null):(r=t,n=t=null),!r&&this.client.options.promises)return v.promisify(this,"createTokenRequest",arguments);n=n||this.authOptions,t=t||v.copy(this.tokenParams);var o=n.key;if(o){var a=o.split(":"),s=a[0],c=a[1];if(c)if(""!==t.clientId){"capability"in t&&(t.capability=u(t.capability));var l,f=v.mixin({keyName:s},t),p=t.clientId||"",d=t.ttl||"",h=t.capability||"",g=this;l=function(){var t=f.nonce||(f.nonce=i()),n=f.timestamp,o=f.keyName+"\n"+d+"\n"+h+"\n"+p+"\n"+n+"\n"+t+"\n";f.mac=f.mac||e(o,c),A.logAction(A.LOG_MINOR,"Auth.getTokenRequest()","genermp?l():g.getTimestamp(n&&n.queryTime,(function(e,t){e?r(e):(f.timestamp=t,l())}))}else r(new O("clientId can’t be an empty string",40012,400));else r(new O("Invalid key specified",40101,403))}else r(new O("No key specified",40101,403))},f.prototype.getAuthParams=function(e){"basic"==this.method?e(null,{key:this.key}):this._ensureValidAuthCredentials(!1,(function(t,n){t?e(t):e(null,{access_token:n.token})}))},f.prototype.getAuthHeaders=function(e){"basic"==this.method?e(null,{authorization:"Basic "+this.basicKey}):this._ensureValidAuthCredentials(!1,(function(t,r)authOptions.queryTime?t(null,this.geTimestampUsingOffset=functio.prototype.isTimeOffsetSet=fun(e.key),this.authOptions=e||{}enDetails),"clientId"in t&&this._userSetClientId(t.clientId),this.authOptions=t)},f.prototype._ensureValidAuthCredentials=function(e,t){var n=this,r=this.tokenDetails;if(r){if(this._tokenClientIdMismatch(r.clientId))return void t(new O("Mismatch between clientId in token ("+r.clientId+") and current clientId ("+this.clientId+")",40102,403));if(!this.isTimeOffsetSet()||!r.expires||r.expires>=this.getTimestampUsingOffset())return A.logAction(A.LOG_MINOR,"Auth.getToken()","using cached token; expires = "+r.expires),void t(null,r);A.logAction(A.LOG_MINOR,"Auth.getToken()","deleting expired token"),this.tokenDetails=null}if((this.waitingForTokenRequest||(this.waitingForTokenRequest=C())).push(t),null===this.currentTokenRequestId||e){var i=this.currentTokenRequestId=l++;this.requestToken(this.tokenParams,this.authOptions,(function(e,t){if(n.currentTokenRequestId>i)A.logAction(A.LOG_MINOR,"Auth._ensureValidAuthCredentials()","Discarding token request response; overtaken by newer one");else{n.currentTokenRequestId=null;var r=n.waitingForTokenRequest||o;n.waitingForTokenRequest=null,e?r(e):r(null,n.tokenDetails=t)}}))}},f.prototype._userSetClientId=function(e){if("string"!=typeof e&&null!==e)throw new O("clientId must be either a string or null",40012,400);if("*"===e)throw new O('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, instantiate the library with {defaultTokenParams: {clientId: "*"}}), or if calling authorize(), pass it in as a tokenParam: authorize({clientId: "*"}, authOptions)',40012,400);var t=this._uncheckedSetClientId(e);if(t)throw t},f.prototype._uncheckedSetClientId=function(e){if(this._tokenClientIdMismatch(e)){var t="Unexpected clientId mismatch: client has "+this.clientId+", requested "+e,n=new O(t,40102,401);return A.logAction(A.LOG_ERROR,"Auth._uncheckedSetClientId()",t),n}return this.clientId=this.tokenParams.clientId=e,null},f.prototype._tokenClientIdMismatch=function(e){ret.clientId!==e},f.isTokenErr=function(e){return e.code&&e.code>=40140&&e.code<40150},f}(),G=function(){var e=function(){},t=p.msgpack;function n(e){if(!(this instanceof n))return new n(e);if(!e){var t="no options provided";throw A.logAction(A.LOG_ERROR,"Rest()",t),new Error(t)}if((e=g.objectifyOptions(e)).log&&A.setLog(e.log.level,e.log.handler),A.logAction(A.LOG_MICRO,"Rest()","initialized with clientOptions "+v.inspect(e)),this.options=g.normaliseOptions(e),e.key){var o=e.key.match(/^([^:\s]+):([^:.\s]+)$/);if(!o){t="invalid key parameter";throw A.logAction(A.LOG_ERROR,"Rest()",t),new Error(t)}e.keyName=o[1],e.keySecret=o[2]}if("clientId"in e){if("string"!=typeof e.clientId&&null!==e.clientId)throw new O("clientId must be either a string or null",40012,400);if("*"===e.clientId)throw new O('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, use {defaultTokenParams: {clientId: "*"}})',40012,400)}A.logAction(A.LOG_MINOR,"Rest()","started; version = "+g.libstring),this.baseUri=this.authority=function(t){return g.getHttpScheme(e)+t+":"+g.getPort(e,!1)},this._currentFallback=null,this.serverTihannels=new r(this),this.push=new K(this)}function r(e){this.rest=e,this.attached={}}return n.prototype.stats=function(t,n){if(void 0===n)if("function"==typeof t)n=t,t=null;else{if(this.options.promises)return v.promisify(this,"stats",arguments);n=e}var r=v.defaultGetHeaders(),o=this.options.useBinaryProtocol?"msgpack":"json",i=y.supportsLinkHeaders?void 0:o;this.options.headers&&v.mixin(r,this.options.headers),new U(this,"/stats",r,i,(function(e,t,n){for(var r=n?e:JSON.parse(e),o=0;o<r.length;o++)r[o]=T.fromValues(r[o]);return r})).get(t,n)},n.prototype.time=function(t,n){if(void 0===n)if("function"==typeof t)n=t,t=null;else{if(this.options.promises)return v.promisify(this,"time",arguments);n=e}var r=v.dmixin(r,this.options.headers);var o=this,i=function(e){return o.authority(e)+"/time"};y.get(this,i,r,t,(function(e,t,r,i){if(e)n(e);else{i||(t=JSON.parse(t));var a=t[0];if(!a)return(e=new Error("Internal error (unexpected result type from GET /time)")).statusCode=500,void n(e);o.serverTimeOffset=a-v.now(),n(null,a)}}))},n.prototype.request=function(n,r,o,i,a,s){var u=this.options.useBinaryProtocol,c=u?t.encode:JSON.stringify,l=u?t.decode:JSON.parse,f=u?"msgpack":"json",p=y.supportsLinkHeaders?void 0:f;o=o||{};var d="get"==(n=n.toLowerCase())?v.defaultGetHeaders(f):v.defaultPostHeaders(f);if(void 0===s){if(this.options.promises)return v.promisify(this,"request",[n,r,o,i,a]);s=e}"string"!=typeof i&&(i=c(i)),this.opt&v.mixin(d,a);var h=new U(this,r,d,p,(function(e,t,n){return v.ensureArray(n?e:l(e))}),!0);if(!v.arrIn(y.methods,n))throw new O("Unsupported method n)?h[n](o,i,s):h[n](o,s)},n.prototype.setLog=function(e){A.setLog(e.level,e.handler)},r.prototype.get=function(e,t){e=String(e);var n=this.attached[e];retur Y(this.rest,e,t),n},r.prototype.release=function(e){delete this.attached[String(e)]},n}();G.Promise=function(e){return(e=g.objectifyOptions(e)).promises=!0,new G(e)},G.Callbacks=G;var q=function(){function e(n){if(!(this instanceof e))return new e(n);A.logAction(A.LOG_MINOR,"Realtime()",""),G.call(this,n),this.connection=new W(this,this.options),this.channels=new t(this),!1!==n.autoConnect&&this.connect()}function t(e){w.call(this),this.realtime=e,this.all={},this.inProgress={};var t=this;e.connection.connectionManager.on("transport.active",(function(){t.onTransportActive()}))}return v.inherits(e,G),e.prototype.connect=function(){A.logAction(A.LOG_MINOR,"Realtime.connect()",""),this.connection.connect()},e.prototype.close=function(){A.logAction(A.LOG_MINOR,"Realtime.close()",""),this.connection.close()},v.inherits(t,w),t.prototype.onChannelMessage=function(e){var t=e.channel;if(void 0!==t){var n=this.all[t];n?n.onMessage(e):A.logAction(A.LOG_ERROR,"Channels.onChannelMessage()","received event for non-existent channel: "+t)}else A.logAction(A.LOG_ERROR,"Channels.onChannelMessage()","received event unspecified channel, action = "+e.action)},t.prototype.onTransportActive=function(){for(var e in this.all){var t=this.all[e];"attaching"===t.state||"detaching"===t.state?t.checkPendingState():"suspended"===t.state&&t.attach()}},t.prototype.reattach=function(e){for(var t in this.all){var n=this.all[t];"attached"===n.state&&n.requestState("attaching",e)}},t.prototype.resetAttachedMsgIndicators=function(){for(var e in this.all){var t=this.all[e];"attached"===t.state&&(t._attachedMsgIndicator=!1)}},t.prototype.checkAttachedMsgIndicators=function(e){for(var t in this.all){var n=this.all[t];if("attached"===n.state&&!1===n._attachedMsgIndicator){var r="30s after a resume, found channel which has not received an attached; channelId = "+t+"; connectionId = "+e;A.logAction(A.LOG_ERROR,"Channels.checkAttachedMsgIndicators()",r),x.report("error",r,"channel-no-attached-afte[e];for(var o in this.all){var i=this.all[o];v.arrIn(n,i.state)&&i.notifyState(r,t)}},t.prototype.get=function(e,t){e=String(e);var n=this.all[e];retuhis.realtime,e,t),n},t.prototype.release=function(e){this.all[e]&&delete this.all[e]},t.prototype.setInProgress=function(e,t,n){this.inProgress[e.name]=this.inProgress[e.name]||{},this.inProgress[e.name][t]=n,!n&&this.hasNopending()&&this.emit("nopending")},t.prototype.onceNopending=function(e){this.hasNopending()?e():this.once("nopending",e)},t.parrEvery(v.valuesArray(this.inProgress,!0),(function(e){return!v.containsValue(e,!0)}))},e}();q.Promise=ct){this.previous=e,this.current=t,"attached"===t&&(this.resumed=n),r&&(this.reason=r)},W=function(){function e(){}function t(e,t){w.call(this),this.ably=e,this.connectionManager=new F(e,t),this.state=this.connectionManager.state.state,this.key=void 0,this.id=void 0,this.serial=void 0,this.timeSerial=void 0,this.recoveryKey=void 0,this.errorReason=null;var n=this;this.connectionManager.on("connectionstate",(function(e){var t=n.state=enectionManager.on("update",(function(e){v.nextTick((function(){n.emit("update",e)}))}))}return v.inherits(t,w),t.prototype.whenState=function(e,t){w.prototype.whenState.call(this,e,this.state,t,new H(void 0,e))},t.prototype.connect=function(){A.logAction(A.LOG_MINOR,"Connection.connect()",""),this.connectionManager.requestState({state:"connecting"})},t.prototype.ping=function(t){if(A.logAction(A.LOG_MINOR,"Connection.ping()",""),!t){if(this.ably.options.promises)return v.promisify(this,"ping",arguments);t=e}this.connectionManager.ping(null,t)},t.prototype.close=function(){A.logAction(A.LOG_MINOR,"Connection.close()","connectionKey = "+this.key),this.co(e){this.rest=e,this.deviceRegistrations=new n(e),this.channelSubscriptions=new r(e)}function n(e){this.rest=e}function r(e){this.rest=e}return t.prototype.publish=function(t,n,r){var o=this.rest,i=o.options.useBinaryProtocol?"msgpack":"json",a=v.mixin({recipient:t},n),s=v.defaultPostHeaders(i),u={};if("function"!=typeof r){if(this.rest.options.promises)return v.promisify(this,"publish",arguments);r=e}o.options.headers&&v.mixin(s,o.options.headers),o.options.pushFullWait&&v.mixin(u,{fullWait:"true"}),a=v.encodeBody(a,i),B.post(o,"/push/publish",a,s,u,!1,(function(e){r(e)}))},n.prototype.save=function(t,n){var r=this.rest,o=r.options.useBinaryProtocol?"msgpack":"json",i=D.fromValues(t),a=v.defaultPostHeaders(o),s={};if("function"!=typeof n){if(this.rest.options.promises)return v.promisify(this,"save",arguments);n=e}r.options.headers&&v.mixin(a,r.options.headers),r.options.pushFullWait&&v.mixin(s,{fullWait:"true"}),i=v.encodeBody(i,o),B.put(r,"/push/deviceRegistrations/"+encodeURIComponent(t.id),i,a,s,!1,(function(e,t,r,i){n(e,!e&&D.fromResponseBody(t,!i&&o))}))},n.prototype.get=function(t,n){var r=this.rest,o=r.options.useBinaryProtocol?"msgpack":"json",i=v.defaultGetHeaders(o),a=t.id||t;if("function"!=typeof n){if(this.rest.options.promises)return v.promisify(this,"get",arguments);n=e}"string"==typeof a&&a.length?(r.options.headers&&v.mixin(i,r.options.headers),B.get(r,"/push/deviceRegistrations/"+encodeURIComponent(a),i,{},!1,(function(e,t,r,i){n(e,!e&&D.fromResponseBody(t,!i&&o))}))):n(new O("First argument to DeviceRegistrations#get must be a deviceId string or DeviceDetails",4e4,400))},n.prototype.list=function(t,n){var r=this.rest,o=r.options.useBinaryProtocol?"msgpack":"json",i=y.supportsLinkHeaders?void 0:o,a=v.defaultGetHeaders(o);if("function"!=typeof n){if(this.rest.options.promises)return v.promisify(this,"list",arguments);n=e}r.options.headers&&v.mixin(a,r.options.headers),new U(r,"/push/deviceRegistrations",a,i,(function(e,t,n){return D.fromResponseBody(e,!n&&o)})).get(t,n)},n.prototype.remove=function(t,n){var r=this.rest,o=r.options.useBinaryProtocol?"msgpack":"json",i=v.defaultGetHeaders(o),a={},s=t.id||t;if("function"!=typeof n){if(this.rest.options.promises)return v.promisify(this,"remove",arguments);n=e}"string"==typeof s&&s.length?(r.options.headers&&v.mixin(i,r.options.headers),r.options.pushFullWait&&v.mixin(a,{fullWait:"true"}),B.delete(r,"/push/deviceRegistrations/"+encodeURIComponent(s),i,a,!1,(function(e){n(e)}))):n(new O("First argument to DeviceRegistrations#remove must be a deviceId string or DeviceDetails",4e4,400))},n.prototype.removeWhere=function(t,n){var r=this.rest,o=r.options.useBinaryProtocol?"msgpack":"json",i=v.defaultGetHeaders(o);if("function"!=typeof n){if(this.rest.options.promises)return v.promisify(this,"removeWhere",arguments);n=e}r.options.headers&&v.mixin(i,r.options.headers),r.options.pushFullWait&&v.mixin(t,{fullWait:"true"}),B.delete(r,"/push/deviceRegistrations",i,t,!1,(function(e){n(e)}))},r.prototype.save=function(t,n){var r=this.rest,o=r.options.useBinaryProtocol?"msgpack":"json",i=R.fromValues(t),a=v.defaultPostHeaders(o),s={};if("function"!=typeof n){if(this.rest.options.promises)return v.promisify(this,"save",arguments);n=e}r.options.headers&&v.mixin(a,r.options.headers),r.options.pushFullWait&&v.mixin(s,{fullWait:"true"}),i=v.encodeBody(i,o),B.post(r,"/push/channelSubscriptions",i,a,s,!1,(function(e,t,r,i){n(e,!e&&R.fromResponseBody(t,!i&&o))}))},r.prototype.list=function(t,n){var r=this.rest,o=r.options.useBinaryProtocol?"msgpack":"json",i=y.supportsLinkHeaders?void 0:o,a=v.defaultGetHeaders(o);if("function"!=typeof n){if(this.rest.options.promises)return v.promisify(this,"list",arguments);n=e}r.options.headers&&v.mixin(a,r.options.headers),new U(r,"/push/channelSubscriptions",a,i,(function(e,t,n){return R.fromResponseBody(e,!n&&o)})).get(t,n)},r.prototype.removeWhere=function(t,n){var r=this.rest,o=r.options.useBinaryProtocol?"msgpack":"json",i=v.defaultGetHeaders(o);if("function"!=typeof n){if(this.rest.options.promises)return v.promisify(this,"removeWhere",arguments);n=e}r.options.headers&&v.mixin(i,r.options.headers),r.options.pushFullWait&&v.mixin(t,{fullWait:"true"}),B.delete(r,"/push/channelSubscriptions",i,t,!1,(function(e){n(e)}))},r.prototype.remove=r.prototype.removeWhere,r.prototype.listChannels=function(t,n){var r=this.rest,o=r.options.useBinaryProtocol?"msgpack":"json",i=y.supportsLinkHeaders?void 0:o,a=v.defaultGetHeaders(o);if("function"!=typeof n){if(this.rest.options.promises)return v.promisify(this,"listChannels",arguments);n=e}r.options.headers&&v.mixin(a,r.options.headers),r.options.pushFullWait&&v.mixin(t,{fullWait:"true"}),new U(r,"/push/channels",a,i,(function(e,t,n){!n&&o&&(e=)e[r]=String(e[r]);return e})).get(t,n)},function(e){this.rest=e,this.admin=new t(e)}}(),Y=function(){function e(){}function t(e,t,n){A.logAction(A.LOG_MINOR,"Channel()","started; name = "+t),w.call(this),this.rest=e,this.name=t,this.basis),this.setOptions(n)}function n(e){return v.arrEvery(e,(function(e){return!e.id}))}return v.inherits(t,w),t.prototype.setOptions=function(e){if(this.channelOptions=e=e||{},e.cipher){if(!d)throw new Error("Encryption not enabled; use ably.encryption.js instead");var t=d.getCipher(e.cipher);e.cipher=t.cipherParams,e.channelCipher=t.cipher}else"cipher"in e&&(e.cipher=null,e.channelCipher=null)},t.prototype.history=function(t,n){if(A.logAction(A.LOG_MICRO,"Channel.history()","channel = "+this.name),void 0===n)if("function"==typeof t)n=t,t=null;else{if(this.rest.options.promises)return v.promisify(this,"history",arguments);n=e}this._history(t,n)},t.prototype._history=function(e,t){var n=this.rest,r=n.options.useBinaryProtocol?"msgpack":"json",o=y.supportsLinkHeaders?void 0:r,i=v.defaultGetHeaders(r);n.options.headers&&v.mixin(i,n.options.headers);var a=this.channelOptions;new U(n,this.basePath+"/messages",i,o,(function(e,t,n){return S.fromResponseBody(e,a,!n&&r)})).get(e,t)},t.prototype.publish=function(){var t,r,o=arguments.length,i=arguments[0],a=arguments[1],s=arguments[o-1],u=this;if("function"!=typeof s){if(this.rest.options.promises)return v.promisify(this,"publish",arguments);s=e}if("string"==typeof i||null===i)t=[S.fromValues({name:i,data:a})],r=arguments[2];else if(v.isObject(i))t=[S.fromValues(i)],r=arguments[1];else{if(!v.isArray(i))throw new O("The single-argument form of publish() expects a message object or an array of message objects",40013,400);t=S.fromValuesArray(i),r=arguments[1]}"object"==typeof r&&r||(r={});var c=this.rest,l=c.options,f=l.useBinaryProtocol?"msgpack":"json",p=c.options.idempotentRestPublishing,d=v.defaultPostHeaders(f&n(t)){var h=v.randomString(9);v.arrForEach(t,(function(e,t){e.id=h+":"+t.toString()}))}S.encodeArray(t,this.channelOptions,(function(e){if(e)s(e);else{var n=S.getMessagesSize(t),o=l.maxMessageSize;n>o?s(new O("Maximum size of messages that can be published at once exceeded ( was "+n+" bytes; limit is "+o+" bytes)",40009,400)):u._publish(S.serialize(t,f),d,r,s)}}))},t.prototype._publish=function(e,t,n,r){B.post(this.rest,this.basePath+"/messages",e,t,n,!1,r)},t}(),Q=function(){var e=_.Action,t=function(){};function n(e,t,n){A.logAction(A.LOG_MINOR,"RealtimeChannel()","started; name = "+t),Y.call(this,e,t,n),this.realtime=e,this.presence=new $(this,e.options),this.connectionManager=e.connection.connectionManager,this.state="initialized",this.subscriptions=new w,this.syncChannelSerial=void 0,this.properties={attachSerial:void 0},this.setOptions(n),this.errorReason=null,this._requestedFlags=null,this._mode=null,this._attachedMsgIndicator=!1}return v.inherits(n,Y),n.invalidStateError=function(e){return{statusCode:400,code:90001,message:"Channel operation failed as channel state(e=Array.prototype.slice.call(e))[0]&&e.unshift(null),null==e[e.length-1]&&e.pop(),e},n.prototype.publish=function(){var e=arguments.length,n=arguments[0],r=arguments[e-1];if("function"!=typeof r){if(this.realtime.options.promises)return v.promisify(this,"publish",arguments);r=t,++e}if(this.connectionManager.activeState()){if(2==e)if(v.isObject(n))n=[S.fromValues(n)];else{if(!v.isArray(n))throw new O("The single-argument form of publish() expects a message object or an array of message objects",40013,400);n=S.fromValuesArray(n)}else n=[S.fromValues({name:arguments[0],data:arguments[1]})];var o=this,i=this.realtime.options.maxMessageSize;S.encodeArray(n,this.channelOptions,(function(e){if(e)r(e);else{var t=S.getMessagesSize(n);t>i?r(new O("Maximum size of messages that can be published at once exceeded ( was "+t+" bytes; limit is "+i+" bytes)",40009,400)):o._publish(n,r)}}))}else r(this.connectionManager.getError())},n.prototype._publish=function(t,r){A.logAction(A.LOG_MICRO,"RealtimeChannel.publish()","message count = "+t.length);var o=this.state;switch(o){case"failed":case"suspended":r(O.fromValues(n.invalidStateError(o)));break;default:A.logAction(A.LOG_MICRO,"RealtimeChannel.publish()","sending message; channel state is "+o);var i=new _;i.action=e.MESSAGE,i.channel=this.name,i.messages=t,this.sendMessage(i,r)}},n.prototype.onEvent=function(e){A.logAction(A.LOG_MICRO,"RealtimeChannel.onEvent()","received message");for(var t=this.subscriptions,n=0;n<e.length;n++){var r=e[n];t.emit(r.name,r)}},n.prototype.attach=function(e,t){if("function"==typeof e&&(t=e,e=null),!t){if(this.realtime.options.promises)return v.promisify(this,"attach",arguments);t=function(e){e&&A.logAction(A.LOG_MAJOR,"RealtimeChannel.attach()","Channel attach failed: "+e.toString())}}e&&(this._requestedFlags=e);var n=this.connectionManager;if(n.activeState())switch(this.state){case"attached":if(!e){t();break}default:this.requestState("attaching");case"attaching":this.once((function(e){switch(this.event){case"attached":t();break;case"detached":case"suspended":case"failed":t(e.reason||n.getError());break;case"detaching":t(new O("Attach request superseded by a subsequent detach request",9e4,409))}}))}else t(n.getError())},n.prototype.attachImpl=function(){A.logAction(A.LOG_MICRO,"RealtimeChannel.attachImpl()","sending ATTACH message"),this.setInProgress("statechange",!0);var n=_.fromValues({action:e.ATTACH,channel:this.name});this._requestedFlags&&v.arrForEach(this._requestedFlags,(function(e){n.setFlag(e)})),this.sendMessage(n,t)},n.prototype.detach=function(e){if(!e){if(this.realtime.options.promises)return v.promisify(this,"detach",arguments);e=t}var n=this.connectionManager;if(n.activeState())switch(this.state){case"detached":case"failed":e();break;default:this.requestState("detaching");case"detaching":this.once((function(t){switch(this.event){case"detached":e();break;case"attached":case"suspended":case"failed":e(t.reason||n.getError());break;case"attaching":e(new O("Detach request superseded by a subsequent attach request",9e4,409))}}))}else e(n.getError())},n.prototype.detachImpl=function(n){A.logAction(A.LOG_MICRO,"RealtimeChannel.detach()","sending DETACH message"),this.setInProgress("statechange",!0);var r=_.fromValues({action:e.DETACH,channel:this.name});this.sendMessage(r,n||t)},n.prototype.subscribe=function(){var e=n.processListenerArgs(arguments),r=e[0],o=e[1],i=e[2];if(!i){if(this.realtime.options.promises)return v.promisify(this,"subscribe",[r,o]);i=t}if("failed"!==this.state)return this.subscriptions.on(r,o),this.attach(i);i(O.fromValues(n.invalidStateError("failed")))},n.prototype.unsubscribe=function(){var e=n.processListenerArgs(arguments),t=e[0],r=e[1];this.subscriptions.off(t,r)},n.prototype.sync=function(){switch(this.state){case"initialized":case"detaching":case"detached":throw new O("Unable to sync to channel; not attached",4e4)}var t=this.connectionManager;if(!t.activeState())throw t.getError();var n=_.fromValues({action:e.SYNC,channel:this.name});this.syncChanne=function(e,t){this.connectionManager.send(e,this.realtime.options.queueMessages,t)},n.prototype.sendPresence=function(t,n){var r=_.fromValues({action:e.PRESENCE,channel:this.name,presence:v.isArray(t)?k.fromValuesArray(t):[k.fromValues(t)]});this.sendMessage(r,n)},n.prototype.onMessage=function(t){var n,r=!1;switch(t.action){case e.ATTACHED:if(this._attachedMsgIndicator=!0,this.properties.attachSerial=t.channelSerial,this._mode=t.getMode(),"attached"===this.state){var o=t.hasFlag("RESUMED");if(!o||this.channelOptions.updateOnAttached){this.presence.onAttached(t.hasFlag("HAS_PRESENCE"));var i=new V(this.state,this.state,o,t.error);this.emit("update",i)}}else this.notifyState("attached",t.error,t.hasFlag("RESUMED"),t.hasFlag("HAS_PRESENCE"));break;case e.DETACHED:var a=t.error?O.fromValues(t.error):new O("Channel detached",90001,404);"detaching"===this.state?this.notifyState("detached",a):"attaching"===this.state?this.notifyState("suspended",a):this.requestState("attaching",a);break;case e.SYNC:if(r=!0,n=this.syncChannelSerial=t.channelSerial,!t.presence)break;case e.PRESENCE:for(var s=t.presence,u=t.id,c=t.connectionId,l=t.timestamp,f=this.channelOptions,p=0;p<s.length;p++){try{var d=s[p];k.decode(d,f)}catch(e){A.logAction(A.LOG_ERROR,"RealtimeChannel.onMessage()",e.toString())}d.connectionId||(d.connectionId=c),d.timestamp||(d.timestamp=l),d.id||(d.id=u+":"+p)}this.presence.setPresence(s,r,n);break;case e.MESSAGE:var h=t.messages;for(u=t.id,c=t.connectionId,l=t.timestamp,f=this.channelOptions,p=0;p<h.length;p++){try{var g=h[p];S.decode(g,f)}catch(e){A.logAction(A.LOG_MINOR,"RealtimeChannel.onMessage()",e.toString())}g.connectionId||(g.connectionId=c),g.timestamp||(g.timestamp=l),g.id||(g.id=u+":"+p)}this.onEvent(h);break;case e.ERROR:(a=t.error)&&80016==a.code?this.checkPendingState():this.notifyState("failed",O.fromValues(a));break;default:A.logAction(A.LOG_ERROR,"RealtimeChannel.onMessage()","Fatal protocol error: unrecognised action ("+t.action+")"),this.connectionManager.abort(P.unknownChannelErr)}},n.prototype.onAttached=function(){A.logAction(A.LOG_MINOR,"RealtimeChannel.onAttached","activating channel; name = "+this.name)},n.prototype.notifyState=function(e,t,n,r){if(A.logAction(A.LOG_MICRO,"RealtimeChannel.notifyState","name = "+this.name+", current state = "+this.state+", notifying state "+e),this.clearStateTimer(),e!==this.state){this.presence.actOnChannelState(e,r,t),"suspended"===e&&this.connectionManager.state.sendEvents?this.startRetryTimer():this.cancelRetryTimer(),t&&(this.errorReason=t);var o=new V(this.state,e,n,t),i="failed"===e?A.LOG_ERROR:A.LOG_MAJOR;A.logAction(i,'Channel state for channel "'+this.name+'"',e+(t?"; reason: "+t:"")),"attached"===e?(this.onAttached(),this.setInProgress("sync",r),this.setInProgress("statechange",!1)):"detached"!==e&&"failed"!==e&&"suspended"!==e||(this.setInProgress("statechange",!1),this.setInProgress("sync",!1)),this.state=e,this.emit(e,o)}},n.prototype.requestState=function(e,t){A.logAction(A.LOG_MINOR,"RealtimeChannel.requestState","name = "+this.name+", state = "+e),this.notifyState(e,t),this.checkPendingState()},n.prototype.checkPendingState=function(){var e=this.connectionManager.state;if(e.sendEvents||e.forceQueueEvents)switch(A.logAction(A.LOG_MINOR,"RealtimeChannel.checkPendingState","name = "+this.name+", state = "+this.state),this.state){case"attaching":this.startStateTimerIfNotRunning(),this.attachImpl();break;case"detaching":this.startStateTimerIfNotRunning(),this.detachImpl();break;case"attached":this.sync()}else A.logAction(A.LOG_MINOR,"RealtimeChannel.checkPendingState","sendEvents is false; state is "+this.connectionManager.state.state)},n.prototype.timeoutPendingState=function(){switch(this.state){case"attaching":var e=new O("Channel attach timed out",90007,408);this.notifyState("suspended",e);break;case"detaching":e=new O("Channel detach timed out",90007,408);this.notifyState("attached",e);break;default:this.checkPendingState()}},n.prototype.startStateTimerIfNotRunning=function(){var e=this;this.stateTimer||(this.stateTimer=setTimeout((function(){A.logAction(A.LOG_MINOR,"RealtimeChannel.startStateTimerIfNotRunning","timer expired"),e.stateTimer=null,e.timeoutPendingState()})tateTimer=function(){var e=this.stateTimer;e&&(clearTimeout(e),this.stateTimer=null)},n.prototype.startRetryTimer=function(){var e=this;this.retryTimer||(this.retryTimer=setTimeout((function(){"suspended"===e.state&&e.connectionManager.state.sendEvents&&(e.retryTimer=null,A.logAction(A.LOG_MINOR,"RealtimeChannel retry timer expired","attempting a new attach"),e.requestState("attaching"))r=function(){this.retryTim},n.prototype.setInProgress=function(e,t){this.rest.channels.setInProgress(this,e,t)},n.prototype.history=function(e,n){if(A.logAction(A.LOG_MICRO,"RealtimeChannel.history()","channel = "+this.name),void 0===n)if("function"==typeof e)n=e,e=null;else{if(this.rest.options.promises)return v.promisify(this,"history",arguments);n=t}if(e&&e.untilAttach){if("attached"!==this.state)return void n(new O("option untilAttach requires the channel to be attached",4e4,400));if(!this.properties.attachSerial)return void n(new O("untilAttach was specified and channel is attached, but attachSerial is not defined",4e4,400));delete e.untilAttach,e.from_serial=this.properties.attachSerial}Y.prototype._history.call(this,e,n)},n.prototype.whenState=function(e,t){el.realtime,n=t.auth.clientId;return(!n||"*"===n)&&"connected"===t.connection.state}function r(e,t,n){switch(e.state){case"attached":case"suspended"zed":case"detached":case"detaching":case"attaching":e.attach((function(e){e?t(e):n()}));break;default:t(O.fromValues(Q.invalidStateError(e.state)))}}function o(e,t){j.call(this,e),this.syncComplete=!1,this.members=new i(this),this._myMembers=new i(this),this.subscriptions=new w,this.pendingPresence=[]}function i(e){w.cat.parseId();return n.msgSerial===r.msgSerial?n.index>r.index:n.msgSerial>r.msgSerial}return v.inherits(o,j),o.prototype.enter=function(e,t){if(n(this))throw new O("clientId must be specified to enter a presence channel",40012,400);return this._enterOrUpdateClient(void 0,e,"enter",t)},o.prototype.update=function(e,t){if(n(this))throw new O("clientId must be specified to update presence data",40012,400);return this._enterOrUpdateClient(void 0,e,"update",t)},o.prototype.enterClient=functotype.updateClient=function(e,t,n){return this._enterOrUpdateClient(e,t,"update",n)},o.prototype._enterOrUpdateClient=function(t,n,r,o){if(!o)if("function"==typeof n)o=n,n=null;else{if(this.channel.realtime.options.promises)return v.promisify(this,"_enterOrUpdateClient",[t,n,r]);o=e}var i=this.channel;if(i.connectionManager.activeState()){A.logAction(A.LOG_MICRO,"RealtimePresence."+r+"Client()","channel = "+i.name+", client = "+(t||"(implicit) "+this.channel.realtime.auth.clientId));var a=k.fromValues({action:r,data:n});t&&(a.clientId=t);var s=this;k.encode(a,i.channelOptions,(function(e){if(e)o(e);else switch(i.state){case"attached":i.sendPresence(a,o);break;case"initialized":case"detached":i.attach();case"attaching":s.pendingPresence.push({presence:a,callback:o});break;default:(e=new O("Unable to "+r+" presence channel (incompatible state)",90001)).code=90001,o(e)}}))}else o(i.connectionManager.getError())},o.prototype.leave=function(e,t){if(n(this))throw new O("clientId must have been specified to enter or leave a presence channel",40012,400);return this.leaveClient(void 0,e,t)},o.prototype.leaveClient=function(t,n,r){if(!r)if("function"==typeof n)r=n,n=null;else{if(this.channel.realtime.options.promises)return v.promisify(this,"leaveClient",[t,n]);r=e}var o=this.channel;if(o.connectionManager.activeState()){A.logAction(A.LOG_MICRO,"RealtimePresence.leaveClient()","leaving; channel = "+this.channel.name+", client = "+t);var i=k.fromValues({action:"leave",data:n});switch(t&&(i.clientId=t),o.state){case"attached":o.sendPresence(i,r);break;case"attaching":this.pendingPresence.push({presence:i,callback:r});break;case"initialized":case"failed":r(new O("Unable to leave presence channel (incompatible state)",90001));break;default:r(P.failed)}}else r(o.connectionManager.getError())},o.prototype.get=function(){var t=Array.prototype.slice.call(arguments);1==t.length&&"function"==typeof t[0]&&t.unshift(null);var n=t[0],o=t[1],i=!n||!("waitForSync"in n)||n.waitForSync;es)return v.promisify(this,"get",t);o=e}function a(e){o(null,n?e.s;r(this.channel,o,(function(){var e=s.members;i?e.waitSync((function(){a(e)})):a(e)}))}else i?o(O.fromValues({statusCode:400,code:91005,message:"Presence state is out of sync due to channel being in the SUSPENDED state"})):a(this.members)},o.prototype.history=function(t,n){if(A.logAction(A.LOG_MICRO,"RealtimePresence.history()","channel = "+this.name),void 0===n)if("function"==typeof t)n=t,t=null;else{if(this.channel.realtime.options.promises)return v.promisify(this,"history",arguments);n=e}t&&t.untilAttach&&("attached"===this.channel.state?(delete t.untilAttach,t.from_serial=this.channel.properties.attachSerial):n(new O("option untilAttach requires the channel to be attached, was: "+this.channel.state,4e4,400))),j.prototype._history.call(this,t,n)},o.prototype.setPresence=function(e,t,n){A.logAction(A.LOG_MICRO,"RealtimePresence.setPresence()","received presence for "+e.length+" participants; syncChannelSerial = "+n);var r,o,i=this.members,a=this._myMembers,s=[],u=this.channel.connectionManager.connectionId;t&&(this.members.startSync(),n&&(o=n.match(/^[\w\-]+:(.*)$/))&&(r=o[1]));for(var c=0;c<e.length;c++){switch((l=k.fromValues(e[c])).action){case"leave":i.remove(l)&&s.push(l),l.connectionId!==u||l.isSynthesized()||a.remove(l);break;case"enter":case"present":case"update":i.put(l)&&s.push(l),l.connectionId===u&&a.put(l)}}t&&!r&&(i.endSync(),this._ensureMyMembersPresent(),this.channel.setInProgress(Q.progressOps.sync,!1),this.channel.syncChannelSerial=null);for(c=0;c<s.length;c++){var l=s[c];this.subscriptions.emit(l.action,l)}},o.prototype.onAttached=function(e){A.logAction(A.LOG_MINOR,"RealtimePresence.onAttached()","channel = "+this.channel.name+", hasPresence = "+e),e?this.members.startSync():(this._synthesizeLeaves(this.members.values()),this.members.clear(),this._ensureMyMembersPresent());var t=this.pendingPresence,n=t.length;if(n){this.pendingPresence=[];var r=[],o=C();A.logAction(A.LOG_MICRO,"RealtimePresence.onAttached","sending "+n+" queued presence messages");for(var i=0;i<n;i++){var a=t[i];r.push(a.presen._clearMyMembers(),this.members.clear();case"suspended":this.failPendingPresence(n)}},o.prototype.failPendingPresence=function(e){if(this.pendingPresence.length){A.logAction(A.LOG_MINOR,"RealtimeChannel.failPendingPresence","channel; name = "+this.channel.name+", err = "+v.inspectError(e));for(var t=0;t<this.pendingPresence.length;t++)try{this.pendingPresence[t].callback(e)}catch(e){}this.pendingPresence=[]}},o.prototype._clearMyMembers=function(){this._myMembers.clear()},o.prototype._ensureMyMembersPresent=function(){var e=this,t=this.members,n=this._myMembers,r=function(t){if(t){var n="Presence auto-re-enter failed: "+t.toString(),r=new O(n,91004,400);A.logAction(A.LOG_ERROR,"RealtimePresence._ensureMyMembersPresent()",n);var o=new V(e.channel.state,e.channel.state,!0,r);e.channel.emit("update",o)}};for(var o in n.map)if(!(o in t.map)){var i=n.map[o];A.logAction(A.LOG_MICRO,"RealtimePresence._ensureMyMembersPresent()",'Auto-reentering clientId "'+i.clientId+'" into the presence set'),this._enterOrUpdateClient(i.clientId,i.data,"enter",r),delete n.map[o]}},o.prototype._synthesizeLeaves=function(e){var t=this.subscriptions;v.arrForEach(e,(function(e){var n=k.fromValues({action:"leave",connectionId:e.connectionId,clientId:e.clientId,data:e.data,encoding:e.encoding,timestamp:v.now()});t.emit("leave",n)}))},o.prototype.on=function(){A.deprecated("preecated("presence.off","presence.unsubscribe"),this.unsubscribe.apply(this,arguments)},o.prototype.subscribe=function(){var t=Q.processListenerArgs(arguments),n=t[0],r=t[1],o=t[2],i=this.channel;if(!o){if(this.channel.realtime.options.promises)return v.promisify(this,"subscribe",[n,r]);o=e}"failed"!==i.state?(this.subscriptions.on(n,r),i.attach(o)):o(O.fromValues(Q.invalidStateError("failed")))},o.prototype.unsubscribe=function(){var e=Q.processListenerArgs(arguments),t=e[0],n=e[1];this.subscriptions.off(t,n)},=[];for(var r in i];"absent"!==a.action&&(n&&n!=a.clientId||r&&r!=a.connectionId||o.push(a))}return o},i.prototype.put=function(e){"enter"!==e.action&&"update"!==e.action||((e=k.fromValues(e)).action="present");var n=this.map,r=t(e);this.residualMembers&&delete thar e=this.map,t=[];for(var n in e){var r=e[n];"absent"!=r.action&&t.push(r)}return t},i.prototype.remove=function(e){var n=this.map,r=t(e),o=n[r];return!(o&&!a(e,o))&&(this.syncInProgress?((e=k.fromValues(e)).action="absent",n[r]=e):delete n[r],!0)},i.prototype.startSync=function(){var e=this.map,t=this.syncInProgress;A.logAction(A.LOG_MINOR,"PresenceMap.startSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+t),this.syncInProgress||(this.residualMembers=v.copy(e),this.setInProgress(!0))},i.prototype.endSync=function(){var e=this.map,t=this.syncInProgress;if(A.logAction(A.LOG_MINOR,"PresenceMap.endSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+t),t){for(var n in e){"absent"===e[n].action&&delete e[n]}for(var n in this.presence._synthesizeLeaves(v.valuesArray(this.residualMembers)),this.residualMembers)delete e[n];this.residualMembers=null,this.setInProgress(!1)}this.emit("sync")},i.prototype.waitSync=function(e){var t=this.syncInProgress;A.logAction(A.LOG_MINOR,"PresenceMap.waitSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+t),t?this.once("sync",e):e()},i.prototype.clear=function(e){this.map={},this.setInProgress(!1),this.residualMembers=null},i.prototype.setInProgress=function(e){A.logAction(A.LOG_MICRO,"PresenceMap.setInProgress()","inProgress = "+e),this.syncInProgress=e,this.presence.syncComplete(e=(t=navigator.userAgent.toString().match(/MSIE\s([\d.]+)/))&&Number(t[1]))&&10===e}function i(e,r,i,a,s,u,c){w.call(this),(i=i||{}).rnd=v.cheapRandStr(),o()&&!i.envelope&&(i.envelope="json"),this.uri=e+v.toQueryString(i),this.headers=r||{},this.body=a,this.method=c?c.toUpperCase():v.isEmptyArg(a)?"GET":"POST",this.requestMode=s,this.timeouts=u,this.timedOut=!1,this.requestComplete=!1,n[this.id=String(++t)]=this}v.inherits(i,w);var s=i.createRequest=function(e,t,n,r,o,mplete=!0,!e&&t&&this.emit("data",t),this.emit("complete",e,t,n,r,o),this.dispose())},i.prototype.abort=function(){this.dispose()},i.prototype.exec=function(){var e=0==this.requestMode?this.eouts.recvTimeout,t=this,n=this.timer=setTimeout((function(){t.timedOut=!0,a.abort()}),e),r=this.body,o=this.method,i=this.headers,a=this.xhr=new XMLHttpRequest,s=i.accept,u="text";(s?0===s.indexOf("application/x-msgpack")&&(u="arraybuffer"):i.accept="application/json",r)&&((i["content-type"]||(i["content-type"]="application/json")).indexOf("application/json")>-1&&"string"!=typeof r&&(r=JSON.stringify(r)));for(var c in a.open(o,this.uri,!0),a.responseType=u,"authorization"in i&&(a.withCredentials=!0),i)a.setRequestHeader(c,i[c]);var l=function(e,n,r,o){var i=n+" (event type: "+e.type+")"+(t.xhr.statusText?", current statusText is "+t.xhr.statusText:"");A.logAction(A.LOG_ERROR,"Request.on"+e.type+"()",i),t.compleaborted due uest cancelled",null,400)},a.ontimeout=function(n b(){try{var e,n,r=function(e,t){return e.getResponseHeader&&e.getResponseHeader(t)}(a,"content-type");(r?r.indexOf("application/json")>=0:"text"==a.responseType)?((n="arraybuffer"===a.responseType?m.utf8Decode(a.response):String(a.responseText)).length&&(n=JSON.parse(n)),y=!0):n=a.response,void 0!==n.response?(p=n.statusCode,h=p<400,e=n.headers,n=n.response):e=function(e){for(var t=v.trim(e.getAllResponseHeaders()).split("\r\n"),n={},r=0;r<t.length;r++){var o=v.arrMap(t[r].split(":"),v.trim);n[o[0].toLowerCase()]=o[1]}return n}(a)}catch(e){return void t.complete(new O("Malformed response body from server: "+e.message,null,400))}if(h||v.isArray(n))t.complete(null,n,e,y,p);else{var o=n.error;o||(o=new O("Error response received from server: "+p+" body was: "+v.inspect(n),null,p)),t.complete(o,n,e,y,p)}}function E(){for(var e,t,n=(d=a.responseText).length-1;g<n&&(e=d.indexOf("\n",g))>-1;)t=d.slice(g,e),g=e+1,w(t)}function w(e){try{e=JSON.parse(e)}catch(e){return void t.complete(new O("Malformed response body from server: "+e.message,null,400))}t.emit("data",e)}a.onreadystatechange=function(){var e=a.readyState;e<3||0!==a.status&&(void 0===p&&(e.getResponseHeader("transfer-encoding")||!e.getResponseHeader("content-length"))}(a):t.complete(null,null,null,null,p)),3==e&&f?E():4==e&&(f?(E(),t.streamComp&(clearTimeout(r),this.timer=null),this.requestComplete||t&&("object"==typeof u&&u.addUnloadListener((function(){for(var e in n)n[e].dispose()})),void 0!==y&&(y.supportsAuthHeaders=!0,y.Request=function(e,t,n,r,o,i,a){var u=s(n,r,o,i,0,t&&t.options.timeouts,e);return u.once("complete",a),u.exec(),u},y.checkConnectivity=function(e){var t=g.internetUpUrl;A.logAction(A.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Sending; "+t),y.getUri(null,t,null,null,(function(t,n){var r=!t&&"yes"==n.replace(/\n/,"");A.logAction(A.LOG_MICRO,i}();(function(){function e(e),e.isAvailable=function(){return p.xhrSupported&&p.streamingSupported&&p.allowComet},e.tryConnect=function(t,n,r,o){var i=new e(t,n,r),a=function(e){o({event:this.event,error:e})};i.on(["failed","disconnected"],a),i.on("preconnect",(function(){A.logAction(A.LOG_MINOR,"XHRStreamingTransport.tryConnect()","viable transport "+i),i.off(["failed","disconnected"],a),o(null,i)})),i.connect()},e.prototype.toString=function(){return"XHRStreamingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},e.prototype.createRequest=function(e,t,n,r,o){return J.createRequest(e,t,n,r,o,this.timeouts)},void 0!==F&&e.isAvailable()&&(F.supportedTransports.xhr_streaming=e)})(),function(){function e(e,t,n){n.stream=!1,I.call(this,e,t,n),this.shortName="xhr_polling"}v.inherits(e,I),e.isAvailable=function(){return p.xhrSupported&&p.allowComet},e.tryConnect=function(t,n,r,o){var i=new e(t,n,r),a=function(e){o({event:this.event,error:e})};i.on(["failed","disconnected"],a),i.on("preconnect",(function(){A.logAction(A.LOG_MINOR,"XHRPollingTransport.tryConnect()","viable transport "+i),i.off(["failed","disconnected"],a),o(null,i)})),i.connect()},e.prototype.toString=function(){return"XHRPollingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},e.prototype.createRequest=function(e,t,n,r,o){return J.createRequest(e,t,n,r,o,this.timeouts)},void 0!==F&&e.isAvailable()&&(F.supportunction(){var e=function(){},t=a._ablyjs_jsonp={};t._=function(n){return t["_"+n]||e};var n=1,r=null;function o(e,t,nsonp"}v.inherits(o,I),o.isAvailable=function(){return p.jsonpSupported&&p.allowComet},o.isAvailable()&&(F.supportedTransports.jsonp=o),p.jsonpSupported&&(r=document.getElementsByTagName("head")[0]);var i=null;a.JSONPTransport=o,o.tryConnect=function(e,t,n,r){var i=new o(e,t,n),a=function(e){r({event:this.event,error:e})};i.on(["failed","disconnected"],a),i.on("preconnect",(function(){A.logAction(A.LOG_MINOR,"JSONPTransport.tryConnect()","viable transport "nction(){return"JSONPTransport; uri="+this.baseUri+"; isConnected="+this.isConnected};var s=o.prototype.createRequest=function(e,t,n,r,o,i,a){return i=this&&this.timeouts||i||g.TIMEOUTS,new u(void 0,e,t,v.copy(n),r,o,i,a)};function u(e,t,r,o,i,a,s,u){w.call(this),void 0===e&&(e=n++),this.id=e,this.uri=t,this.params=o||{},this.params.rnd=v.cheapRandStr(),r&&(r["X-Ably-Version"]&&(this.params.v=r["X-Ably-Version"]),r["X-Ably-Lib"]&&(this.params.lib=r["X-Ably-Lib"])),this.body=i,this.method=u,this.requestMode=a,this.timeouts=s,this.requestComplete=!1}v.inherits(u,w),u.prototype.exec=function(){var e=this.id,n=this.body,o=this.method,i=this.uri,a=this.params,s=this;a.callback="_ablyjs_jsonp._("+e+")",a.envelope="jsonp",n&&(a.body=n),o&&"get"!==o&&(a.method=o);var u=this.script=document.createElement("script"),c=i+v.toQueryString(a);u.src=c,u.src.split("/").slice(-1)[0]!==c.split("/").slice(-1)[0]&&A.logAction(A.LOG_ERROR,"JSONP Request.exec()","Warning: the browser appears to have truncated the script URI. This will likely result in the request failing due to an unparseable body param"),u.async=!0,u.type="text/javascript",u.charset="UTF-8",u.onerror=function(e){s.complete(new O("JSONP script error (event: "+v.inspect(e)+")",null,400))},t["_"+e]=function(e){if(e.statusCode){var t=e.response;if(204==e.statusCode)s.complete(null,null,null,e.statusCode);else if(t)if(e.statusCode<400||v.isArray(t))s.complete(null,t,e.headers,e.statusCode);else{var n=t.error||new O("Error response received from server",null,e.statusCode);s.complete(n)}else s.complete(new O("Invalid server response: no envelope detected",null,500))}else s.complete(null,e)};var l=this.requestMode==I.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout;this.timer=setTimeout((function(){s.abort()}),l),r.insertBefore(u,r.firstChild)},u.prototype.complete=function(e,t,n,r){var o;(n=n||{},this.requestComplete)||(this.requestComplete=!0,t&&(o="string"==typeof t?"text/plain":"application/json",n["content-type"]=o,this.emit("data",t)),this.emit("complete",e,t,n,!0pt;n.parentNode&&n.parentNode.removeChild(n),delete t[this.id],this.emit("disposed")},p.jsonpSupported&&!y.Request&&(y.Request=function(e,t,n,r,o,i,a){var u=s(n,r,o,i,I.REQ_SEND,t&&t.options.timeouts,e);return u.once("complete",a),v.nextTick((function(){u.exec()})),u},y.checkConnectivity=function(e){var t=g.jsonpInternetUpUrl;if(i)i.push(e);else{i=[e],A.logAction(A.LOG_MICRO,"(JSONP)Http.checkConnectivity()","Sending; "+t);var n=new u("isTheInternetUp",t,null,null,null,I.REQ_SEND,g.TIMEOUTS);n.once("complete",(function(e,t){var n=!e&&t;A.logAction(A.LOG_MICRO,"(JSONP)Http.checkConnecn);for(var r=0;r<i.length;r++)i[r](null,n);i=null})),v.nextTick((function(){n.exec()}))}})}();i.msgpack=c,i.Rest=G,i.Realtime=q,q.ConnectionManager=F,q.BufferUtils=G.BufferUtils=m,void 0!==d&&(q.Crypto=G.Crypto=d),q.Defaults=G.Defaults=g,q.Http=G.Http=y,q.Utils=G.Utils=v,q.Http=G.Http=y,q.Message=G.Message=S,q.PresenceMessage=G.PresenceMessage=k,q.ProtocolMessagn=e._reactInternalFiber)throw Error(a(38));return){"use strict";e.exports=function(e){return"object"==typeof e&&!0===e.isAxiosError}},function(e,t){e.exports=/[^A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AD\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC0-9\xB2\xB3\xB9\xBC-\xBE\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u09F4-\u09F9\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0B72-\u0B77\u0BE6-\u0BF2\u0C66-\u0C6F\u0C78-\u0C7E\u0CE6-\u0CEF\u0D66-\u0D75\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F33\u1040-\u1049\u1090-\u1099\u1369-\u137C\u16EE-\u16F0\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1946-\u194F\u19D0-\u19DA\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\u2070\u2074-\u2079\u2080-\u2089\u2150-\u2182\u2185-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2CFD\u3007\u3021-\u3029\u3038-\u303A\u3192-\u3195\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\uA620-\uA629\uA6E6-\uA6EF\uA830-\uA835\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19]+/g},function(e,t){e.exports=/([a-z\xB5\xDF-\xF6\xF8-\xFF\u0101\u0103\u0105\u0107\u0109\u010B\u010D\u010F\u0111\u0113\u0115\u0117\u0119\u011B\u011D\u011F\u0121\u0123\u0125\u0127\u0129\u012B\u012D\u012F\u0131\u0133\u0135\u0137\u0138\u013A\u013C\u013E\u0140\u0142\u0144\u0146\u0148\u0149\u014B\u014D\u014F\u0151\u0153\u0155\u0157\u0159\u015B\u015D\u015F\u0161\u0163\u0165\u0167\u0169\u016B\u016D\u016F\u0171\u0173\u0175\u0177\u017A\u017C\u017E-\u0180\u0183\u0185\u0188\u018C\u018D\u0192\u0195\u0199-\u019B\u019E\u01A1\u01A3\u01A5\u01A8\u01AA\u01AB\u01AD\u01B0\u01B4\u01B6\u01B9\u01BA\u01BD-\u01BF\u01C6\u01C9\u01CC\u01CE\u01D0\u01D2\u01D4\u01D6\u01D8\u01DA\u01DC\u01DD\u01DF\u01E1\u01E3\u01E5\u01E7\u01E9\u01EB\u01ED\u01EF\u01F0\u01F3\u01F5\u01F9\u01FB\u01FD\u01FF\u0201\u0203\u0205\u0207\u0209\u020B\u020D\u020F\u0211\u0213\u0215\u0217\u0219\u021B\u021D\u021F\u0221\u0223\u0225\u0227\u0229\u022B\u022D\u022F\u0231\u0233-\u0239\u023C\u023F\u0240\u0242\u0247\u0249\u024B\u024D\u024F-\u0293\u0295-\u02AF\u0371\u0373\u0377\u037B-\u037D\u0390\u03AC-\u03CE\u03D0\u03D1\u03D5-\u03D7\u03D9\u03DB\u03DD\u03DF\u03E1\u03E3\u03E5\u03E7\u03E9\u03EB\u03ED\u03EF-\u03F3\u03F5\u03F8\u03FB\u03FC\u0430-\u045F\u0461\u0463\u0465\u0467\u0469\u046B\u046D\u046F\u0471\u0473\u0475\u0477\u0479\u047B\u047D\u047F\u0481\u048B\u048D\u048F\u0491\u0493\u0495\u0497\u0499\u049B\u049D\u049F\u04A1\u04A3\u04A5\u04A7\u04A9\u04AB\u04AD\u04AF\u04B1\u04B3\u04B5\u04B7\u04B9\u04BB\u04BD\u04BF\u04C2\u04C4\u04C6\u04C8\u04CA\u04CC\u04CE\u04CF\u04D1\u04D3\u04D5\u04D7\u04D9\u04DB\u04DD\u04DF\u04E1\u04E3\u04E5\u04E7\u04E9\u04EB\u04ED\u04EF\u04F1\u04F3\u04F5\u04F7\u04F9\u04FB\u04FD\u04FF\u0501\u0503\u0505\u0507\u0509\u050B\u050D\u050F\u0511\u0513\u0515\u0517\u0519\u051B\u051D\u051F\u0521\u0523\u0525\u0527\u0529\u052B\u052D\u052F\u0561-\u0587\u13F8-\u13FD\u1D00-\u1D2B\u1D6B-\u1D77\u1D79-\u1D9A\u1E01\u1E03\u1E05\u1E07\u1E09\u1E0B\u1E0D\u1E0F\u1E11\u1E13\u1E15\u1E17\u1E19\u1E1B\u1E1D\u1E1F\u1E21\u1E23\u1E25\u1E27\u1E29\u1E2B\u1E2D\u1E2F\u1E31\u1E33\u1E35\u1E37\u1E39\u1E3B\u1E3D\u1E3F\u1E41\u1E43\u1E45\u1E47\u1E49\u1E4B\u1E4D\u1E4F\u1E51\u1E53\u1E55\u1E57\u1E59\u1E5B\u1E5D\u1E5F\u1E61\u1E63\u1E65\u1E67\u1E69\u1E6B\u1E6D\u1E6F\u1E71\u1E73\u1E75\u1E77\u1E79\u1E7B\u1E7D\u1E7F\u1E81\u1E83\u1E85\u1E87\u1E89\u1E8B\u1E8D\u1E8F\u1E91\u1E93\u1E95-\u1E9D\u1E9F\u1EA1\u1EA3\u1EA5\u1EA7\u1EA9\u1EAB\u1EAD\u1EAF\u1EB1\u1EB3\u1EB5\u1EB7\u1EB9\u1EBB\u1EBD\u1EBF\u1EC1\u1EC3\u1EC5\u1EC7\u1EC9\u1ECB\u1ECD\u1ECF\u1ED1\u1ED3\u1ED5\u1ED7\u1ED9\u1EDB\u1EDD\u1EDF\u1EE1\u1EE3\u1EE5\u1EE7\u1EE9\u1EEB\u1EED\u1EEF\u1EF1\u1EF3\u1EF5\u1EF7\u1EF9\u1EFB\u1EFD\u1EFF-\u1F07\u1F10-\u1F15\u1F20-\u1F27\u1F30-\u1F37\u1F40-\u1F45\u1F50-\u1F57\u1F60-\u1F67\u1F70-\u1F7D\u1F80-\u1F87\u1F90-\u1F97\u1FA0-\u1FA7\u1FB0-\u1FB4\u1FB6\u1FB7\u1FBE\u1FC2-\u1FC4\u1FC6\u1FC7\u1FD0-\u1FD3\u1FD6\u1FD7\u1FE0-\u1FE7\u1FF2-\u1FF4\u1FF6\u1FF7\u210A\u210E\u210F\u2113\u212F\u2134\u2139\u213C\u213D\u2146-\u2149\u214E\u2184\u2C30-\u2C5E\u2C61\u2C65\u2C66\u2C68\u2C6A\u2C6C\u2C71\u2C73\u2C74\u2C76-\u2C7B\u2C81\u2C83\u2C85\u2C87\u2C89\u2C8B\u2C8D\u2C8F\u2C91\u2C93\u2C95\u2C97\u2C99\u2C9B\u2C9D\u2C9F\u2CA1\u2CA3\u2CA5\u2CA7\u2CA9\u2CAB\u2CAD\u2CAF\u2CB1\u2CB3\u2CB5\u2CB7\u2CB9\u2CBB\u2CBD\u2CBF\u2CC1\u2CC3\u2CC5\u2CC7\u2CC9\u2CCB\u2CCD\u2CCF\u2CD1\u2CD3\u2CD5\u2CD7\u2CD9\u2CDB\u2CDD\u2CDF\u2CE1\u2CE3\u2CE4\u2CEC\u2CEE\u2CF3\u2D00-\u2D25\u2D27\u2D2D\uA641\uA643\uA645\uA647\uA649\uA64B\uA64D\uA64F\uA651\uA653\uA655\uA657\uA659\uA65B\uA65D\uA65F\uA661\uA663\uA665\uA667\uA669\uA66B\uA66D\uA681\uA683\uA685\uA687\uA689\uA68B\uA68D\uA68F\uA691\uA693\uA695\uA697\uA699\uA69B\uA723\uA725\uA727\uA729\uA72B\uA72D\uA72F-\uA731\uA733\uA735\uA737\uA739\uA73B\uA73D\uA73F\uA741\uA743\uA745\uA747\uA749\uA74B\uA74D\uA74F\uA751\uA753\uA755\uA757\uA759\uA75B\uA75D\uA75F\uA761\uA763\uA765\uA767\uA769\uA76B\uA76D\uA76F\uA771-\uA778\uA77A\uA77C\uA77F\uA781\uA783\uA785\uA787\uA78C\uA78E\uA791\uA793-\uA795\uA797\uA799\uA79B\uA79D\uA79F\uA7A1\uA7A3\uA7A5\uA7A7\uA7A9\uA7B5\uA7B7\uA7FA\uAB30-\uAB5A\uAB60-\uAB65\uAB70-\uABBF\uFB00-\uFB06\uFB13-\uFB17\uFF41-\uFF5A0-9\xB2\xB3\xB9\xBC-\xBE\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u09F4-\u09F9\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0B72-\u0B77\u0BE6-\u0BF2\u0C66-\u0C6F\u0C78-\u0C7E\u0CE6-\u0CEF\u0D66-\u0D75\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F33\u1040-\u1049\u1090-\u1099\u1369-\u137C\u16EE-\u16F0\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1946-\u194F\u19D0-\u19DA\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\u2070\u2074-\u2079\u2080-\u2089\u2150-\u2182\u2185-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2CFD\u3007\u3021-\u3029\u3038-\u303A\u3192-\u3195\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\uA620-\uA629\uA6E6-\uA6EF\uA830-\uA835\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19])([A-Z\xC0-\xD6\xD8-\xDE\u0100\u0102\u0104\u0106\u0108\u010A\u010C\u010E\u0110\u0112\u0114\u0116\u0118\u011A\u011C\u011E\u0120\u0122\u0124\u0126\u0128\u012A\u012C\u012E\u0130\u0132\u0134\u0136\u0139\u013B\u013D\u013F\u0141\u0143\u0145\u0147\u014A\u014C\u014E\u0150\u0152\u0154\u0156\u0158\u015A\u015C\u015E\u0160\u0162\u0164\u0166\u0168\u016A\u016C\u016E\u0170\u0172\u0174\u0176\u0178\u0179\u017B\u017D\u0181\u0182\u0184\u0186\u0187\u0189-\u018B\u018E-\u0191\u0193\u0194\u0196-\u0198\u019C\u019D\u019F\u01A0\u01A2\u01A4\u01A6\u01A7\u01A9\u01AC\u01AE\u01AF\u01B1-\u01B3\u01B5\u01B7\u01B8\u01BC\u01C4\u01C7\u01CA\u01CD\u01CF\u01D1\u01D3\u01D5\u01D7\u01D9\u01DB\u01DE\u01E0\u01E2\u01E4\u01E6\u01E8\u01EA\u01EC\u01EE\u01F1\u01F4\u01F6-\u01F8\u01FA\u01FC\u01FE\u0200\u0202\u0204\u0206\u0208\u020A\u020C\u020E\u0210\u0212\u0214\u0216\u0218\u021A\u021C\u021E\u0220\u0222\u0224\u0226\u0228\u022A\u022C\u022E\u0230\u0232\u023A\u023B\u023D\u023E\u0241\u0243-\u0246\u0248\u024A\u024C\u024E\u0370\u0372\u0376\u037F\u0386\u0388-\u038A\u038C\u038E\u038F\u0391-\u03A1\u03A3-\u03AB\u03CF\u03D2-\u03D4\u03D8\u03DA\u03DC\u03DE\u03E0\u03E2\u03E4\u03E6\u03E8\u03EA\u03EC\u03EE\u03F4\u03F7\u03F9\u03FA\u03FD-\u042F\u0460\u0462\u0464\u0466\u0468\u046A\u046C\u046E\u0470\u0472\u0474\u0476\u0478\u047A\u047C\u047E\u0480\u048A\u048C\u048E\u0490\u0492\u0494\u0496\u0498\u049A\u049C\u049E\u04A0\u04A2\u04A4\u04A6\u04A8\u04AA\u04AC\u04AE\u04B0\u04B2\u04B4\u04B6\u04B8\u04BA\u04BC\u04BE\u04C0\u04C1\u04C3\u04C5\u04C7\u04C9\u04CB\u04CD\u04D0\u04D2\u04D4\u04D6\u04D8\u04DA\u04DC\u04DE\u04E0\u04E2\u04E4\u04E6\u04E8\u04EA\u04EC\u04EE\u04F0\u04F2\u04F4\u04F6\u04F8\u04FA\u04FC\u04FE\u0500\u0502\u0504\u0506\u0508\u050A\u050C\u050E\u0510\u0512\u0514\u0516\u0518\u051A\u051C\u051E\u0520\u0522\u0524\u0526\u0528\u052A\u052C\u052E\u0531-\u0556\u10A0-\u10C5\u10C7\u10CD\u13A0-\u13F5\u1E00\u1E02\u1E04\u1E06\u1E08\u1E0A\u1E0C\u1E0E\u1E10\u1E12\u1E14\u1E16\u1E18\u1E1A\u1E1C\u1E1E\u1E20\u1E22\u1E24\u1E26\u1E28\u1E2A\u1E2C\u1E2E\u1E30\u1E32\u1E34\u1E36\u1E38\u1E3A\u1E3C\u1E3E\u1E40\u1E42\u1E44\u1E46\u1E48\u1E4A\u1E4C\u1E4E\u1E50\u1E52\u1E54\u1E56\u1E58\u1E5A\u1E5C\u1E5E\u1E60\u1E62\u1E64\u1E66\u1E68\u1E6A\u1E6C\u1E6E\u1E70\u1E72\u1E74\u1E76\u1E78\u1E7A\u1E7C\u1E7E\u1E80\u1E82\u1E84\u1E86\u1E88\u1E8A\u1E8C\u1E8E\u1E90\u1E92\u1E94\u1E9E\u1EA0\u1EA2\u1EA4\u1EA6\u1EA8\u1EAA\u1EAC\u1EAE\u1EB0\u1EB2\u1EB4\u1EB6\u1EB8\u1EBA\u1EBC\u1EBE\u1EC0\u1EC2\u1EC4\u1EC6\u1EC8\u1ECA\u1ECC\u1ECE\u1ED0\u1ED2\u1ED4\u1ED6\u1ED8\u1EDA\u1EDC\u1EDE\u1EE0\u1EE2\u1EE4\u1EE6\u1EE8\u1EEA\u1EEC\u1EEE\u1EF0\u1EF2\u1EF4\u1EF6\u1EF8\u1EFA\u1EFC\u1EFE\u1F08-\u1F0F\u1F18-\u1F1D\u1F28-\u1F2F\u1F38-\u1F3F\u1F48-\u1F4D\u1F59\u1F5B\u1F5D\u1F5F\u1F68-\u1F6F\u1FB8-\u1FBB\u1FC8-\u1FCB\u1FD8-\u1FDB\u1FE8-\u1FEC\u1FF8-\u1FFB\u2102\u2107\u210B-\u210D\u2110-\u2112\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u2130-\u2133\u213E\u213F\u2145\u2183\u2C00-\u2C2E\u2C60\u2C62-\u2C64\u2C67\u2C69\u2C6B\u2C6D-\u2C70\u2C72\u2C75\u2C7E-\u2C80\u2C82\u2C84\u2C86\u2C88\u2C8A\u2C8C\u2C8E\u2C90\u2C92\u2C94\u2C96\u2C98\u2C9A\u2C9C\u2C9E\u2CA0\u2CA2\u2CA4\u2CA6\u2CA8\u2CAA\u2CAC\u2CAE\u2CB0\u2CB2\u2CB4\u2CB6\u2CB8\u2CBA\u2CBC\u2CBE\u2CC0\u2CC2\u2CC4\u2CC6\u2CC8\u2CCA\u2CCC\u2CCE\u2CD0\u2CD2\u2CD4\u2CD6\u2CD8\u2CDA\u2CDC\u2CDE\u2CE0\u2CE2\u2CEB\u2CED\u2CF2\uA640\uA642\uA644\uA646\uA648\uA64A\uA64C\uA64E\uA650\uA652\uA654\uA656\uA658\uA65A\uA65C\uA65E\uA660\uA662\uA664\uA666\uA668\uA66A\uA66C\uA680\uA682\uA684\uA686\uA688\uA68A\uA68C\uA68E\uA690\uA692\uA694\uA696\uA698\uA69A\uA722\uA724\uA726\uA728\uA72A\uA72C\uA72E\uA732\uA734\uA736\uA738\uA73A\uA73C\uA73E\uA740\uA742\uA744\uA746\uA748\uA74A\uA74C\uA74E\uA750\uA752\uA754\uA756\uA758\uA75A\uA75C\uA75E\uA760\uA762\uA764\uA766\uA768\uA76A\uA76C\uA76E\uA779\uA77B\uA77D\uA77E\uA780\uA782\uA784\uA786\uA78B\uA78D\uA790\uA792\uA796\uA798\uA79A\uA79C\uA79E\uA7A0\uA7A2\uA7A4\uA7A6\uA7A8\uA7AA-\uA7AD\uA7B0-\uA7B4\uA7B6\uFF21-\uFF3A])/g},function(e,t){e.exports=/([A-Z\xC0-\xD6\xD8-\xDE\u0100\u0102\u0104\u0106\u0108\u010A\u010C\u010E\u0110\u0112\u0114\u0116\u0118\u011A\u011C\u011E\u0120\u0122\u0124\u0126\u0128\u012A\u012C\u012E\u0130\u0132\u0134\u0136\u0139\u013B\u013D\u013F\u0141\u0143\u0145\u0147\u014A\u014C\u014E\u0150\u0152\u0154\u0156\u0158\u015A\u015C\u015E\u0160\u0162\u0164\u0166\u0168\u016A\u016C\u016E\u0170\u0172\u0174\u0176\u0178\u0179\u017B\u017D\u0181\u0182\u0184\u0186\u0187\u0189-\u018B\u018E-\u0191\u0193\u0194\u0196-\u0198\u019C\u019D\u019F\u01A0\u01A2\u01A4\u01A6\u01A7\u01A9\u01AC\u01AE\u01AF\u01B1-\u01B3\u01B5\u01B7\u01B8\u01BC\u01C4\u01C7\u01CA\u01CD\u01CF\u01D1\u01D3\u01D5\u01D7\u01D9\u01DB\u01DE\u01E0\u01E2\u01E4\u01E6\u01E8\u01EA\u01EC\u01EE\u01F1\u01F4\u01F6-\u01F8\u01FA\u01FC\u01FE\u0200\u0202\u0204\u0206\u0208\u020A\u020C\u020E\u0210\u0212\u0214\u0216\u0218\u021A\u021C\u021E\u0220\u0222\u0224\u0226\u0228\u022A\u022C\u022E\u0230\u0232\u023A\u023B\u023D\u023E\u0241\u0243-\u0246\u0248\u024A\u024C\u024E\u0370\u0372\u0376\u037F\u0386\u0388-\u038A\u038C\u038E\u038F\u0391-\u03A1\u03A3-\u03AB\u03CF\u03D2-\u03D4\u03D8\u03DA\u03DC\u03DE\u03E0\u03E2\u03E4\u03E6\u03E8\u03EA\u03EC\u03EE\u03F4\u03F7\u03F9\u03FA\u03FD-\u042F\u0460\u0462\u0464\u0466\u0468\u046A\u046C\u046E\u0470\u0472\u0474\u0476\u0478\u047A\u047C\u047E\u0480\u048A\u048C\u048E\u0490\u0492\u0494\u0496\u0498\u049A\u049C\u049E\u04A0\u04A2\u04A4\u04A6\u04A8\u04AA\u04AC\u04AE\u04B0\u04B2\u04B4\u04B6\u04B8\u04BA\u04BC\u04BE\u04C0\u04C1\u04C3\u04C5\u04C7\u04C9\u04CB\u04CD\u04D0\u04D2\u04D4\u04D6\u04D8\u04DA\u04DC\u04DE\u04E0\u04E2\u04E4\u04E6\u04E8\u04EA\u04EC\u04EE\u04F0\u04F2\u04F4\u04F6\u04F8\u04FA\u04FC\u04FE\u0500\u0502\u0504\u0506\u0508\u050A\u050C\u050E\u0510\u0512\u0514\u0516\u0518\u051A\u051C\u051E\u0520\u0522\u0524\u0526\u0528\u052A\u052C\u052E\u0531-\u0556\u10A0-\u10C5\u10C7\u10CD\u13A0-\u13F5\u1E00\u1E02\u1E04\u1E06\u1E08\u1E0A\u1E0C\u1E0E\u1E10\u1E12\u1E14\u1E16\u1E18\u1E1A\u1E1C\u1E1E\u1E20\u1E22\u1E24\u1E26\u1E28\u1E2A\u1E2C\u1E2E\u1E30\u1E32\u1E34\u1E36\u1E38\u1E3A\u1E3C\u1E3E\u1E40\u1E42\u1E44\u1E46\u1E48\u1E4A\u1E4C\u1E4E\u1E50\u1E52\u1E54\u1E56\u1E58\u1E5A\u1E5C\u1E5E\u1E60\u1E62\u1E64\u1E66\u1E68\u1E6A\u1E6C\u1E6E\u1E70\u1E72\u1E74\u1E76\u1E78\u1E7A\u1E7C\u1E7E\u1E80\u1E82\u1E84\u1E86\u1E88\u1E8A\u1E8C\u1E8E\u1E90\u1E92\u1E94\u1E9E\u1EA0\u1EA2\u1EA4\u1EA6\u1EA8\u1EAA\u1EAC\u1EAE\u1EB0\u1EB2\u1EB4\u1EB6\u1EB8\u1EBA\u1EBC\u1EBE\u1EC0\u1EC2\u1EC4\u1EC6\u1EC8\u1ECA\u1ECC\u1ECE\u1ED0\u1ED2\u1ED4\u1ED6\u1ED8\u1EDA\u1EDC\u1EDE\u1EE0\u1EE2\u1EE4\u1EE6\u1EE8\u1EEA\u1EEC\u1EEE\u1EF0\u1EF2\u1EF4\u1EF6\u1EF8\u1EFA\u1EFC\u1EFE\u1F08-\u1F0F\u1F18-\u1F1D\u1F28-\u1F2F\u1F38-\u1F3F\u1F48-\u1F4D\u1F59\u1F5B\u1F5D\u1F5F\u1F68-\u1F6F\u1FB8-\u1FBB\u1FC8-\u1FCB\u1FD8-\u1FDB\u1FE8-\u1FEC\u1FF8-\u1FFB\u2102\u2107\u210B-\u210D\u2110-\u2112\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u2130-\u2133\u213E\u213F\u2145\u2183\u2C00-\u2C2E\u2C60\u2C62-\u2C64\u2C67\u2C69\u2C6B\u2C6D-\u2C70\u2C72\u2C75\u2C7E-\u2C80\u2C82\u2C84\u2C86\u2C88\u2C8A\u2C8C\u2C8E\u2C90\u2C92\u2C94\u2C96\u2C98\u2C9A\u2C9C\u2C9E\u2CA0\u2CA2\u2CA4\u2CA6\u2CA8\u2CAA\u2CAC\u2CAE\u2CB0\u2CB2\u2CB4\u2CB6\u2CB8\u2CBA\u2CBC\u2CBE\u2CC0\u2CC2\u2CC4\u2CC6\u2CC8\u2CCA\u2CCC\u2CCE\u2CD0\u2CD2\u2CD4\u2CD6\u2CD8\u2CDA\u2CDC\u2CDE\u2CE0\u2CE2\u2CEB\u2CED\u2CF2\uA640\uA642\uA644\uA646\uA648\uA64A\uA64C\uA64E\uA650\uA652\uA654\uA656\uA658\uA65A\uA65C\uA65E\uA660\uA662\uA664\uA666\uA668\uA66A\uA66C\uA680\uA682\uA684\uA686\uA688\uA68A\uA68C\uA68E\uA690\uA692\uA694\uA696\uA698\uA69A\uA722\uA724\uA726\uA728\uA72A\uA72C\uA72E\uA732\uA734\uA736\uA738\uA73A\uA73C\uA73E\uA740\uA742\uA744\uA746\uA748\uA74A\uA74C\uA74E\uA750\uA752\uA754\uA756\uA758\uA75A\uA75C\uA75E\uA760\uA762\uA764\uA766\uA768\uA76A\uA76C\uA76E\uA779\uA77B\uA77D\uA77E\uA780\uA782\uA784\uA786\uA78B\uA78D\uA790\uA792\uA796\uA798\uA79A\uA79C\uA79E\uA7A0\uA7A2\uA7A4\uA7A6\uA7A8\uA7AA-\uA7AD\uA7B0-\uA7B4\uA7B6\uFF21-\uFF3A])([A-Z\xC0-\xD6\xD8-\xDE\u0100\u0102\u0104\u0106\u0108\u010A\u010C\u010E\u0110\u0112\u0114\u0116\u0118\u011A\u011C\u011E\u0120\u0122\u0124\u0126\u0128\u012A\u012C\u012E\u0130\u0132\u0134\u0136\u0139\u013B\u013D\u013F\u0141\u0143\u0145\u0147\u014A\u014C\u014E\u0150\u0152\u0154\u0156\u0158\u015A\u015C\u015E\u0160\u0162\u0164\u0166\u0168\u016A\u016C\u016E\u0170\u0172\u0174\u0176\u0178\u0179\u017B\u017D\u0181\u0182\u0184\u0186\u0187\u0189-\u018B\u018E-\u0191\u0193\u0194\u0196-\u0198\u019C\u019D\u019F\u01A0\u01A2\u01A4\u01A6\u01A7\u01A9\u01AC\u01AE\u01AF\u01B1-\u01B3\u01B5\u01B7\u01B8\u01BC\u01C4\u01C7\u01CA\u01CD\u01CF\u01D1\u01D3\u01D5\u01D7\u01D9\u01DB\u01DE\u01E0\u01E2\u01E4\u01E6\u01E8\u01EA\u01EC\u01EE\u01F1\u01F4\u01F6-\u01F8\u01FA\u01FC\u01FE\u0200\u0202\u0204\u0206\u0208\u020A\u020C\u020E\u0210\u0212\u0214\u0216\u0218\u021A\u021C\u021E\u0220\u0222\u0224\u0226\u0228\u022A\u022C\u022E\u0230\u0232\u023A\u023B\u023D\u023E\u0241\u0243-\u0246\u0248\u024A\u024C\u024E\u0370\u0372\u0376\u037F\u0386\u0388-\u038A\u038C\u038E\u038F\u0391-\u03A1\u03A3-\u03AB\u03CF\u03D2-\u03D4\u03D8\u03DA\u03DC\u03DE\u03E0\u03E2\u03E4\u03E6\u03E8\u03EA\u03EC\u03EE\u03F4\u03F7\u03F9\u03FA\u03FD-\u042F\u0460\u0462\u0464\u0466\u0468\u046A\u046C\u046E\u0470\u0472\u0474\u0476\u0478\u047A\u047C\u047E\u0480\u048A\u048C\u048E\u0490\u0492\u0494\u0496\u0498\u049A\u049C\u049E\u04A0\u04A2\u04A4\u04A6\u04A8\u04AA\u04AC\u04AE\u04B0\u04B2\u04B4\u04B6\u04B8\u04BA\u04BC\u04BE\u04C0\u04C1\u04C3\u04C5\u04C7\u04C9\u04CB\u04CD\u04D0\u04D2\u04D4\u04D6\u04D8\u04DA\u04DC\u04DE\u04E0\u04E2\u04E4\u04E6\u04E8\u04EA\u04EC\u04EE\u04F0\u04F2\u04F4\u04F6\u04F8\u04FA\u04FC\u04FE\u0500\u0502\u0504\u0506\u0508\u050A\u050C\u050E\u0510\u0512\u0514\u0516\u0518\u051A\u051C\u051E\u0520\u0522\u0524\u0526\u0528\u052A\u052C\u052E\u0531-\u0556\u10A0-\u10C5\u10C7\u10CD\u13A0-\u13F5\u1E00\u1E02\u1E04\u1E06\u1E08\u1E0A\u1E0C\u1E0E\u1E10\u1E12\u1E14\u1E16\u1E18\u1E1A\u1E1C\u1E1E\u1E20\u1E22\u1E24\u1E26\u1E28\u1E2A\u1E2C\u1E2E\u1E30\u1E32\u1E34\u1E36\u1E38\u1E3A\u1E3C\u1E3E\u1E40\u1E42\u1E44\u1E46\u1E48\u1E4A\u1E4C\u1E4E\u1E50\u1E52\u1E54\u1E56\u1E58\u1E5A\u1E5C\u1E5E\u1E60\u1E62\u1E64\u1E66\u1E68\u1E6A\u1E6C\u1E6E\u1E70\u1E72\u1E74\u1E76\u1E78\u1E7A\u1E7C\u1E7E\u1E80\u1E82\u1E84\u1E86\u1E88\u1E8A\u1E8C\u1E8E\u1E90\u1E92\u1E94\u1E9E\u1EA0\u1EA2\u1EA4\u1EA6\u1EA8\u1EAA\u1EAC\u1EAE\u1EB0\u1EB2\u1EB4\u1EB6\u1EB8\u1EBA\u1EBC\u1EBE\u1EC0\u1EC2\u1EC4\u1EC6\u1EC8\u1ECA\u1ECC\u1ECE\u1ED0\u1ED2\u1ED4\u1ED6\u1ED8\u1EDA\u1EDC\u1EDE\u1EE0\u1EE2\u1EE4\u1EE6\u1EE8\u1EEA\u1EEC\u1EEE\u1EF0\u1EF2\u1EF4\u1EF6\u1EF8\u1EFA\u1EFC\u1EFE\u1F08-\u1F0F\u1F18-\u1F1D\u1F28-\u1F2F\u1F38-\u1F3F\u1F48-\u1F4D\u1F59\u1F5B\u1F5D\u1F5F\u1F68-\u1F6F\u1FB8-\u1FBB\u1FC8-\u1FCB\u1FD8-\u1FDB\u1FE8-\u1FEC\u1FF8-\u1FFB\u2102\u2107\u210B-\u210D\u2110-\u2112\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u2130-\u2133\u213E\u213F\u2145\u2183\u2C00-\u2C2E\u2C60\u2C62-\u2C64\u2C67\u2C69\u2C6B\u2C6D-\u2C70\u2C72\u2C75\u2C7E-\u2C80\u2C82\u2C84\u2C86\u2C88\u2C8A\u2C8C\u2C8E\u2C90\u2C92\u2C94\u2C96\u2C98\u2C9A\u2C9C\u2C9E\u2CA0\u2CA2\u2CA4\u2CA6\u2CA8\u2CAA\u2CAC\u2CAE\u2CB0\u2CB2\u2CB4\u2CB6\u2CB8\u2CBA\u2CBC\u2CBE\u2CC0\u2CC2\u2CC4\u2CC6\u2CC8\u2CCA\u2CCC\u2CCE\u2CD0\u2CD2\u2CD4\u2CD6\u2CD8\u2CDA\u2CDC\u2CDE\u2CE0\u2CE2\u2CEB\u2CED\u2CF2\uA640\uA642\uA644\uA646\uA648\uA64A\uA64C\uA64E\uA650\uA652\uA654\uA656\uA658\uA65A\uA65C\uA65E\uA660\uA662\uA664\uA666\uA668\uA66A\uA66C\uA680\uA682\uA684\uA686\uA688\uA68A\uA68C\uA68E\uA690\uA692\uA694\uA696\uA698\uA69A\uA722\uA724\uA726\uA728\uA72A\uA72C\uA72E\uA732\uA734\uA736\uA738\uA73A\uA73C\uA73E\uA740\uA742\uA744\uA746\uA748\uA74A\uA74C\uA74E\uA750\uA752\uA754\uA756\uA758\uA75A\uA75C\uA75E\uA760\uA762\uA764\uA766\uA768\uA76A\uA76C\uA76E\uA779\uA77B\uA77D\uA77E\uA780\uA782\uA784\uA786\uA78B\uA78D\uA790\uA792\uA796\uA798\uA79A\uA79C\uA79E\uA7A0\uA7A2\uA7A4\uA7A6\uA7A8\uA7AA-\uA7AD\uA7B0-\uA7B4\uA7B6\uFF21-\uFF3A][a-z\xB5\xDF-\xF6\xF8-\xFF\u0101\u0103\u0105\u0107\u0109\u010B\u010D\u010F\u0111\u0113\u0115\u0117\u0119\u011B\u011D\u011F\u0121\u0123\u0125\u0127\u0129\u012B\u012D\u012F\u0131\u0133\u0135\u0137\u0138\u013A\u013C\u013E\u0140\u0142\u0144\u0146\u0148\u0149\u014B\u014D\u014F\u0151\u0153\u0155\u0157\u0159\u015B\u015D\u015F\u0161\u0163\u0165\u0167\u0169\u016B\u016D\u016F\u0171\u0173\u0175\u0177\u017A\u017C\u017E-\u0180\u0183\u0185\u0188\u018C\u018D\u0192\u0195\u0199-\u019B\u019E\u01A1\u01A3\u01A5\u01A8\u01AA\u01AB\u01AD\u01B0\u01B4\u01B6\u01B9\u01BA\u01BD-\u01BF\u01C6\u01C9\u01CC\u01CE\u01D0\u01D2\u01D4\u01D6\u01D8\u01DA\u01DC\u01DD\u01DF\u01E1\u01E3\u01E5\u01E7\u01E9\u01EB\u01ED\u01EF\u01F0\u01F3\u01F5\u01F9\u01FB\u01FD\u01FF\u0201\u0203\u0205\u0207\u0209\u020B\u020D\u020F\u0211\u0213\u0215\u0217\u0219\u021B\u021D\u021F\u0221\u0223\u0225\u0227\u0229\u022B\u022D\u022F\u0231\u0233-\u0239\u023C\u023F\u0240\u0242\u0247\u0249\u024B\u024D\u024F-\u0293\u0295-\u02AF\u0371\u0373\u0377\u037B-\u037D\u0390\u03AC-\u03CE\u03D0\u03D1\u03D5-\u03D7\u03D9\u03DB\u03DD\u03DF\u03E1\u03E3\u03E5\u03E7\u03E9\u03EB\u03ED\u03EF-\u03F3\u03F5\u03F8\u03FB\u03FC\u0430-\u045F\u0461\u0463\u0465\u0467\u0469\u046B\u046D\u046F\u0471\u0473\u0475\u0477\u0479\u047B\u047D\u047F\u0481\u048B\u048D\u048F\u0491\u0493\u0495\u0497\u0499\u049B\u049D\u049F\u04A1\u04A3\u04A5\u04A7\u04A9\u04AB\u04AD\u04AF\u04B1\u04B3\u04B5\u04B7\u04B9\u04BB\u04BD\u04BF\u04C2\u04C4\u04C6\u04C8\u04CA\u04CC\u04CE\u04CF\u04D1\u04D3\u04D5\u04D7\u04D9\u04DB\u04DD\u04DF\u04E1\u04E3\u04E5\u04E7\u04E9\u04EB\u04ED\u04EF\u04F1\u04F3\u04F5\u04F7\u04F9\u04FB\u04FD\u04FF\u0501\u0503\u0505\u0507\u0509\u050B\u050D\u050F\u0511\u0513\u0515\u0517\u0519\u051B\u051D\u051F\u0521\u0523\u0525\u0527\u0529\u052B\u052D\u052F\u0561-\u0587\u13F8-\u13FD\u1D00-\u1D2B\u1D6B-\u1D77\u1D79-\u1D9A\u1E01\u1E03\u1E05\u1E07\u1E09\u1E0B\u1E0D\u1E0F\u1E11\u1E13\u1E15\u1E17\u1E19\u1E1B\u1E1D\u1E1F\u1E21\u1E23\u1E25\u1E27\u1E29\u1E2B\u1E2D\u1E2F\u1E31\u1E33\u1E35\u1E37\u1E39\u1E3B\u1E3D\u1E3F\u1E41\u1E43\u1E45\u1E47\u1E49\u1E4B\u1E4D\u1E4F\u1E51\u1E53\u1E55\u1E57\u1E59\u1E5B\u1E5D\u1E5F\u1E61\u1E63\u1E65\u1E67\u1E69\u1E6B\u1E6D\u1E6F\u1E71\u1E73\u1E75\u1E77\u1E79\u1E7B\u1E7D\u1E7F\u1E81\u1E83\u1E85\u1E87\u1E89\u1E8B\u1E8D\u1E8F\u1E91\u1E93\u1E95-\u1E9D\u1E9F\u1EA1\u1EA3\u1EA5\u1EA7\u1EA9\u1EAB\u1EAD\u1EAF\u1EB1\u1EB3\u1EB5\u1EB7\u1EB9\u1EBB\u1EBD\u1EBF\u1EC1\u1EC3\u1EC5\u1EC7\u1EC9\u1ECB\u1ECD\u1ECF\u1ED1\u1ED3\u1ED5\u1ED7\u1ED9\u1EDB\u1EDD\u1EDF\u1EE1\u1EE3\u1EE5\u1EE7\u1EE9\u1EEB\u1EED\u1EEF\u1EF1\u1EF3\u1EF5\u1EF7\u1EF9\u1EFB\u1EFD\u1EFF-\u1F07\u1F10-\u1F15\u1F20-\u1F27\u1F30-\u1F37\u1F40-\u1F45\u1F50-\u1F57\u1F60-\u1F67\u1F70-\u1F7D\u1F80-\u1F87\u1F90-\u1F97\u1FA0-\u1FA7\u1FB0-\u1FB4\u1FB6\u1FB7\u1FBE\u1FC2-\u1FC4\u1FC6\u1FC7\u1FD0-\u1FD3\u1FD6\u1FD7\u1FE0-\u1FE7\u1FF2-\u1FF4\u1FF6\u1FF7\u210A\u210E\u210F\u2113\u212F\u2134\u2139\u213C\u213D\u2146-\u2149\u214E\u2184\u2C30-\u2C5E\u2C61\u2C65\u2C66\u2C68\u2C6A\u2C6C\u2C71\u2C73\u2C74\u2C76-\u2C7B\u2C81\u2C83\u2C85\u2C87\u2C89\u2C8B\u2C8D\u2C8F\u2C91\u2C93\u2C95\u2C97\u2C99\u2C9B\u2C9D\u2C9F\u2CA1\u2CA3\u2CA5\u2CA7\u2CA9\u2CAB\u2CAD\u2CAF\u2CB1\u2CB3\u2CB5\u2CB7\u2CB9\u2CBB\u2CBD\u2CBF\u2CC1\u2CC3\u2CC5\u2CC7\u2CC9\u2CCB\u2CCD\u2CCF\u2CD1\u2CD3\u2CD5\u2CD7\u2CD9\u2CDB\u2CDD\u2CDF\u2CE1\u2CE3\u2CE4\u2CEC\u2CEE\u2CF3\u2D00-\u2D25\u2D27\u2D2D\uA641\uA643\uA645\uA647\uA649\uA64B\uA64D\uA64F\uA651\uA653\uA655\uA657\uA659\uA65B\uA65D\uA65F\uA661\uA663\uA665\uA667\uA669\uA66B\uA66D\uA681\uA683\uA685\uA687\uA689\uA68B\uA68D\uA68F\uA691\uA693\uA695\uA697\uA699\uA69B\uA723\uA725\uA727\uA729\uA72B\uA72D\uA72F-\uA731\uA733\uA735\uA737\uA739\uA73B\uA73D\uA73F\uA741\uA743\uA745\uA747\uA749\uA74B\uA74D\uA74F\uA751\uA753\uA755\uA757\uA759\uA75B\uA75D\uA75F\uA761\uA763\uA765\uA767\uA769\uA76B\uA76D\uA76F\uA771-\uA778\uA77A\uA77C\uA77F\uA781\uA783\uA785\uA787\uA78C\uA78E\uA791\uA793-\uA795\uA797\uA799\uA79B\uA79D\uA79F\uA7A1\uA7A3\uA7A5\uA7A7\uA7A9\uA7B5\uA7B7\uA7FA\uAB30-\uAB5A\uAB60-\uAB65\uAB70-\uABBF\uFB00-\uFB06\uFB13-\uFB17\uFF4n"";for(var n="",i=0;i<e.length;i++){var a=e[i],s=r(a,t);n+=s===a?o(a,t)unction(e,t,n){var r=n(146),o=n(104);e.exports=function(e,t,n){return o(r(e,t,n),t)}},function(e,t,n){var r=n(34),o=n(104);e.exports=function(e,t){return  r(e,t)===e}},function(e,t,n){var r=n(70);e.exports=function(e,t){return r(e,t)===e}},function(e,t,n){var r=n(70);eu<c+f&&(p=-1,c+=f-1,u+=f-1);f-- >0;)c in n?n[u]=n[c]:delete n[u],u+=p,c+=p;return n}},function(e,t,n){"use strict";var r=n(5),o=n(21).every,i=r.aTypedArray;(0,r.exportTypedArrayMethod=i(this,this.constructor),r=0,u=t.length,c=new(s(n))(u);u>r;)c[r]=t[r++];return c}))},function(e,t,n){"use strict";var r=n(5),o=n(21).find,i=r.aTypedArray;(0,r.exportTypedArrayMethod)("find",(function(e){return o(i(this),e,arguments.length>1?arguments[1]:void 0)}))},function(e,t,n){"use strict";var r=n(5),o=n(21).findIndex,i=r.aTypedArray;(0,r.exportTypedArrayMethod)("fethod)("forEach",(function(e){o(i(this),e,arguments.length>1?arguments[1]:void 0)}))},function(e,t,n){"use strict";var r=n(5),o=n(63).includes,i=r.aTypedArray;(0,r.exportTypedArrayMethod)("(this))})),p("keys",(function(){return c.call(f(this))})),p("values",g,!h),p(a,g,!h)},function(e,t,n){"use strict";var r=n(5),o=r.aTypedArray,i=r.exportTypedArrayMethod,a=[].join;i("join",(function(e){return a.apply(o(this),arguments)}))},function(e,t,n){"use strict";var r=n(5),o=n(266),i=r.aTypedArray;(0,r.expngth>1?arguments[1]:void 0,(function(e,t){return new(s(i(e,e.constructor)))(t)}))}))},function(e,t,n){"use strict";var r=n(5),o=n(93).left,i=r.aTypedArray;(0,r.exportTypedArrayMethod)("reduce",(functi=new(s(r))(u);u>i;)l[i]=n[i++];return l}),i((function(){new Int8Array(1).slice()})))},function(e,t,n){"use strict";var r=n(5),o=n(21).some,i=r.aTypedArray;(0,r.exportTypedArrayMetholl({})}))&&(s=function(){retug,(function(e){return e[1].toUpperCase()}))}function o(e,t){return 0===e.indexOf(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.convertReactSVGDOMProperty=r,t.startsWith=o,t.serializeAttrs=i,t.getSVGFromSource=a,t.extractSVGProps=function(e){var t=a(e).attributes;return t.length>0?i(t):null};function i(e){for(var t={},n=0;n<e.length;n++){var i=e[n].name;t["class"==i?"className":o(i,"data-")?i:r(i)]=e[n].value}return t}function a(e){var t=document.createElement("div");t.){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(e,t,n){var r=n(288);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(11)(r,o);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=n(10)(!1)).push([e.i,"@import url(https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@200;300;400;500;600;700&display=swap);"]),t.push([e.i,".widget_company-info{background:#f2f2f2;display:flex;padding:24px;min-height:48px;flex-shrink:0}.widget_company-info_logo{flex-shrink:0;height:48px;margin-right:20px;width:48px;background-size:cover;background-position:center;border-radius:100%;overflow:hidden}.widget_company-info_logo img{max-height:100%;max-width:100%}.widget_company-info_logo svg{height:48px;width:48px}.widget_company-info_content{display:flex;flex-direction:column;justify-content:center;color:#fff}.widget.color-light .widget_company-info_content{color:#5F667E}.widget_company-info_name{font-size:18px;font-weight:500}.widget_company-info_description{font-size:15px}.widget_company-info_offline{display:inline-flex;align-items:center;position:relative;margin-top:10px;text-transform:uppercase;background-color:rgba(255,255,255,0.4);border-radius:21px;height:21px;padding:2px 6px 2px 2px}.widget_company-info_offline:before{content:'';width:16.5px;height:16.5px;border:1px solid #fff;border-radius:16.5px;background-color:#f3376b;margin-right:4px}.widget_company-info_unction(e){return r((function(){return!!o[e]()||"​᠎"!="​᠎"[e]()||o[e].name!==e}))}},function(e,t,n){var r=n(293);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(11)(r,o);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=n(10)(!1)).push([e.i,"@import url(https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@200;300;400;500;600;700&display=swap);"]),t.push([e.i,".widget_composer{box-shadow:0 -2px 0 0 #CED3E0;display:flex;flex-shrink:0;position:relative;align-items:center;border-bottom-left-radius:4px;border-bottom-right-radius:4px;transition:box-shadow 300ms}.widget_composer .widget_composer_wrap{position:relative;flex-grow:1}.widget_composer .widget_composer_button,.widget_composer .widget_composer_send{border:0;border-radius:4px;cursor:pointer;flex-shrink:0;height:33px;color:#fff;padding:0 14px;line-height:33px;font-size:13px;margin:7px;font-weight:500;transition:filter 0.2s}.widget_composer .widget_composer_button:hover,.widget_composer .widget_composer_send:hover{filter:brightness(80%)}.widget.color-light .widget_composer .widget_composer_button,.widget.color-light .widget_composer .widget_composer_send{color:#5F667E}.widget_composer .widget_composer_button svg,.widget_composer .widget_composer_send svg{fill:#fff;height:13px;margin:-3px 6px 0 0;width:13px;vertical-align:middle}.widget.color-light .widget_composer .widget_composer_button svg,.widget.color-light .widget_composer .widget_composer_send svg{fill:#5F667E}.widget_composer .widget_composer_button+.widget_composer_button,.widget_composer .widget_composer_button+.widget_composer_send{margin-top:0}.widget_composer .widget_composer_send{align-self:flex-end}.widget_composer textarea{resize:none;outline:none;z-index:2;overflow-y:auto;line-height:20px;width:100%;min-height:48px;height:100%;padding:14px 0 14px 16px;border:0;color:#4e4e4e;position:absolute;top:0;left:0;bottom:0;white-space:pre-wrap;word-wrap:break-word}.widget_composer .hidden-resizer{opacity:0;white-space:pre-wrap;word-wrap:break-word;word-break:break-all;max-height:250px;width:100%;height:100%;line-height:20px;min-height:48px;overflow:hidden;padding:14px 0 14px 16px}.widget_composer .widget_composer_buttons{box-shadow:0 -2px 0 0 #CED3E0;border-bottom-left-radius:4px;border-bottom-right-radius:4px;padding:8px}.widget_composer .widget_composer_buttons button{-webkit-appearance:none;border:0;border-radius:30px;margin:4px;color:white;padding:8px;cursor:pointer;outline:none}.widget_composer .widget_composer_buttons button:focus,.widget_composer .widget_composer_buttons button:active{box-shadow:0 0 2px 2px rgba(59,63,72,0.2)}.widget_composer .widget_composer_buttons button:hover{opacity:.9}.widget.color-light .widget_composer .widget_composer_buttons button{color:#5F667E}.widget_composer .widget_composer_buttons.disabled button{cursor:default;opacity:.5}.widget_composer.checkbox{flex-direction:column;align-items:flex-start;padding:14px 7px 7px 14px}.widget_composer.column{flex-direction:column;align-items:flex-start}.widget_composer .widget_composer_checkbox{margin-bottom:4px;line-height:18px}.widget_composer .widget_composer_checkbox input{height:18px}.widget_composer .widget_composer_checkbox label{margin-left:4px;font-weight:bold;vertical-align:top}.widget_date_picker{position:absolute;background:#fff;bottom:calc(100% + 2px);box-shadow:0 -2px 8px 0 rgba(0,0,0,0.15)}.widget_date_picker.standalone{position:static}.widget_date_picker button{background:none;border:none;border-radius:0;cursor:pointer;outline:none}.widget_date_picker button:focus abbr{box-shadow:0 0 2px 2px rgba(59,63,72,0.2)}.widget_date_picker .react-calendar__navigation__label{font-weight:500;padding:10px}.widget_date_picker .react-calendar__navigation__arrow{font-weight:bold}.widget_date_picker .react-calendar__month-view__weekdays__weekday{text-align:center;text-transform:uppercase}.widget_date_picker .react-calendar__month-view__weekdays__weekday abbr{text-decoration:none}.widget_date_picker .react-calendar__month-view__weekdays{border-top:1px solid #CED3E0;border-bottom:1px solid #CED3E0;padding:5px 0}.widget_date_picker .react-calendar__month-view__days__day abbr{width:25px;height:25px;display:inline-block;line-height:25px}.widget_date_picker .react-calendar__month-view__days__day:hover abbr{background-color:#E4E7F0}.widget_date_picker .react-calendar__year-view__months__month,.widget_date_picker .react-calendar__decade-view__years__year,.widget_date_picker .react-calendar__century-view__decades__decade{padding:10px}.widget_time_picker{overflow-y:auto;height:100px;width:250px;list-style:none;margin:0px;padding:0px;position:absolute;bottom:calc(100% - 3px);left:7px;background:#fff;border:1px solid #CED3E0;border-radius:8px;font-size:14px}.widget_time_picker li button{padding:4px 16px;border:none;background-color:#fff;width:100%;text-align:left;cursor:pointer}.widget_time_picker li button:hover{background-color:#E4E7F0}.widget_time_picker li button:active{background-color:#CED3E0}.widget_time_picker li svg{fill:#4dcba9;height:13px;margin-right:6px;width:13px;visibility:hidden}.widget_time_picker li.selected svg{visibility:visible}\n",""]),e.exports=t},function(e,t,n){var r=n(295);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(11)(r,o);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=n(10)(!1)).push([e.i,"@import url(https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@200;300;400;500;600;700&display=swap);"]),t.push([e.i,".widget_notification-badge{align-items:center;background-color:#f37c7b;border-radius:50%;border:solid 2px #fff;display:flex;height:20px;justify-content:center;width:20px;bottom:40px;position:absolute;right:0;z-index:1}.widget_notification-badge_text{color:#fff;font-size:12px;font-weight:600}\n",""]),e.exports=t},function(e,t,n){var r=n(297);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(11)(r,o);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=n(10)(!1)).push([e.i,"@import url(https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@200;300;400;500;600;700&display=swap);"]),t.push([e.i,".widget_branding{text-align:center}.widget_branding_link{text-decoration:none;color:#9298AD;display:inline-flex;align-items:center;justify-content:center;margin-bottom:8px}.widget_branding_link:hover{cursor:pointer}.widget_branding_link:hover .widget_branding_logo{fill:#356ae6}.widget_branding_chat-by{margin-right:3px;font-size:12px}.widget_branding_logo{margin-top:5px;fill:#9298ad}.widget_branding_logo svg{width:108px;height:11px}\n",""]),e.exports=t},function(e,t,n){var r=n(299);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(11)(r,o);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=n(10)(!1)).push([e.i,".widget_typing-label{text-align:center;font-size:13px;padding-bottom:8px}\n",""]),e.exports=t},function(e,t,n){var r=n(301);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(11)(r,o);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=n(10)(!1)).push([e.i,"@import url(https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@200;300;400;500;600;700&display=swap);"]),t.push([e.i,".widget_conversation{position:relative;padding:16px 16px 0;flex-grow:1;display:flex;flex-direction:column;overflow-y:auto}.widget_conversation_footer{min-height:20px;padding-bottom:8px}.widget_conversation_footer.large{min-height:30px}.widget_conversation_spacer{flex:1}\n",""]),e.exports=t},function(e,t,n){"use strict";t.__esModule=!0;var r,o=n(0),i=(r=o)&&r.__esModule?r:{default:r},a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(303)tialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var c=a.options,l=c.Options;function f(e,t){for(var n=a.tokenize(e),r=[],o=0,s=0;s<n.length;s++){var u=n[s];if("nl"===u.type&&t.nl2br)r.push(i.default.createElement("br",{key:"linkified-"+ ++o}));else if(u.isLink&&t.check(u)){var c=t.resolve(u),l=c.formatted,f=c.formattedHref,p=c.tagName,d=c.className,h=c.target,g=c.attributes,m={key:"linkified-"+ ++o,href:f};if(d&&(m.className=d),h&&(m.target=h),g)for(var v in g)m[v]=gng())}able:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.render=function(){var e={key:"linkified-element-0"};for(var t in this.props)"options"!==t&&"tagName"!==t&&(e[t]=this.props[t]);var n=new l(this.props.options),r=this.props.tagName||"span";return function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(0===i.default.Children.count(t.props.children))return t;var o=[];i.default.Children.forEach(t.props.children,(function(t){"string"==typeof t?(r+=1,o.push.apply(o,f(t,n))):i.default.isValidElement(t)?"string"==typeof t.type&&c.contains(n.ignoreTags,t.type.toUpperCase())?o.push(t):o.push(e(t,n,++r)):o.push(t)}));var a={key:"linkified-element-"+r};for(var s in t.props)a[s]=t.props[s];return i.defauew Error("define cannot be used indirect")}},function(e,t){(function(t){e.exports=t}).call(this,{})},function(e,t,n){var r=n(312);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(11)(r,o);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=n(10)(!1)).push([e.i,"@import url(https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@200;300;400;500;600;700&display=swap);"]),t.push([e.i,".widget_messages_capture-form-message_input{height:36px;background-color:#fff;border:1px solid #CED3E0;font-size:13px;font-weight:500;width:100%;outline:0;padding:12px;flex:2 1;border-radius:4px;-webkit-appearance:none;min-width:0;margin:8px 0 0 0}.widget_messages_capture-form-message_input.error{border:1px solid #e40e49}.widget_messages_capture-form-message_input.disabled{color:#5F667E;background-color:#edf0f7}.widget_messages_capture-form-message_error{color:#e40e49;display:flex;font-size:11px;margin-top:8px}.widget_messages_capture-form-message_field{margin:0 0 16px 0}.widget_messages_capture-form-message_submit{font-size:13px;font-weight:500;line-height:20px;padding:8px;color:#fff;flex:1 1;border-radius:4px;cursor:pointer;border:none;height:36px;transition:filter 0.2s}.widget.color-light .widget_messages_capture-form-message_submit{color:#5F667E}.widget_messages_capture-form-message_submit .spinner{width:18px;height:18px;animation:spinner 0.6s linear infinite}.widget_messages_capture-form-message_submit:hover{filter:brightness(80%)}@keyframes spinner{from{transform:rotate(0)}to{transform:rotate(360deg)}}.widget_messages_capture-form-message_field_label{display:block;font-size:13px;font-weight:500;color:#1F2129;padding:0;width:100%;margin:0 0 8px 0}\n",""]),e.exports=t},function(e,t,n){var r=n(314);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(11)(r,o);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=n(10)(!1)).push([e.i,"@import url(https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@200;300;400;500;600;700&display=swap);"]),t.push([e.i,".widget_messages_agent-message{display:flex;margin-bottom:16px;flex-shrink:0}.widget_messages_agent-message_icon{margin-right:8px;flex-shrink:0;background-size:cover;background-position:center;border-radius:100%;overflow:hidden;width:40px;height:40px}.widget_messages_agent-message_icon svg{height:40px;width:40px;border-radius:100%}.widget_messages_agent-messages{flex:1;display:flex;flex-direction:column;width:calc(100% - 48px)}.widget_messages_agent-messages>div{text-align:left;background:#f3f3f3;border:none;border-radius:4px;padding:16px;margin:0;align-self:flex-start;word-break:break-word;word-wrap:break-word;overflow-wrap:break-word;max-width:100%}.widget_messages_agent-messages>div+div{margin-top:4px}.widget_messages_submitted{color:#939393;display:flex;word-break:break-all}.widget_messages_submitted svg{fill:#4dcba9;height:13px;margin-right:6px;width:13px}\n",""]),e.exports=t},function(e,t,n){var r=n(316);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(11)(r,o);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=n(10)(!1)).push([e.i,"@import url(https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@200;300;400;500;600;700&display=swap);"]),t.push([e.i,".widget_messages_visitor-message{text-align:right;margin-bottom:16px;flex-shrink:0;display:flex;flex-direction:column}.widget_messages_visitor-message a{color:#fff;word-break:break-all}.widget_messages_visitor-message>div{text-align:left;background:#5F667E;color:#fff;font-size:13px;border-radius:4px;padding:16px;margin:0;max-width:100%;word-wrap:break-word;align-self:flex-end}.widget_messages_visitor-message>div+div{margin-top:4px}\n",""]),e.exports=t},function(e,t,n){var r=n(318);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(11)(r,o);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=n(10)(!1)).push([e.i,"@import url(https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@200;300;400;500;600;700&display=swap);"]),t.push([e.i,".widget_icon_container{outline:none;border-radius:50%;box-shadow:0 4px 8px 0 rgba(0,0,0,0.15);cursor:pointer;float:right;height:60px;position:relative;text-align:center;width:60px;border:none}#conversations-app.conversationChatPositionBottomLeft .widget_icon_container{float:left}.widget_icon{align-items:center;display:flex;height:100%;justify-content:center;width:100%;position:relative}.widget_icon svg{fill:#fff;transform-origin:50% 50%;transition:opacity 300ms, transform 300ms;position:absolute;transform:translate(-50%, -50%);left:50%;top:50%}.widget.color-light .widget_icon svg{fill:#5F667E}.widget_icon .widget_icon_icon-bubble{width:26px;height:26px;opacity:1;transform:translate(-50%, -50%) rotate(0deg) scale(1)}.widget_icon .widget_icon_icon-x{height:16px;width:16px;opacity:0;transform:translate(-50%, -50%) rotate(-90deg) scale(0.8)}.widget_icon.open .widget_icon_icon-bubble{opacity:0;transform:translate(-50%, -50%) rotate(90deg) scale(0.8)}.widget_icon.open .widget_icon_icon-x{opacity:1;transform:translate(-50%, -50%) rotate(0deg) scale(1)}\n",""]),e.exports=t},function(e,t,n){var r=n(320);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(11)(r,o);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=n(10)(!1)).push([e.i,"@import url(https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@200;300;400;500;600;700&display=swap);"]),t.push([e.i,".widget_container{background:#fff;border-radius:4px;border:none;box-shadow:0 13px 33px 0 rgba(59,63,72,0.2);display:flex;flex-direction:column;height:440px;overflow:hidden;opacity:0;transform:translateY(10px);transition:opacity 300ms, transform 300ms;margin-bottom:8px}.widget_container.fade-in-up{opacity:1;transform:translateY(0)}.widget_welcome_message_wrapper+.widget_container{transition:opacity 300ms 150ms, transform 300ms 150ms}\n",""]),e.exports=t},function(e,t,n){var r=n(322);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(11)(r,o);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=n(10)(!1)).push([e.i,".widget_welcome_message_avatar{width:48px;height:48px;border-radius:100%;overflow:hidden;flex-shrink:0;margin-right:8px;align-self:flex-start;background-size:cover;background-position:center}\n",""]),e.exports=t},function(e,t,n){var r=n(324);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(11)(r,o);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=n(10)(!1)).push([e.i,".widget_welcome_message_content{max-width:400px;line-height:24px;font-size:16px;display:inline-flex;align-items:center;box-shadow:0 4px 8px 0 rgba(0,0,0,0.15);padding:16px;text-align:left;cursor:pointer;outline:0;border:0}.widget_welcome_message_title{font-weight:600;word-break:break-word}.widget_welcome_message_title+.widget_welcome_message_body{margin-top:8px;word-break:break-word}\n",""]),e.exports=t},function(e,t,n){var r=n(326);"string"==typeof r&&(r=[[e.i,visibility:visible;opacity:1;transition:visibility 1ms, opacity 200ms 1ms ease}\n",""]),e.exports=t},function(e,t,n){var r=n(328);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(11)(r,o);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=n(10)(!1)).push([e.i,"@import url(https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@200;300;400;500;600;700&display=swap);"]),t.push([e.i,".widget_welcome_message{display:flex;flex-direction:column;align-items:flex-end;position:absolute;left:auto;right:0;bottom:60px;margin-bottom:8px;width:400px}#conversations-app.conversationChatPositionBottomLeft .widget_welcome_message{align-items:flex-start;left:0;right:auto}.widget;O<=x.length-1;O++)if(A.push(x[O]),A.length===b)return A;w=E=C}}return A.push(p.slice(E)),A}]}),!g)},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototi):null;a&&(a.get||a.set)?Object.defineProperty(nion s(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||("Cannot call a class as a function")}(this,e),this.type="i18nFormat",this.mem={},this.init(null,t)}var t,n,r;return t=e,(n=[{key:"init",value:function(e,t){var n=this,r=e&&e.options&&e.options.i18nFormat||{};if(this.options=i.defaults(r,t,this.options||{},{memoize:!0,memoizeFallback:!1,bindI18n:"",bindI18nStore:""}),this.formats=this.options.formats,e){var o=this.options,s=o.bindI18n,u=o.bindI18nStore,c=o.memoize;e.IntlMessageFormat=a.default,e.ICU=this,c&&(s&&e.on(s,(function(){return n.clearCache()})),u&&e.store.on(u,(function(){return n.clearCache()})))}this.options.localeData&&("[object Array]"===Object.prototype.toString.apply(this.options.localeData)?this.options.localeData.forEach((function(e){return n.addLocaleData(e)})):this.addLocaleData(this.options.localeData))}},{key:"addt.prototype.toString.apply(e)?e:[e]).forEach((function(e){e&&e.locale&&a.default.__addLocaleData(e)}))}},{key:"addUserDefinedFormats",value:function(e){this.formats=this.formats?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this.formats,{},e):e}},{key:"parse",value:function(e,t,n,r,o,s){var u,c=s&&s.resolved&&s.resolved.res,l=this.options.memoize&&"".concat(n,".").concat(r,".").concat(o.replace(/\./g,"###"));return this.options.memoize&&(u=i.getPath(this.mem,l)),u||(u=new a.default(e,n,this.formats),this.options.memoize&&(thi|c)&&i.setPath(this.mem,l"addLookupKeys",value:function(e,t,n,r,o){return e}},{key:"clearCache",value:function(){this.mem={}}}])&&l(t.prototype,n),r&&l(t,r),e}();f.type="i18nFormat";var p=f;t.default=p},function(e,t,n){"use strict";function r(e,t,n){function r(e){return e&&e.indexOf("###")>-1?e.replace(/###/g,"."):e}function o(){return!e||"string"==typeof e}for(var i="string"!=typeof t?[].concat(t):t.split(".");i.length>1;){if(o())return{};var a=r(i.shift());!e[a]&&n&&(e[a]=new n),e=e[a]}return o()?{}:{obj:e,k:r(i.shift())}}Object.defineProperty(t,"__esModule",{value:!0}),t.setPath=function(e,t,n){var o=r(e,t,Object),i=o.obj,a=o.k;i[a]=n},t.pushPath=function(e,t,n,o){var i=r(e,t,Object),a=i.obj,s=i.k;a[s]=a[s]||[],o&&(a[s]=a[s].concat(n));o||a[s].push(n)},t.getPath=function(e,t){var n=r(e,t),o=n.obj,i=n.k;return o?o[i]:void 0},t.defaults=function(e){return i.call(a.call(arguments,1),(function(t){if(t)for(var n in t)void 0===e[n]&&(e[n]=t[n])})),e},t.extend=function(e){return i.call(=i&&11!=a?"one":2==i&&12!=a?"two":3==i&&13!=a?"few":"other":1==e&&r?"one":"other"}}}0),O(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.defa,u=p(n(357)),c=p(n(358)),l=p(n(359)),f=p(n(360));function p(e){return e&&e.__esModule?e:{default:e}}function drguments[1]?arguments[1]:{};dctor(u.default),this.addDetector(c.default),this.addDetector(l.default),this.addDetector(f.default)}},{key:"addDetector",value:function(e){this.detectors[ctors[e]){var r=t.detectors[e.formatLanguageCode(e);t.options.checkWhitelist&&!t.services.languageUtils.isWhitelisted(n)||(r=n)}})),!r){var o=this.i18nOptions.fallbackLng;"string"==typeof o&&(o=[o]),o||(o=[]),r="[object Array]"===Object.protxOf(e)>-1||t.forEach((function(t){n.detectors[ti.call(arguments,1),(function(t){if(t)for(var n in t)e[n]=t[n]})),e};var r=[],o=r.foex0);)o=o.substring(1,o.length);ift=void 0;if(e.lookt){t.lookupCookie&&"undefined"!=typeof document&&r(t.lookupCookie,e,t.cookieMinutes,t.cookieDomain)}}},function(e,t,n[rnguage:function(e,t){t.lookupLocalStorage&&r&&window.localStorage.setItem(t.lookupLocalStorage,e)}}},function(e,th(navigator.userLanguage),navigator.language&&t.push(navigator.language)}return t.length>0?t:void 0}}},function(eent.documentElement:null);return n&&"function"==typeof n.getAttribute&&(t=n.getAttribute("lang")),t}}},functioomPathIndex])return;t=n[e.lookupFromPathIndex].replace("/","")}else t=n[0].replace("/","")}return t}}},function(e,t//_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=i,e.exports=o,o.id=361},function(e){e.exports=JSON.parse('{"conversation":{"historyTitle":"{companyName} История на разговора","startDate":"Начало на разговора {startDate}","urlLabel":"Вижте разговора на","selfDisplayName":"Вие","chat":{"placeholder":"Напишете Вашето съобщение тук","brandingText":"Разговори по","byText":"Разговори по","emailLabel":"Имейл адрес","phoneLabel":"Телефонен номер","accountLabel":"Име на организацията","nameLabel":"Пълно име","emailPlaceHolder":"Напишете тук","offline":"Извън линия","send":"Изпращане","submit":"Изпращане","validEmail":"Моля, въведете валиден имейл","typing":{"one":"{name} пише","two":"{name1} и {name2} пишат","many":"{name1}, {name2} и други лица пишат"}}}}')},function(e){e.exports=JSON.parse('{"conversation":{"historyTitle":"{companyName} – historie konverzace","startDate":"Konverzace byla zahájena {startDate}","urlLabel":"Zobrazte chat v","selfDisplayName":"Vy","chat":{"placeholder":"Sem napište svou zprávu","brandingText":"Konverzace od","byText":"Konverzace od","emailLabel":"E-mailová adresa","phoneLabel":"Telefonní číslo","accountLabel":"Název organizace","nameLabel":"Celé jméno","emailPlaceHolder":"Sem napište text","offline":"Offline","send":"Poslat","submit":"Odeslat","validEmail":"Zadejte prosím platný e-mail","typing":{"one":"{name} právě píše","two":"{name1} a {name2} právě píšou","many":"{name1}, {name2} a další právě píšou"}}}}')},function(e){e.exports=JSON.parse('{"conversation":{"historyTitle":"{companyName} Samtalehistorik","startDate":"Samtale startet {startDate}","urlLabel":"Vis chat hos","selfDisplayName":"Dig","chat":{"placeholder":"Indtast din besked her","brandingText":"Samtaler med","byText":"Samtaler med","emailLabel":"E-mailadresse","phoneLabel":"Telefonnummer","organizationLabel":"Organisationsnavn","nameLabel":"Fulde navn","emailPlaceHolder":"Indtast her","offline":"Offline","send":"Send","submit":"Indsend","validEmail":"Angiv en gyldig e-mailadresse","typing":{"one":"{name} indtaster","two":"{name1} og {name2} indtaster","many":"{name1}, {name2} og andre indtaster"}}}}')},function(e){e.exports=JSON.parse('{"conversation":{"historyTitle":"Unterhaltungsverlauf von {companyName}","startDate":"Unterhaltung am {startDate} begonnen","urlLabel":"Chat ansehen bei","selfDisplayName":"Sie","chat":{"placeholder":"Geben Sie hier Ihre Nachricht ein.","brandingText":"Unterhaltungen von","byText":"Unterhaltungen von","emailLabel":"E-Mail-Adresse","phoneLabel":"Telefonnummer","accountLabel":"Organisationsname","nameLabel":"Vollständiger Name","emailPlaceHolder":"Hier tippen","offline":"Offline","send":"Senden","submit":"Abschicken","validEmail":"Bitte eine gültige E-Mail-Adresse eingeben","typing":{"one":"{name} schreibt","two":"{name1} und {name2} schreiben","many":"{name1}, {name2} und andere schreiben"}}}}')},function(e){e.exports=JSON.parse('{"conversation":{"historyTitle":"{companyName} Conversation History","startDate":"Conversation started {startDate}","urlLabel":"View chat at","selfDisplayName":"You","chat":{"placeholder":"Type your message here","brandingText":"Conversations by","byText":"Conversations by","emailLabel":"Email Address","phoneLabel":"Phone Number","accountLabel":"Organization Name","nameLabel":"Full Name","selectDate":"Select Date","selectTime":"Select Time","emailPlaceHolder":"Type here","offline":"Offline","send":"Send","submit":"Submit","typing":{"one":"{name} is typing","two":"{name1} and {name2} are typing","many":"{name1}, {name2}, and others are typing"}},"preview":{"page-title":"Chatbot Automation Preview"}},"validation":{"account":"Please enter organization name.","email":"Please enter a valid email.","name":"Please enter name.","phone":"Please enter phone number."}}')},function(e){e.exports=JSON.parse('{"conversation":{"historyTitle":"{companyName} Conversation History","startDate":"Conversation started {startDate}","urlLabel":"View chat at","selfDisplayName":"You","chat":{"placeholder":"Type your message here","brandingText":"Conversations by","byText":"Conversations by","emailLabel":"Email Address","phoneLabel":"Phone Number","accountLabel":"Organisation Name","nameLabel":"Full Name","emailPlaceHolder":"Type here","offline":"Offline","send":"Send","submit":"Submit","validEmail":"Please enter a valid email","typing":{"one":"{name} is typing","two":"{name1} and {name2} are typing","many":"{name1}, {name2}, and others are typing"}}}}')},function(e){e.exports=JSON.parse('{"conversation":{"historyTitle":"{companyName} Conversation History","startDate":"Conversation started {startDate}","urlLabel":"View chat at","selfDisplayName":"You","chat":{"placeholder":"Type your message here","brandingText":"Conversations by","byText":"Conversations by","emailLabel":"Email Address","phoneLabel":"Phone Number","accountLabel":"Organization Name","nameLabel":"Full Name","emailPlaceHolder":"Type here","offline":"Offline","send":"Send","submit":"Submit","validEmail":"Please enter a valid email.","typing":{"one":"{name} is typing","two":"{name1} and {name2} are typing","many":"{name1}, {name2}, and others are typing"}}}}')},function(e){e.exports=JSON.parse('{"conversation":{"historyTitle":"{companyName} Conversation History","startDate":"Conversation started {startDate}","urlLabel":"View chat at","selfDisplayName":"You","chat":{"placeholder":"Type your message here","brandingText":"Conversations by","byText":"Conversations by","emailLabel":"Email Address","phoneLabel":"Phone Number","accountLabel":"Organization Name","nameLabel":"Full Name","selectDate":"Select Date","selectTime":"Select Time","emailPlaceHolder":"Type here","offline":"Offline","send":"Send","submit":"Submit","typing":{"one":"{name} is typing","two":"{name1} and {name2} are typing","many":"{name1}, {name2}, and others are typing"}},"preview":{"page-title":"Chatbot Automation Preview"}},"validation":{"account":"Please enter organization name.","email":"Please enter a valid email.","name":"Please enter name.","phone":"Please enter phone number."}}')},function(e){e.exports=JSON.parse('{"conversation":{"historyTitle":"Historial de conversación de {companyName}","startDate":"Conversación empezada el día {startDate}","urlLabel":"Ver chat en","selfDisplayName":"Tú","chat":{"placeholder":"Escribe aquí tu mensaje","brandingText":"Conversaciones por","byText":"Conversaciones por","emailLabel":"Dirección de correo electrónico","phoneLabel":"Número de teléfono","accountLabel":"Nombre de organización","nameLabel":"Nombre completo","emailPlaceHolder":"Escribe aquí","offline":"Desconectado","send":"Enviar","submit":"Enviar","validEmail":"Por favor, introduce un email válido","typing":{"one":"{name} está escribiendo","two":"{name1} y {name2} están escribiendo","many":"{name1}, {name2} y otros están escribiendo"}}}}')},function(e){e.exports=JSON.parse('{"conversation":{"historyTitle":"Yrityksen {{companyName}} keskusteluhistoria","startDate":"Keskustelu alkoi {{startDate}}","urlLabel":"Näytä chatti kohteessa","selfDisplayName":"Sinä","chat":{"placeholder":"Kirjoita viestisi tähän","brandingText":"Keskustelut kohteelta","byText":"Keskustelut kohteelta","emailLabel":"Sähköpostiosoite","phoneLabel":"Puhelinnumero","accountLabel":"Organisaation nimi","nameLabel":"Koko nimi","emailPlaceHolder":"Kirjoita tähän","offline":"Offline","send":"Lähetä","submit":"Lähetä","validEmail":"Anna toimiva sähköposti","typing":{"one":"{name} kirjoittaa","two":"{name1} ja {name2} kirjoittavat","many":"{name1}, {name2} ja muut kirjoittavat"}}}}')},function(e){e.exports=JSON.parse('{"conversation":{"historyTitle":"Historique de conversations de {companyName}","startDate":"Conversation démarrée le {startDate}","urlLabel":"Voir le chat à","selfDisplayName":"Vous","chat":{"placeholder":"Saisissez votre message ici","brandingText":"Conversations de","byText":"Conversations de","emailLabel":"Adresse e-mail","phoneLabel":"Numéro de téléphone","accountLabel":"Nom de l\'organisation","nameLabel":"Nom complet","emailPlaceHolder":"Saisissez ici","offline":"Hors ligne","send":"Envoyer","submit":"Soumettre","validEmail":"Veuillez saisir un e-mail valide","typing":{"one":"{name} est en train de taper","two":"{name1} et {name2} sont en train de taper","many":"{name1}, {name2}, et d\'autres sont en train de taper"}}}}')},function(e){e.exports=JSON.parse('{"conversation":{"historyTitle":"Historique de conversation de {companyName}","startDate":"Conversation commencée le {startDate}","urlLabel":"Consultez le chat sur","selfDisplayName":"Vous","chat":{"placeholder":"Saisissez votre message ici","brandingText":"Conversations de","byText":"Conversations de","emailLabel":"Adresse e-mail","phoneLabel":"Numéro de téléphone","accountLabel":"Nom de l\'organisation","nameLabel":"Nom complet","emailPlaceHolder":"Rédigez ici","offline":"Hors ligne","send":"Envoyer","submit":"Soumettre","validEmail":"Veuillez saisir un e-mail valide","typing":{"one":"{name} est en train de taper","two":"{name1} et {name2} sont en train de taper","many":"{name1}, {name2} et d\'autres sont en train de taper"}}}}')},function(e){e.exports=JSON.parse('{"conversation":{"historyTitle":"{companyName} beszélgetés előzményei","startDate":"Beszélgetés kezdete: {startDate}","urlLabel":"Chat megtekintése itt:","selfDisplayName":"Te","chat":{"placeholder":"Ide írd az üzeneted","brandingText":"Beszélgetések itt:","byText":"Beszélgetések itt:","emailLabel":"E-mail-cím","phoneLabel":"Telefonszám","accountLabel":"Szervezet neve","nameLabel":"Teljes név","emailPlaceHolder":"Írj ide","offline":"Offline","send":"Küldés","submit":"Elküldés","validEmail":"Érvényes e-mail címet adj meg.","typing":{"one":"{name} éppen ír","two":"{name1} és {name2} éppen ír","many":"{name1}, {name2} és mások éppen írnak"}}}}')},function(e){e.exports=JSON.parse('{"conversation":{"historyTitle":"Riwayat Percakapan {companyName}","startDate":"Percakapan dimulai {startDate}","urlLabel":"Lihat obrolan di","selfDisplayName":"Anda","chat":{"placeholder":"Ketikkan pesan di sini","brandingText":"Percakapan oleh","byText":"Percakapan oleh","emailLabel":"Alamat Email","phoneLabel":"Nomor Telepon","accountLabel":"Nama Organisasi","nameLabel":"Nama Lengkap","emailPlaceHolder":"Ketikkan di sini","offline":"Offline","send":"Kirim","submit":"Kirim","validEmail":"Masukkan alamat email yang benar","typing":{"one":"{name} sedang mengetik","two":"{name1} dan {name2} sedang mengetik","many":"{name1}, {name2}, dan lainnya sedang mengetik"}}}}')},function(e){e.exports=JSON.parse('{"conversation":{"historyTitle":"Cronologia conversazioni {{companyName}}","startDate":"Conversazione avviata il {{startDate}}","urlLabel":"Visualizza chat su","selfDisplayName":"Tu","chat":{"placeholder":"Inserisci il messaggio qui","brandingText":"Conversazioni di","byText":"Conversazioni di","emailLabel":"Indirizzo email","phoneLabel":"Numero di telefono","accountLabel":"Nome dell\'organizzazione","nameLabel":"Nome e cognome","emailPlaceHolder":"Scrivi qui","offline":"Offline","send":"Invia","submit":"Invia","validEmail":"Inserisci un indirizzo e-mail valido","typing":{"one":"{name} sta scrivendo","two":"{name1} e {name2} stanno scrivendo","many":"{name1}, {name2} e altri stanno scrivendo"}}}}')},function(e){e.exports=JSON.parse('{"conversation":{"historyTitle":"Gespreksgeschiedenis voor {{companyName}}","startDate":"Gesprek gestart op {{startDate}}","urlLabel":"Bekijk chat op","selfDisplayName":"U","chat":{"placeholder":"Typ hier uw bericht","brandingText":"Gesprekken door","byText":"Gesprekken door","emailLabel":"E-mailadres","phoneLabel":"Telefoonnummer","accountLabel":"Organisatienaam","nameLabel":"Volledige naam","emailPlaceHolder":"Typ hier","offline":"Offline","send":"Verzenden","submit":"Verzenden","validEmail":"Voer een geldig e-mailadres in","typing":{"one":"{name} is bezig met typen","two":"{name1} en {name2} zijn bezig met typen","many":"{name1}, {name2} en anderen zijn bezig met typen"}}}}')},function(e){e.exports=JSON.parse('{"conversation":{"historyTitle":"Gespreksgeschiedenis voor {{companyName}}","startDate":"Gesprek gestart op {{startDate}}","urlLabel":"Bekijk chat op","selfDisplayName":"U","chat":{"placeholder":"Typ hier uw bericht","brandingText":"Gesprekken door","byText":"Gesprekken door","emailLabel":"E-mailadres","phoneLabel":"Telefoonnummer","accountLabel":"Organisatienaam","nameLabel":"Volledige naam","emailPlaceHolder":"Typ hier","offline":"Offline","send":"Verzenden","submit":"Verzenden","validEmail":"Voer een geldig e-mailadres in","typing":{"one":"{name] typt","two":"{name1} en {name2} typen","many":"{name1}, {name2} en anderen typen"}}}}')},function(e){e.exports=JSON.parse('{"conversation":{"historyTitle":"Gespreksgeschiedenis voor {{companyName}}","startDate":"Gesprek gestart op {{startDate}}","urlLabel":"Bekijk chat op","selfDisplayName":"U","chat":{"placeholder":"Typ hier uw bericht","brandingText":"Gesprekken door","byText":"Gesprekken door","emailLabel":"E-mailadres","phoneLabel":"Telefoonnummer","accountLabel":"Organisatienaam","nameLabel":"Volledige naam","emailPlaceHolder":"Typ hier","offline":"Offline","send":"Verzenden","submit":"Verzenden","validEmail":"Voer een geldig e-mailadres in","typing":{"one":"{name} is aan het typen","two":"{name1} en {name2} zijn aan het typen","many":"{name1}, {name2} en anderen zijn aan het typen"}}}}')},function(e){e.exports=JSON.parse('{"conversation":{"historyTitle":"{companyName} Historia konwersacji","startDate":"Rozpoczęto konwersację {startDate}","urlLabel":"Wyświetl czat o","selfDisplayName":"Ty","chat":{"placeholder":"Wpisz wiadomość tutaj","brandingText":"Konwersacje","byText":"Konwersacje","emailLabel":"Adres e-mail","phoneLabel":"Numer telefonu","accountLabel":"Nazwa organizacji","nameLabel":"Imię i nazwisko","emailPlaceHolder":"Wpisz tutaj","offline":"Offline","send":"Wyślij","submit":"Prześlij","validEmail":"Wpisz prawidłowy e-mail","typing":{"one":"{name} pisze","two":"{name1} i {name2} piszą","many":"{name1}, {name2} i inni piszą"}}}}')},function(e){e.exports=JSON.parse('{"conversation":{"historyTitle":"Histórico de conversas de {companyName}","startDate":"Conversa iniciada em {startDate}","urlLabel":"Ver conversa em","selfDisplayName":"Você","chat":{"placeholder":"Digite sua mensagem aqui","brandingText":"Conversas de","byText":"Conversas de","emailLabel":"Endereço de e-mail","phoneLabel":"Número de telefone","accountLabel":"Nome da empresa","nameLabel":"Nome completo","emailPlaceHolder":"Digite aqui","offline":"Off-line","send":"Enviar","submit":"Enviar","validEmail":"Por favor, insira um e-mail válido","typing":{"one":"{name} está digitando","two":"{name1} e {name2} estão digitando","many":"{name1}, {name2} e outros estão digitando"}}}}')},function(e){e.exports=JSON.parse('{"conversation":{"historyTitle":"Histórico de conversas de {companyName}","startDate":"Conversa iniciada em {startDate}","urlLabel":"Ver conversa em","selfDisplayName":"Você","chat":{"placeholder":"Digite aqui sua mensagem","brandingText":"Conversas de","byText":"Conversas de","emailLabel":"Endereço de e-mail","phoneLabel":"Número de telefone","accountLabel":"Nome da organização","nameLabel":"Nome completo","emailPlaceHolder":"Digite aqui","offline":"Desligado","send":"Enviar","submit":"Enviar","validEmail":"Por favor, introduza um e-mail válido","typing":{"one":"{name} está a escrever","two":"{name1} e {name2} estão a escrever","many":"{name1}, {name2}, e outros estão a escrever"}}}}')},function(e){e.exports=JSON.parse('{"conversation":{"historyTitle":"История разговоров {companyName}","startDate":"Разговор начат {startDate}","urlLabel":"Посмотреть чат в","selfDisplayName":"Вы","chat":{"placeholder":"Введите здесь ваше сообщение","brandingText":"Разговоры между","byText":"Разговоры между","emailLabel":"Адрес электронной почты","phoneLabel":"Номер телефона","accountLabel":"Название организации","nameLabel":"Полное имя","emailPlaceHolder":"Введите здесь","offline":"Оффлайн","send":"Отправить","submit":"Отправить","validEmail":"Введите действительный адрес электронной почты","typing":{"one":"{name} печатает","two":"{name1} и {name2} печатают","many":"{name1}, {name2} и другие печатают"}}}}')},function(e){e.exports=JSON.parse('{"conversation":{"historyTitle":"{companyName} Zgodovina pogovorov","startDate":"Začetek pogovora {startDate}","urlLabel":"Ogled pogovora na","selfDisplayName":"Vi","chat":{"placeholder":"Tukaj vnesite sporočilo","brandingText":"Pogovori od","byText":"Pogovori od","emailLabel":"E-poštni naslov","phoneLabel":"Telefonska številka","accountLabel":"Ime organizacije","nameLabel":"Ime","emailPlaceHolder":"Vnesi tukaj","offline":"Odjavljen","send":"Pošlji","submit":"Potrdi","validEmail":"Prosimo, vnesite veljaven e-poštni naslov","typing":{"one":"{name} vnaša besedilo","two":"{name1} in {name2} vnašata besedilo","many":"{name1}, {name2} in drugi vnašajo besedilo"}}}}')},function(e){e.exports=JSON.parse('{"conversation":{"historyTitle":"{companyName} Zgodovina pogovorov","startDate":"Začetek pogovora {startDate}","urlLabel":"Ogled pogovora na","selfDisplayName":"Vi","chat":{"placeholder":"Tukaj vnesite sporočilo","brandingText":"Pogovori od","byText":"Pogovori od","emailLabel":"E-poštni naslov","phoneLabel":"Telefonska številka","accountLabel":"Ime organizacije","nameLabel":"Ime","emailPlaceHolder":"Vnesi tukaj","offline":"Odjavljen","send":"Pošlji","submit":"Potrdi","validEmail":"Prosimo, vnesite veljaven e-poštni naslov","typing":{"one":"{name} vnaša besedilo","two":"{name1} in {name2} vnašata besedilo","many":"{name1}, {name2} in drugi vnašajo besedilo"}}}}')},function(e){e.exports=JSON.parse('{"conversation":{"historyTitle":"{companyName} Историја разговора","startDate":"Разговор је почео {startDate}","urlLabel":"Погледајте ћаскање у","selfDisplayName":"Ви","chat":{"placeholder":"Унесите своју поруку овде","brandingText":"Разговори од стране","byText":"Разговори од стране","emailLabel":"Адреса е-поште","phoneLabel":"Број телефона","accountLabel":"Име организације","nameLabel":"Пуно име","emailPlaceHolder":"Унесите овде","offline":"Offline","send":"Пошаљи","submit":"Проследи","validEmail":"Молимо да унесеш важећу електронску адресу","typing":{"one":"{name} is typing","two":"{name1} and {name2} are typing","many":"{name1}, {name2}, and others are typing"}}}}')},function(e){e.exports=JSON.parse('{"conversation":{"historyTitle":"{companyName} Sohbet Geçmişi:","startDate":"Sohbet başlangıcı{startDate}","urlLabel":"Sohbeti şurada görüntüle","selfDisplayName":"Siz","chat":{"placeholder":"Mesajınızı buraya yazın","brandingText":"Görüşmeler","byText":"Görüşmeler","emailLabel":"Email Adresi","phoneLabel":"Telefon Numarası","accountLopacity:0;transform:translateY(10px)}.fade-in-up-out-enter-active{opacity:1;transform:translateY(0);transition:all 0.3s eut-exit{opacity:1;transfe;-wentext(nufunction(){function e(e,t){this.store=e,this.parentSub=t,this.unsubscribe=null,this.listeners=f,this.handleChangeWrapper=this.handleChangeWrapper.bind(this)}var t=e.prototype;return t.addNestedSub=function(e){return this.trySubscribe(),this.listeners.subscribe(e)},t.notifyNestedSubs=function(){this.listeners.notify()},t.handleChangeWrapper=function(){this.onStateChange&&this.onStateChange()},t.isSubscribed=function(){return Boolean(this.unsubscribe)},t.trySubscribe=function(){this.unsubscribe||(this.unsubscribe!= e=new d(u}))}),[u,t,U]);return Object(r.useMemo)((function(){retreateEleu==1/t:otion I(e,t,n){return g({}Props","initMergeProps"]),a=n(e,i),s=r(e,i),u=o(e,i);return(i.pure?U:B)(a,s,u,e,i)}function G(e,t,n){for(var r=t.length-1;r>=0;r--){var o=t[r](e);if(o)return o}return function(t,r){throw new Error("Invalid value of type "+typeof e+" for "+n+" argument when connecting component "+r.wrappedComponentName+".")}}function q(e,t){return e===t}function H(e){var t=void 0===e?{}:e,n=t.connectHOC,r=void 0===n?_:n,o=t.mapStateToPropsFactories,i=void 0===o?L:o,a=t.mapDispatchToPropsFactories,s=void 0===a?F:aoidry,f=void 0===l?z:l;return function(e,t,n,o){void 0===o&&(o={});var a=o,u=a.pure,l=void 0===u||u,p=a.arereOwnPropsEqual,v=void 0===h?D:h,y=a.areStatePropsEqu,["tatProme:funcdleStateChanges:Boolean(e),initMapStateToProps:C,initMapDispatchToProps:x,initMergeProps:O,pure:l,areStatesEqual:d,areOwnPropsSAGA_ANCll==eurne=function(e){return e&&ue(e.then&uetor:!0};return"undefined"!=typeof &(o=!0,t(a))))};n.cancel=ye,s[e]=n})),t.cancel=function(){o||(o=!0,n.forEach((function(e){return s[e].cancel()})))},s}freturn 0==nnel's Buf=e)&&n[X]&&se(t)&&dl])&e(e;r+ction qe(e){for(var t=arg",e)}function Ve(ection(e){ret function(t){return e&&e.tyake())} e=n;n=[{void 0=e[Y];uen){var r=function(e){c||o(s,s=r.task)}catch(e){n(e,!0)RK=function(e.detachedt=e.context,n=ee(o))return o;ve:!0turn e.isSagaIterat);et((function(){var t=kt(e,c,u.context,mt,l,s,void 0);s?n(t):t.isRunning()?(u.queue.addTask(t),n(t)):t.isAborted()?u.queue.abort(t.error()):n(t)}))},gt.JOIN=function(e,t,n,r){var o=r.task,i=function(e,t){if(e.isRunning()){var n={task:o,cb:t};t.cancel=functpush(n)}else e.isAborted()?t(e.error(),!0):t(e.result())};if(le(t)){if(0===t.length)return void n([]);var a=Pe(t,n);t.forEach((function(e,t){i(e,a[t])}))}else i(t,n)},gnction ar g=t.apply(void 0,d);var m,v=vt();if(u&&(u.rootSagaStarted=u.rootSagaStarted||ye,u.effectTriggered=u.effectTriggered||ye,u.effectResolved=u.effectResolved||ye,u.effectRejected=u.effectRejected||ye,u.effectCancelled=u.effectCancelled||ye,u.actionDispatched=u.actionDispatched||ye,u.rootSagaStarted({effectId:v,saga:t,args:d})),c){var y=Ke.apply(void 0,c);m=function(e){return function(t,n,r){return y((function(t){return e(t,n,r)}))(t)}}}else m=be;var b={channel:r,dispatch:_e(o),getState:i,sagaMonitor:u,onError:f,finalizeRunEffect:m};return et((function(){var e=kt(b,g,s,v,Me(t),!0,void 0);return u&&u.effectResolved(v,e),e}))}var Tt,Dt=function(e){var t,n=void 0===e?{}:e,r=n.context,o=void 0===r?{}:r,i=n.channel,a=void 0===i?dt():i,s=n.sagaMonitor,u=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(n,["context","channel","sagaMonitor"]);function c(e){var n=e.getState,r=e.dispatch;return t=_t.bind(null,ie({},u,{context:o,channel:a,dispatch:r,getState:n,sagaMonitor:s})),function(e){return function(t){s&&s.actionDispatched&&s.actionDispatched(t);var n=e(t);return a.put(t),n}}}return c.run=function(){return t.apply(void 0,arguments)},c.setContext=function(e){Ee(o,e)},c},Rt=n(166),Pt=window.conversations,Mt={id:null!==(Tt=null==Pt?void 0:Pt.accountId)&&void 0!==Tt?Tt:""};n(27),n(51),n(14),n(18);function Nt(e){return{type:"agent/ADD_AGENTS",payload:e}}function Ft(e){return{type:"agent/ADD_Bt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},It=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=agents:[],agentIds:[],bots:[],botIds:[]},Bt=(n(66),n(197),n(94),n(23),n(122),"conversation/LOAD_MESSAGES"),Ut="conversation/SEND_MESSAGE",zt="conversation/SUBMIT_FORM";function Gt(e){return{type:"conversation/LOAD_CONVERSATION_SUCCEEDED",payload:e}}function qt(e){return{type:"conversation/LOAD_CONVERSATION_FAILED",payload:e}}function Ht(e){return{type:"conversation/CREATE_CONVERSATION_SUCCEEDED",payload:e}}functio_CONVERSATION_FAILED",payload:e}}function Wt(e){return{type:"conversation/INIT_CONVERSATION_WITH_UUID",payload:e}}function Kt(e){return{type:Bt,payload:e}}function Yt(e){return{type:"conversation/LOAD_MESSAGES_SUCCESS",payload:e}}function Qt(e){return{type:"conversation/LOAD_PAGINATED_MESSAGES_SUCCEEDED",payload:e}}function $t(e){return{type:"conversation/SET_TOTAL_MESSAGES",payload:e}}function Jt(e){return{type:Ut,payload:e}}function Xt(e){return{type:"conversation/SET_UNREAD_MESSAGE_COUNT",payload:e}}function Zt(e,t){return{type:"conversation/SUBMIT_FORM_FAILED",payload:{messagePartId:e,data:t}}}function en(e,t){return{type:"conversation/LOAD_REMOTE_MESSAGE",payload:{message:e,downloadUrl:t}}}function tn(e,t){return{type:"conversation/LOAD_REMOTE_MESSAGE_SUCCEEDED",payload:{message:e,body:t}}}function nn(e){return{type:"conversation/LOAD_REMOTE_MESSAGE_FAILED",payload:e}}function rn(e){return{type:"conversation/ADD_QUEUED_MESSAGE",payload:e}}var on=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r},an=function(e,t){var n=t.map((function(e){return e.id}));return on(e.filter((function(e){return-1===n.indexOf(e.id)})),t)},sn=(n(96),function(){return(sn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)}),un=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r},cn=function(e,t){return un(e.map((function(e){return sn(sn({},e),{response:null==t?void 0:t[e.id]})})))},ln=function(e,t,n){return sn(sn({},e),{properties:sn(sn({},e.properties),{options:cn(e.properties.options,n),hasResponse:!!n,isSubmitting:t})})},fn=function(e,t){return sn(sn({},e),{parts:e.parts.map((function(e){return"text"===e.type?sn(sn({},e),{properties:sn(sn({},e.properties),{text:t})}):e}))})},pn=function(e,t){var n=t.map((function(e){return e.id}));return e.map((function(e){if(-1===n.indexOf(e.id))return e;var r=t.find((function(t){return t.id===e.id}));return function(e,t){if(!t||e.id!==t.id)return e;var n=e.parts.find((function(e){return"text"===e.type})),r=t.parts.map((function(e){var t,r,o;switch(e.type){case"text":return sn(sn({},e),{properties:{html:null!==(t=e.properties.html)&&void 0!==t?t:n.properties.html,text:null!==(r=e.properties.text)&&void 0!==r?r:n.properties.text,downloadUrl:null!==(o=e.properties.downloadUrl)&&void 0!==o?o:n.properties.downloadUrl}});case"form":default:return e}}));return sn(sn({},t),{parts:r})}(e,r)}))},dn=function(){return(dn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},hn=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r},gn=function(e,t){return-1===e.indexOf(t.id)},mn=function(e,t){var n=new Date(e.createdAt).getTime()-new Date(t.createdAt).getTime();return 0==n?e.position-t.position:n},vn={loaded:!1,loadingMessages:!1,markingAllMessagesAsRead:!1,queuedMessages:[],messages:[],messageIds:[],totalMessages:0,messageToSend:null,sendingMessage:!1,typists:[],unreadMessageCount:0,conversation:null,loadingConversations:!1,loadedConversations:!1,loadingRemoteMessage:!1,hasFullConversation:!1,error:null};function yn(e){return{type:"events/QUEUE_EVENT",payload:e}}function bn(e){return{type:"events/SET_EVENT_PROCESSED",payload:e}}var En=function(){return(En=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},wn=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r},An={events:[],processedEvents:{}};function Cn(e){return{type:"settings/LOAD_SETTINGS_SUCCEEDED",payload:e}}function xn(e){return{type:"settings/LOAD_SETTINGS_FAILED",payload:e}}var On=function(){return(On=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(vareturn e}).apply(this,arguments)},Sn={settings:null,loading:!1,error:null},kn="visitor/TYPING";function _n(e){return{type:"visitor/LOAD_VISITOR_SUCCEEDED",payload:e}}function Tn(e){return{type:"visitor/LOAD_VISITOR_FAILED",payload:e}}var Dn,Rn=function(){return(Rn=Object.assign||function(e){for(var t,n=1,r=at=argum":ge(e)?String(e):ue(e)?e.name:String(e)}function Wn(e,t,n){var r,o,i,a=t;function s(t,n){if(a===Hn)return qn(t);if(n&&!o)throw a=Hn,n;r&&ll,e)}),n)}function Kn(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];var i,a={done:!1,value:je(e)},s=function(e){return{done:!1,value:qe.apply(void 0,[t].concat(r,[e]))}},u=function(e){return i=e};return Wn({q1:function(){return{nextState:"q2",effect:a,stateUpdater:u}},q2:function(){return{nextState:"q1",effect:s(i)}}},"q1","takeEvery("+Vn(e)+", "+t.name+")")}function Yn(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];var i,a,s={ffect:u(a),stateUpdater:l}},q3:function(){return{nextState:"q1",effect:u(a),stateUpdater:l}}},"q1","takeLatest("+Vn(e)+", "+t.name+")")}function Qn(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return qe.apply(void 0,[Kn,e,t].concat(r))}function $n(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return qe.apply(void 0,[Yn,e,t].concat(r))}n(204);var Jn=n(2),Xn=n.n(Jn),Zn=(n(102),n(103),n(167)),er=n.n(Zn);function tr(e){return(tr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var nr=function(){return(nr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.pro(e[o]=t[o]);returnjecar e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r};function ir(e){if(null==e)return e;if(Array.isArray(e))return e.map(ir);if("object"===tr(e)){var t={};return Object.keys(e).forEach((function(n){if(Object.prototype.hasOwnProperty.call(e,n)){var r=er.a.camelCase(n);t[r]=ir(e[n])}})),t}return e}function ar(e){if(!e||!e.id)return null;var t=e.attributes,n=e.relationships,r=e.id,o=rr(e,["attributes","relationships","id"]);return nr(nr(nr({id:r},ir(t)),function(e){if(null==e)return e;var t={};return Object.keys(e).forEach((function(n){var r=e[n];"object"===tr(r)&&r.data&&(t[n]=r.data)})),t}(n)),o)}function sr(e){return Object.keys(e).reduce((function(t,n){var r;return nr(nr({},t),((r={})[n]={data:e[n]},r))}),{})}function ur(e){return!!e.errors}n(35),n(46);var cr=function(e){return e.replace(/vgo_ee=[^&]+&?/,"").replace(/[?&]$/,"")},lr=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?n(e.value):o(e.value).then(a,s)}u((r=r.apply(e,t||[])).next())}))},fr=function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,i=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(!(a=u.trys,(a=0<a.length&&a[a.length-1])||6!==n[0]&&2!==n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};function pr(e,t){return Xn.a.post("/widget/messagePartResponse",{data:{attributes:{messagePartId:e,response:t}}})}function dr(e,t){return Xn.a.post("/widget/messagePartResponse",{data:{attributes:{messagePartId:e,response:t}}})}function hr(e){var t=e.sender,n=e.conversation,r={data:{id:e.id,type:"messages",attributes:{parts:e.parts},relationships:sr({sender:t,conversation:n})}};return Xn.a.post("/widget/messages",r).then((function(e){return e.data}))}function gr(e){return Xn.a.patch("/widget/conversations/"+e,{data:{id:e,type:"conversations",attributes:{visitor_unread_count:0}}}).then((function(e){return e.data}))}function mr(e,t){var n={data:{id:t,type:"conversations",attributes:{uuid:t,unread_count:0,additional_properties:{initiated_from_channel:"site",initiated_from_descrsitors"}}}}};return Xn.a.post("/widget/conversations",n).then((function(e){return e.data}))}function vr(){return lr(this,void 0,void 0,(function(){var e;return fr(this,(function(t){switch(t.label){case 0:return[4,Xn.a.get("/widget/conversations?sort=-created_at").then((function(e){return e.data}))];case 1:return(e=t.sent()).length?[2,e[0]]:[2,null]}}))}))}function yr(e){return lr(this,void 0,void 0,(function(){return fr(this,(function(){return[2,Xn.a.get("/widget/messages?include=sender&conversation="+e+"&sort=-created_at&page[limit]=20")]}))}))}function br(e,t){return lr(this,void 0,void 0,(function(){return fr(this,(function(){return[2,Xn.a.get("widget/messages?include=sender&conversation="+e+"&sort=-created_at&page[limit]=20&page[offset]="+t).then((function(e){return e.data}))]}))}))}var Er=function(e){return Xn()({url:e,headers:null}).then((function(e){return e.data}))},wr=(n(245),n(247),n(253),n(255),n(256),n(257),n(258),n(259),n(260),n(261),n(262),n(263),n(264),n(265),n(267),n(268),n(269),n(270),n(271),n(272),n(273),n(274),n(275),n(276),n(277),function(){var e=window.crypto||window.msCrypto;return e?"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(function(t){return(t^e.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)})):""}),Ar=function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,i=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(!(a=u.trys,(a=0<a.length&&a[a.length-1])||6!==n[0]&&2!==n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};function Cr(e){var t;return Ar(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,4]),[4,Ge(pr,e.payload.messagePartId,e.payload.response)];case 1:return n.sent(),[3,4];case 2:return t=n.sent(),[4,Be(Zt(e.payload.messagePartId,t.message))];case 3:return n.sent(),[3,4];case 4:return[2]}}))}function xr(e){var t,n;return Ar(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,7]),t=e.payload,[4,Ve((function(e){return e.conversation.conversation}))];case 1:return r.sent()?[2]:[4,Be(Wt(n=wr()))];case 2:return r.sent(),[4,Ge(mr,t,n)];case 3:return[4,Be(Ht(r.sent()))];case 4:return r.sent(),[3,7];case 5:return[4,Be(Vt(r.sent().message))];case 6:return r.sent(),[3,7];case 7:return[2]}}))}function Or(e){var t,n;return Ar(this,(function(r){switch(r.label){case 0:return r.trys.push([0,6,,7]),t=e.payload,[4,Ve((function(e){return e.conversation.conversation}))];case 1:return(n=r.sent())?[3,3]:[4,Be(rn(t))];case 2:return r.sent(),[2];case 3:return t.conversation.id=n.id,[4,Ge(hr,t)];case 4:return r.sent(),[4,Be({type:"conversation/SEND_MESSAGE_SUCCEEDED"})];case 5:return r.sent(),[3,7];case 6:return r.sent(),[3,7];c(this,(function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,Ve((function(e){return e.conversation.conversation}))];case 1:return t.sent()?[4,Ge(dr,e.payload.messagePartId,e.payload.response)]:[2];case 2:return t.sent(),[3,4];case 3:return t.sent(),[3,4];case 4:return[2]}}))}function kr(){var e;return Ar(this,(function(t){switch(t.label){case 0:return t.trys.push([0,5,,7]),[4,Ge(vr)];case 1:return[4,Be(Gt(e=t.sent()))];case 2:return t.sent(),e?[4,Be(Kt(e.id))]:[3,4];case 3:t.sent(),t.label=4;case 4:return[3,7];case 5:return[4,Be(qt(t.sent().message))];case 6:return t.sent(),[3,7];case 7:return[2]}}))}function _r(e){var t,n,r,o,i,a,s,u;return Ar(this,(function(c){switch(c.label){case 0:return c.trys.push([0,13,,14]),[4,Ge(yr,e.payload)];case 1:return t=c.sent(),(n=null===(u=t.meta)||void 0===u?void 0:u.page.total)?[4,Be($t(n))]:[3,3];case 2:c.sent(),c.label=3;case 3:return[4,Be(Yt(t.data))];case 4:c.sent(),r=0,c.label=5;case 5:return r<t.data.length?(o=t.data[r].parts[0].properties).downloadUrl?[4,Be(en(t.data[r],o.downloadUrl))]:[3,7]:[3,8];case 6:c.sent(),c.label=7;case 7:return r+=1,[3,5];case 8:return i=t.included,a=i.filter((function(e){return e.type&&"agents"===e.type})),s=i.filter((function(e){return e.type&&"bots"===e.type})),a.length?[4,Be(Nt(a))]:[3,10];case 9:c.sent(),c.label=10;case 10:return s.length?[4,Be(Ft(s))]:[3,12];case 11:c.sent(),c.label=12;case 12:return[3,14];case 13:return c.sent(),[3,14];case 14:return[2]}}))}function Tr(e){return Ar(this,(function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,Ge(br,e.payload.conversationId,e.payload.offset)];case 1:return[4,Be(Qt(t.sent()))];case 2:return t.sent(),[3,4];case 3:return t.sent(),[3,4];case 4:return[2]}}))}function Dr(){var e,t;return Ar(this,(function(n){switch(n.label){case 0:return n.trys.push([0,5,,6]),[4,Ve((function(e){return e.conversation}))];case 1:return e=n.sent(),(t=e.conversation)?[4,Be(Xt(0))]:[3,4];case 2:return n.sent(),[4,Ge(gr,t.id)];case 3:n.sent(),n.label=4;case 4:return[3,6];case 5:return n.sent(),[3,6];case 6:return[4,Be({type:"conversation/MARK_ALL_MESSAGES_AS_READ_SUCCESS"})];case 7:return n.sent(),[2]}}))}function Rr(e){var t,n,r;return Ar(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,5]),t=e.payload,[4,Ge(Er,t.downloadUrl)];case 1:return n=o.sent(),r=n.text?n.text:"",[4,Be(tn(t.message,r))];case 2:return o.sent(),[3,5];case 3:return[4,Be(nn(o.sent().message))];case 4:return o.sent(),[3,5];case 5:return[2]}}))}var Pr=function(){return Ar(this,(function(e){switch(e.label){case 0:return[4,Ue([$n(zt,Cr),$n("conversation/LOAD_CONVERSATION",kr),$n("conversation/CREATE_CONVERSATION",xr),$n("conversation/MARK_ALL_MESSAGES_AS_READ",Dr),$n(Bt,_r),$n("conversation/LOAD_PAGINATED_MESSAGES",Tr),Qn(Ut,Or),Qn("conversation/LOAD_REMOTE_MESSAGE",Rr),Qn("conversation/SEND_QUESTION_RESPONSE",Sr)])];case 1:return e.sent(),[2]}}))};function Mr(e){return Xn.a.post("/widget/visitorEvents",{data:{attributes:{event:e}}}).then((function(e){return e.data}))}var Nr=function(){return(Nr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Fr=function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,i=n[1],n=th&&a[a.length-1])||6!==n[0]&&2!==n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};function Lr(){var e,t;return Fr(this,(function(n){switch(n.label){case 0:return[4,Ve((function(e){var t;return null===(t=e.welcomeMessage.welcomeMessage)||void 0===t?void 0:t.id}))];case 1:return e=n.sent(),[4,Ve((function(e){return e.welcomeMessage.hidden}))];case 2:return t=n.sent(),[4,Be(yn({id:wr(),type:"widget",attributes:{action:"open"}}))];case 3:return n.sent(),!e||t?[3,5]:[4,Be(yn({id:wr(),type:"welcome_message",attributes:{id:e,action:"click"}}))];case 4:n.sent(),n.label=5;case 5:return[2]}}))}function Ir(){var e,t,n,r,o;return Fr(this,(function(i){switch(i.label){case 0:return[4,Ve((function(e){var t;return null===(t=e.conversation.conversation)||void 0===t?void 0:t.id}))];case 1:return e=i.sent(),[4,Ve((function(e){return e.events.events}))];case 2:t=i.sent(),n=0,r=t,i.label=3;case 3:return n<r.length?(o=r[n],[4,Ve((function(e){return e.events.processedEvents}))]):[3,8];case 4:return i.sent()[o.id]?[3,7]:[4,Be(bn(o))];case 5:return i.sent(),[4,Ge(Mr,Nr(Nr({},o),{conversation_id:e}))];case 6:i.sent(),i.label=7;case 7:return n++,[3,3];case 8:return[2]}}))}var jr,Br,Ur,zr=function(){return Fr(this,(function(e){switch(e.label){case 0:return[4,Ue([$n("events/OPEN_CHAT",Lr)])];case 1:return e.sent(),[4,Ue([$n("events/PROCESS_EVENTS",Ir)])];case 2:return e.sent(),[2]}}))},Gr=window.conversations;function qr(){return Xn.a.get("/widget/settings").then((function(e){return e.data}))}Xn.a.defaults.baseURL="https://conversations.app-us1.com/",Xn.a.defaults.headers.common["x-tracking-id"]=null!==(jr=null==Gr?void 0:Gr.visitorId)&&void 0!==jr?jr:"",Xn.a.defaults.headers.common["x-account-id"]=null!==(Br=null==Gr?void 0:Gr.accountId)&&void 0!==Br?Br:"",Xn.a.defaults.headers.common["x-email"]=null!==(Ur=null==Gr?void 0:Gr.email)&&void 0!==Ur?Ur:"",Xn.a.interceptors.response.use((function(e){return function(e){var t=e.data,n=t.data,r=t.included,o=t.meta,i={};return n?(i.data=Array.isArray(n)?or(n.map(ar)):ar(n),r&&(i.included=r.map(ar)),o&&(i.meta=o),i):e}(e)}));var Hr=function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,i=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(!(a=u.trys,(a=0<a.length&&a[a.length-1])||6!==n[0]&&2!==n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};function Vr(){var e;return Hr(this,(function(t){switch(t.label){case 0:return t.trys.push([0,5,,7]),[4,Ge(qr)];case 1:return ur(e=t.sent())?[4,Be(xn(e.errors[0].detail))]:[3,3];case 2:return t.sent(),[2];case 3:return[4,Be(Cn(e))];case 4:return t.sent(),[3,7];case 5:return[4,Be(xn(t.sent().message))];case 6:return t.sent(),[3,7];case 7:return[2]}}))}var Wr=function(){return Hr(this,(function(e){switch(e.label){case 0:return[4,$n("settings/LOAD_SETTINGS",Vr)];case 1:return e.sent(),[2]}}))};function Kr(e){return Xn.a.post("/widget/visitors",{data:{attributes:{email:e}}}).then((function(e){return e.data}))}var Yr=function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,i=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(!(a=u.trys,(a=0<a.length&&a[a.length-1])||6!==n[0]&&2!==n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};function Qr(e){var t;return Yr(this,(function(n){switch(n.label){case 0:return n.trys.push([0,5,,7]),[4,Ge(Kr,e.payload)];case 1:return ur(t=n.sent())?[4,Be(Tn(t.errors[0].detail))]:[3,3];case 2:return n.sent(),[2];case 3:return[4,Be(_n(t))];case 4:return n.sent(),[3,7];case 5:return[4,Be(Tn(n.sent().message))];case 6:return n.sent(),[3,7];case 7:return[2]}}))}var $r=function(){return Yr(this,(function(e){switch(e.label){case 0:return[4,Ue([$n("visitor/LOAD_VISITOR",Qr)])];case 1:return e.sent(),[2]}}))},Jr=function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,i=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(!(a=u.trys,(a=0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};function Xr(){var e,t,n;return Jr(this,(function(r){switch(r.label){case 0:return[4,Ve((function(e){return e.conversation.queuedMessages}))];case 1:return e=r.sent(),[4,Ve((function(e){return e.conversation.conversation}))];case 2:if(t=r.sent(),!e.length)return[3,8];n=0,r.label=3;case 3:return n<e.length?(e[n].conversation.id=t.id,[4,Be(Jt(e[n]))]):[3,6];case 4:r.sent(),r.label=5;case 5:return n+=1,[3,3];case 6:return[4,Be({type:"conversation/CLEAR_QUEUED_MESSAGES"})];case 7:r.sent(),r.label=8;case 8:return[2]}}))}var Zr=function(){return Jr(this,(function(e){switch(e.label){case 0:return[4,Ue([$n("websocket/SET_WEBSOCKET_CONNECTED",Xr)])];case 1:return e.sent(),[2]}}))},eo=function(e){return"conv-welcome-hidden-"+e};function to(){return Xn.a.get("/widget/welcomeMessages/allMatching").then((function(e){return e.data}))}function no(e){sessionStorage.setItem(eo(e),"1")}function ro(e){return"1"===sessionStorage.getItem(eo(e))}var oo=function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,i=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(!(a=u.trys,(a=0<a.length&&a[a.length-1])||6!==n[0]&&2!==n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(hrow n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};function io(){var e;return oo(this,(function(t){switch(t.label){case 0:return t.trys.push([0,6,,8]),[4,Ge(to)];case 1:return ur(e=t.sent())?[4,Be(In(e.errors[0].detail))]:[3,3];case 2:return t.sent(),[2];case 3:return[4,Be(Ln(e[0]))];case 4:return t.sent(),[4,Be(jn(e[0].id))];case 5:return t.sent(),[3,8];case 6:return[4,Be(In(t.sent().message))];case 7:return t.sent(),[3,8];case 8:return[2]}}))}function ao(e){return oo(this,(function(t){switch(t.label){case 0:return[4,Ge(no,e.payload)];case 1:return t.sent(),[2]}}))}function so(e){return oo(this,(functionayload)];case 1:return[4,Be(Bn(t.sent()))];case 2:return t.sent(),[2]}}))}var uo=function(){return oo(this,bel){case 0:return[4,Ue([$n("welcomeMessage/LOAD_WELCOME_MESSAGE",io),$n("welcomeMessage/HID/LOAD_WELCOME_MESSAGE_HIDDEN",so)])];case 1:return e.sent(),[2]}}))},co=function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,i=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(!(a=u.trys,(a=0<a.length&&a[a.length-1])||6!==n[0]&&2!==n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};var lo=Dt(),fo=Object(Rt.composeWithDevTools)({}),po=Object(R.combineReducers)({account:function(e){return void 0===e&&(e=Mt),e},agent:function(e,t){switch(void 0===e&&(e=jt),t.type){case"agent/ADD_AGENTS":var n=It(t.payload.filter((function(t){return-1===e.agentIds.indexOf(t.id)})));return Lt(Lt({},e),{agents:It(e.agents,n),agentIds:It(e.agentIds,n.map((function(e){return e.id})))});case"agent/ADD_BOTS":var r=It(t.payload.filter((function(t){return-1===e.botIds.indexOf(t.id)})));return Lt(Lt({},e),{bots:It(e.bots,r),botIds:It(e.botIds,r.map((function(e){return e.id})))});default:return e}},conversation:function(e,t){var n,r,o,i;switch(void 0===e&&(e=vn),t.type){case"conversation/LOAD_CONVERSATION":return dn(dn({},e),{loadingConversations:!0,hasFullConversation:!1});case"conversation/LOAD_CONVERSATION_SUCCEEDED":return dn(dn({},e),{loadingConversations:!1,loadedConversations:!0,conversation:t.payload,unreadMessageCount:null!==(r=null===(n=t.payload)||void 0===n?void 0:n.visitorUnreadCount)&&void 0!==r?r:0,hasFullConversation:!!t.payload});case"conversation/LOAD_CONVERSATION_FAILED":return dn(dn({},e),{loadingConversations:!1,loadedConversations:!1,error:t.payload,hasFullConversation:!1});case"conversation/CREATE_CONVERSATION":return dn(dn({},e),{loadingConversations:!0,hasFullConversation:!1});case"conversation/CREATE_CONVERSATION_SUCCEEDED":return dn(dn({},e),{loadingConversations:!1,loadedConversations:!0,conversation:t.payload,unreadMessageCount:null!==(i=null===(o=t.payload)||void 0===o?void 0:o.visitorUnreadCount)&&void 0!==i?i:0,hasFullConversation:!0});case"conversation/CREATE_CONVERSATION_FAILED":return dn(dn({},e),{loadingConversations:!1,loadedConversations:!1,error:t.payload,hasFullConversation:!1});case"conversation/INIT_CONVERSATION_WITH_UUID":return dn(dn({},e),{hasFullConversation:!1,conversation:{id:t.payload,visitorUnreadCount:0,createdAt:(new Dnts:[],messages:[]}});case Bt:return dn(dn({},e),{loadingMessages:!0});case"conversation/LOAD_MESSAGES_SUCCESS":return dn(dn({},e),{loadingMessages:!1,messages:hn(t.payload,e.messages).sort(mn),messageIds:hn(t.payload.map((function(e){return e.id})),e.messageIds)});case"conversation/LOAD_PAGINATED_MESSAGES":return dn(dn({},e),{loadingMessages:!0});case"conversation/LOAD_PAGINATED_MESSAGES_SUCCEEDED":var a=t.payload.filter(gn.bind(null,e.messageIds));return dn(dn({},e),{loadingMessages:!1,messages:hn(e.messages,a).sort(mn),messageIds:hn(e.messageIds,a.map((function(e){return e.id})))});case"conversation/SET_TOTAL_MESSAGES":return dn(dn({},e),{totalMessages:t.payload});case"conversation/MARK_ALL_MESSAGES_AS_READ":return dn(dn({},e),{markingAllMessagesAsRead:!0});case"conversation/MARK_ALL_MESSAGES_AS_READ_SUCCESS":return dn(dn({},e),{markingAllMessagesAsRead:!1});case Ut:return dn(dn({},e),{sendingMessage:!0,messageToSend:t.payload});case"conversation/SEND_MESSAGE_SUCCEEDED"case"conversation/SET_MESSAGES":var s=hn(t.payload),u=function(e,t){return e.reduce((function(e,n){return t(n)?[on(e[0],[n]),e[1]]:[e[0],on(e[1],[n])]}),[[],[]])}(s,(function(t){return-1!==e.messageIds.indexOf(t.id)})),c=u[0];a=u[1];return dn(dn({},e),{loadingMessages:!1,messages:hn(pn(e.messages,c),a).sort(mn),messageIds:hn(e.messageIds,a.map((function(e){return e.id}))),totalMessages:e.totalMessages+s.length});case"conversation/SET_PENDING_MESSAGE":return dn(dn({},e),{messages:hn(e.messages,[t.payload]).sort(mn),messageIds:hn(e.messageIds,[t.payload.id])});case"conversation/SET_TYPIST":return dn(dn({},e),{typists:an(e.typists,[t.payload])});case"conversation/SET_UNREAD_MESSAGE_COUNT":return dn(dn({},e),{unreadMessageCount:t.payload});case zt:return dn(dn({},e),{messages:e.messages.map((function(e){return dn(dn({},e),{parts:e.parts.map((function(e){return e.id===t.payload.messagePartId&&"form"===e.type?ln(e,!0):e}))})}))});case"conversation/ges:e.messages.map((function(e){return dn(dn({},e),{parts:e.parts.map((function(e){if(e.id!==t.payload.messagePartId)return e;if("form"!==e.type)return e;var n=t.payload.data,r=Object.keys(n).reduce((function(e,t){var r;return dn(dn({},e),((r={})[t]=n[t],r))}),{});return ln(e,!1,r)}))})}))});case"conversation/SUBMIT_FORM_FAILED":return dn(dn({},e),{messages:e.messages.map((function(e){return dn(dn({},e),{parts:e.parts.map((function(e){return e.id===t.payload.messagePartId&&"form"===e.type?ln(e,!1):e}))})})),error:t.payload.data});case"conversation/SEND_QUESTION_RESPONSE_SUCCEEDED":return dn(dn({},e),{messages:e.messages.map((function(e){return dn(dn({},e),{parts:e.parts.map((function(e){return e.id===t.payload.messagePartId&&"question"===e.type?dn(dn({},e),{properties:dn(dn({},e.properties),{hasResponse:!0,response:t.payload.response.response,displayResponse:t.payload.response.displayResponse||t.payload.response.response})}):e}))})}))});case"conversation/LOAD_REMOTE_MESSAGE":return dn(dn({},e),{loadingRemoteMessage:!0});case"conversation/LOAD_REMOTE_MESSAGE_SUCCEEDED":var l=function(e,t){return e.reduce((function(e,n){return null===e[0]&&t(n)?[n,e[1]]:[e[0],on(e[1],[n])]}),[null,[]])}(e.messages,(function(e){return e.id===t.payload.message.id})),f=l[0],p=l[1],d=fn(f||t.payload.message,t.payload.body);return dn(dn({},e),{loadingRemoteMessage:!1,messages:hn(p,[d]).sort(mn)});case"conversation/LOAD_REMOTE_MESSAGE_FAILED":return dn(dn({},e),{loadingRemoteMessage:!1,error:t.payload});case"conversation/ADD_QUEUED_MESSAGE":return dn(dn({},e),{queuedMessages:hn(e.queuedMessages,[t.payload])});case"conversation/CLEAR_QUEUED_MESSAGES":return dn(dn({},e),{queuedMessages:[]});default:return e}},events:function(e,t){var n;switch(void 0===e&&(e=An),t.type){case"events/QUEUE_EVENT":return En(En({},e),{events:wn(e.events,[t.payload])});case"events/CLEAR_EVENTS":return En(En({},e),{events:[]});case"events/SET_EVENT_PROCESSED":return En(En({},e),{processedEvents:En(En({},e.processedEvents),(n={},n[t.payload.id]=t.payload,n))});default:return e}},settings:function(e,t){switch(void 0===e&&(e=Sn),t.type){case"settings/LOAD_SETTINGS":return On(On({},e),{loading:!0});case"settings/LOAD_SETTINGS_SUCCEEDED":return On(On({},e),{loading:!1,settings:t.payload});case"settings/LOAD_SETTINGS_FAILED":return On(On({},e),{loading:!1,settings:null,error:t.payload});default:return e}},visitor:function(e,t){switch(void 0===e&&(e=Mn),t.type){case"visitor/LOAD_VISITOR":return Rn(Rn({},e),{loading:!0});case"visitor/LOAD_VISITunctnrn[4,Ue([qe(Pr),qe(zr),qe(Wr),qe($r),qe(Zr),qe(uo)])];case 1:return e.sent(),[2]}}))}));var go=ho;function mo(e,t){return e===t}function vo(e,t,n){if(null===t||null===n||t.length!==n.length)return!1;for(var r=t.length,o=0;o<r;o++)if(!e(t[o],n[o]))return!1;return!0}function yo(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every((function(e){return"function"==typeof e}))){var n=t.map((function(e){return typeof e})).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+n+"]")}return t}var bo=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];var i=0,a=r.pop(),s=yo(r),u=e.apply(void 0,[function(){return i++,a.apply(null,arguments)}].concat(n)),c=e((function(){for(var e=[],t=s.length,n=0;n<t;n++)e.push(s[n].apply(null,arguments));return u.apply(null,e)}));return c,r=n.n(Eo),Ao=n(41),Co=n.n(Ao)sar n=null(e){!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};No=Ro({},No,{},e)}(e.options.react),function(e){Po=e}(e)}};function zo(){if(console&&console.warn){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];"string"==typeof n[0]&&(n[0]="react-i18next:: ".concat(n[0])),(e=console).warn.apply(e,n)}}var Go={};function qo(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];"string"==typeof t[0]&&Go[t[0]]||("string"==typeof t[0]&&(Go[t[0]]=new Date),zo.apply(void 0,t))}function Ho(e,t,n){e.loadNamespaces(t,(function(){if(e.isInitialized)n();else{e.on("initialized",(function t(){setTimeout((function(){e.off("initialized",t)}),0),n()}))}}))}function Vo(e,t){if(!t.languages||!t.languages.length)return qo("i18n.languages were undefined or empty",t.languages),!0;var n=t.languages[0],r=!!t.options&&t.options.fallbackLng,o=t.languages[t.languages.length-1];if("cimode"===n.toLowerCase())return!0;var i=function(e,n){var r=t.services.backendConnector.state["".concat(e,"|").concat(n)];return-1===r||2===r};return!!t.hasResourceBundle(n,e)||(!t.services.backendConnector.backend||!(!i(n,e)||r&&!i(o,e)))}function Wo(e){return e.displayName||e.name||("string"==typeof e&&e.length>0?e:"Unknown")}var Ko=n(54),Yo=n.n(Ko);function Qo(e,t){var n=ertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescrach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Jo(e){]?arguments[1]:{},n=t.i18n,|u.initializedStoreOnce)&&d.every((function(e){return Vo(e,u)}));function g(){return{t:u.getFixedT(null,"fallback"===l.nsMode?d:d[0])}}var m=Object(r.useState)(g()),v=Yo()(m,2),y=v[0],b=v[1];Object(r.useEffect)((function(){var e=!0,t=l.bindI18n,n=l.bindI18nStore;function r(){e&&b(g())}return h||p||Ho(u,d,(function(){e&&b(g())})),t&&u&&u.on(t,r),n&&u&&u.store.on(n,r),function(){e=!1,t&&(" ").forEach((function(e){return u.store.off(e,r)}))}}),[d.join()]);var E=[y.t,u,h];if(E.t=y.t,E.i18n=u,E.ready=h,h)return E;if(!h&&!p)return E;throw new Promise((function(e){Ho(u,d,(function(){b(g()),e()}))}))}var Xo=n(171),Zo=n.n(Xo);function ei(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ti(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ei(n,!0).forEach((function(t){Oo()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ei(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ni(e){var t=argumen&(u.backgroundImage="url("+r+")"),o.a.createElem:oi.a})),o.a.createElement("div",{e:"widget_company-info_name"},t),o.a.createEl,a&&o.a.createElementn(e){for(var t=1;t<arguor(var r in n)i.length;r++)n=$/g,"")}var li=var n=t.prototxtCallback()},n.getTir&&(e=r.exit,t=ar:n}},n.updateStaelse this.props.unsafeSetSt)}))}))):this.safeSetState({status:"exited"},(function(){t.props.onExited(e)}))},n.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},n.setNextCallback=function(e){var t=t.props.addEndLisName?n.className=ci(n.className,r):n.setAt(e,r),t.addClasst.addClasrops.onExited(e)},t.getClassNames=function(e){var n=t.props.classNames,r="string"==typeof ClassName:o,activeClassName:r?o+"-active":n[e+"Active"],doneClassName:r?o+"-done":n[e+"Done"]}},t}ui(t,e);var n=t.prototype;return n.addClass=function(e,t,n){var r=this.getClassNames(t)[n+"ClassName"];"appear"===t&&"done"===n&&(r+=" "+this.getClassNames("enter").doneClassName),"active"===n&&e&&e.scrollTop,this.appliedClasses[t][n]=r,function(e,t){e&&t&&t.split(" ").forEach((function(t){return r=t,void((n=e).classList?n.classList.add(r):function(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")}(n,r)||("string"==typeof n.className?n.className=n.className+" "+r:n.setAttribute("class",(n.className&&n.className.baseVal||"")+" "+r)));var n,r}))}(e,rbase,o=n.active,i=n.done;this.appliedClasses[t]={},r&&gi(e,r),o&&gi(e,o),i&&gi(e,i)},n.render=funeturn o.a.createElement(hi,ai({},t,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},t}(o.a.Component);mi.defaultProps={classNames:""},mi.propTypes={};var vi,yi=mi,bi=(n(292),function(){return(new Date).toISOString()}),Ei=(vi=function(e,t){renction(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}vi(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),wi=function(){return(wi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function Ai(e){return!(null==e||!e.trim().length)}var Ci=function(e){function t(t){var n=e.call(this,t)||this;return n.onFocus=function(){n.setState((function(){return{composerHasFocus:!0}}))},n.onBlur=function(){n.setState((function(){return{composerHasFocus:!1}}))},n.didChangeBody=function(e){var t=e.target.value.replace(/\n/g,"");n.setText(t)},n.handleKeyDown=function(e){13===e.keyCode&&n.setState({shouldSendMessage:!0})},n.sendMessage=function(e){void 0===e&&(e=null),e&&e.preventDefault(),Ai(n.state.model.parts[0].properties.text)&&n.setState({shouldSendMessage:!0})},n.state={composerHasFocus:!1,shouldSendMessage:!1,model:{parts:[{id:"",type:"text",properties:{text:""}}]}},n.textarea=Object(r.createRef)(),n}return Ei(t,e),t.prototype.componentDidMount=function(){this.textarea.current&&this.textarea.current.focus()},t.prototype.componentDidUpdate=function(e,t){var n=this.state,r=n.shouldSendMessage,o=n.model,i=this.props,a=i.visitorStoppedTyping,s=i.visitorStartedTyping,u=i.typing;!t.shouldSendMessage&&r&&this.sendMessageAndReset(o),t.model.parts[0].properties.text!==o.parts[0].properties.text&&(u&&!o.parts[0].properties.text?a():!u&&o.parts[0].properties.text&&s())},t.prototype.setText=function(e){this.setState({model:{parts:[{id:"",type:"text",properties:{text:e}}]}})},t.prototype.createMessageToSend=function(e){var t=this.props,n=t.visitorId,r=t.conversationId;return{id:wr(),parts:e.parts,sender:{type:"visitors",id:n},conversation:{type:"conversations",id:r}}},t.prototype.sendMessageAndReset=function(e){var t=this.props,n=t.sendMessage,r=t.setPendingMessage;if(Ai(e.parts[0].properties.text)){var o=this.createMessageToSend(e);r(wi({position:0,pending:!0,createdAt:bi(),updatedAt:bi()},o)),n(o)}this.setState({shouldSendMessage:!1}),this.setText("")},t.prototype.render=function(){var e=this.props,t=e.color,n=e.t,r=this.state,i=r.composerHasFocus,a=r.model,s=a.parts[0]es.text:"",u=i?{boxShadow:"0 -2px 0 0 #"+t}:{},c=n("conversation.chat.placeholder"),l=!Ai(s);return o.a.createElement("form",{className:"widget_composer",style:u,onSubmit:this.sendMessage},o.a.createElement("div",{className:"widget_composer_wrap"},o.a.createElement("div",{className:"hidden-resizer"},s),o.a.createElement("textarea",{ref:this.textarea,id:"composer-textarea",placeholder:c+"...",value:s,onKeyDown:this.handleKeyDown,onChange:this.didChangeBody,onFocus:this.onFocus,onBlur:this.onBlur})),o.a.createElement(yi,{in:!l,timeout:200,classNames:"fade-in-out",mountOnEnter:!0,unmountOnExit:!0},o.a.createElement("button",{type:"submit",className:"widget_composer_send",style:{backgroundColor:"#"+(t||"f2f2f2")},disabled:l},n("conversation.chat.send"))))},t}(r.Component),xi=ni()(Ci),Oi=V((function(e,t){return{color:t.color,visitorId:e.visitor.visitor?e.visitor.visitor.id:"",typing:e.visitor.typing,conversationId:e.conversation.conversation?e.conversation.conversation.id:""}}),(function(e){return{sendMessage:function(t){e(Jt(t))},setPendingMessage:function(t){e(function(e){return{type:"conversation/SET_PENDING_MESSAGE",payload:e}}(t))},visitorStoppedTyping:function(){e({type:kn,payload:!1})},visitorStartedTyping:function(){e({type:kn,payload:!0})}}}))(xi),Si=(n(294),function(e){var t=e.chatBadgeCount,n=9>=t?""+t:"9+";return 0<t?o.a.createElement("div",{className:"widget_notification-badge"},o.a.createElement("span",{className:"widget_notification-badge_text"},n)):null}),ki=n(172),_i=n.n(ki),Ti=(n(296),function(e){var t=e.show,n=Jo().t;return t?o.a.createElement("div",{className:"widget_branding"},o.a.createElement("a",{className:"widget_branding_link",href:"https://www.activecampaign.com/customer-messaging/conversations",target:"_blank",rel:"noopener norefer"div",src:_i.a})))):null}),Di=(n(298),function(e){var t=e.typists,n=Jo().t,r=!!t.length;return o.a.createElement(yi,{in:r,timeout:{enter:200,exit:0},classNames:"fade-in-out",mountOnEnter:!0,unmountOnExit:!0},o.a.createElement("div",{className:"widget_typing-label"},function(e,t){switch(e.length){casyping.one",{name:e[0]});case 2:return t("conversation.chat.typing.two",{name1:e[0],name2:e[1]});default:return t("conversation.chat.typing.many",{name1:e[0],name2:e[1]})}}(t,n)))}),Ri=(n(300),n(82)),Pi=n.n(Ri),Mi=function(e){var t=e.part.properties;return t.text?o.a.createElement(Pin.n(Ni),Li=n(174),Ii=n.n(Li),ji=function(e){var t=e.color,n=e.onClick,r=e.showSpinner,i=Jo().t;return o.a.createElement("button",{className:"widget_messages_capture-form-message_submit",type:"submit",style:{backgroundColor:"#"+t},onClick:n},r?o.a.createElement(wo.a,{raw:!0,className:"spinner",element:"div",src:Ii.a}):i("conversation.chat.submit"))},Bi=n(56),Ui=n.n(Bi),zi=n(175);function Gi(){return(Gi=Object.assign||function(e){for(var t,n=1;n<arguments.length;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)}var qi=function(){return(qi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Hi={email:!0},Vi={phone:{type:"tel",pattern:"[0-9]{10}"},email:{type:"email",onKeyPress:function(e){32===e.charCode&&e.preventDefault()}},account:{},name:{}},Wi=function(e){var t=e.part,n=e.color,i=e.submitForm,a=Jo().t,s=Object(r.useContext)(na).scrollIntoView,u=t.properties,c=u.options.reduce((function(e,t){var n;return qi(qi({},e),((n={})[t.id]=t.response||"",n))}),{}),l=Object(r.useState)({email:!u.options.find((function(e){return"e,p=l[1],d=Object(r.useState)({}),h=d[0],g=d[1],m=Object(r.useState)(c),v=m[0],y=m[1],b=Object(r.useRef)(null),E=function(e){return function(t){var n,r;y(qi(qi({},v),((n={})[e]=t.target.value,n))),Hi[e]&&p(qi(qi({},f),((r={})[e]=t.target.validity.valid,r)))}},w=function(){g({});var e={},n=u.options.reduce((function(t,n){var r,o;return Hi[n.id]&&!f[n.id]?qi(qi({},e),((r={})[n.id]=a("validation."+n.id),r)):n.required&&!v[n.id].trim()?qi(qi({},t),((o={})[n.id]=a("validation."+n.id),o)):t}),{});return e=qi(qi({},e),n),Object.keys(e).length?(b.current&&s(b.current),void g(e)):(v.email&&function(e){var t=window.parent;if(t){var n=t[void 0===t.visitorGlobalObjectAlias?"vgo":t.visitorGlobalObjectAlias];e&&void 0!==n&&(n("setEmail",e),n("update"))}}(v.(e.preventDefault(),1===u.options.length&&w())},C=u.isSubmitting||!1,x=u.options.map((function(e){return o.a.createElement(zi.Input,Gi({key:e.id,error:h[e.id],disabled:C,onChange:E(e.id),onKeyDown:A,value:v[e.id],required:e.required,label:a("conversation.chat."+e.id+"Label")},Vi[e.id]))}));return o.a.createElement("form",{noValidate:!0,ref:b},x,o.a.createElement(ji,{color:n,onClick:function(e){e.preventDefault(),w()},showSpinner:C}))},Ki=function(e){var t=e.formProperties;return t.hasResponse?o.a.createElement(o.a.Fragment,null,t.options.filter((function(e){return e.response})).map((function(e){return o.a.createElement("div",{className:"widget_messages_submitted",key:e.id},o.a.createElement(wo.a,{raw:!0,element:"div",src:Ui.a}),o.a.createElement("span",null,e.response))}))):null},Yi=(n(311),ni()((function(e){var t=e.part,n=e.color,r=e.submitForm,i=t.properties,a=i.hasResponse;return o.a.createElement("div",null,a?o.a.createElement(Ki,{formProperties:i}):o.a.createElement(Wi,{part:t,color:n,submitForm:r}))}))),Qi=V((function(e,t){return{color:e.settings.settings?e.settings.settings.channels.site.bubbleColor:"",part:t.part}}),(function(e){return{submitForm:function(t,n){e(function(e,t){return{type:zt,payload:{messagePartId:e,response:t}}}(t,n))}}}))(Yi),$i=function(e){var t=e.part.properties,n=t.hasResponse?t.displayResponse:null;return o.a.createElement(o.a.Fragment,null,!!t.question&&o.a.createElement(Pi.a,{tagName:"div"},t.question),null!==n&&o.a.createElement("div",{className:"widget_v",src:Urt:e});default:return null}})))},Xi=(n(313),funct.isLastGroup,a=void 0!==i&&i,s=Object(r.,u=Object(r.useContext)(na).scrollIntoView;return Object(r.useEffect)((function(){a&&s.current&&t.length&&u(s.current)}),[a,t,u]),o.a.createElement("div",{className:"widget_messages_agent-message",ref:s},n?o.a.createElement("ssages_agent-message_icon",style:{backgroundImage:"url("+es_agent-message_icon"},o.a.createElement(wo.a,{raw:!0,element:"div",src:oi.a,alt:""})),o.a.createElement("div",{className:"widget_messages_agent-messages"},t.map((function(e){return o.a.createElement(Ji,{message:e,key:e.id})}))))}),Zi=(n(315),function(e){var t=e.messages;return o.a.createElement("div",{className:"widget_messages_visitor-message"},t.map((function(e){return o.a.createElement(Ji,{message:e,key:e.id})})))}),ea=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ta=function(e,t){window.requestAnimationFrame((function(){t&&(t.scrollTop=e.offsetTop)}))},na=o.a.createContext({scrollIntoView:function(){}}),ra=function(e){function t(t){var n=e.call(this,t)||this;return n.onScroll=function(){var e=n.props,t=e.loadPaginatedMessages,r=e.loadingMessages,o=e.conversation,i=e.totalMessages,a=e.messageCount,s=n.scrollArea.current;s&&function(e){return 0===e}(s.scrollTop)&&o&&a<i&&!r&&t(o.id,a)},n.addBotMessagesRef=function(e){n.botMessagesRefs&&n.botMessagesRefs.push(e)},n.messagesEnd=Object(r.createRef)(),n.scrollArea=Object(r.createRef)(),n.botMessagesRefs=[],n}return ea(t,e),t.prototype.componentDidMount=function(){var e=this.props,t=e.conversation,n=e.createConversation,r=e.loadedConvsagesEnd.current&&ta(this.messagesEnd.current,this.scrollArea.current),this.scrollArea.current&&this.scrollArea.current.addEventListener("scroll",this.onScroll),!t&&r&&o&&n(o)},t.prototypes,o=r.messageGroups,i=r.messageCount,a=r.markAllMessagesAsRead,s=r.conversation,u=r.loadedConversations,c=r.createConversation,l=r.visitorId,f=o[o.length-1],p=this.messagesEnd.current,d=this.scrollArea.current;d&&n.maintainPosition&&(d.scrollTop=d.scrollHeight-n.maintainPosition),e.messageCount!==i&&"visitors"!==f[0].sender.type&&a(),p&&i&&!e.messageCount&&"bots"!==f[0].sender.type&&ta(p,d),p&&n.scrollToBottom&&ta(p,d),s||!l||!u||e.visitorId&&e.loadedConversations||c(l)},t.prototype.getSnapshotBeforeUpdate=function(e){var t=this.props,n=t.loadingMessages,r=t.messageCount,o={},i=this.scrollArea.current;if(i&&(!n&&e.loadingMessages&&(o.maintainPosition=i.scrollHeight-i.scrollTop),!e.loadingMessages&&r!==e.messageCount)){var a=i.scrollHeight;i.scrollTop+i.clientHeight>a-100&&(o.scrollToBottom=!0)}return o},t.prototype.getSenderAvatarUrl=function(e){var t,n=this.props,r=n.agents,o=n.bots;return"agents"===e.type?t=r.find((function(tnd((function(t){return t.id===e.id}))),null==t?void 0:t.avatarUrl},t.prototype.render=function(){var e=this,t=this.props,n=t.messageGroups,r=t.branding,i=t.typists;return o.a.createElement(unction(t){var n=e.scrollArea.current;n&&ta(t,n)}}},o.a.createElement("div",{className:"widget_conversation",ref:this.scrollArea},o.a.createElement("div",{className:"widget_convement(Xi,{key:i.id,messages:t,avatarUrl:e.getSenderAvatarUrl(i.sender)});case"visitors":return o.a.createElement(Zi,{key:i.id,messages:t});case"bots":return o.a.createElement("div",{key:i.id,ref:e.addBotMessagesRef},o.a.createElement(Xi,{key:i.id,messages:t,avatarUrl:e.getSenderAvatarUrl(i.sender),isLastGroup:n.length===r-1}));default:return null}})),o.a.createElement("div",{className:"widget_conversation_footer "+(r?"large":"")},o.a.createElement(Di,{typists:i}),o.a.createElement(Ti,{show:r&&!i.length})),o.a.createElement("div"Time()-t.getTime())<18e5}(new Date(e.createdAt),new Date(t.createdAt))&&function(e,t){return e.sender.id===t.sereturn oa(e[n][r],t)?(e[n].push(t),e):(e.push([t]),e)},aa=bo([function(e){return e.conversation.messages}],(function(e){return e.reduce(ia,[])})),sa=function(e){return!!e.settings.settings&&!(!e.settings.settings.channels.site.branding||e.settings.settings.isReseller)},ua=bo((function(e){return e.conversation.typists}),(function(e){return e.filter((function(e){return"TYPING"===e.status})).map((function(e){return e.name}))})),ca=V((function(e){var t;return{agents:e.agent.agents,bots:e.agent.bots,branding:sa(e),loadingMessages:e.conversation.loadingMessages,messageGroups:aa(e),messageCount:e.conversation.messages.length,typists:ua(e),conversation:e.conversation.conversation,loadedConversations:e.conversation.loadedConversations,loadingConversations:e.conversation.loadingConversations,totalMessages:e.conversation.totalMessages,visitorId:null===(t=e.visitor.visitor)||void 0===t?void 0:t.id}}),(function(e){return{loadPaginatedMessages:function(t,n){e(function(e,t){return{type:"conversation/LOAD_PAGINATED_MESSAGES",payload:{conversationId:e,offset:t}}}(t,n))},markAllMessagesAsRead:function(){e({type:"conversation/MARK_ALL_MESSAGES_AS_READ"})},createConversation:function(t){e(function(e){return{type:"conversation/CREATE_CONVERSATION",payload:e}}(t))}}}))(ra),la=n(176),fa=n.n(la),pa=n(83),da=n.n(pa),ha=(n(317),function(e){var t=e.color,n=e.showOpenIcon,r=e.showHideChat,i="#"+(t||"f2f2f2").replace("#","");return o.a.createElement("button",{type:"button",className:"widget_icon_container",style:{backgroundColor:i},onClick:r},o.a.createElement("div",{cl,{raw:!0,element:"div",src:da.a,className:"widget_icon_icon-x"}),o.a.createElement(wo.a,{raw:!0,element:"div",src:fa.a,className:"widget_icon_icon-bubble"})))}),ga=n(177);var ma=n.n(gn function(e){var t=parseInt(e||"FFFFFF",16);return.2126*(255&t>>16)+.7152*(255&t>>8)+.0722*(255&t>>0)}(e)>183}));n(319),n(321);var va=function(e){var t=e.avatar,n={};return t?(n.backgroundImage="url("+t+")",o.a.createElement("div",{className:"widget_welcome_message_avatar",style:n})):o.a.createElement("div",{className:"widget_welcome_message_avatar"},o.a.createElement(wo.a,{raw:!0,element:"div",src:oi.a}))},ya=(n(323),function(e){var t=e.avatar,n=e"button,onClick:n},function(e){return"title_image"===e||"title_body_image"===e}(r.layout)&&o.a.createElement(va,{avatar:t}),o.a.createElement("div",{className:"widget_welcome_message_text"},!!r.title&&o.a.createElement("div",{className:"widget_welcome_message_title"},r.title),!!r.body&&function(e){return"title_body"===e||"title_body_image"===e}(r.layout)&&o.a.createElement("div",{className:"widget_welcome_message_body"},r.body)))}),ba=(n(325),function(e){var t=e.hideWelcomeMessa&t(n.id)}),[t,n]);i={backgroundColor:"#"+n.style.backgroundColor};return o.a.createElement("button",{"data-testid":"dismiss",type:"button",className:"widget_welcome_message_dismiss",style:a,onClick:i},o.a.createElement(wo.a,{rasrc:da.a.replace("<svg",'<svg fill="#'+n.style.textColor+'"')}))}),Ea=(n(327),function(e,t){return window.parent.postMessage(JSON.stringify({type:"chatResize",data:{width:e,height:t}}),"*")}),wa=function(){return(wa=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Aa=bo([function(e){return e.welcomeMessage.welcomeMessage},function(e){var t;return(null===(t=e.settings.settings)||void 0===t?void 0:t.channels.site.bubbleColor)||"f2f2f2"}],(function(e,t){return e?wa(wa({},e),{style:wa(wa({},e.style),{backgroundColor:e.style.backgroundColor||t})}):null})),Ca=V((function(e,t){var n;return{avatar:null===(n=e.settings.settings)||void 0===n?void 0:n.channels.site.companyLogo,showChat:t.showChat,showMessage:t.showMessage,welcomeMessage:Aa(e),hidden:t.hidden}}),(function(e){return{loadWelcomeMessage:function(){e({type:"welcomeMessage/LOAD_WELCOME_MESSAGE"})},hideWelcomeMessage:function(t){e(Un(t))}}}))((function(e){var t=e.avatar,n=e.hidden,i=e.loadWelcomeMessage,a=e.showChat,s=e.hideWelcomeMessage,u=e.showMessage,c=e.welcomeMessage,l=Object(r.useRef)(null),f=Object(r.useRef)(null);Object(r.useEffect)((function(){c||i()}),[i,c]);var p=u&&!!c&&!n,d=window.parent.innerWidth<420?window.parent.innerWidth-20:400;return Object(r.useEffect)((function(){var e,t,n,r;if(p){var o=null===(t=null===(e=null==f?void 0:f.current)||void 0===e?void 0:e.getBoundingClientRect())||void 0===t?void 0:t.width,i=null===(r=null===(n=null==l?void 0:l.current)||void 0===n?void 0:n.getBoundingClientRect())||void 0===r?void 0:r.height;return Ea(o,i)}return Ea(0,0)}),[p]),o.a.createElement(yi,{in:p,timeout:{enter:300,exit:150},classNames:"fade-in-up-out",mountOnEnter:!0,unmountOnExit:!0},o.a.createElement("div",{className:"widget_welcome_message",style:{width:d+"px"},ref:l},o.a.createElement("div",{className:"widget_welcome_message_inner",ref:f},o.a.createElement(ba,{hideWelcomeMessage:s,welcomeMessage:c}),o.ac}))))})),xa=function(e){return!(null==e||!e.trim().length)},Oa=function(e,t){return"email"!==t||!!e.trim(ment.createElement("input");return t.type="email",t.value=e,t.validity.valid}(e)},Sa=function(e){var t=e.activeQuestion,n=e.color,i=e.sendQuestionResponse,a=Jo().t,s=Object(r.useState)(!1),u=s[0],c=s[1],l=Object(r.useState)(""),f=l[0],p=l[1],d=Object(r.useState)(!1),h=d[0],g=d[1],m=Object(r.useState)(!0),v=m[0],y=m[1],b=Object(r.useRef)(null);Object(r.useEffect)((function(){b.current&&b.current.focus()}),[]);var E=a("conversation.chC=u||!v?{boxShadow:"0 -2px 0 0 #"+(v?n:"e40e49")}:{};return o.a.createElement(yi,{in:!h,timeout:200,classNames:"fade-in-out",mountOnEnter:!0,unmountOnExit:!0},o.a.createElement(o.a.Fragment,null,o.a.createEl,style:C,onSubmit:w},o.a.createElement("div",{className:"widget_composer_wrap"},o.a.createElement("div",{className:"hidden-resizer"},f),o.a.createElement("textarea",{ref:b,id:"composer-textarea",value:f,onKeyDown:function(e){13===e.keyCode&&(e.preventDefault(),w())},onChange:function(e){var t=e.target.value.replace(/\n/g,"");p(t)},onFocus:function(){return urn c(!1)},placeholder:E+"..."})),o.a.createElement(yi,{in:!A,timeout:200,classNames:"fade-in-out",mountOnEnter:!0,unmountOnExit:!0},o.a.createElement("button",{type:"submit",className:"widget_composer_send",style:{backgroundColor:"#"+(n||"f2f2f2")},disabled:A},a("conversation.chat.{style:{padding:"4px 14px 14px 14px",color:"#e40e49",fontWeight:"bold"}},a("validation."+t.properties.fieldId))))},ka=(n(161),function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}),_a=function(e){var t=e.activeQuestion,n=e.color,i=e.sendQuestionResponse,a=Jo().t,s=Object(r.useState)(!1),u=s[0],c=s[1],l=Object(r.useRef)(null),f=Object(r.useState)([]),p=f[0],d=f[1];Object(r.useEffect)((function(){l.current&&l.current.focus()}),[]);var h=!p.length;return o.a.createElement(yi,{in:!u,timeout:200,classNames:"fade-in-out",mountOnEnter:!0,unmountOnExit:!0},o.a.createElement("form",{className:"widget_composer checkbox",onSubmit:function(e){void 0===e&&(e=null),e&&e.preventDefault(),p.length&&(c(!0),i(t.id,{response:p.map((function(e){return e.value})).join("||"),displayResponse:p.map((function(e){return e.label})).join(", ")}))}},t.properties.options.map((function(e){var n=t.id+"-"+e.value;r{!functione.value!==t.value})rget.chencat(t):e}),[]).filter(Boolean).join(" ")}var Da=n(109),Ra=n.n(Da);var Pa=Ra()((function(){var e=[];return"undefined"(window.navigator.language),window.navigator.userLanguage&&e.push(window.navigator.userLanguage),window.navigator.browserLanguage&&e.push(window.navigator.browserLanguage),window.navigator.systemLangf(!e||-1===e.indexOf("-")||e.toLowerCase()!==e)return e;var t=e.split("-");return"".concat(t[)))}));var Ma=Ra()((function(){return Pa()[0]})),Na=Ma;function Fa(e,t,n){return functionetFullYear();if("number"==typeof e)return e;var t=parseInt(e,10);if("string"o get year from date: ".concat(e,"."))}function za(e){var t=ja(e),n,0,0,0),r}var Ya=Fa(ja,Ka,-10),Qa=Fa(ja,Ka,10),$a=La(Qa),Ja=Fa(ja,$a,-10),Xa=(Fa(ja,$a,10),Ia([Ka,$a]));function Za(e){var t=ja(e),n=new Date;return n.setFullYear(t,0,1),n.setHours(0,0,0,0),n}var es=Fa(ja,Za,-1),ts=Fa(ja,Za,1),ns=La(ts),rs=Fa(ja,ns,-1),os=(Fa(ja,ns,1),Ia([Za,ns]));function is(e,t){return function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,o=ja(n),i=Ba(n)+r,a=new Date;return a.setFullYear(o,i,1),a.setHours(0,0,0,0)w Datis(csFullYgth)&&(t=new Array(t);n<t;n++)r[n]=e[n];return r}function bs(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:abic",HEBREW:"Hebrew",ISO_8601:"ISO 8601",US:"US"},As=(bs(hs={},ws.US,["en-CA","en-US","es-AR","es-BO","es-CL","es-CO","es-CR","es-DO","es-EC","es-GT","es-HN","es-MX","es-NI","es-PA","es-PE","es-PR","es-SV","es-VE","pt-BR"]),bs(hs,ws.ARABIC,["ar","ar-AE","ar-BH","ar-DZ"(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ys(e,t):void 0}}(Es)||function(t}));function xs(e){return function(t,n){return function(e){return function(t,n){return n.toLocaleString(t||Na(),e)}}(e)(t,function(e){var t=new Date(e);return new Date(t.setHours(12))}(n))}}xs({day:"numeric",lid rangeType: ".concat(e))}}function js(e,t){switch(e){case"century":return Hn Us.ISO_8601,n=e.getDay();switch(t){case ws.ARABIC:case ws.HEBREW:return n===Ps||n===Ms;case ws.ISO_8601:case ws.US:return n===Ms||n===Rs;default:throw new Error("Unject.values(ws`".concat(t,"` of type `").concat(Hs(r),"` supplied to `").concat(n,"`, expected instance of `Date`."));var o=e.maxDate;return o&&r>o?new Error("Invalid prop `".concat(t,"` of type `").concat(Hs(r),"` supplied to `").concat(n,"`, minDate cannot be larger than maxDate.")):null},Qs=function(e,t,n){var r=e[t];if(!r)return null;if(!(r instanceof Date))return new Error("Invalid prop `".concat(t,"` of type `").concat(Hs(r),"` supplied to `").concat(n,"`, expected instance of `Date`."));var o=e.minDate;return o&&r<o?new Error("Invalid prop `".concat(t,"` of type `").concat(Hs(r),"` supplied to `").concat(n,"`, maxDate cannot be smaller than minDate.")):null},$s=u.a.oneOfType([u.a.instanceOf(Date),u.a.arrayOf(u.a.instanceOf(Date))]),Js=u.a.arrayOf(u.a.oneOf(Ws)),Xs=u.a.oneOfType([u.a.string,u.a.arrayOf(u.a.string)]),Zs=function(e,t,n){var r=e[t],o=e.views||Ws;return void 0!==r&&-1===o.indexOf(r)?new Error("Invalid prop `".concat(t,"` of value `").concat(r,"` supplied to `").concat(n,"`, expected one of [").concat(o.map((function(e){return'"'.concat(e,'"')})).join(", "),"].")):null};Zs.isRequired=function(e,t,n){var r=e[t];return r?Zs(e,t,n):new Error("The prop `".concat(t,"` is marked as required in `").concat(n,"`, but its value is `").concat(r,"`."))};var eu={activeStartDateContent:u.tanceOf(Date).isReque([u.a.ate,f=e===C?"":C,O=e.prev2Label,S=void 0===O?"«":O,:return Ya(t);case"year":return es(t);case"month":return ss(t);default:throw new Error("Invalid rangeType: ".concat(e))}}(M,n),I=F&&function(e,t){switch(e){case"decade":return Ya(t,-100);case"year":return es(t,-10);case"month":return ss(t,-12);default:throw new Error("Invalid rangeType: ".concat(e))}}(M,n),j=Is(M,n),B=F&&function(e,t){switch(e){case"decade":return Qa(t,100);case"year":return ts(t,10);case"month":return us(t,12);default:throw new Error("Invalid rangeType: ".concat(e))}}(M,n),U=function(){if(L.getFullYear()<1e3)return!0;var e=function(e,t){switch(e){case"century":return Va(t);case"decade":return Ja(t);case"year":return rs(t);case"month":return ls(t);default:throw new Error("Invalid rangeType: ".concat(e))}}(M,n);return f&&f>=e}(),z=F&&function(){if(I.getFullYear()<1e3)return!0;var e=function(e,t){switch(e){case"decade":return Ja(t,-100);case"year":return rs(t,-10);case"month":return ls(t,-12);default:throw new Error("Invalid rangeType: ".concat(e))}}(M,n);return f&&f>=e}(),G=l&&l<=j,q=F&&l&&l<=B;function H(e){var t=function(){switch(M){case"century":return function(e,t,n){return zs(e,t,Wa(n))}(c,u,e);case"decade":return Gs(c,u,e);case"year":return u(c,e);case"month":return a(c,e);default:throw new Error("Invalid view: ".concat(M,"."))}}();return h?h({date:e,label:t,locale:c||Ma(),view:M}):t}return o.a.createElement("div",{className:nu,style:{display:"flex"}},null!==S&&F&&o.a.createElement("button",{"aria-label":x,className:"".concat(nu,"__arrow ").concat(nu,"__prev2-button"),disabled:z,onClick:function(){R(I)},type:"button"},S),o.a.createElement("button",{"aria-label":_,className:"".concat(nu,"__arrow ").concat(nu,"__prev-button"),disabled:U,onClick:function(){R(L)},type:"button"},D),(t="".concat(nu,"__label"),o.a.createElement("button",{"aria-label":d,className:t,disabled:!N,onClick:r,style:{flexGrow:1},type:"button"},o.a.createElement("span",{className:"".concat(t,"__labelText ").concat(t,"__labelText--from")},H(n)),P&&o.a.createElement(o.a.Fragment,null,o.a.createElement("span",{className:"".concat(t,"__divider")}," ","–"," "),o.a.createElement("span",{className:"".concat(t,"__labelText ").concat(t,"__labelText--to")},H(j))))),o.a.createElement("button",{"aria-label":E,className:"".concat(nu,"__arrow ").concat(nu,"__next-button"),disabled:G,onClick:function(){R(j)},type:"button"},A),null!==y&&F&&o.a.createElement("button",{"aria-label":m,className:"".concat(nu,"__arrow ").concat(nu,"__next2-button"),disabled:q,onClick:function(){R(B)},type:"button"},y))}function ength;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}p"},s)},c),o.a.Children.map(t,(function(e,t){return o.a.cloneElement(e,au({},e.props,{style:{flexBasis:cu(100/i),maxWidth:cu(100/i),overflow:"hidden",marginLeft:a&&0===t?cu(100*a/i):null}}))})))}function fu(e){return function(e){if(Array.isArray(e))return pu(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return pu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pu(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function du(e,t){return t[0]<=e&&t[1]>=e}function hu(e,t){return e[0]<=t[0]&&e[1]>=t[1]}function gu(e,t){return du(e[0],t)||du(e[1],t)}function mu(e,t,n){var r=[];if(gu(t,e)){r.push(n);var o=du(e[0],t),i=du(e[1],t);o&&r.push("".concat(n,"Start")),i&&r.push("".concat(n,"End")),o&&i&&r.push("".concat(n,"BothEnds"))}return r}function vu(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.value,n=e.valueType,r=e.date,o=e.dateType,i=e.hover,a="react-calendar__tile",s=[a];if(!r)return s;if(!(r instanceof Array||o))throw new Error("getTileClasses(): Unable to get tile activity classes because one or more required arguments were not passed.");var u=new Date,c=r instanceof Array?r:Bs(o,r);if(du(u,c)&&s.push("".concat(a,"--now")),!t)return s;if(!(t instanceof Array||n))throw new Error("getTileClasses(): Unable to get tile activity classes because one or more required arguments were not passed.");var l=t instanceof Array?t:Bs(n,t);hu(l,c)?s.push("".concat(a,"--active")):gu(l,c)&&s.push("".concat(a,"--hasActive"));var f=mu(l,c,"".concat(a,"--range"));if(s.push.apply(s,fu(f)),i){var p=i>l[1]?[l[1],i]:[i,l[0]],d=mu(p,c,"".concat(a,"--hover"));s.push.apply(s,fu(d))}return s}function yu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Eu(){return(Eu=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function wu(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function Au(e){for(var t=e.className,n=e.count,r=void 0===n?3:n,i=e.dateTransform,a=e.dateType,s=e.end,u=e.hover,c=e.offset,l=e.start,f=e.step,p=void 0===f?1:f,d=e.tile,h=e.value,g=e.valueType,m=wu(e,["className","count","dateTransform","dateType","end","hover","offset","start","step","tile","value","valueType"]),v=[],y=l;y<=s;y+=p){var b=i(y);v.push(o.a.createElement(d,Eu({key:b.getTime(),classes:vu({value:h,valueType:g,date:b,dateType:a,hover:u}),date:b,point:y},m)))}return o.a.createElement(lu,{className:t,count:r,offset:c,wrap:!0},v)}function Cu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xu(e)ction"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ou(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Su(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ku(e,t){return(ku=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _u(e,t){return!t||"object"!==xu(t)&&"function"!=typeof t?Tu(e):t}function Tu(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Du(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Ru(e){return(Ru=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Mu(e,t){var n=e.activeStartDate,r=e.date,o=e.view;return"function"==typeof t?t({activeStartDate:n,date:r,view:o}):t}ru.propTypes={activeStartDate:u.a.instanceOf(Date).isRequired,drillUp:u.a.func.isRequired,formatMonthYear:u.a.func,formatYear:u.a.func,locale:u.a.string,maxDate:u.a.instanceOf(Date),minDate:u.a.instanceOf(Date),navigationAriaLabel:u.a.string,navigationLabel:u.a.func,next2AriaLabel:u.a.string,next2Label:u.a.oneOfType([u.a.string,u.a.node]),nextAriaLabel:u.a.string,nextLabel:u.a.oneOfType([u.a.string,u.a.node]),prev2AriaLabel:u.a.string,prev2Label:u.a.oneOfType([u.a.string,u.a.node]),prevAriaLabel:u.a.string,prevLabel:u.ade,className:u.a.string,count:u.a.number.isRequired,direction:u.a.string,offset:u.a.number,style:u.a.objectOf(u.a.oneOfType([u.a.string,u.a.number])),wrap:u.a.bool},Au.propTypes=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yu(Object(n),!0).forEach((function(t){bu(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},eu,{activeStartDate:u.a.instanceOf(Date),count:u.a.number,dateTransform:u.a.func.isRequired,offset:u.a.number,step:u.a.number,tile:u.a.func.isRequired});var Nu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super e null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ku(e,t)}(s,e);var t,n,r,i,a=(t=s,function(){var e,n=Ru(t);if(Du()){var r=Ru(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return _u(this,e)});function s(){var e;Ou(this,s);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Pu(Tu(e=a.call.apply(a,[this].concat(n))),"state",{}),e}return n=s,i=[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.tileClassName,r=e.tileContent,o={};return n!==t.tileClassNameProps&&(o.tileClassName=Mu(e,n),o.tileClassNameProps=n),r!==t.tileContentProps&&(o.tileContent=Mu(e,r),o.tileContentProps=r),o}}],(r=[{key:"render",value:function(){var e=this.props,t=e.activeStartDate,n=e.children,r=e.classes,i=e.date,a=e.formatAbbr,s=e.locale,u=e.maxDate,c=e.maxDateTransform,l=e.minDate,f=e.minDateTransform,p=e.onClick,d=e.onMouseOver,h=e.style,g=e.tileDisabled,m=e.view,v=this.state,y=v.tileClassName,b=v.tileContent;return o.a.createElement("button",{className:Ta(r,y),disabled:l&&f(l)>i||u&&c(u)<i||g&&g({activeStartDate:t,date:i,view:m}),onClick:p&&function(e){return p(i,e)},onFocus:d&&function(){return d(i)},onMouseOver:d&&function(){return d(i)},style:h,type:"button"},a?o.a.createElement("abbr",{"aria-label":a(s,i)},n):n,b)}}])&&Su(n.prototype,r),i&&Su(n,i),s}(r.Component);function Fu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Lu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Iu(){return(Iu=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ju(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}Nu.propTypes=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cu(Object(n),!0).forEach((function(t){Pu(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},tu,{children:u.a.node.isRequired,formatAbbr:u.a.func,maxDateTransform:u.a.func.isRequired,minDateTransform:u.a.func.isRequired});function Bu(e){var t=e.classes,n=e.formatYear,r=void 0===n?_s:n,i=ju(e,["classes","formatYear"]),a=i.date,s=i.locale;return o.a.createElement(Nu,Iu({},i,{classes:[].concat(t,"react-calendar__century-view__decades__decade"),maxDateTransform:$a,minDateTransform:Ka,view:"century"}),Gs(s,r,a))}function Uu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gu(){return(Gu=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function qu(e){var t=e.activeStartDate,n=ja(za(t)),r=n+99;return o.a.createElement(Au,Gu({},e,{className:"react-calendar__century-view__decades",dateTransform:Ka,dateType:"decade",end:r,start:n,step:10,tile:Bu}))}function Hu(e){return o.a.createElement("div",{className:"react-calendar__century-view"},o.a.createElement(qu,e))}function Vu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Wu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ku(){return(Ku=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Yu(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}Bu.propTypes=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fu(Object(n),!0).forEach((function(t){Lu(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},tu,{formatYear:u.a.func}),qu.propTypes=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?argumach((function(t){zu(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Uu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},eu);function Qu(e){var t=e.classes,n=e.formatYear,r=void 0===n?_s:n,i=Yu(e,["classes","formatYear"]),a=i.date,s=i.locale;return o.a.createElement(Nu,Ku({},i,{classes:[].concat(t,"react-calendar__decade-view__years__year"),maxDateTransform:ns,minDateTransform:Za,view:"decade"}),r(s,a))}function $u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ju(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xu(){return(Xu=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Zu(e){var t=e.activeStartDate,n=ja(Ka(t)),r=n+9;return o.a.createElement(Au,Xu({},e,{className:"react-calendar__decade-view__years",dateTransform:function(e){return new Date(e,0,1)},dateType:"year",end:r,start:n,tile:Qu}))}function ec(e){return o.a.createElement("div",{className:"react-calendar__decade-view"},o.a.createElement(Zu,e))}function tc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rc(){return(rc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function oc(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}Qu.propTypes=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vu(Object(n),!0).forEach((function(t){Wu(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},tu,{formatYear:u.a.func}),Zu.propTypes=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$u(Object(n),!0).forEach((function(t){JDescriptors?Object.defineProperties(e,ObjectyDescriptor(n,t))}))}return e}({},eu);function ic(e){var t=e.classes,n=e.formatMonth,r=void 0===n?Ss:n,i=e.formatMonthYear,a=void 0===i?ks:i,s=oc(e,["classes","formatMonth","formatMonthYear"]),u=s.date,c=s.locale;return o.a.createElement(Nu,rc({},s,{classes:[].concat(t,"react-calendar__year-view__months__month"),formatAbbr:a,maxDateTransform:cs,minDateTransform:as,view:"year"}),r(c,u))}function ac(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function sc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function uc(){return(uc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function cc(e){var t=ja(e.activeStartDate);return o.a.createElement(Au,uc({},e,{className:"react-calendar__year-view__months",dateTransform:function(e){return new Date(t,e,1)},dateType:"month",end:11,start:0,tile:ic}))}function lc(e){return o.a.createElement("div",{className:"react-calendar__year-view"},o.a.createElement(cc,e))}function fc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dc(){return(dc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function hc(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}ic.propTypes=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tc(Object(n),!0).forEach((function(t){nc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},tu,{formatMonth:u.a.func,formatMonthYear:u.a.func}),cc.propTypes=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ac(Object(n),!0).forEach((function(t){sc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ac(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},eu,{locale:u.a.string});var gc="react-calendar__month-view__days__day";function mc(e){var t=e.formatLongDate,n=void 0===t?Os:t,r=e.calendarType,i=e.classes,a=e.currentMonthIndex,s=hc(e,["formatLongDate","calendarType","classes","currentMonthIndex"]),u=s.date;return o.a.createElement(Nu,dc({},s,{classes:[].concat(i,gc,qs(u,r)?"".concat(gc,"--weekend"):null,u.getMo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){eturn n}function yc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bc(){return(bc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Ec(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=eeighboringMonth"]),s=ja(t),u=Ba(t),c=r||i,l=Ns(t,n),f=c?0:l,p=1+(c?-l:0),d=function(){if(r)return p+42-1;var e=vs(t);if(i){var o=new Date;return o.setFullYear(s,u,e),o.setHours(0,0,0,0),e+(7-Ns(o,n)-1)}return e}();return o.a.createElement(Au,bc({},a,{className:"react-calendar__month-view__days",count:7,currentMonthIndex:u,dateTransform:function(e){var t=new Date;return t.setFullYear(s,u,e),t.setHours(0,0,0,0),t},dateType:"day",end:d,offset:f,start:p,tile:mc}))}mc.propTypes=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fc(Object(n),!0).forEach((function(t){pc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},tu,{currentMonthIndex:u.a.number.isRequired,formatLongDate:u.a.func}),wc.propTypes=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vc(Object(n),!0).forEach((function(t){yc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vc(Object(n)).forEach((function(t){Object.definePropes.islendarType,n=e.formatShortWeekday,r=void 0===n?Ts:n,i=e.locale,a=e.onMouseLeave,s=as(new Date),u=ja(s),c=Ba(s),l=[],f=1;f<=7;f+=1){var p=new Date(u,c,f-Ns(s,t)),d=Ds(i,p);l.push(o.a.createElement("div",{key:f,className:"".concat("react-calendar__month-view__weekdays","__weekday")},o.a.createElement("abbr",{"aria-label":d,title:d},r(i,p).replace(".",""))))}return o.a.createElement(lu,{className:"react-calendar__month-view__weekdays",count:7,onFocus:a,onMouseOver:r n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function xc(e){var t=e.date,n=e.onClickWeekNumber,r=e.weekNumber,i={className:"react-calendar__tile",style:{flexGrow:1}},a=o.a.createElement("span",null,r);return n?o.a.createElement("button",Cc({},i,{onClick:function(e){return n(r,t,e)},type:"button"}),a):o.a.createElement("div",i,a)}function Oc(e){var t=e.activeStartDate,n=e.calendarType,r=e.onClickWeekNumber,i=e.onMouseLeave,a=e.showFixedNumberOfWeeks,s=function(){if(a)return 6;var e=vs(t)-(7-Ns(t,n));return 1+Math.ceil(e/7)}(),u=function(){for(var e=ja(t),r=Ba(t),o=Ua(t),i=[],a=0;a<s;a+=1)i.push(Fs(new Date(e,r,o+7*a),n));return?arguments[1]:ws.ISO_8601,r=n===ws.US?ws.US:ws.ISO_8601,o=Fs(e,r),i=ja(e)+1;do{t=Fs(new Date(i,0,r===ws.ISO_8601?4:1),r),i-=1}while(e-t<0);return Math.round((o-t)/6048e5)+1}(e,n)}));return o.a.createElement(lu,{className:"react-calendar__month-view__weekNumbers",count:s,direction:"column",onFocus:i,onMouseOver:i,style:{flexBasis:"calc(100% * (1 / 8)",flexShrink:0}},c.map((function(e,t){return o.a.createElement(xc,{key:e,date:u[t],onClickWeekNumber:r,weekNumber:e})})))}function Sc(){return(Sc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function kc(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function _c(e){var t=e.activeStartDate,n=e.locale,r=e.onMouseLeave,i=e.showFixedNumberOfWeeks,a=e.calendarType,s=void 0===a?function(e){return Object.keys(As).find((function(t){return As[t].includes(e)}))||ws.ISO_8601}(n):a,u=e.formatShortWeekday,c=e.onClickWeekNumber,l=e.showWeekNumbers,f=kc(e,["calendarType","formatShortWeekday","onClickWeekNumber","showWeekNumbers"]);var p="react-calendar__month-view";return o.a.createElement("div",{className:[p,l?"".concat(p,"--weekNumbers"):""].join(" ")},o.a.createElement("div",{style:{display:"flex",alignItems:"flex-end"}},l?o.a.createElement(Oc,{activeStar,Sc({calendarType:s},f)))))}function Tc(){return(Tc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Dc(e){return(Dc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:fuoperty(e,r.key,r)}}function Mc(e,t){return(Mc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}functioll(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Ic(e){return(Ic=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function jc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Bc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jc(Object(n),!0).forEach((function(t){Uc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Uc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zc(e,t){if(null==e)return{};var n,r,o=func&(o[n]=e[n])}return o}function Gc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Ac.propTypes={calendarType:Ks.isRequired,formatShortWeekday:u.a.funcnceOf(Date).isRequired,calendarType:Ks.isRequired,onClickWeekNumber:u.a.func,onMouseLeave:u.a.func,showFixedNumberOfWeeks:u.a.bool},_c.propTypes={activeStartDate:u.a.instanceOf(Date).isRequired,calendarType:Ks,formatShortWeekday:u.a.func,locale:u.a.string,onClickWeekNumber:u.a.func,onMouseLeave:u.a.kNumbers:u.a.bool};var qc=["century","decade","year","monthreturn function(e){if(Array.isArray(e))return Gc(e)}(e)||function(e){if("undefined"!=typeof Symbolce(8,-r.name);if("Map"rable, non-array objects,t,n){return function(e,t,n){return-1!==Vc(t,n).indexOf(e)}(e,t,n)?e:n}function Kc(e){return Hc[qc.indexOf(e)]}function Yc(e,t){var n=e.value,r=e.minDate,o=e.maxDate,i=e.maxDetail,a=function(e,t){if(!e)return null;var n=e instanceof Array&&2===e.length?e[t]:e;if(!n)return null;var r=new Date(n);if(isNaN(r.getTime()))throw new Error("Invalid date: ".concat(e));return r}(n,t);if(!a)return null;var s=Kc(i);return function(e,t,n){return t&&t>e?t:n&&n<e?n:e}([Ls,js][t](s,a),r,o)}var Qc=function(e){return Yc(e,0)},$c=function(e){return Yc(e,1)},Jc=function(e){var t=e.value;return t instanceof Ai=e.value;return Ls(Wc(e.view,o,n),Qc({value:i,minDate:r,maxDate:t,maxDetail:n})||new Date)}var Zc=function(e){return e&&1===[].concat(e).length},el=functioew TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mc(e,t)}(s,e);var t,n,r,i,a=(t=s,function(){var e,n=Ic(t);if(Lc()){var r=Ic(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return Nc(this,e)});function s(){var e;Rc(this,s);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Uc(Fc(e=a.call.apply(a,[this].concat(n))),"state",{activeStartDate:e.props.defaultActiveStartDate,value:e.props.defaultValue,view:e.props.defaultView}),Uc(Fc(e),"setStateAndCallCallbacks",(function(t,n){var r=Fc(e),o=r.activeStartDate,i=r.view,a=e.props,s=a.allowPartialRange,utTime()!==p[e].getTime():t.value]):c(t.value)));n&&n(",(function(t){e.setStateAndCallCallbacks({activeSUpAvailable){var t=Fc(e),n=t.activeStartDate,r=t.view,o=t.views,i=e.props.onDrillUp,a=o[o.indexOf(r)-1],s=Ls(a,n);e.setStateAndCallCallbacks({activeStartDate:s,view:a},i)}})),Uc(Fc(e),"onChange",(function(t,n){var r,o=e.props.selectRange;if(e.onClickTile(t,n),o){var i=Fc(e),a=i.value,s=i.valueType;r=Zc(a)?Us(s,a,t):Ls(s,t)}else r=e.getProcessedValue(t);var u=Xc(Bc({},e.props,{value:r}));e.setStateAndCallCallbacks({activeStartDate:u,value:r})})),Uc(Fc(e),"onClickTile",(function(t,n){var r=Fc(e).view,o=e.props,i=o.onClickDay,a=o.onClickDecade,s=o.onClickMonth,u=o.onClickYear,c=function(){switch(r){case"century":return a;case"decade":return u;case"year":return s;case"month":return i;default:throw new Error("Invalid view: ".concat(r,"."))}}();c&&c(t,n)})),Uc(Fc(e),"onMouseOver",(function(t){e.setState((function(e){return e.hover&&e.hover.getTime()===t.getTime()?null:{hover:t}}))})),Uc(Fc(e),"onMouseLeave",(function(){e.setState({hover:null})})),e}return n=s,(r=[{key:"getProcessedValue",value:function(e){var t=this.props,n=t.minDate,r=t.maxDate,o=t.maxDetail,i=t.returnValue;return function(){switch(i){case"start":return Qc;case"end":return $c;case"range":return Jc;default:throw new Error("Invalid returnValue.")}}()({value:e,minDate:n,maxDate:r,maxDetail:o})}},{key:"renderContent",value:function(e){var t=this.activeStartDate,n=this.onMouseOver,r=this.valueType,i=this.value,a=this.view,s=this.props,u=s.calendarType,c=s.locale,l=s.maxDate,f=s.minDate,p=s.selectRange,d=s.tileClassName,h=s.tileContent,g=s.tileDisabled,m=this.hover,v={activeStartDate:e?Is(a,t):Ls(a,t),hover:m,locale:c,maxDate:l,minDate:f,onClick:this.drillDownAvailable?this.drillDown:this.onChange,onMouseOver:p?n:null,tileClassName:d,tileContent:h,tileDisabled:g,value:i,valueType:r};switch(a){case"century":var y=this.props.formatYear;return o.a.createElement(Hu,Tc({formatYear:y},v));case"decade":var b=this.props.formatYear;return o.a.createElement(ec,Tc({formatYear:b},v));case"year":var E=this.props,w=E.formatMonth,A=E.formatMonthYear;return o.a.createElement(lc,Tc({formatMonth:w,formatMonthYear:A},v));case"month":var C=this.props,x=C.formatLongDate,O=C.formatShortWeekday,S=C.onClickWeekNumber,k=C.showDoubleView,_=C.showFixedNumberOfWeeks,T=C.showNeighboringMonth,D=C.showWeekNumbers,R=this.onMouseLeave;return o.a.createElement(_c,Tc({calendarType:u,formatLongDate:x,formatShortWeekday:O,onClickWeekNumber:S,onMouseLeave:p?R:null,showFixedNumberOfWeeks:_||k,showNeighboringMonth:T,showWeekNumbers:D},v));default:throw new Error("Invalid view: ".concat(a,"."))}}},{key:"renderNavigation",value:function(){if(!this.props.showNavigation)return null;var e=this.activeStartDate,t=this.view,n=this.views,r=this.props,i=r.formatMonthYear,a=r.formatYear,s=r.locale,u=r.maxDate,c=r.minDate,l=r.navigationAriaLabel,f=r.navigationLabel,p=r.next2AriaLabel,d=r.next2Label,h=r.nextAriaLabel,g=r.nextLabel,m=r.prev2AriaLabel,v=r.prev2Label,y=r.prevAriaLabel,b=r.prevLabel,E=r.showDoubleView;return o.a.createElement(ru,{activeStartDate:e,drillUp:this.drillUp,formatMonthYear:i,formatYear:a,locale:snextLabel:g,prev2AriaLl:b,setActiveStarhis.props,t=e.clashis.value,s=[].cons.length&&"".concat("react-cale,this.renderNavigation(),o.a.__viewContainer"),onBlur:n?i:null,onMouseLeave:n?i:null},this.renderContent(),r&&this.renderContent(!0)))}},{key:"activeStartDate",get:function(){var e,t,n,r,o,i,a,s,u,c,l,f,p=this.props.activeStartDate,d=this.state.activeStartDate;return p||d||(e=this.props,t=e.activeStartDate,n=e.defaultActiveStartDate,r=e.defaultValue,o=e.defaultView,i=e.maxDetail,a=e.minDetail,s=e.value,u=e.view,c=zc(e,["activeStartDate","defaultActiveStartDate","defaultValue","defaultView","maxDetail","minDetail","value","view"]),l=Wc(u,a,i),(f=t||n)?Ls(l,f):Xc(Bc({maxDetail:i,minDetail:a,value:s||r,view:u||o},c)))}},{key:"value",get:function(){var e=this.props,t=e.selectRange,n=e.value,r=this.state.value;return t&&Zc(r)?r:void 0!==n?n:r}},{key:"valueType",get:function(){return Kc(this.props.maxDetail)}},{key:"view",get:function(){var e=this.props,t=e.minDetail,n=e.maxDetail,r=e.view,o=this.state.view;return Wc(r||o,t,n)}},{key:"views",get:function(){var e=this.props;return Vc(e.minDetail,e.maxDetail)}},{key:"hover",get:function(){var e=this.props.selectRange,t=this.state.hover;return e?t:null}},{key:"drillDownAvailable",get:function(){var e=this.view,t=this.views;return t.indexOf(e)<t.length-1}},{key:"drillUpAvailable",get:function(){var e=this.view;return this.views.indexOf(e)>0}}])&&Pc(n.prototype,r),i&&Pc(n,i),s}(r.Component);el.defaultProps={maxDetail:"month",minDetail:"century",returnValue:"start",showNavigation:!0,showNeighboringMonth:!0};var tl=u.a.instanceOf(Date),nl=u.a.oneOfType([u.a.string,$s]);el.propTypes={activeStartDate:tl,allowPartialRange:u.a.bool,calendarType:Ks,className:Xs,defaultActiveStartDate:tl,defaultValue:nl,defaultView:Zs,formatLongDate:u.a.func,formatMonth:u.a.func,formatMonthYear:u.a.func,formatShortWeekday:u.a.func,formatYear:u.a.func,locale:u.a.string,maxDate:Qs,maxDetail:u.a.oneOf(qc),minDate:Ys,minDetail:u.a.oneOf(qc),navigationAriaLabel:u.a.string,navigationLabel:u.a.func,next2AriaLabel:u.a.string,next2Label:u.a.node,nextAriaLabel:u.a.string,nextLabel:u.a.node,onActiveStartDateChange:u.a.func,onChange:u.a.func,onClickDay:u.a.func"start","end","range"]),selectRange:u.a.bool,showDoubleView:u.a.bool,showFixedNumberOfWeeks:u.a.bool,showNavigation:u.a.bool,showNeighboringMonth:u.a.bool,showWeekNumbers:u.a.bool,tileClassName:u.a.oneOfType([u.a.func,Xs]),tileContent:u.a.oneOfType([u.a.func,u.a.node]),tileDisabled:u.a.func,value:nl,view:Zs};var rl=el,ol=function(e){var t=e.activeQuestion,n=e.color,i=e.sendQuestionResponse,a=Object(r.useState)(!1),s=a[0],u=a[1],c={backgroundColor:"#"+(n||"f2f2f2")};return o.a.createElement(yi,{in:!s,timeout:200,classNames:"fade-in-out",mountOnEnter:!0,unmountOnExit:!0},o.a.createElement("div",{className:"widget_composer"},o.a.createElement("div",{className:"widget_composer_buttons"},t.properties.options.map((function(e){return o.a.createElement("button",{key:e.value,style:c,type:"button",onClick:function(){return function(e){u(!0),i(t.id,{response:e.value,displayResponse:e.label})}(e)}},e.label)})))))),sl=n(179),ul=n.n(sl);function cl(e,t){Object(r.useEffect)((function(){var n=function(n){!e.current||e.current.contains(n.target)||t(n)};return document.addEventListener("mousedown",n),document.addEventListener("touchstart"veEventListener("mousedown",n),document.removeEventListener("touchstart",n)}}),[e,t])}var ll=function(e){var t=e.value,n=e.onChange,i=e.close,a=Object(r.useRef)(null);return cl(a,i),o.a.createElement("div",{className:"widget_date_picker",ref:a},o.a.createElement(rl,{value:t,onChange:n,calendarType:"US"}))},fl=function(e){var t=e.value,n=e.onChange,i=e.close,a=Object(r.useRef)(null),s=Object(r.useRef)(null);cl(s,i),Object(r.useEffect)((function(){a&&a.current&&s&&s.current&&(s.current.scrollTop=a.current.offsetTop-40)}),[]);var u=Object(r.useMemo)((function(){return Array.from(Array(24).keys()).map((function(e){return{label:new Date("1970-01-01 "+e+":00:00").toLocaleString(void 0,{hour:"numeric",minute:"numeric",hour12:!0}),value:e}}))}),[]);return o.a.createElement("ul",{className:"widget_time_picker",ref:s},u.map((function(e){return o.a.createElement("li",{key:e.value,className:t===e.value?"selected":"",ref:t===e.value?a:null},o.a.createElement("button",{type:"button",onClick:function(){return n(e.value)}},o.a.createElement(wo.a,{raw:!0,element:"div",src:Ui.a}),e.label))})))},pl={text:Sa,checkbox:_a,hidden:Sa,textarea:Sa,date:function(e){var t=e.activeQuestion,n=e.color,i=e.sendQuestionResponse,a=Jo().t,s=Object(r.useState)((function(){return new Date})),u=s[0],c=s[1],l=Object(r.useState)(!1),f=l[0],p=l[1];return o.a.createElement(yi,{in:!f,timeout:200,classNames:"fade-in-out",mountOnEnter:!0,unmountOnExit:!0},o.a.createElement("form",{className:"widget_composer column",onSubmit:function(e){void 0===e&&(e=null),e&&e.preventDefault(),p(!0),i(t.id,{response:u.toUTCString(),displayResponse:u.toLocaleString(void 0,{month:"long",day:"numeric",year:"numeric"})})}},o.a.createElement("style",null,".react-calendar__tile--active abbr { background-color: #"+n+" !important; }"),o.a.createElement("div",{className:"widget_date_picker standalone"},o.a.createElement(rl,{value:u,onChange:function(e){var t;t=Array.isArray(e)?e[0]:e,c(t)}})),o.a.createElement("button",{type:"submit",className:"widget_composer_send",style:{backgroundColor:"#"+(n||"f2f2f2")}},a("conversation.chat.send"))))},datetime:function(e){var t=e.activeQuestion,n=e.color,i=e.sendQuestionResponse,a=Jo().t,s=Object(r.useState)(null),u=s[0],c=s[1],l=Object(r.useState)(null)r.useState)(!1),h=d[0],g=d[1],m=Object(r.useState)(!1),v=m[0],y=m[1],b=Object(r.useState)(!1),E=b[0],w=b[1],A=ma(n||"f2f2f2"),C=Object(r.useMemo)((function(){return u?u.toLocaleString(void 0,{month:"long",day:"numeric",year:"numeric"}):""}),[u]),x=Object(r.useMemo)((function(){return f?new Date("1970-01-01 "+f+":00:00").toLocaleString(void 0,{hour:"numeric",minute:"numeric",hour12:!0}):""}),[f]),O=Object(r.useCallback)((function(){g(!1)}),[]),S=Object(r.useCallback)((function(){y(!1)}),[]),k={backgroundColor:"#"+(n||"f2f2f2")},_={backgroundColor:"#fff",color:"#"+(n||"f2f2f2"),boxShadow:"0 0 0 2px #"+n+" inset"};return o.a.createElement("form",{className:"widget_composer column",onSubmit:function(e){void 0===e&&(e=null),e&&e.preventDefault(),w(!0);var n=new Date(u||"");n.setHours(f||0),n.setMinutes(0),n.setSeconds(0),i(t.id,{response:n.toUTCString()||"",displayResponse:n.toLocaleString(void 0,{month:"long",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric"})||""})}},o.a.createElement("style",null,".react-calendar__tile--active abbr { background-color: #"+n+" !important; }"),v&&o.a.createElement(ll,{value:u,onChange:function(e){var t;t=Array.isArray(e)?e[0]:e,c(t),y(!1)},close:S}),h&&o.a.createElement(fl,{value:f,onChange:function(e){p(e),g(!1)},close:O}),o.a.createElement(yi,{in:!E,timeout:200,classNames:"fade-in-out",mountOnEnter:!0,unmountOnExit:!0},o.a.createElement("button",{type:"button",className:"widget_composer_button",style:A||!u?k:_,onClick:function(){return y(!0)}},o.a.createElement(wo.a,{raw:!0,element:"div",src:ul.a,style:{fill:A||!u?"":"#"+(n||"f2f2f2")}}),u?C:a("conversation.chat.selectDate"))),o.a.createElement(yi,{in:!E,timeout:200,classNames:"fade-in-out",mountOnEnter:!0,unmountOnExit:!0},o.a.createElement("button",{type:"button",className:"widget_composer_button",style:A||!f?k:_,onClick:function(){return g(!0)}},o.a.createElement(wo.a,{raw:!0,element:"div",src:al.a,style:{fill:A||!f?"":"#"+(n||"f2f2f2")}}),f?x:a("conversation.chat.selectTime"))),o.a.createElement(yi,{in:!(E||null===u||null===f),timeout:200,classNames:"fade-in-out",mountOnEnter:!0,unmountOnExit:!0},o.a.createElement("button",{type:"submit",className:"widget_composer_send",style:k},a("conversation.chat.send"))))},dropdown:ol,listbox:_a,radio:ol,multiselect:_a,none:ol},dl=V((function(e,t){var n;return{activeQuestion:t.activeQuestion,color:null===(n=e.settings.settings)||void 0===n?void 0:n.channels.site.bubbleColor}}),(function(e){return{sendQuestionResponse:function(t,n){e(function(e,t){return{type:"conversation/SEND_QUESTION_RESPONSE",payload:{messagePartId:e,response:t}}}(t,n))}}}))((function(e){var t=e.activeQuestion,n=e.color,r=e.sendQuestionResponse,i=pl[t.properties.fieldType];return o.a.createElement(i,{activeQuestion:t,color:n,sendQuestionResponse:r})})),hl=function(e){var t=e.aunreadMessageCount,i=e.settings,a=e.markAllMessagesAsRead,s=e.hideComposer,u=e.hideWelcomeMessage,c=e.welcomeMessageHidden,l=e.openChat,f=e.offlineIndicator,p=i.channels.site,d=p.companyName,h=p.companyBio,g=p.companyLogo,m=p.bubbleColor,v=Object(r.useState)(!1),y=v[0],b=v[1],E=Object(r.useState)(!1),w=E[0],A=E[1],C=Object(r.useState)(!1),x=C[0],O=C[1],S=Object(r.useRef)(0),k=function(e){return b(e),e?window.parent.postMessage("conversationChatOpened","*"):window.parent.postMessage("conversationChatClosed","*")},_=function(e){return e&&ma(e)?"color-light":""}(m),T=function(){k(!0),O(!0),l(),u(),clearTimeout(S.current),S.current=window.setTimeout((function(){A(!0)}),1),a()};return o.a.createElement("div",{className:"widget "+_},o.a.createElement(Ca,{showMessage:!y,showChat:T,hidden:c}),y&&o.a.createElement("div",{className:"ii,{name:d,bio:h,logo:g,color:m,offlineIndicator:f}),o.a.createElement(ca,null),!s&&!t&&o.a.createElement(Oi,{color:m}),t&&o.a.createElement(dl,{key:t.id,activeQuestion:t})),!y&&o.a.createElement(Si,{chatBadgeCount:n}),o.a.createElement(ha,{color:m,showOpenIcon:x,showHideChat:function(){return w?(A(!1),O(!1),clearTimeout(S.current),S.current=window.setTimeout((function(){k(!1)}),300),void a()):T()}}))},gl=n(26);function ml(){return Xn.a.post("/widget/jwt").then((function(e){return e.data}))}var vl=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})ructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),yl=functted"===e.name?"TYPING":"STOPPED",o=e.data;o.status=r,o.id!==t&&n(o)},bl=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.visitorEmail=window.conversations.email,t.state={visitorChannelName:"",sharedChannelName:"",connectionInitiated:!1,jwt:"",loadingJwt:!1},t}return vl(t,e),t.prototype.componentDidMount=function(){(0,this.props.loadVisitor)(this.visitorEmail)},t.prototype.componentDidUpdate=function(e,t){var n=this.props,r=n.visitor,o=n.accountId,i=n.typing,a=n.loadConversation,s=n.loadingConversations,u=n.conversation,c=n.setPresent,l=n.websocketConnected,f=this.state,p=f.visitorChannelName,d=f.jwt,h=f.loadingJwt;r&&!p&&(this.setChannelNames(o,r),!u&&!s&&a(),!d&&!h&&this.loadJwt()),u&&!l&&d&&this.connectToWebsocket(),this.shouldSubscribe(t,e)&&(this.subscribeToMessagesCreated(),this.subscribeToMessagesUpdated(),this.subscribeToTypingEvents(),this.subscribeToConversationUpdated()),this.shouldSendPresence(e,t)&&this.sendVisitorChannelPresence(),!e.conversation&&u&&c(),e.typing!==i&&this.sendTypingEvent(i)},t.prototype.onWebsocketConnected=function(){(0,this.props.setWebsocketConnected)()},t.prototype.setChannelNames=function(e,t){var n=function(e,t){return"conv_vs:"+e+":"+t}(e,t.id),r=function(e,t){return"conv_sh:"+e+":"+t}(e,t.id);this.setState({visitorChannelName:n,sharedChannelName:r})},t.prototype.loadJwt=function(){var e=this,t=this.props.visitor,n=localStorage.getItem("conv_ws_"+(null==t?void 0:t.id));return n?void this.setState({jwt:n}):(this.setState({loadingJwt:!0}),void ml().then((function(n){localStorage.setItem("conv_ws_"+(null==t?void 0:t.id),n.jwt),e.setState({loadingJwt:!1,jwt:n.jwt})})))},t.prototype.shouldSubscribe=function(e,t){var n=this.state.visitorChannelName,r=this.props.websocketConnected;return(!t.websocketConnected||!e.visitorChannelName)&&r&&!!n},t.prototype.shouldSendPresence=function(e,t){var n=this.props.isPresent,r=this.state.visitorChannelName;return(!e.isPresent||!t.visitorChannelName)&&n&&!!r},t.prototype.subscribeToMessagesCreated=function(){var e=this.props,t=e.setMessages,n=e.addAgents,r=e.addBots,o=e.loadRemoteMessagegl.default.subscribe(i,"messages.created",(function(e){return function(e,t,n,r,o){var i=e.data,a=i.data,s=i.included,u=ar(a),c=s,l=c.filter((function(e){return e.type&&"agents"===e.type})).map((function(e){return ar(e)}));l.length&&n(l);var f=c.filter((function(e){return e.type&&"botsts[0].type&&null===u.parts[0].properties.text&&u.parts[0].properties.downloadUrl&&o(u,u.parts[0].properties.downloadUrl),t([u])}(e,t,n,r,o)}))},t.prototype.subscribeToMessagesUpdated=function(){var e=this.props.setMessages,t=this.state.visitorChannelName;gl.default.subscribe(t,"messages.updated",(function(t){return function(e,t){t([ar(e.data.data)])}(t,e)}))},t.protn(){var e=this.props.seis.state.visitorChannelName;gl.default.subscribe(t,"conversations.updated",(function(t){return function(e,t){t(ar(e.data.data).visitorUnreadCount)}(t,e)}))},t.prototype.subscribeToTypingEvents=function(){var e=this.props,t=e.setTypist,n=e.visitor,r=this.state.sharedChannelName;n&&(gl.default.subscribe(r,"typing-indicators.started",(function(e){return yl(e,n.id,t)})),gl.default.subscribe(r,"typing-indicators.stopped",(function(e){return yl(e,n.id,t)})))},t.prototype.sendTypingEvent=function(e){var t=this.props.visitor,n=this.state.sharedChannelName;if(t){var r={id:t.id,type:"visitors"};e?gl.default.publish(n,"typing-indicators.started",r):gl.default.publish(n,"typing-indicators.stopped",r)}},t.prototype.sendVisitorChannelPresence=function(){var e=this.state.visitorChannelName;gl.default.enterPresence(e)},t.prototype.connectToWebsocket=function(){var e=this,t=this.state,n=t.jwt,r=t.connectvisitor;r||(this.setState({connectionInitiated:!0}),gl.default.init({authCallback:function(t,nnen(){return null},t}(r.Component),El=function(e){return e.visitor.visitor},wl=function(e){return e.conversation.conversation},Al=V((function(e){return{visitor:El(e),conversation:wl(e),accountId:e.account.id,isPresent:e.visitor.isPresent,typing:e.visitor.typing,websocketConnected:e.websocket.websocketConnected,loadingConversations:e.conversation.loadingConversations}}),(function(e){return{loadVisitor:fu"visitor/LOAD_VISITOR",payload:e}}(t))},addAgents:function(t){e(Nt(t))},addBots:function(t){e(Ft(t))},loadConversation:function(){e({type:"conversation/LOAD_CONVERSATION"})},setMessages:function(t){e(function(e){return{type:"conversation/SET_MESSAGES",payload:e}}ESENT"})},setTypist:function(t){e(function(e){return{type:"conversation/SET_TYPIST",payload:e}}(t))},loadRemoteMessage:function(t,n){e(en(t,n))},setWebsocketConnected:function(){e({type:"websocket/SET_WEBSOCKET_CONNECTED"})}}}))(bl),Cl=V((function(e){return{eventsQueue:e.events.events,hasFullConversation:e.conversation.hasFullConversation,websocketConnected:e.websocket.websocketConnected}}),(function(e){return{processEvents:function(){e({type:"events/PROCESS_EVENTS"})}}}))((function(e){var t=e.eventsQueue,n=e.processEvents,o=e.hasFullConversation,i=e.websocketConnected;return Object(r.useEffect)((function(){t.length&&o&&i&&n()}),[t,n,o,i]),null})),xl={"bottom-left-corner":"conversationChatPositionBottomLeft","bottom-right-corner":"conversationChatPositionBottomRight"},Ol=(n(336),n(337),n(340),function(e,t){var n=e.getDay(),r=e.getHours(),o=e.getMinutes(),i=pe:""+e}(o),10);return function(e,t){return function(e){return"weekends"===e?["saturday","sunday"]:"weekdays"===e?["monday","tuesday","wednesday","thursday","friday"]:"everyday"===e?["sunday","monday","tuesday","wednesday","thursday","friday","saturday"]:[e]}(t).includes(function(e){return["sunday","monday","tuesday","wednesday","thursday","friday","saturday"][e]}(e))}(n,t.day)&&function(e,t){return e>=parseInt(t.start.split(":").join(""),10)&&e<parseInt(t.end.split(":").join(""),10)}(i,t)}),Sl=function(e){return e.conversation.messages},kl=function(e){return e.settings.settings},_l=bo(kl,(function(e){var t="always_on";return e&&e.channels.site.visibilityRule&&e.channels.site.visibilityRule||t})),Tl=bo([kl,_l],(function(e,t){return null!=e&&e.channels.site.visibilityConfig?"online_agents"===t?e.channels.site.visibilityConfig.onlineAgents:"business_hours"===t?e.channels.site.visibilityConfig.businessHours:null:null})),Dl=bo([function(e){return e.settings.settings&&e.settings.settings.agentsOnline||0},_l,Tl],(function(e,t,n){return!("always_on"!==t)||("online_agents"===t?0<e:"business_hours"!==t||function(e,t,n){if(!t||!t.length)return!1;var r;try{r=e.toLocaleString("en-US",{timeZone:n})}catch(t){r=e}return 0<t.filter((function(e){return Ol(new Date(r),e)})).length}(new Date,n.hours,n.timezone))})),Rl=bo([Dl,Tl],(function(e,t){return!(e||!t)&&t.offlineIndicator})),Pl=function(e){return e.conversation.unreadMessageCount},Ml=bo([function(e){return!!e.settings.settings&&e.settings.settings.enabled},function(e){return!!e.settings.settings&&e.settings.settings.channels.site.enabled},Dl,Rl],(function(e,t,n,r){return e&&t&&(n||r)})),Nl=bo([Sl],(function(e){return!!e.filter((function(e){return!!e.parts.filter((function(e){return"form"===e.type&&e.properties.hideComposer&&!e.properties.hasResponse})).length})).length})),Fl=bo([Sl],(function(e){var t=null;return e.forEach((function(e){e.parts.forEach((function(e){"question"!==e.type||e.properties.hasResponse||(t=e)}))})),t})),Ll=V((function(e){var t;return{activeQuestion:Fl(e),bungs.settings?e.settings.settings.channels.site.bubblePosition:"bottom-right-corner",chatEnabled:Ml(e),unreadMessageCount:Pl(e),settings:kl(e),conversation:e.conversation.conversation,hideComposer:Nl(e),welcomeMessageHidden:e.welcomeMessage.hidden,welcomeMessageId:null===(t=e.welcomeMessage.welcomeMessage)||void 0===t?void 0:t.id,offlineIndicator:Rl(e)}}),(function(e){return{markAllMessagesAsRead:function(){e({type:"conversation/MARK_ALL_MESSAGES_AS_READ"})},loadSettings:function(){e({type:"settings/LOAD_SETTINGS"})},hideWelcomeMessage:function(t){e(Un(t))},openChelcomeMessage,p=e.welcomeMessageHidden,d=e.welcomeMessageId,h=e.openChat,g=e.offlineIndicator;Object(r.useEffect)((funct(e,t){return!t||"object"!==jl(t)&&"function"!=typeof t?Hl(e):t}function Wl(e){return(Wl=Object.:functi{return(onsolee=s.observers[e].filter((function(e){return e!==t})):delete this.observers[e])}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1);o.fo?n.split(i):n)),e.indexOf(".")>-1&&(r=tces(t),>3&&void 0!==argt=(a=e.split("."))[1]),this.addNamespaces(t);var:s=Ul({},s,n),of(thisata[e][t],this.removeNamespac]}},{key:"toJSON",value:uralResolver.getSuffix(u,t.count;this.options.saveMiss&(e=[e]),e.forEach((functionl=l.concat(a.options.fallbrEach((funNamesp()))),n.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}},{key:"isWhitelisted",value:function(e){return("languageOnly"===this.options.load||this.options.nonExplicitWhitelist)&&(e=this.getLanguagePartFromCode(e)),!this.whitelist||!this.whitelist.length||this.whitelist.indexOf(e)>-1}},{key:"getFallbackCodes",value:function(e,t){if(!e)return[];if("string"==typeof e&&(e=[e]),"[object Array]"===Object.prototype.toString.apply(e))return e;if(!t)return e.default||[];var n=e[t];return n||(n=e[this.getScriptPartFromCode(t)]),n||(n=e[this.formatLanguageCode(t)]),n||(n=e.default),n||[]}},{key:"toResolveHierarchy",value:function(e,t){var n=this,r=this.getFallbackCodes(t||this.options.fallbackLng||[],e),o=[],i=function(e){e&&(n.isWhitelisted(e)?o.push(e):n.logger.warn("rejecting non-whitelisted language code: ".concat(e)))};return"string"==typeof e&&e.indexOf("-")>-1?("languageOnly"!==this.options.load&&i(this.formatLanguageCode(e)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&i(this.getScriptPartFromCode(e)),"currentOnly"!==this.options.load&&i(this.getLanguagePartFromCode(e))):"string"==typeof e&&i(this.formatLanguageCode(e)),r.forEach((function(e){o.indexOf(e)<0&&i(n.formatLanguageCode(e))})),o}}]),e}(),vf=[{lngs:["ach","ak","am",","ti1,"emlns,"cg,"k","[1,5},,{l1,2gd""jvc:1v"]:["o"],20r?1:2)}is.languageUtilsnguagePartFromCode(e)]}},{key:s.prepend+o.toString rule found for: ".concat([0]:{};e.interpolation||(ee",value:function(e,t,n,r){var o,i,a,s=this,u=this.options&&this.options.interpolation&&this.options.interpolatiationHandler||this.options.missingInterpolationHandler;for(a=0;o=this.regexpUnescape.exec(e);){if(void 0===(i=l(o[1].trim())))if("function"==typeof f){var p=f(e,o,r);i="string"==typeof p?p:""}else this.logger.warn("missed to pass in variable ".concat(o[1]," for interpolating ").concat(e)),i="";else"string"==typeof i||this.useRawValueToEscape||(i=tf(i));ifuseRawValueToEscape||(i=tf(i));if(i=this.esefaultValue,e}for(i.a,r){var o=this,i=[]ush(e)})),(i.length||a.lengthction(e,t){for(var f(t)}(n.pending,e),t&keys(n.loaded).forEachs.length>4&&void 0!==argumtion(e){n.loadOne(e)}))}},{key:"load",value:function(e,t,n){this.prepareLoading(e,t,{},n)}},{key:"reload",value:function(e,t,n){this.prepareLoading(e,t,{reload:!0},n)}},{key:"loadOne",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=e.split("|"),o=$l(r,2),i=o[0],a=o[1];this.read(i,a,"read",null,null,(function(r,o){r&&t.logger.warn("".concat(n,"loading namespace ").concat(a," for language ").concat(i," failed"),r),!r&&o&&t.logger.log("".concat(n,"loaded namespace ").concat(a," for language ").concat(i),o),t.loaded(e,r,o)}))}},{key:"saveMissing",value:function(e,t,n,r,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};this.services.utilsou access the t function before i18nespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!"):(this.bacelist:!1,load:"all",pectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(e){var t={};if("objecalue=e[1]),"string"==typeof e[2]&&(t.tDescription=e[2]),"object"===jl(e[2])||"object"===jl(e[3])){var n=e[3]||e[2];Object.keys(n).forEach((function(e){t[e]=n[e]}))}return t},interpolation:{escapeValue:!0,format:function(e,t,n){return e},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",maxReplaces:1e3}}}function xf(e){return"string"==typeof e.ns&&(e.ns=[e.ns]),"string"==typeof e.fallbackLng&&(e.fallbackLng=[e.fallbackLng]),"string"==typeof e.fallbackNS&&(e.fallbackNS=[e.fallbackNS]),e.whitelist&&e.whitelist.indexOf("cimode")<0&&(e.whitelist=e.whitelist.concat(["cimode"])),e}function Of(){}var Sf=new(function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;if(zl(this,t),e=Vl(this,Wl(t).call(this)),Zl.call(Hl(e)),e.options=xf(n),e.services={},e.logger=Xl,e.modules={external:[]},r&&!e.isInitialized&&!n.isClone){if(!e.options.initImmediate)return e.init(n,r),Vl(e,Hl(e));setTimeout((function(){e.init(n,r)}),0)}return e}return Yl(t,e),ql(t,[{key:"init",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;function r(e){return e?"function"==typeof e?new e:e:null}if("function"==typeof t&&(n=t,t={}),this.options=Ul({},Cf(),this.options,xf(t)),this.format=this.options.interpolation.format,n||(n=Omodules.logger?Xl.init(r(this.modules.logger),this.options):Xl.init(null,this.options);var o=new mf(this.options);this.store=new pf(this.options.resources,this.options=o,i.pluralResoor=new wf(this.options),i.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},i.backendConnector=newmit.apply(e,[t].concat(r))})),ceBundle","getResoitImmediate?u():setTimeout(u,),this.services.backendCProcessor(e),"3rdParty"===e.type&&this.modules.external.push(e),this}},{key:"changeLanguage",value:function(e,t){var n=this,r=efices.languageUtils.toResolveHierarator.changeLanguage(e),n.servicesf("object"!==jl(r)){for(var ieof e?r.lng=e:r.lngs=e,r.ns=is.options.default).concat(n)];return-1===r||2=ue:function(e,t){var n=this,.resolve())}},{key:"dir",value:function(e){if(e||(e=this.languages&&this.languages.length>0?this.languages[0]:this.language),!e)return"rtl";return["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam"].indexOf(this.services.languageUtils.getLanguagePartFromCode(e))>=0?"rtl":"ltr"}},{key:"createInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;return new t(e,n)}},{key:"cloneInstance",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Of,o=Ul({},this.options,n,{isClone:!0}),i=new t(o),a=["store","services","language"];return a.forEach((function(t){i[t]=e[t]})),i.translator=new hf(i.services,i.options),i.translator.on("*",(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];i.emit.apply(i,[e].concat(n))})),i.init(o,r),i.translator.options=i.options,i}}]),t}(Zl)),kf=n(182),_f=n.n(kf),Tf=n(183),Df=n.n(Tf),Rf=n(361),Pf={};Rf.keys().forEach((function(e){Pf[e.replace(/^\.\/(.*)\.json/,"$1")]={translation:Rf(e)}}));var Mf=Pf;Sf.use(new _f.a).use(Uo).use(Df.a).init({resources:Mf,fallbackLng:{default:["en"]},keySeparator:".",interpolation:{escapeValue:!1}});n(390);a.a.render(o.a.createElement(h,{store:go},o.a.createElement(Ll,null)),document.getElementById("conversations-app"))}]);