(()=>{"use strict";(self.webpackChunkardplayer=self.webpackChunkardplayer||[]).push([[988],{3917:function(e,t,i){i.r(t),i.d(t,{default:function(){return f}});var s=i(8422),a=i(3675),r=i.n(a),n=i(8353),l=i(8241),o=i(5989),h=i(1947);class d extends s.m{constructor(e,t){super(e,t),this.lastState="",this.currentMediaStream=null,this.currentTime=0,this.dvrTime=0,this.dvrLeft=0,this.dvrRight=0,1!==this.model.playbackRate&&(this.model.playbackRate=1,this.player.loop.dispatchEvent(l.J.PLAYBACK_RATE_CHANGE,{rate:1})),t.ctrl=this}get isRemotePlayback(){return!0}applyVideoScaleet castAddon(){var e;return null!==(e=this.player.addons.find(())&&void 0!==e?e:null}removeEventListeners(){super.removeEventListeners(),this.vc.toggleForceControlsVisible("ChromeCast",!1),this.vc.playerView.classList.remove("ardplayer-state-casting-volumecontrol")}addEventListeners(){var e,t;this._dvrModeEnabled=!1,this._dvrWindow=0,this._dvrIsLive=!1,this.dvrTime=-1,this.vc.toggleForceControlsVisible("ChromeCast",!0);const i=this.castAddon;null!==(t=null===(e=i.remotePlayer)||void 0===e?void 0:e.canControlVolume)&&void 0!==t&&t&&this.vc.playerView.classList.add("ardplayer-state-casting-volumecontrol"),this.remotePlayer=i.remotePlayer,this.remotePlayerController=i.remotePlayerController,this.emap=new(r()),this.emap.map(this.remotePlayerController,cast.framework.RemotePlayerEventType.CURRENT_TIME_CHANGED,this.onTimeUpdate,this),this.emap.map(this.remotePlayerController,cast.framework.RemotePlayerEventType.PLAYER_STATE_CHANGED,this.onStateChange,this),this.emap.map(this.remotePlayerController,cast.framework.RemotePlayerEventType.IS_MUTED_CHANGED,this.onMuteChange,this),this.emap.map(this.remotePlayerController,cast.framework.RemotePlayerEventType.VOLUME_LEVEL_CHANGED,this.onVolumeChange,this),this.emap.map(this.remotePlayerController,cast.framework.RemotePlayerEventType.MEDIA_INFO_CHANGED,this.onMediaInfoChange,this),this.emap.map(this.remotePlayerController,cast.framework.RemotePlayerEventType.DURATION_CHANGED,this.onDurationChange,this),this.emap.map(this.remotePlayerController,cast.framework.RemotePlayerEventType.LIVE_SEEKABLE_RANGE_CHANGED,this.onLiveSeekableRangeChanged,this)}nMuteChange(e){this.vc.setVolumeMuted(e.value,!0,!0)}onVolumeChange(e){this.vc.setVolumeLevel(100*e.value,!0,this.mediaElement.muted,!0,!0)}onStateChange(e){switch(this.log("statechange",e.value),e.value){case"PLAYING":this.onPlay();break;case"PAUSED":this.onPause(null);break;case"BUFFERING":this.bufferingEventHandler(!0);break;case"IDLE":"PLAYING"===this.lastState&&this.endEventHandler(null)}this.lastState=e.value}urrentTime(){var e,t,i;return this._pendingSeek>0?this._pendingSeek:this._dvrModeEnabled?this.dvrTime:null!==(i=null!==(t=null===(e=this.remotePlayer)||void 0===e?void 0:e.currentTime)&&void 0!==t?t:this.currentTime)&&void 0!==i?i:0}onLiveSeekableRangeChanged(e){var t,i;this._dvrModeEnabled=e.value&&e.value.end>0,e.value&&(this.dvrLeft=e.value.start,this.dvrRight=e.value.end),this._dvrWindow=this.dvrRight-this.dvrLeft,this.dvrTime=(null!==(i=null===(t=this.remotePlayer)||void 0===t?void 0:t.currentTime)&&void 0!==i?i:0)-this.dvrLeft,this.updateDVRValues()}oadStream(e){var t,i,s,a,r,d,u,m,c,v,p,E,T,y,f,g;this.log("loadStream()"),this.player.viewCtrl.hidePosterFrame(),this.mediaElement.mediaLoading(),this.model.playstate=n.S.PLAYSTATE_UNSPECIFIED,this.currentMediaStream=e;const S=this.mc.isLive;if((null===(t=this.remotePlayer)||void 0===t?void 0:t.canControlVolume)&&this.vc.setVolumeLevel(100*this.remotePlayer.volumeLevel,!0,this.remotePlayer.isMuted,!0,!0),this.stopOtherPlayingPlayers(),this.player.loop.dispatchEvent(l.J.EVENT_LOAD_STREAM,{mediaStream:e}),this._pendingSeek=this.model.time,!this._pendingSeek&&!this.mc.isLive){let e=this.pc.generic.vodInitialPlayheadSeconds;e<=0&&(e=this.pc.generic.vodStartSeconds),this._pendingSeek=e}const k=[];this.mc.subtitles.map((e=>Object.assign({},e,{sources:e.sources.filter(()}))).filter((e=>{var t,i;return(null!==(i=null===(t=e.sources)||void 0===t?void 0:t.length)&&void 0!==i?i:0)>0})).forEach(((e,t)=>{var i;const s=new chrome.cast.media.Track(t,chrome.cast.media.TrackType.TEXT);let a=String(null!==(i=e.sources[0].url)&&void 0!==i?i:"");a.startsWith("//")&&(a=`https:${a}`),s.trackContentId=a,s.trackContentType="text/vtt",s.subtype=chrome.cast.media.TextTrackType.SUBTITLES,s.name=`${(0,o.vY)(e.languageCode)}${"simple-language"===e.kind?" - Einfache Sprache":""}`,s.language=e.languageCode,s.customData=null,k.push(s)}));const _=new chrome.cast.media.MediaInfo(e.url,e.mimeType);_.tracks=k,_.streamType=S?chrome.cast.media.StreamType.LIVE:chrome.cast.media.StreamType.BUFFERED,_.duration=S?-1:null!==(i=this.mc.meta.durationSeconds)&&void 0!==i?i:0,this.player.isAudio?(_.metadata=new chrome.cast.media.MusicTrackMediaMetadata,_.metadata.songName=null!==(s=this.mc.meta.title)&&void 0!==s?s:"",_.metadata.title=null!==(a=this.mc.meta.title)&&void 0!==a?a:"",_.metadata.albumName=null!==(u=null!==(d=null!==(r=this.mc.meta.seriesTitle)&&void 0!==r?r:this.mc.meta.subHeading)&&void 0!==d?d:this.mc.meta.synopsis)&&void 0!==u?u:"",(0,o.SL)(null===(m=this.mc.meta.publicationService)||void 0===m?void 0:m.name)&&(_.metadata.albumArtist=null===(c=this.mc.meta.publicationService)||void 0===c?void 0:c.name),(0,o.SL)(this.mc.meta.broadcastedOnDateTime)&&(_.metadata.releaseDate=this.mc.meta.broadcastedOnDateTime)):(_.metadata=new chrome.cast.media.MovieMediaMetadata,_.metadata.title=null!==(v=this.mc.meta.title)&&void 0!==v?v:"",_.metadata.subtitle=null!==(T=null!==(E=null!==(p=this.mc.meta.seriesTitle)&&void 0!==p?p:this.mc.meta.subHeading)&&void 0!==E?E:this.mc.meta.synopsis)&&void 0!==T?T:"",(0,o.SL)(null===(y=this.mc.meta.publicationService)||void 0===y?void 0:y.name)&&(_.metadata.studio=null===(f=this.mc.meta.publicationService)||void 0===f?void 0:f.name),(0,o.SL)(this.mc.meta.broadcastedOnDateTime)&&(_.metadata.releaseDate=this.mc.meta.broadcastedOnDateTime)),_.metadata.images=this.mc.meta.images.map((e=>({url:new URL(e.url,document.baseURI).href}))),this.mediaElement.mediaInfo=_;const A=new chrome.cast.media.LoadRequest(_);null===(g=cast.framework.CastContext.getInstance().getCurrentSession())||void 0===g||g.loadMedia(A).then((()=>{try{this.player.checkState()}catch(e){return void h.iV.warn("aborting async",e)}this._ready=!0,this.evalInitialSeek(),this.mediaElement.mediaLoaded(),this.player.loop.dispatchEvent(l.J.EVENT_STREAM_LOADED,{})}),()}setCurrentTime(e,t=!1,i=!1,s=!1){if(this.remotePlayer&&this.remotePlayerController&&this.remotePlayer.canSeek){let i=Math.min(e,this.getDuration()-.1);this._dvrModeEnabled&&(i=this.dvrLeft+e,this.dvrTime=e),this.remotePlayer.currentTime=i,this.remotePlayerController.seek(),this.onStateChange({value:"BUFFERING"}),super.setCurrentTime(e,t,!0,s)}}updateTicker(){if(this._dvrModeEnabled)switch(this.model.playstate){case n.S.PLAYSTATE_PAUSED:case n.S.PLAYSTATE_PLAYING:this.dvrLeft+=.5,this.dvrRight+=.5}super.updateTicker()}etClassTypeString(){return"ChromecastCtrl"}var u,m,c,v=d,p=function(e,t,i,s,a){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?a.call(e,i):a?a.value=i:t.set(e,i),i},E=function(e,t,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(e):s?s.value:t.get(e)};class T{constructor(e,t,i,s){this.idNum=e,this.language=t,this.kind=i,this.mediaElement=s,this.id=String(this.idNum)}get modeet mode(e){"showing"===e?this.mediaElement.currentSubtitleId=this.idNum:this.mediaElement.currentSubtitleId===this.idNum&&(this.mediaElement.currentSubtitleId=-1)}}class y{constructor(){this.ctrl=null,this.mediaInfo=null,u.set(this,!0),m.set(this,null),c.set(this,-1),this.videoHeight=0,this.videoWidth=0}ediaLoaded(){p(this,u,!1,"f"),E(this,m,"f")&&(E(this,m,"f").call(this),p(this,m,null,"f"))}get remotePlayer(){var e,t;return null!==(t=null===(e=this.ctrl)||void 0===e?void 0:e.remotePlayer)&&void 0!==t?t:null}get remotePlayerController(){var e,t;return null!==(t=null===(e=this.ctrl)||void 0===e?void 0:e.remotePlayerController)&&void 0!==t?t:null}get buffered(){return{length:0,start:()=>0,end:}get currentTime(){var e,t;return null!==(t=null===(e=this.remotePlayer)||void 0===e?void 0:e.currentTime)&&void 0!==t?t:-1}set currentTime(e){var t,i;(null===(t=this.remotePlayer)||void 0===t?void 0:t.canSeek)&&(this.remotePlayer.currentTime=e,null===(i=this.remotePlayerController)||void 0===i||i.seek())}et textTracks(){var e,t,i,s,a;const r=null!==(a=null!==(i=null===(t=null===(e=this.remotePlayer)||void 0===e?void 0:e.mediaInfo)||void 0===t?void 0:t.tracks)&&void 0!==i?i:null===(s=this.mediaInfo)||void 0===s?void 0:s.tracks)&&void 0!==a?a:null;return null==r?[]:r.map((e=>new T(e.trackId,e.language,"subtitles",this)))}get currentSubtitleId(){return E(this,c,"f")}set currentSubtitleId(e){p(this,c,e,"f");const t=e>=0?[e]:[],i=new chrome.cast.media.EditTracksInfoRequest(t),s=()=>{var e,s;null===(s=null===(e=cast.framework.CastContext.getInstance().getCurrentSession())||void 0===e?void 0:e.getMediaSession())||void 0===s||s.editTracksInfo(i,(,()};E(this,u,"f")?p(this,m,s,"f"):s()}updateCurrentSubtitleIdFromRemote(){var e,t,i;const s=null!==(i=null===(t=null===(e=cast.framework.CastContext.getInstance().getCurrentSession())||void 0===e?void 0:e.getMediaSession())||void 0===t?void 0:t.activeTrackIds)&&void 0!==i?i:null;if(null!=s){const e=0===s.length?-1:s[0];e!==E(this,c,"f")&&p(this,c,e,"f")}}et muted(e){var t;this.muted!==e&&(null===(t=this.remotePlayerController)||void 0===t||t.muteOrUnmute())}et volume(e){var t;const i=this.remotePlayer;(null==i?void 0:i.canControlVolume)&&i.volumeLevel!==e&&(i.volumeLevel=e,null===(t=this.remotePlayerController)||void 0===t||t.setVolumeLevel())}pause(){var e,t,i;!(null===(e=this.remotePlayer)||void 0===e?void 0:e.isPaused)&&(null===(t=this.remotePlayer)||void 0===t?void 0:t.canPause)&&(null===(i=this.remotePlayerController)||void 0===i||i.playOrPause())}play(){return this,void 0,void 0,(function*(){yield new Promise(((e,t)=>{var i,s,a,r;null!==(s=null===(i=this.remotePlayer)||void 0===i?void 0:i.isConnected)&&void 0!==s&&s?((null===(a=this.remotePlayer)||void 0===a?void 0:a.isPaused)&&(null===(r=this.remotePlayerController)||void 0===r||r.playOrPause()),e()):t(y.error())}))}))}et playbackRateddEventListener(e,t){throw y.error()}removeEventListeneret currentSrc(){throw y.error()}load=new WeakMap,m=new WeakMap,c=new WeakMap;var f={Generator:class{execute(e,t){var i;try{null===(i=e.viewCtrl)||void 0===i||i.removeMediaCanvas()}catch(e){}t(new y)}},Controller:v}},8422:function(e,t,i){i.d(t,{m:);var s=i(8241),a=i(7072),r=i(721),n=i(5221),l=i(8353),o=i(2893),h=i(3675),d=i.n(h),u=i(1947),m=i(8187),c=i(5989),v=p=E=T=let y=(()}}])})();