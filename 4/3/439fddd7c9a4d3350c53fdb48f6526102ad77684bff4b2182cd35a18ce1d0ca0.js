(window.officehome_webpackJsonp=window.officehome_webpackJsonp||[]).push([[599],{"+OTV":function(e,t,n){"use strict";n.r(t),n.d(t,"SearchResultsModuleNgFactory",();var r=n("keVe"),i=),a=n("fYis"),o=n("7IJ8"),u=n("QhWD"),c=n("hhzZ"),s=n("cgnd"),l=n("casz"),h=n("RsrG"),f=n("6Po3"),p=n("WLAd"),b=n("QjXU"),d=n("BMc1"),g=n("bmzq"),v=n("4/We"),m=function(e){eturn Object(b.__extends)(t,e),t.prototype.getReactElement=function(){return Object(b.__awaiter)(this,void 0,void 0,(function(){var e;return Object(b.__generator)(this,(function(t){switch(t.label){case 0:return this.capabilitiesService.capabilities.showSearch?[4,this.fastSearchUXService.searchUXMainModule]:[2,Promise.resolve(null)];case 1:return e=t.sent().RefinerPanelContainer,[2,React.createElement(e,{hostId:"officeHome"})]}}))}))},t.prototype.ngOnInit=function(){e.prototype.ngOnInit.call(this)},t.prototype.ngOnDestroy=function(){e.prototype.ngOnDestroy.call(this)},t}(g.a),y=n("mXGw"),S=n("uh00"),O=n("X+PR"),w=n("N/Uq"),U=Object.assign||j=n("NWgQ"),I=n.n(j),R=n("zvoD"),C=function(){eturn e.prototype.serializePrimaryOutlet=function(e){var t,n=e.root.children[O.g],r=this.router.parseUrl(this.router.serializeUrl(e));return r.root.children=n?((t={})[O.g]=e.root.children[O.g],t):{},this.router.serializeUrl(r)},e.prototype.setUpRouterListener=function(){var e=this;this.capabilitiesService.capabilities.showSearch&&this.router.events.pipe(Object(R.a)((function(e){return e instanceof O.d}))).subscribe((function(t){var n,r=e.history.location,i=""+r.pathname+r.search,a=e.router.parseUrl(t.url),o=e.serializePrimaryOutlet(a);if(i!==o){var u=null===(n=e.router.getCurrentNavigation())||void 0===n?void 0:n.extras.state;e.navigateReact(o,u)}}))},e.prototype.navigateAngular=function(e,t){this.router.navigated&&this.router.url!==e&&this.router.navigateByUrl(e,{skipLocationChange:!1,state:t})},e.prototype.initHistory=function(){var e=this;if(this.capabilitiesService.capabilities.showSearch){var t=this.router.parseUrl(this.router.url),n=this.serializePrimaryOutlet(t),r=function(e){var t=e.parse,n=e.stringify;return function(e){var r=i=function(e){var t=e.query,r=e,["query"]);return U({},r,{search:t&&"object"==typeof t?n(t):r.search})},a=U({},e,{location:r(e.location),push:function(t,n){return"object"!=typeof t?e.push(t,n):e.push(i(t))},replace:function(t,n){return"object"!=typeof t?e.replace(t,n):e.replace(i(t))},block:function(t){return e.block("function"!=typeof t?t:function(e,n){return t(r(e),n)})},listen:function(t){return e.listen(()},createHref:);return Object.defineProperties(a,{length:{get:function(){return e.length}},action:{get:,location:{get:}),a}}(I.a)(Object(w.b)({initialEntries:[n]}));this.navigateReact=r.push,this.history=r,this.history.listen((function(t){e.navigateAngular(""+t.pathname+t.search,t.state)}))}},e.Éµprov=r.kc({factory,token:e,providedIn:"root"}),e}(),P=function(e)return Object(b.__extends)(t,e),t.prototype.getReactElement=function(){return Object(b.__awaiter)(this,void 0,void 0,(function(){var e,t,r,i,a,o,u,c,s,l;return Object(b.__generator)(this,(function(h){switch(h.label){case 0:return[4,this.fastSearchUXService.searchUXMainModule];case 1:return e=h.sent(),[4,this.searchPageInstrumentationService.searchUXInstrumenter];case 2:return t=h.sent(),r=n("oNR1"),i=r.Router,a=r.Route,o=r.Switch,u=r.withRouter,c=e.RootComponent,s=e.indexRouteVNext.component,l=e.childRoutes,t.markSearchLayoutRenderStart(),[2,y.createElement(i,{history:this.angularReactHistoryService.history},y.createElement(c,{withRouter:u},y.createElement(o,null,y.createElement(a,{exact:!0,path:"/search",render:u(s)}),l.map((function(e,t){return y.createElement(a,{path:"/search/"+e.path,render:u(e.component),key:t})})))))]}}))}))},t.prototype.markSearchLayoutMount=function(){return Object(b.__awaiter)(this,void 0,void 0,(function(){return Object(b.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.searchPageInstrumentationService.searchUXInstrumenter];case 1:return e.sent().markSearchLayoutMount(),[2]}}))}))},t.prototype.ngOnInit=function(){e.prototype.ngOnInit.call(this)},t.prototype.ngOnDestroy,t}(g.a),k=n("TOqr"),E=n("g/dT"),M=n("W3Zz"),x=n("f0qX"),_=n("AY/E"),X=n("w1PR"),A=n("BMb5"),q=n("3g20"),L=function(){function e(e,t,n,r,i,a,o,u,c){this.capabilitiesService=e,this.fastSearchUXService=t,this.windowService=n,this.injector=r,this.router=i,this.activatedRoute=a,this.themingService=o,this.searchConfigService=u,this.searchPageInstrumentationService=c,this.showSearch=this.capabilitiesService.capabilities.showSearch,this.mobileCustomSearchEnabled=this.capabilitiesService.capabilities.mobileCustomSearchEnabled,this.showSearchResults=!this.mobileCustomSearchEnabled,this.focusSearchBoxOnLoad=this.mobileCustomSearchEnabled}return e.prototype.ngOnInit=function(){return Object(b.__awaiter)(this,void 0,void 0,(function(){var t,n,r=this;return Object(b.__generator)(this,(function(i){switch(i.label){case 0:return this.capabilitiesService.capabilities.showSearch?[4,this.searchPageInstrumentationService.searchUXInstrumenter]:[2];case 1:return t=i.sent(),this.forceHideBackground=this.themingService.themeShades.pipe(Object(x.a)((function(e){var n=!!e.theme.reactShellTheme&&e.theme.reactShellTheme.IsDarkMode,i=t&&t.props.darkModeAvailable;return i&&n&&r.fastSearchUXService.refreshTheme(e.theme),!i&&!r.showSearchResults&&!n}))),this.setMobileSettings(),this.navigationSubscription=this.router.events.pipe(Object(R.a)())).subscribe()),e.mainModuleConfigured||!y?[3,3]:(this.fastSearchUXService.loadMainModule(),[4,this.fastSearchUXService.searchUXMainModule]);case 2:n=i.sent(),this.configureSearchUXMainModule(n),i.label=3;case 3:return[2]}}))}))},e.prototype.ngOnDestroy,e.prototype.setMobileSettings=function(){this.focusSearchBoxOnLoad=this.mobileCustomSearchEnabled&&!this.activatedRoute.snapshot.queryParams.q,this.showSearchResults=!this.mobileCustomSearchEnabled||!!this.activatedRoute.snapshot.queryParams.q},e.prototype.configureSearchUXMainModule=function(t){var n=this,r=t.conf;this.capabilitiesService.capabilities.peopleCardsEnabled&&(this.peopleCardService=this.injector.get(_.a),this.peopleCardService.bootstrap().then((function(){r.sets("searchux.personClickTargetWrapper",(function(e){var t={cardParameters:{personaInfo:{identifiers:Object(b.__assign)({PersonaType:"User"},n.searchConfigService.config.useUpnInLpc?{Upn:e.userName}:{Smtp:e.userName})},externalAppSessionCorrelationId:e.queryId,behavior:{onCardOpen:e.onTrigger,onCardClose:e.onDismiss,disableClick:e.isDisabled},ariaLabel:e.ariaLabel||""}};e.tabIndex&&(t.tabIndex=e.tabIndex),e.disableAccessibilityDefaults&&(t.cardParameters.disableAccessibilityDefaults=e.disableAccessibilityDefaults);var r=n.windowService.nativeWindow.LivePersonaCardHoverTargetV2;return r?y.createElement(r,t,e.children):y.createElement(y.Fragment,null,e.children)}))}))),e.mainModuleConfigured=!0},e.mainModuleConfigured=!1,e}(),H=r.Fb({encapsulation:2,styles:[],data:{}});function D(e){return r.jc(0,[(e()(),r.Hb(0,16777216,null,null,2,null,null,null,null,null,null,null)),r.Gb(1,475136,null,0,o.a,[u.a,r.W,c.a,s.b,l.a,h.a,f.a,r.F,p.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),r.Zb(2,{focusInputOnLoad:0,fullWidthSearchBox:1}),(e()(),r.qb(0,null,null,0))],(function(e,t){var n=e(t,2,0,t.component.focusSearchBoxOnLoad,!0);e(t,1,0,"auto-suggest#AutoSuggestModule",n)}),null)}function N(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,4,"div",[],null,null,null,null,null)),(e()(),r.Hb(1,0,null,null,1,"ohp-fast-search-filters-pane",[],null,null,null,null,null)),r.Gb(2,212992,null,0,m,[r.o,v.a,d.a],null,null),(e()(),r.Hb(3,0,null,null,1,"ohp-react-router-outlet",[],null,null,null,null,null)),r.Gb(4,212992,null,0,P,[r.o,C,d.a,S.a],null,null)],),null)}function W(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,8,"div",[["class","fast-search-results width-restrictor"],["ohpInstrumentPageView","FastSearch_PageView"]],null,null,null,null,null)),r.Gb(1,278528,null,0,k.i,[r.x,r.y,r.o,r.K],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Yb(131072,k.b,[r.h]),r.Zb(3,{"search-bottom-tray-tab":0,"hide-search-background":1}),r.Gb(4,81920,null,0,E.a,[M.c,c.a],{pageName:[0,"pageName"]},null),(e()(),r.qb(16777216,null,null,1,null,D)),r.Gb(6,16384,null,0,k.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null),(e()(),r.qb(16777216,null,null,1,null,N)),r.Gb(8,16384,null,0,k.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,3,0,n.mobileCustomSearchEnabled,r.hc(t,1,1,r.Wb(t,2).transform(n.forceHideBackground)));e(t,1,0,"fast-search-results width-restrictor",i),e(t,4,0,"FastSearch_PageView"),e(t,6,0,n.mobileCustomSearchEnabled),e(t,8,0,n.showSearchResults)}),null)}function z(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,2,"div",[["class","fast-search-results-container ms-bgc-w"]],null,null,null,null,null)),(e()(),r.qb(16777216,null,null,1,null,W)),r.Gb(2,16384,null,0,k.k,[r.W,r.S],{ngIf:[0,"ngIf"]},null)],),null)}var T=r.Db("ohp-fast-search-results",L,(function(e){return r.jc(0,[(e()(),r.Hb(0,0,null,null,1,"ohp-fast-search-results",[],null,null,null,z,H)),r.Gb(1,245760,null,0,L,[v.a,d.a,A.b,r.v,O.n,O.a,X.b,q.a,S.a],null,null)],),null)}),{},{},[]),G=n("xIlw"),B=n("+a0u"),F=n("lQwO"),V=n("+P5Z"),Q=n("izKO"),Z=n("CfLe"),Y=n("ej7j"),$=n("VY7U"),J=r.Eb(i,[],(function(e){return r.Tb([r.Ub(512,r.k,r.hb,[[8,[a.a,T]],[3,r.k],r.D]),r.Ub(4608,k.m,k.l,[r.z]),r.Ub(1073742336,k.c,k.c,[]),r.Ub(1073742336,G.a,G.a,[]),r.Ub(1073742336,B.a,B.a,[]),r.Ub(1073742336,F.a,F.a,[]),r.Ub(1073742336,V.a,V.a,[]),r.Ub(1073742336,Q.a,Q.a,[]),r.Ub(1073742336,O.o,O.o,[[2,O.u],[2,O.n]]),r.Ub(1073742336,Z.a,Z.a,[]),r.Ub(1073742336,Y.a,Y.a,[]),r.Ub(1073742336,$.a,$.a,[]),r.Ub(1073742336,i,i,[]),r.Ub(1024,O.l,),[])])}))},NWgQ:function(e,t,n){"use strict";var r=n("thIa"),i=n("IL7q").extract,t.parse=function(e,t){var n=function(e){var t;switch(e.arrayFormat){case"index":return;case"bracket":return;default:return}}(t=i({arrayFormat:"none"},t)),r=Object.create(null);return"string"!=typeof e?r:(e=e.trim().replace(/^(\?|#|&)/,""))?(e.split("&").forEach()),Object.keys(r).sort().reduce(),Object.create(null))):r},t.stringify},bmzq:function(e,t,n){"use strict";var r=n("mXGw"),i=n("xARA"),a=function()return e.prototype.ngOnInit,e.prototype.render=function(){var e=this;return this.onRenderPromise=new Promise((function(t){r&&i?e.getReactElement().then((function(n){return!e.destroyed&&(e.rendered=!0,i.render(n,e.getTargetElementRef().nativeElement,t))})):t()})),this.onRenderPromise},e.prototype.ngOnDestroy=function(){r&&i&&(this.destroyed=!0,this.rendered&&i.unmountComponentAtNode(this.target.nativeElement))},e.prototype.getTargetElementRef,e}();t.a=a},thIa}]);
//# sourceMappingURL=search-results.86972c07c19f257e768d.chunk.v7.js.map